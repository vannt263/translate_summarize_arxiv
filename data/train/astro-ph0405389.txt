{
  "article_text": [
    "numerical simulations of structure formation are essential tools in theoretical cosmology .",
    "their main role , in addition to many other uses , has been to test the viability of the different models of structure formation ",
    "e.g. variants of the cold dark matter ( cdm ) model  by evolving initial conditions using basic physical laws .    historically , the use of cosmological simulations started in 1960s ( aarseth 1963 ) and 1970s ( e.g. peebles 1970 , white 1976 ) .",
    "these calculations were n - body , collisionless , simulations with few particles . in early 1980s",
    ", the n - body techniques and computers advanced to the extent that simulations could be applied systematically as a scientific tool ( see hockney & eastwood 1988 for a good review of n - body techniques ) and their use led to important results such as the development of the cdm paradigm ( peebles 1982 , blumenthal et al .",
    "1984 , davies et al .",
    "n - body techniques have continued to be developed and refined , with examples including ap3 m ( couchman 1991 ) , art code ( kravtsov , klypin & khokhlov 1997 ) , gadget code ( springel , yoshida & white 2001 ) , mlapm ( knebe , andrew & binney 2001 ) or more recently the code presented by bode & ostriker ( 2003 ) .",
    "the physics of the gaseous , baryonic , component of the universe is far more complicated to model than the formation of structures in the dark matter due to gravitational instability .",
    "understanding the behaviour of baryons is crucial for a complete theory of the formation of cosmic structures , particularly on galactic and cluster scales . any realistic simulation which sets out to explain the growth of structures in the universe must therefore contain a hydrodynamical treatment of the evolution of the baryonic fluid .",
    "pioneering simulations using smooth particle hydrodynamics ( sph ) techniques were first carried out by gingold & monaghan ( 1977 ) ; early cosmological simulations that followed baryons and dark matter include those by evrard ( 1988 ) and hernquist & katz ( 1989 ) .",
    "the integration of the hydrodynamics equations governing the evolution of gas can be done using different techniques .",
    "the adoption of a particular technique , with its associated benefits and drawbacks , has a direct consequence on the outcome of the simulation .",
    "the numerical techniques used to model the evolution of the baryons can be split into two general classes : lagrangian and eulerian .",
    "the most popular of the lagrangian scheme is sph(lucy 1977 , gingold & monaghan 1977 ) .",
    "other schemes which could be defined as quasi - lagrangian include those described by gnedin ( 1995 ) and pen ( 1995 ) .",
    "sph techniques have made possible huge advances in the field of numerical cosmology in the recent past . relatively easy to implement and with a low computational cost ,",
    "sph techniques have a huge dynamical range because of their lagrangian nature .",
    "this feature has made them particularly successful in simulations of cosmic structure formation .",
    "however , the sph technique also has significant drawbacks , including ( i ) an approximate treatment and description of shock waves and strong gradients , ( ii ) a poor description of low density regions , ( iii ) a requirement to the use of numerical artifacts such as the artificial viscosity and ( iv ) the possible violation of conservation properties ( see okamoto et al .",
    "( 2003 ) for a recent example of unphysical results in simulations due to the sph nature ) .",
    "eulerian schemes present an alternative to lagrangian schemes . within this board class of techniques ,",
    "the ones based on riemann solvers have been particularly successful ( e.g. ryu et al . 1993 ; quilis , ibez & sez 1994 ; bryan , norman , stone , cen & ostriker 1995 ; gheller , pantano & moscardini 1998 , and others ) .",
    "these numerical schemes are written in conservative form , which ensures excellent conservation of physical quantities .",
    "shock waves , discontinuities and strong gradients are sharply resolved in typically one or two cells .",
    "the use of riemann solvers removes the need to invoke artificial viscosity to integrate equations with discontinuities . although these properties are needed in order to build a robust hydrodynamical scheme , precisely due to their eulerian character ",
    "fix numerical grids are needed to integrate the hydrodynamical equations ",
    "these techniques are limited by poor spatial resolution . in order to achieve adequate resolution ,",
    "dense numerical grids are needed which quickly drives up the computational cost .",
    "even with the best computers available nowadays , a simple eulerian approach can not compete with a lagrangian approach in cosmological applications , which demand a good spatial resolution and a huge dynamical range .    in this paper",
    ", we present a new numerical code which combines the best features of the eulerian and lagrangian approaches .",
    "the basic idea is to improve the numerical resolution by implementing a scheme known as adaptive mesh refinement ( amr ) described originally by berger & oliger ( 1984 ) and berger & colella ( 1989 ) . in order to do this ,",
    "we use an eulerian approach as the ones described above , but gaining resolution  both spatial and temporal  by selectively refining the original computational grid .",
    "the result is a hierarchy of nested grids which naturally behaves as a lagrangian scheme ( the grids are refined only where the calculation requires it ) and each one of these grids is treated as an independent computational domain by the eulerian scheme .",
    "amr schemes have proved to be extremely powerful in many fluid dynamics applications .",
    "in cosmology , recent amr implementations have been designed by bryan & norman ( 1997 ) , kravtsov , klypin & hoffman ( 2002 ) and teyssier ( 2002 ) .",
    "these codes share the basic ingredients with the one described in this paper , although there are slight differences depending on each particular implementation .    the central tenet of the amr scheme",
    ", the refinement of the computational grid wherever better resolution is needed , can be exploited to incorporate an n - body scheme to follow the evolution of dark matter .",
    "the particle - mesh(pm ) method is ideally suited for grating onto an hydro - amr code . in practise",
    ", a pm scheme is used for each nested grid , with progressively higher spatial resolution when the cell size gets smaller .",
    "this implementation of the amr - pm has the advantage of avoiding the problem of setting a softening parameter in the gravitational force law , as this parameter is naturally determined by the cell size .",
    "several implementations of this approach for dark matter only have been presented in the literature with different degrees of success ( villumsen 1989 , jessop et al .",
    "1994 ; splinter 1996 ; and kravtsov , klypin & khokhlov 1997 ) .    in the present paper ,",
    "we describe a new coupled hydrodynamical and n - body code for cosmological applications ",
    "called masclet ( mesh adaptive scheme for cosmological structure evolution )  based on an amr scheme .",
    "the basic hydrodynamical solver is based on the piecewise parabolic method ( colella & woodward 1984 ) whereas the n - body method used is a classic pm according to hockney & eastwood ( 1988 ) .",
    "the scheme presented in this paper is able to refine and unrefine grids automatically according with a set of parameters which can be chosen depending upon the application .",
    "the code is written in fortran 90 and there is a parallel version using openmp standard directives .",
    "the following section is devoted to present the equations describing the evolution of gaseous and dark matter components , and the main features of the basic hydrodynamical and n - body schemes for a fix grid .",
    "3 describes the amr strategy and how it is implemented in the code . in sec . 4 , we present several numerical tests including the so - called santa barbara cluster ( frenk et al .",
    "finally , our main conclusions are summarized in sec .",
    "in this section we write down the basic equations governing the evolution of cosmological inhomogeneities as a _ hyperbolic system of conservation laws_. the mathematical properties of this kind of system and the numerical algorithms specifically designed for solving it have been well studied in the literature ( leveque 1992 , toro 1997 ) .        for spatial scales where relativistic corrections are not required ,",
    "cosmological inhomogeneities evolve according to the following equations ( peebles 1980 ) : @xmath0 @xmath1 @xmath2 = -3h(e+p ) -h\\rho { \\bf v}^2 - \\frac { \\rho { \\bf v}}{a } \\nabla \\phi \\label{hydro3}\\ ] ] @xmath3 where @xmath4 , @xmath5 , and @xmath6 are , respectively , the eulerian coordinates , the peculiar velocity , and the peculiar newtonian gravitational potential .",
    "the total energy density , @xmath7 , is defined as the addition of the thermal energy , @xmath8 , where @xmath9 is the specific internal energy , and the kinetic energy ( where @xmath10 ) .",
    "the background parameters are the scale factor , @xmath11 , background density , @xmath12 , and the hubble constant , @xmath13 .",
    "the density contrast , @xmath14 , is defined as @xmath15 .",
    "pressure gradients and gravitational forces are the responsible for the evolution .",
    "poisson s equation ( [ poisson1 ] ) is an elliptic equation , and its solution depends on the boundary conditions .",
    "this equation has to be solved in conjunction with eqs ( [ hydro1][hydro3 ] ) to compute the source term @xmath16 which appears in eqs ( [ hydro2][hydro3 ] ) .",
    "an equation of state @xmath17 closes the system . in this paper",
    "we used an ideal gas equation of state @xmath18 with @xmath19 .",
    "the hydrodynamic equations eqs ( [ hydro1][hydro3 ] ) can be rewritten in a slightly different form : @xmath20 where @xmath21 is the vector of _ unknowns_(conserved variables ) : @xmath22 \\ \\ , \\ ] ] the three _ flux _ functions @xmath23 in the spatial directions @xmath24 , respectively , are defined by @xmath25\\end{aligned}\\ ] ] @xmath26\\end{aligned}\\ ] ] @xmath27\\end{aligned}\\ ] ] and the _ sources _ @xmath28 are @xmath29\\end{aligned}\\ ] ] where @xmath30 , @xmath31 , and @xmath32",
    ".    system ( [ hypersys ] ) is a three - dimensional _ hyperbolic system of conservation laws _ with sources @xmath33 . from the numerical point of view",
    "is important to introduce the jacobian matrices associated to the fluxes : @xmath34 hyperbolicity demands that any real linear combination of the jacobian matrices @xmath35 should be diagonalizable with real eigenvalues ( leveque 1992 ) .",
    "this is of crucial importance from the numerical point of view .",
    "the spectral decompositions of the above jacobian matrices in each direction , i.e. , the _ eigenvalues _ and _ eigenvectors _ are explicitly written in quilis , ibez & sez ( 1996 ) .",
    "the sources do not contain any term with differential operators acting on hydrodynamical variables @xmath21 .",
    "this is an important property consistent with the fact that the left hand side of eq.([hypersys ] ) defines a hyperbolic system of conservation laws .",
    "the mathematical properties resulting from the hyperbolic character of the system of equations ( [ hypersys ] ) allow us to design a set of numerical techniques known as _ high - resolution shock - capturing _ ( hrsc ) .",
    "these techniques are the modern implementation of godunov s original method ( godunov 1959 , see laney ( 1998 ) for a modern review on godunov schemes and eulerian methods ) .",
    "the hrsc techniques have several key ingredients such as the reconstruction procedure , the riemann solver , and time advancing schemes which can vary in different implementations .",
    "nevertheless , all of these implementations share the same basic properties : the ability to handle shocks , discontinuities and strong gradients in the integrated quantities , and excellent conservation properties .",
    "our basic hydro solver is based on a particular implementation of the hrsc methods  see quilis , ibez & sez ( 1996 ) for more details .",
    "the main ingredients of our solver are the following :    1 .",
    "it is written in _",
    "conservation form_. this is a very important property for a numerical algorithm designed to solve , numerically , a hyperbolic system of conservation laws .",
    "that is , in the absence of sources , those quantities that ought to be conserved according to the differential equations are exactly conserved in the difference form . 2 .",
    "_ reconstruction procedure_. this procedure allows the method to gain resolution by reconstructing , through interpolations , the distribution of the quantities within the numerical cells . in order to increase spatial accuracy ,",
    "we have used two cell - reconstruction techniques .",
    "we have implemented a linear reconstruction ",
    "first order  , with the _ minmod _ function ( quilis , ibez & sez 1994 ) as a slope limiter . with this reconstruction ,",
    "our algorithm is a muscl - version ( van leer 1979 ) and second order accurate in space .",
    "we have also implemented a parabolic reconstruction ( ppm ) subroutine according to the procedure derived by colella & woodward ( 1984 ) . with the parabolic reconstruction ,",
    "the algorithm is third order accurate in space .",
    "statements on the order of the scheme must be taken with caution , as the mathematical proofs only exist for the one - dimensional case , being the order reduced in multidimensional extensions . in any case , the higher the order of the method in 1d , the better the accuracy in the multidimensional applications .",
    "+ hence , from the cell - averaged quantities @xmath36 we construct , in each direction , a piecewise linear or parabolic function which preserves monotonicity .",
    "thus , the quantities , @xmath37 and @xmath38 , can be computed ; the superindices @xmath39 and @xmath40 stand for the values at both sides of a given interface between neighbour cells .",
    "these values at each side of a given interface allow us to define the local riemann problems .",
    "the numerical fluxes can be computed through the solution of these local riemann problems .",
    "3 .   _ numerical fluxes _ at interfaces .",
    "we have used a linearized riemann solver following an approach similar to the one described by roe ( 1981 ) .",
    "the procedure , applied in each direction , starts by constructing the corresponding numerical flux according to roe s prescription and in order to do that it is necessary to know the spectral decomposition of the jacobian matrix @xmath41 .",
    "the numerical flux associated with the @xmath42-direction is : @xmath43 where @xmath44 and @xmath45 ( @xmath46 ) are , respectively , the eigenvalues and the @xmath47-right eigenvector of the jacobian matrix : @xmath48 + these are calculated in the state which corresponds to the arithmetic mean of the states at each side of the interface .",
    "the quantities @xmath49  the jumps in the local characteristic variables through each interface are obtained from the following relation @xmath50 where @xmath51 , @xmath52 and @xmath53 , are functions of @xmath54 , which are calculated at each interface and , consequently , they depend on the particular values @xmath55 and @xmath56 .",
    "the numerical fluxes in the @xmath57 direction , @xmath58 , and @xmath59 direction , @xmath60 , are obtained in an analogous way .",
    "advancing in time_. once the numerical fluxes @xmath61,@xmath62 , and @xmath63 are known , the evolution of quantities @xmath64 is governed by + @xmath65    an ordinary differential equation ( ode ) solver derived by shu and osher ( 1988 ) is used to solve eq ( [ runge ] ) .",
    "it is a third order runge - kutta that does not increase the total variation of the numerical solution and preserves the conservation form of the scheme .",
    "gravity is included in the gas evolution through the source term , @xmath66 , in eq .",
    "( [ runge ] ) .",
    "this term includes the gradient of the gravitational potential which is produced by the total mass distribution , gas plus dark matter .",
    "the procedure used to solve poisson s equation ( [ poisson1 ] ) is described in sec .",
    "2.4 .    the criteria to select",
    "the time step is very important and it must be considered globally with other time constrains that are unrelated to the gas part .",
    "therefore , we will discuss it in the forthcoming section 2.5 .",
    "the dark matter is treated as a collisionless system of particles .",
    "each of these particles evolves obeying the following equations : @xmath67 @xmath68 where @xmath4 , @xmath5 , and @xmath6 are , respectively , the eulerian coordinates , the peculiar velocity , and the peculiar newtonian gravitational potential .    when @xmath6 is known , the position and velocities of each one of the dark matter particles can be updated from the previous time step .",
    "in our code we solved these equations using a lax - wendroff scheme which is second order .",
    "we summarize the steps to go from time step @xmath69 , where all the variables are known , to the step @xmath70 , using an intermediate step @xmath71 :    1 .",
    "compute the intermediate step : @xmath72 @xmath73\\delta t\\ ] ] 2 .",
    "step @xmath70 : @xmath74 @xmath75\\delta t \\label{dm22}\\ ] ] where the potential at intermediate step , @xmath76 , is computed using a linear extrapolation from @xmath77 and @xmath78 .    in order to recover the continuous density field for dark matter component , @xmath79",
    ", we use triangular shaped cloud ( tsc ) scheme ( hockney & eastwood 1988 ) at each time step .",
    "the gravitational potential is computed by solving poisson s equation . as two components",
    "are considered , gas and dark matter , the source in poisson s equation is the total density contrast : @xmath80 where @xmath81 when @xmath82 and @xmath83 .",
    "poisson s equation ( [ poisson ] ) is solved using fast fourier transform ( fft ) methods ( press et al . 1996 ) .",
    "the fft is used as follows :    1 .",
    "the density contrast in physical space with suitable boundary conditions is the starting point .",
    "2 .   a fft gives @xmath84 ( the fourier component of @xmath14 ) .",
    "poisson s equation in fourier space , @xmath85 ,  being @xmath86 the green s function  is used to get @xmath87 .",
    "the inverse fft leads to the required gravitational potential in physical space .      in order to solve numerically the eq ( [ runge ] ) and eqs ( [ dm1][dm2 ] ) , we need to choose a time step .",
    "the numerical stability of the methods used to integrate these equations imposes several criteria on the time step . at each numerical iteration",
    ", we compute several time steps given by the different stability conditions .",
    "the most restrictive of all of them is selected to advance the gaseous and dark matter components .",
    "the time step criteria we consider are the following :    1 .   courant time .",
    "it is based on the courant condition for stability of an algorithm to solve partial differential equations .",
    "we compute @xmath88 as : @xmath89 where @xmath90 is dimensionless factor between 0 and 1 , and @xmath91 is the sound speed .",
    "this quantity is computed for all cells and the final courant time step is @xmath92 , @xmath93 .",
    "typically , we use @xmath94 .",
    "2 .   dark matter particle cell - crossing time .",
    "we compute the cell - crossing time for the fastest dark matter particle , and define the new time step as a fraction of this crossing time : @xmath95 where we choose @xmath96 .",
    "3 .   expansion time .",
    "the equations we are considering have source terms which include factors due to the cosmological expansion . at early times in particular , these factors can be important and their time variations introduce another time step constraint .",
    "we compute this new time step by imposing a maximum change of 2% in the expansion of the universe . in the case of flat universe without cosmological constant , the time step is : @xmath97 4 .   as an extra criteria to avoid unexpected problems , we also introduce another time step , @xmath98 , which prevents the new time step to increase more than 25% of the global time step for the previous iteration . @xmath99",
    "the global time step is defined as the most stringent of all the previous time steps : @xmath100    at the beginning of the cosmological simulations , @xmath101 is the dominant time criteria but @xmath102 and @xmath103 quickly take over .",
    "the fundamental idea behind the amr technique is to overcome the lack of resolution associated with the fix grid eulerian description .",
    "the basic idea is simple .",
    "regions in the original computational domain in which improved resolution is required are selected according to some criteria ( see sec .",
    "3.1 ) . these new computational domains , which we call _ child grids _ or _ patches _ , are remapped with a higher number of cells and therefore with better resolution .",
    "the values of the different quantities defined on the child grids are obtained by interpolating from the _ parent grid_. once the child grids are built , they can be evolved as an independent computational domain by using the same methods we have described in sec 2 .",
    "although conceptually simple , there are severe technical complications concerning with the communication among the different patches and the boundary problems at different levels .",
    "our implementation of the amr technique follows the one described in berger & colella(1989 ) .",
    "the first step in the construction of the hierarchy of patches is the coarse basic grid on which all the relevant quantities are known . from this starting point",
    ", some criteria must be applied to decide which cells are _",
    "refinable_. these criteria are application dependent and may need to be modified in certain cases . generally speaking ,",
    "our code uses two conditions : i ) if quantities ( like density or pressure ) are larger than a given threshold , and ii ) if gradients of quantities are steeper than a given limit . depending on the applications",
    ", we may ask for only one of these conditions to be satisfied , whereas in other cases both conditions must apply . the routine controlling",
    "this process can easily incorporate new conditions .",
    "all the numerical cells from the coarse grid which satisfy the refinement criteria are labelled as _",
    "refinable_.    in order to illustrate the process of patch generation , let us describe in detail the mechanism for creating new patches at level , @xmath104 , once all the relevant information is known at lower level , @xmath105 .",
    "let us begin with the level , @xmath105 , where according to a set of refinement criteria , we have identified all the cells which fulfil these conditions .",
    "then , we select among the _ refinable _ cells the one which maximizes the refinement criteria ( i.e. if the criteria are based on local density , we chose the cell with the highest density ) . around this maximum , the minimal patch is created by adding two cells along each coordinate direction .",
    "once a patch containing @xmath106 cells is created , the patch is extended two cells along x - axis direction at the high - x end of the patch , such that the new dimension of the patch becomes @xmath107 cells .",
    "if the number of _ refinable _ cells after the extension increases , then the extension is accepted , otherwise this edge remains fixed to the value before the extension .",
    "the same procedure is repeated for the low - x end of the patch . in this way ,",
    "the extension of the patch along x - axis direction is controlled .",
    "exactly same mechanism is repeated for y- and z - axes .",
    "the patch extension procedure goes on until no new _ refinable _ cells are included in the patch , and therefore its dimensions remain unchanged . at this point",
    ", the patch is perfectly defined .",
    "all the cells contained in the recently formed patch are removed from the list of _ refinable _ cells at level @xmath105 .",
    "then , we look again for the remaining _ refinable _ cell which maximizes the refinement criteria , and the process is repeated .",
    "the procedure goes on until all _ refinable _ cells have been allocated in patches , and therefore , all patches at levels @xmath104 have been defined .    according to this mechanism , the basic coarse domain is divided into patches which contain the _ refinable _ cells . as an extra control to avoid the existence of patches with very few _ refinable _ cells , we introduce a new quantity .",
    "the efficiency of the patch , @xmath108 , is defined as @xmath109 , where @xmath110 is the number of _ refinable _ cells in the patch and @xmath111 is the total number of cells in the same patch .",
    "this is a free parameter  which can be adjusted depending on the application  and it controls the minimal efficiency .",
    "therefore , patches with an efficiency lower than the chosen threshold are discarded .    as an additional precaution",
    ", every patch is extended in every direction by adding two extra cells .    when regions on the parent grids are already identified and defined , they are remapped with higher resolution by splitting the coarse cells into new , smaller cells .",
    "the ratio , @xmath112 , between the coarse cell size @xmath113 and the finer cell size @xmath114 is a free integer parameter depending on the particular amr implementation . in our code",
    "we have chosen , @xmath115 .",
    "this choice is a compromise between gaining resolution and avoiding possible numerical instabilities that can results from using a too high value of @xmath112 .",
    "the method previously described produces patches with a boxy geometry and cubic cells ( @xmath116 ) at any level .",
    "at this point , the geometry of the patches , their positions in the parent grid , and their new number of cells , are known .",
    "the next step must be to define the values of the quantities in the equations onto the new , finer grids . in order to do this ,",
    "we have implemented two methods : a _ trilinear _ and a _ tricubic _ monotonic interpolation , respectively ( see for instance press et al .",
    "1996 ) .",
    "the main difference between the two interpolation methods , i.e. trilinear and tricubic , is their order and therefore their accuracy . in applications where few refinement levels are required ,",
    "tricubic interpolation produces better results . when the number of refinements is high and the size of cells is small enough",
    ", both methods produce similar results , though the tricubic interpolation is slightly more cpu intensive .",
    "the procedure described above can be applied recursively .",
    "the patches formed from the coarse grid , now become parent grids .",
    "the process can be applied to them , thus producing a new set of patches in a higher level of refinement .",
    "the method described above allows us to create a whole set of patches at different levels which map our computational domain with adaptable resolution .",
    "the grid hierarchy is reconstructed after each time step , once the system has been evolved in time . at the new time step ,",
    "the hierarchy is rebuilt with the procedure described above . only a fraction of cells would be brand new refined cells , in the sense that they would map a region of the computational domain not previously covered at the previous time step and with the same resolution .",
    "in this situation , it would be a great waste of computational resources to completely rebuild the grid hierarchy by interpolating from the parent levels . in order to improve performance , the cells at a certain level of refinement  at the advanced time  which were in refined patches at the same level at the previous time step ,",
    "are simply updated with their time evolution within their patch .",
    "only those cells covering regions of the computational domain , which were not refined at the previous time step with the same resolution , are assigned with interpolated values from the respective parent patch at a lower level .",
    "it should be noted that the process of grid creation described above , produces a certain degree of overlapping between patches at the same level .",
    "this situation must be kept under control by the code as we do not wish to have a scenario in which cells ",
    "located at the same coordinates but belonging to different patches  could be assigned with slightly different values of the physical quantities .",
    "the process of building the whole set of nested grids and the multidimensional interpolations needed to assign values to the new created cells , is very cpu demanding . in our implementation",
    ", the hierarchy may not be rebuilt every time step .",
    "a free parameter , which depends on the application , controls how frequently the hierarchy can be modified , in the meantime , it remains unchanged .      the gas evolution in the amr implementation",
    "is carried out by evolving the different levels starting from the basic , coarsest level toward the highest , most refined level .",
    "the coarse basic grid ( @xmath117 ) is evolved with a time step @xmath118 , as described in sec 2.2 . after that , all quantities are known on the coarse grid at time @xmath119 . then , we go back to time @xmath120 and advance the level @xmath121 with a time step @xmath122 that satisfies @xmath123 .",
    "this time step , @xmath124 , is computed according to the prescription described in sec 2.5 but for all the patches at level @xmath125 . in certain situations ,",
    "@xmath122 could be equal to @xmath126 , an in principle it seems feasible to save cpu time by using such a time step .",
    "however , and in order to maintain the order of the method , it is recommended that @xmath127 be an integer number larger than 1 . in our particular implementation",
    ", we always ensure that this condition is satisfied .",
    "the patches at level @xmath125 are advanced until they reach time @xmath128 . at this stage",
    ", we say that they _",
    "synchronize _ with the previous level .",
    "this process is repeated in a similar way for all the levels .",
    "thus , all patches at a given level @xmath105 are advanced until @xmath129",
    ". then both levels are synchronized .    in order to evolve the patches within a given level , @xmath105 ,",
    "every patch is extended by two cells on each side .",
    "these cells are defined by interpolation from the parent patch at level @xmath130 .",
    "the interpolation methods used are the same as those described in sec 3.1 . in the case that @xmath131 and more that one step is needed , new values at the boundary cells  at intermediate times between @xmath132 and @xmath133  must be defined at each substep .",
    "the quantities at these boundary cells are defined by interpolation from the parent patch at level @xmath130 whose values at times @xmath132 and @xmath133 are already known .",
    "due to the properties of the algorithm , lower resolution levels evolve first , and therefore , values for the patch quantities at level @xmath130 , at any intermediate time between @xmath132 and @xmath134 , can be obtained by linear interpolation from the values at these times .",
    "every time that the evolution of the patches at level @xmath105 catches up and synchronizes with the evolution of their parent patch @xmath130 , the code runs a procedure whose task is to unify the values of all overlapping cells at different patches within the level @xmath105 .",
    "this is done by defining a master patch per level @xmath105 among the subset of patches which mutually overlap . whenever another patch at the same level overlaps with the master , the value of all quantities at the overlapping cells are copied directly from the master cells .",
    "this process is also crucial to ensure good conservation properties .",
    "the dark matter part of the code also benefits from the amr strategy .",
    "again , the basic idea is to repeat the procedure described in sec 2.3 to take advantage of the preexisting set of patches .    in order to solve poisson s equation",
    ", the continuous dark matter density is required at each patch . the dark matter density in a patch",
    "is obtained using the tsc mesh assignment method with the grid and cell size corresponding to this patch .",
    "all particles within the patch contribute to the density of this patch .",
    "therefore , particles can contribute to the density of different patches at different levels , but are spread with different cloud sizes .",
    "this approach naturally offers the advantage of not having to specify a softening length parameter .    in order to solve poisson s equation ( eq . [ poisson ] ) at levels @xmath135",
    "we use a successive overrelaxation method ( sor ) .",
    "these kind of methods solve eq.([poisson ] ) by discretizing the equation and treating it as a linear system of equations ( see press et al .",
    "@xmath136    the new potential @xmath137 is defined by an iterative process as follows : @xmath138 where @xmath139    the overrelaxation parameter , @xmath140 , is defined in the interval @xmath141 . in order to find the optimum value for the overrelaxation parameter ,",
    "we have used the asymptotic chebyshev acceleration procedure ( see press et al .",
    "1992 ) . following this method ,",
    "the number of iterations ( typically @xmath142 ) is minimized .",
    "once the potential is known at each level , the positions and velocities of all particles can be updated using the eqs ( [ dm11][dm22 ] ) .",
    "however , we must use the values of @xmath143 and @xmath144 corresponding to the highest resolution level patch that each particle is in . a similar methodology of time substepping and synchronization to that described above for the gas",
    "is also implemented for the dark matter .",
    "let us note , that the code can also be applied to dark matter only problems . in these cases ,",
    "the patches are placed according to criteria based on the dark matter distribution and its features .",
    "the above description is based on the idea of repeating the same numerical scheme for each patch independently .",
    "however , several additional mechanisms have to be put in place to avoid problems associated with the abrupt change in resolution at the patch boundaries , such as the violation of conservation properties or numerical instabilities .    from the numerical point of view",
    ", boundaries represent a difficult issue which deserves special attention .",
    "consider a situation in two dimensions , for the shake of simplicity , like the one illustrated by the sketch in figure [ flux ] .",
    "in this case , we focus on the left hand boundary , indicated by the thick central line , of a given patch at level @xmath105 . at this point , on the left hand side of the boundary",
    ", we have the cell @xmath145 of the parent patch at level @xmath130 and four cells @xmath146 , @xmath147 , @xmath148 , @xmath149 on the right side . underlying the four cells of the patch at level @xmath105",
    ", there is also a parent cell @xmath150 , which was evolved together with the parent patch at level @xmath130 .",
    "therefore , the values of quantities at cell @xmath151 and @xmath152 are consistent with a numerical flux at their interfaces of @xmath153 .",
    "according to our scheme , when the child cells are advanced in time and synchronized with their parent patch , we substitute the value for the parent cell , @xmath152 , by an average of the values of the child cells @xmath154 ,",
    "@xmath155 , @xmath156 , @xmath157 . however , these child cells were updated using two numerical fluxes @xmath158 and @xmath159 .",
    "it is clear that due to the non linear character of the problem and the change in the numerical resolution across the boundary , @xmath160 .",
    "therefore , when the value for cell @xmath152 is redefined as the average from its child cells , this new value differs from the previous one which was obtained on the coarse grid , and is therefore linked to its neighbours at the same level by a flux @xmath161(in our example it would refer to the cell @xmath151 ) . the assignation of new values for the quantities at cell @xmath152 must imply a correction for the values at its neighbour cells at the level @xmath130 .",
    "these effects must be taken carefully into account , otherwise severe numerical problems can develop .    in order to overcome this problem , berger & colella ( 1989 ) designed a technique known as _",
    "refluxing_. in this method , after all values have been advanced in time , and patches at different levels have been synchronized , the value of the parent cells next to a boundary ( @xmath151 in our example ) are modified according to the flux difference between the coarse flux ( @xmath162 ) and the average of the fine fluxes ( @xmath163 ) . in the above explanation , and for the sake of simplicity , we have assumed that @xmath164 . in a general case when @xmath165 , the fine fluxes ( @xmath163 ) for all the substep have to be added and compared with the coarse flux ( @xmath162 ) .",
    "a detailed description of this technique can be found in berger & colella ( 1989 ) .",
    "another issue related with the change of numerical resolution at boundaries between patches has to do with spurious oscillations of the gravitational forces .",
    "the potential is sensitive to changes of resolution .",
    "therefore , the evolution of the gas volume elements and dark matter particles can be affected by spurious oscillations created by changes in the resolution of the gravitational potential across the patch boundaries . the way we have avoided these problem is by using a smooth transition method ( see anninos , norman & clarke 1994 ; jessop et al .",
    "1994 ) . in our scheme , particles and gaseous cells in a patch at level @xmath105",
    "are split in three groups : i ) if the particles or cells are located at a distance less than two cells ( one cell for the level @xmath130 ) from any of the boundaries of the patch , they evolve with the potential of the parent patch @xmath166 , ii ) particles or cells located at a distance between two cells and four cells to the boundaries evolve with a linear combination of potential @xmath166 and @xmath144 , being @xmath166 at a distance of two cells and @xmath144 at four cells distance , and iii ) the rest of particles or cells which evolve with the potential @xmath144 .",
    "we have found that this method has cured any problem arising from oscillations in the gravitational forces .",
    "the so - called shock tube problems are a set of solutions of different riemann problems associated with the equations governing the dynamics of ideal gases in 1d planar symmetry , and when the gas is , initially , at rest .",
    "they involve , in general , the presence of shocks , rarefactions and contact discontinuities .",
    "taking into account the fact that the analytical solution of the riemann problem is well - known , they are considered as standard test - beds for checking a hydro - code .    in order to take advantage of the analytical solution of the standard shock tube problem ,",
    "we have considered a computational domain defined by a cube ( one unit length each edge ) in which a discontinuity has been placed parallel to one of the cube faces .",
    "this discontinuity separates the system in two states .",
    "initially , both states have the same density ( @xmath167 ) and velocity ( @xmath168 )",
    ". pressure on the left ( right ) hand side of that discontinuity is @xmath169 ( @xmath170 ) .",
    "the coarse grid ( @xmath117 ) used in these computations has @xmath171 cells .",
    "the evolution from the above initial data leads to the formation of a rarefaction wave , a contact discontinuity , and a shock wave .",
    "figure [ tube ] displays the results using four levels ( squares ) compared with analytical results ( solid line ) .",
    "refinements have been placed dynamically by taking into account three conditions .",
    "the first condition is based on thresholds on the relative jumps in pressure .",
    "for example , for a given cell @xmath172 , the relative jump along x - direction is defined as @xmath173 .",
    "the jumps are computed for the three directions ( x , y , z ) and the condition is satisfied if any of them is larger than the given threshold .",
    "the second condition is similar to the previous one but is applied to the density .",
    "the third condition looks at relative variations of right and left velocity derivatives . for a given cell @xmath172",
    ", we define the right derivate as @xmath174 and the left derivate as @xmath175 .",
    "the relative variation of the derivate is defined as @xmath176 .",
    "the first condition is specially suited for identifying shocks , second condition finds shocks and contact discontinuities , whereas the third condition can track the head and tail of the rarefaction waves .",
    "the code has automatically allocated and deallocated the numerical patches needed to integrate the hydrodynamics equations . in order to illustrate the refinement structure ,",
    "the location of each patch and their level are plotted in the bottom panel of figure [ tube ] .",
    "the main features of the analytical solution are recovered well .",
    "the shock is sharply resolved in two or three cells of the highest level . the contact discontinuity and the rarefactions wave",
    "are also well described .",
    "tiny oscillations are visible in the velocity associated with the contact discontinuity .",
    "bertschinger ( 1985 ) presented the solution for the evolution of a single mass perturbation in a flat einstein - de sitter universe with no cosmological constant .",
    "given a perturbation of radius @xmath177 at time @xmath178 with overdensity @xmath179 , shells of matter surrounding the perturbation start to decelerate and eventually decouple from the hubble flow at some `` turn around '' time which is related to the parameters defining the perturbation as follows : @xmath180    for a collisional fluid , the infalling matter produces an increase in pressure which eventually results in a strong shock wave propagating outwards . according to bertschinger s solution ,",
    "the position of the shock is given by @xmath181 .",
    "due to the self - similar character of the problem , the solution is fully characterized by the dimensionless functions v , d and p : @xmath182    functional forms for v , d , and p can be found in bertschinger ( 1985 ) for different values of the adiabatic exponent @xmath183 .",
    "we have set up an initial perturbation with @xmath184 and @xmath185 at a given time .",
    "the simulation has been done using four refinement levels and a coarse grid with @xmath171 cells .",
    "this is an extremely stringent test for our code , because a strong shock moves outwards and the self - similarity has to be kept numerically .",
    "moreover , it is a spherical problem described with a cartesian code .",
    "it should be stressed that this test also checks the multilevel poisson solver described above .",
    "the refinement criteria is based on a lagrangian approach which tries to keep same mass within any cell of the simulations regardless of the level of refinement . in order to do that ,",
    "a cell in the coarse grid is labelled as _",
    "refinable _ when its density is higher than the background density ( @xmath186 ) ; therefore , the initial perturbation is completely refined .",
    "the cells at first levels are labelled as _ refinable _ when their density exceeds the initial mean density at the coarse level by a factor of eight , that is when the local density is larger than @xmath187 .",
    "the process is similar for higher levels , thus for example , for the second level the condition for a cell to be refineable is a local density higher than @xmath188 .",
    "figure [ bert ] shows the results ( triangles ) compared with the analytical solution from bertschinger ( 1985 ) after four thousand time steps .",
    "the numerical solution exhibits a good agreement with the analytical one .",
    "it must be noticed that in the pressure plot , numerical limitations force a low , non - zero numerical value for the pressure  although with irrelevant physical consequences  as the code can not cope with a zero value .",
    "self - similarity is well maintained for as long as we have kept this test running ( more than six thousand time steps ) . to illustrate the convergence properties , we display the results ( squares ) when only two refinement levels are allowed .",
    "force accuracy is crucial to describe correctly the dynamics of both the dark matter and gaseous components . in order to test the properties of our gravity solver",
    ", we present a simple test comparing the acceleration when a single point mass is considered .",
    "we have placed a single point mass ( @xmath189 ) at the centre of the computational box .",
    "the numerical acceleration is computed for several thousand test points randomly placed within the computational domain .",
    "the basic grid has @xmath171 cells .",
    "this procedure is repeated with two , four , and six nested refinements . in each of these cases ,",
    "the massive particle is always located at the finest refinement . in the upper panel of figure [ gravity ]",
    ", we plot the relative errors of the computed accelerations when compared with the theoretical ones given by @xmath190 , as a function of the radial distance normalized to the distance from the box centre to the edge of the computational box . due to the pm - like",
    "scheme we are using , the forces are obtained by differencing the potential values between neighbouring cells .",
    "when the separation between two particles is less than two cells , the forces computed with the pm - like method are affected by considerable errors .",
    "these errors are maximal when particles lay within the same cell , as the numerical derivative of the potential vanishes . in figure",
    "[ gravity ] , this behaviour is clearly visible when the distance approaches the cell size for each level",
    ". the higher the level of refinement , the smaller the spatial range of the force errors , as they are always linked to particle separations smaller than two cells , and the cell sizes shrink for higher levels .",
    "lower panel in figure [ gravity ] shows the relative errors for the numerical acceleration for the four level case ( points ) and the error for the acceleration for a plummer potential , @xmath191 .",
    "the softening , @xmath9 , is set to the cell size of the refinement level including the massive particle . in this case",
    ", distance is in units of grid cells of the finest refinement level .",
    "it should be noted that , whereas the plummer acceleration marginally catches the @xmath192 law at 6 or 7 cells , our result oscillates around this value at two cells .    the implementation of the gravity solver described above naturally fixes the force softening to the local properties of the solution in an unambiguous way . in this sense ,",
    "numerical problems like the two - body effects can be suppressed because the cell size can be adapted depending on the local density .",
    "this is an important advantage respect to the codes using a fix softening .      the best test we can think of for a cosmological code in a realistic setting is to compare with the results presented in frenk et al .",
    "( 1999 , hereafter f99 ) . in this reference , the authors performed adiabatic simulations of a galaxy cluster with several codes .",
    "this work not only allows a comparison between the different codes and schemes , but also establishes a standard test .",
    "we have adopted the initial conditions used in f99 to simulate with our code the so - called santa barbara cluster ( sb ) .",
    "the initial conditions were generated in order to obtain a galaxy cluster of mass @xmath193 located at the centre of a computational box of side length 64 mpc .",
    "the coarse grid ( l=0 ) has @xmath171 cells . the first refinement ( l=1 ) is fixed covering the central 32 mpc and has also @xmath171 cells which are half the size of their parent cells .",
    "higher refinements are carried out according to a local density criteria .",
    "two groups of dark matter particles  with different masses  are used . at the initial time , the first group of particles is located within the region of computational domain that is not covered by the refinement , whereas the second group is placed on the refinement .",
    "therefore , on the part of the coarse grid ( l=0 ) not refined , we place @xmath194 particles with individual mass , @xmath195 , whereas on the first refinement ( l=1 ) , there are @xmath171 particles with mass , @xmath196 .",
    "the cosmological parameters assumed are @xmath197 , and the baryon content is @xmath198 .",
    "the simulation was started at @xmath199 .",
    "the refinement criteria is based on the local gas density .",
    "any cell with a baryonic mass larger than @xmath200 is labelled as _",
    "refinable_. this procedure is repeated up to six levels ( l=6 ) , which means that the highest comoving spatial resolution is @xmath201 , although the real resolution is a factor of two worse than this value , as the gravity part of the code needs two cells in order to compute the gravitational force .    in figure [ profiles ] radial profiles for gas density , dark matter density , temperature , entropy ( @xmath202 $ ] ) , pressure , and gas radial velocity",
    "are shown , respectively .",
    "the profiles have been computed by averaging the quantities in spherical shells of 0.2 dex logarithmic width .",
    "the inner radius of the first shells is @xmath203 and the outer radius of the last one is @xmath204 . in order to compare with f99 results",
    ", each panel displays the average results of all simulations ( dashed line ) , results from jenkins & pearce s simulation using hydra sph ( triangles ) , and the simulation of bryan & norman using the samr eulerian code ( crosses ) .",
    "open circles show the results of our simulation .",
    "our results show very good agreement with the general trends shown by the average results of all simulations .",
    "there is a particularly good match with the profiles from bryan s samr code .",
    "nevertheless , there are differences between the profiles in f99 and the ones we have obtained in our simulation which deserve further comments .",
    "our results exhibit a slightly steeper dark matter density profile in the inner most regions . in the sb cluster simulation",
    ", there is a merger event at @xmath205 .",
    "we would suggest that this fact could produce the small differences in the final state of the cluster , leading to minor discrepancies in the comparison .",
    "we note that our simulations at @xmath206 show a better agreement  in the global quantities , radial profiles , and 2d images  with the results in f99 . in any case , we believe our results are consistent with f99 .",
    "in addition to the differences previously mentioned , there is also a systematic natural dispersion due to factors like the way in which the initial conditions are implemented , the different approaches when averaging to compute the radial profiles , and the inherent peculiarities of each particular numerical algorithm .",
    "it is notable that similar results to ours have been obtained by kravtsov , klypin & hoffman ( 2002 ) when they tested their new amr - like code using the santa barbara test .",
    "these authors claim that their profiles are consistent with the recent results  using very high resolution simulations  presented by ghinga et al .",
    "( 2000 ) , klypin et al . ( 2001 ) , and power et al . ( 2003 ) .",
    "returning to the physical meaning of our simulations , our results reinforce the difference  first revealed in f99 by bryan s results  between sph and eulerian codes .",
    "these alarming differences are particularly dramatic in the thermodynamics of the gas , and quantities like temperature or entropy clearly manifest different trends .",
    "there is no doubt that these differences are evidence of different physical properties , and could therefore be crucial in the process of structure formation .",
    "new formulations of sph , like the _ entropy - conserving _",
    "( springel & hernquist 2002 ) which is written in conservative form similar to the eulerian schemes , have dramatically improve the comparison . in a detailed study , ascasibar et al .",
    "( 2003 ) simulated a cluster of galaxies  similar to the sb cluster  using the eulerian code art(kravtsov , klypin & hoffman 2002 ) and sph code gadget(springel & hernquist 2002 ) .",
    "the outcome of their simulation showed how the results of the new sph implementation are closer to the ones produced by the eulerian amr codes .",
    "although encouraging , there are still significant differences in the entropy and temperature profiles . a good example of these differences is given by okamoto et al .",
    "( 2003 ) , where the authors proved that standard sph approach produces artificial effects which can lead to unrealistic results when studying galaxy formation .",
    "these spurious effects are not necessary linked to the artificial viscosity used by the sph method .",
    "figure [ panel1 ] shows , at the final redshift @xmath207 , the gas column density along the z - axis in the different regions .",
    "the top panel ( a ) shows a region of 64 mpc side length , where the column density has been computed by integrating along the central 32 mpc .",
    "panels ( b ) and ( c ) , show the column density maps for two zooms into the central region .",
    "the images show regions of 16 and 4 mpc side , integrated along 8 and 2 mpc , respectively .",
    "the pixelization effect introduced by the variation in the cell size corresponding to the different levels is clearly visible , as is a web of gaseous filaments linking the structures .",
    "it should be noted that there are no unphysical effects associated with filaments crossing the boundaries of patches at different levels .    in figure [ multipanel ] , we present several panels displaying maps of the following quantities : a ) gas column density , b ) dark matter column density , c ) x - ray surface brightness calculated as @xmath208 where @xmath209 , and d ) emission - weighted temperature calculated as @xmath210 .",
    "all images correspond to the projection of these quantities along the z - axis in the 8 mpc central box .",
    "the gross features are similar to the images in f99 , although , as the average profiles showed , there are differences in some of the details .",
    "the dark matter ( figure [ multipanel ] , panel b ) column density looks very similar to results from the highest resolution simulations in f99 .",
    "smoothing and presentation effect apart , the substructure in our simulation matches the results from jenkins & pearce ( sph ) and bryan & norman ( amr ) .    the rich structure of shocks , voids , gradients and turbulence can be shown by displaying the entropy and temperature within a thin slice containing the centre of the cluster .",
    "figure [ multipanel2 ] displays the entropy and the logarithm of temperature in four thin slices .",
    "upper ( lower ) panels of figure [ multipanel2 ] show a zoom of the central 8 mpc ( 2 mpc ) .",
    "the images in black and white , are encoded in such a way that black ( white ) stands for the minimum ( maximum ) value of the quantity plotted .",
    "the entropy plots show a constant entropy core ( panels ( a ) and ( c ) in figure [ multipanel2 ] ) . in the temperature maps ( panels ( b ) and ( d ) )",
    "several features are noticeable .",
    "a rich structure of shock is visible at all scales .",
    "the existence of cold regions embedded in the central hot structure is another remarkable feature . in all cases ,",
    "a highly turbulent structure is clearly visible .",
    "all these features can be studied due to the good shock capturing properties of the algorithm .",
    "the santa barbara run has been performed using the parallel version of the code , which has been tested in different architectures . in particular , the run studied in this section was performed in an origin 3800 using 8 processors , and took 130 hours of cpu time , with a memory requirement of around 2 gb .",
    "we have described and tested a new cosmological code specially designed to study the formation and evolution of cosmological structures , i.e. galaxy cluster , galaxies , etc .",
    "the code can follow the hydrodynamics of the gas in a cosmological context , the dark matter component , and the gravity of the two coupled components .",
    "the main ingredients of the code are : i ) a hydro solver based on high - resolution shock - capturing techniques , ii ) a n - body solver based on the generalization of the particle mesh scheme , iii ) a poisson solver which combines fft and sor techniques , and iv ) an adaptive mesh refinement ( amr ) scheme which allows us to gain resolution in schemes ( i)-(iii ) by refining the grid as required according to several application dependent criteria .    a set of tests , including a realistic cosmological simulation known as the santa barbara cluster ,",
    "have been performed so as to explore the reliability of the code .",
    "all of them have been passed successfully .",
    "the whole package of the different ingredients represents a powerful code which will be able to tackle  with very high spatial and time resolution  all sort of challenging cosmological problems without giving up an accurate description of the physical properties of the gaseous and dark matter components .",
    "previous results using amr simulations  with resolution comparable to those of sph  showed substantial differences in quantities like temperature and entropy with respect to sph results .",
    "this is an important conclusion  confirmed by our simulations  which points out crucial differences between the sph and the eulerian methods when describing the physics of structure formation .",
    "amr codes , like the one presented in this paper , will be essential tools in the future of numerical cosmology .",
    "they combine successfully the best properties of previous traditional approaches : i.e. excellent spatial resolution of the sph techniques , and an accurate description of the hydrodynamics of the problem ( handling of shocks and discontinuities , treatment of void regions , accurate thermodynamics , turbulence , and some others ) inherited from the eulerian codes based on riemann solvers .",
    "* acknowledgements*. vq is a ramn y cajal fellow of the spanish ministry of science and technology .",
    "this works has been partially supported by grant aya2003 - 08739-c02 - 02 ( partially financed with feder funds ) .",
    "the author gratefully acknowledges the enlightening comments of the referee and wishes to thank the following for useful discussions and comments : r. bower , c. baugh , c.s .",
    "frenk , l. heck , j.m@xmath211 .",
    "ibez , a. jenkins , j.m@xmath211 .",
    "mart , b. moore , and t. okamoto .",
    "simulations were carried out as part of the virgo consortium on cosma at institute for computational cosmology and cosmos at uk computational cosmology consortium , and in the servei dinformtica de la universitat de valncia ( cerca and cesar ) .    aarseth s.j . , 1963 , mnras , 126 , 223 anninos p. , norman m.l . , clarke d.a . , 1994 , apj , 436 , 11 ascasibar y. , yepes g. , mller v. , gottlber s. , 2003 , 346 , 731 berger m.j . , colella p. , 1989",
    ", j. comp .",
    "82 , 64 berger m.j .",
    ", oliger j. , 1984 , j. comp .",
    "phys . , 53 , 484 bode p. , ostriker j.p . , 2003 , apjs , 145 , 1 bryan g.l .",
    ", norman m.l . , stone j.m.m cen r. , ostriker j.p . , 1995 ,",
    "comput . phys .",
    "comm . , 89 , 149 bryan g.l . , norman m.l",
    ". , 1997 , in asp conf .",
    "123 : computational astrophysics ; 12th kingston meeting on theoretical astrophysics , 363 blumenthal g.r . , faber s.m .",
    ", primack j.r .",
    ", rees m.j . , 1984 , nature , 311 , 517 colella p. , woodward p.r . , 1984 , j. comp .",
    "54 174 couchman h.m.p . , 1991 , apjl , 368 , l23 davis m. , efstathiou g. , frenk c.s . , white s.d.m . , 1985 , apj , 292 , 371 evrard a.e . , 1988 ,",
    "mnras , 235 , 911 frenk c.s .",
    "et al . , 1999 ,",
    "apj , 525 , 554 gingold r.a . , monaghan j.j . , 1977 , mnras , 181 , 375 gheller c. , pantano o. , moscardini l. , 1998 , mnras , 295 , 519 ghigna s , moore b. , governato f. , lake g. , quinn t. , stadel j. , 2000 , apj , 554 , 616 gnedin n.y . , 1995 ,",
    "apjs , 97 , 231 godunov s.k . , 1959 , matematicheskii sbornik , 47 , 271 hernquist l. , katz n. , 1989 , apjs , 70 , 419 hockney r.w .",
    ", eastwood j.w . , 1988 , computer simulation usign particles .",
    "iop publising jessop c. , duncan m. , chau w.y . , 1994 , j. comp .",
    "115 , 339 klypin a. , kravtsov a.v .",
    ", bullock j.s . , primack j.r . , 2001 , apj , 554 , 903 knebe a. , andrew g. , binney j , 2001 , mnras , 325 , 845 kravtsov a.v . , klypin a. , hoffman y. , 2002 , apj , 571 , 563 kravtsov a.v . , klypin a. , khokhlov a.m. , 1997 , apjs , 111 , 73 laney c.b . , 1998 , computational gasdynamics , cambridge univ .",
    "press le veque r.j . , 1992 , numerical methods for conservation laws .",
    "birkhuser verlag .",
    "lucy l.b . , 1977 ,",
    "aj , 82 , 1013 okamoto t. , jenkins a. , eke v.r .",
    ", quilis v. , frenk c.s .",
    ", 2003 , mnras , 345 , 429 peebles p.j.e . , 1970 ,",
    "aj , 75 , 13 peebles p.j.e . , 1980 , the large scale structure of the universe .",
    "princeton university press .",
    "peebles p.j.e . , 1982 , apjl , 263 , l1 pen u.l . , 1995 ,",
    "apjs , 100 , 269 press w.h . , teukolsky s.a . , vetterling w.t . , flannery b.p .",
    ", 1996 , numerical recipes in fortran 77 : the art of scientific computing .",
    "cambridge university press power c. , navarro j. f. , jenkins a. , frenk c. s. , white s. d. m. , springel v. , stadel j. , quinn t , 2003 , mnras , 338 , 14 quilis v. , ibez j.m@xmath211 .. sez d. , 1994 , a&a , 286 , 1 quilis v. , ibez j.m@xmath211 .. sez d. , 1996 , apj , 469 , 11 roe p.l . , 1981 , j. comp .",
    "phys . , 43 , 357 ruy d. , ostriker j.p .",
    ", kang h. , cen r. , 1993 , apj , 414 , 1 shu c. , osher c. , 1988 , j. comp .",
    "phys . , 77 , 439 splinter r.j . , 1996 , mnras , 281 , 281 springel v. , yoshida n. , white s. d. m , 2001 , new astronomy , 6 , 79 springel v. , hernquist l. , 2002 , mnras , 333 , 649 teyssier r. , 2002 , a&a , 385 , 337 toro e. , 1997 , riemann solvers and numerical methods for fluid dynamics , springer - verlag van leer b. , 1979 , j. comp .",
    "phys . , 32 , 101 villumsen j.v . , 1989 , apjs , 71 , 407 white s.d.m . , 1976 ,",
    "mnras , 177 , 717"
  ],
  "abstract_text": [
    "<S> a new cosmological multidimensional hydrodynamic and n - body code based on an adaptive mesh refinement scheme is described and tested . </S>",
    "<S> the hydro part is based on modern _ high - resolution shock - capturing _ techniques , whereas n - body approach is based on the particle mesh method . </S>",
    "<S> the code has been specifically designed for cosmological applications . </S>",
    "<S> tests including shocks , strong gradients , and gravity have been considered . a cosmological test based on santa barbara cluster </S>",
    "<S> is also presented . </S>",
    "<S> the usefulness of the code is discussed . in particular , this powerful tool is expected to be appropriate to describe the evolution of the hot gas component located inside asymmetric cosmological structures .    </S>",
    "<S> hydrodynamics  methods : numerical  galaxy formation  large - scale structure of universe  cosmology </S>"
  ]
}