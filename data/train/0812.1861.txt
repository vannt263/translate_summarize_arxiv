{
  "article_text": [
    "a three - dimensional model of a helical wiggler free electron laser ( fel ) is presented that minimises the assumptions made .",
    "this model does not average the maxwell ",
    "lorentz equations describing the interaction between the electrons , wiggler and radiation fields .",
    "furthermore , no relativistic approximations in the equations governing electron motion are made and transverse motion of the electrons is self - consistently driven by both the wiggler and radiation fields .",
    "current 3d codes perform averaging over a radiation wavelength of the radiation and others also over the the electron trajectories .",
    "thus no study of the effects of coherent spontaneous emission ( cse ) or self amplified coherent spontaneous emission ( sacse ) is possible .",
    "furthermore , these codes can not model large energy losses by the electrons as the electrons are confined locally to a wavelength . in this model",
    "no such averaging is done and so sub - period radiation evolution is included and electron migration over distances greater than a wavelength , for example due to locally high radiation powers , may be described .",
    "following the method of previous studies for the one - dimensional fel the physics of the fel may be described in three dimensions by the coupled maxwell ",
    "lorentz equations @xmath0 @xmath1 where @xmath2 , the total number of electrons , and the transverse current density may be written @xmath3 where @xmath4 is the electron rest mass . the helical wiggler and radiation electric field",
    "are assumed to be @xmath5\\hat{\\bf{z } } \\nonumber\\\\ { \\bf e}(\\mathbf{r},t ) & = & \\frac{1}{\\sqrt{2 } } ( \\hat{\\bf{e}}\\ ; \\xi_0({\\bf r},t ) e^{i(kz-\\omega t ) } + c.c . )",
    "\\end{aligned}\\ ] ] where @xmath6 , @xmath7 is a slowly varying complex field envelope and @xmath8 is the wiggler magnetic field strength of period @xmath9 .",
    "the magnetic component of the radiation field @xmath10 is required in the lorentz equation and may be calculated from maxwell s equations to give : @xmath11 where it has been assumed that any radiation that is counter - propagating the electron beam may be neglected .",
    "the following scaling notation is now introduced : @xmath12 where @xmath13 is the mean electron velocity on entering the interaction region , @xmath14 is the resonant electron energy and @xmath15 is the fundamental fel parameter , defined as @xmath16 here @xmath17 is the plasma frequency for the peak electron number density of the electron pulse @xmath18 , and @xmath19 is the wiggler deflection parameter .",
    "the scaled electron density is defined as @xmath20 , where @xmath21 is the gain length and @xmath22 the cooperation length .",
    "note the scaling in the transverse plane is with respect to the physically relevant gain and cooperation lengths .",
    "this allows the equations above describing the fel interaction to be written as @xmath23 @xmath24 - \\\\ &   & \\mbox { } \\frac{a_w^2 \\varepsilon}{8\\rho^2}\\sqrt{\\frac{q_j(2+\\varepsilon q_j)}{(1+|\\bar{p}_{\\perp j}|^2 ) } } \\frac{(\\bar{x}_j - i\\bar{y}_j)}{(1+\\varepsilon q_j)^2}\\nonumber \\\\ \\label{eq : qeqn } \\nonumber \\frac{d q_j}{d\\bar{z } } & = & \\frac{a_w}{4\\rho } \\frac{q_j ( \\varepsilon q_j + 2)}{1+|\\bar{p}_{\\perp j}|^2 } \\times \\\\ \\nonumber & & \\left[i(\\varepsilon q_j+1)(\\bar{p}_{\\perp j}^ { * } e^{-i\\frac{\\bar{z}}{2\\rho } } - c.c . )",
    "+ \\right.\\\\ & & \\left.\\alpha\\varepsilon q_j ( \\bar{p}_{\\perp j}^ { * }   a e^{-i\\frac{\\bar{z}_{2j}}{2\\rho } } + c.c . )",
    "\\right ] \\\\ \\label{eq : z2eqn } \\frac{d\\bar{z}_{2j}}{d\\bar{z } } & = &   q_j \\\\ \\label{eq : xeqn } \\frac{d\\bar{x}_j}{d\\bar{z } } & = & \\re(\\bar{p}_{\\perp j})\\sqrt{\\frac{q_j(2+\\varepsilon q_j)}{1+|\\bar{p}_{\\perp j}|^2}}\\\\ \\label{eq : yeqn } \\frac{d\\bar{y}_j}{d\\bar{z } }   & = & -\\im(\\bar{p}_{\\perp j})\\sqrt{\\frac{q_j(2+\\varepsilon q_j)}{1+|\\bar{p}_{\\perp j}|^2}}\\end{aligned}\\ ] ] in deriving the equations the only approximations made are the neglect of space charge and the paraxial approximation .",
    "there are no restrictions on the electron energy allowing large changes to be modelled .    in the scaled variables used here ,",
    "the normalised beam emittance is given by @xmath25 for an electron beam matched to a focussing channel the radius of the electron beam envelope is given by @xmath26 the electrons experience a natural focussing force due to the magnetic field of the helical wiggler @xcite resulting in a beta - function of @xmath27 .",
    "this restoring force is approximated by the final linear term in ( [ eq : pperpeqn ] ) and may be simply modified in magnitude to approximate other , e.g.  fodo , focussing channels .    the scaled rayleigh range ( in units of @xmath28 )",
    "can be shown to be @xmath29 , where @xmath30 is the radius of the beam in scaled units of @xmath31 .",
    "it can be shown that the above equations satisfy energy conservation , written in the form : @xmath32 which may be used as a check in the numerical solution .    in the relativistic compton limit",
    "@xmath33 the above equations can be shown to reduce to those of  @xcite .",
    "the field evolution of the scaled equations ( [ eq : waveeqn])([eq : yeqn ] ) are solved by applying a modified parallel fourier split - step method @xcite in conjunction with a finite element method @xcite .",
    "this allows the effects of coherent spontaneous emission ( cse ) , self - amplified spontaneous emission ( sase ) and diffraction to be modelled numerically .",
    "the parallel code was developed using the numerical algorithms group ( nag ) parallel routines to control the parallel processing .",
    "the fourier split - step method involves solving the wave equation in two steps .",
    "the first step considers the field diffracting in the transverse direction and propagating in the @xmath28 direction freely without the electron source term : @xmath34 this equation can be solved by taking the fourier transforms in @xmath35 , @xmath36 and @xmath37 resulting in an ordinary differential equation in the fourier transformed field @xmath38 , with the following analytic solution : @xmath39,\\ ] ] where the transverse fourier transform variable pairs are given by @xmath40 , @xmath41 , @xmath42 and @xmath43 .",
    "the inverse numerical fourier transform is then applied giving solution @xmath44 which is then used as the initial field for the second part of the split - step method where the diffraction terms are neglected and the source term acts alone : @xmath45 the finite element method is then used to solve the wave equations ( [ eq : waveeqnsplitstep2 ] ) and ( [ eq : pperpeqn])([eq : yeqn ] ) along with a fourth order runge - kutta method for electron variables to give the final solution .    before applying the finite element method to the wave equation , the summation over the real electrons has to be changed to a summation over a group of macroparticles , each of which represents many real electrons .",
    "this reduces the computational memory load and operation : @xmath46 where subscripts @xmath47 and @xmath48 indicate evaluation at the particle position , @xmath49 is the total number of macroparticles and @xmath50 is the charge weight of the macroparticle in units of the electron charge .",
    "the galerkin method of the finite elements is used .",
    "the field is described by a set of 8-node hexahedral elements with linear basis functions @xmath51 and nodal values @xmath52 : @xmath53 where @xmath4 is the global node index of the 3d system .",
    "note that @xmath54 outwith the elements to which it belongs .",
    "the wave equation  ( [ eq : waveeqnsplitstep2 ] ) then reduces to a matrix equation for the nodal points : @xmath55 where @xmath56 is the stiffness matrix constructed from the elemental equations  @xcite , @xmath57 is a macroparticle weighting function and @xmath58 is the scaled volume of an element of the system , @xmath59 .",
    "to test the 3d model a comparison with the 1d results of  @xcite was made . in these",
    "one - dimensional models the wave equation was integrated analytically over the common electron / radiation transverse area before numerical solutions were obtained .    here",
    ", one element is used in the transverse plane approximating the radiation field to a plane wave and allowing integration over the transverse area and comparison with the 1d results .",
    "the electron beam radius was set greater than the electron orbital radius ensuring the electron beam does not move significantly in the transverse plane of the element .",
    "a gaussian distribution for the electrons in the transverse plane was used with a range of six times the standard deviation .",
    "the results of  @xcite fig .",
    "2 showing self - amplified coherent spontaneous emission ( sacse ) for a top - hat pulse current are reproduced in fig .",
    "( note that there is a scale reversal as  @xcite plots the power as a function of @xmath60 while here it is plotted as a function of @xmath37 . )    the scaled radiation power @xmath61 as a function of @xmath37 demonstrating good agreement with the 1d model of  @xcite fig .",
    "2,width=321 ]    the coherent spontaneous emission , including the effects of shot noise , from both square and gaussian shaped pulses of  @xcite were also reproduced . in fig .",
    "[ fig2 ] the top hat case of  @xcite  fig .",
    "4 is plotted .    the scaled radiation power @xmath61 as a function of @xmath37 demonstrating good agreement with the 1d model of  @xcite  fig .",
    "4,width=321 ]    good agreement between the 1d models of  @xcite and the 1d limit of the 3d model of this paper are observed .",
    "an example of the code operating in 3d is now presented .",
    "the parameters used are not intended to model any specific system , but rather to demonstrate the functioning of the code and its associated post - processing and plotting routines .",
    "a relatively simple system was chosen with a short electron pulse so that coherent spontaneous effects can be observed and large computational effort is not required .",
    "the energy spread and the emittance of the beam were set to zero , the emittance by setting @xmath62 for all electrons .",
    "focussing was therefore not required for this simulation .",
    "the code was run using 16-processors of a parallel computer with parameters shown in table  [ table ] .",
    ".[table]3d parameters [ cols= \" < , < \" , ]     fig .",
    "[ fig3 ] plots the scaled intensity @xmath61 across a transverse slice at the head of the electron pulse , just as the radiation escapes to propagate into vacuum . in fig .",
    "[ fig4 ] the scaled power ( @xmath61 integrated across the transverse plane ) is plotted as a function of @xmath37 following a fel interaction to @xmath63 .",
    "both plots demonstrate the main features of fel interaction with coherent spontaneous emission and the energy conservation relation of  ( [ energy ] ) is confirmed to within 0.5% .",
    "further testing of the code is being carried out and will be reported upon in a future publication .    the scaled radiation intensity @xmath61 in the transverse @xmath64 plane at @xmath63 .",
    "the transverse slice is taken at the ` head ' of the electron pulse at @xmath65.,width=321 ]    the scaled radiation power at @xmath63 as a function of @xmath37 .",
    "the electron pulse is shown on the @xmath37 axis lying between @xmath66 . in this frame",
    "the electron pulse propagates along @xmath37 with increasing @xmath28.,width=321 ]",
    "a new parallel code has been developed which models the fel amplifier by solving a system of scaled equations describing the fel interaction in three spatial and the time dimension .",
    "the aim has been to introduce as few approximations into the model as possible , the main assumptions being the neglect of space charge and any backward propagating radiation fields .",
    "this allows the effects of coherent spontaneous emission , diffraction and full electron transport throughout the region of integration to be modelled .",
    "furthermore , the sub - wavelength discretisation of the model allows a significantly wider range of radiation frequencies to be modelled than is possible with most other codes that use a minimum discretisation interval of a radiation wavelength .",
    "a 1d limit of the computational model was identified and simulation results in this limit show agreement with previous 1d numerical and analytical models .",
    "a further example simulation has been presented which demonstrates the code operating successfully using an electron pulse in three dimensions .",
    "further optimisation of the code is ongoing .",
    "while the code is undoubtedly slower to operate than other 3d averaged codes , the extended physics that it can model may be expected to yield interesting new phenomena in fel physics ."
  ],
  "abstract_text": [
    "<S> a new three - dimensional model of the fel is presented . </S>",
    "<S> a system of scaled , coupled maxwell  </S>",
    "<S> lorentz equations are derived in the paraxial limit . </S>",
    "<S> a minimal number of limiting assumptions are made and the equations are not averaged in the longitudinal direction of common radiation / electron beam propagation , allowing the effects of coherent spontaneous emission and non - localised electron propagation to be modelled . </S>",
    "<S> the equations are solved numerically using a parallel fourier split - step method . </S>"
  ]
}