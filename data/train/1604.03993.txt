{
  "article_text": [
    "one of the basic tasks in understanding the structure and function of complex networks is the identification of community structure or modular organization , where by a community we mean a subset of densely interconnected nodes , only sparsely connected to outsiders ( cf .",
    "@xcite , @xcite ) . a widely popular approach to community detection is the method of modularity clustering , introduced by newman and girvan ( cf .",
    "@xcite , @xcite ) , which specifies an optimal clustering  that is , a partition of the network  as the solution of a certain optimization problem ( see section [ model ] for precise definitions ) .",
    "in particular , the method is used for a variety of networks arising in scientific contexts , including metabolic networks @xcite , epigenetic networks @xcite , brain networks @xcite , and networks encoding ecological @xcite and political interactions @xcite .    on the other hand , a popular model of complex networks with geometric structure",
    "is the random geometric graph , where vertices are sampled from a geometric domain and edge weights are determined by a function of the distance between vertices @xcite , @xcite , @xcite .",
    "we note , a well - studied case is the unweighted version , when the connectivity function is a threshold function of distance .",
    "these graphs are well - established mathematical models of various physical phenomena , such as continuum percolation .",
    "they have also found use in a number of applied settings , including the modeling of ad - hoc wireless networks @xcite , @xcite , @xcite , protein - protein interaction networks @xcite , as well as the study of combinatorial optimization problems @xcite , @xcite . in clustering studies of these graphs and their variants , the modularity functional",
    "is often used to assess the quality of the clustering obtained @xcite , @xcite .    in these contexts",
    ", it is a natural question to ask about the consistency of modularity clustering with respect to random geometric graphs .",
    "that is , one would like to know how the modularity clusterings converge or stabilize as the number of sampled data points or vertices grow , and how to characterize geometrically any limit clusterings . from the point of view of applications , establishing consistency is relevant to benchmarking performance .",
    "we will focus on a class of random geometric graphs , where a length scale is introduced in the connectivity function , so that distances between adjacent vertices shrink as the number of data points grow , and spatial scaling limits can be taken .    in this article",
    ", we study two questions : the first asks about the large limit behavior of the modularity functional on these random geometric graphs , evaluated on a fixed partition of the underlying geometric domain .",
    "the second question asks whether the optimal modularity clusterings for the discrete graphs converge , and if so to what geometric limit clustering .    with respect to the first question ,",
    "when the fixed partition of the domain involves at most @xmath7 sets , we show that the limit of the modularity functional , known to be a priori bounded between @xmath8 and @xmath9 , as the sample size grows , is of the form @xmath10 plus a term involving the partition , which vanishes when the partition is ` balanced ' , that is when each set in the partition has the same volume with respect to an underlying measure ( theorem [ thm : asymptotics ] ) . as a corollary , we obtain , for these random geometric graphs , that the maximum of the modularity functional taken over all partitions , as the sample size grows , tends to @xmath9 ( corollary [ cor : main ] ) .",
    "these limits prove , in the context of random geometric graphs , some heuristics given in the literature ( cf .",
    "subsection [ discussion ] ) .    with respect to the second question ,",
    "we show that , given a fixed upper bound @xmath11 on the number of clusters , the optimal modularity clusterings of the discrete random graphs converge in a distributional sense to an optimal clustering , satisying a certain shape optimization problem ( theorem [ thm : mainthm ] ) .",
    "this geometric continuum optimization problem , of interest in itself , is a form of kelvin s problem : informally , find a partition of the domain , where each set has the same volume , but where the perimeters between sets is minimized . noting the first result above",
    ", it seems natural that a constraint specifying equal volumes would emerge in the limiting shape problem .",
    "nonetheless , it seems intriguing that a form of kelvin s shape optimization problem ( cf .",
    "subsection [ continuum problem ] ) would appear .",
    "previously , in the literature , a type of statistical consistency of modularity clustering for stochastic block models has been considered . in the stochastic block model ,",
    "each data point is assigned a group from @xmath11 groups according to a probability @xmath12 .",
    "then , if the two points belong to groups @xmath13 and @xmath14 respectively , one puts an edge between them with probability @xmath15 .",
    "modularity clustering now gives an empirical group assignment to each data point .",
    "one of the main results shown is that the proportion of misclassification of empirical group assignments , with respect to the a priori assignment , vanishes in probability , bickel and chen @xcite for the model above , zhao , levina and zhu @xcite for degree - corrected models , rohe , chatterjee and yu @xcite for high - dimensional models , and le , levina and vershynin @xcite via low rank approximation .    in this context , the main focus of the article is to understand the geometry of optimal partitions , and other asymptotics with respect to the modularity functional .",
    "our results represent limit results on a ` geometric ' form of consistency of the discrete modularity clusterings , which seem not to have been considered before .",
    "moreover , as a corollary of this type of consistency , we show that the proportion of misclassification of the data points into sets given by the modularity functional , with respect to the limit optimization problem , vanishes a.s .",
    "( corollary [ cor : proportion ] ) .",
    "we use the recent framework of optimal transport introduced by garca trillos and slepev in @xcite , in the context of continuum limits of graph variational problems , to help relate point cloud empirical measures to absolutely continuous ones .",
    "we rewrite , after some manipulation , the modularity functional in terms of a ` graph total variation ' term and a ` balance ' term ( section [ reformulation_sect ] ) .",
    "the proofs , with respect to the first question on asymptotics of the modularity functional of a particular clustering , make use of concentration estimates for these terms through u - statistics bounds .    on the other hand , with respect to the second question ,",
    "we observe that maximizers of the modularity functional are the same as minimizers of an energy functional built as the sum of the ` graph total variation ' and ` balance ' terms ( cf .",
    "subsection [ reformulation_min_sect ] ) . in this energy",
    "functional , the coefficient in front of the ` balance ' term diverges as the reciprocal of the length scale when the number of data points grows . in the limit ,",
    "the soft penalty ` balance ' term becomes a hard constraint .",
    "we show convergence of a subsequence of minimizers to an optimizer of the limit problem by use a modified notion of gamma convergence that we formulate ( cf .",
    "subsection [ gamma_conv ] ) , together with a compactness principle . for the ` liminf ' part of gamma convergence",
    ", although we have to treat the balance constraint , the analysis of the graph total variation term follows from work in @xcite , which handles a similar expression .",
    "however , dealing with the ` balance ' constraint represents a serious difficulty with respect to the ` limsup ' or ` recovery sequence ' part of the gamma convergence setup . without the constraint",
    ", one can form the recovery sequence by approximating with piecewise smooth partitions . however ,",
    "such approximations become more complicated when also enforcing the ` balance ' constraint .",
    "but , the probabilistic result for the first question ( theorem [ thm : asymptotics ] ) , given for general measurable clusterings , already can be seen to yield a recovery sequence , with respect to the modified notion of gamma convergence for random functionals .",
    "interestingly , this notion of gamma convergence has the same strength , in terms of yielding subsequential convergence , as the more usual stringent formulation ( cf .",
    "remark [ rmk : compactness ] ) . perhaps of use in other problems , we observe that this more probabilistic approach offers a diferent perspective .    with respect to previous work on statistical clustering methods , consistency of @xmath11-means methods have been considered by pollard in @xcite , and more recently , via gamma convergence , by thorpe , theil , johansen , and cade in @xcite .",
    "on single linkage hierarchical clustering , consistency has been shown by hartigan in @xcite .",
    "on fuzzy c - means clustering , consistency has been considered by sabin in @xcite . with respect to spectral clustering ,",
    "consistency has been considered by belkin and niyogi in @xcite , von luxburg , belkin and bousquet in @xcite , and garca trillos and slepev in @xcite , the last article , employing the framework of @xcite , as in this paper .",
    "we also mention , using gamma convergence ( or ` epi - convergence ' ) techniques , consistency of maximum likelihood and other estimators was studied by wets in @xcite and references therein .    also , related , arias - castro and pelletier @xcite considered the consistency of the dimension reduction algorithm ` maximum variance unfolding ' , and arias - castro , pelletier and pudlo @xcite and garca trillos , slepev , von brecht , laurent and bresson @xcite studied the consistency of cheeger and ratio cuts .",
    "pointwise estimates between graph laplacians and their continuum counterparts were considered by belkin and niyogi @xcite , coifman and lafon @xcite , gin and koltchinskii @xcite , hein , audibert and von luxburg @xcite , and singer @xcite .",
    "in addition , spectral convergence in more general contexts was considered by ting , huang and jordan @xcite and singer and wu @xcite .",
    "in addition , we mention there is a large literature on gamma convergence of discrete lattice based variational expressions to continuum optimization problems ( cf .",
    "braides @xcite , braides and gelli @xcite and references therein ) .",
    "more recently , see van gennip and bertozzi @xcite which studies gamma convergence of ginzburg - landau graph based functionals to continuum limits .",
    "the plan of the paper is the following . in section [ model ] , we define the random geometric graph model and state and discuss the two main results ( theorems [ thm : asymptotics ] and [ thm : mainthm ] ) on modularity clustering . in section [ preliminaries ] , we discuss preliminaries with respect to optimal transport distances and gamma convergence ",
    "we remark that the proof of theorem [ thm : mainthm ] relies on this section , but the proof of theorem [ thm : asymptotics ] does not . in section [ reformulation_sect ]",
    ", we develop the modularity functional into a convenient form amenable to later analysis . in section [ proof_asymptotics ] and [ proof_mainthm ] ,",
    "the proofs of the two main theorems are given respectively .",
    "finally , in section [ appendix ] , some technical calculations and proofs , referenced in previous sections , are collected .",
    "we first introduce in subsection [ graph partitioning ] the modularity functional on graphs with weighted edges . in subsection",
    "[ continuum problem ] , we discuss a form of kelvin s continuum shape optimization problem . in subsection [ results ] , we state our main theorems , and make some remarks in subsection [ discussion ] .",
    "let @xmath16 be a weighted graph with vertex set @xmath17 and weight matrix @xmath18 , where the entry @xmath19 denotes the weight of the ( undirected ) edge between vertex @xmath20 and @xmath21 .",
    "the degree of vertex @xmath20 is @xmath22 , and the total weight of the graph is @xmath23 .",
    "when convenient , we will refer to the vertex @xmath20 simply as vertex @xmath24.    let @xmath25 be a partition of the vertex set @xmath26 .",
    "we shall sometimes refer to the nontrivial sets @xmath27 of @xmath6 as ` clusters ' , and we denote by @xmath28 the number of clusters .",
    "we may have @xmath29 , if one of the sets @xmath27 is empty .",
    "the partition @xmath6 is therefore equivalent to an assignment @xmath30 of labels @xmath31 to vertices , where @xmath32 for @xmath33 .",
    "modularity was originally introduced as a quantitative measure of the bias towards of vertices in a given cluster to be connected to other vertices in the same cluster @xcite .",
    "informally , the idea is to measure the proportion of edge weight that runs between vertices in the same cluster , and compare it to the expected proportion if the edge weight was redistributed at random , according to a ` null ' or ` ground truth ' model .",
    "the total proportion of edge weight between vertices in the same cluster is @xmath34 where @xmath35 is the indicator that @xmath36 , and the factor of @xmath37 arises because distinct vertex pairs appear twice in the sum .",
    "let @xmath38 denote the expected edge weight between vertex @xmath24 and vertex @xmath39 under a random redistribution model , which we specify below in different forms .",
    "then , the expected proportion of edge weight between vertices in the same cluster is @xmath40 then the modularity @xmath41 is defined to be @xmath42 and one has @xmath43 .",
    "the guiding thought is that a partition @xmath6 with large modularity @xmath44 would represent a good clustering of the graph .",
    "the most popular choice of null model , and the one originally introduced in @xcite , specifies @xmath45 . for unweighted graphs , where @xmath18 is the adjacency matrix",
    ", this choice corresponds to the _ configuration model_. namely , with respect to the vertex degrees @xmath46 , consider the following distribution over graphs with @xmath47 vertices and @xmath48 edges . at each vertex",
    "@xmath24 place @xmath49 half - edges .",
    "then , successively choose a pair of half - edges at random without replacement and connect them to form an edge with unit weight . then , to dominant order , the expected number of edges between vertex @xmath24 and vertex @xmath39 behaves as @xmath50 .",
    "another natural choice corresponds to the _ erds - rnyi model _",
    ", when @xmath51 .",
    "namely , for unweighted graphs , when @xmath18 again is the adjacency matrix , if the endpoints of each edge is chosen uniformly from the vertex set , with @xmath48 edges total , the expected number of edges between vertex @xmath24 and vertex @xmath39 is @xmath51 to dominant order .    more generally , we may define @xmath38 which interpolates in and among these two possibilities . for @xmath52 ,",
    "let @xmath53 , and @xmath54 .",
    "define the ` @xmath55'-modularity @xmath41 to be @xmath56 when @xmath57 or @xmath9 , this reduces to the modularity corresponding to the erds - rnyi model or the configuration model respectively .",
    "the _ modularity maximization _",
    "problem is the following : given a graph @xmath58 , find the partition for which the modularity @xmath41 is maximized . in other words",
    "one solves the following optimization problem , @xmath59 where the maximization occurs over all partitions @xmath6 of the vertex set .",
    "one is particularly interested in optimal partitions @xmath60 , representing a division of the graph into natural communities .",
    "we also consider the following variant of problem , in which we restrict the partitions to have at most @xmath11 classes : @xmath61    we remark that finding a global maximum of the modularity is known to be np - hard ( @xcite ) . nonetheless , there are various algorithms to compute approximate maximizers , among them greedy algorithms ( cf .",
    "@xcite , @xcite ) , and relaxation methods ( cf .",
    "@xcite , @xcite , @xcite ) .",
    "there is also a potts model interpretation of modularity which offers another computational perspective ( cf .",
    "@xcite , @xcite ) .",
    "we now discuss a continuum partitioning problem , which will emerge as a scaled limit of the discrete graph partitioning optimization .",
    "consider a domain @xmath62 , and a partition @xmath63 of @xmath5 .",
    "for what follows , we take @xmath7 to be fixed .",
    "suppose that we have a probability measure @xmath64 on @xmath5 .",
    "we say that a partition @xmath6 is balanced with respect to the measure @xmath64 if each @xmath27 has equal @xmath64-measure , that is @xmath65    because @xmath6 is a partition , any two distinct sets @xmath27 and @xmath66 are disjoint .",
    "however , if they are adjacent their boundaries will intersect nontrivially as a @xmath67 dimensional surface .",
    "when the boundaries of @xmath68 are piecewise - smooth , we may measure the size of the interface between @xmath27 and @xmath66 , with respect to a density @xmath69 on @xmath5 , by @xmath70 where @xmath71 denotes the euclidean @xmath72-dimensional surface measure .",
    "the measure of the total interface or perimeter between the sets of @xmath6 is therefore @xmath73 noting the factor @xmath37 accounts for the fact that each distinct pair @xmath74 contributes twice to the sum .    because @xmath75 , the quantity ( [ eq : totalinterface ] ) is equal to @xmath76    more generally , for partitions @xmath6 consisting of measurable sets @xmath68 , we may define the weighted perimeter of @xmath27 as follows : @xmath77 where @xmath78 , defined below , is the weighted total variation of the indicator function @xmath79 . for sufficiently regular sets",
    ", this definition agrees with the informal notion of perimeter .",
    "let @xmath80 and @xmath81 be the usual spaces of functions @xmath82 where @xmath83 and @xmath84 for @xmath85 respectively .",
    "when @xmath86 is lebesgue measure on @xmath5 and the underlying domain @xmath5 is understood , we will abbreviate @xmath87 . the weighted total variation of a function @xmath88",
    "is given by @xmath89 where @xmath90 is the space of continuously differentiable , compactly supported vector fields on @xmath5 , and @xmath91 . in our later applications , the density @xmath69 will be bounded above and below on @xmath5 by positive constants . in this case , the weighted total variation has many of the same properties as the total variation with respect to the uniform density @xmath92 , discussed in detail in chapter 3 of @xcite .",
    "consider now the following geometric partitioning problem . among all balanced @xmath11-partitions of @xmath5",
    ", choose that which minimizes the total perimeter of its sets : @xmath93 see figure [ fig : continuumk ] for the behavior when @xmath5 is a square .    0.3   on @xmath94 , with @xmath95 , @xmath96 , produced using @xcite .",
    "[ fig : continuumk],title=\"fig : \" ]       0.3   on @xmath94 , with @xmath95 , @xmath96 , produced using @xcite .",
    "[ fig : continuumk],title=\"fig : \" ]    0.3   on @xmath94 , with @xmath95 , @xmath96 , produced using @xcite .",
    "[ fig : continuumk],title=\"fig : \" ]       it is clear , by dividing @xmath5 in terms of a moving hyperplane , that balanced @xmath11-partitions with finite perimeter exist .",
    "also , depending on @xmath5 , the problem may or may not have a unique solution ( modulo relabeling of sets ) : suppose @xmath95 and @xmath96 .",
    "when @xmath5 is a long , thin rectangle in @xmath97 , there is only one perimeter minimizing division into two sets of equal area .",
    "however , when @xmath5 is a disc in @xmath97 , there are infinitely many such divisions , given by cuts of the disc along a diameter .",
    "the general problem can be seen as a type of ` soap bubble ' problem .",
    "it can also be seen as a bounded domain form of kelvin s problem : find a tiling of @xmath98 where each tile has unit @xmath64-volume so that the @xmath69-perimeter between tiles is minimized .",
    "we note in passing , when @xmath95 and @xmath96 , in @xmath99 , this problem has been solved in terms of hexagonal tiles , and is the subject of much research in @xmath100 .",
    "see morgan @xcite , which discusses these and other related optimizations .",
    "we remark , when @xmath101 and @xmath96 , the problem has been considered in the literature .",
    "caete and ritore @xcite have studied minimal partitions of the disc into three regions , and in this context proved that the regions are bounded by circular arcs making perpendicular contact with the boundary of the disc and meeting at a 120 degree triple point within .",
    "some conjectures about minimizers for larger values of @xmath11 and other domains are presented in cox and flikkema @xcite .",
    "oudet @xcite derives a numerical algorithm , via gamma convergence , for computing approximate solutions .      before stating the two main theorems",
    ", we first define the random geometric graphs under consideration .",
    "we make the following standing assumptions throughout on the domain @xmath2 , ground measure @xmath1 on @xmath5 , and underlying edge weight structure .",
    "* @xmath5 is a bounded , open , connected subset of @xmath98 with lipschitz boundary .",
    "* in @xmath102 , @xmath1 is a probability measure on @xmath5 with distribution function @xmath103 and density @xmath104 such that @xmath104 is lipschitz and bounded above and below by positive constants .",
    "+ further , in @xmath105 , @xmath104 satisfies additional conditions : ( a ) @xmath104 is differentiable on @xmath106 and ( b ) @xmath104 is increasing in some interval with left endpoint @xmath107 and decreasing in some interval with right endpoint @xmath108 .",
    "let @xmath109 be a collection of i.i.d .",
    "samples from @xmath1 , and define @xmath110 .",
    "we will denote by @xmath111 and @xmath112 the probability and expectation with respect to the underlying probability space .",
    "the random geometric graph is constructed from the points @xmath4 through a kernel function @xmath113 , where @xmath114 satisfies :    1 .",
    "@xmath114 is radial and non - increasing , i.e. @xmath116 if @xmath117 .",
    "@xmath118 and @xmath114 is continuous at @xmath119 .",
    "@xmath114 is compactly supported .",
    "there is a large class of kernels admitted under assumptions @xmath120 , including the kernel associated with the well - known random geometric graph , where @xmath114 is the indicator function of a ball .    between vertex @xmath121 and @xmath122 , in terms of a parameter @xmath123",
    ", we attach an edge with weight @xmath124 the parameter @xmath123 serves as a length scale .",
    "for example , if the support of @xmath114 is contained in a ball of radius one , then two vertices @xmath121 and @xmath122 are connected by an edge only if they are separated by a distance no more than @xmath123 ( cf .",
    "figure [ fig : random_geometric_graph ] ) . since the modularity functional @xmath41 is the same under weights @xmath18 and @xmath125 , for @xmath126 , the normalization factor @xmath127 in was chosen so that the expected value of @xmath128 is of order @xmath9 .    under all circumstances",
    ", we have @xmath129 , although the specific rate at which @xmath123 vanishes will depend on the dimension @xmath108 , as well as the parameter @xmath55 .",
    "there are in fact two different sets of assumptions , ( i1 ) being more restrictive than ( i2 ) , corresponding to the two main results given below .",
    "we first mention typical examples , satisfying the assumptions .",
    "taking @xmath130 , condition ( i1 ) will hold if @xmath131 however , condition ( i2 ) would be satisfied if @xmath132    more precisely , ( i1 ) and ( i2 ) are the following :    * the sequence @xmath133 is such that @xmath134 and @xmath135 . when @xmath136 or @xmath137 , we also suppose that @xmath138 however , when @xmath139 , we suppose that @xmath140    * the sequence @xmath133 is such that @xmath134 and @xmath135 . when @xmath57 or @xmath141 , we also suppose that @xmath142 however , when @xmath143 , we suppose that @xmath144    in subsection [ discussion ] we discuss the motivation behind these assumptions in more detail .",
    "now , given the set @xmath4 and a sequence @xmath145 , denote by @xmath146 the weight matrix with entries given by ( [ eq : weightdef ] ) , and denote by @xmath147 the corresponding weighted random geometric graph .",
    "we let    @xmath148 denote the modularity functional ( [ eq : generalmodularity ] ) corresponding to @xmath149 .",
    "consider a partition @xmath25 of the domain @xmath5 .",
    "for any @xmath150 , this induces a partition @xmath151 of the sample @xmath4 , where @xmath152 for @xmath33 .",
    "[ thm : asymptotics ] suppose @xmath153 satisfies condition ( i1 ) .",
    "fix @xmath7 and let @xmath154 be a partition of @xmath5 where each @xmath27 is a subset of finite perimeter , @xmath155 .",
    "let @xmath3 be the induced partition of @xmath4 for @xmath156 .",
    "then , the modularity @xmath157 satisfies @xmath158 as @xmath159 , where @xmath160 .    further ,",
    "if @xmath161 , we have @xmath162 as @xmath163 , where @xmath164 and @xmath165 denotes the first coordinate of @xmath166 .    one way to interpret these law of large numbers limits",
    "is that the nonnegative quantity , a ` balance ' term , @xmath167 is a measure of how balanced the partition @xmath6 is with respect to the measure @xmath64 . in our model , the limiting modularity of a partition",
    "is predominantly determined by the number of clusters and the extent to which they are balanced .",
    "we state a corollary of theorem [ thm : asymptotics ] , which follows by considering balanced partitions where @xmath11 is not restricted .",
    "[ cor : main ] suppose the assumptions of theorem [ thm : asymptotics ] are satisfied .",
    "let @xmath168 denote the maximum modularity associated to @xmath149 , where the maximum is over all partitions @xmath3 of @xmath4 .",
    "then , we have @xmath169 as @xmath170 .",
    "our second main result is a characterization of the behavior of optimal clusterings @xmath171 , as @xmath170 . to this end",
    ", we introduce a suitable notion of convergence .",
    "to a sequence of sets @xmath172 with @xmath173 , we associate the ` graph measures ' @xmath174 , where @xmath175 and @xmath176 denotes a point mass . in words , the measure @xmath177 is the distribution of the graph of @xmath178 under the empirical measure @xmath179 on @xmath4 .",
    "let also @xmath180 and define @xmath181 as the distribution of the graph of @xmath182 under @xmath1 .",
    "we will write , with respect to a realization of @xmath183 , that @xmath184    correspondingly , consider a sequence of partitions @xmath185 of @xmath4 , and a partition @xmath25 of @xmath5 .",
    "since the sets in the collections @xmath3 and @xmath6 are unordered , we say that    @xmath3 converges _ weakly _ ( denoted @xmath186 ) to @xmath6    if there exists a sequence @xmath187 of permutations @xmath188 such that @xmath189    [ thm : mainthm ] suppose @xmath153 satisfies condition ( i2 ) .",
    "let @xmath190 be an optimal partition of @xmath4 , for @xmath156 .",
    "let also , with respect to problem , @xmath191 and @xmath192 .    if @xmath193 is the unique solution ( modulo reordering of its constituent sets ) of problem ( [ prob : continuumk ] ) , then a.s .",
    "@xmath194 converges weakly to @xmath193 , in the sense of ( [ eq : convergeeq ] ) .    if there is more than one solution to the problem ( [ prob : continuumk ] ) , then a.s .",
    "@xmath194 converges weakly along a subsequence , in the sense of ( [ eq : convergeeq ] ) , to a solution @xmath193 of ( [ prob : continuumk ] ) .",
    "figure [ fig : binary_convergence ] illustrates this result .",
    "we remark that , in the proof of theorem [ thm : mainthm ] , we will in fact show a stronger form of convergence , in terms of wasserstein , kantorovich - rubenstein type @xmath195 distances , via a gamma convergence statement ( theorem [ thm : maingamma ] ) for certain energy functionals .",
    "we also note that the parameter @xmath55 , which parametrizes a family of null models in the modularity functional , appears in the balancing measure @xmath64 with respect to the continuum problem . as @xmath55 increases",
    ", the measure @xmath64 puts more mass near the modes of the density @xmath104 , of course altering the optimal clusterings , as illustrated in figure [ fig : alpha_varying ] .",
    "0.23   and various @xmath55 on @xmath196 , computed using a modified version of the algorithm in @xcite .",
    "here @xmath197 , @xmath198 , for @xmath199 , with @xmath200 .",
    "[ fig : alpha_varying],title=\"fig : \" ]       0.23   and various @xmath55 on @xmath196 , computed using a modified version of the algorithm in @xcite .",
    "here @xmath197 , @xmath198 , for @xmath199 , with @xmath200 .",
    "[ fig : alpha_varying],title=\"fig : \" ]       0.23   and various @xmath55 on @xmath196 , computed using a modified version of the algorithm in @xcite .",
    "here @xmath197 , @xmath198 , for @xmath199 , with @xmath200 .",
    "[ fig : alpha_varying],title=\"fig : \" ]    0.23   and various @xmath55 on @xmath196 , computed using a modified version of the algorithm in @xcite .",
    "here @xmath197 , @xmath198 , for @xmath199 , with @xmath200 .",
    "[ fig : alpha_varying],title=\"fig : \" ]    we also observe that theorem [ thm : mainthm ] implies that the proportion of misclassified points vanishes almost surely .",
    "[ cor : proportion ] consider the setting of theorem [ thm : mainthm ] .",
    "let @xmath201 be a subsequence of optimal @xmath202-modularity partitions of the sample space which a.s",
    ". converges weakly , in the sense of , to a solution @xmath193 of .",
    "then , the proportion of correctly classified points converges to @xmath9 .",
    "that is , a.s .",
    "as @xmath203 , @xmath204    it is enough to show , with respect to a sequence of sets @xmath205 and a set @xmath206 where a.s .",
    "@xmath207 , in the sense of , that @xmath208 as @xmath203 .",
    "then , the statement in the corollary would follow by application of this limit with @xmath209 and @xmath210 for @xmath211 .    in terms of the measures",
    "@xmath212 and @xmath181 , which govern the graphs of @xmath213 and @xmath214 under @xmath179 and @xmath1 respectively , we can write @xmath215 since a.s . @xmath216 as @xmath203 , by approximating @xmath217 and @xmath218 by bounded , continuous functions , we have @xmath219 as @xmath203 , concluding the argument .      * 1 . * as alluded to in the introduction , the phenomena shown in corollary [ cor : main ] for random geometric graphs has been considered before in other models .",
    "indeed , in @xcite the authors provide heuristic arguments for the limiting behavior @xmath220 under two regimes : i ) when the graphs are regular lattices , and ii ) when the graphs are erds - rnyi graphs with edge probability @xmath221 . in @xcite ,",
    "the authors derive the limiting behavior @xmath220 under a sparse graph model , in which modules of some characteristic size are adjoined to the graph .",
    "further , these asymptotics are consistent with the empirical results associated with large real - world graphs @xcite .",
    ".1 cm * 2 .",
    "* it has been observed in the literature that modularity optimization may fail to identify clusters smaller than a certain level , depending on the total size and interconnectedness of the graph .",
    "in other words , modularity possesses a ` resolution limit ' in terms of its clustering ( cf .",
    "@xcite , @xcite ) .",
    "an extreme example is when the graph contains a pair of cliques ( complete subgraphs ) connected by a single edge , but modularity would lump them into a common cluster ( cf .",
    "figure 3 of @xcite ) .    in @xcite ,",
    "the authors consider a variant of the modularity given by @xmath222 where @xmath223 is a parameter . in @xcite ,",
    "the parameter @xmath223 is related to the resolution limit phenomena : namely , higher values of @xmath223 allow for smaller cluster sizes .    the methods used to prove theorem [ thm : mainthm ] give the following asymptotic behavior of optimal @xmath224 modularity clusterings : when @xmath225 is scaled with @xmath47 , for @xmath226 and @xmath123 satisfying ( i2 ) , three distinct possibilities arise for the limiting problem .",
    "when @xmath227 , the continuum partitioning problem remains as it is in ( [ prob : continuumk ] ) .",
    "when @xmath228 , the hard constraints @xmath229 for @xmath211 of the limiting problem get replaced by a soft balancing condition , resulting in @xmath230 when @xmath231 , the continuum problem degenerates to a perimeter minimization problem with no balancing condition , which has as its solution a single global cluster @xmath5 ( and the other @xmath232 sets being empty ) .",
    ".1 cm * 3 .",
    "* one can ask about the reasons behind the assumptions ( i1 ) and ( i2 ) .",
    "with respect to theorem [ thm : asymptotics ] , a lower bound for @xmath123 should be informed by the fluctuations of the functional .",
    "in fact , the variance of @xmath157 can be seen to be of order @xmath233 when @xmath234 ( by a computation with formula ) , so that condition ( i1 ) makes sense .",
    "however , when @xmath143 , a worse bound is useful to control the nonlinearity of the functional .    on the other hand , assumption ( i2 ) in theorem [ thm : mainthm ] is informed by the connectivity radius of the random geometric graphs .",
    "for instance , if @xmath123 were to vanish too quickly , the underlying graphs would contain @xmath235 disconnected components ( cf .",
    "theorem 13.25 in @xcite ) .",
    "then , presumably , one would be able to find a @xmath194 such that @xmath236 and consequently obtain a continuum cluster point @xmath193 .",
    "this would be a contradiction , as the resulting partition @xmath193 would have zero perimeter  in other words , one of the sets in @xmath193 would be @xmath5 itself  and so could not satisfy the balance conditions .",
    "this is a version of the argument in remark 1.6 of @xcite .",
    "the threshhold that @xmath123 should be larger than for the graphs to be connected is known : in @xmath102 , it is of order @xmath237 ( cf .",
    "@xcite ) . viewed from this lens , when @xmath238 , condition ( i2 ) is more optimal than when @xmath143 , again due to the nonlinearity of the functional in this case .    *",
    "* we briefly discuss the assumptions on @xmath104 , @xmath5 , and @xmath114 .",
    "the proof of theorem [ thm : mainthm ] makes use of certain ` transport maps ' ( cf .",
    "proposition [ thm : tmaps ] ) . for @xmath239",
    ", we use the optimal transport results of @xcite , which require that @xmath104 be bounded above and below by positive constants .",
    "likewise , the assumptions on @xmath5 are made there so that comparisons to results on cubes may be made .",
    "on the other hand , for @xmath105 , it is not necessary that @xmath104 be bounded below to define a suitable transport map  here , the technical condition required is .",
    "however , in all dimensions , we require a lower bound on @xmath104 , as this enables us to handle the general @xmath143 case via a lipschitz inequality for the map @xmath240 ( cf .",
    "lemma [ lemma : quadasconvergea ] ) .",
    "the boundedness of @xmath5 is also used in several intermediate technical results .",
    "the lipschitz continuity of @xmath104 is used for handling the ` balance ' term in the proof of theorem [ thm : mainthm ] ( principally in lemma [ lemma : lambdaepslim ] , by way of lemma [ lemma : mollified ] ) .",
    "we remark that this condition could be weakened to hlder continuity , with exponent greater than @xmath37 .    with respect to @xmath114 ,",
    "the radial and monotone assumptions are convenient in relating certain graph functionals to their nonlocal analogues ( cf .",
    "lemma [ lemma : glambdalimit ] ) .",
    "the continuity at zero is used in the proof of the compactness property , lemma [ lemma : gtvcompact ] .",
    "finally , we remark that the compact support of @xmath114 allows to analyze behavior near the boundary of @xmath5 , although this assumption could be weakened to a suitable condition on the decay of @xmath114 at infinity .",
    "before entering into the main derivations , we first discuss in subsection [ framework ] the @xmath241 topology and framework , introduced by garca trillos and slepev in @xcite , and connections to weak convergence of graph measures .",
    "then , in subsection [ gamma_conv ] , we define a variant of gamma convergence for random energy functionals that we will use to prove theorem [ thm : mainthm ] .      given a measurable space @xmath242 , we let @xmath243 denote the borel @xmath244-algebra on @xmath245 , and similarly let @xmath246 denote the set of borel probability measures on @xmath245 . also , given two spaces , @xmath247 and @xmath248 , a measurable map @xmath249 , and a measure @xmath250 , we define the _ push - foward _ @xmath251 by @xmath252 in particular , @xmath253 is the distribution of @xmath254 where @xmath26 has distribution @xmath64 .    given measures @xmath255 , recall that a coupling between @xmath64 and @xmath86 is a probability measure @xmath12 on @xmath256 such that the marginal with respect to the first variable is @xmath64 , and the marginal with respect to the second variable is @xmath86 . consider the set of couplings @xmath257 define the distance on @xmath246 by @xmath258 this is a metric on the subset of probability measures in @xmath246 with finite first moment .",
    "when @xmath245 is complete , a case of a more general result ( see theorem 6.9 @xcite ) is the following : let @xmath259 and @xmath64 be measures in @xmath260 . then , as @xmath163 , @xmath261    now , as in @xcite , to understand weak convergence of ` graph measures ' , define the space @xmath262 by @xmath263 and , for @xmath264 and @xmath265 in @xmath262 , define the distance @xmath266    one may identify an element @xmath267 with a graph measure @xmath268 , whose support is contained in the graph of @xmath269 .",
    "consider now , with respect to @xmath270 , the graph measures @xmath271 .",
    "it may be seen ( cf .",
    "proposition 3.3 of @xcite ) that @xmath272    we now restrict @xmath245 to be the bounded domain @xmath273 introduced in subsection [ results ] .",
    "we will abbreviate @xmath274 . then , for @xmath275 , the graph measure @xmath276 has a finite first moment in that @xmath277 . hence , by , @xmath241 can be viewed as a metric space with metric @xmath278 .    with respect to graph measures @xmath279 and @xmath280 on @xmath281 , consider their extensions @xmath282 and @xmath283 to @xmath284 by setting @xmath285 .",
    "then , the distance @xmath286 suppose now @xmath287 , and @xmath288 and @xmath181 are the associated graph measures for @xmath156 .",
    "then , by and , @xmath289 as @xmath163 . in particular , as @xmath284 is complete , by , @xmath290 in @xmath291 , and so @xmath292 in @xmath293 , as @xmath163 .",
    "we now make a remark on definition in connection with the product space @xmath195 .",
    "fix a realization @xmath294 .",
    "recall the empirical measures @xmath179 and probability measure @xmath1 on @xmath5 from the beginning of subsection [ results ] .",
    "let @xmath151 be a partition of @xmath4 for @xmath156 , and @xmath295 be a partition of @xmath5 .",
    "we say the sequence @xmath296 converges in @xmath195 to @xmath297 if @xmath298 for @xmath211 .",
    "hence , by the comment below , as convergence in the metric @xmath299 implies weak convergence in @xmath300 , we obtain @xmath301 in the sense of definition , by choosing the identity permutations    we now discuss when this convergence may be formulated in terms of transportation maps .",
    "we say that a measurable function @xmath302 is a _ transportation map _ between the measures @xmath303 and @xmath304 if @xmath305 . in this context , for @xmath306 , the change of variables formula holds @xmath307    a transportation map @xmath308 yields a coupling @xmath309 defined by @xmath310 where @xmath311 .",
    "it is well known , when @xmath86 is absolutely continuous with respect to lebesgue measure on @xmath5 , that the infimum @xmath312 can be achieved by a coupling @xmath313 induced by a transportation map @xmath308 between @xmath64 and @xmath86 .",
    "indeed , we note briefly that this is only one result among many others which relate various ` monge ' and ` kantorovich ' distances via optimal transport theory",
    ". see @xcite and references therein ; see also @xcite , @xcite .",
    "we will say that a sequence @xmath314 of transportation maps , with @xmath315 , with respect to a sequence of measures @xmath316 , is _ stagnating _ if @xmath317    the following is proposition 3.12 in @xcite .",
    "[ lemma : tl1convergence ] consider a measure @xmath304 which is absolutely continuous with respect to the lebesgue measure .",
    "let @xmath318 and let @xmath319 be a sequence in @xmath320 .",
    "the following statements are equivalent :    1 .",
    "2 .   @xmath322 and there exists a stagnating sequence of transportation maps @xmath323 such that @xmath324 3 .",
    "@xmath322 and for any stagnating sequence of transportation maps @xmath325 , the convergence ( [ eq : transportlim ] ) holds .    in order to make use of the above result on @xmath241 convergence",
    ", we will need to find a suitable stagnating sequence @xmath326 of transportation maps .",
    "[ thm : tmaps ] recall , from the beginning of subsection [ results ] , the assumptions on the probability measure @xmath1 on @xmath5 , and that @xmath179 denotes the empirical measure corresponding to i.i.d .",
    "samples drawn from @xmath1 .",
    "then , there is a constant @xmath327 such that , with respect to realizations of @xmath294 in a probability @xmath9 set @xmath328 , a sequence of transportation maps @xmath329 exists where @xmath330 and @xmath331 @xmath332 @xmath333    we prove the @xmath334 case in the appendix ( proposition [ lemma : transportd1 ] ) , as a consequence of quantile transform results for the empirical measure , making use of the technical conditions assumed on @xmath104 . in garca trillos and slepev @xcite , the @xmath335 and @xmath336 cases are first discussed , in the context of concentration estimates in the literature when @xmath5 is a cube and @xmath1 is the uniform measure , and then proved for general @xmath5 and nonuniform @xmath1 .",
    "although a result of varadarajan ( cf .",
    "theorem 11.4.1 in @xcite ) implies that a.s .",
    "@xmath337 , proposition [ thm : tmaps ] gives a way to specify the probability @xmath9 set on which the weak convergence holds .",
    "[ empconverge ] on the probability @xmath9 set @xmath328 of proposition [ thm : tmaps ] , the empirical measures @xmath179 converge weakly to @xmath1 as @xmath170 .",
    "let @xmath338 be a bounded , lipschitz continuous function .",
    "since @xmath339 we may write @xmath340 where @xmath341 is a lipschitz constant for @xmath269 . by proposition [ thm : tmaps ] , for each realization of @xmath294 in @xmath328 , we have @xmath342 as @xmath163 . hence , by the portmanteau theorem ( theorem 3.9.1 in @xcite ) , we have the weak convergence @xmath343 as @xmath163 .      here",
    ", we introduce a type of @xmath344-convergence , with respect to random functionals , which will be an important tool in the proof of theorem [ thm : mainthm ] in section [ proof_mainthm ] , and may be of interest in its own right . for what follows ,",
    "let @xmath26 denote a metric space with metric @xmath108 and let @xmath345 $ ] be functionals on this space .",
    "we first state the definition with respect to deterministic functionals .",
    "[ defn_det ] the sequence @xmath346 @xmath344-converges with respect to the topology on @xmath26 if the following conditions hold :    1 .   *",
    "liminf inequality * : for every @xmath347 and every sequence @xmath348 converging to @xmath166 , @xmath349 2 .",
    "* limsup inequality * : for every @xmath347 , there exists a sequence @xmath350 converging to @xmath166 satisfying @xmath351    the function @xmath352 is called the @xmath344-limit of @xmath353 , and we write @xmath354 .    when we wish to make the dependence on the metric @xmath108 explicit , we say that @xmath346 @xmath355-converges to @xmath352 , or @xmath352 is the @xmath355-limit of @xmath346 , etc .",
    "if the liminf inequality holds , the limsup inequality is equivalent to the following condition : for every @xmath347 , there exists a sequence @xmath356 with @xmath357 and @xmath358 . the sequence @xmath348 is referred to as a _ recovery sequence _ for @xmath166 .",
    "a basic consequence of definition [ defn_det ] is the following ( cf .",
    "@xcite , theorem 1.21 ) .",
    "let @xmath345 $ ] be a sequence of functionals @xmath344-converging to @xmath352 .",
    "suppose @xmath348 is a relatively compact sequence in @xmath26 with @xmath359 then ,    1 .",
    "@xmath352 attains its minimum value and @xmath360 2 .",
    "the sequence @xmath348 has a cluster point , and every cluster point of the sequence is a minimizer of @xmath352 .    for this theorem to be applicable , it is standard to put some condition on @xmath346 so that ( [ eq : approxminimizers ] ) implies that the sequence @xmath361 is relatively compact in @xmath26 .",
    "[ def : compactness ] we say that the sequence of nonnegative functionals @xmath346 has the compactness property if for any sequence @xmath348 , the following two conditions ,    1 .",
    "@xmath348 is bounded in @xmath26 2 .",
    "the energies @xmath362 are bounded ,    imply that @xmath348 is relatively compact in @xmath26 .",
    "we now extend the above notions to the random setting . here",
    ", we have a probability space @xmath363 and a sequence of functionals @xmath364 $ ] .",
    "[ def : nondeterministicgamma ] we say the ( random ) sequence @xmath346 @xmath344-converges to the deterministic functional @xmath365 $ ] if    1 .   * liminf inequality * with probability @xmath9 , the following statement holds : for any @xmath347 and any sequence @xmath348 with @xmath357 , @xmath366 2 .",
    "* recovery sequence * for any @xmath347 , there exists a ( random ) sequence @xmath348 with @xmath367 and @xmath368 .",
    "[ def : random_compactness ] we say the ( random ) sequence @xmath346 has the compactness property if with probability @xmath9 , the sequence @xmath369 has the compactness property in definition [ def : compactness ] .",
    "[ rmk : compactness]the definition for @xmath344-convergence of random functionals , definition [ def : nondeterministicgamma ] , is weaker than the one in @xcite , which prescribes that definition [ defn_det ] holds with probability @xmath9 .",
    "however , in our definition [ def : nondeterministicgamma ] , with respect to the recovery sequence , the probability @xmath9 set may depend on the sequence , and therefore is an easier condition to verify , say with probabilistic arguments .",
    "interestingly , this weaker definition has the same strength in terms of its application in the following gamma convergence statement , theorem [ thm : nondeterministicgamma ] , a main vehicle in the proof of theorem [ thm : mainthm ] .    in passing",
    ", we also note that the compactness criterion of random functionals , definition [ def : random_compactness ] , can also be weakened , in that the probability @xmath9 set may depend on the particular bounded sequence in definition [ def : compactness ] , without altering the statement of the gamma convergence theorem [ thm : nondeterministicgamma ] , and with virtually the same proof .",
    "[ thm : nondeterministicgamma ] let @xmath364 $ ] be a sequence of random functionals @xmath344-converging to a limit @xmath370 $ ] , in the sense of definition [ def : nondeterministicgamma ] , which is not identically equal to @xmath371 .",
    "suppose that @xmath346 has the compactness property , in the sense of definition [ def : random_compactness ] , and also the following condition holds : for @xmath372 in a probability @xmath9 set , there exists a bounded sequence , @xmath373 , whose bound may depend on @xmath372 , such that @xmath374 then , with probability @xmath9 ,    1 .",
    "@xmath352 attains its minimum value and @xmath360 2 .",
    "the sequence @xmath348 has a cluster point , and every cluster point of the sequence is a minimizer of @xmath352 .",
    "pick @xmath375 , along with a recovery sequence @xmath376 , so that on a probability @xmath9 set @xmath377 we have @xmath378 and @xmath379 .",
    "let @xmath380 be a probability @xmath9 set on which @xmath381 is a bounded sequence where @xmath382 .",
    "hence , on the probability @xmath9 set @xmath383 , we obtain @xmath384    applying the argument for ( [ eq : limsupas1 ] ) with respect to a countable collection @xmath385 with @xmath386 , we obtain on a probability @xmath9 set @xmath387 that @xmath388    now , because @xmath352 is not identically equal to @xmath371 , the right hand side of the above inequality is finite .",
    "then , on the probability @xmath9 set @xmath389 , the sequences @xmath350 and @xmath390 are bounded .",
    "let @xmath391 be the probability @xmath9 set on which the compactness property for @xmath353 holds .",
    "in particular , on @xmath392 , the bounded sequence @xmath393 is relatively compact . with respect to the set @xmath394 ,",
    "let @xmath395 be a subsequence converging to a cluster point @xmath396 , that is @xmath397 .",
    "let @xmath398 be a probability @xmath9 set on which the liminf inequality holds .",
    "then , on @xmath399 , we have @xmath400    combining ( [ eq : limbound1 ] ) and ( [ eq : limbound2 ] ) shows , since @xmath401 , that on the set @xmath402",
    "we have @xmath403 hence , we conclude that @xmath352 attains its minimum value , @xmath404 and @xmath396 is a minimizer of @xmath352 , proving part of the first statement .",
    "in fact , the second statement also follows : with respect to the probability @xmath9 set @xmath402 , every cluster point of @xmath350 is a minimizer of @xmath352 .",
    "we now show the remaining part of the first statement .",
    "with respect to the set @xmath402 , let @xmath405 be a subsequence of @xmath350 where , for some cluster point @xmath406 , @xmath407 then , by , we conclude on @xmath402 that @xmath408 . since @xmath409",
    ", we have on @xmath402 that @xmath410 .",
    "hence , we conclude on @xmath402 that @xmath411 .",
    "in this section , we write the modularity functional as a sum of a ` graph total variation ' term and a ` balance ' or ` quadratic ' term , which will aid in its subsequent analysis . a similar , but",
    "different decomposition was used in @xcite .    recall the modularity functional in subsection [ results ] acting on a partition @xmath151 of the data points @xmath4 into @xmath7 sets : @xmath412 here , @xmath413 , @xmath414 , and @xmath415 and the weights",
    "@xmath416 if @xmath417 and equal @xmath119 otherwise . the label @xmath418 is assigned to the point @xmath121 if @xmath419 for @xmath211 .",
    "define @xmath420 as the collection of indicator functions of subsets of @xmath4 .",
    "natural members of @xmath420 , in the above context , are @xmath421 for @xmath211 .",
    "note that the collection @xmath422 satisfies @xmath423 .",
    "observe now that @xmath35 , signifying that @xmath121 and @xmath122 have the same label , can be expressed in two ways : @xmath424    applying the first identity in to the first term in ( [ eq : modagain ] ) gives @xmath425    define the _ graph total variation _",
    "@xmath426 , acting on @xmath427 , to be @xmath428 then , we may write @xmath429    similarly , the second relation in gives @xmath430 define @xmath431 , for @xmath432 , by @xmath433 then , @xmath434 note that @xmath435 . with a bit of algebra , we obtain @xmath436,\\end{aligned}\\ ] ] which further equals @xmath437 we have used the relation @xmath438 in the last equality .",
    "hence , @xmath439 + 1/k.\\ ] ]    combining ( [ eq : multitv ] ) and ( [ eq : multiquad ] ) gives @xmath440 \\\\ & & \\ \\ \\ \\ + \\epsilon_n \\frac{n(n-1)}{4 m } \\sum_{k=1}^k gtv_{n}(u_{n , k } ) .",
    "\\nonumber\\end{aligned}\\ ] ]",
    "we analyze the ` graph total variation ' and ` quadratic ' terms , identified in the decomposition of the modularity functional in section [ reformulation_sect ] , in the first two subsections .",
    "then , in subsection [ asymptotic_formulas_sect ] , we collect estimates and prove theorem [ thm : asymptotics ] .    in this section , in accordance with the assumptions of theorem [ thm : asymptotics ] , we suppose that the partition @xmath441 of the data points @xmath4 is induced by a ` continuum ' partition @xmath442 of @xmath5 into @xmath7 sets with finite perimeter @xmath443 , where @xmath444 , for @xmath211 .",
    "define @xmath445 as the collection of measurable indicator functions of subsets @xmath180 .",
    "let @xmath446 , and note that @xmath447 is an extension of the indicator @xmath421 , defined on @xmath4 , for @xmath211 .",
    "of course , the family @xmath448 satisfies @xmath449 .      to show a.s .",
    "convergence of the graph total variations , we first state that its expectations converge , and then use concentration ideas to elicit convergence of the random quantitites .",
    "let @xmath450 .",
    "we define the _ nonlocal total variation _ of @xmath82 to be @xmath451 are independent random variables with density @xmath104 , we have @xmath452 = tv_{\\epsilon}(u;\\rho).\\ ] ] recalling the definition ( [ eq : gtvepsdef ] ) of the graph total variation , we therefore have @xmath453 =   tv_{\\epsilon_n}(u;\\rho).\\ ] ]    let also @xmath454    [ lemma : tvlim ] let @xmath450 such that @xmath455 .",
    "then , we have @xmath456    for general @xmath104 , continuous on @xmath5 and bounded above and below by positive constants , and @xmath457 , the result follows from part of the proof of @xcite , theorem 4.1 ( see remark 4.3 in @xcite ) , which is a much more involved result .",
    "this proof also holds in @xmath105 .    for the convenience of the reader",
    ", we make a few remarks ( see also remarks in @xcite ) , addressing the case @xmath458 .",
    "integrals of the form @xmath459 are considered in @xcite , where the limiting behavior as @xmath460 is established for @xmath461 . in @xcite and @xcite ,",
    "this is extended to general @xmath82 such that @xmath462 , with the result being @xmath463 where @xmath464 is the average of the @xmath465 component of the unit normal vector field on the unit sphere @xmath466 ( see @xcite , corollary 1.3 ) .",
    "the limit ( [ eq : nonlocalconvergenceponce ] ) implies ( [ eq : tvlimnonlocal ] ) .",
    "indeed , @xmath467 with @xmath468 and @xmath469",
    ". letting @xmath470 , it follows from ( [ eq : nonlocalconvergenceponce ] ) that @xmath471 finally , one may verify that @xmath472 , as desired .",
    "we now proceed to the almost sure convergence of the graph total variation to its continuum limit .",
    "[ lemma : gtvasconverge ] fix @xmath473 where @xmath474 , and let @xmath475 be a sequence converging to zero such that @xmath476 then , @xmath477 as @xmath170 .",
    "let @xmath478 , so that we have @xmath479    we let @xmath480 denote @xmath481= tv_{\\epsilon_n}(u;\\rho)$ ] , so that @xmath482 by lemma [ lemma : tvlim ] , we have @xmath483 .",
    "therefore , it remains to argue that @xmath484 almost surely .",
    "we introduce a bit of notation .",
    "let @xmath485 so that we have @xmath486 summing this gives @xmath487    we handle the three terms on the right hand side of the above equation separately .",
    "first , note that @xmath488 .",
    "an application of bernstein s inequality ( @xcite , lemma 19.32 ) in this setting yields , for @xmath489 , @xmath490    in lemma [ lemma : gtvestimates ] of the appendix , we prove the upper bounds @xmath491 and @xmath492 where @xmath341 is a constant independent of @xmath47 .",
    "hence , we have @xmath493    by our assumption ( [ eq : gtvlemmaeps ] ) , this implies @xmath494 and so , as @xmath163 , @xmath495 similarly , we have , as @xmath163 , @xmath496    what remains is the double sum @xmath497 .",
    "let @xmath498 be independent copies of @xmath499 .",
    "by the decoupling inequality of de la pea and montgomery - smith @xcite , there is a constant @xmath341 independent of @xmath47 and @xmath500 such that @xmath501    the sum @xmath502 is canonical , that is , @xmath503 = 0\\text { a.s.}$ ] and @xmath504 = 0 \\text { a.s.}$ ] , where @xmath505 and @xmath506 denote expectation with respect to the first and second variables respectively . a general concentration inequality for u - statistics given by gin , lataa and zinn in theorem 3.3 of @xcite , states , for canonical kernels @xmath507 , that @xmath508,\\end{aligned}\\ ] ] for all @xmath509 , where @xmath510 is a constant not depending on @xmath507 or @xmath47 , and @xmath511 , \\\\ & z = \\sup \\ { \\mathbb{e } \\sum_{i , j } h_{i , j}(x_i , y_j ) f_i(x_i ) g_j(y_j ) : \\mathbb{e } \\sum_i f_i^2(x_i ) \\leq 1 , \\mathbb{e } \\sum_j g_j^2(y_j ) \\leq 1 \\}.\\end{aligned}\\ ] ]    in our context , we take @xmath512 for @xmath513 , and @xmath514 otherwise , which gives the constants @xmath515 , @xmath516 , @xmath517 and , after a manipulation , @xmath518 , where @xmath519",
    "it follows that @xmath520 & \\frac{n^2 s^2}{\\mathbb{e}h_n^2 } , \\frac{ns}{\\|h_n\\|_{l^2 \\to l^2}},\\nonumber\\\\ & \\frac{n^{2/3 } s^{2/3}}{[\\max ( \\|\\mathbb{e}_x h_n^2\\|_{l^\\infty } ,    \\|\\mathbb{e}_yh_n^2\\|_{l^\\infty})]^{1/3 } } , \\frac{ns^{1/2}}{\\|h_n\\|_{l^\\infty}^{1/2 } } \\big)\\big]\\nonumber , \\end{aligned}\\end{aligned}\\ ] ] for some constant @xmath521 independent of @xmath47 and @xmath500 .    in corollary",
    "[ cor : gtvestimates ] of the appendix , we prove the upper bounds    @xmath522 , @xmath523 , @xmath524 , + @xmath525 , @xmath526 .",
    "hence , the minimum in the right hand side of ( [ eq : ustatexpbound ] ) simplifies to @xmath527    we claim , for sufficiently large @xmath47 , this minimum will be attained by @xmath528 : indeed , by , @xmath529 , and so @xmath530 is smaller than @xmath531 . also , @xmath532 is larger than @xmath530 since @xmath135 and @xmath102 .",
    "in addition , @xmath533 is larger than @xmath530 as @xmath102 .",
    "hence , we have @xmath534 where @xmath341 is a constant independent of @xmath47 . combining ( [ eq : decouple ] ) and ( [ eq : htailbound ] ) , gives @xmath535 for all @xmath536 .",
    "therefore , @xmath537 as @xmath170 . applying ( [ eq : gtvlconvergeas ] ) , ( [ eq : gtvmconvergeas ] ) , and ( [ eq : gtvhconvergeas ] ) to ( [ eq : gtvfdecomp ] ) completes the proof .",
    "we first consider convergence of certain ` mean - values ' , and then treat the random expressions , for various values of @xmath55 , in the subsequent subsubsections .    for @xmath450 and @xmath538 ,",
    "define @xmath539 by @xmath540 let @xmath541 and write , with this notation , @xmath542 define also @xmath543    [ lemma : lambdaepslim ] let @xmath544 be a bounded , measurable function on the domain @xmath5 .",
    "then , there exists a constant @xmath341 , independent of @xmath544 , such that @xmath545 .",
    "further , suppose there is a sequence @xmath546 with @xmath547 as @xmath548 .",
    "then , we have @xmath549    we first prove inequality ( [ eq : lambdaepsbound ] ) . by lemma [ lemma : mollified ] in the appendix ,",
    "there exist positive constants @xmath550 such that , for sufficiently small @xmath551 , both @xmath104 and @xmath552 take values in the interval @xmath553 $ ] .",
    "then we have @xmath554 where the last inequality follows from the observation that @xmath555 is lipschitz on the interval @xmath553 $ ] . by lemma [ lemma : mollified ] again , where @xmath556    we now prove ( [ eq : lambdaepslim ] ) .",
    "suppose we have a family @xmath557 with @xmath558 as @xmath559 .",
    "then , latexmath:[\\ ] ] where @xmath679 is a partition of the data points @xmath4 and @xmath680 for @xmath211 .",
    "as is our convention , we note that some of the @xmath681 may be empty sets , and so generally we have @xmath682 .",
    "we define @xmath683\\ ] ] and @xmath684 so that the problem of _ maximizing _",
    "@xmath157 over clusterings @xmath3 of @xmath4 with @xmath685 is equivalent to that of _ minimizing _ @xmath686 .",
    "we now place the modularity optimization problem on the space @xmath670 . recalling that @xmath179 denotes the empirical measure , we define @xmath687 by @xmath688 as a notational convenience , we often denote elements of @xmath689 by @xmath690 where @xmath421 and @xmath151 .",
    "define @xmath691 $ ] by @xmath692 the energy minimization problem @xmath693 is equivalent to the @xmath11-class modularity clustering problem ( [ prob : kmodoriginal ] ) , in the sense that @xmath3 is a solution to iff @xmath694 is a solution to .    similarly , we define continuum functionals on partitions @xmath25 of @xmath5 , via their indicators @xmath695 , by @xmath696 and @xmath697 where @xmath698 and @xmath699    define @xmath700 by @xmath701 as before , we denote elements of @xmath702 by @xmath703 where @xmath25 and @xmath446 for @xmath211 .",
    "define the energy @xmath704 $ ] as @xmath705    then , with @xmath64 as above and @xmath197 , the continuum partitioning problem ( [ prob : continuumk ] ) , which does not include the prefactor @xmath706 , is equivalent to @xmath707 in the sense that @xmath6 is a solution to iff @xmath708 is a solution to .",
    "as noted in subsection [ continuum problem ] , since there is a solution to , the problem also possesses a solution . in particular , the energy @xmath677 is not identically infinite .",
    "we now state the gamma convergence used later in the proof of theorem [ thm : mainthm ] .",
    "[ thm : maingamma ] under the assumptions of theorem [ thm : mainthm ] , the random functionals @xmath709 $ ] , given in ( [ eq : enenergydef ] ) , @xmath344-converge in @xmath195 to @xmath704 $ ] , given in ( [ eq : energydef ] ) : @xmath710 as @xmath170 , in the sense of definition [ def : nondeterministicgamma ] .",
    "the proof of theorem [ thm : maingamma ] is in two steps . in subsection",
    "[ liminf_subsect ] , via lemma [ lemma : eliminf ] , we give the ` liminf ' estimate . in subsection",
    "[ recovery_subsect ] , through lemma [ lemma : erecovery ] , we prove the ` recovery sequence ' property .",
    "we now argue the liminf inequality for the @xmath344-convergence in theorem [ thm : maingamma ] , according to definition [ def : nondeterministicgamma ] .",
    "recall that @xmath328 denotes the probability @xmath9 set of realizations @xmath294 , under which proposition [ thm : tmaps ] holds .",
    "we first show a closure property of @xmath689 and @xmath702 .",
    "[ lemma : mlemma ] on the probability @xmath9 set @xmath328 , the following statement holds : if @xmath711 is a sequence in @xmath689 and @xmath712 , then @xmath713 .",
    "fix a realization in the probability @xmath9 set @xmath328 .",
    "let @xmath714 and @xmath715 . by the characterization of @xmath241 convergence , lemma [ lemma : tl1convergence ] , for each @xmath211 we have @xmath716 , and",
    "so by corollary [ empconverge ] it follows that @xmath717 .",
    "further , we have @xmath718 where @xmath314 is the sequence of transportation maps given in proposition [ thm : tmaps ] .",
    "hence , as @xmath104 is bounded above and below on @xmath5 , it follows that @xmath719 is the @xmath565 limit of a sequence of indicator functions @xmath720 .",
    "it follows , by subsequential lebesgue a.e .",
    "convergence , that @xmath721 .",
    "similarly , the relation @xmath449 follows from the corresponding relations for @xmath422 .",
    "thus , @xmath722 .",
    "we now establish the following technical lemma , which adapts a technique from the proof of theorem 1.1 in @xcite to relate graph functionals with their continuum nonlocal analogues .",
    "[ lemma : glambdalimit ] on the probability @xmath9 set @xmath328 , the following statement holds : given any sequence of uniformly bounded , nonnegative functions @xmath723 , and a function @xmath544 , if @xmath724 , then @xmath725    fix a realization in the probability @xmath9 set @xmath328 .",
    "recall , from and , that @xmath726 and @xmath727 .",
    "let @xmath314 be the transport maps in proposition [ thm : tmaps ] .",
    "since @xmath330 , by a change of variables , we have @xmath728 for what follows , let @xmath729 .",
    "recall also , from , that @xmath730 .",
    ".1 cm _ step 1 .",
    "_ first , suppose that @xmath114 is of the form @xmath731 for @xmath732 and @xmath733 for @xmath734 .",
    "define @xmath735 and note that , for lebesgue a.e .",
    "@xmath736 , @xmath737    by the form of @xmath114 , we have the bound @xmath738 integrating with respect to @xmath739 , and scaling appropriately , we obtain @xmath740 for lebesgue a.e . @xmath741 .    by the assumption ( i2 ) on @xmath123 , together with the estimates in proposition [ thm : tmaps ] on @xmath314 , it follows that @xmath123 vanishes slower than @xmath742 , and so for large @xmath47 we have @xmath743 in particular , for lebesgue a.e .",
    "@xmath744 , @xmath745 and so @xmath746 again , integrating with respect to @xmath747 and scaling appropriately , we obtain a lower bound of @xmath748 , and can write , for lebesgue a.e .",
    "x , @xmath749 by the assumption ( i2 ) on the rate @xmath123 , we observe that @xmath750 similarly , we have @xmath751 .",
    "in light of ( [ eq : squeeze ] ) , and lemma [ lemma : mollified ] in the appendix , which shows @xmath752 and bounds @xmath607 from above and below",
    ", we make two observations :    1 .   for lebesgue a.e .",
    "@xmath166 , we have @xmath753 as @xmath163 .",
    "there exist constants @xmath754 such that , for all large @xmath47 , @xmath755 for lebesgue a.e . @xmath166 .",
    ".1 cm _ step 2 .",
    "_ now let @xmath114 be a simple function satisfying assumptions @xmath120 , which implies that we may write @xmath114 as a convex combination @xmath756 for functions @xmath757 satisfying the assumptions of step 1 . we let @xmath758 so that @xmath759 .",
    "hence ,    1 .   for lebesgue a.e .",
    "@xmath166 , each @xmath760 as @xmath163 .",
    "the same holds for the convex combination @xmath761 .",
    "2 .   there exist constants @xmath754 such that , for all large @xmath47 , @xmath762 for lebesgue a.e .",
    "therefore , the same holds for @xmath761 .",
    "note also , since @xmath763 by the assumption ( i2 ) , we have @xmath764 vanishes as @xmath163 .",
    "we have then , by bounded convergence , that @xmath765    since @xmath104 is bounded , we now argue that @xmath766 by adding and subtracting @xmath767 , we obtain @xmath768    with respect to the first term on the right side , by assumption , @xmath769 is uniformly bounded . also , the sequence @xmath761 is bounded above and below , and converges lebesgue a.e . to @xmath104 , so by dominated convergence the integral vanishes in the limit . with respect to the second term on the right side ,",
    "suppose @xmath770 as @xmath163 .",
    "since @xmath104 is bounded above and below , we have @xmath771 is bounded , and the corresponding integral , by the characterization of @xmath241 convergence in lemma [ lemma : tl1convergence ] , also vanishes in the limit .",
    "hence , when the kernel @xmath114 is a simple function , we have that @xmath772 .1 cm    _ step 3 .",
    "_ now , we consider general @xmath114 satisfying properties @xmath120 .",
    "we first approximate @xmath114 by simple functions @xmath773 , satisfying @xmath774 , with @xmath775 and @xmath776 pointwise .",
    "let @xmath777 , and @xmath778 .",
    "then , by ( [ eq : simplelimit ] ) , we have @xmath779 because @xmath775 , and the sequence @xmath780 is assumed nonnegative , we have that @xmath781 and taking the limit @xmath782 as @xmath783 gives @xmath784    likewise , consider approximating @xmath114 by simple functions @xmath773 satisfying @xmath774 , with @xmath785 and @xmath776 pointwise . then , similarly , we obtain that @xmath786    combining inequalities ( [ eq : glineq1 ] ) and ( [ eq : glineq2 ] ) gives that @xmath787 completing the proof .",
    "[ lemma : flim ] on the probability @xmath9 set @xmath328 , the following statement holds : given any sequence @xmath788 such that @xmath789 , where @xmath790 and @xmath791 , then @xmath792    fix a realization in the probability @xmath9 set @xmath328 . if @xmath793 , the above inequality holds trivially .",
    "we now consider the other case when @xmath794 . recalling the definitions ( [ eq : fdef ] ) and of @xmath352 and @xmath665 ,",
    "this means that there is a @xmath211 such that @xmath795 satisfies @xmath796 .",
    "let @xmath797 .",
    "now , by corollary [ empconverge ] , @xmath337 , and so @xmath798 by lemma [ lemma : tl1convergence ] , as @xmath163 . therefore , by lemma [ lemma : glambdalimit ] , as @xmath163 we have @xmath799 by decomposing @xmath800 and noting lemma [ lemma : glambdalimit ] again , it follows that , if @xmath801 , then @xmath802 in particular , there is an @xmath803 , depending on the realization , such that , for @xmath804 , we have @xmath805 since @xmath806 and @xmath807 , it follows that @xmath808 hence , in this case also , inequality ( [ eq : gfliminf ] ) holds .",
    "[ lemma : gtvliminf ] on the probability @xmath9 set @xmath328 , the following statement holds : given any sequence @xmath809 such that @xmath810 , then @xmath811 where @xmath657 .",
    "the desired statement follows the same argument given for the liminf inequality for the gamma convergence stated in theorem 1.1 in @xcite  see step 3 of section 5.1 of @xcite .",
    "there , the probability @xmath9 set is @xmath328 .",
    "we note this proof , although stated for @xmath457 , also holds in @xmath105 with the same notation .    for a sense of what is involved , note that in @xcite , section 4.1 , it is proved , for @xmath812 with @xmath813 in @xmath814 , that the following liminf inequality holds : @xmath815    to apply ( [ eq : nonlocalliminf ] ) to the graph total variation",
    ", one may proceed in three steps , analogous to the proof of lemma [ lemma : glambdalimit ] , by first considering @xmath114 that are normalized indicator functions , then simple functions , and finally the general kernels satisfying assumptions @xmath120 , to show @xmath816 combining ( [ eq : nonlocalliminf ] ) and ( [ eq : gtvnonlocalliminf ] ) would then give the proof .",
    "[ lemma : gtvlim ] on the probability @xmath9 set @xmath328 , the following statement holds : given any sequence @xmath788 such that @xmath789 , where @xmath790 and @xmath791 , then @xmath817    fix a realization in the probability @xmath9 set @xmath328 . note that @xmath337 by corollary [ empconverge ] , and so @xmath818 by lemma [ lemma : tl1convergence ] , as @xmath163",
    ". hence , by lemma [ lemma : glambdalimit ] , applied with @xmath141 and @xmath819 , we have that @xmath820 , as @xmath163 .",
    "recall now that @xmath821 .",
    "if @xmath789 , by lemma [ lemma : gtvliminf ] , we have @xmath822 for @xmath211 .",
    "it follows that @xmath823 where @xmath824 .",
    "[ lemma : eliminf ] on the probability @xmath9 set @xmath328 , the following statement holds : given any sequence @xmath825 in @xmath670 and @xmath826 such that @xmath789 as @xmath163 , then @xmath827    fix a realization in the probability @xmath9 set @xmath328 . without loss of generality , we may assume that @xmath828 , as @xmath829 diverges otherwise .",
    "if @xmath801 , by lemma [ lemma : mlemma ] , it follows that @xmath830 .",
    "also , by lemmas [ lemma : flim ] and [ lemma : gtvlim ] , we have @xmath831 adding these two liminf inequalities gives @xmath832 .",
    "recovery sequence for @xmath833 in @xmath702 will be @xmath834 , where @xmath3 is the partition of @xmath4 induced by @xmath6 .",
    "however , before proving this in lemma [ lemma : erecovery ] , we first establish a preliminary result .",
    "[ lemma : restrictconverge ] fix @xmath450 , and let @xmath329 be the transport maps given in proposition [ thm : tmaps ] .",
    "then , a.s .",
    ", @xmath835    let @xmath836 be a lipschitz function such that @xmath837 .",
    "let @xmath838 be a lower bound for @xmath104 on @xmath5 .",
    "it follows that @xmath839    we rewrite the first term in the right side of ( [ eq : recovu ] ) in terms of the data set @xmath4 : @xmath840 by the strong law of large numbers , we have a.s . that @xmath841 )",
    ", let @xmath341 be the lipschitz constant for @xmath836",
    ". then a.s .",
    ", by proposition [ thm : tmaps ] , @xmath842    taking limits in ( [ eq : recovu ] ) therefore gives a.s .",
    "that @xmath843 letting @xmath551 go to zero along a countable sequence establishes the lemma .",
    "[ lemma : erecovery ] let @xmath844 .",
    "if @xmath830 , let @xmath845 , where @xmath846 for @xmath847 and @xmath156 . on the other hand , if @xmath848 , let @xmath849 for @xmath156 .",
    "then , a.s .",
    ", as @xmath163 , @xmath850    in the case that @xmath851 , since the sequence @xmath852 is composed of distinct elements , for all large @xmath47 , @xmath853 and hence @xmath854 .",
    "suppose now that @xmath855 .",
    "in the following , we will use the fact that @xmath856 when @xmath857 . to show a.s .",
    "that @xmath789 as @xmath163 , by lemma [ lemma : tl1convergence ] , it is enough to show a.s . that @xmath337 and , for @xmath211 , that @xmath858 as @xmath163 , since @xmath859 implies @xmath860 .    the a.s .",
    "convergence @xmath343 follows , for instance , by corollary [ empconverge ] . on the other hand , the limit ( [ eq : utlimit ] ) follows by lemma [ lemma : restrictconverge ] .    to show that a.s .",
    "@xmath861 , we need to show that @xmath862 as @xmath163 . since condition ( i2 ) on @xmath133 implies condition ( i1 ) , we shall see that these limits in fact follow from the proof of theorem [ thm : asymptotics ] .",
    "in particular , recall the definitions and of @xmath863 and @xmath864 respectively .",
    "then , since @xmath865 on @xmath4 , the limit @xmath866 , as @xmath163 , follows from .    with regards to the @xmath867 convergence , we consider two possibilities .",
    "first , suppose that @xmath6 is balanced .",
    "then , recalling the definition , and again noting that @xmath865 on @xmath4 , it follows from that @xmath868 as @xmath170 .",
    "suppose now that @xmath6 is not balanced , so that @xmath869",
    ". then implies , as @xmath163 , that @xmath870 .",
    "having considered all cases , is established .",
    "after a few preliminary estimates , we supply the needed compactness property for the graph energies @xmath871 in theorem [ thm : compactness ] .",
    "then , we prove theorem [ thm : mainthm ] at the end of the section .",
    "[ lemma : d_compactness ]",
    "let @xmath809 be a sequence of indicator functions on @xmath5 , @xmath872 , and @xmath475 be a sequence of positive numbers with @xmath873 . if @xmath874 then @xmath809 is relatively compact with respect to the @xmath565 topology .",
    "this result is a special case of proposition 4.6 of @xcite and theorem 3.1 of @xcite , which treat more involved settings .",
    "however , for the convenience of the reader , we present a streamlined argument in our situation , which makes use of the assumptions that the functions @xmath809 are @xmath875-valued , and that the kernel @xmath114 is compactly supported .    for what follows ,",
    "we extend @xmath876 to all of @xmath98 by setting @xmath877 for @xmath878 .",
    "note that @xmath879 since @xmath880 vanishes on @xmath881 .",
    "now , as @xmath882 , it follows that there is a constant @xmath341 such that @xmath883    let @xmath884 be such that @xmath885 when @xmath886 , and let @xmath887 be the @xmath888-neighborhood of @xmath889 .",
    "note that the volume of @xmath890 is bounded by @xmath891 for some constant @xmath341 .",
    "then , by boundedness of @xmath892 and property ( k1 ) of the kernel @xmath114 , we have @xmath893 combining ( [ eq : upperboundeps1 ] ) and ( [ eq : upperboundeps2 ] ) thus gives , in terms of another constant @xmath341 , that @xmath894    now , let @xmath895 be a non - negative , smooth , compactly supported radial function , with @xmath896 , @xmath897 , and @xmath898 . indeed , by property ( k3 ) , since @xmath118 and @xmath114 is continuous at zero , such a @xmath69 exists .",
    "let @xmath899 and @xmath900 .",
    "define the sequence @xmath901 by @xmath902 we make the following observations .    1 .",
    "the sequence @xmath903 is bounded in @xmath814 , @xmath904 as @xmath876 is an indicator function on @xmath5 , and extended by zero outside of @xmath5 .",
    "we have the limit @xmath905 as @xmath163 .",
    "indeed , one may verify the inequality @xmath906 since @xmath907 and holds .",
    "the gradient @xmath908 is uniformly bounded in @xmath814 . to see this , note that @xmath909 here , the second equality follows as @xmath910 because @xmath69 is compactly supported , .",
    "the third inequality follows as @xmath911 .",
    "now , because @xmath912 and @xmath913 , it follows by theorem 3.23 of @xcite that @xmath914 is relatively compact in @xmath814 . since @xmath915 , as @xmath163",
    ", it follows that the sequence @xmath809 is also relatively compact in @xmath814 , with the same cluster points as @xmath916 .",
    "recall that @xmath328 denotes the probability @xmath9 set of realizations of @xmath917 under which proposition [ thm : tmaps ] holds .",
    "[ lemma : gtvcompact ] suppose @xmath133 satifies condition ( i2 ) . on the probability @xmath9 set @xmath328 ,",
    "the following holds : given any sequence @xmath809 of indicator functions on the data points , @xmath918 , if @xmath919 then @xmath920 is relatively compact with respect to the @xmath241 topology .",
    "we begin as in the proof of lemma [ lemma : glambdalimit ] .",
    "fix a realization in the probability @xmath9 set @xmath328 .",
    "suppose that @xmath114 is of the form @xmath731 for @xmath732 and @xmath733 for @xmath734 .",
    "let @xmath921 , with respect to the transport maps @xmath314 .",
    "then , for all large @xmath47 , @xmath922 , and we have the inequality ( [ eq : etatransportineq ] ) , @xmath923 let @xmath838 be a lower bound for @xmath104 on @xmath5 .",
    "then , @xmath924 the above inequality is equivalent to @xmath925    since @xmath926 , the bound @xmath927 implies that @xmath928 it follows , by lemma [ lemma : d_compactness ] , that the family @xmath929 is relatively compact with respect to the @xmath565 topology . since , by corollary",
    "[ empconverge ] , @xmath343 , we conclude by lemma [ lemma : tl1convergence ] that @xmath930 is relatively compact in @xmath241 .",
    "suppose now @xmath114 is an arbitrary kernel satisfying assumptions @xmath931-@xmath932 . since @xmath114 is continuous at zero , and @xmath118 , there is some radius @xmath884 such that @xmath933 satisfies @xmath934 .",
    "let @xmath935 .",
    "then , if @xmath936 denotes the graph total variation associated to the kernel @xmath937 ( instead of @xmath114 ) , we have @xmath938 since @xmath939 implies @xmath940 , it follows from our previous discussion that the sequence @xmath941 is relatively compact in @xmath320 .",
    "[ thm : compactness ] suppose @xmath153 satisfies condition ( i2 ) .",
    "on the probability @xmath9 set @xmath328 , the following holds : given any sequence @xmath942 , if @xmath943 then @xmath944 is relatively compact with respect to the @xmath195 topology .    fix a realization in the probability @xmath9 set @xmath328 .",
    "suppose @xmath945 . by definition of @xmath671 , it follows that @xmath946 where @xmath151 for @xmath947 .",
    "by corollary [ empconverge ] , we have @xmath337 . since @xmath948 by lemma [ lemma : tl1convergence ] , we have , by lemma [ lemma : glambdalimit ] , that @xmath949 .",
    "recall now that @xmath950 and @xmath951 where @xmath421 for @xmath211 .",
    "hence , given that @xmath952 , we have @xmath953 for @xmath33 .",
    "thus , by lemma [ lemma : gtvcompact ] , the collection @xmath954 is relatively compact in @xmath241 for @xmath955 .",
    "thus , @xmath956 is relatively compact in @xmath195 .",
    "* proof of theorem [ thm : mainthm ] .",
    "* we have seen in theorem [ thm : maingamma ] that @xmath957 in the sense of definition [ def : nondeterministicgamma ] . by theorem [ thm : compactness ] , the graph energies @xmath675 have the compactness property according to definition [ def : random_compactness ] . also , as noted in subsection [ reformulation_min_sect ] ,",
    "the energy @xmath677 is not identically infinite .    for each realization",
    "@xmath294 , consider a partition @xmath958 .",
    "then , by the discussion in subsection [ reformulation_min_sect ] , @xmath194 is a minimizer of @xmath959 , and so @xmath960 is a minimizer of @xmath671 .",
    "the sequence @xmath944 is also bounded in @xmath195 : indeed , we have @xmath961 and , for @xmath962 , @xmath963 .    hence , on the full set of realizations @xmath964 , denoted as @xmath965 , the sequence @xmath966 , on the metric space @xmath195 , satisfies the hypotheses of theorem [ thm : nondeterministicgamma ] .",
    "therefore , with respect to realizations @xmath964 on a probability @xmath9 set @xmath967 , @xmath968 converges in @xmath195 , perhaps along a subsequence , to a limit @xmath969 , which is a minimizer of @xmath677 , and is therefore of the form @xmath970 . since the ` liminf ' inequality , lemma [ lemma : eliminf ] , holds on @xmath328",
    ", we note that @xmath971 .",
    "moreover , by corollary [ empconverge ] , @xmath972 on @xmath967 . therefore , by , on @xmath967 , @xmath194 converges weakly , perhaps along a subsequence , to the limit @xmath193 , which is an optimal partition of the continuum problem with @xmath973 and @xmath974 .    in fact , we may conclude that , on @xmath967 , the distances @xmath975 , where @xmath976 is the product metric for @xmath195 convergence , satisfy @xmath977 as @xmath170 . for if not",
    ", there is a subsequence @xmath978 with @xmath979 .",
    "however , by the above discussion one may find a further subsequence @xmath980 with @xmath981 , a contradiction .",
    "moreover , if problem has a unique solution @xmath982 , modulo permutations , then @xmath983 , where @xmath984 denotes the permutations of @xmath985 and @xmath986 for @xmath33 .",
    "thus , on the probability 1 set @xmath967 , since @xmath977 , one may construct a sequence @xmath987 of permutations such that , as @xmath170 , @xmath988 converges in @xmath195 to @xmath989 .",
    "hence , by , @xmath194 converges to @xmath193 weakly , in the sense of .",
    "@xmath552 converges pointwise to @xmath104 as @xmath990 .",
    "2 .   there exists a constant @xmath341 such that , for sufficiently small @xmath551 , @xmath991 3 .",
    "there exist constants @xmath992 such that , for sufficiently small @xmath551 , @xmath993      we now focus attention on item ( ii ) , inequality ( [ eq : mollifiedrate ] ) . for the moment , fix @xmath741 .",
    "since @xmath114 is compactly supported , we take @xmath884 such that @xmath885 for @xmath994 . then for @xmath995 , we have , since @xmath996 , that @xmath997 and so , @xmath998              for item ( iii ) of the lemma , note that because the boundary of @xmath5 is lipschitz , there exists constants @xmath1011 such that , for any @xmath1012 and @xmath1013 , @xmath1014 where @xmath1015 denotes the ball of radius @xmath1016 centered at @xmath166 ( cf .",
    "the discussion about cone conditions in section 4.11 of @xcite ) .    by assumption",
    ", @xmath104 is bounded above and below : @xmath1017 .",
    "also , by assumption ( k3 ) , @xmath114 is continuous at zero and @xmath118 , so we may take @xmath1016 so that @xmath1018 for @xmath1019 . letting @xmath1020 , we thus have @xmath1021 since @xmath1022 , the upper bound @xmath1023 holds .",
    "this completes the lemma .",
    "recall that by assumption @xmath1030 of subsection [ results ] , @xmath1 is a probability measure on @xmath1031 with distribution function @xmath103 and density @xmath104 that is differentiable , lipschitz , and bounded above and below by positive constants .",
    "further , @xmath104 is increasing in some interval with left endpoint @xmath107 and decreasing in some interval with right endpoint @xmath108 .",
    "given a sample @xmath1032 , we let @xmath867 denote the distribution function of the empirical measure @xmath1033 . we define @xmath1034 by @xmath1035 where @xmath1036 .",
    "the map @xmath1034 is a valid transport map , i.e. @xmath1037      it is known ",
    "see theorem 3 on p. 650 of @xcite  that when i ) @xmath1039 on @xmath1040 , ii ) inequality is satisfied , and iii ) @xmath104 is increasing in some interval with left endpoint @xmath107 and decreasing in some interval with right endpoint @xmath108 , the standardized quantile process @xmath1041,\\ ] ] with @xmath1042 , satisfies , almost surely , @xmath1043    since @xmath104 is bounded above and below by non - negative constants , so is @xmath544 , and so we have constants @xmath1044 such that @xmath1045 since @xmath104 is positive , @xmath352 is strictly increasing , and hence we have @xmath1046 recalling our definition of @xmath1034 , this may be rewritten as @xmath1047                                            ( 2006 ) . from discrete systems to continuous variational problems : an introduction . in",
    "_ topics on concentration phenomena and problems with multiple scales _ , lecture notes of the unione matematica italiana * 2 * , 377 .",
    "empirical graph laplacian approximation of laplace - beltrami operators : large sample results in _ high dimensional probability _ * 51 * 238259 .",
    "ims lecture notes monogr .",
    "statist . ,",
    "beachwood , oh"
  ],
  "abstract_text": [
    "<S> we consider a large class of random geometric graphs constructed from samples @xmath0 of independent , identically distributed observations of an underlying probability measure @xmath1 on a bounded domain @xmath2 . </S>",
    "<S> the popular ` modularity ' clustering method specifies a partition @xmath3 of the set @xmath4 as the solution of an optimization problem . in this paper , under conditions on @xmath1 and @xmath5 , we derive scaling limits of the modularity clustering on random geometric graphs . among other results , </S>",
    "<S> we show a geometric form of consistency : when the number of clusters is a priori bounded above , the discrete optimal partitions @xmath3 converge in a certain sense to a continuum partition @xmath6 of the underlying domain @xmath5 , characterized as the solution of a type of kelvin s shape optimization problem . </S>"
  ]
}