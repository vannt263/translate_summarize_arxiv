{
  "article_text": [
    "in recent years simulations of babcock - leighton type flux - transport ( hereafter blft ) solar dynamos in both 2d and 3d @xcite demonstrated the crucial role the sun s global meridional circulation plays in determining solar cycle properties .",
    "time variations in speed and profile of meridional circulation have profound influence on solar cycle length and amplitude .",
    "the recent unusually long minimum between cycles 23 and 24 has been explained by implementing two plausible changes in meridional circulation , ( i ) by implementing the change from a two - celled profile in latitude in cycles 22 to a one - celled profile in cycle 23 @xcite , and ( ii ) by performing a vast number of simulations by introducing a flow - speed change with time during the declining phase of each cycle @xcite . accurately knowing the speed and profile variations of the meridional circulation would greatly improve prediction of solar cycle features .",
    "the meridional circulation has been observed in the photosphere and inside the upper convection zone in the latitude range from the equator to @xmath1 in each hemisphere @xcite .",
    "however , the speed , pattern and time variations of the circulation at high latitudes and in the deeper convection zone are not known from observations yet . theoretical models of meridional circulation @xcite provide some knowledge , but the flow patterns derived from model outputs vary from model to model , primarily because of our lack of knowledge of viscosity and density profiles and thermodynamics in the solar interior , which are essential ingredients in such models . as differential rotation does not change much with time compared to meridional circulation , in this first study",
    "we focus on time variation of meridional flow - speed , using a set - up similar to that used previously @xcite .",
    "since the meridional circulation is a specified parameter in kinematic blft dynamos and the dynamo solutions depend sensitively on the spatio - temporal patterns of this circulation , we ask the question : can we infer the meridional circulation ( in both space and time ) from observations of the magnetic field ?",
    "the purpose of this paper is to describe an ensemble kalman filter ( enkf ) data assimilation in a 2d blft solar dynamo model for reconstructing meridional flow - speed as a function of time for several solar cycles .",
    "a subsequent paper will investigate the reconstruction of spatio - temporal patterns of meridional circulation in the solar convection zone .",
    "data assimilation approaches have been in use for several decades in atmospheric and oceanic models , but such approaches have been implemented in solar and geodynamo models only recently .",
    "@xcite introduced a variational data assimilation system into an @xmath2-@xmath3 type solar dynamo model to reconstruct the @xmath2-effect using synthetic data .",
    "very recently @xcite applied a variational data assimilation method to estimate errors of the reconstructed system states in a stratified convection model .",
    "a detailed discussion of data assimilation in the context of the geodynamo can be found in @xcite .    in a sequential data assimilation framework ,",
    "a set of dynamical variables at a particular time defines a `` model state '' , which is the time - varying flow speed in the context of the present paper .",
    "scalar functions of these state variables that can also be observed using certain instruments are called `` observation variables '' , which are magnetic fields here .",
    "more detailed terminology for identifying data assimilation components with solar physics variables is given in  2 . in brief , the goal of sequential data assimilation is to constrain the model state at each time - step to obtain model - generated observation variables that are as close to the real observations as possible .",
    "the basic framework is based on statistical multidimensional regression analysis , a well - developed method that has been applied in atmospheric and oceanic studies ( see @xcite for details ) .",
    "the enkf sequential data assimilation framework also allows adding model parameters to the set of model states and estimating values of these parameters that are most consistent with the observations .",
    "it is a common practice to perform an `` observation system simulation experiment '' ( osse ) in order to validate and calibrate the assimilation framework for a particular model .",
    "an osse generates synthetic observations from the same numerical model that is used in the assimilation . in this case",
    "the numerical model is a simple blft dynamo model containing only a weak nonlinearity in the @xmath2-quenching term ; thus adding gaussian noise to model - outputs for producing synthetic observations works well . in a more realistic situation for a large system with highly nonlinear processes , such as in numerical weather prediction models",
    ", it may be necessary to use a non - gaussian ensemble filter ( see , e.g. @xcite ) .",
    "a few examples of predicting model parameters using sequential data assimilation techniques have been presented by @xcite and @xcite in the context of estimating neutral thermospheric composition , and most recently by @xcite for estimating thermospheric mass density .",
    "an enkf data assimilation framework has recently been applied to a 3d , convection - driven geodynamo model for full state estimation using surface poloidal magnetic fields as observations @xcite .",
    "we implement enkf sequential data assimilation to reconstruct time - variations in meridional flow - speed for several solar cycles , using poloidal and toroidal magnetic fields as observations .",
    "we note certain differences in our case compared to the cases described above , namely , unlike neutral thermospheric composition and thermospheric mass density , the meridional flow - speed is not governed by a deterministic equation .",
    "in order to describe the enkf data assimilation methodology , we first identify the data assimilation components with solar physics variables .",
    "a physical blft dynamo model , which generates magnetic field data for a given the meridional flow - speed , is called the `` forward operator '' .",
    "the time - varying meridional flow - speed at a given time is the `` model state '' and will be estimated by the enkf system .",
    "the enkf requires a prediction model that generates a forecast of the meridional flow - speed at a later time given the value at the current time . here",
    ", that prediction model simply adds a random draw from a gaussian distribution to the current meridional flow - speed , because the blft dynamo model we are using here is a kinematic dynamo model . in the future ,",
    "the results can be further refined by imposing additional physical conditions using a dynamical dynamo model .",
    "it is important not to confuse the prediction model with the blft dynamo model that acts as a forward operator for the data assimilation process .",
    "figure 1 schematically depicts the data assimilation framework considering an `` ensemble of three members '' of the prediction model state ( meridional flow - speeds ) .",
    "sequential assimilation can usually be described as a two - step procedure , a forecast followed by an analysis each time an observation is available . in figure 1 , @xmath4 near the label ( a ) denote three different realizations of initial flow - speeds , which are input to the prediction model .",
    "we generate `` prior '' estimates of the model state ( denoted by @xmath5 near the label ( b ) ) by using the prediction model to advance the estimates of the flow - speed from the initial time ( @xmath6 ) to the time ( @xmath7 ) at which the first observations of magnetic field are available . in this case , the prediction model just adds a different draw from the gaussian noise distribution to each initial ensemble estimate of the flow speed ( @xmath8 along the solid green arrows in figure 1 ) .",
    "the resulting ensemble of flow speeds is referred to as a prior ensemble estimate .",
    "the central equation for estimating the prior state is a stochastic equation given by , @xmath9 in which , @xmath10 is a function for generating normalized gaussian random numbers with unit amplitude and unit standard deviation , and the amplitude of the prediction model noise is governed by @xmath11",
    ". thus the evolution of the system from label ( a ) to ( b ) through equation ( 1 ) , denoted by eq1 in figure 1 , constitutes the first step of the two - step procedure in sequential assimilation .",
    "the second step includes ( i ) producing observations from outputs of the forward operator and ( ii ) estimating posterior flow - speeds by employing regression among these observations , real observations ( synthetic in osse ) and prior flow - speeds .",
    "the forward operator ( blft dynamo in this case ) is denoted by @xmath12 along the solid black arrows , which uses the prior estimates of flow speed to produce a prior `` ensemble of observation estimates '' which are magnetic field outputs .",
    "three realizations of magnetic fields from the forward operator are denoted by @xmath13 , @xmath14 , @xmath15 in figure 1 .",
    "note that the statement , `` forward operator operating on three model states generates three prior observation estimates '' , is equivalent to the statement , `` blft dynamo running with three meridional flow speeds produces three sets of model outputs of magnetic fields '' .    to elucidate the second step of assimilation",
    ", we describe the function of the `` filter '' . for real prediction using enkf data assimilation",
    ", we would have real data ( observations ) from instruments ; in our osse case it is synthetic , denoted by @xmath16 in figure 1 .",
    "synthetic observations are generated by applying the forward operator to a specified time series of meridional flow - speeds ( as shown in figure 2a ) .",
    "our goal is to apply an enkf to obtain an improved distribution of estimated flow - speeds ( i.e. `` posterior states '' , @xmath17 ) using the prior ensemble and the observation of magnetic field .",
    "the enkf ( black - dotted box in the diagram ) first compares the prior ensemble of observation - estimates to the actual observation and computes increments to the prior observation - estimates .",
    "these observation - increments are then regressed using the joint prior - ensemble distribution of flow - speed and magnetic field observations to compute increments for the prior - ensemble of flow - speeds .",
    "the enkf can also produce a posterior - ensemble of magnetic field observations ( @xmath18 ) , which can be used for diagnostic purposes .",
    "the posterior - ensemble distribution of flow - speeds is the best estimate of the flow - speed distribution at time @xmath7 given the available observations .",
    "mean flow - speed at time @xmath7 can be calculated by taking the average over all ensemble members .    to proceed with the reconstruction of flow - speeds at the time of the next observation , @xmath19 , the reconstructed flow - speeds at time @xmath7 are used as the input to the prediction model ( equation ( 1 ) ) , and the same procedure described in the previous paragraphs",
    "is repeated .",
    "random gaussian noise through equation ( 1 ) prevents degeneration of ensemble .",
    "thus after many time steps , the entire time series of the ensemble distribution of flow - speeds can be constructed .",
    "time series of the mean flow - speeds can be calculated by taking the average over all ensemble members at each time .",
    "however , it may produce a better reconstruction in some cases if one ensemble member , which produced observation ( @xmath20 ) closest to real observation ( @xmath16 ) , is chosen .    in order to perform an osse ,",
    "it is now necessary to define the `` true state '' flow - speed as a function of time .",
    "synthetic observations are generated at selected times by applying the forward operator ( blft dynamo model ) to the true state flow - speed at the appropriate time and adding on a random draw from a specified observational error distribution to simulate instrumental and other errors .    as noted above",
    ", the forward operator is a kinematic blft dynamo model , described in detail in @xcite .",
    "the dynamo ingredients are a solar - like differential rotation , a single - celled meridional circulation , a babcock - leighton type surface @xmath2-effect and a depth - dependent diffusivity ; the mathematical forms are prescribed in @xcite .",
    "dynamo equations , computation domain and boundary conditions are used as given in @xcite . at @xmath21",
    "we start the integration of the dynamo - dart system over the first assimilation - step by initializing the forward operator ( ftd model ) with a converged solution for a flow - speed of @xmath22 . in the subsequent assimilation - steps , the solution at the end of previous assimilation - step for each ensemble - member is used as initial condition .",
    "we construct a time - varying flow - speed for a span of 35 years ( see figure 2(a ) ) , guided by observations @xcite , which has a natural variation of 20 - 40% with respect to the mean flow considered here , i.e. 14 @xmath23 , as shown by the thin black line in figure 2(a ) .",
    "this specified time - varying flow - speed is referred to as the true model state .",
    "thus , keeping the spatial pattern of meridional circulation fixed , we consider here reconstructing the time - series of the scalar flow - speed .    to generate synthetic magnetic field data , we incorporate the time - varying true meridional flow - speed in our blft dynamo , and simulate the time series of idealized magnetic fields in the entire computation domain .",
    "then we construct the time series of synthetic magnetic observations by adding synthetic observational error to the simulated idealized magnetic data . figure 2(b ) shows a single observation , which is created from the simulated poloidal field by extracting from the location , @xmath24 and @xmath25 .",
    "however , note that the dynamo simulation in @xmath26 grids can give us as many as 20202 synthetic magnetic observations of poloidal and toroidal fields .",
    "considering only one observation , as shown in figure 2(b ) , we perform assimilation runs with 16 ensemble members with an observational error of @xmath27 , which means an error of @xmath27 about the ideal magnetic field generated using the true meridional flow speed .",
    "to estimate the prior states of flow - speed , we use equation ( 1 ) , in which we set @xmath28 .",
    "if the meridional flow - speed varies up to @xmath29 ( i.e. @xmath30 for a mean flow - speed of @xmath31 ) during six months , the variation in 15 days can be @xmath32 .",
    "thus we chose @xmath28 so that it is large enough to capture the variation in flow - speed within our selected updating time - step of 15 days and also large enough to avoid ensemble collapse , but not so large as to produce unusual departures from cyclic behavior in a flux - transport dynamo .",
    "we show in figure 3 the reconstructed meridional flow - speed as a function of time ( panel ( a ) ) and the estimates of the observation computed from the flow speed ensemble after data assimilation ( panel ( b ) ) .",
    "we see in figure 3(a ) that the reconstruction is reasonably good except for the time windows between @xmath33 to 18 years and 33 to 35 years during which we find @xmath34 error in the reconstructed flow speed .",
    "observations indicate @xmath35 error in the measurement of meridional flow speed @xcite .",
    "the inset of figure 3(a ) reveals , for an initial guess , far - off from the true - state , the reconstructed states asymptotically converges towards the true - state .",
    "even though they oscillate around the truth with large amplitude , the oscillations damp with time .",
    "figure 3(b ) shows histograms for the normalized distribution of flow - speeds before ( in cyan ) and after ( in magenta ) the analysis stage , along with true - state ( blue ) , for the time instances of 5 , 6.9 , 10.1 and 27.5 years ( marked by vertical lines in figure 3(a ) ) during assimilation . for this case with 16 ensemble members we chose 10 bins for an optimal display .",
    "four time instances are chosen in such a way as to present the following four different phases of reconstructions : ( i ) the distribution of prior and posterior states has small overlap ( top left frame of figure 3(b ) ) , ( ii ) distribution is sharply peaked in one bin each for prior and posterior ( top right frame ) , ( iii ) distribution is broad and has significant overlap ( bottom left frame ) and ( iv ) distribution has no overlap at all ( bottom right frame ) .",
    "however , we can clearly see the successful performance of the enkf which reveals that in all cases the analysis phase brings the posterior distribution ( magenta bars ) closer to true - state ( blue ) .",
    "figure 3(c ) reveals that the assimilated magnetic observation ( blue solid curve ) is well - reproduced when compared with real observation ( red - dashed curve ) .",
    "this is not surprising , because it has already been noted that short - term small fluctuations in flow speed do not significantly influence the overall evolution of global magnetic fields generated by a babcock - leighton dynamo ( see , e.g. @xcite ) .",
    "we also plot the innovation ( @xmath36 ) for this observation ( black curve ) and the cumulative innovation ( orange curve ) .",
    "the innovation at the @xmath37 analysis - step ( @xmath36 ) is defined as the signed difference between real and reconstructed observations , whereas the cumulative innovation ( @xmath38 ) at @xmath37 analysis - step is the normalized sum of norm of innovation vectors over all the previous analysis - steps . @xmath36 and @xmath38 being small ,",
    "both have been ten - fold magnified to superimpose on observations .",
    "we see that , at three different time instances ( @xmath39 , 17 and 27 years ) , the innovation is relatively large ; this is because at @xmath21 the initial guess is far - off from the truth , and at @xmath40 and 27 years there are relatively sharp changes in flow - speed .",
    "the cumulative innovation asymptotes to zero as expected , implying no bias of the system . to investigate the possibility of further improvement in the quality of the enkf reconstruction , we examine the consequences of three important aspects of the enkf : variation in observational error , size of ensemble and number of observations .    we perform convergence tests by estimating the error in the reconstructed state as functions of observational errors , size of ensemble and number of observations .",
    "we define the error as the root mean square of the difference between the reconstructed state and the true - state .",
    "the assimilation interval is chosen to be 15 days in the present case ; denoting every 15 days by the index @xmath41 , the true state and the reconstructed state at the @xmath37 assimilation step by @xmath42 and @xmath43 respectively , we define the error as , @xmath44 , in which @xmath45 is the total number of indices for the 15-days assimilation intervals during the entire time - span of 35 years .",
    "figure 4 shows the rms errors in reconstructed flow speed as functions of observational error ( figure 4(a ) ) , size of ensemble ( figure 4(b ) ) and number of observations ( figure 4(c ) ) .",
    "we see in figure 4 that the error decreases systematically and asymptotes for certain values of the observational errors ( 1% ) , size of ensemble ( 192 members ) and number of observations ( 180 ) . in the case of more than one observation",
    ", we include more poloidal field observations ( synthetic ) from various locations at and near the surface , and more toroidal field observations at and near the bottom of the convection zone .",
    "while we vary observational errors in panel ( a ) , we use @xmath46 observational error in panels ( b ) and ( c ) .",
    "panels ( a , b ) show convergence to typical hyperbolic patterns , as is often seen in numerical convergence tests ( see , e.g. figure 3 of dikpati ( 2012 ) ) . but panel ( c ) shows that the reconstruction can be improved systematically only when there are more than a certain number of observations ( four in our case ) . in all these experiments",
    ", we used the same enkf scheme .",
    "bias or systematic error in an osse reconstruction may arise primarily because of the following assumptions made in the assimilation system : ( i ) the evolution of the ensemble spread is linear , ( ii ) the ensemble is sufficiently large , ( iii ) the forward operators are linear . though these assumptions are roughly valid , they are not strictly true .",
    "but in general , the resulting systematic errors are small unless the assimilation is applied in a large , highly nonlinear system like a numerical weather prediction model .    with the knowledge gained from the convergence experiments shown in figure 4",
    ", we consider a case with 192 ensemble members and 180 magnetic observations , consisting of equal numbers of poloidal and toroidal magnetic fields at various latitude and depth locations .",
    "each of these observations has an observational error of @xmath46 .",
    "we present the reconstructed flow - speed from this assimilation in figure 5 . the reconstructed flow - speed ( red curve )",
    "matches very well with the true state , and thus the true state plotted in blue is essentially hidden behind red and green curves . it is not realistic to expect an observational error of as small as 1% ; figure 5 presents here an illustrative example of one of the best possible reconstructions .",
    "in fact , several additional assimilation runs indicate that the reconstruction is still good if the observational error does not exceed 40% , and reasonably good when 90 out of 180 observations have up to @xmath47 errors .",
    "but the reconstruction fails when all observations have more than 40% error .",
    "what we have demonstrated so far is that the time - dependent amplitude of meridional circulation , having one flow - cell per hemisphere , can be reconstructed by implementing enkf data assimilation with synthetic data . in reality",
    "we do not know from observational data whether they were produced by a dynamo operating with a single - celled flow in each hemisphere , or with a more complex flow profile , or with a combination of complex time - variations in all possible dynamo ingredients . in order to investigate the outcome from this method",
    "when the assumption made about the flow profile is wrong , we carry out an experiment to reconstruct flow - speed assuming a one - cell flow , while using observations of magnetic fields produced from a flow pattern that has two cells in latitude in each hemisphere ( see @xcite for prescription of a two - celled flow ) .",
    "we obtain synthetic data for a case with two flow cells in latitude .",
    "using 192 ensemble members and 180 magnetic observations with 1% error in each of these observations , we estimate the time variation in flow - speed by assuming a single - celled flow , and plot in figure 6(a ) .",
    "we find that the reconstruction is relatively poor , as expected .",
    "however , with a closer look we can see that the reconstructed speed is trying to approach the true - state from a lower value for the first 12 years and from a higher value for the next 13 years .",
    "when the trend in the true - state reverses near the year 27 , the osse has greater difficulty in converging on it .",
    "figure 6(b ) shows the innovation for two typical observations of poloidal fields near the surface , at @xmath25 ( i.e. at low latitude near the equator ) and at @xmath48 ( at high latitude near the pole ) .",
    "much larger innovation at high latitude than at low latitude reflects the fact that the spatial pattern is more erroneous at polar latitudes .",
    "the cummulative innovation ( orange curve ) does no longer asymptote to zero ; this implies bias in the system , due to incorrect assumption of flow - pattern . in the future",
    ", we will extensively explore the reconstruction of spatial pattern of meridional circulation .",
    "we have demonstrated through osses that enkf data assimilation into a babcock - leighton flux - transport dynamo can successfully reconstruct time - varying meridional circulation speed for several cycles from observations of the magnetic field . to obtain the best reconstruction , we have fed the assimilation system of 192 ensemble members with 180 observations with 1% observational error .",
    "however , a reasonably good reconstruction can be obtained when all observations have up to @xmath49 error , or half of the observations have up to @xmath50 errors , but the rest of them have much smaller errors .",
    "@xcite noted that the response time of a babcock - leighton dynamo model to changes in meridional flow is @xmath51 months , so the relatively poor reconstruction with only one observation with 33% observational error and 16 ensemble members can be improved if this information about the dynamo model s response time to flow changes can be exploited .",
    "a forthcoming paper will investigate how to use this response time during assimilation .    throughout this paper , we used an assimilation interval of 15-days .",
    "the reason for this choice is as follows .",
    "recently @xcite have done a very thorough assessment of the predictability of solar flux - transport dynamos .",
    "predictability of a model refers to the time it takes for two solutions that start from slightly different values of either initial conditions or input parameters to diverge from each other to the point that they forecast substantially different outcomes .",
    "@xcite found an @xmath52-folding time of about 30 years .",
    "the flux - transport dynamo model we use here is physically very similar to theirs .",
    "therefore we judge that the @xmath52-folding time for our model will be similar .",
    "it is clear that the time interval for updating the data in our osse s should be much less than the predictability limit of the model , but it should be long compared to the integration time step ( a few hours ) , and consistent with the time scale for changes in axisymmetric solar observations , which is one solar rotation .",
    "it should also be shorter than the `` response time '' of our dynamo model ( @xmath51 months , see @xcite ) to a sudden change in inputs .",
    "we have therefore chosen our updating interval to be 15 days ; we plan to test the sensitivity of assimilation to changes in the updating interval from 15 days to longer ( for instance , 30 days ) and shorter ( @xmath53 days ) .",
    "in this study we have demonstrated what it takes to reconstruct the amplitude variations with time of a one - celled meridional circulation of fixed profile with latitude and radius . in reality",
    "the sun s meridional circulation may not be a one - celled pattern  it may undergo changes both in profile and speed with time .",
    "we have demonstrated that the innovation in observation - forecast can be very large when the assumption about the spatial structure of the flow - pattern is incorrect , and it can be even larger where the departure in assumed spatial pattern from actual pattern in flow is larger .",
    "thus an obvious next step with our data assimilation system would be to attempt to reconstruct the spatio - temporal pattern of meridional flow .",
    "our ultimate goal is to perform assimilation runs from actual observations instead of synthetic data , in cases of reconstruction as well as future predictions . from this study",
    "we can build confidence about the power of enkf data assimilation for reconstructing not only the flow speed but also the profile of meridional circulation in the entire convection zone of the sun in the future .",
    "we thank nancy collins and tim hoar for their invaluable help with assimilation tools and software .",
    "we extend our thanks to two reviewers for many helpful comments and constructive suggestions , which helped significantly improve the paper .",
    "the dart / dynamo assimilation runs have been performed on the yellowstone supercomputer of nwsc / ncar under project number p22104000 , and all assimilation tools used in this work are available to the public from @xmath54 .",
    "this work is partially supported by nasa grant nnx08aq34 g .",
    "dhrubaditya mitra was supported by the european research council under the astrodyn research project no .",
    "227952 and the swedish research council under grant 2011 - 542 and the hao visitor program .",
    "national center for atmospheric research is sponsored by the national science foundation .        , j. l. , wyman , b. , zhang , s. & hoar , t. , assimilation of surface pressure observations using an ensemble filter in an idealized global atmospheric prediction system , j. atmos .",
    ", 62 , 2925 - 2938 , 2005                          , a. , hulot , g. , jault , d. , kuang , w. , tangborn , a. , gillet , n. , canet , e. , aubert , j. & lhuillier , f. , an introduction to data assimilation and predictability in geomagnetism , space sci rev , 155 , 247 - 291 , 2010                                , j. , bogart , r. s. , kosovichev , a. g. , duvall , t. l. , jr . ,",
    "hartlep , h. , detection of equatorward meridional flow and evidence of double - cell meridional circulation inside the sun , apj lett . , 774 , l29 , 1 - 6 , 2013"
  ],
  "abstract_text": [
    "<S> accurate knowledge of time - variation in meridional flow - speed and profile is crucial for estimating a solar cycle s features , which are ultimately responsible for causing space climate variations . </S>",
    "<S> however , no consensus has been reached yet about the sun s meridional circulation pattern observations and theories . by implementing an ensemble kalman filter ( enkf ) data assimilation in a babcock - leighton solar dynamo model using data assimilation research testbed ( dart ) framework </S>",
    "<S> , we find that the best reconstruction of time - variation in meridional flow - speed can be obtained when ten or more observations are used with an updating time of 15 days and a @xmath0 observational error . </S>",
    "<S> increasing ensemble - size from 16 to 160 improves reconstruction . </S>",
    "<S> comparison of reconstructed flow - speed with `` true - state '' reveals that enkf data assimilation is very powerful for reconstructing meridional flow - speeds and suggests that it can be implemented for reconstructing spatio - temporal patterns of meridional circulation . </S>"
  ]
}