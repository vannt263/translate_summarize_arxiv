{
  "article_text": [
    "interest in random lasers with coherent feedback  @xcite and lasers based on chaotic microresonators without mirrors  @xcite revealed a number of shortcomings of conventional laser theory  @xcite that complicated its application to such systems . among the properties that characterize random and chaotic lasers",
    "are strong openness , irregular spatial dependence of the refractive index , and , possibly , nontrivial shape of the resonator .",
    "lasing in these systems can be accompanied by strong coupling between the modes , which requires a more careful treatment of nonlinear effects than is necessary for regular lasers .",
    "an essential part of a laser description is the choice of an appropriate basis of normal modes in which electromagnetic field and other system functions can be expanded . in an open system",
    "it is not possible to define a hermitian eigenvalue problem whose eigenfunctions would form an orthogonal basis . instead , one has to introduce a biorthogonal system of so called quasimodes as left and right eigenfunctions of a non - hermitian operator .",
    "a number of methods to construct quasimodes were discussed in the literature . among the earliest",
    "are the fox - li modes  @xcite which are useful in resonators with a preferred propagation direction and clearly defined transverse plane . in a more general setting",
    ", there were attempts to use solutions of the wave equation satisfying outgoing boundary conditions at infinity ( siegert - gamow boundary conditions ) , with complex eigenfrequencies corresponding to scattering resonances  @xcite .",
    "however , these modes diverge at infinity , which makes it problematic to use them as a basis  @xcite , while some ways around this problem have been discussed in refs .  @xcite .",
    "another possibility is to use the so called system - and - bath type approaches  @xcite , where cavities are described by an orthogonal system of wavefunctions of a hermitian problem with an independent sets of modes introduced for outside of the resonator .",
    "the openness of the cavity in this approach is reproduced by introducing coupling between discrete set of inside modes and the continuous spectrum of outside modes .",
    "this way , the modal expansion of the field becomes possible both inside and outside of the cavity .    in the present work we use a different approach based on keeping the spectral parameter of the outside outgoing field real , while making inside field to satisfy continuity conditions at the boundary of the cavity",
    "this approach also results in the discrete spectrum of the cavity field with complex - valued frequencies , but , since the outside field is forced to depend on real spectral parameter , it does not diverge and is characterized by a constant flux .",
    "this approach was used in ref .",
    "@xcite for special kind of vibration problems and was adapted for lasers in ref .",
    "@xcite , where respective modes were dubbed the `` constant - flux '' ( cf ) modes .",
    "one can introduce two adjoint biorthogonal systems of cf modes , which can be used to represent field inside the cavity .    in the standard semiclassical laser theory  @xcite",
    "lasing modes are usually taken to coincide with quasimodes of the respective cavities , while their amplitudes and frequencies are found from equations based on perturbation expansions containing terms linear and cubic in the field . in random lasers",
    "this picture needs to be revised .",
    "first , it was shown  @xcite that normal modes in the presence of gain differ from the passive modes even in the linear approximation if the refractive index and/or unsaturated population inversion are nonuniform .",
    "second , it was realized  @xcite that self- and cross - saturation coefficients before the cubic terms can have different statistical properties in different systems , leading to different mode statistics . finally , it was pointed out  @xcite that nonlinear effects can significantly contribute to modification of the lasing modes compared to those of the empty cavity . a theory suggested in refs .",
    "@xcite allowed for self - consistent calculations of not only lasing frequencies but also of the spatial distributions of the respective modes . neglecting pulsations of the population inversion the authors of refs .",
    "@xcite were able to derive equations for field amplitudes and frequencies beyond the usual third - order approximation .    in the present work we also generalize the conventional laser theory , but , unlike the approach of refs .",
    "@xcite , we do not begin by introducing a special approximation for population inversion . instead",
    ", we carry out the perturbation expansion up to the infinite order in the field keeping all the terms which do not have fast temporal oscillations .",
    "this also includes a part of population - pulsation contributions which is consistent with the slowly - varying - envelope approximation .",
    "the classification of the resulting terms becomes possible due to a special diagram technique developed to represent the terms of the expansion .",
    "this technique , however , differs significantly from usual feynman diagrams widely used in solid state and high - energy physics , because we have to deal with terms of ever increasing degree of nonlinearity .",
    "thus , diagrams in our technique are not used to literally represent each term of the expansion , but play a more limited role , as a tool assisting in the classification of the terms .",
    "nevertheless , this technique allows for standard division of diagrams into connected and disconnected , with disconnected diagrams submitting to easy resummation in terms of only connected ones .",
    "the connected diagrams can be classified according to the order of magnitude of the population pulsations .",
    "the resulting laser equations generalize the nonlinear equations of refs .",
    "@xcite in two respects .",
    "first , equations derived in this paper are dynamic , allowing for studying time dependence of the amplitudes , while the equations of refs .",
    "@xcite can only describe stationary lasing output .",
    "second , our equations incorporate terms responsible for the population - pulsation contribution in all orders of the perturbation theory ; the equations of refs .",
    "@xcite are reproduced in our approach if only the lowest - order diagram is taken into account .",
    "the structure of our paper is as follows . in sec .",
    "[ sec : qm ] we recall the definition and properties of the constant - flux quasimodes of open system .",
    "standard semiclassical laser equations are written in sec .",
    "[ sec : sle ] in frequency representation for later convenience . coupled equations for electric field , polarization , and population inversion are reduced to equations for the field alone in sec .  [",
    "sec : all ] using infinite - order perturbation theory . in sec .",
    "[ sec : dt ] we formulate the diagrammatic technique and resum the perturbation expansion in terms of connected diagrams . in sec .",
    "[ sec : lim ] we reproduce the results of linear theory , third - order theory with population - pulsation terms , and all - order nonlinear theory in the constant - inversion approximation .",
    "finally , we write corrections to the all - order theory that are of the first order in the population pulsations .",
    "we consider an open system defined by real dielectric constant  @xmath0 , with @xmath1 outside of the system s boundary . in the coulomb gauge @xmath2 = 0 $ ] , an electric field @xmath3",
    "is governed by the wave equation @xmath4 where gaussian units with the velocity of light in vacuum @xmath5 are used .    in the absence of gain and absorption",
    "the field will decay in time due to the openness .",
    "it is convenient to represent the decaying field as a superposition of certain normal modes , the quasimodes , that have only outgoing components outside the system .",
    "these modes can be constructed as families of constant - flux ( cf ) states  @xcite @xmath6 depending on a real continuous parameter  @xmath7 .",
    "explicitly , the cf modes satisfy the differential equation @xmath8 = \\omega^2\\ , { \\boldsymbol}\\psi_k ( \\omega ) \\label{cfout}\\ ] ] in the exterior of the cavity with the outgoing - wave boundary conditions at infinity . inside the system",
    ", the same state satisfies a different equation : @xmath9 =    \\omega_k^2 ( \\omega)\\ , { \\boldsymbol}\\psi_k ( \\omega).\\ ] ] for each @xmath7 , the complex eigenfrequency @xmath10 is quantized , as the eigenfunctions are required to match smoothly at the interface .",
    "conjugate wavefunctions @xmath11 obey eq .",
    "( [ cfout ] ) outside with the incoming - wave boundary conditions and the equation @xmath12 =    [ \\omega_k^2 ( \\omega)]^*\\ , { \\boldsymbol}\\phi_k ( \\omega).\\ ] ] inside the system .",
    "the cf functions and their conjugates are biorthogonal and can be chosen to satisfy the condition @xmath13 where the integration is over the interior  @xmath14 .    a fourier component @xmath15 of the internal field can be expanded in the cf modes  as @xmath16 when continued to the exterior , this expansion yields a wave at the frequency  @xmath7 propagating in the free space away from the system . in a stationary lasing regime @xmath7 becomes subjected to an equation , which has a discrete set of solutions corresponding to the frequencies of lasing modes .",
    "in the semiclassical theory of lasers  @xcite the fields are described classically at the level of maxwell equations and the active medium is treated by quantum mechanics . to this end",
    ", the wave equation  ( [ weqpas ] ) is written with a source term , the polarization @xmath17 of the gain medium : @xmath18 in the simplest model , the active medium is a collection of homogeneously broadened two - level atoms .",
    "their state is fully described by  @xmath19 and the population - inversion density  @xmath20 ( difference between populations of the upper and lower levels per unit volume ) .",
    "these functions satisfy the equations of motion  @xcite @xmath21 = \\frac 2 { \\hbar \\nu } { \\mathbf}e ( { \\mathbf}r , t ) \\cdot \\frac { \\partial}{{\\partial}t }    { \\mathbf}p ( { \\mathbf}r , t ) . \\label{inveq }   \\end{aligned}\\ ] ] where @xmath22  is the magnitude of the atomic dipole matrix element , @xmath23  is the atomic transition frequency , and @xmath24 ( @xmath25 )  is the polarization ( population - inversion ) decay rate . if the right - hand side of eq .",
    "( [ inveq ] ) vanishes , @xmath26  relaxes to the unsaturated population inversion  @xmath27 , which is a measure of the pump strength .",
    "the coupled equations  ( [ weqact])-([inveq ] ) determine , in principle , electric field in the system , if @xmath27 is given .",
    "it is convenient , at this stage , to rewrite the equations of motion in the frequency representation .",
    "the fourier - transformed variables are given in the form @xmath28 that facilitates application of the rotating - wave approximation .",
    "additionally , we assume that @xmath29 and @xmath30 are negligible outside of a small vicinity of  @xmath23 .",
    "then the frequency squared can be approximated as @xmath31 and the lasing equations become effectively the first - order differential equations in time , @xmath32 { \\mathbf}p_\\omega = - i \\frac    { d^2 } { 2 \\pi \\hbar } \\int_0^\\infty d \\omega'\\ , { \\mathbf}e_{\\omega ' } \\delta    n_{\\omega - \\omega ' } , \\label{poleqft}\\\\    & ( -i \\omega + \\gamma_\\parallel ) \\delta n_\\omega =   2 \\pi \\gamma_\\parallel    \\delta n_0 ( { \\mathbf}r)\\ , \\delta ( \\omega ) \\notag \\\\    & \\quad - \\frac i { \\pi \\hbar } \\int_0^\\infty    d \\omega ' ( { \\mathbf}e_{\\omega ' - \\omega}^ * \\cdot { \\mathbf}p_{\\omega ' } - { \\mathbf}e_{\\omega ' + \\omega } \\cdot { \\mathbf}p_{\\omega'}^ * ) , \\label{inveqft }   \\end{aligned}\\ ] ] where the pump @xmath33 is assumed constant in time .",
    "equations ( [ weqactft])-([inveqft ] ) can be reduced to an equation for the electric field alone using perturbation theory in the field amplitude . in particular , one needs to construct an expansion of @xmath34 in the ( odd ) powers of the field using eqs .",
    "( [ poleqft ] ) and  ( [ inveqft ] ) .",
    "then this expansion is substituted in eq .",
    "( [ weqactft ] ) producing the required equation for the field . in the conventional laser theory  @xcite @xmath34",
    "is expanded up to the third order in  @xmath35 , which yields the saturation terms in the rate equations . in this paper",
    "we will carry out the expansion up to an arbitrary order in the field s amplitude and use diagrammatic method to sort out the respective terms .",
    "we begin by neglecting the quadratic terms in eq .",
    "( [ inveqft ] ) which gives the zero - order expression for the population inversion : @xmath36 .",
    "substituting this expression in the polarization eq .",
    "( [ poleqft ] ) , we obtain the first - order term for polarization @xmath37 , where @xmath38^{-1}.\\ ] ] this expression is substituted back in eq .",
    "( [ inveqft ] ) , from which the second - order correction to the inversion @xmath39 is determined .",
    "this iteration procedure yields the perturbation series for polarization and population inversion , @xmath40 in odd and even powers of the electric field , respectively .",
    "henceforth we restrict the calculations to the case of scalar field .",
    "the general terms of these expansions are derived by induction in appendix  [ deriv ] .",
    "the resulting expressions are    @xmath41 [ d(\\omega_1 - \\omega_2 + \\omega_3 ) +    d^*(\\omega_2 - \\omega_1 + \\omega_4 ) ] \\cdots \\notag \\\\    & \\times [ d(\\omega_1 - \\omega_2 + \\omega_3 - \\cdots - \\omega_{q - 3 } +    \\omega_{q - 2 } ) + d^*(\\omega_2 - \\omega_1 + \\omega_4 - \\cdots - \\omega_{q -    4 } + \\omega_{q - 1 } ) ] , \\label{pq }   \\end{aligned}\\ ] ] @xmath42 [ d(\\omega_1 - \\omega_2 +    \\omega_3 ) + d^*(\\omega_2 - \\omega_1 + \\omega_4 ) ] \\cdots \\notag \\\\    & \\times [ d(\\omega_1 - \\omega_2 + \\omega_3 - \\cdots - \\omega_{q - 3 } +    \\omega_{q - 2 } )   +   d^*(\\omega_2 - \\omega_1 + \\omega_4 - \\cdots - \\omega_{q -    4 } + \\omega_{q - 1 } ) ] \\notag \\\\    & \\times d(\\omega_1 - \\omega_2 + \\omega_3 - \\cdots - \\omega_{q - 1 } +    \\omega_q ) + \\text{c.c.}(\\omega \\to -\\omega ) , \\label{nq }   \\end{aligned}\\ ] ]    where @xmath43 is odd .",
    "the notation @xmath44 stands for the first part of the equation to which complex conjugation accompanied by change of the sign of  @xmath7 was applied .",
    "we also introduced the following definitions @xmath45^{-1}.",
    "\\end{aligned}\\ ] ] the above expressions describe nonlinear ( @xmath46 ) corrections to polarization and population inversion , which are used below to obtain equations for the field amplitudes .      equation for the amplitudes  ( [ normamp ] ) of normal modes , @xmath47 a_k ( \\omega ) = 2 \\pi \\nu \\int_{{\\mathcal}i } d { \\mathbf}r\\ ,    \\epsilon^{-1/2 } ( { \\mathbf}r)\\ , \\phi_k^ * ( { \\mathbf}r , \\omega)\\ , p_\\omega ( { \\mathbf}r ) , \\label{eomnorm}\\ ] ] follows from eq .",
    "( [ weqactft ] ) and biorthogonality condition  ( [ biorth ] ) .",
    "the right - hand side is a sum of the infinite number of nonlinear corrections to the polarization and is , therefore , a functional of _ all _ amplitudes  @xmath48 . by definition ,",
    "a lasing mode is such a solution which , in the limit @xmath49 , approaches a purely harmonic form , @xmath50 . here @xmath51 is some frequency , which is determined self - consistently from eq .",
    "( [ eomnorm ] ) . in the frequency domain",
    "these solutions are characterized by delta - functional frequency dependence @xmath52 .    generally speaking ,",
    "lasing modes are different from the quasimodes of the passive system . indeed , an attempt to search for the solutions of eq .",
    "( [ eomnorm ] ) in the form @xmath53 leads , after the frequency integration  ( [ pq ] ) , to the equation @xmath54\\ , a_k\\ , \\delta ( \\omega - \\omega_k ) \\notag    \\\\    = & \\sum_{q \\text { odd}}\\ : \\sum _ { k_1 , \\ldots , k_q }   w_{k , k_1 , \\ldots ,    k_q}^{(q ) } a_{k_1 } a_{k_2}^ * \\cdots a_{k_{q-1}}^*a_{k_q}\\notag \\\\    & \\times   \\delta ( \\omega   - \\omega_{k_1 } + \\omega_{k_2 } - \\cdots +    \\omega_{k_{q-1 } } - \\omega_{k_q}),\\label{eqomnonres }   \\end{aligned}\\ ] ] where the coefficients @xmath55 are functions of the frequencies @xmath56 .",
    "clearly , most of the terms on the right - hand side contain the delta functions that are different from @xmath57 on the left - hand side . in the time domain",
    ", these terms would introduce oscillations with frequencies different from  @xmath51 .",
    "this means that , in general , no stationary lasing solutions exist unless , for some reasons , the terms oscillating at the `` beat '' frequencies are small and can be neglected .",
    "usually the selection of the slowly changing contributions to eq .",
    "( [ eqomnonres ] ) is done by leaving only terms with pairwise coinciding indices  @xmath58 , so that the respective frequency differences cancel out ( more on this procedure can be found below ) .",
    "however , since the number of @xmath59 in this equation is odd , one will always remain with the expression @xmath60 , where @xmath61 is the index of one of the remaining uncanceled frequencies .",
    "this problem can only be resolved by requiring that , in a given lasing mode , @xmath62 , each contribution @xmath63 of the quasimode  @xmath64 oscillates at the same frequency , and the general solution for @xmath65 takes the form  of @xmath66 amplitudes @xmath63 can be shown to obey the equation @xmath67\\ , a_{lk }   =    \\sum_{k^\\prime } v_{kk^\\prime}^{(l ) } \\ , a_{lk^\\prime } , \\label{eigenvalue}\\ ] ] where the coefficients  @xmath68 depend on all frequencies and amplitudes .",
    "an explicit expression for @xmath68 is given below .",
    "one can see from this equation that the lasing modes are those combinations of the quasimodes that diagonalize the matrix @xmath68 , while lasing frequencies are real eigenvalues of this matrix  @xcite .",
    "one has to realize , though , that eq .",
    "( [ eigenvalue ] ) is not an ordinary eigenvalue problem , since the matrix @xmath68 itself depends on the amplitudes  @xmath63 . unlike linear eigenvalue problems , that determine frequencies for which nonzero solutions for the amplitudes can exist , solving eq .",
    "( [ eigenvalue ] ) one must be able to find the frequencies , as well as the field amplitudes .",
    "this is possible , because the requirement that the respective eigenfrequencies must be real provides an additional constraint on solutions of eq .",
    "( [ eigenvalue ] )  @xcite .",
    "if matrix @xmath68 is calculated in the constant - inversion approximation ( see below ) , eq .",
    "( [ eigenvalue ] ) reproduces the main result of ref .",
    "however , while the derivation of this equation in ref .",
    "@xcite is only valid in the strictly stationary limit , the arguments presented here can be extended to a nonstationary case .",
    "indeed , we can repeat the above arguments for a weakly nonstationary situation , requiring that the amplitudes @xmath63 be slowly changing functions of time .",
    "formally , we replace the mode expansion  ( [ modexp ] ) with @xmath69 , where @xmath70 is assumed to be sharply peaked at @xmath71 . in this case",
    "we can transform eq .",
    "( [ eomnorm ] ) to the time domain by expanding @xmath10 as @xmath72 , where @xmath73 is the derivative of @xmath74 with respect to the spectral parameter  @xmath7 .",
    "it was found in ref .",
    "@xcite that , at least in the case of modes of a disk resonator , this derivative is not small and must be taken into account .",
    "in nonlinear terms we simply replace @xmath75 , which amounts to neglect of time derivatives of the nonlinear corrections . the resulting equation  is @xmath76\\frac d { dt } +   [ \\omega_k    ( \\omega_l ) - \\omega_l ] { \\right}\\ } a_{lk } ( t ) \\\\    = \\sum_{k ' } v_{kk'}^{(l ) } ( t)\\ , a_{lk'}(t ) , \\label{eomlas }   \\end{gathered}\\ ] ] which , in the stationary limit , coincides with eq .",
    "( [ eigenvalue ] ) .",
    "note that @xmath68 is now a slowly varying function of time via its dependence on the amplitudes  @xmath77 .",
    "the correction due to @xmath78 is a new term , which has not been discussed in any of the previous treatments of lasing dynamics .",
    "while it does not affect the steady - state solutions , it might change their stability , and is , therefore , important for strongly open cavities .",
    "more detailed study of its role is outside of the scope of this paper and will be presented elsewhere .",
    "the polarization matrix @xmath68 in the slowly varying amplitude approximation can be presented  as @xmath79 where we introduced the nonlinear susceptibility @xmath80 defined as the ratio of the slowly varying polarization amplitude @xmath81 and the field @xmath82 in the mode  @xmath62 .",
    "the expression for the susceptibility is found from perturbation expansion for polarization @xmath83 , eqs .",
    "( [ psum ] ) and  ( [ pq ] ) , and is given  by    @xmath84 [ d(\\omega_{l_1 } - \\omega_{l_2 }    + \\omega_{l_3 } ) + d^*(\\omega_{l_2 } - \\omega_{l_1 } + \\omega_{l_4 } ) ] \\cdots    \\notag \\\\    & \\times [ d(\\omega_{l_1 } - \\omega_{l_2 } + \\omega_{l_3 } - \\cdots - \\omega_{l_{q    - 3 } } + \\omega_{l_{q - 2 } } ) + d^*(\\omega_{l_2 } - \\omega_{l_1 } + \\omega_{l_4 }    - \\cdots - \\omega_{l_{q - 4 } } + \\omega_{l_{q - 1 } } ) ] .",
    "\\label{pl } \\end{aligned}\\ ] ]    here the order of nonlinearity @xmath43 , introduced in eq .",
    "( [ psum ] ) , determines the number of different indices @xmath85 , which take values from @xmath86 to  @xmath87 , where @xmath87 is the number of lasing modes .",
    "the superscript  `` r '' at the sum symbol specifies that the possible values of the indices are restricted by the resonance condition @xmath88 which ensures cancelation of fast oscillating terms . in the absence of accidental degeneracies",
    ", this condition implies that each of the indices @xmath89 must be equal to one of the indices @xmath90 .",
    "this leads , in particular , to the appearance of absolute squares of the field in the first line of eq .",
    ". moreover , the index @xmath91 effectively drops out of the equation , since the amplitude @xmath92 must be equal to some other amplitude  @xmath93 .",
    "it is assumed that the slowly varying field amplitudes are expressed in terms of quasimode components @xmath94 of the respective @xmath62th lasing mode using @xmath95 substituting eqs .",
    "( [ pl ] ) and  ( [ vkk ] ) in eq .",
    "( [ eomlas ] ) one obtains a closed system of dynamic equations for @xmath63 valid to all orders in the field amplitude .",
    "one of the fundamental difficulties of the theory of lasers is that the number  @xmath87 of lasing modes is a priori unknown and depends on the strength of the pumping and the spatial distribution of the electric field in the cavity . in ref .",
    "@xcite this value is determined by the number of possible solutions of eq .",
    "( [ eigenvalue ] ) with real frequencies at a given pumping strength .",
    "this approach , however , does not take into account stability of the found solutions , which can only be determined by considering the time - dependent eq .",
    "( [ eomlas ] ) . using this equation",
    "one could start by assuming that @xmath87 is equal to the size of the basis of quasimodes , @xmath96 , and study their time evolution .",
    "those @xmath97 which do not correspond to real lasing solutions at given pumping would decay to zero , and the number of lasing modes would be determined a posteriori without the need for a prior knowledge of  @xmath87 .",
    "this approach is not free of difficulties either , because of possible multistable behavior and hysteresis .",
    "analysis of these issues , however , is beyond the scope of this paper .",
    "in this subsection we present a diagrammatic technique developed to classify different nonlinear terms in eq .",
    ". it should be noted , however , that our diagrams , unlike diagrams of the field or many - particle theory , do not provide one - to - one correspondence between different terms of eq .",
    "( [ pl ] ) and elements of the diagrams .",
    "the role of the diagrams here is more limited : we use them to classify different pairing possibilities for the lasing mode indices @xmath98 in the perturbation series  ( [ pl ] ) .",
    "nevertheless , as it is shown below , this technique allows for classification and partial summation of the classes of the terms in a manner very similar to traditional diagrammatic methods . unlike pairing of vertices in traditional diagrammatic techniques , which reflects vick s theorem for creation - annihilation operators or gaussian statistics of respective random processes , the pairing procedure in the situation under consideration hinges upon the condition expressed by eq .",
    "( [ res ] ) .",
    "the resonance condition guarantees the absence of the fast oscillating terms , and , hence , the validity of the slowly changing amplitude approximation .    to construct a diagram @xmath99 of order @xmath100 , we place @xmath101 vertices in two columns as shown in fig .  [ labels_fig ] .",
    "the left vertices are labeled @xmath102 and the right vertices are labeled @xmath103 .",
    "the vertex @xmath62 is different from the other vertices , because there is no summation over the index @xmath62 in eq .",
    "( [ pl ] ) . after that",
    ", each vertex on the left is connected with exactly one vertex on the right .",
    "the index @xmath104 labels all distinct connection possibilities in an arbitrary order . to obtain all diagrams of order  @xmath43 , we can",
    ", first , connect the vertices by @xmath105 horizontal links and then reshuffle the vertices , say , on the left without cutting the links .",
    "thus , the number of possible diagrams of order  @xmath43 is the number of permutations @xmath106!$ ] .",
    "diagrams for @xmath107 are shown in figs .",
    "[ diag_1_3_fig ] and  [ diag_5_cut_fig ] .",
    "each diagram specifies a particular contribution to the series  ( [ pl ] ) .",
    "the latter will be written in the form @xmath108 where each @xmath99 represents a partial sum in @xmath109 , eq .",
    "( [ pl ] ) , in which pairs of indices are chosen to be equal to each other according to the links connecting respective vertices in the diagram .",
    "for example , the first three diagrams correspond to the following expressions : @xmath110 , \\label{x310}\\\\    { \\widetilde}x_{32}^0 = & \\sum_{l_2 } |e_{l_2 } ( { \\mathbf}r , t)|^2\\ , 2 \\text{re }    [ d(\\omega_{l_2 } ) ] .",
    "\\end{aligned}\\ ] ] the restriction @xmath111 in the diagram @xmath112 excludes the term with @xmath113 , which enters  @xmath114 . in general , the terms with more than two indices equal belong to the diagram in which the links connecting these indices do not cross each other .",
    "another example are the fifth - order terms with @xmath115 , which enter @xmath116 , but not  @xmath117 .",
    "expression for arbitrary @xmath99 is given in appendix  [ genexpr ] .",
    "a diagram is called connected if it can not be cut by a horizontal line without cutting a link .",
    "for instance , the diagrams @xmath112 , @xmath117 , @xmath116 , and @xmath118 are connected , while the diagrams @xmath114 , @xmath119 , @xmath120 , and @xmath121 are disconnected . to simplify the notation , we ordered all connected diagrams before the disconnected diagrams for given  @xmath43 .",
    "we will label connected diagrams as @xmath122 with @xmath123 where @xmath124 ( @xmath125 ) is the number of connected diagrams .",
    "the horizontal cuts separate disconnected diagrams into one connected diagram containing the vertex  @xmath62 ( denoted by an unfilled dot in the graphic representation ) and several connected subdiagrams without such vertex .",
    "the latter subdiagrams will be denoted as @xmath126 , @xmath127 , where @xmath128 is the number of vertices in the subdiagram . in place of the vertex  @xmath62 these diagrams have a vertex with the index @xmath129 which runs over all lasing modes , as the other indices  @xmath130 . for example , the diagram @xmath120 consists of @xmath131 and @xmath132 and the diagram @xmath121 consists of @xmath131 and two diagrams @xmath133 , where @xmath134 ,    \\\\    & x_{31 } = \\sum_{\\mbox{\\scriptsize    $ \\begin{array}{c }      l_2 , l_4 \\\\      l_2 \\ne l_4    \\end{array}$    } } |e_{l_2 } ( { \\mathbf}r , t)|^2    |e_{l_4 } ( { \\mathbf}r , t)|^2 \\notag \\\\    & \\phantom{x_{31 } = } \\times d_\\parallel ( \\omega_{l_4 } - \\omega_{l_2 } )    [ d(\\omega_{l_4 } ) + d^*(\\omega_{l_2})]^2 . \\label{x31 }   \\end{aligned}\\ ] ] a general expression for @xmath126 is given in appendix  [ genexpr ] .",
    "note that @xmath126 is of the order @xmath101 in the electric field .",
    "connected diagrams contain @xmath135 nontrivial factors @xmath136 .",
    "our diagrammatic technique possesses the basic property that disconnected diagrams are given by products of their connected parts .",
    "thus , we can write for our examples @xmath137 the multiplicativity is due to the fact that the resonance condition of the type  ( [ res ] ) is fulfilled for each connected subdiagram ( see also appendix  [ genexpr ] ) .",
    "the multiplicativity property allows to express the series  ( [ diagser ] ) in terms of the connected diagrams  as @xmath138 this resummation formula is the main result of our paper .",
    "to make the meaning of eq .",
    "( [ resum ] ) more transparent we apply it in several well - known special cases .",
    "we start with the linear approximation in sec .",
    "[ lin ] and consider the effect of gain - induced coupling of passive modes  @xcite . in sec .  [ third ]",
    "we reproduce semiclassical equations of the standard third - order laser theory  @xcite . in sec .",
    "[ const ] we discuss all - order nonlinear theory in the approximation of constant population inversion  @xcite and derive , using our theory , the first diagrammatic correction to  it .      in the linear approximation to the polarization @xmath139 [ eq .  ( [ pl ] ) ]",
    "only the lowest diagram  @xmath131 contributes to  @xmath140 .",
    "equation  ( [ eomlas ] ) , where the matrix @xmath68 is calculated using eqs .",
    "( [ vkk ] ) , ( [ pldiag ] ) , and  ( [ x110 ] ) , yields the following equations for the slowly - varying amplitudes : @xmath141 { \\right}\\ } a_{lk ' } = 0 , \\label{lineq}\\ ] ] where the @xmath142 term is henceforth neglected .",
    "the frequency matrix @xmath143 is modified by the linear gain term , @xmath144 proportional to the overlap integral . clearly , the matrices @xmath145 and  @xmath146 are nondiagonal if the pump or dielectric constant are not homogeneous . in this case",
    "the biorthogonal quasimodes of the system @xmath147 and  @xmath148 are no longer @xmath149 and  @xmath150 , but are determined by the right and left eigenvectors  @xmath151 of  @xmath146 according  to @xmath152 the right eigenvectors @xmath153 are normal modes of eq .",
    "( [ lineq ] ) whose amplitudes  @xmath154 obey the equation @xmath155 { \\overline}a_l    = 0 , \\label{newmod}\\ ] ] where @xmath156 are eigenvalues of  @xmath157 .",
    "we recall that electric field in the mode  @xmath62 has a time dependence @xmath158 .",
    "thus , the lasing frequency  @xmath159 is determined from the requirement @xmath160 = \\omega_l\\ ] ] and the threshold condition for this mode  is @xmath161 = 0.\\ ] ] as follows from eq .",
    "( [ newmod ] ) , the mode amplitudes diverge exponentially above the threshold . hence",
    ", applicability of the linear approximation is limited to the pump strength below or at the threshold .",
    "however , the basis of normal modes can be used as a starting point in nonlinear theories .      to obtain an approximation to @xmath140 of the third - order in the field , we keep the diagrams @xmath131 and @xmath162 in the numerator and the diagram @xmath133 in the denominator of eq .",
    "( [ resum ] ) and expand the latter : @xmath163 it is convenient to write lasing equations in the basis of quasimodes @xmath147 and  @xmath148 that diagonalize the linear part .",
    "due to nonlinear effects , the lasing modes above the threshold , @xmath164 are , in general , linear combinations of individual quasimodes . equation for the amplitudes @xmath165 follows from eq .",
    "( [ eomlas ] ) , after taking into account the results of linear theory ( sec .  [ lin ] ) , and has the form :    @xmath166 { \\overline}a_{lk } = - \\frac { \\pi \\nu } { \\hbar \\gamma_\\parallel } { \\left } ( \\frac { d^2 } { \\hbar    \\gamma_\\perp } { \\right})^2 d(\\omega_l ) \\int_{{\\mathcal}i } d { \\mathbf}r \\frac { \\delta n_0 ( { \\mathbf}r ) } { \\sqrt { \\epsilon({\\mathbf}r ) } } \\ , { \\overline}\\phi_k^ * ( { \\mathbf}r , \\omega_l)\\ , e_l    ( { \\mathbf}r , t )   \\notag \\\\    & \\times \\sum_{l ' = 1}^{n_{\\text m } } |e_{l ' } ( { \\mathbf}r , t)|^2 { \\left}\\ { 2 \\text{re }    [ d(\\omega_{l ' } ) ] + ( 1    - \\delta_{ll ' } ) d_\\parallel ( \\omega_l - \\omega_{l'})\\ , [ d(\\omega_l ) +    d^*(\\omega_{l ' } ) ] { \\right}\\ } , \\quad k = 1 , \\ldots , n_{\\text b } , \\label{leq3ord }   \\end{aligned}\\ ] ]    where @xmath167 is the size of the basis of quasimodes and @xmath87 is the number of lasing modes . the lasing frequencies  @xmath159 and the mode thresholds need to be determined from these @xmath168 equations in the stationary regime @xmath169 using , e.g. , a selfconsistent procedure described in ref .  @xcite .    in some cases the standard assumption of a traditional lasing theory that the lasing modes coincide with the quasimodes of the cavity remain valid .",
    "in this case the total number of equations  ( [ leq3ord ] ) is reduced to  @xmath96 since the amplitudes are approximated as @xmath170 .",
    "representing @xmath171 and separating the real and imaginary parts in eq .",
    "( [ leq3ord ] ) , we obtain @xmath172 real equations for the intensities  @xmath173 and phases  @xmath174 , @xmath175\\ , i_l \\notag \\\\    & = - \\frac { 2 \\pi \\nu } { \\hbar \\gamma_\\parallel } { \\left } ( \\frac { d^2 } { \\hbar    \\gamma_\\perp } { \\right})^2 i_l\\ , \\text{re } { \\left}[d(\\omega_l ) \\sum_{l ' } b_{ll ' }    i_{l ' }   \\ { \\cdots \\ } { \\right } ] , \\label{ratei}\\\\    & \\dot{{\\overline}\\varphi}_l + \\text{re } [ { \\overline}\\omega_l ( \\omega_l ) ] - \\omega_l    \\notag \\\\    & = - \\frac { \\pi \\nu } { \\hbar \\gamma_\\parallel } { \\left } ( \\frac { d^2 } { \\hbar    \\gamma_\\perp } { \\right})^2 \\text{im } { \\left}[d(\\omega_l ) \\sum_{l ' } b_{ll ' }    i_{l ' }   \\ { \\cdots \\ } { \\right } ] , \\label{rateom }   \\end{aligned}\\ ] ] the terms enclosed in the braces are the same as those in eq .",
    "( [ leq3ord ] ) .",
    "we defined overlap integrals for the quasimodes  as @xmath176 ^ 2 } \\ , { \\overline}\\phi_l^ * ( { \\mathbf}r , \\omega_l)\\ ,    { \\overline}\\psi_l ( { \\mathbf}r , \\omega_l)\\ , |{\\overline}\\psi_{l'}|^2.\\ ] ] the lasing frequencies @xmath159 are determined , together with the stationary intensities , from eqs .  ( [ ratei ] ) and  ( [ rateom ] ) in the stationary regime @xmath177 and @xmath178 . the rate equations  ( [ ratei ] ) and frequency equations  ( [ rateom ] ) generalize the standard third - order semiclassical theory with the self- and cross - saturation terms  @xcite to systems with strong openness and arbitrary distribution of refractive index .      in many physical situations",
    "the population inversion @xmath179 is approximately constant in time .",
    "oscillations of the population ( population pulsations ) are responsible for the terms proportional to @xmath180 , @xmath181 , in the expansion of the nonlinear susceptibility  ( [ pl ] ) and , hence , in the expressions for the diagrams . comparing the terms in the braces in eq .",
    "( [ leq3ord ] ) , we can conclude that the population pulsations can be neglected if @xmath182 , i.e. , @xmath183 for all lasing frequencies @xmath184 .    in the approximation of constant inversion only the diagrams @xmath131 and @xmath133 , which do not contain the @xmath185 functions , contribute to @xmath140  ( [ resum ] ) .",
    "equation  ( [ eomlas ] ) for the coefficients of expansion  ( [ eexpst ] ) of the electric field becomes @xmath186 a_{lk }    = 2 \\pi \\nu \\frac { d^2 } { \\hbar \\gamma_\\perp } \\int_{{\\mathcal}i } d { \\mathbf}r    \\frac { \\delta n_0 ( { \\mathbf}r ) } { \\sqrt { \\epsilon({\\mathbf}r ) } }   \\\\    \\times \\frac { \\phi_k^ *    ( { \\mathbf}r , \\omega_l)\\ , e_l ( { \\mathbf}r , t ) } { 1 + \\frac { d^2 } { 2 \\hbar^2    \\gamma_\\perp \\gamma_\\parallel } \\sum_{l ' } |e_{l ' } ( { \\mathbf}r , t)|^2 2 \\text{re }    [ d(\\omega_{l ' } ) ] } . \\label{constpop }   \\end{gathered}\\ ] ] in contrast to eq .",
    "( [ leq3ord ] ) , the linear contribution here is not diagonalized and is contained in the right - hand side .",
    "equation  ( [ constpop ] ) is valid in all orders in nonlinearity if the population inversion is constant . with the help of eq .",
    "( [ resum ] ) it is straightforward to write out the corrections due to the population pulsations .",
    "the terms of the first order in @xmath187 are contained in the diagrams @xmath162 and  @xmath132 [ eqs .",
    "( [ x310 ] ) and  ( [ x31 ] ) ] , so that @xmath140 can be approximated  as @xmath188 these corrections modify both the numerator and denominator of eq .",
    "( [ constpop ] ) , which can now be presented  as @xmath186 a_{lk }    = 2 \\pi \\nu \\frac { d^2 } { \\hbar \\gamma_\\perp } \\int_{{\\mathcal}i } d { \\mathbf}r    \\frac { \\delta n_0 ( { \\mathbf}r ) } { \\sqrt { \\epsilon({\\mathbf}r ) } }   \\\\",
    "\\times \\frac { \\phi_k^ * ( { \\mathbf}r , \\omega_l)\\ , e_l ( { \\mathbf}r ,    t){\\left}(1-\\upsilon_{\\text",
    "n } { \\right } ) } { 1 + \\frac { d^2 } { 2 \\hbar^2 \\gamma_\\perp    \\gamma_\\parallel } \\sum_{l ' } |e_{l ' } ( { \\mathbf}r , t)|^2 2 \\text{re } [    d(\\omega_{l ' } ) ] { \\left}(1-\\upsilon_{\\text d } { \\right})}.   \\end{gathered}\\ ] ] where @xmath189 , \\\\    \\upsilon_{\\text d } = \\frac { d^2 } { 2\\hbar^2 \\gamma_\\perp \\gamma_\\parallel }    \\sum_{l''\\ne l ' } & |e_{l '' } ( { \\mathbf}r , t)|^2 d_\\parallel ( \\omega_{l '' } -    \\omega_{l ' } ) \\notag \\\\    & \\times \\frac{[d(\\omega_{l '' } ) + d^*(\\omega_{l'})]^2}{2 \\text{re }   [    d(\\omega_{l ' } ) ] } .",
    "\\end{aligned}\\ ] ] taking into account that the electric field in the lasing modes has a typical magnitude of @xmath190 , one can see that deviations from the constant - inversion approximation is of the order of @xmath191 [ the term @xmath192 is of the order of unity since frequencies of lasing modes are concentrated within the width of the gain profile ] . the difference between lasing frequencies can be estimated as @xmath193 .",
    "then the condition @xmath187 can be expressed as @xmath194 .",
    "given that @xmath25 is usually several orders of magnitude smaller than @xmath24 , this condition is in most situations fulfilled . it was reported in ref .",
    "@xcite , however , that nonlinear interaction between lasing modes can push their frequencies toward each other making the intermode spectral interval much smaller than the typical value given above .",
    "such pairs of modes can result in significant corrections to the constant - population approximation .",
    "adding to the expansion additional connected diagrams with up to @xmath101 vertices , one can improve the constant - population approximation by constructing lasing equations valid in the order @xmath135 in  @xmath185 .",
    "we presented a diagrammatic semiclassical laser theory valid in all orders of electric field .",
    "the original perturbation series in the powers of the field can be resummed in terms of a certain class of diagrams , the connected diagrams .",
    "the resummation allows to construct a controlled expansion in the small parameter @xmath195 , which is a measure of population pulsations , while treating the nonlinearity exactly .",
    "our lasing equations generalize the all - order nonlinear equations in the constant - inversion approximation and the third - order equations with population - pulsation terms . the use of constant - flux quasimodes as basis functions makes it possible to apply the theory to strongly open and irregular systems , such as random lasers and lasers with chaotic resonators .",
    "financial support was provided by the deutsche forschungsgemeinschaft via the sfb / tr12 and for557  ( o.z . ) and by psc - cuny via grants no .",
    "62680 - 00 39 and no .",
    "61788 - 00 39  ( l.d . ) .",
    "for a few lowest values of @xmath43 the validity of eqs .",
    "( [ pq ] ) and  ( [ nq ] ) can be checked directly . to prove these relations by induction , we assume that @xmath196 is given by eq .",
    "( [ nq ] ) , then derive @xmath197  ( [ pq ] ) , and , finally , obtain  @xmath198 .    according to eq .",
    "( [ poleqft ] ) , @xmath199 substituting @xmath196 from eq .",
    "( [ nq ] ) , we immediately see that the factor before the integral in eq .",
    "( [ pq ] ) is reproduced . to calculate the integral , we consider separately the two contributions : @xmath200^*$ ] , where @xmath201 is given explicitly by eq .",
    "( [ nq ] ) and @xmath202^*$ ] is  @xmath44 .",
    "when integrating @xmath203 we introduce a new variable @xmath204 then the integral over @xmath205 becomes @xmath206 comparison with eq .",
    "( [ pq ] ) shows that @xmath207 contribution yields the part of the @xmath197 integrand proportional to @xmath208 .",
    "when integrating @xmath209^*$ ] , we first exchange the labels @xmath210 , @xmath211 ,  , @xmath212 and then define the variable @xmath213 transforming the integral over @xmath205  as @xmath214 we obtain the part of the @xmath197 integrand proportional to @xmath215 .    next we derive @xmath198 using eq .",
    "( [ inveqft ] ) , @xmath216 clearly , the factor before the integral in eq .",
    "( [ nq ] ) follows after substitution of @xmath217  ( [ pq ] ) . introducing the new variable @xmath218 we rewrite the @xmath205  integral @xmath219 this completes the proof of eqs .",
    "( [ pq ] ) and  ( [ nq ] ) .",
    "the diagrams @xmath99 ( @xmath220 ) are given by the following analytical expression : @xmath221 [ d(\\omega_{l_1 } - \\omega_{l_2 }    + \\omega_{l_3 } ) + d^*(\\omega_{l_2 } - \\omega_{l_1 } + \\omega_{l_4 } ) ] \\cdots    \\notag \\\\    & \\times [ d(\\omega_{l_1 } - \\omega_{l_2 } + \\omega_{l_3 } - \\cdots - \\omega_{l_{q    - 3 } } + \\omega_{l_{q - 2 } } ) + d^*(\\omega_{l_2 } - \\omega_{l_1 } + \\omega_{l_4 }    - \\cdots - \\omega_{l_{q - 4 } } + \\omega_{l_{q - 1 } } ) ] .",
    "\\label{xqj0 }   \\end{aligned}\\ ] ] the symbol @xmath222 denotes a summation over the lasing - mode indices @xmath223 according to the rules : ( i ) if the indices @xmath85 and @xmath130 are connected in the diagram  @xmath99 , set @xmath224 and ( ii ) the terms with four or more indices @xmath225 equal are excluded unless the links connecting the affected vertices do not intersect .",
    "we denote by @xmath122 connected diagrams and subdiagrams containing the vertex  @xmath62 . with the ordering of @xmath99 such that the connected diagrams come before the disconnected diagrams for a given  @xmath43",
    ", we can identify @xmath226 ( @xmath227 ) , where @xmath124 is the number of connected diagrams .",
    "the subdiagrams @xmath126 without the special vertex have a variable index  @xmath228 in place of the fixed index  @xmath62 .",
    "the analytical expression for these diagrams has the form @xmath229 [ d(\\omega_{l_1 } - \\omega_{l_2 }    + \\omega_{l_3 } ) + d^*(\\omega_{l_2 } - \\omega_{l_1 } + \\omega_{l_4 } ) ] \\cdots    \\notag \\\\    & \\times [ d(\\omega_{l_1 } - \\omega_{l_2 } + \\omega_{l_3 } - \\cdots - \\omega_{l_{q    - 1 } } + \\omega_{l_q } ) + d^*(\\omega_{l_2 } - \\omega_{l_1 } + \\omega_{l_4 }    - \\cdots - \\omega_{l_{q - 2 } } + \\omega_{l_{q + 1 } } ) ] .",
    "\\label{xqj }   \\end{aligned}\\ ] ]    the sum @xmath230 is defined analogously to the sum  @xmath222 above .",
    "note that the diagrams @xmath99 and @xmath122 are of the order  @xmath231 in the electric field , while the subdiagrams @xmath126 are of the order  @xmath101 .    to show the multiplicativity property ,",
    "let us assume that a disconnected diagram @xmath99 can be cut in two , possibly disconnected subdiagrams , @xmath232 and  @xmath233 , such that @xmath234 .",
    "we will label the vertices of @xmath233 as @xmath235 and identify them with the first @xmath236 vertices of the diagram  @xmath99 .",
    "the last @xmath237 vertices of  @xmath99 , @xmath238 , are also the vertices of  @xmath239 .",
    "we need to show that , in the sum  @xmath222 , the two groups of indices can be split between the sums @xmath240 and  @xmath241 , respectively .",
    "this would mean that the arguments of the functions @xmath242 and @xmath185 can contain only the indices belonging to one of the groups .",
    "this is , indeed , the case , since the arguments having less than @xmath236 frequencies contain only the indices from the first group , while in the arguments with more frequencies the first @xmath236 frequencies cancel due to the cut  as @xmath243 according to this equality , the number of nontrivial factors @xmath244 in eqs .",
    "( [ xqj0 ] ) and  ( [ xqj ] ) is @xmath135 minus the number of cuts ( in a disconnected diagram ) ."
  ],
  "abstract_text": [
    "<S> we derive semiclassical laser equations valid in all orders of nonlinearity . with the help of a diagrammatic representation , </S>",
    "<S> the perturbation series in powers of electric field can be resummed in terms of a certain class of diagrams . </S>",
    "<S> the resummation makes it possible to take into account a weak effect of population pulsations in a controlled way , while treating the nonlinearity exactly . </S>",
    "<S> the proposed laser theory reproduces the all - order nonlinear equations in the approximation of constant population inversion and the third - order equations with population - pulsation terms , as special cases . </S>",
    "<S> the theory can be applied to arbitrarily open and irregular lasers , such as random lasers . </S>"
  ]
}