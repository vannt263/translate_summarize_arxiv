{
  "article_text": [
    "phylogenetic trees inferred from different genes often suggest different evolutionary histories for the species from which they have been sampled .",
    "this problem of gene tree ` incongruence ' is widely recognized in molecular systematics @xcite .",
    "it is particularly relevant to the question of the extent to which the history of life on earth can be represented by a phylogenetic tree , rather than a complex network of reticulate evolutionary events , such as species hybridization , lateral gene transfer ( lgt ) and endosymbiosis .",
    "there are several well - recognized causes of gene tree incongruence , most of which apply even in the absence of reticulate evolution , and we begin by discussing these .",
    "firstly , there is always an expected amount of disagreement under any model of tree - based markovian evolution , simply due to random sampling effects ( i.e. the sequences are of finite rather than infinite length ) ; moreover , this effect becomes magnified as branches in the tree become very short , or very long @xcite .",
    "furthermore , regardless of how much data one has , certain tree reconstruction methods may exhibit systematic errors , due to phenomena such as long branch attraction , or where the model assumed in the analysis differs significantly from the process that generated the data ( ` model mis - specification ' ) @xcite .",
    "a second basic reason for gene trees to differ in topology from the underlying species tree is the population - genetic phenomenon of incomplete lineage sorting .",
    "as one traces the history of a gene sampled from different extant species back in time , the resulting tree of coalescent events can differ from the species tree within which these lineages lie .",
    "recent theoretical work @xcite based on the multi - species coalescent has shown that the most probable gene tree topology can differ from the species tree topology , when the number of taxa is greater than three .",
    "by contrast , it has long been known that for triplets , the matching topology is the most probable topology @xcite , @xcite .",
    "gene tree discordance due to incomplete lineage sorting is well - established in many data sets , and has been proposed as an explanation for why , for example , up to 30% of the gene trees in the tree ( ( human , chimp ) , gorilla ) do not support this species relationship @xcite .",
    "further recent work on lineage sorting has investigated the statistical consistency of building species trees from gene trees ( or the clades they contain ) according to various consensus criteria @xcite , @xcite .",
    "additional reasons for gene tree discordance that are still consistent with a species tree are gene duplication and loss , and recombination .",
    "if we turn now to reticulate evolution , it helps to distinguish between two types : hybridization ( which will include , for example , endosymbiosis , the transfer of a sizable percentage of the genome of one species into another or the combination of two genomes into a larger genome ) and lgt ( which is widespread in bacteria and includes the transfer of one or a small number of genes from one organism to another ) . in the case of hybridization",
    ", it is clear that no single tree can adequately describe the evolution of the taxa under study , and that a network ( or a set of species trees ) is usually a more appropriate representation .",
    "hybridization will lead to gene tree incongruence but it leaves a statistically different signature to the processes of lineage sorting or sampling error discussed above .",
    "for example , in the case of lineage sorting , for a given triplet of taxa , we expect that one of the two topologies will be well supported , and the other two topologies will have lower but approximately equal support . on the other hand , under hybridization",
    ", we expect to find support for two of the three topologies that reflect the hybridization event but little support for the third ) .",
    "a number of authors have explored this question of distinguishing hybridization from lineage sorting @xcite , @xcite , @xcite , @xcite , @xcite .",
    "the second type of reticulate evolution , lgt , is the main concern of this paper , and is particularly relevant for prokaryotic evolution @xcite , @xcite , @xcite .",
    "a fundamental and much - debated question is whether a species tree can be reconstructed from gene trees if genes are randomly transferred between the lineages of the tree @xcite , @xcite .",
    "one viewpoint holds that if the vast majority of genes have been transferred during their history then few gene tree topologies will agree with any species tree topology , so it makes little sense to talk about a single species tree @xcite , @xcite ( however , the same claim could be made , in error , for lineage sorting , as argued by @xcite ) .",
    "an alternative view is that one can still recover statistical support for a central species tree even in the presence of relatively high rates of lgt ( @xcite , @xcite , @xcite ) , particularly if these transfers occur in a mostly random ( rather than concerted ) fashion .",
    "random models for lgt have been proposed and studied by a number of authors , particularly @xcite , @xcite , @xcite and @xcite .",
    "these models are somewhat similar ",
    "random lgt events occur according to a poisson process , and the main differences concern whether the rate of transfer between two points in the tree is constant or dependent on the phylogenetic distance between them . in @xcite ,",
    "the most recent of these papers , roch and snir establish a strong transition result , which shows how the species tree can be reconstructed from a given ( logarithmic ) number of gene trees , provided that the expected number of lgt events lies below a certain threshold ; above this threshold , it becomes impossible to distinguish the underlying species tree from alternative trees based only on the given gene trees .",
    "our results are complementary to this work , as our interest is more in the statistical consistency of species tree reconstruction and , in particular the consistency of tree reconstruction of triplets in a larger tree .    in our paper",
    "we begin by setting up some definitions to formally describe the way in which an arbitrary sequence of lgts on a species tree determines the topology of the associated gene tree .",
    "we consider the combinatorial aspects of this process for any given triplet of leaves .",
    "we then introduce the model of random lgt events from @xcite along with an extension to allow the rates of lgt to vary with time and with phylogenetic distance . under these models ,",
    "we provide an exact analysis of this model on three - taxon and four - taxon trees , showing that for three - taxon trees , the species topology always has strictly higher probability than the other two competing topologies , but for certain four - taxon trees there is a zone of ( weak ) statistical inconsistency . in section  [ general ] , we consider trees with an arbitrary number of leaves and establish a sufficient condition for statistically consistent species tree reconstruction from gene trees . essentially , this condition is an upper bound on the expected number of transfers of certain types in the tree .",
    "we then discuss how estimates of the rate of lgt in a large tree could impact on this analysis , and consider the difficult problem of reconstructing a tree when the topology of each gene tree can be influenced by both lgt and incomplete lineage sorting processes .",
    "finally , we describe and illustrate a simple algorithm for reconstructing a species tree from gene trees which may have patchy taxon coverage ; here tree reconstruction is statistically consistent if each gene evolves under the random model of lgt or incomplete lineage sorting , provided the rate of lgt is sufficiently low .",
    "we end with a brief discussion and some questions for further work .",
    "throughout this paper @xmath3 will denote a set of species of size @xmath4 , and @xmath5 will denote a subset of @xmath3 of size @xmath6 . consider a rooted phylogenetic ` species ' tree @xmath7 , with leaf set @xmath3 , and a vertex @xmath8 .",
    "we will regard @xmath7 as a 1-dimensional simplicial complex ( i.e. the edges as intervals ) so each ` point ' @xmath9 in @xmath7 is either a vertex or an element of the interval that corresponds to an edge . consider a coalescence time scale : @xmath10 of the tree with the coalescence time increasing into the past . then :    * @xmath11 is a leaf , * if @xmath12 is a descendant of @xmath13 then @xmath14 .",
    "we refer to @xmath15 as the _ @xmath16-value of @xmath9 _ and to @xmath17 as the _ timespan _ of the tree ( the time from the present to the most recent common ancestor ( mrca ) of all the species in @xmath3 ) .",
    "a _ lateral gene transfer ( lgt ) on @xmath7 _ ( or , more briefly a _ transfer event _ ) is an arc from @xmath18 to @xmath19 where @xmath9 and @xmath20 are contemporaneous , i.e. @xmath21 .",
    "we will also assume that neither @xmath9 nor @xmath20 are vertices of @xmath7 ( i.e. transfers go between points on the edges of the tree ) .",
    "we write @xmath22 to denote this transfer event and we write @xmath23 for the common value of @xmath15 and @xmath24 .",
    "we will assume that no two transfer events occur at the same time .",
    "let @xmath25 be a sequence of transfer events ( @xmath26 ) arranged in increasing @xmath16-value order ( thus @xmath27 is the most recent transfer event and @xmath28 is the most ancient ; moreover , the total ordering is well defined by the assumption that no two transfer events took place at the same date ) .",
    "thus , we will always assume in what follows that : @xmath29    we refer to @xmath30 as a _ transfer sequence _ on the species tree @xmath7 .",
    "in the biological context , we view @xmath30 as describing the transfer history of a particular gene , so different genes will have different associated transfer sequences ( including , possibly , the empty transfer sequence , if no transfer events occur on @xmath7 ) .    given a species tree @xmath7 with the leaf set @xmath3 and a transfer sequence @xmath31 on @xmath7 , we obtain an associated _ gene tree _ @xmath32 $ ] . to describe this tree more precisely , we assume , as in @xcite , that an lgt arc from point @xmath9 to @xmath20 replaces the gene that was present on the edge at @xmath20 with with the transferred gene from @xmath9 .",
    "thus , if we trace the history of the gene from the present to the past ( i.e. in increasing coalescence time ) , each time we encounter an incoming horizontal arc into this edge we follow this arc ( against the direction of the arc ) . in this way , the species tree , along with any sequence of lgts describes an associated gene tree .",
    "we can formalize this mathematically as follows .",
    "for a transfer sequence @xmath33 where @xmath34 , consider the tree @xmath7 together with a directed edge for each @xmath35 placed between @xmath36 and @xmath37 for each @xmath38 and regard this network as a one - dimensional simplicial complex .",
    "now for each @xmath38 , delete the interval of this 1-complex immediately above @xmath37 and consider the minimal connected subgraph of the resulting complex that contains @xmath3 .",
    "call this tree @xmath32 $ ] .",
    "an example is shown in fig .",
    "[ fig1 ] .",
    "* given the pair @xmath39 , define the following sequence of derived @xmath40trees , for @xmath41 : @xmath42.\\ ] ] thus , @xmath43 $ ] , and for @xmath44 , @xmath45 $ ] is the gene tree obtained from @xmath7 by performing just the @xmath46 most recent transfers .",
    "* given @xmath47 , a point @xmath48 and any non - empty subset @xmath49 of @xmath3 , let @xmath50 denote the subset of @xmath49 whose elements are the _ descendants _ of @xmath9 ( i.e which become separated from the root of @xmath51 if @xmath9 is deleted ) .",
    "consider a species tree @xmath7 on @xmath3 .",
    "for the rest of this paper , we will assume that @xmath7 is binary ( i.e. fully resolved ) .",
    "let @xmath52 be a subset of @xmath3 of size 3 .",
    "we write @xmath53 to denote the binary phylogenetic tree on leaf set @xmath5 that is induced by restricting the leaf set of @xmath7 to @xmath5 @xcite .",
    "we refer to @xmath54 as a _ triplet ( species tree ) topology _ , and we write @xmath55 to denote the triplet topology in which the root of this tree separates leaf @xmath56 from the pair @xmath57 .      for a sequence @xmath30 of transfer events",
    ", we say that :    * @xmath30 induces a _ match _ for @xmath58 if the species tree @xmath7 and its associated gene tree @xmath32 $ ] resolve @xmath59 as the same three - taxon tree ; i.e. , if @xmath60|a = t|a.\\ ] ] otherwise , if @xmath32|a$ ] is one of the other two rooted binary tree topologies on leaf set @xmath5 , we say that @xmath61 induces a _ mismatch _ for @xmath5 .",
    "an example is provided in fig .",
    "[ fig2 ] . * for a transfer event @xmath62 , we say that @xmath61 is _ into an @xmath63lineage _ if @xmath64 is a single element of @xmath5 ( two such transfers are shown in fig .",
    "[ fig2 ] ) .    now",
    ", suppose that @xmath65 is a sequence of transfers on @xmath7 .",
    "consider the resulting sequence @xmath66 of derived trees and let @xmath67 .    *",
    "if @xmath68 for some @xmath69 , we say that @xmath70 is an _",
    "@xmath63transfer _ , and that it _ transfers @xmath71_. * if @xmath70 transfers @xmath71 and @xmath72 , we say that @xmath70 _ moves _ @xmath71 and we refer to @xmath70 as an _ @xmath63moving transfer_. * if @xmath70 transfers @xmath71 , and if @xmath73 , we say that @xmath70 _",
    "joins @xmath71 to @xmath74 _ and we refer to @xmath70 as an _ @xmath63joining transfer . _    note that any @xmath63transfer is either a moving or joining transfer ( but not both ) .",
    "examples of @xmath63transfers are shown in fig .",
    "notice also that the first @xmath63transfer is always a transfer into an @xmath63lineage , but later ones need not be .",
    "moreover , a transfer into an @xmath63lineage may not be an @xmath63transfer if certain other @xmath63transfers proceed it in some transfer sequence .",
    "we now state two combinatorial lemmas which will form the basis for the stochastic analysis that follows later .",
    "let @xmath75 denote the time from the present to the mrca in @xmath7 of the closest pair of taxa in @xmath5 ( so if @xmath76 then @xmath75 is the time from the present to the mrca of @xmath77 and @xmath78 ) .",
    "the following lemma collects for later reference some observations concerning the impact of different types of transfers .",
    "[ lem1 ]    let @xmath33 be a sequence of transfer events on a rooted binary @xmath40tree @xmath7 and let @xmath58 .",
    "* if @xmath30 induces a mismatch for @xmath5 , then @xmath30 must contain an @xmath63transfer with a @xmath79value less than @xmath75 .",
    "* moreover , precisely one of the following occurs : * * @xmath30 has no @xmath63transfers . in this case",
    ", @xmath30 induces a match for @xmath5 . * * @xmath30 contains at least one @xmath63joining transfer . in this case , if the first such transfer in @xmath30 joins @xmath71 to @xmath74 then @xmath32|a = z|xy$ ] where @xmath80 . * * @xmath30 has no @xmath63joining transfers , but it has an @xmath63moving transfer with a @xmath79value less than @xmath75 . in this case , if @xmath70 denotes the first such @xmath63moving transfer in @xmath30 then : @xmath60|a = t[\\sigma_r,\\ldots , \\sigma_k]|a.\\ ] ]    a second combinatorial lemma , extends case ( b)(iii ) of lemma  [ lem1 ] slightly and is used in the proof of theorem  [ fourcasethm ] . in order to state it , we need some further definitions .",
    "suppose @xmath33 is a sequence of transfer events on a rooted binary @xmath40tree @xmath7 with @xmath81 , and with no @xmath63joining transfers .",
    "construct an associated sequence of trees @xmath82 as follows .",
    "set @xmath83 and construct by @xmath84 from @xmath85 by the following procedure .",
    "if @xmath35 is not @xmath63moving then set @xmath86 .",
    "if @xmath26 moves @xmath87 then let @xmath84 be the tree obtained from @xmath85 by :    * deleting all @xmath88 with @xmath89 , * labeling @xmath36 by @xmath71 , * for each @xmath90 , assigning label @xmath91 to the unique point @xmath92 of @xmath85 that has @xmath93 and @xmath94 .",
    "* we will regard the other leaves in the tree as unlabeled .    finally transfer the time dating from @xmath95 across to @xmath96 .",
    "[ lem2 ] suppose @xmath33 is a sequence of transfer events on a rooted binary @xmath40tree @xmath7 with @xmath81 , and with no @xmath63joining transfers",
    ". then @xmath32 |a = t'_k|a.$ ]",
    "we begin by recalling the model of lgt described in @xcite , which made the following assumptions : ( 1 ) a binary , labeled , rooted and clocklike species tree @xmath7 is given , as well as all the splitting times along this tree ; ( 2 ) differences between a gene tree and @xmath7 are only caused by lgt events ; ( 3 ) the transfer rate is homogeneous per gene and unit time ; ( 4 ) genes are transferred independently ; ( 5 ) one copy of the transferred gene still remains in the donor genome ; ( 6 ) the transferred gene replaces any existing orthologous counterpart in the acceptor genome .",
    "we refer to this model from @xcite as the _ standard lgt model _ and we will consider extensions of it which relax assumptions ( 2 ) and ( 3 ) . in particular , consider the following relaxation of assumption ( 3 ) in which transfer events on @xmath7 occur as a poisson process through time , in which the rate of transfer event from point @xmath9 on a lineage to a contemporaneous point @xmath20 on another lineage at time @xmath16 occurs at the rate @xmath97 where @xmath98 is a constant or at least monotone non - increasing function in @xmath99 ( though it can vary non - monotonically in @xmath16 ) and @xmath100 is the evolutionary distance in the tree between contemporaneous points @xmath9 and @xmath20 in the tree .",
    "we call this model the _ extended lgt model_.    both the standard and extended lgt models induce a well - defined probability distribution on gene tree topologies , both for the original set of taxa , and for any subset .    in the standard lgt model , the number of transfers has a poisson distribution , with a mean equal to the rate of lgt transfer out of any given point in the tree times the sum of the branch lengths ( phylogenetic diversity ) of the tree .",
    "we first establish that the poisson distribution for the number of lgt transfers ( in total or just the transfers in an @xmath63lineage ) still holds for the extended lgt model .",
    "[ lempois ] under the extended lgt model , the total number of transfers , and the number of transfers into an @xmath63lineage ( for any given subset @xmath5 of @xmath3 of size 3 ) each have a poisson distribution .",
    "we begin by recalling a general property for any collection @xmath101 of independent poisson processes , where process @xmath102 has intensity @xmath103 .",
    "let @xmath104 count the number of times process @xmath102 occurs up to time @xmath105 , and let @xmath106 .",
    "then @xmath104 has a poisson distribution with mean @xmath107 .",
    "moreover , since the sum of independent poisson random variables has a poisson distribution , with a mean equal to the sum of the individual means , it follows that @xmath49 has a poisson distribution , with mean @xmath108 ( for background on these stochastic results , the reader may wish to consult @xcite ) .",
    "we apply this result as follows : let @xmath109 be the total number of transfers and @xmath110 the number of transfers into an @xmath63lineage in the tree .",
    "we can express @xmath109 by considering all intervals @xmath111 between speciation events in @xmath7 and , within each interval , consider all ordered pairs of lineages ( restricted to that interval ) @xmath112 .",
    "for each such ordered triplet @xmath113 , let @xmath102 be the poisson process of transfers from @xmath114 to @xmath115 ( which may depend non - homogeneously on time ) and @xmath116 denotes the number of these transfers for this triplet .",
    "then the @xmath102 are independent processes , and @xmath117 , so @xmath109 has a poisson distribution .",
    "regarding @xmath110 , we consider all intervals @xmath111 between speciation events in @xmath7 and , within each interval , consider all ordered pairs of lineages ( restricted to that interval ) @xmath112 , where @xmath115 has exactly one of @xmath59 as a descendant .",
    "let @xmath102 be the poisson process of transfers from @xmath114 to @xmath115 ( which may depend non - homogeneously on time ) and let @xmath118 denote the number of such transfers for this triplet .",
    "note that the @xmath102 are independent processes , and that @xmath119 , and so again has a poisson distribution .",
    "although the process of lgt transfers ( under the standard or extended ) model is a continuous time process , there is an associated discrete process that induces an identical distribution on gene trees ; it is obtained by considering the decomposition described in the proof of lemma  [ lempois ] .",
    "thus with any sequence @xmath33 of lgt transfers on @xmath7 , we may associate the discrete sequence @xmath120 where @xmath121 refers to a triple @xmath122 , in which case @xmath32 = t[\\underline{s}]$ ] ( i.e. all that matters in determining the resulting tree topology is the sequence of transfers between branches of the tree and their relative ordering , not the actual times that they occur ) . consequently",
    ", each such discrete sequence @xmath123 for @xmath7 has a positive probability , and under the standard lgt model , this probability has a poisson distribution that just depends on @xmath124 .",
    "for a transfer sequence @xmath30 generated by this type of lgt process , and any triplet @xmath125 , we are interested in the probability that @xmath30 induces a match for @xmath126 .    for three leaves , an exact analysis is straightforward , as we now show .",
    "[ lems ] if @xmath7 has just three taxa , then under the extended lgt model , the probability that a transfer sequence induces a match for the three taxa is strictly greater than the probability it induces either one of the two mismatch topologies ( which have equal probability ) .",
    "when @xmath127 then there are no @xmath63moving transfers , and a transfer @xmath61 is @xmath63joining if and only if @xmath128 ; let @xmath109 denote the number of such transfers .",
    "we can express @xmath109 as the sum of six random variables , which counts the number of transfers from the lineage @xmath71 to lineage @xmath74 ( for @xmath129 ) . by the assumptions of the model , and lemma  [ lempois ] , @xmath109 has a poisson distribution with some fixed mean @xmath130 .",
    "now if @xmath131 we obtain a matching topology for the three taxa , while if @xmath132 then , by lemma  [ lem1 ] , the topology of the tree is determined by the first transfer ( since it is , by necessity , @xmath63joining ) and under the assumption of the model ( in particular invoking the property that @xmath133 is non - increasing ) , the probability that this first transfer is between two of the most closely related taxa is at least @xmath134 .",
    "thus , the probability of a matching topology for the three taxa is at least : @xmath135 while for either mismatched topology , the probability is equal to the other mismatch topology and is no more than @xmath136 this completes the proof .",
    "the analysis of the distribution of triplet gene tree topologies generated by random lgt transfers on a four - taxon tree is considerably more interesting than the three - taxon case .",
    "note that with four taxa , there are two rooted binary tree shapes ",
    "the ` fork - shaped ' tree ( with two cherries , as shown in fig .",
    "[ fig4 ] ) and the pectinate tree ( with one cherry ) .",
    "we will provide an exact analysis for the first of these tree shapes under the standard lgt model , as this suffices to demonstrate a zone of statistical inconsistency , though we discuss briefly how an analogous ( but more complex ) analysis could be carried out for the other rooted tree shape .",
    "our analysis requires no approximations , nor any imposition of an upper bound on the number or rate of lgt transfers .",
    "it relies on associating a random walk on a six - cycle to the lgt process .",
    "we begin with some definitions . for four leaves @xmath137 , we write @xmath138 to denote the rooted binary tree , with the leaves @xmath139 on one side of the root and @xmath140 on the other , and with the mrca of @xmath139 at a fixed time @xmath141 and the mrca @xmath140 at a later fixed time @xmath142 .",
    "thus @xmath143 , but no other symmetries hold . for example , the tree @xmath144 is shown in fig .",
    "[ fig4](i ) and the tree @xmath145 in fig .",
    "[ fig4](ii ) . here",
    "@xmath146 refers to the fourth taxon , the identity of which plays no role when we come to consider the topology of the triple @xmath59 .",
    "we now state the main result of this section .",
    "[ fourcasethm ]    suppose @xmath7 is a rooted four - taxon tree and @xmath52 is a subset of the leaf set @xmath3 of @xmath7 , and suppose that @xmath147 ( thus @xmath53 is a tree of type @xmath148 or @xmath149 in fig .",
    "[ fig4 ] ) .",
    "let @xmath150 under the standard lgt model of @xcite , where @xmath80 .",
    "* suppose @xmath7 is of type @xmath149 .",
    "then for any @xmath79value for the mrca of @xmath151 , there is a sufficiently large @xmath16-value for the mrca of @xmath152 , for which the matching gene tree topology @xmath55 has a lower probability than either of the alternative mismatch topologies . + more precisely , for @xmath153 and @xmath154 , we have : @xmath155\\ ] ] and @xmath156 ; moreover , @xmath157 if and only if @xmath158 is greater than @xmath159 * suppose @xmath7 is of type @xmath148",
    ". then for any @xmath79values for the mrcas of @xmath151 and @xmath152 , the matching gene tree topology @xmath55 has a higher probability than either of the alternative mismatch topologies .",
    "+ more precisely , for @xmath148 and @xmath160 , and @xmath161 , we have : @xmath162.\\ ] ] in this case , @xmath163 for all values of @xmath164 and @xmath158 .",
    "first observe that , by symmetry , we have : @xmath165 under the standard lgt model ( indeed this holds here even under the extended lgt model ) .",
    "consider the cyclic graph whose nodes are the six trees : @xmath166 @xmath167 which are connected into a cycle as shown in fig .",
    "[ fig : randomwalk ] .",
    "now , let @xmath168 be a continuous - time symmetric random walk on this 6-cycle graph , where the instantaneous rate of moving from one node to either given neighboring node is @xmath169 .",
    "let @xmath170 @xmath171 be the probability that , after running the process for time @xmath16 , this markov process is at a node that is graph distance @xmath46 ( by the shortest path ) from its initial state .",
    "note that @xmath172^t$ ] satisfies the system of first - order linear differential equations : @xmath173 where @xmath174 is the @xmath175 tridiagonal matrix :    @xmath176\\ ] ]    and so : @xmath177^t .",
    "\\label{solution}\\ ] ]    the eigenvalues of @xmath174 are 0 , -1 , -3 , -4 , and the random walk on the 6-cycle is a reversible markov process with uniform equilibrium frequency , and so @xmath178^t,\\ ] ] and each component @xmath179 is of the form : @xmath180 for constants @xmath181 that are determined by the eigenvectors of @xmath174 .    using standard matrix diagonalization techniques from linear algebra , we obtain the following solution to eqn .",
    "( [ solution ] ) :    @xmath182 \\left [ \\begin{array}{c } 1 \\\\ e^{-t } \\\\",
    "e^{-3t}\\\\ e^{-4 t } \\end{array } \\right]\\ ] ]    from this , one immediately obtains the following result , which will be required later .",
    "[ helps ] for all @xmath183 :    @xmath184 and @xmath185    we return now to the proof of theorem  [ fourcasethm ] .",
    "we will establish part ( i ) , and indicate how the proof of part ( ii ) follows by a directly analogous argument .",
    "let @xmath186 denote the event that the random sequence of transfer events @xmath30 generated by the model induces a match for @xmath5 .",
    "let @xmath187 denote the number of @xmath63joining transfers between @xmath188 and @xmath189 .",
    "then @xmath187 has a poisson distribution with mean @xmath190 , since at any moment in the interval @xmath191 $ ] , there are four lineages , three of which lead to leaves in @xmath5 ( therefore , for any @xmath192 , the rate of transfer from that @xmath193lineage to any lineages that also lead to @xmath5 is @xmath194 ) .",
    "thus the cumulative rate of an @xmath63joining transfer is @xmath195 .",
    "consequently : @xmath196 now , lemma  [ lem1 ] ( part ( b)(ii ) ) implies that : @xmath197 and by the law of total probability , eqns .",
    "( [ weq ] ) and ( [ weq2 ] ) give : @xmath198    now the @xmath63moving transfers between @xmath188 and @xmath189 constitute a continuous - time poisson process for which the rate at which any given @xmath69 is moved is @xmath199 .",
    "note that this process is independent of @xmath187 since the source point of an @xmath63joining transfer is always on a different type of lineage ( having an element of @xmath5 as a descendant ) from an @xmath63moving transfer . as the @xmath63moving process proceeds in time ( from @xmath188 to @xmath189 )",
    ", the resulting sequence of trees @xmath200 described in the preamble to lemma  [ lem2 ] corresponds to a simple symmetric random walk on the nodes of the 6-cycle shown in fig .",
    "[ fig : randomwalk ] , starting with tree @xmath149 at time @xmath188 , and where the rate of moving from one node to any particular neighboring node is @xmath199 . at time @xmath201",
    ", the length of two pendant edges of the @xmath202tree will be @xmath203 while the other two pendant edges have a larger length of @xmath204 , so we stop the process when the length of the shorter pair of pendant edges reaches zero ( i.e. at @xmath189 ) .",
    "note that the length of the pendant edges does not affect the transition process under the standard lgt model , so we can indeed view it as a discrete - state random walk on six states ( rather than on a continuum of states ) .",
    "lemma  [ lem2 ] now ensures that if @xmath205 is the sequence of @xmath63moving transfers between @xmath188 to @xmath189 then @xmath206 $ ] resolves @xmath59 in the same way as the tree @xmath207 does , where @xmath207 is the state of the random walk on the 6-cycle at time @xmath164 . at time @xmath208 the random walk on the 6-cycle is at one of the following nodes :    * @xmath148 , in which case @xmath32|a= a|bc$ ] ( with probability 1 ) ; this does not depend on any transfer events that may occur after @xmath164 ; * @xmath149 , in which case @xmath32|a= a|bc$ ] * * with probability 1 if there is no transfer event between @xmath164 and @xmath209 , or * * with probability @xmath134 if there is at least one transfer event between @xmath164 and @xmath209 ; * @xmath210 or @xmath211 , in which case @xmath32|a= a|bc$ ] with probability @xmath134 if there is at least one transfer event between @xmath164 and @xmath209 ; * @xmath212 or @xmath213 , in which case @xmath32|a\\neq a|bc$ ] regardless of any further transfers .    in this case analysis ,",
    "the probability factor @xmath134 arises from lemma  [ lem1 ] , part b(ii ) .",
    "note also that the probability that there is at least one transfer event between @xmath164 and @xmath209 has probability @xmath214 , and this event is independent of the random walk on the 6-cycle .",
    "consequently , by independence , and by combining these cases we obtain :    @xmath215 which , combined with eqn .",
    "( [ ppeq ] ) and lemma  [ helps ] , establishes eqn .",
    "( [ random1 ] ) .",
    "the remainder of part ( i ) is justified by eqn .",
    "( [ sym ] ) and straightforward algebra to determine when the expression in eqn.([random1 ] ) is lower than the probability of a specific mismatch topology on @xmath5 .    for the proof of part ( ii ) ,",
    "an analogous argument shows that for @xmath54 of type @xmath148 and @xmath160 and @xmath161 , eqn .",
    "( [ ppeq ] ) still holds , that is : @xmath216 for the last term , we find that : @xmath217 from which eqn .  ( [ random2 ] ) now follows , by lemma  [ helps ] .",
    "the remainder of part ( ii ) is justified by eqn .",
    "( [ sym ] ) , and straightforward algebra shows that the expression in eqn .",
    "( [ random2 ] ) is never lower than the probability of a specific mismatch topology on @xmath5 .",
    "[ eq1 ]      part ( i ) of theorem [ fourcasethm ] shows that the species tree topology for three taxa inside a larger tree can have the _",
    "probability among the three possible gene tree topologies on those three taxa , under the standard lgt model ( see fig . 5 ) .",
    "this is in sharp contrast to what occurs with incomplete lineage sorting , where the most probable gene tree for three taxa matches the species tree topology for those three taxa , regardless of what other taxa are present , and how they are arranged in the species tree .",
    "thus , in the setting of theorem [ fourcasethm](i ) , estimating the species tree for a set @xmath5 of three taxa from the frequency of triplet gene trees will be statistically inconsistent ( it will converge on an incorrect tree ) .",
    "however , this does not imply that one can not estimate the species tree from the probability distribution of _ all _ gene trees topologies ( and for all subsets @xmath5 of size three from @xmath3 ) .",
    "moreover , if we use the @xmath218 tree reconstruction method for four - taxon tree having the clades @xmath219 , theorem [ fourcasethm ] ( parts ( i ) and ( ii ) ) shows that we will always return a tree that includes at least one of these clades , and no contradictory clades .",
    "thus , the @xmath218 method would , in this case , be only weakly inconsistent ( i.e. it would return a tree that is either equal to or is resolved by the species tree , rather than being positively misleading )",
    ".      one could perform a similar analysis for the 12 rooted binary trees that have the four leaves @xmath220 and just a single cherry ( rather than two cherries as above ) . in this case , the associated transition graph consists of a 12-cycle , together with three additional edges  obtained by placing an edge between @xmath221 and @xmath222 for each of the three choices of @xmath223 from @xmath224 .",
    "this graph is shown in fig .",
    "[ fig:12cycle ] .",
    "the analysis of the probability of a matching topology for @xmath59 under the random lgt model ( depending on the position of the * lineage ) could be carried out by a similar , albeit more complex , analysis to that for the simpler 6-cycle graph , but this is beyond the scope of the current paper .",
    "we now include the three- and four - taxon results into a more comprehensive statement concerning the statistical consistency of species tree reconstruction under the lgt model , for an arbitrary number of taxa .",
    "[ mainthm ] consider the standard or extended lgt model on a rooted binary phylogenetic @xmath40tree .    *",
    "if @xmath7 has just three taxa , then under either model the probability that a transfer sequence induces a match for the three taxa is strictly greater than the probability that it induces either one of the two mismatch topologies ( which have equal probability ) . *",
    "a four - taxon tree and branch lengths exist for which the model can assign higher probability to a particular mismatch topology for some triplet , than for a match , even under the standard lgt model of @xcite . *",
    "regardless of the number of taxa in the tree and the branch lengths if , for some subset @xmath5 of taxa of size 3 , the expected total number of transfers into an @xmath63lineage ( for the particular gene ) is no more than 0.69 in the extended model , and no more than 1.14 in the standard lgt model , then the probability of a topology match is strictly greater than the probability of either of the mismatch topologies .",
    "* when lgt rates ensure that condition ( iii ) holds for every subset of @xmath5 of taxa of size 3 , there is a polynomial - time method for reconstructing the species tree from the gene trees which is statistically consistent under the model , as the number of independently generated gene trees tends to infinity .    parts ( i ) and ( ii ) are established by proposition  [ lems ] and theorem  [ fourcasethm ] respectively .",
    "_ proof of part ( iii ) _ : let @xmath110 denote the total number of transfer events of the gene in the tree into an @xmath63lineage . by lemma  [ lempois ] , @xmath110 has a poisson distribution with some mean @xmath130 .",
    "then for any triple @xmath59 , suppose that @xmath226 . then if @xmath227 then there is a match with probability @xmath169 .",
    "thus , in the extended model , if @xmath228 then the probability of a match is at least @xmath229 .",
    "this establishes the first claim in part ( iii ) .",
    "for the second claim in part ( iii ) , consider the standard lgt model . in the appendix",
    "we establish the following claim by means of a coupling - style argument .",
    "* claim 1 : * consider a sequence of transfer events under the standard lgt model . then , conditional on the event that @xmath230 , the probability @xmath9 that this sequence of transfers induces a match for @xmath5 is greater or equal to the probability @xmath231 of inducing a specific mismatch topology ( say @xmath232 ) for @xmath5 .",
    "now , under the standard lgt model , the probability of a match is at least : @xmath233 while the probability of a specific mismatch topology ( say @xmath232 ) is at most @xmath234 and from claim 1 , @xmath235 so the difference obtained by subtracting the mismatch topology probability ( [ qq ] ) from the matching topology probability ( [ pp ] ) is at least : @xmath236 and the term on the right is strictly positive for @xmath237 , as claimed .",
    "_ proof of part ( iv ) _",
    ": we can apply the same argument used by @xcite , who showed that the ( polynomial time ) @xmath218 tree reconstruction method ( based on triplet topologies ) is statistically consistent under models of incomplete lineage sorting . here , we are dealing with lgt rather than incomplete lineage sorting , but the only property required of either model in order to ensure the statistical consistency of the @xmath218 method is that for each triplet @xmath5 , the probability that the gene tree matches the species tree topology restricted to @xmath5 has a probability that is greater ( by some fixed @xmath238 ) than either of the other two topologies ( in the case of incomplete lineage sorting , the two alternative topologies have equal probability , but this may not be the case under lgt ; however , this is not essential to prove consistency ) .",
    "theorem  [ mainthm ] ( part ( iii ) ) requires a small expected number of transfers into an @xmath63lineage for any subset @xmath5 .",
    "the question arises as to how this expected number would compare with the total expected number of transfers in the tree .",
    "the total number of lgt transfers in the tree @xmath239 has a poisson distribution ; under the standard lgt model this distribution has mean @xmath240 , where @xmath46 is the rate of lgt transfer out of any given lineage at any given time and @xmath241 is the phylogenetic diversity of @xmath7 ( the sum of the lengths of all its branches ) . for a yule ( pure - birth ) tree with @xmath4 taxa and timespan @xmath16 ,",
    "if the speciation rate is set equal to its expected value , then from @xcite , @xmath241 has expected value : @xmath242    on the other hand , the rate of transfers into an @xmath63lineage at any time is at most @xmath243 and so the expected number of transfers into an @xmath63lineage is , at most , @xmath244 .",
    "thus , if the expected number of lgt transfers in the entire tree is @xmath245 then the expected number of transfers into an @xmath63lineage in a tree with phylogenetic diversity equal to its expected value under the yule model is , at most :    @xmath246    for example , if @xmath247 and @xmath248 ( on average every gene is transferred at most 10 times on the tree ) then ( [ exppd2 ] ) takes the value 0.7 , which is within the 1.14 bound of theorem  [ mainthm ] ( part ( iii ) ) .",
    "we note that in one study , it was suggested that the average number of times each gene has been transferred might be around 1.1 @xcite , so the condition imposed in theorem  [ fourcasethm ] ( iii ) may not be unreasonable . in the recent paper by @xcite , an average rate across bacterial genomes",
    "was estimated at between .02 to .04 lgts per branch of the tree .",
    "thus , for @xmath247 , @xmath245 is about 8 - 16 events , where the upper end of these results include some cases of extremely high rates of lgt in bacteria .",
    "we have described sufficient conditions for the @xmath218 tree - reconstruction method to be a statistically consistent estimator of a species tree topology under various lgt models .",
    "moreover , it is known that the @xmath218 method is also a statistically consistent estimator of the species tree topology under lineage sorting and without any non - trivial restrictions on branch lengths @xcite .",
    "it follows that if each topology of each gene tree is determined by either lgt acting on the species tree topology or by incomplete lineage sorting ( but not by both processes ) then the @xmath218 tree reconstruction method can be a statistically consistent estimator of species tree topology ( under conditions where it would be for the genes undergoing lgt ) .",
    "one could also ask what happens when the two processes are combined  that is , if we allow the ancestry of a gene to follow transfers and to coalesce within lineages , under the usual coalescent process .    while it is possible to extend the earlier results a little in this direction (",
    "results not shown ) , the applicability of the results is somewhat limited for the following reason .",
    "lgt is especially prevalent in haploid , largely asexual taxa with limited recombination , such as bacteria and archaea and , in this case , although incomplete lineage sorting may apply in considering how genetic lineages coalesce in the species tree , there is an important difference to diploid sexual taxa .",
    "namely , in this latter case , the coalescent history of each gene sampled from an extant individual in each species represents an essentially independent sample from the same ( multi - species coalescent ) process , while in taxa with little or no recombination , the lineages of all genes follow the same ancestral trajectory , apart from lgt events .",
    "this complicates any statistical analysis based on assuming that the genes are independent samples from a common process and leads to some delicate statistical issues in attempting to analyse data with such a mixed mode .",
    "we defer this issue for future consideration .",
    "one obstacle to applying the @xmath218 construction is that many genes may not be present across all taxa @xcite .",
    "this may be due to a variety of factors , including gene loss or gene conversion , or simply because certain genes have not been sequenced yet .",
    "consequently , we describe a slight extension of the @xmath218 consensus approach to handle this situation . for any three taxa @xmath125 ,",
    "let @xmath249 denote the set of genes that are present in all three taxa @xmath59 .",
    "we will assume that the pattern of taxon coverage is sufficiently dense that the following condition holds : @xmath250    to give some indication of how much coverage this requires , if @xmath251 denotes the number of taxa containing gene @xmath38 , and @xmath4 is the total number of taxa , then we require : @xmath252 ( from the proof of theorem 1 of @xcite ) , which , in turn , implies the weaker but simpler , inequality : @xmath253    we consider the following simple extension of the @xmath218 consensus method to the setting of partial taxon coverage . for @xmath125 , let @xmath254 denote the proportion of genes in @xmath249 which resolve @xmath59 as the triplet topology @xmath55 .",
    "the set @xmath255 forms a hierarchy , and can be constructed in time that is polynomial in @xmath4 .",
    "this procedure has been implemented in the phylogenetic software package _ dendroscope 3 _ ( version 3.2.2 ) @xcite as the ` primordial tree ' consensus method .",
    "now , under a model in which the pattern of gene presence and absence is a random process ( as in @xcite , where the presence or absence of a gene for each taxon is an independent stochastic process ) and provided this process is independent of the lgt process , the results on the statistical consistency of species tree reconstruction will carry over .",
    "the same also holds if we were to consider incomplete lineage sorting rather than lgt .",
    "[ rice ] shows a tree constructed in this way from the recent bacterial data set of @xcite , for which the authors estimated that the rate of lgt was fairly high ( but not too high to erase all phylogenetic signal ) .",
    "the input was 1338 rooted gene trees on variable label sets for the actinobacteria phylum of their study ( the clade at the upper left in fig .",
    "3 of @xcite ) .",
    "[ bacteria ]    the ` unrooted ' gene trees ( from the website of the authors ) were midpoint - rooted using the phylogenetic program ` phylip ' .",
    "the authors in @xcite implemented a complex procedure as part of their ` prunier ' software , to look at all possible rootings of the input gene trees , selecting the ones that minimized the number of lgt events . rooting them in a new way here",
    "provides an independent analysis of these data .",
    "the output tree is fairly close to the tree suggested by @xcite .",
    "the biggest difference is that the primordial tree roots it at _ r. xylanophilus _ , which is a very long branch in their fig .",
    "the authors of @xcite were concerned about long branch attraction in these data .    as a second application to a quite different data set ( eukaryotes ) and a different process ( incomplete lineage sorting rather than lgt ) , fig .",
    "[ rice ] shows a tree constructed by the same method , from 986 rooted gene trees from chromosome 3 of 11 taxa of the genus _",
    "( rice and its relatives ) .",
    "some trees contained all 11 taxa but most did not , however the pattern of taxon coverage is sufficiently dense that condition ( [ geq ] ) does hold . while this data set is unlikely to exhibit lgt at anywhere near the rate of the previous one , gene flow persisting for some time after speciation would essentially show the same pattern as lgt .",
    "moreover , incomplete lineage sorting is likely quite extensive across the genome at several nodes in the tree ( @xcite , @xcite ) ; zwickl et al .",
    ", in prep . ) .",
    "[ rice ]      it would be interesting to extend the scope of theorem  [ fourcasethm ] to include the other four - taxon tree - shape ( under the standard lgt model ) , as well as to analyze both tree shapes under the extended lgt model .",
    "our analysis also raises some intriguing statistical questions : is strong statistical inconsistency possible ( for r@xmath256 or perhaps other methods ) ? is the species tree identifiable from the probability distribution on gene trees , regardless of the lgt rate ?",
    "if the rate of lgt decreases sufficiently fast with phylogenetic distance in the tree , then is statistical consistency restored for the r@xmath256 method ? and what can be said regarding statistical issues arising when we combine lgt and incomplete lineage sorting and phylogenetic sampling error ?",
    "further research on these questions would help us better understand the extent to which signal for a species tree can be recovered above the ` noise ' of random processes that can cause gene trees to conflict with the species tree .",
    "s.l . was supported by a marie curie international outgoing fellowship within the 7th european community framework programme .",
    "m.s . was supported by the allan wilson centre for molecular ecology and evolution .",
    "we also thank derrick zwickl and the oryza genome evolution project .",
    "99 abby , s.s .",
    ", tannier , e. , gouy , m. , and vincent , d. ( 2012 ) . lateral gene transfer as a support for the tree of life .",
    "_ 109 ( 13 ) 49624967 .",
    "allman , e.s .",
    ", degnan , j.h .",
    "and rhodes , j.a . ( 2011 ) . determining species tree topologies from clade probabilities under the coalescent .",
    "_ j. theor .",
    "_ 289 : 96106 .",
    "bapteste , e. , susko , e. , leigh , j. , macleod , d. , charlebois , r. l. and doolittle , w. f. ( 2005 ) .",
    "do orthologous gene phylogenies really support tree - thinking ? _",
    "_ 5 , e33 .",
    "chung , y. , an , c. ( 2011 ) .",
    "comparing two bayesian methods for gene tree / species tree reconstruction : a simulation with incomplete lineage sorting and horizontal gene transfer .",
    "biol . _ 60(3 ) : 261275 .",
    "cranston , k.a .",
    ", hurwitz , b. , ware , d. , stein , l. and wing , r.a .",
    "species trees from highly incongruent gene trees in rice .",
    "biol _ 58(5):489500 .",
    "dagan , t. and martin , w. ( 2007 ) .",
    "ancestral genome sizes specify the minimum rate of lateral gene transfer during prokaryote evolution , _ proc .",
    "104(3 ) : 870875 .",
    "dagan , t and martin w. ( 2006 ) .",
    "the tree of one percent . _ genome biol . _ 2006;7(10):118 .",
    "degnan , j. , degiorgio , m. , bryant , d. and rosenberg , n. ( 2009 ) .",
    "properties of consensus methods for inferring species trees from gene trees .",
    "_ 58 : 3554 .",
    "doolittle , w.f .",
    "phylogenetic classification and the universal tree .",
    "_ science _",
    "284(5423 ) : 21242129 .",
    "felsenstein , j. ( 2004 ) . inferring phylogenies .",
    "sinauer associates , sunderland , ma .",
    "galtier , n. ( 2007 ) . a model of horizontal gene transfer and the bacterial phylogeny problem .",
    "_ syst biol .",
    "_ 56:633642.ds galtier n. and daubin , v. ( 2008 ) dealing with incongruence in phylogenomic analyses . _",
    "philos trans r soc lond ( b ) _ : 363:40234029 .",
    "grimmett , g. and stirzaker , d. ( 2001 ) . probability and random processes .",
    "oxford university press ( 2nd ed . ) .",
    "hobbolt , a. , christensen , o.f .",
    ", mailund , t , and shierup , m. ( 2007 ) .",
    "genomic relationships and speciation times of human , chimpanzee , and gorilla inferred from a coalescent hidden markov model .",
    "_ plos genet .",
    "holland , b. , bentham , s. , lockhart , p. , moulton , p. and huber , k. ( 2008 ) .",
    "the power of supernetworks to distinguish hybridisation from lineage - sorting via collections of gene trees . _",
    "_ 8 : 202 .",
    "holder , m.t . ,",
    "anderson , j.a . and",
    "holloway , a.k .",
    "difficulties in detecting hybridization .",
    "50(6 ) : 978982 .",
    "huson , d.h . and",
    "scornavacca , c. ( 2012 ) .",
    "dendroscope 3 : an interactive tool for rooted phylogenetic trees and networks .",
    "biol . _ 61(6 ) : 1061 - 1067 .",
    "jain , r. , rivera , m.c . and lake , j.a .",
    "horizontal gene transfer among genomes : the complexity hypothesis .",
    "96(7 ) : 38013806 .",
    "joly , s. , mclenachan , p.a . and lockhart , p.j .",
    "( 2009 ) . a statistical approach for distinguishing hybridization and incomplete lineage sorting .",
    "_ 174(2):e5470 .",
    "linz , s. , radtke , a. , and von haeseler , a. ( 2007 ) . a likelihood framework to measure horizontal gene transfer _ mol .",
    "_ 24(6):13121319 .",
    "martyn , i. and steel , m. ( 2012 ) . the impact and interplay of long and short branches on phylogenetic information content .",
    "_ j. theor .",
    "_ 314 : 157163 nei , m. ( 1987 ) .",
    "molecular evolutionary genetics .",
    "colombia university press , new york .",
    "roch , s. and snir , s. ( 2012 ) . recovering the tree - like trend of evolution despite extensive lateral genetic transfer : a probabilistic analysis _",
    "j. comput .",
    "( in press ) , arxiv:1206.3520 . rosenberg , n.a .",
    "the probability of topological concordance of gene trees and species trees .",
    "_ 61 : 225247 .",
    "sanderson , m.j . ,",
    "mcmahon , m.m . and steel , m. ( 2010 ) .",
    "phylogenomics with incomplete taxon coverage : the limits to inference .",
    "_ bmc evolutionary biology _ 10 : 155 .",
    "semple , c. and steel , m. ( 2003 ) .",
    "oxford university press .",
    "steel , m. and mooers , a. ( 2010 ) .",
    "expected length of pendant and interior edges of a yule tree .",
    "lett . _ 23(11 ) : 13151319 .",
    "suchard m. a. ( 2005 ) .",
    "stochastic models for horizontal gene transfer : taking a random walk through tree space .",
    "_ genetics _ 170 : 419431 .",
    "szllsi , g.j . ,",
    "boussau , b. , abby , s.s . ,",
    "tanniera , e. and daubin , v. ( 2012 ) phylogenetic modeling of lateral gene transfer reconstructs the pattern and relative timing of speciations .",
    "( usa ) _ 109 ( 43 )",
    ": 1751317518 .",
    "tajima , f. 1983 .",
    "evolutionary relationships of dna sequences in finite populations .",
    "_ genetics _ 105:437460 .",
    "yu , y. , degnan , j.h . and nakhleh , l. ( 2012 ) . the probability of a gene tree topology within a phylogenetic network with applications to hybridization detection .",
    "_ plos one _ 8(4 ) : e1002660 .",
    "zou , x. h. , zhang , f.m . ,",
    "zhang , j. g. , zang , l. l. , tang , l .",
    "wang , j. , sang , t. and ge , s. ( 2008 ) .",
    "analysis of 142 genes resolves the rapid diversification of the rice genus .",
    "genome biology 9 .",
    "zwickl , d. , r. wing , and m. j. sanderson .",
    "deep coverage phylogenomics in a shallow clade : lessons from _ oryza _ chromosome 3 .",
    "( manuscript ) .",
    "consider a sequence @xmath30 of one or more transfer events , which contains exactly one transfer @xmath257 that is into an @xmath63lineage and for which @xmath32|a = c|ab$ ] .",
    "we will associate with @xmath30 another sequence of transfer events @xmath205 which induces a match for @xmath5 , and which is identical to @xmath30 except that @xmath61 is substituted by a particular alternative transfer @xmath258 .    in case @xmath61",
    "is an @xmath63joining transfer ( in which case it joins @xmath56 to @xmath77 , or @xmath77 to @xmath56 in order for @xmath32|a = c|ab$ ] ) we replace @xmath61 with the transfer @xmath258 ( at the same time - instant ) that :            consider case ( iii ) . recalling that @xmath61 is the @xmath46-th transfer in @xmath30 , in order for @xmath30 to induce the topology @xmath232",
    ", there must be a vertex @xmath13 in the derived trees @xmath263 for which @xmath264 ; moreover , since @xmath61 is the only transfer into an @xmath63lineage , @xmath13 must lie on the the path in @xmath7 between @xmath77 and the mrca of @xmath57 . in this case , we take @xmath265 where @xmath266 is the unique point in @xmath7 with @xmath267 and which has @xmath268 .    in case ( iv ) , in order for @xmath30 to induce the topology @xmath232 there must be a vertex @xmath13 in the derived trees @xmath263 for which @xmath264 ; moreover , since @xmath61 is the only transfer into an @xmath63lineage , @xmath13 must lie on the path in @xmath7 between the @xmath56 and the mrca of @xmath5 . in this case , we take @xmath269 where @xmath270 is the unique point in @xmath7 with @xmath271 and which has @xmath272 .    case ( v ) is similar to case ( ii ) except that we can take @xmath13 to be the mrca of @xmath273 , and ( as in case ( ii ) ) we take @xmath269 where @xmath270 is the unique point in @xmath7 with @xmath271 and which has @xmath272 .",
    "in all five cases ( i)(v ) , replacing @xmath61 by @xmath258 in the sequence @xmath30 results in the modified sequence @xmath205 that induces a match for @xmath5 ; moreover the association @xmath274 is one - to - one on the set of transfer sequences with @xmath230 and which induce @xmath232 and @xmath55 respectively .",
    "it then follows that @xmath235 under the standard lgt model , as claimed ."
  ],
  "abstract_text": [
    "<S> a major problem for inferring species trees from gene trees is that evolutionary processes can sometimes favour gene tree topologies that conflict with an underlying species tree . in the case of incomplete lineage sorting , this phenomenon has recently been well - studied , and some elegant solutions for species tree reconstruction have been proposed . </S>",
    "<S> one particularly simple and statistically consistent estimator of the species tree under incomplete lineage sorting is to combine three - taxon analyses , which are phylogenetically robust to incomplete lineage sorting . in this paper </S>",
    "<S> , we consider whether such an approach will also work under lateral gene transfer ( lgt ) . by providing an exact analysis of some cases of this model , </S>",
    "<S> we show that there is a zone of inconsistency for triplet - based species tree reconstruction under lgt . however , a triplet - based approach will consistently reconstruct a species tree under models of lgt , provided that the expected number of lgt transfers is not too high . </S>",
    "<S> our analysis involves a novel connection between the lgt problem and random walks on cyclic graphs . </S>",
    "<S> we have implemented a procedure for reconstructing trees subject to lgt or lineage sorting in settings where taxon coverage may be patchy and illustrate its use on two sample data sets .    _ </S>",
    "<S> address : _ @xmath0allan wilson centre for molecular ecology and evolution , university of canterbury , christchurch , new zealand    @xmath1zbit , universitt tbingen c310a , sand 14 , 72076 tbingen , germany .    </S>",
    "<S> @xmath2department of ecology and evolutionary biology , university of arizona , 1041 e. lowell , tucson , az , usa .    phylogenetic tree , lateral gene transfer , poisson process , statistical consistency </S>"
  ]
}