{
  "article_text": [
    "photonic band - gap ( pbg ) materials give rise to an altered density of states ( dos ) for the electromagnetic field , which leads to a fundamentally different atom - radiation field interaction @xcite . when atoms emit light into these structures , they exhibit inhibition of spontaneous emission @xcite , localization of light , and the formation of an atom - photon bound state @xcite .",
    "these effects are due to entanglement between the atomic and photonic states , and as such represent a failure of the born - markov approximation , which allows the derivation of a master equation for the reduced density matrix of the atom and has been an extraordinarily useful tool in the field of theoretical quantum optics for treating spontaneous emission .",
    "the spontaneous emission of photons into a pbg has been described analytically , but describing such a system with the added nonlinearity of driving has remained a theoretical challenge @xcite .",
    "this paper outlines a numerical method that calculates the resonance fluorescence of a driven atom in a pbg material . it may be applicable to other weakly non - markovian systems .",
    "a photonic band gap is a range of frequencies in which no photon propagation can occur .",
    "an atom near one of these band edges will experience an interaction with an altered electromagnetic vacuum , and will therefore decay in a different manner .",
    "trivially , there will be no emission of photons into the band gap , but the altered dos near the band edge will have further effects on the behavior .",
    "the case of spontaneous emission was treated by john and quang @xcite who , due to the restricted state space in this case , were able to solve the equations of motion for the system analytically by laplace transform methods .",
    "they found that the atom would not decay to the ground state due to the presence of a localized atom - photon bound state which was more strongly bound with stronger coupling . near a band edge",
    ", the energy of the propagating photons varies quadratically with the wavevector in the same way as a massive particle propagating in free space .",
    "the model of this system is therefore virtually identical to that of a single mode atom laser @xcite .",
    "the extension of the work of john and quang to a driven atom has remained a theoretical challenge .",
    "when pumping was added to the atom laser model , it allowed access to a potentially infinite ladder of states within the lasing mode .",
    "fortunately , the linearity of the problem allowed a closed set of equations for the relevant expectation values to be developed , and the steady state output spectrum of the system was calculated @xcite .",
    "in contrast , a driven two level atom in a pbg material has a much smaller system ( two states ) , but the nonlinear behavior of the atom due to the driving , in conjuction with the output coupling to the field , does not allow a closed set of equations to be deduced .",
    "quang and john attempted a treatment in which they assumed that no more than one photon was ever present in the output field @xcite , but in a subsequent comment this assumption was shown to be equivalent to the born approximation , and the monte carlo wavefunction method employed to deal with this problem was shown to be invalid @xcite .",
    "the memory of a system with a quadratic dispersion relation in one dimension is effectively infinite .",
    "this is evident in the undriven case where photons can be permanently localized near the atom , which can remain partially in the excited state forever .",
    "driving the atom in the presence of this dressed atom - photon bound state will cause the bound state to become more highly occupied .",
    "a driven atom in a pbg material is analogous to the pumped atom laser model , which does not have a steady state without the inclusion of a loss mechanism for the bound state @xcite . in a real system",
    "the build - up of energy in the bound state would reach some limit as imperfections in both the pbg material and the quadratic approximation became significant .",
    "in other words , describing the resonance fluorescence of an atom in such a material requires inclusion of the losses in order to produce a physical result",
    ". this will result in a finite memory time for the evolution of the atomic system .",
    "in addition , the calculations so far have dealt with an isotropic model of  a bandgap but more appropriate for artificially created bandgap materials is the anisotropic bandgap model @xcite which leads to memory function that decays much more rapidly than that for an isotropic bandgap . in this paper",
    "we will present a method which is able to calculate the evolution of a driven atom near a pbg providing the memory time of the system is sufficiently short , and the coupling is sufficiently weak .    in the next section",
    "we will describe our model for the driven atom , and demonstrate how a formal solution for the reduced density matrix of the atom can be generated . in sec .",
    "[ sec : method ] we will describe a numerical method for producing results with this formal solution . sec .",
    "[ sec : results ] shows how our method reproduces the exact result from a similar , soluble system , and then describes the spectrum of the resonance fluorescence near a band gap in a pbg material with varying levels of detuning of the atomic resonance from the bandgap edge .",
    "we consider a two level atom with atomic energy level separation @xmath2 .",
    "it is described by the pauli spin matrices @xmath3 , @xmath4 and @xmath5 , which satisfy the commutation relations @xmath6=\\sigma _ { z}$ ] , and @xmath7 . the atom is driven by a classical field of frequency @xmath8 , and is modeled by the hamiltonian @xmath9 where @xmath10 is the strength of the driving field experienced by the atom .    under the rotating wave approximation @xcite the hamiltonian for the atom coupled to a large number of discrete modes of the electromagnetic field can be written as @xmath11\\ ] ] where @xmath12 is the annihilation operator of the @xmath13-th mode , characterized by the frequency @xmath14 , and is coupled to the atom with the coupling strength @xmath15 .",
    "it is important to note that the coupling is linear in the field operators .    for the formal manipulations which we will perform below it",
    "is convenient to work in the interaction picture . in the interaction picture",
    "the hamiltonian can be written as @xmath16,\\ ] ] where the _ driving field_@xcite , @xmath17 , is defined by @xmath18 and the interaction picture atomic operator @xmath19 is given by @xmath20 . the free evolution operator @xmath21 in this equation is defined by @xmath22 .",
    "a quantity fundamental to any attempt to describe this interaction in terms of the atomic system alone is the memory function , defined as the commutator of the driving field with its complex conjugate ; @xmath23 .",
    "\\label{eq : fdef}\\ ] ] for @xmath24 , the memory function is the probability _ amplitude _ of absorbing a photon at time @xmath25 that was emitted previously at time @xmath26 .",
    "it is therefore the feynman propagator of a virtual photon .",
    "non - markovian behavior arises when one can not consider the lifetime of the virtual photons to be vanishingly small .",
    "the born - markov approximation can be made for free space resonance fluorescence , as ( for sufficiently high frequencies ) the linear dispersion relation ( @xmath27 ) produces an infinitely narrow memory function .",
    "unfortunately , near a photonic band gap the dispersion relations can be quadratic , and this leads to a very long memory time .",
    "the combination of non - markovian evolution and the nonlinear behavior of a driven atom renders this problem intractable to either born - markov master equation methods applicable to free - space resonance fluorescence @xcite , or laplace transform methods that have been applied to the case of spontaneous emission into a band gap material @xcite .",
    "instead , we approach this problem by a direct numerical solution of the evolution of the reduced atomic system .",
    "the first important step is the derivation of a formal equation for the reduced density matrix of the atomic system .",
    "the reduced density matrix is defined by tracing over the field degrees of freedom of the density matrix for the full interacting system . in the interaction picture",
    "it has the form @xmath28 \\rho _ { { \\rm tot}}\\overrightarrow{t } % \\left [ e^{\\frac{i}{\\hbar } \\int_{0}^{t}duh_{i}(u)}\\right ] \\right\\ } , \\label{densitymatrix}\\ ] ] where @xmath29 denotes ( anti-)timeordering .",
    "assuming an initial factorized state of the atom and field , @xmath30 , and that the field is initially in a generalized gaussian state @xcite ( e.g. a thermal state ) , a formal expression in terms of only system variables can be determined for the right - hand side of eq.([densitymatrix ] ) . here",
    "we will perform a derivation for the case of an initial vacuum field , @xmath31 .",
    "we use the identity @xcite @xmath32 = % \\overleftarrow{t}_{\\sigma } \\left\\ { v_{+}v_{0}v_{-}\\right\\ }   \\label{eq : udef}\\ ] ] where @xmath33 is a time ordering operator which denotes a time ordering on the atomic operators only , and where we have defined the operators @xmath34 where @xmath35 is the memory function , defined by eq .",
    "( [ eq : fdef ] ) .",
    "similarly , we can write @xmath36 = % \\overrightarrow{t}_{\\sigma } \\left\\ { v_{-}^{\\dagger } v_{0}^{\\dagger } v_{+}^{\\dagger } \\right\\}\\ ] ] for the anti - timeordered term .    in order to greatly simplify the manipulation of these time - ordered quantities we introduce a notational apparatus , first used by feynman @xcite ,",
    "whereby unprimed atomic operators are assumed to be time - ordered to the left of @xmath37 and primed operators anti - timeordered to the right .",
    "we can then write eq .",
    "( [ densitymatrix ] ) as @xmath38 where @xmath39 this notation allows us to manipulate the atomic operators as if they were @xmath40-numbers while keeping track of their correct ordering in the expression .",
    "we can use the cyclic properties of the trace over the field variables to write eq.([primenotation ] ) in the form @xmath41 we now normally order the field operators in this expression by making use of the relations @xmath42}=e^{b}e^{a}e^{\\frac{% 1}{2}[a , b]}$ ] for two operators @xmath43 and @xmath44 satisfying @xmath45=[b,[a , b]]=0 $ ] .",
    "the normally - ordered field operators are annihilated on the field vacuum and we are left with the result @xmath46 where @xmath47f_{{\\rm m}}(u , v)\\sigma ( v)+\\left [ \\sigma ( u)-\\sigma ^{\\prime } ( u)\\right ] f_{{\\rm m}}^{\\ast } ( u , v){\\sigma ^{\\prime } } ^{\\dagger } ( v)\\right\\ } .\\ ] ] this is a formal solution that contains no reference to the field operators . the only reference to the particular characteristics of the field is via the memory function .",
    "the @xmath48 and @xmath49 terms arise from the vacuum field to vacuum field evolution while the terms linking the two sides of the density matrix , @xmath50 and @xmath51 arise from tracing over all the photons that are irretrievably emitted into the field .",
    "note that only under the born - markov approximation [ where it is possible to replace @xmath52 by @xmath53 does the evolution matrix , @xmath54 factorize at each time , as in this case the double integral reduces to a single integral .",
    "it is then possible to write down a ordinary differential equation for @xmath55 . in general",
    ", however , this is not possible and it is necessary to use the formal solution eq.([formalsol ] ) .",
    "the theoretical difficulty with using this formal solution is not the size of the system , which can be described by three real numbers , but with the implicit time ordering of the system operators , which in general leads to an infinite number of  ordered terms .",
    "physically , these higher order terms are the processes associated with increasing numbers of photons , and will become increasingly less significant in a system with a finite memory time",
    ". a driven system without a finite memory time may lead to unphysical behavior @xcite , so we are particularly interested in systems with a finite memory time .",
    "when this timescale is shorter than other dynamic timescales we are describing a markovian system , and otherwise we are describing a non - markovian system .    in this work we consider a numerical approach to solving the evolution matrix @xmath56 .",
    "we discretize time and then make the approximation of a finite memory time @xmath57 . in other words , we assume that we can effectively put @xmath58 for all @xmath59 .",
    "our algorithm considers all possible processes that can occur with these restrictions . from eq.([formalsol ] ) it is clear that it is not possible to determine @xmath60 from only @xmath55 as at time @xmath25 there are photons in the field , represented by the presence of the memory function that will re - interact with the atom at time @xmath61 .",
    "these photons have to be taken into account in any algorithm .",
    "it turns out that under the finite memory time approximation we can follow the evolution of these photons by introducing a finite number of additional , `` virtual '' , density matrices , @xmath62 @xmath63 . the evolution equation for the reduced density matrix together with the virtual density matrices",
    "has the form @xmath64 where @xmath65 $ ] is an evolution superoperator and @xmath66 approximates the reduced density matrix .",
    "the method is based on transforming the numerical algorithm for propagating a non - markovian differential equation into a markovian form . to motivate this idea ,",
    "consider the following elementary example of an integro - differential equation ,    @xmath67 with a finite lower - bound on the integral .",
    "this integro - differential equation can be propagated numerically via the algorithm    @xmath68 + o(\\delta t^{2 } )   \\label{routine}\\ ] ]    where @xmath69 and @xmath70 we have used the trapezoidal rule for the integral and euler s method to propagate the differential equation forward . due to the finite memory time ,  this algorithm can be written in an explicitly markovian form by introducing @xmath71 extra variables @xmath72 .",
    "the equivalent markovian algorithm is    @xmath73    with the initial condition",
    "@xmath74 in this particular case , this transformation does not offer any advantage , however , this example is analogous to the algorithm for propagating the reduced density matrix that we will present in the next section . in that case ,",
    "due to the presence of time - ordering , reformulation as a markovian algorithm becomes invaluable .",
    "as a first step in determining an algorithm let us evaluate the integrals in the exponential in eq.([formalsol ] ) on a grid , @xmath75 where @xmath76 for convenience of notation we have written @xmath77 where @xmath78 , @xmath79 and @xmath80 the weights are given by @xmath81 as we are using the trapezoidal rule ( as the time ordering produces an integrand that is effectively discontinuous at each time step there is good reason to believe that a higher order rule will not improve accuracy ) . note that we have also explicitly truncated the sums after @xmath82 as the memory function",
    "is assumed to be zero for all additional terms .",
    "we can now write @xmath83 where in the second line we have expanded out the exponentials at each time , @xmath84 , to first order in @xmath85 .",
    "note that it is still necessary to timeorder the operators in this expression .",
    "let us attempt to write this expression in terms of the above mentioned density matrices @xmath86 at one particular time @xmath87 , where we choose @xmath88 as this is the most common case .",
    "first split the evolution matrix at @xmath89 and @xmath90 , @xmath91 where it is convenient to separate out the factor @xmath92 as it does not take part in our subsequent manipulations . then split the sums over @xmath13 in @xmath93 for @xmath94 into parts containing interaction picture operators before and after @xmath90 , @xmath95 where @xmath96 \\\\ y_{j , n } & = & \\sum_{k = j - m+1}^{n-1}\\delta tf_{j - k}\\sigma _ { k } \\\\",
    "z_{j , n } & = & \\sum_{k = j - m+1}^{n-1}\\delta tf_{j - k}^{\\ast } { \\sigma ^{\\prime } } % _ { k}^{\\dagger } .\\end{aligned}\\ ] ] consider the @xmath1 factors from @xmath97 to @xmath98 . due to the truncation of the sums at @xmath1 terms ,",
    "it is only these factors that contain interaction picture operators at time @xmath90 .",
    "we can expand this _",
    "product _ of @xmath1 factors , each of which has three terms , as a _ sum _ over @xmath0 terms @xmath99 where @xmath100 contains only operators after @xmath87 and @xmath101 contains only operators before @xmath90 .",
    "note that since @xmath102 we only need to consider a sum over @xmath103 terms . to write down the explicit form for @xmath100 and",
    "@xmath101 it is convenient to introduce a new notation to label the terms .",
    "we write the index @xmath104 in trinary ( i.e. base three ) , where the @xmath105 trit ( bit in base three ) tells us which of the three factors to choose from the @xmath106 term ( shown in eq .",
    "( [ sam ] ) .",
    "our new index then lists the trits which correspond to the first term , @xmath107 ; the second term , @xmath108 ; or the third term , @xmath109 .",
    "these lists replace the @xmath104 index . in this notation we can write @xmath110 and @xmath111 where , if the lists @xmath112 are the empty set , @xmath113 , by construction we have @xmath114 .",
    "this allows us to define a set of @xmath103 density matrices at time @xmath87 of the form @xmath115 note that @xmath116 is defined such that it corresponds to @xmath117 up to order @xmath118 .",
    "if we can determine the transformation from @xmath119 to @xmath120 we will have achieved our aim of writing the non - markovian evolution in terms of a markovian evolution in an extended space .",
    "this is done by writing @xmath121 in terms of @xmath119 .",
    "noting that @xmath122 and @xmath123 we can write @xmath124\\prod_{j=1}^{m - q - p}[z_{n+c_{j},n}+\\delta tf_{c_{j}}^{\\ast } { \\sigma ^{\\prime } } _ { n}^{\\dagger } ]   \\nonumber \\\\ & & \\quad \\times \\lbrack x_{n , n}+\\delta t({\\sigma ^{\\prime } } _ { n}^{\\dagger } -\\sigma _ { n}^{\\dagger } ) y_{n , n}+\\delta t(\\sigma",
    "_ { n}-\\sigma _ { n}^{\\prime } ) z_{n , n}]\\bar{\\rho}.\\end{aligned}\\ ] ] expanding out the first two sets of factors and keeping only first - order terms the right hand side can now be written in terms of the density matrices at @xmath87 , @xmath125 \\rho _ { n-1}^{\\{b_{1}+1,\\cdots , b_{q}+1;c_{1}+1,\\cdots , c_{m - q - p}+1\\ } }   \\nonumber \\\\ & & + \\delta t\\sigma _",
    "{ n}\\sum_{k=1}^{q}f_{b_{k}}\\rho _ { n-1}^{\\{b_{1}+1,\\cdots , b_{k-1}+1,b_{k+1}+1,\\cdots , b_{q}+1;c_{1}+1,\\cdots , c_{m - q - p}+1\\ } }   \\nonumber \\\\ & & + \\delta t{\\sigma ^{\\prime } } _ { n}^{\\dagger } \\sum_{k=1}^{m - q - p}f_{c_{k}}^{\\ast } \\rho _ { n-1}^{\\{b_{1}+1,\\cdots , b_{q}+1;c_{1}+1,\\cdots , c_{k-1}+1,c_{k+1}+1,\\cdots , c_{m - q - p}+1\\ } }   \\nonumber \\\\ & & + \\delta t({\\sigma ^{\\prime } } _ { n}^{\\dagger } -\\sigma _ { n}^{\\dagger } ) \\rho _ { n-1}^{\\{1,b_{1}+1,\\cdots , b_{q}+1;c_{1}+1,\\cdots , c_{m - q - p}+1\\ } }   \\nonumber \\\\ & & + \\delta t(\\sigma",
    "_ { n}-\\sigma _ { n}^{\\prime } ) \\rho _ { n-1}^{\\{b_{1}+1,\\cdots , b_{q}+1;1,c_{1}+1,\\cdots , c_{m - q - p}+1\\}}+o(\\delta t^{2 } ) .",
    "\\label{final}\\end{aligned}\\ ] ] physically , during a short enough interval only one photon can be emitted or absorbed at a time .",
    "the higher order terms in @xmath85 correspond to two or more particle emissions or absorptions during this interval and hence we have dropped them .",
    "that is , except for the terms @xmath126 which we include because often the memory function diverges at the origin and @xmath127 , so this term is effectively of order @xmath128 the additional density matrices are _ virtual _ in the sense that they represent states that are never observed in the system behavior and also in the related sense that they follow the paths of virtual photons .",
    "this equation has the form of eq.([tool ] ) and therefore the right hand side can be put in the form of a superoperator acting on a density matrix . in this way it is possible to propagate the non - markovian evolution forward in time .",
    "any expectation values are determined from @xmath129 alone ; @xmath130 for this reason it is convenient to introduce the projection operator @xmath131 @xmath132defined by @xmath133 where @xmath134 is projected out of the `` vector '' of matrices @xmath135 which includes the reduced density matrix and all of the virtual density matrices . in this notation",
    "we can write the expectation value eq.([expect ] ) as @xmath136 and the evolution equation ( [ final ] ) as @xmath137 where @xmath138 often one is not only interested in expectation values at a single time but also in temporal correlations .",
    "for example , the correlation function ( with @xmath139 )    @xmath140    where , assuming that the initial state of the field is the vacuum state , we have written    @xmath141    in general , techniques for calculating the correlation function such as the quantum regression theorem ( see , for example , @xcite ) will not work in the non - markovian case as there is no factorization of the evolution matrix @xmath142 at time @xmath143 .",
    "however , it is not difficult to see that this type of correlation function is easily calculated numerically within the above formalism .",
    "one simply propagates the set of density matrices @xmath144 forward from @xmath145 as usual ; then at @xmath146 multiply by @xmath147 ; taking this as the new initial state one can propagate up to time @xmath148 giving @xmath149 to the accuracy of the algorithm . in symbolic notation this procedure is written as    @xmath150    where @xmath151 denotes a time - ordered product .",
    "for numerical simulations it is often more useful to work in the schrdinger picture .",
    "equation ( [ final ] ) can easily be put in the schrdinger picture  because the operators are all acting at the same time .",
    "we simply multiply by @xmath152 which transforms the density matrices at time @xmath90 to the schrdinger picture and then write the interaction picture operators on the right hand side in terms of the schrdinger picture operators .",
    "the resulting equation has the same form as eq.([final ] ) ( with the density matrices in the schrdinger picture ) except the right hand side is multiplied by @xmath153 ; @xmath154 the advantage of the schrdinger picture is that the superoperator @xmath155 does not change with time and so only needs to be constructed once at the start of the simulation .",
    "it is worth noting that the above superoperator representation does not need to be abandoned in numerical simulations .",
    "we can , for example , flatten the density matrix into a column vector so that both the primed and unprimed operators ( which consequently become @xmath156 matrices rather than @xmath157 matrices ) act only on the left - hand side of this flattened density matrix @xcite . the right - hand side of eq.([schrodingerpictureeqn ] ) then represents the @xmath158 sparse matrix @xmath159 @xmath160 multiplying the @xmath161 column vector @xmath162 .",
    "note that the initial vector @xmath163 has all elements zero except for @xmath164 .",
    "also note that we have written @xmath1 not @xmath71 , as some virtual density matrices are initialized at each time step .",
    "before we present the results of numerical simulations using the above algorithm , it is important to make some general comments about the limitations of the algorithm .",
    "as mentioned above , to propagate the non - markovian evolution requires a vector of size @xmath161 to be updated at each time step , thus computer memory considerations put a severe limitation on the number of time steps per memory time , @xmath1 , that the algorithm can deal with . in our case",
    ", we created the time independent evolution matrix at the beginning and were in fact limited by the number of non - zero entries of this matrix that could be stored in computer memory . on a computer with 128 mb of ram we were limited to a maximum of @xmath165 .",
    "this obviously poses quite a problem when one wishes to consider quite non - markovian situations but also require high accuracy .",
    "however , for test cases where the system was not strongly non - markovian , the results of our simulations show good agreement with calculations using standard methods of analysis .    in the rest of this article",
    "we consider the case of on - resonance driving ( @xmath166 ) . in a frame rotating at the atomic frequency",
    "the hamiltonian for the atom reduces to @xmath167 this hamiltonian gives rise to the following behavior @xmath168 where @xmath169 and the states @xmath170 are defined by @xmath171 when the atom is coupled to a propagating field these three terms give rise to three distinct peaks in the spectrum at @xmath172 @xmath173 .",
    "this is referred to as the resonance fluorescence triplet @xcite .    with a structured electromagnetic field",
    ", these emission peaks may be altered . in the following sections we use our algorithm to consider the case",
    "when the atom is in a cavity tuned to one of the side peaks and the case when one of the side - peaks is at a frequency where no photons propagate in a bandgap material .      in order to demonstrate the validity of our algorithm we consider a simple system that can also be described by a born - markov master equation ( and so can be solved by traditional methods ) and compare the results of the two methods .",
    "the system that we consider is an atom coupled to a single mode of a cavity which is in turn coupled to a continuum of propagating modes of the electromagnetic field via a partially transmissive mirror .",
    "the standard method of finding the evolution of this system is to treat the atom and the cavity as a system and the external field as a reservoir which can be traced over .",
    "this produces a born - markov master equation for the atom and cavity modes .",
    "this can then be solved by standard methods @xcite .",
    "one can also make a different choice of system and reservoir ; consider the evolution of the atom alone while treating both the cavity and the external field as the reservoir ; giving rise to a non - markovian problem .",
    "the usual description of this system is in terms of the hamiltonian @xmath174 ,   \\label{proofofequivhone}\\ ] ] where @xmath175 \\right\\ } , \\label{proofofequivhprime}\\ ] ] and where @xmath176 is the annihilation operator of the cavity mode , @xmath177 is the annihilation operator for the external propagating electromagnetic field mode of energy @xmath178 , @xmath3 is the lowering operator for the atom , and @xmath179 acts only on the atomic operators .",
    "choosing the atom as the system and eliminating the cavity mode it is possible to describe this system by the alternative hamiltonian ( see appendix . [ app : atomincavity ] ) @xmath180\\right\\ } , \\label{alternativeh}\\ ] ] where @xmath181 is a new bose annihilation operator and the , now frequency dependent , coupling constant is @xmath182 the memory function in this case is therefore given by @xmath183e^{-i\\omega t+\\omega ^{\\prime } s } \\\\ & = & \\frac{\\gamma } { 2\\pi } \\int_{-\\infty } ^{\\infty } d\\omega \\frac{\\kappa ^{2}}{% ( \\omega -\\nu ) ^{2}+\\left ( \\frac{\\kappa ^{2}}{2}\\right ) ^{2}}e^{-i\\omega ( t - s ) } \\\\ & = & \\gamma \\exp \\left\\ { -i\\nu ( t - s)-\\frac{\\kappa ^{2}}{2}|t - s|\\right\\ } .\\end{aligned}\\ ] ] transforming to a frame rotating at the atomic frequency appends a factor @xmath184 to this memory function .",
    "this model differs from that of the bandgap only by the functional form of the memory function .",
    "we compare our results for the system described by @xmath185 using the non - markovian algorithm introduced in sec .",
    "[ sec : method ] with the solution of the born - markov master equation for the atom plus cavity system as described by @xmath186 . in fig.[fig : cavityavg ] we plot the time evolution of the probability for the atom to be in the excited state .",
    "the internal spectrum , @xmath187 , defined as the fourier transform of the steady - state correlation function @xmath188 , is plotted in fig.[fig : cavityspec ] showing a significant asymmetry in the height of the side peaks due to the tuning of the cavity to only one side band of the resonance fluorescence triplet .",
    "this is a completely non - markovian effect as it arrises directly from the structured nature of the field , i.e. , the fact that some frequencies of the field are easier to emit into than others . both the probability and the spectrum",
    "show good agreement with the results of the traditional method ( we used the numerical routines in the quantum optics toolbox @xcite ) .",
    "in this section we apply our algorithm to resonance fluorescence in a bandgap material ; a problem that can not be solved by any traditional methods . following the discussion of vats and john @xcite we consider an _ anisotropic _ bandgap model under the effective mass approximation .",
    "this approximation is appropriate to fabricated band gap materials . in this model",
    "the band edge is associated with a specific point in @xmath13-space , @xmath189 , and the dispersion relation close to the upper edge of the gap has the form    @xmath190    where @xmath191 is called the effective mass in analogy with the dispersion relations of massive particles .",
    "this dispersion relation gives rise to a memory function with the asymptotic behavior @xmath192 so that , in contrast to an _ isotropic _ bandgap ( where @xmath193 we are able to define a finite memory time .    the memory function given by @xmath194 suffers from a singularity at @xmath195 this is due to the absence of a high - frequency cutoff , which must be included to model a physical system .",
    "we include this high frequency cutoff  by considering the slightly modified memory function ,    @xmath196 } } { \\left ( 1+\\lambda \\tau \\right ) ^{3/2 } } ,   \\label{bandgapmf}\\ ] ]    where ( shifting to a frame rotating at the atomic frequency ) @xmath197 is the detuning between the band edge and the atomic resonance frequency and @xmath198 is a measure of the coupling strength between the atom and the electromagnetic field .",
    "the parameter @xmath199 is infinite when there is no upper frequency limit , so for large @xmath200 this memory function is effectively the same as that derived by vats and john .",
    "it is useful to introduce the quantity    @xmath201    which corresponds to the born - markov damping rate for this memory function .",
    "we use this quantity as a scale against which we can measure the various rates .    for large @xmath202 the factor",
    "@xmath203 has a sharply rising behavior as @xmath204 on a time scale much faster than the system variables .",
    "this is a common feature of physical memory functions and requires special treatment in numerical calculations .",
    "we generalize the trapezoidal rule used for the atom in a cavity case by calculating weights that depend on the first two moments of @xmath205 and derive an extended two - point integration scheme on a uniform mesh as described in ref.@xcite .",
    "explicitly , we used the weights    @xmath206 where @xmath207 since @xmath208 this integration scheme treats the semi - singular part of the memory function exactly and allows us to treat a range of non - markovian situations , including the markovian limit , within the same algorithm .",
    "as mentioned previously we do not consider schemes of higher order than the two - point scheme as the numerical difficulty of evolving the system a single timestep increases dramatically due to the combinatorics introduced by the time - ordering .",
    "let us first consider the undriven case where an initially excited atom simply undergoes decay inside a bandgap material . since this case can be treated by an alternative method it serves as another test of the algorithm .",
    "in the case of simple decay there is at most only one photon in the electomagnetic field so we can write the state of the atom and field as @xmath209 where @xmath210 and @xmath211 are the excited and ground states of the atom and @xmath212 is the field vacuum .",
    "it is not difficult to establish that @xmath213 with @xmath214 given by eq.([bandgapmf ] ) .",
    "this integro - differential equation can be numerically simulated by , for example , the routine ( [ routine ] ) .",
    "in actual fact we used the weighting scheme described above to approximate the integral .",
    "the probability of the atom being in the excited state is given by @xmath215 in fig .",
    "[ fig : decay ] we have compared the results of our algorithm to a direct numerical integration of the above integro - differential equation ; the two methods show good agreement .",
    "in contrast to the isotropic band gap case , previously treated analytically in ref.@xcite , the decay is always exponential . this can be seen more clearly in the corresponding plot of the logarithm of @xmath216 , fig.[fig : decaylog ] .",
    "note that in this plot the discrepancy between the two methods is apparent .",
    "our algorithm gets more accurate as @xmath200 is increased as this allows a smaller stepsize to be taken .",
    "these plots were made with the parameter value @xmath217 and the variation of the damping rate with detuning from the bandgap is evident .",
    "however , when this parameter is increased the situation becomes more and more markovian , despite the long time tail of the memory function . for @xmath218",
    "there is no noticeable difference from the markovian case ; the decay rate is exactly that predicted by the born - markov result , and the detuning becomes irrelevant .",
    "this is shown in fig.[fig : decaymarkov ] .",
    "note that the @xmath219 case requires the driving laser to be propagating in a direction that is perpendicular to the direction of @xmath220 for the anisotropic bandgap .    for non - zero driving",
    "there are no traditional methods available and the results can only be determined by a quantum non - markovian treatment . in fig.[fig : bandgapavg ] we have plotted the probability amplitude for the atom to be in its excited state",
    ". the driving induces oscillations in this probability and the atom tends to a steady state close to equal probability of being in the excited state and in the ground state due to the reasonably large driving .",
    "this behavior is qualitatively equivalent to the markovian case .",
    "the steady - state correlation function , @xmath221 is plotted in fig.[fig : bandgapcorr ] .",
    "taking the fourier transform of the steady - state correlation function , @xmath222 gives the so called internal spectrum of the atom , @xmath223 as in the atom in a cavity case this quality allows us to clearly see the effects of the non - trivial structure in the field on the behavior of the atom . in fig.[fig : bandgapspec ] we have plotted the internal spectrum with @xmath217 for various detunings from the band edge .",
    "a definite asymmetry arises in the magnitude of the side peaks directly due to the fact that emission at frequencies inside the gap is prohibited .",
    "note that as @xmath200 is increased this effect becomes less and less until the spectrum becomes equivalent to the markovian case . in fig.[fig : bandgapspec2 ] we have plotted the internal spectrum with the same detunings but with @xmath224 there is no evidence of asymmetry and the values of detuning become irrelevant just as in the case of the undriven atom .",
    "a number of different methods of dealing with non - markovian systems have appeared in the literature recently .",
    "these methods can be broadly separated into two main categories : methods that involve extending the system size by the addition of real or imaginary modes @xcite such that the new extended system evolves via a born - markov master equation , and methods that attempt to evolve the non - markovian evolution directly @xcite .",
    "note that the approach in ref .",
    "@xcite takes advantage of the special case when the free evolution of the system has an analytical solution to derive a markov equation for the system .",
    "conceptually , the present work falls into the last category , however , in order to propagate the non - markovian evolution we have effectively extended the system size by introducing virtual density matrices that follow the paths of the photons in the field before they are either irretrievably emitted or are reabsorbed by the atom .",
    "the two approaches have very different origins and the way in which the extended system is constructed is fundamentally different .",
    "the present method seems to be slightly more general as no restrictions are made on the form of the memory function , however , time discretization plays a much more fundamental role in our algorithm so it would be very interesting to see on what level these two approaches are related .",
    "the strength of the present algorithm lies in its ability to accurately model weakly non - markovian systems .",
    "an appropriate application would be to determining the validity of the born - markov approximation in borderline cases .",
    "the biggest constraint on the algorithm is the power law increase in the number of virtual density matrices that need to be stored to propagate the non - markovian evolution .",
    "this is a fundamental constraint and arises from the inherent difficulty in numerically simulating quantum mechanical systems in general .",
    "note that the algorithm presented here was derived without using the algebraic relations of the atomic operators .",
    "it is therefore applicable to other system - bath couplings that are linear in the bath operators .    with our algorithm",
    "we have determined the evolution of a driven atom radiating into a bandgap material with an anisotropic bandgap ; a situation that can not be treated by any traditional methods .",
    "the asymmetry in the internal spectrum of the atom clearly demonstrates the effect of the non - trivial structure of the field on the behavior of the atom .",
    "this behavior can not occur under the born - markov approximation .",
    "in addition , we have demonstrated the transition to the born - markov limit , which occurs despite the presence of a long time tail on the memory function .    in this article",
    "we have presented a density matrix version of the algorithm . in this case",
    "the system size was so small that a density matrix treatment was appropriate , however , a wave function version can also be derived in a similar fashion .",
    "the wavefunction version is applicable to simulating non - markovian quantum trajectories that also solve for the reduced density matrix @xcite . in the non - markovian case increasing",
    "system size is obviously an even more difficult constraint to numerical commutation than in the markovian case so wave function methods will be important",
    ".    the authors would like to thank m. collett for useful discussions and m.j .",
    "would like to acknowledge the support of the japan society for the promotion of science .",
    "j.h . was supported by the university of auckland research committee and the marsden fund of the royal society of new zealand .",
    "this appendix shows how the system in section [ sec : atomincavity ] can be written in terms of a non - markovian model .    equation ( [ proofofequivhprime ] )",
    "is valid in the high - frequency limit @xcite : it assumes the rotating wave approximation and that the fundamental frequency @xmath225 is much greater than the spread of frequencies about the fundamental frequency such that we can replace the lower bound of the integral over the bath modes by @xmath226 . note that as we are considering a one dimensional field in the continuum limit it is convenient to work in terms of the frequencies rather than the mode labels .",
    "the proof that the two hamiltonians ( [ proofofequivhone ] ) and ( [ alternativeh ] ) are equivalent consists in demonstrating that they are related by a unitary transformation .",
    "let the initial time of interest be @xmath227 .",
    "for the moment let us restrict our consideration to the cavity mode - field system described by the hamiltonian @xmath228 [ see eq.([proofofequivhprime ] ) ] .",
    "consider the following scenario : let the coupling between the cavity and the field be time dependent and let it increase slowly such that at a long time in the past @xmath229 the coupling is turned off and at the initial time @xmath230 it is equal to @xmath231 , @xmath232 where @xmath233 is a small positive number .",
    "the adiabatic limit of an infinitely slow switching on of the coupling @xmath234is given by the limit where @xmath235 as @xmath236 and @xmath237 the heisenberg equations of motion for the cavity and field modes for @xmath238 are given by    @xmath239=(-i\\nu -\\epsilon ) \\widetilde{a}(t)-\\frac{\\kappa } { \\sqrt{% 2\\pi } } \\int_{-\\infty } ^{\\infty } d\\omega \\quad b(\\omega , t ) \\label{proofofequivprimeone } \\\\",
    "\\frac{db(\\omega , t)}{dt } & = & -\\frac{i}{\\hbar } [ b(\\omega , t),\\widetilde{h}% ( t)]=-i\\omega b(\\omega ) + \\frac{\\kappa } { \\sqrt{2\\pi } } \\widetilde{a}(t ) , \\label{proofofequivprime2}\\end{aligned}\\ ] ]                where @xmath252 @xmath253 letting @xmath254 and @xmath255 ( and assuming that @xmath256 exists in this limit ) this solution becomes @xmath257 } .",
    "\\label{needed2}\\ ] ] as the system contains no bound states the hamiltonian in the same limit is given by @xmath258 therefore , the unitary transformation given by @xmath259 .\\ ] ] diagonalizes the hamiltonian @xmath260 and gives @xmath261 in terms of the diagonalizing modes . from eq.([needed1 ] ) , ( [ needed2 ] ) and ( [ needed3 ] ) we see that this is just the transform required to write the hamiltonian eq.([proofofequivhone ] ) as eq.([alternativeh ] ) with @xmath262 thus demonstrating their physical equivalence ."
  ],
  "abstract_text": [
    "<S> a numerical method of calculating the non - markovian evolution of a driven atom radiating into a structured continuum is developed . </S>",
    "<S> the formal solution for the atomic reduced density matrix is written as a markovian algorithm by introducing a set of additional , virtual density matrices which follow , to the level of approximation of the algorithm , all the possible trajectories of the photons in the electromagnetic field . </S>",
    "<S> the technique is perturbative in the sense that more virtual density matrices are required as the product of the effective memory time and the effective coupling strength become larger . </S>",
    "<S> the number of density matrices required is given by @xmath0 where @xmath1 is the number of timesteps per memory time . </S>",
    "<S> the technique is applied to the problem of a driven two - level atom radiating close to a photonic band gap and the steady - state correlation function of the atom is calculated . </S>"
  ]
}