{
  "article_text": [
    "photometry is the practice of measuring the flux and corresponding uncertainty of astronomical objects .",
    "many different photometry approaches have been developed , each of them optimized for a particular set of goals , and choosing which approach to adopt is a difficult task .",
    "the science goals , intrinsic nature of the target(s ) , and instrumental properties dictate which of the dozens of available photometry algorithms might be most effective .",
    "some scientists , such as those with high - volume computing needs like the sloan digital sky survey group , develop their own codes , comparing them to popular algorithms ( _ e.g. _ , * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "other groups try to optimize existing software for a specific task .",
    "for example , @xcite tested several algorithms for meeting lsst science requirements , and @xcite assessed the performance of two algorithms in crowded fields .",
    "photometry packages currently distributed for public use can be roughly divided into three groups : those that perform aperture photometry , those that construct a model point - spread function ( psf ) from field objects , and those that blend the two .",
    "it is now generally accepted that low signal - to - noise ( s / n ) object magnitudes are most accurately recovered through psf - fitting since the errors are dominated by background uncertainty ( _ e.g. _ , * ? ? ?",
    "* ; * ? ? ?",
    "conversely , high - s / n objects are best represented by aperture photometry , which are more forgiving than psf - fitting techniques of out - of - focus frames and intrinsic morphological complexities ( which may be time variable ) in the psf .",
    "in addition to accurately measuring flux , a second challenge to photometry is absolute calibration , which converts the flux measured in instrumental units ( or instrumental magnitudes ) into true apparent magnitudes .",
    "absolute calibration takes into account the zeropoint ( the scaling factor in magnitude units ) , the atmospheric extinction , and the color conversion from those of the filters used to the standard color system .",
    "we shall not discuss calibration of this dataset in this paper , which focuses only on the initial flux measurements .",
    "moving targets are typically comets and asteroids , which by virtue of their size , distance , and low reflectivity , are very faint ; thus , observations of the primary science targets are typically low s / n , making optimal sky determination critical .",
    "unless imperfections in the optics distort the field , fixed point sources in the field should have exactly the same psf that can most likely be described by a fitting function . moving targets , however ,",
    "will produce a trailed psf that may not be approximated by a function , with the amount of trailing dependent on the object s proper motion .",
    "no publicly available photometry software was designed to handle trailed psfs .",
    "we conducted the first study that quantitatively determines which available photometry algorithm optimizes accuracy and precision for faint moving targets .",
    "we familiarized ourselves with 15 different aperture or psf - fitting algorithms and tested which one most accurately and precisely reproduced the true light curve of a moving object with a known rotational light curve .",
    "one way of testing a technique s accuracy is to use it on data with a known trend and measure the root - mean - square ( rms ) of the residuals against a model .",
    "we acquired data for the trans - neptunian object 1996 to@xmath0 as part of a campaign to determine the object s light curve .",
    "as the purpose of this paper is simply to use this dataset to explore methodology , we will not comment on the campaign itself , nature of the target , or the details of the model and instead defer that information to an upcoming publication ( hainaut _ et al .",
    "_ , _ private comm . _ ) .",
    "the data were obtained on september 22 , 2011 using the university of hawaii ( uh ) 2.2-m telescope with the kron - cousins @xmath1-band filter and the tek ( @xmath2 ) ccd camera , which has a pixel scale of 0.219@xmath3/pixel .",
    "the sky was not photometric due to occasional cirrus clouds .",
    "we measured a median seeing of 0.95@xmath3 fwhm , which varied by @xmath4 over the course of the 1996 to@xmath0 observations .",
    "the focus was checked before beginning the 1996 to@xmath0 observations , but we could not change the focus later as the night progressed due to technical difficulties . consequently ,",
    "a slightly triangular - shaped psf indicative of poor focus was present in two of our images ( fig .",
    "[ fig : images ] ) .",
    "exposure times varied between 900 and 1100 seconds ( the median being @xmath5 ) to achieve our s / n goal of @xmath6 , which is still too faint to have well - defined psf wings .",
    "this was done in an attempt to achieve a constant s / n under changing transparency and seeing conditions .",
    "non - sidereal guiding was used so that the target was not trailed . the target s motion averaged -2.7@xmath7hr in r.a . and -0.8@xmath7hr in dec .",
    ", corresponding to @xmath8 of trailing per frame for stars , or a theoretical psf length - to - width ratio ( or trailing aspect ) of @xmath9 for field stars and 1.0 for the target .",
    "the best - fit models using the tphot psf - fitting algorithm , however , give trailing aspects of 1.5 for the field stars and 1.1 for the target ; the difference between the theoretical and actual trailing aspect is likely attributable to telescope guiding problems ( fig .",
    "[ fig : contours ] ) .",
    "we stress that this amount of trailing is considered minimal compared to typical rates of inner solar system objects @xcite .",
    "the medians of the peak and background counts were @xmath10 and @xmath11 , respectively , and the median flux within a 7-pixel aperture was 23000 @xmath12 600 counts .",
    "we calculate a medan s / n of @xmath13 using the tphot algorithm ( discussed in section [ sec : tphotap ] ) .",
    "figure [ fig : images ] shows both 1996 to@xmath0 s track along the sky and the target - centered sub - sections of the ten 1996 to@xmath0 images .",
    "the observations interleaved 1996 to@xmath0 with another target over 8.12 hours , until 1996 to@xmath0 reached airmass 2.0 .",
    "preliminary results from hainaut _ et al._@xmath14(private comm . )",
    "give a light curve amplitude of @xmath15 magnitudes and a rotation period of @xmath16 hours .",
    "the model light curve reproduces all data obtained as part of a multi - year , multi - telescope , multi - solar phase angle observational campaign to determine the light curve of 1996 to@xmath0 .",
    "our observations correspond to rotation phases ( @xmath17 ) of @xmath18 , or 87.5% of the full rotational light curve .",
    "one data point was consistently fainter than the model by @xmath19 magnitudes regardless of the technique used , likely due to a bad pixel that was not identified during construction of a bad pixel mask , so we excluded it from analysis ( fig .",
    "[ fig : images ] ) .",
    "we prepared the images for analysis using iraf s `` ccdproc '' package @xcite , applying bad pixel , bias , and overscan corrections and flat - fielding with dithered twilight sky frames . to exclude field stars from the bad pixel mask construction ,",
    "we median - combined the brightest twilight flats to produce a stacked bright flat , then repeated that process for a stacked faint flat in the same filter .",
    "we fed the ratio of the stacked bright to the stacked faint flat to the iraf `` ccdmask '' task , which computes a bad pixel mask from a ratio image , then used the `` fixpix '' task within ccdproc to interpolate over bad pixels .",
    "we noted that in two images , a bad pixel was relatively close to the target  8 pixels from the target centroid in frame 3 ( fig .",
    "[ fig : images ] ) , and 9 pixels from the target centroid in the frame that was excluded from analysis ( see section [ sec : obs ] ) .",
    "the bad pixel regions were visually and quantitatively comparable to the local sky after correction ( as it should be ) , so their proximity to the target was of no consequence to our photometry .",
    "afterward , we fit a polynomial to the overscan for line by line bias subtraction and trimmed the data .",
    "we then combined 20 bias frames taken at the beginning and end of the night to produce a stacked bias frame for subtraction .",
    "we acquired seven @xmath1-band twilight sky flats at the beginning of the night and six at the end , all below the limit of the linearity regime for the chip .",
    "however , because the dust pattern changed multiple times within the 1996 to@xmath0 observation window , the twilight flats were not always representative of the field . consequently in the flattened images , residuals from improperly - corrected dust donuts can be seen in a third of our images , possibly influencing background determination for field stars in affected areas .",
    "the residual dust donuts were not close enough to the target to affect the target photometry from any of the algorithms .",
    "lastly , we corrected for cosmic rays using the `` cosmicray '' task within iraf s `` crutil '' package .",
    "we found that a threshold of @xmath20 relative to noise in @xmath1-band images effectively removed most cosmic rays without falsely flagging real sources .",
    "the entire reduction procedure from bad pixel to cosmic ray correction did not differ between photometry algorithms .",
    "after reduction , we measured the effective gain and read noise by doing a linear least squares fit to the square of the sky noise over the sky , all in units of adu .",
    "the slope of the fit is the inverse of the gain , and the y - intercept is the square of the read noise in adu .",
    "we measured a gain and read noise of @xmath21 e@xmath22adu and @xmath23 e@xmath24 , respectively .",
    "field source detection for all photometry algorithms was done using source extractor ( sextractor ) , which identifies point sources as a user - defined minimum number of adjacent pixels ( sharing either a border or a corner ) that are above a specified detection threshold .",
    "if the intensity distribution of a cluster of source pixels shows a distinct saddle point , the surrounding peaks are considered to belong to two separate objects .",
    "sextractor then measures the shape and centroid of each object , eliminates bright object artifacts , and further cleans the source list .",
    "because we find this rigorous detection method very effective at identifying , de - blending , and broadly classifying all field sources , we used it to produce a coordinate list for field stars .",
    "we restricted field stars for further analysis to those that had s / n @xmath2510 within an aperture diameter of @xmath26fwhm , as preliminarily determined by sextractor s `` mag_best '' routine . to correct for extinction and occasional clouds for each algorithm",
    ", we applied an offset correction for each frame to bring the field stars brightnesses to the same level .",
    "this correction was computed by removing the median offset in bright field star magnitudes between frames .",
    "we recognize that systematic errors - a bias in the way the photometry was performed , not in the data itself - may be present due to over- or under - sampling of the background , non - optimal criteria for rejecting contaminants , and/or source flux threshold being too low or high . to test and correct for systematic errors , after removing the shift between frames for cloud correction , we subtracted each star s median magnitude for the night and fit a gaussian to the distribution of differential star magnitudes in that frame .",
    "the hwhm of the gaussian fit ( @xmath27 ) is the same as the total error ( @xmath28 ) and should be a sum in quadrature of the statistical and median systematic error for each target ( @xmath29 and @xmath30 , respectively ) .",
    "therefore , @xmath31 . if @xmath32 , then we considered @xmath33 .",
    "we note that this is the systematic error for field stars , not the untrailed target . because the trailed field stars cover a larger number of pixels , the probability of contamination and erroneous background sampling is higher than for the target",
    "therefore , these systematic errors may be overestimated for the target .",
    "figure [ fig : syserr ] shows a typical gaussian fit to the differential magnitude distribution .",
    "we performed monte carlo simulations of random gaussian distributions with different sample sizes and found that fitting greater than 30 field stars gave a @xmath34% chance of getting a real and reasonable solution .",
    "we found that @xmath27 varied depending on the absolute magnitude range of the stars used , with brighter stars giving a smaller @xmath27 than fainter stars .",
    "therefore , to determine the systematic error most representative of the target , we considered only the @xmath35 field stars closest in magnitude to the target ( r - magnitude @xmath36 ) .",
    "lastly , to fit the data to the model , we tested relative offsets in increments of 0.0001 magnitudes within 0.1 magnitudes of the median - subtracted target magnitudes and used the offset that gave the lowest rms residuals against the model .",
    "aperture photometry packages usually differ in their definition of aperture size and shape and/or in the way the background is determined , but they are popular largely because they are not sensitive to irregular psf shapes .",
    "determining the background correctly is one of the fundamental challenges of photometry .",
    "@xcite found that the flux measured within an aperture radius is extremely sensitive to correct background measurement and subtraction .",
    "if the sky is overestimated , then too much background is subtracted , and as the aperture size is increased , the sum of counts within the aperture decreases rather than yielding a constant flux .",
    "this effect is less prevalent for brighter objects , whose psf wings are more distinct from the noise out to larger radii . it is therefore recommended not to use a bright star alone to determine which aperture radius captures a large percentage of the source flux ( @xmath37% ) because a faint object s flux at that radius may already be significantly contaminated by background .",
    "@xcite also found that different background measurement methods ( _ e.g. _ , median vs. mean , etc . )",
    "yield different accuracies .",
    "they found that a weighted mean is more accurate for fainter objects but underestimated uncertainties for brighter objects .",
    "in addition to proper background subtraction , variation in the psf across the frame caused by optical aberrations is an important consideration with aperture photometry .",
    "most aperture photometry algorithms , save sextractor , do not allow for variation in aperture size across a chip , leaving it difficult to choose the best constant aperture radius for the entire frame . in a detailed study using the hst wfpc-2 ccd camera",
    ", @xcite found that radial variation in the images was significant ( @xmath38% ) , and @xcite found up to a 15% difference in fwhm across the ccd cameras for the sloan digital sky survey ( sdss ) .",
    "although these are extreme examples of wide field imagers with large distortions , it is important to check for spatial variations .",
    "we saw no such distortion in our images to a fraction of a percent , so no spatially - variant aperture was necessary .",
    "popular aperture photometry algorithms that were compared include the phot task within the iraf / apphot package and source extractor ( sextractor ) .",
    "we also implement the tphot aperture photometry technique , optimized in centroiding and reducing background contamination .",
    "ours is the first publication of the tphot software .",
    "lastly , the aperture photometry tool ( apt ) was developed as an educational tool , and because of its ease of use , possible similarity in quality to sextractor , and application to a wider populace , we include it in our study @xcite .",
    "the phot task is widely used for traditional aperture photometry @xcite .",
    "an identical task can be found within the daophot package .",
    "depending on the sky in the vicinity of the target , there are several opportunities to change the way the background is measured within phot , four of which are tested here ( each on all 10 images ) with iraf version 2.14.1 .",
    "phot gives the option of rejecting sky annulus pixels that are above or below a user - defined sigma - threshold , which we chose to be 2.5 .",
    "photometry for both the target and the field stars were done with these settings .    to determine the aperture radius",
    ", we measured a curve - of - growth on several stars of different magnitudes spread over the chip and identified the aperture radius that contained 99.5% of the light , with weighting given to brighter stars . in general , we found that this aperture only varied by @xmath39% between bright unsaturated stars and fainter stars at s / n @xmath6 , indicating that the background was measured accurately .",
    "we repeated this process for all 10 images used and took the largest frame - specific aperture ( 18 pixels , or @xmath40 ) as the fixed , unweighted aperture radius for all images .",
    "the aperture chosen was used for both the trailed stars and the target .",
    "one concern in choosing a photometric aperture radius for moving targets is that the target psf should be narrower than trailed field stars .",
    "consequently , the aperture chosen from field star curves of growth may be larger than the target s 99.5% flux radius , causing an increased contribution from sky noise and potential faint background source contamination .      if the target moves along a track free of significant background contaminants within the sky annulus ( see fig .",
    "[ fig : images ] ) , then a target - centered sky annulus best represents the sky in the photometric aperture . for fainter point sources , the psf wings are indistinguishable from random noise beyond the aperture containing 99.5% of the target flux ( assuming the ccd is flat ) ,",
    "so the choice of inner radius of the sky annulus is somewhat arbitrary , so long as it is outside the aperture . for bright point sources , however",
    ", a small amount of noticeable source flux may be in the region outside the aperture , affecting the magnitude uncertainty . to be sure we were clear of the psf wings of these bright stars , we defined the inner radius of the annulus at @xmath41 , or 28 pixels ( 10 pixels greater than the aperture ) .",
    "we chose the outer bounds of the sky annulus to be @xmath42 ( 50 pixels ) to ensure good background sampling .",
    "if the sky annulus centered on the target contains a significant amount of unavoidable contamination from background sources , one can manually measure the sky background away from the target .",
    "a manually - defined sky annulus would also be necessary for active comets to avoid dust trails .",
    "we used a sky aperture of the same area as the centered sky annulus in section [ sec : photcentered ] and measured the sky 10 - 15 times in a radially - isotropic distribution within @xmath43 ( 80 pixels ) of the target for every frame , avoiding overlap with the photometric aperture or contaminants .",
    "the final sky and sky noise levels used in the photometry for each frame were the average of the individual measurements in that frame . manually measuring the background at several locations off - center from the photometric aperture is too time - intensive to execute for every field star in every frame .",
    "thus , for field stars only , we used phot s non - interactive centered sky annulus technique described in section [ sec : photcentered ] . since the systematic error",
    "is empirically determined from the dispersion in differential field star magnitudes , the systematic error per frame was the same as determined in the centered sky annulus method .",
    "decreasing the photometric aperture excludes some sky noise and nearby contamination but may also exclude source flux .",
    "we used bright field stars with well - defined psf wings to estimate the aperture correction , or amount of source flux lost by using a smaller aperture .",
    "we then added back the residual magnitude estimated from our aperture correction to the magnitudes measured with the smaller aperture for the target . with moving targets , we risk that the untrailed target may not be accurately represented by the aperture correction given by trailed field stars , which have a wider psf than the target .",
    "the choice of the small aperture size is somewhat arbitrary , so long as it is consistent from frame to frame , so we chose a small aperture radius of @xmath45 ( 10 pixels ) to avoid the cosmic ray hit seen in frame 1 ( fig .",
    "[ fig : images ] ) .",
    "we measured the aperture correction between the small aperture and a large aperture at @xmath46 ( 18 pixels ) , using only field stars with @xmath28@xmath47 , to ensure good flux sampling in the psf wings .",
    "field stars that gave aperture corrections more than 2 standard deviations from the mean for that frame were excluded from the computation , leaving on average 16 field stars per frame to determine the aperture correction .",
    "the standard deviation of these stars aperture corrections ( @xmath48 ) was used as the error on the frame s aperture correction , which was added in quadrature to @xmath29 and @xmath30 to compute @xmath28 ( _ i.e. _ , @xmath28@xmath49@xmath29@xmath50@xmath30@xmath51 ) . to measure the sky ,",
    "we used the sky annulus settings described in section [ sec : photcentered ] .",
    "there are sometimes faint background contaminants close to the target that render inaccurate sky determination or add to the target flux",
    ". these background sources may not be obvious in individual frames , but can be seen in a stacked image . to correct for these contaminants",
    ", we constructed a median - combined sky composite ( to remove the moving target ) , scaled the sky composite to match the mode of an individual frame s background , and subtracted the scaled , aligned composite from each frame using the iraf `` imarith '' task .",
    "the sky composite was made from 8 of the 10 science frames , with frames 8 and 9 excluded because the target s location did not change enough relative to other frames to remove all target flux from the median sky composite .",
    "the subtracted images should be free of faint sources , but residuals from subtraction close to the centroid of brighter sources are often apparent , caused by inaccurate alignment before subtraction and/or the changes in seeing / image quality or non - linear regime of the detector .",
    "we also found that inaccurate alignment before subtraction led to substantial inaccuracies in background measurement , so we used dozens of bright field stars to compute a shift as accurately as possible .",
    "figure [ fig : skysub]b shows one of the individual frames used in our analysis after imarith sky subtraction .",
    "sky subtraction takes place _ before _ performing photometry , so to assess the improvement to the results , we apply the same photometry technique used on frames without sky subtraction and compare the outcomes .",
    "we chose to implement the aperture correction photometry method ( section [ sec : photapcor ] ) because it is believed to produce more accurate results than the centered and off - center sky annulus methods described in sections [ sec : photcentered ] and [ sec : photoffcenter ] .",
    "field star photometry was performed on the frames before sky subtraction , and photometry on the target as performed after the subtraction .",
    "section [ sec : photimarith ] describes how sky subtraction can improve photometry by removing background contaminants , but constructing a sky composite is a sensitive function of determining the correct sub - pixel shift between stars in different frames and scaling the composite to match each frame .",
    "the isis software package @xcite , which internally determines shifts , median - combines frames , and subtracts the composite from individual images , was designed to do the best possible job of sky composite construction and subtraction . the main differences between using imarith and using isis to build a sky composite are that : ( 1 ) the isis composite must be built from frames with the best seeing , and ( 2 ) before subtracting the composite , isis convolves it with a kernel solution for the individual frame , matching the fwhm of the sources in the composite to the same sources in the individual frame .",
    "we made the isis sky composite from the five frames with the best seeing , with a mean seeing of @xmath52 compared to the remaining five frames mean seeing of @xmath53 .",
    "isis can also perform differential photometry after sky subtraction .",
    "although @xcite found that using isis instead of traditional aperture photometry did not improve photometry results for star clusters , @xcite noted an improvement by up to a factor of 20 in isis photometry over dophot .",
    "however , we were not able to fully adapt the isis software for moving objects , even when shifted stamps showing the object at the same position were manually constructed and fed into the algorithm . therefore , we could not make use of isis s photometry capabilities for our moving target ; instead , we only used it for sky subtraction .",
    "figure [ fig : skysub ] shows that isis offers considerable improvement over imarith in removing background sources .",
    "the standard deviation within an aperture radius of @xmath54 ( or 18 pixels ) at the location of subtracted field stars was reduced by a factor of @xmath55 by using isis rather than imarith to perform sky subtraction .",
    "source extractor ( hereafter sextractor ) is a photometry algorithm that was designed to quickly identify and classify field objects and to perform aperture photometry on both extended and point sources .",
    "we used sextractor 2.5.0 .",
    "one of the main differences between sextractor and other aperture photometry algorithms is that sextractor constructs a background map for the entire image rather than measure the background within a defined annulus for each object .",
    "the background map is locally determined over a defined mesh size , and pixels above a 3@xmath56 threshold within the mesh are iteratively discarded from the background computation until no pixels above this threshold remain . if the field is considered crowded ( _ i.e. _ , the sky noise drops less than 20% per iteration ) , then the final background within the mesh is computed in a different way from an uncrowded background @xcite .",
    "the final background map is a bi - cubic - spline interpolation over all regions . by visual comparison between the background map and an individual frame",
    ", we found that a mesh size of @xmath57 pixels and a smoothing - region size of 3 gave the most accurate background map .",
    "sextractor also offers flexibility in the aperture shape .",
    "there are five types of apertures available within sextractor , all of which were tested in this study : mag_aper , mag_auto , mag_iso , mag_isocor , and mag_best .",
    "the mag_aper option lets the user define a fixed circular aperture to place over all identified sources in a frame .",
    "we chose an aperture radius at @xmath26hwhm ( which theoretically encompasses 99.994% of the object s flux ) for each frame . using the mag_auto aperture choice",
    "will internally determine an aperture at the kron radius , defined as the radius that contains 90% of a source s flux , for each identified field source @xcite .",
    "the aperture s ellipticity and position angle with respect to a row is then computed via the second order moment on each object .",
    "mag_iso draws an aperture around all adjacent pixels above a defined detection threshold , making it highly flexible for irregularly - shaped psfs and extended sources .",
    "we chose a recommended detection threshold of 1.5@xmath56 above the background @xcite .",
    "the mag_isocor aperture type is a crude method of determining an aperture correction to the mag_iso magnitudes , assuming the object s psf is an axisymmetric gaussian @xcite .",
    "lastly , mag_best is a combination of mag_auto and mag_isocor ; when the neighboring source contamination reaches 10% , mag_isocor measurements are returned , otherwise mag_auto measurements are returned .",
    "the tphot routine has three basic components : ( 1 ) triggering on a potential object , ( 2 ) aperture photometry , and ( 3 ) psf fitting photometry .",
    "the trigger function identifies all pixels that are a local maximum out to a specified radius ( nominally 5 pixels ) and that exceed a threshold level ( specified as an absolute level or as a s / n above sky level and noise ) .",
    "tphot performs photometry on all triggered objects , but this these calculations may be rejected according to a number of tests , including inadequate s / n , a fitted centroid that moves from the brightest pixel , a profile that is too broad or narrow , etc .",
    "tphot offers the option of using an external file of object positions .",
    "the uncertainty in the photometry is based on a noise model that is implemented using two parameters , a gain ( e@xmath24/adu ) and a bias level .",
    "the `` bias '' level is subtracted from the image and the noise is then taken to be the square root of the number of electrons",
    ". the `` bias '' level can be negative if the image preprocessing has already subtracted a sky level , and it can be augmented according to read noise variance .",
    "the aperture photometry function of tphot performs a fit for the sky level near an object , and then calculates the total flux within a specified aperture , less the sky contribution . for maximum accuracy",
    "the aperture should be 1.5 fwhm in radius @xcite .",
    "for robustness in the presence of neighboring objects , tphot starts by calculating the median flux in annular rings around the object of interest .",
    "the sky level is determined by fitting the outermost rings beyond a specified radius with a constant plus @xmath58 object profile .",
    "the object flux is calculated as the sum of pixels within the aperture radius , less the sky level .",
    "this algorithm has proven to be very accurate and robust for bright objects and fields that may be somewhat crowded .",
    "the aperture photometry tool ( version 2.1.9 , hereafter apt ) is a relatively new algorithm intended as both a professional and an educational tool capable of performing straight - forward and accurate photometry @xcite .",
    "its main feature is its graphical user interface , encouraging visualization of the process and visual checks on aperture and sky annulus choices . because of its simplicity",
    ", apt was not designed for or tested on crowded fields .",
    "the user defines the sky annulus and the radius , ellipticity , and position angle of the photometric aperture .",
    "there are also options to remove the median or mean background , perform photometry in batch mode , define an aperture correction , and include / exclude manually - selected pixels from the aperture radius .",
    "apt only accepts integer input pixels , then upon the user s request , it internally recomputes the centroid to 0.01 pixel resolution . the apt help manual states that this sub - pixel centroiding may perform poorly , especially in more crowded fields .",
    "the user can also define rejection limits ( in counts ) above and/or below which sky annulus pixels are excluded from background determination .",
    "performing photometry manually for every field source was impractical because we had over 100 objects in our target list , so we chose to operate in batch mode , which meant using the same aperture and sky annulus settings across the entire frame .",
    "we chose a fixed circular photometric aperture of 18 pixels , inner - sky radius at 28 pixels , and outer - sky radius at 50 pixels ( the same settings used in section [ sec : photcentered ] ) .",
    "we also chose to perform median background subtraction and make use of the pixel exclusion feature to remove the cosmic ray hit in frame 1 ( fig .",
    "[ fig : images ] ) .",
    "we used the apt - computed sky level and sky sigma in the target s sky annulus to determine the @xmath59 rejection threshold for background determination in each frame .",
    "psf - fitting algorithms differ amongst themselves primarily in the way the model is stored for later use @xcite .",
    "some fit an analytic function ( gaussian , lorentzian , or a combination thereof ) while others determine an empirical psf model through numerical interpolation .",
    "some psf - fitting algorithms also offer a spatially - variable solution in case the psf varies across the chip . because psf - fitting routines theoretically exclude more background contamination from the source flux than an aperture , they offer a potential advantage in accuracy and precision of faint objects @xcite .",
    "a few comparison studies of psf - fitting algorithms have been published .",
    "@xcite found that daophot outperforms dophot by a factor of 1.5 - 4 in accuracy for fixed targets , but @xcite and @xcite noted that daophot can be susceptible to background source contamination .",
    "however , the usefulness of these algorithms for moving target photometry has not been explored .",
    "the fact that trailed field stars are used as templates for the psf model presents a problem to moving targets in that the model will not exactly represent the untrailed target .",
    "we investigate the accuracy and precision of the popular psf - fitting algorithms daophot and dophot and the profile - fitting capabilities of the new tphot algorithm .",
    "daophot is one of the most popular photometry algorithms .",
    "this software package operates within iraf and exploits the strengths of both analytic and empirical approaches to psf - fitting .",
    "first , an analytic function is fit to manually - inspected template stars without overlapping psfs , and errant pixels in the source psf ( either cosmic ray hits or bad pixels ) are down - weighted and local background is determined .",
    "six different types of analytic functions can be fit - gaussian , lorentzian , 2 modified lorentzians , and 2 gaussian @xmath44 lorentzians @xcite . the model that returns the lowest scatter",
    "is subtracted from each template star , and the average residuals are stored in a two - dimensional lookup table to account for any flux lost in the analytic model .",
    "the user can specify whether or not the psf varied across the chip , in which case daophot will compute additional lookup tables representing the linear or quadratic change in flux across the frame . to ensure that flux is not artificially enhanced or decreased due to spatially - variant lookup tables , the net volume of the higher - order tables is forced to be zero .",
    "the option for a spatially - variable model solution have sometimes been implemented with difficulty , even failing altogether as they did for us @xcite . for each field source",
    ", the model is scaled down to the flux within a defined fit radius ( usually the fwhm ) , and the psf model is iteratively fit to field sources .",
    "we altered the many input free parameters as recommended by the daophot reference guide , using the daoedit task to determine and define each image s fwhm , background , and sky noise @xcite .",
    "we defined the inner - sky radius as @xmath26fwhm , the outer - sky radius as @xmath60fwhm , and the radius within which the model computed for template stars is computed as @xmath61fwhm@xmath62 , following the @xcite suggestions . because the target was moving and we were comparing photometry for individual frames",
    ", we were unable to use daophot s allframe task , which performs photometry on a stacked image @xcite .",
    "dophot @xcite was developed as an alternative fitting algorithm to daophot , because determining the appropriate settings for each image and computing the model psf for daophot is very time - consuming .",
    "dophot requires minimal user interaction and optimizes speed ; we used version 4.1 .",
    "the user inputs estimates for the background , seeing , gain and read noise , which are used by the algorithm to identify sources above a defined threshold .",
    "these sources are fit with an analytical power - law function to determine a best - fit model , which is then subtracted from the frame .",
    "noise is added back to the black sky patches left after star subtraction to ensure that the patches resemble the sky noise .",
    "the detection threshold is then lowered to fit a model to fainter sources , which are then subtracted .",
    "the brighter sources already identified are added back into the frame and refit , now without possible contamination from faint sources .",
    "the improved model parameters are saved , and the magnitude , background , and poisson noise close to the source is recorded .",
    "these iterations continue for lower and lower thresholds ( _ i.e. _ , fainter objects ) until no additional stars are detected . a final model weighted by s / n is computed from all objects that are unambiguously identified as point sources , then all of the objects detected in the image are refit with the improved model .",
    "we used daoedit s background and fwhm measurements ( see section [ sec : daophot ] ) for the dophot input background and seeing estimates , respectively .",
    "otherwise , we preserved the default setting as recommended by the dophot manual @xcite .      after performing an aperture photometry calculation ( section [ sec : tphotap ] )",
    ", tphot also performs a psf fit to each potential object . using the position and crude fwhm from the aperture fit",
    ", tphot does a least - squares fit of an elliptical `` waussian '' ( gaussian truncated at the @xmath63 term ) profile .",
    "tphot can be requested to perform profile fits of two parameters ( flux and sky ) , four parameters ( plus position ) , or seven parameters ( plus psf shape ) .",
    "it also can fit a trailed profile , substituting trail length for major axis . the resulting major axis @xmath64 , minor axis @xmath65 , and peak value @xmath66",
    "can be multiplied to obtain a value @xmath67 that is proportional to the total flux of the waussian .",
    "depending on the application , tphot may be run multiple times .",
    "it is most commonly run once at a relatively high s / n threshold to obtain aperture photometry and psf profile shape parameters for bright stars .",
    "it is then rerun at a low s / n threshold and a four parameter fit , forcing all stars to a common psf profile .",
    "the @xmath67 value provides accurate , relative photometry for faint objects as well as bright ones , and the aperture photometry of bright stars from the previous iteration provides net fluxes .    in this image",
    "there are a comparable number of galaxies and stars ; a different galactic latitude or magnitude limit would be different .",
    "we did not attempt any automatic star - galaxy classification for this application .",
    "instead , we chose the objects whose major axis a falls below the median , and then use the median values of those objects for @xmath64 , @xmath65 , and @xmath68 as representative of stellar psfs .",
    "a mode of all values less than the median @xmath64 , @xmath65 , and @xmath68 would have also been suitable .",
    "measuring the change in aperture photometry of stars between different frames then correcting for the change put all images on the same photometric scale .",
    "the rms for these comparisons was less than 0.01 magnitude .",
    "although the target was trailed , its trailing amount was small enough relative to the seeing that we did not bother to use the trailed profile function of tphot .",
    "we were not able to test all existing photometry algorithms .",
    "@xcite find that the photo software used on the sloan digital sky survey performs high - quality photometry on both extended sources and field stars , but it is not portable or flexible and was thus not available to install .",
    "three other prominent photometry packages , isis , momf , and dia , could not be modified for use on data for a moving target , though they did offer promising improvements to our photometry results @xcite .",
    "these packages all perform photometry on fixed objects in median - sky subtracted images , identifying low - level deviations from the nightly median .",
    "the main advantage of these methods over traditional sky - subtraction is the process of convolving a `` best - seeing '' sky composite with the fwhm of individual frames before subtraction , so that the psfs match and no residual background source flux remains on the chip after subtraction , with the exception of saturated pixels ( see fig .",
    "[ fig : skysub ] and section [ sec : photisis ] ) . because the change in magnitude is measured from sky - subtracted images ,",
    "no absolute magnitude calibration is offered in any of these methods .",
    "these difference - image techniques may also present a challenge to moving targets in that the fwhm would not be the same for the target as the trailed stars , so the convolution would be incorrect and residual flux would always be present .",
    "section [ sec : photisis ] details how we were unable to adapt the promising isis software for our moving target .",
    "we assumed we would experience the same difficulties implementing the other difference image techniques , so we did not attempt to run them .",
    "the potential of these difference - frame algorithms to optimize accuracy and precision begs that they be made adaptable to moving objects .",
    "for each algorithm , we use the rms of the residuals against the light curve model as a diagnostic for magnitude accuracy , and the @xmath69 statistic as a measure of how reasonable the magnitude uncertainties are .",
    "section 2 explains the model s origin .",
    "figure [ fig : summary ] plots the results of all algorithms against the model light curve , shown in order of least to greatest rms of the residuals .",
    "we also report @xmath30 to determine how much systematic bias is incurred in each algorithm and @xmath28 ( calculated using the @xmath30 determined for each frame and the target - specific @xmath29 reported by each algorithm ) , which assesses the precision of the results .",
    "if the magnitudes themselves are accurate and all systematic errors have been accounted for , then @xmath69@xmath70 . if @xmath69@xmath71 , then the errors ( including systematics ) are overestimated , but if @xmath69@xmath72 , either the magnitudes are inaccurate or @xmath28 is still underestimated .",
    "table [ tab : stats ] lists the rms of the residuals , the @xmath69 , @xmath28 , and @xmath30 for each implementation .",
    "figure [ fig : summary ] and table [ tab : stats ] show that the widely - used aperture photometry algorithm phot generally performed poorest of all other algorithms tested , with or without subtracting a sky composite with imarith .",
    "we saw no change in the results by using a manually - placed , off - center sky aperture as opposed to a centered sky annulus , presumably as long as the sky measurements were made relatively close to the target ( fig .",
    "[ fig : summary]m vs. fig .",
    "[ fig : summary]n ) .",
    "aperture correction gave an improvement in rms by a factor of 2.5 over using an aperture that encompassed 99.5% of the flux , making it comparable to sextractor results .",
    "since the sky was measured in phot in the same way before or after sky subtraction , the improvement in rms must be caused by a more accurate accounting of source flux .",
    "the two phot algorithms that involved subtracting a sky composite to remove faint background contamination before performing photometry ( sections [ sec : photcentered ] and [ sec : photoffcenter ] ) generally rendered a larger light curve amplitude than the model , which increased the rms of the residuals and @xmath69 ( fig .",
    "[ fig : summary]f and fig .",
    "[ fig : summary]o ) .",
    "visual inspection shows that the isis - processed images contain one exceptionally deviant data point at @xmath73 .",
    "this data point corresponds to frame 1 in figure [ fig : images ] , where a cosmic ray hit that was missed in initial cosmic ray correction is seen close to the target .",
    "it may be that the cosmic ray hit compromised the photometry more so in the isis - treated frames than in results from other realizations of phot , though there is no clear explanation for why this would be the case .",
    "also , the cosmic ray removal routine that we used obviously did not correct for all hits because it was designed to flag point source cosmic ray hits ( _ e.g. _ , single pixels ) rather than grazing hits such as the one in fig .",
    "[ fig : images ] .",
    "thus , the routine may have left additional faint contaminants near the target psf and affected the accuracy of the photometry . only after removing the anomalous data point at @xmath73 from analysis did isis sky - subtraction render a rms comparable to the other phot aperture correction algorithms .",
    "subtracting the sky with imarith before applying an aperture correction offered no improvement in rms , likely because contaminants were already sufficiently removed from source flux measurements by using a smaller aperture .",
    "we speculate that if the background within the sky annulus contained more faint sources , then performing imarith sky subtraction would offer further improvement in accuracy before using aperture correction .",
    "the @xmath69 @xmath74 for all phot algorithms , especially the two algorithms involving sky subtraction ( table [ tab : stats ] ) , comes from incorrect magnitude measurement , background determination , and/or noise models . to test whether or not the background was correctly determined and subtracted ,",
    "we repeated the centered sky annulus method ( section [ sec : photcentered ] ) with successively larger apertures ; if the background was overestimated , then the magnitude measured would become steadily fainter toward larger radii , and vice versa @xcite .",
    "we found that the magnitude stayed the same , only the magnitude uncertainty changed using larger aperture radii , implying that background subtraction was done correctly .",
    "phot calculates the magnitude uncertainty from the photon noise within the aperture and the standard deviation within the sky annulus , and it includes a term to account for uncertainty in the background level .",
    "since we find that background subtraction was done properly , we assume that the standard deviation measurement within the sky annulus is also correct . with sky subtraction",
    ", we found that the standard deviation of the background was reduced by a factor of 2 , which consequently gave a smaller magnitude uncertainty and even larger @xmath69 .",
    "if the aperture contained contamination from background sources , however , then both the source flux and aperture s photon noise would be inaccurate , the magnitude more so .",
    "such an effect would manifest as slightly large @xmath28 and even larger rms , which is what we see in the phot results .",
    "the factor of @xmath75 improvement in rms by using a smaller photometric aperture but measuring the background in the same way provides further evidence that background contamination within the aperture is significant .",
    "@xcite compared apt to sextractor s mag_aper , noting overall agreement between the two algorithms .",
    "we do not find the same result here , possibly indicative of apt s limitations toward fainter objects .",
    "table [ tab : stats ] shows that apt s residual rms is roughly twice that of mag_aper , though the @xmath69 is slightly larger due to the slightly smaller @xmath28 and much larger rms . to investigate the cause of the large rms , we tested for correct background determination by checking that the source flux stayed constant in several aperture radii beyond the original 18-pixel radius .",
    "we saw that as we increased the aperture size , the source flux continued to decrease , indicating that the background was overestimated .",
    "incorrect background determination can lead to inaccurate measurement of source flux and background uncertainty , which then increase the rms and @xmath69 .",
    "some photometry inaccuracy may stem from incorrect sub - pixel shifts , as noted in the apt manual @xcite .",
    "like phot , apt also appears to do a poor job of systematically excluding faint background contamination from the aperture .",
    "we found that apt measured the largest target flux within a 10-pixel radius of all aperture photometry algorithms , even with the background overestimated , implying background contamination .",
    "the dophot results are given in figure [ fig : summary]l and table [ tab : stats ] .",
    "the comparably large rms shows that dophot did not do a good job of reproducing the model , performing worst of the psf - fitting algorithms but slightly better than phot s non - aperture correction algorithms .",
    "magnitude uncertainties are also relatively large compared to the algorithms tested here .",
    "we suspect that the main sources of error for both magnitudes and uncertainties are that ( 1 ) dophot psf - fitting fails at accurately modeling the psf of a trailed field star , and ( 2 ) dophot is too inclusive in psf model computation .",
    "if a field contains many irregularly - shaped , compromised , and/or extended sources , then the final model may be significantly affected . due to",
    "dophot s limited user interaction , we could not further explore the role of potentially incorrect background determination , insufficient uncertainty estimates , and/or contamination in increasing the rms and @xmath69 .",
    "the @xmath30 was also the largest of all algorithms tested , indicating that a substantial amount of systematic bias was incurred .",
    "table [ tab : stats ] shows that sextractor improved the rms by a factor of @xmath76 over phot ( except for the aperture correction algorithm ) and @xmath77 over apt and dophot , implying better magnitude accuracy . of the sextractor aperture choices",
    ", mag_isocor delivered the lowest rms but relatively unchanged @xmath28 , meaning it offered an improvement in accuracy but not in precision .",
    "mag_isocor determines an aperture correction to the mag_iso magnitude measurements ( fig .",
    "[ fig : summary]h ) , and the aperture correction technique was already shown in section [ sec : discphot ] to be more accurate than using a large aperture to add up source photons , so it is unsurprising that mag_isocor provided an improvement in rms and @xmath69 over mag_iso ( table [ tab : stats ] ) .",
    "@xcite noted that in isophotal mode , the position and shape of sources detected in sextractor may be systematically inaccurate toward fainter magnitudes , but given the success of mag_iso and mag_isocor here , our target must not have been faint enough to be affected .    the mag_aper choice ( fig .",
    "[ fig : summary]j ) gave the smallest @xmath69 , owing to it having a relatively large @xmath28 and a minimally different rms .",
    "this finding suggests that a fixed circular aperture can include significant amounts of background , adding more background uncertainty to the final error . the mag_auto aperture option ( fig .",
    "[ fig : summary]g ) offered essentially no improvement in accuracy but improvement in precision by a factor of @xmath78 over mag_aper , implying that it was more effective at excluding pixels that do not contain source flux .",
    "the mag_best results were almost identical to the mag_auto results , meaning that the field was relatively uncrowded ( table [ tab : stats ] ) .    despite sextractor s general success over other aperture photometry algorithms ( except tphot ) at accurately reproducing the model light curve , the @xmath69 was comparably large .",
    "a smaller rms but larger @xmath69 suggests that the magnitude uncertainties are underestimated . pointed out that the uncertainty in the local background estimate ( which is notably complex ) was not included in the final reported magnitude .",
    "we therefore assume that this exclusion made the magnitude uncertainties in our experiments artificially and significantly small . because the degree to which the magnitude uncertainties are artificially small is unknown , it is difficult to determine whether or not inaccuracy of the sextractor magnitudes also contribute to the large @xmath69 value .",
    "the daophot results are given in figure [ fig : summary]c and table [ tab : stats ] , which shows that daophot is the third - most accurate algorithm tested , behind the two tphot algorithms .",
    "the @xmath28 is comparably small , indicating good isolation of source flux , though the small @xmath69 value may indicate that the magnitude uncertainty is still overestimated .",
    "@xcite noted that systematic errors stem from inadequate correction factors in the wings of the model psf , and that daophot consistently underestimated the uncertainties by @xmath79% , which is inconsistent with our results .",
    "we suspect that the underestimation they noted was for brighter objects , where the intricacies of the true psf may be poorly reproduced by the model .",
    "the @xmath30 in our results was relatively small , suggesting minimal systematic bias compared to other algorithms .",
    "the somewhat small amount of trailing in the template stars did not seem to affect the accuracy of the psf model s fit to the target .",
    "we hypothesize that because the trailing was within the expected seeing disc , daophot s analytic functions had no difficulty computing a model that was applicable to both the trailed template stars and the untrailed target .",
    "we tried using daophot to build a model from moving - object frames where the stars showed more pronounced trailing ( @xmath80 , or trailing aspect of @xmath81 ) , but the @xmath69 fit of the model to the untrailed target was @xmath82 per frame , clearly indicating that the template stars were too trailed to reasonably match the target s psf .",
    "in contrast , the average @xmath69 of daophot fits to the 1996 to@xmath0 data was 1.84 .",
    "@xcite found that performing aperture photometry within daophot ( the same as aperture photometry with phot described in section [ sec : phot ] ) rendered more accurate results than daophot s psf - fitting routine because the flux of faint objects is increasingly underestimated toward fainter magnitudes .",
    "because our results do not reflect this flux inaccuracy , we assume that 1996 to@xmath0 was bright enough ( s / n @xmath83 from daophot ) for this not to be a factor .",
    "results from the tphot psf - fitting and aperture photometry algorithms are shown in figures [ fig : summary]a and [ fig : summary]b , respectively , and in table [ tab : stats ] .",
    "the low rms value shows that tphot produced the most accurate results of any algorithm tested .",
    "the tphot psf - fitting algorithm returned the lowest @xmath28 of all algorithms tested , implying excellent precision , but @xmath69 @xmath84 suggests that the errors may be very slightly underestimated .",
    "visual inspection of the results in fig .",
    "[ fig : summary]a shows that the uncertainties on magnitudes are consistent with the model , except for one data point at @xmath85 ( corresponding to frame 3 in fig .",
    "[ fig : images ] ) , which is the likely cause of the large @xmath69 .",
    "we can find no reason to exclude this point from analysis unless the model is poorly constrained at this particular rotation phase or the target psf contains unavoidable deviant pixels .",
    "removing this point gives @xmath69 @xmath86 , exactly what it should be if the data accurately represent the model , so either the questionable data point is compromised in some way or tphot is reporting inaccurately .",
    "given the success of tphot at reproducing the model at all other phases , we assume the problem is not with the algorithm itself and rather with the data , possibly due to a bad pixel missed during bad pixel mask construction . despite the target psf",
    "not appearing especially radially - isotropic in the images ( _ e.g. _ , some frames were out of focus ; fig .",
    "[ fig : images ] ) , tphot did not exclude asymmetric flux within the circular aperture annuli by computing the median .",
    "tphot s aperture photometry gave a @xmath69 @xmath87 for all data and @xmath69 @xmath88 if we exclude the data point at @xmath85 , despite a relatively small @xmath28 , meaning the magnitudes and uncertainties are a good representation of the model .",
    "we also note that the low @xmath30 implies that the tphot aperture photometry technique incurs little systematic bias compared to all algorithms explored ( except daophot , which has a similarly low mean @xmath30 ) . for these reasons",
    ", we have no reason to suspect any errors in the tphot aperture photometry routine .",
    "the tphot algorithm produces the best photometry results for our faint moving target , improving rms very minimally over daophot , and by a factor of @xmath89 over sextractor , @xmath90 over apt , @xmath91 over dophot , and @xmath92 over iraf s phot .",
    "tphot s success is likely thanks to its careful treatment of the centroid , exclusion of contamination within the photometric aperture , and use of an iteratively - refined waussian function .",
    "an updated version of tphot is currently under construction to better handle significantly trailed objects .",
    "daophot produced the next - best results , giving the same accuracy as tphot s aperture photometry algorithm ( largely due to careful accounting of source flux ) but overestimated errors .",
    "while offering a distinct advantage in speed , sextractor generally underestimates magnitude uncertainties , likely because of exclusion of error in the background determination .",
    "the mag_isocor aperture technique renders the most accurate and precise magnitude measurements amongst the sextractor options because as an aperture correction technique , it more carefully isolates target flux and excludes contaminants .",
    "iraf s phot algorithm can only accurately measure magnitudes of a moving target if an aperture correction technique is used ( without sky subtraction ) , though it returns median uncertainties @xmath93 times larger than what could be achieved with tphot .",
    "although the background was measured correctly , phot did not exclude background contaminants from within the aperture , giving inaccurate photometry .",
    "the apt algorithm , while fairly flexible and excellent as a visualization and educational tool , was outperformed by all other software except dophot and a few phot algorithms .",
    "apt struggles with both accurately measuring the background and with systematically excluding contaminants from within the photometric aperture .",
    "we suggest that apt is better suited for photometry on brighter objects .",
    "dophot performed slightly worse in both accuracy and precision compared to apt .",
    "we deduce that its fitting routine was not able to as accurately produce a psf model possibly because it included too many field sources in its construction of a model psf and/or it was very sensitive to trailed psfs .    at some point",
    ", trailing will be significant enough for the psf peak to be two - dimensional ( _ i.e. _ , a line rather than a point ) . in these cases",
    ", the ideal aperture would be the same shape of the target psf to exclude as much background contamination as possible .",
    "techniques that only allow a circular aperture such as tphot , sextractor s mag_aper , and phot will incorporate large amounts of background contamination with an aperture that encompasses the extent of the trailed psf . the elliptical aperture allowed by apt and sextractor s",
    "mag_auto and mag_best may be a good approximation to the target shape if trailing is minimal ( _ e.g. _ , our data ) , but at some point , trailing may be significant enough for an ellipse s axes to extend well beyond the psf . the only aperture photometry technique that we tested that places no restrictions on target shape are sextractor s mag_isocor and mag_iso , which we consequently predict will be most suitable of the techniques tested here for aperture photometry of significantly trailed objects .",
    "these findings could be more statistically robust if we had more images of 1996 to@xmath0 , which would eliminate the dependency on a relatively small sample size of n @xmath94 .",
    "as such , our results are only applicable to data sets similar to ours  for slow - moving objects with s / n @xmath13 ( according to uncertainties given by our most precise algorithm ) , mostly because no other images for a moving object with a well - determined light curve described by a shape model were available to us at the time",
    ". it would be useful to test these algorithms on other objects with ( 1 ) brighter targets to determine at what point aperture photometry starts to outperform psf - fitting because of more well - defined intricacies in the psf morphology that are not reproduced by analytic functions , and ( 2 ) a range of trailing aspects to determine the aspect beyond which photometric accuracy becomes significantly compromised .",
    "@xcite tested the latter for a 2-dimensional symmetric gaussian function and a square aperture 3@xmath95fwhm , finding a @xmath88 and 0.5 magnitude loss , respectively , at a trailing length of 3@xmath95fwhm , but this experiment should be repeated for popular algorithms .",
    "psf - fitting routines suffer similar challenges to accurately representing the target psf as aperture photometry .",
    "techniques that fit a radially - isotropic function to the data will fail in recovering the true psf shape , but no profile - fitting technique that we tested makes this assumption of radial isotropy .",
    "allowing for an elliptical analytic function is a first - order approximation to representing the true psf shape of minimally - trailed data , and all of the psf - fitting techniques we tested have this feature .",
    "however , rather than a single function calculated at the centroid , a trailed psf might be best represented by the sum of a series of analytic functions calculated at different increments along the direction of motion , such as a trailed gaussian given in its analytic form by @xcite .",
    "however , this technique has not yet been adapted into software available to the public .",
    "existing psf - fitting algorithms can not calculate a series of different functions for a single trailed source , so we suspect that in the event that an ellipse is no longer a good approximation to the psf shape and until trail - fitting algorithms are made available , all psf - fitting packages will fail at accurately representing the psf . therefore , of all the techniques tested here ,",
    "sextractor s mag_iso and mag_isocor are likely the only ones capable of performing accurate photometry on significantly trailed psfs .",
    "this material is based upon work supported by the national aeronautics and space administration by nasa grant nos .",
    "nag5 - 4495 , nnx07a044 g , nnx07af79 g , and from the national science foundation through grant ast-1010059 .",
    "partial support for this work was provided by national science foundation grant ast-1009749 .",
    "initial image processing in this paper has been performed using the iraf software .",
    "iraf is distributed by the national optical astronomy observatories , which is operated by the association of universities for research in astronomy , inc .",
    "( aura ) under cooperative agreement with the national science foundation .    , c. ( 2000 ) . .",
    "in l.  szabados and d.  kurtz , editors , _ iau colloq .",
    "176 : the impact of large - scale surveys on pulsating star research _ ,",
    "volume 203 of _ astronomical society of the pacific conference series _ ,",
    "pages 5055 .                      ,  . , lupton , r.  h. , schlegel , d. , boroski , b. , adelman - mccarthy , j. , yanny , b. , kent , s. , stoughton , c. , finkbeiner , d. , padmanabhan , n. , rockosi , c.  m. , gunn , j.  e. , knapp , g.  r. , strauss , m.  a. , richards , g.  t. , eisenstein , d. , nicinski , t. , kleinman , s.  j. , krzesinski , j. , newman , p.  r. , snedden , s. , thakar , a.  r. , szalay , a. , munn , j.  a. , smith , j.  a. , tucker , d. , and lee , b.  c. ( 2004 ) .",
    ", * 325 * , 583589 .          , r.  r. , rebull , l.  m. , gorjian , v. , masci , f.  j. , fowler , j.  w. , grillmair , c. , surace , j. , mattingly , s. , jackson , e. , hacopeans , e. , hamam , n. , groom , s. , teplitz , h. , mi , w. , helou , g. , van eyken , j.  c. , law , n.  m. , dekany , r.  g. , rahmer , g. , hale , d. , smith , r. , quimby , r.  m. , ofek , e.  o. , kasliwal , m.  m. , zolkower , j. , velur , v. , walters , r. , henning , j. , bui , k. , mckenna , d. , and kulkarni , s.  r. ( 2012b ) .",
    ", * 124 * , 764781 .      , r.  h. , ivezic , z. , gunn , j.  e. , knapp , g. , strauss , m.  a. , and yasuda , n. ( 2002 ) . . in j.  a. tyson and s.  wolff , editors , _ society of photo - optical instrumentation engineers ( spie ) conference series _",
    ", volume 4836 of _ society of photo - optical instrumentation engineers ( spie ) conference series _ , pages 350356 .    , m. and schechter , p.  l. ( 1989 ) . in p.",
    "j. grosbl , f.  murtagh , and r.  h. warmels , editors , _ eso / st - ecf data analysis workshop _ ,",
    "volume  31 of _",
    "european southern observatory conference and workshop proceedings _ , pages 6983 .      , p.  b. ( 1992 ) . .",
    "in d.  m. worrall , c.  biemesderfer , and j.  barnes , editors , _ astronomical data analysis software and systems i _ , volume  25 of _ astronomical society of the pacific conference series _",
    ", page 297 .      , d. ( 1986 ) . .",
    "in d.  l. crawford , editor , _ society of photo - optical instrumentation engineers ( spie ) conference series _ ,",
    "volume 627 of _ society of photo - optical instrumentation engineers ( spie ) conference series _",
    ", page 733 .          )",
    "is given as @xmath28 in the upper right corner , along with the target s magnitude , range of magnitudes of the comparison stars , number of comparison stars within this range , and computed systematic error ( @xmath30 ) .",
    "the systematic error calculation is described in more detail in section [ sec : processing ] .",
    "the differential field star magnitudes are well fit by a gaussian , rendering reasonable systematic error computations .",
    "[ fig : syserr],width=624 ]     and [ sec : photisis ] ) .",
    "the moving target has a dashed circle placed around it in each panel .",
    "the size and orientation is the same for all panels .",
    "a ) the original frame before sky subtraction .",
    "b ) the residuals of composite subtraction performed with iraf s imarith task , which subtracted a median - combined reference sky image from individual frames .",
    "the negative spots are residuals left from field stars after subtraction and are likely caused by inadequate alignment and/or composite scaling before subtraction .",
    "c ) sky subtraction residuals using isis software , which convolves a `` best - seeing '' sky composite with a spatially - variable kernel representative of the individual frame s fwhm in order to match the image quality before subtraction .",
    "isis subtraction shows a noticeable improvement over imarith subtraction in fully removing background sources .",
    "[ fig : skysub],width=796 ]      llllll & panel & & & mean & mean + technique & in fig .",
    "[ fig : summary ] & rms & @xmath69 & @xmath28 & @xmath30 + tphot , fit photometry & a & 0.030 & 1.436 & 0.031 & 0.012 + tphot , ap .",
    "photometry & b & 0.031 & 1.488 & 0.032 & 0.008 + daophot & c & 0.031 & 0.561 & 0.044 & 0.010 + sextractor , mag_isocor & d & 0.058 & 2.501 & 0.045 & 0.027 + phot , ap .",
    "corr . & e & 0.060 & 1.855 & 0.049 & 0.021 + phot , ap .",
    ", imarith subtraction & f & 0.062 & 3.296 & 0.039 & 0.018 + sextractor , mag_auto & g & 0.063 & 2.985 & 0.047 & 0.023 + sextractor , mag_iso & h & 0.064 & 5.062 & 0.046 & 0.032 + sextractor , mag_best & i & 0.064 & 3.008 & 0.050 & 0.028 + sextractor , mag_aper & j & 0.068 & 1.342 & 0.101 & 0.066 + apt & k & 0.125 & 1.858 & 0.085 & 0.026 + dophot &",
    "l & 0.141 & 2.145 & 0.090 & 0.082 + phot , off - center sky annulus & m & 0.159 & 2.413 & 0.085 & 0.048 + phot , centered sky annulus & n & 0.161 & 2.655 & 0.089 & 0.048 + phot , ap .",
    ", isis subtraction & o & 0.255 & 14.840 & 0.048 & 0.025 +"
  ],
  "abstract_text": [
    "<S> previous studies determining which astronomical photometry software is best suited for a particular dataset are usually focused on speed , source classification , and/or meeting a sensitivity requirement . for faint objects in particular , the priority is given to maximizing signal - to - noise . </S>",
    "<S> photometry of moving targets offers additional challenges ( i ) to aperture photometry because background object contamination varies from image to image , and ( ii ) to routines that build a psf model from point sources in the image because trailed field stars do not perfectly represent the psf of the untrailed target . here , we present the results of testing several photometry algorithms ( tphot , daophot , dophot , apt , and multiple techniques within source extractor and iraf s phot ) on data for a faint , slow - moving solar system object with a known light curve . </S>",
    "<S> we find that the newly - developed tphot software most accurately and precisely reproduces the object s true light curve , with particular advantages in centroiding , exclusion of contaminants from the target s flux , and fitting flux in the wings of the point - spread function . </S>"
  ]
}