{
  "article_text": [
    "in image formation there are two important parts , the geometry of how points in space map to image locations and the photometry of how illumination , surface reflectances and camera sensors combine to form the colors in an image .",
    "broadly , the mathematical tools underlying our understanding of image geometry are non - linear reflecting the non - linear perspective nature of image formation .",
    "important non - linear concepts include  solving for the homography ",
    "( e.g. relating subsequent frames in panorama stitching  @xcite ) and epipolar geometry in stereo vision  @xcite ) .",
    "in contrast , the majority of methods in color / photometric computer vision are linear which , at least for simplified scenes such as the eponymous mondrian world  @xcite ( the world consists of a patchwork of flat co - planar reflectances ) , reflects the physics of how images are formed .",
    "linear color problems include , color correction  @xcite ( e.g. mapping raw colors from camera to display rgb ) and modeling illuminant color change  @xcite e.g. for color object recognition  @xcite .        in geometry computer vision ,",
    "an homography relates two planes . in figure",
    "[ fig : balls]a , @xmath0 and @xmath1 might denote the same 3d plane viewed in two different images related by the homography @xmath2 . in color",
    ", an homography relates two _ photometric _ views . in figure",
    "[ fig : balls]b , ball_1 is the image of the side - view of a 4-color ball where the ball is lit from behind the camera with a white light .",
    "the same ball is lit from above with a bluish light , image ball_2 .",
    "the images are in pixel - wise correspondence .",
    "we first color correct ball_2 to match ball_1 by using linear regression .",
    "its results is shown in image ball_3 where the colors are incorrectly mapped and the red color segment looks particularly wrong .",
    "ball_4 shows the results of correcting ball_2 by solving for the homography , visually there is much better color correction .    in this paper",
    ", we propose that to map one _ photometric _ view to another we must map the colors correctly independent of shading .",
    "since shading only affects the brightness , or magnitude , of the rgb vectors , it is possible to find the @xmath3 map which maps the color _ rays _ ( the rgbs with arbitrary scalings ) in one photometric view to corresponding rays in another .",
    "we note that this  ray matching  is precisely the circumstance in geometric mapping for co - planar and corresponding points in two images  @xcite .",
    "an rgb without shading can be encoded as the rg - chromaticity coordinate . in figure",
    "[ fig : balls]c , the 4 reflectances from the ball correspond to 4 points in an rg - chromaticity diagram which define the quadrilaterals shown in the left and right of the panel ( for respectively for the images ball_2 and ball_1 ) .",
    "the mapping between the two chromaticity diagrams is an homography .",
    "we show that the color calibration problem ",
    "mapping device rgbs recorded for a color chart to corresponding xyzs  can be formulated as a homography problem .    in real images of a color chart",
    "the shading can vary from one side to the other and not accounting for this shading variation can result in an incorrect calculation of the color correction matrix  @xcite .",
    "methods exist for solving for color correction independent of shading including minimizing the singular fitting error  @xcite or an alternating least - squares ( als ) approach where one successively and iteratively solves for the color correction metric and the shading  @xcite .    according to this paper",
    "the correct formalism for color correction independent of shading is to solve for the homography relating the image colors of a color chart to , for example , corresponding xyz measurements . unlike linear methods finding the best homography , disadvantageously , requires an iterative approach but advantageously allows different error metrics to be used ( not just least - squares error ) .",
    "compared to respectively , simple least - squares and the prior - art als method , homography - based correction delivers a 40 and 10% performance increment .",
    "for the geometric planar homography problem , we write : @xmath4^\\intercal = \\left [ \\begin{array}{c } x'\\\\ y'\\\\ 1 \\end{array } \\right ] ^\\intercal \\left [ \\begin{array}{ccc } h_{11 } & h_{12 } & h_{13 } \\\\",
    "h_{21 } & h_{22 } & h_{23 } \\\\ h_{31 } & h_{32 } & h_{33 }   \\end{array } \\right ] \\;\\triangleq\\ ; \\underline{x}=h(\\underline{x } ' ) \\label{eq : homography}\\ ] ] in equation  [ eq : homography ] , @xmath5 and @xmath6 denote corresponding image points  the same physical feature  in two images . in homogeneous coordinates the vector [ @xmath7 $ ] maps to the coordinates @xmath8 $ ] and so , in equation  [ eq : homography ] , the scalar @xmath9 cancels to form the image coordinate @xmath5 . for all pairs of corresponding points @xmath5 and @xmath6 that lie on the same plane in 3 dimensional space , equation  [ eq : homography ] exactly characterises the relationship between their images  @xcite . to solve for an homography ( e.g. for image mosaicking ) ,",
    "we need to find at least 4 corresponding points in a pair of images .",
    "let us map an rgb @xmath10 to a corresponding rgi ( red - green - intensity ) using a @xmath11 matrix @xmath12 : @xmath13^\\intercal \\left [ \\begin{array}{ccc } 1 & 0 & 1\\\\ 0 & 1 & 1\\\\ 0 & 0 & 1 \\end{array } \\right ] = \\left [   \\begin{array}{c } r\\\\ g\\\\ r+g+b \\end{array } \\right ] ^\\intercal    \\end{array } \\label{eq : chromaticity_conversion}\\ ] ]    the @xmath14 and @xmath15 chromaticity coordinates are written as @xmath16 interpreting the right - hand - side of equation  [ eq : chromaticity_conversion ] as a homogeneous coordinate we see that @xmath17 $ ] . in the following proof it is useful to represent 2-d chromaticities by their corresponding 3-d homogeneous coordinates .",
    "chromaticities across a change in capture condition ( light color , shading and imaging device ) are a homography apart .",
    "first we assume that across a change in illumination or a change in device where the shading is the same ( for the mondrian - world ) the corresponding rgbs are related by a linear transform m. clearly , @xmath18 maps colors in rgi form between illuminants . due to different shading ,",
    "the rgi triple under a second light is represented as @xmath19 , where @xmath20 denotes the unknown scaling . without loss of generality",
    "let us interpret as a homogeneous coordinate i.e. assume its third component is 1 .",
    "then , @xmath21=h([r\\;g])$ ] ( chromaticity coordinates are a homography @xmath22 apart ) .    in geometry , homographies are applied for mapping spatial coordinates in one image to correspondences in another . in color , we apply homography to shading independent color correction  the homography that maps 3d colors to 3d color matches . as an example we find the 3x3 matrix that best maps the shading dependent rgbs in the image of a color target and",
    "map them to the corresponding xyzs in a way that is independent of the shading .",
    "we can visualize solving for the homography as finding the best linear relation that maps chromaticities in one viewing condition to another .",
    "where by linear means we map 2d chromaticities to corresponding 3d rays , apply the @xmath3 matrix , and then recompute chromaticities .",
    "in figure  [ fig : chart ] , we show the picture of an image in the raw rgb space of a camera and the corresponding reproduction when the colors are corrected for display .",
    "professional imaging scientist might take a picture of a color checker and a second picture of a uniform gray target with same size in the same location . by dividing the rgb image of the checker by the image of the gray - target",
    "the shading is removed and then the shading corrected rgbs can be mapped to known reference display color coordinates using simple least - squares . however , this two - step approach is inconvenient and in some cases can not be done at all ( e.g. in an on - going surveillance situation ) .",
    "therefore , if a color chart is not used we must solve for the @xmath3 color correction matrix by solving for the homography .",
    "suppose @xmath23 and @xmath24 denote respectively @xmath25 matrices of @xmath26 corresponding pixels with respect to a set of captured rgbs and a corresponding set of xyzs . and , due to the relative positions of light and surfaces , the per - pixel shading intensities of the rgb set are usually different . assuming the lambertian image formation , @xmath27 where @xmath28 is an @xmath29 diagonal matrix of shading factors and @xmath2 is a @xmath11 color correction matrix . in @xcite this equation",
    "is solved by using alternating least - squares ( als ) described in algorithm  [ alg : als ]    @xmath30 , @xmath31    where @xmath32 and @xmath33 are iteratively and successively minimized .",
    "the effect of the individual @xmath33 and @xmath32 can be combined into a single matrix @xmath34 and @xmath35 .",
    "the homography computed here ( not because we calculate the shading we find the color correction independent of shading ) attempts to minimize a least - squares error .",
    "however , as we know the output of color correction might be better assessed with reference to perceived error .",
    "for example we might compare the color corrected rgbs with the corresponding xyzs using cie l*a*b * or cie l*u*v *  @xcite .",
    "other prior art  @xcite searches for the best color correction method and with respect to that framework the practitioner can choose the error metric used .",
    "however , because , in this paper , we have made the link to homographies we prove that the apposite tool is to use a particular robust searching technique  used frequently in geometric computer vision  called ransac .      to solve for a homography we need 4 corresponding sets of chromaticities ( e.g. the rg and xy chromaticities for the rgbs and xyzs ) .",
    "we might then test how good this homography is for mapping the rg and xy chromaticities . in this paper",
    "we are interested in fitting a homography that minimizes a perceptual error and in line with  @xcite we first choose cie l*u*v*. it then makes sense to measure the goodness of fit by comparing actual and fitted u*v * coordinates .",
    "the number of chromaticities that are fitted within a criterion error are said to belong to a consensus set .",
    "we iteratively find a homography using match sets of 4 corresponding rg and uv chromaticities and measure the size of the chromaticity error and the size of the consensus set .",
    "we keep sampling until the best consensus set is sufficiently large or we have reached the maximum number of trials ( in which case we choose the homography that has the lowest error ) .",
    "ransac stands for `` random sampling consensus '' .",
    "a key advantage of ransac is that it is a robust statistical estimator  @xcite .",
    "however , due to the randomness nature of ransac , our color correction does not always give the `` best '' solution .",
    "ransac also assumes that the majority of data are inliers whose distribution can be explained by a set of model parameters .",
    "in figure  [ fig : chart ] left we show a raw image and the color corrected counterpart ( with tone mapping ) in the right .",
    "we wish to evaluate color correction when shading varies across the color target ( in this case a macbeth color checker ) .",
    "we adopt the following experimental methodology .",
    "first we measure , in the lab , the actual ground truth xyzs .",
    "second we , in situ , measure the rgbs in a raw image where the shading can vary across the chart .",
    "we now solve directly for the correction matrix mapping the rgbs to xyzs .",
    "we do this using simple least - squares and using two homography methods .",
    "first , we use the alternating least - squares method and second the ransac homography method .",
    "we apply the three computed correction matrices ( least - squares , als and ransac ) to the rgbs form the checker where the effects of intensity variation has been removed .",
    "the intensity variation is removed by dividing by the brightness image of a uniform grey checker images in the same location in the same scene .    in evaluating our algorithms",
    "we will use both cie l*a*b * and cie l*u*v*. this said it is important to reiterate how we solve for the correction matrices .",
    "the least - squares matrix is found by minimizing the mapping from rgb to xyz .",
    "the als method also minimizes the fit to xyz but finds the best homography ( shading independent linear fit ) .",
    "the ransac method is a robust fitting strategy which directly minimizes cie l*u*v * chromaticity error .    for evaluation",
    ", we use 3 images that were taken around a local historical site that is popular with amateur and professional photographers alike ( e.g. figure  [ fig : chart ] ) .",
    "the mean , median , 95% quantile and max @xmath36e errors are reported in table  [ tab : calibration_error ] and table  [ tab : calibration_error_luv ] .",
    "it is clear that ransac - homography - based color correction supports a significantly improved color correction performance compared with the simple least square ( all error measures are about 40% improved ) . compared with the als color correction , all mean errors are improved by about 10% , and all median errors are improved by about 20% , at the cost of getting slightly higher 95% quantile error and maximum error .    .cie",
    "@xmath36e l*a*b * error [ cols=\"<,^,^,^,^\",options=\"header \" , ]",
    "in this paper , we shown the surprising result that colors across a change in viewing condition ( changing light color , shading and camera ) are related by a homography .",
    "our ransac - based color homography color correction is robust to outliers and delivers improved color fidelity compared with the state - of - the - arts .",
    "this work was supported by epsrc grant ep / m001768/1 ."
  ],
  "abstract_text": [
    "<S> homographies  a mathematical formalism for relating image points across different camera viewpoints  are at the foundations of geometric methods in computer vision and are used in geometric camera calibration , image registration , and stereo vision and other tasks . in this paper </S>",
    "<S> , we show the surprising result that colors across a change in viewing condition ( changing light color , shading and camera ) are also related by a homography . </S>",
    "<S> we propose a new color correction method based on color homography . </S>",
    "<S> experiments demonstrate that solving the color homography problem leads to more accurate calibration . </S>"
  ]
}