{
  "article_text": [
    "problems from many disciplines require solving large coupled reaction networks .",
    "representative examples include reaction networks in combustion chemistry @xcite , geochemical cycling of elements @xcite , and thermonuclear reaction networks in astrophysics @xcite .",
    "the differential equations used to model these networks usually exhibit stiffness , which arises from multiple timescales in the problem that differ by many orders of magnitude @xcite . sufficiently complex physical systems often involve important processes operating on widely - separated timescales , so realistic problems tend to be at least moderately stiff . some , such as astrophysical thermonuclear networks , are extremely stiff , with 1020 orders of magnitude between the fastest and slowest timescales in the problem .",
    "our concern here is with stiffness as a numerical issue , but we remark that stiffness can have important physical implications because complex processes often function as they do precisely because of the coupling of very slow and very fast scales within the same system .    books on numerical and computational methods routinely state @xcite that stiff systems can not be integrated efficiently using explicit finite - difference methods because of stability issues : for an explicit algorithm , the maximum stable timestep is set by the fastest timescales , even if those timescales are peripheral to the main phenomena of interest .",
    "the standard resolution of the stiffness problem uses implicit integration , which is stable for stiff systems but entails substantial computational overhead because it requires the inversion of matrices at each integration step .",
    "because of the matrix inversions , implicit algorithms tend to scale from quadratically to cubically with network size unless favorable matrix structure can be exploited .",
    "thus , implicit methods can be expensive for large networks .",
    "a simple but instructive example of stiffness is provided by the cno cycle for conversion of hydrogen to helium , which powers main - sequence stars more massive than the sun ( fig .",
    "[ fig : cnocycle ] ) . in the cno cycle",
    "the fastest rates under characteristic stellar conditions are @xmath0-decays with half - lives @xmath1 seconds , but to track the complete evolution of main - sequence hydrogen burning may require integration of the network for hydrogen burning over timescales as large as billions of years ( @xmath2 seconds ) .",
    "if one tries to implement this integration using explicit forward differencing , the largest stable integration timestep will be set by the fastest rates and will be of order @xmath3 seconds .",
    "thus @xmath4 or more explicit integration steps could be required to integrate the cno cycle to hydrogen depletion .",
    "conversely , typical implicit integration schemes can take stable and accurate timesteps equal to 1 - 10% of the local time over most of the integration range , and would compute the above numerical integration in a few hundred implicit steps . by virtue of examples such as this",
    ", it is broadly accepted that explicit methods are not viable for stiff networks . to quote the authoritative reference _ numerical recipes _",
    "@xcite , `` for stiff problems we _ must _ use an implicit method if we want to avoid having tiny stepsizes . ''",
    "[ fig : cnocycle ]    our main interest lies in simulations where the reaction network is one part of a broader problem .",
    "let us take as representative astrophysical thermonuclear networks coupled to multidimensional hydrodynamics . the hydrodynamical evolution controls network conditions ( temperature , density ,  ) , and the network influences the hydrodynamics through energy production and modification of composition .",
    "solution of large networks by the usual means is costly in this context and even ambitious simulations use only small networks , or replace the network entirely by parameterization .",
    "then a more realistic network is used in a separate `` post - processing '' step , where fixed hydrodynamical profiles computed in the original simulation specify the variation of temperature and density with time .",
    "such approximations are especially at issue for problems like type ia supernovae , which are 3d asymmetric explosions powered by a complex reaction network releasing energy greater than that of a large galaxy on a timescale of order 1 s.    astrophysical reaction networks have been used to illustrate , but problems in various fields exhibit a similar complexity .",
    "for example , in astrochemical kinetics large chemical evolution networks must be modeled in dynamical environments such as contracting molecular clouds , or in combustion chemistry the burning networks are strongly coupled to dynamical simulations of the air and fuel mixture .",
    "realistic networks in all such applications may be quite large .",
    "modeling combustion of larger hydrocarbon molecules or soot formation can require hundreds to thousands of reacting species with up to 10,000 reactions @xcite , and realistic networks for supernova explosions imply hundreds to thousands of nuclear isotopes with tens of thousands of reaction couplings @xcite . in all such cases current techniques",
    "do not permit the coupling of realistic reaction networks to the full dynamics and highly - schematic reaction networks are used in even the most realistic contemporary simulations .",
    "the pessimism engendered by the introduction notwithstanding , it would be highly desirable to integrate large , complex networks by explicit means because explicit algorithms are simple and economical , and scale favorably with network size . in principle , this could be accomplished by identifying conditions under which some equations in the network have an approximate analytical solution and using that information to remove algebraically the stiffest components from the general numerical solution , thereby replacing the original network with an approximation that permits larger stable explicit - integration timesteps . to that end ,",
    "the first task is to understand clearly the nature of the stiffness that we wish to remove from the equations .",
    "there are several fundamentally different sources of stiffness instability in reaction networks that are often not clearly distinguished in the literature .",
    "pedagogically , discussions often emphasize an instability associated with small populations becoming negative because of an overly - ambitious numerical integration step , thus converting stable decaying - exponential terms into unstable growing exponentials . however , there are other instabilities that can occur , even when no population variables become negative in an integration step . in these types of instabilities",
    "one ends up having to take the difference of large numbers to obtain a result very near zero .",
    "the numerical errors that ensue in a standard explicit approach can then accumulate rapidly and destabilize the network , even before any populations become negative .",
    "this is still a stiffness instability because the problem results ultimately from a numerical integration attempting to cope with highly - disparate timescales , but the origin of these timescales is different from that discussed above . in this case",
    "the disparate timescales are the fast reactions driving the system to equilibrium contrasted with the slow timescale associated with equilibrium itself ( which tends to infinity ) . to illustrate , consider the form of the equations that we desire to solve : @xmath5 where the @xmath6 describe the dependent variables ( species abundances for our examples ) , @xmath7 is the independent variable ( time in our examples ) , the fluxes between species @xmath8 and @xmath9 are denoted by @xmath10 , and the sum for each variable @xmath8 is over all variables @xmath9 coupled to @xmath8 by a non - zero flux @xmath11 .",
    "for an @xmath12-species network there will be @xmath12 such equations in the populations @xmath13 , with these equations generally coupled to each other because of the dependence of the fluxes on the different @xmath14 .    in eq .",
    "( [ equildecomposition ] ) several different ways to group the terms on the right side have been indicated , with the first line representing a decomposition into total flux in and out of species @xmath8 and the third line separating the total flux into in and out contributions from individual reactions .",
    "the utility of these alternative decompositions will be elaborated further below .      in this discussion",
    "we shall employ the term `` equilibration '' broadly to mean that evolution of the network is being influenced strongly by nearly - canceling terms on the right sides of the differential equations ( [ equildecomposition ] ) .",
    "two qualitatively different equilibrium conditions may be distinguished that require different algebraic approaches to stabilization .",
    "one class of equilibrium conditions results if @xmath15 ( asymptotic ) or @xmath16 constant ( steady - state ) .",
    "let us refer to these conditions as a _ macroscopic equilibration _",
    ", since they are statements about entire differential equations in eq .",
    "( [ equildecomposition ] )",
    ". we shall introduce asymptotic and quasi - steady - state approximations exploiting these conditions that remove whole differential equations from the numerical integration for a network timestep , replacing them with algebraic solutions . such approximations still integrate the full original set of equations , but they reduce the number of equations integrated _ numerically by forward difference_. this helps with stiffness",
    "because integration of some or all of the stiffest equations is replaced by a stable analytical solution , and any equations that remain to be integrated numerically tend to have smaller disparities in timescales and thus less stiffness .      in eq .",
    "( [ equildecomposition ] ) , @xmath17 and @xmath18 for a species @xmath8 each consist of various terms depending on the other populations in the network .",
    "groups of individual terms on the right side of eq .",
    "( [ equildecomposition ] ) may come into equilibrium ( so that the sum of their fluxes tends to zero ) , even if the macroscopic conditions for equilibration for the entire equation are not satisfied .",
    "we shall term this _",
    "microscopic equilibration_. then we may consider an algebraic approximation that removes groups of such terms from the numerical integration by replacing their sum of fluxes with zero .",
    "this does not reduce the number of equations integrated numerically , but can reduce their stiffness by removing terms with fast rates , thereby reducing the disparity between the fastest and slowest timescales in the system .",
    "such considerations will be the basis of the partial equilibrium methods to be discussed in  [ partialeq ] .",
    "assume the coupling of reaction networks to a larger system to be done using operator splitting , where the larger system ( the hydrodynamical solver in our examples ) is evolved for a timestep holding the parameters computed from the network in the previous step constant , and then the network is evolved over the time corresponding to the hydrodynamical timestep while holding the new variables calculated in the hydrodynamical timestep constant .",
    "this places two strong constraints on methods :    1 .",
    "the network must be advanced with new initial conditions for each hydrodynamical step .",
    "thus , algorithms must initialize simply and quickly .",
    "2 .   integration of the network must not require time substantially larger than that for the corresponding hydrodynamical timestep .",
    "let us elaborate further on this second point .",
    "taking the multidimensional , adaptive - mesh , explicit hydrodynamical code flash @xcite applied to type ia supernova explosions as representative , we estimate in ref .",
    "@xcite that a simulation with realistic networks can be done in a tractable amount of time if the algorithm can take timesteps @xmath19 over the full hydrodynamical integration range that average at least @xmath20 , where @xmath7 is the elapsed time in the integration .",
    "timesteps of this size are possible with implicit and semi - implicit algorithms , but those methods are inefficient at computing each timestep in large networks ; explicit methods can compute a timestep efficiently , but timesteps this large are unthinkable with a normal explicit algorithm because they are typically unstable . in this paper",
    "we shall demonstrate explicit integration methods that realize such large integration timesteps in a variety of extremely stiff examples .",
    "this alters essentially the discussion of whether explicit methods , with their faster computation of timesteps and more favorable scaling with network size , are practical for large , stiff networks .",
    "the general approximations to be discussed have been implemented before @xcite , but we shall find that our implementations are much more successful than previous applications to extremely stiff networks ; accordingly we shall reach rather different conclusions about these methods than those of earlier publications .",
    "let us address first explicit approximations that are appropriate if the system is far from microscopic equilibrium .",
    "( methods to determine whether this condition is satisfied will be discussed in  [ partialeq ] . )      the differential equations to be solved take the form given by eq .",
    "( [ equildecomposition ] ) .",
    "generally , @xmath17 and @xmath18 for a given species @xmath8 each consist of a number of terms depending on the other populations in the network . for the networks that we shall consider the depletion flux for",
    "the population @xmath13 will be proportional to @xmath13 , @xmath21 where the @xmath22 are rate parameters ( in units of time@xmath23 ) for each of the @xmath24 processes that can deplete @xmath13 , which may depend on the populations @xmath14 and on system variables such as temperature and density .",
    "the characteristic timescales @xmath25 will vary over many orders of magnitude in the systems of interest , meaning that these equations are very stiff . from eq .",
    "( [ eq1.2 ] ) the effective total depletion rate @xmath26 for @xmath13 at a given time , and a corresponding timescale @xmath27 , may be defined as @xmath28 permitting eq .",
    "( [ equildecomposition ] ) to be written as @xmath29 thus , in a finite - difference approximation at timestep @xmath30 @xmath31 the _ asymptotic limit _ for the species @xmath8 corresponds to the condition @xmath32 , implying from eq .",
    "( [ equildecomposition ] ) that @xmath33 . in this limit",
    "( [ eq1.5 ] ) gives a first approximation @xmath34 and local error @xmath35 , respectively , for @xmath36 , @xmath37 for small @xmath38 a correction term may be obtained by writing the derivative term in eq .",
    "( [ eq1.5 ] ) as @xmath39 where @xmath40 denotes terms of order @xmath41 .",
    "substitution in eq .",
    "( [ eq1.5 ] ) then gives @xmath42 and setting @xmath43 and solving for @xmath44 gives @xmath45 where a term of order @xmath46 has been discarded .",
    "this approximation is expected to be valid for large @xmath47 .",
    "another approach is to use a predictor  corrector scheme within such an asymptotic approximation @xcite .",
    "however , it has been shown @xcite that these asymptotic approximations give rather similar results for the networks that we shall test , so the simple formula ( [ asysophia ] ) will be adequate for the present discussion .",
    "the mathematical and numerical properties of asymptotic approximations have been explored previously in refs.@xcite .    to implement an asymptotic algorithm we define a critical value @xmath48 of @xmath47 and at each timestep cycle through all populations and",
    "compute the product @xmath49 for each species @xmath8 using eq .",
    "( [ eq1.3 ] ) and the proposed timestep @xmath19 .",
    "then , for each species @xmath8    1 .   if @xmath50 , the population is updated numerically by the explicit euler method .",
    "if @xmath51 , the population is updated algebraically using eq .",
    "( [ asysophia ] ) .",
    "formally explicit integration is expected to be stable if @xmath52 and potentially unstable if @xmath53 ( see the discussions in refs.@xcite and @xcite ) .",
    "therefore , @xmath54 has been chosen for all examples presented here .",
    "an alternative explicit algebraic solution to the coupled differential equations is possible using the quasi - steady - state ( qss ) approximations developed by mott and collaborators @xcite , which drew on earlier work in refs .",
    "@xcite . following mott et al @xcite , first notice that eq .",
    "( [ equildecomposition ] ) , expressed in the form @xmath55 using eq .",
    "( [ eq1.2 ] ) and with indices dropped for notational convenience , has the general solution @xmath56 provided that @xmath57 and @xmath58 are constant .",
    "the qss method then uses this equation as the basis of a predictor  corrector algorithm in which a prediction is made using only initial values and then a corrector is applied that uses a combination of initial values and values computed using the predictor solution . in terms of a parameter @xmath59 defined by @xmath60 where @xmath61 , we adopt a predictor @xmath62 and corrector @xmath63 given by @xcite @xmath64 where @xmath65 is evaluated from eq .",
    "( [ qss1.1 ] ) with @xmath66 , an average rate parameter is defined by @xmath67 , @xmath68 is specified by eq .",
    "( [ qss1.1 ] ) with @xmath69 , and @xmath70 the corrector can be iterated if desired by using @xmath63 from one iteration step as the @xmath62 for the next iteration step .",
    "we implement an explicit qss algorithm based on the predictor  corrector ( [ qss1.2 ] ) essentially in parallel with that described above for the asymptotic method , except that in applying the qss algorithm all equations are treated in qss approximation , rather than dividing the equations into a set treated by explicit forward difference and a set treated analytically @xcite .",
    "[ partialeq ]    we shall find that the asymptotic and quasi - steady - state methods described in preceding sections work well for macroscopic equilibration , but are highly inefficient for microscopic equilibration .",
    "thus , these methods must be augmented by a means to remove stiffness associated with the approach to ( microscopic ) equilibrium if they are to be applicable to a broad range of problems . in this",
    "section approximations to stabilize explicit integration in the presence of microscopic equilibration are developed .",
    "this development draws heavily on the partial equilibrium work of david mott @xcite as a starting point , but we shall extend these methods and find much more favorable results for extremely stiff networks than those obtained in the pioneering work of mott and collaborators @xcite .",
    "partial equilibrium ( pe ) methods examine source terms @xmath71 and @xmath72 for individual reaction pairs in the network  not the composite fluxes @xmath17 and @xmath18 that are the basis for asymptotic and qss approximations  for approach to equilibrium .",
    "when a fast reaction pair nears equilibrium its source terms are removed from the direct numerical integration in favor of an equilibrium algebraic constraint .",
    "reactions not in equilibrium still contribute to the fluxes for the numerical integrator , but once fast reactions are decoupled from the numerical integration the remaining system typically becomes ( much ) less stiff .",
    "consider a representative 2-body reaction and its source term @xmath73 , @xmath74 where the @xmath13 denote population variables for the species @xmath8 and the @xmath57s are rate parameters for forward ( @xmath75 ) and reverse ( @xmath76 ) reactions .",
    "considered in isolation , the reaction pair of eq .",
    "( [ partial1.1 ] ) may be deemed to be in equilibrium if @xmath77 .",
    "it is useful to introduce the idea of _ partial equilibrium ( pe ) , _ where at a given time some reaction pairs have @xmath78 and some have @xmath79 .",
    "the evolution of the system is then determined primarily by those reactions for which @xmath79 , but since the system is coupled the @xmath80 reactions will perturb the @xmath78 reaction pairs so that for those reactions near equilibrium @xmath81 . let us now introduce a set of definitions and concepts that will allow us both to quantify and use to our advantage the partial equilibrium condition @xmath82 .",
    "[ progvar ]    the reaction pair @xmath83 appears at first glance to have four characteristic timescales associated with the rate of change for the four populations @xmath84 , @xmath85 , @xmath86 , and @xmath87 , respectively .",
    "however , it is clear that the following three constraints apply to this reaction @xmath88 where the constants @xmath89 may be evaluated by substituting the initial abundances into eq .",
    "( [ 2body1.1 ] ) , @xmath90 losing one @xmath91 in the reaction @xmath83 requires the simultaneous loss of one @xmath92 , so their difference must be constant , as implied by the first of eqs .",
    "( [ 2body1.1 ] ) , and every loss of one @xmath91 produces one @xmath93 and one @xmath94 , implying the second and third of eqs .",
    "( [ 2body1.1 ] ) .",
    "the left sides in the equations ( [ 2body1.1 ] ) are examples of _ conserved scalars _",
    "@xcite , which are constant by virtue of the structure of the equations , not by any particular dynamical assumptions .",
    "the differential equation describing the evolution of @xmath84 is @xmath95 where eq .",
    "( [ 2body1.1 ] ) has been used and @xmath96 we shall demonstrate below that the approach to equilibrium for any 2-body reaction pair can be described , and the approach to equilibrium for any 3-body reaction pair can be approximated , by a differential equation of this form . in terms of the quantity @xmath97 the solutions to eq .",
    "( [ 2body1.3 ] ) of interest in the present context correspond to @xmath98 and @xmath99 , and take the form @xcite @xmath100 the equilibrium solution then corresponds to the limit @xmath101 of eq .",
    "( [ 2body1.4 ] ) , @xmath102 once @xmath84 has been determined the constraints ( [ 2body1.1 ] ) may be used to determine the other abundances .",
    "for example , at equilibrium @xmath103 it is often convenient to introduce a variable @xmath104 that is the difference between the values of the @xmath13 at the beginning of the timestep and their current values @xmath105 the new variable @xmath104 is termed a _",
    "progress variable _ for the reaction characterized by @xmath73 and satisfies @xmath106 thus the approach of @xmath83 to equilibrium is controlled by a single differential equation ( [ 2body1.3 ] ) that can be expressed in terms of either a single one of the abundances @xmath13 , or the progress variable @xmath104 .",
    "the general solution of this equation is of the form given by eq .",
    "( [ 2body1.4 ] ) , with the time dependence residing dominantly in the exponentials .",
    "therefore , the rate at which @xmath83 evolves toward the equilibrium solution ( [ 2body1.6 ] ) is governed by a _ single timescale _",
    "@xmath107 which is illustrated in fig .",
    "[ fig : equiltimescalecomposite ] .    ) assuming constant @xmath91 , @xmath92 , and @xmath93 .",
    "the characteristic timescale for approach to equilibrium ( [ 2body1.8 ] ) is labeled @xmath108 and the equilibrium value of @xmath109 defined by eq .",
    "( [ 2body1.6 ] ) is denoted by @xmath110 .",
    "to illustrate we have assumed the initial value @xmath111 . for times considerably larger than @xmath108 the general solution ( [ 2body1.4 ] ) saturates at the equilibrium solution ( [ 2body1.6 ] ) .",
    "( b )  behavior of the exponential factor in eq .",
    "( [ 2body1.4 ] ) . ]",
    "[ fig : equiltimescalecomposite ]    whether a reaction pair is near equilibrium at time @xmath7 may then be determined by requiring that @xmath112 for each of the species @xmath8 that is involved in the reaction pair , where @xmath113 is the actual abundance , @xmath114 is the equilibrium abundance determined from eq .",
    "( [ 2body1.6 ] ) , and @xmath115 is a user - specified tolerance that could depend on @xmath8 but will be taken to be the same for all species in the examples discussed to be here .",
    "alternatively , the equilibrium timescale ( [ 2body1.8 ] ) may be compared with the current numerical timestep to determine whether a reaction is near equilibrium : if @xmath108 is much smaller than the timestep , we may expect that equilibrium can be established and maintained in successive timesteps , even if it is being continually disturbed by other non - equilibrated processes .",
    "[ reactionvectors ]    a partial equilibrium approximation in a large network could require that thousands of reactions be examined for their equilibrium status at each timestep .",
    "let us introduce a formalism , adapted from the work of mott @xcite , that allows examination of partial equilibrium criteria in a particularly efficient way by exploiting the analogy of a reaction network to a linear vector space .",
    "this will have two large advantages : ( 1 )  it will provide us with some well - established mathematical tools .",
    "( 2 )  the abstraction of reaction network as linear vector space permits formulation of a partial equilibrium algorithm that is not strongly tied to the details of a particular problem , thus aiding portability within and across disciplines .",
    "we begin by expressing the concentration variables for the @xmath116 species @xmath117 in a network as components of a composition vector @xmath118 which lies in an @xmath116-dimensional vector space @xmath119 .",
    "the components @xmath13 are proportional to number densities for the species labeled by @xmath117 , so a specific vector in this space defines a particular composition .",
    "any reaction in the network can then be written in the form @xmath120 for some sets of coefficients @xmath121 and @xmath122 .",
    "the coefficients on the two sides of a reaction may be used to define a vector @xmath123 with components @xmath124 that specifies how the composition may change because of the reaction .",
    "for example , consider the main part of the cno cycle illustrated on the right side of fig .",
    "[ fig : cnocycle ] . choosing a basis @xmath125 the reaction",
    "@xmath126 then has a reaction vector @xmath127 with components @xmath128    for a network with three or fewer species the corresponding linear vector space can be displayed geometrically .",
    "for example , fig .",
    "[ fig : reactionvectors3 ] illustrates a network containing the isotopes @xmath129 and four reaction vectors corresponding to the reaction pairs @xmath130 and @xmath131 .",
    "process that converts to in red giant stars . ]",
    "[ fig : reactionvectors3 ]    larger networks can not be visualized so easily , but their algebraic properties remain completely analogous to those of a simple network like that illustrated in fig .",
    "[ fig : reactionvectors3 ] .      [ conlaws ]    given an initial composition @xmath132",
    ", a single pair of reactions labeled by @xmath8 can produce a composition @xmath133 , so for a set of @xmath57 possible reactions @xmath134 define a time - independent vector @xmath135 that is orthogonal to each of the @xmath57 vectors @xmath136 in eq .",
    "( [ vector1.4 ] ) . then from eq .",
    "( [ vector1.4 ] ) , @xmath137 and therefore @xmath138 so any vector @xmath139 orthogonal to the reaction vectors @xmath140 , @xmath141 , ",
    "@xmath142 gives a linear combination of abundances that is invariant under all actions of the network .",
    "equation ( [ vector1.5 ] ) is a _ conservation law of the system _ that follows purely from the structure of the network and thus is valid irrespective of dynamical conditions in the network .",
    "the conserved quantities may be determined by solving the equation @xmath143 , where @xmath127 is a matrix with rows composed of all reaction vectors ( [ reactionvector ] ) , for the vectors @xmath144 .",
    "thus , once a basis has been chosen for a specific reaction network it is straightforward to enumerate all of its possible compositions in terms of a set of vectors @xmath145 , all possible reactions in terms of a set of vectors @xmath146 , and the conservation laws that follow from the structure of the network in terms of a set of vectors @xmath144 .",
    "this abstract description of a reaction network retains a reference to a specific physical problem only through the choice of basis and the choice of allowed reaction vectors .",
    "[ reactiongroupclasses ]    it will prove useful to associate inverse reaction pairs in _ reaction group classes _ ( _ reaction groups , _ or _",
    "rg _ for short ) , in which all reactions of a group share the same reaction vector @xmath127 , up to a sign .",
    "to illustrate we employ the reaction classifications used in the reaclib library @xcite that are illustrated in table [ tb : reaclibclasses ] . in this classification",
    "the reactions of importance in nuclear astrophysics are assigned to eight categories , depending on the number of _ nuclear species _ on the two sides of the reaction equation . from this classification",
    "we see that there are five independent ways to combine the reactions of table [ tb : reaclibclasses ] into reversible reaction pairs , leading to the reaction group classification illustrated in table [ tb : reactiongroupclasses ] . for example",
    ", reaction group b consists of reactions from reaclib reaction class 2 ( a @xmath147 b + c ) paired with their inverse reactions ( b + c @xmath147 a ) , which belong to reaclib reaction class 4 .",
    ".reaction classes in the reaclib @xcite library [ cols=\"^,<,<\",options=\"header \" , ]     reaclib @xcite was used for all rates except that inverse rates for reaction groups 3 , 5 , and 6 are not included in the standard reaclib tabulation and were taken from ref .",
    "@xcite . for all calculations",
    "the equilibrium criteria were imposed using eq .",
    "( [ 2body1.8b ] ) , with a constant value @xmath148 for the tolerance parameter .",
    "a calculation for constant @xmath149 and density of @xmath150 in an alpha network is shown in fig .",
    "[ fig : alpha507pe ] .",
    "( @xmath149 ) and @xmath151 alpha network ( 16 isotopes , 48 reactions , and 19 reaction groups ) .",
    "initial equal mass fractions of and , and rates from reaclib @xcite and ref .",
    "@xcite were used .",
    "( a )  mass fractions .",
    "( b )  integration timesteps for implicit code xnet @xcite , semi - implicit code yass @xcite ( reproduced from from ref .",
    "@xcite ) , asymptotic plus pe ( present work ) , qss plus pe calculation reproduced from ref .",
    "@xcite , qss ( present work ) , and asymptotic ( present work ) . ]",
    "[ fig : alpha507pe ]    the calculated asymptotic plus partial equilibrium ( asy + pe ) mass fractions are compared with those of an implicit code in fig .",
    "[ fig : alpha507pe](a ) .",
    "there are small discrepancies in localized regions , especially for some of the weaker populations , but overall agreement is rather good .",
    "mass fractions down to @xmath152 are displayed for reference purposes .",
    "however , for reaction networks coupled to hydrodynamics only mass fractions larger than say @xmath153 are likely to have significant influence on the hydrodynamics .",
    "thus , the largest discrepancies between pe and implicit mass fractions in fig .",
    "[ fig : alpha507pe](a ) , and in the other examples that will be discussed , imply uncertainties in the total mass being evolved by the network that would be irrelevant in a coupled hydrodynamical simulation .",
    "timestepping for various integration methods is illustrated in fig .",
    "[ fig : alpha507pe](b ) .",
    "the pe calculation required 3941 total integration steps while the implicit code required only 600 steps , but this factor of 6.5 timestepping advantage is offset substantially by the expectation that for a 16-isotope network an explicit calculation should be about 3 times faster than the implicit calculation for each timestep ( table [ tb : explicitspeedup ] ) .",
    "thus we conclude that for fully - optimized codes the implicit calculation would be perhaps twice as fast for this example .",
    "since the semi - implicit timestepping curve was reproduced from another reference the exact number of integration steps is not available , but a comparison of the curves in fig .",
    "[ fig : alpha507pe](b ) suggests that an optimized partial equilibrium code is likely to be at least as fast as the semi - implicit yass code for this example .",
    "the asy + pe and implicit timesteps are many orders of magnitude better at late times than those of the purely asymptotic ( labeled asy ) and purely quasi - steady - state ( labeled qss ) calculations .",
    "the reason is clear from fig .",
    "[ fig : mottcompare507fractionshort ] .    .",
    "also shown is the fraction of isotopes that become asymptotic in the pe calculation . ]",
    "[ fig : mottcompare507fractionshort ]    for times later than @xmath154 , significant numbers of reaction groups come into equilibrium [ as determined by the criteria of eq .",
    "( [ 2body1.8b ] ) ] , which asymptotic and qss methods alone are not designed to handle . the earlier application by mott @xcite of a qss plus pe calculation for this same system is seen to lag behind the current implementation of asymptotic plus partial equilibrium in timestepping at late times by a factor of 1000 or more .",
    "in fact , the timestepping reproduced from ref .",
    "@xcite for qss + pe is only a little better than that of the pure qss results from the present paper , and clearly is not competitive with that of either the implicit or semi - implicit calculations , or the present asymptotic plus partial equilibrium result .",
    "thus we see in this example that the huge speed advantage of implicit methods relative to pure asymptotic or quasi - steady - state methods in the approach to equilibrium that was demonstrated in  [ sh : noncompetive ] has been essentially erased by a proper treatment of partial equilibrium in the explicit integrations .",
    "in addition , the present implementation of asymptotic plus pe methods is seen to be much faster than previous applications of explicit partial equilibrium methods to this network .",
    "the preceding example employed an alpha network at extreme but constant temperature and density . a partial equilibrium calculation using a hydrodynamical profile with the dramatic temperature rise characteristic of a burning wave in a type ia supernova simulation",
    "is illustrated in fig .",
    "[ fig : viktorextended2alphacompositepe ] .",
    "[ fig : viktorextended2alphacompositepe ]    these are challenging conditions for the reaction network . during the thermonuclear runaway the temperature increases by 3.6 billion k in only @xmath155 s",
    ", corresponding to a rate of temperature change @xmath156 , and the fastest and slowest rates in the network differ by approximately 10 orders of magnitude . again we see that the partial equilibrium timestepping is competitive with that of the implicit code .",
    "the partial equilibrium method required 596 total integration timesteps and the implicit code required 553 steps , so an optimized partial equilibrium calculation would be perhaps three times faster than the corresponding implicit calculation because of its speed advantage in computing each timestep . at late times the timestepping for both the implicit and partial equilibrium calculations is again found to be orders of magnitude larger than that from the purely asymptotic calculation .",
    "the reason can be seen from fig .",
    "[ fig : viktorextended2alphacompositepe](d ) : at late times the network is very strongly equilibrated and can be integrated efficiently with an explicit method only if the equilibrating reactions are identified and removed from the numerical integration .",
    "the synergism of the asymptotic and partial equilibrium approximations is illustrated by fig .",
    "[ fig : viktorextended2alphacompositepe](d ) , where we see that in the asymptotic plus pe calculation isotopes become asymptotic much earlier than in the purely asymptotic calculation .",
    "thus the much larger timestep that the pe plus asymptotic calculation takes relative to the purely asymptotic calculation in the time interval @xmath157 to @xmath158 is enabled by a combination of reduced stiffness because of the pe approximation and reduced stiffness because more isotopes become asymptotic at early times .",
    "this synergism is common and we find typically that replacing the stiffest parts of a network by a complementary set of algebraic constraints exploiting both asymptotic and partial equilibrium conditions is much more effective than either set of constraints used alone .",
    "the examples shown above are representative of various problems that have been investigated with the new asymptotic plus pe methods .",
    "our general conclusion is that for alpha networks under the extreme conditions corresponding to a type ia supernova explosion , the asymptotic plus partial equilibrium algorithm is capable of timestepping that is orders of magnitude better than asymptotic or qss approximations alone when the system approaches equilibrium .",
    "these timesteps typically lie in the same ballpark as those from current implicit and semi - implicit codes , once the partial equilibrium algorithm has removed the fast timescales associated with approach to equilibrium .",
    "because the explicit methods can compute the timestep more efficiently , we find that in many cases they project to be at least as fast as current implicit codes , even for the relatively small networks used as examples here .",
    "the preceding discussion has assumed that the relative speed of explicit and implicit methods can be compared  even if they are presently implemented with different levels of optimization  by comparing the ratio of integration timesteps required to do a particular problem with each method multiplied by a ratio of times to execute a step with each method .",
    "the assumption of this comparison is that once the matrix overhead associated with implicit methods is factored out , the rest of the work required in a timestep is similar for explicit and implicit methods .",
    "this is useful for a first estimation , and is sufficient for the primary purpose of this paper , which is to determine whether explicit methods can take stable timesteps that are even in the same ballpark as implicit methods .",
    "however , the results presented here should not be overinterpreted .",
    "because of different levels of optimization for present implicit and explicit timestepping algorithms , and possible differences resulting from choices of integration tolerance parameters for implicit and explicit codes , the present comparisons of integration timesteps are probably uncertain by at least an order of magnitude .",
    "thus , the essential message of the present results is that , contrary to most previous claims , explicit methods can compete favorably with implicit methods for a range of extremely stiff problems . a definitive comparison of whether implicit or explicit methods are faster for specific problems , and by how much , must await more complete development and optimization for the new explicit methods .",
    "as has been noted , the explicit timestepping algorithm employed in this paper is serviceable but is not very optimized .",
    "thus , it is possible that the number of integration steps required by our explicit methods has been overestimated for the examples that have been discussed .",
    "but in addition to this obvious potential for optimization , there are at least two additional reasons why we may not yet be realizing the full capability of explicit methods .",
    "( 1 )  for systems near equilibrium , this paper has emphasized partial equilibrium methods in conjunction with asymptotic approximations .",
    "but we have also presented evidence that quasi - steady - state ( qss ) methods give results comparable to asymptotic methods , often with timesteps that can be somewhat larger .",
    "thus , it is possible that a qss plus partial equilibrium approximation could give even better timestepping than the asymptotic plus partial equilibrium examples shown here .",
    "this possibility has not yet been investigated .",
    "( 2 )  potentially of most importance , the observation that algebraically - stabilized explicit methods may be viable for large , extremely - stiff networks changes the rules of optimization for large reaction networks . for standard implicit methods ,",
    "the most effective optimizations improve the numerical linear algebra , since in large networks the bulk of the computing time for implicit methods is spent in matrix inversions . but with algebraically - stabilized explicit methods there are no matrix inversions and the majority of the time is spent in computing the rates at each step . faster computation of reaction rates",
    "has only a small impact on the speed of an implicit code for large networks , so there has been little incentive to worry about this before .",
    "but now we see that our new explicit methods can gain even more in speed relative to implicit methods by increasing ( through software or hardware ) the efficiency for computing rates at each timestep .",
    "these potential speed gains are separate from , and in addition to , those accruing from the absence of matrix inversions in explicit methods that have been emphasized in preceding sections .",
    "let us cite a simple example illustrating this second point .",
    "we have found in a single - zone hydrodynamics calculation under type ia supernova conditions that using a simple rate - interpolation scheme to avoid recomputing rates for every hydrodynamical timestep permits the speed for explicit asymptotic integration for a 150-isotope network to be increased by a factor @xmath159 in the region of strong silicon burning .    also of interest in this context",
    "is whether the architecture of modern multicore processors with associated gpu accelerators can be exploited to compute rates more efficiently for large - scale simulations of reaction networks coupled to fluid dynamics .",
    "we reiterate that such optimizations could be used for implicit integrations too , but they will not increase their speeds by as much because rates are a smaller part of the computing budget for implicit integration of a large network .",
    "well away from equilibrium , asymptotic and qss approximations can compete with current implicit codes even for extremely stiff systems .",
    "there are important cases where the system does not equilibrate strongly during the evolution of most physical interest ( for example , those described in   [ ppasy][tidalsupernova ] ) . even in problems where equilibrium is important overall",
    ", there will be many hydrodynamical zones and timesteps for which equilibrium plays a small role . in these situations",
    ", the asymptotic and qss approximations alone may be adequate to solve large networks efficiently .",
    "however , to compete systematically with implicit solvers across a broad range of problems , asymptotic and qss approximations must be augmented by pe methods to remain viable in those zones where equilibrium is important .",
    "the examples shown here have demonstrated that asymptotic ( and presumably qss ) plus partial equilibrium methods can solve stiff thermonuclear alpha networks with timestepping similar to that for implicit or semi - implicit codes , and accuracy more than sufficient to couple such an algorithm to fluid dynamics simulations .",
    "explicit methods scale linearly and hence more favorable with network size than implicit methods , so their relative advantage grows for larger networks .",
    "thus , for explicit methods to realize their full potential the previous partial equilibrium examples must be extended to include very stiff networks containing hundreds ( or more ) species . that work is ongoing and",
    "will be reported in future publications , but we note that recent encouraging results in this direction are discussed in ref .  @xcite .",
    "previous discussions of integrating extremely stiff reaction networks have usually concluded that such systems can be integrated only by implicit schemes , because explicit schemes are unstable for timesteps large enough to be efficient .",
    "nevertheless , an alternative to implicit integration for stiff systems is to modify the equations to be integrated using approximate algebraic solutions to reduce the stiffness , and then to integrate the resulting equations numerically by explicit means .",
    "for example , explicit asymptotic and qss methods have had some success in integrating moderately stiff systems in various chemical kinetics problems @xcite .",
    "however , these same methods have been found wanting for the extremely stiff systems characteristic of astrophysical thermonuclear networks , both because they failed to give reliable results , and because the integration timestep was found not to be competitive with implicit methods , even if the results had been correct @xcite .",
    "we have presented evidence strongly challenging all of this conventional wisdom .",
    "the key to realizing this new view of explicit integration for stiff systems is the understanding that in reaction networks there are ( at least ) three fundamental sources of stiffness :    1 .   _ negative populations _ , which can evolve from an initially small positive population if an explicit timestep is too large .",
    "macroscopic equilibration _ ,",
    "where the right sides of the differential equations @xmath160 in eq .",
    "( [ equildecomposition ] ) approach a constant .",
    "microscopic equilibration _ , where the net flux in specific forward - reverse reaction pairs @xmath161 on the right side of eq .",
    "( [ equildecomposition ] ) tends to zero .",
    "these distinctions are crucial because the algebra required to stabilize the explicit solution depends on which forms of stiffness are present in a network .",
    "the first two sources of stiffness are handled well by asymptotic and qss methods , but microscopic equilibration can be handled efficiently using explicit methods only by employing partial equilibrium approximations .    by comparing the timesteps required to integrate problems using explicit and implicit methods , and",
    "by using an implicit backward - euler code to estimate the relative speed for computing a timestep by explicit and implicit means in networks of various sizes , we have shown that algebraically - stabilized explicit integration can give correct results and competitive timesteps for even the stiffest of networks .    1 .   for smaller networks without significant microscopic equilibration ,",
    "we find systematic evidence that the explicit methods developed here can give integration speeds comparable to that for implicit integration .",
    "2 .   for some cases without much equilibration",
    "we find evidence that explicit methods might be capable of outperforming implicit ones .",
    "we have estimated that for equivalently - optimized codes the qss method used here could be faster than the implicit method used here by factors of @xmath162 for the nova simulation of  [ novaexplosions ] , @xmath162 for the tidal supernova alpha network of  [ tidalsupernova ] , and @xmath163 for the tidal supernova 365-isotope network of  [ tidalsupernova ] ( though we have noted that these estimates are uncertain by at least an order of magnitude ) .",
    "3 .   for those cases where equilibration is significant",
    "the asymptotic and qss methods give correct results , but when used alone are much too slow to compete with implicit methods .",
    "however , we presented evidence in ",
    "[ sh : testsalpha ] and  [ sh : extendfull ] that if explicit partial equilibrium methods are used to remove the stiffness associated with the approach to equilibrium , the explicit methods again exhibit speeds that are comparable to or greater than those for implicit methods .",
    "in addition , we have argued in  [ improvespeed ] that these estimates may not yet represent the best speeds for the new explicit methods . because    1 .",
    "our timestepping algorithm is not yet optimal , 2 .",
    "we have yet to investigate whether ( as might be expected ) qss + partial equilibrium can take larger timesteps than asymptotic + partial equilibrium , and 3 .",
    "an increase ( algorithmically or through hardware ) in the speed for computing rates should preferentially benefit explicit methods relative to implicit ones ,    it is possible that the speed of explicit methods relative to implicit ones might be increased substantially relative to the present results .    finally , the present results owe a considerable debt to previous work @xcite . however , we find that our versions of asymptotic and quasi - steady - state methods are much more accurate , and our versions of partial equilibrium methods are much faster , than those of previous authors when applied to extremely stiff astrophysical thermonuclear networks .",
    "the test cases presented here represent a mix of quite extreme conditions , with temperature changes as rapid as @xmath164 k / s , differences in fastest and slowest network timescales as much as 10 - 20 orders of magnitude , and the fraction of equilibrated reactions often changing rapidly between 0% and 100% .",
    "hence , we conjecture that these methods may be even more useful for problems where the conditions are not quite as extreme as for astrophysical thermonuclear environments .",
    "this paper demonstrates that algebraically - stabilized explicit integration is capable of timesteps competitive with those of implicit methods for various extremely - stiff reaction networks . since explicit methods",
    "can execute a timestep faster than an implicit method in a large network , our results suggest that algebraically - stabilized explicit algorithms may be capable of performing as well as , or even substantially outperforming , implicit integration in a variety of moderate to extremely stiff applications . because of the linear scaling with reaction network size for explicit methods , this fundamentally new view of explicit integration for stiff equations is particularly important for applications in fields where more realistic  and therefore larger  reaction networks are required for physical simulations .",
    "arguably , this means almost all scientific and technical disciplines , since the sizes of reaction networks being used in simulations to this point have been dictated more often by what was feasible than by what was physical .",
    "of particular significance is that these new explicit methods might permit coupling of more physically - realistic reaction kinetics to fluid dynamics simulations in a variety of disciplines .",
    "i thank jay billings , reuben budiardja , austin harris , elisha feger , and raph hix for help with some of the calculations .",
    "discussions with raph hix , bronson messer , kenny roche , jay billings , brad meyer , friedel thielemann , michael smith , and tony mezzacappa have been useful in formulating the ideas presented here , and i thank bronson messer for a careful reading of the manuscript .",
    "research was sponsored by the office of nuclear physics , u.s .",
    "department of energy .",
    "[ rgclassificationapp ]    applying the principles discussed  [ reactiongroupclasses ] to the reaction group classes in table [ tb : reactiongroupclasses ] gives the following partial equilibrium properties of reaction group classes for astrophysical thermonuclear networks .                                                                                      in the equilibrium test condition we have allowed the possibility of a different @xmath115 for each species @xmath8 but in practice one would often choose the same small value @xmath222 for all @xmath8 .",
    "the results presented in this paper have used @xmath223 for all species .",
    "b. fryxell , k. olson , p. ricker , f.x .",
    "timmes , m. zingale , d.q .",
    "lamb , p. macneice , r. rosner , j. truran , and h. tufo , flash : an adaptive mesh hydrodynamics code for modeling astrophysical thermonuclear flashes , apjs 131 ( 2000 ) 273 - 334 .",
    "guidry , r. budiardja , e. feger , j.j .",
    "billings , w.r .",
    "hix , o.e.b .",
    "messer , k.j .",
    "roche , e. mcmahon , and m. he , explicit integration of extremely - stiff reaction networks : asymptotic methods .",
    "< arxiv:1112.4716>.                              parallel sparse direct linear solver ( pardiso ) user guide , version 3.2 , computer science department , university of basel , switzerland ( undated ) ; o. schenk , k. gartner and w. fichtner , efficient sparse lu factorization with left - right looking strategy on shared memory multiprocessors , bit 40 ( 2000 ) 158 - 176 ; o. schenk and k. gartner , solving unsymmetric sparse systems of linear equations with pardiso , journal of future generation computer systems 20 ( 2004 ) 475 - 487 ; o. schenk and k. gartner , on fast factorization pivoting methods for sparse symmetric indefinite systems , electronic transactions on numerical analysis 23 ( 2006 ) 158 - 179 .",
    "s. parete - koon , w.r .",
    "hix , m.s .",
    "smith , s. starrfield , d.w .",
    "bardayan , m.w .",
    "guidry and a. mezzacappa , impact of a new @xmath224 reaction rate on nova nucleosynthesis , astrophysical journal 598 ( 2003 ) 1239 - 1245 .",
    "tabulated at http://groups.nscl.msu.edu / jina / reaclib / db/. the jina extensions to reaclib are discussed in r.h .",
    "cyburt , et al . ,",
    "the jina reaclib database : its recent updates and impact on type - i x - ray bursts , ap .",
    "j.  supp.189 ( 2010 ) 240 - 252 ."
  ],
  "abstract_text": [
    "<S> in contrast to the prevailing view in the literature , it is shown that even extremely stiff sets of ordinary differential equations may be solved efficiently by explicit methods if limiting algebraic solutions are used to stabilize the numerical integration . </S>",
    "<S> the stabilizing algebra differs essentially for systems well - removed from equilibrium and those near equilibrium . </S>",
    "<S> explicit asymptotic and quasi - steady - state methods that are appropriate when the system is only weakly equilibrated are examined first . </S>",
    "<S> these methods are then extended to the case of close approach to equilibrium through a new implementation of partial equilibrium approximations . using stringent tests with astrophysical thermonuclear networks </S>",
    "<S> , evidence is provided that these methods can deal with the stiffest networks , even in the approach to equilibrium , with accuracy and integration timestepping comparable to that of implicit methods . because explicit methods can execute a timestep faster and scale more favorably with network size than implicit algorithms </S>",
    "<S> , our results suggest that algebraically - stabilized explicit methods might enable integration of larger reaction networks coupled to fluid dynamics than has been feasible previously for a variety of disciplines .    ordinary differential equations , reaction networks , stiffness , reactive flows , nucleosynthesis , combustion    02.60.lj , 02.30.jr , 82.33.vx , 47.40 , 26.30.-k , 95.30.lz , 47.70.-n , 82.20.-w , 47.70.pq </S>"
  ]
}