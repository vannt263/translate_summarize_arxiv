{
  "article_text": [
    "this paper provides a detailed performance evaluation of the toolbox named speculoos ( for tral nstructured eements bject - riented ystem ) .",
    "speculoos is a spectral and mortar element analysis toolbox for the numerical solution of partial differential equations and more particularly for solving incompressible unsteady fluid flow problems @xcite .",
    "the main architecture choices and the parallel implementation were elaborated and implemented by van kemenade and dubois - plerin @xcite .",
    "subsequently , speculoos code has been growing up with additional layers enabling to tackle and simulate more specific and arduous cfd problems : viscoelastic flows by fitier and deville @xcite , fluid - structure interaction problems by bodard and deville @xcite , large - eddy simulations of confined turbulent flows by bouffanais  @xcite and free - surface flows by bouffanais and deville @xcite .",
    "it is well known that spectral element methods are amenable easily to parallelization as they are intrinsically a natural way of decomposing a geometrical domain @xcite and chap .",
    "8 of @xcite .",
    "the numerous references previously given and the ongoing simulations based on speculoos highlight the achieved versatility and flexibility of this toolbox .",
    "nevertheless , ten years have passed between the first version of speculoos code and now , and tremendous changes have occurred at both hardware and software levels : fast dual ddr memory , risc architectures , 64-bit memory addressing , compilers improvement , libraries optimization , libraries parallelization , increase in inter - connecting switch performance , etc .    back in 1995 , speculoos was commonly compiled and was running on hp , silicon graphics workstations and also on the swiss - tx machine , a commodity - technology based computer with enhanced interconnect link between processors @xcite .",
    "currently most of the simulations based on speculoos are compiled and are running on commodity clusters .",
    "the workstation world experienced a technical revolution with the advent of ` cheap ' risc processors leading to the ongoing impressive development of parallel architectures such as massively parallel clusters and commodity clusters .",
    "as a matter of fact , speculoos benefited from this fast technical evolution as it was originally developed as to run in a single program , multiple data mode ( spmd ) on a distributed - memory computer .",
    "the performance evaluations presented here are demonstrating the correlation between the good performances measured with speculoos and the adequation of this code structure with the current hardware and software evolutions in parallel computing .",
    "this paper is organized as follows . in section [ sec : spec - numer - cont ]",
    "we introduce the numerical context in which speculoos was initiated , the software aspects related to its implementation and the variable - size benchmark test case used for the performance evaluation presented in the subsequent sections .",
    "section [ sec : parallel - implementation ] is devoted to the parallel performance analysis achieved on risc - based commodity clusters .",
    "finally , in section [ sec : conclusions ] we draw some conclusions on the results obtained .",
    "in this section , is gathered the necessary background information regarding the numerical method  namely the spectral and mortar element method , the object - oriented concept and the parallel paradigm , essential roots embodied in speculoos .",
    "the final section [ sec : benchm - eval - test ] introduces the simulation used throughout this study as benchmark evaluation test case .      the spectral element method ( sem )",
    "is a high - order spatial discretization method for the approximate galerkin solution of partial differential equations expressed in weak forms .",
    "the sem relies on expansions on lagrangian interpolants bases used in conjunction with particular gauss  lobatto and gauss  lobatto  jacobi quadrature rules @xcite . as high - order finite element techniques",
    ", the sem can deal with arbitrary complex geometry where @xmath1-refinement is achieved by increasing the number of spectral elements and @xmath2-refinement by increasing the lagrangian polynomial order within the elements . from a high - order precision viewpoint ,",
    "sem is comparable to spectral methods as an exponential rate - of - convergence is observed when smooth solutions to regular problems are sought .",
    "@xmath3-continuity across element interfaces requires the exact same interpolation in each and every spectral element sharing a common interface .",
    "the associated caveat to such conforming configurations is the over - refinement meshing generated in low - gradient zones .",
    "the adopted remedy to such nuisance is a technique developed by bernardi  @xcite referred to as the mortar element method .",
    "mortars can be viewed as variational patches of the discontinuous field along the element interfaces .",
    "they relax the @xmath3-continuity condition while preserving exponential rate - of - convergence , and thus allow polynomial nonconformities along element interfaces .",
    "the complexity and the size of the large three - dimensional problems tackled by numericists in their simulations require top computational performance accessible from highly parallelized algorithms running on parallel architectures .",
    "as mentioned in @xcite , the implementation of concurrency in speculoos was based on the concept that concurrency is a painful implementation constraint going against the high - level object - oriented programming concepts . as a matter of consequence ,",
    "speculoos parallelization was kept very low - level . in most higher - level operations parallelism",
    "does not even show up .    from a computational viewpoint ,",
    "systems discretized with a high - order spectral element method rely mainly on optimized tensor - product operations taking place at the spectral element level .",
    "the natural data distribution for high - order spectral element methods is based on an elemental decomposition in which the spectral elements are distributed to the processors available for the run .",
    "it is worth noting that for very large computations , the number of spectral elements can become relatively important as compared to the number of processors available for the computation .",
    "the design of speculoos makes it possible to have several elements sitting on a single processor .",
    "nodal values on subdomain interface boundaries are stored redundantly on each processor corresponding to the spectral elements having this interface in common .",
    "moreover , this approach is consistent with the element - based storage scheme which minimizes the inter - processor communications .",
    "inter - processor communication is completed by mpi instructions @xcite .      as a common practice in performance evaluation , it is important to build a tailor - made benchmark based on a numerical simulation corresponding to a concrete situation . before proceeding to the first step of our performance evaluation , we have short - listed some key parameters that have the most significant impact on the performance of our toolbox : single - processor optimization on the three computer architectures described in table [ tab : machines ] , single - processor profiling analysis , parallel implementation and scalability ( including speedup , efficiency , communication times ) and parallel implementation and processor dispatching .    a test case has been developed for this benchmark and for the parallel benchmarking , see sec .",
    "[ sec : parallel - implementation ] .",
    "this test case belongs to the field of cfd and consists in solving the navier ",
    "stokes equations for a viscous newtonian incompressible fluid . based on the problem at hand",
    ", it is always physically rewarding to non - dimensionalize the governing navier  stokes equations which take the following general form @xmath4 where @xmath5 is the velocity field , @xmath2 the reduced pressure ( normalized by the constant fluid density ) , @xmath6 the body force per unit mass and @xmath7 the reynolds number expressed as @xmath8 in terms of the characteristic length @xmath9 , the characteristic velocity @xmath10 and the constant kinematic viscosity @xmath11 .",
    "the system evolution is studied in the time interval @xmath12 $ ] . from the physical viewpoint , eqs .",
    " are derived from the conservation of momentum and the conservation of mass respectively . for incompressible viscous fluids ,",
    "the conservation of mass also called continuity equation , enforces a divergence - free velocity field as expressed by eq . .",
    "considering particular flows , the governing navier  stokes equations ",
    "are supplemented with appropriate boundary conditions for the fluid velocity @xmath5 and/or for the local stress at the boundary . for time - dependent problems ,",
    "a given divergence - free velocity field is required as initial condition in the internal fluid domain .",
    "all our computations were carried out using two time integrators : the implicit backward - differentiation formula ( bdf ) of order 2 for the treatment of the stokes operator and an extrapolation scheme ( ex ) @xcite of same order for the nonlinear convective term .",
    "one type of pressure decomposition mode , based on a fractional - step method using pressure correction namely bp1-pc @xcite is used .",
    "speculoos uses a legendre sem @xcite for the spatial discretization of the navier  stokes equations . for the sake of simplicity",
    "the same polynomial order has been chosen in the different spatial directions ( @xmath13 ) . moreover , to prevent any spurious oscillations in our navier  stokes computations , the choice of a staggered @xmath14 interpolation method for the velocity and pressure respectively , has been made @xcite . as a consequence of this choice of a staggered grid ,",
    "the inner - element grid for the @xmath15- , @xmath16- and @xmath17-component of the velocity field is a gauss  lobatto  legendre grid made up with @xmath18 quadrature ( nodal ) points and the grid for the pressure is a gauss  legendre grid made up with @xmath19 ^ 2 $ ] quadrature ( nodal ) points , in each spectral element .",
    "the test case corresponds to the fully three - dimensional simulation of the flow enclosed in a lid - driven cubical cavity at the reynolds number of @xmath20 placing us in the locally - turbulent regime .",
    "it corresponds to the case denoted under - resolved dns ( udns ) in bouffanais  @xcite .",
    "the reader is referred to bouffanais  @xcite for full details on the numerical method and on the parameters used throughout the present paper .",
    "in the sequel , we will assume that the reader is familiar with the basics of parameterization on a parallel machine .",
    "for a complete introduction to these notions we refer the reader to the following references @xcite .",
    "the speedup @xmath21 of an application on a given parallel machine can be described as @xmath22 if we suppose that the computing effort strictly scales with @xmath23 , then @xmath24 and the speedup can be written as @xmath25 where @xmath26}}{\\text{amount of data to transfer [ mword]}},\\ ] ] is related to the application and @xmath27}}{\\text{effective communication bandwidth per processor [ mwords]}},\\ ] ] to the machine , and @xmath28 .",
    "the reader is referred to @xcite for full details on such parameterisation to tailor commodity clusters to applications .",
    "the efficiency @xmath29 of a parallel machine is defined by @xmath30      speculoos uses a small amount of main memory .",
    "parallelization is made in order to reduce the high overall computing time .",
    "the number of elements and the polynomial degrees in the three space directions are denoted by @xmath31 , @xmath32 , and @xmath33 , and @xmath34 , @xmath35 , and @xmath36 , respectively .",
    "the total number of independent variables per element is therefore @xmath37 , where @xmath38 is the number of vector components per gauss  lobatto  legendre ( gll ) quadrature point .",
    "in addition , there are @xmath39 elements .      to perform the speculoos code benchmark , the machines presented in table  [ tab : machines ] have been used .",
    ".[tab : machines]characteristics of the machines used for the benchmark .",
    "dc = dual - core .",
    "fe = fast ethernet .",
    "gbe = gigabit ethernet .",
    "[ cols=\"<,^,^,^,^,^\",options=\"header \" , ]     it is possible to measure the total time @xmath40 by means of an interpretation of the cpu usage plots ( see fig .  [",
    "fig : p1 ] ) .",
    "indeed , the middleware ganglia determines for every time interval of 20 seconds the average cpu usage ( or efficiency @xmath29 ) for each processing element .",
    "this information has to be put into relation to the speculoos application .",
    "this is done via the middleware vamos . in the plots in fig .",
    "[ fig : p1 ] , are added up all the values of @xmath29 that lie in between @xmath15 and @xmath41 , where @xmath15 is the percentile represented on the abscissae of the plots .",
    "the efficiency @xmath29 is related to the @xmath0 through @xmath42 what can also be estimated are the network bandwidths @xmath43 of the gbe switch ( between @xmath44 and 100 mb / s per link ) , the network bandwidth of the fast ethernet switch ( between @xmath45 and 12 mb / s per link ) and the latency ( @xmath46s for both networks ) .",
    "first , a consistency test of those quantities is performed .",
    "assuming that the fast ethernet switch has a fix bandwidth of @xmath47 mb / s , and for the gbe switch @xmath48 , with @xmath49 unknown .",
    "another unknown is the number of words @xmath50 that is sent per node to the other nodes , and @xmath51 . based on the previous assumptions ,",
    "the three @xmath0 values for the three machines and the two networks is expressed as @xmath52 these constitute a set of three equations for three unknown variables , namely @xmath50 , @xmath49 , and @xmath53 .",
    "solving for these variables leads to @xmath54 , @xmath55 mwords , and @xmath56 .",
    "the value of @xmath57 mb / s corresponds precisely to the one measured .",
    "this means that the model is well applicable .",
    "to study if speculoos is dominated by inter - node communications , figure  [ fig : p2 ] shows the result of two runs of the same problem size ( @xmath58 and @xmath59 ) made respectively on 4 and 8 woodcrest nodes during the same period of time ( 1h = 3600 seconds ) and counting the number of iteration steps .",
    "the first sample was launched forcing 2 mpi threads on each node and the second with 4 mpi threads on each node .",
    "cpu usage on the 5100-series smp node of ` pleiades2 + ` cluster .",
    "16 processing elements were required .",
    "8 nodes/2 cores with 2 mpi threads per nodes in the upper case , 4 nodes/4 cores with 4 mpi threads per node in the lower case.,title=\"fig:\",scaledwidth=60.0% ] +   cpu usage on the 5100-series smp node of ` pleiades2 + ` cluster .",
    "16 processing elements were required .",
    "8 nodes/2 cores with 2 mpi threads per nodes in the upper case , 4 nodes/4 cores with 4 mpi threads per node in the lower case.,title=\"fig:\",scaledwidth=60.0% ] +    we have to note that the cpu usage ( system+user+nice ) monitored by ganglia is the sum of all the process elements . for instance , for a dual - processor machine ,",
    "when ganglia measures 50% cpu usage , it means that each processor run at 100% . in figure",
    "[ fig : p2 ] , when 2 mpi threads are blocked per node , we get a cpu usage of 51.13% while 157 iteration loops have been performed during one hour ; when 4 mpi threads run on each node , we get a cpu usage of 87.25% while only 117 iteration loops have been performed during one hour .",
    "thus , the real cpu usage for the sample with 2 mpi threads per node is above 100% ( 2 cores are unused ) .",
    "the extensive performance review presented in this paper for the high - order spectral and mortar element method toolbox , speculoos , has shown that good performances can be achieved even with relatively common internode network communication systems , available software and hardware resources  small commodity clusters with non - proprietary compilers installed on it .",
    "we can conclude that the main implementation choices made a decade ago reveal their promises . even though those choices could have been questionable ten years ago",
    ", they are now in line with the current trend in computer architecture developments with the generalization of commodity and massively parallel clusters .    the parallel implementation of speculoos based on mpi has shown to be efficient .",
    "reasonable scalability and efficiency can be achieved on commodity clusters .",
    "the results support the original choices made in speculoos parallel implementation by keeping it at a very low - level .",
    "one of the goal of this study was to estimate if speculoos could run on a massively parallel computer architecture comprising thousands of computational units , specifically on the ibm blue gene machine at epfl with 4096 dual processor units .",
    "the performance of one processor corresponds to approximately half of the performance of one processor on the pleiades commodity cluster .",
    "each blue gene node has 512 mb of main memory . a block with @xmath60 elements and a polynomial degree of @xmath61 in each space direction takes 200 mb of main memory . in a first step",
    ", one block per node will run on one node .",
    "later , speculoos will be modified to accommodate one block per processor , i.e. two blocks per node .",
    "a 4096 blocks speculoos case would offer the opportunity to run very accurate simulations of turbulent flows with more than half a billion of unknowns .",
    "such a case would well scale on the ibm blue gene solution .",
    "in fact , the point - to - point operations per node do not change with the number of nodes .",
    "the gigabit - ethernet network can well handle the corresponding communications .",
    "the all - reduce operations scale logarithmically with the number of computational units .",
    "a special efficient fat tree network takes care of all multicast communications . as a consequence",
    ", large speculoos cases will perfectly scale on epfl s blue gene machine .",
    "this research is being partially funded by a swiss national science fundation grant ( no .",
    "200020101707 ) and by the swiss national supercomputing center cscs , whose supports are gratefully acknowledged .",
    "v.  van  kemenade , incompressible fluid flow simulation by the spectral element method , tech . rep .",
    ", `` annexe technique projet fn 21 - 40512.94 '' , imhef ",
    "dgm , swiss federal institute of technology , lausanne ( 1996 ) .",
    "n.  fitier , m.  o. deville , linear stability analysis of time - dependent algorithms with spectral element methods for the simulation of viscoelastic flows , j. non - newtonian fluid mech . 115",
    "( 2003 ) 157190 .",
    "y.  maday , a.  t. patera , spectral element methods for the incompressible navier ",
    "stokes equations , state - of - the - art survey on computational mechanics , a. k. noor & j. t. oden eds . ,",
    "asme , new - york , 1989 , pp .",
    "71142 .      c.  bernardi , y.  maday , a.  t. patera , a new nonconforming approach to domain decomposition : the mortar element method , vol .",
    "299 of pitman res .",
    "notes math .",
    "ser . , nonlinear partial differential equation and their applications , collge de france seminar , 11 ( paris , 19891991 ) , longman sci . tech . , harlow , 1994 , pp . 1351 .",
    "w.  couzy , spectral element discretization of the unsteady navier  stokes equations and its iterative solution on parallel computers , ph.d .",
    "thesis , no .",
    "1380 , swiss federal institute of technology , lausanne ( 1995 ) ."
  ],
  "abstract_text": [
    "<S> in this paper , a comprehensive performance review of a mpi - based high - order spectral and mortar element method toolbox is presented . </S>",
    "<S> the focus is put on the performance evaluation of several aspects with a particular emphasis on the parallel efficiency . the performance evaluation is analyzed and compared to predictions given by a heuristic model , the so - called @xmath0 model . </S>",
    "<S> a tailor - made cfd computation benchmark case is introduced and used to carry out this review , stressing the particular interest for commodity clusters . </S>",
    "<S> conclusions are drawn from this extensive series of analyses and modeling leading to specific recommendations concerning such toolbox development and parallel implementation .    </S>",
    "<S> spectral and mortar element method , toolbox , mpi , scalability , commodity clusters .    ,    ,    , </S>"
  ]
}