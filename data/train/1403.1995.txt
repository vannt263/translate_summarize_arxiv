{
  "article_text": [
    "recall that _ classical model theory _ studies properties of abstract mathematical structures ( finite or not ) expressible in first - order logic @xcite , and _",
    "finite model theory _ is the study of first - order logic ( and its various extensions ) on finite structures @xcite , @xcite .",
    "_ constraint satisfaction problems _ ( csps ) , and more specifically @xmath0-coloring problems , are standard examples of problems which can be expressed in monadic second order logic but usually not in the first - order logic . of course , expressing a @xmath0-coloring problem in first - order logic would be highly appreciable , as it would allow fast checking ( in at most polynomial time )",
    "although problems expressed in monadic second order logic are usually np - complete . in this direction , it has been proved by hell and neetil @xcite that in the context of finite undirected graphs the @xmath0-coloring problem is np - complete unless @xmath0 is bipartite , in which case the @xmath0-coloring problem is clearly polynomially solvable . this , and a similar dichotomy result of schaefer  @xcite , led feder and vardi @xcite to formulate the celebrated dichotomy conjecture which asserts that , for every constraint language over an arbitrary finite domain , the corresponding constraint satisfaction problems are either solvable in polynomial time , or are np - complete .",
    "it was soon noticed that this conjecture is equivalent to the existence of a dichotomy for ( general ) @xmath0-coloring problems , and in fact it suffices to prove it for oriented graphs ( see @xcite and @xcite ) .",
    "alternatively , the class p of all polynomially solvable problems can be described as the class of problems expressible ( on ordered structures ) in first - order logic with a least fixed point operator @xcite . on the other hand",
    "the class np may be characterized ( up to polynomial equivalence ) as the class of all problems which have a lift ( or expansion ) determined by forbidden homomorphisms from a finite set @xcite .",
    "hence , we are led naturally to the question of descriptive complexity of classes of structures corresponding to @xmath0-coloring problems .",
    "a particular case is the question whether a @xmath0-coloring problem may be expressed in first - order logic or not .    in this paper",
    ", we will consider the relativized version of the problem of first - order definability of @xmath0-coloring problems to graphs ( or structures ) belonging to a fixed class @xmath1 :    [ pb:1 ] given a fixed class @xmath1 of graphs ( directed graphs , relational structures ) , determine which @xmath0-coloring problems are first - order definable in @xmath1 .",
    "explicitly , determine for which graphs ( directed graphs , relational structures ) @xmath0 there exists a first - order sentence @xmath2 such that @xmath3    the case where @xmath1 is the whole class of all finite graphs ( all finite directed graphs , all finite relational structures with given finite signature ) is well understood .",
    "atserias  @xcite and rossman  @xcite proved that in this case first - order definable @xmath0-colorings correspond exactly to _",
    "finite homomorphism dualities _ , and these dualities have been fully characterized ( for undirected graphs , by neetil and pultr @xcite ; for directed graphs , by kom ' arek @xcite ; for general finite structures , by neetil and tarif @xcite ) as follows :    for any signature @xmath4 and any finite set @xmath5 of @xmath4-structures the following two statements are equivalent :    1 .",
    "there exists @xmath6 such that @xmath5 and @xmath6 form a finite duality , that is : @xmath7 2 .",
    "@xmath5 is homomorphically equivalent to a set of finite ( relational ) trees .",
    "note that an example of such a duality for the class of all finite directed graphs is the gallai - hasse - roy - vitaver theorem @xcite , which states that for every directed graph @xmath8 it holds : @xmath9    for general classes of graphs the answer is more complicated .",
    "for instance , let @xmath1 be the class of ( undirected ) toroidal graphs and let @xmath10 be the sentence    @xmath11    where additions are considered modulo @xmath12 and where @xmath13 denotes that @xmath14 and @xmath15 are adjacent .",
    "then , it follows from @xcite that a graph @xmath16 satisfies @xmath10 if and only if it is @xmath17-colourable .",
    "this property can be alternatively be expressed by the following _ restricted duality _ :",
    "@xmath18{t11.eps}}\\quad{\\relbar\\!\\joinrel\\not\\relbar\\joinrel\\!\\!\\rightarrow}\\quad g\\qquad\\iff\\qquad   g\\quad\\longrightarrow \\quad\\raisebox{-.4\\graphshift}{\\includegraphics[height=\\graphshift]{k5.eps}}}\\ ] ]    in fact the class of toroidal graphs has all restricted dualities in the following sense : for every connected @xmath19 there exists @xmath20 such that @xmath21 and for every toroidal graph @xmath22 holds @xmath23    for a general class of graphs @xmath1 , problem  [ pb:1 ] is very complex .",
    "we have to specialize .",
    "hence we first require that the studied class @xmath1 has some basic properties : we assume that    * @xmath1 is _ hereditary _ ( meaning that every induced subgraph of a graph in @xmath1 is in @xmath1 ) ; * @xmath1 is _ addable _ ( meaning that disjoint unions of graphs in @xmath1 are in @xmath1 ) ; * @xmath1 is _ topologically closed _ ( meaning that every subdivision of a graph in @xmath1 is in @xmath1 ) .",
    "we approach the problem of characterizing first - order definable colorings by first discriminating between the cases of sparse and dense classes of graphs using our _ class taxonomy _",
    "@xcite , which seems relevant here .",
    "the second central ingredient of our study is the notion of _ homomorphism preservation theorem _ ( hpt ) for a class @xmath1 , which was investigated in @xcite .",
    "our approach can be outlined as follows : if there exists some integer @xmath24 such that every @xmath24-subdivision of a complete graph appears as a subgraph of some graph in @xmath1 ( meaning that @xmath1 is _ somewhere dense _ ) then we prove that every first - order definable @xmath0-coloring defines a restricted duality on the subclass @xmath25 of the @xmath24-subdivisions of simple graphs ( follows from hpt for @xmath26 ) .",
    "using a classical construction of erds  @xcite , we deduce that if a @xmath0-coloring problem is first - order definable on @xmath1 then either @xmath0 is bipartite , or the odd - girth of @xmath0 is at most @xmath27 .",
    "otherwise ( meaning that @xmath1 is _ nowhere dense _ )",
    "it follows from hpt for nowhere dense classes that every first - order definable @xmath0-coloring defines a restricted duality on @xmath1 . in the case where there exists some integer @xmath24 such that @xmath24-subdivisions of graphs with arbitrarily large average degree appear as subgraphs of graphs in @xmath1 ( meaning that @xmath1 is not a _ bounded expansion _",
    "class ) we prove that @xmath0 can not be a restricted dual of a non - bipartite graph with arbitrarily large odd - girth . modulo some reasonable conjecture ( conjecture  [ conj : nd ] ) , we get that ( as in the somewhere dense case ) @xmath0 is either bipartite or has bounded odd - girth .    in the reminding case ( where @xmath1 is a bounded expansion class ) , we prove that first - order definable coloring correspond to restricted dualities , hence are exactly defined by a sentence expressing that no homomorphism exists from one of the connected graphs belonging to a finite set .",
    "this study naturally leads to the following conjecture :    [ conj : main ] let @xmath1 be a hereditary addable topologically closed class of graphs .",
    "the following properties are equivalent :    1 .   for every integer @xmath24",
    "there is a non - bipartite graph @xmath28 of odd - girth strictly greater than @xmath27 and a first order definable class @xmath29 such that a graph @xmath30 is @xmath28-colorable if and only if @xmath31 .",
    "explicitly , there exists a formula @xmath32 such that for every graph @xmath16 holds @xmath33 2 .",
    "the class @xmath1 has bounded expansion .    in this paper",
    ", we make a significant progress toward a solution to conjecture  [ conj : main ] .",
    "we state a structural conjecture , conjecture  [ conj : nd ] , about nowhere dense classes that fail to be bounded expansion classes , which expresses that such classes are characterized by the existence ( as subgraphs of graphs in the class ) of @xmath24-subdivisions of graphs with arbitrarily large chromatic number and girth . more precisely :",
    "[ conj : nd ] let @xmath1 be a monotone nowhere dense class that does not have bounded expansion .",
    "then there exists an integer @xmath24 such that @xmath1 includes @xmath24-subdivisions of graphs with arbitrarily large chromatic number and girth .",
    "our main result toward a characterization of first - order definable colorings is the following reduction .",
    "[ thm : main ] let @xmath1 be a hereditary topologically closed class of graphs that is somewhere dense or has bounded expansion .",
    "then the following properties are equivalent :    1 .   for every integer @xmath24",
    "there is a non - bipartite graph @xmath28 of odd - girth strictly greater than @xmath27 such that @xmath28-coloring is first - order definable on @xmath1 ; 2 .",
    "the class @xmath1 has bounded expansion .",
    "moreover , if conjecture  [ conj : nd ] holds then the statement holds for every hereditary addable topologically closed class of graphs , that is : if conjecture  [ conj : nd ] holds then conjecture  [ conj : main ] also holds .    in support to conjecture  [ conj : nd ] , we prove ( proposition  [ prop : conj ] ) that it would follow from a positive solution to any of the following two well known conjectures .",
    "[ conj : eh ] for every integers @xmath34 and @xmath35 there exists an integer @xmath36 such that every graph @xmath22 with chromatic number at least @xmath37 has a subgraph @xmath0 with girth at least @xmath34 and chromatic number at least @xmath35 .",
    "the case @xmath38 of the conjecture was proved by rdl @xcite , while the general case is still open .",
    "remark that the existence of graphs of both arbitrarily high chromatic number and high girth is a well known result of erds @xcite .",
    "[ conj : thomassen ] for all integers @xmath39 there exists an integer @xmath40 such that every graph @xmath22 of average degree at least @xmath40 contains a subgraph of average degree at least @xmath41 and girth at least @xmath34 .",
    "the case @xmath42 of this conjecture is a direct consequence of the simple fact that every graph can be made bipartite by deleting at most half of its edges .",
    "the case @xmath43 has been proved in @xcite .",
    "although we do not settle conjecture  [ conj : main ] , our study led us to the two following characterization theorems of classes that have all restricted dualities .",
    "[ thm : sub ] let @xmath1 be a topologically closed class of graphs .",
    "the following properties are equivalent :    1 .",
    "the class @xmath1 has bounded expansion ; 2 .",
    "the class @xmath1 has all restricted dualities ; 3 .   for every odd integer",
    "@xmath34 there exists a graph @xmath44 with odd - girth greater than @xmath34 such that every graph @xmath16 with odd - girth greater than @xmath34 has a homomorphism to @xmath44 .",
    "these results motivate more general studies of classes of relational structures having all restricted dualities , which includes classes of structures whose gaifman graphs form a class with bounded expansion . in a very general setting",
    ", we obtain the following characterization :    [ thm : approx ] let @xmath1 be a class of @xmath4-structures . then @xmath1 is bounded and has all restricted dualities if and only if for every integer @xmath45 there is an integer @xmath46 such that for every @xmath47 there exists a @xmath4-structure @xmath48 ( called _ @xmath45-approximation _ of @xmath49 ) such that    * @xmath48 has order @xmath50 at most @xmath46 , * @xmath51 , * every substructure @xmath52 of @xmath48 with order @xmath53 has a homomorphism to @xmath49 .",
    "this paper is organized as follows :    in section  [ sec : prelim ] , we recall the notions needed in the development of our study , in particular class taxonomy and basics on relational structures .    in section  [ sec : hpt ] , we discuss classes satisfying a homomorphism preservation theorem ( hpt ) . on these classes , first - order definable @xmath0-colorings",
    "correspond to finite restricted dualities .",
    "moreover , when the considered class is addable , they correspond to finite restricted dualities with connected templates .    in section  [ sec : ard ] , we discuss classes having all restricted dualities , that is classes such that to every finite set @xmath5 of connected templates correspond a graph @xmath0 such that a graph @xmath22 in the class is @xmath0-colorable if and only if none of the templates in @xmath5 has a homomorphism to @xmath22 .",
    "in the following , we denote by @xmath54 the class of all finite graphs .",
    "a class of graphs @xmath1 is _ monotone _ ( resp . _ hereditary _ , _ topologically closed _ ) if every subgraph ( resp .",
    "every induced subgraph , every subdivision ) of a graph in @xmath1 also belongs to @xmath1 . notice that if a class @xmath1 is both hereditary and topologically closed it is also monotone : if @xmath0 is a subgraph of a graph @xmath16 , the graph @xmath0 is an induced subgraph of the graph @xmath55 obtained from @xmath22 by subdividing every edge not in @xmath0 , hence @xmath56 . for a graph @xmath22 ,",
    "we denote by @xmath57 its clique number , by @xmath58 its chromatic number , and by @xmath59 the average degree of its vertices . by extension , for a class of graphs",
    "@xmath60 we define @xmath61    we proposed in @xcite a general classification scheme for graph classes which is based on the density of shallow ( topological ) minors ( we refer the interested reader to the monography @xcite ) .",
    "this classification can be defined in several very different ways and we give here one of the simplest definitions , which relates to subdivision :    a _ subdivision _",
    "a _ @xmath62-subdivision _ ) of an edge @xmath63 of a graph @xmath22 consists in replacing the edge @xmath64 by a path ( resp . by a path of length @xmath65 ) with endpoints @xmath14 and @xmath15 .",
    "subdivision _ of a graph @xmath22 is a graph @xmath0 resulting from @xmath22 by subdividing edges ; the graph @xmath0 is the _",
    "@xmath62-subdivision _ of @xmath22 if it has been obtained from @xmath22 by @xmath62-subdividing all the edges ( i.e. if all the edges of @xmath22 have been replaced by paths of length @xmath65 ) .",
    "the graph @xmath0 is a _ @xmath66-subdivision _ of @xmath0 if it has been obtained by replacing each edge of @xmath22 by a path of length at most @xmath65 .",
    "let @xmath24 be a half - integer .",
    "a graph @xmath0 is a _ shallow topological minor _ of a graph @xmath22 _ at depth @xmath24 _ if some @xmath67-subdivision of @xmath0 is a subgraph of @xmath22 ; the set of all shallow topological minors of @xmath22 at depth @xmath24 is denoted by @xmath68 and , more generally , @xmath69 denotes the class of all shallow topological minors at depth @xmath24 of graphs in @xmath1 .    a class of undirected graphs @xmath1 is _ somewhere dense _ if there exists an integer @xmath24 such that the @xmath24-th subdivision of every finite graph @xmath0 may be found as a subgraph of some graph in @xmath1 ; it is _ nowhere dense _ otherwise .    in other words ,",
    "the class @xmath1 is nowhere dense if @xmath70    a particular type of nowhere dense classes will be of particular importance in this paper : a class @xmath1 has _ bounded expansion _",
    "@xcite if @xmath71 among the numerous equivalent characterizations that can be given for the property of having bounding expansion , we will make use of a characterization based on the chromatic numbers of the shallow topological minors of the graphs in the class .",
    "this characterization can be deduced from the following result of dvok @xcite ( see also @xcite ) :    [ lem : dvo ] let @xmath72 be an integer and let @xmath22 be a graph with minimum degree @xmath73 . then the graph @xmath22 contains a subgraph @xmath74 that is the @xmath75-subdivision of a graph with chromatic number @xmath41 .",
    "hence the following characterization of classes having bounded expansion :    [ thm : bechi ] a class @xmath1 has bounded expansion if and only if it holds @xmath76    according to lemma  [ lem : dvo ] , for every graph @xmath22 and every integer @xmath24 there exists an integer @xmath77 such that : @xmath78 moreover , as every graph @xmath22 is @xmath79-colorable , every graph in @xmath68 is @xmath80-colorable , that is : @xmath81 the result follows from these two inequalities .",
    "thus we see that parameters @xmath82 and @xmath83 can be used to define bounded expansion classes , although nowhere dense classes are defined by means of the parameter @xmath84 .",
    "characterizing nowhere dense classes that do not have bounded expansion in a structural way is challenging , and thus we proposed conjecture  [ conj : nd ] , from which conjecture  [ conj : main ] would follow .",
    "we now prove that conjecture  [ conj : nd ] follows from any of the conjecture  [ conj : eh ] ( by erds and hajnal ) or conjecture  [ conj : thomassen ] ( by thomassen ) :    [ prop : conj ] if either conjecture  [ conj : eh ] or conjecture  [ conj : thomassen ] holds , then so does conjecture  [ conj : nd ] .",
    "let @xmath1 be a nowhere dense class of graphs which is not a bounded expansion class . by definition of a bounded expansion class",
    ", there exists an integer @xmath85 such that @xmath1 includes @xmath86-subdivisions of graphs with arbitrarily large average degree hence ( by standard pigeon - hole argument ) there is an integer @xmath24 such that @xmath1 includes exact @xmath85-subdivisions of graphs with arbitrarily large average degree .",
    "assume conjecture  [ conj : eh ] holds .",
    "define @xmath87 , and let @xmath88 . according to the statement of the conjecture ,",
    "there exists @xmath37 such that every graph with chromatic number at least @xmath37 has a subgraph with girth at least @xmath34 and chromatic number at least @xmath35 .",
    "we can assume @xmath89 . let @xmath90 .",
    "let @xmath16 be such that @xmath22 includes the @xmath85-subdivision of a graph with average degree at least @xmath91 hence the @xmath85-subdivision of a graph @xmath0 with minimum degree at least @xmath92 . according to lemma  [ lem : dvo ]",
    ", @xmath0 has a subgraph @xmath93 that is the @xmath75-subdivision of a graph with chromatic number @xmath37 .",
    "it follows that @xmath22 has a subgraph which is a @xmath24-subdivision of a graph @xmath94 with chromatic number @xmath37 . according to conjecture  [ conj : eh ]",
    ", the graph @xmath94 has a subgraph @xmath95 which has chromatic number at least @xmath35 and girth at least @xmath34 .",
    "it follows that @xmath22 contains the @xmath24-subdivision of a graph with chromatic number at least @xmath35 and girth at least @xmath34 .",
    "thus conjecture  [ conj : nd ] holds .",
    "assume that conjecture  [ conj : thomassen ] holds .",
    "define @xmath87 , and let @xmath88 .",
    "let @xmath96 . according to the statement of the conjecture",
    ", there exists @xmath37 such that every graph with average degree at least @xmath37 has a subgraph with girth at least @xmath97 and average degree at least @xmath91 hence a subgraph with girth at least @xmath97 and minimum degree at least @xmath92 .",
    "let @xmath16 be such that @xmath22 includes the @xmath85-subdivision of a graph with average degree at least @xmath37 .",
    "then @xmath22 has a subgraph which is the @xmath85-subdivision of a graph @xmath0 with minimum degree at least @xmath92 and girth at least @xmath97 . according to lemma  [ lem : dvo ]",
    ", @xmath0 has a subgraph which is the @xmath75-subdivision of a graph with chromatic number at least @xmath35 .",
    "this subgraph is a @xmath24-subdivision of a graph with girth at least @xmath34 and chromatic number at least @xmath35 .",
    "thus conjecture  [ conj : nd ] holds .",
    "suppose that an @xmath0-coloring problem is first - order definable . by this",
    "we mean that there is a first - order sentence @xmath98 such that @xmath99    it immediately follows that @xmath100 is preserved by homomorphisms : @xmath101 ( for otherwise @xmath102 hence @xmath103 , a contradiction ) .",
    "such a property suggests that such a formula @xmath98 could be equivalent to a formula with a specific syntactic form . indeed the classical _ homomorphism preservation theorem _ ( hpt ) asserts that a first - order formula is preserved under homomorphisms on all structures if , and only if , it is logically equivalent to an existential - positive formula .",
    "the terms `` all structures '' , which means finite and infinite structures , is crucial in the statement of these theorems .",
    "it was not known until recently whether hpt would hold when relativized to the finite .",
    "in fact other well known theorems relating preservation under some specified algebraic operation and certain syntactic forms , like o - tarski theorem or lyndon s theorem , fail in the finite .",
    "however , the finite relativization of the homomorphism preservation has been proved to hold by b. rossman @xcite for general relational structures .",
    "[ thm : rossman ] let @xmath10 be a first order formula .",
    "then , @xmath104 holds for all finite relational structures @xmath105 and @xmath106 if and only if for finite relational structures @xmath10 is equivalent to an existential first - order formula .",
    "it follows that for finite relational structures , the only @xmath106-coloring problems which are expressible in first - order logic are those for which there exists a finite family @xmath5 of finite structures with the property that for every structure @xmath105 the following finite homomorphism duality holds : @xmath107    in this paper , we will be mostly interested by graphs , although relational structures will be considered in section  [ sec : ard ] .",
    "definitions and constructions concerning relational structures are particularly discussed in section  [ sec : rel ] .",
    "if we want to relativize theorem  [ thm : rossman ] , we should consider each relativization as a new problem .",
    "the o - tarski theorem , for instance , holds in general , yet fails when relativized to the finite , but holds when relativized to hereditary classes of structures with bounded degree which are closed under disjoint union @xcite .",
    "these examples stress again that some properties of structures ( in general ) and graphs ( in particular ) need , at times , to be studied in the context of a fixed class , in order to state a relativized version of a general statement which could fail in general .    in this context atserias ,",
    "dawar and kolaitis defined classes of graphs called _ wide _ , _ almost wide _ and _ quasi - wide _ ( cf .",
    "@xcite for instance ) .",
    "it has been proved in @xcite that the extension preservation theorem holds in any class @xmath1 that is wide , hereditary ( i.e. closed under taking substructures ) and closed under disjoint unions , for instance hereditary classes with bounded degree that are closed under disjoint unions .",
    "also , it has been proved in @xcite @xcite that the homomorphism preservation theorem holds in any class @xmath1 that is almost wide , hereditary and closed under disjoint unions .",
    "almost wide classes of graphs include classes of graphs which exclude a minor @xcite . in  @xcite dawar",
    "proved that the homomorphism preservation theorem holds in any hereditary quasi - wide class that is closed under disjoint unions .",
    "[ thm : hptnd ] let @xmath1 be a hereditary addable quasi - wide class of graphs",
    ". then the homomorphism preservation theorem holds for @xmath1 .",
    "moreover , we have proved that hereditary quasi - wide classes of graphs are exactly hereditary nowhere dense classes @xcite :    [ thm : qw ] a hereditary class of graphs @xmath1 is quasi - wide if and only if it is nowhere dense .",
    "thus it follows from theorems  [ thm : hptnd ] and  [ thm : qw ] that the relativization of the homomorphism preservation theorem holds for every hereditary addable nowhere dense class of graphs .",
    "but nowhere dense classes are not the only classes with relativized homomorphism preservation theorem . in the next section",
    "we show hpt also holds for some nowhere dense classes .",
    "we now show that relativized homomorphism preservation theorems are preserved by particular interpretations , from which will deduce that relativized homomorphism preservation theorems hold for the classes @xmath108 of all @xmath85-subdivisions of ( simple ) finite graphs .",
    "this is of particular interest as somewhere dense classes ( i.e. classes which fail to be nowhere dense ) are characterized by containment of classes @xmath108 for some @xmath85 .    in the framework of the model theoretical notion of _ interpretation _ ( see , for instance @xcite ) , we can construct the @xmath85-subdivision @xmath109 of a graph @xmath22 by means of first - order formulas on the @xmath85-tuples of vertices of @xmath22 :    * vertices of @xmath109 are the equivalence classes @xmath110 of the @xmath111-tuples @xmath112 with form @xmath113 where @xmath14 and @xmath15 are adjacent vertices in @xmath22 ( and @xmath114 ) , where tuples of the form @xmath115 are identified ; * edges of @xmath109 are those pairs @xmath116 where @xmath110 and @xmath117 have representative of the form @xmath118 ( for some @xmath119 and @xmath120 ) .",
    "the main interest of such a logical construction ( called _ interpretation _ ) lies in the following property :    [ prop : interpret ] for every first - order formula @xmath121 $ ] there exists a formula @xmath122 $ ] with @xmath123 free variables ( each @xmath124 represents a succession of @xmath111 free variables ) such that for every graph @xmath22 and every @xmath125 the three following conditions are equivalent :    1 .",
    "@xmath126 $ ] ; 2 .   there exist @xmath127 such that @xmath128 $ ] ; 3 .",
    "for all @xmath127 it holds @xmath128 $ ] .",
    "in particular , it holds :    [ cor : sub ] for every sentence ( i.e. closed first order formula ) @xmath10 ( in the language of graphs ) there exists a sentence @xmath129 such that for every graph @xmath22 we have @xmath130    if the homomorphism preservation theorem holds for a hereditary class of graphs @xmath1 , it also holds for the class @xmath131 of all @xmath85-subdivisions of the graphs in @xmath1 .",
    "if @xmath85 is odd then the property is obvious as @xmath1 contains at most two homomorphism equivalence classes , the one of @xmath132 and the one of @xmath133 .",
    "hence we can assume @xmath85 is even and we define @xmath134 .",
    "let @xmath10 be a sentence preserved by homomorphisms on @xmath135 , where @xmath1 is a hereditary class of graphs on which the homomorphism preservation theorem holds .",
    "then we shall prove that there exists a finite family of @xmath136-subdivided graphs @xmath5 , all of which satisfy @xmath10 , and such that for any graph @xmath22 it holds @xmath137    according to corollary  [ cor : sub ] there exists a sentence @xmath129 such that for every graph @xmath22 it holds @xmath138 assume that @xmath139 and @xmath140 , with @xmath141",
    ". then @xmath142 and @xmath143 .",
    "as @xmath10 is preserved by homomorphisms on @xmath135 we get @xmath144 hence @xmath145 .",
    "thus @xmath129 is preserved by homomorphisms on @xmath1 .",
    "as the homomorphism preservation theorem holds by assumption on @xmath1 , @xmath129 is equivalent on @xmath1 with a positive first - order formula , that is : there exits a finite family @xmath146 of finite graphs such that for every @xmath16 it holds : @xmath147 moreover , by considering the subgraphs induced by the homomorphic images of the graphs @xmath148 and as @xmath1 is hereditary , we can assume @xmath149 .",
    "thus every @xmath148 satisfies @xmath129 hence the @xmath136-subdivision of the graphs in @xmath146 satisfy @xmath10 . let @xmath5 be the set of the @xmath136-subdivisions of the graphs in @xmath146 .",
    "as @xmath10 is preserved by homomorphisms on @xmath135 it follows that for every graph @xmath16 if there exists @xmath150 such that @xmath151 then @xmath152 satisfies @xmath10 .",
    "conversely , if @xmath152 satisfies @xmath10 for some @xmath16 then @xmath22 satisfies @xmath129 , thus there exists @xmath148 such that @xmath153 hence @xmath154 .",
    "we deduce this extension of rossman s theorem to the class of @xmath24-subdivided graphs :    [ cor : subhpt ] for every integer @xmath24 , the homomorphism preservation theorem holds for @xmath155 .    for a discussion on relativization of the homomorphism preservation theorem",
    ", we refer the reader to ( * ? ? ?",
    "* chapter  10 ) .",
    "we summarize below the results obtained in this section :    [ lem : chpt ] let @xmath1 be a hereditary class of graphs .",
    "assume @xmath0-coloring is first - order definable on @xmath60 .",
    "* if @xmath60 is topologically closed and somewhere dense , then there exist an integer @xmath24 ( independent of @xmath0 ) and a finite set @xmath156 of finite graphs such that for every graph @xmath22 it holds @xmath157 * if @xmath60 is addable and nowhere dense , then there exists a finite set @xmath156 of finite graphs such that for every graph @xmath30 it holds @xmath158    if @xmath60 is topologically closed and somewhere dense , then there exist an integer @xmath24 such that the class @xmath159 of all @xmath136-subdivisions of finite graphs is a subclass of @xmath1 . as @xmath0-coloring is first - order definable on @xmath1 ( thus on @xmath159 ) and",
    "as the homomorphism preservation theorem holds for @xmath159 ( according to corollary  [ cor : subhpt ] ) , @xmath0-coloring may be expressed on @xmath159 by an existential first - order formulas , that is there exists a finite set @xmath156 of finite graphs such that for every graph @xmath22 equivalence   holds .    if @xmath60 is addable and nowhere dense , then the existence of a finite set @xmath156 of finite graphs such that for every graph @xmath30 equivalence   holds immediately follows from theorem  [ thm : hptnd ] .",
    "homomorphism preservation theorems allow to reduce the study of first - order colorings of a class @xmath1 to the study of finite restricted dualities of @xmath1 , that is of pairs @xmath160 , where @xmath5 is a finite set of finite graphs , where @xmath0 is a graph , and where it holds @xmath161    in general , it is not required that @xmath162 when @xmath150 , nor is it required that the graphs in @xmath5 are connected .",
    "we shall see that if the class @xmath1 is addable or monotone then we can require the graphs in @xmath5 to be connected , and that if @xmath1 is monotone we can further require every @xmath150 belongs to @xmath1 ( hence can not be homomorphic to @xmath0 ) .    for a graph @xmath22 ,",
    "we define @xmath163 has the set of all the graphs @xmath74 obtained from @xmath22 by identifying two vertices of @xmath22 .",
    "note that we have the following property :    [ lem : pre ] let @xmath164 be graphs . then @xmath153 if and only if either @xmath19 is isomorphic to a subgraph of @xmath22 , or there is @xmath165 such that @xmath166 .",
    "assume @xmath167 is a homomorphism .",
    "either @xmath168 is injective and @xmath19 is isomorphic to a subgraph of @xmath22 , or at least two vertices of @xmath19 are identified by @xmath168 and thus there is @xmath165 such that @xmath166 .",
    "conversely , if @xmath19 is isomorphic to a subgraph of @xmath22 or if there is @xmath165 such that @xmath166 then obviously @xmath153 .",
    "let @xmath1 be a class of graphs and let @xmath169 be a restricted duality of @xmath1 .",
    "we say that the set @xmath5 is _ minimal _ if    * every element of @xmath156 is a _ core _",
    "( that is a graph @xmath19 such that every homomorphism @xmath170 is an automorphism ) ; * for any proper subset of @xmath171 of @xmath5 , the pair @xmath172 is not a restricted duality of @xmath1 , * and for any @xmath150 , the pair @xmath173 is not a restricted duality of @xmath1 .",
    "it is clear that we can restrict our attention to minimal restricted dualities , as if @xmath169 is a restricted duality of a class @xmath1 then there exists minimal @xmath174 such that @xmath172 is a restricted duality of @xmath1 .",
    "let @xmath160 be a restricted duality of @xmath1 , with @xmath5 minimal .",
    "* if the class @xmath1 is addable , then every graph in @xmath5 is connected . * if the class @xmath1 is monotone , then every graph in @xmath5 is connected and @xmath175 ( hence @xmath162 holds for every @xmath176 ) .",
    "assume @xmath1 is addable , and assume for contradiction that @xmath177 .",
    "by minimality of @xmath5 , neither @xmath178 nor @xmath179 are restricted dualities of @xmath1 .",
    "hence there exist @xmath180 such that @xmath181 , @xmath182 ( hence @xmath183 ) , @xmath184 , @xmath185 ( hence @xmath186 ) .",
    "as @xmath60 is addable , @xmath187 .",
    "but @xmath188 , what contradicts @xmath189 .",
    "assume @xmath1 is monotone , and assume @xmath150 .",
    "by minimality of @xmath5 , there exists @xmath16 such that @xmath190 but no graph @xmath165 is homomorphic to @xmath22 .",
    "according to lemma  [ lem : pre ] , @xmath19 is isomorphic to a subgraph of @xmath22 hence , as @xmath1 is monotone , @xmath191 .",
    "assume for contradiction that @xmath192 .",
    "then @xmath193 and none of @xmath194 is homomorphic to the other . by minimality of @xmath5",
    "it follows that @xmath195 , @xmath196 hence @xmath197 , contradicting @xmath177 .",
    "as restricted dualities appear as the central notion when dealing with first - order definable coloring , we take time to define and characterize classes with all restricted dualities in the more general framework of relational structures .",
    "we recall some basic definitions , notations and result of model theory .",
    "our terminology is standard , cf @xcite :    a _ signature _",
    "@xmath4 is a finite set of relation symbols , each with a specified arity .",
    "a _ @xmath4-structure _ @xmath198 consists of a _ universe _",
    "@xmath199 , or _ domain _ , and an _ interpretation _ which associates to each relation symbol @xmath200 of some arity @xmath201 , a relation @xmath202 .",
    "a @xmath4-structure @xmath203 is a _ substructure _ of @xmath198 if @xmath204 and @xmath205 for every @xmath206 .",
    "it is an _ induced substructure _ if @xmath207 for every @xmath206 of arity @xmath201 .",
    "notice the analogy with the graph - theoretical concept of subgraph and induced subgraph .",
    "a substructure @xmath203 of @xmath198 is _ proper _ if @xmath208 .",
    "if @xmath198 is an induced substructure of @xmath203 , we say that @xmath203 is an _ extension _ of @xmath198 .",
    "if @xmath198 is a proper induced substructure , then @xmath203 is a _",
    "proper extension_. if @xmath203 is the disjoint union of @xmath198 with another @xmath4-structure , we say that @xmath203 is a _ disjoint extension _ of @xmath198 .",
    "if @xmath209 is a subset of the universe of @xmath198 , then @xmath210 denotes the _ induced substructure generated by _ @xmath211 ; in other words , the universe of @xmath210 is @xmath211 , and the interpretation in @xmath212 of the @xmath201-ary relation symbol @xmath213 is @xmath214 .",
    "the _ gaifman graph _",
    "@xmath215 of a @xmath4-structure @xmath49 is the graph with vertex set @xmath199 in which two vertices @xmath216 are adjacent if and only if there exists a relation @xmath213 of arity @xmath217 in @xmath4 and @xmath218 such that @xmath219 and @xmath220 .    a _ block _ of a @xmath4-structure @xmath49 is a tuple @xmath221 such that @xmath206 has arity @xmath62 and @xmath222 .",
    "the _ incidence graph _",
    "@xmath223 is the bipartite graph @xmath224 where @xmath199 is the universe of @xmath49 , @xmath225 is the set of all _ blocks _ of @xmath49 , and @xmath226 is the set of the pairs @xmath227 such that @xmath228 .",
    "thus for us @xmath223 is a simple graph .",
    "no multiple edges are needed for our purposes .",
    "a _ homomorphism _ @xmath229 between two @xmath4-structure is defined as a mapping @xmath230 which satisfies for every relational symbol @xmath206 the following : @xmath231 the class of all @xmath4-structures is denoted by @xmath232 .",
    "the definition of bounded expansion extends to classes of relational structures : a class @xmath1 of relational structures has _",
    "bounded expansion _ if the class of the gaifman graphs of the structures in @xmath60 has bounded expansion .",
    "it is immediate that two relational structures have the same gaifman graph if they have the same incidence graph , but that the converse does not hold in general . for a class of relational structures @xmath1 , denote by @xmath233 the class of all the incidence graphs @xmath234 of the relational structures @xmath235 .",
    "[ prop : ig ] assume that the arities of the relational symbols in @xmath4 are bounded , and let @xmath1 be an infinite class of @xmath4-structures .",
    "then the class @xmath1 has bounded expansion if and only if the class @xmath233 has bounded expansion .      a class of @xmath4-structures @xmath49 has _ all restricted dualities _",
    "if every non - empty connected @xmath4-structure has a restricted dual for @xmath236 , that is : for every non - empty connected @xmath4-structure @xmath52 there exists a @xmath4-structure @xmath237 such that @xmath238 and    @xmath239    note that this definition implies that also for any finite set @xmath240 of connected @xmath4-structures there exists a @xmath4-structure @xmath241 such that @xmath242 ( for @xmath243 ) and    @xmath244    for a structure @xmath245 and an integer @xmath45 , define @xmath246 as the minimum order of a structure @xmath247 such that    * @xmath248 , * every substructure @xmath52 of @xmath247 with order @xmath53 has a homomorphism to @xmath49 .",
    "intuitively , such a structure @xmath247 can be seen as approximate core of @xmath198 : for @xmath249 , @xmath198 and @xmath203 are homomorphism - equivalent and @xmath203 is the core of @xmath198 ( alternately , @xmath203 is the minimal retract of @xmath198 ) . a structure @xmath247 with the above properties and order @xmath250",
    "is called a _ @xmath45-approximation _ of ( the homomorphism equivalence class of ) @xmath49 .",
    "it appears that existence of a uniform approximation is equivalent for a class to having all restricted dualities .",
    "this is formalized by theorem  [ thm : approx ] , stated in the introduction .",
    "theorem  [ thm : approx ] will be proved now :    assume @xmath1 is bounded and has all restricted dualities and let @xmath251 be an integer .",
    "let @xmath252 be a strict bound of @xmath1 , that is a structure such that for every @xmath47 it holds @xmath253 but @xmath254 . as the sequence @xmath255 is obviously non - decreasing , we may assume without loss of generality that @xmath256 . for a structure @xmath235 ,",
    "let @xmath257 be the set of all connected cores @xmath258 of order at most @xmath45 such that @xmath259 .",
    "this set is not empty as it contains the core of @xmath252 .",
    "for @xmath260 , let @xmath261 be the dual of @xmath258 relative to @xmath1 and let @xmath262 be the product of all the @xmath261 for @xmath260 .",
    "first notice that for every @xmath260 we have @xmath263 hence @xmath264 .",
    "it follows that @xmath265 .",
    "let @xmath266 be a connected substructure of order at most @xmath45 of @xmath267 .",
    "suppose for a contradiction that @xmath268 .",
    "then @xmath269 hence @xmath270 thus @xmath271 ( as for otherwise @xmath272 ) , a contradiction .",
    "thus @xmath273 .",
    "it follows that @xmath274 for some suitable finite constant @xmath275 independent of @xmath245 ( for instance , one can choose @xmath275 to be the product of the orders of all the duals relative to @xmath1 of connected cores of order at most @xmath45 ) .",
    "conversely , assume that we have @xmath276 for every @xmath251 .",
    "the class @xmath1 is obviously bounded by the disjoint union of all non - isomorphic minimal order @xmath75-approximations of the structures in @xmath1 .",
    "let @xmath277 be a connected @xmath4-structure , let @xmath278 , and let @xmath279 be a set of @xmath45-approximations of all the structures @xmath235 such that @xmath280 .",
    "as all the @xmath246 are bounded by some constant @xmath275 , the set @xmath279 is finite .",
    "if @xmath279 is empty , let @xmath281 be the empty substructure .",
    "otherwise , let @xmath282 be the disjoint union of all the graphs in @xmath279 .",
    "first notice that @xmath283 as for otherwise @xmath277 would have a homomorphism to some structure in @xmath279 ( as @xmath277 is connected ) , that is to some @xmath45-approximation @xmath284 of a structure @xmath285 such that @xmath286 ( this would contradict @xmath287 ) .",
    "also , if @xmath288 then @xmath289 ( for otherwise @xmath290 ) and if @xmath291 then @xmath279 contains a @xmath45-approximation @xmath267 of @xmath49 thus @xmath292 .",
    "altogether , @xmath282 is a dual of @xmath277 relative to @xmath1 .",
    "we proved in @xcite that bounded expansion classes have all restricted dualities :    [ thm : dual ] let @xmath1 be a class with bounded expansion .",
    "then for every connected graph @xmath19 there exists a graph @xmath6 such that @xmath293 is a restricted homomorphism duality for @xmath1 : @xmath294    theorem  [ thm : dual ] naturally extends to relational structures by considering gaifman graphs .",
    "we sketch a proof of this generalization , which is based on the above theorem  [ thm : approx ] .",
    "[ thm : dual_struc ] let @xmath295 be a class of relational structures . if the class of the gaifman graphs of the structures in @xmath295 has bounded expansion then the class @xmath295 has all restricted dualities .",
    "let @xmath295 be a class of relational structures .",
    "assume the class of the gaifman graphs of the structures in @xmath295 has bounded expansion .",
    "let @xmath296 , and let @xmath251 be at least as large as the maximum arity of a relation in the signature of @xmath198 .",
    "the _ tree - depth _ @xmath297 of a graph @xmath22 is the minimum height of a rooted forest whose closure includes @xmath22 as a subgraph .",
    "one of the most interesting properties of tree - depth is that there exists a function @xmath298 with the property that if the gaifman graph of a structure @xmath203 has tree - depth at most @xmath45 then there exists a homomorphism @xmath299 such that @xmath300  @xcite .",
    "for integer @xmath45 , we defined in @xcite the graph invariant @xmath301 as follows : for a graph @xmath22 , @xmath302 is the minimum number of colors needed in a coloring of @xmath22 such that the union of every subset of @xmath303 color classes induces a subgraph with tree - depth at most @xmath62 ( such colorings are called _ low tree - depth colorings _ ) .",
    "it has been proved in  @xcite that a class of graphs @xmath1 has bounded expansion if and only if for every integer @xmath45 it holds @xmath304 ( this is related to theorem  [ thm : bechi ] above ) .    consider a coloring @xmath41 of the gaifman graph of @xmath198 by @xmath305 colors , which is such that the union of every subset of @xmath303 color classes induces a subgraph with tree - depth at most @xmath62 .",
    "it follows that for each @xmath306}{t}$ ] there exists a homomorphism @xmath307 such that @xmath308 , where @xmath309 denotes the substructure of @xmath198 induced by elements with color in @xmath310 .",
    "define the equivalence relation @xmath311 on the domain of @xmath49 by @xmath312}{t}\\ f_i(x)=f_i(y).\\ ] ] define the structure @xmath313 ( with same signature as @xmath49 ) whose domain is the set of the equivalence classes @xmath314\\in   a/\\sim$ ] , and relations are defined by @xmath315,\\dots,[x_{k_i}])\\in r_i^{\\hat{\\mathbf{a}}}\\quad\\iff\\quad \\forall i\\in\\binom{[n]}{t}\\   ( f_i(x_1),\\dots , f_i(x_{k_i}))\\in r_i^{\\mathbf{a}}.\\ ] ]    we also define a @xmath37-coloration of @xmath313 by @xmath316)=c(x)$ ] .",
    "one checks easily that @xmath313 and @xmath317 are well defined . by construction ,",
    "$ ] is a homomorphism @xmath319 .",
    "moreover , for every @xmath306}{t}$ ] the mapping @xmath314\\mapsto f_i(x)$ ] is a homomorphism @xmath320 ( where @xmath321 is the substructure of @xmath313 induced by colors in @xmath310 ) .",
    "it follows that @xmath322 according to theorem  [ thm : approx ] , this implies that the class @xmath323 has all restricted dualities .    for an alternate proof of this theorem",
    ", we refer the reader to  @xcite .",
    "the special case of topologically closed classes of graphs is of particular interest here , and we have in this case a much simpler characterization of the classes that have all restricted dualities .",
    "we are now ready to prove theorem  [ thm : sub ] .",
    "the proof follows from the next three implications :    * ( 1)@xmath324 ( 2 ) is a direct consequence of theorem  [ thm : dual ] . *",
    "( 2)@xmath324 ( 3 ) is straightforward ( consider for @xmath44 a dual of @xmath325 for @xmath1 ) . *",
    "( 3)@xmath324 ( 1 ) is proved by contradiction : assume that ( 3 ) holds and that @xmath1 does not have bounded expansion . according to theorem  [ thm : bechi ] there exists an integer @xmath24 such that @xmath69 has unbounded chromatic number . as @xmath1",
    "is topologically closed there exists an odd integer @xmath326 and a graph @xmath327 such that @xmath328 is the @xmath329-subdivision of a graph @xmath330 with chromatic number @xmath331 . according to ( 3 )",
    ", there exists a homomorphism @xmath332 . as @xmath333 , the ends of a path of length @xmath34 can not have the same image by @xmath168 .",
    "it follows that any two adjacent vertices in @xmath330 correspond to branching vertices of @xmath328 which are mapped by @xmath168 to distinct vertices of @xmath44 .",
    "it follows that @xmath334 , a contradiction .",
    "in this section we prove our main characterization result on first - order definable colorings , stated in the introduction as theorem  [ thm : main ] .",
    "assume that the class @xmath1 is somewhere dense .",
    "as @xmath60 is topologically closed , there exists an integer @xmath24 such that @xmath335 .",
    "assume for contradiction that there exists a non - bipartite graph @xmath0 ( different from @xmath132 ) of odd - girth strictly greater than @xmath27 and a first - order formula @xmath98 such that for every graph @xmath16 holds @xmath336 according to corollary  [ cor : subhpt ] , as @xmath337 is preserved by homomorphisms on @xmath1 ( hence on @xmath338 ) it is equivalent on @xmath338 with an existential first - order formula , that is : there exists a finite family @xmath5 such that for every graph @xmath22 it holds : @xmath339 clearly , the graphs in @xmath5 are non - bipartite .",
    "let @xmath34 be the maximum of girth of graphs in @xmath5 and let @xmath22 be a graph with chromatic number @xmath340 and odd - girth @xmath341 . then for every @xmath150 we have @xmath342 hence @xmath343 .",
    "however , has the odd - girth of @xmath0 is strictly greater than @xmath27 two branching vertices of @xmath152 corresponding to adjacent vertices of @xmath22 can not be mapped to a same vertex .",
    "it follows that @xmath344 , a contradiction .    to the opposite , if @xmath1 has bounded expansion , there exists for every integer @xmath24 a non - bipartite graph @xmath28 of odd - girth strictly greater than @xmath27 and a first order formula @xmath32 such that for every graph @xmath16 holds @xmath345 indeed , consider for @xmath32 the formula asserting that @xmath22 contains an odd cycle of length at most @xmath27 , and for @xmath28 the restricted dual of the cycle @xmath346 with respect to @xmath1 ( whose existence follows from theorem  [ thm : dual ] .",
    "now assume that conjecture  [ conj : nd ] holds , and that @xmath1 is a hereditary topologically closed addable nowhere dense class that is not a bounded expansion class .",
    "then there exists an integer @xmath24 such that @xmath1 includes @xmath136-subdivisions of graph with arbitrarily large chromatic number and girth . assume for contradiction that there is a non - bipartite graph @xmath28 of odd - girth strictly greater than @xmath27 such",
    "that @xmath28-coloring is first - order definable on @xmath1 , and let @xmath98 be a formula such that for every @xmath16 it holds @xmath347 if and only if @xmath348 . according to theorem  [ thm : hptnd ]",
    ", there exists a finite family @xmath5 of finite graphs such that @xmath349 if and only if no graph in @xmath5 is homomorphic to @xmath22 .",
    "the graphs in @xmath5 are non - bipartite ( @xmath1 contains long odd cycles homomorphic to @xmath28 ) .",
    "let @xmath34 be the maximum of the odd - girths of the graphs in @xmath156 .",
    "let @xmath16 be a @xmath136-subdivision of a graph @xmath0 with girth greater than @xmath34 and chromatic number @xmath350 .",
    "as the girth of @xmath22 is greater than @xmath34 , no graph in @xmath156 is homomorphic to @xmath22 hence there exists a homomorphism @xmath351 . as @xmath352 it follows that vertices of @xmath22 linked by a path of length @xmath27 are mapped to distinct vertices of @xmath28 hence @xmath168 defines a homomorphism @xmath353 , contradicting @xmath350 .",
    "10        a.  atserias , a.  dawar , and m.  grohe , _ preservation under extensions on well - behaved finite structures _ , 32nd international colloquium on automata , languages and programming ( icalp ) ( springer - verlag , ed . ) , lecture notes in computer science , vol . 3580 , 2005 , pp .",
    "14371449 .",
    "a.  atserias , a.  dawar , and p.g .",
    "kolaitis , _ on preservation under homomorphisms and unions of conjunctive queries _ , proceedings of the twenty - third acm sigmod - sigact - sigart symposium on principles of database systems , acm press , 2004 , pp .  319  329 .",
    "a.  dawar , _ finite model theory on tame classes of structures _",
    ", mathematical foundations of computer science 2007 ( l.  kuera and a.  kuera , eds . ) , lecture notes in computer science , vol",
    ". 4708 , springer , 2007 , pp .",
    "212 .",
    "n.  immerman , _ relational queries computable in polynomial time ( extended abstract ) _ , proceedings of the fourteenth annual acm symposium on theory of computing ( new york , ny , usa ) , stoc 82 , acm , 1982 , pp .",
    "147152 .",
    "to3em , _ sparse combinatorial structures : classification and applications _ , proceedings of the international congress of mathematicians 2010 ( icm 2010 ) ( hyderabad , india ) ( r.  bhatia and a.  pal , eds . ) , vol .",
    "iv , world scientific , 2010 , pp ."
  ],
  "abstract_text": [
    "<S> we address the problem of characterizing @xmath0-coloring problems that are first - order definable on a fixed class of relational structures . in this context , we give also several characterizations of a homomorphism dualities arising in a class of structure .    graph , coloring , first - order logic , bounded expansion class </S>"
  ]
}