{
  "article_text": [
    "the generalized laplace equation serves as a model for the electric field @xmath0 propagating in living tissue from a low frequency , low amplitude applied current density on the surface of a body .",
    "denoting the conductivity by @xmath1 and a bounded 2-d domain by @xmath2 , the governing equation is @xmath3 the ideal data is the dirichlet - to - neumann ( dn ) map , or voltage - to - current density map @xmath4 , defined by @xmath5 where @xmath6 is a solution to and @xmath7 is the unit normal vector to the surface .",
    "equation serves as the governing equation for the electric field in electrical impedance tomography ( eit ) , and has a rich mathematical history dating back to the problems posed by caldern @xcite : ( 1 ) when does the inverse problem of determining @xmath8 from knowledge @xmath4 have a unique solution , and ( 2 ) how can it be determined ? historical reviews of the answers to these questions can be found in @xcite , and the reader will find that most of the uniqueness proofs have utilized complex geometrical optics ( cgo ) solutions .",
    "some have also been formulated as constructive proofs @xcite , and most of these include pdes known as d - bar , or @xmath9 , equations for the cgo solutions .",
    "these works have given rise to a new class of direct ( noniterative ) reconstruction algorithms known as d - bar methods .",
    "d - bar equations are of the form @xmath10 where @xmath11 may depend on @xmath12 , and the @xmath9 operator is defined by @xmath13 , where @xmath14 .",
    "the common threads in these methods are ( 1 ) a direct relationship between the cgo solutions and the unknown conductivity , ( 2 ) a nonlinear fourier transform , also known as the scattering transform , providing a link between the data and the cgo solution , and ( 3 ) a d - bar equation to be solved for the cgo solutions with respect to a complex - frequency variable .",
    "these steps can be expressed in general terms by @xmath15    to briefly review the history of d - bar methods for the inverse conductivity problem in dimension 2 , we begin with the constructive global uniqueness proof for twice differentiable conductivities @xcite .",
    "the fast method implemented in this paper is based on that work and subsequent theory and implementations including @xcite .",
    "the regularity conditions on the conductivity in @xcite were relaxed to once - differentiable in @xcite , and a reconstruction method based on this work can be found in @xcite . a nearly constructive proof for complex conductivities of the form @xmath16 with @xmath17 , with @xmath18 small was presented in @xcite , and a direct algorithm and implementations can be found in @xcite . a non - constructive proof that applies to complex admittivities with no smallness assumption",
    "is found in @xcite .",
    "astala and pivrinta provide a cgo - based constructive proof for real conductivities @xmath19 and numerical results related to this work can be found in @xcite .",
    "electrical impedance tomography holds great promise as a bedside imaging tool for patients in intensive care . in the 2-d geometry , eit is clinically useful for chest imaging .",
    "conductivity images have been used for monitoring pulmonary perfusion @xcite , determining regional ventilation in the lungs @xcite , detecting extravascular lung water @xcite , and evaluating shifts in lung fluid in congestive heart failure patients @xcite .",
    "regional results have been validated with ct images @xcite and radionuclide scanning @xcite in the presence of pathologies such as atelectasis , pleural effusion , and pneumothorax .",
    "however , the solution of the inverse problem in real - time poses a significant challenge .",
    "d - bar methods have been generally regarded as computationally intensive , but in this work , we show that through parallelization and careful optimization of the computational routines , a fast implementation is capable of providing real - time images from the pairwise current injection system at csu .    in this work",
    ", we chose to optimize the d - bar method based on the uniqueness proof @xcite and subsequent results and implementations @xcite .",
    "many features of the fast implementation also apply to numerical solution methods of other d - bar reconstruction algorithms .",
    "the paper is organized as follows .",
    "section [ sec : background ] contains a brief mathematical description of the d - bar method implemented here .",
    "section [ sec : fast ] describes the fast implementation , parallelized in two different ways .",
    "section [ sec : results ] contains tables of runtimes and reconstructions on three different meshes from a set of data collected on a human subject .",
    "the final two sections contain conclusions and acknowledgments .",
    "we begin with an overview of the d - bar method implemented here , both for the reader s convenience and to place the fast implementation in its mathematical context . for further details ,",
    "see @xcite .",
    "the method begins with a transformation of the generalized laplace equation with conductivity @xmath20 , for some @xmath21 , to the schrdinger equation through the change of variables @xmath22 and @xmath23 , where the point @xmath24 lies in @xmath2 , a bounded , simply connected lipschitz domain in @xmath25 .",
    "this results in @xmath26 under the assumption that @xmath27 is constant in a neighborhood of the boundary of @xmath2 , one can extend to the whole plane , taking @xmath28 outside @xmath2 . without loss of generality",
    ", we will assume @xmath29 in a neighborhood of the boundary .",
    "the existence of cgo solutions to in the plane was established by faddeev @xcite in the context of quantum physics and shown by nachman @xcite to always exist for @xmath30 of the form @xmath22 . introducing the complex parameter @xmath31 , and identifying the spatial variable @xmath32 with the corresponding point in the complex plane , the cgo solution @xmath33 satisfies @xcite @xmath34 the cgo solution closely related to @xmath35 is @xmath36 , defined by @xmath37 .",
    "the conductivity can be obtained directly from @xmath38 or @xmath35 through the formula @xcite @xmath39 and so the key steps in the method are to link the data @xmath4 to the function @xmath36 .",
    "these links are provided by the scattering transform @xmath40 and the d - bar equation for @xmath38 .",
    "the scattering transform is defined by @xmath41 and can be regarded as a nonlinear fourier transform of @xmath30 in light of the asymptotic behavior of @xmath35 .",
    "the d - bar equation satisfied by @xmath38 is @xmath42 where @xmath43 .",
    "the scattering transform is related to the dn data through an equation that requires knowledge of @xmath35 on the boundary of @xmath2 : @xmath44 here @xmath45 denotes the dn map corresponding to the homogeneous conductivity distribution @xmath46 . for the fast implementation , we utilize a linearized approximation to the scattering transform , denoted by @xmath47 , which is defined by replacing @xmath48 by its asymptotic behavior : @xmath49 this approximation was first introduced in @xcite and was later studied in @xcite where it was shown that the d - bar equation with @xmath40 replaced by @xmath47 truncated to a disk of radius @xmath50 in the @xmath51-plane has a unique solution which is smooth with respect to @xmath52 , and the reconstruction is smooth and stable .",
    "further , it was shown that no systematic artifacts are introduced when the method with @xmath47 is applied to piecewise continuous conductivities .    in summary ,",
    "the mathematical steps of the algorithm implemented here are ( 1 ) compute @xmath53 on a disk of radius @xmath50 in the @xmath51-plane , ( 2 ) solve the d - bar equation for each @xmath52 in the region of interest on the disk @xmath54 , and ( 3 ) compute @xmath8 from .",
    "a fast implementation in matlab on a 12 core mac pro with two 2.66 ghz 6 core intel xeon processors and matlab s parallel computing toolbox is capable of computing reconstructions at less than the data acquisition rate of 16 frames / s , or 0.0625 s / frame , of the ace 1 pairwise current injection eit system at csu @xcite .",
    "this demonstrates the feasibility of cgo methods for real - time reconstructions .",
    "in fact , we consider two options for the parallel computations .",
    "ideally , in real - time reconstructions , data is collected , demodulated , and fed directly to the reconstruction algorithm , one frame at a time . in this configuration ,",
    "only the loop over the @xmath52-values in the solution of the d - bar equation is trivially parallelizable .",
    "this accounts for over 95% of the computation time and can be used to obtain real - time reconstructions at a rate of 0.0621 s / frame on 7 cores on a coarse mesh of 562 elements , as reported in section [ sec : results ] .",
    "this approach is structured as shown in algorithm  [ dbaralg_zloop ] .",
    "if a time delay of approximately one second is acceptable to the user , the algorithm can be parallelized over the frames . in this configuration ,",
    "the data is collected , demodulated , and sent to a buffer from which multiple frames are sent to the reconstruction algorithm in batch .",
    "this approach results in an algorithm that is over 99% parallelizable , and the frame rate is even faster . as shown in section [ sec : results ] , reconstructions were computed at a rate of 0.0215 s / frame on 64 cores or 0.0578 s / frame on 12 cores on a mesh of 1931 elements . the computational method for this approach",
    "is shown in algorithm  [ dbaralg_frames ] .",
    "setup phase .",
    "define parameters and compute functions independent of the dynamic dn data , including :    * physical parameters * boundary parameterization and arclength function * current pattern matrix @xmath55 * demodulate the reference data set and form the dn matrix for the reference data set @xmath56 * computational grids in @xmath51-plane and @xmath52-plane * coefficients @xmath57 for expansions of @xmath58 used in @xmath47    load a single frame of the measured data and demodulate compute matrix approximation to dn map , @xmath59 compute @xmath47 simultaneously for all @xmath52 using vector operations compute the pointwise multiplication operator @xmath60 simultaneously for all @xmath52 using vector operations [ zloop1 ] solve d - bar equation for @xmath61 @xmath62    load a batch of frames of the measured data and domain boundary points setup phase .",
    "define parameters and compute functions independent of the dynamic dn data , including :    * physical parameters * boundary parameterization and arclength function * current pattern matrix @xmath55 * demodulate the reference data set and form the dn matrix for the reference data set @xmath56 * demodulate the voltage data * computational grids in @xmath51-plane and @xmath52-plane * coefficients @xmath63 for expansions of @xmath58 used in @xmath47    compute matrix approximation to dn map , @xmath59 compute @xmath47 simultaneously for all @xmath52 using vector operations compute the pointwise multiplication operator @xmath60 simultaneously for all @xmath52 using vector operations [ zloop2 ] solve d - bar equation for @xmath61 @xmath62    we now discuss the computational steps in detail , including numerical approximations of various functions and operations , and numerical solution of the d - bar equation .",
    "the computation of the matrix approximation to the dn map @xmath4 can be accomplished efficiently with inner products , as explained in @xcite . for bipolar current patterns , as applied by ace 1 , the current pattern matrix is first transformed to an orthonormal basis @xmath64 , @xmath65 and @xmath66 , where @xmath67 is the number of linearly independent current patterns , and @xmath68 is the number of electrodes .",
    "the number of linearly independent current patterns depends on the particular choice of current pattern . for a bipolar current pattern that skips @xmath69 electrodes between injection electrodes , @xmath70 .",
    "the voltages are transformed accordingly through the change - of - basis formula to the set denoted by @xmath71 .",
    "the discrete nd map @xmath72 for a given data set @xmath73 is approximated by @xmath74 where @xmath75 is the area of an electrode , @xmath76 is the arclength function @xmath77 for the boundary evaluated at the angle @xmath78 corresponding to the center of the @xmath79 electrode , and @xmath80 ( where @xmath81 . since the voltages sum to zero",
    ", we can then compute the matrix approximation @xmath59 to @xmath82 from @xmath83 .",
    "the scattering transform is computed for @xmath54 , where @xmath50 is chosen empirically . while better reconstructions can often be obtained by considering a non - uniform truncation radius @xmath50",
    ", we consider a disk for simplicity .",
    "non - uniform truncation would not result in appreciable loss of computational speed since over 95% of the computation time is spent in the solution of the d - bar equation . since difference images from a reference frame are being reconstructed here , we implement the scattering transform @xmath84 , introduced in @xcite , in which the dn map for the conductivity @xmath85 is replaced by that of a reference frame @xmath86 .",
    "then @xmath87 the functions @xmath88 and @xmath89 are expanded in the orthonormalized current pattern basis .",
    "the coefficients of the expansions of the functions @xmath90 and @xmath91 in the orthonormalized current pattern basis vectors are computed in the setup phase of the algorithm , and are denoted by @xmath92^t$ ] and @xmath93 , respectively , where @xmath94 then , denoting the discrete inner product over two vectors @xmath6 and @xmath95 of length @xmath68 by @xmath96 , @xmath97 the fast evaluation of this formula is accomplished using inner products and vector operations .",
    "a single grid and multigrid ( 2-grid ) method were introduced in @xcite for the fast computation of lippmann - schwinger type equations that arise in d - bar methods for eit , closely based on the method of vainikko @xcite .",
    "the convolutions are computed as ffts , and the solution of the resulting linear system by a matrix - free method , such as gmres . for difference images , and in particular the data sets considered here , the frame - to - frame change in the data is sufficiently small that the method nearly always converges in one inner and one outer iteration of gmres . in such cases ,",
    "the 1-grid method is significantly faster than the 2-grid method described in @xcite .    to apply this method ,",
    "the d - bar equation is formulated as an integral equation @xmath98 to construct the computational @xmath51-grid , we define the square @xmath99 ^ 2 $ ] where @xmath100 , and we choose @xmath101 for some positive integer @xmath102 .",
    "the step - size for the @xmath51-grid is defined to be @xmath103 , and the final size of the grid is then @xmath104 .",
    "we further choose a computational @xmath52-grid of domain points , which need not be equally spaced .",
    "equation can be written compactly as the linear system @xmath105 { \\mu^{\\mbox{{\\tiny exp}}}_{\\mbox{{\\tiny r}}}}= 1,\\ ] ] where @xmath60 is the pointwise multiplication operator defined by @xmath106 and the action of the operator @xmath107 is given by @xmath108 in our fast implementation , we compute @xmath60 simultaneously for all @xmath52-values in the computational grid using vector operations , which in matlab is more efficient than computing each @xmath60 separately inside the @xmath52-loop shown in step  [ zloop1 ] of algorithm  [ dbaralg_zloop ] and step  [ zloop2 ] of algorithm  [ dbaralg_frames ] .",
    "the action of the operator @xmath107 can be approximated by @xmath109 where @xmath110 is the green s function for the @xmath9 operator , and @xmath111 denotes element - wise multiplication . in matlab , this operation can be performed efficiently using ifftn and fftn .",
    "once the solution @xmath61 to the d - bar equation has been found , the conductivity is given by @xmath112 note that the d - bar equation requires the solution of the linear system for all @xmath51 values in the computational grid , even though we are ultimately only interested in @xmath113 .",
    "it is also to be noted that this method allows for the reconstruction of @xmath27 pointwise in @xmath2 , independent from any other @xmath52 value , and so it is trivially parallelizable over the values in the computational @xmath52-grid .    for maximum computational speed , we invoked matlab with the flag -singlecompthread , which limits matlab to a single computational thread .",
    "this choice is compatible with the parallel computing toolbox , and will restrict each parallel computation to a single core , which proved to be advantageous in the runtimes .",
    "several choices of numerical solvers for the linear system were compared for the fast implementation . here , we use a customized gmres , as opposed to the built - in matlab routine .",
    "this avoids significant overhead in calling external .m files and performing unnecessary error - checking .",
    "to demonstrate the feasibility of clinically useful real - time reconstructions using the d - bar method , we present reconstructions from data collected on the ace 1 ( active complex electrode ) eit system at csu .",
    "the ace 1 system is a bipolar current injection system with 32 active electrodes operating at a user - specified frequency up to 125 khz .",
    "details of the hardware can be found in @xcite .",
    "for the results presented here , difference images of perfusion in a cross - section of the chest of a healthy male subject sitting upright and holding his breath are presented .",
    "360 frames of data were collected at 16 frames / s at 125 khz and current amplitude 0.823 ma .",
    "one frame was chosen as a reference data set and 359 difference images were computed using the fast implementation in section [ sec : fast ] on a uniform @xmath51-grid of size 16 by 16 ( 256 elements ) and a truncation radius of @xmath114 .",
    "all programming was in matlab and utilized the parallel computing toolbox for the parallel solution of the d - bar equation .",
    "in tables  [ table : runtimes_eitmac12_zloop ] and [ table : runtimes_eitmac12_frames ] we compare the performance for each version of the algorithm with various numbers of cores in parallel on a 12 core mac pro with two 2.66 ghz 6 core intel xeon processors using three different spatial grids consisting of a coarse mesh with 562 elements , a medium mesh with 1931 elements , and a fine mesh with 5,916 elements . in tables",
    "[ table : runtimes_tx1_zloop ] and [ table : runtimes_tx1_frames ] we compare the performance on a 64 core linux system with four 2.3 ghz 16 core processors and 512 gb of ram on the same three spatial grids .    comparing all four tables , it is immediately clear that all runtimes utilizing the same number of cores were faster on the mac pro than on the linux system , which is likely due in part to the difference in processor speed .",
    "it is also evident that while adding increasing numbers of parallel cores continues to improve runtimes for algorithm  [ dbaralg_frames ] in table  [ table : frames ] , the runtimes for algorithm  [ dbaralg_zloop ] in table  [ table : zloop ] reach maximum efficiency with a smaller number of cores , after which adding additional parallel cores actually slows the computation .",
    "this optimum number of cores increases as the @xmath52-mesh size increases .",
    "it is well - known in parallel computing that the efficiency gained by adding additional parallel processors follows a  law of diminishing returns , \" embodied by amdahl s law @xcite , which states that the maximum theoretical speedup @xmath115 obtainable when using @xmath102 processors in parallel is given by @xmath116 where @xmath117 is the proportion of the program that is parallelizable .",
    "one can see that as we increase @xmath102 to @xmath118 the maximum theoretical speedup goes to @xmath119 . to compute the actual speedup",
    "obtained using @xmath102 processors , we use @xmath120 , where @xmath121 is the runtime with @xmath102 cores in parallel .    in figure",
    "[ fig : amdahl_eitmac12 ] , the actual speedups obtained on the mac pro using both versions of the parallel algorithm are shown along with the theoretical maximum speedups predicted by .",
    "one can see that the results obtained using algorithm  [ dbaralg_frames ] are much closer to amdahl s ideal values than the results obtained using algorithm  [ dbaralg_zloop ] .",
    "we can also see that the larger the size of the @xmath52-mesh , the more efficient the parallelization becomes ; this is predicted by since increasing the number of elements in the @xmath52-mesh also increases @xmath117 , the parallelizable portion of the program . in figure  [ fig : amdahl_tx1 ] the same plots are included for the 64 core linux system .",
    "it is evident that the additional cores do not provide speedup for algorithm  [ dbaralg_zloop ] , and the divergence from the theoretically predicted speedup by amdahl s law increases with the number of cores , but amdahl s law also predicts the leveling off of speedup at around 20 to 25 cores ; in fact , this happens at around 10 to 12 cores for parallelization over mesh values ( algorithm  [ dbaralg_zloop ] ) .",
    "however , for algorithm  [ dbaralg_frames ] , the speedup continues for all 64 cores , although it is clearly starting to level out at around 60 cores .",
    "[ fig : amdahl_zloop ]     0.75    0.75     0.75    [ table : zloop ]    [ table : frames ]    figure  [ recon ] contains four frames in the reconstruction of the human chest data displayed in the three @xmath52-meshes to illustrate the resolution provided by these mesh choices .",
    "the figure depicts changes due to perfusion .",
    "the heart is at the top , and red represents high conductivity and blue low conductivity .",
    "the images are displayed on the same scale . while the topmost mesh is quite coarse ,",
    "the lungs and heart are clearly visible , and changes are evident .",
    "the medium mesh is significantly better , and probably provides the best compromise for real - time imaging , but this implementation comes with the price of an approximately 1 second delay .",
    "the very fine mesh is included to illustrate highly desirable spatial resolution and the associated runtimes , given in tables  [ table : zloop ] and [ table : frames ] .",
    "-meshes timed in this work of four frames in the sequence of 360 frames showing changes due to perfusion in the chest of a healthy human subject .",
    "the heart is at the top , and red represents high conductivity and blue low conductivity with respect to the reference frame .",
    "the images are displayed on the same scale . ]    from the clinical perspective , difference images are sufficient for some applications , such as real - time detection of a pneumothorax or atelectasis . for other applications , such as distinguishing between blood , water , and mucus in the lung , absolute images may be required , which may require longer computation times .",
    "some applications may also require finer spatial resolution than that presented here .",
    "however , the data is preserved for off - line or delayed reconstruction , and improvements such as the use of additional cores in parallel , faster ffts , and faster processors are likely to yield improved runtimes in the future .",
    "the results presented here show for the first time the d - bar method applied to human chest data collected on a pairwise current injection system .",
    "conductivity changes due to perfusion are clearly visible in the images .",
    "the fast implementation demonstrates the clinical potential of the d - bar algorithm as a reconstruction algorithm for real - time bedside imaging .",
    "the project described was supported by award number 1r21eb016869 - 01a1 from the national institute of biomedical imaging and bioengineering .",
    "the content is solely the responsibility of the authors and does not necessarily represent the official view of the national institute of biomedical imaging and bioengineering or the national institutes of health .",
    "e.  l.  v.  costa , c.  n.  chaves , s.  gomes , m.  a.  beraldo , m.  s.  volpe , m.  r.  tucci , i.  a.  l.  schettino , s.  h.  bohm , c.  r.  .r .",
    "carvalho , h.  tanaka , r.  g.  lima , m.  b.  p.   amato .",
    "real - time detection of pneumothorax using electrical impedance tomography . 36:1230 - 1238 , 2006 .",
    "d.  freimark , m.  arad , r.  sokolover , s.  zlochiver , and s.  abboud .",
    "monitoring lung fluid content in chf patients under intravenous diuretics treatment using bio - impedance measurements . 28:s269s277 , 2007 .",
    "i.  frerichs , j.  hinz , p.  herrmann , g.  weisser , g.  hahn , t.  dudykevych , m.  quintel , g.  hellige .",
    "detection of local lung air content by electrical impedance tomography compared with electron beam ct . 93(2):660 - 6 , 2002 .",
    "i.  frerichs , j.  hinz , p.  herrmann , g.  weisser , g.  hahn , m.  quintel , g.  hellige .",
    "regional lung perfusion as determined by electrical impedance tomography in comparison with electron beam ct imaging . 21:646652 , 2002 .",
    "i.  frerichs , g.  schmitz , s.  pulletz , d.  schdler , g.  zick , j.  scholz , and n.  weiler .",
    "reproducibility of regional lung ventilation distribution determined by electrical impedance tomography during mechanical ventilation . 28:261267 , 2007 .",
    "w.  kunst , a.  vonk noordegraaf , o.  s.  hoekstra , p.  e.  postmus , p.  m.  de vries .",
    "ventilation and perfusion imaging by electrical impedance tomography : a comparison with radionuclide scanning .",
    "19(4):481 - 90 , 1998 .    p.",
    "w.  kunst , a.  vonk noordegraaf , e.  raaijmakers , j.  bakker , a.  b.  groeneveld , p.  e.  postmus , p.  m.  de vries .",
    "electrical impedance tomography in the assessment of extravascular lung water in noncardiogenic acute respiratory failure . 116:16951702 , 1999 .",
    "g.  vainikko , fast solvers of the lippmann  schwinger equation . in",
    "_ direct and inverse problems of mathematical physics _",
    "( newark , de ) , kluwer acad .",
    "< publ , dordrecht , int .",
    "comput .  * 5 * , 423 ( 2000 ) .",
    "j.  a.  victorino , j.  b.  borges , v.  n.  okamoto , g.  f.  j.  matos , m.  r.  tucci , m.  p.  r.  caramez , h.  tanaka , d.  c.  b.  santos , c.  s.  v.  barbas , c.  r.  r.  carvalho , m.  b.  p.  amato .",
    "imbalances in regional lung ventilation : a validation study on electrical impedance tomography . , 169:791800 , 2004 .",
    "a.  vonk noordegraaf , th .",
    "j.  c.  faes , a.  janse , j.  t.  marcus , j.  g.  f.  bronzwaer , p.  e.  postmus , and p.  m.  de vries .",
    "noninvasive assessment of right ventricular diastolic function by electrical impedance tomography . 111:12228 , 1997 ."
  ],
  "abstract_text": [
    "<S> the aim of this paper is to show the feasibility of the d - bar method for real - time 2-d eit reconstructions . </S>",
    "<S> a fast implementation of the d - bar method for reconstructing conductivity changes on a 2-d chest - shaped domain is described . </S>",
    "<S> cross - sectional difference images from the chest of a healthy human subject are presented , demonstrating what can be achieved in real time . </S>",
    "<S> the images constitute the first d - bar images from eit data on a human subject collected on a pairwise current injection system . </S>"
  ]
}