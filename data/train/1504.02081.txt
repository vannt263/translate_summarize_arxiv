{
  "article_text": [
    "to realize the tremendous capacity target of the next generation mobile cellular systems , one promising option is scaling up to massive multiple - input multiple - output ( mimo ) systems @xcite-@xcite . in the massive multiuser mimo ( mu - mimo ) systems , some simple linear pre / post - processing ( transmit precoding / receive combining ) schemes , such as zero - forcing ( zf ) and linear minimum mean - square error ( mmse ) , are able to approach the optimal capacity performance achieved by the dirty paper coding ( dpc ) as the number of antennas goes to infinity @xcite .",
    "moreover , the zf processing that cancels the inter - user interference through channel inversion can be generalized as block diagonalization ( bd ) when the base stations ( bss ) and mobile stations ( mss ) are both equipped with multiple antennas @xcite . for the downlink spatial multiplexing in mu - mimo systems , the bd method achieves sub - optimal capacity performance ; however , it reduces the complexity of the transmitter and receiver structures by providing closed - form precoder and combiner solutions . from a different perspective",
    ", the problems of the downlink beamformer design for signal - to - interference - plus - noise ratio balancing and the downlink physical layer multicasting that aims at minimizing the transmit power in massive mimo systems have been investigated in @xcite and @xcite respectively .",
    "reference @xcite presents a low - complexity algorithm for detection in massive mimo systems based on the likelihood ascent search ( las ) algorithm .    in large - scale mimo systems ,",
    "the large array gain is rendered by a massive number of antennas at the order of a hundred or more @xcite .",
    "conventional pre - processing is performed through modifying the amplitudes and phases of the complex transmit symbols at the baseband and then upconverted to the passband by going through radio frequency ( rf ) chains ( including the digital - to - analog conversion , signal mixing and power amplifying ) , which requires that the number of the rf chains is in the range of hundreds , equal to the number of the antenna elements .",
    "post - processing is similar involving a large number of analog receive rf chains and digital baseband operations .",
    "this leads to unacceptably high implementation cost and energy consumption .",
    "recently , enabled by the cost - effective variable phase shifters , a limited number of rf chains have been applied in the mimo systems @xcite-@xcite .",
    "the analog rf processing provides the high - dimensional phase - only control while the digital baseband processing can be performed in a very low dimension , termed as hybrid processing . under the limited rf chains constraint ,",
    "references @xcite and @xcite investigate the hybrid processing schemes in the point - to - point ( p2p ) mimo systems .",
    "a single - stream communication under the rayleigh fading mimo channels achieves the full diversity order through the equal gain transmission / combining ( egt / egc ) in @xcite , while the multiple - stream transmission under mimo channels is proposed in @xcite .",
    "in addition , @xcite and @xcite implement the hybrid processing to the downlink of the massive mu - mimo systems with single - antenna users . in @xcite , the near - optimal capacity performance , compared to the full - complexity systems , is achieved through the zf baseband precoding combined with the egt processing in the rf domain .",
    "note that this technique also works for the millimeter wave ( mmwave ) channel . in @xcite ,",
    "the phase - only rf precoding are employed to maximize the minimum average data rate of users via a bi - convex approximation approach .",
    "furthermore , in mmwave communications systems , it is possible to build a large antenna array in a compact region and apply hybrid processing technique @xcite-@xcite .",
    "the `` dominant '' paths in p2p mmwave channels are captured through the hybrid processing in @xcite and @xcite , where the former considers the single - stream transmission while the latter enables the multiple - stream communication .",
    "@xcite presents a hybrid processing by decomposing the optimal precoding / combining matrix via orthogonal matching pursuit with the transmit / receive array response vectors as the basis vectors .",
    "reference @xcite can be regarded as a special one - rf - chain case of reference @xcite . on the other hand , in the mmwave mu - mimo systems",
    ", @xcite considers the single - antenna users and designs the analog rf precoding based on the transmit beam directions , while the digital processing ( matched filter , zero - forcing or wiener filter ) performs on the baseband equivalent channels . with the multiple - antenna users ,",
    "some baseband processing schemes such mmse and bd are examined in @xcite , which , however , neglects the design of the analog rf processing .",
    "in addition , a comprehensive limited feedback hybrid precoding scheme is proposed to configure hybrid precoders at the transmitter and analog combiners with a small training and feedback overhead , which is also effective for multiple - antenna users who have only one rf chain @xcite .    in this paper",
    ", we consider the downlink communication of a massive mu - mimo system where the bs and all mss have multiple antennas . with a limited number ( @xmath0 ) of rf chains in bs and mss , hybrid processing is applied as an alternative to the traditional high - cost full dimensional rf and baseband processing .",
    "we propose to utilize the rf precoding and combining to harvest the large array gain provided by the large number of antennas in the massive mu - mimo channels , which shares the similar objective with the above references that study the hybrid processing in the mu - mimo systems .",
    "however , the analog rf processing design for the mu - mimo systems with multiple - antenna mss accommodating multiple data streams per ms is not available in the literature and the novel bs rf precoder design is based on a newly defined `` aggregate intermediate channel '' .",
    "more specifically , the rf combiners of all the mss are obtained by selecting some of the discrete fourier transform ( dft ) bases , while the rf precoder of the bs is designed by extracting the phases of the conjugate transpose of the aggregate intermediate channel which incorporates the ms rf combiners and the original downlink channels . with the designed rf precoder and combiners ,",
    "a low - dimensional bd processing can be performed at the baseband to cancel the inter - user interference , and the whole operation is named the hybrid bd ( hy - bd ) scheme .",
    "the advantages of such a hy - bd scheme can be summarized as follows :    * low implementation cost and low computation complexity ; * applicability to both rayleigh fading and mmwave massive mu - mimo channels .",
    "channel state information ( csi ) is required but not the information of each individual propagation path ; * reduction on the feedback overhead of the rf domain operations .",
    "simulation results demonstrate that the proposed hy - bd scheme achieves a capacity performance that is quite close to , sometimes even higher than , that of the full - complexity bd scheme in @xcite with a lower implementation and computational cost .",
    "the hy - bd scheme is also examined in the mmwave mu - mimo communication channels and compared to the spatially sparse precoding / combining method @xcite initially proposed for su - mimo but extended to mu - mimo in this paper .",
    "we consider the downlink communication of a massive multiuser mimo system shown in fig .",
    "[ fig : system_model ] , where a base station with @xmath1 antennas and @xmath2 rf chains is assumed to schedule @xmath3 mobile stations .",
    "each ms is equipped with @xmath4 antennas and @xmath5 rf chains to support @xmath6 data streams , which means total @xmath7 data streams are handled by the bs . to guarantee the effectiveness of the communication carried by the limited number of rf chains ,",
    "the number of the transmitted steams is constrained by @xmath8 for the bs and @xmath9 for each ms .        at the bs ,",
    "the transmitted symbols are assumed to be processed by a baseband precoder @xmath10 of dimension @xmath11 and then by an rf precoder @xmath12 of dimension @xmath13 .",
    "notably , the baseband precoder @xmath10 enables both amplitude and phase modification , while only phase changes ( phase - only control ) can be realized by @xmath12 since it is implemented by using analog phase shifters .",
    "each entry of @xmath12 is normalized to satisfy @xmath14 , where @xmath15 denotes the amplitude of the @xmath16-th element of @xmath12 .",
    "furthermore , to meet the total transmit power constraint , @xmath10 is normalized to satisfy @xmath17 , where @xmath18 the frobenius norm .",
    "we assume a narrowband flat fading channel model and obtain the received signal of the @xmath19-th ms @xmath20 where @xmath21 is the signal vector for a total of @xmath3 mss , each of which processes a @xmath22 signal vector @xmath23 .",
    "namely , @xmath24^t$ ] , where @xmath25 denotes transpose . and",
    "the signal vector satisfies @xmath26 = \\frac{p}{kn_{s}}\\mathbf{i}_{kn_{s}}$ ] , where @xmath27 denotes conjugate transpose , @xmath28 $ ] denotes expectation , @xmath29 is the average transmit power and @xmath30 is the @xmath31 identity matrix .",
    "@xmath32 is the channel matrix for the @xmath19-th ms , and @xmath33 is the @xmath34 vector of i.i.d .",
    "@xmath35 additive complex gaussian noise . and the processed received signal at the @xmath19-th ms after combining is given by @xmath36 where @xmath37 is the @xmath38 rf combining matrix and @xmath39 is the @xmath40 baseband combining matrix for the @xmath19-th ms .",
    "since @xmath37 is also implemented by the analog phase shifters , all elements of @xmath37 should have the constant amplitude such that @xmath41 .",
    "we define an equivalent baseband channel for each ms as @xmath42 and the entire equivalent multiuser baseband channel can be denoted as @xmath43         = \\left [      \\begin{array}{cccc }             \\mathbf{w}_1^h & \\mathbf{0 } & \\cdots & \\mathbf{0 } \\\\",
    "\\mathbf{0 } & \\mathbf{w}_2^h & \\cdots & \\mathbf{0 } \\\\",
    "\\vdots & \\vdots & \\ddots & \\vdots \\\\",
    "\\mathbf{0 } & \\mathbf{0 } & \\cdots & \\mathbf{w}_k^h      \\end{array }      \\right ]      \\left [                       \\begin{array}{c }             \\mathbf{h}_1",
    "\\\\           \\mathbf{h}_2",
    "\\\\          \\vdots \\\\          \\mathbf{h}_k      \\end{array }      \\right ] \\mathbf{f}.\\ ] ] then the processed received signal at the @xmath19-th ms can also be represented as @xmath44 where @xmath45 is the @xmath46-th to the @xmath47-th columns of @xmath10 , corresponding to the baseband precoding for @xmath23 .",
    "when the gaussian symbols are used by the bs , the sum spectral efficiency achieved will be @xmath48 where @xmath49 is the covariance matrix of both interference and noise .",
    "generally , joint optimization on the rf and baseband precoders and combiners should be an essential method to design the processing scheme that achieves optimal sum spectral efficiency @xmath50 .",
    "however , as stated in @xcite , finding global optima for similar constrained joint optimization problems ( maxmizing @xmath50 while constant - amplitude contraints imposed to the rf analog precoder and combiners ) is often found to be intractable . even in the traditional mu - mimo systems without hybrid processing structure",
    ", it also needs enormous efforts to find a local optimum of sum rate by alternating optimization @xcite . for some recently designed hybrid processing schemes @xcite@xcite-@xcite in the literature , separated rf and baseband processing designs are investigated to obtain satisfying performance without involving a myriad of iterative procedures .",
    "therefore , we choose to separate the rf and baseband domain designs in this paper .      in this paper , the general channel matrix is set as @xmath51^t = [ \\sqrt{\\beta_1}\\mathbf{\\dot{h}}_1^t , \\sqrt{\\beta_2}\\mathbf{\\dot{h}}_2^t , \\cdots , \\sqrt{\\beta_k}\\mathbf{\\dot{h}}_k^t]^t$ ] , where @xmath52 and @xmath53 indicate the large scale path fading and normalized channel matrix respectively for the @xmath19-th ms , satisfying that @xmath54 = n_{bs}n_{ms}$ ] . with the knowledge of the general channel matrix",
    ", we aim to seek the bs hybrid precoders @xmath55 , @xmath56 and the hybrid combiners @xmath57 , @xmath58 s for all @xmath3 mss through the hy - bd scheme , which achieves a sub - optimal spectral efficiency for massive mu - mimo systems by perfectly canceling the inter - user interference .",
    "two kinds of channel models are considered in this paper :    * large i.i.d .",
    "rayleigh fading channel @xmath59 ; * limited scattering mmwave channel @xmath60 .    in the large rayleigh fading channel , which is commonly considered in massive mu - mimo systems , all entries of the normalized channel matrix @xmath53 for the @xmath19-th ms follow i.i.d .",
    "@xmath61 . on the other hand , a large antenna array",
    "is often implemented in mmwave communications to combat the high free - space pathloss @xcite-@xcite .",
    "we adopt the clustered mmwave channel model to characterize the limited scattering feature of the mmwave channel .",
    "the normalized mmwave downlink channel for the @xmath19-th ms @xmath53 is assumed to be the sum of all propagation paths that are scattered in @xmath62 clusters and each cluster contributes @xmath63 paths , which can be expressed as @xmath64 where @xmath65 is the complex gain of the @xmath66-th path in the @xmath67-th cluster , which follows @xmath61 . to reflect the sparsity of the mmwave channel",
    ", both of @xmath62 and @xmath63 should not be too large .",
    "for the @xmath68-th path , @xmath69 and @xmath70 are the azimuth angles of arrival / departure ( aoa / aod ) , while @xmath71 and @xmath72 are the receive and transmit array response vectors at the azimuth angles of @xmath69 and @xmath70 respectively , and the elevation dimension is ignored . within the cluster @xmath66 , @xmath69 and @xmath70 have the uniformly - distributed mean values of @xmath73 and @xmath74 respectively , while the lower and upper bounds of the uniform distribution for @xmath73 and @xmath74 can be defined as @xmath75 $ ] and @xmath76 $ ] .",
    "the angle spreads ( standard deviations ) of @xmath69 and @xmath70 among all clusters are assumed to be constant , denoted as @xmath77 and @xmath78 .",
    "finally , the truncated laplacian distribution is employed to generate all the aods / aoas for this mmwave propagation channel matrix , base on the above parameters .",
    "the uniform linear array ( ula ) is employed by the bs and mss in our study , while the hy - bd scheme in section-[sec : hy_bd_scheme ] can directly be applied to arbitrary antenna arrays . for an n - element ula , the array response vector can be given by @xmath79^t,\\ ] ] where @xmath80 is the wavelength of the carrier , and @xmath81 is the distance between neighboring antenna elements .",
    "the array response vectors of the bs and mss can be written in the form of ( [ eq : ula ] ) .",
    "furthermore , other non - ula antenna geometries , such as uniform planar array ( upa ) , are also examined in the simulations .",
    "in the mu - mimo systems , the generalized zero - forcing method ( i.e. , the traditional bd scheme ) is infeasible to be practically implemented due to the high cost brought by the large number of rf chains as many as the antennas . by reducing the number of rf chains @xmath82 to far less than the antenna elements @xmath83 at both the bs and mss , we propose to utilize the rf precoding matrix @xmath12 at the bs and the rf combining matrix @xmath37 at each ms to harvest the large array gain provided by the large number of antennas in the massive mu - mimo channel . with the found @xmath12 and all @xmath37 s ,",
    "the entire multiuser equivalent baseband channel @xmath84 can be determined based on ( [ eq : ch_eq_all_user ] ) , which consists of all the equivalent channels for the mss , namely @xmath85 .",
    "finally , a low - dimensional bd processing , involving the design of @xmath10 and all @xmath39 s , can be performed at the baseband .      owing to the large number of antennas in the massive mu - mimo systems ,",
    "the channel gains of the equivalent channel @xmath84 can be scaled up through the appropriate phase - only control at the rf domain , which is called the large array gain .",
    "to be noted , each element in @xmath84 represents the equivalent channel gain from one rf chain at the bs to one rf chain at one ms . to achieve the high capacity with such a hybrid processing structure ,",
    "the equivalent channel matrix @xmath84 are desired to have the following properties :    * rank sufficiency : @xmath84 should be well - conditioned to support the multi - stream transmission , which means the rank of @xmath84 should be at least @xmath7 ; * large array gain : @xmath84 should sufficiently harvest the array gain so that it can provide as large gain for each stream transmission as possible .",
    "we propose to pursue the large array gain by enlarging the sum of the squares of the diagonal entries in @xmath84 .    by definition ,",
    "@xmath84 consists of the equivalent channels of all the mss , namely @xmath86 .",
    "we design the rf domain processing matrices @xmath37 s and @xmath12 and construct the equivalent channel @xmath84 by approximately satisfying the above two requirements , which will lead to a suboptimal performance under the hybrid precoding structure , but with significantly low complexity .",
    "assume that all the rf combiners @xmath37 s are given ( the actual design of @xmath37 s will be presented shortly ) .",
    "define an aggregate intermediate channel given by @xmath87_{km_{ms } \\times n_{bs}},\\ ] ]    and then the baseband equivalent channel is @xmath88 . due to the phase shifting ability of the rf precoder and the knowledge of the channel matrix entries , we perform the phase - only rf precoding based on an equal gain transmission ( egt ) method proposed in @xcite to harvest the large array gain , by setting @xmath89 where @xmath90 is the phase of the @xmath91-th element of the conjugate transpose of @xmath92 .",
    "this egt precoding method requires @xmath93 rf chains at the bs , which means @xmath12 is an @xmath94 matrix and @xmath84 should be a square matrix .",
    "the entries along the diagonal of the baseband equivalent channel @xmath84 denote the equivalent channel gains in terms of the rf chains , while the remaining entries indicate the inter - chain interference .",
    "we focus on the large array gain design through the rf precoding / combining and leave the interference canceling to the baseband processing in the hy - bd scheme .",
    "now let us return to the design of the rf combiners @xmath37 s .",
    "denote the @xmath95-th column of @xmath37 as @xmath96 .",
    "as the result of the egt precoding method , the @xmath97-th diagonal entry of @xmath84 is then given by @xmath98 , where @xmath99 denotes the 1-norm of a vector , corresponding to the @xmath95-th rf chain of the @xmath19-th ms .",
    "note that the entries in @xmath84 indicate the rf - chain to rf - chain channel gains and those off - diagonal entries indicate the inter - rf - chain , and even inter - user , interference .",
    "we aim to maximize the sum of the squares of diagonal entries of the baseband equivalent channel @xmath84 , given by @xmath100 , to pursue the large array gain . due the independence of @xmath37 s for all the mss ,",
    "maximizing @xmath100 is equivalent to maximizing @xmath101 for all @xmath102 respectively .",
    "hence , the design of the rf combiners can be obtained by solving @xmath103 herein , we need to clarify that no inter - user interference is designed to be suppressed by solving the simplified maximization problem in ( [ eq : wk_problem ] ) , which , as a heuristic method , does not guarantee the optimality of the sum - rate maximization , but lend tractability to approaching a sub - optimal solution . in this paper , instead of solving the non - convex problem ( [ eq : wk_problem ] ) directly , we modify the constraints to choose from a set of dft basis , as explained in details next . note that @xmath104 , where @xmath105 denotes the @xmath106-th column of @xmath107 .",
    "moreover , the geometric mimo channel models , including the rayleigh fading and the number of paths approaches to infinity . ] and mmwave channels , can be represented in the form of ( [ eq : cl_ch_model ] ) , which means @xmath105 is the linear combination of all the array response vectors of the aoas .",
    "this fact implies that each addition term in @xmath108 , @xmath109 is the absolute value of the summing weighted projections of those array response vectors @xmath71 for all aoas onto @xmath96 . from this perspective",
    ", we first propose to set @xmath96 in the form of array response vector ( [ eq : ula ] ) to extract the gain from these projections , namely , @xmath110^t,\\ ] ] where @xmath111 denotes the corresponding spatial frequency @xcite .",
    "furthermore , to meet the rank sufficiency requirement of @xmath84 , it is desirable that the rank of @xmath107 is not reduced after it being multiplied by @xmath37 . for this purpose ,",
    "we require the columns of @xmath37 to be pairwise orthogonal so that the rank of @xmath112 is lower bounded by @xmath113 ( the rank of the high - dimensional @xmath107 is assumed to be larger than @xmath5 ) , which means the equivalent channel @xmath84 is potentially capable of supporting the transmission of @xmath114 streams . considering the form of @xmath115 ,",
    "we discretize the @xmath116 into @xmath4 levels over @xmath117 and construct @xmath4 bases , given by @xmath118 as the candidates from which the @xmath96 is choosen . as we can see",
    ", these bases in @xmath119 exactly form an @xmath4-dimensional dft basis set , which simultaneously conforms to the rank sufficiency and large arrary gain requirements of @xmath84 . therefore",
    ", we finally design the rf combiners by solving @xmath120 to solve the problem ( [ eq : wk_pro_dft_cons ] ) , we just need to sort all @xmath4 @xmath121 s in the descending order and then choose the first @xmath5 @xmath122 s as the columns of @xmath37 .",
    "note that each ms only needs to solve problem ( [ eq : wk_pro_dft_cons ] ) with the corresponding index @xmath19 for once to obtain its rf combiner .",
    "in addition , the number of antennas @xmath4 of an ms usually is much smaller than @xmath1 due to the actual device size and computational capacity , which makes the exhaustive search on the dft bases acceptable .",
    "based on the selection of the dft bases , the mss can avoid a huge amount of computation overhead for obtaining all the phase shift elements .",
    "in addition , only @xmath6 phase shift elements per ms is needed to be fed back to the bs , so that to the bs is able to re - construct all the @xmath37 s and calculate the aggregate intermediate channel @xmath92 for further processing .      in this section ,",
    "based on the obtained baseband equivalent channel @xmath84 , given the found rf processing matrices @xmath37 and @xmath12 , we perform the low - dimensional bd processing with the baseband precoder @xmath10 and combiners @xmath39 s to cancel the inter - user interference , which forces the interference terms @xmath123 for @xmath124 in ( [ eq : recv_sig_processed ] ) .",
    "the spectral efficiency of the mu - mimo system can be further simplified to @xmath125    to obtain the baseband precoder @xmath126 $ ] , where @xmath45 incorporates the precoding vectors for the data streams of the @xmath19-th ms , we first define @xmath127 as @xmath128^t.\\ ] ] the @xmath45 is supposed to lie in the null space of @xmath127 .",
    "denote the rank of @xmath127 as @xmath129 .",
    "then the singular value decomposition ( svd ) of @xmath127 is given by @xmath130^h,\\ ] ] where @xmath131 consists of the first @xmath132 right singular vectors of @xmath127 , and @xmath133 holds the rest @xmath5 ones which are exactly the orthogonal bases of the null space of @xmath127 .",
    "then we know @xmath134    given the above results , block diagonalization of the baseband equivalent channel matrix to remove inter - user interference is written as @xmath135 \\\\      & = \\left [      \\begin{array}{ccc }             \\tilde{\\mathbf{h}}_1\\overline{\\mathbf{v}}_1^{(m_{ms } ) } & \\cdots & \\mathbf{0 } \\\\           \\vdots & \\ddots & \\vdots \\\\          \\mathbf{0 } & \\cdots & \\tilde{\\mathbf{h}}_k\\overline{\\mathbf{v}}_k^{(m_{ms } ) }      \\end{array }      \\right ] .",
    "\\end{aligned}\\ ] ] until now , all the mss can perform interuser - interference - free multi - stream transmission through their own sub - channels ( the non - zero block in @xmath136 ) .",
    "further precoding / combining will be performed to achieve each ms s optimal spectral efficiency based on svd , given by @xmath137 with the above rank sufficiency requirement , @xmath138 is a @xmath5-by-@xmath5 full - rank sub - channel matrix which enables @xmath139 data streams transmission for the @xmath19-th ms .",
    "therefore , the optimal precoder and combiner on the @xmath19-th effective sub - channel @xmath138 should be @xmath140 and @xmath141 , where @xmath140 and @xmath141 are the first @xmath6 columns of the @xmath142 and @xmath143 respectively .",
    "finally , the overall baseband precoder is given by @xmath144      \\left [      \\begin{array}{ccc }             \\mathbf{v}_1^{(n_s ) } & \\cdots & \\mathbf{0 } \\\\",
    "\\vdots & \\ddots & \\vdots \\\\",
    "\\mathbf{0 } & \\cdots & \\mathbf{v}_k^{(n_s ) }      \\end{array }      \\right ] \\\\      & = \\left[\\overline{\\mathbf{v}}_1^{(m_{ms})}\\mathbf{v}_1^{(n_s)},\\cdots,\\overline{\\mathbf{v}}_k^{(m_{ms})}\\mathbf{v}_k^{(n_s)}\\right]_{km_{ms } \\times kn_s}. \\end{aligned}\\ ] ] and the baseband combiner for the @xmath19-th ms is given by @xmath145 .",
    "the spectral efficiency achieved by the hy - bd scheme finally becomes @xmath146 where @xmath147 is a @xmath31 diagonal matrix that performs water - filling power allocation , and @xmath148 represents the first @xmath149 block partition of @xmath150 . as we choose dft bases ( or any other orthogonal bases ) to construct @xmath37 s , the simplification step ( i ) of ( [ eq : pure_sum_rate ] ) holds due to @xmath151 .    on the other hand ,",
    "since the rf and baseband processing do not require any information of the propagation paths of the channels @xmath107 s , namely , each term in the summation of ( [ eq : cl_ch_model ] ) , the hy - bd scheme can be performed on any kinds of massive mu - mimo channels as long as the channel matrices are provided .      after employing the hy - bd processing scheme ,",
    "the optimal power allocation for transmitted data streams can be achieved by water - filling due to the sum - rate ( sum - log ) maximization form in ( [ eq : pure_sum_rate ] ) . however , considering the real - world scenarios , where fairness among users would often be considered , the pure sum - rate maximization in ( [ eq : pure_sum_rate ] ) is not enough to guarantee the performance for some high - priority mss or mss located farther away from the bs .",
    "therefore , the weighted sum - rate maximization is a more suitable objective when allocating transmission power to achieve proportional fairness .",
    "that is , @xmath152 where @xmath153 is the positive weight for the achievable rate of the @xmath19-th ms . slightly abusing the notation",
    ", we write the @xmath106-th diagonal element of @xmath154 and @xmath155 as @xmath156 and @xmath157 respectively .",
    "then ( [ eq : weighted_k_sum_rate ] ) can be rewritten as a convex optimization problem @xmath158 where @xmath159 and @xmath160 similar to example 5.2 in @xcite , we introduce lagrange multipliers @xmath161 for the inequality constraints @xmath162 and a multiplier @xmath163 for the equality constraints @xmath164 , and the kkt conditions are @xmath165 then we can directly obtain that @xmath166 , which results in @xmath167 where @xmath168 is determined by @xmath169 .",
    "this solution is a revised version of the traditional water - filling power allocation , which takes the weights of all mss into account , termed as proportional water - filling .",
    "an insight from ( [ eq : proportional_wf ] ) can be interpreted as variable water - levels : one ms with a greater weight @xmath170 has a higher water - level @xmath171 , where more power can be allocated , and vice verse .      due to the discretization of receive vectors in analog combiners and the baseband block diagonalization , analyzing the sum spectral performance of the hybrid bd scheme is indeed non - trivial",
    "nevertheless , it is tractable to present the performance analysis of a special case with ula single - path channels and large numbers of transmit and receive antennas ( @xmath172 ) . note that , in the mmwave channels , both the bs and mss need to employ large antenna arrays to harvest adequate receive power from the signals passing through a few propagation paths @xcite",
    "to conduct the performance analysis , we impose the following assumption that each ms only schedules one data stream through the only one rf chain , which is @xmath173 , while the bs is equipped with @xmath174 rf chains .",
    "herein , the single - path channel for the @xmath19-th ms in ( [ eq : cl_ch_model ] ) can be rewritten as @xmath175 where @xmath176 is the result of the large scale path fading @xmath52 multiplied the complex gain of this unique path , while @xmath177 and @xmath178 are the corresponding receive and transmit array response vectors . besides , the analog combiner has only one column , denoted as @xmath179 . with a large number of receive antennas @xmath4",
    ", the candidates of dft bases in problem ( [ eq : wk_pro_dft_cons ] ) will have an infinite resolution . under this circumstance",
    ", we have @xmath180 \\mathbf{a}_{bs}^k(\\phi^k)^h||_1 ^ 2 \\\\      & = \\max_{\\mathbf{w}_k}~\\{\\sqrt{n_{bs}n_{ms}}\\alpha^k [ \\mathbf{w}_k^h\\mathbf{a}_{ms}^k(\\theta^k ) ] \\cdot ||\\mathbf{a}_{bs}^k(\\phi^k)^h||_1\\}^2 \\\\      & = \\max_{\\mathbf{w}_k}~\\{n_{bs}\\sqrt{n_{ms}}\\alpha^k [ \\mathbf{w}_k^h\\mathbf{a}_{ms}^k(\\theta^k)]||_1\\}^2 . \\end{aligned}\\ ] ] therefore , the analog combiner for the @xmath19-th ms should be approximately @xmath181 , selected from the dft bases of infinite resolution when @xmath182 .",
    "in this section , we evaluate the spectral efficiency achieved by the hy - bd scheme as well as its performance robustness in the massive mu - mimo channels .      in the simulations of this section , we illustrate the spectral efficiency achieved by the hy - bd scheme in the massive mu - mimo systems by comparing it with the traditional high - dimensional baseband bd scheme in large i.i.d rayleigh fading and mmwave multiuser channels and also with the previously proposed spatially sparse precoding / combining scheme @xcite in mmwave channels .",
    "the range of the signal - to - noise ratio @xmath193 is from -40 db to 0 db in all processing solutions . and",
    "the large - scale fading path loss factor @xmath194 of all mss are uniformly distributed in @xmath195 $ ] .",
    "all mss have equal unit weights in the simulations .",
    "[ fig : cap_rayleigh ] illustrates the sum spectral efficiency achieved by the traditional bd scheme and our proposed hy - bd scheme in the large i.i.d .",
    "rayleigh fading channel .",
    "the bs with @xmath196 rf chains is employed to schedule @xmath197 mss , each of which processes @xmath198 data streams with @xmath199 rf chains .",
    "furthermore , the bs and mss are equipped with 256 ( 16 ) and 64 ( 4 ) antennas respectively . in both @xmath200 and @xmath201 antenna settings , the sum spectral efficiency of the hy - bd scheme",
    "consistently approaches the performance achieved by the traditional bd scheme , however , with lower implementation and computational complexity .",
    "notably , the results of the @xmath201 antenna setting indicate that the hy - bd scheme is still effective in a small scale antenna system .    in the mmwave mu - mimo channels , the traditional full - complexity bd and hy - bd schemes perform in a similar fashion as in the rayleigh fading channels . based on the limited number of paths scattered in the mmwave channels , the spatially sparse precoding / combining scheme in @xcite can be extended to the hybrid processing in mu - mimo systems through decomposing the solution to the traditional bd scheme ( the precoder @xmath202 and the mmse combiners in @xcite ) via orthogonal matching pursuit where the bs and mss choose the array response vectors of the corresponding aods and aoas as the basis vectors respectively .",
    "[ fig : cap_mmwave_ula_upa ] shows the sum spectral efficiency of the above processing schemes with ula and upa employed respectively .",
    "we set the mmwave propagation channel with @xmath203 and @xmath204 .",
    "the range of the mean azimuth angles of aods at the bs @xmath205 is @xmath206 while the mss are assumed to be omni - directional due to the relatively smaller antenna array elements .",
    "the angle spreads @xmath77 s and @xmath78 s are all equal to @xmath207 ( the settings of azimuth angles are also applied to elevation angles in upa setup ) .",
    "moreover , the bs is set to have @xmath208 antennas and @xmath196 rf chains , while @xmath197 mss , with @xmath209 antennas and @xmath199 rf chains , all dealing with @xmath198 data streams . in this scenario ,",
    "the proposed hy - bd scheme even achieves slightly higher spectral efficiency than the traditional bd scheme , while the performances of the hy - bd scheme and spatially sparse coding scheme are upgraded when the system applies upa instead of ula .",
    "note that the traditional bd scheme is a sub - optimal solution for the processing of mu - mimo systems , and it is possible that the hy - bd outperforms the traditional bd in some situations . as for the spatially sparse precoding / combining scheme , it lags behind the traditional bd and hy - bd schemes because the columns of the traditional bd precoding and combining matrices do not directly come from the linear combination of the array response vectors of aods / aoas , the basic forming units of the rf matrices in the spatially sparse coding scheme @xcite .",
    "this is very different from the p2p scenario that the spatially sparse scheme is designed for , where the columns of the svd based precoder and combiner can be effectively approached by the linear combinations of the array response vectors according to the observation 3 ) in @xcite .",
    "even though the number of rf chains is enlarged to @xmath210 and @xmath211 , the performance of the spatially sparse precoding / combining scheme is still inferior to the full - complexity bd and hy - bd schemes .",
    ".,scaledwidth=45.0% ]    0.45   8-user mu - mimo system in mmwave channels where @xmath212.,title=\"fig : \" ]    0.45   8-user mu - mimo system in mmwave channels where @xmath212.,title=\"fig : \" ]    considering the critical situation that only one data stream is supported by each ms with only rf chain employed ( total 8 mss ) , we are able to further compare our results with the limited feedback hybrid precoding scheme proposed in @xcite in fig . [",
    "fig : cap_mmwave_lf_ula_upa ] .",
    "it shows that the proposed hy - bd scheme still outperforms other baselines .",
    "although the limited feedback hybrid precoding scheme is capable of tracking the strongest path in the mmwave channels , it fails to harvest the large array gain when the mmwave channel for each ms is not extremely sparse since only an rf chain pair is available for each ms to track one propagation path in the rf domain ( we generate 80 paths for each ms s mmwave channel in the simulations of fig .",
    "[ fig : cap_mmwave_lf_ula_upa ] ) .",
    "however , with the hy - bd scheme , the egt enabled by the rf precoder can directly aggregate the channel gains so that the spectral efficiency performance can be guaranteed .",
    "furthermore , the approximate sum spectral efficiency of hybrid bd scheme in ula single - path channels , analyzed in section [ sec : perform_analysis ] is illustrated in fig .",
    "[ fig : cap_analytical ] , where @xmath213 and @xmath214 .",
    "it shows that the hybrid bd performs closely to its analytical approximate version , with about 1 bps / hz degradation , which is caused by limited numbers of transmit and receive antennas as well as the dft restriction . in this circumstance ,",
    "the hybrid bd scheme and limited feedback method obtain similar performance since they are both capable of tracking the channel s unique path .",
    "0.45   8-user mu - mimo system in mmwave channels where @xmath215.,title=\"fig : \" ]    0.45   8-user mu - mimo system in mmwave channels where @xmath215.,title=\"fig : \" ]    .,scaledwidth=45.0% ]      in addition to simply demonstrating the spectral efficiency of the hy - bd scheme under different snrs , we further examine its performance robustness by changing the multiplexing settings ( e.g. , the number of data streams supported by each user and the number of users ) and introducing the channel estimation error .",
    "for the practical implementation of an mu - mimo system , the total number of supported data streams is a very important criterion to evaluate the system performance , which depends on the number of supported mss @xmath3 and the number of data stream supported by each ms @xmath6 , namely , space - division multiple access and spatial multiplexing . in figs .",
    "[ fig : cap_rayleigh_k8_ns124]-[fig : cap_rayleigh_k1_16_ns4 ] , the sum spectral efficiency achieved by the traditional bd scheme and the hy - bd scheme is checked in a @xmath200 8-user mu - mimo system in i.i.d rayleigh fading channels under different snrs , where each ms only employs @xmath216 rf chains ( @xmath217 rf chains at the bs ) in the hy - bd scheme .    in fig .",
    "[ fig : cap_rayleigh_k8_ns124 ] , the number of data streams per ms is set as @xmath218 and the snr ranges from -40 db to 0 db .",
    "the gap between the sum spectral efficiency of the traditional bd scheme and the hy - bd scheme remains minute compared to the absolute sum spectral efficiency .",
    "however , the hy - bd scheme only needs the same number of rf chains as the supported data streams at both bs and mss ( up to @xmath211 and @xmath210 ) , much smaller than that of the traditional bd scheme ( @xmath219 and @xmath220 ) .",
    "[ fig : cap_rayleigh_k8_ns1_16 ] shows the sum spectral efficiency of both schemes when @xmath6 increases from 1 to 16 and the snr is set as @xmath221 and @xmath222 db , which indicates that it is suitable to employ the hy - bd scheme when the total number of data streams in the mu - mimo system is not too large , so that the hy - bd can reach the peak spectral efficiency .",
    "as we can see , the sum spectral efficiency achieved by the traditional bd scheme will be continuously augmented in such a @xmath200 8-user mu - mimo system when the number of transmitted data streams increases , since more equivalent parallel channels ( characterized by the diagonal elements in @xmath223 in @xcite ) can be utilized to transmit the data streams and the effect of inter - user interference is not dominant in this case . however , in the hy - bd scheme , the spectral efficiency performance is somewhat compromised once a large quantity of data streams are transmitted .",
    "this is because the pursuit of the large array gain slightly introduces the inter - stream interference in the rf domain , which will degrade the system spectral efficiency after the baseband bd processing . on the other hand , with an increasing snr ,",
    "the suitable numbers of the supported data streams @xmath6 , corresponding to the peak spectral efficiency , for the traditional bd scheme and hy - bd scheme are also enhanced .",
    "for instance , when snr = @xmath222 db , the traditional bd scheme supports up to @xmath224 data streams which is the maximum number of the supported data streams by a @xmath200 8-user mu - mimo system with full rf chains .",
    "however , the hy - bd scheme can support about @xmath225 data streams with only 64 and 8 rf chains at the bs and ms respectively .    with the same system configuration as that of figs .",
    "[ fig : cap_rayleigh_k8_ns124 ] and [ fig : cap_rayleigh_k8_ns1_16 ] , and the number of data streams per ms set as @xmath226 , the number of mss @xmath3 increases from 1 to 16 in fig .",
    "[ fig : cap_rayleigh_k1_16_ns4 ] . in this case",
    ", the traditional bd scheme with full rf chain configuration reaches a peak spectral efficiency at a certain @xmath3 .",
    "this is because when @xmath3 grows beyond an optimal value , inter - user interference substantially becomes more severe and the sum spectral efficiency is gradually degraded .",
    "as for the hy - bd scheme with the limited rf chain configuration , the sum spectral efficiency keeps improving when @xmath3 increases from 1 to 16 ( the maximum number of supported data stream is still up to @xmath227 ) . by comparing the results of figs .",
    "[ fig : cap_rayleigh_k8_ns1_16 ] and [ fig : cap_rayleigh_k1_16_ns4 ] , the hy - bd scheme can be safely recommended for implementation in systems with a large number of mss , however , each of which deals with a small number of data streams , since it is less vulnerable to the inter - user interference than the traditional bd scheme in this case . as for the case in fig .",
    "[ fig : cap_rayleigh_k8_ns1_16 ] where there are fewer mss and more data streams per ms , the traditional bd scheme achieves superior performance at the cost of high complexity because it can better process the inter - stream interference than the hy - bd scheme .     and",
    "@xmath228.,scaledwidth=45.0% ]     8-user mu - mimo system in i.i.d .",
    "rayleigh fading channels where @xmath6 increases from 1 to 16 and snr = @xmath229 db.,scaledwidth=45.0% ]     mu - mimo system in i.i.d .",
    "rayleigh fading channels where @xmath3 increases from 1 to 16 , snr = @xmath229 db and @xmath226.,scaledwidth=45.0% ]    furthermore , we examine the sum spectral efficiency of both schemes with an increasing @xmath6 or @xmath3 under different snrs ( @xmath221 and @xmath222 db ) in the mmwave mu - mimo channels whose propagation characteristics are given in fig .",
    "[ fig : cap_mmwave_ula_upa ] s settings .",
    "the bs and ms configurations are the same as those of figs .",
    "[ fig : cap_rayleigh_k8_ns1_16 ] and [ fig : cap_rayleigh_k1_16_ns4 ] . here , fig .",
    "[ fig : cap_mmwave_k8_ns1_16 ] illustrates the sum spectral efficiency of both schemes when @xmath6 increases from 1 to 16 with @xmath230 , while fig .",
    "[ fig : cap_mmwave_k1_16_ns4 ] gives the result for the number of mss @xmath3 increasing from 1 to 16 with @xmath226 .",
    "as can be seen , the general trends of the sum spectral efficiency of the traditional bd scheme and the hy - bd scheme in mmwave channels are consistent with those in rayleigh fading channels , except that the hy - bd scheme can perform slightly better in mmwave channels compared with the results in rayleigh fading channels .",
    "it is probably due to the fact that the dft bases selection ( conforming to the forms of aoas / aods array responses of the limited number of paths in mmwave channels ) in the hy - bd scheme essentially captures the dominant paths of the mmwave channels .",
    "8-user mu - mimo system in mmwave channels where @xmath6 increases from 1 to 16 and snr = @xmath229 db.,scaledwidth=45.0% ]     mu - mimo system in mmwave channels where @xmath3 increases from 1 to 16 , snr = @xmath229 db and @xmath226.,scaledwidth=45.0% ]",
    "in this paper , a low - complexity hybrid block diagonalization processing scheme has been proposed for the downlink communication of a massive multiuser mimo system with the limited number of rf chains .",
    "we harvest the large array gain through the phase - only rf precoding and combining and then the bd technique is performed at the equivalent baseband channel .",
    "it has been demonstrated that the hy - bd scheme , with a lower implementation and computational complexity , achieves a capacity performance approaching that of the traditional high - dimensional baseband bd processing .",
    "such a low - complexity , low cost hy - bd scheme can be a promising option for the practical implementation of a massive mu - mimo system .",
    "f.  rusek , d.  persson , b.  k.  lau , e.  g.  larsson , t.  l.  marzetta , o.  edfors , and f.  tufvesson , `` scaling up mimo : opportunities and challenges with very large arrays , '' _ ieee sig . process",
    "_ , vol .  30 , pp .",
    "4060 , jan .",
    "2013 .          q.  h.  spencer , a.  l.  swindlehurst , and m.  haardt , `` zero - forcing methods for downlink spatial multiplexing in multiuser mimo channels , '' _ ieee trans .",
    "on sig . process .",
    "_ , vol .",
    "52 , pp .  461471 , feb .",
    "m.  f.  hanif , le - nam tran , a.  tolli and m.  juntti , `` computationally efficient robust beamforming for sinr balancing in multicell downlink with applications to large antenna array systems , '' _ ieee trans . on commun .",
    "_ , vol .",
    "62 , pp .",
    "1908 - 1920 , june 2014 .",
    "le - nam tran , m.  f.  hanif and m.  juntti , `` a conic quadratic programming approach to physical layer multicasting for large - scale antenna arrays , '' _ signal process .",
    "letters , ieee _ , vol .  21 , pp .  114 - 117 , jan .",
    "2014 .",
    "o.  e.  ayach , r.  w.  heath , s.  abu - surra , s.  rajagopal and z. pi , `` the capacity optimality of beam steering in large millimeter wave mimo systems , '' in _ proc .",
    "ieee 13th intl .",
    "workshop on sig . process . advances in wireless commun .",
    "( spawc ) _ , pp .  100104 , june 2012 .",
    "r.  a.  stirling - gallacher and md .",
    "s. rahman , `` linear mu - mimo pre - coding algorithms for a millimeter wave communication system using hybrid beam - forming , '' in _ proc .",
    "ieee intl .",
    "conf . on commun .",
    "( icc ) _ , pp .  54495454 , june 2014 .",
    "s.  s.  christensen , r.  agarwal , e.  carvalho and j.  m.  cioffi , `` weighted sum - rate maximization using weighted mmse for mimo - bc beamforming design , '' , _ ieee trans . on wireless commun .",
    "_ , vol .  7 , pp",
    ". 4792 - 4799 , dec ."
  ],
  "abstract_text": [
    "<S> for a massive multiple - input multiple - output ( mimo ) system , restricting the number of rf chains to far less than the number of antenna elements can significantly reduce the implementation cost compared to the full complexity rf chain configuration . in this paper </S>",
    "<S> , we consider the downlink communication of a massive multiuser mimo ( mu - mimo ) system and propose a low - complexity hybrid block diagonalization ( hy - bd ) scheme to approach the capacity performance of the traditional bd processing method . </S>",
    "<S> we aim to harvest the large array gain through the phase - only rf precoding and combining and then digital bd processing is performed on the equivalent baseband channel . </S>",
    "<S> the proposed hy - bd scheme is examined in both the large rayleigh fading channels and millimeter wave ( mmwave ) channels . </S>",
    "<S> a performance analysis is further conducted for single - path channels and large number of transmit and receive antennas . </S>",
    "<S> finally , simulation results demonstrate that our hy - bd scheme , with a lower implementation and computational complexity , achieves a capacity performance that is close to ( sometimes even higher than ) that of the traditional high - dimensional bd processing </S>",
    "<S> .    [ section ] [ theorem]*lemma * [ theorem]proposition [ theorem]*remark * [ theorem]corollary    massive mimo , large scale mu - mimo , hybrid processing , block diagonalization , limited rf chains , mmwave </S>"
  ]
}