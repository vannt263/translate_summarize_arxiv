{
  "article_text": [
    "the trajectory of a charged particle in a homogeneous magnetic field neglecting the interactions with the detector material is described by a helix . in a global coordinate system @xmath0 with the magnetic field in @xmath1-direction",
    "it can be parametrized by the inverse momentum ( times charge ) @xmath2 , an angle @xmath3 at and the distance @xmath4 to the point of closest approach in the @xmath5-plane , the dip angle @xmath6 to that plane and the offset @xmath7 at the point of closest approach .",
    "energy loss in the detector material due to ionization or radiation ( for electrons ) leads to a reduction of the momentum . _",
    "multiple scattering _ , mainly due to coulomb interaction with the electrons in the atoms , results in random changes in direction and spatial position with expectation values of zero and variance depending on the traversed material and the particle momentum .",
    "in addition the magnetic field is usually homogeneous only in an approximation .",
    "therefore more advanced track models are required .",
    "the effect of multiple scattering can be taken into account in different ways @xcite . for global methods",
    "it can be added to the measurement errors leading to a non diagonal covariance matrix or explicitly fitted by scattering angles as additional track parameters . in both cases",
    "this requires the inversion of a large matrix of order @xmath8 ( number of measurements or number of scatterers ) with computing time @xmath9 .",
    "progressive methods @xcite like the klmn filter @xcite updating the track parameters for each additional measurement and scatterer with a computing time @xmath10 have become the standard method for track fitting .",
    "the broken lines method is a fast global track refit adding the description of multiple scattering to an initial trajectory and able to determine the complete covariance matrix of all track parameters .",
    "this allows the usage as track model for track based alignment and calibration with the global millepede - ii @xcite algorithm .",
    "corrections and covariance matrices for the local track parameters ( at single points ) can be determined with a computing time @xmath10 exploiting the sparsity of the matrix of the corresponding linear equations system .",
    "the original formulation @xcite describes the case of a tracking detector with a solenoidal magnetic field and independent two - dimensional tracking in the bending and perpendicular to the bending plane .",
    "it constructs the planar trajectories from the measurements including the material around those as thick scatterers . in the presence of measurements with components in both planes a single trajectory in three dimensions",
    "is required .",
    "general broken lines are describing trajectories in space in an arbitrary magnetic field for arbitrary measurements and material distribution .",
    "the three - dimensional broken lines trajectories from one- or two- dimensional independent measurements dedicated to the track - based alignment of the cms silicon tracker @xcite with millepede - ii @xcite are an intermediate step .",
    "they are constructed from the material between the measurement planes by equivalent thin scatterers .",
    "measurements are parametrized by the interpolation of ( small ) offsets perpendicular to the track direction defined at those scatterers and a common correction @xmath11 of the inverse momentum .",
    "multiple scattering kinks are defined by triplets of thin scatterers .",
    "the corresponding linear equation system @xmath12 with a bordered band matrix @xmath13 with a size @xmath8 depending on the number of scatterers @xmath14 , band width @xmath15 ( usually 5 ) and border size @xmath16 is built from the jacobians of the propagation of the offsets between measurements and scatterers on the initial trajectory and solved by root - free cholesky decomposition . in the following the further features of general broken lines are presented , the procedure is discussed and a comparison with the klmn filter is performed .",
    "at each measurement plane and each thin scatterer a local ( orthonormal ) coordinate system @xmath17 is defined .",
    "the natural choice for the @xmath18-direction is perpendicular to the measurement plane for a measurement and parallel to the track direction for a scatterer .",
    "a local system moving with the track is the _ curvilinear _ frame @xmath19 with @xmath20 in track direction and @xmath21 in the global @xmath5-plane . at each thin",
    "scatterer the two - dimensional offset @xmath22 is defined as fit parameter .",
    "the variance @xmath23 of the multiple scattering kinks @xmath24 in the local system can be calculated from the variance @xmath25 @xcite in the curvilinear system by parameter transformation @xcite from the curvilinear to the local slopes which depends on the projections @xmath26 of the offset directions @xmath27 of the local frame onto the track direction @xmath28 :    @xmath29^t \\negmedspace= \\\\",
    "\\frac{\\theta_0 ^ 2}{(1-c_1 ^ 2 -c_2 ^ 2 ) ^2 } \\left ( \\begin{matrix } 1-c_2 ^ 2 & c_1 c_2 \\\\",
    "c_1 c_2 & 1-c_1 ^ 2   \\end{matrix } \\right)\\end{gathered}\\ ] ]    with at least one offset defined perpendicular to the track direction this is a diagonal matrix .      in the local frame",
    "a track can be described by an offset @xmath30 , a slope @xmath31 and the inverse momentum @xmath2 . the general broken lines fit determines from the fit parameters @xmath32 at each thin scatterer @xmath33 track parameter corrections @xmath34 .",
    "the slope before the scattering is defined by @xmath35 and afterwards by @xmath36 ( eqn ( 6 ) in @xcite ) . at the measurement planes",
    "the track parameter corrections @xmath37 can be obtained from interpolation of the enclosing scatterers ( eqn ( 8) and inserting @xmath38 for @xmath39 in eqn ( 6 ) in @xcite ) . in any case @xmath40",
    "depends only on @xmath11 and two adjacent offsets .",
    "therefore for the covariance matrices of the track parameter corrections the bordered band part of the covariance matrix @xmath41 of the fit parameters is sufficient . for a sparse matrix the elements of the inverse matrix inside the sparsity pattern can by calculated by special methods without those outside that pattern @xcite .",
    "this allows to obtain the bordered band part of @xmath41 with @xmath42 operations linear in the number of scatterers .",
    "the measurements @xmath43 are ( the residuals with respect to the initial trajectory of ) arbitrary observables with predictions defined by the local track parameters in the measurement plane . this can be one or two dimensional position measurements or track segments containing slope information .",
    "the linearized prediction is @xmath44 . in case",
    "the corresponding covariance matrices @xmath45 are not diagonal they should be diagonalized and the measurements and predictions modified accordingly .",
    "this allows the usage of univariate m - estimators for outlier down - weighting and the interfacing to millepede - ii @xcite expecting independent scalar measurements .      in case",
    "the resulting fit parameters are not small corrections as assumed for the linearization of the track model ( eqn ( 3 ) in @xcite ) the trajectory has to be iterated .",
    "this requires initial non - zero values @xmath46 in the prediction of the multiple scattering kinks : @xmath47 .",
    "the expectation value remains @xmath48 .",
    "the general broken lines are seeded by an initial trajectory . alternatively to the result of a fit of the measurements ( _ internal seeding _ ) this can be a prediction from another part of the detector ( _ external seeding _ ) .",
    "the seeding track parameters at some reference point are used for the propagation along the trajectory according to the magnetic field ( and average energy loss ) to calculate residuals for the measurements and parameter transformation matrices .",
    "if the track fit has to be iterated to account for nonlinear effects the initial trajectory could be based on general broken lines itself . on average no change of the track parameters at the reference point",
    "is expected from refitting : @xmath49 .",
    "the fit parameters are determined by minimizing :    @xmath50    the minimization leads to a linear equation system @xmath51 with @xmath52 of size @xmath53 :    @xmath54",
    "the initial trajectory provides in the local coordinate system for the measurements the residuals @xmath43 with ( diagonal ) covariance matrix @xmath45 , for the scatterers the initial ( usually zero ) kinks @xmath46 with covariance matrix @xmath23 , optionally the external seed and for the parameter transformations from one point ( measurement , scatterer or seed ) to the next one the jacobians @xmath55 .    the linearized track model of the general broken lines is defined at each point by the offset part @xmath56 of the jacobians for the transformtion to the next and the previous _",
    "scatterer_. for the forward propagation they are calculated from the products of the point - to - point jacobians @xmath57 , for the backward case additional partial inversions ( for the offset part ) are performed . in the next step the non - zero elements of the matrices @xmath58 for the linearized predictions",
    "are calculated from the @xmath59 matrices and vectors @xmath60 , @xmath61 and @xmath62 ( see eqn ( 7 ) and ( 8) in @xcite ) . the measurements @xmath43 , the kinks @xmath24 , the derivatives from the sparse matrices @xmath58 and the measurement and multiple scattering errors from diagonal covariance matrices @xmath63 are the ingredients for the local fit in millepede - ii @xcite .",
    "afterwards the linear equation system @xmath12 is constructed from the individual contributions ( @xmath64 , @xmath65 or @xmath66 ) of measurements , kinks and optionally the external seed .",
    "the band part @xmath67 of the matrix is decomposed into a diagonal matrix @xmath68 and a triagonal band matrix @xmath69 with unit diagonal ( @xmath70 ) and the offsets @xmath71 are determined from @xmath68 , @xmath69 and @xmath72 by solving @xmath73 and @xmath74 @xcite .",
    "the band part of @xmath75 is calculated according to @xcite .",
    "using block matrix algebra the complete solution @xmath52 and the bordered band part of @xmath41 are obtained . from this",
    "corrections and covariance matrices for local track parameters at any point ( measurement , scatterer or seed ) can be derived .    for all this steps ( propagation , prediction , construction , decomposition , solution and inversion )",
    "the number of operations is linear in the number of points or parameters and a sizable contribution to the total computing time . as all predictions @xmath76 depend at most on three consecutive offsets the matrix @xmath67 has a band width @xmath77 . in case",
    "the transformation matrices @xmath78 and @xmath79 are diagonal the two offset components are decoupled and the band width reduces to @xmath80 speeding up the band matrix operations ( @xmath42 ) .",
    "in addition the construction of @xmath13 is faster due to fewer non - zero elements in @xmath58 .",
    "an externally seeded general broken lines trajectory with one measurement has only one offset defined and the slope has to be used directly as fit parameter : @xmath81 .",
    "the solution of the linear equation system is :    @xmath82 \\\\   { \\mathbf{a}}^{-1}&=\\left[{\\mathbf{v}}^{-1}_s+{\\mathbf{h}}_{m,1}^t{\\mathbf{v}}^{-1}_{m,1}{\\mathbf{h}}_{m,1}\\right]^{-1 }",
    "\\end{aligned}\\ ] ]    this is equivalent to the filtering step of a klmn filter in the weighted mean formalism ( equation ( 8b ) in @xcite ) :    @xmath83 \\\\   { \\mathbf{c}}_k&=\\left[\\left({\\mathbf{c}}_k^{k-1}\\right)^{-1}+{\\mathbf{h}}_k^t{\\mathbf{v}}_k^{-1}{\\mathbf{h}}_k\\right]^{-1}\\label{eqn - kalman}\\end{aligned}\\ ] ]    as the initial trajectory has been based on the track parameters from the external seed the prediction @xmath84 is zero , @xmath85 corresponds to @xmath41 , @xmath86 to @xmath87 and @xmath88 to @xmath89 .    in general",
    "only the covariance matrices for the track parameters at single points are calculated by the klmn filter . for the global covariance matrix from all track parameters of the trajectory required by global alignment and calibration methods an extension of the klmn filter",
    "is described in @xcite .",
    "track fitting with the klmn filter algorithm @xcite is a sequential procedure adding measurements and scatterers ( process noise ) to the trajectory one at the time .",
    "the propagation of track parameters and covariance matrices from point to point in the filtering step involves multiplications of @xmath90 matrices with @xmath91 operations .",
    "the filtering in the weighted mean formalism is dominated by the inversion of @xmath90 matrices ( @xmath91 operations , @xmath92 in equation ) for the addition of a single measurement . using the gain matrix formalism requires the inversion of matrices of the size of the dimension @xmath93 of the measurements ( @xmath94 operations ) and several multiplications of @xmath95 matrices ( @xmath96 operations ) .",
    "the smoothing step to get optimal local track parameters at all and not only the last point involves inversion and multiplications of @xmath90 matrices ( @xmath91 operations ) . for small @xmath93 the gain matrix formalism should be fastest .",
    "the general broken lines can add several ( @xmath8 , between one and all ) measurements with one fit .",
    "the effort is defined by the construction of the linear equation system from the non - zero derivatives from the propagation to the previous and next thin scatterer and its solution using @xmath97 operations with in general band width @xmath98 and @xmath99 , depending on the number of thin scatterers @xmath100 .    in a toy setup",
    "the performance of track refitting has been compared .",
    "tracks in a detector consisting of @xmath101@xmath102 planes with two independent measurements ( @xmath103 ) and thin scatterers coinciding with the measurement planes ( simple model for a silicon tracker ) or one or two thin scatterers between adjacent planes have been simulated . the magnetic field @xmath104 is assumed to be constant between adjacent points and the initial trajectory uses a detailed helix propagator @xcite or the simplified version for weak deflection ( limit @xmath105 ) as in @xcite .",
    "starting from the initial trajectory corrections and covariance matrix of track parameters at one or both track ends have been calculated .",
    "the results of this test are shown in figure [ fig.cmpl ] . for fit results at one track end klmn filtering",
    "is compared with a general broken lines fit including one transformation from fit to local track parameters . depending on the number of scatterers per measurement",
    "the fit with general broken lines is almost as fast as the klmn filter for the detailed propagator ( @xmath106 ) and faster for the simplified one ( @xmath101@xmath107 ) .",
    "this speedup is due to the reduced number of non - zero elements in @xmath58 for the matrix construction and reduced band width @xmath108 . for the klmn filter",
    "the gain matrix formalism is a little faster than the weighted mean formalism . for fit results at both track",
    "ends klmn filtering and smoothing is compared with a general broken lines fit including two transformations from fit to local track parameters . in this configuration",
    "the general broken lines are faster in all cases tested ( @xmath109@xmath110 ) .",
    "a trajectory based on general broken lines ( gbl ) is a track refit to add the description of multiple scattering to an initial trajectory based on the propagation in a magnetic field ( and average energy loss ) .",
    "the initial trajectory can be the result of a fit of the measurements ( internal seed ) or a prediction from another detector part ( external seed ) .",
    "it is constructed from a sequence of ( pairs of ) thin scatterers describing the multiple scattering in the material between adjacent measurement planes .",
    "predictions for the measurements are obtained by interpolation between the enclosing scatterers and triplets of adjacent scatterers define kink angles with variance according to the material of the central scatterer . the required propagation ( on the initial trajectory ) from a measurement plane or scatterer to the previous and next scatterer is using locally a linearized track model .",
    "this linearization may necessitate iterations of the fitting procedure .",
    "the matrix of the resulting linear equations system is a bordered band matrix allowing for a fast solution by a root - free cholesky decomposition in a time proportional to the number of measurements . at all scatterers and measurement planes corrections for the local track parameters",
    "are determined .",
    "the corresponding covariance matrices and the pulls for the measurements and kinks require only the calculation of the bordered band part of the inverse matrix .    in a simulated detector ,",
    "track refitting with gbl is about as fast or a little faster than klmn filtering , depending on the multiple scattering setup and on the complexity of the propagation jacobian . in comparison with klmn filtering and smoothing",
    "it is up to a factor @xmath111 faster ."
  ],
  "abstract_text": [
    "<S> in hep experiments the description of the trajectory of a charged particle is obtained from a fit to measurements in tracking detectors . </S>",
    "<S> the parametrization of the trajectory has to account for bending in the magnetic field , energy loss and multiple scattering in the detector material . </S>",
    "<S> general broken lines implement a track model with proper description of multiple scattering leading to linear equations with a special structure of the corresponding matrix allowing for a fast solution with the computing time depending linearly on the number of measurements . </S>",
    "<S> the calculation of the full covariance matrix along the trajectory enables the application to track based alignment and calibration of large detectors with global methods .    </S>",
    "<S> track fitting , multiple scattering , global least - squares fit , millepede , broken lines </S>"
  ]
}