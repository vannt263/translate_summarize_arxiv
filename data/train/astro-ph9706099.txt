{
  "article_text": [
    "a fundamental approximation underlying cosmological n - body simulations is that the density field of the universe may be represented by a set of @xmath4 discrete particles .",
    "the universe is thought to be dominated by some form of dark matter whose mass is small compared to that of galaxies , probably small compared to that of stars .",
    "the formation of structure in most scenarios proceeds from a nearly homogeneous mass distribution with small perturbations .",
    "the formation of stars , galaxies , clusters , and superclusters is probably a hierarchical process , built on a spectrum of density perturbations in this background of very low mass particles . in this case",
    ", the only significant discreteness is that which emerges as the particles begin to cluster .",
    "the particles themselves ( atoms , axions , neutrinos , wimps , or something else ) have such a small mass as to be insignificant compared to that of the aggregates being studied in the simulations .",
    "therefore any successful n  body code should approximate the solution to the poisson ",
    "vlasov equations .",
    "this can be coupled to hydrodynamics , to model the baryonic matter that gave rise to the luminous component . in this case , the gravitational force on each simulation particle should be dominated by the mean field , with insignificant discreteness effects ( of which there are many kinds ) . to trace exactly the evolution of the _ discrete",
    "_ particle distribution may sometimes be in conflict with this approximation .",
    "the correct evolution of the density field , sampled by a set of particles , is supposed to be obtained by properly adjusting the parameter @xmath5 which effectively softens the gravitational force like @xmath6 .",
    "( there are a variety of details of the shape of the softening of the potential at short ranges ; this is only a representative example ) .",
    "if the dark matter is not modeled as collisionless , the dominant gravitational force on the hydrodynamic component will also be incorrect .",
    "the choice of @xmath5 is a subtle problem unresolved in practice .",
    "if the real universe consists of galaxies , with no internal degrees of freedom , then @xmath5 could be simply set to the typical size of galaxies @xmath7 kpc provided that the number density of simulation particles @xmath8 is comparable to that of galaxies @xmath9 . for a cosmological volume @xmath10 , this requires that the total number of particles is of order @xmath11 , which was impossible a decade ago but is quite feasible with current existing computational resources .",
    "this could appropriately simulate a universe in which galaxy formation was decoupled from large  scale structure , as often assumed in the 1970 s and earlier .",
    "our universe does not seem so simple ; the prevailing consensus is that our universe is made up of dark matter particles , possibly with masses ranging from @xmath12 to @xmath13 ev .",
    "if this is the case , their number density is @xmath14 mpc@xmath15 , where @xmath16 is the cosmological density parameter .",
    "then simulation particles do not correspond to physical objects but rather provide a method to sample the density field of dark matter in a very sparse manner . in this case",
    "@xmath5 must be chosen so as to suppress the artificial discreteness and two - body collision effects of the simulation .",
    "these effects are negligible for the real universe even if the masses of large stars are typical of the particle size .",
    "therefore they _ should be _ absolutely suppressed in simulations .",
    "of course the interaction between galaxies is important , but galaxy formation is now thought to proceed by a process of hierarchical clustering intimately interwoven with large  scale structure formation .",
    "when two  body effects between galaxies are included , internal degrees of freedom must be included as well .",
    "this line of thought naturally indicates that @xmath5 should be close to the mean simulation particle separation @xmath17 since @xmath18 would manifest undesirable discrete sampling due to the sparseness of the density field ( melott 1981 , 1990 ) .",
    "hereafter we define @xmath19 so that @xmath20 corresponds to this choice . while this is consistent with the pm simulation methodology with one or more particles per cell ( e.g. hockney & eastwood 1988 ) the choice of @xmath21 which _ intends _ to achieve higher spatial resolution is nearly universal in p@xmath1 m and tree code simulations ( e.g. , efstathiou et al .",
    "1985 ; suginohara et al .",
    "so the question is whether or not the choice @xmath22 1 is too conservative and whether or not the choice of @xmath21 correctly traces the evolution of the underlying density field of dark matter while retaining higher spatial resolution without suffering from discreteness effects .",
    "this question may have a different answer depending on exactly what analysis is done .",
    "we attempt to answer it for the case of some statistical measures .",
    "the answer to the above question should depend on the specific problem the simulation is addressing .",
    "efstathiou & eastwood ( 1981 ) studied collisionality ( one effect of discreteness ) by means of mass segregation in a 3 m code with @xmath21 and found significant two - body scattering .",
    "peebles et al .",
    "( 1989 ) studied this in a pm code and verified that @xmath23 was necessary to suppress collisionality .",
    "both these tests used reasonable perturbation spectra but only had one diagnostic of discreteness effects .",
    "it is customary in computational physics to use solutions with known characteristics to test codes before applying them to new problems .",
    "the shock tube is now often being used in this way for hydro - dynamical simulations in cosmology , although no one thinks galaxies formed this way .",
    "melott ( 1990 ) discussed the problem and presented pictorial evidence that lack of mass resolution can damage results as much as lack of force resolution .",
    "melott et al .",
    "( 1997 ) presented a clear case against a use of @xmath24 in one dimensional collapse of a plane wave .",
    "this study was restricted to a formal test case and the precise effect on realistic cosmological simulations is not clear .    often it has been argued that most fluid elements in hierarchical clustering contract , justifying the use of smaller @xmath25 . in other words , in this point of view",
    ", @xmath25 only need be large enough to prevent two body relaxation in collapsed regions .",
    "kuhlman et al .",
    "( 1996 ) showed that even for regions of relative overdensity @xmath26 about half the small fluid elements which initially contract in one or two directions expand in the third .",
    "thus , due to anisotropy at first collapse there is plenty of opportunity for scattering due to unphysical discreteness of the kind found in melott et al .",
    "this would decouple results on small scales from the initial conditions .",
    "another problem has to do with the use of correct initial conditions .",
    "absence of the initial perturbations on scales smaller than the particle nyquist wavelength but larger than the force resolution scale results in inaccurate modeling of the merger history of clumps .",
    "this can not be compensated by improving the force resolution .",
    "the initial power spectrum above the particle nyquist frequency could in principle have a wide variety of forms .",
    "therefore , expecting the right answer without putting in the correct initial conditions implies that the final stage completely forgets that important piece of information ; this can be only approximately true . as a test of this we generated two pm models identical except for the presence or absence of initial perturbations in the range @xmath27 , where @xmath28 represents the fundamental wavenumber corresponding to the simulation box size . comparing the other models to the first one shows the effect of differences in integration of initial conditions , while comparison to the latter includes the effect of the presence of this part of the initial conditions .",
    "the purpose of the present paper is to quantitatively examine the extent to which discreteness effects in simulations with @xmath29 may change various statistical measures in models with a power spectrum not unlike that present in the range of interest of many viable cosmological clustering theories",
    ". it may be somewhat surprising that such a fundamental issue has not yet been examined in detail in the past . the proper comparison between pm , p@xmath1 m and tree codes ( we will generically refer to 3 m and tree codes as high force low mass resolution codes , hflmr , in this paper ) over the dynamical range which we will present below has been feasible for almost a decade on supercomputers , and within reach of high  end workstations for about five years .    an unpublished comparison test coordinated by david weinberg in the later 1980 s attacked some of these issues .",
    "it also found general agreement between codes , with differences in detail on individual objects and on small scales . there is no contradiction between our results and that study .",
    "a crucial difference is our exploration of the effect of mass resolution while fixing the force resolution .",
    "we use pm ( hockney & eastwood 1988 ; melott 1981 , 1986 ) , ap@xmath1 m ( couchman 1991 ) , and tree ( suginohara et al . 1991 ;",
    "suto 1993 ) codes .",
    "the 3 m code had adaptive smoothing turned off since we wish to compare a standard 3 m method .",
    "the tree runs use the fixed smoothing length in comoving coordinates , and we set a tolerance parameter @xmath30 which is considerably smaller ( and thus more accurate ) than conventional choices ( @xmath31 ) .",
    "@xmath32 merely controls how far the tree expansion is carried , and thus the accuracy of long - range forces .",
    "the initial power spectrum in all cases was @xmath33 up to some cutoff , in most cases at the nyquist frequency @xmath34 dictated by the runs with the fewest particles .",
    "realization of the corresponding density field was generated using the zeldovich approximation ( zeldovich 1970 ) to perturb the particles from their initial lattice ( doroshkevich et al .",
    "all the models are evolved in the einstein  de sitter universe ( @xmath35 ) .",
    "the comparisons were performed at three different epochs when the nonlinear wavenumber @xmath36 becomes @xmath37 , @xmath38 , and @xmath39 , where @xmath40 is defined as @xmath41 in the above @xmath42 denotes the expansion factor ( unity at the initial condition ) , and these values of @xmath36 correspond to the epochs @xmath43 , @xmath44 , and @xmath45 , respectively .",
    "the latest moment we studied corresponds to nonlinearity on the largest scale which does not suffer from finite - volume boundary condition problems ( ryden & gramman 1991 ; kauffmann & melott 1992 ) .",
    "the specific runs we tested and the model parameters are shown in table 1 .",
    "we note that pm codes , which have been extensively used in most physical applications with large numbers of particles , are much faster than the other two types .",
    "thus our 128@xmath1 pm runs took much less cpu time than even the 32@xmath1 tree or 3 m runs .",
    "the typical limitation on pm runs is memory or disk space , while cpu time is the typical limitation on 3 m or tree runs .",
    "hflmr codes usually run with @xmath24 , but we will examine their behavior over a range in n and @xmath25 , pushing them toward @xmath20 by increasing the number of particles while keeping the absolute scale of force resolution @xmath5 constant .",
    "so far as we know , this crucial experiment has not previously been done with hflmr codes .",
    "our primary strategy is therefore to highlight the largely unexplored mass resolution issue by varying the number of particles while keeping @xmath5 constant ( it is not _",
    "exactly _ constant because in fact the shape of the short - range softening function is different in all three codes ) . within a given code @xmath5 will be constant , so we can spot trends . between codes softening will be of comparable size .",
    "we can define @xmath46 as the radius where the force drops to 50% of the newtonian value . for the @xmath47 code , @xmath48 . for the tree code @xmath49 . for our pm code , @xmath50 grid unit , albeit with considerable scatter in the softened zone .    in most cases we set @xmath51 ( in units where the box size is 128 ) in both the tree and 3 m codes , and run pm with a 128@xmath1 mesh .",
    "( the @xmath47 runs had one mesh cell per particle , but this is not the factor determining force resolution there . )",
    "it is typical of hflmr codes to have @xmath5 considerably less than @xmath52 , the mean interparticle separation over the entire simulation box . in most uses of pm codes .",
    "the opposite is true ( although in gravitational applications it has become customary to have @xmath20 or @xmath53 ) .",
    "it is important to note that one can not represent initial power to higher than the nyquist wavenumber of the particles or the mesh of the fft used to impose the initial conditions , whichever is worse ( in fact the latter is rarely a problem in cosmology ) .",
    "therefore most of our runs only have initial power up to @xmath54 , so that comparisons of only the effects of divergent numerical integration can be done . the @xmath55 and 32@xmath1 initial conditions",
    "are taken from a subset of the @xmath56 pm runs with the power spectrum cut off at @xmath57 . in order to explore the effect of having initial power at higher wave - numbers which is only possible with more particles , we have one pm run with @xmath58 .",
    "we also have two each @xmath47 and tree runs with @xmath59 to put some points along the pure force resolution axis ( which has been emphasized in past tests by most users of hflmr codes ) .",
    "these  extra \" runs have 32@xmath1 particles , @xmath60 , implying @xmath59 .",
    "we now have for the first time a large number of runs using 3 different codes with identical initial conditions , identical force resolution , but varying mass resolution .",
    "in particular the number of particles varies widely enough to study the same physical system with values of @xmath25 typical of hflmr codes as well as to study the same system with a pm code with similar force resolution _ and _ matching mass resolution ( @xmath20 ) .",
    "it is important to note time - step limitations .",
    "elementary principles of numerical stability require that no particle move more than a fraction of a softening length @xmath5 , or about one  half mesh unit for @xmath61 , in a single time - step .",
    "this condition was amply enforced for all three codes .",
    "the lowest order discreteness effect is merely sampling . in figure",
    "[ fig : fig01 ] we show a slice of the density field of our pm simulation with @xmath54 at @xmath62 one cell thick .",
    "both pictures show the same configuration ; in one case all of the particles in the slice are available and in the other only those from a 32@xmath1 subset are used .",
    "the discreteness has a major effect on the visual impression , corresponding to the noise effect on high  order statistics .",
    "a claim of filamentarity in the sparse picture would certainly be greeted with skepticism . although percolation analysis can still detect a signal in such datasets ( e.g. melott et al .",
    "1983 ) it is very noisy .",
    "the change in discreteness in redshift surveys is largely responsible for the shift in attitude toward superclusters from the 1970 s through the 1980 s .",
    "clumps , filaments , and sheets are progressively harder to see through discreteness noise ; many present simulations are able to show filaments but have too few particles to allow sheets to be seen",
    ".    more seriously , if these two different density fields were coupled to hydrodynamics , with the dark matter driving the gravitational field , the results would be very different .",
    "of course , both distributions have the same two - point correlation function , but many other things are completely different .",
    "differences between the runs described in table 1 can be seen in figures  [ fig : fig02 ] to 4 at different stages of evolution . at a given stage particles which lie within a box at the same location",
    "are shown . in cases with more particles , only those with the same initial locations as those of the 32@xmath1 subset",
    "are shown and used in calculating all statistics for comparison presented hereafter .",
    "the following statements are subjective but are made quantitative later by cross - correlation studies .",
    "there is a general resemblance of all plots at the same stage .",
    "since they all have force resolution @xmath63 if this were the only issue we would expect them to be identical down to the scale of one tick mark .",
    "they are not .",
    "for example , the three 3 m runs all with @xmath51 ( @xmath25 = 1 , 0.5 , 0.25 corresponding to @xmath64 ) all look different on scales larger than @xmath5 . within this series , as the number of particles is increased they come to resemble the pm run with @xmath54 , the same initial condition .",
    "the same trend is evident in the tree runs .",
    "another observation one can make is that on a scale of 4 cells ( the mean interparticle separation of the sparsest runs ) there are very few apparent differences .",
    "the pm run with @xmath58 looks different from the others , including the pm run with @xmath65 .",
    "the overall configuration is similar , but there are many small  scale features reproduced by none of the other models .",
    "consider for example the shape and orientation of the two largest objects in fig  [ fig : fig02 ] ; the existence of the second object in fig  [ fig : fig03 ] ; the partial bridge around ( 93,36 ) in fig  [ fig : fig04 ] .",
    "power on scales above the force resolution but below the mass resolution of hflmr has made an apparent difference .",
    "however it is described , it is evident that the sub - panels in each of these figures are not identical .",
    "again , on scales of the largest interparticle separation ( 4 ) the differences appear to evaporate .",
    "hflmr codes are based on the idea that one can shrink @xmath25 far below unity to get higher resolution .",
    "we see very real differences implying integration errors for even the modest @xmath66 .",
    "we expect greater differences for smaller @xmath25 .",
    "the transfer of power to small scales is strong , but does not make small - scale initial power totally irrelevant .",
    "the reader is referred to the center and bottom center images of figure 7 in beacom et al .",
    "( 1991 ) for another example of the importance of initial power on small scales even when it is deep in the nonlinear regime .",
    "in that paper , as well as melott et al .",
    "( 1993 ) , we emphasized the effectiveness of the transfer of power from long to short waves . the general position and orientation of objects",
    "is determined by initial perturbations on that comoving scale and larger , so smaller perturbations are ignorable for this purpose .",
    "see also melott et al .",
    "( 1990 ) , little et al .",
    "( 1991 ) , evrard and crone ( 1992 )",
    ". however , here we stress that the _ internal structure _ of these objects will vary depending on smaller  scale perturbations .",
    "if we wish to study that internal structure , the smaller  scale initial perturbations must be present and properly evolved .    in all of the papers cited in the previous paragraph",
    ", it was concluded that : ( a ) there is a strong transfer of fluctuations from large to smaller comoving scales .",
    "( b ) there is a nearly negligible transfer from small to large scales .",
    "this is the reason for the success of approaches such as the truncated zeldovich approximation ( coles et al .",
    "1993 ) which ignore initial small scale fluctuations , successfully follow large  scale fluctuations into the mildly nonlinear regime , producing remarkably accurate results . although it was not emphasized in any of these papers , visual inspection will verify that different small comoving ",
    "scale perturbations produce different results on these scales .",
    "this is easiest to see in beacom et al.(1991 ) due to the use of a color scale , so that high density regions can be inspected ( while they are solid black in the typical n  body dot plots ) .",
    "however , the result can be verified by close inspection of any of them .",
    "small - scale power is diluted by mode coupling , but it is not lost .    in the following sections we quantify some of the differences we found with a variety of statistical measures .",
    "this section contains the main body of our results .",
    "although we examine a number of measures , this must be considered a preliminary investigation .",
    "we wish to stress that similarity or lack thereof in the studies of one characteristic between various runs should not be construed as implying the same thing for some other purpose .",
    "the major phase differences we find later make simple extrapolation based on power amplitudes highly questionable .",
    "errors are not shown on the quantities presented herein .",
    "this is a choice grounded in our computational / comparison strategy , which brings out _ systematic _ differences .",
    "all but one of our runs of different code types had _ identical _ initial conditions .",
    "a 128@xmath1 particle ensemble ( or a @xmath67 or @xmath68 subset in those cases where the nyquist theorem would not be violated ) is evolved from this state .",
    "comparisons are done between a @xmath67 subset which is the same in all cases .",
    "we have found that using a different subset of @xmath67 particles , or the full ensemble if larger , produces ( with one exception ) differences so small as to be invisible on our plots .",
    "thus our sampling error is essentially zero .",
    "it would be possible to create some error bars by bootstrap , but they would be meaningless .",
    "errors could be created based on cosmic variance  doing multiple realizations of each box .",
    "this , too is essentially meaningless here .",
    "if the box size were made larger , the cosmic variance would change , but the differences between codes remain ( since we are only adding linear modes , which almost any code can handle )",
    ". we could shrink or expand the errors at will by this linear procedure , but the systematic differences we find are in the nonlinear behavior .",
    "there are two senses in which error is meaningful here :    \\(1 ) do the differences we find matter in practice ?",
    "this depends on the desired accuracy .",
    "a factor of two was formerly unimportant in many applications in cosmology , but is now insufficient for many applications .",
    "\\(2 ) what about other initial conditions ?",
    "the most meaningful kind of comparison would be to have runs with other initial power spectra , or non  gaussian initial conditions .",
    "this would bring out how much the _ systematic _",
    "differences we find vary depending on the kind of initial conditions .",
    "this must be left for future work .",
    "we compute our power spectra on a 128@xmath1 mesh with cic cloud assignment of local density . in all cases we base our analysis on 32@xmath1 of the particles , so that the discreteness contribution is exactly the same .",
    "we have not subtracted off the discreteness contribution from the spectra , because it is not poissonian at early times and subtraction of such would constitute an error . for consistency",
    "we also do not subtract it at late times ( when it would in any case be quite small ) .    in figure",
    "[ fig : fig05 ] we show the spectrum of the initial conditions evaluated on a series of progressively finer meshes ( with a vertical offset for clarity ) .",
    "the lowest line corresponds to the standard choice of showing things up to the particle nyquist frequency .",
    "however , it is common practice at very late times to show the autocorrelation function to very small radii .",
    "this seems to be a contradiction . _",
    "if _ the initial spectra had been shown to the same resolution , they would look like these ( our example is from 32@xmath1 particles ; with more particles the spikes lower in amplitude and move to higher @xmath69 ) .",
    "our point is that _ if _ the code has sufficient force resolution to resolve these spikes ( which are not random phase ) , then those _ are _ the initial conditions .",
    "this study then includes both an examination of integration errors as a function of @xmath25 as well as the effect of the absence of this initial power two independent but practically intertwined effects .    in figure",
    "[ fig : fig06 ] are plotted all of the power spectra from the 32@xmath1 subset of the runs specified in table 1 at our three output stages .",
    "we also show power ratios to help clarify differences . considering",
    "the diversity of types of codes and their operating parameters , the agreement is encouraging . in the final output stage ,",
    "major differences are only present beyond about half the mesh nyquist frequency , i.e. , @xmath70 .",
    "some expected trends emerge : the codes with the very smallest @xmath5 have the highest amplitude at high frequencies for a given code type .",
    "pm codes in general have low amplitude at large @xmath69 .",
    "other results are unexpected : tree codes also have systematically lower amplitude than 3 m codes with the same @xmath25 at large @xmath69 . for both tree and 3 m codes , for _ fixed _ @xmath5 , as the number of particles increases , the nonlinear amplitude increases .",
    "this was not anticipated .",
    "we speculate that a larger number of particles is better able to handle the mode coupling that accompanies nonlinear evolution .",
    "some support for this idea can be found in the neighborhood of the  kink \" around @xmath71 in the earliest stage shown ( bottom group ) in some evolved spectra in fig  [ fig : fig06 ] ( we temporarily ignore the run with additional high-@xmath69 power ) .",
    "all the runs which had the same initial conditions fall into two behavior groups here : those with 32@xmath1 particles ( dotted or longdash - dot lines ) , and those with more particles , without regard to code type , mass or force resolution .",
    "all runs with 32@xmath1 particles overlie one another , and have the lowest amplitude in the region of the kink . recalling that @xmath71 is the nyquist frequency of the particles , it is entirely reasonable to suppose that this kink is caused by the inability to transfer power to higher frequencies limited by the nyquist theorem . note that runs with more particles , but",
    "no initial power beyond @xmath72 do not show this kink .",
    "this kink is hidden later ; no doubt mode coupling from even longer waves coupled with the considerable deformation of the lattice allows this to fill in .",
    "but for some codes  those with fewer particles  a crucial step in the evolution was handled incorrectly .",
    "the fact that the power spectrum recovers does not mean the evolution is correct ( see also bouchet et .",
    "al 1985 ) .",
    "it probably _ does _ mean one can approximate the final power spectrum to fairly high wave - numbers with poor mass resolution .",
    "note that the point of divergence of the spectra in the evolved state is close to the particle nyquist wavenumber ( @xmath73 ) .",
    "it is tempting to conclude that although spectral agreement is good , one can only have full confidence up to this value . knowing whether this is a general feature or an accident will require further study .      for a long time",
    "the two - point correlation function @xmath3 has been a staple of cosmology studies in large - scale structure .",
    "see peebles ( 1980 ) for an excellent exposition .",
    "formally , it is the fourier transform of the power spectrum discussed in the last section , so no new information is present .",
    "however , it is packaged differently , and may allow new insights through new presentation .    in figure",
    "[ fig : fig07 ] we show the evolution of @xmath3 at our three stages plotted against separation @xmath74 in grid cells ( based on 128@xmath1 as the box size ) .",
    "@xmath75 is computed ( not estimated ) by using fourier transform techniques on a very fine ( @xmath76 ) density mesh .",
    "thus the flattening shown at @xmath77 on figure 7 is due to softening in the dynamical force law , not any smoothing due to our method of computing @xmath75 .",
    "this method is equivalent to using all possible pairs ( except those at @xmath78 .",
    "we show the spikes which exist at early stages of evolution from a lattice ; they are normally suppressed in publication comparing with data by only showing late stages .",
    "note that differences at the latest stage are not too great .",
    "however , there is a noticeable effect at the second stage near @xmath79 .",
    "all the codes with 32@xmath1 particles ( @xmath47 or tree ) differ from the rest here .",
    "we stress that _ all _ correlations and spectra are computed using cic weighting ( hockney & eastwood 1988 ) from a set of 32@xmath1 particles , even when the original contained many more .",
    "thus this is a systematic difference and not an artifact of sampling .    in the final stage , while there is good agreement at larger radii , for @xmath80 or twice the force resolution scale of most of our runs , things begin to break down severely . both dotted lines ( @xmath81 )",
    "are high , consistent with the traditional hflmr emphasis on force resolution . however , the 3 m code with 128@xmath1 particles and @xmath20 is also high .",
    "we find evidence that both better mass resolution and better force resolution contribute to maintaining the power law to small radii , which provides support for the use of hflmr codes to get these statistics without good mass resolution .",
    "however , we do not know whether or not it is accidental .",
    "strangely , the 3 m run with 64@xmath1 particles and @xmath82 has the lowest amplitude at small @xmath74 , occupying a kind of minimum . as we do not have a 128@xmath1 tree run , we can not be sure of the position of the minimum there .",
    "still , its run with @xmath81 , @xmath83 overlies the 3 m run . at any rate , the non  monotonic behavior of the 3 m run and the observed effect of both force and mass resolution separately varied as well as code differences make it difficult to justify the use of @xmath75 on scales below about 2@xmath5 .",
    "more study of these effects is needed .",
    "we have no way of knowing whether our results on force or mass resolution would continue to change beyond the range in n and @xmath5 studied here .",
    "furthermore , without further study we can not be sure whether the scale of agreement on @xmath75 is coupled to the force resolution scale , the mass resolution scale , or some complicated combination of the two .",
    "we do not consider the differences at large radii to be very significant .",
    "they are of low absolute amplitude , and at the latest stage they are on a large enough scale to be suspicious on grounds of boundary conditions ( kauffmann and melott 1992 ) .",
    "they may reflect some innate differences in the green function between the codes ; the tree code has a very different strategy .",
    "conclusions on the two - point correlation : ( 1 ) @xmath3 appears to agree to within 15% down to @xmath84 , ( 2 ) runs do not converge at smaller separations , ( 3 ) it appears that hflmr may approximate effects of high mass resolution reasonably well , insofar as @xmath3 is concerned , and ( 4 ) @xmath75 in n - body simulations for @xmath85 can not be regarded as totally reliable , since it changes when either @xmath4 or @xmath5 is varied independently .",
    "the statistics which have been discussed up to this point are based purely upon the spatial distribution of the mass . to probe any differences in the dynamics we also need to consider the velocity field .",
    "to compare the evolved particle velocities we compute the mean pairwise ( pw ) velocity and the mean pairwise dispersion ( peebles 1980 ) .",
    "we compute the mean pairwise velocity using @xmath86 where the summation is taken over all the pairs with separation @xmath87 and @xmath88 the number of such pairs .",
    "the pw dispersion , @xmath89 , is similarly defined by @xmath90 in fig  [ fig : fig08 ] we plot the absolute magnitude of the mean pw velocity and the pw dispersion .",
    "there are several clear trends . as expected , when @xmath25 decreases both the pw velocity and dispersion increase .",
    "this is because the particles can now approach one another more closely and scatter more strongly off from one another .",
    "this trend is also explained in terms of the cosmic virial theorem incorporating the finite size effect of particles ( suto & jing 1997 ) .",
    "there is a more interesting and unexpected trend ; as the number of particles is increased ( keeping the absolute force resolution fixed ) the mean pw velocity and pw dispersion tends to increase .",
    "while the above trend with @xmath25 might be expected this trend which depends upon the mass resolution is surprising and substantiates our claim that decreasing the force softening length past the mean particle separation can lead to spurious effects .",
    "the density cross ",
    "correlation @xmath91 was introduced by coles et al .",
    "( 1993 ) as a method to help quantify similarity ( or lack thereof ) in the density distribution between various models , where in our case @xmath92 is the density contrast on the ( 32@xmath1 or 128@xmath1 ) mesh and @xmath93 is its @xmath94 value . we compute the cross - correlation on two different sized meshes .",
    "one with @xmath67 cells which corresponds to the mass resolution scale of our lowest mass resolution runs and another with @xmath0 cells which corresponds to the force resolution scale of our fiducial models .",
    "this comparison will help quantify whether the variety of models tested here produce similar or different small  scale structure .    in tables 2 , 3 , and 4",
    "we show the density cross - correlations at the nonlinear stages @xmath95 , @xmath38 , and @xmath96 . the table entries above the diagonal are evaluated on a @xmath0 mesh and the values below the diagonal on a @xmath67 mesh . in order to assure uniform treatment ,",
    "all density fields are computed from a set of @xmath67 particles which had the same initial conditions .",
    "therefore , any differences are due to systematic differences between the configurations in the evolved state .",
    "we ignore here the additional differences introduced purely by sampling effects , as in figure  [ fig : fig01 ] .",
    "however , we ran tests to insure that densities computed from full ensembles of particles do not give greatly different results , by comparing with full ensembles when they exist .    the cross ",
    "correlations on the @xmath67 mesh are much better than the cross",
    " correlations on the 128@xmath1 mesh .",
    "in fact , most results are close to unity .",
    "thus , the codes agree rather well at the mean interparticle separation scale of the coarsest mass resolution runs .",
    "this coarse - mesh agreement is generally quite high at all stages for all codes with two exceptions : ( 1 ) the tree code runs with 32@xmath1 particles and ( 2 ) the pm runs with a full range of initial power @xmath58 evolve values of @xmath97 closer to 0.9 than to 1.0 .",
    "the first may be due to some large - scale differences due to the absence of a grid in the tree code while pm and 3 m codes share the same grid - based algorithm in computing long - range force .",
    "the pm results indicate that the absence of correct initial conditions on small scales can still be detected , even at late times and on larger scales , when those modes have gone deeply nonlinear .",
    "these differences , however , are not large .",
    "even the worst agreement on this mesh is better than the best agreement on the fine ( 128@xmath1 ) mesh corresponding to the force resolution of most of the runs .",
    "the fine - mesh cross - correlations ( shown above the diagonal in tables 2 - 4 ) display a number of interesting patterns : ( 1 ) agreement between codes with the same initial conditions , @xmath4 , and @xmath25 monotonically worsens , reflecting amplification of differences .",
    "( 2 ) this worsening is much more rapid between runs with the same _ small _ @xmath25 .",
    "for example @xmath81 tree cross 3 m ( same @xmath25 ) evolves from 0.95 to 0.63 while for @xmath98 it goes from 0.96 to 0.70 . for",
    "the @xmath55 runs with @xmath82 , it goes from 0.90 to 0.84 .",
    "this is strong evidence that integration errors are being much more strongly amplified for small @xmath25 , as suggested by suisalu & saar ( 1995 ) , and by park ( 1997 ) . as emphasized by these authors , this suggests real problems for hflmr codes .",
    "( 3 ) at a given stage , as @xmath4 and @xmath25 are increased , runs with the same initial conditions converge to one another .",
    "pm , tree , and 3 m all agree rather well in this limit .",
    "there are also two islands of consistency in table 4 between the two 3 m runs with smallest @xmath25 and @xmath5 ( 0.86 ) , and the two tree runs with smallest @xmath25 and @xmath5 ( 0.87 ) , but this agreement does not extent to agreement between two _ different codes _ with small @xmath25 and @xmath5 .",
    "the convergence for large @xmath4 and @xmath25 _ does _ extend to agreement between different codes .",
    "( 4 ) the run with @xmath99 is the best standard of comparison for appropriate initial conditions in cosmology , since most realistic scenarios have power extending to very small scales , not a cutoff . while the comparisons discussed in ( 1 - 3 ) above highlight differences in integration , ( 4 ) includes the effect of the presence or absence of small - scale power .",
    "it is only possible to put this power in when a very large @xmath4 permits it to be sampled by the particles .",
    "time evolution shows that cross - correlation of the full - sampled run with other runs becomes slowly better , as mode coupling brings down power from larger scales ; however , it never really achieves a high value with any other run , regardless of the force resolution of that run .",
    "in fact , the runs with smallest @xmath5 have the _ worst _ agreement with this full - sampled run , even though the strategy of small @xmath5 is to try to follow clustering on small scales .",
    "these results combined with those on the correlation function / power spectrum appear to indicate that this strategy may help produce the correct amplitudes of fourier components , but make the phases worse .",
    "thus it may be that only statistics like the correlation function and the power spectrum which contain no phase information show strong agreements between the various models .",
    "since the differences on small scales lie in phase information , we will look at that in the next section .",
    "many different configurations can have the same two  point correlation function ( or equivalently the same power spectrum ) but look completely different .",
    "this is due to the difference of the phases of the fourier component of density field which @xmath100 and @xmath2 ignore .",
    "gaussian - random density fields have statistical properties specified only by amplitudes ( since random phases have no information ) , but the properties of non  gaussian distributions are dependent on phases .",
    "the end results of n  body simulations and the distribution of matter in the universe are both non  gaussian , although they may have begun from gaussian perturbations ( as our simulation did ; see also suginohara & suto 1991 ; lahav et al .",
    "1993 ) .",
    "testing for phase agreement is another way of checking for agreement between density fields  in this case those produced by the n - body code . given phase information for complex coefficients @xmath101 specified we use @xmath102 to specify the difference in phase between two coefficients .",
    "our measure of phase agreement is @xmath103 , where the averaging is over spherical shells in @xmath69 .",
    "this measure is @xmath104 for perfect correlation , @xmath105 for uncorrelated distributions , and negative for anti - correlated ones .",
    "every correlation coefficient in tables 2 - 4 now corresponds to a function of @xmath69 . in view of the daunting task of trying to display all these functions ,",
    "we look instead for patterns . fortunately",
    ", strong ones exist .",
    "figure  [ fig : fig09 ] includes all the data for every run cross - correlated with every other run at the same stage .",
    "all data points are plotted but not joined ; many overlap .",
    "they segregate in three groups ( two of which begin to approach one another at the last stage ) .",
    "( 1 ) the best group ( solid squares , left column ) corresponds to phase correlations among the group with pm , @xmath106 , the 128@xmath1 and 64@xmath1 3 m runs and the 64@xmath1 tree runs with the same initial conditions .",
    "all runs which fit this definition stay in this `` high  agreement '' group at all stages .",
    "this agreement deteriorates with time , albeit slowly . even at late times",
    ", @xmath103 is close to 0.5 at the nyquist frequency .",
    "( 2 ) the worst group ( open circles , middle column ) corresponds to _ anything _ compared with the pm , @xmath107 run .",
    "agreement with this worsens , then gets better , as evolution proceeds .",
    "( 3 ) all other phase comparisons lie in a third group ( x s ) .",
    "this includes comparisons between various hflmr runs , which worsen with time , and is shown in the right column .    this third group ( x s ) lies mostly between the other two , but some comparisons are outliers , joining the top or bottom group .",
    "this is not consistent over evolution but a few regularities exist : the outliers ( x s ) that join the high correlation group ( squares ) include the two 32@xmath1 3 m runs compared and the two 32@xmath1 tree runs compared . each of these pairs are strongly correlated but _ do not _ correlate well with anything else , across code types or with other runs with the same force resolution , but more particles , within a code type .",
    "the outlier x s that join the worst ( circles ) group are , without exception , all comparisons involving one 32@xmath1 particle run and one with more particles within a given code , or two 32@xmath1 runs from different code types .",
    "these natural groupings correspond to those seen in the density cross - correlations in tables 24 . given the close similarity of the power spectrum in many pairs which cross - correlate badly , we conclude that while differences in phases and amplitudes both exist , the phase differences are primarily responsible for the correlation coefficient differences .",
    "statistical measures that are sensitive to phase information will clearly suffer more from discreteness that those that are not .",
    "the hflmr strategy may produce a good approximation to the power spectrum but not to anything that depends on phases unless the density field is smoothed over the interparticle separation .    to summarize : for given initial conditions , different codes agree well only when the softening approaches the mean interparticle separation .",
    "the absence of correct high frequency initial conditions ( center column ) and discreteness errors ( right column ) prevent the general agreement found in the left column .      for this series of tests we compare comoving displacement , @xmath108 , between the pm particles and our standard series of hflmr runs as a function of the density contrast computed using the pm particles .",
    "we compute @xmath109 comparing to both pm models ( @xmath110 and @xmath111 ) and at three stages of evolution ( @xmath112 , @xmath38 , and @xmath39 ) .",
    "there are several trends of interest in these plots .",
    "first , in agreement with our results from the density cross - correlation tests comparison with the pm @xmath110 case appears to produce better @xmath108 than the pm @xmath113 case .",
    "secondly , the trend of increasing agreement between the pm and hflmr codes as @xmath25 is increased also appears to hold here as well .",
    "thus , we see that increasing the number of particles present in the hflmr codes without changing the absolute force resolution causes their time integration to converge more and more toward the pm code result . in figure 12 ,",
    "the best overall agreement with the pm code is the p@xmath1 m code based on 128@xmath1 particles .",
    "the differences that do exist between different codes with the same initial conditions are amplified as the the particles continue to move apart from one another .",
    "thus , comparing the top three panels of fig  [ fig : rhofig10 ] , fig  [ fig : rhofig11 ] , and fig  [ fig : rhofig12 ] , we see that amplification of errors is more rapid for smaller @xmath25 , even when the force resolution @xmath5 is held constant . in figures  [ fig : rhofig13 ] ,  [ fig : rhofig14 ] , and  [ fig : rhofig15 ] the comparison is done against displacements of particles compared with the pm @xmath114 = 64@xmath115 run . in this case",
    "they are uniformly bad .",
    "although the integration errors are greatly reduced by having more particles , the absence of the extra power in the initial conditions prevents convergence .",
    "none of the runs , regardless of its parameters , comes close .      in cluster analysis ,",
    "percolation properties are used to examine the properties of connected regions .",
    "criteria of density thresholds or the close approach of particles are used to decide which clumps are connected .",
    "this has been used to study the formation of structure in simulations and in redshift surveys .",
    "percolation properties strongly depend on sampling : the more particles in the model , the easier percolation .",
    "obviously percolation in the model corresponding to fig .",
    "1b is easier than in fig .",
    "there are less obvious differences in the number and other properties of overdense regions .",
    "[ fig : fig16 ] shows three statistics calculated for the subsamples with equal number of particles ( @xmath116 ) .",
    "the left panels show the fraction of mass in the regions having densities above a given density threshold for all models at three stages of evolution .",
    "the middle panels show the fraction of volume occupied by these regions and the right panels show the total number of overdense regions as functions of the density threshold .",
    "the clumps were identified by using the percolation code described in yess & shandarin ( 1996 ) .",
    "we show the high density part of these distributions .",
    "the mass fraction runs from about 0.1% to 10% and the number of clusters from 3 to 300 - 1000 .",
    "there are significant differences between the models .",
    "unfortunately , the patterns are different at every stage therefore it is difficult to describe them . the differences can be seen more clearly when the ratios are plotted .",
    "to do so we choose pm(@xmath107 ) as a fiducial model and plot the logarithms of the ratios in fig .",
    "[ fig : ratios ] .",
    "we also extend the range of densities toward lower densities in this figure so the convergence of the models can be seen .    at the stage @xmath117",
    "all models converge at about @xmath118 . in the range @xmath119",
    "the fiducial pm64 model has more clumps and more mass in clumps than any other model , however at the very high densities @xmath120 it has fewer clumps and less mass in the clumps than any other model .",
    "the typical differences are 2 -3 times .",
    "one could expect similar errors on small scales when studying the early stages of clustering , such as lyman-@xmath121 absorbers or high - redshift galaxy formation , or the inner parts of dark matter halos .    at the stage",
    "@xmath122 the differences between models are the least of all three stages .",
    "all models except the tree code with @xmath123 have more mass in clumps ; they are also more numerous and occupy greater volume .",
    "the 3 m model with @xmath124 has the highest values of all statistics and the tree code with @xmath123 has the lowest .",
    "the 3 m and tree codes with @xmath125 are significantly lower than 3 m model with @xmath124 .",
    "this pattern generally persists at the stage @xmath126 , however the amplitude of the differences is greater .",
    "the 3 m model with @xmath124 is again among the highest but the 3 m and tree codes with best force resolution @xmath125 are now comparable to it .",
    "all the models converge at about @xmath127 .",
    "when the densities are computed on the @xmath67 mesh the differences are considerably smaller but still are noticeable at the @xmath128 stage in fig .",
    "[ fig : fig18 ] .",
    "however , they almost vanish at the final stage .",
    "this variation of peak density with particle number is completely consistent with results presented by craig ( 1997 ) on the central density of halos in n  body simulations .",
    "after this paper was submitted , a preprint appeared ( moore et al .",
    "1997 ) which shows the same effect in cdm models at higher density levels .",
    "the genus is a measure of the connectivity of structures widely used in cosmology .",
    "it is specifically highly sensitive to phase information .",
    "all gaussian distributions have the same distribution of genus as a function of volume fraction , with the amplitude merely being determined by an integral over the power spectrum .",
    "we show the genus here computed using the method of weinberg et .",
    "al ( 1987 ) .",
    "the genus plotted for the last stage of the evolution in fig .",
    "[ fig : fig19 ] is essentially in agreement with the other results : there are differences up to 15% between different codes on the scale of the force resolution ( right panel ) and almost no differences on the scale of the mean particle separation ( left panel ) .",
    "in fact with this smoothing the n - body results are shown to reproduce well the quasi - linear prediction for the genus curve .",
    "see matsubara ( 1994 ) and matsubara & suto ( 1995 ) for details .",
    "cluster analysis has shown that if the clumps were selected using isodensity surfaces calculated on the force resolution scale then different codes would predict very different numbers of clumps , their total volume and the total mass in the clumps .",
    "differences as large as factor of 2 or 3 are typical for the few hundred largest clusters . the vertical scales in fig .",
    "[ fig : fig16 ] are about 2 -3 times greater than the horizontal scales depending on the statistics and stage .",
    "this means that if one reverses the question and asks what is the difference in the density thresholds provided that same number of clumps ( or total mass ) selected then the difference in densities would be about 30 - 50% . if the densities are computed on the scale of the mean particle separation then all codes agree with each other at stage @xmath129 with about 20% accuracy in terms of the numbers , volumes and masses at given density thresholds or with accuracy of 5% in terms of density .",
    "these differences are based on clustering , not sampling , since we used the same number of particles for each .",
    "however , one can get an idea of the size of a possible sampling effect by comparing the results shown here for pm with a fully sampled pm density field using all 128@xmath1 particles .",
    "the differences in these statistics between sparse and full pm samples are much smaller than those we find between different codes .",
    "due to the non - monotonic nature of the changes we see with evolution , we can not make any predictions about how various codes and strategies would compare at later stages of evolution .",
    "a number of the statistical results presented here show only moderate differences between the various codes and our choices of @xmath5 and @xmath52 .",
    "this is particularly true for the two  point statistics , @xmath2 and @xmath100 , which contain no phase information . on the other hand , for @xmath130 and @xmath89 the dependence on @xmath5 and @xmath52 is weak , while the dependence is strong for the phase correlations , the mass density and number of clumps , as well as the phase correlations and the density cross  correlations .",
    "this implies that the distribution of the phases may be the pivotal piece of information that is needed to resolve this issue .",
    "unfortunately , no satisfactory measure of the distribution of the phases exists .",
    "we can not easily compare our results with others , because no study has included the variety of codes , mass resolution , and inclusion of normally absent small  scale perturbations .",
    "the most similar work is the unpublished study coordinated by d.h .",
    "an analysis similar to our figure 8 produced very similar results .",
    "efstathiou et al . ( 1988 ) studied evolution of power  law initial conditions in a p@xmath1 m code , using primarily low  order or averaged statistics .",
    "they did find fluctuations of order 50% in the rescaled multiplicity function ( their figure 9 ) ; while not equivalent , this is roughly compatible with our results in the central column of figure 16 .",
    "it is interesting to keep in mind that in plasma physics ( e.g. , hockney & eastwood 1988 ) and in beam dynamics ( habib 1997 ) it is widely recognized that @xmath131 is a requirement to accurately model a collisionless system .",
    "this is in strong contradiction to usual practice in cosmological simulations where @xmath132 .",
    "this is a survival in methodology from the original cosmological n  body simulations which assumed to evolve the distribution of galaxies and _ not _ the dark matter distribution ( in fact , they were generally called `` galaxy clustering simulations '' at the time ) .",
    "note that we can not appeal to which code produces the best agreement with observations to settle our dilemma . on small scales , where we find significant differences",
    ", there is an unknown correspondence between mass and light in the universe .",
    "this issue must be settled by first principles , i.e. , agreement on which equations are to be solved and the most accurate methods to solve them .",
    "there is one crucial piece of evidence in our study .",
    "no one would dispute that the performance of any of our codes would become more accurate as more particles are added , if the force resolution is held constant . as is shown in many of our tests , this causes both tree and p@xmath1 m results ( given the same initial conditions ) to converge to our pm run . for low - order statistics , such as the power spectrum and correlation function",
    ", a small softening parameter appears to replicate the effect of more particles ( although the results are not identical so it not possible to determine how small the softening parameter can be made without introducing artificial collisionality into the simulation ) .",
    "but on the other hand , it is clear that decreasing the softening parameter has profound effects on any measurement which depends upon the phase information .",
    "the sources of the observed errors are _ not _ random but systematic in origin .",
    "it is important to stress that there are two numerical issues ; ( a ) two codes with identical initial conditions and similar @xmath5 and @xmath52 should produce similar statistical results for _ all _ statistical measures of the evolved particle distribution and not just a subset .",
    "our results show a convergence in the time integration between various codes as @xmath133 .",
    "unfortunately it is _ not _ standard in cosmology ( except in about half the pm applications ) to use @xmath133 .",
    "( b ) the trouble is that the `` correct '' initial conditions correspond to our case @xmath113 .",
    "thus , it appears that the hflmr codes are not able to correctly model the @xmath113 solution despite the past claims in the literature and will produce solutions which only agree to @xmath52 and not down to the force softening length @xmath5 .",
    "this , of course , creates a real dilemma when it comes to simulating truly hierarchical structure .",
    "pm codes are fast , but the number of particles are limited by disk storage requirements . so ",
    "called adaptive mesh refinement algorithms will suffer the same fate as the hflmr methods tested here since they are unable to input the true power spectrum down to arbitrary scales initially .",
    "this leaves us with nested  grid pm methods ( villumsen 1988 ; anninos , et al 1994 ; splinter 1996 ) or related strategies ( moore et al 1997 ) as a surviving option .",
    "these methods allow for both high force and mass resolution simultaneously , thus guaranteeing that @xmath133 is satisfied on the smallest scales and that the true initial power spectrum is input _",
    "ab initio_. _ local _ adaptive mesh refinement schemes may offer some advantages if the refinement is carefully designed and tested .",
    "this may allow some reduction of the integration error we have demonstrated , but can not be a substitute for inclusion of the proper initial conditions .",
    "alm and sfs wish to acknowledge the financial support of the nsf  epscor program , nasa grant n5 - 4039 , and the national center for supercomputing applications .",
    "alm also wishes to thank david weinberg and p.j.e .",
    "peebles for useful discussions as well as for an unpublished code comparison project which proved useful .",
    "rjs wishes to thank the center for computational sciences at the university of kentucky for financial support , and salmon habib for useful discussions .",
    "ys thanks resceu ( research center for the early universe , university of tokyo ) , kek ( national laboratory for high energy physics , japan ) , and the astronomical data analysis center of the national astronomical observatory ( where the tree - code simulation were performed ) for a generous allocation of computer time .",
    "the research of ys was supported by the grants - in - aid of the ministry of education , science , sports and culture of japan no.07ce2002 to resceu , and by the supercomputer project ( no.97 - 22 ) of high energy accelerator research organization ( kek ) .",
    "all the authors thank an anonymous referee for comments which improved the presentation .",
    "ccccc pm & @xmath134 & @xmath0 & 1.0 & 1.0 & @xmath135 & @xmath0 & 1.0 & 1.0 p@xmath1 m & @xmath134 & @xmath67 & 4.0 & 0.0625 & @xmath134 & @xmath67 & 4.0 & 0.25 & @xmath134 & @xmath68 & 2.0 & 0.5 & @xmath134 & @xmath0 & 1.0 & 1.0 tree & @xmath134 & @xmath67 & 4.0 & 0.0625 & @xmath134 & @xmath67 & 4.0 & 0.25 & @xmath134 & @xmath68 & 2.0 & 0.5    lccccccccccc pm ( @xmath134 ) &  & 0.31 & & 0.94 & 0.93 & 0.77 & 0.76 & & 0.97 & 0.74 & 0.74 pm ( @xmath135 ) & 0.92 &  & & 0.31 & 0.30 & 0.26 & 0.26 & & 0.31 & 0.26 & 0.26 p@xmath1 m @xmath136 ) & 1.00 & 0.91 & &  & 0.95 & 0.72 & 0.72 & & 0.95 & 0.69 & 0.69 p@xmath1 m @xmath137 ) & 1.00 & 0.91 & & 1.00 &  & 0.81 & 0.81 & & 0.97 & 0.78 & 0.77 p@xmath1m(@xmath138 ) & 0.99 & 0.91 & & 0.98 & 0.99 &  & 0.98 & & 0.81 & 0.96 & 0.96 p@xmath1m(@xmath139 ) & 0.98 & 0.91 & & 0.98 & 0.99 & 1.00 &  & & 0.81 & 0.95 & 0.95 tree @xmath68 ( @xmath140 ) & 1.00 & 0.92 & & 1.00 & 1.00 & 0.99 & 0.99 & &  & 0.79 & 0.79 tree(@xmath138 ) & 0.98 & 0.90 & & 0.98 & 0.98 & 1.00 & 1.00 & & 0.99 &  & 0.99 tree(@xmath139 ) & 0.98 & 0.90 & & 0.98 & 0.98 & 1.00 & 1.00 & & 0.99 & 1.00 &     lccccccccccc pm ( @xmath134 ) &  & 0.48 & & 0.87 & 0.84 & 0.60 & 0.58 & & 0.91 & 0.55 & 0.56 pm ( @xmath135 ) & 0.94 &  & & 0.47 & 0.46 & 0.40 & 0.40 & & 0.46 & 0.37 & 0.38 p@xmath1 m @xmath136 ) & 1.00 & 0.94 & &  & 0.88 & 0.59 & 0.57 & & 0.86 & 0.53 & 0.54 p@xmath1 m @xmath137 ) & 1.00 & 0.94 & & 1.00 &  & 0.65 & 0.63 & & 0.90 & 0.58 & 0.59 p@xmath1m(@xmath138 ) & 0.97 & 0.92 & & 0.97 & 0.98 &  & 0.92 & & 0.64 & 0.86 & 0.87 p@xmath1m(@xmath139 ) & 0.96 & 0.92 & & 0.97 & 0.97 & 1.00 &  & & 0.62 & 0.83 & 0.84 tree @xmath137 ) & 1.00 & 0.94 & & 0.99 & 1.00 & 0.98 & 0.98 & &  & 0.61 & 0.61 tree(@xmath138 ) & 0.96 & 0.92 & & 0.96 & 0.96 & 0.99 & 0.99 & & 0.97 &  & 0.93 tree(@xmath139 ) & 0.96 & 0.92 & & 0.96 & 0.96 & 0.99 & 0.99 & & 0.97 & 1.00 &     lccccccccccc pm ( @xmath134 ) &  & 0.65 & & 0.83 & 0.80 & 0.64 & 0.61 & & 0.84 & 0.52 & 0.49 pm ( @xmath135 ) & 0.96 &  & & 0.63 & 0.63 & 0.57 & 0.55 & & 0.63 & 0.47 & 0.44 p@xmath1 m @xmath136 ) & 0.99 & 0.95 & &  & 0.89 & 0.66 & 0.64 & & 0.84 & 0.50 & 0.48 p@xmath1 m @xmath137 ) & 0.99 & 0.96 & & 0.99 &  & 0.68 & 0.66 & & 0.84 & 0.49 & 0.47 p@xmath1m(@xmath138 ) & 0.96 & 0.94 & & 0.97 & 0.97 &  & 0.86 & & 0.67 & 0.70 & 0.67 p@xmath1m(@xmath139 ) & 0.96 & 0.94 & & 1.00 & 1.00 & 1.00 &  & & 0.63 & 0.63 & 0.63 tree @xmath137 ) & 1.00 & 0.96 & & 0.99 & 0.99 & 0.97 & 0.97 & &  & 0.60 & 0.56 tree(@xmath138 ) & 0.92 & 0.90 & & 0.92 & 0.92 & 0.96 & 0.96 & & 0.94 &  & 0.87 tree(@xmath139 ) & 0.92 & 0.90 & & 0.91 & 0.91 & 0.96 & 0.96 & & 0.94 & 1.00 & "
  ],
  "abstract_text": [
    "<S> fundamental physical considerations and past tests suggest that there may be a problem with discreteness error in n  body methods widely used in cosmological clustering studies . </S>",
    "<S> this could cause problems with accuracy when coupled to hydrodynamics codes . </S>",
    "<S> we therefore investigate some of the effects that discreteness and two  body scattering may have on n - body simulations with `` realistic '' cosmological initial conditions .    </S>",
    "<S> we use an identical subset of particles from the initial conditions for a @xmath0 particle  mesh ( pm ) calculation as the initial conditions for a variety of particle  particle  particle mesh ( p@xmath1 m ) and tree code runs . the force softening length and particle number in the 3 m and tree code runs </S>",
    "<S> are varied and results are compared with those of the pm run . in particular , we investigate the effect of mass resolution ( or equivalently the mean interparticle separation ) since most `` high resolution '' codes only have high resolution in gravitational force , not in mass . </S>",
    "<S> we show the evolution of a wide variety of statistical measures . </S>",
    "<S> the phase - insensitive two  point statistics , @xmath2 and @xmath3 are affected by the number of particles when the force resolution is held constant , and differ in different n  body codes with similar parameters and the same initial conditions . </S>",
    "<S> phase  </S>",
    "<S> sensitive statistics show greater differences . </S>",
    "<S> results converge at the mean interparticle separation scale of the lowest mass  resolution code . as more particles are added , but the absolute scale of the force resolution is held constant , the 3 m and the tree runs agree more and more strongly with each other and with the pm run which had the same initial conditions , suggesting that the time integration is converging . </S>",
    "<S> however , they do not particularly converge to a pm run which continued the power law fluctuations to small scales . </S>",
    "<S> this suggests high particle density is necessary for correct time evolution , since many different results can not all be correct . </S>",
    "<S> our results showing the effect of the presence or absence of small  scale initial power suggest that leaving it out is a considerable source of error on comoving scales of the missing wavelengths , which can be resolved by putting in a high particle density .    </S>",
    "<S> since the codes never agree well on scales below the mean comoving interparticle separation , we find little justification to use results on these scales to make quantitative predictions in cosmology . </S>",
    "<S> the range of values found for some quantities spans 50% , but others , such as the amount of mass in high density regions , can be off by a factor of three or more . </S>",
    "<S> our results have strong implications for applications such as the density of galaxy halos , early generation objects such as qso absorber clouds , etc .    </S>",
    "<S> 3mp@xmath1 m </S>"
  ]
}