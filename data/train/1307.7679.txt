{
  "article_text": [
    "the development environment that we have used for the spm simulator program is similar that used to develop our real - time scanning program rtspm.@xcite the details can be found in ref .",
    ", so we shall only give an outline here .",
    "we emphasize that all the software used is open - source . in order to achieve real - time control ,",
    "we use a desktop computer running a linux kernel patched with the real time application interface ( rtai).@xcite communication with the data acquisition hardware is achieved through the open - source comedi drivers@xcite with appropriate real - time extensions that interface well with rtai . for this paper",
    ", we used a national instruments@xcite pci-6052e card for input and output , although any of the data cards supported by comedi can be used , so long as they meet the required data acquisition rates of the program .",
    "the pci-6052e card has analog input and output rates of 333 ks / sec , more than sufficient for our purposes , but we have also used other national instruments data acquisition cards .",
    "the real time components of the program are coded in a library as callable subroutines that are written in c using the integrated development environment code::blocks,@xcite which is also open - source . the graphical user interface ( gui )",
    "is written in free pascal@xcite using the open - source integrated development environment lazarus;@xcite the real - time parts of the program are called by this main program .",
    "figure [ fig1 ] shows a screenshot of the gui of the program , which lets the user choose the channels for the data acquisition inputs and outputs .",
    "there are three data acquisition inputs to the program , corresponding to the @xmath1 , @xmath2 and @xmath3 voltage drives of a standard piezotube scanner , which can be selected independently from the gui .",
    "these inputs are provided by a spm control program : in our case , this control program is the real - time control program rtspm that we developed earlier.@xcite the voltages on the @xmath1 and @xmath2 channels are assumed to correspond directly to the @xmath1 and @xmath2 displacements of the scanner : of course , one can easily implement an appopriate scale factor for each channel independently to model specific hardware if needed .",
    "for the @xmath3 voltage , the user can input the scale factor directly .",
    "for the data shown in this paper , we use a scale factor of 155 nm / v , corresponding to the scan tube in our physical instrument . for testing purposes , reading of the @xmath1 and @xmath2 channels can be disabled , and the @xmath1 and @xmath2 positions of the scanner can be manually entered from the gui .    as we noted earlier ,",
    "the real - time part of the program is very simple in concept .",
    "once the simulator is started , a real - time loop runs continuously with a loop time of 50 @xmath0s . in the loop itself",
    ", the program first determines the @xmath1 and @xmath2 positions of the scanner .",
    "if external scanning is enabled , these positions are read directly from the @xmath1 and @xmath2 input channels , otherwise they are taken to be the manually entered values discussed above .",
    "depending on the @xmath1 and @xmath2 positions of the scanner , the program then determines what the corresponding topographical height should be . for this paper , we have taken the simplest structure , an array of squares of specified lateral dimension and specified height with a lattice constant of 1 @xmath0 m , although clearly more complicated topographic structures can easily be programmed .",
    "the program then reads the @xmath3 channel to determine the height of the scanner .",
    "since the program now knows the height of the @xmath3 scanner and the topographic height of any feature at that @xmath4 position directly below it , it can then calculate and output a voltage according to whatever model is being used to generate the tip - sample interaction .",
    "this output voltage , which corresponds to the feedback signal input to the spm controller program , is then read by the spm controller program to adjust the @xmath3 piezo voltage accordingly .",
    "the process is then repeated on the next 50 @xmath0s cycle .",
    "the voltage that the program generates depends on the model of the tip - sample interaction .",
    "we discuss below two models that we have implemented , although other tip - sample interactions can also be modeled .",
    "our own research is devoted to development of a low temperature scanning probe microscope , so it is natural for us to first try to implement a model for an atomic force microscope .",
    "our home - built scanning probe microscope is based on a tuning fork transducer,@xcite so the parameters in the model described below will refer to the measured parameters from this instrument , but the program allows these parameters to be modified to match any force transducer .",
    "we start by assuming that the interaction between the tip and sample is due to van der waals forces at larger distances with a strong repulsion at short distances",
    ". this interaction can be described by a lennard - jones type potential of the form @xmath5 where @xmath3 is the distance between the tip and the sample , and @xmath6 and @xmath7 are constants .",
    "the first term describes the strong repulsion between tip and sample at very short distances , and the second describes the relatively short range van der waals interaction .",
    "the two unknowns in the potential are the parameters @xmath6 and @xmath7 .",
    "we shall use the measured characteristics of the close - approach curve to determine these constants .",
    "the force between the tip and the sample corresponding to this potential is @xmath8 to eliminate one of these constants , we specify the position of the minimum of force @xmath9 as a function of @xmath3 as @xmath10 . by setting @xmath11 at @xmath12 ,",
    "this allows us to express @xmath7 in terms of @xmath6 and @xmath10 , @xmath13 a tuning fork based afm is operated in non - contact mode .",
    "the tuning fork is oscillated at its resonance frequency @xmath14 , which for our tuning forks is close to 32768 hz .",
    "the tip - sample interaction modifies the resonant frequency .",
    "the shift in resonant frequency @xmath15 can be thought of as arising from a shift @xmath16 in the effective spring constant of the tuning fork @xmath17 where @xmath18 is the spring constant of the tuning fork far from the surface .",
    "this is because the resonance frequency is proportional to the square root of the spring constant .",
    "we shall use @xmath18=1800 n / m , corresponding to the spring constants of the tuning forks we normally use .",
    "now @xmath16 is given by the derivative of the tip - sample force @xmath19 .",
    "\\label{eqn5}\\ ] ]    in non - contact mode , one can measure the amplitude or phase of the oscillation as a feedback signal .",
    "however , if the quality factor @xmath20 of the force transducer is large , as it is for the tuning forks , it may take a very long time for these signals to relax to their proper values . hence , it is common to use a phase - locked - loop ( pll ) to stay on the resonance and track the change in resonant frequency as a function of distance @xmath3 .",
    "thus , we will use the change in frequency as the feedback signal for our spm controller .",
    "the change in frequency is proportional to @xmath16 , which still has one unknown constant @xmath6 ( eqn .",
    "[ eqn5 ] ) . since one",
    "directly measures the frequency - distance curve during close approach , @xmath6 can be determined from this curve .",
    "let the total change in frequency between where the tip is far from the sample ( @xmath21 ) and the value of @xmath22 where the frequency shift @xmath15 has its minimum be @xmath23 .",
    "( @xmath24 is related to @xmath10 by @xmath25 . )",
    "then @xmath6 can be expressed as @xmath26 determining @xmath27 in a real experiment ( and hence the absolute values of @xmath10 or @xmath24 ) is difficult , since @xmath27 is the point at which the tip makes contact with the sample , and one prefers not to crash the tip into the sample . at distances far from the surface ( @xmath21 ) , @xmath15 is ideally 0 : in reality , due to experimental offsets , it may have a small finite value , which we denote @xmath28 .",
    "then the value of @xmath3 near the surface at which @xmath29 is by definition @xmath10 , and the minimum of @xmath15 as a function of @xmath3 occurs at @xmath30 .",
    "thus by measuring the value of @xmath3 at these two points , one can determine @xmath10 .",
    "consequently , by specifying the known or measured quantities @xmath23 , @xmath18 , @xmath14 and @xmath10 , one can determine all the parameters of the model .",
    "these quantities are entered in the main program by hand . the frequency shift , and hence the feedback signal that the program generates ,",
    "can then be calculated using eqns .",
    "( [ eqn4 ] ) , ( [ eqn5 ] ) and ( [ eqn6 ] ) .",
    "m etched tungsten wire acting as a tip .",
    "the spring constant of the tuning fork is 1800 n / m , and the curve was obtained with the rtspm program .",
    "red : approach curve obtained with the simulator program , using a lennard - jones type potential as described in the text .",
    ", width=321 ]    the black trace in fig .",
    "[ fig2 ] shows an example of an experimental close - approach curve measured using our home - built tuning fork scanning probe microscope and the spm control program rtspm . from this curve , we determine @xmath31 hz and @xmath32 nm . the red trace in fig .",
    "[ fig2](b ) shows the corresponding curve generated using the spm simulator program , again taken with the spm control program rtspm .",
    "it can be seen that the experimental close - approach curve is broader than the simulation based on the lennard - jones potential .",
    "we do not know the origin of this discrepancy ; however , it should be noted that the experimental curve was taken with a conducting tip , and hence may be influenced by residual electrostatic interactions , which have a slower power - law dependence .",
    "m @xmath33 12 @xmath0 m forward topographic scan with a resolution of 256 x 156 pixels .",
    "each square in the image is 0.5 @xmath0 @xmath33 0.5 @xmath0 m and has a height of 5 nm .",
    "( b ) line scan profiles corresponding to the line marked in ( a ) for the forward scan ( black trace ) and the reverse scan ( red trace ) . ,",
    "width=321 ]    figure [ fig3](a ) shows an image generated by the rtspm program coupled to the spm simulator program .",
    "( this figure and other images in this paper are generated using the open source spm analysis program gwyddion.@xcite ) as described earlier , the `` sample '' is a computer generated array of squares of side 0.5 @xmath0 m and height 5 nm , separated by a distance of 1 @xmath0 m .",
    "the rtspm has a real - time proportional - integral - differential ( pid ) controller@xcite that controls the extension of the scan tube based on the desired set point , which is a fixed frequency deviation from the @xmath34 limit .",
    "for the image in fig .",
    "[ fig3](a ) , the pid parameters used in the rtspm program were @xmath35 , @xmath36 ms , and @xmath37 ms with a set point of 2 hz , which puts us in the hard repulsive region of the approach curve . in this region , a small change in @xmath3 gives rise to a large change in frequency . nevertheless , as can be seen from the line profiles shown in fig .",
    "[ fig3](b ) , the topography is accurately mapped by the rtspm program in both the forward and reverse scan directions , with a difference corresponding to about 1 pixel . the scan resolution is 256x256 pixels , and the rtspm program averages for 10 ms on each pixel to reduce the noise , so the image of fig .",
    "[ fig3](a ) took approximately 12 minutes to acquire .    , but with a non - realtime simulator coded in labview on a computer running windows xp .",
    "( b ) line scan profiles corresponding to the line marked in ( a ) for the forward scan ( black trace ) and the reverse scan ( red trace ) . ,",
    "width=321 ]    in order to illustrate the importance of having a real - time spm simulator program , we have also encoded the same program on a desktop computer running windows xp in national instruments labview without any real - time extensions . in this case , even on a relatively fast computer , the minimum loop time is at best 10 ms .",
    "figure [ fig4](a ) shows the image obtained with the rtspm program using the same pid parameters and setpoint as in fig .",
    "[ fig3 ] , but coupled to the labview simulator .",
    "it can be seen that the image quality is much worse , and the line profiles in fig , [ fig4](b ) show that this is because the @xmath3 position of the scanner does not follow the topography . since all parameters in the rtspm program are the same for figs .",
    "[ fig3 ] and [ fig4 ] , the difference is clearly due to the lack of real - time response in the labview program .",
    "the van der waals interaction for afm in principle can be extended to other types of tip - sample interactions .",
    "for example , for scanning tunneling microscopy , one can model a tunneling current that depends exponentially on the distance between the tip and the sample , and also on bias . for a more sophisticated model",
    ", one can think of a conducting `` sample '' with a spatially inhomogenous density of electronic states .",
    "even relatively inexpensive modern multicore desktop computers should be able to calculate the feedback response of most tip - sample interaction models in a loop time of 50 @xmath0s .    for long range tip - sample interactions ,",
    "the models are more complicated .",
    "for example , for magnetic force microscopy ( mfm ) on a ferromagnetic film , one must consider not only the magnetic interaction between the magnetic tip and the part of the sample just below the tip , but also the magnetic interaction with other parts of the ferromagnetic film that are much further away . in electrostatic force microscopy ( efm ) , the electrostatic interaction between the tip and the sample is also long range , and an accurate calculation would require numerical techniques .",
    "there have been a number of papers that have developed approximations for the tip sample interaction both in the context of efm and scanning capacitance microscopy.@xcite however , with some simplifiying assumptions , one can use a simple model that gives a realistic reproduction of an electrostatic image .",
    "the assumption that we shall make is that the conducting tip on the scan tube is very close to the conducting surface of the sample , so that the interaction between the tip and the sample can be approximated by the interaction between a small conducting sphere and an infinite conducting plane , where the radius @xmath38 of the small sphere is the same as the radius of the microscope tip .",
    "as can be expected , this assumption neglects fringe fields at the edges of a conducting region in the sample , but the result should be accurate beyond a few multiples of the tip - sample distance from any edge .",
    "consider then the force between a conducting sphere of radius @xmath38 and an infinite grounded conducting plane .",
    "this is a classic problem that can be solved by the method of images.@xcite the force between the sphere and conductor is given by @xmath39 where @xmath40 is the voltage difference between the sphere and plane ( which in the case of real metals will also include any contact potentials ) , and @xmath41 is the capacitance between them .",
    "since @xmath41 decreases with increasing distance @xmath3 , the force is always attractive .",
    "calculation of the force then reduces to calculation of the capacitance , which is given by the series@xcite @xmath42 where @xmath43 .",
    "the resulting expression for the force is @xmath44 since we would like to calculate the derivative of @xmath45 with respect to @xmath3 to calculate the shift in frequency along the lines of eqns .",
    "[ eqn4 ] and [ eqn5 ] , it would be nice to have a simpler equation to work with .",
    "_ et al.__@xcite have shown that the following expression closely approximates eqn .",
    "[ eqn9 ] , with a maximum error of a few percent@xcite @xmath46 v^2 .",
    "\\label{eqn10}\\ ] ] we shall use this equation in our calculations of the frequency shift @xmath47 due to the electrostatic interaction .",
    "this frequency shift can be calculated from eqn .",
    "[ eqn4 ] and the relation @xmath48 .",
    "we obtain @xmath49 ^ 2}\\right ] .",
    "\\label{eqn11}\\ ] ] unlike the equation for the van der waals interaction , we note that there are no free parameters in this equation .",
    "figure [ fig5 ] shows the close - approach curves generated with the spm simulator program both with and without the electrostatic force . here the radius @xmath38 of the tip is taken to be 20 nm , and the potential difference @xmath40 between the tip and sample is 5 v. as is well known and can be seen from the two curves , the van der waals interaction is dominant close to the surface , at a distance of less than a few nm , while the electrostatic interaction , being longer range , contributes to the attractive potential at larger distances .",
    "this forms the basis of two techniques to extract the electrostatic force . in the first technique , for each line of the scan , a forward and reverse scan is made under feedback at a setpoint corresponding to a distance from the surface at which the van der waals force is dominant .",
    "the resulting @xmath3 positions of the piezo scan tube reflect primarily the topography of the sample along the scan line .",
    "the spm controller then takes the scan tube out of feedback mode , raises the scan tube in the @xmath3 direction by a distance @xmath50 , the lift height , and retraces the forward and reverse traces while recording the frequency shift . since the system is no longer under feedback , @xmath50 should be larger than any topographic features in the sample .",
    "the idea behind this constant height technique is that for sufficiently large @xmath50 , the primary contribution to the resulting signal will be from electrostatic forces .",
    "one can also retrace the stored @xmath3 positions of the topographic trace at the added height @xmath50 while recording the frequency shift .",
    "the hope is that this `` lift mode '' technique will subtract the contribution from the signal due to topography , leaving only the signal due to the electrostatic force . of course",
    ", one can also measure other signals such as the phase or amplitude of the oscillation when the system is not in feedback , but we have chosen here to measure the frequency shift as it is conceptually easier to understand .",
    "the benefit of modeling the electrostatic interaction is that one can determine immediately what appropriate value of @xmath50 to use from the close - approach curves in fig .",
    "if we use a set point of 2 hz for the topographic image , it appears that a lift height of about 8 nm should give the largest electrostatic signal .",
    "m x 12 @xmath0 m , and the topographic height of each square is 5 nm .",
    "the colour bars are for the @xmath3-scale ; for the topographic image the units are m , for the efm images the units are hz.,width=321 ]    m x 12 @xmath0 m , and the topographic height of each square is 5 nm .",
    "the colour bars are for the @xmath3-scale ; for the topographic image the units are m , for the efm images the units are hz.,width=321 ]    in order to model an electrostatic sample , we use the same array of squares described earlier , but assume each alternate square in the array has a potential @xmath40 applied , with the tip and the other squares being grounded .",
    "this approximates the standard samples frequently used for efm calibration , which consist of interdigitated metallic fingers which have a potential applied only to every alternate finger , so that one can immediately distinguish between the topographic image and the electrostatic image .",
    "figure [ fig6 ] shows three dimensional representations of the resulting topographic and electrostatic images , using constant height mode in the dc efm module of rtspm . for these images",
    ", we used a setpoint for the topographic image of 2 hz ( referring to fig .",
    "[ fig5 ] ) , a voltage @xmath51 v , and a lift height of @xmath50= 8 nm .",
    "it is clear from the figure that there is substantial leakage of the topographic image into the efm image .",
    "this is not surprising , since for a lift height of 8 nm , the height of the tip above each square is only 3 nm so the van der waals force would contribute considerably to the signal .     and [ fig7 ] , but with a lift height of 20 nm .",
    "the lift mode and constant height mode scan were acquired separately .",
    "the colour bars are for the @xmath3-scale ; for the topographic image the units are m , for the efm images the units are hz.,width=321 ]    for comparison , fig . [ fig7 ] shows the corresponding image ( at the same lift height of 8 nm ) obtained using lift mode . while there is some bleeding of the topographic image into the efm image , it is quite small : the ratio of the signal between squares with and without a potential is about a factor of 20 . the maximum frequency shift in fig .",
    "[ fig7](b ) is about 300 mhz .",
    "clearly , lift mode is the preferable mode of operation when the sample has any appreciable topographical relief . to eliminate any topographic signal in the efm image",
    ", one can use a larger lift height .",
    "figure [ fig8 ] shows the lift mode and constant height mode efm images for a lift height of 20 nm .",
    "while the constant height mode image still shows some hint of the squares without any potential , the lift mode image shows no hint of the topography , but only the electrostatic profile .",
    "the overall lift mode signal is reduced in comparison to fig .",
    "[ fig7 ] , but not by much ( 80 mhz peak frequency shift ) , a reflection of the long range nature of the electrostatic force .    in summary",
    ", we have developed a real - time software simulator that models the response of a scanning probe microscope .",
    "the simulator is useful for testing scanning probe control software as well as different models for tip sample interactions .",
    "text the software is availably freely as a git repository at git://github.com / chandranorth / tfsimulator.git .",
    "v. chandrasekhar and m.m .",
    "mehta , rev .",
    "instrum . *",
    "84 * , 013705 ( 2013 ) .",
    "_ rtai - the realtime application interface for linux from diapm _ , https://www.rtai.org .",
    "_ comedi : linux control and measurement device interface _ , http://www.comedi.org .",
    "_ code::blocks _ , http://www.codeblocks.org .",
    "_ free pascal : advanced open source pascal compiler for pascal and object pascal _ , http://www.freepascal.org .",
    "_ lazarus _ , http://www.lazarus.freepascal.org .",
    "y. seo , p. cadden - zimansky , and v. chandrasekhar , applied physics letters * 87 * , 103103 ( 2005 ) .",
    "_ gwyddion : free spm data analysis software _ , http://www.gwyddion.net",
    ". s. hudlet , m. saint jean , c. guthmann and j. berger , eur .",
    "j. b * 2 * , 5 ( 1998 ) .",
    "m. saint jean , s. hudlet , c. guthmann and j. berger , j. appl . phys . * 86 * , 5245 ( 1999 ) .",
    "s. gmez - moivas , j.j .",
    "senz , r. carminati and j.j .",
    "greffet , appl .",
    ". lett . * 76 * , 2955 ( 2000 ) .",
    "y. naitou , a. yasaka and n. ookubo , j. appl . phys . * 105 * , 044311 ( 2009 ) .",
    "see , for example , w.r .",
    "smythe , _ static and dynamic electricity _ , 2nd edition , page 121 [ mcgraw - hill , new york , 1950 ] ."
  ],
  "abstract_text": [
    "<S> we describe software that simulates the hardware of a scanning force microscope . </S>",
    "<S> the essential feature of the software is its real - time response , which is critical for mimicking the behavior of real scanning probe hardware . </S>",
    "<S> the simulator runs on an open - source real time linux kernel , and can be used to test scanning probe microscope control software as well as theoretical models of different types of scanning probe microscopes . </S>",
    "<S> we describe the implementation of a tuning - fork based atomic force microscope and a dc electrostatic force microscope , and present representative images obtained from these models .    </S>",
    "<S> obtaining and interpreting images with a scanning probe microscope is a complicated task , even more so in the case of completely home - built microscopes with both custom electronics and custom software . </S>",
    "<S> this is because of the integral relationship between software and hardware in scanning probe microscopes , particularly in the case of more recent instruments , where many of the functions previously performed by analog electronics are now performed in software , either on the control computer itself or on a separate digital signal processor . during development , in the frequent case that something goes wrong , it is not easy to identify whether the problem lies with the software or the hardware </S>",
    "<S> . thus , it would be useful to have a diagnostic tool to test whether the control software is indeed performing as designed .    </S>",
    "<S> the heart of such a software simulator is in principle very simple : one needs only to convert the position of the tip ( as output by the scanning probe control program , perhaps by means of a voltage ) to a voltage corresponding to a feedback signal that can be read back by the control program . </S>",
    "<S> this conversion occurs according to some model of the tip - sample interaction , which in turn depends on the type of scanning probe microscopy , be it atomic force microscopy ( afm ) , scanning tunneling microscopy ( stm ) , magnetic force microscopy ( mfm ) or electrostatic force microscopy ( efm ) , to name a few . the difficult part is to do this in a time - critical manner ; the response of the simulator must be as fast or faster than typical scanning probe hardware , which means the response must be in fractions of a millisecond , and the response must be deterministic , in that response loops must be executed when expected . </S>",
    "<S> this is usually beyond the capabilities of standard desktop computers running modern operating systems , as these operating systems have preemptive multitasking , making their response times at best on the order of 10 ms , and more critically , not deterministic . </S>",
    "<S> the software we describe here@xcite is based on an open - source , real - time version of linux running on a standard desktop computer that enables loop times as short as 25 @xmath0s ( more reliably around 50 @xmath0s ) , corresponding to an upper limit frequency response on the order of 20 khz , fast enough to model most commercial and home - built scanning probe electronics . </S>",
    "<S> another major advantage of such a software simulator is that one is able to easily test different models of tip - sample interactions as well as the influence of various model parameters on the resulting images .    </S>",
    "<S> the remainder of the paper is organized as follows : section i gives an overview of the software and hardware development platform . </S>",
    "<S> section ii describes the model used to implement an atomic force microscope ( afm ) , and section iii describes the model used to implement an electrostatic force microscope . </S>",
    "<S> these are two modes that are important for our own research , and we emphasize that many other types of interactions can also be implemented relatively easily if appropriate theoretical models are available . </S>"
  ]
}