{
  "article_text": [
    "this report is a companion to the article nason ( 2013 ) .",
    "this technical report contains two sets of simulation studies .",
    "the first set concerns the performance of two different tests of second - order stationarity described in section  [ sec : tos ] .",
    "the second set examines confidence intervals for a particular form of localized autocovariance in section  [ sec : la ] and also provides an empirical justification of approximate normality of a statistic defined in the companion paper .",
    "finally , section  [ sec : rr ] provides r commands for the locits package ( which implements the new ideas in the companion paper ) showing how the figures were produced in the companion paper .    in the following we refer to the priestley - subba rao ( 1969 ) test as psr and the test introduced in the companion paper , the haar wavelet on wavelet spectrum test , as hwtos .",
    "further explanation appears in the sections below , however the main conclusions of this report concerning the tests are :    1 .   the hwtos tends to be more conservative than psr , but not always ; 2 .   for light - tailed noise",
    "the hwtos s empirical size tends to be less than its nominal size , whereas the psr tests tend to be slightly above ; 3 .   for heavy - tailed data the psr test does not perform well , giving many false positives by rejecting the null hypothesis erroneously about 60% of the time for all models we tried",
    ". by comparison the hwtos tests have much better empirical size values , although greater than their nominal size .",
    "the psr test has problems ( empirical size of about 12% ) for an ar@xmath0 process with ar parameter of 0.9 .",
    "similarly , the hwtos tests have problems ( empirical size of about 20% ) for an ar@xmath0 process with parameter @xmath1 .",
    "sometimes psr is much more powerful than hwtos and vice versa , sometimes both tests do not have much power to detect particular nonstationary alternatives and sometimes both have excellent power . as expected power depends on the alternative and the sample size .",
    "the two tests are the priestley - subba rao test of stationarity implemented by the stationarity function in the fractal package in r and ( ii ) the test of stationarity obtained by examining the haar wavelet coefficients of an evolutionary wavelet spectrum estimate modelled by locally stationary wavelet processes , implemented in the hwtos2 function and introduced by the companion paper .",
    "we augment the hwtos test with two forms of multiple comparison control : fdr and bonferonni and , as such , refer to two tests .    for both cases we are concerned with a given time series @xmath2 for @xmath3 which is a realisation from a stochastic process @xmath4 .",
    "the null hypothesis that we wish to test concerning @xmath5 is @xmath6 the process is stationary versus @xmath7 it is not !      in this section we provide simulation evidence of the empirical statistical size of the various stationarity tests .",
    "recall that the size of a hypothesis test is @xmath8 . to empirically evaluate this",
    "we first set a nominal size in our test procedure @xmath9 .",
    "( note that @xmath10 is often used as the symbol for size but here we used @xmath11 and @xmath10 is reserved for the parameter of an ar@xmath0 model . )",
    "then we run the testing procedure on @xmath12 realisations from a known stationary model and count how many times the test rejects the null hypothesis , @xmath13 .",
    "the empirical size of the test is then given by @xmath14 .",
    "a test is conservative if @xmath15 and conservative tests are generally thought of as desirable and not given to reporting false positives .",
    "the various stationary models that we have considered are :    s1 : :    iid standard normal ; s2 : :    ar@xmath0 model with ar parameter of @xmath16 with    standard normal innovations ; s3 : :    as s2 but with ar parameter of @xmath1 ; s4 : :    ma@xmath0 model with parameter of @xmath17 ; s5 : :    as s4 but with parameter of @xmath18 .",
    "s6 : :    arma@xmath19 with ar parameter of -0.4 , and ma parameters    of @xmath20 .",
    "s7 : :    ar@xmath21 with ar parameters of    @xmath22 and @xmath23 .",
    "the roots associated with the auxiliary equation , ( see chatfield , _ the    analysis of time series _ , book ) are    @xmath24 .",
    "this process    is stationary , but close to the ` unit root ' : a ` rough ' stochastic    process with spectral peak near @xmath25 .",
    "the empirical size values are given in table  [ tab : size ] , these are all computed over @xmath26 realisations with a sample size of @xmath27 for the realization .",
    ".empirical size estimates ( % ) for stationary models with nominal size of 5% [ tab : size ] [ cols=\">,>,>,>\",options=\"header \" , ]     the simulation results for power paint an interesting picture .",
    "sometimes the hwtos tests are good and the psr is not ( p1 ) , sometimes psr is good and hwtos is not ( p2 ) , sometimes both are not that good ( p3 ) and sometimes both are very good ( p4 ) .",
    "sample size is an important determining factor in power : increasing sample size should increase power of detection of alternatives .",
    "for example , with p2 which has a sample size of @xmath27 the hwtos tests have fairly low powers of 17.3%/19.2% respectively .",
    "for @xmath28 the tests are more powerful having powers of 70.7%/75.2% and for @xmath29 the empirical powers are both 100% .",
    "in this section we show some examples of the localised autocovariance and 95% confidence intervals .",
    "we start with four models and draw one realisation of length @xmath27 from each .",
    "the four models are :    ac1 : :    iid standard normal random variables ( stationary ) .",
    "ac2 : :    stationary ar@xmath0 process with ar parameter of 0.8 .",
    "ac3 : :    time - varying ar@xmath0 process with ar parameter ranging    from 0.9 to -0.9 ( same model as p1 , above ) .",
    "ac4 : :    time - varying ma@xmath0 process with ma parameter ranging    from 1 to -1 over length of the series :    @xmath30 .",
    "all innovations are standard normal .",
    "we then compute the localized autocovariance estimate @xmath31 for @xmath32 , @xmath33 , @xmath34 , @xmath35 in rescaled time . hence , for each model we display a figure with four localised autocovariance estimates : these are in figures  [ fig : acf1 ] , [ fig : acf2 ] , [ fig : acf3 ] and  [ fig : acf4 ] .    broadly speaking , figure  [ fig : acf1 ] shows the correct kind of autocovariance plot for each local time point in that it is very near to one at lag zero , and very near zero for all other lags .",
    "the actual @xmath36 value is very close to 1 in plots b.d .",
    "a bit further in plot a.  but all of the 95% ci cover 1 .",
    "the acfs at the other lags for the other time points are all very close to zero : the lag 1 ci always covers zero .",
    "however , it should be said that for a few of the acfs at some lags ( notably plot a. ) are very small , but their cis do not cover zero .",
    "each of the plots in figure  [ fig : acf2 ] look pretty reasonable to each arise from an ar@xmath0 model .    figure  [ fig : acf3 ] shows localised acf plots for a time - varying ar@xmath0 model where the ar parameter varies smoothly from 0.9 to -0.9 over the period of the series . in each of the autocovariance plots",
    "the horizontal dashed line shows the value of the ar parameter at the particular time point .",
    "so , for plot a.  in figure  [ fig : acf3 ] the true value of the ar parameter is approximately 0.551 and the estimated @xmath37 is very close to that value and is easily covered by the associated ci . plots _ b. and c. _ show similar things ( albeit with different ar parameters ) . in plot _",
    "d. _ the true value of the parameter is about -0.505 , but the estimate is nearly -1.0 and the ci does not cover the true value .",
    "figure  [ fig : acf4 ] shows localised acf plots for a time - varying ma@xmath0 model where the ma parameter varies from 1 to -1 over the length of the series .",
    "the horizontal lines show the value of the true lag 0 ( variance ) and lag 1 acfs , which are also changing over the length of the series .",
    "the cis all cover the true values ( at lags 0 and 1 ) apart from plot _",
    "a. _ where the estimate underestimates the truth .",
    "nearly all of the other lags look good ( estimated near zero , and a ci which covers zero ) apart from , again , plot _",
    "a. _ where lags 7,8 and 9 appear to be significantly different from zero , but note , still very small .",
    "this section describes the results of simulations designed to check the asymptotic normality assumption for the @xmath38 quantity . to do this",
    "we used models ac2 and ac3 and simulated the value of @xmath39 @xmath26 times evaluated at @xmath40 for different values of @xmath41 and @xmath42 .",
    "figures  [ fig : asynar0 ] to  [ fig : asynar3 ] show density estimates for the @xmath43 values for @xmath44 and , in each figure , for four different realisation sizes @xmath41 and @xmath45 with the realisations coming from a stationary ar@xmath0 model with @xmath46 .",
    "the vertical dotted line in each plot is the theoretical parameter .",
    "even the plot for @xmath27 in each case does not look too far from normal and would be at least tenable to use its variance for the basis of a confidence interval . in each plot",
    "one can see that as the sample size increases the density estimate of the relevant @xmath47 exhibits far less skew , less kurtosis , less biased and hence suggests that the asymptotic normal assumption is tenable .",
    "figures  [ fig : asyntvar0 ] to  [ fig : asyntvar3 ] provide additional evidence for the asymptotic normality but using a nonstationary tvar@xmath0 model selected at the particular time point @xmath48 .",
    "the equivalent ar@xmath0 parameter at this time point is @xmath49 .",
    "all the density estimates were produced with the density ( ) function in r with default arguments .",
    "in the interests of reproducible research we explain how we produce the figures in the companion paper , nason ( 2013 )      the data for this section are described in shumway and stoffer ( 2006 ) .",
    "the earthquake and explosion data can be obtained from david stoffer s website at    .... http://www.stat.pitt.edu/stoffer/tsa.html ....    the data is stored in a file ` eq5exp6.dat ` as a single vector of 4096 observations .",
    "the earthquake p and q waves are stored first , then the explosion p and q waves .",
    "we ve stored them as ` eqp , eqq , exp ` and ` exq ` each vectors of 1024 values . with this information figure  1 in the main paper",
    "can be produced using the following commands :    .... eqp.hwtos2 < - hwtos2(eqp ) plot(eqp.hwtos2 ) ....      similarly , the explosion p data test of stationarity plot can be obtained by    ....",
    "exp.hwtos2 < - hwtos2(exp ) plot(exp.hwtos2 ) ....      the ` dbabyecg ` data is constructed by    ....",
    "dbabyecg < - diff(c(babyecg[2 ] , babyecg ) ) ....    note : the book is actually incorrect ( typos ) , but a correct version is on the errata list of the book . the commands to produce figure 3 are :    .... dbabyecg.hwtos2 < - hwtos2(dbabyecg ) plot(dbabyecg.hwtos2 ) ....      figure  4 produced by the following bespoke set of commands :    .... tmp < - acf(eqp[100:200 ] , plot = false , lag.max = 30)$acf      tmp2 < - acf(eqp[1:300 ] , plot = false , lag.max = 30)$acf      tmp < - tmp [ , , 1 ]      tmp2 < - tmp2 [ , , 1 ]      eqp.lacvci < - rvarlacv(eqp , nz=150 )      plot(eqp.lacvci , type = \" acf \" , main = \" \" , segandcross = false , sub= \" \" )      symbols(0:30 , tmp , circles = rep(0.2 , 31 ) , inches = false ,          fg = 1 , add = true )      sm1 < - rep(0.3 , length(tmp2 ) )      sm2 < - rep(0.3 , length(tmp2 ) )      sm < - cbind(sm1 , sm2 , sm1 , sm2 , sm1 , sm2 )      n < - 18      points(0:30 , tmp2 , pch = n )      lin1 < - 2/sqrt(100 )      abline(h = lin1 , lty = 2 )      lin2",
    "< - 2/sqrt(300 )      abline(h = lin2 , lty = 3 ) ....",
    "figure 5 was produced by :    ....",
    "exq.lacv.50 < - rvarlacv(x = exq , nz=50 , var.lag.max=30 ) exq.lacv.900 < - rvarlacv(x = exq ,",
    "nz=900 , var.lag.max=30 ) plot(exq.lacv.50 , plotcor = false , type=\"acf \" ) plot(exq.lacv.900 , plotcor = false , type=\"acf \" ) ....      the four figures in figure 6 were produced by    .... # # plot a. # x < - tvar1sim ( ) x.100.tvar1 < - rvarlacv(x , nz=100 , var.lag.max=25 ) plot(x.100.tvar1 , plotcor = false , type=\"acf \" , sub=\"a . \" ) # # plot b. # x.200.tvar1 < - rvarlacv(x , nz=200 , var.lag.max=25 ) plot(x.200.tvar1 , plotcor = false , type=\"acf \" , sub=\"b . \" ) # # plot c. # x.300.tvar1 < - rvarlacv(x , nz=300 , var.lag.max=25 ) plot(x.300.tvar1 , plotcor = false , type=\"acf \" , sub=\"c . \" ) # # plot d. # x.400.tvar1",
    "< - rvarlacv(x , nz=400 , var.lag.max=25 ) plot(x.400.tvar1 , plotcor = false , type=\"acf \" , sub=\"d . \" ....    of course , the figures will be different as the realisations from the tvar1sim ( ) will be different on different machines and for different invocations .",
    "nason , g.p . ( 2013 ) a test for second - order stationarity and approximate confidence intervals for localized autocovariances for locally stationary time series .",
    "_ j.  r.  statist .",
    "_ b , * 75 * , 879904 ."
  ],
  "abstract_text": [
    "<S> this report compares two tests of second - order stationarity through simulation . </S>",
    "<S> it also provides several examples of localised autocovariances and their approximate confidence intervals on different real and simulated data sets . </S>",
    "<S> an empirical verification of an asymptotic gaussianity result is also demonstrated . </S>",
    "<S> the commands use to produce figures in a companion paper are also described . </S>"
  ]
}