{
  "article_text": [
    "two of the basic problems computational finance has to deal with are the choice of the optimal model driving the stochastic evolution of financial variables and , once a good candidate has been identified , the search of a reliable way for its fast and accurate simulation .",
    "the former issue has been widely investigated both by econometricians , mathematicians , and physicists , as demonstrated by the increasing literature on this topic , see for example  @xcite .",
    "tracing back to the work of  @xcite and the analysis in  @xcite , empirical studies have shown that financial time series exhibit features departing from the gaussian assumption . in  @xcite a detailed review of the stylized empirical facts emerging in various type of financial markets is presented and discussed .",
    "these findings are nowadays accepted as universal evidences , shared among different markets in different epochs . from the earlier results on cotton prices of mandelbrot or the thick tailed nature of the dow jones industrial average recognized by fama ,",
    "very heterogeneous models have been proposed in order to reproduce the degree of asymmetry and the excess of kurtosis of the empirical distributions .",
    "approaches directly developing from distributional assumptions includes the truncated lvy model discussed in  @xcite , and those employing generalized student-@xmath3 and exponential distributions , see  @xcite .",
    "different mechanisms also capturing the observed non trivial structure of higher order correlation functions model the stochastic nature of the return volatility .",
    "continuous time approaches have been extensively analyzed and range from the fractional brownian motion ,  @xcite , to stochastic volatility models , for a review we suggest  @xcite .",
    "discrete time models include autoregressive conditional heteroskedastic ( arch ) and generalized arch processes ,  @xcite , and multifractal ones ,  @xcite , the latter being inspired by cascades originally introduced by kolmogorov in the context of turbulent flows .",
    "turbulent velocity flows have also led to a series of empirical works testing and strongly relying on the markovian nature of foreign exchange returns ,  @xcite .",
    "the macroscopic description of the observed phenomena is provided in terms of a fokker - planck  ( fp ) equation with linear drift and quadratic diffusion coefficients .",
    "processes leading to an equation with the same structure characterize several physical systems , as reviewed in  @xcite . also the statistical feedback mechanism proposed in  @xcite can be recast in terms of non linear diffusion , as originally remarked by  @xcite , who also pointed out potential problems arising when computing expectations under power law tailed distributions .",
    "even though these drawbacks have been later amended in  @xcite , @xcite propose to switch to exponential tailed pdfs .",
    "in particular , they develop a general approach to generate a markovian process obeying scaling relations starting from a driftless stochastic differential equation ( sde ) . in the current paper",
    "we focus on the numerical characterization of these latter processes , of the above mentioned quadratic diffusion ones , and in their application in financial modeling . to this respect , especially for pricing purposes ,",
    "we need to reconstruct the conditional probability density function ( pdf ) describing the stochastic dynamics in order to evaluate expectations of future payoffs .",
    "yet a closed form expression for the density is rarely available .",
    "for this reason several numerical procedures have been developed and have become the common practice , e.g. binomial and multinomial lattice algorithms , monte carlo ( mc ) simulation , and partial differential equation solvers ( for a review see  @xcite ) .",
    "we decide to investigate and widely exploit the fast convolution algorithm ( fca ) introduced in  @xcite .",
    "the algorithm applies to markovian stochastic processes : the repeated application of the chapman - kolmogorov equation , and a clever problem re - formulation allow to rewrite functional integrals in terms of fourier and anti - fourier transforms of the state vector . performing these operations via fast fourier transform ( fft ) algorithm , numerical efficiency",
    "is achieved and computational complexity is notably reduced .",
    "the structure of the paper is the following . after introducing stochastic models we have chosen to investigate ,",
    "we detail step by step fca ; in paragraph  [ subsec : nr - mnoise ] we test its numerical performances against the standard mc approach for different specification of models and parameter values .",
    "section  [ sec : fin_application ] is dedicated to financial applications in the context of option pricing . in  [ subsec : riskneutral ] we derive the risk neutral measure for the piecewise diffusion process of  @xcite , and the exact formula for plain vanilla pricing .",
    "we then consider geometric asian options by thoroughly develop the two dimensional setting required by fast convolution , see paragraph  [ subsec : asian ] .",
    "we exploit the formal analogy between the latter case and the framework discussed by  @xcite to price plain vanilla options in paragraph  [ subsec : vnb_model ] , and in the final part we collect numerical distributions and implied volatility surfaces we have obtained to prove the reliability of fca .",
    "we draw relevant conclusions and possible perspectives in section  [ sec : conclusions ] .",
    "multiplicative stochastic processes we investigate in this work correspond to the class of quadratic diffusion described in  @xcite and of piecewise linear diffusion introduced in  @xcite and later on rediscussed by  @xcite in a slightly different flavour .",
    "the sde describing the quadratic diffusion dynamics under it prescription can be written as @xmath4 with @xmath5 initial time condition ; @xmath6 is the standard brownian increment , @xmath7 and @xmath8 are non - negative smooth functions for @xmath9 .",
    "we require @xmath10 with @xmath11 .",
    "equation   governs the dynamics of a variety of complex phenomena as reviewed in  @xcite , where an exhaustive description of the process in terms of its moments is also provided .",
    "for instance , when @xmath12 is constant , it is possible to characterize analytically the time - scaling adjustment of the process @xmath13 , regulated by the choice of @xmath14 , and its convergence to the stationary state .",
    "if @xmath15 is non negative or if @xmath16 is time dependent , @xmath13 lacks stationarity ; however , in the final section of this paper we will discuss an application of this latter case to the context of financial option pricing , tracing back to  @xcite , and later revised by  @xcite .",
    "the quadratic diffusion process  ( [ eq : quadraticsde ] ) can be formally manipulated to reduce it in a more convenient form by means of the lamperti transform , as we will see in section  [ subsec : fca ] . here",
    ", we slightly simplify it introducing a new variable beating the time @xmath17 , which we will refer to as the integral time . in this new setting the process @xmath18",
    "is described by the following dynamics @xmath19 with @xmath20 and @xmath21 , @xmath22 is a monotonously increasing function of @xmath3 , implying the well - definiteness of the inverse function @xmath23 . ] .",
    "as far as piecewise linear diffusion is concerned , the main property we are interested in is scaling , relating returns over different sampling intervals .",
    "more precisely , whenever returns are rescaled by a factor @xmath24 , the shape of their distribution scales according to @xmath25 where @xmath26 is the so called scaling function .",
    "following  @xcite , piecewise diffusion process can be defined by means of the driftless sde @xmath27 through the analysis of the fp equation satisfied by @xmath28 , it can be readily shown that @xmath29 is the only value of @xmath30 consistent with the scaling assumption  .",
    "in addition to this the fp equation admits the following solution @xmath31\\sqrt{t}}\\exp\\left[-\\frac{|x|}{\\sigma^2\\epsilon\\sqrt{t}}\\right ]      \\left(1+\\epsilon\\frac{|x|}{\\sqrt{t}}\\right)^{\\alpha-1}\\ , , \\ ] ] where @xmath32 and @xmath33=\\int_{z}^{\\infty}s^{a-1}e^{-s}{\\mathrm{d}}s$ ] .",
    "the interest in previous density is twofold , both because of the emergence of a scaling exponent @xmath29 , in agreement with the empirical findings , and because of the evidence of leptokurtosis .",
    "@xcite derive closed - form option pricing formulae under the distribution  ; yet they show that consistency between scaling , exponential pdf and martingale option pricing requires the replacement of the it correction for @xmath13 under the risk neutral measure with a constant , see section 2 in  @xcite .",
    "we argue this approximation is questionable , and we want to perform option pricing not relying on it , therefore we need a numerical methodology whose efficiency and flexibility promise to compensate for the absence of closed - form solution .",
    "in this section we review the fast convolution algorithm proposed in @xcite .",
    "let us consider the generic process @xmath18 , whose dynamics is described by the following general sde @xmath34 we start by transforming the process @xmath18 into one with unitary diffusion coefficient .",
    "this is performed via the lamperti transform , see section 1.11.4 in  @xcite , defined as @xmath35 under suitable regularity condition it lemma can be applied to @xmath36 and its dynamics turns out to be @xmath37 with @xmath38 where @xmath39 is the function @xmath40 evaluated in @xmath41 , and analogously for @xmath42 .",
    "our aim is to provide an approximate expression for the transition probability density function @xmath43 . ] .",
    "we introduce an equally spaced time grid @xmath44 , with @xmath45 , in a similar spirit to the path integral approach , see @xcite .",
    "the repeated use of the chapman - kolmogorov equation in this discrete setting allows to write the transition probability for a generic @xmath46 as a finite high dimensional integral @xmath47 where @xmath48 , and @xmath49 is the short time transition pdf that we chose equal to the normal density @xmath50\\ , .\\ ] ] by means of the new variables @xmath51 , the transition becomes symmetric under the exchange of @xmath52 with @xmath53 , i.e. @xmath54 .",
    "for each one dimensional integration appearing in equation  ( [ eq : iterck ] ) , we have @xmath55 where @xmath56 is the density @xmath57 evaluated in @xmath58 , and similarly for @xmath59 .",
    "if we introduce a numerical integration grid of equally spaced points @xmath60 for all @xmath61 and @xmath62 , where neither @xmath63 nor @xmath64 depend on the time label @xmath65 , then the pdf @xmath66 associated to transition of moving from point @xmath67 at time @xmath68 to point @xmath69 at time @xmath70 is function only of the difference @xmath71 , i.e. @xmath72 . the discrete matrix of transition probabilities @xmath73\\ , , \\end{aligned}\\ ] ] is therefore a symmetric toeplitz matrix @xmath74 , with no dependence on the time variable .",
    "letting @xmath75\\ , , \\",
    ",      \\mathrm{j}^{i}=\\left [       \\begin{array}{cccc }           \\frac{\\partial z_0^i}{\\partial\\xi_0^i}&0&\\ldots&0\\\\          0&\\frac{\\partial z_1^i}{\\partial\\xi_1^i}&\\ldots&0\\\\          \\vdots&\\vdots&\\ddots&\\vdots\\\\          0&0&\\ldots&\\frac{\\partial z_{m-1}^i}{\\partial\\xi_{m-1}^i }      \\end{array}\\right]\\ , , \\ ,      \\tilde{\\boldsymbol{\\mathrm{p}}}^{i}=\\left [       \\begin{array}{c }           \\tilde{p}(z_0^{i}(\\xi_0^i)|z^0)\\\\          \\tilde{p}(z_1^{i}(\\xi_1^i)|z^0)\\\\          \\vdots\\\\          \\tilde{p}(z_{m-1}^{i}(\\xi_{m-1}^i)|z^0 )      \\end{array }      \\right]\\ , , \\end{aligned}\\ ] ] equation   can be approximated as @xmath76 the entries of @xmath77 are computed by means of the linear interpolation operator @xmath78\\end{aligned}\\ ] ] applied to @xmath79 .",
    "similarly , equation   becomes @xmath80 matrix multiplications in previous equation are extremely time consuming .",
    "indeed , while multiplying a @xmath81-vector by the @xmath82 diagonal matrix @xmath83 requires @xmath81 operations , and analogously for the @xmath84 operator , multiplication of the @xmath85 matrix by a vector requires @xmath86 operations . on top of this , the procedure must be repeated at each time step . as a consequence",
    ", the dominant contribution grows as @xmath87 , and choosing a rather thick grid , computational times rapidly explodes .",
    "however , the multiplication of a toeplitz matrix by a vector can be efficiently performed exploiting algorithms coming from digital signal processing . by embedding @xmath85 into a circulant matrix of dimensions @xmath88 @xmath89\\ , , \\end{aligned}\\ ] ]",
    "the product of @xmath85 with a generic vector @xmath90 is equal to the first @xmath81 components of @xmath91 , @xmath92 , @xmath93 .",
    "every circulant matrix can be expressed as @xmath94 , where @xmath95 denotes conjugate transpose of @xmath96 , whose columns are @xmath97 for @xmath98 , and @xmath99 , with @xmath100 first row of the circulant matrix .",
    "thanks to this result , the product @xmath91 can be performed exploiting fast fourier transform ( fft ) algorithm @xmath101,\\ ] ] where @xmath102 and @xmath103 are the fft and anti - fft operator , respectively , while @xmath104 is the component wise product . with the adoption of this approach , the computational time",
    "is noticeably reduced : each fft computation requires @xmath105 operations .",
    "finally , in order to compute equation   we need to repeat the algorithm at each time step , and on the whole the computational burden can be estimated to be of order @xmath106 , which is definitely a satisfactory improvement with respect to the non - fft based procedure .      equipped with fca",
    "we are now ready to approach multiplicative processes previously described .",
    "we want to check that numerical results obtained by fast convolution converge to the analytical solution , when available , or to the pdf reconstructed by means of mc simulation .",
    "moreover , we show that fca provides an estimate of the distribution shape even in those low probability regions , such as the tails , which are inefficiently sampled by mc approach .",
    "lamperti transform for process   can be explicitly computed as @xmath107 with @xmath108 , and @xmath109/\\sqrt{c}$ ] .",
    "+ the related drift function is @xmath110\\tanh\\left[\\sqrt{c}(z_\\tau+\\zeta_\\tau^0)\\right ] -\\frac{\\frac{d}{2c}\\left(a-\\frac{c}{2}\\right)-b+\\frac{d}{4}}{\\sqrt{ca^2_\\tau}\\cosh\\left[\\sqrt{c}(z_\\tau+\\zeta_\\tau^0)\\right ] } + \\frac{\\tilde{e}_{\\tau}'}{2c^\\frac{3}{2}a^2_\\tau}\\chi_\\tau^0\\ , , \\ ] ] where @xmath111 , and the prime is a shorthand for the derivative w.r.t @xmath22 .",
    "+    the first and simplest case we want to consider corresponds to the sde   with time independent parameter @xmath112 , @xmath113 , and negative @xmath15 .",
    "whenever this conditions are satisfied , the process converges exponentially to the stationary regime with a typical relaxation time given by @xmath114 . following  @xcite",
    "the stationary pdf can be computed in closed - form expression as @xmath115^{\\frac{1+\\nu}{2 } } }      \\exp{\\left[-2\\frac{ad-2bc}{c\\sqrt{\\mathrm{d}^2}}\\mathrm{atan}\\left(\\frac{x\\sqrt{\\mathrm{d}^2}}{2e+d x}\\right)\\right ] }      \\ , , \\ ] ] with @xmath116 , and the inverse tangent function continues smoothly at @xmath117 . for illustrative purposes we fix the five free parameters as @xmath118 , @xmath119 , and @xmath120 , while the choice of @xmath14 and @xmath121 is at the moment irrelevant since we work directly with time @xmath22 . as evident from equation   all moments of order @xmath122 higher than or equal to @xmath123 diverge : being @xmath124 , only the first nine lowest moments converge . in figure",
    "[ fig : const_scaling_panela ] we plot the time evolution of @xmath125 for increasing values of @xmath126 as obtained by means of fca ( @xmath127 , @xmath128 , @xmath129 , and @xmath130 ) .",
    "for @xmath131 we also plot the histogram corresponding to mc simulation of the discrete process ( parameter of the euler scheme approximation : @xmath130 , and number of mc paths @xmath132 ) , while the solid line represents the analytical solution easily derived from equation  . in figure",
    "[ fig : const_scaling_panelb ] we show the same results in log - linear scale to emphasize the tail region .",
    "the analytical information provides an overall check that the algorithm converges to the correct distribution , however far from stationary regime we have no precise information about the pdf shape . in  @xcite the scaling of the convergent moments",
    "is computed analytically , but it is known that the knowledge of the moments does not allow for a univocal reconstruction of the complete distribution .",
    "we can only rely on mc simulation , but sampling of low probability region requires on average a huge statistics ( we need @xmath133 to explore a @xmath134-probability region ) . at this point",
    "the advantages provided by the fast convolution based approach are evident , as clearly shown by both panels .",
    "fca curve for @xmath131 is in perfect agreement with the analytical prediction , both in central and tail regions .",
    "mc histograms agree as well , but these results are extremely noisy and very inaccurate for @xmath135 .",
    "fca based results are even more impressive looking at the computational time .",
    "performances are strongly machine dependent , and for this reason we do not quote absolute times , but measured relative values : to obtain @xmath131 bars mc takes ten times more than fca . as a consequence it needs @xmath136 times more to reach the same accuracy at @xmath137 level .",
    "[ fig : etdep_scaling ]    similar results are obtained for the slightly more complicated process used in  @xcite to model foreign exchange rate fluctuations . their process is still mean reverting with @xmath138 , @xmath139 , @xmath140 , and @xmath141 , though in this case the last parameter has a non trivially time dependence , @xmath142 .",
    "lacking stationarity , every analytical information on the pdf is lost , yet we can see from figures  [ fig : etdep_scaling_panela ] and  [ fig : etdep_scaling_panelb ] how the numerical pdf evolves with time and we verify a striking matching between mc and fca results .",
    "remarks similar to previous case apply .",
    "we now turn our attention to piecewise linear diffusion .",
    "the procedure is in this case a little bit subtle .",
    "while computation of the lamperti transform of process   for @xmath143 and integral time @xmath144 is still feasible providing  . ]",
    "@xmath145 the stochastic differential @xmath146 can not be computed applying it lemma straightforwardly . as a function of @xmath18 and @xmath22 , @xmath147 lacks necessary regularity condition for @xmath148 and @xmath149 .",
    "however , both difficulties can be overcome .",
    "the @xmath18 process does not suffer any problem in @xmath148 , therefore we can evolve from @xmath150 to @xmath151 , and then exploit the one to one correspondence between @xmath18 and @xmath147 . moving from @xmath148 to @xmath152 , @xmath151 remains delta distributed around zero , and the same holds true for @xmath153 .",
    "for @xmath154 the time derivative @xmath155 needed in @xmath146 can be readily computed .",
    "the difficulty arising with the computation of @xmath156 in zero can be dealt by replacing the absolute value with the smooth approximation @xmath157 this allows us to compute @xmath158 where in view of our application on a discrete grid the last approximation can be justified for sufficiently large @xmath159 .",
    "[ fig : piecewise ]    we thus end with the following expression for the dynamics of @xmath160 @xmath161{\\mathrm{d}}\\tau + { \\mathrm{d}}w_\\tau\\ , .\\ ] ] numerical results concerning this last process are reported in figure  [ fig : piecewise_panela ] ( linear scale ) and in figure  [ fig : piecewise_panelb ] ( log - linear scale ) .",
    "we study the dependence of @xmath162 on @xmath163 .",
    "indeed for @xmath164 , @xmath165}$ ] , and the value of the coefficient in the exponential function is crucial to asses the convergence of the expectation of @xmath166 with respect to @xmath167 .",
    "we fix @xmath131 , @xmath168 , and @xmath169 .",
    "the leptokurtosis of the pdf increases as far as the value of @xmath170 increases .",
    "parameters for the euler scheme approximation are fixed as in previous examples , while for the fca we have slightly changed the value of @xmath171 and @xmath172 keeping @xmath127 .",
    "for each one of the three cases we also plot the analytical prediction , since for piecewise linear processes the solution is known in closed form .",
    "also in this last case the agreement between analytical and fast convolution pdf is totally satisfactory , while limitations of the mc approach are evident from symbols depicted in panel  ( b ) .",
    "in the second part of this work we present and discuss how results achieved in previous sessions can be exploited in finance , and in particular in the context of option pricing .",
    "for both quadratic and piecewise diffusion",
    "we briefly review how to set the correct risk neutral framework .",
    "then , for explanatory purposes , we apply fca to price european plain vanilla and geometric asian options , but the approach can be extended to deal with different payoffs and different kind of boundary conditions . for the remaining of this paper ,",
    "@xmath173 is the logarithmic return obtained from the stochastic process @xmath174 describing the evolution of an asset price . as asset candidates we only consider equities and foreign exchange rates .      according to risk neutral valuation theory we need to find the dynamics of @xmath174 or , equivalently , @xmath13 under the probability measure which makes all discounted asset prices martingales",
    "whenever the novikov condition for the process under consideration is verified , girsanov theorem gives the recipe for the equivalent measure , and it also explains how the dynamics of @xmath174 coherently modifies .",
    "however ,  @xcite show how to compute the desired martingale directly from the green function solving the fp equation associated to the dynamics @xmath175 with @xmath176 . just in the case of the original model of  @xcite",
    ", a delta hedged strategy allows to construct a locally risk neutral portfolio and to derive the partial differential equation @xmath177 that is to be use to solve the pricing problem of a plain vanilla option @xmath178 , with @xmath179 risk free interest rate and for suitable boundary conditions . introducing @xmath180 and substituting in equation",
    ", it is readily verified that the hat price satisfies an equation formally identical to the backward time fp equation associated with the dynamics   with @xmath181 .",
    "the fair price of a call option is therefore predicted to be @xmath182\\ , , \\ ] ] where @xmath183 is the green function solving the fp equation in the risk neutral framework , and @xmath184 is the strike price .",
    "the dynamics of @xmath13 under the new probability measure reads @xmath185{\\mathrm{d}}t+\\sigma",
    "\\sqrt{1+\\epsilon\\frac{{\\left\\lvert x_t \\right\\rvert}}{\\sqrt{t}}}{\\mathrm{d}}w_t^\\mathbb{q}\\ , ,      \\quad x_{t_0}=0\\ , .\\ ] ] at variance with equation  , a non trivial drift term appears and some comments are mandatory . as recognized by mccauley and collaborators , whenever the drift depends explicitly on @xmath13 there is no way to preserve scaling properties .",
    "however , in order to exploit the analytical information provided by equation  , corresponding to the green function @xmath186 for the process  , they provide arguable arguments in order to replace the drift with a constant .",
    "we are instead equipped with a computationally efficient algorithm , and so we can get rid of this approximation and price options directly with the process  . as in section",
    "[ sec : mnoise ] , we switch to integral time @xmath187 and compute the call option price as @xmath188      = s_0^d\\mathbb{e}^\\mathbb{q}\\left[({\\mathrm{e}}^{x(z_{\\tau(t)})}-{\\mathrm{e}}^\\mathrm{k})^+\\rvert z_0\\right]\\nonumber\\\\      & = s_0^d\\int_{-\\infty}^{+\\infty}{\\mathrm{d}}z_{\\tau(t ) }      \\left[{\\mathrm{e}}^{\\mathrm{sign}(z_{\\tau(t)})\\frac{1}{\\epsilon}\\left[\\left(\\frac{\\sigma\\epsilon}{2}{\\left\\lvert z_{\\tau(t ) } \\right\\rvert}+\\sqrt{\\frac{\\tau(t)}{2}}\\right)^2      -\\frac{\\tau(t)}{2}\\right]}-{\\mathrm{e}}^\\mathrm{k}\\right]^+p^\\mathbb{q}(z_{\\tau(t)}\\rvert z_0)\\nonumber\\\\      & \\simeq s_0^d\\delta z\\sum_{j=0}^{m-1}\\left[{\\mathrm{e}}^{\\mathrm{sign}(z_\\mathrm{min}+j\\delta z)\\frac{1}{\\epsilon }      \\left[\\left(\\frac{\\sigma\\epsilon}{2}{\\left\\lvert z_\\mathrm{min}+j\\delta z \\right\\rvert}+\\sqrt{\\frac{n\\delta\\tau}{2}}\\right)^2      -\\frac{n\\delta\\tau}{2}\\right]}-{\\mathrm{e}}^\\mathrm{k}\\right]^+{\\mathrm{p}_j^n}^\\mathbb{q}\\label{eq : callprice}\\ , , \\end{aligned}\\ ] ] with @xmath189 , discounted price @xmath190 and log - moneyness @xmath191 .",
    "the vector @xmath192 of transition probability between @xmath193 and @xmath194 under the risk neutral measure @xmath195 has to be computed with the fast convolution procedure described in section  [ subsec : fca ] .",
    "formula   can be extended to deal with payoffs with different dependence on @xmath196 , e.g. digital options , covered call or strongly non linear function @xmath197 , the only constraint being @xmath198<\\infty$ ] .",
    "the case of a functional payoff depending multiplicatively on the price along the path , i.e. @xmath199)=\\prod_{i=0}^{n}f_i(s^i)$ ] , is just slightly more complicated but in fact can be easily managed , see  @xcite for an application to bond pricing . in this section",
    "we address the problem of pricing a geometric asian option , which requires to compute the expected value @xmath200\\ , .\\ ] ] being the positive part function non linear , previous expression is quite tricky to be evaluated and requires some careful manipulations . defining @xmath201 , the asian price is given by @xmath202\\ , .\\ ] ] we exploit the discretization of the @xmath203 time interval in @xmath122 equally spaced intervals of amplitude @xmath204 , and we replace the integral expression with a finite sum @xmath205 .",
    "we then introduce the ancillary variables @xmath206 satisfying the following recursive relation @xmath207 for @xmath208 and @xmath209 . exploiting the one to one correspondence between @xmath18 and @xmath147 , it is possible to rewrite the asian price as @xmath210 with @xmath211 .",
    "the only unknown quantity in previous expression is the joint distribution of @xmath212 and @xmath213 , whose computation requires a recursive relation allowing to propagate @xmath214 to @xmath215 with the associated initial time condition @xmath216 .",
    "the following equation holds @xmath217 and to proceed it is useful to explicit the dependence of @xmath218 on @xmath219 in equation  ( [ eq : u ] ) @xmath220\\\\          z^{i+1}=z^{i+1}\\ , ,      \\end{array }      \\right.\\label{eq : uzsystem}\\ ] ] where @xmath221 is coupled with the dummy variable @xmath219 . from previous relations we have @xmath222 where the jacobian is equal to @xmath223 . therefore starting from the distribution @xmath224 , and following the above procedure ,",
    "after @xmath225 steps we obtain the desired @xmath226 . introducing @xmath227-node grid for @xmath228 and @xmath229-node grid for @xmath230 , we can approximate the distribution @xmath231 with a @xmath232 matrix @xmath233 , the row index @xmath234 running over the nodes of @xmath230 , the column index @xmath159 over those of @xmath228 .",
    "the asian price can therefore be approximated by @xmath235 since the time evolution corresponding to equation   is the most computationally intensive operation implicit in previous approximation , we can perform it at each node @xmath236 by means of fca .",
    "the overall numerical complexity of the algorithm is essentially linear in the total number of grid nodes , i.e @xmath237 .",
    "the geometric asian case just described is useful also in view of the last application we present , which is related to the model for the stock price dynamics introduced in  @xcite .",
    "borland model tries to generalize the standard black&scholes to account for the empirical evidences of fat tailed return distributions , still keeping a closed form formula for the price of plain vanilla instruments .",
    "it is a sort of hybrid between a stochastic volatility model and the standard black&scholes : the volatility is stochastic , but the stock price and the volatility itself are driven by the same brownian motion . despite its theoretical elegance , the model contains some weaknesses extensively analyzed in  @xcite .",
    "they raised two main objections by proving the borland model to suffer arbitrage opportunities and diverging payoff expectation , as a consequence of the thickness of the tails .",
    "however , they preserved the main idea of the model and they amended it from both drawbacks . in their modified version",
    "they introduce the following dynamics @xmath238 with @xmath239 with @xmath240^{-\\frac{2}{2-\\alpha}}$ ] , @xmath241 , @xmath242 , @xmath243 and @xmath244 . in  @xcite the existence of a solution for equation",
    "is proved , and it is shown how the unconditional distribution ( i.e. @xmath245 for @xmath246 ) reduces to the generalized student-@xmath3 distribution .",
    "in general the conditional distribution deviates from it . the log - return @xmath13 satisfies the equation @xmath247 for @xmath248 .",
    "they verify that sufficient conditions hold for the applicability of the girsanov theorem , and they derive the risk neutral dynamics @xmath249 this last process does not suffer anymore of previous problems , however @xmath174 does not satisfy the markov property , yet only jointly with @xmath250 .",
    "in addition , the price of plain vanilla instruments can not be given in closed form formula .",
    "indeed , according to pricing theory we have @xmath251\\ , , \\ ] ] and the expectation can only be computed via numerical techniques . + given  , we observe that the equation governing the evolution of @xmath252 belongs to the class of quadratic diffusion processes   through the identifications @xmath253 , @xmath254 $ ] , @xmath255^{\\frac{\\alpha}{2-\\alpha}}t^{2/(2-\\alpha)}$ ] , and @xmath256 .",
    "switching to the integral time @xmath257 for @xmath258 , and recalling equation  , @xmath147 is readily computed @xmath259\\ , , \\ ] ] where @xmath260 .",
    "the price of a plain vanilla instrument can be computed as @xmath261      -\\frac{(2-\\alpha)\\sigma^2}{4}\\left[e(t)-e(t_0)\\right]-\\frac{c\\sigma^2}{2}\\int_{0}^{\\tau(t)}\\omega(z_{\\tau'})^2{\\mathrm{d}}\\tau ' }      -{\\mathrm{e}}^\\mathrm{k}\\right)^+\\big\\rvert s_0 , z_0\\right]\\,\\ ] ] with @xmath262 . defining the set of ancillary variables @xmath206 satisfing the recursive relation @xmath263 with @xmath264 , the formal analogy with the asian case discussed in previous section is evident .",
    "computation of the expectation in   requires estimation of the joint probability @xmath265 .",
    "the procedure is identical to the asian case ; equation   is still valid , while the system   has to be coherently modified in @xmath266\\\\          z^{i+1}=z^{i+1}\\ , .",
    "\\end{array }      \\right.\\ ] ] the jacobian in equation   simplifies to one , and , eventually , we can approximate the plain vanilla price as @xmath267 where @xmath268-\\frac{\\alpha\\sigma^2}{2(1-\\alpha)(2-\\alpha)}u_j^n}-{\\mathrm{e}}^\\mathrm{k}\\right)^+$ ] , and compute it by means of fast convolution .",
    "[ fig : rn_piecewise ]    [ fig : rn_asian ]    in this final section we sum up numerical results for the financial applications described in paragraphs [ subsec : riskneutral ] , [ subsec : asian ] , and [ subsec : vnb_model ] .",
    "+ whenever we switch to the risk neutral measure for the piecewise linear process , corrections terms in the sde appear and an analytical expression for the density is not available anymore .",
    "numerical simulation is mandatory , and the fca algorithm , being both faster and much more efficient , is a natural competitor to mc approach .",
    "the transformed @xmath147 process is enriched by the risk neutral correction ( the last but one term in squared brackets ) @xmath269{\\mathrm{d}}\\tau + { \\mathrm{d}}w_\\tau\\ , , \\nonumber\\end{aligned}\\ ] ] where @xmath179 is the risk free rate . in figures  [ fig : rn_piecewise_lin ] and  [ fig : rn_piecewise_log ] we draw risk neutral pdfs for @xmath270 and remaining parameters as in figures  [ fig : piecewise_panela ] and  [ fig : piecewise_panelb ] .",
    "the effect of the additional terms is evident from their comparison . in particular , it is remarkable the increase of the skewness induced by the risk neutral correction from linear plots in panel  ( a ) .",
    "turning our attention to the pricing of asian options , figure  [ fig:2dplot_asian ] plots the joint density @xmath271 , and associated marginals for @xmath246 , @xmath131 , @xmath168 , and @xmath272",
    ". parameters of the fast convolution are @xmath127 , @xmath273 , @xmath274 , @xmath275 , and @xmath130 .",
    "in figure  [ fig : rn - asian_log ] we compare the marginal pdf of @xmath147 , and analogously to paragraph [ subsec : nr - mnoise ] the agreement between fca and mc is striking in the central region .",
    "as far as the pricing under vellekoop - nieuwenhuis - borland model is concerned , we start plotting in figure  [ fig:2dplot ] the joint bivariate density @xmath276 for parameter values @xmath277 , @xmath273 , @xmath278 , @xmath275 , @xmath130 , @xmath279 , @xmath280 , @xmath281 , and @xmath282 .",
    "we notice that fast convolution algorithm correctly predicts a non negative support for the @xmath283 variable , even though the numerical grid spans uniformly the interval @xmath284 $ ] . in figure",
    "[ fig : zomega_marginal ] we compare the distribution of @xmath147 obtained by means of fca and mc , finding perfect matching , and we also plot @xmath285 pdf , easily derived given the relationship between the two variables , see equation  ( [ eq : zfunctomega ] ) . in light of the agreement between the two numerical procedures , we can use the fca approach to efficiently price european call options , as explained in paragraph  [ subsec : vnb_model ] . in this respect in figures  [ fig : imp_vola_1_0 ] , [ fig : imp_vola_1_5 ] , [ fig : imp_vola_4_0 ] , and [ fig : imp_vola_4_5 ] we present our results in terms of implied black - scholes volatilities .",
    "our choices of the parameters are @xmath286 , @xmath270 , @xmath287 , @xmath281 , @xmath288 , @xmath289 , @xmath290 $ ] , and @xmath291 $ ] .",
    "mc bands at @xmath292 confidence level are plotted as dashed lines for the shortest time to maturity , @xmath293 with @xmath294 .",
    "fca and mc volatility curves are fully consistent . as expected surfaces exhibit a volatility smile , more pronounced for small maturities and for @xmath295 values deviating from zero .",
    "as already pointed out by vellekoop and niueuwenhuis , a wider variety of volatility surfaces and flexibility of the model can be obtained by playing with different values of @xmath296 .",
    "[ fig : rn_vn ]    [ fig : imp_vola_alpha1 ]    [ fig : imp_vola_alpha4 ]",
    "in this paper we have addressed the problem of investigating performances of the fast convolution algorithm introduced by  @xcite .",
    "choosing different specifications of the stochastic process , this has been carried out both with the reconstruction of conditional probability densities at different time horizons and with the computation of prices of financial derivatives .",
    "fca is an efficient grid algorithm relying on restating functional integrals as sequences of ordinary finite dimensional integrals , and on converting the stochastic process to a unitary diffusion one by means of the lamperti transform . a bright formulation of the problem , then , allows those integrals to be evaluated efficiently by the use of fast fourier transform techniques .",
    "the stochastic processes we have investigated belongs to two classes of multiplicative noise processes : the family of quadratic diffusion , see  @xcite , and piecewise linear diffusions , see  @xcite .",
    "the analysis performed in this work provides a natural complement to the analytical results obtained in  @xcite , where closed form solutions for the stationary pdf and for the convergent moments at arbitrary time had been obtained .",
    "we have detailed a step by step numerical procedure able to provide an accurate estimate for the probability distribution of the process even far from the stationary regime .",
    "similar results have been found for the piecewise diffusion . in this latter case , if the dynamics is enriched with a non trivial drift term , scaling properties are not preserved anymore and every analytical information is lost .",
    "being this exactly the situation we faced when switching to the risk neutral setting , fca proved to be a very efficient and reliable approach to the problem of option pricing . a detailed empirical analysis for different specifications of the parameter values documents the superiority of the fca approach to standard monte carlo simulations .",
    "we have also demonstrated the flexibility of the approach when dealing with exotic instruments , and exploited the formal analogy between geometric asian option pricing and plain vanilla pricing under vellekoop - nieuwenhuis - borland dynamics .",
    "being an interesting hybrid between a geometric brownian motion and a stochastic volatility model , the latter provides a realistic description of the dynamics implied in the option market .",
    "fca is able to numerically reproduce a rich variety of implied volatility surfaces improving the standard monte carlo approach .",
    "since , as documented , fca turns out to be highly successful also in the case of the vellekoop - nieuwenhuis - borland model , a natural perspective is to concentrate future research efforts on the extension of fca to higher dimensional stochastic systems .",
    "this is precisely the case of continuous time stochastic volatility models , see  @xcite .",
    "these models provide a flexible framework when modeling volatility , and they allow to reproduce several observed statistical regularities . for this reason",
    "they are nowadays extensively exploited by quantitative sectors of banks and financial institutions . given the ability of the fast convolution to reconstruct densities over tail regions , and of the investigated models to generate leptokurtic and scaling distributions , the present approach is naturally suited for application in the context of financial risk management , e.g. value - at - risk and coherent risk measures computation , see  @xcite .",
    "the authors acknowledge the support of the scuola normale superiore grant ` giovani ricercatori ( 2011/2012 ) ' .",
    "37 alejandro - quiones , a. l. , bassler , k. e. , field , m. , mccauley , j. l. , nicol , m. , timofeyev , i. , trk , a. and gunaratne , g. h. , a theory of fluctuations in stock prices . _",
    "physica a _ , 2006 , * 363 * , 383392 .",
    "baaqui , b. e. , _ quantum finance : path integrals and hamiltonians for options and interest rates _ , 2007 ( cambridge : cambridge univeristy press ) .",
    "bir , t. s. , and jakovc , a. , power - law tails from multiplicative noise .",
    "lett . _ , 2005 , * 94 * , 132302 - 14 .",
    "black , f. , and scholes , m. , the pricing of options and corporate liabilities . _ j. political econ . _ , 1973 , * 8 * , 637654 . bollerslev , t. , generalized autoregressive conditional heteroskedasticity .",
    "_ j. econometrics _ , 1986 , * 31 * , 307327",
    "borland , l. , option pricing formulas based on a non - gaussian stock price model .",
    "_ , 2002a , * 89 * , 098701 - 01 .",
    "borland , l. , a theory of non - gaussian option pricing .",
    ", 2002b , * 2 * , 415431 .",
    "borland , l. , bouchaud , j. p. , muzy , j. f. and zumbach , g. , the dynamics of financial markets : mandelbrot s multifractal cascades , and beyond .",
    "_ wilmott magazine _ , march 2005 .",
    "bormetti , g. , cazzola , v. , livan , g. , montagna , g. and nicrosini , o. , a generalized fourier transform approach to risk measures .",
    "_ j. stat .",
    "mech . _ , 2010 , p01005 .",
    "bormetti , g. , cisana , e. , montagna , g. and nicrosini , o. , a non - gaussian approach to risk measures .",
    "_ physica a _ , 2007 , * 376 * , 532542 .",
    "bormetti , g. , and delpini , d. , exact moment scaling from multiplicative noise .",
    "e _ , 2010 , * 81 * , 032102 - 14 .",
    "bormetti , g. , montagna , g. , moreni , n. and nicrosini , o. , pricing exotic options in a path integral approach .",
    "finance _ , 2006 ,",
    "* 6 * , 5566 .",
    "bouchaud , j. , p. and potters , m. , _ theory of financial risk and derivative pricing : from statistical physics to risk management _ , 2003 ( cambridge : cambridge university press ) .",
    "brandimarte p. , _ numerical methods in finance and economics _",
    ", 2006 ( hoboken : john wiley & sons ) .",
    "campbell , j. , lo , a. h. and mckinlay , c. , _ the econometrics of financial markets _ , 1997 ( princeton : princeton university press ) .",
    "chiarella , c. , and el - hassan , n. , evaluation of derivative security prices in the heath - jarrow - morton framework as path integrals using fast fourier transform techniques .",
    "_ j. finan .",
    "engineering _ , 1997 ,",
    "* 6 * , 121147 .",
    "cont , r. , empirical properties of asset returns : stylized facts and statistical issues .",
    ", 2001 , * 1 * , 223236 .",
    "dash , j. , path integrals and options , parts i , ii .",
    "1989 , centre nationale de la recherche scientifique .",
    "delpini , d. , and bormetti , g. , minimal model of financial stylized facts .",
    "e _ , 2011 , * 83 * , 041111 - 14 .",
    "eydeland , a. , a fast algorithm for computing integrals in function spaces : financial applications .",
    "_ computational econ . _ , 1994 , * 7 * , 277285 .",
    "engle , r. f. , autoregressive conditional heteroskedasticity with estimates of the variance of united kingdom inflation .",
    "_ econometrica _ , 1982 , * 50 * , 9871007 .",
    "fama , e. f. , the behavior of stock market prices .",
    "_ , 1965 , * 84 * , 34105 .",
    "friedrich , r. , peinke , j. and renner , c. , how to quantify deterministic and random influences on the statistics of the foreign exchange market .",
    "_ , 2000 , * 84 * , 52245227 .",
    "fouque , j. p. , papanicolaou , g. and sircar , k. r. , _ derivatives in financial markets with stochastic volatility _ , 2000",
    "( cambridge : cambridge university press ) .",
    "ghashgaie , s. , breymann , w. , peinke , j. , talkner , p. and dodge , y. , turbulent cascades in foreign exchange markets .",
    "_ nature _ , 1996 , * 381 * , 767770 .",
    "iacus , s. m. , _ simulation and inference for stochastic differential equations _ , 2008 ( new york :",
    "springer ) .",
    "jorion , p. , _ value at risk : the new benchmark for managing financial risk _ , 2007 ( new york : mcgraw - hill ) .",
    "mandelbrot , b. , the variation of certain speculative prices . _ j. bus . _ , 1963 , * 36 * , 394419 .",
    "mandelbrot , b. , _ fractals and scaling in finance : discontinuity , concentration and risk _ , 1997 ( new york : springer ) .",
    "mantegna , r. n. and stanley , h. e. , _ an introduction to econophysics : correlations and complexity in finance _",
    ", 2004 ( cambridge : cambridge university press ) .",
    "mccauley , j. l. , _ dynamics of markets : econophysics and finance _ , 2004 ( cambridge : cambridge university press ) .",
    "mccauley , j. l. and gunaratne , g. h. , an empirical model of volatility of returns and option pricing . _",
    "physica a _ , 2003 , * 329 * , 178198 .",
    "mccauley , j. l. , gunaratne , g. h. and bassler , k. e. , hurst exponents , markov processes , and fractional brownian motion .",
    "_ physica a _ , 2007a , * 379 * , 19 .",
    "mccauley , j. l. , gunaratne , g. h. and bassler , k. e. , martingale option pricing .",
    "_ physica a _",
    ", 2007b , * 380 * , 351356 .",
    "merton , r. , theory of rational option pricing .",
    "_ bell j. econ .",
    "_ , 1973 , * 4 * , 141183 .",
    "mcneil , a. j. , frey , r. and embrechts , p. , _ quantitative risk management : concepts , techniques and tools _ , 2005",
    "( princeton : princeton university press ) .",
    "montagna , g. , nicrosini , o. and moreni , n. , a path integral way to option pricing .",
    "_ physica a _ , 2002 , * 310 * , 450466 .",
    "vellekoop , m. h. and nieuwenhuis , j. w. , on option pricing models in the presence of heavy tails .",
    ", 2007 * 7 * , 563573 ."
  ],
  "abstract_text": [
    "<S> in this work we detail the application of a fast convolution algorithm computing high dimensional integrals to the context of multiplicative noise stochastic processes . </S>",
    "<S> the algorithm provides a numerical solution to the problem of characterizing conditional probability density functions at arbitrary time , and we applied it successfully to quadratic and piecewise linear diffusion processes . the ability in reproducing statistical features of financial return time series , such as thickness of the tails and scaling properties , makes this processes appealing for option pricing . since exact analytical results are missing , we exploit the fast convolution as a numerical method alternative to the monte carlo simulation both in objective and risk neutral settings . in numerical sections </S>",
    "<S> we document how fast convolution outperforms monte carlo both in velocity and efficiency terms .    </S>",
    "<S> @xmath0  _ scuola normale superiore , piazza dei cavalieri 7 pisa i-56126 , italy _ + @xmath1  _ infn , sezione di pavia , via bassi 6 pavia i-27100 , italy _ </S>",
    "<S> + @xmath2  _ swiss finance institute at the university of lugano , via buffi 13 lugano , switzerland _    </S>",
    "<S> * jel codes : * c63 , g13 .    </S>",
    "<S> * keywords : * computational finance , stochastic processes , non - gaussian option pricing , numerical methods for option pricing . </S>"
  ]
}