{
  "article_text": [
    "many striking features of physical , biological or social processes can be portrayed as patterns or clusters of localized events .",
    "these can be flips of magnetic domains in a ferromagnet leading to barkhausen noise  @xcite , traffic jams  @xcite , booms and busts of markets and economies  @xcite , forest fires  @xcite , the spread of infections  @xcite and global pandemics , extinctions of species  @xcite , neural spikes  @xcite , solar flares  @xcite , or earthquakes @xcite  to name a few . a generic attribute in all these cases",
    "is that one event can trigger or somehow induce another one to occur  or possibly numerous further events .",
    "sometimes , as in the prototype sandpile model  @xcite , an accounting of causes and their effects leads to an interpretation in terms of avalanches - where causal connections between clustered events ( `` topplings '' ) are explicitly rationalized by the microscopic state and rules of the dynamical system . more often than not , though , the network of causal connections can not be resolved from the data at hand and remains ambiguous .",
    "thus , one is often confronted with inferring a plausible causal structure from clusters of localized events without a detailed or `` fundamental '' knowledge of the true microscopic dynamics .",
    "this remains a stubbornly impenetrable problem despite some progress in special cases ( see e.g. ref .",
    "@xcite and references therein ) .",
    "we aim to establish a general procedure of plausible inference based on sequences of data in space and time , or more generally for any temporal sequence of data .",
    "the essential idea for the method of analysis discussed here is that of a _ recurrence_.",
    "our definition of recurrences is a generalization of `` returns '' for a point process to higher dimensional data structures that evolve in time .",
    "loosely spoken , a recurrence involves a pair of events which are sufficiently close to each other to suggest a causal connection .      for illustration",
    "consider the two events : @xmath0 first , alice drops a banana , and ( @xmath1 ) then bob falls down .",
    "if @xmath2 and @xmath1 are sufficiently close in space and time then one can reasonably infer that it is likely that bob slipped on the banana and fell down ( `` @xmath2 caused @xmath1 '' ) , but should these events be sufficiently separated then @xmath2 is less likely to have contributed to @xmath1 s occurrence .",
    "for instance , bob could have been distracted by the banana , or fell for another reason related to @xmath2 without actually slipping directly on the banana  so the two events may still be connected without @xmath2 being exclusively the cause of @xmath1 .",
    "this secondary effect is also less likely if sufficient time has past between the two events .",
    "eventually alice or another party may pick up the banana or bob s fall may have happened so far away that it would be unlikely for him to have slipped on it .",
    "as this example shows , it is not always clear what we should mean by sufficiently close to infer a causal connection .",
    "one option might be to call a localized event @xmath1 a recurrence of an earlier event @xmath2 , if its spatial distance is less than some chosen length @xmath3 @xcite .",
    "in addition to introducing a length scale , this choice fails to admit that the plausibility of causal connections typically becomes weaker with time  as the example above makes plain .",
    "in addition , the likelihood that the later event ( @xmath1 ) may be triggered by a third intervening event increases with time as well .",
    "these considerations might suggest that @xmath3 should shrink with time . on the other hand ,",
    "the fact that influences usually spread either diffusively or with finite speed could suggest the opposite - that @xmath3 increases with time .",
    "spreading of influence is hypothesized , for instance , in theories of `` aftershock zone diffusion ''  ( see ref .",
    "@xcite and references therein ) .",
    "other , more complicated scenarios are also conceivable .    this discussion is meant to clarify that without sufficiently accurate _",
    "a priori _ knowledge of the underlying microscopic dynamics any definition of closeness based on predefined scales is arbitrary and might significantly alter the inferred causal structure . to avoid this problem , or",
    "more generally to minimize the influence of the observer , we take the view that , to begin with , a suitable definition of closeness ought to be purely contextual , and depend only on the actual history of events . taking this as our starting point  that we know the observed history of events but do not know the underlying dynamics  we propose a contextual method to establish recurrences that uses zero knowledge of the underlying physical processes . as a result ,",
    "our definition is generic and can apply to a wide variety of situations .",
    "this approach serves as a starting point to analyze data for systems where the underlying dynamics is obscure , mysterious or even misconceived .",
    "it comprises a fundamental extension of the concept of recurrences for a point process to recurrent events in space and time that allows the inference of causal relations from available or possible observations .      in the approach described here ,",
    "the inferred relationship between each pair of events is based on the closeness of the pair relative to all the other events that have occurred in the data set .",
    "an event @xmath1 is designated to be a recurrence of a previous one @xmath2 if it is closer to @xmath2  compared to any other event occurring in the time interval between @xmath2 and @xmath1 . by this construction ,",
    "each recurrence is a new `` record '' in the sequence of distances that subsequent events have from @xmath2 . in other words ,",
    "each recurrence is a _",
    "record breaking event _  @xcite .",
    "this method of inferring relationships between pairs of events is naturally expressed as a network of connected events where each event is a node in the graph , and each recurrent pair is linked with a time directed edge .",
    "significant deviations in the statistics of the resulting network from that for a random process ( which lacks any causal relations between events ) highlights relevant parts of the causal dynamical process(es ) generating the patterns . in principle",
    ", the events themselves do not have to take place in real physical space , but can occur in any space as long as it is equipped with a metric that defines distances . as a starting point , here we only discuss spatiotemporal point processes and take as our test bed a well - characterized , extensive and comparatively accurate catalog  @xcite of earthquake epicenters for southern california .      section ii explains our method for constructing networks of recurrent events and the relation to record breaking statistics . in section iii , the null hypothesis of independent , random events is introduced and a number of analytic results are obtained for it .",
    "we extend the mathematical theory of record breaking statistics to the case where both space ( or the variable which fluctuates and in which records take place ) and time ( or the ordering of events ) are treated on the same footing . treating both space and time as continuous",
    "symmetrizes the theory  making it more concise .",
    "these results allow us to discover statistical features in the actual network of recurrences that are unlikely in acausal random processes and , hence , plausibly due to causal structures in the underlying dynamics .",
    "section iv describes the application to seismicity .",
    "the network analysis reveals new statistical features of seismicity  with robust scaling laws that are invariant over a range of different time scales .",
    "this apparent invariance with respect to the time span is diametrically opposed to the behavior for a random process , where all statistical distributions depend explicitly on the time span over which events are recorded . the rupture length and its scaling with magnitude ( while being invariant with respect to the time span of the history ) emerges from the data analysis without being predefined by the measurement process .",
    "it is a generic measure for distance between recurrent events .",
    "these results indicate that our method is , indeed , tending to identify causally related events rather than acausal pairs .",
    "further , the relative separations for subsequent recurrences in space ( or time ) form a hierarchy with unexpected properties . all of these properties disappear when a history constructed by `` shuffling '' the original earthquake catalog is analyzed using the same method . in that case",
    ", almost all results agree with predictions of the acausal null model . on the basis of these results",
    ", we argue that the particular features where we observe strong deviations between the actual history and the acausal null model can be attributed to causal structures in the dynamics of seismicity .",
    "we end with a summary and outlook for future works and applications .",
    "consider a series of events @xmath4 , with @xmath5 , that are ordered in time such that event @xmath4 precedes event @xmath6 if @xmath7 .",
    "the events @xmath4 are in the following identified with their spatiotemporal position .",
    "we assume that a metric is defined in space , and we denote by @xmath8 the spatial distance between events @xmath4 and @xmath6 .",
    "simple examples are spatiotemporal point processes taking place in 3-dimensional euclidean space or on the surface of a sphere .",
    "the only property of the metric relevant to this discussion is that ( spatial ) distances between all pairs of events can be ordered , e.g. from smallest to largest , and the ordering relation is transitive .",
    "the same is of course true for time distances .",
    "the network of recurrent events is defined as follows ( see fig .  [ cascade ] ) : all events @xmath4 are represented as nodes and two nodes @xmath9 and @xmath10 with @xmath7 are connected by a directed link or edge @xmath11 if event @xmath6 is a recurrence of @xmath4 .",
    "this occurs if and only if @xmath12 for all @xmath13 with @xmath14 .",
    "thus a recurrence is a new record with respect to distance .",
    "note that @xmath11 and @xmath15 can not both exist since the directionality of links is determined by the time ordering . hence ,",
    "if @xmath7 only @xmath11 can exist .",
    "to summarize : the definition of recurrence implies that , for all @xmath16 , event @xmath17 is automatically a recurrence of event @xmath18 and , thus , all links @xmath19 exist .",
    "event @xmath17 is also a recurrence of any previous event @xmath4 if it is closer to @xmath4 than every other event @xmath20 that occurred in between the two , i.e. , for all @xmath20 with @xmath14 .",
    "eight events in 2d space labelled according to their order of occurrence in time . the network of recurrences is indicated by arrows as described in the text . ]",
    "as long as only one event occurs at a time , the directed network consists of a single cluster in which each node is linked to at least one other node .",
    "each node @xmath9 has an in - degree @xmath21 , which is the number of links pointing to it from events in its past , as well as an out - degree @xmath22 , which is the number of links emanating from @xmath9  corresponding to the number of records of event @xmath9 .",
    "the collection of in - nodes @xmath23 are hypothesized to reflect the potential cause(s ) of event @xmath4 while the set of out - nodes @xmath24 are hypothesized to contain the effect(s ) of @xmath4 .",
    "although it is natural to contemplate associating a weight factor to each link , this requires further assumptions .",
    "here we do not deal with this issue and consider all links to have the same weight .",
    "this is in our view a `` zeroth order '' assignment of causes and their effects based purely on the history of events and their relationships to each other in space and time .",
    "note that a single event can have many causes corresponding to all of its incoming links , so the network aspect of causal relations is not lost in this limit .",
    "weighted networks of seismic events were constructed using a different methodology in refs .",
    "@xcite .",
    "while this network construction , based on record breaking events , is directly applicable to fixed collections of events , it can also be applied when the number of events @xmath25 increases over time .",
    "the result of adding a new event @xmath26 is to increase the number of links by at least one , namely @xmath27 , without altering any pre - existing links .",
    "hence , the property of being a recurrence is _ preserved _ in all cases under addition of new nodes in time .",
    "also the collections of in - nodes for all pre - existing nodes remains unchanged .",
    "yet , the out - degree of any node @xmath9 with @xmath28 can increase by one , namely if @xmath26 is a recurrence of @xmath4 .",
    "so the networks are , in this sense , dynamically stable growing networks  @xcite .",
    "some tools and measures already exist to quantify statistical topological features of networks , and to reveal the organization of the dynamical process(es ) giving rise to the events in terms of network statistics @xcite .",
    "the dependence of the network statistics can be examined by varying the time span of the history synthesized into a network , space window over which the history is observed , and/or selection criteria for what is defined as an event ( in the seismic application discussed later , this could e.g. be the range of earthquake magnitudes ) .",
    "our approach opens up a new view of dynamical organization of spatiotemporal activity in terms of the ( static ) topology of complex networks  as was also discussed in  @xcite .",
    "we also believe it possible that new developments in network theory may turn out to be even more powerful in analyzing dynamical systems . for the work described here , standard methods of network analysis are already sufficient to plausibly infer certain causal relations in seismic behavior solely from the catalog of earthquake magnitudes , epicenter locations and times .",
    "in order to be able to associate causal characteristics of the dynamics to the network of recurrences , we mathematically establish statistical properties of a null model , where the events in space and time are random , uncorrelated and causally unrelated .",
    "then any statistically significant deviation of the observed network from this null hypothesis can be attributed to correlations among events and to causal structure in the underlying dynamics giving rise to the observed history .",
    "the conclusions about the relation to causality are robust as long as the relevant properties of any acausal null model are well represented by those we study .    in the following",
    "we shall discuss several variants of the null model . in all of them , both space and time are continuous . to the best of our knowledge , the theory of records has up to now been developed only for discrete time and continuous space @xcite . as we shall see , when both variables are continuous the core of the theory becomes symmetric under exchange of space and time , allowing for a more concise formulation .",
    "this symmetry is obviously lost when making one of the variables discrete .",
    "let us denote by @xmath29 the joint probability density for having events at locations @xmath30 , @xmath31 .",
    "our basic assumptions are that :    \\(a ) events are independent and identically distributed ( iid ) , @xmath32    \\(b ) the single - event distributions factorize , @xmath33 in particular , when @xmath34 , eq .",
    "( [ factorize ] ) means that we have a stationary system .",
    "note that @xmath35 , the total average number of events in the history , as long as this number is finite .    instead of event distributions themselves",
    ", we shall in the following use the distributions of space - time distances relative to some reference event or `` event-0 '' at @xmath36 , @xmath37 \\times\\\\   & & \\rho_n({\\bf x}_0,t_0 ; { \\bf y}_1,t_0+t_1 ; \\ldots { \\bf y}_n , t_0+t_n ) .",
    "\\nonumber\\end{aligned}\\ ] ] it is easily seen that these joint distributions also factorize under the above assumptions as , @xmath38 with @xmath39 the functions @xmath40 and @xmath41 might in general depend on the reference point , @xmath42 .",
    "we will not indicate this dependence explicitly , unless it is relevant for the calculation .",
    "first , we consider the special case @xmath43 , which holds if the system is stationary , 1-dimensional , homogeneous , and has the suitable space - time density of events .",
    "the next step is when either one of these functions or both are equal to one up to finite cut - offs and zero beyond , i.e. @xmath44 and/or @xmath45 .",
    "physically , @xmath46 is not only the maximal possible distance between two events ( due to finiteness of space ) , but it is also the rate at which events occur per unit time , if @xmath47 .",
    "similarly , a finite value of @xmath48 indicates not only that events are observed in a finite time window , but also that the average number of events per unit distance is finite .",
    "fortunately , it is sufficient to discuss these simple cases , because for any non - singular densities @xmath40 and @xmath41 the problem can be reduced to one of them by a change of coordinates .",
    "consider the two transformations @xmath49 clearly , @xmath50 is a positive and monotonically increasing function of @xmath3 , while @xmath51 is a positive and monotonically increasing function of @xmath52 . due to conservation of probability ,",
    "both have unit density @xmath53 where we have denoted by @xmath46 and @xmath48 the integrals over @xmath54 and @xmath55 , respectively , @xmath56 thus , the distributions of events in @xmath50 and @xmath51 are cut - off sharply at @xmath46 and @xmath48 , respectively .",
    "note that @xmath46 and @xmath48 can be infinite .",
    "thus , for general space and time distributions , we can first do all calculations in the `` canonical coordinates '' @xmath50 and @xmath51 , and then translate the results , using inverse transformations of eq .",
    "( [ standard ] ) , back to the original coordinates @xmath57 .",
    "examples are given below . in the following",
    "we always assume that @xmath50 and @xmath51 are defined by eq .",
    "( [ standard ] ) and , thus , eq .  ( [ equ : density ] ) holds for all positive @xmath50 and @xmath51 .     a typical chain of recurrences in canonical coordinates .",
    "the reference event or event-0 for all these recurrences is at the origin @xmath58 .",
    "the event at @xmath59 is a recurrence of the event at ( 0,0 ) if and only if no event is in the shaded region . ]    in canonical coordinates , a typical sequence of recurrences is drawn schematically in fig .",
    "[ recurrence - chain ] .",
    "for all recurrences @xmath9 , @xmath60 and @xmath61 .",
    "this is symmetric under the exchange @xmath62 , and @xmath63 .",
    "the probability that a given event @xmath64 is a recurrence of event-0 at ( 0,0 ) is equal to the chance that no event occurred in the rectangular region @xmath65\\times [ 0,\\xi]$ ] , which is equal to @xmath66 due to the unit space - time density of events in the @xmath64-plane .",
    "hence , the joint probability density function ( pdf ) of _ recurrences _ is given by the same exponential , @xmath67 except for the possible cut - offs at @xmath46 and/or @xmath48 , beyond which the density of recurrences is zero ; @xmath68 .      for a detailed discussion of the spatial and temporal distributions of recurrences we deal separately with the cases of finite and infinite @xmath46 and/or @xmath48 .",
    "we first consider the case where neither @xmath40 nor @xmath41 is normalizable , i.e. @xmath69 .",
    "this , for example , describes the case of stationary and homogeneous systems in infinite @xmath70-dimensional euclidean space , where @xmath71 and @xmath72 .",
    "but it holds also approximately for fractal distributions in space ( if we neglect effects of lacunarity @xcite ) , with @xmath70 being the fractal dimension . notice that @xmath73 for all values of @xmath70 .",
    "the spatial and temporal density distributions of recurrences in canonical coordinates are obtained by integrating eq .",
    "( [ 2d - recur ] ) to obtain the marginals , @xmath74 assuming that the system is translationally invariant in time and fractal in space , i.e. @xmath75 and @xmath76 , we obtain for the densities in the original coordinates @xmath77^{-1 } = 1/t\\;. \\label{pt}\\end{aligned}\\ ] ]    thus the recurrence density in time is independent of the event rate ( per unit space - time region ) .",
    "similarly , for an event distribution with given ( fractal or euclidean ) non - trivial dimension , the recurrence density depends on the dimension but not on the parameter @xmath78 .",
    "also , notice that @xmath79 is completely independent of the spatial event distribution @xmath40 , and @xmath80 is independent of @xmath41 .",
    "for homogeneous and mono - fractal stationary spatial distributions both @xmath81 and @xmath82 are independent of the reference point defining the recurrences .",
    "this is no longer true for multifractals , where @xmath80 depends on the local ( point - wise ) dimension at the event which defines the recurrences .",
    "the analog of eq .",
    "( [ pt ] ) for discrete time is a classic result in the theory of records @xcite .",
    "in contrast , eq .  ( [ pl ] )",
    "was first reported in @xcite , as far as we know .",
    "let us assume that @xmath41 is not normalizable but @xmath40 is , @xmath83    now , of course , @xmath84 for @xmath85 . for @xmath86 ,",
    "on the other hand , @xmath87 is still given by integrating @xmath66 over all positive values of @xmath51 as in eq .",
    "( [ pxi ] ) , i.e. @xmath88 in terms of the original coordinates , one finds @xmath89    in contrast , @xmath90 is obtained by integrating eq .",
    "( [ 2d - recur ] ) over the finite domain @xmath91 , which gives @xmath92 in the stationary case , when @xmath52 is just proportional to @xmath51 , the density of recurrences in @xmath52 is given by the same formula with @xmath46 replaced by the rate of events per unit @xmath52 . the additional term compared with eqs .",
    "( [ ptau ] ) and ( [ pt ] ) reflects the probability that no recurrence occurs up to time @xmath51 and @xmath52 , respectively .    in the opposite case @xmath93 ,",
    "@xmath94 of finite event rate per unit distance and infinite rate per unit time ( corresponding typically to infinite space and finite time , with finite space time density of events ) , the situation is completely symmetric . in that case",
    "@xmath90 is cut - off sharply at a finite value , while @xmath87 is cut - off with an exponential correction term as in eq .",
    "( [ p_t ] ) .",
    "now both @xmath87 and @xmath90 are obtained by integrating eq .",
    "( [ 2d - recur ] ) over finite domains , @xmath95    thus , @xmath87 asymptotically approaches the constant @xmath48 in the limit @xmath96 while for intermediate arguments we recover the @xmath97 decay for infinite space and time domains given in eq .",
    "( [ pxi ] ) . for large arguments ,",
    "the density sharply drops to zero at @xmath98 .",
    "@xmath90 asymptotically approaches the constant @xmath46 in the limit @xmath99 while for intermediate arguments we recover the @xmath100 decay for infinite space and time domains given in eq .",
    "( [ ptau ] ) . for large arguments ,",
    "the density sharply drops to zero at @xmath101 .",
    "the respective transition points @xmath102 and @xmath103 between the constant behavior for small arguments and the decaying behavior for intermediate arguments can be defined in the standard way by requiring that the argument of the exponential equals @xmath104 , i.e. , @xmath105    specific realizations of such a process include stationary systems observed over a finite time window , where events occur only in a finite region of space  or are only recorded when they fall into that region .",
    "one example is @xmath106 and @xmath107 with positive constants @xmath108 and @xmath109 . in this case , eq .",
    "( [ pll ] ) translates into @xmath110 and eq .",
    "( [ ptt ] ) translates into @xmath111 with @xmath112 and @xmath113^{-1}\\;.\\label{t - cutoff - d}\\ ] ] finally , let @xmath114 be the average total number of observed events . then the expressions for the transition points are particularly simple @xmath115    in this simple example and in the situations discussed in subsection [ sec : fiinfi ] , we have assumed that translational invariance holds . however , this is generally not true .",
    "specific realizations of such processes include stationary systems observed over a _ fixed _",
    "finite time window , where events occur only in a _ fixed",
    "_ finite region of space  or are only recorded when they fall into that region . due to the lack of translational invariance , the distributions of distances ( spatial and temporal ) between events depend on the defining event .",
    "we discuss the consequences of broken translational invariance now .    for concreteness and simplicity ,",
    "let us assume a stationary system where events occur uniformly on an interval @xmath116 with periodic boundary conditions , with space - time density @xmath117 .",
    "they are recorded only in the time window @xmath118 . in general , the distributions of distances between events in a bounded space - time region depend on the reference point @xmath119 , but in the present case this simplifies due to the periodic boundary condition : the recurrence distributions depend on @xmath120 , but not on @xmath121 .",
    "more precisely , @xmath122 for positive arguments @xmath52 and @xmath3 , respectively . note that the asymmetrical attribution of the factor @xmath117 to @xmath54 is arbitrary .",
    "this _ ansatz _ gives @xmath123 and @xmath124 .",
    "the relations between original and canonical coordinates are @xmath125 @xmath126    the recurrence pdfs are obtained by inserting this into eqs .",
    "( [ pll],[ptt ] ) and transforming back to the original coordinates .",
    "the _ average _ distributions of distances between recurrences and reference points are obtained by averaging over @xmath120 .",
    "the final results are @xmath127 \\theta(l/2-l ) , \\label{l - periodic}\\\\   \\langle p_t(t)\\rangle_{t_0 } & = & { 1\\over t } ( 1-e^{-\\alpha lt } ) ( 1-{t\\over t } )   \\theta(t - t ) , \\label{t - periodic}\\end{aligned}\\ ] ]    these detailed results are included in order to demonstrate that exact calculations are possible in the most simple case .",
    "but in more realistic cases no exact results can be expected . as a general rule , the simple power laws of eqs .",
    "( [ pl],[pt ] ) will hold for intermediate values of @xmath3 and @xmath52 , but corrections will be necessary both for large and for small @xmath3 and @xmath52  as follows from eqs .",
    "( [ pll],[ptt ] ) .",
    "the corrections render the distributions finite at small values of the arguments , and they cut them off at large ones .",
    "the cut - offs at large @xmath3 and @xmath52 occur just at the sizes of the system .",
    "their detailed shapes depend , as suggested by comparing eqs .",
    "( [ l - periodic],[t - periodic ] ) with eqs .",
    "( [ model_p_l],[model_p_t ] ) , on the specific properties of the system at large scales .",
    "the behavior at small distances is more general .    to see this ,",
    "let us consider eq .",
    "( [ t - periodic ] ) in more detail . there",
    "the deviation from the infinite system limit happens when @xmath128 , i.e. at a time @xmath129 which exactly coincides with eq .",
    "( [ t - cutoff - d ] ) for the translational invariant case . since @xmath117 is the density of events in space - time",
    ", @xmath130 is the average time delay between successive events .",
    "obviously , _ recurrences _ can not follow each other faster than _",
    "events_. similarly in eq .",
    "( [ l - periodic ] ) , the deviation from the infinite system limit happens when @xmath131 , which coincides with the expression for @xmath132 in the translational invariant case given by eq .",
    "( [ l - cutoff - d ] ) .    not only is the scaling of @xmath133 and @xmath130 identical to the translationally invariant case but also the qualitative behaviors of @xmath134 and of @xmath135 for @xmath136 and @xmath137 , respectively ,",
    "are identical .",
    "this strongly suggests that the results given in eqs .",
    "( [ model_p_l],[model_p_t],[l - cutoff - d],[t - cutoff - d ] ) capture the essential behavior for scales smaller than the large scale cut - off  even when translational invariance is explicitly broken .",
    "let @xmath138 be the pdf that two events at space - time positions @xmath139 and @xmath140 are both records  not necessarily subsequent ones . referring to fig .",
    "[ recurrence - chain ] , and using bayes theorem in canonical coordinates , we are interested in the probability that no other event occurs in either of the two rectangles associated to the events , which is determined by the union of the two rectangular areas .",
    "hence if @xmath141 and @xmath142 , then @xmath143 this directly determines @xmath138 .",
    "integrating over @xmath50 and @xmath144 gives the joint pdf for having recurrences at times @xmath51 and @xmath145 , @xmath146\\theta(\\sigma   - \\tau)\\;.\\end{aligned}\\ ] ] for @xmath147 , this gives @xmath148 , for @xmath149 so the two recurrences are uncorrelated .",
    "for finite @xmath46 , records are correlated ; i.e. @xmath150 . for a stationary process , these results hold in the original coordinate @xmath52 as well .",
    "alternatively , let @xmath151 be the probability that two events at @xmath139 and @xmath140 are _ successive _ records .",
    "assuming again that @xmath141 and @xmath142 , we now demand that both are records , as above , and also that no other _ event _ happens in the rectangle @xmath152\\times[\\tau',\\tau]$ ] , or @xmath153 integrating over @xmath50 and @xmath144 gives the joint pdf for having successive records at times @xmath51 and @xmath145 to be @xmath154 \\mbox { for } \\tau ' < \\tau < \\sigma \\;. \\nonumber\\end{aligned}\\ ] ] hence , times to successive recurrences are always correlated . when @xmath147 , the joint pdf is @xmath155 for @xmath149 .",
    "for the pdf of the ratio of the times of successive records @xmath156 , it directly follows for finite @xmath46 that @xmath157 which is constant in the interval @xmath158 $ ] .",
    "this is also the result in the original coordinates , if the system is stationary  in which case @xmath159 and @xmath160 .",
    "we now discuss spatial distance distributions of recurrences with fixed rank @xmath9 , and first consider a finite stationary system infinitely extended in time @xmath161 .",
    "let @xmath162 be the spatial distance pdf for the @xmath9-th recurrence following event-0 .",
    "for any @xmath163 , the recursion relation @xmath164 exists .",
    "the quantity @xmath165 is the conditional pdf , given that the previous recurrence happened at distance @xmath144 , for the distance of the next recurrence .",
    "one easily shows that @xmath166 independently of @xmath9 , so that @xmath167 the solution for finite @xmath46 is @xmath168 if the event density in original coordinates was @xmath169 , i.e. , confined to a disc with radius @xmath109 , then the last equation translates into @xmath170 while eq .",
    "( [ null_ratio_canon ] ) gives for the pdf of the ratio @xmath171 @xmath172    these last results have to be modified when @xmath173 , i.e. when there is a finite observation window in time . in that case",
    "we are not guaranteed that at least @xmath9 recurrences exist , and thus @xmath174 has to be replaced by the conditional pdf , conditioned on the existence of @xmath175 recurrences .",
    "that requires a more extensive development than we take up here .",
    "the out - degree distribution @xmath176 is the probability that a randomly chosen event out of a sequence of @xmath25 events has @xmath13 records .",
    "this probability can be deduced using previous results from the theory of records  @xcite .",
    "we assume that the system is stationary , with a finite rate of events per unit time .",
    "we denote the event defining recurrences as event-0 .",
    "we use the fact that recurrences are records in the sense that each recurrence is an event that is closer to event-0 than all previous events that happened after event-0 . consider a series of @xmath9 events following event-0 . the probability",
    "that event @xmath10 is a record is @xmath177 and the probability that it is not is @xmath178 .",
    "hence the probability that there is precisely one record in a series of @xmath9 events following event-0 is @xmath179 .",
    "notice that the first event after event-0 is always a record .",
    "the probability that there are precisely two records in the series of @xmath9 events is @xmath180 continuing with standard methods it is possible to show that the probability of finding precisely @xmath13 records in a series of @xmath9 events , @xmath181 , is given by @xmath182 where the symbol @xmath183 indicates stirling s number of the first kind and the last expression holds for @xmath184 . considering that each event except the last one in the sequence of @xmath25 events initiates its own sequence of records , and hence is an event-0 , gives @xmath185 where the last step involves approximating the sum as an integral , which is valid for large @xmath25 .",
    "therefore , the out - degree distribution for a random process of @xmath186 events is a poisson distribution with mean degree @xmath187  @xcite .",
    "furthermore , the probability to have out - degree one , @xmath188 , can be computed exactly  @xcite : for those nodes the closest event in space is also the closest in time . for event",
    "@xmath9 , this happens with probability @xmath189 .",
    "thus , @xmath190 where we have approximated the harmonic series by the corresponding integral and @xmath191 is the euler - mascheroni constant .",
    "note that eq .",
    "( [ p_out_1 ] ) is exact in the limit @xmath192 .",
    "for the in - degree distribution , @xmath193 , similar considerations apply : event @xmath9 is a recurrence of event @xmath10 ( @xmath194 ) with probability @xmath195 , which is independent of @xmath25 .",
    "this allows to compute the in - degree distribution @xmath196 of event @xmath9 : @xmath197 for @xmath198 and zero otherwise .",
    "hence @xmath199 as expected for a fully random process , @xmath193 is identical to @xmath176 and well - approximated by a poisson distribution with mean degree @xmath200 for @xmath201 .      due to the acausal nature of the null model , the joint probability @xmath202",
    "that event @xmath9 has in - degree @xmath203 and out - degree @xmath204 factors for all nodes @xmath9 .",
    "as a result @xmath205 this allows us to compute the mean out - degree of all events with a given in - degree in a sequence of @xmath25 events    @xmath206    the out - degree @xmath207 weakly depends on @xmath203 due to the fact that the rank of each event implicitly couples its in- and out - degree in a finite sequence of events .",
    "for instance , if the rank of an event is small ( large ) compared to @xmath25 , the in - degree is more likely to be small , but the out - degree is more likely to be large",
    ". consequently , @xmath208 decreases with @xmath203 for fixed @xmath25 . for similar reasons",
    ", weak correlations also appear between the in-/out - degree of a node and the in-/out - degree of its recurrences .",
    "for example , a large ( small ) in - degree for a node implies on average a small ( large ) out - degree for its recurrences .",
    "similarly , the out - degree ( in - degree ) of recurrences increases on average with the out - degree ( in - degree ) of their event-0 .",
    "seismicity is a prime example where localized events in space and time can be accurately and , with certain caveats , exhaustively recorded .",
    "it is also a phenomenon where the causal features of the dynamics responsible for the patterns are subject to ongoing debate and uncertainty .",
    "seismic data involving many earthquakes occurring over large regions of space and time exhibit a number of regularities .",
    "these include clustering , fault traces and epicenter locations with fractal statistics , as well as scaling laws like the omori and gutenberg - richter ( gr ) laws ( see e.g. refs .",
    "@xcite for a review ) . given that the associated earthquake patterns in space and time are readily observable , approaches based on the concept of spatiotemporal point processes have been amply demonstrated to be feasible @xcite .",
    "in that case , the description of seismicity is reduced to recording the size or magnitude of each earthquake , its epicenter and its time of occurrence .",
    "( color online ) spatial pattern of seismicity in southern california  @xcite , as described in the text . ]    to test the suitability of our method to characterize seismicity in a way that makes it possible to infer relevant causal features of its dynamics and to extend our earlier analysis @xcite , we study a `` relocated '' earthquake catalog from southern california @xcite . the catalog has improved relative location accuracy within clusters of similar events , the estimated horizontal standard errors being typically less than 50 to 100 m and the estimated vertical standard errors being typically less than 100 to 200 m @xcite . due to the higher relative and absolute location errors for the depth of an earthquake , we only consider epicenters in the following .",
    "the catalog is assumed to be homogeneous from january 1984 to december 2002 and complete for events with magnitude larger than @xmath209 located within the rectangle @xmath210 @xcite .",
    "restricting ourselves to magnitudes larger than @xmath211 gives @xmath212 events ( see fig .",
    "[ map ] ) . in order to test for robustness and the dependence on magnitude",
    ", we analyze this sub - catalog and subsets of it , obtained in two different ways : by ( a ) selecting different threshold magnitudes , namely @xmath213 giving @xmath214 and @xmath215 events , respectively , or ( b ) using a shorter period from january 1984 to december 1987 giving @xmath216 events for magnitude threshold @xmath217 .",
    "( color online ) map showing a 2.9 earthquake ( black ) and its recurrences as defined by our method .",
    "the size of the symbols linearly scales with the magnitude of the event and its color corresponds to the time of occurrence ( from darker colors to lighter colors ) .",
    "see table  [ table_hector ] for more details . ]",
    "it is important to note that all events in the catalog are treated in the same way .",
    "in particular , we do not distinguish between foreshocks , mainshocks and aftershocks .",
    "hence , our definition of a recurrence ",
    "an event is a recurrence of any previous event if it is closer to it in space than all the intervening events  is _ a priori _ independent of those classifications .",
    "note also that our definition of a recurrence is wholly unrelated to the notion of `` characteristic earthquakes '' on a single fault as introduced , for example , in refs .",
    "@xcite .",
    "[ hectormine ] shows the recurrences with magnitude @xmath218 defined by our method for one randomly chosen event in the catalog , an earthquake of magnitude 2.9 that occurred on january 10 , 1999 . the actual spatial and temporal distance between this event and each of its recurrences",
    "is listed in table  [ table_hector ] .",
    "it has to be noted that the number of recurrences of a given earthquake or event-0 is generally not related to its magnitude .",
    "the number of recurrences of the largest earthquakes like the landers event or the hector mine event are just above the average ( see section  [ sec : network ] ) .",
    "thus , most recurrences are associated to event-0s with small magnitude  which are much more abundant according to the gutenberg - richter law .",
    ".[table_hector]list of recurrences of the 2.9 earthquake given in fig .",
    "[ hectormine ] as defined by our method for threshold magnitude @xmath219 . [ cols=\">,^,>,>\",options=\"header \" , ]      fig .",
    "[ fig : l ] shows the estimated pdf @xmath220 of recurrences at a spatial distance @xmath3 in the sub - catalog with threshold magnitude @xmath221 . the pdfs exhibit a peak at a typical distance , @xmath222 , which increases with magnitude . for sufficiently large @xmath3 ,",
    "all distributions show a power law decay with an exponent @xmath223 up to a cutoff .",
    "this cutoff corresponds to the size of the region in southern california that we consider , and hence is a finite size effect . for small distances",
    "@xmath224 , we observe an approximately linear increase .",
    "( color online ) distribution of distances @xmath3 of recurrent events for sets with different magnitude thresholds @xmath221 . the distribution for @xmath219 up to 1988",
    "is also shown and is almost indistinguishable from the data for the full catalog with @xmath219  showing the invariance of the distribution with respect to the time span of the recorded events .",
    "filled symbols correspond to distances below 100  m and are unreliable due to location errors .",
    "the inset shows a data collapse , obtained by rescaling distances and distributions according to eq .",
    "( [ equ : p(l ) ] ) ( excluding unreliable points ) .",
    "the full straight line has slope 2.05 ; the vertical dashed line indicates the pre - factor @xmath225 in the scaling law for the characteristic distance , @xmath226 .",
    "note that @xmath227 . ]    with a suitable scaling ansatz , the different curves in fig .",
    "[ fig : l ] fall onto a universal curve , except at the finite size cutoff .",
    "the inset in fig .",
    "[ fig : l ] shows results of a data collapse using @xmath228 the scaling function @xmath229 has two regimes , a power - law increase with exponent @xmath230 for small arguments and a constant regime at large arguments .",
    "the transition point between the two regimes can be estimated by extrapolating them and selecting the intersection point , giving @xmath231 km .",
    "for the characteristic distance that appears in @xmath229 we find @xmath232      although @xmath220 has the same overall shape as the distribution @xmath233 of the finite null model ( see eq .",
    "( [ model_p_l ] ) ) , there are fundamental differences with respect to the dependence on the time span over which events are recorded . for the earthquake data , @xmath220 and in particular @xmath222 do not depend on the time span at all but rather depend directly on @xmath221 .",
    "this conclusion comes from the explicit comparison of two different observation periods in fig .",
    "[ fig : l ] with the same @xmath221 . with the exception of the smallest values of @xmath3",
    ", @xmath234 is largely unaltered if only the sub - catalog up to 1988 is analyzed and @xmath133 does not change at all .",
    "it is important to note that the total number of events in the latter sub - catalog is roughly 5 times smaller .    in the null model",
    "@xmath133 depends explicitly on the finite time span of the observation period , @xmath108 , as shown in eq .",
    "( [ l - cutoff - d ] ) . in the real data",
    "though , the spatiotemporal ordering of earthquakes determines the value of @xmath133 , regardless of the duration of the observation period  as long as it is large enough to obtain sufficient statistics to determine @xmath222 and small enough that seismic correlations do not disappear over that time span .",
    "this is confirmed by analyses of other sub - catalogs ( not shown ) . on this basis , we conclude that the characteristic length must therefore reflect robust physical properties of the underlying dynamics over the given observation periods . its ( quasi)-invariance is not a property of the null model . therefore , it reflects causal structure in the dynamics of seismicity . as a result ,",
    "if one re - arranges the seismic catalog by `` shuffling '' the locations and magnitudes of events ( see section [ sec : shuffling ] ) , then the invariance of @xmath133 is lost and the distribution of recurrences behaves the same as the null model for spatial dimension @xmath235 ( see eqs .",
    "( [ model_p_l],[l - cutoff - d ] ) ) . to sum up :",
    "the invariance of @xmath222 is an indicator of causality and is thereby a physically meaningful length scale in the dynamics of seismicity over the time scales we can explore with statistical methods  minutes to decades .",
    "the almost complete lack of dependence of @xmath220 ( excluding very small values of @xmath3 ) on the considered time span can be explained by at least two scenarios : 1 ) recurrences with @xmath236 are greatly _ suppressed _ at large time scales ; 2 ) recurrences with @xmath237 are greatly _ enhanced _ at short time scales compared to the null model with _ constant _ rate . as we will discuss below",
    ", it is likely that both effects are present .",
    "physically , such a behavior is reasonable if we identify @xmath133 with the rupture length of the earthquake that starts a chain of recurrences .",
    "as described by omori s law @xcite , the rate of seismic activity tends to increase directly after an earthquake nearby ( close to the rupture area of the event ) .",
    "moreover , there is some evidence that due to the stress relief within the rupture area itself , it tends to exhibit less seismic activity for awhile  see , for example , ref .",
    "this supports the hypothesis that activity increases for @xmath238 at shorter times , but gets suppressed for @xmath236 over longer times .",
    "this identification is also affirmed by the fact that the scaling of @xmath222 with @xmath221 is close to the estimated behavior of the rupture length @xmath239 km given in ref .",
    "@xcite and remarkably close to @xmath240 km given in ref .",
    "@xcite , where @xmath241 is the magnitude of the earthquake and @xmath242 its rupture area .",
    "the close agreement between the latter and eq .",
    "( [ l _ * ] ) suggests that the characteristic length scale of distances for recurrent events is indeed the rupture length of events with @xmath243 , defined in terms of the rupture area @xmath244 .",
    "thus , our approach allows us to discover the rupture length as a causal consequence of the dynamics based purely on the spatiotemporal organization of seismicity without any additional knowledge of the microscopic dynamics and the actual rupture processes that occur  even , in fact , treating the seismic events as point - like in space and time !",
    "the identification @xmath245 is also consistent with the fact that the description of earthquakes as a point process breaks down below the rupture length .",
    "then , the relevant distance(s ) between earthquakes is not determined solely by their epicenter positions but also by the relative orientation and size of the extended ruptures in 3d space .",
    "thus , we expect to find a different correlation structure for distances smaller than the rupture length .",
    "in fact , this is precisely what our data show , namely a linear increase at small distances , @xmath236 ( see the main part of fig .  [",
    "fig : l ] and also the straight line with a slope of 2.05 in the inset of fig .",
    "[ fig : l ] ) .",
    "the lengths @xmath133 observed for the values of @xmath221 we consider are larger than the location errors ( @xmath246 m ) .",
    "simulations show that @xmath247 ( blue triangles in fig .",
    "[ fig : l ] ) does not change substantially if the epicenters in the catalog are randomly relocated by a small distance up to one kilometer . yet , the maximum for @xmath234 shifts to larger @xmath3 with this procedure , destroying the scaling of @xmath222 . since the smallest @xmath133 that obeys the data collapse is @xmath248 m , the data collapse we observe for the original data verifies that the relative location errors are indeed less than @xmath249 m , or of that order @xcite .",
    "furthermore , the absence of any anomaly due to location errors near @xmath249 m in fig .",
    "[ fig : l ] indicates that recurrences within the rupture area lack correlations .",
    "this is also supported by eq .",
    "( [ model_p_l ] ) which predicts the observed behavior @xmath250 for @xmath251 if events are happening uniformly and randomly in 2d space during a finite observation period , or are recorded as happening randomly in space due to location errors .      to further examine the behavior of @xmath220",
    ", we study separately the contributions of recurrences with definite rank . the rank @xmath9 is defined as in sec .",
    "iii f , i.e. , for a given event-0 , recurrence @xmath252 directly follows recurrence @xmath9 as shown in fig .",
    "[ recurrence - chain ] .",
    "since @xmath220 is the pdf that _ any _ recurrence occurs at distance @xmath3 for a catalog with threshold magnitude @xmath221 , we have for any finite number of events @xmath25 , @xmath253 where @xmath254 is the probability that a randomly chosen recurrence is an @xmath9th recurrence , @xmath255 is the number of events in the sequence that have at least @xmath9 recurrences ( or out - going links ) , and @xmath256 is the conditional pdf that , given that a recurrence is an @xmath9th recurrence , it happens at distance @xmath3 .",
    "( color online ) distribution of distances @xmath3 of the _ first _",
    "recurrence for different magnitude thresholds @xmath221 .",
    "filled symbols correspond to distances below 100  m and are unreliable due to location errors .",
    "note that @xmath257 .",
    "inset : data collapse obtained by rescaling distances and distributions according to eq .",
    "( [ l_1 ] ) ( excluding unreliable points ) . ]    in the inset of fig .",
    "[ rank1 ] , the data are analyzed according to the _ ansatz _ that the distribution of first recurrences , @xmath258 , has the scaling form @xmath259 with @xmath260 and @xmath261 similar to @xmath229 ( see eq .",
    "( [ equ : p(l ) ] ) and the inset of fig .",
    "[ fig : l ] for comparison ) .",
    "in particular , the same characteristic distance @xmath222 appears as for @xmath220 .",
    "moreover , we find that the latter is true for all @xmath256  which is further evidence supporting the interpretation of @xmath133 as the rupture length .",
    "the behavior of @xmath258 indicated in fig .",
    "[ rank1 ] and described by eq .",
    "( [ l_1 ] ) extends earlier results for a catalog from southern california with lower spatial resolution ( @xmath262 km ) which did not allow to resolve the dependence on @xmath221 @xcite .",
    "related to the distribution of distances for recurrent events is the distribution of distance ratios @xmath263 of consecutive recurrences . here",
    "again recurrences are ordered such that recurrence @xmath252 directly follows recurrence @xmath9 . for @xmath264 , we take @xmath265 km , which is the largest possible distance in the region covered by the catalog . by construction",
    "these ratios are always between zero and one .",
    "we denote by @xmath266 the pdf that @xmath267 for each event that has an @xmath268 recurrence . as indicated in fig .",
    "[ rank_ratio_l ] , the data for @xmath219 and @xmath264 ( black circles ) scale over a wide region as @xmath269 with @xmath260 .",
    "this is expected since @xmath270 .",
    "although each distribution @xmath271 is different , the curves for @xmath272 also show ( more restricted ) power law decay comparable to @xmath273 .",
    "for @xmath274 they also exhibit a peak that becomes more pronounced with increasing @xmath9 .",
    "this is due to recurrences occurring at almost the same distance ( but not at the same place ! ) suggesting again that recurrences are suppressed within the rupture area , but are enhanced just outside that area .",
    "( color online ) distribution of recurrence distance ratios @xmath275 for @xmath219 and different values of @xmath9 with @xmath265 km .",
    "the straight line corresponds to a decay with exponent 0.6 .",
    "note that @xmath276 . ]",
    "the observed behavior of @xmath271 and @xmath258 is very different from the behavior predicted by the null model . for the null model , in the long time limit , eq .",
    "( [ null_ratio ] ) gives @xmath277 which is not only independent of @xmath9 but also purely determined by the spatial dimension @xmath70  and is increasing for @xmath278 rather than decreasing .",
    "similarly , eq",
    ".  ( [ pi ] ) gives @xmath279 for the null model . for southern california",
    ", it has been found that @xmath280 @xcite , which would lead to an increasing function @xmath281 rather than a decaying power law behavior .",
    "although the above predictions of the null model are only strictly true in the infinite time limit , we point out that repeating this analysis of the hierarchy of recurrences for a `` shuffled '' catalog reveals behavior in close agreement with the null model and diametrically opposed to the results shown in fig .",
    "[ rank_ratio_l ] for the actual seismic record @xcite .",
    "thus , the observed behavior of @xmath271 and @xmath258 as well as the value of @xmath282 are _ not _ determined by the spatial distribution of seismicity alone but reflect causal structures leading to the complex _ spatiotemporal _ organization of seismicity . moreover , the shape of @xmath258 shows that the first recurrence is much more likely to happen at a typical distance of @xmath133 than predicted by the null model .",
    "this enhancement goes along with a suppression of recurrences with @xmath283 as the increasing ( with @xmath9 ) peak at @xmath284 for @xmath266 indicates .",
    "these results support the overall picture that recurrences with @xmath236 are greatly _ suppressed _ at large time scales while recurrences with @xmath238 are greatly _ enhanced _ at short time scales .",
    "( color online ) in- and out - degree histograms for different values of @xmath221 . for a given earthquake ,",
    "the in - degree ( out - degree ) @xmath13 is the number of links directed at it ( originating from it ) as defined in section  [ sec : synth ] .",
    "open ( red ) symbols correspond to the in - degree , filled ( black ) symbols correspond to the out - degree .",
    "error bars can be estimated as @xmath285 .",
    "the red lines correspond to poisson distributions with the same respective mean and normalization . ]",
    "we now turn to the analysis of seismicity in terms of the statistical properties of its network of recurrences ( or records ) as defined in section  [ sec : synth ] and illustrated in fig .",
    "[ cascade ] .",
    "[ in_out ] shows the in- and out - degree histograms for different values of @xmath221 , which are compared to poisson distributions with the same respective mean degree and normalization ( @xmath286 for @xmath287 , respectively ) .",
    "a poisson out - degree and in - degree distribution is expected for the null model ( see eq .",
    "( [ model_out ] ) and eq .",
    "( [ in ] ) ) . for the actual seismic network ,",
    "the out - degree distributions are significantly different from a poissonian @xcite .",
    "in particular , the network keeps a preponderance of nodes with small out - degree as well as an excess of nodes with large out - degree compared to a poisson distribution .",
    "this effect becomes more pronounced with increasing magnitude .",
    "the behavior of the out - degree distribution implies that the network topology is able to discern consequences of the causal structure of seismicity : the preponderance of nodes with small out - degree , for example , can be related to the physical picture discussed above that seismic activity is typically greatly enhanced directly after the occurrence of an earthquake close to its rupture area but suppressed within the rupture area itself .",
    "such a dynamics makes it more likely that only very few recurrences occur , even at long times . for the in - degree distributions",
    ", we find that they roughly agree with a poisson distribution although there are still significant deviations from the null model for @xmath288 @xcite .    note , however , that @xmath289  which is obviously the same for the in- and out - degrees  decreases with @xmath221 , simply because the number of events @xmath25 shrinks with @xmath221 .",
    "this is shown in fig .",
    "[ mean_k ] where @xmath289 is also displayed for a randomly shuffled catalog .",
    "shuffling was performed in the following way : consider all events in the catalog with magnitude @xmath290 .",
    "shuffle the magnitudes and the epicenter locations separately , keeping the times of occurrence , and then apply the recurrence analysis for the different subsets defined by different magnitude thresholds as before .",
    "the shuffled catalog can , thus , be considered as a realization of a random process with no spatiotemporal correlations , although both spatial correlations and temporal correlations may persist separately .",
    "based on the null model and eq .",
    "( [ model_out ] ) , we expect a poisson out - degree distribution with @xmath291 which is exactly what we find for the randomly shuffled catalog .",
    "this dependence of @xmath289 can be clearly seen in fig .",
    "[ mean_k ] . yet , for the original earthquake data we find for large @xmath25 @xmath292 hence , the average number of recurrences is significantly less than for the null model , which is presumably related to the suppression of recurrences with @xmath224  as discussed earlier .",
    "[ mean_k ] gives further evidence that recurrences emphasize particular aspects of spatiotemporal clustering , associated with the causal dynamics of seismicity .",
    "( color online ) mean degree @xmath289 as a function of number of events @xmath25 ( or magnitude @xmath221 ) .",
    "open symbols correspond to the original catalog for different values of @xmath221 , while filled symbols correspond to the shuffled catalog ( see text ) .",
    "the lines correspond to best fits giving @xmath293 and @xmath294 . ]",
    "the causal structure of seismicity does not , however , induce strong degree - degree correlations between events and their recurrences other than those arising from the temporal order of a finite sequence of events  as in the acausal null model .",
    "panels a to c in fig .",
    "[ fig : dd ] show the average out - degree and in - degree of recurrences as a function of the in - degree or out - degree of their corresponding event-0 @xcite .",
    "there are no qualitative differences between the actual earthquake catalog from california and a surrogate , which is a randomly shuffled version of the catalog .",
    "in particular , the behavior shown in panel a and b agrees with the acausal null model ( see discussion following eq .",
    "( [ model_out_in ] ) ) .",
    "note that the offset between the two data sets is simply due to different @xmath289 .",
    "the situation is different for the dependence of the mean out - degree on the in - degree of the _ same node_. as shown in eq .",
    "( [ model_out_in ] ) , @xmath207 has a weak dependence on @xmath203 in the null model such that @xmath295 decreases with @xmath203 .",
    "this is exactly what we find for the shuffled catalog as shown in panel d of fig .",
    "[ fig : dd ] .",
    "however , the same panel also shows that for the actual earthquake catalog @xmath207 increases with @xmath203  exactly the opposite of the null model .",
    "moreover , @xmath296 implies @xmath297 on average .",
    "this is again consistent with a causal dynamics where earthquakes are clustered in space and time .",
    "( color online ) panels a  c : degree correlations between the event-0 and its recurrences .",
    "the average in - degree @xmath298 or out - degree @xmath299 of the recurrences of all nodes with a given in - degree @xmath203 or out - degree @xmath204 for @xmath219 is shown .",
    "open ( black ) circles correspond to the original earthquake catalog from california , filled ( blue ) diamonds correspond to the shuffled catalog .",
    "the mean degree is indicated by the ( red ) solid line and the ( orange ) dashed line , respectively .",
    "panel d shows the average out - degree of a node as a function of its in - degree .",
    "open ( green ) circles correspond to the original earthquake catalog from california , filled ( blue ) diamonds correspond to the shuffled catalog .",
    "the black dash - dotted line is the approximation for the null model given in eq .",
    "( [ model_out_in ] ) . in this panel ,",
    "the behavior of the original earthquake data is qualitatively very different from the null model and the shuffled catalog . ]",
    "other network properties include various measures of clustering . in general terms , clustering quantifies how well connected the neighbors of a node are among themselves . in the case of recurrences",
    ", it refers to the likelihood that recurrences of the same event are also recurrences of each other .",
    "there are different , inequivalent definitions of the clustering coefficient @xmath300  @xcite . here",
    "we focus on the definition based on the local clustering coefficient @xmath301 adapted to directed networks .    for all nodes @xmath9 with out - degree larger than one , the clustering coefficient @xmath301 is given by the ratio of existing links @xmath302 between its @xmath22 recurrences to a possible number of such links , @xmath303 .",
    "then the clustering coefficient @xmath300 of the network is defined as the average over all nodes @xmath9 with out - degree larger than one @xmath304 this definition implies , for example , that the clustering coefficient of an erds - renyi graph is equal to the the probability of linking each pair of nodes , @xmath305 .    for the data from california ,",
    "we obtain @xmath306 for @xmath219 .",
    "this is significantly larger than @xmath307 , which is the value for the shuffled catalog .",
    "it has to be pointed out , though , that the average is performed over a different number of nodes in the two cases since the shuffled catalog hardly contains any events with out - degree equal to one . for the shuffled catalog ,",
    "there are only 15 events with @xmath308 , which is close to the expected value of @xmath309 for the random model ",
    "( [ p_out_1 ] ) .",
    "this value is two orders of magnitude less than for the actual seismic data .",
    "another difference between the two data sets is the distribution of @xmath301 . for the actual earthquake data ,",
    "the distribution is much broader .",
    "the standard deviation for the distribution is @xmath310 compared to @xmath311 for the shuffled catalog .",
    "this difference is mainly due to the fact that the original data contain many events with @xmath312 or @xmath313  unlike the shuffled catalog .",
    "( color online ) distributions of the waiting times between event-0s and their recurrences for the original catalog and different threshold magnitudes @xmath221 . the distribution for @xmath219 up to 1988",
    "is also shown .",
    "filled symbols correspond to times below 90 seconds which are underestimated and unreliable due to measurement restrictions : the finite rupture times of earthquakes and the associated seismic coda , which consists of a superposition of incoherent scattered waves , place limitations on the identification and separation of earthquakes .",
    "the inset shows the rescaled distributions .",
    "note that @xmath314 . ]",
    "the temporal distances between events and their recurrences can be analyzed in the same way as the spatial distances .",
    "the pdf @xmath315 for these waiting ( or `` inter - occurrence '' ) times for different threshold magnitudes @xmath221 is shown in fig .",
    "[ fig : t ] .",
    "these all decay roughly as @xmath316 with @xmath317 for intermediate times as indicated in the inset .",
    "the apparent scaling region in fig .  [ fig : t ] shows some curvature , though . due to the finite duration of the catalog",
    ", there is an observational cut - off at the longest time scales . at the shortest time scales",
    ", @xmath315 goes over to a constant limit . while the shape of the distribution is roughly similar to the null model ( see eq .",
    "( [ model_p_t ] ) ) , @xmath315 for the earthquake catalog is _ independent _ of @xmath221 and , hence , the number of events in the catalog .",
    "this invariance is ( again ) drastically at odds with the null model where the temporal rate @xmath318 determines the transition point and @xmath319 itself depends on the number of events @xmath25 as shown in eqs .",
    "( [ t - cutoff - d],[t_n ] ) .    as described in what follows , the analysis for the shuffled catalog shown in fig .",
    "[ fig : shuff_t ] is consistent with the acausal null model .",
    "as predicted by the null model , the distributions for the shuffled catalog must be rescaled by the rate of events in order to obtain a data collapse . furthermore , the invariant behavior ( with respect to magnitude @xmath221 ) we observe for recurrences in the original catalog differs substantially from earlier results for waiting time distributions between subsequent earthquakes @xcite .",
    "it reflects a new non - trivial feature of the spatiotemporal dynamics of seismicity that appears when events other than the immediately subsequent ones  used to conventionally define waiting times  are considered .",
    "( color online ) distributions of the waiting times between event-0s and their recurrences in the shuffled catalog ( see text ) for different threshold magnitudes @xmath221 .",
    "filled symbols correspond to times below 90 seconds which are underestimated and unreliable .",
    "the inset shows the distributions rescaled by the respective rate of events @xmath320 .",
    "the solid line corresponds to a best fit assuming the functional form given in eq .",
    "( [ model_p_t ] ) .",
    "the dashed line highlights the transition point between the constant behavior and the @xmath321 decay .",
    "note that @xmath322 . ]    for the shuffled catalog , @xmath315 closely follows the theoretical prediction of eq .",
    "( [ model_p_t ] ) and in particular the dependence on @xmath221  or rather on @xmath25 through @xmath319 . as shown in the inset of fig .",
    "[ fig : shuff_t ] , the different distributions  with the obvious exception of the observational cut - off at the largest time scales  collapse onto a single curve if @xmath52 is rescaled by the respective rate @xmath320 . here",
    ", @xmath320 is the mean rate of earthquakes above magnitude threshold @xmath221 for the observation period .",
    "notably , the main deviation from the _ stationary _ null model is that the location of the transition point for the shuffled catalog is not at @xmath323 but rather at @xmath324 .",
    "this is expected and due to the fact that the rate of seismic activity  which is preserved in the shuffled catalog  is _ not _ constant over time but exhibits large , correlated fluctuations as indicated , for example , by omori s law @xcite .",
    "( color online ) distribution of waiting time ratios @xmath325 for @xmath219 .",
    "the straight line has slope -0.62 .",
    "open symbols correspond to the original earthquake catalog , filled symbols to the shuffled catalog ( see text ) .",
    "note that @xmath326 . ]",
    "the relative times between subsequent recurrences in the hierarchy can be analyzed in the same way as distances were in sec .",
    "[ sec : hierarchy ] .",
    "[ fig : ratio_t ] shows the pdfs for the ratios @xmath327 for subsequent recurrences , i.e. , recurrences are ordered such that recurrence @xmath252 directly follows recurrence @xmath9 . for the cases shown , two power - law regimes seem to exist : for arguments smaller than about @xmath328",
    ", @xmath329 decays with an exponent @xmath330 roughly independent of @xmath9 , for larger arguments the decay is slower and the exponent apparently decreases further with @xmath9 .",
    "clearly , the broadest scaling regime materializes for @xmath331 .",
    "the behavior of @xmath332 for @xmath333 could be compared to eq .",
    "( [ equ : qx ] ) , although the latter was derived for the translational invariant case . equally important , eq .",
    "( [ equ : qx ] ) only holds for the _ stationary _ null model . as discussed above ,",
    "seismic activity is _ not _ constant over time but exhibits large fluctuations . fig .",
    "[ fig : ratio_t ] shows that these fluctuations as well as the loss of translational invariance are responsible for the behavior for arguments larger than about @xmath328 , since there is no observed difference between the original and the shuffled catalog .",
    "yet , the deviations between the original data and the shuffled catalog for smaller arguments indicate that those short time differences arise from the causal spatiotemporal organization of seismicity .",
    "it is important to discuss our results for the network of recurrences ( or records ) in view of what is known about causal connections between earthquakes .",
    "one specific type of causal connection is earthquake triggering .",
    "the increased seismic activity following large earthquakes  as described by the omori law @xcite leading to the identification of aftershocks  is the most obvious example of earthquakes being triggered in part by preceding events .",
    "aftershock sequences of small earthquakes are less obvious because the aftershock productivity is weaker , but can be observed after stacking many sequences @xcite .",
    "other approaches [ 16 , 25 ] have generalized the definition of an aftershock so that an event can be an aftershock of more than one event leading to networks of earthquakes and aftershocks .",
    "earthquake triggering is typically associated with stress changes which can be static stress changes imparted by the preceding shock or dynamic stress changes associated with seismic wave propagation or combinations of them as discussed , for example , in refs .",
    "the proposed physical mechanisms to explain earthquake triggering due to _ static _ stress change induced by a prior event include rate - and - state dependent friction @xcite , crack growth @xcite , viscous relaxation @xcite , static fatigue @xcite , pore fluid flow @xcite , and simple sandpile models @xcite .",
    "calculations of stress changes have been used to predict the locations , focal mechanisms and times of future earthquakes ( see refs .",
    "@xcite for reviews ) .",
    "the success of this method is limited . only about 60% of aftershocks",
    "are located where the stress increased after a main shock @xcite ; stress shadows are seldom or never observed @xcite ; and the correlation of stress change with aftershocks is rather sensitive to the assumed slip distribution @xcite .",
    "all of this could be due to the fact that most studies have neglected the influence of small earthquakes and secondary aftershocks which can play an important role @xcite .",
    "moreover , most studies have also neglected the influence of _ dynamic _ stresses radiated by seismic waves from ( small or medium - sized ) earthquakes which may also play an important role  even in the near field ( see , e.g. , refs .",
    "in particular , dynamic stress changes can dominate the triggering mechanism over a wide range of distances between 0.2 and 50 kilometers from the fault rupture @xcite .    while it is not entirely clear how our results for the network of recurrences could allow one to distinguish between the different types of stress changes associated with earthquake triggering , there are a number of currently unexplained observations that could be related to a particular triggering mechanism . the excess of events with a large number of recurrences compared to the null model ( see fig .",
    "[ in_out ] ) is one of them .",
    "other examples include the correlations between the in - degree and the out - degree of a given event ( see fig .  [",
    "fig : dd ]  d ) and the apparent invariance of the waiting time distribution with respect to the threshold magnitude ( see fig .  [",
    "fig : t ] ) .",
    "the sensitivity of these properties as well as our other findings ( especially the invariance of @xmath222 with respect to the time span ) to the triggering mechanism can be tested within the framework of the `` epidemic type aftershock sequence '' model which has been established as an improved stochastic null model for seismicity @xcite .",
    "it allows one to vary the spatial scaling of the triggered events depending on the assumed underlying triggering mechanism , namely static stress changes or dynamic stress changes @xcite",
    ". this will be the topic of a future publication .",
    "finally , we would like to point out that simple and direct comparisons of our results for the network of recurrences ( or records ) with known results for aftershocks are not justified .",
    "this is due to the fact that recurrences as defined by our method are at best a very small and _ non - random _ subset of what typically would be considered the set of aftershocks . also , the power - law decay of the distribution of distances as shown in fig .",
    "[ fig : l ] occurs generically for a wide class of processes due to the properties of records as discussed in section  [ sec : null ]  independent of the specific properties of aftershock sequences described , for example , in ref .",
    "similarly , the power - law decay of the distribution of waiting times ( see fig .  [",
    "fig : t ] ) is also a generic property of records as discussed in section  [ sec : null ] and is , thus , not related to the specific characteristics of aftershock sequences discussed in refs .",
    "this paper provides a method to detect features in a temporal sequence of observations that can be plausibly attributed to causal dynamics even when the observer has no _ a priori _ knowledge of the underlying dynamics .",
    "our starting point is to generalize the concept of a recurrence for a point process in time to recurrent events in space and time .",
    "an event is defined to be a recurrence of any previous event if it is closer to it in space than all the intervening events ; i.e. if it constitutes a record breaking event . hence , the causal structure of events may be described as a network of events linked to their recurrences .",
    "each event can have many previous events pointing to it ( its potential causes ) and many future events ( its effects ) .",
    "causality can be plausibly inferred when the statistical properties of the network constructed using this method and the statistics of the records deviate strongly from those resulting from almost any acausal process .",
    "we derive analytically many properties for the network of recurrent events composed by random processes in space and time . in doing so",
    ", we develop a fully symmetric theory of records where both the variable in which records occur and time , itself , are continuous .",
    "this simplifies the theory and in our view makes it more elegant .",
    "we discover a number of new analytic results for record breaking statistics .",
    "many of those results are compared to properties of the network synthesized from time series of epicenter locations for earthquakes in southern california .",
    "significant disparities that can be attributed to causality are mainly coming from the invariance of network statistics with the time span of the events considered .",
    "this is presumably related to an observed hierarchy in the distances and times of subsequent recurrences . as a result",
    "a fundamental length scale for recurrences is obtained solely from the earthquake epicenter data , which can be identified as the rupture length .",
    "all these significant deviations disappear when the analysis is repeated for a surrogate in which the original magnitudes and locations of earthquake epicenters are randomly `` shuffled '' .",
    "almost all of the latter results are completely consistent with predictions from the acausal null model . taken together these results suggest that causality in seismic dynamics may be much broader than any normative interpretation of `` triggering '' .",
    "our results are generally robust with respect to modifications of the rules used to construct the network , e.g. , using spatial neighborhoods such that the construction becomes symmetric under time reversal or taking into account magnitudes .",
    "all such modifications have the drawback that they do not define a record breaking process consisting of recurrences to each event . for seismicity ,",
    "our results are also unaltered if we exclude unphysical links with propagation velocities larger than the velocity of a `` p wave '' of about @xmath334 ( @xmath335 of all links ) .",
    "this is also true if we restrict ourselves to velocities smaller than the velocity of a shear wave of about @xmath336 which is often thought to be more relevant .    by building certain specific features of causality into null models , it is possible to refine predictions and examine what features in the network of seismicity are due to those aspects of causality and what are yet to be explained .",
    "it remains to be seen how general our method may turn out to be . in principle",
    "it can be applied to any high resolution data set where events occur in space and time .",
    "immediate applications may include analyses of other geophysical or astrophysical data sets , brain scans @xcite , or analyses of models to validate or falsify them .",
    "note that a systematic dependence of the location error on magnitude has not been reported in the literature and is also not present in the catalog at hand .",
    "it is unlikely that the characteristic length we see ( @xmath222 ) is merely an artifact due to location error growing with magnitude .    for @xmath219 , the hypothesis that the out - degree distribution is poissonian is rejected by the @xmath338-test at the @xmath339 significance level .",
    "specifically , we find @xmath340 for 22 degrees of freedom .    for @xmath219 , the hypothesis that the in - degree distribution is poissonian is rejected by the @xmath338-test at the @xmath339 significance level .",
    "specifically , we find @xmath341 for 15 degrees of freedom ."
  ],
  "abstract_text": [
    "<S> we propose a method to search for signs of causal structure in spatiotemporal data making minimal _ a priori _ assumptions about the underlying dynamics . to this end </S>",
    "<S> , we generalize the elementary concept of recurrence for a point process in time to recurrent events in space and time . </S>",
    "<S> an event is defined to be a recurrence of any previous event if it is closer to it in space than all the intervening events . as such </S>",
    "<S> , each sequence of recurrences for a given event is a record breaking process . </S>",
    "<S> this definition provides a strictly data driven technique to search for structure . </S>",
    "<S> defining events to be nodes , and linking each event to its recurrences , generates a network of recurrent events . </S>",
    "<S> significant deviations in statistical properties of that network compared to networks arising from ( acausal ) random processes allows one to infer attributes of the causal dynamics that generate observable correlations in the patterns . </S>",
    "<S> we derive analytically a number of properties for the network of recurrent events composed by a random process in space and time . </S>",
    "<S> we extend the theory of records to treat not only the variable where records happen , but also time as continuous . in this way </S>",
    "<S> , we construct a fully symmetric theory of records leading to a number of new results . </S>",
    "<S> those analytic results are compared in detail to the properties of a network synthesized from time series of epicenter locations for earthquakes in southern california . </S>",
    "<S> significant disparities from the ensemble of acausal networks that can be plausibly attributed to the causal structure of seismicity are : ( 1 ) invariance of network statistics with the time span of the events considered , ( 2 ) appearance of a fundamental length scale for recurrences , independent of the time span of the catalog , which is consistent with observations of the `` rupture length '' , ( 3 ) hierarchy in the distances and times of subsequent recurrences . </S>",
    "<S> as expected , almost all of the statistical properties of a network constructed from a surrogate in which the original magnitudes and locations of earthquake epicenters are randomly `` shuffled '' are completely consistent with predictions from the acausal null model . </S>"
  ]
}