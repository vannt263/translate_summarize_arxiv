{
  "article_text": [
    "bounding the degree of the generators of a module or sheaf is a central problem in commutative algebra and algebraic geometry .",
    "the modern approach to this problem concentrates on proving stronger bounds involving castelnuovo - mumford regularity .",
    "in fact , castelnuovo - mumford regularity was introduced in  14 of @xcite to bound the family of all projective subschemes having a given hilbert polynomial . following this appearance ,",
    "castelnuovo - mumford regularity has become a crucial ingredient in bounding the degree of syzygies @xcite @xcite and constructing hilbert schemes , picard schemes and moduli spaces @xcite @xcite .",
    "the goal of this paper is to bound the multigraded castelnuovo - mumford regularity ( as defined in @xcite ) of all subschemes of a smooth projective toric variety @xmath0 that have a given multigraded hilbert polynomial . to establish this bound",
    ", we work with saturated monomial ideals in the homogeneous coordinate ring of @xmath0 . we introduce a new combinatorial tool , called a stanley filtration , for studying monomial ideals . using an appropriate stanley filtration",
    ", we produce an effective bound for the multigraded regularity of an individual ideal or family of ideals .",
    "we also discuss applications of our bound to the construction of multigraded hilbert schemes .",
    "using ideals in the homogeneous coordinate ring @xmath1 to analyze subschemes of @xmath0 has several advantages .",
    "the @xmath2-graded polynomial ring @xmath3 $ ] , introduced in @xcite , is intrinsic to the variety @xmath0 . by focusing on @xmath0 rather than a projective embedding of @xmath0 ,",
    "we reduce both the number of variables and the total degree of the polynomials needed to describe a subscheme .",
    "when @xmath4 , the multigrading allows for stronger bounds on the equations defining a subscheme .",
    "multigradings also produce a finer stratification of subschemes of @xmath0 .",
    "the novel approach required for multigraded polynomial rings leads to new insights in the standard graded case .",
    "indeed , when @xmath5 , we obtain a new proof of gotzmann s optimal bound on the regularity of all subschemes having a given hilbert polynomial .",
    "gotzmann s original proof @xcite relies on macaulay s characterization of the hilbert function of an ideal in a standard graded polynomial ring .",
    "since there is no version of macaulay s theorem for nonstandard gradings , the methods used in @xcite do not apply in our situation .",
    "in fact , there is typically no lexicographic ideal in the homogeneous coordinate ring of @xmath0 ( see @xcite ) so we can not expect a direct analogy of macaulay s result .",
    "the alternative proof of gotzmann s result given in @xcite , also see @xcite and  4.3 in @xcite , uses an induction on a general hyperplane section .",
    "because a general hypersurface is rarely a toric variety , this approach does not extend to toric varieties .",
    "the main combinatorial tool used in this paper is based on a stanley decomposition .",
    "given a monomial ideal @xmath6 in @xmath1 , a stanley decomposition for @xmath7 is a set @xmath8 of pairs @xmath9 such that @xmath10 , where @xmath11 is a monomial in @xmath1 , @xmath12 and @xmath13 $ ] .",
    "in other words , if we identify the pair @xmath9 with the set @xmath14 , then each monomial of @xmath1 not in @xmath6 belongs to a unique pair @xmath9 .",
    "it follows that a stanley decomposition expresses the multigraded hilbert polynomial of @xmath7 as a sum of the hilbert polynomials for @xmath15 : @xmath16    [ introexample ] let @xmath17 $ ] have standard grading defined by @xmath18 for @xmath19 .",
    "if @xmath20 is an ideal in @xmath1 then @xmath21 are both stanley decompositions for @xmath7 .",
    "since the hilbert polynomial @xmath22 is simply the binomial coefficient @xmath23 , these stanley decompositions yield @xmath24    we focus on a particular class of stanley decompositions called stanley filtrations . by definition ,",
    "these are ordered sets @xmath25 such that the modules @xmath26 form a filtration @xmath27 with @xmath28 .",
    "the decompositions of example  [ introexample ] are stanley filtrations in the order presented .",
    "we provide an algorithm for finding stanley filtrations .",
    "our first major theorem uses a stanley filtration to give an effective bound on the multigraded regularity . recall that bounding the multigraded regularity of a module @xmath29 is equivalent to giving a subset of @xmath30 . for more information on multigraded regularity",
    ", we refer to @xcite .",
    "remarkably , our major theorems use only the behavior of multigraded regularity in short exact sequences and hence are independent of the precise definition of multigraded regularity .",
    "let @xmath6 be a monomial ideal in @xmath1 . if @xmath31 is a stanley filtration for @xmath7 , then @xmath32 .    by relating the sets @xmath33 to the fan",
    "@xmath34 defining @xmath0 , we can eliminate certain pairs from this intersection .    since @xmath35 for any standard graded polynomial ring",
    ", the first stanley filtration in example  [ introexample ] implies that @xmath36 the minimal free resolution of @xmath7 shows that this bound is sharp : @xmath37 .    to study all subschemes of @xmath0 with a given multigraded hilbert polynomial , we use the combinatorial structure of @xmath34 to focus on a finite set of stanley filtrations .",
    "we also concentrate on ideals that are saturated with respect to the irrelevant ideal @xmath38 ; see section  2 . given a polynomial @xmath39 , we are most interested in expressions of the form arising from our finite set of stanley filtrations .",
    "this leads to an algorithm for finding all @xmath38-saturated monomial ideals with multigraded hilbert polynomial @xmath39 .",
    "we call the maximum number of summands in such an expression for @xmath39 the gotzmann number .    to state our second major result ,",
    "let @xmath40 denote the complement of @xmath41 in @xmath42 .",
    "identifying @xmath43 with @xmath2 , we write @xmath44 for the semigroup of nef line bundles on @xmath0 ; see section  2 for a combinatorial description of @xmath45 .",
    "let @xmath6 be any @xmath38-saturated ideal in @xmath1 and let @xmath46 . if @xmath47 is the gotzmann number for @xmath48 then @xmath49 .",
    "this theorem implies that for any @xmath50 every the subscheme of @xmath0 having multigraded hilbert polynomial @xmath48 is cut out by equations of multidegree @xmath51 . specializing to @xmath52",
    ", we recover gotzmann s regularity theorem ; see theorem  [ t : gotzmann ] .",
    "the structure of the paper is as follows .",
    "the next section establishes our notation for toric varieties , recalls the definition of multigraded regularity from @xcite and collects the basic properties of multigraded hilbert polynomials . in section  [ s : sds ]",
    ", we develop the theory of stanley decompositions and filtrations .",
    "the proofs of our major theorems are in section  [ s : boundandalgo ] .",
    "this section also contains the algorithm for finding all @xmath38-saturated monomial ideals with a given multigraded hilbert polynomial . in section",
    "[ s : standardcase ] , we restrict to the case @xmath52 and show that multigraded techniques provide a simple new proof of gotzmann s regularity theorem .",
    "finally , section  [ s : hilbschemes ] discusses the effective construction of multigraded hilbert schemes .",
    "we thank ezra miller for the references on cleanness .",
    "we also thank kristina crona and edwin oshea for their helpful comments on a preliminary version of this paper . both authors",
    "were partially supported by the mathematical sciences research institute in berkeley , ca .",
    "this section relates multigraded hilbert polynomials to multigraded castelnuovo - mumford regularity ( as defined in @xcite ) .",
    "let @xmath0 be a smooth projective toric variety over a field @xmath53 determined by a fan @xmath34 in @xmath54 . by numbering the rays ( one - dimensional cones )",
    ", we identify @xmath34 with a simplicial complex on @xmath55 : = \\ { 1 , \\dotsc , n \\}$ ] .",
    "we write @xmath56 for the unique minimal lattice vectors generating the rays and we assume that @xmath57 span @xmath54 . set @xmath58 and fix an @xmath59-matrix @xmath60 $ ] such that there is a short exact sequence @xmath61^{\\textsf{t } } \\ ; } \\mathbb{z}^{n } \\xrightarrow{\\ ; [ \\bm{a}_{1 } \\dotsb \\ , \\bm{a}_{n } ] \\ ; } \\mathbb{z}^{r } \\longrightarrow 0 \\ , .\\ ] ] because @xmath62 is the gale dual of the @xmath63-matrix @xmath64 $ ] , it is uniquely determined up to unimodular ( determinant @xmath65 ) coordinate transformations of @xmath2 . since @xmath0 is smooth , the picard group of @xmath0 is isomorphic to @xmath2 .",
    "the homogeneous coordinate ring of @xmath0 , introduced in @xcite , is the polynomial ring @xmath66 $ ] with the @xmath2-grading defined by @xmath67 for @xmath68 .",
    "the combinatorial structure of @xmath34 is encoded in the irrelevant ideal @xmath69 . with these definitions ,",
    "@xcite proves that the category of coherent @xmath70-modules is equivalent to the category of finitely generated @xmath2-graded @xmath1-modules modulo @xmath38-torsion modules .    when @xmath52 , the short exact sequence is @xmath71",
    "\\ ; } \\mathbb{z}^{1 } \\longrightarrow 0 \\ , .\\ ] ] since @xmath72 for @xmath73 , the homogeneous coordinate ring @xmath3 $ ] is simply the standard graded polynomial ring .",
    "the irrelevant ideal @xmath38 is the unique graded maximal ideal @xmath74 .",
    "[ e : hirzebruch ] if @xmath0 is the hirzebruch surface ( or rational scroll ) @xmath75 , then the short exact sequence is @xmath76^{\\textsf{t } } \\ ; } \\mathbb{z}^{4 } \\xrightarrow{\\ ; \\left [     \\begin{smallmatrix }   1 & - \\ell & 1 & 0 \\\\   0 & 1 & 0 & 1     \\end{smallmatrix } \\right ]   \\ ; } \\mathbb{z}^{2 } \\longrightarrow 0 \\ , .\\ ] ] figure  [ f : hirzfig ] illustrates the fan and grading @xmath62 when @xmath77 .",
    "the homogeneous coordinate ring @xmath78 $ ] has the @xmath79-grading induced by @xmath80 $ ] , @xmath81 $ ] , @xmath82 $ ] , @xmath83 $ ] and @xmath84 .",
    "the combinatorial structure of @xmath34 also gives rise to an important subsemigroup of @xmath2 .",
    "we write @xmath85 for the affine semigroup generated by the set @xmath86 . for @xmath87",
    "$ ] , let @xmath40 denote the complement of @xmath41 in @xmath55 $ ] .",
    "the semigroup @xmath45 is @xmath88 . since @xmath0 is projective",
    ", @xmath45 is the set of integral points of an @xmath89-dimensional pointed cone in @xmath90 .",
    "geometrically , elements in @xmath45 correspond to numerically effective ( nef ) line bundles on @xmath0 . as @xcite indicates , @xmath91 is the closure of the khler cone of @xmath0 .",
    "the dual of the khler cone is the mori cone of effective @xmath92-cycles modulo numerical equivalence .",
    "[ e : examplecones ] when @xmath52 , the semigroup @xmath93 .",
    "if @xmath94 ( with @xmath62 chosen as in example  [ e : hirzebruch ] ) , then @xmath95 . in general , the structure of @xmath45 can be much more complicated ; see example  2.8 in @xcite .",
    "the next result illustrates the connection between the irrelevant ideal @xmath38 and the semigroup @xmath45 . for @xmath96",
    "$ ] , let @xmath97 be the prime ideal @xmath98 and let @xmath15 be the ( smaller ) polynomial ring @xmath99 \\cong s / p_{\\sigma}$ ] .",
    "[ l : bsaturated ] a monomial ideal @xmath6 in @xmath1 is @xmath38-saturated if and only if every associated prime @xmath97 of @xmath6 satisfies @xmath100 .",
    "let @xmath101 be an irredundant primary decomposition for @xmath6 where the ideal @xmath102 is @xmath97-primary .",
    "it follows that @xmath103 .",
    "now @xmath104 equals @xmath1 if @xmath105 and equals @xmath102 otherwise .",
    "since @xmath106 is equivalent to @xmath107 , we have @xmath108 .",
    "therefore , @xmath109 if and only if every associated prime @xmath97 satisfies @xmath110 .",
    "the equivalent condition follows immediately from the definition of @xmath45 .    throughout this paper",
    ", @xmath29 denotes a finitely generated @xmath2-graded @xmath1-module .",
    "we refer to @xcite for background information on local cohomology .",
    "the module @xmath29 is @xmath38-torsion if @xmath111 . at the other extreme , @xmath29 is @xmath38-torsion - free if @xmath112 . for an ideal @xmath113 ,",
    "the module @xmath7 is @xmath38-torsion - free if and only if @xmath6 is @xmath38-saturated ; @xmath114 .",
    "[ r : btorsion ] the semigroup @xmath45 also has a useful algebraic interpretation .",
    "if @xmath53 is infinite and @xmath29 is @xmath38-torsion - free , then proposition  3.1 in @xcite shows that for any @xmath115 there is a nonzerodivisor @xmath116 on @xmath29 .",
    "let @xmath117 be the unique minimal hilbert basis of @xmath45 . by definition",
    ", @xmath118 is the minimal subset of @xmath45 such that every element in @xmath45 is a nonnegative integral combination of the @xmath119 ; see ",
    "iv.16.4 in @xcite .",
    "we recall the definition of multigraded castelnuovo - mumford regularity introduced in @xcite .",
    "[ d : localreg ] for @xmath120 , the module @xmath29 is _ @xmath51-regular _ if the following conditions are satisfied :    1 .",
    "@xmath121 for all @xmath122 and all @xmath123 where the union is over all @xmath124 such that @xmath125 ; 2 .",
    "@xmath126 for all @xmath127 .",
    "the _ regularity of @xmath29 _ , denoted by @xmath128 , is the set @xmath129 .    in this paper , we exploit two properties of multigraded castelnuovo - mumford regularity .",
    "firstly , if @xmath6 is an ideal in @xmath1 and @xmath130 then the subscheme of @xmath0 defined by @xmath6 is cut out by equations of multidegree @xmath51 ; see theorem  6.9 in @xcite .",
    "the second property allows us to focus on monomial ideals by relating the regularity of an ideal with its initial ideal .",
    "we write @xmath131 for the initial ideal of @xmath6 with respect to some monomial order .",
    "the following proposition , which is well - known for @xmath52 , appears as proposition  6.13 in @xcite .",
    "[ p : usc ] if @xmath6 is an ideal in @xmath1 , then @xmath132 .",
    "moreover , if @xmath6 is @xmath38-saturated and @xmath133 then @xmath134 .",
    "next , we turn our attention to multigraded hilbert polynomials .",
    "the multigraded hilbert function @xmath135 equals the dimension of the degree @xmath136 homogeneous component of a @xmath2-graded module @xmath29 . as in the standard graded case",
    ", @xmath135 `` eventually '' agrees with a polynomial . to prove this",
    ", we first consider the multigraded hilbert function of the ring @xmath1 .",
    "[ l : polynomial ] if @xmath1 is the coordinate ring of a smooth toric variety then the hilbert function @xmath137 agrees with a polynomial for all @xmath138 .",
    "since the monomials of degree @xmath136 form a basis for the @xmath53-vector space @xmath139 , the hilbert function @xmath140 is a vector partition function .",
    "this means @xmath140 equals the number of ways a vector @xmath141 can be written as a sum of @xmath142 .",
    "the chamber complex of @xmath143 is a polyhedral subdivision of @xmath144 .",
    "it is defined to be the common refinement of the simplicial cones @xmath145 where @xmath146 .",
    "hence , the cone @xmath91 is a chamber ( maximal cell ) in the chamber complex . from @xcite ,",
    "we know that vector partition functions are piecewise quasi - polynomials on the chamber complex .",
    "therefore , @xmath140 is a quasi - polynomial on @xmath45 .    to complete the proof ,",
    "we show that the period of this quasi - polynomial is one .",
    "we write @xmath147 $ ] for the submatrix of @xmath62 consisting of those columns indexed by @xmath41 . from @xcite , we know that the period of the quasi - polynomial is at most the least common multiple of @xmath148 $ ] where @xmath41 is a facet in @xmath34 . by renumbering ( if necessary ) the @xmath149",
    ", we may assume that @xmath150 .",
    "recall that @xmath0 is smooth if and only if @xmath151 = \\pm 1 $ ] for all facets @xmath146 ; see  2.1 in @xcite .",
    "hence , there exists a unimodular change of coordinates such that @xmath152 for all @xmath153 where @xmath154 is the @xmath155th standard basis vector .",
    "in other words , @xmath156 $ ] is the block matrix @xmath157 $ ] where @xmath158 is a @xmath159-matrix .",
    "the gale dual of this configuration is @xmath160 $ ] .",
    "because the gale dual is determined up to unimodular transformation , we have @xmath161 = \\pm \\det [ i_{r } ] = \\pm 1 $ ] for all facets @xmath146 .",
    "algorithms for computing @xmath162 have been implemented in the software package ` latte ` ; see @xcite .",
    "[ e : hilbertpoly ] when @xmath52 , we have @xmath163 .",
    "if @xmath164 , then we have @xmath165 .    using lemma  [ l : polynomial ]",
    ", we show that the multigraded hilbert function of a module @xmath29 agrees with a polynomial for values of @xmath136 sufficiently far into the interior of @xmath45 .",
    "[ p : hilbpolyexists ] there exists a unique polynomial @xmath166 $ ] such that @xmath167 for all @xmath136 in a finite intersection of translates of @xmath45 .",
    "in particular , @xmath168 agrees with @xmath169 for all @xmath136 sufficiently far from the boundary of @xmath45 .    if @xmath170 is the minimal free resolution of @xmath29 , then @xmath171 .",
    "it follows from lemma  [ l : polynomial ] that @xmath135 is a polynomial for all @xmath172 .",
    "since @xmath173 and @xmath45 corresponds to the lattice points in an @xmath89-dimensional cone in @xmath90 , this intersection is nonempty .",
    "the polynomial @xmath169 in proposition  [ p : hilbpolyexists ] is called the _ multigraded hilbert polynomial _ of @xmath29 .",
    "the multigraded hilbert polynomial of a @xmath38-torsion module is especially simple .",
    "[ l : torsionpoly ] if @xmath29 is a @xmath38-torsion module then @xmath174 .",
    "since @xmath29 is a finitely generated @xmath38-torsion module , there is a @xmath175 such that @xmath176 .",
    "we first prove that there exists a @xmath177 such that if @xmath178 then every monomial in @xmath179 belongs to @xmath180 .",
    "choose an element @xmath181 which lies in the interior of @xmath45 .",
    "if @xmath11 is a monomial in @xmath1 and @xmath182 , then lemma  2.4 in @xcite shows that @xmath183 .",
    "suppose that @xmath184 such that @xmath185 for @xmath186 .",
    "caratheodory s theorem ( proposition  1.15 in @xcite ) implies that @xmath187 for some @xmath188 satisfying @xmath189 for @xmath190 , @xmath191 satisfying @xmath192 and some @xmath193 satisfying @xmath194 .",
    "it follows that there is an @xmath195 $ ] such that @xmath196 and hence @xmath197 is divisible by @xmath198 .",
    "therefore , if we set @xmath199 then @xmath200 implies that @xmath201 .    to complete the proof ,",
    "we show that @xmath202 for all @xmath136 sufficiently far into the interior of @xmath45 .",
    "let @xmath203 be generators of @xmath29 .",
    "our choice of @xmath51 guarantees that @xmath202 for all @xmath204 . since elements in @xmath45 are lattice points in a full - dimensional cone , the elements in this intersection are the lattice points in a translation of the same cone .",
    "we conclude that @xmath174 .    more generally , the multigraded hilbert polynomial of a module is independent of @xmath38-torsion .",
    "[ l : saturationpoly ] if @xmath205 then @xmath206 . in particular ,",
    "if @xmath113 is an ideal then @xmath7 and",
    "@xmath207 have the same hilbert polynomial .",
    "since @xmath208 is a @xmath38-torsion module , lemma  [ l : torsionpoly ] shows that its multigraded hilbert polynomial equals @xmath209 .",
    "hence , the short exact sequence @xmath210 implies that @xmath211 . because @xmath212 , the second assertion is a special case of the first part .",
    "the following result connects hilbert functions with local cohomology modules .",
    "the special case in which @xmath1 has the standard grading can be found in  4.4 of @xcite .",
    "[ p : funcpolydifference ] we have @xmath213    we proceed by induction on @xmath214 . if @xmath215 , then @xmath29 is artinian .",
    "hence , @xmath29 is a @xmath38-torsion module and we have @xmath216 and @xmath217 for all @xmath122 .",
    "since lemma  [ l : torsionpoly ] shows that @xmath174 , the assertion follows .",
    "assume @xmath218 .",
    "since both sides of change by @xmath219 when @xmath29 is replaced by @xmath220 , we may assume that @xmath29 is @xmath38-torsion - free . because extension of the base field commutes with the formation of local cohomology",
    ", we may also assume that @xmath53 is infinite .",
    "choose @xmath177 .",
    "remark  [ r : btorsion ] implies there is a nonzerodivisor @xmath221 on @xmath29 with @xmath116 .",
    "hence , @xmath222 and there is a short exact sequence @xmath223 set @xmath224 and @xmath225 with this notation , it suffices to prove that @xmath226 . from",
    ", it follows that @xmath227 . combining this with proposition  [ p : hilbpolyexists ]",
    ", we deduce that @xmath228 for all @xmath136 sufficiently far into the interior of @xmath45 and thus for all @xmath136 .",
    "hence , we have @xmath229 . on the other hand , the long exact sequence associated to shows that @xmath230 therefore , we have @xmath231 . since the induction hypothesis yields @xmath232",
    ", we conclude that @xmath226 .",
    "[ c : regmeanspoly ] if @xmath29 is @xmath51-regular then the hilbert function @xmath135 agrees with the hilbert polynomial @xmath169 for all values @xmath233 with @xmath234 .    if @xmath29 is @xmath51-regular , then @xmath235 for all @xmath236 and all @xmath237 with @xmath234 .",
    "hence , the claim follows from proposition  [ p : funcpolydifference ] .",
    "multigraded hilbert polynomials also have a geometric description , which is attributed to snapper in @xcite .",
    "let @xmath238 be the line bundle on @xmath0 corresponding to @xmath141 and let @xmath239 be the @xmath70-module associated to the @xmath1-module @xmath29 . since equation ( 6.3.1 ) in @xcite indicates that @xmath240 proposition  [ p : funcpolydifference ] implies that @xmath241    for a finite set of points , the connection between multigraded regularity and multigraded hilbert polynomials is particularly elegant .",
    "let @xmath6 be the @xmath38-saturated ideal corresponding to a finite set of points on @xmath0 .",
    "proposition  6.7 in @xcite shows that @xmath242 is exactly the subset of @xmath2 for which the hilbert function @xmath243 equals the hilbert polynomial @xmath48 .",
    "in this section we introduce the key combinatorial tool used in this paper .",
    "we restrict our focus to a monomial ideal @xmath6 in the polynomial ring @xmath1 , and introduce the notion of a stanley decomposition for @xmath7 .",
    "this is a partition of the monomials of @xmath1 not in @xmath6 into sets each of which corresponds to the monomials in a smaller polynomial ring .",
    "[ d : sddefn ] if @xmath244 and @xmath96 $ ] , the pair @xmath245 denotes the set of all monomials in @xmath1 of the form @xmath246 where @xmath247 .",
    "stanley decomposition _ for @xmath7 is a set @xmath8 of pairs @xmath9 such that @xmath248 where @xmath249 $ ] . in other words",
    ", each monomial of @xmath1 not in @xmath6 belongs to a unique pair @xmath9 in the stanley decomposition .",
    "a stanley decomposition @xmath8 for @xmath7 also gives a primary decomposition of @xmath6 : @xmath250 this is typically not the unique irreducible irredundant primary decomposition of @xmath6 .",
    "stanley decompositions are inspired by @xcite and algorithmically defined in @xcite ; also see @xcite , @xcite . both @xcite and @xcite require the extra condition that @xmath251 should be at least the depth of @xmath6 .",
    "[ e : sdegs ] if @xmath252 $ ] , then    1 .",
    "@xmath253 , 2 .",
    "@xmath254 and 3 .",
    "@xmath255    are three distinct stanley decomposition for @xmath7 .",
    "these are illustrated in figure  [ f : firstsdpic ] .",
    "stanley decompositions are closely related to standard pairs .",
    "see @xcite for the origin of the notation @xmath256 and more details .",
    "standard pairs enjoy the following property : if @xmath9 is a standard pair of @xmath6 then @xmath257 is an associated prime of @xmath6 .",
    "in contrast , not all ideals have a stanley decomposition where every @xmath41 corresponds to an associated prime .    if @xmath258 is a monomial ideal in the ring @xmath259 $ ] , then @xmath260 is a stanley decomposition for @xmath7 where @xmath261 does not correspond to an associated prime of @xmath6 .",
    "one easily verifies for this ideal that every stanley decomposition for @xmath7 has a pair @xmath262 for which @xmath41 does not correspond to an associated prime .    the paper @xcite studies the special case when @xmath7 has a stanley decomposition in which each @xmath41 corresponds to a minimal associated prime of @xmath6 .",
    "decompositions with this property are called _",
    "clean_.    one way to construct a stanley decomposition is to make repeated use of the short exact sequence @xmath263 where @xmath264 is any variable .",
    "more explicitly , we have following algorithm .",
    "a special case of this algorithm is implicit in the proof of lemma  2.4 in @xcite .",
    "[ a : comma - colon ] given a monomial ideal @xmath6 in the polynomial ring @xmath1 with @xmath265 , the following algorithm computes a stanley decomposition for @xmath7 .    1 .",
    "( base case ) if @xmath6 is a prime ideal , then let @xmath41 correspond to the set of variables not in @xmath6 and output @xmath266 .",
    "( choose variable ) if @xmath6 is not prime then choose a variable @xmath267 that is a proper divisor of a minimal generator of @xmath6 .",
    "3 .   ( recursion )",
    "compute a stanley decomposition @xmath268 for @xmath269 and a stanley decomposition @xmath270 for @xmath271 .",
    "output @xmath272 .",
    "a monomial ideal is prime if and only if it is generated by a subset of the variables .",
    "hence , when @xmath6 is prime and @xmath41 corresponds to the set of variables not in @xmath6 , the set @xmath273 is a stanley decomposition for @xmath7 . on the other hand ,",
    "if @xmath6 is not prime , then there exists a variable @xmath274 that is a proper divisor of a minimal generator of @xmath6 . from",
    ", we see that a monomial not in @xmath6 corresponds to either a monomial not in @xmath275 or @xmath274 times a monomial not in @xmath276 .",
    "thus , if @xmath277 is a stanley decomposition for @xmath278 and @xmath279 is a stanley decomposition for @xmath280 , then @xmath281 is a stanley decomposition for @xmath7 .",
    "finally , the algorithm terminates because @xmath1 is a noetherian ring . indeed ,",
    "both @xmath282 and @xmath283 are strictly larger ideals than @xmath6 , so non - termination would give an infinite chain of strictly increasing ideals .",
    "[ r : tree ] running algorithm  [ a : comma - colon ] generates a rooted binary tree . the nodes are monomial ideals and the root is the input ideal . at each node ,",
    "step  2 chooses a variable @xmath274 .",
    "the left - hand child of a node @xmath284 is the ideal @xmath285 and the right - hand child is @xmath286 .",
    "the corresponding branches are labeled with the monomials @xmath92 and @xmath274 respectively .",
    "the leaves of this tree are prime ideals and each leaf corresponds to an element in the stanley decomposition .",
    "specifically , a leaf corresponds to the pair @xmath9 where @xmath11 is the product of labels in the path from the root to the leaf and @xmath41 corresponds to the variables not in the prime ideal .",
    "we will call such a tree the associated binary tree for the stanley decomposition .",
    "these trees also appear in @xcite .",
    "[ e : sdeg ] if @xmath287 $ ] , then the stanley decomposition @xmath288 for @xmath7 produced by algorithm  [ a : comma - colon ] corresponds to the following binary tree . @xmath289_{1 } \\ar@{-}[drr]^{x_{1 } } \\\\ & \\text{{\\footnotesize $ \\langle x_{1 } , x_{2}^{2}x_{3 } , x_{2}^{2}x_{4 } \\rangle$ } } \\ar@{-}[dl]_{1 } \\ar@{-}[dr]^{x_{2 } } & & & & \\text{{\\footnotesize $ \\langle x_{1}x_{2 } , x_{2}x_{3 } , x_{1}x_{4 } , x_{2}x_{4 } \\rangle$ } } \\ar@{-}[dl]_{1 } \\ar@{-}[dr]^{x_{1 } } \\\\ \\text{{\\footnotesize $ \\langle x_{1 } , x_{2 } \\rangle$ } } & & \\text{{\\footnotesize $ \\langle x_{1 } , x_{2}x_{3 } , x_{2}x_{4 } \\rangle$ } } \\ar@{-}[dl]_{1 } \\ar@{-}[d]^{x_{2 } } & & \\text{{\\footnotesize",
    "$ \\langle x_{1 } , x_{2}x_{3 } , x_{2}x_{4 } \\rangle$ } } \\ar@{-}[d]_{1 } \\ar@{-}[dr]^{x_{2 } } & & \\text{{\\footnotesize $ \\langle x_{2 } , x_{4 } \\rangle$ } } \\\\ & \\text{{\\footnotesize $ \\langle x_{1 } , x_{2 } \\rangle$ } } & \\text{{\\footnotesize $ \\langle x_{1 } , x_{3 } , x_{4 } \\rangle$ } } & & \\text{{\\footnotesize $ \\langle x_{1 } , x_{2 } \\rangle$ } } & \\text{{\\footnotesize $ \\langle x_{1 } , x_{3 } , x_{4 } \\rangle$ } } } \\ ] ]    these binary trees equip the stanley decompositions produced by algorithm  [ a : comma - colon ] with an additional structure . to describe this structure , we introduce the following concept .    a _ stanley filtration _ is a stanley decomposition with an ordering of the pairs @xmath290 such that for all @xmath291 the set @xmath292 is a stanley decomposition for @xmath293 .",
    "equivalently , the ordered set is a stanley filtration provided the modules @xmath294 form a filtration @xmath295 with @xmath296 .    not",
    "every stanley decomposition has an ordering that makes it a stanley filtration .",
    "for example , no ordering of the pairs in the stanley decomposition @xmath297 for @xmath298 / \\langle x_{1}x_{2}x_{3 } \\rangle$ ] is a stanley filtration .",
    "if @xmath7 has a stanley filtration in which each @xmath33 corresponds to a minimal prime of the ideal @xmath6 , then corollary  2.2.4 in @xcite implies that @xmath7 is cohen - macaulay .",
    "a standard way to traverse the leaves of a rooted tree is via _ depth - first search _ where all left - hand descendants of a node are listed before any right - hand descendants .",
    "this corresponds to listing the leaves from left to right in the diagram of example  [ e : sdeg ] .",
    "[ c : filtration ] let @xmath113 be a monomial ideal and let @xmath8 be a stanley decomposition for @xmath7 obtained by applying algorithm  [ a : comma - colon ] . if the pairs have the order induced by a depth - first search ( starting with left - hand children ) of the associated binary tree , then @xmath8 is a stanley filtration .",
    "let @xmath299 and let @xmath300 be the binary tree associated to @xmath8 .",
    "we write @xmath301 for the leaf corresponding to the pair @xmath302 .",
    "we assume that @xmath303 implies that a depth - first search of @xmath300 arrives at @xmath301 before reaching @xmath304 .",
    "it suffices to show that the set @xmath305 can be obtained by applying algorithm  [ a : comma - colon ] to @xmath306 . to accomplish this",
    ", we describe the binary tree @xmath307 generated by applying algorithm  [ a : comma - colon ] to @xmath308 .",
    "the tree @xmath307 is obtained from @xmath300 by deleting @xmath309 and contracting the branch joining the parent of @xmath309 with its left - hand child .",
    "the only nodes in @xmath307 that differ from @xmath300 are the first @xmath310 nodes on the extreme right - hand branch .",
    "these ideals are obtained from those in @xmath300 by adding a proper divisor of @xmath311 .",
    "the converse of corollary  [ c : filtration ] is false , as there are stanley filtrations that do not arise from algorithm  [ a : comma - colon ] . for example , the third stanley decomposition in example  [ e : sdegs ] is a stanley filtration with respect to the given ordering that can not be obtained from algorithm  [ a : comma - colon ] .",
    "indeed , any decomposition obtained from algorithm  [ a : comma - colon ] must have a term @xmath312 or @xmath313 because @xmath314 for @xmath315 , @xmath316 .",
    "this section contains the main results of this paper .",
    "we first show how a stanley filtration for @xmath7 leads to a bound on its multigraded regularity .",
    "[ t : sdbound ] let @xmath6 be a monomial ideal in @xmath1 . if @xmath31 is a stanley filtration for @xmath7 , then @xmath317 .",
    "in addition , if @xmath6 is @xmath38-saturated , then the intersection can be taken over those pairs @xmath302 such that @xmath318 .",
    "let @xmath319 and for @xmath320 set @xmath321 . with this notation",
    ", we have @xmath322 .",
    "we claim that @xmath323 this implies the first part of the theorem . additionally , if @xmath6 is @xmath38-saturated then @xmath324 and @xmath325 . when @xmath326 , lemma  [ l : bsaturated ] implies that @xmath327 is a @xmath38-torsion module , so @xmath328 for @xmath320 .",
    "it follows that @xmath329 for @xmath320 and hence @xmath330 .",
    "therefore , the claim also establishes the second part of the theorem .",
    "we prove by induction on @xmath47 .",
    "when @xmath331 , the unique pair has the form @xmath332 which implies that @xmath333 and @xmath334 .",
    "suppose that the claim holds for all stanley filtrations with fewer than @xmath47 pairs .",
    "the short exact sequence @xmath335 yields the exact sequence @xmath336 from this , we deduce that @xmath337 . since @xmath338 is a stanley filtration for @xmath339 , the induction hypothesis implies that @xmath340 .",
    "the ordering also implies that no monomial in @xmath1 divisible by @xmath311 belongs to the set @xmath341 .",
    "it follows that a monomial @xmath342 is not contained in @xmath6 if and only if @xmath343 .",
    "therefore , we have @xmath344 and @xmath345 which completes the induction .",
    "[ r : totaldegree ] if @xmath1 has the standard grading ( equivalently @xmath52 ) , then theorem  [ t : sdbound ] says that the castelnuovo - mumford regularity of a monomial ideal is bounded by the maximum of @xmath346 for a stanley filtration @xmath347 .",
    "we next examine the relationship between stanley filtrations and hilbert polynomials . given a stanley filtration @xmath348 for @xmath7 , we have @xmath349 since @xmath350 if and only if @xmath110 , the hilbert polynomial of @xmath7 has an expression with potentially fewer summands : @xmath351 . to place further restrictions on the summands , we need an ordering on the @xmath100 .    we endow the polynomial ring @xmath352 $ ] with the @xmath353-grading defined by @xmath354 for @xmath355 .",
    "let @xmath356 be a monomial order on @xmath357 $ ] which refines the order by total degree .",
    "this graded monomial order induces a partial order , also denoted @xmath356 , on the simplices of @xmath34 . specifically , @xmath358 if and only if @xmath359 .",
    "since the total degree of @xmath360 equals @xmath361 , the induced order on @xmath34 refines inclusion : @xmath362 implies @xmath363 .",
    "a total order @xmath364 on @xmath34 is called _ graded _ if it refines the partial order induced by a graded monomial order @xmath356 on @xmath352 $ ] .",
    "[ p : nicesd ] if @xmath364 is a graded total order on @xmath34 and @xmath365 is a monomial ideal , then @xmath7 has a stanley filtration @xmath348 satisfying the following condition :    * if there is an index @xmath155 with @xmath318 and @xmath366 , then there exists an index @xmath367 such that @xmath368 , @xmath369 and @xmath370 for some @xmath371 .",
    "we refine step  @xmath316 of algorithm  [ a : comma - colon ] to produce a stanley filtration that satisfies the given condition .",
    "specifically , step  @xmath316 becomes :    1 .",
    "( choose variable ) if @xmath6 is not contained in @xmath372 for some @xmath373 , then choose a variable @xmath267 that is a proper divisor of a minimal generator of @xmath6 .",
    "otherwise , let @xmath110 be the smallest simplex with respect to @xmath364 for which @xmath374 and choose a variable @xmath375 that is a proper divisor of a minimal generator of @xmath6 .    to prove that the resulting stanley filtration has the desired form",
    ", we analyze the associated binary tree .",
    "let @xmath376 be a pair in the stanley filtration with @xmath318 and let @xmath301 be the corresponding leaf .",
    "the leaf @xmath301 is either a left - hand or right - hand child of its parent .",
    "suppose @xmath301 is a right - hand child .",
    "we write @xmath284 for the parent of @xmath301 and @xmath274 for the variable labeling the branch connecting @xmath284 and @xmath377 , so @xmath378 .",
    "let @xmath304 be the descendant of @xmath284 obtained by repeatedly taking the left - hand child of @xmath284 .",
    "the leaf @xmath304 corresponds to a pair @xmath379 .",
    "since the left - hand branches are always labeled with @xmath92 , we see that @xmath380 .",
    "moreover , the depth - first search ordering ( see corollary  [ c : filtration ] ) chooses left - hand children first , so we have @xmath367 .",
    "because all the left - hand descendants of @xmath284 contain @xmath274 , we must also have @xmath371 .",
    "it remains to show that @xmath368 and @xmath369 . because @xmath381 , we have @xmath382 .",
    "hence the set of all @xmath110 with @xmath383 is nonempty , so we may take @xmath373 to be one which is minimal with respect to @xmath364 . step  @xmath384 guarantees that every left - hand child of @xmath284 is also contained in @xmath372 .",
    "this containment must be proper until the leaf @xmath304 is reached .",
    "this means that @xmath385 which implies @xmath386 and @xmath368 . since @xmath382",
    ", the minimality of @xmath387 implies that @xmath388 .",
    "hence , we have @xmath389 and @xmath369 as required .",
    "on the other hand , suppose that @xmath301 is a left - hand child .",
    "let @xmath390 be the closest ancestor of @xmath301 that is a right - hand child .",
    "such an ancestor exists if and only if @xmath366 .",
    "since @xmath391 , the argument given when @xmath301 is a right - hand child applies to the parent of @xmath390 and this completes the proof .    using proposition  [ p : nicesd ]",
    ", we can give an algorithm for finding all @xmath38-saturated monomial ideals with a given hilbert polynomial @xmath39 .",
    "roughly speaking , the algorithm works by `` peeling off '' smaller hilbert polynomials @xmath360 from @xmath39 . to accomplish this , we need the following result about the leading coefficients of the hilbert polynomial . this lemma generalizes techniques used in the proof of theorem  3.2 of @xcite .",
    "[ l : leading ] let @xmath392^{\\text{\\sf{t } } } \\in \\mathbb{z}^{r}$ ] be the first standard basis vector and let @xmath39 be the multigraded hilbert polynomial of @xmath29 .",
    "if @xmath393 , then the leading coefficient of @xmath39 with respect to the graded lexicographic order with @xmath394 is positive .    using proposition  1.11 in @xcite",
    ", we may choose a weight vector @xmath395 such that @xmath396 and @xmath397 for @xmath398 .",
    "let @xmath399 be the map defined by @xmath400 . since @xmath401 is the largest component of @xmath402 , we have @xmath403 . by hypothesis",
    ", we also have @xmath404 which implies that @xmath405 for @xmath406 . for a fixed @xmath407 , consider @xmath408 $ ] .",
    "if @xmath409 has total degree @xmath410 then the highest degree term in @xmath411 is @xmath412 . when @xmath413 and @xmath414 , @xmath411 agrees with the hilbert function @xmath415 which implies that @xmath416 .",
    "thus , the leading coefficient of the polynomial @xmath411 is positive . because this is true for all sufficiently large @xmath407 , the leading coefficient of @xmath417 considered as a polynomial in @xmath418 $ ] is also positive",
    "finally , our choice of @xmath402 implies that the leading coefficient of @xmath417 equals the leading coefficient of @xmath39 with respect to the graded lexicographic order .",
    "proposition  [ l : leading ] is more applicable than is obvious at first glance .",
    "clearly @xmath419 can be replaced by any other standard basis vector @xmath420 , with the corresponding change of lexicographic order .",
    "more generally , there is always a unimodular coordinate change on @xmath2 that takes the configuration @xmath143 to a new configuration @xmath421 with @xmath404 .",
    "indeed , any vector @xmath422 with @xmath423 can be the first column of a matrix in @xmath424 .",
    "in fact , there is an unimodular transformation of @xmath2 such that the entire positive orthant lies inside @xmath45 . in this case",
    ", the leading term of the hilbert polynomial @xmath39 with respect to any graded monomial order ( not just graded lexicographic ones ) on @xmath425 $ ] is positive .",
    "this conclusion also holds provided the sequence @xmath426 approaches @xmath427 from within @xmath45 .",
    "in particular , it applies when @xmath45 equals the positive orthant as in examples  [ e : examplecones ] and [ e : hilbertpoly ] .",
    "we now use proposition  [ p : nicesd ] and lemma  [ l : leading ] to give an algorithm for listing all @xmath38-saturated monomial ideals with a given multigraded hilbert polynomial .",
    "[ a : macaulay ] let @xmath364 be a graded total order on @xmath34 and let @xmath356 be the corresponding graded monomial order on @xmath357 $ ] .",
    "given a polynomial @xmath428 $ ] , this algorithm returns all @xmath38-saturated monomial ideals with the multigraded hilbert polynomial @xmath39 .    1 .   ( coordinate change ) if necessary , make a unimodular coordinate change @xmath429 on @xmath2 such that the positive orthant lies inside @xmath45 and replace the polynomial @xmath39 with @xmath430 .",
    "2 .   ( initialize ) set @xmath431 , @xmath432 and @xmath433 .",
    "3 .   ( enlarge representation ) select and remove an element @xmath434 . for each @xmath373 satisfying * if @xmath435 , then there exists a pair @xmath436 with @xmath437 ; * @xmath438 ; * the leading coefficient with respect to @xmath356 of @xmath439 is positive ; + and for each monomial @xmath184 satisfying * if @xmath440 then @xmath441 ; * if @xmath435 then for @xmath9 from ( a ) we have @xmath442 for some @xmath443 ; + do as follows .",
    "if @xmath444 then append the set @xmath445 to @xmath446 . otherwise , append the pair @xmath447 to @xmath448 .",
    "( finished ? ) if @xmath449 then go to step  3 .",
    "( check hilbert polynomial ) for each @xmath450 compute the multigraded hilbert polynomial of the ideal @xmath451 .",
    "if the multigraded hilbert polynomial of @xmath6 is @xmath39 then append @xmath6 to @xmath452 .",
    "output the list @xmath452 .    by construction ,",
    "the output is a list of monomial ideals with multigraded hilbert polynomial @xmath39 that are @xmath38-saturated by lemma  [ l : bsaturated ] .",
    "conversely , given any @xmath38-saturated monomial ideal @xmath6 , proposition  [ p : nicesd ] provides a stanley filtration @xmath453 for @xmath7 such that for all @xmath454 there is a @xmath367 with @xmath455 , @xmath456 and @xmath457 for some @xmath458 .",
    "thus , the conditions  ( a ) , ( d ) and ( e ) in step  3 do not eliminate any @xmath38-saturated monomial ideals with hilbert polynomial @xmath39 .    for @xmath291 ,",
    "the polynomial @xmath459 is the multigraded hilbert polynomial of the @xmath460-graded @xmath1-module @xmath461 and lemma  [ l : leading ] ( combined with step  1 ) ensures that its leading coefficient is positive . since @xmath364 is a graded total order on @xmath34 , we have @xmath462 for @xmath303 , so the leading term of the subtracted polynomial will be @xmath463 .",
    "this means that conditions  ( b ) and ( c ) in step  3 do not exclude any of the relevant ideals .",
    "we conclude that every @xmath38-saturated monomial ideal with multigraded hilbert polynomial @xmath39 has a stanley filtration of the form created by this procedure which implies every such ideal is part of the output .",
    "it remains to show that this procedure terminates . to accomplish this ,",
    "observe that step  3 replaces the pair @xmath464 with pairs in which either the leading coefficient of the second entry , or its leading term , is strictly less than that of @xmath465 . since there are only a finite number of choices for @xmath466",
    ", there is a lower bound on how much the leading coefficient can decrease which guarantees that the process can not continue indefinitely .",
    "this corollary also follows , albeit non - constructively , from @xcite .",
    "[ c : finite ] for any polynomial @xmath39 , there are only finitely many @xmath38-saturated monomial ideals with multigraded hilbert polynomial @xmath39 .",
    "we illustrate algorithm  [ a : macaulay ] by constructing all @xmath38-saturated monomial ideals in the standard graded polynomial ring @xmath467 $ ] having hilbert polynomial @xmath468 .",
    "since the lead term of the hilbert polynomial is @xmath469 , there must be three pairs of the form @xmath470 with @xmath471 .",
    "fix the ordering : @xmath472 . since the pairs correspond to disjoint sets of monomials , the first three pairs are @xmath473 , @xmath474 and @xmath475 where @xmath476 .",
    "these pairs contribute @xmath477 to the hilbert polynomial .",
    "hence , the stanley filtrations also contain the pair @xmath478 where @xmath479 .",
    "constructing all these sets which satisfy the order condition gives :    & & & + & & & + & & & + & & & + & & & + & & & + & & & + & & & + & & & + & & & + & & & + & & & + & & & + & & & + & & &    in particular , there are @xmath480 @xmath38-saturated monomial ideals in @xmath1 with hilbert function @xmath468 .",
    "we can verify this calculation as follows .",
    "since @xmath481 , gotzmann s regularity theorem implies that every saturated ideal with the required hilbert polynomial has regularity @xmath482 which means the generators have degree at most @xmath482 . because @xmath483 and @xmath484 , the list consists of all ideals generated by two monomials of degree @xmath482 .",
    "eliminating those that do not have the correct hilbert polynomial produces the same @xmath480 monomial ideals .    to state our next theorem , we make the following definition .    [ d : gotzmannnum ] let @xmath47 be the largest number of pairs in a decomposition @xmath8 constructed in algorithm  [ a : macaulay ] .",
    "we call this the _ gotzmann number _ of @xmath39 .",
    "to calculate an upper bound for the gotzmann number of @xmath39 , we can use a simplified version of algorithm  [ a : macaulay ] .",
    "specifically , the gotzmann number is bounded by the maximum @xmath485 among all the expressions @xmath486 that satisfy the following conditions :    1 .",
    "@xmath487 for some @xmath318 ; 2 .",
    "@xmath488 ; 3 .   for all @xmath454 ,",
    "there is a @xmath367 with @xmath489 and @xmath490 for some @xmath371 .    when @xmath1 has the standard grading ( or equivalently when @xmath5 ) , the results of  [ s : standardcase ] show that this upper bound is the exact gotzmann number .",
    "the analogous question for general smooth projective toric varieties is not known .",
    "we now establish our multigraded analogue of gotzmann s regularity theorem .",
    "[ t : hilbpolybound ] let @xmath6 be any @xmath38-saturated ideal in @xmath1 and let @xmath491 .",
    "if @xmath47 is the gotzmann number of the hilbert polynomial @xmath48 then @xmath492    applying proposition  [ p : usc ] and lemma  [ l : saturationpoly ] , we may assume without loss of generality that @xmath6 is a @xmath38-saturated monomial ideal .",
    "algorithm  [ a : macaulay ] yields a partial stanley filtration @xmath493 with at most @xmath47 pairs .",
    "moreover , we have @xmath494 . since the hypothesis on @xmath181 guarantees that @xmath495 and theorem  [ t : sdbound ] implies that @xmath496 , the theorem follows .",
    "we end this section with two examples .",
    "let @xmath6 be an @xmath38-saturated ideal corresponding to the set of @xmath410 points on a smooth projective toric variety @xmath0 .",
    "hence , @xmath497 and the gotzmann number of @xmath48 is also @xmath410 . if @xmath498 , then @xmath499-regular .",
    "this bound is independent of the configuration of the points .",
    "in contrast , proposition  6.7 in @xcite shows that @xmath242 does depend on the arrangement the points on @xmath0 .",
    "if @xmath500 then @xmath501 $ ] has the @xmath79-grading defined by @xmath502 $ ] and @xmath503 $ ] .",
    "we consider those multigraded hilbert polynomials which map to @xmath468 under the embedding of @xmath0 into @xmath504 given by @xmath505 \\in \\mathbb{z}^{2 } = \\operatorname{pic}(x)$ ] .    *",
    "@xmath506 : in this case , we need only consider two decompositions of the multigraded hilbert polynomial @xmath39 , namely @xmath507 and @xmath508 .",
    "it follows that the gotzmann number is @xmath482 .",
    "since proposition  6.10 in @xcite shows that @xmath509 , we deduce that every ideal @xmath6 with the given multigraded hilbert polynomial is @xmath510$]-regular .",
    "* @xmath511 : the possible decompositions are @xmath512 and @xmath513 , so the gotzmann number is @xmath514 . *",
    "@xmath515 : the only possible decomposition is @xmath516 , so the gotzmann number is again @xmath514 . *",
    "@xmath517 : there are no @xmath38-saturated ideals with this hilbert polynomial .",
    "indeed , the first piece of a decomposition would be @xmath518 corresponding to a pair @xmath332 with @xmath482 , @xmath519 .",
    "the second pair would have the form @xmath520 for some @xmath521 which means that the second piece of the decomposition must again be @xmath518 .",
    "however , we are left with a polynomial of the form @xmath522 which is impossible since we also have @xmath523 .",
    "by specializing to a standard graded polynomial ring ( equivalently to @xmath524 ) , we next show that theorem  [ t : hilbpolybound ] implies gotzmann s regularity theorem . throughout this section , @xmath66 $ ] has the @xmath353-grading defined by @xmath18 for @xmath190 and the irrelevant ideal @xmath525 .",
    "gotzmann s regularity theorem gives a bound on the regularity of all @xmath38-saturated ideals in @xmath1 with a given hilbert polynomial @xmath526 .",
    "we first prove that gotzmann s bound is the gotzmann number for @xmath526 ( which justifies definition  [ d : gotzmannnum ] ) .",
    "[ l : lexsegmentlongest ] if the polynomial @xmath527 $ ] can be expressed in the form @xmath528 where @xmath529 and @xmath530 for @xmath531 then among all such expressions the number @xmath47 is maximized if and only if @xmath532 for all @xmath155 .",
    "a modification to algorithm  [ a : macaulay ] gives a method for finding all expressions of the form .",
    "hence , there is only a finite number of such decompositions , so we may choose @xmath533 to be an expression of the desired form with a maximal number of summands .",
    "suppose there is a @xmath155 such that @xmath534 and let @xmath485 be the smallest such @xmath155 . using pascal s identity , we can replace @xmath535 with @xmath536 .",
    "we claim that by reordering ( if necessary ) the binomial coefficients @xmath537 with @xmath538 and @xmath539 , we obtain an expression of the desired form with @xmath540 summands",
    ". indeed , the new expression has the desired form because @xmath541 implies @xmath542 and the @xmath543 term has the same shift with a larger index .",
    "this longer expression contradicts the maximality of our choice , however , so we must have @xmath532 for all @xmath155 .",
    "this lemma allows us to give a new proof of gotzmann s regularity theorem .",
    "[ t : gotzmann ] let @xmath3 $ ] be the homogeneous coordinate ring of @xmath544 and let @xmath38 be the irrelevant ideal @xmath545 . if @xmath6 is an ideal in @xmath1 and @xmath546 where @xmath529 , then @xmath547 is @xmath548-regular .    by proposition  [ p : usc ]",
    ", we may assume that @xmath6 is a @xmath38-saturated monomial ideal .",
    "let @xmath549 be a stanley filtration for @xmath7 satisfying the requirements of proposition  [ p : nicesd ] . since each @xmath550 is also a standard graded polynomial ring , we know that each @xmath550 is @xmath209-regular ( see example  4.2 in @xcite ) .",
    "remark  [ r : totaldegree ] implies that @xmath7 is @xmath485-regular where @xmath551 .",
    "we have @xmath552 where @xmath553 and @xmath554 for @xmath555 .",
    "lemma  [ l : lexsegmentlongest ] shows that @xmath556 , which completes the proof .",
    "although not required in our proof of gotzmann s regularity theorem , the expression corresponds to a stanley filtration of the saturated lexicographic ideal with hilbert polynomial @xmath526 . by definition ,",
    "the @xmath557th graded component of a lexicographic ideal @xmath558 is the @xmath53-vector space spanned by the largest @xmath559 monomials in lexicographic order .",
    "if we fix an ordering on the variables @xmath264 , then macaulay s description of hilbert functions in @xmath1 ( theorem  4.2.10 in @xcite ) shows that there is a unique @xmath38-saturated lexicographic ideal associated to every hilbert polynomial .",
    "if @xmath527 $ ] is a hilbert polynomial , then the expression @xmath560 with @xmath529 comes from a stanley filtration for @xmath561 where @xmath562 is the unique @xmath38-saturated lexicographic ideal satisfying @xmath563 .    from @xcite , we know that for every saturated lexicographic ideal @xmath558 there is an integer @xmath410 between @xmath209 and @xmath564 and positive integers @xmath565 for @xmath566 such that @xmath567 we use algorithm  [ a : comma - colon ] to compute a stanley filtration for @xmath7 where @xmath6 is any ideal of the form given on the right - hand side of .",
    "in step  2 of algorithm  [ a : comma - colon ] , choose the variable @xmath568 ; the largest variable dividing the largest minimal generator of @xmath6 .",
    "it follows that @xmath569 hence , the left - hand child of @xmath6 is prime and corresponds to the pair @xmath570 . on the other hand ,",
    "the right - hand child is another ideal of the form given on the right - hand side of . iterating this process , we obtain a stanley filtration of @xmath7 : @xmath571 and one easily verifies that yields an expression of the form .    since the number of pairs in the stanley filtration equals the maximum total degree of a minimal generator of the saturated lexicographic ideal @xmath558 , it follows that gotzmann s regularity theorem is sharp .",
    "this establishes the well - known result that the lexicographic ideal has the worst regularity among all @xmath38-saturated ideals with the same hilbert polynomial .",
    "the aim of this section is to construct a space @xmath572 that parameterizes all subschemes of @xmath0 with a given multigraded hilbert polynomial @xmath573 $ ] .",
    "this generalizes the original hilbert scheme , introduced in @xcite , which parameterizes subschemes of projective space .",
    "like all parameter spaces , @xmath572 allows one to study the natural adjacency relationships between subschemes .",
    "this larger class of hilbert schemes also includes many more manageably sized examples . by analyzing these small spaces , especially those which are accessible to computational experimentation",
    ", we expect to gain new insights into hilbert schemes .",
    "it is well - known that the lines on the nonsingular quadratic surface @xmath574 contained in @xmath575 belong to two families .",
    "in fact , each of these families is precisely a multigraded hilbert scheme . specifically , the closed subscheme of @xmath576 parameterizing subschemes of @xmath575 with hilbert polynomial @xmath577 lying on @xmath0 is the disjoint union @xmath578 .",
    "we construct the space @xmath572 by proving that the appropriate functor is represented by a projective scheme .",
    "define the functor @xmath572 that sends the category of commutative rings over @xmath53 to the category sets as follows : given a commutative ring @xmath579 over @xmath53 , @xmath580 is the set of families of subschemes @xmath581 over @xmath582 whose sheaf of ideals has the specified hilbert polynomial @xmath583 . to prove that",
    "@xmath572 is representable , we build on the methods used in @xcite ; see  6.1 for the explicit reference to our setting .    to begin , we recall the hilbert functor @xmath584 from @xcite . for a subset @xmath585 , we write @xmath586 for the graded @xmath53-vector space @xmath587 and @xmath588 denotes a collection of maps from @xmath179 to @xmath589 .",
    "more precisely , @xmath590 consists of the multiplication maps arising from the monomials in @xmath591 . for a commutative ring @xmath579 over @xmath53 , let @xmath592 be the graded @xmath579-module @xmath593 with operators @xmath594 .",
    "a homogeneous submodule @xmath595 is an @xmath596-submodule if it satisfies @xmath597 for all @xmath598 .",
    "given a function @xmath599 , let @xmath600 be the set of @xmath596-submodules @xmath601 such that @xmath602 is a locally free @xmath579-module of rank @xmath603 for each @xmath604 . if @xmath605 is a homomorphism , then local freeness implies that @xmath606 is an @xmath596-submodule of @xmath607 and @xmath608 is a locally free @xmath609-module of rank @xmath603 for each @xmath610 . defining @xmath611 to be the map sending @xmath612 to @xmath613 makes @xmath584 into a functor from the category of commutative rings over @xmath53 to the category of sets .",
    "when the function @xmath614 is defined by evaluating a polynomial @xmath583 at points in @xmath615 , we simply write @xmath616 . by relating the functors @xmath572 and @xmath616 ,",
    "we show that @xmath572 is representable .",
    "if @xmath573 $ ] is a hilbert polynomial , then the functor @xmath572 is represented by a projective scheme over @xmath53 . in fact , there is a finite subset @xmath617 which produces a canonical closed embedding from @xmath572 into @xmath616 .",
    "if @xmath579 is a commutative ring over @xmath53 , then @xcite shows that each ideal sheaf in @xmath580 corresponds to unique @xmath38-saturated ideal @xmath6 in the ring @xmath618 $ ] . using theorem  [ t : hilbpolybound ]",
    ", we can choose a @xmath177 for which every such @xmath6 is @xmath51-regular .",
    "lemma  6.8 in @xcite states that the truncation @xmath619 corresponds to the same ideal sheaf on @xmath0 as @xmath6 does .",
    "this bijection between sheaves of ideals on @xmath0 and truncations of ideals in @xmath1 gives a natural transformation between @xmath572 and @xmath620 .    in  6.1 of @xcite haiman and sturmfels",
    "claim that there exists a finite set @xmath621 satisfying @xmath622 for such a finite set @xmath621 , theorem  2.3 in @xcite produces a closed embedding @xmath623 . since theorem  2.2 and remark  2.5 in @xcite",
    "prove that @xmath616 is represented by a closed subscheme of a grassmann scheme , this completes the proof .",
    "to give explicit equations for @xmath572 , we need an effective description of both the set @xmath615 and the equations defining the closed subscheme of @xmath616 .",
    "the following algorithm , essentially a constructive version of proposition  3.2 in @xcite , produces the set @xmath615 .      1 .   ( initialize )",
    "set @xmath615 equal to @xmath624 , where @xmath51 is a bound on the regularity of all ideals with hilbert polynomial @xmath583 obtained from theorem  [ t : hilbpolybound ] .",
    "( create ideals ) construct the set @xmath452 of all monomial ideals @xmath6 generated in degree @xmath615 such that @xmath625 for all @xmath626 . since there are only a finite number of monomials with degrees in @xmath615 ,",
    "this is a finite set .",
    "( finished ? )",
    "if every ideal @xmath6 in @xmath452 satisfies @xmath627 then return @xmath615 .",
    "otherwise , for every ideal in @xmath452 find a @xmath233 such that @xmath628 .",
    "add each of these points to @xmath615 and return to step  2 .",
    "one choice of such points is to use the maximum degree of a monomial with degree in @xmath615 to bound the maximum size of any @xmath629 , and thus of any @xmath630 , occurring in a stanley filtration of the appropriate form .",
    "this gives a bound @xmath181 on the regularity of all ideals generated in @xmath615 , and so we can add the point @xmath181 , together with @xmath631 sufficiently general points in @xmath632 to @xmath615 . evaluating @xmath243 at these points also lets us check whether @xmath627 .",
    "the proof of proposition 3.2 of @xcite establishes that this algorithm terminates .",
    "it remains to show that the output satisfies . by construction , every ideal @xmath6 in @xmath452 has hilbert polynomial @xmath583 .",
    "step  1 guarantees that the saturation @xmath633 has hilbert polynomial @xmath583 and is @xmath51-regular .",
    "theorem  5.4 in @xcite implies that @xmath634 is generated in degree @xmath51 . since @xmath635",
    ", we have @xmath636 . because @xmath637 , it follows that @xmath638 . applying corollary  [ c : regmeanspoly ]",
    ", we see that @xmath639 for all @xmath640 .",
    "we conclude that holds .",
    "we finish by explaining why in the step  3 it suffices to choose @xmath631 sufficiently general points in @xmath641 to add to @xmath615 . by construction",
    "all ideals generated in @xmath615 agree with their hilbert polynomial on @xmath632 . since @xmath39 is a polynomial of degree at most @xmath642 in @xmath89 variables , it has at most @xmath643 terms .",
    "if the hilbert function of an ideal @xmath6 generated in the degrees in @xmath615 agrees with @xmath39 for @xmath631 sufficiently general points in @xmath641 , then it must have hilbert polynomial @xmath583 .",
    "a multigraded version of gotzmann s persistence theorem would lead to an effective description of the equations defining the relevant closed subscheme of @xmath616 .",
    "this is the central open problem in this area .",
    "annetta aramova , kristina crona , and emanuela de  negri , _ bigeneric initial ideals , diagonal subalgebras and bigraded hilbert functions _ , journal of pure and applied algebra * 150 * ( 2000 ) , no .  3 , 215235 .            markus  p. brodmann and rodney  y. sharp , _ local cohomology : an algebraic introduction with geometric applications _ , cambridge studies in advanced mathematics , vol .  60 , cambridge university press , cambridge , 1998 .                mark green , _ restrictions of linear series to hyperplanes , and some results of macaulay and gotzmann _ , algebraic curves and projective geometry ( trento , 1988 ) , lecture notes in math . ,",
    "1389 , springer , berlin , 1989 , pp .",
    "7686 .",
    "alexander grothendieck , _ techniques de construction et thormes dexistence en gomtrie algbrique .",
    "iv . les schmas de hilbert _ , sminaire bourbaki , vol .",
    "france , paris , 1995 , pp .  exp .",
    "221 , 249276 .",
    "serkan hoten and rekha  r. thomas , _ standard pairs and group relaxations in integer programming _ , journal of pure and applied algebra * 139 * ( 1999 ) , no .",
    "1 - 3 , 133157 , effective methods in algebraic geometry ( saint - malo , 1998 ) .      jess a.  de loera , raymond hemmecke , jeremiah tauzer , and ruriko yoshida , _ effective lattice point counting in rational convex polytopes _ , ` latte ` code available at ` http://www.math.ucdavis.edu/~latte ` ."
  ],
  "abstract_text": [
    "<S> we give an effective uniform bound on the multigraded regularity of a subscheme of a smooth projective toric variety @xmath0 with a given multigraded hilbert polynomial . to establish this bound </S>",
    "<S> , we introduce a new combinatorial tool , called a stanley filtration , for studying monomial ideals in the homogeneous coordinate ring of @xmath0 . as a special case </S>",
    "<S> , we obtain a new proof of gotzmann s regularity theorem . </S>",
    "<S> we also discuss applications of this bound to the construction of multigraded hilbert schemes . </S>"
  ]
}