{
  "article_text": [
    "the ever - increasing amount of genetic information available in plant and animal breeding is reflected in the development of sophisticated models for the prediction of quantitative traits from genome - wide markers @xcite , also known as genomic selection ( gs ) .",
    "the markers are typically dense single - nucleotide polymorphisms ( snps ) .",
    "approaches to this problem have moved from models with simple specifications , such as ridge regression @xcite and the lasso @xcite , to models based on highly - structured hierarchical distributions or semiparametric approaches .",
    "some examples are the bayesian alphabet models @xcite , bayesian models with complex priors as in @xcite , models based on reproducing kernel hilbert spaces ( rkhs ) such as @xcite , or the bayesian lasso @xcite .",
    "this complexity is motivated by the need to correctly model the genetic architecture of the trait under investigation while producing models that are easy to estimate even for large snp profiles .",
    "we focus on two key aspects of these models : the inclusion of a preliminary step that removes snps that appear to be redundant , and the choice of kinship matrices to model the relatedness of the genotyped individuals .",
    "the former is equivalent to _ feature selection _",
    "@xcite , and can also be achieved by shrinking snp effects towards zero , either through the use of constraints @xcite or through appropriate prior distributions in a bayesian setting @xcite .",
    "we examine the effectiveness in gs of markov blankets @xcite , which have been extensively studied in graphical modelling .",
    "they provide a principled solution to feature selection problems , and can be implemented as a data pre - processing step prior to fitting the gs model .",
    "we implement markov blanket feature selection within four gs models applied to three real - world data sets covering barley , rice and mouse genetics .",
    "kinship matrices were traditionally derived from pedigrees using a single definition , but with kinships now being calculated from snp data many different definitions are available @xcite .",
    "we investigate four kinship matrices within genetic best linear unbiased prediction ( gblup ) .",
    "these include a novel matrix introduced by @xcite which adjusts for the bias introduced by differences in local linkage disequilibrium ( ld ) , and has been shown to increase the precision of heritability estimates .",
    "the markov blanket of a variable of interest @xmath0 , denoted as @xmath1 , is the minimal set of variables conditioned on which all other variables in the model are probabilistically independent of the target @xmath0 @xcite .",
    "the markov blanket of a phenotype @xmath2 in a gs model is the minimal set @xmath3 such that @xmath4 that is , the subset of snps @xmath5 that makes all other snps redundant as far as the trait @xmath2 is concerned . given this property , knowledge of only the snps in @xmath5 is enough to determine the probability distribution of @xmath2 .",
    "other snps become superfluous , either because they are not associated with the trait or because their effect is mediated by the snps in @xmath5 .",
    "if @xmath5 were known , any gs model could be fitted using @xmath5 instead of the full snp profile @xmath6 with no loss of information , but in practice the need to estimate @xmath5 means that some information loss is possible .",
    "this two - stage approach contrasts with models such as bayesb @xcite and the lasso @xcite , which select significant snp effects concurrently with model fitting and in a model - specific way .",
    "markov blankets can be efficiently estimated from data through the use of conditional independence tests , such as parametric and non - parametric tests for partial correlation @xcite or mutual information @xcite .",
    "tests in common use do not require any tuning parameter except for the type i error threshold @xmath7 .",
    "the estimated @xmath5 will satisfy ( [ def : mb ] ) only approximately because of type i and type ii errors .",
    "the former arise from the noisiness inherent to the data and limited sample sizes , while the latter are typical of weak dependencies which will often be omitted from the markov blanket .",
    "several computationally - efficient heuristic algorithms for markov blanket estimation are available in literature , including grow - shrink ( gs ; * ? ? ?",
    "* ) , incremental association ( iamb ; * ? ? ?",
    "* ) and hiton - mb @xcite .",
    "for instance , iamb can be used to estimate the markov blanket of a trait @xmath2 as follows :    1",
    ".   set @xmath8 2 .",
    "* forward phase : * until no change is made , 1 .",
    "test each snp @xmath9 for independence from @xmath2 conditional on the current markov blanket @xmath5 ; 2 .   admit into @xmath5 the snp whose test returned the lowest p - value if that p - value is smaller than @xmath7 .",
    "* backward phase : * for each @xmath10 , remove @xmath9 from @xmath5 if @xmath2 is independent of @xmath9 conditional on @xmath11 .    as a result , conditional independence tests are performed in order of increasing complexity , thus ensuring that in practice only a small number of snps is used for each test .",
    "compared to single - snp analyses , such as those described in @xcite and @xcite , feature selection with markov blankets is computationally more expensive because of the use of conditional ( @xmath12 ) instead of marginal ( @xmath13 ) independence tests",
    ". however , as shown in section [ sec : results ] , figure [ fig : randomsub ] , conditional tests are more effective at discarding snps that carry essentially the same information about the trait and select subsets with more predictive power for the same size .      in the past ,",
    "pedigree information was used to specify kinships , but such information is often missing or inadequate .",
    "snp - based methods for measuring kinships have become increasingly common and have the advantage of measuring the realised amount of genome sharing , as opposed to the expected value provided by pedigree - based methods @xcite    the snp - based kinship of two individuals is usually based on the average over snps of the product of their genotypes , coded as @xmath14 , @xmath15 and @xmath16 according to the count of one of the two alleles . by design",
    ", it can only capture the additive components of kinship , and it has very low power in identifying non - additive ones . in the following ,",
    "we denote this genotype matrix with @xmath6 , with rows corresponding to individuals and columns to snps , and with @xmath9 its @xmath17th column .    in human genetics",
    ", kinship is commonly measured as the proportion of shared alleles at each locus @xcite .",
    "this approach is also known as identical - by - state ( ibs ) kinship , and will be denoted by @xmath18 . unlike other kinship matrices below , @xmath18 is always non - negative .",
    "however , it can not be expressed in the form @xmath19 , which leads to parameters directly interpretable as snp effect sizes ( see section [ sec : methods ] for details ) .",
    "another choice , common in plant and animal genetics , is to centre the genotypes @xcite and estimate the kinship matrix as @xmath20 where @xmath21 is the number of markers and @xmath22 is a vector with every entry equal to the population allele fraction , usually estimated as the mean of @xmath23 .",
    "centring improves interpretability , since kinship values can be interpreted as an excess or deficiency of allele sharing compared with random allocation of alleles , and so zero can be interpreted as `` unrelated '' .",
    "however , the requirement to estimate the @xmath22 , usually from the same data set , can cause problems in some settings @xcite .",
    "one criticism of both the above choices is that the sharing of a rare allele between two individuals counts the same as the sharing of a common allele .",
    "one natural approach to giving more weight to the sharing of a rare allele is to standardise over snps , thus obtaining @xmath24 the @xmath25 entry of @xmath26 can be interpreted as an average over snps of the correlation coefficient estimated from a single pair of individuals , @xmath17 and @xmath27 @xcite .",
    "a modification of @xmath26 has been recently proposed by @xcite , based on evidence that the effects of snps are sensitive to uneven ld across the genome . in particular , snp effects are over - estimated in high - ld regions and under - estimated in low - ld regions due the uneven tagging of causal variants .",
    "the contributions of causal variants are picked up by a larger number of snps in high - ld regions compared to low - ld regions , thus introducing bias in the gs models and in turn in subsequent inference such as prediction or heritability estimation . to correct for this bias ,",
    "snps can be re - weighted : @xmath28 where the weight vector @xmath29 $ ] solves @xmath30 and @xmath31 is a vector of squared correlations of snp @xmath17 with neighbouring snps .",
    "snp effects are set to decay exponentially with physical distance , according to a decay rate @xmath32 whose value reflects the average ld for the data set . as a result",
    "we have that @xmath33 where @xmath34 is the distance between snps @xmath17 and @xmath27 , is approximately constant as the weights offset differences in ld as measured by the squared correlations @xmath35 .    for computational reasons , the minimisation in ( [ eq : ldadj ] )",
    "is performed separately on different chromosomes and , within each chromosome , on different regions chosen based on @xmath32 .",
    "we explored the effects of the approaches outlined in section [ sec : background ] on the predictive power of gs models using three publicly - available real - world data sets including continuous phenotypic traits .",
    "the yield data from the agoueb project @xcite consist of @xmath36 uk winter barley varieties and @xmath37 snps .",
    "the heterogeneous mouse population @xcite from the wellcome trust case control consortium ( wtccc ) consists of @xmath38 snp profiles and @xmath39 snps ; among the recorded traits , we consider growth rate and weight .",
    "the rice data set from @xcite consists of @xmath40 varieties of _ oryza sativa _ with @xmath41 snps ; among the @xmath42 recorded traits , we consider the number of seeds per panicle because of its low variability among the various subpopulations included in the original analysis .",
    "all data sets have been preprocessed by removing snps with minor allele frequencies @xmath43 and those with @xmath44 missing data .",
    "the missing data in the remaining snps have been imputed using the * impute * r package @xcite .",
    "other widely used imputation methods in genetics , such as that implemented in mach @xcite , were not available because of the absence of accurate snp maps ; the position of many snps is unknown , and only genetic distances ( in cm ) were available between mapped snps .",
    "furthermore , we removed one snp from each pair whose allele counts have correlation @xmath45 to increase the numerical stability of the models .    to investigate markov blanket feature selection , we considered the following gs models :    * ridge regression , lasso and the elastic net penalised regressions .",
    "these are all based on @xmath46 where @xmath2 is the trait of interest , @xmath6 are the snp genotypes , @xmath47 are the fixed snp effects and @xmath48 are independent , normally - distributed errors with variance @xmath49 .",
    "we used the implementations provided by the * penalized * @xcite and * glmnet * @xcite r packages . when considering the elastic net we restricted both the @xmath50 and @xmath51 penalties for the genetic effects @xmath47 to be strictly positive ( @xmath52 ) , to facilitate the comparison with ridge regression ( @xmath53 ) and the lasso ( @xmath54 ) . * partial least squares ( pls ) regression as implemented in the * pls * r package @xcite . *",
    "genetic blup ( gblup ) implemented in the * synbreed * r package @xcite .",
    "it uses the linear mixed model @xmath55 where @xmath56 are the random effects and @xmath57 is a design matrix that can be used for example to indicate the same genotype exposed to different environments . any positive definite matrix can be used for @xmath58 .",
    "fixed effects can also be included in ( [ eq : blup ] ) in order to capture purely environmental effects @xcite .",
    "+ when @xmath58 can be expressed in the form @xmath59 , gblup can be shown to be equivalent to the bayesian linear regression @xmath60 in which @xmath58 determines the transformation @xmath61 of the snp genotypes .",
    "for instance , the original @xmath9 are used when @xmath62 ; the scaled @xmath63 from ( [ eq : allelic ] ) when @xmath64 ; and the weighted @xmath65 from ( [ eq : ldak ] ) when @xmath66 .",
    "this formulation of gblup results in a more natural interpretation of snp effects , and is sometimes known as random regression blup ( rr - blup ) .",
    "an overview of its properties can be found in @xcite and @xcite .",
    "markov blanket feature selection has been performed with the iamb algorithm as implemented in the * bnlearn * r package @xcite , using the exact student s @xmath67 test for pearson s correlation with a type i error threshold of @xmath68 .",
    "each gs model was fitted both using all the available snps and using only the snps included in the markov blanket .",
    "the different kinship matrices were investigated within gblup , as the other gs models do not include an explicit kinship term . @xmath69 and",
    "@xmath70 were computed using *",
    "synbreed*. for @xmath71 , we used the freely available ldak software @xcite .",
    "the ld decay rate was set to @xmath72 cm for the agoueb data , @xmath73 cm for the mouse data and @xmath74 cm for the rice data .",
    "such values were found , through experimentation , to ensure the ld adjustment was effective without affecting the genetic information present in the snp profiles .",
    "@xmath18 was computed with plink @xcite .",
    "all configurations of gs models and kinships were fitted once using all snps available after preprocessing the data and once using only those in the markov blanket .",
    "the predictive power of the gs models was measured with pearson s correlation coefficient @xmath75 between the observed trait values and the predictions obtained from @xmath76-fold cross - validation . for each model , cross - validation",
    "was run @xmath77 times .",
    "markov blankets , kinship matrices and gs models were fitted separately for each fold in each cross - validation run , and the resulting correlations averaged .",
    "the correlation between observed and fitted trait values is also reported as a measure of goodness of fit .",
    "table [ tab : mb ] reports the observed correlations ( @xmath75 , i.e. the correlation between the observed and the fitted trait values ) and the predictive correlations ( @xmath78 , i.e. the correlations obtained from cross - validation ) for pls , ridge regression , lasso and the elastic net . the corresponding correlations arising from the subset of snps included in the markov blankets are labelled @xmath79 and @xmath80 , respectively .",
    "l|c|c|c|c|c|c model & @xmath75 & @xmath79 & @xmath81 & @xmath78 & @xmath80 & @xmath82 +   + pls & @xmath83 & @xmath84 & @xmath85 & @xmath86 & @xmath87 & @xmath88 + ridge & @xmath89 & @xmath90 & @xmath91 & @xmath92 & @xmath93 & @xmath94 + lasso & @xmath95 & @xmath96 & @xmath97 & @xmath98 & @xmath99 & @xmath100 + elastic net & @xmath101 & @xmath102 & @xmath103 & @xmath104 & @xmath93 & @xmath105 +   + pls & @xmath106 & @xmath107 & @xmath108 & @xmath109 & @xmath110 & @xmath111 + ridge & @xmath112 & @xmath113 & @xmath114 & @xmath115 & @xmath116 & @xmath117 + lasso & @xmath118 & @xmath119 & @xmath120 & @xmath121 & @xmath116 & @xmath122 + elastic net & @xmath123 & @xmath124 & @xmath125 & @xmath126 & @xmath127 & @xmath100 +   + pls & @xmath128 & @xmath129 & @xmath130 & @xmath131 & @xmath132 & @xmath133 + ridge & @xmath134 & @xmath135 & @xmath136 & @xmath137 & @xmath138 & @xmath139 + lasso & @xmath140 & @xmath141 & @xmath142 & @xmath143 & @xmath144 & @xmath100 + elastic net & @xmath145 & @xmath146 & @xmath147 & @xmath148 & @xmath148 & @xmath88 +   + pls & @xmath149 & @xmath150 & @xmath151 & @xmath152 & @xmath153 & @xmath154 + ridge & @xmath155 & @xmath156 & @xmath157 & @xmath153 & @xmath158 & @xmath159 + lasso & @xmath160 & @xmath161 & @xmath162 & @xmath163 & @xmath164 & @xmath142 + elastic net & @xmath165 & @xmath166 & @xmath167 & @xmath168 & @xmath158 & @xmath169 +    first of all , we note that for @xmath68 markov blankets only select a small number of snps , regardless of the dimension of the snp profile .",
    "the average size of the markov blankets obtained from cross - validation is @xmath170 for the agoueb data , @xmath171 ( for growth rate ) and @xmath172 ( for weight ) for the mouse data , and @xmath173 for the rice data . of those snps , @xmath174 ( @xmath175 )",
    "appear in at least half of the cross - validation folds for agoueb , @xmath176 ( @xmath177 ) for the mouse data and weight , @xmath178 ( @xmath179 ) for the mouse data and growth rate , but only @xmath180 ( @xmath181 ) for the rice data .",
    "this can be attributed to the very low ratio between sample size and number of snps in the rice data ( @xmath182 ) compared to the mouse ( @xmath183 ) and agoueb ( @xmath184 ) data . as expected , the dimension reduction is smaller in the case of the agoueb data because of the limited number of available snps , despite the extensive ld present in cultivated uk barley @xcite . on the other hand ,",
    "only a small proportion of the original snps are retained for the mouse and rice data sets ( about @xmath185 and @xmath186 , respectively ) . in each case , the number of snps included in the markov blankets is smaller than the sample size , thus ensuring the regularity and numerical stability of the gs models .",
    "the position of mapped snps within the respective genomes is shown in figure [ fig : agouebmap ] ( agoueb ) , figure [ fig : ricemap ] ( rice ) , figure [ fig : weightmap ] ( mice , weight ) and figure [ fig : growthmap ] ( mice , growth ) . for all but the agoueb data",
    ", we can see how the markov blankets arising from cross - validation identify some regions as associated with the trait being modelled ( e.g. snps in the range @xmath187 $ ] of chromosome @xmath15 are included with high probability for both traits in the mice data set ) while completely discarding other regions ( e.g. @xmath188 $ ] in chromosome @xmath16 and @xmath189 $ ] in chromosome @xmath190 ) .",
    "the positions of these regions may provide useful prior information in subsequent association studies and in targeting future genotyping efforts . in the case of the agoueb data ,",
    "marker density is not high enough to identify regions with markedly different association levels .",
    ".correlation coefficients obtained in gblup using the four kinship matrices defined in section [ sec : kinship ] .",
    "the highest value for each quantity and data set is shown in bold . @xmath75 and @xmath78 are defined as in table [ tab : mb ] . [ cols=\"^,^,^,^,^,^,^,^,^ \" , ]     although the elastic net performed equally well with or without markov blanket feature selection , that is not the case for gblup ( table [ tab : both ] ) .",
    "for all kinship matrices , the reduced size of the markov blanket relative to the full snp set detracts from the computation of kinship coefficients , leading to a substantial loss of predictive power .",
    "if all snps are available and can be used to compute the kinship matrices , then much but not all of this loss is restored .",
    "we have shown that markov blanket feature selection applied as a preliminary step in gs with a continuous trait is able to greatly reduce the size of the snp set with no loss ( and possibly a small gain ) in the predictive power of pls , ridge regression , lasso and the elastic net . among those models ,",
    "the elastic net was the best performer , followed by ridge regression .",
    "if gs is to be performed repeatedly for the same phenotype , for example in successive generations of crops , markov blanket feature selection opens the possibility of reducing costs by genotyping many fewer markers .    in the absence of a feature selection step , the ld - adjusted kinship matrix @xmath191 @xcite provides slightly better predictive power than the matrix with no ld adjustment @xmath26 @xcite and the ibs kinship matrix @xmath18 produced by plink @xcite . in turn",
    ", @xmath26 and @xmath18 appear superior to the matrix with neither ld adjustment nor standardising of snps @xmath192 @xcite . using @xmath191 , gblup was competitive with the elastic net ( both had mean @xmath193 over the four datasets ) .",
    "markov blanket feature selection is not compatible with gblup because of the requirement for large numbers of snps to compute the kinship matrix .",
    "however , markov blanket feature selection has only a small adverse effect on gblup if all snps are available for computing the kinship matrix .",
    "the work presented in this paper forms part of the midrib project , which is funded by the uk technology strategy board ( tsb ) and biotechnology & biological sciences research council ( bbsrc ) , grant ts / i002170/1 .",
    "we thank our project partners for helpful discussions .",
    "we also thank the agoueb consortium ( supported by uk defra , the scottish government , through the sustainable arable link program grant 302/bb / d522003/1 ) for making their data available ."
  ],
  "abstract_text": [
    "<S> we investigate two approaches to increase the efficiency of phenotypic prediction from genome - wide markers , which is a key step for genomic selection ( gs ) in plant and animal breeding . </S>",
    "<S> the first approach is feature selection based on markov blankets , which provide a theoretically - sound framework for identifying non - informative markers . </S>",
    "<S> fitting gs models using only the informative markers results in simpler models , which may allow cost savings from reduced genotyping . </S>",
    "<S> we show that this is accompanied by no loss , and possibly a small gain , in predictive power for four gs models : partial least squares ( pls ) , ridge regression , lasso and elastic net . </S>",
    "<S> the second approach is the choice of kinship coefficients for genomic best linear unbiased prediction ( gblup ) . </S>",
    "<S> we compare kinships based on different combinations of centring and scaling of marker genotypes , and a newly proposed kinship measure that adjusts for linkage disequilibrium ( ld ) .    </S>",
    "<S> we illustrate the use of both approaches and examine their performances using three real - world data sets with continuous phenotypic traits from plant and animal genetics . </S>",
    "<S> we find that elastic net with feature selection and gblup using ld - adjusted kinships performed similarly well , and were the best - performing methods in our study .    </S>",
    "<S> * keywords : * genome - wide prediction , genomic selection , feature selection , markov blanket , linkage disequilibrium , kinship . </S>"
  ]
}