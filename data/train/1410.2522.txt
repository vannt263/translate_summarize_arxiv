{
  "article_text": [
    "in this work we propose a model for the covariance matrix of eeg / meg that expresses it as a kronecker product of three components and imposes physiologically inspired constraints on the model components .",
    "the analysis of the spatial distributions of eeg or meg signals using mathematical models can provide information about the underlying current sources @xcite .",
    "these models rely on a priori assumptions on the number of current sources and the propagation of secondary currents through the conductive tissues .",
    "in addition , they contain assumptions about the probability distribution of the background noise .",
    "one motivation behind our choice for a 3- component covariance model originates from the fact that the simpler model , that describes the covariance matrix as a kronecker product of two components ( spatial and temporal ) has turned out to be useful for source localization .",
    "it has been shown , e.g. in @xcite , that current source estimation can be improved substantially by accounting for spatio - temporal noise covariances , which is done via the kronecker product assumption . however , if stimulus induced experiments last for several minutes or more then the spatio - temporal model with two components may become questionable .",
    "first , the assumption that the brain response is the same for each stimulus excludes the possibility of trial - to - trial variations or habituation effects @xcite .",
    "this aspect of response modeling has obtained some attention in the literature @xcite .",
    "a second limitation of the two domain model for the noise covariance is that it does not reflect the fact that the brain s state , such as subject s arousal , may change during the experiment .",
    "such variations in brain states may modulate the amplitude variations that are superimposed on the brain activity induced by the stimulus .",
    "since this aspect has been ignored until now , we will extend in the present paper the existing two domain covariance model by adding a third component which describes trial - to - trial variations in noise level .",
    "another aspect that was not taken into account in the two domain spatio - temporal covariance model is that the eeg / meg signal is stationary on small time scales , which was , for instance , observed in @xcite .",
    "we take care of this aspect by restricting the temporal component to be a toeplitz matrix , @xcite .",
    "this restriction also reduces the number of unknown covariance parameters that need to be estimated .",
    "apart from being important for evoked potential and evoked field experiments , modeling of spontaneous eeg and meg signals plays a role in resting state studies , where the subject is asked to stay awake while no particular stimulus is presented to the subject whose brain activity is recorded . usually , such studies are performed using fmri @xcite , but because fmri is an indirect measure of brain activity , combined eeg / fmri experiments have become more popular , e.g.  @xcite .",
    "since eeg and fmri are beneficial on complementary domains , integration of eeg and fmri has become an active field of research .",
    "nevertheless , due to differences in dimensionalities of eeg and fmri data , one of the largest challenges of a combined eeg / fmri analysis is to develop mathematical models where both modalities are put in the same framework .",
    "current practice is to assume a general linear model ( glm ) , in which the fmri signal of a given voxel is the response variable and powers in different frequency bands extracted from eeg are used as regressors . in this way",
    ", the use of the alpha activity derived in the occipital region has provided interesting novel insights in the generators of the alpha band @xcite that would not have been possible with eeg alone .",
    "however , this approach suffers from the limitation that the choice of the regressor may only reflect a small part of the total eeg activity and the inclusion of other frequency bands , as explored in @xcite , is only a partial solution .",
    "the proposed three domain covariance model provides a valuable alternative here because it relates the covariance to all electrodes instead of a small selected subset and no a priori choices about a certain frequency band need to be made .",
    "the physiological idea is that the eeg at rest is generated by randomly distributed and oscillating current sources of which the amplitude varies at the time scale at which the fmri is recorded .",
    "the estimation of the parameters of the proposed model extracts the most dominant effects from the data .",
    "the estimated amplitude variations can be used for investigating eeg - fmri correlations .    in section 2",
    "the mathematical details of the proposed model are presented and an estimation procedure is derived .",
    "a method for evaluating accuracy of the estimate is also presented .",
    "section 3 contains simulation results , which assess the accuracy of the estimation procedure under the model and show which assumptions about the covariance components are related to increased accuracy .",
    "moreover , real data results are presented for sef meg data and for eeg - fmri data . in section 4 the findings",
    ", extensions of the proposed framework and future applications are discussed .",
    "eeg / meg data can be expressed as @xmath0 , where @xmath1 is the sample size .",
    "we assume that each recording is written as @xmath2 $ ] , where @xmath3 is the preprocessed @xmath4th epoch / trial organized in a 2-dimensional @xmath5 matrix , such that @xmath6 represents the number of sensors and @xmath7 the number of time points within one epoch / trial . although often @xmath8 , the proposed method is applicable for general @xmath9 .",
    "let vec be the operator that stacks columns of a matrix into one column in the order from first to last , so that vec@xmath10 is a vector of length @xmath11 .",
    "we assume that vec@xmath10 has a multivariate normal distribution with mean @xmath12 and covariance matrix @xmath13 ( vec@xmath14 ) , and that @xmath0 are independent . without loss of generality @xmath15 , so the signals oscillate around zero .",
    "let @xmath16 , @xmath17 and @xmath18 be positive definite matrices with dimensions @xmath19 , @xmath20 and @xmath21 , respectively .",
    "each of the matrices is related to one domain of the data : @xmath16 is the spatial component , @xmath17 the temporal and @xmath18 is the epochs / trials component .",
    "the relationship between the data and the three components is expressed by the assumption : for @xmath22 , @xmath23 , @xmath24 , cov@xmath25 .",
    "the notation @xmath26 stands for the @xmath27th element of the matrix @xmath28 .",
    "this assumption is equivalent to @xmath29 , where @xmath30 denotes the kronecker product @xcite . for @xmath31 positive definite , @xmath29 is also positive definite .",
    "the next assumption is that the temporal covariances in @xmath17 only depend on the time lag between time points , which is the same as assuming stationarity of the signal within one epoch / trial",
    ". therefore the temporal matrix @xmath17 is assumed to have a toeplitz structure @xcite , which means that elements that lie on the same subdiagonal are equal .",
    "moreover , we treat the data from different epochs as independent , which translates into the assumption that @xmath18 is a diagonal matrix . in order to assure identifiability of @xmath32 from the kronecker product , the constraints @xmath33 and @xmath34",
    "are added .    in summary ,",
    "the final model is @xmath35 where vec@xmath36 are independent , @xmath16 is a @xmath19 positive definite matrix , @xmath17 is a @xmath20 positive definite toeplitz matrix , @xmath18 is an @xmath21 positive definite diagonal matrix , @xmath33 , and @xmath34 .",
    "because the covariance matrix factorizes into a kronecker product and two of the components have additional structure , the number of unknown parameters of @xmath37 equals @xmath38 , which is very low compared to the size of the data ( @xmath39 ) . thus one can expect to obtain accurate estimates of this structured covariance matrix if the model holds .",
    "the covariance components @xmath31 are estimated by maximum likelihood . even though there is no closed form estimator of the structured covariance matrix , likelihood equations for the matrices",
    "have been derived in @xcite . in such case",
    "each of the likelihood equations gives an expression of one kronecker factor in terms of the others and , as a result , the likelihood equations can not be solved analytically . because we impose additional structure on @xmath17 and @xmath18 , in our case",
    "the set of the likelihood equations becomes :    [ likelihood_equations ] @xmath40    with @xmath33 and @xmath34 .",
    "here the matrices @xmath41 and @xmath42 contain the same elements as @xmath43 , but arranged differently : @xmath44 , where @xmath45 , @xmath46 , @xmath47 .",
    "the dimensions of @xmath41 and @xmath42 are equal to @xmath48 and @xmath49 , respectively .",
    "the function @xmath50 in maps a @xmath20 symmetric matrix into a @xmath51 vector as follows : @xmath52 , where @xmath53 is the sum of the elements of the matrix @xmath28 that lie on the @xmath54th subdiagonal .",
    "this function originates from the toeplitz constraint that has been imposed on @xmath17 .",
    "equation can be derived from the likelihood equation for a toeplitz covariance matrix by treating @xmath16 and @xmath17 as if they were known , as is detailed in [ notation ] and [ derivation_toeplitz_equation ] .",
    "finally , the diag operator in equation replaces the non - diagonal elements of a matrix by zeros .",
    "if no toeplitz restrictions on @xmath17 were imposed and @xmath18 were unconstrained , a 3-component extension ( @xcite ) of the so - called iterative flip - flop algorithm ( @xcite ) could have been used to obtain numerical approximations of the ml - estimates of the covariance components . according to @xcite ,",
    "the necessary requirement for existence of the maximum likelihood estimator is @xmath55 .",
    "this condition guarantees that if the data is not rank deficient , each of the three likelihood equations provides a solution with respect to one covariance component that is positive definite conditional on the two other components being positive definite .",
    "therefore if one uses the flip - flop algorithm and initial values of the two components @xmath56 are positive definite , then all of the updates will stay positive definite .    in our case",
    "the necessary condition on @xmath1 is different due to the toeplitz assumption imposed on @xmath17 and the diagonality of @xmath18 .",
    "the sample size required for estimating a toeplitz covariance matrix is reduced by a factor two with respect to the sample size required for estimating an unrestricted covariance matrix @xcite .",
    "therefore the requirement for a sample size that guarantees existence of a positive definite toeplitz matrix @xmath17 which satisfies is also reduced by a factor two , which results in the new requirement : @xmath57 , where @xmath58 denotes the ceiling function .",
    "the diagonal matrix @xmath18 at the left hand side of is guaranteed to be positive definite for any sample size and any configuration of the @xmath59 dimensions if the data have full rank , because diagonal elements of @xmath18 are equal to sum of squares of scaled elements from @xmath60 .",
    "therefore under model @xmath1 should satisfy @xmath61    the flip - flop algorithm needs to be adapted to take into account the additional assumptions about @xmath17 and @xmath18 .",
    "the diagonality of @xmath18 is easily taken care of by replacing the non - diagonal elements of each update of @xmath18 by zeros , as follows from equation .",
    "equation , however , does not have a closed form solution for @xmath17 .",
    "nevertheless @xcite presents an iterative method for obtaining an approximation of the maximum likelihood estimate for a covariance matrix that has a toeplitz structure .",
    "it is designed for the model in which there are independent realizations of @xmath62 , where @xmath63 is a toeplitz covariance matrix .",
    "the general idea presented in @xcite to estimate @xmath63 by maximum likelihood is to embed it into a higher dimension circulant matrix .",
    "this is done by extracting the first @xmath7 columns and the first @xmath7 rows of the circulant matrix , where @xmath7 is the dimension of @xmath63 .",
    "contrary to the case of toeplitz matrices , for a circulant matrix @xmath64 a closed form maximum likelihood estimator exists that allows one to estimate @xmath64 directly from the data .",
    "a practical difficulty is , however , that the method of @xcite requires an embedding dimension that is much higher than @xmath7 .",
    "therefore , large amounts of missing data have to be replaced by their expectations conditioned on the current estimate of @xmath63 and the original data . as a consequence , extensive simulations are necessary to determine the accuracy of this approach when a computationally acceptable embedding dimension is used .",
    "we adapt the procedure from @xcite to make it possible to obtain approximate maximum likelihood estimates of @xmath17 given the current updates of the estimates of @xmath16 and @xmath18 .",
    "a full description of the step of the algorithm in which @xmath17 is updated is given in [ toeplitz_estimation ] .    in our iterative estimation procedure the estimate of one component is updated based on the current estimates of the two other components , see algorithm  [ alg : algorithm1 ] .",
    "initialize : @xmath65 , @xmath66 .",
    "repeat the following steps :    calculate estimate @xmath67 of @xmath17 based on @xmath68 and current estimates @xmath69 , @xmath70 of @xmath16 and @xmath18 using embedding of @xmath17 into a circulant matrix .",
    "calculate estimate @xmath71 of @xmath18 based on @xmath60 , @xmath69 and @xmath67 using .",
    "calculate estimate @xmath72 of @xmath16 based on @xmath0 , @xmath67 , and @xmath71 using .",
    "due to the fact that updating the estimate of @xmath17 is computationally complex , we also consider estimating @xmath17 under a more general assumption , called persymmetry , which simplifies the estimation algorithm .",
    "a @xmath20 matrix @xmath28 is a persymmetric matrix if it satisfies @xmath73 , where @xmath74 is the @xmath20 matrix with ones on its anti - diagonal ( the diagonal going from the lower left corner to the upper right corner ) , and zeros elsewhere .",
    "this means that a persymmetric matrix is symmetric with respect to its anti - diagonal .",
    "it is clear that a toeplitz matrix is also persymmetric .",
    "because there exists an analytical expression for the maximum likelihood estimator of a persymmetric covariance matrix @xcite , we also consider this case .",
    "when the persymmetric assumption is made about @xmath17 , the first step in algorithm  [ alg : algorithm1 ] is modified such that @xmath67 equals the maximum likelihood estimator for the persymmetric covariance matrix given @xmath69 and @xmath70 .",
    "it has the following form : @xmath75 , where @xmath76 and @xmath74 is defined above .",
    "we perform simulation studies to assess the accuracy of the estimation procedure given above using data dimensions that are relevant for the present context . in these simulation studies not only",
    "the overall accuracy is measured , but also accuracies of the individual components of the covariance matrix .",
    "the simulated data were generated from the @xmath77 distribution for @xmath32 positive definite , @xmath17 toeplitz matrix and @xmath18 diagonal matrix . in the simulations",
    "physiologically relevant parameter values were taken as obtained from data analysis of meg and eeg / fmri recordings .      in simulation studies ,",
    "the accuracy of our estimation method can be measured by making a direct comparison of the estimated covariance matrix @xmath78 with the true covariance matrix @xmath37 .",
    "we do this based on the relative mean squared error . in other words ,",
    "the value of @xmath79 is calculated , where @xmath80 denotes the frobenius norm of a matrix . to check",
    "how well the individual covariance components are recovered , we use the relative mean squared errors for @xmath81 separately :    [ mse_components ] @xmath82    we also assess the effect of taking into account the assumptions about @xmath17 and @xmath18 in the estimation procedure on the quality of the estimate . to do so , we estimate the components of the covariance matrix under modified assumptions about @xmath17 or @xmath18 and compare the accuracy of these estimates with the accuracy obtained under the correct assumptions about @xmath17 and @xmath18 .",
    "therefore each simulated data set , that is generated under model , is used as input for estimation of @xmath37 under several sets of assumptions .",
    "we explain here which assumptions we use in the estimation and why .",
    "the assumption about the spatial component , @xmath16 , is always that this matrix is positive definite , which is the weakest assumption that can be made . for the temporal component",
    ", we consider three alternative assumptions about @xmath17 in estimation .",
    "the options are : positive definite toeplitz , positive definite persymmetric and positive definite .",
    "the first possible assumption is the original assumption in model and the third one is the most general restriction that can be made about the covariance component .",
    "the persymmetric assumption is a compromise between the two in terms of the number of unknown parameters and computational complexity of the estimation algorithm .",
    "the three alternative assumptions used in the estimation of the epoch / trials matrix component @xmath18 are : positive definite diagonal , positive definite and identity assumption .",
    "while the diagonal assumption is the true assumption under , @xmath18 is also estimated under only positive definiteness to check how much the knowledge about its diagonal structure improves the accuracy of the estimator .",
    "@xmath83 is considered to quantify the effect of incorporating trial - to - trial variations on the quality of the covariance estimator .        to illustrate the usefulness of our method ,",
    "the model and estimation procedure were applied to an meg data set recorded on a subject exposed to nervus medianus stimulation of the left wrist with pseudo random interstimulus intervals .",
    "the meg was recorded on a whole head 151 channel ctf system , 3 bad channels were removed such that the data of @xmath84 gradiometers during the 30 minutes period at sampling frequency of 2084 hz were considered in the analysis .",
    "the meg recording was filtered using the order 1 butterworth bandpass filter with frequency bands of 0.5hz and 40hz .",
    "no baseline correction was performed , as this would potentially compromise temporal stationarity @xcite .",
    "the original sampling frequency was decreased to 521 hz by downsampling the signal . in the next step ,",
    "the data that correspond to measurements recorded just after the occurrence of the stimulus were extracted .",
    "the window of 384 milliseconds , which corresponds to @xmath85 time points , was used .",
    "a common response function was assumed for all trials and the average response was subtracted from the meg signal @xcite .    because @xmath84 of the gradiometer signals were taken and the stimulus occurred @xmath86 times during the recording , the dimension of the preprocessed data is @xmath87 .",
    "therefore the minimum requirement for the sample size in the model with three positive definite covariance components is satisfied for @xmath8 , which implies that analysis can be performed per subject .",
    "we used the same eeg - fmri data as were studied in @xcite .",
    "co - registered eeg - fmri data were acquired from 16 healthy subjects ( 7 males , mean age 27 , sd 9 years ) while they lay rested in the scanner avoiding to fall asleep .",
    "because the alpha activity is the most distinct aspect of the eeg signal for subjects that are awake and relaxed , we decided to select one subject with a large ( l ) and one with a small ( s ) amount of alpha oscillations .",
    "due to the use of average reference , the rank of each observation written as a matrix with rows corresponding to channels , was decreased by 1 .",
    "it means that the signal of one channel was fully determined by the signals of the remaining channels .",
    "therefore a positive definite spatial component @xmath16 could not be estimated from these data .",
    "we therefore removed the central channel from the data after taking average reference .",
    "fmri gradient and heartbeat artifacts and epochs with extreme outliers were removed .",
    "the eeg signal was filtered using a butterworth bandpass filter with frequency bands of 0.5hz and 40hz . because recordings from different epochs are assumed to be independent , the signal from the first 0.5 second and the last 0.5 second of each epoch was removed .",
    "the signal was downsampled such that 256 time points per epoch were obtained .",
    "dimensions of the preprocessed data ( @xmath88 ) were @xmath89 for subject l and @xmath90 for subject s.      the eeg regressor for the linear regression model is built from the estimate of the covariance matrix obtained from eeg under model . because diagonal elements of the estimate of @xmath18 capture changes in the variance level of eeg during fmri epochs and can be interpreted as measures of the amount of brain activity detected by eeg during particular fmri epochs , we define the @xmath18- regressor as the diagonal part of the estimate of @xmath18 .",
    "the values corresponding to isolated epochs that were removed were interpolated from the two values of the regressor from neighboring epochs . the regression model for fmri with the @xmath18- regressor",
    "is formulated in a similar way to @xcite , wherein the alpha power variations of a selected set of electrodes were used and the hemodynamic response function was estimated for each voxel using time shifted copies of the alpha power regressor . because the fmri signal is also modulated by several non - neural phenomenons , like heartbeats and subjects s motion , regressors that are related to those aspects",
    "are added as confounders to the regression model .",
    "we first consider two regression models that only differ by the regressors of interest , which are either shifts of the @xmath18- regressor or shifts of the alpha power regressor .",
    "next , the regression model in which the regressors of interest are shifts of the @xmath18- regressor with shifts of the alpha power regressor added to the set of confounders is used .",
    "for the three models significance of regressors of interest ( shifts of @xmath18- regressor or shifts of alpha power regressor ) is tested by a partial f - test . to account for multiple testing",
    ", we control the false discovery rate ( fdr ) by applying the multiple testing correction of benjamini and hochberg @xcite .      the measure can not be used for model validation for experimental data sets , because the true values of the parameters are unknown in such case . to assess how well model fits the data",
    ", we estimated the covariance matrix under using subselections of epochs / trials as follows .",
    "the set @xmath91 of indices of epochs / trials was divided into 4 disjoint subsets of approximately equal sizes ( @xmath92 ) and data corresponding to each subset were used for estimation .",
    "the estimates were compared with the estimate obtained from the whole sample , @xmath78 , by : @xmath93 where @xmath94 denotes the estimate obtained from subsample @xmath95 and @xmath96 is equal to @xmath97 restricted to columns and rows with indices from @xmath95 .    the first check is whether different epochs / trials share the same spatio - temporal pattern .",
    "for this purpose , the subsets @xmath98 , @xmath99 , @xmath100 , @xmath101 are generated randomly .",
    "this procedure is repeated 10 times , such that in total 40 values of are be obtained .",
    "it is desirable that all of these values are low .",
    "the second check is whether there are no time - related changes of the spatio - temporal pattern not accounted for by @xmath18 .",
    "now indices are subdivided such that approximately the first quarter of the sorted indices is the first subsample , the second quarter is the second subsample etc . here ,",
    "again , the measure is used to assess the differences between estimates obtained from a subsample to the estimate acquired from the whole sample .",
    "it is desirable that all of these values are also low , because large values might indicate that the spatio - temporal covariance matrix @xmath102 is time - dependent .",
    "the `` true '' values for @xmath31 , which satisfy the assumptions of model , that were used in the simulations are the estimated values from the meg and eeg experimental data analyses presented below ( visualized in figures [ matrices_meg ] and [ matrices_low_alpha ] ) . for both studies",
    "the necessary requirement regarding the sample size in relation to the dimensions of the covariance components was satisfied .",
    "a number of 60 data sets were simulated for eeg and meg . each sample ,",
    "which was simulated under model , was used for estimation under 7 different sets of assumptions about the components . for each estimated covariance matrix",
    "the relative mean squared error and relative mean squared errors of individual components of the covariance matrix were calculated .",
    "means of @xmath103s for each set of assumptions are given in table [ assumptions_influence ] and means of @xmath104s , @xmath105s , and @xmath106s are given in figure [ mse_ingredients ] .",
    "the covariance matrix and its components were most accurately recovered if all assumptions from were taken into account in the estimation .     for @xmath107",
    "is the one of model .,title=\"fig : \" ]   for @xmath107 is the one of model .,title=\"fig : \" ]     type&of each&&according to + & data set & & + & & @xmath16:&@xmath17:&@xmath18 : & + meg&@xmath84&u&t&d&1.3e-04 ( 100% ) + & @xmath85&u&p&d&1.5e-04 ( 115% ) + & @xmath86&u&u&d&1.8e-04 ( 139% ) + & @xmath8&u&t&i&1.1e-03 ( 846% ) + & & u&u&i&1.2e-03 ( 924% ) + & & u&t&u&1.72e-02 ( 1324% ) + & & u&u&u&1.74e-02 ( 1339% ) + eeg&@xmath108&u&t&d&2e-04 ( 100% ) + & @xmath109&u&p&d&4e-04 ( 200% ) + & @xmath110&u&u&d&6.8e-04 ( 340% ) + & @xmath8&u&t&i&1.4e-02 ( 7000% ) + & & u&u&i&1.5e-02 ( 7500% ) + & & u&t&u&3.7e-02 ( 18500% ) + & & u&u&u&3.9e-02 ( 19500% ) +        model was assumed for the preprocessed sef meg trials of one subject .",
    "the estimates of the covariance components @xmath81 were determined using our iterative procedure .",
    "the results are visualized in figure [ matrices_meg ] .",
    "temporal covariances show decaying oscillations of approximately 10hz .",
    "this is the effect of alpha activity , which was dominant in the meg of this subject , as indicated by the highest peak in the estimate of the average power spectrum .",
    "higher spatial variances are on the left side of the brain .",
    "this can be related to the fact that the right side of the brain was stimulated .",
    "estimates of trial - to - trial variations , which are also visualized , show little variability for this subject .    )",
    "projected onto the head model .",
    "values in between channels were interpolated .",
    "upper - right : estimates of trial - to - trial variations ( diagonal entries of the estimate of @xmath18 ) .",
    "lower : estimate of the average power spectrum.,title=\"fig : \" ] ) projected onto the head model .",
    "values in between channels were interpolated .",
    "upper - right : estimates of trial - to - trial variations ( diagonal entries of the estimate of @xmath18 ) .",
    "lower : estimate of the average power spectrum.,title=\"fig : \" ]    the model validation was done according to section [ validation ] . for the random subselection of trials , the average of was @xmath111 and the standard deviation @xmath112 .",
    "if subsets of data were created from consecutive trials , the values of were equal to @xmath113 .",
    "these values are very low , which means that the spatio - temporal covariance @xmath102 does not vary much over time .      preprocessed eeg data of subjects s and l were used as inputs for individual covariance estimation under",
    ". results for subject l are visualized in figure [ matrices_eeg_high_alpha ] and for subject s in figure [ matrices_low_alpha ] .",
    "these figures show the estimates of spatial , temporal and epoch - related covariance components . the amount of alpha activity , that is expressed by the shape of the estimated power spectrum , is reflected by the estimate of the temporal covariance component : in figure [ matrices_eeg_high_alpha ] there are clear alpha oscillations , while in figure [ matrices_low_alpha ] such oscillations are absent .     for meg data.,title=\"fig : \" ]   for meg data.,title=\"fig : \" ]    the model validation was done for both subjects , again according to section [ validation ] . for subject s for the random subselection of epochs the average of was @xmath114 and the standard deviation @xmath115 , and for the consecutive subselection of epochs the values of were equal to @xmath116 .",
    "these values are low , which suggests that the spatio - temporal covariance pattern was captured by the model .",
    "the results for subject l were similar .",
    ".,title=\"fig : \" ] .,title=\"fig : \" ]      significance of the two sets of regressors of interest ( shifts of the @xmath18- regressor and shifts of the alpha power regressor ) was tested by the partial f - test conditionally on the same set of confounders with fdr=0.01 .",
    "since the test was done for each voxel , those voxels for which regressors of interest were significant , are indicated in the axial brain slices in figure [ kp_alpha_sig_fdr_0.01 ] .",
    "we use the term significant voxels , which denotes voxels for which regressors of interest turned out to be significant for fdr=0.01 .",
    "there are noticeable differences in the number of significant voxels between subjects and also between the two models . for subject",
    "l there are more significant voxels when the alpha power regressor is used .",
    "nevertheless the areas occupied by such voxels for the two models are quite similar . for subject",
    "s the situation is different .",
    "namely , the number of significant voxels is similar , but their location is different for the two models .",
    "if the alpha power regressor is used , significant voxels are mostly located in the occipital lobe while if the @xmath18- regressor is used , many significant voxels are in the frontal lobe",
    ".    - regressor are significant at fdr=0.01 .",
    "lower , from red to yellow : voxels for which shifts of the alpha power regressor are significant at fdr=0.01 .",
    "subjects are marked on y axes , where l denotes the subject with large , and s with small amount of alpha activity .",
    "the lighter colors indicate more significant voxels than the darker colors within one subject and one group of regressors.,height=94 ]    - regressor are significant at fdr=0.01 .",
    "lower , from red to yellow : voxels for which shifts of the alpha power regressor are significant at fdr=0.01 .",
    "subjects are marked on y axes , where l denotes the subject with large , and s with small amount of alpha activity .",
    "the lighter colors indicate more significant voxels than the darker colors within one subject and one group of regressors.,height=94 ]    in order to localize the regions for which addition of shifts of the @xmath18- regressor to the model with shifts of the alpha power regressor ( and confounders ) significantly improves the model , the partial f - test at fdr=0.01 was applied for the shifts of the @xmath18- regressor , conditionally on the confounders and shifts of the alpha power regressor , see figure [ kp_cond_alpha ] .",
    "the results show that there are hardly any significant voxels for subject l. for subject s , however , many voxels are significant , which are mostly located in the frontal regions .",
    "we made a direct comparison of shapes of the alpha regressor and the @xmath18- regressor for both subjects , see figures [ regressors_comparison_high_alpha ] and [ regressors_comparison_low_alpha ] .",
    "it appears that there is a more pronounced difference between the two sets of regressors for subject s , as spearman s rank correlation coefficient between the two regressors equals 0.218 for this subject and 0.316 for subject",
    "l.    - regressor conditionally on confounders and shifts of alpha regressor was rejected at fdr=0.01 .",
    "upper figures represent the results for subject l and lower for subject s. the brain areas from red to yellow correspond to significant voxels .",
    "the lighter colors indicate more significant voxels than the darker colors within one subject.,height=94 ]    - regressor and alpha regressor extracted from eeg of subject l. left : scatter plot of the two regressors .",
    "right : time series plots of the two regressors ; upper : @xmath18 regressor , lower : alpha power regressor.,title=\"fig:\",height=151 ] - regressor and alpha regressor extracted from eeg of subject l. left : scatter plot of the two regressors .",
    "right : time series plots of the two regressors ; upper : @xmath18 regressor , lower : alpha power regressor.,title=\"fig:\",height=151 ]     , but here for a subject s.,title=\"fig:\",height=151 ]   , but here for a subject s.,title=\"fig:\",height=151 ]",
    "the introduced model for the covariance of eeg / meg incorporates local stationarity of the data and variations in the noise level over epochs / trials .",
    "these aspects are visible in the data , but are not taken into account in the earlier approaches that used as covariance model a kronecker product of two components e.g.  @xcite . therefore in this study the local stationarity was explicitly imposed by assuming that the temporal covariance component has a toeplitz structure .",
    "moreover , a third component was added into the kronecker product , describing the amplitude variations of the brain s background activity .",
    "these model extensions contribute to a more precise description of the underlying physiology of eeg and meg signal generation .",
    "for instance in @xcite evidence has been found that the amplitude of the background activity predicts the chance that a stimulus is consciously perceived by the subject .",
    "also other studies suggest that the brain s background activity is not simply additive noise @xcite .",
    "however , in order to test such hypothesis in a formal statistical setting , accurate mathematical models are needed and we consider our three domain covariance model as a next step towards such models .",
    "the parameterization of the covariance matrix via the kronecker product of three matrices and the assumptions imposed on these matrices provide a great dimension reduction of the unknown parameters and make it possible to estimate the covariance matrix per subject ( @xmath8 ) .",
    "it needs to be stated that only partial theoretical results are available in the literature about the properties ( existence , uniqueness and accuracy ) of the maximum likelihood estimator of the covariance matrix that is a kronecker product of two or more components @xcite .",
    "we performed simulation studies based on the data that resemble eeg / meg , with @xmath8 , to assess the accuracy of the estimation procedure if model holds .",
    "results clearly show that the estimates are very close to the true covariance matrix that was used for data generation",
    ". therefore one can expect to obtain reliable estimation results if our model fits the data .",
    "another aspect that was investigated using simulated data from model is the influence of incorporating variations in the noise level over trials and stationarity of the signal within each trial in the estimation , given that there is variation in noise level and stationarity of the signal .",
    "it was assessed how accuracy of the covariance estimator changes if each of these assumptions is dropped in the estimation . moreover , the estimate under model was compared to the estimate if estimation was done assuming no trial - to - trial variations .",
    "the results show that correct assumptions about the components of the covariance matrix in the estimation procedure provide the most accurate estimate .",
    "it turns out that the toeplitz assumption about @xmath17 does not have a strong effect on the accuracy of the covariance estimate .",
    "however , a high drop in accuracy is observed when no trial - to - trial variations are assumed , i.e. when @xmath83 or when diagonality of @xmath18 is skipped . the gain in accuracy related to estimating the trial - to - trial variations is higher for simulated eeg data than for simulated meg data . this can be explained by the fact that higher trial - to - trial variations are observed in our eeg sample than in our meg sample .",
    "accuracies of estimates of the individual components of the covariance matrix were determined for all simulated samples and under each set of assumptions .",
    "it turns out that the quality of @xmath117 is comparable under each set of assumptions .",
    "however , the accuracy of @xmath118 can be affected by the assumption about @xmath18 , which happens when no trial - to - trial variations are assumed . in such case",
    "the accuracy of both @xmath118 and @xmath97 decreases .",
    "one could argue that the amount of variation per epoch could be estimated by simply treating signals from all channels and the same epoch as realizations of the univariate normal distribution with unknown variance parameter and estimating this parameter .",
    "nevertheless , such an approach is not recommended , because the estimates would also capture variability of the most varying channels . in our approach",
    "@xmath18 represents the activity in different epochs corrected for temporal and spatial effects that are intertwined with these measures .",
    "the method of estimating @xmath17 under the toeplitz assumption requires a certain size of the circulant extension to assure convergence to the maximum likelihood estimator . satisfying this requirement , however , is not feasible in practice on a single machine and it would lead to increased memory consumption and computation time on a multicore machine . for these reasons",
    "we take one of the smallest possible sizes of the extension , @xmath119 .",
    "we infer from our simulation studies that this size of the circulant extension provides an accurate approximation of the covariance estimate .",
    "nevertheless , there exists a way of simplifying the estimation step of @xmath17 in terms of computational complexity and computational time .",
    "this is achieved by relaxing the toeplitz assumption about @xmath17 and imposing a weaker , persymmetric , assumption . in such case",
    "the likelihood equation for @xmath17 , which would replace , can be solved analytically .",
    "however , one needs to be aware that estimating @xmath17 under the persymmetric assumption is associated with a decreased accuracy of the estimate of @xmath17 if the true @xmath17 is a toeplitz matrix .",
    "diagonality of the newly introduced covariance component reflects independence between different epochs / trials .",
    "this a natural assumption for the stimulus evoked data , because the post - stimulus trials are extracted from the continuous signal such that the time points that correspond to different trials are separated by hundreds of milliseconds . on the other hand , from eeg / fmri experiment ,",
    "the eeg signal is naturally divided into epochs that are defined by the fmri scans .",
    "hence , part of the data in between each two consecutive epochs needs to be removed to assure independence between epochs .",
    "fortunately , since dependence over time is short , the removed part can be small .    in this paper",
    "we have given one illustration that shows the benefit of our method in the context of eeg / fmri data . in a future study",
    "we will investigate the improvement of dipole localization in evoked response recordings when this new covariance framework is used instead of a covariance model that does not include the epoch / trial component @xmath18 .",
    "yet another application of our method is the possibility of doing connectivity analysis on sensor level based on spontaneous eeg / meg data using the estimated spatial covariance component @xmath117 .",
    "although existing covariance models already yield estimated spatial components , the @xmath117 that is output by our method is more reliable since it is corrected for the temporal and epoch / trial covariance patterns .    in sum , we have shown that our new covariance framework is a useful tool for analysis of eeg / meg data in different contexts .",
    "it allows estimating a positive definite covariance matrix if the data of only one subject are available .",
    "moreover , from the simulation studies we can conclude that the covariance estimate obtained with our iterative algorithm based on model is very accurate if model is plausible for the data .",
    "our method can be used to analyze different eeg / meg data sets . in the context of eeg - fmri",
    ", the regressor extracted from eeg can be used as input for an integrated eeg - fmri model , to model eeg variation independently of the choice of a specific frequency band or electrode site .",
    "we explain here how the problem of estimating a toeplitz covariance matrix in our setting , where there are two additional components of the covariance matrix , is related to the problem in which a toeplitz covariance matrix is estimated under the model without additional components .",
    "let @xmath120 and @xmath121 be positive definite square roots of @xmath122 and @xmath123 respectively .",
    "if @xmath68 are defined as in , then the columns of @xmath124 $ ] are independent and have a @xmath125 distribution . because the true covariance components @xmath56 are not known , we use their current estimates and define @xmath126 for @xmath127 . given @xmath117 and @xmath97 , the columns of @xmath128",
    "$ ] can be treated as independent vectors having a @xmath125 distribution .",
    "therefore they can be used in the estimation of the toeplitz covariance matrix @xmath17 .",
    "there are @xmath129 columns in total , therefore the effective sample size in the estimation of @xmath17 equals @xmath130 . finally , we denote the columns of @xmath131 by @xmath132 .      if @xmath132 are independent realizations of @xmath125 and @xmath17 is a positive definite toeplitz matrix defined by its first row @xmath133 $ ] , the likelihood function equals @xmath134 and the maximum likelihood estimator of @xmath17 must satisfy the property @xmath135 for @xmath136 .",
    "it holds that @xmath137 and for calculating @xmath138 and @xmath139 , the following equalities will be used , @xcite : @xmath140 for any @xmath20 matrix @xmath28 . using the first equality , the chain rule , and the symmetry of @xmath17",
    ", it follows that @xmath141 if @xmath142 , then from the second equality and the chain rule , we have that @xmath143 therefore @xmath144 because @xmath17 is symmetric and has a toeplitz structure , it holds that @xmath145 where @xmath146 has ones on @xmath147th subdiagonals and zeros elsewhere .",
    "therefore , from , and , we see that the likelihood equations @xmath148 , @xmath136 are @xmath149 they are satisfied if and only if @xmath150 which can be expressed as @xmath151 which is the same as , if one takes into account the definition of @xmath28 , the relationship between @xmath132 and @xmath68 , and the definition of @xmath50 given below .      to estimate @xmath17 by maximum likelihood , one can use the fact that a circulant positive definite covariance matrix can be estimated directly by maximum likelihood .",
    "if @xmath64 is an @xmath152 positive definite circulant matrix , it can be parameterized as @xmath153 with @xmath154 , for @xmath155 .",
    "if @xmath156 are independent random vectors having a @xmath157 distribution and @xmath158 is the sample covariance matrix , the maximum likelihood estimators of the entries of the circulant covariance matrix equal @xmath159 for @xmath160 , @xcite .",
    "this means that @xmath161 is the average of entries of the sample covariance matrix that correspond to positions of @xmath162 in @xmath64 .",
    "if @xmath163 , then the @xmath20 upper left block of @xmath64 is a positive definite toeplitz matrix .",
    "if @xmath164 is sufficiently large , then for any given @xmath17 that is toeplitz and positive definite , there exists an @xmath152 circulant non - negative definite covariance matrix in which @xmath17 can be embedded , @xcite .",
    "the idea is to estimate @xmath64 and the upper left block of this estimate will be the estimate of the toeplitz covariance matrix @xmath17 .",
    "the problem is that estimating @xmath64 requires vectors @xmath156 of length @xmath165 , while we only have data consisting of vectors @xmath132 of length @xmath7 .",
    "however , one can use the expectation maximization algorithm @xcite , which uses the available data and the current estimate of the circulant covariance matrix @xmath166 to replace the missing data by their expectations conditioned on @xmath132 and @xmath166 .",
    "then these data are used to update the estimate of the circulant component .",
    "this alternating procedure is repeated until convergence .",
    "the upper left block of the final estimate of @xmath64 is our numerical approximation of the maximum likelihood estimate of the toeplitz covariance matrix @xmath17 .",
    "estimates of @xmath31 are updated iteratively , using algorithm  [ alg : algorithm1 ] , in which updating an estimate of @xmath17 given current estimates of @xmath16 and @xmath18 is done in an inner loop .",
    "let @xmath167 be the iteration index of the outer loop of algorithm  [ alg : algorithm1 ] .",
    "let @xmath168 be the initial value for the toeplitz covariance matrix with its circulant extension @xmath169 .",
    "if @xmath170 , we take @xmath169 equal to the identity matrix , otherwise we take the initial value from the iteration @xmath171 of algorithm  [ alg : algorithm1 ] : @xmath172 .",
    "the @xmath147th step of the estimation procedure for @xmath67 consists of the following steps :    1 .   define @xmath173 by @xmath174^{-1}= \\begin{bmatrix }",
    "\\tilde{a}^{(i ) } & \\tilde{p}^{(i)t } \\\\",
    "\\tilde{p}^{(i ) } & \\left(\\tilde{u}^{(i)}\\right)^{-1 } \\end{bmatrix},\\end{aligned}\\ ] ] where @xmath175 is an @xmath176 matrix , @xmath177 is a @xmath178 matrix .",
    "e - step : compute estimate of data @xmath179 for @xmath180 .",
    "3 .   compute @xmath181 4 .",
    "m - step : maximize the likelihood with respect to the circulant covariance matrix using @xmath182 , by formula .",
    "denote the maximizer by @xmath183 .",
    "these steps are repeated until convergence .",
    "an approximation of the estimate of the toeplitz covariance matrix @xmath17 is the @xmath20 upper left block @xmath184 of the final estimate of the circulant covariance matrix @xmath185 .",
    "if @xmath69 and @xmath70 are the current estimates of @xmath16 and @xmath18 , the update of the toeplitz component will be @xmath186 with its circulant extension @xmath187 .",
    "@xcite and @xcite give conditions for @xmath165 that guarantee convergence to a maximum likelihood estimator of a toeplitz covariance matrix , but they are impractical in our context .",
    "instead we use @xmath119 , which is feasible in practice .",
    "moreover , we conclude from the simulation studies that our estimation procedure provides accurate estimates of @xmath17 .",
    "this work was financially supported by a star - cluster grant from the netherlands organization of scientific research .",
    "de  munck , j. , huizenga , h. , waldorp , l. , and heethaar , r. ( 2002 ) .",
    "estimating stationary dipoles from meg / eeg data contaminated with spatially and temporally correlated background noise .",
    ", 50(7):15651572 .",
    "moosmann , m. , ritter , p. , krastel , i. , brink , a. , thees , s. , blankenburg , f. , taskin , b. , obrig , h. , and villringer , a. ( 2003 ) .",
    "correlates of alpha rhythm in functional magnetic resonance imaging and near infrared spectroscopy . , 20(1):145  158 ."
  ],
  "abstract_text": [
    "<S> in this paper we introduce a covariance framework for the analysis of eeg and meg data that takes into account observed temporal stationarity on small time scales and trial - to - trial variations . </S>",
    "<S> we formulate a model for the covariance matrix , which is a kronecker product of three components that correspond to space , time and epochs / trials , and consider maximum likelihood estimation of the unknown parameter values . </S>",
    "<S> an iterative algorithm that finds approximations of the maximum likelihood estimates is proposed . </S>",
    "<S> we perform a simulation study to assess the performance of the estimator and investigate the influence of different assumptions about the covariance factors on the estimated covariance matrix and on its components . apart from that , </S>",
    "<S> we illustrate our method on real eeg and meg data sets .    </S>",
    "<S> the proposed covariance model is applicable in a variety of cases where spontaneous eeg or meg acts as source of noise and realistic noise covariance estimates are needed for accurate dipole localization , such as in evoked activity studies , or where the properties of spontaneous eeg or meg are themselves the topic of interest , such as in combined eeg / fmri experiments in which the correlation between eeg and fmri signals is investigated . </S>",
    "<S> +   + * _ keywords : _ * kronecker product structure , covariance structure , maximum likelihood , eeg , meg , fmri    ^a^ department of mathematics , faculty of exact sciences , vu university amsterdam , de boelelaan 1081 , 1081 hv , amsterdam , the netherlands + ^b^ department of physics and medical technology , vu university medical center , de boelelaan 1118,1081 hz amsterdam , the netherlands + </S>"
  ]
}