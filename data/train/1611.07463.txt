{
  "article_text": [
    "let @xmath0 be a group and @xmath1 be an element of the commutator subgroup @xmath2 $ ] , the _ commutator length _ of @xmath1 , denoted @xmath3 , is the minimal number @xmath4 such that @xmath5[a_2,b_2]\\cdots[a_n , b_n]$ ] for some @xmath6 , and the _ stable commutator length _ of @xmath1 , denoted @xmath7 , is the limit @xmath8 which always exists by subadditivity .",
    "it is obvious from the definition that @xmath9 has the following basic properties :    1 .",
    "monotone : for any homomorphism @xmath10 and @xmath11 $ ] , we have @xmath12 ; 2 .",
    "characteristic : for any @xmath13 and @xmath11 $ ] , @xmath14 .",
    "it follows that the _ spectrum _ , the set of values that @xmath15 takes , is invariant under isomorphisms .",
    "however , @xmath9 is notoriously difficult to compute if it does not vanish .",
    "thus many interesting questions about the spectrum are extremely hard to answer .",
    "gromov ( @xcite ) asked whether the spectrum is rational ( or perhaps algebraic ) when @xmath0 is finitely presented .",
    "a counter example was found by zhuang ( @xcite ) . on the other hand",
    ", calegari showed that @xmath9 is rational and can be computed efficiently in a free group ( @xcite ) by interpreting and studying @xmath9 in terms of surface maps .",
    "he later showed that a modification of the geometric argument proves rationality of scl in free products of abelian groups ( @xcite ) .",
    "we generalize this latter result , substantially weakening the assumption that the factors are abelian .",
    "[ rationality ] let @xmath16 with @xmath17 for each @xmath18 , then @xmath9 is piecewise rational linear in @xmath0 .",
    "this holds , for example , when all @xmath19 are amenable .",
    "see remark [ vanscl ] for a list groups having vanishing scl .",
    "a homomorphism @xmath10 for which @xmath20 for all chains @xmath21 ( see section [ sec2 ] ) is said to be _ isometric _ for scl .",
    "injections admitting a retract are isometric .",
    "it is shown by calegari - walker ( @xcite ) that random homomorphisms between free groups are isometric for scl . in this paper , we show that isometric embeddings ( injective and isometric ) are preserved under taking free products :    let @xmath22 be a family of isometric embeddings , then so is the induced map @xmath23 .    a spin - off of the techniques used in the proof is a new method to compute scl ; we give examples in section [ app ] .",
    "in particular , these techniques give new insights for scl in families .",
    "it was proved by calegari - walker that for free products of free abelian groups , certain families of words @xmath24 ( called surgery families ) are eventually a ratio of two quasi - polynomials in @xmath4 .",
    "a similar question was studied by walker : for any fixed rational chain @xmath21 in @xmath25 , and any @xmath26 , with @xmath27 , let @xmath28 be the image of @xmath29 under the natural homomorphism @xmath30 , how does @xmath31 vary as a function of @xmath32 ?",
    "it was observed experimentally by walker ( @xcite ) that some interesting periodicity comes into @xmath31 , and he conjectured that the result is piecewise quasi - linear in @xmath33 ( see conjecture [ conj ] ) . in section [ wconj ]",
    "we give experimental examples to disprove this , but prove a weaker version : @xmath31 is piecewise quasi - rational in @xmath32 ( see theorem [ weakwconj ] ) .",
    "it was pointed out by timothy susse after the post of the first version that he had proved the same result earlier in @xcite corollary 4.14 using a different approach .",
    "it is worth mentioning that the method in this paper can be used to generalize and give a new approach to the spectral gap theorem by duncan - howie @xcite , which will be discussed in another paper @xcite .",
    "we first give basic definitions in section [ sec2 ] .",
    "then in section [ sec3 ] we introduce a way , following @xcite , to use a finite dimensional polyhedral cone to encode surface maps into a wedge of spaces with given boundary information .",
    "the encoding loses information , so in section [ sec4 ] we study a nonlinear optimization problem on the fibers .",
    "this reduces the computation of scl to a lattice point problem , which we solve , deducing theorem [ rationality ] and theorem [ isoemb ] .",
    "when scl vanishes in each factor , the non - linearity comes from _ disk vectors _ , which become complicated compared to the abelian case discussed in @xcite . in section [ app ]",
    ", we apply our method to give generalizations and new proofs of old results , where we also prove a formula conjectured by alden walker in @xcite . finally in section [ wconj ] we study walker s conjecture and prove a weaker ( correct ) version .",
    "the author thanks his advisor danny calegari for insightful introduction to this topic .",
    "the author also thanks timothy susse and alden walker for useful conversations .",
    "in this section we give the definitions and basic facts about scl that we will use .",
    "all of these can be found in @xcite .",
    "let @xmath34 be a compact surface .",
    "define @xmath35 where @xmath36 are the components of @xmath34 and @xmath37 is the euler characteristic .",
    "equivalently , @xmath38 is the euler characteristic of @xmath34 after removing disk and sphere components",
    ".    let @xmath39 ( @xmath40 ) such that their product represents @xmath41 in @xmath42 .",
    "let @xmath43 be a @xmath44 , @xmath45 be a loop representing the conjugacy class of @xmath46 and @xmath47 .",
    "a compact oriented surface @xmath34 together with a map @xmath48 is called _ admissible _ of degree @xmath49 if the following diagram commutes @xmath50 where @xmath51 is the inclusion and @xmath52=n(s)[l]$ ] .",
    "define @xmath53 over all admissible surfaces .    if @xmath54 , the geometric definition agrees with the algebraic one ( @xcite , proposition 2.10 ) .",
    "we ( informally ) say a surface map is _ efficient _ if @xmath55 is close to @xmath56 .",
    "[ sameori ] a priori the degrees on different components of @xmath57 could have opposite signs .",
    "such an admissible surface can be replaced by another one that is at least as efficient as @xmath34 , by taking suitable finite covers and gluing components with opposite orientation together .",
    "thus one may restrict attention to _",
    "admissible surfaces , i.e. @xmath58 is orientation preserving ( @xcite , proposition 2.13 ) .",
    "recall the complex of real group chains @xmath59 whose homology is @xmath60 , the real group homology of @xmath0 . in the sequel , we write @xmath61 for @xmath62 , the 1-boundaries .",
    "scl is defined on integral 1-boundaries , and has a unique continuous linear extension to a pseudo - norm on @xmath61 , which vanishes on @xmath63 thus scl descends to a pseudo - norm on the quotient .",
    "see @xcite for details .",
    "define @xmath64 .",
    "we say scl is _ piecewise rational linear _ if it is piecewise rational linear on every finite dimensional rational subspace of @xmath65 .",
    "we say a group homomorphism @xmath66 is an _",
    "isometric embedding _ if @xmath67 is injective and the induced map @xmath68 preserves scl , i.e. @xmath69 for all @xmath70 .",
    "the simplest isometric embeddings come from retracts .",
    "[ retract ] let @xmath71 and @xmath72 be group homomorphisms such that @xmath73 , then @xmath51 is an isometric embedding .",
    "[ finiteness ] in particular , calculation of scl in a free product of infinitely many groups reduces to computations in the free product of finitely many groups .",
    "proposition [ retract ] follows immediately from monotonicity of scl .",
    "in this section , we introduce the method from @xcite to encode admissible surface maps into a wedge of spaces as vectors in a finite dimensional rational polyhedron .    in the sequel , fix @xmath74 to be a free product of two groups @xmath75 and @xmath76 .",
    "since every finite dimensional rational subspace of @xmath65 is a rational subspace of @xmath77 , for some finite subset @xmath78 of nontrivial conjugacy classes in @xmath0 , we fix such a @xmath78 and study the restriction of scl to @xmath77 .",
    "we assume there are no torsion elements in @xmath78 since @xmath79 in @xmath65 if @xmath1 is of order @xmath4 .",
    "let @xmath80 and @xmath81 be a @xmath82 and @xmath83 respectively , then @xmath84 is a @xmath44 with wedge point @xmath85 . by choosing appropriate loops to represent elements of @xmath78 , we get an oriented closed 1-manifold @xmath86 ( one component for each element of @xmath78 ) together with a map @xmath87 such that",
    "for each component @xmath88 :    1 .",
    "either @xmath89 is disjoint from @xmath85 and thus contained entirely in @xmath80 or @xmath81 ( referred to as _ self loops _ ) ; 2 .   or @xmath90 cuts @xmath88 into finitely many intervals , each mapped alternately to a based loop in one of @xmath80 and @xmath81 .",
    "therefore , @xmath91 has finitely many components , each taken to a loop contained in one of @xmath80 and @xmath81 ( see figure [ lex ] ) .",
    "let @xmath92 and @xmath93 be the set of components taken to @xmath80 and @xmath81 respectively .",
    "now for any surface @xmath48 admissible for an integral class in @xmath77 , we may assume up to a homotopy that @xmath94 is a ( possibly disconnected ) covering map , and assume @xmath67 is transverse to @xmath85 , i.e. @xmath95 is a finite disjoint union of embedded loops and proper arcs .",
    "we may also assume ( by remark [ sameori ] ) @xmath94 is orientation preserving .",
    "we can eliminate loops in @xmath96 by compressing the innermost one each time , which does not increase @xmath97 .",
    "each proper arc in @xmath96 is essential in @xmath34 since @xmath58 is a covering .",
    "so from now on , we assume that @xmath96 consists of ( essential ) proper arcs .",
    "let @xmath98 and @xmath99 be @xmath100 and @xmath101 respectively , and we focus on @xmath98 in the rest of this section .",
    "@xmath98 is a surface with corners , and each component of @xmath102 either covers a self loop mapped to @xmath80 , or can be decomposed into arcs alternating between components of @xmath96 and arcs mapped to elements in @xmath92 ( see figure [ sasb ] ) .",
    "note that the corners of @xmath98 are exactly @xmath103 , thus the orbifold euler characteristic of @xmath98 @xmath104 and @xmath34 can be obtained by gluing @xmath98 and @xmath99 along @xmath96 , hence @xmath105    also note that each component of @xmath96 with orientation induced from @xmath98 goes from one element of @xmath92 to another , and thus can be encoded as an ordered pair of these two elements of @xmath92 .",
    "although elements of @xmath92 corresponding to self loops do not appear in this way , it is convenient to encode a component of @xmath102 that covers a self loop @xmath106 with degree @xmath4 as @xmath107 , thus we define @xmath108    let @xmath109 and @xmath110 be the @xmath111-vector spaces with bases @xmath92 and @xmath112 respectively , then we can encode the surface @xmath98 as a vector @xmath113 in @xmath110 as follows : each component of @xmath96 is encoded as an element of @xmath112 described as above , each component of @xmath102 that covers some self loop @xmath106 with degree @xmath4 is encoded as @xmath107 , and @xmath113 is defined to be the sum of these vectors in @xmath110 .    obviously , @xmath113 is a non - negative integer vector in @xmath110 , and it satisfies two more linear constraints . define a ( rational ) linear map @xmath114 by @xmath115 , then @xmath116 since every boundary components of @xmath98 closes up .",
    "define @xmath117 by @xmath118 , where @xmath119 is the abelianization of @xmath75 , then @xmath120 is just the image of @xmath121 $ ] in @xmath122 , which is @xmath41 since it bounds @xmath98 .",
    "[ va ] let @xmath123 be the convex rational polyhedral cone of non - negative vectors @xmath124 satisfying @xmath125 and @xmath126 .",
    "the discussion above shows that @xmath113 is an integer vector in @xmath123 for any such @xmath98 .",
    "conversely , for any integer vector @xmath127 , since @xmath125 , the sum @xmath128 actually defines an integral homology class in @xmath129 , whose image under @xmath130 is @xmath126 .",
    "hence there is a positive integer @xmath4 such that the integral homology class given by @xmath131 is trivial and thus bounds some ( actually many ) surface(s ) .",
    "the same thing holds for rational vectors in @xmath123 .",
    "we summarize this as a lemma for later use .",
    "[ qvec ] @xmath113 is an integer vector in @xmath123 .",
    "conversely , for any rational vector @xmath127 , there is an integer @xmath132 such that @xmath133 for some @xmath98 .",
    "such an encoding reduces the huge space of admissible surfaces to a finite dimensional space .",
    "however , this reduction comes at a cost .",
    "there are many different surfaces @xmath98 encoded as the same @xmath113 , thus we are led to the following optimization problem : given @xmath134 , a rational vector in @xmath123 , what is the infimum of @xmath135 over all surfaces @xmath98 with @xmath136 for some @xmath4 . ?",
    "we address this in the next section .",
    "now we study the optimization problem discussed above . we follow @xcite , except that there are significant new issues because the factors are non - abelian .",
    "the key observation is lemma [ keylemma ] .    for any rational vector @xmath137 ,",
    "define @xmath138    as we saw in section [ sec3 ] , @xmath139 .",
    "the number of components of @xmath96 is a linear function @xmath140 in @xmath113 defined as follows : on the basis , @xmath141 is @xmath142 if @xmath143 , and is @xmath41 if otherwise ; then extend by linearity .",
    "@xmath140 is just the @xmath144 norm if there is no self loop .",
    "therefore , @xmath145 note that the second term is quite similar to the definition of @xmath146 , but @xmath98 could have disk components and @xmath102 could be admissible for different chains in @xmath147 .",
    "we first deal with disk components .",
    "@xmath127 is a _ disk vector _ if @xmath134 encodes some disk .",
    "denote the set of disk vectors by @xmath148 . for @xmath127 ,",
    "we say @xmath149 is an _ admissible expression _ if @xmath150 , @xmath151 and @xmath152 .",
    "define @xmath153    roughly speaking , @xmath154 is the maximal `` number '' of disk vectors that can be subtracted from @xmath134 . in the case where scl vanishes on @xmath147 , we have    [ chi0scl0 ] if scl vanishes on @xmath147 , then @xmath155 for any rational vector @xmath127 .",
    "this is equivalent to showing that @xmath156 by equation ( [ chi0 ] ) .",
    "suppose @xmath157 for some @xmath158 , let @xmath159 be the disk components of @xmath98 and @xmath160 , then @xmath161 and @xmath162 is an admissible expression .",
    "then @xmath163 and thus @xmath164 , this proves the `` @xmath165 '' direction .",
    "conversely , for any given @xmath166 , there is an admissible expression @xmath149 where @xmath167 .",
    "we may assume each @xmath168 is rational , then @xmath169 is also rational since @xmath134 is .",
    "hence there is an integer @xmath132 such that each @xmath170 is an integer and @xmath171 for some @xmath172 by lemma [ qvec ] .",
    "now @xmath173 defines a chain @xmath21 in @xmath174 where scl vanishes , thus we can find some @xmath175 such that @xmath176 , @xmath177 and @xmath178 .",
    "also find disks @xmath179 such that @xmath180 , take @xmath181 copies of @xmath179 for each @xmath51 . now take @xmath98 to be the disjoint union of all these disks with @xmath175 , then @xmath182 and @xmath183 .",
    "since @xmath184 is arbitrary , this proves the other direction .",
    "this motivates the study of @xmath154 since @xmath140 is already linear on @xmath123 .",
    "the following lemma is the same as lemma 3.10 in @xcite .",
    "the proof is standard , thus we omit it .",
    "[ minkfunc ] @xmath185 is a non - negative concave homogeneous function on @xmath123 .",
    "the subset of @xmath123 on which @xmath186 is the boundary of @xmath187 , where `` @xmath188 '' denotes the minkowski sum .",
    "now we are coming to the key observation that makes it possible to generalize the result in @xcite to our rationality theorem .    in @xcite ,",
    "essentially using @xmath75 is free abelian , @xmath148 is determined explicitly as integer points lying in some open faces of @xmath123 .",
    "then @xmath187 is shown to be a finitely sided rational convex polyhedron using such an explicit description of @xmath148 , which also produces an efficient algorithm to compute scl in that case .",
    "however , the set @xmath148 of disk vectors could be very complicated and hard to determine explicitly in general .",
    "the following example illustrates how complicated @xmath148 could be , even when @xmath75 is the simplest non - abelian group .",
    "the study of this example is initiated in an unpublished note by timothy susse ( @xcite ) , who did computer experiments and gave conjectural pictures of the result .",
    "let @xmath189,[x , z]=[y , z]=1\\right>$ ] be the 3-dimensional heisenberg group , which is @xmath190-step nilpotent , and @xmath191=\\left < z\\right>$ ] .",
    "suppose @xmath192 for some @xmath193 such that @xmath194 for some @xmath195 , which occurs if we consider @xmath196 $ ] with @xmath74 and @xmath197 in some group @xmath76 .",
    "let us look at a 2-dimensional subcone of @xmath123 spanned by @xmath198 and @xmath199 , and find all @xmath200 such that @xmath201 is a disk vector . for fixed @xmath202 ,",
    "the vector @xmath201 is a disk vector if and only if there is some cyclic word @xmath29 in @xmath203 such that    1 .",
    "@xmath29 represents @xmath204 in @xmath75 ; 2 .",
    "@xmath29 contains @xmath205 copies of each of @xmath206 , @xmath207 , @xmath208 and @xmath134 copies of @xmath209 , @xmath210 , @xmath211 as subwords .",
    "notice that since @xmath194 , @xmath212 commutes with @xmath207 and @xmath210 , and similarly for @xmath213 and @xmath21 ; we also have @xmath214=[b , c]=[c , a]=z^n$ ] for some @xmath4 . any cyclic word with equal number ( say , @xmath215 ) of @xmath203 in it",
    "can be written uniquely as @xmath216^r$ ] for some @xmath217 by moving letters around .",
    "one can prove by induction ( see appendix ) that for fixed @xmath202 , and the set of cyclic words satisfying the restriction ( 2 ) above , the set of @xmath218 that can appear is @xmath219    therefore , @xmath201 is a disk vector if and only if @xmath220^r = id$ ] for some @xmath221 , or equivalently @xmath222 has a solution for @xmath221 .",
    "for example if @xmath223 , the set of @xmath202 for which @xmath201 is a disk vector is @xmath224 which are the integer points in the shaded region in figure [ diskv ] , bounded by two parabolas , such that the two coordinates have the same parity .",
    "nevertheless , corollary [ keyob ] , a consequence of our key lemma [ keylemma ] , shows that @xmath187 is always a _ finitely sided _",
    "rational convex cone no matter how complicated @xmath148 is .",
    "the key reason is that an integer point in a rational cone can not be too close to a given face unless it lies on that face .",
    "we first recall some standard definitions .",
    "let @xmath225 .",
    "a convex _ polyhedral cone _ in @xmath226 is a set @xmath227 , where each @xmath228 is a linear map and @xmath229 is _ finite_. in addition , @xmath230 is _ rational _ if each @xmath231 is rational .",
    "@xmath230 is _ simplicial _ if @xmath231 are independent in @xmath232 , or equivalently , @xmath230 is the convex cone spanned by some independent vectors .",
    "it follows that if @xmath230 is simplicial and rational , then @xmath230 is the convex cone spanned by some independent rational vectors .",
    "here is the key observation .",
    "[ keylemma ] let @xmath230 be a rational polyhedral cone in @xmath226 , and @xmath233 be a subset of @xmath234 for some @xmath235 .",
    "then there is a finite subset @xmath236 of @xmath233 such that @xmath237 .",
    "the claim is trivially true if @xmath233 is empty . from now on we assume @xmath233 to be nonempty .",
    "we can decompose @xmath230 into finitely many simplicial rational cones @xmath238 , @xmath239 .",
    "suppose the claim is true for simplicial rational cones , then let @xmath240 and apply the claim to each pair @xmath241 , we get some finite sets @xmath242 such that @xmath243 . now let @xmath244 .",
    "it suffices to show that @xmath245 . actually , for each point",
    "@xmath246 where @xmath247 and @xmath248 , we have @xmath249 for some @xmath51 since @xmath250 .",
    "now @xmath251 , thus there exists @xmath252 and @xmath253 such that @xmath254 , thus @xmath255 lies in @xmath256 .",
    "therefore , we only need to show the claim for any simplicial rational cone @xmath230 . now @xmath230 is spanned by some independent rational vectors @xmath257 , @xmath239 .",
    "extend this to a rational basis of @xmath226 and take a linear transformation @xmath67 of @xmath226 by sending @xmath257 to @xmath258 , where @xmath258 is the standard basis . in matrix",
    "( with respect to the basis @xmath258 ) , @xmath67 is an @xmath259 matrix with rational entry .",
    "let @xmath260 be the lcm of the denominators of the entries .",
    "then the image of @xmath261 under @xmath67 lies in @xmath262 , hence @xmath263 is a subset of @xmath262 .    thus we only need to show the claim for @xmath264 also notice that our statement is irrelevant to the scale , so we assume without generality that @xmath265 , i.e. @xmath233 lies in the integer lattice . now the underlying space @xmath226 is obviously irrelevant , so we just assume @xmath230 to be the first orthant of @xmath226 and proceed by induction on the dimension @xmath4 ( note that @xmath4 is actually the dimension of @xmath230 , not @xmath226 ) .",
    "the base case @xmath266 is obvious . for the inductive step ,",
    "fix any @xmath267 , let @xmath268 be the @xmath51-th face of @xmath230 and @xmath269 be the projection from @xmath230 to @xmath270 .",
    "let @xmath271 , which lies in the integer lattice and @xmath270 .",
    "thus by induction hypothesis ( applied to @xmath272 ) , there is a finite set @xmath273 such that @xmath274 . for each @xmath275",
    ", choose some @xmath276 such that @xmath277 .",
    "hence there is a finite set @xmath278 which projects to @xmath242 under @xmath269 .",
    "note the following simple but crucial fact : for any @xmath279 , if @xmath280 , then @xmath281 lies in @xmath282 if and only if @xmath283 .",
    "thus if we take @xmath284 , then for any point @xmath281 with @xmath285 , we have @xmath286 if and only if @xmath287 . therefore , if @xmath285 and @xmath288 , then @xmath289 , which means @xmath286 .",
    "in other words , if @xmath290 , then @xmath291 .    now let @xmath51 range from @xmath142 to @xmath4 and take @xmath292 . by what we showed above ,",
    "if @xmath293 $ ] , then @xmath291 for each @xmath51 .",
    "hence @xmath294 is a bounded subset of @xmath295 and therefore finite .",
    "take @xmath296 $ ] , the claim follows .",
    "let @xmath226 , @xmath230 and @xmath233 be as above , then @xmath297 is a closed rational polyhedron .    by the lemma above",
    ", @xmath298 has finitely many rational ( actually integral ) vertices ( a subset of @xmath236 ) , thus @xmath298 is a rational polyhedron .",
    "@xmath297 since the minkowski sum commutes with taking convex hull and @xmath230 is convex .",
    "it is closed since @xmath299 is the minkowski sum of a compact set and a closed set .    applying this to @xmath300 and @xmath301 ,",
    "we get    [ keyob ] @xmath187 is always a ( closed ) rational polyhedron ( for any group @xmath75 ) .",
    "thus @xmath185 is the minimum of finitely many rational linear function .",
    "if scl vanishes on @xmath147 , then @xmath302 ( originally defined on rational vectors in @xmath123 ) has a ( unique ) continuous extension @xmath303 , which is the minimum of finitely many rational linear functions .",
    "the first assertion follows immediately from the corollary above . combining lemma [ minkfunc ]",
    ", we get the second assertion . combining lemma [ chi0scl0 ]",
    ", we get the last assertion .",
    "corollary [ keyob ] generalizes lemma 3.12 in @xcite by weakening the assumption `` ( free ) abelian '' to `` scl vanishes '' . now following the argument in @xcite",
    ", we get our first main result :    [ pql ] let @xmath19 ( @xmath304 ) be a family of groups where scl vanishes on each @xmath19 , then scl is piecewise rational linear on the free product @xmath16 .    given corollary [ keyob ] , the proof is the same as that in @xcite .",
    "we include it for completeness .",
    "we first focus on the case of @xmath74 .    as in the section [ sec3 ] ,",
    "fix a finite subset @xmath78 of nontrivial conjugacy classes in @xmath0 and define the 1-manifold @xmath86 .",
    "also let @xmath112 , @xmath123 and @xmath302 be as above , similarly define these for @xmath76 .",
    "let @xmath305 be the set of pairs @xmath306 that can be `` glued up '' , i.e. : for any @xmath307 with @xmath106 not a self - loop ( then neither is @xmath308 ) , we can find a unique @xmath309 such that @xmath310 is the oriented arc in the 1-manifold @xmath86 following @xmath106 , and @xmath308 follows @xmath311 ; we require the @xmath312-coordinate of @xmath313 equals the @xmath314-coordinate of @xmath315 for any such @xmath312 and @xmath314 .",
    "then @xmath316 is still a rational cone .",
    "define @xmath317 for any @xmath318 .",
    "then by corollary [ keyob ] , @xmath319 is the minimum of finitely many rational linear functions . finally define @xmath320 to be the unique rational linear map that @xmath321 in @xmath322 whenever @xmath323 for some surface @xmath324 .",
    "now for any @xmath325 that corresponds to a chain @xmath326 , let @xmath327 , then we have @xmath328 notice that @xmath329 is a finitely sided convex polyhedron since @xmath316 is , and it is rational if @xmath330 is .",
    "thus scl is computed as a convex programming problem , which can be reduced to a linear programming problem by introducing slack variables because @xmath319 is the minimum of finitely many rational linear functions .",
    "then it follows that scl is piecewise rational linear on @xmath77 .",
    "since @xmath78 is arbitrary , the conclusion follows .    for the general case ,",
    "since every rational subspace only involves finitely many factors , it suffices to show the conclusion holds when @xmath331 is finite according to remark [ finiteness ] .",
    "now if @xmath331 is finite , we can build @xmath44 by gluing up @xmath332 s so that no three factors are attached at the same point .",
    "this guarantees that surfaces @xmath333 are glued up in a simple way .",
    "then define @xmath334 , @xmath335 and @xmath336 as before .",
    "similarly define @xmath316 by writing down the suitable gluing condition .",
    "then the same argument above shows scl is piecewise rational linear .",
    "[ vanscl ] many groups have vanishing scl .",
    "there are three main sources :    1 .",
    "small groups such as amenable groups , which include finite groups and solvable groups ; 2 .",
    "irreducible lattices of higher rank lie groups ( see theorem 5.26 in @xcite for a precise statement ) ; 3 .   some transformation groups such as homeo@xmath337 ( theorem 2.43 in @xcite ) , thompson - stein groups @xmath338 with @xmath339 ( lemma 3.6 in @xcite or lemma 5.15 in @xcite ) , homeo@xmath340 and subgroups of pl@xmath341 ( theorem a in @xcite ) .",
    "the proof actually gives a method to determine scl in free products when scl vanishes on each factor .",
    "it produces an algorithm as long as one can determine the vertices of the convex cone @xmath342 , which seems hard in general since it requires some knowledge of @xmath343 .",
    "the method , however , is still helpful to study scl in families .",
    "[ redun ] when considering @xmath329 , it is redundant in the following sense to impose @xmath344 in the definition of @xmath123 ( see definition [ va ] ) . if we define @xmath345 to be non - negative vectors @xmath124 satisfying @xmath125 , then @xmath123 is the sub - polyhedral cone of @xmath345 on which @xmath344 .",
    "we can similarly define @xmath316 and the linear map @xmath346 using @xmath345 instead of @xmath123 , denote them by @xmath347 and @xmath348 .",
    "it turns out that if @xmath325 corresponds to homologically trivial chain in @xmath61 , then @xmath349 coincides with @xmath329 .",
    "[ isoembscl0 ] let @xmath350 be a family of injective group homomorphisms .",
    "suppose scl vanishes on each @xmath351 and @xmath352 , then the induced map @xmath353 is an isometric embedding with respect to scl .",
    "more precisely , for any @xmath354 , we have @xmath355 .",
    "again this reduces to the case of finitely many factors .",
    "now run the process above on both sides .",
    "first assume that the induced homomorphism@xmath356 are all injective , then @xmath357 and @xmath358 can be identified .",
    "injectivity of @xmath359 ensures that @xmath360 is identified with @xmath361 , thus @xmath362 is identified with @xmath363 .",
    "then the computation of scl on two sides are results of the same linear programming problem , thus @xmath67 is isometric for scl .",
    "now if the induced homomorphisms are not injective , according to remark [ redun ] , we can use @xmath364 and @xmath365 instead , which still can be identified in this case , and it does not change @xmath329 , thus the programming problems on either side are the same , and hence the map is isometric for scl .",
    "the condition that scl vanishes on each @xmath351 and @xmath352 ensures that each @xmath359 is isometric .",
    "thus it is natural to ask whether it is enough to get the conclusion if we only assume each @xmath359 to be an isometric embedding .",
    "our second main result confirms this . to prove it",
    ", we will reveal how scl in free products is determined when scl does not necessarily vanish on each factor .",
    "now we return to the general case .",
    "similar to the special case discussed above , we need an analogue of lemma [ chi0scl0 ] to reveal the structure of @xmath366 .",
    "first we make the following    for any rational @xmath127 , define @xmath367    let @xmath368 .",
    "equivalently , @xmath369 is the set of rational points in @xmath370 . for any @xmath371 ,",
    "define @xmath372    [ chi0gen ] for any rational @xmath127 , we have @xmath373    the proof is similar to that of lemma [ chi0scl0 ] . let @xmath374 @xmath375 by equation ( [ chi0 ] ) , we just need to show @xmath376 .    on the one hand , if @xmath157 , let @xmath159 be the disk components of @xmath98 and @xmath160 , then @xmath377 where @xmath378 , this proves @xmath379 .    on the other hand ,",
    "for any given @xmath166 , we can find @xmath380 such that @xmath381 and @xmath382 .",
    "then we can write @xmath383 with @xmath168 nonnegative rational and @xmath152 such that @xmath384 .",
    "we can also find an integer @xmath132 and a surface @xmath172 such that @xmath385 and @xmath386 .",
    "up to replacing @xmath172 by a bunch of copies of itself , we may assume that each @xmath170 is an integer .",
    "now take disks @xmath179 such that @xmath180 .",
    "take @xmath170 copies of @xmath179 for each @xmath51 and let @xmath98 be the disjoint union of these disks together with @xmath172 .",
    "then @xmath387 and @xmath388 this shows @xmath389 .",
    "now we can describe how scl is determined in general free products .",
    "let @xmath390 be the free product of finitely many groups , consider a finite set @xmath78 of conjugacy classes ( remove torsion elements ) in @xmath0 and build the 1-manifold @xmath86 as before , define @xmath391 , @xmath392 , @xmath393 and @xmath394 as above . then define @xmath316 , as in the proof of theorem [ pql ] , to be the rational polyhedron in @xmath395 consisting of tuples of vectors from @xmath391 that can be `` glued up '' , and define ( only for rational points in @xmath316 ) @xmath319 to be the sum of @xmath396 evaluated on the @xmath51-th coordinate .",
    "now for any rational @xmath325 that corresponds to a ( rational chain ) @xmath326 , let @xmath327 ,    [ detscl ] with notation as above , @xmath397    the proof follows exactly as before .    using this lemma , we can generalize corollary [ isoembscl0 ] to our second main result .",
    "[ isoemb ] let @xmath22 be a family of isometric embeddings with respect to scl , then the induced map @xmath398 is also an isometric embedding .",
    "the proof is almost the same as that of corollary [ isoembscl0 ] .",
    "first reduce to finite free products , then apply lemma [ detscl ] on both sides accordingly .",
    "injectivity of @xmath231 ensures that @xmath399 can be identified with @xmath392 , and thus @xmath400 is identical to @xmath401 . @xmath231",
    "preserving @xmath9 implies that @xmath402 is identical to @xmath394 . in the case where @xmath231 induces injective maps on homology ,",
    "@xmath403 can be identified with @xmath391 , then @xmath404 is the same as @xmath405 and thus the computation of scl ( for rational chains ) on either side is obtained by taking the infimum of the same functions on identical spaces , hence @xmath67 preserves scl . in general @xmath231 need not induce injective maps on homology . however , by remark [ redun ] the conclusion still holds .",
    "alternately , one can prove this theorem in a more direct way .",
    "here is an outline :    reduce to finite free products and then to the case @xmath406 by induction .",
    "it suffices to show @xmath407 for integral homologically trivial chains @xmath21 where @xmath408 , @xmath409 and @xmath410 .",
    "take any surface @xmath411 mapped into @xmath412 that approximates @xmath413 well , decompose it as in section [ sec3 ] into pieces @xmath414 and @xmath415 .",
    "disk components of @xmath414 `` factor through '' @xmath75 by injectivity of @xmath416 , the boundary of the union of other components defines a chain on @xmath417 that can be pulled back to a homologically trivial ( for the same reason explained in remark [ redun ] ) chain on @xmath75 with identical @xmath9 by assumption . then find a surface that approximates the scl of this chain well ,",
    "take a finite cover if necessary and take the union with multiple copies of the disk components from @xmath172 , and we obtain a surface @xmath98 with @xmath418 and such that @xmath113 corresponds to @xmath419 , using the notation in section [ sec3 ] .",
    "do the same thing for @xmath76 then glue up @xmath98 and @xmath99 ( after taking suitable finite covers ) to get a surface @xmath34 mapped to @xmath420 that winds around @xmath21 and is almost as efficient as @xmath411 , thus @xmath407 .",
    "in this section , we apply the isometric embedding theorem and the computational methods we have developed to get generalizations and new proofs of old results .",
    "we start with a simple corollary of theorem [ isoemb ] .    [ steal ]",
    "let @xmath421 , @xmath16 , and @xmath422 be the inclusion .",
    "then the induced map @xmath423 is an isometric embedding . in particular , let @xmath424 , then the spectrum of @xmath15 contains that of @xmath425 if @xmath19 has an element of order @xmath426 ( @xmath427 could be @xmath428 , in which case @xmath429=@xmath430 ) . here the `` spectrum '' could refer to values scl takes on @xmath431 or the commutator subgroup .",
    "just note that @xmath359 is an isometric embedding even if @xmath432 ; because the definition of an isometric embedding is that @xmath231 induces an isometric map @xmath433 , and @xmath434 since @xmath429 is abelian .",
    "scl in free products of cyclic groups has been studied in @xcite , @xcite and @xcite .",
    "the program scallop ( @xcite ) can compute scl on specific chains .",
    "this allows us to generalize results about the scl spectrum in free groups ( or free products of cyclic groups ) to general free products .",
    "for example , we have    let @xmath16 ( @xmath304 , @xmath435 ) and suppose at least two @xmath19 s contain an element of infinite order .",
    "then the image of @xmath2 $ ] under scl contains elements congruent to every element of @xmath436 mod @xmath430 .",
    "moreover , it contains a well - ordered sequence of values with ordinal type @xmath437 .",
    "this follows from corollary 3.19 in @xcite , which states that the conclusion is true for nonabelian free groups , and our corollary [ steal ] .",
    "now we give three examples to illustrate how lemma [ detscl ] works .",
    "we first deduce the following product formula , which was originally stated not quite correctly in @xcite ( but the proof is still valid for torsion free elements ) and later corrected and proved in @xcite for the general case .",
    "[ prod ] let @xmath74 , and let @xmath438 , @xmath439 be nontrivial elements .",
    "suppose @xmath212 and @xmath213 are of order @xmath440 and @xmath441 ( could be @xmath428 , in which case @xmath442 by convention ) , then @xmath443    if the image of @xmath212 in @xmath122 is not zero , then both sides are @xmath428 by convention , and similarly for @xmath213 .",
    "now we assume this is not the case . using the notations in previous sections ,",
    "let @xmath444 , then @xmath86 is just an oriented circle , @xmath445 , and @xmath446 by linearity of scl . if @xmath440 is finite , then @xmath447 , @xmath448 and thus @xmath449 , @xmath450 either by lemma [ chi0scl0 ] or lemma [ chi0gen ] . if @xmath451 , then @xmath452 and @xmath453 , thus @xmath454 by lemma [ chi0gen ] .",
    "then @xmath455 is valid in either case .",
    "similarly we get @xmath456 . now",
    "the `` glue - up '' condition on @xmath457 simply requires @xmath458 for @xmath459 , thus @xmath460",
    ". then the fundamental class @xmath325 corresponds to the chain @xmath206 , thus @xmath461 and @xmath462 .",
    "therefore by lemma [ detscl ] , we get @xmath463    the following self - product formula is an analogy of the product formula . when @xmath464 and @xmath465 is the generator , it is proved in @xcite .",
    "[ selfprod ] let @xmath75 and @xmath76 be groups , @xmath466 and @xmath467 be torsion free elements .",
    "then @xmath468    again both sides are @xmath428 if @xmath469 is not @xmath41 in @xmath119 .",
    "thus we assume this does not happen .",
    "the result easily follows from the original self - product formula and theorem [ isoemb ] by considering @xmath470 and the inclusion @xmath471 .",
    "but we prove it using the computational tool above , which gives a new proof even for the original formula .",
    "we apply lemma [ detscl ] to calculate the left hand side . using notations as before ,",
    "let @xmath472 , then @xmath86 is an oriented circle , @xmath473 consists of vectors of the form @xmath474 where we can think @xmath213 as a @xmath475 matrix with entries @xmath476 .",
    "then in the definition of @xmath477 , @xmath478 requires the sum of elements in the @xmath51-th row equals that of those in the @xmath51-th column for all @xmath51 , which is @xmath479 in this case ; @xmath480 requires @xmath481 if @xmath465 is non - zero in @xmath482 and is redundant otherwise .",
    "thus it is subtle to determine @xmath477 , but @xmath483 is clear .",
    "similarly @xmath484 , where @xmath485 .",
    "if @xmath486 , the glue - up condition requires @xmath487 , @xmath488 , @xmath489 and @xmath490 . in other words , @xmath213 is the matrix we get by moving the first column of @xmath212 to the last .",
    "finally @xmath491 requires in additional that each row of @xmath213 ( and @xmath212 ) sums up to @xmath142 .",
    "together with @xmath478 , this implies that @xmath479 , which implies @xmath480 in any case , compatible with remark [ redun ] .    in summary , @xmath492\\}$ ] where @xmath493 @xmath494 with @xmath495    now @xmath496 since all @xmath465 and @xmath497 will cancel .",
    "since @xmath465 is torsion free , @xmath498 , and @xmath499)=\\beta$ ] .",
    "thus @xmath500 by lemma [ chi0gen ] . for @xmath302 ,",
    "it is more straight forward to use equation ( [ chi0 ] ) .",
    "thus we have @xmath501    therefore by lemma [ detscl ] , we only need to show @xmath502\\cap\\mathbb{q } } \\{2-\\alpha+\\inf\\{-\\chi(s_a)/n|v(s_a)=nu(\\alpha)\\}\\}.\\ ] ] let @xmath503 , then @xmath504 and thus @xmath505 since @xmath98 has no disk components because @xmath506 and @xmath281 are torsion free .",
    "this gives the `` @xmath507 '' direction .",
    "conversely , we just need to show @xmath508 always holds .",
    "in fact , since @xmath509+n\\alpha[(x , x)+(y , y)]$ ] , there are @xmath510 points on the boundary of @xmath98 that sit in between an @xmath506 and a @xmath281 , where it is from @xmath506 to @xmath281 for half of them ( referred to as a @xmath511 point ) and from @xmath281 to @xmath506 for the other half ( referred to as a @xmath512 point ) .",
    "whenever we have a @xmath511 point and a @xmath512 point that lie on the same boundary component , we glue a rectangle to the surface with one edge glued to the @xmath511 point and its opposite edge glued to the @xmath512 point .",
    "such a surgery increases @xmath513 by @xmath142 . repeating the process",
    "we get a new surface @xmath172 such that @xmath514 and each boundary component either winds around @xmath506 several times or around @xmath281 .",
    "this implies that @xmath172 has no disk components since @xmath506 and @xmath281 are torsion free and @xmath173 winds around each of @xmath506 and @xmath281 @xmath4-times in total .",
    "thus @xmath515 .",
    "this completes the proof .",
    "finally we prove the following formula which was conjectured for free product of cyclic groups and proved for @xmath516 by alden walker in @xcite .",
    "it was pointed out by timothy susse that in the case of free product of cyclic groups , this is equivalent to proposition 4.1 he proved in @xcite by considering certain amalgams of abelian groups .",
    "[ abab ] let @xmath74 , @xmath517 and @xmath518 , then @xmath519)=\\frac{1}{2}-\\frac{1}{k}\\ ] ] where @xmath520 is the minimum of the order of @xmath212 and @xmath213 .    by theorem [ isoemb ]",
    ", we may assume @xmath521 and @xmath522 .",
    "let @xmath523 and @xmath524 be the order of @xmath212 and @xmath213 respectively .",
    "similar to the proof of proposition [ selfprod ] , we have @xmath525\\}$ ] where @xmath493 , @xmath494 with @xmath526 and @xmath527 therefore @xmath528 which has maximum @xmath529 for @xmath530 $ ] , thus @xmath519)=\\frac{1}{2}-\\frac{1}{k}.\\ ] ]",
    "fix a rational chain @xmath21 in @xmath25 , for any @xmath26 , with @xmath27 , let @xmath28 be the image of @xmath29 under the natural homomorphism @xmath30 .",
    "it is natural to ask : how does @xmath31 depend on @xmath32 ?    based on computer experiments , alden walker conjectured ( @xcite ) the following formulas : @xmath531 where @xmath532 and @xmath533 are the order of @xmath212 and @xmath213 respectively , and brackets indicate that the coefficients depend on congruence classes : for example , @xmath534 means @xmath535 if @xmath536 mod @xmath190 and @xmath537 if @xmath538 mod @xmath190 .    motivated by this , walker proposed the following conjecture :    [ conj ] for any fixed chain @xmath21 in @xmath25 , @xmath31 is piecewise quasilinear in @xmath33 , i.e. there are some @xmath539 , and a finite partition of @xmath540 , such that on each piece , fixing any congruence class of each @xmath541 mod @xmath542 , @xmath31 is linear in @xmath33 .",
    "computer experiments suggest that this conjecture is false .",
    "based on computer experiments ( using scallop @xcite ) , for @xmath543 and @xmath544 with @xmath545 , we have @xmath546 thus we see that the denominators could be higher degree polynomials in @xmath532 , and even when it is linear in @xmath532 , it could be inhomogeneous",
    ".    however we are able to prove a weaker statement :    [ weakwconj ] for any fixed rational chain @xmath21 in @xmath25 , @xmath31 is piecewise quasi - rational in @xmath32 , i.e. there are some @xmath539 , and a finite partition of @xmath540 , such that on each piece , fixing any congruence class of each @xmath541 mod @xmath542 , @xmath31 is in @xmath547 .",
    "timothy susse ( @xcite , corollary 4.14 ) proved the same result by considering a fixed chain in a family of amalgamations of free abelian groups , whose projection to the free product of cyclic groups preserves scl .",
    "our proof is independent and new .",
    "we focus on a single factor @xmath548 . using notations as in section [ sec4 ] ,",
    "the key is to show the vertices of @xmath549 behave nicely as the @xmath215 varies in congruence classes ( see lemma [ diskfamily ] ) . since @xmath122=0",
    ", we have @xmath344 , thus @xmath123 consists of non - negative vectors in @xmath550 and does not depend on @xmath215 .",
    "however @xmath148 typically depends on @xmath215 , and we denote it by @xmath551 to emphasize the dependence .",
    "we first describe @xmath551 . for simplicity , we assume @xmath543 , and @xmath552 is a single word , but the proof of lemmas are the same for the general case . consider the directed graph @xmath553 with vertex set @xmath92 and edge set @xmath112 .",
    "then each @xmath127 defines non - negative weights on the directed edges , and its support , @xmath554 , is the subgraph of @xmath553 consisting of edges with positive weights .",
    "let @xmath555 be the generator of @xmath556 giving the free product structure .",
    "then each @xmath557 for some @xmath558 .",
    "let @xmath559 be the linear map such that for any @xmath560 , @xmath561 .",
    "then it is easy to see that @xmath551 is the set of integer vectors @xmath134 in @xmath123 such that @xmath562 and @xmath554 is connected and nonempty ( see @xcite for details ) .",
    "we can decompose @xmath563 into finitely many simplicial rational open faces , i.e. each is of the form @xmath564 for some @xmath565 and a set of independent rational vectors @xmath566 .",
    "moreover , each simplicial rational cone can be decomposed into finitely many _",
    "_ cones , i.e where we can take the set of @xmath566 to be unimodular , by barvinok theorem ( @xcite , chapter 16 ) .",
    "so we first prove the following key lemma leading to lemma [ diskfamily ] and theorem [ weakwconj ] .",
    "[ std ] let @xmath567 and @xmath568 ( @xmath569 ) be a rational linear function .",
    "let @xmath570 and @xmath571 be the set of integer points in @xmath572 . then there are @xmath573 such that :    1 .   for each congruence class mod @xmath542 , there are finitely many points @xmath574 that depend linearly on @xmath215 such that @xmath575 for any @xmath576 in this given congruence class ; 2 .   for each congruence class mod @xmath542 , there is a finite set @xmath577 of points depending linearly on @xmath215 , such that @xmath578 for any @xmath576 in the given congruence class mod @xmath542 .",
    "more precisely , we can take @xmath579 for any @xmath576 .",
    "lemma [ std ] is similar in spirit to the following result used in our proof , which is a special case of the main theorem of @xcite .",
    "[ qiq ] let @xmath580 be a finite set of points depending linearly on @xmath215 , and then there is @xmath581 such that the vertices ( finitely many ) of the integer hull of @xmath582 depends linearly on @xmath576 in each congruence class mod @xmath542 .",
    "we first prove ( 2 ) modulo ( 1 ) .",
    "notice that each @xmath583 depends linearly on @xmath215 and stays in @xmath563 , thus if @xmath584 and @xmath585 mod @xmath542 , then @xmath586 . also notice that any @xmath587 is congruent to some @xmath588 with @xmath589 .",
    "hence the vertices of @xmath590 are contained in @xmath579 , and the assertion holds .",
    "now we prove the first part .",
    "we may assume all @xmath591 are non - zero , otherwise we can do a dimension reduction .",
    "let @xmath592 and @xmath260 be the set of indices such that @xmath591 is positive or negative respectively . if @xmath593 , then @xmath594 and the problem is trivial , so we also assume @xmath595 in the sequel . let @xmath596 be the standard basis of @xmath597 . for any @xmath598 , let @xmath599 .",
    "if @xmath600 , i.e all @xmath601 , then @xmath572 is the top open face of @xmath602 and @xmath571 coincides with the set of integer points in the compact polyhedron @xmath603 whose vertices depend linearly on @xmath215 , so our assertion follows from lemma [ qiq ] .",
    "now also suppose @xmath604 , then @xmath605 . we first deal with integer points in each @xmath606 .",
    "pick @xmath542 such that @xmath607 , then for @xmath215 in any fixed congruence class , @xmath606 is @xmath608 where @xmath230 is a translate of @xmath609 that does not depend on @xmath215 , therefore in this congruence class , the integer hull of @xmath606 is just that of @xmath230 translated by @xmath610 .    if @xmath611 is not contained any @xmath606 , then for each @xmath598 , @xmath612 .",
    "consider @xmath613 @xmath614 is compact since @xmath612 for any @xmath598 and @xmath611 implies @xmath615 now the vertices of @xmath614 depend linearly on @xmath215 , so lemma [ qiq ] applies . since @xmath572 is the union of @xmath606 ( @xmath598 ) and @xmath614 , and the integer hull of each part has vertices depending linearly on @xmath616 in a congruence class , so our assertion follows .",
    "now we can prove    [ diskfamily ] there are @xmath573 such that for each congruence class mod @xmath542 , we can find finitely many points @xmath617 that depends _ linearly _ on @xmath215 such that @xmath618 for any @xmath576 in this given congruence class .    according to the discussion above",
    ", we can express @xmath123 as the union of top - dimensional faces @xmath619 of finitely many simplicial unimodular rational cones , and the intersection of @xmath551 with each @xmath619 is either empty ( when the support is disconnected ) or exactly the integer points in @xmath620 .",
    "apply lemma [ std ] to each @xmath619 with @xmath621 and @xmath622 respectively ( together with the set @xmath623 that does not depend on @xmath215 ) , we see that there are @xmath581 such that for each congruence class mod @xmath542 , we can find finitely many points @xmath624 such that @xmath625 for any @xmath576 in this given congruence class .",
    "this completes the proof since there are only finitely many @xmath51 .",
    "now we prove theorem [ weakwconj ] .",
    "it follows from lemma [ diskfamily ] that for @xmath616 in a fixed congruence class mod @xmath542 , @xmath185 is the minimum of finitely many linear functions each having coefficients in @xmath626 . here",
    "@xmath75 can be any factor and @xmath215 is the corresponding @xmath541 .",
    "therefore if we fix the congruence classes of @xmath627 , combining the proof of theorem [ rationality ] ( or lemma [ detscl ] ) , @xmath31 is determined by minimizing , on a fixed compact convex set @xmath230 , the maximum of finitely many linear functions @xmath628 each having coefficients in @xmath547 .",
    "thus we can find a finite polyhedral decomposition of @xmath230 with vertices having @xmath547 coordinates , and @xmath629 linear on each piece .",
    "it follows that @xmath9 is the max of finitely many functions in @xmath547 , i.e. the values of @xmath629 on these finitely many vertices , hence @xmath9 is piecewise @xmath547 .",
    "here we give a proof of equation ( [ suv ] ) .",
    "for convenience , we use @xmath630 to denote the number of subwords @xmath631 inside @xmath29 .",
    "let @xmath632 be the set of cyclic words @xmath29 in @xmath203 such that @xmath29 contains @xmath205 copies of each of @xmath206 , @xmath207 , @xmath208 and @xmath134 copies of @xmath209 , @xmath210 , @xmath211 as subwords .    for each @xmath633 ,",
    "let @xmath634 be the unique integer such that @xmath29 can be written as @xmath216^{f(w)}$ ] by moving letters around and using @xmath214=[b , c]=[c , a]$ ] . then by definition",
    ", @xmath635 is the image of @xmath632 under @xmath67 .            up to a cyclic permutation , @xmath645 where @xmath646 and @xmath647 are empty words or subwords starting with @xmath212 , and @xmath648 . recall that @xmath649 is in the center and @xmath212 commutes with @xmath207 , thus @xmath650 and @xmath651=[a^{-l},r]=[a , b]^{l(\\#_c(r)-\\#_b(r))}.\\ ] ]    thus @xmath652^{-1}=ab(cb)^kcab(cb)^lcrt\\cdot [ a , b]^{l(\\#_b(r)-\\#_c(r))}.\\ ] ] notice that @xmath653 is still in @xmath632 , and removing the underlined @xmath654 which is followed by @xmath21 , we will get a word @xmath655 and @xmath656 .",
    "according to lemma [ reduction ] , if @xmath633 has two pairs of consecutive @xmath212 s in @xmath29 having degree @xmath142 subwords in between , then @xmath666 assuming that @xmath667 consists of integers in an interval . similarly by the symmetry above ,",
    "if @xmath633 has two pairs of consecutive @xmath212 s in @xmath29 having degree @xmath641 subwords in between , then @xmath668 assuming that @xmath669 consists of integers in an interval .",
    "first assume we have proved the equation for @xmath670 .",
    "we induct over @xmath671 to show that @xmath672 whenever @xmath673 .",
    "suppose @xmath633 with @xmath674 , notice that the subword @xmath675 sitting in between two consecutive @xmath212 s has degree @xmath346 if and only if @xmath676-[\\#_{ac}(aw_0a)+\\#_{ba}(aw_0a)]=2d.\\ ] ]    also notice that if we sum the left hand side of the equation above , over all such @xmath675 between two consecutive @xmath212 s , we will get @xmath677 .",
    "hence we conclude that there must be two pairs of consecutive @xmath212 s in @xmath29 having degree @xmath142 subwords in between , thus @xmath666 since @xmath667 consists of integers in an interval by induction hypothesis .",
    "this shows that @xmath678 , but the other inclusion is obvious : adding a copy of @xmath649 ahead of a letter @xmath212 in @xmath679 will result in a new word @xmath680 with @xmath681 .",
    "therefore we only need to prove the equation for @xmath635 with @xmath682 , and we induct on @xmath636 .",
    "the base cases are easy to check .",
    "we now show @xmath683\\cap\\mathbb{z}\\ ] ] assuming ( [ suv ] ) holds for all such @xmath684 with @xmath685 and @xmath686 .",
    "consider the following family of words in @xmath687 : @xmath688 a direct computation shows @xmath689 .",
    "this together with arguments before shows that @xmath690\\subset s_{v+1,v}$ ] , hence by inductive hypothesis , @xmath691\\cap\\mathbb{z}\\subset s_{v+1,v}.\\ ] ]      1 .",
    "@xmath29 does not contain subwords @xmath695 , @xmath696 or @xmath697 , otherwise @xmath698 , which has maximum @xmath699 by induction ; 2 .",
    "@xmath29 does not contain subwords @xmath700 , @xmath701 or @xmath702 , otherwise @xmath703 , and @xmath704 has maximum @xmath705 by induction ; 3 .",
    "@xmath29 does not contain the subword @xmath706 , since it can be replaced by @xmath707 to get a new word in @xmath687 with larger @xmath67 ; 4 .",
    "only one subword between two consecutive @xmath212 s in @xmath29 is degree @xmath142 , others are degree @xmath41 , because otherwise there are either two degree @xmath142 subwords or two degree @xmath641 subwords , which implies @xmath708 or @xmath709 contradicting maximality",
    ".    therefore @xmath29 must be of the form ( up to replacing it by another that also achieves the max)@xmath710 where @xmath711 , @xmath638 and @xmath712 . since @xmath693 , we see @xmath713 and @xmath714 .",
    "a direct computation shows @xmath715^e,\\ ] ] where @xmath716 .",
    "maximizing @xmath634 is the same as maximizing @xmath717 , which requires @xmath718 and @xmath719 .",
    "therefore @xmath720 as we constructed and @xmath721 ."
  ],
  "abstract_text": [
    "<S> we study stable commutator length ( scl ) in free products via surface maps into a wedge of spaces . </S>",
    "<S> we prove that scl is piecewise rational linear if it vanishes on each factor of the free product , generalizing the main result in @xcite . </S>",
    "<S> we further prove that the property of isometric embedding with respect to scl is preserved under taking free products . </S>",
    "<S> the method of proof gives a way to compute scl in free products which lets us generalize and derive in a new way several well - known formulas . </S>",
    "<S> finally we show independently and in a new approach that scl in free products of cyclic groups behaves in a piecewise quasi - rational way when the word is fixed but the orders of factors vary , previously proved by timothy susse , settling a conjecture of alden walker . </S>"
  ]
}