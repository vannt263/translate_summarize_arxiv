{
  "article_text": [
    "equilibrium statistical mechanics provides the fundamental basis for the thermodynamics of a given system in terms of its hamiltonian and the characteristics of its environment ( e.g. , open or closed ) @xcite . the canonical ensemble applies when the system is in contact with a thermal reservoir , exchanging energy at constant volume and particle number .",
    "it is parameterized by the temperature ( @xmath1 ) , number density ( @xmath2 ) , and volume ( @xmath3 ) .",
    "the fundamental thermodynamic potential associated with this ensemble is the helmholtz free energy per particle @xmath4 @xmath5 .",
    "the grand canonical ensemble applies under the same thermodynamic conditions but with the additional exchange of particle number with its environment .",
    "it is parameterized by @xmath6 and @xmath3 , where @xmath7 is the chemical potential .",
    "its thermodynamic potential is the pressure @xmath8 .",
    "however , the free energy per particle in the grand canonical ensemble @xmath9 can be determined from @xmath8 by a change of variables @xmath10 via a legendre transform ( see below ) . here",
    "@xmath11 is the average density in the grand canonical ensemble .",
    "similarly , the pressure can be defined for the canonical ensemble by the change of variables @xmath12 and a corresponding legendre transform .    for large systems",
    "it is expected on physical grounds that the system becomes extensive , in which case the free energy per particle and pressure become independent of the volume@xmath13 furthermore , if the two ensembles have the same @xmath14 @xmath15and @xmath7 is chosen such that @xmath16 then the thermodynamics from the two ensembles should be equivalent in this limit , e.g. @xmath17    it is this equivalence that allows one to choose an equilibrium ensemble for convenience of computation or simulation , rather than to fit the actual experimental conditions of interest .",
    "for example , most formulations of density functional theory are based in the grand canonical ensemble while actual implementations in simulation are for conditions of the canonical ensemble , specifically for fixed density and volume .",
    "this raises the challenge of quantifying the conditions for the validity of ( [ 1.1 ] ) and ( [ 1.2 ] ) , and finding relationships between properties in different ensembles .",
    "the objective here is to formulate this problem more precisely and to provide some answers for the simplest case of a non - interacting fermi gas .",
    "the large system limit is defined by @xmath18 at constant @xmath19 or @xmath11 for the canonical and grand canonical ensembles , respectively .",
    "equivalently , this can be stated as @xmath20 at constant @xmath19 , or @xmath21 at constant @xmath11 . in detail , the shape of the system must be constrained as well , e.g. all dimensions should be of comparable size @xmath22 such that @xmath23 is large , where @xmath24 is the average inter - particle spacing defined by @xmath25 .",
    "the desired limit requires that @xmath22 be large compared to all other characteristic length scales as well .",
    "one of these is the force range of interaction , @xmath26 . for coulomb systems",
    "this is replaced by the screening length .",
    "another length scale is the thermal de broglie wavelength @xmath27 which becomes large at low temperatures , or the corresponding fermi length @xmath28 at temperatures near zero .",
    "there can also be a scale set by the spatial variations of an external potential . finally , the correlation length is typically of the order of the force range , but becomes large near a critical point so that system - size dependence can be important even for macroscopic systems . in cases",
    "for which @xmath22  is not the dominant length scale the system is  small \" and , while the thermodynamic formalism is universal , the details must account for the specific environment of the system being described @xcite . here",
    "only the canonical and grand canonical conditions are considered , although many other ensembles for other environments are of experimental interest @xcite .",
    "there is a large literature on the asymptotic evaluation of the difference between properties calculated in different ensembles , e.g. , fluctuations in extensive variables @xcite .",
    "much less is known away from such asymptotic conditions .",
    "however , low temperature thermodynamic properties of interacting fermions in 1-d system have also been discussed in the literature ( see ref.@xcite ) .",
    "the next section defines the ensembles and their associated thermodynamic potentials .",
    "in particular , for comparisons exact relationships between them are identified for arbitrary system size . generally , the thermodynamic properties for the two cases are not equal . however , in section [ sec3 ]",
    "an asymptotic analysis for one of these relationships shows their equivalence for large @xmath3 ( or large @xmath29 ) at constant number density . the analysis is formal and",
    "does not expose the full dependence on @xmath3 nor the cross over to the extensive limit in ( [ 1.1 ] ) .",
    "a more detailed quantitative evaluation is provided in section [ sec4 ] for the special case of a homogeneous non - interacting gas . in that case , the only relevant length scales are @xmath24 and @xmath27 ( or @xmath28 ) . finally , inhomogeneous non - interacting systems with an external potential are discussed in section [ sec5 ] and related to the results of section [ sec4 ] using a local density approximation ( see below ) .",
    "the relevance for ensemble dependence and system - size corrections to the familiar thomas - fermi approximation in density functional theory @xcite is discussed .",
    "the equilibrium canonical ensemble for a system of @xmath29 particles in a volume @xmath3 , coordinates @xmath30 , with pairwise interactions and an external single particle potential is defined by the probability density operator @xmath31 here , @xmath32 is the hamiltonian operator for @xmath29 particles @xmath33 where @xmath34 and @xmath35 are the total kinetic and potential energies , respectively .",
    "the specific forms of the pair potential @xmath36 and external potential @xmath37 are not required at this point .",
    "the equilibrium thermodynamics for this system is defined from the free energy per particle @xmath38 which is a function of the temperature @xmath39 , the density @xmath40 , and the volume @xmath3 .",
    "the trace in the definition of @xmath41 is taken over the @xmath29 particle hilbert space with the appropriate symmetrization ( bosons or fermions ) .",
    "for large systems ( i.e. , @xmath42 at fixed finite @xmath19 ) it is expected that @xmath38 becomes independent of @xmath3 .",
    "the corresponding grand canonical ensemble is  defined by the operator@xmath43 the thermodynamics now is defined from the pressure @xmath44 , where the density dependence of the canonical ensemble is replaced by a dependence on the chemical potential @xmath7 . for large systems ( i.e. , @xmath18 at fixed finite @xmath7 )",
    "it is expected that the pressure becomes independent of @xmath3 .",
    "although the pressure is the fundamentally defined thermodynamic potential in the grand canonical ensemble , the  corresponding free energy , @xmath45 is defined in terms of that pressure by a change of variables from @xmath7 to @xmath11 using the legendre transformation@xmath46 here the average number density , @xmath47 is@xmath48 similarly , although the free energy is the fundamental potential in the canonical ensemble , the pressure @xmath49 is defined in terms of that free energy by a change of variables from @xmath19 to @xmath50 using the legendre transformation@xmath51 where the chemical potential in the canonical ensemble is@xmath52    from the forgoing definitions it is seen that the thermodynamics defined by the two ensembles are related exactly by the relation @xmath53 the volume is the same for each term in this summation , so the density @xmath19 changes accordingly .",
    "the inversion of this relationship is obtained in the appendix:@xmath54 note that the grand canonical pressure must be analytically extended to complex values of the chemical potential .    as noted above",
    ", the determination of canonical ensemble properties from given grand canonical ensemble results is relevant for practical applications of density functional theory .",
    "the inversion of ( [ 2.7 ] ) has been discussed recently @xcite where it is proposed to construct @xmath38 from a set of linear equations obtained from evaluation of @xmath55 at @xmath56 discrete values of @xmath7 . in principle , this requires @xmath57 but approximate values for @xmath38 are obtained for finite @xmath56 .",
    "more systematic expansions are described in references @xcite .",
    "this latter work has been generalized by lutsko @xcite .",
    "equation ( [ 2.8 ] ) appears to be new .",
    "a similar complex expression is given in reference @xcite , section 3.2 , but under the assumption that the discrete summation over @xmath29 in ( [ 2.7 ] ) can be replaced by an integration .",
    "in that case it becomes a laplace transform for which the complex bromwich integral provides its inversion .",
    "the explicit construction of ( [ 2.8 ] ) for the actual discrete case is given in appendix a.",
    "in this section the limit of large systems is considered . for it",
    "the canonical and grand canonical thermodynamics are expected to be equivalent . for the canonical ensemble large systems",
    "means the limit @xmath20 at constant finite density @xmath40 and temperature . for the grand canonical ensemble",
    "this limit is @xmath18 at constant chemical potential @xmath7 and temperature . to show this equivalence consider again ( [ 2.8 ] )",
    "written as @xmath58 where now @xmath59 is a real function of the complex variable @xmath60 @xmath61 it has a stationary saddle point at the value @xmath62 defined by @xmath63 . using ( [ 2.4 ] ) this is @xmath64 since @xmath65 is a real function of @xmath66 the solution is @xmath67 with real @xmath68 determined from@xmath69    now let @xmath70 denote a closed contour in the @xmath66 plane including the interval @xmath71   $ ] along the positive real axis and passing through @xmath72 on the complex axis .",
    "assume that @xmath59 is analytic on and within @xmath70 , so that the integral of @xmath73 over the entire contour must vanish .",
    "consequently , the integral of ( [ 3.1 ] ) can be replaced by an integration over that part of @xmath70 complementary to the interval @xmath74   $ ] . denoting that part by @xmath75@xmath76 where by definition @xmath75 passes through the stationary point @xmath68 tangent to the complex axis .",
    "since @xmath59 is multiplied by @xmath3 , the contribution near @xmath72  gives the dominant contribution for large system size .",
    "the usual saddle - point analysis then leads to the asymptotic result@xmath77 the first two terms are proportional to the free energy of the grand ensemble evaluated at the value of the chemical potential that ensures @xmath78 .",
    "the free energies are therefore the same up to small corrections of the order @xmath79@xmath80 this is the expected equivalence for large systems .",
    "note , however , that the analysis does not show that the free energy per particle is independent of @xmath3 .",
    "that question is explored in more detail in the next two sections .",
    "in this section the thermodynamics for the grand canonical and canonical ensembles are calculated exactly at arbitrary system size for the simplest case of non - interacting particles without external potential .",
    "the hamiltonian for @xmath29 particles is@xmath81 for the canonical ensemble the particle number and volume are fixed so the boundary conditions chosen here are a cubic box of sides @xmath22 with hard walls .",
    "then the momentum components have eigenvalues@xmath82 where @xmath83 is a positive integer .",
    "the grand canonical ensemble represents an open system without fixed particle number . however , its derivation represents this as the sum of probabilities for closed systems at the same volume but different particle number .",
    "hence the same boundary conditions can be used for calculation of components of each @xmath29 within the ensemble .",
    "the pressure in the grand canonical ensemble is given by ( [ 2.2 ] ) .",
    "since @xmath32 is the sum of single - particle operators the summation and trace can be performed directly in occupation number representation with the result for spin @xmath84 fermions @xcite @xmath85 the three - fold summation is over @xmath86 .",
    "use has been made of@xmath87 where @xmath88 is the thermal de broglie wavelength .",
    "similarly , the average number density @xmath11 is@xmath89    it is tempting at this point to represent the summations over  @xmath90 as integrals , i.e. @xmath91 indeed this replacement leads to the familiar textbook results in terms of fermi integrals .",
    "however , @xmath92 is small only for @xmath93 .",
    "this is not the case for low temperatures or small system sizes .",
    "hence for the purposes here the discrete summation must be evaluated directly .    at this point",
    "all properties will be given a corresponding dimensionless form .",
    "the dimensionless temperature @xmath94 is@xmath95 where @xmath96 is the fermi energy .",
    "it follows that@xmath97",
    "so that ( [ 4.5 ] ) becomes@xmath98 and @xmath99 an appropriate dimensionless pressure is@xmath100 here it is understood that @xmath101 as determined from ( [ 4.9 ] ) . finally , the dimensionless free energy per particle is obtained from the legendre transformation as described in ( 6 ) .",
    "@xmath102    the dimensionless system - size parameter is now @xmath103 .",
    "the analysis proceeds as follows : 1 ) choose a value for @xmath103 and calculate @xmath104 as a function of @xmath94 from ( [ 4.9 ] ) .",
    "repeat for different values of @xmath103 .",
    "the results are shown in figure 1(a ) .",
    "also shown is the limiting value for @xmath21 obtained from the continuum limit ( i.e. , ( [ 4.6 ] ) ) ; 2 ) calculate @xmath105 from ( [ 4.11 ] ) as a function of @xmath94 for the same set of values for @xmath103 .",
    "the results are shown in figure 1(b ) ; 3 ) calculate the dimensionless free energy @xmath106 as a function of @xmath94 for the same set of @xmath103 from ( [ 4.14 ] ) .",
    "the results are shown in figure 2 .",
    "these figures show that the system - size dependence is small for @xmath107 at @xmath108 , but is more significant as the temperature is lowered .",
    "this is expected since that dependence is controlled by @xmath109 and vanishes only for large @xmath110 .",
    "below @xmath111 , larger values of @xmath112 are required to approach system - size independence .",
    "+      equation ( [ 2.8 ] ) shows that the canonical ensemble free energy per particle can be obtained from the grand canonical pressure , extended to complex values for the chemical potential .",
    "it is written as @xmath113 with@xmath114 the definitions of @xmath94 and @xmath110 are the same as in ( [ 4.7 ] ) and ( [ 4.10 ] ) except with @xmath11 and @xmath103 replaced by @xmath19 and @xmath29 .",
    "the calculation of @xmath115 is similar to that of @xmath105 in ( [ 4.11 ] ) , except that it has both real and imaginary parts .",
    "their numerical calculation is straightforward but the final @xmath116 integration of ( [ 4.12 ] ) is now problematical . due to",
    "the complex integral it has an oscillatory integrand whose variation increases as @xmath29 , and whose modulation varies between values of the order @xmath117 .",
    "figure @xmath118 illustrates the problem for @xmath119 , @xmath120 .",
    "this is a precursor for the cross - over to the asymptotic analysis of section [ sec3 ] .",
    "the first difficulty of a rapidly oscillating integrand can be overcome by increasing the density of mesh points . that works in principle for both very large @xmath29 and @xmath94 .",
    "the second problem of huge cancellations when the integral is evaluated numerically as a sum over mesh points does not have a simple solution because of the finite precision of floating point numbers .",
    "as can be seen from the figure @xmath118 the highest magnitude of the integrand is @xmath121 while the final value of the real part of the integral is @xmath122 .",
    "quadruple precision is required for adequate accuracy within the restricted domain @xmath123 and @xmath124 .",
    "figures @xmath125 - @xmath126 show the dimensionless canonical ensemble free energy per particle in comparison with the corresponding grand canonical ensemble results of the last section .",
    "generally , for @xmath127 there is good agreement between the results of the two ensembles , although significant system - size dependence relative to the large system - size limit remains . at smaller values of @xmath29",
    "the discrepancies between the two ensembles decreases at lower @xmath94 .",
    "on the contrary , the difference for both ensemble from the large system limit increases with smaller @xmath29 and @xmath94 .",
    "for @xmath128 the free energy for both canonical and grand canonical ensemble are the same for given @xmath29 as it is the sum of discrete energies upto the fermi energy for @xmath29 particles .",
    "this , however , is still different from the infinite system limit which is an integral over the density of states .",
    "density functional theory ( dft ) describes the thermodynamics of an equilibrium , inhomogeneous system whose hamiltonian has the form ( [ 2.1 ] ) @xcite .",
    "the external potential implies that the local density is non - uniform .",
    "dft has a variational principle that states that the thermodynamic properties are obtained from a functional of this density at its extremum .",
    "the definition of the functional can be given as follows .",
    "first , the grand canonical ensemble pressure and density are computed as functionals of the external potential as in ( [ 2.2 ] ) @xmath129 next , the external potential is eliminated by inverting the second equation to give @xmath130 as a functional of the density and finally , the density functional of dft is then given by @xcite@xmath131 it is understood that the density and external potential in the second term are now independent functions .",
    "they become related by the extremum condition that provides the equilibrium density in terms of the external potential .",
    "finally , with that relationship established , evaluation of @xmath132 at its extremum gives the legendre transform ( [ 2.3 ] ) ( extended to the inhomogeneous case ) and hence the equilibrium grand canonical free energy .",
    "it is clear from this brief description of dft that its theoretical formulation is tied to the grand canonical ensemble .",
    "however , in practice construction of approximate functionals often presumes the large system - size limit ( e.g. , thomas - fermi and local density approximations ) .",
    "calculations almost always fix the total number of particles , @xmath29 , as in the canonical ensemble .",
    "consequently , system - size corrections and ensemble dependencies are overlooked or ignored .",
    "the analysis of the previous sections is therefore quite relevant for current problems of dft .    to illustrate this ,",
    "consider the non - interacting part of the dft functional constructed as above@xmath133 @xmath134 @xmath135 on the right side of ( [ 5.4 ] ) @xmath136 denotes the inversion of ( [ 5.3 ] ) to obtain @xmath137 as a functional of @xmath138 .",
    "further construction of @xmath139 is non - trivial for general external potential and entails diagonalization of the single particle hamiltonian @xmath140 and self - consistent inversion of the expression for @xmath138 ( the kohn - sham approach ) @xcite .",
    "a simpler method is the local density approximation that replaces the operator dependence of the external potential by its value at the point of interest , @xmath141 .",
    "then for instance the density equation can be evaluated in momentum representation using the same boundary conditions as above @xmath142 in the large system - size limit the summation can be represented as an integration and becomes the familiar finite temperature thomas - fermi approximation@xmath143 equations ( [ 5.6 ] ) and ( [ 5.7 ] ) are the same results as for the homogenous system analysis of the last section , with only the replacement @xmath144 .",
    "hence the system - size corrections found there for small @xmath145 apply here as well , and those corrections for the free energy per particle identified in figure 2 and 4(a)-4(d ) are required for the dft functional as well .",
    "notwithstanding those corrections , it is expected that differences between the results for the two ensembles are small for @xmath146",
    ". further discussion of system - size and ensemble dependence of the dft functional will be given elsewhere .",
    "the authors thank j. lutsko for sharing unpublished research and for helpful comments .",
    "the definition of @xmath38 in ( [ 2.0 ] ) can be written in the equivalent form @xmath147 with a representation for the kronecker delta @xmath148 to get @xmath149 the last line follows from the definition of @xmath150 in ( [ 2.2 ] ) .",
    "this gives the relationship ( [ 2.8 ] ) quoted in the text@xmath151"
  ],
  "abstract_text": [
    "<S> the thermodynamics for a system with given temperature , density , and volume is described by the canonical ensemble . </S>",
    "<S> the thermodynamics for a corresponding system with the same temperature , volume , and average density is described by the grand canonical ensemble . in general a chosen thermodynamic potential ( e.g. , free energy ) </S>",
    "<S> is different in the two cases . </S>",
    "<S> their relationship is considered here as a function of the system size . </S>",
    "<S> exact expressions relating the fundamental potential for each ( free energy and pressure , respectively ) are identified for arbitrary system size . a formal asymptotic analysis for large system size gives the expected equivalence , but without any characterization of the intermediate size dependence . </S>",
    "<S> more detailed evaluation is provided for the simple case of a homogeneous , non - interacting fermi gas . in this case , </S>",
    "<S> the origin of size dependence arises from only two length scales , the average inter - particle distance and quantum length scale ( thermal debroglie or fermi length ) . </S>",
    "<S> the free energies per particle calculated from each ensemble are compared for particle numbers @xmath0 for a range of temperatures above and below the fermi temperature . </S>",
    "<S> the relevance of these results for applications of density functional theory is discussed briefly .     </S>",
    "<S> + * keywords : * grand canonical ensemble , canonical ensemble , system - size dependence , free energy , homogeneous electron gas ( heg ) , density functional theory ( dft ) . </S>"
  ]
}