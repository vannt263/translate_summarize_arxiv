{
  "article_text": [
    "solar 5-min . oscillations are excited by turbulent convection ( downdrafts ) in subsurface layers of the sun .",
    "these oscillations consist of acoustic and surface gravity waves with frequencies in the range of 2@xmath08 mhz and in a wide range of wave numbers .",
    "the observed oscillations can be used for reconstruction of internal structure of the sun by methods of helioseismology .",
    "there are several methods of investigation of the interaction of traveling acoustic waves with small perturbations to the background state .",
    "one of them is the time - distance approach @xcite .",
    "the key concept of this method is measuring and inversion of wave travel times .",
    "propagation of acoustic waves in this approach is calculated using various approximations to the wave equations , such as the ray theory or first born approximation @xcite .",
    "these approximations have been tested using simple models for point sources ( e.g. @xcite ) , but not for realistic solar conditions , e.g. realistic stratification and random excitation sources .",
    "such tests , which require direct numerical simulations , are extremely important for validating the inferences from time - distance helioseismology and other local helioseismology methods .",
    "there are two main directions in numerical simulations of solar oscillations and waves .",
    "the first one is to use realistic non - linear simulations of solar convection . in such simulations ,",
    "the waves are naturally excited by convective motions .",
    "these simulations reproduce quite well the solar oscillation spectrum @xcite , and have been used for testing time - distance helioseismology @xcite .",
    "the second approach is based on linearized euler equations describing wave propagation for a given background state .",
    "the background state can be taken from non - linear numerical simulations or by perturbing the standard solar model . in this paper",
    ", we describe a numerical method and initial simulation results developed for the second approach .",
    "we developed a 3d code which utilizes a realistic physics and accurately simulates reflection of acoustic waves from the top boundary .",
    "a realistic equation of state which takes into account partial ionizations and various corrections is used .",
    "the equation of state was calculated by interpolation of the opal tables . in section 2.1",
    "we give a detailed description of the underlying physics .",
    "the main attention is paid to developing a consistent procedure for obtaining a convectively stable background model and establishing realistic top boundary conditions based on the perfectly match layer ( pml ) method . in section 2.2",
    "we describe a semi - discrete numerical scheme of high order which preserves dispersion relations of the continuous problem .",
    "the main attention is paid to developing stable high - order numerical boundary conditions consistent with the finite - difference scheme , in which the dispersion relation is preserved for the inner mesh points of the computational domain . in section 3 ,",
    "we compare the numerical and analytical solutions of various 1d test problems with an isothermal background model to validate the code , investigate accuracy of the numerical scheme , and the non - reflecting boundary conditions in a gravitationally stratified medium . in section 4 , we present results of numerical three dimensional simulations of acoustic wave field for a standard solar background model .",
    "we used different types of single or multiple acoustic sources : z - component of force or pressure , point or distributed with different time dependence .",
    "the main goals are to study properties of solar waves for various excitation sources and generate artificial wave fields for testing accuracy of the born and ray approximations and local helioseismic diagnostics of the solar interior , currently used for soho / mdi and gong data .",
    "the results of this testing will be presenting in future papers .",
    "the numerical simulations are carried out on parallel supercomputers at nasa ames research center .",
    "the propagation of adiabatic acoustic waves below the solar photosphere is described by the following system of linearized euler equations : @xmath1 where @xmath2 are the perturbations of @xmath3 velocity components , @xmath4 and @xmath5 are the density and pressure perturbations correspondingly .",
    "quantities with subscript 0 such as the pressure @xmath6 , the density @xmath7 , and the gravitational acceleration @xmath8 correspond to the background reference model and depend only on radius .",
    "christensen - dalsgaard s standard solar model s @xcite with smoothly joined chromosphere provided by @xcite was chosen as such a model . to close the system we use an adiabatic relation between eulerian variations of pressure @xmath5 and density @xmath4 @xmath9 where @xmath10 is the square of sound speed",
    ", @xmath11 is the adiabatic exponent , @xmath12 is the brunt - visl frequency , @xmath13 is the vertical displacement .",
    "so , from the background model we need only profiles of the sound speed and brunt - visl frequency .",
    "the background state is convectively unstable , especially just below the photosphere , where the temperature gradient is super - adiabatic and convective motions are very intense and turbulent .",
    "this leads to the instability of the solution of linear system ( [ lineuler ] ) .",
    "convection instability is developed on a time scale of 30 - 40 minutes of solar time .",
    "simulation of the acoustic spectrum of solar oscillations needs to perform calculations on a time interval of 5 - 8 hours of solar time , and this instability will badly distort the result . to make the background model stable against convection we slightly modified profiles of pressure and density in a thin ( 500 km in depth ) super - adiabatic layer just below the photosphere .",
    "the condition for stability against convection requires that the square of brunt - visl frequency has to be positive @xmath14 where @xmath15 is the distance from the center of the sun .",
    "the profile of @xmath16 near the solar surface is shown in the bottom left pane of figure  [ bkgmodel_fig ] by the solid line .",
    "if we replace negative values by zero ( or small positive ) value we guarantee a stability of the modified model against convection .",
    "now we can recalculate the pressure and density from the modified profile of @xmath17 .",
    "combining equation ( [ bruntvaisala ] ) with the condition of hydrostatic equilibrium , we get the following boundary value problem for @xmath18 and @xmath19 : @xmath20 \\displaystyle \\frac{{\\mbox{d}}p}{{\\mbox{d}}z } = -\\rho g,\\\\[7pt ] 0\\leq z\\leq l,\\quad \\rho(0)=\\rho_0(0),\\quad\\rho(l)=\\rho_0(l),\\quad p(l)=p_0(l ) , \\end{array}\\ ] ] where @xmath21 is the depth of the computational domain , @xmath22 is the vertical coordinate which is counted off from the bottom of the domain .",
    "we introduced a free parameter @xmath23 that has to be determined , to make the modified model closer to the original one .",
    "we established boundary conditions for the system ( [ modifiedmodel ] ) setting the density at the top and bottom boundaries equal to solar values .",
    "parameter @xmath23 does not change the condition of convective stability if it remains positive .",
    "introducing of an additional parameter permits us to establish yet another boundary condition and fix the pressure at the top boundary .",
    "so the recipe to build a convectively stable background model close to the standard one is the following .",
    "we smoothly join the density profiles of the standard solar model and the chromosphere , obtain the pressure profile from the condition of hydrostatic equilibrium , calculate square of the modified brunt - visl frequency profile @xmath24 , replacing negative values by a zero or small positive value , and substitute it into the right hand side of ( [ modifiedmodel ] ) .",
    "parameter @xmath23 , profiles of density and pressure of the modified convectively stable model are obtained as a solution of the eigenvalue problem ( [ modifiedmodel ] ) .",
    "the profile of @xmath25 , needed for the sound speed profile , is found from the realistic opal equation of state @xcite .",
    "vertical profiles of pressure @xmath6 , density @xmath7 , sound speed @xmath26 , square of brunt - visl frequency @xmath16 , adiabatic exponent @xmath25 , and acoustic cut - off frequency @xmath27 for both models ( standard with joined chromosphere and modified convectively stable ) are shown in figure  [ bkgmodel_fig ] .",
    "the depth of the domain from the photosphere equals 30 mm , the height of the chromosphere equals 2 mm , @xmath28 .",
    "the dashed curves represent profiles in the convectively stable model , the solid lines show profiles of the standard solar model .",
    "the thin vertical line marks the position of the fitting point of the chromosphere and the standard solar model .",
    "the background model , obtained with the procedure described above , is convectively stable and self - consistent .",
    "the system ( [ lineuler ] ) is written in a conservative form @xmath29 where @xmath30 is the vector of independent variables , @xmath31 is the source term containing the gravity term and acoustic sources which depend on time explicitly .",
    "the source term does not contain spatial derivatives .",
    "explicit expressions for components of vectors @xmath32 , @xmath33 , and @xmath34 can be easily found from the system ( [ lineuler ] ) .",
    "we used a semi - discrete numerical scheme . in semi - discrete",
    "approach the space and time discretization processes are separated .",
    "first the spatial discretization is performed , leaving the problem continuous in time .",
    "the spatial derivatives have been approximated by the finite difference method reducing the system of partial differential equations to the system of ordinary differential equations @xmath35",
    "\\displaystyle l_{ikj}({\\mbox{\\boldmath$q$}},t)&=&\\displaystyle -\\frac{1}{\\delta x}\\sum_{l=-3}^3a_l{\\mbox{\\boldmath$f$}}_{i , k , j+l } -\\frac{1}{\\delta y}\\sum_{l=-3}^3a_l{\\mbox{\\boldmath$g$}}_{i , k+l , j}\\\\[7pt ] & -&\\displaystyle\\frac{1}{\\delta z}\\sum_{l=-3}^3a_l{\\mbox{\\boldmath$h$}}_{i+l , k , j}+ { \\mbox{\\boldmath$s$}}_{ikj}(t ) \\end{array}\\ ] ] which can be solved by any stable time advancing method .",
    "we used four stage , 3rd order strong - stability - preserving runge - kutta method @xcite with courant number @xmath36 : @xmath37 \\displaystyle{\\mbox{\\boldmath$q$}}^{(2)}={\\mbox{\\boldmath$q$}}^{(1)}+\\frac{1}{2}\\delta t\\ , l({\\mbox{\\boldmath$q$}}^{(1)},t^n+\\frac{1}{2}\\delta t),\\\\[7pt ] \\displaystyle{\\mbox{\\boldmath$q$}}^{(3)}=\\frac{2}{3}{\\mbox{\\boldmath$q$}}^{(n ) } + \\frac{1}{3}{\\mbox{\\boldmath$q$}}^{(2)}+\\frac{1}{6}\\delta t\\ , l({\\mbox{\\boldmath$q$}}^{(2)},t^n+\\delta t),\\\\[7pt ] \\displaystyle{\\mbox{\\boldmath$q$}}^{(n+1)}={\\mbox{\\boldmath$q$}}^{(3)}+\\frac{1}{2}\\delta t\\ , l({\\mbox{\\boldmath$q$}}^{(3)},t^n+\\frac{1}{2}\\delta t ) .",
    "\\end{array}\\ ] ] the source term @xmath31 which depends on time explicitly does not require a special treatment .",
    "high - order dispersion - relation - preserving ( drp ) scheme developed by @xcite was used for spatial discretization .",
    "coefficients @xmath38 of the finite difference scheme @xmath39 are chosen from the requirement that the difference between fourier transform of the numerical scheme and fourier transform of the spatial derivative has to be minimal .",
    "taking the fourier transform of both sides of ( [ ddx_approx ] ) one can get the effective wave number @xmath40 of the fourier transform of the numerical scheme ( [ ddx_approx ] ) @xmath41 an assumption that the integral error @xmath42 of fourier transform of the finite difference scheme ( [ ddx_approx ] ) is minimal for waves with wavelength @xmath43 leads to the following equation @xmath44 or in the explicit form @xmath45 the rest five equations @xmath46 are obtained from a requirement that the numerical scheme ( [ ddx_approx ] ) approximates a spatial derivative with the 4th order . now calculation of the coefficients of 7-dot symmetrical stencil is straightforward .",
    "the explicit expressions for the coefficients are the following : @xmath47 the plots of numerical wave number @xmath48 versus @xmath49 for different numerical schemes are shown in figure  [ wavenum_fig ] .",
    "dotted , dash - dotted , dashed , and solid curves represent classic 2nd , 4th , 6th , and drp 4th order schemes correspondingly .",
    "one can see that the 4th - order drp scheme describes short waves more accurately than the classic 6th - order scheme .",
    "waves with wavelength less than @xmath50 are not resolved by the numerical scheme ( [ ddx_approx ] ) .",
    "they lead to point - to - point oscillations of the solution that can cause a numerical instability .",
    "such waves have to be filtered out .",
    "we used the following digital filter of the 6th - order to eliminate unresolved short wave component from the solution : @xmath51 where @xmath52 is the original grid function , @xmath53 is the filtered grid function , @xmath54 is the damping function , @xmath55 is the constant between 0 and 1 , determining the filter strength .",
    "the frequency response function @xmath56 of the filter relates the fourier images of the original @xmath57 and filtered @xmath58 grid functions as follows @xmath59 . in this paper , the coefficients @xmath60 of the digital filter",
    "have been chosen in such a way that @xmath61 coefficients @xmath60 of the digital filter are symmetric : @xmath62 using the technique proposed by @xcite we have found a stable 3rd - order boundary closure of the explicit dispersion - relation - preserving inner scheme ( [ ddx_approx ] ) with coefficients given by ( [ spatialcofs ] ) . obtained boundary closure has summation - by - parts properties .",
    "this approach is based on the implicit pad approximation of spatial derivatives near the boundaries @xmath63 where matrices @xmath64 and @xmath65 satisfy the following conditions :    1 .",
    "@xmath64 is symmetric non - singular matrix ( @xmath66 ) , 2 .",
    "@xmath64 is positive - definite matrix ( @xmath67 for @xmath68 ) , 3 .",
    "@xmath65 is almost skew - symmetric matrix , except corner top left and bottom right elements ( @xmath69 ) 4 .",
    "@xmath70 .    taking into account these properties",
    ", one can write explicitly the top left corners of matrices @xmath64 and @xmath65 : @xmath71 where coefficients @xmath72 of the inner scheme are defined in ( [ spatialcofs ] ) .",
    "expanding the left and right - hand sides of ( [ padederiv ] ) in taylor series at the top boundary and equating terms of the same order of @xmath73 , one can obtain a system of linear equations for coefficients @xmath74 and @xmath75 .",
    "not all of these equations are independent , so the solution depends on two free parameters @xmath76 and @xmath77 : @xmath78 to satisfy a condition of positive definiteness it is sufficient to choose matrix elements @xmath76 and @xmath77 in such a way , that the signs of coefficients of a characteristic polynomial alternate .",
    "however , this property does not guarantee a boundedness of the solution for all times , which is called asymptotic stability . to make a solution",
    "be bounded for all times , all eigenvalues of the spatial discretization operator @xmath79 from eq.([pde2ode ] ) , incorporated with the boundary conditions , must have non - positive real parts .",
    "details of this procedure can be found in @xcite . due to complexity of the original 3d problem",
    ", we have tested a stability of the scheme on 1d advection problem .",
    "distribution of eigenvalues of the drp spatial discretization operator in the complex plane for different choices of the pairs of coefficients ( @xmath77 , @xmath76 ) is shown in fig .",
    "[ eigs_fig ] .",
    "symbols plus correspond to the scheme @xmath80 , which does not exhibit asymptotic stability . circles and crosses represent choices ( 1/80 , 125/128 ) and ( -1/10 , 65/64 ) of coefficients @xmath81 correspondingly .",
    "both schemes are asymptotically stable .",
    "acoustic sources have been added to the right - hand side of equations ( [ lineuler ] ) .",
    "we used sources of two types .",
    "if we add a scalar function @xmath82 to the right - hand side of z - component of momentum equation , this term can be combined with the gravity term and interpreted as a source of z - component of force . if we add a gradient of a scalar function @xmath83 to the right - hand side of all momentum equations , these terms",
    "can be combined with components of the pressure gradient and interpreted as a pressure source .",
    "acoustic sources are spatially localized and have finite lifetime . spatial dependence is given by gaussian spherically symmetric function with semi - width of 2 - 3 grid nodes .",
    "we experimented with two different time dependencies of acoustic sources : one period of sin function @xmath84,\\ ; t_0\\leq t\\leq t_0 + 2\\pi/\\omega$ ] and ricker s wavelet @xmath85,\\ ; t_0\\leq~t\\leq~t_0 + 4\\pi/\\omega$ ] .",
    "such time dependencies were chosen because such sources are not monochromatic and have spectral power localized around central frequency @xmath86 , but spectral power is not too spread out . single or multiple acoustic sources can be added to the right hand side of equations .",
    "multiple sources are randomly distributed at some depth ( in our case it was 350 km ) and initiated independently at arbitrary moments of time .",
    "amplitudes and frequencies are randomly distributed on intervals [ 0 , 1 ] and [ 2 mhz , 8 mhz ] correspondingly .",
    "thickness of both ( top and bottom ) pmls equals 5 grid nodes .",
    "calculation of the acoustic spectrum requires long term simulations , so besides the asymptotic stability we have to prevent a spurious reflection of acoustic waves from the boundaries back to the computational domain . in this paper",
    "we follow @xcite , who proposed a procedure to construct the pml for the euler equations .",
    "it can be proofed that for a homogeneous medium and uniform mean flow without gravity pml absorbs waves without reflection for any angle of incidence and frequency .",
    "we set non - reflecting boundary conditions based on the pml at the top and bottom boundaries of the domain .",
    "the lateral boundary conditions are periodic . inside the pml independent variables",
    "@xmath87 are split into sub - components @xmath88 such that @xmath89 .",
    "thus , in the pml 3d system ( [ lineuler ] ) is split into 1d+1d+1d system of coupled locally one dimensional equations @xmath90 \\displaystyle { \\frac{\\partial { \\mbox{\\boldmath$q$}}_2}{\\partial t } } + { { \\frac{\\partial { \\mbox{\\boldmath$g$}}({\\mbox{\\boldmath$q$}})}{\\partial y } } } = 0,\\\\[7pt ] \\displaystyle { \\frac{\\partial { \\mbox{\\boldmath$q$}}_3}{\\partial t } } + { { \\frac{\\partial { \\mbox{\\boldmath$h$}}({\\mbox{\\boldmath$q$}})}{\\partial z } } } = { \\mbox{\\boldmath$s$}}({\\mbox{\\boldmath$q$}},t ) - \\sigma_z{\\mbox{\\boldmath$q$}}_3 , \\end{array}\\ ] ] where @xmath91 is the damping factor , @xmath92 is the vertical coordinate inside the pml counted off from the interface of the pml with the inner region , d is the depth of the pml .",
    "values of @xmath93 at the top and bottom boundaries are 0.3 and 1.0 correspondingly . in the paper of f.q .",
    "hu a quadratic dependence of @xmath94 on the coordinate @xmath92 is used .",
    "we were forced to add a small constant term to stabilize the pml in the presence of gravity .",
    "it is important to note , that vectors @xmath32 , @xmath33 , and @xmath34 depend only on unsplit variable @xmath87 .",
    "although @xmath95 , @xmath96 , and @xmath97 are not defined outside the pml , the variable @xmath87 , which is used for calculation of the spatial derivatives , is defined everywhere in the computational domain .",
    "hence , inside the pml near the interface with the inner region we can use the same centered stencil as for the inner points . near the top and bottom boundaries the implicit pade approximation ( [ padederiv ] ) is used which guarantees numerical stability of the scheme .",
    "we smoothly joined the chromospheric model provided by @xcite with the top of the standard solar model by christensen dalsgaard and established the top non - reflecting boundary condition based on the pml in the chromosphere above the temperature minimum .",
    "this simulates a realistic situation when not all waves are reflected by the photosphere .",
    "waves with frequencies higher than the acoustic cut - off frequency pass through the photosphere and will be absorbed by the pml layer .",
    "for validation of the code we chose 1d initial boundary value problem ( ibvp ) for linearized euler equations with constant gravity @xmath98 : @xmath99 \\displaystyle { { \\frac{\\partial } { \\partial t}}}(\\rho_0u')+{{\\frac{\\partial p'}{\\partial x}}}=g_0\\rho',\\\\[9pt ] \\displaystyle { { \\frac{\\partial } { \\partial t}}}(\\rho_0\\xi)=\\rho_0u',\\\\[9pt ] \\displaystyle p'=a_0 ^ 2\\rho'+(\\gamma-1)g_0(\\rho_0\\xi ) , \\end{array } \\begin{array}{l } 0\\leq x\\leq 1,\\quad t\\geq 0,\\\\[9pt ] \\rho'(0,t)=\\rho'(1,t)=0,\\\\[9pt ] \\rho'(x,0)=f(x),\\quad \\rho_0(x)u'(x,0)=0,\\\\[9pt ] \\displaystyle \\rho_0(x)\\xi(x,0)=-\\int\\limits_0^xf(\\eta)\\;{\\mbox{d}}\\eta , \\end{array}\\ ] ] where @xmath100 is the displacement .",
    "we need to know @xmath100 to calculate the eulerian perturbation of pressure @xmath5 .",
    "actually , the combination @xmath101 is used as a variable , so we group them together in equations .",
    "initial conditions for @xmath100 must be consistent with the initial conditions for @xmath4 .",
    "they are related by the continuity equation .",
    "waves are adiabatic , the background model @xmath102 is hydrostatic and isothermal @xmath103 .",
    "the last equation in the system ( [ ibvp_1d ] ) is the adiabatic relation ( [ adiabat ] ) written for the isothermal background model .",
    "variable @xmath104 represents here the depth from the surface .",
    "the system ( [ ibvp_1d ] ) is written in the same conservative form as the original system ( [ lineuler ] ) .",
    "this problem was chosen for testing the code because it shows all characteristic behavior of the realistic solution and yet not too complicated and can be solved analytically . formally , the variable @xmath101 can be eliminated using the continuity equation in 1d , and system ( [ ibvp_1d ] ) can be reduced to the system of two equations . however , in 3d @xmath101 can not be eliminated . to have the test example as close to the real case as possible",
    ", we left this variable and solved numerically the full system ( [ ibvp_1d ] ) .",
    "analytical solution of these equations can be obtained by the method of separation of variables @xmath105 \\displaystyle \\xi(x , t)=e^{-x/2h}\\sum_{n=1}^\\infty b_n(\\sin\\pi",
    "nx-2\\pi nh\\cos\\pi nx ) \\cos \\lambda_na_0t,\\\\[9pt ] \\displaystyle a_n=2\\int_0 ^ 1 f(\\eta)e^{-\\eta/2h}\\sin\\pi n\\eta { \\mbox{d}}\\eta,\\quad b_n = -\\frac{2ha_n}{1 + 4\\pi^2n^2h^2},\\\\[9pt ] \\displaystyle \\lambda_n=\\sqrt{\\frac{1}{4h^2}+\\pi^2n^2},\\quad h^{-1}=\\frac{\\gamma g_0}{a_0 ^ 2}. \\end{array}\\ ] ] the following distribution of density perturbation @xmath106 was chosen as the initial condition for @xmath4 : @xmath107 ^ 2\\quad \\mbox{if}\\;\\ ; 0.4\\leq x\\leq 0.6 \\\\ 0 \\end{array } \\right.\\ ] ] solution of the initial boundary value problem ( [ ibvp_1d ] ) for different moments of time with the initial density distribution given by ( [ ibvp_rhoini ] ) and parameters @xmath108 , @xmath109 , @xmath110 , @xmath111 , @xmath112 ( number of grid nodes ) is shown in figure [ ibvp_fig ] .",
    "the left column represents the density perturbation , the right one shows the vertical displacement .",
    "the solid curve is the exact solution ( [ ibvp_rhoxi ] ) .",
    "the dashed curve represents the low - order ( classic 2/1 ) numerical solution which uses the 2nd - order classic central difference approximation of spatial derivatives for inner points with the one sided 1st - order scheme at the boundaries .",
    "the high - order numerical solution is indistinguishable from the exact one .",
    "it uses the drp 4/3 scheme ( dispersion - relation - preserving spatial discretization of the 4th order for inner points with the stable boundary closure of the 3rd order consistent with the inner scheme ) . the bottom panels give the profiles of density and displacement after reflection from the bottom boundary .",
    "one can see , that the second order solution approximates the exact one well enough before the wave hits the boundary .",
    "after this the accuracy of the solution switches from the second to the first order .",
    "solution becomes too dispersive which causes nonphysical oscillations .",
    "the high - order solution based on drp 4/3 scheme reproduces the exact solution well even after @xmath113 iterations and 20@xmath030 reflections from boundaries .",
    "this test shows that the high - order drp numerical scheme does not introduce a noticeable damping or dispersion even on big intervals of integration .",
    "these simulations also test an accuracy and stability of the numerical boundary conditions .",
    "to test the efficiency of the pml for non - uniform isothermal background model we compared the numerical solution of ( [ ibvp_1d ] ) with the pml established at the top boundary with the exact solution of the same problem for infinite interval @xmath114 : @xmath115 bottom boundary condition for the numerical solution remains reflecting , because the bottom pml is inconsistent with the initial conditions for @xmath116 . at the bottom boundary in the initial moment of time @xmath117 ( see the top right panel of figure  [ ibvp_fig ] ) .",
    "if we established pml at the bottom , it would damp @xmath100 to zero value , generating non - physical perturbations near the bottom boundary which corrupt the solution . the analytical solution ( [ inf_1d ] )",
    "does not contain reflected waves , because all initial perturbations propagate to infinity .",
    "this solution can be used as a reference solution for determining the damping properties of the top pml .",
    "results are shown in figure  [ pml_fig ] at the moments of time @xmath118 0 , 0.2 , 0.4 , and 0.64 .",
    "the value @xmath119 ( density perturbation with removed exponential factor ) is plotted .",
    "the solid line represents the exact solution ( [ inf_1d ] ) , the dash - dotted line represents the numerical solution with pml at the top boundary , and the the dashed line represents the exact solution ( [ ibvp_rhoxi ] ) for the reflecting top boundary . the solid vertical line marks position of the interface between the top pml and inner region .",
    "the dashed vertical line shows position of the initial perturbation .",
    "the top pml reduces the amplitude of reflected wave by factor 20@xmath040 .",
    "our original 3d system contains acoustic sources explicitly depending on time in the right hand side of the momentum equations .",
    "we have tested the code in presence of sources on the same problem ( [ ibvp_1d ] ) with the pressure source term @xmath120 \\displaystyle { { \\frac{\\partial } { \\partial t}}}(\\rho_0u')+{{\\frac{\\partial p'}{\\partial x}}}=g_0\\rho'-{{\\frac{\\partial \\phi(x , t)}{\\partial x}}},\\\\[9pt ] \\displaystyle { { \\frac{\\partial } { \\partial t}}}(\\rho_0\\xi)=\\rho_0u',\\\\[9pt ] \\displaystyle p'=a_0 ^ 2\\rho'+(\\gamma-1)g_0(\\rho_0\\xi ) , \\end{array } \\begin{array}{l } 0\\leq x\\leq 1,\\quad t\\geq 0,\\\\[9pt ] \\rho'(0,t)=\\rho'(1,t)=0,\\\\[9pt ] \\rho'(x,0)=0,\\quad \\rho_0(x)u'(x,0)=0,\\\\[9pt ] \\displaystyle \\rho_0(x)\\xi(x,0)=0 . \\end{array}\\ ] ] for test purposes we chose gaussian shaped harmonic source function as follows @xmath121 the system ( [ src_1d ] ) can be solved analytically by quadratures @xmath122",
    "\\displaystyle g(x,\\eta,\\tau ) = 2\\;e^{(x-\\eta)/2h } \\sum_{n=1}^\\infty \\frac{\\sin\\lambda_na_0\\tau}{\\lambda_na_0 } \\sin\\pi nx \\sin\\pi n\\eta,\\\\[15pt ] \\displaystyle \\lambda_n=\\sqrt{\\frac{1}{4h^2}+\\pi^2 n^2}. \\end{array}\\ ] ] the results of numerical simulations with the source function given by ( [ src_func ] ) and parameters @xmath123 , @xmath124 , @xmath108 , @xmath109 , @xmath110 , @xmath125 , @xmath126 , @xmath127 are shown in figure  [ src_1d_fig ] .",
    "the non - reflecting boundary conditions are established on the top and bottom boundaries for numerical solution .",
    "the solid curve represents the exact solution of ( [ src_1d_fig ] ) with zero boundary conditions for @xmath4 established at @xmath128 and @xmath129 .",
    "the dashed line represents drp 4/3 numerical solution of ( [ src_1d_fig ] ) with non - reflecting top and bottom boundaries .",
    "the vertical dashed line marks the position of the source .",
    "the vertical solid line shows the position of the interface between the inner region of the computational domain and the non - reflecting pml .",
    "the numerical solution reproduces the exact one well in the inner region , and is effectively damped by the absorbing layer , preventing unwanted reflection from the bottom boundary .",
    "numerical simulations of propagation of waves in 3d from a single source inside the sun are shown in figure  [ ss_3d_fig ] .",
    "the brunt - visl frequency of the standard solar model with smoothly joined chromosphere was modified near the surface to make the model stable against convection .",
    "such modified model was chosen as the background model .",
    "non - reflecting boundary conditions ( pmls ) were established at the top and bottom boundaries .",
    "the top layer was established at the height of 500 km above the photosphere in the region of the temperature minimum .",
    "this layer absorbs all waves with frequencies higher than the acoustic cut - off frequency which pass to the chromosphere and do not affect reflection of waves with lower frequencies , because these waves are reflected from layers below the photosphere .",
    "lateral boundary conditions are periodic .",
    "the computational domain of size 120@xmath130120@xmath13050 mm@xmath131 was covered by the uniform grid of size 720@xmath130720@xmath130300 nodes with spatial intervals @xmath132 km",
    ". the time step @xmath133 sec was chosen from stability condition .",
    "the gaussian spherically symmetric pulse source of z - component of force @xmath134\\sin(\\omega_0 t),\\quad 0\\leq t\\leq 2\\pi/\\omega_0.\\ ] ] with @xmath135 mm was placed at the depth of 3.4 mm below the photosphere .",
    "for such a choice of @xmath94 semi - width of the source equals approximately 4 grid nodes .",
    "the time dependent part is just one period of sin - function with @xmath136 mhz .",
    "figure  [ ss_3d_fig ] shows snapshots of the density perturbation from such a source at @xmath137 min ( left column ) and @xmath138 min ( right column ) .",
    "the top row represents the vertical slices of the computational domain , the bottom row shows the horizontal slices at a height of 350 km above the photosphere .",
    "the thin horizontal line at @xmath139 represents the photosphere .",
    "the left column shows the disturbance from the direct wave , generated by the source .",
    "the right column shows the wave reflected from the photosphere .",
    "the reflected wave front is broader and has less amplitude , because our source has finite lifetime ( one period of sine ) and generates high frequency waves which pass through the photosphere .",
    "such waves are absorbed by the top non - reflecting layer and do not make a contribution to the amplitude of the reflected wave .",
    "the developed numerical method and code have been used for simulation of the acoustic wave field generated by multiple acoustic sources inside the sun .",
    "we found that the height of the pml affects absorbing properties of the top boundary and the shape of the acoustic spectrum ( k-@xmath140 diagram ) .",
    "reflection from the top boundary is a wave process .",
    "the waves are reflected not from the fixed level but from some vertical region .",
    "region with the acoustic cut - off frequency greater than the wave frequency @xmath141 acts as a potential barrier for such waves . even if the wave frequency is less than the acoustic cut - off frequency waves penetrate to this region with exponentially decaying amplitude .",
    "if the thickness of the barrier is finite waves can leak through it .",
    "this process is similar to the tunneling effect in quantum mechanics .",
    "this happens in the real sun as well .",
    "we studied behavior of the solution for different heights of the top boundary .",
    "all depths and heights are calculated from the level of the photosphere ( @xmath142 in the christensen - dalsgaard s standard solar model s ) .",
    "the background model varies fast in the region above the temperature minimum . to be able to simulate propagation of acoustic waves in the chromosphere",
    "we were forced to reduce the vertical spatial step to @xmath143 km to preserve the numerical stability . to keep the horizontal size of the domain as in previous simulations without significant increasing number of grid nodes the horizontal spatial steps were chosen 3 times bigger @xmath144 km . to satisfy the courant stability condition for the explicit scheme , the time step was reduced to @xmath145 sec .",
    "the computational domain of size 122.2 mm @xmath130 122.2 mm @xmath130 32 mm is covered by the uniform grid of size 816@xmath130816@xmath130640 .",
    "sources of z - component of force with random frequencies were randomly distributed at the depth of 350 km .",
    "sources are initiated at random moments of time ( one source per time step ) and depend on time as ricker s wavelet with central frequency from range 2@xmath08 mhz . in the sun",
    "we have some damping due to the turbulent viscosity .",
    "we simulated this additional viscosity by adding a damping term @xmath146 to the right hand side of z - momentum equation in the region above the photosphere and smoothly fading to zero below .",
    "the time dependence of rms ( root mean square ) wave amplitude averaged along the horizontal plane at the height of 300 km above the photosphere for different heights @xmath147 of the top boundary and different values of the damping coefficient @xmath148 is shown in figure  [ meanampl_fig ] .",
    "the rms amplitude for the high pml established at the height of @xmath149 km without additional damping @xmath148 = 0 is shown by the solid curve i. the rms amplitudes for the same height of the top pml and @xmath148 = 0.3 , 0.6 , and 1.0 are plotted by solid lines ii , iii , and v correspondingly .",
    "in the last case the rms amplitude reaches an equilibrium state .",
    "the curve iv corresponds to the low pml , established at the height of 500 km above the photosphere without additional damping in the inner region @xmath148 = 0 .",
    "rms amplitude reaches an equilibrium state in this case as well , because the acoustic modes leak through the acoustic potential barrier and their exponential tails reach the top absorbing boundary , which adds an additional damping and stabilizes the amplitude .",
    "the top boundary with the height of 1750 km is set high enough and does not affect modes with frequencies less than the acoustic cut - off frequency . energy is continuously pumped to the system by acoustic sources . the bottom boundary is deep enough that some modes resolved by numerical scheme have turning points above the bottom boundary .",
    "such modes are trapped in the domain , the total energy increases , and the rms amplitude does not reach an equilibrium state .",
    "this distorts the acoustic power spectrum and changes the amplitude ratio of trapped modes and modes that can be absorbed at the top and/or bottom boundaries .",
    "the left panes in figure  [ kw_fig ] show the acoustic power spectra obtained from observations ( top ) , simulations without damping with low ( 500 km ) top boundary ( middle ) , and high ( 1750 km ) top boundary ( bottom ) .",
    "the right panes show the vertical cuts of corresponding k-@xmath140 diagrams at @xmath150 .",
    "the bottom left pane ( high top boundary ) shows presence of g- modes in simulations .",
    "they appear because our background model is convectively stable in the thin layer below the photosphere . in the real sun",
    ", this layer is convectively unstable , and thus the g- modes do not propagate .",
    "energy leakage through the acoustic potential barrier in the case of low top boundary ( middle row ) damps all modes uniformly and does not change the shape of the acoustic spectrum .",
    "so the height of the top boundary can be used for controlling the damping rate without distortion of the acoustic spectrum .",
    "developed linear 3d code for propagation of acoustic waves inside the sun uses the realistic equation of state and realistic non - reflecting boundary conditions which permits to simulate accurately reflection of waves from the top boundary . waves with frequencies less then the acoustic cut - off frequency are reflected from the photosphere , and waves with higher frequencies pass to the chromosphere .",
    "the top non - reflecting boundary absorbs such waves .",
    "establishing the top boundary high enough in the chromosphere leads to the trapping of some modes in the domain and increasing their amplitudes with time , which distorts the shape of the acoustic spectrum .",
    "energy leakage through the acoustic potential barrier in case of the low ( 500 km ) top boundary leads to an additional uniform damping of all modes which stabilizes the amplitude and does not distort the spectrum .",
    "the height of the non - reflecting top boundary can be used as a parameter for controlling of the damping rate in the system .",
    "the acoustic spectrum obtained from simulated wave field shows existence of p- , and f - modes .",
    "the simulated acoustic spectrum is good agreement with observations .",
    "this code has been used by @xcite to model the effects of non - uniform spatial distribution of acoustic sources in sunspot regions .",
    "their results showed that this effect can explain at least a half of the observed amplitude reduction in sunspots .",
    "the code can be used for studying details of interaction of waves with inhomogeneities of solar structure and for producing artificial data for testing an accuracy of helioseismic inversion as well , as for studying of propagation of acoustic waves in the chromosphere and reflecting properties of the photosphere .",
    "future simulations will include subsurface flows and magnetic field .",
    "this research is supported by the living with the star nasa grant nng05gm85 g .",
    "the calculations were performed on columbia supercomputer at nasa ames research center ( nasa advanced supercomputing division ) .",
    "kosovichev a.  g. , duvall t.  l.  jr .",
    "1997 , in score96 : solar convection and oscillations and their relationship , eds .",
    "f.  p. pijpers , j. christensen - dalsgaard , & c.  s. rosenthal ( kluwer academic publishers , dordrecht ) , 241 ."
  ],
  "abstract_text": [
    "<S> results of numerical 3d simulations of propagation of acoustic waves inside the sun are presented . a linear 3d code which utilizes realistic opal equation of state </S>",
    "<S> was developed by authors . </S>",
    "<S> modified convectively stable standard solar model with smoothly joined chromosphere was used as a background model . </S>",
    "<S> high order dispersion relation preserving numerical scheme was used to calculate spatial derivatives . the top non - reflecting boundary condition established in </S>",
    "<S> the chromosphere absorbs waves with frequencies greater than the acoustic cut - off frequency which pass to the chromosphere , simulating a realistic situation . </S>",
    "<S> the acoustic power spectra obtained from the wave field generated by sources randomly distributed below the photosphere are in good agreement with observations . </S>",
    "<S> the influence of the height of the top boundary on results of simulation was studied . </S>",
    "<S> it was shown that the energy leakage through the acoustic potential barrier damps all modes uniformly and does not change the shape of the acoustic spectrum . </S>",
    "<S> so the height of the top boundary can be used for controlling a damping rate without distortion of the acoustic spectrum . </S>",
    "<S> the developed simulations provide an important tool for testing local helioseismology . </S>"
  ]
}