{
  "article_text": [
    "the _ map _ and _ planck _ satellites have the potential to yield enormous amounts of information about the physical conditions in the early universe ( bennett et al .",
    "1995 ; http://map.gsfc.nasa.gov ; bersanelli et al .",
    "1996 ; http://astro.estec.esa.nl/planck ) .",
    "for example , with full sky coverage and an angular resolution of @xmath4 at its highest frequency , _ map _ should return accurate measurements of the cosmic microwave background ( cmb ) temperature anisotropy at roughly one million independent points on the sky .",
    "if the temperature fluctuations are consistent with inflationary models , these measurements will provide accurate determinations of most of the significant cosmological parameters ( spergel 1994 ; knox 1995 ; hinshaw , bennett & kogut 1995 ; jungman et al .",
    "1996 ; zaldarriaga , spergel & seljak 1997 ; bond , efstathiou & tegmark 1997 ) .",
    "if they are not consistent with inflationary models , it will be even more exciting as we will need to rethink our ideas about the physics of the early universe .",
    "there are a number of non - trivial numerical steps involved in comparing @xmath5 temperature differences with the predictions of a particular cosmological model .",
    "several of the steps in the calculation are now clear .",
    "wright , hinshaw & bennett ( 1996 ) found a rapid and exact algorithm for producing megapixel cosmic microwave background maps from differential data .",
    "seljak & zaldarriaga ( 1996 ) present a fast algorithm for computing the power spectrum for a given cosmological model .",
    "however , to date , we have lacked an efficient technique for computing the power spectrum from an observed sky map .",
    "the techniques that were used to extract the power spectrum from the _ cobe _ data ( grski 1994 ; grski et al . 1994 ; bond 1995 ; tegmark & bunn 1995 ; grski et al .",
    "1996 ; hinshaw et al . 1996",
    "; tegmark 1996 ; bunn & white 1997 ) can not easily be extended to the high resolution data since these techniques require @xmath0 operations and o(@xmath6 ) storage . for a single frequency of _ map _ data , for example",
    ", this would take @xmath7 operations , with @xmath8 operations required for a combined analysis of polarization and temperature maps .",
    "all proposed techniques to date are thus wholly unequal to the task of analysing upcoming data sets ( borrill 1997 ) .    in this paper , we present a fast , accurate method for extracting the power spectrum from realistic simulations of high resolution data at a single frequency . in  2 - 5",
    "we develop our numerical method for determining the power spectrum from data containing only cosmological signal and detector noise . in  6 ,",
    "we show how the same approach can be used to directly estimate cosmological parameters from the maps . in  7 , we apply the method to realistic simulations of _ map _ data that include spatially varying noise and a galactic sky cut .",
    "we show that our numerical method recovers minimum variance , unbiased estimates of the power spectrum and of cosmological parameters .",
    "we summarize our results in  8 .",
    "a subsequent paper will extend the techniques developed here to the analysis of multi - frequency data and polarization data .",
    "the basic problem is to extract the angular power spectrum of the cmb temperature fluctuations from noisy data .",
    "we can expand the cmb temperature in spherical harmonics , @xmath9 where @xmath10 is legendre expansion of the experimental window function .",
    "if inflationary models are correct , the @xmath11 coefficients are uncorrelated gaussian random variables with zero mean and a variance that is independent of orientation @xmath12 where @xmath13 is the angular power spectrum we wish to estimate from the maps .    like _ cobe _ , _ map _ and _ planck _ will produce full sky maps at a number of frequencies . in this paper",
    ", we will focus on the analysis of the highest resolution map from _ map _ ( 0.21@xmath14 at 94 ghz ) , which is expected to contain useful signal up to at least multipole order @xmath15 .",
    "the data in a given map may be expressed as a superposition of several terms @xmath16 where @xmath17 is the cmb signal convolved with the instrument s beam response , @xmath18 is the detector noise , @xmath19 is the systematic error , and @xmath20 is the foreground emission . note that the measurement vector @xmath21 can be expressed either in a pixel basis , with components @xmath22 , the observed temperature in pixel @xmath23 , or in a spherical harmonic basis , with components @xmath24 , the observed moment of the spherical harmonic @xmath25 .",
    "the choice of basis to use for power spectrum estimation requires weighing many trade - offs which we discuss in this and subsequent sections .",
    "key among these is the form of the covariance matrix that describes the data , @xmath21 .",
    "while _ map _ will measure temperature fluctuations across the entire sky , we will want to exclude pixels in the galactic plane from our analysis , as well as other randomly located pixels that contain bright , non - cosmological sources . in this paper",
    ", we will assume that we can remove foreground emission by simply excluding the galactic plane and bright sources .",
    "the resulting incomplete coverage of the celestial sphere precludes naively evaluating a spherical harmonic expansion of the data by direct integration .",
    "the analysis is further complicated by _ map _ s inhomogeneous sampling of the sky : the noise per unit area will vary by more than a factor two between the ecliptic poles and the equator . _",
    "map _ s differential design has been optimized to minimize systematic errors and to produce maps with spatially uncorrelated noise .",
    "we will assume that we can ignore systematic errors and that the noise is uncorrelated from pixel to pixel .",
    "we have not yet tested the performance of our algorithm with maps that that contain significant pixel to pixel noise correlations or `` stripes '' .    with the above assumptions ,",
    "the covariance matrix of the data takes the form @xmath26 where @xmath27 is the covariance of the cmb fluctuations , and @xmath28 is the covariance matrix of the noise . in the pixel basis ,",
    "the noise matrix is diagonal ( @xmath29 , where @xmath30 is the @xmath31 noise in pixel @xmath23 ) while in the spherical harmonic basis the signal matrix is diagonal @xmath32 for the sake of notational simplicity , we shall henceforth set @xmath33 and solve for @xmath34 .",
    "note that the signal matrix in the pixel basis can be easily expressed in terms of spherical harmonics @xmath35 where @xmath36 is the complex conjugate of @xmath37 .",
    "the form of the noise matrix in the spherical harmonic basis is deferred to the next section .",
    "we wish to estimate the angular power spectrum from the data by explicitly maximizing the likelihood function , which , for gaussian fluctuations , has the form @xmath38 where @xmath39 is the full covariance matrix . a number of authors ( grski 1994 ; grski et al . 1994 ; bond 1995 ; tegmark & bunn 1995 ; grski et al .",
    "1996 ; hinshaw et al . 1996",
    "; tegmark 1996 ; bunn & white 1997 ) have used this approach to extract the power spectrum from the _ cobe _ data .",
    "we find the most likely power spectrum by expanding the likelihood function as a taylor series @xmath40 where the over - bar indicates the values at which @xmath41 is minimized .",
    "differentiating equation ( [ likelihood ] ) yields @xmath42 where @xmath43 in the spherical harmonic basis @xmath44 is a diagonal matrix with entries 0 or 1 , while in the pixel basis , it is given by @xmath45 where @xmath46 is the legendre polynomial of order @xmath47 , and @xmath48 is the angle between pixels @xmath23 and @xmath49 .",
    "the second order term in the likelihood function is @xmath50 the expectation value of this quantity is the fisher matrix @xmath51 where we have used @xmath52 .",
    "we can locate the most - likely power spectrum by finding where the derivative of the likelihood function is zero .",
    "let @xmath53 be a trial power spectrum , then the derivative of the likelihood in the neighborhood of @xmath54 may be written @xmath55 where we have approximated the second derivative by its expectation value .",
    "this suggests solving for the most - likely power spectrum using a variable metric method , @xmath56 note that this is exactly the newton - raphson method for non - linear systems of equations ( press et al .",
    "1992 ) , which is well known to converge quadratically near the neighborhood of a root .",
    "its only potential problem is its poor global convergence properties , which can occur when the approximation in equation ( [ taylor ] ) is not valid . in practice",
    ", we have found the likelihood function is sufficiently well - behaved that this is never a problem , even with extremely poor starting guesses .",
    "the structureless nature of the likelihood function has also been noted by other authors ( bond , jaffe & knox 1998 ) .",
    "this is easy to understand intuitively . as we demonstrate",
    "later the @xmath57 parameters are only weakly correlated with each other as the fisher matrix is diagonally dominant .",
    "thus , to first order , we are performing a series of one - parameter likelihood maximizations , with small corrections for couplings .",
    "in each dimension , the likelihood is very well approximated by a parabola ( since the probability distribution for each @xmath57 is close to gaussian ) .",
    "in particular , no local extrema exist , so there is no danger in employing newton - raphson .",
    "this also explains the extremely rapid convergence of the method  typically 3 - 4 iterations .",
    "our equations are essentially equivalent to those of bond , jaffe & knox ( 1998 ) ( in addition , tegmark ( 1997 ) obtained equivalent results by considering a quadratic optimisation problem ) .",
    "however , we have recast them into a form that is computationally more tractable .",
    "the key advance is in reducing all ostensibly @xmath0 operations to @xmath1 operations .",
    "we highlight the crucial elements of this improvement below , and discuss them more fully in subsequent sections .",
    "@xmath58 @xmath59  rather than evaluating this expression directly using choleski techniques , we solve it iteratively using conjugate gradient techniques ( press et al .",
    "1992 , barrett et al .",
    "1994 ) , which are applicable to symmetric , positive definite linear systems .",
    "a good approximate inverse or preconditioner , @xmath60 , is essential to reducing the number of iterations required .",
    "we find such a preconditioner by exploiting the approximate azimuthal symmetry of the noise pattern on the sky .",
    "this approach requires @xmath61 memory for storage and takes @xmath62 operations to compute . in addition , each iteration of the conjugate gradient method involves performing a matrix multiplication of the form @xmath63 where @xmath64 is a vector .",
    "we speed this up by writing @xmath39 as a convolution of diagonal matrices and spherical harmonic transforms . by employing fast spherical harmonic transforms ( muciaccia , natoli & vittorio 1998 ; driscoll & healey 1994 ) , we are able to reduce the cost of the matrix multiplication from @xmath65 to @xmath3 .",
    "@xmath58 tr@xmath66  we first compute this term approximately by assuming azimuthal symmetry of the noise .",
    "we then compute it exactly using monte carlo simulations of maps and exploiting the fact that @xmath67 where we have used @xmath68 .",
    "the errors obtained by computing the trace term with monte carlo simulations rather than exactly are @xmath69 times larger than the minimum variance errors , where @xmath70 is the number of simulations used to compute the trace .",
    "thus , if we generate 100 simulations , our errors will be only 0.5% larger than the minimum variance errors .",
    "the total cost of this step is @xmath71 , where @xmath72 is the number of iterations used to evaluate equation ( [ newton ] ) .",
    "@xmath58 @xmath73  note that we only require an approximate second derivative to converge to the maximum of the likelihood function ",
    "the solution is fully independent of @xmath73 .",
    "we therefore compute @xmath73 approximately using the preconditioner @xmath60 previously computed , which requires @xmath62 operations .",
    "once we obtain the maximum likelihood @xmath57 , we use monte carlo simulations to obtain their probability distribution and hence their errors .",
    "a key step in our analysis is to iteratively ( and rapidly ) solve the linear equation @xmath74 using conjugate gradient techniques .",
    "note that this solution is only used in the evaluation of terms of the form @xmath75 .",
    "thus , we have complete freedom to obtain this solution in pixel space ( where the data vector is simply the temperature map ) or in spherical harmonic space ( where the data vector is the least squares fit of spherical harmonic coefficients to the temperature map ) . in pixel space ,",
    "we can use the addition theorem for spherical harmonics to write @xmath76 which involves taking spherical harmonic transforms of the filtered , cut map , @xmath59 . in",
    "spherical harmonic space , @xmath77 is simply a diagonal matrix with ones or zeros along the diagonal , so the evaluation of @xmath78 is even simpler .",
    "our choice of the appropriate space to work in is motivated by a second consideration : the conjugate gradient technique requires that we compute an appropriate preconditioner matrix . given a linear system @xmath79 , where @xmath80 is symmetric and positive definite",
    ", the preconditioner is a symmetric positive definite matrix @xmath81 , such that @xmath82 where the eigenvalues of @xmath83 are all less than 1 .",
    "the preconditioned conjugate gradient technique then solves the system @xmath84 by generating a series of search directions and improved iterates .",
    "specifically , it generates a sequence of coupled recurrence relations for the residual vector @xmath85 and the search direction @xmath86 @xmath87 the scalar @xmath88 is chosen to minimize the quadratic function @xmath89 , where @xmath90 is the exact solution to @xmath91 @xmath92 the scalar @xmath93 is chosen to ensure that the residuals are @xmath94 orthogonal ( i.e. , @xmath95 for @xmath96 ) @xmath97 in this manner the quadratic function @xmath98 of the improved iterate @xmath99 is minimized over the whole vector space of conjugate search directions already taken , @xmath100 .",
    "the routine is initialized by setting @xmath101 for some initial guess @xmath102 , and setting @xmath103 . in general , the number of search directions required to span the vector space of possible solutions is @xmath2 ; the preconditioner reduces this by transforming the contours of @xmath98 to be as spherical as possible . to the extent that this is achieved the number of independent directions to minimize over becomes very small and the conjugate gradient routine converges quadratically .",
    "more precisely , the number of iterations required is proportional to @xmath104 , where @xmath105 is the condition number of the matrix @xmath106 ( i.e. , the ratio of its largest to smallest eigenvalue ) .",
    "further details may be found in barrett et al .",
    "( 1994 ) and press et al .",
    "( 1992 ) .",
    "there are two conflicting requirements for a preconditioner : it must be a sufficiently good approximation to the true inverse that @xmath105 is not too large , yet it must be sufficiently sparse that it is significantly easier to compute and store than the original matrix . from this",
    "comes our choice of the correct space to work in : at low @xmath47 where the signal dominates , we want to work in spherical harmonic space ( where @xmath107 is diagonal ) , while at high @xmath47 , where the noise dominates , we want to work in pixel space ( where @xmath108 is diagonal ) .",
    "thus , we begin by considering how to transform the system into spherical harmonic space . we can obtain the best - fit multipole moments , @xmath109 , by minimizing @xmath110 ^ 2 \\label{chisq}\\ ] ] where the sum is over the uncut pixels , @xmath30 is the @xmath31 noise in the @xmath23th pixel , @xmath22 is the observed temperature of the @xmath23th pixel , @xmath111 is the direction to the center of the @xmath23th pixel , and @xmath10 is the legendre transform of the experimental window function . by differentiating equation ( [ chisq ] ) ,",
    "we derive the normal equations ( press et al . 1992 ) @xmath112 where @xmath113 is the inverse of the noise matrix for the multipole moments , and @xmath114 is the variance weighted spherical harmonic transform of the temperature map .",
    "the solution of the set of normal equations is a minimum variance estimate of @xmath115 and the uncertainty in each multipole is determined by @xmath116 .",
    "the normal equations are ill - conditioned because @xmath117 has null vectors induced by the cut pixels .",
    "fortunately , we do not need to compute @xmath21 , but rather @xmath118 .",
    "we can do this by solving the linear system @xmath119 we can put this into a computationally more tractable form by multiplying both sides by @xmath120 , giving @xmath121 the reason for putting the system in this form is twofold .",
    "first , it only involves @xmath117 , not @xmath108 , which can not be easily evaluated .",
    "second , the matrix @xmath122 ( which we will apply the conjugate gradient technique to ) is well conditioned in the sense that its eigenvalues only span a few orders of magnitude . the second term  which is explicitly the signal to noise ratio  is regularized by the presence of the identity matrix .",
    "alternative forms such as @xmath123 do not share this property ",
    "these matrices have eigenvalues that span a wide dynamic range .",
    "we obtain a good preconditioner by splitting the matrix into two parts @xmath124 where @xmath125 is a sparse , approximate form of @xmath117 , given below .",
    "the lower right hand block is used for large @xmath47 where the noise dominates the signal , so that @xmath126 is small . in this regime , we obtain @xmath127 , the spherical harmonic transform of the inverse variance weighted map . at small",
    "@xmath47 the signal dominates , so we need to be able to approximate the form of the full noise matrix . for _ map _ 2-year data , we find that the above preconditioner works well if we split the matrix at @xmath128 .",
    "we now make a brief detour to explore the structure of the inverse noise matrix by expanding it in terms of the wigner 3-@xmath49 symbols .",
    "this gives us both a computationally efficient method to evaluate @xmath117 , and , more importantly , provides some insight into the structure of @xmath117 due to the sky cut and noise pattern .",
    "we first expand the inverse variance ( weight ) map in spherical harmonics .",
    "the multipole moments of this map are @xmath129 using the completeness of the spherical harmonics , we may expand the inverse noise matrix , equation ( [ noise ] ) , as @xmath130 where the terms in brackets are the 3-@xmath49 symbols .",
    "the first symbol is only non - zero when @xmath131 .",
    "the second symbol imposes the additional constraint that @xmath132 .",
    "we use numerically stable recurrence relations ( schulten , klaus & gordon , 1975 ) to compute the symbols .",
    "alternatively , @xmath117 may be computed by direct summation , which also requires @xmath3 operations .",
    "this expansion suggests a simple approximation to the weight matrix . the dominant feature in the weight map is the galactic sky cut which is , to first order , azimuthally symmetric in galactic coordinates . in the limit of pure azimuthal symmetry the weight matrix would be block diagonal ( proportional to @xmath133 ) .",
    "this suggests a preconditioner of the form @xmath134 since @xmath135 is block diagonal , we can compute its inverse in @xmath1 steps .",
    "it is actually significantly less than this , due to the decreasing size of the block matrices .",
    "the matrix @xmath136 requires the largest amount of memory for storage , @xmath61 , where the savings in the prefactor result from the facts that 1 ) we only need the full matrix up to @xmath137 , 2 ) all of the block matrices are symmetric , 3 ) the blocks are of decreasing size as @xmath138 increases , and 4 ) parity is preserved  the covariance between even and odd @xmath47 terms vanishes . for a 2 million pixel map , only 100 mb of memory is required to store the preconditioner in double precision .",
    "the block diagonal approximation is an excellent ansatz to which we need only apply small perturbative corrections .",
    "why does it work so well ? to answer this , we must understand the sparsity pattern of @xmath117 or , equivalently , its diagnostic @xmath139 .",
    "the _ map _",
    "weight map is approximately axisymmetric in ecliptic coordinates .",
    "rotation to galactic coordinates ( which imposes a tilt of about @xmath140 ) introduces a smooth , azimuthal variation in the noise pattern that can be perturbatively expanded in a fourier series @xmath141 .",
    "the approximation of galactic axisymmetry used in the preconditioner is the largest ( @xmath142 ) term in such an expansion .",
    "we can quantify the fall - off in @xmath139 with increasing @xmath138 by computing the `` power '' at each @xmath138 , defined as @xmath143 figure [ noise_expansion ] shows that corrections to the @xmath142 mode are at most a few percent .",
    "the only high frequency contribution to the weight map comes from point sources . since they only occupy @xmath144 of the sky , their effect is small .    a note on overall computational cost : each iteration of the conjugate gradient routine requires forming the products @xmath145 and @xmath146 for some work vectors @xmath147 and @xmath148 .",
    "the former involves 2 products with diagonal matrices ( @xmath149 ) and a forward and inverse spherical harmonic transform , each @xmath3 .",
    "the latter involves a matrix - vector multiplication where @xmath136 has fewer than @xmath3 non - zero elements .",
    "thus , the cost per iteration is @xmath3 , and the total cost of solving the linear system is @xmath150 .",
    "a good preconditioner is the key to minimizing @xmath72  in its absence , @xmath151 .",
    "we find that the linear system , equation ( [ zeq ] ) , can be solved in about 6 iterations for the specifications appropriate to the 2-year _ map _ data and the preconditioner specified above .",
    "this requires @xmath15230 seconds to solve for a 500,000 pixel map , and @xmath152 250 seconds to solve for a 2 million pixel map , running as a single processor job on an sgi origin 2000 .",
    "note that the preconditioner we have described is optimized for the map experiment .",
    "the choice of the appropriate preconditioner is likely to vary from experiment to experiment , in particular due to the different weight matrix @xmath117 of each experiment , depending on its survey geometry and noise properties .",
    "since the normal equations for the time - ordered data are solved in the map - making process , the weight - matrix @xmath117 already arises naturally in the previous step of the pipeline ( wright 1996 ) .",
    "its sparsity properties are therefore fairly well understood already at this point , and may be exploited in the construction of the preconditioner .",
    "this is another advantage of our approach , compared to previous techniques cast in terms of @xmath108 .",
    "note that our use of fast transforms to reduce the cost of matrix multiplies to @xmath3 is fairly general . in the complete absence of any intuition about symmetries in the noise and geometry of the experiment",
    ", one can still use the fact that almost all the matrices we deal with in cmb experiments are diagonally dominant ( the correlation function of both the signal and noise fall rapidly with separation in any experiment , and thus off - diagonal elements die rapidly ) .",
    "thus , one possibility is to approximate a matrix by its diagonal .",
    "more general techniques for sparse symmetric positive definite matrices exist , e.g. cholesky multifrontal methods ( liu 1989 ) , which can be used to build preconditioners .",
    "while we can use the preconditioner to compute @xmath153 rapidly , it is still very time consuming to evaluate @xmath154 for each value of @xmath47 by iteratively solving a linear equation for each @xmath155 term in the trace .",
    "there are two approaches to avoiding a brute force evaluation of the full trace .",
    "1 ) approximate @xmath154 as @xmath156 using the fact that @xmath157 .",
    "this returns a high quality estimate of @xmath34 .",
    "2 ) evaluate the trace for a given @xmath34 using monte carlo simulations of maps drawn from that spectrum .",
    "this approach exploits the fact that @xmath158 where we have used @xmath159 .",
    "this is the most computationally expensive part of our algorithm : it requires @xmath71 operations .",
    "therefore we first maximize the likelihood function using the approximate trace ( method 1 ) , only switching to the monte carlo evaluation of the trace once the former solution has converged .",
    "since we are very close to the true answer at this point , the monte carlo solution converges very quickly .",
    "note that the monte carlo method is guaranteed by construction to be unbiased .",
    "additionally , we can include non - linear effects in the synthetic maps that are not easily modeled in the covariance matrix @xmath39 .",
    "this will both correctly alter the maximum likelihood point and propagate through to the error estimates .",
    "we can further generalize the method to incorporate all known effects in our analysis by simulating the full analysis pipeline , rather than just the processed map .",
    "how many monte carlo evaluations of @xmath160 , where @xmath23 is a realization index , are necessary to obtain an accurate determination of @xmath161 ? to answer this question , we need to determine how the variance in @xmath162 propagates through to variance in the recovered @xmath34 .",
    "suppose we were able to calculate @xmath163 exactly for a given power spectrum @xmath34 ( e.g. , by using an infinite number of simulations ) .",
    "the variance in our recovered @xmath34 would then be given by the cramer - rao minimum variance bound @xmath164 which implies @xmath165    now we do not know @xmath163 , but @xmath166 , obtained by averaging @xmath162 over @xmath167 uncorrelated monte carlo simulations . hence , @xmath166 has a gaussian distribution , with variance @xmath168 which implies @xmath169 where we have added the errors in quadrature .",
    "thus , if we average 100 monte carlos to evaluate @xmath170 , our errors will be only 0.5% larger than the minimum variance case .",
    "we have verified these expectations numerically . for",
    "a @xmath171 pixel test map ( note that this is smaller than the @xmath172 map we analyze in subsequent sections ) , we recover @xmath34 by maximizing the likelihood function , but in each instance we compute @xmath173 using a different number of monte carlo simulations .",
    "for each solution @xmath174 we then compute @xmath175 which is expected to have a mean of @xmath176 .",
    "for consistency we must use the same fisher matrix for each @xmath70 , but this only affects the overall normalization of @xmath177 .",
    "here we have used the fisher matrix of the true underlying power spectrum .",
    "figure [ chisq ] shows that to a very good approximation @xmath178 note that the quadratic convergence of the newton - raphson method means that the number of significant digits is doubled at each iteration .",
    "we can match this rate of convergence by doubling the number of monte carlo simulations used to compute the trace at each iteration .",
    "this saves some computer time in the early iterations when high precision is not required .",
    "as with the trace , a good approximation to the true fisher matrix is given by @xmath179 where @xmath180 . since @xmath94 and @xmath181 have already been computed when forming the preconditioner , and since @xmath77 consists only of zeros and ones along the diagonal , calculating this approximate fisher matrix only entails the multiplication of block diagonal matrices , which is relatively quick .",
    "it is important to note that the newton - raphson method only requires an approximate fisher matrix to converge to the maximum likelihood solution  the final solution is independent of the fisher matrix .",
    "of course any subsequent analysis of the power spectrum , such as cosmological parameter fitting , requires accurate error estimates for the @xmath34 .",
    "these are often obtained by assuming the @xmath34 are gaussian distributed and computing their covariance matrix @xmath182 .",
    "this description is likely to be fine for large @xmath47 ( say @xmath183 ) but for small @xmath47 we would like a better description .",
    "this is because the number of independent modes ( which scales as @xmath184 ) is small for low @xmath47 , and only at large @xmath47 does the central limit theorem guarantee that the @xmath57 s are gaussian distributed .",
    "one could attempt to compute the distribution of the @xmath34 directly from the monte carlo simulations , _ independent _ of any assumptions of gaussianity . specifically , for low @xmath47 we should work with smoothed maps ( with a small number of pixels ) , which may be solved in a matter of seconds . for each realization @xmath23",
    ", one can find the maximum likelihood power spectrum @xmath185 by the same procedure used to solve for the full map . by making thousands of realisations",
    ", one immediately obtains the full probability distribution of the @xmath57 s , including higher order moments , and not just the second moment ( as in the fisher matrix formalism ) .",
    "if we sort the recovered @xmath185 s , we immediately obtain ( in general asymmetric ) confidence intervals .",
    "this monte - carlo method of computing the distribution of errors makes no assumptions about the shape of the likelihood function , apart from having an identifiable maximum .",
    "note that each realisation requires fresh computations of @xmath186 in order to iterate to convergence .",
    "it is thus prohibitively expensive ( and unnecessary ) for high @xmath47 , and we recommend this procedure up to @xmath187 .    for higher order multipoles , we need only compute the fisher matrix . in principle",
    "we can use our monte carlo results to compute @xmath188 unfortunately this is a factor of @xmath189 times more expensive than computing @xmath154 , which is prohibitive .",
    "however , we have already noted that @xmath190 thus , in principle , one can obtain the fisher matrix from the monte carlo simulations for free . in practice , we have found this to be a good recipe for computing the ( comparatively large ) diagonal elements , but to be too noisy for use in computing the ( comparatively small ) off - diagonal elements . to overcome this , we use the fact that the shape of the fisher matrix ( which also yields the window function for the @xmath34 ) depends mainly on the geometry of the weight map and only weakly on other aspects of the map .",
    "we therefore extract the shape of the approximate fisher matrix @xmath191 from equation ( [ fisherapprox ] ) and renormalize to the variances obtained from the monte carlo simulations @xmath192 i.e. @xmath193 note that for large @xmath47 , where the signal - to - noise becomes low due to beam smearing , the off - diagonal terms in the fisher matrix start to become significant .",
    "this is easy to understand intuitively : the statistics of the @xmath57 at large @xmath47 are dominated by noise , which is not rotationally invariant ( see appendix a ) .",
    "this induces correlations amongst the multipoles .",
    "however , for the signal - to - noise ratio of the 2-year _ map _ data , this effect is unimportant ( see figure [ window ] ) .",
    "we find that our results for @xmath194 change by very little if we approximate the fisher matrix as diagonal .",
    "we emphasize that our _ final _ fisher matrix is extremely accurate and may be used in good faith for parameter estimation .",
    "the calculation of the diagonal elements is exact and may be performed to arbitrary accuracy by increasing the number of monte carlo simulations .",
    "the scaling of the off - diagonal elements is approximate and uses the azimuthally averaged noise map .",
    "however , the off - diagonal elements make a small contribution to the fisher matrix to begin with , as quantified by the small change in @xmath194 .",
    "the effect of excluding non - azimuthal corrections , which are down by another two orders of magnitude ( figure [ noise_expansion ] ) , is therefore utterly negligible .",
    "thus , while it is possible to make perturbative corrections to the scaling of the off - diagonal elements , this is unnecessary in practice . another way of saying this is that the dominant source of cross talk among multipoles in the fisher matrix is the galactic cut .",
    "note that the neglect of azimuthal noise variations would _ not _ be valid for the diagonal elements since it would lead to an underestimate of the variance .",
    "one should be careful in the choice of @xmath57 used to compute the final fisher matrix .",
    "it is @xmath195 correct to use the recovered @xmath57 because they are noisy .",
    "any @xmath47 for which we recovered a low @xmath34 would be assigned a spuriously small cosmic variance contribution to its error , and hence be given more weight in any subsequent analysis .",
    "this would consistently bias any fit to the power spectrum in the direction of less power .",
    "this effect has been discussed by bond , jaffe & knox ( 1998 ) , and seljak ( 1997 ) .",
    "we therefore invoke our prior expectation that the underlying power spectrum is smooth , and smooth the recovered @xmath34 with a spline prior to forming our final error estimates ( see appendix b for the smoothing procedure ) .",
    "if we have a cosmological model that appears to be a good fit to the data , we can use the likelihood approach to directly compute cosmological parameters from a map . rather than solve for the power spectrum @xmath34",
    ", we can solve for a set of parameters , @xmath196 = ( @xmath197 , @xmath198 , @xmath199 , etc . ) , that predict the spectrum .",
    "proceeding as in  2 , we can maximize the likelihood function for @xmath196 by expanding it as a taylor series around its maximum at @xmath200 @xmath201 which leads to the analog of equation ( [ newton ] ) @xmath202 the derivatives of the likelihood function may be computed using the chain rule @xmath203 similarly , the fisher matrix of the parameters is given by @xmath204 the model power spectra may be computed with a fast numerical code ( seljak & zaldarriaga 1996 ) and the partial derivatives @xmath205 may be computed using a finite difference approximation , typically using differences of order 2% of each parameter s value . as before , one computes the first and second derivatives of the likelihood function with respect to the @xmath57 ( equations ( [ gradlike ] ) and ( [ fisher ] ) ) via monte carlo techniques .    in practice , using newton - raphson as a root finding technique in parameter space is less straightforward than when solving for the power spectrum @xmath57 . the radius of convergence , the region in which the taylor expansion is valid , is substantially smaller .",
    "its scale is set by @xmath206 .",
    "in addition , the near degeneracies between various parameters create narrow valleys in likelihood space for which a newton approach is not optimal .",
    "techniques exist which could overcome these difficulties , e.g. the levenberg - marquardt method ( press et al .",
    "1992 ) , which employs a control parameter @xmath207 to smoothly modulate between a steepest descent method ( @xmath208 ) and a newton method ( @xmath209 ) @xmath210 rather than developing such tools in this paper , we instead explore a simple @xmath194 fit to the power spectrum @xmath211 we find that this gives an excellent approximation to maximizing the full likelihood function from the map . to see why , consider the probability distribution of cosmological parameters given the recovered @xmath57 @xmath212.\\ ] ] @xmath194 fitting is a maximum likelihood estimator in the limit where @xmath73 is constant . since @xmath73 has contributions from the assumed cosmological signal ( which is being varied ) as well as from pixel noise , this is not strictly the case .",
    "however , as we demonstrate below , we determine the power spectrum with excellent precision at low @xmath47 . for @xmath213 , where the confidence bands begin to broaden , the signal to noise drops rapidly due to beam smearing . in this regime fixed pixel noise",
    "is the dominant contribution to the variance of the @xmath34 .",
    "overall , we have excellent knowledge of the fisher matrix before we begin a @xmath214 fit , so holding @xmath73 constant is an excellent approximation .",
    "a consistency check may be performed by comparing the power spectrum of the best fit cosmological model to the spline fit of the recovered power spectrum . if the two are very close , the fisher matrices computed from either one will be virtually indistinguishable .",
    "in this section , we apply our numerical techniques to a realistic simulation of the _ map _ data .",
    "we simulate two years of w band ( 94 ghz ) data using our current best estimate for the detector noise .",
    "we apply a galactic plane cut that excludes the region @xmath215 , and we cut an additional 5% of the sky at random to simulate the effect of excising extragalactic point sources .",
    "we assume that the noise is azimuthally symmetric in ecliptic coordinates and that its variance changes by a factor of two between the ecliptic pole and ecliptic plane .",
    "the maps are generated on a grid of galactic longitude and latitude points @xmath216 which result in smaller map pixels near the galactic poles ( see appendix a ) .",
    "we scale the noise per pixel inversely with pixel area , in addition to the intrinsic coverage variations .",
    "we have obtained results for a 1024 by 2048 pixel map with power up to @xmath217 , using 10 monte carlo simulations to compute @xmath218 and @xmath73 . with 10 simulations ,",
    "our expected errors are 5% larger than the minimum variance limit .",
    "the entire process converged in 5 iterations and took 10 hours of cpu time on an 8 processor sgi origin 2000 computer .",
    "the recovered power spectrum is shown in figure [ main ] .",
    "note that some negative @xmath57 at high @xmath47 are to be expected .",
    "they reflect the fact that the variance in those modes was less than that expected from the noise alone .",
    "one could adopt a prior distribution to prevent the @xmath57 from going negative .",
    "however , this would complicate the error analysis as the probability distribution of the @xmath57 would become skewed .    since we know the true input power spectrum",
    ", we can quantify the goodness of our fit by computing @xmath219 where @xmath220 , and @xmath73 is the fisher matrix of the input spectrum @xmath221 .",
    "we compute @xmath73 using equation ( [ fisher_rescaled ] ) , with 128 monte carlo simulations to compute @xmath222 .",
    "we use a large number of monte carlo simulations to ensure that we are comparing our results to the true minimum variance fisher matrix . with @xmath223 ,",
    "we obtain @xmath224 , in accordance with our expectation that it lie within the range @xmath225 ( 1 @xmath226 ) .",
    "we find that 67% of the points lie within the 1 @xmath226 error band , and 95% lie within the 2 @xmath226 band . in figures",
    "[ scatter ] and [ histogram ] we plot @xmath227 , where @xmath228 is the variance of each @xmath34 .",
    "the distribution of errors is evidently gaussian and has a mean value @xmath229 and a standard deviation @xmath230 , indicating that our results are both unbiased and minimum variance .",
    "a visually more impressive way to display the power spectrum recovery is to fit a smoothing spline to the recovered points .",
    "the details of the spline fit are given in appendix b and the results are shown in figure [ spline ] .",
    "note that exploiting the prior that @xmath57 is a smooth function of @xmath47 allows us to come spectacularly close to the form of the underlying power spectrum . as described in appendix b ,",
    "we generate confidence regions on the fit by fitting splines to 128 monte carlo simulations of @xmath34 and sorting the fits at each @xmath47 . the spline smoothing parameter has been chosen objectively using a process called cross - validation , which is a bootstrap technique ( see appendix b ) .",
    "if different criteria are used to compute the smoothing parameter , wiggles may appear in the fit ( generally at high @xmath47 ) , but it will generally stay within the depicted confidence bands .    to estimate cosmological parameters , @xmath196 , we can use the spline fit as our best guess power spectrum for computing the fisher matrix @xmath73 .",
    "( since the spline fit power spectrum and the input power spectrum are virtually identical , we have simply reused the fisher matrix of the input spectrum we have already computed . ) we then minimize @xmath231 where @xmath232 is computed for a given parameter set @xmath196 using cmbfast ( seljak & zaldarriaga 1996 ) .",
    "we consider 6 free parameters : @xmath197 , @xmath198 , @xmath233 , @xmath234 , @xmath235 , and the normalization , and we allow for a cosmological constant term , @xmath236 , to enforce a flat universe : @xmath237 .",
    "we minimize @xmath194 using an adaptive non - linear least - squares routine in the port optimization package ( gay 1990 ) after diagonalizing the fisher matrix so that @xmath194 may be written as a sum of squares .",
    "the input model used was standard cold dark matter ( scdm ) with parameter values 0.1 , 0.9 , 0.5 , 0.0 , 1.0 , respectively .",
    "a starting guess was obtained by finding the best - fit model to the spline fit by eye ( in fact , the true underlying model was unknown to one of us at the time ) .",
    "the minimization routine recovered parameter values 0.09 , 0.76 , 0.53 , 0.13 , and 1.02 , respectively . the standard errors on these parameters , as given by the parameter fisher matrix , are @xmath238 , 0.1 , 0.02 , 0.2 , and 0.015 , respectively .",
    "the best fit cosmological model yields @xmath239 with respect to the data , to be compared to 1.082 for the input model with respect to the data , both within the 2 @xmath226 range of expected variations for @xmath214 .",
    "the input power spectrum and the best fit model are plotted in figure [ paramcl ] ; they are virtually indistinguishable .    note that",
    "since the power spectrum of the best - fit model agrees closely with the spline fit , we are being self - consistent in holding @xmath73 constant .",
    "if this did not occur , a computation that allowed @xmath73 to vary might be called for . however , to the extent that the spline represents a non - parametric estimate of the underlying power spectrum , such lack of agreement might indicate deficiencies in the model , which may not have enough degrees of freedom .",
    "if one can not obtain a reasonable value of @xmath194 , even with additional model parameters , then it would be reasonable to rule out that class of cosmological models .",
    "we have developed an unbiased , minimum variance estimator for the power spectrum of temperature fluctuations in cmb maps .",
    "we have used it to estimate the power spectrum up to @xmath240 from a 2 million pixel map that simulates single frequency _",
    "map _ data ( 94 ghz ) with realistic instrument noise and sky cuts .",
    "in contrast with existing algorithms , which require @xmath241 operations , our algorithm is @xmath65 , and thus can be run overnight on existing workstations , rather than running for months at national supercomputing facilities .",
    "we anticipate further improvements in performance with more aggressive optimization ( and parallelization ) of the code .",
    "in addition , we have estimated cosmological parameters from the recovered @xmath34 and find we can recover the input model with good precision .",
    "thus , the pipeline from differential time - ordered data to cosmological parameters is now complete and well within present day computational capabilities .",
    "possibilities for future work include extensions to multi - frequency and polarization data , as well as the inclusion of galactic foregrounds and systematic effects , such as striping , in our treatment of the data .",
    "the former only incur a linear increase of order a few in the operations count .",
    "the latter must be dealt with by inclusion of the appropriate new terms in the covariance matrix , as well as subsequent simulation of the systematic effects in the monte - carlo trace computations .",
    "we have benefited from discussions with chuck bennett , peter kostelec , robert lupton , bill press , george rybicki , michael strauss , max tegmark , michael vogeley , and ned wright .",
    "spo , dns , and gh are supported by nasa s _ map _ project .",
    "barrett , r. , et al .",
    "1994 , templates for the solution of linear systems : building blocks for iterative methods ( siam : philadelphia ) .",
    "available at http://www.netlib.org/templates/templates.html    bennett , c.l . ,",
    "hinshaw , g. , jarosik , n. , mather , j.c . , meyer , s.s .",
    ", page , l. , skillman , d. , spergel , d.n . , wilkinson , d.t .",
    ", & wright , e.l .",
    "1995 , baas , 187 , 7109    bersanelli , et al .",
    "1996 , report on the _ cobras / samba _ phase a study , esa    bond , j.r .",
    "1995 , , 74 , 4369    bond , j.r . , efstathiou , g. , & tegmark , m. 1997 , , 291 , l33    bond , j.r . ,",
    "jaffe , a.h . , & knox , l. 1998 , , 57 , 2117    borrill , j. , 1997 , astro - ph/9712121    bunn , e.f , & white , m. , 1997 , , 480 , 6    dilts , g.a .",
    "1985 , journal of computational physics , 57 , 439    driscoll , j.r . , & healy , d.m .",
    "1994 , advances in applied mathematics , 15 , 202    gay , d.m .",
    "1990 , computing science report no .",
    "153 , at&t bell laboratories    grski , k.m . 1994 , , 430 , l85    grski , k.m",
    ". 1998 , private communication    grski , k.m . ,",
    "hinshaw , g. , banday , a.j . , bennett , c.l . ,",
    "wright , e.l .",
    ", kogut , a. , smoot , g.f . , & lubin , p. 1994",
    ", , 430 , l89    grski , k.m . ,",
    "banday , a.j . ,",
    "bennett , c.l . ,",
    "hinshaw , g. , kogut , a. , smoot , g.f . , & wright , e.l .",
    "1996 , , 464 , l11    hinshaw , g. , bennett , c.l . , & kogut , a. 1995 , , 441 , l1    hinshaw , g. , banday , a.j . , bennett , c.l . ,",
    "grski , k.m . ,",
    "kogut , a. , smoot , g.f . , & wright , e.l .",
    "1996 , , 464 , l17    healy , d.m . , rockmore , d. , moore , s.s.b .",
    "1996 , dartmouth college technical report pcs - tr96 - 292    jungman , g. , kamionkowski , m. , kosowsky , a. , & spergel , d.n .",
    "1996 , , 54 , 1332    knox , l. 1995 , , 52 , 4307    kostelec , p. 1998",
    ", private communication    liu , j.w.h .",
    "1989 , acm transactions on mathematical software , 15 , 310    muciaccia , p.f . , natoli , p. , & vittorio , n. 1998 , , 488 , l63    press , w.h . ,",
    "teukolsky , s.a . , vetterling , w.t . , & flannery , b.p .",
    "1992 , numerical recipes : the art of scientific computing , 2nd ed . , ( cambridge : cambridge university press )    schulten , klaus , & gordon 1976 , computer phys.comm . , 11 , 269 .",
    "code is available at http://www.netlib.org/slatec/src/drc3jj.f    seljak , u. , 1997 , astro - ph/9710269    seljak , u. , & zaldarriaga , m. 1996 , , 469 , 437    spergel , d.n .",
    "1994 , warner prize lecture , baas , 185.7301    stroud , a.h .",
    "1971 , approximate calculation of multiple integrals , ( englewood cliffs : prentice - hall )    taylor , m. 1995 , siam , j.numer.anal .",
    ", 32 , 667    tegmark , m. 1996 , , 464 , l35    tegmark , m. 1997 , , 55 , 5895    tegmark , m. & bunn , e.f .",
    "1995 , , 455 , 1    wahba , g. 1990 , spline models for observational data , ( siam , philadelphia )    wright , e.l . , 1996 , astro - ph/9612006    wright , e.l . , hinshaw , g. , & bennett , c.l .",
    "1996 , , 458 , l53    zaldarriaga , m. , spergel , d.n . , & seljak , u. 1997 , , 488 , 1",
    "the algorithm presented in this paper relies heavily on the fact that we have available fast , @xmath3 , forward and inverse spherical harmonic transforms on the sphere , as opposed to standard @xmath1 transforms .",
    "we use a formulation which employs ffts in @xmath242 , and thus requires that the map pixels be distributed on rows of constant @xmath243 .",
    "the scheme was first brought to the attention of the cmb community by muciaccia , natoli & vittorio ( 1998 ) .",
    "alternative formulations exist ( dilts 1985 ) which also use ffts in the @xmath243 direction .",
    "the most sophisticated implementation requires only @xmath244 operations for both transforms , by using fast legendre transforms ( driscoll & healey 1994 , healy , rockmore & moore , 1996 ) . in practice ,",
    "due to cache problems in the use of precomputed data , current implementations run no faster than the naive @xmath3 algorithms , though work is presently underway to remove this barrier ( kostelec 1998 ) . for completeness",
    ", we summarize the transform method below .    * making maps *  given a set of @xmath245 s , we wish to evaluate @xmath246 now , observing that we can interchange the order of summation @xmath247 we can write @xmath248 where @xmath249 the legendre functions @xmath250 may be generated using standard recursion relations .",
    "the obvious motivation for writing the expansion in this form is to employ fft techniques in the evaluation .",
    "what is our total operations count ? at fixed @xmath251 , we need to generate @xmath252",
    "@xmath253 s .",
    "( note therefore that our memory storage requirements are @xmath254 , which is entirely feasible ) . since there are @xmath255 @xmath251 s to step through",
    ", the total operations count is @xmath256 .",
    "the cost of the fft at fixed @xmath257 is only @xmath258 . since there are @xmath259 @xmath257 s to step through , the fft s only cost @xmath260 .",
    "thus , to leading order , map making is an @xmath3 process .",
    "* inverting maps *  the formal inverse transform is defined in terms of an integral @xmath261 which may be evaluated with a cubature formula @xmath262 where the integration weight @xmath263 is essentially the solid angle of pixel @xmath23 . assuming that our pixels are equally spaced in @xmath242 at a given @xmath243 , this may be cast in the form @xmath264 with @xmath265 where @xmath266 is proportional to the pixel solid angle at @xmath251 .    in practice , we actually wish to evaluate expressions of the form @xmath267 where @xmath268 is some function on the sphere .",
    "these terms arise in the normal equations , ( [ noise ] ) and ( [ tlm ] ) , where @xmath41 is an inverse variance weighted temperature map , and in the factorization of matrices into convolutions of a diagonal matrix with the spherical harmonics , as in equation ( [ pixelsignal ] ) .",
    "this expression is distinct from the formal inverse transform , but may be evaluated using the same fft methods by substituting @xmath41 for @xmath269 and omitting the integration weights .",
    "the reader can easily verify that inverting maps is also an @xmath3 process requiring only @xmath254 memory storage .",
    "one can also exploit various symmetries , such as @xmath270 , and @xmath271 to further speed up the transforms . in practice , we find the lion s share of cpu time for both the forward and inverse transforms is spent in generating the @xmath250 . since we already demand @xmath3 storage for the preconditioner matrix , it is only a modest increase to store the @xmath250 in memory , which is also an @xmath3 requirement .",
    "( note that only one hemisphere need be stored . )",
    "this generally leads to an order of magnitude decrease in cpu time : for example , the time required for each @xmath137 transform is reduced from 25 s to 3 s. at present , we find that each @xmath240 transform takes about @xmath272 as a single processor job on an sgi origin 2000 .",
    "we close this appendix with some comments about the role of pixels in the evaluation of inverse spherical harmonic transforms .",
    "the cubature formula provides a formal check on pixelization schemes by ensuring that pixelization errors are negligible , i.e. that there is no information loss in going from a continuous to a discrete field .",
    "formally this implies specifying a grid @xmath273 and integration weights @xmath274 such that the integration error @xmath275 vanishes when @xmath41 is a polynomial of degree @xmath276 . in this paper",
    "we employ a spherical product gauss cubature formula for integrating over the sphere ( see , e.g. , stroud 1971 ) .",
    "this scheme has the property of requiring the minimum number of pixels for a given polynomial degree of any pixelization scheme .",
    "the grid points in @xmath242 are given by the zeroes of the fourier basis sines and cosines ( simply the equiangular grid ) , while the grid points in @xmath243 are given by the zeroes of the legendre polynomial basis .",
    "standard routines for calculating the grid points and weights , @xmath266 , for the associated legendre quadrature formula exist ( press et al . ,",
    "this grid has negligible integration error and also has the slight advantage over a purely equiangular grid that the grid points and weights are a function of the integration range .",
    "the arrangement of sampled points can therefore be made optimal for a sphere with a galaxy cut .",
    "this pixelization scheme does have elongated pixels of smaller area near the poles .",
    "thus , since pixel noise scales with pixel area , our scheme contains a disproportionately large number of noisy pixels near the poles . in practice ,",
    "we have not found such endpoint apodizing to be harmful .    what are the optimal choices for @xmath277 and @xmath278 in terms of @xmath279 ? in terms of the gaussian cubature formula , the optimal choice is @xmath280 , @xmath281 , which integrates _ exactly _ the first @xmath282 spherical harmonics .",
    "the accuracy of this grid is easily verified numerically by observing the exact orthonormality of the first @xmath282 spherical harmonics on the full sky .",
    "( note that _ cobe _ type pixelization schemes , which have equal area per pixel , require a substantially larger number of points to achieve the same accuracy . )",
    "note that because the number of @xmath245 s is half the number of integration points , the spherical harmonic transform is _ not _ invertible unless the integrated function is bandwidth limited to @xmath283 .",
    "indeed , it has been proven ( taylor 1995 ) that there does not exist _ any _ cubature - based discrete spherical harmonic transform with the same number of points as spectral coefficients .",
    "this highlights an important difference between fourier analysis on @xmath284 and on @xmath285 .",
    "consider any arbitrary 2d function @xmath286 .",
    "if mapped onto the plane , we can obtain fourier coefficients @xmath287 with @xmath288 , @xmath289 , which is invertible . on the sphere , however , the spherical harmonics by design only span the space of functions invariant under rotations .",
    "this implies symmetries between the @xmath243 and @xmath242 directions , which in the spherical harmonic basis imply that even though @xmath288 , @xmath289 , half the terms are missing as @xmath290 for @xmath291 .",
    "this reduction in the number of spectral coefficients leads to loss of information ( by a factor of 2 ) for functions which do not respect such symmetries , and which thus will no longer be invertible .",
    "note that there do not exist any discrete pixelizations of the sphere which are invariant under the full group of rotations ( for instance , ecp is only azimuthally symmetric ) , due to the finite number of platonic solids .    for practical purposes ,",
    "the cmb signal is band - width limited , as beam smearing virtually destroys any signal above some @xmath279 .",
    "however , the noise map is not bandwidth limited and can not be projected onto a finite set of spherical harmonics .",
    "we see that by noting that the underlying weight map is not rotationally invariant ( i.e. , not statistically isotropic ) , in general , which is why the noise matrix @xmath116 is dense , even over the full sky .",
    "this has important practical consequences when maximizing the likelihood function .",
    "in particular , one is not free to transform between pixel and spherical harmonic space .",
    "it is impossible , for instance , to precondition in spherical harmonic space and maximize the likelihood in pixel space : the ( essentially noise ) eigenvalues are wiped out in spherical harmonic space but are retained in pixel space .",
    "we emphasize that our algorithm is independent of the pixelization scheme , as long as fast spherical harmonic transforms are available .",
    "for instance , the healpix scheme ( gorski 1998 ) , which uses equal area pixels , is also a viable option .",
    "we have presented an algorithm for extracting the minimum variance power spectrum , @xmath34 , and its error matrix , @xmath292 , from a map .",
    "this is all that is needed to make comparisons with gaussian theoretical models .",
    "however , there are at least two good reasons why one would like to fit a smooth curve to the @xmath34 data .",
    "1 ) we have argued that it is better to construct the experimental fisher matrix from the smoothed @xmath57 to avoid bias in any subsequent analysis .",
    "2 ) for the purpose of visual presentation we would like an aid to guide the eye though a forest of data points .",
    "the usual smoothing procedure is to either bin the data or employ a moving average , which reduces the errors by @xmath293 , where @xmath235 is the number of points in each bin .",
    "the drawback of such a procedure is that while the zeroth- and first - order moments of the data are preserved , higher order moments are not . in particular , if the underlying function has a non - zero second derivative ( e.g. , at an acoustic peak ) , a bias is introduced ( press et al .",
    "a significant improvement would be to approximate the data as piecewise polynomial , rather than piecewise constant , as with savitzky - golay smoothing filters ( press et al . 1992 ) .    however , we advocate fitting a least - squares weighted smoothing spline ( wahba 1990 ) to the recovered @xmath57 .",
    "such a fit is non - parametric and model - independent in the sense that we allow ourselves @xmath294 degrees of freedom .",
    "we find the cubic spline @xmath295 which minimizes the quantity @xmath296 the smoothing parameter @xmath207 , which controls the usual trade - off between smoothness and fidelity to the data , is chosen to satisfy the relation @xmath297 where @xmath298 .",
    "the slight freedom we have in selecting @xmath207 within this range is analogous to the freedom we have to select a bin size in an averaging scheme .",
    "we proceed with the fit iteratively : first , employing the fisher matrix of the unsmoothed data , we construct a preliminary smoothing spline . next , generating a new fisher matrix from @xmath295 , we construct a second and final smoothing spline .    an alternative approach to choosing",
    "@xmath207 is to use cross - validation .",
    "this is essentially a bootstrap technique in which @xmath207 is chosen so that the spline best approximates the data at any given @xmath47 if it is computed with all the data except @xmath34 . in general , the two methods give similar results .",
    "the fits in this paper were obtained using cross - validation .    to compute errors on our spline fit ,",
    "we employ bootstrap resampling .",
    "specifically , we calculate the exact fisher matrix from @xmath295 and generate a series of synthetic power spectra , @xmath185 from this fisher matrix",
    ". this will be accurate to the extent that we have accurately computed @xmath73 .",
    "one can also generate @xmath185 assuming they are drawn from distributions with dispersion @xmath299 , which ignores correlations between the @xmath57 .",
    "the two methods give very similar results .",
    "we then compute the smoothing spline for each realization @xmath185 and sort the results at each @xmath47 .",
    "this allows us to generate confidence intervals for the spline fits .",
    "figure [ spline ] shows the customary 68% confidence band .",
    "the use of a smoothing spline entails a small but non - negligible bias because the mean of the monte carlo spline fits does not equal the input power spectrum .",
    "such effects are well - known ( wahba 1990 ) .",
    "we calibrate this bias from the monte carlo simulations and apply it to our best fit spline and confidence bands .",
    "note also that the confidence bands of the spline fit are not symmetric about the mean value , particularly near a peak .",
    "the use of monte carlo simulations gives us the probability distribution of the spline fits and thus a firm handle on such effects ."
  ],
  "abstract_text": [
    "<S> there is enormous potential to advance cosmology from statistical characterizations of cosmic microwave background sky maps . </S>",
    "<S> the angular power spectrum of the microwave anisotropy is a particularly important statistic . </S>",
    "<S> existing algorithms for computing the angular power spectrum of a pixelized map typically require @xmath0 operations and @xmath1 storage , where @xmath2 is the number of independent pixels in the map . </S>",
    "<S> the _ map _ and _ planck _ satellites will produce megapixel maps of the cosmic microwave background temperature at multiple frequencies ; thus , existing algorithms are not computationally feasible . in this article </S>",
    "<S> , we introduce an algorithm that requires @xmath1 operations and @xmath3 storage that can find the minimum variance power spectrum from sky map data roughly one million times faster than was previously possible . </S>",
    "<S> this makes feasible an analysis that was hitherto intractable . </S>"
  ]
}