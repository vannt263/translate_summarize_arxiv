{
  "article_text": [
    "the advanced ccd imaging spectrometer ( acis ) instrument on the chandra x - ray observatory @xcite employs bulk front - illuminated ( fi ) and back - illuminated ( bi ) ccds to give good spectral resolution and good 0.210  kev quantum efficiency ( qe ) @xcite .",
    "these devices , designed and manufactured at mit s lincoln laboratories @xcite , couple with the chandra mirrors to provide spatially - resolved x - ray spectroscopy on spatial scales comparable to ground - based optical astronomy .    due to the unanticipated forward scattering of charged particles ( probably mainly @xmath1100 kev protons , @xcite ) by the chandra mirrors onto the acis ccds ,",
    "the fi devices have suffered degraded performance on - orbit , most pronounced at the top of the devices , near the aimpoint of the imaging array .",
    "this radiation first encounters the gate structure of fi devices , causing charge traps that increase the charge transfer inefficiency ( cti ) of these devices , resulting in gain variations , event grade distortions , and degraded energy resolution as a function of row number . due to the manufacturing process",
    ", the acis bi devices have always shown modest cti effects , but the silicon covering the gates protects them from severe radiation damage on - orbit so they show no additional cti . our ongoing efforts to mitigate the bi cti by modeling and post - processing the data allow us to address the new problem of fi cti in a timely fashion .    figure  [ fig : allenergy - cti ] ( upper panel ) illustrates the effects of cti on the acis i3 chip by showing the row - dependent gain and energy resolution for spectral lines in the external calibration source ( ecs ) ( from low to high energy : al  k@xmath2 , ti  k@xmath2,@xmath3 , mn  k@xmath2,@xmath3 ) .",
    "the data were filtered to keep asca - like grades 0 , 2 , 3 , 4 , and 6 ( `` g02346 '' , @xcite ) only .",
    "note that the charge loss is more severe at higher energies ( the loci steepen with line energy ) .",
    "this dataset , obtained after the damage was discovered and satellite operations were modified to prevent further degradation , is representative of the state of the cti from mid - september 1999 to the end of january 2000 , when the acis focal plane temperature was lowered from -110c to -120c . at this new colder temperature , the trap population that causes the row - dependent energy resolution",
    "is partly suppressed @xcite .",
    "cti redistributes the charge in each event among the pixels in the 3@xmath03 island ( grade `` morphing '' ) as some charge traps release their charge on short timescales , so that charge reappears in adjacent pixels .",
    "this grade morphing , coupled with the standard g02346 grade filtering , causes the qe to vary with event energy and position on the device .",
    "we have developed and optimized a model of cti that accounts for charge loss and the spatial redistribution of charge ( `` trailing '' ) , in both the parallel and serial registers , thus reproducing the spatially - dependent gain , qe , and grade distribution of these devices . by forward modeling of these effects separately for each event",
    ", we produce a `` cti - corrected '' event list that is useful for data analysis and astrophysical interpretation .    for the bi devices , we must model parallel and serial charge loss and trailing independently to match the data .",
    "there are charge traps in the imaging array , framestore array , and serial register . since the fi devices were damaged by radiation that penetrates only a few microns into the device @xcite , their ( shielded ) framestore arrays and serial registers are protected .",
    "so , although the cti is more pronounced on fi devices , it is easier to model than in the bi devices .",
    "our techniques are described in more detail , with more emphasis on the bi devices , in a separate article @xcite .",
    "our cti model is phenomenological , characterizing the effects of cti in the data rather than directly modeling the spatial distribution and time constants of the trap population ( see @xcite and @xcite for examples of such physical models ) .",
    "the charge lost and trailed into the adjacent pixel are given by @xmath4 ; @xmath5 where @xmath6 is the charge in a single pixel , @xmath7 is the charge lost per pixel transfer , @xmath8 is the charge trailed per pixel transfer , and the @xmath9 s are the cti parameters .",
    "we chose power law functional forms for these relations because they adequately fit the data and ensure zero charge loss or trailing when there is zero charge present .",
    "the parameters @xmath10@xmath11 are determined by fitting lines to pixel amplitude versus x and y chip positions for many energies .",
    "examples of each of these fits are shown in @xcite . to apply cti to a given event",
    ", these equations are calculated for each pixel in the event , then the resulting numbers are multiplied by the number of pixel transfers to determine how much charge to remove from each pixel in the event .",
    "the trailed charge is then added back into the appropriate adjacent pixel .",
    "note that our model is `` local ''  prediction of the amount of charge lost by a particular event does not consider the possibility that another event falling in the same columns but closer to the amp will have filled some portion of the traps , reducing the charge loss from its nominal value @xcite .",
    "we do however consider shielding effects that may occur within the nine pixels of a single event .",
    "for example , an isolated pixel of height 1000 data numbers ( dn , the digital units of charge output by acis , @xmath124  ev ) will encounter more empty traps ( suffer more loss ) than a pixel of height 1000  dn that is immediately following a pixel of height 400  dn .",
    "the `` leading '' pixel s charge is sacrificed to fill the traps encountered by the event , shielding the 1000  dn pixel .",
    "thus we apply our loss model only to the portion of the pixel s charge that is larger than its predecessor s . in this example",
    ", the 1000  dn pixel will suffer loss and trailing approximately the same as a 600  dn isolated pixel .",
    "details of the shielding model are given in @xcite .",
    "although acis fi devices do not exhibit serial cti , they do show a small charge loss effect which is proportional to the distance between the ccd pixel and the left or right edge of the ccd .",
    "this is believed to be caused by the slight drop in clocking voltages suffered between the middle of the ccd and the supply leads at the chip edges ( m.  w.  bautz , private communication ) .",
    "cti scales the effect so that these gain variations are row - dependent , with the bottom rows of the chip showing virtually no variation and the top rows varying by up to @xmath1100 dn at high energies ( @xmath16 kev ) .",
    "we model this gain variation for each amp as a linear function of distance from the readout node , averaging over all rows .    to account for nonlinearities",
    "not modeled directly by the fits described above , we also incorporated a `` cti deviation map '' into our model that refines the cti for each event s specific location on the chip .",
    "this map is produced by examining the residual gain variations left after the basic model is applied . by correcting ecs data with and without this deviation map , we have determined that including it improves the final results .",
    "see @xcite for details .",
    "having modeled cti , we can try to remove its effects from actual acis events , taking a forward - modeling approach . for each _ observed event _ , we first hypothesize the nine pixel values of a corresponding _ true event _ , _ i.e. _  the event that would have been obtained if no cti effects were present .",
    "this _ true event _ is passed through the cti model , producing a _ model event_. the hypothesis is then adjusted pixel - wise by adding the difference between _ observed event _ and _ model event _ to _ true event _ and repeating the process .",
    "this iterative adjustment continues until _ model event _ and _ observed event _ differ by less than one dn , at which point _",
    "true event _ constitutes the cti - corrected event .",
    "the performance of the corrector in removing the observed spatial variation of event energy in ecs data is shown in the lower panel of figure  [ fig : allenergy - cti ] .",
    "the corrector has largely removed the gain changes across the device . since the spectral broadening with row number is primarily the result of a random process involving one of the trap species @xcite , it can not be suppressed in our reconstructed events .",
    "the success of the cti corrector in regularizing the grade distribution at the top of an fi device is shown in table  [ tbl : grade_migration ] , combining a broad range in energies ( 0.57 kev ) made up of the al , ti , and mn calibration lines .",
    "for example , 43.6% of events migrated from grade 2 to grade 0 during cti correction .",
    "crrrrrrrr|rc    0 & 9.3 & 0.0 & 43.6 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 52.9 & 49.7 + 1 & 0.0 & 0.0 & & 0.0 & 0.0 & 0.2 & 0.0 & 0.1 & 0.4 & 0.3 + 2 & 0.0 & 0.0 & 11.3 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 11.3 & 16.0 + 3 & 0.0 & 0.0 & 0.0 & 0.3 & 0.3 & * 0.2 * & 4.7 & 0.0 & 5.5 & 6.0 + 4 & 0.0 & 0.0 & 0.0 & 0.3 & 0.3 & * 0.1 * & 4.6 & 0.0 & 5.3 & 5.9 + 5 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.3 & & 0.3 & 0.9 & 0.5 + 6 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 7.2 & * 4.1 * & 11.3 & 13.5 + 7 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 & 12.3 & 12.3 & 8.0    table  [ tbl : grade_migration ] demonstrates an improvement in qe after cti correction .",
    "figure  [ fig : qe ] illustrates this in more detail . for low - energy events ( _ e.g. _  al k ) the charge is more spatially concentrated , leading to more single - pixel events .",
    "cti causes these to morph into grades that are still captured in the standard grade filtering , so the qe at the top of the device is not affected by cti . at higher energies ( _ e.g. _  mn k ) events are often intrinsically split , so grade morphing causes them to be lost to asca - like grade 7 .",
    "the corrector can recover some of these events , but clearly the qe is still row - dependent .",
    "this is due in part to telemetry constraints : certain acis grades are not transmitted to the ground because they are primarily cosmic ray events and would saturate telemetry . when cti causes legitimate photon events to grade morph into these grades , they are lost forever .",
    "other events are not recovered into their original grades because the corrector is unable to recover charge that has been eroded by cti down below the split threshold  at that level , the charge is indistinguishable from noise and the corrector is purposely not allowed to include such pixels in its reconstruction .",
    "note that the bottom quarter of the device is largely unaffected by the cti degradation and thus retains the original performance of the detector .",
    "the cti corrector consists of a set of idl ( research systems inc . )",
    "programs and parameter files that instantiate the model for each amplifier on each ccd , for a given epoch of the chandra mission .",
    "the code is available ( www.astro.psu.edu/users/townsley/cti/corrector/ ) and may be of interest to other groups concerned with the results of radiation damage on x - ray and optical ccd detector systems .",
    "this website is intended to provide _ an example _ of the corrector , not an exhaustive and complete set of correction code immediately applicable to any dataset .",
    "the fi corrector must be optimized to match the cti present at the time of the observation in question , since the cti has changed over the course of the mission .",
    "this can be achieved by tuning the corrector s parameters on the ecs dataset taken most closely in time to the target observation .",
    "there is an uncertainty introduced by using calibration data to tune this or any other model : we must assume that the cti measured by the ecs is representative of that present in celestial data .",
    "most acis events are due to particle interactions and are not even telemetered .",
    "it is primarily these events that fill traps and thus regulate cti . since most of these particle events are from cosmic rays that are not stopped by the observatory structure , it is reasonable to assume that ecs and celestial data have comparable particle fluxes , thus a comparable trap population .",
    "we have used the instrumental au  l@xmath2 ( 9.7 kev ) and ni  k@xmath2 ( 7.5 kev ) lines as rough diagnostics of the corrector s performance on celestial data .",
    "tests show that the corrector works fairly well even at these high energies ( well above the energies used to tune it ) , reducing the charge loss per pixel transfer by a factor of @xmath110 .",
    "better results might be obtained by hybridizing the corrector optimization process to include both celestial and ecs data .",
    "another implication of tuning the corrector to ecs data is that we have no calibration information below al  k@xmath2 ( 1.486  kev ) .",
    "understanding the behavior of the ccds between 0.2 and 1.5 kev is important for obtaining accurate hydrogen column densities , comparing acis results to rosat results , and inferring valid astrophysics for the large number of soft sources chandra will examine . as a preliminary example , we consider the supernova remnant e0102 - 72.3 , used as a soft calibration source for chandra .",
    "the cxc provided us with two calibration datasets on this target ( n. schulz , private communication ) , one with the target near the readout of node 2 on the i3 chip ( `` obsid 49 '' ) and a second with the target half - way up the chip ( `` obsid 48 '' ) , on the same node .",
    "an observation with the target near the top of the chip is scheduled and will be included in subsequent analysis .",
    "these data were obtained in january 2000 but cti - corrected with the code tuned to ecs data obtained the previous september . even though the corrector was not tuned below 1.486 kev and was based on the cti present 4 months prior to the e0102 - 72.3 observations , the corrected data for _ both _ observations showed the soft lines in this source at the correct energies to within @xmath131% above 800 ev and to within @xmath132% between 500 and 800 ev .",
    "the grade distributions before and after correction were identical , to within statistical uncertainties , for obsid 49 .",
    "grade migration was noticeable in the raw data from obsid 48 .",
    "cti correction restored the grade distribution to values consistent with obsid 49 . with future data",
    "we hope that e0102 - 72.3 can be used to calibrate the corrector as well as to check it .",
    "the uncertainties outlined above should encourage acis users to treat their data with care and caution .",
    "this is especially important for public calibration targets observed before mid - september 1999 , as the cti was changing rapidly then .",
    "users of acis data must be aware of cti and its spatial and spectral effects in order to generate astrophysically relevant results . without cti correction , accurate analysis of acis data",
    "requires a strongly position - dependent response matrix ( `` .rmf file '' ) and qe map ( part of the `` .arf file '' ) .",
    "these of course depend on the user s choice of grade filtering ; it is not clear that the usual asca - like grade filtering is optimal for sources far from the readout nodes .",
    "our cti corrector improves the photon energy estimates and significantly corrects for grade morphing .",
    "the corrector also improves the energy resolution of the acis devices more than can be achieved by only accounting for the row - dependent gain variations .",
    "using these features , we recover linewidths in the external calibration source data that are on average 10% narrower ( for both fi and bi detectors ) than parallel gain detrending alone can provide .",
    "these features mean that cti - correcting acis event lists will yield several benefits for the end user .",
    "correcting for grade morphing yields more high - energy counts and thus gives deeper source detection for hard sources ; since most source - finding algorithms rely on a threshold number of counts to constitute a detection , adding even a modest number of counts can increase the number of detections significantly .",
    "for example , @xmath115% more hard ( 28 kev ) sources were detected in the acis gto observations of the hubble deep field and surroundings after cti correction @xcite .",
    "corrected event energies are necessary to obtain valid hardness ratios for faint point sources and to compare the spectral properties of faint sources distributed across a field . improved energies and more uniform qe",
    "will also yield better spectrally - resolved imaging of extended sources , an important technique for studying supernova remnants , for example .",
    "the corrector can not totally eliminate the position - dependent energy resolution of the fi devices or the energy- and position - dependent qe .",
    "thus position - dependent response matrices and effective areas are still necessary for the most accurate spectral fitting and flux determinations .",
    "the cxc provides a tool ( `` mkrmf '' ) that allows the user to generate spatially - dependent .rmf files for spectral analysis of cti - affected data . in principle , we might use this tool for acis spectroscopy while still benefiting from the cti corrector . as an example , the event list should be cti - corrected before any grade filtering is applied , since the corrector can ameliorate grade morphing .",
    "then the standard g02346 grade filtering will yield an event list containing valid x - ray events that is larger than that obtained by filtering on the original event list . selecting these events out of the original event list",
    "will give the best subset of events for spectral analysis .",
    "the mkrmf tool is then still applicable , as the observer will be using the original event list .",
    "such a method might be useful for spectral analysis of moderately faint sources , where including additional photons would improve the spectral fits .    also necessary for spectral",
    "fitting is the `` mkarf '' tool that incorporates the ccd qe into the .arf files .",
    "currently , mkarf overestimates the high - energy qe for fi devices , since it presumes pre - launch values .",
    "this will lead to underestimates of the high - energy flux , corrupting the temperatures or spectral indices obtained in model fits .",
    "it should be possible , though , to treat cti - induced qe changes as an energy - dependent multiplicative correction to the .arf file after it is generated , for either original or cti - corrected data .    for even more detailed spectro - spatial analysis , especially for extended sources ,",
    "we have incorporated our cti model into the monte carlo simulator that we developed to model acis devices @xcite .",
    "work is ongoing ( g.  chartas , private communication ) to couple this ccd model with astrophysical models from xspec @xcite and raytracing via marx @xcite .",
    "this will eventually allow complete forward modeling to reproduce the data and optimize spectral fitting results .",
    "efforts continue throughout the entire chandra community to improve the performance of the acis devices and our understanding of that performance .",
    "we expect the methods described here to be useful for current data but eventually to be superceded for future data by modifications to the instrument operations and software that are under development now at mit .",
    "laboratory work by mit @xcite and psu @xcite scientists is yielding new insight into the damage mechanisms and providing data useful for calibrating and assessing mitigation techniques . in the meantime , our cxc colleagues are providing tools for coping with cti - affected data and suggesting observing strategies that allow most acis users to accomplish their basic science goals .",
    "financial support for this effort was provided by nasa contract nas8 - 38252 .",
    "we thank our mit / acis colleagues , especially mark bautz and gregory prigozhin , for many helpful discussions and suggestions regarding ccd modeling and for their lucid explanations of the device physics of radiation damage and charge traps .",
    "we thank the cxc and msfc project science team for providing a forum for discussion of cti and other acis calibration issues and we especially thank harvey tananbaum for a careful review of this paper that greatly improved its relevance to the x - ray astronomy community ."
  ],
  "abstract_text": [
    "<S> the acis front - illuminated ccds onboard the chandra x - ray observatory were damaged in the extreme environment of the earth s radiation belts , resulting in enhanced charge transfer inefficiency ( cti ) . </S>",
    "<S> this produces a row dependence in gain , event grade , and energy resolution . </S>",
    "<S> we model the cti as a function of input photon energy , including the effects of de - trapping ( charge trailing ) , shielding within an event ( charge in the leading pixels of the 3@xmath03 event island protect the rest of the island by filling traps ) , and non - uniform spatial distribution of traps . </S>",
    "<S> this technique can not fully recover the degraded energy resolution , but it reduces the position dependence of gain and grade distributions . by correcting the grade distributions as well as the event amplitudes , we can improve the instrument s quantum efficiency . </S>",
    "<S> we outline our model for cti correction and discuss how the corrector can improve astrophysical results derived from acis data . </S>"
  ]
}