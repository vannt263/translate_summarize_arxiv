{
  "article_text": [
    "sight lines to distant quasars intersect many cosmological structures containing neutral hydrogen and lyman-@xmath0  scattering by the in these structures produces a forest of lines blueward of the quasar s",
    "lyman-@xmath0  emission line ( lynds 1971 ) .",
    "this lyman-@xmath0  forest   contains unbiased information on the temperature , density , velocity and ionization structure of the intergalactic medium ( igm ) along the line of sight to the quasar , making the structures responsible for the lyman-@xmath0  forest a useful probe for studying the high - redshift universe .",
    "in addition , it is likely that the absorbing gas retains a memory of its state at even higher redshifts , enabling us to study its initial conditions ( croft _ et al . _  1998 ) and previous history .",
    "since these structures are of moderate density contrast , they are easier to simulate numerically than galaxies , and consequently the high redshift universe can be studied efficiently and accurately by comparing simulations of the lyman-@xmath0  forest with observations .",
    "recent hydrodynamic simulations of hierarchical structure formation in a universe dominated by cold dark matter ( cdm ) have been shown to be remarkably successful in reproducing a variety of statistics of lyman-@xmath0  absorption lines ( cen _ et al . _  1994 ,",
    "zhang , anninos & norman 1995 , miralda - escud _ et al . _",
    "1996 , hernquist _",
    "et al . _",
    "1996 , wadsley & bond 1996 , zhang _ et al . _",
    "1997 ) , including the number of lines per unit redshift per unit column density and the number of lines with given width ( @xmath5   parameter ) , as well as its evolution at low - redshift ( theuns , leonard & efstathiou 1998 ) .",
    "this is quite encouraging for the hierarchical picture of structure formation since the underlying cosmological models were designed with galaxy formation in mind , hence their lyman-@xmath0  properties can be considered to be a genuine and successful prediction .",
    "most simulations to date have assumed a critical density , cold dark matter model , in which a photo - ionising background close to that inferred from quasars as computed by haardt & madau ( 1996 ) is required to explain the properties of the lyman-@xmath0  forest .",
    "however , other variants of the cdm model still provide acceptable fits , with only minor modifications to the required photo - ionization background ( cen _ et al . _  1994 ,",
    "miralda - escud _ et al . _",
    "1996 ) .    in this paper",
    "we introduce a new simulation code designed to study numerically the formation of lyman-@xmath0  systems .",
    "it is based on a combination of smoothed particle hydrodynamics ( sph , lucy 1977 , gingold & monaghan 1977 , see _ e.g.  _ monaghan 1992 for a review ) and an adaptive p3 m ( particle - particle  particle - mesh ) gravity solver ( couchman 1991 ) .",
    "its efficient gravity solver and sph implementation lead to a fast and accurate code which has the potential to extend considerably the dynamic range of the simulations .",
    "we discuss tests of the new code and perform extensive comparisons against two other simulation codes : hydra and treesph .",
    "both of these are also based on sph but their gravity solvers differ : hydra @xcite uses the same gravity solver as apmsph but treesph @xcite uses a tree structure .",
    "we discuss in detail the differences between the apmsph and hydra codes .",
    "we also discuss the changes we have made to the publically available hydra code to study the lyman-@xmath0  cloud problem .",
    "the overall agreement between the three codes is excellent which shows that hydrodynamic simulations that include cooling are reproducible with different simulation codes .",
    "the good agreement also shows that hydra can be used to study the lyman-@xmath0  problem and we are currently analysing several large hydra simulations performed on the t3d computer to understand in more detail how resolution affects lyman-@xmath0  statistics ( the virgo consortium , in preparation ) .",
    "we then use apmsph to perform simulations at increased resolution and establish the extent to which published results are influenced by lack of numerical resolution and other numerical artifacts .",
    "wadsley & bond ( 1996 ; see also bond & wadsley 1997 ) recently warned simulators of the importance of long - wavelength perturbations on the occurrence of filamentary structures in simulations .",
    "this is illustrated explicitly in the work of miralda - escud _ et al .",
    "_  ( 1996 ) who compare simulations with the same resolution but different box sizes",
    ". unfortunately , current numerical codes do not possess the required dynamic range to resolve the jeans length in a very large simulation box .",
    "we try to gauge the effects of missing waves and of failing to resolve the jeans length by performing simulations with various box sizes .",
    "this paper is organised as follows : section  [ sect : simulation ] discusses the physical model and gives details of the simulation codes , section  [ sect : comparison ] presents the comparisons between codes , section  [ sect : resolution ] addresses the importance of numerical resolution , section  [ sect : observations ] does a comparison of simulations against observations and finally section  [ sect : summary ] summarises .",
    "technical details are relegated to appendices .",
    "we model the evolution of a periodic , cubical region of a critical density einstein - de sitter universe ( @xmath8 , @xmath9 ) .",
    "the newtonian equations of motion governing the evolution of structures are given in appendix  a. the comoving size of the simulated box is @xmath10 mpc , where the hubble constant today is written as @xmath11 km s@xmath12 mpc@xmath12 .",
    "we will assume @xmath13 throughout and describe simulations with @xmath14 , @xmath15 , @xmath16 and @xmath17mpc .",
    "a fraction @xmath18 of the matter density is assumed to be baryonic , consistent with limits from nucleosynthesis ( walker _ et al . _",
    "1991 , but note the continuing debate on the deuterium abundance derived from quasar spectra , favouring higher values @xmath19 , see _ e.g.  _ burles & tytler 1997 and references therein ) .",
    "the rest of the matter is in the form of cold dark matter ( dm ) .",
    "these model parameters were chosen to enable comparison with the treesph simulation of hernquist _",
    "et al . _  ( 1996 ) which has identical parameters to our lowest resolution run .",
    "we use the smaller boxes which have correspondingly higher resolution to test for numerical convergence .",
    "the simulations are started at a redshift @xmath20 and we follow the evolution to @xmath21 . to generate initial conditions for the simulations we use the following fit to the cdm linear transfer function from bardeen",
    "_ et al . _  ( 1986 ) @xmath22 where @xmath23 and normalise it such that @xmath24 . here",
    ", @xmath25 denotes the r.m.s . of mass fluctuation in spheres of radius 8@xmath26  mpc .",
    "this value of @xmath27 is higher than the one deduced from the abundance of galaxy clusters ( @xmath28 , eke , cole & frenk 1996 ) but we use it to allow a direct comparison with the hernquist _",
    "et al . _  ( 1996 ) simulations .",
    "the equations of motion used in the sph code are detailed in appendix  [ sect : eqs ] .",
    "gas is allowed to interact with the cosmic microwave background radiation ( cmb ) through compton cooling and with an imposed uniform background of ionising photons , assumed to originate from quasars and/or young galaxies .",
    "collisions between atoms that lead to ionization represent a loss term for the optically thin gas causing cooling , whereas photo - ionizations heat the gas because the ionised electron carries excess kinetic energy .",
    "we detail the temperature dependence of the cross - sections for these processes in appendix  [ sect : cooling ] .",
    "they are taken from cen ( 1992 ) with some minor modifications .",
    "the flux spectrum of the ionising photons from a given quasar source seen by an average lyman-@xmath0  cloud is changed due to reprocessing ( absorption and emission ) by intervening clouds in the clumpy igm .",
    "the amplitude of the ionising background changes due to the evolution of the quasar luminosity function , causing the flux spectrum to depend on redshift .",
    "haardt & madau ( 1996 ) took all these effects into account and provide fits to the photo - ionization and photo - heating rate as a function of redshift for the case where the main sources of uv photons are quasars .",
    "we use the haardt & madau rates but divide them by two so that they are identical to the rates used in the treesph simulations of hernquist _",
    "et al . _  ( 1996 ) , enabling us to compare directly with their results . the imposed background flux is time - dependent but we assume nevertheless that the gas remains in ionization equilibrium throughout ( see below ) .",
    "the resulting fits to the photo - heating and photo - ionization rates can be found in appendix  [ sect : cooling ] and we will refer to them as hm/2 .",
    "we will also present simulations with an ionising background of radiation with constant amplitude @xmath29 and power law spectrum with index @xmath0 ( see appendix  [ sect : cooling ] for details ) .",
    "@xmath29 denotes the amplitude of the radiation spectrum at the hydrogen lyman-@xmath0  edge in the usual units ( @xmath30 ergs @xmath31 s@xmath12 hz@xmath12 sr@xmath12 ) .",
    "the net cooling and heating rates depend on the relative helium abundance by mass for which we assume @xmath32 .",
    "since our simulations include gas we need to specify the initial temperature of the igm at high redshift .",
    "we will first describe the temperature evolution in the absence of any extra energy input and then discuss various reionization scenarios .",
    "these models are shown in figure  [ fig : tempigm ] and were computed using a scheme based on giroux & shapiro ( 1996 ) . at high redshifts ,",
    "compton cooling is very efficient hence gas will cool very quickly due to the coupling of the free electrons left over from recombination to the cmb photons giving @xmath33k . at later times , the gas becomes progressively more neutral to make the coupling with the cmb inefficient , causing the temperature to drop almost adiabatically , @xmath34 , with @xmath35 ( giroux & shapiro 1996 ) .",
    "this temperature evolution is shown as the dashed line in figure  [ fig : tempigm ] .",
    "in contrast , in the simulations described here , we assume an igm temperature at the mean igm density of @xmath36k at @xmath20 and in addition assume ionization equilibrium , in which case the gas will cool adiabatically @xmath37 ( full line in the upper panel ) .",
    "if the starting temperature is higher , the gas will cool very efficiently through compton cooling until it becomes mostly neutral at @xmath38k , after which it cools adiabatically ( upper dotted line ) .",
    "if the starting temperature is lower , it will cool adiabatically from the start ( lower dotted curve ) . in any of the previous cases",
    ", @xmath39 will be low with respect to the reionization value provided reionization occurs at redshifts @xmath40 say , hence @xmath39 after reionization is independent of our assumed starting temperature at @xmath20 .",
    "the behaviour of @xmath39 _ after _ reionization depends on the reionization scenario and to some extent on whether non - equilibrium ionization effects are taken into account , as is illustrated in figure  [ fig : tempigm ] ( lower panel ) .",
    "if reionization occurs impulsively , more ionizations will take place per unit time than in equilibrium conditions so the non - equilibrium gas will become hotter ( miralda - escud & rees 1994 , haehnelt & steinmetz 1998 ) . since the thermal time scales are long in low density gas , this difference in temperature may survive to low redshifts .",
    "the igm temperature is sensitive to the imposed photo - ionization heating rate , notably the heating rate at reionization , which is based on an uncertain extrapolation to @xmath41 of the quasar luminosity function .",
    "this introduces a considerable uncertainty in the temperature of the igm , even at redshifts as low as @xmath42 .",
    "the temperature of the non - equilibrium gas will approach that of the equilibrium gas if the flux of photo ionising photons evolves slowly after reionization so that ionization equilibrium is re - established . from then on ,",
    "photo ionization heating competes with compton cooling and adiabatic expansion in trying to change the gas temperature .",
    "the age of the universe at a given redshift then basically determines how long the gas has been heated , which in turn determines its temperature .",
    "this sequence of events is illustrated in figure  [ fig : tempigm]b for a range of reionization scenarios . in the low density regime ,",
    "the gas temperature depends on its density in a straightforward way which is derived in appendix  [ app : igm ] ( see also giroux & shapiro 1996 and hui & gnedin 1997 ) .",
    "the equilibrium temperature of the igm , _",
    "i.e.  _ that temperature where heating balances cooling , is generally higher than this ( _ e.g .",
    "_ zhang _ et al . _",
    "in contrast , at high densities line cooling in the shock - heated gas becomes important and the gas cools to temperatures of a few times @xmath43k , below which atomic hydrogen cooling becomes inefficient .",
    "since we do not include molecular hydrogen , the gas in the simulations can not cool radiatively below @xmath36k . in summary ( for @xmath44 , after reionization ) : for low densities ( @xmath45 ) there is a one - to - one relation between @xmath39 and @xmath46 obeyed by unshocked gas which is determined by the photo ionization heating rate , adiabatic cooling , and to a small extent by compton cooling . at high densities ,",
    "@xmath47 , collisions try to cool the shock - heated gas to @xmath48k . at intermediate densities",
    ", there is a large range in @xmath39 for any given @xmath46 , depending on the extent to which the gas has been shocked .",
    "the numerical methods described here are based on smoothed particle hydrodynamics ( sph , lucy 1977 , gingold & monaghan 1977 , see _ e.g.  _ monaghan 1992 for a review ) for hydrodynamics and p3 m ( hockney & eastwood 1988 , efstathiou _ et al . _  1985 ) for self - gravity .",
    "the gas in the simulation is represented by a set of sph particles which each carry the same mass but possibly a different thermal energy .",
    "spline interpolation over these particles allows one to compute smoothed estimates for density and temperatures throughout the computational volume .",
    "gradients may also be computed .",
    "the width of the spline kernel is matched to the local particle number density and so high density regions have higher numerical resolution than do low density regions , in contrast to eulerian schemes .",
    "p3 m uses a combination of fast fourier transforms ( ffts ) and local direct summation to combine speed with accuracy .",
    "we compare detailed results from two codes .",
    "apmsph was written specifically for this problem by one of us ( tt ) and is based on the hierarchical p3 m code of couchman ( 1991 ) .",
    "hydra @xcite is a publically available code used extensively by the virgo consortium .",
    "we have modified hydra to include photo - heating effects and to improve the simulation of low density regions ( section  [ sect : hydra ] and appendix  [ sect : densityfix ] ) .",
    "we also compare with the published results of the treesph code @xcite . in the rest of this section we will describe some technical details of the codes pertinent to their comparison .",
    "this code is based on the adaptive p3 m implementation of couchman ( 1991 ) which uses mesh refinements in regions of high particle number density to speed - up gravity particle - particle interactions .",
    "the sph implementation uses a similar but separate linked - list scheme based on a hierarchy of grids to find neighbouring sph particles .",
    "this is because the refinements used by the gravity part of the code are not necessarily optimal for the sph calculation and vice versa .",
    "note that in apmsph we find the neighbours of all particles even in low density regions , in contrast to other p3m+sph implementations such as hydra ( see below ) and evrard s ( 1988 ) versions .",
    "the explicit expressions used to compute the sph accelerations are given in section  [ sect : sph ] as well as details of our method of determining sph neighbours .    given a power spectrum we set - up initial conditions by perturbing particles from a grid using the zeldovich ( 1970 ) approximation ( efstathiou _",
    "et al . _  1985 ) .",
    "we take the dm and sph particle grids offset by half a cell size .",
    "we then march the particle positions forwards in time using a second - order accurate leap - frog integrator with variable time - step , using the correction procedure of hernquist & katz ( 1989 ) to keep the scheme second - order even when the step changes .",
    "the sph accelerations depend on the particles velocities : we synchronise these by predicting velocities over half a time - step . as is usual ,",
    "we take a time - step based on the courant - friedrichs - levy condition ( cfl , _",
    "e.g.  _ monaghan 1992 ) , but take smaller steps whenever violent shocks occur .",
    "such shocks are flagged by large values of the artificial viscosity terms ( _ e.g .",
    "_ katz _ et al . _",
    "1996b ) and the latter decrease the allowed time - step for accuracy and numerical stability ( _ e.g .",
    "_ hockney & eastwood 1988 , ch .",
    "4 ) . since we use a uniform time - step , we take as system time - step the minimum time - step over all particles . to avoid one or a few particles from unnecessarily slowing down all the others , we make sure that there are a reasonable number of particles with similarly small time - step , by increasing the resolution length of those few offending particles that would otherwise require an even smaller step by a factor @xmath49 .",
    "the integration of the cooling terms requires prohibitively small time - steps , comparable to the local cooling time .",
    "we solve this problem in the usual way by integrating the thermal energy equation at with an implicit scheme , assuming in addition ionization equilibrium and fixed density .",
    "we evaluate the cooling and heating rates by interpolation from tables which we recompute every time the background flux changes significantly .",
    "this new sph+ap3 m implementation was tested with a variety of test problems : the 1d shock tube , the spherically symmetric collapse of a gas sphere and the formation of a massive galaxy cluster .",
    "energy conservation based on the the layzer - irvine cosmic energy ( equation  [ eq : layzer ] below ) gives typically @xmath50 for the runs discussed here .",
    "a simulation with @xmath51 sph and equal number of dm particles takes @xmath52 1000 steps to evolve from @xmath20 to @xmath21 for a box size of 22mpc . using a @xmath53 grid for the gravity calculations , the code takes 110@xmath54 per step at @xmath55 ( 40@xmath54 for gravity , @xmath56 for sph ) which increases to 230@xmath54 at @xmath21 ( 125@xmath54 for gravity , @xmath57 for sph ) on a dec - alpha 4100 server .",
    "the total simulation then takes @xmath58 32 hours and requires @xmath58 60 m bytes of ram memory in single precision ( 32 bits ) .",
    "hydra ( couchman _ et al . _",
    "1995 ) is similar to apmsph in that it combines a variable resolution sph code with the adaptive p3 m code of couchman ( 1991 ) .",
    "this code has been used extensively by the virgo consortium on massively parallel computers such as the cray t3d & t3e computers in edinburgh and munich , with the primary aim of studying large scale structure ( jenkins _ et al . _",
    "1997 ) , cluster ( colberg _ et al . _",
    "1997 ) and galaxy formation problems ( pearce _ et al . _",
    "1998 ) , where typically very large dynamic ranges are required . throughout its development",
    "the code has also been used to explore the accuracies and inaccuracies of the sph technique in modelling astrophysical scenarios , in keeping with the spirit of this paper . in this section",
    "we concentrate on reporting the code - modifications introduced to allow an accurate treatment of photoionised primordial gas dynamics on scales of @xmath59 10kpc .    the first modification involved updating the thermal energy solver to take into account the cooling and heating functions in ionization equilibrium , as listed in appendix  [ sect : cooling ] and also used in apmsph .",
    "we then tested this new solver by comparing with the apmsph one and another solver developed by one of us ( apbl , based on a scheme of giroux & shapiro 1996 ) , for a wide range of initial temperatures , densities and photo ionising background choices .    since the lyman-@xmath0  forest absorption is expected to arise from gas in the igm at moderate over densities and slight under densities , it is paramount that an accurate handling of low - density gas is achieved in the simulations .",
    "hydra suffers in this respect since its implementation requires that the same linked - list to find neighbours be used for both gravity and sph interactions .",
    "this leads to the following problem : if a linked - list is used that is optimal for the gravity calculation , then particles in low density regions will not find enough sph neighbours to accurately compute hydrodynamic quantities such as their density . if , on the other hand , a linked - list is used which is suited to the sph computation , then the gravity calculation will become very time - consuming .",
    "we decided to deal with this problem in a two - step fashion .",
    "firstly , we run our simulations with fft cells for the base mesh ( the pp linking cells are typically 2 - 3 fft cells on a side ) set at half the mean inter - particle separation ( leading to an efficient gravity calculation ) but use a correction for the sph smoothing kernel applied for particles with few neighbours ( see below ) . secondly , post - simulation , we continue every end state for two further time - steps where the number of linking cells is decreased by a factor @xmath60 and the original sph kernel is used to re - calculate the densities for all particles with @xmath61 from their respective positions as simulated .",
    "only particle densities are ever updated in this step , referred to as the density reconstruction   step .",
    "since the temperatures in the low - density igm are density dependent these must be post - adjusted during density reconstruction as well .",
    "fortunately we can use the power - law density temperature relation obeyed by low density gas ( see figure  [ fig : rtclose ] below ) .",
    "this relation is history independent if reionization occurs gradually or at sufficiently high redshift , as discussed in section  [ sect : physmodel ] . in section  [",
    "sect : comparison ] we shall compare the effects of this scheme with the exact density scheme of apmsph , and show that the temperature - density distributions simulated by the two codes are essentially indistinguishable , also at low densities . more details of this hydra low density correction are given in section  [ sect : densityfix ] .",
    "treesph @xcite uses a tree structure to compute gravitational forces using multipole expansion based on an accuracy criteria and to find sph neighbours .",
    "each sph particle is advanced with its own time - step based on the cfl condition , which may be smaller than the  system   time - step imposed on all the collisionless particles .",
    "treesph uses the same spline kernel as apmsph and hydra but a different symmetrization procedure to compute sph pairwise quantities ( katz _ et al . _",
    "gravitational forces are softened using a spline - kernel softening and made periodic using the ewald summation method .",
    "we will compare our results with the published treesph simulation results of hernquist _",
    "et al . _  ( 1996 ) .",
    "the characteristics of the absorption lines in simulated spectra reflect the properties of the neutral gas in the simulation box .",
    "for example , stronger lines tend to be produced in regions with higher densities and correspondingly higher temperatures .",
    "for such lines , effects of peculiar velocities and hubble expansion are less important and deviations from voigt profiles are usually caused by surrounding matter that often lies in a filamentary distribution and contributes to the absorption .",
    "consequently , the statistical properties of strong lines mostly reflect the statistics and shapes of halos that form in the simulation .",
    "in contrast , weaker lines usually originate in filaments and pancakes and residual hubble expansion contributes significantly in shaping the line .",
    "these lines then reflect the properties of the gas distribution in the low density igm .",
    "we will first compare the overall gas distribution between apmsph and hydra by studying the amount of cold gas responsible for most of the weaker lines before concentrating on the halo statistics . in the second part of the section , we will compute and compare simulated spectra .",
    "these will be analysed using voigt profile fitting in the same way as observed spectra .    to make comparison with",
    "the treesph runs ( hernquist _ et al . _",
    "1996 ) we have run simulations with initial conditions computed from the initial linear density field originally used by these authors which they kindly provided for us",
    ". we shall refer to these runs as 22 - 64-k , where 22 refers to the box size ( 22.22 comoving mpc ) and 64 to the cube root of the number of particles ( _ i.e .  _",
    "@xmath51 particles of a single species ) in the simulation . throughout this paper",
    "we will compare results from simulations using a variety of different codes and numerical parameters and refer to them as above .",
    "these are summarised in table  [ table : runs ] and are all performed in a standard cdm cosmology ( @xmath8 , @xmath13 ) . in what follows",
    ", apmsph simulations will be labelled with a   and the hydra ones with h.    [ cols= \" < , < , < , < , < , < , < , < , < \" , ]",
    "in this appendix we write down the defining equations needed to solve for the temperature at given density in the high redshift universe observable through lyman-@xmath0  absorption where the net ( heating@xmath62cooling ) time , or ` heating time ' , @xmath63 is equal to the hubble time @xmath64 , @xmath65 we particularly show that for low densities , this relation approximates very well a power - law whose amplitude and slope are well - defined , and dependent only weakly on a few parameters , most notably the ( effective ) uv background spectral index ( see also hui & gnedin 1997 ) .",
    "we define the hubble time as follows for an einstein de - sitter universe , @xmath66 the heating time ( or net cooling time ) defined in equation  ( [ eq : tc ] ) may be written in general as @xmath67 where we use @xmath68 to denote the heating rate ( erg s@xmath12 @xmath69 ) , positive for net heating , and @xmath70 . above and in what follows all fundamental atomic parameters are collected together into constant factors ( each given a dash ) , so that the relative contribution from each respective process together with cosmological parameters may be preserved through the calculation .",
    "it should be noted that although these factors are denoted by the quantity they attribute to plus a dash , they will not in general have the same units as this quantity .    using the equations as laid out in appendix  [ sect : eqs ]",
    "we may calculate @xmath71 for a given density and temperature ( and uv background ) and solve equation  ( [ eq : tceqth ] ) in a numerical fashion straightforwardly .",
    "we can however simplify the above equation considerably by approximating the normalised cooling rates in the low - density regime .    effectively in the low density region , @xmath72 , the heating rate , @xmath71 ,",
    "is dominated by & photo - heating , with a small but non - negligible compton cooling contribution .",
    "following the notation of the previous appendix we may write the photo - heating component of @xmath71 , denoted @xmath73 , simply as @xmath74 the and electron fractions above are likely to be extremely highly photo - ionised and so we may write their abundances accurately as follows @xmath75 where the recombination coefficients can be well approximated for temperatures @xmath76 k as ( see table  [ table : recomb ] ) , @xmath77 further , if we model the photo - ionization flux @xmath78 as a power law according to equation  ( [ eq : powerlaw ] ) , then the ratios of photo - heating and photo - ionization coefficients given in table  [ table : photo ] are @xmath79 where @xmath80 and @xmath81 are the ionization wavelengths for and respectively , and we denote planck s constant and the speed of light as @xmath82 . drawing these elements together , the normalised photo - heating rate becomes @xmath83 as mentioned previously their is also a small contribution from compton cooling , @xmath84 , which may be written ( @xmath85 from table  [ table : cooling ] , @xmath86 ) @xmath87    we are now in a position to solve for the temperature at a given density where @xmath88 . substituting for each using equations  [ eq : hubtime ] , [ eq : cooltime ] , [ eq : leps ] and [ eq : lcc ] @xmath89 which by multiplying through by @xmath90 and juggling yields the general solution for @xmath39 at given @xmath91 , @xmath92^{{1\\over1.7}}\\,.\\label{eq : tgeneral }   \\nonumber\\\\\\end{aligned}\\ ] ] the second factor in brackets encloses the contribution of compton cooling only",
    ". this is found always to be small for intermediate redshifts . putting in values for physical constants , using a cosmological helium fraction , @xmath93 , and @xmath94 in the low density limit",
    ", we get @xmath95 where we have used the following atomic numbers for @xmath96 : @xmath97 which may be collected together into equation  ( [ eq : tgeneral ] ) above to find @xmath98 where the main dependencies for @xmath99 are given in the numerator , and the denominator has the correction due to compton cooling only ."
  ],
  "abstract_text": [
    "<S> we investigate the importance of several numerical artifacts such as lack of resolution on spectral properties of the lyman-@xmath0  -forest as computed from cosmological hydrodynamic simulations in a standard cold dark matter universe . </S>",
    "<S> we use a new simulation code which is based on a combination of a hierarchical particle - particle  particle - mesh ( p3 m ) scheme for gravity and smoothed particle hydrodynamics ( sph ) for gas dynamics . </S>",
    "<S> we have performed extensive comparisons between this new code and a modified version of the hydra code of couchman _ </S>",
    "<S> et al </S>",
    "<S> . _  and find excellent agreement . </S>",
    "<S> we have also rerun the treesph simulations of hernquist _ </S>",
    "<S> et al . _  </S>",
    "<S> using our new codes and find very good agreement with their published results . </S>",
    "<S> this shows that results from hydro dynamical simulations that include cooling are reproducible with different numerical algorithms . </S>",
    "<S> we then use our new code to investigate several numerical effects such as resolution on spectral statistics deduced from voigt profile fitting of lines by running simulations with gas particle masses of @xmath1 , @xmath2 , @xmath3 and @xmath4 . </S>",
    "<S> when we increase the numerical resolution the mean effective hydrogen optical depth converges and so does the column density distribution . </S>",
    "<S> however , higher resolution simulations produce narrower lines and consequently the @xmath5-parameter ( velocity width ) distribution has only marginally converged in our highest resolution run . obtaining numerical convergence for the mean transmission is demanding . when progressively smaller halos are resolved at better resolution , a larger fraction of low density gas contracts to moderate over densities in which is already optically thick , and this increases the net transmission , making it difficult to simulate reliably . </S>",
    "<S> our highest resolution simulation gives a mean effective optical depth in 5% lower than the simulation with eight times lower mass resolution , illustrating the degree to which the optical depth has converged . </S>",
    "<S> in contrast , the hydrogen mean optical depth for these runs is identical . since many properties of the simulated lyman-@xmath0  -forest depend on resolution </S>",
    "<S> , one should be careful when deducing physical parameters from a comparison of the simulated forest with the observed one . </S>",
    "<S> we compare predictions from our highest resolution simulation in a cold dark matter universe with a photo - ionising background inferred from quasars as computed by haardt & madau ( 1996 ) , with observations . </S>",
    "<S> the simulation reproduces both the column density and @xmath5-parameter distribution when we assume a high baryon density , @xmath6 . </S>",
    "<S> in addition we need to impose a higher igm temperature than predicted within our basic set of assumptions . </S>",
    "<S> we argue that such a higher temperature could be due to differences between the assumed and true reionization history . </S>",
    "<S> the simulated ptical depth is in good agreement with observations but the optical depth is lower than observed . </S>",
    "<S> fitting the optical depth requires a larger jump @xmath7 between the photon flux at the and edge than is present in the haardt & madau spectrum .    </S>",
    "<S> cosmology : theory  hydrodynamics  large - scale structure of universe  quasars : absorption lines </S>"
  ]
}