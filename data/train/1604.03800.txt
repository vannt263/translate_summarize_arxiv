{
  "article_text": [
    "in computer vision , it is common to extract salient curves in flat images via data - driven minimal paths or geodesics  @xcite . the minimizing geodesic is defined as the curve that minimizes the length functional , which is typically weighted by a cost function with high values at image locations with high curve saliency .",
    "another set of geodesic methods , partially inspired by the psychology of vision , was developed in  @xcite . in these articles , sub - riemannian ( sr ) geodesics in",
    "respectively the heisenberg @xmath10 and the euclidean motion group @xmath11 are proposed as a model for contour perception and contour integration .",
    "the combination of such contour perception models with data - driven geodesic methods has been presented in  @xcite . there , a computational framework for tracking of lines via globally optimal data - driven sub - riemannian geodesics on the euclidean motion group @xmath11 has been presented with comparisons to exact solutions  @xcite .    in this work ,",
    "we extend this framework for tracking of lines in _ spherical _ images ( e.g. , images of the retina , cf .",
    "[ fig : retinasphere ] ) .",
    "this requires a sub - riemannian manifold structure in a different lie group , namely the group @xmath6 ( consisting of 3d rotations ) acting transitively on the 2-sphere @xmath12 .    , and object coordinates are denoted by @xmath13 . ]    here we study the problem @xmath14 of finding a smooth curve @xmath15 on a unit sphere @xmath12 that satisfies given boundary conditions ( both positions and velocities ) @xmath16 and minimizes the functional @xmath17 where @xmath18 denotes the geodesic curvature of @xmath15",
    ", @xmath3  denotes the spherical arclength , and total length @xmath2 is free , see fig .  [",
    "fig : pcurvestat ] .",
    "furthermore , we include a curve - stiffness parameter @xmath19 . in the optimization",
    "functional , we also include an external cost factor @xmath20 adding for adaptation to a given spherical image data .",
    "we state this problem @xmath14 more explicitly in sect .",
    "[ subsec : pcurvestat ] .",
    "the problem @xmath14 is a spherical analog of a well - known problem @xmath21  @xcite ( cf .",
    "[ fig : pcurvestat ] ) of finding a smooth curve @xmath22 on a plane @xmath23 that satisfies given boundary conditions @xmath24 and minimizes the functional @xmath25 where @xmath26 denotes the curvature , @xmath2 denotes the total length , and curve stiffness is regulated by @xmath19 .",
    "the external cost factor @xmath27 is added for adaptation to a given flat image data ( see  @xcite ) .    : for given boundary conditions on a 2d sphere ( both positions and velocities ) , we aim to find a curve minimizing the functional compromising length and geodesic curvature . in the optimization functional",
    "we also include an external cost induced by spherical image data .",
    "* right : * problem @xmath21  @xcite : for given boundary conditions on a 2d plane , to find a curve minimizing the compromise between length and curvature .",
    "the external cost factor is added for adaptation to flat image data ( see  @xcite ) .",
    "[ fig : pcurvestat],title=\"fig : \" ]   : for given boundary conditions on a 2d sphere ( both positions and velocities ) , we aim to find a curve minimizing the functional compromising length and geodesic curvature . in the optimization functional we also include an external cost induced by spherical image data . *",
    "right : * problem @xmath21  @xcite : for given boundary conditions on a 2d plane , to find a curve minimizing the compromise between length and curvature .",
    "the external cost factor is added for adaptation to flat image data ( see  @xcite ) .",
    "[ fig : pcurvestat],title=\"fig : \" ]    there are three motivations for our study .",
    "the first motivation comes from a medical image analysis application , where automatic extraction of the vascular retinal tree on images is helpful for early detection of many diseases , such as diabetic retinopathy , glaucoma , atherosclerosis , and others ( see , e.g. ,  @xcite ) .",
    "optical retinal images are mostly acquired by flat cameras , and as a result , distortion appears .",
    "such distortion could lead to questionable ( distorted ) geometrical features ( vessel curvature , thickness , etc . )",
    "that are used as biomarkers  @xcite for different diseases .",
    "we will show that the distortion that appears near the boundary of a flat image can play a significant role in the quantitative analysis of the vascular structure and its curvature . as the retina itself is not flat",
    ", we should include the spherical geometry both in image processing and in image representation in order to avoid distortion .",
    "such distortion comes from the central projection of the physical retinal surface to the image plane .",
    "it is illustrated in fig .",
    "[ fig : retinasphere ] , where @xmath28 denote cartesian camera coordinates and @xmath13 denote spherical object coordinates .",
    "this motivates us to study data - driven sr geodesics on the rigid body rotation group @xmath6 and their spherical projections ; likewise , it was done ( see  @xcite ) for flat images and lifting to the roto - translation group @xmath11 .",
    "the second motivation comes from models of the visual system of mammals . as mentioned by boscain and rossi  @xcite ,",
    "the problem @xmath14 can be considered as a spherical extension of a ( flat ) cortical - based model @xmath21 for perceptual completion , proposed by citti and sarti  @xcite , and petitot  @xcite .",
    "such a spherical extension is again motivated by the fact that the retina is not flat . by the same argument ,",
    "cuspless sr geodesics in @xmath6 could provide a model of association fields in the psychology of vision ( see  @xcite ) . note that nonuniform distribution of photoreceptors on the retina can be included in our model by putting an external cost @xmath29 on a hemisphere .",
    "the third motivation for this study is that in geometric control theory optimal synthesis for the sr problem in @xmath6 has not been achieved in the general case ( not even for the case of uniform cost @xmath9 ) , despite many strong efforts in this direction  @xcite . in this paper",
    ", we will not provide optimal synthesis analytically , but instead we do provide a hjb theory for computing globally optimal ( data - driven ) geodesics . in previous works  @xcite , we achieved this for sr geodesics in @xmath11 , used for tracking of blood vessels in flat 2d images .    in view of these three motivations ,",
    "we lift the problem @xmath30 on the set @xmath31 to a sr problem on the group @xmath6 , which we will call @xmath32 , and we provide explicit formulas for sr geodesics .",
    "this allows us to describe the set of endpoints in @xmath6 reachable by geodesics whose spherical projections do not contain cusps .",
    "furthermore , we present a hamilton  jacobi ",
    "bellman pde theory that allows us to numerically compute the sr distance map , from which a steepest descent backtracking ( via the pontryagin maximum principle ) provides only the _ globally optimal _ geodesics for general external cost and general @xmath19 .",
    "we verify our numerical solution , by comparison with exact geodesics in the case @xmath9 .",
    "finally , we use these results in a vessel tracking algorithm in spherical images of the retina , without central projection distortion .",
    "the main contributions of this article are :    * new formulas for the geodesics of @xmath14 for the uniform cost case @xmath9 .",
    "* analysis and parametrization of cusp points arising in spherical projections of geodesics of @xmath33 . * a new hjb - pde theory for the numeric computation of globally optimal geodesics of @xmath14 and @xmath33 for the general external cost case , with verification for @xmath9 .",
    "* tracking of lines in spherical image data ( e.g. , retinal images ) without central projection distortion , with comparison to tracking of lines in flat image data .      in this subsection",
    ", we first describe the mapping from object coordinates on the retina to camera coordinates , and then we discuss the relevance of considering spherical images of the retina rather than flat images , which are commonly used in the medical application ( see fig .",
    "[ fig : retinasphere ] ) .",
    "we show that distortion appears inevitably on flat images , with a significant relative error ( up to 7% ) in length measures . even larger relative errors ( over 20% )",
    "appear in the application of differential operators ( used for vessel detection ) .",
    "we base our computations on the reduced schematic eye model ( see fig .  [",
    "fig : eye2 ] ) , which is commonly used in clinical ophthalmology ( see , e.g. ,  @xcite ) .",
    "let @xmath34 be the radius of an eyeball , @xmath35 be the distance from the nodal point @xmath36 to the center @xmath37 , and @xmath38 be the angle between visual axis and a light ray passing through @xmath36 .",
    "here we consider a simplified model , where the optical axis ( the best approximation of a line passing through the optical center of the cornea , lens , and fovea ) coincides with the visual axis ( the line connecting fixation point and the fovea ) .",
    "the average radius of a human eye is @xmath39 mm , and the maximum distance between nodal point @xmath36 and the central point @xmath37 is @xmath40 .",
    "* bottom : * schematic eye , enlarged to support eq .",
    "( [ eq : ymax]),title=\"fig : \" ] + mm . + * bottom : * schematic eye , enlarged to support eq .",
    "( [ eq : ymax]),title=\"fig : \" ]    now we switch to mathematical object coordinates of the retina where we use the eyeball radius to express lengths , i.e. , we have @xmath41 and @xmath42 in dimensionless coordinates .    in order to compute the maximum absolute angle @xmath43",
    "let us express the angle @xmath44 with respect to center of the eyeball ( see right fig .  [",
    "fig : eye2 ] ) . expressing the squared length of segment @xmath45 yields @xmath46 solving this equation with respect to @xmath47",
    ", we obtain unique nonnegative solution : @xmath48 a standard fundus camera used for producing of the retinal images has the angular range @xmath49 $ ] .",
    "thus , substitution @xmath50 , @xmath51 , and @xmath52 in eq .",
    "( [ eq : ymax ] ) gives the maximum angle @xmath53    we rely on the following parameterization of the image sphere @xmath12 and the retinal sphere @xmath54 ( see fig .",
    "[ fig : twospheres ] ) : @xmath55 with @xmath56 $ ] and @xmath57 $ ] .",
    "next we present the explicit relation between the object coordinates @xmath13  spherical coordinates on a unit sphere @xmath54 representing the surface of the eyeball ; flat photo coordinates @xmath28  cartesian coordinates on the image plane and the spherical coordinates @xmath58 on the image sphere , see figs .  [ fig : retinasphere ] and  [ fig : twospheres ] .    to take into account the distance from the eyeball to the camera in our model",
    ", we introduce a parameter @xmath59 . in fig .",
    "[ fig : twospheres ] , by setting @xmath60 we fix the distance equal to @xmath61 radiuses of the eyeball .",
    "this corresponds to the case when the image sphere @xmath12 is obtained by reflection of the physical retinal sphere @xmath54 through the point @xmath62 . in this case",
    ", we have @xmath63 and we will always rely on this identification in the sequel .",
    "the general case @xmath59 can be taken into account by congruency and scaling @xmath64 , @xmath65 .     on a retina",
    ", cartesian camera coordinates @xmath28 on a flat image of the retina , and spherical camera coordinates @xmath58 on a spherical image of the retina .",
    ", title=\"fig : \" ] +    on a retina , cartesian camera coordinates @xmath28 on a flat image of the retina , and spherical camera coordinates @xmath58 on a spherical image of the retina .",
    ", title=\"fig : \" ]    the central projection @xmath66 ( cf .",
    "[ fig : retinasphere ] ) from @xmath58 to @xmath28 including the scaling factor @xmath59 ( with physical dimension length in units of @xmath34 ) is given by @xmath67 the inverse mapping @xmath68 from @xmath28 to @xmath58 for @xmath69 is given by @xmath70 where @xmath71 with @xmath72 .",
    "in these formulas , we need to substitute @xmath73 and @xmath74 , depicted in fig .",
    "[ fig : twospheres ] , where we work in dimensionless coordinates .",
    "the local deformation from spherical photo coordinates @xmath58 to planar photo coordinates @xmath28 is now given by the jacobian @xmath75 in mathematical analysis , we can set @xmath69 ; however , in experiments @xmath76 is to be taken into consideration . note that for @xmath60 we have @xmath77 showing that local deformation plays a considerable role and varies in @xmath58 .",
    "next we consider the global distortion along the line @xmath78 .",
    "it is defined as @xmath79 , and it has a maximum when @xmath80 .",
    "we have @xmath81 and we see the distortion up to 7% along the line @xmath78 .",
    "the same holds along the line @xmath82 .",
    "we conclude that it makes a considerable difference to study @xmath14 or @xmath21 in the retinal imaging application . in the sequel , we will write @xmath30 instead of @xmath14 as we will always be concerned with the case where the base manifold equals @xmath12 .",
    "in this section , we first provide preliminaries on group theoretical tools and notation , and then we show that the spherical projection of certain sr geodesics @xmath83 on the lie group @xmath6 provides solution curves to the problem @xmath30 on @xmath12 , which we formulate next .",
    "the lie group @xmath6 is the group of all rotations about the origin in @xmath84 .",
    "we shall denote a counterclockwise rotation around axis @xmath85 with angle @xmath86 via @xmath87 , in particular for rotations around standard axes @xmath88 we use representation of @xmath6 by @xmath89 matrices @xmath90 @xmath91 where we denote @xmath92 , @xmath93 , @xmath94 , @xmath95 , @xmath96 , @xmath97 , and where @xmath98 \\times \\r/\\{2 \\pi \\z\\ } \\times \\r/\\{2 \\pi \\z\\}.\\ ] ] the lie group @xmath6 defines an associated lie algebra @xmath99 @xmath100 where @xmath101 denotes the tangent space at the unity element @xmath102 , represented by identity matrix @xmath103 , which corresponds to the origin in the parameter space @xmath104    [ remark : algebragen ] the formula for @xmath105 follows by @xmath106    the nonzero lie brackets are given by@xmath107 = a_3 , \\quad [ a_1 , a_3 ] = -a_2 , \\quad [ a_2 , a_3 ] = a_1.\\ ] ] there is a natural isomorphism between @xmath108 and the lie algebra @xmath109 of left - invariant vector fields in @xmath6 , where commutators of the vector fields in @xmath109 correspond to the matrix commutators in @xmath108 @xmath110 = r [ a , b ] , \\quad a , b \\in { \\operatorname{so(3)}\\nolimits } , \\ , r \\in { \\operatorname{so(3)}\\nolimits}.\\ ] ] we express @xmath109 in matrix form as @xmath111    note that at the unity one has @xmath112 the formulas for @xmath113 in ( [ eq : vfxi ] ) follow by ( cf . remark  [ remark : algebragen ] ) @xmath114    we also use the isomorphism between @xmath108 and @xmath84 @xmath115 where @xmath116 , @xmath117 , @xmath118    note that  ( [ matexp ] ) is a product of matrix exponentials : @xmath119 we choose to rely on this parameterization to keep the analogy with previous @xmath11 models  @xcite mentioned in introduction .",
    "let @xmath120 be a sphere of unit radius .",
    "we consider the problem @xmath30 ( see fig .  [",
    "fig : pcurvestat ] ) , which is for given boundary points @xmath121 and directions @xmath122 , @xmath123 , @xmath124 to find a smooth curve @xmath125\\to { s}^2 $ ] that satisfies the boundary conditions @xmath126 and for given @xmath19 minimizes the functional @xmath127 where @xmath128 denotes the geodesic curvature on @xmath129 of @xmath15 evaluated in time @xmath3 , and @xmath130 , @xmath131 , is a smooth function that we call `` external cost . ''    here the total length @xmath2 is free and @xmath132 denotes the spherical arclength .",
    "thus , we have @xmath133 and the gauss  bonnet formula @xmath134    [ remark:20 ] in introduction , we provided two motivations for this problem , where the external cost @xmath29 plays a different role .",
    "firstly , there is a motivation coming from retinal images , where @xmath29 is adapted to spherical image data .",
    "secondly , there is a motivation from the modeling of human vision , where the nonuniform distribution of photoreceptors can be modeled by the external cost .",
    "[ rm1 ] without loss of generality , we can fix the boundary conditions as @xmath135 since the problem is left - invariant w.r.t .",
    "the natural left action of @xmath6 onto @xmath129 for @xmath9 .",
    "but also for @xmath136 we can fix these boundary conditions by shifting the external cost .",
    "this boundary value convention is used throughout this article for @xmath30 .",
    "[ rmnonexist ] following the previous works @xcite in @xmath11 group , we do not expect existence of minimizers for the problem @xmath14 in general .",
    "we call @xmath32 the following sr problem in @xmath6 : @xmath137 with @xmath138 free .    the external cost @xmath139 , @xmath131 , is a smooth function that is typically obtained by lifting the external cost @xmath29 from the sphere @xmath12 to the group @xmath6 , i.e. , @xmath140",
    ".    we study the problem @xmath32 for @xmath141 ( case of uniform external cost ) in sect .",
    "[ sec : pmec ] , but let us first consider some preliminaries .    in @xmath32",
    ", we only have two velocity controls @xmath142 and @xmath143 in a 3d tangent space @xmath144 ( cf .",
    "[ fig : reedsshepp ] ) .",
    "[ rm : existence ] the existence of minimizers for the problem @xmath32 is guaranteed by chow - rashevskii and filippov theorems on sub - riemannian manifolds  @xcite . moreover , the geodesics of @xmath32 are smooth , since there are no abnormal extremals ( see example 1.3.13 in @xcite ) .    [",
    "remark : srmanifold ] sub - riemannian manifolds are commonly defined by a triplet @xmath145 , with manifold @xmath146 , distribution @xmath147 and metric tensor @xmath148 . in our case",
    "@xmath149 \\mathcal{g}(\\dot{r } , \\dot{r } ) = c^2(\\cdot)\\left(\\xi^2 u_1 ^ 2 + u_2 ^ 2\\right ) , \\end{array}\\ ] ] where the controls @xmath142 and @xmath143 are components of velocity vector w.r.t . moving frame of reference ,",
    "see  ( [ eq : so3sys ] ) . the choice of the sub - riemannian structure  ( [ eq : subriemmanifold ] )",
    "is determined by the initial conditions @xmath150 and @xmath151 in  ( [ pcurveboundsfix ] ) .",
    "[ cauchyschwarz ] by virtue of cauchy  schwarz inequality , the problem of minimizing the sub - riemannian length @xmath152 is equivalent to the problem of minimizing the action functional @xmath153 with @xmath154 fixed ( see , e.g. ,  @xcite ) .    [",
    "remark : reedsshepp ] in analogy with the sr problem @xmath32 in @xmath11 , cf .",
    "@xcite , we sometimes call @xmath155 the `` spatial generator '' and @xmath156 the `` angular generator '' , despite the fact that @xmath157 and @xmath158 are both angular generators on @xmath159 .",
    "the problem @xmath33 can be seen as a model of the reeds - shepp car on a sphere .",
    "the reeds - shepp car can move forward and backward and rotate on a place .",
    "the input @xmath142 controls the motion along @xmath160 , and the input @xmath143 controls the motion along @xmath161 , see fig .",
    "[ fig : reedsshepp ] .     and @xmath143 along the `` spatial generator '' @xmath160 and the `` angular generator '' @xmath161 ( cf .",
    "remark  [ remark : reedsshepp ] ) .",
    "[ fig : reedsshepp ] ]      we call a spherical projection the following projection map from @xmath6 onto @xmath129 ( see fig .  [",
    "fig : x ] ) : @xmath162 in coordinates @xmath163 defined by ( [ matexp ] ) , we have @xmath164 so we see that @xmath58 are spherical coordinates on @xmath31 .     and @xmath30",
    ". the rotations are parameterized by ( [ rexp ] ) , i.e. by angles @xmath165 , @xmath166 and @xmath167 of rotation about basis axes , see  ( [ matexp ] ) .",
    "* right : * illustration of the hopf fibration  @xcite  circle bundle with the base @xmath12 .",
    "[ fig : x],title=\"fig : \" ]    and @xmath30 .",
    "the rotations are parameterized by ( [ rexp ] ) , i.e. by angles @xmath165 , @xmath166 and @xmath167 of rotation about basis axes , see  ( [ matexp ] ) . *",
    "right : * illustration of the hopf fibration  @xcite  circle bundle with the base @xmath12 .",
    "[ fig : x],title=\"fig : \" ]    in problem @xmath30 , one is interested in a curve @xmath168 , which satisfies  ( [ pcurveboundsgen ] ) and minimizes ( [ epc ] ) . here",
    "@xmath169 , and @xmath170    next we show that the spherical projection ( [ proj ] ) of certain minimizers of @xmath32 provides solution of problem @xmath30 .",
    "more precisely , this only holds for the minimizers whose spherical projection does not have a cusp .",
    "the spherical projection of a minimizer of @xmath32 is said to have a cusp at @xmath171 if there exists @xmath172 , s.t .",
    "@xmath173 for all @xmath174 and @xmath175 . that is , if the control in front of the `` spatial '' generator @xmath157 switches sign locally .",
    "we are interested in the first cusp time @xmath176 , and we call @xmath177 the corresponding value of spherical arclength , s.t . @xmath178 via ( [ eq : tfroms ] ) .",
    "notice that if @xmath179 then the trajectory of @xmath32 is projected at a single point on @xmath12 which does not provide a solution to @xmath30 .",
    "this allows us to define @xmath177 as @xmath180 so that @xmath181 .",
    "the following theorem states that minimizers @xmath182 of @xmath30 for @xmath183 are given by spherical projection of the minimizers @xmath184 of @xmath32 for @xmath185 . here",
    "@xmath3 denotes the spherical arclength parameter , defined by @xmath186 , and @xmath187 denotes the sr arclength , defined by @xmath188 .",
    "[ prop:31 ] let @xmath184 , @xmath189 $ ] be a minimizer of @xmath32 parameterized by sr - arclength , and let the corresponding optimal control @xmath190 satisfy the inequality @xmath191 for all @xmath192 $ ] .",
    "set @xmath193 then for such boundary conditions , @xmath30 has a minimizer @xmath182 , along which we have @xmath194 for @xmath195 , and @xmath196 .    * proof * see appendix  [ app : c ] .",
    "in this section , we study the problem @xmath32 in the special case of uniform external cost @xmath141 , which we call @xmath198 . this problem can be seen as a left - invariant sr problem in lie group @xmath6 , and it was tackled by many authors ( see @xcite ) in different contexts .",
    "it is remarkable that the statement of the problem is very simple , but due to the high complexity of the formulas describing geodesics , the minimizers are still unknown for general @xmath19 .",
    "the case @xmath199 corresponds to a symmetric sr structure in @xmath6 , and it was completely solved in  @xcite . in this section , we consider the general case @xmath19 and derive analytic formulas for the geodesics using the parametrization  ( [ matexp ] ) for @xmath6 .",
    "further , in sect .  [ sec : numsol ] these formulas allow us to verify our numerical approach to compute the global minimizers of @xmath32 , presented for the first time by knowledge of the authors . in our analytical study , first we introduce a coordinate chart in @xmath6 and write the optimal control problem @xmath198 in this chart .",
    "then we apply pontryagin maximum principle ( pmp ) , which is the first - order necessary condition for optimality  @xcite , and we derive the explicit formulas for the sub - riemannian geodesics .",
    "afterward we explain the notion of sub - riemannian wavefront and sphere . finally , we discuss what is known about optimality of the geodesics .      in this section ,",
    "we introduce the chart in @xmath6 and formulate problem @xmath198 given by ( [ eq : so3sys])([eq : so3domain ] ) , see section [ subsec : pmecstat ] , as an optimal control problem on @xmath201 , where @xmath202 \\times \\r/\\{2 \\pi \\z\\}$ ] are the spherical coordinates , cf .",
    "( [ eq : proj ] ) , and @xmath203 .",
    "we use this specific chart to stress the analogy with the closely related problem in @xmath11 group ( see  @xcite ) .    consider a smooth curve @xmath204 departing from the origin , i.e. , @xmath205 . in sect .",
    "[ subsec : mathnot ] we parameterized the group @xmath6 by the angles @xmath165 , @xmath166 , @xmath167 , recall  ( [ matexp ] ) .",
    "a smooth curve @xmath83 corresponds to a smooth curve @xmath206 in @xmath6 defined by the one - parameter family of matrices @xmath207 depending smoothly on the parameter @xmath208 and satisfying the initial condition @xmath209 .",
    "a tangent vector of @xmath169 is expressed as @xmath210 therefore , the control system ( [ eq : so3sys ] ) can be rewritten as @xmath211 vector fields near the controls @xmath212 are two of three of the basis left ",
    "invariant vector fields in @xmath6 expressed in our chart .",
    "we denote them by @xmath160 , @xmath161 , and the third basis left invariant vector field is given by their commutator @xmath213 $ ] .",
    "thus we have @xmath214 then problem @xmath198 given by  ( [ eq : so3sys])([eq : so3domain ] ) for @xmath141 , taking into account remark  [ cauchyschwarz ] , is equivalent to the following optimal control problem : @xmath215    [ rmprojective ] a projective version of problem @xmath216 with @xmath199 is studied in @xcite .",
    "it is obtained by identification of antipodal directions @xmath167 and @xmath217 ; thus , its solution is given by minimum between two geodesics with terminal configurations @xmath218 and @xmath219 . the associated sr distance is given by @xmath220,{\\operatorname{so(3)}\\nolimits}),\\\\ \\gamma(0)=g , \\gamma(t ) \\in",
    "\\{h,\\bar{h}\\},\\\\ \\dot{\\gamma}(\\cdot ) \\in \\delta\\end{array } } \\mathcal{l}(\\gamma(\\cdot)).\\ ] ] the model in  @xcite is connected to problem @xmath216 via right shift @xmath221 .",
    "the local chart is obtained by linear transformation @xmath222 , @xmath223 , @xmath224 .",
    "the existence of optimal trajectories whose spherical projection contains a cusp is mentioned in  @xcite .      in this subsection",
    ", we apply the pontryagin maximum principle ( pmp ) to problem @xmath198 given by  ( [ eq : so3vsys])([intaction ] ) and derive the hamiltonian system of pmp . here",
    "we follow standard geometric control theory ( see , e.g. ,  @xcite ) . due to the absence of abnormal extremals ( see remark  [ rm : existence ] ) , we consider only the normal case , where the control - dependent hamiltonian of pmp reads as @xmath225 \\left . \\qquad \\qquad \\qquad \\qquad \\qquad \\text { with } \\lambda = \\sum \\limits_{k=1}^{3 } \\lambda_k { \\rm d } \\",
    ", \\nu^k \\in t^{\\ast}_\\nu \\mathcal{m}. \\right . \\end{array}\\ ] ] here @xmath226 , @xmath113 are given by  ( [ x1x2 ] ) , @xmath227 denotes the action of a covector on a vector , and @xmath228 are basis one forms .",
    "the maximization condition of pmp reads as @xmath229 where @xmath230 denotes an extremal control and @xmath231 is an extremal .",
    "introduce left - invariant hamiltonians @xmath232 , @xmath233 .",
    "the maximization condition gives the expression for the extremal controls @xmath234 then the maximized hamiltonian , which we call `` the hamiltonian '' , reads as @xmath235 the vertical part ( for momentum components @xmath236 ) of the hamiltonian system of pmp is given by @xmath237 where @xmath238 denotes the poisson bracket ( see  @xcite )",
    ". using the standard relation between poisson and lie brackets @xmath239\\rangle$ ] , we get @xmath240    thus the hamiltonian system with the hamiltonian @xmath241 follows by the last three identities and  ( [ eq : poiswithham ] ) : @xmath242 with the boundary conditions @xmath243 in  ( [ eq : hamsys ] ) , the horizontal part follows from  ( [ eq : extremalcontrols ] ) and  ( [ eq : controlsystem ] ) .",
    "it is known that the hamiltonian system  ( [ eq : hamsys ] ) is liouville integrable  @xcite , and it was explicitly integrated in  @xcite . in the next subsections , we classify the possible solutions by values of the parameter @xmath244 , and we adapt the explicit solution to our coordinate chart @xmath245 , where we follow the analogy to the closely related problem in @xmath11 .",
    "this allows us to obtain simpler formulas than in  @xcite .",
    "here we describe the domains of parameter @xmath19 , which correspond to different dynamics of the hamiltonian system ( [ eq : hamsys ] ) .",
    "it is well known ( see , e.g. ,  @xcite ) that this system has two integrals of motion that depend only on momentum components @xmath236 ( see illustration in fig .",
    "[ fig : integralsvp ] ) @xmath246 different values of the hamiltonian @xmath241 correspond to different speed along extremal trajectories @xmath83 . by fixing the value @xmath247 in ( [ eq : thehamiltoniantwice ] ) , we use sr arclength parameter @xmath248 along extremal trajectories .",
    "the momentum trajectory @xmath249 can be seen as the curve formed by intersection of the cylinder @xmath250 and the sphere @xmath251 ( see the yellow line in fig .  [",
    "fig : integralsvp ] ) .    ) .",
    "the red sphere is a coadjoint orbit @xmath252 and the green cylinder is the hamiltonian @xmath253.*bottom : * vector field plot on the @xmath254 plane.,title=\"fig : \" ] elliptic @xmath255       ) .",
    "the red sphere is a coadjoint orbit @xmath252 and the green cylinder is the hamiltonian @xmath253.*bottom : * vector field plot on the @xmath254 plane.,title=\"fig : \" ] linear @xmath256       ) .",
    "the red sphere is a coadjoint orbit @xmath252 and the green cylinder is the hamiltonian @xmath253.*bottom : * vector field plot on the @xmath254 plane.,title=\"fig : \" ] hyperbolic @xmath257    ) .",
    "the red sphere is a coadjoint orbit @xmath252 and the green cylinder is the hamiltonian @xmath253.*bottom : * vector field plot on the @xmath254 plane . ]       ) .",
    "the red sphere is a coadjoint orbit @xmath252 and the green cylinder is the hamiltonian @xmath253.*bottom : * vector field plot on the @xmath254 plane . ]       ) .",
    "the red sphere is a coadjoint orbit @xmath252 and the green cylinder is the hamiltonian @xmath253.*bottom : * vector field plot on the @xmath254 plane . ]",
    "elimination of @xmath258 from ( [ eq : thehamiltoniantwice ] ) and ( [ eq : coadjointorbit ] ) yields @xmath259 since @xmath260 , there exist the following types of solution of the vertical part of  ( [ eq : hamsys ] ) :    * elliptic for @xmath261 , @xmath262 ; * linear for @xmath199 , @xmath262 ; * hyperbolic for @xmath263 , @xmath264 , @xmath265 ; * a point ( 0,0 ) for @xmath261 , @xmath266 ; * a segment of a straight line for @xmath267 , @xmath268 ; * two crossing segments of straight lines for @xmath263 , @xmath266 ; * no solution otherwise .    according to this classification",
    ", we will refer to the case @xmath261 as the elliptic case , @xmath199 as the linear case , and @xmath263 as the hyperbolic case .      in this subsection",
    ", we provide explicit formulas for the sr geodesics , where we reexamine results from  @xcite .    in the coordinates @xmath269 , defined by @xmath270",
    "the vertical part of ( [ eq : hamsys ] ) becomes a system of mathematical pendulum @xmath271 where @xmath272 .",
    "thus @xmath273 corresponds to the elliptic , @xmath274 to the linear , and @xmath275 to the hyperbolic case .",
    "the system  ( [ pendeqsysc ] ) has a symmetry @xmath276 , which allows us to study the elliptic case and obtain the hyperbolic case by symmetry observations .",
    "note also that the linear case should be treated separately , but the equations in this case are much simpler .",
    "therefore , in the remainder of this manuscript we restrict ourselves to the case @xmath277 .    in the following theorem",
    ", we provide explicit formulas for sr geodesics in sr arclength parametrization .",
    "[ thmgeogtpar ] a solution of the system  ( [ eq : hamsys ] ) reads as @xmath278 x(t ) = \\arg(\\sqrt{r_{11}^2(t ) + r_{21}^2(t ) } + { \\mathrm{i}}r_{31}(t)),\\\\ y(t ) = \\arg(r_{11}(t ) + { \\mathrm{i}}r_{21}(t)),\\\\",
    "\\th(t ) = \\arg(r_{33}(t ) + { \\mathrm{i}}r_{32}(t ) ) , \\end{array } $ } } \\ ] ] where @xmath279 is a trajectory of  ( [ pendeqsysc ] ) , and @xmath280 @xmath281 @xmath282    * proof * see appendix  [ app : b ] .",
    "@xmath197    note that @xmath279 , and @xmath283 admit explicit expression in jacobi elliptic functions and elliptic integrals of the first , second and third kind  @xcite .",
    "we present plots of spherical projections  ( [ proj ] ) of extremal trajectories in fig .",
    "[ fig : extremalcurvestpar ] .",
    "here it is remarkable that the spherical projections of sr geodesics in @xmath6 can represent cusps , which can be undesirable for image analysis applications .",
    "this motivates us to study sr geodesics before the first cusp in their spherical projections . for short ,",
    "we call such curves `` cuspless geodesics . '' in sect .",
    "[ sec : pcurve ] we describe the possible end conditions , which can be connected by a cuspless geodesic , and in sect .  [ sec : numsol ] we provide pde - based approach for solving the boundary value problem ( bvp ) for data - driven sr geodesics , where we reformulate the problem as a solution to the sr - eikonal equation .       . ]    . ]     +    .",
    "]      a useful tool for studying geodesics in left - invariant optimal control problems is _ the exponential map _ that maps an initial momentum @xmath284 and a time @xmath187 to the end point of corresponding geodesic @xmath83 [",
    "i.e. , the exponential map integrates the hamiltonian system  ( [ eq : hamsys ] ) ] : @xmath285 now we explain the notion of _",
    "wavefront_. by definition , the wavefront consists of endpoints of all the geodesics of the same length @xmath154 : @xmath286 the outer surface of a wavefront forms a _ sub - riemannian sphere _ , which is a set of endpoints in @xmath146 equidistant from @xmath287 : @xmath288 where @xmath289 denotes",
    "the sub - riemannian distance between @xmath290 and @xmath291 , and @xmath292 denotes the cut time , i.e. , an instance of time , when a geodesic loses its optimality .      in the previous subsection",
    ", we computed sr geodesics or in other words extremal trajectories .",
    "it is known ( see , e.g. ,  @xcite ) that sufficiently short arcs of sr geodesics are sr length minimizers ( optimal trajectories ) . it is also known that in general a geodesic loses its optimality after a cut point .",
    "the corresponding instance of time is called cut time , and the set of all cut points in configuration space forms the so - called cut locus . in general , it is complicated to derive cut loci  @xcite .",
    "[ remark : maxwellconj ] there are two reasons for a geodesic to lose optimality : + @xmath293 1 ) local optimality is lost at a conjugate point ( critical point of exponential map , that integrates the hamiltonian system ) ; + @xmath293 2 ) global optimality is lost at a first maxwell point ( when two geodesics meet with the same length for the first time ) .    in problem",
    "@xmath198 , both the maxwell set and the conjugate locus are not known .",
    "the estimation of the first maxwell time was given in  @xcite , but still neither the cut locus , nor the sr length minimizers are known yet for general @xmath19 .",
    "the cut locus in a special case of the bi - invariant metric ( for @xmath199 ) was obtained in  @xcite . in  @xcite , conjugate locus in the riemannian case was constructed , and by considering a sr metric as a limiting case of the riemannian metric , the corresponding formulas for the conjugate locus in sr case could be obtained .    here",
    "we do not provide such a limiting procedure .",
    "instead , motivated by applications , in sect .  [ sec : numsol ] we propose a numerical solution to compute the sr length minimizers and spheres . in sect .",
    "[ sec : pcurve ] , motivated by the study  @xcite , we also give some statements on optimality of cuspless geodesics .",
    "we show that in contrast to @xmath11 case  @xcite there exist nonoptimal cuspless sr geodesics .",
    "in this section , we study cuspless sr geodesics .",
    "such geodesics allow parametrization by spherical arclength , which leads to simpler formulas than using sr arclength parametrization ( see sect .",
    "[ sec : pmec ] ) .",
    "spherical arclength parameterization breaks down , when the spherical projection of a geodesic exhibits a cusp for the first time .",
    "so a natural question arises to characterize the set of end conditions @xmath294 reachable by cuspless geodesics , similar to the @xmath11 case studied in  @xcite .",
    "the cuspless sr geodesics are projections in @xmath6 of the trajectories of the hamiltonian system ( [ eq : hamsys ] ) that are going in positive direction of @xmath160 ( i.e. , @xmath191 ) before the first cusp time @xmath295 .",
    "thus , by virtue of  ( [ eq : extremalcontrols ] ) the cuspless constraint is given by @xmath296.\\ ] ] we shall often rely on short notation @xmath297 , where we stress our notations @xmath298 in order to avoid confusion with the chain law for differentiation .",
    "recall  ( [ eq : smaxdef ] ) and note that @xmath177 for a given geodesics is determined by its initial momentum .",
    "we write @xmath299 when we want to stress this dependence .",
    "we derive an explicit formula for @xmath299 in sect .",
    "[ subsec : smax ] .",
    "[ thmhamsysspar ] for any @xmath300 , @xmath301 the system ( [ eq : hamsys ] ) is equivalent to the following system ( see corresponding vector flow in fig .",
    "[ fig : integralsvp ] ) : @xmath302 with the boundary conditions @xmath303    * proof * express the dynamics ( [ eq : hamsys ] ) in the spherical arclength parameter @xmath3 .",
    "we have @xmath304 here we recall that @xmath305 , see ( [ pcurvecontrols ] ) , and @xmath306 , see ( [ eq : extremalcontrols ] ) .",
    "thus we obtained the vertical part of ( [ eq : hamsysspar ] ) .",
    "doing the same for the horizontal part in ( [ eq : hamsys ] ) , we obtain the full system ( [ eq : hamsysspar ] ) , where the hamiltonian @xmath307 together with the cuspless constraint @xmath308 allows us to write @xmath309 .",
    "+ finally , the boundary conditions ( [ eq : hamsyssparbound ] ) follow from ( [ eq : hamsysbound ] ) , since @xmath310 .",
    "@xmath197 note that in contrast to the mathematical pendulum odes  ( [ pendeqsysc ] ) expressed in sr arclength @xmath187 , where the jacobi elliptic functions appear , the vertical part in @xmath3 parameterization now is a simple linear system of odes integrated in elementary functions . to obtain simpler formulas",
    ", we define the parameter @xmath311 ( where one should take principal square root ) : @xmath312    [ thmvertpartsparsol ] the general solution of the vertical part in ( [ eq : hamsysspar ] ) for all @xmath313 is given by @xmath314 and for the case @xmath199 , we find straight lines parallel to @xmath315 axis in the @xmath254-phase portrait : @xmath316    * proof * the solution to the system of odes is unique and it is readily checked ( [ vertpartchi ] ) is a solution of the vertical part of ( [ eq : hamsysspar ] ) for all @xmath317 . for @xmath261 , we take main values for the complex square root and complex @xmath318 and @xmath319 . for both @xmath199 and @xmath320 and @xmath321 , we have @xmath322 and @xmath323 .",
    "@xmath197      to analyze the cusp points in problem @xmath30 , we need to determine @xmath299 .",
    "it is given , recall  ( [ eq : smaxdef ] ) and  ( [ eq : extremalcontrols ] ) , by the minimal positive root of equation @xmath324 : @xmath325    [ thmsmax ] when moving along a sr geodesic @xmath326 the first cusp time is computed as @xmath327 , recall ( [ eq : tfroms ] ) , where @xmath328 \\frac{1}{\\chi}\\log \\left(\\frac{s_1\\left(\\sqrt{\\kappa}+\\chi\\right)}{h_2 ^ 0 \\chi + h_3 ^ 0}\\right ) & \\text { for } \\begin{array}{l }                                                                                                              \\chi\\neq0 , \\",
    ", \\kappa\\geq 0 , \\\\                                                                                                                  h_2 ^ 0 \\chi + h_3 ^ 0\\neq 0 , \\end{array}\\\\[3pt ] + \\infty & \\text { otherwise } , \\end{array } \\end{cases } $ } } \\end{aligned}\\ ] ] with @xmath329 + and @xmath330    as a result , in the sr manifold @xmath331 , recall  ( [ eq : subriemmanifold ] ) , there do exist nonoptimal cuspless geodesics .    * proof * see appendix  [ app : smax ] . @xmath197",
    "the presence of nonoptimal cuspless geodesics is remarkable , as in the @xmath11 group every cuspless geodesic is globally optimal  @xcite .      in this subsection , we derive the formulas for cuspless sr geodesics in @xmath3 parameterization .",
    "[ thmgeogspar ] the unique solution of  ( [ eq : hamsysspar ] ) is defined for @xmath332 , where @xmath299 is given by  ( [ eq : smax ] ) .",
    "the solution to the vertical part is given by theorem  [ thmvertpartsparsol ] and the solution to the horizontal part is given by @xmath333 where + @xmath334 @xmath335 @xmath336 with @xmath337 .    * proof * it follows from theoremes  [ thmgeogtpar ] ,  [ thmhamsysspar ] , and  [ thmvertpartsparsol ] .",
    "momentum component @xmath338 is expressed in @xmath339 via the hamiltonian  ( [ eq : thehamiltonian ] ) which equals to @xmath340 along sr geodesics .",
    "the sign of @xmath341 is equal to the sign of @xmath342 and therefore nonnegative .",
    "+ regarding the integration constraints , we note that @xmath343 and @xmath344 and @xmath345 from which the result follows .",
    "@xmath197    in contrast to general sr geodesics in @xmath6 given in @xmath187 parameterization , where jacobi elliptic functions appear , the cuspless sr geodesics in @xmath6 given in @xmath3 parameterization involve only a single elliptic integral @xmath346 .",
    "this integral can be expressed in terms of standard elliptic integrals .",
    "for example , in the elliptic case @xmath261 , @xmath262 we have @xmath347 where @xmath348 , @xmath349 , + with @xmath350 , which yields @xmath351 where @xmath352 denotes an elliptic integral of the first kind + and @xmath66 denotes an elliptic integral of the third kind .",
    "see plots of projected cuspless geodesics @xmath353 for @xmath354 in fig .",
    "[ fig : extremalcurvee ] .    @xmath261 +   in elliptic , linear and hyperbolic cases .",
    "[ fig : extremalcurvee],title=\"fig : \" ]       @xmath199 +   in elliptic , linear and hyperbolic cases . [ fig : extremalcurvee],title=\"fig : \" ]       @xmath263 +   in elliptic , linear and hyperbolic cases .",
    "[ fig : extremalcurvee],title=\"fig : \" ]",
    "in this section , we adapt the pde approach for data - driven sr geodesics in @xmath11  @xcite to the @xmath6 group . here",
    "we consider the basis left - invariant vector fields @xmath113 as differential operators of the first order , and we write @xmath355 for the derivative of a function @xmath356 along @xmath113 .",
    "we aim to solve the following optimal control problem : @xmath357 , \\\\ & \\gamma(t ) \\in { \\operatorname{so(3)}\\nolimits } , \\quad \\gamma(0 ) = e , \\",
    "\\gamma(t ) = g_1 , \\quad ( u_1 , u_2 ) \\in \\r^2,\\\\ & l(\\gamma(\\cdot ) ) = \\int_0^{t } c(\\gamma(t))\\sqrt{\\xi^2 u_1 ^ 2(t ) + u_2 ^ 2(t ) } \\ , \\mathrm{d } t \\to \\min.\\end{aligned}\\ ] ] here the terminal time @xmath154 is free ; and @xmath358 , @xmath359 is the external cost .    by rescaling of time @xmath360",
    "$ ] simultaneously with controls @xmath361 , we write down the explicit solutions as @xmath362,{\\operatorname{so(3)}\\nolimits } ) \\end{array } } } \\ !",
    "\\int \\limits_{0}^{1}\\ !",
    "\\sqrt{\\left.\\mathcal{g}\\right|_{\\gamma(\\tau)}(\\dot{\\gamma}(\\tau),\\dot{\\gamma}(\\tau ) ) } \\ , { \\rm d}\\tau .",
    "\\end{array}\\ ] ] here the sub - riemannian metric tensor @xmath363 is defined only on the distribution @xmath364 , recall remark  [ remark : srmanifold ] .",
    "here we propose a sr - fm method ( sub - riemannian fast marching ) for the computation of data - driven sr length minimizers ( not necessarily cuspless ) in @xmath6 group , as a solution to the sr - eikonal system  ( [ eq : eikonalsystfull ] ) .",
    "this method was successfully used in  @xcite for the computation of data - driven sr length minimizers in @xmath11 group .",
    "the method is based on a riemannian approximation of sub - riemannian manifold , and computing riemannian geodesics in highly anisotropic space , which becomes the sr manifold in the limiting case as anisotropy tends to infinity .    here",
    "we follow the explanation in  @xcite , where we work now in new settings of the @xmath6 group and use the coordinate chart @xmath163 defined in sect .",
    "[ subsec : pmecchart ] . recall that the basis left - invariant vector fields was denoted by @xmath365 @xmath113 in @xmath6 are given by the following differential operators : @xmath366 and corresponding basis left - invariant one forms @xmath367 , satisfying @xmath368 , are expressed as @xmath369 we approximate the sub - riemannian manifold by a riemannian manifold by fixing a small @xmath370 .",
    "moreover , the sr - eikonal equation  ( [ eq : eikonalsystfull ] ) is well defined and it can be derived as a limiting case of the eikonal equation on a riemannian manifold via the _ inverse _ metric tensor , see appendix  [ app : d ] .",
    "let us denote the riemannian distance as follows : @xmath371,{\\operatorname{so(3)}\\nolimits } ) \\end{array } } } \\!\\int \\limits_{0}^{1}\\ ! \\sqrt{\\left.\\mathcal{g}_{\\varepsilon}\\right|_{\\gamma(\\tau)}(\\dot{\\gamma}(\\tau),\\dot{\\gamma}(\\tau))}\\ , { \\rm d}\\tau .",
    "\\end{array}\\ ] ] with riemannian metric tensor @xmath372 given by @xmath373    [ remark : viscos ] in our approach , we shall rely on standard notion of viscosity solution @xcite of the riemannian eikonal equation , which admits a generalization to the sub - riemannian case . see details in appendix  [ app : d ] .",
    "the following theorem summarizes our approach for the computation of data - driven sub - riemannian length minimizers in @xmath6 .",
    "[ th : pde ] let @xmath374 be chosen such that there exists a minimizer @xmath375 \\to { \\operatorname{so(3)}\\nolimits}$ ] of @xmath376 such that @xmath377 is not a conjugate point for all @xmath378 $ ] and all @xmath379 sufficiently small .",
    "then @xmath380 is smooth and the minimizer @xmath381 is given by @xmath382 , with @xmath383 with @xmath384 and with @xmath385 denoting the viscosity solution of the following boundary value problem : @xmath386    for an outline of the proof , see appendix  [ app : d ] , where we rely on a similar approximation approach as in + for an elastica functional and in + for a sr problem on @xmath387 .",
    "[ remark : cusplessmodification ] the approach in theorem  [ th : pde ] can be adapted for producing only the cuspless minimizers .",
    "see appendix  [ app : d1 ] .",
    "the sr spheres of radius @xmath187 centered at @xmath287 are given by @xmath388 .",
    "recall that conjugate points are points where local optimality is lost . for",
    "a formal definition and characterization , see ( * ? ? ?",
    "* def.8.4.3,cor.8.4.5 ) . we would conjecture that the assumption on the conjugate points in the above theorem is not really needed , as even the conjugate points that are limits of first maxwell points do not seem to cause problems in the backtracking procedure , akin to the @xmath387 case ( * ? ? ?",
    "* app.d ) , but nevertheless our proof in appendix  [ app : d ] does rely on this assumption .    from the derivations above theorem",
    "[ th : pde ] , we see that the fast marching approach for computing sr geodesics in @xmath11 , cf .",
    "@xcite , is easily generalized to the @xmath6 case . to this end , we replace the matrix representation for @xmath372 expressed in the fixed @xmath389 cartesian coordinate frame . in the @xmath6 case",
    ", it equals @xmath390 with @xmath391 here the diagonal matrix in the middle encodes the anisotropy between the @xmath113 directions , while the matrix @xmath392 is the basis transformation from the moving coframe @xmath393 to the fixed coframe @xmath394 , recall  ( [ eq : basisforms ] ) , in which the fast marching implementation via special anisotropic stencils  @xcite is used . in sect .",
    "[ subsec : experiment_uniformcost ] , we will show that the thereby obtained fast marching approach already presents reasonable precision for @xmath395 .",
    "experiments in sect .",
    "[ subsec : retinal_example ] show the application of the method ( with data - adaptive nonuniform cost ) to tracking of blood vessels in retinal images .",
    "in sect .  [ subsec : experiment_uniformcost ] , we verify the sr - fm method by comparison of sr length minimizers / spheres obtained via sr - fm with the exact sr geodesics / wavefronts ( cf . sect .",
    "[ sec : pmec ] ) for the case of uniform external cost ( i.e. @xmath141 ) . in sect .",
    "[ subsec : comparisonse2so3_uniformcost ] , we compare sr geodesics and wavefronts in the groups @xmath11 and @xmath6 ( sect .",
    "[ subsec : comparisonse2so3geodesics ] ) for the uniform external cost case . in sect .",
    "[ subsec : retinal_example ] , we provide experiments of vessel tracking by sr geodesics in @xmath6 when the external cost @xmath37 is induced by spherical data , and compare them to the result of vessel tracking on the corresponding flat image by sr geodesics in @xmath11 .      in this subsection , we perform the experiments to validate the sr fast marching ( sr - fm ) method proposed in sect .",
    "[ subsec : fastmarching ] .",
    "the goal of the experiments is to check that the method produces an accurate approximate solution to the sr problem in @xmath6 group in the case of uniform external cost @xmath396 . in all the experiments",
    ", we fixed the anisotropy parameter of the riemannian approximation as @xmath397 .",
    "in the first experiment , we compare the geodesics @xmath398 obtained via sr - fm with the exact cuspless geodesics @xmath83 computed via analytic formulas in theorem  [ thmgeogspar ] .",
    "we perform the comparison as follows : + 1 ) fix @xmath19 and the initial momenta @xmath284 .",
    "+ 2 ) compute the first cusp time @xmath299 corresponding to @xmath284 , and set @xmath399 .",
    "+ 3 ) compute the geodesic @xmath400 , @xmath401 $ ] via thm .",
    "[ thmgeogspar ] . + 4 ) compute the distance function @xmath385 in the domain @xmath402\\times[-\\pi,\\pi]\\times[-\\pi,\\pi]$ ] via sr - fm . here",
    "we compute the distance function in the grid of @xmath403 points and then interpolate it using third - order hermite interpolation .",
    "+ 5 ) compute the geodesic @xmath404 , @xmath405 $ ] via backtracking  ( [ eq : backtrackmain ] ) from the endpoint @xmath406 .",
    "+ 6 ) plot the spherical projections of @xmath400 and @xmath404 and compare them .",
    "a typical result of the comparison is shown in fig .",
    "[ fig : exactgeodvsnumeric ] , where we set @xmath407 , @xmath408 for all the curves and varied initial momentum @xmath409 , @xmath410 , @xmath411 , @xmath412 , @xmath413 , @xmath414 , @xmath415 , @xmath416 , @xmath417 , @xmath418 , @xmath419 , @xmath420 . as a result",
    ", we see that the geodesics computed numerically via sr - fm accurately follow the exact geodesics .",
    "computed by exact formulas in theorem  [ thmgeogspar ] ( green dashed lines ) and our numerical fast marching approximations ( red lines ) . + * bottom : * example of nonoptimal cuspless geodesics.,title=\"fig : \" ] +   computed by exact formulas in theorem  [ thmgeogspar ] ( green dashed lines ) and our numerical fast marching approximations ( red lines ) . + * bottom : * example of nonoptimal cuspless geodesics.,title=\"fig : \" ]    we have performed a series of such experiments and always obtained similar results when the geodesics @xmath421 were optimal for @xmath422 $ ] . it was also remarkable that sr - fm resulted into different curves ( length minimizers ) when the geodesic @xmath421 was not optimal for @xmath422 $ ] .",
    "such an example is illustrated in fig .",
    "[ fig : exactgeodvsnumeric ] ( bottom ) .",
    "the question of optimality of sr geodesics in @xmath6 in the general case @xmath19 is an open important problem , recall sect .",
    "[ subsec : optimality ] . here",
    "we provide a numerical sr - fm method for computing only the optimal geodesics . in analogy with how it was done in  @xcite ,",
    "it is possible to compute maxwell sets numerically .",
    "we have a strong conjecture that optimality is lost at the first maxwell point induced by reflectional symmetries along the geodesic .",
    "we leave the computation of maxwell points and analysis of optimality of the geodesics as a direction for future work .    to verify the sr - fm method we also perform experiments with comparison of the geodesics obtained via sr - fm and the general geodesics ( not necessarily cuspless ) given by theorem  [ thmgeogtpar ] .",
    "a typical result is presented in fig .",
    "[ fig : compwithcusp ] ( top ) . here",
    "we again observe an accurate result of sr - fm , but now for the geodesics whose spherical projections have cusps .",
    "( green dashed lines ) obtained via analytic formulas ( theorem  [ thmgeogtpar ] ) and sr geodesics computed numerically via sr - fm ( red lines ) . here",
    "@xmath423 , @xmath424 , and initial momenta @xmath425 .",
    "* bottom : * comparison for @xmath199 of wavefront in @xmath6 ( green transparent surface ) obtained via the analytic formulas of theorem  [ thmgeogtpar ] for @xmath426 and the sr - sphere ( orange solid surface ) for the same @xmath154 , obtained via sr - fm . , title=\"fig : \" ] +   ( green dashed lines ) obtained via analytic formulas ( theorem  [ thmgeogtpar ] ) and sr geodesics computed numerically via sr - fm ( red lines ) . here @xmath423 , @xmath424 , and initial momenta @xmath425 . * bottom : * comparison for @xmath199 of wavefront in @xmath6 ( green transparent surface ) obtained via the analytic formulas of theorem  [ thmgeogtpar ] for @xmath426 and the sr - sphere ( orange solid surface ) for the same @xmath154 , obtained via sr - fm .",
    ", title=\"fig : \" ]    to conclude this section , we provide one more experiment , where we compare the exact sub - riemannian wavefronts and sr spheres computed via sr - fm .",
    "we show that the sr - fm method provides a distance function @xmath385 that closely approximates the sr distance @xmath427 . in fig .",
    "[ fig : compwithcusp ] , we show the comparison of the exact wavefront @xmath428 and isosurface @xmath429 . here",
    "we see that the isosurface computed via sr - fm accurately follows the outer surface of the exact wavefront ( i.e. , exact sr sphere ) .",
    "a similar picture was obtained for different radii @xmath154 .      in this subsection ,",
    "we compare sr geodesics and wavefronts in @xmath11 and @xmath6 and analyze their applicability in image processing .",
    "we also include a short discussion about optimality of geodesics , which is closely related to the analysis of self - intersections of wavefronts and the study of cut loci . to this end",
    ", we provide accurate plot of the wavefronts near their singularities .      in this subsection",
    ", we show a comparison of the sr wavefronts in @xmath6 and @xmath11 in the case of uniform external cost @xmath141 . here",
    "we employ the fact that the coordinate chart @xmath163 in @xmath430 was chosen in the way to obtain the analogy with @xmath431 .",
    "this allows us to plot sr wavefronts of @xmath6 and @xmath11 in the same 3d plot .    in this comparison ,",
    "we use the sr arclength parameterization @xmath187 , where the geodesic @xmath432 is given by exponential map @xmath433 , recall ( [ eq : expmap ] ) , i.e. , by the projection in @xmath6 of the solution of the hamiltonian system  ( [ eq : hamsys ] ) , with initial condition @xmath434 , @xmath435 . to establish the comparison of wavefronts we switch to polar",
    "coordinates @xmath436 , recall  ( [ eq : polarcoords ] ) , where the hamiltonian system in @xmath6 reads as : @xmath437 a solution to this system is given by theorem  [ thmgeogtpar ] .",
    "the hamiltonian system for sr geodesics in @xmath11 ( see , e.g. ,  @xcite ) reads as : @xmath438 a solution to this system is given in  @xcite .",
    "indeed , we observe a clear similarity between the @xmath6 and @xmath11 case , when using parametrization  ( [ matexp ] ) . in fig .",
    "[ fig : wfcomparison ] , we plot the sr wavefronts in @xmath6 and @xmath11 for several values of end time @xmath154 . in these plots ,",
    "we identify @xmath163 and @xmath439 , so that the red surfaces @xmath440 are the sr wavefronts of @xmath11 and the green surfaces @xmath441 are the sr wavefronts of @xmath6 .",
    "we see a very similar shape of @xmath441 and @xmath440 for small radii @xmath154 , but the difference increases when @xmath154 increases .",
    "thus , we conclude that the sr geodesics in @xmath6 can be locally approximated by the sr geodesics in @xmath11 , but globally they are considerably different .",
    "one can also observe that the singular points ) .",
    "] of @xmath441 are located near singular points of @xmath440 .",
    "this leads us to a conjecture that the location of conjugate points ( open problem ) can be estimated by the location of conjugate points of @xmath440 .",
    "note also that in the general case @xmath19 the set of singular points has a complicated shape . in fig .",
    "[ fig : wfsingcomparison ] we present more detailed plot of the singularities , with the depicted maxwell set and special cases of conjugate points , which are limit points of the maxwell set on sr sphere ( outer part of wavefront ) .",
    "( red ) and @xmath6 ( green ) for @xmath442 , @xmath267 , @xmath443 .",
    "a zoomed in picture for the blue square is provided in fig .  [ fig : wfsingcomparison],title=\"fig : \" ]    ( red ) and @xmath6 ( green ) for @xmath442 , @xmath267 , @xmath443 .",
    "a zoomed in picture for the blue square is provided in fig .",
    "[ fig : wfsingcomparison],title=\"fig : \" ]    in fig .",
    "[ fig : wfsingcomparison ] we observe that the wavefront in @xmath6 has a very special symmetry when @xmath199 .",
    "this is not present for @xmath313 and this never happens in the @xmath11 group .",
    "the case @xmath267 for sr manifold in @xmath6 was completely examined in  @xcite , where it was shown that locally the conjugate locus is an interval , and globally it is a circle without a point .",
    "changing @xmath244 destroys the symmetry , conjugate and maxwell points are getting separated , and the conjugate locus has an astroidal shape  @xcite .          in this subsection",
    ", we again consider the case @xmath141 and compare sr geodesics @xmath444 and @xmath445 in the image plane .",
    "the sr - fm method is used for computation of the geodesics parameterized by sr arclength . here",
    "we prepare background for comparison of the geodesics in retinal images via the schematic eye model , recall sect .",
    "[ subsec : motivation1 ] , where as a departure point we use an image ( white for @xmath141 ) on a plane @xmath446 , recall fig .",
    "[ fig : twospheres ] .",
    "see fig .",
    "[ fig : experimenta ] , where we compare @xmath11 and @xmath6 sr geodesics projected on the plane and on the sphere ( via mappings @xmath66 and @xmath68 ) . for details , see appendix  [ app : geodcomp ] .",
    "sr geodesic ( blue ) and an @xmath6 sr geodesic ( red ) , from left to right in @xmath58 spherical image coordinates , @xmath28 flat image coordinates , and plotted on the sphere @xmath12.,title=\"fig : \" ]   sr geodesic ( blue ) and an @xmath6 sr geodesic ( red ) , from left to right in @xmath58 spherical image coordinates , @xmath28 flat image coordinates , and plotted on the sphere @xmath12.,title=\"fig : \" ]      as explained in introduction in sect .",
    "[ subsec : motivation1 ] , we need to include the spherical geometry of the retina rather than the flat geometry of the flat image . this spherical geometry is encoded in our spherical image model , see fig .",
    "[ fig : twospheres ] .",
    "next we will analyze the effect of including this geometry in the sr - fm vessel tracking method along data - driven sr geodesics in @xmath6 .",
    "more precisely , we propose vessel tracking in object coordinates ( or spherical image coordinates ) via sr geometry in @xmath6 as an extension of vessel tracking in flat images  @xcite along sr geodesics in @xmath11 .",
    "therefore , we want to investigate whether including the correct spherical geometry makes a difference in the vessel tracking in practice .",
    "although a complete detailed comparison on large data sets is left for future work , we present preliminary experiments which indeed indicate considerable differences in both tractography and curvature measurements .",
    "these experiments are shown in figs .",
    "[ fig : vesselcomparison ] , and  [ fig : curvaturefigure ] and next we explain them .",
    "we apply the same scheme as in sect .",
    "[ subsec : comparisongeodesics ] , but now we compute data - driven geodesics , where the external cost is induced by image data .",
    "next we explain the construction of the external cost that is applied in all experiments . for the sake of simple comparison , we restrict ourselves to a cost depending on the spherical coordinates only , and we set @xmath447 where we use standard multiscale vesselness  @xcite @xmath448 with @xmath449 eigenvalues of the gaussian hessian of image @xmath450 ( maximized over scales ) ordered by @xmath451 , with @xmath452 , and with unit step function @xmath453 + here we note that the gaussian hessian is given by @xmath454 and computed by gaussian derivatives  @xcite at multiscales @xmath455 in term of pixel sizes .        in the experiment in figure",
    "[ fig : vesselcomparison ] , we show that there is a considerable difference between @xmath11 sr geodesics and @xmath6 sr geodesics .",
    "we see that when internal geometry is dominant over the external cost ( @xmath456 small ) the sr geodesics in @xmath6 are more stiff than sr geodesics in @xmath11 , and therefore in the boundary value problem they are less eager to take shortcuts and better follow the vessel structure . in case @xmath456 is large ( external cost is dominant than the internal geometry ) , we see only small differences in the overall locations of the @xmath11 curves and @xmath6 curves .",
    "the results are stable w.r.t .",
    "choice of @xmath457 ( which controls the distance from the camera to the eye ball , relative to eye ball radius , recall fig .",
    "[ fig : twospheres ] ) .        in the next experiment",
    ", we measure the curvature of the curves obtained by the vessel tracking method via @xmath11 geometry and via @xmath6 geometry . for this experiment",
    ", we used the values @xmath458 , @xmath459 and @xmath460 .",
    "although in this case the result of tractography is very similar for the @xmath11 and @xmath6 curves , we show that there is a considerable difference in their curvature .",
    "( from theorem  [ prop:31 ] ) the geodesic curvature of a spherical projection of data - driven geodesic @xmath432 satisfies @xmath461    * proof * the first equality in the chain @xmath462 is implied by eq .",
    "( [ pcurvecontrols ] ) .",
    "the second equality follows from application of pmp to problem @xmath32 , which gives @xmath463 and @xmath464 .",
    "the third equality follows from the fact that in the points where the bellman function @xmath465 is differentiable ( almost everywhere in our case ) its derivatives are given by components of momentum covector @xmath466 , @xmath467 , see  @xcite .",
    "@xmath197    by the same argument , it can be checked ( see  @xcite and  @xcite ) that the planar curvature of spatial projections of sr geodesics in @xmath11 satisfies @xmath468 with @xmath469 , @xmath470 basis left - invariant vector fields @xmath11 .",
    "thus the curvature analysis can be simply done based on vessel tracking , and this shows the benefit of our algorithm . in fig .",
    "[ fig : curvaturefigure ] , we show an experiment of vessel curvature measurement based on tracking via @xmath6 geometry and via @xmath11 geometry . for completeness , we added also a comparison with a planar curvature @xmath471 of a planar projection @xmath472 of @xmath473 .",
    "we can see a considerable difference in curvature measurement via @xmath6 geometry and @xmath11 geometry .",
    "it is also seen , that that the difference between @xmath474 and @xmath475 is not very significant .",
    "thus we see the importance of including correct spherical geometry in vessel tracking algorithm in retinal images .",
    "next we address the general benefit of using sr geodesics rather than ( isotropic ) riemannian geodesics in the tracking of salient lines ( blood vessels ) in spherical images . to this end , we show a typical example where the tracking induced by a sub - riemannian geodesic gives better result than the tracking induced by a riemannian geodesic .",
    "the experiment in fig .",
    "[ fig : srandriem ] is performed similar to sect .",
    "[ subsec : retinal_example ] , but now we compare the result of vessel tracking via sr geodesics ( obtained by sr - fm ) and riemannian geodesics ( isotropic metric with @xmath476 ) . from this experiment , we see that similarly to the @xmath11 case  @xcite the tracking via riemannian geometry suffers from incorrect jumps toward nearly parallel neighboring vessels and yields nonsmooth curves , the tracking via sr geometry gives the desirable result .    .",
    "data - driven sub - riemannian geodesics in 3d lie groups are a suitable tool for tractography of blood vessels in retinal imaging . in previous works on the @xmath11 case  @xcite",
    "practical advantages have been shown in comparison with the ( isotropic ) riemannian case , and geodesic methods in the image domain .",
    "however , these models included a sr geometry on @xmath477 based on lifts of flat images , which does not match the actual object geometry : the retina is spherical rather than planar , cf .",
    "[ fig : retinasphere ] , fig .",
    "[ fig : eye2 ] , and fig .",
    "[ fig : twospheres ] .",
    "a similar observation holds for models in the psychology of contour perception in human vision  @xcite .",
    "therefore , for geometric tracking we propose a frame bundle above @xmath159 , cf .",
    "[ fig : x ] , instead of a frame bundle above @xmath478 . geometric tracking of geodesics is done along globally optimal data - driven sr geodesics in @xmath6 ( and their spherical projections ) by our new numerical wavefront propagation method .",
    "the method was validated for the uniform cost case by comparisons with exact geodesics which we derived in sect .",
    "[ sec : pmec ] , cf .  figs .",
    "[ fig : exactgeodvsnumeric ] , and  [ fig : compwithcusp ] . here ,",
    "in contrast to the @xmath11 case @xcite , we do not have a scaling homothety . as a result",
    ", the parameter @xmath244 has a considerable effect on the geometry , and for @xmath199 we identify the linear case , for @xmath263 we identify the hyperbolic case , and for @xmath261 we identify the elliptic case , cf .  figs .",
    "[ fig : integralsvp ] and  [ fig : extremalcurvee ] .    for all of these cases ,",
    "we have computed the first cusp time in theorem  [ thmsmax ] ( the first time where the spherical projection of a sr geodesic exhibits a cusp ) .",
    "also , we have presented new formulas for such `` cuspless '' sr geodesics in theorem  [ thmgeogspar ] .",
    "these formulas only involve a single elliptic integral thanks to spherical arclength parametrization , and for @xmath479 our formulas are simpler than the general formulas for sr geodesics in @xmath6 .",
    "furthermore , we used a specific parametrization of lie group @xmath6 that allowed us to compare between sr geodesics / wavefronts in @xmath6 to sr geodesics / wavefronts in @xmath11 , cf .",
    "[ fig : wfcomparison ] and  [ fig : wfsingcomparison ] . in our comparison",
    "we took into account a standard optical model for the mapping between object coordinates on the retina and camera coordinates in the acquired planar retinal image . in our experiments ,",
    "the differences between the @xmath6 case and the @xmath11 case are considerable , both for the case of uniform cost , cf .",
    "[ fig : experimenta ] , and for the data - driven case in the retinal image analysis application , cf .  fig .",
    "[ fig : vesselcomparison ] . in general",
    ", we see that for realistic parameter settings ( in optics ) the @xmath6 geodesics have a slower variation in curvature and are less eager to take shortcuts , see , e.g. , figs .",
    "[ fig : vesselcomparison ] and  [ fig : curvaturefigure ] . furthermore , there are visible differences between geodesic curvature of data - driven sr geodesics on the sphere and the curvature of their planar projections . as in retinal imaging applications ,",
    "curvature is considered as a relevant biomarker @xcite for detection of diabetic retinopathy and other systemic diseases , the data - driven sr geodesic model in @xmath6 is a relevant extension of our data - driven geodesic model in @xmath11 .",
    "here we restricted ourselves to feasibility studies .",
    "more extensive comparisons between @xmath6 geodesics and @xmath11 geodesics on large retinal imaging benchmark sequences are beyond the scope of this article and are left for future work .",
    "finally , we note that the computation time for data - driven sr geodesics in @xmath6 is exactly the same as for the @xmath11 case .",
    "our specific choice of coordinates of @xmath6 allowed us to modify the very efficient fast marching approach  @xcite , with a simple replacement of the metric tensor matrix .",
    "the research leading to these results has received funding from the european research council under the european community s seventh framework programme ( fp7/2007 - 2013)/erc grant _ lie analysis _ , a.n .",
    "the authors gratefully acknowledge eu - marie curie project _ manet _ ag .",
    "607643 , and rfbr research project no .",
    "16 - 31 - 60083 mol_a_dk for financial support .",
    "the publication was supported by the ministry of education and science of the russian federation ( the agreement number 02.a03.21.0008 ) .",
    "the authors gratefully acknowledge dr .",
    "sanguinetti and dr .",
    "mirebeau on their efforts on anisotropic fast marching implementation of sr geodesics in @xmath11 @xcite that allowed for our generalization to the @xmath6 case .",
    "furthermore , the authors thank g.r .",
    "sanguinetti on helpful comments and suggestions on earlier versions of this article .",
    "we thank dr .",
    "tos berendschot for fruitful discussions on retinal imaging and for his encouragement to take into account the spherical nature of the retina in our geometric retinal image processing .",
    "the authors thank anonymous reviewers whose valuable comments improved the exposition of this work .",
    "the function @xmath480 is differentiable and increasing for @xmath189 $ ] ; then there exists an inverse function @xmath481 , @xmath482 $ ] , @xmath483 , differentiable and increasing .",
    "notice that @xmath484 , which gives the second equality in ( [ pcurvecontrols ] ) .",
    "define @xmath485 , @xmath486 , @xmath487 . from the dynamics of @xmath32 we obtain identities @xmath488",
    "then the gauss  bonnet formula  ( [ eq : gaussbonnet ] ) gives @xmath489 which implies the third equality in ( [ pcurvecontrols ] ) .",
    "the boundary conditions  ( [ pcurverbounds ] ) for the curve @xmath182 follow from its definition and the boundary conditions for @xmath184 .",
    "recall that by definition @xmath490 .",
    "since the minimizer @xmath184 is parameterized by sr arclength , we have @xmath491 whence @xmath492 which implies  ( [ eq : ts ] ) after integration w.r.t . @xmath3 .",
    "thus , we can see that the optimization functionals of @xmath30 and @xmath32 coincide : @xmath493 but also the dynamics coincides , in the following sense .",
    "if @xmath494 , @xmath495 $ ] , is a smooth curve on the sphere @xmath12 with the initial conditions @xmath496 , @xmath497 and a geodesic curvature @xmath498 , then it can be lifted to a curve @xmath499 in @xmath6 that is a trajectory of control system  ( [ eq : so3sys ] ) with the controls @xmath500 , @xmath501 and the initial condition @xmath502 .",
    "the curve @xmath503 on @xmath12 has the same initial conditions and geodesic curvature as @xmath494 , thus @xmath504 .    summing up ,",
    "since @xmath184 is a minimizer of @xmath32 , then its projection @xmath182 to the sphere @xmath12 is a minimizer of @xmath30 .",
    "to integrate the hamiltonian system  ( [ eq : hamsys ] ) we follow the idea of v.  jurdjevic  @xcite , where one can employ left invariance and introduce initial rotation @xmath505 of momentum space , such that the initial momentum transforms to @xmath506 , solve the problem in this simple case ( i.e. , to find the trajectory @xmath507 that corresponds to @xmath506 ) , and obtain general solution @xmath184 by a backward transformation @xmath508 .",
    "substitution of  ( [ eq : extremalcontrols ] ) to  ( [ eq : controlsystem ] ) gives @xmath509 the hamiltonian system can be written as a lax type of system  @xcite @xmath510 \\text { --- vertical part , } \\label{vertpartlax}\\\\ & & \\dot{r } = r \\omega \\text{--- horizontal part } \\label{horpartlax}.\\end{aligned}\\ ] ] here @xmath511 is a momentum covector expressed in the basis @xmath367 , dual to @xmath105 , i.e. , @xmath512 . the vertical part ( [ vertpartlax ] ) has @xmath513 as a solution .",
    "thus , the hamiltonian system ( [ vertpartlax])([horpartlax ] ) preserves the norm of momentum covector @xmath514 , i.e. the value @xmath515 , whose isosurface is a coadjoint orbit of @xmath6 .",
    "the killing form allows to identify @xmath108 and @xmath516 ( see  @xcite ) , and by isomorphism  ( [ so3r3iso ] ) , we write @xmath517 next we apply a left action of @xmath6 on solution curve @xmath206 @xmath518 where @xmath519 is chosen such that the initial momentum matrix @xmath520 and initial covector @xmath521 are reduced to a simple form @xmath522 as the nicest possible representant within the coadjoint orbit of @xmath6 .",
    "next we represent the rotation matrix @xmath523 in form  ( [ matexp ] ) , i.e. , @xmath524 , where we parameterize the rotations via 3 angles @xmath525 $ ] , @xmath526 , @xmath527 .",
    "substitution of ( [ eq : p0 ] ) in ( [ pendvecsol ] ) gives the momentum matrix @xmath528 and the equivalent relation for the momentum covector @xmath529 by multiplying the matrices in the right - hand side , we obtain @xmath530 from  ( [ barh ] ) we immediately have @xmath531 and since @xmath532 \\rightarrow \\cos \\tilde{x}(t ) \\geq 0 $ ] , we can also express @xmath533    to obtain @xmath283 first notice that due to left invariance , the matrix @xmath523 satisfies the same equation as @xmath34 , i.e. , @xmath534 .",
    "thus @xmath535 , @xmath536 , @xmath537 satisfy the same equations as @xmath165 , @xmath166 , @xmath167 , i.e. , the horizontal part of  ( [ eq : hamsys ] ) .",
    "thus we have @xmath538 with the initial condition @xmath539 following from @xmath540 .    by virtue of  ( [ barh ] )",
    "we can express  ( [ dbarx ] ) as @xmath541 further , since @xmath542 , we have @xmath543 thus we obtained solution for @xmath544 , @xmath283 , @xmath545 .",
    "to finish the proof , it only remains to obtain solution for @xmath546 .",
    "recall that the expression ( [ eq : rtotilder ] ) for @xmath184 follows from orthogonality of matrix @xmath505 , i.e. , @xmath547 , and parameterization of @xmath184 by @xmath546 as @xmath548 .    to find @xmath546 notice that action of @xmath184 on @xmath549 and @xmath550 on @xmath551 gives @xmath552 since @xmath553 $ ]",
    ", first two equations in ( [ xythsol ] ) follow from ( [ xy ] ) and the third equation in ( [ xythsol ] ) follows from ( [ xth ] ) .",
    "recall that we consider the case ( see remark [ rm1 ] ) where the curve starts from @xmath554 and goes in the direction of upper half of the sphere with tangent vector @xmath551 .",
    "therefore , we have @xmath555 , @xmath556 . via the hamiltonian @xmath307",
    ", we express @xmath557 . as a result",
    ", one has @xmath558 in the linear case @xmath559 , eq .",
    "( [ eq : h2 ] ) reads as @xmath560 , that has the minimal positive root @xmath561 in the elliptic and the hyperbolic cases , we need to find a minimal positive root of @xmath562 in the elliptic case , we have @xmath563 , where @xmath564 , yielding solution @xmath565 denote @xmath566 .",
    "notice that when @xmath567 @xmath568 @xmath569 we have @xmath570 and therefore we have cuspless trajectory of infinite sr length , recall ( [ eq : tfroms ] ) . this fact is also clear from phase portrait of dynamic of vertical part  ( [ vertpartchi ] ) , see fig .",
    "[ fig : integralsvp ] ( bottom , left ) , where intersection of the integral curve with the red straight line indicates the moment , when cusp appears .",
    "we see that some geodesics have no cusps in their spherical projection up to infinity .",
    "notice that since @xmath6 is compact , it has bounded diameter ( i.e. there exists @xmath571 , such that the sr distance between any two elements of @xmath6 does not exceed @xmath572 ) .",
    "thus in contrast to @xmath11 group , where every cuspless geodesic is optimal ( see  @xcite ) , we observe that there exist nonoptimal cuspless geodesics in @xmath6 group .",
    "in the hyperbolic case @xmath573 , @xmath263 we have @xmath574 and the minimal positive root of ( [ smaxeq ] ) reads as @xmath575 finally , using the parameter @xmath576 , we have a single formula  ( [ eq : smax ] ) for all cases . @xmath197",
    "by the result in ( * ? ? ?",
    "* thm 11.15 ) points @xmath577 where the sr distance @xmath578 given by ( [ srdist ] ) is nonsmooth are either conjugate points , maxwell points or abnormal points .",
    "so by assumption ( and absence of abnormal geodesics due to a 2-bracket generating distribution @xmath364 , cf .",
    "* ch:20.5.1 ) ) we see that @xmath578 is smooth at @xmath579 . as a result , the mapping @xmath580 \\ni",
    "\\tau \\mapsto d_{{\\operatorname{so(3)}\\nolimits}}^{0}(e,\\gamma^*_{0}(\\tau ) ) \\in \\r^+\\ ] ] is smooth as it is a smooth composition of maps .",
    "similarly for the riemannian case @xmath581 , recall ( [ rdist ] ) , we have by the assumptions that @xmath580 \\ni \\tau \\mapsto d_{{\\operatorname{so(3)}\\nolimits}}^{\\varepsilon}(e,\\gamma^*_{\\varepsilon}(\\tau ) ) \\in \\r^+\\ ] ] is smooth for all @xmath581 .",
    "let @xmath582 denote the inverse metric tensor associated with @xmath148 given by ( [ srmt ] ) , and let @xmath583 denote the inverse metric tensor associated with @xmath372 given by ( [ rmt ] ) .",
    "now we rely on standard results @xcite on backtracking of optimal _ riemannian _ geodesics in riemannian manifolds .",
    "this means that we find the smooth optimal geodesics via an intrinsic gradient descent on the riemannian distance map @xmath584 .",
    "this yields the identity @xmath585 where @xmath586 is the unique viscosity solution @xcite of the corresponding riemannian eikonal equation given by @xmath587 next we transfer these standard results toward the sub - riemannian case , by a limiting procedure .",
    "firstly , we note that following a fully tangential approach to ( * ? ? ?",
    "* app.a , thm.2 ) yields ( see remark  [ rem : below ] below ) the following respectively pointwise and uniform convergence : @xmath588 secondly , one has for any smooth function @xmath589 that the intrinsic gradients converge : @xmath590 thirdly , as @xmath591 and @xmath592 are solutions to the hamiltonian system of the pontryagin maximum principle , the trajectories are continuously depending on @xmath581 , and so are their derivatives . as a result , we have @xmath593 furthermore , from ( [ reik ] ) it follows that @xmath594 where we note that the third term under the square root , after substitution of ( [ conv ] ) , vanishes .",
    "finally , the viscosity solution property @xcite is also naturally carried over due to continuous @xmath595 dependence of the hamiltonian and the convergences ( [ help1 ] ) , ( [ finalconv ] ) .",
    "@xmath197    [ rem : below ] the idea for the convergence ( [ help1 ] ) which is tangential to the @xmath596 case considered in + ( * ? ? ?",
    "* app.a , thm.2 ) is based on a similar convergence result by jean - marie mirebeau & chen da of a related elastica model ( * ? ? ?",
    "* app.a ) .",
    "it relies on closeness of controllable paths ( * ? ? ?",
    "* cor.a.5 ) and arzela - ascoli s theorem .",
    "another ingredient is the continuity of the mapping of the pair @xmath597 onto the corresponding indicatrix @xmath598 , i.e. , the continuity of @xmath599 \\times { \\operatorname{so(3)}\\nolimits}\\ni ( \\varepsilon , g ) \\mapsto \\mathcal{b}_{\\varepsilon}(g ) \\in \\mathcal{p}(t_{g}({\\operatorname{so(3)}\\nolimits})),\\ ] ] where the powerset @xmath600 of each tangent space + @xmath601 is equipped with the metric topology induced by the hausdorff distance .",
    "the proof of this continuity is straightforward and is therefore omitted here .      now in this article , we are primarily interested in the sr geodesics whose spherical projection does not have cusps .",
    "this can be taken into account by modifying the standard sr - eikonal equation  ( [ eq : eikonalsystfull ] ) as @xmath602 and backtracking equation  ( [ eq : backtrackmain ] ) as @xmath603 where @xmath604 , @xmath605 , and where the system is integrated for @xmath606 $ ] .",
    "the idea behind this is that for cuspless sr geodesics one has @xmath142 positive which holds by if the corresponding momentum component @xmath607 is positive .",
    "note that in the eikonal equation one substitutes momentum @xmath608 into the hamiltonian to achieve equidistant wavefront propagation @xcite . for further details and analysis on the positive control restriction on a similar problem on @xmath11 ,",
    "see @xcite .",
    "similar analysis benefits may be expected on the @xmath6 case , but this is beyond the scope of this article .",
    "we organize the comparison in the following way :    \\1 ) choose an initial condition @xmath609 and a terminal condition @xmath610 in @xmath611 \\times [ y_{min},y_{max } ] \\times [ -\\pi,\\pi ] \\subset \\r^2 \\times s^1 \\cong { \\operatorname{se(2)}\\nolimits},$}}\\ ] ] where @xmath612 @xmath613 @xmath614",
    ". these values are obtained from schematic eye model for @xmath60 , recall sect .",
    "[ subsec : motivation1 ] , where @xmath615 is a maximum scanning angle via a standard fundus cameras .",
    "\\4 ) find the initial condition @xmath622 and the terminal condition @xmath623 in @xmath6 , obtained from @xmath624 and @xmath625 via planar projection @xmath68 , recall eq .",
    "( [ eq : xytoxy ] ) , as @xmath626 and @xmath627 where + @xmath628 \\displaystyle \\dot{\\gothic{y}}(x_i , y_i,\\theta_i ) : = \\frac{\\partial \\phi_2}{\\partial x}|_{(x_i , y_i ) } \\cos\\theta_i + \\frac{\\partial \\phi_2}{\\partial y}|_{(x_i , y_i ) } \\sin\\theta_i . \\end{array } \\right.$ ]      \\6 ) find via backtracking  ( [ eq : backtrackmain ] ) a geodesic @xmath432 satisfying @xmath632 and @xmath633 .",
    "7 ) plot in the image plane both the spatial projection @xmath634 of the geodesic @xmath618 and the planar projection @xmath635 of the geodesic @xmath432 .",
    "bekkers , e. , zhang , j. , duits , r. , ter haar romeny , b. : curvature based biomarkers for diabetic retinopathy via exponential curve fits in se(2 ) . in trucco ,",
    "e. , chen , x. , garvin , m.k . ,",
    "liu , j.j . ,",
    "frank , x.y .",
    ", eds . : proceedings of the ophthalmic medical image analysis second international workshop , omia 2015 , held in conjunction with miccai 2015 , munchen , germany , october 9 , 2015 .",
    "iowa research online ( 2015 ) 113 - 120 .",
    "mashtakov , a.a .",
    "ardentov , y.l .",
    "sachkov , parallel algorithm and software for image inpainting via sub - riemannian minimizers on the group of rototranslations , numer .",
    "theory methods appl .",
    ", vol . 6 , no",
    ". 1 . ( 2013 ) , 95 - 115 .",
    "r.  duits , u.  boscain , f.  rossi and y.  l.  sachkov , association fields via cuspless sub - riemannian geodesics in se(2 ) .",
    "doi 10.1007/s10851 - 013 - 0475-y _ , _ http://bmia.bmt.tue.nl/people/rduits/cusp.pdf _ 49 ( 2 ) , ( 2014 ) , 384417 .",
    "r.  duits , s.  meesters , j.m .",
    "mirebeau and j.portegies , optimal paths for variants of the 2d and 3d reeds - shepp car with applications in image analysis .",
    "preprint on arxiv _ www.arxiv.org/pdf/1612.06137.pdf_ , 2016 .",
    "r.  duits , a.ghosh , t.c.j .",
    "dela haije , y.l .",
    "sachkov , cuspless sub - riemannian geodesics within the euclidean motion group @xmath641 , in neuromathematics of vision , springer series lecture notes in morphogenesis , vol.1 p.173240 , 2014 .",
    "bekkers , e.j . , duits , r , mashtakov , a. and sanguinetti , g.r .",
    "( joint main authors ) .",
    "data - driven sub - riemannian geodesics in @xmath11 , proc .",
    "ssvm 2015 ( eds .",
    "aujol , nikolova , papadakis ) , lncs 9087 , p.613 - 625 , 2015 .    bekkers e.j .",
    ", duits r. , mashtakov a. , sanguinetti , g.r .",
    "( joint main authors ) . a pde approach to data - driven sub - riemannian geodesics in @xmath11 .",
    "siam journal on imaging sciences , 2015 , 8:4 , pp 2740 - 2770 .",
    "g. sanguinetti , r. duits , e. bekkers , m.h.j .",
    "janssen , a. mashtakov , j.m .",
    "sub - riemannian fast marching in se(2 ) . in book : progress in pattern recognition , image analysis , computer vision , and applications .",
    "lecture notes in computer science , volume 9423 , 2015 , pp 366 - 374 .",
    "d.  chen , j .-",
    "mirebeau , l.d .",
    "global minimum for curvature penalized minimal path method . in xianghua xie ,",
    "mark w. jones , and gary k. l. tam , editors , proceedings of the british machine vision conference ( bmvc ) , pages 86.1 - 86.12 .",
    "bmva press , september 2015 ."
  ],
  "abstract_text": [
    "<S> in order to detect salient lines in spherical images , we consider the problem of minimizing the functional @xmath0 for a curve @xmath1 on a sphere with fixed boundary points and directions . the total length @xmath2 is free , @xmath3 denotes the spherical arclength , and @xmath4 denotes the geodesic curvature of  @xmath1 . here the smooth external cost @xmath5 is obtained from spherical data . </S>",
    "<S> we lift this problem to the sub - riemannian ( sr ) problem in lie group @xmath6 and show that the spherical projection of certain sr geodesics provides a solution to our curve optimization problem . </S>",
    "<S> in fact , this holds only for the geodesics whose spherical projection does not exhibit a cusp . </S>",
    "<S> the problem is a spherical extension of a well - known contour perception model , where we extend the model by boscain and rossi to the general case @xmath7 , @xmath8 . for @xmath9 </S>",
    "<S> , we derive sr geodesics and evaluate the first cusp time . </S>",
    "<S> we show that these curves have a simpler expression when they are parameterized by spherical arclength rather than by sub - riemannian arclength . for case @xmath8 ( data - driven sr geodesics ) , we solve via a sr fast marching method . </S>",
    "<S> finally , we show an experiment of vessel tracking in a spherical image of the retina and study the effect of including the spherical geometry in analysis of vessels curvature . </S>"
  ]
}