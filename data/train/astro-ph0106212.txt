{
  "article_text": [
    "time - dependent plasma codes are required for any plasma where equilibrium is not maintained due to a time - dependent physical process . if the relevant physical process operates on a timescale @xmath0 that is shorter than the timescale to reach equilibrium ( of atomic ionization stages , for example ) then the level populations must be followed in a time - dependent manner .",
    "for example , in an ionized gas with temperatures around @xmath1  k the dominant timescale to reach equilibrium of the gas is the hydrogen recombination timescale , @xmath2 here @xmath3 is the recombination coefficient , @xmath4 is the electron temperature , @xmath5 is the electron density , @xmath6 is the electron density in units of @xmath7  @xmath8 , and @xmath9 is the temperature in units of @xmath1 k ( ferland 2000 ) .",
    "there are many examples of timescales shorter than this such as shocks or rapidly varying radiation fields .",
    "some astrophysical examples where time dependent plasma codes are useful are :    @xmath10 the recombination epoch    @xmath10 cooling of the first cosmological objects by h@xmath11    @xmath10 structure formation and evolution in the universe    @xmath10 heating of the intergalactic medium    @xmath10 planetary nebulae and photodissociation regions    @xmath10 the interstellar medium .",
    "time dependence always implies nonequilibrium level populations . in this article",
    "i only consider the optically thin case , where the level population s effects on the radiation field can be ignored or treated in a simple way .    in the second part of this article",
    "i discuss recombination in the early universe in detail as an example of an astrophysical problem whose solution requires a time - dependent plasma code . the time dependence is crucial in this case because the expansion of the universe is much faster than the hydrogen recombination time .",
    "the computational method in its simplest form involves solving one basic set of equations @xmath12 constrained by particle conservation @xmath13 and charge conservation @xmath14    here @xmath15 represents the number density of atoms of species @xmath16 in an ionization stage @xmath17 , @xmath5 is the number density of electrons , and @xmath18 is the total number density of all ions of a species @xmath16 . note that there is one redundant equation for each @xmath16 and one redundant equation for each @xmath17 of a given @xmath16 .",
    "the population and depopulation terms in equation  [ eq : basiceq ] for a given species @xmath16 and ionization stage @xmath17 can be described as follows : @xmath19 @xmath20    here @xmath21 are the rate coefficients : @xmath22 @xmath23 @xmath24 @xmath25 here @xmath26 is the radiation field , @xmath27 is the photoionization cross section , @xmath3 is the recombination coefficient , and @xmath28 is planck s constant .",
    "the equations are coupled among different species by the charge exchange reactions .",
    "not shown in the above set of equations are that the excited states @xmath29 can be followed in the same framework , rather than only considering the ground state of an ionization stage .",
    "this can be time consuming because it involves @xmath29 more equations for each @xmath17 and @xmath16 .",
    "one simplification is to only use the lower levels in the photoionization equations and to use a pre - computed recombination coefficient that takes into account recombination to the upper energy levels of the atom .",
    "another simplification is to construct several averaged atomic energy levels ( `` superlevels '' ; see lucy 2001 ) in lieu of hundreds of excited upper levels .",
    "this works because the individual excited states ( above the first several n levels ) usually do nt dominate most rates but their collective effects are important .",
    "the rate equations can also be extended to include molecules , in which case the terms @xmath30 and @xmath31 involve reaction rates between different molecular species ( see e.g. , stancil , lepp , & dalgarno 1998 ) .",
    "when nonequilibrium populations are involved one must take into account their effects on the electron temperature .",
    "if the deviations from equilibrium are strong , the temperature may depart from its equilibrium value .",
    "furthermore the time dependence is key .",
    "the radiation field is also affected by the nonequilibrium values although in plasma codes the radiation field is not solved for explicitly .      in a static situation",
    "the temperature is determined by the equilibrium between heating and cooling processes . in the time - dependent case",
    "the heating and cooling processes might not have had time to reach equilibrium and so they must be solved for together with the time - dependent rate equations . in general",
    "one can test whether or not a given heating and cooling process has reached equilibrium by comparing its timescale to the time - dependent process ( shocks , variation of radiation field , wind velocity , etc . ) ; see  [ sec : introrec ] for an example .",
    "the time - dependent kinetic energy equation is @xmath32 where @xmath33 are the energy sources and @xmath34 are the energy sinks : @xmath35 @xmath36 in this example the heating processes considered are photoionization heating and collisional line heating @xmath37 ( the first and second terms in equation  [ eq : theating ] respectively ) while the cooling processes are recombination cooling , collisional line cooling @xmath38 , and bremsstrahlung cooling @xmath39 ( the first , second , and third terms in equation  [ eq : tcooling ] respectively )",
    ". for explicit descriptions of these terms see , e.g. osterbrock ( 1989 ) . while these processes tend to be the most important heating and cooling mechanisms , their relative importance and the importance of other processes depends on the specific situation ( i.e. @xmath40 , density , etc . ) in general it pays to be clever by checking which heating and cooling rates are important in advance . for example ,",
    "heating and cooling processes due to less abundant elements can usually be ignored .",
    "the time dependence means that the temperature ( = @xmath41 ) at a previous time , together with the equations , determines the temperature at the present time .      in time - dependent plasma codes",
    "the radiation field is a key ingredient because it governs the level populations ( ionization stages and atomic levels ) and temperature .",
    "it is not the goal of plasma codes to solve for the radiation field , rather it is considered a given parameter in an optically thin situation .",
    "the detailed solution of the radiative transfer problem is a much more complex , difficult , and different class of problem .",
    "still , small changes to the radiation field can be considered .",
    "for example , in a plasma with a central radiation source ( e.g. an hii region ) the radiation field can be written @xmath42 where the first term on the right side is the radiation field from the central source modified by absorption , and the second term is the diffuse radiation .",
    "here @xmath43 is the radius of the central star and @xmath44 is the radial distance from the star center .",
    "note that in the optically thin case the modification to the radiation field by exponential attenuation can easily be computed . here",
    "the optical depth @xmath45 is simply @xmath46 usually the excited levels @xmath29 above the ground state do not contribute much to the optical depth .",
    "the time - dependent rate equations and the time - dependent temperature equation form a set of coupled first - order nonlinear differential equations .",
    "the equations are first order with respect to the independent variable , time .",
    "the equations are nonlinear because of recombination and collisional terms that involve the interaction of two species , @xmath15 and @xmath5 .",
    "the time - dependent plasma calculation is an initial value problem where the initial values need to be specified and the goal is to determine the number densities and temperature at a later time .",
    "there are two general classes of numerical methods used to solve initial value problems of first - order ordinary differential equations , explicit methods and implicit methods .",
    "consider the rate equations to be of the following form @xmath47 where @xmath48 is the known equation @xmath49 described in  [ sec - rateeq ] in the limit of small timesteps equation  [ eq : fi ] can be rewritten as @xmath50 the new value @xmath51 can be determined with the derivative @xmath48 to propagate the solution , @xmath52 this is known as the explicit method and is also called euler s scheme .",
    "more sophisticated versions of it that use derivatives at other positions , for example , are more useful . for example a popular algorithm is the runge - kutta method .",
    "explicit methods can be unstable for stiff equations  those equations where different @xmath15 are changing on very different timescales .",
    "stiff equations are common in a set of rate equations when some rates ( e.g. a chemical reaction rate or an ionization rate ) are very different from other rates that control relevant number densities . taking a small enough timestep to satisfy the shortest timescale is almost always impractically time consuming . taking",
    "a reasonable timestep can have disastrous consequences ( such as values approaching infinity or oscillating values ) for species that evolve on the timescale(s ) much shorter than this reasonable timestep .",
    "the following typical example illustrates this nicely .",
    "consider the equation @xmath53 the new value of @xmath54 is @xmath55 in the limit of a large timestep , @xmath56 , @xmath57 , an obviously unphysical value and one that certainly does not satisfy the constraint of equation  [ eq : pconsv ] .",
    "implicit methods are commonly recommended to deal with stiff equations .",
    "the form of the equations is the same as equation  [ eq : delta ] but the derivative @xmath58 is evaluated at the new time , @xmath59 for the above example , @xmath51 becomes @xmath60 in this case , for a large timestep @xmath61 , the correct solution to equation  [ eq : eqconsider ] .",
    "implicit methods for a set of nonlinear equations ( as opposed to a single linear equation like equation  [ eq : eqconsider ] ) often involve the jacobian which must be used in an iterative approach to solve for the set of values @xmath62 .",
    "but for the rate equations described in equations  [ eq : basiceq ] through [ eq : chargeexchange ] , the jacobian can be computed analytically in a straightforward way .",
    "there are many numerical methods that implement the forward or backward euler scheme into more sophisticated algorithms .",
    "many textbooks deal with stiff equations ( e.g. press et al . 1992 ; lambert 1973 ) and have detailed discussions about error analysis , adaptive stepsizes , and more .",
    "the time - dependent rate equations and the particle and charge conservation equations mean there is one redundant equation for each @xmath16 and one redundant equation for each @xmath17 for a given species @xmath16 .",
    "a practical approach is to solve for the time - dependent rate equations ( equation  [ eq : basiceq ] ) and use the particle and charge conservation equations ( equations  [ eq : pconsv ] and [ eq : cconsv ] ) as a check to test the accuracy of the solution .",
    "the input parameters for the set of rate equations and the temperature equation are abundances , accurate atomic data ( e.g. atomic energy levels , oscillator strengths , absorption cross sections , rate coefficients , etc . ) , and a good starting solution .",
    "a good starting solution is usually the static solution , which is the same set of equations ( equation  [ eq : basiceq ] with @xmath63 ) .",
    "if there are too many equations for an algebraic solution , the starting solution is best obtained by a newton - raphson type scheme .",
    "the output is the population number densities , @xmath64 , and the electron temperature .",
    "algorithms with adaptive stepsize control and that monitor internal errors are extremely useful .",
    "the errors are used to ensure the solution reaches a specified accuracy . when debugging it is useful to follow the errors ( i.e. write them to a file ) .",
    "if different @xmath15 have the same error this indicates the problem is related to equations that involve those two number densities ( e.g. the derivatives or terms in jacobian ) . in general implicit methods with adaptive stepsize control with a specified accuracy should suffice for a time - dependent plasma code .",
    "three hundred thousand years after the big bang the universe became cool enough for the ions and electrons to form neutral atoms .",
    "this was the recombination epoch .",
    "the universe expanded and cooled faster than recombination could be completed and a small but non - zero fraction of electrons and protons remained .",
    "this is referred to the ionized fraction at freezeout .",
    "recombination in the early universe was first studied by peebles ( 1968 ) , zeldovich et al .",
    "( 1969 ) and others , and the basic framework has remained unchanged since that time . for a complete set of references to both the early papers and more recent papers",
    "see seager et al .",
    "the recombination epoch is a good example of a problem that must be solved by a time - dependent plasma code because the expansion timescale of the universe is shorter than the recombination timescale .",
    "figure 1 shows the difference between a time - dependent calculation ( described later in  [ sec - recombeq ] ) and a time - independent calculation from the saha equilibrium equation .",
    "[ fig : recombbasic ]    here @xmath65 where @xmath5 is the number density of electrons and @xmath66 is the number of total hydrogen nuclei . the ionization fraction is used instead of number density because it gives a clearer picture of recombination ; expansion of the universe changes the volume and hence number densities and the total number density depends on the cosmological model .",
    "similarly , redshift ( @xmath67 ) is used instead of time because it is independent of the cosmological model .",
    "redshift is the doppler shift of light from a receding source : @xmath68 ( for low redshifts ) , where @xmath69 is the recessional velocity , @xmath44 is the distance , and @xmath70 is hubble s constant .",
    "redshift and time are related by @xmath71 where @xmath72 is the hubble parameter , which depends on several cosmological parameters . for a flat @xmath73 universe ,",
    "this relation is @xmath74 -0.11 cm but is more complicated for other cosmologies ( see , e.g. , peebles 1993 ) .",
    "basically redshift is a convenient parameter because it can be measured directly and the ignorance of cosmological parameters is hidden in usage of redshift instead of time .",
    "the radiation temperature from adiabatic cooling is @xmath75 , where @xmath76 ( fixsen et al .",
    "1996 ) . to illustrate the density - temperature parameter space of recombination ,",
    "figure  2 shows the electron density as a function of redshift and of radiation temperature for the same ionization history and cosmological model shown in figure  1 .",
    "[ fig : recombnoratio ]    [ fig : cmb ]    a recent motiviation to revisit the early universe recombination calculation is that the ionization fraction history ( shown in figure  1 ) is a basic determinant of the cosmic microwave background ( cmb ) spatial anisotropies which will be measured to the 1% level with the map satellite after its launch in june 2001 and later with the planck satellite .",
    "figure  3 shows the angular power spectrum of cmb anisotropies , where the @xmath77s are squares of the amplitudes in a spherical harmonic decomposition of anisotropies on the sky .",
    "they represent the power and angular scale of the cmb anisotropies by describing the rms tempeartures at fixed angular separations averaged over the whole sky ( see e.g. , white , scott , & silk 1994 ) .",
    "these temperature differences of the cmb at fixed angular scales on the sky correspond to the `` seeds '' from which galaxies and other structures grew .",
    "cosmological parameters ( such as @xmath78 , @xmath79 , @xmath28 , etc . ) can be determined from fits ( notably the relative heights and positions of the peaks ) to the power spectrum .",
    "it is instructive to ask : when did the universe become neutral ? as a simple guess one might think that recombination occurred when the cmb radiation peak had just cooled to @xmath80  ev , the binding energy of the ground state of h. this corresponds to a temperature of 56,000  k , which translates to a redshift of approximately 20,000 , and a time after the big bang of roughly 3300 years .",
    "a better guess would consider that there are many , many more photons than baryons ( the ratio is @xmath8110@xmath82 ) in the universe .",
    "this gives a temperature of @xmath817000  k or a redshift of @xmath812500 which corresponds to a universe age of approximately 75,000 years .",
    "however , due to the short collisional timescale between h atoms ( see figure  4 ) the atomic structure of h is important , and the time of recombination is controlled by the plasma temperature . therefore the most reasonable estimate comes from the saha equilibrium equation , @xmath83 at the point where some fraction ",
    "say 99%of the atoms have become neutral .",
    "the temperature at which this occurs is about 3000  k , which corresponds to a redshift of approximately 1000 and a time of approximately 300,000 years after the big bang . in this equation the @xmath84s are partition functions , @xmath85 is the electron mass , @xmath86 is boltzmann s constant , and the other constants are as previously defined .",
    "it is also useful to consider different timescales that are relevant during the recombination epoch , shown in figure  4 . in general",
    "the relevant timescales determine whether or not a time - dependent calculation is even necessary .",
    "the most important point in this example is that the expansion timescale ( @xmath87 ) becomes shorter than the recombination timescale early on , meaning that a time - dependent treatment is crucial . also , the recombination timescale is shorter than the saha equilibrium timescale ( @xmath88 ) , meaning that saha equilibrium is not valid .",
    "the hydrogen atom collisional timescale ( @xmath89 ) , the coulomb timescale ( @xmath90 ) , and the proton collision timescale ( @xmath91 ) are all much shorter than the expansion timescale so matter ( electrons , protons , h atoms ) has had plenty of time to relax to a state of thermodynamic equilibrium .",
    "thus we have @xmath92 .",
    "the compton scattering timescale ( @xmath93 ) is faster than the expansion timescale , meaning that the photons and electrons remain at the same temperature throughout recombination . at @xmath94",
    "when @xmath95 the matter ( electrons ) and radiation ( photon ) decouples .",
    "for the equations that describe these timescales see scott ( 1988 ) . from this example",
    "we see that the only equations that need to be followed in a time - dependent manner are rate equations ( to follow the time dependence of recombination ) and the matter temperature .",
    "[ fig : timescales ]      hydrogen recombination involves protons capturing electrons and electrons cascading down to the ground state .",
    "there are many recombinations to and from each energy level and many bound - bound transitions among the energy levels before there is one net recombination to the ground state .",
    "many people oppose the use of the term `` recombination '' to describe the very first time in our universe s history that protons and electrons combined to form neutral atoms . there were many ionizations and recombinations for every net recombination , however ,",
    "so the term recombination is still appropriate .",
    "the recombination process was not instantaneous ( it was essentially case b but cf . , seager et al .",
    "2000 ) because of the strong but cool cmb blackbody radiation field .",
    "the electrons , captured into different atomic energy levels , could not cascade instantaneously down to the ground state .",
    "the electrons were impeded because of fast reionizations out of excited states that were due to the huge reservoir of low - energy photons and because of the high optical depth of the lyman lines and the continuum transitions to the ground state .",
    "any lyman line or continuum transition to the ground state emitted a photon with energy in which there were few blackbody photons , and this immediately photoexcited or photoionized a neighboring atom in the ground state .",
    "figure  5 shows a blackbody radiation field with the energy levels of the 13.6  ev transition and the lyman  @xmath96 transition where there are few blackbody photons .",
    "atoms reached the    [ fig : bb ]    ground state either by the 2s1s two - photon process or through the cosmological redshifting of the ly@xmath96 line photons .",
    "the cosmological redshifting occurs because as space expands the frequency of the photons changes  possibly enough to be redshifted out of interaction frequency with the lyman @xmath96 line . because both of the rates from n=2 to the ground state ( the 2s1s two - photon process and the cosmological redshifting ) were much slower than the net recombination rate to n=2 , a `` bottleneck '' occurred that slowed down the entire recombination process .",
    "recombination in the early universe can be computed using the formalism described in  [ sec - maineq ]      we are interested in the time evolution of the h n - level populations , in addition to protons ( ionized h ) and electrons .",
    "we have one time - dependent rate equation for each atomic energy level of h , @xmath97 + 3 n_j(z),\\ ] ] and also equations for the proton number density ( @xmath98 ) and electron number density ( but if only h is being considered @xmath99 so only one equation need be followed ) . here",
    "@xmath100 is the net bound - bound rate between bound states @xmath17 and @xmath29 , and the @xmath101 are the rate coefficients between bound levels @xmath29 and the continuum @xmath102 : @xmath103 and @xmath104 , where @xmath43 refers to radiative rates and @xmath105 to collisional rates .",
    "here the @xmath106s are physical ( as opposed to comoving ) number densities : @xmath107 refers to the number density of the @xmath29th excited atomic state , @xmath108 to the number density of electrons , and @xmath109 to the number density of a continuum particle ( i.e. proton in this case ) .",
    "for convenience we use redshift @xmath67 instead of time ( see equation  [ eq : redshifttime ] and the accompanying discussion ) .",
    "@xmath72 is the hubble factor and the extra term @xmath110 comes from the fact that space is expanding . for a 300-level h atom  where the number of n levels needed is determined by a thermal broadening cutoff ",
    "there are 300 such equations and together they involve hundreds of bound - free transitions and thousands of bound - bound transitions .",
    "the number of n levels that should be considered depends on the thermal broadening cutoff .",
    "we do not consider individual @xmath111 states ( with the exception of 2s and 2p ) , but assume the @xmath111 sublevels have populations proportional to ( 2@xmath111 + 1 ) .",
    "the @xmath111 sublevels only deviate from this distribution in extreme nonequilibrium conditions ( such as planetary nebulae ) .",
    "dellantonio & rybicki ( 1993 ) looked for such @xmath111 level deviations for n@xmath112 and found none . for n@xmath113 ,",
    "the @xmath111 states are even less likely to differ from an equilibrium distribution , because the energy gaps between the @xmath111 sublevels are increasingly smaller as n increases .",
    "however the @xmath111-level time evolution could easily be included in the plasma code but would be consume an unreasonable amout of computer time .    the photoionization equation , @xmath114 and the recombination equation , @xmath115 are the familiar ones , but note the separate consideration of @xmath116 and @xmath117 . here",
    "@xmath102 is the speed of light , @xmath118 is the statistical weight , @xmath119 is the ionization energy and the other constants and variables have their usual meanings .",
    "here we have replaced the usual @xmath120 ( see the below discussion on the radiation field ) because @xmath117 is a function of @xmath67 and hence @xmath0 .",
    "collisional rates are much smaller than radiative rates ( due to the large reservoir of photons ) ,",
    "so while they are usually important for a plasma of this temperature and density , they can actually be ignored in the early universe recombination calculation .",
    "every time a situation involves nonequilibrium level populations or ionization stage populations  and time - dependent cases are no exception  one must consider the effects of nonequilibrium populations on the temperature and on the radiation field .",
    "the radiation temperature during recombination is determined from adiabatic cooling of radiation , @xmath121 , where @xmath122 is today s temperature of the cmb determined from cobe measurements ( fixsen et al .",
    "the time - dependent matter temperature equation for recombination in the early universe is @xmath123 where @xmath124 is the thomson scattering cross section and @xmath125 is the energy density .",
    "the first term on the right side is compton cooling and the second term comes from adiabatic cooling of an ideal gas .",
    "other heating and cooling terms such as ionization heating , bremsstrahlung cooling , and others mentioned in  [ sec - tempeqn ]",
    "are negligible and need not be considered . in general",
    "one can determine in advance of a calculation whether or not different heating or cooling terms are important from comparing timescales .",
    "for example in this case the compton cooling timescale becomes longer than the expansion timescale at @xmath94 ( see figure  4 ) and including compton cooling in the time - dependent matter temperature equation keeps track of when @xmath116 and @xmath117 differ",
    ". judging from figure  4 it is not necessary to include the evolution of the matter temperature for a first order calculation , since it has little effect at @xmath126 .",
    "nonetheless , the @xmath116 and @xmath117 difference is significant enough to affect the ionization fraction at freezeout by a few percent at low @xmath67 .      the time - dependent radiation field is @xmath127,\\ ] ] where @xmath128 is the emission coefficient and",
    "@xmath129 is the absorption coefficient .",
    "it would be extremely difficult and time consuming to solve this time - dependent radiative transfer equation at each redshift for many frequencies . during the recombination epoch",
    "the background radiation field was very smooth ; it is generally a blackbody radiation field and today the cmb is a blackbody as measured by cobe .",
    "furthermore the blackbody thermal spectrum is preserved in the expansion of the universe ; the time - dependent radiation field is simply a blackbody radiation field determined by @xmath130 .",
    "this means that instead of solving equation  [ eq : radfield ] we can just use the blackbody intensity .",
    "however , the extreme trapping of lyman line photons means there are significant distortions to the blackbody radiation field . in this case",
    "we can treat these distortions by the sobolev escape probability  this is a solution of the radiative transfer equation in the presence of moving media , which in this case is the expanding universe .",
    "this approach was first used by dellantonio and rybicki ( 1993 ) and makes the recombination in the early universe problem tractable .",
    "the term @xmath131 will depend on the escape probability from sobolev theory for transitions where it is appropriate ( the lyman lines ) .",
    "a natural starting solution to the recombination in the early universe problem is at high redshift ( i.e. early times and high @xmath40 ) where all the hydrogen is ionized and the starting solution is @xmath132 and @xmath133 .",
    "because not exactly all of the hydrogen is ionized at @xmath134 it is better to instead use the solution of the static rate equations using a newton - raphson scheme with the input to that as @xmath132 and @xmath133 .    when using an integration algorithm with a specified accuracy it helps to not include the errors of very small level populations in the consideration of the size of the next timestep .",
    "i use the requirement to ignore the errors if @xmath135 because populations that small are not relevant to the calculation anyway , but they are still important enough at other times to keep their number densities in the system of rate equations .",
    "otherwise the accuracy requirements are too stringent and the integration will approach a very tiny stepsize and a very long computational time .",
    "the `` standard '' methodology forgoes the detailed numerical computation described in  [ sec - recombeq ] and considers an `` effective three - level atom '' with a ground state , first excited state ( n=2 ) , and continuum , with the n @xmath136 2 states represented by a recombination coefficient .",
    "a single ordinary differential equation can then be derived from the rate equations shown in equation  [ eq : recleveleqn ] to describe the ionization fraction ( see peebles 1968 , 1993 ; seager et al . 1999 ) .",
    "many assumptions go into this derivation , including the following : that h excited states are in equilibrium with the radiation ; that stimulated de - excitation is negligible for the ly@xmath96 transition ; that a simple recombination coefficient can be used ; that every net recombination results in a ground - state atom , so that the ground - state number density @xmath137 ; that the ly@xmath96 redshifting can be dealt with using a simple escape probablility ; that collisional processes are negligible ; and that he can be ignored",
    ". only the assumption that the upper levels of the h atom are in equilibrium with the radiation is not valid .",
    "this is described in the subsection below .",
    "see peebles ( 1968 ) or seager et al .",
    "( 1999 ) for the single ordinary differential equation that describes the ionization fraction history .",
    "figure 6 shows the recombination history for the `` modern '' detailed numerical computation compared to the standard , single ordinary differential equation calculation .",
    "the modern , more detailed calculation has a faster recombination rate which results in a 10% smaller ionization fraction at freezeout compared to the standard calculation .",
    "this in turn has an effect on the cmb power spectrum of anisotropies of a few percent .",
    "note that the cosmological parameters ( and other second order effects ) determine the shape of the power spectrum , and to derive them accurately the recombination history must be known to high accuracy .",
    "[ fig : xeoldnew ]    in the standard case that assumes equilibrium among the excited states n @xmath136 2 the net bound - bound rates are by definition zero , and this is an implicit assumption in deriving the single ordinary differential equation used in the standard calculation . we find that at @xmath138 , the net bound - bound rates become different from zero because , at low temperatures , the cool blackbody radiation field means that there are few photons for photoexcitation of high - energy transtions ( e.g. 7010 , 504 , etc . ) .",
    "this is shown in figure  5 where the vertical lines show the wavelengths of various h atomic transitions , the solid line is the blackbody intensity near the beginning of recombination , and the dashed line is the blackbody intensity towards the end of recombination . because there are few available photons for the high - energy transitions , spontaneous de - excitation dominates those bound - bound transitions , causing a faster downward cascade to the n=2 state . in other words , once an electron is captured at , say , n=70 , it can cascade down to the n=2 state faster than in the equilibrium case because few photons are around to photoexcite it .",
    "in addition , the faster downward cascade rate is faster than the photoionization rate from the upper state , and one might view this as radiative decay stealing some of the depopulation `` flux '' from photoionization .",
    "both the faster downward cascade and the lower photoionization rate contribute to the faster net recombination rate .      with larger ionization potentials , heii and hei",
    "recombined before h. they can be included in the same system of equations in the same framework that has been described in this article .",
    "these are less important for the calculation of the cmb anisotropies , so have generally been paid less scrutiny than h recombination .",
    "see seager et al .",
    "( 1999 ) and seager et al .",
    "( 2000 ) for a detailed description of he recombination .",
    "time dependence in plasma codes is straightforward to implement if one already understands the set of static nonequilibrium rate equations .",
    "the same equations that are used in static nonequilibrium plasma codes can be used in an integration scheme to follow the time evolution of the number densities .",
    "the temperature equation , with heating and cooling processes should also be evolved with time if the relevant heating and cooling processes operate on a timescale longer than the physical process that motivates time dependence in the first place . an implicit method or other method to treat stiff equations ",
    "equations with number densities that are changing on very different timescales  is usually necessary .",
    "numerical algorithms with adaptive stepsize control and that monitor errors are helpful .",
    "there can be high gain for this relatively straightforward method .",
    "i would like to thank gary ferland and the conference organizing committee for a very interesting and useful conference .",
    "i would also like to thank dimitar sasselov and douglas scott for useful contributions and to acknowledge support from the w.m .",
    "keck foundation ."
  ],
  "abstract_text": [
    "<S> time - dependent plasma codes are a natural extension of static nonequilibrium plasma codes . comparing relevant timescales will determine whether or not time - dependent treatment is necessary . </S>",
    "<S> in this article i outline the ingredients for a time - dependent plasma code in a homogeneous medium and discuss the computational method . in the second half of the article </S>",
    "<S> i describe recombination in the early universe as a detailed example of a problem whose solution requires a time - dependent plasma code .    </S>",
    "<S> # 1_#1 _ # 1_#1 _ =    # 1 1.25 in .125 in .25 in </S>"
  ]
}