{
  "article_text": [
    "the major steps of the process of mathematical modeling comprise model discrimination , i.e.  identification of an appropriate model structure , model calibration , i.e.  estimation of unknown model parameters , as well as prediction and model validation .",
    "for all these topics it is essential to have appropriate methods assessing the certainty or ambiguity of any result for given experimental information .    for parameter estimation ,",
    "there are several approaches to derive confidence intervals , like standard intervals which are based on an estimate of the covariance matrix of the parameter estimates @xcite , bootstrap based confidence intervals @xcite , as well as likelihood based confidence intervals @xcite . for model discrimination , significance statements can be obtained by statistical tests . however , for model predictions , there are still demands for methodology that is applicable for mathematical models like odes used to describe the dynamics of a system in a variety of scientific fields e.g.  in molecular biology @xcite , but also in medical research , chemistry , engineering , and physics .",
    "the mere estimation of parameters is often not the final aim of an investigation .",
    "more frequently , it is desired to utilize the parametrized model to generate model predictions such as the dynamic behavior of unobserved components .",
    "classically , the uncertainty in the model parameters is attempted to be translated into corresponding prediction confidence intervals . for models that depend linearly on the model parameters , as it occurs in classical regression models ,",
    "this is well studied and known as propagation of uncertainty based on standard errors .",
    "this approach is appropriate and sufficient for many applications .",
    "however , e.g.  for biochemical networks , the model responses depend nonlinearly on the model parameters . here",
    ", the boundaries of the parameter confidence region can exhibit arbitrarily complex shape and are usually difficult to translate into boundaries for the prediction confidence intervals .",
    "therefore , established approaches aim to scan the entire parameter subspace which is in a sufficient agreement with the experimental data to propagate the parameters confidence regions into confidence intervals for the model predictions .",
    "the major challenge is the complex nonlinear interrelation between parameters and model responses which requires that the parameter space has to be densely sampled to capture all scenarios of model predictions . for models with tens to hundreds of parameters this is numerically demanding or even infeasible because high dimensional spaces can not be densely sampled .",
    "this is issue often referred to the curse of dimensionality in literature @xcite .",
    "there are several methods for an approximate sampling of the parameter space , e.g.  the markov chain monte carlo ( mcmc ) methods @xcite , and bootstrap based approaches @xcite .",
    "however , for the ode models used to describe interaction networks , these methods are numerically very demanding and provide only very rough approximations .",
    "therefore , it is difficult to control the coverage of the prediction confidence intervals for these approaches",
    ". moreover non - identifiable parameters are not explicitly considered hampering the convergence of these sampling techniques and yielding results that are questionable and difficult to interpret @xcite .",
    "conceptually related to the prediction profile likelihood approach presented here , @xcite presented an approach for the determination of confidence intervals for the model parameters by sampling the parameter profile likelihood . for their approach",
    "the problems concerning identifiability are resolved and the computation is feasible also for high - dimensional parameter spaces .",
    "nevertheless , the direct translation to confidence intervals of the model trajectories only works as an approximation yielding a coverage rate that is sometimes lower than desired .",
    "the idea of the prediction profile likelihood presented here is to determine prediction confidence without an explicit sampling strategy for the parameter space . instead",
    ", a certain fixed value for a prediction is used as a nonlinear constraint and the parameter values are chosen via constraint optimization of the likelihood .",
    "this does neither require a unique solution in terms of identifiability nor confidence intervals for the parameter estimates .",
    "the constraint maximum likelihood approach checks the agreement of a predicted value with the experimental data . by repeating this procedure for continuous variations of the predicted value , a _ prediction profile - likelihood _",
    "is obtained .",
    "thresholding the prediction profile likelihood yields statistically accurate confidence intervals .",
    "the desired level of confidence which coincides with the level of agreement with the experiments is controlled by the threshold .",
    "the theoretical background of the prediction profile likelihood , also called _ predictive likelihood _ has been already studied @xcite .",
    "moreover , related ideas are already applied in the context of generalized linear mixed models @xcite , unobserved data points @xcite .",
    "the linear approximation has been applied in nonlinear regression analyses @xcite .",
    "a review of prediction profile likelihood approaches and a modification to sufficiency - based predictive likelihood is provided in @xcite .    in this paper , this concept is applied to ode models occurring in mechanistic dynamic models , e.g.  in molecular and systems biology . in this context",
    "the approach allows a data - based observability analysis .",
    "moreover , it is extended to obtain confidence intervals for validation experiments .",
    "first , a small but illustrative model of two consecutive reactions @xmath0 with rates @xmath1 and initial conditions @xmath2 is utilized to illustrate our approach . for this purpose",
    ", it is assumed that @xmath3 is measured at @xmath4 .    for the simulated measurements ,",
    "gaussian noise @xmath5 with @xmath6 has been assumed which corresponds to a typical signal - to - noise ratio for applications in cell biology of around @xmath7 . if an experimental setup would not allow for negative measurements , a log - normal distribution of the observational noise could be more appropriate .",
    "then , the gaussian setting is obtained after a log - transformation of the data @xcite . such transformations and preprocessing procedures",
    "would have to be performed before the analysis starts .",
    "panel ( a ) in fig .",
    "[ fig : cons ] shows the dynamics of @xmath8 , @xmath9 , and @xmath3 as well as a typical noise realization .",
    "such simulated data realizations are utilized to calculate the prediction- and validation profile likelihood for the dynamic states .",
    "panel ( b ) shows , as an example , the prediction profile likelihood and the validation profile likelihood for the same noise realization for predicting @xmath8 at time point @xmath10 .",
    "the validation profile likelihood has been calculated for validation data with 10% measurement noise , as it was assumed for the measurements the vertical axis is minus two times the log - likelihood which corresponds to the residual sum of squares . for illustration purposes ,",
    "the minimum of the log - likelihood @xmath11 is shifted to zero in all figures .",
    "three thresholds corresponding to 68% , 90% , and 99% confidence levels are plotted as horizontal lines . as explained in the section ` materials and methods ' , the projections to the horizontal axis yields the respective confidence intervals for a prediction or for a validation experiment .",
    "the constraint optimization procedure is infeasible for @xmath12 and therefore the pcis automatically account for strictly positive values of @xmath13 .    the calculation of the prediction and validation confidence intervals has been repeated for @xmath4 and all three dynamic states @xmath8 , @xmath9 , @xmath3 . in panels ( c)-(e ) , the respective prediction confidence intervals ( pcis ) are plotted as well as the prediction profile likelihood .",
    "the corresponding validation profile likelihood functions and the respective validation confidence intervals are shown in the supplemental information ( si ) .",
    "for plotting the confidence intervals along the time axis , the @xmath14 evaluated the eleven time points have been interconnected by cubic piecewise interpolation .",
    "the displayed confidence intervals constitute the propagation of information from the measurements of @xmath3 to predictions of the dynamics of the compound concentrations . because @xmath15 is the measured compound in our example , the prediction confidence intervals for @xmath15 are much smaller than for @xmath13 and @xmath16",
    ". however , also @xmath13 and @xmath16 yield bounded prediction confidence intervals which can be interpreted as _",
    "observability _ of these dynamic states .    in the appendix ,",
    "the reliability of our confidence intervals is investigated by calculating the coverage , i.e.  by comparing the confidence level with the frequency that the true value is inside the prediction confidence interval . for our example , it will be demonstrated that confidence intervals using the asymptotic threshold sometimes yield slightly conservative intervals .",
    "also an algorithm to improve the threshold is provided which yields slightly smaller confidence intervals with the correct coverage .",
    "to illustrate the effect of _ non - observability _ , the assumption about the available experimental information is slightly changed .",
    "the measurements are simulated for earlier and closer time steps , i.e.  for @xmath17 .",
    "panel ( f ) of fig .",
    "[ fig : cons ] shows that these time points sample only the transient increase of @xmath3 .",
    "hence , such a design does not provide sufficient information about the steady state level of @xmath15 .",
    "in other words , the modification limits the available information about the total amounts of the compounds .",
    "this , in turn , makes @xmath8 and @xmath9 non - observable .",
    "panel ( g ) shows the prediction confidence intervals for @xmath8 . in",
    "the chosen setting , the predictions are unbounded towards infinity and therefore @xmath8 is non - observable . in panel",
    "( h ) , it is also shown that @xmath9 is non - observable . according to the model definition",
    ", @xmath18 is known to be zero , but for @xmath19 , unbounded prediction confidence intervals are obtained which indicate non - observability of @xmath9 .",
    "next , an ode model of cellular signal transduction has been used to illustrate our method in a realistic setting . for this purpose , a model of the _ mitogen - activated protein ( map ) kinases _ which is one of the most extensively studied signal transduction pathway , is utilized . the chosen model @xcite consists of eight dynamic states describing the time dependency of the map kinases raf , raf@xmath20 , mek , mek@xmath20 , mek@xmath21 , erk , erk@xmath20 , and erk@xmath21 which play a very prominent role in many cellular processes , e.g.  in cell proliferation .",
    "a star ` * ' denotes phosphorylation of the protein which biologically acts as activation .",
    "panel ( a ) in fig .",
    "[ fig : kholo ] provides a summary of the map kinase signaling pathway .",
    "the enzymatic reactions in the ode model are described as michaelis - menten rate equations , i.e.  each reaction is parametrized with a maximal enzymatic rate and a michaelis constant . as in the original publication ,",
    "the parameters of the two consecutive phosphorylation and dephosphorylation steps of mek and erk are assumed to be identical and the initial concentrations are assumed to be known . in this",
    "setting , 14 parameters are estimated out of three times eleven data points",
    ". details about the model are provided in the appendix .",
    "it is assumed that the total amount of the phosphorylated forms for each protein , i.e.  raf@xmath22 , the sum of mek@xmath22 and mek@xmath21 as well as the sum of erk@xmath22 and erk@xmath21 , are measured .",
    "this observational assumption holds for example for phospho - specific antibodies such as utilized for western blotting .",
    "the measurement times are set to @xmath23 seconds .",
    "again , additive gaussian noise is assumed .",
    "the standard deviation has been set to @xmath24 nm .    in panel ( b ) of fig .",
    "[ fig : kholo ] a typical noise realization is displayed .",
    "panel ( c ) shows the prediction confidence intervals ( dark gray ) and the validation confidence intervals ( light gray ) for this noise realization calculated for all dynamic states .",
    "the size of the confidence intervals is plotted as a dashed - dotted line .",
    "the prediction confidence intervals show how precisely the dynamics is inferred by the available data .",
    "the temporal behavior of raf , raf@xmath20 is quite well determined , i.e.  the size of the pci is below 40 nm .",
    "similarly , the unphosphorylated states of mek and erk have narrow prediction confidence intervals .",
    "for mek@xmath20 the concentration dynamics is only predicted within rather large intervals which for most time points nearly span a range between zero and 100 nm .",
    "the largest absolute size of the prediction confidence interval of 176 nm is obtained for erk@xmath21 after 181 seconds .",
    "this is the point in time where the negative feedback is activated .",
    "additional experimental investigation of this condition is very informative to further specify the dynamic behavior of the map kinase cascade in our example .",
    "further considerations concerning experimental planning are provided in detail in the appendix .",
    "existing approaches for prediction confidence intervals like mcmc @xcite or bootstrap procedures are based on forward evaluations of the model for many parameter values .",
    "this works reasonably well for a low dimensional parameter space and if the target density function , i.e.  the parameter space to be sampled , is well - behaved @xcite .",
    "however , sampling nonlinear high - dimensional spaces densely is impractical and it is almost impossible to ensure that sampling the parameter space covers all prediction scenarios . especially in biological applications the target distributions frequently inherit strong and nonlinear functional relations . in the case of non - identifiability",
    ", the parameter space to be sampled is not restricted rendering convergence near to impossible .    in this paper",
    ", we applied a contrary procedure .",
    "the model prediction space is sampled directly and the corresponding model parameters are determined by constraint maximum likelihood to check the agreement of the predictions with the data .",
    "this concept yields the prediction profile likelihood which constitutes the propagation of uncertainty from experimental data to predictions .",
    "if a comprehensive prior , i.e.  for all parameters , would be available , a bayesian procedure like mcmc where marginalization , i.e.  integration over the nuisance dimensions is feasible could have superior performance .",
    "however , in cell biology applications , prior knowledge is very restricted because kinetic rates and concentrations are highly dependent on the cell type and biological context , e.g.  on the cellular environment and biochemical state of a cell .",
    "therefore , there is usually at most some prior information for few parameters available .",
    "such prior information can be incorporated in our procedure without restricting its applicability by generalizing maximum likelihood estimation to maximum a - posterior estimation as discussed in the appendix .",
    "in general , generating prediction confidence intervals given the uncertainty in the high - dimensional nonlinear parameter space requires large numerical efforts .",
    "however , this complication primarily originates from the complexity of the issue itself rather than from the methodological choice .",
    "in fact , the aim is approached by the prediction profile likelihood in a very efficient manner because scanning the parameter space by the constrained optimization procedure to explore the data - consistent predictions is more efficient than sampling parameter space without considering the predictions like it is performed for mcmc . instead of sampling a high - dimensional parameters space",
    ", only the prediction space has to be explored for calculating a prediction profile likelihood , i.e.  the optimization of the parameters reduces the high - dimensional sampling problem to exploring a single dimension . for the parameter profile likelihood",
    ", it has been demonstrated @xcite that the computational effort only scales slightly super - linear with the number of parameters .",
    "this result does , due to the similarity of the computations , carry over to the prediction profile likelihood .",
    "the prediction confidence regions introduced above has to be interpreted _ point - wise_. this means that a confidence level @xmath25 controls errors of type 1 which is the probability that the model response for the true parameters is inside the prediction confidence interval for a single prediction condition if many realizations of the experimental data and the corresponding prediction confidence intervals are considered .",
    "in contrast , if a single data set is utilized to generate many prediction intervals , e.g.  predictions for several points in time as performed above , the results are _ statistically dependent _",
    ", i.e.  the realization of the @xmath26 of a neighboring time point is very similar and therefore correlated .",
    "therefore , the prediction confidence intervals for a compound for two adjacent points in time very likely both contain the true value , or neither .",
    "in such an example , a _ common _",
    "prediction confidence region for two statistically dependent predictions would require a two - dimensional prediction profile likelihood .",
    "this topic , however , is beyond the scope of this article .",
    "the prediction profile likelihood also provides a concept for experimental planning .",
    "experimental conditions with a very narrow prediction confidence interval are very accurately specified by the available data .",
    "new measurements for such a condition on the one hand does not provide very much additional information to better calibrate the model parameters , and hence is from this point of view a bad choice for additional measurements . on the other hand , it very precisely predicts the model behavior under these certain conditions and is therefore a very powerful candidate setting for validating the model structure .",
    "contrarily , large prediction confidence intervals indicate conditions which are weakly specified by the existing data and therefore constitute informative experimental designs for better calibrating the model . because a design optimization on the basis of the prediction profile likelihood does not require any linearity approximation like common experimental design techniques , e.g.  based on the _ fisher information _ @xcite",
    ", the presented procedure could be very valuable for ode models which are typically highly nonlinear .",
    "another potential of the prediction profile likelihood shown in this article is its interpretation in terms of _",
    "observability_. this term is very commonly used in control theory to characterize whether the dynamics of some unobserved variables can be inferred by the set of feasible experiments .",
    "the theory in this field is based on analytical calculations , i.e.  the limited amount and inaccuracy of the data is usually not considered . in this article",
    ", it has been shown that the prediction profile likelihood allows for a general data - based approach to check whether there is enough information about unobserved dynamic states in the given experimental design and realization of measurements .",
    "therefore , in analogy to the terminology of _ practical identifiability _",
    "@xcite , we would suggest to term observability for a given data set , i.e.  a restricted prediction confidence interval , as _",
    "practical observability_.    finally , it should be noted , that a prediction could be any function of the compounds and the parameters . in applications ,",
    "e.g.  a ratio of two compound concentrations is a characteristics of interest . in principle",
    "also integrals , peak positions and other functions of the dynamic states can be considered as predictions which could be targets for observability considerations as well as for the calculation of prediction and validation confidence intervals .",
    "generating model predictions is a major task in mathematical modeling . for the dynamic mechanistic models as they are applied e.g.  in molecular and systems biology",
    ", the confidence regions from parameter estimation can have arbitrarily complex shapes .",
    "therefore , it is very difficult or even impossible to sample the parameter space appropriately to generate confidence intervals for predictions",
    ". this in turn impedes a data - based observability analysis for the dynamic states .    in this article ,",
    "the prediction profile likelihood approach is presented as a methodology which directly calculates the set of model predictions which are consistent with existing measurements .",
    "this concept constitutes a powerful tool for assessing model predictions , performing observability analyses , and experimental design .",
    "the method is feasible for arbitrary dimensions of the parameter space .",
    "it only requires a proper calculation of the maximum likelihood value , i.e.  a numerically working parameter optimization procedure . the task of sampling a high - dimensional parameter space reduces to scanning a one - dimensional prediction space .",
    "it therefore allows the calculation of confidence intervals for model predictions as well as confidence intervals for the outcome of validation experiments .",
    "the applicability of the approach has been shown by a small but instructive system of two consecutive reactions and a published model for map kinase signaling .",
    "for the small system , it has been shown that the prediction profile likelihood yields desired coverage properties . moreover , a setting inducing non - observability has been investigated which is characterized by unbounded prediction confidence intervals . for the map kinase model , prediction confidence intervals and validation confidence intervals for all dynamic states",
    "have been determined on the basis of measurements of the phosphorylated proteins .",
    "in addition , the applicability of the approach for experimental planning has been demonstrated .",
    "for additive gaussian noise @xmath5 with known variance @xmath27 , two times the negative log - likelihood @xmath28 of the data @xmath29 for the parameters @xmath30 is except a constant offset identical to the residual sum of squares @xmath31 . in this case ,",
    "maximum likelihood estimation is equivalent to standard least - squares estimation @xmath32 i.e.  to minimizing the residual sum of squares . @xmath33 denotes the model response which is in our case given after integration of a system of differential equations @xmath34 with an externally controlled input function @xmath35 and a mapping to experimentally observable quantities @xmath36 the parameter vector @xmath30 comprises the kinetic parameters as well as the initial values , and additional offset or scaling parameters for the observations .",
    "+ it has been shown @xcite that the profile likelihood @xmath37 for a parameter @xmath38 given a data set @xmath29 yields reliable confidence intervals @xmath39 for the estimation of a single parameter . here , @xmath25 is the confidence level and @xmath40 denotes the @xmath25 quantile of the chi - square distribution with one degree of freedom which is given by the respective inverse cumulative density function .",
    "@xmath11 is the maximum of the log - likelihood function after all parameters are optimized .",
    "in [ [ eq : pl ] ] , the optimization is performed for all parameters except @xmath38 .",
    "the analogy of likelihood - based parameter and prediction confidence intervals is discussed in the appendix . + the desired coverage @xmath41 i.e.  the probability that the true parameter value is inside the confidence interval , holds for [ [ eq : ci ] ] if the magnitude of the decrease of the residual sum of squares by fitting of @xmath38 is @xmath42 distributed .",
    "this is given asymptotically as well as for linear parameters and is a good approximation under weak assumptions @xcite .",
    "if the assumptions are violated , the distribution of the magnitude of the decrease has to be generated empirically , i.e.  by monte - carlo simulations , as discussed in the appendix .",
    "+ the _ experimental design _",
    "@xmath43 comprises all environmental conditions which can be controlled by the experimenter like the measurement times @xmath44 , the observables @xmath45 , and the input functions @xmath35 .",
    "a _ prediction _",
    "@xmath46 is the response of the model @xmath47 for a prediction condition @xmath48 specifying a prediction observable @xmath49 evaluated at time point @xmath50 given the externally controlled stimulation @xmath51 .",
    "+ in some cases the observable @xmath49 corresponds to measuring a dynamic variable @xmath52 directly , i.e.  it corresponds to a compound whose concentration dynamics is modeled by the odes . in a more general setting the observable is defined by an observational function @xmath53 depending on several dynamic variables @xmath54 .",
    "therefore , @xmath49 does neither have to coincide with a dynamic variable nor with an observational function @xmath45 of the measurements performed to build the model .",
    "+ in analogy to [ @xmath55 , the desired property of a prediction confidence interval @xmath56 derived from an experimental data set y with a given significance level @xmath25 is that the probability @xmath57 that the true value of @xmath58 is inside the prediction confidence interval @xmath59 is equal to @xmath25 . in other words",
    ", the @xmath26 covers the model response for the true parameters with a proportion @xmath25 of the noise realizations which would yield different data sets @xmath29 .",
    "+ the prediction profile likelihood @xmath60 is obtained by maximization over the model parameters satisfying the constraint that the model response @xmath61 after fitting is equals to the considered value @xmath62 for the prediction .",
    "the prediction confidence interval is in analogy to [ @xmath63 given by @xmath64 i.e.  the set of predictions @xmath65 for which the @xmath66 is below a threshold given by the @xmath42 distribution . in analogy",
    "to likelihood based confidence intervals for parameters , such pci yields the smallest unbiased confidence intervals for predictions for given coverage @xmath25 @xcite . + instead of sampling a high - dimensional parameter space , the prediction profile likelihood calculation comprises sampling of a one - dimensional prediction space by evaluating several predictions @xmath62 . evaluating the maximum of the likelihood satisfying the prediction constraint does in general not require an unambiguous point in the parameter space as in the case of structural non - identifiabilities . in analogy",
    "to profile likelihood for parameter estimates , the significance level determines the threshold for the @xmath66 , which is given asymptotically by the quantiles [ @xmath63 of the @xmath42 distribution @xcite . in the appendix ,",
    "a monte - carlo algorithm is presented which can be used to calculate the threshold in cases where the asymptotic assumption is violated .",
    "likelihood - based confidence interval like [ @xmath63 or [ @xmath67 correspond to the region where a likelihood ratio test would not reject the model .",
    "having a prediction confidence interval , the question arises whether a model has to be rejected if a validation measurement is outside the predicted interval .",
    "this , in fact , would hold if a `` perfect '' validation measurement would be available , i.e.  a data point without measurement noise . for validation experiments , however , the outcome is always noisy and is therefore expected to be more frequently outside the than the true value .",
    "hence , the prediction confidence interval [ @xmath67 has to be generalized for application to a validation experiment .",
    "+ for a validation experiment , we therefore introduce a _ validation profile likelihood _ @xmath68 and a corresponding _ validation confidence interval _ @xmath69 in the following .",
    "in such a setting , a confidence interval should have a coverage @xmath70 for the validation data point @xmath71 with expectation @xmath72 and variance @xmath73 . here , @xmath74 denotes the design for the validation experiment . a validation confidence interval satisfying [",
    "@xmath75 allows a rejection of the model if a noisy validation measurement with error @xmath76 is outside the interval .",
    "+ @xmath77 for validation data can be calculated by relaxing the constraint [",
    "@xmath78 used to compute the prediction profile likelihood . because in this case , the model prediction does not necessarily have to coincide with the data point @xmath62 . instead",
    ", the deviation from the validation data point is penalized equivalently to the data @xmath29 .",
    "the agreement of the model with the data @xmath29 and the validation measurement @xmath62 is then given by @xmath79      + \\left ( \\frac{z - f(d_{\\text{vali}},\\theta)}{\\text{sd } }   \\right)^2 \\label{eq : llnoisy } \\end{small}\\ ] ] we now define the validation profile ( log-)likelihood @xmath80 with @xmath81 as the maximized joint log - likelihood in [ @xmath82 read as a function of @xmath62 .",
    "the corresponding validation confidence interval is given by @xmath83 + optimization of the likelihood [ @xmath82 minimizes both , the contribution of the data @xmath84 , and the mismatch with the fixed prediction value @xmath62 .",
    "the model response @xmath85 obtained after this parameter optimization can be interpreted as a prediction @xmath86 satisfying the constraint optimization problem [ @xmath78 considered for the prediction profile likelihood .",
    "it holds @xmath87 i.e.  the validation profile likelihood @xmath11 can be scaled to the prediction likelihood via @xmath88 where @xmath89 is the model response for @xmath90 estimated from @xmath62 and @xmath29 .",
    "+ optimization with nonlinear constraints is a numerically challenging issue .",
    "therefore , [ @xmath91 provides a helpful way to omit constraint optimization .",
    "the @xmath68 can be calculated with @xmath92 like a common least - squares minimization and is then afterwards rescaled to obtain the @xmath26 for the true value .",
    "the authors thank our long - term experimental collaboration partners , especially dr .",
    "maria bartolome - rodriguez and prof .",
    "ursula klingmller and their groups for their support and their experience in practically relevant issues .",
    "in addition , the authors acknowledge financial support provided by the bmbf - grants 0315766-virtualliver , 0315415e - lungsys and 0313921-frisys .    .",
    "parameter estimation , i.e.  the prediction of a parameter value out of experimental data , can be seen as a special case of a model prediction . then , the parameter profile likelihood coincides with the prediction profile likelihood and the respective parameter confidence intervals correspond to prediction confidence intervals . in this sense , the prediction profile likelihood generalizes the parameter profile likelihood .",
    "in fact , the idea of the prediction profile likelihood and the calculation of prediction confidence intervals , e.g.  the choice of the threshold , is very intuitive for this special case . in other situations , an analog strategy would require a re - parametrization of the model in a way that the desired model prediction is unambiguously given by the value of a single new parameter .",
    "then , again the profile likelihood for the new parameter would give a confidence interval for the prediction .",
    "in this case , without loss of generality such a parameter can be denoted by @xmath93 .",
    "then , the re - parametrization would be a transformation @xmath94 of the @xmath95 parameters @xmath30 to new parameters @xmath96 where all predictions for the condition @xmath97 satisfy @xmath98 here , @xmath99 denotes the model for the transformed parameters . for a transformation satisfying [ @xmath100 , any change of the parameters @xmath101 would not affect @xmath102 , because @xmath103 is chosen in a way that the effect of @xmath104 is orthogonal to the effects of @xmath105 .",
    "however , because ode systems can only be solved analytically for special cases , such a re - parametrization can not be found explicitly for most realistic models .",
    "this restriction can be resolved numerically by an implicit re - parametrization which is obtained by a constrained nonlinear optimization procedure .",
    "this idea yields the prediction profile likelihood @xmath106 which is obtained by maximization over the model parameters satisfying the constraint that the model response @xmath61 after fitting is equals to the considered value @xmath62 for the prediction . in this case , the ` new parameter ' is the predicted value itself , i.e. @xmath107 and @xmath102 is the identity function",
    ".    equation [ @xmath108 also resolves the formal issue which occurs if there is not a unique parameter set @xmath30 given by the constraint @xmath109 .",
    "if there are several such parameter sets , the ambiguities either vanish by taking the parameter set with maximize the log - likelihood , or they are not relevant because only the value of the maximized log - likelihood enters the calculation .       are utilized to calculate the distribution of @xmath110 .",
    "the @xmath25 quantile of this distribution can be used as a threshold for prediction confidence intervals instead of the asymptotic threshold , i.e.  instead of the @xmath25 quantile of the @xmath42 distribution .",
    "[ fig : checkthreshold ] ]     confidence levels have been plotted for nine different prediction scenarios . in our example , the asymptotic thresholds are slightly too large for predictions of @xmath8 and @xmath9 which makes the asymptotic confidence intervals conservative .",
    "[ fig : thresholdcomparison ] ]    a suitable parameter transformation makes the prediction profile likelihood equivalent to the parameter profile likelihood .",
    "therefore , the following discussion holds for both , for parameter and for prediction confidence intervals .    in general , fitting a model to experimental data reduces the residual sum of squares @xmath111 . in the asymptotic case ,",
    "i.e.  for a large number of data points , it can be shown that the decrease of @xmath111 due to fitting one parameter is chi - square distributed with one degree of freedom .",
    "this result also holds exactly in the non - asymptotic case for linear parameters .",
    "this outcome is utilized to define the asymptotic threshold for profile likelihood confidence intervals @xcite .    for nonlinear parameters ,",
    "the distribution of the decrease of the residual sum of squares by the parameter estimation procedure , has not yet been derived for the general setting . however , since the profile likelihood based confidence intervals are independent on bijective transformations of the parameter space @xcite , the assumption also holds if there is such a transformation , which makes the parameter of interest linear at least within its confidence interval .",
    "such a transformation only has to exist , it is not required to derive it analytically .",
    "a situation where such a transformation does not exist occurs if the nonlinearity yields a non - monotone dependency of the profile likelihood , i.e.  there are several local minima in the confidence interval . in this case",
    ", there is a larger decrease of the residual sum of squares and the standard threshold yields conservative results , i.e.  the calculated confidence intervals are too large for the desired confidence level @xmath25 .    in fig .",
    "[ fig : checkthreshold ] , a procedure is presented for checking the standard threshold .",
    "it is a monte - carlo analysis of the impact of the nonlinear constraint used to calculate the prediction profile likelihood on the magnitude of overfitting . in fig .",
    "[ fig : thresholdcomparison ] , the asymptotic thresholds corresponding to @xmath112 , i.e.  the quantiles of the @xmath42 distribution , are compared with the empirically calculated thresholds for several prediction scenarios . for the model",
    "@xmath113 the asymptotic thresholds are slightly too large for predicting @xmath8 and @xmath9 on the basis of measurements of @xmath3 .",
    "this makes the asymptotic confidence intervals conservative .",
    "the impact on the coverage is discussed in the following section .       which constitutes the desired coverage of the confidence intervals .",
    "the vertical axis is the realized coverage obtained for 100 data realizations .",
    "the red error bars are the result obtained for the asymptotic threshold which yield conservative outcomes for predictions of @xmath8 and @xmath9 .",
    "the black error bars indicate the results for the monte - carlo thresholds which shows almost perfect agreement with the confidence level in all prediction scenarios . [",
    "fig : coverage ] ]    the coverage @xmath114 is the probability that the @xmath115 contains the true value @xmath58 .",
    "a desired property of any confidence interval is that the coverage coincides with the confidence level @xmath25 .",
    "[ fig : coverage ] shows the estimated coverage of the prediction confidence intervals calculated for nine different prediction scenarios . in these scenarios",
    "@xmath116 @xmath117 @xmath118 @xmath119 @xmath120 @xmath121 @xmath122 @xmath123 @xmath124 have been predicted , i.e.  all three dynamic variables are predicted for an early , an intermediate , and a late point in time . for this analysis",
    ", a hundred noise realizations have been analyzed .",
    "the error bars plotted in this figure are bootstrap confidence intervals of the mean coverage .",
    "the coverage obtained for the asymptotic threshold ( red ) tends to be conservative , i.e.  the true model response is inside the confidence interval more frequently as specified by the confidence level @xmath25 .",
    "this means that there are more false negatives than intended which does not constitute a serious problem in terms of validity of conclusions .",
    "in contrast , an anti - conservative coverage would constitute an issue because an increased false positive rate could lead to invalid reasoning .    the coverage obtained by the adjusted thresholds obtained by the monte - carlo algorithm shown in fig .",
    "[ fig : checkthreshold ] are displayed by the black error bars in fig .",
    "[ fig : coverage ] . here , the coverage coincides with the confidence level which confirms the validity respective the prediction profile likelihood based confidence intervals .      .",
    "in this case , the prediction confidence intervals are large ( red shaded ) and the increase of the validation confidence intervals ( gray ) is smaller than indicated by the validation data error @xmath76 . if the data is more informative , i.e.  @xmath125 decreases ( panels b - d ) , the slope of prediction profile likelihood increases yielding larger difference between the @xmath26 and @xmath126 . [",
    "fig : pplvplillu ] ]    the validation profile likelihood satisfies @xmath127 i.e.  the @xmath128 is smaller than the right hand side of the inequality for any alternative predicted value @xmath129 . on the one hand , the inequality can be utilized to interpret a difference between the respective confidence intervals .",
    "furthermore , the equation can be utilized for consistency checks , e.g.  to prove the numerically calculated @xmath68 and @xmath66 .",
    "small differences between the size of the @xmath130 and @xmath26 indicate a flat prediction profile likelihood close to the threshold whereas deviations of the confidence intervals in the order of magnitude of @xmath131 occur if the ppl has a large slope .",
    "this aspect is illustrated in the following .",
    "for illustration purpose , a quadratic prediction profile likelihood @xmath132 with @xmath133 has been assumed .",
    "these four settings are shown in fig .",
    "[ fig : pplvplillu ] .",
    "the prediction profile likelihood is shown as a red line . for several @xmath129 , the quadratic term in",
    "[ @xmath134 is plotted by blue curves attached to the ppl .",
    "the @xmath68 constitutes the infimum of these curves which in this special case can be calculated analytically and is given by @xmath135    panel ( a ) shows the comparison for @xmath136 . in this case , the boundaries of the vci and the pci differ only by a value around 0.38 . in panel",
    "( b ) , @xmath125 is chosen equal to @xmath76 . in panels ( c ) and ( d ) @xmath125 is further decreased .",
    "this corresponds to more informative data for predicting the exact value of @xmath62 . in these cases ,",
    "the optimum of the ppl is narrow in comparison to validation data error @xmath76 .",
    "then , during fitting the model , a mismatch @xmath137 is predominantly explained by the observation error of the validation data point .",
    "the difference of the boundaries of the confidence intervals increase and approach the 10% quantile of the gaussian distribution , i.e.  a value @xmath138 which is the one - sided 5% confidence interval for a validation data point for a constant model prediction , i.e.  for @xmath139 .",
    "if prior information about parameters is available , e.g.  a prior distribution @xmath140 , maximum likelihood estimation is replaced by maximum a - posteriori ( map ) estimation @xmath141 i.e.  the parameters are estimated by maximizing the a - posterior probability of the data and the parameter estimates . for most common priors , map estimation can be performed by mle using a penalized likelihood . as an example ,",
    "a log - normal prior for a parameter component @xmath142 yields @xmath143 to incorporate prior knowledge , the presented prediction profile likelihood approach has to be generalized to map estimation and the penalized likelihood [ @xmath144 is used instead of the standard log - likelihood @xmath145 .    to illustrate the incorporation of prior knowledge for parameter values ,",
    "the initial concentration @xmath146 is assumed to be drawn from a log - normal distribution @xmath147 with expectation @xmath148 and variance @xmath149 . for parameter estimation",
    ", this is accounted for by using the penalized likelihood [ @xmath144 , i.e.  by adding an additional term to the residual sum of squares .    as in the example in the main text ,",
    "the calculation of the prediction and validation confidence intervals has been repeated for @xmath4 and all three dynamic states @xmath8 , @xmath9 , @xmath3 . in this example , the true value of @xmath150 has been drawn according to the prior from the log - normal distribution [ @xmath151 .",
    "[ fig : pplprior ] shows the prediction profile likelihood functions as curves in vertical direction as well as the respective 90% prediction confidence intervals as dark gray shaded regions .",
    "the prediction confidence intervals plotted in light color are obtained if @xmath152 is estimated without prior information . because @xmath15 is the measured compound in our example , the prediction confidence intervals for @xmath15 are much smaller than for @xmath13 and @xmath16 .",
    "however , also @xmath13 and @xmath16 yield bounded prediction confidence intervals which can be interpreted as _",
    "observability _ of these dynamic states .",
    "omitting the prior information yields larger prediction confidence intervals , especially for the unobserved states @xmath8 and @xmath9 .         in the main text , prediction confidence intervals have been shown for the consecutive reaction model .",
    "[ fig : cons3dvpl ] shows the corresponding validation profile and the respective validation confidence intervals for the same noise realization for all dynamic variables @xmath8 , @xmath9 , and @xmath3",
    ". validation confidence intervals account for the measurement noise in a validation experiment .",
    "therefore , they are larger than the prediction confidence intervals shown in the main text in fig .  1 , panels ( c)-(e ) .         to time points much larger than the measurement times .",
    "because in this example the experimental design does not provide sufficient information about the steady state level of @xmath3 , the prediction confidence intervals diverge and the steady state @xmath3 for @xmath155 is non - observable .",
    "[ fig : nonobsc ] ]    in the main text , it has been discussed how to exploit the prediction profile likelihood for observability analyses .",
    "for the two step model @xmath0 it has been shown that measurements of the compound @xmath15 which sample only the transient increase and therefore does not provide information about the steady state level lead to non - observability of @xmath8 , and @xmath9 for @xmath19 .",
    "in addition to that result , fig .",
    "[ fig : nonobsc ] shows prediction confidence intervals for @xmath3 for times much larger than the measurement times @xmath17 .",
    "@xmath3 becomes practically non - observable for times which are much larger than the time sampling interval .           to demonstrate the applicability of our approach in a realistic setting , the published model of map kinase signaling @xcite has been utilized to illustrate the calculation of prediction and validation confidence intervals .",
    "[ fig : kholo_long ] shows the long - term dynamics of this model , i.e.  the oscillations . in our analysis only the initial phase , i.e.  the first 1000 seconds have been considered .",
    "this time interval is characterized by strong nonlinearity of the model response with respect to the parameters and constitutes a compromise setting between a transient and an oscillatory dynamics .    tab .",
    "1 summarizes the model parameters as they have been published in @xcite .",
    "the hill coefficient @xmath156 is assumed to be equal to one .",
    "for the observational noise of the validation data , the same noise level as for the experimental data has been assumed , i.e.  @xmath157 .",
    "the size of prediction confidence interval can be utilized to figure out informative experimental designs .",
    "if the information of a single data points is intended to be evaluated , then the validation confidence intervals are appropriate .",
    "if many experimental replicates are feasible , the average observation will have a small standard error and then prediction confidence intervals can be used to assess a design .",
    "[ fig : pcisize ] shows the size of the 90% prediction confidence intervals ( upper row ) , i.e.  the difference between the upper and lower boundary , and the size of the validation confidence intervals ( lower row ) along the time axis .",
    "the size is plotted in absolute concentrations ( left panels ) and relative to the total amount of the protein ( right panels ) .    independently from the way of the assessment , erk ( blue lines )",
    "yields the smallest prediction and validation confidence intervals for @xmath158 .",
    "therefore , measurements of erk in this time interval constitute very informative experimental designs for testing the model . as discussed in the main text , such a setting which is appropriate for validating the whole model",
    "is not informative for improving the model parameters .",
    "for such a purpose , new experimental data has to be generated for designs in which the model behavior is not yet precisely specified , i.e.  for a setting with large prediction or validation confidence intervals . in these terms , erk@xmath21 ( gray lines ) is most informative in absolute units between 100 and 200 seconds . also absolute measurements of mek@xmath22 ( red lines ) and mek@xmath21 ( green lines ) along the whole time axis are informative .",
    "if only the amount of a phosphorylated form relative to the total concentration of the protein is experimentally accessible , then the panels on the right should be evaluated to assess the power of a design . in our example , the outcome for the prediction profile likelihood is very similar to the results obtained for absolute concentrations .",
    "again , erk for @xmath159 as well as mek@xmath22 and mek@xmath21 are most informative . for the validation confidence intervals , raf and raf@xmath20",
    "appear as informative because the total concentration of raf is three times smaller than the total amount of mek and erk .",
    "the cvodes package from the suite of nonlinear differential / algebraic equation solvers ( sundials ) @xcite has been used for the numerical integration of the odes and the sensitivity equations .",
    "matlab s fmincon optimizer was used to estimate the parameters .",
    "the gradient and the hessian of the objective function have been provided for the optimizer using the sensitivity equations @xcite and the approximation @xmath160 of the second derivatives @xcite . within a single optimization procedure",
    ", the parameters have been alternatingly optimized on the logarithmic scale as well as the common linear scale until the optimizer converged to a common value on both scales .    for the calculation of the validation profile likelihood",
    ", 30 test predictions @xmath62 within the reasonable range of predictions given by the model structure and @xmath76 have been evaluated to obtain an initial guess of the likelihood shape . then the grid is iteratively refined and/or enlarged until a smooth validation likelihood covering the whole confidence interval is obtained and local minima have been removed . for a single profile likelihood , around @xmath161 to @xmath162 optimizations were required .    for the prediction profile likelihood",
    "the initial guess is obtained from the vpl by equation [ @xmath163 in the main text . the gaps in this guess",
    "are then filled by nonlinear constrained optimization .",
    "if the constraint optimization procedure did not converge , the validation data error @xmath76 has been iteratively decreased by factors @xmath164 ."
  ],
  "abstract_text": [
    "<S> mechanistic dynamic models of biochemical networks such as ordinary differential equations ( odes ) contain unknown parameters like the reaction rate constants and the initial concentrations of the compounds . </S>",
    "<S> the large number of parameters as well as their nonlinear impact on the model responses hamper the determination of confidence regions for parameter estimates . at the same time , classical approaches translating the uncertainty of the parameters into confidence intervals for model predictions are hardly feasible .    in this article it is shown that a so - called _ prediction profile likelihood _ yields reliable confidence intervals for model predictions , despite arbitrarily complex and high - dimensional shapes of the confidence regions for the estimated parameters . </S>",
    "<S> prediction confidence intervals of the dynamic states allow a data - based observability analysis . </S>",
    "<S> the approach renders the issue of sampling a high - dimensional parameter space into evaluating one - dimensional prediction spaces . </S>",
    "<S> the method is also applicable if there are non - identifiable parameters yielding to some insufficiently specified model predictions that can be interpreted as non - observability . </S>",
    "<S> moreover , a _ validation profile likelihood _ is introduced that should be applied when noisy validation experiments are to be interpreted .    </S>",
    "<S> the properties and applicability of the prediction and validation profile likelihood approaches are demonstrated by two examples , a small and instructive ode model describing two consecutive reactions , and a realistic ode model for the map kinase signal transduction pathway . </S>",
    "<S> the presented general approach constitutes a concept for observability analysis and for generating reliable confidence intervals of model predictions , not only , but especially suitable for mathematical models of biological systems . </S>"
  ]
}