{
  "article_text": [
    "in many applications of multiple testing , such as genomic research , clinical trials , and statistical process control , the hypotheses are so structured that they are to be tested in a particular sequence .",
    "this structure may be a natural one , as in goeman and mansmann ( 2008 ) , where gene ontology imposes a directed acyclic graph structure onto the tested hypotheses , or can be formed by using a data - driven approach for specifying the testing order of the hypotheses , as in kropf and l@xmath1uter ( 2002 ) , kropf et al .",
    "( 2004 ) , westfall et al .",
    "( 2004 ) , hommel and kropf ( 2005 ) , finos and farcomeni ( 2011 ) , etc . in some applications , it is not even possible to use the conventional @xmath0-value based multiple testing methods , because of some inherent structure among the tested hypotheses .",
    "for example , the hypotheses associated with stream data in sequential change detection problems ( ross et al . , 2011 ) have a natural temporal structure , but none of conventional methods , such as the stepwise procedures , which are applicable only when all of @xmath0-values are available , can be used here since the decision concerning a hypothesis has to be made even before the data associated with the remaining hypotheses are observed .    some progress has been made in testing structured hypotheses .",
    "however , it has been primarily focused on controlling the familywise error rate ( fwer ) ( maurer et al . , 1995 ; westfall and krishen , 2001 ; wiens , 2003 ; wiens and dmitrienko , 2005 ; hommel et al . , 2007 ; huque and alosh , 2008 ; li and mehrotra , 2008 ; rosenbaum , 2008 ; wiens and dmitrienko , 2010 ; millen and dmitrienko , 2011 ; dmitrienko et al . , 2013 ) .",
    "there are few results towards controlling the false discovery rate ( fdr ) while accounting for the structure of the tested hypotheses .",
    "benjamini and heller ( 2007 ) , heller et al . ( 2009 ) , and mehrotra and heyse ( 2004 ) developed methods for testing hypotheses with a specific hierarchical structure where the structure is limited to only two levels . yekutieli ( 2008 ) discussed a method that controls the fdr when the tested hypotheses have a general hierarchical structure .",
    "however , that method is shown to control the fdr only under independence .",
    "the primary objective of this paper is to help advance the theory and methods on controlling the fdr for testing structured hypotheses .",
    "we do so by focusing on a structure where the hypotheses have a fixed pre - defined testing order since this is the simplest of hierarchical structures , yet it is often seen in real applications such as clinical trials , statistical process control and streaming data analysis .",
    "for such a structure , we will refer to it as a fixed sequence structure throughout this paper .",
    "very recently , several methods have been introduced for controlling fdr while testing pre - ordered hypotheses .",
    "farcomeni and finos ( 2013 ) developed a ` single - step ' fdr controlling method for testing hypotheses with the same critical value @xmath2 , which tests each hypothesis at level @xmath2 until a stopping condition is reached .",
    "barber and candes ( 2015 ) , gsell et al .",
    "( 2016 ) and li and barber ( 2016 ) developed several different ` step - up ' fdr controlling procedures in the context of high - dimensional regression for testing hypotheses with fixed sequence structure for which hypotheses are tested from highest - ranked to lowest - ranked , and lei and withian ( 2016 ) performed asymptotic power analysis for such ` step - up ' procedures .",
    "in addition , javanmard and montanari ( 2015 ) developed procedures for controlling the fdr in an online manner while testing a sequence of possibly infinite pre - ordered hypotheses .    in this paper",
    ", we develop ` step - down ' fdr controlling methods that fully exploit the fixed sequence structural information , in which hypotheses are tested from lowest - ranked to highest - ranked .",
    "we first consider a conventional fixed sequence multiple testing method that keeps rejecting until an acceptance occurs and develop such a method controlling the fdr under arbitrary dependence .",
    "it is shown to be optimal in the sense that it can not be improved by increasing even one of its critical values without losing control over the fdr , or even by imposing a positive dependence condition on the @xmath0-values , such as the standard prds ( positive regression dependence on subset ) condition of benjamini and yekutieli ( 2001 ) .",
    "this is different from what happens in case of non - fixed sequence multiple testing .",
    "for instance , the so - called by method of benjamini and yekutieli ( 2001 ) that controls the fdr under arbitrary dependence can be improved significantly by the bh method of benjamini and hochberg ( 1995 ) by imposing this prds condition . since our procedure",
    "can not be improved under positive dependence , we consider the case of negative dependence and develop a more powerful conventional fixed sequence multiple testing method controlling the fdr under negative dependence which includes independence as a special case .",
    "there is a potential for loss of power in a conventional fixed sequence multiple testing method if the ordering of the hypotheses , particularly for the earlier ones , does not match with that of their true effect sizes , potentially leading to some earlier hypothesis being accepted and the follow - up hypotheses having no chance to be tested . to mitigate that , we consider generalizing the conventional fixed sequence multiple testing to one that allows more than one but a pre - specified number of acceptances , and develop such generalized fixed sequence multiple testing methods controlling the fdr under both arbitrary dependence and independence .",
    "it is not always the case in real data applications that the hypotheses will have a natural fixed sequence structure or information about how to order them will be available a priori .",
    "nevertheless , the data itself can often provide information on how to order the hypotheses . in this paper",
    ", we discuss such a data - driven ordering strategy which can be applied to a broad spectrum of multiple testing problems such as one - sample and two - sample t - tests , and one - sample and two - sample nonparametric tests . through simulation studies and a real microarray data analysis ,",
    "this strategy coupled with our proposed fixed sequence methods is seen to perform favorably against the corresponding non - fixed sequence methods under certain settings .",
    "the paper is organized as follows . with some concepts and background information given in section 2 ,",
    "we present the developments of our conventional and generalized fixed sequence procedures controlling the fdr under various dependencies in sections 3 and 4 , respectively .",
    "our fixed sequence procedures coupled with a data - driven ordering strategy for the hypotheses are applied to a real microarray data in section 5 .",
    "the findings from some simulation studies on the performances of our procedures are given in section 6 .",
    "some concluding remarks are made in section 7 and proofs of some results are given in the appendix .",
    "suppose that @xmath3 , are the @xmath4 null hypotheses that are ordered a priori and are to be simultaneously tested based on their respective @xmath0-values @xmath5 .",
    "let @xmath6 and @xmath7 of these null hypotheses be true and false , respectively . for notational convenience ,",
    "we denote the index of the @xmath8th true null hypothesis by @xmath9 and the set of indices of the true null hypotheses by @xmath10 .",
    "let @xmath11 and @xmath12 be the numbers of true and false null hypotheses , respectively , among the @xmath13 rejected null hypotheses in a multiple testing procedure .",
    "then , the familywise error rate ( fwer ) and false discovery rate ( fdr ) of this procedure are defined respectively as @xmath14 and @xmath15 .",
    "typically , the hypotheses are ordered based on their @xmath0-values and multiple testing is carried out using a stepwise or single - step procedure . however , when these hypotheses are ordered a prior and not according to their @xmath0-values , multiple testing is often performed using a fixed sequence method . given a non - decreasing sequence of critical constants @xmath16 , a conventional fixed sequence method is defined as follows :    _ ( conventional fixed sequence method ) _    1 .",
    "if @xmath17 , then reject @xmath18 and continue to test @xmath19 ; otherwise , stop .",
    "2 .   if @xmath20 then reject @xmath21 and continue to test @xmath22 ; otherwise , stop .",
    "thus , a conventional fixed sequence method continues testing in the pre - determined order as long as rejections occur .",
    "once an acceptance occurs , it stops testing the remaining hypotheses . in section 4",
    ", we will generalize a conventional fixed sequence method to allow a given number of acceptances .",
    "it should be noted that a conventional fixed sequence method with common critical constant @xmath2 , which is often called the fixed sequence procedure in the literature , strongly controls the fwer at level @xmath2 ( maurer et al . , 1995 ) .",
    "we will refer to it as the fwer fixed sequence procedure in this paper in order to distinguish it from other fixed sequence methods designed to control the fdr .",
    "regarding assumptions we make about the @xmath0-values in this paper , we assume that the true null @xmath0-values , which we denote for notational convenience by @xmath23 , for @xmath24 , are marginally distributed as follows : @xmath25 one of several types of dependence , like arbitrary dependence , positive dependence , negative dependence , and independence , has been assumed to characterize a dependence structure among the @xmath0-values .    by arbitrary dependence ,",
    "we mean that the @xmath0-values do not have any specific form of dependence .",
    "the positive dependence is characterized by the positive regression dependence on subset ( prds ) property ( benjamini and yekutieli , 2001 ) as defined below :    ( prds ) the vector of @xmath0-values @xmath26 is prds on the vector of null @xmath0-values @xmath27 if for every increasing set @xmath28 and for each @xmath29 , the conditional probability @xmath30 is non - decreasing in @xmath0 .",
    "several multivariate distributions possess this property ( see , for instance , benjamini and yekutieli , 2001 ; sarkar , 2002 ) .",
    "the negative dependence is characterized by the following property :    [ negative_association ] ( negative association ) the vector of @xmath0-values @xmath26 is negatively associated with null @xmath0-values if for each @xmath24 , the following inequality holds : @xmath31 for all fixed @xmath32 s .",
    "several multivariate distributions posses the conventional negative association property , including multivariate normal with non - positive correlation , multinomial , dirichlet , and multivariate hypergeometric ( joag dev and proschan , 1983 ) .",
    "it is easily seen that independence is a special case of negative dependence .",
    "in this section , we present the developments of two simple conventional fixed sequence procedures controlling the fdr under both arbitrary dependence and negative dependence conditions on the @xmath0-values .",
    "since the fdr is more liberal than the fwer , a conventional fixed sequence method controlling the fdr under arbitrary dependence is expected to have critical values that are at least as large as @xmath2 , the common critical constant for the fwer fixed sequence method . in the following ,",
    "we present such a simple conventional fixed sequence fdr controlling procedure .",
    "[ thm_any_joint_fix_seq_no_acc ] consider a conventional fixed sequence procedure with critical constants @xmath33    * this procedure strongly controls the fdr at level @xmath2 under arbitrary dependence of the @xmath0-values .",
    "* one can not increase even one of the critical constants @xmath34 while keeping the remaining fixed without losing control of the fdr .",
    "this is true even when @xmath26 is assumed to be prds on @xmath35 .",
    "proof of ( i ) . since @xmath36 is the index of the first true null hypothesis , the first @xmath37 null hypotheses are all false .",
    "note that the event @xmath38 implies that @xmath39 and @xmath40 , and therefore we have @xmath41 the first inequality follows from the fact that @xmath42 is an increasing function of @xmath11 and a decreasing function of @xmath12 .",
    "the third inequality follows from the fact that @xmath43 is an increasing function of @xmath6 and @xmath44 since there are at least @xmath37 false nulls .",
    "this proves part ( i ) .    for a proof of part ( ii ) ,",
    "see appendix .",
    "theorem [ thm_any_joint_fix_seq_no_acc ] shows that when controlling the fdr under arbitrary dependence , the operating characteristic of the proposed fixed sequence method is much different from that of the usual stepwise procedure of benjamini and yekutieli ( benjamini and yekutieli , 2001 ) that relys on @xmath0-value based ordering of the hypotheses .",
    "it can not be further improved , even by imposing the prds assumption on the @xmath0-values , unlike the by procedure that is known to be greatly improved by the benjamini - hochberg ( bh ) procedure under such positive dependence .",
    "also , as shown in our proof of theorem [ thm_any_joint_fix_seq_no_acc](ii ) under arbitrary dependence ( see appendix ) , the least favorable configuration ( the configuration which leads to the largest error rate , see finner and roters , 2001 ) of the newly suggested fixed sequence fdr controlling procedure is when the ordering of the hypotheses is perfect ( i.e , when all the false null hypotheses are tested before the true ones ) , the false null @xmath0-values are all @xmath45 with probability 1 , and the true null @xmath0-values are the same with each following @xmath46 distribution .",
    "this least favorable configuration is much different from that given in guo and rao ( 2008 ) for the by procedure under arbitrary dependence .",
    "although the procedure in theorem [ thm_any_joint_fix_seq_no_acc ] can not be improved under the prds condition , we consider in the next subsection the condition of negative dependence which includes independence as a special case , and under such condition , develop a more powerful conventional fixed sequence method that controls the fdr .",
    "when the @xmath0-values are negatively associated as defined in section 2 , the critical constants of the conventional fixed sequence procedure in theorem [ thm_any_joint_fix_seq_no_acc ] can be further improved as in the following :    [ thm_independence_fix_seq_no_acc ] the conventional fixed sequence method with critical constants @xmath47 strongly controls the fdr at level @xmath2 when the @xmath0-values are negatively associated on the true null @xmath0-values .    to prove theorem [ thm_independence_fix_seq_no_acc ] , we use the following lemma , with proof given in appendix :    [ lemma_fdr_process_special ] let @xmath48 and @xmath49 respectively denote the numbers of true and false null hypotheses among the first @xmath8 null hypotheses , and @xmath50 then",
    ", the fdr of any fixed sequence procedure can be expressed as @xmath51    proof of theorem [ thm_independence_fix_seq_no_acc ] .",
    "if @xmath52 , then @xmath53    if @xmath54 , then by lemma [ lemma_fdr_process_special ] , @xmath55 the second equality follows from the fact that @xmath56 for @xmath57 .    for each @xmath58 ,",
    "the following inequality holds .",
    "@xmath59 to see this , we consider , separately , the case when @xmath60 and when @xmath61 .",
    "suppose @xmath60 , then @xmath62 and @xmath63 the first and second inequalities follow from ( [ eqn_neg_assoc ] ) and ( [ eqn_uniform ] ) , respectively .    now suppose @xmath61 , then @xmath64 and @xmath65 in the second equality , we use the fact that @xmath66 .    applying ( [ thm_independence_fix_seq_no_acc_eqn2 ] ) to ( [ thm_independence_fix_seq_no_acc_eqn1 ] )",
    ", we have @xmath67 the equality follows from that fact that @xmath68 , since the first @xmath37 hypotheses are false .",
    "the conventional fixed sequence procedure in theorem [ thm_independence_fix_seq_no_acc ] is nearly optimal in the sense that the upper bound of the fdr of this procedure is very close to @xmath2 under certain configurations .",
    "consider the following configuration : all the false null hypotheses are tested before the true null hypotheses , the false null @xmath0-values are all @xmath45 with probability 1 , and the true null @xmath0-values are independently distributed as @xmath46 . under this configuration",
    ", it is easy to check that ( [ thm_independence_fix_seq_no_acc_eqn2 ] ) becomes an equality . following the proof of theorem [ thm_independence_fix_seq_no_acc ] , the fdr of this procedure is exactly @xmath69 .",
    "when @xmath70 approaches to @xmath71 as @xmath72 with @xmath73 , an approximate lower bound of the fdr is @xmath74 .    to see why , we first note that @xmath75 then , by simple calculation , we have @xmath76 this lower bound of the fdr is very close to the pre - specified level @xmath2 . for example , for large @xmath4 , if @xmath77 , then with @xmath78 , the lower bound under the above configuration is about 0.04999975 .    figure [ img_critical_value_plot ] compares the critical constants for the proposed procedures along with the fwer fixed sequence procedure at level @xmath2 .",
    "it should be noted that the first few critical constants are the most important ones .",
    "if the first few values are too small , then the procedure might stop too early and the remaining hypotheses will not have a chance to be tested . with this in mind , it can be seen that the critical constants of the procedure introduced in theorem [ thm_independence_fix_seq_no_acc ] are by far the best , and the critical constants of the procedure in theorem [ thm_any_joint_fix_seq_no_acc ] are slightly better than those of the conventional fixed sequence procedure .    -10pt",
    "a conventional fixed sequence method might potentially lose power if an early null hypothesis fails to be rejected , with the remaining hypotheses having no chance of being tested . to remedy this",
    ", we generalize a conventional fixed sequence method to one that allows a certain number of acceptances .",
    "the procedure will keep testing hypotheses until a pre - specified number of acceptance has been reached .",
    "the same idea has also been used by hommel and kropf ( 2005 ) to develop fwer controlling procedures in fixed - sequence multiple testing .",
    "suppose @xmath79 is a pre - specified positive integer and @xmath80 is a non - decreasing sequence of critical constants .",
    "a fixed sequence method that allows more acceptances is defined below .    _",
    "( fixed sequence method stopping on the @xmath81 acceptance ) _    1 .   if @xmath17 , then reject @xmath18 ; otherwise , accept @xmath18 .",
    "if @xmath82 or @xmath18 is rejected , then continue to test @xmath19 ; otherwise stop .",
    "2 .   if @xmath20 , then reject @xmath21 ; otherwise , accept @xmath21 . if the number of accepted hypotheses so far is less than @xmath79 , then continue to test @xmath22 ; otherwise stop .",
    "it is easy to see that when @xmath83 , the fixed sequence method stopping on the @xmath81 acceptance reduces to the conventional one .",
    "[ thm_any_joint_fix_seq_with_acc ] the fixed sequence method stopping on the @xmath81 acceptance with critical constants @xmath84 strongly controls the fdr at level @xmath2 under arbitrary dependence of the @xmath0-values .    proof .",
    "let @xmath85 be the index of the first rejected true null hypothesis . if no true null hypotheses are rejected , then set @xmath86 .",
    "we will show that for @xmath87 , @xmath88    if @xmath89 , then @xmath90    now , assume @xmath91 . note that the event @xmath92 implies @xmath93 and @xmath94 , because the first @xmath95 hypotheses were either false nulls or",
    "not rejected true nulls and among the first @xmath95 hypotheses tested , there can be at most @xmath96 acceptances .",
    "thus , @xmath97 the first inequality follows from the fact that @xmath42 is an increasing function of @xmath11 and a decreasing function of @xmath12 .    from ( [ thm_any_joint_fix_seq_with_acc_eqn1 ] )",
    ", we have @xmath98 where the first equality follows from the fact that if none of the first @xmath79 true null hypotheses are rejected , then @xmath99",
    ".     we should point out that the result in theorem [ thm_any_joint_fix_seq_with_acc ] is weaker than that in theorem [ thm_any_joint_fix_seq_no_acc ] , although the method in theorem [ thm_any_joint_fix_seq_with_acc ] reduces to that in theorem [ thm_any_joint_fix_seq_no_acc ] when @xmath100 . more specifically",
    ", we can not prove that the procedure in theorem [ thm_any_joint_fix_seq_with_acc ] is optimal in the sense that its critical constants can not be further improved without losing control of the fdr under arbitrary dependence of the @xmath0-values .",
    "however , under certain distributional assumptions on the @xmath0-values , the critical constants of this procedure can potentially be improved . in particular",
    ", we have the following result .    [ thm_independence_fix_seq_with_acc ]",
    "consider a fixed sequence method stopping on the @xmath81 acceptance with critical constants @xmath101 where @xmath102 is the number of rejections among the first @xmath8 tested hypotheses , with @xmath103 , for @xmath104 .",
    "this procedure strongly controls the fdr at level @xmath2 if the true null @xmath0-values are mutually independent and are independent of the false null @xmath0-values .    before presenting a proof of the above theorem ,",
    "let us introduce a few more notations .",
    "for @xmath104 , let @xmath105 and @xmath106 be the numbers of false rejections and true rejections among the first @xmath8 rejections and @xmath107 be the index of the @xmath108 rejected hypothesis .",
    "if there are less than @xmath8 rejections , we define @xmath109 , @xmath110 and @xmath111 .",
    "in addition , for notational convenience , define @xmath112 and @xmath113 .",
    "we use the following two lemmas , with proofs given in appendix , to prove the theorem .",
    "[ lemma_fdr_process ] the fdr of any fixed sequence method stopping on the @xmath81 acceptance can be expressed as @xmath114    [ lemma_indep2 ] consider the procedure defined in theorem [ thm_independence_fix_seq_with_acc ] , the following inequality holds for @xmath115 , @xmath116    proof of theorem [ thm_independence_fix_seq_with_acc ] . by lemmas [ lemma_fdr_process ] and [ lemma_indep2 ]",
    ", we have @xmath117    when @xmath83 , the generalized fixed sequence method in the above theorem reduces to the conventional fixed sequence method in theorem [ thm_independence_fix_seq_no_acc ] , since in this case @xmath118 , and thus continues to control the fdr when the @xmath0-values are negatively associated . however , when @xmath82 , it can only control the fdr under the independence assumption made in the theorem .",
    "it can be shown that this method , when @xmath119 , may no longer control the fdr when the @xmath0-values are negatively associated .",
    "consider , for example , the problem of simultaneously testing two hypotheses @xmath18 and @xmath19 for which both of them are true , the associated @xmath0-values @xmath120 and @xmath121 are both @xmath122 , and @xmath123 .",
    "it is easy to see that under such configuration , when @xmath124 , the fdr of this procedure is equal to @xmath125",
    "the applicability of the aforementioned fixed sequence methods depends on availability of natural ordering structure among the hypotheses .",
    "when the hypotheses can not be pre - ordered , one can use pilot data available to establish a good ordering among the hypotheses in some cases .",
    "for example , in replicated studies , the hypotheses for the follow - up study can be ordered using the data from the primary study . however , when prior information is unavailable ordering information can usually be assessed from the data itself .",
    "such data - driven ordering has been used by several authors in fixed sequence methods controlling the fwer and generalized fwer ( kropf and l@xmath1uter , 2002 ; kropf et al . , 2004 ; westfall et al . , 2004 ; hommel and kropf , 2005 ; finos and farcomeni , 2011 ) .",
    "assume that the variables of interest are @xmath126 , @xmath104 , with @xmath127 independent observations @xmath128 on each @xmath129 .",
    "an ordering statistic , @xmath130 , and a test statistic , @xmath131 , are determined for each @xmath115 .",
    "the @xmath130 s are used to order all of the hypotheses @xmath132 , @xmath131 is used to test the hypothesis @xmath133 , and @xmath134 is the corresponding @xmath0-value .",
    "in addition , @xmath130 is chosen such that it is independent of the @xmath131 s under @xmath21 and tends to be larger as the effect size increases .",
    "the approach is outlined below .",
    "data - driven ordering procedure    1 .",
    "the hypotheses are ordered based on @xmath135 where the hypothesis corresponding to the largest @xmath130 is placed first , the hypothesis corresponding to the second largest is placed second , and so on .",
    "the hypotheses are tested using a fixed sequence procedure based on the the @xmath0-values @xmath136 and the testing order established in step 1 .",
    "we give a few examples to further illustrate the approach .",
    "_ example 1 : one sample t - test .",
    "_ consider testing @xmath137 against @xmath138 simultaneously where @xmath129 follows a @xmath139 distribution .",
    "let @xmath140 and @xmath141 be the sample mean and variance , respectively , based on the observations @xmath128 .",
    "let @xmath142 be the ordering statistics , that is , the hypotheses are ordered according to the values of the corresponding sums of squares , and @xmath143 is the usual @xmath144-test statistic for testing @xmath21 .",
    "then , @xmath145 , @xmath146 , where @xmath147 is the cdf of the @xmath144-distribution with @xmath148 degrees of freedom , are the @xmath0-values .",
    "when @xmath149 , @xmath131 and @xmath130 are independent ( see , for instance , lehmann and romano , 2005 ; p. 156 ) .",
    "furthermore , @xmath150 which suggests that @xmath151 tends to increase as @xmath130 increases",
    ".    _ example 2 : two sample t - test .",
    "_ consider testing @xmath152 against @xmath153 simultaneously using @xmath154 data vectors .",
    "suppose @xmath155 , @xmath156 , follows a @xmath157 distribution , for @xmath158 .",
    "then , the hypotheses can be tested using the two - sample @xmath144-test statistics @xmath131 and are ordered through the values of the ` total sum of squares , ' which is @xmath159 , where @xmath160 , for @xmath146 .",
    "the rationale behind this is independence between the @xmath130 s and @xmath131 under @xmath21 ( see , for instance , westfall et al . , 2004 ) , and the following result : @xmath161 = ( n-1 ) \\sigma^2 + n_1n_2 ( \\mu_{i}^{(1 ) } - \\mu_{i}^{(2)})^2 /n$ ] .",
    "_ example 3 : nonparametric test .",
    "_ kropf et al .",
    "( 2004 ) describe a data - driven ordering strategy for nonparametric tests . in the one sample case , we are interested in testing @xmath137 against @xmath138 where @xmath162 are assumed to be symmetric about @xmath163 .",
    "the hypotheses are tested using the one - sample wilcoxon test and ordered based on @xmath164 . in the two sample case , we are interested in testing @xmath152 against @xmath153 using @xmath154 data vectors , where @xmath165 are assumed to be symmetric about @xmath166 for @xmath158 .",
    "the hypotheses are tested using the two - sample wilcoxon test and ordered based on the interquartile range @xmath167 , where @xmath168 and @xmath169 are respectively the @xmath170 and @xmath171 quartile of the mixture of @xmath172 s and @xmath173 s .    when our proposed fixed sequence procedures are used in applications coupled with the aforementioned data - driven ordering strategy ,",
    "the fdr controls are still maintained under the independence assumption , if the ordering statistics are chosen to be independent of the test statistics in the data - driven ordering strategy , even though the same data is repeatedly used for ordering and testing the hypotheses .",
    "we have the following result .",
    "[ thm_data_driven ] suppose @xmath174 are mutually independent .",
    "if the hypotheses @xmath175 are ordered based on the ordering statistics @xmath176 , tested using the test statistics @xmath177 , and @xmath130 is independent of @xmath131 under @xmath21 , then the fixed sequence multiple testing procedures introduced in theorems 3.1 - 4.2 can still strongly control the fdr at level @xmath2 .    proof .",
    "assume without any loss of generality that @xmath178 , so that conditional on the @xmath130 s , @xmath21 is the @xmath8th hypotheses to be tested in our fixed sequence multiple testing methods .",
    "when @xmath21 is true , @xmath134 is independent of both @xmath130 and @xmath179 with @xmath180 .",
    "this follows from independence of the @xmath129 s and that of @xmath130 and @xmath131 under @xmath21 .",
    "thus , conditional on the @xmath130 s , each true null @xmath0-value @xmath134 still satisfies ( 1 ) and is independent of all other @xmath0-values @xmath181 with @xmath180 .",
    "therefore , we have for each of the procedures in theorems 3.1 , 3.2 , 4.1 , and 4.2 , @xmath182 this proves the desired result .",
    "we applied our proposed methods to the hiv microarray data ( vant wout et al",
    ". , 2003 ) used by efron ( 2008 ) .",
    "these data consist of @xmath183 gene expression levels across eight subjects , four hiv infected and four uninfected .",
    "the data were log - transformed and normalized .",
    "our goal is to determine which genes are differentially expressed by testing @xmath184 versus @xmath185 simultaneously for @xmath186 , where @xmath187 and @xmath188 are the gene specific mean expressions for hiv infected and uninfected subjects , respectively .",
    "we applied our proposed procedures with the @xmath0-values generated from two sample @xmath144-tests for the genes .",
    "since there is no natural ordering among the genes , we used the ordering statistics for two sample @xmath144-tests in example 2 to order these tested hypotheses .",
    "we compared the procedure in theorem [ thm_independence_fix_seq_with_acc ] with the bh procedure .",
    "the results are summarized in table [ table_microarry_2 ] for different values of @xmath79 where @xmath189 , and @xmath190 .",
    "as seen from table [ table_microarry_2 ] , for all values of @xmath79 except @xmath100 , the procedure in theorem [ thm_independence_fix_seq_with_acc ] generally has more rejections than the bh procedure .",
    "when @xmath2 is small , @xmath191 tends to have the most rejections , but for large @xmath2 , @xmath192 has the most rejections . also , we compared the procedure in theorem [ thm_any_joint_fix_seq_with_acc ] with the by procedure .",
    "the results are displayed in table [ table_microarry ] .",
    "as seen from table [ table_microarry ] , for most values of @xmath79 , our procedure outperforms the by procedure in terms of the number of rejections .",
    "when @xmath193 , the by procedure can not reject any hypotheses , but the procedure in theorem [ thm_any_joint_fix_seq_with_acc ] has at least 8 rejections for all the values of @xmath79 considered .",
    ".the number of discoveries out of @xmath183 genes in the hiv data from vant wout et al .",
    "( 2003 ) by the procedure from theorem [ thm_any_joint_fix_seq_with_acc ] and the by procedure [ cols=\"^,^,^,^,^,^\",options=\"header \" , ]     [ table_microarry ]",
    "a simulation study was conducted to address the performances of the proposed procedures .",
    "we will refer to the procedures in theorems [ thm_any_joint_fix_seq_no_acc ] , [ thm_independence_fix_seq_no_acc ] , [ thm_any_joint_fix_seq_with_acc ] , and [ thm_independence_fix_seq_with_acc ] as procedures 1 - 4 , respectively . specifically , we addressed the following two questions :    1 .   how do procedures 1 , 2 , 3 , and 4 compare against the bh and by procedures in terms of fdr and power",
    "? 2 .   for procedures 3 and 4",
    ", how should @xmath79 be chosen so that the power is large ?",
    "-20pt    in each simulation , @xmath127 independent @xmath4 dimensional random normal vectors with covariance matrix @xmath194 and components @xmath195 , were generated .",
    "the @xmath0-value for testing @xmath137 vs. @xmath196 was calculated using a one - sided , one - sample @xmath144-test for each @xmath8 .",
    "the @xmath163 corresponding to each false null hypothesis is set to the value at which the power of one - sample t - test at level @xmath197 is @xmath198 . as for the joint dependence",
    ", we considered a common correlation structure where @xmath194 had off - diagonal components equal to @xmath199 and diagonal components equal to 1 .",
    "we set @xmath78 and @xmath200 .",
    "the hypotheses were ordered using the ` sum of squares ordering ' used in example 1 from section 5 .",
    "we had 5,000 runs of simulation for each of the procedures considered .",
    "we noted the false discovery proportion and the proportion of correctly rejected false null hypotheses for each procedure in each of these runs .",
    "the simulated fdr and average power ( the expected proportion of correctly rejected false null hypotheses ) were obtained by averaging out the corresponding 5,000 values .    -20pt    we first compared procedures 1 - 4 with the bh and by procedures when @xmath201 and @xmath202 .",
    "figure [ img_plot_90 ] displays these comparisons in terms of the simulated fdr and average power , respectively , under common correlation with @xmath203 ( independence ) , @xmath204 , and @xmath205 while @xmath79 varies from 1 to 80 .",
    "we did not explicitly label procedures 1 and 2 as these are both special cases of procedures 3 and 4 when @xmath83 , respectively .",
    "as seen from figure [ img_plot_90 ] , procedure 3 controls the fdr at level @xmath197 under every dependence configuration .",
    "procedure 4 controls the fdr under independence ( @xmath203 ) , generally maintains controls of the fdr under mild correlation ( @xmath204 ) , but loses control of the fdr for small values of @xmath79 under strong correlation ( @xmath205 ) . from figure [ img_plot_90 ] , one can also see that procedure 3 tends to have its largest power when @xmath79 is between about 3 and 10 , and procedure 4 tends to have its largest power when @xmath79 is between about 5 and 15 .",
    "in addition , figure [ img_plot_90 ] shows that for a well chosen @xmath79 , procedures 3 and 4 outperform the bh procedure , and for all values of @xmath79 , procedures 3 and 4 outperform the by procedure .",
    "next , we compared the fdr and average power of these procedures when @xmath206 and @xmath202 .",
    "figure [ img_plot_80 ] displays these comparisons for @xmath203 , @xmath204 , and @xmath205 while @xmath79 varies from 1 to 80 . in terms of fdr ,",
    "the results shown in figure [ img_plot_80 ] are similar to the results shown in figure [ img_plot_90 ] . in terms of power , figure [ img_plot_80 ] shows that the powers of all the procedures tend to show an increase over the powers shown in figure [ img_plot_90 ] .",
    "figure [ img_plot_80 ] also shows that for a well chosen @xmath79 , procedures 4 can outperform the bh procedure , but , in general , procedure 3 can not . again , for all values of @xmath79 , procedures 3 and 4 outperform the by procedure .",
    "in this paper , we have developed ` step - down ' procedures which control the fdr and exploit the structure of pre - ordered hypotheses .",
    "we have been able to produce the desired methods in the most simple as well as a general setting covering different dependence scenarios .",
    "our simulation study and real data analysis show that in some cases , the proposed procedures can be powerful alternatives to existing fdr controlling procedures .    using some of the techniques developed in this paper , it is possible to develop other types of fixed sequence procedures controlling the fdr , such as a fallback - type procedure . unlike the conventional and generalized fixed sequence procedures developed in this paper , the fallback - type procedure tests the remaining hypotheses",
    "no matter how many earlier hypotheses are accepted , which is needed for analyzing stream data in sequential change detection problems .",
    "although we have only considered the simplest hierarchical structure  fixed sequence structure  by using the similar techniques presented in this paper , we were able to develop simple and powerful procedures that control the fdr under various dependencies when testing multiple hypotheses with a more complex hierarchical structure .",
    "we plan to present these procedures in a future communication .",
    "for any @xmath36 , @xmath207 , consider a joint distribution of the @xmath0-values such that the first @xmath37 hypotheses are false null hypotheses whose corresponding @xmath0-values are @xmath45 with probability one .",
    "the remaining @xmath208 hypotheses are true null hypotheses such that @xmath209 and @xmath210 for @xmath211 . under such joint distribution of the @xmath0-values ,",
    "the fdr of the conventional fixed sequence procedure is exactly @xmath212 .",
    "if @xmath213 then the critical constant is already at its largest and can not be improved . otherwise , if @xmath214 , then fdr @xmath215 and thus @xmath216 can not be made any larger .    in the above construction @xmath26",
    "is prds on @xmath35 .",
    "we only need to note that for @xmath87 , @xmath217 implies @xmath218 .",
    "thus , for any increasing set @xmath28 , @xmath219 which is an increasing function in @xmath0 .",
    "lemma [ lemma_fdr_process_special ] can be regarded as a special case of lemma [ lemma_fdr_process ] with @xmath83 .",
    "note that for @xmath104 , @xmath220 and @xmath221 when @xmath60 , @xmath222 when @xmath61 , and @xmath223 .",
    "thus , when @xmath83 , the event @xmath224 implies @xmath225 and hence @xmath226 by ( [ eqn_lemma_di ] ) and lemma [ lemma_fdr_process ] , the desired result follows .",
    "it is easy to see that for @xmath146 , if there are at least @xmath8 rejections , then @xmath228 .",
    "for ease of notation , let @xmath229 . for @xmath230",
    ", define @xmath231 and @xmath232 . regarding the relationship between @xmath107 and @xmath233 , there are the following two equalities available : @xmath234 and @xmath235 the first equality follows from the fact that for @xmath104 and @xmath236 , when @xmath237 , there are @xmath238 rejections among the first @xmath239 tested hypotheses and the @xmath108 rejection is exactly the @xmath240 tested hypothesis , thus @xmath241 the second equality follows from the fact that the event @xmath242 implies that there are exactly @xmath238 rejections among the first @xmath243 tested hypotheses , thus for @xmath244 , @xmath245 where , the third equality follows from the fact that @xmath246 and the fourth follows from ( [ lemma_indep2_eqn2 ] ) .    by using the above two equalities , we can prove two inequalities below , which are needed in the proof of this lemma .",
    "firstly , we show by using ( [ lemma_indep2_eqn2 ] ) that the following inequality holds : @xmath247      suppose @xmath248 , then @xmath110 and @xmath250 when @xmath237 .",
    "using the fact that @xmath251 , the left hand side of ( [ lemma_indep2_eqn1 ] ) , after some algebra , becomes @xmath252 the first equality follows from these two facts : ( i ) when @xmath237 , i.e. the @xmath108 rejection is @xmath253 , @xmath254 is only dependent on the first @xmath239 @xmath0-values , since @xmath254 is the number of false null hypotheses among the first @xmath238 rejections ; ( ii ) @xmath255 is also only dependent on the first @xmath239 @xmath0-values , since @xmath255 is 1 if and only if there are exactly @xmath238 rejections among the first @xmath239 hypotheses tested .",
    "the inequality follows from ( 1 ) .",
    "now suppose @xmath249 , then @xmath256 and @xmath109 .",
    "similarly , using the fact that @xmath257 , the left hand side of ( [ lemma_indep2_eqn1 ] ) , after some algebra , becomes @xmath258 the inequality follows by the fact that @xmath259 so that @xmath260 .",
    "in addition , in the last line we use the fact that @xmath261 .",
    "proof of ( [ lemma_indep2_eqn4 ] ) . by using ( [ lemma_indep2_eqn3 ] )",
    ", we have @xmath263 the desired result . here",
    ", the second equality follows from the fact that if @xmath264 , then @xmath265 ; otherwise , @xmath266 and @xmath267 so that @xmath268 .",
    "the fourth equality follows from ( [ lemma_indep2_eqn3 ] ) and the fact that @xmath269 .",
    "the inequality follows from the definition of @xmath270 .",
    "proof of lemma [ lemma_indep2 ] . finally , by combining these two inequalities , we can get the desired result as follows . @xmath271",
    "the inequality follows from ( [ lemma_indep2_eqn1 ] ) and ( [ lemma_indep2_eqn4 ] ) ."
  ],
  "abstract_text": [
    "<S> controlling the false discovery rate ( fdr ) is a powerful approach to multiple testing . in many applications , </S>",
    "<S> the tested hypotheses have an inherent hierarchical structure . in this paper </S>",
    "<S> , we focus on the fixed sequence structure where the testing order of the hypotheses has been strictly specified in advance . </S>",
    "<S> we are motivated to study such a structure , since it is the most basic of hierarchical structures , yet it is often seen in real applications such as statistical process control and streaming data analysis . </S>",
    "<S> we first consider a conventional fixed sequence method that stops testing once an acceptance occurs , and develop such a method controlling the fdr under both arbitrary and negative dependencies . </S>",
    "<S> the method under arbitrary dependency is shown to be unimprovable without losing control of the fdr and unlike existing fdr methods ; it can not be improved even by restricting to the usual positive regression dependence on subset ( prds ) condition . to account for any potential mistakes in the ordering of the tests , we extend the conventional fixed sequence method to one that allows more but a given number of acceptances . </S>",
    "<S> simulation studies show that the proposed procedures can be powerful alternatives to existing fdr controlling procedures . </S>",
    "<S> the proposed procedures are illustrated through a real data set from a microarray experiment .    </S>",
    "<S> ams 2000 subject classifications : primary 62j15    key words : arbitrary dependence , false discovery rate , fixed sequence , multiple testing , negative association , prds property , @xmath0-values . </S>"
  ]
}