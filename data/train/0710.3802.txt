{
  "article_text": [
    "the problem of designing channel shortening equalizers for maximum - likelihood sequence detection in inter - symbol interference ( isi ) channels has been widely studied @xcite .",
    "the function of the equalizer is to modify the channel response to reduce the length of the isi in the system thereby reducing the complexity of the sequence detector .",
    "traditionally , the equalizer is designed so that the equalized channel response approximates a pre - specified short fir sequence called the _ partial response _ ( pr ) target .",
    "two commonly studied classes of equalizers are the zero - forcing equalizer ( zfe ) and the minimum mean - squared error ( mmse ) equalizer .",
    "the zfe forces the equalized channel response to match the target response exactly .",
    "the undesired effect of zero forcing is that it colors the noise spectrum and may amplify the noise significantly .",
    "in contrast , the mmse equalizer minimizes the variance of the equalization error , but the error is signal dependent . in both cases the goal is to make the equalized channel response",
    "_ close _ to the target response .",
    "however , the ultimate goal of the channel shortening equalization ought to be a detection performance measure such as the sequence or symbol error rate .    in this work",
    "we take revisit the problem equalizer design in the context of optimal ( map ) detection of the input .",
    "the main contribution of this paper is a new perspective for the problem of channel shortening equalization in terms of the underlying _ a posteriori _ probabilities ( apps ) rather than the traditional approach of using the mmse equalization error as the criterion @xcite .",
    "we pose the question : _ in what sense should the target channel be equivalent to the equalized channel to achieve best detection performance ? _ the answer to this question naturally leads us to a new notion of _ a posteriori equivalence _ ( ape ) between the equalized channel and the target channel . we show that this form of equivalence , which is expressed in terms of their underlying _ a posteriori _ probabilities , guarantees no performance loss due to equalization compared to the optimal detector for the original channel .",
    "this result thus provides a new recipe for equalizer and target design , which is different from the heuristic approach of matching the responses of the target and the equalized channel .",
    "we also prove that there is a family of iir equalizers and targets which guarantee ape .",
    "this paper is organized as follows . in sections  [ sec :",
    "sequence.detection ] and [ sec : linear.equalization ] we review the background material on optimal sequence detection and linear equalization . in section  [ sec : sequence.detection.equalized ] we consider the problem of sequence detection for the equalized channel .",
    "we present our main theoretical results including _ a posteriori _ equivalence and its algebraic characterization . in section  [ sec : practical.considerations ] we consider practical implications of our results . in particular , we show that the mmse equalizer designed with a monic target constraint yields an optimal solution for isi channels when the input symbols have equal energy . unfortunately , the equivalence conditions usually hold only for iir targets , making the results somewhat useless for channel shortening .",
    "however , in section  [ sec : fir.design ] we extend the results to fir target design where we seek the best fir target and iir equalizer with a small but acceptable `` fir approximation penalty . ''",
    "we derive an expression for the sequence detection error rate , and use this as a performance measure for the filter design . for simplicity of the analysis we consider only iir equalizers",
    ". the problem of fir equalizer design would entail the additional task of optimizing the processing delay .",
    "we refer the reader to @xcite for the problem on optimizing the processing delay for systems using mmse equalization .",
    "a similar analysis related to fir equalizer design would be equally important in our problem , but is beyond the scope of this paper . finally , in section",
    "[ sec : examples ] we apply our theory to an example isi channel with binary and non - binary inputs to confirm our predictions through computer simulation .",
    "let @xmath1 denote a discrete - time sequence @xmath2 .",
    "if @xmath1 has finite energy its discrete - time fourier transform is defined as @xmath3 the convolution of two sequences @xmath1 and @xmath4 is denoted by @xmath5 : @xmath6 let @xmath7 denote the discrete delta function : @xmath8 for @xmath9 and @xmath10 .",
    "define the inner product between two sequences @xmath1 and @xmath4 as @xmath11 where @xmath12 denotes complex conjugation for scalars or conjugate - transposition for matrices .",
    "thus , the norm of @xmath1 is @xmath13    given a sequence @xmath1 , let @xmath14 be obtained by time - reversal and conjugation of @xmath1 , i.e. , @xmath15 the fourier transform of @xmath14 is @xmath16 .",
    "thus , we readily obtain the following identity : @xmath17 i.e. , the adjoint of the convolution operation with @xmath1 is convolution with @xmath14 .",
    "let @xmath18 and @xmath19 denote real or complex stationary random processes .",
    "the cross - correlation function is defined by @xmath20 where @xmath21 denotes expectation and @xmath22 is",
    "the number of real dimensions per sample , i.e. , @xmath23 for real processes and @xmath24 for complex ones .",
    "the autocorrelation of @xmath18 is obtained by setting @xmath25 .",
    "the power spectral density of @xmath18 is @xmath26 .",
    "we write @xmath27 if @xmath28 .",
    "consider the following discrete - time model for a real or complex - valued linear time invariant system @xmath29 where @xmath30 is the input to the channel , @xmath31 is the channel impulse response and @xmath32 is additive white gaussian noise with @xmath33 .",
    "assume that @xmath34 has finite energy but is possibly non - causal and infinite .",
    "the channel model ( [ eq : channel.model ] ) is usually the base - band representation after whitened matched filtering @xcite and describes a variety of communication systems .    in the case of complex channels ,",
    "the noise is assumed to be circularly symmetric .",
    "thus , the real and imaginary components of the noise samples are independent with variance @xmath35 .",
    "let the input power spectral density be @xmath36 .",
    "as a special case we also shall consider independent and identically distributed ( iid ) inputs with @xmath37 .",
    "an example for the input symbol set is the @xmath38-phase psk constellation , @xmath39 in the complex case or the bpsk ( bipolar binary ) constellation @xmath40 in the real case .",
    "suppose that a message @xmath41 of finite length @xmath42 symbols is transmitted through the channel ( [ eq : channel.model ] ) .",
    "the received signal is given by @xmath43 since the additive noise is white gaussian , we have @xmath44 where @xmath45 with the summation over @xmath46 carried over the finite region of interest where the samples @xmath47 are available .    given the output sequence @xmath19 , the maximum _ a posteriori _",
    "( map ) estimate of @xmath18 is given by @xmath48 where @xmath49 is the prior probability distribution on @xmath18 .",
    "if this distribution is uniform , then ( [ eq : map.optimal.rule ] ) reduces to maximum - likelihood ( ml ) detection of the input sequence : @xmath50    unfortunately , the direct use of the above expression is limited due to its computational complexity which grows exponentially with the length of the isi . however , when @xmath51 is a short fir sequence , the above cost function can be minimized exactly and computationally efficiently using the viterbi algorithm which was originally devised to decode convolutional codes @xcite .",
    "in order to implement the viterbi algorithm to solve the ml sequence detection ( [ eq : ml.optimal.rule ] ) with manageable complexity , we need to reduce the length of the isi in the system .",
    "this is usually accomplished by using a linear equalizer to condition the channel response to match a pre - specified _",
    "target response_. when the target is a short fir filter , it is called a _ partial response _",
    "( pr ) target .",
    "the viterbi detector operates on the equalized channel to perform sequence detection pretending that the samples were the output of a hypothetical target channel .",
    "let @xmath52 and @xmath53 denote the equalizer and target filters respectively .",
    "for the moment assume that the target is fixed .",
    "[ fig : equalized.system ] illustrates the system with an equalizer whose output is @xmath54 where @xmath55 is the the response of the equalized channel and @xmath56 is the output noise whose power spectral density is @xmath57 .",
    "the _ target channel _ is a hypothetical channel defined by @xmath58 where @xmath18 is the input , @xmath59 is additive white gaussian noise with @xmath60 , and @xmath61 is the output .    the original channel with the equalizer is illustrated in fig .  [ fig : equalized.system ] and the target channel that approximates it is shown in fig .  [ fig : target.channel ] .",
    "traditionally , the equalizer and target are designed to make the equalized channel response @xmath62 _ close _ to target @xmath63 , while keeping the noise white .",
    "the zfe modifies the channel response to match the target filter exactly , i.e. , @xmath64 .",
    "thus , in the frequency domain , the equalizer is given by @xmath65    the spectral density of the noise @xmath66 is @xmath67 an undesirable problem with zero - forcing equalization is that when the channel response @xmath68 has a spectral null or attains very small values , the equalized noise is highly colored and has large variance .",
    "the zfe is rarely used for this reason .",
    "a widely used equalizer in practical systems is the mmse equalizer which is designed to minimize the variance of the equalization error @xmath69 defined as @xmath70 the mmse equalizer ensures that @xmath71 , which yields @xmath72 where @xmath36 is the power spectral densities of the input @xmath18 .",
    "the spectral density of the estimation error is given by @xmath73 the advantage of the mmse design over the zfe is that the spectrum of the mmse noise ( [ eq : mmse.noise.psd ] ) is less colored and always smaller than the zfe noise ( [ eq : zfe.noise.psd ] ) and spectral nulls in @xmath74 cause no problems .",
    "however , @xmath69 is signal dependent , which may cause the viterbi detection to be suboptimal .      instead of choosing a fixed target , we seek the best target of a fixed length . in practice ,",
    "the target is usually designed for an mmse equalizer .",
    "thus , we minimize the variance of the mmse equalization error ( [ eq : mmse.noise.psd ] ) : @xmath75 where the target @xmath63 is assumed to have length @xmath76 : @xmath77 the resulting cost function is a simple quadratic function of the target filter taps .",
    "clearly , with no further constraints on @xmath63 we obtain the trivial solution @xmath78 .",
    "therefore , an additional constraint is imposed on @xmath63 such as the _ unit - energy constraint _",
    "@xmath79 or the _ monic constraint _",
    "@xmath80 or sometimes the _ unit - tap constraint _",
    "@xmath81 for some @xmath82 . in each of these cases , the optimal target , known as the _ generalized partial response _",
    "( gpr ) target , is found easily by solving ( [ eq : cost ] ) subject to the appropriate constraints .    for illustrative purposes ,",
    "we derive the solution to the monic design in the iir limit ( @xmath83 ) , where the problem can be expressed in the frequency domain as @xmath84 over all causal targets @xmath63 with @xmath85 .",
    "the causal and monic constraint on @xmath63 is cumbersome to express directly in the frequency domain .",
    "however , we know that among all the causal and stable spectral factors of @xmath86 therefore , we rewrite the optimization ( [ eq : mmse.cost.function ] ) in terms of @xmath87 as @xmath88 such that @xmath89 the lagrangian @xmath90 is stationary at the solution . using calculus of variations ,",
    "we obtain @xmath91 where the lagrange multiplier @xmath92 is chosen to satisfy ( [ eq : cv.constraint ] ) : @xmath93 the optimal @xmath94 is the causal minimum - phase spectral factor of @xmath87 , and the mmse equalizer ( [ eq : mmse.equalizer ] ) reduces to @xmath95 the spectrum of the estimation error ( [ eq : mmse.noise.psd ] ) is white for this solution : @xmath96 henceforth , we refer to this solution as the _ monic design _ or _",
    "monic solution _ implicitly associating the optimal target with the mmse equalizer .",
    "for the special case of zero - mean iid inputs with @xmath37 , the above solution reduces to @xmath97 coincidentally , this solution is related to the linear mmse decision feedback equalizer ( dfe ) for the given isi channel @xcite .",
    "the mmse - dfe structure is optimal in achieving the capacity for an isi channel with additive white gaussian noise @xcite .",
    "however , it is not immediately obvious or even always true that the above equalizer and target filters would be optimal for sequence detection of ( non - gaussian ) input symbols .    as a caveat",
    "we reiterate that the sequence detection is not meant to be implemented with decision feedback .",
    "we still use the viterbi algorithm or a map based algorithm such as the forward - backward algorithm to compute the symbol _ a posteriori _ probabilities ( apps ) .",
    "it has been observed that the monic design performs better in detection than other design criteria such as the energy constraint ( [ eq : unit.energy.constraint ] ) or the _ unit - tap constraint _ on the target . in the following section",
    ", we shall formally prove this conjecture .    in practice , we need to design fir equalizers and targets with unknown channel and noise characteristics . in this case the second order statistics of the channel input and output are estimated using training and subsequently used to design fir filters .",
    "the solutions to these problems for the various target constraints is described in @xcite .",
    "we point out that this method is also applicable if the noise is colored because the design ensures that the noise whitening is automatically absorbed into the equalizer @xmath98 .",
    "traditionally , the sequence detection is performed in two steps .",
    "the first step is to equalize the channel output .",
    "the next step is to perform the detection pretending that the equalizer output @xmath99 ( fig .",
    "[ fig : equalized.system ] ) were the output of the hypothetical target channel ( fig .",
    "[ fig : target.channel ] ) .",
    "in other words , although the sequence detector is optimally designed for the target channel it is , in reality , applied to the equalized channel . in this section we consider the performance of such a detector .",
    "for simplicity of analysis we assume that the target and equalizer are iir and the target is causal .",
    "we consider the design of fir targets in section [ sec : fir.design ] .",
    "consider the system described by ( [ eq : equalized.channel ] ) , restated below : @xmath100 by design , the above channel approximates the target channel ( [ eq : target.channel ] ) .",
    "the conditional probability of the output of the target channel is @xmath101 where @xmath102 with the summation over @xmath46 carried over a finite region of interest where the samples of @xmath61 are available .",
    "the following result provides an alternate expression for @xmath103 which will be useful in proving a form of equivalence between the target channel and the equalized channel .",
    "suppose the equalizer @xmath98 and target @xmath63 are chosen such that @xmath104 for some @xmath105 , then @xmath106 where @xmath107 .",
    "[ lem : part.result ]    we begin by expanding @xmath108 as follows @xmath109 where @xmath110 denotes the real part .",
    "the last step follows by applying ( [ eq : adjoint ] ) and using @xmath111 . using the hypothesis",
    "that @xmath112 we obtain @xmath113 meanwhile , a similar argument shows that @xmath114 from ( [ eq : part1 ] ) and ( [ eq : part2 ] ) , we obtain the desired result @xmath106 where @xmath107 .",
    "we now interpret lemma  [ lem : part.result ] in terms of the underlying probability distributions .",
    "let upper - case letters denote random variables and lower - case letters denote realizations of these random variables .",
    "suppose that @xmath115 is a stable filter , i.e. , it has no spectral nulls or singularities .",
    "then , @xmath116 is invertible .",
    "hence , for the equalized channel @xmath117 where the constants of proportionality above ( and henceforth ) are always independent of @xmath18 .",
    "using lemma  [ lem : part.result ] and noting that @xmath19 and @xmath99 are constants , we obtain @xmath118    suppose that the hypothetical target channel is assigned an input prior distribution @xmath119 which is possibly different from @xmath49 .",
    "the _ a posteriori _ probability of @xmath18 is @xmath120 comparing ( [ eq : pdf1 ] ) and ( [ eq : map.optimal.rule.2 ] ) , we see that by setting the noise variance @xmath121 and the input prior distribution @xmath119 of the target channel ( [ eq : target.channel ] ) to @xmath122 we ensure that the _ a posteriori _",
    "pdfs for the equalized and target channels are equal : @xmath123 with the understanding that the left - hand side is the app corresponding to the equalized isi channel ( [ eq : channel.model ] ) with a prior @xmath49 on @xmath18 , while the right - hand side is the app corresponding to the _ target channel _ ( [ eq : target.channel ] ) with input pdf @xmath119 .",
    "we reiterate that the target channel is a hypothetical channel and we are free to treat its parameters @xmath63 and @xmath121 as well as its input pdf @xmath119 as _ design parameters_. we assume neither that @xmath98 is the mmse equalizer designed for the target @xmath63 nor that @xmath121 is the variance of equalization error .",
    "although this approach is radically different from the traditional approach in the literature on channel shortening equalization @xcite , it is essential to derive the correct form of _ equivalence _ between the target and equalized channels defined below .",
    "the equalized channel is equivalent to the target channel in the _ a posteriori _ sense if they produce the same _ a posteriori _ probability for the input given the output .",
    "this form of equivalence is called _ a posteriori _ equivalence ( ape ) .",
    "evidently , this definition of equivalence is the most natural one from the perspective of map detection . as a caveat , we point out that @xmath124 and @xmath125 need not be equal , i.e. , the equalizer output @xmath99 would not be a typical output of the target channel .",
    "the above observation may be stated succinctly as follows :    the equalized channel ( [ eq : equalized.channel ] ) with the prior distribution @xmath49 and the target channel ( [ eq : target.channel ] ) with the prior distribution @xmath119 are _ a posteriori _ equivalent .",
    "[ thm : a ]    in general , the mmse or zfe equalizers do not guarantee this form of equivalence even though they attempt to make the equalized channel response close to the target response .",
    "suppose that the target and equalizer are chosen to be the monic solution ( [ eq : target.for.monic.general ] ) and ( [ eq : equalizer.for.monic.general ] ) .",
    "furthermore , let @xmath126 and let @xmath127 be the input prior distribution for the target channel ( [ eq : target.channel ] ) where @xmath128 .",
    "then , the equalized channel is equivalent to the target channel in the _ a posteriori _ sense .",
    "[ cor : mmsedfe.is.a.solution ]    observe that the monic target ( [ eq : target.for.monic.general ] ) and equalizer ( [ eq : equalizer.for.monic.general ] ) satisfy the hypotheses in lemma  [ lem : part.result ] if we set @xmath129 and @xmath128 .",
    "therefore , by ( [ eq : sigma_v^2 ] ) , @xmath130 .",
    "the claimed result follows from theorem  [ thm : a ] .",
    "the above result shows that we can use the monic design for optimal map detection provided that we use the prior distribution @xmath119 for the target channel . in many cases",
    ", the input is iid with a flat spectrum ( @xmath37 ) implying that @xmath131 , i.e. , we do not need a different prior pdf for the target channel .    if we pretend that the equalizer output @xmath99 came from the output of the target channel with a carefully chosen input prior distribution , then all map - based detection algorithms designed for the target channel work optimally when applied to the equalized channel .",
    "these algorithms include hard - decision decoding such as the viterbi algorithm , and soft - decision decoding such as soft - output viterbi algorithm ( sova ) and the bcjr algorithm .",
    "soft - decision algorithms , unlike the viterbi algorithm , use an extra parameter , viz .",
    "the variance of the additive noise in the channel .",
    "when applying soft decoding to the target channel , we must use @xmath121 as this variance parameter .",
    "our calculation above show that @xmath121 simply equals @xmath92 , the equalization error variance ( see ( [ eq : white.error ] ) ) .",
    "this fact is routinely assumed in many system designs with no rigorous justification but it is fortunately the correct value to use .",
    "[ rmk : zero ]",
    "we now consider some practical implications of our main result in section [ sec : sequence.detection.equalized ] .",
    "henceforth , we assume that @xmath49 is a uniform distribution over the set of allowed code sequences . in this case , the map sequence estimate ( [ eq : map.optimal.rule ] ) coincides with the ml estimate ( [ eq : ml.optimal.rule ] ) .",
    "suppose that all the input sequences in the message codebook have equal energy and that the equalizer @xmath98 and target @xmath63 are chosen such that latexmath:[\\ ] ] where @xmath282 and @xmath283 using variational calculus we obtain @xmath284 where @xmath92 is a lagrange multiplier . solving the above simultaneous equations yields @xmath285 where @xmath286 finally @xmath287 can be solved from ( [ eq : transformation ] ) .",
    "note that @xmath92 is uniquely determined by the constraint ( [ eq : constraint ] ) .",
    "however , we could choose an arbitrary value for @xmath92 ( such as @xmath288 ) since it merely scales the solution without altering the value of @xmath192 .    in the long target ( iir ) limit , it is easy to see that the solutions converge to the following limits : @xmath289 for some @xmath143 , which have the required form in theorem  [ thm : equivalence ] for @xmath148",
    ". therefore , ( [ eq : sigma_v^2 ] ) suggests that we must set @xmath290 in the fir case , however , the problem of choosing the correct value of @xmath121 is somewhat ambiguous because fir solutions do not satisfy the hypotheses in theorem  [ thm : equivalence ] .",
    "we nominally set @xmath291 in the fir case as well .",
    "this is a good first approximation and fine - tuning this parameter may produce better results ."
  ],
  "abstract_text": [
    "<S> the problem of channel shortening equalization for optimal detection in isi channels is considered . </S>",
    "<S> the problem is to choose a linear equalizer and a partial response target filter such that the combination produces the best detection performance . instead of using the traditional approach of mmse equalization , we directly seek all equalizer and target pairs that yield optimal detection performance in terms of the sequence or symbol error rate . </S>",
    "<S> this leads to a new notion of _ a posteriori _ equivalence between the equalized and target channels with a simple characterization in terms of their underlying probability distributions . using this characterization we show the surprising existence an infinite family of equalizer and target pairs for which _ any _ maximum _ a posteriori _ </S>",
    "<S> ( map ) based detector designed for the target channel is simultaneously map optimal for the equalized channel . for channels </S>",
    "<S> whose input symbols have equal energy , such as @xmath0-psk , the mmse equalizer designed with a monic target constraint yields a solution belonging to this optimal family of designs . </S>",
    "<S> although , these designs produce iir target filters , the ideas are extended to design good fir targets . </S>",
    "<S> for an arbitrary choice of target and equalizer , we derive an expression for the probability of sequence detection error . </S>",
    "<S> this expression is used to design optimal fir targets and iir equalizers and to quantify the fir approximation penalty .    intersymbol interference , linear equalization , channel shortening , partial response , target design , map detection , decision feedback . </S>"
  ]
}