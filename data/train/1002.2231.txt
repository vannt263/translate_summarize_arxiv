{
  "article_text": [
    "in the present work , we shall not propose new monte carlo ( mc ) methods based on the equilibrium distributions of statistical mechanics . on the contrary",
    ", we shall discuss how the available mc methods based on the consideration of the gibbs canonical ensemble : @xmath7 could be extended by using a minimal , but crucial modification in their schemes to account for the existence of an anomalous regime with _ negative heat capacities _ @xmath0 @xcite .",
    "this fact avoids the incidence of the so - called _ super - critical slowing down _ , a dynamical anomaly that significantly affects the efficiency of large - scale canonical mc simulations @xcite .",
    "our proposal follows as a direct application of the recently obtained fluctuation - dissipation relation @xcite : @xmath8 which involves the heat capacity @xmath9 of a given system in an equilibrium situation where the inverse temperature @xmath10 of a certain environment exhibits correlated fluctuations with the system internal energy @xmath11 as a consequence of their mutual thermodynamic interaction . ] .",
    "eq.([tur ] ) accounts for the realistic possibility that the internal state of the system acting as _ environment _ could be affected by the presence of the system under study , which is a fact _ a priory _",
    "disregarded by the consideration of the gibbs canonical ensemble ( [ gibbs ] ) , where the inverse temperature @xmath10 of the environment exhibits a constant value @xmath12 because its heat capacity @xmath13 is practically infinite .",
    "obviously , eq.([tur ] ) is just a suitable extension of the well - known relation : @xmath14 between the heat capacity @xmath9 and the energy fluctuations derived from the canonical ensemble ( [ gibbs ] ) . while the canonical result ( [ can ] ) only admits macrostates with positive heat capacities",
    "@xmath15 , it is easy to verify that the fluctuation relation ( [ tur ] ) is compatible with the presence of macrostates having negative heat capacities @xmath0 .",
    "this last conclusion is the fundamental ingredient considered in this work for allowing a direct extension of some mc algorithms based on the gibbs canonical ensemble ( [ can ] ) in order to account for a regime with @xmath0 . as discussed elsewhere",
    "@xcite , this kind of anomaly in the caloric curve appears to be associated with the occurrence of a discontinuous ( first - order ) phase transition in finite short - range interacting systems , as well as systems with long - range interactions such as astrophysical systems .",
    "this work is organized into sections as follows : first , we shall discuss in section [ proposal ] how the present ideas can be considered to extend the available canonical mc methods ; afterwards , we shall apply these arguments in section [ examples ] to extend two well - known canonical mc algorithms : the _ metropolis importance sample _ @xcite and the _ swendsen - wang cluster algorithm _",
    "@xcite , in their application to the study of anomalous macrostates present in the thermodynamic description of the _ q_-states potts models defined on a @xmath2-dimensional hypercubic lattice ; finally , concluding remarks are presented in section [ conclusions ] .",
    "for convenience , let us begin the present discussion by reviewing the most important results related to the fluctuation theorem ( [ tur ] ) .",
    "our analysis starts from the consideration of the following generic energy distribution function @xcite : @xmath16 where @xmath17 is a probabilistic weight that considers the thermodynamic influence of a certain environment .",
    "the above work hypothesis admits the canonical weight : @xmath18 as a relevant but particular case when the environment is just a thermal bath having an infinite heat capacity .",
    "this general situation could be implemented with the help of a metropolis monte carlo simulation by using the transition probability : @xmath19 since the energy thermal fluctuations @xmath20 are small when the system size is sufficiently large , eq.([t1 ] ) can be rewritten in a _",
    "canonical _ fashion as follows : @xmath21 , 1\\right\\ }   , \\ ] ] where @xmath22 is hereafter referred to as the _ inverse temperature _ of the environment : @xmath23    the density of states @xmath24 is related to the system entropy @xmath25  as @xmath26   $ ] , which allows us to obtain the system temperature @xmath27 by using the thermodynamic relation : @xmath28 eqs.([eff.temp ] ) and ( [ sys.temp ] ) can be combined to express the _ inverse temperature difference _ @xmath29 as follows : @xmath30 with @xmath31 being the density of probability .",
    "this last representation ( [ temp.diff ] ) is very useful to obtain two remarkable thermodynamic relations .",
    "the first one involves the statistical expectation value @xmath32 , and its calculation reads as follows : @xmath33 while the second one considers the correlation function @xmath34 : @xmath35 here , we have taken into account the vanishing of the density of probability @xmath36 and its first derivative @xmath37 at the maximum @xmath38 and minimum @xmath39 values of the system energy , as well as the normalization condition .",
    "the vanishing of the expectation value @xmath40 , eq.([exp.value.1 ] ) , is simply the known _ thermal equilibrium condition _ :",
    "@xmath41 the mathematical form of which clearly indicates that the equalization of temperature expressed by the _",
    "zeroth principle of thermodynamics _ takes place in an average sense .",
    "eq.([exp.value.2 ] ) can be rewritten as a rigorous fluctuation relation by using the identity @xmath42 : @xmath43 by using the _ schwartz inequality _",
    "@xmath44 , this last result can be rephrased as : @xmath45 where @xmath46 .",
    "finally , by substituting the first - order approximation : @xmath47 into eq.([fluct.gen ] ) , with @xmath48 being the heat capacity , one obtains the fluctuation - dissipation relation ( [ tur ] ) .    the fluctuation - dissipation relation ( [ tur ] ) can be rewritten as follows : @xmath49 since the right - hand side of this expression is always nonnegative , it is easy to see that the presence of macrostates with positive heat capacities @xmath15 demands that the correlation function @xmath50 obey the constraint : @xmath51 clearly , such a condition is fulfilled by the gibbs canonical ensemble ( [ gibbs ] ) , where @xmath52 .",
    "however , the existence of macrostates having negative heat capacities @xmath0 can be only observed provided that the constraint : @xmath53 holds .",
    "thus , any attempt to impose the canonical condition @xmath54 is always accompanied with a progressive increase of the energy fluctuations @xmath55 , which leads to the thermodynamic instability and inaccessibility of such anomalous macrostates .    the simplest way to guarantee the existence of non - vanishing correlated fluctuations @xmath56 is achieved by considering an environment with a _ finite heat capacity _ @xmath13 . here , the inverse temperature fluctuations @xmath57 can be expressed in terms of the amount of energy @xmath58 released or absorbed by the system in turn its equilibrium value : @xmath59 where we have considered the thermal equilibrium condition @xmath60 . by substituting this last expression into fluctuation - dissipation relation ( [ tur ] ) ,",
    "one obtains : @xmath61 since the right - hand side of this last expression is always nonnegative , the thermodynamic stability of macrostates with negative heat capacity @xmath0 demands the applicability of the following constraint @xcite : @xmath62 remarkably , this result was also obtained in the past by thirring @xcite .",
    "the above consequences are illustrated in detail in fig.[caricature.eps ] .",
    "we show here the typical backbending behavior of the microcanonical caloric curve @xmath63 of a finite short - range interacting system undergoing a first - order phase transition @xcite , where the points within the energetic region @xmath64 represent anomalous macrostates with negative heat capacities .",
    "the density of probability @xmath65 corresponds to a situation where this system is put in thermal contact with a certain environment characterized by the inverse temperature @xmath66 .",
    "the maxima and minima of the distribution function @xmath65 are determined from the thermal equilibrium condition @xmath67 , that is , the intersection points between these inverse temperature dependencies . for convenience ,",
    "we have shown here two relevant cases .",
    "[ t ]    caricature.eps    the first case corresponds to the equilibrium situation associated with the gibbs canonical ensemble ( [ gibbs ] ) , where the inverse temperature dependence @xmath68 remains at the constant value @xmath12 despite the underlying energy interchange .",
    "it should be noticed that the thermal equilibrium condition is fulfilled by three points @xmath69 when the inverse temperature @xmath12 is within the interval @xmath70 .",
    "if this is the case , the energy distribution function @xmath71 is _ bimodal _ , where the points @xmath72 and @xmath73 determine the positions of its peaks ( local maxima ) , while the intermediate point @xmath74 determines the position of its local minimum .",
    "one can verify that the local minimum @xmath74 always belongs to the anomalous region with @xmath0 , while the maxima @xmath75 are located within the regions with @xmath15 .",
    "the accessibility of such points behaves with the increase of the system size @xmath4 as @xmath76 and @xmath77 , where @xmath78 .",
    "consequently , anomalous macrostates with @xmath0 becomes _ practically inaccessible _ within the canonical ensemble ( [ gibbs ] )  when @xmath4 is sufficiently large .",
    "the existence of such a _ hidden region _",
    "is the origin of the latent heat @xmath79 necessary for the conversion of one phase into the other during the phase transition , as well as for the _ ensemble inequivalence _ between the microcanonical and canonical description @xcite .",
    "a multi - modal character of the density of probability @xmath80 in the framework of mc simulations based on the canonical ensemble ( [ gibbs ] ) leads to the occurrence of the _ super - critical slowing down _",
    "@xcite : an exponential divergence of correlation times with the increasing of the system size , @xmath81 . in other words",
    ", this phenomenon manifests as an _ effective trapping _ of the system energy within any of the coexisting peaks of the distribution function @xmath82 , due to the probability @xmath27 for the occurrence of a large energy fluctuation that allows a transition towards a neighboring peak decreases exponentially with the increase of the system size @xmath4 , @xmath83 .",
    "thus , the characteristic timescale for such a transition is given by @xmath84 . because the canonical averages should consider the contribution of all these coexisting peaks , the relaxation timescales of such expectation values also exhibit an exponential growth with the increasing of @xmath4 .",
    "the second case shown in fig.[caricature.eps ] corresponds to a situation where the system is put in thermal contact with an environment having a finite heat capacity . by choosing appropriately the environment and its internal conditions , in particular , the applicability of thirring s constraint ( [ thir.const ] )",
    ", the corresponding inverse temperature @xmath85 can ensure the existence of only one intersection point with the microcanonical caloric curve @xmath86 of the system under study .",
    "even , such a point could be located within the anomalous region with @xmath0 , e.g. , the unstable macrostate @xmath74 .",
    "since the energy distribution function @xmath87 is monomodal , the phenomenon of super - critical slowing down can not be present when such a physical situation is simulated by using a suitable mc method .      in the multicanonical mc method and its variants @xcite ,",
    "the main aim is to obtain of the density of states @xmath88 , or , equivalently , the microcanonical entropy @xmath89 .",
    "such a goal can be achieved through a direct mc calculation of the energy distribution function @xmath90 , which can be inverted to express the system entropy and the canonical expectation values @xmath91 as follows : @xmath92-\\log\\left[\\omega(e)\\right]+cte,\\ ] ] @xmath93\\left[\\int \\frac{\\rho(e)}{\\omega(e)}e^{-\\beta_{b } e}de\\right]^{-1}.\\ ] ] the mathematical form of the probabilistic weight , @xmath94 , can be conveniently proposed before performing the mc simulation @xcite , although the most common strategy is to carry out its iterative reconstruction through several preliminary mc runs to obtain a _ flat",
    "_ histogram @xmath95 within the energy interval of interest @xcite .",
    "this latter alternative allows to enhance rare events , which is particularly useful to avoid the super - critical slowing down near to first - order phase transitions @xcite .",
    "this kind of mc simulation allows the acquisition of the thermodynamic information in a wide energy interval by performing a single mc run .",
    "a clear disadvantage is that a substantial fraction of computational resources should be consumed to find an optimal probabilistic weight @xmath94 .",
    "the acquisition of the microcanonical caloric curve @xmath96 as well as of the heat capacity @xmath97^{-1}$ ] from a numerical differentiation of the entropy @xmath89 is a procedure that enhances the unavoidable statistical errors involved in the mc calculation of the energy distribution @xmath98 and/or the probabilistic weight @xmath94 .",
    "clearly , it is desirable to implement some type of methodology that allows a direct estimation of the caloric curve @xmath63 and of the heat capacity @xmath99 without considering a numerical differentiation of the system entropy @xmath89 . a simple strategy is provided by considering the thermal contact of the system with an environment characterized by a finite heat capacity , as in the second case illustrated in fig.[caricature.eps ] .",
    "it should be noticed here that the system energy @xmath11 and the inverse temperature @xmath10 of the environment undergo small thermal fluctuations around their expectation values @xmath100 and @xmath101 , which provide a suitable estimation of the intersection point @xmath102 derived from the condition of thermal equilibrium @xmath103 : @xmath104    in essence , eq.([ave.inter ] ) expresses the procedure associated with the mc method of the so - called _ dynamical ensemble _ proposed by gerling and hller @xcite , which is defined by a probabilistic weight @xmath94 with a power - law shape : @xmath105 whose corresponding inverse temperature is given by : @xmath106 the fluctuation relation ( [ tur ] ) enables the introduction of several improvements for this kind of mc calculations to estimate the thermo - statistical properties of a system within the microcanonical ensemble by using modified canonical mc algorithms .",
    "in fact , one can also obtain the heat capacity @xmath107 at the interception point from the fluctuating behavior of the system as follows : @xmath108 thus , one is able to obtain a suitable estimation of any point on the microcanonical caloric curve @xmath109 as well as the heat capacity @xmath99 regardless of whether its character positive or negative .",
    "generally speaking , the specific mathematical form of the probabilistic weight @xmath94 or its corresponding inverse temperature @xmath66 is unimportant as long as the following conditions applied :    1 .   the inverse temperature @xmath66 of the environment must ensure the existence of only one intersection point with the caloric curve @xmath63 , that is , the existence of only one peak in the energy distribution function @xmath98 .",
    "the size @xmath4 of the system under analysis should be sufficiently large to guarantee the validity of the first - order approximation ( [ gapp ] ) considered for deriving the fluctuation - dissipation relation ( [ tur ] ) from the rigorous fluctuation relation ( [ fluct.gen ] ) .    as already depicted in fig.[caricature.eps ] , the energy distribution function @xmath98 has the shape of a bell curve , usually approximated by a gaussian distribution .",
    "since the system exhibits small thermal fluctuations @xmath110 , only local properties of the inverse temperature dependence @xmath66 close to the equilibrium point @xmath111 are significant ; hence , one can obtain the same practical results by using different mathematical dependencies for the inverse temperature @xmath66 .",
    "the simplest mathematical form is provided by restricting to the first - order power expansion of the inverse temperature dependence @xmath66 around the intersection point : @xmath112 which considers a linear coupling of the environment inverse temperature @xmath10 with the thermal fluctuations of the system energy @xmath113 .",
    "remarkably , such a linear ansatz ( [ ansatz.linear ] ) is equivalent to the so - called _ gaussian ensemble _",
    "@xcite : @xmath114\\ ] ] proposed by hetherington @xcite , which approaches in the limit @xmath115 to the microcanonical ensemble @xmath116 .    hypothesis ( [ ansatz.linear ] ) ensures the existence of non - vanishing correlated fluctuations @xmath117 when the coupling constant @xmath118 . by using the fluctuation - dissipation relation ( [ tur ] ) and",
    "the ansatz ( [ ansatz.linear ] ) , one can obtain the following expression for the heat capacity : @xmath119 which can be rewritten to obtain the energy and inverse temperature dispersions , @xmath120 and @xmath121 , as follows : @xmath122 where @xmath123 .",
    "the inverse temperature dispersion @xmath124 decreases with the increase of the system size @xmath4 as @xmath125 . in the limit @xmath126 ,",
    "the thermal fluctuations disappear and the present equilibrium situation becomes equivalent to the microcanonical ensemble provided that the following condition : @xmath127 holds .",
    "according to the first - order approximation ( [ gappe ] ) , the coupling constant @xmath128 can be related to the heat capacity @xmath13 of the environment as @xmath129 , hence , the stability condition ( [ ceq ] ) is fully equivalent to thirring s constraint ( [ thir.const ] ) .    at first glance ,",
    "it is desirable to maximally reduce the thermal dispersions of the system energy @xmath11 and its inverse temperature @xmath130 indirectly derived from the environment inverse temperature @xmath131 .",
    "however , the inequality of eq.([unc ] ) imposes an important limitation on the precision of such a kind of measuring process : a reduction of the thermal uncertainties @xmath132 affecting the temperature equalization provokes an increasing of the system energy fluctuations @xmath120 , and vice versa . as previously discussed @xcite , eq.([unc ] ) accounts for the existence of some type of _ complementary character _ between thermodynamic quantities of energy and temperature . in consequence",
    ", one must assume the existence of non - vanishing thermal uncertainties for the system energy @xmath11 and its inverse temperature @xmath133 .    according to expressions ( [ dispersions ] ) , the increase of the coupling constant @xmath128 allows us to reduce the energy dispersion @xmath120 , but its value should not be excessively large because its increasing also leads to the increasing of the inverse temperature dispersion @xmath124 . a simple criterion to provide the best value for @xmath128",
    "is obtained after minimizing the total dispersion @xmath134 . by introducing the _ microcanonical curvature _",
    "@xmath135 : @xmath136 which is defined in terms of the second derivative of the entropy with the opposite sign , the optimal value ( opt ) for @xmath128 is given by : @xmath137 the microcanonical caloric curve @xmath138 and the heat capacity @xmath139 derived from eqs.([ave.inter ] ) and ( [ cap.fluct ] ) should not depend on the coupling constant @xmath128 as long as this latter parameter fulfils condition ( [ ceq ] ) and the system size @xmath4 is sufficiently large .",
    "nevertheless , the use of its optimal value ( [ optimal ] ) minimizes the underlying thermal fluctuations , which should also reduce the number of steps needed to ensure the convergence of a mc run .",
    "given a certain dependence of the environment inverse temperature @xmath140 , one can obtain from a mc run suitable estimations of the system inverse temperature @xmath141 and its heat capacity @xmath142 at the @xmath143-th interception point @xmath144 .",
    "these estimates values can be employed to provide the next dependence @xmath145 to perform an analogous estimation at the @xmath146-st neighboring point @xmath147 . to fix some ideas ,",
    "let us denote by @xmath148 the system energy per particle .",
    "the @xmath143-th dependence of the environment inverse temperature ( [ ansatz.linear ] ) considered for the mc calculation of the @xmath143-th point @xmath149 is given by : @xmath150 where @xmath151 and @xmath152 are some rough estimates of the expectation values @xmath153 and @xmath154 .",
    "the parameters @xmath155 could be provided in an interactive way by using the curvature @xmath156 derived from the previous mc simulation : @xmath157 where @xmath158 is a small energy step .",
    "the initial value @xmath159 is assumed to be the expectation value @xmath160 of the energy per particle obtained from any canonical mc simulation with inverse temperature @xmath161 sufficiently away from the anomalous region with @xmath0 .",
    "the stability of the iterative procedure previously described depends on the precision of the estimated value of microcanonical curvature @xmath135 .",
    "of course , alternative iteration schemes are also possible , e.g. , the following scheme : @xmath162 which forces with @xmath163 ( @xmath164 ) a forward ( backward ) motion of the expectation values @xmath165 and @xmath166 along the system caloric curve @xmath167 whenever the value of coupling parameter @xmath128 does not change in a significant way . in general , the inverse temperature @xmath168 of a large enough short - range interacting system describes _ a plateau _ within the anomalous region with @xmath0 , which means that the corresponding curvature @xmath135 does not significantly differ from zero , @xmath169 . in such cases ,",
    "the value @xmath170 constitutes a suitable approximation within the energy range containing the anomalous region with @xmath0 , while the value @xmath171 corresponding to the canonical ensemble is a good choice elsewhere .",
    "since the inverse temperature @xmath12 of the gibbs canonical ensemble ( [ gibbs ] ) appears as a driving parameter in the transition probability @xmath172 of canonical mc methods , the most general idea to extend this kind of algorithms is to replace the bath inverse temperature @xmath12 by a variable inverse temperature @xmath66 , @xmath173 .",
    "moreover , it is desirable that the transition probability resulting from such a modification fulfills the so - called _ detailed balance condition _",
    "@xcite : @xmath174 where @xmath175 is the system distribution function , which is given by the function @xmath176 $ ] .",
    "let us denote the energy varying during the configuration change @xmath177 as @xmath178 and its mean value as @xmath179   /2 $ ] . according to the mean value theorem",
    ", one can express the variation of the function @xmath180 by using the environment inverse temperature @xmath181 evaluated at a certain intermediate energy @xmath182 as follows : @xmath183 where @xmath184 is a real parameter with @xmath185  and @xmath186 . by considering the transition probability of any canonical mc algorithm that obeys the detailed balance condition : @xmath187 as well as eq.([meanvalue ] )",
    ", one can finally obtain : @xmath188 this last result clarifies that given the initial and final system configurations , @xmath189 and @xmath190 , one can always find a certain value @xmath191 of the bath inverse temperature that fulfils the detailed balance condition ( [ dbal ] ) for the present distribution function @xmath192 . in particular , the exact value of @xmath193 for the gaussian ensemble ( [ gens ] ) is the one corresponding to @xmath194 , @xmath195 .",
    "the main obstacle to perform a direct application of eq.([detailed.bal.omega ] ) to extend canonical mc methods relies on the fact that the final system configuration @xmath196 is _ a priori _ unknown in many non - local mc algorithms @xcite .",
    "consequently , one should consider some suitable approximation @xmath197 of the exact value @xmath193 , e.g. , the one corresponding to the environment inverse temperature at the initial system configuration @xmath189 , @xmath198 $ ] . to estimate",
    "the error involved in this last approximation , it is important to take into account that the environment heat capacity @xmath13 and the energy change @xmath58 behave with the increase of the system size @xmath4 as @xmath199 and @xmath200 . here , the exponent @xmath201 ranges from zero for a local algorithm such as the metropolis importance sample , up to @xmath202 for a hypothetical non - local algorithm able to obtain an effective independent configuration after each mc step follows from the size behavior of the energy dispersion @xmath203 . ] .",
    "consequently , the difference @xmath204 merely constitutes a small size effect : @xmath205 where the index _ m _ indicates that the corresponding quantities @xmath10 and @xmath13 have been evaluated at the energy value @xmath206 . since the estimated inverse temperature @xmath207 depends on the system energy @xmath208 , the corresponding distribution function associated with this approximation @xmath209 can also be expressed by a certain function of the system energy , @xmath210 $ ] . according to eq.([small.error ] ) , the corresponding inverse temperature : @xmath211 can not differ in a significant way from the exact dependence @xmath66 as long as the system size @xmath4 be sufficiently large .",
    "the extended canonical mc methods based on an estimation of the inverse temperature @xmath193 do not fulfill the detailed balance condition ( [ dbal ] ) .",
    "however , this fact does not represent any fundamental difficulty since one practically obtains the same numerical results for the caloric curve @xmath63 and the heat capacity @xmath99 with the help of equations ( [ ave.inter ] ) and ( [ cap.fluct ] ) by using slightly different probabilistic weight @xmath212 .",
    "the only requirement is that the energy distribution function @xmath98 exhibits a sharp gaussian profile , which is simply achieved when the size @xmath4 of the system under study is large enough .",
    "while the super - critical slowing down of canonical mc methods observed in systems undergoing a first - order phase transition becomes more severe as @xmath4 increases , the errors associated with all approximations assumed here turn more and more negligible .",
    "this is the reason why the present methodology is particularly useful for avoiding this type of slow sampling problems in large - scale mc simulations .",
    "as naturally expected , finite size effects can be significant when one is also interested to describe systems whose size @xmath4 is not so large .",
    "if this is the case , it is not only necessary to implement extended mc schemes that fulfills the detailed balance condition ( [ dbal ] ) , but also the inclusion of some finite size corrections into equations ( [ ave.inter ] ) and ( [ cap.fluct ] ) employed here to obtain the microcanonical dependencies @xmath63 and @xmath99 .",
    "although the complete analysis of these questions is outsize of the scope of the present paper , we would like to clarify that the most general way to fulfill the detailed balance condition ( [ dbal ] ) after the consideration of an estimated value for the transition inverse temperature @xmath213 is to introduce _ a posteriori _ an acceptance probability @xmath214 : @xmath215to accept or reject the final configuration @xmath190 . here ,",
    "@xmath216 $ ] and @xmath217 $ ] , with @xmath218 and @xmath219 , represent the transition probabilities of the direct and the reverse process , respectively .",
    "the mathematical forms of which depend on the particularities of each non - local mc method .",
    "for the sake of simplicity , let us consider in the present study the @xmath1-state potts model @xcite:@xmath220 defined on a @xmath2-dimensional hypercubic lattice @xmath221 with @xmath222 and periodic boundary conditions . here , the sum is only over pairs of nearest - neighbor lattice sites and @xmath223   $ ] is the spin state at the _ i - th _ site .",
    "this model system is just a generalization of the known ising model:@xmath224 with @xmath225 , which appears as a particular case with @xmath226 after considering a linear transformation among their respective energy per particle @xmath227 and inverse temperature @xmath228 .    as discussed elsewhere",
    "@xcite , this model system undergoes a first - order phase transition when @xmath229 for @xmath230 and @xmath231 for @xmath232 , and hence , the microcanonical caloric curves @xmath233 for these model realizations exhibit the backbending behavior associated with the presence of macrostates with @xmath0 such as the one sketched in fig.[caricature.eps ] .",
    "in addition to the consideration of a local mc method as the _ metropolis importance sample _ @xcite , the canonical mc study of potts models can be carried out by using another accelerating methods such as the swendsen - wang @xcite or wolff @xcite _ clusters algorithms_. however , none of these mc algorithms are able to account for the existence of an anomalous regime with @xmath0 , and even , they also suffer from the existence of a super - critical slowing down as a direct consequence of the bimodality of the canonical energy distribution function .",
    "the existence of several canonical mc algorithms for this kind of models enables to perform a comparative study among their respective extended versions described below .",
    "the simplest and most general way to implement a thermal coupling with a bath at constant inverse temperature @xmath12 is by using the _ metropolis importance sample _ @xcite . in this method ,",
    "a metropolis move is carried out as follows :    1 .",
    "a site @xmath143 is chosen at random , and the initial spin state @xmath234 is changed ( also at random ) by considering any other of its @xmath1 admissible values .",
    "this move , from an initial state with energy @xmath11 and variation @xmath235 , is accepted in accordance with the transition probability:@xmath236   , 1\\right\\ }   .",
    "\\label{met.p}\\ ] ]    a mc step is produced after considering @xmath237 moves regardless of whether they have been accepted or rejected .",
    "the extension of this local algorithm with the consideration of an environment associated with an arbitrary probabilistic weight @xmath94 is achieved by using the transition probability ( [ t1 ] ) .",
    "clearly , eq.([t1 ] ) fulfils the detailed balance condition ( [ dbal ] ) .",
    "when the system size @xmath4 is sufficiently large , such a transition probability is practically given by eq.([t2 ] ) , which is exactly the canonical transition probability ( [ met.p ] ) modified by the inclusion of a variable inverse temperature , @xmath238 .",
    "remarkably , the transition probability ( [ t1 ] ) can be exactly rewritten in the form ( [ detailed.bal.omega ] ) by using the value @xmath239 corresponding to @xmath194 for the particular case of the linear ansatz ( [ ansatz.linear ] ) .",
    "this is a useful representation because both the initial and the final system configurations , @xmath189 and @xmath190 , are _ a priori _ known for this local mc method .",
    "other important mc methods are the so - called _ cluster algorithms _ , which are usually more efficient than any local mc method ( metropolis ) .",
    "however , the success of these methods is not universal because the proper cluster moves needed seem to be highly dependent on the system , and efficient cluster mc methods have only been found for a small number of models @xcite .",
    "the idea of using nonlocal moves was first suggested by swendsen - wang @xcite for the case of ising model and its generalizations , the potts models .",
    "such cluster algorithms are based on a mapping of this model system to a random cluster model of percolation throughout the equation : @xmath240   = \\sum_{\\left\\ {   n\\right\\ } } q^{n_{c}}p^{b}\\left ( 1-p\\right )   ^{nd - b } , \\label{cluster}%\\ ] ] where @xmath241 , @xmath242 is the number of bonds and @xmath243 the number of clusters .",
    "we shall consider in the present study the swendsen - wang cluster algorithm , whose scheme reads as follows :    1 .",
    "examine each nearest neighbor pair and create a bond with probability @xmath244 .",
    "that is , if the two nearest neighbor spins are the same , a bond is created between them with probability @xmath245 ; if spin values are different , there will be no bond .",
    "identify clusters as a set of sites connected by zero or more bonds ( i.e. , connected component of a graph ) .",
    "relabel each cluster with a fresh new value at random .",
    "the extension of this cluster mc method by using the present ideas is achieved by introducing a third step :    1 .",
    "redefine the inverse temperature of the bath @xmath246 employed to obtain the next system configuration @xmath247 by using the energy @xmath248 of the present configuration @xmath249 .",
    "while the bath inverse temperature @xmath12 is redefined after every local move in the metropolis importance sample , such a redefinition only takes place in a clusters algorithm as the swendsen - wang after every mc step because the clusters moves demand a constancy of the bath temperature .",
    "the present method is a simple example of extended canonical mc algorithm that does not fulfil the detailed balance condition ( [ dbal ] ) due to its using the approximated inverse temperature @xmath250 instead of the exact value @xmath251 with @xmath252/2 $ ] .",
    "as naturally expected , the violation of the detailed balance condition introduces finite size effects in the calculation of the expectation values of the thermal fluctuations , which affects the calculation of the heat capacity @xmath9 via eq.([cap.fluct ] ) .",
    "we have verified by mean of preliminary calculations that the use of the transition inverse temperature @xmath253 instead of the instantaneous value @xmath254 in the mc estimation of the expectation values : @xmath255 significantly reduces the incidence of such undesirable errors .",
    "[ t ]    2dpotts.eps      results of extensive mc calculations by using the extended version of metropolis importance sample ( hereafter referred to as extended mis ) are shown in fig.[2dpotts.eps ] .",
    "we are limited to consider here the 2d potts models with @xmath256 for several values of @xmath1 , where each point of these curves has been obtained from a mc run with @xmath257 steps .",
    "while the microcanonical curvature curve @xmath258 for the case @xmath259 only slightly touches the horizontal line with @xmath260 , the other cases with @xmath229 clearly exhibit negative values @xmath261 , that is , macrostates with negative heat capacities @xmath0 .",
    "this last observation evidences that the 2d potts model with @xmath259 undergoes a continuous phase transition , while the phase transition is discontinuous ( first - order ) for those cases with @xmath229 @xcite .",
    "[ t ]    comparative.eps    as expected , the anomalous macrostates with @xmath0 can not be accessed by using the ordinary metropolis importance sample ( hereafter referred to as canonical mis ) .",
    "this limitation is explicitly shown in fig.[comparative.eps ] for the particular case of the 2d @xmath262-state potts model .",
    "these results constitute a simple exemplification of the schematic behavior represented in fig.[caricature.eps ] . for a better understanding ,",
    "we also show here the corresponding energy distribution functions and the dynamical evolutions of the average system energy @xmath165 ( inset panel ) obtained from mc runs by considering both canonical mis and extended mis algorithms with @xmath263 .",
    "the stationary macrostates at @xmath264 and @xmath265 derived from the intersection of the microcanonical curve @xmath266 and the bath inverse temperature @xmath267 are thermodynamically stable within the canonical ensemble .",
    "consequently , the canonical energy distribution function is bimodal and its peaks are related to the coexisting phases . as consequence of such bimodality , the system energy exhibits eventual random transitions between the coexisting peaks , which lead to a slow equilibration of the corresponding average energy @xmath165 ( inset panel ) .",
    "the thermodynamic behavior radically changes when this system is put in a thermodynamic situation with non - vanishing correlated fluctuations @xmath268 , which is implemented here by considering a dependence @xmath269 , where @xmath263 , @xmath270 and @xmath271 , with @xmath272 being the curvature at the stationary point @xmath273 located within the anomalous region with @xmath0 .",
    "the canonically stable stationary points @xmath264 and @xmath265 become thermodynamically unstable and their corresponding peaks disappear from the energy distribution function .",
    "conversely , the canonically unstable stationary point @xmath273 now becomes thermodynamically stable , and its position determines the maximum of the only peak of the energy distribution function .",
    "once the bimodal character of the energy distribution function is suppressed , the average system energy @xmath274 shows fast convergence towards its equilibrium value @xmath273 ( inset panel ) .",
    "[ t ]    swcase.eps    a comparative study of a 2d 7-state potts model with @xmath256 by using the swendsen - wang cluster algorithm is shown in fig.[swcase.eps ] .",
    "although the canonical swendsen - wang method ( hereafter referred to as canonical sw ) is more efficient than the canonical mis , it is unable to describe the existence of an anomalous region with @xmath0 and suffers from a slow relaxation in this kind of situation , as it is clearly shown in fig.[swcase.eps ] .",
    "such limitations are circumvented by using its extended version ( hereafter referred to as extended sw ) . as the previously discussed example , the extended sw algorithm eliminates the bimodality of the energy distribution function for @xmath275 and leads to a fast convergence of the average energy per particle along the simulation .",
    "note also the remarkable agreement between the extended mis and extended sw algorithms despite the latter one does not fulfil the detailed balance condition ( [ dbal ] ) .",
    "this is a clear evidence that a suitable approximation of the inverse temperature @xmath193 of eq.([detailed.bal.omega ] ) is enough to provide a precise estimation of the microcanonical caloric curve @xmath63 as long as the system size is sufficiently large .",
    "the comparison among the above extended canonical mc algorithms and the known wang - landau sampling method @xcite is shown in fig.[compwlsw.eps ] .",
    "although these results exhibit very good consistency , one can note small but appreciable discrepancies within the anomalous region with @xmath0 .",
    "these relative differences are naturally expected due to two reasons .",
    "firstly , a direct numerical differentiation of the entropy @xmath276 ( inset panel ) obtained from the wang - landau method enhances the underlying statistical errors of its mc calculation , an therefore , the final result crucially depends on how one defines this mathematical operation for this discrete observable . on the other hand ,",
    "the work equation ( [ ave.inter ] ) is supported by the gaussian character of the energy distribution function @xmath277 , which arises as an asymptotic distribution when the system size @xmath4 is sufficiently large .",
    "clearly , the distribution function undergoes small deviations from the gaussian shape when @xmath4 is not as large .",
    "we shall show in a forthcoming paper that these size effects can be taken into account to improve the precision of some extended canonical mc algorithms .",
    "[ t ]    compwlsw.eps    overall , it is important to remark that the present proposal is focussed on the solution of the slow sampling problems observed in large - scale canonical mc simulations , that is , in systems undergoing a temperature driven discontinuous phase transition with sizes sufficiently large to support the gaussian approximation . in particular",
    ", the previous extended canonical mc algorithms can be useful to study potts models with many spin states and higher dimensions , as the cases shown in fig.[caloric.dim.eps ] , where we illustrate the caloric curves derived from mc simulations by using the extended sw algorithm for @xmath278 , @xmath279 , and a fixed number of lattice sites @xmath280 .",
    "the comparative study case with the wang - landau method shown in the inset panel allows us to verify that the agreement between these methods is more significant with the increasing of @xmath4 .",
    "[ t ]    caloric.dim.eps    to quantitatively characterize the efficiency of the previously discussed extended canonical mc methods , one should obtain the _ decorrelation time _",
    "@xmath3 , that is , the minimum number of mc steps needed to generate effectively independent , identically distributed samples in the markov chain .",
    "its calculation is performed here by using the expression : @xmath281 where @xmath282 is the variance of @xmath283 , which is defined as the arithmetic mean of the energy per particle @xmath284 over @xmath285 samples ( consecutive mc steps):@xmath286 this quantity is calculated for the particular mc runs considered in fig.[comparative.eps ] and fig.[swcase.eps ] .",
    "this study allows us to verify that the use of a variable dependence @xmath287 instead of a constant parameter @xmath12 enables the reduction of the decorrelation time of the metropolis importance sample from @xmath288 to @xmath289 .",
    "the improvement is even more significant for the swendsen - wang clusters algorithm , which experiences a reduction of the decorrelation time from @xmath290 to @xmath291 .",
    "[ t ]    size.eps    [ t ]    decorrelation.eps    let us now analyze the behavior of the decorrelation time @xmath3 with the increasing system size @xmath292 at the inverse temperature @xmath293 of the first - order phase transition .",
    "such a study demands the performance of preliminary calculations of the quantity @xmath293 due to its underlying dependence on the system size @xmath4 . for computational limitations ,",
    "we decide to restrict our analysis for the case of 2d 10-state potts model with @xmath294 , whose results are shown in fig.[size.eps ] .",
    "the entropy per particle @xmath295 was obtained from the second - order approximation of the power - expansion @xmath296 , which allows us a direct calculation of this thermodynamic function through the inverse temperature @xmath133 and curvature @xmath135 .",
    "these numerical results are shown in panel b ) of fig.[size.eps ] , or more exactly , the quantity @xmath297 , with @xmath298 being a suitable constant , which allows us to appreciate better the _ convex intruder _ of the entropy accounting for the existence of macrostates with @xmath0 .",
    "the mathematical form of this last anomaly enables the acquisition of the latent heat @xmath299 and the entropy - loss per particle @xmath300 associated with the existence of _ surface correlations _",
    "@xcite , and @xmath301 represent the three stationary points where the caloric curve @xmath302 takes the value of the phase transition inverse temperature @xmath293 .",
    "it worth to clarify that the critical value @xmath293 is simply the point of discontinuity of the first derivative of the planck thermodynamic potential @xmath303 estimated from the microcanonical entropy @xmath304 via the legrendre s transformation : @xmath305.\\ ] ] in fact , once obtained the microcanonical entropy @xmath89 , one can calculate any thermo - statistical quantity by using the canonical distribution function : @xmath306 relevant physical observables and thermodynamic parameters derived from this type of analysis are summarized in table [ observables ] .    [ c]|c|c|c|c|c|@xmath307 & @xmath308 & @xmath309 & @xmath310 & @xmath311 + @xmath293 & @xmath312 & @xmath313 & @xmath314 & @xmath315 + @xmath316 & @xmath317 & @xmath317 & @xmath318 & @xmath319 + @xmath320 & @xmath321 & @xmath322 & @xmath323 & @xmath324 + @xmath325 & @xmath326 & @xmath327 & @xmath328 & @xmath329 + @xmath79 & @xmath330 & @xmath331 & @xmath332 & @xmath333 + @xmath334 & @xmath335 & @xmath336 & @xmath337 & @xmath338 +    results of extensive calculations of dependencies of the decorrelation time @xmath3 _ versus _ the system size @xmath4 at the point of phase transition @xmath293 are shown in fig.[decorrelation.eps ] .",
    "it is clearly evident that the extended mc methods are always much more efficient than their respective canonical counterparts .",
    "in particular , the extended sw method reduces the exponential growth of the decorrelation time @xmath3 with @xmath4 to a weak power - law dependence @xmath5 with @xmath339 .",
    "as expected , the extended mis is less efficient than the extended sw .",
    "however , the @xmath4-dependence of its corresponding decorrelation time @xmath3 does not differ in a significant way from the one associated with the cluster algorithm .",
    "since the calculation of the decorrelation time @xmath3 of the canonical mc methods demands very large mc runs , we use the @xmath340 extrapolation in order to obtain some rough estimates of the non - equilibrated points .    according to berg @xcite ,",
    "the multicanonical method and its variant are able to reduce the exponential divergence of the decorrelation time @xmath3 to a power dependence with typical exponent @xmath341 .",
    "although such a power - law behavior accounts for a less efficient convergence than the one achieved by using present proposal , it is important to remark that the multicanonical methods possibilities an effective exploration of the entire energy region in a single mc run .",
    "conversely , our methodology only explores a small energy region @xmath342 with a typical width @xmath343 , so that , a minimum of @xmath344 mc runs are required to study the same energy range of multicanonical methods .",
    "thus , the size dependence the number of mc samples @xmath285 can be estimated by considering the number of mc runs @xmath345 and the decorrelation time @xmath3 as follows : @xmath346 which leads to the effective exponent @xmath347 .",
    "such an effective power - law growth still considers a more efficient convergence rate than the one associated with multicanonical methods , overall , when one also takes into account the fact that these re - weighting techniques demand a preliminary reconstruction of the probabilistic weight @xmath94 , which is a procedure that consumes a significant fraction of the available computational resources .",
    "[ t ]    lambda.eps    let us finally reconsider the question about the optimal value of the coupling constant @xmath128 that allows to achieve the best efficiency by using an extended canonical mc algorithm .",
    "an example of such a study is shown in fig.[lambda.eps ] , where we illustrate the behavior of the decorrelation time @xmath3 and the total dispersion @xmath348 for positive values of the coupling constant @xmath128 .",
    "the data was obtained from mc simulations of the 2d @xmath349-state potts model with @xmath350 by using the extended sw clusters algorithm with environment inverse temperature @xmath351 , whose parameters @xmath352 and @xmath353 in order to access the canonically unstable stationary macrostate @xmath320 located within the anomalous region with @xmath0 at the point of the first - order phase transition @xmath293 .",
    "as expected , the decorrelation time @xmath3 and the total dispersion @xmath354 show large values when the coupling constant @xmath128 is close to zero as a consequence of the imposition of the external conditions associated with the canonical ensemble ( [ gibbs ] ) , where take place thermodynamic instability of the macrostates with @xmath0 and the bimodal character of the energy distribution function @xmath277 .",
    "the increase of the coupling parameter @xmath128 for values that obeys the condition ( [ ceq ] ) produces a progressive reduction of the energy dispersion @xmath120 in eq.([dispersions ] ) .",
    "this last behavior leads to a reduction of the decorrelation time @xmath3 due to the mc sampling performs a faster exploration for a smaller energetic region .",
    "however , the decorrelation time @xmath3 starts to grow after reach its minimum value at a certain @xmath355 since the system configurations @xmath189 can not be modified in an appreciable way by the mc sampling if the energy is only allowed to undergo too small changes around its equilibrium value .    for",
    "a general case of the environment inverse temperature ( [ ansatz.linear ] ) with @xmath118 , both the system fluctuating behavior and the decorrelation time depend on the particular value of the coupling constant @xmath128 .",
    "in such cases , the efficiency of an extended canonical mc method can be evaluated throughout the minimal number of mc steps needed to achieve a certain precision in the calculation of a given thermo - statistical observable . the statistical error @xmath356 associated with a set of @xmath345 independent outcomes @xmath357",
    "can be estimated from the standard deviation @xmath358 as @xmath359 . in mc calculations ,",
    "independent samples are only obtained after considering a number of mc steps equal to the decorrelation time @xmath3 .",
    "thus , the number of mc steps @xmath360 needed to obtain an estimation of a given point @xmath361 of the caloric curve with a precision @xmath362 can be evaluated in terms of the decorrelation time @xmath3 , the total dispersion @xmath354 and the system size @xmath4 as follows : @xmath363 the quantity @xmath364 could be referred to as the _ efficiency factor_. clearly , a _ dynamic criterion _ in order to provide an optimal value of the coupling constant @xmath128 to achieve the best efficiency by using this kind of mc calculations is given by minimizing the efficiency factor @xmath29 .    according to the data shown in fig.[lambda.eps ] ,",
    "the value of the coupling constant @xmath365 corresponding to the minimum of the efficiency factor @xmath29 is located within the interval between the position of the minimum @xmath355 of the decorrelation time @xmath3 and the minimum @xmath366 of the total dispersion @xmath354 , @xmath367 $ ] .",
    "remarkably , the efficiency factor @xmath29 does not change in a significant way within this last interval . by considering this last observation and the fact that the calculation of the correlation time @xmath3 demands extensive calculations",
    ", one can realize that the value of the coupling constant @xmath366 corresponding to the minimum of the total dispersion @xmath354 , eq.([optimal ] ) , provides a good value in order to perform a very efficient mc calculation of the caloric curve by using extended canonical algorithms . in general",
    ", it is always convenient to keep as small as possible the value of the coupling constant @xmath128 .",
    "indeed , the statistical error @xmath368 involved in the mc calculation of the standard deviation @xmath369 considered to obtain the system curvature @xmath370 from eq.([cap.fluct ] ) leads to the existence of a statistical error @xmath371 , which grows with the increase of the coupling constant @xmath128 .",
    "we have shown that conventional monte carlo methods based on the consideration of the gibbs canonical ensemble ( [ gibbs ] ) can be easily extended in order to capture the existence of an anomalous regime with negative heat capacities and avoid the incidence of the super - critical slowing down .",
    "the key ingredient is to replace the use of a bath with an infinite heat capacity by an environment with a finite heat capacity that obeys thirring s constrain ( [ thir.const ] ) .",
    "such an equilibrium situation , characterized by the existence of non - vanishing correlations @xmath372 , is inspired on the generalized equilibrium fluctuation - dissipation relation ( [ tur ] ) , which allows to introduce several improvements to the methodology of gerling and hller based on the consideration of the dynamical ensemble ( [ ghens ] ) .",
    "the way to introduce an environment with a variable inverse temperature @xmath10 depends on the own features of each canonical monte carlo method , although such a question seems not to be a difficult problem in the case of classical algorithms . while it could be desirable that the implementation of this kind of methodology obeyed the detailed balance condition ( [ dbal ] ) ,",
    "the application examples considered in the section [ examples ] show that one can still obtain a good mc estimation of the microcanonical caloric curve @xmath63 without fulfilling the detailed balance as long as the system under analysis be sufficiently large .    before concluding this section",
    ", it is worthwhile to mention that eq.([tur ] ) constitutes a particular case of a more general equilibrium fluctuation - dissipation theorem , which accounts for the system fluctuating behavior in a thermodynamic situation characterized by the incidence of several control parameters @xcite . roughly speaking",
    ", this theorem provides a general extension of some other well - known fluctuation relations such as the one involving the isothermal magnetic susceptibility and magnetization fluctuations of a magnetic system , @xmath373 , or the isothermal compressibility and volume fluctuations of a fluid system , @xmath374 , which are compatible with the existence of anomalous response functions , e.g. , negative isothermal susceptibilities @xmath375 or negative isothermal compressibilities @xmath376 .",
    "clearly , this general theorem suggests a direct extension of the present methodology in order to enhance mc methods based on the so - called boltzmann - gibbs distributions : @xmath377dedx\\ ] ] to account for the existence of macrostates with anomalous response functions .",
    "it is a pleasure to acknowledge partial financial support by fondecyt 3080003 .",
    "l.velazquez also thanks the partial financial support by the project pncb-16/2004 of the cuban national programme of basic sciences .",
    "b. a. berg , in _ proceedings of the international conference on multiscale phenomena and their simulations _ ,",
    "bielefeld , oct .",
    "1996 , eds .",
    "f. karsch , b. monien and h. satz ( world scientific , singapore , 1997 ) ."
  ],
  "abstract_text": [
    "<S> in this work , we discuss the implications of a recently obtained equilibrium fluctuation - dissipation relation on the extension of the available monte carlo methods based on the consideration of the gibbs canonical ensemble to account for the existence of an anomalous regime with negative heat capacities @xmath0 . </S>",
    "<S> the resulting framework appears as a suitable generalization of the methodology associated with the so - called _ dynamical ensemble _ , which is applied to the extension of two well - known monte carlo methods : the metropolis importance sample and the swendsen - wang clusters algorithm . </S>",
    "<S> these monte carlo algorithms are employed to study the anomalous thermodynamic behavior of the potts models with many spin states @xmath1 defined on a @xmath2-dimensional hypercubic lattice with periodic boundary conditions , which successfully reduce the exponential divergence of decorrelation time @xmath3 with the increase of the system size @xmath4 to a weak power - law divergence @xmath5 with @xmath6 for the particular case of the 2d 10-state potts model . </S>"
  ]
}