{
  "article_text": [
    "given probability densities @xmath14 with respect to lebesgue measure @xmath15 on @xmath16 , and a cost function @xmath17 $ ] , monge s transportation problem is to find a map @xmath18 pushing @xmath19 forward to @xmath20 which minimizes the expected transportation cost @xcite @xmath21 where @xmath22 means @xmath23 = \\mu^+[g^{-1}(y)]$ ] for each borel @xmath24 .    in this context",
    "it is interesting to know when a map attaining this infimum exists ; sufficient conditions for this were found by gangbo @xcite and by levin @xcite , extending work of a number of authors described in @xcite @xcite .",
    "one may also ask when @xmath25 will be smooth , in which case it must satisfy the prescribed jacobian equation @xmath26 , which turns out to reduce to a degenerate elliptic partial differential equation of monge - ampre type for a scalar potential @xmath27 satisfying @xmath28 .",
    "sufficient conditions for this were discovered by ma , trudinger and wang @xcite and trudinger and wang @xcite @xcite , after results for the special case @xmath29 had been worked out by brenier @xcite , delane @xcite , caffarelli @xcite @xcite @xcite @xcite @xcite , and urbas @xcite , and for the cost @xmath30 and measures supported on the unit sphere by wang  @xcite . if the ratio @xmath31  although bounded away from zero and infinity",
    " is not continuous , the map @xmath25 will not generally be differentiable , though one may still hope for it to be continuous .",
    "this question is not merely of academic interest , since discontinuities in @xmath11 arise unavoidably in applications such as partial transport problems @xcite",
    "@xcite @xcite @xcite .",
    "such results were established for the classical cost @xmath32 by caffarelli @xcite",
    "@xcite @xcite , for its restriction to the product of the boundaries of two strongly convex sets by gangbo and mccann @xcite , and for more general costs satisfying the strong regularity hypothesis * ( a3 ) * of ma , trudinger and wang @xcite  which excludes the cost @xmath32  by loeper @xcite ; see also @xcite @xcite @xcite . under the weaker and",
    "degenerate hypothesis * ( a3w ) * of trudinger and wang @xcite , which includes the cost @xmath32 ( and whose necessity for regularity was shown by loeper @xcite ) , such a result remains absent from the literature ; we aim to provide it below under a slight strengthening of their condition ( still including the quadratic cost ) which appeared in kim and mccann @xcite@xcite , called _ non - negative cross - curvature_. ( related but different families of strengthenings were investigated by loeper and villani @xcite and figalli and rifford @xcite . )",
    "our main result is stated in theorem  [ t : hoelder ] .",
    "a number of interesting cost functions do satisfy non - negative cross - curvature hypothesis , and have applications in economics @xcite and statistics @xcite .",
    "examples include the euclidean distance between two convex graphs over two sufficiently convex sets in @xmath16 @xcite , the riemannian distance squared on multiple products of round spheres ( and their riemannian submersion quotients , including products of complex projective spaces @xmath33 ) @xcite , and the simple harmonic oscillator action @xcite . in a sequel",
    ", we apply the techniques developed here to deduce regularity of optimal maps in the latter setting @xcite .",
    "moreover , theorem  [ t : hoelder ] allows one to apply the higher interior regularity results established by liu , trudinger and wang @xcite , ensuring in particular that the transport map is @xmath34-smooth if @xmath35 and @xmath36 are",
    ". +    most of the regularity results quoted above derive from one of two approaches .",
    "the continuity method , used by delano , urbas , ma , trudinger and wang , is a time - honored technique for solving nonlinear equations .",
    "here one perturbs a manifestly soluble problem ( such as @xmath37 with @xmath38 , so that @xmath39 ) to the problem of interest ( @xmath40 , @xmath41 ) along a family @xmath42 designed to ensure the set of @xmath43 $ ] for which it is soluble is both open and closed .",
    "openness follows from linearization and non - degenerate ellipticity using an implicit function theorem . for the non - degenerate ellipticity and closedness",
    ", it is required to establish estimates on the size of derivatives of the solutions ( assuming such solutions exist ) which depend only on information known a priori about the data @xmath44 . in this way one obtains smoothness of the solution @xmath45 from the same argument which shows @xmath46 to exist .",
    "the alternative approach relies on first knowing existence and uniqueness of a borel map which solves the problem in great generality , and then deducing continuity or smoothness by close examination of this map after imposing additional conditions on the data @xmath47 .",
    "although precursors can be traced back to alexandrov @xcite , in the present context this method was largely developed and refined by caffarelli @xcite",
    "@xcite @xcite , who used convexity of @xmath27 crucially to localize the map @xmath48 and renormalize its behaviour near a point @xmath49 of interest in the borderline case @xmath50 . for non - borderline",
    "* ( a3 ) * costs , simpler estimates suffice to deduce continuity of @xmath25 , as in @xcite @xcite @xcite @xcite ; in this case loeper was actually able to deduce an explicit bound @xmath51 on the hlder exponent of @xmath25 when @xmath52 , which was recently improved to its sharp value @xmath53 by liu @xcite using a technique related to the one we develop below and discovered independently from us ; both loeper and liu also obtained explicit exponents @xmath54 for @xmath55 with @xmath56 @xcite or @xmath57 @xcite and @xmath58 .",
    "explicit bounds on the exponent are much worse in the classical case @xmath50 @xcite , when such exponents do not even exist unless @xmath59 @xcite @xcite .",
    "+ below we extend the approach of caffarelli to non - negatively cross - curved costs , a class which includes the classical quadratic cost .",
    "our idea is to add a null lagrangian term to the cost and exploit diffeomorphism ( i.e.  gauge ) invariance to choose coordinates which depend on the point of interest that restore convexity of @xmath60 ; our strengthened hypothesis then permits us to exploit caffarelli s approach more systematically than liu was able to do @xcite .",
    "however , we still need to overcome serious difficulties , such as getting an alexandrov estimate for @xmath7-subdifferentials ( see section  [ s : alexandrov ] ) and dealing with the fact that the domain of the cost function ( where it is smooth and satisfies appropriate cross - curvature conditions ) may not be the whole of @xmath16 .",
    "( this situation arises , for example , when optimal transportation occurs between domains in riemannian manifolds for the distance squared cost or similar type . )",
    "the latter is accomplished using theorem  [ thm : bdry - inter ] , where it is first established that optimal transport does not send interior points to boundary points , and vice versa , under the strong @xmath7-convexity hypothesis * ( b2u ) *  described in the next section .",
    "( for this result to hold , the cost needs not to satisfy the condition * ( a3w)*. ) without our strengthening of trudinger and wang s hypothesis @xcite ( i.e.  with only * ( a3w ) * ) , we obtain the convexity of all level sets of @xmath60 in our chosen coordinates as liu also did ; this yields some hope of applying caffarelli s method and the full body of techniques systematized in gutierrez @xcite , but we have not been successful at overcoming the remaining difficulties in such generality . in two dimensions",
    "however , there is an alternate approach to establishing continuity of optimal maps which applies to this more general case ; it was carried out by figalli and loeper @xcite , but relies on theorem  [ thm : bdry - inter ] , first proved below .",
    "let us begin by formulating the relevant hypothesis on the cost function @xmath2 in a slightly different format than ma , trudinger and wang @xcite . for each @xmath61 assume",
    ": + * ( b0 ) *   @xmath62 and @xmath63 are open and bounded and @xmath64 ; + * ( b1 ) *   ( bi - twist ) @xmath65 are diffeomorphisms onto their ranges ; + * ( b2 ) *   ( bi - convex ) @xmath66 are convex subsets of @xmath16 ; + * ( b3 ) *   ( non - negative cross - curvature ) @xmath67 : = -\\frac{\\partial^4}{\\partial s^2 \\partial t^2}\\bigg|_{(s , t)=(0,0 ) } c(x(s),y(t ) ) \\ge 0\\ ] ] for every curve @xmath68 \\longmapsto \\big(d_y c(x(t),y(0)),d_x c(x(0),y(t))\\big ) \\in { \\mathbf{r}}^{2n}$ ] which is an affinely parameterized line segment .",
    "+ if the convex domains @xmath69 and @xmath70 in * ( b2 ) *  are all strongly convex , we say * ( b2u ) *  holds . here a convex set @xmath62 is said to be _ strongly _ convex if there exists a radius @xmath71 ( depending only on @xmath72 , ) such that each boundary point @xmath73 can be touched from outside by a sphere of radius @xmath74 enclosing @xmath75 ; i.e. @xmath76 where @xmath77 is an outer unit normal to a hyperplane supporting @xmath75 at @xmath78 .",
    "when @xmath75 is smooth , this means all principal curvatures of its boundary are bounded below by @xmath79 .",
    "hereafter @xmath80 denotes the closure of @xmath75 , @xmath81 denotes its interior , @xmath82 its diameter , and for any measure @xmath83 on @xmath80 , we use the term _ support _ and the notation @xmath84 to refer to the smallest closed set carrying the full mass of @xmath85 .    condition * ( b3 ) *   is the above - mentioned strengthening of trudinger and wang s criterion * ( a3w ) * guaranteeing smoothness of optimal maps in the monge transportation problem ( [ monge ] ) ; unlike us , they require ( [ mtw ] ) only if , in addition @xcite , @xmath86 necessity of trudinger and wang s condition for continuity was shown by loeper @xcite , who noted its covariance ( as did @xcite @xcite ) and some relations to curvature .",
    "their condition relaxes the hypothesis * ( a3 ) * proposed earlier with ma @xcite , which required strict positivity of ( [ mtw ] ) when ( [ nullity ] ) holds .",
    "the strengthening considered here was first studied in a different but equivalent form by kim and mccann @xcite , where both the original and the modified conditions were shown to correspond to pseudo - riemannian sectional curvature conditions induced by the cost @xmath7 on @xmath87 , highlighting their invariance under reparametrization of either @xmath75 or @xmath88 by diffeomorphism ; see ( * ? ? ?",
    "* lemma 4.5 ) .",
    "the convexity of @xmath69 required in * ( b2 ) *   is called _",
    "@xmath7-convexity of @xmath72 with respect to @xmath89 _ by ma , trudinger and wang ( or strong @xmath7-convexity if * ( b2u ) *  holds ) ; they call curves @xmath90 , for which @xmath91 \\longmapsto -d_y c(x(s),{{\\tilde y}})$ ] is a line segment ,",
    "_ @xmath7-segments with respect to @xmath89_. similarly , @xmath88 is said to be strongly @xmath92-convex with respect to @xmath78  or with respect to @xmath80 when it holds for all @xmath93  and the curve @xmath94 from is said to be a @xmath92-segment with respect to @xmath78 .",
    "such curves correspond to geodesics @xmath95 and @xmath96 in the geometry of kim and mccann . here and throughout , _",
    "line segments _ are always presumed to be affinely parameterized .",
    "we are now in a position to summarize our main result :    [ t : hoelder ] let @xmath97 satisfy * ( b0)**(b3 ) *  and * ( b2u)*. fix probability densities @xmath98 and @xmath99 with @xmath100 and set @xmath101 .",
    "if the ratio @xmath102 for some open set @xmath103 , then the minimum ( [ monge ] ) is attained by a map @xmath104 whose restriction to @xmath8 is continuous and one - to - one .    as recalled below in section [",
    "s : background ] ( or see e.g.  @xcite ) it is well - known by kantorovich duality that the optimal joint measure @xmath105 from vanishes outside the @xmath7-subdifferential of a potential @xmath106 satisfying the @xmath7-convexity hypothesis , and that the map @xmath104 which we seek is uniquely recovered from this potential using the diffeomorphism * ( b1 ) *  to solve .",
    "thus the continuity claimed in theorem [ t : hoelder ] is equivalent to @xmath107 .",
    "since @xmath108 do not charge the boundaries of @xmath75 ( or of @xmath88 ) , lemma [ l : cma properties](e ) shows the @xmath7-monge - ampre measure defined in has density satisfying @xmath109 on @xmath80 and @xmath110 on @xmath8 . thus @xmath111 according to theorem [ t : continuity ] .",
    "injectivity of @xmath25 follows from theorem [ t : strict convex ] , and the fact that the graph of @xmath25 is contained in the set @xmath112 of .     note that in case @xmath113 is continuous and compactly supported , choosing @xmath114 for all @xmath115 , yields continuity and injectivity of the optimal map @xmath116 throughout @xmath117 .",
    "theorem [ t : hoelder ] provides a necessary prerequisite for the higher interior regularity results established by liu , trudinger and wang in @xcite  a prerequisite which one would prefer to have under the weaker hypotheses * ( b0)**(b2 ) *  and * ( a3w)*. note that these interior regularity results can be applied to manifolds , after getting suitable stay - away - from - the - cut - locus results : this is accomplished for multiple products of round spheres in @xcite , to yield the first regularity result that we know for optimal maps on riemannian manifolds which are not flat , yet have some vanishing sectional curvatures .",
    "kantorovich discerned @xcite @xcite that monge s problem ( [ monge ] ) could be attacked by studying the linear programming problem @xmath118 here @xmath119 consists of the joint probability measures on @xmath120 having @xmath108 for marginals . according to the duality theorem from linear programming ,",
    "the optimizing measures @xmath121 vanish outside the zero set of @xmath122 for some pair of functions @xmath123 satisfying @xmath124 these arise as optimizers of the dual program .",
    "this zero set is called the @xmath7-subdifferential of @xmath27 , and denoted by @xmath125 we also write @xmath126 , and @xmath127 , and @xmath128 for @xmath129 . formula ( [ c - transform ] ) defines a generalized legendre - fenchel transform called the _",
    "@xmath7-transform _ ; any function satisfying @xmath130 is said to be _",
    "@xmath7-convex _ , which reduces to ordinary convexity in the case of the cost @xmath50 . in that case",
    "@xmath131 reduces to the ordinary subdifferential @xmath132 of the convex function @xmath27 , but more generally we define @xmath133 @xmath134 , and @xmath135 . assuming @xmath136 ( which is the case if * ( b0 ) *  holds ) , any @xmath7-convex function @xmath137 will be semi - convex , meaning its hessian admits a bound from below @xmath138 in the distributional sense ; equivalently , @xmath139 is convex on each ball in @xmath75 @xcite",
    ". in particular , @xmath27 will be twice - differentiable @xmath15-a.e .",
    "on @xmath75 in the sense of alexandrov .    as in @xcite @xcite @xcite , hypothesis * ( b1 ) *   shows the map @xmath140 is uniquely defined on the set @xmath141 of differentiability for @xmath27 by @xmath142 the graph of @xmath25 , so - defined , lies in @xmath131 .",
    "the task at hand is to show continuity and injectivity of @xmath25  the former being equivalent to @xmath143  by studying the relation @xmath144 .    to this end",
    ", we define a borel measure @xmath145 on @xmath16 associated to @xmath27 by latexmath:[\\[\\label{c - monge - ampere measure }    @xmath129 ; it will be called the _ @xmath7-monge - ampre measure _ of @xmath27 .",
    "( similarly , we define @xmath147 . )",
    "we use the notation @xmath148 on @xmath8 as a shorthand to indicate @xmath149 for each @xmath150 ; similarly , @xmath151 indicates @xmath152 . as the next lemma shows , uniform bounds above and below on the marginal densities of a probability measure @xmath121 vanishing outside @xmath131 imply similar bounds on @xmath153 .",
    "[ l : cma properties ] let @xmath7 satisfy * ( b0)*-*(b1 ) * , while @xmath9 and @xmath154 denote @xmath7-convex functions for each @xmath155 . fix @xmath156 and constants @xmath157 . + ( a )",
    "then @xmath158 and @xmath159 is a borel measure of total mass @xmath160 on @xmath161 .",
    "( b ) if @xmath162 uniformly , then @xmath163 is @xmath7-convex and @xmath164 weakly-@xmath165 in the duality against continuous functions on @xmath166 .",
    "+ ( c ) if @xmath167 for all @xmath168 , then the functions @xmath154 converge uniformly if and only if the measures @xmath169 converge weakly-@xmath165 .",
    "+ ( d ) if @xmath170 on @xmath80 , then @xmath171 on @xmath172 . +",
    "( e ) if a probability measure @xmath173 vanishes outside @xmath174 , and has marginal densities @xmath11 , then @xmath175 on @xmath176 and @xmath177 on @xmath172 imply @xmath178 on @xmath8 , whereas @xmath179 on @xmath8 and @xmath180 on @xmath172 imply @xmath181 on @xmath8 .",
    "\\(a ) the fact @xmath182 is an immediate consequence of definition ( [ c - subdifferential ] ) . since @xmath183",
    ", the @xmath7-transform @xmath184 defined by ( [ c - transform ] ) can be extended to a lipschitz function on a neighbourhood of @xmath172 , hence rademacher s theorem asserts @xmath185 is a set of full lebesgue measure in @xmath172 .",
    "use * ( b1 ) *  to define the unique solution @xmath186 to @xmath187 as in @xcite @xcite , the vanishing of @xmath122 implies @xmath188 , at least for all points @xmath189 where @xmath172 has lebesgue density greater than one half . for borel @xmath129",
    ", this shows @xmath190 differs from the borel set @xmath191 by a @xmath15 negligible subset of @xmath172 , whence @xmath192 so claim ( a ) of the lemma is established .",
    "\\(b ) let @xmath193 .",
    "it is not hard to deduce @xmath7-convexity of @xmath163 , as in e.g.  @xcite .",
    "define @xmath194 and @xmath195 on @xmath196 as above , so that @xmath197 .",
    "moreover , @xmath198 in @xmath199 , where @xmath200 is the @xmath201-dual to @xmath202 .",
    "the uniform semiconvexity of @xmath203 ( i.e. convexity of @xmath204 ) ensures pointwise convergence of @xmath205 @xmath15-a.e .  on @xmath172 . from @xmath206",
    "we deduce @xmath207 @xmath15-a.e .  on @xmath172 .",
    "this is enough to conclude @xmath208 , by testing the convergence against continuous functions and applying lebesgue s dominated convergence theorem .",
    "\\(c ) to prove the converse , suppose @xmath154 is a sequence of @xmath7-convex functions which vanish at @xmath78 and @xmath209 weakly-@xmath165 .",
    "since the @xmath154 have lipschitz constants dominated by @xmath210 and @xmath161 is compact , any subsequence of the @xmath154 admits a convergent further subsequence by the ascoli - arzel theorem . a priori ,",
    "the limit @xmath163 might depend on the subsequences , but ( b ) guarantees @xmath211 , after which ( * ? ? ?",
    "* proposition 4.1 ) identifies @xmath163 uniquely in terms of @xmath212 and @xmath213 , up to an additive constant ; this arbitrary additive constant is fixed by the condition @xmath214 .",
    "thus the whole sequence @xmath154 converges uniformly .",
    "\\(e ) now assume a finite measure @xmath173 vanishes outside @xmath215 and has marginal densities @xmath11 .",
    "then the second marginal @xmath216 of @xmath121 is absolutely continuous with respect to lebesgue and @xmath121 vanishes outside the graph of @xmath217 , whence @xmath218 by e.g.  ( * ? ? ?",
    "* lemma 2.1 ) .",
    "( here @xmath219 denotes the identity map , restricted to the domain @xmath220 of definition of @xmath221 . )",
    "recalling that @xmath192 ( see the proof of ( a ) above ) , for any borel @xmath222 we have @xmath223whenever @xmath224 and @xmath179 .",
    "we can also reverse the last four inequalities and interchange @xmath225 with @xmath226 to establish claim ( e ) of the lemma .",
    "\\(d ) the last point remaining follows from ( e ) by taking @xmath227 .",
    "indeed an upper bound @xmath225 on @xmath228 throughout @xmath161 and lower bound @xmath229 on @xmath15 translate into a lower bound @xmath230 on @xmath231 , since the reflection @xmath232 defined by @xmath233 for each @xmath234 vanishes outside @xmath235 and has second marginal absolutely continuous with respect to lebesgue by the hypothesis @xmath236 .    differentiating ( [ implicit g ] )",
    "formally with respect to @xmath78 and recalling @xmath237 yields the monge - ampre type equation @xmath238 } { |\\det d^2_{xy } c({{\\tilde x}},g({{\\tilde x}}))| } = \\frac{f^+({{\\tilde x}})}{f^-(g({{\\tilde x}}))}\\ ] ] on @xmath75 , where @xmath239 is given as a function of @xmath78 and @xmath240 by ( [ implicit g ] ) .",
    "degenerate ellipticity follows from the fact that @xmath116 produces equality in @xmath241 .",
    "a condition under which @xmath7-convex weak-@xmath165 solutions are known to exist is given by @xmath242 the boundary condition @xmath243 which then guarantees @xmath244 to be uniquely determined @xmath35-a.e .",
    "is built into our definition of @xmath7-convexity .",
    "in fact , ( * ? ? ? * proposition 4.1 ) shows @xmath9 to be uniquely determined up to additive constant if either @xmath245 or @xmath246 @xmath15-a.e . on its connected domain , @xmath75 or @xmath88 .",
    "a key result we shall exploit several times is a maximum principle first deduced from trudinger and wang s work @xcite by loeper ; see ( * ? ? ?",
    "* theorem 3.2 ) . a simple and direct proof , and also an extension can be found in ( * ? ? ?",
    "* theorem 4.10 ) , where the principle was also called ` double - mountain above sliding - mountain ' ( * dasm * ) . other proofs and extensions appear in @xcite @xcite @xcite @xcite @xcite :    [ t : dasm ] assume * ( b0)**(b2 ) *  and * ( a3w ) *  and fix @xmath247 . if @xmath248 \\longmapsto -d_x c({{\\tilde x}},y(t))$ ] is a line segment then @xmath249 for all @xmath250 $ ] .",
    "it is through this theorem and the next that hypothesis * ( a3w ) *  and the non - negative cross - curvature hypothesis * ( b3)*enter crucially . among the many corollaries loeper deduced from this result",
    ", we shall need two .",
    "proved in ( * ? ? ?",
    "* theorem 3.1 and proposition 4.4 ) ( alternately ( * ? ? ?",
    "* theorem 3.1 ) and ( * ? ? ? * a.10 ) ) , they include the @xmath7-convexity of the so - called _ contact set _ ( meaning the @xmath251-subdifferential at a point ) , and a local to global principle .",
    "[ c : local - global ] assume * ( b0)**(b2 ) *  and * ( a3w ) *  and fix @xmath252 .",
    "if @xmath9 is @xmath7-convex then @xmath253 is @xmath251-convex with respect to @xmath254 , i.e.  @xmath255 forms a convex subset of @xmath256 .",
    "furthermore , any local minimum of the map @xmath257 is a global minimum .    as shown in (",
    "* corollary 2.11 ) , the strengthening * ( b3 ) *  of hypothesis * ( a3w ) *  improves the conclusion of loeper s maximum principle .",
    "this improvement asserts that the altitude @xmath258 at each point of the evolving landscape then accelerates as a function of @xmath248 $ ] :    [ t : time - convex dasm ] assume * ( b0)**(b3 ) *  and fix @xmath247 . if @xmath248 \\longmapsto -d_xc({{\\tilde x}},y(t))$ ] is a line segment then @xmath250 \\longmapsto f(t ) : = -c(x , y(t ) ) + c({{\\tilde x}},y(t))$ ] is convex .",
    "[ rmk : symmetry]since all assumptions * ( b0)**(b3 ) *  and * ( a3w ) *  on the cost are symmetric in @xmath0 and @xmath1 , all the results above still hold when exchanging @xmath0 with @xmath1 .",
    "in this section , we set up the notation for the rest of the paper . recall that @xmath259 is a non - negatively cross - curved cost function satisfying * ( b1)**(b3 ) *  on a pair of bounded domains @xmath75 and @xmath88 which are strongly @xmath7-convex with respect to each other * ( b2u)*.    fix @xmath260 and an open domain @xmath261 , and let @xmath27 be a @xmath7-convex solution of the @xmath7-monge - ampre equation @xmath262 we sometimes abbreviate by writing @xmath263 $ ] . in the following sections , we will prove interior differentiability of @xmath27 on @xmath264 , that is @xmath265 ; see theorem [ t : continuity ]",
    ".    throughout @xmath266 will denote the derivative with respect to the variable @xmath1 , and iterated subscripts as in @xmath267 denote iterated derivatives .",
    "we also use @xmath268 to denote the bi - lipschitz constants @xmath269 of the coordinate changes ( [ q of x ] ) and the jacobian bounds @xmath270 for the same transformation .",
    "notice @xmath271 for any cost satisfying * ( b1 ) * , and equality holds whenever the cost function @xmath2 is quadratic .",
    "so the parameter @xmath272 crudely quantifies the departure from the quadratic case .",
    "the inequality @xmath273 is much more rigid , equality implying @xmath274 is the identity matrix , and not merely constant .      in the current subsection",
    ", we introduce an important transformation ( mixing dependent and independent variables ) for the cost @xmath2 and potential @xmath60 , which plays a crucial role in the subsequent analysis .",
    "this change of variables and its most relevant properties are encapsulated in the following definition and theorem .",
    "_ in the sequel , whenever we use the expression @xmath275 or @xmath276 we refer to the modified cost function and convex potential defined here , unless otherwise stated .",
    "_ since properties * ( b0)**(b3 ) * , * ( a3w )",
    "*  and * ( b2u ) *  were shown to be tensorial in nature ( i.e.  coordinate independent ) in @xcite @xcite , the modified cost @xmath277 inherits these properties from the original cost @xmath7 with one exception : ( [ x of q ] ) defines a @xmath278 diffeomorphism @xmath279 , so the cost @xmath280 may not be @xmath281 smooth .",
    "however , its definition reveals that we may still differentiate @xmath277 four times as long as no more than three of the four derivatives fall on the variable @xmath282 , and it leads to the same geometrical structure ( pseudo - riemannian curvatures , including ( [ mtw ] ) ) as the original cost @xmath7 since the metric tensor and symplectic form defined in @xcite involve only mixed derivatives @xmath283 , and therefore remain @xmath284 functions of the coordinates @xmath285 .",
    "[ d : cost exponential ] given @xmath64 strongly twisted * ( b0)**(b1 ) * , we refer to the coordinates @xmath286 defined by @xmath287 as the _ cost exponential coordinates _ from @xmath288 and @xmath93 respectively .",
    "we denote the inverse diffeomorphisms by @xmath289 and @xmath290 ; they satisfy @xmath291 the cost @xmath292 is called the _ modified cost at @xmath89_. a subset of @xmath80 or function thereon is said to _ appear from @xmath89 _ to have property @xmath293 , if it has property @xmath293 when expressed in the coordinates @xmath294 .    identifying the cotangent vector @xmath295 with the tangent vector @xmath296 to @xmath87 using the pseudo - metric of kim and",
    "mccann @xcite shows @xmath297 to be the projection to @xmath75 of the pseudo - riemannian exponential map @xmath298 ; similarly @xmath299 is the projection to @xmath88 of @xmath300 . also , @xmath301-@xmath302 and @xmath303-@xmath304 in the notation of loeper @xcite .",
    "our first contribution is the following theorem . for a non - negatively cross - curved cost * ( b3 )",
    "* , it shows that any @xmath277-convex potential appears convex from @xmath288 .",
    "even if the cost function is weakly regular * ( a3w ) * , the level sets of the @xmath277-convex potential appear convex from @xmath89 , as was discovered independently from us by liu @xcite , and exploited by liu with trudinger and wang @xcite .",
    "note that although the difference between the cost @xmath2 and the modified cost @xmath305 depends on @xmath89 , they differ by a null lagrangian @xmath306 which  being independent of @xmath307  does not affect the question of which maps @xmath25 attain the infimum ( [ monge ] ) . having a function with convex level sets is a useful starting point , since it enables us to apply caffarelli s affine renormalization of convex sets approach and a full range of techniques from gutierrez @xcite to address the regularity of @xmath7-convex potentials .",
    "[ thm : apparently convex ] let @xmath97 satisfying * ( b0)**(b2 ) *  be weakly regular * ( a3w)*. if @xmath308 is @xmath7-convex on @xmath80 , then @xmath309 has convex level sets , as a function of the cost exponential coordinates @xmath310 from @xmath288 . if , in addition , @xmath7 is non - negatively cross - curved * ( b3 ) *  then @xmath311 is convex on @xmath312 . in either case",
    "@xmath311 is minimized at @xmath313 if @xmath314 .",
    "furthermore , @xmath311 is @xmath277-convex with respect to the modified cost @xmath315 on @xmath316 , and @xmath317 for all @xmath318 .",
    "the final sentences of the theorem are elementary : @xmath7-convexity @xmath137 asserts @xmath319from ( [ c - transform ] ) , hence @xmath320 and @xmath317 since all three suprema above are attained at the same @xmath321 .",
    "taking @xmath322 reduces the inequality @xmath323 to @xmath324 , with equality precisely if @xmath325 .",
    "it remains to address the convexity claims .",
    "since the supremum @xmath326 of a family of convex functions is again convex , it suffices to establish the convexity of @xmath327 for each @xmath321 under hypothesis * ( b3)*. for a similar reason , it suffices to establish the level - set convexity of the same family of functions under hypothesis * ( a3w)*.    first assume * ( a3w)*. since @xmath328 we see that @xmath277-segments in @xmath312 with respect to @xmath89 coincide with ordinary line segments .",
    "let @xmath329 be any line segment in the convex set @xmath312 .",
    "define @xmath330 .",
    "loeper s maximum principal ( theorem [ t : dasm ] above , see also remark [ rmk : symmetry ] ) asserts @xmath331 , which implies convexity of each set @xmath332 . under hypothesis",
    "* ( b3 ) * , theorem [ t : time - convex dasm ] goes on to assert convexity of @xmath91 \\longmapsto f(s , y)$ ] as desired .    the effect of this change of gauge on jacobian inequalities is summarized in a corollary :    [ c : jacobian transform ] using the hypotheses and notation of theorem [ thm : apparently convex ] , if @xmath333 \\subset [ 0,\\infty]$ ] on @xmath176 , then @xmath334 $ ] on @xmath335 , where @xmath336 and @xmath337 are defined in . furthermore , @xmath338 and @xmath339 .    from the jacobian bounds",
    "@xmath340 $ ] on @xmath8 , we find @xmath341 for each @xmath150 . on the other hand , theorem [ thm : apparently convex ] asserts @xmath342 , so the claim @xmath334 $ ] follows from the hypothesis @xmath333 $ ] , by definition ( [ c - monge - ampere measure ] ) and the fact that @xmath343 from is a diffeomorphism ; see * ( b1)*. the bounds @xmath344 and @xmath345 follow from @xmath346 and @xmath347 .",
    "the renormalization of a function @xmath311 by an affine transformation @xmath348 will be useful in section  [ s : alexandrov ] to prove our alexandrov type estimates .",
    "let us therefore record the following observations .",
    "define @xmath349 here @xmath350 denotes the jacobian determinant of @xmath351 , i.e. the determinant of the linear part of @xmath351 .    assuming * ( b0)**(b1 )",
    "* , given a @xmath352-convex function @xmath353 and affine bijection @xmath354 , define the renormalized potential @xmath355 by and renormalized cost @xmath356 using the adjoint @xmath357 to the linear part of @xmath351 .",
    "then , for all borel @xmath358 , @xmath359    from we see @xmath360 if and only if @xmath361 , thus follows from @xmath362 .",
    "similarly , since yields @xmath363 , we see @xmath364 is equivalent to @xmath365 from ( and theorem [ thm : apparently convex ] ) , whence @xmath366 to establish .    as a corollary to this lemma",
    ", we recover the affine invariance not only of the monge - ampre equation satisfied by @xmath326  but also of the @xmath352-monge - ampre equation it satisfies  under coordinate changes on @xmath88 ( which induce linear transformations @xmath351 on @xmath367 and @xmath357 on @xmath368 ) : for @xmath369 , @xmath370",
    "the subsequent sections of this paper are largely devoted to ruling out exposed points in @xmath69 of sets on which ordinary convexity of the @xmath352-convex potential from theorem [ thm : apparently convex ] fails to be strict .",
    "this current section rules out exposed points on the boundary of @xmath69 .",
    "we do this by proving an important topological property of the ( multi - valued ) mapping @xmath174 .",
    "namely , we show that the subdifferential @xmath215 maps interior points of @xmath371 only to interior points of @xmath88 , under hypothesis , and conversely that @xmath215 maps boundary points of @xmath75 only to boundary points of @xmath88 . this theorem may be of independent interest , and was required by figalli and loeper to conclude their continuity result concerning maps of the plane which optimize * ( a3w ) *  costs @xcite",
    ".    this section does not use the cross - curvature condition * ( b3)*(nor * a3w * ) on the cost function @xmath259 , but relies crucially on the _ strong _ @xmath7-convexity * ( b2u ) *  of its domains @xmath72 and @xmath372 ( but importantly , not on @xmath373 ) .",
    "no analog for theorem [ thm : bdry - inter ] was needed by caffarelli to establish @xmath374 regularity of convex potentials @xmath60 whose gradients optimize the classical cost @xmath375 @xcite , since in that case he was able to take advantage of the fact that the cost function is smooth on the whole of @xmath16 to chase potentially singular behaviour to infinity .",
    "( one general approach to showing regularity of solutions for degenerate elliptic partial differential equations is to exploit the threshold - hyperbolic nature of the solution to try to follow either its singularities or its degeneracies to the boundary , where they can hopefully be shown to be in contradiction with boundary conditions ; the _ degenerate _ nature of the ellipticity precludes the possibility of _ purely local _ regularizing effects . )    [ thm : bdry - inter ] let @xmath7 satisfy * ( b0)**(b1 ) *  and @xmath137 be a @xmath7-convex function ( which implies @xmath376 ) , and @xmath377 .    1 .",
    "if @xmath378 on @xmath379 and @xmath88 is strongly @xmath251-convex with respect to @xmath380 , then interior points of @xmath380 can not be mapped by @xmath381 to boundary points of @xmath88 : i.e.  @xmath382 .",
    "2 .   if @xmath383 on @xmath80 , and @xmath75 is strongly @xmath7-convex with respect to @xmath88 , then boundary points of @xmath75 can not be mapped by @xmath215 into interior points of @xmath88 : i.e.  @xmath384 is disjoint from @xmath215 .",
    "note that when @xmath380 is open the conclusion of ( a ) implies @xmath385 is disjoint from @xmath386 .",
    "we therefore remark that it suffices to prove ( a ) , since ( b ) follows from ( a ) exchanging the role @xmath0 and @xmath1 and observing that @xmath383 implies @xmath387 as in lemma [ l : cma properties](d ) .",
    "let us prove ( a ) . fix any point @xmath388 in the interior of @xmath380 , and @xmath389 .",
    "assume by contradiction that @xmath390 .",
    "at @xmath391 we use * ( b0)**(b1 ) *  to define cost - exponential coordinates @xmath392 by @xmath393 and define a modified cost and potential by subtracting null lagrangian terms : @xmath394 similarly to corollary [ c : jacobian transform ] , @xmath395 , where @xmath270 denote the jacobian bounds for the coordinate change .",
    "note @xmath396 corresponds to @xmath397 . since @xmath7-segments with respect to @xmath398",
    "correspond to line segments in @xmath399 we see @xmath400 depends linearly on @xmath282 , whence @xmath401 ; similarly @xmath251-segments with respect to @xmath388 become line segments in the @xmath402 variables , @xmath403 depends linearly on @xmath402 , @xmath404 , and the extra factor @xmath405 in our definition of @xmath297 makes @xmath406 the identity matrix ( whence @xmath407 and @xmath408 for all @xmath282 in @xmath409 and @xmath402 in @xmath410 .",
    "although the change of variables @xmath411 is only a @xmath278 diffeomorphism , we can still take four derivatives of the modified cost provided at least one of the four derivatives is with respect to @xmath282 and another is with respect to @xmath402 .",
    "we denote @xmath412 and choose orthogonal coordinates on @xmath72 which make @xmath413 the outer unit normal to @xmath414 at @xmath415 .",
    "note that @xmath416 is strongly convex by hypothesis  ( a ) . in these variables , consider a small cone of height @xmath417 and angle @xmath418 around the @xmath413 axis : @xmath419 observe that , if @xmath420 are small enough , then @xmath421 , and its measure is of order @xmath422 .",
    "consider now a slight enlargement @xmath423 of the polar dual cone , where @xmath417 will be chosen sufficiently small depending on the large parameter @xmath424 forced on us later .",
    "the strong convexity ensures @xmath70 is contained in a ball @xmath425 of some radius @xmath426 contained in the half - space @xmath427 with boundary sphere passing through the origin .",
    "as long as @xmath428 we claim @xmath429 intersects this ball  a fortiori @xmath70  in a set whose volume tends to zero like @xmath430 as @xmath431 . indeed , from the inequality @xmath432satisfied by any @xmath433 we deduce @xmath434 , i.e.  @xmath435",
    "if @xmath418 is small enough . combined with the further inequalities @xmath436 ( the first inequality follows by the strong convexity of @xmath70 ) , this yields @xmath437 and @xmath438 as @xmath431 .",
    "thus @xmath439 for a dimension dependent constant @xmath440 , provided @xmath441 .",
    "the contradiction now will come from the fact that , thanks to the @xmath277-cyclical monotonicity of @xmath442 , if we first choose @xmath424 big and then we take @xmath417 sufficiently small , the image of all @xmath443 by @xmath444 has to be contained in @xmath429 for @xmath418 small enough . since @xmath445 this will imply latexmath:[\\[{\\varepsilon}^n\\theta^{n-1 } \\sim \\tilde \\lambda { { \\mathscr l}^{n } } ( e_{\\theta,{\\varepsilon } } ) \\leq    which gives a contradiction as @xmath431 , for @xmath447 small but fixed .",
    "thus all we need to prove is that , if @xmath424 is big enough , then @xmath448 for any @xmath417 sufficiently small .",
    "let @xmath443 and @xmath449 .",
    "combining @xmath450 = \\tilde c(q , p ) + \\tilde c({{\\mathbf 0}},{{\\mathbf 0}})- \\tilde c(q,{{\\mathbf 0}})-c({{\\mathbf 0}},p ) \\le 0\\end{aligned}\\ ] ] ( where the last inequality is a consequence of @xmath451-monotonicity of @xmath452 ; see for instance ( * ? ? ?",
    "* definitions 5.1 and 5.7 ) ) with @xmath453 \\\\ = & d^2_{qp } \\tilde c({{\\mathbf 0}},{{\\mathbf 0 } } ) + \\int_0^t dt ' d^3_{qpp } \\tilde c({{\\mathbf 0}},t'p)[p ] \\\\ &",
    "+ \\int_0^s ds ' d^3_{qqp } \\tilde c(s'q,{{\\mathbf 0}})[q ] + \\int_0^s ds ' \\int_0^t dt ' d^4_{qqpp } \\tilde c(s'q , t'p)[q , p]\\end{aligned}\\ ] ] yields @xmath454 \\\\ & \\le c_0 |q|^2 |p|^2\\end{aligned}\\ ] ] since @xmath455 and @xmath456 vanish in our chosen coordinates and @xmath457 is the identity matrix . due to the tensorial nature of the cross - curvature ,",
    "@xmath424 depends on @xmath458 and the bi - lipschitz constants @xmath269 from .    from the above inequality and the definition of @xmath459 we deduce",
    "@xmath460 so @xmath461 as desired .",
    "in this section we shall prove that  up to constants  the ordinary monge - ampre measure @xmath462 dominates the @xmath352-monge - ampre measure @xmath463 , when defined in the coordinates introduced in theorem [ thm : apparently convex ] .",
    "let us begin with a lemma which motivates our proposition heuristically .",
    "the conclusions of the lemma extend easily from smooth to non - smooth functions by an approximation argument combining lemma [ l : cma properties](b)(c ) with results of trudinger and wang @xcite .",
    "however this approach would require the domains @xmath75 and @xmath88 to be smooth , so in proposition [ p : c - ma less ma ] we prefer to construct an explicit approximation which proves the statement we need , requires no additional smoothness hypotheses , and is logically independent of both lemma [ lem : c - ma less ma ] and @xcite .",
    "[ lem : c - ma less ma ] assume * ( b0)**(b3 ) *  and let @xmath464 be a convex @xmath352-convex function as in theorem [ thm : apparently convex ] . if @xmath465 for some open set @xmath466 , then @xmath467 on @xmath468 , where @xmath469 are defined as in ( [ jacobian bound ] ) .",
    "in addition to the convexity of @xmath276 , for any @xmath321 theorem [ thm : apparently convex ] asserts the convexity of the @xmath277-convex function @xmath470 .",
    "thus @xmath471by the concavity of @xmath472 on symmetric non - negative definite matrices . on the other hand , for @xmath277-convex @xmath473 ,",
    "the measure @xmath474 is absolutely continuous , with lebesgue density given by the left hand side of ( [ monge - ampere type equation ] ) .",
    "thus at any @xmath475 , @xmath476 as desired .",
    "we now prove the proposition that we actually need subsequently .",
    "[ p : c - ma less ma ] assume * ( b0)**(b3 ) * , and let @xmath464 be a convex @xmath352-convex function from theorem [ thm : apparently convex ] .",
    "then @xmath467 on @xmath477 , where @xmath469 are defined as in ( [ jacobian bound ] ) .",
    "it suffices to prove @xmath478 for each ball whose closure is contained in @xmath468 .",
    "given such a ball , let @xmath479 , and let @xmath480 be a smooth mollifier vanishing outside @xmath481 and carrying unit mass . for @xmath447 sufficiently small , we can define the smooth convex function @xmath482 on @xmath483 . since @xmath311 and @xmath484 are locally lipschitz , letting @xmath74 denote a bound for @xmath485 inside @xmath486 yields @xmath487 for all @xmath488 .",
    "_ claim : _ fix @xmath489 and @xmath490 . for @xmath447",
    "sufficiently small , we claim that to each @xmath491 corresponds some @xmath492 such that @xmath493 .",
    "indeed , for @xmath494 with @xmath495 , observe @xmath496 with equality at @xmath313 .",
    "moreover @xmath497 .",
    "therefore @xmath498 on the other hand , if @xmath499 , then @xmath500 , and so @xmath501 thus , if for fixed @xmath502 small we choose @xmath417 small enough so that @xmath503 we deduce that if we lower the graph of the function @xmath504 to the lowest level at which it intersects the graph of @xmath505 , then the point of intersection must lie over @xmath506 .",
    "this proves the claim .",
    "having established the claim , let @xmath507 denote the ( borel ) set of all @xmath508 which arise from @xmath509 in this way .",
    "since @xmath505 is smooth , the condition @xmath510 implies @xmath511 as well as @xmath512 by and * ( b1 ) * we can define a smooth map @xmath513 throughout @xmath514 using the relation @xmath515 and find that @xmath516 is a singleton . in this way we obtain @xmath517 where in the last equality we used to deduce that @xmath518 is non - negative definite . hence the inequality @xmath519 holds ( similarly to above ) , and",
    "so @xmath520 letting first @xmath521 and then @xmath522 , we finally deduce @xmath523 here , to see the last inequality one may , for instance , use lemma  [ l : cma properties](b ) with @xmath524 .",
    "arbitrariness of @xmath525 yields the desired result .",
    "in this section we prove the key estimates for @xmath7-convex potential functions which will eventually lead to the continuity and injectivity of optimal maps .",
    "namely , we extend alexandrov type estimates commonly used in the analysis of monge - ampre equations ( thus for the cost @xmath526 ) , to general non - negatively curved cost functions .",
    "this is established in lemma  [ lemma - infgeq ] ( plus proposition [ p : c - ma less ma ] ) and lemma  [ l : prop - infleq ] .",
    "these estimates are used to compare the infimum of @xmath7-convex function on a section with the size of the section , which are the key ingredients in the proof of our main results ; see propositions  [ prop : alex1 ] and [ prop : estimate ] .",
    "lemma  [ l : prop - infleq ] represents the most nontrivial and technical result we obtain in this section .",
    "we recall a basic lemma for convex sets due to fritz john @xcite , which will play an essential role in the rest of the paper .",
    "[ l : john ] for a compact convex set @xmath527 , there exists an affine transformation @xmath528 such that @xmath529 .",
    "we now estimate the infimum of @xmath311 in terms of the monge - ampre measure in a section .",
    "the following lemma is a standard fact for convex functions .",
    "with lemma  [ l : john ] in mind , we state it for normalized functions @xmath355 and sections @xmath530 .",
    "however , the estimate ( [ inf geq ] ) is invariant under the affine renormalization ; according to , it holds with or without stars .",
    "[ lemma - infgeq ] let @xmath531 be a convex function whose section @xmath532 satisfies @xmath533 .",
    "assume that @xmath534 on @xmath535 .",
    "then , for all @xmath536 , @xmath537 where @xmath538 denotes the dilation of @xmath530 by a factor @xmath539 with respect to the origin .",
    "although the proof of this result is classical ( see for instance @xcite ) , for sake of completeness we prefer to give all the details .",
    "we can assume that @xmath540 , otherwise the estimate is trivial .",
    "it is not difficult to prove that @xmath541 indeed , if @xmath542 and @xmath543 , then @xmath544 and taking the supremum in the left hand side among all @xmath545 follows .",
    "thus , since @xmath546 , we conclude @xmath547    combining the above lemmas , we obtain :    [ prop : alex1 ] assume * ( b0)**(b3 ) *  and define @xmath548 as in ( [ jacobian bound ] ) . any convex @xmath277-convex function @xmath549 from theorem [ thm : apparently convex ] which satisfies @xmath550 $ ] in a section of the form @xmath551 and @xmath552 on @xmath553 , also satisfies @xmath554    first use the affine map @xmath351 as given in lemma  [ l : john ] to renormalize @xmath311 into @xmath355 using .",
    "this does not change the bound @xmath555 $ ] , but allows us to apply lemma  [ lemma - infgeq ] with @xmath556 .",
    "its conclusion ( [ inf geq ] ) has been expressed in a form which holds with or without the stars , in view of .",
    "proposition  [ p : c - ma less ma ] now yields the desired inequality .",
    "we now progress toward the alexandrov type estimate in lemma  [ l : prop - infleq ] . in this subsection",
    "we construct and study the @xmath352-cone associated to the section of a @xmath352-convex function .",
    "this @xmath352-cone plays an essential role in our proof of lemma  [ l : prop - infleq ] .",
    "[ def : ccone ] assume * ( b0)**(b2 ) *  and * ( a3w ) * , and let @xmath549 be the @xmath277-convex function with convex level sets from theorem  [ thm : apparently convex ] .",
    "let @xmath557 denote the section @xmath558 , fix @xmath559 , and assume @xmath552 on @xmath560 .",
    "@xmath352-cone @xmath561 generated by @xmath562 and @xmath557 with height @xmath563 _ is given by @xmath564    notice the @xmath352-cone @xmath565 depends only on the convex set @xmath358 , @xmath566 , and the value @xmath567 , but is otherwise independent of @xmath568 .",
    "recalling that @xmath569 on @xmath570 , we record several key properties of the @xmath352-cone :    [ lemma : propccone ] adopting the notation and hypotheses of definition [ def : ccone ] , let @xmath571 be the @xmath352-cone generated by @xmath572 and @xmath557 with height @xmath573 . then    1 .",
    "@xmath565 has convex level sets ; it is a convex function if * ( b3 ) *  holds ; 2 .",
    "@xmath574 for all @xmath575 ; 3 .",
    "@xmath576 ; 4 .",
    "@xmath577 .",
    "property ( a ) is a consequence of the level - set convexity of @xmath578 proved in theorem [ thm : apparently convex ] , or its convexity assuming * ( b3)*. moreover , since @xmath579 for all @xmath580 , ( b ) follows . for each pair @xmath581 and @xmath582 , consider the supporting mountain @xmath583 , i.e. @xmath584 and @xmath585 . consider the @xmath352-segment @xmath586 connecting @xmath587 and @xmath588 in @xmath88 with respect to @xmath589 .",
    "since @xmath590 , by continuity there exists some @xmath5910 , 1]$ ] for which @xmath592 satisfies @xmath593 . from loeper s maximum principle ( theorem [ t : dasm ] above ) , we have @xmath594= \\max[m_z , 0],\\ ] ] and therefore , from @xmath585 , @xmath595 by the construction , @xmath596 is of the form @xmath597 and vanishes at @xmath589 .",
    "this proves ( c ) .",
    "finally ( d ) follows from ( c ) and the fact that @xmath598 .",
    "indeed , it suffices to move down the supporting mountain of @xmath565 at @xmath572 until the last moment at which it touches the graph of @xmath311 on @xmath557 from below .",
    "the conclusion then follows from loeper s local to global principle , corollary [ c : local - global ] above .",
    "the following estimate shows that the monge - ampre measure , and the relative location of the vertex within the section which generates it , control the height of any well - localized @xmath352-cone .",
    "afficionados of the monge - ampre theory may be less surprised by this estimate once it is recognized that the localization in coordinates ensures the cost is approximately affine , at least in one of its two variables .",
    "still , it is vital that the approximation be controlled !",
    "together with lemma  [ lemma : propccone](d ) , this proposition plays a key role in the proof of our alexandrov type estimate ( lemma  [ l : prop - infleq ] ) .",
    "[ lower bound on the monge - ampre measure of a small @xmath352-cone ] [ p : partial c - cone ] assume * ( b0)**(b3 ) *  and define @xmath599 as in definition [ d : cost exponential ] .",
    "let @xmath358 be a closed convex set and @xmath565 the @xmath352-cone generated by @xmath566 of height @xmath600 over @xmath557 .",
    "let @xmath601 be two parallel hyperplanes contained in @xmath602 and touching @xmath560 from two opposite sides .",
    "then there exists @xmath603 small , depending only on the cost ( and given by lemma  [ l : c estimate ] ) , and a constant @xmath604 depending only on dimension , such that if @xmath605 then @xmath606 where @xmath607 denotes the maximal length among all the segments obtained by intersecting @xmath557 with a line orthogonal to @xmath608 .    to prove this , we first observe a basic estimate on the cost function @xmath7 .",
    "[ l : c estimate ] assume * ( b0)**(b2)*. for @xmath599 from definition [ d : cost exponential ] and each @xmath321 and @xmath609 , @xmath610 where @xmath611 is given by @xmath612 in the notation .    for fixed @xmath613 introduce the @xmath451-exponential coordinates @xmath614 .",
    "the bi - lipschitz constants of this coordinate change are estimated by @xmath615 as in corollary  [ c : jacobian transform ] .",
    "thus @xmath616 where @xmath617 from definition [ d : cost exponential ] has been used .",
    "similarly , noting the convexity * ( b2)*of @xmath618 , @xmath619 the result follows since @xmath620 .",
    "( the last inequality follows from @xmath621 . )",
    "we fix @xmath622 .",
    "let @xmath623 , @xmath624 , ( with @xmath625 equal either @xmath626 or @xmath627 ) be hyperplanes contained in @xmath628 , touching @xmath560 , and such that @xmath629 are all mutually orthogonal ( so that also @xmath630 are mutually orthogonal ) .",
    "moreover we choose @xmath631 in such a way that , if @xmath632 denotes the projection of @xmath557 on @xmath625 and @xmath633 denotes its @xmath634-dimensional hausdorff measure , then @xmath635 for some universal constant @xmath636 .",
    "indeed , as @xmath632 is convex , by lemma  [ l : john ] we can find an ellipsoid @xmath514 such that @xmath637 , and for instance we can choose @xmath631 among the hyperplanes orthogonal to the axes of the ellipsoid ( for each axis we have two possible hyperplanes , and we can always choose the furthest one so that holds ) .",
    "each hyperplane @xmath638 touches @xmath557 from outside , say at @xmath639 .",
    "let @xmath640 be the outward ( from @xmath557 ) unit vector at @xmath641 orthogonal to @xmath623 .",
    "then @xmath642 for some @xmath643 , and by corollary [ c : local - global ] there exists @xmath644 such that @xmath645 define @xmath646 as @xmath647 i.e. @xmath646 is the @xmath352-segment from @xmath89 to @xmath648 with respect to @xmath641 . as in the proof of lemma  [ lemma : propccone ] ( c ) ,",
    "the intermediate value theorem yields @xmath649 such that @xmath650 with equality at @xmath641 .",
    "thus , by the definition of @xmath565 , @xmath651 , @xmath652    therefore by the convexity of @xmath565 shown in lemma [ lemma : propccone](a ) , the affine function @xmath653 with slope @xmath654 and with @xmath655 satisfies @xmath656 .",
    "this shows @xmath657 therefore if @xmath658 with @xmath659 small , each vector @xmath660 is close to @xmath654 , say @xmath661 since the vectors @xmath662 are mutually orthogonal , the above estimate implies that for @xmath663 small enough the convex hull of @xmath664 has measure of order @xmath665 .",
    "thus , by the lower bound and the convexity of @xmath666 , we obtain @xmath667 since @xmath625 was either @xmath608 or @xmath627 , we have proved that @xmath668 to conclude the proof , we apply lemma  [ lemma : orthogonal sections ] below with @xmath669 given by the segment obtained intersecting @xmath557 with a line orthogonal to @xmath608 . combining that lemma with , we obtain @xmath670 and last two inequalities prove the proposition ( taking @xmath671 larger if necessary ) .",
    "[ lemma : orthogonal sections ] let @xmath557 be a convex set in @xmath672 .",
    "let @xmath673 denote the projections to the components @xmath674 , @xmath675 , respectively .",
    "let @xmath669 be a slice orthogonal to the second component , that is @xmath676 then there exists a constant @xmath636 , depending only on @xmath677 , such that @xmath678 where @xmath679 denotes the @xmath680-dimensional hausdorff measure .",
    "let @xmath681 be an affine map with determinant @xmath229 given by lemma  [ l : john ] such that @xmath682 for some @xmath683 .",
    "then , if we extend @xmath351 to the whole @xmath16 as @xmath684 , we have @xmath685 , @xmath686 , and @xmath687 hence , we can assume from the beginning that @xmath688 .",
    "let us now consider the point @xmath689 , and we fix an orthonormal basis @xmath690 in @xmath691 such that @xmath692 for some @xmath693 .",
    "since @xmath694 , there exist points @xmath695 such that @xmath696 .",
    "let @xmath697 denote the convex hull of @xmath669 with @xmath698 , and let @xmath699 denote the @xmath700-dimensional strip obtained taking the convex hull of @xmath701 with @xmath698 .",
    "observe that @xmath702 , and so @xmath703 we now remark that , since @xmath696 and @xmath704 for @xmath705 , we have @xmath706 for all @xmath705 . moreover , if @xmath707 denotes the closest point to @xmath708 , then the segments joining @xmath708 to @xmath648 parallels @xmath709 , hence these segments are all mutually orthogonal , and they are all orthogonal to @xmath699 too . from this fact it is easy to see that , if we define the convex hull @xmath710 then , since @xmath711 for @xmath705 , by and the inclusion @xmath712 we get @xmath713 this concludes the proof , as @xmath714 .",
    "the next alexandrov type lemma holds for localized sections @xmath557 of @xmath352-convex functions .",
    "[ l : prop - infleq ] assume * ( b0)**(b3 ) *  and let @xmath549 be a convex @xmath277-convex function from theorem [ thm : apparently convex ] .",
    "let @xmath557 denote the section @xmath558 , assume @xmath715 on @xmath553 , and fix @xmath716 .",
    "let @xmath601 be two parallel hyperplanes contained in @xmath628 and touching @xmath560 from two opposite sides .",
    "then there exists @xmath717 small , depending only on dimension and the cost function ( with @xmath718 given by proposition [ p : partial c - cone ] ) such that if @xmath719 then @xmath720 where @xmath607 denotes the maximal length among all the segments obtained by intersecting @xmath557 with a line orthogonal to @xmath608 , and @xmath721 is defined as in ( [ jacobian bound ] ) .",
    "fix @xmath622 .",
    "observe that @xmath552 on @xmath560 and consider the @xmath352-cone @xmath565 generated by @xmath572 and @xmath557 of height @xmath722 as in .",
    "from lemma  [ lemma : propccone](d ) we have @xmath723 and from loeper s local to global principle , corollary [ c : local - global ] above , @xmath724 therefore @xmath725 the lower bound on @xmath726 comes from .",
    "this finishes the proof .      combining the results of proposition  [ prop : alex1 ] and lemma [ l : prop - infleq ] yields :    [ prop : estimate ]",
    "assume * ( b0)**(b3 ) *  and let @xmath549 be a convex @xmath277-convex function from theorem [ thm : apparently convex ] .",
    "there exists @xmath717 small , depending only on dimension and the cost function ( and given by lemma  [ l : prop - infleq ] ) , and constants @xmath636 , @xmath728 , @xmath729 , depending only on dimension , such that the following holds : letting @xmath557 denote the section @xmath558 , assume @xmath730 $ ] in @xmath557 and @xmath552 on @xmath560 .",
    "let @xmath731 be parallel hyperplanes contained in @xmath732 and supporting @xmath557 from two opposite sides . if @xmath733 then @xmath734 and @xmath735 where @xmath607 denotes the maximal length among all the segments obtained by intersecting @xmath557 with a line orthogonal to @xmath608 , and @xmath721 is defined as in ( [ jacobian bound ] ) .",
    "equation follows from lemma  [ l : prop - infleq ] and the assumption @xmath736 .",
    "now , by lemma  [ l : john ] , we deduce that there exists an ellipsoid @xmath514 such that @xmath737 , where @xmath738 denotes the dilation of @xmath514 by a factor @xmath739 with respect to its barycenter @xmath740 . taking @xmath608 and",
    "@xmath627 orthogonal to one of the longest axes of @xmath514 and @xmath741 in yields @xmath742 on the other hand , convexity of @xmath311 along the segment which crosses @xmath557 and passes through both @xmath740 and the point @xmath562 where @xmath743 is attained implies @xmath744 since the barycenter of @xmath514 divides the segment into a ratio at most @xmath745 .",
    "combining these two estimates with we obtain , to complete the proof .",
    "noting @xmath746 from corollary [ c : jacobian transform ] , we observe that the estimate is stable under affine renormalization : let @xmath351 be an affine transformation , and recall the renormalization @xmath747 then @xmath748 is a section for @xmath355 and @xmath749 on the other hand , estimate is not stable under affine renormalization ( a line orthogonal to @xmath608 is not an affinely invariant concept ) . for this reason ,",
    "both in the proof of the @xmath7-strict convexity ( section  [ s : contact ] ) and in the proof of differentiability @xmath750 ( section  [ s : continuousinjection ] ) we apply our alexandrov estimates directly to the original sections , without renormalizing them . using this strategy ,",
    "our estimates turn out to be strong enough to adapt to our situation the strict convexity and interior continuity theory of caffarelli @xcite @xcite .",
    "we perform this in the remainder of the manuscript .",
    "in this section and the final one , we complete the crucial step of proving the strict @xmath7-convexity of the @xmath7-convex potentials @xmath751 arising in optimal transport , meaning @xmath752 should be disjoint from @xmath253 whenever @xmath753 are distinct .",
    "this is accomplished in theorem  [ t : strict convex ] . in this section ,",
    "we show that , if the contact set does not consist of a single point , then it extends to the boundary of @xmath75 .",
    "our method relies on the non - negative cross - curvature * ( b3 ) *  of the cost @xmath7 .    from now on",
    "we adopt the following notation : @xmath754 means that there exist two positive constants @xmath755 and @xmath756 , depending on @xmath739 and @xmath757 only , such that @xmath758 .",
    "analogously we will say that @xmath759 ( resp .",
    "@xmath760 ) if there exists a positive constant @xmath440 , depending on @xmath739 and @xmath757 only , such that @xmath761 ( resp .",
    "@xmath762 ) .    recall that a point @xmath0 of a convex set @xmath527 is _ exposed _ if there is a hyperplane supporting @xmath763 exclusively at @xmath0 .",
    "although the _ contact set _",
    "@xmath764 may not be convex , it appears convex from @xmath89 by corollary [ c : local - global ] , meaning its image @xmath765 in the coordinates is convex .",
    "the following theorem shows this convex set is either a singleton , or contains a segment which stretches across the domain .",
    "we prove it by showing the solution geometry near certain exposed points of @xmath766 inside @xmath69 would be inconsistent with the bounds established in the previous section .",
    "[ thm : noexposed ] assume * ( b0)**(b3 ) *  and let @xmath27 be a @xmath7-convex solution of with @xmath767 open .",
    "fix @xmath768 and @xmath769 , and define the contact set @xmath770 .",
    "assume that @xmath771 , i.e. it is not a singleton .",
    "then @xmath763 intersects @xmath772 .    as in definition",
    "[ d : cost exponential ] , we transform @xmath773 with respect to @xmath89 , i.e. we consider the transformation @xmath774 , defined on @xmath775 by the relation @xmath776 and the modified cost function @xmath777 on @xmath778 , for which the @xmath352-convex potential function @xmath779 is convex . we observe that @xmath569 for all @xmath282 , and moreover the set @xmath780 appears convex from @xmath89 , meaning @xmath781 is convex , by the corollary [ c : local - global ] to loeper s maximum principle .",
    "our proof is reminiscent of caffarelli s for the cost @xmath782 ( * ? ? ?",
    "* lemma 3 ) .",
    "observe @xmath783 lies in the interior of the set @xmath784 where @xmath785 $ ] , according to corollary [ c : jacobian transform ] .",
    "choose the point @xmath786 furthest from @xmath562 ; it is an exposed point of @xmath787 .",
    "we claim either @xmath788 or @xmath789 . to derive a contradiction ,",
    "suppose the preceding claim fails , meaning @xmath790",
    ".    for a suitable choice of cartesian coordinates on @xmath88 we may , without loss of generality , take @xmath791 parallel to the positive @xmath792 axis .",
    "denote by @xmath709 the associated orthogonal basis for @xmath793 , and set @xmath794 and @xmath795 , so the halfspace @xmath796 of @xmath797 intersects @xmath787 only at @xmath798 .",
    "use the fact that @xmath799 is an exposed point of @xmath787 to cut a corner @xmath800 off the contact set @xmath763 by choosing @xmath801 small enough that @xmath802 satisfies :    1 .",
    "@xmath803 is a compact convex set in the interior of @xmath69 ; 2",
    ".   @xmath804 , where @xmath805 is from lemma  [ l : prop - infleq ] .",
    "defining @xmath806 , @xmath807 the corresponding @xmath7-segment with respect to @xmath89 , and @xmath808 , note that @xmath809 contains @xmath810 , and @xmath800 contains @xmath811 and @xmath812 . since the corner @xmath800 needs not intersect the support of @xmath813 ( especially , when @xmath799 is not an interior point of @xmath814 ) , we shall need to cut a larger corner @xmath815 as well , defined by @xmath816 , which intersects @xmath817 at @xmath78 . by tilting the supporting function slightly",
    ", we shall now define sections @xmath818 of @xmath9 whose interiors include the extreme point @xmath812 and whose boundaries pass through @xmath819 and @xmath78 respectively , but which converge to @xmath800 and @xmath815 respectively as @xmath521 .    indeed , set @xmath820 and observe @xmath821 taking @xmath822 in this formula and @xmath447 shows the sections defined by @xmath823 both include a neighbourhood of @xmath824 but converge to @xmath800 and @xmath815 respectively as @xmath521 .",
    "we remark that there exist a priori no coordinates in which all set @xmath825 are convex .",
    "however for each fixed @xmath447 , we can change coordinates so that both @xmath825 and @xmath826 become convex : use @xmath827 to make the transformations @xmath828 so that the functions @xmath829 are convex on @xmath830 .",
    "observe that , in these coordinates , @xmath825 and @xmath826 become convex : @xmath831 and either @xmath832 or @xmath833 since @xmath834 .",
    "for @xmath447 small , the inclusion must be the first of the two since the limits satisfy @xmath835 and @xmath836 .",
    "in the new coordinates , our original point @xmath768 , the exposed point @xmath812 , and the @xmath7-convex combination @xmath819 with respect to @xmath89 , correspond to @xmath837 thanks to ( ii ) , we have @xmath838 for @xmath417 sufficiently small , so that the estimate of lemma [ l : prop - infleq ] applies . in these coordinates ( chosen for each @xmath417 )",
    "we consider the parallel hyperplanes @xmath839 which support @xmath840 from opposite sides and which are orthogonal to the segment joining @xmath841 with @xmath842 .",
    "since @xmath843 paralles the @xmath844 axis the limiting hyperplanes @xmath845 must coincide with @xmath846 and @xmath847 . thus @xmath848 and @xmath849 observing that @xmath850 is shorter than segment obtained intersecting @xmath851 with the line orthogonal to @xmath852 and passing through @xmath853 , lemma [ l : prop - infleq ] combines with @xmath854 and @xmath855 from and corollary [ c : jacobian transform ] to yield @xmath856    on the other hand",
    ", @xmath857 implies @xmath858 , and @xmath859 implies @xmath860 similarly . thus yields",
    "@xmath861 our contradiction with  will be established by bounding the ratio @xmath862 away from zero .",
    "recall that @xmath863 and @xmath864 with equality at @xmath812 . from the convergence of @xmath826 to @xmath865 and the asymptotic behaviour of",
    "@xmath866 we get @xmath867}\\\\ & \\ge \\frac{- c(x^0 , y_{\\varepsilon } ) + c({{\\tilde x } } , y_{\\varepsilon } ) + c(x^0 , { { \\tilde y } } ) - c({{\\tilde x } } , { { \\tilde y } } ) } { \\sup_{x \\in k^1_{\\varepsilon}}[-c(x , y_{\\varepsilon } ) + c({{\\tilde x } } , y_{\\varepsilon } ) + c(x , { { \\tilde y}})- c({{\\tilde x } } , { { \\tilde y } } ) ] } \\\\ & \\geq \\frac{{\\varepsilon}(\\langle - d_y c(x^0,{{\\tilde y } } ) , e_1\\rangle - { { \\tilde b}})+o({\\varepsilon } ) }   { { \\varepsilon}(\\max \\{q_1 \\mid q \\in -d_y c(k^1_{\\varepsilon},{{\\tilde y}})\\ } - { { \\tilde b}})+o({\\varepsilon } ) } \\\\ & \\geq \\frac{1}{2 } \\end{split}\\ ] ] for @xmath417 sufficiently small .",
    "this shows @xmath868 is close to the minimum value of @xmath869 .",
    "we would like to appeal to lemma  [ lemma - infgeq ] to conclude the proof , but are unable to do so since we only have bounds @xmath870 $ ] on the potentially small intersection of @xmath871 with @xmath826 .",
    "however , this intersection occupies a stable fraction of @xmath826 as @xmath521 , which we shall prove as in ( * ? ? ?",
    "* lemma 3 ) .",
    "since @xmath826 converges to @xmath865 for sufficiently small @xmath417 , observe that @xmath826 is uniformly bounded .",
    "therefore the affine transformation @xmath872 that sends @xmath873 to @xmath874 as in lemma [ l : john ] is an expansion , i.e. @xmath875 , with a constant @xmath876 independent of @xmath417 . since @xmath78 is an interior point of @xmath817 , @xmath877 for sufficiently small @xmath878 ,",
    "hence @xmath879 with @xmath880 from",
    ". defining @xmath881 , we have @xmath882 reducing @xmath502 if necessary to ensure @xmath883 , define ( to apply lemma  [ lemma - infgeq ] later ) @xmath884 ( as in lemma  [ lemma - infgeq ] , @xmath885 denotes the dilation of @xmath886 of a factor @xmath887 with respect to the origin . )",
    "since @xmath886 is convex , it contains the convex hull of @xmath888 , and so @xmath889 for some constant @xmath890 depending on dimension only .",
    "letting @xmath891 this implies @xmath892 recalling that @xmath893 and @xmath894 denote inequalities which hold up to multiplicative constants depending on @xmath895 and @xmath896 , proposition [ p : c - ma less ma ] combines with this estimate to yield @xmath897where ( [ eq : cma ] ) and corollary [ c : jacobian transform ] have been used .",
    "finally , since the conclusion of lemma [ lemma - infgeq ] holds with or without stars in light of  , taking @xmath898 in yields @xmath899 since @xmath900 is independent of @xmath417 this contradicts  to complete the proof .     as can be easily seen from the proof",
    ", one can actually show that if @xmath901 and @xmath763 is not a singleton , then @xmath787 has no exposed points in the interior of @xmath902 . indeed ,",
    "if by contradiction there exists @xmath798 an exposed point of @xmath787 belonging to the interior of @xmath902 , we can choose a point @xmath903 in the interior of @xmath904 such that the segment @xmath791 is orthogonal to a hyperplane supporting @xmath787 at @xmath798 .",
    "then it can immediately checked that the above proof ( which could even be simplified in this particular case ) shows that such a point @xmath798 can not exist .",
    "the first theorem below combines results of sections [ s : mapping ] and [ s : contact ] to deduce strict @xmath7-convexity of the @xmath7-potential for an optimal map , if its target is strongly @xmath7-convex .",
    "this strict @xmath7-convexity  which is equivalent to injectivity of the map  will then be combined with an adaptation of caffarelli s argument ( * ? ? ?",
    "* corollary 1 ) to obtain interior continuity of the map  or equivalently @xmath905-regularity of its @xmath7-potential function  for non - negatively cross - curved costs , yielding the concluding theorem of the paper .",
    "[ t : strict convex ] let @xmath7 satisfy * ( b0)**(b3 ) *  and * ( b2u)*. if @xmath27 is a @xmath7-convex solution of on @xmath767 open , then @xmath27 is strictly @xmath7-convex on @xmath817 , meaning @xmath906 and @xmath907 are disjoint whenever @xmath753 are distinct .",
    "suppose by contradiction that @xmath908 for two distinct points @xmath753 , and set @xmath909 . according to theorem [ thm : noexposed ] , the set @xmath763 intersects the boundary of @xmath75 at a point @xmath910 .",
    "since asserts latexmath:[${\\lambda}\\le          assume by contradiction that is not . as @xmath916 is compact , one can find a point @xmath918 in the set @xmath919 such that @xmath920 is an exposed point of the compact convex set @xmath921 .",
    "similarly to definition [ d : cost exponential ] , we transform @xmath922 with respect to @xmath918 , i.e. we consider the transformation @xmath923 , defined on @xmath924 by the relation @xmath925 and the modified cost function @xmath926 on @xmath927 , for which the @xmath352-convex potential function @xmath928 is convex .",
    "we observe that @xmath929 for all @xmath282 , the point @xmath78 is sent to @xmath930 , @xmath931 , and @xmath311 is strictly convex thanks to theorem [ t : strict convex ] .",
    "moreover , since @xmath920 was an exposed point of @xmath921 , @xmath932 is an exposed point of @xmath933 .",
    "hence , we can find a vector @xmath934 such that the hyperplane orthogonal to @xmath935 is a supporting hyperplane for @xmath933 at @xmath936 .",
    "let us now consider the section @xmath938 .",
    "since @xmath939 , @xmath940 and @xmath311 is strictly convex , @xmath941 as @xmath521 .",
    "thus by it is easily seen that for @xmath417 sufficiently small the following hold : @xmath942 where @xmath943 is a positive constant depending on @xmath417 and such that @xmath944 as @xmath521 .",
    "since @xmath930 is the minimum point of @xmath311 , this immediately implies that one between our alexandrov estimates or must be violated by @xmath311 inside @xmath825 for @xmath417 sufficiently small , which is the desired contradiction .",
    "a.  figalli , y .- h",
    ".  kim and r.j .",
    "when is a multidimensional screening a convex program ?",
    "uniqueness and stability of optimal strategies in the principal - agent problem .",
    "preprint at www.math.toronto.edu/mccann .",
    "f.  john .",
    "extremum problems with inequalities as subsidiary conditions . in",
    "_ studies and essays presented to r. courant on his 60th birthday , january 8 , 1948 _ , pages 187204 .",
    "interscience , new york , 1948 ."
  ],
  "abstract_text": [
    "<S> consider transportation of one distribution of mass onto another , chosen to optimize the total expected cost , where cost per unit mass transported from @xmath0 to @xmath1 is given by a smooth function @xmath2 . </S>",
    "<S> if the source density @xmath3 is bounded away from zero and infinity in an open region @xmath4 , and the target density @xmath5 is bounded away from zero and infinity on its support @xmath6 , which is strongly @xmath7-convex with respect to @xmath8 , and the transportation cost @xmath7 is non - negatively cross - curved , we deduce continuity and injectivity of the optimal map inside @xmath8 ( so that the associated potential @xmath9 belongs to @xmath10 ) . </S>",
    "<S> this result provides a crucial step in the low / interior regularity setting : in a subsequent paper  @xcite , we use it to establish regularity of optimal maps with respect to the riemannian distance squared on arbitrary products of spheres . </S>",
    "<S> the present paper also provides an argument required by figalli and loeper to conclude in two dimensions continuity of optimal maps under the weaker ( in fact , necessary ) hypothesis * ( a3w)*@xcite . in higher dimensions , if the densities @xmath11 are hlder continuous , our result permits continuous differentiability of the map inside @xmath12 ( in fact , @xmath13 regularity of the associated potential ) to be deduced from the work of liu , trudinger and wang  @xcite . </S>"
  ]
}