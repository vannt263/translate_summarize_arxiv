{
  "article_text": [
    "the x - ray band ( @xmath0 0.1 to 10 kev or @xmath0 1 to 100 @xmath1 ) contains the k and l shell transitions of abundant metals .",
    "this allows the use of a wealth of spectral diagnostics in order to understand the physical conditions of highly ionized plasmas in astrophysical systems .",
    "historically , x - ray instruments have used both dispersive and non - dispersive spectrometers in order to resolve individual spectral features .",
    "non - dispersive spectrometers , such as proportional counters , ccds , and calorimeters , directly measure the energy of the incident photon by dissipative processes .",
    "in contrast , dispersive spectrometers such as gratings or crystals , measure the wavelength of the incident photons by recording the distance the incident photon was dispersed from a nominal focus .",
    "dispersive spectrometers have higher resolution at lower energies and non - dispersive spectrometers have higher resolution at higher energies .",
    "development of instruments utilizing either approach has proceeded in parallel and probably will continue for the forseeable future .    both the _ xmm - newton _ ( jansen et al .",
    "@xcite ) and _ chandra _ ( weisskopf et al .",
    "@xcite ) observatories contain dispersive spectrometers , which now routinely resolve emission or absorption lines from individual ions .",
    "both observatories have collected hundreds of high resolution spectra of many different kinds of x - ray sources and have dramatically changed our physical understanding of many of these sources .",
    "the reflection grating spectrometers ( den herder et al .",
    "@xcite ) ( rgs ) on _ xmm - newton _ consist of two arrays of reflection gratings placed behind nested mirror shells .",
    "x - rays are dispersed to an array of ccds . _",
    "chandra _ has two arrays of transmission gratings , the low energy transmission grating ( letg ) and the high energy transmission gratings ( hetg ) .",
    "the x - rays are also dispersed to either an array of ccds or a micro - channel plate .    a variety of new techniques to analyze data from these dispersive spectrometers are being developed which differ from many approaches previously used in x - ray astronomy . in this presentation , we focus on a number of multivariate monte carlo techniques , which were developed for use with the reflection grating spectrometers .",
    "these methods have proved particularly useful both in the analysis of extended sources , such as galaxy clusters and elliptical galaxies , and as part of the in - flight calibration program .",
    "these techniques have allowed the use of modeling approaches previously done with monte carlos , but rarely applied directly to the data .",
    "[ cols=\"^ \" , ]     for an extended source the situation gets more complex , as we discuss in detail below . in that case , @xmath2 is not uniquely known , causing an ambiguity in the ( @xmath3 , @xmath4 ) relation .",
    "the quantity @xmath5 then also contains useful information about the spatial distribution perpendicular to the dispersion axis .",
    "an example of the data of an rgs observation of a galaxy cluster , srsic 159 - 03 , is shown in figure  [ fig : s1101banana ] .",
    "the corresponding image for a non - dispersive spectrometer is seen in figure  [ fig : s1101image ] .",
    "it is immediately apparent that what is seen in a dispersive spectrometer is very different than what is seen on the sky .",
    "typically , observations contain between @xmath6 and @xmath7 photons .",
    "all three measurements ( @xmath3 , @xmath5 , @xmath8 ) contain useful information in the case of an extended source .",
    "the 3-dimensional data space is also always sparsely filled .",
    "this means the number of photons is always less than the number of effective resolution elements ( @xmath9 to @xmath10 ) .",
    "clearly , this sparse multi - dimensional data is common in other applications .",
    "the standard method of response calculation in x - ray astronomy is to convolve the model for the spectrum , s , with a response kernel , r ( see e.g. arnaud  @xcite ) .",
    "this can be expressed as    @xmath11    here p is the probablility of a photon being detected with a given wavelength , r is the response kernel , and s is the input spectral model . it should be noted that r and s are rarely analytic functions .",
    "the integral is normally computed numerically by converting the above expression into a sum .",
    "p is then compared directly with the detected data histogram .",
    "figures  [ fig : ptimage ] and  [ fig : ptbanana ] show the rgs response functions for an on - axis monochromatic source .",
    "simulation of the rgs with a monochromatic point source .",
    "the vertical axis is cross - dispersion and the horizontal axis is the dispersion angle .",
    "the two spots correspond to the first and second order point .",
    "the large angle scattering wings can be seen in both direction .",
    "the distribution depends on the incidence angle , energy , and dispersion angle .",
    ", height=113 ]     simulation of the rgs with a monochromatic point source .",
    "this is the same as figure  [ fig : ptimage ] but plotting the ccd energy vs. the dispersion angle .",
    "the scattering wings are still visible at the horizontal line and low pulseheight events are part of a partial event tail .",
    ", height=102 ]    when we extend this calculation to the case of an extended source , it becomes a three dimensional integral .",
    "@xmath12    calculating the three dimensional integral is impractical , since we must integrate over the sky coordinates ( @xmath2 and @xmath13 ) in addition to the wavelength .",
    "this is especially true if one wants to modify the model function , s , iteratively .",
    "often model fitting involves trying many different models and many different parameters .",
    "some approximations can be made , such as assuming the source s spectrum does not vary as a function of spatial position and assuming the response function does not change too much off - axis .",
    "these are useful in some circumstances , but the general case requires a monte carlo .",
    "then each photon can be chosen from a distribution of s with a @xmath4 , @xmath2 , and @xmath13 .",
    "this then can be converted to a @xmath3 , @xmath5 and @xmath8 by using probability response functions . in this way ,",
    "the probabilities of all possible @xmath3 , @xmath5 , and @xmath8 do not have to be calculated at every @xmath4 , @xmath2 , and @xmath13 .",
    "below we focus on two sets of challenges that had to be overcome in order to use monte carlos for efficient analysis of the data .",
    "the calculation of a single element of the rgs response is computationally intensive .",
    "this is due to the fact that many components of the response , such as the effect of the mirror , grating , and detector , have to be convolved in the calculation .",
    "each usually has its own energy and spatial dependence .",
    "for this reason it is extremely useful to save the response probabilities in pre - calculated tables .",
    "the probabilities can be looked up for each photon depending on its sky position and wavelength ( @xmath2 , @xmath13 , and @xmath4 ) .",
    "this then decreases the computation time by factors of @xmath14 or more .",
    "the two steps of looking up the instrument response , which is saved on coarse grids .",
    "the first panel shows monte carlo morphing and the second panel shows monte carlo interpolating .",
    "an explanation of the method is in the text.,height=566 ]    an immediate consequence of this , however , is that the multi - dimensional tables if saved at high enough resolution take up too much memory . for two dimensional tables",
    "this would not be the case .",
    "for the response for the rgs , however , the six dimensional function , @xmath15 , could only be broken into a series of two or three dimensional functions .",
    "these functions can only be saved in tables with coarse grids .    a solution to using the coarse grids",
    ", however , is to approximate the probability density functions between grid points as a linear combination of the response at the grid points . with a monte carlo ,",
    "this is accomplished by the following method . consider that the probability of a photon having a given @xmath3 for a given @xmath4 , @xmath16 , is calculated at two wavelengths , @xmath17 and @xmath18 as shown in the top panel in figure  [ fig : morph ] .",
    "if we want to know the response at some @xmath19 ( such that @xmath20 ) , the response function at @xmath17 can be used some fraction of the time and the response function at @xmath18 can be used the other fraction of the time .",
    "the fraction is determined by the distance @xmath19 is from @xmath17 and @xmath18 .",
    "an additional step is needed if the response functions have sharp peaks in them that shift as a function of @xmath3 .",
    "we then shift the output value , @xmath3 , by the first order behaviour of the response .",
    "say we use the probability distibution at @xmath18 and choose a @xmath3=@xmath21 based on the distribution , p(@xmath22 ) .",
    "the final value of @xmath3 is given by @xmath23 .",
    "@xmath24 is calculated by the dispersion equation .",
    "this method causes the distribution of @xmath3 to approach the probability distribution shown in the second panel in figure  [ fig : morph ] .",
    "the combined implementation of these two techniques results in photons being created at 50,000 events per second per ghz of processor speed and can be generalized to more dimensions .",
    "once this monte carlo is built , individual models can be used and then compared to the data . a procedure similar to that described in the flowchart in figure  [ fig : flowchart ] can be adopted .    * first , models are formulated in terms of a set of parameters .",
    "these parameters predict probability distributions for the spectral and spatial models .",
    "* photons are then drawn from these probability distributions and assigned a wavelength and two sky coordinates .",
    "( @xmath4 , @xmath2 , @xmath13 ) . * the dispersion , cross - dispersion , and pulseheight values ( @xmath3 , @xmath5 , @xmath8 ) are predicted from the instrument monte carlo .",
    "in addition , a background monte carlo predicts background events with @xmath3 , @xmath5 , and @xmath8 values . * finally ,",
    "the simulated events are compared with the measured photon events in a variety of ways .",
    "some of these methods are described in the next section .",
    "parameters are modified to improve the consistency of the data with the model .",
    "basic flowchart for the method of model comparison presented in this paper . ,",
    "height=680 ]     the prediction of the isobaric cooling flow model and comparison with the massive cooling - flow galaxy cluster , abell 1835 .",
    "the top panel shows the spectral prediction for cooling - flows .",
    "the middle panel shows the model ( blue ) compared with the observed data ( red ) .",
    "the bottom panel shows an empirical model with the emission below 2.7 kev suppressed.,height=680 ]",
    "there are a variety of methods to compare one set of detected events to another set of simulated events .",
    "a major advantage of the monte carlo approach , which has been recognized for some time , is that the simulated events can be selected and transformed in various ways in methods identical to what is done with the real data .",
    "there is then no need to worry about biasing the data or misinterpreting the detection , because a monte carlo already explicitly takes into account these data analysis steps .    in our case ,",
    "the transformation of the data into a binned spectrum takes several steps . for an extended source ,",
    "the assignment of wavelengths is not unique .",
    "the effect of various data selection cuts is difficult to correct for by any other method than an explicit monte carlo . with the monte carlo ,",
    "however , wavelength can be assigned by fixing the incidence angle , @xmath2 , in the same way for the simulated photons and the detected photons .",
    "the normalization is properly calculated by the direct sampling monte carlo method .",
    "a two - sample @xmath25 statistic can be constructed to compare the model with the data .",
    "if @xmath26 is the observed data values in the @xmath27th bin , and @xmath28 is the observed model values and there are @xmath29 events in the data and @xmath30 in the model , then the @xmath25 statistic is given by    @xmath31    this method has been applied in several cases . an important result is shown in figure  [ fig : cflow ] in the study of cooling - flows in massive clusters of galaxies ( peterson et al .",
    "@xcite ) . here",
    "it has been shown that the simple thermodynamic prediction for the soft x - ray spectrum of cooling - flows fails to reproduce the observed data .",
    "the model consists of the following .",
    "an isothermal envelope of hot plasma is surrounds a three dimensional cooling region with a different x - ray spectrum .",
    "the second x - ray spectrum consists of the unique model for an optically - thin multiphase isobaric cooling plasma .",
    "photons are chosen based on the plasma emissivity and then projected on the sky .",
    "an important aspect of the monte carlo method in this case was that the straight - forward theoretical description of the cluster had different spectra at each spatial position .      instead of explicitly extracting a subset of photons and assigning a wavelength based on the dispersion equation , a multi - dimensional event comparison statistic can be used .",
    "this is particularly important in estimating the background contribution to the detected events .",
    "the cramr - von mises statistic ( anderson and darling  @xcite ) is calculated in a similar way to the more familiar kolmogorov - smirnov statistic .",
    "it is determined by computing the cumulative distribution , @xmath32 of the @xmath29 data values and the cumulative distribution , @xmath33 of the @xmath30 model values and then evaluating the following sum at each of the model and data values .",
    "@xmath34}^2\\ ] ]    this works for one - dimensional data and is useful for sparse data .",
    "the multi - dimensional analog of this statistic is obtained by using a linear combination of the measured values ( @xmath3 , @xmath5 , and @xmath8 ) in each dimension , and using that for the value of @xmath35 in the above equation .",
    "various linear combinations can be used to emphasize one dimension over another , and it appears that summing over the various combinations results in a robust multi - dimensional statistic .",
    "a series of simulations in figure  [ fig : param ] demonstrates the use of this statistic .",
    "an example of model iteration using the cramr - von mises multivariate statistic .",
    "the top five plots show the projections of the data for five separate simulation .",
    "each set of three plots has the same meaning as the plots in figure  [ fig : s1101banana ] .",
    "the center simulation is a 1 kev isothermal beta model of a cluster of galaxies plus an instrument background model .",
    "top and bottom plots are the same simulation but with a larger and smaller , respectively , background fraction .",
    "the left and right plots are 0.5 and 2.0 kev simulations .",
    "the bottom countour plot shows the value of the cramr - von mises statistic for various combinations of the temperature and the background fraction of the model like those shown in the simulation above .",
    "it is compared to the simulation in the center plot .",
    "the contour plot then demonstrates the the statistic is capable of finding the right solution .",
    ", height=680 ]       cross - dispersion vs. dispersion angle images of emission lines of the elliptical galaxy , ngc 4636 .",
    "the vertical axis is the spatial distribution in the cross - dispersion axis in each emission line ; whereas , the horizontal axis is the wavelength .",
    "the images are ( from left to right ) , ne x , ne ix , fe xviii 2p-3d , fe xvii 2p-3d , fe xviii 2p-3s , fe xvii 2p-3s , and o viii",
    ". , height=566 ]     ratios of the number of photons as a function of cross - dispersion angle for various emission lines .",
    "this plot is made by selecting narrow wavelength regions ( horizontal axis ) in figure  [ fig : ngc4636image ] and then plotting the ratio of the number of counts .",
    "the same thing is done for a simulation with a temperature and density distribution and resonant scattering monte carlo . , height=604 ]    a final method of comparison involves explicitly looking at the cross - dispersion profile of an individual emission line .",
    "again , the precise interpretation of such a distribution is difficult without using a monte carlo to select the events and simulate the effect of the data selection .",
    "this is seen in the analysis of the elliptical galaxy , ngc 4636 ( xu et al .",
    "individual compressed emission line images can be seen in figure  [ fig : ngc4636image ] .",
    "differences in the spatial distribution of certain emission lines can be used to provide joint constraints on physical properities of the source .",
    "figure  [ fig : ngc4636xdsp ] shows three ratios of emission lines in the cross - dispersion direction .",
    "the first panel is an indication that the x - ray plasma is cooler in the center of the elliptical galaxy .",
    "the second panel is an indication that one emission line is optically thick and photons have been redistributed on the sky due to resonant line scattering .",
    "the third panel indicates that oxygen and iron have a similar spatial distribution .",
    "this yields joint contraints on the density and temperature structure and provides robust determinations of the abundances of various metals .",
    "an undesirable aspect of this method is that convergence of the model is complicated by the fact that the model has statistical noise in it as well .",
    "this is partly overcome by simulating far more events in the model than are detected in the data .",
    "additionally , careful consideration of what parameters affect what parts of the data allows the vast parameter space to be more efficiently searched .",
    "we expect new methods , however , could develop this further ."
  ],
  "abstract_text": [
    "<S> we discuss multivariate monte carlo methods appropriate for x - ray dispersive spectrometers . </S>",
    "<S> dispersive spectrometers have many advantages for high resolution spectroscopy in the x - ray band . </S>",
    "<S> analysis of data from these instruments is complicated by the fact that the instrument response functions are multi - dimensional and relatively few x - ray photons are detected from astrophysical sources . </S>",
    "<S> monte carlo methods are the natural solution to these challenges , but techniques for their use are not well developed . </S>",
    "<S> we describe a number of methods to produce a highly efficient and flexible multivariate monte carlo . </S>",
    "<S> these techniques include multi - dimensional response interpolation and multi - dimensional event comparison . </S>",
    "<S> we discuss how these methods have been extensively used in the xmm - newton reflection grating spectrometer in - flight calibration program . </S>",
    "<S> we also show several examples of a monte carlo applied to observations of clusters of galaxies and elliptical galaxies with the xmm - newton observatory . </S>"
  ]
}