{
  "article_text": [
    "let @xmath0 be a coxeter group .",
    "an element @xmath1 is said to be _ fully commutative _ if any reduced expression for @xmath2 can be obtained from any other one by transposing adjacent pairs of commuting generators .",
    "these elements were extensively studied by stembridge in the series of papers  @xcite-@xcite .",
    "he classified in  @xcite the coxeter groups having a finite number of fully commutative elements , which is independently done by graham in  @xcite , or fan in  @xcite in the simply  laced case .",
    "stembridge also gives in @xcite a useful characterizing property of full commutativity , by showing that reduced words for such an element can be viewed as the linear extensions of a _ heap _ , which is a certain kind of poset whose vertices are labeled by generators of @xmath0 .",
    "in @xcite , stembridge enumerates fully commutative elements for each of the previous finite cases , while connections with enriched @xmath3-partitions ( the letter @xmath3 stands here for  poset \" ) and schur s @xmath4-functions are studied in @xcite in types @xmath5 and @xmath6 .",
    "the original context for the appearance of full commutativity is algebraic and relates to the _ generalized temperley ",
    "lieb algebras_. the ( type @xmath7 ) _ temperley ",
    "lieb algebra _ was first defined in @xcite , in the context of statistical mechanics .",
    "later , it was realized by jones in  @xcite that it is a quotient of the _ iwahori  hecke algebra _ of type @xmath7 .",
    "this point of view was used by fan in  @xcite in the simply  laced case , and by graham in  @xcite in general , to define a generalized temperley ",
    "lieb algebra for each coxeter group .",
    "they proved that for any @xmath0 , the associated generalized temperley ",
    "lieb algebra admits a linear basis indexed by the fully commutative elements of @xmath0 .",
    "the set of fully commutative elements was also studied in connection to  _ kazhdan  lusztig cells _ , which form a partition of the coxeter group @xmath0 . in  @xcite , green and losonczy",
    "characterize when the set of fully commutative elements of a finite @xmath0 is a union of double - sided cells .",
    "this was extended to affine types in the works  @xcite of shi .",
    "other cells were defined and studied by fan  @xcite and fan and green  @xcite + the main goal of the present paper is to give a complete description , in terms of heaps , of fully commutative elements for each affine irreducible coxeter group . from this , we derive the generating functions of the fully commutative elements , according to the coxeter length , for all finite and affine coxeter groups : this extends naturally the work  @xcite of stembridge .",
    "our main characterization result is performed in a case - by - case fashion , so that it is split into several statements .",
    "these are theorem  [ theorem : walks_type_atilde ] in type @xmath8 , theorems  [ theo : affinecfamilles ] and  [ theo : affinebdfamilles ] for the other classical types , and the results of section  [ sub : affexcept ] in exceptional types .",
    "it can be summarized as follows .",
    "+ * main result * : _ for each affine irreducible coxeter group @xmath0 , we give an explicit description of its subset @xmath9 of fully commutative elements . _",
    "+ here , by  description \" , we mean that for each classsical type we define precisely disjoint families of heaps partitioning @xmath9 , and whose generating functions can all be computed .",
    "our characterizations naturally bring us to define a particular subfamily of elements in @xmath9 , which we call _ alternating _ fully commutative elements , and to which we can associate bijectively certain _",
    "lattice walks_. the latter are crucial for computing generating functions , as the various classes of lattice walks we are concerned with can all be decomposed by taking the coxeter length into account .",
    "we therefore derive an expression for @xmath10 , when @xmath0 is any finite or affine irreducible coxeter group , and @xmath11 denotes the coxeter length .",
    "this results in the following formal consequence , corresponding to corollary  [ cor : atilde ] ( _ resp",
    ". _ proposition  [ typea ] ) in type @xmath8 ( _ resp .",
    "_ @xmath7 ) and propositions  [ prop : gf_affc]-[prop : afftyped ] ( _ resp .",
    "_ proposition  [ typeb ] ) in types @xmath12 , @xmath13 and @xmath14 ( _ resp .",
    "_ @xmath5 and @xmath6 ) , while the results for exceptional types are given in section  [ sub : affexcept ] .",
    "+ * corollary a * : _ for each finite or affine group @xmath0 , we compute the generating function @xmath15 . _",
    "+ for the finite type @xmath7 , this recovers the nice @xmath16-analogue of the catalan numbers discovered by barcucci et al . in  @xcite , where they enumerated @xmath17-avoiding permutations ( corresponding here to the fully commutative elements ) according to their inversion number . in the case of the affine",
    "symmetric group @xmath8 , a similar @xmath16-analogue has been recently found by hanusa and jones in  @xcite ; from our analysis we find a much simpler expression than in  @xcite for the corresponding generating function . to our knowledge , for all other classical affine or finite types",
    "our results are new .",
    "moreover , thanks to our interpretations in terms of lattice walks , a striking consequence of our characterizations above is that , for any affine coxeter group @xmath0 , the _ growth sequence _ of @xmath9 ( the sequence of coefficients of @xmath15 ) is _ ultimately periodic_. this was already shown in type @xmath8 by hanusa and jones ( see  @xcite ) ; however our method settles positively a question in  @xcite regarding the beginning of the periodicity .",
    "these results correspond to theorem  [ theo : periodicitya ] in type @xmath8 and theorem  [ theo : periodicitybcd ] in types @xmath12 , @xmath13 and @xmath14 , and appear in section  [ sub : affexcept ] for exceptional types .",
    "+ * corollary b * : _ for each irreducible , affine group @xmath0 , the growth sequence of @xmath9 is _ ultimately periodic _ , with period recorded in the following table ( @xmath18 are finite sets ) : _",
    "@xmath19    in addition , theorems  [ theo : periodicitya ] and  [ theo : periodicitybcd ] also give the exact coxeter length at which the periodicity begins for classical types , while the corresponding result for exceptional types are recorded in section  [ sub : affexcept ] . from the generating functions , it is also possible to determine , for each affine coxeter group @xmath0 , the _",
    "mean value @xmath20 _ of the growth sequence , which is the arithmetic mean of the values over a period , or equivalently the limit of the arithmetic means of the @xmath21 first values of the growth sequence when @xmath21 tends to infinity .",
    "these are given by propositions  [ prop : meana ] and  [ prop : meanbcd ] in classical types , and easily computed from the results of section  [ sub : affexcept ] in exceptional types .",
    "+ finally , the periodicity result has an interesting consequence in terms of temperley - lieb algebras . recall that the growth of an algebra , with respect to a finite set of generators , is the function which associates to an integer @xmath11 the dimension of the vector space generated by all products of at most @xmath11 generators .",
    "+ * corollary c * : _ for any irreducible affine coxeter group with infinitely many fully commutative elements , the corresponding temperley ",
    "lieb algebra has _ linear growth . _ _ + we explain and refine this in detail in section  [ sub : tl ] .",
    "as we also explain in the same section , this algebraic viewpoint allowed us to use computer tools to deal with fully commutative elements .",
    "in particular , the package ` gbnp ` for ` gap `  @xcite , which uses noncommutative grbner basis techniques , was used intensively .",
    "in this first section , we will define fully commutative elements in coxeter groups .",
    "these elements can be regarded as certain commutation classes of words .",
    "therefore , following the approach of stembridge  @xcite , our central tool in studying fully commutative elements will be the structure of heaps , originally defined by viennot in  @xcite . in section  [ sub : alternating ] , we identify a particular class of these elements which occur naturally in classical types , and encode them bijectively by lattice walks .",
    "we recall finally the classification of finite and affine coxeter groups in section  [ sub : finiteaffine ] .",
    "let @xmath22 be a square symmetric matrix indexed by a finite set @xmath23 , satisfying @xmath24 and , for @xmath25 , @xmath26 .",
    "the _ coxeter group _ @xmath0 associated with the coxeter matrix @xmath22 is defined by generators @xmath23 and relations @xmath27 if @xmath28 .",
    "these relations can be rewritten more explicitly as @xmath29 for all @xmath30 , and @xmath31 where @xmath28 , the latter being called _ braid relations_. when @xmath32 , they are simply _ commutation relations _",
    "@xmath33 , sometimes referred to as short braid relations in the literature .    the _ coxeter graph _",
    "@xmath34 associated to @xmath35 is the graph with vertex set @xmath23 and , for each pair @xmath36 with @xmath37 , an edge between @xmath30 and @xmath38 labeled by @xmath39 .",
    "when @xmath40 the edge is usually left unlabeled since this case occurs frequently .",
    "therefore non adjacent vertices correspond precisely to commuting generators .    for @xmath41 ,",
    "the _ length _ of @xmath2 , denoted by @xmath42 , is the minimum length @xmath43 of any expression @xmath44 with @xmath45 .",
    "these expressions of length @xmath42 are called _ reduced _ , and we denote by @xmath46 the set of all reduced expressions of @xmath2 . a fundamental result in coxeter group theory , sometimes called the _",
    "matsumoto property _ is that any expression in @xmath46 can be obtained from any other one using only braid relations ( see for instance  @xcite ) .",
    "the notion of full commutativity is a strengthening of this property .",
    "[ defi : fc ] an element @xmath2 is _ fully commutative _",
    "( fc ) if any reduced expression for @xmath2 can be obtained from any other one by using only commutation relations .",
    "the following characterization of fc elements , originally due to stembridge , is particularly useful in order to test whether a given element is fc or not .    [ stembridge @xcite , prop .",
    "2.1 ] [ prop : caracterisation_fullycom ] an element @xmath41 is fully commutative if and only if for all @xmath47 such that @xmath48 , there is no expression in @xmath46 that contains the factor @xmath49 .",
    "it is clear that the condition is sufficient .",
    "now assume that @xmath50 has such a factor , then we get another reduced expression @xmath51 by applying the corresponding braid relation . but commutation relations can not modify the subword of @xmath52 in @xmath30 and @xmath38 , so @xmath51 is not in the same commutation class and @xmath2 is not fully commutative",
    ".    therefore an element @xmath2 is fc if all reduced words avoid all braid words ; since , by definition , @xmath46 forms a commutation class , the concept of heaps helps to capture the notion of full commutativity .",
    "we use the definition as given in  @xcite ( see also ( * ? ? ?",
    "* definition 2.2 ) ) , and discuss it afterwards .",
    "[ defi : heaps ] let @xmath34 be a finite graph with vertex set @xmath23 .",
    "a _ heap _ of type @xmath34 ( or @xmath34-heap ) is a finite poset @xmath53 , together with a labeling map @xmath54 , which satisfies the following conditions :    a.   [ it : heap1 ] for any vertex @xmath30 , the subposet @xmath55 is totally ordered , and for any edge @xmath36 , the subposet @xmath56 is totally ordered .",
    "b.   [ it : heap2 ] the ordering on @xmath57 is the transitive closure of the relations given by all chains @xmath58 and @xmath59 , i.e. the smallest partial ordering containing these chains .",
    "there is a more concrete way to reformulate condition : one has @xmath60 in @xmath57 if and only if there exist @xmath61 such that @xmath62 are equal or adjacent in the graph @xmath34 for all @xmath63 .",
    "two @xmath34-heaps are _ isomorphic _ if there exists a poset isomorphism between them which preserves the labels .",
    "the size @xmath64 of a heap @xmath57 is its cardinality . given any subset @xmath65",
    ", we will note @xmath66 the subposet induced by all elements of @xmath57 with labels in @xmath67 . in particular",
    "@xmath68 is the chain @xmath69 where @xmath70 is its cardinality .",
    "if @xmath47 are two labels such that @xmath37 , note that @xmath59 is also a chain .",
    "let us point out a simple operation on heaps : if @xmath71 is a heap , then its _ dual heap _ is @xmath72 , which is the heap with the inverse order where the labels are kept the same .",
    "it is clear that this is indeed a heap as in definition  [ defi : heaps ] .",
    "fix a word @xmath73 in @xmath74 , the free monoid generated by @xmath23 .",
    "define a partial ordering @xmath75 of the index set @xmath76 as follows : set @xmath77 if @xmath78 and @xmath79 is an edge of @xmath34 , and extend by transitivity .",
    "we denote by @xmath80 this poset together with @xmath81 .",
    "it is easy to see that this indeed forms a heap as in definition  [ defi : heaps ] .",
    "also , words from the same commutation class are sent to isomorphic heaps .",
    "[ prop : wordtoheap ] let @xmath34 be a finite graph .",
    "the map @xmath82 induces a bijection between @xmath34-commutation classes of words , and finite @xmath34-heaps ( up to isomorphism ) .",
    "the inverse bijection goes as follows : a _ linear extension _ of a poset @xmath57 is a linear ordering @xmath83 of the elements of @xmath57 such that @xmath84 implies @xmath85 .",
    "given a heap @xmath86 and a linear extension @xmath87 , construct the word @xmath88 in @xmath74 .",
    "applying this to all such linear extensions gives the wanted commutation class .",
    "in figure  [ fig : wordheap ] , we fix a ( coxeter ) graph on the left , and we give two examples of words with the corresponding heaps . in the hasse diagram of @xmath89 , elements with the same labels will be drawn in the same column .     two words and their respective heaps.,height=113 ]      we now fix a coxeter group @xmath0 with coxeter diagram @xmath34 . when @xmath2 is a fully commutative element , the heaps of its reduced words are all isomorphic by proposition  [ prop : wordtoheap ] , so we can give the following definition .",
    "if @xmath2 is a fc element and @xmath52 is a reduced word for it , define @xmath90 .",
    "heaps of this form will be called _",
    "fc heaps_.    for a fc heap @xmath91 , linear extensions of @xmath57 are in bijection with reduced words for @xmath2 .",
    "say that a chain @xmath92 in a poset @xmath57 is _ convex _ if the only elements @xmath93 satisfying @xmath94 are the elements @xmath95 of the chain .",
    "the next result gives an intrinsic characterization of _ fc heaps_.    [ prop : heaps_fullycom ] let @xmath34 be a coxeter graph .",
    "a @xmath34-heap @xmath57 is fc if and only if the following two conditions are verified :    * there is no convex chain @xmath96 in @xmath57 such that @xmath97 and @xmath98 where @xmath48 ; * there is no covering relation @xmath77 in @xmath57 such that @xmath99 .",
    "the heap on the right of figure  [ fig : wordheap ] is a fc heap , whereas the one on the left is not since it contains the convex chain with labels @xmath100 while @xmath101 .",
    "let @xmath35 be a coxeter system with coxeter graph @xmath34 .",
    "fc elements of @xmath0 are in bijection with @xmath34-heaps verifying the two conditions of proposition  [ prop : heaps_fullycom ] .    in the next section",
    "we will exhibit a class of heaps which play an important role for the affine coxeter systems we will study .",
    "[ defi : alternating ] consider a graph @xmath34 , and a @xmath34-heap @xmath57 .",
    "we say that @xmath57 is _ alternating _ if for each edge @xmath36 of @xmath34 , the chain @xmath59 has alternating labels @xmath30 and @xmath38 from bottom to top .",
    "a word @xmath102 is _ alternating _ if , for each edge @xmath36 , the occurrences of @xmath30 alternate with those of @xmath38 .",
    "clearly @xmath52 is alternating if and only if @xmath89 is .",
    "now let @xmath103 be a coxeter graph .",
    "say that a fc element @xmath2 is alternating if @xmath104 is . by using proposition  [ prop : heaps_fullycom ] we obtain the following characterization .",
    "[ prop : altfcheaps ] let @xmath57 be an alternating @xmath34-heap . then h is fc if and only if , for each vertex @xmath105 of degree @xmath106 , @xmath57 has at most one @xmath30-element or @xmath107 for the unique @xmath38 adjacent to @xmath30 .",
    "in the rest of this section , we fix @xmath108 in the set @xmath109 and we consider the coxeter system @xmath35 corresponding to the _ linear _ coxeter graph @xmath110 of figure  [ fig : linear_diagram ] .     the linear coxeter graph @xmath111 . ]    an alternating heap is presented in figure  [ fig : wordheappath ] .",
    "it is fc if and only if @xmath112 by proposition  [ prop : altfcheaps ] .",
    "the advantage of having alternating heaps in the case of linear diagrams is that they have a nice encoding by walks which we will explore in the sequel .",
    "the heap @xmath57 corresponding to the alternating word @xmath113 and its encoding by a walk.,scaledwidth=70.0% ]    [ defi : walks ] a _ walk _ of length @xmath114 is a sequence @xmath115 of points in @xmath116 with its @xmath114 steps in the set @xmath117 , such that @xmath118 has abscissa @xmath119 and all horizontal steps @xmath120 are labeled either by @xmath121 or @xmath122 .",
    "a walk is said to satisfy condition @xmath123 if all horizontal steps of the form @xmath124 have label @xmath121 .",
    "the set of all walks of length @xmath114 will be denoted by @xmath125 .",
    "the subset of walks ending at @xmath126 will be denoted by @xmath127 , and the subset of @xmath127 with @xmath128 will be denoted by @xmath129 .",
    "for short we will write @xmath130 for walks starting and ending on the @xmath131-axis .",
    "to each family @xmath132 corresponds subfamilies @xmath133 consisting of those walks in @xmath134 which satisfy the condition @xmath123 , and @xmath135 consisting of those walks which hit the @xmath131-axis at some point .",
    "[ rem : motztodyck ] write @xmath136 to represent steps @xmath137 , and @xmath138 to represent steps @xmath120 with these labels ; then we can encode our walks by the data of @xmath118 and a word in @xmath139 .",
    "consider the injective transformation on such words defined by @xmath140 .",
    "it is well known and easy to prove that this transformation restricts to a bijection from @xmath141 to _ length @xmath142 dyck walks _ , i.e. walks from @xmath143 to @xmath144 with steps @xmath136 staying above the @xmath131-axis .",
    "the _ total height _ @xmath145 of a walk is the sum of the heights of its points : if @xmath146 then @xmath147 .",
    "to each family @xmath148 we associate the series @xmath149 , and we define the generating functions in the variable @xmath131 by    @xmath150    we now define a bijective encoding of alternating heaps by walks , which will be especially handy to compute generating functions in the next sections .",
    "[ def : map_phi ] let @xmath57 be an alternating heap of type @xmath111 .",
    "to each vertex @xmath151 of @xmath111 we associate the point @xmath152 . if @xmath153 , we label the corresponding step by @xmath121 ( _ resp . _",
    "@xmath122 ) if the lowest element of the chain @xmath154 has label @xmath155 ( _ resp . @xmath151 _ ) .",
    "if @xmath156 , we label the @xmath63th step by @xmath121 .",
    "we define @xmath157 as the walk @xmath158 with its possible labels .",
    "this is illustrated in figure     [ theorem : walk_encoding ] the map @xmath159 is a bijection between alternating heaps of type @xmath111 and @xmath160 .",
    "the size @xmath64 of the heap is the total height of @xmath157 .",
    "the map is clearly well defined since for any alternating heap @xmath57 and any @xmath161 , we have @xmath162 .",
    "fix @xmath163 .",
    "if the step @xmath164 is equal to @xmath165 ( _ resp .",
    "_ @xmath166 ) , then we define a convex chain @xmath167 of length @xmath168 ( _ resp . _",
    "@xmath169 ) as @xmath170 ( _ resp .",
    "_ @xmath171 ) . if the step @xmath172 is labeled by @xmath121 ( _ resp .",
    "_ @xmath122 ) , then we define a convex chain @xmath167 of length @xmath173 as @xmath174 ( _ resp . _",
    "@xmath175 ) .",
    "next we define @xmath57 as the transitive closure of the chains @xmath176 .",
    "it is acyclic since @xmath111 is linear , so we get a heap @xmath57 which is uniquely defined , alternating , and satisfies @xmath177 . since @xmath178 the result follows .",
    "the irreducible coxeter systems corresponding to finite and affine coxeter groups are completely classified ( see  @xcite ) , and the corresponding graphs are depicted in figures  [ fig : finite_diagrams ] and  [ fig : affinediagrams ] .",
    "coxeter graphs for all irreducible finite types . ]",
    "coxeter graphs for all irreducible affine types . ]    for each coxeter group @xmath0 corresponding to one of these types , we denote by @xmath9 its set of fc elements and we define the generating function @xmath179    the sequence of coefficients of the above series will be called the _ growth sequence _ of @xmath9 .    section [ sec : a ] deals with groups of types @xmath180 and @xmath181 .",
    "sections  [ sec : bcd ] and [ sec : enum ] deal with the rest of the _ classical types _ , which are the remaining infinite families : it corresponds to affine types @xmath182 and finite types @xmath183 and @xmath184 . the last remaining cases , which are the so - called _ exceptional types _ , are studied in section  [ sec : excep ] , while section  [ sec : further ] will explore further works and questions related to our results , among which the application to temperley  lieb algebras .",
    "in this section we study the case of fc elements in @xmath0 of type @xmath180 and @xmath181 .",
    "these correspond to the affine symmetric group and the symmetric group , respectively .",
    "as such , fc elements were studied as they correspond to the so - called @xmath17-avoiding permutations in both cases , and the length function corresponds to the number of ( affine ) inversions .",
    "we will here study fc elements through the use of heaps in the case @xmath180 , and give a nice characterization of them in terms of certain lattice walks .",
    "we assume @xmath185 everywhere ( the special case @xmath186 is trivial as all its elements are fc ) .",
    "the generating function @xmath187 was first computed by hanusa and jones in  @xcite .",
    "they use the following well - known realization of the coxeter system of type @xmath188 as _ affine permutations_. consider the set of bijective transformations @xmath189 such that @xmath190 for all @xmath191 , as well as the normalization condition @xmath192 .",
    "they form a group @xmath193 under composition .",
    "it is known ( see @xcite ) that this group is isomorphic to the coxeter system of type @xmath188 , via the only morphism extending @xmath194 for @xmath195 , where @xmath196 is the affine permutation exchanging @xmath197 and @xmath198 for all @xmath199 .    under this isomorphism , it was shown by green in  @xcite that fc elements correspond to @xmath17-avoiding permutations , which are the permutations @xmath200 with no @xmath201 in @xmath202 satisfying @xmath203 .",
    "this generalizes the well - known result of billey , jockush and stanley from  @xcite for the case of the symmetric group .",
    "we first use the following proposition , essentially proved in green s paper  @xcite .",
    "[ prop : caracterisation_atilde ] an element @xmath2 of type @xmath188 is fully commutative if and only if , in any reduced decomposition of @xmath2 , the occurrences of @xmath204 and @xmath205 alternate for all @xmath206 , where we set @xmath207 .    the condition is clearly sufficient by using proposition  [ prop : caracterisation_fullycom ] . to show that it is necessary , assume @xmath208 and @xmath209 is a reduced word for @xmath2 . for",
    "the sake of contradiction , let us assume that there exist @xmath206 and @xmath210 such that @xmath211 and that for all @xmath131 satisfying @xmath212 one has @xmath213 . among all possible integers @xmath214 ,",
    "pick one with @xmath215 minimal .",
    "now consider the number @xmath216 of indices @xmath131 with @xmath212 and @xmath217 .",
    "if @xmath218 , then by successive commutations we see that the word is not reduced , which is excluded . if @xmath219 , then by successive commutations one obtains a factor @xmath220 which is excluded by proposition  [ prop : caracterisation_fullycom ] .",
    "if @xmath221 , then we have two consecutive occurrences of @xmath222 contradicting the minimality of @xmath215 .",
    "this finishes the proof .",
    "this shows that fc heaps for the graph of type @xmath188 coincide exactly with alternating heaps ; we will use this characterization to encode these heaps as certain paths in section  [ sub : path_encoding ] .",
    "we shall represent heaps of type @xmath223 by depicting all ( alternating ) chains @xmath224 for @xmath225 . to be able to represent these chains in a planar fashion , we duplicate the set of @xmath226-elements and use one copy for the depiction of the chain @xmath227 and one copy for @xmath228 .",
    "this can be seen in figure  [ fig : atildeheap_slanted ] , where the ",
    "drawn on a cylinder \" representation on the right is a deformation of the first one which makes more visible its poset structure .",
    "representation of a fc heap of type @xmath229.,scaledwidth=60.0% ]      we are not exactly in the case of section  [ sub : alternating ] since the coxeter graph is not linear .",
    "one can nonetheless define walks from the alternating heaps described in proposition  [ prop : caracterisation_atilde ] , as follows : given a fc heap @xmath57 of type @xmath188 and @xmath225 , draw a step from @xmath230 to @xmath231 as in definition  [ def : map_phi ] for @xmath232 ; here we set @xmath207 .",
    "this forms a path @xmath233 of length @xmath114 , with both @xmath118 and @xmath234 at height @xmath235 .",
    "if @xmath236 , we can set @xmath237 since we showed that all fc heaps are alternating .",
    "define accordingly @xmath238 as the paths in @xmath239 whose starting and ending points are at the same height .",
    "define also @xmath240 , which corresponds to the area under @xmath3 , and let @xmath241 and @xmath242 be the generating functions with respect to @xmath243 of @xmath238 and @xmath244 respectively .",
    "finally , denote by @xmath245 the set of walks with all vertices at the same positive height , and all @xmath114 steps with the same label ( either @xmath121 or @xmath122 ) .",
    "[ theorem : walks_type_atilde ] the map @xmath246 is a bijection such that @xmath247 .",
    "* @xmath248 is well defined : * we have to show that @xmath249 can not belong to @xmath250 .",
    "let @xmath251 and consider any reduced word @xmath52 for it .",
    "set @xmath252 the indices in @xmath52 of the leftmost occurrences of the letters @xmath253 respectively ( if a @xmath204 does not occur then clearly @xmath254 ) .",
    "now assume @xmath249 consists of horizontal steps all labeled @xmath122 ( _ resp .",
    "@xmath121 _ ) : by construction , this would entail @xmath255 ( _ resp . _",
    "@xmath256 ) which is a contradiction .",
    "* @xmath248 is injective : * by theorem  [ theorem : walk_encoding ] , the walk @xmath249 allows us to reconstruct uniquely @xmath257 . indeed",
    "each step @xmath258 encodes the chain @xmath224 , and @xmath57 is the transitive closure of these chains by definition  [ defi : heaps ] .",
    "* @xmath248 is surjective : * let @xmath3 be a walk in @xmath259 .",
    "each step @xmath258 of @xmath3 encodes a chain @xmath260 , considered here as an oriented path with vertices @xmath261 for @xmath262 and @xmath263 for @xmath264 .",
    "what we must show is that the oriented , labeled graph @xmath265 formed by the union of these chains is an _",
    "acyclic _ graph , which means that it possesses no oriented cycle . in this case",
    ", @xmath265 naturally determines a labeled poset , which is an alternating heap @xmath57 such that @xmath266 .    for each @xmath267 , we denote by @xmath268 the elements of @xmath265 labeled @xmath204 from bottom to top . by rotational symmetry ,",
    "it is enough to show paths starting from a vertex @xmath269 can not also end at @xmath269 .",
    "the key property of @xmath265 is the following : if @xmath270 , then @xmath271 or @xmath272 ; this follows readily from the alternating condition .",
    "an immediate consequence is that the vertices @xmath261 involved in a possible cycle of @xmath265 necessarily have all the same index @xmath273 .",
    "another easy remark is that if @xmath274 , then @xmath275",
    ". therefore steps in a given cycle in @xmath265 must be all of the form @xmath276 , or all of the form @xmath277 .    since @xmath278",
    ", we claim that there exists @xmath267 such that either @xmath279 or @xmath280 : indeed , if these bottom points were strictly increasing or decreasing in @xmath265 , the same would be true for top points , and this would correspond to a path in @xmath250 . from this",
    "we can deduce that there is no cycle from @xmath281 to itself .",
    "now assume there exists a cycle from @xmath269 to itself for a @xmath282 , and pick @xmath273 minimal with this property .",
    "this cycle can only involve vertices of the form @xmath261 as seen above , and because of the alternating property , replacing @xmath273 by @xmath283 creates a cycle from @xmath284 to itself .",
    "this contradicts the minimality of @xmath273 , and completes the proof of surjectivity .",
    "let @xmath285 denote the number of fc elements of type @xmath223 and of length @xmath11 .",
    "[ theo : periodicitya ] fix @xmath286 . in type @xmath223 ,",
    "the growth sequence @xmath287 is ultimately periodic of period @xmath114 .",
    "moreover periodicity starts at length @xmath288 , where @xmath289 .    by theorem  [ theorem : walks_type_atilde ] , @xmath285 is the number of walks in @xmath259 with area @xmath11 .",
    "assume @xmath11 is large enough so that paths of area @xmath11 will not have any horizontal step at height @xmath119 .",
    "in this case @xmath290 which shifts every vertex up by one unit ( and preserves labels @xmath138 ) is a bijection .",
    "a simple calculation shows that @xmath291 is the largest area for which there exists such a path in @xmath292 with a horizontal step at height @xmath119 ( see illustration below ) .",
    "it is easy to show that @xmath293 when @xmath114 is odd and @xmath294 when @xmath114 is even , which completes the proof .",
    "the periodicity was proved in @xcite , while the exact beginning of periodicity was only conjectured by the authors .",
    "[ cor : atilde ] the generating function of fc elements of type @xmath223 is @xmath295 moreover , @xmath296 can be computed through the equations : @xmath297 here @xmath298 and @xmath299 are calculated thanks to   and  .    by theorem  [ theorem : walks_type_atilde ]",
    ", we directly have that @xmath300 .",
    "now we have to count walks in @xmath301 , and to this end we decompose them according to the lowest height they reach as follows :        this gives the equation @xmath302 , and therefore  . finally , to compute @xmath303 and @xmath304 , note that walks in @xmath305 ( _ resp . _",
    "@xmath306 ) either belong to @xmath307 ( _ resp . _",
    "@xmath141 ) or can be decomposed as in the picture below :        here the central part is a path in @xmath308 ( _ resp . _",
    "@xmath309 ) , for some integer @xmath273 .",
    "the two other parts can be joined to form a path in @xmath310 where @xmath311 , shifted up , and with a marked vertex to record where the parts are glued .",
    "the area generating polynomial of these marked paths is given by @xmath312 , whose generating function is @xmath313 and the equations   follow .",
    "we now give the following result , whose easy proof is left to the reader .",
    "[ lemma : periodic ] suppose @xmath314 where @xmath315 is a positive integer and @xmath316 is a polynomial of degree @xmath317",
    ". then one has @xmath318 for all @xmath319 .",
    "furthermore the mean value over a period @xmath320 for @xmath319 is equal to @xmath321 .",
    "[ prop : meana ] the mean value @xmath322 of @xmath287 is equal to @xmath323    by lemma  [ lemma : periodic ] and corollary  [ cor : atilde ] , we have to prove @xmath324 . to see this , shift any path of @xmath305 so that it starts at the origin , and use the transformations @xmath140 defined in remark  [ rem : motztodyck ] .",
    "this is a bijection from @xmath305 to _ bilateral _ paths , i.e. paths from the origin to @xmath144 using steps @xmath325 or @xmath6 .",
    "there are obviously @xmath326 such paths , which concludes the proof .",
    "we can deduce results in type @xmath7 from those in type @xmath327 .",
    "fc elements of type @xmath181 are in bijection with fc elements of type @xmath223 whose reduced expressions have no occurrence of @xmath226",
    ". therefore by theorem  [ theorem : walks_type_atilde ] , fc elements of type @xmath181 are in bijection with elements of @xmath328 with starting and ending points at height @xmath119 , which is precisely the set @xmath141 .",
    "since weights are preserved , we deduce the following enumerative result about @xmath329 , which was obtained in a different way by barcucci et al . in  @xcite .",
    "[ typea ] we have @xmath330 , and equivalently @xmath331    in particular , since @xmath141 is in bijection with dyck walks by remark  [ rem : motztodyck ] , this shows that @xmath332 has cardinality the @xmath114th catalan number @xmath333 : this is a well - known result , which is proved for example in  @xcite .",
    "[ italiens ] the generating function @xmath334 satisfies the following functional equation @xmath335    we have the following walk decompositions with corresponding equations :        @xmath336        @xmath337    the identity   gives @xmath338 , which can be replaced in   to yield after some simplifications : @xmath339 finally , we see through proposition  [ typea ] that   is exactly equation  .",
    "corollary  [ italiens ] gives another proof of  ( * ? ? ?",
    "* eq . ( 3.0.2 ) ) , where @xmath334 is denoted by @xmath340 . in their work , barcucci et al . also proved an expression for @xmath340 as a quotient of @xmath16-bessel type functions , using a recursive rewriting rule for @xmath17-avoiding permutations and a result of bousquet - mlou  ( * ? ? ?",
    "* lemma  2.2 ) .",
    "it is possible to derive their ratio of @xmath16-bessel functions by writing @xmath341 where @xmath342 stands for the classical @xmath16-rising factorial , and @xmath343 is a @xmath16-hypergeometric coefficient .",
    "then plugging   into   yields @xmath344 , from which we deduce @xmath345 and finally @xmath346 , as in  @xcite .",
    "there are many papers which investigate fully commutative elements in type @xmath327 , and in some of them one can find explicit characterizations of these elements",
    ". we will give a brief account of the four works related to the present one we could find in the literature , and explain their relationship with ours .",
    "we also believe this is all the more a worthy enterprise since , based on their respective citations , none of these works seemed to be aware of the earlier ones .",
    "the first work  @xcite is due to fan and green and does not explicitly set out to characterize fully commutative elements .",
    "its goal is to study the temperley ",
    "lieb algebra of type @xmath327 , which has a basis indexed by fc elements .",
    "the authors then give a diagrammatic representation of this algebra , by sending the aforementioned basis to an explicit basis of admissible diagrams .",
    "this last basis being rather explicit , it gives in return some characterization of fc elements ; see section  [ sub : diagramtl ] for more informations .    the second article  @xcite of hagiwara deals with _ minuscule heaps of type @xmath327_. in general , minuscule heaps are a strict subset of fc heaps , but here they coincide , as the author shows in his theorem 5.1 .",
    "his characterization goes by embedding posets in a family of slanted lattices @xmath347 , and hagiwara proves that fc heaps are precisely the finite convex subsets occurring in a lattice @xmath347 .",
    "it can be easily seen that this is a corollary of our work ; the gradient @xmath21 defined in  @xcite can be seen in the path @xmath233 as the sum of the number of up steps and the number of horizontal @xmath122 steps .",
    "the paper  @xcite by hanusa and jones was already mentioned several times . here",
    "the fc permutations are classified and counted by dividing them first into long and short ones .",
    "long permutations are easily counted and have a pleasing generating function , while the enumeration of short ones requires several pages resulting in a rather complicated generating function .",
    "as mentioned before , we could confirm their conjecture about the precise beginning of the periodicity .",
    "one can see _ a posteriori _ that we could manage this by considering all elements in our approach , without dividing them beforehand into adequate `` long '' and `` short '' ones .    in the recent work  @xcite by al harbat , the author classifies fc elements by indicating a normal form for each of them .",
    "that is , the main theorem exhibits a family of reduced fc expressions where each fc element is represented exactly once .",
    "we will not detail this here , but these normal forms correspond to a particular linear extension of fc heaps which is fairly easy to describe .",
    "in this section we classify fc elements in types @xmath349 , and @xmath350 thanks to their heaps . as could be perhaps expected , the problem is much subtler than in type @xmath223 and in particular several kinds of elements appear .",
    "the pleasant part about our point of view is that we are able to formulate our proof so that the same one essentially works for all three cases .    in each case",
    "we will show that the growth sequence of fc elements is ultimately periodic , and we will be able to compute the generating function . finally , we can easily specialize our characterizations to finite types @xmath183 and @xmath184 , and obtain enumerative results .",
    "we need a couple of notations .",
    "peak _ is a heap of the form @xmath352 or @xmath353 . if @xmath57 is a heap of type @xmath351 and @xmath354 , then @xmath355 ( _ resp . _",
    "@xmath356 ) denotes the restriction of @xmath57 to the labels @xmath357 ( _ resp . _",
    "@xmath358 ) .",
    "[ def : famillesctilde ] we define the five following families of heaps of type @xmath351 .    * ( alt ) * _ alternating heaps_. @xmath359 ( alt ) if it is alternating in the sense of definition  [ defi : alternating ] where @xmath34 is the coxeter diagram @xmath351 .    *",
    "( zz ) * _ zigzags_. @xmath359 ( zz ) if @xmath360 where @xmath52 is a finite factor of the infinite word @xmath361 such that @xmath362 for at least one @xmath363 .    * ( lp ) * _ left - peak_. @xmath359(lp ) if there exists @xmath364 such that :    1 .   @xmath365 ; 2 .   if @xmath366 then there is no @xmath367-element between the two @xmath368-elements ; if @xmath369 then there is no @xmath93-element between the two @xmath370-elements ; 3 .",
    "@xmath371 is alternating when one @xmath368-element is deleted .    *",
    "( rp ) * _ right - peak_. @xmath359 ( rp ) if there exists @xmath372 such that :    1 .   @xmath373 ; 2 .",
    "if @xmath374 then there is no @xmath375-element between the two @xmath376-elements ; if @xmath377 then there is no @xmath38-element between the two @xmath378-elements .",
    "@xmath379 is alternating when one @xmath376-element is deleted .    *",
    "( lrp ) * _ left - right - peak_. @xmath359 ( lrp ) if there exist @xmath380 such that :    1 .",
    "lp(1 ) , lp(2 ) , rp(1 ) , rp(2 ) hold ; 2 .",
    "@xmath381 is alternating when both a @xmath368- and a @xmath376-element are deleted .    before stating the main theorem",
    ", we make a couple of important remarks on these definitions .",
    "[ rem : familyzz ] the condition @xmath382 in the definition of ( zz ) is only there to ensure that the families are disjoint , as we will see in proposition  [ prop : sufficient ] .",
    "[ rem : familypeaks ] in families ( lp ) , ( rp ) , ( lrp ) , the indices @xmath273 and @xmath21 are _ uniquely determined _ ; this will be particularly useful for enumerating purposes .",
    "the _ extremal cases _ for these families are the heaps having no chain @xmath224 which alternates for @xmath383 .",
    "they correspond to @xmath384 or @xmath385 in the case of family ( lp ) ; @xmath377 or @xmath386 for the family ( rp ) ; and @xmath387 or @xmath386 in the case of family ( lrp ) .",
    "these possibilities are illustrated in figure  [ fig : extremal_heaps ] , up to obvious horizontal or vertical symmetries .",
    "we can now state the main theorem of this section .",
    "[ theo : affinecfamilles ] a heap of type @xmath351 is fully commutative if and only if it belongs to one of the five families ( alt ) , ( zz ) , ( lp ) , ( rp ) , ( lrp ) .",
    "we start with the easy direction , by showing that these families contain indeed only fully commutative elements .    [",
    "prop : sufficient ] the families ( alt ) , ( zz ) , ( lp ) , ( rp ) , ( lrp ) are pairwise disjoint , and contain only fully commutative heaps of type @xmath351 .",
    "let @xmath57 be a heap of type @xmath351 belonging to one of the five families .",
    "if @xmath388 ( alt ) , we have by proposition  [ prop : altfcheaps ] that it is a fc heap .",
    "now condition @xmath389 of proposition  [ prop : heaps_fullycom ] is easily verified by inspection for all families , so we must verify condition @xmath390 .",
    "this is clear for ( zz ) .",
    "for the three remaining families , a bad convex chain neither occurs inside the peak parts , nor inside the alternating parts .",
    "the only chains to verify are those occurring at the junction of these parts , and concern labels @xmath391 and @xmath367 ( families ( lp ) and ( lrp ) ) and labels @xmath392 and @xmath375 ( families ( rp ) and ( lrp ) ) .",
    "it is an easy verification that no bad convex chain occurs , which concludes the proof that all heaps are indeed fc .    to see that the families are disjoint",
    ", we notice that ( alt ) is the only family containing alternating heaps .",
    "also ( zz ) is the only family with no alternating chain @xmath224 and at least three @xmath393-element for a certain @xmath393 : indeed , if @xmath57 is in ( lp ) , ( rp ) or ( lrp ) , it has no alternating chain only in the extreme cases singled out in remark  [ rem : familypeaks ] , the corresponding possible heaps being illustrated in figure  [ fig : extremal_heaps ] . by inspection ,",
    "one notes that for any @xmath394 . finally , the families ( lp ) , ( rp ) or ( lrp ) are pairwise disjoint since they are easily distinguished by comparing their peaks .",
    "we now collect three lemmas , which will be useful in the proof of theorem  [ theo : affinecfamilles ] .",
    "[ lemma : forbiddenc ] let @xmath57 be a fc heap of type @xmath351 , and @xmath395 . then in @xmath396 there is no factor equal to :    \\(1 ) @xmath397 , ( 1 ) @xmath398 , or ( 2 ) @xmath399 .",
    "[ lemma : peakc ] suppose that there exists @xmath400 such that @xmath396 contains the factor @xmath401 .",
    "then the interval of @xmath57 between the two corresponding @xmath402-elements is isomorphic to a peak @xmath403 .",
    "[ lemma : zigzagc ] let @xmath57 be a fc heap of type @xmath351 having two @xmath204-elements delimitating an interval of the form @xmath403 or @xmath404 for some @xmath405 . if @xmath57 contains at least another @xmath204-element , then @xmath406 ( zz ) .",
    "these three lemmas will be proved in section  [ sub : proofs ] in a more general context .",
    "note that lemma  [ lemma : zigzagc ] is equivalent to  ( * ? ? ?",
    "* lemma 3.3.6 ) .    ]    by proposition  [ prop : sufficient ] , it remains to show that all fc heaps belong to one of the five families of definition  [ def : famillesctilde ] .",
    "so let @xmath57 be a fc heap of type @xmath351 , and consider the two following properties :    * there exists @xmath407 such that @xmath408 is alternating ; * there exists @xmath409 such that @xmath410 .",
    "@xmath411 assume first that @xmath57 satisfies @xmath412 .",
    "denote by @xmath273 the smallest such @xmath413 , and let @xmath414 be the largest index such that @xmath415 is alternating .",
    "if @xmath416 , so that @xmath417 is alternating , then the full commutativity of @xmath57 implies that @xmath418 is also alternating , and thus we have that @xmath419 is alternating .    if @xmath420 , then @xmath421 is alternating , but @xmath422 is not . since @xmath421 is alternating there exists at least one @xmath423-element between two @xmath376-elements ; and since @xmath422 is not alternating there exist two @xmath423-elements with no @xmath376-element between them .",
    "by lemma  [ lemma : forbiddenc ] this is only possible if @xmath424 and @xmath425 .",
    "hence by lemma  [ lemma : peakc ] , @xmath57 verifies conditions ( rp)(1 ) and ( 2 ) .",
    "symmetrically , @xmath426 implies @xmath427 alternating while @xmath282 implies that @xmath57 verifies conditions ( lp)(1 ) and ( 2 ) .",
    "putting things together , we obtain @xmath428 if @xmath426 and @xmath416 ; @xmath388 ( rp ) if @xmath426 and @xmath420 ; @xmath388 ( lp ) if @xmath282 and @xmath416 ; @xmath388 ( lrp ) if @xmath282 and @xmath420 .",
    "@xmath411 assume now that @xmath429 holds but not @xmath412 . if @xmath430 , using the fact that @xmath431 is not alternating , and the forbidden configurations of lemma  [ lemma : forbiddenc ] , there exist necessarily two @xmath432-elements with no @xmath433-element between them . by lemma  [ lemma : peakc",
    "] this implies that the interval between the two @xmath432-elements is a peak @xmath434 , and by lemma  [ lemma : zigzagc ] we can conclude that @xmath406 ( zz ) .",
    "@xmath411 assume finally that @xmath57 satisfies neither @xmath412 nor @xmath429 , so that no chain @xmath224 is alternating and no @xmath204-element occurs more than twice .",
    "there is an @xmath435 such that @xmath436 , otherwise the heap would be alternating .",
    "suppose @xmath437 .",
    "since @xmath408 is not alternating , there is either @xmath119 or @xmath386 @xmath438-elements between the two @xmath393-elements . in the first case we have a peak @xmath439 and in the second we have a peak @xmath440 , by applying lemma  [ lemma : peakc ] .",
    "if @xmath441 , we can apply the same reasoning with @xmath442 .",
    "so without loss of generality , we have the existence of a peak @xmath440 ; we choose @xmath413 minimal with this property .",
    "it is now easy though a little tedious to identify all possible heaps ; we just give the end result , using the cases ( a)-(g ) of figure  [ fig : extremal_heaps ] . if @xmath443 , the possibilities are cases ( a ) and ( b ) .",
    "if @xmath444 , let @xmath445 .",
    "if @xmath218 , the possibilities are ( d ) if @xmath446 , and ( e ) otherwise . if @xmath219 , the possibilities are ( c ) if @xmath446 , and ( e ) or ( f ) otherwise .",
    "finally for @xmath447 the possibilities are ( e ) or ( g ) .",
    "so we always obtain heaps belonging to ( lp ) , ( rp ) or ( lrp ) , which achieves the proof .",
    "we will define some operations of substitution , which we use to characterize fc heaps in types @xmath448 and @xmath350 starting from fc heaps in type @xmath351 .",
    "the result can be summarized as follows : a fc heap of type @xmath448 always comes from a fc heap of type @xmath351 in which @xmath38-elements were replaced by elements labeled @xmath449 or @xmath450 , while a fc heap of type @xmath350 always comes from a fc heap of type @xmath351 in which additionally @xmath93-elements were replaced by elements labeled @xmath451 or @xmath452 .",
    "we now make these replacements precise .        * substitutions @xmath453 and @xmath454 : * let @xmath57 be a fc heap of type @xmath351 , and we fix a word @xmath52 such that @xmath360 ( the operations do not depend on the word @xmath52 which is chosen ) .",
    "we define a set @xmath455 which is a collection of heaps of type @xmath448 deduced from @xmath57 , as follows :    @xmath411 @xmath57 is in ( lp ) or ( lrp ) .",
    "there is a unique @xmath38-element in @xmath57 coming from a peak @xmath404 . in this case @xmath456 where @xmath457 is obtained by replacing @xmath38 by @xmath450 in @xmath52 .",
    "@xmath411 @xmath57 is in ( zz ) .",
    "it is a chain so @xmath52 is uniquely determined .",
    "replace once again @xmath38 by @xmath450 in @xmath52 for all @xmath38 ; in the case where @xmath52 starts or ends with @xmath38 , these occurrences can be replaced also by @xmath458 or @xmath459 .",
    "then @xmath455 is the collection of the possible replacements : it has @xmath106 element if @xmath52 neither starts nor ends with @xmath38 , @xmath460 elements if @xmath52 starts or ends with @xmath38 but not both , and @xmath461 elements if @xmath52 both starts and ends with @xmath38 .",
    "@xmath411 @xmath57 is in ( alt ) or ( rp ) .",
    "if @xmath57 contains no @xmath38-element , define @xmath462 . if @xmath57 contains exactly one @xmath38-element , @xmath463 where @xmath464 ( _ resp .",
    "_ @xmath465 , _ resp .",
    "_ @xmath466 ) is obtained by replacing @xmath38 by @xmath450 ( _ resp .",
    "_ @xmath458 , _ resp . _",
    "@xmath467 ) in @xmath52 . if @xmath57 contains more than one @xmath38-element , then @xmath468 , where @xmath464 ( _ resp . _",
    "@xmath465 ) is obtained by replacing the occurrences of @xmath38 from first to last alternatively by @xmath458 and @xmath467 , starting with @xmath458 ( _ resp .",
    "_ @xmath467 ) .",
    "there is one special case , @xmath469 ( cf .",
    "figure  [ fig : extremal_heaps](a ) ) , in which @xmath38-elements can be independently replaced by @xmath458 , @xmath467 or @xmath450 .",
    "we also define @xmath470 which is a set of heaps of type @xmath350 where the substitutions above are also performed similarly on @xmath93-elements .",
    "[ def : famillesbdtilde ] if @xmath471 is one of the five families of fc heaps of type @xmath351 from definition  [ def : famillesctilde ] , we define the corresponding family @xmath472 ( _ resp . _",
    "@xmath473 ) as family @xmath474 ( _ resp . _",
    "@xmath475 ) .",
    "the families are disjoint , since one can easily recover @xmath57 from @xmath455 or @xmath470 , and then use proposition  [ prop : sufficient ] .",
    "[ theo : affinebdfamilles ] a heap of type @xmath448 ( _ resp .",
    "_ @xmath350 ) is fully commutative if and only if it belongs to one of the families of definition  [ def : famillesbdtilde ] .",
    "it is a simple verification to show that the substitution @xmath453 do not create any bad convex chains @xmath476 or @xmath477 , and similarly for chains involving @xmath478 or @xmath479 . for other types of chains ,",
    "we deduce easily from proposition  [ prop : sufficient ] that they also satisfy proposition  [ prop : heaps_fullycom ] .",
    "therefore heaps from the families of definition  [ def : famillesbdtilde ] are all fc .",
    "now let @xmath57 be a fc heap of type @xmath448 or @xmath350 . by the results of section  [ sub : proofs ] , lemma  [ lemma : forbiddenc ] still holds .",
    "now in type @xmath448 , change @xmath38 into @xmath450 in the definition of @xmath404 , and in type @xmath350 , change in addition @xmath93 into @xmath452 in the definition of @xmath403 .",
    "then lemmas  [ lemma : peakc ] and  [ lemma : zigzagc ] still hold if ( zz ) is replaced by ( zz)@xmath480 or ( zz)@xmath481 in the conclusion of lemma  [ lemma : zigzagc ] ; they are indeed specializations of lemmas  [ lemma : forbidden ] and  [ lemma : peak ] .    now",
    "the proof of theorem  [ theo : affinebdfamilles ] in type @xmath351 rests almost uniquely on these lemmas .",
    "there is only one exception , which is the fact that if @xmath482 alternating , then @xmath483 is alternating .",
    "the corresponding statement in type @xmath448 or @xmath350 , which is easily verified , is the following : under the same hypothesis that @xmath482 is alternating , then @xmath484 is obtained from an alternating @xmath483 by the substitution @xmath453 in the case ( alt ) described above .    in conclusion",
    "the proof of theorem  [ theo : affinecfamilles ] can be mimicked almost verbatim here . by inspection",
    ", the end result is that the heap @xmath57 is necessarily a member of one of the families of definition  [ def : famillesbdtilde ] , and the proof is complete .",
    "we give here the proofs of the lemmas used in the previous subsections .",
    "we will actually prove them in a more general context , and we will use for this the following additional lemma , which might be useful to investigate fc heaps for more general coxeter graphs .",
    "[ lemma : local ] consider a coxeter graph @xmath34 possessing @xmath460 vertices @xmath485 with @xmath486 and @xmath487 for @xmath488 .",
    "let @xmath57 be a fc heap of type @xmath34 , and assume @xmath489 contains a factor @xmath52 where ( a ) the @xmath490-elements are never consecutive and ( b ) there exist two @xmath491-elements which are consecutive .",
    "consider then the factor @xmath51 of the word @xmath492 induced by the @xmath491-elements of @xmath52",
    ". then properties ( a ) and ( b ) , with @xmath493 being replaced by @xmath494 respectively , hold in @xmath51 .    between two @xmath491-elements",
    "@xmath495 occurring in @xmath52 , there is by hypothesis zero or one @xmath490-element ; by proposition  [ prop : heaps_fullycom ] , there must then be at least two @xmath496-elements in the first case and at least one in the second case .",
    "therefore @xmath51 satisfies both ( a ) and ( b ) .",
    "now we prove the following lemma , which obviously implies lemma  [ lemma : forbiddenc ] .",
    "[ lemma : forbidden ] let @xmath34 be a coxeter graph containing a branch of type @xmath5 or @xmath6 ( see figure [ fig : branch - typebd ] ) .",
    "let @xmath57 be a fc heap of type @xmath34 .",
    "then for any @xmath497 , the word @xmath498 contains no factor equal to :    \\(1 ) @xmath499 , ( 1 ) @xmath500 , or ( 2 ) @xmath501 .",
    "a graphical illustration of the forbidden factors is given in figure  [ fig : forbidden ] .",
    "suppose @xmath502 and the branch is of type @xmath5 .",
    "it is easy to see that in @xmath503 there are no factors of type ( 1 ) , ( 1 ) , or ( 2 ) . indeed , since @xmath57 is fc , by proposition  [ prop : heaps_fullycom ] there should be a @xmath131-element between any two consecutive @xmath504-elements .",
    "this would give rise to convex chains labeled either @xmath505 or @xmath506 , contradicting proposition  [ prop : heaps_fullycom ] .",
    "similarly , in the type @xmath6 case , any two consecutive @xmath504-elements must be separated either by an occurrence of a @xmath507- or a @xmath508-element , or both .",
    "all possibilities are again excluded by proposition  [ prop : heaps_fullycom ] .",
    "now if @xmath509 and the factor is of type ( 1 ) or ( 1 ) , an immediate application of lemma  [ lemma : local ] shows that such a factor also occurs in @xmath510 , and we are done by induction . if the factor is of type ( 2 ) , then @xmath510 contains necessarily a factor @xmath511 , which is impossible since it includes factors of type ( 1 ) and ( 1 ) .",
    "the end of the proof also applies easily to exclude the occurrence of three @xmath490-elements with no element from @xmath512 between them .",
    "the next result is a generalization of lemma  [ lemma : peakc ] .",
    "[ lemma : peak ] let @xmath34 and @xmath57 be as in lemma  [ lemma : forbidden ] .",
    "suppose that there exists @xmath513 such that @xmath498 contains a factor @xmath514 .",
    "then the interval of @xmath57 between these two @xmath515-elements is isomorphic to @xmath516 for a branch of type @xmath5 , and @xmath517 for a branch of type @xmath6 .",
    "suppose @xmath502 , and the factor @xmath518 is in @xmath503 .",
    "since @xmath57 is fc , proposition  [ prop : heaps_fullycom](b ) implies that exactly one element ( _ resp . _ two elements ) labeled @xmath131 ( _ resp .",
    "_ @xmath507 and @xmath508 ) must occur between the two @xmath504-elements in the type @xmath5 ( _ resp .",
    "_ type @xmath6 ) case , which is what we wanted .",
    "now let @xmath519 . if @xmath498 contains the factor @xmath514 , then proposition  [ prop : heaps_fullycom ] and lemma  [ lemma : forbidden ] ( 2 ) imply that exactly two @xmath155-elements occur between the two @xmath515-elements .",
    "the proof follows by induction .",
    "the conclusion also holds with @xmath520 if one assumes that there exist two @xmath490-elements with no element from @xmath512 between them .",
    "finally , the following result implies lemma  [ lemma : zigzagc ] , and is therefore a generalization of ernst s  ( * ? ? ?",
    "* lemma 3.3.6 ) .",
    "recall the definition of @xmath403 and @xmath404 in section  [ sub : caffine ] , and their natural extension to types @xmath13 and @xmath14 in the proof of theorem  [ theo : affinebdfamilles ] .",
    "[ lemma : zigzag ] let @xmath34 be the coxeter graph @xmath351 , @xmath448 or @xmath350 .",
    "let @xmath57 be a fc heap of type @xmath34 with an interval of the form @xmath403 or @xmath404 for a certain @xmath405 .",
    "if @xmath57 contains at least another @xmath204-element , then @xmath57 belongs to the family ( zz)@xmath521 .    for symmetry reasons",
    ", we can assume that we have a peak @xmath403 whose @xmath204-elements are @xmath261 and @xmath522 , and a third @xmath204-element @xmath523 .",
    "there can be no @xmath205- element between @xmath522 and @xmath523 , since this would create a factor @xmath524 in the chain @xmath224 , which is of the forbidden form ( 1 ) in lemma  [ lemma : forbidden ] . by lemma  [ lemma : peak ] , @xmath522 and @xmath523",
    "therefore determine an interval of the form @xmath404 .",
    "consider now the chain thus formed between @xmath261 and @xmath523 : it is of the form @xmath525 where @xmath526 is the word @xmath527 the chain is easily seen to be convex in @xmath57 , and therefore there exist words @xmath528 so that @xmath57 is of the form @xmath529 .",
    "now let @xmath131 be the first letter of @xmath52 ( if @xmath52 is nonempty ) .",
    "the case @xmath530 is impossible since it would create a factor @xmath531 ; @xmath532 for @xmath533 is also impossible since , up to commutation , it would create a long braid @xmath534 , while @xmath535 ( _ resp .",
    "_ @xmath536 , _ resp .",
    "_ @xmath537 ) would create a long braid @xmath538 ( _ resp .",
    "_ @xmath539 , _ resp .",
    "_ @xmath540 ) .",
    "similarly , @xmath532 for @xmath541 and , for @xmath542 , @xmath543 ( _ resp .",
    "_ @xmath544 , _ resp .",
    "_ @xmath545 ) are excluded since they would create similar long braid words after some commutations .",
    "the only remaining possibilities are @xmath546 if @xmath542 , and @xmath543 for @xmath547 in type @xmath351 or @xmath448 , and @xmath544 or @xmath479 in type @xmath350 .",
    "we need to study what happens for heaps of the form @xmath548 where in type @xmath351 @xmath549 in type @xmath448 , replace @xmath38 by @xmath450 above in @xmath550 . in type @xmath350",
    ", there are several subcases for @xmath550 , consisting in replacing both @xmath93 s independently by @xmath478 , @xmath479 or @xmath452 .",
    "let again @xmath131 be the first letter of @xmath52 if @xmath551 is nonempty .",
    "then by inspection there is only one possibility for @xmath131 , namely @xmath552 in types @xmath351 and @xmath448 ; and @xmath552 ( _ resp .",
    "_ @xmath544 , _ resp . _",
    "@xmath545 ) in type @xmath350 when @xmath550 ends with @xmath452 ( _ resp .",
    "_ @xmath478 , _ resp .",
    "_ @xmath479 ) .    we have naturally similar results for the last letter of the prefix @xmath553 . by induction on the sum of the lengths of @xmath553 and @xmath52",
    ", we have then that @xmath57 is an element of ( zz)@xmath521 .",
    "we now use the previous description of fc heaps in classical affine types @xmath351 , @xmath448 and @xmath350 to obtain information about their growth sequences .",
    "[ theo : periodicitybcd ] let @xmath554 . the growth sequence of fc elements in type @xmath351 ( _ resp .",
    "_ @xmath448 , _ resp .",
    "_ @xmath350 ) is ultimately periodic , with period @xmath555 ( _ resp .",
    "_ @xmath556 , _ resp .",
    "_ @xmath557 ) .",
    "the periodic part starts at length @xmath558 ( _ resp .",
    "_ @xmath559 , _ resp .",
    "_ @xmath559 ) , except in type @xmath560 where it starts at length @xmath561 .    among the five families of definition  [ def : famillesctilde ] , only ( alt ) and ( zz )",
    "are infinite , so we only need to look at them in order to prove ultimate periodicity ; the same is then also true for ( alt)@xmath521 and ( zz)@xmath521 if @xmath562 or @xmath350",
    ".    in type @xmath351 , the growth sequence of ( alt ) is ultimately periodic of period @xmath555 : as in theorem  [ theo : periodicitya ] , this is most easily seen by shifting up the paths @xmath157 from section  [ sub : alternating ] when the length is large enough . for ( zz ) , it is clear that the growth sequence is ultimately constant equal to @xmath142 for @xmath11 larger than @xmath563 , which does not modify the period and yields the ultimate period @xmath555 .    in types",
    "@xmath562 or @xmath350 , ( alt)@xmath521 is also ultimately periodic of period @xmath555 : indeed , for @xmath11 large enough , any element @xmath57 of ( alt ) have more than one @xmath38-element and more than one @xmath93-element .",
    "therefore by the rules of section  [ sub : fcaffbd ] , the corresponding @xmath455 and @xmath470 in ( alt)@xmath521 have a constant number of elements , namely @xmath386 and @xmath561 respectively . the periodicity for ( zz)@xmath521 is @xmath563 in type @xmath448 and @xmath555 in type @xmath350 , because of the special cases where the underlying @xmath351-heap starts with a @xmath38 or a @xmath93 . this does not modify the global period in type @xmath350 , while one needs to multiply both periods in type @xmath448 .",
    "note that @xmath555 and @xmath563 are coprime so we can not be more precise without further knowledge .",
    "we now indicate the precise length where periodicity starts , for each of the three types . to achieve this , we look at both infinite families ( alt ) and ( zz ) and indicate the respective lengths @xmath564 and @xmath565 at which they start being periodic , as well as the largest length @xmath566 for which there exists a heap from one of the three finite families .",
    "if one of the three quantities @xmath567 in @xmath568 is larger than the two others , we can deduce immediately that @xmath569 is the start of periodicity .",
    "for the family ( alt ) in type @xmath351 , we can reason as in theorem  [ theo : periodicitya ] , and this shows that @xmath570 is the largest size of a heap @xmath57 whose corresponding path @xmath157 has a horizontal step at height zero .",
    "one has clearly @xmath571 , and such a heap @xmath57 is shown in figure  [ fig : preperiodectilde ] , left . in types @xmath572 equal to @xmath448 and @xmath350 , the periodicity of ( alt)@xmath521 starts when the length is such that all heaps have an underlying @xmath351-heap in ( alt ) with at least two @xmath38-elements , because of the special rule for the substitutions @xmath453 when there is only one @xmath38-element .",
    "so @xmath570 is the largest size of a heap whose underlying @xmath351-heap has exactly one @xmath38-element , such a heap @xmath573 being illustrated for type @xmath448 in figure  [ fig : preperiodectilde ] , middle .",
    "this gives @xmath574 in these cases .",
    "the periodic part of ( zz)@xmath521 is easily determined : it starts at length @xmath565 with @xmath575 equal to @xmath563 in type @xmath576 , @xmath577 in type @xmath448 and @xmath578 in type @xmath350 .",
    "finally , the largest heaps in the remaining finite families have size @xmath566 equal to @xmath579 in type @xmath351 and @xmath580 in types @xmath448 and @xmath350 ( see figure  [ fig : preperiodectilde ] , right , for an example @xmath581 in type @xmath351 , while in type @xmath448 ( _ resp . _",
    "@xmath350 ) pick the unique ( _ resp . _",
    "an ) element in @xmath582 ( _ resp . _ @xmath583 ) ) .    to conclude",
    ", one has clearly @xmath584 in type @xmath576 for @xmath585 , which proves the theorem for this case ( small cases @xmath586 and @xmath460 are checked separately ) . in types",
    "@xmath448 and @xmath350 , one has now @xmath587 for @xmath554 , except for @xmath588 which is easily checked separately , and this achieves the proof .    ,",
    "scaledwidth=80.0% ]      in this section we give functional equations which allow to compute the generating functions @xmath15 for types @xmath351 , @xmath448 and @xmath350 .",
    "these equations can be easily translated into systems of recurrence relations for the generating functions .",
    "let us stress that our goal was not to derive the simplest possible expressions here , though this is certainly a worthwile investigation .",
    "what we show is that our descriptions from section  [ sec : bcd ] apply easily here , and in particular give us equations that are straightforwardly programmed on a computer .",
    "[ prop : gf_affc ] we have the generating function : @xmath589 in which the four non explicit polynomials on the right - hand side can be evaluated as coefficients of @xmath590 in the following formulas : @xmath591 while @xmath592 and @xmath593 can be explicitly computed by using @xmath594 we finally recall that @xmath299 and @xmath298 are evaluated through   and  .",
    "applying theorem  [ theo : affinecfamilles ] , it is enough to show that the sum of the generating functions for the five families in definition  [ def : famillesctilde ] can be written as in .",
    "first , elements in ( alt ) correspond to walks in @xmath595 by the bijection @xmath232 from theorem  [ theorem : walk_encoding ] .",
    "therefore their generating function is given by the first two terms in thanks to the decomposition    while the following one for walks in @xmath596 proves equations   and  .",
    "next , the zigzag heaps in ( zz ) are totally ordered , their minimal length is @xmath563 and there are @xmath597 of these , while for any length @xmath598 there are @xmath142 of them .",
    "therefore this gives the third and fourth terms in  .    by left - right symmetry ,",
    "the generating functions for elements in ( lp ) and ( rp ) are the same .",
    "now by definition of ( lp ) elements , these can be uniquely split in a peak @xmath599 and a certain heap which is alternating when one of its two @xmath368-elements is deleted .",
    "therefore , by the bijection @xmath232 , their generating function @xmath600 is the coefficient of @xmath590 in the series @xmath601 where @xmath602 is the generating function for nonempty walks in @xmath603 starting at height @xmath106 .",
    "such paths can then either touch the @xmath131-axis or always stay at height @xmath604 , and the expression   comes from writing the generating functions for each case .",
    "a similar reasoning gives us the generating function for elements in ( lrp ) , for which we need to consider nonempty walks in @xmath603 starting and ending at height @xmath106 .",
    "+ finally , equations are easily computed by decomposing paths in @xmath127 and @xmath605 according to their first return on the @xmath131-axis .    in the same way",
    ", we prove the following expression for @xmath606 .    [ prop : afftypeb ] we have the generating function : @xmath607 in which we have @xmath608 while the polynomials @xmath609 and @xmath610 are the respective coefficients of @xmath590 in the following series : @xmath611\\nonumber\\\\ \\label{eq : rp_b } & + \\frac{q^3 + 4q^2 + 2q}{1-xq^2}.\\end{aligned}\\ ] ]    elements in ( alt)@xmath480 are by definition of the form @xmath455 where @xmath57 is a heap of type @xmath576 in ( alt ) . @xmath453 acts differently on heaps with @xmath119 , @xmath106 or at least two @xmath38-elements , and distinguishing these cases yields the two first terms of   ( and the expression  ) as the generating function for elements in ( alt)@xmath480 : recall indeed that @xmath612 can be written as @xmath613 .",
    "moreover , it can be computed thanks to equations   and .",
    "heaps in ( zz)@xmath614 have minimal length @xmath615 .",
    "moreover , there are @xmath597 ( _ resp . _",
    "@xmath615 ) such elements of length @xmath615 ( _ resp . _",
    "@xmath577 ) .",
    "then for any length @xmath616 there are @xmath577 elements in ( zz)@xmath614 unless @xmath11 is divisible by @xmath563 , in which case there are @xmath578 of them .",
    "therefore the generating function for elements in ( zz)@xmath480 is given by  .",
    "elements in ( lp)@xmath480 or ( lrp)@xmath480 are obtained from elements in ( lp ) or ( lrp ) by replacing @xmath38 by @xmath450 , so the corresponding generating functions are simply multiplied by @xmath16 .",
    "elements in ( rp)@xmath480 are also deduced from those of type @xmath576 in ( rp ) , but one has to distinguish whether there are @xmath119 , exactly @xmath106 or more than @xmath106 occurrences of @xmath38 . it is then routine to write the equation  , whose last term is a correction accounting for the special heap occurring in the definition of @xmath453 .",
    "finally , our method also yields the following expression for @xmath617 .",
    "[ prop : afftyped ] we have the generating function : @xmath618 in which we have @xmath619 while the polynomial @xmath620 is the coefficient of @xmath590 in the following series : @xmath621 + 4xq{m^*}(x){q}(qx)\\nonumber \\\\ \\label{eq : alt_d } & + 2xq^2{m^*}(x){m}(qx)+4q^2{q}(qx)+4x^2q^3{m^*}(x){m}(qx){q}(qx ) . \\ ] ]    finite families are easily dealt with thanks to the proofs of types @xmath351 and @xmath448 .",
    "the analysis of the family ( zz)@xmath622 is similar to ( zz)@xmath614 . for the family ( alt)@xmath622 , one needs to consider if the underlying fc heap @xmath57 has @xmath623 or at least two @xmath38-elements , and the same with @xmath93-elements .",
    "thus one needs to compute the generating functions for the corresponding families of paths @xmath157 , which is elementary but tedious , and we omit the details here .      from these complicated generating functions it is not easy to obtain simple formulas for individual coefficients . in the article  @xcite",
    ", more will be said about these , at least for the purely periodic part of the sequences .",
    "nevertheless one can compute already precisely what the _ mean value _ of these coefficients is . as we shall see in section  [ sub : tl ] , this tells us in particular how fast the corresponding temperley ",
    "lieb algebras grow with respect to their usual generators .",
    "[ prop : meanbcd ] for @xmath0 of type @xmath351 ( _ resp .",
    "_ @xmath448 , _ resp .",
    "_ @xmath350 ) , the mean value @xmath20 of the growth sequence of fc elements is given by @xmath624 ( _ resp .",
    "_ @xmath625 , _ resp .",
    "_ @xmath626 ) .",
    "the proof goes as in proposition  [ prop : meana ] and uses the simple lemma  [ lemma : periodic ] . by inspecting the generating functions involved ,",
    "one checks that one only has to prove @xmath627 . given any path in @xmath596 ,",
    "shift it first so that it starts at the origin .",
    "this is a bijection from @xmath596 to paths of length @xmath114 which start at the origin and are not necessarily positive , of which there are clearly @xmath628 since steps can then be chosen independently .",
    "fc heaps of type @xmath183 ( _ resp . _",
    "@xmath184 ) embed easily as fc heaps of type @xmath351 ( _ resp . _",
    "@xmath448 ) which have no @xmath93-element . for type @xmath183 , they correspond to elements of type @xmath351 which belong to one of the two families ( alt ) or ( lp ) and have at most one @xmath370-element ; the same holds for type @xmath184 after applying the substitution map @xmath453 .",
    "[ typeb ] the generating polynomials @xmath629 and @xmath630 for @xmath554 are the coefficients of @xmath590 in the following series : @xmath631    note that the fc elements of type @xmath632 corresponding to alternating heaps are called _ fully commutative top elements of @xmath632 _ by stembridge in  @xcite , and _ commutative elements of the weyl group @xmath633 _ by fan in  @xcite ( see also ( * ? ? ?",
    "* remark  2.4 ) ) .",
    "therefore @xmath593 gives a generating function for these particular elements .",
    "in this section we study fc elements in the exceptional types .",
    "we start with the finite case this time , in which everything can be left to the computer . in the affine case , there are two types which have a finite number of fc elements , and they can be dealt with as in the finite case . the analysis is more subtle in the remaining three affine types .",
    "the exceptional types are @xmath634 and @xmath635 , whose coxeter graphs were shown in figure  [ fig : finite_diagrams ] . for the dihedral group @xmath636 , only the element of maximal length is not fc . for the remaining types",
    ", we used the gap package gbnp to find the generating polynomials @xmath15 in each case , as mentioned in the introduction and explained in section  [ sub : tl ] .",
    "@xmath637    note that the number of fc elements in a coxeter group may be finite even though the group itself is infinite : stembridge  @xcite discovered that there are three families @xmath638 of infinite groups with a finite number of fc elements . extending stembridge  @xcite with similar walk techniques , it is possible to enumerate such elements according to their length .",
    "the exceptional irreducible affine types are @xmath639 and @xmath640 , and shown in figure  [ fig : affinediagrams ] .",
    "the number of fc elements in types @xmath641 or @xmath642 is finite , since they correspond in stembridge s classification  ( * ? ? ?",
    "* theorem 4.1 ) to types @xmath643 and @xmath644 .",
    "@xmath645     and @xmath642 .",
    "[ fig : exceptional_affine_finite ] , height=302 ]    notice that the leading coefficient of each of these polynomials is equal to 1 ; the corresponding longest heaps are depicted in figure  [ fig : exceptional_affine_finite ] .    in the remaining three types , we will make repeated use of the following lemma , whose proof presents no difficulty .",
    "a _ simple branch _ in a coxeter graph @xmath34 is a path @xmath646 , where all edges have label @xmath460 ( see figure  [ f : simplebranch ] ) .",
    "the next lemma corresponds essentially to lemmas 5.3 and 5.4 in @xcite .",
    "its proof is an easy consequence of lemma  [ lemma : local ] .",
    "[ lemma : stemb_simple ] let @xmath646 be a simple branch in a diagram @xmath34 , where @xmath647 has degree @xmath106 , and @xmath57 a fc heap of type @xmath34 .",
    "then the following hold true :    1 .",
    "there is at least one @xmath38-element in @xmath57 between any two @xmath378-elements .",
    "2 .   if @xmath648 contains an alternating factor with @xmath43 @xmath378-elements , then @xmath649 .",
    "[ f : simplebranch ]    to compute the growth sequence in each case , we need to prove that , starting from a certain length @xmath291 + 1 , it has period @xmath3 .",
    "then the knowledge of all terms up to length @xmath650 suffices .",
    "we explain in section  [ sub : tl ] how to use the ` gap ` package ` gbnp ` to perform this .",
    "the key lemma is the following .",
    "let @xmath57 be a fc heap of type @xmath651 with more than four @xmath38-elements .",
    "then the interval between extremal @xmath38-elements is a factor of the word @xmath652 for a certain integer @xmath653 .",
    "an example of such a factor is illustrated in figure  [ fig : exceptional_affine ] , left .",
    "let @xmath654 be the @xmath38-elements in @xmath57 .",
    "they determine @xmath655 intervals @xmath656 with @xmath657t^{(i)},t^{(i+1)}[$ ] .",
    "define also two other intervals @xmath658 ( _ resp . _",
    "@xmath659 ) corresponding to elements smaller than @xmath458 ( _ resp .",
    "_ larger than @xmath660 ) . by definition  [ defi : heaps ] it is clear that these @xmath661 intervals are pairwise disjoint and contain all @xmath30- and @xmath93-elements .",
    "consider first the chain @xmath662 .",
    "no two @xmath93-elements in @xmath662 can be consecutive by proposition  [ prop : heaps_fullycom](b ) .",
    "no two @xmath38-elements can be consecutive either : indeed , if @xmath663 and @xmath664 were not separated by a @xmath93-element , then by proposition  [ prop : heaps_fullycom](b ) they would be separated by exactly one @xmath30-element , which then contradicts proposition  [ prop : heaps_fullycom](a ) .",
    "we have thus proven that @xmath662 is alternating .",
    "now consider the chain @xmath59 . here",
    "@xmath665 constitutes a simple branch with @xmath219 , so by lemma  [ lemma : stemb_simple ] there is at most one @xmath30-element in each @xmath666 , and there are no @xmath30-elements in two consecutive @xmath666 s .",
    "now assume @xmath667 . before going further ,",
    "notice the important fact that there is but a finite number of heaps with @xmath668 , as follows easily from the previous reasoning ; in fact the maximal size of such heaps is easily bounded above by @xmath461 .",
    "now suppose that there exists @xmath669 such that both @xmath666 and @xmath670 contain no @xmath30-element .",
    "then because @xmath662 is alternating and @xmath667 , @xmath57 contradicts proposition  [ prop : heaps_fullycom](a ) with a convex @xmath671-chain of length @xmath672 .",
    "so @xmath30-elements must occur in every other @xmath666 for @xmath673 , which proves the proposition .",
    "it is then easy to prove that the growth sequence for fc elements in type @xmath674 has periodicity @xmath675 , starting from length @xmath676 , which corresponds to the repetition of the length @xmath677-pattern @xmath678 .",
    "then the whole series is @xmath679     , height=302 ]      in this case , the key lemma is the following .",
    "let @xmath57 be a fc heap of type @xmath681 with more than five @xmath38-elements .",
    "then the interval between extremal @xmath38-elements occurs as an interval in @xmath89 with @xmath682 for a certain integer @xmath653 .",
    "such a factor is illustrated in figure  [ fig : exceptional_affine ] , center .",
    "let @xmath57 be a fc heap with @xmath683 @xmath38-elements @xmath654 . by proposition  [ prop : heaps_fullycom ]",
    ", there are at least two elements with labels in @xmath684 between @xmath663 and @xmath664 for any @xmath685 . but by lemma  [ lemma : stemb_simple ]",
    ", there is at most one @xmath368-element between @xmath663 and @xmath664 for @xmath686 .",
    "it follows that between two successive @xmath38-elements , there are either ( a ) two elements labeled with distinct labels in @xmath684 or ( b ) one @xmath368-element for @xmath686",
    ".    assume case ( b ) occurs in @xmath57 , say between @xmath663 and @xmath664 ; we will show that @xmath687 or @xmath460 in this case .",
    "if there exists no other @xmath38-element , we are done : otherwise we can assume @xmath688 is defined , up to considering the dual heap .",
    "there are at least two elements between @xmath664 and @xmath688 as seen above ; by the symmetry of the coxeter diagram , we can assume they have labels @xmath378 and @xmath689 .",
    "no @xmath38-element can occur below @xmath663 or above @xmath688 : indeed this would force either a @xmath378- or @xmath689-element to occur there , which is impossible by lemma  [ lemma : stemb_simple ]",
    ". therefore @xmath520 and @xmath690 in this case .",
    "now we assume @xmath667 , so that case ( a ) holds : between two successive @xmath38-elements , there are two elements with distinct labels in @xmath684 .",
    "consider first @xmath691 and assume without loss of generality that these labels are @xmath692 .",
    "the possible labels in @xmath693t^{(2)},t^{(3)}[$ ] are then either @xmath694 or @xmath695 ; indeed @xmath692 can not occur since the same argument as in the previous paragraph shows that this forces @xmath690 .",
    "we can assume these labels are @xmath695 thanks to the coxeter graph symmetry .",
    "now the possible labels in @xmath693t^{(3)},t^{(4)}[$ ] are @xmath692 are @xmath694 , but the first possibility is excluded by lemma  [ lemma : stemb_simple ] . following the analysis , we see that the labels are alternatively @xmath696 and so on .",
    "so the @xmath368-elements fit with the statement of the lemma ; it remains to see that the @xmath697-elements do too . by lemma  [ lemma : stemb_simple ]",
    ", there is at most one @xmath697-element between two consecutive @xmath368-elements , and exactly one if these @xmath368-elements occur in @xmath693t^{(i)},t^{(i+1)}[$ ] and @xmath693t^{(i+1)},t^{(i+2)}[$ ] for a certain @xmath63 . to contradict the statement of the lemma , there must therefore be a @xmath697-element between two @xmath368-elements occurring in @xmath693t^{(i)},t^{(i+1)}[$ ] and @xmath693t^{(i+2)},t^{(i+3)}[$ ] respectively .",
    "it is easy to see that in this case , no other @xmath38-element can occur , so that @xmath520 and @xmath698 is the only possibility .",
    "therefore the lemma holds since it supposes @xmath699 .     and",
    "[ fig : speciale6e7 ] ]    by analysing the previous proof , one checks that the longest length among fc elements with @xmath701 is @xmath702 , an example being given in figure  [ fig : speciale6e7 ] , left .",
    "also there is only a finite number of heaps with a given extremal @xmath38-interval for @xmath699 .",
    "so periodicity of the growth sequence for fc elements of type @xmath680 is @xmath703 , and the series is @xmath704      let @xmath57 be a fc heap of type @xmath705 with @xmath706 @xmath38-elements .",
    "then the interval between extremal @xmath38-elements occurs as an interval in @xmath89 with @xmath707 for a certain integer @xmath653 .",
    "we will sketch the proof here , since it closely resembles the one for @xmath680 .",
    "let @xmath57 be a fc heap of type @xmath705 with @xmath683 @xmath38-elements @xmath654 .",
    "between two successive @xmath38-elements , there are either ( a ) two elements with distinct labels in @xmath708 or ( b ) three elements with labels @xmath709 and @xmath689 .",
    "case ( b ) occurs only if @xmath701 , as one checks easily .",
    "now assume @xmath699 so that between two successive @xmath38-elements , there are two elements with distinct labels in @xmath708 .",
    "the label @xmath226 can not appear in consecutive intervals , and if it does not appear in two consecutive intervals , then @xmath710 is forced .",
    "for @xmath711 it is then easy to check that the @xmath30-labels fit with the statement of the lemma , and this holds as well for the @xmath712-labels ; it remains to see that the @xmath713-elements do too .",
    "for @xmath714 there is a possibility for such an @xmath713-element to contradict the lemma , see figure  [ fig : speciale6e7 ] , right , but such things can not happen for @xmath706 , which proves the lemma .    by analysing the previous proof , one checks that the longest length among fc elements with @xmath715 which do not obey the conclusion of the lemma is @xmath716 , an example being given in figure  [ fig : speciale6e7 ] , right . also there is only a finite number of heaps with a given extremal @xmath38-interval for @xmath706 .",
    "so periodicity of the growth sequence for fc elements of type @xmath680 starts at @xmath717 and the function has then period @xmath718 .",
    "in this section we first give a direct application of our results to the growth of temperley ",
    "lieb algebras , as was announced in the introduction . then in sections  [ sub : min ] to  [ sub : gencox ] , we announce some work in progress concerning natural extensions of the results .",
    "finally a few questions which we believe deserve further study are listed in section  [ sub : further ] .",
    "consider the ring @xmath720 $ ] ; here we use @xmath721 instead of @xmath16 to avoid confusion with the variable in our generating functions .",
    "for @xmath0 a coxeter group with coxeter matrix @xmath722 , the associated _ hecke algebra _",
    "@xmath723 is given by generators @xmath724 and relations @xmath725    for any @xmath41 , define @xmath726 by picking any reduced decomposition @xmath727 for @xmath2 and setting @xmath728 , and @xmath729 .",
    "these elements @xmath730 then form a basis of @xmath731 ( see for instance  @xcite ) .    the _ generalized temperley ",
    "lieb algebra _",
    "@xmath732 is defined as the quotient of @xmath723 by the ideal generated by the elements @xmath733 where @xmath734 is the ( dihedral ) subgroup generated by @xmath30 and @xmath38 .",
    "for instance if @xmath40 the element is @xmath735 .",
    "let @xmath736 be the image of @xmath730 in @xmath732 .",
    "then the elements @xmath736 , for @xmath737 , form a basis of @xmath732 ( see  ( * ? ? ?",
    "* theorem 6.2 ) ) .",
    "consider now the natural filtration @xmath738 of @xmath732 , where @xmath739 is the linear span in @xmath732 of all products @xmath740 with @xmath741 . a linear basis for @xmath742 is clearly given by @xmath743 , where @xmath2 lies in the set of all fc elements of length at most @xmath11 .",
    "let the _ growth _ of @xmath732 be @xmath744 , so that @xmath745 is the number of fc elements of length at most @xmath11 in @xmath0 .",
    "now let @xmath0 be an irreducible affine group with infinitely many fc elements .",
    "recalling the definition of the mean value @xmath20 given after corollary b , we get the following result .",
    "we refer to the books  @xcite for more informations on growth of algebras ; in particular a less precise version of theorem  [ theo : growthtl ] is that such algebras have _ gelfand  kirillov dimension _ equal to @xmath106 . in the simply laced case",
    ", it was also noticed in  @xcite that the growth is linear .",
    "define the _ nil temperley ",
    "lieb algebra _ @xmath747 as the graded algebra associated to @xmath732 : by definition , its @xmath11th grade component is given by @xmath748 , and the multiplication is inherited from @xmath732 .",
    "it is easily seen to have the presentation with generators @xmath749 and relations @xmath750 this algebra seems to have been studied only for type @xmath181 by fomin and greene in  @xcite and for type @xmath223 by postnikov in  @xcite .",
    "either from its definition or the presentation , one sees that the @xmath11th graded component of @xmath747 has a basis @xmath751 indexed by fc element of length @xmath11 , and we have the following consequence .",
    "now for any @xmath0 , @xmath747 is a finitely presented , graded algebra : for any affine or finite type , we used the ` gap ` package ` gbnp ` to compute , for any length @xmath11 , a basis of all components of @xmath747 up to dimension @xmath11 ; equivalently , it gives us access to all fc elements up to coxeter length @xmath11 .",
    "we used this data to verify our results for all classical types : we checked that the generating functions @xmath15 which we computed coincided with the hilbert series given by the computer , for small values of the parameter @xmath114 and up to a large length @xmath11 .",
    "this also gives confirmations that our descriptions of fc elements is correct for these types .",
    "for exceptional types , we used it to compute the generating functions themselves , as explained in section  [ sub : affexcept ] .",
    "as we already pointed out , the periods obtained for classical affine types are not always the _",
    "minimal periods_. for instance , for type @xmath223 , it was shown by hanusa and jones in  @xcite that , when @xmath114 is prime , the corresponding growth sequence @xmath752 is eventually constant . in the work  @xcite by the second and third authors , the minimal periods for all cases is determined .",
    "in particular , in type @xmath223 , it is shown that the minimal period of @xmath752 is @xmath114 unless @xmath114 is a prime power @xmath753 , in which case the minimal period is @xmath754 .",
    "this generalizes the aforementioned result .",
    "an element @xmath2 in a coxeter group is an _ involution _ if and only if its set of reduced decompositions @xmath46 is palindromic , meaning that it is stable by taking the mirror images of its elements . for fc elements ,",
    "this is equivalent to the fact that @xmath104 is equal to its dual , which itself means that every word in @xmath59 is palindromic . for classical affine types , our characterizations of fc elements",
    "easily then specializes to involutions .",
    "the observation here is that in the path encoding of alternating heaps , palindromic words correspond to steps which are either up or down .",
    "from this it is possible to show that ultimate periodicity still holds in the enumerating sequences , and obtain all our results in the case of involutions for affine types , thereby extending the work of stembridge from  ( * ? ? ? * section 4 ) .",
    "another intersesting subset of fc elements is the set of _ minuscule elements _ , which are linked to representation theory .",
    "they were also studied by stembridge in  @xcite who characterized their heaps by local conditions extending proposition  [ prop : heaps_fullycom ] . by using our description of fc heaps in the affine types",
    ", one can recognize among them which ones correspond to minuscule heaps and then study their enumerative properties .",
    "both subsets will be the subject of the forthcoming article  @xcite .",
    "let us add that a third one was introduced recently , namely the set of _ cyclically fully commutative elements _ ( see  @xcite ) .",
    "it is possible to describe explicitly the corresponding elements ( or heaps ) in finite and affine types and enumerate them ; this is done in the work  @xcite of ptrolle .",
    "we recall from the introduction that for a given @xmath0 of type @xmath34 , the fc elements index naturally a basis of the ( generalized ) temperley ",
    "lieb algebra @xmath732 . on the other hand the usual temperley ",
    "lieb algebra of type @xmath7 is known to have a faithful representation as a _ diagram algebra_. such representations have since been extended to other types : @xmath5 and @xmath6 in  @xcite , @xmath57 in  @xcite , @xmath755 in  @xcite , which are finite dimensional algebras ; @xmath327 in  @xcite , @xmath12 in  @xcite , which are infinite dimensional algebras .",
    "the procedure to obtain such a faithful representation is more or less always the same in the previously cited works : ( 1 ) define a set @xmath756 of ( decorated ) diagrams and a way to multiply them by some concatenation procedure ; ( 2 ) determine a subset in @xmath756 of elementary diagrams indexed by @xmath23 , which satisfy the relations of @xmath732 ; ( 3 ) determine explicitly the subspace generated by the elementary diagrams , say @xmath757 ; ( 4 ) prove that the surjective morphism @xmath758 thus obtained is injective .",
    "it is these steps ( 3 ) and ( 4 ) that can be greatly simplified thanks to our global approach to fully commutative elements , as will be seen in the forthcoming work  @xcite , where we plan to extend such diagram algebras to the remaining classical affine types @xmath13 and @xmath14 .",
    "though we focused solely on affine and finite coxeter groups in this work , fc elements are defined for any coxeter group in definition  [ defi : fc ] .",
    "it is natural to ask how to extend our results to more general groups .",
    "this is done by the third author in  @xcite for two such extensions .",
    "first , it settles the problem which corollary b in the introduction raises naturally : can one classify coxeter groups @xmath0 having an ultimately periodic growth sequence ?",
    "it turns out that there are only two such groups which are not affine .",
    "second , it is shown in  @xcite that , for any @xmath0 , the fc growth sequence satisfies a linear recurrence relation with constant coefficients .",
    "equivalently , the generating function @xmath15 is always a rational function .",
    "both of these results have direct consequences regarding the growth of generalized temperley  lieb algebras ( see section  [ sub : tl ] )",
    ".      it would be interesting to explore other statistics on the sets @xmath9 which can be studied naturally on heaps .",
    "an example would be the sets of left and right descents , which are defined for any coxeter group : for a fc element @xmath2 , these descents correspond to the minimal and maximal elements of @xmath104 .",
    "affine coxeter groups get their name from the geometric representation of coxeter groups ; we refer to  @xcite or  @xcite for details . in brief ,",
    "elements of @xmath0 correspond bijectively to the regions ( called _ alcoves _ ) of a certain regular tiling of @xmath759 .",
    "if @xmath760 is the alcove of the identity of @xmath0 and is fixed , then the length of @xmath2 corresponds to the distance from @xmath760 to @xmath761 ( here the distance is measured in the minimum number of pairs of adjacent alcoves that one must encounter between @xmath760 and @xmath761 , where two alcoves are adjacent if they are separated by a single hyperplane ) .",
    "the alcoves for the affine group @xmath640 are depicted in figure  [ fig : g2 ] , the colored ones corresponding to fc elements .",
    "it is easy to give a geometric criterion for the location of alcoves for fc elements . it should be possible to use these geometric representations to obtain alternative proofs of our results .",
    "for instance , understanding the periodicity of the growth sequence from this point of view would be very interesting , especially if this can be done in a uniform manner .",
    "h.  n.  v. temperley and e.  h. lieb .",
    "relations between the `` percolation '' and `` colouring '' problem and other graph - theoretical problems associated with regular planar lattices : some exact results for the `` percolation '' problem . , 322(1549):251280 , 1971 .",
    "g.  x. viennot .",
    "heaps of pieces .",
    "i. basic definitions and combinatorial lemmas . in _",
    "combinatoire numrative ( montreal , que . , 1985/quebec , que . , 1985 ) _ , volume 1234 of _ lecture notes in math .",
    "_ , pages 321350 .",
    "springer , berlin , 1986 ."
  ],
  "abstract_text": [
    "<S> an element of a coxeter group @xmath0 is _ fully commutative _ if any two of its reduced decompositions are related by a series of transpositions of adjacent commuting generators . </S>",
    "<S> these elements were extensively studied by stembridge , in particular in the finite case . </S>",
    "<S> they index naturally a basis of the generalized temperley  </S>",
    "<S> lieb algebra . in this work </S>",
    "<S> we deal with any finite or affine coxeter group @xmath0 , and we give explicit descriptions of fully commutative elements . using our characterizations we then enumerate these elements according to their coxeter length , and find in particular that the corrresponding growth sequence is ultimately periodic in each type . </S>",
    "<S> when the sequence is infinite , this implies that the associated temperley  </S>",
    "<S> lieb algebra has linear growth . </S>"
  ]
}