{
  "article_text": [
    "for the last two decades copula modelling has emerged as a major research area of statistics . by definition ,",
    "a bivariate copula function @xmath0 is the joint cumulative distribution function ( often abbreviated to ` cdf ' below ) of a bivariate random vector whose marginals are uniform over @xmath1 $ ] , i.e. , @xmath2 ^ 2 \\to [ 0,1 ] : ( u , v ) \\to c(u , v ) = \\p(u \\leq u , v \\leq v),\\ ] ] where @xmath3}$ ] , @xmath4}$ ] .",
    "copulas arise naturally in statistics and probability as a mere consequence of two well - known facts .",
    "first , the _ probability - integral transform _ result , establishing that for any continuous variable @xmath5 with distribution @xmath6 , @xmath7}$ ] , and second , _",
    "sklar s theorem _",
    "@xcite , stating that for any continuous bivariate distribution whose cdf is @xmath8 , there exists a unique function @xmath0 such that @xmath9 where @xmath6 and @xmath10 are the marginals of @xmath8 .",
    "according to the previous definition , this function @xmath0 is , indeed , a copula , called the copula of @xmath8 . from ( [ eqn : copdef ] ) it is clear that @xmath0 describes how the two marginal distributions @xmath6 and @xmath10 ` interact ' to produce the joint @xmath8 .",
    "it , therefore , disjoints the marginal behaviours of @xmath5 and @xmath11 from their dependence structure , hence the attractiveness of the copula approach .",
    "see @xcite and @xcite for book length treatment of the foregoing ideas .",
    "other , more compact reviews include @xcite and @xcite . today , copulas are used extensively in statistical modelling in all areas , from quantitative finance and insurance to medicine and climatology .",
    "therefore , empirically estimating a copula function from an observed bivariate sample @xmath12 drawn from @xmath8 has become an important problem of modern statistical modelling .    of course , estimating @xmath0 essentially amounts to fitting a bivariate distribution , for what many parametric families have been suggested and studied : gaussian , student-@xmath13 , clayton , frank or gumbel copulas among others ( see again @xcite or @xcite for details ) .",
    "these parametric models have formed the main body of the literature in the field so far .",
    "however , they suffer from the usual lack of flexibility of parametric approaches and the induced risk of misspecification .",
    "for instance , it has been argued that the main reason behind the 2009 global financial crisis was a reckless usage of the gaussian copula @xcite",
    ". there is , therefore , a tremendous need for flexible nonparametric copula models , making no rigid assumptions on the underlying distributions .",
    "an early step in that direction was the empirical copula devised by @xcite .",
    "the related empirical copula process was studied further in @xcite and @xcite , and turns out to be the cornerstone of a variety of nonparametric copula - based procedures , see e.g.  @xcite or @xcite , to cite only a few .",
    "moreover , @xcite , @xcite , @xcite and @xcite studied kernel methods to obtain flexible smooth estimates of the bivariate cdf @xmath0 .",
    "it is usually the case , though , that a distribution is more readily interpretable in terms of its probability density function than directly in terms of its cdf , and a copula is , in many aspects , no different .",
    "assume that the bivariate cdf @xmath0 is absolutely continuous .",
    "then , its associated density is @xmath14 for @xmath15 , a function naturally enough called the _",
    "copula density_. this paper precisely addresses the problem of estimating this copula density @xmath16 in a nonparametric way , for what kernel methods again appear natural .",
    "this approach was pioneered in @xcite and @xcite , and arguably remains very attractive compared to its competitors , such as splines smoothing @xcite , wavelets @xcite , bernstein polynomials @xcite or others @xcite , for its simplicity in construction , implementation and interpretation .",
    "at least three factors make kernel estimation of @xmath17 not standard , though , and have delayed the development of reliable kernel copula density estimators .",
    "a major concern is that kernel estimators suffer from boundary bias problems . given the bivariate sample @xmath18 , the standard kernel estimator for @xmath16 , say @xmath19 , at @xmath15 would be ( * ? ? ?",
    "* chapter 4 ) @xmath20 where @xmath21 is a bivariate kernel function and @xmath22 is a symmetric positive - definite bandwidth matrix .",
    "it is , however , well known that an estimator such as ( [ eqn : kerncopbasstar ] ) is in general not consistent on the boundaries of @xmath23 : it does not ` feel ' the support boundaries of the underlying density and places through @xmath24 positive mass outside that support .",
    "in fact , standard kernel density arguments show that @xmath25 at corners ( @xmath26 ) and @xmath27 on the borders ( @xmath28 ) .",
    "although some papers ignored these boundary issues @xcite , it is clear that accurate estimation of @xmath16 calls for some boundary correction .",
    "such corrections have indeed been proposed , inspired by ideas developed for univariate density estimation , e.g.  mirror reflection @xcite or the usage of boundary kernels @xcite , but with mixed results .",
    "secondly , kernel estimators are not consistent for unbounded densities .",
    "yet , unlike most common probability densities , many copula densities of interest are unbounded .",
    "for instance , even in the apparently easy case of a bivariate normal vector with moderate correlation , the copula density is unbounded in two of the corners of @xmath23 .",
    "it is , therefore , particularly important to use estimators able to cope with such unboundedness .",
    "finally , estimating @xmath16 can not be made from a genuine random sample from its cdf @xmath0 , as @xmath0 is the distribution of @xmath29 and @xmath6 and @xmath10 are typically unknown .",
    "hence , the observations @xmath30 are unavailable , and estimator ( [ eqn : kerncopbasstar ] ) is , in fact , infeasible . in the copula literature , it is customary to use the ` pseudo - observations ' @xmath31 where @xmath32 is the empirical cdf of @xmath5 , and similarly for @xmath33 .",
    "the rescaling by @xmath34 in ( [ eqn : pseudobs ] ) , aiming at keeping the pseudo - observations in the interior of @xmath1 $ ] , is also common practice .",
    "then , the pseudo - sample @xmath35 is treated mostly as a sample from @xmath0 and used instead of the ` true ' sample @xmath36 , although this may affect the statistical properties of the ensuing estimators @xcite .",
    "the aim of this paper is to propose and study a new , kernel - type estimator of the copula density @xmath16 .",
    "it is , in fact , the extension to the copula density case of the kernel - type estimator for univariate densities supported on the unit interval recently suggested in @xcite . that estimator takes the constrained nature of the support into account from the outset , i.e.  without relying on _ ad hoc _ boundary corrections ( reflection , boundary kernels , etc . ) .",
    "it proved superior to its main competitors in the simulation studies for a wide range of density shapes , including for unbounded densities .",
    "the idea seems , therefore , suitable for estimating copula densities as well .",
    "specifically , @xcite s estimator makes use of the transformation method , building on ideas first suggested in ( * ? ? ?",
    "* chapter 9 ) and @xcite . in short ,",
    "the initial @xmath1$]-supported variable of interest is transformed through the probit function into a variable whose support is unconstrained , the density of that transformed variable is estimated and an estimate of the initial density on @xmath1 $ ] is obtained by back - transformation .",
    "this method appears very natural and yields very good results , provided that the estimation step in the transformed domain is carried out with care , as @xcite s results showed .",
    "exploring this idea in more details in the context of copula density estimation is the topic of section [ sec : probtransfcop ] .",
    "several versions of the estimators will be suggested , and their asymptotic properties will be derived in section [ sec : asympt ] .",
    "section [ sec : bandwidth ] will address the crucial point of smoothing parameter selection in this framework .",
    "simulation studies evidencing the very good practical behaviour of the probit - transformation estimators ( section [ sec : sim ] ) , a real data analysis ( section [ sec : realdat ] ) and some final remarks ( section [ sec : ccl ] ) conclude the paper .",
    "as recalled above , direct kernel estimation of the density @xmath16 of @xmath37 is made difficult mainly by the constrained nature of its support @xmath38 ^ 2 $ ] .",
    "now , define @xmath39 where @xmath40 is the standard normal cdf and @xmath41 is its quantile function ( i.e.  the probit transformation ) .",
    "given that both @xmath42 and @xmath43 are @xmath44}$ ] , @xmath45 and @xmath46 both follow standard normal distributions , which , nevertheless , does not imply that the vector @xmath47 is bivariate normal",
    ". that will only be the case if the copula of the joint cdf of @xmath47 , say @xmath48 , is the gaussian copula , that is , if the copula @xmath0 of @xmath8 itself is the gaussian copula , as copulas are invariant to increasing transformations of their margins ( * ? ? ?",
    "* theorem 2.4.3 ) .",
    "the idea is that , if @xmath49 lebesgue - a.e .  over @xmath23 ( which will be assumed throughout the paper ) ,",
    "@xmath47 has unconstrained support @xmath50 and estimating its density @xmath51 can not suffer from boundary issues .",
    "in addition , due to its normal margins , one can expect @xmath51 to be well - behaved , and its estimation easy .",
    "in particular , under mild assumptions , @xmath51 and its partial derivatives up to the second order will be seen to be uniformly bounded on @xmath50 , even in the case of unbounded copula density @xmath16 ( lemma [ lem : unicont ] in the appendix ) .",
    "as the copula of @xmath48 is @xmath0 , @xmath52 and @xmath53 , one can write sklar s theorem ( [ eqn : copdef ] ) for @xmath47 : @xmath54 upon differentiation with respect to @xmath55 and @xmath13 , the joint density @xmath51 of @xmath47 is found to be @xmath56 where @xmath57 is the standard normal density .",
    "inverting this expression , one obtains @xmath58 for any @xmath59 .",
    "so , any estimator @xmath60 of @xmath51 on @xmath50 automatically produces an estimator of the copula density on the interior of @xmath23 , viz .",
    "@xmath61 where the superscript @xmath62 refers to the idea of transformation .",
    "when necessary , @xmath63 can also be defined at the boundaries of @xmath23 by continuity .",
    "this estimator enjoys interesting properties .",
    "clearly , @xmath63 can not allocate any positive probability weight outside @xmath23 , since @xmath64 is not defined for @xmath65 . also , if @xmath60 is a _ bona fide _ density function , in the sense that @xmath66 for all @xmath67 and @xmath68 , then automatically @xmath69 for all @xmath15 and @xmath70 .",
    "this is easily seen through the changes of variable @xmath71 and @xmath72 .",
    "finally , if @xmath60 is a uniformly ( weak or strong ) consistent estimator for @xmath51 , i.e.  @xmath73 in probability or almost surely as @xmath74 , the estimator @xmath63 inherits that uniform consistency on any compact proper subset of @xmath23 .",
    "a first natural idea would be to use the standard kernel density estimator as @xmath60 in ( [ eqn : copratio ] ) .",
    "specifically , one would like to use an estimator like @xmath75 where @xmath24 is a bivariate kernel function and @xmath76 is some symmetric positive - definite bandwidth matrix , and @xmath77 is the sample in the transformed domain .",
    "however , as the @xmath30 s are unavailable in this context , so are the @xmath78 s .",
    "instead , one has to use @xmath79 the pseudo - transformed sample . the feasible version of ( [ eqn : fststar ] ) is , therefore , @xmath80 through ( [ eqn : copratio ] )",
    ", this directly leads to the following probit transformation kernel copula density estimator : @xmath81 this is essentially the estimator suggested in @xcite , also used as - is in @xcite , although it was not studied in any details in those two papers .",
    "@xcite derived the theoretical properties of an estimator for the copula @xmath0 ( not its density ) based on the same transformation .",
    "this idea was , however , called ` naive ' in @xcite in the univariate case .",
    "in fact , the method does not provide good results close to the boundaries , even though it was designed to fix boundary issues .",
    "indeed , the estimator ( [ eqn : naivefeas ] ) will be seen not to perform well in the next sections .",
    "@xcite explained the reasons for that failure , and suggested some remedies .",
    "in particular , estimating the density in the transformed domain via local likelihood methods @xcite offers a promising alternative while keeping the simplicity and the intuitive appeal of the probit - transformation estimator .",
    "this is investigated for estimating a copula density in the next subsection .",
    "@xcite and @xcite proposed two different , although similar in many aspects , formulations of the local likelihood density estimator . @xcite",
    "locally approximates the logarithm of the unknown density by a polynomial , whereas @xcite consider local parametric density modelling .",
    "this paper will only make use of @xcite s idea , mainly because the asymptotic theory is more transparent . in any case , both formulations share most of their advantages and drawbacks , and typically yield very similar estimates .    in this setting of estimating @xmath51 from the pseudo - sample @xmath82 , @xcite s local likelihood estimator is defined as follows .",
    "around @xmath83 , @xmath84 is assumed to be well approximated by a polynomial of some order @xmath85 .",
    "classically , only local log - linear ( @xmath86 ) and local log - quadratic ( @xmath87 ) estimators are considered .",
    "specifically , in the first case ( @xmath86 ) , it is assumed that , for @xmath88 ` close ' to @xmath67 , @xmath89 and in the second case ( @xmath87 ) @xmath90 the vectors @xmath91 and @xmath92 are then estimated by solving a weighted maximum likelihood problem . for either @xmath93 , @xmath94 where , as previously , @xmath24 is a bivariate kernel function and @xmath76 is a symmetric positive - definite bandwidth matrix . the estimate of @xmath51 at @xmath67 is then , naturally , @xmath95 for local log - linear , and @xmath96 for local log - quadratic modelling . ` improved ' probit - transformation kernel copula density estimators for @xmath17 are finally obtained through ( [ eqn : copratio ] ) as @xmath97 for @xmath86 and @xmath87 .",
    "the motivation and the advantages of estimating @xmath51 by local likelihood methods instead of raw kernel density estimation are related to the detailed discussion in @xcite , and are therefore omitted here .",
    "the asymptotic properties of these estimators ( ` naive ' and ` improved ' probit - transformation kernel copula density estimators ) are derived in the next section .",
    "for simplicity , it will be assumed that @xmath24 is a product gaussian kernel , i.e.  @xmath98 , and @xmath99 for some @xmath100 .",
    "note that , in practice , there are reasons to keep an unconstrained , non - diagonal bandwidth matrix @xmath76 .",
    "in particular , the copula density is typically stretched along one of the diagonals of the unit square when some dependence is present in @xmath101 , which provides a density @xmath51 likewise stretched along one of the 45 degrees lines in @xmath50 .",
    "hence , using a bandwidth matrix directing smoothing in that particular direction is sensible @xcite , as discussed further in section [ sec : bandwidth ] .",
    "that said , theoretical results for that general case would be less tractable than , while qualitatively equivalent to , the simpler case presented below .",
    "note that for that particular kernel @xmath24 , @xmath102 and @xmath103 , @xmath104 .",
    "these quantities frequently arise in the properties of kernel estimators , and direct use of these particular numerical values will be made in the results below .",
    "consider the naive estimator ( [ eqn : naivefeas ] ) which , with the above specifications of @xmath24 and @xmath76 , reduces to @xmath105 given ( [ eqn : copratio ] ) , it is clear that its statistical properties will entirely depend on those of ( [ eqn : fsthat ] ) , here @xmath106 if @xmath51 admits continuous second - order partial derivatives , expressions for the bias and the variance of the ideal , infeasible estimator @xmath107 ( [ eqn : fststar ] ) , as well as its asymptotic normality , are well known ( * ? ? ?",
    "* chapter 4 ) .",
    "proposition [ thm : fshat ] below ascertains that using the pseudo - observations ( [ eqn : pseudosamp ] ) instead of genuine ones does not affect those properties .",
    "note that ( [ eqn : fsthat2 ] ) can be written @xmath108 where @xmath109 is the empirical copula @xmath110 hence , although living in the transformed domain , the behaviour of @xmath111 will be driven by the properties of @xmath109 on @xmath23 .",
    "the following assumptions will be made .",
    "[ ass : fxy ] the sample @xmath12 is an i.i.d",
    ".  sample from the joint distribution @xmath8 , an absolutely continuous distribution with marginals @xmath6 and @xmath10 strictly increasing on their support ;    [ ass : cop ] the copula @xmath0 of @xmath8 is such that @xmath112 and @xmath113 exist and are continuous on @xmath114\\}$ ] , and @xmath115 and @xmath116 exist and are continuous on @xmath117,v\\in ( 0,1)\\}$ ] .",
    "in addition , there are constants @xmath118 and @xmath119 such that @xmath120 ;",
    "\\\\ \\displaystyle \\left|\\frac{\\partial^2 c } { \\partial v^2}(u , v ) \\right| & \\leq & \\displaystyle \\frac{k_2}{v(1-v ) } \\qquad   \\text { for } ( u , v ) \\in [ 0,1 ] \\times ( 0,1 ) ; \\end{array}\\right.\\ ] ]    [ ass : copdens ] the density @xmath16 of @xmath0 exists , is positive and admits continuous second - order partial derivatives on the interior of the unit square @xmath23 .",
    "in addition , there is a constant @xmath121 such that @xmath122    assumption [ ass : fxy ] guarantees the existence and the uniqueness of the copula @xmath0 of @xmath8 .",
    "assumptions [ ass : cop]-[ass : copdens ] mostly reduce to conditions 2.1 and 4.1 in @xcite , who claims that they hold for many copula families , such as gaussian , archimedean and most extreme - value copulas .",
    "moreover , @xcite explicitly show that they are satisfied by the clayton , gumbel , gaussian and student copulas .",
    "compared to @xcite , assumption [ ass : copdens ] only requires further the existence and continuity of second - order partial derivatives of @xmath16 , which is natural in kernel estimation .",
    "it is worth noting that @xmath16 is allowed to grow unboundedly in some of the corners of @xmath23 , provided ( [ eqn : unbounded ] ) remains valid .",
    "the following result can now be stated .",
    "an important observation is that it holds true for @xmath123 , @xmath124 , which includes the optimal bandwidth order known to be @xmath125 for bivariate density estimation .",
    "[ thm : fshat ] assume that @xmath126 and @xmath99 with @xmath123 for some @xmath127 . under assumptions [ ass :",
    "fxy]-[ass : copdens ] , the estimator ( [ eqn : fsthat2 ] ) at any @xmath83 is such that @xmath128 where @xmath129 and @xmath130 .    see appendix .    as recalled in section [ sec : intro ] , resorting to pseudo - observations is known to usually affect the statistical properties of the estimators of interest in copula modelling .",
    "in particular , an overriding result in the field is the weak convergence of the empirical copula process @xmath131 where @xmath132 is a bivariate pinned @xmath0-brownian sheet on @xmath23 , i.e.  the tight centred gaussian process whose covariance function is @xmath133 @xcite .",
    "in fact , @xmath132 would be the limiting process if the margins were known , i.e.  if ` genuine ' @xmath134 s and @xmath135 s were used in ( [ eqn : empcop ] ) .",
    "the extra two terms in the right - hand side of ( [ eqn : limitempcop ] ) are , therefore , often interpreted as ` the price to pay ' for using pseudo - observations  although this effect is sometimes advantageous @xcite . yet",
    ", the proof of proposition [ thm : fshat ] reveals that the effect of those two terms asymptotically vanishes when one looks at the properties of the kernel density estimator ( [ eqn : fsthat2 ] ) . as a result , the rate of convergence , as well as the expressions for asymptotic bias and variance , are the same as what one would obtain for the ideal estimator @xmath107 using genuine i.i.d .  observations from @xmath0 . intuitively , this is because a kernel density estimator converges slower than an empirical distribution function .",
    "resorting to pseudo - observations may disturb the @xmath136-convergence of the latter , but it goes unnoticed ( asymptotically ) compared to the nonparametric convergence rate @xmath137 of the former .",
    "now , differentiating ( [ eqn : fst ] ) yields @xmath138 ( and similar for @xmath139 , @xmath140 and @xmath141 ) .",
    "hence , combining ( [ eqn : fst ] ) , ( [ eqn : copratio ] ) , ( [ eqn : normfsthat ] ) and ( [ eqn : secondderfst ] ) , one can state the following theorem for the ` naive ' probit transformation kernel copula density estimator ( [ eqn : naivefeas2 ] ) .    [ thm : chat ] under the assumptions of proposition [ thm : fshat ] , the ` naive ' probit transformation kernel copula density estimator ( [ eqn : naivefeas2 ] ) at any @xmath59 is such that @xmath142 where @xmath143 and @xmath144 .",
    "see appendix .",
    "it is seen that , when @xmath145 approaches one of the boundaries , both the ( asymptotic ) bias and variance of the estimator tend to grow unboundedly .",
    "indeed , @xmath146 and @xmath147 includes the term @xmath148 , and the functions @xmath149 and @xmath150 are unbounded .",
    "thus , along the boundaries , @xmath63 will work properly only over areas , if any , where @xmath16 approaches 0 very smoothly .",
    "otherwise , @xmath63 will typically show a very erratic behaviour ( large variance ) and will be prone to exploding ( large positive bias ) , especially in the corners of @xmath23 in which @xmath16 is large .",
    "figure [ fig : naivecopdens ] illustrates these problems , from a typical sample of size @xmath151 simulated from the gaussian copula with correlation @xmath152 ( left panel ) .",
    "the corresponding naive probit - transformation kernel estimator is shown in the middle panel .",
    "an unconstrained matrix @xmath153 was used in ( [ eqn : fsthat])/([eqn : naivefeas ] ) and chosen by the multivariate normal reference rule @xcite . here",
    ", this is optimal : @xmath0 being a gaussian copula , @xmath51 is a bivariate normal density . over the middle of the unit square , the estimator appears to work decently , but towards the boundaries the estimate shows coarse folds and , indeed , hypertrophies the peaks in the corners @xmath154 an @xmath155 . clearly , this estimator is not acceptable as - is .",
    "it is , therefore , not surprising that it has been reported not to perform well , see for instance the simulation study in @xcite .",
    "the third , unbounded term in ( [ eqn : biaschat ] ) can , however , be easily adjusted for . instead of ( [ eqn : copratio ] ) ,",
    "take @xmath156 for this ` amended ' version of @xmath63 , one can see that the asymptotic bias becomes proportional to @xmath157 in fact , the deterministic , multiplicative amendment in ( [ eqn : amendnaive ] ) exactly makes it up for the third term in ( [ eqn : biaschat ] ) in the asymptotic development , given that @xmath158 as @xmath159 .",
    "the improvement is illustrated in figure [ fig : naivecopdens ] ( right panel ) , where the amended version of the naive estimator computed on the same data set as in the middle panel is shown .",
    "the peaks in the corners @xmath154 and @xmath155 are now roughly of the right height . on the other hand ,",
    "the wiggly appearance of the estimate along boundaries mostly remains , as the variance is not affected by the deterministic amendment . on a side note",
    ", the amendment implies that the estimator @xmath160 does not integrate to one over the unit square any more , which calls for a renormalisation such as @xmath161 .",
    "this is , however , frequent in other nonparametric density estimation procedures , and is not really a problem .",
    "now the asymptotic properties of the ` improved ' versions of the probit - transformation kernel copula density estimators are derived .",
    "again , for convenience , the results are stated in the case where @xmath24 is a product of two univariate gaussian kernels and @xmath162 , for some @xmath100 , in ( [ eqn : loclogpol ] ) .",
    "the first version estimates the joint density @xmath51 in the transformed domain by the local log - linear estimator @xmath163 .",
    "consider first the ` ideal ' version @xmath164 of this estimator , computed on the genuine sample @xmath165 . from @xcite ,",
    "one gets , for all @xmath83 at which @xmath166 is positive and admits continuous second - order partial derivatives , @xmath167 where @xmath168 and @xmath169 . of course",
    ", if @xmath170 at some @xmath67 , the singularity of the log - density can not be accurately approximated by ( [ eqn : locloglin ] ) , but this is ruled out here by assumption [ ass : copdens ] which requires @xmath16 to be positive all over the interior of the unit square . by ( [ eqn : fst ] ) , this implies that @xmath51 is positive over @xmath50 .",
    "define the ` ideal ' local log - linear probit - transformation kernel copula density estimator @xmath171 . by the same token as for theorem [ thm : chat ] , in particular by using ( [ eqn : fst ] ) , ( [ eqn : copratio ] ) , ( [ eqn : firstderfst ] ) and ( [ eqn : secondderfst ] ) in ( [ eqn : normfsttilde1 ] ) , one can obtain @xmath172 where @xmath173 and @xmath174 .",
    "the next result ascertains that , like for the ` naive ' estimator , the asymptotic properties of @xmath175 are not affected by using pseudo - observations , and are consequently identical to those of the ideal version @xmath176 .",
    "[ thm : ctilde1 ] under the assumptions of proposition [ thm : fshat ] , the ` improved ' local log - linear probit - transformation kernel copula density estimator @xmath175 at any @xmath59 is such that @xmath177 where @xmath178 and @xmath179 are given above .",
    "see appendix .    compared to the ` naive ' estimator",
    ", the variance is the same but the bias is significantly different .",
    "it is now automatically free from any unbounded terms .",
    "in fact , @xcite showed ( their expression ( 7.3 ) ) that the local log - linear and the standard kernel estimators in the @xmath47-domain ( @xmath180 and @xmath60 , respectively ) satisfy @xmath181\\right\\}. \\label{eqn : corrslope}\\ ] ] this closed - form expression for @xmath180 shows that it improves on the basic kernel estimator by adjusting for the local slopes . with ( [ eqn : copratio ] ) ,",
    "( [ eqn : impctilde ] ) and an analogue of ( [ eqn : firstderfst ] ) for hat versions , one can state a similar result in terms of the copula density estimators : @xmath182\\bigg\\}. \\end{aligned}\\ ] ] this reveals that , not only the local log - linear estimator @xmath175 attempts a correction for the slopes of @xmath16 like in ( [ eqn : corrslope ] ) , it actively acts on the boundary behaviour as well .",
    "indeed , given that @xmath183 and @xmath184 tend to 0 towards 0 and 1 , the first four terms in the bracket in the previous expression will have little influence towards the boundaries ( provided @xmath16 does not tend to 0 too sharply there ) . on the other hand , @xmath185 tends to @xmath186 very fast along boundaries ( and all the more in the corners ) , hence @xmath187 is multiplied by something quickly tending to 0 there and this prevents it from exploding .",
    "this is , in fact , very similar to what the amendment in ( [ eqn : amendnaive ] ) attempted , but is now achieved automatically .",
    "figure [ fig : loclikcopdensfix ] ( middle panel ) shows the estimate @xmath175 for the data set used in figure [ fig : naivecopdens ] .",
    "it used the cross - validation criterion discussed in section [ sec : bandwidth ] to select the matrix @xmath76 in ( [ eqn : loclogpol ] ) .",
    "the second improved probit - transformation estimator is obtained when taking @xmath87 in ( [ eqn : loclogpol ] ) .",
    "again , consider first the ` ideal ' estimator @xmath188 , computed on the genuine sample @xmath189 . locally fitting a polynomial of a higher degree",
    "is known to reduce the asymptotic bias of the estimator , here from order @xmath190 to order @xmath191 @xcite , sufficient smoothness of @xmath51 permitting .",
    "specifically , if @xmath51 admits continuous fourth - order partial derivatives and is positive at @xmath67 , then @xmath192 where @xmath193 and @xmath194 with @xmath195 . starting from @xmath196 , tedious algebraic differentiation provides all partial derivatives of @xmath197 up to order four in terms of @xmath16 and its partial derivatives up to order four .",
    "naturally , @xmath16 will be assumed to admit continuous fourth - order partial derivatives .",
    "[ ass : cop4 ] the copula density @xmath198 admits continuous fourth - order partial derivatives on the interior of the unit square @xmath23 .    as previously , it readily follows from ( [ eqn : normfsttilde2 ] ) that @xmath199 where @xmath200 and @xmath201 is an expression of the same type as ( [ eqn : biasctilde1 ] ) , this time involving the partial derivatives of @xmath16 up to the fourth order .",
    "like above , it can be shown that resorting to pseudo - observations does not affect these properties .",
    "this , however , requires a condition on the bandwidth ( @xmath202 ) slightly stronger than previously .",
    "given that the bias order is reduced to @xmath191 , the optimal bandwidth order is now seen to be @xmath203 , so that the bandwidth requirement does still include that optimal order .",
    "[ thm : ctilde2 ] under the assumptions of proposition [ thm : fshat ] and assumption [ ass : cop4 ] , if @xmath123 with @xmath204 as @xmath74 , the ` improved ' local log - quadratic probit - transformation kernel copula density estimator @xmath205 at any @xmath59 is such that @xmath206 where @xmath201 and @xmath207 are described above .",
    "see appendix .    for seek of conciseness",
    ", the expression of @xmath201 is not given here ( it is made up of several dozens of terms ) .",
    "the interesting point about it , though , is that , unlike ( [ eqn : biasctilde1 ] ) which shows a last term @xmath208 , all terms of @xmath201 are proportional to @xmath209 , for some non - negative integral powers @xmath210 , and all those functions tend to 0 as @xmath211 .",
    "hence , @xmath201 may actually tend to 0 towards the boundaries , and the bias there be actually of order @xmath212 .",
    "again , this will be the case where @xmath16 does not tend to 0 too sharply when approaching the boundary .",
    "the expression of the variance is the same as that for @xmath213 and @xmath214 , except that it has been inflated by a factor @xmath215 .",
    "this inflation factor is , also , a well - known feature in local polynomial modelling when fitting a higher - degree polynomial ( * ? ? ?",
    "* section 3.3.1 ) .",
    "interestingly , _",
    "techniques for reducing the bias of kernel estimators from @xmath190 to @xmath191 , e.g.  higher - order kernels or multiplicative adjustment , have long been an active research topic @xcite . yet , few of those methods have actually taken hold .",
    "the main reason is that the demonstrated improvement is an asymptotic result , which usually goes unnoticed for sample sizes one typically has in practice while implying interpretability issues ( e.g.  negative density estimates when using higher - order kernels ) and computational burden .",
    "it is , therefore , worth stressing that here combining probit transformation and local log - quadratic density estimation in the @xmath47-domain achieves that bias reduction with no real extra complications compared to other estimators and fixes the boundary bias in an automatic way .",
    "furthermore , these improvements are visible even in moderately large sample size , as the simulation study in section [ sec : sim ] will show .",
    "the most obvious and practically relevant effect of this bias reduction is that a larger bandwidth can be used without oversmoothing .",
    "this results in smoother estimates , visually more pleasant .",
    "this is clear in figure [ fig : loclikcopdensfix ] ( right panel ) , where @xmath205 is shown for the same data set as previously .",
    "again , the bandwidth matrix in ( [ eqn : loclogpol ] ) was chosen via the cross - validation method suggested in section [ sec : bandwidth ] .",
    "theorems [ thm : ctilde1 ] and [ thm : ctilde2 ] reveal that the combination of probit transformation and local likelihood methods mostly cures the boundary bias problems for kernel copula density estimation .",
    "however , the fact remains that the suggested estimators have a variance behaving like @xmath217 where @xmath218 and @xmath219 , as @xmath74 .",
    "hence , @xmath220 tends to grow unboundedly when @xmath145 approaches one of the boundaries .",
    "note that this is also the case for other copula density estimators attempting to correct the boundary bias , see for instance ( * ? ? ?",
    "* chapter 4 ) and @xcite who obtain similar unbounded boundary variance for the beta kernel and the bernstein estimators .",
    "facing the same situation in the univariate case , @xcite suggested to use @xmath216-nearest - neighbor ( @xmath216-nn ) type bandwidth in the transformed domain .",
    "although barely used for standard kernel density estimation , @xmath216-nn bandwidths appeared totally appropriate in @xcite s framework and , indeed , managed to stabilise the variance towards the boundaries .",
    "this is also the case in this setting as can be understood heuristically as follows .",
    "again , assume that the smoothing matrix @xmath76 in ( [ eqn : loclogpol ] ) is diagonal , but instead of taking @xmath162 for some fixed value @xmath221 , take a local smoothing matrix defined as @xmath222 , where @xmath223 is the euclidean distance between @xmath67 and the @xmath216th closest observation out of the sample ( [ eqn : pseudosamp ] ) in @xmath50 .",
    "now it is @xmath216 , or equivalently @xmath224 , that will play the role of the smoothing parameter in lieu of @xmath221 .",
    "if @xmath24 had a compact support , @xmath225 would be the proportion of observations actively entering the estimation of @xmath51 at any @xmath67  the interpretation roughly holds for the gaussian kernel as well .",
    "of course , @xmath223 depends on the sample and is a random quantity .",
    "along the same lines as in @xcite , one can show that @xmath226 and , together with @xmath227 , that @xmath228 now , through ( [ eqn : copratio ] ) , one directly gets , for all @xmath59 , @xmath229 unlike ( [ eqn : varinf ] ) , this is no more proportional to @xmath230 which grows unboundedly towards boundaries .",
    "this results in estimates more stable and much smoother towards the borders of @xmath23 .",
    "in fact , given that the ( long ) tails of @xmath231 in the transformed domain becomes the ( short ) boundary regions of @xmath232 in @xmath23 through the compressing back - transformation @xmath233 , @xmath231 must have _ very smooth _ tails in @xmath50 to produce suitably smooth boundary behaviour for @xmath232 .",
    "this is exactly what is achieved by using a @xmath216-nn bandwidth in the @xmath47-domain : local likelihood density estimators using @xmath216-nn bandwidth are , indeed , known to produce smoother estimates in the tails than their fixed - bandwidth counterparts , avoiding the occurrence of ` spurious bumps ' .",
    "hence the appropriateness of the method here .",
    "this is illustrated in figure [ fig : loclikcopdensknn ] .",
    "again , the previous simulated data set was used to produce the two ` improved ' probit - transformation kernel copula density estimates shown in the middle ( local log - linear ) and the right panel ( local log - quadratic ) , but this time a @xmath216-nn - type unconstrained bandwidth matrix @xmath234 was used ( see section 4 for details ) .",
    "compared to figure [ fig : loclikcopdensfix ] , the estimates are much smoother along the boundaries now .",
    "for instance , using a @xmath216-nn - bandwidth mostly corrects the kink previously observed in the @xmath235 corner .",
    "it is particularly clear for @xmath205 .",
    "the value of @xmath225 selected for the case @xmath86 was 0.1871 , that for the case @xmath87 was 0.4976 .",
    "again , the bias order reduction implied by local log - quadratic modelling allows a larger smoothing parameter to be used . as a result , this estimate @xmath205 ( right panel ) has a smooth and visually pleasant appearance , but without oversmoothing .",
    "in fact , it is barely distinguishable from the true copula density ( left panel ) .",
    "it happens that the estimator @xmath205 , when used in conjunction with a @xmath216-nn - type bandwidth , is strikingly good at recovering the shape of the underlying copula density while maintaining a visually pleasant amount of smoothness , see also section [ sec : realdat ] .",
    "the behaviour of kernel estimators is known to be crucially dependent on their smoothing parameter , whose choice in practice is unanimously recognised as a very difficult problem , especially in more than one dimension . here an effective way for selecting a suitable bandwidth matrix @xmath236 in ( [ eqn : loclogpol ] ) is suggested .",
    "it can be understood that the diagonal elements @xmath237 and @xmath238 of @xmath76 quantify the amount of smoothing applied in the directions of the main @xmath55- and @xmath13-axes , hence their values will drive the overall smoothness of the resulting estimate @xmath239 and eventually that of @xmath232 . on the other hand",
    ", @xmath240 sets the direction along which that smoothing mostly takes place in @xmath50 .",
    "for instance , if @xmath24 is the bivariate gaussian kernel , the local weights around @xmath83 will be set by the elliptical contour lines of the @xmath241-distribution .",
    "if @xmath51 is stretched along a particular direction of @xmath50 , which will be the case if @xmath16 itself is so on the unit square , it is greatly beneficial to the estimator that smoothing be applied in that direction @xcite , and so @xmath240 should be selected accordingly . if this is not the case , in particular if @xmath45 and @xmath46 are uncorrelated , then @xmath240 may be set to 0 .",
    "this motivates to separate the problem of selecting @xmath242 and @xmath243 from that of selecting @xmath240 .",
    "the idea developed here looks for achieving this , in a way close in spirit to pre - sphering the observations ( * ? ? ?",
    "* section 4.6 ) .    consider the principal components decomposition of the @xmath244-`data matrix ' @xmath245 . by construction , the @xmath246 s and @xmath247 s",
    "are centred , hence @xmath248 and @xmath249 , the score of the @xmath250th observation on the first and second principal components , are given by @xmath251 where @xmath252 and @xmath253 are the eigenvectors of @xmath254 .",
    "given that the transformation @xmath255 is only a linear reparametrisation of @xmath50 , an estimate of @xmath51 can be readily obtained from an estimate of the density of @xmath256 , say @xmath257 .",
    "in addition , it is well known that the samples @xmath258 and @xmath259 are uncorrelated , hence estimating @xmath257 via any kernel method from the sample @xmath260 can be based on a diagonal bandwidth matrix @xmath261 with little side effect .",
    "an idea is then to select @xmath262 and @xmath263 independently via univariate procedures .",
    "denote @xmath264 and @xmath265 ( @xmath93 ) , the local log - polynomial estimators for the density of @xmath266 and @xmath267 , respectively , based on the samples @xmath258 and @xmath259 ( see equations ( 6 ) and ( 7 ) in @xcite ) .",
    "of course , @xmath264 only depends on one bandwidth @xmath262 and @xmath265 only depends on another bandwidth @xmath263 . then , @xmath262 can be selected via cross - validation ( * ? ? ?",
    "* section 5.3.3 ) as @xmath268 where , as usual in cross - validation procedures , @xmath269 is the ` leave - one - out ' version of @xmath270 computed on all the observations but @xmath248 .",
    "the value of @xmath263 can be found similarly , and @xmath262 and @xmath263 can be plugged into @xmath271 for proceeding to bivariate estimation",
    ". however , optimal bandwidths for univariate density estimation are usually smaller than those for bivariate density estimation of @xmath257 . for the case",
    "@xmath86 ( local log - linear estimator ) , the asymptotic optimal bandwidth order is @xmath272 for univariate density estimation and @xmath273 in two dimensions . for the case",
    "@xmath87 ( local log - quadratic estimator ) , the asymptotic optimal bandwidth order is @xmath274 for univariate density estimation and @xmath275 in two dimensions .",
    "hence , a fair choice for the bandwidth matrix for estimating @xmath257 seems to be @xmath276 with @xmath262 and @xmath263 the two bandwidths found above by ( univariate ) cross - validation , and @xmath277 in the local log - linear case and @xmath278 in the local log - quadratic case .",
    "the estimate of @xmath51 can finally be obtained by linear back - transformation of the estimate of @xmath257 from the @xmath256-domain to the @xmath47 domain .",
    "it must be noted , though , that , again due to ( [ eqn : linequiv ] ) , this exactly amounts to directly estimating @xmath51 from @xmath82 using the bandwidth matrix @xmath279 when the estimator is to be built on a @xmath216-nn - type bandwidth matrix , the procedure is very similar .",
    "the data are transformed into the sample @xmath260 via ( [ eqn : pca ] ) .",
    "then , a suitable value of @xmath225 in the @xmath266-direction is computed as @xmath280 i.e.  exactly as in ( [ eqn : hcv ] ) but this time @xmath264 is the estimator based on the @xmath216-nn bandwidth @xmath225 . the value @xmath281 is computed in the same way .",
    "denote @xmath282 .",
    "then , the squared norm of a vector in the @xmath256-domain will be computed as @xmath283 the factor @xmath284 naturally adjusts , through the obtained close - to - optimal values of @xmath285 and @xmath281 , for the potential discrepancy in local geometry in the @xmath286- and @xmath287-directions .",
    "the bivariate estimation of @xmath257 at any @xmath288 is carried out using the @xmath289 nearest neighbours of @xmath290 , these being determined by the above distance . here , @xmath291 and @xmath292 , again for accounting for the difference in optimal @xmath225-orders in one and two dimensions .",
    "finally , the estimate of @xmath51 is obtained by inverse linear transformation or , as set out in the fixed - bandwidth case , directly from the sample @xmath82 using an appropriate mahalanobis - like distance .",
    "the main difference is that here , the employed distance makes use , through @xmath293 in ( [ eqn : distkappa ] ) , of relevant information in terms of optimal smoothing , not only in terms of the covariance structure of @xmath294 like the usual mahalanobis distance . in this",
    "setting , the ` smoothing parameters ' vector is , therefore , @xmath295 .",
    "it is acknowledged that this procedure may lack of sufficient theoretical support .",
    "for instance , it is known that pre - sphering the observations in the process of selecting the bandwidth matrix is justified only if the underlying density @xmath51 is bivariate normal , that is , in this framework , if @xmath16 is the gaussian copula .",
    "likewise , choosing @xmath262 and @xmath263 ( or @xmath285 and @xmath281 ) independently via univariate procedures would be suitable in theory only if @xmath266 and @xmath267 were independent , not only uncorrelated .",
    "the need for a correcting factor @xmath296 in the above bandwidth expressions may also seem like nothing less than a heuristic , _ ad - hoc _ correction . having said this , it was found that this way of doing gave very reliable results , as illustrated in figures [ fig : loclikcopdensfix ] and [ fig : loclikcopdensknn ]",
    ". this will be even more obvious in the simulation study and the real data analysis detailed in the next sections .",
    "in addition , the suggested procedure , based on a twofold univariate cross - validation optimisation problem , is more stable numerically than one based on optimising a full , bivariate cross - validation criterion .",
    "this technique seems , therefore , an acceptable choice for selecting the bandwidth matrix in practice .",
    "here , monte carlo simulations results are presented to compare the practical behaviour of the probit - transformation estimators with that of their main competitors .",
    "all computations have been carried out using the r software and its freely available packages .",
    "specifically , 12 estimators were considered :    * the ` mirror reflection ' estimator , denoted @xmath297 below , as suggested in @xcite .",
    "it was the first attempt at nonparametric copula density estimation , and remains a common choice for ( ostensibly ) correcting boundary bias .",
    "it will , therefore , be taken as benchmark .",
    "a first bandwidth matrix was obtained from the ` augmented ' data set ( made up of @xmath298 ` observations ' spread over an area 9 times bigger than @xmath23 ) via the normal reference rule , then the final matrix was obtained by multiplying the former by @xmath299 for adjusting for the effective sample size and range ; * the ` naive ' probit - transformation estimator @xmath300 ( [ eqn : naivefeas ] ) and its amended version @xmath301 , whose idea is exposed in section [ subsec : naive ] ( for a general , non - diagonal matrix @xmath76 , the amendment takes a slightly more complicated form than ( [ eqn : amendnaive ] ) ) . the bandwidth matrix @xmath76 was selected via a direct plug - in method @xcite in the transformed domain @xmath47 ; * the improved probit - transformation estimators @xmath302 and @xmath303 , given by ( [ eqn : impctilde ] ) , based on a @xmath216-nn - type bandwidth matrix selected via cross - validation as described at the end of section [ sec : bandwidth ] .",
    "as already observed in @xcite in the univariate case , when based on a fixed - bandwidth matrix these estimators performed a little less well , so the results are not shown here .",
    "the optimisation problems ( [ eqn : loclogpol ] ) ( local log - polynomial estimation of @xmath51 ) and ( [ eqn : alphacv ] ) ( @xmath216-nn bandwidth selection ) were solved using the relevant functions of the r package locfit .",
    "a r package directly implementing these improved probit - transformation estimators is in preparation ; * the beta kernel estimator @xcite , denoted @xmath304 , with @xcite s further bias correction .",
    "two smoothing parameters were considered : @xmath305 ( @xmath306 ) and @xmath307 ( @xmath308 ) ; * the bernstein copula density estimator @xcite , denoted @xmath309 .",
    "two smoothing parameters were considered : @xmath310 ( @xmath311 ) and @xmath312 ( @xmath313 ) ; * the penalised hierarchical @xmath314-splines estimator @xcite , denoted @xmath315 , computed by the function pencopula in the eponymous r package .",
    "the vector of penalty coefficients was set to @xmath316 ( @xmath317 ) , @xmath318 ( @xmath319 ) , and @xmath320 ( @xmath321 ) .",
    "the parameters @xmath322 and @xmath323 were set to @xmath324 and @xmath325 , according to @xcite s simulations study .",
    "@xmath326 independent random samples @xmath36 of sizes @xmath327 , @xmath328 and @xmath151 were generated from each of the following copulas :    * the independence copula ( i.e. , @xmath134 s and @xmath135 s drawn independently ) ; * the gaussian copula , with parameters @xmath329 , @xmath330 and @xmath331 ; * the student @xmath13-copula with 10 degrees of freedom , with parameters @xmath329 , @xmath330 and @xmath331 ; * the student @xmath13-copula with 4 degrees of freedom , with parameters @xmath329 , @xmath330 and @xmath331 ; * the frank copula , with parameter @xmath332 , @xmath333 and @xmath334 ; * the gumbel copula , with parameter @xmath335 , @xmath336 and @xmath337 ; * the clayton copula , with parameter @xmath338 , @xmath336 and @xmath337 .    for each family of copulas ,",
    "the considered three values of the parameter roughly correspond to kendall s @xmath339 s equal to 0.2 , 0.4 and 0.6 , respectively .",
    "of course , all the estimations only made use of the pseudo - observations , i.e.  the normalised ranks of the observations in the initially generated samples @xmath340 and @xmath341 .    in order to assess the quality of the fit of an estimator @xmath342 for a given copula density @xmath16 , the mean integrated @xmath343-error @xmath344 was estimated by the average over the @xmath326 monte carlo replications of @xmath345 with @xmath346 .",
    "the approximated mise can be found in tables [ tab : l2:square-200 ] , [ tab : l2:square-500 ] and [ tab : l2:square-1000 ] for the three considered sample sizes .",
    "note that , for ease of reading and interpretation , all the values are relative to the ( approximated ) mise of the benchmark mirror estimator @xmath297 . for reference ,",
    "the effective mise of @xmath297 is reported in italics in the last column of the table ( which is , therefore , not on the same scale as the other values ) .",
    ".(approximated ) mise relative to the mise of the mirror - reflection estimator ( last column ) , @xmath327 .",
    "bold values show the minimum mise for the corresponding copula ( non - significantly different values are highlighted as well ) . [ cols=\">,>,>,>,>,>,>,>,>,>,>,>,>\",options=\"header \" , ]     it turns out that the estimators @xmath175 and @xmath205 are clearly the best , overall , on this @xmath347-error criterion , and this for all sample sizes .",
    "they always dramatically improve on the beta and bernstein estimators , and they also do much better than the mirror reflection and the penalised b - splines estimators when the dependence is not close to null .",
    "when the depence is very low , @xmath348 and @xmath349 do better , which can be easily understood .",
    "it is well known that the mirror reflection estimator efficiently deals with boundary effects only when the partial derivatives of @xmath16 are 0 there ( ` shoulder ' ) .",
    "it is , therefore , particularly appropriate for the independence copula ( @xmath350 ) and other very flat copula densities such as gaussian or frank with low dependence .",
    "the penalised b - splines estimator does even better when using a huge penalty for roughness , for obvious reasons . in all other cases , and particularly when the copula density becomes unbounded in some corners ( but not only ) , @xmath175 and @xmath205 dramatically outperform their competitors .",
    "in fact , mirror reflection and splines are not appropriate methods for estimating unbounded copula densities , and this is a real problem given that those are the most interesting cases in practice . by construction",
    ", the beta kernel estimator always tends to be zero along boundaries ( see for instance figure [ fig : loss - alae - comp ] below ) , hence its even worse performance in this framework .",
    "the bernstein estimator does better than @xmath351 , but can not really compete with @xmath175 and @xmath205 . of course",
    ", one can argue that the smoothing parameters used for @xmath351 , @xmath352 and @xmath349 have been selected mostly arbitrarily and are not adequate .",
    "this may be true , however , there is no simple , data - driven way of selecting those parameters , hence the choice was made subjectively exactly as a practitioner should have resolved to act .",
    "in addition , the above observations support that bad smoothing parameter choice is not the only reason for the poor performance of some of those estimators",
    ". other evidence of that will be given in the next section on a real data set .",
    "in general , the local log - quadratic estimator @xmath205 is doing better than the local log - linear @xmath175 , which was expected from the theoretical results . a notable exception ,",
    "though , is in presence of high tail dependence , i.e.  when the copula density tends very quickly to @xmath353 at one of the corners of @xmath23 , such as for clayton and gumbel copulas with high kendall s @xmath339 .",
    "in fact , the extra smoothness guaranteed by local log - quadratic estimation tends to prevent the estimator from growing too quickly in the corners , and this is thus slightly detrimental in those cases .",
    "the same comment holds true when comparing the naive estimator @xmath63 to its amended version @xmath354 .",
    "generally , @xmath354 has lower mise than @xmath63 , except in the above - mentioned cases of high tail dependence .",
    "indeed , the amendment prevents the estimate from exploding , even when the true density does . in any case",
    ", these ` naive ' versions can not really match the performance of the ` improved ' versions @xmath175 and @xmath205 on mise , not to mention that their visual appearance is by far less pleasant .",
    "finally , other criteria were considered for comparing the different estimators , such as @xmath355-error on the square @xmath356 , @xmath355- and @xmath347-error on the first diagonal ( @xmath357 ) and on a side ( @xmath358 ) of @xmath23 , or @xmath355- and @xmath347-error at a given point in one of the corners of @xmath23 ( @xmath359 ) .",
    "these results are available on request from the authors .",
    "all show , to the same extent as above , the superiority of the improved probit - transformation estimators over their competitors .",
    "in this section the well - known ` loss - alae ' dataset , reporting the indemnity payment ( @xmath360 s ) and allocated loss adjustment expense ( @xmath361 s ) associated to @xmath362 losses from an insurance company , is considered .",
    "analysed in @xcite and @xcite , this dataset has since then become a classic in the copula literature .",
    "in particular , @xcite mentioned that the gumbel copula with @xmath363 provides an excellent fit .",
    "the data set initially contains 34 censored observations , that were excluded here as the suggested estimators were not designed to take censorship into account . using more advanced model selection ideas",
    ", @xcite also found that the gumbel copula ( with the same parameter @xmath364 ) fits the dataset ( restricted to its complete cases ) the best out of most of the usual parametric copula models .",
    "the aim here is to test the probit - transformation estimators @xmath232 ( @xmath93 ) ( and their competitors ) against that parametric ` gold standard ' , shown in figure [ fig : loss - alae1 ] ( up - left ) .    ; upper - left panel ) and probit - transformation estimates with @xmath86 ( middle column ) and @xmath87 ( right column ) .",
    "the upper line shows 3-d views and the bottom line shows contour lines , superimposed on the gumbel copula density contour lines .",
    "pseudo - observations are shown in the bottom - left panel.,scaledwidth=95.0% ]    the two probit - transformation estimators ( local log - linear and local log - quadratic ) were first fit to the data set . in both cases ,",
    "a @xmath216-nn bandwidth matrix was used . using the selection rule prescribed in section [ sec : bandwidth ] , the parameters @xmath365 for @xmath86 and @xmath366 for @xmath87 were obtained in an automatic manner .",
    "the estimator @xmath205 is , again , very similar to the parametric fit . in particular , it has that very smooth and pleasant appearance of parametric estimates , while being based on a fully nonparametric procedure . reproducing ` parametric smoothness ' without sacrificing",
    "any flexibility is , of course , a huge achievement for @xmath205 .",
    "naturally , @xmath175 is less smooth ( smaller value of @xmath225 than for @xmath205 , for the reasons explained at the end of section [ sec : asymptpropimprov ] ) , but is still totally acceptable .",
    "both nonparametric estimates suggest that the true underlying copula density decays towards the @xmath367-corner quicker than what the gumbel model shows ( this is particularly clear from the contour lines ) .",
    "admittedly , there is no way of knowing what is the truth here .",
    "however , @xmath175 and @xmath205 are based only on the data ( it is visually obvious that the upper - left corner of @xmath23 is much less endowed in data than the bottom - right corner ) , and not on any prior assumption . on the contrary ,",
    "the gumbel copula density is inherently symmetric in @xmath368 and @xmath369 .",
    "the peak in the density at @xmath154 also appears less high on the nonparametric estimates than on the gumbel copula density .",
    "figure [ fig : loss - alae - comp ] shows the competitors on the same data set : the mirror reflection estimator , two beta kernel estimators , two bernstein estimators and two penalised @xmath314-splines estimators .",
    "of course , @xmath348 can not cope with this unbounded copula density .",
    "for the other three methods , producing an estimate reasonably smooth required a value of the smoothing parameter ( @xmath221 for beta kernel estimators , @xmath216 for bernstein estimators and @xmath370 for penalised @xmath314-splines ) preventing correct estimation of the peaks at @xmath154 and @xmath155 . to get estimates showing a peak at @xmath155 of roughly the right magnitude , one needed to use smoothing parameters producing unacceptably undersmoothed estimation elsewhere on @xmath23 , yet not even able to properly catch the peak at @xmath154",
    "if the gumbel copula density is assumed to be close to the truth for this data set , then there is no question that @xmath175 and @xmath205 are , by far , the best .",
    "this , also , illustrates that the results obtained in the simulations are not only due to bad smoothing parameter choices .    ) , mirror reflection estimator , beta kernel estimators with @xmath307 and @xmath305 , bernstein estimators with @xmath310 and @xmath371 and penalized @xmath314-splines estimators with @xmath372 and with @xmath373 and @xmath374,scaledwidth=95.0% ]",
    "development of efficient kernel - type methods for nonparametric copula modelling have been delayed owing mainly to the bounded support of copulas , namely the unit square @xmath23 .",
    "it is , indeed , well known that kernel estimators heavily suffer from boundary bias issues , which are not trivial to fix . in this paper ,",
    "a new kernel - type estimator for the copula density has been proposed .",
    "it is based on the probit - transformation idea suggested in @xcite and studied in full in the univariate case in @xcite .",
    "this ` improved probit - transformation estimator ' deals with boundary bias in a very natural way .",
    "in addition , it has been seen to easily cope with potentially unbounded copula densities , which are the common and interesting cases in copula modelling .",
    "an easy - to - implement selection rule for the necessary smoothing parameters has also been proposed .",
    "this procedure has been seen to be very stable and to give very good results in practice . in particular ,",
    "a version of the estimator ( @xmath375 with @xmath216-nn - type bandwidth matrix ) is able to reproduce the smooth and pleasant appearance of parametric models , while keeping the flexibility of fully nonparametric estimation procedures .",
    "a comprehensive simulation study has emphasised the very good practical performance of that estimator compared to its main competitors .",
    "several important points remain to be studied , though .",
    "first , as of now , the theoretical properties of the estimator have been derived under the assumption of i.i.d .",
    "sampling , making use of the strong approximation for the empirical copula process provided by proposition 4.2 of @xcite . to the best of these authors knowledge",
    ", this result has not been proved in the case of weakly dependent observations .",
    "it would be particularly significant to investigate this in a near future , given the predominant place recently found by copula modelling in the setting of time series , notably in finance .",
    "other directions for future research would look for using the new copula density estimator in a variety of problems , for instance copula goodness - of - fit tests @xcite or nonparametric conditional density estimation @xcite . finally , it must be said that , in theory , the idea presented in this paper is not bound to the bivariate case but extends in a straightforward way to higher dimensional copulas as well .",
    "of course , in practice , this is wise only within the limits allowed by the _ curse of dimensionality_.",
    "the first author was supported by a faculty research grant from the faculty of science , university of new south wales ( australia ) .",
    "the second author acknowledges additional funding provided by the natural sciences and engineering research council of canada .",
    "the third author was supported by an a.r.c .",
    "contract from the _ communaut franaise de belgique _ and by the iap research network grant nr .",
    "p7/06 of the belgian government ( belgian science policy ) .",
    "first a technical lemma , which may be of interest of its own , is stated .      from assumption [ ass : copdens ] ,",
    "one easily obtains that , for all @xmath59 , @xmath377 in particular , when approaching the @xmath154-corner , the above implies that @xmath378 for some constant @xmath379 ( and similar towards the boundaries and the other corners of @xmath23 ) .",
    "now , applying theorem 1 of @xcite , one can show that this implies that , for @xmath380 s.t .",
    "@xmath381 , there exist constants @xmath382 such that @xmath383 ( and again , similar results hold at boundaries and at the other corners of @xmath23 ) . given that @xmath17 is assumed to be twice continuously differentiable everywhere on the interior of @xmath23 ( i.e. , @xmath17 and all its mixed partial derivatives of the first two orders can only go unbounded towards the boundaries of @xmath23 ) , this allows one to write that , there exist @xmath384 and bounded constants @xmath385 such that @xmath386 for all @xmath59 . then , ( [ eqn : unb ] ) in ( [ eqn : fst ] ) yields @xmath387 for all @xmath83 .",
    "given that , from the known properties of the normal distribution , @xmath388 is bounded for any constant @xmath389 , there exists a constant @xmath390 such that @xmath391 .",
    "now from ( [ eqn : firstderfst ] ) one can write @xmath392 from ( [ eqn : unb ] ) and ( [ eqn : derivunb ] ) with @xmath393 , @xmath394 , one gets @xmath395 take @xmath396 and see that , as above , @xmath397 is bounded , so that the first term is uniformly bounded on @xmath50 .",
    "the second term is uniformly bounded as well , as @xmath398 is also bounded for any @xmath389 .",
    "all second - order partial derivatives of @xmath51 can be uniformly bounded in the exact same way using ( [ eqn : derivunb ] ) in ( [ eqn : secondderfst ] ) and similar .",
    "denote @xmath399 i.e.  the ` ideal ' version of the empirical copula ( [ eqn : empcop ] ) using genuine observations @xmath30 s , and the corresponding empirical process @xmath400 , with @xmath401 also , define the process @xmath402 with @xmath403 @xcite shows that , under assumptions [ ass : fxy]-[ass : copdens ] , the empirical copula process @xmath404 ( see ( [ eqn : limitempcop ] ) ) and @xmath405 are such that @xmath406    now , see that @xmath407 integrating by parts , as in the proof of theorem 6 of @xcite , one gets @xmath408 where @xmath409 given that @xmath410 and the conditions on the bandwidth @xmath221 . call @xmath411 so that @xmath412 plugging ( [ eqn : gn ] ) in ( [ eqn : gn2 ] ) yields @xmath413 the process @xmath414 being the bivariate empirical process based on genuine observations",
    ", @xmath415 is , in fact , @xmath416 , for which classical kernel smoothing theory states that @xmath417 the terms @xmath418 and @xmath419 can be worked out explicitly .",
    "this is done below for @xmath418 only ( @xmath419 can be treated in the exact same way ) .",
    "write @xmath420 and proceed with @xmath421 with the change of variable @xmath422 . as @xmath423 ,",
    "this is also @xmath424 taylor - expanding , one gets @xmath425 where @xmath426 , of which only odd powers of @xmath427 will remain in ( [ eqn : psiu ] ) as @xmath428 is an odd function .",
    "hence , @xmath429 since @xmath430 , denoting @xmath431 .",
    "it follows that @xmath432 the change of variable @xmath433 yields @xmath434 where @xmath435 are both between @xmath436 and @xmath221 .",
    "the first term in this decomposition is 0 , as @xmath428 is an odd function .",
    "the second term tends to 0 as @xmath437 .",
    "this is because @xmath438 is nothing else than a usual univariate uniform empirical process .",
    "@xcite studied its modulus of continuity and their theorem 3.1(b ) allows one to write , under these assumptions , @xmath439,|u - u'|\\leq h } |{\\mathbb{b}}_n(u,1)-{\\mathbb{b}}_n(u',1)| = \\sqrt{2h \\log h^{-1 } } \\qquad \\text { almost surely as } n \\to \\infty.\\ ] ] hence the second term can readily be seen to be @xmath440 as @xmath74 , i.e.  @xmath441 as @xmath159 .",
    "the integral in the third term is @xmath442 . given that @xmath443 , one can write @xmath444 this is bounded for @xmath445 large enough , because @xmath51 and @xmath446 are uniformly bounded on @xmath50 by lemma [ lem : unicont ] , and @xmath447 for @xmath448 , which eventually occurs as @xmath74 .",
    "as @xmath449 , one can see that @xmath450 the same can be written for @xmath451 , given that @xmath452 is a uniformly bounded function of @xmath368 on @xmath1 $ ] , from lemma [ lem : unicont ] .",
    "hence , @xmath453 the final result follows by seeing that , using classical kernel density estimation results , @xmath454      result ( [ eqn : normfsthat ] ) can be written at @xmath455 : @xmath456 which implies @xmath457 now , @xmath458 using ( [ eqn : truecopratio ] ) .",
    "in addition , from ( [ eqn : secondderfst ] ) , it is easily seen that @xmath459 has the form ( [ eqn : biaschat ] ) .",
    "using ( [ eqn : truecopratio])/([eqn : copratio ] ) in ( [ eqn : tol ] ) then concludes the proof .      from proposition",
    "[ thm : fshat ] one can conclude that @xmath460 now , from ( [ eqn : corrslope ] ) , one has @xmath461 where @xmath462 and equivalently for the star version .",
    "then , @xmath463 the first term is @xmath464 , given ( [ eqn : o ] ) and @xmath465 as @xmath74 ( i.e.  as @xmath466 ) .    the second term can be written @xmath467 where @xmath468 is between @xmath469 and @xmath470 .",
    "now , it can be seen that @xmath471 from standard kernel arguments , it is known that , if @xmath472 as @xmath74 , @xmath473 is a consistent estimator of @xmath474 , with variance @xmath475 and bias @xmath190 . in a way very similar to the proof of proposition [ thm : chat ]",
    ", one can show that resorting to pseudo - observations does not change the statistical properties of that estimator of @xmath474 .",
    "hence @xmath476 ( and same for the partial derivatives with respect to @xmath13 ) .",
    "it follows that @xmath477 . with the factor @xmath478 in ( [ eqn:2nd ] ) , this means that the second term is of order @xmath479 , which is obviously @xmath464 . then , @xmath480 and since this order carries over to @xmath481 in a straightforward way , ( [ eqn : normctildestar1 ] ) also holds with @xmath214 instead of @xmath482 .",
    "it is very similar to the proof of theorem [ thm : ctilde1 ] , based on the analogue of ( [ eqn : corrslope ] ) for @xmath483 ( i.e.  the bivariate version of equation ( 5.2 ) in @xcite ) .",
    "it is , therefore , omitted .",
    "the reason why a condition on @xmath221 stronger than previously is needed is that here , the analogue of ( [ eqn : psi ] ) involves the second order partial derivatives of @xmath60 . to have those consistent for the corresponding partial derivatives of @xmath51 , indeed , requires @xmath484 .",
    "99 autin , f. , le pennec , e.  and tribouley , k.  ( 2010 ) , thresholding methods to estimate the copula density , j.  multivariate anal .",
    ", 101 , 200 - 222 .",
    "behnen , k .",
    ", huskova , m.  and neuhaus , g. ( 1985 ) , rank estimators of scores for testing independence , statist .",
    "decisions , 3 , 239 - 262 .",
    "blumentritt , t. , on copula density estimation and measures of multivariate association , phd dissertation , universitt zu kln , 2011 .",
    "bouezmarni , t. , rombouts , j.v.k .  and taamouti , a.  ( 2010 ) , asymptotic properties of the bernstein density copula estimator for @xmath225-mixing data , j.  multivariate anal . , 101 , 1 - 10 .",
    "bouezmarni , t. , el ghouch , a.  and taamouti , a.  ( 2013 ) , bernstein estimator for unbounded copula densities , statistics and risk modeling , 4 , 343 - 360 .",
    "bcher , a.  and volgushev , s.  ( 2013 ) , empirical and sequential empirical copula processes under serial dependence , j.  multivariate anal .",
    ", 119 , 61 - 70 .",
    "chacn j.e . ,",
    "duong , t.  and wand , m.p .",
    "( 2011 ) , asymptotics for general multivariate kernel density derivative estimators , statist .",
    "sinica , 21 , 807 - 840 .",
    "charpentier , a. , fermanian , j .- d . and scaillet , o. ( 2007 ) , the estimation of copulas : theory and practice , in : j. rank ( ed . ) ,",
    "copulas : from theory to application in finance , risk publications , london , pp .",
    "chen , s.x .",
    "( 1999 ) , beta kernels estimators for density functions , comput .",
    "data anal .",
    ", 31 , 131 - 145 .",
    "chen , s.x . and",
    "huang , t .-",
    "( 2007 ) , nonparametric estimation of copula functions for dependence modelling , canad .",
    "j. statist .",
    ", 35 , 265 - 282 .",
    "chen , x. , fan , j. , pouzo , d.  and ying , z.  ( 2010 ) , estimation and model selection of semiparametric multivariate survival functions under general censorship , j. econometrics , 157 , 129 - 142 .",
    "deheuvels , p. ( 1979 ) , la fonction de dpendance empirique et ses proprits , acad .",
    "belg bull .",
    ", 65 , 274 - 292 .",
    "denuit , m. , purcaru , o.  and van keilegom , i.  ( 2006 ) , bivariate archimedean copula modelling for censored data in non - life insurance , journal of actuarial practice , 13 , 5 - 32 .",
    "devroye , l. and gyrfi , l. , nonparametric density estimation : the l1 view , wiley , 1985 .",
    "duong , t.  and hazelton , m.l .",
    "( 2003 ) , plug - in bandwidth matrices for bivariate kernel density estimation , j.  nonparametr .",
    "stat . , 15 , 17 - 30 .",
    "duong , t.  and hazelton , m.l .",
    "( 2005 ) , convergence rates for unconstrained bandwidth matrix selectors in multivariate kernel density estimation ,",
    "j.  multivariate anal .",
    ", 93 , 417 - 433 .",
    "einmahl , j.  and ruymgaart , f.  ( 1987 ) , the almost sure behavior of the oscillation modulus of the multivariate empirical process , statist .",
    ", 6 , 87 - 96 . embrechts , p. ( 2009 ) , copulas : a personal view , journal of risk and insurance , 76 , 639 - 650 .",
    "fan , j.  and gijbels , i. , local polynomial modelling and its applications , chapman and hall / crc , 1996 .",
    "faugeras , o.  ( 2009 ) , a quantile - copula approach to conditional density estimation , j.  multivariate anal . , 100 , 2083 - 2099 .",
    "fermanian , j .- d .  and scaillet , o.  ( 2003 ) , nonparametric estimation of copulas for time series , j.  risk , 5 , 25 - 54 .",
    "fermanian , j .- d . ,",
    "radulovic , d. and wegkamp , m. ( 2004 ) , weak convergence of empirical copula processes , bernoulli , 10 , 847 - 860 .",
    "fermanian , j .- d .",
    "( 2005 ) , goodness - of - fit tests for copulas , j.  multivariate anal . , 95 , 119 - 152 .",
    "frees , e.  and valdez , e.  ( 1998 ) , understanding relationships using copulas , n.  am .",
    "j. , 2 , 1 - 25 .",
    "geenens , g. ( 2014 ) , probit transformation for kernel density estimation on the unit interval , j.   amer .   statist .",
    ", _ in press_. genest , c.  and rmillard , b.  ( 2004 ) , test of independence and randomness based on the empirical copula process , test , 13 , 335 - 369 .",
    "genest , c. and favre , a .- c .",
    "( 2007 ) , everything you always wanted to know about copula modeling but were afraid to ask , journal of hydrologic engineering , 12 , 347 - 368 .",
    "genest , c. , rmillard , b.  and beaudoin , d.  ( 2009a ) , goodness - of - fit tests for copulas : a review and a power study , insurance : mathematics and economics , 44 , 199 - 213 .",
    "genest , c. , masiello , e. and tribouley , k. ( 2009b ) , estimating copula densities through wavelets , insurance : mathematics and economics , 44 , 170 - 181 .",
    "genest , c. and segers , j. ( 2010 ) , on the covariance of the asymptotic empirical copula process , j. multivariate anal . ,",
    "101 , 1837 - 1845 .",
    "gijbels , i. and mielniczuk , j. ( 1990 ) , estimating the density of a copula function , comm .",
    "theory methods , 19 , 445 - 464 .",
    "gijbels , i. , omelka , m. and sznajder , d. ( 2010 ) , positive quadrant dependence tests for copulas , canad .",
    "j. statist .",
    ", 38 , 555 - 581 .",
    "gudendorf , g.  and segers , j.  ( 2012 ) , nonparametric estimation of multivariate extreme - value copulas , j. statist .",
    "inference , 142 , 3073 - 3085 .",
    "hall , p.  and neumeyer , n.  ( 2006 ) , estimating a bivariate density when there are extra data on one or both components , biometrika , 93 , 439 - 450 .",
    "hrdle , w.  and okhrin , o.  ( 2009 ) , de copulis non est disputandum  copulae : an overview , asta adv .",
    ", 94 , 1 - 31 .",
    "hjort , n.l .  and jones , m.c .",
    "( 1996 ) , locally parametric nonparametric density estimation , ann .",
    ", 24 , 1619 - 1647 .",
    "janssen , p. , swanepoel , j. and veraverbeke , n. ( 2013 ) , a note on the asymptotic behavior of the bernstein estimator of the copula density , j.  multivariate anal .",
    ", 124 , 480 - 487 .",
    "joe , h. , multivariate models and dependence concepts , chapman and hall , london , 1997 .",
    "jones , m.c .  and signorini , d.f .",
    "( 1997 ) , a comparison of higher - order bias kernel density estimators , j.   amer .",
    "statist .",
    ", 92 , 1063 - 1073 .",
    "kauermann , g. , schellhase , c.  and ruppert , d.  ( 2013 ) , flexible copula density estimation with penalized hierarchical b - splines , scand .",
    "j.  statist .",
    ", 40 , 685 - 705 .",
    "klugman , s. a.  and parsa , r.  ( 1999 ) , fitting bivariate loss distributions with copulas .",
    "insurance : mathematics and economics , 24 , 139 - 148 .",
    "lawlor , g.r .",
    "( 2012 ) , a lhospital rule for multivariable functions , _ manuscript _ ,",
    "li , b.  and genton , m.  ( 2013 ) , nonparametric identification of copula structures , j.   amer .",
    "statist .",
    "assoc . , 108 , 666 - 675 .",
    "loader , c.r .",
    "( 1996 ) , local likelihood density estimation , ann .",
    ", 24 , 1602 - 1618 .",
    "loader , c.r .",
    ", local regression and likelihood , springer , 1999 .",
    "lopez - paz , d. , hernndez - lobato , j.m .  and schlkopf , b.  ( 2013 ) , semi - supervised domain adaptation with non - parametric copulas ,",
    "_ manuscript_. mack , y.p .  and rosenblatt , m.  ( 1979 ) , multivariate @xmath216-nearest neighbor density estimates , j. multivariate anal .",
    ", 9 , 1 - 15 .",
    "marron , j.s .  and",
    "ruppert d.  ( 1994 ) , transformations to reduce boundary bias in kernel density estimation , j.  r.  stat .",
    "methodol . ,",
    "56 , 653 - 671 .",
    "nelsen , r.b .",
    ", an introduction to copulas , springer verlag , new york , 2006 .",
    "omelka , m. , gijbels , i. and veraverbeke , n. ( 2009 ) , improved kernel estimation of copulas : weak convergence and goodness - of - fit testing , ann .",
    ", 37 , 3023 - 3058 .",
    "qu , l.  and yin , w.  ( 2012 ) , copula density estimation by total variation penalized likelihood with linear equality constraints , comput . statist . data anal . , 56 , 384 - 398 .",
    "salmon , f. ( 2009 ) , recipe for disaster : the formula that killed wall street , wired magazine , february 23 2009 .",
    "scaillet , o.  ( 2007 ) , kernel - based goodness - of - fit tests for copulas with fixed smoothing parameters , j.  mutlivariate anal . , 98 , 533 - 543 .",
    "segers , j.  ( 2012 ) , asymptotics of empirical copula processes under non - restrictive smoothness assumptions , bernoulli , 18 , 764 - 782 .",
    "shen , x. , zhu , y. , song , l. ( 2008 ) , linear b - spline copulas with applications to nonparametric estimation of copulas , comput .",
    "statist . data anal .",
    ", 52 , 3806 - 3819 .",
    "sklar , a. ( 1959 ) , fonctions de rpartition  @xmath445 dimensions et leurs marges , publications de linstitut de statistique de luniversit de paris , 8 , 299 - 331 .",
    "tsukuhara , h. ( 2005 ) , semiparametric estimation in copula models , canad . j. statist . , 33 , 357 - 375 .",
    "wand , m.p . and jones , m.c . , kernel smoothing , chapman and hall , 1995 ."
  ],
  "abstract_text": [
    "<S> copula modelling has become ubiquitous in modern statistics . here , the problem of nonparametrically estimating a copula density is addressed . </S>",
    "<S> arguably the most popular nonparametric density estimator , the kernel estimator is not suitable for the unit - square - supported copula densities , mainly because it is heavily affected by boundary bias issues . </S>",
    "<S> in addition , most common copulas admit unbounded densities , and kernel methods are not consistent in that case . in this paper , </S>",
    "<S> a kernel - type copula density estimator is proposed . </S>",
    "<S> it is based on the idea of transforming the uniform marginals of the copula density into normal distributions via the probit function , estimating the density in the transformed domain , which can be accomplished without boundary problems , and obtaining an estimate of the copula density through back - transformation . </S>",
    "<S> although natural , a raw application of this procedure was , however , seen not to perform very well in the earlier literature . here , it is shown that , if combined with local likelihood density estimation methods , the idea yields very good and easy to implement estimators , fixing boundary issues in a natural way and able to cope with unbounded copula densities . </S>",
    "<S> the asymptotic properties of the suggested estimators are derived , and a practical way of selecting the crucially important smoothing parameters is devised </S>",
    "<S> . finally , extensive simulation studies and a real data analysis evidence their excellent performance compared to their main competitors .    * keywords : * copula density ; transformation kernel density estimator ; boundary bias ; unbounded density ; local likelihood density estimation . </S>"
  ]
}