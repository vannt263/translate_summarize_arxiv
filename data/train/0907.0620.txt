{
  "article_text": [
    "[ def : numsys ] a _ positional numeration system _ is given by a ( strictly ) increasing sequence @xmath3 of integers such that @xmath4 and @xmath5 is finite .",
    "let @xmath6 .",
    "the _ greedy @xmath7-representation _ of a positive integer @xmath8 is the unique finite word @xmath9 over @xmath10 satisfying @xmath11 we set @xmath12 to be the empty word @xmath13 . a set @xmath14 of integers is _",
    "@xmath7-recognizable _ if the language @xmath15 over @xmath10 is regular ( i.e. , accepted by a deterministic finite automaton , dfa ) .",
    "if @xmath16 is a word over a finite alphabet of integers , then the _ @xmath7-numerical value _ of @xmath17 is @xmath18    let @xmath19 be two words over @xmath10 . as a consequence of the greediness of the representation , if @xmath20 is a greedy @xmath7-representation and if the leftmost letter of @xmath21 is not @xmath22 , then @xmath21 is also a greedy @xmath7-representation .",
    "notice that for @xmath23 , we have @xmath24 if and only if @xmath25 where @xmath26 is the genealogical ordering over @xmath27 : words are ordered by increasing length and for words of same length , one uses the lexicographical ordering induced by the natural ordering of the digits in the alphabet @xmath10 .",
    "recall that for two words @xmath28 of same length , @xmath17 is lexicographically smaller than @xmath21 if there exist @xmath29 and @xmath30 such that @xmath31 , @xmath32 and @xmath33 .    for a positional numeration system @xmath7 ,",
    "it is natural to expect that @xmath34 is @xmath7-recognizable .",
    "a necessary condition is that the sequence @xmath7 satisfies a linear recurrence relation @xcite .    a positional numeration system @xmath3 is said to be _ linear _ , if the sequence @xmath7 satisfies a homogenous linear recurrence relation with integer coefficients .",
    "otherwise stated , there exist @xmath35 and constant coefficients @xmath36 such that for all @xmath37 , we have @xmath38 we say that @xmath39 is the _ order _ of the recurrence relation .",
    "consider the sequence defined by @xmath40 , @xmath41 and for all @xmath37 , @xmath42 .",
    "the _ fibonacci ( linear numeration ) system _ is given by @xmath43 .",
    "for instance , @xmath44 and @xmath45 .    in this paper , we mainly address the following decidability question and its extension to abstract numeration systems .",
    "[ pb ] given a linear numeration system @xmath7 and a set @xmath14 such that @xmath46 and @xmath15 are both recognized by ( deterministic ) finite automata .",
    "is it decidable whether or not @xmath2 is ultimately periodic , i.e. , whether or not @xmath2 is a finite union of arithmetic progressions ?",
    "notice that the regularity of @xmath46 ensures that there exists a set @xmath14 such that @xmath15 is regular , see also remark  [ rem : nurec ] .",
    "ultimately periodic sets of integers play a special role .",
    "on the one hand such infinite sets are coded by a finite amount of information . on the other hand",
    "the celebrated cobham s theorem asserts that these sets are the only sets that are recognizable in all integer base systems @xcite .",
    "this is the reason why they are also referred in the literature as _ recognizable _ sets of integers ( the recognizability being in that case independent of the base ) .",
    "moreover , cobham s theorem has been extended to various situations and in particular , to numeration systems given by substitutions @xcite .",
    "if we restrict ourselves to the usual integer base @xmath47 numeration system , referred to in the sequel as _ @xmath48-ary system _ , defined by @xmath49 for @xmath50 and @xmath4 , several results are known .",
    "j.  honkala showed in @xcite that problem  [ pb ] turns out to be decidable .",
    "let us also mention @xcite , where the number of states of the minimal automaton accepting numbers written in base @xmath48 and divisible by @xmath51 is given explicitly . j .-",
    "allouche and j.  shallit ask in @xcite if one can obtain a polynomial time decision procedure for @xmath48-ary systems . using the logic formalism of the presburger arithmetic , a positive answer to this question",
    "is given by j.  leroux in @xcite even when considering subsets of @xmath52 , @xmath53 . in dimension one , ultimately periodic sets are exactly the sets definable in the presburger arithmetic @xmath54 .    note that a.  muchnik has shown that problem  [ pb ] turns out to be decidable for any linear numeration system @xmath7 for which both @xmath46 and addition are recognizable by automata @xcite .",
    "but it is a difficult question to characterize numeration systems @xmath7 for which addition is _",
    "computable by finite automaton _ ,",
    "i.e. , for which the language @xmath55 where leading zeroes are prefixed for padding the shorter components to obtain three words of the same length , is regular ( see for instance @xcite in which the characteristic polynomial of the sequence @xmath7 is the minimal polynomial of a pisot number ) . in @xcite , the sequentiality of the successor function ( i.e.",
    ", the action of adding @xmath1 ) is studied . if addition is computable by a finite automaton , so is the successor function , but the converse does not hold in general . in particular , some examples of linear numeration systems for which addition is not computable by a finite automaton are given in @xcite : for instance , the sequence defined by @xmath56 with integer initial conditions @xmath57 .",
    "so the decision techniques from @xcite can not be applied to that system .",
    "nevertheless , as we will see in example  [ exa : aaa ] , our decision procedure can be applied to this system .",
    "notice also that in the extended framework of abstract numeration systems , one can exhibit systems such that multiplication by a constant does not preserve recognizability @xcite .",
    "therefore the powerful tools from logic discussed above can not be applied in that context either .",
    "the question studied in this paper was raised by j.  sakarovitch during the `` _ journes de numration _ '' in graz , may 2007 . the question was initially asked for a larger class of systems than the one treated here , namely for any abstract numeration systems defined on an infinite regular language @xcite . a shorter and partial version of this paper has been presented to the 33rd mfcs symposium in toru , august 2008 @xcite .",
    "observe that this decision problem for all abstract numeration systems is equivalent to the famous _",
    "periodicity problem _ : given a morphism @xmath58 and a coding @xmath59 , decide if the infinite word @xmath60 is ultimately periodic , see @xcite . for the restricted case of the _ d0l periodicity problem _",
    ", where only the morphism @xmath58 is considered , decision procedures are well - known @xcite . finally , questions connected to the ones addressed here have independently and recently gained interest @xcite . in particular , a simple proof of honkala s original result based on the construction of some automata is given in that paper .",
    "as for the logical approach considered by muchnik and leroux , the arguments given in @xcite rely on the recognizability of addition by automata ( which can be done for the classical @xmath39-ary system but not necessarily for an arbitrary linear numeration system ) .",
    "the structure of this paper is the same as @xcite .",
    "first we give an upper bound on the admissible periods of a @xmath7-recognizable set @xmath2 when it is assumed to be ultimately periodic .",
    "then an upper bound on the admissible preperiods is obtained .",
    "these bounds depend essentially on the number of states of the ( minimal ) automaton recognizing @xmath15 .",
    "finally , finitely many such periods and preperiods have to be checked . for each of them",
    ", we have to build an automaton accepting the corresponding ultimately periodic sets ( this implies that @xmath34 has to be recognizable ) .",
    "though the structure is the same , our arguments and techniques are quite different from @xcite .",
    "they rely on the study of the quantity @xmath61 defined as the number of residue classes that appear infinitely often in the sequence @xmath62 .",
    "our main result  theorem  [ the : finfin ]  can be stated as follows",
    ".    * theorem .",
    "* let @xmath3 be a linear numeration system such that @xmath34 is @xmath7-recognizable and satisfying @xmath63 . if @xmath64 , then problem  [ pb ] is decidable .    actually our techniques can not be applied to @xmath48-ary systems ( see remark  [ rem : notint ] ) , which is the case treated by honkala @xcite , because in that case @xmath65 as @xmath66 .    in section  [ sec : lrrc ] , we give a characterization of the linear numeration systems @xmath7 such that @xmath64 .",
    "to do so we use @xmath67-adic methods leading to a study of the sequence @xmath68 for all @xmath69 , where @xmath67 is a prime dividing @xmath70 .    in the last section ,",
    "we consider again the same decision problem but restated in the framework of abstract numeration systems @xcite . the definition of these systems is given in section  [ sec : last ] .",
    "we apply successfully the same kind of techniques to a large class of abstract numeration systems ( for instance , an example consisting of two copies of the fibonacci system is considered ) .",
    "the corresponding decision procedure is given by theorem  [ the : ans ] .",
    "as explained above , this result provides a decision procedure for specific instances of the hd0l periodicity problem .    all along the paper",
    ", we try whenever it is possible to state results in their most general form , even if later on we have to restrict ourselves to particular cases . for instance , results about the admissible preperiods do not require any particular assumption on the numeration system except linearity .",
    "we will often consider positional numeration systems @xmath3 satisfying the following condition : @xmath71 notice that it is a weak requirement . usually , the sequence @xmath7 has an exponential growth , @xmath72 for some @xmath73 , and therefore is trivially satisfied .",
    "( it is for instance the case for the numeration systems considered in remark  [ rem : exxx ] . )",
    "[ lem : condlim ] let @xmath3 be a positional numeration system satisfying .",
    "then for all @xmath74 , there exists @xmath75 such that for all @xmath76 , @xmath77 are greedy @xmath7-representations . otherwise stated ,",
    "if @xmath78 is a greedy @xmath7-representation , then for @xmath79 large enough , @xmath80 is also a greedy @xmath7-representation .",
    "notice that @xmath81 is the greatest word of length @xmath74 in @xmath46 , since @xmath82 . by hypothesis",
    ", there exists @xmath75 such that for all @xmath83 @xmath84 .",
    "therefore , for all @xmath83 @xmath85 is the greedy @xmath7-representation of @xmath86 and the conclusion follows .",
    "consider the positional numeration system @xmath4 , @xmath87 , @xmath88 and @xmath89 for all @xmath50 and @xmath90 .",
    "this system does not satisfy because @xmath91 for infinitely many @xmath92 s .",
    "we have @xmath93 , but one can notice that for @xmath37 , @xmath94 is not a greedy @xmath7-representation .",
    "indeed , @xmath95 has @xmath96 as greedy @xmath7-representation .    in the above lemma",
    ", one can not exchange the order of the quantifiers about @xmath74 and @xmath75 . as an example , consider the sequence @xmath97 for all @xmath37 .",
    "this sequence satisfies the linear recurrence relation @xmath98 and also .",
    "observe that , for all @xmath50 , @xmath99 is the unique value such that @xmath100 because for all @xmath101 , @xmath102 . for all @xmath50",
    ", @xmath103 is a greedy @xmath7-representation and the greedy @xmath7-representations of the form @xmath104 are exactly those for which @xmath105 .",
    "bertrand numeration systems associated with a real number @xmath73 are defined as follows .",
    "let @xmath106 .",
    "any @xmath107 $ ] can be written as @xmath108 and the sequence @xmath109 is said to be a _",
    "@xmath110-representation _ of @xmath17 .",
    "the maximal @xmath110-representation of @xmath17 for the lexicographical order is denoted @xmath111 and is called the _",
    "@xmath110-development _ of @xmath17 ( for details see ( * ? ? ?",
    "we say that a @xmath110-development @xmath112 is _ finite _ if there exists @xmath113 such that @xmath114 for all @xmath115 .",
    "if there exists @xmath116 such that @xmath117 with @xmath118 , we set @xmath119 , otherwise @xmath120 is infinite and we set @xmath121 .",
    "we can now define a positional numeration system @xmath122 associated with @xmath110 ( see @xcite ) . if @xmath123 , then @xmath124 if @xmath110 is a parry number ( i.e. , @xmath120 is finite or ultimately periodic ) then one can derive from that the sequence @xmath125 satisfies a linear recurrence relation and as a consequence of bertrand s theorem @xcite linking greedy @xmath125-representations and finite factors occurring in @xmath110-developments , the language @xmath126 of the greedy @xmath125-representations is regular .",
    "the automaton accepting these representations is well - known @xcite and has a special form ( all states  except for a sink  are final and from all these states , an edge of label @xmath22 goes back to the initial state ) .",
    "we therefore have the following property which is much stronger than the previous lemma .",
    "if @xmath17 and @xmath21 are greedy @xmath125-representations then @xmath127 is also a greedy @xmath125-representation .",
    "the fibonacci system is the bertrand system associated with the golden ratio @xmath128 . since greedy representations in the fibonacci system are the words not containing two consecutive @xmath1 s @xcite , then for @xmath129 , we have @xmath130 .",
    "let @xmath14 be a set of integers .",
    "characteristic word of @xmath2 _ is an infinite word @xmath131 over @xmath0 defined by @xmath132 if and only if @xmath133 .",
    "consider for now @xmath14 to be an ultimately periodic set .",
    "the characteristic word of @xmath2 is therefore an infinite word over @xmath0 of the form @xmath134 where @xmath135 and @xmath136 are chosen of minimal length .",
    "we say that the length @xmath137 of @xmath135 ( resp .",
    "the length @xmath138 of @xmath136 ) is the _ preperiod _ ( resp .",
    "_ period _ ) of @xmath2 .",
    "hence , for all @xmath139 , @xmath140 if and only if @xmath141 .",
    "the following lemma is a simple consequence of the minimality of the period chosen to represent an ultimately periodic set .",
    "[ lem : per ] let @xmath14 be an ultimately periodic set of period @xmath142 and preperiod @xmath143 .",
    "let @xmath144 . if @xmath145 then there exists @xmath146 such that either @xmath147 and @xmath148 or , @xmath149 and @xmath150 .",
    "we assume that the reader is familiar with automata theory ( see for instance @xcite ) but let us recall some classical results .",
    "let @xmath151 be a language over a finite alphabet @xmath152 and @xmath17 be a finite word over @xmath152 .",
    "we set @xmath153 we can now define the myhill - nerode congruence . let @xmath154 .",
    "we have @xmath155 if and only if @xmath156 .",
    "moreover @xmath75 is regular if and only if @xmath157 has a finite index being the number of states of the minimal automaton of @xmath75 .    for a sequence @xmath158 of integers",
    ", @xmath159 denotes the number of values that are taken infinitely often by the sequence @xmath160 .",
    "[ pro:1 ] let @xmath3 be a positional numeration system satisfying .",
    "if @xmath14 is an ultimately periodic @xmath7-recognizable set of period @xmath142 , then any deterministic finite automaton accepting @xmath15 has at least @xmath161 states .",
    "let @xmath143 be the preperiod of @xmath2 .",
    "by lemma  [ lem : condlim ] , there exists @xmath75 such that for any @xmath162 , the words @xmath163 are greedy @xmath7-representations .",
    "the sequence @xmath164 takes infinitely often @xmath165 different values .",
    "let @xmath166 be such that @xmath167 and @xmath168 can be chosen such that @xmath169 for all @xmath170 .    by lemma  [ lem : per ] , for all @xmath171 such that @xmath172 , there exists @xmath173 such that either @xmath174 and @xmath175 , or @xmath176 and @xmath177 .",
    "therefore , @xmath178 is a word such that either @xmath179 or @xmath180 therefore the words @xmath181 are pairwise nonequivalent for the relation @xmath182 and the minimal automaton of @xmath15 has at least @xmath183 states .",
    "the previous proposition has an immediate consequence for getting a bound on the period of a periodic set accepted by a given dfa .",
    "[ cor:2 ] let @xmath3 be a positional numeration system satisfying .",
    "assume that @xmath184 then the period of an ultimately periodic set @xmath14 such that @xmath15 is accepted by a dfa with @xmath51 states is bounded by the smallest integer @xmath185 such that for all @xmath186 , @xmath187",
    ".    a result similar to the previous corollary ( in the sense that it permits to give an upper bound on the period ) can be stated as follows .",
    "this result will be used later on in our decision procedure to compute some explicit estimate .",
    "[ pro : alternative ] let @xmath3 be a positional numeration system satisfying and @xmath14 be an ultimately periodic @xmath7-recognizable set of period @xmath142 .",
    "let @xmath188 be a divisor of @xmath142 .",
    "if @xmath1 occurs infinitely many times in @xmath189 then any deterministic finite automaton accepting @xmath15 has at least @xmath188 states .",
    "let @xmath143 be the preperiod of @xmath2 .",
    "applying several times lemma  [ lem : condlim ] , there exist @xmath190 such that @xmath191 are greedy @xmath7-representations .",
    "moreover , since @xmath1 occurs infinitely many times in the sequence @xmath189 , @xmath190 can be chosen such that , for all @xmath192 , @xmath193 and @xmath194 for @xmath195 , @xmath172 , by lemma  [ lem : per ] and since @xmath188 divides @xmath142 , the words @xmath196 are nonequivalent for @xmath182 .",
    "this can be shown by concatenating some word of the kind @xmath197 with @xmath146 , as in the proof of proposition  [ pro:1 ] .",
    "this concludes the proof .    for a sequence @xmath198 of integers ,",
    "if @xmath62 is ultimately periodic , we denote its ( minimal ) preperiod by @xmath199 ( we choose the notation @xmath200 to allude to the word index which is equally used as preperiod ) and its ( minimal ) period by @xmath201 .    [",
    "rem : nupiu ] observe that for any linear recurrence sequence of order @xmath39 satisfying , we have @xmath202 therefore , @xmath203 if and only if @xmath204 . notice that if @xmath205 with @xmath206 , then @xmath207 .",
    "now we want to obtain an upper bound on the preperiod of any ultimately periodic @xmath7-recognizable set recognized by a given dfa .",
    "[ pro : preper ] let @xmath3 be a linear numeration system .",
    "let @xmath14 be an ultimately periodic @xmath7-recognizable set of period @xmath142 and preperiod @xmath143 .",
    "then any deterministic finite automaton accepting @xmath15 has at least @xmath208 states .",
    "the arguments of the following proof are similar to the one found in @xcite .",
    "we can assume that @xmath209 .",
    "the sequence @xmath210 is ultimately periodic with preperiod @xmath211 and period @xmath212 .",
    "proceed by contradiction and assume that @xmath213 is a deterministic finite automaton with less than @xmath208 states accepting @xmath15 .",
    "there exist words @xmath214 such that the greedy @xmath7-representation of @xmath215 can be factorized as @xmath216 with @xmath217 . by the pumping lemma",
    ", @xmath78 can be written @xmath218 with @xmath219 and for all @xmath37 , @xmath220 by minimality of @xmath143 and @xmath142 , either @xmath221 and for all @xmath222 , @xmath223 , or @xmath224 and for all @xmath222 , @xmath225 . using the ultimate periodicity of @xmath164",
    ", we observe that , because @xmath226 , for all @xmath37 , we have @xmath227 therefore repeating a factor of length multiple of @xmath212 exactly @xmath142 times does not change the value mod @xmath142 and we get @xmath228 leading to a contradiction .    for the sake of completeness , we restate some well - known properties of ultimately periodic sets ( see for instance @xcite for a prologue on pascal s machine for @xmath48-ary systems ) .",
    "[ lem : upu ] let @xmath229 be nonnegative integers and @xmath3 be a linear numeration system .",
    "the language @xmath230 is regular .",
    "in particular , if @xmath34 is @xmath7-recognizable then a dfa accepting @xmath231 can be obtained efficiently and any ultimately periodic set is @xmath7-recognizable .    before giving the proof , notice that for any integer @xmath232 , @xmath233 is a finite set of words @xmath234 over @xmath10 such that @xmath235 for all @xmath236 .",
    "this set contains in particular @xmath237 .",
    "since regular sets are stable under finite modification ( i.e. , adding or removing a finite number of words in the language ) , we can assume that @xmath238 .",
    "the sequence @xmath239 is ultimately periodic with preperiod @xmath240 and period @xmath241 .",
    "it is an easy exercise to build a deterministic finite automaton @xmath213 accepting the reversal of the words in @xmath242 .",
    "the alphabet of the automaton is @xmath10 .",
    "states are pairs @xmath243 where @xmath244 and @xmath245 .",
    "the initial state is @xmath246 .",
    "final states are the ones with the first component equal to @xmath48 .",
    "transitions are defined as follows @xmath247 @xmath248 for all @xmath249 .",
    "notice that @xmath213 does not check the greediness of the accepted words , the construction only relies on the @xmath7-numerical value of the words modulo @xmath250 .    for the particular case , one has to consider the intersection of two regular languages @xmath251 .",
    "[ rem : nurec ] in the previous statement , the assumption about the @xmath7-recognizability of @xmath34 is of particular interest .",
    "indeed , it is well - known that for an arbitrary linear numeration system , @xmath34 is in general _ not _ @xmath7-recognizable .",
    "if @xmath34 is @xmath7-recognizable , then @xmath7 satisfies a linear recurrence relation @xcite , but the converse does not hold .",
    "sufficient conditions on the recurrence relation that @xmath7 satisfies for @xmath34 to be @xmath7-recognizable are given in @xcite .",
    "our decision procedure will also make use of the following result .",
    "[ lem : equiv ] let @xmath3 be an increasing sequence satisfying a linear recurrence relation of order @xmath39 of the kind .",
    "the following assertions are equivalent :    * @xmath64 * for all prime divisors @xmath67 of @xmath70 , @xmath252 .    in particular , if @xmath253 , then @xmath64 .",
    "it is enough to show that ( ii ) implies ( i ) .",
    "let the prime decomposition of @xmath254 be @xmath255 with @xmath256 .",
    "it is obvious that if @xmath257 with @xmath258 and @xmath259 then @xmath260 notice that @xmath261 tends to infinity if and only if at least one of the @xmath262 s or @xmath188 tends to infinity .",
    "assume first that for some @xmath263 , @xmath264 .",
    "by assumption we have that @xmath265 and by remark  [ rem : nupiu ] , we get that @xmath266 .",
    "therefore @xmath201 takes values larger than any constant by considering an integer @xmath261 which is divisible by a sufficiently large power of @xmath267 . again using remark  [ rem : nupiu ]",
    ", the same conclusion holds for @xmath61 .",
    "let @xmath268 be the set of natural numbers prime to @xmath70 . for all @xmath269 , the sequence @xmath189 is ultimately periodic but it is even purely periodic .",
    "indeed , for all @xmath37 , @xmath270 is determined by the @xmath39 previous terms @xmath271 .",
    "but since @xmath259 , @xmath70 is invertible modulo @xmath188 and for all @xmath37 , @xmath272 is also determined by the @xmath39 following terms @xmath273 . by definition of @xmath274 ,",
    "the sequence @xmath189 takes exactly @xmath274 different values because any term appears infinitely often .",
    "let @xmath275 be the function mapping @xmath276 onto the smallest index @xmath277 such that @xmath278 . since @xmath7 is increasing , @xmath275 is non - decreasing and @xmath279 . from this last observation and from the pure periodicity of @xmath280",
    ", it follows that for all @xmath269 , @xmath281 because @xmath282 .",
    "consequently , we get @xmath283    any large enough integer @xmath261 contains either a large power of some @xmath267 or some large @xmath188 prime to @xmath70 and consequently ( i ) holds .    [ the : finfin ] let @xmath3 be a linear numeration system such that @xmath34 is @xmath7-recognizable , satisfying condition .",
    "assume that @xmath184 then it is decidable whether or not a @xmath7-recognizable set is ultimately periodic .",
    "the sequence @xmath7 satisfies a recurrence relation of order @xmath39 of the kind .",
    "let the prime decomposition of @xmath254 be @xmath284 with @xmath256 .",
    "consider a dfa @xmath213 with @xmath51 states accepting a @xmath7-recognizable set @xmath14 .",
    "assume that @xmath2 is ultimately periodic with a period @xmath285 where @xmath259 and @xmath286 .",
    "since @xmath259 , with the same reasoning as in the proof of the previous lemma , the sequence @xmath189 is purely periodic . therefore , @xmath4 appears infinitely often in @xmath287 .",
    "since @xmath188 is a divisor of @xmath142 , we can use proposition  [ pro : alternative ] and get @xmath288 .    by proposition  [ pro:1 ] ,",
    "we get @xmath289 .",
    "let @xmath263 .",
    "using remark  [ rem : nupiu ] , we obtain @xmath290 the assumption @xmath64 implies that @xmath291 .",
    "observe that @xmath292 whenever @xmath293 .",
    "consequently the exponent @xmath262 occurring in the decomposition of @xmath142 is bounded by @xmath294 where @xmath294 is the smallest integer such that for all @xmath295 , @xmath296 .",
    "this bound @xmath294 can be effectively computed as follows . for any @xmath136",
    ", @xmath297 can be found in a finite number of operations by inspecting the first values of @xmath298 and looking for two identical @xmath39-tuples made of @xmath39 consecutive elements . once the period is determined",
    ", one immediately gets the values that are repeated infinitely often .",
    "since the map @xmath299 is non - decreasing , one has to compute @xmath300 until finding the first value @xmath294 such that @xmath301 .",
    "if @xmath2 is ultimately periodic , then the admissible periods are bounded by the constant @xmath302 which is effectively computable .",
    "then , using proposition  [ pro : preper ] , the admissible preperiods @xmath143 must satisfy @xmath303 where @xmath304 whenever @xmath305 .",
    "this last observation shows that a bound on the admissible preperiods of @xmath2 can be given effectively .",
    "consequently the sets of admissible preperiods and periods that we have to check are finite . for each pair @xmath306 of admissible preperiods and periods ,",
    "there are at most @xmath307 distinct ultimately periodic sets .",
    "thanks to lemma  [ lem : upu ] , one can build an automaton for each of them and then compare the language @xmath75 accepted by this automaton with @xmath15 . recall that testing whether @xmath308 and @xmath309 is decidable algorithmically .",
    "in view of the previous result , it is natural to characterize linear recurrence sequences @xmath7 such that @xmath64 .",
    "it is exactly the aim of section  [ sec : lrrc ] .",
    "for instance , we have the immediate special case that was treated in @xcite .",
    "[ the : the ] let @xmath3 be a linear numeration system such that @xmath34 is @xmath7-recognizable and satisfying a recurrence relation of order @xmath39 of the kind with @xmath310 and condition . it is decidable whether or not a @xmath7-recognizable set is ultimately periodic .",
    "it is enough to observe that if @xmath253 , then @xmath64 , see lemma  [ lem : equiv ] .    let @xmath311 be irrational , with simple continued fraction @xmath312 $ ] , that is , @xmath313 @xmath314 , where @xmath315 for all @xmath50 .",
    "the numerators of its even - indexed convergents are given by the recurrence @xmath316 @xmath314 with initial conditions @xmath317 , @xmath4 .",
    "it was shown in @xcite that every positive integer @xmath8 has a unique representation of the form @xmath318 , where the digits satisfy @xmath319 , and the additional condition : if for some @xmath320 the digits @xmath321 and @xmath322 attain their maximum values , then there exists @xmath74 satisfying @xmath323 such that @xmath324 .",
    "it was recently employed in @xcite , where it was dubbed @xmath325-sequences .",
    "the special case @xmath326 for all @xmath50 is an exotic ternary numeration system since then @xmath327 .",
    "the additional condition then states that between any two digits @xmath328 there must be a digit @xmath22 .",
    "also @xmath329 is the golden ratio and the @xmath330 are the even - indexed fibonacci numbers .",
    "this special case was used to investigate irregularities of distribution of sequences @xcite , @xcite . in @xcite",
    "it was used to compress sparse bit - strings , in @xcite for answering a combinatorial question raised in @xcite , and in @xcite for providing a polynomial - time algorithm for combinatorial games .",
    "for all these numeration systems problem  [ pb ] is decidable , since the coefficient of @xmath331 is @xmath332 .",
    "the same conclusion holds for the numeration system based on the denominators of the even convergents , also given in @xcite .",
    "[ rem : notint ] we have thus obtained a decision procedure for our problem  [ pb ] when @xmath64 and in particular when the coefficient @xmath70 occurring in is equal to @xmath333 . on the other hand ,",
    "whenever @xmath334 , for all @xmath222 and for all @xmath92 large enough , we have @xmath335 and the assumption about @xmath61 in theorem  [ the : finfin ] does not hold .",
    "indeed , the only value taken infinitely often by the sequence @xmath336 is @xmath22 , so @xmath61 equals @xmath1 for infinitely many values of @xmath261 .",
    "notice in particular , that the same observation can be made for the usual @xmath48-ary system ( @xmath47 ) where the only value taken infinitely often by the sequence @xmath337 is @xmath22 , for all @xmath222 .    to conclude this section",
    ", we make a small digression .",
    "we show how to use a result of engstrom about preperiods @xcite to get some special linear numeration systems where @xmath64 . in engstrom",
    "s paper the problem of finding a general period for a given recurrence relation modulo @xmath261 for _ any _ initial conditions is considered .",
    "notice that in @xcite , m.  ward considers the problem where the initial conditions are fixed and then the period modulo @xmath261 has to be determined .",
    "* theorem 9)[the : eng ] let @xmath3 be a linear recurrence sequence of order @xmath39 of the kind and @xmath67 be a prime divisor of @xmath70 . if there exists @xmath338 such that @xmath339 and @xmath340 , then @xmath341 .",
    "[ rem : exxx ] assume that we are dealing with a linear numeration system @xmath3 satisfying and that the assumptions of the previous theorem hold for all prime divisors @xmath67 of @xmath70 ( which is equivalent to the fact that @xmath342 ) .",
    "let @xmath343 be the characteristic polynomial of @xmath7 as defined in .",
    "assume that @xmath73 is a root of multiplicity @xmath344 of @xmath343 satisfying :    * for any other root @xmath345 of @xmath343 , @xmath346 , * @xmath347 for all prime divisors @xmath67 of @xmath70 .",
    "there exists some constant @xmath188 such that @xmath348 .",
    "let @xmath67 be a prime divisor of @xmath70 and @xmath349 be the largest index @xmath74 such that @xmath350 .",
    "let @xmath351 be a real number such that @xmath352 .",
    "for @xmath136 large enough , we have @xmath353 .",
    "consequently , for @xmath136 large enough , @xmath354 . from the previous theorem , we have @xmath341 . therefore for @xmath136 large enough , @xmath355 are the first terms of the periodic part of @xmath68 and @xmath356 .",
    "this means that for all prime divisors @xmath67 of @xmath70 , @xmath357 as @xmath358 .",
    "therefore , by lemma  [ lem : equiv ] , @xmath64 and we can apply our decision procedure given by theorem  [ the : finfin ] ( whenever @xmath34 is @xmath7-recognizable ) .",
    "consider the linear recurrence sequence given by @xmath359 for @xmath360 and @xmath361 for @xmath362 .",
    "the first terms of the sequence are @xmath363 with the above notation , @xmath364 and the other two complex roots have modulus close to @xmath365 .",
    "we also have @xmath366 .",
    "thanks to theorem  [ the : eng ] , the preperiod @xmath367 is bounded by @xmath136 . on the other hand , we have @xmath368 for some @xmath369 . notice that @xmath370 .",
    "therefore for @xmath136 large enough , @xmath371 . consequently ,",
    "the elements @xmath372 appear in the periodic part . in the following table",
    ", these elements have been underlined .",
    "as was observed in remark  [ rem : notint ] , since our approach to solve the decision problem is requiring that @xmath64 , it can only be applied to linear recurrence sequences for which @xmath342 . in this section ,",
    "our aim is to determine which linear recurrence sequences @xmath7 are such that @xmath64 . to that end",
    ", it is clear ( see lemma  [ lem : equiv ] ) that we have only to focus on the behavior of @xmath374 for any prime @xmath67 dividing @xmath70 .    throughout this section",
    "we let @xmath198 be a linear recurrence sequence satisfying .",
    "we assume that @xmath198 satisfies no recurrence of smaller order than @xmath39 .",
    "it is well - known ( this result is sometimes referred as kronecker s theorem , see @xcite ) that under the assumption @xmath375 , this is equivalent to assume that @xmath376    let @xmath67 be a prime number .",
    "we recap some background on the @xmath67-adic numbers ( see for instance @xcite ) .",
    "we can put an absolute value @xmath377 on @xmath378 as follows . for each integer @xmath379 , we can write @xmath380 with @xmath325 such that @xmath381 . we define @xmath382 and @xmath383 .",
    "we note that this absolute value extends on @xmath384 by declaring @xmath385 for @xmath386 , @xmath387 .",
    "in particular , for all @xmath388 , @xmath389 . note that this absolute value is _ non - archimedian _ ; that is , it satisfies for all @xmath388 @xmath390 if we complete @xmath384 with respect to this absolute value , we obtain the field of @xmath67-_adic rationals _ , which we denote by @xmath391 .",
    "we can take the algebraic closure of @xmath391 ; the absolute value @xmath377 extends to this algebraic closure .",
    "the algebraic closure is not complete , however . completing this algebraic closure , we obtain a complete algebraically closed field @xmath392 with absolute value @xmath377 , which restricts to the @xmath67-adic absolute value on @xmath384 . the closed unit ball @xmath393 is called the set of @xmath67-_adic integers _ and we denote it by @xmath394 .",
    "the ordinary integers are dense in @xmath394 .",
    "the @xmath67-adic rationals can be viewed as the formal expressions of the form @xmath395 where @xmath396 , @xmath397 .",
    "the @xmath67-adic integers are identified with formal expressions involving only non - negative powers of @xmath67 .",
    "we let @xmath398 be the characteristic polynomial of @xmath198 and @xmath399 for @xmath375 , observe that if @xmath400 are the roots of @xmath401 , then the reciprocals @xmath402 are exactly the roots of @xmath403 .",
    "[ rem : rat ] if @xmath404 satisfies with initial conditions @xmath405 , then the ordinary power series generating function is a rational function : @xmath406 the converse also holds . the sequence of taylor coefficients of any rational function @xmath407 where @xmath408 is a polynomial of degree less than @xmath39 , satisfies .",
    "see for instance @xcite .",
    "our goal is to prove the following result .",
    "notice that similar developments can be found in @xcite .",
    "[ the : jason ] we have @xmath409 as @xmath410 if and only if @xmath411 with @xmath412 $ ] such that :    1 .",
    "@xmath413)$ ] ; 2 .",
    "@xmath414 has no repeated roots and all its roots are roots of unity .    in that case , we have moreover @xmath415 .",
    "we note that one direction is fairly simple .",
    "assume that @xmath416 has such a factorization @xmath411 . from ( ii )",
    ", there is a natural number @xmath51 such that @xmath417 . in view of remark  [ rem : rat ] , there exist some polynomials @xmath418 such that @xmath419 by assumption ( i ) , there exists some integer polynomial @xmath420 such that @xmath421 .",
    "hence @xmath422 in particular , for any fixed integer @xmath136 , @xmath423 is congruent to a polynomial ( mod @xmath424 ) .",
    "this means that @xmath425 for all @xmath92 sufficiently large . in particular , there are at most @xmath51 values which can occur infinitely often mod @xmath424 ; that is , @xmath426 for every @xmath136 .    .25 cm    to do the other direction is a little more work and we use @xmath67-adic methods .",
    "we first note that @xmath427 is a non - decreasing function , i.e. , @xmath428 in particular , if @xmath429 then there is some @xmath51 such that @xmath430 for all @xmath136 sufficiently large",
    ". we can pick integers @xmath431 such that if @xmath432 for infinitely many @xmath92 , then @xmath433 for some @xmath434 .",
    "since @xmath435 for @xmath436 , there is no loss of generality to assume that @xmath437 for @xmath436 , @xmath438 .",
    "it follows that for @xmath438 the sequence @xmath439 is cauchy in @xmath394 . thus there",
    "exist @xmath440 such that for @xmath438 , @xmath441 let @xmath442 note that since the set of linear recurrence sequences is closed under ( hadamard ) product , sum , and scalar multiplication ( see for instance @xcite ) , the sequence @xmath443 satisfies a linear recurrence over @xmath394 . by construction",
    ", @xmath444 is eventually in @xmath445 for any fixed @xmath136 , since any values of @xmath446 that are not congruent to one of @xmath447 mod @xmath424 can only occur finitely many times .",
    "that is for any @xmath136 , @xmath448 for @xmath92 sufficiently large .",
    "hence @xmath449 as @xmath450 .",
    "since @xmath443 satisfies a linear recurrence , the power series @xmath451 is a rational power series in @xmath452 .",
    "moreover , @xmath453 converges on the closed unit disc @xmath394 , since @xmath449 ( in non - archimedian fields this is enough to guarantee convergence : a series @xmath454 converges in @xmath391 if and only if @xmath455 ) .",
    "since @xmath453 is a rational series and it converges on the unit disc , its poles @xmath456 must satisfy @xmath457 , for @xmath458 .    to finish the proof ,",
    "we will make use of lemma  [ lem : free ] stated below .",
    "for the sake of clarity , we have separated this technical result from this proof .",
    "we note that the statement of this lemma is very close to what we already have , but it makes the additional assumption that the poles of @xmath459 generate a free abelian subgroup . in general , the poles of @xmath459 generate a finitely generated abelian subgroup of @xmath460 . from the so - called _ fundamental theorem of",
    "finitely generated abelian groups _",
    "( see for instance @xcite ) , this group is isomorphic to @xmath461 , for some finite abelian group @xmath462 and integer @xmath463 .",
    "let us show how to get rid of the torsion group @xmath462 to be able to invoke lemma  [ lem : free ] .",
    "let @xmath464 . for @xmath238 , instead of taking the sequence @xmath198",
    ", consider the sequence @xmath465 .",
    "this latter sequence satisfies a linear recurrence and the poles of the generating function @xmath466 of @xmath467 are the @xmath250th powers where the @xmath468 s are polynomials in @xmath469 $ ] and the @xmath470 s are the roots of the characteristic polynomial of @xmath198 , i.e. , the reciprocals of the poles of @xmath459 , then we obtain that @xmath471 .",
    "hence the poles of @xmath472 are the @xmath250th powers of the poles of @xmath459 .",
    "] of the poles of @xmath459 .",
    "consequently , the poles of @xmath473 generate a finitely generated torsion - free abelian group , which is necessarily a free abelian group .    since the poles @xmath474 of @xmath475 satisfy @xmath457 , for @xmath476 , with the same reasoning",
    ", we get that the poles of the rational function @xmath477 are @xmath250th powers of @xmath478 and for @xmath476 , @xmath479",
    ". we can invoke lemma [ lem : free ] applied to the sequence @xmath467 ( it satisfies some linear recurrence sequence with integer coefficients ) , and we deduce that any pole @xmath480 of @xmath466 satisfies either @xmath481 or @xmath482 . in particular , the distinct poles @xmath402 of @xmath459 , with @xmath483 , being @xmath250th roots of the poles of @xmath473 , are either such that @xmath484 or roots of unity . by minimality of the order @xmath39 of the recurrence satisfied by @xmath198 ,",
    "the poles of @xmath459 are precisely the roots of @xmath416 .",
    "we factor @xmath485 ( each @xmath486 is one of @xmath487 , although they may be repeated ) .",
    "let us factor @xmath416 as @xmath488 where @xmath489 by assumption @xmath490 $ ] .",
    "moreover if @xmath491 is a splitting field of @xmath416 over @xmath384 then any automorphism of @xmath491 must permute the set of @xmath486 with @xmath492 , since the automorphism permutes the entire set of @xmath486 s and it must send roots of unity to roots of unity . thus @xmath493 is a rational polynomial , since it is fixed by every automorphism of @xmath491 . note that if @xmath494 , then the coefficient of @xmath495 in @xmath493 is given by a sum of products of @xmath8 elements in @xmath496 .",
    "the set of algebraic integers is a subring of @xmath392 and the only rationals that are algebraic integers are in fact integers .",
    "since the @xmath486 s are algebraic integers , @xmath493 is thus an integer polynomial .",
    "moreover , since the @xmath67-adic absolute value is non - archimedian , the coefficient of @xmath495 in @xmath493 , @xmath494 , has @xmath67-adic absolute value strictly less than @xmath1 .",
    "note that an integer @xmath261 satisfying @xmath497 is necessarily a multiple of @xmath67 .",
    "hence @xmath498 $ ] .",
    "let us turn to the polynomial @xmath414 .",
    "the roots of @xmath414 are roots of unity . moreover , @xmath499 $ ] by the same reasoning as before .",
    "to finish the proof , we have one last thing to show : we need to know that @xmath414 has no repeated roots . to do this ,",
    "we show that the poles of @xmath459 that are roots of unity are simple .",
    "recall that @xmath402 are the distinct poles of @xmath459 .",
    "we may assume that there exists @xmath500 such that @xmath501 are roots of unity and that for @xmath502 , @xmath503 .",
    "then there exist polynomials @xmath504 $ ] , @xmath505 , such that we have for all @xmath92 , @xmath506 since for @xmath502 , @xmath503 , we get that @xmath507 as @xmath508 .",
    "indeed , for any @xmath74 , @xmath509 is bounded by a constant . since for @xmath510 , @xmath470 is a root of unity , there exists a natural number @xmath250 such that @xmath511 for all @xmath512 . as before , we let @xmath513 for @xmath238 .",
    "thus @xmath514 is a polynomial with coefficients in @xmath392 denoted by @xmath515 .",
    "let @xmath516 . by definition of the @xmath517 s ( see above ) for all large enough @xmath92",
    ", there exists @xmath518 such that @xmath519 .",
    "since @xmath520 as @xmath521 , we get @xmath522 as @xmath508 because every factor is bounded by a constant and one tends to zero .",
    "thus for @xmath238 , as @xmath523 , we have @xmath524 consider the polynomial defined by @xmath525 let @xmath526 be a natural number .",
    "notice that by the binomial theorem , we get @xmath527 as @xmath528 , where @xmath529 is the maximum of the @xmath67-adic absolute values of the coefficients of @xmath530 .",
    "so since @xmath531 as @xmath508 , we get and both terms tend to @xmath22 as @xmath358 . ] that @xmath532 .",
    "thus for all integer @xmath92 each @xmath533 , @xmath534 , and so each @xmath535 is a constant polynomial ( this is a consequence of the _ fundamental theorem of algebra _ ,",
    "@xmath533 for all @xmath92 implies that @xmath535 takes infinitely often the same value amongst @xmath536 so it is constant ) .",
    "it follows that @xmath537 is periodic : @xmath538 so @xmath539 has no poles on the closed unit disc so in particular on the unit circle , as @xmath540 as @xmath508 .",
    "we know that @xmath541 with @xmath542 and @xmath403 relatively prime ( by minimality assumption on order of recurrence satisfied by @xmath198 ) .",
    "consequently , @xmath414 divides @xmath543 because @xmath544 has no poles on the unit circle .",
    "this shows that it has no repeated roots , completing the proof .",
    "let us consider the technical lemma used in the previous proof .",
    "[ lem : free ] let @xmath198 be an integer linear recurrence sequence satisfying and let @xmath545 $ ] be the corresponding rational power series .",
    "suppose that the multiplicative subgroup of @xmath460 generated by the ( finitely many ) poles of @xmath459 is a free abelian group and let @xmath546 for @xmath37 where @xmath547 . if the rational power series @xmath548 $ ] has poles @xmath549 satisfying @xmath457 for @xmath476 , then every pole @xmath550 of @xmath459 either satisfies @xmath481 or @xmath482 .",
    "let @xmath402 be the distinct poles of @xmath551 with @xmath552 .",
    "note that @xmath22 can not be a pole of @xmath553 .",
    "we first claim that @xmath554 for @xmath555 . to see this ,",
    "notice that to be a pole , each @xmath556 must satisfy @xmath557 .",
    "this means that @xmath558 consequently , for all @xmath559 , we have @xmath560 by the non - archimedian property we have @xmath561 for some @xmath562 .",
    "thus @xmath563 .",
    "since @xmath564 , @xmath565 .",
    "this gives the claim and so @xmath554 for @xmath555 .",
    "we may assume that @xmath566 and @xmath503 for @xmath567 .",
    "so , we know that the poles of @xmath553 have @xmath67-adic absolute value @xmath568 .",
    "next there exist polynomials @xmath569 $ ] such that @xmath570 moreover , define @xmath571 for some @xmath572 .",
    "hence by multinomial theorem , we have @xmath573 since the roots of the characteristic polynomial are the reciprocals of the poles of the corresponding rational power series , it follows that the set of poles of @xmath453 is contained in the set @xmath574 by assumption , the poles of @xmath453 all have @xmath67-adic absolute value strictly greater than @xmath1 . note that @xmath575 is @xmath576 if and only if @xmath577 for some @xmath578 . therefore , we can conclude that the possible poles of @xmath579 supported only by products on @xmath580 do not occur .",
    "so for instance , @xmath581 is not a pole of @xmath579 .",
    "let @xmath582 denote the multiplicative subgroup of @xmath460 generated by @xmath583 . by assumption",
    ", @xmath582 is a subgroup of a finitely generated free abelian group , and hence @xmath584 , for some natural number @xmath463 . to conclude the proof ,",
    "it is enough to show that @xmath585 .",
    "because in that case , one can conclude that the only possible pole @xmath480 of @xmath553 such that @xmath586 is @xmath1 .",
    "to see this , suppose that @xmath587 and let @xmath588 be generators for a free abelian group of rank @xmath589 .",
    "then for @xmath590 , we can write @xmath591 where @xmath592 are integers . we relabel if necessary so that    * @xmath593 ; * @xmath594 .    by construction , @xmath581",
    "can not be written as a different word in @xmath583 of length at most @xmath51 .",
    "then the expression for @xmath444 above has an occurrence of @xmath595 that can not be canceled by any other pole , by our selection of @xmath596 .",
    "consequently , @xmath581 should be a pole of @xmath579 which contradicts the conclusion of the previous paragraph .",
    "so , @xmath585 and the result follows .    as it was stressed in the introduction of this section , we are now able to check , whether or not the number of values taken infinitely often by a linear recurrence sequence modulo @xmath424 tends to infinity as @xmath358 .",
    "let us consider the following example .",
    "[ exa : aaa ] consider the linear recurrence sequence @xmath198 given in @xcite and defined by @xmath597 for @xmath37 and @xmath361 for @xmath598 . as shown in @xcite , addition within this linear numeration system",
    "is not computable by a finite automaton .",
    "nevertheless , we can show by applying the previous theorem that @xmath599 as @xmath358 .",
    "one has @xmath600 and it is not difficult to see that this polynomial can not be factorized as @xmath488 with two factors satisfying hypotheses of theorem  [ the : jason ] .",
    "this example shows that our decision procedure given by theorem  [ the : finfin ] can take care of numeration systems not handled by @xcite .",
    "consider the recurrence relation @xmath601 with the above notation , @xmath602 and @xmath603 with the initial conditions @xmath361 for @xmath604 , the corresponding sequence does not satisfy any relation of shorter length as @xmath605 even if the gcd of the coefficients of the recurrence is @xmath1 , since @xmath403 satisfies the assumptions of theorem  [ the : jason ] for @xmath606 , @xmath607 as @xmath358 .",
    "the following table gives the first values of @xmath608 . @xmath609",
    "an _ abstract numeration system _ @xmath610 is given by an infinite regular language @xmath75 over a totally ordered alphabet @xmath611 @xcite . by enumerating the words of @xmath75 in genealogical order",
    ", we get a one - to - one correspondence denoted @xmath612 between @xmath34 and @xmath75 . in particular , @xmath22 is represented by the first word in @xmath75 . the reciprocal map associating a word @xmath613 to its index in the genealogically ordered language @xmath75",
    "is denoted @xmath614 .",
    "a set @xmath14 of integers is _",
    "@xmath615-recognizable _ if the language @xmath616 over @xmath152 is regular .",
    "let @xmath610 be an abstract numeration system built over an infinite regular language @xmath75 having @xmath617 as minimal automaton .",
    "the transition function @xmath618 is extended on @xmath619 by @xmath620 and @xmath621 for all @xmath622 , @xmath623 and @xmath624 .",
    "we denote by @xmath625 ( resp .",
    "@xmath626 ) the number of words of length @xmath92 ( resp .",
    "@xmath627 ) accepted from @xmath622 in @xmath628 . by classical arguments , the sequences @xmath629 ( resp .",
    "@xmath630 ) satisfy the same homogenous linear recurrence relation for all @xmath622 ( for details , see remark  [ rem : ujvj ] ) .    in this section",
    ", we consider , with some extra hypothesis on the abstract numeration system , the following decidability question analogous to problem  [ pb ] .",
    "given an abstract numeration system @xmath615 and a set @xmath14 such that @xmath616 is recognized by a ( deterministic ) finite automaton , is it decidable whether or not @xmath2 is ultimately periodic , i.e. , whether or not @xmath2 is a finite union of arithmetic progressions ?",
    "abstract numeration systems are a generalization of positional numeration systems @xmath3 for which @xmath34 is @xmath7-recognizable .",
    "take the language @xmath631 and assume @xmath632 . ordering the words of @xmath75 in genealogical order :",
    "@xmath633 gives back the fibonacci system .",
    "the following example shows that the class of abstract numeration systems is strictly bigger than the class of linear numeration systems for which @xmath34 is recognizable .",
    "[ ex:2fib ] consider the language @xmath634 and the ordering @xmath635 of the alphabet .",
    "if we order the first words in @xmath75 we get @xmath636    notice that there is no bijection @xmath637 between @xmath638 and a set of integers leading to a positional linear numeration system .",
    "otherwise stated , @xmath639 can not be identified with usual `` digits '' . indeed , assume that there exists a sequence @xmath7 of integers such that for all @xmath640 , with @xmath641 in @xmath638 for all @xmath92 , @xmath642 . since @xmath643 and @xmath644 we get @xmath4 , @xmath645 and @xmath646 .",
    "moreover , @xmath647 , so @xmath87 . therefore , @xmath648 but @xmath649 getting a contradiction .    . ]    for all @xmath50 , we have @xmath650 and @xmath651 .",
    "consequently , for @xmath50 , @xmath652 notice that for @xmath50 , @xmath653 .",
    "consequently , by definition of the fibonacci sequence , we get for all @xmath654 , @xmath655 and @xmath656    [ rem : ujvj ] the computation given in the previous example to obtain a homogenous linear recurrence relation for the sequence @xmath657 can be carried on in general .",
    "let @xmath622 .",
    "the sequence @xmath629 satisfies a homogenous linear recurrence relation of order @xmath39 whose characteristic polynomial is the characteristic polynomial of the adjacency matrix of @xmath628 .",
    "there exist @xmath658 such that for all @xmath37 , @xmath659 consequently , we have for all @xmath37 @xmath660 therefore the sequence @xmath630 satisfies a homogenous linear recurrence relation of order @xmath661 .    as shown by the following lemma , in an abstract numeration system , the different sequences @xmath662 , for @xmath622 , are replacing the single sequence @xmath198 defining a positional numeration system as in definition  [ def : numsys ] .",
    "@xcite let @xmath663 .",
    "we have @xmath664 where @xmath665 for @xmath666 .",
    "recall that @xmath667 is equal to @xmath1 if @xmath668 and it is equal to @xmath22 otherwise .",
    "[ pro : pa]@xcite let @xmath610 be an abstract numeration system built over an infinite regular language @xmath75 over @xmath152 .",
    "any ultimately periodic set @xmath2 is @xmath615-recognizable and a dfa accepting @xmath616 can be effectively obtained .    recall that an automaton is _ trim _ if it is accessible and coaccessible ( each state can be reached from the initial state and from each state , one can reach a final state ) .",
    "[ pro : absnum ] let @xmath610 be an abstract numeration system such that for all states @xmath669 of the trim minimal automaton @xmath617 of @xmath75 , @xmath670 and @xmath671 for all @xmath37 .",
    "if @xmath14 is an ultimately periodic set of period @xmath142 , then any deterministic finite automaton accepting @xmath616 has at least @xmath672 states where @xmath673 .",
    "let @xmath143 be the preperiod of @xmath2 .",
    "since for all states @xmath669 of @xmath628 , we have @xmath674 , there exists a minimal constant @xmath675 such that @xmath676 for all @xmath677 .",
    "consider for any @xmath37 , the word @xmath678 corresponding to the first word of length @xmath679 in the genealogically ordered language @xmath75 .",
    "consequently , for @xmath680 , @xmath681 is factorized as @xmath682 with @xmath683 and we define @xmath684 .",
    "notice that @xmath685 is the smallest word of length @xmath686 accepted from @xmath687 . by definition of @xmath686 , from each @xmath687 , there are at least @xmath142 words of length @xmath686 leading to a final state .",
    "if we order them by genealogical ordering , we denote the @xmath142 first of them by @xmath688 notice that for @xmath689 , we have @xmath690    the sequence @xmath691 is ultimately periodic and takes infinitely often @xmath692 different values .",
    "let @xmath693 such that @xmath694 and for all @xmath170 , @xmath695 .",
    "we have @xmath696 the elements in the set @xmath697 can take only @xmath698 different values .",
    "so at least @xmath699 of them are the same . for the sake of simplicity , assume that they are @xmath700 . consequently ,",
    "for @xmath701 and for all @xmath702 , we have @xmath703 . for all @xmath701 such that @xmath704 , by lemma  [ lem : per ] , there exists @xmath173 such that either @xmath705 and @xmath706 or , @xmath707 and @xmath708 .",
    "therefore , the words @xmath709 and @xmath710 do not belong to the same equivalence class for the relation @xmath711 . this can be shown by concatenating the word @xmath712 .",
    "hence the minimal automaton of @xmath616 has at least @xmath713 states .",
    "[ cor : ans ] let @xmath610 be an abstract numeration system having the same properties as in proposition  [ pro : absnum ] .",
    "assume that the sequence @xmath714 is such that @xmath715 then the period of an ultimately periodic set @xmath14 such that @xmath616 is accepted by a dfa with @xmath51 states is bounded by the smallest integer @xmath185 such that for all @xmath186 , @xmath716 , where @xmath717 is the set of states of the ( trim ) minimal automaton of  @xmath75 .",
    "[ pro : ans ] let @xmath610 be an abstract numeration system . if @xmath14 is an ultimately periodic set of period @xmath142 such that @xmath616 is accepted by a dfa with @xmath51 states , then the preperiod @xmath143 of @xmath2 is bounded by an effectively computable constant @xmath529 depending only on @xmath51 and @xmath142 .",
    "let @xmath718 be a dfa with @xmath51 states accepting @xmath616 . as usual",
    ", @xmath617 is the minimal automaton of @xmath75 and for any state @xmath622 , @xmath625 is the number of words of length @xmath92 accepted from @xmath669 in @xmath628 .",
    "since @xmath629 satisfies a linear recurrence relation , the sequences @xmath719 are ultimately periodic for all @xmath622 . as usual , we denote by @xmath720 ( resp .",
    "@xmath721 ) the preperiod ( resp . the period ) of @xmath722 .",
    "we set @xmath723 and @xmath724 for @xmath143 large enough , we have @xmath725 . by the pumping lemma applied to the product automaton",
    "is defined as follows . for any state @xmath726 in the set of states",
    "@xmath727 , when reading @xmath623 , one reaches in @xmath728 the state @xmath729 .",
    "the initial state is @xmath730 and the set of final states is @xmath731 . roughly speaking",
    ", the product automaton mimics the behavior of both automata @xmath213 and @xmath628 . ] @xmath728 , there exist @xmath732 with @xmath733 , @xmath734 , @xmath735 , @xmath736 and such that @xmath737 and for all @xmath232 , @xmath738 since @xmath739 is bounded by a constant , we also have @xmath740 if @xmath143 is chosen large enough .    since @xmath740 , using , and for all @xmath622 the periodicity of the sequences @xmath741 , we have for all @xmath742 that @xmath743 let us give some extra details on how we derive identity .",
    "assume @xmath744 , @xmath745 and @xmath746 . for all @xmath222",
    ", using for @xmath747 , we get @xmath748 and @xmath749 where the first ( resp .",
    "second , third ) line corresponds , as explained below , to the contribution of @xmath17 ( resp .",
    "@xmath750 , @xmath751 ) . by definition of the coefficients @xmath752 ,",
    "we know that @xmath753 depends only on @xmath754 but @xmath755 depends only on @xmath756 and on @xmath757 . continuing this way , @xmath758 depends only on @xmath759 and on @xmath760 and for @xmath555 , @xmath761 depends on @xmath762 and on @xmath763 .",
    "now @xmath764 depends only on @xmath765 and on @xmath766 .",
    "this implies that @xmath767 for all @xmath622 and all @xmath559 .",
    "this argument can be repeated with every copy of @xmath21 appearing in @xmath78 .",
    "consequently , the previous expansion becomes @xmath768 assume now that @xmath769 , with @xmath742 . for @xmath622 and @xmath770",
    ", we have @xmath771 and the second term is congruent to @xmath22 modulo @xmath142 due to the periodicity of the sequences @xmath722 ( recall that in the case we are considering , @xmath772 ) .",
    "consequently , for @xmath769 , we have @xmath773 it is then easy to derive .",
    "we now use the minimality of @xmath143 to get a contradiction .",
    "assume that @xmath215 is in @xmath2 ( the case not in @xmath2 is similar ) .",
    "therefore for all @xmath222 , @xmath774 is not in @xmath2 . from , for @xmath775",
    "we get @xmath776 , but from this word represents a number of the kind @xmath774 with @xmath494 which can not belong to @xmath2 .",
    "notice that @xmath529 can be effectively estimated as follows .",
    "one has to choose a constant @xmath529 such that @xmath777 implies @xmath778 .",
    "since the abstract numeration system @xmath615 , the period @xmath142 and the number @xmath51 of states are given , @xmath779 and @xmath780 for all @xmath232 can be effectively computed .",
    "[ the : ans ] let @xmath610 be an abstract numeration system such that for all states @xmath669 of the trim minimal automaton @xmath617 of @xmath75 @xmath781 and @xmath671 for all @xmath37 .",
    "assume moreover that @xmath673 is such that @xmath782 .",
    "it is decidable whether or not an @xmath615-recognizable set is ultimately periodic .",
    "the proof is essentially the same as the one of theorem  [ the : finfin ] .",
    "first notice that the sequence @xmath673 satisfies a linear recurrence relation of the kind having @xmath70 as last coefficient .",
    "moreover it is increasing , since @xmath671 for all @xmath37 .",
    "let the prime decomposition of @xmath254 be @xmath255 with @xmath256 .",
    "consider a dfa @xmath213 with @xmath51 states accepting an @xmath615-recognizable set @xmath14 .",
    "assume that @xmath2 is periodic with period @xmath285 where @xmath259 and @xmath286 .    by proposition  [ pro : absnum ] ,",
    "we get @xmath783 . using remark  [ rem : nupiu ]",
    ", we obtain @xmath784 let @xmath277 be defined as the largest index @xmath92 such that @xmath785 .",
    "notice that since the sequence @xmath786 is increasing , the map @xmath787 is non - decreasing and @xmath279 .",
    "since @xmath259 , the sequence @xmath788 is purely periodic and @xmath789 . therefore , @xmath790 and we can give effectively an upper bound on @xmath188 .",
    "now we can give upper bound on the @xmath262 s . the assumption",
    "@xmath782 implies that @xmath791 and we have exactly the same reasoning as in the proof of theorem  [ the : finfin ] .",
    "we have shown that if @xmath2 is ultimately periodic , then its period @xmath142 is bounded by a constant that can be effectively estimated . using proposition  [ pro : ans ] ,",
    "its preperiod is bounded by a constant which can also be computed effectively .",
    "consequently , the sets of admissible periods and preperiods we have to check are finite .",
    "thanks to proposition  [ pro : pa ] , one has to build an automaton for each ultimately periodic set corresponding to a pair of admissible preperiods and periods and then compare the accepted language with @xmath616 .",
    "the abstract numeration system given in example  [ ex:2fib ] satisfies all the assumptions of the previous theorem .",
    "theorem  [ the : ans ] can be used to decide particular instances of the hd0l periodicity problem .",
    "let @xmath792 , @xmath793 be two finite alphabets .",
    "consider two morphisms @xmath794 and @xmath795 such that @xmath59 is prolongeable on a letter @xmath250 .",
    "the question is to decide whether or not the infinite word @xmath796 is ultimately periodic .",
    "thanks to @xcite , one can canonically build an abstract numeration system @xmath610 and a deterministic finite automaton with output @xmath797 where @xmath798 is the output function such that @xmath799 such a sequence is said to be an _ @xmath615-automatic sequence_. notice that @xmath800 is ultimately periodic if and only if for all @xmath801 , the @xmath615-recognizable set @xmath802 is ultimately periodic .",
    "if @xmath58 and @xmath59 are such that the associated numeration system @xmath615 satisfies the assumptions of theorem  [ the : ans ] , then one can decide whether or not @xmath803 ( and therefore @xmath804 ) is ultimately periodic .",
    "we warmly thank jacques sakarovitch for casting a new light on juha honkala s paper .",
    "we also thank christiane frougny , jrme leroux and narad rampersad for pointing out some useful references .",
    "e. charlier , m. rigo , a decision problem for ultimately periodic sets in non - standard numeration systems , mathematical foundations of computer science 2008 ( toru ) , lecture notes in comput .",
    "sci . * 5162 * , pp .",
    "241252 , springer - verlag ( 2008 ) .",
    "fraenkel and s.t .",
    "klein , novel compression of sparse bit - strings  preliminary report , proc .",
    "nato advanced research workshop on combinatorial algorithms on words ( a. apostolico and z. galil , eds .",
    ", maratea , italy , june 1984 ) , 169183 , springer - verlag , heidelberg , 1985 .        c. frougny , b. solomyak , on the representation of integers in linear numeration systems , in ergodic theory of @xmath806 actions ( warwick , 19931994 ) , 345368 , _ london math .",
    "lecture note ser . _ * 228 * , cambridge univ . press , cambridge , ( 1996 ) .",
    "j. leroux , a polynomial time presburger criterion and synthesis for number decision diagrams , 20th ieee symposium on logic in computer science ( lics 2005 ) , chicago , il , usa , ieee computer society ( 2005 ) , 147156 ."
  ],
  "abstract_text": [
    "<S> consider a non - standard numeration system like the one built over the fibonacci sequence where nonnegative integers are represented by words over @xmath0 without two consecutive @xmath1 . given a set @xmath2 of integers such that the language of their greedy representations in this system is accepted by a finite automaton , we consider the problem of deciding whether or not @xmath2 is a finite union of arithmetic progressions . </S>",
    "<S> we obtain a decision procedure for this problem , under some hypothesis about the considered numeration system . in a second part </S>",
    "<S> , we obtain an analogous decision result for a particular class of abstract numeration systems built on an infinite regular language . </S>"
  ]
}