{
  "article_text": [
    "recent collaboration between astronomers and statisticians has led to a better understanding of the particular challenges associated with bayesian analysis of dynamical planet detections . in this paper , we briefly review the state of the art of bayesian parameter estimation , model selection , and experimental design in the context of extrasolar planet searches .",
    "then , we discuss recent work on bayesian model selection , demonstrating the properties of several estimators of the marginal posterior probability using an actual set of data from an rv planet search .      in rv surveys , the velocity of the central star is precisely monitored for periodic variations which could be caused by orbiting companions ( see fig .  1 , left ) .",
    "each individual observation can be reduced to an estimate of the observational uncertainty ( @xmath2 ) and a measurement of the star s rv ( @xmath3 ) relative to the @xmath4th velocity reference at time @xmath5 . because each rv measurement is based on calculating the centroid of thousands of spectra lines and averaged over hundreds of sections of the spectrum , the observational uncertainties of most current echelle based rv surveys can be accurately estimated and are nearly gaussian @xcite .",
    "there may also be intrinsic stellar variability ( `` jitter '' ) that we model as an addition source of uncorrelated gaussian noise with variance @xmath6 and add to the measurement uncertainties in quadrature .",
    "if the velocity observations ( @xmath7 ) were generated by the model specified by @xmath8 and model parameters @xmath9 , then the probability of measuring the observed velocities is @xmath10 , % % \\label{eqnlikelihood}\\ ] ] assuming that the errors in individual observations and the `` jitter '' are both normally distributed and uncorrelated .",
    "[ figdata ]      specifying the mass and six phase space coordinates of each body in a planetary system at a specified time provides a complete description of the system . in practice , it is convenient to choose the osculating keplerian orbital elements ( orbital period , @xmath11 , orbital eccentricity , @xmath12 , inclination relative to the plane of the sky , @xmath13 , argument of periastron measured from the plane of the sky , @xmath14 , longitude of ascending node , @xmath15 , and mean anomaly , @xmath16 ) for each planet in jacobi coordinates , since the mean anomaly is the only one of these orbital elements that changes with time for a planet on an unperturbed keplerian orbit .",
    "the observed stellar velocity is the sum of the line of sight velocity of the center - of - mass and the projection of the reflex velocity due to any planetary companions onto the line of sight . for multiple planet systems",
    ", it can be important to use complete n - body simulations to model the planetary motions accurately ( e.g. , gj876 ; laughlin et al .  2005 ; rivera et al .",
    "2005 ) . however , in most cases , the mutual planetary perturbations are negligible on time scales comparable to the duration of observations . in such cases ,",
    "the rv perturbations due to a multiple planet system can be modeled as the linear superposition of multiple non - interacting keplerian orbits , @xmath17 where @xmath18 is the @xmath19th velocity reference . while there is a single mean line of sight velocity of the center of motion , it is important to use separate constants , @xmath18 for each observatory / spectrograph pair , since the velocities are measured differentially relative to a reference velocity that is unique to each observatory .",
    "the perturbation to the stellar rv ( @xmath20 ) due to a planet on a keplerian orbit is given by @xmath21   % $ ] where @xmath22 labels the planet , @xmath23 is the velocity semi - amplitude and @xmath24 is the true anomaly , which implicitly depends on time . the true anomaly ( @xmath24 ) is related to the eccentric anomaly ( @xmath25 ) via the relation @xmath26 the eccentric anomaly is related to the mean anomaly ( @xmath16 ) via kepler s equation @xmath27 where @xmath28 is a constant , the orbital phase at @xmath29 .",
    "unfortunately , rv observations alone are not sensitive to the orbital inclination relative to the plane of the sky ( @xmath13 ) or the longitude of ascending node ( @xmath15 ) .",
    "therefore , rv observations by themselves can only measure the minimum mass ratio , @xmath30 , that is a function of @xmath23 , @xmath11 , @xmath12 , and @xmath31 , where @xmath31 is the stellar mass , typically estimated by independent astronomical observations .      to quantitatively analyze the available observational constraints",
    ", we employ the techniques of bayesian inference . by treating both the observation and the model parameters as random variables ,",
    "bayesian inference is able to address statistical questions in a mathematically rigorous fashion .",
    "the joint probability , @xmath32 , can be expressed as the product of the likelihood ( @xmath33 ) , the probability of the observables given the model parameters ) , and a prior probability distribution function ( @xmath34 ) which is based on previous knowledge of the model parameters .",
    "note that each of the probability distribution functions ( pdfs ) is conditioned on the assumption of a model , @xmath8 , that includes the meaning of the model parameters , @xmath9 , and their relationship to the observational data , @xmath35 .",
    "bayes s theorem allows one to compute a posterior probability density function , @xmath36 , which incorporates the knowledge gained by the observations @xmath35 , @xmath37 this paper is particularly interested in the case when there are multiple viable models ( e.g. , no planet model , one planet model , two planet model , etc . ) for the current data set . in this case , the posterior for a given model and set of parameters is given by @xmath38 , where @xmath39 is the prior probability of model @xmath8 and the marginal posterior probability for model @xmath8 is given by @xmath40 we briefly review recent progress in sampling from @xmath41 via mcmc in  1.5 and introduce and compare algorithms for evaluating of @xmath42 in  2 .      in table",
    "[ tabpriors ] , we list the priors used for each model parameter in this work . while the choice of these and other parameters can be fine - tuned for a given problem , we suggest these choices as a starting point for the bayesian analysis of radial velocity data sets .",
    "physical and geometric considerations lead to natural choices for the prior pdfs for most of the model parameters ( see table  [ tabpriors ] ) .",
    "a few of the priors merit closer attention .",
    "the cutoff at a minimum orbital period is chosen to be less than the smallest orbital period of known extrasolar planets , but this is somewhat larger than the theoretical limit ( the roche limit occurs at @xmath43d for a 10@xmath44 planet around a 1@xmath45 star ) .",
    "the cutoff at a maximum orbital period is much longer than any known extrasolar planet , but is chosen to be roughly where perturbations from passing stars and the galactic tide would disrupt the planet s orbit .",
    "the cutoff at a maximum velocity semi - amplitude is chosen to be a function of orbital period , so that the cutoff corresponds to a constant planet - star mass ratio . in this paper",
    ", we set @xmath46 m/s , which corresponds to a maximum planet - star mass ratio of 0.01 .",
    "this choice is primarily based on the observed distribution of extrasolar planet masses . clearly , there are stellar binaries with much larger velocity amplitudes , but this limit can be considered the definition of a planet .",
    "while the possibility of arbitrarily small masses ( and hence velocity amplitudes ) prevents a physical justification for a lower cutoff , @xmath47 , it is not possible to detect or constrain the orbital parameters of a sufficiently low - mass planet . to keep the prior distribution normalizable , we impose breaks in the priors for @xmath23 and @xmath48 at @xmath49 and @xmath50 , chosen to be at a velocity amplitude less than the smallest detectable velocity amplitude . for a data set with @xmath51 rv measurements with typical measurement precision of @xmath52 , we suggest setting @xmath53 ( cumming 1999 ) . for the reference",
    "prior , we chose @xmath54 m/s , somewhat arbitrarily , but motivated by the current state of the art in rv planet searches @xcite . for systems",
    "where a planet is clearly detected , the shape of the posterior will not be sensitive to our assumptions about the prior for small values of @xmath23 , but for planets which are marginally detected , this choice may become significant . if the posterior distribution has significant probability near @xmath55 , then one should check how sensitive any conclusions are to the choice of @xmath56 .    ccccc model parameter & variable & prior distribution & minimum & maximum + amplitude of jitter & @xmath48 & @xmath57 & 0 m / s & @xmath58 +   +   + velocity offset & @xmath18 & @xmath59 & -@xmath58 & @xmath58 +   +   + orbital period & @xmath60 & @xmath61 & 1 d & @xmath62 yr + velocity semi - amplitude & @xmath63 & @xmath64}$ ] & 0 m / s & @xmath58 @xmath65 + orbital eccentricity & @xmath66 & 1 & 0 & 1 + argument of periastron & @xmath67 & @xmath68 & 0 & @xmath69 + orbital phase & @xmath70 & @xmath68 & 0 & @xmath69 +    [ tabpriors ]      identifying the correct orbital solution from a set of rv ( or other dynamical ) observations is challenging due to the necessity of considering a very large parameter space of possible solutions ( see fig .  1 , right ) . for rv planet searches ,",
    "there are at least five model parameters per planet and one model parameter per observatory . to make the global search problem tractable , rv data sets are traditionally searched for sinusoidal signals ( potential planets ) using a periodogram .",
    "the advantage of the periodogram is that it is extremely tractable computationally ( @xmath71 ) and can be quite useful for identifying potential orbital periods",
    ". then levenberg - marquardt ( lm ) minimization @xcite is applied starting from several initial guesses of orbital solutions near each of the potential orbital periods identified by the periodogram . if the quality of the fit is consistent with the combination of the observational uncertainties @xcite and the expected intrinsic stellar variability @xcite , then estimates of the uncertainties in orbital parameters are obtained by repeatedly finding the best - fit orbital parameters ( with lm ) to several synthetic data sets generated via bootstrap resampling ( with replacement ) of the observational data @xcite .",
    "these methods work quite well for analyzing stars with a single planet on a low - eccentricity , short - period ( relative to the duration of the observations ) orbit when the velocity perturbation is large ( relative to the measurement uncertainties ) . since such planets are the easiest to discover , they are common among the known sample of planets , and the traditional frequentist methods have proven quite valuable in their discovery .    in recent years",
    ", rv searches have become increasingly sensitive to planets with small velocity amplitudes and/or long orbital periods , as well as planets in multiple planet systems .",
    "bayesian inference can help with each of these challenges and has the potential to significantly improve the sensitivity of detections and accuracy of orbital determinations .",
    "recent work has begun to develop the framework and computational tools to make this happen .",
    "for example , @xcite discussed the relationship between the periodogram method and a bayesian analysis that assumes any planet is on a circular orbit . @xcite combined brute force monte carlo ( to integrate over orbital period ) and the laplace approximation ( to integrate over the remaining model parameters ) to render bayesian model selection practical for planets assumed to be on a circular orbit ( e.g. , short - period planets prone to tidal circularization ) .",
    "mcmc has been applied to estimate orbital parameters and their uncertainty and to help understand the situations where traditional frequentist methods leave significant room for improvement @xcite .",
    "@xcite and @xcite have automated the determination of parameters of the candidate transition pdfs . @xcite has also identified non - linear candidate transition pdfs that dramatically accelerate the convergence of mcmc .",
    "these advances make it computationally feasible for mcmc to characterize the allowed orbital solutions for single planets or weakly - interacting multiple planet systems ( e.g. * ? ? ?",
    "@xcite has applied parallel tempering to allow mcmc to explore multiple orbital solutions widely separated in parameter space .",
    "@xcite developed the theoretical framework for applying bayesian adaptive experimental design to dynamical extrasolar planet searches , and @xcite developed computationally practical algorithms for applying these techniques to adaptively schedule radial velocity observations .",
    "bayesian techniques are just beginning to be applied to analyze the population of extrasolar planets @xcite .",
    "while mcmc techniques have proven very efficient for sampling from the posterior distribution for orbital parameters of extrasolar planets ( * ? ? ?",
    "* e.g. ) , mcmc does not directly determine the normalizing constant of the posterior distribution . while this is not necessary for parameter estimation ( within a single model ) , it is essential when considering multiple possible models ( e.g. , no planet , one planet , two planets ... ) .",
    "@xcite reviews the state of modern techniques for bayesian model selection from a statistics perspective . in this paper , we introduce several estimators of the marginal posterior and test their performance on the radial velocities for hd 88133 published in @xcite . while our test data set consists of purely rv observations , we expect that most of our findings are also directly applicable to other dynamical planet searches ( e.g. , astrometric , pulsar / white dwarf timing )",
    ". other types of planet searches ( e.g. , transits , microlensing , direct imaging ) likely present different challenges .",
    "nevertheless , the challenge of estimating marginal posterior probabilities is quite general .",
    "thus , we expect our finding may provide insights into methods for bayesian model selection in other areas of astronomy and statistics .",
    "the most obvious basic monte carlo ( bmc ) estimator of @xmath42 is based on drawing @xmath72 from the prior and discretizing the integral in eqn .",
    "[ eqnmarginal ] to create the estimator @xmath73 .",
    "unfortunately , the very large parameter space makes this totally impractical , even for a single planet system . using the prior in table  [ tabpriors ]",
    ", we drew over @xmath74 samples , but @xmath75 underestimated @xmath76 by orders of magnitude while the internal error estimate suggested a random error of 2% .",
    "this is due to the fact that not a single sample landed in the dominant peak in the likelihood ( see fig .  1",
    ", right ) .",
    "the bmc estimator can be easily modified by sampling from only a small subset of the prior .",
    "using mcmc , we sample from the posterior , select one model parameter for investigation and then marginalize over all the remaining parameters .",
    "then , we use the marginalized posterior distributions to identify the subset of parameter space with non - negligible probability ( e.g. , 99.9% credible interval ) . using this technique , we identified a region with volume , @xmath77 , @xmath78 times less than the volume of the prior distribution , @xmath79 .",
    "then , we can estimate , @xmath80 where @xmath9 are drawn from a distribution proportional to the prior over the restricted range of parameter values and zero elsewhere . for our test case ,",
    "the rmc estimator provides a reasonable estimate of @xmath81 ( see fig .  2 , top , solid curve ) .",
    "however , this estimator has several short comings .",
    "first , it is biased due to the fact that it includes the probability coming from only one hypercube of parameter space .",
    "if we choose a large subvolume , then the estimator converges slowly , since most samples miss the high likelihood regions .",
    "if we choose a small subvolume , then we may neglect a significant region of probability outside our hypercube .",
    "these problems are exacerbated for data sets where there are significant correlations between parameters and/or many model parameters . while we were able to choose an effective subvolume for the test data set , the estimator converged slowly , requiring @xmath82 samples to reach 5% accuracy .",
    "finally , we note that prohibitively large subvolumes can be necessary for other data sets that allow a broader range of orbital solutions and/or significant correlations between parameters .      in the approximation of circular orbits , the predicted velocity can be written as a linear function of functions of all the model parameter except @xmath11 and @xmath48 .",
    "thus , for given values of @xmath11 and @xmath48 , there is a single global maximum of the likelihood that can be quickly located by solving a set of linear equations .",
    "we can analytically integrate over the remaining model parameters ( @xmath63 , @xmath70 , @xmath18 ) using the laplace approximation by evaluating the likelihood at the global maximum ( for a given @xmath11 and @xmath48 ) and the fischer information matrix evaluated at that point ( for details see * ? ? ? * ; * ? ? ?",
    "for a system with @xmath83 planets , this leaves only 1+@xmath83 dimensions to be explored by brute force monte carlo , making the monte carlo integration dramatically more efficient . for small eccentricities ,",
    "the velocity perturbation due to a planet can be approximated by a series expansion in eccentricity .",
    "if we use the @xmath84 ( epicycle ) approximation , then the predicted velocity can again be linearized over all model parameters except @xmath11 and @xmath48 , allowing the this technique to efficiently consider for small eccentricities .",
    "we choose a test case to have a modest velocity amplitude and small eccentricity , so that the circular and epicycle approximations provide reasonable approximations for the radial velocity perturbations due to hd 88133b .",
    "thus , we expected partial linearization would provide at least an order of magnitude estimate of the true marginal posterior probability , as well as a point of reference for comparing other estimators . indeed ,",
    "a comparison of this estimator to the more sophisticated estimators of  2.3 - 2.5 , we find that this estimator of @xmath42 shows a systematic bias ( fig .  2 ,",
    "top , long - dashed curve ) , likely due to the laplace and the epicycle approximations . when the linear approximation to the velocity is not adequate , then a similar technique can be used , but the predicted velocity is non - linear in the parameters @xmath60 , @xmath66 , @xmath70 , and @xmath48 , so the partial linearization leaves @xmath85 dimensions to be explored by brute force . while partial linearization is useful for analyzing systems with one planet ( e.g. , * ? ? ?",
    "* ) , it rapidly becomes computationally impractical for multiple planet systems .",
    "[ figmarginalvssamples ]      given the serious difficulties in sampling from the prior , we proceed to consider estimators of the marginal posterior that sample from alternative distributions .",
    "mcmc provides a computationally efficient tool for sampling from the posterior . since a bayesian analysis will typically use mcmc to generate a sample from the posterior for the purposes of parameter estimation , we investigate estimators that can use such a sample to calculate @xmath42 .",
    "newton & raftery ( 1994 ) propose the estimator @xmath86 .",
    "unfortunately , this estimator displays extremely poor convergence properties ( fig .  2 , left , top , short - dash curve ) , as it has an infinite variance .",
    "newton & raftery ( 1994 ) suggested sampling from a mixture of the posterior and prior to obtain an estimator with finite variance , but we found similarly poor performance .",
    "gelfand & dey ( 1994 ) use the identity @xmath87^{-1 } = \\int \\frac{h(\\vec{\\theta})}{p(\\vec{\\theta})l(\\vec{\\theta } ) } p(\\vec{\\theta}|\\vec{v } ) d\\vec{\\theta } , % \\ ] ] where @xmath88 is an arbitrary density to create an estimator for the marginal posterior probability , @xmath89 where @xmath90 are drawn from the posterior .",
    "this estimator should perform well when @xmath88 approximates the posterior in regions of high probability , and it has finite variance when the tails of @xmath88 decay faster than the tails of @xmath91 ( see * ? ? ?",
    "we set @xmath88 equal to @xmath92 , where @xmath93 is a likelihood computed as in eqn .",
    "[ eqnlikelihood ] , but replacing the keplerian model with the epicycle approximation for computing the velocity perturbation of each planet and @xmath94 is the posterior under this approximation . the normalization is calculated using partial linearization & the laplace approximation as discussed in  2.1.3 . unfortunately , we find that even this approximation displays poor convergence in our test case ( fig .  2 , left , top , dotted curve ) .      given the poor convergence properties of the previous estimators based on sampling from the prior and posterior densities , we investigate estimating @xmath42 via importance sampling .",
    "importance sampling requires that we specify a properly normalized density @xmath88 which we can both evaluate at any @xmath9 and sample from efficiently .",
    "we estimate @xmath76 with @xmath95 where @xmath96 are drawn from @xmath88 .",
    "we choose @xmath97 , where @xmath98 is the multivariate normal distribution in a set of transformed model parameters , @xmath99 @xcite .",
    "we use the transformation @xmath100 , @xmath101 , @xmath102 , @xmath103 , @xmath104 , @xmath105 , @xmath106 to help reduce non - linear correlations between model parameters .",
    "we use a sample from the posterior to determine the location , @xmath107 , and sample covariance , @xmath108 , in the transformed coordinates .",
    "we find that the variance of this estimator is reduced if we scale the sample covariance matrix by a factor @xmath109 to obtain @xmath110 , the covariance matrix used in the importance sampling density .    in our test case",
    ", @xmath111 appears to be a very robust and efficient estimator for this data set ( fig .  2 ,",
    "bottom , dotted curve ) .",
    "indeed , there would be no need to pursue more sophisticated estimators , if @xmath112 performed so well on all data sets .",
    "however , we are concerned that this estimator will not be viable for other data sets where the posterior can not be well approximated by a single multivariate normal distribution .",
    "this is likely to occur in systems with long orbital periods ( see * ? ? ?",
    "* fig .  1 ) ,",
    "small data sets , and/or when the velocity amplitude is small .",
    "the posterior typically is dominated by a single peak for most published rv data sets ( almost by definition , since a data set that can be explained by two qualitatively different orbital solutions would not be considered to have discovered the planet and is unlikely to be published ) . however ,",
    "if bayesian model selection is to be used for deciding when a planet has been detected or as a part of bayesian adaptive design , then it will be necessary to analyze data sets before the posterior is so strongly peaked that it can be well approximated by a single normal distribution .",
    "therefore , we proceed to develop a more sophisticated importance sampler that can be more robust when analyzing such data sets .        in an effort to develop an importance sampling density suitable for application to a general rv data set",
    ", we consider a mixture of multivariate normal distributions .",
    "we assume that mcmc has already been used to obtain a good sample ( @xmath113 ) from the posterior and use this to construct an importance sampling density , @xmath114 where we have randomly chosen @xmath115 samples to be removed from the original posterior sample and to be used as the locations for the mixture components , @xmath116 .",
    "we choose each mixture component to be a multivariate normal distribution , @xmath117 , where we must determine a covariance matrix for each @xmath118 using the posterior sample .",
    "first , we compute @xmath119 , defined to be a vector of the sample standard deviations for each of the components of @xmath120 , using the posterior sample .",
    "next , we define the distance between the posterior sample @xmath121 and the center of @xmath116 , @xmath122 , where @xmath123 indicates the element of @xmath120 and @xmath119 .",
    "we draw another random subset of @xmath124 samples from the original posterior sample ( without replacement ) , select the @xmath125 posterior samples closest to each mixture component and use them to calculate the covariance matrix , @xmath126 , for each mixture component .",
    "we set @xmath127 , and @xmath128 .",
    "thus , we have developed an automated algorithm for using a posterior sample to construct an importance sampling density , @xmath129 .",
    "since the posterior sample is assumed to have fully explored the posterior , @xmath129 should be quite similar to the posterior in all regions of significant probability , provided that we use enough mixture components .",
    "we use @xmath129 , @xmath130 samples from the remainder of our posterior sample , and deterministic mixture sampling to compute the estimator , @xmath131 .",
    "we find that it performs quite well in our test case ( fig .  2 ,",
    "bottom , solid curve ) .",
    "it converges nearly as rapidly as @xmath132 and appears somewhat more robust , even for the rather simple posterior in our test case . in tests on more complex data sets",
    ", we find that @xmath131 can be significantly more robust than @xmath132 for data sets with somewhat less well constrained posterior pdfs , but both estimators perform poorly on other data sets with very diffuse posterior pdfs .",
    "we speculate that our method for choosing the mixture components could be replaced by a more sophisticated algorithm that might result in a superior importance sampling densities for challenging data sets .      despite the success of @xmath133",
    ", we have some concerns about the robustness of @xmath133 for high dimensional parameter spaces ( e.g. , analyzing systems with several planets ) .",
    "as the number of model parameters increases , it will become increasingly difficult to avoid @xmath134 becoming unusually large for some values of @xmath9 . to prevent this we generalize our importance sampling density to include a component from the prior , by defining @xmath135 and @xmath136 ,",
    "following @xcite , we combine this mixture density with control variables to obtain the estimator @xmath137 which is valid for any choice of @xmath138 . to minimize the variance of this estimator , we set @xmath139 , where @xmath140 is determined by least squares fitting to the linear system of @xmath130 equations @xmath141 @xcite show that this estimator is never worse than an estimator based on any subset of the mixture components . in practice , we need @xmath130 to be large to have small variance , but it is not practical to solve the linear system of equations with @xmath142 . therefore , we repeatedly solve for @xmath138 using subsets of @xmath143 posterior samples and average the results to estimate @xmath144 .",
    "the resulting estimator @xmath145 is at least as good as @xmath131 and is expected to be considerably more robust . in our test case , the estimators @xmath131 and @xmath145 follow each so closely that the curves would be indistinguishable in fig .  2 ( bottom , solid curve ) .",
    "this is because the values of @xmath146 are roughly comparable for all components with @xmath147 , while @xmath148 ( the prior component ) is orders of magnitude less than the other @xmath149 .",
    "this reflects the fact that @xmath129 , our mixture of @xmath115 multivariate normal distributions , was sufficient to accurately approximate the posterior density . while @xmath145 is somewhat more computationally expensive , we still prefer it to @xmath131 , since it should be more robust . further ,",
    "if @xmath129 was inadequate , then @xmath150 would increase , alerting us to the potential weakness of @xmath129 .",
    "we now reconsider the estimator of gelfand & dey ( 1994 ) , but using the mixture , @xmath129 , for the weight function @xmath151 .",
    "the resulting estimator @xmath152 can also be thought of as the reciprocal of an estimator of @xmath153 using importance sampling from the ( unnormalized ) posterior .",
    "when using the estimator @xmath152 , the denominator for each term in the summation contains @xmath154 evaluated at points sampled from the posterior , so the limit to the variance of this estimator will be the size ( and quality ) of the sample from the posterior .",
    "this seems acceptable , since these considerations will limit any estimate of the marginal likelihood based on a sample from the posterior .",
    "further , this seems more attractive than algorithms which place the importance sampling density in the denominator , since that could result in areas with sparse coverage ( e.g. , due to high dimensionality ) dominating the summation .",
    "we show the performance of @xmath152 in fig .  2 ,",
    "bottom , long - dashed curve .",
    "while this estimator performs reasonably well , it has a larger variance and appears to be converging more slowly than @xmath133 for our test case . additionally , we find that this estimator is particularly sensitive to the choice of @xmath155 and rapidly degrades if @xmath155 is too large or too small .",
    "we present a new estimator , based on the identity @xmath156 the key insight is to approximate the numerator by drawing a sample @xmath157 from @xmath88 and to approximate the denominator by drawing a sample @xmath158 from the posterior ( e.g. , via mcmc ) .",
    "this yields the ratio of estimators , @xmath159 this estimator seems particularly promising , since both the numerator and denominator are separate sums and there is no risk of a small denominator leading to a large variance , as in importance sampling . if we combine this estimator with the @xmath129 , the mixture of normal distributions used in  [ secmixture ] ( again using a distinct subsample from the posterior for constructing @xmath129 ) , then we obtain the estimator @xmath160 . in our test case ,",
    "the numerator converges significantly more rapidly than the denominator , and so we choose @xmath161 with minimal impact on the variance of the estimator .",
    "this estimator performs very well in our test case ( fig .  2 ,",
    "bottom , short - dashed curve ) .",
    "it converges as rapidly as any of the other estimators that we considered , with the possible exception of importance sampling from a single normal distribution .",
    "further @xmath162 appears to be quite robust , in that it does not display sudden jumps when a single additional sample significantly changes the value of the estimator , as is more common with most of the other estimators .",
    "unfortunately , we found that this estimator was less accurate on more complex test cases , yet it showed no warning signs that the estimator had not converged , even after @xmath163 samples .",
    "@xcite introduced the method of parallel tempering for estimating the marginal posterior probability for extrasolar planet observations . in parallel",
    "tempering , several markov chains are run in parallel , each with a slightly different target density , @xmath164 , where @xmath165 is an inverse temperature parameter that varies between 0 and 1 . in the parallel tempering algorithm , each markov chain typically evolves according to the usual candidate transition pdfs , but periodically the algorithm proposes an exchange of states between two markov chains that have slightly different values of @xmath165 .",
    "the `` high temperature '' markov chains ( @xmath166 ) will explore a very broad region in parameter space and can help the `` coldest '' markov chain ( @xmath167 ) to sample from the full posterior distribution , even when there are narrow and widely separated peaks in the posterior distribution @xcite . in principle , the marginal posterior probability can also be calculated from the ensemble of markov chains , using @xmath168 \\right\\ } , % \\ ] ] where @xmath169 is the @xmath13th state in the markov chain with target distribution @xmath170 , and the integral over @xmath165 is to be approximated by an appropriate weighted sum over the values of @xmath165 used by the various markov chains .",
    "we show the performance of @xmath171 using 32 tempering levels for the test data set in fig .",
    "3 . based on five completely independent realizations of the parallel tempering algorithm",
    ", we found that four provided a reasonable estimate of the @xmath42 , but one set of chains resulted in an estimate roughly twice as large as any other estimator tested .",
    "if this set of markov chains had been the only realization , none of the usual diagnostics would have recognized that it had not yet converged .",
    "therefore , we feel that more work is needed to understand the properties of marginal posterior estimates obtained from parallel tempering . if the sensitivity of the estimator were due to the slow convergence of the highest temperature chains ( @xmath166 ) , then their contribution to the integral over @xmath165 could be approximated by an analytic sampler from the prior ( corresponding to @xmath172 ) .",
    "however , we have verified that for our test case ( see table  [ taberrorfactor ] ) , the markov chains with very small values of @xmath165 make only minor contributions to the integral over @xmath165 .",
    "the second column of table  [ taberrorfactor ] gives the fractional error that would result if this decade of @xmath165 was not included and thus indicates the sensitivity of the result to that decade .",
    "therefore , we suspect that the chains limiting the accuracy of @xmath173 have @xmath174 .",
    "[ figtemperingmarginalsvssamples ]    ll @xmath165 range & fractional error + @xmath175 & @xmath176 + @xmath177 & @xmath178 + @xmath179 & @xmath180 + @xmath181 & @xmath182 + @xmath183 & @xmath184 + @xmath185 & @xmath186 + @xmath187 & @xmath188 + @xmath189 & @xmath190 + @xmath191 & @xmath192 + @xmath193 & @xmath194 + @xmath195 & @xmath196 +    [ taberrorfactor ]      while we are encouraged by the recent progress in developing efficient and robust estimators of the marginal posterior probability , there are several additional avenues of research that might lead to even more desirable estimators .",
    "one interesting method is based on the of nested sampling methods of @xcite .",
    "unfortunately , for the problem of radial velocity planet searches , there is no efficient way to sample only from high posterior probability regions of parameter space , as required by nested sampling . as a result , we can only apply nested sampling if we employ the very inefficient method of rejection sampling .    another class of algorithms for estimating bayes factors relies on sampling over the model space .",
    "two subclasses of methods have been the subject of much research in the statistics community : reversible jump mcmc @xcite , and model composition mcmc ( mc@xmath197 ) @xcite .",
    "unfortunately , we find that the most obvious choices of pseudopriors ( e.g. * ? ? ?",
    "* ) for mc@xmath197 result in very poor mixing between different models .",
    "perhaps future research can adapt these methods to allow for more rapid mixing between models with different numbers of planets .",
    "similarly , simplistic implementations of reversible jump methods seem unlikely to be practical , since the trial jumps into higher dimensional spaces will only land in areas of significant probability on extremely rare occasions .",
    "on the other hand , we are more optimistic about reversible jump algorithms that employ an analytic approximation to each of the posterior pdfs within the @xmath13th model ( @xmath198 ) for the transdimensional steps .",
    "we envision that each of the analytic approximations could be based on mixture models constructed from a sample from @xmath198 obtained using conventional mcmc techniques , similar to the importance sampling densities we employed for @xmath131 .",
    "an even more radical idea is to abandon the computation of marginal posterior probabilities in favor of some other statistic to aid in quasi - bayesian model selection .",
    "penalized likelihood methods such as the akaike and bayesian information criterion do not seem well justified when the posterior is significantly non - normal or multi - modal .",
    "additionally , we are suspicious of any method that penalizes all parameters equally , as our model is much more sensitive to some model parameters ( e.g. , orbital period ) than to others ( e.g. , eccentricity ) .",
    "therefore , we are more interested in exploring methods based on the predictive distribution .",
    "unfortunately , any of these alternative methods for model selection is somewhat arbitrary and less than ideal for the purposes of adaptively scheduling observations based on the principles of bayesian adaptive experimental design .",
    "in this paper , we have reviewed several methods for calculating the marginal posterior probabilities in the context of rv planet searches .",
    "one the positive side , we found that several algorithms were able to accurately calculate the marginal posterior probability for a simple test case , where there was a single dominant peak in the posterior probability distribution .",
    "however , all of the estimators based on sampling from either the prior or posterior had serious short comings .",
    "the method of partial linearization can be a useful tool for rapidly computing relatively low accuracy estimates of @xmath42 for data sets with one planet or even @xmath199 planets on low eccentricity orbits .",
    "however , it rapidly becomes computationally intractable when there are multiple planets with significant eccentricities .",
    "restricted monte carlo ( @xmath200 ) can be useful for planets with large eccentricities , but is computationally feasible only once the orbital parameters are relatively well constrained .",
    "parallel tempering is able to estimate @xmath42 even for multimodal posterior distributions , but for our test data set @xmath173 converged more slowly than all of the other algorithms tested ( except basic monte carlo ) . for our test case",
    ", we found no regime where the harmonic mean ( @xmath201 ) or the weighted harmonic mean ( @xmath202 ) would be the most desirable estimator .",
    "the new ratio estimator ( @xmath203 ) performed very well for our test case , but we recommend proceeding with caution , based on preliminary tests with more complex data sets .    based on our tests , the most promising methods are based on importance sampling using an analytic density that mimics the posterior ( e.g. , @xmath132 or @xmath145 ) . when the posterior has a single dominant peak that can be reasonably approximated by a multivariate normal distribution , then simple importance sampling ( @xmath132 ) provides a very efficient tool for estimating marginal posteriors . in cases where the posterior is more complex ( e.g. , multiple peaks and/or non - linear parameter correlations )",
    ", then importance sampling can still be useful when combined with a mixture distribution based on a sample from the posterior that can be readily calculated via standard mcmc .",
    "refinements to the basic importance sampling algorithm ( e.g. , @xmath145 ) can provide increased robustness and offer a tool for diagnosing when the mixture distribution is sufficient .",
    "we hope that future research will improve our understanding of these estimator s theoretical and real - life properties , as well as lead to additional refinements .",
    "in particular , we hope to investigate how the estimator @xmath145 performs on more widely dispersed posterior distributions and on higher dimensional problems ( e.g. , multiple planet systems ) .    in a sense",
    ", we can consider the problem of bayesian model selection to have been reduced to the problem of constructing an analytic approximation to a probability density based only on a set of samples from the distribution .",
    "unfortunately , we recognize our algorithm for constructing importance sampling densities is not yet sufficiently robust to be applied generally .",
    "therefore , we would like to see additional research that would improve the robustness and computational efficiency of these algorithms . fortunately",
    ", we recognize several ways our current algorithm could be improved .",
    "for example , rather than centering the mixture components on random samples from the posterior , it might be possible to make do with a smaller number of mixture components .",
    "perhaps methods making use of voronoi tessellations and/or quasi - monte carlo methods could be beneficial in constructing good mixture distributions with fewer components , improving the computational efficiency of these methods .",
    "finally , we note that this field is still young , and additional research is needed to explore a wide range of methods for estimating @xmath76 , including methods on importance sampling , parallel tempering , reversible jump mcmc , mc@xmath197 , and nested sampling .",
    "the authors acknowledge many stimulating meetings of the exoplanets working group during the astrostatistics program at the statistics and applied mathematical sciences institute .",
    "the working group was supported in part by nsf grants ast-0507589 and ast-0507481 .",
    "the authors especially thank jim berger , floyd bullard , merlise clyde , tom loredo , and bill jefferys for their contributions .",
    "e.b.f . acknowledges the support of the miller institute for basic research",
    ". additional support for this work was provided by nasa through hubble fellowship grant hst - hf-01195.01a awarded by the space telescope science institute , which is operated by the association of universities for research in astronomy , inc .",
    ", for nasa , under contract nas 5 - 26555 . p.c.g . acknowledges the support of a grant from the canadian natural sciences and engineering research council at the university of british columbia .",
    "asher johnson , j. et al .",
    ", 2006 , `` the n2k consortium vi : doppler shifts without templates and three new short - period planets '' astrophys .",
    "j. in press ( astro - ph/0604348 ) butler , r. p. , marcy , g. w. , williams , e. , mccarthy , c. , dosanjh , p. , vogt , s. s. 1996 , `` attaining doppler precision of 3 m s@xmath204 '' pub .",
    "of the astronomical soc .  of the pacific , 108 , 500 carlin , b.p .",
    "& chib , s. 1995,``bayesian model choice via markov chain monte carlo '' j.  of the royal stat .  soc .",
    ", series b 57 , 473 .",
    "carlin , b.p . & louis , t.a .",
    "2000 , _ bayes and empirical bayes methods for data analysis . _",
    "( new york : chapman & hall / crc ) .",
    "clyde , m. 2006 , `` current challenges in bayesian model choice '' this volume cumming , a. , marcy , g.w . , butler , r.p .",
    "1999 , `` the lick planet search : detectability and mass thresholds '' astrophys .",
    "j. , 526 , 890 .",
    "cumming , a. 2004 , `` detectability of extrasolar planets in radial velocity surveys '' monthly notices of the roy .",
    "astronomical s. 354 , 1165 driscol , p. 2006 , `` a comparison of frequentist and bayesian techniques in fitting keplerian orbits to radial velocity observations '' , master s thesis , san francisco state university .",
    "fischer , d.a .",
    "2005 , `` the n2k consortium .",
    "i.  a hot saturn planet orbiting hd 88133 '' astrophys .",
    "j. , 620 , 481 ford , e.b .",
    "2006 , `` improving the efficiency of markov chain monte carlo for analyzing the orbits of extrasolar planets '' astrophys .",
    "j. , 642 , 505 ford , e.b .",
    "2006 , `` adaptive scheduling algorithms for planet searches '' submitted to astronom .",
    "j. astro - ph/0412703 ford , e.b .",
    "2005 , `` quantifying the uncertainty in the orbits of extrasolar planets '' astronom .",
    "j. , 129 , 1706 ford , e.b .",
    "& rasio , f.a .",
    "2006 , `` on the relation between hot jupiters and the roche limit '' astrophys .",
    ", 638 , 45 ford , e.b . , lystad , v. , rasio , f.a .",
    "2005 , `` planet - planet scattering in the upsilon andromedae system '' nature , 434 , 873 gelman , a. , carlin , j.b . ,",
    "stern , h.s .",
    ", rubin , d.b .",
    "2003 , ( new york : chapman & hall / crc ) green , p. 1995",
    ", `` reversible jump markov chain monte carlo computation and bayesian model determination '' biometrica 82 , 711 .",
    "green , p.j .",
    "& ohagan , a. 1998 , `` carlin and chib do not need to sample from pseudo - priors . ''",
    "research report 98 - 1 , department of statistics , university of nottingham .",
    "gregory , p.c .",
    "2005 , bayesian logical data analysis for the physical sciences : a comparative approach with ` mathematica ' support ( cambridge : cambridge university press ) gregory , p.c .",
    "2005 , `` a bayesian analysis of extrasolar planet data for hd 73526 '' astrophys .",
    "j. , 631 , 1198 horne , j.h . & baliunas , s. l. 1986 , `` a prescription for period analysis of unevenly sampled time series '' astrophys .",
    "j. , 302 , 757 .",
    "laughlin , g. , butler , r. p. , fischer , d. a. , marcy , g. w. , vogt , s. s. , wolf , a. s. 2005 , `` the gj 876 planetary system : a progress report '' astrophys .",
    "j. , 622 , 1182 loredo , t. 2003 , bayesian inference and maximum entropy methods in science and engineering : 23rd international workshop , aip conf .",
    "707 , eds .",
    "erickson & y. zhai , 330 .",
    "( astro - ph/0409386 ) .",
    "loredo , t. 2006 , `` analyzing data from astronomical surveys : issues and directions '' this volume oh , m .- s . & berger , j.o .",
    "1993 , `` integration of multimodal functions by monte carlo importance sampling '' j.  amer .",
    "88 , 450 owen , a. & zhou , y. 2000 , `` safe and effective importance sampling '' j.  amer .",
    ", 95 , 135 press , w.  h. , teukolsky , s.  a. , vetterling , w.  t. , flannery , b.  p. 1992",
    ", _ numerical recipies in c : the art of scientific computing . _",
    "( new york : cambridge university press ) rivera , e. , lissuaer , j. , butler , p. , marcy , g. , vogt , s. , fischer , d. , brown , t. laughlin , g. 2005 , `` a @xmath2057.5 m@xmath206 planet orbiting the nearby star , gj 876 '' astrophys .",
    "j. , 634 , 625 .",
    "skilling , j. 2006 `` nested sampling for bayesian computations '' to appear in valencia / isba 8th world meeting on bayesian statistics .",
    "wright , j. t. 2005 , `` radial velocity jitter in stars from the california and carnegie planet search at keck observatory '' pub .  of the astronomical soc .  of the pacific , 117 , 657"
  ],
  "abstract_text": [
    "<S> the discovery of nearly 200 extrasolar planets during the last decade has revitalized scientific interest in the physics of planet formation and ushered in a new era for astronomy . </S>",
    "<S> astronomers searching for the small signals induced by planets inevitably face significant statistical challenges . </S>",
    "<S> for example , radial velocity ( rv ) planet searches ( that have discovered most of the known planets ) are increasingly finding planets with small velocity amplitudes , with long orbital periods , or in multiple planet systems . </S>",
    "<S> bayesian inference has the potential to improve the interpretation of existing observations , the planning of future observations and ultimately inferences concerning the overall population of planets . </S>",
    "<S> the main obstacle to applying bayesian inference to extrasolar planet searches is the need to develop computationally efficient algorithms for calculating integrals over high - dimensional parameter spaces . in recent years </S>",
    "<S> , the refinement of markov chain monte carlo ( mcmc ) algorithms has made it practical to accurately characterize orbital parameters and their uncertainties from rv observations of single - planet and weakly interacting multiple - planet systems .    </S>",
    "<S> unfortunately , mcmc is not sufficient for bayesian model selection , i.e. , comparing the marginal posterior probability of models with different parameters , as is necessary to determine how strongly the observational data favor a model with @xmath0 planets over a model with just @xmath1 planets . </S>",
    "<S> many of the obvious estimators for the marginal posterior probability suffer from poor convergence properties . </S>",
    "<S> we compare several estimators of the marginal likelihood and feature those that display desirable convergence properties based on the analysis of a sample data set for hd 88133b @xcite . </S>",
    "<S> we find that methods based on importance sampling are most efficient , provided that a good analytic approximation of the posterior probability distribution is available . </S>",
    "<S> we present a simple algorithm for using a sample from the posterior to construct a mixture distribution that approximates the posterior and can be used for importance sampling and bayesian model selection . </S>",
    "<S> we conclude with some suggestions for the development and refinement of computationally efficient and robust estimators of marginal posterior probabilities . </S>"
  ]
}