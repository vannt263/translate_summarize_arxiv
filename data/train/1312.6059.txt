{
  "article_text": [
    "liquid argon time projection chambers ( lar - tpcs ) , that are currently in development in various r&d programmes in europe , japan and the usa  @xcite , are acknowledged to be a detector technology capable of meeting the physics requirements of a next - generation neutrino oscillation experiment .",
    "they can provide simultaneous tracking and calorimetry of particles from neutrino interactions over a wide range of energies , with exquisite millimetric granularity , as demonstrated by results from icarus  @xcite . despite this advantage",
    ", it has proven difficult to achieve an automated software process that can fully reconstruct neutrino interactions , which will contain a mixture of ionisation tracks as well as electromagnetic and hadronic showers , especially when the neutrino interaction point is not known beforehand . in this paper , we describe a first application of using local principal curves  @xcite to automatically reconstruct neutrino interactions using three - dimensional lar - tpc data .    when a charged particle passes through a liquid argon medium it releases a stream of ionisation charge which can be measured by a tpc to provide a 3d trajectory in space",
    ". we can represent this data as a collection of `` hits '' , each of which contain the spatial cell co - ordinate information ( @xmath0 ) as well as the charge or energy deposit @xmath1 .",
    "the task of any reconstruction algorithm is to first obtain the hits from the detector output , then group these hits into clusters in order to identify the particles coming from the neutrino interaction , before extracting physics parameters such as momentum or energy from the reconstructed particles . here ,",
    "the first stage of the analysis chain , hit reconstruction , is assumed to have already taken place and the input is taken to be the complete set of hits in three spatial dimensions .",
    "our reconstruction algorithm takes the collection of hits for each neutrino interaction ( labelled as an event ) and forms clusters of associated hits in order to identify the particles .",
    "the mathematics and logic behind the local principal curve procedure is described in sect .",
    "[ sec : algo ] , while a description of the simulation methods used to obtain samples of neutrino interaction events in liquid argon is given in sect .",
    "[ sec : sim ] .",
    "the performance of the reconstruction algorithm is discussed in sects .",
    "[ sec : mup ] and  [ sec : ep ] , with details about using it for track - shower discrimination provided in sect .",
    "[ sec : shower ] . finally , we summarise our findings in sect .  [",
    "sec : con ] .",
    "the key component of the method we are proposing is the mean shift procedure , a versatile tool which is popular mainly in the computer vision community  @xcite .",
    "in essence , the mean shift moves a point to the local mean of the data around this point . for our case ,",
    "the points are the positions @xmath2(@xmath3 , @xmath4 , @xmath5 ) of all of the hits , which are each scaled by their range , defined to be the difference between the largest and smallest values of @xmath2 ( though it is also possible not to scale at all , or to scale by other measures of spread such as the standard deviation ) .",
    "the local mean @xmath6 for a set of @xmath7 hits is defined as @xmath8 where the weights @xmath9 , which determine the size and shape of the local neighbourhood at a chosen location @xmath10 , are monotonically decreasing with increasing distance from @xmath10 to @xmath2 .",
    "a common choice of weights is the gaussian density function @xmath11 where @xmath12 is the energy deposit for hit @xmath13 and @xmath14 is a constant bandwidth parameter that steers the size of the local neighbourhood .",
    "the weights play the role of `` kernel '' functions and can , if desired , be replaced by other functions such as a triangular - shaped or truncated probability density . in our scenario , where the co - ordinates are all measured on the same scale , we keep the gaussian form and use the same bandwidth parameter for all three directions .",
    "the value of @xmath14 can be selected through a coverage measure  @xcite , though for our purposes there is not much reason for this , as roughly the same bandwidth , @xmath15 after scaling , will be usable in a wide range of liquid argon detectors . note that the normalisation denominator @xmath16 can be left out of the kernel function since it is a constant common factor for all hit points and has no effect on the properties of the principal curve .        from eq .",
    "[ eqn : locmean ] , we define the _ mean shift _ as @xmath17 this quantity has many interesting properties  @xcite , one of which being that @xmath18 , where @xmath19 is a density estimate of @xmath20 at @xmath10 .",
    "this implies that the mean shift is a vector pointing into a denser direction of the data space . when carried out iteratively , starting at @xmath21",
    ", one can show  @xcite that the series of local means @xmath22 converges to a local mode @xmath23 of @xmath24 where @xmath25 .",
    "this has the attractive property of being a clustering technique ; a trajectory can be formed by running the mean shift procedure on each data point @xmath2 iteratively until convergence is achieved .    though the convergence towards a local mode of the density is an appealing property , it has the negative side effect of getting trapped at the local modes and will not move beyond them . therefore , some modification of eq .",
    "[ eqn : itmeans ] is needed which ensures that particle trajectories are pursued beyond local modes .",
    "the simple idea is to alternate the mean shift with a local principal component step  @xcite .",
    "more specifically , let @xmath26 be the normalised eigenvector corresponding to the largest eigenvalue of the local symmetric @xmath27 covariance matrix @xmath28 starting from a given point @xmath21 , we set @xmath29 and iterate between    1 .   computing the local centre of mass : @xmath30 2 .   finding the next local neighbourhood location : @xmath31    where @xmath32 is a given step size ( of the same order as @xmath14 ) and @xmath33 .",
    "the local principal curve is then defined as the series of local centres of mass @xmath34 . in our case ,",
    "the starting point @xmath21 is chosen to be the position of the nearest hit to the energy - weighted centroid of all of the hits .",
    "alternatively , @xmath35 can be set either at random from the @xmath2 points , set by hand , or be chosen to be a local density mode using an initial mean shift procedure as outlined in refs .",
    "the above iteration is repeated until either the required number of lpc points ( @xmath36 ) is obtained , or the path length along the local curve is no longer increasing ( convergence ) .",
    "as we will see later , the angle @xmath37 between the normalised eigenvector @xmath38 and the preceeding eigenvector @xmath39 can be used to infer the presence of feature points , corresponding to drops in the angle profile along the principal curve , which provide evidence for particle decays or possible interactions between particles .    in order to provide inertia for reducing the chance of the local principal curve deviating too much from the general direction of neighbouring points ,",
    "@xmath38 is multiplied by an angle penalisation term @xmath40 , where @xmath41 is usually set to 2 , when the next local neighbourhood location is found using eq .",
    "[ eqn : u ] : @xmath42 a technicality to be mentioned is that , for a given @xmath43 , the first eigenvector may equally well be @xmath44 as well as @xmath45 , so for each @xmath46 , one needs to check whether @xmath47 and set @xmath48 otherwise  @xcite .    based on asymptotic considerations  @xcite",
    ", it can be shown that the sequence of lpc points @xmath34 converges to a point @xmath49 close to the boundary of the cloud of data points with the property @xmath50 . in practical terms",
    ", convergence is reached when the cumulative path length difference between neighbouring local curve points , divided by their sum , is below a chosen threshold typically set at @xmath51 : @xmath52 where @xmath53 and @xmath54 . in order to pick up features that may be present in the tails of the point cloud , convergence is delayed by multiplying the kernel bandwidth @xmath14 with a correction factor @xmath55 if @xmath56 is below a certain boundary limit @xmath57 , which is typically set to be @xmath58 ( which must be larger than the threshold for @xmath56 defined in eq .",
    "[ eqn : r ] ) .",
    "initially , @xmath55 is set to unity , but when @xmath59 , @xmath55 is reduced by the factor @xmath60 , and @xmath14 in eq .",
    "[ eqn : weight ] needs to be replaced by @xmath61 . if @xmath62 , then @xmath55 is increased by 1% but must not exceed unity . after convergence , or",
    "after we have obtained @xmath63 lpc points , the algorithm has to be re - started with @xmath21 in order to cover the other side of the data cloud , where the next neighbourhood location is defined as @xmath64 and the lpc algorithm continues as usual .",
    "note that the cumulative path lengths @xmath65 form a discrete parameterisation of the principal curve , which can be refined via a cubic spline interpolation towards a continuous parametrisation if necessary  @xcite .",
    "this can be useful since it allows the option to plot , and regress , physical quantities such as the amount of deposited energy as a function of distance along the particle trajectory covered by the local principal curve .",
    "figure  [ fig : algorithm ] summarises the complete logic flow of the lpc algorithm .",
    "once the lpc points are found , they are scaled - up using the initial co - ordinate ranges of the hits .",
    "the important parameters with suggested ( scaled ) values are given in table  [ tab : lpcparam ] .",
    "these parameters are optimised to provide the best overall reconstruction performance for specific classes of neutrino interaction events described in sects .",
    "[ sec : mup ] and  [ sec : ep ] .",
    ".default parameters for the lpc algorithm [ cols= \" < , < \" , ]     [ tab : epeff ]    despite most of the electrons being correctly found and identified as showers , about 25% of their hits are not included in the ( main ) cluster .",
    "some of these missing hits are at the outer edge of the shower hit cloud , with @xmath66 residuals larger than 10 cm . however , most of them are misclassified as a separate cluster within the main shower , which happens if more than one vertex has been reconstructed .",
    "this will have a direct effect on the reconstructed energy of the electron cluster , which is simply taken to be the sum of the energy deposits @xmath12 of all of the associated hits .",
    "figure  [ fig : epenergies ] shows the generated quenched energy distributions for electrons and protons ( 770mev @xmath67 events ) , as well as the reconstructed energies of the electron and proton clusters when most of their hits have the correct particle type .",
    "we can see that there is a secondary peak below 100mev for the electron distribution , corresponding to the missing hits in the main cluster .",
    "furthermore , most of the protons that are not reconstructed have generated ( quenched ) energies below 50mev ; the hits from these protons are instead associated to the main electron cluster , leading to reconstructed energies that are higher than the generated values .",
    "figure  [ fig : eperesolution ] shows the distributions of the fractional energy difference @xmath68 , where @xmath69 is the reconstructed cluster energy and @xmath70 is the generated particle energy .",
    "the @xmath71 distribution for electrons has a main single - gaussian peak with a width corresponding to a quenched energy resolution of approximately 8% .",
    "the secondary peak occurs for @xmath71 values below @xmath72% , and corresponds to additional clusters found inside the electron shower .",
    "the @xmath71 distribution for correctly identified protons has a very narrow peak , which is to be expected since the proton hit efficiency and purity are both above 92% . fitting a double gaussian function ( common mean , two widths ) to this peak gives an effective quenched energy resolution approximately equal to 0.3% for protons .",
    "this compares well to the effective energy resolution of approximately 0.2% for the reconstructed clusters in the previously mentioned muon - proton sample .",
    "so far we have only looked at low - energy ( @xmath73gev ) neutrino interactions .",
    "figure  [ fig : lagunaevent ] shows the lpc reconstruction of a high energy ( @xmath74gev ) electron - proton event .",
    "the electron shower extends over a very wide area , which means that the number of points in the principal curve needs to be significantly increased from around 100 to at least 500 in order to cover most of the core region of the shower , following the hits along the principal axis .",
    "additionally , the scaled kernel width needs to be increased to the value 0.11 for a step size of 0.06 .",
    "a close - up view of the event near the primary vertex region shows that the start of the electron shower is almost track - like , as was observed for the lower energy electrons . in this region ,",
    "the principal curve starts to move away from the electron hits towards the proton track . during this transition ,",
    "the sheer number of hits in the shower start to push the principal curve back towards itself . however , the local nature of the algorithm forces the points back onto the proton track .",
    "this push - and - pull effect creates two feature points which are actually close enough to create a merged range of lpc points that are used for finding the primary vertex location via the extended straight line method described in sect .",
    "[ sec : mup ] . inside the electron shower",
    ", there is an additional feature point near the end of the principal curve , owing to the rather wide spread of hits at the edge of the shower affecting the convergence of the curve , producing large angles between the remaining eigenvectors .    in most high - energy events ,",
    "the algorithm finds multiple feature points inside the core of the shower which adversely affects the performance of correctly finding the primary vertex location , especially if the proton track has a very small range and is not well separated from the shower . in order to consistently reconstruct high - energy events correctly ,",
    "other tools and methods need to be developed and incorporated into the lpc algorithm .",
    "we have presented a local principal curve algorithm that can reconstruct neutrino interaction events in liquid argon .",
    "the algorithm creates a series of ( three - dimensional ) points that follows the local density of hits .",
    "it does so by calculating the localised mean shift , which changes direction based on the largest eigenvector obtained from the @xmath27 covariance matrix of a set of weights which determine the size and shape of the local neighbourhood of points .",
    "differences in the angle @xmath37 between consecutive eigenvectors can produce peaks in the @xmath75 distribution when the principal curve is rapidly changing direction .",
    "these peaks correspond to feature points which highlight the presence of interaction vertices , which can be reconstructed by finding the point of closest approach between two straight line sections associated to nearby hits on either side of a given feature point .",
    "clusters can then be formed by continuing along the principal curve direction initially given by each straight line section and adding hits that are closest to the remaining lpc points .",
    "the residual distance between hits and their nearest lpc point , together with a measure of the size of a convex hull encompassing all of the hits in a cluster , can be used to discriminate showers from tracks .",
    "the reconstruction performance of the algorithm with regards to vertexing , clustering , energy resolution and track - shower identification has been tested on 770mev neutrino interaction muon - proton ( ccqe ) and electron - proton events . for high - energy events ,",
    "further work is required to better use the information provided by the increased number of feature points .",
    "there are possible further uses of this algorithm .",
    "for example , it is straightforward to use it to identify clusters when the hit positions are only known in two dimensions ; the third co - ordinate for all hits is just set to zero or ignored , and all other procedures remain the same .",
    "additionally , it should be possible to use the algorithm to find feature points and reconstruct clusters for events when more than two particles originate from a common vertex point . here",
    ", points along the principal curve will only be able to follow the two main particles which will contain the majority of the hits . to find the other particles , the hits associated to the two reconstructed clusters need to be removed and the algorithm re - run on the remaining hits .",
    "however , care must be taken to avoid removing hits unnecessarily within such a procedure .",
    "a possible way to proceed is to use the ratio between the first and second largest eigenvalues of the covariance matrix defined in eq .",
    "[ eqn : sigma ] , which may indicate the presence of bifurcation ( `` branching '' ) points that can act as starting locations for further principal curves . at the time of writing , we have not yet studied a strategy for reconstructing multi - particle final state interactions .",
    "we thank daniel brunt , harmanjeet khera and jamie wynn who all worked with the group as part of the university of warwick project student programme .",
    "this work was financially supported by the science and technology facilities council consolidated grant st / h00369x/1 and by the european community under the european commission framework programme 7 grant laguna - lbno / fp7-infrastructures/284518 .",
    "m. ester , h.p .",
    "kriegel , s. joerg , x. xu , in _ proceedings of the 2nd international conference on knowledge discovery and data mining _ , portland , 1996 , ed .",
    "by e. simoudis , j. han , u.m .",
    "fayyad ( aaai press , 1996 ) , p. 226"
  ],
  "abstract_text": [
    "<S> a local principal curve algorithm has been implemented in three dimensions for automated track and shower reconstruction of neutrino interactions in a liquid argon time projection chamber . </S>",
    "<S> we present details of the algorithm and characterise its performance on simulated data sets . </S>"
  ]
}