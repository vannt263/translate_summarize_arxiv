{
  "article_text": [
    "bifurcation diagrams are often used for the analysis of deterministic models of chemical systems . in recent years , they have also been applied to models of biological ( biochemical ) systems .",
    "for example , the cell - cycle model of tyson _ et al . _",
    "@xcite is a system of ordinary differential equations ( odes ) which describes the time evolution of concentrations of biochemical species involved in cell - cycle regulation .",
    "the dependence of the qualitative behaviour on the parameters of the model is studied using standard bifurcation analysis of odes @xcite .",
    "biological systems are intrinsically noisy because of the low copy numbers of some of the biochemical species involved . in such a case , one has to use stochastic simulation algorithms ( ssas ) to include the intrinsic noise in the modelling @xcite .",
    "the ssa models use the same set of parameters as the ode models .",
    "however , even if we choose the same values of the rate constants for both the ssa model and the ode model , the behaviour of the system can differ qualitatively @xcite .",
    "for example , the transition from the @xmath0 phase to mitosis in the model of tyson _ et al .",
    "_ is governed by a sniper ( saddle - node infinite period ) bifurcation @xcite . in the ode",
    "setting , a sniper bifurcation occurs whenever a saddle and a stable node collapse into a single stationary point on a closed orbit ( as a bifurcation parameter is varied ) .",
    "in particular , the limit cycle is born with infinite period at the bifurcation point .",
    "if we use the ssa model instead of odes , the bifurcation behaviour will be altered .",
    "as we will see in section [ secssasim ] , intrinsic noise causes oscillations with finite average period at the deterministic bifurcation point .",
    "moreover , the stochastic system oscillates even for the parameter values for which the deterministic model does not have a periodic solution .",
    "clearly , there is a need to understand the changes in the bifurcation behaviour if a modeller decides to use ssas instead of odes . in this paper",
    ", we focus on the sniper bifurcation .",
    "however , the approach presented can be applied to more general chemical systems .    in section [ secssasim ]",
    ", we introduce a simple chemical system for which the ode model undergoes a sniper bifurcation .",
    "we use this illustrative example to motivate the phenomena which we want to study .",
    "the study of stochastic chemical systems in the neighbourhood of determistic bifurcation points will be done using the chemical fokker - planck equation @xcite .",
    "the analysis of the fokker - planck equation is much easier in one dimension .",
    "thus , we start with an analysis of a simple one - dimensional chemical switch in section [ sec1dswitch ] . using the one - dimensional setting , we can show some advantages and disadvantages of our approach without going into technicalities .",
    "in section [ secnumerfpres ] , we present a computer assisted analysis of the ssas by exploiting the chemical fokker - planck equation , using the illustrative model from section [ secssasim ] . in section [ secanalfpres ] ,",
    "we provide core analytical results .",
    "we study the dependence of the period of oscillation on the parameters of the model , namely kinetic rate constants and the size of the system ( number of molecules present ) .",
    "we derive analytical formulae for the period of oscillation using the asymptotic expansion of the two - dimensional fokker - planck equation .",
    "finally , in section [ secconclusion ] , we present our conclusions .",
    "we consider two chemical species @xmath1 and @xmath2 in a well - mixed reactor of volume @xmath3 which are subject to the following set of seven chemical reactions @xmath4 @xmath5 the first reaction is the production of the chemical @xmath2 from a source with constant rate @xmath6 per unit of volume , i.e. the units of @xmath6 are @xmath7 , see ( [ sniperparam ] ) below .",
    "the second reaction is the conversion of @xmath2 to @xmath1 with rate constant @xmath8 and the third reaction is the degradation of @xmath1 with rate constant @xmath9 .",
    "the remaining reactions are of second - order or third - order .",
    "they were chosen so that the mean - field description corresponding to ( [ model1])([model2 ] ) undergoes a sniper bifurcation as shown below . clearly",
    ", there exist many other chemical models with a sniper bifurcation , including the more realistic model of the cell - cycle regulation @xcite .",
    "the advantage of the model ( [ model1])([model2 ] ) is that it involves only two chemical species @xmath1 and @xmath2 , making the visualization of our results clearer : two - dimensional phase planes are much easier to plot than the phase spaces of high - dimensional models .",
    "the generalization of our results to models involving more than two chemical species will be discussed in section [ secconclusion ] .",
    "let @xmath10 and @xmath11 be the number of molecules of the chemical species @xmath1 and @xmath2 , respectively . the concentration of @xmath1 ( resp .",
    "@xmath2 ) will be denoted by @xmath12 ( resp .",
    "@xmath13 ) .",
    "if we have enough molecules of @xmath1 and @xmath2 in the system , we often describe the time evolution of @xmath14 and @xmath15 by the mean - field ode model . using ( [ model1])([model2 ] ) ,",
    "this can be written as @xmath16 we choose the values of the rate constants as follows : @xmath17 ,   \\quad   & & k_{2d } = 1 \\ ; [ \\mbox{sec}^{-1 } ] , \\quad   k_{3d } = 33 \\ ; [ \\mbox{sec}^{-1 } ] , \\quad   k_{4d } = 11 \\ ; [ \\mbox{sec}^{-1 } \\ , \\mbox{mm}^{3 } ] , \\nonumber \\\\ k_{5d } = 1 \\ ; [ \\mbox{sec}^{-1 } \\ , \\mbox{mm}^{6 } ] , \\quad   & & k_{6d } = 0.6 \\ ; [ \\mbox{sec}^{-1 } \\ , \\mbox{mm}^{3 } ] , \\quad   k_{7d } = 0.13 \\ ; [ \\mbox{sec}^{-1 } \\ , \\mbox{mm}^{6 } ] , \\label{sniperparam}\\end{aligned}\\ ] ] where we have included the units of each rate constant to emphasize the dependence of each rate constant on the volume .",
    "from now on , we will treat all rate constants as numbers , dropping the corresponding units , to simplify our notation .",
    "the nullclines of the ode system ( [ eq1])([eq2 ] ) are plotted in figure  [ figsnipernullclines](a ) .",
    "the @xmath18-nullcline ( resp .",
    "@xmath19-nullcline ) is given by @xmath20 ( resp .",
    "@xmath21 ) .",
    "the nullclines intersect at three steady states which are denoted as sn ( stable node ) , saddle and un ( unstable node ) .",
    "we also plot illustrative trajectories which start close to each steady state ( thin black lines ) .",
    "6 mm 2.1 in -8 mm 2.1 in -8 mm    as the parameter values change , the stable node ( sn ) and the saddle can approach each other . if they coalesce into one point ( with the dominant eigenvalue equal to 0 ) , a limit cycle with infinite period appears .",
    "shifting the nullclines further apart , we obtain a dynamical system with periodic solutions .",
    "this is demonstrated in figure  [ figsnipernullclines](b ) where we plot the nullclines of ( [ eq1])([eq2 ] ) for @xmath22 , with the other parameter values given by @xmath23 .",
    "an illustrative trajectory ( thin black line ) converges to the limit cycle .",
    "we see that there is a sniper ( saddle - node infinite period ) bifurcation as the parameter @xmath6 is increased from 12 to 13 .",
    "the main goal of this paper is to understand and analyse changes in the behaviour of chemical systems when deterministic ode models are replaced by ssas , i.e. when the intrinsic noise is taken into account .",
    "the stochastic model of the chemical system ( [ model1])([model2 ] ) is given by the gillespie ssa @xcite which is equivalent to solving the corresponding chemical master equation  see appendix [ appendixcfpe ] .",
    "we denote the reaction with the rate constant @xmath24 , @xmath25 , as the reaction @xmath26 .",
    "note that the reversible reaction in ( [ model1 ] ) is considered as two separate chemical reactions . to use the gillespie ssa",
    ", we have to specify the propensity function @xmath27 , @xmath25 , of each chemical reaction in ( [ model1])([model2 ] ) .",
    "the propensity function is defined so that @xmath28 is the probability that , given @xmath29 and @xmath30 , one @xmath26 reaction will occur in the next infinitesimal time interval @xmath31 .",
    "for example , @xmath6 is the rate of production of @xmath2 molecules per unit of volume .",
    "thus , @xmath32 is the rate of production of @xmath2 molecules per the whole reactor of volume @xmath3 .",
    "consequently , the probability that one @xmath2 molecule is produced in the infinitesimally small time interval @xmath31 is equal to @xmath33 , i.e. the propensity function of the reaction @xmath34 is @xmath35 to specify other propensity functions , we first scale the rate constant @xmath24 with the appropriate power of the volume @xmath3 , namely we define @xmath36 then the propensity function of the reaction @xmath26 , @xmath37 , is given as the product of the scaled rate constant and numbers of available reactant molecules , namely @xmath38 @xmath39 note that the propensity functions of the reactions @xmath40 and @xmath41 are proportional to the number @xmath42 of available pairs of @xmath1 molecules , and not to @xmath43 ; similarly , @xmath44 is proportional to the number @xmath45 of available triplets of @xmath1 molecules and not to @xmath46 . for a general discussion of the propensity functions",
    "see @xcite .    using ( [ propfunctions ] ) and the gillespie ssa , we can simulate the stochastic trajectories of ( [ model1])([model2 ] ) . in figure  [ fig12timeevol](a )",
    ", we compare the time evolution of @xmath1 given by the stochastic ( gillespie ssa ) and deterministic ( the ode system ( [ eq1])([eq2 ] ) ) models .",
    "we use the same parameter values ( [ sniperparam ] ) and the same initial condition @xmath47 = [ 40,480]$ ] for both , stochastic and deterministic , simulations .",
    "the reactor volume is @xmath48 .    2.05 in -8 mm 2.05 in -8 mm    in figure  [ fig12timeevol](b )",
    ", we plot both trajectories in the @xmath18-@xmath19 plane .",
    "we see that the solution of the deterministic equations converges to a steady state while the stochastic model has oscillatory solutions . in figure",
    "[ fig13timeevol ] , we present results obtained by the stochastic simulation of ( [ model1])([model2 ] ) for @xmath22 .",
    "the other parameters are the same as in figure  [ fig12timeevol ] .",
    "we see that both the stochastic and deterministic models oscillate for @xmath22",
    ".    2.05 in -8 mm 2.05 in -8 mm    an important characteristic of oscillating systems is their period of oscillation .",
    "this is a well - defined number for the deterministic ode model , but in the stochastic case the periods of individual oscillations vary .",
    "thus , in the stochastic model we are interested in the mean period of oscillation ( averaged over many periods ) .",
    "the mean period of oscillation is plotted in figure  [ figperosc](a ) as a function of the rate constant @xmath6 ( blue circles ) .",
    "it was computed as an average over 10,000 periods for each of the presented values of @xmath6 .",
    "the starting / finishing point of every period was defined as the time when the simulation enters the half - plane @xmath49 .",
    "more precisely , we start the computation of each period [ pagedefcycle ] whenever the trajectory enters the area @xmath49",
    ". then we wait until @xmath50 before we test the condition @xmath49 again .",
    "the extra condition @xmath50 guarantees that possible small random fluctuations around the point @xmath51 are not counted as two or more periods . the period of oscillation of the ode model ( [ eq1])([eq2 ] )",
    "is plotted in figure  [ figperosc](a ) as the red line .",
    "it asymptotes to infinity as @xmath52 for @xmath53 where @xmath54 is the bifurcation value of the parameter @xmath6 .    in the limit @xmath55 ( which is the so - called thermodynamic limit @xcite ) , the stochastic description converges to the ode model @xmath56-@xmath57 ,",
    "that is , the probability distributions become dirac - like and their averages converge to the solution of the odes @xmath56-@xmath57 for @xmath55 .",
    "the dependence of the period of oscillation on the volume @xmath3 is shown in figure  [ figperosc](b ) where we fix @xmath6 equal to the bifurcation value @xmath54 of the ode model and we vary the volume @xmath3 .",
    "the other parameter values are given by @xmath23 . since @xmath58 ,",
    "the period of oscillation of the ode model is infinity . in figure  [ figperosc](b )",
    ", we see that the period of oscillation of the stochastic model is an increasing function of @xmath3 .",
    "it approaches the period of oscillation of the ode model ( infinity ) as @xmath55 .    2.05 in -8 mm 2.05 in -8 mm    the estimates of the period of oscillation ( blue circles in figure  [ figperosc ] )",
    "were obtained as averages over 10,000 periods of the gillespie ssa .",
    "such an approach is computationally intensive .",
    "the goal of this paper is to show that we can obtain the same information by solving and analyzing the chemical fokker - planck equation . in section [ secnumerfpres ]",
    ", we present results obtained by solving the fokker - planck equation using a suitable finite element method . in section [ secanalfpres ]",
    ", we use the asymptotic analysis of the fokker - planck equation to derive explicit formulae for the period of oscillation , as a function of the rate constants and as a function of the volume @xmath3 .",
    "the chemical fokker - planck equation which corresponds to the chemical system ( [ model1])([model2 ] ) is a two - dimensional partial differential equation . in particular , some parts of its analysis are more technical than the analysis of one - dimensional problems .",
    "to get some insights into our approach , we analyse a one - dimensional chemical switch in the following section .",
    "we will present only methods which are of potential use in the higher - dimensional settings .",
    "a generalization of the analysis to the chemical sniper problem is shown in section [ secanalfpres ] .",
    "we consider a chemical @xmath1 in a container of volume @xmath3 which is subject to the following set of chemical reactions ( such a system was introduced by schlgl @xcite ) @xmath59 let @xmath60 be the number of molecules of the chemical @xmath1 . the classical deterministic description of the chemical system ( [ schlogl ] )",
    "is given by the following mean - field ode for the concentration @xmath61 : @xmath62 to obtain the stochastic description , we first scale the rate constants with the appropriate powers of the volume @xmath3 , by defining @xmath63 then the propensity functions of the chemical reactions ( [ schlogl ] ) are given by @xmath64 i.e. the probability that , given @xmath65 , the @xmath66-th reaction occurs in the time interval @xmath67 is equal to @xmath68 .",
    "given the propensity functions ( [ propschlogl ] ) , we can simulate the time evolution of the system ( [ schlogl ] ) by the gillespie ssa @xcite .",
    "we choose @xmath69 in what follows , i.e. @xmath70 , @xmath71 in figure  [ figtrajhistschlogl](a ) , we plot illustrative results obtained by the gillespie ssa for the following set of rate constants @xmath72    2.05 in -8 mm 2.05 in -8 mm    we see that the system ( [ schlogl ] ) has two favourable states for the parameter values ( [ paramschlogl ] ) .",
    "we also plot stationary distributions ( yellow histograms ) obtained by long time simulation of the gillespie ssa in figure  [ figtrajhistschlogl](b ) . the chemical master equation corresponding to ( [ schlogl ] )",
    "can be written as follows @xmath73 \\label{cmeschlogl}\\ ] ] where @xmath74 is the probability that @xmath65 , i.e. the probability that there are @xmath18 molecules of the chemical species @xmath1 at time @xmath75 in the system .",
    "the stationary solution of this infinite set of odes can be found in a closed form @xcite , i.e. one can find an exact formula for the stationary distribution plotted in figure  [ figtrajhistschlogl](b ) . however , our goal is not to solve the well - known schlgl system using its master equation .",
    "we want to motivate the approach which is used later for the chemical sniper problem , which is based on the approximate description of chemical systems given by the chemical fokker - planck equation @xcite , see appendix [ appendixcfpe ] .",
    "to write this equation , we have to consider @xmath74 as a function of the real variable @xmath18 , i.e. we smoothly extend the function @xmath74 to non - integer values of @xmath18 . using appendix [ appendixcfpe ] , the chemical fokker - planck equation for the chemical system ( [ schlogl ] ) is @xmath76 where the drift coefficient @xmath77 and the diffusion coeficient @xmath78 are given by @xmath79 @xmath80 the stationary distribution @xmath81 is a solution of the stationary equation corresponding to ( [ fpeschlogl ] ) , namely @xmath82 integrating over @xmath18 and using the boundary conditions @xmath83 as @xmath84 , we obtain @xmath85 \\label{psvd}\\ ] ] where @xmath86 is the constant given by the normalization @xmath87 the function @xmath88 is plotted in figure  [ figtrajhistschlogl](b ) for comparison as the blue line .",
    "we see that the chemical fokker - planck equation gives a very good description of the chemical system ( [ schlogl ] ) .",
    "the fokker - planck equation ( [ fpeschlogl ] ) is equivalent to the langevin equation ( it stochastic differential equation ) @xmath89 where @xmath90 represents white noise .",
    "in particular , the deterministic part of the dynamics is given by the ode @xmath91 substituting ( [ eqvx ] ) for @xmath92 , using ( [ rateconstantsvolumeschlogl ] ) and dividing by @xmath3 , we obtain the following ode for the concentration @xmath12 : @xmath93 this equation slightly differs from the classical mean - field deterministic description ( [ detschloglode ] ) , but the equations ( [ detschloglode ] ) and ( [ detschlogldriftode ] ) are equivalent in the limit of large @xmath1 in which @xmath94",
    ". this can also be thought of as the limit of large @xmath3 after a suitable non - dimensionalization .",
    "let us note that the chemical fokker - planck equation is actually derived from the kramers - moyal expansion in the limit of large @xmath3 by keeping only the first and the second derivatives in the expansion @xcite .",
    "let @xmath95 and @xmath96 be favourable states of the chemical system ( [ schlogl ] ) which we define as the arguments of the maxima of @xmath88 ( given by ( [ psvd ] ) ) .",
    "let @xmath97 be the local minimum of @xmath88 which lies between the two favourable states , so that @xmath98 .",
    "we can find the local extrema @xmath99 @xmath100 and @xmath96 of @xmath88 as the solutions of @xmath101 , which , using ( [ psvd ] ) , is equivalent to the cubic equation @xmath102 another way to define the favourable states of the system is by considering the stationary points of the ode ( [ detschlogldriftode ] ) , i.e. the points where the drift coefficient is zero : @xmath103 this cubic equation has three roots which we denote @xmath104 , @xmath105 and @xmath106 , where @xmath107 let us note that @xmath108 , @xmath109 and @xmath110 because the equation ( [ xfueq ] ) differs from the equation ( [ yfueq ] ) by the additional term @xmath111 . in figure  [ figxyfuexittime](a ) , we plot @xmath112 @xmath113 @xmath106 as functions of @xmath114 .",
    "the other parameter values are chosen as in ( [ paramschlogl ] ) .    2.05 in -8 mm 2.05 in -8 mm    we also plot @xmath99 @xmath115 @xmath96 .",
    "we see that there are two critical values of the parameter @xmath114 , namely @xmath116 and @xmath117 . if @xmath118 , then @xmath119 , while if @xmath120 , then @xmath121 , i.e. the number of local maxima of @xmath88 changes at @xmath122 . from our point of view",
    ", the more interesting critical value is @xmath123 , corresponding to the bifurcation value of the deterministic description ( [ detschlogldriftode ] ) , but it is important to note that this value differs from the value @xmath124 . to find the value of @xmath123 , we solve the quadratic equation @xmath125 .",
    "the relevant root is given by : @xmath126 the value of @xmath123 is determined by the equation @xmath127 , giving @xmath128 for the parameter values ( [ paramschlogl ] ) , we obtain @xmath129 and @xmath130    let @xmath131 be the average time to leave the interval @xmath132 given that we start at @xmath133 . using the backward kolmogorov equation ( adjoint equation to the fokker - planck equation ( [ fpeschlogl ] ) ) , one can derive a differential equation for @xmath131 ( see @xcite and also appendix [ appendixmtime ] ) , namely @xmath134 with boundary conditions @xmath135 solving ( [ equationfortau ] ) , we obtain @xmath136 \\int_{-\\infty}^y \\frac{1}{d(x ) } \\exp \\left [ \\int_{0}^x \\frac{v(z)}{d(z ) } \\ , { \\mbox{d}z}\\right ] { \\mbox{d}x}\\\\ & = & - \\frac{1}{d(y ) p_s(y ) } \\int_{-\\infty}^y p_s(x ) { \\mbox{d}x},\\end{aligned}\\ ] ] where @xmath88 is the stationary distribution ( [ psvd ] ) . integrating over @xmath19 in the interval @xmath137 and using ( [ bctauschlog ] ) , we obtain @xmath138 the important characteristic of the system is the mean time @xmath139 for the system to switch from the favourable state @xmath95 to the favourable state @xmath140 to determine this we set @xmath141 and we define @xmath139 precisely as the mean time to leave the interval @xmath132 given that @xmath142 .",
    "this definition provides a natural extension of the mean switching time for values @xmath143 .",
    "note that the number @xmath144 in ( [ bdeffortau ] ) is the value of @xmath145 at the critical point @xmath122 . using ( [ tauzformula ] )",
    ", we can compute @xmath139 as the integral @xmath146 \\int_{-\\infty}^y \\frac{1}{d(x ) } \\exp \\left [ \\int_{0}^x \\frac{v(z)}{d(z ) } \\,{\\mbox{d}z}\\right ] { \\mbox{d}x}{\\mbox{d}y}\\label{taudef2}\\ ] ] where @xmath147 is given by ( [ bdeffortau ] ) .",
    "let us note that we could also put the right boundary @xmath147 at the points @xmath97 or @xmath105 . if the number of molecules reaches the value @xmath97 ( resp .",
    "@xmath105 ) , then there is , roughly speaking , 50% chance to return back to the favourable state @xmath95 and 50% chance to continue to the second favourable state @xmath96",
    ". thus the mean switching time between the states could be estimated by multiplying the time to reach the point @xmath97 ( resp .",
    "@xmath105 ) by the factor of 2 .",
    "the problem with this definition is that @xmath109 .",
    "the difference between the results obtained by choosing the escape boundary at @xmath97 or @xmath105 is not negligible because the drift is small between @xmath97 and @xmath105 . on the other hand ,",
    "the drift is large at @xmath145 .",
    "replacing @xmath145 by any number close to it , e.g. by @xmath148 , leads to negligible errors . in that sense ,",
    "the boundary @xmath147 given by ( [ bdeffortau ] ) yields a more robust definition of the mean switching time .",
    "the other reason for presenting analysis for the definition ( [ taudef2 ] ) is that it is naturally transferable to the chemical sniper problem which is the main interest of this paper .    in figure  [ figxyfuexittime](b )",
    ", we compare the results obtained by the gillespie ssa and by formula ( [ tauzformula ] ) for the parameter values ( [ paramschlogl ] ) and the right boundary at @xmath149 .",
    "we have @xmath150 , @xmath151 and @xmath152 for the parameter values ( [ paramschlogl ] ) . in figure  [ figxyfuexittime](b ) , we plot mean exit times computed as averages over @xmath153 exits from the domain @xmath154 $ ] , starting at @xmath155 for every integer value of @xmath156 the results are in excellent agreement with the results computed by the formula ( [ tauzformula ] ) .    in figure  [ figxyfuexittime](b ) , we also see that there is no significant difference between the exit times if we start at @xmath157 or @xmath158 for @xmath159 .",
    "this justifies the choice @xmath158 in the definition of the mean switching time @xmath139 .",
    "if @xmath160 , than @xmath95 is close to @xmath97 and the results obtained by the starting point at @xmath158 and at @xmath157 will differ . in the definition ( [ taudef2 ] )",
    ", we use @xmath158 for any value of @xmath114 because ( i ) the results for @xmath158 will provide some insights into the estimation of the period of oscillation of the sniper problem studied later ; ( ii ) the results are robust to small changes in the initial condition @xmath158 ; ( iii ) the starting point @xmath158 is defined for any value of @xmath114 ( note that @xmath95 is not defined for @xmath143 ) .    in the remainder of this section",
    ", we provide approximations of @xmath139 defined by the formula ( [ taudef2 ] ) .",
    "we fix the parameters @xmath161 , @xmath162 and @xmath163 as in ( [ paramschlogl ] ) and we vary the parameter @xmath114 . in section [ secouter ] , we provide the estimation of @xmath139 for @xmath164 ( outer solution ) . in section [ secinner ]",
    ", we provide the estimation of @xmath139 for @xmath165 ( inner solution ) .",
    "finally , in section [ secmatching ] , we match the inner and outer solutions to obtain the uniform approximation for any @xmath114 .",
    "we note here that one could approximate @xmath139 by approximating the integral ( [ taudef2 ] ) . using the method of steepest descent ,",
    "we would obtain the generalization of the well - known kramers formula @xmath166 } { d(x_u ) \\sqrt{\\phi^{\\prime\\prime } ( x_{f1 } ) |\\phi^{\\prime\\prime } ( x_u)| } } \\label{taukramers}\\ ] ] where @xmath167 is defined by @xmath168 this approximation is valid for @xmath164 @xcite .",
    "@xcite suggest another generalization of the kramers formula replacing @xmath169 in the denominator of ( [ taukramers ] ) by @xmath170 , but this approximation is worse than ( [ taukramers ] ) .",
    "unfortunately , such an integral representation is not available for higher - dimensional fokker - planck equations , including the sniper problem studied later .",
    "since our main goal is to present methods which are applicable in higher - dimensions also , in sections [ secouter ] , [ secinner ] and [ secmatching ] we focus on approximating the mean switching time @xmath139 by analysing the @xmath171-equation ( [ equationfortau ] ) .",
    "the chemical fokker - planck equation and the corresponding @xmath171-equation are available in any dimension  see appendix [ appendixcfpe ] and appendix [ appendixmtime ] .",
    "formula ( [ eqdx ] ) and the parameter values ( [ paramschlogl ] ) imply that @xmath78 is of the order @xmath153 while @xmath18 is of the order @xmath172 . considering small @xmath173 ,",
    "we use the following scaling @xmath174 then we can rewrite the equation ( [ equationfortau ] ) to @xmath175 later we will see that in fact @xmath176 is exponentially large in @xmath177 , so that the left - hand side of this equation dominates the right - hand side .",
    "then @xmath176 will be approximately constant except when @xmath178 , that is , the main variation in @xmath176 occurs near @xmath179 .",
    "for @xmath180 close to @xmath181 , we use the transformation of variables @xmath182 and approximate @xmath183 to give @xmath184 integrating over @xmath185 , we get @xmath186   \\frac{\\mbox{d } \\overline{\\tau}}{\\mbox{d } \\eta }   =   \\frac{c_1 } { \\overline{d}(\\overline{y}_u )   } \\label{taudereta}\\ ] ] where @xmath187 is a real constant . to determine @xmath187",
    "we can not use the local expansion near @xmath181 alone ; @xmath187 is determined by the number @xmath188 on the right - hand side of ( [ equationforovertau ] ) , which is the only place the scale of @xmath176 is set . to determine @xmath187 we use the projection method of ward @xcite . the stationary fokker - planck equation ( [ statfpeschlogl ] ) can be rewritten @xmath189 + \\varepsilon \\frac{\\mbox{d}^2}{\\mbox{d } \\overline{y}^2 } \\left [ \\overline{d}(\\overline{y } ) p_s(\\overline{y } ) \\right ] = 0 , \\label{eqpsovervariables}\\ ] ] which is the adjoint equation to the homogeneous version of ( [ equationforovertau ] ) .",
    "multiplying the equation ( [ equationforovertau ] ) by @xmath88 , the equation ( [ eqpsovervariables ] ) by @xmath176 , integrating over @xmath180 in the interval @xmath190 $ ] and subtracting the resulting equations , we obtain @xmath191 \\mbox{d}\\overline{y } \\\\ + \\ , \\varepsilon & & \\int_{-\\infty}^{\\overline{y}_u } \\left ( \\frac{\\mbox{d}}{\\mbox{d } \\overline{y } }   \\left [ p_s(\\overline{y } ) \\overline{d}(\\overline{y } ) \\frac{\\mbox{d } \\overline{\\tau}}{\\mbox{d } \\overline{y } } ( \\overline{y } ) \\right ] - \\frac{\\mbox{d}}{\\mbox{d } \\overline{y } }   \\left [ \\overline{\\tau}(\\overline{y } ) \\frac{\\mbox{d}}{\\mbox{d } \\overline{y } } \\left [ \\overline{d}(\\overline{y } ) p_s(\\overline{y } ) \\right ] \\right ] \\right ) \\mbox{d}\\overline{y } = - \\int_{-\\infty}^{\\overline{y}_u } p_s(\\overline{y } ) \\mbox{d}\\overline{y}.\\end{aligned}\\ ] ] evaluating the integrals on the left hand side with the help of ( [ eqpsovervariables ] ) and the boundary condition ( [ bctauschlog ] ) , we find @xmath192 since @xmath88 is exponentially localized near @xmath193 and @xmath194 , @xmath195 is exponentially small in @xmath196 using ( [ taudereta ] ) in ( [ dertauxu ] ) , we find @xmath197 so that @xmath198 \\int_{-\\infty}^{\\overline{y}_u } p_s(\\overline{y } ) \\mbox{d}\\overline{y}.\\ ] ] integrating over @xmath185 in @xmath199 $ ] , we obtain @xmath200 where we used that @xmath201 as @xmath202 , i.e. the switching time is going to zero if the starting point approaches the boundary @xmath147 , see figure  [ figxyfuexittime](b ) .",
    "the limit @xmath203 on the left hand side of ( [ overtaueta ] ) is an approximation of the mean switching time @xmath139 .",
    "it is the plateau value of @xmath204 in figure  [ figxyfuexittime](b ) . transforming ( [ overtaueta ] ) to the original variables ,",
    "we obtain the following approximation for the mean switching time @xmath205 let us define the potential @xmath206 by @xmath207 then ( [ tauappj ] ) can be rewritten as @xmath208 \\left ( \\frac{\\mbox{d } v}{\\mbox{d}y}(y_u ) \\right)^{\\!\\!\\!-1/2 } \\int_{-\\infty}^{y_u } \\frac{\\exp[-\\psi(y)]}{d(y ) } \\mbox{d}y.\\ ] ] the local extrema of the potential @xmath206 are equal to @xmath104 , @xmath105 and @xmath106 . using the taylor expansion @xmath209 in the integral on the right hand side , we approximate @xmath210 \\left ( \\frac{\\mbox{d } v}{\\mbox{d}y}(y_u ) \\right)^{\\!\\!\\!-1/2 } \\frac{2 \\pi \\sqrt{d(y_u)}}{d(y_{f1 } ) \\sqrt{\\psi^{\\prime\\prime}(y_{f1})}}.\\ ] ] using the definition of @xmath206 , we obtain the following approximation of the mean switching time @xmath211 \\left ( \\frac{\\mbox{d } v}{\\mbox{d}y}(y_u ) \\left| \\frac{\\mbox{d } v}{\\mbox{d}y}(y_{f1 } ) \\right|   d(y_{f1 } )   \\right)^{\\!\\!\\!-1/2}. \\label{tauouterapp}\\ ] ] we will call @xmath212 the outer solution . in figure  [ figcompoutapp](a ) , we compare the approximations    2.05 in -8 mm 2.05 in -8 mm    ( [ tauappj ] ) and ( [ tauouterapp ] ) with the exact value given by @xmath213 .",
    "we see that @xmath214 and @xmath215 provide good approximation of the mean switching time . in figure  [ figcompoutapp](b ) , we present the behaviour of approximations close to the critical point @xmath216 .",
    "they both blow up at the point @xmath216 .",
    "we also plot the results obtained by the kramers approximation @xmath217 given by ( [ taukramers ] ) .",
    "we again confirm that it provides a good approximation for @xmath164 , see figure  [ figcompoutapp](a ) , but it blows up at the point @xmath122 , see figure  [ figcompoutapp](b ) . in the next section",
    ", we present the inner approximation which is valid close to the critical point @xmath218      if @xmath216 , then @xmath219 where @xmath220 is given by ( [ valueofyk ] ) .",
    "consider the drift coefficient given as a function of @xmath180 and the parameter @xmath114 , namely @xmath221 if @xmath180 is close to @xmath222 and @xmath114 is close to @xmath123 , we can use the taylor expansion to approximate @xmath223 where we used @xmath224 we use the transformation of variables @xmath225 and @xmath226 .",
    "then ( [ approxclosetok ] ) implies @xmath227 now in ( [ scalingone ] ) we need to replace @xmath228 by @xmath229",
    ". then ( [ equationforovertau ] ) reads as follows @xmath230 using ( [ approxclosetok3 ] ) and approximating @xmath231 , we get @xmath232 this time , since we are close to the bifurcation point , the right - hand side is not negligible .",
    "equation ( [ equationforovertauetayfyu ] ) can be rewritten as @xmath233   \\frac{\\mbox{d } \\overline{\\tau}}{\\mbox{d } \\eta }   \\right)\\ ] ] @xmath234.\\ ] ] integrating over @xmath185 , we get @xmath235   \\nonumber \\\\ & \\times &   \\int_{-\\infty}^\\eta \\exp \\left [   \\frac{1}{\\overline{d}(\\overline{y}_k ) }   \\left ( \\frac{1}{2 } \\frac{\\partial^2 \\overline{v}}{\\partial \\overline{y}^2}(\\overline{y}_k , k ) \\frac{\\xi^3}{3 } + \\kappa \\xi \\right ) \\right ]   { \\mbox{d}\\xi}.   \\label{pomicb}\\end{aligned}\\ ] ] we chose the exiting boundary so that @xmath236 at @xmath202 . consequently , integrating ( [ pomicb ] ) over @xmath185 in @xmath199 $ ] , we obtain @xmath237   { \\mbox{d}\\xi}\\ ,   { \\mbox{d}\\eta}.\\ ] ] substituting @xmath238 we obtain @xmath239 where @xmath240 and the function @xmath241 is given by @xmath242}{\\sqrt{v } } \\ , { \\mbox{d}v}. \\label{defh}\\ ] ] the limit of @xmath243 as @xmath203 is the approximation of the mean switching time @xmath139 for @xmath114 close to @xmath123 . transforming back to the original variables and using ( [ definitionbeta ] ) , we obtain the inner solution @xmath244 in the following form @xmath245 \\ , 24^{1/3 } \\ , \\left ( d(y_k ) \\right)^{-2/3 } \\left ( \\frac{\\partial^2 v}{\\partial y^2}(y_k , k ) \\right)^{\\!-1/3 } \\right ) . \\qquad",
    "\\qquad \\label{tauinnerapp}\\end{aligned}\\ ] ] in figure  [ figcompinnapp](a ) , we compare the approximation    2.05 in -8 mm 2.05 in -8 mm    ( [ tauinnerapp ] ) with the exact value @xmath139 given by @xmath213 .",
    "we also plot @xmath246 given by ( [ tauzformula ] ) for @xmath247 as discussed before , @xmath246 could be considered as another possible definition of the mean switching time .",
    "we see that the value of the inner approximation @xmath244 at the critical point @xmath216 lies between the exact value @xmath139 and @xmath246 .",
    "thus we confirm that @xmath244 is a good approximation of @xmath139 for @xmath114 close the the critical point @xmath123 .",
    "in section [ secouter ] , we obtained the outer approximation ( [ tauouterapp ] ) of the mean switching time which is valid for @xmath164 . in section [ secinner ] , we obtained the inner approximation ( [ tauinnerapp ] ) of the mean switching time which is valid for @xmath165 . in this section ,",
    "we match the inner and the outer solutions to derive the uniform approximation of the mean switching time .",
    "first , we investigate the asymptotic behaviour of @xmath248 as @xmath249 .",
    "let @xmath250 .",
    "using the substitution @xmath251 in the definition ( [ defh ] ) , we obtain @xmath252 \\ , { \\mbox{d}w}\\ ; \\sim   \\ ; \\sqrt{\\frac{\\pi}{z } } \\exp \\left [   \\frac{2 z^{3/2 } } { 3\\sqrt{3 } } \\right ] \\qquad \\mbox{as } \\ ; z \\to \\infty.\\ ] ] consequently , the outer limit of the inner solution ( [ tauinnerapp ] ) is @xmath253 .",
    "\\label{tauioform}\\ ] ] in figure  [ figcompinnapp](a ) , we plot @xmath254 as the black dashed line .",
    "it is easy to check that the inner limit of the outer solution @xmath255 is equal to the outer limit of the inner solution @xmath244 , i.e. it is also given by @xmath254 .",
    "thus we can define the continuous uniform approximation of the mean switching time @xmath139 by the formula @xmath256 where the constant @xmath257 is defined by @xmath258 thus , for @xmath259 , we add the inner and the outer solutions and subtract the  overlap \" solution ( the inner limit of the outer solution ) which has been double - counted . in order to make the approximation continuous at @xmath216",
    ", we also subtract the constant @xmath257 ( which is in fact a higher order term ) .",
    "we approximate @xmath139 by the inner solution for @xmath260 . in figure  [ figcompinnapp](b )",
    ", we plot the uniform approximation @xmath261 together with the exact value @xmath139 given by @xmath213 .",
    "we also plot @xmath246 given by ( [ tauzformula ] ) for @xmath247 the comparison is excellent .",
    "we consider the chemical system ( [ model1])([model2 ] ) . substituting the propensity functions ( [ propfunctions ] ) into the equation ( [ fpegengen ] ) in appendix [ appendixcfpe ] ,",
    "we obtain the chemical fokker - planck equation @xmath262 + \\frac{\\partial^2}{\\partial x \\partial y } \\big [ d_{xy } \\ , p \\big ] + \\frac{\\partial^2}{\\partial y^2 } \\big [ d_y \\ , p \\big ]   - \\frac{\\partial}{\\partial x } \\big [ v_x \\ , p \\big ] - \\frac{\\partial}{\\partial y } \\big [ v_y \\ , p \\big ] \\label{fokkerplanck2d}\\ ] ] where @xmath263 is the joint probability distribution that @xmath65 and @xmath264 , @xmath265 , @xmath266 , and the drift and diffusion coefficients are given by @xmath267/2 , \\\\",
    "d_y(x , y ) & = &   [ k_7 x ( x-1 ) y + k_6 x y + k_2 y + k_1]/2 , \\\\ d_{xy}(x ,",
    "y ) & = &   - k_2 y. \\label{endcodxy}\\end{aligned}\\ ] ] the stationary distribution @xmath268 can be obtained as a solution of the corresponding elliptic problem : @xmath269 + \\frac{\\partial^2}{\\partial x \\partial y } \\big [ d_{xy } \\ , p_s \\big ] + \\frac{\\partial^2}{\\partial y^2 } \\big [ d_y \\ , p_s \\big ]   - \\frac{\\partial}{\\partial x } \\big [ v_x \\ , p_s \\big ] - \\frac{\\partial}{\\partial y } \\big [ v_y \\ , p_s \\big ] , \\label{statfp2dsniper1}\\ ] ] @xmath270 @xmath271 to solve the problem ( [ statfp2dsniper1])([statfp2dsniper3 ] ) approximately by the finite element method ( fem ) we have to reformulate it as a problem in a finite domain . therefore , we first restrict the domain @xmath272 to a rectangle @xmath273 which has to be sufficiently large to contain most of the trajectories .",
    "for example , figure  [ fig12timeevol](b ) shows the illustrative trajectory for the parameter values ( [ sniperparam ] ) and @xmath48 . in this case",
    ", the rectangle @xmath273 can be chosen as @xmath274 .",
    "on the boundary @xmath275 we prescribe homogeneous neumann boundary conditions .",
    "we reformulate ( [ statfp2dsniper1])([statfp2dsniper3 ] ) as the following neumann problem in the domain @xmath273 @xmath276 where @xmath277 stands for the gradient , @xmath278 denotes the outward unit normal vector to @xmath275 , and the @xmath279 symmetric positive definite matrix @xmath280 and the vector @xmath281 are given by @xmath282 to define the fem solution , we need the weak formulation of ( [ problemaf ] ) .",
    "the weak solution @xmath283 is uniquely determined by the requirement @xmath284 where @xmath285 stands for the sobolev space @xmath286 and the bilinear form @xmath287 is given by @xmath288 we use first - order triangular elements .",
    "first we define a triangulation @xmath289 of the domain @xmath273 and the corresponding finite element subspace @xmath290 of the piecewise linear functions : @xmath291 where @xmath292 stands for the three - dimensional space of linear functions on the triangle @xmath293 .",
    "the finite element problem then reads : find @xmath294 such that @xmath295 both problems ( [ problemaf ] ) and ( [ problemafh ] ) posses trivial solutions @xmath296 and @xmath297 . to get a non - zero solution we use appropriate numerical methods for finding eigenvectors corresponding to the zero eigenvalue .",
    "the computed nontrivial solution @xmath298 is then normalized to have @xmath299 . in figure  [ figstatdistrsniper](a ) , we present the fem solution @xmath298 to the problem ( [ problemafh ] ) obtained on a uniform mesh with @xmath300 triangular elements .",
    "we use the parameter values ( [ sniperparam ] ) and @xmath48 .",
    "we plot only the stationary distribution in the subdomain @xmath301 \\times [ 550,1150],$ ] i.e. the part of the @xmath1-@xmath2 phase space where the system spends most of time . running long time stochastic simulations",
    ", we can find the stationary distribution by the gillespie ssa , which is plotted in figure  [ figstatdistrsniper](b ) for the same parameter values @xmath23 and @xmath48 .",
    "the comparison with the results obtained by the chemical fokker - planck equation is visually excellent .    2.05 in -8 mm 2.05 in -8 mm    plotting the numerical results in the whole computational domain @xmath302",
    ", we do not see any additional information because most of @xmath88 is localized in the subdomain shown in figure  [ figstatdistrsniper ] .",
    "we have to plot @xmath303 to see the underlying  volcano - shaped \" probability distribution ",
    "see figure  [ figstatdistrsniper2 ] ( a ) .    2.05 in -8 mm 2.05 in -8 mm",
    "let us note that there is no bifurcation in the features of @xmath88 , i.e. the probability distribution is  volcano - shaped \" both before and after the ode critical value .",
    "let us consider the sniper chemical system ( [ model1])([model2 ] ) with the parameter values ( [ sniperparam ] ) and @xmath48 . an illustrative stochastic trajectory is shown in figure  [ fig12timeevol ] .",
    "let the domain @xmath304 be defined by @xmath305 \\ ; | \\ ; x < 200 \\}$ ] .",
    "in each cycle ( as we defined it on page ) , the trajectory leaves the domain @xmath304 .",
    "however , the time which the trajectory spends outside the domain @xmath304 is much smaller than the time which the trajectory spends inside @xmath304 .",
    "this observation is confirmed by figure  [ figstatdistrsniper2](a ) .",
    "the probability that the system state is outside @xmath304 is several orders of magnitude smaller than the probability that it lies inside @xmath304 .",
    "thus the period of oscillation can be estimated as the mean time to leave the domain @xmath304 provided that the trajectory  has just entered it \" .",
    "let @xmath306 be the average time to leave the domain @xmath304 provided that the trajectory starts at @xmath307 and @xmath308 .",
    "as shown in appendix [ appendixmtime ] , @xmath306 evolves according to the equation ( [ tau2dequation ] ) : @xmath309 \\in \\omega , \\label{escapeequation}\\ ] ] together with the boundary condition @xmath310 for @xmath311 . to solve this problem approximately , we truncate the domain @xmath304 to get the finite domain @xmath312 .",
    "we consider homogeneous neumann boundary conditions on the parts of the boundary which are not on the line @xmath313 and we rewrite the problem ( [ escapeequation ] ) in the form @xmath314 where the @xmath315 matrix @xmath280 and the vector @xmath281 are given by ( [ calab ] ) and the coefficients @xmath316 , @xmath317 , @xmath318 , @xmath319 , and @xmath320 are given by ( [ begcovx])([endcodxy ] ) .",
    "notice the difference between ( [ finproblemtau ] ) and ( [ problemaf ] ) and that @xmath321 as in the previous section , we define the weak solution as @xmath322 satisfying @xmath323 where @xmath324 on the line @xmath325 and @xmath326 the fem solution @xmath327 is defined by the requirement @xmath328 where @xmath329 is the space of continuous and piecewise linear functions based on a suitable triangulation @xmath289 of @xmath330 ( compare with ( [ defvh ] ) ) .",
    "the triangulation used does not follow the anisotropy of @xmath330 and it consits of elements close to the equilateral triangle .",
    "it has about @xmath331 triangles and the number of degrees of freedom is about @xmath332 .",
    "the fem solution @xmath333 is shown in figure  [ figstatdistrsniper2](b ) . using the computed profile",
    ", we can estimate the period of oscillation .",
    "one possibility is to find the maximum of the stationary distribution @xmath334 which is attained at the point @xmath335 = [ 29.30 , 781.25]$ ] , and estimate the period of oscillation as @xmath336 .",
    "this compares well with the period of oscillation estimated by long stochastic simulation for the same parameter values .",
    "we obtained @xmath337 as an average over @xmath338 periods .",
    "the estimation of the period of oscillation is analogous to the estimation of the mean switching time of the schlgl problem ( [ schlogl ] ) which was studied in section [ sec1dswitch ] .",
    "we introduced the boundary @xmath147 given by ( [ bdeffortau ] ) and we asked what the mean time to leave the domain @xmath132 is .",
    "the biggest contribution to the mean exit time was given by the behaviour close to the point @xmath97 .",
    "the sniper equivalent of the boundary @xmath147 ( resp .",
    "point @xmath97 ) is the line @xmath313 ( resp .",
    "the saddle ) . in the case of the schlgl problem ( [ schlogl ] )",
    ", we saw that the difference between the escape times from @xmath158 and @xmath157 increased as we approached the bifurcation value .",
    "similarly , the estimation of the period of oscillation of the sniper problem by @xmath339 is fine for @xmath340 , but it might provide less accurate results if the saddle and the stable node of the sniper problem are too close , i.e. if @xmath6 is close to the bifurcation value @xmath341 .",
    "thus it is better to estimate the mean period of oscillation as the mean time to leave the domain @xmath304 , starting from the subdomain @xmath342 where stochastic trajectories enter the domain @xmath304 .",
    "we approximate the mean period of oscillation as a weighted average of @xmath306 over a suitable subdomain @xmath343 , namely by @xmath344 since the trajectories are entering the domain @xmath330 at the smaller values of @xmath2 and leaving the domain at the larger values of @xmath2 , it is reasonable to choose the subdomain @xmath343 as the line segment parallel with the @xmath2 axis between the @xmath1 axis and a suitable treshold value .",
    "three choices of @xmath343 are shown in figure [ figsniperperiod2](a ) as thick black , magenta and green lines .",
    "2.05 in -8 mm 2.05 in -8 mm    the black line is the line from @xmath345 to the unstable node .",
    "the magenta line is a segment of @xmath346 and the thick green line is a segment of @xmath347 . in the case of @xmath347 ( resp .",
    "@xmath346 ) , we define the threshold value as the intersection of the line @xmath347 ( resp .",
    "@xmath346 ) with the stable direction at the saddle point . note that we use the nullclines and the saddle point of the system of odes @xmath348 which slightly differs from the classical mean - field ode description ( [ eq1])([eq2 ] ) .",
    "the ode system ( [ detsniperode ] ) is equivalent to the ode system ( [ eq1])([eq2 ] ) in the limit @xmath55 .",
    "see also the discussion after the equation ( [ detschlogldriftode ] ) about the differences between ( [ detschloglode ] ) and ( [ detschlogldriftode ] ) .    in figure  [ figsniperperiod2](b )",
    ", we present estimates of the period of oscillation computed by ( [ apposc ] ) as a function of the parameter @xmath6 .",
    "the results obtained by the gillespie ssa ( blue circles ) and by the odes ( [ eq1])([eq2 ] ) ( red line ) were already presented in figure  [ figperosc](a ) .",
    "the green , magenta and black curves correspond to the results computed by ( [ apposc ] ) for the lines @xmath343 of the same colour in figure  [ figsniperperiod2](a ) .",
    "we also present results computed by @xmath349 where @xmath335 $ ] is the point where @xmath334 achieves its maximum .",
    "the dotted line denotes the bifurcation values of the ode systems ( [ eq1])([eq2 ] ) and ( [ detsniperode ] ) .",
    "these values differ for finite values of the volume @xmath3 . in figure  [ figsniperperiod3](a )",
    ", we show the dependence of the bifurcation value of @xmath6 on the volume @xmath3 for both ode systems .",
    "the ode system ( [ eq1])([eq2 ] ) is independent of @xmath3 , and so its bifurcation value .",
    "fixing the value of @xmath6 at the bifurcation value @xmath54 of the ode model ( [ eq1])([eq2 ] ) , the period of oscillation of the ode system ( [ eq1])([eq2 ] ) is infinity .",
    "the ode system ( [ detsniperode ] ) does not have a limit cycle at all as @xmath54 is below its bifurcation value which we denote @xmath123 .",
    "however , we saw in figure  [ figperosc](b ) that the stochastic system has oscillatory solutions with a finite period for @xmath350 the period of oscillation as a function of the volume @xmath3 can be also computed by ( [ apposc ] ) .",
    "the results are shown in figure [ figsniperperiod3](b ) .",
    "we use the same lines @xmath343 as in figure  [ figsniperperiod2](a ) .",
    "we have to take into account that the system volume @xmath3 changes and that the phase plane axes ( the number of species particles ) scale linearly with @xmath3 .",
    "thus we define the lines @xmath343 as segments of @xmath351 , @xmath352 and @xmath353 where @xmath354 is the @xmath18-coordinate of the unstable node .",
    "this definition gives for @xmath48 the lines @xmath343 plotted in figure  [ figsniperperiod2](a ) .",
    "we also have to scale the domain @xmath330 with @xmath3 : we use @xmath355 instead of @xmath330 .",
    "fortunately , we can simply rescale the triangulation .",
    "thus the volume dependence of the computational domain does not causes any additional problems .",
    "let us note that the @xmath19 threshold for the lines at @xmath351 and @xmath352 is defined as an intersection with the stable direction at the saddle point of ( [ detsniperode ] ) . as shown in figure  [ figsniperperiod3](a ) ,",
    "the saddle point of the ode system ( [ detsniperode ] ) is always defined for @xmath356 because its ( volume dependent ) bifurcation value @xmath123 satisfies @xmath357 .",
    "let us note that for @xmath114 greater than the bifurcation value of ( [ detsniperode ] ) , we use the lines @xmath343 computed at the bifurcation point ( since there is no saddle defined for such values of @xmath6 ) .",
    "this definition was used in figure  [ figsniperperiod2](b ) for @xmath358 .    2.03 in -8 mm 2.03 in -8 mm",
    "in this section , we derive analytical formulae for the dependence of the period of oscillation of the chemical sniper problem ( [ model1])([model2 ] ) on the parameter @xmath6 and on the volume @xmath3 , i.e. we obtain formulae for the behaviour shown in figure  [ figperosc ] . in particular , we generalize the one - dimensional approach from section [ secinner ] to the chemical sniper problem . as we mentioned before ,",
    "we denote the bifurcation value of the parameter @xmath6 of the ode system ( [ detsniperode ] ) by @xmath123 .",
    "if @xmath359 , then the saddle and the stable node of the ode system ( [ detsniperode ] ) coincide at one point which we denote as @xmath360.$ ] let us define @xmath361 where the dependence on parameters @xmath362 is not indicated , because their values are fixed and given by ( [ sniperparam ] ) .",
    "the eigenvalues of @xmath363 are @xmath364 and @xmath365 .",
    "we denote the corresponding eigenvectors as @xmath366 ( for the eignevalue zero ) and @xmath367 ( for the eigenvalue @xmath368 ) .",
    "the eigenvector @xmath369 is in the direction of the limit cycle .",
    "there is an obvious separation of time scales .",
    "the dynamics is much slower in the direction of @xmath369 than in the direction of @xmath370 .",
    "thus we first transform the variables from the cartesian coordinate system @xmath18 and @xmath19 to the directions of eigenvectors of @xmath363 and then we analyse the transformed @xmath171-equation .",
    "to do it systematically , we use the following scaling ( compare with ( [ scalingone ] ) ) @xmath371 then the @xmath171-equation ( [ escapeequation ] ) reads as follows @xmath372 for @xmath6 close to @xmath123 and @xmath373 $ ] close to @xmath374 $ ] , we use the local variables @xmath375 @xmath376 and @xmath377 which are related to @xmath378 and @xmath180 as follows @xmath379 then the line @xmath380 corresponds to the direction of the limit cycle and @xmath381 to the stable direction .",
    "let us denote @xmath382 $ ] to shorten the following formulae . using the taylor expansion at the point @xmath382 $ ] , we approximate @xmath383 where @xmath384 @xmath385 and @xmath386 are constants . to systematically derive the formulae for the mean period of oscillation",
    ", we need to take all the terms above into account .",
    "however , we will show that the results are actually independent of some coefficients in the expansion . to save space , we explicitly specify only those coefficients which actually appears in the final formulae .",
    "they are given in appendix [ appendixci ] .",
    "using the fact that @xmath366 ( resp .",
    "@xmath367 ) is an eigenvector of the matrix @xmath363 corresponding to the eigenvalue @xmath364 ( resp .",
    "@xmath365 ) , we obtain the expansion of @xmath387 and @xmath388 in the form @xmath389 where the constants @xmath390 and @xmath391 are given in appendix [ appendixci ] . using ( [ etaxirotsniperbb ] ) , the derivatives transform as follows @xmath392 where @xmath393 .",
    "substituting our approximations to ( [ escapeequation2 ] ) and using the scaling @xmath394 , we obtain @xmath395 where the coefficients @xmath396 are given in the appendix [ appendixci ] .",
    "we assume that @xmath397 as @xmath202 and that @xmath176 is bounded as @xmath203 and @xmath398 .",
    "we expand @xmath176 as @xmath399 substituting into ( [ etaxieq ] ) , we obtain the following equation , at @xmath400 , @xmath401 integrating over @xmath376 , we obtain @xmath402,\\ ] ] where @xmath257 is a function of @xmath185 .",
    "since @xmath171 is assumed to be bounded as @xmath398 , we must have @xmath403 .",
    "consequently , we obtain @xmath404 i.e. @xmath405 is not a function of @xmath376 . using ( [ tau0xi ] ) in ( [ etaxieq ] ) , we obtain the following equation , at @xmath406 , @xmath407 which similarly implies @xmath408 using ( [ tau0xi ] ) and ( [ tau1xi ] ) in ( [ etaxieq ] ) , we have , at @xmath409 , @xmath410 thus @xmath411   \\frac{\\partial \\tau_2}{\\partial \\xi } \\right ) =   \\exp \\left [ -   \\frac{\\lambda_0 \\xi^2}{2\\sigma_1 } \\right ]   \\left ( \\left ( \\sigma_5 \\eta^2   +   \\sigma_6 \\kappa   \\right ) \\frac{\\partial \\tau_0}{\\partial \\eta } + \\sigma_8   \\frac{\\partial^2 \\tau_0}{\\partial \\eta^2 } + 1 \\right).\\ ] ] integrating over @xmath376 in @xmath412 , we obtain the solvability condition @xmath413 this equation is the sniper equivalent of equation ( [ equationforovertauetayfyu ] ) for the chemical switch , and can be solved to find the leading - order period of oscillation .",
    "before we do so , we proceed to higher - order with the expansion to determine the correction term to @xmath414 using ( [ tau0eq ] ) in ( [ pomtau2eq ] ) gives @xmath415 thus , again , @xmath416 using ( [ tau0xi ] ) , ( [ tau1xi ] ) and ( [ tau2xi ] ) in ( [ etaxieq ] ) , we have , at @xmath417 , @xmath418 which is equivalent to @xmath419   \\frac{\\partial \\tau_3}{\\partial \\xi } \\right ) \\qquad\\qquad\\qquad\\qquad \\\\ & = &   \\exp \\left [ -   \\frac{\\lambda_0 \\xi^2}{2\\sigma_1 } \\right ]   \\left ( \\left ( \\sigma_5 \\ , \\eta^2   +   \\sigma_6 \\ , \\kappa \\right ) \\frac{\\partial \\tau_1}{\\partial \\eta } + \\sigma_8   \\frac{\\partial^2 \\tau_1}{\\partial \\eta^2 } +   \\sigma_{10 } \\ , \\xi \\eta \\frac{\\partial \\tau_0}{\\partial \\eta } \\right).\\end{aligned}\\ ] ] integrating over @xmath376 in @xmath412 , we obtain the solvability condition @xmath420 which implies @xmath421 consequently , ( [ ordereps1o2 ] ) yields @xmath411   \\frac{\\partial \\tau_3}{\\partial \\xi } \\right ) =   \\exp \\left [ -   \\frac{\\lambda_0 \\xi^2}{2\\sigma_1 } \\right ]   \\left ( \\sigma_{10 } \\ , \\xi \\eta \\frac{\\partial \\tau_0}{\\partial \\eta } \\right).\\ ] ] integrating over @xmath376 , we get @xmath422 using ( [ tau0xi ] ) , ( [ tau1is0 ] ) and ( [ tau2xi ] ) in ( [ etaxieq ] ) , we have , at @xmath423 , @xmath424 using ( [ tau3xider ] ) on the right hand side to eliminate the term @xmath425 and ( [ tau0eq ] ) to eliminate @xmath426 , we get @xmath411   \\frac{\\partial \\tau_4}{\\partial \\xi } \\right ) =   \\exp \\left [ -   \\frac{\\lambda_0 \\xi^2}{2 \\sigma_1 } \\right ] \\times \\bigg ( \\left ( \\sigma_5 \\ , \\eta^2   + \\sigma_6 \\ , \\kappa \\right ) \\frac{\\partial \\tau_2}{\\partial \\eta } + \\sigma_8   \\frac{\\partial^2 \\tau_2}{\\partial \\eta^2}\\ ] ] @xmath427 where @xmath428 @xmath429 integrating over @xmath376 in @xmath412",
    ", we obtain the solvability condition @xmath430 this is the equation which determines @xmath431 , the first non - zero correction term to @xmath405 .",
    "let us now solve ( [ tau0eq ] ) and ( [ tau2eq ] ) for @xmath405 and @xmath431 . since ( [ tau0eq ] ) is of the same form as the equation ( [ equationforovertauetayfyu ] ) , we can use the same technique as in section [ secinner ] to analyse it .",
    "we find ( compare with ( [ limemi ] ) ) @xmath432 where the function @xmath241 is given by ( [ defh ] ) .",
    "moreover , we have the following identity ( compare with ( [ pomicb ] ) ) @xmath433 \\frac{\\partial \\tau_0}{\\partial \\eta } =   -   \\frac{1}{\\sigma_8 } \\int_{-\\infty}^{\\eta } \\exp \\left [ \\frac{\\sigma_5 z^3 + 3 \\sigma_6 \\kappa z}{3 \\sigma_8 }   \\right ] { \\mbox{d}z}. \\label{pomicb2d}\\ ] ] multiplying equation ( [ tau2eq ] ) by @xmath434,$ ] using ( [ pomicb2d ] ) , integrating over @xmath185 and using integration by parts , we obtain @xmath435 { \\mbox{d}y}.\\end{aligned}\\ ] ] integrating over @xmath185 in @xmath412 , we get @xmath436 { \\mbox{d}y}\\ , { \\mbox{d}z}\\nonumber \\\\ & + & \\frac{\\omega_1}{\\sigma_8 ^ 2 } \\int_{-\\infty}^\\infty \\int_{-\\infty}^z   ( y - z ) \\exp",
    "\\left [ \\frac{\\sigma_5 ( y^3-z^3 ) + 3 \\sigma_6 \\kappa ( y - z)}{3 \\sigma_8 }   \\right ] { \\mbox{d}y}\\ , { \\mbox{d}z}\\nonumber \\\\ & + & \\frac{\\omega_2}{2 \\sigma_8 ^ 2 } \\ , \\kappa   \\int_{-\\infty}^\\infty \\int_{-\\infty}^z   ( y^2 - z^2 ) \\exp \\left [ \\frac{\\sigma_5 ( y^3-z^3 ) + 3 \\sigma_6 \\kappa ( y - z)}{3 \\sigma_8 }   \\right ] { \\mbox{d}y}\\ , { \\mbox{d}z}\\nonumber \\\\ & + & \\frac{\\omega_3}{4 \\sigma_8 ^ 2 }    \\int_{-\\infty}^\\infty \\int_{-\\infty}^z   ( y^4 - z^4 ) \\exp \\left [ \\frac{\\sigma_5 ( y^3-z^3 ) + 3 \\sigma_6 \\kappa ( y - z)}{3 \\sigma_8 }   \\right ] { \\mbox{d}y}\\ , { \\mbox{d}z}. \\qquad\\quad \\label{dertau2}\\end{aligned}\\ ] ] using the substitution @xmath437 we simplify the integrals on the right hand side of ( [ dertau2 ] ) using the same technique as in ( [ limemi ] ) . in all cases , we are able to integrate over @xmath438 variable explicitly because the @xmath438-integral is the gaussian integral .",
    "the last two integrals are zero because we integrate odd functions in @xmath438 over @xmath412 .",
    "thus ( [ dertau2 ] ) becomes @xmath439 { \\mbox{d}v}. \\label{dertau2b}\\ ] ] let us define the function @xmath440 by @xmath441 \\ , { \\mbox{d}v}. \\label{defg}\\ ] ] using ( [ defom0om1 ] ) and the definition ( [ defg ] ) , the formula ( [ dertau2b ] ) implies @xmath442 the limits ( [ tau0lim ] ) and ( [ tau2limit ] ) give us the desired estimates of the period of oscillation .",
    "transforming back to the original variables , the zero - order approximation to the mean period of oscillation is given by @xmath443 where the constants @xmath444 , @xmath445 and @xmath446 are given in appendix [ appendixci ] .",
    "more precisely , the formulae for the constants @xmath444 , @xmath445 and @xmath446 are obtained by dropping the overbars in their definitions in appendix [ appendixci ] .",
    "they only depend on the derivatives of the coefficients ( [ begcovx])([endcodxy ] ) and on the eigenvectors @xmath369 and @xmath370 . the approximation @xmath447 is plotted in figure  [ figsniperanalysis1](a ) as the black dashed line .    2.05 in -8 mm 2.05 in -8 mm    transforming ( [ tau2limit ] ) into original variables",
    ", we can obtained an improved ( second - order ) approximation of the period of oscillation as @xmath448 where @xmath449 and the constants @xmath450 , @xmath451 , are given in appendix [ appendixci ] .",
    "again , the overbars have to be dropped . the approximation @xmath452 is plotted in figure  [ figsniperanalysis1](a ) as the black solid line .    in figure  [ figperosc](b ) , we studied the period of oscillation as a function of the volume @xmath3 for @xmath453 . to approximate this dependence",
    ", we put @xmath359 into formulae ( [ t0approx ] ) and ( [ t2approx ] ) . since @xmath454 and @xmath455",
    ", we obtain @xmath456 where @xmath457 is the gamma function .",
    "the values of @xmath458 and @xmath459 are plotted as functions of the volume @xmath3 in figure  [ figsniperanalysis1](b ) .",
    "we see that @xmath459 compare well with the results obtained by the stochastic simulation for @xmath58 .",
    "to be more precise , we should compare it with stochastic results obtained for @xmath359 where @xmath123 depends on the volume as shown in figure  [ figsniperperiod3](a ) .",
    "such data are plotted in figure  [ figsniperanalysis1](b ) too .",
    "another way to approximate the period of oscillation is to approximate @xmath460 ( resp . @xmath461 and @xmath462 ) by @xmath463 ( resp . @xmath464 and @xmath465 ) only in the equation ( [ escapeequation2 ] ) . if the approximation of @xmath466 and @xmath467 is the same as before , the resulting formulae are equal to ( [ t0approx])([t2approx0 ] ) with @xmath468 .",
    "the comparison of the results for @xmath468 is shown in figure  [ figsniperanalysis2 ] .",
    "we see that we have an excellent comparison with the results of the stochastic simulation for @xmath469 as a function of the volume @xmath3 - panel figure  [ figsniperanalysis2](b ) .    2.05 in -8 mm 2.05 in -8 mm",
    "bifurcation diagrams of odes computed by standard numerical continuation methods constitute a systematic way to study and summarize the dependence of the behaviour of the ode system on its parameters .",
    "an exploration of such a dependence could be in principle done by a direct integration in time , but it would be much more computationally intensive than the numerical continuation . in a similar way ,",
    "the exploration of the dependence of the behaviour of a stochastic chemical model on its parameters can in principle be done by the gillespie ssa ; yet , it is more efficient to study it by solving the underlying stationary fokker - planck equation numerically or by analysing it .",
    "for example , computation of the mean period of oscillation by the gillespie ssa is more computationally intensive for large values of the system size ( volume @xmath3 ) because the large values of @xmath3 correspond to chemical systems with many molecules . on the other hand ,",
    "the computational intensity of the fem solution of the fokker - planck equation is independent of @xmath470 making it more suitable for studying the dependence of the mean period of oscillation on the volume @xmath3 .",
    "the asymptotic formulae ( [ t0approx ] ) and ( [ t2approx ] ) provide further insights into the behaviour of the mean period of oscillation . at the bifurcation point @xmath359 of ( [ detsniperode ] ) ,",
    "the formula ( [ t0approx ] ) simplifies to ( [ t0approx0 ] ) . inspecting ( [ t0approx0 ] ) , we conclude that the mean period of oscillation asymptotes to infinity as @xmath471 for @xmath472 if @xmath3 is finite , the stochastic model of the chemical system ( [ model1])([model2 ] ) possesses oscillatory solutions for any value of @xmath6 which is close to @xmath123 or close to @xmath341 where @xmath453 is the bifurcation point of the classical deterministic ode model ( [ eq1])([eq2 ] ) . on the other hand ,",
    "the trajectories of ( [ eq1])([eq2 ] ) only oscillate for @xmath473 .",
    "the period of oscillation asymptotes to infinity as @xmath52 for @xmath474    in this paper , we used an illustrative example of the chemical system with two chemical species for which the deterministic mean - field description is undergoing a sniper bifurcation .",
    "the system was simple enough that we could directly compute many realisations of the gillespie ssa .",
    "averaging over many realisations , we estimated important characteristics of the system , for example , the mean period of oscillation .",
    "these estimates were used for the visual comparison with the results obtained by the asymptotic analysis of the chemical fokker - planck equation and by solving this equation numerically .",
    "another advantage of the illustrative chemical system was that the chemical fokker - planck equation was two - dimensional , which simplified its asymptotic analysis and numerical solution .",
    "if we have a system of @xmath475 chemical species , the resulting chemical fokker - planck equation will be @xmath475-dimensional .",
    "we are currently investigating the advantages and disadvantages of this approach for @xmath475 larger than 2 .",
    "clearly , a suitable numerical method for solving the higher - dimensional pdes must be applied .",
    "the analysis presented here can also be generalized to higher - dimensional cases .",
    "all we need to find are the eigenvectors of the jacobian matrix at the saddle .",
    "the biggest contribution to the mean exit time or the mean period of oscillation will be in the direction of the eigenvector corresponding to the saddle - node connection . thus the approach presented is potentially equally applicable to the @xmath475-dimensional case and lead to the estimates of the dependence of the important system characteristics ( e.g. the mean period of oscillation ) on the model parameters .",
    "alternative methods to obtain these estimates include : accelerating the gillespie ssa by using approximate ssas @xcite , or estimating the low - dimensional effective fokker - planck equation by using short bursts of appropriately initialized stochastic simulations @xcite .",
    "both approaches use ssas .",
    "in contrast , the methods presented in this paper were based on the numerical solution and asymptotic analysis of pdes , i.e. no stochastic simulation and no generators of random numbers were needed .",
    "let us consider a well - stirred mixture of @xmath476 molecular species that chemically interact through @xmath477 chemical reactions @xmath478 , @xmath479 .",
    "the state of this system is described by @xmath480 $ ] where @xmath481 is the number of molecules of the @xmath66-th chemical species , @xmath482 let @xmath483 be the propensity function of the chemical reaction @xmath478 , @xmath479 , i.e. @xmath484 is the probability that , given @xmath485 , one @xmath478 reaction will occur in the next infinitesimal time interval @xmath31 .",
    "let @xmath486 be the change in the number of @xmath487 produced by one @xmath478 reaction .",
    "then the chemical system can be described by the chemical master equation @xmath488,\\ ] ] where @xmath489 is the probability that @xmath485 and @xmath490 $ ] . considering the integer valued vector @xmath491 as a real variable , gillespie @xcite derived the chemical langevin equation by approximating poisson random variables by normal random variables .",
    "this approximation is possible if many reaction events happen before the propensity functions change significantly their values , see @xcite for details .",
    "the chemical langevin equation can be written in the form @xmath492 which corresponds to the _ chemical fokker - planck equation _ @xmath493 +   \\frac{1}{2 } \\frac{\\partial^2}{\\partial x_i^2 } \\left [   \\left ( \\sum_{j=1}^m \\nu^2_{ji } \\alpha_j(x ) \\right )   p({{\\mathbf x}},t ) \\right ] \\nonumber \\\\ & & +   \\sum_{k < i }   \\frac{\\partial^2}{\\partial x_i x_k } \\left [   \\left ( \\sum_{j=1}^m \\nu_{ji } \\nu_{jk } \\alpha_j(x ) \\right )   p({{\\mathbf",
    "x}},t ) \\right ] \\label{fpegengen}.\\end{aligned}\\ ] ]",
    "let @xmath494 be the probability that @xmath495 , @xmath496 given that @xmath497 and @xmath498 .",
    "it satisfies the backward kolmogorov equation @xmath499 let @xmath500 be the probability that @xmath501 \\in \\omega$ ] at time @xmath75 given that it started at @xmath502 = [ x , y].$ ] then @xmath503 integrating ( [ backkolm2d ] ) , we obtain @xmath504 the mean exit time @xmath171 to leave @xmath304 , given that initially @xmath502=[x , y]$ ] , can be computed as follows @xcite @xmath505 integrating equation ( [ equationforh2d ] ) over @xmath75 , we obtain the following elliptic problem : @xmath309 \\in \\omega . \\label{tau2dequation}\\ ] ]",
    "the coefficients @xmath508 , @xmath385 , @xmath386 , @xmath390 and @xmath391 can be computed by the taylor expansion .",
    "below , we provide the expressions for those coefficients which actually appear in the final formulae for the mean period of oscillation : @xmath509 where we used the formulae ( [ begcovx])([midcovy ] ) to simplify the taylor expansion of @xmath466 and @xmath467 .",
    "note that some of the second derivatives of @xmath510 and @xmath511 are zero which makes the resulting formulae shorter .",
    "however , even if they were nonzero , the same analysis could be carried through .",
    "the @xmath512 coefficients are given by @xmath513 to get the coefficients @xmath450 in the final formulae ( [ t0approx])([t2approx0 ] ) , we simply drop the overbars in the expressions above .",
    "* acknowledgements . *",
    "this publication is based on work supported by st .",
    "john s college , oxford ; linacre college , oxford ; somerville college , oxford and by award no .",
    "kuk - c1 - 013 - 04 , made by king abdullah university of science and technology ( re ) .",
    "igk was supported by the national science foundation and the us doe .",
    "tv acknowledges the support of the czech science foundation , project no .  102/07/0496 , of the grant agency of the academy of sciences , project no .",
    "iaa100760702 , and of the czech academy of sciences , institutional research plan no .",
    "the authors also benefited from helpful discussions with bill baumann and john tyson .",
    "r.  erban , i.  kevrekidis , d.  adalsteinsson , and t.  elston , _ gene regulatory networks : a coarse - grained , equation - free approach to multiscale computation _",
    ", journal of chemical physics * 124 * ( 2006 ) , 084106 .",
    "m.  ward , _ exponential asymptotics and convection - diffusion - reaction models _ , analyzing multiscale phenomena using singular perturbation methods ( j.  cronin and r.  omalley , eds . ) , proceedings of symposia in applied mathematics , vol .",
    "56 , ams , 1999 , pp ."
  ],
  "abstract_text": [
    "<S> a framework for the analysis of stochastic models of chemical systems for which the deterministic mean - field description is undergoing a saddle - node infinite period ( sniper ) bifurcation is presented . </S>",
    "<S> such a bifurcation occurs for example in the modelling of cell - cycle regulation . </S>",
    "<S> it is shown that the stochastic system possesses oscillatory solutions even for parameter values for which the mean - field model does not oscillate . </S>",
    "<S> the dependence of the mean period of these oscillations on the parameters of the model ( kinetic rate constants ) and the size of the system ( number of molecules present ) is studied . </S>",
    "<S> our approach is based on the chemical fokker - planck equation . </S>",
    "<S> to get some insights into advantages and disadvantages of the method , a simple one - dimensional chemical switch is first analyzed , before the chemical sniper problem is studied in detail . </S>",
    "<S> first , results obtained by solving the fokker - planck equation numerically are presented . </S>",
    "<S> then an asymptotic analysis of the fokker - planck equation is used to derive explicit formulae for the period of oscillation as a function of the rate constants and as a function of the system size .    </S>",
    "<S> stochastic bifurcations , chemical fokker - planck equation    80a30 , 37g15 , 92c40 , 82c31 , 65n30 </S>"
  ]
}