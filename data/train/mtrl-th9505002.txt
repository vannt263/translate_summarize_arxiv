{
  "article_text": [
    "density - functional calculations performed within the framework of the local - density approximation ( lda ) have been demonstrated to give accurate predictions of many physical properties of solids.@xcite the introduction of the pseudopotential approximation greatly simplifies electronic - structure calculations by eliminating the need to include atomic core electrons and the strong potentials responsible for binding them.@xcite the introduction of norm - conserving pseudopotentials by hamann , schlter and chiang ( hsc)@xcite led to greatly improved control of transferability errors , and as a result the pseudopotential approach has since found a wide range of applications in molecular and solid - state electronic - structure theory .",
    "nevertheless , transferability is still an issue in many calculations , especially when uncomfortably large pseudopotential cutoff radii have been dictated by the requirements of a modest plane - wave cutoff in the solid - state calculation , and for atoms having shallow core shells .",
    "a pseudopotential ( psp ) is constructed to replace the all - electron ( ae ) atomic potential in such a way that core states are eliminated .",
    "the most important measure of a pseudopotential is its transferability , which characterizes the accuracy with which it mimics the real ae atom in different atomic , ionic , molecular , or solid - state environments .",
    "traditionally , the transferability of a pseudopotential is characterized by two properties : ( i ) a comparison of the scattering properties of the real and pseudo versions of the free atom or ion , as measured by the logarithmic derivative of the wavefunction at some diagnostic radius as a function of energy ; and ( ii ) configuration tests , which check if the pseudo eigenvalues and total energies track the ae ones for various excited states of the free atom or ion .",
    "it is important to note that spherical symmetry is implicit in both of these approaches , so that neither is capable of giving information about transferability to anisotropic environments .",
    "scattering properties are certainly a significant aspect of transferability : poor scattering properties are indicative of a poor pseudopotential .",
    "a major contribution of hsc was to show that the norm - conserving condition automatically implies that not only the logarithmic derivative , but also its energy derivative , is guaranteed to be correct for the psp at a reference energy , thus insuring that the ae and psp scattering properties will match closely over a large energy range.@xcite thus norm - conserving potentials tend to have much better transferability for most elements .",
    "however , the matching of logarithmic derivatives is not always sufficient to ensure good transferability .",
    "some potential sources of error which will not show up in tests of scattering properties are ( i ) electrostatic screening effects , and ( ii ) effects of non - linearity of the exchange - correlation energy ( important for many alkali - metal elements ) .",
    "errors of the former type are usually easily eliminated by the choice of a `` conservative '' cutoff radius,@xcite while those arising from core - valence overlap can largely be corrected by use of the frozen - core correction.@xcite nevertheless , these examples illustrate the dangers of focusing on scattering properties alone .",
    "configuration tests are certainly useful as a supplementary criterion , but as mentioned above , they do not control the quality of the psp in a nonspherical target environment",
    ". this will obviously be important for atoms in surface , defective , molecular , or liquid environments , to name just a few .",
    "furthermore , it is difficult to include the configuration tests systematically as part of the psp generation procedure .",
    "as lda calculations are pushed in the direction of high accuracy , psp errors become less tolerable , putting tight requirements on transferability . on the other hand ,",
    "as the calculations are pushed to larger system sizes , the increased computational load requires that the psp be as smooth ( soft ) as possible .",
    "this has led to a tremendous effort to optimize psp softness.@xcite unfortunately , transferability and softness are usually contradictory requirements . especially for first - row elements , attempts to save computational cost frequently result in the use of a psp with an uncomfortably large core cutoff radius . because of the above - mentioned electrostatic screening problems , this strategy may result in a sacrifice of transferability which would be difficult to detect using the conventional methods .",
    "it is therefore of great importance to develop improved measures of transferability which will allow for improved control of psp errors in cases like these .",
    "it is especially desirable to develop methods which work directly at the atomic level , without the need for painstaking comparisons of pseudo and ae results in molecular and solid - state environments .    in this paper",
    ", we propose to use the linear - response properties of a reference free atom or ion as a measure of the transferability of a psp .",
    "we calculate two kinds of linear - response properties : a generalized chemical hardness , and the dipole and higher - moment susceptibilities .",
    "chemical hardness measures the derivatives of electronic eigenvalues with respect to changes of occupation .",
    "it was recently proposed by teter@xcite as an important measure of psp transferability , partly based on the idea that the chemical potential and hardness have equal roles in determining electron charge transfers . to some extent ,",
    "the hardness analysis is redundant with configuration tests ( of which it is a kind of differential version ) , but it is more systematic and can be incorporated into psp generation more easily.@xcite the concept of hardness is generalized in this paper to include also information about the response to non - spherical perturbations .",
    "this is in fact very important , and we shall see that the rearrangement of charge in a @xmath0-shell may dominate the error in the hardness matrix .",
    "we further include the self - consistent change of the wavefunctions in our calculations in order to go beyond the frozen - wavefunction approximation ( fwa ) introduced by teter.@xcite finally , the dipole ( and quadrupole , etc . ) susceptibility tests measure the ability of the pseudo atom to imitate the correct ae behavior in a local electric field ( or field gradient , etc . ) which may result from an anisotropic solid - state or molecular environment .",
    "this paper is arranged as follows . in sec .",
    "ii we review the concept of chemical hardness and introduce the formulation for calculating both spherical and non - spherical hardness .",
    "we also outline the calculation of the dipole and higher - order polarizabilities . in sec .",
    "iii , we present calculated chemical hardness matrices and polarizabilities for some representative atoms chosen from different parts of the periodic table .",
    "we discuss the general trends in the hardness matrix , and the effect of the frozen - core correction .",
    "we also proposed a quantity based on the hardness matrix to characterize the pseudopotential transferability .",
    "finally , we conclude in sec .",
    "teter defines the chemical hardness matrix @xmath1 within the lda as@xcite @xmath2\\over \\partial f_i\\partial f_j } \\ ; , \\label{zero}\\ ] ] where @xmath3 is the janak functional@xcite and @xmath4 is the occupation number of the @xmath5th state . since the eigenvalue @xmath6 , we have @xmath7 thus , the hardness matrix measures the first - order change of an energy eigenvalue resulting from a first - order variation of an occupation number , while allowing the total number of electrons to vary .",
    "it consists of two parts : one due to the change of the screening potential with variation of the occupation number for fixed wavefunctions , and one arising from relaxation of the wavefunctions .",
    "teter made the approximation of omitting the second term , but both are included here .",
    "frequently , one is interested only in the case where the occupations of the states comprising a given shell are kept equal .",
    "for example , one may consider an excitation in which one transfers an @xmath8 electron to the @xmath0 shell , increasing the occupation of each @xmath0 state by 1/3 .",
    "this insures retention of spherical symmetry of the charge density and potential , and is implicit in all of the analysis which is usually carried out with an atomic pseudopotential program . in this case ,",
    "different @xmath9 components remain degenerate and the treatment is simple.@xcite in real situations ( in molecules , at surfaces , etc . ) , atoms may have very anisotropic environments , so that non - spherical changes of electron occupation become important .",
    "this prompts us to consider also changes of occupation which lead to nonspherical changes of density and screening potential .",
    "we will use the index @xmath10 to refer to density or potential changes having angular character @xmath11 .",
    "thus , we shall not restrict ourselves to spherically symmetric ( @xmath12 ) perturbations , but will consider the general @xmath13 case .    for this purpose , it is useful to generalize from the concept of an occupation number @xmath4 to the concept of an `` occupation matrix '' or `` density matrix '' @xmath14 .",
    "this generalization , previously introduced in other contexts,@xcite makes the hardness analysis more complete .",
    "it is described in subsec .",
    "iic below . while @xmath14 is diagonal in the atomic ground state , or in a basis of energy eigenstates of a perturbed system , it may be non - diagonal in a more general representation of a perturbed system such as an atom in a defective environment .",
    "in our calculations , we use first - order density - functional perturbation theory in the framework of lda , following the scheme formulated by mahan and subbaswamy.@xcite in the remainder of this section , we first give a detailed formulation of the calculation of the hardness matrix elements associated with conventional diagonal occupation number changes , and discuss the extension beyond the frozen - wavefunction approximation ( fwa ) .",
    "next , the generalization to non - diagonal occupation changes will be presented . finally ,",
    "we sketch the calculation of the dipole and higher susceptibilities , which is straightforward after the machinery needed to calculate the hardness elements has been set up .      within the framework of lda , application of the hellmann - feynman theorem to eq .",
    "( [ ehdef1 ] ) yields @xmath15| \\psi_i\\rangle \\nonumber\\\\      & = & { 1\\over 2 } \\langle\\psi_i      | { \\partial v_{\\rm hxc } \\over \\partial \\rho }        { \\partial \\rho \\over \\partial f_j } | \\psi_i\\rangle \\ ; , \\end{aligned}\\ ] ] where @xmath16 is the hartree and exchange - correlation potential . with atomic quantum numbers ,",
    "this becomes @xmath17 here , @xmath18",
    "the density variation due to the variation of occupation numbers consists of two terms : @xmath19 the first term arises from the explicit dependence of density on the occupation numbers , while the second involves relaxation of the wavefunction with changes of occupation .",
    "we will refer to the neglect of @xmath20 as the `` frozen wavefunction approximation '' ( fwa ) , while the effect of the @xmath20 term will be referred to as the `` self - consistency '' ( sc ) correction .",
    "the fwa part of the hardness matrix is relatively easy to calculate , and it has previously been done for almost all atoms in the periodic table.@xcite the sc correction is treated using density - functional linear response theory , regarding the change of @xmath21 as an external perturbation .",
    "we start with the calculation of the fwa hardness , which may be written @xmath22 where @xmath23 the kernel @xmath24 can be decomposed as @xmath25 where @xmath26 and @xmath27 and @xmath28 are the smaller and larger of @xmath29 and @xmath30 respectively .",
    "note that the exchange - correlation term , being local , is independent of @xmath10 .",
    "the functions @xmath31 and @xmath32 can also be expressed in spherical harmonics as @xmath33 @xmath34 where the @xmath35 are gaunt coefficients , reflecting the presence of squared spherical harmonics in @xmath36 . here and in the remainder of this subsection , the sums are over even @xmath10 only . defining @xmath37",
    "the fwa hardness can be expressed as @xmath38 where @xmath39 is the smaller of @xmath40 and @xmath41 .",
    "of course , the presence of @xmath42 induces a change @xmath43 in the charge density . the sc correction to the hardness",
    "can be calculated by including this change self - consistently , treating @xmath32 as a bare potential perturbation .",
    "we can write @xmath44 where @xmath45 is the linear susceptibility ( to be discussed below ) . according to a theorem by eaves and epstein,@xcite",
    "the induced charge density for a closed - shell atom has the same angular character as the perturbing potential . within lda",
    "( with spin - polarization neglected ) the ground state is always isotropic ( equal population of each @xmath9 character of any given shell ) , so this theorem applies .",
    "thus , to linear order we can write @xmath46 where @xmath47 is the linear susceptibility in radial coordinates for perturbations of angular character @xmath10 , and @xmath48 in analogy with eq .",
    "( [ antonio ] ) . after defining @xmath49 the sc correction to the hardness matrix becomes @xmath50    the determination of the linear susceptibility @xmath51 follows closely the modified sternheimer approach discussed by mahan and subbaswamy.@xcite in what follows , we consider the response @xmath52 to a general perturbation @xmath53 of angular character @xmath10 .",
    "( we have @xmath54 and @xmath55 in the immediate context , where @xmath56 are indices of the state whose occupation is being varied .",
    "however , the discussion given below is general , and the indices @xmath57 will henceforth be taken to refer to arbitrary occupied wavefunctions which respond to the perturbation . )",
    "we do not actually need to calculate @xmath45 itself ; instead , it is sufficient to specify an iterative algorithm for calculating its action @xmath58 upon the arbitrary perturbation .",
    "the procedure is as follows . for the moment , assume that the first - order density change @xmath59 is known ; then the corresponding change @xmath60 in the screened kohn - sham potential is given by @xmath61 this induces a first - order change in each kohn - sham wavefunction satisfying @xmath62 where @xmath63 , and @xmath64 are the unperturbed kohn - sham hamiltonian , eigenvalue , and eigenfunction , respectively , and @xmath65 and @xmath66 are the corresponding first - order changes .",
    "decomposing eq .",
    "( [ ccitua ] ) into angular and radial parts , one finds @xmath67 where the @xmath68 are clebsh - gordon coefficients and the radial functions @xmath69 are the solutions of the radial part of eq .",
    "( [ ccitua ] ) , @xmath70 \\delta r_{nll'}(r)=\\left[\\delta \\epsilon_{nlm } -\\delta v_{\\rm scf}(r)\\right]r_{nl}(r ) \\ ; . \\label{erks}\\ ] ] this inhomogeneous equation is solved numerically on a radial mesh following ref .  . finally , the change of density resulting from eq .",
    "( [ delpsi ] ) is @xmath71 where @xmath72 , and the geometric coefficients @xmath73 are given on p.  55 of ref .. iterative solution of eqs .",
    "( [ edv ] ) , ( [ erks ] ) , and ( [ edna ] ) thus gives the self - consistently screened density change @xmath59 resulting from the perturbation @xmath74 in eq .",
    "( [ chil ] ) .",
    "if one wants to express _ any _ atomic charge density in terms of ( both filled and empty ) kohn - sham orbitals of a reference ground - state atom , then in general the occupation numbers turn out to be non - diagonal , so that the total charge density should be expressed as @xmath75 where @xmath76 only in the ground state .",
    "the most general result of a perturbation is thus obtained by allowing for non - diagonal terms @xmath14 to exist,@xcite and by taking this into account we arrive at a more general form of the hardness matrix .",
    "this provides a natural way to test the transferability of a psp to nonspherical environments .    instead of working in the explicit atomic representation @xmath77",
    ", we find it convenient to work in a representation @xmath78 in which @xmath79 are labels of total angular momentum , and @xmath80 following the usual angular - momentum addition rules .",
    "introducing also the condensed notation @xmath81 , we thus have @xmath82 where @xmath83 with @xmath84 again being the clebsh - gordon coefficients , and @xmath85 . in this notation",
    ", it is natural to introduce the generalized kohn - sham eigenvalues @xmath86 and the generalized hardness matrix @xmath87    since our reference unperturbed configuration is spherically symmetric , @xmath88 is only nonzero for @xmath89 and @xmath90 , @xmath91 .",
    "spherical symmetry also implies that the hardness matrix reduces to @xmath92 the fwa hardness becomes just @xmath93 where the quantity @xmath94 is as defined in eq.([cisterna ] ) ( now generalized to odd as well as even @xmath10 ) .",
    "the calculation of the sc correction proceeds along similar lines as for the diagonal case .",
    "the perturbing potential is generalized to @xmath95 and the self - consistent correction is given by @xmath96    in the special case @xmath97 and @xmath98 , the quantities @xmath99 and @xmath100 reduce to @xmath101 and @xmath102 , respectively , as defined in the previous subsection .",
    "thus , all of the diagonal hardness matrix elements are contained as special cases of the generalized non - diagonal ones introduced here .",
    "moreover , the original diagonal formulation only covers variations of the screening potential or density of even @xmath10 ( monopole , quadrupole , etc . ) , whereas the generalized formulation is capable of treating variations of any angular character .",
    "in fact , perturbations of dipole ( @xmath103 ) character are likely to be the most important nonspherical perturbations in many molecular and solid - state environments , especially at surfaces and other defects where inversion symmetry is lacking .",
    "therefore , in what follows we will concentrate on comparisons of the ae and psp non - diagonal hardness elements @xmath104 , with special emphasis on the @xmath12 and @xmath103 cases .",
    "the polarizability of an atom measures its response to an external electric field .",
    "the dipole ( @xmath103 ) , quadrupole ( @xmath105 ) , and higher ( @xmath106 ) polarizabilities are defined as the derivatives of the @xmath10th induced charge moment with respect to an electrostatic potential of form @xmath107 .",
    "for good transferability , it is important that the pseudo - atom have polarizabilities similar to those of the all - electron atom .",
    "we can expect the lower - moment polarizabilities to be more important , so we focus on the dipole and quadrupole susceptibility in what follows",
    ". tests of the non - selfconsistent polarizability of hsc pseudopotentials have previously been performed for a large number of closed - shells atoms and ions by bachelet _",
    "et al._@xcite here , we extend the tests to other atoms and also include the sc correction .    the formulation and calculation of the polarizability is straightforward@xcite using the machinery developed in the previous subsections .",
    "the perturbing potential is taken to have the form @xmath108 and the linearly induced density change is @xmath109 this is evaluated using the same iterative procedure given previously in eqs .  ( [ edv]-[edna ] ) .",
    "the polarizability in angular channel @xmath10 is then @xmath110 with @xmath111 and @xmath112 being the dipole and quadrupole susceptibility , respectively .",
    "in this part , we present our calculated hardness matrix elements for a set of representative atoms . we begin with all - electron atoms , surveying the characteristics of the hardness matrix and the basic trends as a function of position in the periodic table .",
    "we concentrate first on argon , making the comparison between the ae and psp hardness matrix , discussing sources of error , and introducing our format for presenting results in a systematic fashion .",
    "next , we discuss trends as one goes across the periodic table , and evaluate the importance of the louie - froyen - cohen ( lfc)@xcite semi - core correction and the effects of varying the core radius .",
    "we will then propose a method to extract the most important information from the large number of hardness elements .",
    "finally , the calculated ae and psp polarizabilities will be presented at the end of this section .",
    "the results reported here are restricted to potentials of the hsc type .",
    "we believe that these results can be taken as indicative for the whole class of norm - conserving hsc - like psps,@xcite provided comparable cutoff radii are chosen . for kleinman - bylander,@xcite",
    "ultrasoft,@xcite or other approaches to psp construction which deviate significantly from the original hsc method , addition investigation may be appropriate .      before studying the transferability of psps with reference to the hardness matrix elements @xmath1 , we first need to understand the behavior of @xmath1 for all - electron atoms in order to obtain some physical intuition . in table",
    "[ boia ] , we show some matrix elements of the generalized hardness for three characteristic ae atoms in the periodic table . silicon and argon are taken in the ground - state neutral configuration , while for sodium we choose an ionized valence configuration @xmath113 in order to ensure that the @xmath0 electron is bound .",
    "the total self - consistent hardness @xmath114 is broken down into frozen - wavefunction - approximation and self - consistent - correction pieces as discussed in the previous section .",
    "for some elements , the fwa contribution is further separated into hartree ( h ) and exchange - correlation ( xc ) contributions , @xmath115 .",
    "the matrix elements can be identified by quantum numbers @xmath116 , @xmath117 , and @xmath10 .",
    "since the principle quantum numbers @xmath118 are obvious in most cases , we will usually omit them and write the indices simply as @xmath119 .    from table",
    "i , we see that @xmath120 typically dominates , and the self - consistent correction @xmath121 is only about @xmath122% of @xmath120 . nevertheless , this is clearly large enough that complete neglect of @xmath121 is unjustified .",
    "it is also obvious from the table that @xmath120 are mostly positive , while the @xmath121 are negative . for the diagonal elements ( e.g. , excluding @xmath123 ) ,",
    "this can be understood as follows . from eq .",
    "( [ londra ] ) , the hartree part of @xmath124 can be seen to have the form of the coulomb self - energy of a particular charge distribution @xmath125 , which must be positive . on the other hand ,",
    "the exchange - correlation contribution is negative because @xmath126 in eq .",
    "( [ cisterna ] ) is negative .",
    "typically , the hartree term dominates and @xmath120 is positive . regarding @xmath121 , note that eq .",
    "( [ torino ] ) can be interpreted as evaluating the second - order energy change of the system when the external potential of eq .",
    "( [ madrid ] ) is applied ; the total energy must go down when the wavefunctions relax , so that @xmath121 must be negative .",
    "going from na to ar , we find that @xmath127 increases strongly , primarily because of the hartree contribution @xmath128 to @xmath120 .",
    "this is in agreement with our intuition , since the wavefunctions become much more localized as one moves from left to right across the periodic table , causing @xmath128 to increase sharply . in this sense",
    ", we can refer to atoms ( like ar ) on the right side of the periodic table as `` strongly electrostatic atoms '' or `` hard atoms , '' while those on the left side ( like k ) can be termed `` soft . ''",
    "our results also indicate that the matrix elements of @xmath129 for @xmath12 are significantly larger than those for @xmath130 .",
    "this implies that the diagonal hardness elements defined in eqs .",
    "( [ france ] ) and ( [ fifth ] ) are dominated by the spherically symmetric part of the response .",
    "a closer inspection reveals that @xmath128 decreases strongly with increasing @xmath10 , while @xmath131 is smaller and , being a local operator , independent of @xmath10 .",
    "this gives rise to an overall small @xmath129 for high @xmath10 .",
    "in a few cases where the valence wavefunction was very weakly bound and delocalized , we have found that @xmath131 can even be larger in magnitude than @xmath128 , resulting in a small but _ negative _ @xmath127 .",
    "we regard this as an unphysical result which reflects the overestimate of exchange - correlation effects by the lda in the low - density tail of the atom .",
    "having gained some understanding of the ae hardness matrix , we turn now to a comparison of the psp hardness elements with the corresponding ae ones .",
    "we begin with argon . in table",
    "[ t_argon ] we list values for some important hardness matrix elements calculated for the ae and psp @xmath132 ion in configuration @xmath133 . the hsc psp was generated in this configuration , using a core radius @xmath134 a.u .",
    "we also show the relative errors for another valence configuration , @xmath135 .    comparing the ae and psp results",
    ", we find very good agreement for the @xmath12 matrix elements .",
    "norm conservation imposes the constraint that the @xmath12 component of the electrostatic potential in the psp case should match the ae one outside the core region .",
    "consequently , for small core radii the differences between ae and psp values of @xmath128 are essentially confined to @xmath130 moments .",
    "actually , we find that the errors in @xmath128 are relatively insensitive to a modest increase of core radius for hard atoms like ar . because of this constraint , while the hartree contribution is large in magnitude , it may only incur a small error in hardness .",
    "for ar , the @xmath136 are quite small and their contribution to the error is not very significant .",
    "so , for ar , the agreement between ae and psp hardness elements is excellent in the spherically - symmetric ( @xmath12 ) channel .",
    "the relative errors for @xmath130 channels are larger ( @xmath137 for @xmath103 and @xmath138 for @xmath105 ) . however , since their absolute magnitudes are small , they are not as important . as a result ,",
    "the overall agreement between ae and psp hardness is very good",
    ". we also checked that changing the testing configuration affects the results only very slightly .    in order to avoid presenting numerous cumbersome tables ,",
    "we have converted the information into the form of a bar chart as shown in fig .",
    "the heights of the bars represent the values of the corresponding hardness matrix elements .",
    "the columns indicate different contributions to a given hardness matrix element , whose indices are labeled by the row .",
    "the results for all - electron and pseudo atoms are placed side - by - side to facilitate comparison ; hollow bars indicate ae results while dashed bars represent psp results .",
    "the values for @xmath139 elements , being small , are magnified in the diagram .",
    "we believe the discussion is easier to follow by viewing such diagrams , so all subsequent hardness results will be presented in this way .",
    "argon is a rare - gas element . to explore the general trends of the hardness matrix along the periodic table , we further calculated the hardness matrix for atoms having a wide range of properties .",
    "we start with si .",
    "to study the effect of core radius @xmath140 on the quality of psp generated , we plot in fig .",
    "[ f_si ] the results for both small and large @xmath140 indicated by dashed and shaded bars respectively ( values for @xmath140 are indicated in the captions ) .",
    "the ae results are still plotted with hollow bars .",
    "these results are for si@xmath141 in configuration @xmath142 . for small @xmath140 ,",
    "the psp hardness elements for si agree with the ae results very well ( the biggest errors occur for @xmath103 elements as for ar ) . with the exception of @xmath143 elements , a worsening of the agreement in total hardness",
    "is evident in the @xmath12 channel for larger @xmath140 .",
    "( the @xmath144 wavefunction is nodeless and very delocalized , and thus insensitive to changes in core radius . )",
    "one expects that increasing @xmath140 should always make the psp less transferable , but the sensitivity can be different for different elements . in fig .",
    "[ f_o ] , we show a similar diagram for oxygen , again using hashed and shaded bars to represent hardness elements for a psp with small and large @xmath140 .",
    "we find that the effect of increasing @xmath140 is more dramatic for o. a more complete picture of the effect of @xmath140 will be presented later .",
    "we next focus on some cases to characterize the role of the lfc correction.@xcite in the following figures , we use the shaded bars to represent psp results with such lfc correction .",
    "the results we presented are for k@xmath145 in @xmath146 ( fig .",
    "[ f_k ] ) , ti@xmath147 in configuration @xmath148 ( fig .",
    "[ f_ti ] ) , c@xmath149 in @xmath150 ( fig .",
    "[ f_c ] ) , and ga@xmath151 in @xmath152 ( fig .",
    "[ f_ga ] ) . starting with k",
    "we find as expected that the lfc greatly reduces the error due to the @xmath136 contribution to the hardness matrix elements even for the @xmath12 channel .",
    "the lfc - corrected hardness matrices are in good agreement with the ae results . for ti ,",
    "the lfc successfully corrected the noticeable mismatch between ae and no - lfc results for @xmath131 contributions to the @xmath153 and @xmath154 elements .",
    "( the no - lfc total hardness in the @xmath155 happens to match the ae one rather closely , but only because of a fortuitous cancellation of errors . ) for c and ga , the effect is small except for some high-@xmath10 channels ( i.e. @xmath156 elements ) , and we regard the lfc as less necessary for these elements .",
    "the hardness results obviously depend on details of the psp construction , but we note the following general trends . in going from left to right across a row of the periodic table , an increasing atomic number tends to localize the core density closer to the nucleus and to reduce the size of the core .",
    "consequently , the overlap between core and valence charge densities , which is the source of the nonlinearity in the exchange - correlation potential , gets smaller and smaller .",
    "such an overlap , when significant , is largely responsible for the errors in the self - consistent contribution to hardness as well , i.e. , for a poor description of the rearrangement of the pseudo wavefunctions .",
    "provided that one takes small core radii to minimize errors in the hartree contributions , the degree of core - valence overlap almost entirely determines the psp transferability .",
    "rare gas atoms thus have maximum transferability without lfc , while alkali atoms need the lfc correction the most .",
    "moving along the _ columns _ of the periodic table , the trends are naturally much weaker . the net positive charge seen by the valence electrons",
    "does nt change , and the localization of the core and valence charge densities changes only marginally .",
    "however , a slight increase of overlap occurs , along with a corresponding loss of transferability of non - lfc psp , as one goes down the columns .    from our hardness matrix results , we can investigate whether there is a systematic way to improve the psp transferability .",
    "the hartree contribution can be improved by imposing additional conditions on the pseudo wavefunctions , e.g. , matching of the valence electrostatic potentials for higher - order multiple moments.@xcite however , it is not clear whether the gain in transferability would justify the drawbacks of imposing additional constraints . as regards the exchange - correlation terms , while some other approaches have been tried,@xcite the lfc correction seems to be the simplest and most efficient method .",
    "we have shown that it is useful to characterize the transferability of a psp in terms of its hardness matrix .",
    "however , there is so much information contained in the numerous matrix elements of the hardness matrix that it becomes difficult to decide whether a particular psp shows `` good '' or `` poor '' transferability .",
    "thus , it is desirable to define a single quantity that can be used to represent approximately the overall transferability of the psp .",
    "there is certainly no unique way to do this , since the importance of different matrix elements depends on the target application .",
    "nevertheless , we propose one such definition , which at least can be used as a starting point .",
    "we define an average hardness error @xmath157 as follows : @xmath158 here @xmath159 is the difference between total ae and psp hardness matrix elements , and @xmath160 is a weight to be defined shortly .",
    "thus , @xmath157 is just a weighted rms average of the errors in the hardness matrix elements .",
    "to fix the weights @xmath160 , we have adopted the following philosophy .",
    "we want @xmath157 to represent an average total - energy error which would occur as the psp atom is transferred to an ensemble of target environments , where the distribution of target environments is characterized by specifying the average occupation @xmath161 and the typical fluctuation in occupation @xmath162 , for each electron shell . in the spirit of the hardness approach",
    ", we can estimate the change in total energy of the atom as it is inserted into a given environment as @xmath163 if each contribution were statistically independent , one would have @xmath164 making the additional rough approximation that @xmath165 and @xmath166 ( where @xmath167 and the @xmath118 subscripts are suppressed ) and replacing @xmath168 by the ae vs.  psp error @xmath169 , we arrive at the right - hand side of eq .",
    "( [ muzio ] ) with @xmath170 where it remains to fix the occupation fluctuation @xmath162 . to make things simple , we assume that the fluctuation @xmath162 is a function only of the average occupation @xmath161 and the maximum occupation @xmath171 of the shell .",
    "we choose the form @xmath172 where @xmath173 is the fractional occupancy , @xmath174 .",
    "the first term makes the fluctuation proportional to the number of electrons which could be accommodated in the shell , and the second forces the fluctuation to zero for either a completely filled or a completely empty shell in a manner which respects electron - hole symmetry .",
    "thus , we have defined @xmath157 through eqs .",
    "( [ muzio ] ) , ( [ weights ] ) and ( [ etas ] ) , in such a way that it depends only on a specification of the reference electronic configuration ( the @xmath161 values ) .",
    "our definition puts no weight on completely filled or completely empty shells , and heavily weights partially - filled shells .",
    "we would be the first to admit that the choices above are largely arbitrary , but we believe they are reasonable ones , and we proceed to use this measure to study the effect of variations in core radius upon psp transferability . in figs .  [ f_av1 ] and [ f_av2 ] , we show the calculated average hardness error @xmath157 for a set of six elements as a function of @xmath175 . here , @xmath176 is kept constant .",
    "we do not change @xmath177 , since it does not affect @xmath157 appreciably for the atoms studied here ( with no @xmath144 electrons inside the core ) .",
    "the hardness error @xmath157 ( and the hardness itself ) is much greater for first - row elements c and o , so they are plotted on a different scale .",
    "it can be seen that the behavior of @xmath157 differs considerably between elements . for k",
    ", @xmath157 is very insensitive to @xmath140 , and there is thus wide flexibility in the choice of an appropriate @xmath140 . for o , c , and ga , @xmath157 increases in an approximately linear fashion as @xmath140 is increased from 1.5 to 3.5 au , while @xmath157 increases more rapidly for si and ar as @xmath140 is increased .      in table",
    "[ sondrio ] , we show our calculated dipole ( @xmath103 ) and quadrupole ( @xmath105 ) polarizability for some ae and psp atoms .",
    "our ae results for rare - gas and closed - shell ions agree very well with previous calculations.@xcite the results for the dipole polarizability are also in good agreement with experiment .",
    "( experimental values for higher - moment polarizability do not appear to be available . ) for example , for the k@xmath141 ion , we find the dipole susceptibility to be 5.74 a.u .",
    ", compared to 5.86 a.u . and 5.47 a.u .",
    "from previous theory@xcite and experiment@xcite , respectively . note that most of the results reported below are for open - shell atoms or ions . it should be emphasized that in these cases , our results are a theoretical fiction in that we assume symmetrized occupations ( e.g. , @xmath178 for c ) which have little relation to the real atomic ground state .",
    "nevertheless , we believe it is meaningful to compare ae and psp polarizability calculated in this way as a means of testing the transferability of a psp .",
    "we tend to prefer tests on ionized configurations ( e.g. , si@xmath141 instead of si ) because we have found that shallow orbitals in neutral open - shell atoms sometimes give such enormous contributions to the polarizability that comparison becomes difficult .",
    "all psps are built choosing small core radii ( e.g. , @xmath179 a.u . for si@xmath141 ) , and for k the lfc correction was used .",
    "we first consider the all - electron results . to test the effect of self - consistent screening , we report both frozen - wavefunction approximation ( fwa ) and self - consistent ( sc ) polarizabilities .",
    "all pseudopotentials are built choosing small core radii , and for potassium , the lfc correction is used . in all cases ,",
    "the core polarizability is included in the all - electron value . as a example",
    ", we show the core contribution of @xmath180 to its all - electron polarizability .",
    "looking at table [ sondrio ] , it is evident that only the dipole polarizability is strongly affected by self - consistent screening .",
    "the screening reduces the dipole polarizability by around 40% , while the quadrupole susceptibility is typically reduced by only about 3% .",
    "exceptions to this pattern occur for some highly polarizable atoms like potassium , for which the screening correction is still sizeable in the quadrupole channel .",
    "three factors contribute to the difference between psp and ae polarizability : ( i ) the core contribution ; ( ii ) the difference between unperturbed pseudo and ae wavefunctions inside the core region ; and ( iii ) differences in the first - order changes in the valence wavefunctions . regarding ( iii )",
    ", the wavefunction changes are determined in part by admixture of angular - momentum components higher than those which are present in the unperturbed reference configuration . for these components",
    "( typically @xmath181 ) , no norm - conservation or tail - matching conditions were imposed . because the psp usually contains no nonlocal projectors for large @xmath40 , these wavefunctions feel only the local potential , which is usually set in a very arbitrary manner .",
    "this appears to be the most significant source of error in psp polarizability .",
    "for example , we have calculated the psp polarizability of ar both with and without an @xmath182 component in the nonlocal projector .",
    "we find that the calculated values for both the dipole and quadrupole polarizabilities are about 15% too small when the @xmath182 component of the projector is omitted .",
    "this effect was already noted in ref .",
    ", where many other examples can be found .",
    "all the results in table [ sondrio ] are obtained using a psp with a complete projector ( up to @xmath183 ) .",
    "the results in the table indicate that while the screening correction generally improves the agreement between ae and psp for the dipole susceptibility , the error in the quadrupole susceptibility is almost unaffected .",
    "generally , we find a very good agreement between the self - consistent ae and psp results .",
    "however , it should be noted that all results shown in the table were obtained using a psp generated from the same configuration for which the polarizability calculation was made .",
    "if we change the psp reference configuration considerably , larger changes in the calculated pseudo - polarizability may occur .",
    "we present a systematic method for characterizing the transferability of pseudopotentials using their linear - response properties , specifically their generalized chemical hardness and dipole and quadrupole polarizabilities .",
    "the hardness measures the ability of the psp to resemble the all - electron atom in different atomic environments , including non - spherical ones , while the polarizability reflect the response of the psp atom to external fields .",
    "when used together with conventional criteria such as norm - conservation and matching of eigenvalues and logarithmic derivatives , this approach allows a rather complete characterization of psp transferability .",
    "we have applied the method to study the behavior of hamann - schlter - chiang pseudopotentials for many atoms in the periodic table . as expected",
    ", the calculated hardness matrix indicates that the transferability deteriorates as the core radius is increased .",
    "for some elements with relatively delocalized cores , we find strong evidence for the importance of including the louie - froyen - cohen semi - core correction .",
    "we propose a method for reducing the large amount of information contained in the hardness matrix to a single number .",
    "we suggest that this quantity be monitored or included in the fitting procedure when generating pseudopotentials , in order to achieve the desired properties ( e.g. , optimal smoothness ) without sacrificing transferability .",
    "dv and wz gratefully acknowledge support from nsf grant dmr-91 - 15342 and onr grant n00014 - 91-j-1184 .",
    "af and gbb acknowledge support from the progetto finalizzato sistemi informatici e calcolo parallelo of the italian national research council , cnr grants 89.0006.69 and 89.00051.69 .",
    "af also thanks r.  w.  nunes for his kind help and the department of physics and astronomy of rutgers university for its warm hospitality during part of this project .",
    "a. zangwill and p. soven , phys .",
    "a * 21 * , 1561 ( 1980 ) .",
    "m. j. stott and e. zaremba , phys .",
    "a * 21 * , 12 ( 1980 ) .",
    "r.  r.  freeman and d. kleppner , phys .",
    "a * 14 * , 1614 ( 1976 ) ; j. c. lombardi , phys .",
    "a * 36 * , 1445 ( 1987 ) .",
    ".calculated all - electron hardness matrix elements of three representative atoms na , si , and ar .",
    "both frozen - wavefunction approximation ( fwa ) and self - consistent ( sc ) contributions to the total hardness elements are listed .",
    "for some matrix elements , the fwa hardness is broken down into hartree ( h ) and exchange - correlation ( xc ) contributions .",
    "[ boia ] [ cols=\"<,>,>,>\",options=\"header \" , ]     lrrcrrc & & + & ae & psp & error ( % ) & ae & psp & error ( % ) + dipole + k@xmath141 & 8.89 & @xmath184 & @xmath184 & 5.74 & @xmath184 & @xmath184 + k@xmath185 ( @xmath186 ) & 181.94 & 175.76 & 3.4 & 165.89 & 164.83 & 0.6 + c@xmath141 ( @xmath187 ) & 10.04 & 10.16 & 1.2 & 6.04 & 6.04 & 0.0 + ar@xmath151 ( @xmath188 ) & 13.82 & 13.93 & 0.8 & 9.01 & 9.02 & 0.2 + si@xmath141 ( @xmath187 ) & 31.61 & 31.82 & 0.7 & 19.11 & 19.19 & 0.4 + ga@xmath151 ( @xmath189 ) & 46.97 & 45.12 & 3.9 & 29.60 & 29.97 & 1.2 + ge@xmath141 ( @xmath187 ) & 30.38 & 29.60 & 2.6 & 18.93 & 19.12 & 0.9 + ti@xmath141 ( @xmath190 ) & 90.50 & 90.61 & 0.1 & 47.98 & 48.26 & 0.6 + quadrupole + k@xmath141 & 18.7 & @xmath184 & @xmath184 & 18.2 & @xmath184 & @xmath184 + k@xmath185 ( @xmath186 ) & 2530 & 2521 & 0.3 & 3044 & 3029 & 0.5 + c@xmath141 ( @xmath187 ) & 16.4 & 16.4 & 0.0 & 16.8 & 16.8 & 0.0 + ar@xmath151 ( @xmath188 ) & 38.2 & 38.2 & 0.0 & 37.8 & 37.8 & 0.0 + si@xmath141 ( @xmath187 ) & 107.5 & 107.5 & 0.0 & 108.2 & 108.3 & 0.1 + ga@xmath151 ( @xmath189 ) & 220.1 & 218.8 & 0.6 & 228.5 & 228.1 & 0.2 + ge@xmath141 ( @xmath187 ) & 107.4 & 106.7 & 0.7 & 108.9 & 108.5 & 0.3 + ti@xmath141 ( @xmath190 ) & 301.8 & 286.8 & 5.0 & 319.9 & 316.1 & 1.2 +"
  ],
  "abstract_text": [
    "<S> we propose a systematic method of analyzing pseudopotential transferability based on linear - response properties of the free atom , including self - consistent chemical hardness and polarizability . </S>",
    "<S> our calculation of hardness extends the approach of teter@xcite not only by including self - consistency , but also by generalizing to non - diagonal hardness matrices , thereby allowing us to test for transferability to non - spherically symmetric environments . </S>",
    "<S> we apply the method to study the transferability of norm - conserving pseudopotentials for a variety of elements in the periodic table . </S>",
    "<S> we find that the self - consistent corrections are frequently significant , and should not be neglected . </S>",
    "<S> we prove that the partial - core correction improves the pseudopotential hardness of alkali metals considerably . </S>",
    "<S> we propose a quantity to represent the average hardness error and calculate this quantity for many representative elements as a function of pseudopotential cutoff radii . </S>",
    "<S> we find that the atomic polarizabilities are usually well reproduced by the norm - conserving pseudopotentials . </S>",
    "<S> our results provide useful guidelines for making optimal choices in the pseudopotential generation procedure . </S>"
  ]
}