{
  "article_text": [
    "the development of new algorithms for the monte carlo simulation is important to overcome the problem of slow dynamics .",
    "we may classify such attempts into two categories .",
    "the first category is the extended ensemble method ; one uses an ensemble different from the ordinary canonical ensemble with a fixed temperature . the multicanonical method @xcite , the simulated tempering @xcite , the exchange monte carlo method @xcite , the broad histogram method @xcite , the flat histogram method @xcite , and the wang - landau algorithm @xcite are examples of the first category .",
    "the second category includes the cluster algorithm ; one flips a large number of spins in a correlated cluster at a time instead of a single - spin flip , which helps the relaxation time decrease drastically .",
    "examples of the second category are the swendsen - wang ( sw ) algorithm @xcite and the wolff algorithm @xcite . recently tomita and okabe @xcite proposed an effective cluster algorithm , which is called the probability - changing cluster algorithm , of tuning the critical point automatically .",
    "the combination of approaches of two categories is a challenging problem to explore an efficient algorithm .",
    "janke and kappler @xcite proposed a trial to combine the multicanonical method and the cluster algorithm ; their method is called the multibondic ensemble method .",
    "quite recently , yamaguchi and kawashima @xcite have improved the multibondic ensemble method ; they have also shown that the combination of the wang - landau algorithm and the improved multibondic ensemble method yields much better statistics compared to the original multibondic ensemble method by janke and kappler @xcite .",
    "one calculates the energy density of states ( dos ) @xmath0 in the multicanonical method @xcite and the wang - landau method @xcite ; the energy histogram @xmath1 is checked during the monte carlo process .",
    "in contrast , the dos for bond number @xmath2 , @xmath3 , is calculated in the multibondic ensemble method @xcite or the improved multibondic ensemble method by yamaguchi and kawashima @xcite ; the histogram for bond number , @xmath4 , is checked in the monte carlo process .    in proposing the broad histogram method , oliveira _ et al .",
    "_  @xcite paid attention to the number of potential moves , or the number of the possible energy change , @xmath5 , for a given state @xmath6 .",
    "the total number of moves is @xmath7 for a single - spin flip process , where @xmath8 is the number of spins .",
    "the energy dos is related to the number of potential moves as @xmath9 where @xmath10 denotes the microcanonical average with fixed @xmath11 .",
    "this relation is shown to be valid on general grounds @xcite , and hereafter we call eq .",
    "( [ bhr ] ) as the broad histogram relation ( bhr ) for the energy .",
    "one may use the number of potential moves @xmath5 for the probability of updating states .",
    "while the original dynamics @xcite was criticized to be not entirely correct @xcite , a refined dynamics is employed in the flat histogram method @xcite .",
    "alternatively , one may employ other dynamics which has no relation to @xmath5 , but eq .",
    "( [ bhr ] ) is used when calculating the energy dos @xcite .",
    "it was stressed @xcite that @xmath5 is a macroscopic quantity , which is the advantage of using the number of potential moves .",
    "we do not have to care about the relative number of visits for different energy level @xmath11 .",
    "it is contrary to the case of the multicanonical method @xcite or the wang - landau method @xcite .",
    "the only crucial point is the uniformity of visits within the same energy level @xcite .",
    "it is quite interesting to ask whether there is a relation similar to the bhr , eq .",
    "( [ bhr ] ) , for the bond number . in this paper , using the cluster ( graph ) representation , we derive the bhr for the bond number .",
    "we propose a dynamics based on the number of potential moves for the bond number .",
    "using the dos for the bond number thus obtained , we calculate the specific heat for model spin systems .",
    "we also employ other dynamics , that is , the multibondic ensemble method @xcite and its improvement @xcite , and calculate the bond - number dos based on the bhr for the bond number . comparing the efficiency of several methods ,",
    "we show that the calculation of the bond - number dos through the bhr gives much better statistics compared to the direct calculation of the dos .",
    "the rest of the paper is organized as follows . in sec .",
    "ii , we briefly review the cluster ( graph ) representation for the @xmath12-state potts model . in sec .",
    "iii , we derive the bhr for the bond number . a dynamics based on the number of potential moves for the bond number",
    "is discussed in sec .",
    "iv . in sec .",
    "v , calculating the accuracy of the specific heat for the two - dimensional ( 2d ) ising model , we compare the efficiency of several methods .",
    "the summary and discussions are given in sec .",
    "we briefly review the cluster ( graph ) formalism for the @xmath12-state potts model .",
    "we are concerned with the hamiltonian @xmath13 where @xmath14 is the exchange coupling constant and the summation is taken over the nearest - neighbor pairs @xmath15 . from now on , we represent the energy in units of @xmath14 , and the boltzmann constant is set to be one .",
    "the partition function for a given temperature @xmath16 is expressed as @xmath17 with the boltzmann weight of state @xmath6 having the energy @xmath11 , @xmath18 and the energy dos , @xmath19    with the framework of the dual algorithm @xcite , the partition function is also expressed in the double summation over state @xmath6 and graph @xmath20 as @xmath21 where @xmath22 is a function that takes the value one when @xmath6 is compatible to @xmath20 and takes the value zero otherwise . a graph consists of a set of bonds .",
    "the weight for graph @xmath20 , @xmath23 , is defined as @xmath24 for the @xmath12-state potts model , where @xmath25 is the number of `` active '' bonds in @xmath20 .",
    "this is nothing but the fortuin - kasteleyn representation @xcite for the @xmath12-state potts model .",
    "we say a pair @xmath26 is satisfied if @xmath27 , and unsatisfied otherwise .",
    "satisfied pairs become active with a probability @xmath28 for given @xmath16 .    by taking the summation over @xmath6 and @xmath20 with fixing the number of bonds @xmath2 ,",
    "the expression for the partition function becomes @xmath29 where @xmath30 is the total number of nearest - neighbor pairs in the whole system .",
    "here , @xmath3 is the dos for the bond number defined as the number of consistent combinations of graphs and states such that the graph consists of @xmath2 bonds ; @xmath31    then , the canonical average of a quantity @xmath32 is calculated by @xmath33 where @xmath34 is the microcanonical average with the fixed bond number @xmath2 for the quantity @xmath32 defined as @xmath35 thus , if we obtain @xmath36 and @xmath37 during the simulation process , we can calculate the canonical average of any quantity",
    ".    we should note that for the calculation of the energy @xmath11 , it is convenient to use the relation @xmath38 similarly , the specific heat per one site @xmath39 is given by @xmath40 the above equations ( [ eq : energy ] ) and ( [ eq : specific ] ) were derived by janke and kappler @xcite .",
    "the relation between the energy dos and the number of potential moves for energy , the bhr for the energy , was rigorously derived by oliveira @xcite . here",
    "we follow a method similar to that used by oliveira to derive the bhr for the bond number . instead of using the relation between states",
    ", we consider the relation between graphs .    the number of potential moves from the graph with the bond number @xmath2 to the graph with @xmath41 , @xmath42 , for fixed @xmath6 is equal to that of the number of potential moves from the graph with @xmath41 to that with @xmath2 , @xmath43 .",
    "that is , the following relation is satisfied : @xmath44 taking a summation over states @xmath6 and using the definition of the microcanonical average with the fixed bond number @xmath2 , eq .",
    "( [ eq : micronb ] ) , we rewrite eq .",
    "( [ eq : bro1 ] ) as @xmath45 this is the bhr for the bond number .",
    "it should be noted that @xmath46 is a possible number of bonds to add , and related to the number of satisfied pairs for the given state @xmath6 , @xmath47 by @xmath48 with use of the microcanonical average with fixed bond number for @xmath49 , we have the relation @xmath50 on the other hand , the possible number of bonds to delete , @xmath51 , is simply given by @xmath41 , that is , @xmath52 from the bhr for the bond number , eq .",
    "( [ eq : broad ] ) , we have @xmath53 then , substituting eqs .",
    "( [ eq : transition1 ] ) and ( [ eq : transition2 ] ) into eq .",
    "( [ eq : broad2 ] ) , we obtain the bond - number dos , @xmath54 , as @xmath55 when calculating the bond - number dos from the bhr for the bond number , we only need the information on @xmath56 , the microcanonical average with fixed @xmath2 of the number of satisfied pairs @xmath49 .",
    "it is much simpler than the case of the bhr formulation for the energy dos .",
    "moreover , in the computation of @xmath49 , we can use an improved estimator .",
    "if a pair of sites @xmath57 belong to the different cluster , this pair is satisfied with a probability of @xmath58 . if a pair of sites belong to the same cluster , this pair is always satisfied . then , we can employ an improved estimator @xmath59 as @xmath60 where @xmath61 represent a cluster that a site @xmath62 belongs to .",
    "only the information on graph is needed . by definition ,",
    "we employ the improved estimator in the whole calculation below .",
    "inserting eq .",
    "( [ eq : np2 ] ) into eq .",
    "( [ eq : ocal ] ) , we have @xmath64 .",
    "\\label{eq : ocal2}\\ ] ] here we have used the relation @xmath65 it is interesting to check eq .",
    "( [ eq : ocal2 ] ) for a special case .",
    "the @xmath66 limit of the @xmath12-state potts model is the bond percolation problem .",
    "if we substitute @xmath67 into eq .",
    "( [ eq : ocal2 ] ) , we obtain @xmath68 which is the expected relation for the bond percolation problem .",
    "let us consider the update process for the monte carlo simulation . in the multibondic ensemble method ,",
    "a graph is updated by adding or deleting a bond for a satisfied pair of sites @xcite .",
    "the histogram @xmath4 becomes flat if we use the following rule .",
    "if there is a bond already on the chosen pair , we delete it with a probability @xmath69 on the other hand , if there is no bond and if the pair is satisfied , we add a bond with a probability @xmath70 since the exact form of the bond - number dos @xmath36 is not known _ a priori _ , we renew @xmath36 iteratively in the monte carlo process by several ways @xcite",
    ".    we may use the number of potential move for the bond number , @xmath71 , for the probability of update . inserting eqs .",
    "( [ eq : broad ] ) , ( [ eq : transition1 ] ) , and ( [ eq : transition2 ] ) into eqs .  ( [ eq : prob1 ] ) and ( [ eq : prob2 ] ) , we get the probability to delete a bond , @xmath72 and the probability to add a bond , @xmath73 respectively .",
    "the actual monte carlo procedure is as follows .",
    "we start from some state ( spin configuration ) @xmath6 , and an arbitrary graph @xmath20 consistent with it .",
    "we add or delete a bond of satisfied pairs with the probability ( [ eq : prob3 ] ) or ( [ eq : prob4 ] ) .",
    "after making such a process as many as the number of total pairs , @xmath30 , we flip every cluster with the probability 1/2 .",
    "and we repeat the process .",
    "since we do not know the exact form of @xmath56 , we use the accumulated average for @xmath56 . the dynamics proposed here can be regarded as the flat histogram method for the bond number , which we call the cluster - flip flat histogram method . the conventional flat histogram method for the energy @xcite",
    "will be referred to as the single - spin - flip flat histogram method hereafter . as @xmath56 converges to the exact value",
    ", the histogram @xmath4 becomes flat .",
    "we calculate the bond - number dos by using eq .",
    "( [ eq : ocal2 ] ) , and then calculate various quantities by eq .",
    "( [ eq : canonical ] ) , or eqs.([eq : energy ] ) and ( [ eq : specific ] ) .    here",
    ", we have described the procedure for the multiple cluster update of the swendsen - wang type @xcite , but we can also employ the single cluster update of the wolff type @xcite .",
    "first , we simulate the @xmath74 ising model on the square lattice with the periodic boundary conditions by using the cluster - flip flat histogram method . we show @xmath75 as a function of @xmath2 for @xmath76 by the solid line in fig .",
    "[ fig:1](a ) ; we give @xmath77 by the dotted line . the number of monte carlo sweeps ( mcs ) is @xmath78 .",
    "the difference between the solid and dotted lines represents the number of potential moves @xmath79 , whereas the difference between the dotted line and the horizontal axis represents @xmath80 .",
    "we should note that @xmath81 , which is expected from eq .",
    "( [ eq : np2 ] ) .",
    "the logarithm of the bond - number dos , @xmath82 , obtained by @xmath56 is shown in fig .",
    "[ fig:1](b ) as a function of @xmath2 .",
    "the temperature dependence of the specific heat calculated using eq .",
    "( [ eq : specific ] ) is shown in fig .",
    "[ fig:2 ] ; the deviation from the exact result obtained by beale @xcite is not visible in this scale .     and ( b ) @xmath82 of the @xmath83 ising model obtained by the cluster - flip flat histogram method .",
    "the dotted line in ( a ) denotes @xmath77 . ]",
    "= 32 obtained by the cluster - flip flat histogram method . ]",
    "let us compare the performance of the cluster - flip flat histogram method proposed in this paper with that of the single - spin - flip flat histogram method @xcite . to do this , we check the number of mcs to satisfy the flatness condition for the histogram @xmath4 or @xmath1",
    "; we state that the flatness condition is fulfilled if the histogram @xmath4 or @xmath1 for all possible @xmath2 or @xmath11 is equal to or larger than 80% of the average histogram @xmath84 . in fig .",
    "[ fig:3 ] , we show the size dependence of the number of mcs to satisfy the flatness condition , which we call the flatness time @xmath85 hereafter , for both the cluster - flip flat histogram method and the single - spin - flip flat histogram method in logarithmic scale .",
    "the linear system sizes @xmath86 are 4 , 8 , 12 , 16 , 20 , 24 , and 32 . the average is taken over many samples .",
    "the number of samples ranges from 20 for the largest system to 1000 for the smallest .",
    "we see from fig .",
    "[ fig:3 ] that for the single - spin - flip flat histogram method the flatness time increases more rapidly as the system size increases .",
    "the least - squares fitting of the data gives @xmath87 for the cluster flat histogram method , and @xmath88 for the single - spin - flip flat histogram method .",
    "are 4 , 8 , 12 , 16 , 20 , 24 , and 32 ; @xmath89 .",
    "the cluster - flip flat histogram method and the single - spin - flip flat histogram method are compared . ]    as another example , we simulate the 2d 10-state potts model on the square lattice .",
    "a strong first - order phase transition occurs in this model .",
    "we show @xmath75 for the @xmath83 lattice by the solid line in fig .",
    "[ fig:4](a ) ; we give @xmath2 by the dotted line .",
    "the number of mcs is @xmath78 .",
    "the number of potential moves @xmath79 and @xmath80 are given in the same manner as the case of the ising model .",
    "it is to be noted that @xmath90 for the 10-state potts model .",
    "the logarithm of the bond - number dos , @xmath82 , obtained by @xmath56 is shown in fig .",
    "[ fig:4](b ) .",
    "the temperature dependence of the energy obtained by eq .",
    "( [ eq : energy ] ) is given in fig .",
    "[ fig:5 ] .",
    "the latent heat @xmath91 is shown in the figure .",
    "the comparison of the flatness time for the 2d 10-state potts model is shown in fig .",
    "[ fig:6 ] .",
    "the linear system sizes @xmath86 are 4 , 8 , 12 , 16 , 20 , and 24 .",
    "the number of samples to take the average ranges from 5 for the largest system to 1000 for the smallest .",
    "the flatness time of the single - spin - flip flat histogram method increases more rapidly with size than that of the cluster - flip flat histogram method , although it is not clear whether the size dependence is linear or not in logarithmic scale .",
    "it again shows the superiority of the cluster - flip flat histogram method over the single - spin - flip flat histogram method .     and",
    "( b ) @xmath82 of the @xmath83 10-state potts model obtained by the cluster - flip flat histogram method .",
    "the dotted line in ( a ) denotes @xmath77 . ]",
    "= 32 obtained by the cluster - flip flat histogram method . ]",
    "are 4 , 8 , 12 , 16 , 20 , and 24 ; @xmath89 . the cluster - flip flat histogram method and the single - spin - flip flat histogram method are compared . ]    in the calculations presented above , we have used the number of potential moves both for the dynamics and the estimator of @xmath36 or @xmath56 . however , our procedure to calculate the bond - number dos @xmath36 using the number of potential moves , or more explicitly , using @xmath56 , eq .",
    "( [ eq : ocal ] ) or ( [ eq : ocal2 ] ) , is independent of the dynamics .",
    "we may use the multibondic ensemble method @xcite or its improvement @xcite , and monitor @xmath56 to compute @xmath36 , although @xmath36 is directly used for the probability to update and renewed with the help of the histogram @xmath4 , such as @xmath92 .",
    "we compare the accuracy of the calculation for several dynamics and the procedure to calculate @xmath36 . for that purpose , we study the errors of the specific heat for the 2d ising model .",
    "the energy dos is exactly calculated by beale @xcite . as already shown in fig .",
    "[ fig:2 ] , the errors of our calculation are very small ; we treat the relative error , which is defined as @xmath93 for the specific heat @xmath39 .",
    "the relative errors @xmath94 of the @xmath83 ising model in the case of the cluster - flip flat histogram method are shown in fig .",
    "[ fig:7](a ) .",
    "the number of mcs is @xmath95 .",
    "the average value of @xmath96 in the range of @xmath97 , which will be denoted by @xmath98 , is as small as 0.0002 .",
    "ising model ; ( a ) the cluster - flip flat histogram method , ( b ) the multibondic ensemble method , and ( c ) the improved multibondic ensemble method .",
    "the number of mcs is @xmath95 .",
    "the solid line denotes the data obtained by the calculation using the number of potential moves , and dotted line denotes those obtained by the direct calculation with @xmath4 . ]    in the case of the multibondic ensemble method , we can calculate @xmath36 either through the number of potential moves or by the direct calculation with the help of the histogram @xmath4 .",
    "the errors @xmath96 of the @xmath83 ising model in the case of the multibondic ensemble method are plotted in fig .",
    "[ fig:7](b ) .",
    "the number of mcs is @xmath95 ; we renew @xmath36 for the probability of graph update by every @xmath99 mcs .",
    "the solid line denotes the data for the calculation using the number of potential moves , and dotted lines denotes those for the direct calculation using @xmath4 .",
    "we see that the calculation of @xmath36 through the number of potential moves gives much smaller errors .",
    "the average value @xmath98 is 0.0002 for the calculation using the number of potential moves , whereas that for the direct calculation with @xmath4 is 0.043 .",
    "we also show the results of the improved multibondic method in fig .",
    "[ fig:7](c ) .",
    "the conditions are the same as those for the multibondic method .",
    "the average value @xmath98 for the calculation using the number of potential moves is 0.0002 , whereas that for the direct calculation with @xmath4 is 0.0087 .",
    "the calculation of @xmath36 through the number of potential moves again gives much smaller errors compared to the direct calculation with @xmath4 .",
    "it is interesting to notice that @xmath98 take almost the same value for several methods if we follow the procedure to calculate @xmath36 through @xmath56 .",
    "the data of @xmath98 for several methods are tabulated in table [ table1 ] for convenience .",
    ".average relative error of the specific heat @xmath98 for the 2d @xmath83 ising model .",
    "we compare the data for several monte carlo methods and the procedure to calculate @xmath36 , the calculation using the number of potential moves ( potential move ) and the direct calculation with @xmath4 ( direct ) . [ cols=\"<,<,<\",options=\"header \" , ]",
    "to summarize , we have derived the rigorous bhr for the bond number , investigating the cluster ( graph ) representation of the spin models .",
    "we have shown that the bond - number dos @xmath36 can be calculated in terms of @xmath56 .",
    "we have proposed a monte carlo dynamics based on the number of potential moves for the bond number , which is regarded as the flat histogram method for the bond number .",
    "we have shown the efficiency of the bhr for the bond number in calculating the bond - number dos and other physical quantities .",
    "for the dynamics , the combination of the wang - landau idea @xcite and the cluster algorithms is useful in accelerating the diffusion of the random walker , as was pointed out before @xcite .",
    "however , here we have made more emphasis on the use of the bhr for the estimator of @xmath36 .",
    "the advantage of using the bhr may be attributed to the fact that the number of potential moves is a macroscopic quantity , which is the same situation as the bhr for the energy @xcite . moreover , the use of the improved estimator for calculating the number of potential moves , eq .",
    "( [ eq : ocal2 ] ) , gives much better statistics for the calculation .",
    "the number of potential moves for the energy , @xmath100 , has several possibilities for @xmath101 . on the contrary , in the case of the number of potential moves for the bond number , @xmath102 ,",
    "the change of the bond number is limited to one , which makes the calculation of the bond - number dos through the number of potential moves much simpler than that of the energy dos .",
    "recently , a cluster monte carlo algorithm to simulate the @xmath12-state potts model for any real @xmath103 was proposed by gliozzi @xcite .",
    "it is interesting to apply the bhr to that method . since only the information on graph is used in that monte carlo algorithm , eq .",
    "( [ eq : np2 ] ) is useful for calculating @xmath56 .    in this paper , we argued the bhr for the bond number .",
    "we can extend the present idea to the relation including two variables , for example , the bond number and the cluster number .",
    "the extension to more general cases , such as the loop algorithm of the quantum monte carlo simulation , may attract much attention , which will be studied in near future .",
    "we thank h. otsuka , y. tomita , and j .- s .",
    "wang for valuable discussions .",
    "this work was supported by a grant - in - aid for scientific research from the japan society for the promotion of science .",
    "b. a. berg and t. neuhaus , phys .",
    "lett . * 68 * , 9 ( 1992 ) ; b. a. berg and t. celik , phys .",
    "lett . * 69 * , 2292 ( 1992 ) .",
    "j. lee , phys .",
    "lett . * 71 * , 211 ( 1993 ) .",
    "e. marinari and g. parisi , europhys . lett .",
    "* 19 * , 451 ( 1992 ) .",
    "k. hukushima and k. nemoto , j. phys .",
    ". jpn . * 65 * , 1604 ( 1996 ) .",
    "m. c. de oliveira , t. j. p. penna , and h. j. herrmann , braz .",
    "* 26 * , 677 ( 1996 ) ; eur .",
    "j. b * 1 * , 205 ( 1998 ) .",
    "j. s. wang , eur .",
    "j. b * 8 * , 287 ( 1998 ) .",
    "j. s. wang and l. w. lee , comp .",
    ". commun . * 127 * , 131 ( 2000 ) ; j. s. wang , physica a * 281 * , 147 ( 2000 ) .",
    "f. wang and d. p. landau , phys .",
    "* 86 * , 2050 ( 2001 ) ; phys .",
    "e * 64 * , 056101 ( 2001 ) .",
    "r. h. swendsen and j. s. wang , phys .",
    "* 58 * , 86 ( 1987 ) .",
    "u. wolff , phys .",
    "lett . * 62 * , 361 ( 1989 ) .",
    "y. tomita and y. okabe , phys .",
    "* 86 * , 572 ( 2001 ) ; j. phys .",
    "jpn . , to appear .",
    "w. janke and s. kappler , phys .",
    "lett . * 74 * , 212 ( 1995 ) . c. yamaguchi and n. kawashima , phys .",
    "e , to appear .",
    "p. m. c. de oliveira , eur .",
    "j. b * 6 * , 111 ( 1998 ) .",
    "b. a. berg and u. h. e. hansmann , eur .",
    "j. b * 6 * , 395 ( 1998 ) .",
    "p. m. c. de oliveira , braz .",
    "* 30 * , 195 ( 2000 ) ; * 30 * , 766 ( 2000 ) .",
    "a. r. lima , p. m. c. de oliveira , and t. j. p. penna , j. stat .",
    "phys . * 99 * , 691 ( 2000 ) .",
    "d. kandel and e. domany , phys .",
    "b * 43 * , 8539 ( 1991 ) . n. kawashima and j. e. gubernatis , phys",
    "e * 51 * , 1547 ( 1995 ) .",
    "p. w. kasteleyn and c. m. fortuin , j. phys .",
    "* 26 * , 11 ( 1969 ) ; c. m. fortuin and p. w. kasteleyn , physica * 57 * , 536 ( 1972 ) .",
    "p. d. beale , phys .",
    "* 76 * , 78 ( 1996 ) .",
    "f. gliozzi , cond - mat/0201285 ."
  ],
  "abstract_text": [
    "<S> we discuss monte carlo methods based on the cluster ( graph ) representation for spin models . </S>",
    "<S> we derive a rigorous broad histogram relation ( bhr ) for the bond number ; a counterpart for the energy was derived by oliveira previously . </S>",
    "<S> a monte carlo dynamics based on the number of potential moves for the bond number is proposed . </S>",
    "<S> we show the efficiency of the bhr for the bond number in calculating the density of states and other physical quantities . </S>"
  ]
}