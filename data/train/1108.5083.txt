{
  "article_text": [
    "images in astronomy often , but not always , represent the intensity of some source . however , the colour schemes used to display images are not perceived as increasing monotonically in brightness , which does not aid the interpretation of the images .",
    "the perceived brightness of red , green and blue are not the same , with green being seen as the brightest , then red , then blue .",
    "for example a bright yellow ( i.e.  full intensity red and green ) is perceived as being very much brighter than a bright blue .",
    "so if a colour scheme has yellow for intermediate intensities , but blue or red for higher intensities , then the blue or red is perceived at lower brightness .",
    "this can be also seen when such colour images are printed in black and white , when increasing intensity in the image does not correspond to a greyscale with monotonically increasing brightness .",
    "this problem was noted by @xcite for the colour schemes then available in the matlab computing package .",
    "@xcite constructed  in an _ ad hoc _ manner  a colour scheme that does result in a greyscale with monotonically increasing brightness when printed on a black and white device .    here",
    "i describe colour schemes for the display of images that take into account the different perceptions of the brightnesses of red , green and blue , in order to maintain a monotonically increasing perception of intensity .",
    "an example of where colour needs to be converted to black and white , to preserve perceived brightness , is the addition of colour to black and white television . in the us , the national television system committee ( ntsc )",
    "specifications from 1953 , red , green and blue ( hereafter @xmath0 , @xmath1 , @xmath2 ) are mapped to a @xmath3 ` luma ' value ( i.e.  the black and white brightness ) signal using ( see , for example , @xcite or @xcite ) @xmath4 ( in addition there were two other components , ` @xmath5 ' and ` @xmath6 ' which encoded the colour . )    the coefficients in equation  [ eq : ntsc ] are appropriate for the colour phosphors then in use , and reflect the perceived intensity of the different colours .",
    "modern monitors differ somewhat , but the coefficients of the different perceived intensities are similar , e.g.  the european pal colour tv standard uses very similar coefficients , with @xmath7 , and more recently hdtv uses @xmath8 ( itu - r recommendation 709 , originally from 1993 ) . in all cases",
    "the perceived brightness of green is largest , then red , then blue .",
    "the ntsc coefficients are also used : ( 1 ) to map from the ` devicergb ` to ` devicegray ` colourspace used within postscript if the ` colorimage ` operator is used with a black and white device , and ( 2 ) to convert from colour to greyscale for greyscale only devices , within the pgplot package .",
    "in the 1980s , a colour scheme was implemented for the sigma args graphics display on the cambridge starlink vax , by a colleague , john fielden .",
    "this was from black to white , spiralling around the greyscale diagonal in an @xmath0 , @xmath1 , @xmath2 colour cube .",
    "however , this treated @xmath0 , @xmath1 , @xmath2 equivalently , i.e.  not taking into account these colours are perceived differently in terms of their brightness .",
    "i adapted this colour scheme so that it _ is _ monotonically increasing in terms of perceived brightness , according to equation  [ eq : ntsc ] .    the colour scheme  a squashed helix around the diagonal of a colour cube , ` cubehelix '  is implemented as follows . for a unit colour cube ( i.e.  3-d coordinates for @xmath0 , @xmath1 , @xmath2 , each in the range 0 to 1 ) , the colour scheme starts at @xmath9 ,",
    "i.e.  black , and finishes at @xmath10 , i.e.  white . for some fraction @xmath11 between 0 and 1 ,",
    "the colour is the corresponding grey value at that fraction along the black to white diagonal , i.e.  ( @xmath11 , @xmath11 , @xmath11 ) , plus a colour element .",
    "the colour element is calculated in a plane of constant perceived intensity , which can be defined in terms of two unit @xmath12 colour vectors @xmath13 and @xmath14 , the first of which is predominantly blue .",
    "the additional colour element of the scheme is controlled by three parameters .    *",
    "the start colour ( @xmath15 ) .",
    "this is the direction of the predominant colour deviation from black at the start of the colour scheme . *",
    "the number of @xmath0 , @xmath1 , @xmath2 rotations ( @xmath16 ) in colour that are made from the start ( i.e.  black ) to the end ( i.e.  white ) of the colour scheme . * a hue parameter ( @xmath17 ) , which controls how saturated the colours are .",
    "the amplitude of the colour deviation from the grey diagonal is zero at each end and largest in the middle .",
    "if this parameter is zero then the colour scheme is purely a greyscale , increasing in brightness .",
    "if the parameter is too large , then @xmath0 , @xmath1 , or @xmath2 may be out of the 0 to 1 range near start or end of colour scheme , so will have to be clipped ( although if only a few colour levels are clipped , the resulting colour scheme , may still be satisfactory ) .",
    "in addition , a ` gamma factor ' can be used to provide mapping of @xmath11 to @xmath18 , to emphasise either low intensity values ( @xmath19 ) , or high intensity values ( @xmath20 ) . for a fraction @xmath11 between 0 and 1 , then the @xmath0 , @xmath1 , @xmath2 values are given by @xmath21 where @xmath22 and @xmath23 ( i.e.  the angle and amplitude for the deviation from the black to white diagonal ) in the plane of constant perceived intensity ) .",
    "appendix  a gives fortran 77 code for this algorithm , and fig .",
    "[ fig : cubehelix ] shows one example of a colour scheme constructed using this algorithm .",
    "note that printed versions of this colour scheme may not be perceived as monotonically increasing in brightness .",
    "this is because the range of colours that can be represented by colour printers ( their ` gamut ' ) is usually poorer than the range that can be represented in computer displays ( e.g.  see @xcite ) .",
    "however , this colour scheme should print as a greyscale with monotonically decreasing density on black and white postscript devices .    a version of this colour scheme , as shown in fig .",
    "[ fig : cubehelix ] , has recently been incorporated into the viewer task in version 3.1.0 of the ` common astronomy software application ' , casa ( e.g.  @xcite ) , called ` cubehelix ` .",
    "this colour scheme has also been recently added to the 31dec10 version of the ` astronomical image processing system ' , aips ( e.g.@xcite ) via the ` tvhelix ` verb , which allows interactive control of start colour , number of rotations ( and direction ) , the hue parameter and gamma factor using the aips tv buttons and cursor position .",
    "it should be noted that the colour scheme described in section  [ sec : solution ] is only one example which is suitable for the display of intensity images . clearly others could be constructed to take into account the difference in perception of colours discussed in section  [ sec : background ] .",
    "colour is not only for the display of intensity images , but is also used in other situations , for example : ( i ) for polarisation images , where intensity or polarised intensity is represented by an underlying greyscale , with polarisation angle with added colour , or ( ii ) for spectral line observations , where intensity ( or , for example , column density ) is represented by an underlying greyscale , with colour represented radial velocity . in these cases , ideally the addition of different colours should not distort perception of intensity also intended .",
    "a further subtlety is that the perception of differences between similar colours is not the same for all colours ( e.g.@xcite ) , and hence an appropriate mapping between colour and polarisation angle / velocity is needed .",
    "i am grateful to john fielden for his original colour scheme , to several colleagues for useful discussions , and for eric greisen for making this colour scheme available to aips users .",
    "greisen e.  w. , 2005 , in information handling in astronomy  historical vistas , astrophysics and space science library , vol .",
    "285 , ed .",
    "heck a. , kluwer , p109 .",
    "hunt r.  w.  g. , 2004 , the reproduction of colour , 6th edition , wiley - blackwell    jaeger s. , 2008 , in astronomical data analysis software and systems , asp conference series , vol .",
    "394 , eds argyle r.  w. , bunclark p.  s. , lewis j.  r. , astronomical society of the pacific , p.623    lee h .- c . , 2005 ,",
    "introduction to color imaging science , cambridge university press    macadam d.  l. , 1943a , josa , 33 , 18    macadam d.  l. , 1943b , josa , 33 , 675    rappaport c. , 2002 , ieee antennas and propagation magazine , 44 , 94",
    "this is fortran 77 code that implements the colour scheme as described in section  [ sec : solution ] .",
    "` c=====================================================================72 ` + ` c  calculates  a  `` `` cube  helix ` '' `  colour  table .",
    "the  colours  are  a  tapered ` + ` c  helix  around  the  diagonal  of  the  [ r , g , b ]  colour  cube ,  from  black ` + ` c  [ 0,0,0 ]  to  white  [ 1,1,1 ]  deviations  away  from  the  diagonal  vary ` + ` c  quadratically ,  increasing  from  zero  at  black ,  to  a  maximum ,  then ` + ` c  decreasing  to  zero  at  white ,  all  the  time  rotating  in  colour . ` + ` c ` + ` c  the  input  parameters  controlling  the  colour  helix  are : ` + ` c ` + ` c  start  colour  ( 1=red ,  2=green ,  3=blue ;  e.g.  0.5=purple ) ; ` + ` c  rots  rotations  in  colour  ( typically  -1.5  to  1.5 ,  e.g.  -1.0 ` + ` c  is  one  blue->green->red  cycle ) ; ` + ` c  hue  for  hue  intensity  scaling  ( in  the  range  0.0  ( b+w )  to  1.0 ` + ` c  to  be  strictly  correct ,  larger  values  may  be  ok  with ` + ` c  particular  start / end  colours ) ; ` + ` c  gamma  set  the  gamma  correction  for  intensity . `",
    "+ ` c ` + ` c  the  routine  returns  a  colour  table  nlev  elements  long  in  red ,  grn ` + ` c  and  blu  ( each  element  in  the  range  0.0  to  1.0 ) ,  and  the  numbers , ` + ` c  nlo  and  nhi ,  of  red ,  green  or  blue  values  that  had  to  be  clipped ` + ` c  because  they  were  too  low  or  too  high . `",
    "+ ` c72 ` + ` c  dave  green    mrao    2011  june  13th ` + ` c72 ` + ` c  see : ` + ` c  green ,  d.  a. ,  2011 ,  bulletin  of  the  astronomical  society  of  india , ` + ` c  vol.39 ,  p. ` + ` c72 ` + `  subroutine  cubhlx(start , rots , hue , gamma , nlev , red , grn , blu , nlo , nhi ) ` + ` c  = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = ` + ` c ` + `  integer  nlev , i , nlo , nhi ` + `  real  start , rots , hue , gamma ` + `  real  red(nlev),grn(nlev),blu(nlev ) ` + `  real  pi , fract , angle , amp ` + ` c ` + `  pi=4.0*atan(1.0 )",
    "` + `  nlo=0 ` + `  nhi=0 ` + ` c ` + `  do  1000  i=1,nlev ` + `  fract = float(i-1)/float(nlev-1 ) ` + `  angle=2*pi*(start/3.0 + 1.0+rots*fract ) ` + `  fract = fract**gamma ` + `  amp = hue*fract*(1-fract)/2.0 ` + `  red(i)=fract+amp*(-0.14861*cos(angle)+1.78277*sin(angle ) ) ` + `  grn(i)=fract+amp*(-0.29227*cos(angle)-0.90649*sin(angle ) ) ` + `  blu(i)=fract+amp*(+1.97294*cos(angle ) ) ` + ` c ` + `  if(red(i).lt.0.0)then ` + `  red(i)=0.0 ` + `  nlo = nlo+1 ` + `  endif ` + `  if(grn(i).lt.0.0)then ` + `  grn(i)=0.0 ` + `  nlo = nlo+1 ` + `  endif ` + `  if(blu(i).lt.0.0)then ` + `  blu(i)=0.0 ` + `  nlo = nlo+1 ` + `  endif ` + ` c ` + `  if(red(i).gt.1.0)then ` + `  red(i)=1.0 ` + `  nhi = nhi+1 ` + `  endif ` + `  if(grn(i).gt.1.0)then ` + `  grn(i)=1.0 ` + `  nhi = nhi+1 ` + `  endif ` + `  if(blu(i).gt.1.0)then ` + `  blu(i)=1.0 ` + `  nhi = nhi+1 ` + `  endif ` + `  1000  continue ` + ` c ` + `  return ` + `  end `"
  ],
  "abstract_text": [
    "<S> i describe a colour scheme that is appropriate for the screen display of intensity images . </S>",
    "<S> this  unlike many currently available schemes  is designed to be monotonically increasing in terms of its perceived brightness . also , when printed on a black and white postscript printer , the scheme results in a greyscale with monotonically increasing brightness . </S>",
    "<S> this scheme has recently been incorporated into the radio astronomical analysis packages casa and aips .    </S>",
    "<S> [ firstpage ]    methods : data analysis  methods : miscellaneous </S>"
  ]
}