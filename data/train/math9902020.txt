{
  "article_text": [
    "let @xmath3 be a permutation of the set @xmath4 written in the one - line notation .",
    "we say that @xmath5 changes direction at position @xmath6 , if either @xmath7 , or @xmath8 , in other words , when @xmath9 is either a _ peak _ or a _",
    "valley_. we say that @xmath5 has @xmath2 runs if there are @xmath10 indices @xmath6 so that @xmath5 changes direction at these positions .",
    "so for example , @xmath11 has 3 runs as @xmath5 changes direction when @xmath12 and when @xmath13 . a geometric way to represent a permutation and its runs by a diagram",
    "is shown on figure [ threeruns ] .",
    "the runs are the line segments ( or edges ) between two consecutive entries where @xmath5 changes direction .",
    "so a permutation has @xmath2 runs if it can be represented by @xmath2 line segments so that the segments go `` up '' and `` down '' exactly when the entries of the permutation do .",
    "the theory of runs has been studied in  ( * ? ? ?",
    "* section 5.1.3 ) in connection with sorting and searching .    in this paper , we are going to study the numbers @xmath0 of permutations of length @xmath1 or , in what follows , @xmath1-permutations with @xmath2 runs .",
    "we will show that for any fixed @xmath1 , the sequence @xmath0 , @xmath14 is log - concave , that is , @xmath15 .",
    "in particular , this implies @xcite that this same sequence is unimodal , that is , there exists an @xmath16 so that @xmath17 .",
    "we will also show that roughly half of the roots of the generating function @xmath18 are equal to @xmath19 , and give a combinatorial interpretation for the term which remains after one divides @xmath20 by all the @xmath21 factors . while doing that , we will also give a new proof of the well - known fact @xcite that the eulerian numbers are log - concave .",
    "let @xmath22 be a permutation .",
    "we say that @xmath6 is a _ descent _ of @xmath5 if @xmath23 , while we say that @xmath6 is an _ ascent _ of @xmath5 if @xmath24 .    in our study of @xmath1-permutations with a given number of runs",
    ", we can clearly assume that 1 is an ascent of @xmath5 .",
    "indeed , taking the permutation @xmath25 , where @xmath26 , we get the _ complement _ of @xmath5 , which has the same number of runs as @xmath5 .",
    "this implies in particular that for any given @xmath6 , there are as many @xmath1-permutations with @xmath2 runs in which @xmath24 as there are such permutations in which @xmath23 .",
    "let @xmath27 be any generating function enumerating @xmath1-permutations according to some statistics .",
    "we say that @xmath28 is _ invariant to @xmath29 _ if the set of @xmath1-permutations with @xmath23 contributes @xmath30 to @xmath31 .",
    "certainly , in this case the set of @xmath1-permutations with @xmath24 contributes accounts @xmath30 to @xmath31 as well .",
    "let @xmath18 be the ordinary generating function of @xmath1-permutations with @xmath2 runs , where @xmath32 .",
    "so we have @xmath33 , @xmath34 , and @xmath35 .",
    "one sees that all coefficients of @xmath20 are even , which is explained by the symmetry described above .",
    "the following proposition is our initial step of factoring @xmath20 .",
    "it will lead us to the definition of an important version of this polynomial .",
    "[ easy ] for all @xmath36 , the polynomial @xmath20 is divisible by @xmath21 .",
    "it is straightforward to verify ( by considering all possible patterns for the last four entries of  @xmath5 ) that the involution @xmath37 interchanging @xmath38 and @xmath39 increases the number of runs by 1 in half of all permutations , and , being an involution , decreases the number of runs by 1 in the other half of the permutations .",
    "in particular , there are as many permutations with an odd number of runs as there are with an even number of runs , so @xmath21 is indeed a divisor of @xmath20 .    _",
    "if @xmath40 , then there is 1 permutation with 1 run , 6 permutations with 2 runs and 5 permutations with 3 runs .",
    "so @xmath41 . _",
    "we want to extend the result of proposition  [ easy ] by proving that @xmath20 has @xmath21 as a factor with a large multiplicity , and also , we want to find a combinatorial interpretation for the polynomial obtained after dividing @xmath20 by the highest possible power of @xmath21 . for that purpose",
    ", we introduce the following definition .    for @xmath42 , we say that @xmath5 is a _ @xmath43-half - ascending permutation _ if , for all positive integers @xmath44 , we have @xmath45 .",
    "if @xmath46 , then we will simply say that @xmath5 is a _ half - ascending permutation_.    so @xmath5 is a 1-half - ascending permutation permutation if @xmath47 . in a @xmath43-half - ascending permutation , we have @xmath43 relations , and they involve the rightmost @xmath43 disjoint pairs of entries .",
    "the term half - ascending refers to the fact that at least half of the involved positions are ascents .",
    "there are @xmath48 @xmath43-half - ascending permutations    now we define a modified version of the polynomials @xmath49 for @xmath43half - ascending permutations .",
    "let @xmath5 be a @xmath43-half - ascending permutation .",
    "let @xmath50 be the number of runs of the substring @xmath51 , and let @xmath52 be the number of descents of the substring @xmath53 . denote @xmath54 , and define @xmath55 in particular , we will denote @xmath56 by @xmath57 , that is , @xmath57 is the generating function for half - ascending permutations .",
    "so in other words , we count the runs in the non - half - ascending part and we count the descents in the half - ascending part ( and on that part , as it will be discussed , the number of descents determines that of runs . )    [ factor ] for all @xmath36 we have @xmath58 moreover , @xmath59 is invariant to @xmath29 for all @xmath60 .",
    "recall from proof of proposition  [ easy ] that involution @xmath37 makes pairs of permutations , and each pair contains two elements whose numbers of runs differ by 1 .",
    "note that half of these pairs consist of two elements with @xmath61 and the other half consist of two elements with @xmath62 .",
    "as @xmath20 is invariant to @xmath63 , it suffices to consider the first case .",
    "dividing @xmath20 by @xmath21 we obtain the run - generating function for the set of permutations which contains one element of each of these pairs , namely , the one having the smaller number of runs .",
    "observe that for these permutations , the number of runs is equal to the value of @xmath64 for the permutation in that pair in which @xmath47 ( by checking both possibilities @xmath65 and @xmath66 ) , so @xmath67 . note that our argument also proves that those permutations with @xmath68 contribute exactly @xmath69 to @xmath59 , as they represent half of @xmath20 divided by @xmath21 , so our second claim is proved , too .",
    "we point out that it is not true in general that in each pair made by @xmath37 , the permutation having the smaller number of runs is the one with @xmath47 .",
    "what is true is that we can _ suppose _ that @xmath47 if we count permutations by the defined parameter @xmath64 instead of the number of runs .",
    "this latter could be viewed as the @xmath70 parameter .    _",
    "if @xmath40 , then we have 6 permutations in which @xmath71 and @xmath72 : 1234 , 1324 , 1423 , 2314 , 2413 , 3412 .",
    "we have @xmath73 and @xmath74 for all the other five permutations , showing that indeed , @xmath75 . _    for @xmath76 ,",
    "let @xmath77 be the involution interchanging @xmath78 and @xmath79 .",
    "then the following strong result generalizes proposition  [ easy ] .",
    "[ difficult ] for all @xmath36 and @xmath80 , we have @xmath81 where @xmath82 moreover , @xmath83 is invariant to @xmath29 for @xmath84 .    by induction on @xmath43 .",
    "for @xmath85 , the statement is true by proposition [ easy ] .",
    "now suppose we know the statement for @xmath86 .",
    "to prove that @xmath87 , we need to group all @xmath88-half - ascending permutations in pairs , so that the @xmath89 values of the two elements of any given pairs differ by one , and show that the set of permutations consisting of the elements of each pair having the smaller @xmath89 value yields the generating function @xmath83 .",
    "however , @xmath77 just does that , as can be checked by verifying both possibilities @xmath90 and @xmath91 .",
    "these are the only cases to consider as we can assume by our induction hypothesis that @xmath92 .",
    "moreover , permutations with @xmath68 contribute exactly @xmath93 to @xmath83 if @xmath84 as they represent half of @xmath94 divided by @xmath21 .",
    "note that we have just repeated the proof of proposition  [ easy ] with general @xmath43 , instead of @xmath85 .",
    "we have @xmath95    so we have proved that @xmath96 of the roots of @xmath20 are equal to @xmath19 , and certainly , one other root is equal to 0 as all permutations have at least one run .",
    "it is possible to prove analytically @xcite that the other half of the roots of @xmath20 , that is , the roots of @xmath57 , are all , real , negative , and distinct .",
    "that implies  @xcite that the coefficients of @xmath20 and @xmath57 are log - concave .",
    "however , in the next section we will _ combinatorially _ prove that the coefficients of @xmath57 form a log - concave sequence .",
    "let @xmath97 be the coefficient of @xmath98 in @xmath57 .",
    "let @xmath99 be the set of half - ascending permutations with @xmath2 descents , so @xmath100 .",
    "now suppose for shortness that @xmath1 is even and assume that @xmath5 is a half - ascending permutation , that is , @xmath101 for all @xmath6 , @xmath102 .",
    "the following proposition summarizes the different ways we can describe the same parameter of @xmath5 .",
    "[ trivi ] let @xmath5 be a half - ascending permutation .",
    "then @xmath5 has @xmath103 runs if and only if @xmath5 has @xmath2 descents , or , in other words , when @xmath104 .",
    "if @xmath1 is odd , then the rest of our argument is a little more tedious , though conceptionally not more difficult .",
    "we do not want to break the course of our proof here , so we will go on with the assumption that @xmath1 is even , then , in the second part of the proof of theorem  [ main ] , we will indicate what modifications are necessary to include the case of odd @xmath1 .",
    "so in order to prove that the sequence @xmath0 is log - concave in @xmath2 , we need to prove that the sequence @xmath97 enumerating half - ascending @xmath1-permutations with @xmath2 descents is log - concave",
    ". that would be sufficient as the convolution of two log - concave sequences is log - concave @xcite .",
    "following @xcite , we will set up a bijection from the set @xmath105 of @xmath1-permutations with @xmath2 descents onto that of labeled northeastern lattice paths with @xmath1 edges , exactly @xmath2 of which are vertical",
    ". however , our lattice paths will be different from those in @xcite ; in particular , they will preserve the information if the position @xmath6 is an ascent or descent .",
    "let @xmath106 be the set of labeled northeastern lattice paths with the @xmath1 edges @xmath107 and the corresponding positive integers as labels @xmath108 so that the following hold :    1 .",
    "the edge @xmath109 is horizontal and @xmath110 , 2 .",
    "if the edges @xmath111 and @xmath112 are both vertical , or both horizontal , then @xmath113 , 3 .",
    "if @xmath111 and @xmath112 are perpendicular to each other , then @xmath114    we will not distinguish between paths which can be obtained from each other by translations .",
    "let @xmath115 be the set of all such labeled lattice paths which has @xmath2 vertical edges , and let @xmath116 .",
    "[ properties ] the following two properties of paths in @xmath106 are immediate from the definitions .    * for all @xmath117 , we have @xmath118 .",
    "* fix the label @xmath119 .",
    "then if @xmath120 can take value @xmath121 , then it can take all nonnegative integer values @xmath122 .",
    "also note that all restrictions on @xmath120 are given by @xmath119 , independently of preceding @xmath123 , @xmath124 .",
    "the following bijection is the main result in this section .",
    "[ bij ] the following description defines a bijection from @xmath125 onto @xmath106 .",
    "let @xmath5 be a permutation on @xmath1 elements . to obtain the edge @xmath126 and the label @xmath127 for @xmath128 ,",
    "restrict the permutation  @xmath5 to the @xmath6 first entries and relabel the entries to obtain the permutation @xmath129 .",
    "* if the position @xmath130 is a descent of the permutation @xmath5 ( equivalently , of the permutation @xmath131 ) , let the edge @xmath126 be vertical and the label @xmath127 be equal to @xmath132 .",
    "* if the position @xmath130 is an ascent of the permutation @xmath5 , let the edge @xmath126 be horizontal and the label  @xmath127 be @xmath133 .",
    "moreover , this bijection restricts naturally to a bijection between @xmath134 and @xmath115 for @xmath135 .",
    "it is straightforward to see that the map described is injective on the set of labeled lattice path , not necessarily satisfying conditions ( 2 ) and ( 3 ) .",
    "assume that @xmath6 and @xmath136 are both descents of the permutation @xmath5 .",
    "let @xmath131 , respective @xmath137 , be the permutation when restricting to the @xmath6 , respective @xmath136 , first elements .",
    "observe that @xmath132 is either @xmath138 or @xmath139 .",
    "since @xmath140 we have @xmath141 and condition  ( 2 ) is satisfied in this case . by similar reasoning",
    "the three remaining cases are shown , hence the map is into the set @xmath106 .    to see that this is a bijection , we show that we can recover the permutation @xmath5 from its image .",
    "it is sufficient to show that we can recover @xmath39 , and then use induction on @xmath1 for the rest of @xmath5 . to recover @xmath39 from its image , simply recall that @xmath39 is equal to the label @xmath142 of the last edge if that edge is vertical , and to @xmath143 if that edge is horizontal .",
    "the lattice path corresponding to the permutation @xmath144 is shown on figure  [ onepath ] .",
    "the difference between our bijection and that of @xcite is that in ours , the direction of @xmath111 tells us whether @xmath145 is a descent in @xmath5 .",
    "this is why we can use this bijection to gain information the class of half - ascending permutations .",
    "the bijection in theorem  [ bij ] restricts to a bijection from @xmath146 to lattice paths in @xmath115 where @xmath111 is horizontal for all even indices @xmath6 .",
    "in this section we are going to give a new proof for the fact that the numbers @xmath147 are unimodal in @xmath2 , for any fixed @xmath1 .",
    "this fact is already known and has elegant proofs @xcite .",
    "however , our proof will also indicate the unimodality of the @xmath97 .      to prove the theorem combinatorially",
    ", we construct a _ quasi - injection _ @xmath151 by quasi - injection we mean that there will be some elements of @xmath152 for which @xmath153 will not be defined , but the number of these elements will be less than that of elements in @xmath154 which are not in the image of @xmath153 .    in particular , the restriction of @xmath153 onto @xmath155 will map into @xmath156 , where @xmath157 is the subset of @xmath115 consisting of lattice paths in which @xmath111 is horizontal for all even  @xmath6 .",
    "let @xmath158 .",
    "place the initial points of @xmath159 and @xmath31 at @xmath160 and @xmath161 , respectively .",
    "then the endpoints of @xmath159 and @xmath31 are @xmath162 and @xmath163 , respectively , so @xmath159 and @xmath31 intersect .",
    "let @xmath164 be their _ first _ intersection point ( we order intersection points from southwest to northeast ) , and decompose @xmath165 and @xmath166 , where @xmath167 is a path from @xmath160 to @xmath164 , @xmath168 is a path from @xmath164 to @xmath163 , @xmath167 is a path from @xmath161 to @xmath164 , and @xmath169 is a path from @xmath164 to @xmath162 .",
    "let @xmath170 and let @xmath171 . if @xmath172 and @xmath173 are valid paths , that is , if their labeling fulfills conditions ( 1)(3 ) , then we set @xmath174 .",
    "see figure [ twopaths ] for this construction .",
    "it is clear that @xmath175 , ( in particular , @xmath176 belongs to the subset of @xmath154 consisting of _ intersecting _ pairs of paths ) , and that @xmath153 is one - to - one .",
    "what remains to show is that the number of pairs @xmath177 for which @xmath153 can not be defined this way is less than the number of pairs @xmath178 which are not obtained as images of @xmath153 .",
    "in fact , we will show that this is true even if we restrict ourselves to pairs @xmath178 which do intersect .",
    "let @xmath179 be the labels of the four edges adjacent to @xmath164 as shown in figure [ cross ] , the edges @xmath180 and @xmath181 originally belonging to @xmath159 and the edges @xmath182 and @xmath183 originally belonging to @xmath31 .",
    "( it is possible that these four edges are not all distinct ; @xmath184 and @xmath185 are always distinct as @xmath164 is the first intersection point , but it could be , that @xmath186 and so @xmath187 ; this singular case can be treated very similarly to the generic case we describe below and hence omitted ) .",
    "then a configuration shown on figure [ cross ] can be part of a pair @xmath188 in the domain of @xmath153 exactly when @xmath189 and @xmath190 .",
    "on the other hand , such a configuration can be part of a pair of paths @xmath176 in the image of @xmath153 exactly when @xmath191 and @xmath192 , where @xmath130 is the sum of the two coordinates of @xmath164 .",
    "let us keep @xmath193 fixed , and see what that means for @xmath194 and @xmath195 .",
    "the value of @xmath194 can be @xmath196 , so @xmath194 can take @xmath197 different values , whereas the value of @xmath195 can be @xmath198 which is again @xmath197 different possibilities .",
    "note in particular that the second set of values can be obtained from the first by simply subtracting each value from @xmath6 .",
    "then the set of all labeled paths from @xmath160 to @xmath184 is identical to that of paths from @xmath161 to @xmath185 .",
    "in particular , the distributions of the labels of the edges ending in @xmath184 , respectively @xmath185 , are identical , even if we also require that they end in a horizontal , or in a vertical edge .",
    "let @xmath199 be the set of all pairs of labeled paths @xmath200 .",
    "now it is easy to see that if any labeled path @xmath201 from @xmath160 to @xmath184 allows @xmath194 to be in the interval @xmath196 , then the path from @xmath161 to @xmath185 identical to @xmath201 allows @xmath195 to be in the interval @xmath198 .",
    "indeed , the edge preceding @xmath180 is either horizontal , and then it must have a label between @xmath193 and @xmath202 , or it is vertical , and then it must be between 1 and @xmath197 to make it possible for @xmath194 to be in the interval @xmath196 . similarly , if the edge preceding @xmath182 is horizontal , and it has a label between @xmath193 and @xmath202 , or if it is vertical , and has a label between 1 and @xmath197 , then it makes it possible for @xmath195 to be in the interval @xmath198 .",
    "( and certainly , if the edge preceding @xmath182 is horizontal , and it has a label smaller than  @xmath193 , that is good , too ) . as the distributions of the labels of the edges ending in @xmath184 ,",
    "respectively @xmath185 are identical , this implies that for any fixed values of @xmath193 , there are at least as many pairs of paths in @xmath199 so that @xmath192 as there are pairs of paths in @xmath199 with @xmath189 .",
    "( recall that @xmath130 is the sum of the coordinates of @xmath164 ) .",
    "in other words , if the pair @xmath203 allows @xmath189 , then the pair @xmath204 allows @xmath205 , so we can flip @xmath206 and @xmath207 .",
    "we point out that this is intuitively not surprising : @xmath194 has to be _ at least _ a certain value , while @xmath195 has to be _ at most _ a certain value , and it is clear that this second requirement is easier in our labeling .    by symmetry ,",
    "if we fix @xmath208 instead of @xmath193 , the same holds : the number of pairs of paths in @xmath199 so that @xmath191 is at least as large as that of pairs of paths in @xmath199 with @xmath190 , and that can be seen again by flipping @xmath206 and @xmath207 .",
    "finally , this same argument certainly applies if we want both conditions to be satisfied : if the pair @xmath209 allows @xmath189 and @xmath190 , then the pair @xmath210 allows @xmath205 and @xmath191 . and",
    "this is what we wanted to prove : there are at least as many pairs of paths in @xmath211 which are not images of @xmath153 as there are pairs of paths in @xmath212 for which @xmath153 is not defined .",
    "as @xmath153 is one - to - one , this proves that @xmath213 , so the sequence @xmath214 is log - concave for all @xmath1 .    to prove that the sequence @xmath215 is log - concave , recall that half - ascending permutations in @xmath146 correspond to elements of @xmath157 , that is , elements of @xmath115 in which all edges @xmath111 are horizontal if @xmath6 is even .",
    "we point out that this implies @xmath186 .",
    "then note that @xmath153 does not change the indices of the edges , in other words , if @xmath174 , and a given edge northeast from @xmath164 was the @xmath6th edge of path @xmath159 , then it will be the @xmath6th edge of path @xmath173 .",
    "therefore , @xmath153 preserves the property that all even - indexed edges are horizontal , so the restriction of @xmath153 into @xmath216 maps into @xmath156 .",
    "finally , we need to show that there are more pairs of paths in @xmath156 which are not images of @xmath153 than there are pairs of paths in @xmath216 for which @xmath153 is not defined .",
    "note that the corresponding fact in the general case was a direct consequence of the fact that for any labeled path @xmath217 was identical to a unique labeled path @xmath218 , and therefore the distributions of the labels @xmath194 and @xmath195 were identical .",
    "this remains certainly true if we restrict ourselves to paths in which all edges with even indices are horizontal . as any restriction of @xmath153",
    "is certainly one - to - one , this proves that @xmath219 .",
    "first suppose that @xmath1 is even .",
    "for @xmath220 , the statement is true . if @xmath36 , then lemma [ difficult ] shows that @xmath221 .",
    "the coefficients of @xmath222 are just the binomial coefficients , which are certainly log - concave @xcite , while the coefficients of @xmath223 are the @xmath97 , which are log - concave by theorem  [ logcon ] and the remark thereafter .",
    "as the product of two polynomials with log - concave coefficients has log - concave coefficients @xcite , the proof is complete for @xmath1 even .",
    "if @xmath1 is odd , then the equivalent of proposition [ trivi ] is a bit more cumbersome .",
    "again , we let us make use of symmetry by taking complements , but instead of assuming @xmath72 , let us assume that @xmath224 . taking @xmath56",
    "then adds the restrictions @xmath225 , @xmath226 , @xmath227 , @xmath47 .",
    "then it is straightforward from the definition of @xmath228 that @xmath229 where @xmath230 is the number of descents of @xmath5 , and we say , for shortness , that the singleton @xmath231 has 0 runs .",
    "so for odd @xmath1 we have @xmath232 , and then , in order to see that the coefficients of @xmath233 are log - concave , we can repeat the argument of theorem  [ logcon ] .",
    "indeed , the coefficient of @xmath98 in @xmath233 equals the cardinality of @xmath234 , the subset of @xmath115 in which the edges @xmath235 are horizontal .",
    "and the fact that the @xmath236 are log - concave can be proved exactly as the corresponding statement for the @xmath237 , that is , by taking the relevant restriction of  @xmath153 ."
  ],
  "abstract_text": [
    "<S> we combinatorially prove that the number @xmath0 of permutations of length @xmath1 having @xmath2 runs is a log - concave sequence in @xmath2 , for all @xmath1 . </S>",
    "<S> we also give a new combinatorial proof for the log - concavity of the eulerian numbers . </S>"
  ]
}