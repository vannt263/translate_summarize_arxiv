{
  "article_text": [
    "in recent years we have seen the successful application of numerical codes to accurately calculate the spacetimes of compact astrophysical objects like collapsing stellar cores , ( proto)neutron stars , and black holes .",
    "most of these codes are based on the @xmath0 formalism of general relativity ( see , e.g. , @xcite for reviews ) .",
    "they typically fall into two classes .",
    "one approach relies on the _ free evolution _ of the @xmath0 einstein equations , recast in order to cure long - term stability problems . here",
    "the constraint equations are only solved initially , and closely monitored at each time step to control the accuracy of the numerical solution .",
    "alternatively , formulations based on a _ constrained evolution _ , where the constraints are solved in parallel with evolution equations , have proven to be successful as well .",
    "such approaches exhibit the advantage that the solution can not violate the constraints by definition ( within the accuracy of the numerical scheme ) .",
    "in particular , the conformally flat approximation  @xcite ( hereafter cfc ) of the full einstein equations , which constitutes a fully constrained formulation , has been shown to yield long - term stable evolutions of such astrophysical scenarios ( see , e.g. , @xcite ) .",
    "however , apart from computational challenges , arising from the need to frequently solve the elliptic constraint equations , constrained formulations suffer from mathematical nonuniqueness problems when the configuration becomes too compact . in the case of the collapse of a stellar core or a ( proto)neutron star to a black hole ,",
    "such a situation is encountered already before the apparent horizon forms .",
    "this issue has , in the past , been prohibitive to successfully applying such formulations in numerical simulations of a wide range of astrophysical problems .",
    "the nonuniqueness of solutions stems from the non - linearity of the constraint equations and has been studied within the so - called _ extended conformal thin sandwich ( xcts ) _",
    "@xcite approach to the initial data problem in general relativity . in ref .",
    "@xcite a parabolic branching was numerically found in the solutions to the xcts equations for perturbations of minkowski spacetime , providing the first evidence of nonuniqueness in this elliptic system .",
    "first analytical studies have been carried out in  @xcite , finding support for the genericity of this nonuniqueness behavior .",
    "more specifically , the xcts elliptic system is formed by the einstein constraint equations in a _ conformal thin sandwich ( cts ) _ decomposition  @xcite supplemented with an additional elliptic equation for the lapse function , which follows from the maximal slicing condition . although no general results on existence and uniqueness for the xcts system are available ( in contrast to the cts case and similar elliptic systems encompassing only the constraints ; see , e.g. , @xcite ) , the analysis in  @xcite strongly suggests the presence of a _",
    "wrong _ sign in a certain term of the lapse equation as the culprit for the loss of uniqueness , essentially because it spoils the application of a maximum principle to guarantee uniqueness .",
    "moreover , in these circumstances ( namely , the existence of a nontrivial kernel for the xcts elliptic operator ) it is shown in  @xcite that the parabolic behavior found in  @xcite is indeed generic .",
    "certain constrained evolution formalisms which incorporate elliptic gauges in their schemes contain elliptic subsystems which share essential points with the xcts equations .",
    "nonuniqueness in the elliptic subsystem is certainly an issue for the well - posedness of the whole elliptic - hyperbolic evolution system . in numerical implementations",
    "this can depend on the employed numerical scheme , in particular , on its capability to remain _ close _ to one of the solutions , at least as long as the solution stays sufficiently far from the branching point .",
    "in fact , constrained or partially constrained evolutions have shown to be robust in a variety of contexts ( see , e.g. , the references in  @xcite and sec .",
    "5.2.2 of  @xcite ) .",
    "however , the problems described above have also emerged , for instance , in the axisymmetric case in  @xcite ( see also  @xcite ) .",
    "the analysis in  @xcite concludes that the reason behind the failures in these axisymmetric formulations is in fact related to the presence of _ wrong _ signs or , more precisely , to the _ indefinite _ character of certain non - linear helmholtz - like equations present in the scheme ( see  @xcite for details and also for a parallel numerical discussion in terms of a class of relaxation methods for the convergence of the elliptic solvers ) .",
    "regarding the full three - dimensional case , fully constrained formalisms have been presented in  @xcite . while the work in  @xcite includes an elliptic subsystem closely related to the xcts equations and therefore suffers potentially from these nonuniqueness problems , the uniqueness properties of the scheme of  @xcite must yet be studied . in both cases ,",
    "the full numerical performance still has to be assessed .",
    "the goal of the present work is to discuss a scheme addressing the nonuniqueness issues of xcts - like elliptic systems in the full three - dimensional case , with astrophysical applications as our main motivation .",
    "having the analysis of the fully constrained formalism ( hereafter _ fcf _ ) of  @xcite as our ultimate aim , we focus on an approximation in the spirit of the cfc approximation by isenberg , wilson , and mathews  @xcite .",
    "this methodological choice is justified since the cfc scheme already contains the relevant elliptic system of fcf , but in a setting in which potential additional problematic issues related to the fcf hyperbolic part do not mix up with the specific problem we are addressing here .",
    "therefore , we discuss in detail a modification of the cfc scheme ( in the presence of matter ) where maximum - principle lines of reasoning can be used to infer the uniqueness of the solutions .",
    "we investigate numerically the performance of the new cfc scheme and finally indicate the main lines for its generalization to the full einstein fcf case .",
    "the article is organized as follows . in sec .",
    "[ ss : fcf_cfc ] we review the fcf and cfc formalisms , and then discuss the limitations found in the numerical implementations of the latter . in sec .",
    "[ sect : schemecfc ] we introduce the modification of the cfc scheme , with the aim of solving the uniqueness issues , and we present various numerical tests of the new scheme in sec .",
    "[ s : numerical_results ] . in sec .",
    "[ ss : gen_fcf ] the guidelines for the generalization to the fcf case are discussed , and conclusions are drawn in sec .  [",
    "s : discussion ] . in the appendix",
    "we justify a further approximation assumed in sec .",
    "[ sect : schemecfc ] which is consistent with the cfc setting . throughout the paper",
    "we use the signature @xmath1 for the spacetime metric , and units in which @xmath2 .",
    "greek indices run from 0 to 3 , whereas latin ones from 1 to 3 only .",
    "given an asymptotically flat spacetime @xmath3 we consider a @xmath0 splitting by spacelike hypersurfaces @xmath4 , denoting timelike unit normals to @xmath4 by @xmath5 .",
    "the data on each spacelike hypersurface @xmath4 are given by the pair @xmath6 , where @xmath7 is the riemannian metric induced on @xmath4 .",
    "we choose the convention @xmath8 for the extrinsic curvature . with the lapse function @xmath9 and the shift vector @xmath10",
    ", the lorentzian metric @xmath11 can be expressed in coordinates @xmath12 as @xmath13 on the other hand , we can write @xmath14 where @xmath15 is the levi  civita connection associated with @xmath16 and @xmath17 represents the lie derivative with respect to the evolution vector @xmath18 . as in  @xcite",
    "we introduce a _ time independent _ flat metric @xmath19 , which satisfies @xmath20 and coincides with @xmath21 at spatial infinity .",
    "we define @xmath22 and @xmath23 .",
    "this fiducial metric permits the use of tensor quantities rather than tensor densities .",
    "the next step in the formulation of  @xcite is the conformal decomposition of the @xmath0 fields .",
    "first , a representative @xmath24 in the conformal class of @xmath21 is chosen , so we can write    _ ij = ^4 _ ij , k^ij = ^-8 ^ij + k ^ij , [ e : conformal_decomp ]    where @xmath25 and @xmath26 , and @xmath27 . in ref .",
    "@xcite , the choice @xmath28 was adopted , leading to the following expression of @xmath29 in terms of the lapse @xmath9 and shift @xmath10 : @xmath30 @xmath31 being the levi  civita connection associated with @xmath24 .",
    "this is in the spirit of the decomposition employed in the ( x)cts approach to initial data .",
    "regarding the choice of the representative of the conformal metric @xmath24 , a unimodular condition @xmath32 was adopted in  @xcite , so that @xmath33 .",
    "the deviation of the conformal metric from the flat fiducial metric is denoted by @xmath34 , i.e.@xmath35 once the @xmath0 conformal decomposition is performed , a choice of gauge is needed in order to properly reformulate the einstein equations as partial differential equations .",
    "the prescriptions in  @xcite are _ maximal slicing _ and the so - called _ generalized dirac gauge _ , @xmath36 where @xmath37 stands for the levi  civita connection associated with the flat metric @xmath19 .",
    "the einstein equations then become a coupled elliptic - hyperbolic system to be solved for the basic variables @xmath34 , @xmath38 , @xmath9 , and @xmath10  @xcite .    expressing the differential operators in terms of the connection of the flat metric",
    ", the elliptic part can be written as    & = & - 2 e ^5 - h^kl d_k d_l + + & & - _ ik _ jl , [ e : conformal_factor ] + [ 1 em ] ( n ) & = & 2 n ^5 ( e + 2 s ) + n - h^kl d_k d_l ( n )",
    "+ & & + _ ik _ jl ,   [ e : conformal_factor*lapse ] + [ 1 em ] ^i + ^i d_j ^j & = & 16 n ^4 s^i - h^kl d_k d_l ^i - h^ik d_k d_l ^l + _ j ( ) + & & + _ j ( ) - 2 n ^i_kl ^kl , [ e : shift ]    where @xmath39 stands for the flat laplacian ( @xmath40 ) , @xmath41 , @xmath42 and @xmath43 are , respectively , the energy density , momentum density , and trace of the stress tensor , all measured by the observer of 4-velocity @xmath5 ( eulerian observer ) : in terms of the energy - momentum tensor @xmath44 , @xmath45 , @xmath46 , and @xmath47 , with @xmath48 .",
    "furthermore ,    & = & ^kl d_k h^mn d_l _ mn - ^kl d_k h^mn d_n _ ml , [ e : tilder ] + ( l ) ^ij & : = & d^i ^j + d^j ^i - f^ij d_k ^k , [ e : def_confkilling ] + ^k_ij & : = & ^kl ( d_i",
    "_ lj + d_j _ il - d_l _ ij ) .",
    "equation  ( [ e : conformal_factor ] ) follows from the hamiltonian constraint , whereas eq .",
    "( [ e : shift ] ) results from the momentum constraint together with the preservation of the dirac gauge in time . equation  ( [ e : conformal_factor*lapse ] ) corresponds to the preservation in time of the maximal slicing condition , @xmath49 . note that expression ( [ e : tilder ] ) for the ricci scalar of the conformal metric does not involve any second order derivative of the metric ; this property follows from dirac gauge @xcite .",
    "the resulting elliptic subsystem coincides with the xcts system  @xcite , except from the field chosen to solve the maximal slicing equation : eq .",
    "( [ e : conformal_factor*lapse ] ) above is to be solved for @xmath50 , whereas in  @xcite the _ conformal lapse _",
    "@xmath51 is employed instead .",
    "this directly affects the value ( and , in particular , the sign ) of the power of the conformal factor in the nonlinear terms of eqs .",
    "( [ e : conformal_factor ] ) and ( [ e : conformal_factor*lapse ] ) .",
    "more generally , one could define a generic rescaling of the lapse , @xmath52 , such that the choice in  @xcite corresponds to @xmath53 , whereas the choice in eq .",
    "( [ e : conformal_factor*lapse ] ) above corresponds to @xmath54 ( see  @xcite for the general equations in the vacuum case ) .",
    "an important remark is the absence of a choice of @xmath55 such that the factors multiplying @xmath38 and @xmath56 on the right hand side of the linearized versions of eqs .",
    "( [ e : conformal_factor ] ) and  ( [ e : conformal_factor*lapse ] ) both present a positive sign . in the presence of matter , terms multiplying the energy density",
    "@xmath41 also contribute to these sign difficulties , though in this case they can be fixed by an appropriate conformal rescaling of the energy density ( see later ) .",
    "an additional concern in a generic evolution scenario is the sign of @xmath57 , which is also relevant in the linearized equations .",
    "implications of this issue are discussed in sec .",
    "[ sect : schemecfc ] .",
    "the einstein equations in the form of the elliptic equations  ( [ e : conformal_factor])-([e : shift ] ) and the hyperbolic equation for @xmath34 as given in ref .",
    "@xcite are to be solved together with the hydrodynamic equations ,    _ ( u^ ) & = & 0 , [ e : hydro1 ] + _ t^ _ & = & 0 , [ e : hydro2 ] ,    where @xmath58 is the levi  civita connection associated with the metric @xmath11 , @xmath59 is the rest - mass ( baryon mass ) density , and @xmath60 is the 4-velocity of the fluid .      if the hyperbolic part of the fcf system is not solved , but rather the condition @xmath61 is imposed , the resulting three - metric @xmath21 is conformally flat , and the cfc approximation is recovered .",
    "therefore , the fcf is a natural generalization of the cfc approximation .",
    "the latter has been used in many astrophysical applications , like the rotational collapse of cores of massive stars  @xcite or supermassive stars  @xcite , the phase - transition - induced collapse of rotating neutron stars to hybrid quark stars  @xcite , equilibrium models of rotating neutron stars  @xcite , as well as for binary neutron star merger  @xcite .",
    "the elliptic subsystem of the fcf , eqs .",
    "( [ e : conformal_factor])([e : shift ] ) , reduces in cfc to    & = & - 2 ^-1 , [ e : psi_cfc0 ] + ( n ) & = & 2 n ^-1 ,   [ e : npsi_cfc0 ] + ^i + ^i d_j ^j & = & 16 n ^-2 ( s^*)^i + 2 ^10 k^ij d_j , [ e : beta_cfc0 ]    where the following rescaled matter quantities have been introduced , following york  @xcite :    e^ * & : = e & = ^6 e , [ e : def_estar ] + s^ * & : = s & = ^6 s , + ( s^*)_i & : = s_i & = ^6 s_i .",
    "[ e : def_sistar ]    equations  ( [ e : psi_cfc0 ] ) and  ( [ e : npsi_cfc0 ] ) inherit the local nonuniqueness problems already present in the fcf equations .",
    "although the sign problems specifically related to the energy density terms are solved by the conformal rescaling of the components of the energy - momentum tensor and the cfc eliminates the @xmath57 term , problems related to the @xmath62 term remain in the scalar cfc equations .",
    "this is apparent once the extrinsic curvature is expressed in terms of the lapse and the shift .",
    "conformal rescaling of the hydrodynamical variables is not only relevant for local uniqueness issues .",
    "the hydrodynamic equations  ( [ e : hydro1 ] ) and ( [ e : hydro2 ] ) can be formulated as a first - order hyperbolic system of conservation equations for the quantities @xmath63  @xcite , where , similarly to eqs .",
    "( [ e : def_estar])([e : def_sistar ] ) , @xmath64 , @xmath65 being the baryon mass density as measured by the eulerian observer",
    ". we can thus consider @xmath66 and @xmath67 as known variables in the computation of the cfc metric .",
    "note that these quantities differ from @xmath41 and @xmath68 by a factor @xmath69 , and hence it is not possible to compute the nonstarred quantities before knowing the value of @xmath38 . if the energy - momentum tensor represents a fluid , then the source of eq .",
    "( [ e : npsi_cfc0 ] ) can not be explicitly expressed in terms of @xmath63 , the reason for that being the dependence of @xmath70 on the pressure @xmath71 .",
    "the pressure can only be computed in terms of the `` primitive '' quantities , e.g. , as a function @xmath72 of the rest - mass density and the specific internal energy @xmath73 .",
    "the primitive quantities are , in general , recovered from @xmath74 implicitly by means of an iteration algorithm .",
    "so far , two solutions of the problem related to the fact that @xmath70 directly contains @xmath75 have been used in numerical simulations performed with the cfc approximation .",
    "the first approach  @xcite is to consider @xmath71 , and hence also @xmath70 , as an implicit function of @xmath38 .",
    "then eqs .",
    "( [ e : psi_cfc0])([e : beta_cfc0 ] ) can be solved as a coupled set of nonlinear equations using a fixed - point iteration algorithm .",
    "the convergence of the algorithm to the correct solution depends not only on the proximity of the initial seed metric to the solution , but also on the uniqueness of this solution .",
    "the latter point is extensively discussed in sec .",
    "[ sect : schemecfc ] .",
    "furthermore , one problem of this approach is the necessity of performing the recovery of the primitive variables ( which is numerically a time consuming procedure ) to compute the pressure during each fixed point iteration .",
    "because of the uniqueness problem , this approach can be only successfully applied in numerical simulations for , at most , moderately strong gravity ( like stellar core collapse to a neutron star or the inspiral and initial merger phase of binary neutron stars ) , but fails for more compact configurations like the collapse of a stellar core or a neutron star to a black hole . for such scenarios with very strong gravity ,",
    "one finds convergence of the metric to a physically incorrect solution of the equations or even nonconvergence of the algorithm .",
    "a second approach to the recovery algorithm problem is the attempt to calculate @xmath71 independently of the cfc equations .",
    "this can be achieved by computing the conformal factor by means of the evolution equation @xmath76 the conformal factor @xmath77 obtained in this way is analytically identical to the @xmath38 from eqs .",
    "( [ e : psi_cfc0])([e : beta_cfc0 ] ) , but here we use a different notation to keep track of the way it is computed .",
    "the value of @xmath77 is solely used to evaluate @xmath71 , and the coupled system of eqs .",
    "( [ e : psi_cfc0])([e : beta_cfc0 ] ) is solved for determining @xmath38 , @xmath9 , and @xmath10 .",
    "although this approach allows one to avoid the problem of recovering the primitive variables at each iteration , it also suffers from the convergence problem , and the simulation of configurations with very strong gravity is still not feasible .",
    "furthermore , new complications are introduced by using two differently computed values , @xmath38 and @xmath77 , of the same quantity .",
    "for some scenarios like the formation of a black hole from stellar collapse , the numerical values of these two quantities during the evolution of the system start to diverge significantly at some point .",
    "we find that this inconsistency can not be avoided , since any attempt to artificially synchronize both values leads to numerical instabilities .",
    "well - posed elliptic partial differential systems admit non - unique solutions whenever the associated differential operator has a nontrivial kernel . when discussing sufficient conditions guaranteeing uniqueness , it is illustrative to first consider the case of a scalar elliptic equation . in particular , for the class of scalar elliptic equations for the function @xmath78 of the form @xmath79 where @xmath80 and @xmath81 are known functions independent of @xmath78 , a maximum principle can be used to prove local uniqueness of the solutions as long as the sign of the exponent @xmath82 is different from the sign of the proper function @xmath80  @xcite .    in the cfc case",
    ", we are not dealing with a single scalar elliptic equation , but rather with the coupled non - linear elliptic system  ( [ e : psi_cfc0])-([e : beta_cfc0 ] ) .",
    "therefore , assessing wheter or not the scalar equations  ( [ e : psi_cfc0 ] ) and  ( [ e : npsi_cfc0 ] ) present the good signs for the application of a maximum principle is an important step for understanding the uniqueness properties of the whole system .",
    "however , as pointed out in the previous section , the cfc equations for the conformal factor and the lapse possess the wrong signs in the quadratic extrinsic curvature terms ( once everything is expressed in terms of the lapse and the shift ) .",
    "this problem can be fixed in eq .",
    "( [ e : psi_cfc0 ] ) by an appropriate rescaling of the lapse , @xmath83 , but this strategy does not solve the problem for the lapse equation ( cf .  the discussion on the conformal lapse @xmath56 in sec .",
    "[ ss : brief_review ] ) .",
    "therefore , we can not use the maximum principle to infer local uniqueness of the solutions to the cfc equations . in these conditions of potential nonunique solutions ,",
    "convergence to a undesirable solution may happen .",
    "as mentioned in the introduction , this pathology has been illustrated using simple analytical examples of scalar equations of the type  ( [ e : sign ] ) in  @xcite , as well as in numerical implementations of the vacuum einstein constraints in the xcts approach  @xcite and certain constrained evolution formalisms ( see , e.g. , @xcite ) .    in the context of the cfc approximation",
    "this sign issue has also appeared , in particular associated with the `` recovery algorithm '' problem discussed in sec .",
    "[ subsection : cfc_approximation ] since it involves the evaluation of the conformal factor .",
    "nonunique solutions of @xmath38 , either due to the use of the nonconformally rescaled @xmath41 or the quadratic extrinsic curvature term , spoil the convergence of the algorithm when density , and thus compactness , increases . we again emphasize that a possible synchronization of @xmath38 and @xmath77 does not solve the problem in general , since numerical instabilities eventually arise at sufficiently high compactness .      the nonuniqueness of solutions has also been observed in fcf , as described in the following example .",
    "let us consider a vacuum spacetime , with initial data formed by a gaussian wave packet , as in  @xcite , but with much higher amplitude @xmath84 instead of @xmath85 in  @xcite ( see the latter reference for notations ) .",
    "the integration technique and numerical settings are the same as in  @xcite , but contrary to the results for small amplitudes obtained in that reference , the wave packet does not disperse to infinity and instead starts to collapse .",
    "[ f : fcf_wave ] displays the time evolution of the central lapse @xmath86 at @xmath87 and of the system s arnowitt - deser - misner ( adm ) mass @xmath88 , which in the present conformal decomposition can be expressed as    m _ & = & - _ ( d_i - ^j _ ij ) da^i + & = & - _ _",
    "i da^i , [ e : adm_mass ]    where the integral is taken over a sphere of radius @xmath89 and the second equality follows from the use of dirac gauge [ eq .",
    "( [ e : gauges ] ) ] .",
    "= 8.6 cm    = 8.6 cm    the very sudden change at @xmath90 in both the central lapse and the adm mass , which is also present in , e.g. , the central conformal factor @xmath91 , originates from the convergence of the elliptic system  ( [ e : conformal_factor])-([e : shift ] ) to another solution with a different ( unphysical ) value of the adm mass .",
    "the good conservation of @xmath92 and the smooth evolution of @xmath93 for @xmath94 indicate that this other solution remains stable until @xmath95 , when high - frequency oscillations appear .",
    "these oscillations may be due to the overall inconsistency of the system , destabilizing the whole scheme .",
    "on the other hand , the time evolution of @xmath34 does not show any such type of behavior , and @xmath34 exhibits a continuous radial profile at all times .",
    "this is numerical evidence that , also for the full einstein case ( i.e.  without approximation ) , the generalized elliptic equations suffer from a similar convergence problem as in the cfc case .",
    "the same subject is also exemplified when one tries to calculate the spacetime metric for an equilibrium neutron star model from the unstable branch using either eqs .",
    "( [ e : conformal_factor])([e : shift ] ) in the fcf case or eqs .",
    "( [ e : psi_cfc0])([e : beta_cfc0 ] ) in the cfc approximation . even for the simple setup of a polytrope with adiabatic index @xmath96 in spherical symmetry , those metric equations yield  when converging at all  a grossly incorrect solution",
    "if the matter quantities @xmath74 in the source terms are held fixed .",
    "both the metric components as well as the adm mass can deviate from the physical solution by a few tens of percent , even though that incorrect metric satisfies the asymptotic flatness condition . the reason why programs for constructing rotating relativistic neutron star models , like the keh code  @xcite , the rns code  @xcite , or the bgsm code  @xcite , are not obstructed by this nonuniqueness problem is apparently that they all utilize an iteration over both the metric and the hydrodynamic equations _ simultaneously _ , thereby allowing the matter quantities to change during the calculation of the metric .",
    "we want to stress here that these non - convergence issues in the cfc case are not related to the approximation that is made . if one considers this system in the spherical ( one - dimensional ) case , cfc is no longer an approximation , but is the choice of the so - called isotropic gauge .",
    "even then , the elliptic system  ( [ e : psi_cfc0])-([e : beta_cfc0 ] ) no longer converges to the proper ( physical ) solution .      despite the above mentioned convergence problems , numerically simulating the physical problem of spherical collapse to a black hole in isotropic coordinates has been successfully studied by shapiro and teukolsky in  @xcite .",
    "because of the spherical symmetry , there exists only one independent component of the extrinsic curvature .",
    "it is then possible to compute directly a conformal extrinsic curvature , @xmath97 , from the conserved hydrodynamical variables .",
    "the elliptic equation for @xmath38 then decouples from the other elliptic equations by introducing this conformal extrinsic curvature and using the conserved hydrodynamical variables in the source .",
    "this source term presents no problem for proving local uniqueness , and",
    "the equation for @xmath38 always converges to the physically correct solution .",
    "once the conformal factor , the extrinsic curvature ( from the conformal factor and the conformal extrinsic curvature ) , and the conserved hydrodynamical variables are known , the elliptic equation for @xmath50 can be solved and , again , the source exhibits no local uniqueness problem .",
    "this follows from the fact that the extrinsic curvature is not expressed in terms of the lapse and the shift .",
    "this contrasts with the cfc equation  ( [ e : npsi_cfc0 ] ) where a division by @xmath98 occurs in the last term when the extrinsic curvature is expressed in terms of its constituents @xmath99 , @xmath100 , and @xmath101 .",
    "in addition , there is no need to use @xmath77 .",
    "finally , the elliptic equation for the shift vector can be solved . in summary ,",
    "no problems of instabilities or divergence are encountered .",
    "we now generalize this scheme to the cfc case in three dimensions .",
    "this involves the use of two different conformal decompositions of the extrinsic curvature : first , two different conformal rescaling and , second , two different decompositions of the traceless part into longitudinal and transverse parts . adopting maximal slicing , @xmath102",
    ", a generic conformal decomposition can be written as @xmath103 where @xmath104 is a free parameter and @xmath105 a free function , @xmath106 is transverse traceless and @xmath107 in the conformal killing operator defined by eq .",
    "( [ e : def_confkilling ] ) .",
    "we implicitly make use of a flat conformal metric , with respect to which @xmath106 is transverse , although , in principle , it would be more general to use the metric @xmath108 and the conformal killing operator associated with it , @xmath109 .",
    "but such a decomposition would introduce many technical difficulties in our treatment .",
    "in particular , it is numerically easier to handle tensors which are divergence - free with respect to the flat metric in the generalization to fcf .",
    "the vector @xmath110 , on which @xmath107 is acting , is therefore called the _ longitudinal part _ of @xmath111 . the first decomposition we use",
    "is the one introduced in eqs .",
    "( [ e : conformal_decomp ] ) and ( [ e : aij ] ) with the choice @xmath28 and @xmath112 .",
    "this corresponds to a cts - like decomposition of the traceless part , so that @xmath110 is given by the shift vector @xmath10 and @xmath106 can be expressed in terms of the time derivative of the conformal metric .",
    "we denote this traceless part as @xmath113 . in the cfc approximation",
    "this becomes @xmath114 the second conformal decomposition , @xmath115 refers to @xmath116 and @xmath117 .",
    "it instead corresponds to a conformal transverse traceless ( ctt ) decomposition of the traceless part of extrinsic curvature introduced by lichnerowicz  @xcite .",
    "notice that we have defined @xmath118 , not to be confused with @xmath113 .",
    "the relation between @xmath119 and @xmath29 is given by @xmath120 in terms of @xmath119 , the cfc momentum constraint can be written as @xmath121 consistency between the ctt - like decomposition  ( [ e : hatdefaij ] ) and the cts - like one  ( [ e : tildeaij ] ) generically requires a nonvanishing tranverse part @xmath122 in eq .",
    "( [ e : hatdefaij ] )",
    ". however , as it is shown in the appendix , this @xmath122 is smaller in amplitude than the nonconformal part @xmath34 of the spatial metric and @xmath119 can be approximated on the cfc approximation level as @xmath123 from eqs .",
    "( [ e : hatdefaij ] ) and ( [ e : div_hat_a ] ) , an elliptic equation for the vector @xmath110 can be derived , @xmath124 from which @xmath110 can be obtained . with this vector field",
    ", one can calculate the tensor @xmath119 via ( [ e : decomp_ta ] ) .",
    "notice that in the case of spherical symmetry , @xmath125 is the quantity used by shapiro and teukolsky  @xcite .    the elliptic equation for the conformal factor can be rewritten in terms of the conserved hydrodynamical variables and @xmath119 :    = - 2 ^-1 e^ * - ^-7 .",
    "[ e : psicfc ]    this equation can be solved in order to obtain the conformal factor .",
    "once the conformal factor is known , the procedure to implicitly recover the primitive variables from the conserved ones is possible , the pressure @xmath71 can be computed using the equation of state , and therefore @xmath70 is at hand . the elliptic equation for @xmath50",
    "can be reformulated by means of the conserved hydrodynamical variables , @xmath119 , and the conformal factor :    \\(n ) = 2 n ^-1 ( e^ * + 2 s^ * ) + n ^-7 .",
    "+ [ e : npsicfc ]    from this equation @xmath50 can then be obtained and , consequently , so can the lapse function @xmath9 .",
    "note that , since @xmath119 is already known at this step , no division by @xmath98 spoils the good sign for the maximum principle .    using the relation between the two conformal decompositions of the extrinsic curvature , @xmath126 , eq .",
    "( [ e : tildeaij ] ) can be expressed as @xmath127 .",
    "taking the divergence , we arrive at an elliptic equation for the shift vector , @xmath128 where the source is completely known .",
    "this elliptic equation can be solved in order to obtain the shift vector @xmath10 consistent with @xmath129 , as required by the cfc approximation .    in this recast of the cfc equations , an extra elliptic vectorial equation for the vector field @xmath110",
    ". however , now the signs of the exponents of @xmath100 and @xmath99 are compatible with the maximum principle for scalar elliptic equations , and the problem is _",
    "linearization stable_. while this does not guarantee _ global _ uniqueness of the solutions , it provides a sufficient result for _ local _ uniqueness .",
    "this strongly relies on the fact that the system decouples in a hierarchical way , which we summarize here once more :    1 .   with the hydrodynamical conserved quantities at hand ,",
    "solve eq .",
    "( [ e : equ_x ] ) for @xmath110 , and thus for @xmath119 .",
    "2 .   solve eq .",
    "( [ e : psicfc ] ) for @xmath38 , where local uniqueness is now guaranteed",
    ". then @xmath130 can be calculated consistently .",
    "3 .   solve eq .",
    "( [ e : npsicfc ] ) for @xmath50 , a linear equation where the maximum principle can be applied and uniqueness and existence follow with appropriate boundary conditions .",
    "4 .   as the source of eq .",
    "( [ e : shiftcfc ] ) is then fully known , solve it for @xmath10 .",
    "note that this scheme is similar to that used by shibata and ury  @xcite to compute initial data for black hole - neutron star binaries .",
    "we will discuss this point further in sec .",
    "[ s : compar_prev_works ] .",
    "the new cfc metric equations presented here not only allow us to evolve the hydrodynamical equations and recover the metric variables from the elliptic equations in a consistent way ( no auxiliary quantity @xmath77 is needed ) , but they also permit to introduce initial perturbations in the hydrodynamical variables ( strictly speaking , in the conserved quantities ) in a set of previously calculated initial data and directly delivers the correct values for the metric .",
    "it is even possible to perturb only the primitive quantities , and consistently resolve for the metric by iterating until the conformal factor @xmath100 , which links the primitive to the conserved quantities , converges .",
    "we find that such an iteration method fails for sufficiently strong gravity if the original cfc formulation is used .",
    "we recapitulate that the original cfc formulation exhibits serious convergence problems when dealing with highly compact configurations such as nascent black holes .",
    "this weakness of the original formalism is noticeable in the fact that no simulations of rotational collapse to a black hole substantially beyond the formation of the apparent horizon have been performed so far in the cfc .",
    "furthermore , some scenarios which do not involve the formation of a black hole are alredy feasible with the old formulation only if procedures like using eq .",
    "( [ e : der_conf_fact ] ) , with all associated problems and inconsistencies , are employed .",
    "an example is the migration of a neutron star model from the stable to the unstable branch , which is a standard test for relativistic hydrodynamics codes .",
    "in contrast , the new cfc scheme presented in this work solves all problems that prevented performing such simulations in the past . in order to show the suitability of the new scheme we present the results of numerical simulations of the migration test and of the rotational collapse to a black hole .",
    "the numerical simulations presented here are performed using the numerical code coconut  @xcite .",
    "this code solves the evolution of the hydrodynamics equations coupled to the elliptic equations for the spacetime metric in the cfc approximation .",
    "standard high - resolution shock - capturing schemes are used in the hydrodynamic evolution , while spectral methods are employed to solve the metric equations .",
    "the code is based on spherical polar coordinates , and for the tests presented here we assume axisymmetry and symmetry with respect to the equatorial plane .",
    "note that the metric equations presented in this paper are covariant .",
    "thus the formalism can be used for any coordinate basis as well as without any symmetry conditions .",
    "the initial models are general relativistic @xmath131 polytropes in equilibrium with a polytropic constant @xmath132 .",
    "the models are chosen to be situated on the unstable branch , i.e.  @xmath133 , where @xmath134 is the central rest - mass density .",
    "therefore , any perturbation of the star induces either the collapse to a black hole or migration to a configuration of the same baryon mass on the stable branch .",
    "table  [ tab : ini_models ] shows the main features of these initial models .",
    "models d1 to d4 are uniformly rotating models which are identical to those presented in  @xcite . the model",
    "labeled su is a spherical model , while model labeled ss is the counterpart model with the same baryon mass but it is located on the stable branch .",
    "the equilibrium rotating star models in dirac gauge ( the axisymmetric and stationary limit of fcf ) used here are described in  @xcite , and are computed using the lorene  @xcite library .",
    "we map the hydrodynamic and metric quantities to the cfc code neglecting the @xmath135 terms , which are negligible due to their smallness .",
    "alternatively , we compute cfc equilibrium initial models . in this case",
    "we find that the differences with respect to the fcf models are small ( @xmath136 ) for representative metric and hydrodynamic quantities , initially and during the evolution , and therefore we discuss only the fcf initial models here .",
    "lcccccc model & @xmath137 & @xmath138 & @xmath139 & @xmath140 & @xmath88 & @xmath141 + & [ @xmath142 & [ @xmath143 & & & + [ 0.2 em ]    ' '' ''    su & 8.000 & 0 & 1.00 & 4.267 & 1.447 & 0 + ss & 1.346 & 0 & 1.00 & 7.999 & 1.424 & 0 + [ 0.5 em ] d1 & 3.280 & 1.73 & 0.95 & 5.947 & 1.665 & 0.207 + d2 & 3.189 & 2.88 & 0.85 & 6.336 & 1.727 & 0.362 + d3 & 3.134 & 3.55 & 0.75 & 6.839 & 1.796 & 0.468 + d4 & 3.116 & 3.95 & 0.65 & 7.611 & 1.859 & 0.542 +    the hydrodynamic equation are discretized on the finite difference grid with @xmath144 grid points .",
    "the radial grid size is @xmath145 for the innermost cell and increases geometrically outwards , while the angular grid is equidistantly spaced .",
    "the metric equations are solved on a spectral grid consisting of @xmath146 radial domains distributed such as to homogeneously cover the finite difference grid and a compactified exterior domain extending to radial infinity . on the spectral grid",
    "we resolve each radial domain with @xmath147 collocation points .",
    "the spherical model needs only one angular collocation point , while we use @xmath148 angular points for the rotating models .",
    "we track the location of the apparent horizon by means of a three - dimensional spectral apparent horizon finder , described in detail and tested in  @xcite .",
    "the apparent horizon location is given by a function @xmath149 , which is decomposed into a set of spherical harmonics .",
    "the coefficients of @xmath150 in this basis are computed iteratively , in order to satisfy the condition that the expansion in the outgoing null direction vanishes at the apparent horizon location .",
    "the first test we consider is the migration of a neutron star model in equilibrium from the unstable branch to the stable branch , which is a standard but still demanding test for general relativistic hydrodynamics codes , as it involves the dynamic transition between two very compact equilibrium states .",
    "this test has been performed in the past in full general relativistic simulations  @xcite .",
    "we start the evolution with the nonrotating equilibrium model labeled su .",
    "since it belongs to the unstable branch , any perturbation from exact equilibrium ( which can , for instance , be caused by discretization errors ) leads either to a collapse or to an expansion to a new equilibrium configuration of the same baryon mass on the stable branch .",
    "the corresponding equilibrium configuration with the same baryon mass , model ss , has smaller adm mass than the initial system ( see table  [ tab : ini_models ] ) . therefore , to preserve the adm mass , the final configuration can not be exactly the equilibrium model given by ss . the energy difference between models",
    "su and ss should be transformed into kinetic energy , remaining in the final object in the form of pulsations .    in our case",
    "the numerical truncation error is sufficient to trigger the migration .",
    "since the final neutron star on the stable branch is larger than the initial model ( see table  [ tab : ini_models ] ) , the outer boundary of the finite difference grid is chosen to be @xmath151 times the radius of the model ss .",
    "we perform two simulations on a finite difference grid with @xmath152 or @xmath153 radial cells and @xmath154 or @xmath155 , respectively .",
    "we use @xmath156 radial domains for the spectral grid .",
    "we evolve the system with either a polytropic or an ideal gas equation of state .",
    "= 8.6 cm    = 8.6 cm    figure  [ fig : migration ] shows the time evolution of the central values of the rest - mass density and the lapse .",
    "as the star expands , @xmath134 decreases while @xmath86 grows until the new stable equilibrium configuration is reached . in the polytropic case , there are no physical mechanisms to damp the strong pulsations , and the final state resembles a star oscillating around the equilibrium configuration until numerical dissipation finally damps the oscillations .",
    "this can be seen in the pulsating values of rest - mass density and lapse around the value corresponding to the equilibrium model on the stable branch ( solid horizontal line in fig .",
    "[ fig : migration ] ) .",
    "in the ideal gas case , shock waves are formed at every pulsation , and they dissipate kinetic energy into thermal energy , thereby damping the oscillations . as these shocks reach the surface of the star , a small amount of mass is expelled from the star and matter is ejected outwards into the surrounding artificial low - density atmosphere until it leaves the grid across the outer numerical boundary .",
    "we approximately compute the escape velocity as @xmath157 , where @xmath158 is the newtonian potential .",
    "this formula is not exact in general relativity , but it should by sufficiently accurate near the outer numerical boundary where gravity is weaker .",
    "we find that the shock waves leaving the computational domain exceed the escape velocity and therefore the lost mass is gravitationally unbounded .",
    "we also check that these results are not affected by changing the resolution or setting the outer boundary twice as far away .",
    "as the oscillations are damped , the shocks become weaker and the mass expelled at each oscillation is smaller . at the end of the simulation",
    "the star has lost about @xmath159 of its initial baryon mass , approaching a state of constant baryon mass . as a consequence ,",
    "the final equilibrium configuration on the stable branch is not the model ss anymore but , rather , the corresponding model from the stable branch with lower baryon mass and central density . in fig .",
    "[ fig : migration ] we plot the central rest - mass density and lapse of a series of equilibrium models on the stable branch corresponding to the baryon mass remaining in the computational domain at each time .",
    "it can be seen that these values deviate with time from model ss and fit the final state in the hydrodynamical evolution of the star .    as a by - product of this study",
    "we draw reader s attention to the consistency ( as it should be ) between the amplitude and the frequency of the oscillations .",
    "the period of these oscillations is approximately of the order of the hydrodynamical characteristic time @xmath160 , which decreases with density like @xmath161 . in the polytropic case ,",
    "the maxima of the oscillations in @xmath162 are systematically higher than in the ideal gas case .",
    "consequently , the characteristic time is shorter than in the ideal gas case , as fig .",
    "[ fig : migration ] shows .",
    "a second property worth pointing out is that the low numerical viscosity of our code is responsible for maintaining a nearly constant amplitude of the oscillations ( in the polytropic case ) during many characteristic times .",
    "our simulations are consistent with the results from a fully relativistic three - dimensional code in  @xcite .",
    "similar simulations of this test , with the original , unmodified cfc scheme , lead to a completely incorrect solution with a grossly incorrect adm mass .",
    "when running with the new improved cfc scheme , we obtain @xmath163 and initial values for the conformal factor and lapse of @xmath164 and @xmath165 , respectively . on the other hand , with the unmodified conventional cfc scheme",
    ", the metric solver already initially converges to a solution with @xmath166 ( 55% ) , @xmath167 ( 61% ) and @xmath168 ( 63% ) , where the relative differences to the physically correct solution are given in parentheses .",
    "as presented in  @xcite the migration test can be successfully simulated using the old cfc scheme , if one resorts to additionally solving the evolution equation  ( [ e : der_conf_fact ] ) for the conformal factor ( which would lead to large inconsistencies in scenarios with higher compactness but still yields acceptable results for the standard migration case ) . here",
    "the superiority of the new , fully consistent cfc scheme , which does not depend on such scenario - dependend amendments , alredy becomes apparent .",
    "as the second test we present the collapse of a ( spherical or rotating ) neutron star model to a black hole . following",
    "@xcite we trigger the collapse to a black hole by reducing the polytropic constant @xmath169 by @xmath170 in the initial models d1 to d4 .",
    "alternatively , in the spherical su model we increase the rest - mass density by @xmath171 , which yields a similar dynamic evolution .",
    "however , since the models are initially in equilibrium , the total collapse _",
    "time _ depends strongly on the perturbation applied . in these cases ,",
    "the outer boundary of the finite difference grid is @xmath172 larger than the star radius . for the spherical su model ,",
    "we perform two simulations using @xmath152 or @xmath153 radial cells and @xmath173 or @xmath174 , respectively , to assess the resolution dependence of our simulations . for the rotating models d1 to d4 the grid is made up of @xmath175 and @xmath176 cells , with the same radial grid spacing as in the spherical model .",
    "we choose @xmath177 radial domains for the spectral grid . as in",
    "@xcite we use a polytropic equation of state in the evolution .",
    "= 8.6 cm    = 8.6 cm    = 8.6 cm    the top panel of fig .",
    "[ fig : bh ] shows the evolution of the rest - mass density and lapse at the center . since for the maximal slicing condition",
    "the singularity can not be reached in a finite time , @xmath86 rapidly approaches zero once the apparent horizon has formed . in parallel ,",
    "@xmath134 grows , which results in a decrease of the numerical time step due to the courant condition applied to the innermost grid cell .",
    "we terminate the evolution as the central regions of the collapsing star inside the apparent horizon become increasingly badly resolved on the regular grid , and thus numerical errors grow .",
    "we check in su model that by refining the radial resolution we are able to follow the collapse to even higher densities .",
    "therefore , the only limitation to perform a stable evolution after the apparent horizon formation is the numerical resolution used .",
    "note , however , that the spatial gauge condition is fixed in cfc , and thus we are not able to utilize the common method of exploiting the gauge freedom for the radial component of the shift vector in order to effectively increase the central resolution .    in the bottom panel of fig .",
    "[ fig : bh ] we display the time evolution of the apparent horizon radius .",
    "as expected , the apparent horizon appears at a finite radius and already encompasses a significant fraction of the total mass of the star ( @xmath178 ) at that time .",
    "afterwards , its radius grows as the surrounding matter falls inside beyond the horizon .",
    "the fraction of the rest mass remaining outside the horizon is also plotted in the figure . in the rotating case",
    "the apparent horizon is slightly nonspherical .",
    "the ratio of the polar to the equatorial proper circumferential radius of the apparent horizon at the end of the simulation is @xmath179 for models d1 to d4 , where @xmath180 and @xmath181 .",
    "since we can not reasonably determine the location of the event horizon , as this would require the evolution of spacetime until the black hole has become practically stationary , we utilize the apparent horizon radius to estimate the mass of the newly formed black hole . following the prescription in",
    "@xcite we use the expression @xmath182 .",
    "note that this formula is only strictly valid for a stationary kerr black hole . in our case , however , first of all , some ( albeit a small ) amount of matter is still outside the horizon and the black hole is still dynamically evolving , and second , the metric of a kerr black hole is not conformally flat  @xcite .",
    "still , according to  @xcite this approximation ( excluding the effects of cfc ) introduces an error in the mass estimate of only @xmath183 .",
    "for the spherical model the estimated value for @xmath184 at the end of the simulation agrees within @xmath185 with the adm mass @xmath88 of the initial model , while in the rotating models d1 to d3 the error is @xmath186 . in all these cases",
    "the above formula overestimates the black hole mass . because of its rapid rotation and the resulting strong centrifugal forces , in model d4 the collapse deviates significantly from sphericity , leading to a strongly oblate form of the density stratification .",
    "consequently , we still find a non - negligible amount of matter outside the apparent horizon at the end of the simulation ( about @xmath187 of the total rest mass ) .",
    "therefore the value for @xmath184 is @xmath188 smaller than @xmath88 . in fig .",
    "[ fig : d4 ] we present the distribution of the rest - mass density and the location of the apparent horizon at the end of the simulation for this particular model . since the time evolution is limited by",
    "our chosen , still computationally affordable , grid resolution in the central region , we are not able to evolve this model to times when a disk forms as in  @xcite .",
    "nevertheless , all other quantities qualitatively agree with the results in that work , although we refrain from performing a more detailed comparison due to the respective differences in the gauge of the two formulations used in  @xcite and in this study , respectively .    in the near future",
    "we plan to carry out an exhaustive analysis of the scenario of a collapse to a black hole by comparing , on one hand , the cfc formulation with fcf ( see sec .  [",
    "ss : gen_fcf ] ) , and , on the other hand , the fcf with other ( _ free evolution _ ) formulations . the difficulties induced by the use of different gauges can be overcome by using gauge - invariant quantities for comparison and analyzing their behavior as a function of proper time .",
    "the ideas presented in sec .  [ sect : schemecfc ] can be generalized to the fcf approach of the full einstein equations described in sec .",
    "[ ss : brief_review ] .    as shown in  @xcite , the hyperbolic part of fcf can be split into a first order system .",
    "the reformulation of the cfc equations presented in sec .",
    "[ sect : schemecfc ] relies on the rescaled extrinsic curvature @xmath119 given by eq .",
    "( [ e : hataij ] ) . consequently , we write the fcf hyperbolic part as a first order system in @xmath189 , instead of first order system in @xmath190 as in  @xcite , arriving at    & = & 2 n ^-6 ^ij + ^k w^ij_k - ^ik _ k ^j - ^kj _ k ^i + ^ij _ k ^k , [ e : dhdt ] + & = & - _ k ( - ^kl w^ij_l - ^k ^ij ) - ^kj _ k ^i - ^ik _ k ^j + ^ij _ k ^k + 2 n ^-6 _ kl ^ik ^jl + & & - 8 n ^6 ( ^4 s^ij - ) +",
    "n ( ^2 _ * ^ij + 8 ^ik ^jl _ k _ l ) + 4 ( ^ik ^jl _ k _ l n + ^ik ^jl _ k n _ l ) + & & - ^ij + & & - ( ^ik w^lj_k + ^kj w^il_k ) _ l ( n ^2 ) - ^ik ^jl _ k _ l ( n ^2 ) + ^ij ^kl _ k _ l ( n ^2 ) , [ e : dhatadt ]    where    & w^ij_k : = _ k h^ij , & + [ 1 em ] & _ * ^ij : = + ^ik ^jl w_k^mn _ l _ mn .",
    "&    the system is closed by adding the equation @xmath191 which is derived from applying partial derivatives with respect to @xmath192 in the definition of @xmath193 . moreover , the system observes the constraint of dirac gauge , @xmath194 [ eq .  (",
    "[ e : gauges ] ) ] , and for the determinant of the conformal metric , we obtain @xmath195 .",
    "the first order system given by eqs .",
    "( [ e : dhdt])([e : dsdtw ] ) has the same properties regarding hyperbolicity and existence of fluxes as the one in  @xcite .",
    "it has the advantage over the second order system for @xmath34 proposed in ref .",
    "@xcite of getting rid of partial derivatives with respect to @xmath192 of the lapse @xmath9 , the shift @xmath10 , or the conformal factor @xmath38 .",
    "the elliptic part of fcf can be rewritten , using the tensor @xmath119 , as    ^kl _ k _ l & = & - 2 ^-1 e^ * - + , [ e : psifcf ] + ^kl _ k _ l ( n ) & = & ( n ) , [ e : npsifcf ] + ^kl _ k _",
    "l ^i + ^ik _ k _",
    "l ^l & = & 16 n ^-6 ^ij(s^*)_j + ^ij _ j ( 2 n ^-6 ) - 2 n ^-6 ^i_kl ^kl .",
    "[ e : shiftfcf ]    the strategy to evolve the two symmetric tensors @xmath34 and @xmath119 relies on a decomposition of these tensors in longitudinal and transverse traceless parts .",
    "the longitudinal parts ( divergences with respect to the flat metric ) are either known a priori or are determined by the elliptic equations . more specifically ,",
    "the divergence of @xmath34 vanishes according to the dirac gauge , whereas the divergence of @xmath119 is determined by the momentum constraint  ( [ e : momentum_hata ] )  see below .",
    "consequently , focus is placed on the transverse traceless parts of these tensors .",
    "the latter are described in a pure - spin tensor harmonic decomposition , as discussed in a previous article  @xcite . in particular , each transverse traceless tensor is fully expressed in terms of two scalar potentials ( named @xmath196 and @xmath197 in  @xcite ) that are evolved according to evolution equations obtained from the transverse traceless parts of eqs .",
    "( [ e : dhdt ] ) and  ( [ e : dhatadt ] ) for @xmath34 and @xmath119 , respectively , by applying consistently the decomposition in  @xcite . once the scalar potentials on the next time slice are determined , the tensors @xmath34 and @xmath122 can be reconstructed completely , satisfying the divergence - free conditions .",
    "this fully fixes @xmath34 , whereas in the case of @xmath119 the longitudinal part is computed in a very similar way to the cfc case , i.e.  by determining the vector @xmath110 from the momentum constraint as described hereafter .    from eq .",
    "( [ e : hatdefaij ] ) , the momentum constraint can be written as @xmath198 which is equivalent to the following elliptic equation for @xmath110 :    & & _",
    "j^j x^i + ^i_k x^k + ^im ( _ k _ ml - ) + & & ( ^k x^l + ^l x^k - f^kl _ p x^p ) = + & & 8 ^ij ( s^*)_j - ^im ( _ k _ ml - ) _ ^kl .",
    "[ e : fcf_x ]    this elliptic equation for the vector @xmath110 is linear .",
    "since @xmath34 and @xmath122 have been calculated previously , we can solve the elliptic equation  ( [ e : fcf_x ] ) to obtain the vector @xmath110 . with this method , the dirac gauge and the momentum constraint",
    "are guaranteed to be satisfied .",
    "then , @xmath119 is reconstructed from @xmath122 and @xmath110 on the new time slice .    at this point , since the tensors @xmath34 and @xmath119 are known , we can follow exactly the same scheme as in the cfc case to solve in a hierarchical way the elliptic equations .",
    "first the conformal factor is obtained from eq .",
    "( [ e : psifcf ] ) , then the lapse function from eq .",
    "( [ e : npsifcf ] ) , and finally the shift vector is acquired from eq .",
    "( [ e : shiftfcf ] ) .",
    "these equations are decoupled in the order mentioned .",
    "no sign problems are exhibited in the scalar elliptic equation and therefore the maximum principle can be applied .",
    "a minor concern is associated with the sign of the term @xmath57 in eq .",
    "( [ e : psifcf ] ) , but unique solutions also exist for negative conformal ricci scalars ( closely related to @xmath57 ) .",
    "note that , contrary to the cfc case , here no ( additional ) approximation has been made : it is simply a new scheme to write down fcf , where the elliptic part is better behaved from the point of view of local uniqueness .",
    "numerical simulations with this fcf scheme will be presented in a future publication .",
    "we have presented an approach to the solution of the uniqueness issues appearing in certain constrained formulations of einstein equations .",
    "we have illustrated the problem and its solution through a detailed analytical and numerical study of a waveless approximation that retains all the involved essential features .",
    "more specifically , we have reformulated xcts - like elliptic systems appearing in constrained evolution schemes of the einstein equations , like fcf of  @xcite , as well as in the cfc approximation  @xcite .",
    "such systems require the simultaneous solution of the constraints , in particular , the momentum constraint for the shift , together with a maximal slicing condition for the lapse .",
    "the resulting elliptic system presents potential local nonuniqueness problems , and numerical implementations have indeed encountered such obstacles .",
    "the original cfc formulation has not been able to cope with these problems , as it suffers from convergence of the system to unphysical solutions or nonconvergence at all in high density regimes .",
    "we have suggested that these problems are not due to the approximative nature of cfc , since fcf in the variant of  @xcite , which is a natural generalization of cfc to the nonconformally flat case , also suffers from the same problems . in order to address these issues , first focusing on the simpler cfc case ,",
    "we have considered the conformal rescaling of the traceless part of the extrinsic curvature , resulting in the expression for @xmath119 in eq .",
    "( [ e : hataij ] ) , which is a rescaling different from the respective ones employed in fcf and the cfc approximation , but coincides with the one in the xcts approach of  @xcite .",
    "this is motivated by the work of shapiro and teukolsky  @xcite , who simulated the collapse of a neutron star model using such a reformulation of the cfc metric equations ( however , restricted to spherical symmetry in their case ) and apparently did not encounter any of the problems described above . extending their approach to three dimensions",
    ", we have decomposed @xmath119 into longitudinal and transverse parts as in the ctt formulation of the constraint equations  ( [ e : decomp_ta ] ) . the divergence ( i.e.  the longitudinal part ) of this tensor",
    "is determined by the momentum constraints , eqs .",
    "( [ e : div_hat_a ] ) in the cfc case , just as in the ctt formulation . in the cfc scheme ,",
    "we have neglected the transverse part of this tensor , as the order of its error is higher than the one arising from the cfc approximation itself . in the nonapproximate fcf case ,",
    "the transverse part of @xmath119 is determined by an evolution equation .",
    "once the conformal extrinsic curvature is obtained , it can be employed in the hamiltonian equation to calculate the conformal factor @xmath38 .",
    "the lapse is then fixed through the maximal slicing condition , and the resulting equation allows the application of a maximum principle uniqueness argument .",
    "finally , the shift is found through the kinematical relationship defining the extrinsic curvature , leading to eq .",
    "( [ e : shiftcfc ] ) .    by performing a variety of tests ,",
    "we have provided evidence that the problem of convergence to an unphysical solution of the metric equations ( or even complete nonconvergence ) in the original formulation of the cfc scheme is fully cured by our new reformulation .",
    "not only can numerical results in the original cfc scheme ( in the , at most , moderately gravitationally compact regime where that system still yields physically correct solutions ) be reproduced by the new formulation but , more importantly , the new numerical results presented here exhibit the proper numerical and physical behavior even for highly compact configurations . for the first time , it has been possible to successfully perform both the migration test and the collapse of a neutron star to a black hole in the cfc case in a consistent way .",
    "our new formulation thus facilitates simulations in the high density regime of those scenarios where the cfc is still a reasonably fair approximation , that is , for systems which are not too far from sphericity , like stellar gravitational collapse .      as compared to the original cfc formulation by isenberg  @xcite and mathews and wilson  @xcite , the scheme presented here",
    "is augmented by an additional vector elliptic equation for @xmath110 , while the elliptic character of the system of metric equations is preserved .",
    "the new scheme reformulates the cfc approximation in a ctt shape ( one scalar and one vector elliptic equation ) , and then solves for the lapse and the shift ( one additional scalar and one vector elliptic equation ) .",
    "in contrast , the original cfc scheme employed an ( x)cts approach where , together with two scalar elliptic equations , only one vector elliptic equation was present .",
    "in contrast to the original scheme , the elliptic system in the new formulation not only corrects the problem of local uniqueness in the scalar elliptic equations , but also introduces a hierarchical structure that decouples the system in one direction .    in the context of the conformally flat approximation , the same `` augmented cfc '' scheme as that discussed here has been introduced already by saijo  @xcite to compute gravitational collapse of differentially rotating supermassive stars .",
    "however , in this work the inconsistency between eq .",
    "( [ e : tildeaij ] ) and eq .",
    "( [ e : decomp_ta ] ) , i.e.   setting to zero the transverse traceless part of @xmath199 , has not been pointed out . on the contrary",
    ", we have analyzed this inconsistency in detail ( cf .",
    "the appendix ) and have shown that it leads to an error of the same order as that of the cfc approximation .",
    "in addition , we have shown here that the introduction of the vector potential @xmath110 is the key ingredient for solving the nonuniqueness issue .",
    "the same scheme , but without the conformal rescaling of the matter quantities , has also been used recently by shibata and ury  @xcite in the context of computing initial data . as in  @xcite , the inconsistency resulting from setting to zero the transverse traceless part of @xmath199 and the uniqueness issue are not discussed in their work .",
    "we emphasize that the these studies  @xcite do not discuss the extension of the new scheme to the nonconformally flat case , as done here .",
    "let us also mention that the augmented cfc scheme presented here can be regarded as a hybrid mixture of some of the waveless approximation theories ( wat ) proposed by isenberg  @xcite .",
    "in fact , the cfc approximation using the two choices @xmath200 and @xmath201 [ as employed in eq .",
    "( [ e : shiftcfc ] ) ] corresponds to version wat - i . on the other hand , the approximation @xmath202 used in eq .",
    "( [ e : decomp_ta ] ) is in the spirit of the vanishing transverse traceless part of the extrinsic curvature in the ( coupled ) version , wat - ii ( although wat - ii refers to the physical extrinsic curvature , whereas here we have dealt with the conformal one ) .",
    "as mentioned above , both assumptions are consistent at the considered level of approximation , as shown in the appendix .",
    "regarding the complete constrained evolution of the einstein equations , we have generalized the ideas presented here for the cfc case to the elliptic part of fcf . in previous studies",
    "@xcite , the hyperbolic part of einstein equations resulted in a wave - type equation for the tensor @xmath34 , representing the deviation of the three - metric from conformal flatness . with the introduction of @xmath119 we have recovered here a first - order evolution system , analogous to the standard hamiltonian @xmath0 system , in which we have",
    ", however , retained only the divergence - free terms .",
    "thus , for both @xmath34 and @xmath119 , the transverse ( divergence - free ) parts are evolved by this system , while the longitudinal parts are fixed either by the gauge ( for @xmath34 ) , or by the momentum constraint ( for @xmath119 ) .",
    "numerical results for this case will be presented in future studies .",
    "we finally comment on the recent work by rinne  @xcite , where uniqueness problems appearing in certain constrained and partially constrained schemes for vacuum axisymmetric einstein equations  @xcite are addressed . as in the present case , uniqueness issues related to the hamiltonian constraint equation are solved by adopting an appropriate rescaling the extrinsic curvature . on the other hand , problems associated with the slicing condition are tracked to the substitution in that equation of the extrinsic curvature by its kinematical expression in terms of the ( shift and the ) lapse .",
    "the latter spoils the uniqueness properties by reversing the sign of the relevant term in the slicing equation .",
    "this problem is solved by enlarging the elliptic system with an additional vector so as to reexpress the relevant components of the extrinsic curvature without resorting to the lapse .",
    "the resulting elliptic system also presents a hierarchical structure .",
    "although the spirit of such approach is close to the one here presented , the specific manner of introducing the additional vector variable in  @xcite critically relies on the two dimensionality of the axisymmetric problem ( specifically , on a choice of a particular gauge and on the fact that vectors and rank - two traceless symmetric tensors have the same number components in two dimensions , a property lost in three dimensions ) . on the contrary , the introduction of the vector @xmath110 through the ctt decomposition  ( [ e : decomp_ta ] ) is properly devised to work in three dimensions .",
    "relevant related discussions in the three - dimensional context can be found in sec .",
    "3.4 of  @xcite ( where the relation between nonuniqueness problems in xcts and axisymmetric constrained evolution schemes is discussed ) and in the three - dimensional constrained evolution scheme presented by moncrief et  al .  in  @xcite .",
    "it is a pleasure to thank j.  m.  ibez , m.  saijo and k.  ury for many fruitful discussions . i.  c .- c .",
    "acknowledges support from from the spanish ministerio de educacin y ciencia ( ap2005 - 2857 ) , and h.  d.  is supported by the marie curie intra - european fellowship within the 6th european community framework programme ( ief 040464 ) .",
    "this work was supported by the ministerio de educacin y ciencia through grant no .",
    "aya2007 - 67626-c03 - 01 , by the deutsche forschungsgemeinschaft through the transregional collaborative research center grant no .",
    "sfb / tr  7 `` gravitational wave astronomy '' , by the french anr grant no .",
    "06 - 2 - 134423 `` mthodes mathmatiques pour la relativit gnrale '' , by the french  spanish bilateral research grant no . hf2005 - 0115 , and by the european network of theoretical astroparticle physics entapp ilias",
    "/ n6 under contract no .",
    "rii3-ct-2004 - 506222 .",
    "in the derivation of the new formalism we make use of the fact that @xmath203 in cfc . we show next that this assumption is completely consistent at the accuracy level of the cfc approximation . in the first place , we need to estimate the error of the cfc approximation itself . by definition ,",
    "the cfc three - metric deviates linearly with @xmath34 from the ( exact ) fcf case .",
    "it can be easily shown from the fcf equations  ( [ e : psifcf])-([e : shiftfcf ] ) that the metric quantities behave as        two limits in which cfc is exact will be considered .",
    "first , in spherical symmetry the cfc metric system is an exact reformulation of the einstein equations since @xmath61 in the fcf metric .",
    "if the system is close to spherical symmetry ( i.e.  spheroidal ) , and if we are able to define a quasispherical surface of the system ( e.g. , the surface of a star or the apparent horizon of a black hole ) , then the equatorial and polar circumferential proper radius , @xmath204 and @xmath205 , can be computed , and we can define the ellipticity of the system as @xmath206 close to sphericity , @xmath207 scales linearly with @xmath34 , and we can ensure that the error of cfc is @xmath208 . the second limit to consider is if a post - newtonian expansion of the gravitational sources is possible , i.e.  if the post - newtonian parameter @xmath209 , where @xmath210 , @xmath211 , and @xmath107 are the typical velocity , mass , and length of the system , respectively . in this case the cfc metric behaves like the first post - newtonian approximation  @xcite , i.e.      note that , for clarity , we explicitly retain powers of the speed of light @xmath212 as factors in the equations throughout this appendix . in the case that both limits are valid , i.e.  close to sphericity and in the post - newtonian expansion , the nonconformally - flat part of the three - metric behaves like @xmath213 .",
    "the next step is to compute the behavior of the cfc metric if we assume @xmath214 , considering the two limiting cases introduced above .    in the spherically symmetric case",
    "the relation @xmath215 is trivially fulfilled .",
    "therefore the behavior for a quasi - spherical configuration is also @xmath216 even if @xmath202 is assumed .",
    "this limit in the approximation is very important , since it is independent of the strength of the gravitational field . for example",
    ", it allows us to evolve black holes , with the only condition that @xmath34 should be small , i.e.  close to the sphericity .    to check the approximation in the post - newtonian limit",
    ", we need to compare @xmath217 and @xmath110 .",
    "this can be done by means of the post - newtonian expansion of the sources of eqs .",
    "( [ e : beta_cfc0 ] ) and  ( [ e : equ_x ] ) , respectively ,      from the comparison of eqs .",
    "( [ e : pn_beta ] ) and  ( [ e : pn_x ] ) we obtain that @xmath218 thus @xmath119 can be computed in terms of @xmath110 as @xmath219 where we make use of @xmath220 .",
    "the effect of using @xmath221 instead of @xmath119 in the calculation of the cfc metric can be seen in the expressions    _ & = & ^-1 _ s _ ( ) ( n _ , _ , ^ij ) + & = & ^-1 _ s_()(n _ , _ , ( lx)^ij ) + & & + ( 1 / c^8 ) , [ e : psi ] + [ 1 em ] n _ & = & _ ^-1 ^-1 _ s_(n ) ( n _ , _ , ^ij ) + & = & _ ^-1 ^-1 _ s_(n ) ( n _ , _ , ( l x)^ij ) + & & + ( 1 / c^8 ) , [ e : npsi ] + [ 1 em ] c _ ^i & = & c ^-1 _ _ ( ) ( n _ , _ , ^ij ) + & = & c ^-1 _ s _ ( ) ( n _ , _ , ( l x)^ij ) + & & + ( 1 / c^6 ) .",
    "[ e : betai ]    where @xmath222 , @xmath223 and @xmath224 are the sources of eqs .",
    "( [ e : psicfc])([e : shiftcfc ] ) , and @xmath225 and @xmath226 are just the inverse operators appearing in the right - hand - side of these equations ( for the scalars @xmath38 and @xmath50 , and for the vector @xmath10 , respectively ) .",
    "when comparing eqs .",
    "( [ e : psi])([e : betai ] ) with eqs .",
    "( [ e : pn_psi])([e : pn_betai ] ) , it becomes obvious that in all cases the error introduced by making the approximation @xmath227 is smaller than the error of the cfc approximation itself .        as an illustration of the above properties , we study the influence of the @xmath122 term in eq .",
    "( [ e : decomp_ta ] ) when computing rotating neutron star models with a polytropic @xmath131 equation of state .",
    "this model setup contains the initial models used in sec .",
    "[ s : numerical_results ] .",
    "they assume axial symmetry and stationarity , in combination with rigid rotation .",
    "we build a sequence of rotating polytropes with increasing rotation frequencies , while keeping the central enthalpy fixed , which produces models of increasing masses from @xmath228 ( no rotation ) , to @xmath229 ( the kepler limit ; see below ) .",
    "for all these models , we use three gravitational field schemes : the exact einstein equations using the stationary ansatz in fcf , and the two approximate ones , regular cfc and cfc , neglecting the term @xmath122 in eq .",
    "( [ e : decomp_ta ] ) .",
    "the results are displayed on a logarithmic scale in fig .",
    "[ f : cfc_new_check ] . in the top panel",
    "we show the maximal amplitudes of @xmath122 ( relatively to @xmath119 ) in both fcf and regular cfc , as functions of the ellipticity @xmath230 defined in eq .",
    "( [ e : def_ellipt ] ) .",
    "this quantity is physically and numerically limited by the minimal rotational period at the so - called mass - shedding limit ( or kepler limit ) , when centrifugal forces exactly balance gravitational and pressure forces at the star s equator . in the fcf case",
    "we plot the maximal amplitude of @xmath34 .",
    "this quantity is dimensionless and represents the deviation of the three - metric from conformal flatness , which can be interpreted as the relative error one makes in the metric when using cfc instead of fcf .",
    "note that this error in computing @xmath119 by discarding the @xmath122 term in the cfc approximation is roughly of the same magnitude as the error on the metric in the cfc case .",
    "all these quantities decrease like @xmath231 as expected , except for stars rotating close to the kepler limit . indeed ,",
    "the development in powers @xmath230 is equivalent to a slow - rotation approximation ( see , e.g. , @xcite ) by perturbing spherically symmetric configurations , and , when comparing these slow - rotation results to numerical `` exact '' ones for rigidly rotating stars ( see , e.g. , @xcite in the two - fluids case ) , one sees that they usually agree extremely well , excepted very close to the kepler limit , where this `` perturbed spherical symmetry '' approach is no longer valid . finally , because @xmath119 appears as a quadratic source term in the poisson - like equations  ( [ e : psi_cfc0 ] ) and ( [ e : npsi_cfc0 ] ) , the overall errors on the lapse @xmath9 or the conformal factor @xmath38 are even smaller , as shown in the bottom panel of fig .",
    "[ f : cfc_new_check ] . in the case of the central value @xmath232 of the lapse , the error due to the cfc approximation is maximal at the kepler limit and @xmath233 for the studied sequence .",
    "the error which is then due to neglecting @xmath122 within the cfc scheme amounts to @xmath234 and decreases faster than the error due to the cfc approximation , namely , as @xmath235 , again except near the kepler limit .",
    "our tests thus show that for stationary rotating neutron star models this additional approximation induces an error which falls within the overall cfc approximation .",
    "v.  moncrief , l.  buchman , h.  p.  pfeiffer , o.  rinne , and o.  sarbach , talk at _ from geometry to numerics _ workshop , institut henri poincar , paris ( 2006 ) , www.luth.obspm.fr/ihp06/workshops/geomnum/ , and private communication ."
  ],
  "abstract_text": [
    "<S> uniqueness problems in the elliptic sector of constrained formulations of einstein equations have a dramatic effect on the physical validity of some numerical solutions , for instance , when calculating the spacetime of very compact stars or nascent black holes . </S>",
    "<S> the fully constrained formulation ( fcf ) proposed by bonazzola , gourgoulhon , grandclment , and novak is one of these formulations . </S>",
    "<S> it contains , as a particular case , the approximation of the conformal flatness condition ( cfc ) which , in the last ten years , has been used in many astrophysical applications . </S>",
    "<S> the elliptic part of the fcf basically shares the same differential operators as the elliptic equations in cfc scheme . </S>",
    "<S> we present here a reformulation of the elliptic sector of cfc that has the fundamental property of overcoming the local uniqueness problems . </S>",
    "<S> the correct behavior of our new formulation is confirmed by means of a battery of numerical simulations . </S>",
    "<S> finally , we extend these ideas to fcf , complementing the mathematical analysis carried out in previous studies . </S>"
  ]
}