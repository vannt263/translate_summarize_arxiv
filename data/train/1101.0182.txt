{
  "article_text": [
    "hamilton cycles occupy a position of central importance in graph theory , and are the subject of countless results . in the context of random structures ,",
    "much research has been done on many aspects of hamiltonicity , in a variety of random structures .",
    "see , e.g. , any of @xcite concerning erds - rnyi random graphs and random regular graphs , any of @xcite regarding directed graphs , or any of the recent developments @xcite on uniform hypergraphs .",
    "in this paper we consider the existence of rainbow hamilton cycles in edge - colored graphs .",
    "( a set @xmath4 of edges is called _ rainbow _ if each edge of @xmath4 has a different color . )",
    "there are two general types of results in this area : existence * whp * is said to occur _ with high probability _",
    "( * whp * ) if @xmath5 .",
    "] under random coloring and guaranteed existence under adversarial coloring .    when considering adversarial ( worst - case ) coloring , the guaranteed existence of a rainbow structure is called an _ anti - ramsey _ property .",
    "erds , neetil , and rdl @xcite , hahn and thomassen @xcite and albert , frieze , and reed @xcite ( correction in rue @xcite ) considered colorings of the edges of the complete graph @xmath6 where no color is used more than @xmath7 times .",
    "it was shown in @xcite that if @xmath8 , then there must be a multi - colored hamilton cycle .",
    "cooper and frieze @xcite proved a random graph threshold for this property to hold in almost every graph in the space studied .",
    "there is also a history of work on random coloring ( see , e.g. , any of @xcite ) , and it has recently become apparent that this random setting may be of substantial utility .",
    "indeed , a result of janson and wormald @xcite on rainbow hamilton cycles in randomly edge - colored random regular graphs played a central role in the recent determination of the threshold for loose hamiltonicity in random 3-uniform hypergraphs by frieze @xcite . roughly speaking ,",
    "a hyperedge ( triple of vertices ) can be encoded by an ordinary edge ( pair of vertices ) , together with a color .",
    "hence , a random 3-uniform hypergraph gives rise to a randomly edge - colored random graph .",
    "we will discuss this further in section [ sec : graphs - to - hypergraphs ] , when we use the reverse connection to realize one part of our new result .",
    "let us now focus on the random coloring situation , where we consider the following model .",
    "let @xmath9 denote a randomly colored random graph , constructed on the vertex set @xmath10 $ ] by taking each edge independently with probability @xmath11 , and then independently coloring it with a random color from the set @xmath12 $ ] .",
    "we are interested in conditions on @xmath13 which imply that @xmath9 contains a rainbow hamilton cycle * whp*. the starting point for our present work is the following theorem of cooper and frieze .",
    "( see @xcite , theorem 1.1 . ) there exist constants @xmath14 and @xmath15 such that if @xmath16 and @xmath17 , then @xmath9 contains a rainbow hamilton cycle * whp*.    the aim of this paper is to substantially strengthen the above result by proving :    [ th1 ]    ( a ) : :    there exists a constant @xmath18 such that if    @xmath19 , then for even @xmath20 , @xmath21    contains a rainbow hamilton cycle * whp*. ( b ) : :    if @xmath22 and    @xmath23 , where    @xmath24 , then    @xmath9 contains a rainbow hamilton cycle    * whp*.    to discuss the tightness of our main theorem , let us recall the threshold for hamiltonicity in @xmath0 , established by komls and szemerdi @xcite .",
    "we find that we must have @xmath25 with @xmath26 , or else the underlying uncolored @xmath0 will not even be hamiltonian .",
    "we also need at least @xmath20 colors to appear on the edges in order to have enough colors for a rainbow hamilton cycle .",
    "note that the earlier result came within a constant factor of both of these minimum requirements , while part ( a ) above achieves the absolute best possible constraint on the number of colors , while still staying within a constant factor of the minimally required number of edges ( albeit only for even @xmath20 ) .",
    "part ( b ) drives both constants down to be best possible up to first order , and for all values of @xmath20 , regardless of parity .",
    "we permit our error terms @xmath27 and @xmath28 to decrease slowly , although we do not expect our constraints on them to be optimal .",
    "our discussion above shows that the trivial lower bound for @xmath27 is around @xmath29 .",
    "then , if @xmath30 , we need at least @xmath31 colors just to ensure that * whp *  at least @xmath20 distinct colors occur on the @xmath32 edges in the graph ; hence , the trivial lower bound for @xmath28 is around @xmath33 . we leave further exploration to future work , and highlight a potential answer in our conclusion .",
    "this paper is organized as follows .",
    "we begin by establishing part ( a ) of theorem [ th1 ] in the next section .",
    "section 3 outlines the proof of part ( b ) , which is the main contribution of this paper .",
    "the proofs of the main steps follow in the section thereafter .",
    "we conclude in section 5 with some remarks and open problems .",
    "the following ( standard ) asymptotic notation will be utilized extensively . for two functions @xmath34 and @xmath35 , we write @xmath36 , @xmath37 , or @xmath38 if @xmath39 , and @xmath40 or @xmath41 if there exists a constant @xmath42 such that @xmath43 for all sufficiently large @xmath20",
    ". we also write @xmath44 if both @xmath40 and @xmath45 are satisfied .",
    "all logarithms will be in base @xmath46 .",
    "in this section we prove part ( a ) of our main theorem , and demonstrate the connection between rainbow hamilton cycles in graphs and loose hamilton cycles in 3-uniform hypergraphs .",
    "indeed , this will allow us to realize part ( a ) as essentially a reformulation of the following recent result of frieze @xcite .",
    "let @xmath47 denote the random 3-uniform hypergraph where each potential hyperedge appears independently with probability @xmath11 . in this object ,",
    "loose hamilton cycle _ is a permutation of the vertices @xmath48 such that @xmath49 , @xmath50 ,  , @xmath51 all appear as hyperedges ( @xmath20 must be even ) .",
    "( see @xcite , theorem 1 . )",
    "[ th : loose-3 ] there is an absolute constant @xmath18 such that if @xmath52 , then for all @xmath20 divisible by 4 , the random hypergraph @xmath47 on the vertex set @xmath53 contains a loose hamilton cycle * whp*. furthermore , one can find such a cycle of the special form @xmath54 , for some permutations @xmath55 .",
    "as mentioned in the introduction , this theorem was proven by connecting loose hamilton cycles in random 3-uniform hypergraphs with rainbow hamilton cycles in randomly edge - colored random graphs , and applying a result of janson and wormald @xcite .",
    "we will use the reverse connection to demonstrate the equivalence between theorem [ th1](a ) and theorem [ th : loose-3 ] .",
    "* proof of theorem [ th1](a ) .",
    "* let @xmath18 be the constant in theorem [ th : loose-3 ] .",
    "we are given an even integer @xmath20 , and a graph @xmath56 with @xmath57 on vertex set @xmath58 , whose edges are randomly colored from the set @xmath59 .",
    "construct an auxiliary 3-uniform hypergraph @xmath60 with vertex set @xmath61 , by taking the hyperedge @xmath62 whenever the edge @xmath63 appears in @xmath64 , with color @xmath65 .",
    "note that every such hyperedge appears independently with probability @xmath66 , since @xmath63 appears in @xmath64 with probability @xmath11 , and receives color @xmath65 with probability @xmath67 .",
    "therefore , theorem [ th : loose-3 ] implies that @xmath60 has a loose hamilton cycle * whp * , of the form @xmath68 .",
    "this corresponds to the hamilton cycle @xmath69 in @xmath64 , with edges colored @xmath70 , hence rainbow . @xmath71",
    "let @xmath24 be given .",
    "we will implicitly assume throughout ( when convenient ) that they are sufficiently small .",
    "our proof proceeds in three phases , so our parameters come in threes .",
    "let us arbitrarily partition the @xmath72 colors into three disjoint groups @xmath73 , with sizes @xmath74 we will analyze the random edge generation in three stages , so we define the probabilities @xmath75 the @xmath27 s and @xmath28 s are defined by the relations @xmath76 ( we would have taken @xmath77 , except that lemma [ lem : cover - s00 ] requires @xmath78 . )      it is more convenient for our entire argument to work with directed graphs , as this will allow us to conserve independence . recall that @xmath79 is the model where each of the @xmath80 possible directed edges appears independently with probability @xmath11 .",
    "we generate a random colored undirected graph via the following procedure .",
    "first , we independently generate three digraphs @xmath81 , @xmath82 , and @xmath83 , and color all of the directed edges from the full set of colors .",
    "we next use the @xmath84 to construct a colored undirected graph @xmath64 , by taking the undirected edge @xmath85 if and only if at least one of @xmath86 or @xmath87 appear among the @xmath84 .",
    "the colors of the undirected edges are inherited from the colors of the directed edges , in the priority order @xmath88 , @xmath89 , @xmath90 .",
    "specifically , if @xmath86 or @xmath87 appear already in @xmath88 , then @xmath85 takes the color used in @xmath88 even if @xmath86 or @xmath87 appear again in @xmath90 , say . in the event that both @xmath86 and @xmath87 appear in @xmath88",
    ", the color of @xmath86 is used for @xmath85 with probability @xmath91 , and the color of @xmath87 is used otherwise .",
    "similarly , if neither of @xmath86 nor @xmath87 appear in @xmath88 , but @xmath86 appears in both @xmath89 and @xmath90 , the color used in @xmath89 takes precedence .",
    "it is clear that the resulting colored graph @xmath64 has the same distribution as @xmath92 , with @xmath93      in each of our three phases , we will use one group of edges and one group of colors .",
    "since each @xmath84 contains edges colored from the entire set @xmath94 , for each @xmath95 we define @xmath96 to be the spanning subgraph consisting of all directed edges whose color is in @xmath97 .",
    "our final undirected graph is generated by superimposing directed graphs and disregarding the directions .",
    "consequently , we do not need to honor the directions when building hamilton cycles . to account for this ,",
    "we define three corresponding colored undirected graphs @xmath98 , @xmath99 , and @xmath100 .",
    "these will be edge - disjoint , respecting priority .",
    "the first , @xmath98 , is constructed as follows . for each pair of vertices",
    "@xmath101 with @xmath102 but @xmath103 , place @xmath85 in @xmath98 in the same color as @xmath86",
    ". if both @xmath86 and @xmath87 are in @xmath104 , we still place the edge @xmath85 in @xmath98 , but randomly select either the color of @xmath86 or of @xmath87 .",
    "however , if @xmath102 but @xmath105 , then @xmath85 is only placed in @xmath98 with probability @xmath91 ; if it is placed , it inherits the color of @xmath86 . note that this construction precisely captures all undirected edges arising from @xmath88 , using colors in @xmath106 .",
    "we are less careful with @xmath99 , as our argument can afford to discard all edges that arise from multiply covered pairs .",
    "specifically , we place @xmath107 if and only if @xmath108 and @xmath109 . as the pair @xmath110",
    "is now spanned by only one directed edge in @xmath89 , the undirected edge @xmath85 inherits that unique color .",
    "we define @xmath100 similarly , placing @xmath111 if and only if @xmath112 and @xmath113 .    in this way",
    ", we create three edge - disjoint graphs @xmath114 . by our observations in the previous section",
    ", we may now focus on finding an ( undirected ) rainbow hamilton cycle in @xmath115 .",
    "importantly , note that in terms of generating colored undirected edges , the digraph @xmath88 has higher `` priority '' than @xmath89 or @xmath90 .",
    "so , for example , the generation of @xmath98 is not affected by the presence or absence of edges from @xmath89 or @xmath90 .",
    "we generally prefer to work with @xmath114 and @xmath116 instead of @xmath84 because we are guaranteed that the edge colors lie in the corresponding @xmath97 .",
    "this allows us to build rainbow segments in separate stages , without worrying that we use the same color twice .",
    "let @xmath117 denote the out - degree of @xmath118 in @xmath116 .",
    "we now define a set @xmath4 of vertices that need special treatment .",
    "we first let @xmath119 where @xmath120 also , define @xmath121 , and note that the constraints on @xmath122 in theorem [ th1 ] imply the bound @xmath123    [ lem1 ] the set @xmath124 satisfies @xmath125 * whp*.    the vertices in @xmath124 are delicate because they have low degree .",
    "we also need to deal with vertices having several neighbors in @xmath124 . for this",
    ", we define a sequence of sets @xmath126 in the following way . having chosen @xmath127 ,",
    "if there is still a vertex @xmath128 with at least 4 out - neighbors in @xmath127 ( in any of the graphs @xmath104 , @xmath129 , or @xmath130 ) , we let @xmath131 and continue . otherwise we stop at some value @xmath132 and take @xmath133 .",
    "[ lem2 ] with probability @xmath134 , the set @xmath4 contains at most @xmath135 vertices .    to take care of the dangerous vertices in @xmath4",
    ", we find a collection of vertex disjoint paths @xmath136 such that ( i ) each path uses undirected edges in @xmath99 , ( ii ) all colors which appear on these edges are distinct , ( iii ) all interior vertices of the paths are vertices of @xmath4 , ( iv ) every vertex of @xmath4 appears in this way , and ( v ) the endpoints of the paths are not in @xmath4 . let us say that these paths _ cover _ @xmath4 .",
    "[ lem3 ] the graph @xmath99 contains a collection @xmath137 of paths that cover @xmath4 * whp*.    the next step of our proof uses a random greedy algorithm to find a rainbow path of length close to @xmath20 , avoiding all of the previously constructed @xmath138 .",
    "[ lem4 ] the graph @xmath99 contains a rainbow path @xmath139 of length @xmath140{\\log n}}$ ] * whp*. furthermore , @xmath139 is entirely disjoint from all of the @xmath138 , and all colors used in @xmath139 and the @xmath138 are distinct and from @xmath141 .",
    "let @xmath142 be the vertices outside @xmath139 .",
    "( note that @xmath142 contains all of the paths @xmath138 . )",
    "in order to link the vertices of @xmath142 into @xmath139 , we split @xmath139 into short segments , and use the edges of @xmath100 to splice @xmath142 into the system of segments .",
    "we will later use the edges of @xmath98 to link the segments back together into a rainbow hamilton cycle , so care must be taken to conserve independence .",
    "the following lemma merges all vertices of @xmath142 into the collection of segments , and prepares us for the final stage of the proof . here",
    ", @xmath143 denotes the number of @xmath104-edges from @xmath118 to a set @xmath144 .",
    "let @xmath145 and note that our conditions on @xmath146 in theorem [ th1 ] , together with , imply that @xmath147 , so we have @xmath148{\\log n}.\\ ] ]    [ lem5 ] with probability @xmath149 , the entire vertex set can be partitioned into segments @xmath150 , with @xmath151 , such that the edges which appear in the segments all use different colors from @xmath152 .",
    "the segment endpoints are further partitioned into @xmath153 , with each segment having one endpoint in @xmath144 and one in @xmath154 , such that every @xmath155 has @xmath156 , and every @xmath157 has @xmath158 .",
    "all of the numeric values @xmath159 and @xmath160 have already been revealed , but the locations of the corresponding edges are still independent and uniform over @xmath154 and @xmath144 , respectively .    the final step links together the segments @xmath150 using distinctly - colored edges from @xmath98 .",
    "for this , we create an auxiliary colored directed graph @xmath161 , which has one vertex @xmath162 for each interval @xmath163 .",
    "there is a directed edge @xmath164 if there is an edge @xmath165 between the @xmath154-endpoint of @xmath166 and the @xmath144-endpoint of @xmath163 ; it inherits the color of @xmath167 .",
    "since all colors of edges in @xmath161 are from @xmath106 , it therefore suffices to find a rainbow hamilton directed cycle in @xmath161 .",
    "we will find this by connecting @xmath161 with a well - studied random directed graph model .",
    "[ def : d - in - d - out ] the @xmath168-in , @xmath168-out random directed graph model @xmath169 is defined as follows .",
    "each vertex independently chooses @xmath168 out - neighbors and @xmath168 in - neighbors uniformly at random , and all resulting directed edges are placed in the graph . due to independence ,",
    "it is possible that a vertex @xmath170 selects @xmath118 as an out - neighbor , and @xmath118 also selects @xmath170 as an in - neighbor . in that case , instead of placing two repeated edges @xmath86 , place only one .",
    "instead of proving hamiltonicity from scratch , we apply the following theorem of cooper and frieze .",
    "( see @xcite , theorem 1 . )",
    "[ thm:2-in-2-out ] the random graph @xmath171 contains a directed hamilton cycle * whp*.    this result does not take colors into account , however . fortunately ,",
    "in equation , we define @xmath172 to be large enough to allow us to select a subset of @xmath98-edges which is itself already rainbow .",
    "the analysis of this procedure is the heart of the proof of the final step .",
    "[ lem7 ] the colored directed graph @xmath161 contains a rainbow directed hamilton cycle * whp*.    since each directed edge of @xmath161 corresponds to an undirected @xmath98-edge from a @xmath154-endpoint of an interval to an @xmath144-endpoint of another interval , a directed hamilton cycle in @xmath161 corresponds to a hamilton cycle linking all of the intervals together .",
    "lemma [ lem7 ] establishes that it is possible to choose these linking edges as a rainbow set from @xmath106 .",
    "the edges within the intervals were themselves colored from @xmath152 , so the result is indeed a rainbow hamilton cycle in the original graph , as desired .",
    "in the remainder of this paper , we prove the lemmas stated in the previous section .",
    "although the first lemma is fairly standard , we provide all details , and use the opportunity to formally state several other well - known results which we apply again later .",
    "our first lemma controls the number of vertices whose degrees in @xmath116 are too small .",
    "recall from section [ sec : underlying - digraph - model ] that the @xmath84 are independently generated .",
    "their edges are then independently colored , and the edges of @xmath84 which receive colors from @xmath97 are collected into @xmath116 .",
    "( priorities only take effect when we form the @xmath114 in section [ sec : d - to - g ] . )",
    "therefore , the out - degrees @xmath117 of vertices @xmath118 in @xmath116 are distributed as @xmath173 thus the expected size of @xmath124 satisfies @xmath174 } \\le n(\\rho_1 + \\rho_2 + \\rho_3),\\ ] ] where @xmath175 } \\\\",
    "\\rho_2 & =    { \\mathbb{p}\\left [ { \\text{\\rm bin}\\left ( 0.99 n , \\frac{0.49 \\log n}{n } \\right ) } \\leq \\frac{\\log n}{20 } \\right ] } \\\\",
    "\\rho_3 & =    { \\mathbb{p}\\left [ { \\text{\\rm bin}\\left ( 0.99 n , \\frac{0.49 \\e_3 \\th_3 \\log n}{n } \\right ) } \\leq \\frac{\\e_3 \\th_3 \\log n}{20 } \\right]}.\\end{aligned}\\ ] ]    we will repeatedly use the following case of the chernoff lower tail bound , which we prove with an appropriate explicit constant .    [",
    "lem : bin9 ] the following holds for all sufficiently large @xmath176 , where @xmath177 is a positive integer and @xmath178 is a real number .",
    "@xmath179 } < e^{-0.533 mq}.\\ ] ]    * proof .",
    "* calculation yields @xmath179 }    =    \\sum_{k=0}^{mq/9 } \\binom{m}{k } q^k ( 1-q)^{m - k } \\\\",
    "<    \\sum_{k=1}^{mq/9 } { \\left(\\frac{emq}{k}\\right)}^k e^{-\\frac{8}{9 } mq}.\\ ] ] the function @xmath180 is increasing in @xmath7 in the range @xmath181 .",
    "thus @xmath182 }    & <    \\frac{mq}{9 } \\cdot { \\left(\\frac{emq}{mq/9}\\right)}^{mq/9 } e^{-\\frac{8}{9 } mq } \\\\    & =    \\frac{mq}{9 } \\cdot ( 9e)^{mq/9 } e^{-\\frac{8}{9 } mq } \\\\    & =    e^ { mq ( \\frac{1}{9 } \\log 9e - \\frac{8}{9 } + o(1 ) ) } \\\\    & <    e^ { -0.533 mq } , \\end{aligned}\\ ] ] as claimed .",
    "@xmath71    returning to the proof of lemma [ lem1 ] , we observe that since @xmath183 , a direct application of lemma [ lem : bin9 ] now gives @xmath184 } \\\\    & <    e^ { -0.533 \\cdot 0.99 \\cdot",
    "0.49 \\log n } \\\\    & <    n^{-0.258}.\\end{aligned}\\ ] ] a similar argument establishes that @xmath185 and @xmath186 .",
    "this proves that @xmath187 } = o(n^{1-\\g})$ ] , where we recall our definition @xmath188 .",
    "we complete the proof of the lemma by showing that @xmath189 is concentrated around its mean .",
    "for this , we use the hoeffding - azuma martingale tail inequality applied to the vertex exposure martingale ( see , e.g. , @xcite ) . recall that a martingale is a sequence @xmath190 of random variables such that each conditional expectation @xmath191}$ ] is precisely @xmath192 .",
    "[ thm : azuma ] let @xmath193 be a martingale , with bounded differences @xmath194 .",
    "then for any @xmath195 , @xmath196 }      \\ \\leq \\",
    "\\exp\\left\\{-\\frac{\\lambda^2}{2 c^2 n}\\right\\}.\\ ] ]    here we consider @xmath189 to be a function of @xmath197 where @xmath198 denotes the set of edges @xmath199 , @xmath200 .",
    "the sequence @xmath201}$ ] is called the vertex - exposure martingale .",
    "there is a slight problem in that the worst - case lipschitz value for changing a single @xmath198 can be too large , while the average case is good .",
    "there are various ways of dealing with this .",
    "we will make a small change in @xmath202 .",
    "let @xmath203 be obtained from @xmath204 by reducing every degree below @xmath205 .",
    "we do this in vertex order @xmath206 and delete edges incident with @xmath118 in descending numerical order .",
    "we can show that this usually has no effect on @xmath204 .",
    "[ lem : max - degree ] with probability @xmath134 , every vertex in @xmath207 with @xmath208 has degree at most @xmath205 .    * proof . *",
    "the probability that a single vertex has degree at least @xmath205 is @xmath209 }    & \\leq    \\binom{n}{5\\log n } { \\left(\\frac{1.1 \\log n}{n}\\right)}^{5 \\log n } \\\\    & \\leq    \\left (      \\frac{e n}{5 \\log n }      \\cdot      \\frac{1.1",
    "\\log n}{n }    \\right)^{5 \\log n } \\\\    & =    { \\left(\\frac{1.1e}{5}\\right)}^{5 \\log n } \\\\    & = n^{-2.57},\\end{aligned}\\ ] ] so a union bound over all vertices gives the result .",
    "@xmath71    therefore , @xmath210 } = 1 - o(n^{-1})$ ] , and so if we let @xmath211 be the size of the corresponding set evaluated in @xmath203 , we obtain @xmath212 } = { \\mathbb{e}\\left [ |s_0| \\right ] } + o(1 ) = o(n^{1 - \\g})$ ] . furthermore , changing a @xmath198 can only change @xmath213 by at most @xmath214 .",
    "so , we have @xmath215 } + \\frac{1}{4 } n^{1-\\g } \\right ] }    \\leq    { \\exp\\left\\ { -\\frac{n^{2 - 2\\g}/16}{2 ( 15 \\log n)^2 n } \\right\\ } }    <    o(n^{-1}),\\ ] ] completing the proof of lemma [ lem1 ] .",
    "@xmath71      we use the following standard estimate to control the densities of small sets .    [ lem : small - sparse ] with probability @xmath216 , in @xmath79 with @xmath217 , every set @xmath4 of fewer than @xmath218 vertices satisfies @xmath219 . here ,",
    "@xmath220 is the number of directed edges spanned by @xmath4 .    * proof . * fix a positive integer @xmath221 , and consider sets of size @xmath222 .",
    "we may assume that @xmath223 , because a single vertex can not induce any edges .",
    "the expected number of sets @xmath4 with @xmath224 and @xmath225 is at most @xmath226 it remains to show that when this bound is summed over all @xmath227 , the result is still @xmath228 .",
    "indeed , for each @xmath229 , the bound is at most @xmath230 , so the total contribution from that part is only @xmath231 . on the other hand , for each @xmath232 , the bound is at most @xmath233 thus the total contribution from @xmath234 is at most @xmath228 , as desired .",
    "@xmath71    we are now ready to bound the size of the set @xmath4 which was created by repeatedly absorbing vertices with many neighbors in @xmath124 .",
    "* proof of lemma [ lem2 ] .",
    "* we actually prove a stronger statement , which we will need for lemma [ lem : few - nbr - s ] .",
    "suppose we have an initial @xmath124 satisfying @xmath235 , as ensured by lemma [ lem1 ] .",
    "consider a sequence @xmath236 where @xmath237 is obtained from @xmath238 by adding a vertex @xmath239 for which @xmath240 for some @xmath95 .",
    "note that when this process stops , the final set @xmath241 will contain the set @xmath4 which our definition obtained by adding vertices with degree at least 4 into previous @xmath127 .",
    "so , suppose for contradiction that this process continues for so long that some @xmath242 reaches @xmath243 .",
    "note that @xmath244 .",
    "since each step introduces at least 3 edges , we must have @xmath245 .",
    "yet by construction , @xmath246 is an instance of @xmath247 for some @xmath248 , so this contradicts lemma [ lem : small - sparse ] .",
    "@xmath71      in this section , we show that for each vertex @xmath249 , we can find a disjoint @xmath99-path @xmath250 which starts and ends outside @xmath4 .",
    "we also need all colors appearing on these edges to be different .",
    "since we are working in a regime where degrees can be very small , we need to accommodate the most delicate vertices first .",
    "specifically , let @xmath251 be the set of all vertices with @xmath252 , where @xmath253 is the degree of @xmath118 in @xmath99 .",
    "although @xmath251 will typically not be entirely contained within @xmath254 , we can show that it is still usually quite small .",
    "[ lem : s00 ] we have @xmath255 * whp*.    * proof .",
    "* by construction , @xmath256 , where @xmath257 because the first factor is the probability that exactly one of @xmath86 or @xmath87 appears in @xmath89 , the second factor is the probability that it receives a color from @xmath141 , and the third factor is the probability that neither @xmath86 nor @xmath87 appear in @xmath88 .",
    "hence for a fixed vertex @xmath118 , its relevant degree in @xmath99 is distributed as @xmath258 since @xmath259 , lemma [ lem : bin9 ] implies that @xmath260 }    & <    { \\mathbb{p}\\left [   { \\text{\\rm bin}\\left ( 0.99 n , \\frac{0.99",
    "\\log n}{n } \\right ) }      \\leq \\frac{1}{9 } \\cdot 0.99 \\cdot 0.99 \\log n   \\right ] } \\\\    \\nonumber & <    e^ { -0.533 \\cdot 0.99 \\cdot 0.99",
    "\\log n } \\\\    & <    n^{-0.522}. \\label{d1real - low}\\end{aligned}\\ ] ] therefore , @xmath261 } < n \\cdot n^{-0.522}$ ] , and markov s inequality yields the desired result .",
    "@xmath71    we have shown that vertices of @xmath251 are few in number .",
    "our next result shows that they are also scattered far apart .",
    "this will help us when we construct the covering paths , by preventing paths from colliding .",
    "[ lem : dist5 ] let @xmath262 denote the distance between @xmath118 and @xmath263 in @xmath99 .",
    "then , * whp * , every pair @xmath264 satisfies @xmath265 .",
    "* proof . *",
    "recall that @xmath256 with @xmath266 defined as in .",
    "consider a fixed pair of vertices @xmath267 .",
    "for a fixed sequence of @xmath268 intermediate vertices @xmath269 , let us bound the probability @xmath270 that @xmath267 both have @xmath271 , and all the edges @xmath272 appear in @xmath99 .",
    "first expose the edges @xmath273 , @xmath274 , ",
    ", @xmath275 , and then expose the edges between @xmath118 and @xmath10 \\setminus \\{v , x_1 , \\ldots , x_k , w\\}$ ] , and between @xmath263 and that set .",
    "this gives the following bound on our probability @xmath270 : @xmath276}^2\\ ] ] a calculation analogous to bounds the binomial probability by @xmath277 , so taking a union bound over all @xmath278 choices for the @xmath279 , for all @xmath280 , we find that for fixed @xmath267 , the probability that @xmath281 is at most @xmath282 therefore , a final union bound over the @xmath283 choices for @xmath267 completes the proof .",
    "@xmath71    the previous result will help us cover vertices in @xmath251 with @xmath99-paths .",
    "however , the objective of this section is to cover all vertices of @xmath4 .",
    "although the analogue of lemma [ lem : dist5 ] does not hold for @xmath4 , it is still possible to prove that @xmath4 is sparsely connected to the rest of the graph .",
    "recall from that @xmath284 .",
    "[ lem : few - nbr - s ] with respect to edges of @xmath99 , every vertex @xmath118 is adjacent to at most @xmath285 vertices in @xmath4 * whp*. ( this applies whether or not @xmath118 itself is in @xmath4 . )    * proof . *",
    "fix a vertex @xmath118 .",
    "let @xmath241 be the set obtained by constructing the analogous sequences to @xmath286 , @xmath287 , @xmath288 , @xmath289 ,   on the graph induced by @xmath10 \\setminus \\{v\\}$ ] , where @xmath290 are defined as in  , but the @xmath237 are obtained by adding vertices with at least 3 ( not 4 ) @xmath116-out - neighbors in @xmath238 .",
    "clearly , @xmath241 contains @xmath291 , because the effect of ignoring @xmath118 is compensated for by using 3 instead of 4 .",
    "the advantage of using @xmath241 instead of @xmath4 is that @xmath241 can be generated without exposing any edges incident to @xmath118 .",
    "as we will take a final union bound over the @xmath20 choices of @xmath118 , it therefore suffices to show that with probability @xmath134 , the particular vertex @xmath118 has at most @xmath285 neighbors in @xmath241 .    for this",
    ", we expose all edges of @xmath292 that are spanned by @xmath10 \\setminus \\{v\\}$ ] .",
    "recall that our proof of lemma [ lem2 ] already absorbed vertices with 3 out - neighbors ( instead of 4 ) , so we have @xmath293 with probability @xmath134 .",
    "it remains to control the number of edges between @xmath118 and @xmath241 , so we now expose all edges of @xmath294 .",
    "the @xmath99-edges there appear independently with probability @xmath266 as defined in , so the probability that at least @xmath285 edges appear is at most @xmath295 }    & \\leq    \\binom { n^{1-\\g}}{2/\\g }    { \\left(\\frac{1.01 \\log n}{n}\\right)}^{2/\\g } \\\\    \\nonumber & \\leq    \\left (      \\frac{e \\cdot n^{1-\\g}}{2/\\g }      \\cdot      \\frac{1.01 \\log n}{n }    \\right)^{2/\\g } \\\\",
    "\\nonumber & <    \\left (      \\frac{2 \\g \\log n}{n^\\g }    \\right)^{2/\\g } \\\\    & <    \\frac{(2 \\log n)^{2 \\log \\log n}}{n^2 }    =    o(n^{-1 } ) .",
    "\\label{ineq : few - nbr - s}\\end{aligned}\\ ] ] taking a final union bound over all initial choices for @xmath118 completes the proof .",
    "@xmath71    we will cover each vertex @xmath249 with a @xmath99-path by joining two @xmath99-paths of length up to to 2 , each originating from @xmath118 .",
    "it is therefore convenient to extend the previous result by one further iteration .",
    "[ cor : few - dist2-s ] with respect to edges of @xmath99 , every vertex @xmath118 is within distance two of at most @xmath296 vertices in @xmath4 * whp*. ( this applies whether or not @xmath118 itself is in @xmath4 . )    * proof .",
    "* fix a vertex @xmath118 .",
    "construct @xmath241 in the same way as in the proof of lemma [ lem : few - nbr - s ] , exposing only edges spanned by @xmath10 \\setminus \\{v\\}$ ] . using only those exposed edges ,",
    "let @xmath297 \\setminus \\{v\\}$ ] be the set of all vertices in @xmath241 or adjacent to @xmath241 via edges from @xmath99 . by lemma [ lem : max - degree ] ,",
    "the maximum degree of @xmath298 is at most @xmath205 with probability @xmath134 , so @xmath299 .",
    "a similar calculation to then shows that with probability @xmath134 , @xmath118 has at most @xmath285 neighbors in @xmath300 .",
    "taking a union bound over all @xmath118 , and combining this with lemma [ lem : few - nbr - s ] , we conclude that * whp * , every vertex has at most @xmath285 neighbors in @xmath301 , and each of them has at most @xmath285 neighbors in @xmath4 .",
    "this implies the result .",
    "@xmath71    we are now ready to start covering the vertices of @xmath4 with disjoint rainbow @xmath99-paths .",
    "the most delicate vertices are those in @xmath251 , because by definition all other vertices already have @xmath99-degree at least @xmath302 . naturally , we take care of @xmath251 first .",
    "[ lem : cover - s00 ] the colored graph @xmath99 contains a rainbow collection @xmath303 of disjoint paths that cover @xmath304 * whp*.    * proof .",
    "* we condition on the high - probability events in lemmas [ lem : s00 ] , [ lem : dist5 ] , and [ lem : few - nbr - s ] , and use a greedy algorithm to cover each @xmath305 with a path of length 2 , 3 , or 4 .",
    "recall that @xmath256 , where @xmath266 was specified in .",
    "we can bound @xmath266 by @xmath306 since equation ensures that @xmath78 , and our conditions on theorem [ th1 ] force @xmath307 , the minimum degree in @xmath99 is at least two * whp*. condition on this as well .    now consider a vertex @xmath305 , and let @xmath308 and @xmath309 be two of its neighbors .",
    "if both @xmath279 are already outside @xmath4 , then we use @xmath310 to cover @xmath118 .",
    "otherwise , suppose that @xmath308 is still in @xmath4 .",
    "since we conditioned on vertices in @xmath251 being separated by distances of at least 5 ( lemma [ lem : dist5 ] ) , @xmath308 can not be in @xmath251 , so it has at least @xmath302 @xmath99-neighbors",
    ". these can not all be in @xmath4 , because we conditioned on the fact that every vertex has fewer than @xmath311 neighbors in @xmath4 ( lemma [ lem : few - nbr - s ] ) .",
    "so , we can pick one , say @xmath312 , such that @xmath313 is a path from outside @xmath4 to @xmath118 .",
    "a similar argument allows us to continue the path from @xmath118 to a vertex outside @xmath4 in at most two steps .",
    "therefore , there is a collection of paths of length 24 covering each vertex in @xmath314 .",
    "they are all disjoint , since we conditioned on vertices of @xmath251 being separated by distances of at least 5 .    at this point , we have exposed all @xmath99-edges spanned by @xmath4 and its neighbors , but the only thing we have revealed about their colors is that they are all in @xmath141 .",
    "now expose the precise colors on all edges of these paths .",
    "since we conditioned on @xmath255 ( lemma [ lem : s00 ] ) , the total number of edges involved is at most @xmath315 .",
    "the number of colors in @xmath141 is @xmath316 , so by a simple union bound the probability that some pair of edges receives the same color in @xmath141 is at most @xmath317 therefore , the covering paths form a rainbow set * whp * , as desired .",
    "we have now covered the most dangerous vertices of @xmath4 .",
    "the remainder of this section provides our argument which covers all other vertices in @xmath4 .",
    "* proof of lemma [ lem3 ] .",
    "* condition on the high - probability events of lemmas [ lem2 ] , [ lem : few - nbr - s ] , [ lem : cover - s00 ] , and corollary [ cor : few - dist2-s ] .",
    "we have already covered all vertices in @xmath304 with disjoint rainbow paths of lengths up to four ( lemma [ lem : cover - s00 ] ) .",
    "we cover the rest of the vertices in @xmath318 with paths of length two , using a simple iterative greedy algorithm . indeed",
    ", suppose that we are to cover a given vertex @xmath319 .",
    "since it is not in @xmath251 , it has @xmath99-degree at least @xmath320 , and at most @xmath285 of these neighbors can be within @xmath4 ( lemma [ lem : few - nbr - s ] ) .",
    "furthermore , we can show that at most @xmath321 of @xmath118 s neighbors outside @xmath4 can already have been used by covering paths .",
    "indeed , for each neighbor @xmath322 of @xmath118 which was used by a previous covering path , we could identify a vertex @xmath323 adjacent to @xmath263 which was part of that covering path .",
    "importantly , @xmath324 is within distance two of @xmath118 , so the collection of all @xmath324 obtainable in this way is of size at most @xmath325 , as we conditioned on corollary [ cor : few - dist2-s ] .",
    "since every covering path uses exactly two vertices outside @xmath4 , the total number of such @xmath263 is at most @xmath321 . putting everything together ,",
    "we conclude that the number of usable @xmath99-edges emanating from @xmath118 is at least @xmath326 expose the colors ( necessarily from @xmath141 ) which appear on these @xmath99-edges . of the total of @xmath327 available , we only need to avoid at most @xmath328 which have already been used on previous covering paths . since we conditioned on @xmath329 ( lemma [ lem2 ] ) , this is at most @xmath330 colors to avoid .",
    "we only need to have two new colors to appear among this collection in order to add a new rainbow path of length two covering @xmath118 . taking another union bound ,",
    "we find that the probability that at most one new color appears is at most @xmath331 here , the first factor of @xmath332 corresponds to the number of ways to choose the new color to add ( or none at all ) . since we only run our algorithm for @xmath333 iterations ( once per vertex in @xmath334 )",
    ", we conclude that * whp *  we can cover all vertices of @xmath4 with disjoint rainbow @xmath99-paths .",
    "@xmath71      in this section , we construct a rainbow @xmath99-path which contains most of the vertices of the graph , but avoids all covering paths from the previous section . in order to carefully track the independence and exposure of edges , recall from section [ sec : d - to - g ] that @xmath99 is deterministically constructed from the random directed graphs @xmath88 , @xmath89 , and @xmath90 .",
    "let us consider the generation of the @xmath84 to be as follows .",
    "the probability that the directed edge @xmath335 appears in @xmath104 is @xmath336 , so we expose each @xmath104-out - degree @xmath337 by independently sampling from the @xmath338 distribution .",
    "importantly , we do not reveal the locations of the out - neighbors .",
    "similarly , for @xmath129 and @xmath130 , we expose all out - degrees @xmath339 and @xmath340 , each sampled from the appropriate binomial distribution . by lemma [ lem : max - degree ] ,",
    "all @xmath341 * whp * ; we condition on this",
    ".    note that from this information , we can later fully generate ( say ) @xmath104 and @xmath88 as follows . at each vertex @xmath118 , we independently choose @xmath337 out - neighbors uniformly at random .",
    "this will determine all @xmath104-edges .",
    "next , for every edge which is not part of @xmath104 , independently sample it to be part of @xmath342 with probability @xmath343 .",
    "this will determine all @xmath88 edges , and a similar system will determine all edges of @xmath89 and @xmath90 .",
    "returning to the situation where only the @xmath117 have been exposed , we then construct the @xmath344 by collecting all vertices whose @xmath117 are too small , and build the sequence @xmath345 . in each iteration of that process",
    ", we go over all vertices which are not yet in the current @xmath127 . at each @xmath118",
    ", we expose all @xmath116-edges incident to @xmath127 . for this section",
    ", we will only care about the @xmath129-out - edges from @xmath346 ( initially counted by @xmath339 ) that are _ not _ consumed in this process .",
    "fortunately , at each exposure stage , there is a clear distribution on the number of these out - edges that are consumed toward @xmath127 , and this will only affect the number , not the location , of the out - edges which are not consumed .",
    "therefore , after this procedure terminates , we will have a final set @xmath4 , and the set of revealed ( directed ) edges is precisely those edges spanned by @xmath4 , together with all those between @xmath4 and @xmath347 \\setminus s$ ] .",
    "this set of revealed edges is exactly what is required to construct the covering paths @xmath348 in lemma [ lem3 ] .",
    "within @xmath349 , the precise locations of the edges are not yet revealed . instead",
    ", for each vertex @xmath350 , there is now a number @xmath351 , corresponding to the number of @xmath129-out - edges from @xmath118 to vertices outside @xmath4 .",
    "we now make two crucial observations .",
    "first , the distributions of where these endpoints lie are still independent and uniform over @xmath349 .",
    "second , every @xmath352 and @xmath353 , because if there were 4 out - edges from @xmath118 to @xmath4 , then @xmath118 should have been absorbed into @xmath4 during the process .",
    "this abundance of independence makes it easy to analyze a simple method for finding a long path , based on a greedy algorithm with backtracking .",
    "( this procedure is similar to that used in @xcite by fernandez de la vega . ) indeed , the most straightforward attempt would be to start building a path , and at each iteration expose the out - edges of the final endpoint , as well as their colors .",
    "if there is an option which keeps the path rainbow , we would follow that edge , and repeat . if not , then we should backtrack to the latest vertex in the path which still has an option for extension .",
    "we formalize this in the following algorithm .",
    "particularly dangerous vertices will be coded by the color red ( not related to the colors of the edges in the @xmath9 ) .",
    "let @xmath354 be the set of all vertices which are not involved in the covering paths @xmath138 .",
    "we will find a long @xmath99-path within @xmath355 which avoids all of the covering paths .",
    "* algorithm . *    1 .",
    "initially , let all vertices of @xmath355 be uncolored , and select an arbitrary vertex @xmath356 to use as the initial path @xmath357 .",
    "let @xmath358 .",
    "this is the set of `` untouched '' vertices .",
    "let @xmath359 .",
    "this will count the `` red '' vertices .",
    "now suppose we are at time @xmath360 . if @xmath361{\\log n}}$ ] , terminate the algorithm .",
    "if the final endpoint @xmath118 of @xmath362 is not red , then expose the first @xmath363 of @xmath118 s @xmath129-out - neighbors . if none of them lies in @xmath364 , via an edge color not yet used by @xmath362 or any of the covering paths @xmath138 , then color @xmath118 red , setting @xmath365 , @xmath366 , and @xmath367 .",
    "+ otherwise , arbitrarily choose one of the suitable out - neighbors @xmath368 . set @xmath369 .",
    "expose whether @xmath370 , @xmath371 , or @xmath372 .",
    "if none of those three directed edges are present , then add @xmath263 to the path , setting @xmath373 and @xmath374 .",
    "otherwise , color both @xmath118 and @xmath263 red , and set @xmath375 and @xmath376 .",
    "4 .   if the final endpoint @xmath118 of @xmath362 is red , then expose the second @xmath363 of @xmath118 s @xmath129-out - neighbors .",
    "first suppose that none of them lies in @xmath364 , via an edge color not yet used by @xmath362 or any of the covering paths @xmath138 . in this case",
    ", find the last vertex @xmath377 of @xmath362 which is not red , color it red , and make it the new terminus of the path .",
    "that is , set @xmath365 , let @xmath378 be @xmath362 up to @xmath377 , and set @xmath379 .",
    "if @xmath377 did not exist ( i.e. , all vertices of @xmath362 were already red ) , then instead let @xmath377 be an arbitrary vertex of @xmath364 and restart the path , setting @xmath380 , @xmath381 , @xmath382 .",
    "+ on the other hand , if @xmath118 has a suitable out - neighbor @xmath383 , then set @xmath369 .",
    "expose whether @xmath384 , @xmath371 , or @xmath385 .",
    "if none of those three directed edges are present , then add @xmath263 to the path , setting @xmath373 and @xmath381 .",
    "otherwise , color @xmath263 red , find the last vertex @xmath377 of @xmath362 which is not red , and follow the remainder of the first paragraph of this step .",
    "the key observation is that the final path @xmath386 contains every non - red vertex which lies in @xmath387 . since lemmas [ lem2 ] and [ lem3 ]",
    "imply that @xmath388 , and we run until @xmath389{\\log n}}$ ] , lemma [ lem4 ] therefore follows from the following bound .",
    "[ lem : algo - red - whp ] the final number of red vertices is at most @xmath390{\\log n}}$ ] * whp*.    * proof . *",
    "the color red is applied in only two situations .",
    "the first is when we expose whether any of @xmath370 , @xmath371 , or @xmath385 hold . to expose whether @xmath370 , we reveal whether @xmath391 , using the previously exposed value of @xmath392 , which we already conditioned on being at most @xmath205 . since @xmath118",
    "s @xmath104-out - neighbors are uniform , the probability that @xmath393 is at most @xmath394 . if it is not in @xmath104 , the probability that it is in @xmath395 is bounded by @xmath396 by the description at the beginning of section [ sec : long - path ] .",
    "the analysis for the other two cases are similar , so a union bound gives that the chance that any of @xmath397 , @xmath371 , or @xmath385 hold is at most @xmath398 .",
    "note that this occurs at most @xmath20 times , because each instance reduces the size of @xmath364 by 1 .",
    "hence the expected number of red vertices of this type is at most @xmath399 , which is of much smaller order than @xmath400{\\log n})}$ ] .",
    "the other situation in which red is applied comes immediately after the failed exposure of some @xmath401 @xmath129-out - neighbors , in either of steps 3 or 4 .",
    "failure means that all @xmath7 of them either fell outside @xmath364 , or had edge colors already used in @xmath362 or some covering path @xmath138 .",
    "step 2 controls @xmath402{\\log n}}$ ] , and the total number of colors used in @xmath362 or any covering path @xmath138 is at most latexmath:[$n -    that because of our order of exposure , there is a set @xmath300 of size at most @xmath404 such that @xmath118 s @xmath129-out - neighbors are uniformly distributed over @xmath405 .",
    "this is because we have exposed whether @xmath87 was a @xmath129-edge , for the predecessor @xmath170 of @xmath118 along @xmath362 , and we may also have already exposed the first half of @xmath118 s @xmath129-out - neighbors in a prior round , which could consume up to @xmath406 vertices .",
    "therefore , the chance that a given out - neighbor exposure is successful ( i.e. , lands inside @xmath364 , via one of the @xmath407 unused colors ) , is at least @xmath408{\\log n } }      \\cdot      \\frac{1}{(1-o(1))n }    \\right )    \\cdot    \\left (      \\frac{n}{2 \\sqrt[3]{\\log n } }      \\cdot      \\frac{1}{(1 + \\th_2)n }    \\right )    >    \\frac{1}{5 ( \\log n)^{2/3}}.\\ ] ] we conclude that the chance that all @xmath409 fail is at most @xmath410{\\log n } } .\\ ] ] since we will not perform this experiment more than twice for each of the @xmath20 vertices , linearity of expectation and markov s inequality imply that * whp * , the final total number of red vertices is at most @xmath411{\\log n}}$ ] , as desired .",
    "@xmath71      at this point , we have a rainbow @xmath99-path @xmath139 of length @xmath412{\\log n}}$ ] , which is disjoint from the paths @xmath138 which cover @xmath4 .",
    "recall from and that we defined @xmath413{\\log n}$ ] .",
    "split @xmath139 into @xmath414 segments of length @xmath172 , as in figure [ fig : path - ab ] .",
    "if @xmath415 is not divisible by @xmath172 , we may discard the remainder of @xmath139 , because @xmath416{\\log n}$ ] .",
    "partition the @xmath417 endpoints into two sets @xmath418 so that each segment has one endpoint in each set , but there are no vertices @xmath419 and @xmath420 which are consecutive along @xmath139 . by possibly discarding the final interval ( which will only cost an additional @xmath416{\\log n}$ ] ) , we may ensure that the initial and final endpoints are both in @xmath421 .",
    ", divided into consecutive intervals of length @xmath172 .",
    "endpoints of successive intervals are adjacent via original edges of @xmath139 .",
    "the set of interval endpoints has been partitioned into @xmath418 .",
    "note that endpoints which are adjacent via an edge of @xmath139 are always assigned to the same set . ]",
    "the reason for our unusual partition is as follows . in our construction",
    "thus far , we already needed to expose the locations of some @xmath88-edges , since they had priority over the @xmath89 . in certain locations",
    ", we have revealed that there are no @xmath88-edges . in particular , between every consecutive pair of vertices @xmath422 on the path @xmath139",
    ", we found a @xmath129-edge , and confirmed the absence of any @xmath88-edges .",
    "fortunately , our construction did not expose any @xmath88-edges between non - consecutive vertices of the path @xmath139 .",
    "in particular , if we now wished , for any vertex @xmath419 , we could expose the number @xmath423 of its @xmath104-out - neighbors that lie in @xmath424 ; then , the distribution of these @xmath423 out - neighbors would be uniform over @xmath424 .",
    "this uniformity is crucial , and would not hold , for example , if some vertex of @xmath424 were consecutive with @xmath425 along @xmath139 .",
    "the proof of lemma [ lem5 ] breaks into the following steps . recall that @xmath426 denotes the number of @xmath104-edges from a vertex @xmath118 to a subset @xmath300 of vertices .",
    "say that @xmath118 is _ @xmath300-good _",
    "if @xmath427 ; call it _",
    "_ otherwise .",
    ": :    for every vertex @xmath428 , expose the value    of @xmath429 .",
    "we show that * whp * , the initial and    final endpoints of @xmath139 are @xmath424-good , and at    most @xmath430 vertices of @xmath139 are @xmath424-bad .",
    ": :    absorb all remaining vertices and covering paths into the system of    segments , using @xmath100-edges that are aligned with    @xmath424-good vertices .",
    "( see figure [ fig : path - absorb ] . )",
    "this    removes some segment endpoints , while adding other new endpoints .",
    "let    @xmath431 be the new partition of endpoints .",
    "crucially , @xmath432 , while @xmath433    by losing up to @xmath434{\\log n}}$ ] vertices ,    and then adding back the same number . importantly , every new vertex in    @xmath435 will be @xmath424-good .",
    ": :    the system of segments can be grouped into several blocks of    consecutive segments , in the sense that between successive segments in    the same block , there is an original edge of @xmath139 .",
    "( see    figure [ fig : path - strings ] . ) also , the initial and final endpoints of    each block are always of type @xmath144 , and are all    @xmath424-good . step 4 .",
    ": :    for every vertex @xmath436 , expose the value of    @xmath437 .",
    "we show that * whp * , at most    @xmath430 vertices of @xmath438 are @xmath439-bad .",
    ": :    for each consecutive pair of segments along the same block ( from step    3 ) which has either an @xmath439-endpoint which is    @xmath424-bad or a @xmath438-endpoint which is    @xmath439-bad , merge them , together with a neighboring segment    in order to maintain parity between @xmath144 s and    @xmath154 s .",
    "( see figure [ fig : path - merge ] . )",
    "let    @xmath440 be the final partition of segment endpoints    after the merging .",
    "we show that * whp * , all @xmath441    have @xmath442 , and all    @xmath443 have    @xmath444 .",
    "furthermore , if we were to expose the @xmath104-edges between    @xmath445 and @xmath446 , then each vertex    @xmath441 would independently sample    @xmath447 uniformly random neighbors in    @xmath446 , and similarly for @xmath443 .",
    "this will complete the proof because the final number of segments is @xmath448 .",
    "is absorbed into the system of intervals using @xmath100-edges .",
    "note that the resulting endpoint partition still has one @xmath144-endpoint and one @xmath154-endpoint in every interval .",
    "importantly , the direction of the splicing is such that all new endpoints are of type-@xmath144 , as indicated by the @xmath439-vertices .",
    "this is why we continue the new interval rightward , through to the next @xmath154-endpoint . ]    .",
    "the vertical gray path from @xmath324 to @xmath449 represents the absorption of a new vertex into the collection of segments , involving two different blocks .",
    "this operation cuts the two edges between @xmath450 and their adjacent @xmath439-vertices , and adds back the @xmath139-edge marked by the asterisk .",
    "afterward , the segments can be re - partitioned into new blocks ( see the gray dotted lines ) , with all initial and final endpoints in each block of type-@xmath144 , and @xmath424-good . ]     are used to merge consecutive intervals in the same block , so that a bad endpoint can be eliminated . ]      by construction , @xmath451 . now consider an arbitrary vertex @xmath428 .",
    "we have only exposed the numeric value of @xmath392 thus far in our construction , and not where the @xmath104-out - neighbors are .",
    "so let us now expose the numeric value of @xmath429 , but again , not precisely where the out - endpoints are . as we observed in the beginning of section [ sec : long - path ]",
    ", we have @xmath452 .",
    "our work in the previous section consumes up to one @xmath104-out - edge at each vertex @xmath453 , when we reveal whether @xmath370 in the third step of the algorithm .",
    "therefore , @xmath429 stochastically dominates @xmath454 .",
    "hence we can use lemma [ lem : bin9 ] to bound that the probability that @xmath455 is too small .",
    "@xmath456 }    & <    e^{-0.533 \\cdot \\frac{1}{l } \\cdot \\frac{\\e_1 \\th_1}{20 } \\log n } \\\\    { \\mathbb{p}\\left [   d_1^+(v ; b_1 ) <",
    "\\frac{\\e_1 \\th_1}{180 l } \\log n   \\right ] }    & =    o ( e^{-\\frac{\\e_1 \\th_1}{40 l } \\log n } ) \\\\    & =    o ( e^{-\\sqrt{\\log n } } ) , \\end{aligned}\\ ] ] since @xmath457 and @xmath416{\\log n}$ ] . the expected number of such vertices in @xmath139 is at most @xmath20 times this probability . applying markov s inequality",
    ", we conclude that * whp * , the number of @xmath424-bad vertices in @xmath139 is at most @xmath458 .",
    "this also shows that the initial and final endpoints of @xmath139 are @xmath424-good * whp*.      at this point , our entire vertex set is partitioned as follows .",
    "we have a collection of rainbow intervals @xmath150 , each of length exactly @xmath172 .",
    "these already consume at least @xmath459{\\log n}}$ ] vertices .",
    "since we discarded the remainder of @xmath139 , as well as possibly the final interval , we have @xmath460{\\log n } } \\big ) - 2 $ ] . a separate collection of rainbow paths @xmath348",
    "covers all vertices of @xmath4 .",
    "there are also some remaining vertices . in this section",
    ", we will use @xmath100-edges to absorb the latter two classes into the rainbow intervals .    since we will not use any further @xmath99-edges , but edges from @xmath89 take precedence over those from @xmath130",
    ", we also now expose all edges in @xmath89 .",
    "lemma [ lem : max - degree ] ensures that * whp * , no vertex is incident to more than @xmath205 edges of @xmath89 .",
    "condition on this outcome .",
    "note that by construction , we have not exposed the locations of any @xmath90-edges between vertices outside @xmath4 , although vertices outside @xmath4 may have up to three exposed @xmath130-neighbors located in @xmath4 .",
    "we now use a simple greedy algorithm to absorb all residual paths and vertices into our collection of intervals . in each step",
    ", we find a pair of @xmath100-edges linking either a new @xmath138 or a new vertex to two distinct intervals @xmath461 and @xmath462 , using two new colors from @xmath463 .",
    "we will ensure that throughout the process , all intervals @xmath464 used in this way are separated by at least one full interval @xmath465 along @xmath139 .",
    "the specific procedure is as follows .",
    "suppose we have already linked in @xmath360 paths or vertices , and are considering the next path or vertex to link in .",
    "suppose it is a path @xmath138 ( the vertex case can be treated in an analogous way ) .",
    "let @xmath422 be the endpoints of @xmath138 .",
    "we need to find vertices @xmath466 in distinct intervals @xmath461 and @xmath462 such that ( i ) according to @xmath139 , @xmath461 and @xmath462 are separated by at least one full interval from each other , and from all @xmath465 previously used in this stage , ( ii ) @xmath324 and @xmath449 are separated from the endpoints of @xmath461 and @xmath462 by at least two edges of @xmath139 , and ( iii ) if @xmath467 is the vertex adjacent to @xmath324 in the direction of the @xmath424-endpoint of @xmath461 , and @xmath468 is the vertex adjacent to @xmath449 in the direction of the @xmath424-endpoint of @xmath462 , then both @xmath469 and @xmath470 are @xmath424-good .",
    "we choose the direction of the @xmath424-endpoint because @xmath469 and @xmath470 will become the new @xmath439-endpoints of shortened intervals ; see figure [ fig : path - absorb ] for an illustration .",
    "so , let @xmath471 be the set of vertices in the intervals which fail properties ( ii ) or ( iii ) .",
    "by step 1 , the dominant term arises from the endpoints because @xmath472{\\log n } } < \\frac{n}{l}$ ] , so @xmath473 .",
    "also let @xmath300 be the set of vertices contained in intervals that are at least one full interval away from any intervals which have previously been touched by this algorithm .",
    "since we observed at the beginning of this section that the total number of intervals was at least @xmath474{\\log",
    "n } } \\big ) - 2 $ ] , we have @xmath475{\\log n } } \\right ) - 2 - 3\\cdot ( 2 t )    \\right ) l    \\geq",
    "n - \\frac{8ln}{\\sqrt[3]{\\log n } }    \\geq    n - \\frac{8n}{l},\\ ] ] since @xmath476{\\log n}}$ ] and @xmath416{\\log n}$ ] .",
    "let us now find a newly - colored @xmath100-edge from @xmath170 to a vertex of @xmath477 .",
    "note that the number of vertices outside @xmath478 is at most @xmath479 .",
    "we have not yet exposed the specific locations of the @xmath130-neighbors of @xmath170 , but only know ( since @xmath480 ) that @xmath481 , and up to three of those @xmath130-out - neighbors lie within @xmath4 .",
    "consider what happens when we expose the location @xmath263 of one of @xmath170 s @xmath130-out - neighbors which is outside @xmath4 .",
    "this will produce a useful @xmath100-edge @xmath482 if ( i ) @xmath263 lands in @xmath483 , ( ii ) neither @xmath484 or @xmath485 appeared in @xmath88 or @xmath89 , ( iii ) @xmath485 does not appear in @xmath90 , and ( iv ) the color of the edge is new .",
    "let us bound the probability that @xmath263 fails any of these properties .",
    "we may consider ( i)-(iii ) together , since we showed that at most @xmath479 vertices were outside @xmath483 , and we conditioned on @xmath170 being incident to at most @xmath205 edges of @xmath89 .",
    "after sampling the location of @xmath263 , we expose whether @xmath484 or @xmath485 appear in @xmath88 ; by the same argument as used in lemma [ lem : algo - red - whp ] , the probability of each is at most @xmath486 .",
    "so , the probability of failing either ( i ) or ( ii ) is at most @xmath487 .",
    "we conditioned at the beginning of section [ sec : long - path ] on @xmath488 , so when we expose whether @xmath485 is in @xmath90 , we again fail only with probability at most @xmath489 .",
    "finally , when we expose the color of the new edge , we know that it will be in @xmath463 , so the probability that it is a previously used color is at most @xmath490{\\log",
    "n } }   \\cdot \\frac{1}{\\th_3 n }    =    \\frac{2}{\\th_3 \\sqrt[3]{\\log n } }    =    o \\left ( \\frac{1}{l } \\right).\\ ] ] therefore , the probability that all of the @xmath491 @xmath130-out - edges of @xmath170 fail is at most @xmath492 where we used the definition of @xmath172 in for the final bound . a similar calculation works for @xmath118 , and for the separate case when we incorporate a new vertex into the intervals .",
    "therefore , taking a union bound over the @xmath333 iterations in linking vertices and paths , we conclude that our procedure completes successfully * whp*. @xmath71      step 1 established that * whp * , the initial and final vertices of the long path @xmath139 are both @xmath424-good , so the original system of segments can be arranged as a single block , with successive intervals linked by edges of @xmath139 .",
    "we now prove by induction that after the absorption of each path or vertex in step 2 , the collection of segments can be re - partitioned into blocks of segments , such that within each block , consecutive segments have their endpoints linked via @xmath139 , and the initial and final endpoints in each block are of type-@xmath144 , and @xmath424-good",
    ".    there are two cases , depending on whether the absorption involves two segments in the same block ( as in figure [ fig : path - absorb ] ) , or in different blocks ( as in figure [ fig : path - strings ] ) .",
    "if the segments are in the same block , then we can easily divide that block into two blocks satisfying the condition . indeed , in figure [ fig : path - absorb ] , one of the new blocks is the string of segments between the vertices indicated by @xmath439 in the diagram , and the other new block is the complement .",
    "this works because within each of the two new blocks , every edge between successive segments was an edge between successive segments of the original block , hence in @xmath139 .",
    "also , of the four initial / final endpoints among the two new blocks , two of them were the initial / final endpoints of the original block , and the other two were identified as @xmath424-good vertices , now in @xmath439 . therefore , the new block partition satisfies the requirements .    on the other hand ,",
    "if the absorption involves two segments from different blocks , then one can re - partition the two blocks into three new blocks , as illustrated in figure [ fig : path - strings ] . a similar analysis to above then completes the argument .",
    "we have not yet revealed anything about the @xmath104-out - neighbors of any vertices in @xmath432 ; the only thing we know is that they had @xmath493 . for each vertex @xmath494 , let us now expose the numeric value of @xmath437 , but again , not precisely where the out - endpoints are . since our absorption procedure maintained @xmath495 ,",
    "the same argument that we used for step 1 now establishes step 4 .      by steps 1 and 4",
    ", the total number of merges which occur in step 5 is at most @xmath496 . since @xmath497 and @xmath498 , for every @xmath441 we can independently sample @xmath447 using only the value of @xmath499 . indeed , since @xmath441 was @xmath424-good , it had @xmath500 .",
    "we will only have @xmath501 if at least @xmath502 of those out - neighbors land in @xmath503 as opposed to @xmath446 .",
    "let @xmath504 note that @xmath505 }    & \\leq    \\binom { \\frac{\\e_1 \\th_1}{180 l } \\log n } { \\frac{\\e_1 \\th_1}{1800 l } \\log n }    q^{\\frac{\\e_1 \\th_1}{1800 l } \\log n } \\\\    & \\leq    \\left (      10eq    \\right)^{\\frac{\\e_1 \\th_1}{1800 l } \\log n } \\\\    & =    e^{- ( 1-o(1 ) ) \\sqrt{\\log n } \\cdot \\frac{\\e_1 \\th_1}{1800 l } \\log n } \\\\    & <    e^{- \\omega \\left ( ( \\log n)^{4/3 } / \\log \\log n \\right ) } \\\\    & =    o(n^{-1}).\\end{aligned}\\ ] ] therefore , a final union bound establishes that * whp * , every @xmath506 has @xmath507 .",
    "a similar argument establishes the bound for @xmath508 , for @xmath509 , because we had @xmath498 , and had only previously exposed the value of @xmath437 .",
    "the last claim in step 5 is clear from our order of exposure .      in this final stage of the proof",
    ", we use @xmath98 to link together the endpoints of the system of segments @xmath150 created by lemma [ lem5 ] .",
    "as described in the overview ( section [ sec : main - steps ] ) , we construct an auxiliary directed graph @xmath161 .",
    "importantly , no @xmath88-edges have been revealed between the endpoint sets @xmath144 and @xmath154 , so we may now specify a model for the random @xmath510-vertex digraph @xmath161 .    indeed , consider a vertex @xmath511 , @xmath512 , and let @xmath513 be the @xmath144- and @xmath154-endpoints of the corresponding interval @xmath163 .",
    "we first generate a set @xmath514 of @xmath161-edges by sending exactly @xmath160 directed edges out of @xmath162 , and exactly @xmath159 directed edges in to @xmath162 .",
    "this is analogous to the @xmath168-in , @xmath168-out model , except that not all degrees are equal .",
    "some directed edges will be generated twice ; let @xmath515 be that subset , but keep only one copy in @xmath514 .",
    "color every edge of @xmath514 independently from @xmath106 .",
    "finally , generate a random subset @xmath516 by independently sampling each edge of @xmath517 with probability @xmath518 .",
    "let @xmath519 be the final edge set of @xmath161 .",
    "the reason for the removal of @xmath520 is that some of the initially - generated edges of @xmath161 will find conflicts once @xmath88 is generated .",
    "indeed , every edge @xmath521 that we have placed in @xmath161 corresponds to an edge @xmath522 or @xmath523 ( or both ) , for some @xmath524 , @xmath155 .",
    "when both do not occur , and only @xmath522 ( say ) , then we need to expose whether @xmath525 ; if it is in @xmath342 , it removes @xmath521 from @xmath161 with probability @xmath91 .    to simplify notation , let @xmath526 and @xmath527 be the numbers of out- and in - edges that are generated at @xmath162 to build the initial edge set @xmath514 .",
    "they correspond to @xmath160 and @xmath159 above , and have therefore been revealed by our previous exposures .",
    "importantly , we have the bounds @xmath528    it is more convenient to restrict our attention to a smaller subset @xmath529 which is itself already rainbow ; then , every ordinary directed hamilton cycle will automatically be rainbow .",
    "for this , we expose at every vertex @xmath162 what the colors of the @xmath526 out - edges and @xmath527 in - edges will be , but not their locations .",
    "[ lem : select-3-colors ] suppose that @xmath530 for all @xmath512 .",
    "then * whp * , it is possible to select 3 out - edges and 3 in - edges from each @xmath162 so that all @xmath531 selected colors are distinct .",
    "* proof . * construct an auxiliary bipartite graph @xmath60 with vertex partition @xmath532 , where @xmath533 .",
    "place an edge between @xmath534 and @xmath535",
    "if one of @xmath162 s @xmath526 out - edges has color @xmath535 . edges between @xmath536 and @xmath535 are defined with respect to @xmath162 s in - edge colors .",
    "the desired result is a perfect 1-to-3 matching in @xmath60 . for this , we apply the 1-to-3 version of hall s theorem : we must show that for every @xmath537 , we have @xmath538 , where @xmath539 is the union of the @xmath60-neighborhoods of all vertices of @xmath540 .",
    "this follows from a standard union bound .",
    "indeed , fix an integer @xmath541 , and consider an arbitrary pair of subsets @xmath542 and @xmath543 , with @xmath544 and @xmath545 . the probability that @xmath546 ( in @xmath60 ) is at most @xmath547^x    \\ , .\\ ] ]",
    "the innermost term is the probability that a random color from @xmath106 is in @xmath548 .",
    "the exponents come from the fact that each vertex of @xmath549 samples at least @xmath550 colors for its out- and in - neighbors .    multiplying this bound by the number of ways",
    "there are to select @xmath540 and @xmath548 , and using @xmath551 , we find that the probability of failure for a fixed @xmath324 is at most @xmath552^x    & \\leq    { \\left(\\frac{2er}{x}\\right)}^x    { \\left(\\frac{\\th_1 n}{3x}\\right)}^{3x }    \\left [      { \\left(\\frac{3x}{\\th_1 n}\\right)}^{\\frac{\\e_1 \\th_1}{200 l } \\log n }    \\right]^x \\\\    & =    \\left [      { \\left(\\frac{2en}{lx}\\right ) }      { \\left(\\frac{\\th_1 n}{3x}\\right)}^3      { \\left(\\frac{3x}{\\th_1 n}\\right)}^{\\frac{\\e_1 \\th_1}{200",
    "l } \\log n }    \\right]^x    \\ , .\\end{aligned}\\ ] ] we will sum this over all @xmath553 . the outer exponent allows us to bound this by a decreasing geometric series , so it suffices to show that the interior of the square bracket is uniformly @xmath554 for all @xmath553 .",
    "indeed , observe that the exponent of @xmath324 inside the bracket is @xmath555 , so it is maximized at @xmath556 .",
    "yet @xmath557 since ensures that @xmath558 , we have @xmath559 .",
    "yet the exponent @xmath560 tends to infinity as @xmath20 grows , so we indeed obtain a uniform upper bound of @xmath554 for all @xmath561 .",
    "therefore , * whp * , every subset @xmath562 has @xmath563 , and the 1-to-3 version of hall s theorem establishes the desired result . @xmath71    recall from the beginning of this section that the final edge set of @xmath161 is @xmath519 . let @xmath564 be the set of @xmath531 edges selected by lemma [ lem : select-3-colors ] .",
    "this corresponds to a copy of @xmath565 .",
    "unfortunately , in our model we still need to expose the locations of the remaining @xmath566 remaining in- and out - edges at every vertex @xmath162 .",
    "it is possible that an edge of @xmath564 may be generated again in this stage . that edge would then have @xmath91 probability of receiving the color of the new copy , which would not be in our specially constructed rainbow set . to account for this ,",
    "let @xmath567 be the set of edges generated by exposing these remaining in- and out - edges , so that @xmath568 .",
    "it suffices to find a directed hamilton cycle in @xmath569 .",
    "it is not convenient to work directly with @xmath567 or @xmath520 , because they depend on the result of @xmath564 .",
    "let @xmath570 be the random directed graph @xmath571 defined by sampling each edge with probability @xmath572 , and generated independently of @xmath564 .",
    "fortunately , we can control @xmath570 instead .",
    "[ lem : coupling ] there is a coupling of the probability space such that @xmath573 * whp*.    * proof . *",
    "the set @xmath520 is a random subset of @xmath574 obtained by independently sampling each edge with a probability of at most @xmath396 , so it is clearly contained in a copy of @xmath575 that is generated independently of @xmath564 .",
    "next , although @xmath567 is exposed after @xmath564 , it is still contained in a copy of @xmath576 that is generated independently of @xmath564 . indeed , at a vertex @xmath162",
    ", we generate @xmath567 by exposing @xmath566 new out- and in - edges , but @xmath577 .",
    "we observe a standard coupling which realizes @xmath578 as a subgraph of @xmath579 * whp*. for this , consider the following system for generating a random directed graph . for",
    "every ordered pair of vertices @xmath580 , generate two independent bernoulli random variables @xmath581 and @xmath582 , each with probability parameter @xmath583 .",
    "create the directed edge @xmath86 , if and only if at least one of @xmath581 or @xmath584 took the value 1 .",
    "this is clearly contained in @xmath571 . for each vertex @xmath170 ,",
    "let @xmath585 be the number of other vertices @xmath118 for which @xmath586 , and let @xmath587 be the number of @xmath588 .",
    "these are all distributed as @xmath589 .",
    "lemma [ lem : bin9 ] establishes that for fixed @xmath170 , the probability that @xmath590 is at most @xmath591 , and similarly for @xmath587 .",
    "therefore , a union bound establishes that * whp * , all @xmath592 .",
    "conditioning on the values of @xmath585 and @xmath587 , we see that when the indicators are revealed , this indeed contains @xmath576 .",
    "the result then follows by recalling that @xmath593 , and taking the union of @xmath594 with another independent @xmath575 to cover @xmath520 .",
    "@xmath71    we are now ready to finish the final lemma in our proof of theorem [ th1 ] .",
    "* proof of lemma [ lem3 ] .",
    "* we have established that it suffices to find an ordinary directed hamilton cycle in @xmath595 , without regard to color .",
    "conveniently , @xmath570 is now independent of @xmath596 .",
    "this independence allows us to first expose how many of the 3-in , 3-out edges at each vertex will be in @xmath570 , and then only expose the locations of those that are not in @xmath570 . at each vertex @xmath170 , the probability that more than one of the 6 in- or out - edges is in @xmath570 is at most @xmath597 so a union bound establishes that * whp * , @xmath598 contains a copy of @xmath171 .",
    "this is known to be hamiltonian * whp *  by theorem [ thm:2-in-2-out ] from section [ sec : main - steps ] , so our proof is complete .",
    "our main contribution , part ( b ) of theorem [ th1 ] , sharpens the earlier result of cooper and frieze @xcite to achieve optimal first - order asymptotics . as we mentioned in the introduction , we suspect that our result can be further sharpened within the @xmath554 term",
    ". we do not push to optimize our bounds on @xmath146 because it is not clear that incremental improvements upon our current approach will be sufficiently interesting .",
    "instead , we would be more interested in determining whether one can extend the celebrated `` hitting time '' result of bollobs @xcite , which states that one can typically find a hamilton cycle in the random graph process as soon as the minimum degree reaches two .",
    "consider the edge - colored random graph process in which @xmath599 is a random permutation of the edges of @xmath6 .",
    "the graph @xmath600 is defined as @xmath601,{\\left\\ { e_1,e_2,\\ldots , e_m \\right\\}})$ ] .",
    "let each edge receive a random color from a set @xmath602 of size at least @xmath20 . then",
    "* whp * , the first time that a rainbow hamilton cycle appears is precisely the same as the first time that the minimum degree of @xmath600 is at least two * and * at least @xmath20 colors have appeared .",
    "although this may be out of reach at the moment , another natural challenge is to settle the problem in either the case when the number of edges is just sufficient for an ordinary hamilton cycle , or in the case when the number of colors is , say , exactly @xmath20 .",
    "part ( a ) of our theorem answered the latter question when @xmath20 was even .",
    "we believe that it is probably also true when @xmath20 is odd",
    ". it would be nice to prove that extension , either directly or by reducing the divisibility condition in theorem [ th : loose-3 ] ."
  ],
  "abstract_text": [
    "<S> one of the most famous results in the theory of random graphs establishes that the threshold for hamiltonicity in the erds - rnyi random graph @xmath0 is around @xmath1 . </S>",
    "<S> much research has been done to extend this to increasingly challenging random structures . in particular , a recent result by frieze determined the asymptotic threshold for a loose hamilton cycle in the random 3-uniform hypergraph by connecting 3-uniform hypergraphs to edge - colored graphs .    in this work </S>",
    "<S> , we consider that setting of edge - colored graphs , and prove a result which achieves the best possible first order constant . </S>",
    "<S> specifically , when the edges of @xmath0 are randomly colored from a set of @xmath2 colors , with @xmath3 , we show that one can almost always find a hamilton cycle which has the further property that all edges are distinctly colored ( rainbow ) . </S>"
  ]
}