{
  "article_text": [
    "the time it takes to a random walker to go from a starting site to a target site , the so called first - passage time ( fpt ) , is an especially important quantity that underlies a wide range of physical processes@xcite . indeed",
    ", numerous real situations , such as diffusion limited reactions @xcite or animals searching for food @xcite , can be rephrased as first - passage problems . in all these situations ,",
    "the fpt is a limiting factor . as a consequence , it is crucial to determine how this quantity depends on the parameters of the problem .    among these parameters ,",
    "geometrical factors turn out to be determining .",
    "for example , the mean first - passage time ( mfpt ) between a starting site and a target site for a 2d random walker is infinite if the walk is not bounded . on the contrary",
    ", it becomes finite as soon as the walk is confined .",
    "but how does the mfpt depend on the confining surface ?",
    "in fact , the answer to this general question appears as a difficult task , because explicit determinations of fpt are most of the time limited to very artificial geometries , such as 1d and spherically symmetric problems @xcite .",
    "however , in most of the real situations , the searcher performs a random walk in more general confining geometries .",
    "this is for example the case in biology , where biomolecules often follow a complicated series of transformations , which are located at precise parts of the cell . determining the influence of the shape of the cell on the fpt actually appears as a first step in the understanding of the global kinetics of the process .",
    "this question of determining first passage properties in general confined geometries has raised a growing attention ( see for example @xcite ) .",
    "two important results have notably been obtained .",
    "first , in the case of discrete random walks , an expression for the mean first passage time ( mfpt ) between two nodes of a general network has been found @xcite .",
    "however , no quantitative estimation of the mfpt was derived in this paper .",
    "second , the leading behavior of mfpt of a continuous brownian motion at a small absorbing window of a general reflecting bounded domain has been given @xcite .",
    "these studies have even been extended to a situation with a deep potential well , leading to a generalization of the kramers formula @xcite . in the case when this window is a small sphere within the domain , the behavior of mfpt has also been derived @xcite . this result is rigorous , but does not give access to the dependence of the mfpt with the starting site .",
    "very recently @xcite , we have proposed a novel approach which allowed us to propose accurate estimations of first passage times of _ discrete _ random walks in confined geometry .",
    "preliminary results concerning a continuous brownian motion have also been announced .",
    "the main purpose of this paper is to provide a detailed analysis of this _ continuous _ case , relevant to many real physical situations . in addition , we extend our previous work in several directions , for both discrete and continuous cases : the complete distribution of fpts is obtained ; extra quantities , as conditional mfpt in the case of several targets or mean exit times by a small aperture of a general reflecting bounded domain , are derived .",
    "the paper is structured as follows . in sec .",
    "[ discret ] , we first present the computation method of fpts in the case of random walks on discrete lattices .",
    "this study includes the obtention of the mfpt , a comprehensive derivation of the expression of the higher order moments as well as the complete distribution of the fpt , whose physical meaning is extensively analysed .",
    "the situation with two competitive targets is also studied , and we compute mfpt , splitting probabilities , and conditional mfpt .    in sec .",
    "[ continu ] , we extend all these results to the case of a continuous brownian motion , and detail the specific difficulties encountered in this case .    the explicit results obtained in secs .",
    "[ discret ] and [ continu ] involve pseudo - green functions of a laplace type operator , with given boundary conditions .",
    "the appendix [ approximations ] is devoted to the evaluation of these pseudo - green functions . for several domain shapes ,",
    "an exact formula can be obtained , which gives , for the quantities computed in the article , exact explicit expressions in the discrete case , or accurate approximations in the continuous case .",
    "for other domain shapes , basic approximations are proposed .",
    "these results are briefly summarized in sec .",
    "[ discussion ] , with a discussion of the important parameters to take into account and of the qualitative behavior of the mfpt",
    "let us consider a point performing a random walk on an arbitrary bounded lattice with reflecting boundaries .",
    "we want to compute the mfpt @xmath0 of the random walker at target site @xmath1 , starting from a site @xmath2 at time @xmath3 .",
    "we summarized this computation in a previous article @xcite .",
    "however , since it is the basis of all the developments explained in this article , we found useful to give it here in full detail , with the addition of several necessary precisions .    our method is based on a formula given by kac @xcite , concerning irreducible graphs , such that any point can be reached from any other point .",
    "an irreducible graph admits a unique stationary probability @xmath4 to be at site @xmath5 ( physically , this is the probability for a particle which has been in the domain for a long time to be at site @xmath5 . if the transition probabilities are symmetric this stationary probability is uniform . ) .",
    "we consider random walks starting from an arbitrary point of a subset @xmath6 of the lattice , chosen with probability @xmath7 , where @xmath8 .",
    "then , kac s formula asserts that the mean number of steps needed to return to any point of @xmath6 , i.e. the mean first - return time ( mfrt ) to @xmath6 is @xmath9 . a simple proof of this result and of its extension to higher - order moments , which will be used later on , is given in appendix [ annkac ] .",
    "kac s formula can be used to derive the mfpt @xmath0 by slightly modifying the original lattice ( see fig.[astuce ] ) : we suppress all the original links starting from the target site @xmath1 , and add a new one - way link from @xmath1 to the starting point @xmath2 , whereas all other links are unchanged . in this new lattice ,",
    "any trajectory starting from @xmath1 goes to @xmath2 at its first step , so that the mfrt to @xmath1 is just the mfpt from @xmath2 to @xmath1 in the former lattice , plus one .",
    "an exact , formal expression for the mfpt can thus be derived for the most general finite graph .",
    "consider @xmath10 points at positions @xmath11 in an arbitrary space .",
    "the transition rates from point @xmath12 to point @xmath13 are denoted @xmath14 .",
    "if we assume that one transition takes place during each time unit we have : @xmath15 let @xmath16 be the position of the target site , @xmath17 be the position of the starting site , and @xmath4 be the stationary probability of the modified lattice .",
    "we write @xmath18 . according to kac s formula",
    ", the mfrt to @xmath1 on the modified graph is @xmath19 , so that the mfpt from @xmath2 to @xmath1 in the original graph is @xmath20 .",
    "all we need to find is the stationary probability @xmath21 .",
    "it satisfies the following equation : @xmath22 where @xmath23 is the kronecker symbol . to solve this equation",
    ", we define the auxiliary function @xmath24 , such that @xmath25 .",
    "it satisfies : @xmath26 so that @xmath24 has the following expression : @xmath27 where @xmath28 is the stationary probability of the original lattice , and @xmath29 is the discrete pseudo - green function @xcite , which satisfies the two following equations : @xmath30 @xmath31 where @xmath32 is independent of @xmath12 .",
    "moreover , if @xmath14 is symmetric , which will be the case in all the practical cases considered , @xmath29 will also be symmetric in its arguments . the pseudo - green function can be seen as a generalization of the usual infinite - space green function to a bounded domain .",
    "indeed , eq . ( [ pseudogreen ] ) without the @xmath33 term corresponds to the definition of the infinite - space green function , which would not have any solution for a finite domain with reflecting boundary conditions : it is necessary in this case to compensate the source term @xmath34 , and the simplest way to do so is to add the @xmath33 term . the properties of this function are further discussed in appendix [ anngreen ] .",
    "we can thus see that the solution ( [ valpip ] ) satisfies equation ( [ eqpip ] ) , and ensures that @xmath21 is normalized .",
    "the condition @xmath35 allows us to compute @xmath36 and to deduce the following exact expression : @xmath37\\ ] ] if @xmath14 is symmetric , and we will consider that this is the case in the rest of the paper , we simply have @xmath38 , and we get the simpler formula : @xmath39 \\label{randwalk}\\ ] ]    this result may be obtained by an alternative and complementary approach .",
    "we consider that in the domain there is a constant flux @xmath36 of particles per time unit entering the domain at the source point @xmath2 .",
    "the particles are absorbed when they reach the target , and , since all particles are eventually absorbed , we have an outcoming flux @xmath36 at the target . the average number of particles in the domain satisfies : @xmath40 , which will allow the determination of @xmath0 .",
    "indeed , the average density of particles @xmath41 satisfies the following equation : @xmath42 the three terms of the equation correspond respectively to the diffusion of particles , the incoming flux in @xmath2 , and the outgoing flux in @xmath1 .",
    "this is exactly the same equation as eq.([eqpip ] ) , with the same condition @xmath43 , and thus admits a similar solution , with the difference that the total number of particles in the domain is not fixed a priori .",
    "the solution is thus : @xmath44 which gives , with the condition @xmath43 and the relation @xmath45 , the same result as before for the mean first - passage time , namely eq.([randwalk ] ) .",
    "this formula is equivalent to the one given in @xcite , but is expressed in terms of pseudo - green functions .",
    "one advantage of the present method is that it may be easily extended to more complex situations , as it will be shown .",
    "another advantage is that , although the pseudo - green function @xmath29 is not known in general , it is well suited for approximations when the graph is a bounded regular lattice .",
    "the simplest one in this case is to approximate the pseudo - green function by its infinite - space limit , the `` usual '' green function : @xmath46 , which satisfies : @xmath47 where @xmath48 is the ensemble of neighbours of @xmath5 , and @xmath49 the coordination number of the lattice .",
    "the value of @xmath50 and the asymptotic behaviour of @xmath51 are well - known @xcite .",
    "for instance , for the 3d cubic lattice , we have : @xmath52 and @xmath53 for @xmath54 large . for the 2d square lattice",
    ", we have @xmath55 , where @xmath56 is the euler gamma constant , and @xmath57 . these estimations of @xmath51",
    "are used for all the practical applications in the following . in some cases ( especially in three dimensions when the target is far from any boundary ) , approximating @xmath29 by @xmath51 will give accurate results ( see fig .",
    "[ distst ] ) .",
    "the small correction is due to boundary effects , which are further discussed in section [ discussion ] . in other cases",
    "it will only give an order of magnitude . in the case of a rectangular or parallepipedic domain an exact expression of @xmath29",
    "is known @xcite , and the fpt from any point to any other point in the domain can be computed exactly . this exact result and simple approximations , which can be used in other cases ,",
    "are given in appendix [ approximations ] .",
    "another situation that may arise and can easily be dealt with is the case of an absorbing opening in a ( locally ) flat reflecting boundary of a bounded domain : we are interested in the mean time a particle takes to exit from the domain , if it may only exit by this opening .",
    "( see fig .",
    "[ ouverture ] ) .",
    "we only consider regular lattices of dimension @xmath58 or @xmath59 .",
    "we can define a target site , just behind the flat boundary .",
    "the problem here is that the pseudo - green function for the domain plus the target site is difficult to compute , whereas the pseudo - green function near a flat boundary can be easily evaluated , and is even known exactly if the domain is rectangular or parallepipedic . to solve this problem",
    ", we will call the site next to the target the approach site @xmath60 .",
    "we indeed have to go through this approach site in order to reach the target site .",
    "we will call @xmath61 the average time to reach the target site , starting from the source ; @xmath62 the average time to reach the approach site , still starting from the source ; @xmath63 the average time to return to the approach site , assuming the random walk does not go to the target site after exiting the approach site ; @xmath64 the average time to reach the target site , starting from the approach site .",
    "we have the following equations : @xmath65 since the random walk has to go through the approach site , and @xmath66 once the random walker is at the approach site , it may either go directly to the target site ( probability @xmath67 , where @xmath68 is the dimension of the lattice ) or go another way , in which case it has to go back to the approach site before finding the target site .",
    "thus , @xmath69 to compute @xmath70 , we have to remember that , if the boundary was fully reflecting , we would have the average return time : it is given by kac s formula , and is @xmath10 .",
    "we then have , with arguments similar to eq . [ eqat ] : @xmath71 we then have : @xmath72 and thus : @xmath73 as for the average time needed to reach the approach site , starting from the starting site , it is exactly the same as in the case where the boundary is totally reflecting : @xmath74,\\ ] ] and finally : @xmath75,\\ ] ]    to evaluate @xmath29 , we have to take into account the effect of the boundary . since the boundary is flat , the simplest way to check the boundary condition is to write @xmath76 , where @xmath77 is the point symmetrical to @xmath5 with respect to the boundary .",
    "we will use this approximation in the following , ( cf .",
    "appendix [ approximations ] for a discussion of this approximation ) we note @xmath78 the green function for the sites surrounding the origin , and notice that @xmath1 is symmetrical to @xmath60 with respect to the boundary .",
    "the mean exit time is then : @xmath79\\ ] ]      moreover , we are able to evaluate the higher - order moments and distribution of the fpt in the 3d case , provided the domain is not too elongated , i.e. the typical distance between a point and a boundary is @xmath80 .",
    "the computation of the moments is detailed in appendix [ computationdiscret ] .",
    "however , we can not compute the higher - order moments and distribution of the fpt in two dimensions , or with a too elongated 3d domain .",
    "the computational reasons behind this are explained in appendix [ computationdiscret ] , but we will also explain it later from a physical point of view .",
    "we obtain the following result for higher - order moments : @xmath81 ,   \\label{eqmoments}\\ ] ] where @xmath32 is defined by eq .",
    "( [ hbar ] )    to check these results , we computed the moments with a numerical simulation ( cf .",
    "appendix [ simulations ] for the simulation method ) , and found ( see fig.[moments ] ) a good agreement with the theoretical estimation ( [ eqmoments ] ) , where @xmath29 is approximated by @xmath51 , and @xmath32 is approximated by is its value for a spherical domain , computed in the continuous limit , @xmath82 ( cf .",
    "( [ valuehbar ] ) for the computation ) .    the study of the distribution in the limit of large @xmath10 will enable us to go even further .",
    "indeed , if we neglect the corrections in @xmath83 in eq .",
    "( [ eqmoments ] ) , the moments of @xmath84 are those of the following probability density @xmath85 : @xmath86 the large-@xmath10 limit of this probability density is rigorous ( since the corrections to the moments vanish ) . in this limit",
    ", @xmath87 tends to @xmath50 ; @xmath32 tends to @xmath3 .",
    "thus , the probability density of @xmath88 tends to the following probability density , the relative position of @xmath13 and @xmath1 being fixed : @xmath89    these results have been confronted to numerical simulations ( fig.[distrib2 ] ) .",
    "we computed the exact distribution for several domain sizes , and may notice that the curve divides in two at short times .",
    "this is due to the fact that , at short times , the parity of the step is important : as long as the walk does not touch the boundary , the distance between the starting point and the walker has the same parity as the time elapsed .",
    "the time needed for the two curves to collapse into one shows very well the time needed to erase the memory of the starting position .",
    "the curves before this time correspond to the dirac part of the probability density ( [ probdist ] ) ; however , we can see that , once the two curves have collapsed , the resulting curves fit very well the theoretical prediction ( [ probdist ] ) , which is indeed more accurate than the limit probability density ( [ problimit ] ) .    to analyse the physical meaning of this result",
    ", we may first notice that , if the probability density ( [ probdist ] ) is averaged on the starting point , the dirac part of the density vanishes , and we simply have an exponential distribution of the first - passage time .",
    "this property sheds a new light on the quasi - chemical approximation @xcite , which assumes that if a particle starts randomly in a volume , and may only exit through a small hole , it has a constant probability to exit at each time step .",
    "this approximation leads to an exponential distribution of the exit times . if we consider that the target site is the exit point for a particle , then the exit time is exactly the fpt .",
    "thus , we have an evaluation of the accuracy of the quasi - chemical approximation ( or at least of its moments ) in this case .",
    "the interpretation of the probability density ( [ probdist ] ) is the following : the first part of the density , which decays exponentially , corresponds to the decay of the probability distribution of the fpt if the particle starts randomly in the set of points .",
    "the second part corresponds to a particle reaching the target in a time negligible with respect to @xmath10 .",
    "here we must remember that a free 3d walk is transient : the particle may never reach the target in infinite space .",
    "thus , one can interpret the dirac term as the probability to reach the target _ without touching the boundaries_. for @xmath10 large enough it is equivalent to the probability to reach the target at all in infinite space . and , for this kind of trajectory , the probability distribution of the fpt does not depend of @xmath10 , and , thus , the probability density of @xmath88 will tend to @xmath90 for large @xmath10 . on the other hand ,",
    "if the particle _ does _ reach the boundary ( it happens after a typical time @xmath91 , since the boundaries are at a typical distance @xmath80 , and the typical time needed to cross a distance @xmath54 is @xmath92 ) , its position will become random in a time negligible with respect to @xmath10 , and , thus , the probability density of @xmath88 will be the same as if the particle started in a random position in this latter case .",
    "this argument fails for an elongated domain , which can be seen as a physical reason why we are not able to compute the fpt distribution in this case .",
    "we can check that the probability to reach the origin for a random walk in infinite space is indeed @xmath93 @xcite .    here",
    "we can see an important physical difference between the 2d and 3d cases : in two dimensions the random walk is recurrent .",
    "we can thus conclude that the large-@xmath10 limit probability density of @xmath88 will be a simple delta function , since , in the limit of infinite space , the particle almost certainly reaches the target in a finite time , even if the mfpt is infinite ! however , the probability distribution for @xmath94 @xmath10 will be much more difficult to compute : indeed , there will also be two regimes , of low @xmath88 , when the particles have not touched the boundary and thus the distribution is the same as in free space ; and the regime of high @xmath88 , where the distribution decays exponentially ( since the system has lost the memory of its starting point ) .",
    "the transition between the two regimes happens at a finite @xmath88 ( since the time needed to reach the boundaries is of order @xmath10 ) .",
    "thus , the low @xmath88 regime will have a much stronger influence on the values of the moments than on the @xmath95 case , which may explain why the computation of the moments and distribution is much more delicate in this case .",
    "we can see in fig .",
    "[ distrib2d ] typical probability distributions for different domain sizes .",
    "one can very well see that the transition between the two regimes takes place at a finite @xmath88 no matter the size of the domain , and that the long - time regime indeed corresponds to an exponential decay .",
    "we can now assume that the lattice contains not one but two target points @xmath96 and @xmath97 .",
    "the problems that may arise in this case are the mean time needed to reach one of the two targets , which we will call _ mean absorption time _ and note @xmath98 , and the _ splitting probabilities _",
    ", i.e. the probabilities @xmath99 to reach @xmath96 before @xmath97 and @xmath100 to reach @xmath97 before @xmath96 .",
    "this model corresponds to the case of a diffusing particle which may be absorbed either by the target @xmath96 or the target @xmath97 .",
    "we can also , even if it will be less straightforward , study the _ conditional _ mean absorption time , i.e. the mean absorption time @xmath101 ( resp .",
    "@xmath102 ) , for particles which are absorbed by the target @xmath96 ( resp .",
    "@xmath97 ) .",
    "this is relevant in many chemical applications @xcite , and may be useful in biology to determine to which extent cellular variability may be controlled by diffusion @xcite .    to compute these quantities , it is more convenient to use the alternative approach presented on page : we consider a constant incoming flux of particles @xmath36 , and we have an average outcoming flux of particles @xmath103 in @xmath96 , and @xmath104 in @xmath97 . since all particles are eventually absorbed , @xmath105 .",
    "the probability to reach the target @xmath13 is then @xmath106 .",
    "the total number of particles @xmath107 in the domain satisfies @xmath108 , and the mean density of particles satisfies the following equation : @xmath109 we then get : @xmath110 then , writing @xmath111 , we get the following set of equations : @xmath112 where @xmath113 and , for @xmath114 or @xmath115 , @xmath116 , @xmath117 . from this set of equation we can deduce @xmath99 , @xmath100 and @xmath118 .",
    "we thus get exact expressions for the mean absorption time and the splitting probabilities , respectively : @xmath119 @xmath120    this result can be extended if necessary to more than two targets ; if there are @xmath121 targets , we have @xmath122 unknown variables ( @xmath123 and the @xmath121 probabilities @xmath124 ) , with @xmath122 equations , namely @xmath125 and the @xmath121 equations @xmath126 , which is enough to determine all the unknown variables .",
    "however , this may quickly become computationally expensive for a large number of targets .",
    "we compared the two - target results to simulations ( fig . [ 2 t ] ) .",
    "note that if we use the exact value for @xmath29 , which we can compute for a cube ( cf .",
    "appendix [ approximations ] ) , it is indeed impossible to see a difference between the theoretical predictions and the simulations .",
    "it is interesting to underline an important qualitative difference between the 2d and 3d cases . in 3d",
    ", the furthest target always has a significant probability to be reached first , since the most important terms in the probabilities @xmath127 are @xmath128 and @xmath129 . in 2d , if a target is much closer from the source than the other , it will almost certainly be reached first , since @xmath130 scales as @xmath131 .",
    "actually , the probability for the furthest target to be reached first decreases logarithmically .",
    "these properties are related to the transient character of the infinite 3d walk , and the recurrent character of the 2d walk : indeed , an infinite 2d walk explores all the sites of the lattice , whereas an infinite 3d walk does not ; we may thus consider that the 2d walk will explore most of the sites surrounding the source before going much further , whereas the 3d walk will not , which qualitatively explains the difference of behaviour .    we can also determine the conditional absorption times @xmath132 and @xmath133 .",
    "for this , we will compute @xmath134 , the average number of particles in the domain which will eventually be absorbed by @xmath135 .",
    "we have @xmath136 , which will allow us to compute @xmath137 . to compute @xmath134",
    ", we can simply notice that the density of particles that will eventually be absorbed by @xmath135 at the point @xmath13 is simply @xmath138 , where @xmath139 is the probability to be absorbed by @xmath135 if the walk starts from @xmath13 .",
    "we thus have : @xmath140 this equation is exact but may prove quite difficult to compute , especially in two dimensions if @xmath29 is not known exactly .",
    "however , in three dimensions , we may use the same kind of approximations as for the computation of the high - order moments of the fpt ( with the same limitations , i.e. the 3d domain should not be too elongated ) to estimate the conditional probabilities .",
    "if we note @xmath141 and @xmath142 , we have : @xmath143 we use the properties @xmath144 ( cf .",
    "( [ hbar ] ) ) and @xmath145 ( cf .",
    "eq . [ scaling ] ) to write : @xmath146 and we can conclude : @xmath147 the expression for @xmath133 is of course equivalent .",
    "this expression is not exact , but is very accurate : the relative difference between the numerical simulations ( see fig.[time2 t ] ) and the expression ( [ condtimes ] ) is of about @xmath148 , for a domain of size @xmath149 .",
    "finally , we have a wide range of quantities which can be computed exactly , or with a very good accuracy , provided we know the pseudo - green function @xmath29 .",
    "unfortunately , there are only a few cases in which it can be computed exactly .",
    "otherwise , we will have to use approximations , which , of course , give less accurate results . both exact results and approximations",
    "are detailed in appendix [ approximations ] .",
    "we may consider a similar problem in a continuous medium ( see fig .",
    "[ schemabrown ] ) : if we have a brownian motion whose diffusion coefficient is @xmath150 , how much time does it take to reach a target ?",
    "a difference with the discrete case is that the target has a finite size @xmath151 which is an important parameter of the problem .",
    "we will consider a spherical target @xmath1 , of radius @xmath151 , centered in @xmath16 .",
    "the brownian motion starts from the starting point @xmath2 ( its position is denoted by @xmath17 ) .",
    "it is restricted to a domain @xmath152 of volume @xmath153 ( for @xmath154 domains we will call the area @xmath60 ) , and we note @xmath155 the domain deprived of the target .",
    "we will derive the same quantities as in the discrete case , but the results are this time only approximate ; we can thus add some refinements to the method , in order to increase the accuracy .",
    "these refinements are given in appendix [ refinements ] , and are used in practical computations of the mfpt in appendix [ approximations ] when the target is close to a boundary .",
    "it should be emphasised that , in the cases where the pseudo - green function is known , such as the case of a spherical domain , the method gives accurate explicit expressions for all the mfpt and the other quantities studied here .",
    "the mean first passage time ( mfpt ) @xmath156 at the target satisfies the following equations @xcite : @xmath157 @xmath158 @xmath159 where @xmath160 ( resp .",
    "@xmath161 ) stands for the surface of the absorbing target sphere ( resp . the reflecting confining surface ) and @xmath162 denotes the normal derivative .",
    "the boundaries have to be regular enough ( twice continuously differentiable is sufficient , but not necessary ) for these definitions to make sense .",
    "to solve this problem , we introduce the following green function @xmath163 defined by @xmath164 @xmath165 @xmath166 note that this green function may also be seen as the stationary density of particles if there is an unit incoming flux of particles in @xmath167 , and the diffusion coefficient is set to @xmath168 .",
    "it should not be confused with the free green function @xmath51 , and is rather the continuous equivalent of the average density of particles @xmath169 defined in eq .",
    "( [ alternative ] ) with @xmath170 .",
    "it depends implicitly on the target position through eq .",
    "( [ g2 ] ) .",
    "using green s formula , @xmath171 we easily find that the mfpt is given by @xmath172    to approximate @xmath173 we can use a direct transposition to the continuous case of eq .",
    "( [ rhodiscret ] ) : @xmath174 where @xmath123 is defined by @xmath175 if @xmath176 and @xmath177 is the pseudo - green function @xcite , which satisfies : @xmath178 @xmath179 @xmath180 @xmath181 @xmath32 being independent of @xmath5 . this latter equation can be easily deduced from the three previous ones .",
    "the choice ( [ gapprox ] ) of @xmath163 is the simplest one which satisfies formally eqs ( [ g1 ] ) and ( [ g3 ] ) .",
    "however , ( [ g2 ] ) can only be approximately satisfied . to take into account this latter equation",
    ", we will approximate , on the target sphere , @xmath182 by @xmath183 and @xmath184 by @xmath185 , where @xmath51 is the well - known free green function ( @xmath186 in 2d , @xmath187 in 3d ) , and @xmath188 is defined by : @xmath189 note that @xmath190 has no singularity in @xmath16",
    ". thus on the surface of the target sphere we have : @xmath191 where @xmath192 is the value of @xmath193 when @xmath194 .",
    "we can now compute @xmath195 since the target is small compared to the domain , the integral over @xmath155 is almost equal to the integral over @xmath152 , the relative order of magnitude of the correction being @xmath196 in 3d and @xmath197 in 2d . using the property ( [ 4 ] )",
    ", we can then compute the integral , and find the result : @xmath198 this equation is very close to ( [ randwalk ] ) , with the correspondence @xmath199 , but one should pay attention to the fact that this is only an approximation !",
    "one may expect deviations from this expression when the variations of @xmath182 or @xmath190 will not be negligible over the target sphere ; it corresponds to the cases when the target is either near the source or near a boundary .",
    "however , if we compare the expression obtained with simulations ( see fig.[ctpos2d ] ) when the target is near the source , we see no such deviation ; this is justified in appendix [ refinements ] . on the other hand , there is indeed a deviation near the boundaries .",
    "this deviation scales as @xmath200 in two dimensions , or @xmath201 in three dimensions , where @xmath68 is the distance between the target and the boundary .",
    "it is possible to compute a correction , which is explicited in appendix [ refinements ] , and used in practical applications in appendix [ approximations ] .",
    "the exact value of @xmath29 is known analytically for disks and spheres @xcite , we will detail this in appendix [ approximations ] .",
    "this is why we will test the expressions we obtain in such geometries . if no exact expression is known , the simplest approximation of @xmath29 is simply @xmath202 .",
    "more accurate approximations are also discussed in appendix [ approximations ] .",
    "we give the estimations of @xmath203 with the basic approximation , to show the order of magnitude : @xmath204 @xmath205 @xmath206 being the source - target distance .",
    "this already improves the ( exact ) asymptotic results of pinsky @xcite , which only give the leading term in @xmath151 .",
    "the higher - order moments and density of the fpt in the three - dimensional case can also be computed .",
    "the computation is detailed in appendix [ computationcontinu ] ; the results are quite similar to the results obtained in the discrete case , and the physical interpretation is essentially the same .",
    "the results obtained are the following :    @xmath207\\ ] ]    we may also deduce from this information about the probability density of the absorption time @xmath208 : if we drop the term @xmath209 , we have : @xmath210 in the limit @xmath211 , with the position of @xmath17 fixed , the @xmath29 terms are constant since they only depend on the shape of the domain , and @xmath192 tends towards infinity .",
    "the probability density then simply becomes exponential : @xmath212 in the limit @xmath211 , with the quantity @xmath213 fixed , @xmath214 , and the probability density becomes : @xmath215    we did not test these results with a numerical simulation , since the continuous simulation method ( see appendix [ simulations ] ) is not adapted to the computation of the fpt density , and would require a large computation time to give accurate results . furthermore , the approximations made ( cf .",
    "appendix [ computation ] ) are the same as on the discrete case , and the discrete results have been successfully compared to an exact numerical simulation ( cf .",
    "[ distrib2 ] ) .      for the case of two targets , we will compute the same quantities as in the discrete case ; however , we may notice that the radius @xmath216 and @xmath217 of the two targets may differ , which adds another parameter to the problem . with two targets",
    ", we will use the same green function as before , but @xmath218 will be the reunion of the surfaces of the two absorbing target spheres . the mean absorption time @xmath203 satisfies the equation ( [ texpl ] ) ; the splitting probability @xmath219 satisfies the following equations @xcite : @xmath220",
    "@xmath221 @xmath222 @xmath223 using green s formula , we get : @xmath224 the expression for @xmath100 is of course similar .",
    "note that the normal derivative is oriented towards the inside of the target .",
    "a simple approximation of @xmath225 , equivalent to the discrete eq . ( [ 2trho ] ) is : @xmath226 this expression satisfies eq.([g1]),([g3 ] ) and ( [ expp1 ] ) , and @xmath123 , @xmath99 and @xmath100 are set in order to satisfy eq.([g2 ] ) approximately .",
    "we use the same approximations as in the one - target case , which gives the following set of equations : @xmath227 where @xmath113 and , for @xmath114 or @xmath115 , @xmath116 , @xmath228 .",
    "these equations are exactly identical to the discrete equations , only the meaning of the @xmath229 changes .",
    "we thus can deduce , using the same relation between @xmath123 and @xmath0 as in eq .",
    "( [ simplebrownian ] ) : @xmath230 @xmath231    we show in fig .",
    "[ c2t2d ] and [ c2t3d ] the results of the numerical simulations .",
    "we can see that they are accurate , with a small correction ( the relative correction scales as @xmath232 in 2d or @xmath233 in 3d , @xmath68 being the distance between the two targets ) when the two targets are close ( an explicit correction is given in appendix [ refinements ] ) , and when one target is near a boundary ( exactly as in the one - target case ) .",
    "the curves themselves deserve a few qualitative remarks .",
    "unsurprisingly , the splitting probability @xmath100 is maximal when @xmath97 is the closest to the source .",
    "when the two targets have different sizes , an interesting phenomenon appears ( fig .",
    "[ c2t3d ] ) : the probability to hit the largest target ( @xmath97 ) has a second maximum when it is close to the other target .",
    "one can understand this by a scaling argument .",
    "if the two targets are far away , @xmath99 will be about @xmath234 .",
    "if the two targets touch one another , and @xmath235 , then the target @xmath96 covers a surface @xmath236 of the target @xmath97 .",
    "it can thus be expected that the probability @xmath99 will scale as @xmath237 , and thus be much lower than if the two targets were far away .",
    "these arguments are for the 3d case , but the qualitative behavior would be the same in the 2d case . however , the behavior of the splitting probabilities when one target is much further than the other from the source will be different in 2d and 3d , for the same reasons as in the discrete case . in the figures the domain is not large enough to make the difference obvious .",
    "the mean absorption time has a similar qualitative behavior in both cases : an unsurprising minimum when the moving target is close to the source , maxima when the moving target is near a boundary , due to boundary effects , and a maximum when the two targets are close , which deserves a few more comments .",
    "this could indeed be predicted directly from eq.([tcontinu ] ) , but , physically , this comes from the fact that , if the two targets are close , a particle undergoing a brownian motion , which reaches one target , often would have reached the other shortly afterwards in a single target situation .",
    "thus , the mean time gained , compared to the single target situation , will be much lower when the two targets are close . to analyse the values themselves",
    ", one should keep in mind that the times are normalized by @xmath238 ; the order of magnitude of the normalized times will then be @xmath239 , which explains the values around @xmath240 obtained in the 3d case .",
    "as for the conditional fpts @xmath241 and @xmath242 , we have the following relations @xcite : @xmath243 @xmath244 @xmath245 and of course the equivalent relations for @xmath246 .",
    "we use as usual green s formula , and obtain : @xmath247 this equation is very similar to the discrete eq . ( [ ncondtimes ] ) and the following calculations for the 3d case are exactly identical , and give : @xmath248    we show in fig.[ccondtime ] the result of numerical simulations . the noise is more important than in other simulations , especially for @xmath132 .",
    "this is due to the fact that the probability @xmath99 is often small , which reduces the number of processes on which the time is averaged , and thus increases the noise .",
    "we thus are able to compute first - passage times , splitting probabilities and absorption times with a good accuracy ( especially with the improvements given in appendix [ refinements ] ) , provided we know the pseudo - green function @xmath29 .",
    "the computation of @xmath29 is discussed extensively in appendix [ approximations ] and more briefly in the following .",
    "the computation of the pseudo - green function can be a difficult problem .",
    "indeed , there are a few cases when it can be computed exactly ( see appendix [ exact ] ) , namely in the discrete case for a rectangular / parallepipedic domain or for periodic boundary conditions , and in the continuous case when the domain is a disk , a sphere , or the surface of a sphere .",
    "otherwise , we have to use an approximation , the simplest ones being presented and discussed in appendix [ approximations ] .    in the following",
    "we present a synthetic and qualitative description of the important parameters which have to be taken into account when it comes to computing the mean - first passage time .",
    "the first and most important parameter is the size of the domain .",
    "indeed , the mfpt is proportional to the size of the domain , both in two and three dimensions .",
    "the second essential parameter is the size of the target for the continuous case : once we have these two parameters we already have a rough order of magnitude of the mfpt .",
    "the third important parameter is the distance between the source and the target . in three dimensions",
    "this parameter is important as long as it is of the same order of magnitude as the target size ; its influence is inversely proportional to the source - target distance . in two dimensions",
    "this parameter will be important at any distance , since the mfpt depends logarithmically of this distance .",
    "once these parameter have been taken into account we have a good approximation of the mfpt ( eq .",
    "( [ base2d ] ) and ( [ base3d ] ) ) if both source and target are far from any boundary . to see what _ far _ means in this case ,",
    "a good criterion is that any correction involving a boundary ( see below ) is negligible .",
    "otherwise we have an order of magnitude , and to proceed further we will have to take into account the precise position of the boundaries .    the qualitative effect of the boundary is to increase the mfpt when the target is near a boundary , and to decrease it when the source is near a boundary ( it can be seen in the following equations ) .",
    "the first effect is much more important than the second : in three dimensions , with a flat boundary , a basic approximation gives : @xmath249 where @xmath250 denotes the point symmetrical to @xmath5 with respect to the boundary .",
    "one can see that the influence of the boundary is inversely proportional to the distance between the target and the boundary .",
    "this is also true if the source is near a boundary , which is why the most important parameter is indeed the position of the target .",
    "one may note , however , that if the target or the source lies in a corner , these effects are amplified .    in two dimensions the influence of the position of the boundary is more important , and",
    "the position of the source is a relevant parameter : a basic approximation with a flat boundary gives : @xmath251 if the target is much closer to the boundary than the source the effect can be to double the mfpt ; on the other hand , if the source only is near a boundary , the related correction is bounded .",
    "the corners also have an amplifying effect in two dimensions .",
    "the quantitative estimates thus obtained are generally more accurate in three dimensions than in two dimensions , due to the fact that the effect of the boundaries on the pseudo - green function is essentially local in three dimensions . in two dimensions",
    "there is still room for improvement , but an extensive discussion would be beyond the scope of this article .",
    "in this article we managed to compute the mean first - passage times , the splitting probability and the full probability density of the first - passage time ( in three dimensions ) with a good accuracy for spherical or rectangular domains . for other shapes",
    "( with a regular enough boundary ) , we gave the basic tools to approximately estimate these quantities .",
    "these results are especially important in the analysis of diffusion - limited reactions : the first - passage time corresponds to the reaction time if one of the reactants is static , and the reaction rate is infinite . two promising extensions of our work would be to take into account _",
    "finite _ reaction rates , which would increase the relevance of our work to reaction - diffusion processes ; and to study the same problem with anomalous diffusion , which is relevant in many physical situations .",
    "we gratefully thank jean - marc victor for useful discussions and comments , and sidney redner for suggesting us the discrete simulation method .",
    "32 natexlab#1#1bibnamefont # 1#1bibfnamefont # 1#1citenamefont # 1#1url # 1`#1`urlprefix[2]#2 [ 2][]#2    , _ _ ( , ) .    ,",
    "_ _ ( , ) .    ,",
    "_ _ ( , ) .    , , , , , * * , ( ) .    , * * , ( ) .    , * * , ( ) .    , * * , ( ) .    , * * , ( ) .    , * * , ( ) .    , * * , ( ) .    , * * , ( ) .    , , , , , * * , ( ) .    , , , * * , ( ) .    , * * , ( ) .    , , , ,",
    ", * * , ( ) .    ,",
    "* * , ( ) .",
    ", , , , .    , , , , * * , ( ) .    ,",
    "* * , ( ) .    , * * , ( ) .    , , , * * , ( ) .    , _ _ ( , ) .    , _ _ ( , ) .    ,",
    "_ _ ( , ) .    ,",
    "_ _ ( , ) .    , * * , ( ) .    , , , , ( ) .    ,",
    "_ _ ( , ) .    , .    ,",
    "_ _ ( , ) .    , ,",
    ", , * * , ( ) .    , , , * * , ( ) .",
    "there are two specific cases where the discrete pseudo - green function @xmath29 may be computed exactly : when the domain is rectangular ( parallepipedic in three dimensions ) or when the boundary conditions are periodic @xcite .",
    "these results are interesting in themselves , but , moreover , for a domain which is almost rectangular / parallepipedic , they will give a good approximation for @xmath29 . for periodic boundary conditions .",
    "if we consider a domain with @xmath252 sites in the @xmath253 direction , @xmath254 sites in the @xmath255 direction , and @xmath256 sites in the @xmath257 direction , a straightforward fourier analysis gives : @xmath258 in two dimensions , we have a similar formula for @xmath29 : @xmath259    for a parallepipedic domain we get a slightly more complicated expression , and we have to use semi - integer coordinates for the points : @xmath253(resp . @xmath255 and @xmath257 ) varies between @xmath260 and @xmath252(resp . @xmath254 and @xmath256 ) @xmath261 .",
    "the result is the following : @xmath262 in two dimensions the expression is slightly less imposing : @xmath263    these formulae have the advantage of being exact , which enables us to compute exactly all the quantities studied in this article for such geometries .",
    "however , the computation of @xmath29 may be computationally expensive for large domains . in the continuous case",
    ", the same method can be applied , but @xmath29 can only be expressed as an infinite series@xcite .",
    "we give the result for a @xmath154 rectangle @xmath264 : @xmath265      in the continuous case there is however a case where the pseudo - green function is known exactly : if the domain is a disk or sphere of radius @xmath266",
    ". we will simply give the results ; the detailed computation can be found in @xcite .    in both formulas",
    ", we use the image of @xmath167 , that we note @xmath267 , which is aligned with @xmath5 and the center of the disk / sphere @xmath268 , and at a distance @xmath269 .",
    "we note @xmath270 , @xmath271 , and @xmath272 , @xmath56 being the angle between @xmath5 and @xmath167 . in two dimensions , the result is the following : @xmath273 the first term corresponds to @xmath51 , the second to the image of @xmath167 , the third term is needed to ensure the symmetry of @xmath29 , and the last term corresponds to the @xmath274 term in the definition of the pseudo - green function .",
    "the three - dimensional result is a bit more complicated , with a logarithmic term whose physical signification is unclear : @xmath275 these results are very useful by themselves , but they will also be useful to approximate @xmath29 near a curved boundary , as we will see in the following .",
    "the result for a sphere can also be used to estimate @xmath32 when one uses the approximation @xmath276 in non - elongated 3d domains .",
    "indeed the exact result enables one to take into account the corrections to @xmath51 , which are negligible when the source and the target are close , but give a substantial correction to the value of @xmath32 . to compute @xmath32 , one can use eq .",
    "( [ 4 ] ) , and choose for @xmath5 the centre of the sphere .",
    "we have in this case : @xmath277 a constant @xmath278 has been suppressed , in order to have a final result relevant for the approximation @xmath276 . from this expression of @xmath29",
    "it is straightforward to get an expression for @xmath32 : @xmath279 if one wants to use this result in the discrete case , it should be noted that the continuous limit of the discrete model corresponds to @xmath280 and not @xmath281 .",
    "this diffusion coefficient is included in the discrete pseudo - green function , and the discrete estimation of @xmath32 is thus : @xmath282      another case where we can compute exactly @xmath29 is the case of the surface of a sphere . indeed in this case",
    "we have exactly : @xmath283 since @xmath29 is isotropic in this case it simplifies things : @xmath284 can be replaced by @xmath285 in eq.([simplebrownian ] ) this gives back the result obtained by a straightforward computation of the fpts in a sphere @xcite .",
    "moreover this will give good approximations of all the two - target quantities , which was , to our knowledge , not known until now .",
    "this result is not used elsewhere in the paper , but is however important due to the physical relevance of the diffusion on the surface of a sphere .",
    "the next step is to study cases where no exact formula for @xmath29 is known .",
    "the simplest approximation to @xmath29 is the infinite - space green function @xmath51 , but this approximation in often unsatisfying .",
    "we thus present a few ways to improve it .",
    "before we present them , it must be emphasised that , in general , all the @xmath29 terms should be derived with the same approximation : @xmath29 is defined up to a constant , and this constant depends of the approximation used !",
    "however , for complicated expression involving @xmath29 , this constraint can be relaxed : if the expression can be decomposed into terms of the form @xmath286 , these terms may be computed with different approximations , since they do not depend on the constant up to which @xmath29 is defined .",
    "for example , in the two - target problem , we have @xmath287",
    ". we can use if necessary two approximations , one accurate around @xmath96 , which we note @xmath288 , and another accurate around @xmath97 , which we note @xmath289 . then , to compute @xmath99 , we use them the following way : @xmath290 this trick can be especially useful if one has to deal with two targets near two different boundaries .",
    "the most basic approximation is already known : it is the approximation @xmath202 .",
    "its physical meaning is to ignore the presence of the boundaries , as far as the pseudo - green function is concerned .",
    "to improve this approximation , there are essentially two ways : the first is to take the boundaries into account locally , and to satisfy the boundary conditions at the nearest boundary , we will see how in the following .",
    "the second one is to take the boundaries into account globally , by taking into account the terms @xmath33 or @xmath274 in the definition of @xmath29 .",
    "the order of magnitude of the related correction will be of about @xmath291 in the discrete case , or @xmath292 in the 2d continuous case , @xmath293 in the 3d continuous case .",
    "it is thus much weaker in 3d ( the maximal relative correction scales as @xmath294 or @xmath295 ) than in 2d ( where the maximal relative correction scales as @xmath296 or @xmath297 ) .",
    "a more detailed discussion of this kind of corrections would be technical and beyond the scope of this article , but the above order of magnitude can be a good evaluation of the accuracy of the following boundary approximation .",
    "this approximation takes explicitly into account a planar boundary , and ignores all the others .",
    "it can be used both in the continuous and in the discrete case .",
    "if we note @xmath250 the point symmetrical to @xmath5 with respect to the boundary , then the local approximation : @xmath298 satisfies the boundary conditions on the flat boundary , and is symmetric .",
    "it thus can be a good approximation for the pseudo - green function .",
    "[ distsw2d ] and [ quarter3d1 ] show the efficiency of this approximation in two different cases : in a 2d discrete domain , and in a 3d continuous domain . in both cases",
    "the approximation improves the basic approximation @xmath276 , but when the source is near another boundary , a systematic deviation appears , due to the influence of the other boundary .",
    "the curvature of the boundary may be taken into account by approximating the pseudo - green function by the pseudo - green function inside a circle ( [ exactdisk ] ) or a sphere ( [ exactsphere ] ) , or outside a circle or a sphere ( it can be found in @xcite ) .",
    "in this part we will compute the higher - order moments of the fpt . to do this ,",
    "we start from an extension of kac s formula ( see appendix [ annkac ] ) , which is the relation between the laplace transforms of the frt to the subset @xmath6 , averaged on @xmath6 , and of the fpt to this subset , the starting point being averaged over the complementary subset @xmath299 .",
    "@xmath300    both averages are weighted by the stationary probability @xmath21 , in the following sense : @xmath301 @xmath302 where @xmath303 is the probability for the frt ( or the fpt , according to whether the point @xmath13 belongs to @xmath6 or not ) to be @xmath304 , if the random walk starts from the point @xmath13 . to apply the equation ( [ highkac ] ) to the determination of the fpts",
    ", we may notice that the fpt from any point of the graph ( except target ) is the same on the original graph and on the modified graph : indeed , the behaviour of a random walk is exactly the same on both lattices as long as they do not reach @xmath1 , and what happens afterwards does not matter .",
    "moreover , the frt to @xmath1 is still the fpt from @xmath2 to @xmath1 , plus one .",
    "thus if we apply the formula ( [ highkac ] ) to the modified graph , @xmath6 being reduced to @xmath1 , we get the following relation between the laplace transform of the fpt from @xmath2 and the fpt averaged over the whole set of points ( without @xmath1 ) : @xmath305 @xmath36 is still @xmath306 .",
    "we have to pay attention to one thing : the average over @xmath299 is weighted by the weights for the stationary distribution of the modified lattice .",
    "to go further we will have to consider _ all _ the modified lattices with @xmath1 as target point , the starting point being any point of the set .",
    "we will denote @xmath307 the stationary distribution associated with the modified graph whose starting point is @xmath13 , and @xmath308 .",
    "thus , we may note : @xmath309 from this , we may deduce the recurrence equation for the moments : @xmath310 we may thus compute explicitly the second moment . @xmath311",
    "if we replace @xmath21 and @xmath312 by their values , we get @xmath313 we then may use the value of @xmath314 , which we know : @xmath315 this equation is exact , but it is difficult to evaluate properly in the general case . we will thus use approximations to evaluate this expression in the case of a 3-d regular lattice , with @xmath10 large and the boundaries far from the target , at a typical distance @xmath316 . we can thus neglect the term @xmath317 in the r.h.s . of equation ( [ exactt2 ] ) .",
    "if we develop the rest of the formula , we get : @xmath318 we can now drop the least important terms in this formula by evaluating the order of magnitude of the various sums over @xmath12 .",
    "we have ( cf",
    "( [ hbar ] ) ) : @xmath319    since @xmath320 in 3d , and the corrections are , on the worst case , of the same order of magnitude , we can see that @xmath32 scales as @xmath294 .",
    "if we consider the sums @xmath321 and @xmath322 , we may first notice that : @xmath323 we thus only need to consider the case of @xmath324 . and",
    ", for the same reasons as above , we can see that it scales as @xmath325 .",
    "putting all this together , we have : @xmath326\\ ] ] it is possible to generalize this expression to higher - order moments ; we will obtain the following result , for a given @xmath121 : @xmath327\\ ] ] we can prove this by recurrence : if this is true for @xmath328 , then : @xmath329 the others terms are negligible ( their relative order of magnitude is at most @xmath330 ) , and we will thus ignore them .",
    "we replace everything by its value , which gives : @xmath331 using exactly the same approximations as above ( the computation is identical ) , we get : @xmath327\\ ] ] as for the dependence with @xmath121 of the correction , since we perform exactly the same operation at each step @xmath332 , the correction will be proportional to @xmath121 , which may help estimate the validity of the approximation .",
    "this computation fails for elongated domains : two main hypotheses are not satisfied in this case , namely that the boundaries are at a typical distance @xmath80 , and that the corrections to @xmath51 have the same order of magnitude .",
    "the method can not either be applied to the 2d case , since the terms @xmath333 are no longer negligible .      in the continuous case",
    "we can perform a similar computation .",
    "the higher - order moments of the fpt at the target satisfy the following equations@xcite : @xmath334 @xmath335 @xmath336 using a new time the green function defined by eqs .",
    "( [ g1],[g2],[g3 ] ) and the green formula , we have @xmath337    with the knowledge of @xmath338 for all starting points @xmath5 , it is possible to compute the full distribution . in three dimensions ,",
    "it is possible to find an expression for @xmath339 similar to the one found in the discrete case .",
    "we will start from eq.([simplebrownian ] ) .",
    "we can now compute the second moment , using the values for @xmath98 and @xmath123 :    @xmath340\\\\ & &   \\left[g_0(a)+h^*({\\bf   r}_t|{\\bf r}_t)-h({\\bf r}|{\\bf r}_t)\\right ] d^d{\\bf r } \\nonumber\\end{aligned}\\ ] ]    to compute this , we will use the two following equations , equivalent to eq .",
    "( [ barh ] ) and ( [ scaling ] ) for discrete random walks : @xmath341 @xmath342",
    "this gives : @xmath343\\ ] ] this result may be extended by recurrence to higher - order moments , in exactly the same way that in the discrete case , which gives : @xmath207\\ ] ]",
    "in this appendix we will see how to improve the results of section [ continu ] , provided we know the pseudo - green function @xmath29 .",
    "the results we obtained in section [ continu ] are not perfectly satisfying for three reasons :    * when the source and the target are close , the approximation works better than one could naively expect , given that it does not satisfy eq .",
    "( [ g2 ] ) very accurately .",
    "it would be interesting to understand why . *",
    "the approximation lacks accuracy when the target is near a boundary . * in the two - target case the accuracy is not very good when the two targets are close .",
    "we will treat the first point in detail , and give the corrections , and the method used to compute them , for the second and third point .      to understand this",
    ", we will first notice that the green function we use could also be used in an electrostatic problem : the source is equivalent to a point charge , and the absorbing spheres are equivalent to conducting spheres set at a null potential .",
    "we can thus apply the well - known method of images @xcite to our problem .",
    "if we have an image charge @xmath344 @xmath345 placed on @xmath346 , located on the line between the center of the sphere and the source , at a distance @xmath347 of the target , where @xmath206 is the source - target distance , then the solution : @xmath348 satisfies exactly the boundary condition ( [ g2 ] ) on the target sphere : we have , for @xmath349 @xmath350 however , this solution does not satisfy the reflecting boundary conditions , and we will rather use the solution : @xmath351 which approximately satisfies ( [ g2 ] ) , provided that we neglect the variations of @xmath352 and @xmath190 on the target sphere . with this approximation",
    "we get : @xmath353 note that the last term @xmath354 can be neglected , since the variations of @xmath188 over the target sphere are neglected . finally , to find the eq .",
    "( [ simplebrownian ] ) , the only condition is to neglect the variations of @xmath188 over the target sphere , which will be a good approximation as soon as the target is far from any boundary . if this condition is satisfied , the approximation for the mfpt is accurate , even if the source is near the target .",
    "if the target is near a boundary , however , @xmath188 can no longer be considered as constant over the target sphere . to have a good approximation of @xmath29",
    ", one has to decompose the function one step further : @xmath355 where @xmath250 is the point symmetrical to @xmath5 with respect to the boundary .",
    "this simply explicits the image charges due to the boundary , which themselves have images on the target sphere .",
    "the real and image charges are depicted in fig .",
    "[ symetrie ] .    if we take into account all these charges , it is possible to obtain the following expression for the mfpt , valid as long as the target sphere does not touch the boundary : :    @xmath356    where @xmath357 .",
    "the two - target case can be treated likewise : by considering the images of @xmath96 and @xmath97 on the other sphere , it is possible to compute corrections to the terms @xmath128 , @xmath129 , @xmath358 and @xmath359 used in eqs .",
    "( [ tcontinu ] ) and ( [ pcontinu ] ) .",
    "these correction are : @xmath360 @xmath361 @xmath362 and similar corrections for @xmath129 and @xmath363 . @xmath364 and @xmath365 denote the value and the position of the image charge of @xmath5 inside @xmath135 .",
    "we use the notations of section [ discret ] : @xmath206 is an arbitrary finite set of points @xmath366 , with positions @xmath367 .",
    "@xmath14 is the transition probability from @xmath12 to @xmath13 , and we assume that any couple of points @xmath13 and @xmath12 in @xmath206 can be joined by at least one succession of links with non - zero transition probabilities .    among the points of @xmath206 , we now arbitrarily define a subset @xmath6 , and note the complementary subset @xmath368 .",
    "practically , the following properties will mostly be interesting if the number of points in @xmath6 is much smaller than the total number @xmath10 of points , but it is not necessary for the definitions .    with the definitions , the perron - frobenius theorem @xcite assures that there exists a stationary probability @xmath369 , which satisfies : @xmath370 from now on , we will consider that @xmath6 is absorbing , which means that the particle is absorbed as soon as it goes to the subset .",
    "however , it may start from it and go away on the following step without being absorbed .",
    "thus , we state that , on any state @xmath371 , the particle has a probability @xmath372 to be absorbed on its next step equal to : @xmath373      now , the probability @xmath374 that the conditional particle is adsorbed exactly at time @xmath304 , starting from state @xmath13 at time @xmath3 , obeys the backward equation :    @xmath375    if @xmath376 , and @xmath377    as a result , the laplace transform @xmath378 of @xmath374 satisfies :    @xmath379    where @xmath380 has been replaced by its value .",
    "we multiply this equation by the stationary probability @xmath369 and sum up over all @xmath381 .",
    "we notice that , from ( [ closed ] ) @xmath382    we thus obtain :    @xmath383    we now define two kinds of average for a quantity @xmath384 :    ( _ i _ ) the _ volume average _",
    "@xmath385    ( _ ii _ ) the _ surface average _",
    "@xmath386    where @xmath387 and @xmath388 are the respective stationary probabilities of the volume and the surface : @xmath389 @xmath390    and @xmath391 denotes the absorption time , which corresponds to the fpt to @xmath6 , or the frt to @xmath6 , depending on whether the starting point is on @xmath368 or @xmath6 .",
    "we thus simply get from ( [ prefin ] ) the following equation : @xmath392 or @xmath393 which is the extended kac s formula , relating the laplace transforms of the frts and the fpts .",
    "thus , for the first moment of @xmath391 we obtain the very simple and general result : @xmath394 ( kac s formula @xcite )",
    "for random walks we use a method based on the exact enumeration method @xcite .",
    "the exact enumeration method allows one to compute the exact distribution probability up to a given time : at each time step ( @xmath395 ) , we compute the full probability distribution of the random walker , using the master equation : @xmath396 @xmath85 here is the probability of the random walker to be at position @xmath5 at time @xmath304 and to never have reached the target site before .",
    "@xmath48 is the ensemble of neighbours of @xmath5 , which includes @xmath5 itself if @xmath5 is a boundary site .",
    "the initial condition is of course @xmath397 .",
    "note that if we set @xmath398 the algorithm will compute the distribution of the frt .",
    "after this first step , we have the probability distribution @xmath208 of the fpt : @xmath399 the last step of the algorithm is to set @xmath400 to 0 , and we can then proceed to the computation for the time @xmath401 .",
    "this enables us to compute the exact probability distribution , but of course the algorithm has to stop at a certain time . to go further",
    ", we can notice that the tail of the probability distribution is exponential ( this corresponds to the highest eigenvalue of the transition matrix , the transition probabilities to and out of the target being set to 0 to take the absorption into account ) .",
    "if @xmath402 for high enough @xmath304 , then we can compute the distribution up to a time @xmath403 , then estimate : @xmath404 the two latter terms correspond to @xmath405 . since @xmath406 is small , its order of magnitude being @xmath330 , they are approximated by @xmath407 . to estimate @xmath406 , we take @xmath408 ( we took @xmath409 steps and not one in order to avoid parity effects ) . to select @xmath403 ,",
    "we run a few trial simulations , with a large maximum time , and we determine the minimal @xmath403 which gives a result differing by at most @xmath410 from the result obtained with a larger @xmath403 . we add a small security margin , and then run the simulation .",
    "we use similar methods for all the other quantities studied .",
    "the error on the simulation results is thus guaranteed to be less than @xmath410 !",
    "unfortunately , for the brownian motion , we do not have such an accurate algorithm , and we thus used a brownian - dynamics - based algorithm @xcite : we average the time needed to reach the target on @xmath411 brownian processes . to simulate the brownian motion , we use the following algorithm :    1 .   find the distance between the particle and the nearest obstacle ( target , non - flat boundary ) .",
    "2 .   multiply that distance by a constant @xmath406 ( we used @xmath412 ) to get a trial typical step length .",
    "3 .   if we are very close to a boundary , or very close to the target , this trial step length would be too small .",
    "we thus add a lower cutoff to this trial step length ( we took @xmath413 near the target , of typical size radius @xmath168 , and @xmath414 near the curved boundaries , whose radius of curvature was typically @xmath415 ) , and get the typical step length @xmath416 .",
    "we use this step length to determine our time step @xmath417 .",
    "( we have @xmath418 ) .",
    "5 .   for each direction",
    "@xmath419 , we add to the position a gaussian random variable , of variance @xmath420 . to get such a variable , we use two random variables @xmath421 and @xmath422",
    "uniformly distributed between 0 and 1 , and then the random variable @xmath423 is indeed a gaussian with the required variance .",
    ".   if we are outside the domain , we move the particle inside the domain , to a position symmetrical with respect to the boundary . 7 .",
    "if we are inside the target , we end the process , otherwise we take another step .",
    "this algorithm is less accurate than the one we used in the discrete case , and is computationally more expensive .",
    "moreover , the study of the probability density of the fpt is delicate with this algorithm .",
    "the properties of the _ continuous _ pseudo - green function are well described in @xcite , and we will just describe the properties of the discrete one .",
    "we consider the case of symmetric transition probabilities .",
    "we define the discrete laplacian operator : @xmath424 this operator is hermitian , which will be useful .",
    "we define @xmath425 and @xmath426 the eigenvectors and ( real ) eigenvalues of the operator @xmath427 , ordered from @xmath3 to @xmath428 in increasing order .",
    "we have @xmath429 , and @xmath430 , with the usual normalization .",
    "since the operator is hermitian , we can take @xmath431 .",
    "we define : @xmath432 this solution satisfies : @xmath433 which corresponds to the definition we used for @xmath29 , and we thus found the solution ( up to a constant ) to the equation ( [ pseudogreen ] ) we used to define @xmath29 .",
    "this shows that @xmath29 is symmetric in its arguments if @xmath434 is symmetric . to prove that the sum @xmath435 is independent of @xmath12",
    ", we will simply sum up the equation ( [ pseudogreen ] ) over all @xmath13 , and use the fact that @xmath29 is symmetric .",
    "this gives : @xmath436 and @xmath32 is proportional to @xmath437 , and thus is a constant ."
  ],
  "abstract_text": [
    "<S> in this paper we present a computation of the mean first - passage times both for a random walk in a discrete bounded lattice , between a starting site and a target site , and for a brownian motion in a bounded domain , where the target is a sphere . in both cases </S>",
    "<S> , we also discuss the case of two targets , including splitting probabilities , and conditional mean first - passage times . </S>",
    "<S> in addition , we study the higher - order moments and the full distribution of the first - passage time . </S>",
    "<S> these results significantly extend our earlier contribution [ phys . </S>",
    "<S> rev . </S>",
    "<S> lett . * 95 * , 260601 ] . </S>"
  ]
}