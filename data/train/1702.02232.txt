{
  "article_text": [
    "the study of optimal stopping of brownian motion as close as possible to its ultimate maximum has been initiated in graversen , peskir and shiryaev @xcite . for geometric brownian motion ,",
    "the optimal prediction problem @xmath3\\ ] ] of selling at the ultimate maximum over all @xmath4}$]-stopping times @xmath5 $ ] has been solved in @xcite by du toit and peskir when the asset price @xmath6 is modeled by a geometric brownian motion and @xmath4}$ ] is filtration generated by @xmath7}$ ] , see @xcite for background on optimal stopping and free boundary problems , and chapter  viii therein for ultimate position and maximum problems . +",
    "this framework has recently been extended in liu and privault @xcite to the regime - switching model @xmath8 driven by a finite - state , observable continuous - time markov chain @xmath9 with state space @xmath10 independent of the standard brownian motion @xmath11 on a filtered probability space @xmath12 , where @xmath13 is the filtration generated by @xmath11 and @xmath9 and @xmath14 , and @xmath15 are deterministic functions .",
    "+ regime - switching models were introduced by hamilton @xcite in the framework of time series , in order to model the influence of external market factors .",
    "european options have been priced in continuous time regime - switching models by yao , zhang and zhou @xcite using a successive approximation algorithm .",
    "optimal stopping for option pricing with regime switching has been dealt with in e.g. guo  @xcite and le and wang  @xcite .",
    "+ it has been shown in particular in @xcite that the boundary function @xmath16 is nonincreasing and continuous in @xmath17 $ ] and satisfies a volterra integral equation of the form @xmath18 @xmath19 , with given terminal condition @xmath20 , where the functions @xmath21 and @xmath22 are specified in @xcite .",
    "+ under regime switching , the optimal boundary functions depend on the regime state of the system , and they may not be monotone if the drift coefficients @xmath23 have switching signs , cf . figures  [ fig2 - 3 ] and [ fig3 ] in section  [ last ] . essentially , a boundary function increases when there is sufficient time to switch from a state with negative drift to a state with positive drift and to remain there until maturity , and is decreasing otherwise .",
    "we refer to @xcite and @xcite for other optimal settings that involve non monotone boundary functions .",
    "+ in the regime switching setting however , no volterra equation such as is available in general for boundary functions , cf .",
    "section  5 and remark  5.5 of @xcite .",
    "in addition , the free boundary problem in the regime switching case consists in a system of interacting pdes , making its direct solution more difficult , cf .",
    "proposition  5.2 in @xcite . in buffington and elliott",
    "@xcite a free boundary problem has been solved under an ordering assumption on the boundary functions in the two - state case , see assumption  3.1 therein , however this condition may not hold in general in our setting , cf .",
    "figure  [ fig3 ] below , and their method is specific to american options .",
    "+ in this paper we construct a recursive algorithm for the numerical solution of in the regime - switching model , that includes the case where the drifts @xmath23 have nonconstant signs .",
    "our algorithm has a linear complexity @xmath24 in the number @xmath25 of time steps , hence in the absence of regime switching it also performs faster than the resolution of the volterra equation , which has a quadratic complexity @xmath26 due to the evaluation of the integral in , cf . section  [ last ] .",
    "+ we start by recalling the main results of @xcite . from lemma  2.1 in @xcite , the optimal value function @xmath27 in can be written as @xmath28 where the function @xmath29 \\times [ 1 , \\infty ) \\times { \\cal m } \\rightarrow \\real_+$ ] is given by @xmath30 \\\\",
    "\\label{vtj }   & = &   \\inf_{t\\le \\tau \\le t }   \\e \\left [   g \\left ( \\tau,\\beta_\\tau ,   \\frac{1}{y_\\tau }   \\max \\left ( a y_t , \\hat{y}_{t,\\tau } \\right )   \\right)\\ ; \\big| \\ ; \\beta_t = j   \\right],\\end{aligned}\\ ] ] for @xmath17 $ ] , @xmath31 , @xmath32 , with @xmath33 } y_r$ ] , @xmath34 , and @xmath35 ,   \\quad t\\in[0,t ] , \\   j \\in{\\cal m}.\\ ] ] here , the infimum is taken over all @xmath36}$]-stopping times @xmath1 , where @xmath37 , @xmath38 $ ] . from proposition  3.1 in @xcite ,",
    "given @xmath39 and @xmath40 , @xmath17 $ ] , the optimal stopping time for , or equivalently for , is the first hitting time @xmath41 of the stopping set @xmath42 \\times [ 1,\\infty ) \\times { \\cal m } \\ : \\",
    "v(t , a , j)=g(t , a , j )   \\big\\}\\ ] ] by the process @xmath43 } $ ] .",
    "+ the stopping set @xmath44 defined in is closed , and its shape can be characterized as @xmath45 \\times [ 1,\\infty ) \\times { \\cal m }    \\ : \\ y\\ge b_d ( t , j)\\right\\}\\ ] ] in terms of the boundary functions @xmath46 defined by @xmath47 , \\quad j \\in { \\cal m},\\ ] ] cf .",
    "proposition  3.2 of @xcite .",
    "+ if the condition @xmath48 is not satisfied for all @xmath49 , then @xmath50 may not be decreasing , cf .",
    "figure  [ fig3 ] below . on the other hand , @xmath51 for all @xmath49 leads to @xmath52 , @xmath53 $ ] , @xmath31 , which corresponds to immediate exercise , cf .",
    "proposition  5.3 in @xcite .",
    "+ in this paper we construct a recursive algorithm for the numerical solution of the optimal stopping problem , by determining the stopping set @xmath44 from the values of @xmath54 and @xmath55 , cf . theorem  [ shutdown ] and lemma  [ th2.3 ] below . as this approach",
    "does not rely on the volterra equation , it allows us in particular to determine the boundary function @xmath46 without requiring the condition @xmath48 for all @xmath49 as in @xcite , cf .",
    "for example figure  [ fig3 ] below .",
    "in addition we do not rely on closed form expressions as in @xcite as they are no longer available in the regime - switching setting .",
    "+ our algorithm extends the method of @xcite as it applies not only to the computation of expectations , but also to optimal stopping problems .",
    "however it differs from @xcite , even when restricted to expectations @xmath56 $ ] of payoff functions @xmath57 , where @xmath58}$ ] follows . in particular ,",
    "the recursion of @xcite is based on the jump times of the markov chain @xmath9 whereas we apply a discretization of the time interval @xmath59 $ ] , and our algorithm requires the monte carlo method only for the estimation of below .",
    "in the sequel we let @xmath60 , @xmath61 , @xmath62 , @xmath63 , and @xmath64 , \\quad n \\geq 1.\\ ] ] in the following theorem  [ shutdown ] , which is proved in section  [ s2 ] , the function @xmath65 is computed by the backward induction starting from the terminal time @xmath66 .    [ shutdown ] @xmath67 for all @xmath17 $ ] , @xmath68 and @xmath32 , the solution @xmath54 of satisfies @xmath69 where @xmath70 is the discrete infimum @xmath71,\\quad k=0,1,\\ldots , n-1,\\ ] ] taken over all @xmath72-valued stopping times @xmath73 , and @xmath74 .",
    "+ @xmath75 the value of @xmath76 in can be computed by the backward induction @xmath77,\\end{aligned}\\ ] ] for @xmath78 , under the terminal condition @xmath79 , @xmath32 , where @xmath55 in defined in .",
    "in addition , by the following theorem  [ conver ] proved in section  [ s4 ] , we provide a way to approximate the function @xmath55 used in . in the sequel",
    "we denote by @xmath80,\\ ] ] the joint probability density function of @xmath81 , and we let @xmath82_{1\\leq i , j \\leq m}$ ] denote the infinitesimal generator of @xmath83}$ ] , and define @xmath84 next , we show in theorem [ conver ] that @xmath85 is approximated by a limiting sequence @xmath86 given by the backward induction below .",
    "[ conver ] for any @xmath53 $ ] and @xmath31 we have @xmath87 where the limit is uniform in @xmath32 and @xmath88 is defined by the backward induction @xmath89 @xmath78 , with the terminal condition @xmath90 , @xmath31 , @xmath32 .    in the particular case of constant drift @xmath91 and volatility @xmath92 cf , theorems  [ shutdown ] and [ conver ] also provide an alternative numerical solution in the geometric brownian motion model of @xcite . in this case , @xmath93 is computed from by the backward induction @xmath94 -0.6 cm with @xmath95=\\int_0^\\infty \\int_{-\\infty}^y e^ { ( \\log a ) \\vee(\\sigma y)+\\lambda x- \\lambda^2(t - t ) / 2 }",
    "\\varphi_{t - t}(x , y)dxdy,\\end{aligned}\\ ] ] for all @xmath17 $ ] and @xmath32 , where @xmath96 , @xmath97 , and @xmath98 is given by . in",
    "the general regime switching setting , the function @xmath99 in can be estimated by monte carlo , while in the absence of regime switching it can be computed in closed form , cf .",
    "( 2.7 ) in @xcite .",
    "+ in sections  [ s2 ] and [ s4 ] we prove theorems  [ shutdown ] and [ conver ] .",
    "numerical illustrations are presented in section  [ last ] with and without regime switching .",
    "we observe in particular that boundary functions may not be monotone when the drift coefficients @xmath100 , @xmath31 , have different signs .",
    "@xmath67 first , we note that for any @xmath4}$]-stopping time @xmath101 $ ] we have @xmath102   & = & \\e\\left[\\frac{a\\vee\\left (   \\hat{y } _ { { t } , t } / y _ { t }   \\right ) } {   y_{\\tau } / y _ { t } } \\;\\big|\\ ; \\frac{\\hat{y}_{0 , { t } } } { y _ { t } } = a , \\",
    "\\beta _ { t } = j\\right ] \\\\",
    "\\label{condt } & = & \\e\\left [ \\frac{\\hat{y}_{0,t}}{y_{\\tau}}\\;\\big|\\ ; \\frac{\\hat{y}_{0 , { t } } } { y _ { t } } = a , \\",
    "\\beta_{t}=j \\right ] , \\end{aligned}\\ ] ] @xmath17 $ ] , @xmath31 , @xmath103 , since @xmath104 is conditionally independent of @xmath105 given @xmath106 , where @xmath107}$ ] is the drifted brownian motion @xmath108,\\ ] ] and @xmath109 , @xmath31 , is defined in .",
    "hence by we have @xmath110\\nonumber\\\\ & \\leq&\\inf\\limits_{{t^n_k}\\le\\tau_n\\le t}\\e\\left [ \\frac{\\hat{y}_{0,t}}{y_{\\tau_n } } \\;\\big|\\;\\frac{\\hat{y}_{0,{t^n_k}}}{y_{t^n_k}}=a , \\ \\beta_{t^n_k}=j\\right]\\nonumber\\\\ & \\leq&\\inf\\limits_{{t^n_{k+1}}\\le\\tau_n\\le t}\\e\\left [ \\frac{\\hat{y}_{0,t}}{y_{\\tau_n } } \\;\\big|\\ ; \\frac{\\hat{y}_{0,{t^n_k}}}{y_{t^n_k}}=a , \\ \\beta_{t^n_k}=j \\right]\\nonumber\\\\ & = & v_n({t^n_k},a , j),\\end{aligned}\\ ] ] @xmath111 , @xmath112 , @xmath32 , where we used and the infimum is taken over all @xmath72-valued discrete stopping times @xmath73 . therefore by the continuity of @xmath54 with respect to @xmath113 , cf .",
    "e.g. @xcite , chap iii , ",
    "7.1.1 page  130 and  7.4.1 pages  135 - 136 , we obtain @xmath114 @xmath75 on the other hand , by we have @xmath115 } \\\\",
    "\\nonumber & = & \\limsup\\limits_{n\\rightarrow\\infty}\\inf\\limits_{{\\lceil t\\rceil_n}+\\delta_n\\le\\tau_n\\le t}\\e\\left[\\frac{(ay_{\\lceil t\\rceil_n})\\vee\\hat{y}_{{\\lceil t\\rceil_n},t}}{y_{\\tau_n}}\\;\\big|\\;\\beta_{\\lceil t\\rceil_n}=j\\right ] \\\\",
    "\\nonumber   & = &   \\limsup\\limits_{n\\rightarrow\\infty }   \\sum\\limits_{l=1}^m   \\left[e^{(\\lceil t\\rceil_n - t)q}\\right]_{j , l}\\inf\\limits_{{\\lceil t\\rceil_n}+\\delta_n\\le\\tau_n\\le t}\\e\\left[\\frac{(ay_{\\lceil t\\rceil_n})\\vee\\hat{y}_{{\\lceil t\\rceil_n},t}}{y_{\\tau_n}}\\;\\big|\\;\\beta_{\\lceil t\\rceil_n } = l\\right ] \\\\",
    "\\nonumber & \\leq &   \\limsup\\limits_{n\\rightarrow\\infty }   \\inf\\limits_{{\\lceil t\\rceil_n}+\\delta_n\\le\\tau_n\\le t}\\sum\\limits_{l=1}^m   \\left[e^{(\\lceil t\\rceil_n - t ) q}\\right]_{j , l}\\e\\left[\\frac{(ay_{\\lceil t\\rceil_n})\\vee\\hat{y}_{{\\lceil t\\rceil_n},t}}{y_{\\tau_n}}\\;\\big|\\;\\beta_{\\lceil t\\rceil_n } = l\\right ] \\\\",
    "\\label{djklsdfds } & = &   \\limsup\\limits_{n\\rightarrow\\infty }   \\inf\\limits_{{\\lceil t\\rceil_n}+\\delta_n\\le\\tau_n\\le t}\\e\\left[\\frac{(ay_{\\lceil t\\rceil_n})\\vee\\hat{y}_{{\\lceil t\\rceil_n},t}}{y_{\\tau_n}}\\;\\big|\\;\\beta_t = j\\right],\\end{aligned}\\ ] ] @xmath116 $ ] , @xmath31 , @xmath103 , where @xmath117_{1\\leq i , j \\leq m}$ ] is the infinitesimal generator of @xmath83}$ ] .",
    "next , we note that for every stopping time @xmath118 $ ] we have @xmath119 , hence @xmath120 converges to @xmath1 uniformly in @xmath121 and pointwise .",
    "hence we have @xmath122 = \\e\\left[\\lim\\limits_{n\\rightarrow\\infty}\\frac{(ay_{\\lceil t\\rceil_n})\\vee\\hat{y}_{{\\lceil t\\rceil_n},t}}{y_{\\lceil\\tau\\vee(t+\\delta_n)\\rceil_n}}\\;\\big|\\;\\beta_{t}=j\\right ] , \\ ] ] @xmath123 $ ] , for any stopping time @xmath118 $ ] , where we applied lebesgue s dominated convergence theorem based on the bounds and stated at the end of this section . hence from and we find , for any stopping time @xmath118 $ ] , @xmath124 \\\\ \\nonumber & \\leq & \\lim\\limits_{n\\rightarrow\\infty}\\e\\left[\\frac{(ay_{\\lceil t\\rceil_n})\\vee\\hat{y}_{{\\lceil t\\rceil_n},t}}{y_{\\lceil\\tau\\vee(t+\\delta_n)\\rceil_n}}\\;\\big|\\;\\beta_{t}=j\\right ] \\\\   & = & \\e\\left[\\lim\\limits_{n\\rightarrow\\infty}\\frac{(ay_{\\lceil t\\rceil_n})\\vee\\hat{y}_{{\\lceil t\\rceil_n},t}}{y_{\\lceil\\tau\\vee(t+\\delta_n)\\rceil_n}}\\;\\big|\\;\\beta_{t}=j\\right]\\\\ & = & \\e\\left[\\frac{(ay_{t})\\vee\\hat{y}_{t , t}}{y_{\\tau}}\\;\\big|\\;\\beta_{t}=j\\right]\\\\ & = & \\e\\left[\\frac{\\hat{y}_{0,t}}{y_\\tau}\\;\\big|\\ ; \\frac{\\hat{y}_{0,t}}{y_t}=a , \\ \\beta_t = j \\right],\\end{aligned}\\ ] ] where we applied and the pathwise continuity of @xmath125}$ ] .",
    "hence by , we obtain @xmath126 = v(t , a , j),\\end{aligned}\\ ] ] @xmath123 $ ] , which completes the proof of by .",
    "+ @xmath127 in order to prove for @xmath128 , we consider an optimal stopping time @xmath129 such that @xmath130=\\inf\\limits_{t^n_l\\le\\tau_n\\le t}\\e\\left [ \\frac{\\hat{y}_{0,t}}{y_{\\tau_n}}\\;\\big|\\ ; \\frac{\\hat{y}_{0,{t^n_k}}}{y_{t^n_k}}=a , \\",
    "\\beta_{t^n_k}=j \\right],\\ ] ] where the infimum is taken over the discrete @xmath72-valued stopping times @xmath73 , and the existence of @xmath131 is guaranteed by corollary  2.9 of @xcite as in proposition  3.1 of @xcite .",
    "we note the induction @xmath132&=\\e\\left [ \\frac{\\hat{y}_{0,t}}{y_{t^n_k}}\\;\\big|\\ ; \\frac{\\hat{y}_{0,{t^n_k } } } { y_{t^n_k } } , \\ \\beta_{t^n_k } \\right ] \\wedge \\e\\left [ \\frac{\\hat{y}_{0,t}}{y_{\\tau_n^ { ( t^n_{k+1 } ) } } } \\;\\big|\\ ; \\frac{\\hat{y}_{0,{t^n_k } } } { y_{t^n_k } } , \\ \\beta_{t^n_k } \\right]\\nonumber\\\\   & = g\\left(t^n_k,\\frac{\\hat{y}_{0,{t^n_k}}}{y_{t^n_k}},\\beta_{t^n_k}\\right)\\wedge v_n\\left({t^n_k},\\frac{\\hat{y}_{0,{t^n_k } } } { y_{t^n_k}},\\beta_{t^n_k}\\right),\\label{split}\\end{aligned}\\ ] ] @xmath111 , @xmath32 , where @xmath133 and @xmath85 are defined in and respectively . by ,",
    "this yields @xmath134 } \\\\ & = & \\e\\left[\\e\\left [ \\frac{\\hat{y}_{0,t}}{y_{\\tau_n^{(t^n_{k})}}}\\;\\big|\\;\\frac{\\hat{y}_{0,t^n_{k}}}{y_{t^n_{k } } } , \\frac{\\hat{y}_{0,t^n_{k-1}}}{y_{t^n_{k-1}}}=a , \\",
    "\\beta_{t^n_{k } } , \\",
    "\\beta_{t^n_{k-1}}=j \\right ] \\;\\big|\\ ; \\frac{\\hat{y}_{0,t^n_{k-1}}}{y_{t^n_{k-1}}}=a , \\",
    "\\beta_{t^n_{k-1}}=j \\right]\\\\ & = & \\e\\left[\\e\\left [ \\frac{\\hat{y}_{0,t}}{y_{\\tau_n^{(t^n_{k})}}}\\;\\big|\\ ; \\frac{\\hat{y}_{0,t^n_{k}}}{y_{t^n_{k } } } , \\ \\beta_{t^n_{k } } \\right ] \\;\\big|\\ ; \\frac{\\hat{y}_{0,t^n_{k-1}}}{y_{t^n_{k-1}}}=a , \\",
    "\\beta_{t^n_{k-1}}=j \\right]\\\\ & = & \\e\\left[g\\left(t^n_{k } , \\frac{\\hat{y}_{0,t^n_{k}}}{y_{t^n_{k}}},\\ \\beta_{t^n_{k}}\\right)\\wedge v_n\\left(t^n_{k},\\frac{\\hat{y}_{0,t^n_{k}}}{y_{t^n_{k}}},\\ \\beta_{t^n_{k}}\\right ) \\;\\big|\\ ; \\frac{\\hat{y}_{0,t^n_{k-1 } } } { y_{t^n_{k-1}}}=a , \\",
    "\\beta_{t^n_{k-1}}=j \\right],\\end{aligned}\\ ] ] @xmath78 , where we applied , the markov property of @xmath135}$ ] and the relation @xmath136 . @xmath137",
    "+ we close this section with the proof of the two bounds used for above .",
    "a.   letting @xmath138 , we check that , for any stopping time @xmath1 and @xmath32 , we have the bound @xmath139 in which the right hand side is integrable for all @xmath140 $ ] .",
    "b.   on the other hand we have @xmath141<\\infty$ ] since , using the drifted brownian motion @xmath107}$ ] defined in we have , using the cauchy - schwarz inequality , @xmath142=\\e\\left[e^{\\sup\\limits_{t\\leq r\\leq t}\\int_t^r \\sigma(\\beta_v ) d\\tilde{b}_v - \\inf\\limits_{t\\leq r\\leq t}\\int_t^r\\sigma(\\beta_v ) d\\tilde{b}_v}\\;\\big|\\;\\beta_t = j\\right ] } \\\\ \\nonumber & \\leq &   \\sqrt {   \\e\\left[e^{2\\sup\\limits_{t\\leq r\\leq t}\\int_t^r \\sigma(\\beta_v ) d\\tilde{b}_v}\\;\\big|\\;\\beta_t = j\\right ] \\e\\left[e^{-2\\inf\\limits_{t\\leq r\\leq t}\\int_t^r \\sigma(\\beta_v ) d\\tilde{b}_v}\\;\\big|\\;\\beta_t = j\\right ] } \\\\ \\nonumber & \\leq &   \\sqrt{\\e\\left[e^{2\\sup\\limits_{t\\leq r\\leq t}\\int_t^r \\sigma(\\beta_v ) d\\tilde{b}_v}\\;\\big|\\;\\beta_t = j\\right ] }   \\\\   \\nonumber   & < & \\infty , \\end{aligned}\\ ] ] where we conclude to finiteness by conditioning and use of the density .",
    "we start with two lemmas .",
    "[ th2.3 ] for all @xmath143 , @xmath31 and @xmath32 , we have @xmath144    let @xmath145 denote the probability measure defined by @xmath146 where @xmath147 , @xmath31 , is defined in , and @xmath148}$ ] is the standard brownian motion under @xmath145 defined in . from the definition of @xmath55 we have @xmath149\\label{forlateuse}\\\\ & = & \\nonumber\\tilde{\\e } \\left[e^ { ( \\log a ) \\vee\\sup\\limits_{t\\le s\\le t}\\int_t^s\\sigma(\\beta_r)d\\tilde{b}_r+\\int_t^tu(\\beta_r)d b_r+\\frac{1}{2}\\int_t^tu^2(\\beta_r)dr}\\;\\big|\\;\\beta_t = j\\right]\\\\ & = & \\nonumber\\tilde{\\e } \\left[e^ { ( \\log a ) \\vee\\sup\\limits_{t\\le s\\le t}\\int_t^s\\sigma(\\beta_r)d\\tilde{b}_r+\\int_t^tu(\\beta_r)d\\tilde{b}_r-\\frac{1}{2}\\int_t^tu^2(\\beta_r)dr}\\;\\big|\\;\\beta_t = j\\right]\\\\ & = & \\e\\left[e^ { ( \\log a ) \\vee\\sup\\limits_{t\\le s\\le t}\\int_t^s\\sigma(\\beta_r)db_r+\\int_t^tu(\\beta_r)db_r-\\frac{1}{2}\\int_t^tu^2(\\beta_r)dr}\\;\\big|\\ ; \\beta_t = j\\right],\\label{g3}\\end{aligned}\\ ] ] which allows us to remove the drift component in the supremum @xmath150 .",
    "next , using we write @xmath151 where @xmath152,\\ ] ] with @xmath153 for any @xmath154 , and @xmath155.\\ ] ] by we have , for any @xmath111 , @xmath31 , and @xmath32 , @xmath156   \\\\",
    "\\nonumber & \\times \\varphi_{\\delta_n}(x , y)dxdy   \\\\",
    "\\nonumber & =    e^{q_{j , j}\\delta_n }   \\int_0^{\\infty}\\int_{-\\infty}^y   \\\\",
    "\\nonumber   &    \\e\\left [   e^ { \\ ! \\ !   (   ( ( \\log a ) \\vee(\\sigma(j)y)-\\sigma(j)x ) \\vee   \\ ! \\ ! \\ ! \\ ! \\ !   \\sup\\limits_{t^n_{k+1}\\le",
    "s\\le t}\\int_{t^n_{k+1 } } ^s\\sigma(\\beta_r)db_r   + \\sigma(j)x+\\int_{t^n_{k+1}}^t u(\\beta_r)db_r+u(j)x-\\frac{1}{2}\\int_{t^n_{k+1 } } ^tu^2(\\beta_r)dr- u^2(j ) \\delta_n /2 ) }   \\right ]   \\\\",
    "\\nonumber   &   \\times \\varphi_{\\delta_n}(x , y)dxdy\\\\   &    = e^{q_{j , j}\\delta_n }   \\int_0^{\\infty}\\int_{-\\infty}^ye^ { ( u(j)+\\sigma(j ) ) x-   u^2(j)t / ( 2n ) }   g ( t^n_{k+1},e^ { ( \\log a ) \\vee(\\sigma(j)y)-\\sigma(j)x},j ) \\varphi_{\\delta_n}(x , y)dxdy,\\end{aligned}\\ ] ] where in the first equality we used the fact that the time to the first jump of @xmath157 after @xmath113 is exponentially distributed with parameter @xmath158 given @xmath159 , cf .",
    "e.g.   10.4 in @xcite .",
    "next , for @xmath160 , @xmath111 , @xmath31 , and @xmath32 , by we see that -1.cm @xmath161   \\\\",
    "\\nonumber &    \\varphi_r ( x , y)dxdy dr    \\\\   \\nonumber & =   \\sum_{i=1\\atop i \\not= j}^m   q_{j , i }   \\int_0^{\\delta_n } e^{q_{j , j}r } \\int_0^{\\infty}\\int_{-\\infty}^y e^ { ( u(j)+\\sigma(j ) ) x-{u^2(j)r}/{2}}g ( t^n_k + r , e^ { ( \\log a ) \\vee(\\sigma(j)y)-\\sigma(j)x},i ) \\varphi_r ( x , y)dxdy dr,\\end{aligned}\\ ] ] where we used the conditional probability distribution @xmath162 computed from the exponential distribution with parameter @xmath163 of the first jump time @xmath164 of the markov chain @xmath9 started at @xmath165 and the transition matrix @xmath166 of the embedded markov chain , cf . e.g.   10.7 of @xcite .",
    "hence we conclude to by , and .",
    "[ gcontin ] for any @xmath49 , the function @xmath167 is uniformly continuous in @xmath53 $ ] , uniformly in @xmath32 , i.e. @xmath168    by , for all @xmath32 we have @xmath169 -\\e\\left[a\\vee\\exp\\left (   \\sup\\limits_{s\\le v \\le t}\\int_s^v \\sigma(\\beta_r)d\\tilde{b}_r \\right )   \\;\\bigg|\\;\\beta_s = j\\right]\\bigg|\\\\ & \\leq \\bigg|\\e\\left[\\exp\\left (   \\sup\\limits_{t\\le v \\le t}\\int_t^v \\sigma(\\beta_r)d\\tilde{b}_r \\right )   \\;\\bigg|\\;\\beta_t = j\\right ]    -\\e\\left[\\exp\\left (   \\sup\\limits_{s\\le v \\le t}\\int_s^v \\sigma(\\beta_r)d\\tilde{b}_r \\right )   \\;\\bigg|\\;\\beta_s = j\\right]\\bigg| , \\end{aligned}\\ ] ] hence it suffices to show the continuity in @xmath53 $ ] of the above bound . similarly to , we have @xmath170 = \\e\\left[e^{\\sup\\limits_{t\\le v\\le t}\\int_t^v\\sigma(\\beta_r)db_r+\\int_t^tu(\\beta_r)db_r-\\frac{1}{2}\\int_t^tu^2(\\beta_r)dr}\\;\\big|\\ ; \\beta_t = j\\right],\\ ] ] @xmath17 $ ] , @xmath49 .",
    "next , for any @xmath171 we have @xmath172 and similarly by replacing @xmath173 with @xmath174 , thus @xmath175 is upper bounded by @xmath176 which is @xmath177-integrable as in .",
    "therefore , by dominated convergence we find @xmath178}\\nonumber \\\\ & = & \\nonumber\\lim\\limits_{s\\searrow t}\\sum\\limits_{l=1}^m \\left[e^{(s - t)q}\\right]_{j , l } \\e\\left[e^{\\sup\\limits_{s\\le v\\le t}\\int_s^v\\sigma(\\beta_r)db_r+\\int_s^tu(\\beta_r)db_r-\\frac{1}{2}\\int_s^tu^2(\\beta_r)dr}\\;\\big|\\ ;    \\beta_s = l\\right ] \\\\ & = & \\nonumber\\lim\\limits_{s\\searrow t}\\e\\left[e^{\\sup\\limits_{s\\le v\\le t}\\int_s^v\\sigma(\\beta_r)db_r+\\int_s^tu(\\beta_r)db_r-\\frac{1}{2}\\int_s^tu^2(\\beta_r)dr}\\;\\big|\\ ; \\beta_t = j\\right]\\\\ & = & \\e\\left[e^{\\sup\\limits_{t\\le v\\le t}\\int_t^v\\sigma(\\beta_r)db_r+\\int_t^tu(\\beta_r)db_r-\\frac{1}{2}\\int_t^tu^2(\\beta_r)dr}\\;\\big|\\ ; \\beta_t = j\\right]\\end{aligned}\\ ] ] and similarly , @xmath179 } \\\\ \\nonumber & = & \\e\\left[e^{\\sup\\limits_{t\\le v\\le t}\\int_t^v\\sigma(\\beta_r)db_r+\\int_t^tu(\\beta_r)db_r-\\frac{1}{2}\\int_t^tu^2(\\beta_r)dr}\\;\\big|\\;\\beta_t = j\\right].\\end{aligned}\\ ] ] combining and we conclude to lemma [ gcontin ] by a classical uniform continuity argument .",
    "finally , we proceed to the proof of theorem  [ conver ] .",
    "let @xmath180 with @xmath181 . by , and we have @xmath182 @xmath183 , where @xmath184 with @xmath185 combining and yields @xmath186dr   \\sum_{i=1\\atop i \\not= j}^m q_{j , i }   \\\\",
    "\\nonumber   & = &      e^{(q_{j , j}+\\mu(j))\\delta_n}\\delta^n_k + ( \\delta^n_k+\\varepsilon^n_{k-1 } )      \\max_{j\\in { \\cal m } }      \\int_0^{\\delta_n }   e^{(u(j)+\\sigma(j))^2\\delta_n/2 - u^2(j)r/2+q_{jj}r }   dr   \\sum_{i=1\\atop i \\not= j}^m q_{j , i }",
    "\\\\ \\nonumber      & \\leq & c \\left (    \\delta^n_k+\\varepsilon^n_{k-1}\\delta_n\\right ) ,    \\qquad    k=1,2,\\ldots , n-1 ,      \\end{aligned}\\ ] ] for some constant @xmath187 independent of @xmath171 , hence @xmath188 and @xmath189 which tends to @xmath190 as @xmath25 tends to infinity by in lemma [ gcontin ] .",
    "consequently we have @xmath191 for any @xmath192 , @xmath31 , and by lemma [ gcontin ] it follows that @xmath193 uniformly in @xmath32 , for all @xmath31 and @xmath53 $ ] .",
    "@xmath137    -0.4 cm",
    "in this section we present numerical estimates obtained from theorems  [ shutdown ] and [ conver ] for the boundary functions @xmath194 , \\quad j \\in { \\cal m},\\ ] ] of the stopping set @xmath44 defined in , in the case of two - state markov chains with @xmath195 .",
    "+ @xmath67 constant drift .    in the absence of regime switching",
    ", the recursive algorithm of theorems  [ shutdown ] and [ conver ] is applied in figure  [ fig0_0 ] to the computation of the value functions @xmath54 and @xmath55 with @xmath196 , @xmath197 , @xmath198 , @xmath199 , and @xmath200 .",
    "figure  [ fig0_0 ] allows us in particular to visualize the stopping set @xmath44 defined in and the continuation set @xmath201 \\times [ 1,\\infty ) \\ : \\",
    "v(t , a ) < g(t , a )   \\big\\}$ ] . + in figure",
    "[ fig0 ] the recursive method is compared to the solution of the volterra integral equation by dichotomy for the computation of the boundary function @xmath16 .      as shown in figure  [ fig0 ] , the recursive and volterra equation methods yield similar levels of precision . however , increasing the number @xmath25 of time steps will make the volterra equation method perform slower relative to the recursion method , due to the quadratic complexity of the former and to the linear complexity of the latter .",
    "+ @xmath75 drifts with switching signs .",
    "figure  [ fig2 - 3 ] presents the graphs of the value functions obtained from the recursive algorithm of theorems  [ shutdown ] and [ conver ] with @xmath202 , @xmath203 , @xmath204 , @xmath205 , @xmath206 , @xmath207 , @xmath208 , and @xmath209.\\ ] ]            figure  [ fig2 - 3 ] also allows us to visualize the stopping set @xmath44 and the continuation set @xmath210 \\times [ 1,\\infty ) \\times { \\cal m } \\ : \\",
    "v(t , a , j ) < g(t , a , j )     \\big\\}.\\ ] ] the numerical instabilities observed are due to the necessity to check the equality @xmath211 when @xmath54 and @xmath55 are very close to each other .",
    "we observe that the corresponding boundary function @xmath212 starting from state @xmath213 is not monotone .",
    "precisely , when time @xmath113 is close to @xmath190 it is better to exercise early because one may switch to state @xmath214 after the average time @xmath215 , in which case the drift takes the negative value @xmath216 . on the other hand , when @xmath113 increases up to @xmath217 the function @xmath212 tends to increase as it makes more sense to wait since we may stay at state @xmath213 with @xmath218 for the remaining average time @xmath219 , which is higher than the remaining time @xmath220 .",
    "the boundary functions are plotted in figure  [ fig3 ] with spline smoothing .",
    "starting from state @xmath214 we observe the usual decreasing boundary @xmath221 , which here becomes close to @xmath190 before time @xmath66 , since in this case we should exercise immediately as the average time @xmath219 to switch to state @xmath213 exceeds the remaining time @xmath220 until maturity .",
    "+ until time @xmath222 we should exercise immediately when switching from state @xmath214 to state @xmath213 at a time @xmath113 such that @xmath223 , while after time @xmath222 the strategy is the opposite if @xmath224 ."
  ],
  "abstract_text": [
    "<S> we propose a recursive algorithm for the numerical computation of the optimal value function @xmath0   $ ] over the stopping times @xmath1 with respect to the filtration of a geometric brownian motion @xmath2 with markovian regime switching . </S>",
    "<S> this method allows us to determine the boundary functions of the optimal stopping set when no associated volterra integral equation is available . </S>",
    "<S> it applies in particular when regime - switching drifts have mixed signs , in which case the boundary functions may not be monotone .    </S>",
    "<S> * key words : * _ optimal stopping ; markovian regime switching ; non - monotone free boundary ; recursive approximation . </S>",
    "<S> _    _ mathematics subject classification ( 2010 ) : _ 93e20 ; 60g40 ; 60j28 ; 35r35 ; 91g80 ; 91g60 .    0.7 cm </S>"
  ]
}