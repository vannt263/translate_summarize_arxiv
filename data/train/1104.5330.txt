{
  "article_text": [
    "particle transport phenomena are central in modelling systems governed by radiative hydrodynamics , encountered very often in astrophysics as well as in plasma physics .",
    "a global description of radiative transport involves the hyperbolic transport equation , sometimes called boltzmann equation in the literature .",
    "this equation describes the time evolution of a distribution function @xmath0 defined on a 6-dimensional phase space .",
    "the high dimensionality of this equation often prevents its numerical resolution in the most general geometry , due to unaffordable computational resources for obtaining physical results in a reasonable cpu time , when using classical techniques . as a result , most numerical models for radiative transport physics in several settings either restrict the global geometry of the problem ( as in  @xcite , or replace the transport equation by simplified models usually involving the distribution moments  @xcite",
    "however , in the particular setting of neutrino transport in astrophysical supernovae , the fact that a multidimensional transport model for neutrino radiation was needed to reproduce the observed supernova explosions has been strongly hinted in recent simulations  @xcite . as a result",
    ", attempts have been made in this direction , but they result in very demanding simulations , that are still not able to capture all the needed physics in a general geometry  @xcite .    apart from the problem of dimensionality and size of the simulations ,",
    "transport phenomena very often involve physical processes occurring through several orders of magnitude for typical lengths .",
    "once again , this problem arises in the supernovae neutrinos setting , when comparing the mean free path of a radiative particle in the diffusion regime and the typical size of the system  @xcite .",
    "as long as the two computational problems mentioned above are concerned , it is customary to privilege numerical methods with a high order of accuracy  @xcite .",
    "the use of multidimensional spectral methods  @xcite seems to be especially adequate .",
    "concerning the computational size difficulties , a rule of thumb  @xcite claims in fact that for a given accuracy , spectral treatment requires five times less grid points per dimension then the ordinary second order finite difference algorithm . a computational factor of @xmath1",
    "could then be gained in modelling the transport equation .",
    "consequently , solving the 6-d transport problem in a reasonable time while using a spectral algorithm and massive parallelisation seems possible . in this article",
    ", we shall describe the numerical methods that can be used in solving the sole transport equation for radiative particles and testing such an economy in computational time .    from a mathematical point of view and if we follow suitable approximations , the neutrino and photon transport equations are analogous in a majority of settings",
    ". the abundant results on the photon transport equation will be however mainly used here for testing numerically our scheme .    in this work",
    ", the following assumptions will be made :    \\1 ) as mentioned above , we assume the mass of the radiative particles to be zero ( which for astrophysical neutrinos is a fairly reasonable assumption ) .",
    "\\2 ) neutrino and photon polarisation states will not be taken into account , and will be averaged on .",
    "\\3 ) the interacting plasma will be assumed to be at the local thermal equilibrium .",
    "this physical oversimplification will allow for a much simpler treatment , by enabling to introduce the full thermal equilibrium limit in the equations .",
    "\\4 ) for the simplicity of discussion , possible general relativistic terms will not be taken into account .",
    "we believe this aspect , though physically important in some astrophysical computations , will in no way change the behaviour of the numerical scheme , or the mathematical properties of the studied equations .    using ( 6 + 1 ) general spherical coordinates in phase space",
    ", we will perform a numerical resolution using spectral methods based on fourier / chebychev decomposition , depending on the type of coordinates involved .",
    "this decomposition will be performed in the physical space ( classical spherical coordinates @xmath2 ) as well as in the momentum space ( energy dependence and angular coordinates for the momentum part ) . due to possible discontinuities arising on the space variable @xmath3",
    ", we will also propose an hybrid version of the code in which we use finite differences only in this dimension .",
    "a tentative conservative full spectral version including also a chebychev decomposition in @xmath3 will be designed and tested as well .",
    "we shall show in different contexts relevant results in 5 dimensions at most , and give the corresponding cpu time obtained for every simulation , on single - processor runs of an ordinary computer with a clock frequency of @xmath4 ghz .",
    "+   + the paper is organised as follows : in section 2 , we present the general mathematical framework of the transport equation , alongside with typical physically motivated source terms for the equation . in section 3",
    "we present two asymptotic settings for physical transport of neutrinos and photons , namely the coherent transport case and the fokker - planck approximation .",
    "those two limiting cases will be used as test problems in the ensuing numerical investigations .",
    "section 4 will present the derivation of the transport equation in our chosen coordinates , as well as the possible mathematical problems that arise with this description ; a few solutions will then be proposed to handle resolution in the most efficient way .",
    "section 5 presents first numerical tests of the designed code , including time evolution for uniform distribution and full coherent transport using hybrid discretization .",
    "finally section 6 will present a solution to the spectral approach in spherical symmetry , with an emphasis on the issue of conservation of the number of particles .",
    "let @xmath5 be the distribution function in the phase space for a collection of particles , expressed in cartesian - like coordinates .",
    "the transport equation will quantify the evolution of this distribution function with respect to collision terms , that describe the interaction of the radiative particle with other particle species of a plasma .",
    "the change in number of particles in the elementary volume of phase space @xmath6 is then described by [ boltz1 ] f d^3 d^3 = ct , where @xmath7 represents the total derivative and @xmath8 includes the collision terms .",
    "a reasonable assumption for neutrinos or photons is that between collisions with plasma particles ( described in the collision terms ) , radiating photons / neutrinos travel in straight lines with no change in energy .",
    "this amounts to the absence of global forces acting on the radiating particles . in this context , the non - general relativistic transport equation in cartesian coordinates takes the form : [ tra1 ] + ^i = ct , where [ betai ] ^i= , = 1 , @xmath9 is the light velocity , and @xmath8 is a collision term that depends also on @xmath10 .      three different types of processes are expressed in collision terms :    * the rate of spontaneous emission of radiating particles by a particular process on the plasma will be expressed as @xmath11 ; here @xmath12 models the spatial position , and @xmath13 is the radiative particle frequency ( or its reduced energy @xmath14 , where @xmath15 is the planck constant ) .",
    "a general assumption is that the emission is isotropic ( i.e. matter itself does not have a preferred direction ) .",
    "this of course is only valid if our frame of reference is moving with the plasma .",
    "* absorption processes are expressed by a cross section @xmath16 and are also assumed to be isotropic .",
    "* scattering processes at a spatial position @xmath17 , from a radiating particle scattered from coordinates @xmath18 within @xmath19 to @xmath20 within @xmath21 is expressed by the cross section @xmath22 .",
    "again , in agreement with the previous assumption of isotropy for matter processes , this differential cross section only depends on the angle between the incoming and scattered radiating particle momentum , _ via _ the simple scalar product @xmath23 .    we further assume for simplicity that radiative particles interact with only one species of the plasma , of particle mass @xmath24 .",
    "using this energy scale we define an auxiliary distribution function f= ( ) ^2f = ^2f , where the notation @xmath25 is coined as the dimensionless energy for the radiative particle .",
    "this redefinition of the distribution function allows for a slightly simpler notation for the interaction terms , while the left hand side operator of eq .",
    "[ tra1 ] keeps the same form as applied to @xmath0 .",
    "once all those quantities characterising the interactions with matter are known , the collision term is determined by the formula : +   + @xmath26 \\nonumber \\\\",
    "-\\int_0^{\\infty } d \\nu^ { ' } \\int _ { 4\\pi } d\\vec{\\omega}^ { ' } \\sigma_{d}(\\nu \\to \\nu^ { ' } , \\vec{\\omega } \\cdot \\vec{\\omega}^ { ' } ) f(\\nu,\\vec{\\omega } ) [ 1 \\pm \\frac{c^3}{2 \\nu^2 } f(\\nu^ { ' } , \\vec{\\omega } { ' } ) ] \\ } ,    % \\end{aligned}\\ ] ] where @xmath27 is the interacting plasma density . for clarity , no spatial dependence of the chemical composition for the plasma",
    "is assumed ; we finally write here interaction terms that are only proportional to the plasma density @xmath28 . in the right hand side",
    "part , and besides the absorption and emission terms , the first integral term models the in - scattered neutrinos to coordinates to @xmath29 within @xmath30 .",
    "the second integral term models the out - scattered neutrinos , from @xmath29 to @xmath31 .",
    "@xmath32 is the differential scattering kernel for interactions .",
    "we have also included in front of the scattering integrals the quantum corrections due to induced processes for both types of radiating particles .",
    "only one term for each type of process is represented in an attempt for concision .",
    "consider the very low energy regime for the plasma and the radiating particles ; the following assumptions are then made :    \\1 ) the plasma is at rest in our frame .",
    "\\2 ) the ratio between the scattered particle energy @xmath33 and the scattering target rest mass @xmath34 ( be it a lepton or a hadron ) is very small : ( @xmath35).the velocity of scattering plasma particles will then always be neglected in this case .",
    "+ under the above assumptions , we crudely approximate that no energy exchange occurs , meaning that the energy of the scattered particle is the same as the impinging one",
    ". therefore the scattering kernels writes : [ sigmadif ] _",
    "d(^ , ^)= _ d ( ^ ) ( - ) , where @xmath36 is the dirac function . here",
    "we give general expressions for the differential and total cross sections @xmath32 and @xmath37 , for photon and neutrino scattering to electrons and hadrons .",
    "the total cross section is defined by : [ sigmatot ] _ t= _",
    "0^ d ^ _ 4 d ^ _ d(^ , ^ ) .",
    "in the photon / electron case , the coherent scattering approximation leads to the well - known thomson scattering cross sections : [ sigmath ] ^th_d=2 r_e^2 ( 1 + ( ^)^2 ) ( -^ ) , ^th_t= r^2_e where @xmath38 is the classical radius of the electron , @xmath39 being its mass .    in the neutrino / hadron interaction case ,",
    "the differential cross section is usually reduced to the two leading orders in the angular decomposition , in the form : [ sigman ] ^n_d = ( a + b ( ^ ) ) ( -^ ) , ^n_t = a where @xmath40 and @xmath41 are constant depending on the nucleons .      for a plasma particle ,",
    "we denote by @xmath42 the thermal energy to mass energy ratio . in this section",
    "we assume that @xmath43 as before , @xmath44 and that the plasma , at rest in the laboratory frame , is in local thermodynamic equilibrium . in this context",
    ", we would like to describe low order energy redistribution in scattering processes .",
    "this is the setting of the fokker - planck approximation . and for temperature @xmath45 and photon energy @xmath46 .",
    "it is especially relevant in the context of x - ray astrophysics ] we obtain then for the photon distribution function @xmath47  , @xcite  eq.(8.62 ) : @xmath48 f(\\gamma,\\vec{\\omega}^ { ' } ) \\right .",
    "\\nonumber \\\\ \\left .",
    "+ \\frac{1}{4 \\pi}\\frac{\\partial}{\\partial    \\gamma }    \\left ( \\alpha \\gamma^2 \\frac{\\partial}{\\partial_\\gamma }   + \\gamma^2 -2 \\alpha \\gamma\\right ) \\int_{4 \\pi } d \\vec { \\omega}^ { ' } f(\\gamma,\\vec{\\omega}^ { ' } ) \\right .",
    "\\nonumber \\\\ \\left .",
    "- \\frac{3}{128 \\pi^2 }   \\int_{4 \\pi } d \\vec{\\omega}^ { ' }   % f(\\gamma,\\omega^ { ' } )   \\cdot% \\int_{4 \\pi } d \\omega^ { `` } \\left [ 1-\\vec{\\omega}^ { ' } \\cdot \\vec{\\omega}^ { `` }   + ( \\vec{\\omega}^ { ' } \\cdot \\vec{\\omega}^{``})^2 -(\\vec{\\omega}^ { ' } \\cdot \\vec{\\omega}^{``})^3 \\right]\\partial_\\gamma \\left(f(\\gamma,\\vec{\\omega}^ { ' } f(\\gamma , \\vec{\\omega}^ { `` } ) \\right ) \\label{transpfp } \\right\\},\\end{aligned}\\ ] ] where we used here a number distribution function , as opposed to the energy distribution function @xmath49 in  @xcite . the equation is written in the reduced length unit of @xmath50 , @xmath51 cm being the compton wavelength .",
    "as before , some variables dependencies in the distribution function are implicit .",
    "absorption and emission terms are also not written here . + by using the fokker planck approximation , one",
    "can then replace the integral operator on the energy in the eq.([transpfp ] ) by a differential operator , much easier to handle numerically . as mentioned in the introduction , the fokker - planck limit for transport",
    "will be considered as a test case in numerical investigations , alongside with the coherent scattering limit .    from the fokker - planck equation",
    "we can define two typical times : the `` isotropisation time '' @xmath52 describes the typical evolution of the angular distribution in phase space , whereas the `` bosonisation time '' @xmath53 will be related to dynamical changes in the energy spectrum of radiative particles .",
    "since @xmath54 , @xmath55 holds ; consequently , during the evolution , @xmath0 will undergo an `` isotropisation '' process in a shorter timescale than the energy spectrum of the distribution function @xmath0 will change significantly .",
    "if @xmath0 is homogeneous and depends only on @xmath56 and @xmath25 , then eq.([transpfp ] ) reduces after integration on @xmath57 and @xmath58 to the kompaneet equation  @xcite : [ kompa ] + n _ th = 0 .",
    "if we integrate both sides of the eq.([kompa ] ) on the dimensionless energy @xmath25 , we obtain , as expected , an equation which expresses the conservation of the number of photons : [ cosph ] _ 0^",
    "f(,t ) d = 0 .",
    "the steady state solution of eq.([kompa ] ) is a bose distribution : [ bose ] f()= ^2f ( ) = 2 ^2 ( - 1 ) ^-1 , the factor of 2 in the right hand side being related to photon polarisation .",
    "@xmath59 is an integration constant which physically represents the chemical potential .",
    "the steady state solution is then a bose distribution and _ not _ the usual planck distribution that describes full thermal equilibrium .",
    "this is due to the fact that we have omitted the absorption and emission terms , and consequently constrain the photon number conservation given by the eq.([cosph ] ) .",
    "this also justifies the term of `` bosonisation '' introduced above .",
    "starting from the quite general expression for the above equations , we specify now the geometry of our setting , as well as the attached chosen system of coordinates . having in mind transport modelling in astrophysical ( stellar ) settings , the most natural geometry for this type of study is the spherical one .",
    "we here choose a set of 6-d spherical coordinates related to previously defined phase space vectors @xmath60 , and described by the variables @xmath61 as in fig .",
    "[ f : sph6d ] .",
    "the first three variables are the classical 3d spherical coordinates in physical space ; @xmath62 and @xmath63 represent the angular dependence in the momentum space , whereas @xmath64 is a dimensionless measure of the photon ( resp .",
    "neutrino ) energy .     up to a constant.,scaledwidth=60.0% ]    in this system of coordinates , we can , from the expression in 6-d cartesian - like coordinates , write the liouville operator @xmath65 using jacobi matrix products for coordinate changes ; one has however to keep in mind that in the new coordinate set , the angular variables in the momentum space are defined with respect to physical space angular coordinates ; this of course slightly complicates the calculation .    in the end ,",
    "the operator reads (  @xcite , and references therein ) : @xmath66 , \\end{aligned}\\ ] ] so that the general transport equation becomes [ transpfpsph ] + l_sph f = ct .",
    "let us note that it is also possible ( and useful ) to write this equation in a conservative form : see the appendix a for a derivation of it .",
    "in order to express integrals in source terms , the expression of the vector @xmath67 in the new system of coordinates is now required .",
    "we provide the cartesian components @xmath68 of the vector @xmath69 as function of @xmath70 and @xmath71 : [ omegax ] _ x= + -[omegay ]",
    "_ y= + + [ omegaz ] _",
    "the following properties hold : ) are quite trivial : consider the liouville operator @xmath72 in cartesian coordinate and cartesian components : @xmath73 for @xmath74 , @xmath75 or @xmath76 the above identities are fulfilled .",
    "this obviously holds then for any generic system of coordinates .",
    "numerically , the relations in eq.([prop2]),or eq.([propf ] ) can be used to assess the numerical accuracy of our resolution . ] [ prop1 ] _",
    "y^2 + _ z^2 = 1 [ prop2 ] l_sph _ x=0 , _ sph _ y=0 _ sph _ z = 0 .",
    "therefore , if the distribution function @xmath0 depends only on @xmath69 , we have [ propf ] l_sph f(_x , _ y , _ z)=0 .",
    "we shall finish this section by noticing that some terms of the liouville operator @xmath77 given by the eq.([liouvsph ] ) are singular for @xmath78 and @xmath79 .",
    "since the operator is itself regular , these terms correspond to coordinate singularities that shall cancel each other in the computation .",
    "we shall give an example of such cancellations in our case .",
    "consider a spherical shell in physical space , for which @xmath80 and @xmath81 .",
    "only singularity issues in @xmath79 are then to consider . we first write a polynomial decomposition of the distribution in cartesian - like coordinates : [ expansion ] f(x , y , z,_x,_x,_z , t)=_i , j , k , a , b , c c(t)_ijkabcx^i y^j",
    "z^k _ x^a _ y^b _ z^c .    in 6-d",
    "spherical coordinates , the singular terms in the liouville operator given by the eq.([liouvsph ] ) are [ sing ] ( - ) .    in the above polynomial decomposition ,",
    "we encounter two cases :    - for terms associated with coefficients of type @xmath82 ( no dependence on @xmath83 ) , a spherical decomposition in @xmath2 will lead to @xmath84-dependent terms being factored by @xmath85 .    - for terms containing powers of @xmath86 , their expression in eqs.([omegax],[omegay],[omegaz ] ) ensures us that compensation will occur when the operator in eq.([sing ] ) is applied .",
    "the spectral representation of the considered fields is able to handle directly the specifics of the decomposition ( see  @xcite for similar examples ) .",
    "we illustrate the prominent difficulties encountered in the analysis of this equation with a problem restricted to a spherically symmetric shell ( @xmath80 ) and with only coherent scattering allowed .",
    "the solution @xmath0 for the distribution function will then only depend on the three variables @xmath88 .",
    "we focus here on analyticity issues and the problem of boundary conditions . under the above hypotheses , the transport equation simplifies to : @xmath89 where @xmath90 is a plasma density , @xmath91 and @xmath92 are",
    "respectively the total and differential cross section , and integration on the momentum angle @xmath93 has already been performed . in order to perform a very simple analysis , we now artificially split the differential operator acting on @xmath0 , so that we retrieve two advection equations .",
    "the radial advection part reads : [ sphedif ] + = 0 .",
    "this is a first order equation , associated to an evolution with velocity @xmath94 .",
    "it propagates from the inner region of the shell to the outer one if @xmath95 ( @xmath96 ) . on the contrary ,",
    "it propagates from the outer region to the inner one if @xmath97 .",
    "consequently , in our geometrical setting , an inner boundary condition at @xmath98 has to be imposed for @xmath99 ( incoming flux ) and an outer condition at @xmath100 for @xmath101 ( re - entering flux ) .",
    "if we now consider the second advection term [ advecthe ] - = 0 , the analysis is here simpler : propagation occurs always from @xmath102 to @xmath103 in the computational domain .",
    "however , the vanishing of @xmath104 at @xmath105 shows a degenerate behaviour at this point : no advection in @xmath62 occurs , therefore no boundary treatment is needed .",
    "+ coming back to the full eq.([sphersy ] ) , it is now expected that regularity issues in the numerical solution will arise as regular if it is of class @xmath106 with @xmath107 large enough to have a fast convergence in the spectral expansion . ] across the surface @xmath108 , due to different radial advective directions on both sides .",
    "for example , a boundary condition value for @xmath0 can be freely set to f(t , r_1 , ) = a , a , whereas the values @xmath109 are advected from the computational domain and therefore uncontrolled . to overcome the numerical problems",
    "associated with this behaviour , we split our computational domain ( here , a spherical shell ) into two angular domains @xmath110,\\theta \\in[0 , \\frac{\\pi}{2 } ] ) $ ] and @xmath111,\\theta \\in[\\frac{\\pi}{2 } , \\pi ] ) $ ] ( see fig .",
    "[ f : dom2d ] ) . to ensure particle number conservation across the two domains",
    ", we must enforce continuity of the flux on @xmath112 .",
    "this provides us with an incoming boundary condition in @xmath62 to impose for the solution @xmath0 in @xmath113 .",
    "we present below specific tests related to the spectral resolution of the ( homogeneous or not ) transport equation .",
    "as outlined above , our computational grid covers a physical shell @xmath114 split into two domains @xmath115 $ ] and @xmath116 $ ] . a typical value for our domain size is @xmath117 .",
    "unless otherwise stated , spectral decompositions are performed using a chebychev representation on the @xmath3,@xmath62 and @xmath25 direction , whereas a fourier decomposition is performed for the remaining angular dependencies @xcite .",
    "time evolution is handled using an explicit second - order adams - bashforth method and is performed in the coefficient space , using tau methods for the imposition of boundaries ; however , we also experimented with implicit resolution for the coherent scattering problem in spherical symmetry ( using tau - like methods for operator inversion in the configuration space ) and did not run into any particular issue related to this approach .",
    "we assume our domain to be filled by a uniform plasma of constant density @xmath118 , which at first is interacting with our radiating particles only through coherent scattering . absorption and emission are disabled ( which ensures particle number conservation during the computation ) and we start with the artificial initial condition for the distribution function : @xmath119 taking advantage of the properties of the liouville operator described in eq .",
    "[ prop2 ] , we know that at any time of the computation , @xmath120 . monitoring the numerical validity of this property is another way to assess accuracy of our approach .",
    "norm of the non - isotropic terms in the spectral decomposition of the distribution function : this is computed as the ratio between the coefficient of the constant ( isotropic ) term in the decomposition , rescaled to the sum of all other coefficients .",
    "this serves as a reliable marker for the isotropisation process in the evolution.,scaledwidth=60.0% ]    fig  [ f : istro4 ] presents particle conservation for this setting over time .",
    "the slow drift we encounter only occurs at the level of computer roundoff .",
    "we consistently obtain a relative error in particle number count smaller than @xmath121 in double precision , on timescales much larger than the dynamical timescale of the simulation .",
    "the isotropisation process of the distribution function due to coherent scattering is also displayed on fig  [ f : istro6 ] .",
    "for those results , the number of points used is @xmath122 .",
    "a resolution time step takes about 20 seconds in cpu time .    using the same initial spatial profile for the distribution , we now allow for energy dependence and non - coherent scattering by implementing the energy - dependent source terms set in eq .",
    "( [ transpfp ] ) .",
    "the initial energy distribution is set to be a black body one , at a temperature half the one of the plasma ( @xmath123 in our units ) .",
    "conservation of the number of photons ensures that @xmath0 will approach a bose distribution ( see eq .",
    "( [ bose ] ) ) over time . using @xmath124 points in the energy dimension",
    ", a computational time step takes about 33s .    in fig .",
    "[ f : fokker3 ] we can observe the transition made from the initial energy distribution to the final one , and appreciate the possible observation of a low - energy condensation that is accessible even with a very limited number of points .",
    "it is obvious that a specific treatment of the low energy regime ( by allocating a specific spectral decomposition domain to this region , and increasing the degree of spectral decomposition ) would be necessary to study such an effect quantitatively ; however , the goal of this work is only to convince oneself that such study is , indeed , possible with limited computational resources .    [ cols=\"^,^,^ \" , ]     we have found experimentally that a value of about [ deltopt ] t_opt= ( r_2-r_1 ) gives the best results , as shown in fig .",
    "[ f : spvsfd ] .",
    "the above value seems quite independent on the number of spectral radial points : it holds for @xmath125 in this particular problem . on the contrary",
    ", we have observed that a second order scheme of the type : [ advec3 ] ^j+1 + = ^j - leads to an incorrect propagation velocity .",
    "+ in order to compare the results obtained with the first order finite difference scheme and the spectral one , we plot the values for the derivative @xmath126 ( see fig .  [",
    "f : spvsfd ] ) .",
    "we recover similar results for the amplitude of derivatives when the grid point number ratio between the finite differences scheme and the spectral one is about five ( 330 points versus 65 ) .",
    "the size ratio mentioned in the introduction seems then to be verified .        finally , fig .",
    "[ f : conssimple ] shows the error on the conservation of particles for this scheme , namely the verification of the identity : [ photcons ] _ r_1^r_2 ( r , t ) dr + c ( ( r_1,t)-(r_2,t ) ) = 0 .",
    "the above simple and fast algorithm seems indeed to be able to handle correctly the discontinuities in the solution , keeping conservative features at the same time .",
    "it is tempting to apply it in solving the eq.([speccons ] ) .",
    "let us write this equation in the following effective way : [ specon2 ] ^j+1_k-_k t= ^j_k + t s_k^j+1/2 where @xmath127 , @xmath128 is the value of the discretised variable @xmath62 , and @xmath129 contains all differential terms on @xmath130 , taken on the same values , appearing in eq .",
    "( [ speccons ] ) .",
    "the coefficient in front of @xmath131 depends on the variable @xmath62 . as a consequence",
    ", we can not _ a priori _ define a consistent optimal value @xmath132 for every value of @xmath62 as in eq.([deltopt ] ) .",
    "moreover , we want to be free in choosing the value of @xmath133 , which will in general be constrained by a courant stability condition , either related to the transport equation itself or an adjacent hydrodynamic scheme .",
    "we proceed then in the following way : consider first an time explicit version of eq .",
    "( [ specon2 ] ) : [ specon3 ] ^j+1 = ^j_k + _ k t + t s^j_k .",
    "this can be viewed as a set of @xmath134 equations , where terms are evaluated for each value of the discretized angle @xmath135 .",
    "we define for each of those angles an optimal time step : [ e : dtopt ] t_opt^k= ( r_2-r_1 ) .    if @xmath136 , we compute the variation [ e : fdtopt ] g_k^j(t)=_k(t_j+t_opt^k)- _ k(t_j ) = t_opt^k_k .",
    "a simple linear interpolation is then performed to obtain the updated value for @xmath137 : [ interp2 ] ( r , _ k , t_j+t ) = ^j+1_k= ^j_k+ g_k^j _ k + _ ts^j_k .    the case @xmath138 is treated by introducing an intermediate time interval [ gedelta ] t_int^k = t /k t_opt^k , where @xmath139 is the smallest integer satisfying the above relation , and performing the numerical integration @xmath139 times per global time step .    in the implicit",
    "setting of eq .",
    "( [ specon2 ] ) and with @xmath136 , we slightly correct the previous scheme by defining :    g_k,^j(t_j)= t_opt^k_k + ( t_opt^k)^2 , where the real parameter @xmath140 is tuned in the algorithm so that the partial update    = ^j_k+ g_k , ^j _ k satisfies exactly a radial flux balance for particle number . the update is completed by the implicit first - order step ^j+1_k = ^j+1*_k + t s^j+1_k .    the case @xmath138 is also performed by splitting time updates as in eq .  ( [ gedelta ] ) .    ) .",
    "the number of spectral points is @xmath141 .",
    ", with two finite difference zones of 30 radial grid points at the edges .",
    "the error is mainly due to the differential term on @xmath62 .",
    "it decreases exponentially when the number of grid points in @xmath62 increases.,scaledwidth=60.0% ]    in solving the eq.([speccons ] ) in the domain represented in fig .",
    "[ f : dom2d ] , strong oscillations due to discontinuities may appear near the edges of the interval , if the plasma density there does not vanish ( see section 5.2 and fig .",
    "[ f : adv ] ) .",
    "a spectral resolution is in principle not able to handle these oscillations . to overcome this problem ,",
    "we have split the interval in 3 sub - intervals , two of them being close to the radial edges of the main interval , and each outer sub - interval having a width of @xmath142 of the main interval .",
    "the solution in the sub intervals is computed with a finite difference scheme , using @xmath143 grid points .",
    "the solution in the largest central interval is computed with the spectral scheme presented just above , using @xmath144 spectral points and again performing an expansion on a chebychev polynomial basis.a chebychev polynomial expansion is also , as before , used to treat the @xmath62 dependence .",
    "results on fig .",
    "[ f : constrans ] show the conservation of the number of particles using this approach , with the settings of section 5.2 .",
    "this shows the validity of our scheme in the bulk and at domain boundaries , and the accuracy of the conservative formulation in this 2d example .",
    "once known @xmath145 , the distribution function @xmath0 is recovered easily by manipulating the coefficients in the spectral decomposition ; the division by @xmath104 is nicely handled in the coefficient space , whereas the division by @xmath3 is performed in the configuration space .    in conclusion ,",
    "treating the transport equation with a fully spectral code is not straightforward . in the above ( hybrid )",
    "example in the radial direction , the simulation requires a total of @xmath146 grid points in @xmath3 . as shown previously , in order to obtain the same accuracy with a first order finite scheme , a rough number of @xmath147 grid points would be necessary .",
    "this leads to a size ratio of @xmath148 , two times less than previously expected .",
    "it is possible that the advantage of a spectral scheme reduces with more sophisticated higher order finite differences schemes .",
    "however , to match the performances of the presented approach , such a scheme should be of order 2 or more , exhibit weak diffusivity and show no oscillations due to discontinuities .",
    "the aim of this numerical work was to assess a `` proof of principle '' for the treatment of the full transport equation in 6d spherical coordinates in a single core processor , in reasonable physical and computational situations , and by means of the use of spectral methods in phase space .",
    "a particular setting of the computational grid is necessary for treating singular behaviour of some terms in the liouville operator .",
    "meaningful numerical results are obtained in a very reasonable computational time , the most time consuming operation being the computation of the liouville operator . for problems where fokker - planck - like approximations can not be used , it is possible that the most consuming computation would be related to the collision term , in which the thermal distribution of the plasma has to be taken in to account .",
    "( see eq.([liouvsph ] ) .",
    "we believe that spectral methods are suited to build an efficient algorithm for the treatment this problem .",
    "we have also seen that the use of a fully spectral scheme in treating the advection term can turn out to be useful if reduction of the cpu .",
    "time is a priority .",
    "we believe that by using fairly reasonable parallel computation on a small - scale cluster , one would be able to perform multiple runs in physically relevant 6-dimensional settings and in a really quick fashion .",
    "although we are aware of the fact that several ingredients are still to be added to the transport description to use it in a physically relevant radiation hydrodynamics code , our results support the fact that no fundamental technical difficulty should arise in tackling those issues .",
    "we wish to thank eric gourgoulhon , jrome novak and micaela oertel for the many fruitful discussions during the development of this method . n.v . acknowledges the support of the swiss national science foundation under the grant no pp002 - 106627/1 , and of the french anr grant 06 - 2 - 134423",
    "entitled `` mthodes mathmatiques pour la relativit gnrale '' .",
    "we will concentrate here on the pure coherent scattering case of transport equation for photons , which writes : [ cohersp ] + l_sph f + _ t f - _ 4 _ d ( ^ ) ^ d ^=0 .",
    "the above equation can be written , after multiplication by the element volume of the space of phase @xmath149 as [ cohercons ] ( f r^2 ) + ( f r^2 ) + ( f r ^2 ) - ( f r ^2 ) + ( f r ^2 ) - ( f r ^2 ) + r ^2 ( _ t f - _ 4 _ d ( ^ ) f ^ d ^ d ^  ) = 0 . after an integration on @xmath150 , and provided the detailed balance condition  @xcite [ dbc ] _ d ( ^  , ^ ) = _ d ( ^ , ^ ) holds , we obtain [ cons ] + j_r_2-j_r_1 = 0 , where [ npho ] n= _ r_1^r_2 r^2 dr _ 4 d d _ 4 d f is the number of particles and [ flux ]",
    "j_r_2 = r_2 ^ 2 _ 4 d d _ 4 d d f(t , r_2 , , , , ) is the flux of ingoing ( outgoing ) particles into the surface @xmath151 of the spherical shell @xmath152 .",
    "the same definition holds for @xmath153 with respect to the radius @xmath154 .",
    "this is a conservative form of the transport equation  ( [ cohersp ] ) .    in the general case when energy dependence is taken in to account",
    ", the photon number conservation is obtained after integration on the energy @xmath155 . if induced scattering processes are also considered , the conservation equation eq  ( [ cons ] ) is obtained thanks to the detailed balance condition ( [ dbc ] ) .",
    "bonazzola ,  s. , gourgoulhon ,  e. and marck , j.  a. , spectral methods in general relativistic astrophysics , j. comp .",
    "app . math . *",
    "109 * , 433 - 473 ( 1999 ) .",
    "canuto , c.  , hussaini , m.  y.  , quarteroni , a.   and zang , t.  a.  , spectral methods in fluid dynamics , ( springer verlag , berlin , germany ; heidelberg , germany , 1988 ) .",
    "mueller , b.  , janka , h - th .   and",
    "dimmelmeier , h .  , a new multi - dimensional general relativistic neutrino hydrodynamics code for core - collapse supernovae .",
    "i. method and code tests in spherical symmetry , apjs * 189 * , 104 ( 2010 ) ."
  ],
  "abstract_text": [
    "<S> we present a numerical method for handling the resolution of a general transport equation for radiative particles , aimed at physical problems with a general spherical geometry . having in mind the computational time difficulties encountered in problems such as neutrino transport in astrophysical supernovae </S>",
    "<S> , we present a scheme based on full spectral methods in 6d spherical coordinates . </S>",
    "<S> this approach , known to be suited when the characteristic length of the dynamics is much smaller than the domain size , has the potential advantage of a global speedup with respect to usual finite difference schemes . </S>",
    "<S> an analysis of the properties of the liouville operator expressed in our coordinates is necessary in order to handle correctly the numerical behaviour of the solution . </S>",
    "<S> this reflects on a specific ( spherical ) geometry of the computational domain . </S>",
    "<S> the numerical tests , performed under several different regimes for the equation , prove the robustness of the scheme : their performances also point out to the suitability of such an approach to large scale computations involving transport physics for mass less radiative particles .    transport equations , radiative astrophysics , spectral methods 02.70.hm , 95.30.qd , 13.15.+g </S>"
  ]
}