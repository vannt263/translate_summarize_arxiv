{
  "article_text": [
    "_ doppler imaging _ is a method that allows to reconstruct the stellar surface structures from the rotational modulation of spectral line profiles ( e.g. piskunov &  rice 1993 ) .",
    "iterative process_. on each iteration the observational data ( spectra taken at different rotational phases ) are computed for the current surface distribution at each observed wavelength @xmath0 and rotational phase @xmath1 .",
    "this is done by integrating the specific intensity @xmath2 over the visible hemisphere .",
    "* @xmath2 must be computed at each iteration for each @xmath0 , @xmath1 , and surface element @xmath3 in a spectral range large enough to accommodate rotational doppler shifts*. therefore , spectral synthesis of specific intensities is the most time consuming part of any di algorithm !    with the improvement of computer performance and the expansion of the di applications the need for a new rt became obvious as other solutions ( e.g. tables of pre - computed local profiles ) have been exhausted .",
    "the goal of a magnetic di code is to image the abundance ( or temperature in case of late - type stars ) together with the magnetic vector  4 maps in total to be reconstructed simultaneously .",
    "three algorithms for rt solver in the presence of magnetic field have been considered : runge - kutta , feautrier and diagonal element lambda operator ( delo ) .",
    "all three methods have been suggested and implemented by several people and detailed descriptions can be found in landi deglinnocenti ( 1976 , runge - kutta ) , auer et al .",
    "( 1977 , feautrier ) , and rees et al .",
    "( 1989 , delo ) .",
    "we strongly recommend those papers to anybody who wants to find out specific details about or implement any of these algorithms .",
    "below we give a short outline of the magnetic rt problem and we describe the relevant properties of each algorithm .",
    "the magnetic rt problem is a first order system of ordinary differential equations : @xmath4 where @xmath5 is the vector of stokes parameters , @xmath6 is the limb angle , @xmath7 is the total absorption matrix and @xmath8 is the total emission vector : @xmath9 where @xmath10 and @xmath11 are the continuum and line opacity and @xmath12 and @xmath13 are the continuum and line source functions . assuming no polarization in the continuum and lte at the continuum formation depth , @xmath12 is equal to the planck function @xmath14 .",
    "we note for later use that the diagonal elements of the absorption matrix are dominant , which provides the basis for the delo algorithm .",
    "the zeeman splitting depends on the strength of the magnetic field and the land factors of @xmath15- and @xmath16-components .",
    "the amplitude of the stokes parameters depends on the orientation angles of the magnetic vector ( the angle @xmath17 between the magnetic vector and the line of sight , and the position angle @xmath18 ) via the absorption coefficients @xmath1 s and anomalous dispersion coefficients @xmath19 s .",
    "@xmath19 s are responsible for magneto - optical effects .",
    "the relation of @xmath1 s and @xmath19 s to the line profiles of the zeeman components is given by :    @xmath20               \\sin^2\\gamma\\cos 2\\chi \\nonumber \\\\ \\phi_u & = & \\frac{1}{2}[\\phi_p-\\frac{1}{2}(\\phi_r + \\phi_b ) ]               \\sin^2\\gamma\\sin 2\\chi \\nonumber \\\\",
    "\\phi_v & = & \\frac{1}{2}(\\phi_r - \\phi_b ) ] \\cos\\gamma \\\\ \\psi_q & = & \\frac{1}{2}[\\psi_p-\\frac{1}{2}(\\psi_r + \\psi_b ) ]               \\sin^2\\gamma\\cos 2\\chi \\nonumber \\\\ \\psi_u & = & \\frac{1}{2}[\\psi_p-\\frac{1}{2}(\\psi_r + \\psi_b ) ]               \\sin^2\\gamma\\sin 2\\chi \\nonumber \\\\ \\psi_v & = & \\frac{1}{2}(\\psi_r - \\psi_b ) ] \\cos\\gamma \\nonumber\\end{aligned}\\ ] ]    where indices p , b , r stand for @xmath15-components and _ blue _ and _ red _ @xmath16-components .",
    "the wavelength dependence of @xmath21 , @xmath22 , and @xmath23 are given by the voigt function @xmath24 while @xmath25 , @xmath26 , and @xmath27 are proportional to the faraday - voigt function @xmath28 .",
    "humlek ( 1982 ) gives very fast and accurate complex approximation for @xmath24 and @xmath28 .",
    "we have implemented it as fortran and c routines and compared it to a number of other approximations .",
    "we found humlek s approximation to be the best .",
    "runge - kutta techniques for solving the radiative transfer equations ( [ eq : rt ] ) integrate the stokes parameters from the bottom of the atmosphere where an initial condition is set . a detailed description of the algorithm and its computer implementation ( the malip code ) has been given by landi deglinnocenti ( 1976 ) .",
    "he also analyses the main problems of the techniques .",
    "the advantage of runge - kutta is that the accuracy of the integration is checked at every step , so one can set the required accuracy _ a priori_. we would also like to point out that the rt equation is one of a few rare cases where the 6th order runge - kutta offers substantial advantage over the conventional 4th order scheme because the accuracy can be checked without refining the step size .",
    "the main disadvantage is that different parts of the right hand side have a different depth dependence , and in order to achieve high accuracy , the algorithm is forced to use very small steps even deep in the atmosphere . to summarize : _ the runge - kutta technique is accurate but slow .",
    "it is primarily useful as a reference for other methods . _",
    "now we shall turn to finite differences integration techniques which are more promising in terms of speed .",
    "the feautrier method for solving the rt equation operates by splitting the intensity into two beams directed oppositely .",
    "the resulting equation is a second order ode with two boundary conditions ( one at the bottom and one at the surface of the atmosphere ) . since the finite difference approximation involves 3 adjacent points for each step the method has excellent convergence properties .",
    "application of the feautrier method to non - magnetic rt requires the solution of a system of linear equations that form a tri - diagonal matrix .",
    "although the accuracy can not be checked at each step and the properties of the residual errors are much more complex than in the case of runge - kutta , refining the depth grid generally leads to a fast convergence and an accurate result .",
    "the feautrier method has been extended to handle magnetic rt by auer et al .",
    "in that case the tri - diagonal matrix is replaced by a block tri - diagonal , where each block is a 4@xmath294 matrix .",
    "the equations can be solved by analogy with the non - magnetic case , but back - substitution requires lots of 4@xmath294 matrix inversions and multiplications .",
    "the net result is a significant accumulation of numerical errors . for the centers of zeeman components where",
    "the voigt function is maximal and the faraday - voigt function is close to zero the difference between diagonal and non - diagonal elements in the absorption matrix reaches several orders of magnitude and with all the inversions , multiplications , and subtractions this scheme is bound to be numerically unstable .",
    "the alternative is to treat the block tri - diagonal matrix as a band diagonal matrix .",
    "the band should include 15 diagonals in order to cover all the blocks .",
    "the resulting scheme is robust against numerical errors for the price of only 20% degradation in speed .",
    "comparison with runge - kutta shows that for the same conditions , the feautrier rt solver is about 30 times faster if the required accuracy is 10@xmath30 .",
    "that is not quite fast enough for mdi , as the typical disk integration procedure requires approximately 10@xmath31 surface elements and the magnetic rt equation must be solved for each of them at several rotational phases .",
    "twelve years after the formulation of magnetic feautrier algorithm , rees et al .",
    "( 1989 ) proposed a lambda operator methods serving as a one  way magnetic rt integrator .",
    "it is based on the fact that the absorption matrix is dominated by its diagonal elements .",
    "the principle can be easily illustrated in the non - magnetic case , but the delo method is most impressive when integrating stokes parameters .    in the non - magnetic case",
    "we can write the formal solution of the rt equation connecting the intensities at optical depths @xmath32 and @xmath33 : @xmath34 where @xmath35 is the source function .",
    "if we assume that the source function in our depth interval is linear in @xmath36 and can be expressed as @xmath37/   ( \\tau_{k+1}-\\tau_{k})$ ] , then the integration in equation ( [ eq : delo ] ) can be performed analytically and we obtain a recurrence relation of the type : @xmath38 with a boundary condition at the bottom of the atmosphere .",
    "generalization to the magnetic case is straightforward .",
    "after we implemented this method , we found it to be free of numerical instabilities and about 6 times faster than the feautrier method ( both are a direct result of much fewer matrix inversions ) . on the down side",
    ", we found that the convergence properties of the delo method are not as good as for feautrier ( not surprising as the latter is a second order finite difference method ) , and it takes a much finer grid ( 4  8 times smaller step - size ) to reach an accuracy of about 10@xmath30 , thereby compromising the integration speed . after extensive experiments , we noticed that an adaptive depth grid can remedy the problem .",
    "the convergence is determined by the validity of linear approximation to the source function as described earlier in this section .",
    "it is much more efficient to refine the grid in the places where the source function variation is far from linear rather then adding extra points everywhere in the grid .",
    "once implemented , this techniques proved to a be a winner .",
    "it usually takes as little as 20% of additional grid points to reach the accuracy of 10@xmath30 . _",
    "delo with adaptive refinement of the depth grid is the fastest technique with good numerical stability and convergence properties_.",
    "with the new powerful magnetic rt solver based on the delo method , we are able to compute local stokes profiles `` on the fly '' rather than pre - calculating the interpolation tables . for each rotational phase , our new mdi code computes the specific intensity ( stokes ) profiles for the local magnetic field and local chemical composition , and derivatives with respect to field components ( radial , and the two tangential ) and the abundance : @xmath39 , @xmath40 , @xmath41 , and @xmath42 .",
    "the disk integration of the flux profiles takes into account the rotational doppler shifts and the radial - tangential macroturbulence . after disk integration the discrepancy and the regularization functions",
    "are computed together with the gradient vector .",
    "we use a modified conjugate gradient procedure to improve the solution .",
    "the modification makes use of the gradient vector during 1d optimization , since the gradient vector is computed with very little effort whenever the discrepancy function is evaluated .",
    "the overall procedure is efficient enough to reach a convergence for a typical size mdi problem ( 10 spectral lines , 100 wavelength points , 20 rotational phases ) in 20 - 30 cpu hours on a fast workstation ( an hp  9000 c-180 in our case ) with about 15 minutes per function evaluation .",
    "numerical experiments offer the best way to assess the reliability of an inverse code .",
    "we start with an artificial star with known surface structure , compute a set of `` observed '' profiles , and then use them as input data for the inversion . below we show the results of 3 such experiments with invers10 . in all cases",
    "we have used a rather typical feii 6141    line , which has a zeeman pattern with 6 @xmath15 and 10 @xmath16 components .",
    "the effective land factor is 1.5 .",
    "the `` observed '' profiles were computed for 20 equispaced rotational phases on a very fine surface grid using the feautrier algorithm .",
    "the simulated profiles have been broadened by the instrumental profile corresponding to the resolving power of 80000 and mixed with random noise corresponding to s / n of 300 for @xmath43 and 1000 for @xmath44 , @xmath45 , and @xmath46 .",
    "the @xmath47 of the star was set to 30  kms@xmath48 with an inclination @xmath49 of 45@xmath50 .",
    "those parameters have been also used in the inversion .",
    "@xmath51 ( in case of dipolar field ) = 90@xmath50 , abundance contrast is 2dex .    in the first experiment ( fig .",
    "1 ) we attempted to reconstruct the central dipolar field .",
    "the magnetic axis was tilted by 90@xmath50 from the rotational axis and the polar field was 8000 gauss .",
    "chemical composition was identical for every surface element .",
    "all four stokes parameters were used in the inversion .",
    "the initial guess had the correct chemical composition but zero field .",
    "figure  1 shows the results of successful reconstruction .",
    "the cross - talk between magnetic field and abundance map of iron is less than 0.005dex in the abundance map and less then 200  g in the magnetic map .    in the next experiment ( fig .",
    "2 ) we used the same test star , but only two stokes parameters ( @xmath43 and @xmath46 ) were used in the inversion .",
    "the result is shown in figure  2 .",
    "the reconstructed magnetic field differs significantly from dipolar ( most of the field vectors are directed along lines of constant latitudes in stellar coordinates , lower panel on fig .",
    "2 ) while the cross - talk reached the level of 0.5dex in the abundance map .    in the last experiment ( fig .",
    "3 ) two small spots of high ( + 2dex ) iron abundance were located at zero longitude with symmetrical placement relative to the equator .",
    "both spots have a radial magnetic field of 4000 gauss , but opposite polarity .",
    "the results , shown in figure  3 , demonstrate that 4 stokes parameters , even with very modest phase coverage ( as the spots are visible only in 10 phases ) , can be used to recover realistic field and chemical spot structures .",
    "although many more experiments will be required to investigate all the properties of the new code , even now it is clear that we can _ reliably reconstruct the vector magnetic field _ and that _ the observations of all four stokes parameters are required_. it is also clear that the mdi problem must be solved in a consistent way rather then by separately imaging magnetic field and abundance ( or temperature ) , since ( at least with incomplete observations ) one of the variables can successfully mimic the other ."
  ],
  "abstract_text": [
    "<S> the modern doppler imaging ( di ) technique allows the reconstruction of different stellar surface structures based on accurate calculation of spectra of specific intensity . </S>",
    "<S> new applications like the mapping of the magnetic field vector put very stringent requirements on the radiative transfer ( rt ) solver which should be accurate , fast , and robust against numerical errors . </S>",
    "<S> we describe the evaluation of three different algorithms for our new magnetic di code invers10 . </S>",
    "<S> we also show the first results of numerical experiments made with the new code . </S>"
  ]
}