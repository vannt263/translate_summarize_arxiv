{
  "article_text": [
    "rare events are physical events occurring with low probability in numerous many - body systems , encompassing a wide range of phenomena , from condensed matter physics to proteins : they often involve thermally activated processes , i.e. passages between different stable configurations of the system that are separated by free energy barriers . evaluating the frequency of these rare events from numerical simulations",
    "can be very time consuming , as the probability of observing one of these passages is very low : for instance , the migration of a vacancy in @xmath1-iron at 500k typically happens every microsecond , while the usual time steps for molecular dynamics is of the order of a few femtoseconds . in the last decades ,",
    "several techniques have been developed in order to accelerate the dynamics , and enhance the probability of observing infrequent events during a short simulation , based on importance sampling .",
    "@xcite    among these techniques , transition path sampling  @xcite ( tps ) allows to estimate the frequency of rare events by means of path ensemble averages of physical observables : reaction rates for appropriate time scales are indeed evaluated from the ratio of the number of reactive trajectories on the total amount of paths sampled .",
    "however , a sufficient number of reactive paths has to be observed , in order to obtain a reliable statistics .",
    "herein , we propose a transition path sampling algorithm where the fraction of reactive paths sampled is enhanced using an adequate bias that favors diverging trajectories .",
    "it is indeed possible to show  @xcite that reactive paths we want to sample share important features with diverging trajectories observed in chaotic systems .",
    "therefore , a suitable parameter that quantifies the divergence of dynamic trajectories can be exploited also to bias a path sampling algorithm aimed to reproduce reactive paths .",
    "the main instrument proposed in the literature to quantify chaotic behavior of dynamical systems is the evaluation of lyapunov exponents ,  @xcite that are usually employed to estimate the sensitivity of deterministic systems to small changes in initial conditions . for this feature ,",
    "they have been widely studied ,  @xcite both analytically and numerically , in hamiltonian as well as in nonlinear systems of small dimensions . moreover",
    ", the use of lyapunov exponents to characterize numerically phase transitions in finite size systems has been extensively explored in the past years , and many noticeable results have been obtained in the early 90 s .",
    "@xcite    resorting to lyapunov exponents in order to achieve numerical ergodicity and localize saddles and transition paths has been done recently with the lyapunov - weighted dynamics method proposed by tailleur and kurchan :  @xcite in this sampling scheme , a set of clones are copied or deleted depending on a probability weight computed from quantities related to lyapunov exponents .",
    "after this work , the paper of geiger and dellago  @xcite have shown how to couple the chaoticity features of a dynamical system to a tps technique for sampling deterministic trajectories , using an indicator for diverging trajectories borrowed from studies on planetary systems  @xcite , the relative lyapunov indicator ( rli ) .    in this paper , we present a chaoticity indicator different from rli , and based on local lyapunov numbers , that are quantities closely related to lyapunov exponents .",
    "this indicator is used to introduce a bias in the path sampling scheme , thus obtaining a lyapunov biased tps ( lytps ) method that will be in the sequel applied to complex many - body systems , like the well known optimization benchmark model lj@xmath0 .",
    "furthermore , we show how reaction rate constants can be recovered from biased tps quantities , resorting to an appropriate statistical analysis to unbias reaction rate values computed in a lytps framework .",
    "this paper is organized as follows . in sec .",
    "[ sec : lyapunov - exponents - in ] , we first recall the basic concepts of lyapunov exponents for dynamical systems . we will then briefly review the use that has been made of them in numerical algorithms to characterize phase transitions , or in importance sampling contexts .",
    "we then expose how to use local lyapunov numbers in the context of a transition path sampling to determine saddle points and reactive paths ( sec .",
    "[ sec : transition - path - sampling ] ) .",
    "reaction constants are computed from the fraction of reactive paths using the bennett - chandler approach @xcite of population correlation functions and the standard tps technique @xcite ; we also explain how unbiased reaction constants are recovered from a lyapunov biased algorithm thanks to the multistate bennett acceptance ratio  @xcite ( mbar ) method ( sec .",
    "[ sec : reaction - rate - constants - calculation ] ) .",
    "finally , numerical results concerning the application of our method to solid - solid structural transition in lj@xmath0 and vacancy migration in @xmath1-iron are presented ( sec .",
    "[ numerical results ] ) .",
    "we briefly present here the theory of lyapunov exponents , mainly following ott @xcite ; then we propose a formulation allowing the use of these exponents in importance sampling techniques .      in numerical applications ,",
    "dynamics are discrete : the evolution of state vector @xmath2 at time step @xmath3 is described by a _ mapping _",
    "@xmath4 , where @xmath5 is a matrix expressing the system evolution from one time step to the following .",
    "let the system be at time @xmath6 in an initial position @xmath7 , and let @xmath8 be a small perturbation applied to this initial state .",
    "the dynamics of such a perturbed system can then be denoted using a new state vector @xmath9 , whose time evolution will be @xmath10 for a sufficiently small perturbation @xmath11 , it is possible to linearize the map @xmath5 as @xmath12 the time evolution of a small perturbation to the initial state vector then reads  @xcite @xmath13 where @xmath14 is the jacobian matrix of the map @xmath5 . inserting particular solutions @xmath15^{n}$ ] in eq .  , one finds an eigenvalue equation @xmath16 in the discrete case , the eigenvalues @xmath17 of @xmath18 , solutions of eq .  ,",
    "are called _ lyapunov numbers _ rather the lyapunov exponents , and trajectories are _ unstable _ for @xmath19 and stable otherwise .",
    "the largest eigenvalue @xmath20 will be associated to the eigenvector @xmath21 indicating the direction of maximal growth of the perturbation @xmath11 .",
    "we introduce the matricial product @xmath22 between the jacobian matrices of the hamiltonian map at successive time steps , and we express the perturbation at time step _",
    "n _ with respect to the initial perturbation @xmath8 as @xmath23 defining with @xmath24 the euclidean norm of @xmath8 in phase space , the _ lyapunov exponents _",
    "@xmath25 , given the initial condition @xmath7 and the initial perturbation orientation @xmath26 are @xmath27 for _ n_-body hamiltonian systems , having _",
    "3n _ degrees of freedom , @xmath28 is a _ 6n_-dimensional state vector accounting for both the positions and momenta of the @xmath29 particles .",
    "for the _ 6n_-dimensional hamiltonian map there will be _",
    "6n _ lyapunov exponents , usually ordered in literature from the largest to the smallest ( @xmath30 ) .",
    "as stated in ref .",
    "@xcite , oseledec s multiplicative ergodic theorem @xcite guarantees the existence of the limits used in the definition of the lyapunov exponents in eq .   under very general circumstances .",
    "the lyapunov exponents are related to the aforementioned lyapunov numbers as @xmath31 $ ] . from eq .",
    ", we can also define _ finite - time lyapunov exponents _ :",
    "@xmath32 for long enough times , the greatest lyapunov number @xmath33 will give the dominant contribution to the perturbation evolution , and the associated eigenvector @xmath34 indicates the direction of maximum growth of the perturbation @xmath11 .",
    "we stress here that finite - time lyapunov exponents are calculated for a given @xmath7 and that , strictly speaking , their values do depend on the initial orientation @xmath35 .",
    "it is however shown that the largest exponent @xmath36 is approximately independent of the choice of @xmath35 in hamiltonian ergodic systems@xcite , while the complete spectra of finite - time exponents can be determined using specific numerical techniques .",
    "@xcite    in numerical simulations , only finite - time lyapunov exponents can be estimated , due to limited amount of cpu time .",
    "to evaluate @xmath37 from eq .",
    "we should compute the matricial product of eq .  . for systems with many degrees of freedom ,",
    "a calculation of this matrix product is not possible analytically , and is numerically expensive .",
    "the solution most followed in literature consists in directly evaluating the quantity @xmath38 given by the distance @xmath39 between two nearby dynamical trajectories , the first one started from the initial state @xmath7 and the second one from the perturbed configuration @xmath40 after _",
    "n _ time steps .    the use of eq .   as a mean to evaluate finite - time lyapunov exponents has two main drawbacks : the need of computing two trajectories to evaluate a single lyapunov exponent , thus doubling computational cost , and the fact that values obtained for @xmath41 can be sensitive to initial conditions , because of the dependence of the computed finite - time lyapunov exponents from the choice of the orientation of initial perturbation @xmath35 , as recalled above .",
    "several numerical strategies have been proposed to bypass these two problems .",
    "the tangent space method @xcite assigns to each state @xmath42 of the trajectory started in @xmath43 a vector @xmath44 .",
    "these vectors are computed from the local hessian matrix of the hamiltonian mapping , and their norms indicate the distance between the current trajectory and the perturbed one , i.e. @xmath45 . as these distances evolve exponentially ( see eq .  ) , the lengths of the vectors @xmath46 can quickly diverge or vanish : a reorthonormalization of @xmath46 at each time step is therefore required , for instance with a gram - smith algorithm .",
    "this method has been implemented in the literature  @xcite , for instance in the context of lyapunov weighted dynamics .",
    "@xcite to make this algorithm independent of the choice of the first vector @xmath47 , one could integrate the equations of motion backward in time from @xmath43 for a duration @xmath48 , and then reintegrate the evolution of @xmath44 forward until @xmath6(see ref .",
    "@xcite ) . in this way",
    ", @xmath47 would be automatically oriented in the direction of maximum growth .",
    "however , the duration @xmath48 should be long enough to ensure the loss of correlation between the orientation of @xmath49 and @xmath47 , thus requiring the computation of long trajectories at sustained computational cost .",
    "@xcite    another evaluation of finite - time lyapunov exponents can be obtained with the relative lyapunov indicator ( rli ) , elaborated by sndor _",
    "_  @xcite in the context of planetary trajectories , and further used in a lyapunov weighted path sampling scheme  @xcite .",
    "the main idea is to compare finite - time lyapunov exponents @xmath41 for trajectories starting very close , say in @xmath7 and @xmath50 .",
    "the difference between finite - time exponents at time step @xmath3 can be written as @xmath51 and will in general undergo strong fluctuation ,  @xcite which can be smoothed by an average over @xmath52 trajectory steps : in this way one defines the rli as the quantity @xmath53 this average over the entire trajectory length reduces @xcite the dependence of the computed finite - time lyapunov exponents on the orientation of initial perturbation , but introduces an additional dependence on @xmath54 .",
    "both finite - time lyapunov exponents are calculated evaluating the distance between two trajectories evolving close to each other ( instead of the matricial product of eq .  ): in terms of computational cost , four trajectories are computed to obtain a single rli .    in the following ,",
    "we propose a faster and orientation - independent way to evaluate the divergence of hamiltonian trajectories , alternative to tangent space method and rli , to be used in the path - sampling scheme described in sec .  [",
    "sec : transition - path - sampling ] .",
    "we restrict our focus to systems with deterministic dynamics governed by an hamiltonian @xmath55 .",
    "the time evolution of the state vector @xmath56 ( also indicated as `` hamiltonian flow '' @xcite ) directly follows from hamilton equations , @xmath57 the evolution of a small perturbation of positions and momenta for a standard hamiltonian is then given by @xmath58 where @xmath59 is the @xmath60 inverse mass matrix of elements @xmath61 .",
    "let us discretize the hamiltonian dynamics in eq .   with the velocity verlet",
    "algorithm : @xmath62 this algorithm is accurate to second order and numerically stable  @xcite",
    ". it will be used in sec .",
    "[ sec : transition - path - sampling ] to generate dynamical trajectories in numerical applications .",
    "the perturbation @xmath63 can be evaluated with respect to @xmath64 using eq .  , where the jacobian matrix of the hamiltonian mapping for a velocity verlet discretization reads  @xcite @xmath65\\right\\ } & \\mathbf{i}-\\frac{dt^2}{2m}\\mathbf{h}(\\mathbf{x}_{n+1})\\end{array}\\right]\\]]in the upper right and bottom left blocks we introduced the hessian matrix of the potential energy @xmath66 at states @xmath67 and @xmath68 , respectively .    the jacobian matrix of eq .   obtained with the velocity verlet scheme of eq",
    "contains the hessian matrices at steps @xmath3 and @xmath69 .",
    "therefore , manipulating @xmath14 is numerically expensive .",
    "a simpler expression for the jacobian matrix can be obtained from the less accurate euler discretization algorithm : eq .",
    "becomes a set of _",
    "6n _ coupled equations of motion @xmath70 where @xmath71 , so that the jacobian matrix of the hamiltonian map reads @xmath72.\\ ] ] again , the perturbation @xmath73 at each time step can be evaluated by inserting eq .   in eq .  .",
    "the difference between the jacobian matrix @xmath14 of eq .",
    "and the one of eq .",
    "consists in second order terms .",
    "however , it is numerically less expensive to manipulate the former than the latter , as @xmath14 of eq .",
    "requires to evaluate the hessian only at time step @xmath3 . in the following , we will be interested in computing the eigenvalues of @xmath14 , in order to obtain a bias favoring reactive trajectories : this bias will be removed at the end , so it would be useless to spend cpu time to accurately evaluate the jacobian matrix . therefore , accordingly to ref .",
    "@xcite , we consider the euler scheme ( eq .  ) precise enough for our purposes , and we use the first order euler discretization of eq .   to compute @xmath14 .      using the discretized hamiltonian dynamics given in eq",
    ", we proceed by computing at each time step the maximum local lyapunov number  @xcite , given by the largest eigenvalue of @xmath74 ( eq .  ) .",
    "the @xmath75 eigenvalues @xmath76 of @xmath74 , computed at time step @xmath3 , can be obtained writing eq .   as a secular equation @xmath77 whose solutions are @xmath78 pairs of eigenvalues @xmath76 of @xmath14 , because of the simplectic properties of the hamiltonian mapping matrix @xmath5 .",
    "@xcite these eigenvalues are given by the expression  @xcite @xmath79 where the @xmath80 correspond to the eigenvalues of the mass - weighted hessian @xmath81 of components @xmath82    eq .",
    "shows that at each time step @xmath3 the jacobian eigenvalues @xmath83 , i.e. the local lyapunov numbers , depend on the potential energy surface through the hessian eigenvalues @xmath80 : unstable configurations @xmath84 , such as saddle points are characterized by the occurrence of some negative @xmath80 , and correspond to real and positive local lyapunov numbers @xmath83 .",
    "conversely , stable states have all @xmath80 positive or imaginary local lyapunov numbers with unitary real part . in the following path sampling scheme of sec .",
    "[ sec : transition - path - sampling ] we neglect the imaginary part of @xmath83 given by stable states .",
    "this is not an issue because it is sufficient to determine real and positive lyapunov exponents to characterize unstable dynamics which we are interested in , and the imaginary part of the jacobian eigenvalues @xmath83 can be neglected . indeed , the imaginary part of the lyapunov exponents does not affect the stability of the system , but only indicates if @xmath85 is spiraling clockwise or counterclockwise .    at each time step @xmath3 ,",
    "the most negative eigenvalue of the hessian matrix @xmath86 gives the eigenvalue of the jacobian matrix @xmath14 with the largest real part .",
    "we write the maximum local lyapunov number as @xmath87 such that eq",
    ".   entails @xmath88 for stable configurations , where all @xmath89 are positive , and @xmath90 for unstable configurations having a negative spectra .",
    "eigenvalues @xmath91 are found by diagonalization of the hessian matrix @xmath92",
    ". this can be computationally very expensive for systems with a large number of degrees of freedom .",
    "one efficient solution consists in extracting only the lowest eigenvalue @xmath93 needed to evaluate @xmath94 using the lanczos algorithm @xcite .",
    "this iterative algorithm finds extremal eigenvalues of any matrix with a reduced computational cost , diagonalizing only a submatrix of the initial one ( see for example appendix a of ref .",
    "@xcite for details ) . as pointed out in ref .",
    "@xcite , a @xmath95 lanczos submatrix is sufficient to detect negative eigenvalues .",
    "moreover , it is possible to decrease the submatrix size to as little as @xmath96 by verifying at each iteration that the lanczos solution is stable ; if not , repeat the calculation until a the solution is converged .",
    "hence , the most negative eigenvalue , corresponding to the most unstable direction of the potential energy surface at a give system position in the phase - space at a given instant can be extracted in a very few iterations .",
    "this is the numerical method we will apply in the following to evaluate @xmath94 .",
    "a dynamical trajectory is defined as an ordered sequence of states in phase space separated by a small time increment @xmath97 , and denoted as @xmath98 , i.e. a path of total length @xmath48 composed by @xmath99 state vectors .",
    "we introduce a lyapunov indicator for path @xmath100 @xmath101 given by the average of the maximum lyapunov number of eq   over the whole trajectory .    the verification of the difference between finite - time lyapunov exponents estimated by rli or tangent space method and @xmath102 from eq .",
    "is beyond the scope of this article .",
    "we stress instead that the indicator proposed in eq .",
    ", being based on the hessian spectra @xmath89 , is strictly related to the topological properties of the potential energy surface , thus encodes local information on the stable or unstable configurations sampled in phase space by a given trajectory .",
    "henceforth , we consider this lyapunov indicator suitable for importance sampling techniques .",
    "the largest local lyapunov number of eq .   were evaluated by hinde _",
    "et al . _",
    "@xcite to study the dependence of the kolmogorov entropy on the potential energy surface of small lennard - jones clusters . in that work ,",
    "the lyapunov exponents derived from the eigenvalues of the jacobian matrix of the hamiltonian mapping are summed over trajectories of different lengths , thus obtaining - using pesin s theorem  @xcite - an estimation of kolmogorov entropy . using eq .   to evaluate finite - time lyapunov exponents",
    "was proven to be a quite successfull approach , as it yields enough information to quantify the degree of instability of phase space trajectories .",
    "this supports the idea that evaluating the global lyapunov exponent from local lyapunov numbers allow to correctly characterize the chaotic properties of the system .",
    "the idea of sampling the phase space of a many - body system through paths generated by molecular dynamics , using the metropolis algorithm , has been developed by dellago and coworkers .",
    "@xcite this approach is called transition path sampling ( tps ) . in this present work ,",
    "we introduce a bias in the tps algorithm in order to favor the sampling of reactive trajectories .",
    "the bias is proportional to the lyapunov indicator @xmath103 obtained in eq .  .",
    "each path @xmath104 constrained to start in a reactant basin a is equipped with a probability density @xmath105 where @xmath106 is the partition function on the biased trajectory ensemble , and function @xmath107 is an additional term linking the initial state @xmath7 of the path to state @xmath108 .",
    "different choices for @xmath109 are possible , for instance @xmath110 , where @xmath111 is an indicator function on a , such that @xmath112 or @xmath113 that accounts for having a tunable spring of stiffness @xmath114 linking the origin of path @xmath104 to state a. in this last case , the stiffness parameter @xmath114 can be tuned to counterbalance the strenght of the bias .",
    "we denoted in eq .   for simplicity @xmath115\\ ] ] as the dynamical path probability arising from the deterministic propagation of the trajectory .",
    "@xmath116 is the unnormalized canonical distribution at inverse temperature @xmath117 from which the initial configuration is selected , and @xmath118 is the _ temporal propagator _",
    "@xmath119 associated to the deterministic dynamics  @xcite .",
    "in this biased ensemble , choosing positive @xmath1 enhances the probability weights of trajectories with a large lyapunov indicator @xmath103 , favors via eq .   the sampling of reactive paths passing over saddles and unstable directions of the potential energy landscape .",
    "on the contrary , choosing negative @xmath1 mainly restricts the sampling of non reactive or regular trajectories within stable basins .    the distribution @xmath120 is approximated by a markov chain of _ m _ steps constructed by importance sampling , by means of the metropolis algorithm .",
    "the sampling is done in the following way : at markov chain step @xmath121 , starting from the current path @xmath122 , a trial path @xmath123 is generated with probability @xmath124 .",
    "then , the trial path is accepted with a probability @xmath125 and added to the markov chain as @xmath126 ; otherwise , if the trial path is rejected , @xmath127 . to ensure the convergence of the markov chain towards the equilibrium distribution @xmath128",
    ", we impose that the probability @xmath129 $ ] to transit from a path @xmath104 to a different path @xmath130 satisfies the detailed balance equation @xmath131\\pi\\left[\\mathbf{z}\\rightarrow\\mathbf{z}'\\right]=\\mathcal{p}^{\\alpha}_a\\left[\\mathbf{z}'\\right]\\pi\\left[\\mathbf{z}'\\rightarrow\\mathbf{z}\\right]\\ ] ] taking account of the generating and acceptance probabilities @xmath124 and @xmath125 , the transition probability @xmath132 reads @xmath133=\\sum_{\\tilde{\\mathbf{z}}}p_{gen}\\left[\\mathbf{z}\\rightarrow\\tilde{\\mathbf{z}}\\right]\\left\\{\\delta(\\tilde{\\mathbf{z}}-\\mathbf{z}')p_{acc}\\left[\\mathbf{z}\\rightarrow\\tilde{\\mathbf{z}}\\right]+\\delta(\\tilde{\\mathbf{z}}-\\mathbf{z})(1-p_{acc}\\left[\\mathbf{z}\\rightarrow\\tilde{\\mathbf{z}}\\right])\\right\\}\\ ] ] where @xmath134 is the delta distribution and @xmath130 is either the old path @xmath104 or the proposed path @xmath135 .",
    "the acceptance probability can be constructed from eqs .   and   as the metropolis acceptance @xmath136=\\min\\left\\ { 1,\\frac{\\mathcal{p}^{\\alpha}_a\\left[\\tilde{\\mathbf{z}}\\right]p_{gen}\\left[\\tilde{\\mathbf{z}}\\rightarrow\\mathbf{z}\\right]}{\\mathcal{p}^{\\alpha}_a\\left[\\mathbf{z}\\right]p_{gen}\\left[\\mathbf{z}\\rightarrow\\tilde{\\mathbf{z}}\\right]}\\right\\}.\\label{eq:11}\\ ] ] that is widely used in numerical simulations , as it has the main advantage of maximizing @xmath125 .",
    "the standard shooting algorithm for deterministic dynamics is obtained by ( i ) selecting a state @xmath137 of the current trajectory , ( ii ) perturbing the momenta of each particle , and then generating from this selected state two segments , one backward of duration @xmath138 and the other one forward of duration @xmath139 , in order to get a trial trajectory @xmath135 of same duration , ( iii ) accepting or rejecting the new trajectory @xmath135 . for deterministic dynamics",
    ", the total energy is constant .",
    "the perturbation step ( ii ) is done with the algorithm proposed by stoltz @xcite , where trial momenta @xmath140 are obtained from old momenta @xmath141 as @xmath142 where @xmath143 is a tunable parameter and @xmath144 is drawn from a gaussian distribution of variance @xmath145 .",
    "the probability of having trial momenta @xmath140 from old momenta @xmath141 with the stoltz proposal for shooting  @xcite is written as @xmath146 and ensures the detailed balance condition @xmath147 hence the probability flux between the current and perturbed momenta is balanced and the hamiltonian distribution is preserved .",
    "the probability @xmath148 $ ] of obtaining the shooting point @xmath149 for the trial trajectory from state @xmath137 selected in the current trajectory reads @xmath150=p\\left(\\mathbf{p}_{t'}\\rightarrow\\tilde{\\mathbf{p}}_{t'}\\right)\\ ] ] as only momenta are perturbed at the shooting point , while positions are left unchanged .    inserting eq .   in eq .   and",
    "neglecting numerical approximations in the integration from @xmath151 to @xmath152 ( that indeed give in computations @xmath153 ) we have the metropolis acceptance rule @xmath154=\\min\\left\\ { 1,\\frac{\\exp\\left\\ { \\alpha l(\\tilde{\\mathbf{z}})-\\beta \\mathcal h(\\tilde{\\mathbf{x}}_0)\\right\\}\\varphi_{a}^{\\alpha}(\\tilde{\\mathbf{x}}_{0 } ) p_{gen}[\\tilde{\\mathbf{x}}_{t'}\\rightarrow \\mathbf{x}_{t ' } ] } { \\exp\\left\\ { \\alpha l(\\mathbf{z})-\\beta \\mathcal h(\\mathbf{x}_0)\\right\\}\\varphi_{a}^{\\alpha}(\\mathbf{x}_{0})p_{gen}[\\mathbf{x}_{t'}\\rightarrow \\tilde{\\mathbf{x}}_{t ' } ] } \\right\\}\\ ] ] where terms deriving from the forward and backward generation of the current and trial path have cancelled because of the unit phase space compressibility of the newtonian dynamics ( see ref .",
    "@xcite for details ) .    using in eq .",
    "the property of the stoltz proposal ( eq .  ) and neglecting numerical approximations in the integration from @xmath151 to @xmath152 , eq .",
    "further simplifies in @xmath155=\\min \\left\\ { 1,\\exp\\left\\ { \\alpha l(\\tilde{\\mathbf{z}})-\\alpha l(\\mathbf{z})\\right\\}\\left[\\varphi_{a}^{\\alpha}(\\tilde{\\mathbf{x}}_{0})/\\varphi_{a}^{\\alpha}(\\mathbf{x}_{0})\\right ] \\right\\}.\\ ] ]      the second monte carlo move in trajectory space is based on the shifting algorithm , supplemented with a waste - recycling estimator .",
    "@xcite @xmath52 trial trajectories @xmath156 are constructed from @xmath100 as follows : the duration of the trajectory @xmath157 is doubled selecting a random duration @xmath158 and integrating two segments backward and forward , starting from @xmath7 and @xmath159 , along @xmath160 and @xmath161 time steps , respectively . adding these segments to the current trajectory , one obtains a `` buffer '' trajectory @xmath162 of total duration @xmath163 , containing @xmath164 possible trial paths .",
    "the conditional probability of obtaining the `` buffer '' trajectory @xmath165 starting from the current trajectory @xmath104 is indicated as @xmath166 .",
    "the probability weight of each trial path @xmath156 is then@xmath167 if a constraining function @xmath168 linking the initial state @xmath169 of each trial path @xmath170 trajectories to state a is used , as in eq .  .",
    "j _ runs over the _ @xmath164 _",
    "possible paths on the `` buffer '' trajectory .",
    "we introduce an action @xmath171 so as to rewrite the trajectory probability in the biased ensemble ( eq .  ) as @xmath172 we now define the selecting probability @xmath173 of selecting a trial trajectory @xmath170 from the buffer trajectory @xmath165 as @xmath174 where we introduced the rosenbluth factor @xmath175.\\ ] ] resorting to bayes theorem , @xmath176 can be written as the posterior likelihood probability  @xcite of having @xmath170 given the `` buffer '' trajectory @xmath165 : @xmath177 where @xmath178 is the conditional probability of constructing a `` buffer '' path @xmath165 from the trial path , and because of the deterministic dynamics @xmath179 .",
    "@xmath180 is the marginal probability associated with the buffer path : comparing eq .   with eq .",
    ", we see that @xmath181    let us now consider a monte carlo move between two paths both contained in the buffer trajectory @xmath182 , i.e. from the current path @xmath104 to @xmath170 , whose associated transition probability @xmath183 $ ] , as in eq .  , obeys a detailed balance with respect to the prior distribution @xmath120 : @xmath184\\pi\\left[\\mathbf{z}\\rightarrow\\tilde{\\mathbf{z}}_{j}\\right]=\\mathcal{p}^{\\alpha}_a\\left[\\tilde{\\mathbf{z}}_{j}\\right]\\pi\\left[\\tilde{\\mathbf{z}}_{j}\\rightarrow\\mathbf{z}\\right].\\ ] ] defining the transition probability @xmath185=p_{sel}(\\tilde{\\mathbf{z}}_{j}|\\mathbf{\\zeta})p_{cond}(\\mathbf{\\zeta}|{\\mathbf{z}})\\ ] ] the detailed balance in eq .",
    "can be recasted as @xmath186 where @xmath187 and @xmath188 is the probability to transit from @xmath170 to @xmath104 . as a consequence ,",
    "the shifting procedure leaves the probability distribution @xmath120 invariant . moreover , recalling that the deterministic dynamics entails @xmath189 , the detailed balance in eq .",
    "further simplifies into @xmath190    we conclude this section by extending the detailed balance of eq .   for trajectories",
    "@xmath104 and @xmath170 belonging to two _ different _ buffer paths @xmath182 and @xmath191 respectively . writing as in eq .",
    "expressions for @xmath192 and @xmath193 , and using these results in eq .",
    "we obtain @xmath194=p_{marg}^{\\alpha}(\\tilde{\\zeta})p_{sel}(\\tilde{\\mathbf{z}}_{j}|\\tilde{\\mathbf{\\zeta}})\\pi\\left[\\tilde{\\mathbf{z}}_{j}\\rightarrow\\mathbf{z}\\right]\\ ] ] eq .",
    "is indeed a detailed balance condition for the alternate shooting and shifting moves , and samples the buffer trajectories @xmath182 .",
    "this implies that the distribution @xmath195 is invariant along the sampling algorithm .",
    "@xmath195 is therefore suitable to be used as an input path probability weight required by the unbiasing algorithm mbar , that will be presented and used in the following sections .",
    "here we briefly recall how reaction rates are computed in the tps framework .",
    "the reactivity of the sampled paths is recovered by means of a time correlation function with respect to initial and final states of the paths : a trajectory is said to be reactive if it starts in the reactants a basin and ends in the products b basin .",
    "the time correlation function  @xcite is @xmath196 where brackets @xmath197 indicate averages taken over the equilibrium trajectory ensemble and the indicator function @xmath198 is defined as in eq .  .",
    "@xmath199 can be understood as the conditional probability of observing a trajectory of duration @xmath200 ending in state b , knowing that it started in state a  @xcite , and approaches its asymptotic value exponentially as @xmath201 where @xmath202 is the equilibrium occupation probability of state b , and the parameter @xmath203 is the characteristic reaction time of the system , given by the forward and backward reaction constants @xmath204 and @xmath205 , respectively .",
    "note that the basic assumption required to compute reaction rate constants of rare events from the correlation function @xmath199 is the presence of a well separated time scale for processes occurring between fast intra - funnel relaxation , having a typical time constant @xmath206 , and activated processes indicating passages _ between _ funnels , needing a much longer time scale , of the order of @xmath207  @xcite .    for times in the intermediate time regime @xmath208 ,",
    "the correlation function in eq .   can indeed be expressed by its first order expansion @xmath209 where the detailed balance condition @xmath210 has been used to eliminate @xmath202 .",
    "hence , the slope of @xmath199 for this intermediate time regime gives direct access to reaction rates .",
    "the reactive probability flux flowing from state a towards b per unit time , defined by @xmath211 , displays a plateau corresponding to the forward phenomenological reaction constant @xmath204 .",
    "@xcite    let us point out that these results , obtained with a macroscopic flux over population probability approach , can be recovered by a bennett - chandler formalism  @xcite , based on microscopic quantities ( positions and momenta , see ref .",
    "finally , we recall that the phenomenological forward rate constant @xmath204 computed from eq .",
    "is related to the rate @xmath212 given by the transition state theory ( tst )  @xcite @xmath213 where @xmath214 is the _ transmission factor _ , and @xmath212 reads @xmath215 with @xmath216 the height of the free energy barrier separating basins a and b , @xmath25 the planck constant and @xmath217 the inverse temperature .",
    "the transmission factor @xmath218 is always lower than one , and is introduced to take into account trajectories started in basin a that reach the saddle point but fall back to state a , instead of ending in state b : these occurrences are called recrossings events .",
    "the transmission coefficient usually reaches a steady value , depending on the temperature and the reaction coordinate chosen to localize the barrier . at this plateau value of @xmath219 , and",
    "the reactive flux corresponds to @xmath220 , always lower than the tst value .      in numerical experiments ,",
    "the computation of reaction constants by direct evaluation of @xmath199 at times longer than the intrafunnel relaxation time @xmath206 means performing very long molecular dynamics trajectories . to estimate @xmath199 in the tps framework",
    "computing relatively short trajectories , one resorts to a factorization of the correlation function in ( i ) a static quantity related to @xmath212 , thus dependent on the free - energy barrier and calculated through an umbrella - sampling technique , and ( ii ) a dynamic factor related to @xmath214 given by the time derivative of the probability of reaching basin b at times shorter than the whole trajectory length ( see for instance refs .",
    "@xcite )    we propose herein a variant strategy : reaction constants will be calculated directly by averaging indicator functions on short trajectories , as in eq .",
    ", once the fraction of reactive paths is significantly enhanced by introducing an appropriate bias favoring reactions between basins a and b.    the correlation function in eq .   can be intended as an average over all performed trajectories - i.e. over all successive steps _ m _ of the markov chain - of the _ reactivity _",
    "@xmath221 , defined as @xmath222 for an unbiased tps simulation , the probability @xmath120 of eq .   with @xmath223",
    "is sampled : we have @xmath224 , where brackets @xmath225 correspond to averages over a canonical trajectory ensemble , and the trajectory distribution of eq .",
    "ensures @xmath226 because of @xmath109 .    in a context of biased tps ,",
    "averages on markov chains are taken on the biased trajectory distribution , hence we denote biased averages of the correlation function as @xmath227 , where index @xmath1 accounts for the current bias . herein , index @xmath1 will indicate all observables obtained from a biased distribution , where @xmath223 stands for the equilibrium canonical ensemble average .",
    "we estimate the correlation function @xmath228 using an estimator denoted by @xmath229 , which consists in taking the average over the markov chain of lenght @xmath230 as @xmath231=\\frac{1}{m}\\sum_{m=1}^{m}\\mathcal{a}^{m}_{\\alpha}\\ ] ] @xmath232 denotes a reactivity value coming from a biased trajectory @xmath233 distributed according to @xmath120 .",
    "estimates given by @xmath234 are however not optimal  @xcite .",
    "a _ waste - recycling _ ( wr ) estimator  @xcite is associated to the multiple proposal sampler for the shifting move of sec .",
    "[ waste - recycling ] to obtain more accurate estimates .",
    "waste recycling consists in including information about all possible proposals contained in the buffer trajectory @xmath182 . the reactivity at markov chain step _",
    "m _ in a given ensemble @xmath1 has to be first averaged over the @xmath164 trajectories contained in the buffer path @xmath235 as @xmath236 } { \\mathcal{r}^{m}_{\\alpha}}=\\sum_{j=1}^{\\mathcal n}\\mathcal{a}^{m}_{\\alpha , j}\\varphi_{a}^{\\alpha}(\\mathbf{x}^m_{0,j})\\exp\\left[-s^{m}_{\\alpha , j}+s^{m}_{\\alpha}\\right]\\ ] ] where we write @xmath237 and define the rosenbluth factor @xmath238}\\ ] ] as proportional to the marginal probability @xmath239 of eq .  , associated to the `` buffer '' trajectory @xmath240 corresponding to markov chain step @xmath121 .",
    "correlation functions for reactive paths are therefore estimated in a way similar to eq .",
    ", with the wr estimator @xmath241=\\frac{\\sum_{m=1}^{m}\\sum_{j=1}^{\\mathcal n}\\mathcal{a}^{m}_{\\alpha , j}\\varphi_{a}^{\\alpha}(\\mathbf{x}^m_{0,j})\\exp\\left [ -s^{m}_{\\alpha , j}+s^{m}_{\\alpha}\\right]}{\\sum_{m=1}^{m}\\sum_{j=1}^{\\mathcal n}\\varphi_{a}^{\\alpha}(\\mathbf{x}^m_{0,j})\\exp\\left [ -s^{m}_{\\alpha , j}+s^{m}_{\\alpha}\\right]}=\\frac{1}{m}\\sum_{n=1}^{m}\\overline{\\mathcal{a}}^{m}_{\\alpha}\\ ] ] and again @xmath242 $ ] . the calculation of rate constants @xmath243 for the given @xmath1-ensemble follows from eq .  .",
    "a suitable unbiasing algorithm is needed in order to recover canonical ensemble correlation functions from reactivity values witnessed in a lyapunov biased path ensemble .",
    "the canonical equilibrium values of @xmath244 can in principle be obtained by estimating reactivities @xmath245 , computed in any @xmath1-biased path ensemble , resorting to an adequate unbiasing algorithm .",
    "we define an unbiasing wr estimator @xmath246 , where the left subscript @xmath247 indicates the ensembles in which we are interested in measuring averages , while the right subscript @xmath1 refers to the ensemble that our lyapunov biased tps will effectively sample .",
    "equilibrium values for @xmath244 ( @xmath248 ) are retrieved from reactivities computed in any @xmath1-biased ensemble as @xmath249=\\frac{\\sum_{n=1}^{m}\\sum_{j=1}^{\\mathcal n}\\mathcal{a}^{m}_{\\alpha}\\varphi_{a}^{\\alpha}(\\mathbf{x}^m_{0,j}){\\varphi_{a}^{\\alpha}}^{-1}(\\mathbf{x}^m_{0,j})\\exp\\left [ -s^{m}_{\\alpha , j}+s^m_{\\alpha}+s^{m}_{\\alpha , j}\\right ]   } { \\sum_{n=1}^{m}\\sum_{j=1}^{\\mathcal n}\\varphi_{a}^{\\alpha}(\\mathbf{x}^m_{0,j}){\\varphi_{a}^{\\alpha}}^{-1}(\\mathbf{x}^m_{0,j})\\exp\\left [ -s^{m}_{\\alpha , j}+s^m_{\\alpha}+s^{m}_{\\alpha , j}\\right]}\\ ] ] unbiasing the sampling consists of correcting for the bias @xmath250 $ ] .",
    "however , the variance associated to the unbiasing estimator in eq .   would be too large to consider estimates reliable  @xcite .",
    "this well - known fact results from the lack of overlap between the sampled and measured distributions .",
    "we therefore carry out a series of simulations for a set of @xmath1 values ranging from 0 to a maximum value @xmath251 so to ensure overlap between successive sampled distributions .",
    "our choice is then to use the multistate bennett acceptance ratio ( mbar ) instead of the estimator of eq .  .",
    "mbar is a method elaborated by shirt and chodera @xcite , which aims at minimizing the statistical variance associated to the estimates . following these authors",
    ", we briefly expose the principles of this procedure in a context of biased path ensembles . to use the mbar method in the waste - recycling framework of sec .",
    "[ rarecostbiased ] , we take as probability weights corresponding to a given @xmath1 ensemble at each markov chain step @xmath121 the marginal probability @xmath252 of eq .  .",
    "this is possible because , thanks to the detailed balance of eq .",
    ", @xmath195 is preserved .",
    "once one knows weights @xmath253}$ ] related ( via eqs .   and )",
    "to @xmath254 for each @xmath1-ensemble , reactivity averages @xmath255 for every ensemble @xmath256 can be computed resorting to the importance sampling identity @xmath257}\\right\\rangle _ { \\alpha}}{\\left\\langle \\mathcal{a}\\exp{\\left[-s_{\\alpha}\\right]}\\right\\rangle _ { \\alpha'}}=\\frac{z_{\\alpha'}}{z_{\\alpha}}\\label{eq:10}\\ ] ] where we used the partition functions @xmath258 } $ ] . for a set of _ k _ different values of the bias @xmath1 , a set ( namely , a markov chain ) of @xmath259 buffer trajectories are sampled for each bias value .",
    "an estimate of @xmath260 is given by the mbar estimator @xmath261 for the waste - recycling averaged reactivity @xmath262 of eq .",
    "as @xmath263=\\sum_{m=1}^{\\mathcal{m}_{\\alpha } } w_{m,\\alpha } \\overline{\\mathcal a}^m_{\\alpha}\\ ] ] where weights @xmath264 are given by the expression @xmath265}}{\\sum_{k=1}^{k}\\mathcal{m}_{k}\\hat{z}_{k}^{-1}\\exp{\\left[-s_{\\alpha}^m\\right]}}.\\ ] ] and @xmath266 are estimators for the partition functions @xmath267 with minimal asymptotic covariance ( see eq .   and ref .",
    "note that the denominator in eq .",
    "indicates that each weight @xmath264 takes into account contributions from all other ensembles @xmath268    introducing also partition functions @xmath269}$ ] , the uncertainty can be estimated as @xmath270)\\approx{\\mathbb{k}_{\\alpha}[\\mathcal a]}^2 ( \\rm{var}(\\hat z_{\\mathcal a_{\\alpha}})+ \\rm { var}(\\hat{z}_{\\alpha})-2 \\rm { cov}(\\hat z_{\\mathcal a_{\\alpha}},\\hat{z}_{\\alpha})).\\ ] ]    canonical equilibrium values of the correlation function @xmath244 and corresponding values of the reaction rate constants can be recovered once we consider estimates in eq .   with @xmath223 .",
    "we emphasize that this is by now the first application of the mbar unbiasing method based on marginal probabilities , able to estimate observables computed with a path sampling algorithm supplemented by waste - recycling .",
    "numerical recipes to obtain these estimations have been furnished by j. chodera  @xcite .",
    "in order to test the lyapunov biased tps algorithm ( lytps ) , we first consider a lennard - jones 38 cluster .",
    "this well - known benchmark system is often uysed to assess the efficiency of sampling algorithms .",
    "it and has been widely explored in literature for its rich thermodynamic properties : its potential energy landscape presents two main basins : a deep and narrow funnel containing the global energy minimum , a face - centered cubic truncated octahedron structure ( fcc ) , and a separate , wider , funnel leading to a large number of icosahedral structures ( ico ) of slightly higher energies .",
    "although the configuration with the lowest potential energy corresponds to the fcc one , the greater configurational entropy associated with a large number of local minima in the icosahedral funnel make this second configuration much more stable at higher temperatures . as temperature increases",
    ", lj@xmath0 undergoes several structural transitions .",
    "first , a solid - solid transition occurs at @xmath271 when the octahedral fcc structure gives place to the icosahedral ones .",
    "secondly , above @xmath272 , the outer layer of the cluster melts , while the core remains of icosahedral structure .",
    "@xcite    the lennard - jones potential is given by the usual expression @xmath273\\ ] ] where @xmath274 is the position of the @xmath275-th atom , @xmath276 is the distance between atoms @xmath275 and @xmath277 , @xmath143 is the pair well depth and @xmath278 is the equilibrium pair separation .",
    "in addition , a trapping potential prevents the evaporation of clusters particles at finite temperature : if the distance between the position @xmath279 of a particle and the center of the trap @xmath280 exceeds @xmath281 , this particle feels a potential @xmath282 .",
    "the bond - orientational order parameters @xmath283 defined as  @xcite @xmath284 where the @xmath285 are spherical harmonics and @xmath286 are the polar and azimuthal angles of a vectors corresponding to bonds between the @xmath287 pairs of atoms .",
    "the @xmath288 are traditionally used to identify different crystalline symmetries .",
    "the parameter @xmath289 is often used to distinguish between the icosahedral and cubic structures , for which it has values around 0.02 and 0.18 respectively .",
    "@xcite    monte carlo sampling fails to equilibrate the two funnels , and global optimization methods are unable to find its global energy minimum  @xcite .",
    "hence , several elaborated algorithm have been employed in the past to study the thermodynamic equilibrium of this system , such as parallel tempering ,  @xcite basin - sampling techniques ,  @xcite wang - landau approaches  @xcite or path - sampling methods .",
    "@xcite    standard transition path sampling  @xcite and discrete path sampling  @xcite ( dps ) have been already used to study transitions between the two funnels of lj@xmath0 . however , in the case of tps the large number of metastable states separating the two main basins prevented the traditional shooting and shifting algorithm to identify reactive paths , despite previous success for smaller lj clusters .",
    "@xcite authors had to resort to a two - ended approach linking the two minima to find trajectories with the same energy of those found by dps approach .",
    "@xcite the main drawbacks of this tps method were a lack of ergodicity and a very large computational cost .",
    "conversely , dps has been more succesfull in this task .",
    "this method uses eigenvector following and graph transformation  @xcite to compute the overall transition rate between two regions of phase space . to the best of our knowledge ,",
    "this is by now the most successful approach to computing reaction rates in lj@xmath0 .",
    "@xcite in particular , reaction rate constants for transitions between the two solid structures have been computed using dps  @xcite at different temperatures .",
    "we use here the lyapunov biased tps algorithm to investigate structural transitions in lj@xmath0 for temperatures above and below the solid - solid transition temperature @xmath290 , spanning a temperature range from @xmath291 to @xmath292 .",
    "our simulations required about @xmath293 hours of cpu time to observe reactive trajectories between the two main funnels .",
    "reaction constants , computed with the method exposed in sec .  [ sec : reaction - rate - constants - calculation ] , can be compared to values obtained with the discrete path sampling approach .",
    "@xcite      in order to thermalize the system at a given temperature , langevin dynamics are run for @xmath294 time steps , using a friction parameter @xmath295 .",
    "the last configuration is used as the starting point of the first deterministic trajectory of the tps simulations . at each new temperature",
    ", a new preliminary langevin dynamics is performed .    in simulations , trajectories consist of @xmath296 time steps , each step of duration @xmath297 .",
    "deterministic trajectories are obtained with the verlet algorithm  @xcite , and then selected following the lyapunov biased tps algorithm described in sec .",
    "[ sec : transition - path - sampling ] .",
    "for each temperature , 25 different biased path distributions are sampled , for values of the control parameter @xmath1 ranging linearly from @xmath298 to @xmath299 , in order to obtain reactive paths for @xmath299 and ensure a sufficient overlap between distributions sampled for different @xmath1 values .",
    "the unbiased distribution corresponding to @xmath223 has been simulated with tps as well .",
    "a markov sequence of @xmath300 biased tps shooting and shifting moves is performed , in order to ensure an ergodic sampling .",
    "values for the control parameters are chosen after observing the magnitude of the lyapunov indicators @xmath103 for few trajectories , and the difference between lyapunov indicators @xmath103 for current and trial trajectories in the shooting step ( eq .  ) , in order to have an acceptance ratio for the shooting move not below @xmath301 , see fig .",
    "[ fig : acceptance ] .",
    "the choice of the trajectory length @xmath48 depends not on the lyapunov bias , but on the necessity of having long enough trajectories to link the two funnels .",
    "@xmath48 needs also to be long enough to recover an appropriate statistics to compute reaction contants from correlation functions ( see below ) .",
    "the use of the stoltz algorithm ( eq .  ) in the shooting moves ensures that the energy distribution imposed by the preliminary md is maintained along the simulation .",
    "the value for @xmath143 in eq .   is taken as @xmath302 , so to have decorrelated sampled paths and ensure a sufficient acceptance ratio , see fig .",
    "[ fig : accept_stoltz ] .     over a markov chain of @xmath294 trajectories ,",
    "starting from the fcc basin at @xmath303 , as a function of the control parameter @xmath1 used in the simulations , for different trajectory lengths @xmath48 . increasing @xmath1 increases the mean lyapunov indicator and enables trajectories to explore barriers and transition states .",
    "average lyapunov indicators are almost independent of the trajectory length @xmath48 . *",
    "bottom * : acceptance ratio , given by eq .",
    "for the same simulations . ]     in the stoltz algorithm ,",
    "eq .  , for a markov chain of @xmath294 trajectories , starting from the fcc basin at @xmath303 , with trajectory lengths @xmath304 and a control parameter set to @xmath305 . ]",
    "we focus on the octahedral to icosahedral ( fcc - ico ) transition at temperatures from @xmath291 to @xmath292 : observing this passage using a direct md or a standard tps would require a considerable amount of cpu time ( about @xmath306h , see ref .",
    "@xcite ) as the fcc configuration is at low temperatures the most stable one , so that the system rarely escapes from the fcc basin .",
    "in contrast , with our biased tps technique we were able to observe at @xmath303 the first fcc - ico reactive trajectories after about @xmath307 markov chain steps .    to ensure that reactive paths start in the stable fcc state , we include in the path probability weight the constraining function ( see eq .  )",
    "@xmath308 assigned to the starting state @xmath309 of the path , function of the bond order parameter @xmath289 and centered on the value @xmath310 .",
    "we set @xmath311 , a sufficiently small stiffness that lets the trajectory starting point span the whole fcc basin .",
    "the function @xmath312 keeps the beginning of the trajectories inside the fcc funnel , thus counterbalancing the effect of the local lyapunov bias , that would pull trajectories on barriers .",
    "we present in fig .",
    "[ fig : histo_fc12 ] histograms for the first and the last point of the trajectories , for different values of the control parameter @xmath1 at the fcc - ico cohexistence temperature @xmath303 . as",
    "@xmath1 values increase , trajectories explore regions that are increasingly distant from the initial fcc basin , and some of them eventually cross the transition region and reach the ico basin .     for trajectories starting from the fcc basin at @xmath303 for different values of the control parameter @xmath1 , averaged on a markov chain of 5000 steps .",
    "the restraining function of eq .   mantains the initial states of the trajectories in the fcc funnel for all @xmath1 values .",
    "* bottom * : same histogram , for the final position @xmath313 .",
    "trajectories sampled with large @xmath1 values escape the fcc funnel more often .",
    "their final states are distributed over the whole fcc - ico range . ]",
    "once reaction paths have been identified , the computation of the inter - funnel reaction constant by the correlation function via eq .   of sec .",
    "[ sec : reaction - rate - constants - calculation ] is possible if reactants and products basins are adjacent , i.e. if there is no intermediate state between them .",
    "@xcite however , this hypothesis is not valid for the fcc - ico transition : several results reported in the literature  @xcite show that reactive paths linking fcc and ico states pass through many short - lived metastable basins , separated by barriers of different heights , not belonging to the two main funnels .",
    "these metastable states and transition regions have also been observed in a previous work using the transition current sampling method .",
    "@xcite such a feature has been confirmed as well by an attentive analysis of our trajectories .    among all the intermediate metastable states ,",
    "we emphasize the presence of a basin related to a faulted fcc configuration , indicated with d in the following , having a bond order parameter value around @xmath314 , already acknowledged in precedent studies .",
    "@xcite this basin has a rather important occupation probability if compared to other metastable states , and is visited by every reaction path linking fcc to ico state .",
    "moreover , this metastable state is indeed structurally related to the fcc basin , and the barrier separating the d structure from fcc is lower than the one separating the former from ico state . as a result , several recrossing events of trajectories starting in fcc , visiting the d state and then going back to fcc , can be observed .",
    "hence , in order to correctly reconstruct the fcc to ico transition paths , we have to take into account this intermediate metabasin .",
    "we therefore split the fcc - ico passage in two steps : the first part is given by the passage from the fcc basin to the d basin corresponding to @xmath314 .",
    "the second part is then given by trajectories starting from the d basin , and ending up in the ico funnel .    to obtain this second part of fcc - ico reactive paths ,",
    "we constrain the first point of the trajectories to start in the d basin , using a constraining function given by an indicator on the bond - order parameter value @xmath315 : @xmath316     for trajectories starting from the d configuration metabasin located at @xmath317 for different values of the control parameter @xmath1 , averaged over a markov chain of 5000 steps . *",
    "bottom * : same histogram , for the final position @xmath313 .",
    "trajectories end up in both the fcc or the ico funnel . ]    in fig .",
    "[ fig : histo_dc13 ] we present histograms for the distribution of the beginning and the end point of trajectories constrained with the indicator function of eq .",
    ", at a temperature @xmath317 slightly above the solid - solid cohexistence .",
    "paths sampled with the unbiased distribution @xmath223 completely remain in the `` window '' given by @xmath318 . on the contrary ,",
    "trajectories weighted with a lyapunov bias tend to leave the metabasin : their starting points @xmath309 tend to accumulate on the borders of the region defined by the indicator function in eq .",
    ", while the end points @xmath313 fall both in the fcc and the ico funnels .    in simulations performed at lower temperatures ,",
    "this reconstruction of the second part of the fcc - ico reactive path with trajectories starting from the d state is more difficult .",
    "indeed , histograms for trajectories of the same length at temperatures lower than the solid - solid transition @xmath303 show that an important fraction of the sampled trajectories fall from the d state directly to the fcc basin , while a few trajectories end in the ico state .",
    "this is attributed to the heights of the barriers separating the metastable d structure from either the stable ico or stable fcc structures , the latter barrier being lower than the former one .",
    "the total reaction constants for the two - step fcc - ico transition , assuming a steady occupation probability for the intermediate d state , is derived in appendix  [ react_cost_interm ] and reads @xmath319 where subscripts @xmath320 , @xmath321 and @xmath322 refers to fcc , d and ico states respectively .",
    "the same steady state approximation is assumed for all intermediate metastable states in discrete path sampling studies .",
    "@xcite    reaction rates @xmath323 and @xmath324 involve transitions between states separated by high free energy barriers ,  @xcite thus the hypothesis of time scale separation required by the reaction rate theory is still valid , and reaction constants can be computed using the method exposed in sec .  [",
    "sec : reaction - rate - constants - calculation ] .",
    "reactive paths between fcc and d basins , and between d and ico basins , are computed as reported above ( sec .",
    "[ ljreactivepaths ] ) .",
    "on the contrary , the d to fcc reaction rate @xmath325 can not be computed by lytps , because the requirement of a time scale separation is no longer valid , the barrier separating this two states being too low .",
    "it is therefore computed by direct md simulation .    the reactivity @xmath326 ( eq .  ) for each trajectory",
    "is evaluated in simulations distinguishing the three basins fcc , ico and d whose ranges of bond - order parameter @xmath327 value , that is @xmath328 , @xmath329 and @xmath330 , respectively .",
    "data harvested during lytps runs are unbiased using mbar .    in fig .",
    "[ fig : corr_fc13 ] and  [ fig : corr_dc13 ] , two examples of population correlation functions for the computation of reaction rate constants , unbiased with mbar , are reported .",
    "note that reactivity values computed at short times are nearly zero , and do not contribute significatively to the correlation functions : in fact , these values are obtained from segments of trajectories too short to witness a complete transition between two states . in table",
    "[ table ] , we report reaction rate constants values for the fcc to d structure ( @xmath323 ) transition , and fro the d structure to ico ( @xmath324 ) , that give , through eq .  , a total fcc to ico ( @xmath331 ) rate in good agreement with values given by dps calculations  @xcite . finally , an arrhenius plot comparing our results with the reaction constants proposed in ref .",
    "@xcite is presented in fig .",
    "[ fig : arrhenius_lj38 ] .    .",
    "error bars are computed via eq .   and directly given by chodera s numerical recipe  @xcite .",
    "* right * : reaction constant for this same passage , obtained at times shorter than the mean first passage time .",
    "the reactive flux @xmath332 reaches a plateau value , corresponding to @xmath323 , as explained in sec .",
    "[ sec : reaction - rate - constants - calculation].,width=755 ]     . *",
    "bottom * : reaction constant for this same passage.,width=755 ]    .table of reaction constants for the transitions from fcc to d structure , d to ico , and the total fcc to ico transition , indicated as @xmath323 , @xmath324 and @xmath331 respectively , at different temperatures .",
    "values of @xmath331 are obtained using eq .   and assuming the reaction constants @xmath325 as @xmath333 , @xmath334 , @xmath335 for @xmath291 , @xmath336 and @xmath303 respectively ( values obtained by langevin md ) , and unitary for @xmath337 . in the last column on the right , we report dps data from ref .",
    "@xcite , computed in the harmonic approximation framework . [ cols=\"^,^,^,^,^\",options=\"header \" , ]      ( lytps , red dots ) compared with data obtained from dps  @xcite using an harmonic approximation and reported in ref .",
    "@xcite ( ha , black line ) . ]",
    "the second example of a thermally activated process studied using lytps is the migration of a single vacancy in @xmath1-iron crystal .",
    "atomic interactions of the model system are described by an embedded atom model potential .",
    "@xcite the crystal structure is body - centered cubic , and the initial unrelaxed cell contains 1023 atoms displayed on 1024 lattice sites , the vacant site corresponding to the vacancy .",
    "the reaction coordinate used to represent the motion of the vacancy is the distance crossed by the moving atom that replaces the vacancy .",
    "the free energy landscape for this system has been reconstructed in ref .",
    "it presents two stable states , the first corresponding to the initial configuration , and the second one to the same configuration obtained by translating a neighboring atom into the vacancy site .",
    "the first neighbor distance is @xmath338 , switching its initial position with the vacancy site .",
    "there is a single free energy barrier separating these two states for temperatures above @xmath339 , while for lower temperatures an intermediate metastable state appears , corresponding to an intra - site position for the moving atom .",
    "@xcite    we performed lytps simulations with trajectories of different lengths ( see below ) , with time step @xmath340 .",
    "a preliminary md simulation is done to equilibrate the system to the required temperature , with a friction parameter @xmath341 .",
    "we explored temperatures ranging from @xmath342 to @xmath343 .",
    "the lytps shooting and shifting moves are iterated to cosntruct markov chains consisting of @xmath344 trajectories .    as for lj@xmath0 ,",
    "the trajectory length and the values for the control parameter @xmath1 have been chosen in order to ensure an acceptance ratio of @xmath345 and an adequate ergodic sampling of the phase space . for temperatures above @xmath346",
    ", the presence of a single `` smooth '' barrier separating the two metastable states makes this application simple enough : sampling of reactive trajectories is achieved using @xmath347 @xmath1 values from the unbiased simulation at @xmath223 up to @xmath348 , with trajectories of @xmath307 steps . for temperatures below @xmath349 , an ergodic sampling of trajectory space appears more difficult .",
    "we therefore employed longer trajectories of @xmath350 time steps , as well as larger values of the control parameter , up to @xmath351 to allow the system to escape the initial basin .",
    "reaction constants for the passage between the two stable states above @xmath349 are estimated from correlation functions unbiased with the mbar algorithm , via eq .  .",
    "for @xmath352 , the presence of an intermediate metastable basin has to be taken into account in the evaluation of reaction constants . as recalled in sec .",
    "[ lj38 ] , the reaction rate expression obtained from eq .   holds only for adjacent reactant and product basins . at low temperatures ,",
    "it is therefore more appropriate to use our algorithm to evaluate the reaction constant for the passage from the initial state to the intermediate basin . from eq .",
    ", reaction rate for the passage from one stable configuration to the other is simply half the reaction constant from one stable configuration to the intermediate one . indeed ,",
    "reaction constants for transitions from the intermediate metastable state to either of the two stable states are equal , because of the symmetric shape of the potential surface .",
    "@xcite    in fig .",
    "[ fig : arrhenius_vac ] we compare the reaction rates obtained with lytps , those computed inserting in the transition state theory ( tst ) expression ( eq .  )",
    "the free energy barriers reported in ref .",
    "@xcite , and reaction constants obtained with a classical harmonic approximation ( ha ) . above the debye temperature ( @xmath353 ) , rates obtained with lytps fall between tst and harmonic approximation values .",
    "to explain this point , we recall that reaction rates we estimate with the method exposed in sec .  [",
    "sec : reaction - rate - constants - calculation ] are derived from eq .  ,",
    "hence correspond to the _ phenomenological _ rate constants .",
    "these values are therefore bounded from above by tst values , that overestimate reaction rates  @xcite , as can be seen from eq .  .",
    "conversely , values obtained with the harmonic approximation neglect anharmonicity effects on the activation barrier , thus giving reaction rates that are lower then the phenomenological rate constants we compute .",
    "our results are then in agreement with the reaction rate theory recalled in sec .",
    "[ sec : reaction - rate - constants - calculation ] .",
    "the method presented in this paper allows to compute reaction rate constants for inter funnel transitions in many - body systems .",
    "the reaction rate values are evaluated using a path sampling algorithm biased with local lyapunov numbers .",
    "this bias aims at enhancing an accelerate sampling of reactive paths , so as to reduce the lenght of markov chains and the amount of cpu time to observe activated processes .",
    "we assess the performace of the method by observing reaction paths and evaluating equilibrium reaction rates for structural transitions in the lj@xmath0 system and for vacancy migration in an @xmath1-iron crystal . for both systems",
    ", we were able to predict phenomenological rate constants , in very good agreement with data already given in the literature in the case of lj@xmath0 .",
    "the lyapunov biased tps method presents several advantages , and incorporates features of different rare events simulation methods .",
    "firstly , with respect to other importance sampling methods based on lyapunov weighted sampling  @xcite , lyapunov biased tps has the main advantage of a simpler implementation .",
    "this is due to the lyapunov indicator @xmath102 we propose in eq .",
    ", that allows to quantify the divergence of hamiltonian trajectories by resorting to local lyapunov numbers .",
    "these quantities can be easily calculated with the lanczos algorithm , that enables one to compute the largest eigenvalues of the jacobian matrix of the hamiltonian mapping with a limited computational cost . as recalled in sec .",
    ", resorting to local lyapunov numbers to evaluate chaoticity of phase space trajectories does nt suffer from the computational drawbacks of other algorithms aimed at the same purpose , as rli or the tangent space method .",
    "@xcite the implementation of shooting and shifting monte carlo moves in a lyapunov biased tps is less complicated , and computationally less expensive , than the algorithm proposed in ref .",
    "@xcite with the use of rli , because we do not need to compute four trajectories to evaluate the divergence of a single path  @xcite .    secondly , this formulation for the lyapunov indicator is such that the bias applied to each path in order to enhance the fraction of reactive trajectories is clearly identified , contrarily to what is done in rather complex cloning algorithms like the one proposed in lyapunov weighted dynamics  @xcite and transition current sampling  @xcite .",
    "hence , the use of standard unbiasing statistical tools to recover unbiased observables is possible and requires a small theoretical and computational effort .",
    "furthermore , we consider the access to the evaluation of equilibrium transition rates as the most important aspect of lyapunov biased tps . on the computational point of view , the direct access to reaction rates without resorting to a distinct evaluation of the reaction barriers and the transmission factor , as usually done in standard tps technique  @xcite , is a very advantageous feature . to unbias reaction constants computed in lyapunov biased ensembles we chose among other unbiasing algorithm , like wham  @xcite or extended bridge sampling  @xcite techniques , the mbar method  @xcite .",
    "mbar has proven to be computationally efficient and to give an adequate numerical precision in estimating reaction constants . moreover ,",
    "this work is the first in which mbar is implemented exploiting the marginal probability derived from a waste recycling method .",
    "this allows to include informations encoded in rejected proposal trajectories .",
    "finally , lytps is implemented at a finite temperature , imposed to trajectories by the canonical distribution from which the path starting point is selected and maintained along the path thanks to the stoltz proposal for the shooting algorithm , see sec .",
    "[ sec : transition - path - sampling ] . in parallel ,",
    "the lyapunov indicator used as a bias to select reactive paths directly links the path sampling to the local conformation of the potential energy surface via the hessian matrix , thus giving to our method an intrinsic dependence on the potential energy landscape .",
    "the coupling between a finite - temperature sampling and potential energy surface conformation is a noticeable improvement if compared to eigenvector - following methods , that are based on the shape of the potential energy surface , but usually operate at zero temperature .",
    "lytps can be acknowledged as a finite , nonzero temperature version of the well - known eigenvector - following techniques , such as dimer , optim or art .",
    "@xcite    the advantages related to a finite temperature technique do not concern only the exploration of the energy landscape , but also the fact that the evaluation of physical observables like reaction rates takes into account temperature and anharmonicity effects .",
    "indeed , the phenomenological reaction rate we computed ( see sec .  [",
    "sec : reaction - rate - constants - calculation ] ) can be compared with experimental measures : lytps turns out to be a powerful tool to study problems like vacancy migration in iron . in this",
    "context , reaction rates are usually estimated using only the _ potential energy _",
    "barriers at 0 k and harmonic approximations : this give approximate results with respect to experimental data obtained at nonzero temperatures .",
    "lytps reaction rates find an important application as input parameters for object monte carlo codes aimed at numerically reproducing resistivity recovery experiments .",
    "we conclude observing that this method can be furhter developed using a parallel tempering technique , or implemented for the computation of reaction rates in more complex condensed matter systems , and can find interesting applications in a wide class of research fields , spanning from molecular biophysics to physical metallurgy , where the numerical determination of reaction rates has important consequences for experimental applications .",
    "i warmly thank manuel athenes and mihai - cosmin marinica for help and fruitful discussions .",
    "the time evolution of the occupation probabilities @xmath354 , @xmath355 and @xmath356 of the fcc , ico and faulted states respectively , read @xmath357 where subscripts @xmath320 , @xmath321 and @xmath322 refers to fcc , faulted and ico states respectively , and @xmath204 indicates the generic transition rate from state a to state b. note that the possibility of a direct transition from fcc to ico states without passing by the intermediate basin has been neglected .",
    "the stationary approximation for the metastable state imposes @xmath358 , thus the above system can be recasted in the form @xmath359 and the reaction constant between fcc and ico states can be calculated as @xmath360"
  ],
  "abstract_text": [
    "<S> we propose an efficient method to compute reaction rate constants of thermally activated processes occurring in many - body systems at finite temperature . </S>",
    "<S> the method consists in two steps : first , trajectories are sampled using a transition path sampling ( tps ) algorithm supplemented with a local lyapunov bias favoring diverging trajectories . </S>",
    "<S> this enhances the probability of observing rare reactive trajectories between stable states during relatively short simulations . </S>",
    "<S> secondly , reaction constants are eventually estimated from the unbiased fraction of reactive trajectories , yielded by an appropriate statistical data analysis tool , the multistate bennett acceptance ratio ( mbar ) package .    in order to test our algorithm , </S>",
    "<S> we compute reaction constants for structural transitions in lj@xmath0 , a well studied lennard - jones cluster , comparing our results to values previously reported in the literature . </S>",
    "<S> additionally , we apply our method to the calculation of reaction rates for the migration of vacancies in an @xmath1-iron crystal , for temperatures ranging from 300 k to 850 k. vacancy diffusion rates associated with activation barriers at finite temperature are then evaluated , and shown to be substantially different from values obtained using the standard harmonic approximation . </S>"
  ]
}