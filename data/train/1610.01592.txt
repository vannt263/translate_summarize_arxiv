{
  "article_text": [
    "plasma turbulence is nowadays one of the most challenging problems in computational physics .",
    "generated by micro - instabilities , these turbulences play an important role in the confinement properties of fusion plasmas , which is an active area of research .",
    "indeed , the iter tokamak is the most promising fusion reactor in study at present , aiming at producing clean energy ( non - radioactive , no waste products ) by imitating the fusion processes occurring in the centre of the sun .",
    "various mathematical models were introduced in literature to describe and help understanding these turbulence phenomena , among them fluid models and kinetic ones . due to the weak collisionality of a tokamak plasma ( in the core ) and to the fact , that fluid models over - estimate the turbulent fluxes @xcite , the kinetic approach is preferred at present .",
    "the standard kinetic model is the boltzmann equation ( vlasov equation in the case @xmath0 ) @xmath1 for each particle species ( @xmath2 for electrons and @xmath3 for ions ) , where @xmath4 resp .",
    "@xmath5 are the particle elementary charge resp .",
    "mass and @xmath6 resp .",
    "@xmath7 are the electric respectively magnetic fields , determined self - consistently from maxwell s equations @xmath8 \\ds - { 1 \\over c^2 } \\partial_t \\bfe + \\nabla \\times \\bfb=\\mu_0\\ , \\bfj\\\\[3mm]\\ds \\partial_t \\bfb + \\nabla \\times \\bfe = 0\\\\[3 mm ] \\ds \\nabla \\cdot \\bfb = 0\\ , , \\end{array } \\right.\\ ] ] where @xmath9 , @xmath10 and @xmath11 are the free - space permittivity , permeability resp . speed of light and where the charge and current densities are computed via @xmath12 the right hand side of ( [ boltz ] ) describes the short - range collisions between the particles and its form is given by the particular physical phenomena one wants to investigate",
    ". some examples of collision operators are the boltzmann , the fokker - planck , the bgk collision operators and so on . in the electrostatic case ( given field @xmath13 ) ,",
    "maxwell s equations ( [ max ] ) have to be replaced by poisson s equation [ poi ] - _ 0 = , where @xmath14 is the electrostatic potential , related to the electric field @xmath15 by @xmath16 , where the sign comes from the convention that the electric field points in the direction of the ion motion . for more details about the modelling of magnetically confined fusion plasmas , we refer the interested reader to the textbooks @xcite . + from a numerical point of view",
    ", solving the system - is rather arduous , due among others to its high dimensionality ( @xmath17 dimensional in the phase space @xmath18 ) .",
    "hence , numerically cheaper models have been introduced in literature , like the @xmath19 gyro - kinetic vlasov - poisson model ( see @xcite and references therein ) .",
    "the justification of such lower - dimensional approximate models comes from the presence of a large external magnetic field @xmath13 , which confines the plasma in the tokamak .",
    "the effect of this strong magnetic field on the particle dynamics is that it introduces a strong anisotropy , the motion of the charged particles being splitted into a fast gyration around the magnetic field lines and a slow dynamics along these lines .",
    "the phase - space reduction leading to the @xmath19 gyro - kinetic model is based essentially on this separation of the perpendicular and parallel particle dynamics and the filtering of the fast gyro - motion . in a first approximation",
    "one can say that the particles follow the magnetic field lines ( they get trapped along them ) . when observing the particles on larger time scales however , an additional drift motion perpendicular to the magnetic field lines is observed .",
    "+ more generally , depending in detail on the physical phenomenon one wants to investigate , several different scalings of the kinetic model have been introduced in literature , permitting to study various asymptotic regimes when the magnetic field gets larger , and to get cheaper models as for example the guiding - centre , drift - kinetic , gyro - kinetic models ( see @xcite ) .",
    "the concern of the present paper is the investigation of the following rescaled vlasov equation [ v_c ] _ t f + _ x f + _ v f = 0,in the small @xmath20 asymptotics , where @xmath21 stands for the ratio of the particle cyclotron period to the observation time .    our aim is to review , investigate and compare several numerical procedures for an efficient resolution of .",
    "in particular we are interested in numerical schemes being able to describe in a homogeneous manner the evolution of charged particles in various strong magnetic fields , especially in the high @xmath13-field limit .",
    "let us observe that for @xmath20 we have to cope with a singularly perturbed problem , the solution becoming more and more oscillating with smaller getting @xmath21-values , fact which shall require some averaging procedures . to attain this goal",
    ", we decided to consider in the present paper two simplified models , obtained from , but which still contain all the numerical difficulties of the initial model .",
    "we deliberately simplified equation in order to be able to do a complete numerical analysis and to understand in all details the features of the here introduced numerical schemes .",
    "based on the conclusions of the present study , we shall pick up the most appropriate numerical scheme to apply it to the initial problem , posed in a realistic physical context .",
    "this last part shall be done in a second paper , due to lengthy reasons .",
    "+ the outline of this paper is the following .",
    "section [ sec10 ] deals with the presentation of the physical scaling leading to the anisotropic vlasov equation .",
    "we are introducing also two simplified models which will be studied in the following .",
    "section [ sec2 ] reviews the mathematical framework necessary to study the first toy model , and investigates the asymptotic limit @xmath22 .",
    "section [ sec21 ] introduces several numerical schemes that we shall apply for the resolution of the first toy model .",
    "then , we present the numerical results obtained with these schemes in section [ sec24 ] and the numerical analysis in section [ sec25 ] . the last section is dedicated to the mathematical and numerical study of the second toy model which considers variable coefficients .",
    "a conclusion gives some hints for our upcoming work , concerning the more realistic vlasov equation .",
    "the aim of this section is to present the physical framework and regime leading to the dimensionless vlasov equation and to introduce some simplified models we shall investigate numerically in the next sections .",
    "+ starting point of our study is the boltzmann equation for the ion dynamics , where we shall suppose that during the investigated time - interval , the collisions are not so frequent , such that we shall immediately suppose that @xmath0 .",
    "choosing now characteristic scales for our phenomenon shall permit to identify small parameters , describing specific plasma regimes .",
    "in particular , let us write each quantity under the form @xmath23 , where the constant @xmath24 stands for the characteristic scale of this quantity and @xmath25 is the dimensionless variable .",
    "using this notation , let us denote by @xmath26 the observation time and by @xmath27 the characteristic space scale .",
    "the characteristic microscopic velocity is then fixed as @xmath28 .",
    "furthermore , let the kinetic energy be of the same order as the potential energy of the problem , implying thus @xmath29 finally , let us introduce the cyclotron frequency of the ions @xmath30 the plasma regime we shall be interested in , concerns a strongly confined plasma situation , in other words , we shall suppose that the observation time @xmath26 is much larger that the time scale @xmath31 of the cyclotron oscillations , _",
    "i.e. _ @xmath32 writing thus the vlasov equation in dimensionless variables , namely @xmath33 and using the relations just introduced for the characteristic scales , leads finally to the rescaled vlasov equation we are interested to study , _",
    "i.e. _ [ v_c_bis ] _ t f + _ x f + _ v f = 0,where we omitted for simplicity reasons the primes . + in the rest of this paper we shall consider a homogeneous magnetic field @xmath34 with fixed direction @xmath35 and constant magnitude @xmath36 . furthermore , let us also introduce the following notation @xmath37 sometimes it is more convenient to shift in from cartesian coordinates to polar coordinates for the velocity , _",
    "i.e. _ @xmath38 the vlasov equation , written in polar coordinates , has then the form [ v_p ]    l _ t f + v_z _ z f + e_z _ v_z f + ( e_x + e_y ) _ r f- ( e_x - e_y ) _ f + + r ( _ x f + _ y f ) - 1 _ f = 0 ,    where the unknown is now @xmath39 . +",
    "our aim is to design efficient numerical methods for the resolution of anisotropic vlasov equations of the form resp .",
    ", corresponding to a cartesian ( not field - aligned ) resp .",
    "polar ( field - aligned ) configuration .",
    "the two formulations are different from a numerical point of view , and different numerical schemes are usually employed for their resolution . to understand this difference better , we shall investigate in the present work in detail some numerical schemes for simplified versions of and .",
    "we deliberately consider here only simple models in order to be able to study in detail the schemes and to better emphasize their advantages and disadvantages .",
    "the two simplified models we shall consider in the sequel are presented below .",
    "let us start from the vlasov equation and assume here that @xmath40 , @xmath41 and consider furthermore only the dynamics in the perpendicular plane @xmath42 , the whole @xmath43 study being the subject of future works .",
    "in other words , let us start from the rescaled 4d equation @xmath44 where @xmath20 accounts as usual for very strong magnetic fields .",
    "in order to simplify the computations , one often shifts to polar coordinates for the velocity , leading to [ v_p_bis ]    l _ t f + r _ x f + r _ y f - _ f = 0 ,    where the unknown now is @xmath45 .",
    "we recognize thus a simple @xmath43 anisotropic transport equation , the variable @xmath46 being considered as a parameter in .",
    "+ choosing an initial condition @xmath47 independent on the variable @xmath48 , would even lead to a more simpler @xmath49 transport model [ adv_2d ] _ t f + r _ x f - 1 _ f = 0 .",
    "this problem represents the simplest example of an anisotropic advection equation , to be understood in detail before designing an efficient numerical scheme for the resolution of the previous vlasov equation in the gyro - kinetic regime .",
    "it is sufficiently difficult in order to study the behaviour of the various schemes we shall introduce , and shall be the starting point of section [ sec2 ] .",
    "in this second part , we shall differently simplify our vlasov equation in order to study a different behaviour . in particular ,",
    "setting @xmath40 , @xmath50 and taking an initial condition independent on the space variable , yields the following 2d equation , in cartesian coordinates @xmath51 or equivalently @xmath52    the difference of this model to the previous one is that this time the characteristics are no more straight lines but curves ( circles ) such that the numerical schemes will behave differently as will be seen later . as mentioned earlier , these two models correspond to simplified versions of a field - aligned , polar coordinate framework , as well as a not field - aligned , cartesian framework , both associated to the vlasov equation in the gyro - kinetic regime .",
    "+ the main points we are interested in within this study are the following :    * design of asymptotic - preserving schemes for an efficient numerical resolution of anisotropic vlasov equations of type , .",
    "important properties we are asking from the schemes are : ( a ) stability independent on @xmath21 ; ( b ) numerical diffusion / accuracy independent on @xmath21 ; ( c ) discretization of the limit model as @xmath53 ; * show that taking the stiff term @xmath54 in implicitly is not sufficient for having an ap - scheme , meaning that ap - schemes are more than taking `` implicitly '' the suitable terms .",
    "ap - schemes have to mimic at the discrete level the precise asymptotic behaviour of the solution in the limit @xmath53 ; * perform a detailed numerical analysis of the presented schemes in the framework of the two simplified toy - models , and identify exactly which are the particularities of each scheme and each equation ; * understand the difference between a field - aligned framework and a cartesian framework , and this from a numerical point of view ; * prepare the foundation for a future , more realistic work , dealing with the resolution of the initial vlasov equation in the gyro - kinetic regime .",
    "let us investigate now in detail the following simplified toy model , corresponding to a field - aligned anisotropic vlasov equation [ av ] ( v ) _ \\",
    "x f^+ b _ y f ^=0 , ( t , x , y ) , + f^(0,x , y)=f_in(x , y ) ,    . where @xmath55 is a given initial condition , @xmath56 and @xmath57 are for the moment constants and @xmath58 is a parameter representing the strong anisotropy / stiffness of the problem .",
    "our computational domain is a doubly periodic box @xmath59 \\times [ 0,l_y]$ ] . + we shall review here some standard numerical schemes as well as introduce some new ones for the resolution of such a singularly perturbed problem and discuss finally their advantages and disadvantages . in particular , one is interested in numerical schemes capable to solve uniformly accurate in @xmath21 , so - called `` asymptotic - preserving '' schemes . + let us however start with a detailed mathematical study of the behaviour of .",
    "equation is a simple advection problem , whose exact solution is given by the characteristic method , _ i.e. _ [ sol ] f^(t , x , y)=f_in(x - at , y - b t ) , ( t , x , y ) .",
    "remark that this function is @xmath60-periodic in the variable @xmath61 , @xmath62-periodic in the variable @xmath48 .",
    "concerning the time - variable , two time - scales are present in the problem , a slow time - scale @xmath63 and a rapid one @xmath64 . + the term @xmath65 in is the dominant term in the case where @xmath20 , such that passing formally to the limit @xmath53 , yields @xmath66 \\times [ 0 , l_x ] \\times [ 0,l_y ] ,   \\\\ \\\\",
    "f(0,x , y ) = f_{in}(x , y ) .",
    "\\end{array}\\right . \\label{red}\\end{aligned}\\ ] ]    this system , called `` reduced system '' , is ill - posed .",
    "depending on the initial condition , it can admit or an infinite number of solutions , namely if @xmath67 , or no regular solution ( if @xmath68 ) . from a numerical point of view , this ill - posedness in the limit is translated into the singularity of the matrix of the linear system obtained by discretization of this problem . in particular , trying to solve in a standard manner for too small @xmath21-values will necessarily lead to a linear system which degenerates in the limit @xmath53 .",
    "this shall induce sever numerical problems .",
    "+ more adequate schemes are hence necessary for an efficient resolution of , as for example `` asymptotic - preserving '' schemes which are uniformly stable and accurate independently on the small parameter @xmath21 , and are additionally able to capture the limit model as @xmath53 .      for a better comprehension of our singularly - perturbed problem as well as for the construction of efficient `` asymptotic - preserving '' schemes",
    ", we have to identify the limit problem @xmath69 of and its solution denoted by @xmath70 .",
    "the information we get from the reduced model is that the limit - function @xmath70 has to be @xmath48-independent . with this information",
    "we introduce now the average of the function @xmath71 with respect to the direction",
    "@xmath48 @xmath72    integration of the equation with respect to @xmath48 yields @xmath73 , which is an @xmath21-independent problem .",
    "passing then to the limit @xmath53 leads to the advection equation @xmath74 \\times [ 0,l_x ] , \\\\[3 mm ] \\ds \\bar{f^{0}}(0,x ) = \\bar{f}_{in}(x)\\ , , \\quad \\forall x \\in [ 0,l_x]\\ , , \\end{array}\\right .",
    "\\label{eq4}\\end{aligned}\\ ] ] with solution @xmath75 \\times [ 0,l_x]\\,.\\ ] ] the system @xmath69 is what we call `` limit - system '' of the anisotropic vlasov equation @xmath76 , as shall be proved in the next section .",
    "so far , we proved the existence of a unique solution @xmath77 for the system @xmath78 resp .",
    "@xmath70 for the limit system @xmath69 .",
    "the next step is now to show the weak - convergence of @xmath77 towards @xmath70 as @xmath53 , and this in a certain sense . to define this sense",
    ", we have to introduce the right mathematical framework . in the sequel",
    "the symbol @xmath79 shall underline the periodicity of the considered space .",
    "+    [ thm_weak ] let the initial condition @xmath80 . then the unique solutions to @xmath78 resp . @xmath69",
    "satisfy @xmath81 resp .",
    "moreover , we have the weak-@xmath83 limit @xmath84    to prove , which signifies @xmath85 we shall introduce first a primitive of the function @xmath86 , _",
    "i.e. _ @xmath87 it follows that the function @xmath88 belongs to @xmath89 such that @xmath90 belongs to @xmath91 .",
    "the @xmath62-periodicity of @xmath88 is seen by the simple computation @xmath92 taking now an arbitrary test function @xmath93 and introducing for simplicity for each @xmath94 the bracket @xmath95 , we have @xmath96+a   \\big(\\partial_x g\\big)\\big(x - at , y-\\frac{b}{\\epsilon}t\\big ) ,   \\phi(t)\\rangle dt   \\bigg ] \\\\ & =   \\frac{\\epsilon } { b }   \\int_0^t \\langle   g\\big(x - at , y-\\frac{b}{\\epsilon}t\\big ) ,   \\phi ' ( t)\\rangle   dt - \\frac{\\epsilon a}{b}\\int_0^t \\langle    \\big(\\partial_x g \\big)\\big(x - at , y-\\frac{b}{\\epsilon}t\\big ) , \\phi(t ) \\rangle dt .\\end{aligned}\\ ] ]    as @xmath97 ,",
    "we can estimate @xmath98 ,   \\phi(t ) \\rangle dt \\right| \\leqslant c \\epsilon\\,,\\end{aligned}\\ ] ] where @xmath99 is a constant independent on @xmath21 . therefore , @xmath100 , \\phi(t ) \\rangle dt \\underset{\\epsilon \\to 0}{\\longrightarrow } 0\\,,\\end{aligned}\\ ] ] which concludes the proof due to the dense injection @xmath101 .",
    "let us investigate the two - scale convergence of @xmath77 , which is more appropriate to be used in the context of high frequency oscillations .",
    "indeed , we remind that our problem is two - scale with respect to the time variable , fact represented by the parameter @xmath21 .",
    "the weak limit of a given oscillating function - sequence does not adequately capture the oscillating behaviour , it gives only information about the average .",
    "we need hence to generalize the weak convergence and introduce the so - called two - scale convergence which is more adequate in this context .",
    "in particular , this new concept is able to capture the oscillations in the solution @xmath71 through its limit .",
    "to define the two - scale convergence , let us denote by @xmath102 an open subset of @xmath103 , @xmath104 a periodic domain and @xmath105 the set of functions @xmath106 which belong to @xmath107 and are @xmath108-periodic .",
    "let @xmath109 . a sequence of functions @xmath110 in @xmath111",
    "is said to be `` two - scale '' convergent towards @xmath112 if for every test function @xmath113 , with @xmath114 , we have : @xmath115 the two - scale convergence is denoted simply by @xmath116 .",
    "note that the space of test functions @xmath117 can be replaced by @xmath118 or @xmath119 , but never by @xmath120 @xcite .",
    "+ observe that the test functions are y - periodic and that the sequence oscillates at the same frequency as the considered test functions .",
    "if the oscillations of the sequence and of the considered test functions are not in resonance , the two - scale convergence will never see these oscillations and shall convert into a usual weak convergence .",
    "finally , let us also remark that the two - scale convergence implies the weak convergence and that the strong convergence implies two - scale convergence , however the converse implications are not true .",
    "now , we return to our problem and prove the following theorem :    [ thm_2s ] let @xmath80 and @xmath81 the unique solutions to @xmath78 . then , there exist a function @xmath121 , @xmath122-periodic in the second variable @xmath123 , such that @xmath124 meaning that for each test function @xmath125 one has @xmath126 furthermore , we have the following relation between @xmath127 and the weak - limit @xmath70 of @xmath69 @xmath128    let us now demonstrate that @xmath71 converges in the two - scale sense towards @xmath127 , which is defined by :    @xmath129 \\times [ 0,l_\\tau ] \\times [ 0,l_x ] \\times [ 0,l_y].\\end{aligned}\\ ] ]    for this , let us choose test functions @xmath130;l^2_\\sharp(\\omega)))$ ] , denote as usual @xmath95 and show that @xmath131    first of all , we have , @xmath132    for each @xmath133 there exists an index @xmath134 such that @xmath135 and @xmath136 . with this",
    ", we have then the following decomposition :    @xmath137 & = { \\epsilon } \\bigg[\\sum_{k=0}^{k_{\\epsilon}-1 } \\int_{k l_\\tau}^{(k+1 ) l_\\tau}\\!\\!\\!\\!\\!\\!\\langle    f_{in}\\big(x - a{\\epsilon \\tau } , y - b\\,\\tau \\big ) ,   \\psi\\big({\\epsilon}\\tau , \\tau \\big)\\rangle d \\tau+ \\int_{k_{\\epsilon } l_\\tau}^{\\frac{t}{\\epsilon}}\\!\\!\\!\\langle f_{in}\\big(x - a\\epsilon \\tau , y - b\\,\\tau \\big ) , \\psi \\big(\\epsilon \\tau,\\tau \\big)\\rangle d\\tau\\bigg]\\,.\\end{aligned}\\ ] ]    the second term on the right hand side is converging towards zero , as @xmath21 goes to zero .",
    "indeed , one has the estimate @xmath138 with a constant @xmath99 independent on @xmath21 .",
    "for the first term on the right hand side of , we recognize the expression of a riemann sum . indeed",
    ", we have @xmath139 \\ds = \\int_0^{l_\\tau}\\!\\!\\!\\langle    f_{in}\\big(x - a{\\epsilon}(s+kl_\\tau ) , y - b\\,s \\big ) ,   \\psi\\big({\\epsilon}(s+kl_\\tau ) , s \\big)\\rangle d s\\\\[4 mm ] \\ds = \\int_0^{l_\\tau}\\!\\!\\!\\!\\!\\!\\langle    f_{in}\\big(x - a{\\epsilon}kl_\\tau , y - b\\,s \\big ) ,   \\psi\\big({\\epsilon}kl_\\tau , s \\big)\\rangle d s + { \\mathcal o}(\\epsilon)\\ , , \\quad   \\end{array}\\ ] ] after using a taylor expansion , since we have suitable properties for both @xmath55 and @xmath140 .",
    "this leads to @xmath141 \\ds = { \\epsilon l_\\tau \\over l_\\tau } \\sum_{k=0}^{k_{\\epsilon}-1}\\int_0^{l_\\tau}\\!\\!\\!\\!\\!\\!\\langle    f_{in}\\big(x - a{\\epsilon}kl_\\tau , y - b\\,s \\big ) ,   \\psi\\big({\\epsilon}kl_\\tau , s \\big)\\rangle d s + { \\mathcal o}(\\epsilon ) \\\\[4 mm ] \\ds \\rightarrow_{\\epsilon \\rightarrow 0 } { 1 \\over l_\\tau}\\int_{0}^{l_\\tau } \\int_0^t \\langle f_{in}(x - at , y - b\\,s ) , \\psi ( t , s , x , y ) \\rangle\\ , dt ds , \\end{array}\\ ] ] using that @xmath142 is of order @xmath143 .",
    "this concludes the proof , as @xmath144;l^2_\\sharp(\\omega)))$ ] is dense in @xmath145;l^2_\\sharp(\\omega)))$ ] .",
    "in this section we shall now introduce several numerical schemes for the resolution of and examine them in more details .",
    "first different time semi - discretizations will be presented and then some words mentioned about a standard up - wind space - discretization .",
    "the time - discretization is the most important step in the construction of ap - schemes . + for this , let us first introduce the following homogeneous discretizations of our time interval @xmath146 $ ] as well as of our simulation domain @xmath147 \\times [ 0,l_y]$ ] :    lll[discret ] t&:= t / n_t , n_t ; & t_n:=n * t , n=0 , , n_t + x&:= l_x/(n_x-1 ) , n_x ; & x_i:=(i-1 ) * x , i=1 , , n_x + y&:= l_y/(n_y-1 ) , n_y ; & y_j:=(j-1 ) * y , j=1 , , n_y .",
    "we denote by @xmath148 the index domain @xmath149 \\times [ 1,n_x ] \\times [ 1,n_y ] \\subset \\mathbb{n}^3 $ ] .",
    "we shall denote further by @xmath150 resp . @xmath151 the numerical approximation of @xmath152 resp .",
    "@xmath153 . recall also that we consider a doubly - periodic framework , such that @xmath154        the first time semi - discretization we shall study will be the implicit - explicit ( imex ) euler method , where the stiff term is taken implicitly , _",
    "i.e _ [ ei ] ( imex ) _",
    "f^,n+1-f^,n t + a _",
    "x f^,n + b _",
    "y f^,n+1=0 , n 0 . to study the behaviour of this scheme , as @xmath21 becomes smaller ,",
    "let us formally let @xmath21 go to zero in and get @xmath155 this equation admits an infinite amount of solutions , namely all periodic functions dependent only on @xmath61 .",
    "this formal analysis permits hence to conclude that the imex scheme can not be an ap - scheme , as it does not capture correctly the asymptotic behaviour of the problem , which is rather given by the limit problem @xmath69 .",
    "this property shall be tested numerically in section [ sec24 ] .",
    "a different way to solve is to use a partial fourier transform in the variable @xmath48 , which is possible here , as we are in a simplified periodic context with constant coefficients .",
    "denoting indeed the fourier coefficients by @xmath156 one has [ ftr ] f^(t , x , y)= _ k=-^ ( t , x ) e^ i _ y k y , where the fourier coefficients are solutions of the system [ fourier ] \\ {    ll _",
    "t + a _ x = 0 , & ( t , x ) + _ t + a _",
    "x + i _ y k = 0 , & k 0 , ( t , x ) .    .",
    "a simple discretization of this problem can be @xmath157 \\ds { \\widehat{f^{\\epsilon , n+1}_k}-\\widehat{f^{\\epsilon , n}_k } \\over \\delta t } + a \\ ; \\partial_x \\widehat{f^{\\epsilon , n}_k } + { \\mathbf i } \\ ;",
    "\\omega_y k { b \\over \\epsilon }   \\ ; \\widehat{f^{\\epsilon , n+1}_k}= 0 \\ , , \\quad \\forall k \\neq 0\\ , , \\,\\ , \\forall n \\ge 0\\ , .",
    "\\end{array } \\right.\\ ] ] solving this system and using the inverse fourier transform permits to get the desired result , _",
    "i.e. _ the values of the unknowns @xmath151 , solution of .",
    "+ let us investigate now the behaviour of this system when @xmath53 .",
    "formally we get @xmath158    \\widehat{f^{\\epsilon , n+1}_k}= 0 \\ , , \\quad \\forall k \\neq 0\\ , , \\,\\ , \\forall n \\ge 0\\ , .",
    "\\end{array } \\right.\\ ] ]    therefore , we find a discretized version of the vlasov limit problem @xmath69 , signifying that this method will be `` asymptotic - preserving '' .",
    "+ the fourier method is very nice , however it can be applied only in a simplified periodic framework with constant coefficients . as a sort of generalization one can think at the micro - macro method , which is based on the decomposition of each quantity in its mean part over the variable @xmath48 , denoted by @xmath159 or simply @xmath160 and the fluctuation part @xmath161 or simply @xmath162 , defined as follows @xmath163 taking now the average of the advection equation over @xmath48 and subtracting the resulting equation then from the initial one , yields a system to be solved for the unknowns @xmath164 , _",
    "i.e. _ [ mm ] ( mm)_\\ {    ll _",
    "t h^+ a _ x h^=0 , & ( t , x ) + _ t h^+ a _ x h^+ b _ y h^=0 , & ( t , x , y ) +     .",
    "let us study now the behaviour of this system when @xmath53 .",
    "we have formally [ mm ] ( mm)_0 \\ {    ll _",
    "t h^0 + a _",
    "x h^0=0 , & ( t , x ) + _ y h^0 = 0 , & ( t , x , y ) +     .",
    "the two last equations establish that @xmath165 .",
    "hence the system @xmath166 is nothing else than the vlasov limit system @xmath69 .",
    "again , we have created a scheme which is a regular perturbation of the asymptotic limit model , and shall be hence `` asymptotic - preserving '' .",
    "this method is rather similar to fourier method , however more general , as it can be applied in rather broad contexts . to understand this similitude , remark that @xmath159 is nothing else than the first fourier coefficient @xmath167 and the fluctuation @xmath161 regroups the remaining fourier modes",
    "however , there is still a disadvantage or difficulty , namely the implementation of the constraint @xmath168 , which is crucial for the passage to the limit @xmath53 .",
    "it is this constraint which permits in the limit to get a unique @xmath169 and to have thus a well - posed limit problem @xmath166 . but averaging along the anisotropy lines can be very difficult in more general contexts , for ex . when these lines are not aligned with the axes .",
    "the filtering procedure is based on the ansatz [ ansatz ] f^(t , x , y):=f^(t , x , y+b t ) , ( t , x , y ) , which inserted in gives the following equation for the smooth function @xmath170 [ feps ] \\",
    "x f^=0 , ( t , x , y ) , + f^(0,x , y)=f_in(x , y ) .    .",
    "this problem is no more a singularly perturbed one and can be solved in a standard way , the original function @xmath77 being recovered via .",
    "+ this procedure is a simplified version of two - scale or filtering methods @xcite , which consists in the separation of the two scales , in particular in finding first the characteristic curves , corresponding to the dominant operator , here @xmath171 , and using these curves to filter out the rapid dynamics , via an ansatz like , leading then to the resolution of a smooth problem ( of the type ) for the slow dynamics .",
    "these methods are very efficient , will be however not treated in the present paper , as we would like to study simpler methods , without having to compute the characteristics .",
    "the lagrange - multiplier method or simply lagrangian method is based on the idea to replace the stiff , dominant term @xmath172 by a smoother one @xmath173 , yielding the system [ la ] ( la)_\\ {    l _",
    "x f^+ b _ y q^=0 , ( t , x , y ) + _",
    "y f^= _ y q^ , ( t , x , y ) + q^_| _ in=0 ,    . where the inflow boundary is defined as @xmath174 . in the limit @xmath53 one",
    "remarks that @xmath175 is a sort of lagrange multiplier corresponding to the constraint @xmath176 , where the name of the method .",
    "first , we will prove the equivalence between the system @xmath177 and the vlasov equation @xmath78 , proving thus the well - posedness of the reformulation @xmath177 .",
    "for this , let us first consider the unique solution @xmath71 of @xmath178 and prove the existence of a function @xmath179 such that @xmath180 solves @xmath177 . since @xmath181 , we have @xmath182 .",
    "the kernel of the dominant operator @xmath172 , denoted by @xmath183 , reads : @xmath184 then we shall decompose @xmath71 in the following manner , which is somehow similar to a hilbert ansatz : @xmath185 with @xmath186 . to have a unique decomposition",
    ", we have to single out the @xmath183-part of @xmath175 , by fixing for example @xmath175 on the inflow boundary @xmath187 , choosing @xmath188 with @xmath189 obviously , we have @xmath190 , implying the uniqueness of the decomposition . replacing now this decomposition in the system @xmath78 , we obtain directly the system @xmath177 , which proves the existence of a solution to @xmath177 .",
    "the converse is trivial , meaning that for @xmath191 solution to @xmath177 , @xmath71 solves @xmath78 .",
    "altogether , we have proved the equivalence between both systems .",
    "now let us consider the limit problem of @xmath177 , obtained by letting formally @xmath22 in [ la2 ] ( la)_0 \\ {    l _",
    "t f^0 + a _",
    "x f^0 + b _",
    "y q^0=0 , ( t , x , y ) + _ y f^0 = 0 , ( t , x , y ) + [ 3 mm ] q^0_| _ in=0 .    .",
    "the second equation leads to @xmath192 .",
    "then , averaging the first equation of in the @xmath48-variable , yields @xmath193 where we used that @xmath194 is @xmath62-periodic .",
    "this equation permits the determination of the limit function @xmath70 .",
    "furthermore , the remaining well - posed system [ la3 ] \\ {    l b _ y q^0=",
    "-_t f^0 - a _",
    "x f^0 , ( t , x , y ) + q^0_| _ in = 0 , ( t , x ) ,    . can be solved to assure finally the existence of the unique solution @xmath195 for the limit problem @xmath196 .",
    "+ the lagrangian scheme seems to be the most `` far - reaching '' ap - scheme .",
    "the only disadvantage of this method is that we have now two unknowns and hence two equations to be solved , meaning longer simulation times .",
    "however , we are no more forced to follow the anisotropy lines and can choose cartesian , not - field aligned grids .      for any numerical scheme presented above , we decided to consider the standard upwind method to discretize the transport terms in the equation .",
    "the idea behind this choice is that the space - discretization is not the important step in the construction of an ap - scheme , such that we opted for a simple discretization , in order not to embroil the further numerical analysis as well as the understanding of the main ideas of our methods .",
    "the same arguments incited us to select only first order discretizations in time .",
    "a runge - kutta coupled to a second - order space - discretization would be naturally more accurate , changes however nothing in the essential concept of our ap - strategies .",
    "as mentioned earlier , in a forthcoming paper we shall be concerned with a realistic , fusion plasma situation , such that we shall adapt the most adequate of the here presented schemes to more accurate second order techniques , to gain in accuracy .",
    "+ now , let us recall the first - order upwind forms    @xmath197 we have analogous formulae for the partial derivative in the @xmath48-variable .",
    "denoting now @xmath198 and @xmath199 and using the periodicity , _",
    "i.e. _ @xmath154 the completely discretized imex scheme writes finally : @xmath200 for all @xmath201 \\times [ 1,n_x-1 ] \\times [ 1,n_y-1]$ ] .",
    "we remark that we can rewrite this scheme like a system of @xmath202 equations : [ syst_im ] _",
    "i^n+1 = _ i^n , n 0 , i , where : @xmath203    @xmath204    at each time step , we resolve this system @xmath205 $ ] , to get the unknowns @xmath206 .",
    "remark that @xmath207 is a regular perturbation of a singular , cyclic matrix @xmath208 .",
    "in this part , we shall test numerically every scheme introduced in the previous section for the resolution of the anisotropic vlasov equation . the homogeneous time and phase - space discretization",
    "was previously introduced in and we choose in the sequel the following parameters : @xmath209 , @xmath210 , @xmath211 , @xmath212 , @xmath213 , @xmath214 and @xmath215 .",
    "changes in these parameters shall be explicitly mentioned .",
    "the initial condition we adopt is given by : @xmath216 \\times [ 0,l_y ] .",
    "\\end{aligned}\\ ] ] we recall that the exact solution of is known and reads , for each @xmath217 : @xmath218 , \\quad \\forall ( t , x , y ) \\in [ 0,t ] \\times \\omega.\\end{aligned}\\ ] ] in figure [ figure1 ] , we reveal two graphics which contain on the one hand @xmath55 and on the other hand @xmath219 at the final time @xmath209 .",
    "[ f0 ] [ f_ana ]    furthermore , in order to better figure out our problem , we plotted in figure [ figure2 ] the exact solution of the limiting vlasov system at the final time @xmath220 , i.e. @xmath221 .",
    "remark that this solution is homogeneous in the @xmath48-variable .",
    "finally , we show in figure [ figure_fluctu ] the time - evolution of the exact solution @xmath219 at one point only , _",
    "i.e. _ @xmath222 .",
    "we distinguish easily on the left plot ( a ) of fig .",
    "[ figure_fluctu ] the two periods : one linked with the @xmath61-variable , and the other one corresponding to the @xmath48-variable .",
    "this last one is @xmath21-dependent and we see that more @xmath21 is small , more the frequency of the oscillations becomes important . in order to observe more precisely this phenomenon , we eliminate the @xmath61-variable in the problem and consider a 1d problem , keeping only the term containing the parameter @xmath21 . the time - evolution of the exact solution at the point @xmath223 is now plotted in fig .",
    "[ figure_fluctu ] ( b ) .",
    "one observes here more easily that with smaller becoming @xmath21 , the frequency of the oscillations is increasing .",
    "in the limit @xmath22 , @xmath224 converges weakly towards the average , which is here the constant @xmath225 .",
    "[ f0 ]    [ fluctu_ana ] [ f_ana ]      in this section , we examine the numerical results obtained via the different schemes for the resolution of .",
    "we start by first showing in fig .",
    "[ figure3 ] as well as in the left plot of fig .",
    "[ figure4 ] , the numerical solution @xmath71 for three different values of @xmath21 , namely @xmath226 , @xmath227 and @xmath228 , all of them at the final time @xmath209 .",
    "[ f0 ] [ f_eps ]    for @xmath229 , we recognize an approximation of the exact solution ( see figure [ figure1 ] ) and for @xmath228 , the limit solution is clearly obtained ( see figure [ figure2 ] ) . briefly one can say that the numerical solution follows the weak-@xmath83 convergence @xmath230 as @xmath21 becomes smaller and smaller .",
    "but , one can also remark a numerical diffusion which leads to a loss of amplitude , especially visible in the non - limit case @xmath226 or @xmath231 . to observe better this numerical diffusion ,",
    "we show in the right plot of fig .",
    "[ figure4 ] the time - evolution of just one point of the numerical solution , corresponding again to a one - dimensional situation as the one plotted on the right of fig .",
    "[ figure_fluctu ] , and this for several values of @xmath21 .",
    "[ f0 ] [ f_ana ]    indeed , the two - dimensional situation is not so eloquent , such that we skipped directly to the analysis of the one dimensional case , where we can easier see the damping of the oscillations , when @xmath21 becomes smaller .",
    "in particular , the damping is more and more pronounced if @xmath22 . for small @xmath21-values",
    "the numerical solution recovers quasi immediately the weak limit solution , here the constant @xmath225 . this damping phenomenon will be studied and explained in the numerical analysis part , section [ sec25 ] .",
    "let us now present analogous results for the remaining schemes , namely the fourier , micro - macro and lagrange schemes .",
    "the 2d plots are rather similar to the ones presented for the imex - scheme ( see fig .",
    "[ figure3]-[figure4 ] ) . to examine the difference between these methods , we preferred to plot in fig .",
    "[ figure_fluct ] only the time - evolution of the numerical solution in the 1d - context again .",
    "we remark that the damping of the fourier method is more slowly than the ones of the imex - scheme as well as micro - macro and lagrangian - scheme .",
    "but , once again we observe that in the limit @xmath232 , the fluctuations are completely damped out and we recover the weak limit solution .",
    "let us study now the convergence of the here presented schemes with respect to time and space , and this for fixed @xmath133 , permitting to show their validity in the large @xmath21-regime .",
    "for this , fix @xmath217 and consider the error between exact and numerical solutions as a function of the mesh - size , at the final time t. firstly , concerning the convergence with respect to @xmath233 , we choose small space steps ( @xmath234 ) such that the space errors are much smaller than the time error and vary then the time step .",
    "equally we apply the same strategy for the convergence with respect to @xmath235 and @xmath236 , by fixing a time step of @xmath237 . in all cases , the parameter @xmath21 is fixed to @xmath225 . in figure",
    "[ tronca ] , we have plotted curves in log - log scale , showing the evolution of the errors as a function of @xmath235 , @xmath236 and @xmath233 , respectively .    [ temps ] [ tronca_x ] [ sub : renonc ]    as expected , we observe that all schemes are first order in time and space . some comments are however necessary to understand figure [ tronca ] .",
    "first , the slop of the curves gets smaller than @xmath225 in the small - grid ranges .",
    "this is due to the fact that the error to be investigated becomes as small as the fixed error term and saturates .",
    "secondly , the slope of the curves becomes also smaller in the large - grid ranges .",
    "this is usual , as for large discretization steps , the rest - terms in the taylor series for the error analysis can no longer be neglected .",
    "finally , we would like to draw the attention of the reader to the fourier error curve , which has a constant slope in ( b ) .",
    "this is completely natural , as the fourier method has spectral accuracy .      to begin the study of the asymptotic behaviour",
    ", we define the following two errors @xmath239 where @xmath240 represents the @xmath241- error between the exact and the numerical solution at instant @xmath63 , for fixed @xmath242 , whereas @xmath243 denotes the @xmath241- error at instant @xmath63 between the numerical solution @xmath244 and the exact limit solution @xmath245 .",
    "we are interested in the evolution of these two errors at the final time @xmath220 as functions of @xmath21 .",
    "the curves corresponding to the different schemes are plotted in figure [ figure11 ] .",
    "as expected , we observe a decrease of @xmath246 and an increase of @xmath247 when @xmath248 . for @xmath22 the converse behaviour",
    "is observed .",
    "this plot shows that each scheme approximates well either the exact solution @xmath249 for large @xmath21 , or the exact limit solution @xmath245 for small @xmath21 .",
    "what can be said as a conclusion , is that all schemes seem to have the right asymptotic behaviour in this simple test case .",
    "indeed , for fixed @xmath217 , each numerical solution @xmath244 converges to the expected solution @xmath219 as long as the discretization steps tend to @xmath250 . for fixed discretization steps , all numerical solutions @xmath244 converge towards the limit solution @xmath251 when @xmath21 becomes smaller and smaller , underlying the ap property of our methods . + it is worth mentioning however that the imex - scheme is no more working for @xmath21 smaller than @xmath252 , the matrix @xmath253 of the imex linear - system , namely @xmath254 is becoming numerically singular in the limit @xmath53 .",
    "this is not the case for the micro - macro as well as lagrangian - schemes , which give accurate results even for @xmath255 .",
    "this difference in the behaviour can be observed also from the study of the condition - number of the discretization matrices , paying attention especially on the @xmath21-dependence .",
    "remark here that an `` asymptotic - preserving scheme '' must have an @xmath21-independent condition number , depending merely on the discretization parameters @xmath235 , @xmath236 .",
    "[ cond ] we plotted thus the matrix condition - number @xmath256 corresponding to the three schemes ( imex , micro - macro and lagrangian ) as a function of @xmath21 .",
    "what can be observed is that for the micro - macro and lagrangian - scheme , the condition - number is @xmath21-independent ( for @xmath257 ) , which is a hint of the well - posedness of these two problems in the limit @xmath53 , namely of @xmath166 resp . @xmath196 . on the other hand , for the imex - scheme",
    "@xmath258 is proportional to @xmath259 ( slope of the curve is approx .",
    "@xmath260 ) .",
    "this circumstance is the translation on the discrete level of the fact that the reduced model , obtained on the continuous level by letting formally @xmath53 in the imex time - discretization , is ill - posed , admitting an infinite amount of solutions .",
    "+     [ cond_a ]    however , even if these arguments show clearly that the imex - method should behave badly for very small @xmath21-values , it is not the case in our simplified toy model , in particular it does not seem to be affected by the bad condition number",
    ". this will no more be the case in our second toy - model .",
    "to understand in detail what happens , a more refined error study could be profitable and shall be done in the next section .",
    "the final interpretation is postponed to section [ disc ] after having estimated the truncation error .",
    "one can only say here that the functioning of the imex - scheme is due to the fact that the investigated problem is very simple and specifically the anisotropy is aligned with the cartesian mesh .",
    "in this section , we are interested in a more detailed numerical analysis of our schemes introduced for the resolution of the vlasov problem . in particular we shall detail only the error - analysis of the standard imex - scheme and the _ asymptotic - preserving _ lagrangian scheme .",
    "the error study of the other schemes is very similar .",
    "we begin by recalling the full discretized form of the imex scheme : [ el_2 ] ( imex ) _",
    "f^,n+1_i , j - f^,n_i , j t + a + = 0 , ( n , i , j ) q_h . [ th_i ] the imex scheme is consistent with the vlasov equation , and first order accurate in space and time .",
    "furthermore , the local truncation error writes @xmath261 with @xmath262    finally , we observe that the imex scheme is a second - order scheme for the modified vlasov equation [ modified ] _",
    "t g^ + a _ x g^ + _ y g^ - ( 1- ) _ xx g^ - ( 1 + ) _ yy g^=0 .",
    "the local truncation error of the method is defined by @xmath263 supposing that @xmath71 is sufficiently smooth in order to apply a taylor development , we find @xmath264 where @xmath71 is taken in @xmath265 . since @xmath71 satisfies the vlasov equation , the @xmath266 terms drop out . moreover , by differentiating the vlasov equation along @xmath63 , @xmath48 and @xmath61 , we express the partial derivatives @xmath267 and @xmath268 as functions of @xmath269 and @xmath270 .",
    "we find thus @xmath271 the local truncation error writes finally @xmath272    the modified equation is an advection / diffusion equation .",
    "note that the diffusion is stronger in the @xmath48-direction due to the term @xmath273 .",
    "these diffusion terms are responsible for the damping that we observed in the numerical simulations ( see fig .",
    "[ figure4 ] ( b ) ) , damping which tends towards infinity in the @xmath48-direction , as @xmath22 .",
    "note also that the diffusion coefficient is positive if @xmath274 .",
    "this is precisely the stability condition of the upwind scheme , as we will see afterwards .",
    "if this condition is not respected , the diffusion becomes negative , leading to an ill - posed problem with exponentially growing solutions .",
    "the imex scheme is stable in the von neumann sense if and only if the cfl - condition @xmath275 is satisfied .    to study the stability of our scheme ,",
    "let us inject in for fixed @xmath276 a plane wave of the form @xmath277 with @xmath278 two arbitrary modes , and look how it evolves from one time - step to the other .",
    "let us denote by @xmath279 the amplification factor for this passage @xmath280 , meaning @xmath281 inserting now these terms in the discretized equation , yields , after simplification @xmath282 = \\bigg [ 1 - \\frac{a \\delta t}{\\delta x}(1- e^{-{\\mathbf i } k \\delta x } ) \\bigg].\\end{aligned}\\ ] ]    a scheme is said to be stable in the von neumann sense , if the amplification factor satisfies @xmath283 , such that the modes are not amplified from one time - step to the other .",
    "straightforward computations yield @xmath284 note that in the case @xmath285 , when @xmath21 tends towards @xmath250 , the amplification factor converges towards @xmath250 .",
    "this means that for injected waves with mode @xmath285 , the scheme becomes more and more diffusive and attenuates completely the oscillations .",
    "we do now the same work for the lagrangian scheme , _",
    "i.e. _ [ la_2 ] ( la)_\\ {    l + a + b = 0 , ( n , i , j ) q_h + = , ( n , i , j ) q_h + q^,n_i,1 = 0 , ( n , i ) .    .    the lagrangian scheme is consistent with the vlasov equation , and first order accurate in space and time .",
    "furthermore , the local truncation error for @xmath106 writes @xmath286 with @xmath287    in order to prove the result , we write the local truncation error of the first equation .",
    "we find that @xmath288    since the first equation of is verified by @xmath180 , we have @xmath289 then , @xmath290    since the second equation of is verified , we have @xmath291 such that we find the same expression as for the imex scheme , _",
    "@xmath292    the just proved result confirms what we have seen on the numerical plots .",
    "indeed , the imex and lagrangian schemes have the same behaviour concerning the convergence .",
    "the lagrange scheme is stable in the von neumann sense if and only if the cfl condition @xmath275 is satisfied .    here , we have two unknown functions @xmath71 and @xmath179 .",
    "to study the von neumann stability , we write @xmath293 with the two amplification factors @xmath294 and @xmath295 . as usual , we insert these expressions in the discretized lagrangian equations .",
    "we obtain a linear system where the unknowns are @xmath294 and @xmath295 .",
    "this system writes @xmath296 and is easy to invert .",
    "computing the amplification factor @xmath295 , we remark that it is identical to the one calculated for the imex scheme .",
    "we are now in the possibility to explain the numerical results obtained in section [ sec24 ] , in particular to explain why the imex - scheme , even if being not an ap - scheme , gives in this simple field - aligned test case , good results up to a value of @xmath297 . for this , let us recall that two types of errors arise during a numerical resolution of the vlasov equation .",
    "first of all we have the truncation errors , estimated in the last subsections , and secondly one has also the round - off errors , arising at each elementary computation . to be more precise , one has to consider the three linear systems , corresponding to : @xmath298 where to simplify notation we omitted all the time and space indices .",
    "here we denoted by @xmath299 the exact solution of the vlasov equation , satisfying the linear system up to a truncation error @xmath300 , @xmath301 is the exact solution of the linear system , supposing exact arithmetics , and finally @xmath302 is the solution to the linear system obtained via a computer , hence polutted with round - off errors .",
    "the error we are interested in , can be estimated as follows @xmath303 stability and consistency permit to show that the first error term is of the order of the truncation error . for the estimate of the second error term",
    ", we have to take into account the condition number of the matrix , in particular one has the estimate @xcite @xmath304 performing our computations in double precision ( machine accuracy of @xmath305 ) , and as long as the condition number is not exceeding a value of @xmath306 ( see fig . [ cond ] ) , the second error term is not so dangerous . for larger condition numbers , this term can give rise to erroneous results . in our test case , it is however rather the first error - term which leads to trouble , as the truncation error is @xmath259-dependent .",
    "but , in the first toy - model , the large truncation error impacts only the @xmath48-direction , leading to a large diffusion along the axes - aligned anisotropy and hence to the limit - model .",
    "we shall see a drastic difference in the second , not - field aligned toy - model .",
    "finally , let us come now in this section to the second vlasov toy model , given by : [ eq_cir_0 ] _",
    "t f^ + ( ) = 0 , with @xmath20 and the magnetic field @xmath307 .",
    "this model is a simplified version of the anisotropic vlasov equation in not - field aligned cartesian coordinates . denoting , for notational simplicity , the velocity - variable as @xmath308 , we have @xmath309 $ ] , such that the previous equation writes : [ eq_cir ] ( g ) _ \\ {    l _",
    "t f^ + _ x f^ - _ y f^ = 0 , ( t , x , y ) .",
    "+ f^(0,x , y ) = f_in(x , y ) , ( x , y ) ,    . where this time our velocity - domain is given by @xmath310\\times [ -l_y , l_y]$ ] .",
    "again we will consider a doubly - periodic framework .",
    "the exact solution of the equation is simply determined via the characteristic method .",
    "the characteristic curve @xmath311 passing at instant @xmath63 through @xmath42 , solves the ode : @xmath312 we can write this system under matrix form : @xmath313",
    "leading to @xmath314 denoting the rotation matrix by @xmath315 , one has @xmath316 we can easily verify that the characteristic curve passing through the point @xmath42 is a circle with radius @xmath317 and centre @xmath318 .",
    "all characteristics are @xmath319-periodic .",
    "the solution @xmath71 of the advection equation is now constant along the characteristic curves , such that @xmath320 \\times \\omega,\\ ] ] which leads to the following analytic expression of our unique solution : @xmath321      the next step is to obtain the limit solution of the problem , as @xmath22 . keeping in mind that @xmath71 is constant along the characteristic curves",
    ", we integrate this equation along @xmath322 , to get @xmath323 leading to @xmath324 furthermore , as @xmath325 = 0,\\ ] ] which comes from the periodicity of the characteristics , and denoting the average along a curve by @xmath326 , with @xmath327 , we have : @xmath328 letting now formally @xmath22 , we obtain the following limit problem associated to : [ eq_cir_lim ] ( g)_0 f^0 = f_in .",
    "let us now discretize the second vlasov toy model via the imex and lagrangian schemes .",
    "the time semi - discretizations read [ st_imex ] ( imex ) _",
    "+ _ x f^,n+1 - _ y f^,n+1 = 0 , n 0 , ( x , y ) , as well as [ lag_cir_0 ] ( la)_\\ {    l + y _ x q^,n+1 - x _ y q^,n+1 = 0 , + y _ x f^,n+1 - x _ y f^,n+1 = ( y _ x q^,n+1 - x _ y q^,n+1)+ ( x y)^ q^,n+1    .",
    "the term @xmath329 in is a stabilization term permitting to have the uniqueness of the solution @xmath330 . in the former `` field - aligned '' example",
    ", we fixed @xmath179 on the characteristic lines by setting @xmath331 , but here it is more arduous from a numerical point of view .",
    "the stabilization aims equally to fix @xmath175 , however in a different manner .",
    "it is very delicate to choose the magnitude of this term , in order not to destroy the problem , in particular we took here @xmath332 .",
    "first it is a small perturbation of the equation , of the order of the truncation error .",
    "secondly , averaging the second equation of the lagrangian scheme along the characteristic curves , permits to obtain @xmath333 which means that @xmath179 is unique , by having zero average along the field lines .",
    "for the spatial discretization , we use again an up - wind scheme , observing that this time the equation has no more constant coefficients .",
    "thus , we define : @xmath334 the full discretization of the imex scheme writes now @xmath335 = f^{\\epsilon , n}_{i , j } , \\quad \\forall ( n ,",
    "i , j ) \\in q_h,\\end{aligned}\\ ] ] with @xmath336 and @xmath337 . and for the lagrangian scheme , we have : @xmath338 r_y(x_i^{+}q^{\\epsilon , n+1}_{i , j+1 } - x_i^{-}q^{\\epsilon , n+1}_{i , j-1})\\big ] = f^{\\epsilon , n}_{i , j } ,   \\quad \\forall ( n , i , j ) \\in q_h , \\\\ \\\\ \\displaystyle \\frac{1}{\\delta t}\\big[\\big(r_x ( y_j^{+}-y_j^{-})+r_y(x_i^{+}-x_i^{- } \\big)f_{i , j}^{\\epsilon , n+1 } - r_x ( y_j^{+}f^{\\epsilon , n+1}_{i-1,j } - y_j^{- } f^{\\epsilon , n+1}_{i+1,j } ) - \\\\[3 mm ]   r_y(x_i^{+}f^{\\epsilon , n+1}_{i , j+1 } - x_i^{-}f^{\\epsilon , n+1}_{i , j-1})\\big ]   = \\displaystyle \\frac{\\epsilon}{\\delta t}\\big[\\big(r_x ( y_j^{+}-y_j^{-})+r_y(x_i^{+}-x_i^{- } \\big)q_{i , j}^{\\epsilon , n+1 } - \\\\[3 mm ] r_x ( y_j^{+}q^{\\epsilon , n+1}_{i-1,j } - y_j^{- } q^{\\epsilon , n+1}_{i+1,j } ) - r_y(x_i^{+}q^{\\epsilon , n+1}_{i , j+1 } - x_i^{-}q^{\\epsilon , n+1}_{i , j-1})\\big ] + ( \\delta x \\delta y)^\\gamma \\ ; q^{\\epsilon , n+1}_{i , j } ,   \\quad \\forall ( n , i , j ) \\in q_h .",
    "\\end{array}\\right . \\label{charac}\\ ] ]      here we present our simulations corresponding to both numerical schemes .",
    "we consider @xmath339 ^ 2 $ ] , @xmath209 and the discretization parameters @xmath340 and @xmath341 .",
    "the initial data is defined by a gaussian function : @xmath342 as we showed before , the exact solution is known thanks to the characteristic method . in the present simple test case , one can easily prove that [ ex_ff ] f_ex^(t , x , y ) = f_in(x , y ) = ( - ) , in other words , the exact solution is a stationary solution , independent of @xmath21 .",
    "indeed , the initial condition is itself constant along the characteristic curves .",
    "this simple test case permits in a very simple way to compare both methods with respect to the @xmath21-dependence of the results , in particular to show that the imex - scheme is not an _ asymptotic - preserving _ scheme .",
    "we shall investigate in a future paper a more involved , physical test - case , where we shall adapt the here introduced lagrangian - method , which seems to be the most appropriate method for our singularly - perturbed vlasov problem , to second - order schemes and test more thoroughly its ap - properties .",
    "+ in figure [ cond_2toy ] we first plot the condition - number @xmath343 associated to the two schemes . as for the first toy - model , one remarks the @xmath21-independent condition - number of the lagrangian - scheme , whereas , as expected , the imex scheme has an @xmath259-dependent condition - number .",
    "then , in figure [ figure14 ] , we show the numerical solution @xmath71 at the final time @xmath220 and computed for several values of @xmath21 , with both imex and lagrangian schemes . for @xmath344 and @xmath345 , we do not distinguish any difference .",
    "however for smaller @xmath21 values , the solution obtained with the lagrangian scheme seems to be @xmath21-independent , contrary to the imex scheme , which diffuses more and more as @xmath22 .",
    "indeed , the imex solution is completely damped as @xmath22 and leads towards the zero - solution , whereas the lagrangian scheme keeps the form of the gaussian , with a usual @xmath21-independent @xmath346-diffusion .",
    "this permits to conclude that the lagrangian scheme is an ap - scheme contrary to the imex scheme .    in order to distinguish much better this ap - property , we plot on figure [ figure_gauss ] a cut of the previous curves at the point @xmath347 .",
    "we observe clearly the diffusion in the imex scheme which depends of @xmath21 contrary to the lagrangian scheme .",
    "[ f0 ] [ f_eps ]    [ f0 ] [ f_eps ] [ f0 ] [ f_eps ] [ f0 ] [ f_eps ] [ f0 ] [ f_eps ]      the aim of this section is to explain the plots presented before .",
    "in particular we will investigate why the imex scheme does not work for small @xmath21-values , whereas the lagrange scheme preserves the asymptotics .",
    "first of all , we compute the local truncation error of both schemes .",
    "we shall consider only the case @xmath348 and @xmath349 .",
    "other cases do not change the following reasoning .",
    "we begin by recalling the expression of the full discretized expression of this scheme : [ euler_2 ] ( imex ) _",
    "f^,n+1_i , j - f^,n_i , j t + - = 0 , ( n ,",
    "i , j ) q_h .    the imex scheme is consistent with the second vlasov problem , first order accurate in time and in space .",
    "moreover , the local truncation error writes @xmath350 } + \\mathcal{o}(\\delta t ^2 )   + \\mathcal{o}(\\delta x ^2 ) + \\mathcal{o}(\\delta y ^2).\\ ] ] where @xmath351    this proof is very similar to the proof of theorem [ th_i ] .",
    "contrary to the first toy - model , where the diffusion was @xmath259-dependent only in the anisotropy - direction , which was aligned with the coordinate system , in the present case , the diffusion - matrix is scaled by a @xmath259 factor , meaning that this time we have a very strong @xmath259-dependent diffusion in all directions .",
    "this large diffusion leads rapidly to a damping of the solution towards zero , as @xmath21 becomes smaller , and leads thus to completely erroneous results .",
    "we use the same reasoning for the lagrangian scheme [ lag_cir ] ( la)_\\ {    l _",
    "t f^ + y _ x q^ - x _ y q^ = 0 , + y _ x f^ - x _ y f^ = ( y _ x q^ - x _ y q^ ) + ( x y)^ q^.    .",
    "supposing @xmath352 and @xmath353 , we have the full discretization of @xmath354 [ lag_2 ] ( la)_\\ {    l + y_j -x_i = 0 , + y_j -x_i = ( y_j -x_i ) + + ( x y)^ q^,n+1_i , j .    .",
    "the lagrangian scheme is consistent with the second vlasov model and first order accurate in time and in space .",
    "furthermore , the local truncation error writes @xmath355 & \\hspace{1.7 cm } = \\left ( \\begin{array}{c } \\displaystyle \\nabla\\,(d_{l_1 } \\ , \\nabla q^{\\epsilon})\\\\[3 mm ] \\displaystyle \\nabla\\,(d_{l_2 } \\ , \\nabla f^{\\epsilon } ) - \\epsilon \\nabla\\,(d_{l_2 } \\ , \\nabla q^{\\epsilon } ) \\end{array } \\right)+\\mathcal{o}(\\delta t ^2 , \\delta x ^2,\\delta y ^2)\\end{aligned}\\ ] ] where @xmath356    we begin by the computation of the @xmath357 term . supposing sufficient regularity for the functions @xmath71 and @xmath179 , we use taylor series expansion to get @xmath358    since the first equation is verified , we can write @xmath359 and we differentiate in time the second equation of to obtain @xmath360    we have the following relations @xmath361    the local truncation error writes finally @xmath362 with an analogous reasoning , we compute the truncation error of the second equation :    @xmath363    in contrast to the first vlasov toy - model , the imex and lagrangian schemes do not have the same behaviour with respect to the local truncation error .",
    "more particularly , the dependence on @xmath21 is very different .",
    "the imex - scheme is diffusing in all directions , diffusion proportional to @xmath259 .",
    "the only @xmath259-dependent diffusion in the lagrange scheme arises in relation with the auxiliary unknown @xmath175 , _ i.e. _ in the term @xmath364 .",
    "and one can immediately verify that the @xmath259-dependence arises only aligned with the anisotropy field lines , and not perpendicular to them .",
    "indeed , one gets immediately for the diffusion along resp .",
    "perpendicular to the field lines , the formulae : @xmath365 \\ds ( x\\,,\\ , y)\\ , d_{l_1 } \\ , ( x\\,,\\ , y)^t&=&\\ds   { x\\ , y \\over 2 } \\left[x\\ , \\delta x + y\\ , \\delta y \\right ] \\ , .",
    "\\end{array}\\ ] ]",
    "to conclude , let us summarize here the knowledge we acquired about the resolution of anisotropic vlasov equations of the type arising in fusion plasma modelisation .",
    "two types of techniques can be adopted from the beginning .",
    "one can decide to pass directly to polar coordinates in velocity and get hence a field - aligned formulation as for ex . .",
    "in this case , a simple imex - scheme is the most appropriate scheme to be used , being simple enough and giving rise to accurate results up a sufficiently small @xmath21-value .",
    "however , the disadvantage is that one has to change coordinate system , which can be rather cumbersome if the magnetic field is variable , in time and space .",
    "+ the second technique is rather simple , as it avoids to pass to field - aligned coordinates and remains in a nice cartesian framework .",
    "the drawback is that in this case it is no more sufficient to implicit the stiff term and take the other terms explicitly . indeed , for very small @xmath21-values , meaning very strong magnetic fields as in tokamak plasmas , an imex scheme would lead to erroneous results .",
    "an asymptotic - preserving reformulation like our `` lagrangian - method '' is more adequate , leading in the limit @xmath22 towards the right limit - problem .",
    "this lagrangian - method is indeed usable for all @xmath366 and gives accurate and stable results independently on @xmath21 .",
    "however there is a disadvantage , namely the fact that it is more time - consuming , as it involves an additional unknown @xmath175 .",
    "+ solving an anisotropic vlasov equation of the type needs hence an _ a priori _ decision , which of these two techniques to follow .",
    "the first technique is at the moment the basis of several codes .",
    "the second technique has not be tested up to now , and its rigorous validation and comparison with the first one will be the aim of a forthcoming paper , in a more physical context .",
    "+ finally , let us say some words about _ asymptotic - preserving _ schemes . in general , inaccuracy in numerical simulations can result from applying unstable algorithms to well - conditioned problems or stable algorithms to ill - conditioned problems . dealing with singularly - perturbed problems is a hard task , as they are ill - conditioned from the beginning .",
    "a standard , stable discretization ( imex in this case ) often results in inaccurate results .",
    "the essence of ap - procedures is to replace singularly - perturbed problems by equivalent problems , which are regularly perturbed , well - conditioned problems , leading to uniformly accurate results , if stable algorithms are used ( lagrangian - scheme here ) .",
    "* acknowledgments . *",
    "the authors would like to acknowledge support from the anr peppsi ( plasma edge physics and plasma - surface interactions , 2013 - 2017 ) .",
    "furthermore , this work has been carried out within the framework of the eurofusion consortium and has received funding from the euratom research and training program 2014 - 2018 under grant agreement no 633053 .",
    "the views and opinions expressed herein do not necessarily reflect those of the european commission ."
  ],
  "abstract_text": [
    "<S> goal of this paper is to investigate several numerical schemes for the resolution of two anisotropic vlasov equations . </S>",
    "<S> these two toy - models arise from a kinetic description of a tokamak plasma confined by strong magnetic fields . </S>",
    "<S> the simplicity of our toy - models permits to better understand the features of each scheme , in particular to investigate their _ asymptotic - preserving _ properties , in the aim to choose then the most adequate numerical scheme for upcoming , more realistic simulations . </S>"
  ]
}