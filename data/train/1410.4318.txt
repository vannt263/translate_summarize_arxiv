{
  "article_text": [
    "we have demonstrated in the text , that the set of gates depicted in fig . 1 ( in the main text ) allows to implement any controlled - unitary transformation in the signal qubit mode .",
    "the overall operation of the gates on the signal qubit can be described by the matrix @xmath67 it is however customary to decompose the desired unitary transformations in the form of @xmath68 in this section , we find analytical formulas allowing to map the set of parameters @xmath69 , used in the matrix @xmath9 describing our scheme , to the set of decomposition parameters @xmath70 .",
    "let us now express both the transformations @xmath55 and @xmath9 in matrix forms using definitions introduced in the main text .",
    "secondly , we derive the matrix form of the decomposed unitary transformation @xmath74 our goal is now to find a unique relation between both sets of three parameters , that guarantee equivalence @xmath75 .",
    "we start by comparing the amplitudes of the individual terms of the matrices .",
    "one can straightforwardly identify @xmath76 and simultaneously @xmath77 since the relation @xmath78 holds disregarding the values of @xmath1 and @xmath28 , one can always fulfil both conditions ( [ eq : univ_amplitude1 ] ) and ( [ eq : univ_amplitude2 ] ) simultaneously .",
    "these equations allow to calculate parameter @xmath79    analysing the phases of the diagonal and offdiagonal terms directly reveals that @xmath80 respectively @xmath81 this set of two equations can be easily solved obtaining both @xmath82 and @xmath6 as functions of @xmath27 and @xmath83 , that is the polar angle of the complex number @xmath84 .",
    "it is fair to derive also inverse relations between both sets of parameters . by directly comparing the real part of @xmath84 with the real part of the corresponding term in @xmath55",
    ", we obtain @xmath85 comparing the imaginary part of @xmath84 with the imaginary part of corresponding term in @xmath55 and using ( [ eq : inverse1 ] ) one finds the second inverse relation @xmath86 finally , from ( [ eq : univ_phase2 ] ) it is trivial to derive the last inverse relation @xmath87      in our experiment we encode qubits into polarization state where @xmath16 corresponds to horizontally polarized @xmath33 and similarly @xmath18 corresponds to vertical polarization @xmath34 .",
    "we have constructed the experimental setup as shown in fig . 2 in the main text .",
    "this setup consists of a tunable c - phase gate enveloped in the signal mode by single qubit transformations used to set required unconditional rotations @xmath88 and @xmath89 .",
    "these rotations are implemented by sets of one half - wave plate and one quarter - wave plate inserted in front and behind the c - phase gate .",
    "the control state preparation is achieved by individual half - wave plate in the control mode since only logical states @xmath18 and @xmath16 are required to switch the unitary operation on the signal qubit on and off .    in order to simplify the experimental scheme and to limit the number of required wave plates , we used only one set of half and quarter - wave plates in front of the c - phase gate to set the rotations @xmath37 and @xmath38 and in the same time to adjust required input state . similarly ,",
    "the half and quarter - wave plates behind the c - phase gate are used to implement both the rotations @xmath15 and @xmath14 and to accomplish polarization projection required for the complete process tomography of the signal mode .",
    "we tested the operation of our device for six different settings of the parameters @xmath69 .",
    "the results of our experiments were summarized in tab .  1 in the main text , where we listed estimated fidelities and purities , that are typically about 90% . due to the limited space of the main text we plot examples of the experimental estimated and theoretical matrices of the controlled - unitary operation in this section in fig .",
    "[ fig : supp_res_cud3pi4 ] .",
    "the plotted diagrams indicate very good agreement of our experiment with the theoretical predictions ."
  ],
  "abstract_text": [
    "<S> we show that it is possible to reduce the number of two - qubit gates needed for the construction of an arbitrary controlled - unitary transformation by up to two times using a tunable controlled - phase gate . on the platform of linear optics , where two - qubit gates can only be achieved probabilistically , </S>",
    "<S> our method significantly reduces the amount of components and increases success probability of a two - qubit gate . </S>",
    "<S> the experimental implementation of our technique presented in this paper for a controlled single - qubit unitary gate demonstrates that only one tunable controlled - phase gate is needed instead of two standard controlled - not gates . </S>",
    "<S> thus , not only do we increase success probability by about one order of magnitude ( with the same resources ) , but also avoid the need for conducting quantum non - demolition measurement otherwise required to join two probabilistic gates . </S>",
    "<S> subsequently , we generalize our method to a higher order , showing that @xmath0-times controlled gates can be optimized by replacing blocks of controlled - not gates with tunable controlled - phase gates .    </S>",
    "<S> quantum computing is a promising direction in information processing @xcite . similarly to classical computing , quantum circuits are composed of various elementary gates . in 1989 , deutsch proved the existence of a universal three - qubit gate @xcite . </S>",
    "<S> later , divincenzo showed that deutsch s gate can be implemented by a sequence of two- and single - qubit gates @xcite . </S>",
    "<S> meanwhile , barenco discovered a class of two - qubit gates sufficient for building any quantum circuit @xcite . </S>",
    "<S> a practical set of universal gates was defined later @xcite . </S>",
    "<S> this set of gates includes several single - qubit gates and only one two - qubit gate  the controlled - not ( cnot ) gate .    although the method presented by barenco _ et al .  _ </S>",
    "<S> @xcite shows how to construct any quantum circuit , it does not take into account various optimization procedures @xcite . </S>",
    "<S> optimization is crucial in linear optics , where the cnot gate can only be implemented probabilistically @xcite , meaning that every repetition reduces the success probability of the entire scheme .    in 2009 , lanyon _ et al .  </S>",
    "<S> _ demonstrated a considerable reduction in the number of cnot gates necessary for circuit construction by introducing additional ancillary modes @xcite . </S>",
    "<S> they have constructed a toffoli gate ( controlled - controlled - not gate ) with only two cnot gates and have also designed a generalized controlled - phase gate , but not an optimal one . </S>",
    "<S> miuda _ </S>",
    "<S> et al .  </S>",
    "<S> _ presented a method further reducing resources needed for the implementation of a toffoli gate to only one cnot gate @xcite . </S>",
    "<S> this reduction is achieved by combining polarization and spatial encoding to encode a two - qubit state into one single photon . </S>",
    "<S> however , the preparation of a specialized control two - qubit state is problematic . </S>",
    "<S> it is possible to use quantum routers ( or quantum state fusion ) @xcite , but this would mean using additional cnot gates , which would cancel the achieved reduction .    so far only optimizations involving standard cnot or controlled - sign ( c - sign ) gates were considered . in 2010 , kieling _ </S>",
    "<S> et al .  </S>",
    "<S> _ proposed an optimal ( without auxiliary photons ) linear - optical implementation of a tunable c - phase gate that imposes a given tunable phase shift @xmath1 @xcite @xmath2 and @xmath3 take values of logical qubit states @xmath4 or @xmath5 and @xmath6 is the kronecker s delta . in 2011 , </S>",
    "<S> the first optimal tunable c - phase gate was experimentally demonstrated @xcite . </S>",
    "<S> the experiment also allowed to verify and explain the optimal success probability of the gate as a function of the phase shift @xmath1 @xcite .    in this letter </S>",
    "<S> we show that using a tunable c - phase gate instead of a cnot gate makes it possible to ( i ) reduce the complexity of various quantum circuits and ( ii ) increase the success probability of these circuits in linear optics . </S>",
    "<S> the support for our idea comes from an experimental implementation of the proposed scheme .    </S>",
    "<S> _ arbitrary single - qubit controlled - unitary transformation _  it has been shown by barenco _ </S>",
    "<S> et al .  _ </S>",
    "<S> @xcite that two controlled - sign gates are needed to implement an arbitrary controlled - unitary operation acting on a signal qubit and controlled by a control qubit . in special cases , </S>",
    "<S> one controlled - sign gate is sufficient , but at the expense of restricting the class of implemented operations . </S>",
    "<S> considering the probabilistic nature of controlled - sign gates on the platform of linear optics , it is crucial to limit their repetition as much as possible . </S>",
    "<S> we show that only one single tunable controlled - phase gate is needed for the construction of a universal single - qubit controlled - unitary operation . </S>",
    "<S> note , that the success probability of two consecutive controlled - sign gates would be @xmath7 ( using linear optics only and no photon ancillae ) , the minimum success probability of a tunable controlled - phase gate is @xmath8 ( 0.14 on average ) . </S>",
    "<S> moreover , by reducing the number of gates from two to one , we also avoid the need for intermediary non - demolition presence detection otherwise required to join two probabilistic gates @xcite .     </S>",
    "<S> ( color online ) quantum computation circuit implementing an arbitrary single - qubit controlled - unitary operation @xmath9 [ see eq . </S>",
    "<S> ( [ eq : w ] ) ] by means of one tunable controlled - phase gate and several unconditional single - qubit operations . ]    </S>",
    "<S> let us consider the scheme depicted in fig . </S>",
    "<S> [ fig : universal ] . </S>",
    "<S> while the upper ( control ) qubit undergoes only the controlled - phase operation , the lower ( signal ) qubit is subjected to a set of unconditional single - qubit gates before and after it enters the controlled - phase gate . </S>",
    "<S> these unconditional single - qubit gates can be implemented deterministically on the platform of linear optics .    </S>",
    "<S> the initial set of single - qubit operations consists of one rotation in @xmath10 direction @xmath11 followed by another rotation in @xmath12 direction @xmath13 similarly , the single - qubit rotations inserted behind the controlled - phase gate are @xmath14 and @xmath15 . when the control qubit is @xmath16 , the controlled - phase gate does not impose any phase shifts and all unconditional single - qubit rotations cancel each other @xmath17    on the other hand , if the control qubit is @xmath18 , the controlled - phase gate introduces an additional rotation in @xmath10 direction @xmath19 [ see eq . </S>",
    "<S> ( [ eq : rz ] ) ] . </S>",
    "<S> the overall operation imposed on the signal qubit now reads @xmath20    to demonstrate the universality of the above mentioned gate , let us consider the following : any single - qubit unitary transformation can be described as a rotation along some axis on the bloch sphere which corresponds to an operator @xmath21 where @xmath1 denotes the rotation angle and @xmath22 is the state that geometrically corresponds to the rotation axis on the bloch sphere ( @xmath23 is orthogonal to @xmath22 ) . for rotation along the @xmath10 direction </S>",
    "<S> we have @xmath24 which inserted to ( [ eq : w ] ) yields @xmath25 using prescriptions ( [ eq : rz ] ) and ( [ eq : ry ] ) we can easily verify that @xmath26 and thus show that any arbitrary pure qubit state is accessible if suitable values of @xmath27 and @xmath28 are set . </S>",
    "<S> unitary transformations maintain orthogonality so that @xmath29 . </S>",
    "<S> the two pairs of unconditional single - qubit rotations before and after the c - phase gate permit for any rotation axis . tunning the phase of the c - phase gate permits for setting any rotation angle @xmath1 .    </S>",
    "<S> any single - qubit unitary operation can be decomposed in the form of @xcite @xmath30 parametrized by three real numbers . </S>",
    "<S> an explicit decomposition of the transformation matrix can be found in the supplementary material  @xcite . </S>",
    "<S> note that the matrix @xmath9 in ( [ eq : w ] ) is also parametrized by three real numbers . </S>",
    "<S> optimality of our method is guaranteed by the the fact that we only use one probabilistic gate which is optimal for any given phase shift required by the transformation .     </S>",
    "<S> ( color online ) schematic drawing of the experimental setup . </S>",
    "<S> the components are labeled as follows : mt  motorized translation , hwp  half - wave plate , qwp  quarter - wave plate , pbs  polarizing beam splitter , bda  beam divider assembly , bd  beam divider , d  detector . ]    </S>",
    "<S> _ experimental implementation _ </S>",
    "<S>  we have constructed an experimental setup as depicted in fig . </S>",
    "<S> [ fig : setup ] . </S>",
    "<S> it consists of a tunable c - phase gate placed between single - qubit gates in the signal mode that implement the required unconditional rotations @xmath31 and @xmath32 . in our experiment </S>",
    "<S> we encode qubits into polarization states of individual photons ( @xmath16 corresponds to horizontal polarization @xmath33 , @xmath18 to vertical polarization @xmath34 ) . </S>",
    "<S> unconditional single - qubit rotations @xmath31 and @xmath32 are implemented by sets of one half- and one quarter - wave plates . </S>",
    "<S> the control state preparation is achieved by one half - wave plate in control mode since only logical states @xmath16 and @xmath18 are required . </S>",
    "<S> photons were generated using type i spontaneous parametric down - conversion in a liio@xmath35 crystal pumped by 200mw cw kr@xmath36 laser beam . by following the procedure described in ref . </S>",
    "<S> @xcite , we have adjusted the tunable c - phase gate to a given phase shift @xmath1 .    </S>",
    "<S> we have tested our device on six combinations of tunable c - phase gate phase shifts @xmath1 and single qubit rotations @xmath37 and @xmath38 ( see tab . [ </S>",
    "<S> tab : res_cunit ] ) . in all these six cases , </S>",
    "<S> we have performed complete process tomography of the signal mode for the control qubit set to state @xmath16 and then also to @xmath18 @xcite . </S>",
    "<S> the estimated choi matrices were compared to theoretical predictions permitting to calculate their fidelities @xmath39 and purities @xmath40 . </S>",
    "<S> we adopt the following labeling : @xmath41 and @xmath42 stand for fidelity and purity observed with control qubit set to @xmath16 , while @xmath43 and @xmath44 denote the same parameters for control qubits in the state @xmath18 . </S>",
    "<S> we have also determined the resulting success probabilities by comparing the coincidence rate observed after adjusting the gates with the coincidence rate behind the same setup , but with all filters removed and polarizations set so that no single or two - photon interference takes place . </S>",
    "<S> thus , we obtain the experimental success probability @xmath45 corrected for `` technological losses '' ( e.g. components back - reflections or coupling losses ) . the results of our experiment are summarized in tab .  [ tab : res_cunit ] and one selected case is also depicted in fig .  </S>",
    "<S> [ fig : res_cud3pi4 ] . estimated fidelities and purities are typically about 90% which indicates good agreement with theoretical predictions .    [ cols=\">,>,>,>,>,>,^,^,^,^,^,^\",options=\"header \" , ]      ( color online ) estimated process matrices for @xmath46 , @xmath47 and @xmath48 ( a ) with control qubit @xmath16 and ( b ) with control qubit @xmath18 . </S>",
    "<S> moduli of matrix elements are visualized by bar heights and their phase by arrow directions.,title=\"fig : \" ]   ( color online ) estimated process matrices for @xmath46 , @xmath47 and @xmath48 ( a ) with control qubit @xmath16 and ( b ) with control qubit @xmath18 . </S>",
    "<S> moduli of matrix elements are visualized by bar heights and their phase by arrow directions.,title=\"fig : \" ]    _ @xmath0-times controlled single qubit unitary transformations _  as in case of a cnot gate , a toffoli gate ( ccnot ) can be used to implement a controlled unitary gate , but with two control qubits . </S>",
    "<S> the ccnot operation can be implemented using only cnot gates . </S>",
    "<S> we can also build a @xmath49-times controlled gate by replacing the cnot gates acting on the target qubit with c - phase gates and single - qubit rotations . </S>",
    "<S> this approach ensures efficiency higher than in case of a circuit using only cnots , where cnot gates modifying the target qubit are each replaced with a single - qubit rotation sandwiched between two cnot gates . </S>",
    "<S> this means the latter approach is equivalent to adding 3 two - qubit gates to the circuit proposed in lemma  6.1 in ref .  </S>",
    "<S> @xcite .    </S>",
    "<S> the situation is analogous for any @xmath0-times controlled unitary gate . </S>",
    "<S> designing an arbitrary @xmath0-times controlled gate is usually considered in the context of toffoli gates . however , constructing such circuits directly with toffoli gates has been proven inefficient as it needs an order of @xmath50 two - qubit gates @xcite . it has been demonstrated that , by extending the hilbert space of the target information carrier ( see ref .  </S>",
    "<S> @xcite ) , one can implement an arbitrary @xmath0-times controlled gate by using @xmath51 standard two - qubit gates performing controlled - pauli operations ( @xmath52 for @xmath53 ) . </S>",
    "<S> this is considered to be the most effective currently known solution .    in linear optics </S>",
    "<S> we can increase the efficiency of an @xmath0-times controlled unitary gate proposed by lanyon _ </S>",
    "<S> et al .  </S>",
    "<S> _  @xcite by replacing two standard controlled - pauli gates with a controlled - unitary operation performed with higher probability of success . in the original scheme , </S>",
    "<S> the authors of ref .  </S>",
    "<S> @xcite show that any @xmath0-qubit controlled gate can be implemented using only @xmath54 cnot gates and single - qubit operations . </S>",
    "<S> similarly , we show in fig .  </S>",
    "<S> [ fig : l09nu ] any @xmath0-times controlled-@xmath55 gate can be reduced to @xmath56 cnot gates and one single - qubit controlled - phase gate . </S>",
    "<S> this is possible by using @xmath57-level system as the bottom - most circuit line . </S>",
    "<S> this reduces the number of the required two - qubit gates by one , and has the additional merit in having the single qubit controlled-@xmath55 gate work with a higher average success probability than a cnot gate .    </S>",
    "<S> this optimization can be applied in a linear - optical implementation of the @xmath49-times controlled unitary gate from ref .  </S>",
    "<S> @xcite . </S>",
    "<S> the improvement is apparent if we consider replacing the product of cnot , cz and r gates by a product of two controlled - unitary gates and single - qubit operations . </S>",
    "<S> the product of two controlled - unitary gates works on average with a higher success rate than a product of cz and cnot gates . </S>",
    "<S> hence , by using an optimal implementation of a c - phase gate , we can increase the success rate of the circuit by approximately one order of magnitude .    </S>",
    "<S> the currently known most efficient implementation of the toffoli gate in terms of the number of two - qubit gates was presented by miuda _ </S>",
    "<S> et al .  </S>",
    "<S> _ in ref .  </S>",
    "<S> @xcite . </S>",
    "<S> this approach requires only one cz gate . </S>",
    "<S> however , it is possible to obtain an even more efficient circuit for the controlled-@xmath55 if we replace the cz with a c - phase gate instead of the product of two cnots and single - qubit rotations .    </S>",
    "<S> any @xmath0-times controlled operation can be constructed from toffoli gates and a single - qubit controlled unitary gate regardless of the auxiliary resources . </S>",
    "<S> therefore , we infer that our reasoning and the resulting improvement is valid for all implementations of the ccnot .    </S>",
    "<S> ( color online ) 2-times and 3-times c - phase [ @xmath58 gates decomposed with a method of lanyon  _ et al . _  </S>",
    "<S> @xcite based on extending the hilbert space of the target qubit . </S>",
    "<S> the control lines are denoted as @xmath59 for @xmath60 and @xmath61 denotes the target qubit line . for the 2(3)-times controlled </S>",
    "<S> gate the dimension of the target qubit is extended by 1(2 ) . </S>",
    "<S> the additional dimensions are visualized as additional dashed channels . for technical details on operation of @xmath62 and @xmath63 gates </S>",
    "<S> see ref .  @xcite . by iterating the depicted procedure for an @xmath0-times controlled gate </S>",
    "<S> we conclude that @xmath56 cnots and a single c - phase are needed for its implementation . </S>",
    "<S> an arbitrary controlled-@xmath55 gate , where @xmath64 can be easily implemented using the same circuits by applying @xmath65 and @xmath66 single - qubit operations.,width=302 ]    _ conclusions _  we have presented a method for the optimization of quantum circuits based on a tunable c - phase gate . </S>",
    "<S> this method decreases the number of controlled operations needed in circuit design and significantly increases the success probability on physical platforms where controlled gates can only be implemented probabilistically ( e.g. linear optics ) . </S>",
    "<S> moreover , the reduction in number of gates makes circuits less complex and thusmore experimentally accessible . </S>",
    "<S> we have demonstrated the experimental feasibility of our approach on on the basis of one experimental case , namely the single - qubit controlled - unitary operation .    </S>",
    "<S> _ acknowledgements _  the authors thank jra cimrman for his helpful suggestions . </S>",
    "<S> k.  l. acknowledges support by czech science foundation ( grant no . </S>",
    "<S> 13 - 31000p ) . </S>",
    "<S> a.   . </S>",
    "<S> acknowledges support by czech science foundation ( grant no . </S>",
    "<S> p205/12/0382 ) . </S>",
    "<S> k.  b. acknowledges support by the foundation for polish science and the polish national science centre under grant no . </S>",
    "<S> dec-2013/11/d / st2/02638 , the operational program research and development for innovations european regional development fund ( project no . </S>",
    "<S> cz.1.05/2.1.00/03.0058 ) and operational program education for competitiveness european social fund ( project no . </S>",
    "<S> cz.1.07/2.3.00/20.0017 ) of the ministry of education , youth and sports of the czech republic . </S>",
    "<S> m.  d. acknowledges support from the palacky university ( iga - prf-2014008 ) . </S>"
  ]
}