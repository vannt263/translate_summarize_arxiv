{
  "article_text": [
    "the efficiency of molecular dynamics ( md ) simulations is governed by the choice of time step , which is usually taken 1/15 - 1/20 of the period of the fastest oscillation in the system . in liquid water , for instance , the o - h stretching mode has a period of 9 - 10 fs , thus limiting the time step to less than 1 fs . on the other hand , the length of a simulation must be much longer than structural relaxation times of the system , which range from picoseconds for liquid water to microseconds for biological systems @xcite .",
    "therefore , much effort has been made to reduce this gap in time scale @xcite , e.g. , by eliminating the high frequency motion , or equivalently , by accelerating the low frequency motion .",
    "one of the most widely used technique in classical md is constrained molecular dynamics ( cmd ) @xcite , in which the bond lengths and angles may be fixed to their equilibrium values .",
    "cmd allows us to increase the time steps by a factor of two to three , due to the absence of fast intramolecular vibrations .",
    "cmd is equally valid in _ ab initio _ molecular dynamics ( aimd ) simulations @xcite which provide more accurate interatomic forces at the expense of much higher computational costs @xcite .",
    "we can also use cmd to prevent ( undesirable ) breaking of covalent bonds in the initial stages of the simulations @xcite . however",
    ", bond flexibility can play an important role if two or more phases coexist in the simulation cell @xcite .",
    "furthermore , overuse of bond angle constraints is prone to numerical artifacts @xcite .    a more recent development , which is free from these drawbacks , is the multiple time step ( mts ) algorithms like verlet - i @xcite and r - respa @xcite . in mts , one can use large time steps for computationally expensive long - range interactions , while inexpensive short - range ones are integrated with small time steps .",
    "mts is superior to cmd in that no fixed geometry approximation is required , while a similar or higher gain in performance can be achieved . unfortunately , interatomic forces from _ ab initio _ calculations can not be divided into short- and long - range components exactly .",
    "therefore , with the exception of approximate implementations @xcite , mts is not generally used for aimd .    in the present paper",
    ", we investigate an alternative approach which takes advantage of the extra degrees of freedom associated with the choice of atomic masses .",
    "a simple approach along these lines is to rescale the atomic masses appropriately , which is particularly effective in systems containing hydrogen @xcite , as well as for adiabatic free energy calculations @xcite .",
    "it is also a common practice to replace hydrogen by deuterium in aimd study of liquid water @xcite , thereby increasing the time step by a factor of @xmath0 .",
    "whereas the mass scaling method alleviates the time - scale problem to some extent , it does not fully eliminate the strong anisotropy of the phase space caused by covalent bonds .",
    "this problem can be overcome by using a more general formulation termed mass tensor molecular dynamics ( mtmd ) , which was first introduced by bennett more than three decades ago @xcite .",
    "mtmd enables us to make the phase space nearly isotropic by using a nondiagonal position - dependent mass tensor , thus leading to enhanced sampling .",
    "bennett used a constant , but nondiagonal mass tensor in his calculations on a simple polymer chain , and achieved a five- to tenfold reduction in computational effort . the staging method used in path integral md @xcite",
    "can also be viewed as a variant of mtmd .",
    "melchionna has recently developed a similar method using internal coordinates in a series of papers @xcite . in the present work ,",
    "we show how to apply mtmd to aimd simulations with minimal computational overhead .",
    "we also demonstrate the effectiveness of our approach in born - oppenheimer md simulation of liquid water .",
    "the classical hamiltonian for a system of @xmath1 atoms is given by @xmath2 where @xmath3 , @xmath4 and @xmath5 are vectors of dimension @xmath6 , representing atomic masses , positions and momenta .",
    "@xmath7 denotes either the classical potential energy function @xcite , or the kohn - sham total energy @xcite . in what follows",
    ", we will focus on the latter problem .",
    "the generalized hamiltonian introduced by bennett is given by @xcite @xmath8 where @xmath9 is a positive definite , symmetric matrix of dimension @xmath6 which depends on the atomic positions * q*. let us assume that @xmath10 is the canonical probability distribution in configuration space : @xmath11 where @xmath12 is the inverse temperature .",
    "then , the ensemble average of any operator @xmath13 is given by @xmath14 if eq.([gham ] ) is substituted into eq.([prob ] ) , and integration over @xmath5 is performed @xcite , we obtain @xmath15 therefore , as long as @xmath16 is independent of @xmath4 , @xmath10 ( and thus @xmath17 ) agrees with that of the original hamiltonian .",
    "the same conclusion holds true for the microcanonical ensemble @xcite .",
    "there are numerous ways to choose @xmath9 that satisfies the above conditions , but a reasonable choice is @xmath18 where the hessian matrix @xmath19 is given by @xmath20 and @xmath21 is a scalar function to compensate for the @xmath4-dependence of @xmath22 . if @xmath7 is a convex quadratic function of @xmath4 , eq.([mheq ] ) is optimal in the sense that all normal modes have the same frequency . in practice , it is prohibitively expensive to calculate the exact values of @xmath23 at each step of aimd . instead , we introduce a simple harmonic approximation to @xmath7 , given by @xmath24 where only covalent bonds contribute to the sum .",
    "then , we can define @xmath25 which is a sparse , symmetric , and indefinite matrix .",
    "the simplest way to construct a positive definite matrix similar to @xmath26 is to define @xmath27 using a small positive constant @xmath28 . in our experience",
    ", however , the value of @xmath28 tends to be relatively large in finite temperature simulations , which has a negative impact on the performance of mtmd .",
    "therefore , we adopt a more robust definition based on the eigenvalue decomposition of @xmath26 @xcite .",
    "@xmath26 is first diagonalized by an orthogonal matrix @xmath29 as @xmath30 where @xmath31 is a diagonal matrix given by @xmath32 .",
    "then , we introduce @xmath33 where @xmath34 is a filtering function given by @xmath35 at variance with eq.([naive ] ) , @xmath36 is a positive definite matrix for any nonzero @xmath28 .",
    "finally , @xmath9 is given by @xmath37 where @xmath38 and @xmath39 is an arbitrary normalization factor which does not depend on @xmath4 . by definition",
    ", @xmath40 holds for any @xmath4 , irrespective of the choice of @xmath41 and @xmath28 .",
    "the equations of motion derived from the generalized hamiltonian of eq.([gham ] ) are given by @xmath42 and @xmath43 numerical integration of these equations is performed with the generalized leapfrog algorithm @xcite , @xmath44    @xmath45    @xmath46    where @xmath47 is the time step and the superscript denotes the time - step number .",
    "while eq.([gl3 ] ) is an explicit formula , eqs.([gl1 ] ) and ( [ gl2 ] ) are implicit , i.e. , these equations must be solved iteratively .",
    "note , however , that we need to update only classical variables during the iterations , which is orders of magnitude faster than the evaluation of quantum mechanical forces ( @xmath48 ) .",
    "therefore , the computational cost of a single mtmd step is comparable to that of a conventional aimd .",
    "eqs.([gl1 ] - [ gl3 ] ) also preserve the symplectic property , if the implicit ones are solved with sufficient accuracy @xcite .",
    "when @xmath9 is indepedent of @xmath4 , the generalized leapfrog algorithm reduces to the velocity - verlet method @xcite .",
    "we carried out two aimd simulations of liquid water to evaluate the performance of mtmd in real applications . the reference simulation ( hereafter denoted by ref )",
    "was performed with @xmath49 and @xmath50 , while the mtmd simulation was performed with @xmath4-dependent masses , as will be explained below .",
    "atomic forces were calculated within the density functional theory @xcite .",
    "we used the generalized gradient approximation in the perdew - burke - ernzerhof form @xcite .",
    "the separable norm - conserving pseudopotentials were employed @xcite , and only the @xmath51 point was used to sample the brillouin zone .",
    "the electronic orbitals were expanded by the finite - element basis functions @xcite with an average cutoff energy of 58 ry , while the resolution was approximately doubled near the oxygen atoms by adaptation of the grids @xcite .",
    "liquid water at an elevated temperature was modeled by 64 molecules in a cubic supercell of side 13.92 @xcite , which was chosen to minimize the effect of nonergodic behavior observed at low temperatures @xcite .",
    "the equations of motion for the atoms were integrated with the generalized leapfrog algorithm using a time step of 20 a.u .",
    "( 0.484 fs ) .",
    "eqs.([gl1 ] ) and ( [ gl2 ] ) were iterated 10 times to achieve full convergence in the mtmd run .",
    "initial atomic velocities were chosen so that the total energies in the two simulations coincide .",
    "after equilibration , production runs of 15 ps were carried out in the microcanonical ensemble .",
    "the electronic states were quenched to the born - oppenheimer surface at each md step with the limited - memory variant @xcite of the quasi - newton method @xcite .",
    "the initial guesses were extrapolated from previous md steps @xcite .",
    "atomic masses used in the mtmd run were determined in the following manner .",
    "@xmath41 of eq.([vharm ] ) was first decomposed into a sum of contributions from each water molecule , @xmath52 the potential energy function @xmath53 for molecule @xmath54 can be written as @xmath55 where @xmath56(oh@xmath57 ) , @xmath58(oh@xmath59 ) , and @xmath60h@xmath57oh@xmath59 .",
    "the parameters @xmath61 and @xmath62 were determined by the force matching method @xcite using the equilibration part of the trajectories , as listed in table [ ffparam ] . under this definition ,",
    "@xmath9 is a block diagonal matrix , with each block being a square matrix of order 9 .",
    "therefore , inversion and diagonalization of @xmath9 can be carried out at negligible cost . in terms of the efficiency of phase space sampling , the value of @xmath28 introduced in eq.([filter ] ) should be as small as possible , while too small a value may lead to instability .",
    "after some trial and error , @xmath63 ha / bohr@xmath64 proved to be a good compromise in the present system .",
    "the normalization factor @xmath39 was adjusted so that the period of the fastest oscillation in mtmd agrees with that in ref , to make a fair comparison between the two simulations .",
    "we first show the time evolution of total energy and potential energy during the mtmd run in fig.[energyfig](a ) , which reflects the accuracy of numerical integration .",
    "conservation of the total energy in ref is also satisfactory .",
    "average temperatures are 415.74 k and 415.42 k for the ref and mtmd run , respectively .",
    "probability distributions of potential energies are also compared in fig.[energyfig](b ) .",
    "these results suggest that , within statistical errors , the two simulations are sampling the same region of phase space .",
    "we have also found that 20 - 25 % more computational effort is required for the calculation of interatomic forces in going from ref to mtmd .",
    "this is because the atoms move a longer distance at each mtmd step , as will be shown below , which makes the extrapolation of initial guesses less effective @xcite .",
    "a similar effect was observed in our previous work on cmd @xcite .",
    "average geometry of each molecule and the radial distribution functions ( rdfs ) have been calculated from the trajectories , as shown in table [ avegeom ] and fig.[rdffig ] , respectively .",
    "all results are in excellent agreement with each other , as expected from the theoretical analysis .",
    "we also compare the convergence of oxygen - oxygen rdfs ( @xmath65 ) with respect to simulation length .",
    "the residual error in @xmath65 is defined by @xmath66 where we set @xmath67 = 7   and @xmath68 = 15 ps , and @xmath69 denotes the oxygen - oxygen rdf , extracted from the trajectory in the range of @xmath70 $ ] . as shown in fig.[convfig](a ) , the error for mtmd decays more than three times faster",
    ". the rapid convergence of mtmd is more clearly seen in fig.[convfig](b ) , where the rdfs at @xmath71 1 ps are compared with that of @xmath72 .",
    "the residual errors for oxygen - hydrogen and hydrogen - hydrogen rdfs behave similarly , but are much smaller because there are twice as many hydrogen atoms in the simulation cell .      the atomic velocities from the simulations have been used to calculate the vibrational spectra shown in fig.[vdosfig ] .",
    "the first peak at 3400 - 3700 @xmath73 in ref corresponds to the o - h stretching mode , while the second peak at 1620 - 1630 @xmath73 is assigned to the h - o - h bending mode .",
    "the low frequency region below 1000 @xmath73 corresponds to the intermolecular modes .",
    "when going from ref to mtmd , the two peaks corresponding to the intramolecular modes merge into a single broad peak between 3200 - 3700 @xmath73 .",
    "furthermore , the intermolecular modes now extend up to 3000 @xmath73 .",
    "therefore , the gaps in the original spectra , which reduce the efficiency of simulations , are absent in the mtmd results .",
    "note also that the highest frequency observed in mtmd is in good agreement with that in ref , which confirms that our choice of @xmath39 is appropriate .",
    "this also means that mtmd and ref have the same accuracy , in the sense that the time step @xmath74 of the period of the fastest oscillation ( @xmath75 fs ) in both simulations .",
    "finally , we compare the mean square displacements of oxygen atoms from the two simulations in fig.[msdfig ] . in agreement with the convergence rate of rdfs , the mean square displacement from mtmd is found to grow @xmath76 times faster . if the aforementioned increase in computational cost is taken into account , the use of mtmd results in a net gain of 2.8 - 2.9 times .",
    "this gain is competitive with that of using a rigid water model @xcite , even though no fixed geometry approximation is required in mtmd .",
    "while ensemble averages of structural properties remain unchanged in mtmd , the same does not hold for dynamical properties like vibrational spectra and self - diffusion coefficients .",
    "this is because the trajectories satisfying the generalized equations of motion ( eqs.([nt1],[nt2 ] ) ) are unphysical , which can be viewed as a trade - off for enhanced sampling of the phase space .",
    "therefore , mtmd should be used only in the equilibration phase , if dynamical properties are required .",
    "nevertheless , there are several possible ways to recover the vibrational spectra of the original system within the harmonic approximation @xcite .",
    "most of these methods rely on the covariance matrix of atomic fluctuations , @xmath77 which has the form of an ensemble average .",
    "therefore , we can use the trajectory of mtmd or even monte carlo simulations to calculate eq.([sgm ] ) . in disordered systems",
    ", however , care must be taken in the choice of reference frame to take into account the effect of translation and rotation of each molecule .",
    "it is also worth noting that a novel algorithm based on the stochastic path - integral formalism @xcite has recently been proposed , which allows us to recover the time correlation functions of the original system from the trajectory on a modified potential energy surface .",
    "a more empirical approach for estimating the self - diffusion coefficient from rdfs is also known for simple liquids @xcite .",
    "the validity of these algorithms will be discussed in more detail elsewhere .    as already mentioned in the introduction , mtmd generally performs better than mass scaling , because the knowledge of the molecules can be fully exploited in mtmd .",
    "nevertheless , mass scaling is still an attractive option , if chemical reactions can occur during the simulations @xcite .",
    "moreover , at variance with mtmd , no programming effort is required .",
    "to the best of our knowledge , relatively little effort has been made @xcite to optimize the atomic masses theoretically for finite temperature simulations , although several empirical studies exist @xcite . to this end",
    ", we first introduce the expression for the thermal average of the hessian @xcite : @xmath78 which was originally intended for vibrational analysis @xcite . here",
    "we propose to use eq.([avhess ] ) to estimate the optimal masses @xmath79 by @xmath80 where we take the average over all directions and atoms of the same element .",
    "then , these masses may be used in conjunction with the original hamiltonian of eq.([oham ] ) .",
    "eq.([mopt ] ) may be viewed as a special case of eq.([mheq ] ) . in the case of liquid water",
    ", we obtain a ratio of 2.0 for @xmath81 , which is in close agreement with the empirical results of feenstra _",
    "theoretical prediction will play an important role in more complicated systems containing three or more elements where empirical optimization is prohibitive .",
    "preliminary studies on the lithium borohydride ( libh@xmath82 ) system @xcite using the optimal masses are showing promising results .",
    "we also note that atoms of the same element may have different masses .",
    "for instance , hydrogen atoms forming o - h bonds may be made heavier than those forming c - h bonds , if these bonds remain stable throughout the simulations .",
    "the importance of the choice of hessian in _ ab initio _ geometry optimization is well known @xcite . as we have shown in the present study , hessian plays an equally important role in finite temperature simulations .",
    "mtmd will be the method of choice for nonreactive systems , if the primary interest of the simulations is the equilibrium properties @xcite .",
    "on the other hand , the mass scaling method is applicable to a wider class of problems , and will be particularly effective for systems with large differences in atomic masses , e.g. , water / pt interface @xcite . these approaches may also prove useful for global optimization problems @xcite",
    ". it would also be interesting to combine mtmd with rare event methods such as hyperdynamics @xcite and metadynamics @xcite .",
    "since these methods do not involve kinetic part of the hamiltonian , the implementation would be straightforward .",
    "this work was supported by a kakenhi grant ( 20038050 ) .",
    "numerical calculations were carried out on the t2k open supercomputer at the university of tokyo .                                                                                                                                                          ) with respect to simulation length @xmath83 .",
    "( a ) residual error @xmath84 as a function of time .",
    "the scaled mtmd lines denote @xmath85 .",
    "( b ) comparison of @xmath86 at @xmath83 = 1 ps and @xmath87.,width=340 ]"
  ],
  "abstract_text": [
    "<S> mass tensor molecular dynamics was first introduced by bennett [ j.  comput .  phys . * 19 * , 267 ( 1975 ) ] for efficient sampling of phase space through the use of generalized atomic masses . here , </S>",
    "<S> we show how to apply this method to _ ab initio _ molecular dynamics simulations with minimal computational overhead . </S>",
    "<S> test calculations on liquid water show a threefold reduction in computational effort without making the fixed geometry approximation . </S>",
    "<S> we also present a simple recipe for estimating the optimal atomic masses using only the first derivatives of the potential energy . </S>"
  ]
}