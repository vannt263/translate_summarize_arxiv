{
  "article_text": [
    "the classical optimal transportation problem appears in a @xmath0 article of gaspard monge @xcite . in the modern formulation , one",
    "is given a cost function @xmath1 $ ] and a pair of probability densities @xmath2 and @xmath3 defined on two domains @xmath4 , @xmath5 , respectively . the objective is to minimize the functional @xmath6 among maps @xmath7 which satisfy the  push - forward \" condition @xmath8 , i.e. @xmath9 a minimizer of is commonly referred to as an",
    " optimal map \" or  optimal transport \" for the corresponding cost function . in the classical problem",
    ", one selects the monge cost , i.e. @xmath10 . the existence of optimal maps was addressed by many authors @xcite . in general , minimizers are not unique ; nevertheless , there is a unique optimal transport which is monotone on transfer rays @xcite .",
    "the regularity of optimal maps is still widely open ; the only known result is in @xmath11 : if the given densities are positive , continuous , and have compact , disjoint , convex support , then the monotone optimal map is continuous in the interior of the transfer rays @xcite .",
    "recently , it was shown in @xcite that the monotone optimal transport between positive @xmath12 densities supported on the same bounded , convex domain fails to be lipschitz continuous at interior points .",
    "in fact , the authors prove something stronger : namely , they construct an example in which the monotone optimal map does not belong to @xmath13 for any @xmath14 .",
    "in this paper we focus on examples relating the regularity of the initial data , which are assumed to be strictly positive and bounded on a convex set , with the regularity of the monotone optimal transport . as a starting point ,",
    "the following example shows that in general , the monotone optimal map is not more regular than the initial data : consider @xmath15 and suppose that @xmath2 and @xmath3 are bounded away from zero and infinity .",
    "let @xmath16 and @xmath17 , and write @xmath18 and @xmath19 for their primitives , respectively . if @xmath20 , @xmath21 , and @xmath22 for all @xmath23 , then the optimal potential is @xmath24 and the monotone optimal transport is explicitly given by @xmath25 we note that the primitives endow @xmath26 with more regularity than the densities in the @xmath27 variable ; nevertheless , the map has the same regularity as @xmath2 and @xmath3 in the @xmath28 variable .",
    "for example , continuous densities may produce a monotone optimal map which is not hlder continuous .",
    "moreover , the same example shows that a discontinuous monotone optimal map may arise from discontinuous , bounded initial data ( see also ( * ? ? ?",
    "* example 4.5 ) ) .",
    "our main result constructs a family of examples which shed further light on the nature of the monotone optimal transport map , see theorem [ thm : main ] .",
    "more precisely , we build examples where the modulus of continuity of the monotone optimal transport is worse than the modulus of continuity of the densities . indeed",
    ", some corollaries of our result include the following statements ( @xmath29 is the interior of a triangle , and the densities are positive on @xmath30 ) : @xmath31    note that recovers the aforementioned example appearing in @xcite . on the other hand , improves the hlder exponent when boundary regularity is taken into account . in , , and the regularity of the densities give a quantitative estimate on the hlder exponent of the optimal map ; in particular , illustrates that one may degenerate the hlder regularity of @xmath26 by reducing @xmath32 and improves the bound derived from ( i.e. that @xmath33 data implies a transport that is not more regular than @xmath33 ) .",
    "this improvement is generated by choosing nonparallel transport rays , see ",
    "the situation for the quadratic cost , i.e. @xmath34 , is of a completely different nature . in this setting , if the densities are bounded away from zero and infinity on convex domains , then caffarelli @xcite asserts that @xmath26 is hlder continuous , cf .",
    "* example 4.5 ) ; moreover , if @xmath35 , then @xmath36 for @xmath37 , and @xmath38 , cf .",
    ", , and ( see also remark [ extens ] ) . for general cost functions satisfying a strong form of the so - called ma - trudinger - wang condition @xcite , it was shown in @xcite under mild conditions on the densities , that the transport map is hlder continuous up to the boundary if the domains satisfy a certain type of convexity condition called @xmath39-convexity ( see also the interior regularity result in @xcite for cost functions satisfying a weak form of the ma - trudinger - wang condition ) .",
    "indeed , the domain @xmath29 above satisfies this convexity condition for a large class of cost functions .",
    "thus , the monge cost generates a significant loss of regularity compared to other cost functions for which a regularity theory is known .",
    "nevertheless , it remains an open problem to determine sufficient conditions on the initial data that ensure the continuity of optimal maps in the classical monge problem .",
    "for the reader s convenience , we keep our notation as close as possible to @xcite .",
    "our examples are built as follows .",
    "the idea of the construction is to a priori fix the transport rays by specifying a family of line segments that may be thought of as the lines along which the optimal transport acts .",
    "let @xmath40 \\to [ 0,1/2]$ ] be a function such that @xmath41 ) \\cap c^\\infty ( ( 0,1 ) ) , \\quad \\omega'(t)>0 \\ ; \\forall t \\in ( 0,1 ) , \\quad \\omega(0 ) = 0 , \\quad \\omega(1 ) = \\frac{1}{2}.\\ ] ] in our situation , we consider the following transport rays : @xmath42 it is clear that the segments @xmath43 do not mutually intersect .",
    "the domain representing both source and target will be @xmath44 , where @xmath45 the initial and final density will have the form @xmath46 where @xmath47 , \\qquad",
    "\\eta \\in l^\\infty(0,1 ) \\cap c^\\infty(0,1),\\ ] ] and @xmath48 is chosen in such a way that @xmath3 is bounded away from zero : @xmath49 since we want the segments @xmath43 to be transport rays for the optimal map , the following mass balance condition for the region in the domain below each @xmath43 must be satisfied : @xmath50,\\ ] ] where @xmath51 is the subgraph of @xmath43 in @xmath52 , namely the triangle formed by @xmath53 , @xmath54 , and @xmath55 ; this mass constraint will determine the function @xmath56 .",
    "it is well known that the optimal map for the monge cost is not unique . on the other hand , there exists a unique monotone optimal map @xcite which in our setting can be shown to satisfy @xmath57 and @xmath58 from the construction , it follows that this map is pointwise defined in @xmath52 , and we investigate its regularity .",
    "in particular , it is not difficult to see that the origin is a fixed point for a suitable continuous extension and that the regularity of this map at the origin strongly depends on the behavior of @xmath59 ( see figure  [ xenon ] ) ; indeed , in the next section we show how suitable choices of @xmath59 will provide a collection of counterexamples to regularity",
    ". all of these results will be consequences of the following theorem .",
    "[ fig : controes ]    [ thm : main ] let @xmath59 be as in , @xmath44 as in , and @xmath60 the family of lines defined in .",
    "let @xmath61 be as in , , and assume that holds and @xmath62 .",
    "then the monotone optimal transport @xmath63 between @xmath2 and @xmath3 with respect to the monge cost satisfies @xmath64    to obtain counterexamples to interior regularity , it suffices to reflect the picture across the @xmath28-axis ( see figure [ xenon ] ) ; in this way we construct initial data for which the optimal map fails to be regular at an interior fixed point .",
    "let @xmath65 be defined as @xmath66 and consider @xmath67 where @xmath68 are as in and . by the uniqueness of monotone optimal mappings",
    "@xcite it follows that the symmetric extension of @xmath26 across the @xmath28-axis is the corresponding optimal map between the densities @xmath69 and @xmath70 .",
    "note that the regularity of @xmath70 on the @xmath28-axis is affected by the choice of @xmath59 ( via @xmath56 ) .",
    "the first corollary appears in work of li , santambrogio , and wang @xcite .",
    "it states that the monotone optimal transport map between smooth densities supported on convex domains is not , in general , more regular than a @xmath71 function in the interior .",
    "the proofs of the corollaries will employ theorem [ thm : main ] to describe the regularity of the transport map as well as an analysis lemma to guarantee the regularity of the target density ( see lemma [ lemma : reg - eta ] ) .",
    "let @xmath72 be as in .",
    "there exists @xmath73 bounded away from zero such that if @xmath26 is the monotone optimal transport map between @xmath74 and @xmath3 , then @xmath75    by selecting @xmath76 , we choose @xmath77 $ ] as in lemma [ lemma : reg - eta ] and @xmath3 as in .",
    "an application of theorem [ ts : thm ] yields @xmath78 thus , @xmath79 can be extended continuously to @xmath80 by the second inequality in with the value @xmath81 .",
    "finally , follows from the first inequality in .",
    "next , we show that the monotone map between smooth data and convex domains is in general not better than @xmath82 up to the boundary .",
    "let @xmath52 be as in .",
    "there exists @xmath83 bounded away from zero such that if @xmath26 is the monotone transport map between @xmath84 and @xmath3 , then @xmath85    let @xmath86 and take @xmath87 $ ] as in lemma [ lemma : reg - eta ] .",
    "we select the smooth target density @xmath3 as in , and apply theorem [ ts : thm ] to obtain @xmath88 thus , @xmath79 can be extended continuously to @xmath80 by the second inequality in with the value @xmath81 .",
    "finally , follows from the first inequality in .    when @xmath86 , it can be seen from lemma [ lemma : reg - eta ] that @xmath87 $ ] .",
    "in fact , by utilizing , it is not difficult to show that @xmath56 is quadratic at the origin with a bounded left and right third derivative ; thus , its even reflection is @xmath89 , and this implies the following interior result :    let @xmath72 be as in .",
    "there exists @xmath90 bounded away from zero such that if @xmath26 is the monotone transport map between @xmath74 and @xmath3 , then @xmath91      in the next corollary , we show that one may degenerate the possible hlder continuity of the monotone optimal transport with ( degenerate ) hlder data .",
    "[ cor : hold - dens ] let @xmath72 be as in .",
    "for every @xmath92 , there exists @xmath93 bounded away from zero such that if @xmath26 is the monotone optimal transport map between @xmath74 and @xmath3 , then @xmath94    let @xmath95 where @xmath96 and choose @xmath56 as in lemma  [ lemma : reg - eta ] , so that @xmath97 $ ] and @xmath98 .",
    "since the even reflection is lipschitz , it follows that @xmath99 $ ] . set @xmath100 and select the @xmath101 target density @xmath3 as in .",
    "an application of theorem [ ts : thm ] yields @xmath102 thus , @xmath79 can be extended continuously to @xmath80 with the value @xmath81 , and this finishes the proof .",
    "[ extens ] in corollary  [ cor : hold - dens ] one could also take @xmath103 .",
    "in fact , it follows from remark  [ rmk : even - other - alpha ] and theorem  [ thm : main ] that for every @xmath104 , @xmath105 there exists @xmath106 bounded away from zero such that the monotone optimal transport map @xmath26 between @xmath74 and @xmath3 is not @xmath107 for any @xmath14 .",
    "one may not hope for a hlder continuous map with only @xmath108 data .",
    "indeed , this fact can readily be inferred from the example giving rise to , and it can also be deduced from theorem [ thm : main ] and lemma  [ lemma : reg - eta ] by selecting the function @xmath109 .",
    "it is not difficult to see that the function @xmath3 constructed in the proof of corollary  [ cor : hold - dens ] is @xmath110 for every @xmath111 . in particular",
    ", this shows that for every @xmath112 , @xmath113 if @xmath114 , it follows that the monotone optimal map between lipschitz densities is not more regular than @xmath115 ( this can also be deduced from corollary  [ cor : hold - dens ] by choosing @xmath116 ) .",
    "in the following lemmas , we determine the target density by imposing the mass balance condition and build a kantorovich potential .",
    "this construction yields the existence of an optimal transport map for the monge cost between @xmath2 and @xmath3 whose transport rays are given by .      1 .",
    "[ lemma : cont ] holds if and only if @xmath117 where @xmath118 \\cap c^\\infty(0,1)$ ] is the unique solution of @xmath119 .2 in 2 .   if @xmath120 for @xmath121 $ ] and some @xmath122 , then @xmath123 $ ] with @xmath98 .",
    "moreover , if @xmath124 for @xmath125 then @xmath126 $ ] and if @xmath127 for @xmath125 , then @xmath56 has a @xmath12 even extension to @xmath128 $ ] .",
    ".2 in 3 .",
    "[ lemma : c0stat ] if @xmath109 for every @xmath129 $ ] , @xmath130 , then @xmath131 $ ] with @xmath98 .    @xmath132 + _ proof of statement ( i)_. note that can be rewritten as @xmath133 let @xmath134 be such that @xmath135 , @xmath136 . to compute the second integral , we integrate first with respect to @xmath27 @xmath137 similarly , we compute the left integral in by first integrating with respect to @xmath28 and then with respect to @xmath27 . by noting",
    "that the function @xmath138 satisfies @xmath139 and @xmath140 , it follows that @xmath141 thanks to and , can be rewritten as @xmath142 i.e. , @xmath143 which is equivalent to .",
    "moreover , by and the implicit function theorem , the function @xmath144 \\to [ 0,1]$ ] which solves is monotone , continuous , and belongs to @xmath145 .",
    "_ proof of statement ( ii)_. let @xmath120 for @xmath146 .",
    "we are left to prove @xmath98 and that @xmath56 is hlder continuous at @xmath81 . by the implicit function theorem",
    ", there exists a @xmath12 function @xmath147 defined in a neighborhood of @xmath81 so that @xmath148 for every @xmath149 sufficiently small .",
    "therefore , @xmath150 is a solution to @xmath151 and hence @xmath152 for every @xmath153 sufficiently small",
    ". therefore the function @xmath154 belongs to @xmath155 $ ] .",
    "indeed , an explicit computation shows that away from the origin , the second derivative is a smooth function of @xmath156 through the formula : @xmath157= 2b^2(t^{1/s } ) + \\big(\\frac{6}{s}+\\frac{2}{s^2}\\big ) t^{1/s } b ( t^{1/s } ) b ' ( t^{1/s } ) + \\frac{2}{s^2 } t^{2/s } \\big ( [ b ' ( t^{1/s})]^2 + b ( t^{1/s } ) b '' ( t^{1/s } ) \\big).\\ ] ] by computing the third derivative and integrating it between any two points , it follows that each term in this expression is @xmath158 .",
    "we show this regularity for the first term in ( the argument is similar for the other terms ) .",
    "since @xmath147 is lipschitz and @xmath159 , we have that @xmath160 for every @xmath161 $ ] ; hence for every @xmath162 $ ] with @xmath163 @xmath164 \\ , dt \\leq\\frac{2}{s } \\int_{t_1}^{t_2 } b(t^{1/s } ) b'(t^{1/s } )   t^{1/s-1}\\ , dt \\\\ & \\leq \\frac{\\ 2|b'\\|^2_{\\infty}}{s } \\int_{t_1}^{t_2 } t^{2/s-1}\\ , dt   = \\|b'\\|^2_{\\infty } \\big({t_2}^{2/s}- { t_1}^{2/s}\\big )   \\leq \\|b'\\|^2_{\\infty } \\big({t_2}- { t_1}\\big)^{2/s } .",
    "\\end{split}\\ ] ] since @xmath159 , implies @xmath98 .",
    "moreover , if @xmath124 for some @xmath125 , then @xmath165 is @xmath12 up to @xmath80 . similarly , if @xmath127 , then @xmath166 $ ] with an even extension for @xmath167 $ ] ( since the function @xmath168 depends smoothly on @xmath169 ) .",
    "_ proof of statement ( iii)_. we apply the same line of reasoning as before by letting @xmath109 : consider the equation @xmath170 which is equivalent to @xmath171 where @xmath172 . by the implicit function theorem , there exists a smooth solution @xmath173 in a neighborhood of the origin .",
    "thus , @xmath174 , and this implies that the function @xmath175 belongs to @xmath176 $ ] ; since @xmath159 , we deduce @xmath98 .",
    "[ rmk : even - other - alpha ] in lemma  [ lemma : reg - eta ] ( ii ) , one could also take @xmath177 $ ] in order to obtain a more regular @xmath56 . more precisely , if @xmath120 with @xmath178 , then @xmath179)$ ] , where @xmath180 is the integer part of @xmath181 and @xmath182 .",
    "indeed , the regularity of @xmath56 is determined by the regularity of @xmath183 as in ; thanks to lemma  [ lemma : reg - eta ] ( i ) , it is enough to check the regularity of @xmath56 at the origin .",
    "this can be made explicit by noting that @xmath184 close to @xmath80 , see .",
    "it follows that @xmath185 . to make this argument rigorous",
    ", one can rewrite @xmath186 with @xmath147 smooth up to the origin and explicitly compute the derivatives of this expression noting that many vanish at the origin .",
    "we also remark that in lemma  [ lemma : reg - eta ] ( iii ) , a modulus of continuity of @xmath56 is given by the function @xmath187 ( up to a constant ) .",
    "slight generalizations of the construction in this paper do not lead to better counterexamples .",
    "for instance , the particular choice of @xmath188 is made in such a way that @xmath189 , a fact which is needed in the proof of theorem [ thm : main ] .",
    "this implies that the function @xmath190 satisfying @xmath139 and @xmath140 , is at most quadratic at the origin . on the other hand , this limits the regularity of @xmath56 in lemma  [ lemma : reg - eta ] .",
    "similarly , altering @xmath2 to have the same structure as @xmath3 , namely @xmath191 does not lead to better counterexamples , as can be seen from the proof of lemma  [ lemma : reg - eta ] .",
    "[ potent ] let @xmath52 be as in , @xmath59 as in , and @xmath60 the family of lines defined in",
    ". then there exists @xmath192 such that @xmath193 with equality if and only if @xmath194 for some @xmath195 .    for every @xmath196 ,",
    "let @xmath197 be such that the unique line passing through @xmath198 is @xmath199 .",
    "note that @xmath197 is obtained by solving @xmath200 the assumptions on @xmath59 imply @xmath201 ( via the implicit function theorem ) .",
    "next , consider the unit vector field @xmath202 which points in the direction of @xmath199 for each @xmath196 , i.e. @xmath203 the statement of the lemma is equivalent to the existence of a function @xmath204 such that @xmath205 indeed , if holds , then @xmath206 and @xmath207=|b(x)|^2=1 $ ] for every @xmath196 and @xmath208 ; since @xmath209 is a parametrization of the line @xmath199 with @xmath210 , this shows that @xmath211 is linear with slope @xmath212 when restricted to @xmath199 . on the other hand if the statement of the lemma holds , then @xmath213 and to satisfy the equality cases , the gradient of @xmath211 must point in the direction of @xmath199 for every @xmath214 . as @xmath52",
    "is simply connected , is equivalent to showing that @xmath147 is an irrotational vector field , i.e. @xmath215 or equivalently @xmath216 by applying @xmath217 and @xmath218 to @xmath219 , it follows that @xmath220 @xmath221 multiplying by @xmath222 and adding yields @xmath223 which proves . to conclude",
    ", we note that @xmath211 admits a lipschitz extension to @xmath224 .    by the construction in @xcite and @xcite",
    ", there exists a unique measure preserving map @xmath225 between @xmath2 and @xmath3 such that @xmath198 and @xmath226 are contained on a common line @xmath43 for all @xmath196 .",
    "moreover , by lemma [ potent ] ( which exploits the construction of the kantorovich potential ) , one readily obtains that @xmath26 is an optimal mapping in the monge problem , see e.g. ( * ? ? ?",
    "* lemma 7 ) . since @xmath26 is measure preserving",
    ", the construction in @xcite implies for every @xmath195 @xmath227 note that @xmath228=\\omega'(a)\\big(x_1+a+\\frac{\\omega(a)}{\\omega'(a)}\\big);\\ ] ] thus , may be rewritten as @xmath229 ( after canceling @xmath230 from both sides ) .",
    "next , set @xmath231 to prove the second inequality in , note that by , the second term of the integrand on the right - hand side of is greater than @xmath232 for every @xmath233 ; therefore @xmath234 by evaluating the two integrals we obtain @xmath235 since the function @xmath236 is increasing on @xmath237 , it follows that @xmath238 which proves that the @xmath239 in is bounded by @xmath212 .",
    "next , we prove the first inequality in . by the properties of @xmath188 and",
    "@xmath56 it follows that there exists a constant @xmath240 such that @xmath241 and @xmath242 in a neighborhood of the origin .",
    "hence , since @xmath243 as @xmath244 , for @xmath245 sufficiently small , @xmath246 evaluating the two integrals yields @xmath247 on the other hand , note that @xmath248 since the function @xmath236 is increasing on @xmath237 , we deduce @xmath249 subtracting @xmath245 from both sides yields that the @xmath250 in is bounded below by @xmath251    _ acknowledgments . _ we thank filippo santambrogio for his remarks on a preliminary version of the paper and for pointing out the example leading to .",
    "this work was completed at the mathematical sciences research institute in berkeley , california , while the first author was a program associate and the second author a huneke postdoctoral scholar .",
    "the warm hospitality of the institute is kindly acknowledged .",
    "evans , l.c . ,",
    "gangbo , w. : differential equations methods for the monge - kantorovich mass transfer problem , mem .",
    "soc . , 653 ( 1999 ) .",
    "feldman , m. , mccann , r.j . :",
    "uniqueness and transport density in monge s mass transportation problem , cal .",
    "pde , 15 ( 2002 ) , 81 - 113 .",
    "monge , g. : mmoire sur la thorie des dblais et des remblais , histoire de lacadmie royale des sciences de paris ( 1781 ) , 666 - 704 .",
    "sudakov , v. n. : geometric problems in the theory of infinite dimensional probability distributions , proc .",
    "steklov inst . , 141 ( 1979 ) , 1 - 178 .",
    "trudinger , n.s . ,",
    "wang , x.j . : on the monge mass transfer problem , calc .",
    "pde , 13 ( 2001 ) , 19 - 31 ."
  ],
  "abstract_text": [
    "<S> we provide counterexamples to regularity of optimal maps in the classical monge problem under various assumptions on the initial data . our construction is based on a variant of the counterexample in @xcite to lipschitz regularity of the monotone optimal map between smooth densities supported on convex domains . </S>"
  ]
}