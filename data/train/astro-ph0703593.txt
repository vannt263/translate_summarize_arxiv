{
  "article_text": [
    "during the last decades many efforts have been taken to numerically simulate the collapse of stellar cores ( see e.g.  @xcite and references therein ) .",
    "a myriad of difficulties arise for its modelling as many physical effects are involved in a process whose dynamics is highly nonlinear .",
    "analytic approaches are of limited use and numerical simulations are needed to solve the coupled system of equations describing the fluid motion , the spacetime evolution , the dynamics of the magnetic fields , and the neutrino transport .",
    "such simulations are driving progress in the field despite the limited knowledge on relevant _ physical _ issues such as realistic precollapse stellar models ( including rotation and magnetic field strength and distribution ) or microphysical , finite - temperature equation of state ( eos ) , as well as _ numerical _ limitations involved in the challenging task of accounting for boltzmann neutrino transport , multidimensional hydrodynamics , and relativistic gravity",
    ".    only very recently the first multidimensional simulations of relativistic rotational core collapse have become possible , thanks to the use of conservative formulations of the hydrodynamics equations and advanced numerical methodology , as well as long - term stable formulations of einstein s equations ( or accurate enough approximations )  @xcite ( see also  @xcite ) . on the other hand ,",
    "the incorporation of magnetic fields and the mhd equations in numerical codes to further improve the realism of such simulations in general relativity , is currently an emerging field where significant progress is bound to be soon achieved ( see  @xcite ) .",
    "neutron stars have intense magnetic fields ( @xmath0 g ) or even larger at birth .",
    "the presence of such magnetic fields renders magneto - rotational core collapse simulations mandatory . in recent years",
    ", an increasing number of authors have performed axisymmetric simulations ( within the so - called ideal mhd limit ) employing newtonian treatments of the magneto - hydrodynamics , the gravity , and of the microphysics ( see  @xcite and references therein ) .",
    "the weakest point of all existing simulations to date is the fact that the strength and distribution of the initial magnetic field in the core are basically unknown .",
    "the available simulations show that for weak initial fields ( @xmath1 g , which is the most relevant case , astrophysics - wise ) there are no major differences in the collapse dynamics nor in the resulting gravitational wave signal , when comparing with purely hydrodynamical simulations",
    ". however , strong initial fields ( @xmath2 g ) manage to slow down the core efficiently ( leading even to retrograde rotation in the proto - neutron star ( pns ) ) which causes qualitatively different dynamics and gravitational wave signals .",
    "this paper presents a general relativistic magneto - hydrodynamics ( grmhd ) code designed to study magneto - rotational , relativistic , stellar core collapse .",
    "our grmhd code is an extension of the hydrodynamics code developed by  @xcite , where magnetic fields are included following the approach laid out in  @xcite .",
    "einstein s equations are formulated using the conformally flat condition ( cfc ) , which has proved very accurate for studying rotational core collapse  @xcite .",
    "leaving aside radiation transport , whose effects on core collapse dynamics and gravitational radiation are dramatic and its numerical modelling is a challenge in itself ( see  @xcite and references therein ) , we adopt here as a first step towards simulating realistic magneto - rotational core collapse the _ passive _ magnetic field approximation , which is justifiable for the magnetic field values present in this scenario .",
    "the paper focuses on describing the details of the numerical schemes we use and the tests performed with the code .",
    "a representative magneto - rotational core collapse simulation is also presented and briefly discussed .",
    "a parameter - space survey of the magneto - rotational core collapse scenario will be presented elsewhere .",
    "we note that during the development of this work we have been made aware of a similar study reported in  @xcite .",
    "we adopt the @xmath3 formalism to foliate the spacetime into spacelike hypersurfaces . in this formulation",
    "the metric reads @xmath4 , where @xmath5 is the lapse function , @xmath6 the shift vector , and @xmath7 the spatial three - metric induced in each hypersurface . from the energy - momentum tensor",
    "@xmath8 it is possible to build the following quantities : @xmath9 , @xmath10 , and @xmath11 , using the projection operator @xmath12 and the unit four - vector @xmath13 normal to the hypersurface .      to solve einstein s field equations we use the cfc approximation  @xcite . in this approach ,",
    "the three - metric in the adm gauge @xmath14 , is assumed to be conformally flat , @xmath15 . in these expressions @xmath16",
    "is the conformal factor , @xmath17 is transverse and traceless , and @xmath18 is the flat three - metric . note that the adm gauge choice implies the maximal slicing condition in which the trace of the extrinsic curvature vanishes . under the cfc approximation ,",
    "einstein s field equations can be written as a system of five elliptic equations @xmath19 where @xmath20 and @xmath21 are the laplacian and divergence operators in flat spacetime , @xmath22 , and @xmath23 is the extrinsic curvature .      for a perfect fluid endowed with an electromagnetic field",
    "the energy - momentum tensor is the sum of a fluid part and of a electromagnetic field part @xmath24 where @xmath25 is the rest - mass density , @xmath26 is the relativistic enthalpy , @xmath27 is the specific internal energy , @xmath28 is the pressure , and @xmath29 is the four - velocity of the fluid .",
    "the electromagnetic tensor @xmath30 , and its dual @xmath31 can be expressed in terms of the electric field @xmath32 and the magnetic field @xmath33 measured by an observer with four - velocity @xmath34 .",
    "we denote by @xmath35 and @xmath36 the electric and magnetic fields , respectively , measured by a comoving observer @xmath29 .",
    "the equations governing the evolution of the electro - magnetic fields are maxwell s equations , which can be written in terms of the faraday tensor as @xmath37 and @xmath38 , where @xmath39 is the electric four - current . under the assumption",
    "that ohm s law is fulfilled , the latter reads @xmath40 , where @xmath41 is the proper charge density and @xmath42 is the electric conductivity .",
    "maxwell s equations can be simplified if the fluid is a perfect conductor ( @xmath43 ) . in this case , to keep the current finite , @xmath35 must vanish .",
    "this case corresponds to the so - called ideal mhd condition . under this condition",
    "the four - vector electric field @xmath44 can be expressed in terms of the four - vector magnetic field @xmath45 , and , thus , only equations for @xmath46 are needed .",
    "it is convenient to choose as observer the eulerian observer , @xmath47 , for which the temporal component of the electric field vanishes , @xmath48 . in this case",
    "the first set of maxwell s equations reduce to the divergence - free condition plus the induction equation for the magnetic field @xmath49 where @xmath50 and @xmath51 , @xmath52 being the three - velocity as measured by the eulerian observer . here",
    ", @xmath53 denotes the ratio of the determinants of the three - metric and the flat three - metric , @xmath54 .",
    "the total magnetic flux through a closed surface @xmath55 enclosing a volume @xmath56 can be calculated as a surface integral of the `` starred '' magnetic field as @xmath57 after applying gauss theorem and the magnetic field divergence - free constraint . quantities in boldface correspond to three - vectors .",
    "the scalar product ( @xmath58 ) , and the cross product ( @xmath59 ) used below , are defined with respect to the flat three - metric @xmath18 .",
    "this equation implies that no source of magnetic flux exists inside the volume @xmath56 and , therefore , the magnetic flux is a conserved quantity as @xmath60 .",
    "in addition , if we consider a generic surface @xmath55 ( without the restriction of having to enclose a volume ) , the time variation of the magnetic flux through the surface is @xmath61 \\cdot d{\\mbox{\\boldmath $ \\hat{\\su}$ } }   = -\\oint_{\\hat{\\cu}=\\partial \\hat{\\su } } { \\mbox{\\boldmath $ e$}}^ * \\cdot d{\\mbox{\\boldmath $ \\hat{l}$ } } , \\label{eq : mflux_suface}\\end{aligned}\\ ] ] where we have used the induction equation ( [ eq : induction ] ) and stokes theorem to transform the surface integral into a line integral along the curve @xmath62 enclosing @xmath55 , and the equality @xmath63 .",
    "the two properties just inferred allow us to design a numerical algorithm to solve the induction equation and the divergence constraint in a way that ensures the conservation of the magnetic flux .",
    "in the ideal mhd limit the energy - momentum tensor of the electromagnetic field can be written in terms of the magnetic field @xmath64 measured by a comoving observer .",
    "the total energy - momentum tensor is thus given by @xmath65 where @xmath66 .",
    "we define the magnetic pressure @xmath67 and the specific magnetic energy @xmath68 , as their effects on the dynamics are similar to those played by the pressure and the specific internal energy .",
    "the evolution of the magneto - fluid is determined by the conservation law of the energy - momentum @xmath69 and the continuity equation @xmath70 , for the rest - mass current @xmath71 . following the procedure laid out in  @xcite",
    ", the magnetic field can be accounted for by choosing the conserved quantities in a similar way to the purely hydrodynamical case  @xcite @xmath72 with this choice , the system of conservation equations for the fluid and the induction equation for the magnetic field can be cast as a first - order , flux - conservative , hyperbolic system , as @xmath73 = { \\mbox{\\boldmath $ q$ } } ,    \\label{eq : hydro_conservation_equation}\\ ] ] with the state vector , flux vector , and source vector given , respectively , by @xmath74 , \\\\    { \\mbox{\\boldmath $ f$}}^i & = & \\left [    d \\hat{v}^i    , s_j \\hat{v}^i + \\delta^i_j \\left(p + \\frac{b^2}{2}\\right ) -   \\frac{b_j b^i}{w }     \\right.\\nonumber \\\\&&\\left .    ,",
    "\\tau \\hat{v}^i + \\left(p + \\frac{b^2}{2}\\right ) v^i - \\alpha \\frac{b^0 b^i}{w }    , \\hat{v}^i b^k - \\hat{v}^k b^i    \\right ] , \\label{eq : mhydro_conservation_equation_vectors_flux } \\\\    { \\mbox{\\boldmath $ q$ } } & = & \\left [ 0 , \\frac{1}{2 } t^{\\mu \\nu }    \\frac{\\partial g_{\\mu \\nu}}{\\partial x^j } ,    \\alpha \\ !",
    "\\left ( \\ ! t^{\\mu 0 } \\frac{\\partial \\ln \\alpha}{\\partial x^\\mu } -    t^{\\mu \\nu } { \\it \\gamma}^0_{\\mu \\nu } \\ !",
    "\\right ) , 0^k \\ !",
    "\\right ] \\!.",
    "\\label{eq : mhydro_conservation_equation_vectors}\\end{aligned}\\]]we note that these expressions contain components of the magnetic field measured by both , a comoving observer and an eulerian observer .",
    "the two are related by @xmath75      anticipating the numerical methods that we use to solve the conservation equations ( [ eq : hydro_conservation_equation ] ) , we need to know the wave structure of the hyperbolic system of equations .",
    "the associated flux - vector jacobians in every direction are @xmath76 matrices , and the solution of the eigenvalue problem @xcite leads to seven types of waves , which may appear when solving the riemann problem for each direction  @xmath77 : the entropic wave @xmath78 , the alfven waves @xmath79 , and the magnetosonic waves .",
    "there is no analytic expression for the latter , which must be computed as the solution of a quartic equation ( see  @xcite for details ) . among the magnetosonic waves , the two solutions with maximum and minimum speeds are called",
    "_ fast _ magnetosonic waves @xmath80 , and the two solutions in between are the so - called _ slow _ magnetosonic waves @xmath81 . the seven waves can be ordered as follows @xmath82 .      in the collapse of _",
    "weakly magnetized _ stellar cores , it is a good approximation to consider that the magnetic field entering in the energy - momentum tensor of ( [ eq : tmunu_grmhd ] ) is negligible when compared with the fluid part , i.e. @xmath83 , @xmath84 , and that the components of the anisotropic term of @xmath85 satisfy @xmath86 . with such simplifications the remaining system of equations comprises the hydrodynamics equations ( with no magnetic field ) and the induction equation . in this case , the magnetic field evolution does not affect the dynamics of the fluid , but it does depend on the evolution of the matter due to the presence of the velocity components in the induction equation .    such `` test magnetic field '' ( or passive field ) approximation is employed in the core collapse simulations reported in this paper . in this approximation",
    "the seven eigenvalues of the grmhd riemann problem reduce to three @xmath87 where @xmath88 and @xmath89 are the eigenvalues of the jacobian matrices of the hydrodynamics equations ( see @xcite ) .",
    "the grmhd numerical code presented in this paper is based on the hydrodynamics code described in @xcite , and on its extension discussed in @xcite .",
    "the code performs the coupled evolution of the equations governing the dynamics of the spacetime , fluid , and magnetic fields in general relativity .",
    "the equations are implemented in the code using spherical polar coordinates @xmath90 , assuming axisymmetry with respect to the rotation axis and equatorial plane symmetry at @xmath91 . for the various types of pdes implemented in the code we use the most appropriate numerical methods , which will be described next .",
    "since we adopt the passive magnetic field approximation , the fluid evolution is not affected by the magnetic field .",
    "such evolution is performed using a high - resolution shock - capturing ( hrsc ) scheme which numerically integrates a subset of equations in system  ( [ eq : hydro_conservation_equation ] ) , the one corresponding to the purely hydrodynamical variables ( @xmath92 ) .",
    "hrsc methods ensure numerical conservation of physically conserved quantities and a correct treatment of discontinuities such as shocks ( see e.g. @xcite and references therein ) .",
    "following @xcite we use a linear reconstruction procedure with a _",
    "slope limiter , which yields second order accuracy in space .",
    "correspondingly , the time update of the state vector @xmath93 is done using the method of lines in combination with a second - order accurate runge ",
    "kutta scheme .",
    "the numerical fluxes at cell interfaces are obtained using `` incomplete '' approximate riemann solvers , i.e. solvers that do not need the full characteristic information of the system .",
    "this kind of solvers are particularly useful in grmhd , where the full set of eigenspeeds of the flux - vector jacobians is not known in a closed form @xcite .",
    "we have implemented the hll single - state solver of @xcite and the symmetric scheme of @xcite ( kt ) .",
    "both solvers yield results with an accuracy comparable to complete riemann solvers ( with the full characteristic information ) , as shown in simulations involving purely hydrodynamical special relativistic flows @xcite and general relativistic flows in dynamical spacetimes @xcite .",
    "test of both solvers in grmhd have been reported recently by @xcite .",
    "the magnetic field evolution needs to be performed in a different way to the rest of the conservation equations , since the physical meaning of the corresponding conservation equation is different .",
    "although the induction equation can be written in a flux conservative way , a supplementary condition for the magnetic field has to be given ( the divergence constraint ) , and it has to be fulfilled at each time iteration . as shown before ,",
    "the physical meaning of these two equations is the conservation of the magnetic flux in a closed volume , in our case each numerical cell .",
    "therefore , an appropriate numerical scheme has to be used which takes full profit of such conservation law . among the numerical schemes that satisfy this property ( see @xcite for a review ) , the constrained transport ( ct ) scheme @xcite has proved to be adequate to perform accurate simulations of magnetized flows .",
    "our particular implementation of this scheme has been adapted to the spherical polar coordinates used in the code .          in order to implement the ct scheme in our numerical code we have to analyze how the magnetic flux behaves at the surface of a numerical cell .",
    "therefore , we apply ( [ eq : mflux_suface ] ) for the magnetic flux evolution in the interfaces along the direction of each coordinate ( see figure  [ fig : fluxes ] ) . to do this",
    "we assume that @xmath94 is constant over each cell surface , and @xmath95 is constant along each cell edge .",
    "in the @xmath96 direction this yields @xmath97_a   - [ e^*_{\\varphi } \\delta \\hat{l}_{\\varphi } ] _ c , \\end{aligned}\\ ] ] keeping in mind that the axisymmetry condition imposes that @xmath98_b = [ e^*_{\\theta } \\delta \\hat{l}_{\\theta } ] _ d$ ] .",
    "we define @xmath99 as the surface of the cell interface perpendicular to the @xmath77 direction and @xmath100 as the length of the cell edge in the @xmath77 direction . in the @xmath101 and @xmath102 directions",
    "similar relationships can be found .",
    "we represent all these quantities in the numerical grid , which has a total number of @xmath103 points ( cell centers ) labelled @xmath104 , with @xmath105 and @xmath106 .",
    "cell interfaces between neighboring cells are denoted as @xmath107 for the radial ones and @xmath108 for the angular ones .",
    "hence , indices @xmath109 denote cell edges in the @xmath102 direction . in order to implement the ct scheme we do not define the poloidal magnetic field cell - centered but at the interfaces , i.e @xmath110 and @xmath111 .",
    "however , as we assume axisymmetry , we use a cell - centered toroidal field @xmath112 because this component does not play any role in the ct scheme .",
    "therefore , we consider hereafter the poloidal components of the magnetic field only . with such considerations the above equations for the magnetic flux time evolution lead to equations for the magnetic field evolution ( ct scheme ) .",
    "the poloidal components read : @xmath113_{i+{\\leavevmode\\kern.0em              \\raise.5ex\\hbox{\\tiny 1}\\kern-.1em                      /\\kern-.15em\\lower.25ex\\hbox{\\tiny 2}}\\ j-{\\leavevmode\\kern.0em              \\raise.5ex\\hbox{\\tiny",
    "1}\\kern-.1em                      /\\kern-.15em\\lower.25ex\\hbox{\\tiny 2 } } }    - \\left[e^*_{\\varphi}\\ \\delta \\hat{l}_{\\varphi}\\right]_{i+{\\leavevmode\\kern.0em              \\raise.5ex\\hbox{\\tiny 1}\\kern-.1em                      /\\kern-.15em\\lower.25ex\\hbox{\\tiny 2}}\\ j+{\\leavevmode\\kern.0em              \\raise.5ex\\hbox{\\tiny 1}\\kern-.1em                      /\\kern-.15em\\lower.25ex\\hbox{\\tiny 2 } } } }    { \\delta \\su_{r \\ i+{\\leavevmode\\kern.0em              \\raise.5ex\\hbox{\\tiny 1}\\kern-.1em                      /\\kern-.15em\\lower.25ex\\hbox{\\tiny 2}}\\ j } } , \\\\ \\left.\\frac{\\partial b^{*\\ , \\theta}}{\\partial t}\\ \\right|_{i \\",
    "j+{\\leavevmode\\kern.0em              \\raise.5ex\\hbox{\\tiny 1}\\kern-.1em                      /\\kern-.15em\\lower.25ex\\hbox{\\tiny 2 } } } & = &    \\frac{\\left [ e^*_{\\varphi } \\",
    "\\delta \\hat{l}_{\\varphi}\\right]_{i+{\\leavevmode\\kern.0em              \\raise.5ex\\hbox{\\tiny 1}\\kern-.1em                      /\\kern-.15em\\lower.25ex\\hbox{\\tiny",
    "2}}\\ j+{\\leavevmode\\kern.0em              \\raise.5ex\\hbox{\\tiny 1}\\kern-.1em                      /\\kern-.15em\\lower.25ex\\hbox{\\tiny 2 } } }    - \\left [ e^*_{\\varphi}\\ \\delta \\hat{l}_{\\varphi}\\right ] _ { i-{\\leavevmode\\kern.0em              \\raise.5ex\\hbox{\\tiny 1}\\kern-.1em                      /\\kern-.15em\\lower.25ex\\hbox{\\tiny 2}}\\ j+{\\leavevmode\\kern.0em              \\raise.5ex\\hbox{\\tiny 1}\\kern-.1em                      /\\kern-.15em\\lower.25ex\\hbox{\\tiny 2 } } } }    { \\delta \\su_{\\theta \\ i \\",
    "j+{\\leavevmode\\kern.0em              \\raise.5ex\\hbox{\\tiny 1}\\kern-.1em                      /\\kern-.15em\\lower.25ex\\hbox{\\tiny 2 } } } } .\\end{aligned}\\ ] ] the total magnetic flux through the cell interfaces is given by @xmath114 where we have taken into account that the total flux in the @xmath102 direction is zero owing to the axisymmetry condition .",
    "the time evolution of the total magnetic flux evolved with the ct scheme satisfies by construction that @xmath115_{i\\ j } = 0 $ ] , and therefore every numerical scheme constructed on the basis of the ct scheme will conserve magnetic flux up to machine accuracy .",
    "if we are able to generate initial conditions which satisfy the divergence constraint , i.e. with @xmath116 at each numerical cell , then , such constraint will be preserved during the numerical evolution . the way to build such initial data",
    "is explained below .",
    "the next step is to choose a discretization of the integrals by making explicit the values of the interface surfaces and of the edge lengths @xmath117 where @xmath118 , @xmath119 , @xmath120 , @xmath121 , and @xmath122 is arbitrary due to axisymmetry ( hence , the cell size on the @xmath102 direction does not play any role in the numerical scheme ) .",
    "taking into account the above expressions the evolution equations for the poloidal magnetic field read @xmath123 which are used in the numerical code to update the magnetic field .",
    "the only remaining aspect is to give an explicit expression for the value of @xmath124 . a practical way to calculate @xmath125 from the numerical fluxes in the adjacent interfaces",
    "@xcite is @xmath126,\\end{aligned}\\ ] ] where the fluxes are obtained in the usual way by solving riemann problems at the interfaces .",
    "the combination of the ct scheme and this way of computing the electric field is called the flux - ct scheme .",
    "it is used in all numerical simulations reported in this paper .",
    "the cfc metric equations are 5 nonlinear elliptic coupled poisson - like equations which can be written in compact form as @xmath127 , where @xmath128 , and @xmath129 is the vector of the respective sources . these five scalar equations for each component of @xmath130 couple to each other via the source terms that in general depend on the various components of @xmath130 .",
    "we use a fix - point iteration scheme in combination with a linear poisson solver to solve these equations .",
    "further details on such metric solver can be found in @xcite .",
    "since the ct scheme only preserves the value of @xmath131 but does not impose the divergence constraint of the magnetic field itself , we have build initial conditions which satisfy such condition . to do this",
    "we calculate the initial magnetic field from a vector potential @xmath132 , such that @xmath133 .",
    "we choose the following numerical discretization of this equation @xmath134 which warrants that the numerical magnetic flux @xmath135 over a cell is zero ( up to round - off error ) in the specific numerical representation of our ct scheme .    for our code tests and core collapse simulations we use two possible poloidal magnetic field configurations as initial conditions : a ) the homogeneous `` starred '' magnetic field , in which @xmath136 is constant and parallel to the symmetry axis , and b ) the magnetic field generated by a circular current loop of radius @xmath137 @xcite .",
    "note that in both cases , we employ the `` starred '' magnetic field , since the divergence constraint is valid for this quantity when computed with respect to the flat divergence operator . in this way we can extend any analytic prescription for the magnetic field given in flat spacetime in an easy way . note that in the presence of strong gravitational fields the magnetic field @xmath138 is deformed with respect to @xmath136 due to the curvature of the spacetime , although the divergence constraint is automatically fulfilled .",
    "we have designed several tests in order to check the accuracy of our numerical code when solving the induction equation with the numerical methods described in the previous sections .",
    "the `` toroidal test '' is designed to assess the ability of the code to maintain equilibrium magnetic field configurations ( labelled tta and ttb ) and to correctly compute the amplification of the toroidal magnetic field as it is wound up by a rotating fluid ( ttc ) . on the other hand ,",
    "the  poloidal test \" ( pt ) is designed to check whether the code can correctly compute the compression of the poloidal magnetic field in a spherical collapse , and its ability to handle the presence of radial shocks .",
    "we consider a rotating stationary configuration with no meridional flows , @xmath139 , and @xmath140 , where @xmath141 stands for the rotation law . under these conditions and in the passive field approximation , the induction equation can be integrated analytically .",
    "the solution shows that the poloidal component of the magnetic field remains constant and the toroidal component grows linearly with time as @xmath142 . in order to test whether the numerical code is able to recover this solution , we investigate three particular cases .",
    "for all three tests we consider a non - evolving fluid of constant density @xmath143 g @xmath144 filling the computational domain , and an equally - spaced grid in both the angular and radial directions .",
    "the outer radial boundary is located at @xmath145 km .",
    "we also assume a static background spacetime with a flat metric .",
    "we note that our choice of units is arbitrary since the background metric is flat .",
    "however , we maintain the adopted units to keep a link with the scenario for which the code is prepared , namely core collapse.test tta consists in a rigidly rotating fluid , @xmath146 , and the magnetic field generated by a circular current loop of radius @xmath147 km .",
    "test ttb includes a homogeneous magnetic field and a differentially rotating fluid with a rotation law given by @xmath148 , with @xmath149 km . in both cases the analytic solution corresponds to a non - evolving toroidal magnetic field because @xmath150 .",
    "the third test , ttc , consists in a homogeneous magnetic field and a fluid satisfying a rotation law depending on the radius @xmath151 , and @xmath149 km . in this case",
    "the analytical solution is given by @xmath152 in all three cases the central angular velocity @xmath153 is such that the center rotates 10 times during the complete evolution , namely 1 ms .",
    "once this time is reached we compute the local error @xmath154 between the analytical solution @xmath155 and the numerical one , and the global error @xmath42 calculated as the l2-norm of the local error .    if we consider a reference ( low resolution ) grid @xmath156 with an error @xmath157 and a subsequent grid with a factor @xmath158 higher resolution , i.e. @xmath159 and @xmath160 , then the error on the new grid , @xmath161 , is related to the error on the reference grid as @xmath162 , where @xmath163 is the order of the numerical scheme . by fitting the values of @xmath161 as a function of @xmath164 we can easily calculate the convergence order @xmath163 . for our test simulations",
    "we consider a reference grid of @xmath165 cells ( @xmath166 ) , and higher resolution grids of @xmath167 ( @xmath168 ) and @xmath169 ( @xmath170 ) cells , respectively .",
    "figure  [ fig : tt ] shows the resulting @xmath161 for the three tests versus @xmath164 .",
    "our results show that ( i ) the order for the ttc test ( @xmath171 , obtained by fitting the data to a power law ) is smaller than for the tta and ttb tests ( @xmath172 and 2.64 , respectively ) , and ( ii ) the order for cases tta and ttb is @xmath173 , and hence higher than the theoretical expectation ( second order given by the time and space discretization order ) .",
    "the main difference between the case ttc and the cases tta and ttb , which explain these results , is that in the first case there is a component of the magnetic field , @xmath174 , which grows linearly in time , while in the other two cases no components evolve .",
    "hence , the order of convergence for tests tta and ttb is higher than for test ttc .",
    "we suspect that this is due to more precise numerical cancellations in eqs .",
    "( [ eq : ct_r ] ) and ( [ eq : ct_theta ] ) ( which have @xmath175 ) in tests tta and ttb .",
    "this can be explained by computing the _ local _ order of convergence , i.e. the order obtained when computing the errors of each numerical cell , @xmath176 , instead of the global error @xmath42 .",
    "the results for test tta are displayed in figure  [ fig : tta_nij ] ( similar plots can be obtained for the other two cases ) .",
    "it can be seen that at some particular grid zones the order of convergence is larger than two , while at most locations it remains around two .",
    "we note that the computation of the initial magnetic field for test tta is not analytic but the result of an expansion with infinite terms .",
    "this expansion is computed to a required level of accuracy , typically smaller than the accuracy required during the evolution in the routine to recover the primitive variables from the state vector . for a particular direction , however , close to the center of the  peculiar \" cells in figure  [ fig : tta_nij ] , the solution needs infinite terms , and the resulting solution is thus less accurate at these points .",
    "the physical meaning of this direction in the equatorial plane is that it coincides with the radius of the current loop which generates the initial magnetic field .",
    "next , we consider a test in which only radial velocities of the fluid are allowed , i.e. @xmath177 and @xmath178 .",
    "we also consider initially a purely poloidal magnetic field . in this case",
    ", it can be easily shown from the induction equation  ( [ eq : induction ] ) and the continuity equation  ( [ eq : hydro_conservation_equation ] ) that the following equivalence holds in the equatorial plane @xmath179 which is an advection equation for @xmath180 with velocity @xmath181 at the equator .",
    "since only radial velocities are allowed , it is possible to define a lagrangian coordinate system in which the value @xmath182 does not change with time . the easiest way of checking this condition is to calculate @xmath183 ( m)$ ] , i.e. as a function of the mass enclosed within a radius @xmath96 defined as @xmath184 .",
    "this quantity should remain constant in time , provided the magnetic field is correctly evolved with our numerical code .        to test this fact we perform simulations of spherical collapse in which the above conditions are satisfied .",
    "the initial model is a spherical equilibrium 4/3-polytrope ( tov ) with central density @xmath185 g @xmath144 and a homogeneous ( starred ) magnetic field .",
    "we use a hybrid eos ( see @xcite ) .",
    "we induce the collapse by reducing the initial adiabatic index to @xmath186 .",
    "as the eos stiffens at nuclear matter density the star bounces ( @xmath187 ms ) and a shock forms , which travels outward .",
    "we calculate the global error @xmath42 in the collapse phase as the l2-norm applied to the differences in the quantity @xmath183 ( m)$ ] between its initial value and its value at subsequent time steps . in the left panel of figure  [ fig : pta ]",
    "we show the evolution of such error during the collapse for different @xmath188-grid resolutions , equally - spaced in the angular direction and logarithmically spaced in the radial direction , except for the inner @xmath145 radial grid points which are equally - spaced . in each case",
    "the errors are below @xmath189 , even for the coarsest grid , and the computed order of convergence during the collapse ( at @xmath190  ms ) is 1.41 .    in order to check our numerical code after core bounce we plot in the right panel of figure  [ fig : pta ] @xmath191 ( m)$ ] at time @xmath192 ms , for the three different grid resolutions .",
    "the initial profile is shown by the dotted curve .",
    "the effect of the travelling shock is seen as a small spike , that becomes narrower as the resolution is increased . on the other hand , deviations from the initial profile",
    "occur near the inner core boundary of the pns ( where the density exceeds nuclear matter density ) .",
    "this numerical error becomes smaller as the resolution covering the inner region is increased by using a grid of @xmath193 zones , with @xmath194 equally - spaced radial zones in the inner part instead of @xmath145 .",
    "this resolution is the same as the one used in magneto - rotational core collapse simulations .",
    "it guarantees sufficient resolution in the region where the pns forms .",
    "we have performed comparisons of the hll approximate riemann solver and the kt symmetric scheme , finding almost identical results ( in agreement with @xcite ) .",
    "we end the paper by discussing a representative magneto - rotational core collapse simulation .",
    "a parameter - space survey of a large sample of models will be presented elsewhere .",
    "the initial model , which we label a1b3g3-d3m0 , is a general relativistic and rotating @xmath195-polytrope in equilibrium , and is the magnetized version of the purely hydrodynamical model a1b3g3 of @xcite , which is differentially and rapidly rotating .",
    "the configuration of the initial magnetic field is a circular current loop of radius @xmath196 km with a strength at the center of the loop of @xmath197 g. for such value the passive field approximation is adequate , since , locally , @xmath198 throughout the simulation",
    ". the collapse begins by lowering the adiabatic index to @xmath199 .",
    "the same hybrid eos as in the pt test is used .",
    "we employ the numerical grid described in the previous section .",
    "figure  [ fig : beta_mcollapse ] shows the evolution of the energy parameter for the magnetic field , @xmath200 , defined as the ratio of magnetic energy , @xmath201 , to the potential energy @xmath202 ( see e.g.  @xcite ) . in order to analyze the growth of the magnetic field ,",
    "we separate the effect of the different components of the magnetic field into @xmath203 , for the toroidal component , and @xmath204 , for the poloidal component , which are also plotted in the figure . as the collapse proceeds , and leaving aside the effects of the magneto - rotational instability ( mri )",
    ", the magnetic field grows by at least two reasons : first , the radial flow compresses the magnetic field lines , amplifying the existing poloidal and toroidal magnetic field components .",
    "second , during the collapse of a rotating star differential rotation is produced , even for rigidly rotating initial models , as shown in numerical simulations ( e.g.  @xcite ) .",
    "this fact can be easily explained considering that energy and angular momentum are roughly conserved in cylindrical regions ( see e.g.  @xcite ) .",
    "hence , if a seed poloidal field exists , the @xmath205-dynamo mechanism acts winding up poloidal field lines into the toroidal component .",
    "this ( linear ) amplification process generates a toroidal magnetic field component , even from purely poloidal initial configurations .",
    "the toroidal component of the magnetic field is affected by the two effects while the poloidal field is only amplified by the first effect ( radial compression ) .",
    "thus , even if the initial magnetic field configuration is purely poloidal , the toroidal component dominates after some dynamical time . this can be seen in figure  [ fig : beta_mcollapse ] as @xmath206 ( dashed line ) grows much faster than @xmath207 , particularly after bounce ( @xmath208 ms ) when the radial compression mechanism stops .",
    "we note that as the magnetic field considered is weak enough not to affect the dynamics , the final @xmath200 is much less than unity .",
    "figures  [ fig : a1b3g3_d3m0_color_bounce1 ] and [ fig : a1b3g3_d3m0_color_bounce2 ] show the innermost 100 km of the star after core bounce .",
    "a pns has formed at the center with two distinct regions .",
    "the inner core of @xmath209 km , where nuclear matter density is reached , has a mixed poloidal - toroidal magnetic configuration , while there exists a surrounding shell extending to @xmath210 km , with sub - nuclear densities , that has a dominant toroidal magnetic field which grows linearly due to the @xmath205-dynamo mechanism resulting from the strong differential rotation of this shell . from the linear growth of this component we estimate that the magnetic field is likely to reach saturation values of @xmath211 g on a timescale of several seconds .",
    "however , by estimating the timescale of the fastest growing unstable mode of the mri in our simulation , we have checked that a significant fraction of the newly - formed pns , as well as the region behind the shock at the moment of its formation , could be affected by the mri .",
    "such instability can grow on dynamical timescales of several tens of ms @xcite , much faster than the @xmath205-dynamo mechanism . however , it is still an open issue  @xcite whether , for the weak magnetic fields encountered in core collapse progenitors , the amplification of the magnetic field is going to become important for the dynamics .",
    "if that were the case , the passive field approximation would not be valid in such regions , becoming necessary a full magnetic field treatment .",
    "we have presented a new general relativistic hydrodynamics code specifically designed to study magneto - rotational , relativistic , stellar core collapse . the code is built on an existing hydrodynamics code which has been thoroughly applied in the recent past to study relativistic rotational core collapse  @xcite .",
    "it is based on the conformally - flat approximation of einstein s field equations and conservative formulations for the magneto - hydrodynamics equations . as a first step towards magneto - rotational core collapse simulations ,",
    "the code assumes a _ passive _ ( test ) magnetic field , a justifiable assumption since weakly magnetized fluids are present in this scenario .",
    "the paper has focused on the description of the technical details of the numerical implementation , with emphasis on the magnetic field module .",
    "a number of tests have been presented and discussed , and the convergence properties of the code have been analyzed .",
    "in addition , a representative magneto - rotational core collapse simulation has been presented .",
    "the amplification of the magnetic field due to the @xmath212dynamo mechanism has been estimated ( acting on timescales of several seconds ) .",
    "more detailed studies of faster amplification mechanisms ( namely , mri ) are necessary for initially weak magnetic fields , since they could dominate the post - bounce dynamics within a few ms and might have a major effect on the gravitational wave signal .",
    "fryer c l and new k c b 2003 _ liv .",
    "_ 2002 - 2 dimmelmeier h 2005 _ phys",
    "d _ * 71 * 064023 woosley s and janka h - th .",
    "2005 _ nature physics _ * 1 * 147 dimmelmeier h 2002b _ astron . &",
    "_ * 393 * 523 shibata m and sekiguchi y 2004 _ phys .",
    "d _ * 69 * 084024 baiotti l 2005 _ phys .",
    "d _ * 71 * 024035 duez m d 2006 _ phys .",
    "lett . _ * 96 * 031101 shibata m 2006 _ phys .",
    "lett . _ * 96 * 031102 obergaulinger m 2006a _ astronom . &",
    "_ * 450 * 110734 dimmelmeier h 2002a _ astron . &",
    "_ * 388 * 917 antn l 2006 _ astrophys .",
    "j. _ * 637 * 296312 dimmelmeier h 2006 astro - ph/0603760 shibata m 2006 _ phys .",
    "d _ * 74 * 104026 wilson j r 1996 _ phys . rev . d _ * 54 * 1317 banyuls f 1997 _ astrophys .",
    "j. _ * 476 * 221 antn l 2006 _ phd thesis _ font j a 2003 _ liv .",
    "rel . _ * 6 * 4 cerd - durn p 2005 _ astron . &",
    "_ * 439 * 1033 harten a 1983 _ siam review _ * 25 * 35 kurganov a and tadmor e 2000 _ j. comp . phys . _ * 160 * 214 lucas - serrano a 2004 _ astron . &",
    "_ * 428 * 70315 shibata m and font j a 2005 _ phis .",
    "d _ * 72 * 047501 tth g 2000 _ j. comp .",
    "phys . _ * 161 * 605 evans c r and hawley j f 1988 _ astrophys",
    ". j. _ * 332 * 65977 balsara d s and spicer d s 1999 _ j. comp .",
    "phys . _ * 149 * 270 jackson j d 1962 _ classical electrodynamics _",
    "( new york : wiley ) meier d l 1976 _ astrophys .",
    "j. _ * 204 * 86978 hawley j f 2005 _ open issues in core collapse supernova theory _ ed .",
    "mezzacappa  a and fuller  g  m ( singapore : world scientific ) p  67"
  ],
  "abstract_text": [
    "<S> we present a new general relativistic hydrodynamics code specifically designed to study magneto - rotational , relativistic , stellar core collapse . </S>",
    "<S> the code is an extension of an existing ( and thoroughly tested ) hydrodynamics code , which has been applied in the recent past to study relativistic rotational core collapse . </S>",
    "<S> it is based on the conformally - flat approximation of einstein s field equations and conservative formulations for the magneto - hydrodynamics equations . as a first step towards magneto - rotational core collapse simulations </S>",
    "<S> the code assumes a _ passive _ ( test ) magnetic field . </S>",
    "<S> the paper is focused on the description of the technical details of the numerical implementation , with emphasis on the magnetic field module . </S>",
    "<S> a number of code tests are presented and discussed , along with a representative core collapse simulation . </S>"
  ]
}