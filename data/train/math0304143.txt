{
  "article_text": [
    "fifty years ago , von neumann @xcite suggested a method to generate unbiased random bits from a sequence of i.i.d .",
    "biased bits .",
    "this method can be easily implemented using a finite automaton .    in this paper",
    "we study the following generalization .",
    "let @xmath9 .",
    "suppose that we are given a function @xmath10 and , for some unknown @xmath11 , a sequence of independent tosses of a @xmath2-coin ( i.e. , @xmath12 valued random variables with mean @xmath2 ) . for which functions @xmath3",
    "is it then possible to simulate an @xmath4-coin ?",
    "the allowed simulation schemes apply a stopping rule to independent tosses of a @xmath2-coin , and then determine a @xmath12-valued variable with mean @xmath4 as a function of the stopped sequence .",
    "we emphasize that the scheme can not depend on @xmath2 .",
    "we are especially interested in simulation schemes that can be implemented by an automaton that receives the @xmath2-coin tosses as inputs , and outputs an @xmath4-coin ; see  1.2 for more formal definitions .",
    "a special case of this question was raised in 1991 by s. asmussen ( see @xcite ) .",
    "we learned of the general problem from j. propp ( personal communication ) who emphasized its computational aspects .",
    "the problem was considered in the context of markov chain simulation by glynn and henderson  @xcite .    in our main result",
    "we prove    [ thm : newauto ] let @xmath9 and @xmath10 .",
    "then an @xmath4-coin for @xmath11 can be simulated using a finite automaton from independent tosses of a @xmath2-coin , if and only if @xmath3 is the restriction to @xmath13 of a rational function @xmath14 over @xmath7 , such that @xmath15 for @xmath16 .    later using the result of the appendix we prove :    [ thm : newpush ]",
    "let @xmath17 .",
    "if an @xmath4-coin can be simulated from tosses of a @xmath2-coin by a pushdown automaton for all @xmath1 , then @xmath3 is an algebraic function over @xmath7 ; i.e. , there exists a non - zero polynomial @xmath18 $ ] such that @xmath19 for all @xmath20 $ ] .",
    "in  3.2 we describe pushdown automata that can simulate @xmath4-coins for certain non - rational functions such as @xmath8 .",
    "our results complement the work of keane and obrien ( 1994 ) , who considered the simulation problem without any computational restrictions .",
    "they showed that the functions @xmath21 for which an @xmath4-coin can be simulated ( in principle ) are precisely the constants , and all continuous functions on @xmath13 that satisfy @xmath22 for some @xmath23 and all @xmath24 .      here",
    "are some examples - see figure 1 .",
    "[ figure : auto1 ]     and @xmath25,title=\"fig:\",height=151 ]   and @xmath25,title=\"fig:\",height=151 ]   and @xmath25,title=\"fig:\",height=151 ]    * @xmath26 .",
    "this is achievable by von neumann s trick : toss the @xmath2 coin twice and let @xmath27 and @xmath28 be the outcome . if @xmath29 output @xmath30 , if @xmath31 declare @xmath32 ; otherwise , do not declare and toss again .",
    "this is the leftmost automaton .",
    "* @xmath33 .",
    "toss the @xmath2-coin twice .",
    "if it s @xmath34 declare @xmath32 , otherwise declare @xmath30 .",
    "this is the automaton in the middle .",
    "* @xmath35 .",
    "toss the @xmath2-coin twice until you get @xmath36 or @xmath34 . in the first case ,",
    "declare @xmath30 , in the second declare @xmath32 .",
    "this is the automaton on the right .",
    "* @xmath37 .",
    "theorem [ thm : auto ] implies that this function can not be simulated by a finite automaton . in section [ sec : push ] we construct a pushdown automaton which simulates @xmath3 . *",
    "our main result implies that there is no infinite set @xmath13 such that a @xmath38-coin can be simulated by a finite automaton for all @xmath11 from tosses of a @xmath2-coin .",
    "denote by @xmath39 the set of all finite binary strings , and call any subset of @xmath39 a _",
    "language_. say that a language @xmath40 has the _ prefix property _ if there is no pair of distinct strings @xmath41 such that @xmath42 is a prefix of @xmath43 .",
    "for any binary string @xmath44 , write @xmath45 = p^{n_1(w ) } ( 1 - p)^{n_0(w)}$ ] , where @xmath46 is the number of @xmath47 s in @xmath44 and let @xmath48 for any language @xmath40 .",
    "let @xmath49 $ ] where @xmath9 .    *",
    "a _ simulation of @xmath3 _ is a pair of disjoint languages @xmath50 such that @xmath51 has the prefix property and for all @xmath11 we have @xmath52 = f(p)$ ] and @xmath53 = 1 $ ] and @xmath52 = f(p)$ ] . * a _ simulation of @xmath3 by a finite automaton _",
    ", is a simulation @xmath54 of @xmath3 such that there exists a finite automaton which outputs @xmath30 for the language @xmath55 and outputs @xmath32 for the language @xmath56 . an analogous definition applied to simulation by a pushdown automaton or a turing machine .",
    "[ def : automaton ] a finite automaton is defined by    * a set of states @xmath57 with a start state @xmath58 . * an alphabet which we fix to be @xmath12 , * a transition function @xmath59",
    ", @xmath60 is the state the automaton is , given that it was in state @xmath61 and the current input symbol is @xmath62 . for a string",
    "@xmath63 we let @xmath64 be defined inductively by @xmath65 .",
    "* two disjoint sets of final states @xmath66 and @xmath67 .",
    "the automaton stops whenever it is in @xmath68 ( formally , for all @xmath68 and @xmath69 , it holds that @xmath70 ) .",
    "if it stopped at @xmath66 , then the output is @xmath30 ; if it stopped in @xmath67 , then the output is @xmath32 .",
    "this is a slight variation of the standard definition ( see e.g. @xcite ) where the automaton stops when the it gets to the end of the input . here",
    ", the input is unbounded .",
    "letting @xmath71 be the strings in @xmath39 for which the automaton stops at @xmath72 , the automaton will define a simulation of a function @xmath17 , if @xmath53 = 1 $ ] .",
    "note that @xmath55 and @xmath56 are both regular languages , and @xmath51 has the prefix property .",
    "moreover , for every pair of disjoint regular languages @xmath55 and @xmath56 with the prefix property , using a standard product construction , it easy to write down an automaton as in definition [ def : automaton ] which outputs @xmath30 for @xmath55 and @xmath32 for @xmath56 .",
    "note that in figure 1 , for the leftmost automaton , @xmath73 , @xmath74 ; for the middle automaton , @xmath75 , @xmath76 ; and for the rightmost automaton , @xmath77 , @xmath78 .",
    "the definition below is a slight variation of the standard definition of pushdown automata ( see e.g. @xcite for the standard definition ) .    [",
    "def : push ] a _ pushdown automaton _ over the alphabet @xmath12 is defined by    * a set of states @xmath57 with a start state @xmath79 . * a stack alphabet @xmath80 . * a stack @xmath81 which is initialized as the non - empty string @xmath82 . * a transition function @xmath83 .",
    "the first coordinate , @xmath84 , is the new state of the automaton given that it was in state @xmath61 , the current input symbol is @xmath62 and that the symbol at the top of the stack is @xmath82 . after this transition the symbol at the top of the stack",
    "is replaced by the string in the second coordinate of @xmath85 . * two disjoint sets of final states @xmath66 and @xmath67 .",
    "the automaton stops when the stack is empty .",
    "if the automaton stops at a state of @xmath66 , the output is @xmath30 , and if it stops at a state of @xmath67 , the output is @xmath32 .",
    "note that if @xmath55 ( @xmath56 ) are the languages where the automaton output @xmath30 ( @xmath32 ) , then @xmath55 and @xmath56 are context free languages , and @xmath51 has the prefix property .",
    "our results have a similar flavor to classical results of the chomsky schtzenberger theory @xcite - thus a relationship is established between the strength of a computation model and algebraic properties of the outputs generated by this model .",
    "we discuss some of the connections in more detail in subsections [ subsec : algauto ] and [ subsec : cs ] .",
    "the model we introduce in this paper has also some interesting relationships with the theory of computability @xcite as in both models the interest is in `` real '' inputs and outputs . in particular for both models , the input is unbounded .",
    "see subsection [ subsec : comp ] for a more formal discussion .",
    "finally a major motivation for studying this model is the theory of exact sampling , see e.g. @xcite . in the theory of exact sampling",
    "the aim is to sample ( exactly ) from a certain complicated distribution given a simpler given distribution .",
    "thus the problem is a basic problem in the theory of exact sampling . in subsection [ subsec : ex ]",
    "we give a ( toy ) example which illustrating how our results may be used for exact sampling .",
    "in section [ sec : auto ] we prove theorem [ thm : auto ] and its generalizations to collections of coins , dice etc . in section [ sec : push ] we prove theorem [ thm : newpush ] and show how using a push - down automaton , it is possible to simulate non - rational constants and functions . in section [ sec : related ] we discuss the relationships with the theory of languages and their formal power series , the theory of computability , exact sampling and suggest some open problems .",
    "a sub - family of the coins which can be simulated via finite - automata are those which can be simulated via blocks .",
    "von neumann s trick consists of reading @xmath86 bit blocks until @xmath87 or @xmath88 are reached , and then deciding @xmath30 for @xmath87 and @xmath32 for @xmath88 .",
    "block simulation is a generalization of this procedure defined as follows    [ def : block_simuation ] a _ block simulation _ of @xmath3 , is a simulation of @xmath3 of the following form .",
    "let @xmath89 and @xmath90 be disjoint subsets of @xmath91 , and @xmath92 .",
    "the simulation procedure has @xmath93 and @xmath94 . in other words ,",
    "the procedure reads a @xmath95 bit string @xmath44 .",
    "if @xmath96 , the procedure outputs @xmath30 , if @xmath97 the procedure outputs @xmath32 ; otherwise the procedure discards @xmath44 and reads a new @xmath95 bit string .    below we prove the following theorem which immediately implies theorem [ thm : newauto ] .",
    "[ thm : auto ] let @xmath9 . for @xmath10",
    "the following are equivalent .",
    "* @xmath3 can be block simulated .",
    "* @xmath3 can be simulated via a finite automaton .",
    "* @xmath3 is the restriction to @xmath13 of a a rational function @xmath14 over @xmath7 such that @xmath98 for all @xmath1 .",
    "note that @xmath99 is trivial .",
    "the implication @xmath100 is fairly easy .",
    "we know of no way of proving @xmath101 directly . instead , we prove @xmath102 .",
    "we know of no simple bound in terms of @xmath3 on the size of automaton ( or block ) needed in order to simulate @xmath3 , although there exists a simple algorithm for constructing an automaton that simulates @xmath3 .",
    "[ prop : auto ] let @xmath9 .",
    "if a finite automaton @xmath104 simulates @xmath10 , then @xmath3 is the restriction to @xmath13 of a rational function @xmath14 over @xmath7 such that @xmath98 for all @xmath1 .",
    "moreover if @xmath104 has @xmath105 states , then @xmath106 , where @xmath107 $ ] and @xmath108 and @xmath109 are of degree at most @xmath105 .",
    "the proof applies the maximum principle for harmonic functions on directed graphs .",
    "[ lem : max ] let @xmath104 be a finite automaton and @xmath110 a set of states such that for all @xmath111 , there exists @xmath112 , such that @xmath113 .",
    "let @xmath114 and @xmath115 be harmonic , so for all @xmath61 it holds that @xmath116 .",
    "then @xmath3 achieves its maximum and minimum in @xmath110 .",
    "moreover , given the values of @xmath3 in @xmath110 , the values of @xmath3 in @xmath57 are uniquely determined",
    ".    note first that the last assertion follows from the first one , as if @xmath117 and @xmath118 are two harmonic functions which have the same value on @xmath110 , then @xmath119 is harmonic and has the value @xmath30 on @xmath110 , which implies by the first assertion that @xmath120 , or @xmath121 .    in order to prove the first assertion ,",
    "let @xmath122 .",
    "note that if @xmath123 , then @xmath124 .",
    "letting @xmath112 be such that @xmath113 , we obtain @xmath125 as needed .",
    "* proof of proposition [ prop : auto]:0.2 cm * suppose that @xmath3 can is simulated by a finite automaton @xmath104 .",
    "let @xmath127 be the set of states @xmath61 such that there exists @xmath112 with @xmath128 .",
    "clearly , we may remove from the automaton all the states not in @xmath127 ( redefining @xmath129 by restriction ) and still obtain a finite automaton which simulates @xmath4 . by the assumption that @xmath53 = 1 $ ]",
    ", it follows that for all @xmath130 , there exists @xmath112 such that @xmath131 . from now on we assume that @xmath132 .",
    "note that since for all @xmath111 , there exists @xmath133 such that @xmath134 , it follows that @xmath53 = 1 $ ] for all @xmath114 .",
    "therefore the function @xmath3 is the restriction of the function @xmath135 $ ] to @xmath13 .",
    "suppose that @xmath136 satisfies @xmath137 for @xmath138 , and @xmath139 for @xmath140 .",
    "for all other @xmath61 , assume that @xmath141 by lemma [ lem : max ] , the function @xmath136 is uniquely determined by these equations .",
    "this implies that @xmath142 .",
    "since @xmath143 is uniquely determined by a collection of linear equation with coefficients in @xmath144 $ ] , it follows by cramer s rule that @xmath143 may be written as the ratio of two determinants in @xmath144 $ ] , and therefore @xmath145 , where the degrees of @xmath108 and @xmath109 are at most the number of states of the automaton , as needed .",
    "@xmath126      in this subsection we study what can be simulated by blocks .",
    "[ prop : block ] @xmath3 can be simulated using a block procedure if and only if @xmath3 can be written as @xmath146 where @xmath147 and for all @xmath47 , the coefficients @xmath148 and @xmath149 are integers such that @xmath150 .",
    "suppose that @xmath3 is block simulated .",
    "for a string @xmath112 , we write @xmath151 for the number of @xmath32s in @xmath44",
    ". then @xmath152 = \\frac{\\sum_{w \\in a_1 } \\p_p[w]}{\\sum_{w \\in a_0 \\cup a_1 } \\p_p[w ] } =       \\frac{\\sum_{i=0}^k d_i p^i ( 1-p)^{k - i}}{\\sum_{i=0}^k e_i p^i ( 1-p)^{k - i}},\\ ] ] where @xmath153 and @xmath154 satisfy that @xmath150 , as needed .",
    "for the other direction , suppose that @xmath155 , where @xmath156 and @xmath157 satisfy ( [ eq : de ] ) . let @xmath158 be a number such that @xmath159 for all @xmath47 .",
    "for each @xmath47 , fix a bijection @xmath160 from @xmath161 to @xmath162 .",
    "the sets @xmath89 and @xmath90 are subsets of @xmath163 , defined as follows .",
    "@xmath90 is defined as @xmath164 and @xmath89 as @xmath165    so @xmath166 & = & p^r ( 1-p)^{r } \\sum_{i=0}^k d_i p^i ( 1-p)^{k - i } , \\\\",
    "\\p_p[a_0 \\cup a_1 ] & = & p^r ( 1-p)^r \\sum_{i=0}^k e_i p^i ( 1-p)^{k - i},\\end{aligned}\\ ] ] and therefore , @xmath167 = \\frac{\\p_p[a_1]}{\\p_p[a_0 \\cup a_1 ] } = f(p),\\ ] ] as needed .",
    "@xmath126      in this section we prove theorem [ thm : auto ] .",
    "the proof is based on a beautiful theorem by plya @xcite ( see @xcite , 5759 ) .",
    "we let @xmath168 denote the open @xmath61-simplex of probability distributions , @xmath169    [ thm : polya ] let @xmath170 be homogeneous and positive polynomial in the variables @xmath171 .",
    "then for all sufficiently large @xmath105 , all the coefficients of @xmath172 are positive .    [",
    "lem : posrat ] let @xmath17 be a rational function",
    ". then there exist polynomials @xmath173 and @xmath174 @xmath175 where for all @xmath47 , the coefficients @xmath148 and @xmath149 are integers such that @xmath150 , and @xmath176 .",
    "as @xmath4 is a rational function it may be written in the form @xmath177 , where @xmath178 $ ] and @xmath179 $ ] are relatively prime polynomials . since @xmath180 for all @xmath114 , it follows that @xmath181 and @xmath182 do not change sign in the interval @xmath183 . without loss of generality",
    "we assume that @xmath184 and @xmath185 for all @xmath1 .",
    "note furthermore that if @xmath186 and @xmath187 , then we may define homogeneous polynomials @xmath188 and @xmath189 of degree @xmath95 , by letting @xmath190 , and @xmath191 .",
    "note that @xmath192 and @xmath193 .",
    "let us rewrite , @xmath194 the polynomials @xmath195 and @xmath196 are all positive homogeneous polynomials . therefore by theorem [ thm : polya ] , if follows that there exists an @xmath105 such that letting @xmath197 and @xmath198 , the polynomials @xmath173,@xmath174 and @xmath199 all have positive coefficients as polynomials in @xmath2 and @xmath200 .",
    "writing @xmath201 we obtain the required result .",
    "@xmath126    * proof of theorem [ thm : auto]:0.2 cm * the implication @xmath99 is trivial , the implication @xmath100 follows from proposition [ prop : auto ] , while @xmath102 follows from lemma [ lem : posrat ] together with proposition [ prop : block ] .      in this subsection",
    "we discuss generalizations of the problem to @xmath95-sided coins , such as dice .",
    "a _ simulation _ of @xmath202 , is a collection of @xmath203 disjoint languages property @xmath204 over the alphabet @xmath205 , such that @xmath206 has the prefix property and @xmath207 = f_i(p)$ ] for all @xmath208 . the definition of simulation via finite / pushdown automata and turing machines naturally extend to this setting .",
    "the continuity results of @xcite extend to the more general setting as well .",
    "[ prop : auto2 ] if a finite automaton simulates @xmath209 , then @xmath3 is a rational function over @xmath210 ( i.e. @xmath211 is a rational function over @xmath210 for all @xmath212 ) .    repeat the proof of proposition [ prop : auto ] for each of the @xmath213 s .",
    "@xmath126 .    repeating the proof of theorem [ thm : auto",
    "] , we see that    [ thm : auto2 ] any rational function @xmath214 can be simulated via blocks .    from which we conclude that    [ cor : auto2 ] any rational function @xmath209 can be simulated via blocks .",
    "the proof is by induction on @xmath203 .",
    "the case @xmath215 is covered by theorem [ thm : auto2 ] .",
    "suppose @xmath216 , and let @xmath217 be a rational function .",
    "by theorem [ thm : auto2 ] , there exists a block simulation @xmath218 for @xmath219 , and by the induction hypothesis there exists a block simulation @xmath220 for @xmath221 .",
    "taking @xmath222 we obtain a block simulation for @xmath223 as needed .",
    "we now prove theorem [ thm : newpush ] .",
    "we begin by showing that if @xmath3 is simulated by a pushdown automaton , then @xmath3 is the unique solution of a set of polynomial equations .",
    "we then invoke the results of the appendix to deduce that @xmath3 is an algebraic function . in section [ sec : push ] we also construct pushdown automata which simulate non - rational functions such as @xmath37 .",
    "we do nt know if every algebraic @xmath17 can be simulated by a pushdown automaton .",
    "the chomsky - schtzenberger theory implies that if @xmath55 and @xmath56 are languages which are generated by unambiguous grammars and @xmath224 $ ] , then @xmath4 is an algebraic function . in this subsection",
    "we aim to prove algebraic properties of @xmath3 even when @xmath55 and @xmath56 are inherently ambiguous .",
    "suppose @xmath104 is a pushdown automaton which simulates a function @xmath3 .",
    "call @xmath225 _ good _ , if when the automaton is at state @xmath61 and the stack is @xmath226 ( where @xmath62 is at the top ) , then with probability @xmath32 at some point the stack will be @xmath44 .",
    "call @xmath227 _ bad _ otherwise . by the assumption that @xmath53 = 1 $ ]",
    ", it follows that starting at @xmath228 it is impossible for the automaton to reach a state @xmath61 with @xmath226 at the top of the stack , where @xmath227 is bad .",
    "thus we can redefine all transitions @xmath229 , where @xmath230 is bad , in an arbitrary manner , and still obtain @xmath53 = 1 $ ] .",
    "therefore , without loss of generality we may assume that all @xmath225 are good .",
    "let @xmath231 \\times \\lambda \\times s \\times s \\to [ 0,1]$ ] be defined as follows . for @xmath232 ,",
    "let @xmath233 be the probability that given that currently the automaton is at state @xmath61 and has in its stack @xmath226 ( where @xmath62 is at the top ) , at the first time that the content of the stack will be @xmath44 , it will be at state @xmath234 .",
    "it is easily seen that @xmath233 is well defined ( does not depend on @xmath44 ) . moreover , by the assumption that all @xmath227 are good , it follows that @xmath235 .",
    "we extend the definition of @xmath236 to @xmath237 $ ] , where @xmath238 is the probability that given that currently the automaton is at state @xmath61 and has in its stack @xmath239 ( where @xmath42 is above @xmath44 ) , at the first time that the content of the stack will be @xmath44 , it will be at state @xmath234 . note that if @xmath240 , then @xmath241 where the sum is over all @xmath242 and if @xmath243 denotes the empty word , then @xmath244    note that if @xmath82 is the initial word at the stack , then @xmath245 = \\sum_{s ' \\in s_1 } \\tilde{\\alpha}(p ; \\tau , s_0 , s').\\ ] ]    therefore",
    "if we could prove algebraic properties of the functions @xmath233 , we will deduce algebraic properties of @xmath3 .",
    "[ claim : inf_harmonic ] for all @xmath114 , @xmath246 is the unique bounded solution of the equations @xmath247",
    "@xmath248    by linearity , it suffices to prove that the zero function is the only bounded solution to ( [ eq : alpha_harmonic ] ) with the boundary conditions @xmath249 fix @xmath250 .",
    "we will show that @xmath251 .",
    "consider the random walk @xmath252 defined on the graph @xmath253 , where @xmath254 .",
    "given @xmath255 , where @xmath256 , the conditional probabilities for @xmath257 are given by @xmath258 if @xmath259 is the empty word , then we let @xmath260 . by definition , for all @xmath261 , the process @xmath262 is a bounded martingale .",
    "the assumption that the pushdown automaton stops a.s . implies by ( [ eq : alpha_boundary_0 ] ) that the martingale converges to @xmath30 a.s .",
    "( and therefore in @xmath56 ) .",
    "we therefore conclude that @xmath263 is identically @xmath30 as needed .",
    "@xmath126    recall that given that the current state is @xmath61 , and the top of the stack is @xmath62 , with probability @xmath2 the automaton will move to state @xmath264 , and instead of @xmath62 , the top of the stack will contain @xmath265 ; with probability @xmath266 the automaton will move to state @xmath267 , and instead of @xmath62 , the top of the stack will contain @xmath268 .    we can therefore write @xmath269 or @xmath270 where the first ( second ) sum is taken over all @xmath271 note that ( [ eq : alph_recur2 ] ) defines a set of algebraic equations in @xmath2 and @xmath272 .    [ claim : eq_alpha ] for all @xmath114 , there is a unique positive solution @xmath273 \\times \\lambda \\times s \\times s \\to \\r$ ] , to equations ( [ eq : alph_recur2 ] ) and @xmath274    in order to prove the claim it suffices to show that each positive solution to ( [ eq : alph_recur2 ] ) and ( [ eq : alpha_prob ] ) defines a positive bounded solution to ( [ eq : alpha_harmonic ] ) and ( [ eq : alpha_boundary ] ) via ( [ eq : defalph ] ) and ( [ eq : defalph2 ] ) .",
    "it is immediate to see that ( [ eq : alph_recur2 ] ) implies ( [ eq : alpha_harmonic ] ) .",
    "moreover , ( [ eq : alpha_prob ] ) implies by ( [ eq : defalph ] ) that for all @xmath232 and @xmath275 , it holds that @xmath276 and so @xmath277 is a bounded function as needed .",
    "* proof of theorem [ thm : newpush]:0.2 cm * the result follows immediately from claim [ claim : eq_alpha ] by theorem [ thm1 ] .",
    "@xmath126      in this subsection we construct a pushdown automaton which simulates a non - rational function .",
    "let @xmath278 be a rational function .",
    "we ll construct a pushdown automata which simulates the function @xmath279 .",
    "taking @xmath280 , we obtain @xmath281 - thus using a product construction , it is easy to construct a pushdown automaton simulating the function @xmath37 .",
    "( 5,5 ) ( 1,0.5)@xmath30 ( 2,0.5)@xmath32 ( 1,1)(1,0)1 ( 1,1.5)(1,0)1 ( 1,2)(1,0)1 ( 1,2.5)(1,0)1 ( 1,3)(1,0)1 ( 1,3.5)(1,0)1 ( 1,1)(0,1)3 ( 2,1)(0,1)3 ( 3,2)(1,0)0.5 ( 3,2)(0,1)0.5 ( 3,3)@xmath282 ( 3,1)@xmath282 ( 5,1)@xmath282 ( 5,3)@xmath282 ( 3.25,2.2)@xmath283 ( 3,2)(0,-1)0.5 ( 5,2)(-1,0)0.5 ( 5,2)(0,1)0.5 ( 5,2)(0,-1)0.5    consider a random walk on the ladder graph @xmath284 where an edge @xmath285 is present if @xmath286 and @xmath287 , or @xmath288 and @xmath289 .",
    "the random walk moves to the left ( right ) with probability @xmath283 , and up ( down ) with probability @xmath282 .",
    "let @xmath290 be the probability that starting at @xmath183 the first hitting point of the random walk at level @xmath30 ( @xmath291 ) is @xmath292 .",
    "it is easy to see that @xmath293 and therefore @xmath294    it is easy to simulate the random walk with a pushdown automaton .",
    "the stack alphabet is @xmath295 where @xmath296 correspond to level @xmath105 of the ladder  the initial word at the stack is @xmath27 .",
    "assume first that the input alphabet is @xmath297 where the probability that letter @xmath32 appears is @xmath283 , and the probability that letter @xmath30 or @xmath86 appears is @xmath282 .",
    "let @xmath298 and @xmath299 be two states of the automaton corresponding the left @xmath300 and right @xmath301 of the ladder .",
    "reading the symbol @xmath32 will correspond to a transition from @xmath298 to @xmath299 or vice - versa without changing the content of the stack .",
    "reading the symbol @xmath86 at state @xmath302 will result at staying at state @xmath302 and pushing an @xmath27 to the stack .",
    "reading the symbol @xmath30 at state @xmath302 with @xmath27 at the top of the stack , will result at staying at state @xmath302 while popping @xmath27 from the stack . in this way it is possible to simulate",
    "the random walk given an infinite sequence of @xmath297 symbols with @xmath303 bias - and therefore toss a coin with bias ( [ eq : biasq ] ) .",
    "in the general case where we are given an infinite sequence of @xmath304 bits , we use block constructions of section [ sec : auto ] in order to generate a sequence of @xmath303 @xmath297 variables together with the above construction in order to obtain the required result .    similarly one may construct a pushdown automaton associated with a random walk on the ladder where the probabilities of going @xmath305 are given by @xmath306 .",
    "note however that in this case @xmath53 = 1 $ ] * iff * the random walk is recurrent * iff * @xmath307 .",
    "thus , unlike finite automata , there exist pushdown automata which define a valid simulation only for a proper subset of the interval @xmath183 .",
    "in the seminal paper @xcite titled `` the algebraic theory of context - free languages '' by chomsky and schtzenberger , the authors discuss many beautiful relationships between different types of languages and their generating functions .",
    "the generating function of a grammar generating a language @xmath40 is defined as @xmath308 , where @xmath309 is the number of derivations of the word @xmath44 in the grammar , and @xmath3 is viewed as a formal power series in the non - commutative variables @xmath30 and @xmath32 . the results of @xcite imply in particular that the generating function of a regular language is rational , which implies proposition [ prop : auto ]  simulation via finite automata always yield rational functions .",
    "in @xcite it is also proven that the generating function of a context - free language is algebraic . however , this does not imply that coins tossed via pushdown automata are algebraic , as many of the context free languages are inherently ambiguous and for such languages , the non - commutative power series @xmath310 is not algebraic .",
    "( see e.g. @xcite ; as larry ruzzo kindly noted , there are also context free languages with the prefix property that are inherently ambiguous ) .",
    "thus , while proposition [ prop : auto ] could be obtained by projecting the chomsky - schtzenberger results from the non - commutative setting to the commutative setting , an analogous result for pushdown automata can not be obtained in a similar way .",
    "theorem [ thm : auto ] may be interpreted as a commutative inverse to the chomsky - schtzenberger result for regular languages , where additional positivity restrictions are imposed .",
    "a distinctive feature of the computation models discussed in this paper is that they have an unbounded input , unlike the classical turing machine for which the input is of bounded length .    in @xcite ( see @xcite for background ) , a computational model in analysis is introduced .",
    "this model has some common features with the model introduced here  in particular , the input is given as an unbounded sequence .",
    "however , the models are different as our model has an input drawn according to an i.i.d . distribution . moreover , in our model we are looking for a coin which has _ exactly _ the correct distribution @xmath4 , while in @xcite the aim is find a turing machine which for an ( unbounded ) input @xmath27 , and an error bound @xmath243 computes an approximation of the function @xmath311 within error margin @xmath243 .",
    "there are , however , some striking similarities between the two models . for instance the continuity results of @xcite should be compared with @xcite where it is shown that computable functions are continuous .",
    "moreover it is easy to adapt the proofs of @xcite in order to show that if @xmath17 is computable and polynomially bounded from @xmath30 and @xmath32 at @xmath30 and @xmath32 , then it possible to simulate the function @xmath4 via a turing machine .",
    "the theory of exact sampling ( see e.g. @xcite ) deals with simulating a complicated probability measure using a simple one .",
    "usually , the simple measure consists of a sequence of unbiased bits or a a sequence of uniform variables .    in this paper both probability measures of interest ( the @xmath2 coin and the @xmath4 coin ) are simple .",
    "the difficulty here is that @xmath2 is unknown .",
    "it is easy to estimate @xmath2 , and therefore @xmath4 .",
    "however , to get a coin with an exact bias @xmath4 is harder .",
    "yet , the problem studied here may be interpreted as a problem in exact sampling .",
    "consider the following examples .    *",
    "suppose that some physical process produces percolation configuration on a grid @xmath312 , where the probability of an open edge is @xmath2 .",
    "we are interested in performing percolation on a grid @xmath313 , where we want that the probability that an edge @xmath174 is open in @xmath313 to be equal to the probability that two vertices at distance @xmath86 in @xmath312 are connected by a path of length @xmath86 .",
    "our results allow to use samples of the configuration @xmath312 in order to produce samples for the process on @xmath313 .",
    "* let @xmath314 be i.i.d .",
    "bits with unknown mean @xmath236",
    ". suppose that we are given the products @xmath315 , where @xmath316 , and we want to simulate ( one or more ) i.i.d .",
    "bits @xmath317 with mean @xmath236 .",
    "this can be done using the pushdown automaton in subsection [ subsec : pushex ] that simulates the function @xmath318 .",
    "let @xmath17 be a rational function .",
    "what is the smallest size of an automaton that simulates @xmath4 ? is there an efficient algorithm for finding this automaton ?",
    "this problem is potentially hard , as the size of the automaton probably depends on analytic and number theoretic properties of @xmath3 ( see @xcite ) .",
    "let @xmath17 be an algebraic function .",
    "can @xmath3 be simulated by a pushdown automaton ?",
    "* acknowledgment : * we thank jim propp for suggesting the problem .",
    "we are grateful to omer angel , paul beame and larry ruzzo for helpful remarks , and to russ lyons and sergey fomin for references .",
    "most of this work was done while the first author was a postdoctoral researcher at microsoft research , and the second author was visiting there .    5 d. j. aldous ( 1990 ) .",
    "a random walk construction of uniform spanning trees and uniform labeled trees .",
    "_ siam journal on discrete mathematics _ , * 3(4 ) * , 450465 .",
    "a. broder ( 1989 ) . generating random spanning trees . in _",
    "30th annual symposium on foundations of computer science _ , 442447 .",
    "d. cox , j. little and d. oshea , donal ( 1997 ) .",
    "_ ideals , varieties , and algorithms . an introduction to computational algebraic geometry and commutative algebra . _",
    "second edition .",
    "undergraduate texts in mathematics .",
    "springer - verlag , new york , 1997 .",
    "n. chomsky and m. p. schtzenberger ( 1963 ) .",
    "the algebraic theory of context - free languages . in _ computer programming and formal systems _ , 118161 , north - holland , amsterdam .",
    "p. elias ( 1972 ) . the efficient construction of unbiased random sequence , _ ann .",
    "* 43 * , 865870 .    j. e. hopcroft and j. d. ullman ( 1979 ) .",
    "_ introduction to automata theory , languages , and computation .",
    "_ addison - wesley series in computer science .",
    "addison - wesley publishing co. , reading , mass .",
    "a. grzegorczyk ( 1955 ) .",
    "computable functionals .",
    "_ * 42 * , 168202",
    "glynn and s. henderson . nonexistence of a class of variate generation schemes .",
    "_ operations research letters _ , to appear .",
    "hardy , j.e .",
    "littlewood , and g. plya ( 1959 ) .",
    "_ inequalities _ , cambridge university press , cambridge .",
    "m. s. keane , g. l. obrien ( 1994 ) . a bernoulli factory , _ acm transactions on modeling and computer simulation _ * 4 * , issue 2 .",
    "g. plya ( 1928 ) ber positive darstellung von polynomen vierteljschr , _ naturforsch .",
    "zurich _ * 73 * , 141145 . in _ collected papers _ * 2 * ( 1974 ) mit press , 309313 .",
    "y. peres ( 1992 ) . iterating von neumann s procedure for extracting random bits , _ ann",
    "_ , * 20 * , 590597 .",
    "m. b. pour - el and j. i. richards ( 1988 ) .",
    "_ computability in analysis and physics , _ springer - verlag .    v. powers and b. reznick ( 2002 ) . a new bound for polya s theorem with applications to polynomials positive on polyhedra , to appear in _",
    "mega 2000 proceedings , j. pure applied algebra_.    j. g. propp and d. b. wilson ( 1996 ) .",
    "exact sampling with coupled markov chains and applications to statistical mechanics . _ random structures and algorithms _ , * 9(1,2 ) * , 223252 .",
    "j. g. propp and d. b. wilson ( 1998 ) .",
    "how to get a perfectly random sample from a generic markov chain and generate a random spanning tree of a directed graph . _ journal of algorithms _ * 27 * , 170217 .",
    "a. turing ( 1936 ) .",
    "on computable numbers , with an application to the entscheidungsproblem .",
    "london math .",
    "_ , ser .  2 * 42 * , 230265 .",
    "j. von neumann ( 1951 ) .",
    "various techniques used in connection with random digits .",
    "_ applied math series _ * 12 * , 3638 .",
    "christopher j. hillar + chillar@math.berkeley.edu +      [ thm1 ] let @xmath319 $ ] , and let @xmath57 be the set in @xmath320 defined by @xmath321 suppose that for each @xmath1 , there exist a unique @xmath322 such that @xmath323 ; equivalently , @xmath57 is given as the image of some function @xmath324^{n+1}$ ] with @xmath325 .",
    "then , there exist nonzero polynomials @xmath326 $ ] such that @xmath327 for all @xmath1 .",
    "a subset @xmath329 as above is called the set of _ positive _ elements , and we say that @xmath329 is an _ ordering _ of @xmath328 .",
    "a field @xmath328 is then an _ ordered _ field if there exists an ordering of @xmath328 . a _ real field _ is a field in which @xmath335 is not a sum of squares , and a _ real closed field _",
    "@xmath336 is a real field such that such that any algebraic extension of @xmath336 that is real must be equal to @xmath336 .",
    "for example , both @xmath337 and @xmath338 are real closed fields ( where @xmath339 is the algebraic closure of @xmath340 ) .",
    "for ease of notation below , we set @xmath341 . from the definition ,",
    "it is clear that any real field must have characteristic 0 , and thus @xmath340 naturally embeds in any real field .",
    "it also follows that @xmath342 is a subset of every real closed field .",
    "any real closed field @xmath336 has a unique ordering , and the positive elements are the squares of @xmath336 .",
    "moreover , every polynomial of odd degree in @xmath343 $ ] has a root in @xmath336 @xcite . in light of these observations ,",
    "the axioms for the theory of real closed fields ( rcf ) consist of @xcite :      the set @xmath57 as in theorem [ thm1 ] is an example of a set definable by a boolean combination of a finite number of polynomial inequalities and equalities ( over @xmath340 ) .",
    "such a set is called _ semialgebraic _ ( over @xmath340 ) , and a function is called _ semialgebraic _ if its graph is a semialgebraic set .",
    "we may now state the main theorem .",
    "[ moregenthm ] let @xmath336 be a real closed field , and let @xmath347 be a semialgebraic subset of @xmath336 defined using polynomials @xmath348 $ ] .",
    "also , let @xmath57 be a semialgebraic subset of @xmath349 defined by @xmath319 $ ] .",
    "suppose that for each @xmath350 , there exist a unique point @xmath351 such that @xmath352 ; equivalently , @xmath57 is given as the image of some function @xmath353 with @xmath354 .",
    "then , there exist nonzero polynomials @xmath326 $ ] such that @xmath327 for all @xmath350 .    a fundamental fact",
    "about rcf is that it is a _",
    "complete theory _",
    "@xcite in the sense that each first order sentence expressible in the theory of rcf is either true in every structure satisfying the rcf axioms or false in every such structure .",
    "for example , the sentence , @xmath355 , evaluates to false for any structure ( such as @xmath337 ) satisfying the axioms of rcf . as a standard application of completeness , we present the following      to simplify notation",
    ", we write `` @xmath350 '' , for example , in place of the boolean combination of polynomial inequalities and equalities that defines @xmath347 . as @xmath340 embeds in any real closed field , the sentence",
    ", @xmath359 is a valid sentence in any structure satisfying the axioms of rcf . by completeness",
    ", it must have the same truth value in every real closed field .",
    "since it is a true statement in @xmath336 by assumption , it follows that it is also true in the real closed field @xmath342 .",
    "let @xmath360 .",
    "then , there exists a tuple , @xmath361 , such that @xmath352 . by the hypothesis",
    ", this @xmath362 must be the unique tuple in @xmath363 for this @xmath2 , and hence for all @xmath364 , @xmath365 , completing the proof .",
    "@xmath126              [ algthm ]",
    "let @xmath336 be a real closed field .",
    "if @xmath368 is a semialgebraic subset of @xmath363 and @xmath371 is semialgebraic , then there is a nonzero polynomial @xmath372 $ ] such that @xmath373 for all @xmath374 .",
    "we remark that applying theorem [ algthm ] with corollary [ cor1 ] already gives a result similar to theorem [ moregenthm ] .",
    "the only subtlety is that we would like the polynomial @xmath108 to be in @xmath375 $ ] instead of @xmath376 $ ] .",
    "we are now ready prove theorem [ moregenthm ] .",
    "[ proof of theorem [ moregenthm ] ] fix @xmath377",
    ". we will apply theorem [ algthm ] with @xmath378 and @xmath379 . from lemma [ lem1 ]",
    ", it follows that @xmath380 , and from corollary [ cor1 ] , we have that @xmath366 is semialgebraic .",
    "therefore , from theorem [ algthm ] , there is a nonzero polynomial @xmath381 $ ] such that @xmath382 for all @xmath356 .",
    "we will now produce a nonzero polynomial @xmath383 $ ] with the same property .",
    "consider the field , @xmath384 , of rational functions in the variable @xmath385 .",
    "view @xmath386 as a polynomial in the variable @xmath387 over @xmath384 , and , upon clearing denominators , let @xmath388 $ ] ( @xmath389 ) be the irreducible factors of @xmath386 ( over @xmath384 ) .",
    "it is clear that for all @xmath356 , we have @xmath390 fix @xmath47 and let @xmath391 be all of the coefficients in @xmath392 .",
    "extend @xmath393 by these coefficients , so that @xmath394 is a finite extension of @xmath393 .",
    "also , let @xmath395 be a finite extension of @xmath394 defined by the equation @xmath396 .",
    "it follows that @xmath28 is algebraic over @xmath397 , and upon clearing denominators , let @xmath398 $ ] be such that @xmath399 .",
    "since both @xmath392 and @xmath400 have @xmath28 as a root and since @xmath392 is irreducible , it follows that @xmath392 divides @xmath400 . as both @xmath400 and @xmath392 are in @xmath401 $ ] , gauss s lemma @xcite gives us that , @xmath402.\\ ] ] let @xmath403.\\ ] ] we claim that @xmath404 is our desired polynomial .",
    "but indeed , for all @xmath405 , @xmath406    finally , let @xmath347 and @xmath336 be as in the statement of theorem [ moregenthm ] , and let @xmath407 be the graph of @xmath408 , which is a semialgebraic set ( over @xmath340 ) . consider the sentence , @xmath409 which is valid in any structure satisfying the axioms of rcf ( again , since @xmath340 embeds in any real closed field ) . by the above argument , it is a true statement for @xmath342 , and therefore , by completeness , it is also true for @xmath336 .",
    "this completes the proof ."
  ],
  "abstract_text": [
    "<S> suppose that we are given a function @xmath0 and , for some unknown @xmath1 , a sequence of independent tosses of a @xmath2-coin ( i.e. , a coin with probability @xmath2 of `` heads '' ) . for which functions @xmath3 is it possible to simulate an @xmath4-coin ? @xmath5 this question was raised by s. asmussen and j. propp . </S>",
    "<S> a simple simulation scheme for the constant function @xmath6 was described by von neumann ( 1951 ) ; this scheme can be easily implemented using a finite automaton . </S>",
    "<S> we prove that in general , an @xmath4-coin can be simulated by a finite automaton for all @xmath1 , if and only if @xmath3 is a rational function over @xmath7 . </S>",
    "<S> we also show that if an @xmath4-coin can be simulated by a pushdown automaton , then @xmath3 is an algebraic function over @xmath7 ; however , pushdown automata can simulate @xmath4-coins for certain non - rational functions such as @xmath8 . </S>",
    "<S> these results complement the work of keane and obrien ( 1994 ) , who determined the functions @xmath3 for which an @xmath4-coin can be simulated when there are no computational restrictions on the simulation scheme . </S>"
  ]
}