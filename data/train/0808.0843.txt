{
  "article_text": [
    "understanding chemical enrichment and the dispersal of heavy elements in the wake of energetic supernovae ( sne ) has become essential to a number of fields in astrophysics .",
    "the details of how enriched material mixes with ambient gas are not only relevant for the cooling and fragmentation properties of the interstellar medium ( ism ) , but also manifest themselves in the composition and dynamics of the resulting stars . as massive stars return metals to the ism , mixing plays a key role in the overall matter cycle in galaxies . tracing this loop back in time",
    ", one encounters the initial enrichment of the pristine , pure h / he gas at the end of the cosmic dark ages , when the very first stars , termed population iii ( or pop  iii ) , ended their lives in violent sn explosions and expelled a significant fraction of their mass in metals @xcite .",
    "the resulting mixing in the early universe has two aspects .",
    "the first concerns the enrichment inside the first galaxies , when the metals ejected by pop  iii stars recollapsed into more massive haloes that cooled by atomic hydrogen lines and vigorously mixed with pristine material in the presence of a highly turbulent medium @xcite .",
    "the second relates to the enrichment of the intergalactic medium ( igm ) at redshifts @xmath0 @xcite .",
    "the resulting metallicity distribution is a crucial ingredient in modeling the reionization history of the universe @xcite and in determining when cosmic star formation shifted from a predominantly high - mass , pop  iii mode , to a more normal pop  ii mode @xcite .",
    "unfortunately , an accurate treatment of mixing , while simultaneously simulating the larger - scale environment , is presently not feasible , as the turbulent motions responsible for mixing typically cascade down to very small scales .",
    "a frequently encountered approach to this problem is to assume that the products of stellar nucleosynthesis are distributed within a fixed volume ( e.g. * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "significantly better results can be achieved in grid - based simulations by relating the mass flux between cells to the mixing efficiency , even though it remains unclear how much of this mixing is numerical instead of physical ( e.g. * ? ? ?",
    "such a direct approach is difficult to implement in sph simulations , due to their lagrangian nature , and instead chemical mixing has been modelled as a diffusion process ( e.g. * ? ? ?",
    "this is somewhat more accurate since the rms displacement of a fluid element in a homogeneously and isotropically driven turbulent velocity field can be described by the diffusion equation , with the diffusion coefficient set by the velocity dispersion and the typical shock travel distance @xcite .",
    "prescriptions with a constant diffusion coefficient have been applied to models of the chemical evolution of the milky way @xcite , galaxies in a cosmological context @xcite , and the environment of the first galaxies @xcite . in the present paper",
    ", we introduce an improved method that resolves chemical mixing in space and time based on the velocity dispersion within the sph smoothing kernel .",
    "this yields results in agreement with more detailed investigations of mixing in the early phases of sn remnants , without having to explicitly resolve the hydrodynamic instabilities in the post - shock gas . in future work",
    ", we plan to use our method to investigate the long - term evolution of energetic sne in a cosmological environment , particularly at high redshift when the universe was enriched with the first metals .",
    "however , since our algorithm is quite generic , we hope that it will prove a valuable tool for any sph simulation that attempts to follow the mixing of pollutants .",
    "the structure of our work is as follows . in section  2 ,",
    "we describe our model for diffusion and its numerical implementation in the cosmological simulation code gadget-2 @xcite , followed by a series of idealized test simulations ( section  3 ) .",
    "we then discuss the relation between the diffusion coefficient and the velocity dispersion and apply our prescription to the evolution of an idealized sn remnant ( section  4 ) .",
    "finally , in section  5 we summarize our results and assess their implications . for consistency , all quoted distances are physical , unless noted otherwise .",
    "diffusion plays an important role in a variety of astrophysical contexts . among them",
    "are thermal conduction ( e.g. * ? ? ?",
    "* ) , heat transfer in shear flows ( e.g. * ? ? ?",
    "* ) , the microscopic diffusion of particles , such as photons in stellar interiors , or the spatial correlation of individual fluid elements in a turbulent medium @xcite .",
    "these processes are all described by the diffusion equation , commonly written in the form : @xmath1 where @xmath2 is the concentration of a contaminant fluid per unit mass , @xmath3 is the diffusion coefficient , which can be a function of space and time , and @xmath4 the lagrangian derivative , or the derivative following the motion .",
    "the diffusion coefficient has dimensions @xmath5 , suggesting that it can be represented as the product of the local density and some typical length - scale and velocity , such as the particle mean free path and velocity dispersion in a microscopic picture of diffusion .      in the sph formalism",
    ", the diffusion equation can be reduced to a discrete summation over all particles within the smoothing kernel : @xmath6 with @xmath7 where @xmath8 and @xmath9 denote the particle indices , @xmath10 the mass , @xmath11 the density , @xmath12 the kernel and @xmath13 , @xmath14 the vector and absolute separations between particles @xmath8 and @xmath9 , respectively ( for a more detailed derivation , see * ? ? ?",
    "in the above equation , the arithmetic mean of the diffusion coefficient has been replaced by the harmonic mean , which has proven to be more robust .",
    "furthermore , the second derivative has been replaced by a term involving the gradient and the particle separation , since a direct computation of the second derivative is problematic @xcite .    the solution to equation  ( 2 )",
    "can either be determined explicitly , which requires an additional constraint on the time - step to ensure numerical stability , or implicitly , which requires the solution of a coupled set of differential equations involving all ` active ' particles ( i.e. all sph particles that are being updated on the current time - step ) .",
    "the explicit approach is extremely difficult to implement in a conservative fashion in an sph code that allows individual particles to have different time - steps ( e.g. gadget-2 ) .",
    "this is because in a code of this type , neighbouring particles will sometimes have different time - steps . consequently , the increase in concentration at particle @xmath8 caused by diffusion from particle @xmath9 will sometimes be computed at a different time from the corresponding decrease in concentration at particle @xmath9 caused by diffusion to particle @xmath8 . to ensure conservation ,",
    "the increase and decrease must exactly balance , but in general they will not if @xmath8 and @xmath9 have different time - steps .",
    "one could , of course , avoid this problem by ensuring that all particles are synchronized before their concentrations are updated .",
    "however , the required synchronizations would have to occur very frequently , and so one would lose essentially all of the benefits gained by allowing the particles to have individual time - steps . a further undesirable feature of the explicit approach",
    "is the fact that the time - steps required to stably model the diffusion can become very small .",
    "consideration of equation  ( 1 ) shows that the required time - step scales with the spatial resolution  represented in an sph code by the smoothing length @xmath15  as @xmath16 in comparison , the standard courant time - step scales only linearly with @xmath15 .",
    "an implicit approach to the solution of equation  ( 2 ) avoids some of these problems , as it allows one to take larger time - steps without compromising numerical stability .",
    "however , this comes at a cost : the coupled differential equations representing the diffusion must be solved iteratively , and it is difficult to do this in a fashion that can be efficiently parallelized . in addition , one still has to deal with the synchronization problem discussed above .    in view of the disadvantages of both standard approaches ,",
    "it is interesting to explore the viability of simpler , but more approximate approaches , such as the one presented in this paper . to obtain our approximation",
    ", we assume that the densities and concentrations of all active particles do not change significantly over a time interval @xmath17 , allowing a direct integration of equation  ( 2 ) : @xmath18 with @xmath19 and @xmath20 for large time - steps , the concentration of particle @xmath8 thus tends to the average among its neighbours , while for small time - steps it remains close to its original concentration .",
    "we implement this approach by performing the required operations at a global synchronization point in the density routine of gadget-2 . after the new densities and smoothing lengths have been computed , we update the coefficients @xmath21 and subsequently use equation  ( 5 ) to determine the new concentrations of all active sph particles . in a final step ,",
    "we renormalize the obtained concentrations with a global factor such that the total concentration is conserved . since the courant condition does not allow for significant changes in density between time - steps , and diffusion generally progresses slower than the speed of sound , our implementation is quite generic and can be applied to a number of problems in astrophysics .",
    "we have found that the algorithm is remarkably stable even for very short diffusion timescales , since particles tend to equilibrate their concentrations and neighbouring particles are generally active at the same time .",
    "the additional cpu consumption is minimal since we utilize the pre - existing neighbour search . by the same token ,",
    "the algorithm is easy to implement in any sph code and is not restricted to gadget-2 .      in this section",
    "we investigate the formal accuracy of the algorithm by performing a number of idealized test simulations .",
    "we initialize all simulations in a periodic , uniform density box with @xmath22 million sph particles and length and sound - crossing time set to unity , such that we may conveniently quote the elapsed time in units of the sound - crossing time .",
    "we adopt a hydrogen number density of @xmath23 and a mean molecular weight corresponding to that of a neutral , primordial gas .",
    "we place the particles on a grid with a very small random displacement , and in the first test problem also consider a fully random distribution of particles , such that the density fluctuates considerably around the mean .",
    "this gives a better handle on the performance of our algorithm under more realistic circumstances . in all cases",
    ", we use the maximum diffusivity that is accurately modelled by our algorithm , determined by the courant condition ( see sections 2.1 and 3.1 ) : @xmath24 where @xmath25 is the sound speed and @xmath11 and @xmath15 are determined by the mean density @xmath23 , such that the diffusion coefficient becomes a fixed numerical value .    in the first test problem , we consider the propagation of an initial @xmath26-distribution , to which the analytic solution is green s function of the diffusion equation : @xmath27 with variance @xmath28 this configuration is reproduced by setting the concentration of the central particle to unity , and of all others to zero . in the left - hand column of fig .  1 , we compare the analytic solution to the simulation results at three different output times . early on , diffusion progresses somewhat too rapidly , since the concentrations of neighbouring particles differ substantially . in this case ,",
    "equation  ( 5 ) effectively breaks down , but the resulting deviations remain small and do not influence the long - term behavior , where all three curves become nearly indistinguishable .",
    "note that the random distribution performs almost as well as the grid - based distribution , showing that the diffusivity remains unchanged even for high density fluctuations .",
    "the second test problem consists of two individual @xmath26-distributions initially separated by @xmath29 .",
    "the analytic solution can be obtained by a convolution of green s function with the initial state of the system : @xmath30 such that the general solution is given by the superposition of two gaussian distributions centred at @xmath31 and @xmath32 .",
    "similarly , the solution to the third test problem , consisting of a slab of uniform concentration between @xmath31 and @xmath32 , is given by : @xmath33 for @xmath34 and @xmath35 for @xmath36 . in the middle and right - hand columns of fig .  1",
    ", we compare the simulation results to the analytic solution , showing that there are only minor deviations at early times , similar in nature to those found in the first test problem .",
    "a slice through all three boxes ( fig .",
    "2 ) shows the solution in two dimensions .",
    "finally , in a series of resolution studies performed with @xmath37 , @xmath38 and @xmath39 particles , we have found no correlation between the resolution and the deviation from the analytic solution .",
    "in fact , in all cases , the deviations were comparable to those found in previous test problems .",
    "considering its formal simplicity , the algorithm thus performs remarkably well .",
    "although the diffusivity is initially slightly over - predicted for cases in which the diffusion time is shorter than the sound - crossing time , we nevertheless find a correct long - term behavior .",
    "in the previous section , we introduced an sph formalism for diffusion that can be applied to most problems that are governed by a diffusion equation . in this section ,",
    "we focus on an application that is particularly relevant to astrophysics : the mixing of chemical elements .      as a first step towards a model for chemical mixing",
    ", one must find a connection between the diffusivity of a pollutant and the local physical conditions .",
    "@xcite have provided this link by showing that the probability of finding a parcel of gas at a given location in a homogeneously and isotropically driven turbulent velocity field can be described by the diffusion equation , with the diffusion coefficient set by the velocity dispersion @xmath40 and the turbulent driving length @xmath41 : @xmath42 this corresponds to the classical mixing - length approach extended into the supersonic regime .",
    "if one replaces the probability distribution with the concentration of a pollutant , this formalism can be reinterpreted to describe chemical mixing .",
    "the sole remaining task is then to provide the parameters @xmath40 and @xmath41 to the diffusion algorithm , such that the diffusion coefficient can become a function of space and time .    to obtain the necessary parameters , we determine the rms velocity dispersion for particle @xmath8 within its smoothing length : @xmath43 where @xmath44 is the number of neighbours and @xmath45 and @xmath46 are the bulk velocities of particles @xmath8 and @xmath9 .",
    "finally , we equate the turbulent driving length with the smoothing length , since this is the minimum scale where turbulent motions can be resolved .",
    "this then yields for the diffusion coefficient : @xmath47 as desired , the efficiency of chemical mixing is now governed entirely by local physical quantities .",
    "an important underlying assumption of this method is that the velocity field on subresolution scales corresponds to a homogeneously and isotropically driven turbulent medium , i.e. only the magnitude of the velocity dispersion and not its three - dimensional structure is taken into account .",
    "a further implicit assumption is that the mixing efficiency on subresolution scales is set by the corresponding value on the scale of the smoothing kernel . for these reasons",
    "our method yields an upper limit to the amount of mixing that can occur , and does not capture the details of a real turbulent cascade .",
    "however , since turbulent motions on scales larger than the smoothing length are explicitly resolved , our approach should suffice for most practical purposes .",
    "we implement the above steps in our algorithm by performing a previous neighbour search that finds the velocity dispersion for all active sph particles , which is then used in equation  ( 3 ) to obtain the coefficients @xmath21 .",
    "this closes the required set of equations , and in the following subsection we use our complete model to investigate the mixing of metals in a sn remnant .",
    "the mixing of gas in the post - shock regions of sn remnants has previously been investigated , leading to the consensus view that secondary shocks trigger rayleigh - taylor and kelvin - helmholtz instabilities that mix pristine gas from the dense shell with already enriched material ( e.g. * ? ? ?",
    "* ; * ? ? ?",
    "the aim of our algorithm is to capture this mixing without having to explicity resolve the corresponding hydrodynamic instabilities , which can not easily be modelled using sph ( e.g. * ? ? ?",
    "* ; * ? ? ?",
    "* ) . to verify its ability to do this , we perform a test simulation of an idealized sn explosion with the same setup as in section  2.2 .",
    "we distribute an explosion energy of @xmath48 as thermal energy to the @xmath44 nearest neighbours around the centre of the box , which results in the formation of a shock and reproduces the ideal sedov - taylor solution of a blast wave in a uniform medium ( see * ? ? ?",
    "furthermore , we set the initial metallicities of the central particles to unity .    in fig .  3 , we show the radial velocity , diffusion coefficient and metallicity as a function of distance from the sn progenitor at three different output times .",
    "the high velocity dispersion near the forward shock is responsible for the elevated diffusion coefficient , which leads to efficient chemical mixing of pristine gas passing through the shock . as is evident from fig .  3",
    ", most parcels of gas behind the shock have nearly equilibrated their metallicities .",
    "our algorithm thus implicitly accounts for mixing due to the dependence of the diffusion coefficient on the local velocity dispersion .",
    "intriguingly , we also find metals ahead of the forward shock .",
    "although this initially seems unphysical , it should be remembered that our algorithm aims to capture mixing caused by unresolved instabilities , and that in a real sn remnant , it is these instabilities that would transport metals ahead of the mean position of the shock .",
    "even further out , the degree of enrichment drops roughly exponentially , since the velocity dispersion , and hence the diffusion coefficient , tend to zero .",
    "a second mechanism becomes important once the sn remnant has stalled : gas from the dense shell ahead of the shock falls back on to the remnant , becomes rayleigh - taylor unstable , and vigorously mixes with the interior gas .",
    "this is especially effective in a realistic cosmological setting , where the central potential well deepens as the sn remnant expands @xcite .",
    "however , we postpone a detailed treatment of this issue to dedicated high - resolution simulations in future work .",
    "we have introduced a simple and efficient algorithm for diffusion in sph simulations and investigated its accuracy with a number of idealized test cases .",
    "although the algorithm is quite generic and can be applied to most problems involving diffusion , we have here focused on a model for the dispersal of enriched material in supernova explosions . adopting the mixing length approach discussed by @xcite",
    ", we link the diffusivity of the pollutant to the local physical conditions and can thus describe the space- and time - dependent mixing process .",
    "we have applied our prescription to an idealized sn explosion and found that we can properly describe the mixing process without having to explicitly resolve the hydrodynamic instabilities in the post - shock gas . instead , this process is implicitly governed by the dependence on the local velocity dispersion .",
    "our method can thus be used in any sph simulation that attempts to follow the mixing of a pollutant but lacks the necessary resolution on small scales .",
    "this will be relevant , in particular , for simulations that aim at simultaneously representing the large - scale environment of the sn explosion and the fine - grained mixing .",
    "a crucial assumption of our model is that resolved motions cascade down to subresolution scales which then homogeneously mix the gas .",
    "for this reason our method yields an upper limit to the mixing efficiency and the resulting degree of homogeneity , and can not capture the details of a real turbulent cascade .",
    "however , since turbulent motions on scales larger than the smoothing length are explicitly resolved , this approximation should generally be valid .    our new algorithm ties in well with the current generation of radiation - hydrodynamical simulations of star formation , both at high redshifts and in the local universe .",
    "the ultimate goal is to describe the interrelated cycle of gas fragmentation and stellar feedback . to achieve adequate realism , radiative effects have to be considered together with the mechanical and chemical feedback due to sn explosions .",
    "the methodology developed here allows us to include chemical feedback , suitable even for extremely large simulations .",
    "we will report on specific applications in future studies .",
    "the authors would like to thank the referee joe monaghan for his insightful comments and suggestions that greatly improved the quality of this work .",
    "tg is grateful to paul clark for many stimulating discussions on sph .",
    "tg acknowledges financial support by the heidelberg graduate school of fundamental physics ( hgsfp ) .",
    "the hgsfp is funded by the excellence initiative of the german government ( grant number gsc 129/1 ) .",
    "vb acknowledges support from nsf grant ast-0708795 and nasa grant nnx08al43 g .",
    "rsk thanks for partial support from the emmy noether grant kl 1358/1 .",
    "rsk and tg also acknowledge subsidies from the dfg sfb 439 , galaxies in the early universe .",
    "the simulations presented here were carried out at the texas advanced computing center ( tacc ) ."
  ],
  "abstract_text": [
    "<S> we introduce a simple and efficient algorithm for diffusion in smoothed particle hydrodynamics ( sph ) simulations and apply it to the problem of chemical mixing . based on the concept of turbulent diffusion , we link the diffusivity of a pollutant to the local physical conditions and </S>",
    "<S> can thus resolve mixing in space and time . </S>",
    "<S> we apply our prescription to the evolution of an idealized supernova remnant and find that we can model the distribution of heavy elements without having to explicitly resolve hydrodynamic instabilities in the post - shock gas . instead , the dispersal of the pollutant is implicitly modelled through its dependence on the local velocity dispersion . </S>",
    "<S> our method can thus be used in any sph simulation that investigates chemical mixing but lacks the necessary resolution on small scales . </S>",
    "<S> potential applications include the enrichment of the interstellar medium in present - day galaxies , as well as the intergalactic medium at high redshifts .    </S>",
    "<S> -1 cm    diffusion  stars : formation  supernova remnants  galaxies : formation  early universe . </S>"
  ]
}