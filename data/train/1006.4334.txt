{
  "article_text": [
    "when a known or suspected source remains undetected at a prescribed statistical significance during an observation , it is customary to report the _ upper limit _ on its intensity .",
    "this limit is usually taken to mean the largest intrinsic intensity that a nominal source can have with an appreciable chance of going undetected . or equivalently , it is the smallest intrinsic intensity it could have before its detection probability falls below a certain threshold .",
    "we emphasize that the upper limit is not meant to be an estimate or even a bound on the intensity of the source , but rather it is a quantification of the power of the _ detection procedure _ to detect weak sources .",
    "thus , it is a measure that characterizes the detection process .",
    "the endpoints of the confidence interval , by contrast , provide ranges of possible values for the source intensity rather than quantify the sensitivity of the procedure . while the concept of upper limits has generally been well understood by astronomers as a form of censoring ( isobe , feigelson , & nelson 1986 ) with an intrinsic connection to the detectability of a source ( avni et al .",
    "1980 ) , there has not been a statistically meaningful description that encapsulates its reliance on detectability as well as statistical significance .",
    "moreover , while the term `` upper limit '' has been traditionally used in this manner , it has been also been used in cases where a formal detection process is not applied ( e.g. , when a source is known to exist at a given location because of a detection made in some other wavelength ) . in such cases ,",
    "the upper edge of the confidence interval is derived and noted as the upper limit , regardless of the detectability of that source . in order to prevent confusion",
    ", we shall henceforth refer to the upper edge of a confidence interval as the `` _ upper bound_. '' despite the intrinsic differences , numerous studies have described the computation of the _ upper bound _ as a proxy for the _ upper limit _ in increasingly sophisticated ways .",
    "the parameter confidence interval is a statistically well understood and is in common use .",
    "kraft et al.(1991 ) and marshall ( 1992 ) for example applied poisson bayesian - likelihood analysis to x - ray counts data to determine the credible range , and thus set an upper bound , on the source intensity .",
    "feldman & cousins ( 1998 ) recognized that the classical confidence interval at a given significance is not unique , and devised a scheme to determine intervals by comparing the likelihoods of obtaining the observed number of counts with the maximum likelihood estimate of the intensity and a nominal intensity ; this procedure produces unique intervals where the lower edge overlaps with zero when there are very few counts , and the upper edge stands as a proxy for an upper limit .",
    "variations in the background were incorporated via a sophisticated bayesian analysis by weisskopf et al .",
    "( 2007 ) .",
    "the similarity of nomenclature between upper limits and upper bounds has led to considerable confusion in the literature on the nature of upper limits , how to compute them , and what type of data to use to do so .",
    "many techniques have been used to determine upper limits .",
    "it is not feasible to list all of these , but for the sake of definiteness , we list a few methods culled from the literature : the techniques range from using the root - mean - square deviations in the background to set the upper limit ( gilman et al .  1986 , ayres 1999 , perez - torres , et al .",
    "2009 ) , adopting the source detection threshold as the upper limit ( damiani et al .  1997 ,",
    "erdeve et al .",
    "2009 , rudnick et al .",
    "2009 ) , computing the flux required to change a fit statistic value by a significant amount ( loewenstein et al .  2009 ) , computing the @xmath0-value for the significance of a putative detection in the presence of background ( pease et al .  2006 ,",
    "carrera et al .  2008 ) , and identifying the upper limit with the parameter confidence bound ( schlegel & petre 1993 , rolke et al . ,",
    "2005 , hughes et al .",
    "2007 ) . here",
    ", we seek to clarify these historically oft - used terms in a statistically rigorous way .",
    "our goal here is to illustrate the difference between upper _ limits _ and upper _ bounds _ , and to develop a self - consistent description for the former that can be used with all extant detection techniques .",
    "bounds and limits describe answers to different statistical questions , and usually both should be reported in detection problems .",
    "we seek to clarify their respective usage here .",
    "we set out the requisite definitions and statistical foundations in ",
    "[ s : back ] . in ",
    "[ s : ulim ] , we discuss the critical role played by the detection threshold in the definition of an upper limit and compare upper limits with upper bounds of confidence intervals . in  [ s : back ] and  [ s : ulim ] we use a simple poisson detection problem as a running example to illustrate our methods . in ",
    "[ s : snr ] , we apply them to a signal - to - noise detection problem .",
    "finally , we summarize in  [ s : summary ] .",
    "here we begin by describing our notation , and then discuss the nuances of the familiar concepts of confidence intervals , hypothesis testing , and statistical power .",
    "a glossary of the notation used is given in table  [ tab : glossary ] .",
    "ll @xmath1 & counts observed in source area + @xmath2 & counts observed in background area + @xmath3 & source intensity + @xmath4 & background intensity + @xmath5 & range in background intensity @xmath4 + @xmath6 & exposure time + @xmath7 & exposure time for the background + @xmath8 & ratio of background to source area + @xmath9 & statistic for hypothesis test + @xmath10 & detection threshold value of statistic @xmath9 + @xmath11 & detection threshold value of statistic @xmath12 + @xmath13 & upper limit + @xmath14 & the maximum probability of false detection + @xmath15 & the probability of a detection + @xmath16 & the minimum probability of detection of a source with @xmath17 + @xmath18 & probability of + @xmath19 & denoting that @xmath20 is sampled from the distribution @xmath21 + @xmath22 & poisson distribution with intensity @xmath23 + @xmath24 & gaussian ( i.e. , normal ) distribution with mean @xmath25 and variance @xmath26 +      our study is carried out in the context of background - contaminated detection of point sources in photon counting detectors , as in x - ray astronomical data .",
    "we set up the problem for the case of uncomplicated source detection ( i.e. , ignoring source confusion , intrinsic background variations , and instrumental effects such as vignetting , detector efficiency , psf structure , bad pixels , etc ) .",
    "however , the methodology we develop is sufficiently general to apply in complex situations .    there is an important , subtle , and often overlooked distinction between an upper limit and the upper bound of a confidence interval , and the primary goal of this article is to illuminate this difference .",
    "the confidence interval is the result of inference on the source intensity , while the upper limit is a measure of the power of the detection process .",
    "we can precisely state this difference in the context of an example .",
    "suppose that we have a typical case of a source detection problem , where counts are collected in a region containing a putative or possible source and are compared with counts from a source - free region that defines the background .",
    "if the source counts exceed the threshold for detection , the source is considered detected .",
    "this detection threshold is usually determined by limiting the probability of a false detection .",
    "if the threshold were lower , there would be more false detections . given this setup , we might ask how bright must a source be in order to ensure detection .",
    "although statistically there are no guarantees , the upper limit is the minimum brightness that ensures a certain _ probability of detection_. critically , this value can be computed before the source counts are observed .",
    "it is based on two probabilities , ( 1 ) the probability of a false detection which determines the detection threshold , and ( 2 ) the minimum probability that a bright source is detected .",
    "although the upper limit is primarily of interest when the observed counts are less than the detection threshold , it does not depend on the observed counts .",
    "this is in sharp contrast to a confidence interval for the source intensity , that is typically of the form _ `` source intensity estimate plus or minus an error bar , '' _ where the estimate and the error bars depend directly on the observed source counts in the putative source region . of course",
    ", the functional form of the confidence interval may be more complicated than in this example , especially in low count settings , but any reasonable confidence interval depends on the source counts , unlike upper limits .",
    "the fact that upper limits do not depend on the source counts while confidence intervals do should not be viewed as an advantage of one quantity or the other .",
    "rather it reflects their differing goals .",
    "upper limits quantify the power of the detection procedure and confidence intervals describe likely values of the source intensity .",
    "these distinctions are highlighted with illustrative examples in  [ sec : illustex ] .",
    "to formalize discussion , suppose that a known source has an intrinsic intensity in a given passband of @xmath3 and that the background intensity under the source is @xmath4 .",
    "further suppose that the source is observed for a duration @xmath6 and that @xmath1 counts are collected , and similarly , a separate measurement of the background could be made over a duration @xmath7 and @xmath2 counts are collected . if the background counts are collected in an area @xmath8 times the source area , could include differences in exposure duration and instrument effective area .",
    "furthermore , the nominal exposure duration could also incorporate effective area , e.g. , to have units [ photons  count@xmath27  @xmath28  s ] , which implies that the expected intensity @xmath3 will have units [ photons  s@xmath27  @xmath29 . regardless of the units of @xmath3 and @xmath4 ,",
    "the likelihood is determined by the poisson distribution on the expected and observed counts as in equation  [ eq : basicpoi ] .",
    "] we can relate the observed counts to the expected intensities , @xmath30 in the background and source regions respectively , where @xmath2 and @xmath1 are independent . for simplicity , we begin by assuming that @xmath4 is known .",
    "confidence intervals give a set of values for the source intensity that are consistent with the observed data .",
    "they are typically part of the inference problem for the source intensity .",
    "the basic strategy is to compute an interval of parameter values so that on repeated observations a certain proportion of the intervals contain the true value of the parameter .",
    "it is in this `` repeated - observation '' sense that a classical confidence interval has a given probability of containing the true parameter .",
    "bayesian credible intervals have a more direct probabilistic interpretation .",
    "they are computed by deriving the posterior probability distribution of the source intensity parameter given the observed counts and finding an interval with nominal probability of containing the true rate ( see e.g. , loredo 1992 , van dyk et al .",
    "2001 , kashyap et al .",
    "2008 ) . in summary ,",
    "confidence intervals are _ frequentist _ in nature meaning that they are interpreted in terms of repeated observations of the source .",
    "credible intervals , on the other hand , are _ bayesian _ in nature meaning that they represent an interval of a certain posterior ( or other bayesian ) probability .      from a frequentist point of view randomness stems only from data collection  it is the data , not the parameters that are random .",
    "often we use a 95% interval , but intervals may be at any _ level _ and we more generally refer to an @xmath31% confidence interval .",
    "thus , the proper interpretation of a given interval is    _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ @xmath31% of experiments ( i.e. , observations ) with intervals computed in this way will result in intervals that contains the true value of the source intensity .",
    "_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _    in frequentist terms , this means that in any given experiment one can not know whether the true source intensity is contained in the interval but if the experiment is repeated a large number of times , _ about @xmath31% of the resulting intervals will contain the true value_. strictly speaking , the more colloquial understanding that there is an @xmath31% chance that the `` source intensity is contained in the reported confidence interval , '' is incorrect .",
    "put another way , a confidence interval for the source intensity gives values of @xmath3 that are plausible given the observed counts .",
    "suppose that @xmath32 and that for each value of @xmath3 , we construct an interval @xmath33 of possible values of the source counts that has at least an @xmath31% chance : @xmath34 . once the source count is observed and assuming @xmath4 is known , a confidence interval can be constructed as the set of values of @xmath3 for which the observed count is contained in @xmath35 , @xmath36 in repeated observations , at least @xmath31% of intervals computed in this way cover the true value of @xmath3 .",
    "the frequency coverage of confidence intervals is illustrated in figure  [ fig : ci ] , where the confidence intervals of garwood ( 1936 ) for a poisson mean are plotted as boxes of width equal to the interval for various cases of observed counts ( see van dyk s discussion in mandelkern , 2002 ) .",
    "for given values of @xmath3 and @xmath4 the probability of the possible values of the observed counts can be computed using equation  [ eq : basicpoi ] ; for each of these possible values , there will be a different confidence interval .",
    "thus , the confidence intervals themselves have their own probabilities , which are represented as the heights of the boxes in figure  [ fig : ci ] . because these are 95% confidence intervals , the cumulative heights of the boxes that contain the true value of @xmath3 in their horizontal range must be at least 0.95 .",
    "it is common practice to only report confidence intervals for detected sources so that only intervals corresponding to @xmath1 above some threshold are reported .",
    "unfortunately this upsets the probability that the interval contains @xmath3 upon repeated observations .",
    "standard confidence intervals are designed to contain the true value of the parameter ( say ) 95% of time , i.e. , in 95% of data sets .",
    "if some of the confidence intervals are taken away ( i.e. , are not reported because , e.g. , the counts are too small ) , there is no reason to expect that 95% of those remaining will contain the true value of the parameter .",
    "this is because instead of summing over all values of @xmath1 to get a probability that exceeds 95% , we are summing only over those values greater than the detection threshold .",
    "this results in a form of _ eddington bias _ and is discussed in detail in  [ s : eddington ] .          in a bayesian setting , probability is used to quantify uncertainty in knowledge and in this regard parameters are typically viewed as random quantities .",
    "this distinction leads to a more intuitive interpretation of the credible interval .",
    "a credible interval at the @xmath31% level , for example , is any interval that contains the true value of the parameter @xmath31% of the time according to its posterior distribution .",
    "( see park et al .",
    "2008 for discussion on interval selection . )",
    "thus , from a bayesian perspective , it is proper to say that there is an @xmath31% chance that the source intensity is contained in the reported credible interval .",
    "the corresponding credible intervals look similar to the confidence intervals in figure  [ fig : ci ] , at least in high count scenarios .",
    "so far we have considered a very simple problem with only one unknown parameter , @xmath3 .",
    "the situation is more complicated if there are unknown _ nuisance parameters _",
    ", such as @xmath4 .",
    "in this case , frequency based intervals typically are constructed using asymptotic arguments and/or by conditioning on ancillary statistics that yield a conditional sampling distribution that does not depend on the nuisance parameter . identifying ancillary statistics can be a subtle task and the resulting intervals may not be unique .",
    "bayesian intervals , can be constructed using a simple and clear principle known as _",
    "marginalization_. for example , if @xmath4 is unknown , the marginal posterior distribution of @xmath3 is simply @xmath37 credible intervals for @xmath3 are computed just as before , but using the marginal posterior distribution .",
    "we emphasize that neither confidence nor credible intervals directly quantify the detection sensitivity of an experiment .",
    "to do this we consider the detection problem in detail , which from a statistical point of view is a test of the hypothesis that there is no source emission in the given energy band we discuss how a hypothesis test can be inverted to construct a confidence interval .",
    "] , i.e. , a test of @xmath38 .",
    "formally , we test the _ null hypothesis _ that @xmath38 against the _ alternative hypothesis _ that @xmath39 . the test is conducted using a _ test statistic _ that we denote @xmath40 .",
    "an obvious choice for @xmath9 is the counts in the source region , @xmath1 ; larger values of @xmath1 are indicative of a detection of a source , since they become increasingly less likely to have been obtained as a random fluctuation from the background .",
    "other choices for @xmath9 are the signal - to - noise ratio ( as in the case of sliding - cell local - detect algorithms ; see  [ s : snr ] ) or the value of the correlation of a counts image with a basis function ( as in the case of wavelet - based algorithms ) or a suitably calibrated likelihood - ratio test statistic ( as in the case of @xmath41-ray detectors like _ fermi _ ; see mattox et al.1996 ) .",
    "the count in the source region is an example of a test statistic that is stochastically increasing ) that defines a distribution of observable values ( here @xmath1 ) , and that all of the quantiles of @xmath1 increase as @xmath3 increases .",
    "there is no guarantee that at any single instance of observation , a higher @xmath3 should lead to a higher @xmath1 . ] in @xmath3 . for any fixed @xmath10 , @xmath4 , @xmath6 , @xmath7 and @xmath8 , the probability that the test statistic @xmath9 is less than the threshold @xmath10 decreases as @xmath3 increases , i.e. , @xmath42 decreases as @xmath3 increases .",
    "we assume that @xmath9 is stochastically increasing in @xmath3 throughout .",
    "because larger values of @xmath9 indicate a source , we need to determine how large @xmath9 must be before we can declare a source detection .",
    "this is the done by limiting the probability of a false detection , also known as a type  i error .",
    "thus , the detection threshold @xmath10 is the smallest value such that @xmath43 where @xmath14 is the maximum allowed probability of a false detection in the simple poisson counts case , the probability of a type  i error given in equation  [ eq : alpha ] is computed as , @xmath44 where the summation is over the set of values of @xmath45 such that @xmath46 and we substitute @xmath38 into the mean of @xmath1 given in equation  [ eq : basicpoi ] .",
    "each term in the summation is a product of the likelihood of obtaining the specified counts in the absence of a source , given the background intensity and other observational parameters . in the simple case where @xmath9 is the counts in the source region , @xmath1 , and @xmath4",
    "is known ( i.e. , @xmath2 is not measured ) , this reduces to @xmath47 where @xmath48 is the incomplete gamma function ( see equations 8.350.1 and 8.352.1 of gradshteyn & ryzhik ( 1980 ) ) . in large count scenarios",
    "we may use continuous gaussian distributions with their variances equal to their means in place of the discrete poisson distributions in equation  [ eq : basicpoi ] , see equation  [ eq : snr - model ] in  [ s : snr ] . in this case",
    ", we compute @xmath49 \\over \\sqrt{2\\pi{\\tau_s}{\\lambda_b } } } \\cdot { \\exp\\left[-{({n_b}{^{\\prime}}-{r}{\\tau_b}{\\lambda_b})^2\\over { r}{\\tau_b}{\\lambda_b}}\\right ] \\over \\sqrt{2\\pi{r}{\\tau_b}{\\lambda_b } } } \\right\\ } d{n_s}{^{\\prime}}d{n_b}{^{\\prime}},\\ ] ] where the integral is over the region of values of @xmath45 such that @xmath46 . ] and we declare a detection if the observed value of @xmath9 is _ strictly greater than _ @xmath10 :    _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ if @xmath50 we conclude there is insufficient evidence to declare a source detection .",
    "if @xmath51 we conclude there is sufficient evidence to declare a source detection . _",
    "_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _    we call @xmath10 the _ @xmath14-level detection threshold _ and sometimes write @xmath52 to emphasize its dependance on @xmath14 ( see figure  [ fig : thresh ] ) . note that @xmath14 is a bound on the probability of a type  i error ; the actual probability of a type  i error is given by the probability on the left - hand side of equation  [ eq : alpha ] . due to the discrete nature of the poisson distribution , the bound is generally not achieved and the actual probability of a type - i error is less than @xmath14 .",
    "-level detection threshold @xmath10 as a function of the background intensity @xmath4 , for the given @xmath14 levels .",
    "note that this is calculated assuming that the source intensity @xmath38 .",
    "the detection threshold increases with increasing @xmath4 for a given @xmath14 , and increases with decreasing @xmath14 for a given @xmath4 .",
    ", title=\"fig:\",width=278 ]    although its role in the definition of the detection threshold indicates that it is viewed as the more important concern , a _ false detection _ , also known as a `` false positive , '' is not the only type of error .",
    "false negative _ , or type  ii error , occurs when a real source goes undetected ( see figure  [ fig : alfabetillus ] ) . the probability of a false negative is quantified through the _ power _ of the test to detect a source as a function of its intensity , @xmath53 equation  [ eq : beta ] gives the probability of a detection . for any @xmath39 , this is the power of the test or one minus the probability of a false negative .",
    "here we use @xmath15 to represent the power of the test , or one minus the probability of a type ii error .",
    "the statistical literature uses the notation @xmath15 to denote either the type ii error ( i.e. , accepting the null hypothesis when it is false ; e.g. , eadie et al.1971 ) or for the power of the test itself ( as we have done here ; e.g. , casella & berger 2002 ) . as in the case of calculating @xmath14 ( see footnote  [ ft : poialpha ] ) , we can calculate @xmath15 as @xmath54 where again the summation is over the set of values of @xmath45 such that @xmath55 . in the simple case where @xmath56",
    ", @xmath4 is known , and @xmath2 is not measured , we find @xmath57 ] for @xmath38 , equation  [ eq : beta ] gives the probability of a false detection ( cf .",
    "equation  [ eq : alpha ] ) and consequently , @xmath58 .",
    "this reflects the trade - off in any detection algorithm : the compromise between minimizing the number of false detections against maximizing the number of true detections .",
    "that is , if the detection threshold is set low enough to detect weaker sources , the algorithm will also produce a larger number of false positives that are actually background fluctuations .",
    "conversely , the more stringent the criterion for detection , the smaller the probability of detecting a real source ( this is illustrated by the location of the threshold @xmath10 that defines both @xmath14 and @xmath15 in figure  [ fig : alfabetillus ] ) . note that although our notation emphasizes the dependence of the power on @xmath3 , it also depends on @xmath4 , @xmath6 , @xmath7 , and @xmath8 .",
    "the power calculation is shown for the simple poisson case in figure  [ fig : power ] , where @xmath59 is plotted for different instances of @xmath4 and for different levels of the detection threshold @xmath10 . as expected ,",
    "stronger sources are invariably detected . for a given source intensity ,",
    "an increase in the background or a larger detection threshold ( i.e. , lower @xmath14 ) both cause the detection probability to decrease . in a typical observation ,",
    "the background and the detection threshold are already known , and thus it is possible to state precisely the intensity @xmath3 at which the source will be detected at a certain probability .",
    "we may set a certain minimum probability , @xmath16 of detecting a `` bright '' source by setting the exposure time long enough so that any source with intensity greater than a certain pre - specified cutoff has probability @xmath16 or more of being detected .",
    "conversely , we can determine how bright a source must be in order to have probability @xmath16 or more of being detected with a given exposure time .",
    "this allows us to define an upper limit on the source intensity by setting a minimum probability of detecting the source .",
    "this latter calculation is the topic of   [ s : def ] and the basis of our definition of an upper limit .",
    "power calculations are generally used to determine the minimum exposure time required to ensure a minimum probability of source detection ( see appendix  [ a : ul - pow ] ) . in  [ s : ulim ] we use them to construct upper limits .",
    "in this section , we develop a clear statistical definition of an upper limit that ( i ) is based on well - defined principles , ( ii ) depends only on the method of detection , ( iii ) does not depend on prior or outside knowledge about the source intensity , ( iv ) corresponds to precise probability statements , and ( v ) is internally self - consistent in that all values of the intensity below the upper limit are less likely to be detected at the specified type - i error rate and values above are more likely to be detected .      in astronomy upper limits",
    "are inextricably bound to source detection : by an upper limit , an astronomer means    _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ the maximum intensity that a source can have without having at least a probability of @xmath16 of being detected under an @xmath14-level detection threshold . _",
    "_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _    or conversely ,    _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ the smallest intensity that a source can have with at least a probability of @xmath16 of being detected under an @xmath14-level detection threshold .",
    "_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _    unlike a confidence interval , the upper limit depends directly on the detection process and in particular on the maximum probability of a false detection and the minimum power of the test , that is on @xmath14 and @xmath16 respectively . in this way",
    ", an upper limit incorporates both the probabilities of a type i and a type ii error .",
    "formally , we define the upper limit , @xmath60 to be the smallest @xmath3 such that @xmath61 commonly used values for @xmath16 throughout statistics are 0.8 and 0.9 .",
    "if @xmath62 , @xmath63 represents the intensity of a source that is unlikely to go undetected , and we can conclude that an undetected source is unlikely to have intensity greater than @xmath63 .",
    "the simplest example occurs in the hypothetical situation when @xmath4 is known to be zero and there is no background observation . in this case we set @xmath56 and note that @xmath64 so the detection threshold is zero counts and we declare a detection if there is even a single count .",
    "( recall , we declare a detection only if @xmath9 is strictly greater than @xmath10 . ) the upper limit in this case is the smallest value of @xmath3 with probability of detection greater than @xmath16 .",
    "figure  [ fig : noback ] plots @xmath65 as a function of @xmath66 , thus giving @xmath67 for any given @xmath6 and every value of @xmath16 .",
    "notice the upper limit decreases in inverse proportion to @xmath6 .     as a function of @xmath66 , thus giving @xmath68 for any given @xmath6 and every value of @xmath69 .",
    "for example , reading across the line plotted at @xmath70 , gives @xmath71 , which can be solved for the upper limit for any value of @xmath6 .",
    "notice the upper limit decreases in inverse proportion to @xmath6 .",
    ", width=278 ]    when @xmath4 is greater than zero but well - determined and can be considered to be known , the detection threshold using @xmath56 is given in equation  [ eq : alpha ] . with this threshold in hand",
    "we can determine the maximum intensity a source can have with significant probability of not producing a large enough fluctuation above the background for detection .",
    "this is the upper limit .    in particular",
    ", @xmath63 is the largest value of @xmath3 such that @xmath72 .",
    "this is illustrated for three different values of @xmath16 ( panels ) and three different values of @xmath14 ( line types ) in figure  [ fig : ulim ] .",
    "notice that the upper limit increases as @xmath16 increases and as @xmath14 decreases .          to illustrate the difference between confidence bounds and upper limits , in the context of a detection process",
    ", we consider two simple examples .",
    "the first is an extreme case where the background intensity is known to be identically zero , and even one count in the source region would be classified as a detection . in this case the upper limit is the smallest source intensity that can produce one count at a specified probability , e.g. , a source with intensity of 5 generates one or more counts at a probability of @xmath73% ( see  [ s : def ] ) . in contrast , if one count is seen in the source region , the upper bound of an equal - tail 99.7% interval on the source intensity is @xmath74 ( gehrels 1986 ) .",
    "thus , while similar in magnitude , it can be seen that upper bounds and upper limits are different quantities , describing different concepts .",
    "second , consider a more realistic case where the background is measured in a large region thought to be free of sources and scaled to the area covered by the source .",
    "suppose that 800 counts are observed in an area 400 times larger than the source area , and 3 counts are seen in the putative source region itself .",
    "the credible interval for the source intensity may be calculated at various significance levels (  [ s : ci ] ; see also van dyk et al .",
    "2001 ) , and for this case we find that the 68% credible interval with the lower bound at @xmath75 is @xmath76 $ ] , and the 99.7% interval is @xmath77 $ ] .",
    "but the question then arises as to whether the counts seen in the source region are consistent with a fluctuation of the observed background or not . since at a minimum 7 counts",
    "are needed for a detection at a probability of 0.997 ( corresponding to a gaussian - equivalent `` @xmath78 '' detection ) , it is considered that the source is not detected .",
    "the question then becomes how bright the source would have to be in order to be detected with a certain probability .",
    "since a source of intensity 5.7 would have a 50% probability of producing sufficient counts for a detection , this sets an _ upper limit _",
    "@xmath79 counts on the undetected source s intensity ( for a type i error @xmath80 and a type ii error @xmath81 ; see  [ s : def ] ) .",
    "note that this limit is the same regardless of how many counts are actually seen within the source region , as expected from a quantity that calibrates the detection process .",
    "in contrast , the inference on the source intensity is always dependent on the number of observed source counts .",
    "so far our definition of an upper limit assumes that there are no unknown nuisance parameters , and in particular that @xmath4 is known .",
    "unfortunately , the probabilities in equations  [ eq : alpha ] and [ eq : power ] can not be computed if @xmath4 is unknown . in this section",
    "we describe several strategies that can be used in the more realistic situation when @xmath4 is not known precisely .",
    "the most conservative procedure ensures that the detection probability of the upper limit is greater than @xmath16 for any possible value of @xmath4",
    ". generally speaking ,",
    "the larger @xmath4 is , the larger @xmath3 must be in order to be detected with a given probability , and thus the larger the upper limit .",
    "thus , a useful upper limit requires a finite range , @xmath5 , to be specified for @xmath4 .",
    "given this range , a _ conservative upper limit _ can be defined as the smallest @xmath3 that satisfies @xmath82 ( we use the term _ infimum _ ( @xmath83 ) rather than _ minimum _ to allow for the case when the minimum may be on the boundary of , but outside , the range of interest .",
    "it is the largest number that is smaller than all the numbers in the range .",
    "for instance , the minimum of the range @xmath84 is undefined , but the infimum is @xmath75 . ) unfortunately , unless the range of values @xmath5 is relatively precise , this upper limit will often be too large to be useful .    in practice",
    ", there is better solution .",
    "the background count provides information on the likely values of @xmath4 that should be used when computing the upper limit .",
    "in particular the distribution of @xmath4 given @xmath2 can be computed using standard bayesian procedures . in the bayesian case , the posterior distribution , @xmath85 , is the product of a prior distribution and the likelihood , normalized so that the posterior distribution integrates to 1 .",
    "there are many choices of prior distributions available for @xmath4 , ranging from uniform on @xmath4 , to @xmath41 , to uniform in @xmath86 ( see , e.g. , van dyk et al .",
    "2001 ) . ] and used to evaluate the _ expected detection probability _ , @xmath87 where @xmath52 is the smallest value such that @xmath88 the upper limit is then computed as the smallest @xmath3 that satisfies @xmath89 . unlike the upper limit described in  [ s : def ] , these calculations require data , in particular @xmath2 . for this reason ,",
    "we call the smallest @xmath3 that satisfies equation  [ eq : ulpost ] the _ background count conditional upper limit _ or _ bcc upper limit_. an intermediate approach that is more practical than using equation  [ eq : ulinf ] but more conservative than using equation  [ eq : ulpost ] is to simply compute a high percentile of @xmath90 , perhaps its 95th percentile . the procedure for known @xmath4 can then be used with this percentile treated as the known value of @xmath4 .",
    "this is a conservative strategy in that it assumes a nearly worst case scenario for the level of background contamination .    as an illustration ,",
    "suppose the uncertainty in @xmath4 given the observed background counts can be summarized in the posterior distribution plotted in the left panel of figure  [ fig : unknown ] .",
    "this is a gamma posterior distribution of the sort that typically arises when data are sampled from a poisson distribution . using this distribution",
    ", we can compute @xmath10 for any given value of @xmath14 as the smallest value that satisfies equation  [ eq : alpha2 ] ; the results are given for three values of @xmath14 in the legend of figure  [ fig : unknown ] .",
    "we then use equation  [ eq : ulpost ] to compute @xmath59 as plotted in the right panel of figure  [ fig : unknown ] .",
    "the upper limit can be computed for any @xmath16 using these curves just as in figure  [ fig : ulim ] .",
    "although the form of a confidence interval makes it tempting to use its upper bound in place of an upper limit , this is misleading and blurs the distinction between the power of the detection procedure and the confidence with which the flux is measured . as an illustration we have computed the upper limit for each of the nine panels in figure  [ fig : ci ] ( using the true values of @xmath4 reported in each panel ) .",
    "the results are plotted as solid vertical lines in figure  [ fig : ulimci ] .",
    "notice that unlike the upper bound of the confidence interval the upper limit does not depend on @xmath1 and takes on values that only depend on @xmath4 . using the upper bound of the confidence interval sometimes overestimates and sometimes underestimates the upper limit . in all but one of the nine cases with the highest @xmath91 ( i.e. , @xmath92 , @xmath93 ) the upper limit for @xmath3 is larger than @xmath3 . of the nine cases ,",
    "this is the one that is mostly likely to result is a source detection and is the only one with a probability of detection greater than @xmath94 .",
    "alternatively , we can compute the value of @xmath16 required for the upper bound of garwood s confidence interval to be interpreted as an upper limit .",
    "figure  [ fig : ub = ul ] does this for the three values of @xmath4 used in the three columns of figures  [ fig : ci ] and [ fig : ulimci ] .",
    "consider how the upper bound of garwood s confidence interval increases with @xmath1 in figure  [ fig : ulimci ] .",
    "each of these upper bounds can be interpreted as an upper limit , but with an increasing minimum probability of a source detection , @xmath16 .",
    "the three panels of figure  [ fig : ulimci ] plot how the required @xmath16 increases with @xmath1 for three values of @xmath4 . notice that a source with intensity equal to the upper bound of garwood s confidence interval can have a detection probability as low as 20% or essentially as high as 100% .",
    "thus , the upper bound does not calibrate the maximum intensity that a source can have with appreciable probability of going undetected in any meaningful way .              as mentioned in ",
    "[ s : ci].1 it is common practice to only report a confidence interval for detected sources . _ selectively deciding when to report a confidence interval _ in this way can dramatically bias the coverage probability of the reported confidence interval .",
    "we call this bias a _ statistical selection bias_. note that this is similar to the eddington bias ( eddington 1913 ) that occurs when intensities are measured for sources close to the detection threshold . for sources",
    "whose intrinsic intensity is exactly equal to the detection threshold , the average of the intensities of the detections will be overestimated because downward statistical fluctuations result in non - detections and thus no intensity measurements . in extreme cases",
    "this selection bias can lead to a nominal 95% confidence interval having a true coverage rate of well below 25% , meaning that only a small percentage of intervals computed in this way actually contain @xmath3 . as an illustration , figure  [ fig : cover ] plots the actual coverage of the nominal 95% intervals of garwood ( 1936 ) for",
    "a poisson mean when the confidence intervals are only reported if a source is detected with @xmath95 .",
    "these intervals are derived under the assumption that they will be reported regardless of the observed value of @xmath1 .",
    "although alternative intervals could in principle be derived to have proper coverage when only reported for detected sources , judging from figure  [ fig : cover ] such intervals would have to be wider than the intervals plotted in figure  [ fig : ci ] .",
    "_ it is critical that if standard confidence intervals are reported they be reported regardless of the observed value of @xmath1 and regardless of whether a source is detected . _",
    "( with @xmath32 ) . for small values of @xmath3",
    "the coverage can be very low and as @xmath3 grows , the coverage probability converges to 95% .",
    "far fewer intervals contain @xmath3 than one would expect given the nominal level .",
    "confidence intervals must be reported regardless of @xmath1 and regardless of whether a source is detected .",
    "the jagged appearance of curve stems from the discrete nature of poisson data .",
    ", width=278 ]      as discussed in section  [ s : intro ] , the detection threshold is sometimes used as an upper limit . under certain circumstances ,",
    "this can be justified under our definition of an upper limit .",
    "suppose that some invertible function @xmath96 can be used as an estimate of @xmath3 and that for any @xmath4 , the sampling distribution of @xmath96 is continuous with median equal to @xmath3 .",
    "that is , @xmath97 because equation  [ eq : dtasul1 ] holds for any @xmath3 , it holds for @xmath98 .",
    "that is , @xmath99 inverting @xmath100 and integrating over @xmath101 , we have @xmath102 comparing equation [ eq : dtasul3 ] with equation  [ eq : ulpost ] we see that @xmath103 .",
    "thus , if @xmath100 is an identity function the detection threshold is an upper limit .",
    "although the assumption that the sampling distribution of @xmath96 has median @xmath3 for every @xmath4 , is unrealistic in the poisson case , it is quite reasonable with gaussian statistics .",
    "even if this assumption holds , @xmath104 is a weak upper limit in that half the time a source with this intensity would go undetected and there is a significant chance that sources with intrinsic intensity larger than @xmath104 would remain undetected .",
    "it should be emphasized that even when the detection threshold is used as an upper limit , it is not an `` upper limit on the counts , '' but an upper limit on the intrinsic intensity of the source .",
    "the counts are an observed , not an unknown quantity .",
    "there is no need to compute upper bounds , error bars , or confidence intervals on known quantities .",
    "it is for the unknown source intensity that these measures of uncertainty are useful .",
    "our analysis of upper limits and confidence interval assumes that the observables are photon counts that we model using the poisson distribution .",
    "however , the machinery we have developed is applicable to any process that uses a significance - based detection threshold . here , we briefly set out a general recipe to use in more complicated cases .",
    "for complex detection algorithms , some of the steps may require monte carlo methods .    1 .",
    "define a probability model for the observable source and background dataset given the intrinsic source and background strengths , @xmath3 and @xmath4 , respectively . for the simple poisson case , this is defined in equation  [ eq : basicpoi ] .",
    "in many applications , these could be approximated using gaussian distributions .",
    "it is typically required that a background data set be observed but in some cases @xmath4 may be known a priori .",
    "the source could be a spectral line , or an extra model component in a spectrum , or possibly even more complex quantities that are not directly related to the intensity of a source .",
    "2 .   define a test statistic @xmath9 for measuring the strength of the possible source signal . in the simple poisson case , we set @xmath56 .",
    "the `` source '' could be a spectral line or any extra model component in a spectrum , or a more complex quantity that is not related to the intensity of a source .",
    "3 .   set the maximum probability of a false detection , @xmath14 , and compute the corresponding @xmath14-level detection threshold , @xmath10 .",
    "although @xmath10 depends on @xmath4 , we can compute the _ expected _",
    "@xmath10 by marginalizing over @xmath4 using @xmath105 when @xmath4 is not known exactly .",
    "likewise , if @xmath3 is defined as a function of several parameters , the same marginalization procedure can be used to marginalize over any nuisance parameters . in this case",
    ", we typically marginalize over @xmath106 or perhaps @xmath107 , where @xmath108 is the set of nuisance parameters . in this regard",
    ", we are setting @xmath14 to be a quantile of the posterior predictive distribution of @xmath9 , under the constraint that @xmath38 , see gelman et al .",
    "( 1996 ) and protassov et al .",
    "4 .   compute the probability of detection , @xmath59 , for the adopted detection threshold @xmath10 .",
    "5 .   define the minimum probability of detection at the upper limit , @xmath16 .",
    "traditionally @xmath109 has been used in conjunction with @xmath80 in astronomical analysis ( see  [ s : var ] ) . 6 .   compute the smallest value of @xmath3 such that @xmath110 .",
    "this is the _",
    "we focus below on signal - to - noise ( snr ) based detection at a single location as an example application .",
    "the snr was the primary statistic used for detecting sources in high - energy astrophysics before the introduction of maximum - likelihood and wavelet - based methods .",
    "typically , @xmath111 was used as the detection threshold , corresponding to @xmath80 in the gaussian regime . here",
    "we apply the recipe in ",
    "[ s : recipe ] to derive an upper limit with snr - based detection .",
    "our methods can also be applied to more sophisticated detection algorithms such as sliding - cell detection methods such as celldetect ( harnden et al .",
    "1984 , dobrzycki et al .  2000",
    ", calderwood et al .  2001 ) , and wavelet - based detection methods such as pwdetect ( damiani et al .",
    "1997 ) , zhdetect ( vikhlinin et al .",
    "1997 ) , wavdetect ( freeman et al .",
    "2002 ) , etc .",
    "implementation of our technique for these methods will vary in detail , and we leave these developments for future work .",
    "we begin with a gaussian probability model for the source and background counts ( step 1 in  [ s : recipe ] ) @xmath112 where @xmath4 and @xmath3 are non - negative .",
    "we assume that the source is entirely contained within the source cell and that the psf does not overlap the background cell .",
    "we can estimate @xmath4 and @xmath3 by setting @xmath2 and @xmath1 to their expectations ( method of moments ) , as @xmath113 the variance of @xmath114 is @xmath115 which we can estimate by plugging in @xmath114 and @xmath116 as @xmath117 to use the snr as a detection criterion , we define ( step 2 in  [ s : recipe ] ) @xmath118 step  3 in ",
    "[ s : recipe ] says that the maximum probability of a false detection should be set and @xmath10 computed accordingly .",
    "instead we adopt the standard detection threshold , @xmath119 , used with the snr and compute the corresponding @xmath14 , @xmath120 where @xmath121 is the region where @xmath122 ( see footnote  [ ft : poialpha ] ) . for given values of @xmath4 and @xmath8 , the integral in equation  [ eq : snr - alpha ] can be easily evaluated via monte carlo .",
    "alternatively , we can compute @xmath14 by marginalizing over @xmath4 if it is unknown , @xmath123 where @xmath2 is the observed background count and @xmath124 is computed in equation  [ eq : snr - alpha ] . the probability of detection , @xmath125 ) is computed ( step 4 in  [ s : recipe ] ) by evaluating the same integral as in equation  [ eq : snr - alpha ] except that @xmath3 is not set to zero .",
    "we can make the same substitution in equation  [ eq : snr - alpha2 ] if @xmath4 is unknown . with @xmath16 in hand ( step 5 in ",
    "[ s : recipe ] ) , we can find the value of @xmath3 such that @xmath126 ( step 6 in  [ s : recipe ] ) .",
    "this is the upper limit .",
    "figure  [ fig : snr - power ] illustrates the use of equation  [ eq : snr - alpha ] to compure @xmath127 for several values of @xmath4 , with @xmath128 .",
    "the upper limit is computed as the value of @xmath3 such that @xmath129 .",
    "the three panels of figure  [ fig : snr - power ] report the resulting upper limits for @xmath130 and @xmath131 , respectively .",
    "we have carefully considered the concept of upper limits in the context of undetected sources , and have developed a rigorous formalism to understand and express the concept . despite its seeming simplicity ,",
    "upper limits are not treated in a uniform fashion in astronomical literature , leading to considerable variations in meaning and value .",
    "we formally define an upper limit to the source intensity as the maximum intensity it can have without exceeding a specified detection threshold at a given probability .",
    "this is defined by the statistical power of the detection algorithm .",
    "this is equivalent to defining it as the largest source intensity that remains undetected at the specified probability , and is defined by the probability of type ii error .",
    "thus , if the detection probability is computed for a variety of source intensities , the upper limit is then identified by determining the intercept of the required probability with this curve .",
    "thus , an upper limit is dependent only on the detection criterion , which is generally a function only of the background , and independent of the source counts .",
    "this is different from the upper bound ( i.e , the upper edge of a confidence interval ) , which is obtained when the probability distribution of the source intensity is computed given that some counts are observed in the putative source region .",
    "we distinguish between the upper bound of the confidence interval and the upper limit of source detectability . unlike a confidence interval ( or bayesian credible interval ) , an upper limit is a function of the detection procedure alone and does not necessarily depend on the observed source counts .",
    "the primary goals of this paper are to clearly define an upper limit , to sharpen the distinction between an upper limit and an upper bound , and to lay out a detailed procedure to compute the former for any detection process .",
    "in particular , we have shown how to compute upper limits for the simple poisson case .",
    "we also provide a step - by - step procedure for deriving it when a simplified significance - based detection method is employed . to extract the most science from catalogs , we argue for using a consistent , statistically reasonable recipe of an upper limit being related to the statistical power of a test .",
    "in addition , we illustrate the peril of using an upper bound in place of an upper limit and of only reporting a frequentist confidence interval when a source is detected .",
    "conversely , including confidence bounds , even for non - detections , is a way to avoid the eddington bias and increase the scientific usefulness of large catalogs .",
    "we also describe a general recipe for calculating an upper limit for any well - defined detection algorithm .",
    "briefly , the detection threshold should be first defined based on an acceptable probability of a false detection ( the @xmath14-level threshold ) , and an intensity that ensures that the source will be detected at a specifed probability ( the @xmath15-level detection probability ) should be computed ; this latter intensity is identified with the upper limit .",
    "we recommend that when upper limits are reported in the literature , both the corresponding @xmath14 and @xmath15 values should also be reported .",
    "this work was supported by nasa - aisrp grant nng06gf17 g ( ac ) , cxc nasa contract nas8 - 39073 ( vlk , as ) , nsf grants dms 04 - 06085 and dms 09 - 07522 ( dvd ) .",
    "we acknowledge useful discussions with rick harnden , frank primini , jeff scargle , tom loredo , tom aldcroft , paul green , jeremy drake , and participants and organizers of the samsi / safede program on astrostatistcs .",
    "* appendix *",
    "here we discuss the relationship between confidence intervals and hypothesis tests and in particular how a hypothesis test can be used to construct a confidence interval .",
    "a confidence interval reports the set of values of the parameter that are consistent with the data .",
    "when this set includes @xmath38 it means that the data are consistent with no source and we expect the null hypothesis not to be rejected and no source to be detected . there is a more formal relationship between confidence intervals and hypothesis testing and we can use a detection method to generate a confidence interval .",
    "suppose that rather than testing the null hypothesis that @xmath38 , we are interested in testing the more general null hypothesis that @xmath132 , where @xmath133 is any non - negative number .",
    "that is , we are interested in detecting only sources of at least a certain brightness . in this case , the detection threshold , @xmath134 , is defined as the smallest value such that @xmath135 given an observed value of @xmath9 , we can construct the set of values @xmath133 for which we can not reject the null hypothesis that @xmath132 .",
    "this is a set of values of @xmath3 that are consistent with the data and they form a @xmath136% confidence interval .",
    "this particular , confidence interval , however is of the form @xmath137 : for any observed count there is a @xmath133 large enough so that we can not reject the null hypothesis that @xmath132 . by reversing the null hypothesis to @xmath138",
    "we can obtain an interval of the form @xmath139 and by setting up a _ two - sided test _ of the null hypothesis that @xmath140 against the alternative hypothesis that @xmath141 we can obtain an interval of the more common form @xmath142 .",
    "an upper limit turns around the usual use of the power of a test .",
    "power is ordinarily used to determine the exposure time required to be sure that a source with intensity @xmath143 or greater has at least probability @xmath16 of being detected .",
    "that is , the smallest @xmath6 is found that satisfies equation  [ eq : power ] for any @xmath144 and with @xmath145 fixed in advance .",
    "thus , power is used to design an observation so that we have at least a certain probability of detecting a source of given brightness . with an upper limit on the other hand @xmath6",
    "is fixed and equation  [ eq : power ] is solved for @xmath3 .",
    "this is illustrated in figure  [ fig : timelams ] which plots @xmath6 versus @xmath3 with fixed @xmath4 , @xmath7 , @xmath8 , @xmath14 , and @xmath16 and shows what values of @xmath6 and @xmath3 satisfy equation  [ eq : power ] in the simple poisson case . the shaded area above and to the right of the curve is where the detection probability exceeds @xmath146 .",
    "thus the curves give the upper limit ( on the horizontal scale ) as a function of the exposure time .",
    "the upper limit generally decreases as the exposure time @xmath6 increases , but not monotonically .",
    "due to the discrete nature of poisson data , the threshold value @xmath10 changes in integer steps to allow for the inequality in equation  [ eq : alpha ] to be satisfied .",
    "this behavior may be graphically illustrated by considering the sketch of the relevant quantities in figure  [ fig : alfabetillus ] . as @xmath6 increases",
    ", @xmath10 increases in steps , causing the probability of false detection to abruptly fall and then smoothly increase to @xmath14 . as the expected background in the source region increases , the upper curve shifts to the right , thereby increasing the shaded area that lies above the threshold value .",
    "however , when the area of the shaded region in the upper plot becomes larger than the tolerable probability of a type  i error , @xmath10 must be increased by one to reduce that probability . as @xmath6 increases , the lower curve remains stationary while @xmath10 is unchanging . at this stage , the upper limit ,",
    "@xmath147 is set as that value of @xmath3 which ensures that the type  ii error is @xmath15 ( see equation  [ eq : power ] ) , and thus slowly decreases as @xmath6 increases .",
    "when @xmath10 increases as a step function , the lower curve shifts to the right in order to maintain the same value of @xmath15 , and the upper limit abruptly increases .    .",
    "thus the curves give the upper limit ( on the horizontal scale ) as a function of the exposure time .",
    "the plot was made with @xmath32 , @xmath148 , @xmath149 , and @xmath95 and shows how the upper limit generally decreases as the exposure time increases . because of the discrete nature of poisson data , the probability of type one error can not be set exactly equal to @xmath14 .",
    "this results in the step function nature of @xmath14 in figure  [ fig : thresh ] and the non - monotonic decrease of the upper limit as a function of exposure time here .",
    ", width=278 ]",
    "in the body of the article , we suggested conditioning on @xmath2 in order to effectively estimate @xmath4 when it is unknown . a different strategy conditions instead on the total count @xmath150 in order to remove @xmath4 from the model .",
    "this method is based on the simple probabilistic result that if @xmath151 and @xmath152 are independent poisson variables with means @xmath153 and @xmath154 , respectively , then given @xmath155 , the variable @xmath151 follows a binomial distribution . applying this result to @xmath1 and @xmath2 with poisson models given in equation[eq : basicpoi ]",
    ", we have @xmath156 a binomial distribution with @xmath150 independent counts each with probability @xmath157 of being a source count . reparameterizing @xmath158 via @xmath159 , equation",
    "[ eq : binom1 ] becomes @xmath160 which does not depend on the unknown background intensity . here",
    "@xmath161 which is equal to one if there is no source and grows larger for brighter sources . because equation  [ eq : binom2 ] does not depend on @xmath4 it can be used for direct frequency based calculations even when @xmath4 is unknown . in particular , a detection threshold can be computed based on a test of the null hypothesis that @xmath162 , which is equivalent to @xmath38 .",
    "this is done using equation  [ eq : alpha ] with @xmath163 and using distribution given in equation  [ eq : binom2 ] with @xmath162 . in particular , we find the smallest @xmath10 such that @xmath164 . with the detection threshold in hand , we can compute an upper limit for @xmath165 using equation  [ eq : power ] . the upper limit",
    "is the smallest @xmath165 such that @xmath166 .",
    "unfortunately , this upper limit can not be directly transformed into an upper limit for @xmath3 without knowledge of @xmath4 since @xmath167 .",
    "ayres , t. , 1999 , apj , 525 , 1009 ayres , t.r . , 2004 , apj , 608 , 957 avni , y. , soltan , a. , tananbaum , h. , & zamorani , g. , 1980 , apj , 238 , 800 calderwood , t. , dobrzycki , a. , jessop , h. , & harris , d.e . , 2000 , adass x , asp conf.proc . , 238 , eds .",
    "f.r.harnden , f.a.primini , and h.e.payne , p443 casella , g. & berger , r.l . , 2002 ,",
    "_ statistical inference _",
    ", 2nd ed . ,",
    "duxbury damiani , f. , maggio , a. , micela , g. , & sciortino , s. , 1997 , apj , 483 , 350 dobrzycki , a. , jessop , h. , calderwood , t.j . , & harris , d.e .",
    ", 2000 , head , 5 , 27.08 eadie , w.t . , 1971 , _ statistical methods in experimental physics _ , north - holland : new york eddington , a.s . , 1913 ,",
    "mnras , 73 , 359 feldman , g.j .",
    ", & cousins , r.d . , 1998 , phys.rev.d , 57 , 7 , 3873 freeman , p.e . , kashyap , v. , rosner , r. , & lamb , d.q . , 2002 , apjs , 138 , 185 garwood , f. , 1936 , biometrika , 28 , 437 gehrels , n. , 1986 , apj , 303 , 335 gelman , a. , meng , x .-",
    "l . , & stern , h. , 1996 , statistica sinica , 6 , 733 gradshteyn , i.s . , & ryzhik , i.m . , 1980 , _ table of integrals , series , and products _ , 4th edition , academic press harnden , f.r . ,",
    "jr . , fabricant , d. , harris , d. , and schwartz , d. , 1984 , sao spc.rep .",
    "393 isobe , t. , feigelson , e.d . , & nelson , p.i . , 1986 ,",
    "apj , 306 , 490 kraft , r.p . , burrows , d.n . , & nousek , j.a . , 1991 , apj , 374 , 344 mandelkern , m. , 2002 , stat.sci . , 17 , 149 marshall , h. , 1992 , in _ statistical challenges in modern astronomy i _ , eds",
    ".  e.d.feigelson , & g.j.babu , springer - verlag : berlin heidelberg new york , p247 mattox , j.r . , et al . , 1996 ,",
    "apj , 461 , 396 park , t. , van dyk , d.  a. , & siemiginowska , a. , 2008 , apj , 688 , 807 pease , d.o .",
    ", kashyap , v.l . , & drake , j.j . , 2006 ,",
    "apj , 636 436 protassov , r. and van  dyk , d.  a. , connors , a. , kashyap , v. , & siemiginowska , a. , 2002 , apj , 571 , 545 vikhlinin , a. , forman , w. , & jones , c. , 1997 , apj , 474 , l7 van dyk , d.  a. , connors , a. , kashyap , v.l . , & siemiginowska , a. , 2001 , apj , 548 , 224 weisskopf , m.c .",
    ", wu , k. , trimble , v. , odell , s.l . ,",
    "elsner , r.f .",
    ", zavlin , v.e . ,",
    "kouvelioutou , c. , 2007 , apj , 657 , 1026"
  ],
  "abstract_text": [
    "<S> a common problem in astrophysics is determining how bright a source could be and still not be detected in an observation . despite the simplicity with which the problem can be stated , the solution involves complicated statistical issues that require careful analysis . </S>",
    "<S> in contrast to the more familiar confidence bound , this concept has never been formally analyzed , leading to a great variety of often ad hoc solutions . here </S>",
    "<S> we formulate and describe the problem in a self - consistent manner . </S>",
    "<S> detection significance is usually defined by the acceptable proportion of false positives ( background fluctuations that are claimed as detections , or the type  i error ) , and we invoke the complementary concept of false negatives ( real sources that go undetected , or the type  ii error ) , based on the statistical power of a test , to compute an upper limit to the detectable source intensity . to determine the minimum intensity that a source must have for it to be detected , we first define a detection threshold , and then compute the probabilities of detecting sources of various intensities at the given threshold . </S>",
    "<S> the intensity that corresponds to the specified type  ii error probability defines that minimum intensity , and is identified as the upper limit . </S>",
    "<S> thus , an upper limit is a characteristic of the detection procedure rather than the strength of any particular source . </S>",
    "<S> it should not be confused with confidence intervals or other estimates of a source intensity . </S>",
    "<S> this is particularly important given the large number of catalogs that are being generated from increasingly sensitive surveys . </S>",
    "<S> we discuss , with examples , the differences between these upper limits and confidence bounds . </S>",
    "<S> both measures are useful quantities that should be reported in order to extract the most science from catalogs , though they answer different statistical questions : an upper bound describes an inference range on the source intensity , while an upper limit calibrates the detection process . </S>",
    "<S> we provide a recipe for computing upper limits that applies to all detection algorithms . </S>"
  ]
}