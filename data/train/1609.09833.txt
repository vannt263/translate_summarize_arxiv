{
  "article_text": [
    "molecular dynamics ( md ) simulations are often invoked within the context of drug discovery as a means to score ligands by their absolute binding affinity.@xcite in practice , md simulations are also very useful in the discovery process if they contribute testable hypotheses that guide exploration of the chemical space around a ligand.@xcite to be influential , simulations need to provide actionable information on a short time scale , such that a team of medicinal chemists can not make the same discovery empirically or find an alternative route to success before simulation results are in hand .    the ability to explore the binding process and to compute the free energy of binding within a relevant time frame _ in silico _ depends on the rate at which the governing equations of motion can be propagated ( figure [ cycle ] ) .",
    "standard md is impractical for describing ligand - protein binding / unbinding because more than @xmath1 force evaluations must be made before the simulation reaches microsecond timescales . meanwhile ,",
    "effective ligands may stay bound to their targets for tens of minutes@xcite .",
    "with commonly used simulation tools , it takes about a week to simulate a microsecond of a protein - ligand system ( figure [ timesmpi ] ) .",
    "therefore , a considerable gap exists between the rate at which one can perform ligand binding simulations and the rate at which empirically driven progress can be made in a drug discovery setting .    a recent approach to tackle this problem of timescales has been the construction of very specialized computers@xcite , which has generated some long trajectories of ligand binding@xcite .",
    "these specialized computers aim to make as many md cycles per unit time as possible .",
    "an alternative , more easily dispersed approach is the use of algorithms that leverage formalities of statistical mechanics to extract as much information as possible from every iteration of the md cycle .",
    "this approach aims to reduce the number of cycles required to estimate thermodynamic quantities such as free energy of binding .        in this study , we focus on the use of adaptive biasing potentials ( abp ) to increase the efficiency of free energy calculations and conformational exploration .",
    "abp methods supplement the system energy in a time - dependent manner so that metastable states are slowly flooded with energy until they are flattened away .",
    "the flooding leads to new forces that are contributed by a time evolving biasing potential @xmath2 ( figure [ cycle ] ) .    in the md cycle depicted in figure [ cycle ] ,",
    "abp methods introduce computational overhead in evaluation of the biasing force , and thus slow the rate of completing the md cycle . while native md engines are typically faster at making cycles , abp schemes improve the statistical value of each cycle by several orders of magnitude .",
    "the exact improvement of statistical efficiency can be expressed as the ratio of unbiased to biased partition functions , which quantifies exactly how the abp schemes improve sampling efficiency by shrinking the boltzmann - weighted volume of configuration space .",
    "given the statistical advantage brought about by abp , the inefficiency of the associated md cycle is often taken for granted . here",
    "we show that by minimizing abp network communications within the md engine and by minimizing computational complexity of the abp scheme , the efficiency of the biased md cycle can be drastically improved while maintaining the statistical advantage of abp . on our local compute cluster ,",
    "we show efficiency gains of 25% to 67% over the commonly used plumed2@xcite plugin . in amazon s elastic cloud computing environment",
    ", we demonstrate a 36% improvement in the md cycle rate for a 26% reduction of simulation costs compared to the same plumed2 plugin .",
    "these improvements reduce the time gap between _ in silico _ and _ in vitro _ drug discovery , and increase the affordability of high throughput cloud applications . in light of the expanding abp usage base , these efficiency gains",
    "can also be projected to generate substantial savings and an improvement in simulation scope for the computational community .    as an example application ,",
    "the results of 4 microsecond - long simulations of a ligand - protein system are reported for a clinically relevant inhibitor@xcite against the chromatin regulator brd4 ( bromodomain - containing protein 4 ) .",
    "three of these simulations were allowed to sample the full surface of the protein and 60% of the simulation volume to fully detail the protein - ligand interaction .",
    "these simulations show several metastable states where the ligand aggregates on the protein surface and suggest that better control over a ligand conformation change could improve affinity .",
    "the current ligand scaffolds present two conformations , only one of which is binding competent .    without the efficiency gains derived below",
    ", each one of the @xmath0s - long simulations presented in this work would have taken 5.3 days longer to complete on exactly the same computer hardware had the current gold standard abp software been used .",
    "had all of the simulations been run in serial , they would have taken an extra 21 days to complete . in amazon s elastic cloud computing environment , the simulations presented below would cost an additional @xmath3 usd without the time - saving advances described here . extrapolating these savings to the md community projects years of saved compute time and tens of thousands of dollars .",
    "thus , the implementation described below positively impacts computational throughput and better optimizes the dollars spent funding computational research .",
    "the efficiency of the abp implementation has been improved by considering two sources of computational overhead : ( 1 ) _ computational complexity of the bias potential . _ in our implementation , the master node of the simulation handles the bias updates and bias force evaluation which is a concern for load balancing .",
    "thus , a major advance in this implementation model has been the reduction of computational complexity within the bias itself .",
    "we have written the bias in terms of kernels , or `` hills , '' that have compact support ( figure s1 ) .",
    "these new hills result in a significant reduction of operations ( namely reduced memory accesses and multiplies ) when the bias is updated , leading to better load balancing .",
    "others have also used truncated kernels to reduce complexity@xcite and below we demonstrate that this one aspect of the implementation is not enough to ensure good scalability .",
    "( 2 ) _ minimization of communications introduced by the abp scheme .",
    "_ in abp schemes , a collective variable ( cv ) must be computed .",
    "the cv is a coarse - grained description of the system state , and as such , it requires atomic positions . in most modern md engines ,",
    "the master node does not know all of the current atomic positions , so some communication is required . additionally , once the master node computes the biasing force , that force must be communicated back to the nodes that are managing atoms in the cv .",
    "details regarding each of these aspects of development are given in the si .",
    "we implemented two bias potentials , with the default being mollified adaptive biasing potential ( mabp)@xcite . this bias potential was derived elsewhere@xcite and has been shown to recover well - tempered metadynamics@xcite under an approximation that destroys the mollifying properties of the bias@xcite .",
    "importantly , mabp is not a form of metadynamics .",
    "reference shows that while mabp defines the bias potential as the log of a histogram of sampling , all forms of metadynamics write the bias potential as directly proportional to a histogram of sampling .",
    "following from this , a key attribute of mabp is that the biasing force is an ensemble average quantity .",
    "the metadynamics family tend toward higher computational complexity than mabp .",
    "boundary corrections@xcite , for example , are not required in mabp and are not supported in this distribution .",
    "convergence behavior for mabp and well - tempered metadynamics ( wtmetad ) are reported in supplemental material for alanine dipeptide to test functionality with the compact hills ( figure s2 ) .",
    "it is known that metadynamics places strict conditions on the hill functions@xcite and that the convergence time of metadynamics scales exponentially with the hill width@xcite .",
    "we observed a parameter dependent sensitivity to artifacts for the well - tempered metadynamics method when using the hill functions introduced in this work ( figure s3 ) .",
    "artifacts could be observed when wtmetad was used to repeat the simulations described below as well , though the artifacts were much more difficult to diagnose .",
    "therefore , we do not recommend invoking the metadynamics method with the hills implemented here .",
    "wtmetad performs well for some hill settings but not for others , leaving open the possibility of undiagnosed failures when using the method .",
    "an application to ligand binding is given here to measure overhead of the new implementation and as a demonstration of the mabp method .",
    "the model system involves a recently reported , clinically relevant , small molecule which binds the first bromodomain of brd4@xcite ( pdb:5hm0 ) .",
    "brd4 is an acetyllysine binding protein that is emerging as a therapeutic target for controlling expression of the `` undruggable '' oncogenic transcription factor myc@xcite .",
    "inhibitors like the one simulated here are part of an emerging class of epigenetic - based therapeutics being tested clinically for the treatment of haematological malignancies.@xcite the lead ligand ( compound 3 of reference ) in complex with bromodomain 1 of brd4 is shown in figure [ system ] .",
    "a pair of rmsd cvs were chosen for the simulations .",
    "one cv is the rmsd between a subset of atoms in the ligand at its current ( simulated ) position and the xray structure .",
    "the second cv is the rmsd between a different subset of ligand atoms in its current ( simulated ) position and the xray .",
    "this set of cvs projects the full ligand - accessible space onto the diagonal of the cv space because the two cvs are tightly coupled ( figure s4 ) .",
    "the base gromacs input topologies and tpr files for equilibration were built according to the swissparam tutorial for preparing gromacs topologies@xcite .",
    "everything required to re - run these biased simulations ( all simulation parameters and inputs ) , including a general tutorial for using the abp code , can be found at the github page for this project.@xcite the tutorial itself allows one to perform simulations of this ligand - protein system .",
    "the performance of our abp implementation is compared against native gromacsv5.0.5 and native gromacsv5.1 for several numbers of compute cores . because the implementation builds on the gromacs package",
    ", we call it fabmacs for ast daptively iased chine for hemical imulations . the data shown in figure [ timesmpi ]",
    "were selected to minimize oscillations in the scaling of the native gromacs codes , representing the envelope of best performance for the native gromacs md engine . in all cases ,",
    "gromacs was allowed to choose the partitioning of pme and particle - particle nodes and in all cases we verified that all the data at a particular node count were collected with the same partitioning . for the fabmacs simulations ,",
    "the cv space was discretized into a 480 by 480 bin grid with an rmsd range from 0 to 12 nanometers .",
    "although irrelevant for timing , the biasing parameters were @xmath4 , @xmath5 .",
    "a range of hill widths were considered , and the temperature was 300 kelvin .",
    "results are reported in units of nanonseconds per day , which can be converted to the number of md cycles per day by multiplying by 500000 ( the md timestep was 0.002 fs ) .",
    "see si section 1 for the definition of the hill functions , @xmath6 .",
    "the parameter @xmath7 fixes the width of the hill and @xmath8 alters the shape .",
    "section 3 of the si covers how to think about these hills in terms of the more common gaussian hill .",
    "figure [ timesmpi ] also shows the performance of the plumed2@xcite plugin running wtmetad , which was plugged in to gromacsv5.1 .",
    "the fabmacs parameters were converted to well - tempered metadynamics parameters according to reference @xcite and the hill width used with plumed was within the range of widths shown for fabmacs .",
    "the cv and cv discretizations were identical for the plumed2 and fabmacs methods .",
    "all of the various gromacs codes were compiled with the same configurations on the same hardware .",
    "we did not observe inefficiency when running wtmetad in fabmacs .",
    "wtmetad introduces three extra multiplies per grid point during the bias update ( to scale hill heights for the potential and its forces ) , and one exponential evaluation ( to determine the hill height ) . on 72 cores ,",
    "our implementation of wtmetad ( without boundary corrections ) averaged only 1 ns / day less than mabp .",
    "our abp implementation presents minimal overhead to the underlying gromacs engine , and the scalability of gromacs is intact . for this system , fabmacs achieves a maximum of 125 ns / day on 72 compute cores spanning three different machines .",
    "the maximum of the native gromacs code is 134 ns / day on 72 cores .",
    "it can be appreciated , as expected , that the extra abp - related communications are slowing down the simulation as the number of cores is increased ( figure [ timesmpi ] ; bottom ) .",
    "given the rise of cloud computing , it is pertinent to consider timings in the cloud environment as well .",
    "gromacsv5.1 , plumed2 , and fabmacs were timed in amazon s ec2 environment using `` g2.8xlarge '' compute nodes .",
    "these nodes have 32 cores and four nvidia grid gpus .",
    "the cost of this ec2 instance is currently @xmath9 usd per hour .",
    "table [ tab1 ] shows the cost per microsecond for native gromacs , fabmacs , and plumed2 based on timings of 100000 md steps . note",
    "that both plumed2 and fabmacs should be expected to generate better sampling than native gromacs , due to the shrinking partition function , even though native gromacs is the least expensive per force call .",
    "running fabmacs costs $ @xmath10 usd more per microsecond than native gromacs , while plumed2 costs an extra $ @xmath11 usd per @xmath0s .",
    "we did not run simulations spanning multiple machines in the cloud because projected costs did not suggest any benefit .",
    "max width=    .amazon elastic compute cloud results , and cost in usd/@xmath0s and days/@xmath0s . [ cols=\"^,^,^,^,^\",options=\"header \" , ]         encouraged by the performance of the application tested above , we also tested the performance of the built - in namdv2.11@xcite and amberv16.05@xcite implementations of adaptive biasing potentials for a larger universal benchmark .",
    "the benchmark system is a small peptide in water , producing a 99k atom system.@xcite all collective variables were 2 rmsds to an initial position with each cv having four atoms .",
    "figure [ universal ] reports results similar to what others have observed for unbiased simulations.@xcite here , we have used 28 cores spread across 7 nodes and to gain insight to the performance of the different md packages we watched the network communications on the master node of the simulations via ifconfig .",
    "the cumulative inbound traffic is shown in figure [ universal](bottom ) for each md package .",
    "all machine interconnects were 40gbe .",
    "figure [ universal](bottom ) suggests that plumed2 is inefficient within the bias update and bias force computations but not in network communications .",
    "this may be a load balance issue .",
    "the built - in namd biasing seems limited by the underlying speed of namd .",
    "the pmemd - amber implementation appears to produce excessive network traffic when abmd is invoked .",
    "activation of biasing within amber on gpu also incurs efficiency losses either because excessive system information is passed from the gpu to cpu for biasing at every timestep or because cpu speed is a bottleneck . as we noted earlier",
    ", this demonstrates that minimization of operational complexity in the bias@xcite is insufficient to achieve good scalability although it is required for load balancing .",
    "the fabmacs package can be compiled for different scenarios . to keep the code as streamlined as possible , a number of options are hard - coded via a patching script .",
    "the script sets a number of parameters for things like cv space discretization , selection of mabp or wtmetad , and what type of restraint system to apply .",
    "there are two selectable restraint types , a spherical or cylindrical restraint .",
    "there is a third restraint that can not be deselected , which limits the maximum value of the cvs",
    ". this restraint can be obsoleted by setting a large maximum limit .",
    "a full tutorial is available on the project github page@xcite , which walks through setting up and running the simulations presented in this section .",
    "the periodic simulation boundaries are unwrapped such that the ligand is whole and such that the ligand does not `` jump '' across the box .",
    "unwrapping is not supported in some abp plugins@xcite , yet unwrapping is critical unless the simulation system is designed such that the cvs are never broken by periodicity .",
    "we performed a total of four 1@xmath0s simulations with the lead ligand that used the spherical ( figure [ res1]a ) or cylindrical ( figure [ res1]b ) restraint .",
    "the mabp simulations used hills with compact support , called @xmath6 , where @xmath12 and @xmath13 or @xmath12 and @xmath14 , where the latter is labeled `` wide '' in figure [ res1]d . plots of free energy for all of the simulations are shown in 2-dimensions ( figure s4 ) and as 1-dimensional projections ( figure [ res1]d ) . we followed the formalisms of references and for estimating absolute binding free energy with and without restraints , respectively .    the absolute free energy of binding estimated from each of the simulations ranges from -5.18 to -7.63 kcal / mol .",
    "all of the estimates are within 4 @xmath15 of one another , where @xmath16 is boltzmann s constant and @xmath17 is temperature .",
    "this is a surprising degree of similarity given that three of the simulations were allowed to sample the entire protein surface , and two of those started in an unbound conformation . in each of the simulations using wide hills and the large spherical restraint ,",
    "the crystallographic ligand pose was found only once .",
    "one of these simulations started in the bound conformation , one started in an unbound conformation .",
    "both simulations found the crystallographic pose from an unbound state .",
    "in the simulation using narrow hills and starting in an unbound conformation , the crystallographic ligand pose was found twice .",
    "( figure s6 ) simulations as loosely restrained as these are very rarely performed and have even been described as impossible.@xcite indeed , we only tried these simulations after being encouraged by the performance of fabmacs .",
    "the simulation using the cylindrical restraint found the crystallographic pose four times .",
    "thus , the free energy estimate from the cylindrical restraint is expected to be most accurate .",
    "the average absolute free energy of binding over the four estimates is -6.56 kcal / mol with a standard error of 0.56 kcal / mol .",
    "the free energy estimate from simulation with the cylindrical restraint was -6.16 kcal / mol .",
    "we did not compare to binding free energy estimated from ic@xmath18 reported in reference for two reasons .",
    "first , we did not parameterize the ligand via _ ab initio _ methods .",
    "second , the binding constant of the competitor ligand must be known to make an accurate free energy estimate@xcite , and details of the competitor ligand were not reported .",
    "it is also worth noting that most ligand development efforts focus on dissociation constants rather than free energy of binding .",
    "if simulation estimates leave a 1 kcal / mol error in the free energy , there is a 5-fold error in the dissociation constant . for a 2 kcal / mol error in the free energy ,",
    "there is a 29-fold error in the dissociation constant . in general",
    ", it is more informative to generate structure - activity trends than to compare simulation results to experimental metrics .    the simulations using the spherical restraint sample a number of configurations where the ligand is aggregated to the protein surface ( figure [ res1]c ) .",
    "we observe a large number of states where the ligand is aggregated on the za - loop or docked in the binding pocket with an incorrect pose .",
    "most binding pathways show the ligand aggregate to the pocket or za - loop and then explore different ligand poses and azepine ring conformations until the crystallographic pose is found .",
    "often , the ligand leaves the pocket area and moves back into solvent before finding the correct pose .",
    "many attempted binding events were rejected by the protein because the ligand adopted a binding incompetent conformation .",
    "the benzoisoxazoloazepine ligand contains an azepine ring that can adopt different puckering states ; ( figure s5 ) only one of the two major puckering states is consistent with the crystallographic pose .",
    "the `` incorrect pose '' shown in figure [ res1]c is representative of a state in which the azepine ring has adopted a conformation inconsistent with the crystallographic pose , precluding correct binding and slowing the binding process .     from 0 to 40 kj / mol . ]    as a simple means of testing the hypothesis that binding could be improved by reducing flexibility of the azepine ring , we computed the binding free energy again while applying a dihedral restraint that prevents the azepine from changing conformations . the absolute binding free energy , computed from a 1@xmath0s simulation using the cylindrical restraint and an inflexible azepine , was -9.42 kcal / mol .",
    "this compares to -6.16 kcal / mol for the flexible azepine in the cylindrical restraint ( figure [ nonflex ] ) .",
    "the restrained ligand found the crystallographic pose 6 times ( figure s6 ) .",
    "these simulations validate our hypothesis and motivate ligand chemistry that would restrain the azepine .",
    "functionalization of the ligand or abandonment of the azepine ring are both plausible directions .",
    "we have introduced and benchmarked an implementation of abp in gromacs 5.0.5 , called fabmacs , that presents minimal overhead to the gromacs engine .",
    "the implementation strives to maintain the scalability of gromacs . a minimal communication scheme and local smoothing kernels",
    "have been used to achieve this goal .",
    "drastic efficiency gains were demonstrated , as compared to the most common alternative abp plugin .",
    "the fabmacs code is available on github@xcite where a tutorial can also be found .",
    "all of the ligand - protein simulations presented above can be re - run by following the tutorial . currently , only rmsd cvs are supported , but a range of systems should be compatible with this . a future goal is to develop the distribution to support a range of different cvs .",
    "cylindrical , spherical , and simple range - limiting cv restraints are supported .",
    "a build script is included with the code , which customizes source code for user specifications of methods , restraint types , restraint scales , and so - on .",
    "thus , if a user can install gromacs 5.0.5 on their compute infrastructure , then fabmacs can be installed using the same configuration .",
    "simply run the build script with specified options , and compile the source code as normal .",
    "implementation into other md engines are also ongoing .",
    "the results of long simulations of the first bromodomain of brd4 with a clinically - relevant small molecule were presented , both to make methodological demonstrations using mabp and to examplify structural insights that are obtained from atomistic simulations .",
    "simulations were presented that found the bound state after having escaped , even when the full surface of the protein could be sampled .",
    "we suggest a trend in the published sar data that could be further exploited to improve potency  namely the azepine ring affords conformational freedom that reduces ligand efficiency .",
    "fabmacs will be useful in identification of false positives , creation of chemical hypotheses , scoring ligands , and guiding nmr based fragment screening .",
    "the efficiency gains of fabmacs will enable more efficient use of computational resources and make new , ambitious applications more affordable and tractable .",
    "let the cv be @xmath19 which is a vector of coordinates in the cv space , and let @xmath20 be a particular point .",
    "we use @xmath21 to indicate the position of the trajectory in configuration space , and @xmath22 or @xmath23 to indicate the trajecotry position in cv space .",
    "the mabp bias potential is @xmath24\\ ] ] and the mabp bias gradient is @xmath25 where @xmath26 is the temperature of the simulation in units of energy . @xmath27 and @xmath28 are parameters , as discussed in the appendix ( or si ) .",
    "two histograms are required for evaluating the biasing force @xmath29 the first is a standard histogram convoluted with a smoothing kernel , or `` hill '' , @xmath30 where @xmath31 controls the width of the gaussian .",
    "the second histogram is actually the weak derivative of the raw ( un - smoothed ) histogram along @xmath19 .",
    "one can appreciate that if the histograms are collected , the biasing force requires only a look - up in the histograms and some arithmetic operations . as we have advocated in the past@xcite ,",
    "this is also much more simple than adaptive biasing force methods@xcite .    in order to collect these histograms with computer code",
    ", the cv ( and time ) must be discretized .",
    "let the discretization use @xmath32 for each dimension of the cv space . ignoring the trivial details , the position of the trajectory",
    "is then approximated by the nearst grid point @xmath33 and the histograms are updated as @xmath34 for all grid points @xmath19 at every timestep of the simulation with the initial conditions @xmath35 and @xmath36 .",
    "( @xmath37 is the md timestep ) the hills ( or smoothing kernels ) are stored in a lookup table ( see reference ) by precomputing @xmath38 for every possible pair @xmath39 in the discretized cv space .",
    "thus the gaussians @xmath40 are evaluated once and only once . however , because the gaussian hills do not vanish , the update in equation is made for all grid points . in order to greatly reduce the number of arithmetic operations in equation , one can introduce smoothing kernels that have compact support .",
    "such kernels would only be non - zero in the neighborhod of @xmath20 so that an update only needs to cover a small subset of the grid points representing the cv space .    for each component of the cv @xmath41",
    ", the compact smoothing kernels have the form ( see figure [ showhill ] ) @xmath42 where the leading @xmath8 factors of @xmath43 ensure that @xmath44 and the parameter @xmath7 controls the width of the function . to further minimize complexity , we define the smoothing kernel in a multi - dimsional cv space as the product of these one dimentional functions .",
    "the integer @xmath45 allows the resulting multidimensional function to be round rather than square .",
    "( increasng @xmath8 makes the functions more round . ) with these compact functions the update becomes @xmath46 where the update only runs over grid points near @xmath20 , such that @xmath47 , _",
    "i.e. , _ those grid points within a distance @xmath7 from the trajectory at @xmath20 .",
    "the wtmetad update can be written in analogy with the mabp update , with the only difference being that wtmetad scales the update in equation by a factor determining the so called `` hill - height '' .",
    "the value @xmath7 may be different for different components of @xmath19 although this case is not covered here . for a multidimensional cv space this results in a large reduction of evaluations at each bias update . in two dimensions ,",
    "we replace @xmath48 operations with @xmath49 operations where @xmath50 is the number of grid points spanned by @xmath6 .",
    "all the analysis of mabp from reference holds with these new functions so the method will converge , as we next demonstrate .      to minimize communications , each processor checks if it is responsible for any atoms in the cv .",
    "if a processor does manage cv - implicated atoms , it sends a flag to the master processor to indicate this , and it sends a vector to the master which holds those atom s coordinates . if a processor does not manage atoms in the cv , then it sends a flag to indicate this .",
    "the master now knows which processors are involved in cv and which processors are not , and recieves the atom coordinates from those processors that are involved in the cv .",
    "the master then passes the atomic coordinates ( of only those atoms in the cv ) to the mabp routine which computes the bias update and bias force .",
    "the master then sends the bias force back to the processors that have atoms involved in the cv , where each processor then adds the biasing force to the gromacs force for its atoms .",
    "this communication scheme was implemented by injecting mpi ( message passing interface ) function calls in the md.c routine of gromacs .",
    "the gromacs ga2la_get function was used to determine which atoms are `` home '' atoms for each process .",
    "the `` home '' atoms that are in the cv are the atoms that must be sent to the master for adaptive biasing .",
    "all of the additional code , save initializations , was injected after the call to do_force .",
    "our biasing routine is written in fortran and named `` hellof '' , meaning `` hello fortran . ''",
    "the biasing function as well as the fortran compilation option were specified in the cmakelists.txt file of the mdrun directory .",
    "no other changes to gromacs were required .",
    "the usual alanine dipeptide benchmark is used here to demonstrate convergence for this new smoothing function .",
    "exactly the same set - up for measuring convergence , the same reference free energy , and the same biasing parameters @xmath51 are used as recently reported@xcite .",
    "the cv space here is two dimensional , and each component is a backbone dihedral angle , one cv for @xmath52 and one for @xmath53 . in figure [ showhill ] , we plot @xmath54 , where @xmath55 is one of the dihedral angles . using @xmath56 scales the domain of @xmath57 so that the kernel is zero when the dihedral angle is more than @xmath58 degrees from @xmath59 .",
    "the compact hill @xmath57 is shown in purple , while the more typical gaussian hill is shown in black .",
    "the width of the two hills at half - height is identical , and we suggest that the width at half - height is a reasonable way to get some intuition for these smoothing kernels as compared to the gaussian kernels .",
    "the width at half - height for @xmath6 is given by @xmath60 the base of @xmath6 has a width of @xmath61 , and a bin - width of @xmath62 where @xmath63 is the distance between grid points for the @xmath64-th cv . for equation",
    ", one can write the @xmath31 for which @xmath40 has the same width at half - height @xmath65 .",
    "this allows one to have a feeling for how @xmath6 compares to a more familiar gaussian smoothing kernel .",
    "the gaussian in figure [ showhill ] uses @xmath66 .        in figure [ converg ] , error in the free energy estimate",
    "is shown as a function of simulation time for different values of @xmath7 .",
    "the error is the average absolute difference between the abp ( either mabp or wtmetad ) free energy estimate and a reference free energy , as described in reference one of the strengths of mabp was that it leads to a free energy estimate that is independent of @xmath31.@xcite when using these new kernels , the free energy is independent of @xmath7 , as can be seen in figure [ converg ] .",
    "wtmetad , on the other hand , seems to be more sensitive to these hills than it is to gaussian hills .",
    "figure [ converg ] reflects this , showing an impaired convergence for a hill that compares to a gaussian of about 20 degrees . we ve recently looked in detail at how metadynamics is impaired when the hill widths are large@xcite ,",
    "where we showed wtmetad converges quickly until the gaussian hill widths are greater than 30 degrees .",
    "was @xmath67 degrees .",
    "( bottom ) convergence of alanine dipeptide with compact hills for different base widths ( @xmath61 ) in units of degrees .",
    "( all @xmath12 ) ]    the @xmath6 hills have a boxy shape in 2d .",
    "the parameter @xmath8 allows them to be rounded out .",
    "the results in figure [ converg ] used @xmath12 .",
    "the problem for wtmetad is that we do not know how to set @xmath8 and @xmath7 for an arbitrary system in a way that will guarantee sufficiently round hills .",
    "the wtmetad method demonstrates a failure to converge on the timescales we tested when @xmath68 and it demonstrates pathological sampling behaviors .",
    "figure [ hists ] shows the histogram of backbone dihedral angles that was collected from wtmetad and mabp using the same hills ( base width @xmath69 degrees and @xmath68 ) . while it is possible to choose functional hills for wtmetad , it is impossible to know _ a priori _ which hills will fail .",
    "mabp , on the other hand , exhibits robust performace .",
    "we stress that increasing @xmath8 salvages the wtmetad simulations but a general rule for identifying failure is not in - hand . in the mean time , we advocate sticking to mabp while using fabmacs .",
    "the free energy landscapes for the four mabp simulations are shown in figure [ 2ds ] .",
    "the tightly coupled cvs project the configuration space onto the diagonal of the cv space .        in figure [ conf ]",
    "we show the free energy landscape of the ring puckering for both the lead and final compounds from reference .",
    "indeed , the immediate and testable hypothesis suggested by these simulations is that this puckering behavior could be controlled to improve potency .",
    "the compound on the right side of figure [ conf ] is cpi-0610 , which is the compound that has moved into clinical trials . of course",
    ", binding is not the only consideration when the goal is development of a drug , and this compound was ultimately selected for its favorable pharmacokinetics and toxicological profiles .    .",
    "]      to avoid division by zero when the rmsd is zero , we write the rmsd as @xmath70 which is offset from zero by @xmath71 .",
    "@xmath72 are the atomic positions of the atoms in the cv and @xmath73 are the reference positions for the atoms .",
    "the lower bound for this rmsd is @xmath74 .",
    "a trace of cv1 for all trajectories shows that the rmsd is @xmath74 when the crystallographic state is found ( figure [ trace ] ) .",
    "sim1 started unbound in spherical restraint , sim2 started bound and used the spherical restraint , sim3 started unbound and used spherical restraint , sim4 started bound and used cylindrical restraint .",
    "the rigid azepine simulation started bound and used the cylindrical restraint .",
    "supplementary material provides details on the hill functions , mpi calls in gromacs , convergence results for alanine dipeptide , free energy landscapes for ligand binding simulations , free energy of azepine conformations , and the definition of our rmsd coordinate .",
    "all computations were performed on the van andel research institute compute cluster , except for the timings on ec2 .",
    "this work was supported in part by the van andel research institute and research grants from the national institutes of health to s.b.r .",
    "( ca181343 ) ."
  ],
  "abstract_text": [
    "<S> in this communication we introduce an efficient implementation of adaptive biasing that greatly improves the speed of free energy computation in molecular dynamics simulations . </S>",
    "<S> we investigated the use of accelerated simulations to inform on compound design using a recently reported and clinically relevant inhibitor of the chromatin regulator brd4 . </S>",
    "<S> benchmarking on our local compute cluster , our implementation achieves up to 2.5 times more force calls per day than plumed2 . </S>",
    "<S> results of five 1@xmath0second - long simulations are presented , which reveal a conformational switch in the brd4 inhibitor between a binding competent and incompetent state . </S>",
    "<S> stabilization of the switch led to a -3 kcal / mol improvement of absolute binding free energy . </S>",
    "<S> these studies suggest an unexplored ligand design principle and offer new actionable hypotheses for medicinal chemistry efforts against this druggable epigenetic target class . </S>"
  ]
}