{
  "article_text": [
    "the kekb b - factory was designed as an asymmetric electron / positron collider in order to study the violation of cp symmetry in the b - meson system .",
    "it consisted of double storage rings of an 8  gev electron high - energy ring ( her ) and a 3.5  gev positron low - energy ring ( ler ) with a diameter of 1  km , and a full energy injector linac of 600  m  @xcite .",
    "it achieved a collision luminosity of @xmath0 , twice as much as the designed luminosity , and led to kobayashi and maskawa winning the nobel prize for the theory of quarks and cp symmetry violation .    during a decade of successful operation",
    ", kekb completed all of the technical milestones and offered important insights into the flavor structure of elementary particles .",
    "kekb collider and belle detector were constructed and operated at almost the same time as pep - ii and babar at slac with the same scientific goal .",
    "this provided a friendly competition between these two projects and led to many collaborative efforts  @xcite .",
    "the success of the high performance operation of kekb owed much to the control system .",
    "it was designed more than 15 years ago and started beam operation in 1998 . while it inherited some of its resources from the previous project , tristan , it restructured most of the software and hardware components .",
    "it employed the epics ( experimental physics and industrial control system ) toolkit for the low - level control mechanism and scripting languages for high - level operational applications .",
    "this combination provided a flexible and robust operational environment .",
    "the details of the hardware and software architecture at the commissioning of kekb are described elsewhere  @xcite .      before kekb",
    ", projects in the institute repeated the development of their own control systems .",
    "as technologies such as computers , system software , and field networks became de facto standards at the beginning of the 1990s , the sharing of control system architectures between projects was considered .",
    "after ssc ( superconducting super collider ) chose epics as its main control toolkit , epics became a candidate for future controls at kek  @xcite .",
    "epics was studied at the injector linac , and epics gateways were constructed based on the existing control system  @xcite .",
    "in contrast , for the kekb ring it was decided to employ epics controls and the previous software resources were not employed .",
    "the main reason for this was that the linac already had a network - based control system and it had to continue operation for light sources even during the upgrade construction towards kekb , but the ring could have shut down the accelerator completely for 4 years .",
    "the kekb ring employed several fieldbuses such as vme , vxi , camac , gpib , and arcnet depending on the intended purpose .",
    "approximately 100 vme systems with the vxworks operating system served as epics input / output controllers ( iocs ) for all the hardware devices , including 200 vxi mainframes , 50 camac crates , and 200 arcnet segments .    for the networks and computers in the global control system ,",
    "a quite standard environment was applied , taking account of reliability , such as redundant gbe network systems , redundant network file servers , blade cpu servers , and commodity console machines with x11 server software at kekb and the linac .    at the linac",
    "most of the devices employed controllers with ethernet and tcp / ip instead of other kinds of fieldbuses . before the kekb project ,",
    "network - based plcs ( programmable logic controllers ) , camac crate controllers , and vme computers were managed by middle - layer software on unix servers . during the upgrade construction for kekb , these network - based controllers were shared between the old control software and the epics gateways .",
    "gateways were implemented with a portable channel access server ( pcas ) at the beginning , and were eventually replaced by soft iocs as epics started to support unix - based iocs  @xcite .",
    "the number of epics process variables in the system was approximately 300,000 , and that of hard - disk - archived ones was 150,000 .",
    "they were distributed over 150 vme - based and linux - based epics iocs .      at the linac , the tcl / tk scripting language",
    "was effectively employed for its commissioning  @xcite after the language had been utilized for testing tools for many years .",
    "later , for both the ring and the linac , python was employed as it had more strong points  @xcite .",
    "much of the device manipulation software was written in these two languages , as well as medm .    for beam operation , sad ( strategic accelerator design program )",
    "was extended to have an interpreter , sadscript , which emulated most of the mathematica language  @xcite .",
    "this provided most of the functionalities required for the accelerator operation , such as linear beam optics , symplectic beam tracking , non - linear beam dynamics , optimization , list processing , numerical manipulation , epics channel access , and a graphical user interface .",
    "thus , online linkage between the beam simulation and the machine operation was provided through the sad and epics environments .",
    "in fact , many slow closed feedback loops were implemented using these script languages in order to stabilize the beam characteristics and to maintain the ultimate collision condition .",
    "script languages are very suitable for rapid prototyping .",
    "if a program needed higher performance , the algorithm was eventually transported into a faster ioc process .",
    "such feedback loops were often effective in suppressing interim instability of hardware devices before repair .",
    "they were also important during the beam studies because the beam conditions were very different from the normal ones .",
    "while a certain parameter was scanned in such studies , other parameters often had to be maintained stable .    during normal operation",
    "it is necessary to measure the beam response on certain parameter changes , and then to optimize those parameters .",
    "such a process can be interactively carried by sadscript , and then turned into a graphical user interface that is performed routinely .",
    "new ideas for luminosity optimization were often proposed in the morning meeting , and corresponding operational tools were realized within a day or two .",
    "some of the ideas turned out to be favorable , and the tool became utilized routinely .",
    "as many equipment and beam - physics ideas were proposed day by day , rapid tool development was crucial and sadscript played a significant role .",
    "actually , it is difficult to name a single mechanism that enabled the kekb s high performance ; however , the accumulation of a hundred 1% improvements provided twice the performance .    besides script - based application programs ,",
    "many software packages were developed , including a data archiver ( kekblog ) , an alarm handler ( kekbalarm ) , an electric operational logbook ( zlog ) , an archive browser , etc .",
    "the combination of them refined the everyday kekb operation .",
    "as an upgrade to a control system needs considerable effort , it is preferable to maintain the same environment during a project .",
    "however , an accelerator project can span more than ten years , and related software , hardware , persons , companies , and their policies may change substantially during that period .",
    "thus , it is necessary to introduce advanced technologies to improve the machine even during the project . on the other hand ,",
    "it is often difficult to accommodate new technologies with existing components .",
    "if a component is modified to accept them , others may have to be modified .",
    "actually , during the kekb project , new operation schemes were introduced almost every year . as most components in the control system were kept the same , it was rather difficult to catch up with the requirements at a later period .",
    "one modification might trigger another , and several modifications had to be performed at the same time .",
    "because the shutdown period in a year was limited , if the extent of modifications exceeded the limit , it became very hard .",
    "thus , we needed to be prepared to accommodate small upgrades each year not only for application programs but also for control system infrastructure , including base software and hardware components , in order to manage a project for a long period .    without changing",
    "the architecture of the control system , featured with epics and scripting languages , new concepts were incorporated at later years in the project .",
    "these included channel access everywhere and the dual - tier control system , described below .      the accelerator control architecture in kek evolved in several steps .",
    "some time ago some control systems were standardized with a combination of several fieldbuses , vme field computers , and unix computers . in order to consolidate the efforts on the development and maintenance , some of the fieldbuses",
    "were gradually removed and many controllers were directly attached to ip networks .    at the same time , the epics control software framework was employed at control systems at kek .",
    "eventually , many controllers evolved to embed the same epics ioc software as on vme field computers , as illustrated in fig .",
    "[ devcont ] .",
    "common pieces of ioc software communicated with others using a common protocol called channel access ( ca ) , which realized a unified application development environment from top to bottom .",
    "we call this embedded epics framework `` ca everywhere '' , and it enabled both rapid development and smooth maintenance  @xcite .",
    "different kinds of controllers have been developed in the framework of ca everywhere , and they greatly reduced the control efforts and improved the reliability .",
    "they include the following controllers .",
    "many of them were realized employing plc  @xcite , embedded computers  @xcite , or fpga ( field programmable gate array )  @xcite .    *",
    "temperature monitor with linux * yokogawa fam3 plc with realtime linux * tektronix oscilloscope for 50  hz measurement with windows * time - to - digital converter ( tdc ) with fpga and linux * microtca llrf controller with fpga and linux * microwave power modulator with fpga and linux * libera bpm readout at 50  hz with fpga and realtime linux * ni compact - rio with cas and fpga      for higher experimental performance at kekb and the light sources that share the same injector , it was favorable to inject beams in top - up mode into all the storage rings . in the photon factory ( pf ) , a stable beam current would provide precise experimental results . in kekb",
    ", stability was desired for sensitive beam collision tuning to increase the luminosity .    to that end",
    ", simultaneous top - up injection had been established for three storage rings at the kekb her , ler , and pf since 2009 .",
    "electron and positron beams with very different characteristics , charged from 0.1  nc to 8  nc and with energies between 2.5  gev and 8  gev , were exchanged at a rate of 50  hz ( 20  ms ) . as a result , stored beam stabilities of 0.05% ( 1  ma ) at the kekb her and ler , and 0.01% ( 0.05  ma ) at pf were achieved , improving the quality of experiments .    while it initially took 30 seconds to 2 minutes to switch the beam injection modes between these storage rings , it was preferable to change many parameters synchronously within 20  ms . thus , global and fast controls were established for such pulse - to - pulse beam modulation .",
    "this kind of beam modulation was realized a long time ago but the speed was much slower , around one to several seconds  @xcite . as the existing control system , based on ten - year - old hardware and conventional epics software , was inadequate for controlling the beam within 20  ms , a new control system with an event notification mechanism , capable of regulating @xmath1150 parameters at 50  hz ,",
    "was installed .",
    "this event - based control system covered the controls of the low - level rf , high - power rf , pulsed magnets , an electron gun , injection systems , and beam instrumentation , whose devices were spread over a distance of 1  km .",
    "while the event - based control system was supervised by the epics control software , it had a dedicated communication link for fast , global , and robust controls  @xcite .",
    "the event generator sent timing signals and control data to 17 event receiver stations arranged in a star - like topology as in fig .",
    "[ fig - config ] .",
    "each link between the event generator and a receiver was carried over a single optical fiber .",
    "it provided both synchronized timing signals , with approximately 10  ps precision , and synchronized controls through a realtime software mechanism , at about 10  @xmath2s precision .",
    "recent technological advances in fpga and sfp ( small form - factor pluggable ) enabled reliable controls in this configuration .",
    "vme - based event control modules of the generator ( evg230 ) and the receiver ( evr230rf ) from mrf were utilized  @xcite .",
    "the event generator provided several events corresponding to beam and device controls synchronized to one of the linac rf clock ( 114.24  mhz ) .    the same dual - tier control system with a conventional epics control and an event - based control depicted in fig .",
    "[ duallayer ] will also be essential in the future superkekb .",
    "simultaneous injection will be maintained , as the beam lifetime will be more limited at the superkekb her and ler .",
    "many more parameters will have to be managed precisely in order to realize lower - emittance beams for higher luminosity .",
    "the event - based control tier manages global and fast controls in the pico- to microsecond range .",
    "the epics control tier covers slower parameter controls for the event - based controls as well as existing conventional controls .",
    "the epics tier arbitrates operation requests of average beam repetition rates from the three rings , and schedules different beams pulse by pulse .",
    "such requests occurred every several seconds , and upon each request the beam mode schedule was reprogrammed at the event - control tier through epics ca .",
    "such a dual - tier control system is also optimal for the next generation of accelerator systems .",
    "under the simultaneous injection configuration , the event - based control system provided beam - mode dependent control parameters . moreover ,",
    "these parameters in different beam modes were organized to be independent both for controls and measurements .",
    "thus , we can see these independent parameter sets as independent virtual accelerators . for each 20",
    "ms time slot , the event system associated one of the virtual accelerators with the real accelerator .    because these control parameters for each virtual accelerator continue to exist , human operators and operational software can act on one of these virtual accelerators without any interference from the others .",
    "bpm information and rf control parameters were also handled independently in each virtual accelerator . at first",
    ", energy feedback loops at the 180 degree arc and at the end of the linac were installed using event control parameters on each virtual accelerator as in fig .",
    "[ fig - virt ] . as the parameters are independently managed , no modifications to the existing software were necessary .",
    "the performance of these closed loops was observed with small feedback gains during normal operation . in these feedback operations",
    "no beam stability improvements were achieved . in other words , no signs of instabilities",
    "were observed other than white noise , since the hardware stability was much improved in the later years of the project  @xcite .    for energy stabilization at the pf beam - transport line , it turned out that the separation of the betatron and dispersion functions was not optimal and the resolution of bpms was insufficient because of the low beam charges .",
    "the procedures of betatron oscillation compensation and the weighed average of beam positions were applied later . because the processing speed with a scripting language was not sufficient in a certain case ,",
    "the epics epid ( enhanced proportional , integral , and derivative controller ) record mechanism was employed as well .",
    "the orbit and energy spread stabilizations can be implemented in the same way .",
    "these beam feedback signals provided valuable information for the accelerator operation .",
    "we could insert a test beam pulse between injection beam pulses and associate it with one of the virtual accelerators . using such a virtual accelerator we could perform a kind of beam study during normal operation .",
    "the same could be applied to one of the stored beam bunches in the ring as well .",
    "this virtual accelerator concept might play an important role in the future superkekb operation .",
    "the accelerator control system in the kekb project achieved successful operation of the project , leading satisfactory physics results with the two basic facilities of the epics software toolkit and scripting languages .",
    "later , two additional concepts of `` channel access everywhere '' and `` dual - tier controls '' were introduced for further improvements .",
    "based on such control foundations the virtual accelerator mechanism was successfully tested ; this could be the basis of next - generation accelerators , including superkekb .",
    "the authors are grateful to all the staff and operators at kekb and the linac for their suggestions and continuous encouragement during the project .",
    "they also thank the developers from mitsubishi electric system & service co.  ltd . and",
    "east japan institute of technology co.  ltd . for their system development .",
    "k.  furukawa _",
    "_ , `` integration feasibility of the existing linac control system and the ring epics system at kekb '' , http://ccdb5fs.kek.jp/cgi-bin/img/allpdf?199527202[_proc .",
    "icalepcs1995 _ , chicago , usa . ( 1995 ) p.  863 ] .",
    "k.  furukawa , n.  kamikubota , t.  suwada , and t.  urano , `` accelerator controls in kekb linac commissioning '' , http://epaper.kek.jp/ica99/papers/wc1p29.pdf[_proc .",
    "icalepcs1999 _ , trieste , italy ( 1999 ) p.  98",
    "nakamura , k.  furukawa , j.  odagiri , and n.  yamamoto , `` development of the software tools using python for epics - based control system '' , http://epaper.kek.jp/ica07/papers/tppa16.pdf[_proc .",
    "icalepcs2007 _ , knoxville , usa . ( 2007 ) p.  120",
    "n.  akasaka , h.  koiso , and k.  oide , `` operation software for commissioning of kekb linac programmed with sad '' , http://epaper.kek.jp/a98/apac98/5d043.pdf[_proc .",
    "apac1998 _ , tsukuba , japan ( 1998 ) p.  495 ] .",
    "k.  furukawa _",
    "_ , `` embedded llrf controller with channel access on microtca backplane interconnect '' , http://epaper.kek.jp/icalepcs2011/papers/thdault05.pdf[_proc .",
    "icalepcs2011 _ , grenoble , france ( 2011 ) p.  1274 ] .",
    "k.  furukawa _",
    "et  al . _ , `` new event - based control system for simultaneous top - up operation at kekb and pf '' , http://epaper.kek.jp/icalepcs2009/papers/thp052.pdf[_proc .",
    "icalepcs2009 _ , kobe , japan ( 2009 ) p.  765",
    "k.  furukawa , m.  satoh , t.  suwada , and t.t .",
    "nakamura , `` pulse - to - pulse beam modulation and event - based beam feedback systems at kekb linac '' , http://epaper.kek.jp/ipac10/papers/tuocmh01.pdf[_proc .",
    "ipac2010 _ , kyoto , japan ( 2010 ) p.  1271 ] ."
  ],
  "abstract_text": [
    "<S> kekb has completed all of the technical milestones and has offered important insights into the flavor structure of elementary particles , especially cp violation . </S>",
    "<S> the accelerator control system at kekb and the injector linac was initiated by a combination of scripting languages at the operation layer and epics ( experimental physics and industrial control system ) at the equipment layer . during the project , </S>",
    "<S> many features were implemented to achieve extreme performance from the machine . in particular , the online linkage to the accelerator simulation played an essential role . in order to further improve the reliability and flexibility , </S>",
    "<S> two major concepts were additionally introduced later in the project , namely , channel access everywhere and dual - tier controls . based on the improved control system , </S>",
    "<S> a virtual accelerator concept was realized , allowing the single injector linac to serve as three separate injectors to kekb s high - energy ring , low - energy ring , and photon factory , respectively . </S>",
    "<S> these control technologies are indispensable for future particle accelerators . </S>"
  ]
}