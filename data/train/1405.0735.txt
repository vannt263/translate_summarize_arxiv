{
  "article_text": [
    "accurate numerical simulation of time - dependent phenomena in many spatial dimensions is a challenge in a wide range of application areas , for example quantum dynamics @xcite and systems biology @xcite .",
    "other challenging areas are wave propagation problems with drastically varying physical features in different spatial regions , governed by e.g. the elastic wave equation  @xcite . computational problems in higher dimensions and/or widely varying scales are demanding since the number of grid points required to represent a solution with high enough resolution often becomes prohibitively large . as a consequence , high - order and adaptive schemes are an active area of research in these application fields .",
    "the focus of our paper is on wave propagation problem described either by first derivatives or complex second derivatives . when structured grids can be used , finite difference methods allow for efficient implementation of high - order methods .",
    "summation - by - parts ( sbp ) operators are finite difference operators with special boundary closure such that the discrete operators mimic properties of the continuous operators .",
    "an attractive feature of the sbp operators is that in combination with the simultaneous - approximation term ( sat ) boundary treatment  @xcite , this discretization often leads to time - stability in single- as well as in multiblock configurations  @xcite .",
    "the combined scheme is referred to as sbp - sat . since the original development by kreiss and scherer @xcite for first order derivatives , several contributions have been made to further develop sbp operators ( see eg .",
    "the sbp - sat framework has also been successfully applied to a large range of physical problems , see for example @xcite , resulting in robust discretizations .",
    "originally , the sat treatment has been applied to physical boundaries and to numerical interfaces for which the collocation points in neighboring blocks coincide .",
    "more recently , similar boundary treatments have been used to combine high - order finite difference operators with adaptive mesh refinement @xcite . in this",
    "setting , the computational domain is decomposed into multiple blocks with different refinement level . on each block",
    ", the sbp technique is used for discretization . on boundaries of patches with different refinement , so called nonconforming interfaces , one essentially has two choices to implement the coupling between the blocks . in a continuous formulation the stencil across block - boundaries is modified . in a discontinuous formulation",
    "each patch is discretized separately and penalty terms are added that couple the discretizations across the interfaces . in each case , the interface treatment gets increasingly complicated with the order of accuracy of the method .",
    "mattsson and carpenter @xcite have studied the case of a discontinuous formulation and derived interpolation operators and penalty terms also for high - order methods . however",
    ", they only treat interfaces between two blocks of different refinement levels .",
    "when studying a fully adaptive mesh we will also encounter corner points , i.e. points where two or more interfaces between blocks of different refinement level intersect . treating the corner points in a stable way that does not reduce the overall accuracy of the scheme is a challenging task .",
    "kramer and coworkers @xcite have studied a continuous formulation based on sbp .",
    "they showed how to , in a stable manner , handle edges as well as corners where patches of different refinement level meet .",
    "the stability comes at the cost of a lower accuracy compared to the order of accuracy of the interior stencil .    in this paper , we explain how to handle corner points in a stable way while keeping extra refinements of the mesh to a minimum .",
    "contrary to the approach in @xcite , our study is based on a discontinuous formulation where the sbp - sat interfaces are combined with the interpolation operators derived in @xcite . the key idea of our approach is to allow for junctions where different types of block - boundary treatments are allowed .",
    "we design new , so called sbp - fd junction operators , that allow for a more flexible grid treatment within the sbp - sat framework .",
    "similarly as in @xcite , we sacrify some accuracy in order to obtain a stable discretization .",
    "berger and oliger @xcite developed an approach for structured adaptive mesh refinement ( samr ) , for multiple component grids in a finite difference setting . in their original method ,",
    "the refined regions can be arbitrarily placed and oriented with respect to underlying grid patches .",
    "berger and colella @xcite modified the algorithm such that patches are restricted to be aligned with one another , which significantly simplifies the mesh organization .",
    "although the berger - colella approach is an improvement of the original berger - oliger method perfomance - wise , it still suffers from overhead in the mesh adaptation step  @xcite .",
    "moreover , possibly overlapping patches of arbitrary size and shape result in complex data dependencies in the grid hierarchy , which complicates matters related to parallelization and load balancing on large compute clusters  @xcite .",
    "block - oriented samr ( also referred to as block - based or block - wise samr in the literature ) has been proposed as an alternative to the aforementioned methods of mesh refinement . in this class of methods , the computational domain is decomposed into a hierarchy of non - overlapping grid blocks , where refinement is undertaken with respect to entire grid blocks only . in comparison with the method of berger - colella ,",
    "the overhead associated with grid management is reduced and load balancing becomes a simpler and more straightforward task @xcite .",
    "there are two strategies available for block refinement .",
    "one strategy is to introduce more grid points in the blocks where refinement is needed , keeping the number of blocks constant .",
    "the other strategy is to keep the block size in terms of grid points constant and increase the number of blocks in regions where refinement is needed . in effect , a block that needs refinement is subdivided and replaced by a number of sub - blocks covering the exact same sub - region as the original block , resulting in a finer resolution in that region .",
    "we build our implementation and numerical techniques upon the latter scheme . among the examples of scientific software packages that implement block - oriented amr in this fashion",
    "are paramesh  @xcite and racoon  @xcite .",
    "both of these packages implement a similar refinement scheme and grid organization , where blocks are always subdivided isotropically ( i.e. , uniformly in all dimensions ) . in our approach , we allow for _ anisotropic _ refinement and let blocks be refined in one , a few or all dimensions as required to fulfill the refinement criteria .",
    "we expect the anisotropic grid refinement strategy to become increasingly important as we aim at tackling higher - dimensional problems , since this will keep the number of created blocks to a minimum and thereby reduce the overall memory requirements .    in this paper , we consider the discretization of partial differential equations ( pde ) with first and second order derivatives .",
    "stability analysis and numerical convergence studies are provided for the advection equation and for the free particle schrdinger equation to illustrate the applicability of our approach to different classes of problems . as examples with adaptive refinement , we consider the quantum harmonic oscillator as well as the advection equation .    the article is organized as follows .",
    "section [ gridorganisation ] deals with the hierarchical grid structure .",
    "section [ sec : second ] introduces the discretization for a parabolic problem with second derivatives in space .",
    "the stable treatment of sbp - fd junctions where interfaces of different type meet is devised and the accuracy is discussed . a discretization of a hyperbolic equation with first derivatives on block - oriented grids is the subject of section  [ sec : first ] .",
    "an extensive numerical convergence study for different types of corner points occurring in a block - adaptive grid is provided in section  [ sec : num_convergence ] .",
    "finally , we explain how to automatically adapt the mesh in section  [ sec : adaptivity ] .",
    "numerical examples are presented for the example of the time - dependent schrdinger equation and for the advection equation .",
    "section [ section7 ] gives concluding remarks and an outlook on future work .",
    "we implement a conservative block - oriented refinement scheme that strives to minimize the fan - out of the mesh refinement and avoid wasting memory on unnecessarily fine grid blocks .",
    "meshes are structured such that all blocks represent an equal number of grid points but due to varying refinement they correspond to logical @xmath0-dimensional hyperrectangles ( @xmath0-orthotopes ) of different size . for simplicity of implementation , we restrict the refinement such that two adjoining blocks can differ in refinement ratio by at most a factor @xmath1 in each direction .",
    "grid refinement is carried out block - by - block in an anisotropic manner ( i.e. , blocks do not have to be refined uniformly in all dimensions ) .",
    "this gives us the freedom to refine a block as needed in the dimensions where refinement is required while leaving the block coarser in the other dimensions .",
    "we expect this strategy to generate fewer grid blocks than isotropic refinement and therefore to be more memory efficient",
    ". in higher spatial dimensions , this gain will become increasingly significant , in particular if the solution is elongated or has oscillations in some dimensions only .",
    "upon refinement of a block , the block to be refined is halved in the desired dimension , generating two new blocks that are filled with intermediate data values such that the resulting spatial resolution in that dimension is twice that of the original block . in @xmath0 dimensions ,",
    "this can be generalized to a hyperplane cutting through a @xmath0-orthotope , splitting it in two parts .",
    "a block can be as elongated as is needed , in principle without any restrictions on the ratio between the lengths of its edges .",
    "depending on the properties of the numerical discretization method , however , such restrictions might arise for stability reasons .",
    "the methods we use in this paper do not have any such formal restrictions , but the required time step size will largely be affected by the smallest spatial step size .",
    "we consider the schrdinger equation @xmath2 with initial and boundary conditions . here , @xmath3 denotes a spatially dependent potential operator . since @xmath3 has no impact on the stability analysis ( cf .",
    "@xcite ) , we consider the free particle case , for which @xmath4 . we discretize the pde based on the method of lines . as such ,",
    "we first discretize in space using finite difference methods .",
    "the resulting system of ordinary differential equations is then propagated in time using an approach based on exponential integrators .",
    "the spatial and temporal discretization methods are described below . at the end of sec .",
    "[ sec : accuracy ] , we comment on the case of real second derivatives modeling diffusion .",
    "the spatial discretization is carried out using sbp operators , a finite difference discretization with central difference stencils in the interior and one - sided stencils close to the block boundaries .",
    "note that the boundary stencils are of lower order than the order of the interior scheme . in the multiblock structure",
    "proposed in sec .",
    "[ gridorganisation ] , various types of block boundaries need to be treated . across boundaries between blocks of precisely the same refinement in all dimensions , central finite differences ( c - fd ) can be used .",
    "this is the simplest and most accurate way of discretizing over block boundaries .",
    "however , the arrangement of blocks in the vicinity of such an interface might require sat couplings to be enforced across the boundary in order to preserve stability ( cf .",
    "[ sec : junction ] ) .",
    "grid blocks for which the refinement level along the interface is identical but the refinement level in the dimension perpendicular to the interface differs are coupled using pure sat terms .",
    "if the refinement level along the interface differs , i.e. for nonconforming interfaces , the sat terms are combined with interpolation and projection operators .",
    "the coupling between nonconforming grid blocks is enforced by a combination of sat terms and interpolation and projection operators constructed for sbp operators ( cf .",
    "in order to preserve the stability of the semi - discretization , proper coupling terms can be determined using the energy method . for a more precise description of the semi - discretization for the time - dependent schrdinger equation and the detailed form of the coupling terms leading to a stable semi - discretization on nonconforming grids",
    ", we refer to  @xcite .    as mentioned above , interfaces between blocks of identical refinement are treated either using one - sided stencils and penalty terms ( sbp - sat interface ) , or using c - fd stencils ( fd interface ) .",
    "the sbp - sat framework implies that there are two separate solutions along an interface , one in each block , that are allowed to differ . for fd interfaces on the other hand ,",
    "only one unique solution along the interface is allowed . in our implementation , in order to swiftly be able to alter the representation of an interface , we always keep separate copies of the solution on either side of the interface . by enforcing the values to be equal for both solutions along every fd interface , this will not affect the numerical solution in any way .",
    "since the error constant is smaller for c - fd stencils than for sbp - sat stencils ( cf .",
    "the experiments in sec .",
    "[ sec : ho][sec : mesh_design ] ) , it is reasonable to use fd interfaces whenever possible .",
    "the immediate strategy that comes to mind would be to use fd interfaces for all boundaries between equally refined blocks and sbp - sat interfaces elsewhere .",
    "however , a corner point as the black point in fig .",
    "[ grid2 ] would lead to an asymmetric discretization if treated this way .",
    "adding sbp - sat interfaces between blocks 1 & 2 and 1 & 3 solves this problem but if we further refine block 3 , ending up with the situation in fig .",
    "[ grid4 ] , it is no longer desirable to have an sbp - sat interface between blocks 1 & 2 . in order to enforce an fd interface along this block boundary in a stable manner , we need to take special care of the grid points around the black point in fig .",
    "[ grid4 ] ( and similarly in fig .  [ grid3 ] ) .",
    "we refer to this type of intersection as sbp - fd junctions , and in the following subsection we devise a stable treatment of them .",
    "we consider the semi - discretization of eq .   for the case of fig .",
    "[ grid3 ] and denote the semi - discrete solution in block 1 by @xmath5 , in block 3 by @xmath6 , and the joint solution in blocks 2 and 4 by @xmath7 . in order to obtain a stable semi - discretization",
    "we use the energy method .",
    "we define the scalar product and the norm of vectors @xmath8 , @xmath9 as @xmath10 where @xmath11 denotes the complex conjugate . here , @xmath12 is a diagonal , positive definite operator .",
    "the kronecker product is denoted by @xmath13 and for block @xmath14 we have @xmath15 .",
    "further , we define @xmath16 and @xmath17 of dimension @xmath18 , where @xmath19 is the number of points in the @xmath20-direction for block @xmath14 .",
    "we introduce @xmath21 s that are approximations of second derivatives defined by @xmath22 where @xmath23 , and @xmath24 is positive definite .",
    "the first ( last ) row of the matrix corresponding to the operator @xmath25 ( @xmath26 ) approximates a first derivative .",
    "we use the operators approximating second derivatives developed in @xcite .",
    "since we only consider the coupling at the junction , we have excluded the parts of the operators associated with other boundaries and interfaces .",
    "note that we also need to impose penalty terms between block 3 & 4 due to the sbp - sat interface .",
    "however , we disregard this term in our analysis since it does not interact with the sbp - fd junction .",
    "the approximation of the laplacian is given as the kronecker product @xmath27 .",
    "following the theory in @xcite , we make the following ansatz for our spatial discretization of eq . , @xmath28 & t   \\geq 0 , w(0 ) = w^{(0 ) } , u(0 ) = u^{(0 ) } , v(0 ) = v^{(0)}. \\notag   \\ ] ] by considering an energy estimate , we can derive penalty parameters + @xmath29 and design interpolation operators @xmath30 that ensure a stable and accurate discretization . in order to obtain a bound we will need the following relation , @xmath31 using equation we arrive at the following theorem for the situation in fig .",
    "[ grid3 ] .",
    "[ th : sbp - fd - jct - tdse - eq - ref ] consider the sbp - fd junction discretization for the schrdinger equation - , with operators @xmath32 given by identity matrices and interpolation operators @xmath33 that satisfy eq . .",
    "the sbp - fd junction is stable by the equality @xmath34 for all @xmath35 , if the penalty parameters are chosen as @xmath36    in order to get a stable discretization we use an energy estimate . multiplying equations - with @xmath37 , @xmath38 and @xmath39 from the left , respectively and adding the transposes leads to a symmetric expression of the form @xmath40[c]{$m_4$}}}\\\\ \\multicolumn{3}{c}{0 } & \\multirow{2}{*}{\\begin{picture}(15,23 ) \\put(0,0){\\framebox(15,23)[c]{$m_5 $ } } \\end{picture } } & m_2 & 0\\\\ \\multicolumn{3}{c } { } &   & 0 & m_3\\\\ m_1^*&\\multicolumn{2}{c}{\\text{\\framebox[1.4cm][c]{$m_5^*$ } } } & \\multicolumn{3}{c}{}\\\\ \\multirow{2}{*}{\\begin{picture}(15,23 ) \\put(0,0){\\framebox(15,23)[c]{$m_4^*$ } } \\end{picture}}&m_2^ * & 0 & \\multicolumn{3}{c}{0}\\\\ & 0&m_3^ * & \\multicolumn{3}{c}{}\\\\ \\end{array } \\right ) \\left ( \\begin{array}{c } w_0 \\\\ u_n \\\\ v_n \\\\",
    "( s_w w)_0 \\\\",
    "( s_u u)_n \\\\",
    "( s_v v)_n \\end{array } \\right ) .",
    "\\end{aligned}\\ ] ] here @xmath41 denotes the values of @xmath7 at the interface between blocks 2 & 4 and blocks 1 & 3 and @xmath42 and @xmath43 the values of @xmath5 and @xmath6 at this interface . in order to conserve the energy",
    ", we thus have to cancel out the following terms , @xmath44 in order for the expressions given in eq . - to be zero , we need the interpolation operators @xmath45 to be identity operators . for @xmath46 and @xmath47 in equations eq .  - to be zero , we need @xmath48 moreover , the penalty parameters need to satisfy the relations @xmath49 these equations do not define the penalty parameters in a unique way .",
    "we may choose these parameters in the same way as for a usual sbp - sat - interface @xcite , namely @xmath50 moreover , note that eq .",
    "can be rewritten as eq .  .",
    "thus , @xmath51 to @xmath47 are zero .",
    "integration in time yields the equality in eq . .",
    "we also want to augment the theory to the case with different refinement levels illustrated in fig .",
    "[ grid4 ] . the same ansatz as for the case with a uniform grid is used , we only modify the interpolation operators in eq .  - .",
    "the new operators are denoted @xmath52 and the operators associated with the norms for the refined @xmath5 and @xmath6 are denoted @xmath53 . to obtain a bound we will need the following expression , @xmath54 which is the nonconforming equivalent to eq . .",
    "using the energy technique again we arrive at the following theorem .",
    "[ th : sbp - fd - jct - tdse - diff - ref ] consider the sbp - fd junction - , with operators @xmath32 given by identity matrices and interpolation operators @xmath55 that satisfy eq . .",
    "the sbp - fd junction is stable by the equality @xmath56 for all @xmath35 , if the penalty parameters are chosen as @xmath36    we follow the analysis of the proof of theorem  [ th : sbp - fd - jct - tdse - eq - ref ] .",
    "this leads to the same choice of penalty parameters and the nonconforming equivalent expression of eq .",
    ", given in eq . .",
    "it can easily be verified that eq .",
    "is satisfied if we choose @xmath57 where @xmath58 and @xmath59 are the interpolation operators from fine to coarse and from coarse to fine , respectively , that have been derived in @xcite for sbp - sat - interfaces .",
    "hence , interpolation operators @xmath33 that satisfy eq .",
    "are necessary for a stable discretization . given these stability requirements ,",
    "the operators should be chosen such that the local accuracy of the stencil is preserved . in each point",
    "we want to approximate the value of the function .",
    "the only difficult part is the strip close to the interface where the operators associated with sbp - norms , @xmath60 , differ from the operator associated with the fd - norm , @xmath61 .",
    "we therefore achieve full accuracy and stability when choosing both @xmath62 and @xmath63 or @xmath64 , respectively , to be rows of the identity matrix when we are at points where the operators for two norms are equal .",
    "hence , we only have to study a small strip close to the interface . in the second order case ,",
    "there is only one point where the norms differ , and we do not actually have to interpolate since the @xmath65 in the sbp - norm nicely reflects the fact that we have two copies of the solution on the sbp side while only having one on the fd - side . for higher orders ,",
    "the operators have the structure @xmath66 @xmath67 here , @xmath68 is a @xmath69 matrix for the fourth order case and an @xmath70 matrix for the sixth order case that preserve order two or three , respectively .",
    "similarly , @xmath71 is an @xmath72 matrix for the fourth order case and a @xmath73 matrix for the sixth order case .",
    "the order at the junction needs to be reduced compared to the inner stencil , however the accuracy as for the sbp - approximation close to interfaces can be maintained . the matrix @xmath71 is given in appendix [ appendix_operators ] for sbp operators of fourth and sixth order accuracy .",
    "note that the corresponding matrix @xmath68 can be constructed from eq .  .",
    "further take notice that our interpolation operators couple blocks diagonally across the sbp - fd junction . as an example , consider fig .",
    "[ grid3 ] in which block 1 does not only interact with block 2 but also with block 4 .",
    "it would be preferable from a performance point - of - view ( to minimize block dependencies and communication ) to couple block - wise along the interface .",
    "we have tried to accomplish this but we could then only achieve a first - order accurate coupling at the junction , both for the fourth and the sixth order operators .      for sbp operators , we have to distinguish between the order of accuracy of the inner stencil and the order of accuracy of the stencil close to the boundary .",
    "moreover , we have to consider the accuracy of the sat penalty terms .",
    "let @xmath74 be the order of the inner stencil .",
    "then there is a boundary layer of @xmath75 points where the accuracy of the derivative approximation is only @xmath75 .",
    "let us now analyze the accuracy of the sat terms for the block boundaries .",
    "the structure of the penalty terms given for sbp - fd junctions in - is the same as for boundaries between blocks of different refinement levels .",
    "the interpolation operators have in both cases order @xmath74 for most points and order @xmath75 in the boundary layer .",
    "the analysis is done for equation but the reasoning applies for and as well .",
    "let us consider the first sat term @xmath76 the term in the curly bracket includes the interpolation operator .",
    "hence , the accuracy is of order @xmath74 along the edge , except close to the corner where it is reduced to @xmath75 .",
    "since both @xmath77 and @xmath78 are of order @xmath79 , the convergence order is reduced to @xmath80 close to the junction point .",
    "now , turn to the second penalty term , @xmath81 in this term , the derivative is computed first with an accuracy of @xmath82 and thereafter the interpolation is applied .",
    "this gives an approximation order for the expression in the curly brackets of @xmath75 close to the junction and @xmath82 along the edge .",
    "finally , @xmath77 is applied , reducing the order to @xmath83 or @xmath75 , respectively . as a result of the interpolation",
    ", we get an order reduction of the scheme to @xmath80 at sbp - fd junction points or corners with different refinement levels .    for the solution of the time - dependent problem ( given a sufficiently accurate integration in time )",
    ", we can expect the order of accuracy to be at least @xmath80 , the lowest order present in the complete stencil .",
    "however , the accuracy of the numerical solution is often one or two orders higher than the order of the boundary approximation would suggest @xcite .",
    "it has been shown for the schrdinger equation that two orders are gained for the treatment of outer boundaries in one dimension in @xcite and for interface treatment in one dimension in @xcite .",
    "numerical simulations in two dimensions show the same behavior as the one - dimensional analysis @xcite .",
    "to fully understand the two - dimensional behavior close to corner points and sbp - fd points further analysis needs to be carried out . in numerical simulations",
    "we observe overall higher convergence orders than expected , based on the reasoning in this section in combination with the theory for gaining orders of accuracy in the time propagation @xcite .",
    "note that the number of grid points where the order of accuracy is lowered to @xmath83 or @xmath80 is independent of the grid size .",
    "this fact could explain the higher than expected order of accuracy in the @xmath84 norm .",
    "the problem with decreased order at corner points has also been observed by kramer and co - workers @xcite . for their formulation with continuous stencils for first derivatives ,",
    "they have observed the same maximum accuracy orders for the stencils at corner points as we have for this case . to fully understand the convergence behavior analysis of the full two - dimensional problem needs to be carried out .    to remedy the loss of accuracy we considered constructing interpolation operators of order @xmath82 on a wider boundary layer according to the algorithm outlined in @xcite , but we conclude that no such operators exists as the resulting system of linear equations does not have a solution .    in  @xcite the difference between penalties for the schrdinger equation and the diffusion equation was discussed .",
    "it was pointed out that @xmath85 penalty terms are a necessity for the schrdinger equation due to its non - diffusive character , whereas sat terms for the diffusion equation can be formulated without an @xmath85 term . in applications where the second derivative operator is associated with diffusion ,",
    "such that the @xmath85 terms can be omitted , the lowest order of accuracy will thus be @xmath83 instead of @xmath80 .",
    "after discretization of eq .   in space ,",
    "we are left with the system of ordinary differential equations @xmath86 where @xmath87 is the semi - discrete solution and @xmath88 is the approximated hamiltonian .",
    "if the hamiltonian is independent of time , the solution of can be expressed as @xmath89 in case @xmath88 is time - dependent , one can use the exponential form successively on small time intervals .",
    "instead of using just @xmath88 , one has to take a magnus series expansion to get the exact solution .",
    "for numerical purposes , it suffices to take a truncated expansion ( cf .",
    "@xcite ) .    computing",
    "the exponential of the discrete hamiltonian matrix is a computationally intensive task and direct methods are out of reach for realistic grid sizes . since the matrix @xmath88 is sparse , krylov methods provide an efficient alternative . in case",
    "the matrix is symmetric , one can use the lanczos method .",
    "otherwise , one has to take the arnoldi method which is computationally more intense and has worse scalability properties . for an sbp discretization",
    ", @xmath88 itself is not symmetric .",
    "however , it is symmetric in the norm associated with the sbp operator .",
    "we therefore use the lanczos algorithm and base all norm computations on the sbp norm .",
    "in this section , we consider the advection equation @xmath90 with initial and boundary conditions , as an example of an equation with first derivatives .",
    "again we use the method of lines approach with finite difference methods in space .",
    "we use a fourth order accurate runge - kutta method in time .",
    "the spatial discretization with sbp - sat finite differences is done in a similar way as for the schrdinger equation .",
    "the sbp stencils for the second derivatives are replaced by the corresponding stencils for the first derivatives . here , the sbp - sat boundary treatment becomes simpler since we only need one type of penalty terms that enforces continuity of the solution .",
    "the semi - discretization of eq .",
    "( [ eq : advection_equation ] ) for the sbp - fd junction mesh in fig .",
    "[ grid3 ] reads as follows @xmath91 & t   \\geq 0 ,",
    "w(0 ) = w^{(0 ) } , u(0 ) = u^{(0 ) } , v(0 ) = v^{(0)}. \\notag   \\ ] ] the @xmath92 s are approximations of the first derivative , satisfying the sbp property @xmath93 , @xmath94 .",
    "we have that @xmath95 $ ] , and @xmath96 $ ] .",
    "note that the discretization in eq .  - does not include an @xmath85 penalty .",
    "as a consequence only one order of accuracy is lost at junction- and corner points , i.e. , the total accuracy of the derivative approximation is of order @xmath83 . since this is a discretization of a first derivative , from one - dimensional analysis we only expect to gain one order in the numerical solution with respect to the stencil order @xcite . in the two - dimensional simulations in this paper we see convergence orders that are better , especially in the @xmath84 norm .",
    "the reason for this could be that the number of grid points with lower accuracy is fixed and thus play a less important role as the grid is refined .",
    "two - dimensional analysis is necessary to get the full picture .    a stability estimate for eq .  -",
    "can be derived using the energy method . as in the schrdinger - case",
    "we have omitted penalty terms for exterior boundaries as well as the interface coupling between @xmath5 and @xmath6 .",
    "the stability analysis for the sbp - fd junction with a uniform mesh ( fig .",
    "[ grid3 ] ) yields the following theorem .",
    "[ th : sbp - fd - jct - adv - eq - eq - ref ] consider the sbp - fd junction discretization for the advection equation - , with operators @xmath32 given by identity matrices and interpolation operators @xmath33 that satisfy eq . .",
    "the sbp - fd junction is stable by the equality @xmath97 for all @xmath35 , if the penalty parameters are chosen as @xmath98    we follow the proof for the stability analysis for the schrdinger equation with uniform grid . multiplying equations - with @xmath37 , @xmath38 and @xmath39 from the left and adding the transposes leads to the expression @xmath99[c]{$m_5 $ } } } \\\\",
    "\\multirow{2}{*}{\\begin{picture}(15,23 ) \\put(0,0){\\framebox(15,23)[c]{$m_4 $ } } \\end{picture}}&m_2 & 0 \\\\ & 0&m_3 \\\\ \\end{array } \\right ) \\left ( \\begin{array}{c } w_0 \\\\ u_n \\\\ v_n \\end{array } \\right ) , \\end{aligned}\\ ] ] where @xmath100 assuming that @xmath101 , @xmath102 , @xmath103 are identity matrices .",
    "by using relation @xmath46 and @xmath47 are zero if @xmath104 . with @xmath105 , @xmath106 , @xmath51 , @xmath107 and @xmath108",
    "are zero . by integrating in time",
    "we arrive at eq . .",
    "for the stability analysis of the sbp - fd junction with different levels of refinement ( fig .",
    "[ grid4 ] ) , we arrive at the following theorem .",
    "[ th : sbp - fd - jct - adv - eq - diff - ref ] consider the sbp - fd junction discretization for the advection equation - , with operators @xmath32 given by identity matrices and interpolation operators @xmath55 that satisfy eq . .",
    "the sbp - fd junction is stable by the equality @xmath109 for all @xmath35 , if the penalty parameters are chosen as @xmath98    the proof leading to eq .",
    "follows the proofs for theorem  [ th : sbp - fd - jct - adv - eq - eq - ref ] and theorem  [ th : sbp - fd - jct - tdse - diff - ref ] . with the same choice of penalty parameters as for the situation in fig .",
    "[ grids]b and using relation we arrive at eq .",
    "after integration in time .",
    "we remark that the penalty parameters close to the sbp - fd junction can be used along the rest of the interface as well , as was the case for the schrdinger equation .",
    "this makes the extension to include sbp - fd junctions in an already existing code with sbp - sat interfaces straightforward .",
    "in this section , we provide numerical convergence studies for the free schrdinger equation and the advection equation .",
    "we study the three important cases given by the meshes in fig .",
    "[ grids ] .",
    "we use stencils with inner order two , four , and six .",
    "each experiment starts with a coarse base grid where each block has @xmath110 elements ( refinement level 0 ) . by successive isotropic refinement of the individual blocks in each grid we repeat the experiments up to refinement level 5 ( @xmath111 elements ) .",
    "since we are focusing on the spatial discretization , we use time steps small enough for the temporal error to be negligible compared to the spatial error .      as initial value to eq . with @xmath4",
    ", we use a gaussian , @xmath112 the equation is closed by periodic boundary conditions .",
    "the parameters are chosen as @xmath113 , @xmath114 and the mesh covers the domain @xmath115\\times[-10,10]$ ] .",
    "this means that the wave packet is centered at the corner points marked in black in each respective grid in fig .",
    "[ grids ] .",
    "all three meshes are badly suited for this kind of wave packet since there are difficult grid boundaries and corners right at the top of the function . these examples should be viewed as worst case scenarios to demonstrate the capabilities of our framework , not as good examples of a mesh fitted to such a function .",
    "the simulation time is @xmath116 .",
    "we present the errors and convergence rates compared to an analytical solution @xcite in tables [ tab : schr_example_grid2][tab : schr_example_grid4 ] .",
    "the expected order of accuracy for an interior stencil of order @xmath74 is @xmath75 along edges , and @xmath80 at corner points for a second order derivative approximation .",
    "a general trend in the numerical experiments is that in @xmath117 norm we see a gain of two orders in accuracy compared to the accuracy at corner points . in the @xmath84 norm",
    "the accuracy order is often an additional order higher .",
    "this is probably due to the fact that the accuracy order is lower only in a limited number of points .",
    "the convergence rates are not precise for all cases , which can be explained by the fact that various error terms that converge at different rates are present .",
    "similar behavior was seen in @xcite , where the lowest error terms were dominating only for very fine grids for spatial discretizations of order 6 and 8 .",
    ".convergence for grid fig .",
    "[ grid2 ] for the schrdinger equation ( sec .",
    "[ sec : num_convergence : tdse ] ) .",
    "the number of isotropic refinements done in each block is given in the first column .",
    "[ cols=\"^,^,^,^,^,^ \" , ]",
    "in this section , we discuss how to automatically generate and evolve problem - dependent meshes .",
    "firstly , we explain how we estimate the error in order to have a measure of the quality of a grid . secondly ,",
    "for the advection equation , we compare the quality of a solution on a grid that includes sbp - fd junctions with a simple solution that closes each block with an sbp - sat interface . finally ,",
    "for the schrdinger equation , we show two examples of the solution of a quantum harmonic oscillator , one on a manually created grid and one on an automatically generated mesh .",
    "to adapt a grid to the shape of a solution , we need a measure of the error for a given mesh . for simplicity and efficiency",
    ", we estimate the error at the grid points of the present mesh . note that this can be problematic when the solutions are highly oscillatory . in order to make sure we do not fail to capture oscillations that occur on a scale that is not resolved by the given mesh",
    ", special care has to be taken when choosing the initial mesh .",
    "if the initial mesh fully resolves all the oscillations and we update the mesh in sufficiently close intervals , we will be able to capture emerging oscillations .",
    "we base the error estimate on the residual . in case of an approximate solution that is defined continuously on the whole domain ,",
    "the residual is defined as the difference between the continuous differential operator and the approximate difference operator applied to the approximate solution .",
    "this is possible for finite element approximations where a representation of the approximate solution based on some basis functions is known ( see @xcite ) . in our finite difference",
    "setting , we instead use a better approximation of the operator as a reference .",
    "we compute the residual at point @xmath118 as @xmath119 where @xmath120 denotes an approximation of the ( scaled ) derivative operator of the order in the superscript ( @xmath14 ) in dimension @xmath121 ( one - sided at all the block boundaries ) , @xmath122 the fully discrete solution , and @xmath74 is the order of the inner finite difference stencils used in the simulation .",
    "note that terms including the value ( instead of derivatives ) of @xmath123 may occur when we have a potential operator , @xmath3 , in the schrdinger equation .",
    "however , we do not get any contribution from those terms since the application of the potential operator is  seen pointwise  done without error .",
    "now we want to use the residual error estimator to decide where to refine the grid . for this purpose",
    "we compute the residual block - wise , estimating the block error using the one - sided sbp stencils we have at hand .",
    "observe that in order to estimate the residual error in a block we only need information that is immediately available within that block , with no need for data resident in other blocks .",
    "this is an important aspect in a large scale parallel implementation , since such data dependencies would require communication between processors . in order to be able to decide locally for each block whether or not it should be refined , we use a weighted threshold based on the @xmath84 norm of the residual on each block .",
    "given a global tolerance that the @xmath84 norm of the error on the whole domain shall meet , we allow for a block - wise error according to the block s fraction of the total solution volume .",
    "however , the block - wise computed @xmath84 norm gives a pessimistic estimate for how the error in the derivatives affects the error in the time propagation .",
    "the reason is that we only use one - sided stencils at some block boundaries and in a propagation one can gain up to one ( for first derivatives ) or two ( for second derivatives ) orders of accuracy compared to the order of the discretization at the boundaries .",
    "therefore , we scale the error down by a factor @xmath124 at the points where one - sided differences are applied , where @xmath125 for first derivatives and @xmath126 for second derivatives . moreover , recall that we do not want to refine the blocks isotropically . instead , we always refine in the direction where the error is the largest . for this purpose , we use @xmath127 to estimate the error in dimension @xmath121 .",
    "so far , we have only studied the residual . in @xcite , it is shown for the schrdinger equation how the residual relates to the error due to spatial discretization after time @xmath128 @xmath129 where @xmath130 is the volume of the block that @xmath131 belongs to . in practice , we further discretize in time as well , to obtain @xmath132 where @xmath133 is the number of time steps and @xmath134 are the temporal grid points and the temporal grid size , respectively .",
    "if we want to meet a certain tolerance for the error at time @xmath128 , we have to make sure that the residual in step @xmath135 is less than that tolerance times @xmath136 .",
    "the same estimate applies for the advection equation as long as boundary conditions that ensure time - reversibility and norm conservation are used .        to illustrate the usefulness of the sbp - fd junction treatment we consider the advection equation on a more complex computational domain .",
    "the grid has three different levels of refinement . figs .",
    "[ fig : adv_eq_mesh_naive ] and [ fig : adv_eq_mesh_sbpfd ] illustrate how the meshes are constructed with and without use of the sbp - fd junction technique .",
    "we refer to these meshes as the naive mesh and the sbp - fd junction mesh , respectively .",
    "to numerically solve the advection equation on the naive mesh with the techniques described in this paper it is necessary to introduce sub - domains and sbp - sat interfaces as in fig .",
    "[ fig : adv_eq_mesh_naive ] , whereas the sbp - fd junction mesh has a reduced number of sbp - sat interfaces , see fig .",
    "[ fig : adv_eq_mesh_sbpfd ] .",
    "since the local order of accuracy is decreased in the vicinity of sbp - sat interfaces it should be beneficial to reduce these to a minimum .",
    "also , introducing the extra sbp - sat interfaces as in the naive mesh necessarily increases the number of grid points on the coarsest level of refinement . for these reasons",
    "the use of the sbp - fd junction treatment should yield a more efficient numerical method .",
    "we take @xmath137 in and set the incoming characteristics to zero .",
    "the initial data is given as .",
    "@xmath138 note that the initial data is chosen such that the gradient of the solution is larger where the mesh is finer .",
    "the numerical solution is propagated in time until @xmath139 using fourth order sbp operators to discretize spatial derivatives and the sat terms derived in sec .",
    "[ sec : first ] to couple grid patches together . at exterior boundaries ,",
    "dirichlet conditions are imposed using sat terms at the left and bottom boundaries .",
    "the solution is computed on the naive mesh and the sbp - fd junction mesh and for each mesh the total number of grid points required to obtain relative max errors of @xmath140 and @xmath141 is recorded .",
    "table [ tab : adv_eq_adaptive_mesh ] displays the required number of grid points to achieve the required relative max errors .",
    "as can be seen , the use of the sbp - fd junction treatment reduces the required number of grid points by about @xmath142 . for a computational domain with more refinement levels or more than two spatial dimensions",
    "this indicates that the sbp - fd technique will reduce the number of grid points even more due to reducing the number of sbp - sat interfaces .",
    "lllllll relative max error & no .",
    "grid points ( sbp - fd junction mesh ) & no .",
    "grid points ( naive mesh ) + @xmath141 & 4327&5209 + @xmath143 & 16647&20009 + @xmath144 & 65287&78409 +    [ tab : adv_eq_adaptive_mesh ]      next we study an adaptive discretization of the schrdinger equation . in this example",
    ", we consider a quantum harmonic oscillator , described by @xmath145 with @xmath146 . as initial value",
    "we take a gaussian as given by eq .  , with parameters @xmath147 , @xmath148 , and @xmath149 .",
    "the wave packet has a momentum with a @xmath150 angle to the coordinate axis and is traveling from @xmath151 to @xmath152 .",
    "the mesh is illustrated in fig .",
    "[ fig : example3_mesh ] . after 1000 time steps with a step size of @xmath153 ,",
    "the @xmath84 error compared to an analytical solution @xcite is  @xmath154 .",
    "moreover , we have simulated over a shorter time interval , @xmath155 , on both the grid from fig .",
    "[ fig : example3_mesh ] and the one shown in fig .",
    "[ fig : example3_mesh_b ] .",
    "the only difference between the two meshes is that in mesh [ fig : example3_mesh_b ] , the inner most four - by - four blocks are refined once more . the @xmath84 error on mesh [ fig : example3_mesh_b ]",
    "is @xmath156 and on mesh [ fig : example3_mesh ] it is @xmath157 .",
    "even though the former mesh is finer , the error is larger .",
    "this shows that one should avoid to place sbp - sat interfaces too close to the center of the solution .",
    "morover , the time steps need to be significantly smaller for the experiments on mesh [ fig : example3_mesh_b ] than for the ones on mesh [ fig : example3_mesh ] .",
    "the errors in the central region corresponding to meshes [ fig : example3_mesh ] and [ fig : example3_mesh_b ] are visualized in figs .",
    "[ fig : error_unsymmetric_nt250 ] and [ fig : error_unsymmetric_nt1000 ] , respectively .",
    "consider the example of a free wave packet .",
    "we choose an initial value with parameters @xmath147 , @xmath158 , and @xmath159 in eq .  .",
    "we fix the time step to @xmath160 , perform a simulation over 100 time steps , and set a global tolerance of @xmath161 . in this case , the local residual scaled by the time step needs to be bounded by @xmath162 .",
    "-dimension that is used in the experiment in section  [ sec : mesh_design].,width=211 ]    first , we generate an initial mesh based on the error estimator described in section [ sec : error_estimate ] .",
    "[ fig : example1_mesh ] shows the mesh that is adapted to fit our parameters .",
    "one can see that the mesh fits well with the shape of the wave function : since the function has oscillations in the @xmath20-dimension only , the mesh is anisotropic with higher resolution along the @xmath20-dimension .",
    "computing the hamiltonian applied to the wave packet @xmath163 on the automatically generated grid and comparing with the analytical expression of the second derivative , we get an @xmath84 error of @xmath164 .",
    "hence , the actual error , when the hamiltonian is applied , is a little larger than the tolerance required for the residual on the mesh .",
    "this does not come as a surprise , though , since we have scaled down the comparably large errors at the sbp - sat interfaces when estimating the error in the mesh .",
    "the excerpt of the derivative shown in fig .",
    "[ fig : example1_error2ndder ] illustrates the fact that the largest errors are indeed confined to the sbp - sat interfaces .",
    "next , we propagate in time _ without adjusting the grid _ for the residual of the propagated wave packet . after the 100 time steps ,",
    "the error in the solution at time @xmath165 is @xmath166 .",
    "hence , the global tolerance is met even though we do not check that the tolerance is met on the generated mesh in each time step .",
    "this is possible since the simulation time is rather short such that the solution does not move a lot .",
    "if we want to compute over a larger time interval , we would have to readjust the mesh after a number of steps .",
    "this experiment shows that the error estimation is effective and maybe a bit pessimistic . in this experiment , we have performed a rather large number of iterations in the lanczos method so that the temporal error is insignificant .",
    "if we instead choose the size of the krylov space adaptively with the same tolerance , the error becomes @xmath167 instead .",
    "hence , the temporal error is a little smaller than the spatial one , but of similar order .    .",
    "the figure shows an excerpt from the center of the grid .",
    "one can see that the error is centered around the sat interfaces .",
    "the @xmath168 norm of the error is @xmath169.,width=240 ]",
    "we have presented a prototype implementation of an accurate and stable numerical method for derivative approximation on adaptive meshes . the block adaptivity is organized in a multiblock setting where different blocks can have different refinement levels .",
    "our approach is based on finite differences combined with sbp - sat interface treatment between neighboring blocks with different levels of refinement .",
    "the experiments show that sbp - sat interfaces should be avoided around the maxima of the solution .",
    "we have therefore devised an interpolation procedure that treats junctions of different interfaces , allowing for more flexible grid configurations with a minimum number of sbp - sat interfaces . in our setting , the approximation order is reduced at corner points compared to the interior accuracy . for an interior order of @xmath74 ,",
    "the stencil order along edges is @xmath75 , and the orders at corner points are @xmath83 and @xmath80 for approximations of first and second derivatives , respectively .",
    "however , the global convergence order in time - dependent simulations based on sbp operators is usually higher than the local convergence order at boundaries or interfaces . in simulations we observe an accuracy gain between one and three orders compared to the stencil approximation .",
    "moreover , we present a strategy to estimate the error on a grid and demonstrate that the error estimator is effective .",
    "the authors would like to thank sverker holmgren and gunilla kreiss for valuable insight and discussions .",
    "the design of the interpolation operators is based on a maple sheet by ken mattsson .",
    "the simulations were performed on resources provided by snic - uppmax under projects p2003013 and p2005005 .",
    "the part of @xmath170 around the interface is given by for order 4            appel , d. , petersson , n. a. : a stable finite difference method for the elastic wave equation on complex geometries with free surfaces .",
    ". phys . * 5 * , 84107 ( 2008 ) berger , m. j. , colella , p. , local adaptive mesh refinement for shock hydrodynamics .",
    ". phys . * 82 * , 6484 ( 1989 ) berger , m. j. , oliger , j. : adaptive mesh refinement for hyperbolic partial differential equation .",
    ". phys . * 53 * , 484512 ( 1984 ) carpenter , m. h. , gottlieb , d. , abarbanel , s. : time - stable boundary conditions for finite difference schemes solving hyperbolic systems : methodology and application to high - order compact schemes .",
    ". phys . * 111 * , 220236 ( 1994 ) dreher , j. , grauer , r. : racoon : a parallel mesh - adaptive framework for hyperbolic conservation laws .",
    "parallel computing * 31*(89 ) , 913932 ( 2005 ) ferm , l. , hellander , a. , ltstedt , p. : an adaptive algorithm for simulation of stochastic reaction - diffusion processes . j. comput .",
    "phys . * 229 * , 343360 ( 2010 ) gustafsson , b. : the convergence rate for difference approximations to mixed initial boundary value problems .",
    "math . comp .",
    "* 29 * , 396406 ( 1975 ) gustafsson , b. : the convergence rate for difference approximations to general mixed initial boundary value problems .",
    "siam j. numer .",
    "18 * , 179190 ( 1981 ) kormann , k. : a time - space adaptive method for the schrdinger equation",
    ". tach . rep .",
    "2012 - 023 , department of information technology , uppsala university ( 2012 ) kormann , k. , holmgren , s. , karlsson , h. o. : global error control of the time - propagation for the schrdinger equation with a time - dependent hamiltonian .",
    "j. comput .",
    "* 2 * , 178187 ( 2011 ) kormann , k. and nissen , a. : error control for simulations of a dissociative quantum system . in : g. kreiss ,",
    "p. ltstedt , a. mlqvist , m. neytcheva ( eds . ) numerical mathematics and advanced applications 2009 , pp .",
    "523531 , springer berlin heidelberg ( 2010 ) kozdon , j. e. , dunham , e. m. , nordstrm , j. : simulation of dynamic earthquake ruptures in complex geometries using high - order finite difference methods . j. sci . comput . * 55 * , 92124 ( 2013 ) kramer , r. m. j. , pantano , c. , pullin , d. i. : nondissipative and energy - stable high - order finite - difference interface schemes for 2-d patch - refined grids . j. comput . phys .",
    "* 228 * , 52805297 ( 2009 ) kreiss , h .- o . ,",
    "scherer , g. : finite element and finite difference methods for hyperbolic partial differential equations . in : mathematical aspects of finite elements in partial differential equations ,",
    "95211 . academic press , new york ( 1974 ) lindstrm , j. , nordstrm , j. : a stable and high - order accurate conjugate heat transfer problem .",
    "* 229 * , 54405456 ( 2010 ) macneice , p. , olson , k. m. , mobarry , c. , defainchtein , r. , packer , c. : paramesh : a parallel adaptive mesh refinement community toolkit .",
    "* 126 * , 330354 ( 2000 ) mattsson , k. , carpenter , m. h. : stable and accurate interpolation operators for high - order multi - block finite - difference methods .",
    "siam j. sci .",
    "comput . * 32 * , 22982320 ( 2010 ) mattsson , k. , nordstrm , j. : summation by parts operators for finite difference approximations of second derivatives . j. comput",
    ". phys . * 199 * , 503540 ( 2004 ) meyer , h .-",
    ", munthe , u. , cederbaum , l. s. : the multi - configurational time - dependent hartree approach .",
    "* 165 * , 7378 ( 1990 ) nissen , a. , kreiss , g. , gerritsen , m. : stability at nonconforming grid interfaces for a high order discretization of the schrdinger equation .",
    "comput . * 53 * , 528551 ( 2012 ) nissen , a. , kreiss , g. , gerritsen , m. : high order stable finite difference methods for the schrdinger equation .",
    "* 55 * , 173199 ( 2013 ) rantakokko , j. , thun , m. : parallel structured adaptive mesh refinement . in : r. trobec ,",
    "m. vajteric , p. zinterhof ( eds ) parallel computing , pp.147173 .",
    "springer london ( 2009 ) strand , b. : summation by parts for finite difference approximations for @xmath174 .",
    "j. comput .",
    "phys . * 110 * , 4767 ( 1994 ) svrd , m. , nordstrm , j. : on the order of accuracy for difference approximations of initial - boundary value problems . j. comput",
    "* 218 * , 333352 ( 2006 ) svrd , m. , nordstrm , j. : a stable high - order finite difference scheme for the compressible navier - stokes equations : no - slip wall boundary conditions .",
    "227 * , 48054824 ( 2008 ) tannor , d. j. : introduction to quantum mechanics : a time - dependent perspective . university science book ( 2007 )"
  ],
  "abstract_text": [
    "<S> in this paper , we present a block - oriented scheme for adaptive mesh refinement based on summation - by - parts ( sbp ) finite difference methods and simultaneous - approximation - term ( sat ) interface treatment . since the order of accuracy at sbp - sat grid interfaces is lower compared to that of the interior stencils , we strive at using the interior stencils across block - boundaries whenever possible . </S>",
    "<S> we devise a stable treatment of sbp - fd junction points , i.e. points where interfaces with different boundary treatment meet . </S>",
    "<S> this leads to stable discretizations for more flexible grid configurations within the sbp - sat framework , with a reduced number of sbp - sat interfaces . </S>",
    "<S> both first and second derivatives are considered in the analysis . even though the stencil order is locally reduced close to numerical interfaces and corner points , numerical simulations show that the locally reduced accuracy does not severely reduce the accuracy of the time propagated numerical solution . </S>",
    "<S> moreover , we explain how to organize the grid and how to automatically adapt the mesh , aiming at problems of many variables . examples of adaptive grids are demonstrated for the simulation of the time - dependent schrdinger equation and for the advection equation .    </S>",
    "<S> example.eps gsave newpath 20 20 moveto 20 220 lineto 220 220 lineto 220 20 lineto closepath 2 setlinewidth gsave .4 setgray fill grestore stroke grestore </S>"
  ]
}