{
  "article_text": [
    "detailed observations of the cosmic microwave background ( cmb ) during the last two decades have revolutionized cosmology . through detailed measurements of the angular cmb power spectrum ,",
    "a highly successful cosmological concordance model has been established , stating that the universe is statistically isotropic and homogeneous , filled with gaussian random fluctuations drawn from a @xmath1cdm spectrum , and consists of 4% baryonic matter , 23% dark matter and 73% dark energy ( e.g. , * ? ? ? * and references therein ) . using this model , millions of data points from many different types of cosmological observations",
    "can be fitted with only six free parameters .",
    "this success has been driven primarily by rapid progress in cmb detector technology , allowing experimentalists to make more and more detailed maps of the cmb fluctuations",
    ". however , such maps are imperfect , in the sense that they typically are contaminated by various instrumental effects .",
    "for instance , the optics of a given experiment can be asymmetric ; the detector gain may be unknown and time - dependent ; the data may exhibit resonant frequencies due to electronics or cooling non - idealities ; and the observations are invariably noisy .",
    "all these non - idealities must be properly understood before one can attempt to extract cosmology from the observations .    in this paper",
    "we consider one specific component within this global calibration problem , namely how to estimate the statistical properties of the instrumental noise in light of real - world complications .",
    "this problem has of course already been addressed repeatedly in the literature ( e.g. , * ? ? ?",
    "* ; * ? ? ?",
    "* ) , and our method is in principle similar to that of @xcite , taking a bayesian approach to the problem .",
    "the main difference is that we formulate the algorithm explicitly in terms of a gibbs sampler including both the time stream and the noise parameters as unknown variables , and this has several distinct advantages .",
    "first , it allows us to obtain proper uncertainties on all derived quantities .",
    "second , gap filling is directly supported through built - in proper constrained realizations .",
    "this can for instance be used to account for instrumental glitches in the time stream , or to exclude point sources and other bright sources from the analysis .",
    "third , it is straightforward to add support for additional nuisance parameters , due to the conditional nature of the gibbs sampler . in this paper",
    "we implement template marginalization , which may for instance be useful for removing cosmic ray glitches in the planck hfi data @xcite or ground pickup for ground based experiments ( e.g. , * ? ? ?",
    "we also outline the formalism for marginalization over cmb fluctuations , which may be relevant for experiments with high signal - to - noise ratio .",
    "the method presented here is mathematically identical to the cmb gibbs sampling framework developed by @xcite , and the main difference is simply that the object under consideration is a one - dimensional time stream instead of a two - dimensional field on the sphere .",
    "this makes the implementation considerably simpler , and the run times correspondingly faster . as a demonstration of the practicality of the method",
    ", we apply it to simulated data with properties typical for current ground - based experiments , and demonstrate explicitly that the computational costs of the method are tractable .",
    "the experiment of choice will be @xcite , for which this method was initially developed .",
    "the first step of any bayesian analysis is to write down an explicit parametric model for the observations in question . in this paper , we start with the assumption that the output , @xmath2 , from a given detector can be written in terms of the following sum , @xmath3 here each term indicates a vector of @xmath4 values sampled regularly in time in steps of @xmath5 , that is , @xmath6 with @xmath7 .    the first term on the right - hand side , @xmath8 , indicates the instrumental noise , which is our primary target in this paper .",
    "all the other components are only nuisance variables that we want to marginalize over .",
    "we assume that the noise is gaussian distributed and stationary over the full time range considered . in practice",
    "this means that the full data set of a given experiment should be segmented into parts which are individually piecewise stationary . for quiet",
    "this corresponds to division into so - called `` constant elevation scans '' @xcite , while for planck it corresponds to division into so - called `` rings '' , which are one - hour observation periods with a fixed satellite spin axis @xcite .",
    "because the noise is assumed stationary , the time - domain noise covariance matrix , @xmath9 , depends only on the time lag between two observations , @xmath10 : it is a toeplitz matrix , and may therefore be well approximated in fourier domain with a simple diagonal matrix , @xmath11 . here",
    "@xmath12 is the fourier - domain noise power spectrum , which is given by the fourier transform of @xmath13 .",
    "our main task is to estimate @xmath12 , and we do so in terms of a parametrized function . for many experiments this function",
    "is well approximated by a so - called @xmath0 profile , @xmath14\\end{aligned}\\ ] ] which describes a sum of a correlated and an uncorrelated noise component in terms of three free parameters .",
    "the white - noise rms level , @xmath15 , defines the overall amplitude of the noise ; the knee frequency , @xmath16 , indicates where the correlated and the uncorrelated components are equally strong , and @xmath17 is the spectral index of the correlated component .",
    "collectively , we denote @xmath18 by @xmath19 .",
    "of course , other parametrizations may easily be implemented if necessary .",
    "the second term on the right - hand side , @xmath20 , indicates the contribution from the cmb sky , with @xmath21 being a pointing matrix , typically equal to zero everywhere except at @xmath22 if the detector points towards pixel @xmath23 at time @xmath24 , and @xmath25 is the true ( beam convolved ) cmb signal .",
    "we make the usual assumption that @xmath26 is isotropic and gaussian distributed with a given angular power spectrum , @xmath27 . in this paper",
    ", we will simply outline the formalism for how to deal with this term , and leave the implementation for a future paper dedicated to planck analysis ; as mentioned in the introduction , this machinery was initially developed quiet , which is strongly noise dominated for a single data segment , and the cmb component is therefore not important , as will be explicitly demonstrated in this paper .",
    "the third term is a sum over @xmath28 time - domain templates .",
    "these can be used to model several different types of nuisance components .",
    "three examples are diffuse foregrounds and cosmic ray glitches for planck , and ground pick - up for quiet . in either case , we assume in this paper that the template itself is perfectly known , and the only free parameter is an overall unknown multiplicative amplitude @xmath29 .",
    "this is a vector of length @xmath28 , and @xmath30 is the two - dimensional @xmath31 matrix listing all templates column - wise .    finally , the fourth term on the right - hand side of equation  [ eq : model ] denotes a time - domain mask , @xmath32 .",
    "this is implemented by a `` gaussian '' component having zero variance for samples that are not masked , and infinite variance for samples that are masked .",
    "in order to make analytic calculations more transparent , we write the the corresponding covariance matrix as a diagonal matrix with elements @xmath33 where @xmath34 and @xmath35 .",
    "a typical application of this component is to remove periods of instrumental glitching , or to discard particularly bright observations when the telescope points towards bright astrophysical sources , such as point sources or the galactic plane .",
    "our primary goal is now to map out @xmath36 , the noise spectrum posterior distribution marginalized over all nuisance components . by bayes theorem",
    "this distribution reads @xmath37 where @xmath38 is the likelihood , @xmath39 is a prior on @xmath19 , and @xmath40 is an irrelevant normalization constant .    in this paper",
    "we adopt for simplicity uniform priors on @xmath15 , @xmath17 and @xmath16 . for typical relevant time series which contain @xmath41 samples , these parameters",
    "are usually strongly data - driven , and the choice of priors is therefore irrelevant . however ,",
    "if an informative prior ( or the jeffreys prior ) is desired for a given application , it is straightforward to include this as indicated by equation  [ eq : posterior ] .",
    "since we assume that the noise is gaussian distributed with covariance @xmath42 , the likelihood is given by @xmath43 where @xmath44 is the noise component of the data stream.the goal is to compute this distribution , marginalized over @xmath26 and @xmath45 , while at the same time taking into account possible gaps in the data .    the latter point touches on an important computational issue",
    "if there are no gaps in the data , then @xmath9 is a toeplitz matrix , and multiplication with @xmath9 is performed most efficiently in fourier space .",
    "however , the same does not hold if there are gaps in @xmath2 , since the symmetry of @xmath9 is broken .",
    "the well - known solution to this problem is to fill the gap with a constrained noise realization with the appropriate spectrum ( e.g. , * ? ? ?",
    "* ) . in our formulation , this is equivalent to estimating @xmath8 jointly with @xmath19 .",
    "more generally , we want to estimate the joint density @xmath46 , from which any desired marginal may be obtained . at first sight",
    ", this appears like a formidable computational problem , involving more than @xmath47 free parameters .",
    "however , this is also a problem that may be tackled by means of the statistical technique called gibbs sampling , which has already been described in detail for computing the cmb angular power spectrum with contaminated data by @xcite .    according to the theory of gibbs sampling , samples from a joint distribution",
    "may be obtained by iteratively sampling from each corresponding conditional distribution . for our case",
    ", this leads to the following sampling scheme , @xmath48 the symbol @xmath49 indicates sampling from the distribution on the right - hand side . with this algorithm",
    ", @xmath50 will be drawn from the correct joint distribution .",
    "note that each of the sampling steps that involve time - domain vectors are joint steps including the noise component itself .",
    "this approach is highly computationally advantageous as it allows for fast multiplication with @xmath9 in fourier domain ; conditional algorithms for sampling each component separately would require slow convolutions in time domain .",
    "of course , it is fully acceptable within the gibbs sampling machinery to sample some components more often that others .",
    "note also that if we are only interested in the joint maximum - posterior parameters , we can replace the relevant steps in the above algorithm by a maximization operation , such that we maximize the conditional instead of sampling from it .",
    "the algorithm then reduces to a typical iterative approach , but formulated in a convenient and unified statistical language .",
    "the advantage of this approach is computational speed , while the disadvantage is the loss of information about uncertainties .",
    "both versions of the algorithm will be implemented and demonstrated in the following .",
    "equations  [ eq : n][eq : theta ] defines the high - level algorithm in terms of conditional sampling steps . to complete the method",
    ", we have to establish efficient sampling algorithms for each conditional distribution .",
    "perhaps the most fundamental conditional distribution in the sampling scheme outlined above is @xmath51 .",
    "this describes the distribution of the noise parameters given perfect knowledge about all components of the data . to obtain an explicit expression for this distribution",
    ", we first note that @xmath52 ; if we know the true noise component , @xmath8 , no further information about either the cmb signal , the template amplitudes , or , indeed , the actual data is needed in order to estimate the noise parameters .",
    "the expression for the conditional distribution @xmath53 is then formally the same as that for @xmath36 given by equations  [ eq : posterior ] and [ eq : likelihood ] .",
    "writing this out in fourier space for the @xmath0 profile discussed in section  [ sec : model ] , one finds the following explicit distribution for @xmath54 , @xmath55.\\end{aligned}\\ ] ] here @xmath56 are the power spectrum components of the data @xmath8 , while @xmath57 is the covariance matrix which in fourier space is diagonal and given by equation  [ eq : nnu ] .",
    "the first term on the right - hand side is a user - defined prior .",
    "to sample from this distribution , we use a standard metropolis sampler with a gaussian proposal density ( e.g. , * ? ? ?",
    "each chain is initialized at the maximum - posterior point , which is found by a non - linear quasi - newton search , and the covariance matrix of the gaussian proposal density is taken to be the square root of the curvature matrix , evaluated at the maximum - posterior point .",
    "the elements of the inverse curvature matrix , @xmath58 , read @xmath59.\\end{aligned}\\ ] ]    we have found that this proposal density leads to a markov chain correlation length of about 20 samples for typical parameter values , and we therefore thin our chains by this amount .",
    "in addition , we remove a few post - thinned samples at the beginning of the chain to remove potential burn - in , although we have never seen evidence of any such effects . finally , if we only want to find the maximum - posterior point , and not run a full - blown gibbs chain , as discussed in section  [ sec : posterior ] , we terminate the process directly after the initial quasi - newton search .",
    "next , we need to establish a sampling algorithm for @xmath60 , where the residual @xmath61 .",
    "note that @xmath62 and @xmath8 differ only by @xmath32 , which represents contaminated segments of data that are masked out .",
    "the problem is therefore reduced to sampling the components of a sum of gaussians given the sum itself .",
    "this may be achieved efficiently by solving the equation @xmath63{\\mathbf{n}}&= { \\mathbf{m}^{-1}}{\\mathbf{r}}+ { \\mathbf{n}}^{-\\frac12}{\\mathbf{v}}+ { \\mathbf{m}}^{-\\frac12}{\\mathbf{w}}\\label{eq : gapdraw}\\end{aligned}\\ ] ] for @xmath8 , where @xmath64 and @xmath65 are vectors of standard @xmath66 gaussian random variates ( e.g. , * ? ? ? * ; * ? ? ?",
    "* ; * ? ? ?",
    "the matrices involved here are typically of the order @xmath67 , so the equation can not be solved by brute force .",
    "but since @xmath68 is diagonal in time domain and @xmath9 is diagonal in frequency domain ( due to its toepliz nature ) , all multiplications are cheap in either time or fourier domain , and the equation can be efficiently solved with the conjugate gradients method , properly changing basis as needed .",
    "however , there is one practical complication involved in equation  [ eq : gapdraw ] : since we intend to let @xmath69 and @xmath34 , the matrix @xmath70 becomes infinitely poorly conditioned",
    ". we can solve this problem , as well as significantly simplifying the equation , by splitting it into one equation for the masked region , and one for the unmasked region . introducing the notation @xmath71 and @xmath72 for the unmasked and masked subsets of a vector @xmath73 respectively",
    ", we find @xmath74 which in the limit @xmath75 , @xmath76 simplifies to @xmath77 note that equations  [ eq : crfinal1][eq : crfinal2 ] form an asymmetric equation system[eq : crfinal2 ] can be rewritten as @xmath78 = \\left[\\begin{array}{c } { \\mathbf{r}}_1 \\\\ ( n^{-\\frac12}{\\mathbf{v}})_2 \\end{array}\\right]\\]]this is asymmetric because we multiplied the unmasked part of the equation by @xmath79 in order to get a finite result . ] . the conjugate gradients method is therefore not directly applicable , and the more general biconjugate gradients method must be used instead .",
    "we found a simple diagonal preconditioner with value @xmath80 inside the mask and value 1 outside it to be sufficient .",
    "the sampling algorithms described in sections [ sec : noise_estimation ] and [ sec : gap_filling ] defines the core noise gibbs sampler , and together form a well - defined and complete noise estimation algorithm for low signal - to - noise data with gaps . however , one of the main advantages of the gibbs sampling algorithm compared to other alternatives is its natural support for marginalization over nuisance parameters . in this section",
    "we describe the sampling algorithm for marginalization over fixed time - domain templates , describing for instance ground pickup , diffuse foregrounds or cosmic ray glitches .",
    "first , we note that while the original data stream , @xmath2 , may contain gaps , and the toeplitz nature of the noise covariance matrix is in that case broken , the constrained realization produced in section  [ sec : gap_filling ] restores the toeplitz symmetry .",
    "it is therefore computationally advantageous to use @xmath81 as the data in this step that only uses the non - masked data directly , but this would require heavy time - domain convolutions , and not take advantage of the symmetries inherent in the noise covariance matrix .",
    "] , so that @xmath82 .    starting with equation  [ eq : likelihood ] , solving for @xmath45 and completing the square in the exponential , the appropriate conditional distribution for @xmath45 is found to be the well - known distribution @xmath83 where @xmath84 ; that is , @xmath85 is a gaussian distribution with mean @xmath86 and covariance @xmath87 . the same result has been derived for numerous other applications , one of which was described by @xcite , outlining template amplitude sampling with cmb sky map data .    sampling from this distribution is once again straightforward . if one only wish to marginalize over a small number of templates , the easiest solution is simply to compute both @xmath86 and @xmath88 by brute - force , and let @xmath89 , where @xmath90 is the cholesky factor of @xmath91 , and @xmath92 is a vector of uncorrelated standard gaussian @xmath66 variates . on the other hand ,",
    "if there are more than , say , 1000 templates involved , it may be faster to solve the following equation by conjugate gradients , @xmath93 where @xmath94 is a full time - stream of @xmath66 random variates . in this paper , which has the quiet experiment as its main application",
    ", we only use the former algorithm ; for planck the latter algorithm may be useful in order to account for frequent and partially overlapping cosmic ray glitches efficiently .",
    "most cmb experiments are strongly noise - dominated within relatively short time periods , and need to integrate over the sky for a long time in order to produce high - sensitivity maps .",
    "for instance , for the first - season quiet experiment the mean polarized sensitivity of a detector was 280@xmath95 @xcite , while the polarized cmb sky has an rms of @xmath96 on the relevant angular scales .",
    "in such cases , it is an excellent approximation simply to ignore the cmb contribution when estimating the noise parameters .",
    "however , this approximation does not hold for all experiments , and one particularly important counterexample is planck .    in order to marginalize over the cmb signal we need to be able to sample from @xmath97 , where the residual is @xmath98 .",
    "this is again a case that involves sampling terms of a gaussian sum given the sum itself .",
    "the only difference from section  [ sec : gap_filling ] is that a projection operator is involved in this case , @xmath99 here @xmath64 and @xmath65 are vectors of standard normal samples in pixel and time domain respectively .",
    "note that @xmath68 is not involved this time , so the expression can be used as it is .",
    "as before , multiplications involving @xmath9 are efficient in fourier space due to the toeplitz nature of @xmath9 , but the cmb signal covariance , @xmath100 , will in general be dense , depending on the true cmb power spectrum .",
    "this makes this method prohibitively expensive for general asymmetric scanning strategies .",
    "there are , however , circumstances for which also this multiplication becomes efficient .",
    "one obvious case is that of full sky coverage , where a change to spherical harmonic basis makes @xmath100 diagonal .",
    "lccc gaps only & @xmath101 & @xmath102 & @xmath103 + gaps + uncorrected cmb & @xmath101 & @xmath102 & @xmath103 + gaps + uncorrected ground pickup & @xmath104 & @xmath105 & @xmath106 + gaps + corrected ground pickup & @xmath101 & @xmath102 & @xmath103 + gaps only & @xmath107 & @xmath108 & @xmath109 + gaps + uncorrected cmb & @xmath107 & @xmath110 & @xmath111 + gaps + uncorrected ground pickup & @xmath112 & @xmath113 & @xmath114 + gaps + corrected ground pickup & @xmath107 & @xmath115 & @xmath116    more interestingly , @xmath100 also becomes diagonal when expressed in fourier basis on a circle on the sky . to see this ,",
    "consider a circle with radius @xmath19 on the sphere , parametrized by the angle @xmath117 .",
    "the covariance between the points @xmath118 and @xmath119 with angular distance @xmath120 is given by the two - point correlation function : @xmath121 since @xmath122 for the case of a circle only depends on @xmath123 , and is independent of @xmath117 itself , @xmath124 is a toepliz matrix , and is therefore diagonal in fourier space .",
    "this is highly relevant for planck , since the planck scanning strategy @xcite naturally divides into scans of circles .",
    "therefore , in this case sampling @xmath125 can be done at very low extra cost .",
    "in this section we demonstrate the noise gibbs sampler as described in section  [ sec : algorithm ] on a particular type of quiet simulations .",
    "quiet is a radiometer - based cmb b - mode polarization experiment located in the atacama desert @xcite , which took observations from august 2008 to december 2010 .",
    "the first results were based on only nine months worth of data , and yet already provided the second most stringent upper limit on the tensor - to - scalar ratio , @xmath120 , to date based on cmb polarization measurements .    in its normal mode of operation , quiet observed four separate cmb fields on the sky which were each chosen because of their low foreground levels . in this mode ,",
    "the experiment is totally noise dominated on time scales of an hour or less , with a mean polarized sensitivity per detector diode of 280@xmath95 @xcite .",
    "however , quiet also observed two galactic patches , one of which was the galactic center , as well as several bright calibration objects , such as the moon , tau alpha and rcw38 .",
    "these sources are bright enough to be seen visually in each detector time stream , and they can therefore bias any noise estimates unless properly accounted for .",
    "such objects also complicate automated data selection processes , since it is difficult to distinguish between an astrophysical object and an instrumental glitch .    in this section",
    "we show how the algorithm developed in section  [ sec : algorithm ] may be applied to such situations .",
    "specifically , we consider a observing session lasting for about 40 minutes of a field including a bright source with known location , and assume that the data may be modeled as @xmath126 . here",
    "@xmath30 is a single template describing possible sidelobe pick - up from the ground , constructed from the full observing season as described by @xcite , and @xmath32 is a time - domain mask that removes any samples that happen to fall closer than @xmath127 from the source center .",
    "the total number of samples in the data stream is 60949 , and the total number of masked samples is 651 .",
    "the simulations used in this section are constructed as follows .",
    "we set up an ensemble of @xmath128 time streams containing correlated gaussian random noise with @xmath129 , @xmath130 and @xmath131 ; the white noise and spectral index are representative for a quiet detector , while the knee frequency is grossly exaggerated to push the algorithm into a difficult region of parameter space , as well as to more clearly visualize the outputs of the algorithm .",
    "a far more reasonable value for quiet is @xmath132 , and we have of course verified that the algorithm also works for such cases .",
    "further , it reaches convergence faster in that case than with the extreme value of @xmath133 used in the present simulations .      before considering the statistical properties of the resulting posterior distributions ,",
    "it is useful to look visually at a few constrained realizations in order to build up intuition about the algorithm . in order to highlight the behavior of the constrained realizations , we make two adjustments to the above simulation procedure for this case alone : first ,",
    "we replace the tuned mask with a wide 6000-sample mask , covering the entire time range in which the source is visible , and second , we make the correlated noise component stronger by setting @xmath134 , @xmath135 and @xmath136 .",
    "the results are shown in figure  [ fig : constrained_realizations ] .",
    "the raw data are shown in the solid black line , and the vertical dashed lines indicate the extent of the gap . the colored curves within the gap shows 5 difference constrained realizations ; note that together with the black solid curve outside the mask , any of these form a valid noise realization with the appropriate noise power spectrum as defined by @xmath15 , @xmath17 and @xmath16 .",
    "they are each a valid sample drawn from @xmath137 . however ,",
    "if one had tried to estimate the noise spectrum also using the data inside the gap , the source signal ( seen as sharp spikes in figure  [ fig : constrained_realizations ] ) would bias the resulting noise parameters .    in this paper , we consider the constrained realizations primarily to be a useful tool that allows for fast noise covariance matrix multiplications in fourier space .",
    "however , these constrained realizations can of course also be useful in their own right , for instance for deglitching a time stream before map making .",
    "we now seek to statistically validate our algorithms and codes .",
    "both the posterior maximization and the gibbs sampling algorithms are considered .",
    "the number of simulations are 10000 for posterior maximization and 5000 for gibbs sampling , with properties as described above . in each case , we consider four different models .",
    "first , we analyze simulations including only noise and gaps .",
    "second , we add a cmb signal to each realization , but do not attempt to correct for it .",
    "third , we add a strong ground template to each realization , and do also not attempt to correct for it .",
    "fourth , we analyze the same ground - contaminated simulations as above , but this time do marginalize over an appropriate template .",
    "the same random seeds were used in each of the four simulation and analysis results , in order to allow for direct comparison of results between runs .",
    "the results from this exercise are summarized in table  [ tab : results ] , and histograms for the first case are shown in figure  [ fig : biastest1 ] .",
    "first , the the upper section in table  [ tab : results ] lists the mean and standard deviation of the recovered parameters for the posterior maximization algorithm . recall that the input parameters were @xmath138 , and",
    "these are recovered perfectly in all cases , except for the one involving an uncorrected ground template , as expected .",
    "second , in the bottom half we show the results from the gibbs sampling analyses , but this time in terms of normalized parameters on the form @xmath139 , where @xmath140 and @xmath141 are the mean and standard deviation of the gibbs chain for a given parameter ( removing the first 10% of the samples for burn - in ) , and @xmath142 is the true input value . if the gibbs chain is both unbiased and has the correct dispersion , @xmath120 should be gaussian distributed with zero mean and unit variance . as seen in table  [ tab : results ] , this is indeed the case .",
    "we also note that adding a cmb component to these simulations do not bias the noise estimates , simply because the cmb is too weak to be detected on the time scales considered here .",
    "this confirms the assumption made by the quiet team when estimating their noise properties : the quiet observations are sufficiently noise dominated on a one - hour time scale that the cmb can be safely neglected for noise estimation purposes .      to be practical ,",
    "it is not sufficient that a method is robust and accurate , but it must also be computationally efficient . for the present algorithm the two most important parameters for computational speed are 1 ) the total number of samples in the time stream , @xmath4 , and 2 ) the number of masked samples , @xmath143 , while also the relative position of the masked samples play an important role .    in figure  [",
    "fig : cputime ] we show the scaling of each of the two algorithms ( posterior maximization and gibbs sampling ) as a function of both @xmath4 ( left panel ) and @xmath143 ( right panel ) . in the left plot , @xmath143 was fixed at 1000 , divided into ten gaps of 100 samples each , and only the total length of the data stream was varied . in this case , we should expect the scaling of the overall algorithm to be dominated by fourier transforms , suggesting an overall behavior given by @xmath144 .",
    "as seen in figure  [ fig : cputime ] , this approximation holds to a very high degree , both for posterior maximization and gibbs sampling .",
    "further , we see that the cpu time required to analyze a single 100000 sample data set with 1000 samples removed is 3 seconds for posterior maximization and 21 seconds for gibbs sampling .",
    "in the middle panel , we fix @xmath4 at 100000 , and increase @xmath143 by varying the number of gaps , each extending 100 samples . perhaps somewhat surprisingly , we see that the computing time in this case is nearly independent of @xmath143 .",
    "the reason for this is simply that the number of conjugate gradient iterations required for the gap filling procedure is largely determined by condition number ( ie .",
    ", the ratio between the highest and smallest eigenvalue ) of the covariance matrix of a single gap . having more gaps",
    "separated by more than one time - domain correlation length effectively corresponds to performing multiple matrix inversions in parallel , and the net cost therefore do not increase significantly .    in the third panel",
    ", we increase @xmath143 by making one gap larger , as opposed to adding many small gaps . in this case",
    "the cpu time does increase dramatically , because it becomes increasingly hard for the algorithm to fill the missing pieces of the data stream . in this case , the noise covariance matrix condition becomes larger and larger .",
    "we have described and implemented a bayesian framework for estimating the time - domain noise power spectrum for non - ideal cmb experiments . this framework is conceptually identical to a previously described method for estimating the angular cmb power spectrum from cmb sky maps @xcite , and relies heavily on the gibbs sampling algorithm .",
    "the single most important advantage of this method over existing competitors in the literature derives from the conditional nature of the gibbs sampler : additional parameters may be introduced _ conditionally _ into the algorithm .",
    "this allows for seamless marginalization over nuisance parameters , which otherwise may be difficult to integrate .",
    "a second important advantage of the method is the fact that it provides proper uncertainties on all estimated quantities , which at least in principle later may be propagated into final estimates of the uncertainties of the cmb sky map and angular power spectra .    in this paper",
    "we implemented support for two general features that are useful for analysis of realistic data , namely constrained realizations and template sampling .",
    "the former is useful whenever there are gaps in the data , for instance due to an instrumental glitch , or there are strong localized sources in the sky that may bias the noise estimate : in these cases , the gaps are refilled with a constrained noise realization with the appropriate noise parameters , such that the full time stream represents a proper sample from a gaussian distribution with a noise covariance matrix , @xmath9 .",
    "since the time stream no longer contains gaps , the toeplitz symmetry of the noise covariance matrix is restored , and matrix multiplications may be performed quickly in fourier space .    the second operation , template sampling , is also a powerful and versatile technique for mitigating systematic errors . in this paper",
    "we mostly focused on data from the quiet experiment , for which ground pickup from sidelobes is one significant source of systematics @xcite . in a future publication",
    "we will apply the same method to simulations of the planck experiment , for which cosmic ray glitches is an important source of systematic errors . as detailed by @xcite",
    ", these cosmic rays may be modeled in terms of a limited set of time domain templates , and the algorithms presented in this paper should therefore prove useful for mitigating the effects of these glitches , as well as for propagating the corresponding uncertainties into the final noise spectrum parameters .",
    "we thank the quiet collaboration for stimulating discussions .",
    "the computations presented in this paper were carried out on titan , a cluster owned and maintained by the university of oslo and notur .",
    "this project was supported by the erc starting grant stg2010 - 257080 .",
    "some of the results in this paper have been derived using the healpix @xcite software and analysis package ."
  ],
  "abstract_text": [
    "<S> we describe a bayesian framework for estimating the time - domain noise covariance of cmb observations , typically parametrized in terms of a @xmath0 frequency profile . </S>",
    "<S> this framework is based on the gibbs sampling algorithm , which allows for exact marginalization over nuisance parameters through conditional probability distributions . in this paper </S>",
    "<S> we implement support for gaps in the data streams and marginalization over fixed time - domain templates , and also outline how to marginalize over confusion from cmb fluctuations , which may be important for high signal - to - noise experiments . as a by - product of the method , </S>",
    "<S> we obtain proper constrained realizations , which themselves can be useful for map making . to validate the algorithm </S>",
    "<S> , we demonstrate that the reconstructed noise parameters and corresponding uncertainties are unbiased using simulated data . </S>",
    "<S> the cpu time required to process a single data stream of 100000 samples with 1000 samples removed by gaps is 3 seconds if only the maximum posterior parameters are required , and 21 seconds if one also want to obtain the corresponding uncertainties by gibbs sampling . </S>"
  ]
}