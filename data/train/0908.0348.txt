{
  "article_text": [
    "graph theory has been used to describe a vast array of real - world phenomena , but only recently the attention has shifted from binary to weighted graphs , from both an empirical @xcite and a theoretical perspective @xcite .",
    "the empirical literature has come up with a number of robust stylized facts that apply to a wide range of phenomena as different as internet traffic , airport connections , and international trade . in particular",
    ", it has been demonstrated that weighted graphs display ( i ) a power law connectivity distribution @xmath0 , with finite size truncation @xcite ; ( ii ) a skewed distribution of link weights @xmath1 and node strengths measured as the sum of the weights of the links of a given node @xmath2 @xcite ; ( iii ) a power - law relation between node strength @xmath3 and node degree @xmath4 : @xmath5 , with @xmath6 ranging between 1.3 and 1.5 @xcite .",
    "in this paper we present a simple stochastic model of proportionate growth of both the number and the weight of links to describe the structure and evolution of weighted networks and account for above mentioned regularities . in our setup we extend the barabsi and albert ( ba ) model @xcite to accommodate _ weighted _ network dynamics .",
    "this is done exploiting the theoretical framework recently put forward by stanley and co - authors to explain the scaling distribution of fluctuations in complex systems @xcite .",
    "we test our model using data on the network of international trade flows , which is a prototypical example of a real - world network that is inherently weighted .",
    "international trade flows have been traditionally analyzed in the contest of the so - called gravity model @xcite that relates bilateral flows to countries size and distance .",
    "however , one of the main limits of this approach is its inability to capture the large fraction of zeros existing in the matrix of bilateral links .",
    "although this has recently been addressed in the context of standard economic theory @xcite , graph theory as been applied to naturally accommodate this feature of the data .",
    "we selected the international trade network ( itn ) as a testbed for our model based on the following considerations .",
    "first , the itn has been already extensively investigated @xcite , and previous works on the itn provide us with a rich set of empirical regularities .",
    "thus , we know that the link weight distribution assumes a log - normal form in the case of the itn @xcite , whereas their growth rates display fat tails @xcite .",
    "second , the relationship between node strength and degree is crucial in the economic literature about itn since it is related to the interplay between intensive and extensive margins of trade , which is key to explain trade flows @xcite . , whereas the intensive margin represents the amount shipped per product per country @xmath7 . ]",
    "third , despite the structural inertia of the itn , the huge volatility of trade flows after the 2008 global financial crisis has recently attracted a great deal of attention .",
    "our theoretical framework provides an explanation for the relationship between node centrality and the variance of network flows .",
    "the paper is organized as follows .",
    "section [ sec : model ] presents the model and its most important predictions .",
    "we then test our model using data on the itn ( section [ sec : emp ] ) and simulations ( section [ sec : sim ] ) .",
    "finally , in the last section we lie down some conclusions and outline possible patterns for future research .",
    "barabsi and albert @xcite have proposed a simple stochastic model of network growth based on preferential attachment which accounts for many of the stylized facts observed in real - world networks .",
    "the increasing interest in the study of _ weighted _ versions of networks calls for an extension of the original ba model to account for the large degree of heterogeneity across link weights @xcite .",
    "the route we take here exploits the theoretical framework recently put forward by stanley and co - authors @xcite to deal with the growth dynamics of complex systems .",
    "we prove that our model is capable to accurately match the structural properties that characterize a number of real - world weighted networks .",
    "we therefore propose a generalized version of the ba model to describe the dynamic and growth of weighted networks , by modeling them as a set of links of different weight occurring among nodes .",
    "in particular , we assume that the weight of links grows according to a geometric brownian motion ( also known as gibrat s _ law of proportionate effects _",
    "@xcite ) , so that the expected value of the growth rate of link weights is independent of their current level .",
    "the key sets of assumptions in the model are the following @xcite :    1 .",
    "the network begins at time @xmath8 with @xmath9 nodes each with a self loop . at each time step @xmath10 ,",
    "a new link among two nodes arises : thus the number of links ( excluding self - loops which are used only for initialization ) existing at time @xmath11 is @xmath12 .",
    "we write @xmath13 for the number of links of node @xmath14 at time @xmath11 ( node degree ) . to identify the nodes connected by the newly formed link at time @xmath11 we adopt the following procedure : with probability @xmath15 the new link is assigned to a new source node , whereas with probability @xmath16 it is allocated to an existing node @xmath14 . in the latter case ,",
    "the probability of choosing node @xmath14 is given by : @xmath17 .",
    "edge endpoints @xmath14 and @xmath18 of the new link are chosen symmetrically with @xmath19 .",
    "thus with probability @xmath15 the new link is assigned to a new target node , while with probability @xmath16 it is allocated to an existing node with probability @xmath20 if @xmath21 and @xmath22 otherwise .",
    "hence , at each time @xmath11 this rule identifies the pair of ( distinct ) nodes to be linked ; 2 .   at time",
    "@xmath11 each existing link between nodes @xmath14 and @xmath18 has weight @xmath23 , where @xmath24 , @xmath25 and @xmath26 are independent random variables . at time @xmath27 the weight of each link is increased or decreased by a random factor @xmath28 , so that @xmath29 .",
    "the shocks and initial link weights are taken from a distribution with finite mean and standard deviation .",
    "thus we assume that each link weight grows in time according to a random process .",
    "moreover the two processes governing link formation and weight growth are assumed to be independent .",
    "we therefore combine a preferential attachment mechanism ( assumption 1 ) , with an independent geometric brownian motion of link weights ( assumption 2 ) . in this way we obtain a generalization of the ba setup capable to account for the growth of weighted networks .",
    "based on the first assumption we derive the degree distribution @xmath0 @xcite . in the absence of the entry of new nodes ( @xmath30 ) the probability distribution of the number of links at large @xmath11 , i.e. the distribution @xmath0 , is exponential : @xmath31 where @xmath32 is the average number of links per node , which linearly grows with time . does not include initial self loops . ]    if @xmath33 , @xmath0 becomes a yule distribution which behaves as a power law for small @xmath4 : @xmath34 where @xmath35 , followed by the exponential decay of eq.([p_k_old ] ) for large @xmath4 with @xmath36 @xcite .",
    "hence , in the limit of large @xmath11 when @xmath30 ( no entry ) , the distribution of @xmath0 converges to an exponential ; on the contrary when @xmath33 and small the connectivity distribution at large @xmath11 converges to a power - law with an exponential cutoff @xcite .    by using the second assumption we can compute the growth rate of the strength of nodes .",
    "the strength of node @xmath14 is given by @xmath37 .",
    "the growth rate is measured as @xmath38 .",
    "thus , the resulting distribution of the growth rates of node strength @xmath39 is determined by @xmath40 where @xmath0 is the connectivity distribution , computed in the previous stage of the model and @xmath41 is the conditional distribution of growth rates of nodes with given number of links determined by the distribution @xmath1 and @xmath42 .",
    "fu and colleagues @xcite find an analytical solution for the distribution of the growth rates of the weights of links @xmath39 for the case when @xmath43 and @xmath44 ,    @xmath45    @xmath39 has similar behavior to the laplace distribution for small @xmath46 i.e. @xmath47 , while for large @xmath46 , @xmath39 has power law tails @xmath48 which are eventually truncated for @xmath49 by the distribution @xmath42 of the growth rate of a single link .    a further implication of the model that can be derived from the second assumption concerns the distribution of link weights @xmath1 .",
    "the proportional growth process ( assumption 2 ) implies that the distribution of the weights @xmath1 converges to a log - normal .",
    "thus node strength @xmath3 is given by the sum of @xmath4 log - normally distributed stochastic values .",
    "since the log - normal distribution is not stable upon aggregation , the distribution of node strength @xmath2 is multiplied by a stretching factor that , depending on the distribution of the number of links @xmath0 could lead to a pareto upper tail @xcite .    moreover , a negative relationship exits among the weight of links and the variance of their growth rate .",
    "our model implies an approximate power - law behavior for the variance of growth rates of the form @xmath50 where @xmath51 is an exponent that weakly depends on the strength @xmath3 .",
    "in particular , @xmath52 for small values of @xmath3 , @xmath53 for @xmath54 , and it is well approximated by @xmath55 for a wide range of intermediate values of @xmath3 @xcite .",
    "finally , the model yields a prediction also on the relation between the degree @xmath4 and the strength @xmath3 of each node . in section [ sec : sim ] we show that since the weight of each link is sampled from a log - normal distribution ( @xmath7 are log - normally distributed ) , and given the skewness of such a density function , the law of large numbers does not work effectively .",
    "in other words , the probability to draw a large value for a link weight increases with the number of draws , thus generating a positive power law relationship between @xmath3 and @xmath4 , for small @xmath4 .",
    "to test our model we use the nber - united nations trade data @xcite available through the center for international data at uc davis .",
    "this database provides bilateral trade flows among countries over 19622000 , disaggregated at the level of commodity groups ( 4-digit level of the standard international trade classification , sitc ) .",
    "data are in thousands us dollars and , for product - level flows , there is a lower threshold at 100,000 dollars below which transactions are not recorded .",
    "one point to note is that disaggregated data are not always consistent with country trade flows : in a number of cases we do not observe any 4-digit transaction recorded between two countries , but nevertheless find a positive total trade , and vice - versa . since we take the number of product traded among any two country pairs as the empirical counterpart of the number of transactions , to avoid inconsistency we compute the total trade by aggregating commodity - level data .",
    "in this section we test the predictions of our model while in the following section , we use the data to calibrate the simulations and check for the ability of the model to replicate real - world phenomena by comparing simulated and actual trade flows .",
    "we already know from previous work @xcite that the main features of the itn are broadly consistent with our model . here",
    "we look in more details at some specific characteristics of itn .",
    "figure [ fig : k_distr ] shows that the distribution @xmath0 , that is the number of 4-digit sitc products traded by countries , is power - law distributed with an exponential cutoff .",
    "the main plot displays the probability distribution in log - log scale , whereby the power - law is the straight line body , and the exponential cutoff is represented by the right tail .",
    "the inset presents the same distribution in semi - log scale : this time it is the exponential part of the distribution that becomes a straight line , so that with this trick we can magnify what happens to the probability distribution as @xmath4 grows large . as discussed in section [ sec : model ] above , the power law distribution of @xmath4 hints at the existence of moderate entry of new nodes in the network .",
    "indeed , 17 new countries enter into the itn during the observed time frame , mostly due to the collapse of the soviet union and yugoslavia .    moving to the weighted version of the network",
    ", one can look at the distribution of positive link weights as measured by bilateral trade flows at the commodity level , @xmath1 , as well as the total value of country trade or node strength @xmath2 .",
    "figure [ fig : w_distr ] shows the complementary cumulative probability distribution of trade flows in log - log scale , both for product - level transactions and for aggregate flows .",
    "figure [ fig : w_distr ] refers to 1997 data ( other years display the same behavior ) .",
    "we observe that both distributions show the parabolic shape typical of the log - normal distribution , thus conforming to previous findings @xcite .",
    "as predicted , upon aggregation the power - law behavior of the upper tail become more pronounced @xcite .",
    "however , this departure from log - normality concerns a very small number of observations ( 0.16% in the case of commodities flows , 2.21% for aggregate flows ) since only a few new nodes ( countries ) enter the network over time .    as for the growth of trade flows ,",
    "figure [ fig : g_macro ] shows the empirical distribution @xmath39 together with the maximum likelihood fit of eq.([p_new_1 ] ) as well as the generalized exponential distribution ( ged , with shape parameter 0.7224 ) .",
    "goodness of fit tests , reported in table [ tab : gof1 ] , show that @xmath39 is neither gaussian nor laplace , whereas the distribution in equation ( [ p_new_1 ] ) performs much better in terms of kolmogorov - smirnov ( ks ) and anderson - darling ( ad ) tests .",
    "hence , the growth of nodes centrality , as measured by strength @xmath3 , follows the same law of the fluctuations of the size of complex systems @xcite .",
    "this is not surprising , since the size of an airport can be measured by the number of the passengers that travel through it and the size of a firm in terms of sales is given by the sum of the value of each product it sells .",
    "thus the theoretical framework of stanley and colleagues @xcite complements and completes the ba proportional growth model in the case of weighted networks .",
    ".kolmogorov - smirnov ( ks ) and anderson - darling ( ad ) goodness of fit tests for the distribution of growth rates of trade flows @xmath39 [ cols= \" < , > , > , > , > , > , > \" , ]     as discussed in section [ sec : model ] , our model implies a negative relationship between node strength and the variance of its growth rate .",
    "figure [ fig : size_var ] reports the standard deviation of the annual growth rates of node strength ( @xmath46 ) and their initial magnitude ( @xmath3 ) .",
    "the standard deviation of the growth rate of link weights exhibits a power law relationship @xmath56 with @xmath57 , as predicted by the model @xcite .",
    "this implies that the fluctuations of the most intense trade relationships are more volatile than expected based on the central limit theorem .",
    "( trade values ) and the standard deviation of its growth rate @xmath58 , double logarithmic scale , width=529 ]    all in all , our model accurately predicts the growth and weight distribution of trade flows , the number of commodities traded and the size - variance relationship of trade flows .",
    "thus we can conclude that a stochastic model that assumes a proportional growth of the number of links combined with an independent proportional growth process of link weights can reproduce most of the observed structural features of the world trade web and should be taken as a valid stochastic benchmark to test the explanatory power of alternative theories of the evolution of international trade and weighted networks in general . in the next section",
    "we will compare the structure of random networks generated according to our model and with the real world trade network .",
    "based on the assumptions in section [ sec : model ] we generate a set of random networks and fit them with real world data in order to test the predictive capability of our theoretical framework .",
    "we will proceed in two steps .",
    "first , we generate the unweighted network according to the first set of assumptions .",
    "next , we assign the value of weights based on a random sampling of @xmath4 values from a log - normal distribution @xmath1 whose parameters are obtained through a maximum likelihood fit of the real world data .",
    "we model a system where at every time @xmath11 a new link is added , which represents the possibility to exchange one product with a trading partner .",
    "we slightly modify the original setting in order to account for the possibility that the new links could be assigned randomly rather than proportionally to node connectivity .",
    "thus in our simulations the parameter @xmath15 governs the entry of new nodes according to assumption 1 , whereas parameter @xmath59 is the probability that a new link is assigned randomly .",
    "thus with probability @xmath15 the new link is assigned to a new source node , whereas with probability @xmath16 it is allocated to an existing node @xmath14 . in the latter case ,",
    "the probability of choosing node @xmath14 is now given by @xmath60 where @xmath61 is the number of nodes at time @xmath62 .",
    "the target of the new link is chosen symmetrically with @xmath19 .    by tuning the two model parameters @xmath15 and @xmath59",
    "we generate different networks in terms of the connectivity distribution of trade links @xmath0 .",
    "in particular , without entry ( @xmath30 ) and completely random allocation of opportunities ( @xmath63 ) one obtains a random graph characterized by a poisson connectivity distribution @xcite , whereas allowing entry ( @xmath33 ) @xmath0 is exponentially distributed .",
    "keeping a positive entry rate , but assigning opportunities according to a preferential attachment model ( @xmath64 ) the model leads to a power - law connectivity distribution with an exponential cut - off which is more pronounced the higher is the number of initial nodes @xmath9 . in the limit case in which entry of new nodes is ruled out ( @xmath30 )",
    "then the connectivity distribution tends toward a bose - einstein geometric distribution .",
    "we compare the structure of random scale - free model networks with the real world trade network in 1997 .",
    "since the structure of the network is highly stable over time results do not change substantially if we compare simulations with the structure of the real world network in different years . in the first stage , we generate one million networks with @xmath15 and @xmath59 both ranging from 0 to 1 .",
    "we simulate random networks of 166 nodes ( countries ) and 1,079,398 links ( number of different commodities traded by two countries ) .",
    "the number of commodities traded is taken as a proxy of the number of transactions .",
    "next we select the random networks that better fit the real world pattern in terms of correlation , as measured by the mantel @xmath65 test , and connectivity distribution .",
    "figure [ fig : mantel ] reports the value of the mantel test for networks with @xmath66 and an entry rate @xmath15 which implies the entry form 0 to 66 countries .",
    "the mantel correlation statistics reach a peak of .88 ( @xmath67 ) in the case of preferential attachment regimes ( @xmath64 ) . however , the mantel test does not discriminate among different entry regimes .",
    "we next compare the connectivity distribution of simulated networks with the real world distribution of the number of traded commodities @xmath0 by means of the kolmogorov - smirnov ( ks ) goodness of fit test .",
    "figure [ fig : ks_mesh ] confirms that the best fit is obtained in the case of a purely preferential attachment networks ( @xmath64 ) .",
    "however the ks tests provides additional information on the most likely value of @xmath15 ( entry rate of new nodes ) .",
    "figure [ fig : ks_test ] shows that the our model can better reproduce the connectivity distribution with and entry rate @xmath33 that implies the entry of 1418 countries .",
    "this closely corresponds to the empirically observed number of new countries .",
    "thus we can conclude that a simple proportional growth model with mild entry can account for the distribution of the number of commodities traded by each pair of countries .    ) , width=529,height=340 ]    by introducing the value of the transactions we can show that the model generates the observed relationship between intensive and extensive margins of trade .",
    "figure [ fig : size_k2 ] depicts the relationship between total trade flows ( @xmath3 ) and the number of trade links maintained by each country ( @xmath4 ) .",
    "empirically , we proxy the number of transactions by means of the number of products traded by each country .",
    "figure [ fig : size_k2 ] displays the relationship that emerges from 1997 trade data , and confirms that there exists a positive correlation between the two variables . the slope of the interpolating line ( 1.33 ) in double logarithmic scale reveals a positive relationship between the number of commodities and their average value of the kind @xmath5 with @xmath68 .    the curve displays and upward departure in the upper tail .",
    "this can be explained by noticing that the product classification that we used imposes a ceiling to the number of products a country can trade since there are only around 1,300 4-digit categories ( vertical dotted line ) .",
    ", some scale effects kick in establishing a correlation between @xmath4 and @xmath3 .",
    "this could be tested in other real networks with larger @xmath4 and no cutoff .",
    "we are aware that our modeling strategy to assume away any relationship between the mechanisms governing the binary structure of the network and the one assigning link weights is as extreme as other strategies that simply assume a single process governing the two parts . yet",
    ", we consider the positive relationship between @xmath4 and @xmath3 as an interesting emerging property of the model . ]",
    "apart from the upper decile of the distribution , the simulated version of the network shows exactly the same dependence among the magnitude and the number of the transactions .",
    "this seems surprising by considering that the model assumes two independent growth processes for the number of transactions @xmath4 and their values @xmath7 .",
    "however , it should be noticed that the law of large numbers does not work properly in case of skew distributions such as the log - normal .",
    "given a random number of transactions with a finite expected value , if its values are repeatedly sampled from a log - normal , as the number of links increases , the average link weight will tend to approach and stay close to the expected value ( the average for the population ) .",
    "however this is true only for large @xmath4 , while according to the distribution @xmath0 the vast majority of nodes has few links ( small @xmath4 ) .",
    "the higher is the variance of the growth process of link weights , the larger has to be @xmath4 to start observing convergence toward @xmath69 with @xmath70 predicted by the law of large numbers .",
    "thus only the largest countries approach the critical threshold . in sum",
    ", our simulations demonstrate that our model can account for the relationship between @xmath4 and @xmath3 that has been observed in many real world weighted networks @xcite .",
    "using a simple model of proportionate growth and preferential attachment we are able to replicate some of the main topological properties of real - world weighted networks . in particular , we provide an explanation to the power - law distribution of connectivity , as well as for the fat tails displayed by the distribution of the growth rates of link weights and node strength .",
    "additionally , the model matches the log - normal distribution of positive link weights ( trade flows in the present context ) and the negative relationship between node strength and variance of growth fluctuations @xmath56 with @xmath57 .",
    "the main contribution of the paper is to offer an extension of the ba model for weighted networks . besides , we provide further evidence that such a unifying stochastic framework is able to capture the dynamics of a vast array of phenomena concerning complex system dynamics @xcite .",
    "guimer , r. , mossa , s. , turtschi , a. , amaral , l. : 2005 , the worldwide air transportation network : anomalous centrality , community structure , and cities global roles _ proceedings of the national academy of sciences _ * 102*(22 ) ,  77947799 .",
    "garlaschelli , d. , battiston , s. , castri , m. , servedio , v. and caldarelli , g. : 2005 , the scale - free topology of market investments , _ physica a : statistical mechanics and its applications _ , * 350*(24 ) ,  491499 .",
    "fagiolo , g. , reyes , j. and schiavo , s. : 2008 , on the topological properties of the world trade web : a weighted network analysis , _ physica a : statistical mechanics and its applications _ * 387*(15 ) ,  38683873 .",
    "bhattacharya , k. , mukherjee , g. , saramaki , j. , kaski , k. and manna , s.:2008 , the international trade network : weighted network analysis and modelling , _ journal of statistical mechanics : theory and experiment _ , * 2008 * ,  p02002 .",
    "yamasaki , k. , matia , k. , buldyrev , s. , fu , d. , pammolli , f. , riccaboni , m. , and stanley , h. : 2006 preferential attachment and growth dynamics in complex systems , _ physical review e _ * 74*(3 ) ,  035103(r ) .",
    "fu , d. , pammolli , f. , buldyrev , s. , riccaboni , m. , matia , k. , yamasaki , k. and stanley , h. : 2005 , the growth of business firms : theoretical framework and empirical evidence , _ proceedings of the national academy of sciences _ * 102*(52 ) ,  1880118806 .    riccaboni , m. , pammolli , f. , buldyrev , s. , ponta , l. and stanley , h. : 2008 , the size variance relationship of business firm growth rates , _ proceedings of the national academy of sciences _ * 105*(50 ) ,  19595 ."
  ],
  "abstract_text": [
    "<S> we develop a simple theoretical framework for the evolution of weighted networks that is consistent with a number of stylized features of real - world data . in our framework , the barabsi - albert model of network evolution is extended by assuming that link weights evolve according to a geometric brownian motion . </S>",
    "<S> our model is verified by means of simulations and real world trade data . </S>",
    "<S> we show that the model correctly predicts the intensity and growth distribution of links , the size - variance relationships of the growth of link weights , the relationship between the degree and strength of nodes , as well as the scale - free structure of the network .    * </S>",
    "<S> pacs * : 89.75.hc , 89.75.fb , 89.65.gh , 87.23.ge    * keywords * : weighted networks analysis , proportionate growth , preferential attachment , international trade </S>"
  ]
}