{
  "article_text": [
    "let @xmath1 be a smooth , projective , connected variety of dimension @xmath4 , and let @xmath5 be an algebraic vector bundle on @xmath1 .",
    "denote by @xmath6}$ ] the hilbert scheme of length @xmath7 subschemes of @xmath1 , and let @xmath8}$ ] be the tautological bundle on @xmath6}$ ] with fibre @xmath9 at @xmath10}$ ] .",
    "we study integrals of products of chern classes of bundles @xmath8}$ ] over what we call _ geometric subsets _ of @xmath6}$ ] .",
    "geometric subsets form a natural class of subsets definable without reference to the global geometry of @xmath6}$ ] . specifically ,",
    "the geometric subsets of @xmath6}$ ] are those generated by finite unions , intersections and complements from sets of the kind @xmath11 } \\mid z = z_1 \\sqcup \\ldots \\sqcup z_k,\\ \\",
    "z_i\\text { is of type } q_i\\}.\\ ] ] here each @xmath12 is a constructible subset of the punctual hilbert scheme @xmath13 of subschemes supported at @xmath14 , and we have @xmath15 . by ``",
    "@xmath16 is of type @xmath12 ''",
    "we mean that @xmath16 is isomorphic , as an abstract scheme , to an element of @xmath12 , so we require that the @xmath17-th connected component of @xmath18 is of isomorphism type in a specified family @xmath12.[multiblock footnote omitted ]    a @xmath19-variable chern polynomial is a polynomial in the formal variables @xmath20 , where @xmath21 and @xmath22 .",
    "we treat such a chern polynomial as a function from @xmath19-tuples of vector bundles to cohomology by the rule @xmath23 extended linearly and multiplicatively to all chern polynomials .",
    "a chern monomial is a monomial in the variables @xmath20 .",
    "the _ weight _ of a chern monomial @xmath24 is defined to be @xmath25 , so that treating a chern monomial of weight @xmath26 as a function , its image will be in @xmath27 .",
    "denote by @xmath28 the set of @xmath19-variable chern monomials of weight @xmath26 .    if @xmath29 is a proper scheme and @xmath30 a constructible subset , we denote by @xmath31 the chern - schwartz - macpherson class of the characteristic function of @xmath29 .",
    "the construction and basic properties of this class are reviewed in section [ section : preliminaries ] .",
    "the bulk of the paper is devoted to the proof of the following theorem .",
    "[ mainthm ] let @xmath1 be a smooth , projective , connected variety of dimension @xmath4 , let @xmath32 be algebraic vector bundles on @xmath1 , and let @xmath33 be a @xmath19-variable chern polynomial .",
    "let either    1 .",
    "@xmath34)$ ] , for @xmath35}$ ] closed and geometric , or 2 .",
    "@xmath36 , for @xmath35}$ ] geometric .",
    "then , there exists a polynomial @xmath37 in the variables @xmath38 , depending only on @xmath33 , the ranks of the @xmath39 , and the type of @xmath40 , such that if we let @xmath41 be the chern number @xmath42 $ ] , we have @xmath43 .",
    "if every point @xmath44 represents a subscheme with support in at most @xmath45 points , the degree of @xmath37 is at most @xmath45 .    in case @xmath1",
    "is a surface or a curve , so that the hilbert scheme is nonsingular , we can extend this as follows .",
    "[ surfacethm ] if @xmath46 or @xmath47 , theorem [ mainthm ] holds with @xmath48 replaced by @xmath49 } } , e_1 , \\ldots e_k)$ ] .",
    "the strategy of the proof of the main theorem is motivated by j. li s paper @xcite , where he shows that the degree of the virtual fundamental class on the hilbert scheme of points on a threefold is given by a universal polynomial .",
    "the outer structure of that proof , i.e.  using the scheme @xmath50\\!]}$ ] and approximating by classes defined via @xmath51\\!]}$ ] , is well suited to our problem . dealing with geometric subsets , the tautological bundles @xmath8}$ ] and the chern - schwartz - macpherson class requires new ingredients .",
    "an outline of the proof of the main theorem is given in section [ outline ] , and the formal proof occupies sections [ section : proof ] and [ section : lemmaproof ] .    in section [ section : generatingfun ] , we show that a generating function for the chern integrals of theorems [ mainthm ] and [ surfacethm ] ( i ) can be given a certain product form , a fact which is formally equivalent to the statement that part ( i ) of the theorems holds also for disconnected @xmath1 .",
    "a special case of theorem [ surfacethm ] has been proved by ellingsrud , gttsche and lehn using a completely different method , see @xcite . in our terminology , they treat the case where @xmath1 is a surface and the geometric subset @xmath40 is the whole of @xmath6}$ ] .",
    "we note that the method of @xcite yields a recursion which computes the integrals one are interested in .",
    "in contrast , our method is nonconstructive and relies at a crucial point on the fact that an element in the cohomology ring of a grassmannian is a polynomial in the chern classes of the universal bundle . lacking a method of obtaining information about this polynomial",
    ", there is no apparent way of turning our proof into an algorithm .",
    "the main motivation for our result is to generalize the result known as the gttsche conjecture , which by now has several proofs , see @xcite , @xcite , @xcite , and @xcite .",
    "we recall the statement of the conjecture .",
    "fix a surface @xmath52 with a line bundle @xmath0 which is `` sufficiently ample '' , e.g. @xmath53 , where @xmath54 is a very ample line bundle and @xmath55 is a sufficiently large integer .",
    "the precise definition of sufficiently ample uses the concept of @xmath55-very ampleness , see section [ applications ] .",
    "let @xmath56 be a positive integer , and call a curve @xmath56-nodal if it has @xmath56 nodes and no other singularities . if @xmath0 is sufficiently ample , the locus of @xmath56-nodal curves in @xmath57 has the expected codimension @xmath56 , so that in a general linear subsystem @xmath58 there is a finite number of @xmath56-nodal curves .",
    "the simplest form of the conjecture is then that there exists a degree @xmath56 polynomial @xmath59 in 4 variables , independent of @xmath52 and @xmath0 , such that the number of @xmath56-nodal curves equals @xmath60    our main application is the generalization of this result to the case of curves with more general specified singularity types .",
    "our approach follows the idea of gttsche used in ( * ? ? ?",
    "5 ) to reduce the problem of counting nodal curves to an integral on the hilbert scheme . he defines a closed subset @xmath61}$ ] and shows that the number of @xmath56-nodal curves in the linear system @xmath62 equals the degree of @xmath63}\\right)\\cap[w],\\ ] ] assuming @xmath0 is @xmath64-very ample .",
    "this idea was used by tzeng in her proof of the gttsche conjecture in @xcite , which uses degenerations of @xmath52 to show that the degree of the class above is a polynomial in the chern numbers of @xmath65 .",
    "the set @xmath66 appearing above is geometric , hence our theorem yields a different proof of tzeng s result .",
    "since our main theorem deals with more general loci in the hilbert scheme of points , we may generalize the statement of tzeng s theorem , replacing @xmath56-nodal curves with curves having specified singularity types . specifically , we have the following proposition .",
    "let @xmath52 be a smooth , projective , connected surface , let @xmath0 be a line bundle on @xmath52 , and let @xmath67 be analytic singularity types .",
    "suppose @xmath0 is @xmath55-very ample , where @xmath55 is an integer depending on the types @xmath68 , and let @xmath4 be the sum of the codimensions of the @xmath68 .",
    "there is a rational polynomial @xmath37 of degree @xmath19 in 4 variables , depending only on the @xmath68 , such that in a general @xmath69 the number of curves having precisely @xmath19 singularities of types @xmath68 is @xmath70 the same statement holds when the @xmath68 are topological types .",
    "fixing types @xmath68 , we may collect the universal polynomials for the number of curves having @xmath71 singularities of type @xmath68 in a generating function ; this can then be written in the form @xmath72 for rational power series @xmath73 .",
    "see corollary [ cor : curvegen ] for a precise statement .",
    "both of these results have recently been obtained independently by li and tzeng using a generalization of tzeng s degeneration approach , see @xcite .    by the same method",
    "we are able to count hypersurface singularities in arbitrary dimensions .",
    "namely , we have the following .",
    "let @xmath1 be a smooth , projective , connected variety , let @xmath0 be a line bundle on @xmath1 , and let @xmath67 be analytic singularity types .",
    "suppose @xmath0 is @xmath55-very ample , where @xmath55 is an integer depending on the types @xmath68 , and let @xmath4 be the sum of the codimensions of the @xmath68 .",
    "there is a rational polynomial @xmath37 in the chern numbers of @xmath3 , depending only on the @xmath68 , such that in a general @xmath69 the number of divisors having precisely @xmath19 isolated singularities of types @xmath68 is given by @xmath37 .    a different application of the main result concerns the locus of curves in a @xmath74 having given `` bps spectrum '' .",
    "for a reduced , complete , locally planar curve @xmath75 with arithmetic genus @xmath76 and geometric genus @xmath77 , we consider the generating function @xmath78}\\right)q^k\\ ] ] it is shown in @xcite that there are integers @xmath79 for @xmath80 , such that @xmath81 if @xmath75 is smooth , we have @xmath82 , so this result can be interpreted as saying that in general @xmath83 decomposes as a sum of @xmath79 copies of @xmath84 where @xmath85 is smooth of genus @xmath17 .",
    "we define @xmath86 , and it is then easy to check that the sequence of integers @xmath87 depends only on the analytic type of the singularities of @xmath75 .",
    "we refer to the sequence @xmath88 as the _ bps spectrum _ of @xmath75 .",
    "we note that the bps spectrum is conjecturally determined by the milnor numbers and links of the singularities of @xmath75 , see @xcite , and should therefore be a coarser invariant than topological singularity type .",
    "we show the following proposition .",
    "let @xmath52 be a smooth , projective , connected surface , and let @xmath0 be a line bundle on @xmath52 .",
    "let @xmath89 be a bps spectrum , and denote by @xmath90 the locus of curves with bps spectrum @xmath45 .",
    "let @xmath19 be a nonnegative integer , let @xmath91 be a general linear subsystem , and suppose @xmath0 is @xmath55-very ample , where @xmath55 is some integer depending on @xmath19 and @xmath45 .",
    "then , there exists a rational polynomial @xmath37 in 4 variables , depending only on @xmath19 and @xmath45 , such that @xmath92    this generalizes part of kool , shende and thomas proof of the gttsche conjecture in @xcite , which involves the special case of the above proposition where @xmath45 is the spectrum of a @xmath56-nodal curve ; that is @xmath93 with @xmath94 .",
    "homology and cohomology is singular with coefficients in @xmath95 . by the degree of a class in @xmath96",
    "we mean its pushforward to @xmath97 . in dealing with algebraic subsets of hilbert schemes we always give these the reduced scheme structure , and few functors are represented .",
    "we often leave notation for pullback of vector bundles and cohomology classes implicit .",
    "we use the notation @xmath98 for the grassmannian parametrizing @xmath99-dimensional subspaces of @xmath100 .",
    "if @xmath45 is some number defined in terms of the data @xmath101 of the theorem , we will use the shorthand `` @xmath45 is universal '' to mean that there exists a polynomial in the variables @xmath41 computing @xmath45 , depending only on @xmath33 and the type of @xmath40 as in the main theorem .",
    "i thank ragni piene and my supervisor richard thomas for valuable discussions and comments on this paper .",
    "let @xmath1 be a smooth , projective , connected variety of dimension @xmath4 , and let @xmath5 be an algebraic vector bundle on @xmath1 .",
    "we give the definition of the tautological bundle @xmath8}$ ] and recall the construction of the chern - mather and chern - schwartz - macpherson ( abbreviated csm ) classes . in section [ section : geometric ] , we introduce the scheme @xmath50\\!]}$ ] and discuss the notion of geometric subsets of @xmath6}$ ] and @xmath50\\!]}$ ] .",
    "denote by @xmath102 } \\times x$ ] the universal subscheme over @xmath6}$ ] , and let @xmath103 and @xmath104}$ ] be the projections .",
    "the _ tautological bundle _",
    "@xmath8}$ ] on @xmath6}$ ] is defined as @xmath105 } = q_*(p^*(e)).\\ ] ] the flatness of @xmath106 implies that @xmath8}$ ] is locally free , and we see that the fibre of @xmath8}$ ] at a point @xmath10}$ ] is the vector space @xmath107 .",
    "we next review the chern - mather and chern - schwartz - macpherson classes .",
    "both of these classes are generalizations to singular varieties of the poincar dual of @xmath108 for a smooth , proper @xmath1 ; so for such @xmath1 we have @xmath109.\\ ] ] the chern - mather class is used in the definition of the csm class and is essential in the proof of the main theorem .",
    "let @xmath29 be a be a reduced and irreducible projective scheme .",
    "we recall the definition of the chern - mather class @xmath110 .",
    "the first step is to construct the nash blow up @xmath111 .",
    "suppose for a moment that @xmath29 is a reduced , irreducible and affine of dimension @xmath4 .",
    "let @xmath112 be the nonsingular part of @xmath29 , and fix an embedding @xmath113 . the tangent map @xmath114 induces a morphism @xmath115 , and we take @xmath116 to be the closure of the graph @xmath117 .",
    "the morphism @xmath118 is defined by the projection @xmath119 , and we define the rank @xmath4 vector bundle @xmath120 on @xmath116 by restricting the universal bundle on @xmath121 .    it can be shown that this construction is independent of the choice of affine embedding and globalizes so that for any reduced , equidimensional scheme @xmath29 we get a well defined @xmath29-scheme @xmath116 with a bundle @xmath120 .",
    "the morphism @xmath111 is the _",
    "nash blow up _ of @xmath29 and the bundle @xmath120 is the _ nash bundle_.    the chern - mather class @xmath122 is the pushdown of @xmath123 $ ] along @xmath111 .",
    "we recall the definition and basic properties of the chern - schwartz - macpherson class . for details see ( * ? ? ?",
    "19.1.7 ) and @xcite .",
    "let @xmath29 be a projective scheme , let @xmath124 be the group of all cycles on @xmath29 , and let @xmath125 denote the group of constructible functions , where a function @xmath126 is called constructible if there exists a finite partition of @xmath29 into constructible sets such that @xmath127 is constant on each stratum",
    ". given any reduced scheme @xmath128 , the local euler obstruction @xmath129 is a canonical constructible function determined at a point @xmath130 by the analytic - local structure of @xmath128 at @xmath131 . is the nash blow - up",
    ", we have @xmath132 , where @xmath133 is the scheme - theoretic inverse image and @xmath134 denotes the segre class . ]",
    "there is a group homomorphism @xmath135 defined on a primitive cycle @xmath128 by @xmath136 the map @xmath137 is easily seen to be an isomorphism , using the fact that @xmath138 if @xmath130 is a nonsingular point .",
    "the chern - mather class defines a homomorphism @xmath139 by letting @xmath140 where @xmath141 is the inclusion of a primitive cycle .    the chern - schwartz - macpherson class @xmath142 is now defined for any constructible function @xmath127 by @xmath143 it is clear that @xmath144 is a homomorphism . if @xmath30 is a constructible subset , we write @xmath145 , where @xmath146 is the characteristic function of @xmath18 .",
    "additivity of @xmath144 then translates to @xmath147    given a morphism of proper schemes @xmath148 , one can define a homomorphism @xmath149 by letting @xmath150)\\ \\ \\ \\ x \\in y_2,\\ ] ] where @xmath151 is a primitive cycle , and @xmath152 is the topological euler characteristic .",
    "the main property of csm classes , shown in @xcite , is that if @xmath153 is proper , we have @xmath154 . as a corollary ,",
    "letting @xmath29 be proper and @xmath153 be the map to a point , we get that @xmath155 .",
    "following @xcite , we introduce the scheme @xmath50\\!]}$ ] , which will play an essential role in the main proof .",
    "[ def : orderedpoints ] the _ hilbert scheme of ordered points _",
    ", denoted @xmath50\\!]}$ ] , is the scheme defined by the cartesian diagram @xmath156\\ ! ] } @ > > > x^{[n ] } \\\\",
    "@vvv            @vvv     \\\\",
    "x^n        @ >",
    "\\sym^n(x ) ,   \\end{cd}\\ ] ] where the right hand arrow is the hilbert - chow morphism taking a subscheme @xmath18 to its support cycle .",
    "denote by @xmath157 the point in @xmath50\\!]}$ ] mapping to @xmath10}$ ] and @xmath158 .    roughly speaking",
    ", the advantage of introducing @xmath50\\!]}$ ] is that it has a natural map to @xmath159 .",
    "this makes it easier to handle than @xmath6}$ ] , which maps naturally to the more complicated @xmath160 . also , as @xmath50\\ ! ] } \\to x^{[n]}$ ] is finite , we can reduce questions about homology classes on @xmath6}$ ] to questions about similar classes on @xmath50\\!]}$ ] .",
    "we now give the definition of geometric subsets of @xmath6}$ ] and of @xmath50\\!]}$ ] , along with some results on these which will be needed later .",
    "let @xmath161 be the punctual hilbert scheme , defined as the closed subset of @xmath162 parametrizing subschemes supported at the origin .",
    "we define punctual geometric subsets to be the constructible subsets of the punctual hilbert scheme containing all 0-dimensional schemes of given isomorphism types .",
    "a punctual geometric subset @xmath163 is a constructible set such that : if @xmath164 and @xmath165 are such that @xmath166 ( as abstract schemes ) , then @xmath167 .",
    "a collection of punctual geometric subsets will naturally define subsets of both @xmath6}$ ] and @xmath50\\!]}$ ] .",
    "[ def : standardgeometric ] let @xmath168 be punctual geometric subsets such that @xmath169 .",
    "let @xmath170 be a @xmath19-tuple of subsets of @xmath171 , such that @xmath172 , and such that the @xmath173 define a partition of @xmath171 .",
    "* define @xmath174}$ ] as the set of all @xmath175 , where every @xmath16 is isomorphic to a @xmath176 .",
    "* define @xmath177\\!]}$ ] as the set of all @xmath178 such that @xmath175 , where every @xmath16 is isomorphic to a @xmath176 , and such that @xmath179 if @xmath180 .",
    "we now give the definition of geometric subsets of @xmath6}$ ] and @xmath50\\!]}$ ] .    * a subset @xmath181}$ ] is geometric if it can be expressed using sets of the form @xmath182 and a finite composition of the operations union , intersection and complement . * a subset @xmath183\\!]}$ ] is geometric if it can be expressed using sets of the form @xmath184 and a finite composition of the operations of union , intersection and complement .",
    "[ def : geometric ]    an equivalent definition which will be convenient in the proof is the following .    * a subset @xmath181}$ ] is geometric if it can be expressed using sets of the form @xmath185 , where the @xmath12 are closed and irreducible , together with a finite composition of the operations of union , intersection and complement .",
    "* a subset @xmath183\\!]}$ ] is geometric if it can be expressed using sets of the form @xmath186 , where the @xmath12 are closed and irreducible , together with a finite composition of the operations of union , intersection and complement .",
    "[ def : geometricalt ]    the equivalence of definitions [ def : geometric ] and [ def : geometricalt ] is shown in lemma [ lemma : geometric ] ( vii ) .    if @xmath187 the only geometric subsets of @xmath188 } = x$ ] are @xmath189 and @xmath1 . if @xmath190 , there are three geometric subsets : the sets @xmath189 , @xmath191}$ ] and the subset parametrizing length 2 subschemes with support in one point .",
    "when @xmath1 is a surface , a naturally occurring example of a geometric subset is the set @xmath192}$ ] , defined as the closure of @xmath193 } \\mid z = z_1 \\sqcup \\cdots \\sqcup z_\\delta,\\ \\ z_i = \\spec \\co_{s , x_i}/\\mathfrak{m}_{x_i}^2\\}.\\ ] ] this is the set that appears in tzeng s proof of the gttsche conjecture .",
    "it is easy to check that a geometric subset @xmath40 is constructible .    clearly , if @xmath181}$ ] is geometric and @xmath44 , then for any @xmath194}$ ] such that @xmath166 we have @xmath195 . in other words , a geometric subset",
    "@xmath40 is a union of isomorphism classes of subschemes @xmath10}$ ] .",
    "we may define the notion of isomorphism between points of @xmath50\\!]}$ ] by saying that @xmath196 if there exists an isomorphism @xmath166 which takes @xmath197 to @xmath198 for every @xmath17 .",
    "then similarly a geometric subset @xmath183\\!]}$ ] is a union of isomorphism classes of pairs .",
    "let @xmath1 and @xmath29 be @xmath4-dimensional , smooth , projective varieties , and let @xmath40 and @xmath199 be geometric subsets of @xmath6}$ ] and @xmath200}$ ] respectively .",
    "we say that @xmath40 and @xmath199 are of the same _ type _ if the isomorphism classes of the points in @xmath40 are the same as the isomorphism classes of points in @xmath199 .",
    "clearly , for any geometric subset of @xmath1 there is a unique geometric subset of @xmath29 of the same type .",
    "the type of a geometric subset @xmath183\\!]}$ ] is defined in the same way .",
    "let @xmath201\\ ! ] } \\to x^{[n]}$ ] be the natural morphism .",
    "the following lemma contains the essential facts about geometric subsets .",
    "[ lemma : geometric ] let @xmath181}$ ] and @xmath183\\!]}$ ] as sets .    1 .",
    "@xmath40 is geometric @xmath202 @xmath203 is geometric .",
    "@xmath204 is geometric @xmath205 @xmath206 is geometric .",
    "@xmath40 is geometric @xmath202 @xmath40 is a finite union of sets of the form @xmath207 .",
    "@xmath204 is geometric @xmath202 @xmath204 is a finite union of sets of the form @xmath208 .",
    "@xmath40 is geometric , closed and irreducible @xmath202 @xmath40 is of the form @xmath209 for closed , irreducible @xmath12 .",
    "@xmath204 is geometric , closed and irreducible @xmath202 @xmath204 is of the form @xmath210 for closed , irreducible @xmath12 .",
    "7 .   definitions [ def : geometric ] and [ def : geometricalt ] are equivalent .    in this proof",
    ", we use the term geometric subsets for the sets satisfying definition [ def : geometric ] .",
    "\\(iv ) it suffices to show that intersections and complements of sets of the form @xmath208 are expressible as unions of such sets .",
    "let @xmath208 and @xmath211 be sets such that we have @xmath212 and @xmath213 . then , if @xmath214 , we have @xmath215 and the @xmath19-tuple @xmath216 is a permutation of the @xmath19-tuple @xmath217 . in this case",
    ", we may relabel the indices of the @xmath218 to get @xmath219 , and then @xmath220 .",
    "next we see that for any @xmath208 the set @xmath50\\ ! ] } \\sm t((q_i),a)$ ] is the union of all sets @xmath221 where @xmath217 is not a permutation of @xmath216 , and the @xmath19 sets of the form @xmath222 for @xmath223 .",
    "\\(ii ) follows from ( iv ) and @xmath224 .",
    "\\(i ) @xmath205 follows from the fact that @xmath225 is the union of @xmath208 for all admissible @xmath216 . @xmath226 then follows from ( ii ) and surjectivity of @xmath227 .",
    "\\(iii ) follows from ( i ) , ( ii ) , ( iv ) and the surjectivity of @xmath227 .",
    "\\(v ) by ( iii ) , we may write @xmath228 , and as @xmath40 is closed , we have @xmath229 . irreducibility of @xmath40 implies @xmath230 for some @xmath231 , so we may take @xmath232 .",
    "it remains to show that the @xmath12 can be chosen to be irreducible .",
    "suppose not , then we have for instance @xmath233 reducible .",
    "let @xmath234 be the decomposition of @xmath233 into closed , irreducible subsets .",
    "each @xmath235 must be equal to the closure of its orbit under the natural action of @xmath236 on @xmath237 , hence we see that the @xmath235 are geometric .    we then have @xmath238 , and as @xmath40 is irreducible we may replace @xmath233 with some @xmath235 . repeat to get all",
    "@xmath12 irreducible , proving the @xmath205 implication .",
    "the @xmath226 implication is easy and omitted , but note that it depends on the hypothesis that @xmath1 is connected .",
    "\\(vi ) similar to ( v ) .",
    "\\(vii ) it is obvious that a @xmath40 satisfying def .",
    "[ def : geometricalt ] satisfies [ def : geometric ] . for the converse ,",
    "note that the closed geometric @xmath40 generate all geometric subsets by unions , intersections and complements .",
    "the proof of ( v ) shows that a closed geometric @xmath40 is the union of sets of the form @xmath239 with @xmath12 closed and irreducible .",
    "hence closed , geometric @xmath40 satisfy definition [ def : geometricalt ] , and the claim follows .",
    "the case of @xmath204 is similar .",
    "we give an outline of the proof of the main theorem .",
    "for ease of presentation , we restrict our attention in the outline to theorem [ mainthm ] ( i ) , ignoring the extra complications of ( ii ) and theorem [ surfacethm ] . here and in the formal proof , we assume that the number of vector bundles @xmath39 is 1 ; the general case is no more difficult . by lemma [ lemma : geometric ]",
    "we see that the irreducible components of @xmath40 are geometric of type depending only on the type of @xmath40 , hence we may assume that @xmath40 is irreducible .",
    "the set - up is then that we are given a closed , irreducible geometric subset @xmath40 of @xmath6}$ ] , a ( 1-variable ) chern polynomial @xmath33 and a vector bundle @xmath5 , and we want to show that @xmath240}\\right ) \\cap [ p]\\ ] ] is given by a universal polynomial .",
    "the first step is to replace @xmath6}$ ] with the hilbert scheme of ordered points @xmath50\\!]}$ ] of def .",
    "[ def : orderedpoints ] .",
    "define the bundle @xmath241\\!]}$ ] on @xmath50\\!]}$ ] to be the pullback of @xmath8}$ ] along @xmath50\\ ! ] } \\to x^{[n]}$ ] .",
    "lemma [ covering ] gives a closed , irreducible @xmath183\\!]}$ ] which is geometric , maps properly and finitely onto @xmath40 , and which is such that @xmath242 and the type of @xmath204 are determined by the type of @xmath40 .",
    "the projection formula shows that @xmath243}\\right ) \\cap [ p]\\right ) = \\deg f\\left(e^{[\\![n]\\!]}\\right ) \\cap [ t].\\ ] ] thus , it suffices to show that @xmath244\\!]}\\right ) \\cap [ t]$ ] is given by a universal polynomial .",
    "next , following @xcite , we let @xmath245 be a partition of @xmath171 , and define the scheme @xmath51\\!]}$ ] .",
    "considering @xmath245 as a set of subsets of @xmath171 , we let @xmath246\\ ! ] } : = \\prod_{a \\in \\alpha } x^{[\\![|a|]\\!]}.\\ ] ]    so , for example , if @xmath245 is the partition of @xmath171 into @xmath7 one - element sets , we have @xmath51\\ ! ] } = x^n$ ] . at the other extreme ,",
    "let @xmath247 denote the trivial partition of @xmath248 into one set , we then have @xmath249\\ ! ] } = x^{[\\![n]\\!]}$ ] .",
    "informally , the scheme @xmath51\\!]}$ ] parametrizes ordered collections of @xmath7 points in @xmath1 , with the additional data that when @xmath19 points whose labels are in the same set in the partition @xmath245 come together at @xmath131 , one must specify a length @xmath19 subscheme supported at @xmath131 .    for every @xmath245 , there is a natural rational map @xmath250\\ ! ] } \\dashrightarrow x^{[\\![\\alpha]\\!]}$ ] , defined on the open set where the moduli problem the two schemes solve is the same .",
    "we define a bundle @xmath251\\!]}$ ] such that @xmath252\\ ! ] } ) = e^{[\\![n]\\!]}$ ] on the locus where @xmath127 is defined . if @xmath245 is such that @xmath204 intersects the locus where @xmath127 is defined , we define a closed , irreducible subset @xmath253\\!]}$ ] . we have @xmath254\\ ! ] } = e^{[\\![n]\\!]}$ ] and @xmath255 .",
    "all the @xmath256 are pairwise birational in a natural way , which induces a graph like set @xmath257 , where the product is over all @xmath245 such that @xmath256 is defined .",
    "define the scheme @xmath199 as the closure of @xmath258 .",
    "the projections induce proper , birational morphisms from @xmath199 to every @xmath256 .",
    "we define the class @xmath259 by @xmath260\\!]}\\right),\\ ] ] suppressing the pullback of @xmath251\\!]}$ ] along @xmath261 .",
    "let @xmath262 . by the projection formula ,",
    "@xmath263 = \\deg f\\left(e^{[\\![n]\\!]}\\right ) \\cap [ t]$ ] , so the proof of the main theorem reduces to showing that @xmath263 $ ] is universal .",
    "we next define a class @xmath264 , where the @xmath265 are certain combinatorially defined integers .",
    "there is a natural morphism @xmath266 , and one should think of the class @xmath267 as being supported on ( a neighbourhood of ) the set @xmath268 , where @xmath269 is the small diagonal .",
    "the choice of the integers @xmath265 is motivated by the fact that they force @xmath267 to vanish on the complement of this locus .    for any @xmath270 ,",
    "the scheme @xmath51\\!]}$ ] is by definition a product of schemes @xmath271\\!]}$ ] with @xmath272 .",
    "this induces product decompositions of @xmath251\\!]}$ ] and @xmath256 , which allow us to express @xmath273 $ ] in terms of integrals of chern classes of @xmath274\\!]}$ ] over geometric subsets of @xmath271\\!]}$ ] with @xmath275 .",
    "by induction on @xmath7 we can thus show that @xmath276 $ ] is universal for @xmath277 .",
    "this argument gives lemma [ product ] , by which it suffices to show that @xmath278\\ ] ] is universal .",
    "consider the tangent bundle @xmath279 , and let @xmath280 be the natural compactification .",
    "let @xmath281 be the relative hilbert scheme .",
    "emulating the definition of @xmath199 and @xmath251\\!]}$ ] with @xmath281 replacing @xmath6}$ ] , we define the scheme @xmath282 and the bundles @xmath283\\!]}$ ] on @xmath282 . the classes @xmath284 are defined similarly to @xmath285 and @xmath267 .",
    "denote by @xmath286 the @xmath7-fold fibre product of @xmath287 over @xmath1 .",
    "there are natural morphisms @xmath288 and @xmath289 , where @xmath153 is given by composing @xmath290\\!]}$ ] and @xmath50\\ ! ] } \\to x^n$ ] , and @xmath291 is defined similarly .",
    "let @xmath269 be the small diagonal , and consider @xmath1 as a subset of @xmath286 using @xmath7 copies of the 0-section .",
    "let @xmath292 and @xmath293 be euclidean open neighbourhoods of @xmath294 and @xmath295 , respectively .",
    "choosing @xmath296 and @xmath297 small enough , we can define a topological isomorphism @xmath298 inducing ( topological ) isomorphisms of the bundles @xmath299\\!]}\\right ) \\cong e^{[\\![\\alpha]\\!]}$ ] .    the map @xmath127 is defined starting from ( the inverse of ) an exponential map on @xmath1 , analytic on the fibres of @xmath300 , which gives a continuous map @xmath6 } \\to \\hilb^n(\\ol{tx}/x)$ ] , defined in a neighbourhood of the locus of subschemes supported at a single point . by the similarity in the definition of @xmath199 and @xmath282 we show that this induces @xmath301 .",
    "the details of this construction are contained in lemmas [ f1]-[f3 ] .",
    "recall that the class @xmath267 was defined as a sum of @xmath75 and a linear combination of the @xmath285 .",
    "now , restricting the classes of this sum to @xmath302 it can be shown the terms of this sum will cancel , as a consequence of the fact that there are canonical local isomorphisms between the @xmath251\\!]}$ ] .",
    "hence , @xmath267 vanishes when restricted to @xmath302 .",
    "similarly , @xmath303 vanishes upon restriction to @xmath304 .",
    "thus , informally , the classes @xmath267 and @xmath303 are `` concentrated '' over @xmath296 and @xmath297 , respectively . making this more precise",
    ", we note that there are relative cohomology classes @xmath305 and @xmath306 lifting @xmath267 and @xmath303 .",
    "there is a map @xmath307 , defined by excision after shrinking @xmath296 and @xmath297 .",
    "lemma [ rel ] shows that we can choose @xmath308 and @xmath309 in such a way that the map @xmath310 . as a consequence of this ,",
    "we find @xmath278 = \\deg \\cd \\cap [ \\cq].\\ ] ] the proof of lemma [ rel ] is rather technical and occupies section [ section : lemmaproof ] .",
    "it remains to show that @xmath311 $ ] is universal . to this end , note first that @xmath282 is defined by the data of the type of @xmath204 and the tangent bundle @xmath279 , which roughly implies that it can be pulled back from a universal construction over a grassmannian .",
    "let @xmath312 be the universal rank @xmath4 subbundle over a grassmannian .",
    "here @xmath55 is any integer large enough that @xmath300 embeds as a topological subbundle of @xmath313 , so that we have a continuous classifying map @xmath314 with @xmath315 as topological bundles .",
    "we may define the scheme @xmath316 by the same construction as @xmath282 , replacing @xmath281 with @xmath317 .",
    "there is a natural morphism @xmath318 and a cartesian diagram of topological spaces .",
    "@xmath319 let @xmath320 be a classifying map for @xmath5 as a topological bundle , and consider the cartesian diagram @xmath321 note that the horizontal arrows in these diagrams are _ not _ required to be analytic , and we are here dealing with the underlying topological spaces .",
    "we define bundles @xmath322\\!]}$ ] on @xmath323 such that @xmath324\\!]}_{\\gr}\\right ) = \\ce^{[\\![\\alpha]\\!]}$ ] .    using this",
    "we then show that there is a class @xmath325 , depending only on @xmath33 and the type of @xmath204 , such that @xmath326 ) = ( f , h)^*(\\cg ) \\cap [ x].\\ ] ] now , as the rational cohomology ring of a grassmannian is generated by the chern classes of its universal bundle , @xmath327 is a polynomial in the chern classes of @xmath328 and @xmath5 . we show that this polynomial is independent of the choice of @xmath55 and @xmath54 .",
    "hence @xmath311 $ ] is a universal linear combination of the chern numbers of @xmath329 , which concludes the proof of the main theorem .",
    "we begin the formal proof of the main theorem . for notational simplicity",
    "we assume that @xmath330 , so there is only one vector bundle @xmath5 involved ; the general case is essentially the same . to avoid dealing with theorem [ mainthm ] and [ surfacethm ] separately , we use the following convention : when a formula includes @xmath331}}$ ] , terms involving @xmath331}}$ ] should be ignored unless @xmath332 , as should any statement involving @xmath331}}$ ] .    for part ( i )",
    ", it suffices to show treat the case where @xmath40 is irreducible .",
    "if @xmath40 is closed and irreducible , we have @xmath333 + $ ] terms of lower homological degree , hence it suffices to show ( ii ) . by the inclusion - exclusion property of csm classes , it finally suffices to prove ( ii ) for closed and irreducible @xmath40 .    in this section and",
    "the next , we have @xmath334 and @xmath33 as in the main theorem , assuming additionally that @xmath40 is closed and irreducible .    starting with @xmath50\\!]}$ ] , we will define several schemes equipped with morphisms to @xmath159 .",
    "given such an @xmath335 and a subset @xmath296 of @xmath159 , we write `` the restriction of @xmath29 to @xmath296 '' to mean @xmath336 , and denote this scheme by @xmath337 .      recall the definition of the hilbert scheme of ordered points @xmath50\\!]}$ ] , given by the cartesian diagram @xmath338\\ ! ] } @ > > > x^{[n ] } \\\\",
    "@vvv            @vvv \\\\",
    "x^n        @ >",
    "> > \\sym^n\\left(x\\right ) , \\end{cd}\\ ] ] where the right hand arrow is the hilbert - chow morphism .",
    "denote the pullbacks of @xmath8}$ ] and @xmath331}}$ ] along @xmath50\\!]}\\to x^{[n]}$ ] by @xmath241\\!]}$ ] and @xmath331}}^{[\\![n]\\!]}$ ] , respectively .",
    "we will use the projection formula to relate the degree of @xmath339 } , t_{x^{[n ] } } ) \\cap [ p]$ ] to a similar class involving @xmath241\\!]}$ ] and @xmath340}}^{[\\![n]\\!]}}$ ] on @xmath50\\!]}$ ] .",
    "the first step is to produce a closed , irreducible geometric subset @xmath183\\!]}$ ] mapping properly onto @xmath40 with universal degree .",
    "[ covering ] there exists a closed , irreducible geometric @xmath341\\!]}$ ] , such that @xmath50\\ ! ] } \\to x^{[n]}$ ] maps @xmath204 finitely onto @xmath40 .",
    "up to a permutation of @xmath171 inducing automorphisms of @xmath159 and hence of @xmath50\\!]}$ ] , the type of this @xmath204 depends only on the type of @xmath40 .",
    "as @xmath40 is closed and irreducible , by lemma [ lemma : geometric ] ( v ) we have @xmath342 for closed and irreducible punctual geometric subsets @xmath343 .",
    "we take @xmath212 to be a @xmath19-element partition of @xmath344 such that @xmath345 , and let @xmath346 .",
    "the claims of the lemma are easy to check .",
    "recall that @xmath347 denotes the chern - mather class of @xmath204 .",
    "let @xmath204 be a closed , irreducible geometric subset of @xmath50\\!]}$ ] . in order to prove the main theorem",
    ", it suffices to show that @xmath348\\ ! ] } , { t_{x^{[n]}}^{[\\![n]\\!]}}\\right ) \\cap c_m(t)\\ ] ] is given by a universal polynomial depending only on @xmath33 and the type of @xmath204 , such that the degree of the polynomial is at most @xmath26 , where @xmath26 is the maximum number of components of @xmath18 for @xmath349 .    let @xmath201\\ ! ] } \\to x^{[n]}$ ] be the natural morphism . by the inclusion - exclusion property of csm classes , it suffices to show the main theorem when @xmath181}$ ] is closed and irreducible .",
    "let @xmath183\\!]}$ ] be a closed , irreducible geometric set mapping finitely onto @xmath40 , as provided by lemma [ covering ] .",
    "the level sets of the local euler obstruction @xmath350 are geometric subsets contained in @xmath204 .",
    "this can be shown as follows . by lemma [ lemma : geometric ] ( iv ) , we may write @xmath204 as the union of sets of the form @xmath208 . let @xmath212 , and suppose @xmath351 .",
    "we have @xmath352 with @xmath16 of isomorphism type in @xmath12 and @xmath353 for @xmath354 .",
    "the local analytic type of @xmath157 in @xmath204 is determined by the isomorphism types of the @xmath16 .",
    "furthermore , there exists a local analytic neighbourhood of @xmath157 in @xmath204 which decomposes as a product @xmath355 , where the analytic type of @xmath356 is determined by the isomorphism type of @xmath16 .",
    "we then have @xmath357 the factor @xmath358 depends only on the isomorphism type of @xmath16 .",
    "this implies that the level sets of @xmath350 intersected with @xmath208 are geometric .",
    "it follows that the complete level sets of @xmath350 are geometric .",
    "as we have @xmath359 by definition , the class @xmath360 satisfies @xmath361 where the sum is finite and the @xmath68 are geometric subsets of @xmath50\\!]}$ ] of lower dimension than @xmath204 , with type depending only on the type of @xmath204 .",
    "by induction on @xmath362 the hypothesis of the lemma implies that @xmath363\\ ! ] } , { t_{x^{[n]}}^{[\\![n]\\ ! ] } } ) \\cap { c_{\\text{sm}}}(t)$ ] is universal .",
    "the functorial property of csm classes implies @xmath364 where the @xmath365 are subsets of @xmath6}$ ] , of lower dimension than @xmath40 .",
    "it is not hard to show that the @xmath365 are geometric of type depending only on the type of @xmath40 .",
    "induction on the dimension of @xmath40 now gives the main theorem as claimed .",
    "we will define schemes @xmath51\\!]}$ ] approximating @xmath50\\!]}$ ] , where @xmath245 is a partition of @xmath7 .",
    "first , we fix notation and conventions with respect to partitions .    a _ partition of _ @xmath7 is a set @xmath245 of subsets of @xmath248 , such that distinct elements of @xmath245 are disjoint , and such that the union of all elements in @xmath245 equals @xmath248 .",
    "note that this conflicts with a common usage of the term , where `` partition of @xmath7 '' means a way of writing @xmath7 as a sum of positive integers .",
    "the following definition summarizes the relevant notation for partitions .",
    "if @xmath245 is a partition of @xmath7 , let @xmath366 be the equivalence relation on @xmath171 given by letting the elements of @xmath245 form equivalence classes .",
    "define a partial ordering on the set of all partitions of @xmath7 by letting @xmath367 if every element of @xmath245 is contained in an element of @xmath368 .",
    "equivalently , we say @xmath367 if @xmath366 is a finer relation than @xmath369 .",
    "denote by @xmath247 the maximal partition under this ordering , that is , @xmath370",
    ".    given two partitions @xmath371 , we denote by @xmath372 $ ] the set of partitions @xmath373 such that @xmath374 , and define @xmath375 etc . similarly .      from this point on",
    ", we fix a closed , irreducible , geometric subscheme @xmath376\\!]}$ ] . in this section",
    ", we define the schemes @xmath51\\!]}$ ] , the bundles @xmath251\\ ! ] } , t_{x^{[n]}}^{[\\![\\alpha]\\!]}$ ] , the subsets @xmath377\\!]}$ ] , and the approximate classes @xmath285 and @xmath267 .    if @xmath245 is a partition of @xmath7 , define the scheme @xmath51\\!]}$ ] by @xmath246\\ ! ] } = \\prod_{a\\in\\alpha}x^{[\\![a]\\!]},\\ ] ] where @xmath378\\ ! ] } \\cong x^{[\\![|a|]\\!]}$ ] and parametrizes pairs @xmath379 such that @xmath380 is the fundamental cycle of @xmath18 .",
    "there is a natural morphism @xmath51\\ ! ] } \\to x^n$ ] defined by the decomposition @xmath381 and the natural morphisms @xmath378\\ ! ] } \\to x^a$ ] .",
    "define the vector bundles @xmath251\\!]}$ ] and @xmath331}}^{[\\![\\alpha]\\!]}$ ] on @xmath51\\!]}$ ] by @xmath382\\ ! ] } = \\bigoplus_{a\\in\\alpha } e^{[\\![a]\\!]}\\ \\ \\ \\ t_{x^{[n]}}^{[\\![\\alpha]\\ ! ] } = \\bigoplus_{a\\in\\alpha } t_{x^{[a]}}^{[\\![a]\\!]}\\ ] ] where we suppress pullback along the projection @xmath51\\ ! ] } \\to x^{[\\![a]\\!]}$ ] .    for suitable @xmath245 we will define schemes @xmath377\\!]}$ ] birational to @xmath204 .",
    "[ def : diagonal ] if @xmath245 is a partition of @xmath7 , denote by @xmath383 the subset of @xmath159 given by @xmath384 we refer to the sets @xmath383 as _",
    "diagonals_.    writing @xmath346 as in lemma [ lemma : geometric ] ( vi ) , it is easy to see that the image of @xmath204 in @xmath159 is a diagonal",
    ".    let @xmath385 be the partition such that @xmath386 is the image of @xmath204 under @xmath50\\ ! ] } \\to x^n$ ] .",
    "note that if @xmath387 and @xmath212 , we have @xmath388 .",
    "let @xmath245 be a partition , and let @xmath389\\ ! ] } \\dashrightarrow x^{[\\![\\alpha]\\!]}$ ] be the natural local isomorphism , defined on the open set where the moduli problems @xmath50\\!]}$ ] and @xmath51\\!]}$ ] solve are the same .",
    "specifically , @xmath390 is defined on the set of points @xmath178 where @xmath391 for all @xmath392 with @xmath393 .",
    "it is easy to check that the locus where @xmath390 is naturally defined intersects @xmath204 if and only if @xmath394 .",
    "if this is the case , we let @xmath256 be the closure of @xmath395 in @xmath51\\!]}$ ] .",
    "recall that @xmath396 denotes the nash blow up .",
    "as @xmath396 is birational , there is a natural rational map @xmath397 .",
    "[ defq ] let @xmath398 and define @xmath199 to be the closure of @xmath399 in @xmath400 .    for every @xmath245 there are birational proper morphisms @xmath401 .",
    "any cohomology class on @xmath256 and @xmath402 may be pulled back along these morphisms without changing the degree .",
    "as our goal is to compute the degrees of such classes , we will suppress pullbacks of bundles and cohomology classes .",
    "the schemes and bundles indexed by partitions @xmath245 give rise to `` approximate '' cohomology classes , which we now define .",
    "recall that @xmath247 denotes the maximal partition of @xmath7 , and that @xmath403 is the nash bundle on @xmath402 .",
    "[ def : calpha ] let @xmath245 be a partition @xmath404 .",
    "define the class @xmath259 by @xmath260\\ ! ] } , t_{x^{[n]}}^{[\\![\\alpha]\\!]}\\right ) \\cup c_\\bullet\\left(t_{{\\widetilde}{t_\\alpha}}\\right).\\ ] ] we let @xmath262 .",
    "note that the main theorem is reduced to the claim that @xmath405)$ ] is universal .",
    "[ def : d ] let @xmath245 be a partition @xmath404 . define the class @xmath406 by putting @xmath407 , and for @xmath408 let @xmath409 be defined inductively by @xmath410 we let @xmath411 .",
    "it is not hard to show that in fact @xmath412 . except in the proof of proposition [ genfunprop ] , we will not need this , and we work instead directly with the inductive definition of @xmath267 .    the motivation behind the definition of @xmath409 is the following .",
    "firstly , it follows trivially from the definition that if @xmath413)$ ] and @xmath414)$ ] are universal for @xmath415 , then @xmath416)$ ] is universal as well .",
    "secondly , @xmath267 is chosen such that the restriction of @xmath267 to @xmath417 vanishes , which allows us to reduce the computation of its degree to studying a small neighbourhood of @xmath418 .",
    "if @xmath245 is a nonmaximal partition of @xmath7 , the scheme @xmath51\\!]}$ ] is by definition a product of schemes @xmath271\\!]}$ ] with @xmath272 . as a consequence of this",
    ", the computation of @xmath285 can be reduced to similar computations on such @xmath271\\!]}$ ] .",
    "this yields the following induction result .",
    "[ product ] let @xmath45 be a positive integer",
    ". suppose that theorem [ mainthm]/[surfacethm ] holds for every @xmath420 , and suppose that for @xmath421 the degree of @xmath422 $ ] is given by a universal linear polynomial in the chern numbers of @xmath329 .",
    "then theorem [ mainthm]/[surfacethm ] holds for @xmath421 .",
    "assume that the theorem holds for every @xmath420 .",
    "we shall then show that for every partition @xmath423 , the degree of @xmath285 is expressed by a universal polynomial .",
    "we have @xmath424 , hence the statement of the lemma follows from this .",
    "let @xmath245 be a partition @xmath404 .",
    "recall first that by definition there is a product decomposition @xmath246\\ ! ] } = \\prod_{a\\in \\alpha } x^{[\\![a]\\!]}.\\ ] ] this gives rise to a product decomposition @xmath425 , where the @xmath426\\!]}$ ] are closed , irreducible , geometric subsets .",
    "since the nash blow up preserves products , we have @xmath427 , as well as the bundle decompositions @xmath251\\ ! ] } = \\oplus e^{[\\![a]\\!]}$ ] , @xmath428 and @xmath331}}^{[\\![\\alpha]\\ ! ] } = \\oplus t_{x^{[n]}}^{[\\![a]\\!]}$ ] .",
    "now , using the whitney sum formula we can find a universal expression for @xmath260\\ ! ] } , t_{x^{[n]}}^{[\\![\\alpha]\\!]}\\right ) \\cdot c_\\bullet\\left(t_{{\\widetilde}{t_\\alpha}}\\right)\\ ] ] as a polynomial in the chern classes of @xmath429\\!]}$ ] , @xmath331}}^{[\\![a]\\!]}$ ] , and @xmath430 for different @xmath431 . assuming that @xmath432",
    ", we have @xmath433 for every @xmath431 . by the induction hypothesis",
    ", we find a universal polynomial for @xmath434 = \\deg c_\\alpha \\cap [ t_\\alpha],\\ ] ] as required .",
    "the claim about the degree of the universal polynomial @xmath37 in the main theorem also follows by induction , using the assumption that @xmath413)$ ] is linear as a polynomial in the chern numbers of @xmath329 .",
    "since the theorem is clear for @xmath187 , in order to complete the proof of it now suffices to show that the degree of @xmath422 $ ] is given by a linear polynomial in the chern numbers of @xmath329 .",
    "as previously mentioned , the class @xmath267 vanishes when restricted to the part of @xmath199 lying over the complement of the small diagonal @xmath435 .",
    "it may thus essentially be computed by looking at a neighbourhood of @xmath418 .",
    "the next step is now to use this to show the degree of @xmath267 equals that of a class @xmath436 , where @xmath282 is a scheme defined similarly to @xmath199 , but with @xmath6}$ ] replaced with the relative hilbert scheme @xmath281 .",
    "we therefore repeat the constructions of approximating schemes and classes in this relative setting .",
    "these are for the most part straightforward analogues of the absolute constructions , except for the scheme @xmath437 that corresponds to @xmath204 ( and so every scheme derived from @xmath437 , i.e. @xmath438 ) , where we impose the condition that the first marked point must lie in the 0-section @xmath439 .    in order to integrate cohomology classes we need our schemes to be proper . hence we let @xmath440 denote the @xmath441-bundle @xmath442 , with the convention that @xmath443 is the set of lines through the origin in @xmath128 .",
    "let @xmath444 be the projection , and let @xmath445 , @xmath446 and @xmath281 denote the fibre product , relative symmetric product and relative hilbert scheme , respectively .",
    "define the scheme @xmath447\\!]}$ ] by the cartesian diagram @xmath448\\ ! ] } @ > > > \\hilb^n\\left(\\ol{tx}/x\\right ) \\\\    @vvv                    @vvv              \\\\",
    "\\ol{tx}^n / x        @ > > > \\sym^n\\left(\\ol{tx}/x\\right ) .",
    "\\end{cd}\\ ] ]    let @xmath449}$ ] be the tautological bundle on @xmath450 corresponding to the vector bundle @xmath451 on @xmath287 , and let @xmath452\\!]}$ ] be the pullback of @xmath449}$ ] to @xmath447\\!]}$ ] . if @xmath46 or 2 , let @xmath453}}$ ] be the relative tangent bundle of @xmath454 , and denote its pullback to @xmath447\\!]}$ ] by @xmath455}}^{[\\![n]\\!]}$ ] .",
    "let @xmath245 be a partition of @xmath7 .",
    "define the scheme @xmath456\\!]}$ ] by @xmath457\\ ! ] } = \\prod_{a\\in \\alpha } \\ol{tx}^{[\\![a]\\!]},\\ ] ] where the product is fibre product over @xmath1 .",
    "define the bundles @xmath283\\!]}$ ] and @xmath458}}}^{[\\![\\alpha]\\!]}$ ] on @xmath459\\!]}$ ] by @xmath460\\ ! ] } = \\bigoplus_{a\\in \\alpha } \\ce^{[\\![a]\\!]},\\ \\ \\ \\ { t_{\\ol{tx}^{[n]}}}^{[\\![\\alpha]\\ ! ] } = \\bigoplus_{a \\in \\alpha } t_{\\ol{tx}^{[a]}}^{[\\![a]\\!]}\\ ] ] suppressing notation for the natural pullbacks .",
    "let @xmath461 be the subset of @xmath447\\!]}$ ] consisting of the labelled subschemes @xmath178 such that @xmath157 is isomorphic to a labelled subscheme in @xmath204 , where isomorphism of labelled schemes is as defined above lemma [ lemma : geometric ] .",
    "put differently , if @xmath462\\!]}$ ] denotes the fibre of @xmath447\\ ! ] } \\to x$ ] at @xmath131 , then @xmath461 is the set such that @xmath463\\!]}$ ] is a geometric subset of the same type as @xmath204 for all @xmath464 .    let @xmath465\\ ! ] } \\to \\ol{tx}$ ] be the morphism defined by @xmath466 , and define @xmath437 to be @xmath467 , where @xmath439 is embedded by the 0-section .    for every partition @xmath245 , there is a local isomorphism @xmath468\\ ! ] } \\dashrightarrow \\ol{tx}^{[\\![\\alpha]\\!]}$ ] , defined where the moduli problems the two schemes solve are the same . using these maps",
    ", we may replace @xmath204 by @xmath437 in definition [ defq ] and the preceding paragraphs , thus defining the schemes @xmath469 ( for @xmath394 ) , @xmath470 and @xmath282 .",
    "we omit the details .",
    "finally , we define the relative analogues of the classes @xmath285 , @xmath409 .",
    "let @xmath245 be a partition @xmath404 .",
    "define @xmath471 by @xmath472\\ ! ] } , { t_{\\ol{tx}^{[n]}}}^{[\\![\\alpha]\\!]}\\right ) \\cdot c_\\bullet\\left(t_{{\\widetilde}{\\ct_\\alpha}}\\right).\\ ] ] let @xmath473 .",
    "let @xmath245 be a partition @xmath404 .",
    "define @xmath474 by putting @xmath475 , and for @xmath408 define @xmath476 inductively by @xmath477 let @xmath478 .      for notational convenience",
    ", we will in the following write @xmath286 for the @xmath7-fold fibre product of @xmath287 over @xmath1 .",
    "let @xmath481 be the restriction of @xmath199 to the small diagonal @xmath435 .",
    "define @xmath482 similarly as the restriction of @xmath282 to the set @xmath483 where the inclusion of @xmath1 is given by @xmath7 copies of the 0-section .",
    "the classes @xmath267 and @xmath303 are related by the following lemma and its corollary .",
    "there exists a pair of open neighbourhoods @xmath484 of @xmath485 in @xmath199 , a pair of open neighbourhoods @xmath486 of @xmath487 in @xmath282 , a homeomorphism @xmath488 , and a class @xmath489 lifting @xmath490 , such that the composition @xmath491 sends the class @xmath492 to @xmath267 .",
    "[ rel ]    the degree of @xmath422 $ ] equals the degree of @xmath493 $ ] .",
    "[ equaldegrees ]    there are relative fundamental classes @xmath494 $ ] , @xmath495 $ ] , @xmath496 $ ] and @xmath497 $ ] in the appropriate homology groups . replacing @xmath498 with @xmath499 in the above sequence ( and reversing the arrows ) each fundamental class",
    "is sent to the next , so in the composition the class @xmath500 $ ] is sent to @xmath501 $ ] .",
    "this implies @xmath278 = \\deg \\ol{\\cd } \\cap [ ( \\cq,\\cq \\sm \\cu^\\pr)].\\ ] ] now , @xmath502 $ ] is the push - forward of @xmath503 $ ] , which shows that @xmath504 = \\deg \\cd \\cap [ \\cq]$ ] , completing the proof .",
    "the proof of lemma [ rel ] is quite technical and is postponed to section [ section : lemmaproof ] .",
    "we now show how the main theorem follows from corollary [ equaldegrees ] .    by corollary [ equaldegrees ] ,",
    "if @xmath311 $ ] is given by a universal linear polynomial , the same is true for @xmath505 $ ] , which by lemma [ product ] would imply the main theorem .",
    "every construction made in section [ relativesection ] starting from @xmath506 can be carried out with the bundle @xmath279 replaced by an arbitrary algebraic rank @xmath4 vector bundle . in particular",
    ", we may construct the analogue of @xmath282 starting from the universal rank @xmath4 subbundle @xmath507 , where @xmath55 is any integer large enough that @xmath300 is the pullback of @xmath296 along a continuous classifying map @xmath508 . call this scheme @xmath316 ,",
    "let @xmath509 be the natural morphism , and denote the analogues of @xmath469 by @xmath510 .",
    "let @xmath99 be the rank of @xmath5 , and let @xmath54 be a sufficiently large integer .",
    "there is then a cartesian diagram @xmath511 in the category of topological spaces , where @xmath153 is the product of the topological classifying maps for the bundles @xmath300 and @xmath5 .",
    "note that @xmath127 and @xmath153 are in general not analytic .",
    "let @xmath512 be the universal subbundle . if @xmath394 , let the bundle @xmath513\\!]}$ ] on @xmath514 be defined by @xmath515\\ ! ] } = v \\otimes \\co_{\\ol{u}^n}^{[\\![\\alpha]\\!]},\\ ] ] where @xmath128 and @xmath516\\!]}$ ] are pulled back from @xmath517 and @xmath316 , respectively .",
    "we then have @xmath518\\ ! ] } ) = \\ce^{[\\![\\alpha]\\!]}$ ] .",
    "the scheme @xmath316 also carries a bundle @xmath519}}^{[\\![\\alpha]\\!]}$ ] , defined in the same way as @xmath458}}}^{[\\![\\alpha]\\!]}$ ] .",
    "it is easy to check that @xmath520}}^{[\\![\\alpha]\\ ! ] } ) = { t_{\\ol{tx}^{[n]}}}^{[\\![\\alpha]\\!]}$ ] .    for any @xmath521 ,",
    "define the relative nash bundle @xmath522 on @xmath316 as the kernel of the natural map @xmath523 .",
    "this map is surjective , as can be seen easily from the fact that @xmath524 is a locally trivial fibration .",
    "hence there is a short exact sequence @xmath525 similarly define @xmath526 by the short exact sequence @xmath527    we then have @xmath528 . define a bundle @xmath529 on @xmath316 by @xmath530 . in k - classes",
    "we then have @xmath531 .",
    "define the class @xmath532 by @xmath533\\ ! ] } , t_{\\ol{u}^{[n]}}^{[\\![\\alpha]\\!]}\\right ) \\cdot c_\\bullet(g_\\alpha).\\ ] ] the above discussion shows that @xmath534 .",
    "it is easy to check that we have @xmath535 , which implies @xmath536 ) = \\deg(g^*((q\\times \\id)_!(\\cc_{\\alpha,\\gr } ) ) \\cap [ x]).\\ ] ]    any rational cohomology class on @xmath537 is a polynomial in chern classes of the universal bundles .",
    "in particular , @xmath538 is equal to such a polynomial .",
    "the right hand side of the above equation is thus a linear combination of the chern numbers of @xmath329 .",
    "it remains to be seen that this linear polynomial is independent of @xmath54 and @xmath55 .",
    "but this follows from the fact that for @xmath54 and @xmath55 sufficiently large , the class @xmath539 is preserved by the pullbacks induced by the natural morphisms @xmath540 and @xmath541 .",
    "consequently , the degree of @xmath542 $ ] and thus that of @xmath543 is a universal linear combination of the chern numbers of @xmath329 . as @xmath303 is a universal linear combination of the @xmath543 , the claim follows .",
    "let @xmath544 be the projection to the first and second factor , and let @xmath545 be the tangent bundle .",
    "[ f1 ] there is an open neighbourhood @xmath546 of the diagonal @xmath547 , an open neighbourhood @xmath548 of the 0-section @xmath549 and a homeomorphism @xmath550 , such that @xmath551 and such that @xmath552 is the natural identity map between @xmath553 and the 0-section of @xmath300 .",
    "furthermore , the restriction of @xmath554 to each fibre @xmath555 is holomorphic .",
    "there is an isomorphism of topological vector bundles @xmath556 , which is an isomorphism of holomorphic bundles on the restriction to each fibre @xmath555 .",
    "[ li ]    see ( * ? ? ?",
    "* lemma 2.4 ) for the first statement . essentially , ( the inverse of ) holomorphic exponential maps can be constructed on small open sets , and these can be globalized using a partition of unity .",
    "globalizing breaks analyticity of the map , but preserves it on fibres of @xmath557 as required .    for the statement about @xmath5 , we argue similarly .",
    "cover @xmath1 with open balls @xmath73 , and choose holomorphic trivialization @xmath558 . using these ,",
    "define local isomorphisms @xmath559 .",
    "let @xmath560 be a partition of unity subordinate to the covering @xmath561 , and define @xmath562 at @xmath563 by @xmath564 .",
    "it is easy to check that @xmath153 is holomorphic on fibres of @xmath557 .",
    "restricted to @xmath553 , the map @xmath153 is the identity , and so shrinking @xmath546 if necessary , @xmath153 is an isomorphism .",
    "let @xmath50\\!]}_0 \\subset x^{[\\![n]\\!]}$ ] be the set of points @xmath157 such that @xmath18 is supported at a single point , and let @xmath565\\!]}_0 \\subset \\ol{tx}^{[\\![n]\\!]}$ ] denote the set of points @xmath157 such that @xmath18 is supported at the 0-section of @xmath287 . let @xmath566\\ ! ] } \\to x$ ] be defined by @xmath567 , and let @xmath568\\ ! ] } \\to \\ol{tx}$ ] be defined similarly .",
    "let @xmath66 be the set of pairs @xmath569\\!]}$ ] such that @xmath570 lies in the 0-section of @xmath287 .",
    "[ f2 ] there is an open neighbourhood @xmath571 of @xmath50\\!]}_0 $ ] in @xmath50\\!]}$ ] , an open neighbourhood @xmath572 of @xmath565\\!]}_0 $ ] in @xmath66 , and a homeomorphism @xmath573 , such that @xmath574 furthermore , for every point @xmath464 , the restriction of @xmath575 to a map @xmath576 is holomorphic .",
    "there are isomorphisms of topological vector bundles @xmath577}}^{[\\![n]\\ ! ] } ) \\to t_{x^{[n]}}^{[\\![n]\\!]}$ ] and @xmath578\\!]}\\right ) \\to e^{[\\![n]\\!]}$ ] .",
    "let @xmath546 , @xmath548 and @xmath554 be as provided by lemma [ f1 ] . in every fibre @xmath579\\!]}$ ]",
    "there is an open subset @xmath580 of @xmath581 defined by the condition that the support of the subscheme is contained in @xmath582 .",
    "define the map @xmath575 on @xmath583\\!]}$ ] by @xmath584 .",
    "this is a local homeomorphism which is analytic as a map @xmath576 .",
    "it is easy to check from the definition of @xmath575 that the natural morphism @xmath331}}^{[\\![n]\\ ! ] } \\to f_2^*(t_{\\ol{tx}^{[n]}}^{[\\![n]\\!]})$ ] is an isomorphism , and the isomorphism @xmath585 of lemma [ f1 ] induces an isomorphism of topological vector bundles @xmath586\\ ! ] } ) \\to e^{[\\![n]\\!]}$ ] .",
    "recall that @xmath587 and @xmath588 are the subsets of points having image in @xmath269 and @xmath483 under the natural morphisms @xmath266 and @xmath589 , respectively .",
    "let the relative nash bundles @xmath590 and @xmath591 be the kernels of the surjective homomorphisms @xmath592 and @xmath593 , respectively .",
    "there is an open neighbourhood @xmath296 of @xmath485 in @xmath199 , an open neighbourhood @xmath297 of @xmath487 in @xmath282 , and a homeomorphism @xmath298 , as well as homomorphisms @xmath594\\ ! ] } ) \\to e^{[\\![\\alpha]\\!]},\\ ] ] @xmath595}}^{[\\![\\alpha]\\ ! ] } ) \\to t_{x^{[n]}}^{[\\![\\alpha]\\!]},\\ ] ] and @xmath596 which are isomorphisms of topological vector bundles on @xmath296 .",
    "[ f3 ]    the proof of the previous lemma can easily be modified to show that there are local isomorphisms @xmath597 .",
    "the nash blow up is determined analytically locally , and @xmath598 and @xmath599 are both locally trivial fibrations in a neighbourhood of @xmath485 and @xmath487 . hence the nash blow ups are locally fibrations as well . using this , it is easy to see that one gets local homeomorphisms @xmath600 agreeing with the maps @xmath597 on the nonsingular loci of @xmath256 and @xmath469 .",
    "this in turn induces a local isomorphism @xmath601 .",
    "the first bundle isomorphism follows from the one produced in lemma [ f2 ] , and taking into account the fact that @xmath597 is holomorphic on the fibres of @xmath106 and @xmath99 , we get the second and third .      in order to prove the claim of lemma [ rel ]",
    ", we will construct the relative cohomology classes @xmath602 and @xmath603 explicitly as singular cochains .",
    "we first define certain open subsets @xmath604 , @xmath605 of @xmath159 , which we will need in order to compare the bundles @xmath251\\!]}$ ] ( @xmath331}}^{[\\![\\alpha]\\!]}$ ] , @xmath606 ) for various @xmath245 .",
    "let @xmath607 be a metric on @xmath1 inducing the euclidean topology .",
    "define a metric @xmath608 on @xmath159 by @xmath609 let @xmath610 be a metric on @xmath287 inducing the euclidean topology , and let @xmath611 be the metric on @xmath286 defined similarly to @xmath608 .",
    "let @xmath612 and let @xmath245 be a partition . recall that @xmath613 is the diagonal set @xmath614 and let @xmath615 be defined in the same way . in the following , we will use the inequalities @xmath616 and their variants for @xmath610 and @xmath611 , all of which follow easily from the definitions and the triangle inequality .",
    "let @xmath617 be the set of partitions of @xmath7 , and let @xmath618 be a function such that the quantities @xmath619 and @xmath620 are both sufficiently small .",
    "let @xmath621 be the open @xmath622-neighbourhood of @xmath623 , and let @xmath624 be the open @xmath622-neighbourhood of @xmath615 .",
    "let @xmath371 be partitions such that @xmath367 .",
    "define the set @xmath625 as @xmath626 and define the set @xmath627 as @xmath628    let @xmath629 .",
    "define an equivalence relation @xmath630 on the set of partitions by saying @xmath631 if @xmath366 and @xmath369 agree when evaluated on the pair @xmath632 . for any pair of partitions @xmath371 ,",
    "define the set @xmath633 to be the set of points over which @xmath51\\!]}$ ] and @xmath634\\!]}$ ] are not canonically equal .",
    "explicitly , we have @xmath635 where @xmath636 denotes the set of points @xmath612 for which @xmath637 .",
    "define @xmath638 similarly .",
    "the following lemma summarizes the important properties of @xmath605 and @xmath639 .    1 .",
    "let @xmath368 be a partition .",
    "the sets @xmath640 form an open covering of @xmath641 .",
    "the sets @xmath642 form an open covering of @xmath643 .",
    "2 .   let @xmath644 be partitions such that @xmath645 and @xmath646 .",
    "then @xmath647 3 .",
    "let @xmath648 , and let @xmath649 .",
    "if @xmath650 , we have @xmath651 .",
    "if @xmath652 , we have @xmath653 .",
    "[ opencovering ]    we prove the statements for @xmath605 ; the case of @xmath639 is exactly the same .    _",
    "( i ) : _ assume @xmath654 , and let @xmath245 be maximal among partitions @xmath655 such that @xmath656 .",
    "such a partition exists because for the smallest partition @xmath657 , we have @xmath658 . we claim that @xmath659 .",
    "assume @xmath660 , there is then a partition @xmath373 such that @xmath646 , @xmath661 and @xmath662 . by the maximality property of @xmath245",
    ", we can not have @xmath663 .",
    "it follows that @xmath664 , where @xmath665 is the smallest partition majorizing @xmath245 and @xmath373 .",
    "let @xmath392 be two indices such that @xmath666 , and such that @xmath667 is maximal among pairs with this property .",
    "there is a sequence of integers @xmath668 such that @xmath669 , @xmath670 and such that for every @xmath19 with @xmath671 , either @xmath672 or @xmath673 is true .",
    "by , we now have @xmath674 where the last step uses the second condition in the definition of @xmath675 .",
    "hence we have @xmath676 , which contradicts either the maximality of @xmath245 or the fact that @xmath677 .    _",
    "( ii ) : _ obvious from the definition .    _",
    "( iii ) : _ let @xmath678 .",
    "for every @xmath679 , let @xmath680 be the partition defined by the equivalence relation such that @xmath681 and no other nontrivial relations hold .",
    "if @xmath649 , we have @xmath682 for every pair @xmath392 occurring in the union , we have @xmath683 , hence by part ( ii ) of the lemma we have @xmath684 .",
    "this gives @xmath685    recall that @xmath686 and @xmath686 are the relative nash bundles defined above lemma [ f3 ] .",
    "denote by @xmath687 the trivial bundle of rank @xmath55 .    1 .   for each @xmath394 ,",
    "let @xmath688 denote either @xmath251\\ ! ] } , t_{{\\widetilde}{t_\\alpha}/x}$ ] or @xmath331}}^{[\\![\\alpha]\\!]}$ ] , considered as a topological bundle on @xmath199 .",
    "there is an integer @xmath54 and for every @xmath245 an injection @xmath689 such that if @xmath367 , then over @xmath690 the bundles @xmath691\\!]}\\right)$ ] and @xmath692\\!]}\\right)$ ] are equal as subbundles of @xmath693 .",
    "2 .   for each @xmath394 , let @xmath694 denote either @xmath283\\ ! ] } , t_{{\\widetilde}{\\ct_\\alpha}/x}$ ] or @xmath458}}}^{[\\![\\alpha]\\!]}$ ] , considered as a topological bundle on @xmath282 .",
    "there is an integer @xmath55 and for every @xmath245 an injection @xmath695 such that if @xmath367 , then over @xmath696 the bundles @xmath697\\!]}\\right)$ ] and @xmath698\\!]}\\right)$ ] are equal as subbundles of @xmath687 .",
    "3 .   let @xmath298 be the local homeomorphism constructed in lemma [ f3 ] .",
    "we may choose @xmath699 and the injections @xmath700 in such a way that the diagram @xmath701 of bundles on @xmath296 commutes , where the upper isomorphism is the one constructed in lemma [ f3 ] .",
    "[ bundles ]    in this proof , all partitions are assumed to be @xmath404 .",
    "( i ) : for each @xmath245 choose first an injective homomorphism @xmath702 .",
    "let @xmath703 be the natural isomorphisms , defined over @xmath704 .",
    "recall that @xmath705 .",
    "let @xmath706 be a continuous function such that when @xmath707 we have @xmath708 and such that when @xmath709 we have @xmath710 . for @xmath711",
    ", put @xmath712 , where @xmath713 is the natural morphism .",
    "let @xmath714 as @xmath715 is supported away from @xmath716 , the homomorphism @xmath717 is defined on the whole of @xmath199 .",
    "for any two partitions @xmath245 and @xmath373 , let @xmath718 .",
    "we take @xmath719 , and set @xmath720 it remains to show that @xmath721 has the properties stated .",
    "as @xmath722 is injective , it is clear that @xmath721 is an injection .",
    "let @xmath649 , and let @xmath373 be arbitrary . first we show that if @xmath711 lies over @xmath605 , then @xmath723 to this end , observe that @xmath724 where each @xmath725 . now , since @xmath726 , we have @xmath727 for every factor above , using lemma [ opencovering ] ( iii ) .",
    "hence , the equation @xmath728 holds . if @xmath729 , this shows . if not , then all the morphisms @xmath730 are defined at @xmath131 , and by the naturality of these the cocycle condition @xmath731 holds .",
    "the above paragraph shows that @xmath732 over @xmath605 and hence @xmath733 .",
    "consequently the two subbundles @xmath734 and @xmath735 of @xmath736 are equal as claimed .",
    "( ii ) : similar to _ ( i)_.    ( iii ) : let @xmath737 be the homomorphisms defined like the @xmath738 in the proof of _ ( i)_. let @xmath739 be the isomorphism of lemma [ f3 ] .",
    "it is easy to see that we then have @xmath740 .",
    "let @xmath741 and @xmath742 be smaller open neighbourhoods of @xmath485 and @xmath487 , such that @xmath743 .",
    "let @xmath744 be a nonnegative real function which is 1 on @xmath745 and 0 on the complement of @xmath296 .",
    "replace @xmath721 with @xmath746 where @xmath695 is the homomorphism of part _",
    "( ii)_. replacing @xmath747 with @xmath748 , then obviously @xmath749 over @xmath745 . after replacing @xmath296 with @xmath745",
    ", it now remains to be shown that the statement in part _",
    "( i ) _ of the lemma still holds for @xmath750 .    after enlarging the metric on @xmath287 and shrinking @xmath296 and @xmath297",
    ", we may assume that if @xmath751 lies over @xmath605 , then @xmath752 lies over @xmath639 .",
    "over @xmath605 we thus have @xmath753    we are now in a position to finish the proof of lemma [ rel ] .",
    "let @xmath245 be a partition @xmath404 .",
    "the inclusions produced in lemma [ opencovering ] ( ii ) define a continuous map @xmath754 , where the @xmath755 are grassmannians with universal bundles @xmath756 , such that @xmath757\\!]}\\ \\ \\ \\",
    "f_\\alpha^*(w_2 ) = { t_{\\ol{tx}^{[n]}}}^{[\\![\\alpha]\\ ! ] } , \\ \\ \\ \\ f_\\alpha^*(w_3 ) = t_{{\\widetilde}{\\ct_{\\alpha}/x } } \\oplus r^*(t_x).\\ ] ] note that at the level of chern classes , we may interchange @xmath758 with @xmath759 , as these are topologically isomorphic .",
    "choose a singular cochain @xmath216 on @xmath760 representing the class @xmath761 define singular cochains @xmath762 and @xmath763 by @xmath764 and @xmath765 clearly , the class of @xmath762 and @xmath766 is @xmath543 and @xmath476 , respectively .",
    "let @xmath767 and @xmath768 .",
    "we now claim that @xmath769 . to prove this ,",
    "we show that @xmath770 for any partition @xmath368 by ascending induction on the ordering of partitions .",
    "the base case is clear , as @xmath771 .",
    "assume now that @xmath772 for every @xmath649 .",
    "we must show that for every singular @xmath45-simplex @xmath773 we have @xmath774 .    since @xmath775 is a cocycle",
    ", we may replace @xmath776 by any subdivision of @xmath776 and prove the vanishing for each simplex in the subdivision . by lemma [ opencovering ] ( i )",
    ", @xmath642 is an open covering of @xmath777 , so we may assume there is an @xmath649 such that @xmath776 maps into @xmath778 .",
    "if @xmath661 is such that @xmath646 , then by lemma [ opencovering ] ( ii ) we have @xmath779 , and so by the induction hypothesis @xmath780 .",
    "this implies @xmath781 where the last equality follows directly from the definition of @xmath766 . by lemma [ bundles ] ( ii )",
    "we have @xmath782 over @xmath639 , hence @xmath783 and the claim follows .",
    "taking @xmath675 small enough we may assume that @xmath784 lies over @xmath785 , and then the above shows @xmath309 is a relative cocycle for the pair @xmath786 .",
    "the exact same construction performed on @xmath199 produces a cochain @xmath787 of class @xmath409 which vanishes on @xmath788 . by lemma [ bundles ] ( iii ) , the homomorphism @xmath789 sends @xmath309 to @xmath308 , which proves lemma [ rel ] .",
    "this concludes the proof of theorems [ mainthm ] and [ surfacethm ] .",
    "as was noted in @xcite and elsewhere , the existence of universal polynomials often implies a stronger statement about the form of the generating function of all chern integrals .",
    "let @xmath1 be as in the main theorem , let @xmath168 be closed , irreducible punctual geometric subsets with @xmath790 , and let @xmath791 be nonnegative integers .",
    "let @xmath792 be a sequence of length @xmath793 with each @xmath12 appearing @xmath71 times .",
    "let @xmath794 , and define the set @xmath795},\\ ] ] in the notation of definition [ def : standardgeometric ] .    in other words ,",
    "the set @xmath796 is the closure of the set of @xmath18 such that @xmath18 is the disjoint union of @xmath797 subschemes from @xmath233 , @xmath798 subschemes from @xmath799 , and so on .",
    "let @xmath800 denote the monoid of all @xmath19-variable chern monomials ( including the unit monomial ) under multiplication .",
    "theorem [ mainthm ] now yields the following result .",
    "[ genfunprop ] let @xmath1 be a smooth , connected projective variety of dimension @xmath4 , let @xmath32 be algebraic vector bundles and let @xmath801 be closed , irreducible punctual geometric subsets such that the @xmath12 are pairwise distinct .",
    "let @xmath802 be the ring @xmath803\\!]$ ] , where the @xmath131-variable is graded by @xmath800 .",
    "then , for every @xmath804 there exists a @xmath805 , depending only on the @xmath12 and the ranks of the @xmath39 , such that @xmath806})_{i=1}^k\\right ) \\cap [ p((q_j^{m_j})_{j=1}^l ) ] x^m y_1^{m_1}\\cdots y_l^{m_l } = \\\\ & \\prod_{n\\in{cm}\\left(k+1,d\\right ) } b_n^{n\\left(t_x , e_1 , \\ldots , e_k\\right)}.\\end{aligned}\\ ] ] if @xmath807 is 1 or 2 , the same statement holds with @xmath808}))$ ] replaced by @xmath809}},(e_i^{[n]}))$ ] and @xmath810 replaced with @xmath811 .",
    "we treat the case without the @xmath331}}$ ] , the case including @xmath331}}$ ] is essentially the same .",
    "let @xmath127 be the generating function on the left hand side of the equation in the proposition .",
    "we show that the logarithm of @xmath127 is linear in the chern numbers of @xmath812 , hence it is of the form @xmath813 for elements @xmath814 . taking @xmath815",
    "then yields the proposition .",
    "the fact that @xmath816 is linear is a consequence of the linearity of the chern polynomial evaluating @xmath817 $ ] , where @xmath267 and @xmath204 are as in the proof of the main theorem .",
    "fix integers @xmath71 , let @xmath818 $ ] , and let @xmath204 be a set covering @xmath40 as in the proof of the main theorem .    using the irreducibility and distinctness of the @xmath12 , it is easy to show that there are points @xmath819 for every @xmath17 , such that @xmath16 is not isomorphic to a point in @xmath820 if @xmath821 . for a point in @xmath40",
    "isomorphic to @xmath71 disjoint copies of each @xmath16 , there are @xmath822 points in @xmath204 lying over it , which implies that @xmath823",
    ".    now , let @xmath824\\ ! ] } ) ) \\cap [ t ] x^m.\\ ] ] let @xmath385 be the partition of @xmath7 as in the main proof , and for every partition @xmath394 , let @xmath825\\ ! ] } ) ) \\cap [ t_\\alpha ] x^m,\\ ] ] where @xmath256 is as in the proof of the main theorem .",
    "for any set @xmath826 such that @xmath216 is a union of sets from @xmath385 , let @xmath827 be the set of labels corresponding to subschemes isomorphic to @xmath828 in the labelling induced by @xmath204 .",
    "suppose @xmath829 is such that @xmath830 , and let @xmath831 .",
    "let @xmath832\\!]}$ ] be the scheme covering @xmath833 . in the notation of the main proof , we then have @xmath834 . let @xmath835\\ ! ] } ) ) \\cap [ t_a ] x^m,\\ ] ] the argument of the proof of lemma [ product ] then shows @xmath836    let now @xmath837\\!]}))$ ] , and let @xmath838 be defined in terms of these as in definitions [ def : calpha ] and [ def : d ] . by the remark following these definitions",
    ", we have @xmath839 we thus let @xmath840 as each @xmath838 is linear in the chern numbers of @xmath841 , the same will be true for the coefficients of @xmath842 in @xmath843 .",
    "we claim that for every @xmath54 , the coefficient of @xmath842 in @xmath843 equals that of the @xmath844-term of @xmath845 . using @xmath846 , together with the fact that @xmath847 is @xmath848 times the sum of the @xmath849 terms of @xmath127 for different @xmath54",
    ", it is now a combinatorial exercise to match up the terms of @xmath843 and @xmath850 .",
    "we present some applications of the main theorem to the problem of counting geometric objects with prescribed singularities .",
    "we treat three different problems . in section [ section : curvecount ]",
    "we study curves on a surface having prescribed singularity type , where by singularity type we mean either analytic or topological ( equisingular ) type .",
    "if @xmath0 is a sufficiently ample line bundle on a surface @xmath52 , we show that the number of such curves in a general linear system @xmath2 of appropriate dimension is given by a universal polynomial in the chern numbers of @xmath65 . a somewhat more general result to this effect",
    "has recently been obtained independently by li and tzeng in @xcite , using a similar method .    in section [ divisorcount ] ,",
    "we consider divisors having fixed isolated analytic singularity types on a smooth variety @xmath1 of arbitrary dimension .",
    "we show that the number of such in a general linear system @xmath2 is universal .",
    "the proofs carry over verbatim from the analytic curve singularity case and are omitted",
    ".    finally , in section [ bpssection ] , we consider again the case of curves on a surface .",
    "we study the locus @xmath851 of curves having prescribed `` bps spectrum '' @xmath45 and show that if @xmath0 is sufficiently ample , the euler characteristic of @xmath852 is universal .",
    "all of our results use the assumption that @xmath0 is sufficiently ample .",
    "this is required to ensure that the objects we consider occur in the expected codimension in @xmath57 , as well as in other places in the argument . a natural way of measuring the ampleness of a line bundle in this setting is @xmath55-very ampleness , defined as follows .",
    "let @xmath1 be a nonsingular , projective variety , and let @xmath0 be a line bundle on @xmath1 .",
    "we say that @xmath0 is @xmath55-very ample if for every length @xmath853-subscheme @xmath854 , the map @xmath855 is surjective .",
    "let @xmath858 be a curve singularity . by the formal type of the singularity @xmath857 we mean the isomorphism type of the complete local @xmath859-algebra @xmath860 . by the topological type ( synonymously , equisingularity type ) of @xmath858 with @xmath75 embedded in a smooth surface @xmath52 , we mean the homeomorphism type of the pair @xmath861 , where @xmath862 is a sufficiently small open ball in @xmath52 centred at @xmath227 .",
    "[ curvecountprop ] let @xmath52 be a smooth , projective , connected surface , let @xmath0 be a line bundle on @xmath52 , and let @xmath67 be analytic singularity types .",
    "suppose @xmath0 is @xmath55-very ample , where @xmath55 is an integer depending on the types @xmath68 , and let @xmath4 be the sum of the codimensions of the @xmath68 .",
    "there is a rational polynomial @xmath37 of degree @xmath19 in 4 variables , depending only on the @xmath68 , such that in a general @xmath69 the number of curves having precisely @xmath19 singularities of types @xmath68 is @xmath70 the same statement holds when the @xmath68 are topological types .",
    "we will not be concerned with the range of validity for the universal polynomial , and refrain from making the @xmath55 in the statement of the proposition explicit .",
    "instead , we will simply take @xmath55 large enough whenever the @xmath55-very ampleness of @xmath0 is required , it will be clear that @xmath55 depends only on the types @xmath68 .",
    "a value for @xmath55 may be recovered from the proof , but already in the case of nodal singularities , the @xmath55 provided by this method is known to be larger than required by a factor of 5 ; compare our model @xcite with @xcite .      choosing analytic or topological singularity types @xmath68",
    ", we show that we may identify curves with such singularities by length @xmath45 subschemes .",
    "we define a geometric set @xmath863}$ ] such that ( generically ) a curve containing a @xmath864 will have the specified singularities .",
    "then , using a proposition from @xcite we get that in a general @xmath69 , the number of curves containing a subscheme @xmath864 equals @xmath865 } ) \\cap [ \\ol{w}])$ ] , which is universal by theorem [ mainthm ] .",
    "we then show that there is a bijection between pairs @xmath866 and curves in @xmath441 with the @xmath68 as singularity types , completing the proof .",
    "[ cor : curvegen ] let @xmath67 be distinct analytic singularity types , and let @xmath867 be non - negative integers",
    ". denote by @xmath868 the universal polynomial computing the number of curves having precisely @xmath829 singularities of type @xmath68 and no other singularities .",
    "there are then power series @xmath869\\!]$ ] , such that @xmath870 the same statement holds when the @xmath68 are topological types .",
    "we treat first the case of analytic singularity types .",
    "fix a smooth , projective , connected surface @xmath52 , a line bundle @xmath0 on @xmath52 , and analytic singularity types @xmath67 .",
    "we assume that @xmath0 is @xmath55-very ample , where @xmath55 will be taken to be sufficiently large at various points in the proof .    in order to associate a 0-dimensional subscheme to an analytic singularity type , we need the following lemma , which states roughly that a singularity @xmath857 is of analytic type @xmath204 if it looks like a singularity of type @xmath204 to @xmath54-th order , where @xmath54 depends only on @xmath204 .",
    "let @xmath857 be a curve singularity of analytic type @xmath204 .",
    "there is a positive integer @xmath54 , depending only on @xmath204 , such that if @xmath871 is a curve singularity , the analytic type of @xmath871 is @xmath204 if and only if @xmath872 .",
    "[ finitedetermination ]      to a curve singularity type @xmath204 we now associate a punctual geometric subscheme @xmath875 as follows .",
    "let @xmath857 be a germ of type @xmath204 , and let @xmath54 be the integer given by lemma [ finitedetermination ] .",
    "suppose the length of @xmath876 is @xmath45 .",
    "let @xmath877 be the set of subschemes @xmath878 with @xmath879 .",
    "let @xmath71 be the integer such that @xmath880 , for @xmath223 .",
    "set @xmath881 , and define @xmath882}$ ] to be the set of subschemes of the form @xmath883 , where @xmath16 is isomorphic to a point in @xmath884 for every @xmath17 .",
    "it is clear that @xmath66 is a geometric subset , and in the notation of section [ section : geometric ] we have @xmath885 .",
    "we let @xmath886 , this is then the sum of the expected codimensions of the singularities @xmath67 .",
    "note that @xmath884 is irreducible and locally closed , as it is the orbit of a given point in @xmath887 under the action of the connected algebraic group @xmath888 .",
    "it follows that @xmath66 is irreducible and locally closed .      1 .   let @xmath891 } \\times |l|$ ] denote the incidence locus of pairs @xmath866 with @xmath892 and @xmath893 .",
    "we have @xmath894 .",
    "2 .   let @xmath895 , and let @xmath896 be a general subsystem . the number of pairs @xmath866 such that @xmath892 , @xmath897 and @xmath893 is equal to @xmath898 } ) \\cap [ \\ol{y}]\\ ] ]    \\(i ) for any @xmath892 , the fibre of @xmath899 over @xmath18 is the projectivization of the kernel of @xmath900 . by the @xmath890-very ampleness of @xmath0 ,",
    "this homomorphism is surjective , so @xmath899 is a projective space bundle with fibres of dimension @xmath901 .",
    "the claim follows .",
    "[ lemma : analyticbijection ] let @xmath2 be a general subsystem , and assume @xmath0 is @xmath55-very ample .",
    "suppose @xmath866 is a pair such that @xmath864 , @xmath903 and @xmath893 .",
    "then @xmath75 has @xmath19 singularities of analytic types @xmath68 , and @xmath75 contains no other point of @xmath66 .",
    "let @xmath441 , @xmath75 and @xmath18 be as in the statement of the lemma , and suppose @xmath904 , where @xmath16 is supported at @xmath905 and where @xmath16 is isomorphic to a point in @xmath884 .",
    "we show the following claims : ( 1 ) that @xmath75 has precisely @xmath19 singularities , ( 2 ) that @xmath75 has a singularity of type @xmath68 at @xmath906 , and ( 3 ) that @xmath75 contains precisely one @xmath864 .    _ ( 1 ) : _ clearly , @xmath75 has at least @xmath19 singularities . if @xmath75 has more than @xmath19 singularities , it contains a subscheme of the form @xmath907 , where @xmath908 is defined by an ideal @xmath909 for some @xmath910 where @xmath75 is singular .",
    "the geometric set @xmath911}\\ ] ] has dimension 2 greater than @xmath66 . by lemma [ integralisincidencelemma ] ( i )",
    ", we see that the set of @xmath912 containing an element of @xmath913 has codimension @xmath914 in @xmath57 if @xmath0 is @xmath915-very ample .",
    "as @xmath916 is general , this proves the claim .",
    "_ ( 2 ) : _ suppose for a contradiction that the singularity of @xmath75 at @xmath570 is @xmath917 .",
    "let @xmath54 be the integer associated to @xmath918 as in lemma [ finitedetermination ] , and let @xmath919 . as @xmath917 , we have @xmath920 .",
    "let @xmath921 be defining equations of @xmath922 and @xmath923 in @xmath802 , we then have @xmath924 .",
    "this implies that @xmath925 , where @xmath926 is the maximal integer such that @xmath927 .",
    "hence @xmath75 contains a subscheme of the form @xmath928 where @xmath929 .",
    "let @xmath913 be the set of subschemes which can be written in this way .",
    "then @xmath913 is geometric and has dimension @xmath930 .",
    "informally , this is because there is a surjection from @xmath66 to @xmath913 defined by @xmath931 .",
    "it is not entirely obvious that this is a morphism , and we argue instead as follows .",
    "let @xmath932 be the punctual geometric subset of schemes of the form @xmath929 , we see that both @xmath933 and @xmath932 are orbits of an action of the group @xmath934 , where @xmath935 is the length of subschemes in @xmath932 .",
    "the stabilizer of a point in @xmath933 then contains the stabilizer of the corresponding point in @xmath932 , and it follows that @xmath936 .",
    "let @xmath937 be the length of the points of @xmath913 . clearly , we have @xmath938 ,",
    "so we have @xmath939 as @xmath0 is @xmath55-very ample , a slight modification of lemma [ integralisincidencelemma ] ( i ) shows that the codimension of the locus of points containing a point from @xmath913 is @xmath940 , if @xmath941 . as @xmath903 for a general @xmath441",
    ", it is not contained in this locus .",
    "_ ( 3 ) : _ by ( 1 ) and ( 2 ) , we know that @xmath75 has a singularity of type @xmath68 at @xmath906 , and suppose for a contradiction that there is a @xmath942 with @xmath943 such that @xmath944 .",
    "let @xmath945 with @xmath946 supported at @xmath906 .",
    "assume that @xmath947 as subschemes .",
    "but by part ( 2 ) , the singularity type associated to @xmath948 must be @xmath68 , and hence we have @xmath949 where @xmath54 is as in lemma [ finitedetermination ] for type @xmath68 .",
    "for any topological singularity type @xmath204 , let @xmath950 as defined in @xcite .",
    "we take @xmath951 to be defined in the same way as the subset denoted @xmath952}$ ] in @xcite , with @xmath953 .",
    "note that @xmath954 is a subset of the full hilbert scheme ; we take its intersection with the set of subschemes supported at a given point to get a subset of the punctual hilbert scheme .",
    "we briefly review the definition and refer to @xcite for further details .",
    "let @xmath955 be a curve singularity , where @xmath956 .",
    "we define the _ configuration _ @xmath957 associated to @xmath955 as a certain subset of the set of infinitely near points in @xmath52 over @xmath131 contained in the strict transform of @xmath75 , together with an integer weight at each point , equal to the multiplicity of the strict transform of @xmath75 at that point .",
    "specifically , we let @xmath957 be the set of _ essential _ points lying over @xmath131 .",
    "the configuration @xmath957 then determines the enriques diagram of @xmath955 , which is equivalent to knowing the topological type .",
    "we define a partial ordering on the set of configurations by saying that @xmath958 if every point of @xmath957 is contained in @xmath959 and has weight at least as big in @xmath959 as it has in @xmath957 .",
    "if @xmath957 is a configuration at @xmath960 , there is an associated ideal @xmath961 defining a subscheme @xmath962 supported at @xmath131 , with the property that if @xmath955 is a curve singularity with configuration @xmath959 , then @xmath958 if and only if @xmath963 . the length @xmath45 of @xmath962 depends only on the type @xmath204 associated to @xmath957 , and we define the subset @xmath964 , where @xmath957 runs over all configurations of type @xmath204 at @xmath965 .",
    "let @xmath970 . by the discussion preceding (",
    "* prop 3.5 ) it suffices to show that @xmath971 generates the sheaf @xmath972 .",
    "let @xmath910 be a point , then by nakayama s lemma it suffices to show that the vector space homomorphism @xmath973 is surjective .",
    "let @xmath71 be such that @xmath880 .",
    "the length of the restriction of @xmath974 to @xmath131 is @xmath975 , hence the colength of @xmath976 is @xmath977 . if @xmath0 is @xmath55-very ample and @xmath978 , the vector space map @xmath979 is surjective . if @xmath980 lands in @xmath981 , we have @xmath982 . the claim follows .",
    "let @xmath2 be a general subsystem , and assume @xmath0 is @xmath55-very ample .",
    "suppose @xmath866 is a pair such that @xmath864 , @xmath903 and @xmath893 .",
    "then @xmath75 has exactly @xmath19 singularities of topological types @xmath68 , and @xmath75 contains no other point of @xmath66 .",
    "we let @xmath983 be the incidence locus of pairs @xmath866 with @xmath864 , @xmath912 and @xmath893 .",
    "let @xmath984 and @xmath985 be the projections .",
    "let @xmath441 , @xmath75 and @xmath18 be as in the statement of the lemma , and suppose that @xmath904 with @xmath16 supported at @xmath905 . as in lemma",
    "[ lemma : analyticbijection ] , we show ( 1 ) that @xmath75 has @xmath19 singularities , ( 2 ) that @xmath75 has type @xmath68 at @xmath906 and ( 3 ) that @xmath75 contains precisely one @xmath864 .      _ ( 2 ) : _ assume for a contradiction that @xmath75 has a singularity of type @xmath917 at @xmath570 .",
    "define @xmath986}$ ] in the same way as @xmath66 , but replacing @xmath918 with @xmath987 .",
    "let @xmath988 , @xmath989 and @xmath990 be the incidence locus and projections .",
    "if @xmath267 is a reduced curve which contains a @xmath991 , it does not have types @xmath68 . to see this , note first that @xmath992 , where the degree of a singularity type is as defined in @xcite .",
    "hence the sum of the degrees of the singularities of @xmath267 is bigger than @xmath993 .",
    "consider now the set @xmath994 by lemma [ lemma : generic ] and the previous paragraph , @xmath995 has positive codimension in @xmath996 for every @xmath864 .",
    "thus @xmath1 has positive codimension in @xmath983 .",
    "we have @xmath997 , hence we find that @xmath998 has codimension @xmath940 in @xmath57 .    as there are at most finitely many alternatives for the type @xmath987 appearing in @xmath57 , there are at most finitely many closed subsets like @xmath998 in @xmath57 to avoid . since @xmath903 with @xmath441 general the claim follows .",
    "_ ( 3 ) : _ by ( 1 ) and ( 2 ) , @xmath75 has a singularity of type @xmath68 at @xmath906 and no other singularities .",
    "we may assume that @xmath18 is the subscheme defined by the configuration associated to the singularities of @xmath75 .",
    "suppose now for a contradiction that @xmath942 is such that @xmath943 and @xmath999 .",
    "let @xmath948 be the component of @xmath908 supported at @xmath906 , then by ( 2 ) we see that the type associated to @xmath948 is @xmath68 .",
    "let @xmath957 be the configuration associated to @xmath75 at @xmath906 , and let @xmath959 be the configuration associated to @xmath948 .",
    "then @xmath1000 , but as their enriques diagrams are the same , we must have @xmath1001 , and thus @xmath1002 .      without any extra work ,",
    "the above extends to counts of analytic types of isolated singularities of hypersurfaces .",
    "let @xmath1003 be the pair of a divisor @xmath267 in a nonsingular variety @xmath1 and an isolated singular point of @xmath267 .",
    "we define the analytic type of the singularity @xmath1004 to be the isomorphism type of the complete local ring @xmath1005 .",
    "[ divcountprop ] let @xmath1 be a smooth , projective , connected variety , let @xmath0 be a line bundle on @xmath1 , and let @xmath67 be analytic singularity types .",
    "suppose @xmath0 is @xmath55-very ample , where @xmath55 is an integer depending on the types @xmath68 , and let @xmath4 be the sum of the codimensions of the @xmath68 .",
    "there is a rational polynomial @xmath37 in the chern numbers of @xmath3 , depending only on the @xmath68 , such that in a general @xmath69 the number of divisors having precisely @xmath19 isolated singularities of types @xmath68 is given by @xmath37 .",
    "let @xmath75 be a reduced , complete , locally planar algebraic curve , and consider the generating function @xmath1006}\\right ) q^k.\\ ] ] let the arithmetic and geometric genus of @xmath75 be @xmath76 and @xmath77 , respectively .",
    "in @xcite it is shown that there are integers @xmath79 , with @xmath1007 unless @xmath1008 , such that @xmath1009    for our purposes , it will be convenient to work with the index - shifted integers @xmath1010 .",
    "we define the bps spectrum of @xmath75 to be the sequence of integers @xmath87 . by the above",
    ", we have @xmath1011 if @xmath1012 .",
    "if @xmath75 has precisely @xmath19 singularities of analytic type @xmath67 , then stratifying @xmath1013}$ ] it is not hard to show that the bps spectrum of @xmath75 depends only on the @xmath68 .    by this observation",
    ", one may define the bps spectrum of an analytic singularity type @xmath204 as the bps spectrum of a complete , reduced curve having one singularity of type @xmath204 .",
    "the bps spectrum of a singularity @xmath204 is conjectured by oblomkov and shende in @xcite to be determined explicitly by the milnor number and the homfly polynomial of the link of @xmath204 . in particular , the bps spectrum of a curve should depend only on the topological types of the singularities of the curve .",
    "let @xmath52 be a smooth , projective , connected surface , and let @xmath0 be a line bundle on @xmath52 .",
    "let @xmath89 be a bps spectrum , and denote by @xmath90 the locus of curves with bps spectrum @xmath45 .",
    "let @xmath19 be a nonnegative integer , let @xmath91 be a general linear subsystem , and suppose @xmath0 is @xmath55-very ample , where @xmath55 is some integer depending on @xmath19 and @xmath45 .",
    "then , there exists a rational polynomial @xmath37 in 4 variables , depending only on @xmath19 and @xmath45 , such that @xmath92 [ prop : bps ]    if in addition it is known that @xmath1014 is 0-dimensional , this implies an enumerative result of the kind found in the previous subsection .",
    "this is essentially the argument used in @xcite to compute the number of @xmath56-nodal curves and prove the gttsche conjecture .",
    "let @xmath19 be an integer .",
    "there is a finite set of bps spectra @xmath1015 such that if @xmath0 is @xmath19-very ample and @xmath74 is a general linear subsystem , then for every curve @xmath1016 the bps spectrum of @xmath75 is among the @xmath71 .",
    "if @xmath0 is @xmath19-very ample , by ( * ? ?",
    "2.1 ) , a curve @xmath75 appearing in a generic @xmath1017 is reduced and has geometric genus @xmath1018 . by , the bps spectrum of @xmath75 is then determined by @xmath1019})$ ] for @xmath1020 .",
    "denote by @xmath1021}$ ] the set of subschemes supported at @xmath1022 .",
    "stratifying @xmath1023}$ ] , we see that @xmath1019})$ ] is determined by @xmath1024 and the integers @xmath1025 , where @xmath227 ranges over every singular point of @xmath75 and @xmath1026 .",
    "the claim now follows from the easily shown fact that if @xmath231 is fixed , then @xmath1025 can take only finitely many values for @xmath1022 a singular point of a planar curve .",
    "suppose now that @xmath1027 are the possible bps spectra in a general @xmath91 for a @xmath19-very ample @xmath0 . by ( * ? ? ?",
    "2.1 ) every curve @xmath1028 satisfies @xmath1029 . by",
    ", the bps spectrum of such a @xmath75 is determined by the @xmath19 integers @xmath1030 } ) , \\ldots , \\chi(c^{[k]})\\ ] ] and @xmath76 . for @xmath1031 , there exists a polynomial @xmath1032 $ ] such that @xmath1033}\\right)\\right ) = \\delta_{ij}\\ ] ] when @xmath1034 is a curve with bps spectrum @xmath1035 .",
    "let now @xmath74 be general , let @xmath1036 be the family of curves , and let @xmath1037}/\\pp^k$ ] denote the relative hilbert scheme . every monomial @xmath45 in the variables",
    "@xmath906 determines a scheme @xmath1038 by taking @xmath1039}/\\pp^k\\ ] ] and extending this by the rule @xmath1040 it is clear that @xmath1041}/\\pp^k ) , \\ldots , \\chi(\\cc^{[k]}/\\pp^k ) ) \\\\ & = \\sum_{i=1}^r \\chi\\left(|l|_{m_i }",
    "\\cap \\pp^k \\right ) m\\left(\\chi\\left(c_i^{[1]}\\right ) , \\ldots , \\chi\\left(c_i^{[k]}\\right)\\right).\\end{aligned}\\ ] ] write @xmath1042 in the form @xmath1043 with @xmath45 a monomial in the @xmath906 and @xmath1044 a rational polynomial .",
    "using the fact that @xmath1045 , we get @xmath1046 the lemma below then finishes the proof of proposition [ prop : bps ] .",
    "let @xmath0 be a line bundle , and let @xmath91 be a general linear subsystem .",
    "let @xmath1036 be the universal family of curves , and denote by @xmath1037 } \\to \\pp^k$ ] the relative hilbert scheme of @xmath17 points for this morphism .",
    "then , the euler characteristic @xmath1047 } \\times_{\\pp^k } \\cdots \\times_{\\pp^k } \\cc^{[i_l]}\\right)\\ ] ] is computed by a universal polynomial , provided that @xmath0 is @xmath1048-very ample .",
    "let @xmath1051 } \\to s^{[n]}$ ] be the natural morphism .",
    "we show that there exists a finite stratification @xmath1052}$ ] by geometric sets @xmath1053 of universal type , such that @xmath1054}\\times_{\\pp^k}\\cc^{[k_2 ] } ) = \\sum_{n=1}^{k_1+k_2}\\sum_{i } i\\cdot \\chi(\\cc^{[n ] } \\cap f_n^{-1}(w_{n , i})).\\ ] ] consider the function @xmath1055 } \\times s^{[k_2 ] } \\to \\sqcup_{n=1}^{k_1+k_2 } s^{[n]}$ ] defined pointwise by @xmath1056 where the union is in the scheme - theoretic sense .",
    "define @xmath1057 } \\mid \\chi(g^{-1}(z ) ) = i)\\}.\\ ] ] it is not hard to show that @xmath1053 is geometric .",
    "using the fact that @xmath1058 , we also see that @xmath1053 satisfies .",
    "lemma [ lemma : universalchi ] now completes the proof .",
    "[ lemma : universalchi ] let @xmath66 be a geometric subset of @xmath1052}$ ] , and let @xmath74 be a general linear subsystem , with @xmath0 an @xmath1059-very ample line bundle .",
    "let @xmath1036 be the family of curves , let @xmath1060}$ ] be the relative hilbert scheme of the family , and let @xmath1061 } \\to s^{[n]}$ ] be the natural morphism .",
    "there exists a universal polynomial in the chern numbers of @xmath65 computing @xmath1062}\\right)$ ] .",
    "the inclusion - exclusion principle for @xmath152 let us reduce to the case where @xmath66 is closed and irreducible .",
    "consider the diagram @xmath1063 } @>f > > w \\\\",
    "@vvv \\\\    \\pp^k .",
    "\\end{cd}\\ ] ] the fibres of @xmath127 are all projective spaces , since for a point @xmath864 , the fibre over @xmath18 is the linear system of curves containing @xmath18 .",
    "hence we have @xmath1064 .",
    "let @xmath1065 .",
    "on @xmath66 , consider the surjective homomorphism @xmath1066 } } \\to l^{[n]},\\ ] ] let @xmath1067 be the @xmath1068-dimensional subspace defining @xmath1017 , and let @xmath1069}$ ] be the induced homomorphism .",
    "then @xmath1070 in other words @xmath1071 , where @xmath1072 denotes the locus over which @xmath1073 has rank @xmath1074 .",
    "it thus suffices to compute @xmath1075 for all @xmath99 .    by (",
    "* thm 2.10 ) , there exists a formula for the euler characteristic of @xmath1072 as a polynomial in the chern classes of @xmath1076}$ ] capped with @xmath1077 , assuming the homomorphism @xmath1078}$ ] is @xmath99-general in the sense of @xcite . choosing a whitney stratification of @xmath66",
    ", @xmath99-generality amounts to saying that over each stratum , the section of @xmath1079}\\right)$ ] intersects the tautological degeneracy locus @xmath1080}\\right)$ ] transversely .",
    "the @xmath1059-very ampleness of @xmath0 implies there is a surjection @xmath1081}$ ] , inducing a morphism @xmath1082 choosing a subspace @xmath1083 , the intersection of @xmath1073 with @xmath1084 corresponds to the intersection of @xmath66 with a certain smooth subset of @xmath1085 . by the kleiman - bertini transversality @xcite , for a general @xmath1083",
    ", the intersection of each whitney stratum of @xmath66 with this set will be smooth of the expected dimension .",
    "this shows that @xmath1086}$ ] is @xmath99-general in the sense of @xcite .",
    "s.  kleiman and r.  piene .",
    "enumerating singular curves on surfaces . in _ algebraic geometry : hirzebruch 70 ( warsaw , 1998 ) _ , volume 241 of _ contemp .",
    "_ , pages 209238 .",
    "soc . , providence , ri , 1999 ."
  ],
  "abstract_text": [
    "<S> we show that tautological integrals on hilbert schemes of points can be written in terms of universal polynomials in chern numbers .    </S>",
    "<S> the results hold in all dimensions , though they strengthen known results even for surfaces by allowing integrals over arbitrary `` geometric '' subsets ( and their chern - schwartz - macpherson classes ) .    </S>",
    "<S> we apply this to enumerative questions , proving a generalised gttsche conjecture for all singularity types and in all dimensions . </S>",
    "<S> so if @xmath0 is a sufficiently ample line bundle on a smooth variety @xmath1 , in a general subsystem @xmath2 of appropriate dimension the number of hypersurfaces with given singularity types is a polynomial in the chern numbers of @xmath3 .    when @xmath1 is a surface , we get similar results for the locus of curves with fixed `` bps spectrum '' in the sense of stable pairs theory . </S>"
  ]
}