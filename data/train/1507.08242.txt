{
  "article_text": [
    "the two - dimensional ising model ",
    "famous toy - model of magnetic interaction introduced by lenz and initially studied by ising  @xcite in dimension @xmath0  has been the subject of extensive activity following the proof of existence of a phase transition by peierls  @xcite , the prediction of its critical temperature by kramers and wannier  @xcite , and the computation of its free energy by onsager  @xcite and kaufman  @xcite .",
    "there have been literally thousands of papers on the subject and a standard gateway to the main developments of the last century is the classical text of mccoy and wu  ( * ? ? ?",
    "* chapter i ) .",
    "this book focuses on one of the mainstream approaches to the study of the ising model : the  _ combinatorial method _ , which in contrast to the algebraic method of onsager ",
    "kaufman , is based on combinatorial bijections .",
    "the founding papers of this method include a series of works by kac , ward , potts , hurst , green , kasteleyn , montroll , fisher , and others  @xcite .",
    "yet an alternative approach was proposed by baxter and enting  @xcite based on invariance under local star - triangle transform of the underlying planar graph  @xcite .",
    "these techniques enabled a broad understanding of the ( infinite - volume limit of the ) model , which by the 1970s was widely considered to be a successfully closed case in the mathematical physics community .",
    "in more recent times , a deep algebraic structure of ( infinite - volume ) spin correlations on regular 2d lattices was found , in particular due to the work of wu , mccoy , tracy , and barouch  @xcite on painlev equations , the work of sato , miwa , and jimbo  @xcite on isomonodromic deformations and @xmath1-functions , and the related work of perk  @xcite ( see also  @xcite ) and palmer  @xcite .",
    "this is surveyed in  ( * ? ? ?",
    "* chapter xvii ) . in the 2000s ,",
    "the model was revived yet again by smirnov  @xcite , when schramm s invention  @xcite of sle curves led to the emergence of a new field focusing on rigorously proving convergence of 2d lattice models to their conformally invariant continuum counterparts using discrete complex analysis techniques .",
    "this allowed new developments concerning the fine understanding of the conformal invariance of the critical ising model in _ general _ planar domains , both from the geometric ( convergence of interfaces to sle curves ) and the analytic ( confirming conformal field theory predictions for the scaling limits of correlation functions ) viewpoints ; see  @xcite .",
    "a number of related results can be found in  @xcite . in parallel ,",
    "further developments were made on various algorithmic and algebraic aspects of the model ( e.g. , see  @xcite and  @xcite ) .",
    "this paper is about the combinatorics of the 2d nearest - neighbor ising model on _ general finite weighted graphs _ and one of its main goals is to make the basic methods and formalisms used in most of the works cited above better known and available in a practical way to the _ probability and combinatorics _ community which has been rather active on this topic recently  @xcite .",
    "to that end , we focus on presenting and proving combinatorial formulas for the partition function , multi - point fermionic observables , and spin and energy density correlations ( see section  [ sec : planar ] for the planar case and section  [ sec : surface ] for the extension to surfaces ) .",
    "the preferred language we use throughout the paper is that of _ kac  ward matrices _ ( see section  [ sub : intro - kw - and - terminal ] ) , and although it is hard to claim originality in view of the rich and overwhelming history and literature on the subject , we do give simple and general proofs of many results for which we have not been able to find any explicit reference .",
    "a notable example is the famous kac  ward formula   for which we provide a very short proof in section  [ sec : planar ] .",
    "a motivation for discussing these combinatorial formulas in their full generality is the many open directions that still remain , including the ising model in random media , spin glasses , the ising model on random maps and non - integrable ising models .",
    "note that some progress was made on the last topic a few years ago  @xcite , where the energy density field of the near - critical ising model with finite range interactions was shown to be universal in the limit , following a rigorous application of the renormalization group methods and taking advantage of the classical grassmann variables representation of the model .",
    "another approach to reveal the pfaffian structure of correlation functions arising in the limit of the ( critical or near - critical ) non - integrable ising model was recently suggested in  @xcite .",
    "it is based on the so - called random current representation of the model , which also has been the subject of renewed interest in the nearest - neighbor case , see  @xcite .",
    "similarly to the fact that all problems on random walks ( whether classical , in random environment , on random graphs , etc . )",
    "have the same underlying structure of discrete harmonic functions , the structure underlying the 2d nearest - neighbor ising model is that of _ s - holomorphic _ functions , a definition introduced in  @xcite to encode a stronger version of discrete cauchy - riemann identities for some combinatorial observables arising in the model . similar objects ( discrete fermions satisfying some local relations aka propagation equations ) go back to the founding papers on the subject , which use several different languages to describe the same structure . despite the fact that all these languages are essentially equivalent to one another , we do not know of a reference providing an explicit exposition of the links between them ( of course , it should be said that such links are part of the folklore surrounding the ising model ) . in view of the recent activity in the field ,",
    "we believe it useful to provide such an exposition in one place ( intended in particular for combinatorialists and probabilists ) and thus devote section  [ sec : links ] to proving these equivalences , in particular the one between _ spin - disorders _  @xcite and _ grassmann variables _",
    "@xcite , considered on double - covers .",
    "in addition , we provide an extension of these combinatorial formulas to the _ double - ising model _ ; see section  [ sub : intro - dbli ] .",
    "this model , defined as a pointwise product of two ising spin configurations on the same discrete domain , coupled along the boundary , is related to the _ bosonization _ of the ising model ( e.g. , see  ( * ? ? ?",
    "* chapter 12 ) or  ( * ? ? ?",
    "* section 12.4 ) ) , a topic which has been revived and studied from the combinatorial point of view recently  @xcite .",
    "the critical double - ising model was also studied in the physics literature ( see in particular  @xcite ) in the context of the ashkin  teller model , a four - state spin model",
    "of which it is a special case .",
    "similarly to the known relation between the scaling limit of interfaces arising in the ising model at criticality  @xcite and conformal loop ensembles  @xcite , wilson  @xcite conjectured a relation between the interfaces arising in the double - ising model at criticality ( considered on the hexagonal lattice ) and the set of `` level lines '' of the gaussian free field  @xcite . in section  [ sub : dbli - s - hol - fct ] we discuss whether the combinatorial formulas could play a role in understanding this passage to the scaling limit as they do for the critical ( single- ) ising model  @xcite .",
    "the paper is organized as follows . in the remainder of section  [ sec : introduction ] , we give a detailed presentation of our main results in the case of planar graphs . in section",
    "[ sec : planar ] , we prove the statements concerning the planar ising model . in section  [ sec : links ] , we present an overview of the links between various formalisms that have been used in the study of the ising model . in section  [ sec : surface ] , we generalize the results and proofs of section  [ sec : planar ] to the surface case . finally , in section  [ sec : double ] , we prove the results concerning the double - ising model .",
    "let @xmath2 be a finite connected graph with vertex set @xmath3 and set of unoriented edges @xmath4 .",
    "the ising model on  @xmath2 is defined as follows .",
    "a _ spin configuration _",
    "@xmath5 is the assignment of a  @xmath6 spin to each vertex of the graph .",
    "for each ( unoriented ) edge @xmath7 , let @xmath8 be an _ interaction constant _ and denote by @xmath9 the collection of all @xmath10 .",
    "consider the _",
    "@xmath11 for a fixed nonnegative real @xmath12 , called the _ inverse temperature _ , the ising model is the probability distribution on spin configurations given by @xmath13^{-1}\\cdot\\exp[-\\beta h(\\sigma)]\\,,\\ ] ] where the normalizing factor @xmath14\\ ] ] is called the _ partition function _ of the model .",
    "it is convenient to introduce two polynomials encoding the combinatorial structure of the model . for that matter",
    ", we let @xmath15 be a collection of variables and view  @xmath16 as a weighted graph . for any subset of edges @xmath17",
    ", we define @xmath18 .",
    "let @xmath19 be the set of all subgraphs with even vertex - degrees , called _ even subgraphs_. the _ high - temperature polynomial _ is defined to be @xmath20 as first observed by van der waerden  @xcite , the fact that the products of spins is always @xmath6 and some cancellations due to parity yield @xmath21)\\cdot \\cz_{\\opname{high}}(g,(x_e\\!:=\\!\\tanh[\\beta j_e])_{e\\in e(g)})\\,.\\ ] ]    the _ low - temperature _ , or _ domain - walls _ , expansion is another useful polynomial expansion which has a straightforward interpretation in terms of spin configurations on the _ dual _ graph to  @xmath2 .",
    "it requires the choice of an embedding of  @xmath2 into a surface @xmath22 possibly with boundary ( given by a disjoint union of topological circles ) ; the embedding is such that each of the components of @xmath23 is a topological disk .",
    "we let @xmath24 be the dual graph of @xmath2 with respect to the surface @xmath22 to which we glue a topological disk to each boundary component : this ensures that there is one vertex in  @xmath24 per boundary component of  @xmath2 , we denote the set of those by  @xmath25 . for any edge @xmath26",
    "we write @xmath27 for its dual edge . if the graph is planar , we shall write @xmath28 for the unique element of  @xmath25 corresponding to the unbounded face of  @xmath2 .",
    "we consider an ising model on @xmath24 .",
    "the specification of boundary conditions for this model consists in assigning a fixed value to each of the spins at vertices from  @xmath25 .",
    "in particular  ` @xmath29 ' _ boundary conditions _ are obtained by fixing all of these values to  @xmath30 .",
    "the set of spin configurations on  @xmath24 with  ` @xmath29 ' boundary conditions , is in bijection with the set of _ domain walls _ between clusters of  @xmath30 s and  @xmath31 s , i.e. the set @xmath32=0\\in h_1(\\sigma;{\\mathbb z}_2)\\}\\ ] ] of even subgraphs of  @xmath2 that bound a collection of faces .",
    "( although we do not write it explicitly in the notation , @xmath33 implicitly depends on the embedding of @xmath2 in  @xmath22 . ) given a spin configuration @xmath5 on @xmath24 with ` @xmath29 ' boundary conditions , we let @xmath34 be the even subgraph representing the domain walls of @xmath5 . let @xmath35\\ ] ] be the partition function of the ising model on @xmath24 with  ` @xmath29 ' boundary conditions and the inverse temperature  @xmath36 , where the hamiltonian  @xmath37 on  @xmath24 is defined similarly to  ( [ eqn : intro - h ] ) via interaction constants  @xmath38 . by defining the _ low - temperature polynomial _ to be @xmath39 one readily",
    "\\cz_{\\opname{low},\\sigma}(g,(x_e\\!:=\\!\\exp[-2\\beta^*j_{e^*}])_{e\\in e(g)})\\,.\\ ] ]    for planar graphs ( i.e. when  @xmath41 is the plane ) , we have  @xmath42 and simply denote @xmath43 note that this equality relates the partition function of an ising model on a planar graph  @xmath2 and another one on  @xmath24 provided the interaction constants and inverse temperatures satisfy , for each edge @xmath26 and its dual  @xmath44 , the relation  @xmath45=\\exp[-2\\beta^*j_{e^*}]$ ] , which can be rewritten in a symmetric way as @xmath46\\sinh[2\\beta^ * j_{e^*}]=1\\,.\\ ] ] this is the kramers - wannier duality  @xcite and it has an extension to surface graphs  @xcite .",
    "one can also consider _ ` free ' boundary conditions _ on ( some of ) the boundary components of  @xmath22 instead of  ` @xmath29 ' ones .",
    "this can be obtained by setting the corresponding interaction parameters  @xmath47 $ ] to  @xmath0 in the right - hand side of   and modifying the prefactor accordingly . in particular , all results we present below for ` @xmath29 ' boundary conditions can be easily generalized to ` free ' ones and we shall not comment about this further in the text .",
    "we now briefly explain how the 2d ising model is naturally associated to the topological notions of double covers and spin structures , see sections  [ sub : intro - spin - correlations ] ,  [ sub : grassmann ] ,  [ sub : disorders ] and  [ sec : surface ] for more details .",
    "consider the ising model on a planar graph  @xmath24 and fix some faces  @xmath48 of  @xmath2 . in order to compute _ spin correlations _",
    "@xmath49 $ ] , one may take advantage of the domain walls expansion and twist the weights  @xmath50 by changing their signs on cuts linking  @xmath48 and  @xmath28 in such a way that all configurations are weighted by  @xmath51 .",
    "this gives a polynomial  @xmath52}(g , x)$ ] such that  @xmath49=\\cz_{[u_1,\\ldots , u_m]}(g , x)/\\cz_{\\opname{ising}}(g , x)$ ] and the underlying topological structure is that of a canonical _ double cover _ of  @xmath2 branching over all the faces  @xmath48 .",
    "for planar graphs , this leads to a representation of spin correlations as ratios of two pfaffians due to the well - known integrability of the 2d ising model .",
    "there is another way to treat spin correlations : consider a punctured plane @xmath53 and note that the probability of @xmath54 being @xmath30 for all @xmath55 is simply the ratio  @xmath56 .",
    "therefore ,  @xmath49 $ ] can be written as a linear combination of such ratios and , vice versa ,  @xmath57 is a linear combination of  @xmath58 pfaffians corresponding to all the possible double covers of the punctured plane  @xmath59 , which are classified by  @xmath60 .",
    "when one works with graphs embedded in a general surface  @xmath22 , a similar phenomenology comes into play : the polynomial  @xmath61 is equal to a sum of several pfaffians but one needs a clever topological tool to index them , the so - called _ spin structures _",
    "@xcite , which form an affine space over  @xmath62 ; see section  [ sec : surface ] for details .    throughout the introduction , section  [ sec : planar ] and section  [ sec : links ]",
    "we assume that the finite weighted graph  @xmath16 is embedded in the plane , with edges given by straight line segments",
    ". however , in section  [ sec : surface ] , we show that most of these results ( and proofs ) extend to the general case of finite weighted graphs embedded in surfaces .",
    "the main additional tool needed is the notion of spin structures mentioned above .",
    "let  @xmath63 be the set of _ oriented _ edges of  @xmath2 .",
    "we shall denote by  @xmath64 the origin of  @xmath65 , by  @xmath66 its terminal vertex , by  @xmath67 the oriented edge with the same support as @xmath68 but the opposite orientation , and extend  @xmath69 to a symmetric ( under change of orientation ) function on  @xmath63 . given two oriented edges  @xmath70 such that  @xmath71 and  @xmath72",
    ", one can consider the oriented angle  @xmath73 between  @xmath68 and  @xmath74 , see fig .",
    "[ fig : wind ] .",
    "the _ kac  ward matrix _ associated to the weighted graph  @xmath16 is the  @xmath75 matrix @xmath76 where  @xmath77 is the identity matrix and  @xmath78 is defined by @xmath79\\cdot(x_ex_{e'})^{1/2 } & \\text{if~$t(e)=o(e')$ but~$e'\\neq \\bar{e}$ ; } \\\\ 0 & \\text{otherwise . }",
    "\\end{cases}\\ ] ] the famous _ kac  ward formula _ @xcite claims that @xmath80=[\\cz_{\\opname{ising}}(g , x)]^2,\\ ] ] and it was an intricate story  @xcite to give a fully rigorous proof of this identity for general planar graphs ; see a recent paper  @xcite by lis for a streamlined version of the classical approach to  ( [ eqn : kwformula ] ) .",
    "this formula was generalized to graphs embedded in surfaces in  @xcite .",
    "note that the classical kac  ward matrix  @xmath81 is neither hermitian nor anti - symmetric but there is a simple transformation revealing these symmetries . indeed , denote @xmath82",
    "( this multiplication by  @xmath83 barely changes the determinant of  @xmath81 , which simply gets multiplied by  @xmath84 ) .",
    "then , @xmath85\\cdot(x_ex_{e'})^{1/2 } & \\text{if~$o(e)=o(e')$ but~$e'\\neq e$ ; } \\\\ 0 & \\text{otherwise ; } \\end{cases}\\ ] ] and it is easy to see that @xmath86 .",
    "furthermore , for each oriented edge  @xmath65 , let us fix a square root  @xmath87 of the direction of the straight segment representing  @xmath68 on the plane , denote by  @xmath88 the diagonal matrix with coefficients  @xmath89 , and set @xmath90 because of this choice of square roots , the matrix @xmath91 is not canonical , whereas @xmath92 is ( given the embedded graph ) .",
    "it is easy to see that the matrix @xmath91 is anti - hermitian with _ real _ entries , and thus _ anti - symmetric_. moreover , it has the same determinant as the original kac  ward matrix  @xmath81 .",
    "the last simple observation is that @xmath91 can be thought of as a weighted adjacency matrix of the _ terminal graph _",
    "@xmath93 which was introduced by kasteleyn  ( * ? ? ?",
    "* section  v ) and initially called the `` cluster lattice '' .",
    "let us now recall the definition of this graph .",
    ".48 2.5pt at 46 125 at 310 105 at 300 210    .48 2.5pt at 237 162 at 130 262 at 185 14 at 670 140 at 520 262 at 585 14 at 645 195 at 635 90    given a weighted graph  @xmath16 , its terminal graph @xmath93 is obtained by inserting at each vertex  @xmath94 of  @xmath2 ( of degree  @xmath95 ) a clique  @xmath96 , as illustrated in fig .",
    "[ fig : gk ] .",
    "we shall say that an edge of  @xmath93 is _ short _ if it is part of one of these complete subgraphs , and _ long _ otherwise ( i.e. if it comes from an edge of  @xmath2 ) .",
    "given edge weights  @xmath97 on  @xmath2 , we shall denote by  @xmath98 the edge weights on  @xmath93 obtained by assigning weight  @xmath0 to all long edges and weight  @xmath99 to the short edge corresponding to the two adjacent edges  @xmath100 .",
    "note that the mapping of an oriented edge of  @xmath2 to the origin vertex of the corresponding long edge in  @xmath93 yields a natural bijection between the sets  @xmath63 and  @xmath101 , which we use to identify them .",
    "note that the terminal graph is in general neither planar nor bipartite .",
    "surprisingly enough , this , almost trivial , link between the two combinatorial techniques : expansions of the kac ",
    "ward determinant and the study of dimers on the terminal graph , seems to have remained almost unknown to date .",
    "it is even more astonishing that some version of the above reduction of  @xmath81 to  @xmath91 was known as early as  1960 to hurst and green , who worked with the translationally invariant ising model on the square lattice and mentioned it to claim the first complete derivation of the kac ",
    "ward formula in this particular case  @xcite .",
    "recall that  @xmath91 is a real anti - symmetric matrix obtained from the kac ",
    "ward matrix  @xmath81 via   and  .",
    "in particular , @xmath102~=~\\det { \\widehat{\\rk}}~=~({\\opname{pf}[\\,{\\widehat{\\rk}}\\,]})^2\\,.\\ ] ]    [ thm : kw1 ] for any planar weighted graph  @xmath16 , one has @xmath103}\\,,\\ ] ] where the sign in the right - hand side is fixed by the condition that the constant ( in @xmath69 ) term equals @xmath30 . as a consequence , the kac ",
    "ward formula   holds for any planar graph  @xmath16 .    on the square lattice",
    ", this theorem provides a standard way to express the partition function of the ising model in terms of the so - called grassmann variables , see further details in section  [ sub : grassmann ] . for this particular case",
    ", its proof can be found in many textbooks but not in connection with the kac ",
    "ward formula : the matrix  @xmath91 , corresponding to some particular choices of  @xmath87 for oriented edges of four different types , is introduced _ per  se _ , as a clever tool to count the _ signed _ partition function of dimers ( aka perfect matchings ) on the corresponding _ non - planar _ terminal lattice .",
    "( such a partition function can be easily seen to be equal to  @xmath104 , see section  [ sub : prelim ] . ) to the best of our knowledge , it does not appear in the literature in the full generality of finite planar weighted graphs .",
    "however , its key ingredients were known to kasteleyn and fisher in the  1960s though presumably not in connection with the kac ",
    "ward matrix and the induced orientations of  @xmath93 ; see  ( * ? ? ?",
    "* section  v ) and  ( * ? ? ?",
    "* section  1 ) and note that the descriptions of configurations @xmath105 via dimers on  @xmath93 used in  @xcite and  @xcite differ from one another .",
    "it is well - known  @xcite that the _ entries _ of the inverse kac  ward matrix can be represented as the _ two - point combinatorial observables _ proposed by smirnov  @xcite as a convenient tool to study the scaling limit of the critical ising model in arbitrary planar domains . since then",
    ", these observables are usually defined in a self - contained way , but it is worth noting that their definition grew from considerations made by smirnov jointly with kenyon  ( * ? ? ?",
    "* remark  4 ) on dimer techniques applied to the so - called fisher graph ; see more details in section  [ sec : links ] .",
    "the next theorem , theorem  [ thm : multipoint ] , extends this combinatorial interpretation to the _ pfaffian minors _ ( that is pfaffian of square submatrices ) of the inverse matrix  @xmath106 , which correspond to the  _ @xmath107-point observables_. the latter were recently used  @xcite in the context of the critical ising model but , to the best of our knowledge , theorem  [ thm : multipoint ] does not appear in the literature in this generality ( e.g. , the proofs given in  @xcite rely upon some particular feature of the model at criticality , see also a discussion in  ( * ? ? ?",
    "* section  4.5 ) ) .",
    "this expansion is also important to justify the link between the two classical formalisms developed to study the 2d ising model : grassmann variables and disorder insertions ; see further details in section  [ sub : equivalence ] .",
    "we need some notation .",
    "let  @xmath108 be the weighted graph obtained from  @xmath16 by adding a vertex  @xmath109 in the middle of each edge  @xmath68 of  @xmath2 , and by assigning the weight  @xmath110 to both resulting edges of  @xmath111 .",
    "given a collection  @xmath112 of oriented edges of  @xmath2 , let  @xmath113 denote the set of subgraphs  @xmath114 of  @xmath111 that do _ not _ contain the edges  @xmath115 , _ do _ contain the edges  @xmath116 provided  @xmath117 , and such that each vertex of  @xmath111 different from  @xmath118 has an even degree in  @xmath114 . note that  @xmath119 is nothing but the set  @xmath19 of even subgraphs of  @xmath2 .",
    "to each configuration  @xmath120 , we shall now assign a sign  @xmath121 . in order to do so",
    ", we resolve all its crossings ( vertices with degree more than  @xmath122 in  @xmath114 ) to obtain a decomposition  @xmath123 , where  @xmath124 is a collection of disjoint simple loops , and  @xmath125 are simple paths matching the half - edges  @xmath126 ; in case there are pairs  @xmath127 in  @xmath128 , we declare the corresponding  @xmath129 to be empty paths formally matching such pairs .",
    "let us choose arbitrary orientations of the paths  @xmath129 and denote by  @xmath130 a permutation of  @xmath131 such that each of  @xmath129 goes from  @xmath132 to  @xmath133 .",
    "following  @xcite , we set @xmath134\\right),\\ ] ] where  @xmath135 denotes the total rotation angle of the velocity vector of  @xmath129 when it runs from  @xmath132 to  @xmath133 ; we formally set  @xmath136 in case @xmath137 and so  @xmath138 .",
    "the sign  @xmath139 is obviously independent of the numbering of the paths  @xmath129 and one can easily see that it also does not depend on their orientations . moreover , one can check that it is independent of the smoothing of  @xmath114 , i.e. the way how  @xmath114 is split into  @xmath124 and  @xmath129 , see identity   in section  [ sec : planar ] for more comments .",
    "we are now able to formulate the next result .",
    "[ thm : multipoint ] for any planar weighted graph  @xmath16 and any set of oriented edges  @xmath140 , the following combinatorial expansion is fulfilled : @xmath141}_{j , k=1}^{2n } ~=~ [ \\cz_{\\opname{ising}}(g , x)]^{-1}\\cdot\\!\\!\\ ! \\sum_{p\\in\\mathcal{c}(e_1,\\dots , e_{2n})}\\tau(p)\\,x(p)\\,.\\ ] ]    the case  @xmath142 leads to the standard combinatorial definition of two - point observables as sums over the set  @xmath143 , while for  @xmath144 one recovers the combinatorial definition of multi - point observables as sums over  @xmath145 , cf .",
    "theorem  [ thm : multipoint ] claims that the latter are pfaffians of the former , see also section  [ sub : s - observables ] for the discussion of the combinatorial definition of complex - valued fermionic observables .",
    "we now move on to combinatorial formulas for spin correlations . in this section",
    "we deal with the ( domain walls expansion of the ) ising model on the dual graph  @xmath24 or , equivalently , with the ising model on _ faces _ of  @xmath2 with  ` @xmath29 ' boundary conditions , which means that we fix the spin of the outer face  @xmath28 of  @xmath2 to be  @xmath30 .",
    "given faces  @xmath48 of  @xmath2 , let us fix some collection @xmath146}$ ] of edge - disjoint paths on  @xmath24 , which link @xmath48 and , possibly ,  @xmath28 so that each of  @xmath147 has an odd degree in the union of these paths .",
    "further , let  @xmath148}$ ] denote the diagonal matrix with entries @xmath149}\\right)_{e , e}=\\begin{cases}-1 & \\text{if}~e\\in\\ee(g)~\\text{intersects}~\\varkappa ; \\\\ + 1 & \\text{otherwise.}\\end{cases}\\ ] ] we now define the modified kac ",
    "ward matrix , labeled by oriented edges of @xmath2 , to be @xmath150}=\\kw_{[u_1, .. ,u_m]}(g , x):=\\ri_{[u_1, .. ,u_m]}-\\rt\\,,\\ ] ] where  @xmath78 is given by  .",
    "similarly to  ,  , we define @xmath151}=\\rk_{[u_1, .. ,u_m]}(g , x):=\\rj\\cdot \\kw_{[u_1, .. ,u_m]}(g , x)\\quad\\text{and}\\quad { \\widehat{\\rk}}_{[u_1, .. ,u_m]}:=i\\ru\\rk_{[u_1, .. ,u_m]}\\ru^*\\,.\\ ] ] note that all these matrices depend on the choice of the collection of paths  @xmath146}$ ] linking the faces  @xmath48 and  @xmath28 , which is implicit in the notation .",
    "let  @xmath152 denote the number of edges in  @xmath153 .",
    "the following result is a simple consequence of theorem  [ thm : kw1 ] .",
    "[ prop : spin1 ] for any planar weighted graph  @xmath16 and @xmath147 , we have @xmath154~=~(-1)^{|\\varkappa|}\\frac{{\\opname{pf}[\\,{\\widehat{\\rk}}_{[u_1, .. ,u_m]}\\,]}}{{\\opname{pf}[\\,{\\widehat{\\rk}}\\,]}}~=~\\pm \\left[\\frac{\\det\\kw_{[u_1,\\dots , u_m]}}{\\det\\kw}\\right]^{1/2},\\ ] ] where  @xmath155 denotes the expectation in the ising model at inverse temperature @xmath12 on the dual graph  @xmath24 conditional on  @xmath156 , and @xmath47 $ ] for all  @xmath26 .    equation   can be rewritten as a ratio of determinants of discrete @xmath157-type operators ; see section  [ sub : three - term ] in particular remark  [ rem : ad - hoc - combinatorics ] and remark  [ rk : d - bar](i ) .",
    "these operators share many important properties with their continuous counterparts , especially if one starts with the self - dual ising model considered on the so - called isoradial graphs ( we refer the reader interested in this subject to  @xcite and  @xcite ) . identities similar to  ( [ eqn : multi - spin - plane ] ) also appeared in  @xcite in connection with the double - ising model and dimer techniques for it .",
    "we now focus on the particular case when  @xmath158 is even and  @xmath48 are given by  @xmath159 pairs of neighboring faces  @xmath160 , each pair being separated by an edge  @xmath161 .",
    "let @xmath162 denote the so - called _ energy density _ at the edge  @xmath163 and let  @xmath164 be the corresponding set of @xmath107 oriented edges ( each edge @xmath163 is taken along with is reverse @xmath165 ) . in this case , there is a natural choice of the collection of paths  @xmath166}$ ] linking  @xmath167 simply given by taking all the dual edges  @xmath168 .",
    "for this choice of  @xmath153 , proposition  [ prop : spin1 ] reads @xmath169~=~(-1)^{n}\\frac{{\\opname{pf}[\\,{\\widehat{\\rk}}-2{\\widehat{\\rj}}_\\re\\,]}}{{\\opname{pf}[\\,{\\widehat{\\rk}}\\,]}}\\,,\\quad\\text{with}\\quad ( { { \\widehat{\\rj}}}_\\re)_{e , e'}=\\begin{cases}i\\eta_e\\overline{\\eta}_{e ' } & \\text{if}~e'=\\overline{e } ; \\\\ 0 & \\text{otherwise.}\\end{cases}\\ ] ] note that  @xmath170 is a real anti - symmetric matrix with  @xmath6 entries depending on the choices of  @xmath171 . since  @xmath170 vanishes on  @xmath172 and  @xmath173",
    "is the identity matrix on  @xmath128 , we have @xmath174~=~ \\det [ \\,\\ri-2{\\widehat{\\rj}}_\\re { \\widehat{\\rk}}^{-1}\\,]_{e , e'\\in\\re } ~=~ \\det [ \\,{\\widehat{\\rj}}_\\re+2{\\widehat{\\rk}}^{-1}\\,]_{e , e'\\in\\re}\\,,\\ ] ] and hence @xmath169= \\pm{\\opname{pf}[\\ , { \\widehat{\\rj}}_\\re\\!+\\!2{\\widehat{\\rk}}^{-1}\\,]}_{e , e'\\in\\re}\\,,\\ ] ] with the @xmath175 sign depending on the ordering of  @xmath176 and the choices of  @xmath177 .",
    "[ rem : formulas - via - k^-1 ] _ ( i ) _ this pfaffian formula for multi - point energy density expectations can be also deduced from theorem  [ thm : multipoint ] . indeed , if  @xmath26 and a spin configuration  @xmath178 is encoded by domain walls  @xmath105 , then  @xmath179 is the indicator of the event  @xmath180 . on the other hand , @xmath181 and",
    "the sign  @xmath182 is independent of  @xmath114 on this set .",
    "therefore , if one chooses a proper ordering of the oriented edges of  @xmath2 according to the choices of  @xmath177 , theorem  [ thm : multipoint ] implies @xmath183= { \\opname{pf}[\\,{\\widehat{\\rk}}^{-1}\\,]}_{e , e'\\in\\re}\\,.\\ ] ] in other words , edges of  @xmath2 carrying the values  @xmath184 form a pfaffian process with the kernel  @xmath106 , and the formula for  @xmath185 $ ] given above easily follows by multilinearity .",
    "this approach was used in  @xcite to prove the existence of scaling limits for multi - point energy density correlations in general simply - connected domains at criticality ; see more comments in section  [ sub : s - observables ] .    _",
    "( ii ) _ in a similar manner , one can consider the faces @xmath186 in formula   as variables .",
    "if we then replace  @xmath187 by one of its neighboring faces  @xmath188 ( or , more generally , move each  @xmath189 by several faces to some other face  @xmath190 ) and adjust the collection of cuts  @xmath191}$ ] accordingly , then the matrix  @xmath192}$ ] is a small rank perturbation of the matrix @xmath193}$ ] and hence the ratio @xmath194}{\\mathbb{e}^+_{g^*}[\\sigma_{u_1}\\dots\\sigma_{u_m}]}= \\pm\\frac{{\\opname{pf}[\\,{\\widehat{\\rk}}_{[u_1',\\dots , u_m']}\\,]}}{{\\opname{pf}[\\,{\\widehat{\\rk}}_{[u_1,\\dots , u_m]}\\,]}}\\ ] ] admits a simple expression in the entries of @xmath195}$ ] . in particular",
    ", this yields a short proof of  ( * ? ? ?",
    "* lemma 2.6 ) which is a starting point for the analysis of the scaling limit of multi - point spin correlations in general simply - connected domains at criticality .",
    "this observation can be also used for the systematic study of other spin pattern correlations , cf .",
    "@xcite .",
    "the aim of this section is to indicate that all the combinatorial formulas discussed above admit modifications for the so - called _ double_-ising model which is defined as a pointwise product of two independent ising models on the ( faces ) of the same planar weighted graph  @xmath16 , _ coupled along the boundary _ in a way which we now describe .",
    "below we assume that the graph  @xmath2 contains a number of univalent ( i.e. degree  @xmath0 ) vertices incident to the outer face  @xmath28 ; note that adding / removing such vertices does not affect the ising model defined on faces of  @xmath2 , nor the value  @xmath104 .",
    "we call such vertices the _ boundary vertices _ of  @xmath2 and edges linking them to the bulk of  @xmath2 the _ boundary edges _ of  @xmath2",
    ".    .47 2.5pt at 25 80 at 210 80 at 250 92 at 290 85 at 325 83    .47 2.5pt at 109 102 at 320 130    let us add auxiliary edges carrying weights  @xmath0 , linking the boundary vertices of  @xmath2 inside of  @xmath28 in a cyclic order , to obtain a weighted graph  @xmath196 ; see figure  [ dbl - i - tilde ] .",
    "the faces of  @xmath197 adjacent to the boundary edges of  @xmath2 are called  _ boundary faces_. the states of the associated _ double - ising model _ ( with ` @xmath29 ' boundary conditions ) are pairs of spin configurations  @xmath198 on the faces of the new graph  @xmath197 such that @xmath199 similarly to the domain walls representation of the single - ising model discussed in section  [ sub : intro - z - ising ] , these spin configurations can be encoded by _",
    "pairs _ of domain walls  @xmath200 such that each boundary edge of  @xmath2 is either occupied by both these walls , or by none .",
    "the associated partition function is given by @xmath201 where  @xmath202 denotes the set of ( unoriented ) boundary edges of  @xmath2 and @xmath203 stands for the symmetric difference .",
    "to compute this partition function , we introduce a modified kac ",
    "ward matrix  @xmath204 , indexed by the set of oriented edges of  @xmath2 in the same way as the matrix  @xmath92 given by  , with the entries @xmath205 note that @xmath204 can be understood as the weighted adjacency matrix of the graph obtained from  @xmath93 by adding a loop to each vertex corresponding to an inward oriented boundary edge ; see figure  [ dbl - i-1 ] .",
    "the following result is an analog of theorem  [ thm : kw1 ] for the double - ising model .",
    "[ thm : kw3 ] for any planar weighted graph  @xmath16 , one has @xmath206",
    "note that , contrary to the kac ",
    "ward formula   and theorem  [ thm : kw1 ] , the determinant of the modified matrix  @xmath204 can not be written as the square of a pfaffian , since the matrix  @xmath207 contains non - vanishing diagonal entries and thus is not anti - symmetric .",
    "this reflects the fact that  @xmath208 is _ not _ the square of any single - ising model partition function since the two spin configurations  @xmath198 are now coupled along  @xmath209 .    similarly to section  [ sub : intro - spin - correlations ] , for a given collection of ( inner ) faces  @xmath48 , let  @xmath146}$ ] be a collection of paths in the dual graph  @xmath24 linking these faces to each other and , possibly , to the outer face  @xmath28 . denote @xmath210}:= \\widetilde{\\rk}-\\rj+\\rj\\cdot\\ri_{[u_1, .. ,u_m]}\\,.\\ ] ] in other words , to construct  @xmath211}$ ] we replace by  @xmath31 all the entries  @xmath212 of  @xmath204 that correspond to the edges  @xmath68 intersecting with  @xmath191}$ ] , exactly as in the definition of the matrix  @xmath213}$ ] in section  [ sub : intro - spin - correlations ] .    [",
    "prop : spin4 ] let  @xmath48 be a collection of ( inner ) faces of  @xmath2 . then , @xmath214 = \\frac{\\det\\widetilde{\\rk}_{[u_1, .. ,u_m]}}{\\det\\widetilde{\\rk}}\\,,\\ ] ] where  @xmath215 stands for the expectation in the double - ising model with  ` @xmath29 ' boundary conditions .",
    "we now briefly discuss geometric objects arising in the double - ising model , the so - called _ xor - ising loops _ , see @xcite . for simplicity ,",
    "let us assume that the graph  @xmath2 is trivalent ( except at boundary vertices , which have degree  @xmath0 ) .",
    "then , given a double - ising model configuration  @xmath216 , the set  @xmath217 of edges separating the faces  @xmath218 with  @xmath219 from those with  @xmath220 is a collection of non - intersecting loops , which can be thought about as a result of the xor ( exclusive - or ) operation applied to the two single - ising domain walls configurations  @xmath221 and  @xmath222 .",
    "in  @xcite , wilson conjectured that the scaling limits of these xor - loops in the _ critical _ model ( considered in discrete domains drawn on the honeycomb lattice ) can be described as the union of level sets of the gaussian free field with an appropriately tuned spacing . recently",
    ", this conjecture was strongly supported by the results of boutillier and de tilire  @xcite , who showed that , at the discrete level , these loops have the same distribution as contour lines of a _ single_-dimer height function on a related bipartite graph . at the same time , the convergence result for these height functions known to date does not allow one to derive enough information about the behavior of their level lines , so one can wonder if some generalization of theorem  [ thm : kw3 ] could help for that matter . let us briefly discuss why this is not straightforward",
    ".    a natural idea , motivated by the recent works of kenyon  @xcite and dubdat  @xcite on the double - dimer model , would be to study a twisted partition function of the double - ising model in order to track the topology of the loops using some _ quaternionic _ version of the matrix  @xmath204 .",
    "unfortunately , the combinatorial expansions of such q - determinants are no longer given by weighted sums over double - ising configurations and additional terms come into play , similarly to the odd - length cycles in the double - dimer model on a non - bipartite graph , see  @xcite .",
    "nevertheless , it seems worthwhile to understand the arising expansions better and in particular one can try to interpret these additional terms as encoding some interaction between the loops .",
    "one can also try another common strategy and focus on a single interface ( domain wall )  @xmath223 generated by the so - called _ dobrushin boundary conditions_. the latter are defined as follows : for a given pair  @xmath224 of boundary edges , let us condition the two spin configurations  @xmath198 to satisfy @xmath225 where  @xmath226 ( resp .",
    "@xmath227 ) denotes the part of the boundary of  @xmath2 from  @xmath228 to  @xmath229 when going counterclockwise ( resp .",
    "clockwise ) . in section  [ sub : dbli - dobrushin ]",
    "we prove an analog of theorem  [ thm : kw3 ] for these boundary conditions and discuss how one can construct the so - called s - holomorphic martingales , which track the evolution of  @xmath223 .",
    "this could pave a way to the understanding of a scaling limit of these interfaces , e.g. following the strategy implemented for the critical ( single- ) ising model in  @xcite . nevertheless , it is also not straightforward , and we expect some conceptual obstacles when passing to a limit in the arising discrete boundary value problems for these s - holomorphic functions , see section  [ sub : dbli - s - hol - fct ] and remark  [ rem : dbli - martingale - strategy - oops ] for more details .",
    "we thank cdric boutillier , sunil chhita , batrice de tilire , hugo duminil - copin , alexander glazman , clment hongler , konstantin izyurov , richard kenyon and stanislav smirnov for many useful discussions on the subject , as well as steffen rohde , wendelin werner and david wilson for their kind feedback on the double - ising model .",
    "also , we would like to thank the referee for useful suggestions .",
    "this work started while the first - named author was visiting the forschungsinstitut fr mathematik and completed at the institut for theoretical studies at eth zrich . the support of dr .",
    "max rssler , the walter haefner foundation and the eth foundation is gratefully acknowledged .",
    "the work of the second - named author was supported by a grant of the swiss fns .",
    "we start this section with some preliminaries , then prove theorem  [ thm : kw1 ] , and then show how the proof extends to give theorem  [ thm : multipoint ] .",
    "we conclude this section with the proof of proposition  [ prop : spin1 ] and a discussion of the corresponding generalization of theorem  [ thm : multipoint ] .",
    "recall that  @xmath91 is nothing but the signed skew - symmetric adjacency matrix of the weighted terminal graph  @xmath230 .",
    "namely , for two adjacent vertices  @xmath68 and  @xmath74 of  @xmath93 ( which are identified with oriented edges of  @xmath2 ) , we have  @xmath231 with the sign  @xmath232 given by @xmath233 & \\text{if~$e$ and~$e'$ are linked by a short edge of~$g^\\rk$. } \\end{cases}\\ ] ]    further , recall that a _ dimer configuration _ ( aka _ perfect matching _ ) on a graph  @xmath234 is a collection of edges of  @xmath234 ( called dimers ) such that each vertex of  @xmath234 is incident to exactly one of these edges .",
    "we shall denote by  @xmath235 the set of dimer configurations on  @xmath234 .    for @xmath236 ,",
    "let @xmath237 denote the product of weights of all dimers in  @xmath238 , and let  @xmath239 denote the _ self - intersection number _ of  @xmath238 , that is , the number of times different edges of  @xmath238 cross one another ( note that this can happen only inside of the cliques @xmath96 ) .    [",
    "lemma : terminal ] for any planar weighted graph  @xmath16 , the ising partition function on  @xmath2 can be expressed as the signed dimer partition function on the terminal graph  @xmath230 as follows : @xmath240    given a dimer configuration  @xmath241 , let  @xmath242 denote the subgraph of  @xmath2 consisting of the edges of  @xmath2 corresponding to the long edges of  @xmath238 .",
    "note that  @xmath243 is an even subgraph of  @xmath2 ; therefore , the assignment  @xmath244 defines a map  @xmath245 .",
    "note also that  @xmath241 is mapped to  @xmath105 if and only if its short edges match the vertices of  @xmath93 corresponding to edges of  @xmath114 .",
    "in other words , the set  @xmath246 is in bijection with  @xmath247 , where  @xmath248 is the degree of  @xmath94 in  @xmath114 ; here , for any @xmath249 , the symbol  @xmath250 denotes the complete graph of size @xmath107 .",
    "this also shows the identity  @xmath251 for all  @xmath241 .",
    "hence , for any @xmath105 , we have @xmath252    further , it is easy to see that , for any  @xmath249 , one has  @xmath253 .",
    "indeed , let us fix two adjacent vertices of @xmath250 and consider the involution  @xmath254 given by exchanging them .",
    "the set of fixed points  @xmath255 consists of the dimer configurations matching these two vertices .",
    "since  @xmath256 is a bijection and  @xmath257 for all  @xmath258 , we have @xmath259 by induction over  @xmath249 . therefore ,",
    "@xmath260 for any  @xmath105 , and we complete the proof by the summation over all configurations  @xmath105 .    in order to handle the signs  @xmath261 given by  , we shall also need the following well - known fact , traditionally attributed to whitney  @xcite , whose easy proof we include for completeness .",
    "[ lemma : whitney ] let  @xmath124 be an oriented piecewise smooth planar closed curve , and let  @xmath262 denote the total rotation angle of its velocity vector . if  @xmath124 is in general position , i.e. if all of its self - intersections are transverse double points , then @xmath263=(-1)^{\\rt(c)},\\ ] ] where  @xmath264 denotes the number of these self - intersections .",
    "consider the union  @xmath265 of oriented simple closed curves obtained by smoothing out all of the self - intersection points of  @xmath124 as follows : . letting @xmath266 be the sum of the total rotation angles of these curves and since the total rotation angle of a simple closed curve is either  @xmath267 or  @xmath268 , we have @xmath269=\\exp[\\textstyle\\frac{i}{2}{\\opname{wind}}(c')]=(-1)^{m}\\,,\\ ] ] where  @xmath270 denotes the number of components of  @xmath265 .",
    "the lemma now follows from the fact that  @xmath270 has the same parity as  @xmath271 since each of the smoothing operations used above to construct  @xmath265 changes the number of components in  @xmath124 by  @xmath6 .",
    "expanding the pfaffian of  @xmath91 leads to @xmath272}~=~\\sum_{d\\in\\cd(g^\\rk)}\\veps(d)x^\\rk\\!(d)\\,,\\quad\\text{with}\\quad \\veps(d)={{\\opname{sign}}(\\sigma)\\cdot}\\veps_{\\sigma(1)\\sigma(2)}\\dots\\veps_{\\sigma({2n-1})\\sigma({2n})}\\,,\\ ] ] where  @xmath273 and  @xmath274 is any permutation representing the matching  @xmath238 ( i.e. such that given an ordering of the vertices , for all @xmath275 , the dimers in @xmath238 are the edges of the form @xmath276 ) ; note that  @xmath277 does not depend on the choice of  @xmath5 provided that some numbering of the set @xmath278 is fixed once and for all .",
    "let @xmath279 be the standard reference matching consisting of long edges only . comparing with lemma  [ lemma : terminal ]",
    ", we see that the following claim directly implies theorem  [ thm : kw1 ] .",
    "( in the terminology of tesler  @xcite , this amounts to checking that the signs  @xmath261 define a _ crossing orientation _ on the terminal graph  @xmath93 . )    _ claim  a. for any  @xmath241 , one has  @xmath280 . _    indeed , one easily deduces from lemma  [ lemma : terminal ] and claim  a that @xmath281}\\,.\\ ] ]    _ proof of claim a. _ given two dimer configurations  @xmath282 , their symmetric difference  @xmath283 is a union of  @xmath284 vertex disjoint ( on  @xmath93 ) cycles  @xmath285 of even length .",
    "moreover , due to the particular choice of @xmath286 , each @xmath285 is composed of _ alternating _ short and long edges of @xmath93 .",
    "let us choose representatives  @xmath287 of  @xmath288 such that  @xmath289 is the rotation by one edge of each of these cycles , with respect to some arbitrary but fixed orientation . using this particular choice of representatives , we find @xmath290 where  @xmath291 denotes the product of the coefficients  @xmath292 $ ] along the short edges of  @xmath285 ( the factors of @xmath293 and @xmath294 from   contribute in total @xmath0 because of the alternation of long and short edges ) .",
    "relating this product with the total rotation angle  @xmath295 of the velocity vector of ( a  smoothed version of )  @xmath285 and applying lemma  [ lemma : whitney ] leads to @xmath296 ) = \\prod_{j=1}^\\ell ( -1)^{\\rt(c_j)}=(-1)^{\\rt(d)}\\,,\\ ] ] since all the intersections and self - intersections of @xmath285 are produced by _ short _ edges , which all belong to @xmath238 , and each pair of different cycles intersects an even number of times .",
    "let us write  @xmath297 and denote by @xmath298 the subgraph of the terminal graph  @xmath93 obtained by removing all vertices  @xmath299 , together with adjacent edges .",
    "fix some numberings of the sets @xmath101 ,  @xmath300 , and denote by  @xmath301 the permutation of the ordered set  @xmath302 induced by the trivial identification of  @xmath101 and  @xmath303 . using the pfaffian identity @xmath304}_{e , e'\\in\\re}~=~(-1)^{n}{{\\opname{sign}}(\\nu_\\re)\\,\\cdot}{\\opname{pf}[\\,{\\widehat{\\rk}}_{e , e'}\\,]}_{e , e'\\notin\\re}\\cdot ( { \\opname{pf}[\\,{\\widehat{\\rk}}\\,]})^{-1}\\ ] ] and",
    ", we only need to check the equality @xmath305}_{e , e'\\notin\\re}\\,,\\ ] ] where the sign  @xmath306 of the standard reference matching on  @xmath93 is given by  .",
    "we shall do so by generalizing the proof of theorem  [ thm : kw1 ] given above .",
    "observe that lemma  [ lemma : terminal ] ( which deals with the case @xmath307 , i.e. @xmath308 ) extends in a straightforward way , yielding the equation @xmath309 where the configuration  @xmath310 is obtained from  @xmath311 by removing all edges corresponding to long dimers of  @xmath238 as well as the half - edges  @xmath312 . at the same time ,",
    "@xmath313}_{e , e'\\notin\\re}~=\\sum_{d\\in\\cd(g^\\rk_\\re)}\\veps_\\re(d)x^\\rk(d)\\,,\\ ] ] where the sign  @xmath314 of a dimer configuration on  @xmath298 is defined similarly to   according to the fixed ordering of  @xmath300 .",
    "thus we are left with the proof of the following claim , which generalizes claim  a from the proof of theorem  [ thm : kw1 ] .",
    "_ claim  b. for any  @xmath315 , one has @xmath316 .",
    "_    _ proof of claim  b. _ given a dimer configuration @xmath317 , the symmetric difference  @xmath283 consists of a union of  @xmath318 vertex disjoint cycles  @xmath285 of even length , together with  @xmath159 vertex disjoint paths  @xmath129 of odd length matching the vertices  @xmath299 .",
    "( note that the paths  @xmath129 start and end with _",
    "long _ edges  @xmath319 of @xmath93 , and if both  @xmath320 , then one of these paths is just the single long edge  @xmath319 . )",
    "moreover , one can choose representatives  @xmath321 of  @xmath238 ,  @xmath322 of  @xmath286 , and  @xmath323 of the corresponding matching of  @xmath128 such that the permutation @xmath324 is the rotation by one edge of each of the cycles  @xmath285 and of each of the paths  @xmath129 closed up by an artificial link oriented from  @xmath325 to  @xmath326 , thus  @xmath129 is always oriented in a _",
    "backward _ direction .",
    "since all of these cycles are of even length , the diagram above implies the equality @xmath327 computing the signs  @xmath314 and  @xmath306 using this particular choice of representatives and the fact that all the  @xmath285 and  @xmath129 are formed by alternating long and short edges of  @xmath93 ( this is a consequence of the particular choice of the reference matching  @xmath286 ) , we get @xmath328 where @xmath291 and  @xmath329 denote the products of the coefficients  @xmath292 $ ] along the short edges of  @xmath285 and  @xmath129 , respectively , with the paths  @xmath129 being traversed from  @xmath326 to  @xmath325 .    let us shorten the extremities of the paths  @xmath129 so that they link the points  @xmath330 instead of  @xmath331 .",
    "similarly to the proof of theorem  [ thm : kw1 ] , we have @xmath332=(-1)^{\\rt(c_j)+1}\\,,\\\\ { \\omega(\\overleftarrow{\\gamma_k } ) } & = \\exp[{\\textstyle\\frac{i}{2}}{\\opname{wind}}(\\overleftarrow{\\gamma_k})]=\\exp[-{\\textstyle\\frac{i}{2}}{\\opname{wind}}(\\gamma_k)]\\,.\\end{aligned}\\ ] ] denote @xmath333 combining all the computations given above , we reduce claim  b to the following statement .    _ claim  c. for any  @xmath315 , if  @xmath283 consists of cycles  @xmath285 and paths  @xmath129 , then @xmath334 _    recall that long edges of  @xmath283 correspond to edges of  @xmath335 while short edges of  @xmath283 define a decomposition of  @xmath114 into cycles  @xmath285 and paths  @xmath129 . in particular , if all  @xmath285 and  @xmath129 do not intersect or self - intersect , then  @xmath336 and   coincides with _ definition _   of  @xmath139 .",
    "essentially , claim  c states that the left - hand side of   does not depend on the choice of @xmath337 , which also implies that the sign  @xmath139 is well - defined ( i.e. independent of the smoothing of  @xmath114 ) .",
    "_ proof of claim  c. _ let @xmath338 and let us fix some non - intersecting smoothing of  @xmath114 into  cycles  @xmath339 and  paths  @xmath340 and compute the sign @xmath139 by using these paths .",
    "note that the result does not depend on their numbering and orientations .",
    "given  @xmath337 , we number @xmath340 and choose their orientations ( from  @xmath341 to  @xmath342 ) so that @xmath343 we now push each path  @xmath129 slightly to its right and denote the result by  @xmath344 .",
    "if we consider the union of all  @xmath344 and all  @xmath340 and match their endpoints by @xmath107 counterclockwise @xmath345turns , the result is a collection  @xmath203 of  @xmath346 oriented closed curves  @xmath347 .",
    "it is easy to see that @xmath348 which leads , by   and  , to @xmath349)\\cdot \\prod_{k=1}^n(i\\exp[-{\\textstyle\\frac{i}{2}}{\\opname{wind}}(\\gamma_k ) ] ) } \\\\ & = ~ ( -1)^m \\exp[-{\\textstyle\\frac{i}{2}}{\\opname{wind}}(\\delta)]\\,.\\end{aligned}\\ ] ] applying lemma  [ lemma : whitney ] to each  @xmath347 , we are left with the proof of the following fact : @xmath350 note that this is equivalent to the equality @xmath351 where @xmath352 , since the total number of intersections of the closed curves  @xmath285 with each other is even due to topological reasons and the same is true for @xmath347 .",
    "we need some additional notation .",
    "similarly to  @xmath353 , let us push each  @xmath285 slightly to its right and denote the result by @xmath354 .",
    "let @xmath355 it is easy to see that @xmath356 where we denote by  @xmath357 the number of intersections of ( the collections of ) curves  @xmath358 and  @xmath12 .",
    "indeed , as  @xmath359 , all these intersections come from the intersections of short dimers in  @xmath238 and each pair of such dimers contributes _ two _ intersections to  @xmath360 .",
    "since the collection of loops and paths @xmath361 can be deformed to the configuration  @xmath362 and then further to its smoothing  @xmath363 , we conclude that @xmath364 as @xmath365 is essentially a collection of closed curves , we also have @xmath366 by construction , @xmath367 and @xmath368 do not intersect and the number of intersections of  @xmath369 and  @xmath368 is always even .",
    "therefore , we obtain @xmath370 the last two simple observations are @xmath371 where we used the fact that  @xmath367 is non - intersecting . since @xmath372 and  @xmath373 , the identity   follows , as well as claim  c and theorem  [ thm : multipoint ] .      in this section",
    "we work with the ( domain walls expansion of the ) ising model on the dual graph  @xmath24 with  ` @xmath29 ' boundary conditions , which means that we set the spin of the outer face  @xmath28 of  @xmath2 to be  @xmath30 .",
    "recall that the matrices  @xmath374}$ ] ,  @xmath375}$ ] and  @xmath193}$ ] are defined via some ( arbitrary but fixed ) collection  @xmath146}$ ] of edge - disjoint paths on  @xmath24 linking @xmath48 and , possibly ,  @xmath28 so that each of  @xmath48 has an odd degree in the union of these paths . note that if a spin configuration  @xmath178 with @xmath156 corresponds to a domain walls configuration  @xmath105 , then @xmath376 where  @xmath377 denotes the number of intersections of  @xmath114 with  @xmath153 .",
    "below we assume that the terminal graph  @xmath93 is drawn in such a way that its long edges intersect  @xmath153 if and only if the corresponding edge of  @xmath2 does the same , while short edges never intersect these `` cuts '' .",
    "the following statement generalizes  lemma  [ lemma : terminal ] .",
    "[ lemma : x - terminal ] for any planar graph  @xmath16 , and any set of edges  @xmath378 , one has @xmath379 where  @xmath152 denotes the total number of edges in the collection of ( dual ) paths  @xmath146}$ ] .",
    "following the proof of lemma  [ lemma : terminal ] , the only additional fact to check is the identity @xmath380 by construction of the mapping  @xmath381 , for each  @xmath26 and  @xmath241 , we have  @xmath382 if and only if the corresponding long edge of  @xmath93 does _ not _ belong to  @xmath238 . therefore , @xmath383 and the claim is proved .",
    "we are now able to prove formula   for multi - point spin expectations .",
    "it follows from   and lemma  [ lemma : x - terminal ] that @xmath384=\\frac{\\sum_{p\\in\\ce(g ) } ( -1)^{\\varkappa\\cdot p}x(p)}{\\sum_{p\\in\\ce(g)}x(p)}= ( -1)^{|\\varkappa|}\\cdot \\frac{\\sum_{d\\in\\cd(g^\\rk ) } ( -1)^{\\rt(d)}(-1)^{\\varkappa\\cdot d}x^\\rk(d)}{\\sum_{d\\in\\cd(g^\\rk ) } ( -1)^{\\rt(d)}x^\\rk(d)}\\,.\\ ] ] it was shown in the proof of theorem  [ thm : kw1 ] that @xmath385}= \\veps(d_0)\\sum_{d\\in\\cd(g^\\rk ) } ( -1)^{\\rt(d)}x^\\rk(d)\\,.\\ ] ] repeating the same proof , we find @xmath386}\\,]}=\\veps(d_0)\\sum_{d\\in\\cd(g^\\rk ) } ( -1)^{\\rt(d)}(-1)^{\\varkappa\\cdot d}x^\\rk(d)\\,,\\ ] ] thus arriving at  .",
    "we conclude this section with one last statement which naturally generalizes theorem  [ thm : multipoint ] .",
    "[ prop : multipoint - with - spins ] let  @xmath48 be some faces of  @xmath2 and the matrix  @xmath387}$ ] be defined using the collection @xmath146}$ ] of edge - disjoint paths on  @xmath24 linking  @xmath48 and  @xmath28 . for any set of  @xmath107 oriented edges  @xmath388 , one has @xmath389})_{e_j , e_k}\\,]}_{j , k=1}^{2m}~=~ \\frac{\\sum_{p\\in\\cc(e_1,\\dots , e_{2n } ) } ( -1)^{\\varkappa\\cdot p}\\tau(p)x(p ) } { { \\mathbb{e}}^+_{g^*}[\\sigma_{u_1}\\dots\\sigma_{u_m}]\\cdot \\cz_{\\opname{ising}}(g , x)}\\,.\\ ] ] above , if some edge  @xmath390 intersects  @xmath153 and @xmath117 , we _ do _ count the corresponding half - edge  @xmath391 in the intersection number  @xmath377 .    mimicking the proof of lemma  [ lemma : x - terminal ] for the mapping  @xmath392 , one gets @xmath393 on the other hand , from the proof of formula   given above we know that @xmath394\\cdot \\cz_{\\opname{ising}}(g , x)~&=~(-1)^{|\\varkappa|}\\!\\!\\!{\\sum_{d\\in\\cd(g^\\rk ) } ( -1)^{\\rt(d)}(-1)^{\\varkappa\\cdot d}x^\\rk(d ) } \\\\ & = ~(-1)^{|\\varkappa|}\\veps(d_0){\\opname{pf}[\\,{\\widehat{\\rk}}_{[u_1, .. ,u_m]}\\,]}\\,,\\end{aligned}\\ ] ] which is a proper replacement for   in the twisted setup .",
    "we now simply follow the proof of theorem  [ thm : multipoint ] with the weights  @xmath395 replaced by  @xmath396 .",
    "it is worth noting that the check of signs performed in claim  b ( and further claim  c ) does not depend on  @xmath98 .",
    "this section is devoted to a self - contained exposition of the relations between several classical approaches designed to study the planar ising model : dimer representations  @xcite , grassmann variables  @xcite , disorder insertions  @xcite , as well as a more recent language of ` combinatorial ' s - holomorphic observables  @xcite .",
    "of course , most if not all claims below are part of the folklore surrounding the ising model . however , we hope that such an exposition , intended in particular for combinatorialists and probabilists , will be useful in view of the renewed activity in the field .",
    "we also refer the reader interested in a more advanced discussion of spin - disorder techniques to the recent papers  @xcite by dubdat .      in section  [ sec : planar ] ,",
    "one of the main tools used was a dimer representation of the ising model on the non - bipartite and , in general , _ non - planar _ terminal graph  @xmath93 . in a famous variation on this construction ,",
    "fisher introduced a _ planar _ but non - bipartite graph such that the ising configurations were in @xmath0to@xmath0 correspondence with dimers .",
    "his mapping may be described , paraphrasing his own words  @xcite , as follows : one starts with the graph @xmath2 and makes all its vertices trivalent ( without changing the probability measure ) and then uses the mapping of the configurations to dimers on the terminal graph of this new graph , which in virtue of trivalence , is planar and the dimer measure is unsigned .",
    "a more symmetric version of this construction was later proposed in  @xcite forcing the mapping from configurations to dimers to be @xmath397to@xmath0 . yet another ( slighly simpler ) variation on fisher s idea was proposed in  @xcite , where long dimers are in direct correspondence with ising configurations , and this is the one we shall use here , calling the corresponding graph the fisher graph .    in this section",
    "we briefly discuss representations of the ising model on  @xmath2 via dimers on the two following graphs : the corner graph  @xmath398 and the fisher graph  @xmath399 discussed above , the latter being _ planar _ but also never bipartite , see fig .",
    "[ fig : corner - fisher ] .",
    "it is worth noting that there exist several combinatorial ways to represent a _",
    "pair _ of independent ising models via _ single _ dimers on some other graph constructed from  @xmath2 , which is both planar and bipartite ( see  @xcite ) , but we do not discuss these constructions here .",
    ".49 2.5pt at 220 120    .48 2.5pt at 180 145 at 180 45 at 250 145 at 250 45    .49 2.5pt at 175 90 at 220 90 at 150 149 at 150 65 at 253 149 at 253 65    .48 2.5pt at 40 50 at 85 50 at 180 50    for a while , assume that  @xmath2 has no vertices of degree  @xmath0 ( clearly , we do not lose generality by making this assumption , though it will be convenient to allow such vertices later on ) .",
    "let  @xmath398 denote the _ corner graph _ obtained from  @xmath2 as follows : each vertex  @xmath94 of  @xmath2 ( of degree  @xmath95 ) is replaced by a simple cycle of length  @xmath95 , with each pair of cycles corresponding to neighboring vertices  @xmath400 being cross - linked by four edges of  @xmath398 , as shown on fig .",
    "[ fig : corner ] .",
    "the vertices of  @xmath398 are called _ corners _ of  @xmath2 ; note that  @xmath401 . with each corner",
    "@xmath402 we associate a straight segment on the plane , the so - called  _ decoration _ of  @xmath2 at  @xmath403 , oriented _ towards _ the corresponding vertex of  @xmath2 which we denote by  @xmath404 . given an oriented edge  @xmath405 ,",
    "we denote by  @xmath406 the two neighboring corners of  @xmath68 satisfying  @xmath407 , see  fig .  [",
    "fig : corner ] .",
    "let the square matrix  @xmath408 be defined by @xmath409\\cdot x_e^{-1/2 } & \\text{if~$c$~is~one~of~the~two~corners~$c^\\pm(e)$ ; } \\\\ 0 & \\text{otherwise , } \\end{cases}\\ ] ] where  @xmath410 denotes the rotation angle from the decoration of  @xmath2 at  @xmath403 to the oriented edge  @xmath68 .",
    "note that  @xmath411 has a block - diagonal structure with  @xmath412 blocks  @xmath413 corresponding to vertices  @xmath414 .",
    "it is easy to see that @xmath415 = ~2^{|v(g)|}\\!\\!\\!\\prod_{e\\in e(g)}x_e^{-1}.\\ ] ]    let us now define the matrix @xmath416 whose entries are labeled by the corners  @xmath402 .",
    "a straightforward computation gives @xmath417\\cdot x_e^{-1 } & \\text{if~$v(c)=o(e)$~and~$v(c')=t(e)$~for~some~$e\\in v(g^\\rk)$ ; } \\\\ -\\exp[\\frac{i}{2}\\rw(c,\\overline{c } ' ) ] & \\text{if~$v(c)=v(c')$~and~$c$~is~adjacent~to~$c'$~in~$g^\\rc$ ; } \\\\ 0 & \\text{otherwise . }",
    "\\end{cases}\\ ] ] above ,  @xmath418 denotes the rotation angle from the oriented decoration  @xmath403 to the oppositely oriented decoration  @xmath419 , measured in a natural way : along the path  @xmath420 in the first line , and along  @xmath421 in the second .",
    "note that @xmath422 is a weighted adjacency matrix of the graph  @xmath398 which is `` almost planar '' : the only pairs of intersecting edges go along edges of  @xmath2 . to get a weighted adjacency matrix of a _",
    "planar _ graph ,",
    "let us introduce a twice bigger matrix @xmath423 , whose entries are labeled by the set @xmath424 , as follows : @xmath425 again , a straightforward computation shows that , for @xmath426 , @xmath427 & \\text{if~$v(c)=v(c')$~and~$c$~is~adjacent~to~$c'$~in~$g^\\rc$ ; } \\\\ 0 & \\text{otherwise . } \\end{cases}\\ ] ]    therefore , @xmath423 is a weighted adjacency matrix of the graph  @xmath399 with  @xmath428 , which is constructed from  @xmath2 as follows : for each  @xmath429 , the  @xmath95 corners  @xmath402 satisfying  @xmath430 are linked cyclically around  @xmath94 ; for each edge of @xmath2 , the two corresponding vertices @xmath431 are linked with each other ; and , finally , each of the vertices  @xmath405 is linked with two neighboring corners @xmath432 , see fig .  [",
    "fig : fisher ] .",
    "as discussed in the introductory paragraph of this section , the _ planar _ graph @xmath399 is not fisher s original graph  ( * ? ? ?",
    "* fig .  6 ) nor its symmetric modification  @xcite , but we still call it the _ fisher graph _ , following  @xcite",
    ". we shall denote by  @xmath433 the edge weights on  @xmath399 obtained by assigning weights  @xmath434 to short edges of  @xmath399 linking vertices  @xmath405 with  @xmath435 and weight  @xmath0 to all other edges .",
    "it is well - known that there exists a simple  @xmath397to@xmath0 correspondence  @xmath436 between perfect matchings of  @xmath399 and even subgraphs of  @xmath2 : given  @xmath437 , take all the edges  @xmath26 corresponding to long dimers  @xmath438 .",
    "it is easy to check that , for any  @xmath105 , @xmath439 which leads to the equality @xmath440    similarly to the choice of square roots  @xmath87 for  @xmath405 , let us fix a square root  @xmath441 of the direction of the decoration corresponding to  @xmath402 .",
    "we denote by  @xmath442 the diagonal matrix with entries  @xmath443 , by  @xmath444 the diagonal matrix with entries  @xmath445 , and set @xmath446 where  @xmath447 , see  .",
    "note that all matrices  @xmath448 and  @xmath449 are real - valued .",
    "moreover ,  @xmath450 and  @xmath449 are anti - symmetric since  @xmath422 and  @xmath423 are self - adjoint , similarly to the symmetries of  @xmath91 and  @xmath92 .",
    "the identities @xmath451 imply @xmath452}|=|{\\opname{pf}[\\,{\\widehat{\\rc}}\\,]}|= |\\det\\rb|\\cdot |{\\opname{pf}[\\,{\\widehat{\\rk}}\\,]}|.\\ ] ]    finally ,",
    "it is easy to check that , for any choice of the square roots  @xmath87 ,  @xmath441 , the signs of the matrix entries  @xmath453 provide a kasteleyn orientation @xcite of the planar graph @xmath399 . therefore , @xmath454}|=|{\\opname{pf}[\\,{\\widehat{\\rk}}\\,]}|\\,,\\ ] ] which gives an alternative proof of theorem  [ thm : kw1 ] in the planar case .",
    "[ rk : lieb ] in  ( * ? ? ?",
    "* theorem a.1 ) , lieb and loss gave a new proof ( which is canonical in some sense ) of kasteleyn s theorem for counting dimers on any planar graph .",
    "if we rephrase their result in the special case of our planar graph @xmath399 , it is interesting to note that their hermitian matrix @xmath455 is exactly the matrix @xmath423 we introduced above , thus showing that their method is related to the symmetries of the kac ",
    "ward matrix .",
    "indeed , their main theorem is that the square root of the modulus of the determinant of  @xmath455 counts dimers and that  @xmath455 can be gauge - transformed ( that is , conjugated by a diagonal unitary matrix ) to be equal to @xmath293 times an antisymmetric matrix ( which is therefore a kasteleyn matrix and kasteleyn s theorem is proved ) .",
    "our identity @xmath456 expresses the same thing ( by furthermore specifying the gauge transform ) in the special case of  @xmath457 .    in the same spirit",
    ", one can use the real anti - symmetric matrix @xmath450 to obtain another proof of theorem  [ thm : kw1 ] based on the considerations of the signed dimer model on the corner graph  @xmath398 . similarly to the dimer model on  @xmath93 considered in section  [ sec : planar ] , in this case one should account the sign  @xmath458 , where @xmath239 now denotes the number of intersections in a dimer configuration  @xmath459 , so that the combinatorial correspondence of  @xmath19 with  @xmath460 and the expansion of @xmath461}$ ] work properly .",
    "again , this essentially amounts to checking that the signs of matrix entries  @xmath462 provide a crossing orientation of  @xmath398 in the terminology of tesler  @xcite .",
    "we conclude this section with a remark on modifications needed to include univalent ( i.e. having degree  @xmath0 ) vertices of  @xmath2 into considerations , this will be useful to discuss boundary conditions for discrete fermionic observables in section  [ sub : s - observables ] below .",
    "[ rem : degree - one - vertices ] let  @xmath463 be a degree  @xmath0 vertex and @xmath464 be the unique oriented edge of  @xmath2 satisfying  @xmath465 . in this case the corner graph  @xmath398 contains only _ one _ corner  @xmath466 near  @xmath467 , and we always draw the corresponding decoration as pointing in the same direction as the edge  @xmath468 , see fig .",
    "[ fig : corner-1 ] . the corresponding @xmath469 block of the matrix  @xmath411 is then defined as @xmath470\\cdot x_{e_1}^{-1/2}=x_{e_1}^{-1/2},\\ ] ] while the mapping @xmath436 is @xmath0-to-@xmath0 near such  @xmath467 , not @xmath122-to-@xmath0 : the edge  @xmath471 never participates in  @xmath105 while the dimer @xmath472 presents in all @xmath437 . with these modifications ,",
    "the arguments given above remain true in presence of degree  @xmath0 vertices .      in this section",
    "we discuss the well - known formalism of grassmann variables ( e.g. see ( * ? ? ?",
    "* chapter 2.a ) ) , i.e. _ _ anti-__commuting variables  @xmath473 associated with a real _ _ anti-__symmetric matrix   in the context of the planar ising model , when the matrix @xmath474 is equal to  @xmath91 or  @xmath387}$ ] . in the latter case",
    ", we introduce a _ double - cover _",
    "@xmath475}$ ] of  @xmath2 in order to make the formal correlation functions independent of the choice of collection of cuts  @xmath146}$ ] .    for a real anti - symmetric matrix  @xmath474 ,",
    "let @xmath476~d\\phi_{1}\\dots d\\phi_{2n } = { \\opname{pf}[\\,a\\,]}\\ ] ] denote the coefficient of the highest monomial  @xmath477 in the formal taylor expansion of  @xmath478 $ ] ( note that , since  @xmath479 , this expansion contains only a finite number of terms ) .",
    "further , for an even subset  @xmath480 of indices  @xmath481 , let @xmath482 = \\int \\phi_{k_1}\\dots\\phi_{k_{2n}}\\!\\exp[-{\\textstyle \\frac{1}{2}}\\phi^\\top\\!a\\phi]~d\\phi_{1}\\dots d\\phi_{2n}\\ ] ] be the coefficient of the highest monomial  @xmath483 in the formal expansion of the expression  @xmath484 $ ] .",
    "note that this coefficient trivially vanishes if some of these  @xmath485 variables is repeated twice ( or more ) or if the number of these variables is odd .",
    "let  @xmath486 .",
    "recall that , up to a global  @xmath6 sign , @xmath487}$ ] is equal to the ising model partition function  @xmath104 due to theorem  [ thm : kw1 ] .",
    "the _ formal correlation function _ of the grassmann variables  @xmath488 with  @xmath489 is defined as @xmath490}{\\mathcal{z}_{{\\widehat{\\rk}}}}\\,.\\ ] ] by definition , this function is anti - symmetric with respect to the ordering of the variables  @xmath491 . in particular , @xmath492 .",
    "it is an easy exercise to check that @xmath493}_{e , e'\\not\\in\\re}}{{\\opname{pf}[\\,{\\widehat{\\rk}}\\,]}}=~ { \\opname{pf}[\\,{\\widehat{\\rk}}^{-1}_{e_j , e_k}\\,]}_{j , k=1}^{2n } = { \\opname{pf}[\\,\\lan\\phi_{e_j}\\phi_{e_k}\\!\\ran_{{\\widehat{\\rk}}}\\,]}_{j , k=1}^{2n } \\,,\\ ] ] where the sign in the middle depends on the ordering of the sets  @xmath494 and  @xmath101 .",
    "[ rem : grassmann - combinatorics ] working with the grassmann variables formalism , one can wonder about the  _ combinatorial _ interpretation of the arising formal correlation functions  .",
    "the answer to this question is the matter of theorem  [ thm : multipoint ] .",
    "now let  @xmath495}$ ] .",
    "recall that , for a given collection of faces  @xmath147 and a fixed collection of dual paths  @xmath146}$ ] linking @xmath48 and , possibly ,  @xmath28 on  @xmath496 , we have  @xmath387}=i\\ru\\rk_{[u_1, .. ,u_m]}\\ru^*$ ] , where @xmath497})_{e , e'}=\\begin{cases } ( -1)^{\\varkappa\\cdot e } & \\text{if~$e'=\\overline{e}$;}\\\\ -\\exp[\\frac{i}{2}\\rw(\\overline{e},e')]\\cdot(x_ex_{e'})^{1/2 } & \\text{if~$o(e)=o(e')$ but~$e'\\neq e$ ; } \\\\ 0 & \\text{otherwise . }",
    "\\end{cases}\\ ] ] given a collection of oriented edges  @xmath498 , we define the `` twisted '' correlation functions of grassmann variables  @xmath499 as @xmath500}~:= \\mathcal{z}_{{\\widehat{\\rk}}_{[u_1, .. ,u_m]}^{-1}}\\!\\!\\cdot\\,{\\mathcal{z}_{{\\widehat{\\rk}}_{[u_1, .. ,u_m]}}[\\phi_{e_1}\\dots\\phi_{e_{2n}}]}= { \\opname{pf}[\\,{\\widehat{\\rk}}_{[u_1, .. ,u_m]}^{-1}\\,]}_{e , e'\\in\\re}\\ ] ] ( in this case , the relevant combinatorial expansions are provided by proposition  [ prop : multipoint - with - spins ] ) . as usual , these formal correlations implicitly depend on the choice of the paths  @xmath191}$ ] but there is a standard way to make the notation more invariant .",
    "let  @xmath501}$ ] denote the canonical double - branched cover of the complex plane  @xmath502 with branching points  @xmath503 , which is endowed with an involution  @xmath504 and with a projection onto  @xmath502 .",
    "then , any graph  @xmath2 embedded in  @xmath53 lifts to the canonical double - cover  @xmath475}$ ] embedded in  @xmath501}$ ] .",
    "now , any cut set  @xmath191}$ ] gives us a particular way to construct this cover as two copies of the plane cut and pasted , and idem for the embedded graphs .",
    "equivalently , such a set of cuts gives us two sections of this cover ( i.e. the choice of one point above each of the points in the plane ) .",
    "given  @xmath191}$ ] and  @xmath505})$ ] lying on one of the corresponding sections , we set @xmath506 this notation allows us to speak about formal correlation functions  @xmath507}$ ] with  @xmath140 on the canonical double - cover of the terminal graph  @xmath93 and it is easy to see that these quantities are _ independent of the choice of  @xmath146}$]_. indeed , shifting  @xmath153 across some vertex  @xmath429 amounts to the multiplication by  @xmath31 of all the rows and the columns of the matrix  @xmath213}$ ] that are labeled by oriented edges  @xmath68 with  @xmath508 .",
    "this leads to the multiplication of all the corresponding variables  @xmath499 by  @xmath31 and agrees with  .      in this section",
    "we briefly discuss the formalism of disorder insertions developed in  @xcite , see also  @xcite . in this approach ,",
    "one easily finds _ combinatorial _ expansions of correlation functions similar to theorem  [ thm : multipoint ] and proposition  [ prop : multipoint - with - spins ] , as shown in  lemma  [ lemma : mu - sigma ] and remark  [ rem : x - mu - sigma ] below . on the other hand , following this approach then requires additional efforts to reveal the underlying _ pfaffian _ structure of correlation functions .",
    "( note that this is exactly opposite to the discussion of the grassmann variables formalism given above , cf .",
    "remark  [ rem : grassmann - combinatorics ] . )",
    "recall that we prefer to work with the domain walls representations of the ising model , thus the spins  @xmath5 are associated with faces of @xmath2 while  @xmath509 will be associated to _",
    "vertices _ of  @xmath2 ( this is dual to the more common convention which assigns spins to vertices of  @xmath2 and disorders to its faces ) . given an even number of vertices  @xmath510 , let us fix a collection of edge - disjoint paths  @xmath511}\\subset e(g)$ ] matching them so that each vertex  @xmath512 has an odd degree in  @xmath153 while all other vertices have even degrees , and let @xmath513\\,,\\ ] ] where  @xmath514 denotes the energy density ( product of two nearby spins ) on an edge  @xmath68 .",
    "using domain walls representations , this can be written as @xmath515}(g , x)}{\\cz_{\\opname{low}}(g , x)}\\qquad\\text{with}\\qquad \\cz_\\mathrm{low}^{[v_1, ..",
    ",v_{2n}]}(g , x)\\,:=\\,\\sum\\nolimits_{p\\in\\cc(v_1, .. ,v_{2n})}x(p)\\,,\\ ] ] where @xmath516}\\in\\ce(g)\\}$ ] is the set of subgraphs  @xmath114 of  @xmath2 with all vertices of  @xmath2 except  @xmath517 having even degrees , and all the  @xmath512 odd .",
    "( above , we use the subscript  _ low _ in order to emphasize that these subgraphs should be thought about as domain walls aka low - temperature expansions of the ising model defined on faces of  @xmath2 .",
    "note that the kramers - wannier duality allows one to interpret  @xmath518 as the high - temperature expansion of the corresponding spin correlation in the dual model defined on vertices of  @xmath2 . )",
    "it is clear that the quantity  @xmath518 does not depend on the choice of  @xmath519}$ ] .",
    "however , the notation should not be directly interpreted probabilistically as the expectation of a product of random variables since the  @xmath520 themselves _ can not _ be thought of as random variables .    similarly to section  [ sub : grassmann ] , let us consider the canonical double - cover  @xmath521}$ ] of the graph  @xmath2 with the branch set  @xmath517 , endowed with the involution   acting on its _",
    "faces_. it is easy to see that  @xmath522}(g , x)$ ] is the partition function of the ising model defined on faces of  @xmath521}$ ] with the _ spin - flip symmetry _",
    "constrain  @xmath523 and a fixed spin of the outer face . from this perspective , the choice of the collection of paths  @xmath519}$ ] is nothing but a choice of a section of  @xmath521}$ ] . given",
    "faces  @xmath48 of the _ double - cover _",
    "@xmath521}$ ] , we set @xmath524}[\\sigma_{u_1}\\dots\\sigma_{u_m}]\\cdot \\langle\\mu_{v_1}\\dots\\mu_{v_{2n}}\\rangle,\\ ] ] where  @xmath525}$ ] stands for the expectation in the ising model described above . by definition",
    ", this quantity changes sign when one of  @xmath189 is replaced by  @xmath526 .",
    "note that we allow repeating faces  @xmath189 in  , in which case the corresponding spins cancel out . by a slight abuse of the notation",
    ", one can also allow repeating disorders  @xmath527 with the same cancellation effect .",
    "let us now consider a special situation when  @xmath158 and each of the faces  @xmath189 is incident to the corresponding vertex  @xmath512 .",
    "more precisely , we consider a collection of  @xmath107 _ pairwise distinct _",
    "corners  @xmath528 of  @xmath2 , put  @xmath529 , and denote by  @xmath530 the face of  @xmath2 that contains  @xmath531 .",
    "note that we _ do _ allow repetitions of these vertices and faces .",
    "let @xmath532 be the set of subgraphs from  @xmath533 with decorations  @xmath528 attached to the vertices  @xmath517 .",
    "similarly to the case of oriented edges , we introduce a sign  @xmath534 by resolving all the crossings of a configuration  @xmath535 so that  @xmath536 , where  @xmath159 simple paths  @xmath129 run from  @xmath537 to  @xmath538 and  @xmath124 is a collection of disjoint simple loops , and setting @xmath539\\right)\\,.\\ ] ] again , it is not hard to see that  @xmath540 is well - defined ( i.e. independent of the smoothing of  @xmath535 ) .",
    "[ lemma : mu - sigma ] let  @xmath541 be a collection of  @xmath107 pairwise distinct corners of  @xmath2 . denote @xmath529 and let  @xmath542 be the face of  @xmath2 that contains  @xmath531 . then , @xmath543^{-1}\\,\\cdot\\!\\!\\!\\!\\!\\sum_{q\\in\\cc(c_1,\\dots , c_{2n})}\\!\\!\\!\\tau(q)x(p_q)\\,,\\ ] ] with the sign depending on the choice of representatives of the faces  @xmath167 on  @xmath521}$ ] .    using the domain walls representation  @xmath544 of the ising model on  @xmath521}$ ] , it is easy to see that the lemma follows from the equality @xmath545 where the sign  @xmath546 is independent of  @xmath535 . to prove this ,",
    "let us fix a collection of edge - disjoint paths  @xmath547}^0 $ ] matching the faces  @xmath167 on the _ dual _ graph  @xmath24 .",
    "we attach decorations  @xmath528 to the endpoints of these paths and denote the result by  @xmath548 , without loss of generality we can assume that  @xmath340 runs from  @xmath549 to  @xmath550 . let @xmath551)\\,.\\ ] ] note that , for a proper choice of representatives of  @xmath167 on the double - cover  @xmath552}$ ] and any configuration  @xmath553 , one has @xmath554 here and below  @xmath357 denotes the intersection number of  @xmath358 and  @xmath12 .",
    "let us consider a smoothing  @xmath555 , where  @xmath124 is a collection of closed curves and  @xmath556 a collection of  @xmath159 paths  @xmath129 running from  @xmath537 to  @xmath557 , which are oriented so that the concatenation  @xmath558 becomes a collection  @xmath203 of  @xmath270  oriented cycles  @xmath347 .",
    "since  @xmath124 and  @xmath556 do not intersect or self - intersect , one has @xmath559 where  @xmath560 is the number of self - intersections in  @xmath203 . on the other hand , using the equality  @xmath561 and lemma  [ lemma : whitney ]",
    ", we see that @xmath562 = ( -1)^{\\sum_{j=1}^m\\rt(\\delta_j)}=(-1)^{\\rt(\\delta)},\\ ] ] which implies   with  @xmath563 .",
    "[ rem : x - mu - sigma ] lemma  [ lemma : mu - sigma ] can be easily generalized in the following way .",
    "in addition to the collection of  @xmath107 corners  @xmath528 , let us consider another  @xmath270 faces  @xmath564 of  @xmath2 and let  @xmath565 be a proper collection of edge - disjoint paths linking  @xmath564 and , possibly ,  @xmath28 on  @xmath24 .",
    "note that we do not assume that these new faces are distinct from  @xmath167 and we allow  @xmath565 and  @xmath566}$ ] to share edges of  @xmath24 . repeating the proof of lemma  [ lemma : mu - sigma ] ,",
    "we obtain @xmath567^{-1}\\,\\cdot\\!\\!\\!\\!\\!\\sum_{q\\in\\cc(c_1,\\dots , c_{2n})}\\!\\!\\!(-1)^{\\varkappa'\\cdot q}\\tau(q)x(p_q)\\ ] ] since  @xmath568 .",
    "the aim of this section is to show that the two formalisms ( grassmann variables and disorder insertions ) discussed above are essentially equivalent .",
    "this fact is quite well - known in the folklore but we do not know of a reference explaining this correspondence in an explicit manner , especially when working in presence of additional spin variables in the formal correlation functions .",
    "note that theorem  [ thm : multipoint ] and its generalization provided by proposition  [ prop : multipoint - with - spins ] are the crucial ingredients needed to justify this equivalence .",
    "we begin by introducing some additional notation .",
    "let @xmath569 be another  @xmath570 grassmann variables assigned to the _ corners _ of the graph  @xmath2 , which are related to the `` edge '' variables  @xmath499 discussed in section  [ sub : grassmann ] by the linear transform @xmath571\\cdot x_e^{-1/2 } & \\text{if~$c = c^\\pm(e)$ ; } \\\\ 0 & \\text{otherwise , } \\end{cases}\\ ] ] see   and  .",
    "note that this change of variables is local in the following sense : for a given vertex  @xmath429 , the variables  @xmath499 with  @xmath508 are linear combinations of the variables  @xmath572 with @xmath430 , and vice versa . since  @xmath573 , the quadratic forms  @xmath574 and  @xmath575 coincide",
    "therefore , one can think about the new variables  @xmath572 as being associated to the anti - symmetric matrix  @xmath576 in a standard way described in section  [ sub : grassmann ] so that @xmath577}_{j , k=1}^{2n}\\,.\\ ] ] at the same time , for any  @xmath528 , one has @xmath578 where the right - hand side should be understood as follows : write each of the variables  @xmath579 as a linear combination of the old variables  @xmath499 and then compute the arising linear combination of the terms  @xmath580 .",
    "this allows us to drop the subscripts  @xmath91 or  @xmath581 from the notation .",
    "the next lemma provides combinatorial expansions of the quantities  @xmath582 .",
    "[ lemma : chi-2n - combinatorial ] let  @xmath541 be a collection of corners of  @xmath2 adjacent to pairwise distinct vertices  @xmath583 .",
    "then , @xmath584^{-1}\\,\\cdot\\!\\!\\!\\!\\!\\sum_{q\\in\\cc(c_1,\\dots , c_{2n})}\\!\\!\\!\\tau(q)x(p_q)\\,,\\ ] ] where the set of configurations  @xmath585 is given by  .",
    "recall that each of the variables  @xmath579 is a linear combination of the variables  @xmath491 with  @xmath586 , and the _ inverse _ transform is given by  .",
    "thus , in order to prove  , it is enough to check that these equalities yield the correct combinatorial expansions of formal correlations @xmath587 , which are given by theorem  [ thm : multipoint ] .    according to",
    ", we have @xmath588\\chi_{c^-(e)}+ \\eta_{c^+(e)}\\exp[{\\textstyle\\frac{i}{2}}\\rw(c^+(e),e)]\\chi_{c^+(e)}\\right),\\ ] ] where @xmath406 are the two decorations attached to the vertex @xmath589 neighboring  @xmath68 . given a pair of configurations  @xmath590 which differ by the decorations  @xmath591 only , it is easy to check that the quantities  @xmath592\\tau(q^\\pm)$ ] coincide if  @xmath593 and are opposite to each other otherwise . in particular",
    ", the two corresponding contributions to  @xmath587 cancel out in the latter case . repeating the same argument for all the other edges  @xmath594 ,",
    "one concludes that   is equivalent to the following claim : @xmath595^{-1}\\cdot\\!\\!\\!\\!\\!\\sum_{q\\in\\cc^+(e_1,\\dots , e_{2n})}\\!\\!\\!\\tau^+(q)x^+(q)\\,,\\ ] ] where the sum is taken over the set @xmath596 the modified weight of a configuration  @xmath535 is given by  @xmath597 and the modified sign  @xmath598 is given by @xmath599)\\,.\\ ] ]    there exists a trivial bijection  @xmath600 : erase all the decorations  @xmath531 and the half - edges  @xmath115 from a given configuration  @xmath535 to get @xmath601 .",
    "clearly , one has  @xmath602 and it is easy to check that  @xmath603 for all  @xmath535 .",
    "therefore , the collection of equalities   is reduced to the claim of theorem  [ thm : multipoint ] and we are done .",
    "let us now discuss modifications needed to include additional spin variables in the considerations above .",
    "for a given collection of faces  @xmath564 , denote @xmath604}:={\\widehat{\\rb}}\\,{\\widehat{\\rk}}_{[u_1', .. ,u_m']}{\\widehat{\\rb}}^\\top\\ ] ] and , for a given collection of corners  @xmath541 , let @xmath605}~:= { \\opname{pf}[\\,4({\\widehat{\\rc}}_{[u_1', .. ,u_m']}^{-1})_{c_j , c_k}\\,]}_{j , k=1}^{2n}\\,.\\ ] ] similarly to section  [ sub : grassmann ] , this notation implicitly depends on the cuts  @xmath606}$ ] linking  @xmath564 and , possibly ,  @xmath28 on  @xmath24 , but can be made canonical by lifting to the double - cover  @xmath607}$ ] . using proposition  [ prop : multipoint - with - spins ] instead of theorem  [ thm : multipoint ]",
    ", one obtains the following combinatorial expansion which generalizes lemma  [ lemma : chi-2n - combinatorial ] in the `` twisted '' setup : @xmath608 } ~=~ \\frac{\\sum_{q\\in\\cc(c_1,\\dots , c_{2n})}(-1)^{\\varkappa'\\cdot q}\\tau(q)x(p_q)}{\\mathbb{e}_{g^*}^+[\\sigma_{u_1'}\\dots\\sigma_{u_m'}]\\cdot\\cz_{\\opname{ising}}(g , x)}\\,,\\ ] ] where  @xmath528 are thought about as lying on a section of  @xmath607}$ ] constructed via  @xmath565 .",
    "we are now able to justify the equivalence of the two formalisms discussed above : grassmann variables ( considered on double - covers ) and disorder insertions .",
    "the next result claims that the formal correlation functions introduced in sections  [ sub : grassmann ] and  [ sub : disorders ] , respectively , are essentially the same , with the correspondence given by the formal rule  @xmath609 .",
    "[ prop : equivalence ] let  @xmath541 be a collection of corners of  @xmath2 adjacent to pairwise distinct vertices  @xmath583 and let  @xmath542 be the face of  @xmath2 that contains  @xmath531 . then , for an arbitrary collection of faces  @xmath564 of  @xmath2 , one has @xmath610}\\cdot\\,\\langle\\sigma_{u_1'}\\dots\\sigma_{u_m'}\\rangle\\,,\\ ] ] where the sign depends on the choice of representatives of the faces  @xmath611 on the double - cover  @xmath521}$ ] and representatives of the corners  @xmath528 on  @xmath612}$ ] . above",
    ", we do _ not _ assume that the faces  @xmath611 are pairwise distinct .",
    "let us consider the special case  @xmath613 first . in this case",
    ", the equality @xmath614 directly follows from lemma  [ lemma : mu - sigma ] and lemma  [ lemma : chi-2n - combinatorial ] since both sides have identical combinatorial expansions . in the general situation",
    ", one just uses remark  [ rem : x - mu - sigma ] and formula   instead of these lemmas .",
    "the claim follows since  @xmath615 $ ] .",
    "[ rem : two - formalisms ] _ ( i )",
    "_ it is worth noting that lemma  [ lemma : chi-2n - combinatorial ] and proposition  [ prop : equivalence ] _ fail _ if one drops the assumption that the vertices  @xmath583 are pairwise distinct . indeed , if we consider two edges  @xmath616 such that  @xmath617 , then the product  @xmath618 is _ not _ equal to the sum of _ four _ terms since @xmath619 .",
    "instead , we have only three terms and the combinatorial correspondence of configurations used in the proof of lemma  [ lemma : chi-2n - combinatorial ] breaks down .    _",
    "( ii ) _ one can easily make sense of the notation  @xmath620}$ ] , with the variables labeled by oriented edges _ or _ corners of the canonical double - cover  @xmath475}$ ] . in order to define these quantities , just rewrite all participating variables using one of the two sets  @xmath499 or  @xmath572 , and compute the arising linear combination of the terms   or  : the result does not depend on which set of variables was used . following the proof of lemma  [ lemma : chi-2n - combinatorial ]",
    ", it is easy to obtain _ combinatorial expansions _ of such quantities in the situation when all the corresponding vertices  @xmath621 are pairwise distinct and do not coincide with the vertices  @xmath622 for  @xmath623 involved in the formal correlation function under consideration .",
    "it is well - known that the formal correlation functions  @xmath624 involving any three of the four corners surrounding a given edge  @xmath68 of  @xmath2 satisfy a linear relation known as the _ propagation equation _ for discrete spinors or the dotsenko equation .",
    "the latter name was suggested in  @xcite to acknowledge the paper  @xcite where this propagation equation was discussed in the `` combinatorial '' context of the disorder insertions formalism , though it is worth mentioning that similar relations appeared earlier , e.g. in the works of perk  @xcite .",
    "below we start with a short derivation given in  @xcite and then discuss this equation from the ( equivalent ) viewpoint of the grassmann variables formalism .",
    "informally speaking , the main idea is to apply the kramers - wannier duality _ locally _ on a given edge  @xmath68 .",
    "it is convenient to introduce the following parametrization of the edge weights : @xmath625 by the definition of disorder insertions ( see section  [ sub : disorders ] ) and the equality  @xmath626 for  @xmath514 , for any combination  @xmath627 $ ] of spins and ( even number of ) disorders , we have @xmath628\\rangle ~ & = ~ q_e\\cdot\\langle x_e^{\\reps_e}\\,\\co[\\mu,\\sigma ] \\rangle \\notag \\\\ & = \\langle \\co[\\mu,\\sigma ] \\rangle - p_e\\cdot\\langle \\sigma_{u^-(e)}\\sigma_{u^+(e)}\\co[\\mu,\\sigma ] \\rangle\\,,\\end{aligned}\\ ] ] where  @xmath629 and  @xmath630 are the two faces of  @xmath2 adjacent to the oriented edge  @xmath68 , with  @xmath631 being to the right and  @xmath632 to the left of  @xmath68 .",
    "note that the set of disorders involved in the left - hand side of this equality differs from that in the right - hand side , so one should be careful with the signs of the formal correlations even though there is a trivial correspondence between the faces of these double - covers .",
    "above , the faces  @xmath633 are assumed to be adjacent on the double - cover used to define the correlation  @xmath634\\rangle$ ] .",
    "let us now replace the collection of spins and disorders  @xmath627 $ ] by  @xmath635 $ ] and recall that any repeating variables in these formal correlations cancel out . rewriting   ( note that now  @xmath627 $ ] must contain an odd number of disorders ) , one obtains @xmath636 \\rangle = p_e\\cdot \\langle \\mu_{o(e)}\\sigma_{u^-(e)}\\co[\\mu,\\sigma ] \\rangle   + q_e\\cdot\\langle\\mu_{t(e)}\\sigma_{u^+(e)}\\co[\\mu,\\sigma]\\rangle\\,,\\ ] ] with a proper correspondence between the involved double - covers .",
    "[ rem : corner - universal - double - cover ] there exists a way to make this correspondence of double - covers canonical .",
    "let  @xmath637 denote the corner graph  @xmath398 with all the intersecting edges removed .",
    "given  @xmath627 $ ] , one considers a double - cover  @xmath638}$ ] of  @xmath637 branching around _ all _ the vertices and the faces of  @xmath2 that are _ not _ involved in  @xmath627 $ ] , as well as around all the edges of  @xmath2 . on this double - cover , the formal correlations  @xmath639\\rangle$ ]",
    "defined in section  [ sub : disorders ] obey the sign - flip symmetry between the sheets and satisfy around all the edges , see  @xcite .",
    "[ rem : ad - hoc - combinatorics ] the propagation equation   can easily be derived using lemma  [ lemma : mu - sigma ] ( or its generalization provided in remark  [ rem : x - mu - sigma ] ) and playing with the natural correspondence ( given by adding / removing the edge  @xmath68 ) between the sets of subgraphs of  @xmath2 involved in the relevant combinatorial expansions .",
    "this approach is conceptually equivalent to the derivation given above , but it allows one to change the viewpoint and to use these combinatorial expansions as ( slightly mysterious ) _ ad  hoc _ _ definitions _ of the objects of interest , making use of very elementary concepts only .",
    "such a shortcut was advertised by smirnov  @xcite and is very useful when working with complex - valued fermionic observables , see section  [ sub : s - observables ] for details .",
    "we now discuss how one can see the three - point relation   using the intrinsic structure of the kac ",
    "ward matrices or , more precisely , the matrices  @xmath640}$ ] .",
    "let us introduce a matrix  @xmath641 whose entries are labeled by the corners of  @xmath2 as follows : @xmath642 & \\text{if~$v(c)=v(c')$~but~$c\\ne c'$ ; } \\\\ 0 & \\text{otherwise . }",
    "\\end{cases}\\ ] ] note that the matrix  @xmath641 is hermitian and has a block - diagonal structure with blocks corresponding to vertices of  @xmath2 .",
    "further , for a given collection of cuts  @xmath146}$ ] linking the faces  @xmath48 and , possibly ,  @xmath28 on  @xmath24 , let @xmath643}\\right)_{c , c'}=\\begin{cases } -i & \\text{if~$c = c'$ ; } \\\\ p_e\\cdot\\exp[{\\textstyle\\frac{i}{2}}\\rw(c,\\overline{c } ' ) ] & \\text{if~$c = c^+(e)$~and~$c'=c^-(e)$~for~some~$e$ ; } \\\\ q_e\\cdot(-1)^{\\varkappa\\cdot e}\\exp[{\\textstyle\\frac{i}{2}}\\rw(c,\\overline{c } ' ) ] & \\text{if~$c = c^+(e)$~and~$c'=c^-(\\overline{e})$~for~some~$e$ } ; \\\\ 0 & \\text{otherwise , } \\end{cases}\\ ] ] where the rotation angle  @xmath418 in the third line is measured along the path  @xmath644 .",
    "[ rem : spinors - functions ] the operator  @xmath645}$ ] can be viewed as the `` untwisted '' operator  @xmath646 acting on functions defined on the double - cover  @xmath647}$ ] and obeying a sign - flip symmetry between the sheets ; such functions are sometimes called  _",
    "spinors_. from this viewpoint , the above definition describes the action of  @xmath648}$ ] on a section of  @xmath647}$ ] given by the cuts  @xmath191}$ ] .",
    "[ lemma : c - three - terms ] for any collection of faces  @xmath48 of  @xmath2 , the following identity holds : @xmath649}+\\ry+i\\ri = 2\\rd^{-1}_{[u_1, .. ,u_m]}\\,.\\ ] ]    [ rem : chi - adjusted ] before giving a proof of this identity , recall that  @xmath650 and introduce the _ real - valued _ counterparts of the matrices  @xmath641 and  @xmath645}$ ] defined by @xmath651}:=i\\ru_\\rc\\rd_{[u_1, .. ,u_m]}\\ru_\\rc^*\\,.\\ ] ] then we have  @xmath652 } \\cdot [ 4{\\widehat{\\rc}}^{-1}_{[u_1, .. ,u_m ] } - { \\widehat{\\ry } } + \\ri ] = 2\\ri$ ] . in other words , for any oriented edge  @xmath68 and any corner  @xmath653 , the quantities @xmath654}-{\\widehat{\\ry}}_{c',c}+\\ri_{c',c}\\,,\\quad \\text{where}\\quad c'=c^\\pm(e)\\ \\ \\text{or}\\ \\ c'=c^-(\\overline{e})\\,,\\ ] ] satisfy a three - term linear relation with coefficients provided by the matrix  @xmath652}$ ] , and one should replace the last term  @xmath655 by @xmath656 if  @xmath657 .",
    "the local terms  @xmath658 compensate the mismatch between the grassmann variables formalism and disorder insertions in the situation  @xmath659 , see remark  [ rem : two - formalisms ] .",
    "modulo this local adjustment of the formal correlation functions , equation   is equivalent to the propagation equation   for two - disorders correlations .",
    "its extension to  @xmath107 disorders ( equivalently ,  @xmath107 grassmann variables  @xmath572 ) is then provided by the pfaffian identities and linearity .",
    "equality   is equivalent to the following claim : @xmath660}= \\rd_{[u_1, .. ,u_m]}\\cdot [ 2\\ri+{\\textstyle\\frac{1}{2}}(\\ry+i\\ri)\\rc_{[u_1, .. ,u_m]}]\\,,\\ ] ] which can be easily checked in two steps .",
    "one begins by computing the matrix @xmath661}:={\\textstyle\\frac{1}{2}}(\\ry+i\\ri)\\rc_{[u_1, .. ,u_m]}\\,,\\ ] ] whose entries are given by @xmath662}\\right)_{c , c'}=\\begin{cases } -1 & \\text{if~$c = c'$ ; } \\\\ -i\\exp[\\frac{i}{2}\\rw(c,\\overline{c } ' ) ] & \\text{if~$c = c^-(e)$~and~$c'=c^+(e)$ ; } \\\\",
    "i\\exp[\\frac{i}{2}\\rw(c,\\overline{c}')]\\cdot(-1)^{\\varkappa\\cdot e}x_e^{-1 } & \\text{if~$c = c^-(e)$~and~$c'=c^\\pm(\\overline{e})$;}\\\\ 0 & \\text{otherwise , } \\end{cases}\\ ] ] where the rotation angles  @xmath418 for  @xmath663 in the third line are measured along  @xmath664 .",
    "then , another straightforward computation leads to  .",
    "let the matrix  @xmath665}$ ] be defined by @xmath666}\\right)_{c , c'}:=\\begin{cases } \\exp[\\frac{i}{2}\\rw(c,\\overline{c } ' ) ] & \\text{if~$c = c^-(e)$~and~$c'=c^+(e)$ ; } \\\\",
    "-\\exp[\\frac{i}{2}\\rw(c,\\overline{c}')]\\cdot(-1)^{\\varkappa\\cdot e}x_e^{-1 } & \\text{if~$c = c^-(e)$~and~$c'=c^+(\\overline{e})$;}\\\\ 0 & \\text{otherwise,}\\end{cases}\\ ] ] and note that  @xmath665}\\rw_{[u_1, .. ,u_m]}^*$ ] is a _",
    "diagonal _ matrix with entries  @xmath667 for  @xmath668 .",
    "a straightforward computation shows @xmath669 } & = \\rw_{[u_1, .. ,u_m]}\\rd_{[u_1, .. ,u_m]}\\,.\\end{aligned}\\ ] ] similarly , one can easily see that @xmath670 } = \\rw_{[u_1, .. ,u_m]}^*\\rd_{[u_1, .. ,u_m]}^*\\,,\\ ] ] for instance by checking the identity @xmath671}= \\rw_{[u_1, .. ,u_m]}\\rd_{[u_1, .. ,u_m ] } - \\rw_{[u_1, .. ,u_m]}^*\\rd_{[u_1, .. ,u_m]}^*\\,.\\ ] ]    [ rk : d - bar ] _ (",
    "i ) _ since  @xmath645}$ ] can be thought of as some  @xmath672-type operator acting on the corresponding double - cover  @xmath647}$ ] , identities of this sort are useful when studying the links between the kac ",
    "ward matrices and discrete holomorphic functions , see  @xcite for the discussion of general surface graphs .    _",
    "( ii ) _ since the matrix @xmath673 is diagonal , the last representation of the quadratic form  @xmath674 provides an appropriate starting point for the interpretation of the ( scaling limit of the ) ising model defined on a general planar graph  @xmath2 from the _ `` free fermionic field '' _ perspective , cf .",
    "@xcite and  ( * ? ? ?",
    "* section 2.1.2 ) ,  ( * ? ? ?",
    "* section 9.7 ) .",
    "the aim of this section is to discuss the complex - valued versions of the formal correlation functions ( aka discrete fermionic observables ) introduced in section  [ sub : grassmann][sub : equivalence ] .",
    "those can be defined as simple linear combinations of the real - valued ones , so one should not expect a major difference between the two viewpoints .",
    "nevertheless , it turns out that the complex - valued observables are much better adapted to the analysis of _ boundary value problems _ arising when studying the scaling limit of the ising model in general planar domains . at the same time , they can be constructed _",
    "ad  hoc _ in a purely combinatorial way and all the needed local relations follow easily , cf .",
    "remark  [ rem : ad - hoc - combinatorics ] .",
    "such a _ definition _ was advertised by smirnov in the 2000s ( see  ( * ? ? ?",
    "* section  4 ) for historical remarks ) and then used in a series of recent papers of chelkak , duminil - copin , hongler , izyurov , kemppainen , kytl and others devoted to the conformal invariance of correlation functions and interfaces arising in the scaling limit of the critical ising model in bounded planar domains .    for simplicity , below",
    "we mostly discuss the `` untwisted '' situation . as usual , to handle the general case one should consider a relevant double - cover and work with spinors defined on this cover instead of functions defined on  @xmath101 or  @xmath675 , see   and remark  [ rem : corner - universal - double - cover ] .    for the midpoint  @xmath109 of an edge  @xmath26 , define @xmath676 where the additional normalizing factor  @xmath677 is added for later convenience ; note that  @xmath678 does not depend on the orientation of  @xmath68 .",
    "this allows us to speak about formal correlation functions of these new variables like  @xmath679 or  @xmath680 .",
    "in particular , for a given oriented edge  @xmath681 and  @xmath682 , theorem  [ thm : multipoint ] implies @xmath683\\ , t_e x(p)}{\\cz_{\\opname{ising}}(g , x)}\\,,\\ ] ] where  @xmath684 , the non - self - intersecting curve  @xmath685 is obtained from a configuration  @xmath686 by an arbitrary resolution of all its crossings , and  @xmath687 stands for the total rotation angle of the ( velocity vector of this ) curve  @xmath685 when it runs from  @xmath228 to  @xmath109 . among other papers ,",
    "this _ combinatorial definition _ can be found :    * in the original work of smirnov devoted to the understanding of the scaling limit of _ interfaces _ ( domain walls ) arising in the critical ising model on the square lattice , with  @xmath228 being a boundary edge , see  ( * ? ? ?",
    "* section  4 ) for references . * in the paper  @xcite devoted to the _ universality _ of these scaling limits for the critical ising models defined on arbitrary isoradial graphs ; note that the normalizing factor  @xmath688 introduced above matches the factor  @xmath689 used in  ( * ? ? ?",
    "* section  2.2 ) since we included the half - weight of the last edge  @xmath68 into  @xmath690 .",
    "* in the paper  @xcite and the phd thesis  @xcite of hongler , which is devoted to the study of the scaling limit of the  _ energy density field _ in the critical ising model in bounded planar domains ( on the square lattice ) , with  @xmath228 being an internal edge .",
    "* in the paper  @xcite and the phd thesis  @xcite of izyurov , where the _ spinor version _ of   was first suggested as a tool to study scaling limits of ( ratios of ) spin correlations and interfaces in the critical ising model considered in multiply - connected domains .",
    "* in the paper  @xcite devoted to the study of the scaling limit of the  _ spin field _ in the critical ising model in bounded planar domains ( on the square lattice ) , where the branching `` source - at - corner '' observable  @xmath691}$ ] was used , with  @xmath692 .",
    "further , with a slight abuse of notation , let us denote @xmath693 and extend definition   of the function  @xmath694 from the set of midedges  @xmath109 of the graph  @xmath2 to the set of its corners by defining , for  @xmath402 , @xmath695 these quantities admit combinatorial expansions similar to  , see lemma  [ lemma : chi-2n - combinatorial ] and remark  [ rem : two - formalisms](ii ) ; note that  @xmath694 depends on the choice of the square root  @xmath696 but is _ independent _ of all other choices .",
    "the following notion first appeared in  @xcite in the critical planar ising model context and was recently discussed in  @xcite for arbitrary surface graphs . recall that we use the parametrization  @xmath697 of the edge weights .",
    "[ def : s - hol ] a complex - valued function  @xmath698 defined on edge midpoints  @xmath109 and , simultaneously , on corners  @xmath403 of a given weighted graph  @xmath16 embedded in the complex plane satisfies a _ generalized s - holomorphicity condition _ for a pair  @xmath109 and  @xmath668 if @xmath699}\\,,\\ ] ] where , as usual ,  @xmath410 denotes the rotation angle between the decoration  @xmath403 oriented _ towards _ the vertex  @xmath700 and the oriented edge  @xmath68 , and  @xmath701}:={\\opname{re}}[f\\bar{\\nu}]\\nu=\\frac{1}{2}[f+\\nu^2\\overline{f}\\,]$ ] , and thus the choice of the sign of  @xmath87 in   is irrelevant .",
    "it is well - known that the complex - valued observables  @xmath702 introduced above , as well as the `` source - at - corner '' observables  @xmath703 and their spinor counterparts , satisfy the generalized s - holomorphicity condition for all pairs  @xmath704 except near the `` source '' edge  @xmath228 or the corner  @xmath403 , respectively .",
    "( actually , if one uses direct combinatorial definitions , with a proper treatment of the values  @xmath705 or  @xmath706 , instead of the formal correlations of grassmann variables , these local relations are satisfied even near the `` source '' edge  @xmath228 or the corner  @xmath403 , cf .  remark  [ rem : chi - adjusted ] . )",
    "a simple _ combinatorial _ proof of   in the special situation when  @xmath707 can be found in many places ( e.g. see  ( * ? ? ?",
    "* section  4 ) for the square lattice case or a non - optimal version of the same argument  ( * ? ? ?",
    "* section  2.2 ) for isoradial graphs ) , and these proofs can be trivially adapted to the general situation .",
    "let us now sketch the proof of another well - known fact saying that the s - holomorphicity condition is essentially equivalent to the propagation equation  , see  ( * ? ? ? * lemma  3.4 ) , or the _ algebraic _ identity  , cf .",
    "* section  2.1 ) and  ( * ? ? ?",
    "* theorem  4.2 ) . indeed , using   one can rewrite definition   in the following form , independent of the choices of  @xmath87 and  @xmath441 : @xmath708,\\ ] ] where each of the sums contains two terms .",
    "further , each of the four variables  @xmath709 involved into these sums produces a term  @xmath710 with a prescribed complex phase  @xmath711 .",
    "thus one can use the identity  @xmath712}=\\frac{1}{2}[1+\\nu^2\\overline{\\alpha}^2]\\cdot\\alpha r$ ] for  @xmath713 and straightforward computations to get the following form of the right - hand side of   for  @xmath714 : @xmath715.\\ ] ] therefore , the s - holomorphicity condition   for the function  @xmath716 and a corner  @xmath717 can be _ equivalently _ rewritten as @xmath718 with the coefficients  @xmath719 given by  . by definition ,  @xmath720 is a ( real ) linear combination of the two corner variables  @xmath721 , so it is easy to see that @xmath722 with some ( complex ) coefficients  @xmath723 .",
    "since  @xmath724 , equality   easily follows provided  @xmath725 .",
    "the analog of   for  @xmath657 can be checked in the same way , this time with coefficients given by the entries of the matrix  @xmath726 .",
    "[ rem : boundary - conditions ] let us assume that  @xmath463 is a degree  @xmath0 vertex and @xmath727 is the unique oriented edge of  @xmath2 satisfying  @xmath465 , cf .  remark  [ rem : degree - one - vertices ] . despite the fact that adding / removing such vertices to the graph  @xmath2 does not affect the ising model on the dual graph  @xmath24 , allowing them is sometimes useful , notably when the outer face  @xmath28 has a huge degree . in this case , it is convenient to add such a vertex  @xmath467 to each of the vertices  @xmath429 incident to  @xmath28 in order to speak about _ boundary conditions _ satisfied by complex - valued observables  @xmath694 .",
    "as the only vertex incident to  @xmath468 in the terminal graph  @xmath93 is  @xmath471 , one has @xmath728 for all  @xmath729 , since  @xmath730 unless  @xmath731 .",
    "clearly , this property holds for all versions of complex - valued fermionic observables discussed above , including the spinor ones .",
    "again , these boundary conditions become even more transparent if one just starts with the combinatorial descriptions of these observables , e.g. with formula   for  @xmath732 .",
    "we conclude this section by a brief discussion of the general strategy used in the papers  @xcite mentioned above to prove the convergence , as  @xmath733 , of various correlation functions in the critical ising model considered on refining discrete approximations  @xmath734 to a given planar domain  @xmath735 . as an example for this discussion",
    ", we use the energy density expectations   treated in  @xcite . for these expectations",
    ", we need some simple preliminaries reflecting their algebraic structure . similarly to  , let us define @xmath736 and let @xmath737 note that  @xmath738 ,  @xmath739 , and all these functions are independent of the choices of  @xmath696 and  @xmath87 .",
    "moreover , it is easy to see that @xmath740 where @xmath741 due to the definition of these formal correlation functions .",
    "therefore , in order to understand the scaling limit of the multi - point energy - density expectation  , it is enough to understand the scaling limit of the functions  @xmath742 and  @xmath743 or , equivalently , the scaling limit of the complex - valued observables  @xmath732 and  @xmath744 .",
    "the latter satisfy the s - holomorphicity condition   everywhere in  @xmath734 except near the `` source '' edge  @xmath228 or  @xmath745 and the condition   at the boundary .",
    "therefore , the question amounts to the proof of convergence of solutions to such discrete boundary value problems as  @xmath733 , including the careful analysis of their behavior near the `` source '' point and , in the more general setup , near the branching points  @xmath48 , cf .",
    "remark  [ rem : formulas - via - k^-1](ii ) .",
    "[ rem : towards - scaling - limits - single ] let us emphasize that the combinatorial formulas discussed in this paper provide just a _ starting point _ for the analysis of scaling limits of various correlation functions in discrete domains  @xmath734 .",
    "the boundary value problems for s - holomorphic functions satisfying boundary conditions   are not easy to handle and one needs _ a lot of technical work _ in order to prove the relevant convergence theorems for their solutions , even when considering the _ critical _ ising model on subgraphs of the square grid .",
    "the first breakthrough convergence results of this type were obtained by smirnov in  @xcite and more advanced methods were later developed in  @xcite .",
    "away from criticality , a similar analysis does not look completely out of reach and some important algebraic tricks ( notably , the definition of the discrete antiderivative  @xmath746 $ ] ) are available in a fairly general setup , see  @xcite .",
    "nevertheless , even the near - critical ( aka massive ) model considered _ in bounded domains _ has not been treated yet .",
    "the aim of this section is to extend the results and methods of proof of section  [ sec : planar ] to arbitrary finite weighted graphs .",
    "this requires the use of a geometrical tool known as a _",
    "spin structure_. therefore , we devote a first subsection to reviewing the main properties of spin structures on surfaces .",
    "we then use them to extend the kac ",
    "ward formula to graphs embedded in surfaces . in a last subsection",
    ", we show how to use this result for the computation of spin correlations in this more general setting .",
    "obviously , any finite graph can be embedded in a compact orientable surface .",
    "however , in order to define the associated kac ",
    "ward matrix , one needs to be able to measure rotation angles along curves . for planar closed curves ,",
    "there is one natural way to do so : one measures the rotation angle of the velocity vector of the curve with respect to any constant vector field on the plane . for curves embedded in an arbitrary surface",
    ", there is no preferred way .",
    "however , there is a standard geometrical tool for this , known as a _",
    "spin structure_. we shall not recall its formal definition ( see e.g.  @xcite ) , but only state without proof the properties that we shall need .",
    "the first of these properties is that any spin structure on a compact orientable surface  @xmath22 can be given by a vector field on  @xmath747 with isolated zeroes of even index .",
    "this already allows us to extend the definition of kac  ward matrices to this setting , as follows .",
    "given a weighted graph  @xmath748 and a spin structure  @xmath749 on  @xmath22 , let us endow  @xmath747 with a riemannian metric and fix a vector field  @xmath750 on  @xmath747 with isolated zeroes of even index in  @xmath751 representing the spin structure  @xmath749 .",
    "finally , let us mark one point inside each edge of  @xmath2 .",
    "[ def : kw2 ] the kac  ward matrix associated to the weighted graph  @xmath16 embedded in  @xmath747 and to the spin structure  @xmath749 is the  @xmath75 matrix  @xmath752 , where  @xmath77 is the identity matrix and  @xmath753 is defined by @xmath754 where  @xmath755 is the rotation angle of the velocity vector field along  @xmath68 followed by  @xmath74 with respect to the vector field  @xmath750 , from the marked point in  @xmath68 to the marked point in  @xmath74 .",
    "obviously , this matrix depends on the choice of the vector field representing  @xmath749 and of the marked points in the edges .",
    "however , its determinant will turn out only to depend on  @xmath749 and on  @xmath748 .",
    "the precise result is most conveniently stated using the terminology of homology and quadratic forms , that we now very briefly recall .",
    "( we refer the interested reader to  @xcite for further details . )",
    "consider a graph  @xmath2 embedded in a compact connected orientable surface  @xmath747 of genus  @xmath756 in such a way that  @xmath751 consists of a disjoint union of topological disks .",
    "let  @xmath757 ( resp .",
    "@xmath758 ,  @xmath759 ) denote the  @xmath760-vector space with basis the set of vertices ( resp .",
    "edges , faces ) of  @xmath761 .",
    "elements of  @xmath762 are called _  @xmath763-chains_. also , let  @xmath764 and  @xmath765 denote the _ boundary operators _ defined in the obvious way . since  @xmath766 vanishes , the space of _  @xmath0-cycles _",
    "@xmath767 contains the space  @xmath768 of _",
    "@xmath0-boundaries_. the _ first homology space _",
    "@xmath769 turns out not to depend on  @xmath2 , but only on  @xmath747 : it has dimension  @xmath770 if  @xmath747 is closed ( i.e. compact without boundary ) , and dimension  @xmath771 if  @xmath747 has  @xmath772 boundary components .",
    "note that the intersection of curves defines a bilinear form on  @xmath773 which is non - degenerate if  @xmath747 is closed ; it will be denoted by  @xmath774 as usual .",
    "finally , recall that the space  @xmath775 can be understood as the set of ( gauge equivalence classes of )  @xmath760-valued _ flat connections _ ; these are maps  @xmath776 such that  @xmath777 for each  oriented edge  @xmath68 and  @xmath778 for each face  @xmath779 of  @xmath761 .",
    "this leads us to the statement of the second property of spin structures : the set  @xmath780 of spin structures on an oriented compact surface  @xmath747 is an affine space over  @xmath781 . in other words , there is an action  @xmath782 of  @xmath781 on  @xmath780 such that for any fixed  @xmath749 , the assignment  @xmath783 defines a bijection from  @xmath781 onto  @xmath780 .",
    "this action is easy to understand at the level of vector fields , and therefore at the level of kac  ward matrices : it is simply given by  @xmath784 .",
    "[ ex : domain ] as a first example , consider the case where  @xmath747 is an  @xmath270-punctured disk in the plane .",
    "a natural spin structure is given by any constant vector field , and the corresponding kac ",
    "ward matrix is nothing but the classical one ( see section  [ sub : intro - kw - and - terminal ] ) . on the other hand ,",
    "this surface has genus zero and  @xmath785 boundary components , so it admits  @xmath786 different spin structures . they can be obtained from the first one as follows : draw a path ( transverse to the graph ) from each of the punctures to the boundary of the disk , fix a subset of the punctures , and set  @xmath787 whenever  @xmath68 crosses the path corresponding to one of the chosen punctures ( and set @xmath788 else )",
    "there are  @xmath58 choices of subsets of the punctures , which correspond to the  @xmath786 different spin structures , and to the  @xmath58 different kac ",
    "ward matrices  @xmath789 .",
    "note that , if the punctures are located at faces  @xmath48 of a planar graph  @xmath2 , then we have @xmath790}\\cdot \\kw_{[u_1,\\dots , u_m]}\\,,\\ ] ] where  @xmath374}$ ] are the matrices that appeared in proposition  [ prop : spin1 ] ( see section  [ sub : intro - spin - correlations ] ) .",
    "[ ex : torus ] another easy example is given by the torus  @xmath791 . here",
    "again , it is possible to consider a constant vector field as a  reference \" spin structure .",
    "since  @xmath792 has dimension  @xmath122 , there are  @xmath793 distinct spin structures on  @xmath794 .",
    "they can be obtained from the first one as follows : draw two closed curves ( transverse to  @xmath2 ) representing a basis of the homology , fix a subset of this basis , and set  @xmath787 whenever  @xmath68 crosses one of the chosen curves ( and set @xmath788 else ) .",
    "there are  @xmath793 choices of subsets of this basis , they correspond to the  @xmath793 different spin structures , and to the  @xmath793 different kac  ward matrices .",
    "let us now turn to quadratic forms .",
    "let  @xmath795 be a finite - dimensional  @xmath760-vector space endowed with an _ alternating _",
    "( i.e. , such that  @xmath796 for all  @xmath797 ) bilinear form  @xmath774 .",
    "a _ quadratic form _ on  @xmath798 is a map  @xmath799 such that @xmath800 note that there are exactly  @xmath801 quadratic forms on  @xmath798 ; more precisely , the set of such forms is an affine space over  @xmath802 .",
    "this easily implies the equality @xmath803 where the sum is over all quadratic forms on  @xmath798 .",
    "furthermore , if the alternating bilinear form  @xmath804 is non - degenerate , arf showed  @xcite that the corresponding quadratic forms are classified by the invariant @xmath805 defined by @xmath806 which is now called the _ arf invariant _ ( note that in this case the space  @xmath795 is necessarily even - dimensional ) .",
    "we shall need a single property of this invariant ( see e.g.  ( * ? ? ?",
    "* lemma 2.10 ) for a proof ) , namely that it satisfies the equality @xmath807 for any  @xmath797 , where the sum is over all quadratic forms on  @xmath798 .",
    "the relationship between spin structures and quadratic forms on  @xmath773 is given by the following classical result of johnson  @xcite .",
    "consider a spin structure  @xmath749 on  @xmath747 represented by a vector field  @xmath750 on  @xmath747 with zeroes of even index . given",
    "a piecewise smooth closed curve  @xmath124 in  @xmath747 avoiding the zeroes of  @xmath750 , let  @xmath808 denote the rotation angle of the velocity vector of  @xmath124 with respect to  @xmath750 .",
    "then , given a homology class  @xmath809 represented by a disjoint union of oriented simple closed curves  @xmath285 , the equality  @xmath810 gives a well - defined quadratic form on  @xmath811 , where @xmath812 denotes the intersection form .",
    "this implies in particular that , for any oriented closed curve  @xmath124 with  @xmath264 transverse self - intersection points , @xmath813 indeed , this can be checked by smoothing out the intersection points of  @xmath124 as in the proof of lemma  [ lemma : whitney ]  which is nothing but the  @xmath814 case of this equation .",
    "johnson s theorem asserts that the mapping  @xmath815 defines an  @xmath781-equivariant bijection between the set  @xmath780 of spin structures on  @xmath747 and the set of quadratic forms on  @xmath816 .",
    "equation   translates into the equality @xmath817 johnson s theorem also allows us to define the _ arf invariant _ of a spin structure  @xmath749 as the arf invariant of the associated quadratic form  @xmath818 . in the case of a closed surface of genus  @xmath756 ,",
    "equation   then implies the equality @xmath819 for any  @xmath809 .",
    "we are finally ready to state and prove the main result of this section .",
    "note that the case of genus zero gives back the kac ",
    "ward formula ( in an extended form actually , since we now allow edges that are not line segments ) .",
    "[ thm : kw2 ] let  @xmath16 be a finite weighted graph embedded in an orientable compact surface  @xmath747 .",
    "for any spin structure  @xmath820 , we have the equality @xmath821 ) } x(p)\\big)^2,\\ ] ] where  @xmath822\\in h_1({\\sigma};{\\mathbb z}_2)$ ] denotes the homology class of  @xmath114 .",
    "first note that the set  @xmath823 endowed with the symmetric difference can be identified with the  @xmath760-vector space of  @xmath0-cycles in  @xmath2 .",
    "therefore , for any fixed spin structure  @xmath749 on  @xmath747 , the associated twisted partition function can be written as @xmath824 ) } x(p)=\\sum_{\\alpha\\in h_1({\\sigma};{\\mathbb z}_2)}(-1)^{q_\\lambda(\\alpha)}\\sum_{p:[p]=\\alpha}x(p)\\,,\\ ] ] where  @xmath822\\in h_1({\\sigma};{\\mathbb",
    "z}_2)$ ] denotes the homology class of the  @xmath0-cycle  @xmath114 .",
    "the ( weighted ) terminal graph  @xmath230 can be defined exactly as in the planar case , and the same arguments lead to the equality @xmath825)+\\rt(d)}\\,x^\\rk(d)\\,.\\ ] ] as in the planar case , let us consider the hermitian matrix  @xmath826 . for each oriented edge",
    "@xmath68 of  @xmath2 , fix a square root  @xmath87 of the direction of the velocity vector of  @xmath68 at the marked point inside  @xmath68 , measured with respect to the vector field representing the spin structure  @xmath749 .",
    "this allows us to define the real skew - symmetric matrix  @xmath827 , where  @xmath88 is the diagonal matrix with coefficients  @xmath828 . comparing the equation displayed above with the pfaffian @xmath829}=\\sum_{d\\in\\d(g^\\rk)}\\veps_\\lambda(d)x^\\rk(d)\\,,\\ ] ]",
    "we are left with the proof of the equality @xmath830)+\\rt(d)}\\ ] ] for any  @xmath831 , where  @xmath286 is the dimer configuration given by the set of long edges of the terminal graph  @xmath93 . to check this fact",
    ", one can use the exact same arguments as in the planar case replacing lemma  [ lemma : whitney ] with its extension , equation  .",
    "this leads to @xmath832 where  @xmath833 .",
    "since  @xmath818 is a quadratic form , we get @xmath834)+\\sum_{1\\le j < k\\le \\ell } c_j\\cdot c_k + \\sum_{j=1}^\\ell\\rt(c_j ) \\\\ & = q_\\lambda([d\\delta d_0])+\\rt(d\\delta d_0)\\,.\\end{aligned}\\ ] ] the theorem now follows from the equality  @xmath835=[g\\setminus d_g]$ ] in  @xmath773 , together with the fact that  @xmath836 and  @xmath239 coincide .    the kac ",
    "ward formula for graphs embedded in surfaces , first derived in  @xcite , is now an easy corollary .",
    "[ cor : kw2 ] let  @xmath16 be a finite weighted graph embedded in an orientable closed surface  @xmath747 of genus  @xmath756 .",
    "then , the partition function   of the ising model on  @xmath2 is equal to @xmath837 where  @xmath838 is the arf invariant of the spin structure  @xmath749 , and  @xmath839 denotes the square root with constant coefficient equal to  @xmath30 .    by theorem  [ thm : kw2 ] and the choice of the square root",
    ", we have @xmath840 ) } x(p)~=\\!\\!\\!\\sum_{\\alpha\\in h_1({\\sigma};{\\mathbb z}_2)}(-1)^{q_\\lambda(\\alpha)}\\sum_{p:[p]=\\alpha}x(p)\\,.\\ ] ] the claim now follows from equation  : @xmath841=\\alpha}x(p ) \\\\ & = \\sum_{\\alpha\\in h_1({\\sigma};{\\mathbb z}_2)}\\biggl[\\big(\\,\\frac{1}{2^g}\\!\\!\\sum_{\\lambda\\in{\\mathcal{\\euscript s}}({\\sigma})}(-1)^{{\\opname{arf}}(\\lambda)+q_\\lambda(\\alpha)}\\big)\\sum_{p:[p]=\\alpha}x(p)\\biggr]\\\\ & = ~\\frac{1}{2^g}\\sum_{\\lambda\\in { \\mathcal{\\euscript s}}({\\sigma})}\\,\\biggl[(-1)^{{\\opname{arf}}(\\lambda)}\\!\\!\\!\\sum_{\\alpha\\in h_1({\\sigma};{\\mathbb z}_2)}(-1)^{q_\\lambda(\\alpha)}\\sum_{p:[p]=\\alpha}x(p)\\biggr]\\\\ & = ~\\frac{1}{2^g}\\sum_{\\lambda\\in { \\mathcal{\\euscript s}}({\\sigma})}(-1)^{{\\opname{arf}}(\\lambda)}(\\det\\kw_\\lambda(g , x))^{1/2}\\,.\\qedhere\\end{aligned}\\ ] ]      similarly to sections  [ sub : intro - spin - correlations ] and  [ sub : spin ] , below we prefer to work with the ising model defined on the _ dual _ graph  @xmath24 . recall that the partition function of this model is given by  , with the sum taken over the set @xmath842=0\\}$ ] of possible _",
    "domain walls _ configurations and not over the whole set  @xmath19 as in corollary  [ cor : kw2 ] . also , recall that in case  @xmath747 has a boundary , we impose  ` @xmath29 ' boundary conditions on _ all _ of its components , and that the ` free ' boundary conditions on ( some of ) these components can be obtained just by setting the corresponding interaction parameters  @xmath47 $ ] to  @xmath0 .    [ cor : low ] let  @xmath2 be a finite graph embedded in an orientable compact surface  @xmath747 , possibly with boundary . then , the partition function   of the ising model on the dual graph  @xmath24 is equal to @xmath843 where  @xmath844 denotes the square root with constant coefficient equal to  @xmath30 .    using equations   and  ,",
    "one easily gets @xmath845=\\alpha}x(p)\\biggr]\\\\ & = \\frac{1}{|{\\mathcal{\\euscript s}}({\\sigma})|}\\sum_{\\lambda\\in { \\mathcal{\\euscript s}}({\\sigma})}\\biggl[\\,\\sum_{\\alpha\\in h_1({\\sigma};{\\mathbb z}_2)}(-1)^{q_\\lambda(\\alpha)}\\sum_{p:[p]=\\alpha}x(p)\\biggr]\\\\ & = \\frac{1}{|{\\mathcal{\\euscript s}}({\\sigma})|}\\sum_{\\lambda\\in { \\mathcal{\\euscript s}}({\\sigma})}(\\det\\mathcal{k}\\mathcal{w}_\\lambda(g , x))^{1/2}\\,.\\qedhere\\end{aligned}\\ ] ]    let  @xmath747 be an  @xmath270-punctured disk in the plane with the punctures located at faces  @xmath48 of a planar graph  @xmath2 , as in example  [ ex : domain ] .",
    "recall that spin structures  @xmath846 are in natural @xmath0to@xmath0 correspondence with subsets  @xmath847 of the set @xmath848 , and the corresponding kac ",
    "ward matrices  @xmath849 are related to the matrices  @xmath850}$ ] from proposition  [ prop : spin1 ] by  ( [ eqn : kwl = kwu ] ) .",
    "therefore , corollary  [ cor : low ] gives @xmath851~ = ~ \\mathbb{e}_{g^*}^+[\\,2^{-m}(1+\\sigma_{u_1})\\dots ( 1+\\sigma_{u_m})\\,]\\,.\\end{aligned}\\ ] ] note that this is consistent with the definition of  @xmath852 , which is the partition function of the ising model on  @xmath24 with  ` @xmath29 ' boundary conditions at all the faces @xmath48 and  @xmath28 .",
    "let us now show how proposition  [ prop : spin1 ] extends to the case of a finite graph  @xmath2 embedded in an orientable compact surface - with - boundary  @xmath22 .",
    "fix  @xmath270 faces  @xmath48 of  @xmath853 and some collection of edge - disjoint paths  @xmath146}$ ] in  @xmath24 linking these faces to the boundary of  @xmath22 or to each other . as in the planar case",
    ", this induces a diagonal matrix  @xmath854}$ ] and , for any spin structure  @xmath855 , a modified kac ",
    "ward matrix @xmath856}=\\mathrm{i}_{[u_1,\\dots , u_m]}-\\mathrm{t}_\\lambda\\,.\\ ] ] note that  @xmath857}$ ] can be interpreted as the kac ",
    "ward matrix associated to a spin structure on the punctured surface  @xmath858 .",
    "however , this spin structure is not canonically associated to  @xmath749 and @xmath48 , as it depends on the choice of the ( homology class of the ) paths  @xmath153 .",
    "more precisely , a straightforward extension of the proof of theorem  [ thm : kw2 ] leads to the equality @xmath859}=\\big(\\sum_{p\\in\\mathcal{e}(g)}(-1)^{q_\\lambda([p])}(-1)^{\\varkappa\\cdot p}x(p)\\big)^2\\,,\\ ] ] which implies the following result .",
    "[ prop : spin2 ] let  @xmath2 be a finite graph embedded in an orientable compact surface - with - boundary  @xmath22 .",
    "the correlation of spins at faces  @xmath48 with  ` @xmath29 ' boundary conditions on all the boundary components of  @xmath22 is given by @xmath860=\\frac{\\sum_{\\lambda\\in { \\mathcal{\\euscript s}}({\\sigma } ) } ( \\det\\kw_{\\lambda+[u_1,\\dots , u_m]}(g , x))^{1/2}}{\\sum_{\\lambda\\in { \\mathcal{\\euscript s}}({\\sigma})}(\\det\\kw_\\lambda(g , x))^{1/2}},\\ ] ] where  @xmath50 stands for  @xmath861 .",
    "the bijection between spin configurations on  @xmath24 and domain walls in  @xmath2 gives @xmath860 ~=~ \\left[{\\cz_{\\opname{low},{\\sigma}}(g , x)}\\right]^{-1}\\cdot{\\sum_{p:[p]=0}(-1)^{\\varkappa\\cdot p}x(p)}\\,.\\ ] ] by equation  , we get @xmath862=0}(-1)^{\\varkappa\\cdot p}x(p)~ & = \\sum_{p\\in\\mathcal{e}(g)}\\biggl[\\big(\\frac{1}{|{\\mathcal{\\euscript s}}({\\sigma})|}\\sum_{\\lambda\\in { \\mathcal{\\euscript s}}({\\sigma})}(-1)^{q_\\lambda([p])}\\big)(-1)^{\\varkappa\\cdot p}x(p)\\biggr ] \\\\ & = \\frac{1}{|{\\mathcal{\\euscript s}}({\\sigma})|}\\sum_{\\lambda\\in { \\mathcal{\\euscript s}}({\\sigma})}\\biggl[\\,\\sum_{p\\in\\mathcal{e}(g)}(-1)^{q_{\\lambda}([p])}(-1)^{\\varkappa\\cdot p}x(p)\\biggr]\\,.\\end{aligned}\\ ] ] the result now follows from equation   and corollary  [ cor : low ] .    let us conclude this section by mentioning that remark  [ rem : formulas - via - k^-1 ] readily extends to the surface case , as well as theorem  [ thm : multipoint ] .",
    "more precisely , the latter result takes the following form : for any spin structure  @xmath749 , the pfaffian of a submatrix of the corresponding matrix  @xmath863 admits a combinatorial expansion similar to theorem  [ thm : multipoint ] , provided definition   of the sign  @xmath139 of a configuration  @xmath864 smoothed into  @xmath865 takes the additional factor  @xmath866 . also , one can easily extend to the surface case the dimer techniques discussed in section  [ sub : planar - dimers ] and the formalism of grassmann variables discussed in section  [ sub : grassmann ] . on the other hand",
    ", one should be more careful when using the disorder insertions discussed in section  [ sub : disorders ] for graphs embedded in surfaces , and , especially , when matching the two formalisms in the style of section  [ sub : equivalence ] .",
    "the subtle point is that the formal correlation functions  @xmath867}$ ] now _ depend _ on the homology class  @xmath868 $ ] of the paths  @xmath511}$ ] chosen to define the set of configurations  @xmath869}(v_1,\\dots , v_{2n}):=\\{p : p\\btu \\varkappa\\in\\ce_0(g)\\}$ ] , and one should sum over  @xmath868 $ ] to recover the spin - disorder duality .",
    "further , an appropriate analog of lemma  [ lemma : mu - sigma ] for the fixed homology class  @xmath868 $ ] involves a summation over  @xmath780 similar to that in the right - hand side of the equations of corollary  [ cor : low ] and proposition  [ prop : spin2 ] , and one should keep track of additional signs ( coming from the non - canonical identifications of the double - covers  @xmath870}$ ] ) when summing over  @xmath868 $ ] .",
    "these technicalities become even more involved when dealing with general formal correlations considered in proposition  [ prop : equivalence ] though , in principle , all the details can be fixed .",
    "in this section , we assume the weighted graph @xmath16 to be embedded in the plane and consider the double - ising model defined on the faces of the modified graph  @xmath197 , see section  [ sub : intro - dbli ] for the definitions and notation . recall that the partition function of this model is given by @xmath871 where  @xmath202 is the set of boundary edges of  @xmath2 , and the modified kac ",
    "ward matrix  @xmath204 is defined as @xmath872 below we describe how the combinatorial methods developed for the study of the ( single- ) ising model on faces of  @xmath2 may be extended and used to study the double - ising model .",
    "we give the proof of theorem  [ thm : kw3 ] and proposition  [ prop : spin4 ] in section  [ sub : dbli - partition - fct ] . in section  [ sub : dbli - dobrushin ] , we prove an analog of theorem  [ thm : kw3 ] for dobrushin boundary conditions  .",
    "the last section  [ sub : dbli - s - hol - fct ] is devoted to a discussion of s - holomorphic observables arising in the double - ising model context and discrete boundary value problems for them .",
    "the aim of this section is to give a proof of theorem  [ thm : kw3 ] and proposition  [ prop : spin4 ] .",
    "let us begin by recalling that the kac ",
    "ward formula   and theorem  [ thm : kw1 ] for the single ising model can be rewritten as @xmath873})^2= ~\\det{\\widehat{\\rk } } ~ = ~ ( -1)^{|e(g)|}\\det\\rk\\,,\\ ] ] where the hermitian matrix  @xmath92 is given by  .",
    "the proof of this theorem discussed in section  [ sec : planar ] uses the combinatorial expansion of the _ pfaffian _ of the anti - symmetric matrix  @xmath91 .",
    "alternatively , one could expand the _ determinant _ of  @xmath92 for this purpose .",
    "the resulting proof of theorem  [ thm : kw1 ] is slightly more cumbersome as we need to compare sums over more complicated configurations ( double - dimers on the terminal graph , instead of single dimers ) .",
    "however , this approach does have an advantage : it generalizes to a proof of theorem  [ thm : kw3 ] . having this goal in mind , we start with a direct combinatorial expansion of the determinant of  @xmath92 .    squaring the right - hand side of the identity @xmath874 provided by lemma  [ lemma : terminal ] leads to a sum over pairs of dimer configurations on the terminal graph  @xmath93 .",
    "any such pair defines a union  @xmath124 of vertex - disjoint unoriented loops of even length covering all the vertices of  @xmath93 , some of length two , called _",
    "double - edges _ , and some of greater length , called _",
    "cycles_. we shall write  @xmath875 for the set of such configurations of edges of  @xmath93 . given a configuration @xmath876 , let  @xmath757 be the collection of its double - edges ,  @xmath877 denote the ( unoriented ) cycles , and let @xmath878 for each of these  @xmath879 cycles there are two ways to split it into two sets of dimers , and therefore @xmath880 note that we slightly abuse the notation using the intersection number  @xmath881 in the sum as this number depends on the particular way how  @xmath124 is split into  @xmath238 and  @xmath882 .",
    "nevertheless , we shall see below that the parity of this intersection number depends on  @xmath124 only .",
    "on the other hand , expanding the determinant of  @xmath92 leads to @xmath883 where  @xmath884 is the set of all vertex - disjoint unions  @xmath885 of double - edges and _ oriented _ cycles of _ arbitrary _ length covering all the vertices of  @xmath93 , the weight  @xmath886 does not depend on the orientation of these cycles and @xmath887 is some sign , that we now determine .    _ claim a. _ let  @xmath888 denote the cycle  @xmath889 with the orientation reversed",
    ". if the length  @xmath890 of this cycle is odd , then  @xmath891 . if  @xmath890 is even , then @xmath892 where  @xmath893 is the number of vertices of  @xmath93 visited by  @xmath889 in such a way that both adjacent edges are short and this oriented cycle makes a clockwise turn at this vertex .    before giving a proof of claim  a , note that it has the following consequence : the expansion   for the determinant of  @xmath92 simplifies to a sum over elements of  @xmath875 . after that , the only fact remaining to be proved in order to obtain   is the equality of the signs in the two expansions   and  , which is done in the claim  b below .",
    "_ proof of claim  a. _ by definition of the matrix  @xmath92 , and expanding its determinant as in  , we have @xmath894 where  @xmath895 denotes the number of short edges in  @xmath285 and  @xmath896 is the product of the coefficients  @xmath292 $ ] along the oriented cycle  @xmath889 .",
    "computing the total rotation angle of ( the velocity vector of ) this cycle leads to @xmath897 = \\omega(\\overrightarrow{c_j})\\cdot i^{v_+(\\overrightarrow{c_j})}(-i)^{v_-(\\overrightarrow{c_j})}\\,,\\ ] ] with  @xmath898 defined as  @xmath893 but counting counterclockwise turns instead of clockwise ones , see fig .",
    "[ fig : v+- ] .",
    "therefore , lemma  [ lemma : whitney ] and the equality  @xmath899 imply @xmath900 the claim follows easily since the two numbers  @xmath893 and  @xmath901 have the opposite parity if  @xmath890 is odd and the same parity if  @xmath890 is even .",
    "_ proof of claim b. _ let us denote by  @xmath908 the collection of disjoint , arbitrarily oriented , loops  @xmath907 pushed slightly to their left , so that they intersect the edges of  @xmath93 transversally .",
    "further , if  @xmath286 denotes the set of all long edges of  @xmath93 , then @xmath283 is also a collection of loops , which gives @xmath909 now observe that the number of intersections of  @xmath908 with short edges of  @xmath238 has the same parity as  @xmath881 , see fig .  [",
    "fig : dd ] . at the same time , the number of intersections of  @xmath908 with ( long ) edges of  @xmath910 is exactly  @xmath905 , since such intersections happen only in vicinities of the vertices , where both adjacent edges of @xmath907 are short and it makes a clockwise turn so that  @xmath908 is pushed `` towards '' the long dimer from  @xmath910 .",
    "thus the claim follows .",
    "we now move on to the proof of theorem  [ thm : kw3 ] .",
    "let  @xmath911 denote the set of _ inward _ oriented boundary edges . recall that we denote by  @xmath108 the weighted graph obtained from  @xmath16 by adding a vertex  @xmath109 in the middle of each edge  @xmath68 of  @xmath2 , and by assigning the weight  @xmath912 to both resulting edges of  @xmath111 .",
    "for a subset  @xmath913 , we denote by  @xmath914 the set of subgraphs  @xmath114 of  @xmath111 that contain the edges  @xmath116 , and such that each vertex of  @xmath111 different from  @xmath118 has an even degree in  @xmath114 , see section  [ sub : intro - pfaffian ] .",
    "note that  @xmath915 is empty if  @xmath916 is odd and   can be written as @xmath917 ^ 2\\ ] ] since , by definition , each boundary edge  @xmath918 contributes only  @xmath912 to the weight  @xmath690 .    for a subset of boundary edges  @xmath919 ,",
    "let  @xmath920 denote the matrix  @xmath92 with all the rows and the columns that are indexed by  @xmath128 removed .",
    "it immediately follows from definition   of the matrix  @xmath204 that @xmath921 thus we need to show that this expansion coincides with  . note that the case  @xmath308 was already treated in the second proof of theorem  [ thm : kw1 ] given above , which we now generalize .",
    "as in the proof of theorem  [ thm : multipoint ] , let  @xmath298 be the graph obtained by removing from  @xmath93 all the boundary ( univalent ) vertices corresponding to  @xmath128 .",
    "a straightforward generalization of lemma  [ lemma : terminal ] gives @xmath922 ^ 2 ~ & = ~\\biggl[\\,\\sum_{d\\in \\cd(g^\\rk_\\re)}(-1)^{\\rt(d)}x^\\rk(d)\\biggr]^2 \\\\ & = \\sum_{c = d\\cup d'\\in\\gamma_{\\opname{even}}(g^\\rk_\\re)}(-1)^{\\rt(c)+d\\cdot d'}2^{\\ell(c)}x^\\rk(c)\\,,\\end{aligned}\\ ] ] where we use the same notation as in the second proof of theorem  [ thm : kw1 ] .",
    "on the other hand , similarly to   we have @xmath923 with the signs  @xmath924 given by  . using this expansion and claim  a , it is easy to see that  @xmath925 vanishes unless  @xmath916 is even : when  @xmath916 is odd , each configuration  @xmath926 contains an odd length cycle , whose two orientations yield a cancellation .",
    "theorem  [ thm : kw3 ] now follows from the equality  @xmath927 and a proper generalization of claim  b from the second proof of theorem  [ thm : kw1 ] , which we formulate below for completeness .",
    "_ proof of claim b. _ the proof repeats the proof of claim  b given above .",
    "the only difference is that  @xmath283 is _ not _ a collection of closed loops anymore : if the set  @xmath128 is non - empty ,  @xmath283 also contains @xmath930 paths linking the boundary edges  @xmath918 .",
    "nevertheless , the equality @xmath931 remains correct and the claim follows due to the same arguments .    it is worth noting that one can use theorem  [ thm : multipoint ] in the proof given above to handle the case  @xmath916 even .",
    "indeed , if  @xmath128 is a collection of _ boundary _ edges , then it is not hard to check that the sign  @xmath139 defined by   is independent of  @xmath932 , so the equality @xmath933 ^ 2= ~ ( \\,{\\opname{pf}[\\,{\\widehat{\\rk}}^\\re\\,]}\\,)^2~=~\\det { \\widehat{\\rk}}^\\re ~=~ ( -1)^{|v(g^\\rk_\\re)|/2}\\det \\rk^\\re\\ ] ] follows easily",
    ". nevertheless , one still needs some additional arguments in the spirit of claim  a to see that  @xmath925 vanishes if  @xmath916 is odd .",
    "it easily follows from the domain walls representation   that @xmath214 = \\frac{\\sum\\nolimits_{p , p'\\in\\ce(\\widetilde{g})\\,:\\ , ( p\\btu p')\\cap e_\\partial(g)=\\emptyset}\\;(-1)^{\\varkappa\\cdot p}\\!x(p)\\,(-1)^{\\varkappa\\cdot p'}\\!x(p')}{\\cz_{\\opname{dbl - i}}(g , x)}\\,.\\ ] ] similarly to proposition  [ prop : spin1 ] , repeating the proof of theorem  [ thm : kw3 ] with additional signs  @xmath934 one concludes that the numerator is equal to  @xmath935}$ ] .      in this section , we prove a version of theorem  [ thm : kw3 ] for the double - ising model with dobrushin boundary conditions  . for this purpose ,",
    "let us introduce a matrix @xmath936}= \\big[\\,\\widetilde{\\rk}^{[a , b]}_{e , e'}\\,\\big]_{e\\ne a , e'\\ne b}\\ ] ] ( for definiteness with signs of determinants , below we always assume that the column of  @xmath937}$ ] labeled by  @xmath228 corresponds to the row labeled by  @xmath229 ) with the entries @xmath938}_{e , e'}:=\\rk_{e , e'}+ \\begin{cases}ix_e & \\text{if~$e'=e$ is an inward oriented boundary edge on~$(ab)$ ; } \\\\ -ix_e & \\text{if~$e'=e$ is an inward oriented boundary edge on~$(ba)$ ; } \\\\ 0 & \\text{otherwise . }",
    "\\end{cases}\\ ] ]    [ thm : kw4 ] the partition function  @xmath939}(g , x)$ ] of the double - ising model with dobrushin boundary conditions   is given by @xmath940}(g , x)~=~ \\overline{\\rw_{b,\\overline{a}}}\\,\\cdot(-1)^{|e(g)|-1}\\det\\widetilde{\\rk}^{[a , b]},\\ ] ] where the prefactor  @xmath941 is defined as follows : @xmath942 $ ] for any non - self - intersecting path  @xmath943 running from  @xmath229 to  @xmath745 along edges of  @xmath2 ( note that the total rotation angle  @xmath944 does not depend on the choice of this path ) .",
    "the proof goes along the same lines as the proof of theorem  [ thm : kw3 ] .",
    "using domain walls representations of spin configurations  @xmath198 satisfying  , one easily obtains @xmath945}(g , x)~&=~\\sum\\nolimits_{\\re\\subset \\ee_\\partial(g)\\setminus\\{a , b\\ } } \\biggl[\\,x(\\re)\\sum\\nolimits_{p\\in \\cc(\\re ) } x(p)\\sum\\nolimits_{p'\\in \\cc(\\{a , b\\}\\cup\\re ) } x(p')\\biggr ] \\\\ & + ~\\sum\\nolimits_{\\re\\subset \\ee_\\partial(g)\\setminus\\{a , b\\}}\\biggl[\\,x(\\re)\\sum\\nolimits_{p\\in",
    "\\cc(\\{a\\}\\cup\\re ) } x(p)\\sum\\nolimits_{p'\\in \\cc(\\{b\\}\\cup\\re ) } x(p')\\biggr]\\,,\\end{aligned}\\ ] ] where even subsets  @xmath128 contribute only to the first sum while odd ones only to the second . passing from  @xmath946 to dimer configurations  @xmath947 on the graphs  @xmath298 ,  @xmath948 or  @xmath949 ,  @xmath950 and considering their union exactly as in the proof of theorem  [ thm : kw3 ] ,",
    "one gets @xmath951}(g , x)~=~\\sum\\nolimits_{\\re\\subset \\ee_\\partial(g)\\setminus\\{a , b\\ } } \\sum\\nolimits_{c = d\\cup d'\\in\\gamma^{[a , b]}_{\\opname{even}}(g^\\rk_\\re)}(-1)^{\\rt(c)+d\\cdot d'}2^{\\ell(c)}x^\\rk(c),\\ ] ] where  @xmath952}_{\\opname{even}}(g^\\rk_\\re)$ ] denotes the set of all covers of the graph  @xmath300 by a vertex - disjoint union of a collection of double - edges  @xmath757 , even length cycles  @xmath877 and a _ path  @xmath556 _ linking  @xmath228 and  @xmath229 .    at the same time",
    ", the following expansion holds : @xmath953 } = \\sum\\nolimits_{\\re\\subset \\ee_\\partial(g)\\setminus\\{a , b\\ } } i^{|\\re\\cap ( ab)|}(-i)^{|\\re\\cap ( ba)|}x(\\re ) \\det\\rk^{[\\{a\\}\\cup\\re,\\{b\\}\\cup\\re]},\\ ] ] where  @xmath954}$ ] denotes the matrix  @xmath92 with all the rows indexed by  @xmath955 and the columns indexed by  @xmath956 removed .",
    "a straightforward expansion of the determinant of this matrix similar to   and  , together with claim  a from the second proof of theorem  [ thm : kw1 ] , leads to @xmath957 } ~= ~\\sum\\nolimits_{c\\in\\gamma^{[a , b]}_{\\opname{even}}(g^\\rk_\\re ) } \\tau(c)2^{\\ell(c)}x^\\rk(c)\\,,\\ ] ] where @xmath958\\cdot\\tau(\\gamma)\\ ] ] ( recall that the parity of the number  @xmath959 does not depend on the orientation of a cycle  @xmath285 provided it has an even length ) and  @xmath960 is the additional contribution of the path  @xmath556 , which we now determine . similarly to the proof of claim  a , we have @xmath961 where  @xmath962 denotes the number of edges in the path  @xmath556 and  @xmath963 is the product of the coefficients  @xmath292 $ ] along this path , when explored _ from  @xmath229 to  @xmath228_. comparing  @xmath963 with the total rotation angle of  @xmath556 leads to @xmath964 = \\omega(\\gamma)i^{v_+(\\gamma)}(-i)^{v_-(\\gamma)}\\,.\\ ] ] using lemma  [ lemma : whitney ] , it is easy to conclude that  @xmath965=\\rw_{b,\\overline{a}}(-1)^{\\rt(\\gamma)}$ ]",
    ". putting these two equalities together , we arrive at @xmath966 where we also used the equality  @xmath967 to pass to the second line . noting that @xmath968 one can rewrite expansion   as @xmath969}~ = ~ i^{|\\re|}\\sum\\nolimits_{c\\in\\gamma^{[a , b]}_{\\opname{even}}(g^\\rk_\\re ) } ( -1)^{\\rt(c)+v_-(c)}2^{\\ell(c)}x^\\rk(c)\\,,\\ ] ] and theorem  [ thm : kw4 ]",
    "is now reduced to the following analog of claim  @xmath970 and claim  @xmath971 .",
    "_ claim b  .",
    "_ for any @xmath972 and  @xmath973 or @xmath974 and  @xmath975 , depending on the parity of  @xmath916 , one has @xmath976 provided the path  @xmath556 linking  @xmath228 and  @xmath229 in  @xmath907 is oriented from  @xmath229 to  @xmath228 .",
    "_ proof of claim  b  .",
    "_ similarly to the proofs of claim  b and claim  b , the result follows from the equality @xmath977 where  @xmath908 is a collection of loops and a path  @xmath978 running from  @xmath229 to  @xmath228 pushed slightly closer to the arc  @xmath226 , while  @xmath979 is a collection of loops and paths linking the boundary edges  @xmath128 , possibly together with  @xmath228 .",
    "the number of intersections of  @xmath978 with the latter paths has the same parity as  @xmath980 due to topological reasons .",
    "the aim of this section is to discuss s - holomorphic functions appearing in the double - ising model context , see section  [ sub : s - observables ] for the terminology .",
    "these functions have some potential for the study of the ( critical ) double - ising model in bounded planar domains though one needs to develop new tools in order to handle the arising boundary conditions and at the moment it is not clear if one can obtain meaningful convergence results using this approach , see remark  [ rem : dbli - boundary - conditions ] and remark  [ rem : dbli - martingale - strategy - oops ] below .",
    "recall that , given a `` source '' edge  @xmath981 , the basic s - holomorphic observable in the _",
    "single_-ising model can be defined as @xmath982 where  @xmath983 is a _ real _ ( anti - symmetric ) matrix ,  @xmath87 ,  @xmath984 and  @xmath696 are ( fixed ) square roots of the directions of the corresponding oriented edges ,  @xmath985 and  @xmath109 is the midpoint of an edge  @xmath68 . in the double - ising model context",
    ", one can use the same definition with the kac ",
    "ward matrix  @xmath92 replaced by its appropriate modification  @xmath204 : @xmath986    it is easy to check that the matrix  @xmath207 is real - valued and hence  @xmath987 , similarly to the entries of the matrix  @xmath988 .",
    "further , it is not hard to argue that the functions  @xmath989 introduced above satisfy the ( generalized ) s - holomorphicity condition given by definition  [ def : s - hol ] , for properly defined values  @xmath990 at corners  @xmath402 .",
    "such values can be constructed , for instance , using the same linear combinations @xmath991\\ ] ] as in the single - ising model context ( where this linear relation is nothing but the expression   of the `` corner '' variable  @xmath572 in terms of the nearby `` edge '' variables  @xmath499 ) .",
    "the reason why  @xmath694 satisfies the s - holomorphicity condition away from the `` source '' edge  @xmath228 is as follows : the collection of equalities for all pairs  @xmath992 around a fixed vertex  @xmath993 is _ equivalent _ to the collection of equalities @xmath994 provided @xmath995 , e.g. see  ( * ? ? ?",
    "* section  2.1 ) . since  @xmath996 unless  @xmath997",
    ", the latter local relations hold true with the entries  @xmath998 replaced by  @xmath999 whose complex phases coincide with those of  @xmath998 .    of course , expanding the corresponding minors of  @xmath204 , it is also possible to give a purely combinatorial definition of all the values  @xmath989 in the style of definition   but with a more involved set of `` double - ising domain walls '' configurations to sum over , and to check the s - holomorphicity relations directly in the style of  ( * ? ? ?",
    "* section  4 ) or  ( * ? ? ?",
    "* section  2.2 ) .",
    "let us now briefly discuss the boundary conditions for s - holomorphic functions which naturally replace   in the double - ising model context . if  @xmath1000 is an _",
    "outward _ oriented boundary edge of  @xmath2 , then @xmath1001 which leads to @xmath1002 as  @xmath1003 and  @xmath1004 , we arrive at the following claim : @xmath1005 ( note that the factor  @xmath1006 appeared as a result of adjusting the entry  @xmath1007 and would disappear , leading back to  , if one works with the original matrix  @xmath92 instead of  @xmath204 . )",
    "[ rem : dbli - boundary - conditions ] the s - holomorphic functions  @xmath989 discussed above ( or their spinor analogs constructed via the matrices  @xmath211}^{-1}$ ] instead of  @xmath1008 , see proposition  [ prop : spin4 ] ) can be used to study ( the scaling limits of ) correlation functions in the critical double - ising model , cf .",
    "remark  [ rem : formulas - via - k^-1 ] and remark  [ rem : towards - scaling - limits - single ] .",
    "nevertheless , let us emphasize that the additional factor  @xmath1006 in   is _ lattice dependent _ on the one hand , and the s - holomorphicity condition is _ not _ complex - linear on the other ( thus , even when working on regular lattices with constant weights  @xmath1009 , one can not just multiply the function  @xmath989 by  @xmath1010 to pass from   to  ) .",
    "interestingly enough , boundary conditions   admit a _ lattice independent _ reformulation in terms of the discrete primitive  @xmath1011 $ ] but it is still not clear how to pass to the limit of such s - holomorphic functions even in general smooth planar domains , cf .",
    "remark  [ rem : towards - scaling - limits - single ] .",
    "we conclude this section with a brief informal discussion of s - holomorphic functions that appear when considering the double - ising model with dobrushin boundary conditions   instead of ` @xmath29 ' ones . for a fixed pair of inward oriented boundary edges  @xmath228 and  @xmath229 ,",
    "let us slightly modify definition   and introduce a matrix  @xmath1012 , whose entries are still given by   but the row  @xmath228 and the column  @xmath229 are _ not _ removed this time ( also , note that we do not adjust the values  @xmath1013 when defining  @xmath1014 ) .",
    "further , let @xmath1015    similarly to  ( * ? ? ?",
    "* section  2.2 ) , one can work out combinatorial expansions of  @xmath1016 and show that the quantities  @xmath1017 are discrete martingales in the double - ising model with respect to the _ interface _",
    "@xmath223 ( domain wall separating double - ising spins  @xmath1018 ) generated by dobrushin boundary conditions  .",
    "note that the key observation leading to this martingale property is given by theorem  [ thm : kw4 ] , which relates the denominator of  @xmath1019 with the partition function of the double - ising model with dobrushin boundary conditions .",
    "having such a collection of discrete martingales , one could try to implement the same strategy as in  @xcite for the critical _ double_-ising model , first proving the convergence of these s - holomorphic observables to some scaling limits and then analyzing the putative limit of the interfaces  @xmath223 using the limits of discrete martingales  @xmath1019 .",
    "[ rem : dbli - martingale - strategy - oops ] though the above strategy of studying the single interface  @xmath223 generated by dobrushin boundary conditions   in the critical double - ising model looks rather promising at first sight , we expect conceptual obstacles along the way .",
    "the reason is that the critical double - ising model with dobrushin boundary conditions is ( rather surprisingly ) conjectured to  _ lose _ the domain markov property when passing from discrete to continuum , see  @xcite . at the level of convergence of solutions to the relevant discrete boundary value problems , this should mean that the boundary conditions   have _ different _ limits on the smooth boundary and on the fractal one , generated by the ( first part of the ) interface  @xmath223 itself .",
    "in fact , it is even not easy to guess what the latter limit should be , not speaking about proving the relevant convergence theorem for discrete martingales  @xmath1019 discussed above .",
    "hugo duminil - copin and stanislav smirnov .",
    "conformal invariance of lattice models . in _ probability and statistical physics in two and more dimensions _ ,",
    "volume  15 of _ clay math .",
    "_ , pages 213276 .",
    "soc . , providence , ri , 2012 .",
    "michio jimbo .",
    "introduction to holonomic quantum fields for mathematicians . in _ theta functions ",
    "bowdoin 1987 , part 1 ( brunswick , me , 1987 ) _ , volume  49 of _ proc .",
    "pure math .",
    "_ , pages 379390 .",
    "amer . math .",
    "soc . , providence , ri , 1989 .                                richard kenyon and robin pemantle .",
    "double - dimers , the ising model and the hexahedron recurrence . in _ 25th international conference on formal power series and algebraic combinatorics ( fpsac 2013 ) _ , discrete math .",
    ", as , pages 109120 .",
    "assoc . discrete math .",
    "sci . , nancy , 2013 .",
    "jacques h.  h. perk .",
    "nonlinear partial difference equations for ising model n - point green s functions . in _ proceedings of ii international symposium on selected topics in statistical mechanics _ , pages 165180 .",
    "dubna , 1981 ."
  ],
  "abstract_text": [
    "<S> we provide a concise exposition with original proofs of combinatorial formulas for the 2d ising model partition function , multi - point fermionic observables , spin and energy density correlations , for general graphs and interaction constants , using the language of kac  ward matrices . we also give a brief account of the relations between various alternative formalisms which have been used in the combinatorial study of the planar ising model : dimers and grassmann variables , spin and disorder operators , and , more recently , s - holomorphic observables . </S>",
    "<S> in addition , we point out that these formulas can be extended to the double - ising model , defined as a pointwise product of two ising spin configurations on the same discrete domain , coupled along the boundary . </S>"
  ]
}