{
  "article_text": [
    "in his beautiful book @xcite , jean petitot describes a sub - riemannian model of the visual cortex v1 .",
    "the main idea goes back to the paper @xcite by hbel an wiesel in 1959 ( nobel prize in 1981 ) who showed that in the visual cortex v1 , there are groups of neurons that are sensitive to position and directions ) what neurophysiologists call `` orientations '' . ] with connections between them that are activated by the image .",
    "the key fact is that the system of connections between neurons , which is called the functional architecture of v1 , preferentially connects neurons detecting alignements .",
    "this is the so - called _ pinwheels _ structure of v1 .    in 1989 , hoffman @xcite proposed to regard the visual cortex v1 as a manifold with a contact structure . in 1998 , petitot @xcite proposed to regard the visual cortex v1 as a left - invariant sub - riemannian structure on the heisenberg group and gave an enormous impulse to the research on the subject . in 2006 ,",
    "citti and sarti @xcite required the invariance under rototranslations and wrote the model on @xmath1 . in @xcite , it was proposed to write the problem on @xmath2 to avoid some topological problems and to be more consistent with the fact that the visual cortex v1 is sensitive only to directions ( i.e. , angles modulo @xmath3 ) and not to directions with orientations ( i.e. , angles modulo @xmath4 ) .",
    "further development and elaboration of these ideas was carried on by various authors , see e.g. , the papers  @xcite and the references therein .    the detailed study of the sub - riemannian geodesics was performed by yuri sachkov in a series of papers @xcite .",
    "this model was also deeply studied by duits et al . in @xcite with medical imaging applications in mind , and by hladky and pauls @xcite .",
    "of course there are some close relations with the celebrated model by mumford @xcite .    the main idea of the model ( that in the following we call citti - petitot - sarti s model ) is that v1 lifts the images @xmath5 ( i.e. , functions of two position variables @xmath6 in the plane @xmath7 of the image ) to functions over the projective tangent bundle @xmath8 .",
    "this bundle has as base @xmath7 and as fiber over the point @xmath9 the set of directions of straight lines lying on the plane and passing through @xmath9 and denoted by @xmath10 .    in this model , a corrupted image is reconstructed by minimizing the energy necessary to activate the regions of the visual cortex that are not excited by the image . if we think to an images as a set of ( grey ) level curves , each level curve is reconstructed by solving the following optimal control problem ( in sub - riemannian form ) @xmath11{c } \\dot{x}(t)\\\\ \\dot{y}(t)\\\\ \\dot{\\theta}(t ) \\end{array } \\biggr)=u(t)f(x , y,\\theta)+v(t)g(x , y,\\theta ) , \\label{e-1}\\\\ & & f(x , y,\\theta)=\\biggl (",
    "\\begin{array } [ c]{c } \\cos(\\theta)\\\\ \\sin(\\theta)\\\\ 0 \\end{array } \\biggr ) ,   \\quad \\ g(x , y,\\theta)= \\biggl ( \\begin{array } [ c]{c } 0\\\\ 0\\\\ 1 \\end{array } \\biggr),\\label{e-11}\\\\ & & \\int\\limits_0^t \\biggl ( u(t)^2+{\\frac1\\alpha } v(t)^2 \\biggr ) \\,dt\\to \\min,\\label{e-2}\\\\ & & \\bigl(x(0),y(0),\\theta(0)\\bigr)=(x_0,y_0,\\theta_0 ) , \\quad \\",
    "\\bigl(x(t),y(t),\\theta(t)\\bigr)=(x_1,y_1,\\theta_1 ) . \\label{e-3}\\end{aligned}\\ ] ] here @xmath12 and @xmath13 denote the initial and final condition in @xmath8 of the level set that has to be reconstructed .",
    "equations , requires that the reconstructed curve is a lift of a planar curve . in",
    ", the final time @xmath14 should be fixed .",
    "the term @xmath15 ( respectively @xmath16 ) is proportional to the infinitesimal energy necessary to activate _ horizontal _ connections ( resp .",
    "_ vertical _ ) connections .",
    "the parameter @xmath17 is a relative weight . for more details on the sub - riemannian problem",
    "see the original papers @xcite , the book @xcite or @xcite for a language more consistent with the one of this paper .",
    "[ remalfa ] from the theoretical point of view , the weight parameter @xmath18 is irrelevant : for any @xmath19 there exists a homothety of the @xmath9-plane that maps geodesics of the metric with the weight parameter @xmath18 to those of the metric with @xmath20 . for this reason , in all theoretical considerations we fix @xmath20 .",
    "however its role will be important in our inpainting algorithms ( see section  [ weight ] ) .",
    "the optimal control problem  described above was used to reconstruct smooth images ( by reconstructing level sets ) by ardentov , mashtakov and sachkov @xcite .",
    "the technique developed by them consists of reconstructing as minimizing geodesics the level sets of the image where they are interrupted . obviously , when applying this method to reconstruct images with large corrupted parts , one is faced to the problem that it is not clear how to put in correspondence the non - corrupted parts of the same level set .    to reconstruct a corrupted image ( the v1 inpainting problem )",
    ", it is natural to proceed as follows . in the system , excite all possible admissible paths in a stochastic way .",
    "one gets a stochastic differential equation @xmath21{c } dx_{t}\\\\ dy_{t}\\\\ d\\theta_{t } \\end{array } \\biggr ) = \\biggl ( \\begin{array } [ c]{c } \\cos(\\theta_{t})\\\\ \\sin(\\theta_{t})\\\\ 0 \\end{array } \\biggr ) du_{t } + \\biggl ( \\begin{array } [ c]{c } 0\\\\ 0\\\\ 1 \\end{array } \\biggr ) dv_{t } , \\label{sys - stoch}\\ ] ] where @xmath22 are two independent wiener processes .",
    "consider the associated diffusion process ( here we have fixed @xmath20 ) : @xmath23 the operator @xmath24 is not elliptic , but it is hypoelliptic ( satisfies hrmander condition ) . in this setting , equation was proposed first by citti and sarti in @xcite .    to be able to use equation to reconstruct a corrupted image , one has to specify two things : * i ) * how to lift the corrupted image on @xmath2 to get an initial condition for ; * ii ) * how to project the result of the diffusion on @xmath25 to get the reconstructed image .",
    "different procedures for these steps have been proposed in @xcite .",
    "a clever lifting process was proposed in @xcite .",
    "* relation between the sub - riemannian problem and the diffusion equation * :    * by the feynman ",
    "kac formula , integrating equation  , one expects to reconstruct the most probable missing level curves ( among admissible ) . * the solution of is strictly related to the solution of the optimal control problem . indeed",
    ", a result by leandre @xcite shows that @xmath26 tends ( up to constants ) to @xmath27 , as @xmath28 , where @xmath29 is the kernel of equation and @xmath27 is the value function for the problem",
    ". here @xmath30",
    ".    there are at least two parameters to be suitably tuned : the time of the diffusion and the parameter @xmath18 .",
    "the problem of the numerical integration of is subtle since multiscale sub - riemannian effects are hidden inside one can not build a refinable grid having a subgroup properties . indeed",
    ", a grid that is subgroup of @xmath1 has at most 6 angles and hence can not be refined , see e.g. ,  @xcite . ] and has been approached in different way . in @xcite",
    "the authors use a finite difference discretisation of all derivatives . in @xcite",
    "the authors use an almost explicit expression for the heat kernel . in @xcite",
    "some promising results about inpainting using hypoelliptic diffusion were obtained via a sophisticated algorithm based upon the generalized fourier transform on the group @xmath1 .",
    "see also @xcite .",
    "the purpose of this paper is to approach the problem differently : we will not present a new method to solve numerically , but rather a variant to the citti - petitot - sarti model by assuming that the visual cortex can detect only a finite number of directions .",
    "this idea will permit to put the problem in a very different theoretical context and to overcome most of the difficulties in the numerical integration of .        in this paper",
    ", we introduce a new ingredient , namely we conjecture the following :    * the visual cortex can detect a finite ( small ) number @xmath31 of directions only .",
    "this conjecture is based on the observation of the organization of the visual cortex in pinwheels .",
    "the planar and the angular degrees of freedom can not be treated in the same way .",
    "we conjecture that there are topological constraints that prevent the possibility of detecting a continuum of directions even when sending the distance between pinwheels to zero .    in this paper",
    "we are not going to justify this conjecture , but we can mention several previous contributions : from neurophysiology ( see @xcite and references therein ) and from image processing engineering ( see @xcite and references therein ) .",
    "another justification from the present paper is just the observation that increasing @xmath31 does not lead to significant improvement in our reconstruction process ( see section  [ heursec ] ) .",
    "rather , we concentrate on the effect of this conjecture on the mathematical model .",
    "this assumption being made , the group @xmath0 appears naturally and rather elementary stochastic analysis leads to the equivalent below of the hypoelliptic diffusion .",
    "these topics are the purpose of section [ se2n ] and [ s - semi - d ] , while in section [ s - se2 ] we recall shortly what happens considering @xmath1 .    here",
    "some points have to be stressed that are in order :    1 .   as usual for the treatment of invariant diffusions on topological groups ,",
    "the basic tool is an analog of the usual fourier transform , i.e. , the gft , see the appendix [ gft ] .",
    "the nature of @xmath0 is completely different from that of @xmath1 : although non - abelian and non - compact , it is a moore group , which is a special case of maximally almost periodic ( map ) groups ( having the chu duality property ) .",
    "see appendix [ map ] for a short introduction to these concepts .",
    "the expression of the heat kernel on @xmath0 is much simpler than the one over @xmath1 .",
    "although we use a `` small number of directions '' we show the following coherence property : when @xmath31 tends to infinity , the diffusion tends to the diffusion over @xmath1 .      in section  [ prea ]",
    "we discuss the use of the map property of @xmath0 for the integration of our semi - discrete diffusion .",
    "the group @xmath0 being map , it follows ( exactly as for the standard heat equation over @xmath32 ) that the space of almost periodic functions is a good candidate for the space of solutions .",
    "in fact , restricting to finite dimensional subspaces ( called @xmath33 below ) of finite trigonometric polynomials ( conceptually finite linear combinations of coefficients of unitary irreducible representations of @xmath0 ) , an immediate computation leads to equation  .",
    "this equation shows ( theorem  [ th1 ] ) that the integration of the diffusion on @xmath0 reduces to solving a finite ( but large ) set of finite dimensional linear evolution equations .",
    "these equations can be solved in parallel , which fits with the structure of the visual cortex v1 , which is thought to make a lot of parallel computations .",
    "see , for instance , @xcite .",
    "it turns out that this space of solutions is not very relevant for the purpose of image reconstruction , mostly for two reasons :    1 .",
    "it is not adapted to the usual simple representation of an image as a table of numbers ( grey levels at points of a grid ) ; 2 .   due to the lifting step",
    "the functions under considerations are far from being almost - periodic .",
    "in particular , in the limit @xmath1 case they are distributions as explained above . in the @xmath0 case , they are not continuous .      the two items just above are the reasons for the final algorithm proposed in section [ algo ] .",
    "since a grey - level image is usually given under the guise of a ( square , say ) table of positive real numbers , we will consider a spatial discretisation of the continuous part of the operator , coherent with this given grid .",
    "this discretisation produces the equation which is exactly of the same type of equation .",
    "this leads to theorem  [ th2 ] : the integration of the spatially discretised operator over @xmath0 reduces to a large finite set of linear finite dimensional evolution equations of mathieu type that can be solved in parallel .",
    "the following observation is important : the number of these mathieu type diffusions reflects the structure of ( the dual of ) @xmath0 and not the number of points in the image .      in section [ heursec ] ,",
    "we show a number of numerical results .",
    "in fact , in our algorithm , at this point , several steps are not fixed .",
    "we have chosen for these steps the most simple and maybe naive solutions , namely :    * the lifting procedure to @xmath0 that we implement is the most simple that can be thought : after smoothing the image ( gaussian smoothing ) , the gradient at the point is well defined ( both the smoothing and the gradient computation are performed at the level of the fft of the image ) , and we just lift to the closest value of the angle . or even @xmath0 structures ) , can be developed , see  @xcite . but",
    "this is beyond the scope of this paper . ]",
    "+ to simplify , even when we know where the image is corrupted we always compute the gradient in this rough way .",
    "this point could certainly be improved on .",
    "the only place where we eventually use the knowledge of the corrupted part is inside the integration procedure .",
    "see the concepts of static and dynamic restorations in section  [ heursec ] . *",
    "the projection step .",
    "there are at least two obvious possibilities : projecting by taking either the maximum , or the average , over angles .",
    "numerous experiments show that the projection made by the maximum provides better results . for less rough ideas ,",
    "see @xcite . * the numerical resolution of the mathieu type diffusions : they are finite dimensional evolution equations with elliptic second term . we have chosen the crank - nicolson method which is recommended in such a situation . we do not intend to discuss the convergence of this method to the solution to the initial hypoelliptic diffusion , this is of no interest within the scope of this paper .    in this section [ heursec ]",
    "we present also some heuristic improvements of the algorithm in the case where we can distinguish between the corrupted and non - corrupted parts of the image .      in appendix",
    "[ app6 ] , we present a series of results of reconstruction with high corruption rates and the table of all parameters used for the reconstruction procedures .",
    "these parameters include : the time of diffusion , the weight @xmath18 , and other parameters that are used to `` tune '' the action of the diffusion on the corrupted and non corrupted points .",
    "finally , appendix  [ app7 ] is devoted to basic theoretical concepts and to certain technical computations .",
    "we do not pretend that our results are better than the inpainting algorithms existing today .",
    "we just claim that they really seem to validate our semi - discrete version of the citti - petito - sarti model .",
    "moreover , we emphasize the global character of the basic algorithm .",
    "to finish let us underline the main point .",
    "the most interesting feature of the `` algorithms '' resulting from the present study is the following : they are naturally massively parallel , which reflects the structure of the dual of the group @xmath0 .",
    "we advise the uninitiated reader to start with our paper @xcite and to have a look to appendix  [ app7 ] at the end of this paper .",
    "the group law over the lie group @xmath1 has multiplication law @xmath34 , where @xmath35{c } x\\\\ y\\\\ \\end{array } \\right ) , \\quad r_{\\theta}=\\left ( \\begin{array } [ c]{cc } \\cos(\\theta ) & \\sin(\\theta ) \\!\\\\",
    "\\!\\!-\\sin(\\theta ) & \\cos(\\theta ) \\!\\\\",
    "\\end{array } \\right),\\ ] ] @xmath36 is the rotation of angle @xmath10 in the @xmath37-plane .    the ( strongly continuous ) unitary irreducible representations of @xmath1 are well known .",
    "however for analogy with the next section , we need to recall basic facts . for a survey ,",
    "see @xcite .    as representations of a semi - direct product ,",
    "they can be obtained by using mackey s imprimitivity theorem , and therefore , they are parametrized by the orbits of the ( contragredient ) action of rotations on the @xmath37-plane , i.e. , they are parametrized by the half lines passing through the origin",
    ". additionally , corresponding to the origin , there are the characters of the rotation group @xmath38 that do not count in the support of the plancherel s measure .",
    "finally , the representation @xmath39 corresponding to the circle of radius @xmath40 acts over @xmath41 and is given by @xmath42(u)=e^{i \\langle v_{\\lambda},r_{u}x \\rangle } \\varphi(u+\\theta),\\ ] ] where @xmath43 , @xmath44 is a vector of length @xmath40 in @xmath7 , and @xmath45 denotes the standard euclidean scalar product over @xmath7 .    note that @xmath1 is far from being map , since all its finite dimensional unitary irreducible representations are given by the characters of @xmath38 only .",
    "let us also recall @xcite that the sub - riemannian heat kernel on @xmath1 , corresponding to the hypoelliptic laplacian @xmath46 defined in is given by ] @xmath47 where the functions @xmath48 and @xmath49 are the @xmath4-periodic mathieu sines and cosines , and @xmath50 , @xmath51 , with @xmath52 the characteristic values for the mathieu equation .",
    "then the solution of the diffusion equation with the initial condition @xmath53 is given by the right - convolution formula : @xmath54 where @xmath55 and @xmath56 is the haar measure : @xmath57 .    in @xcite ,",
    "the authors reduce this expression to a simpler one involving only 4 non - periodic mathieu functions .",
    "the periodic mathieu expansion is more directly related with the fourier transformations over @xmath1 and @xmath0 , the periodic mathieu functions being eigenfunctions of the relevant mathieu operators arising by applying the gft to the original diffusion equation .      in the next section ,",
    "a discrete - angle version of the above diffusion equation will appear naturally .",
    "it corresponds to the group of motions @xmath1 restricted to rotations with angles @xmath58 .",
    "this group is denoted by @xmath0 .",
    "it has very special features : it is map , and all its unitary irreducible representations are finite dimensional ( it is a moore group , see @xcite for details ) , although it is not compact .",
    "in particular , this follows from ( * ? ? ?",
    "* , page  304 ) : it is the semi - direct product of the compact subgroup @xmath59 , and a normal subgroup @xmath60 isomorphic to @xmath7 , each element of @xmath60 commuting with the connected component of the identity ( which in this case is @xmath60 itself ) . to simplify , we set @xmath61 .    regarding the representations of @xmath0 , using mackey s machinery the picture is the following .",
    "besides the characters of @xmath62 , the representations coming in the support of the plancherel measure are parametrized by @xmath63 the *",
    "* dual * * is that of a cone , that consists of considering @xmath64 $ ] and identifying ( @xmath65 with @xmath66 .",
    "] of @xmath0 .",
    "they act on @xmath67 and are given by @xmath68 where @xmath69 is the diagonal matrix with diagonal elements @xmath70 , @xmath71 , @xmath72 , and @xmath73 is the shift matrix over @xmath67 , i.e. , @xmath74 for @xmath75 , and @xmath76 , where @xmath77 are the elements of the standard basis in @xmath67 .",
    "firstly , we show that a certain semi - discrete ( discretization with respect to the angle ) model of the diffusion is compatible with the limit continuous model .",
    "for the considerations in this section , one may refer to the paper @xcite .",
    "the developments in this section may be considered as elementary by probabilistic readers , however they are very instructive with respect to the nature of our semi - discrete model .",
    "therefore we give the details .",
    "the diffusion equation comes from the stochastic differential equation , where @xmath78 are two independent standard wiener processes .",
    "it is the associated fokker - planck ( or kolmogorov forward ) equation to .    from the image processing point of view",
    ", integrating the diffusion is equivalent to excite all possible admissible paths , in a stochastic way .",
    "in fact , in the real structure of the v1 cortex , * a finite ( small ) number of angles only is taken into account*. here this number is denoted by  @xmath31 .",
    "therefore , it is natural to consider the following stochastic process with jumps evidently connected with the stochastic equation : @xmath79{c } \\ !",
    "dx_{t } \\!\\\\ \\ !",
    "dy_{t } \\ ! \\\\ \\end{array } \\right ) = \\left ( \\begin{array } [ c]{c } \\ !",
    "\\cos(\\theta_{t})\\ ! \\\\ \\ !",
    "\\sin(\\theta_{t})\\ ! \\\\ \\end{array } \\right ) dv_{t } , \\label{sto - proc}\\ ] ] in which @xmath80 is a jump process .",
    "set @xmath81 , @xmath82 , where @xmath83}{t } \\",
    "\\ \\textrm{for } \\ \\",
    "i\\neq j , \\quad \\lambda_{j , j } = -\\sum_{i \\neq j } \\lambda_{i , j}.\\ ] ] the matrix @xmath84 is the infinitesimal generator of the jump process .",
    "we assume markov processes , where the law of the first jump time is the exponential distribution with the rate parameter @xmath85 ( the value of @xmath86 will be specified later on ) .",
    "the jump has probability @xmath87 on both sides .",
    "then we get a poisson process , and the probability of @xmath88 jumps between @xmath89 and @xmath90 is @xmath91 = \\frac{(\\beta t)^{k}}{k!}e^{-\\beta t}.\\ ] ] so that : @xmath92=\\frac{1}{2 } \\bigl ( \\beta t+kt^{2 } + o(t^{2 } ) \\bigr)e^{-\\beta t},\\\\ { { \\sf p\\,}}[\\theta_{t }   &   = e_{i\\pm 2}|\\theta_{0}=e_{i}]=\\frac{1}{4 } \\biggl(\\frac{1}{2}\\beta^{2}t^{2 } + o(t^{2 } ) \\biggr)e^{-\\beta t},\\\\ { { \\sf p\\,}}[\\theta_{t }   &   = e_{i\\pm n}|\\theta_{0}=e_{i}]= o(t^{n } ) e^{-\\beta t } , \\ \\",
    "n = 2,3 , \\ldots,\\end{aligned}\\ ] ] with the convention that @xmath93 is modulo @xmath31 .",
    "hence @xmath94 and @xmath95 .",
    "all other elements of the matrix @xmath84 are equal to zero .",
    "then , the infinitesimal generator of the semi - group associated with the stochastic process @xmath96 is of the form : @xmath97 where @xmath98 , @xmath99 , ( here we use @xmath100 instead of @xmath101 to distinguish the discrete case and to have a more compact notation ) and @xmath102 @xmath103 where the subscript @xmath104 means the @xmath104-th coordinate of the vector .    therefore , if we set @xmath105 , we get @xmath106 at the limit @xmath107 , from formulae  we get the second order differential operator @xmath108 that is , the operator of our diffusion process .",
    "however the exact fokker - planck equation with number of angles @xmath109 contains the parameter  @xmath86 : @xmath110      the gft ( generalized non - commutative fourier transform , see @xcite and appendix  [ app7 ] ) transforms our hypoelliptic diffusion equation into a continuous sum of diffusions with elliptic right - hand term , and the summation over @xmath111 is with respect to the plancherel measure @xmath112 .",
    "we compute the semi - discrete heat kernel via the gft , just as in @xcite , and we get a similar but simpler formula than for the `` continuous '' heat kernel   in the case of the group @xmath1 :    formulae and for the direct and the inverse gft show that , if we set @xmath113 we get the following expression for the `` semi - discrete '' ( or `` jump '' ) heat kernel : @xmath114    note also that it is a closed formula similar to the one in the heisenberg case ( explicit usual functions modulo a fourier transform ) .",
    "these are the only cases we know for noncompact groups , where the kernel is obtained with such an explicit formula .",
    "we start from our semi - discrete heat equation  .",
    "the heat kernel is the convolution kernel associated with @xmath115 , the fundamental solution of equation  .    applying the ordinary fourier transform with respect to the space variable  @xmath116 to  ,",
    "we get the ordinary linear differential equation @xmath117 where @xmath118 , with the initial condition obtained from the dirac delta function at the identity by the ordinary fourier transform : @xmath119    then , taking the inverse ordinary fourier transform with respect to the space variable , we get a second expression for the heat kernel : @xmath120    looking at the formulae and , it is not clear that these expressions are identical .",
    "the proof of this fact is given in appendix  [ kerproof ] . although less direct , we prefer formula   , that reflects more the structure of @xmath0 .      consider the diffusion process @xmath121 with the weighting coefficient @xmath17 .",
    "the hypoelliptic operator @xmath24 defined in is the case @xmath20 .",
    "although the coefficient @xmath18 is theoretically irrelevant ( see remark  [ remalfa ] ) , it plays an essential role in practice .    on the same way , for the semi - discrete operator",
    ", we have @xmath122 as @xmath107 . comparing the above formula with",
    ", we have the relation : @xmath123 it appeared clearly in all our experiments that @xmath124 is always enough ( it brings nothing visible in the experiments to take @xmath125 ) .",
    "* both parameters @xmath31 and @xmath126 have a physiological meaning * : the number @xmath31 is the number of ( significant ) directions in our model and @xmath126 is a parameter specifying the dynamics of the jumps to closest neighbour direction .",
    "therefore , the coefficient @xmath18 of the limit behavior ( @xmath107 ) can certainly be obtained from physiological considerations .",
    "however we could not find any result from neurophysiological literature in this direction .    * ( about projectivization ) * the orientation maps of the v1 cortex show `` pinwheels '' , that is , singularities where iso - direction lines of any orientation @xmath10 converge .",
    "pinwheels have `` chirality '' , that is , they rotate as @xmath127 or @xmath128 along a small direct loop around them .",
    "this could be reflected in formula below .",
    "see figure [ f - pinwheels ] .        as we said , the neurons are not sensitive to the angles themselves , but to directions only ( i.e. , the angles are modulo @xmath3 and not @xmath4 ) .",
    "it is the reason why we work in the projectivisation @xmath8 of the tangent bundle of @xmath7 , in place of @xmath1 itself . from the discrete point of view , it means that if @xmath31 is the number of values of directions ( not angles ) , the angle - step is in fact @xmath129 .",
    "also , as it was explained in @xcite , the sub - riemannian structure over @xmath8 itself is not trivializable .",
    "this is not a problem for the operators @xmath24 and @xmath130 , since the functions @xmath131 , @xmath132 and @xmath133 are @xmath3-periodic .",
    "hence , details relative to this projectivisation are omitted in the following sections .    from the point of view of the heat kernels , in fact ,",
    "if @xmath134 denotes the heat kernel over @xmath8 ( which is not a group convolution kernel anymore , since @xmath8 is not a group ) , we have the formula @xmath135 where the inverses and products are intended in the group @xmath1 .",
    "a similar formula holds for the semi - discrete kernels @xmath136 and @xmath137 from for even  @xmath31 .",
    "as we said in section [ se2n ] , the group @xmath0 is map .",
    "it follows from the expression   of the unitary irreducible representations that the bohr - almost periodic functions @xmath138 are just those such that the functions @xmath139 , @xmath140 , are bohr - almost periodic over @xmath7 in the usual sense .",
    "we call @xmath141 the set of almost periodic functions on @xmath0 , and we identify the elements of @xmath141 to @xmath67-valued functions whose components are almost periodic over @xmath7 , i.e. , functions that are uniform limits of trigonometric polynomials in the two variables @xmath9 .",
    "see appendix [ map ] .",
    "these functions are dense among continuous functions over any compact subset of @xmath0 , and @xmath141 is a good candidate for the space of solutions of our heat equation : exactly as for the usual heat equation ( see @xcite for instance ) , the uniformly bounded solutions of our heat equation with initial conditions in @xmath141 remain almost periodic over @xmath0 uniformly in time .",
    "functions coming from standard images have support in a bounded subset of @xmath0 .",
    "they can be ( after smoothing and lifting ) approximated uniformly over this bounded subset by trigonometric @xmath67-valued polynomials @xmath142 with components @xmath143 : @xmath144 where @xmath43 .",
    "the vector space of such @xmath67-valued polynomials , for a fixed finite number of distinct values of @xmath145 , i.e. , @xmath146 , a fixed finite subset of @xmath7 , is denoted by @xmath33 .",
    "a straightforward computation shows that semi - discrete hypoelliptic equation restricts to @xmath33 .",
    "it becomes @xmath147 or , equivalently , @xmath148 where @xmath149 is the vector in @xmath67 with components @xmath150 , which are the coefficients of the solution of the restriction to @xmath33 of the semi - discrete equation .",
    "the matrix @xmath84 is the infinitesimal generator of the jump process with parameter @xmath126 .",
    "the system of differential equations is equipped with the initial condition @xmath151 with @xmath152 from  .",
    "these last two formulas are equivalent to the following theorem .",
    "[ th1 ] for any almost periodic polynomial initial condition in @xmath33 , the integration of the diffusion equation reduces to solving a finite set of independent linear ordinary differential equations of dimension @xmath31 .",
    "any continuous initial condition over a compact subset of @xmath0 can be uniformly approximated by such a polynomial .",
    "differential equations over @xmath67 are not hard to tract numerically .",
    "they have an elliptic right hand term , and the crank - nicolson method ( discussed in the next section ) is recommended .",
    "in fact , @xmath33 is the space of a unitary representation of @xmath0 which is not irreducible but splits into the direct sum of irreducible representations : @xmath153    this fact suggests that we can use our knowledge of the dual @xmath111 to reduce the computations .    in theorem [ th1 ] ,",
    "if some points of @xmath62 can be deduced one from the other by elementary rotations @xmath154 then it is enough to compute the resolvents corresponding to a single among these points .",
    "let @xmath155 be the solution of equation in @xmath156 for some @xmath157 and @xmath158 be the solution of the same equation in @xmath159 for @xmath160 such that @xmath161 .",
    "it is easy to check that @xmath162 also satisfies equation : @xmath163 so that it is not necessary to compute all the resolvents relative to each unitary irreducible representation .",
    "it is enough to do it for those corresponding to @xmath164 only .",
    "this method could be very efficient in a general setting .",
    "the last considerations show that it is of numerical interest to put in @xmath62 as much as possible points in the same orbits under the elementary rotations .    in our vision problem ,",
    "the initial conditions are certainly very far from being almost periodic due to the lifting procedure , which lifts to a distribution .",
    "there are at least two ways to overcome this obstacle .",
    "the first way is to modify the lifting procedure , which is out of the scope of this paper .",
    "here we have chosen another method based upon the spatial discretization , presented in the next section .",
    "in fact , images being given under the guise of a square table of real values ( the grey levels ) , we have chosen to deal with periodic images over a basic rectangle , and to discretize with respect to the naturally discrete @xmath9 variables .",
    "we take a mesh of @xmath165 points on the @xmath9-plane , and the number of angles is @xmath31 .    in all the results we show , @xmath166 , and the number of angles @xmath167 .",
    "* we do nt see any significant improvement for larger @xmath31*.    therefore , a function @xmath168 over @xmath0 is approximated by a @xmath169 table @xmath170 , @xmath140 , @xmath171 .",
    "hence , without loss of generality , we set for the discretization steps @xmath172 and the mesh points are @xmath173 , @xmath174 . in this section , due to the periodicity ,",
    "the upper index takes natural values modulo @xmath31 and the lower indices take natural values modulo  @xmath175 .",
    "remind that the semi - discrete diffusion equation over @xmath0 is  . for numerical solution of this equation",
    "we replace the differential operators @xmath176 by the discrete operators @xmath177 , which act on @xmath178 : @xmath179    notice that this space discretisation has already been proposed in @xcite with numerical improvement that are out of the scope of this paper .",
    "moreover , the following resulting algorithm is closely related to previous work in @xcite",
    ".    then we get the diffusion equation with totally discretized (",
    "i.e. , with discretized space and angle variables ) operator @xmath180 , which acts on @xmath181 : @xmath182 the initial condition for is the discrete analog of the function @xmath183 obtained after the lift of the original image @xmath5 .    [ number]for @xmath184 , @xmath124 is a fully coupled linear differential equation in @xmath185 , @xmath186 . applying an implicit or semi - implicit finite difference scheme , one need to solve a system of @xmath187 linear algebraic equations .     and",
    "time @xmath188 ( right , up ) , @xmath189 ( right , down ) . ]    [ th2 ] the solution of equation can be computed * exactly * by solving in parallel @xmath190 linear differential equations in dimension  @xmath31 .    as previously",
    ", it is natural to apply the fourier transform over the abelian group ( @xmath191 , which can be computed * exactly * by the standard fft ( fast fourier transform ) algorithm .",
    "let us denote by @xmath192 the fourier transform of  @xmath193 : @xmath194    a straightforward computation shows that @xmath195 and the fourier transform maps the operator @xmath196 to the multiplication operator @xmath197 , where @xmath198    hence , the diffusion equation is mapped to the following completely decoupled system of @xmath199 linear differential equations over @xmath67 : @xmath200 where @xmath201 , @xmath202 , and @xmath203 means the transpose operation .",
    "due to periodicity in @xmath204 , @xmath84 is an almost tridiagonal @xmath205 matrix : it contains two extra non - zero elements in the right - up and left - low corners .",
    "therefore the solution of is @xmath206 where the initial function @xmath207 is known . finally , the solution of is the inverse fourier transform over ( @xmath191 of @xmath208 , obtained using the inverse fft .",
    "for instance , for @xmath184 and @xmath124 , this is solving @xmath209 linear differential equations in dimension  @xmath210 .    1 .",
    "the complexity of the fft used twice in our algorithm ( including the inverse transform ) is negligible in front of the complexity of the numerical integration of the decoupled linear differential equations .    2 .",
    "the discretized diffusion   can be numerically integrated with the semi - explicit crank - nicolson scheme .",
    "the convergence of this scheme for the considered class of equations and some estimations are well known ; see e.g. ,  @xcite .",
    "note that the matrices @xmath211 are tridiagonal plus two terms in the right - up and left - low corners ( coming from @xmath84 due to periodicity ) .",
    "an effective algorithm for solving such linear system is suggested in  @xcite .",
    "formula for solutions of the linear differential equations has an obvious advantage .",
    "once @xmath212 and @xmath18 ( or , equivalently , @xmath126 ) are fixed , the matrices @xmath211 * are universal * , and therefore their exponentials can be computed once for all . moreover , using a time step @xmath213 and the formula @xmath214 , it is enough to compute only the exponential @xmath215 .",
    "in fact , it is not necessary to compute @xmath199 exponentials of matrices : it is enough to compute them at the points @xmath216 that fall in the dual space @xmath111 .",
    "this is much less .",
    "for large @xmath217 is number is of order @xmath175 in place of @xmath199 . here , the structure of @xmath0 is crucial , and specially formula  .",
    "it has to be noticed that :    * the treatment of images up to now is essentially global . *",
    "it is not necessary to know where the image is corrupted .    presumably , the visual cortex v1 is also able in some cases to detect that the image is corrupted at some place , and to take this a - priori knowledge into account .",
    "we tried to investigate methods that would improve on our algorithm in this direction .",
    "these methods are based upon the general idea of distinguishing between the so called `` good '' and `` bad '' points ( pixels ) of the image under reconstruction .    roughly speaking , good points are points that are already reconstructed enough ( including non - corrupted points ) , and we would like to preserve them from the diffusion or at least to weaken the effect of the the diffusion at these points , while on the set of bad points the diffusion should proceed normally .",
    "exact definitions will be given below . in this section ,",
    "we present two heuristic methods :    * static restoration method , where the sets of good and bad points do not change along the treatment , that is , they coincide with corrupted and non - corrupted points respectively . * dynamic restoration method , where the sets of bad and good points coincide with corrupted and non - corrupted points respectively only at the initial moment , but along the treatment some bad points may become good , so that the sets of good and bad points change .    a very similar discussion has raised in the adaptation in the conductivity matrix in @xcite .",
    "one natural idea would be to iterate the following steps :    * lift the plane image to @xmath8 .",
    "* integrate the diffusion equation for some fixed small @xmath213 .",
    "* project the solution down to the plane . * restore the non - corrupted part of the initial image .    in practice",
    ", this idea does not work at all .",
    "the main reason is that the diffusion acts on both the corrupted and the non - corrupted parts , and there is not good coincidence at the frontier after the restoration .",
    "all variations of the previous idea , at the level of the plane image do not provide acceptable results . from what we conclude",
    "that it is necessary to proceed the restoration of the the non - corrupted part at the level of the lifted image , i.e. , on the bundle @xmath8 .",
    "assume that points @xmath9 of the image are separated into the set @xmath218 of good ( non - corrupted ) and the set @xmath219 of bad ( corrupted ) points , @xmath220 for all @xmath221 and @xmath222 for all @xmath223 .",
    "the idea of the restoration procedure is to `` mix '' the solution @xmath224 of the diffusion equation with the initial function @xmath225 at each point @xmath223 .",
    "the `` mixing '' is fulfilled many times during the integration of our equation .",
    "namely , split the segment @xmath226 $ ] into @xmath227 small intervals with the mesh points @xmath228 , @xmath229 , @xmath230 , and proceed the integration of our equation on each @xmath231 $ ] with the initial condition @xmath232 where the function @xmath233 is computed after integration on the previous interval , and the factor @xmath234 is defined by @xmath235 @xmath236 .",
    "after that we obtain the function @xmath237 and repeat the procedure on the next interval .",
    "this procedure essentially depends on two parameters that can be chosen experimentally : the natural number @xmath227 ( number of treatments ) and the coefficient @xmath238 , which defines the strength of each treatment .",
    "there is a defect in the procedure described above : different corrupted parts of the image have different velocities of reconstruction .",
    "this effect can cause serious defects .",
    "for instance , consider two different points @xmath239 and @xmath240 of the set @xmath219 .",
    "let @xmath241 be the time of the diffusion required for @xmath239 being reconstructed well , @xmath242 be the same for @xmath240 , and @xmath243 . applying the diffusion with @xmath244 , we get the image not reconstructed enough at @xmath240 .",
    "on the other hand , in the case @xmath245 the image is reconstructed well at @xmath240 , but a defect near the point @xmath239 can appear .",
    "this brings us to a natural idea : to use the diffusion with the time @xmath14 depending on a point @xmath9 . a simple way to realize it is to make the sets of good and bad points changing in time so that a bad point at some moment may become good , and the effect of the diffusion at this point is not essential anymore",
    "define the initial set of good points @xmath246 as before ( the set of non - corrupted points of the image ) and define @xmath247 , @xmath248 , as follows :    denote by @xmath249 the image at step @xmath250 .",
    "then @xmath247 contains @xmath251 and all points @xmath9 of the boundary @xmath252 such that the value @xmath249 is larger than the average value of @xmath253 over the points of the set @xmath254 in a neighborhood of @xmath9 . in practice , it is convenient to choose for such a neighborhood the usual discrete 9-points neighborhood , that is , the set of 9 points @xmath255 , where @xmath256 , @xmath257 , @xmath258 .",
    "the set @xmath259 is defined as the complement of @xmath247 .",
    "here we present a series of results of reconstruction with high corruption rates via the hypoelliptic diffusion and the dr procedure with different parameters found experimentally and listed in table  1 below .",
    ".parameters of the reconstruction for fig .",
    "[ fig2 ]  [ fige9 ] .",
    "the images have resolution @xmath260 ( pixels ) and the corrupted parts consist of vertical and horizontal lines of width  @xmath261 : [ cols=\"^,^,^,^,^,^,^ \" , ]",
    "in this appendix , we collect shortly a few results needed for the understanding of the paper .        given a locally compact unimodular topological group @xmath218 of type  i and",
    "@xmath0 are type  i. for instance , any connected semi - simple or nilpotent group is type  i. ] , the dual @xmath262 is the set of ( strongly ) continuous complex unitary irreducible representations @xmath263 of @xmath218 . for @xmath264 @xmath265 , the unitary group of the complex hilbert space @xmath266 .",
    "the space of complex @xmath267 functions over @xmath218 with respect to the haar measure is denoted by @xmath268 . the generalized fourier transform ( gft ) of @xmath269",
    "is defined by only , but is extended by continuity . ] : @xmath270    the operator @xmath271 is hilbert - schmidt over @xmath266 and there is a measure @xmath272 over @xmath262 , called the plancherel measure , such that the gft is an isometry to @xmath273 , where the space @xmath273 is the continuous hilbert sum of the spaces of hilbert - schmidt operators over the spaces @xmath266 , with respect to plancherel s measure . as a consequence , we have the inversion formula : @xmath274 the gft is a natural extension of the ordinary fourier transform over abelian groups and it has all the corresponding properties , such as : mapping convolution to product , etc .",
    "( see  @xcite ) .",
    "the bohr compactification of a topological group @xmath218 is the universal object @xmath276 in the category of diagrams : @xmath277 where @xmath278 is a continuous homomorphism from @xmath218 to a compact group @xmath279 .",
    "if the mapping @xmath280 is injective , @xmath218 is called maximally almost periodic ( map ) .",
    "the group @xmath218 is map iff the continuous unitary finite dimensional representations of @xmath218 separate the points .",
    "a connected locally compact group is map iff it is the direct product of a compact group by @xmath275 .",
    "the group @xmath0 is map , while @xmath1 is not .",
    "a continuous function @xmath284 iff its right ( or left ) translated form a relatively compact subset of @xmath285 , the set of bounded continuous functions over @xmath218 , iff it is a uniform limit of coefficients of unitary irreducible representations of @xmath218 . if @xmath218 is map , @xmath281 is dense in the space of continuous functions over @xmath218 , in the topology of uniform convergence over compact sets .",
    "set @xmath290 the following fact is crucial : @xmath291 where @xmath73 is the shift matrix over @xmath67 ( i.e. , @xmath74 for @xmath75 , and @xmath76 ) .",
    "the equality follows from @xmath292 , a consequence of @xmath293 and of the general relation @xmath294 which holds true for any @xmath205 matrix @xmath219 .",
    "abramov , v.b .",
    "andreev , on the application of the method of successive substitution to the determination of periodic solutions of differential and differences equations , zh .",
    "vychisl . mat . mat .",
    "fiz . , 3.2 , 1963 , pp .  377381 .",
    "a. ardentov , a. mashtakov , yu .",
    "sachkov , parallel algorithm and software for image inpainting via sub - riemannian minimizers on the group of rototranslations , numer .",
    "theor . meth .",
    ", vol .  6 ( 2013 ) , pp .",
    "95115 .",
    "bressloff , j.d .",
    "cowan , m. golubitsky , p.j .",
    "thomas , m.c .",
    "wiener , geometric visual hallucinations , euclidean symmetry , and the functional architecture of striate cortex .",
    "royal soc .",
    "london b. 356 ( 2001 ) , pp .",
    "299 - 330 .",
    "r. duits , u. boscain , f. rossi , yu.l .",
    "sachkov , association fields via cuspless sub - riemannian geodesics in @xmath1 , journal of mathematical imaging and vision ( 2014 ) . to appear .",
    "doi 10.1007/s10851 - 013 - 0475-y    r. duits , m. felsberg , g. granlund , and b.m .",
    "ter haar romeny , image analysis and reconstruction using a wavelet transform constructed from a reducible representation of the euclidean motion group , international journal of computer vision , 72 ( 1 ) , 2007 , pp .",
    "79102 .",
    "r. duits , e.m .",
    "franken , left - invariant parabolic evolutions on @xmath1 and contour enhancement via invertible orientation scores , part i : linear left - invariant diffusion equations on @xmath1 , quarterly of applied mathematics , 68 ( 2010 ) , pp .",
    "293331 .",
    "r. duits , e.m .",
    "franken , left - invariant parabolic evolutions on @xmath1 and contour enhancement via invertible orientation scores , part  ii : nonlinear left - invariant diffusions on invertible orientation scores , quarterly of applied mathematics , 68 ( 2010 ) , pp .",
    "255292 .",
    "r. duits , h. fhr , b. janssen , m. bruurmijn , l. florack , h. van assen , evolution equations on gabor transforms and their applications , applied and computational harmonic analysis , vol .",
    "35 , issue  3 ( 2013 ) , pp .",
    "483526 .",
    "franken , enhancement of crossing elongated structures in images , ph.d .",
    "thesis , eindhoven university of technology , 2008 , eindhoven , http://alexandria.tue.nl/extra2/200910002.pdf e.m .",
    "franken , r. duits , crossing - preserving coherence - enhancing diffusion on invertible orientation scores , ijcv , 85 ( 3 ) , 2009 , pp .  253278 .",
    "r. landre , majoration en temps petit de la densit dune diffusion dgnre , probab . theory related fields 74 ( 1987 ) , no .  2 , pp .",
    "r. landre , minoration en temps petit de la densit dune diffusion dgnre , j. funct .",
    "74 ( 1987 ) , no .  2 , pp",
    ".  399414 .",
    "j. petitot , y. tondut , vers une neuro - geometrie .",
    "fibrations corticales , structures de contact et contours subjectifs modaux , mathmatiques , informatique et sciences humaines , ehess , paris , vol .",
    "145 ( 1998 ) , pp .",
    "5101 .",
    "g. sanguinetti , g. citti , a. sarti , image completion using a diffusion driven mean curvature flowin a sub - riemannian space , in : int .",
    "conf . on computer vision theory and applications ( visapp08 ) , funchal , 2008 , pp .",
    "2225 .",
    "zweck , l.r .",
    "williams , euclidean group invariant computation of stochastic completion fields using shiftable - twistable functions , journal of mathematical imaging and vision 21 ( 2 ) , 2004 , pp .  135154 ."
  ],
  "abstract_text": [
    "<S> this paper presents a semi - discrete alternative to the theory of neurogeometry of vision , due to citti , petitot and sarti . </S>",
    "<S> we propose a new ingredient , namely working on the group of translations and discrete rotations @xmath0 .    </S>",
    "<S> the theoretical side of our study relates the stochastic nature of the problem with the moore group structure of @xmath0 . </S>",
    "<S> harmonic analysis over this group leads to very simple finite dimensional reductions .    </S>",
    "<S> we then apply these ideas to the inpainting problem which is reduced to the integration of a completely parallelizable finite set of mathieu - type diffusions ( indexed by the dual of @xmath0 in place of the points of the fourier plane , which is a drastic reduction ) .    </S>",
    "<S> the integration of the the mathieu equations can be performed by standard numerical methods for elliptic diffusions and leads to a very simple and efficient class of inpainting algorithms .    </S>",
    "<S> we illustrate the performances of the method on a series of deeply corrupted images .    </S>",
    "<S> * keywords : * neurogeometry , hypoelliptic diffusion , sub - riemannian geometry , generalized fourier transform </S>"
  ]
}