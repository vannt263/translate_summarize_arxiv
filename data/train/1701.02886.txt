{
  "article_text": [
    "the main claim of this paper is that the christoffel function ( a tool from approximation theory ) can prove to be very useful in statistics and machine learning applications .",
    "the christoffel function is associated with a finite measure and a degree parameter @xmath0 .",
    "it has an important history of research with strong connection to orthogonal polynomials @xcite , interpolation and approximation theory @xcite .",
    "its typical asymptotic behavior as @xmath0 increases is of particular interest because , in some specific settings , it provides very relevant information on the support and the density of the associated input measure .",
    "important references include @xcite in a single dimension , @xcite for specific multivariate settings and @xcite for ratii of mutually absolutely continuous measures .",
    "the topic is still a subject of active research , but regarding properties of the christoffel function , a lot of information is already available .",
    "the present work shows how properties of the christoffel function can be used successfully in some statistics and machine learning applications . to the best of our our knowledge ,",
    "this is the first attempt in such a context with the recent work of @xcite and @xcite .",
    "more precisely , we consider the _ empirical _ christoffel function , a specific case where the input measure is a scaled counting measure uniformly supported on a set ( a cloud ) of datapoints .",
    "this methodology has three distinguishing features : ( i ) it is extremely simple and involves no optimization procedure , ( ii ) it scales linearly with the number of observations ( one pass over the data is sufficient ) , and ( iii ) it is affine invariant .",
    "these three features prove to be especially important in all the applications that we consider .    in @xcite",
    "we have exhibited a striking property of some distinguished family of sum - of - squares ( sos ) polynomials @xmath1 , indexed by their degree ( @xmath2 ) , and easily computed from empirical moments associated with a cloud of @xmath3 points in @xmath4 which we call @xmath5 .",
    "the associated family of sublevel sets @xmath6 , for various values of @xmath7 , approximates the global shape of original cloud of points @xmath5 .",
    "the degree index @xmath0 can be used as a tuning parameter , trading off regularity of the polynomial @xmath8 with the fitness of the approximation of the shape of @xmath5 ( as long as the cloud contains sufficiently many points ) .",
    "remarkably , even with relatively low degree @xmath0 , the sets @xmath9 capture acurately the shape of @xmath5 , and so provides a compact ( algebraic ) encoding of the cloud .",
    "in fact the reciprocal function @xmath10 is precisely the _ christoffel function _",
    "@xmath11 associated to the empirical counting measure supported on @xmath5 and the degree index @xmath0 .",
    "some properties of the christoffel function stemming from approximation theory suggest that it could be exploited in a statistical learning context by considering its empirical counterpart . the purpose of this work is to push this idea further .",
    "in particular we investigate ( a ) further properties of the christoffel function which prove to be relevant in some machine learning applications , ( b ) statistical properties of the empirical christoffel function as well as ( c ) further applications to well known machine learning tasks .",
    "this paper significantly extends @xcite in several directions .",
    "indeed our contribution is threefold :    i. we first provide a thresholding scheme which allows to approximate the compact support @xmath12 of a measure with strong asymptotic guarantees .",
    "this result rigorously establishes the property that , as @xmath0 increases , the scaled christoffel function decreases to zero outside @xmath12 and remains positive in the interior of @xmath12 .",
    "\\ii . in view of potential applications in statistics and machine learning",
    "we provide a rationale for using the empirical christoffel function in place of its population counterpart in the limit of large sample size .",
    "we consider a compactly supported population measure @xmath13 as well as an empirical measure @xmath14 uniformly supported on a sample of @xmath3 vectors in @xmath15 , drawn independently from @xmath13 .",
    "for each fixed @xmath0 we show a highly desirable strong asymptotic property as @xmath3 increases .",
    "namely , the empirical christofell function @xmath16 converges , _ uniformly in @xmath17 _ , to @xmath18 , almost - surely with respect to the draw of the random sample .",
    "we illustrate the benefits of the empirical christoffel function in some important applications , mainly in statistics and machine learning .",
    "the rationale for such benefits builds on approximation properties of the christoffel function combined with our consistency result .",
    "in particular , we first show on simulated data that the christoffel function can be useful for _ density estimation _ and _ support inference_. in @xcite we have described how the christoffel function yields a simple procedure for intrusion detection in networks , and here we extend these results by performing a numerical comparison with well established methods for novelty detection on a real world dataset .",
    "finally we show that the christoffel function is also very useful to perform affine matching and inverse affine shuffling of a dataset .",
    "section [ sec : notations ] describes the notation and definitions which will be used throughout the paper . in section [ sec : christoffelfunction ] we introduce the christoffel function , outline some of its known properties and describe our main theoretical results .",
    "applications are presented in section [ sec : applications ] where we consider both simulated and real world data as well as a comparison with well established machine learning methods . for clarity of exposition",
    "most proofs and technical details are postponed to the appendix in section [ appendix ] .",
    "we fix the ambient dimension to be @xmath19 throughout the text . for example",
    ", we will manipulate vectors in @xmath15 as well as @xmath19-variate polynomials with real coefficients .",
    "we denote by @xmath20 a set of @xmath19 variables @xmath21 which we will use in mathematical expressions defining polynomials .",
    "we identify monomials from the canonical basis of @xmath19-variate polynomials with their exponents in @xmath22 : we associate to @xmath23 the monomial @xmath24 which degree is @xmath25 .",
    "we use the expressions @xmath26 and @xmath27 to denote the graded lexicographic order , a well ordering over @xmath19-variate monomials .",
    "this amounts to , first , use the canonical order on the degree and , second , break ties in monomials with the same degree using the lexicographic order with @xmath28 for example , the monomials in two variables @xmath29 , of degree less or equal to @xmath30 listed in this order are given by : @xmath31 .",
    "we denote by @xmath32 , the set @xmath33 ordered by @xmath27 .",
    "@xmath34 $ ] denotes the set of @xmath19-variate polynomials : linear combinations of monomials with real coefficients .",
    "the degree of a polynomial is the highest of the degrees of its monomials with nonzero coefficients and it is @xmath27 smaller than all other monomials . ] .",
    "we use the same notation , @xmath35 , to denote the degree of a polynomial or of an element of @xmath22 . for @xmath36 , @xmath34_d$ ]",
    "denotes the set of @xmath19-variate polynomials of degree at most @xmath0 .",
    "we set @xmath37 , the number of monomials of degree less or equal to @xmath0 .",
    "we will denote by @xmath38 the vector of monomials of degree less or equal to @xmath0 sorted by @xmath27 , i.e. , @xmath39^{s(d)}_d$ ] . with this notation ,",
    "we can write a polynomial @xmath40_d$ ] as @xmath41 for some real vector of coefficients @xmath42 ordered using @xmath27 . given @xmath43 , @xmath44 denotes the evaluation of @xmath45 with the assignments @xmath46 .",
    "given a borel probability measure @xmath13 and @xmath47 , @xmath48 denotes the moment @xmath49 of @xmath13 , i.e. , @xmath50 .",
    "finally for @xmath51 and every @xmath17 , let @xmath52 be the closed euclidean ball of radius @xmath53 and centered at @xmath54 .",
    "we use the shorthand notation @xmath55 to denote the closed euclidean unit ball . recall that its lebesgue volume @xmath56 satisfies : @xmath57    furthermore ,",
    "let @xmath58 denote the surface of the @xmath19 dimensional unit sphere in @xmath59 . throughout the paper , we will only consider measures of which all moments are finite .      for a finite borel measure @xmath13 on @xmath4 denote by @xmath60 its support , i.e. , the smallest closed set @xmath61 such that @xmath62 .",
    "the moment matrix of @xmath13 , @xmath63 , is a matrix indexed by monomials of degree at most @xmath0 ordered by @xmath27 . for @xmath64 , the corresponding entry in @xmath63",
    "is defined by @xmath65 , the moment @xmath66 of @xmath13 .",
    "when @xmath67 , letting @xmath68 for @xmath69 , we have @xmath70 the matrix @xmath63 is positive semidefinite for all @xmath36 . indeed , for any @xmath71 , let @xmath72_d$ ] be the polynomial with vector of coefficients @xmath73 ; then @xmath74 .",
    "we also have the identity @xmath75 where the integral is understood elementwise .",
    "we denote by @xmath76 \\subset { \\mathbb{r}}[x]$ ] ( resp .",
    "@xmath76_d \\subset { \\mathbb{r}}[x]_d$ ] ) , the set of polynomials ( resp .",
    "polynomials of degree at most @xmath0 ) which can be written as a sum of squares of polynomials .",
    "let @xmath72_{2m}$ ] for some @xmath77 , then @xmath45 belongs to @xmath76_{2m}$ ] if there exists a finite @xmath78 and a family of polynomials @xmath79_m$ ] , @xmath80 , such that @xmath81 .",
    "it is obvious that sum of squares polynomials are always nonnegative .",
    "a further interesting property is that this class of polynomials is connected with positive semidefiniteness .",
    "indeed , @xmath45 belongs to @xmath76_{2m}$ ] if and only if @xmath82 as a consequence , every real symmetric positive semidefinite matrix @xmath83 defines a polynomial in @xmath76_{2m}$ ] by using the representation ( [ eq : equivsos ] ) .",
    "we define a classical @xcite family of orthonormal polynomials , @xmath84 ordered according to @xmath27 , which satisfies for all @xmath85 @xmath86 existence and uniqueness of such a family is guaranteed by the gram - schmidt orthonormalization process following the @xmath27 ordering on monomials and by the positivity of the moment matrix , see for instance @xcite theorem 3.1.11 .",
    "let @xmath87 be the lower triangular matrix of which rows are the coefficients of the polynomials @xmath88 defined in ( [ eq : orthodef ] ) ordered by @xmath27 .",
    "it can be shown that @xmath89 , where @xmath90 is the cholesky factorization of @xmath63 .",
    "furthermore , there is a direct relation with the inverse moment matrix as @xmath91 ( @xcite proof of theorem 3.1 ) .",
    "let @xmath13 be a finite borel measure on @xmath4 with all moments finite and such that its moment matrix @xmath63 is positive definite for every @xmath92 .",
    "for every @xmath0 , define the function @xmath93 by : @xmath94 where the family of polynomials @xmath95 is defined in ( [ eq : orthodef ] ) and the last equality follows from properties of this family ( see also @xcite ) .",
    "the _ kernel _ @xmath96 is a _ reproducing kernel _ on @xmath97 because @xmath98 that is , the @xmath99 are eigenvectors of the associated operator on @xmath97 , and so @xmath100.\\ ] ] the function @xmath101 is called the _ christoffel function _ associated with @xmath13 and @xmath102 . the following result states a fundamental extremal property of the christoffel function .",
    "[ th : christoffel ] let @xmath103 be fixed , arbitrary .",
    "then @xmath104_d}\\:\\left\\{\\int_{{\\mathbb{r}}^p } p(\\x)^2\\,d\\mu(\\x ) : p(\\bxi)\\,=\\,1 \\right\\}.\\ ] ]    the christoffel function plays an important role in orthogonal polynomials and the theory of interpolation and approximation , see _",
    "e.g. _ @xcite .",
    "one is particularly interested in the asymptotics of the normalized christoffel function @xmath105 as @xmath106 .",
    "the subject has a very long history in the univariate case , see @xcite for a detailed historical account prior to the 80 s .",
    "the first quantitative asymptotic result was given in @xcite and was latter improved by @xcite and @xcite . in the multivariate",
    "setting , precise results are known in some particular cases such as balls , spheres and simplices @xcite but much remains to be done for the general multivariate case .",
    "a typical example of asymptotic result is given under quite general ( and technical ) conditions in @xcite .",
    "this work shows that , as @xmath106 , the limit of the ratii , @xmath107 , of two christofell functions associated to two mutually absolutely continuous measures @xmath13 and @xmath108 , converges to the density @xmath109 on the interior of their common support .",
    "[ numeval ] notice that theorem [ th : christoffel ] also provides a mean to compute the numerical value @xmath110 for @xmath111 , fixed , arbitrary .",
    "then indeed ( [ eq : christoffel ] ) is a convex quadratic programming problem which can be solved efficiently , even in high dimension using first order methods such as projected gradient descent and its stochastic variants .",
    "this is particularly interesting when the nonsingular moment matrix @xmath63 is large .",
    "we next provide additional insights on theorem [ th : christoffel ] and solutions of ( [ eq : christoffel ] ) .",
    "[ th - christoffel ] for any @xmath112 , the optimization problem in ( [ eq : christoffel ] ) is convex with a unique optimal solution @xmath113_d$ ] defined by @xmath114 in addition , @xmath115    the proof is postponed to section [ appendix ] .",
    "interestingly , each of the orthonormal polynomials @xmath116 also satisfies an important and well - known extremality property .",
    "[ extremal2 ] let @xmath117 be fixed , arbitrary and let @xmath118 . then up to a multiplicative positive constant , @xmath88 is the unique optimal solution of @xmath119_d}\\,\\left\\{\\,\\int p^2(\\x)\\,d\\mu(\\x):\\ : p(\\x)=\\x^\\alpha+\\sum_{\\beta{<_{gl}}\\ , \\alpha}\\theta_\\beta\\,\\x^\\beta\\,\\quad\\mbox{for some $ \\{\\theta_\\beta\\}_{\\beta { < _ { gl}}\\alpha}$ }   \\right\\}.\\ ] ]    finally , we hilight the following important property which will be useful in the sequel .",
    "[ th : invariance ] @xmath120 is invariant by change of polynomial basis @xmath121 , change of the origin of @xmath15 or change of basis in @xmath15 .       in this section",
    "we consider the important case of the lebesgue measure on a compact set @xmath122 such that @xmath123 .",
    "it is known that in this case the christoffel function encodes information on the set @xmath12 ; see for example the discussion in section [ sec : christo ] . in particular , the scaled christoffel function remains positive on the interior of @xmath12 .",
    "we push this idea further and present a new result asserting that it is possible to recover the set @xmath12 with strong asymptotic garanties by carefuly thresholding the corresponding scaled christoffel function .    for any measurable set @xmath124 , denote by @xmath125 the uniform probability measure on @xmath124 , that is @xmath126 where @xmath127 is the lebesgue measure and @xmath128 is its restriction to @xmath124 ( @xmath129 for any measurable set @xmath130 ) .",
    "the main idea is to use quantitative lower bounds on the scaled christoffel function , @xmath131 , on the interior of @xmath12 ( lemma [ lem : lowerboundin ] ) and upper bounds outside @xmath12 ( lemma [ lem : upperboundout ] ) . in combining these bounds",
    "one proves the existence of a sequence of thresholds of the scaled christoffel function which estimate @xmath12 in a strongly consistent manner .",
    "let us introduce the following notation and assumption .",
    "[ ass : dk ]    * @xmath132 is a compact set such that @xmath123 . *",
    "@xmath133 is a decreasing sequence of positive numbers converging to @xmath134 . for every @xmath135 ,",
    "let @xmath136 be the smallest integer such that : @xmath137 where @xmath138 denotes the diameter of the set @xmath12 , and @xmath139    * @xmath136 is well defined .",
    "indeed , since @xmath140 is positive , the left hand side of ( [ eq : d_k ] ) goes to @xmath134 as @xmath141 while the right hand side remains bounded for increasing values of @xmath136 .",
    "* from the definition of @xmath136 and the fact that @xmath140 is decreasing , the sequence @xmath142 is non decreasing . * given @xmath133 , computing @xmath136 can be done recursively and only requires the knowledge of @xmath138 and @xmath143 . *",
    "a similar condition can be enforced if only upper bounds on @xmath138 and on @xmath143 are available . in this case , replace these quantities by their upper bounds in ( [ eq : d_k ] ) to obtain a similar result .",
    "we are now ready to state the first main result of this section whose proof is postponed to section [ appendix ] for sake of clarity of exposition .",
    "recall the definition of the hausdorff distance @xmath144 between two subsets @xmath145 of @xmath15 : @xmath146    [ th : determinist ] let @xmath132 , @xmath147 , @xmath148 and @xmath149 satisfy assumption [ ass : dk ] . for",
    "every @xmath135 let @xmath150 be the set defined by , @xmath151 then @xmath152 as @xmath153 .",
    "theorem [ th : determinist ] can easily be extended to probability measures that are more general than uniform distributions , in which case we consider the following alternative assumption .",
    "[ ass : dkbis ]    * @xmath132 is a compact set such that @xmath123 .",
    "* the function @xmath154 is integrable on @xmath155 with @xmath156 .",
    "the measure @xmath13 is such that for any measurable set @xmath124 , @xmath157 and @xmath158 .",
    "@xmath133 is a decreasing sequence of positive numbers which limit is @xmath134 . for every @xmath135 ,",
    "let @xmath136 be the smallest integer such that : @xmath159 where @xmath160    under assumption [ eq : d_kbis ] we obtain the following analogue of theorem [ th : determinist ] .",
    "[ th : determinist2 ] let @xmath132 , @xmath161 , @xmath147 , @xmath148 and @xmath149 satisfy assumption [ ass : dkbis ] .",
    "for every @xmath135 , let @xmath162 then @xmath152 as @xmath153 .",
    "the proof is postponed to section [ appendix ] .      in this section",
    "@xmath13 is a probability measure on @xmath4 with compact support @xmath12 .",
    "we focus on the statistical setting where information on @xmath13 is available only through a sample of points drawn independently from the given distribution @xmath13 . in this setting , for every @xmath163 , let @xmath14 denote the empirical measure uniformly supported on an independent sample of @xmath3 points distributed according to @xmath13 .",
    "it is worth emphasizing that in principle @xmath11 is easy to compute and requires the inversion of a square matrix of size @xmath164 , see ( [ eq : defkappa ] ) . alternatively , the numerical evaluation @xmath165 at @xmath166 , fixed arbitrary , reduces to solving a convex quadratic programming problem , which can be done efficiently even in high dimension , see remark [ numeval ] .",
    "our second main result is for fixed @xmath167 and relates the population christoffel function @xmath120 and its empirical version @xmath11 , as @xmath3 increases .",
    "we proceed by distinguishing what happens far from @xmath12 and close to @xmath12 .",
    "first , lemma [ lem : prelimdiscrete ] ensures that both christoffel functions associated with @xmath13 and @xmath14 vanish far from @xmath12 so that the influence of this region can be neglected . on the other hand ,",
    "when closer to @xmath12 one remains in a compact set and the strong law of large numbers allows to conclude .",
    "[ th : discretization ] let @xmath13 be a probability measure on @xmath15 with compact support .",
    "let @xmath168 be a sequence of i.i.d .",
    "@xmath4-valued random variables with common distribution @xmath13 .",
    "for @xmath169 , define the ( random ) empirical probability measure @xmath170 .",
    "then , for every @xmath171 such that the moment matrix @xmath63 is invertible , and as @xmath3 increases , it holds that @xmath172 equivalently @xmath173 where @xmath174 denotes the usual  sup - norm \" .    a detailed proof can be found in section [ appendix ] .",
    "theorem [ th : discretization ] is a strong result which states a highly desirable property , namely that _ almost surely _ with respect to the random draw of the sample , the ( random ) function @xmath16 converges to @xmath18 _ uniformly in @xmath17 _ as @xmath3 increases .",
    "in this section we describe some applications for which properties of the christoffel function prove to be very useful in a statistical context .",
    "we only consider the case of bounded support .",
    "a relevant property of the scaled christoffel function is that it encodes information on the support and the density of a population measure @xmath13 :    * @xcite , @xcite and @xcite provide asymptotic results involving the density of the input measure .",
    "* theorem [ th : determinist ] provides asymptotic results related to the support of the input measure .",
    "the support and density of a measure is of interest in many statistical applications .",
    "however , the aforementioned results are limited to population measures which are not accessible in a statistical setting . in the context of empirical christoffel functions ,",
    "theorem [ th : discretization ] suggests that these properties still hold ( at least in the limit of large samples ) when one uses the empirical measure @xmath14 in place of the population measure @xmath13 .",
    "combining these ideas suggests to use of the empirical chritoffel function in statistical applications such as ( a ) density estimation , ( b ) support inference or ( c ) outlier detection .",
    "this is illustrated on simulated and real world data and we compare the performance with well established methods for the same purpose . finally , we also describe another application , namely _ inversion of affine shuffling _ , whose links with statistics are less clear .    all results presented in this section are mainly for illustrative purposes . in particular ,",
    "the choice of the degree @xmath0 as a function of the sample size @xmath3 was done empirically and a precise quantitative analysis is a topic of future research beyond the scope of the present paper .      , the degree @xmath0 for the christoffel function and the scale parameter @xmath175 for the gaussian kernel .",
    "the black curve shows the population density . ]",
    "most asymptotic results regarding the scaled christoffel function suggest that the limiting behaviour involves the product of a boundary effect term and a density term . hence if one knows both the christoffel function and the boundary effect term , one has access to the density term .",
    "unfortunately , this boundary term is only known in specific situations , the most typical example being the euclidean ball .",
    "hence , in the present state of knowledge , one of the following is assumed to hold true .    *",
    "the support of the population measure @xmath13 is @xmath12 and @xmath176 exists ( possibly unknown ) . *",
    "the support is unknown but contains a set @xmath12 with the same property as above . in this case , we consider the restriction of the population measure @xmath13 to @xmath12 .",
    "note that a sample from the restriction is easily obtained from a sample from @xmath13 by rejection .    in both cases ,",
    "assuming that @xmath13 has a density @xmath177 on @xmath12 , it is expected that the ratii @xmath178 or @xmath179 , converge to @xmath177 .",
    "an example of such a result in the univariate setting is the following .",
    "[ th : density ] suppose that @xmath13 is supported on @xmath180 $ ] with density @xmath181 .",
    "then for almost every @xmath182 $ ] , @xmath183    extensions include @xcite for general support and @xcite for the multivariate setting .",
    "combining theorems [ th : density ] and [ th : discretization ] suggest that the empirical christoffel function can be used for density estimation . for illustration purposes ,",
    "we set @xmath13 to be the restriction of a gaussian to @xmath180 $ ] .",
    "we perform the following experiment for given @xmath184 .    *",
    "generate @xmath185 $ ] sampled independently from @xmath13 . *",
    "compute and plot @xmath186 .",
    "note that @xmath187 is easily derived from the moments of the uniform distribution on @xmath180 $ ] .",
    "the result is presented in figure [ fig : densityest ] and a comparison is given with a classical technique , kernel density estimation @xcite with the gaussian kernel .",
    "the result suggest that empirical christoffel based density estimation is competitive with kernel density estimation in this setting .",
    "it is worth noticing how simple the methodology is with a single parameter to tune .      .",
    "for each value of @xmath3 and @xmath0 , the red line represents the sublevel set @xmath188 , where @xmath189 and @xmath49 is given in assumption [ ass : dk ] . ]    combining theorems [ th : determinist ] and [ th : discretization ] suggest that one may recover the unknown support of a population measure @xmath13 from @xmath3 independant samples by thresholding the scaled empirical christoffel function . in this section",
    "we set @xmath13 to be the uniform probability measure over a star shaped domain in @xmath190 ( see figure [ fig : suppinf ] ) . for different values of",
    "the degree @xmath0 and sample size @xmath3 , we plot in figure [ fig : suppinf ] the corresponding sample and the associated level set @xmath191 , where @xmath189 and @xmath49 is given in assumption [ ass : dk ] .",
    "the results displayed in figure [ fig : suppinf ] show that for well chosen values of @xmath0 and with @xmath49 as in assumption [ ass : dk ] , the support of the population measure is rather well approximated from a finite independent sample .",
    "the results even suggest that a careful tuning of the degree @xmath0 and the threshold level set @xmath49 allows to approximate the support extremely well for larger sample sizes .",
    "of course the degree @xmath0 should be chosen to avoid a form of over - fitting as the results suggest for small sample sizes and large values of @xmath0 .",
    "a precise analysis of this phenomenon is a topic of future research .       &",
    "0.005&0.01&0.02&0.05&0.1&0.2 + 0.01 & 10&17&17 & 17 & 15 & 11 + 0.02 & 2&17 & * 18 * & 17 & 15 & 12 + 0.05 & 8&1 & 14 & * 18 * & 15 & 11 + 0.1 & 9&8 & 12 & 17 & 14 & 11 + 0.2 & 7&9 & 8 & 17 & 14 & 13 + 0.5 & 3&5 & 9 & 15 & 17 & 16 + 1 & 3&6 & 9 & 14 & * 19 * & * 18 * + 2 & 4&4 & 5 & 1 & * 18 * & * 18 * + 5 & 4&3 & 4 & 9 & 12 & 16 + 10 & 5&4 & 4 & 7 & 10 & 15 +     @xmath0&aupr + 1&8 + 2&*18 * + 3&*18 * + 4&16 + 5&15 + 6&13 +     @xmath175&aupr + 0.01&8 + 0.02&1 + 0.05&13 + 0.1&13 + 0.2&12 + 0.5&5 + 1&4 +    in @xcite we suggested that the empirical christoffel function could be used for the purpose of detecting outliers and the claim was supported by some numerical experiments .",
    "the rationale for this is that the empirical christoffel function encodes information about the population density and outliers can be seen as samples from low density areas .",
    "we follow the same line and consider the network intrusion detection task described in @xcite based on the kdd cup 99 dataset @xcite . following the pre - processing described in @xcite , we build up five datasets consisting of network connections represented by labeled vectors in @xmath192 where each label indicates wether the connection was an attack or not .    [ cols=\"^,^,^,^,^,^\",options=\"header \" , ]     all the experiments described in this section are performed on the `` other '' dataset which is the most heterogeneous . the main task is to recover attacks from the collection of points in @xmath192 , ignoring the labels , and then compare the predictions with the ground thruth ( given by the labels ) .",
    "we compare different methods , each of them assign a score to an individual , the higher the score , the more likely the individual is to be an outlier , or an attack .",
    "the metric that we use to compare different methods is the area under the precision recall curve ( aupr ) ; see for example @xcite .",
    "we compare three different methods , each of them producing a score reflecting some degree of outlyingness .",
    "* empirical christoffel function . * kernel density estimation @xcite with gaussian kernel .",
    "the value of the density estimated at each datapoint is used as an outlyingness score .",
    "* one - class svm @xcite with gaussian kernel .",
    "the value of the estimated decision function at each datapoint is used as an outlyingness score .",
    "we used the implementation provided in the ` kernlab ` package @xcite .",
    "the first two methods involve only a single parameter while the last method requires two parameters to be tuned .",
    "the results are given in table [ tab : outlierdetection ] and the corresponding curves can be found in section [ sec : proutlier ] .",
    "table [ tab : outlierdetection ] suggest that one - class svm and the empirical christoffel perform similarly and clearly outperform the kernel density estimation approach .",
    "it is worth noticing here that the one - class svm provides slightly better performances but requires a precise tuning of the second parameter .      , the second one is the image of the first one by an affine transformation .",
    "the colours indicates the correspondance between the two clouds of points which have been recovered by matching the corresponding empirical christoffel functions .",
    "the matching of these values is illustrated on the left with a quantile quantile plot of the empirical chritoffel function values for each datasets .",
    "we applied a @xmath193 transformation for readability and the first diagonal is represented.,title=\"fig : \" ] , the second one is the image of the first one by an affine transformation .",
    "the colours indicates the correspondance between the two clouds of points which have been recovered by matching the corresponding empirical christoffel functions .",
    "the matching of these values is illustrated on the left with a quantile quantile plot of the empirical chritoffel function values for each datasets .",
    "we applied a @xmath193 transformation for readability and the first diagonal is represented.,title=\"fig : \" ]    this last application has fewer connections with statistics .",
    "suppose that we are given two matrices @xmath194 and @xmath195 .",
    "furthermore , we know that there exists an invertible affine mapping @xmath196 such that after a potential permutation of the columns , @xmath197 defines a bijection between the columns of @xmath198 and those of @xmath5 . the problem is to recover the correspondence between the columns of @xmath5 and the columns of @xmath198 , whence the name `` affine shuffling inversion '' .",
    "note that the columns may be shuffled in an arbitrary way and therefore the matching problem is not trivial . in this",
    "setting we can use the affine invariance property of the christoffel function described in theorem [ th : invariance ] .",
    "this is based on the two following observations .    *",
    "the christoffel function only depends on the empirical moments and hence is not sensitive to reshufling of the columns . *",
    "working with the affine image amounts to perform a change of basis and a change of origin . by theorem",
    "[ th : invariance ] , the evaluation of the christoffel function does not change .",
    "this suggests the following procedure .    *",
    "compute @xmath199 and @xmath200 the christoffel functions associated to the columns of @xmath5 and the columns of @xmath198 respectively .",
    "* set @xmath201 to be the vector which @xmath202-th entry is @xmath203 where @xmath204 is the @xmath202-th column of @xmath5 . set @xmath130 similarly .",
    "* match the values in @xmath124 to the values in @xmath130 according to their rank .",
    "the proposed procedure defines a unique permutation between columns of @xmath5 and columns of @xmath198 when there are no ties in the vectors @xmath124 and @xmath130 . in this case ,",
    "theorem [ th : invariance ] ensures that we have found the correct correspondance . in case of ties , the procedure does not allow to elicit completely the correspondance matching .",
    "overall , the method is not garanteed to work but allows to treat simple cases easily .",
    "investigating the robustness of this procedure to noise or to matching mispecification is the subject of future research .",
    "an illustration is given in figure [ fig : affinematching ] where a moon shaped cloud of points in @xmath190 is deformed by an affine transformation and the matching between the points between the two clouds is recovered by matching the corresponding christoffel function values .",
    "the correspondance between christoffel function values is illustrated on a quantile quantile plot .",
    "in this paper we have investigated the potential of the empirical christoffel function for some applications in statistics and machine learning . this question led us to investigate its theoretical properties as well as potential paths toward applications , mostly in a statistical framework .    on the theoretical side , we proposed two main contributions .",
    "the first one provides an explicit thresholding scheme which allows to use the christoffel function to recover the support of a measure with strong asymptotic guarantees .",
    "although this property finds its root in the long history of results regarding asymptotic properties of the christoffel function , we have provided a systematic way to tune the threshold and the degree to ensure strong convergence guarantees .",
    "the second main contribution relates the empirical christoffel function to its population counterpart in the limit of large samples .",
    "this type of results is new and paves the way toward a much more precise understanding of relations between these two objects in a small sample setting .    on the practical side ,",
    "we have illustrated the relevance of the christoffel function as a practical tool in a machine learning context .",
    "in particular , simulations and experiments on real world data support our claim that the empirical christoffel function is potentially useful for density estimation , support inference and outlier detection .",
    "finally , in another application outside the statistical framework ( detection of affine matching between two clouds of points ) , we have again illustrated the potential of the christoffel function as a tool in shape recognition and shape comparison .    both theory and",
    "applications suggest a broad research program . as already mentioned , an important issue is to quantify the deviation of the empirical christofel function from its population counterpart in a finite sample setting .",
    "results in this direction could have both theoretical and practical impacts and would to compare more accurately the performance of christoffel - based approaches with state - of - the art methods .",
    "furthermore , the use of the christoffel function in a statistical framework raises questions specific to each application considered in this paper and will be the subject of future investigations",
    ". finally , there are still important open questions on the christoffel function itself and works in the line of @xcite are of great interest to address applications in statistics .",
    "in the optimization problem ( [ eq : christoffel ] ) the objective function @xmath205 is strongly convex in the vector of coefficients of @xmath19 because @xmath206 and therefore ( [ eq : christoffel ] ) reads @xmath207 , which is a convex optimization problem with a strongly convex objective function .",
    "slater s condition holds ( only one linear equality constraint ) and so the karush - kuhn - tucker ( kkt ) -optimality conditions are both necessary and sufficient . at an optimality solution",
    "@xmath208 they read : @xmath209 for some scalar @xmath210 .",
    "multiplying by @xmath211 yields @xmath212 hence necessarily @xmath213 which is ( [ pstar ] ) .",
    "next , let @xmath214 be the vector with null coordinates except the entry @xmath49 which is @xmath215 . from the definition of the moment matrix @xmath63 ,",
    "@xmath216 which is ( [ th - christoffel-1 ] ) . in particular with @xmath217 , we recover ( [ th - christoffel-2 ] ) , @xmath218                  decompose the measure @xmath226 into the sum , @xmath227 hence , by monotonicity of the christoffel function with respect to addition and closure under multiplication by a positive term ( this follows directly from theorem [ th : christoffel ] ) , we have @xmath228 next , by affine invariance of the christoffel function ( theorem [ th : invariance ] ) , @xmath229 where @xmath55 is the unit euclidean ball in @xmath15 .",
    "the result follows by combining ( [ eq : lowerboundintemp1 ] ) , ( [ eq : lowerboundintemp2 ] ) , lemma [ lem : lowerboundinprelim ] and the fact that @xmath230 .",
    "let @xmath236 be the univariate polynomial of degree @xmath233 , defined by @xmath237 where @xmath238 is the usual chebyshev polynomial .",
    "we have @xmath239 furthermore , for @xmath240 $ ] , we have @xmath241 .",
    "@xmath238 has absolute value less than @xmath215 on @xmath180 $ ] and is inceasing on @xmath242 with @xmath243 , so for @xmath240 $ ] , @xmath244 for @xmath245 $ ] , we have @xmath246 , so @xmath247 let us bound the last quantity .",
    "recall that for @xmath248 , we have the following explicit expresion @xmath249 we have @xmath250 , which leads to @xmath251 where we have used concavity of the @xmath193 and the fact that @xmath252 .",
    "it follows by combining ( [ eq : needlepolytemp1 ] ) , ( [ eq : needlepolytemp2 ] ) , ( [ eq : needlepolytemp3 ] ) and ( [ eq : needlepolytemp4 ] ) , that @xmath253 satisfies the claimed properties .                  by moving the origin at @xmath54 , scaling by @xmath260 and using the affine invariance of the christoffel function ( theorem [ th : invariance ] )",
    ", we may and will assume that the origin @xmath261 is at distance greater than @xmath262 of @xmath12 with @xmath263 , and @xmath12 is contained in the unit euclidean ball @xmath55 . now the polynomial described in lemma [ lem : needlepoly ] provides an upper bound on the christoffel function . indeed for any @xmath264 , we have @xmath265 where we have used @xmath263 to obtain the last inequality . combining lemma [ lem : nd ] and ( [ eq : upperboundouttemp2 ] )",
    ", we obtain for any @xmath264 @xmath266 since in ( [ eq : upperboundouttemp3 ] ) @xmath267 was arbitrary , we obtain in particular @xmath268 the result follows by from ( [ eq : upperboundouttemp4 ] ) by setting @xmath269 .",
    "we take care of both expressions in the definition of @xmath270 separately .",
    "fix an arbitrary @xmath135 , from assumption [ ass : dk ] and lemma [ lem : upperboundout ] , for any @xmath271 such that @xmath272 , @xmath273 from this we deduce that @xmath274 and thus @xmath275 .",
    "since @xmath276 was arbitrary , for any @xmath135 , @xmath277 inequality ( [ eq : deterministtemp1 ] ) allows to take care of one term in the expression of @xmath270 .",
    "let us now consider the second term .",
    "we would like to show that @xmath278 note that the supremum is attained in ( [ eq : deterministtemp2 ] ) .",
    "we argue by contradiction , for the rest of the proof , @xmath279 denotes a fixed positive number which value can change between expressions .",
    "suppose that ( [ eq : deterministtemp2 ] ) is false .",
    "this means that for each @xmath135 ( up to a subsequence ) , we can find @xmath280 which satisfies @xmath281 since @xmath280 and @xmath12 is compact , the sequence @xmath282 has an accumulation point @xmath283 , i.e. , ( up to a subsequence ) @xmath284 as @xmath285 . since @xmath286 is a lipschitz function , combining with ( [ eq : deterministtemp3 ] ) , for every @xmath135 ( up to a subsequence ) , @xmath287 we next",
    "show that ( [ eq : deterministtemp4 ] ) contradicts the assumption @xmath288 . from now on ,",
    "we discard terms not in the subsequence and assume that ( [ eq : deterministtemp4 ] ) holds for all @xmath135 .",
    "combining lemma [ lem : lowerboundin ] and assumption [ ass : dk ] , for every @xmath135 @xmath289 since @xmath288 and @xmath283 , consider a sequence @xmath290 such that @xmath291 as @xmath292 .",
    "since @xmath293 , we have @xmath294 for all @xmath295 .",
    "up to a rearrangment of the terms , we may assume that @xmath296 is decreasing and @xmath297 .",
    "for all @xmath295 , denote by @xmath298 the smallest integer such that @xmath299 .",
    "we must have @xmath300 and we can discard terms so that @xmath298 is a valid subsequence .",
    "we have constructed a subsequence @xmath298 such that for every @xmath301 , @xmath302 and @xmath291 .",
    "this is in contradiction with ( [ eq : deterministtemp4 ] ) and hence ( [ eq : deterministtemp2 ] ) must be true .",
    "the result follows by combining ( [ eq : deterministtemp1 ] ) and ( [ eq : deterministtemp2 ] ) .",
    "the proof of theorem [ th : determinist ] is based on the following fact @xmath303 depending on the regularity of the boundary @xmath304 of @xmath12 , it should be possible to get sharper bounds on the distance as a function of @xmath140 .",
    "this should involve the dependency in @xmath53 of the function @xmath305 for example , if the boundary @xmath304 has bounded curvature , this function is equal to @xmath53 for sufficiently small @xmath53 .",
    "another example , if @xmath306 is the interior region of a non self intersecting continuous polygonal loop , then the function is of the order of @xmath307 , where @xmath210 is the smallest angle between two consecutive segments of the loop .",
    "lemma [ lem : lowerboundin ] holds with @xmath13 in place of @xmath226 and @xmath308 in place of @xmath309 .",
    "indeed , we have @xmath310 and the rest of the proof remains the same with different constants .",
    "similarly , lemma [ lem : upperboundout ] holds with @xmath13 in place of @xmath226 , indeed , the proof only uses the fact that @xmath226 is a probability measure supported on @xmath12 which is also true for @xmath13 .",
    "the proof then is identical to that of theorem [ th : determinist ] by reflecting the corresponding change in the constants .",
    "set @xmath312 , that is @xmath313 and : @xmath314 consider the affine function @xmath315 for any @xmath316 , we have @xmath317 where we have used cauchy - schwartz and triangular inequalities .",
    "furthermore , we have for any @xmath316 , @xmath318 where we have used equation ( [ eq : prelimdiscrete1 ] ) .",
    "consider the affine function @xmath319 .",
    "we have @xmath320 where the inequalities are obtained by combining ( [ eq : prelimdiscrete3 ] ) and ( [ eq : prelimdiscrete4 ] ) .",
    "the result follows from ( [ eq : prelimdiscrete1 ] ) , ( [ eq : prelimdiscrete5 ] ) and theorem [ th : christoffel ] .",
    "first let us consider measurability issues .",
    "fix @xmath3 and @xmath0 such that @xmath321 is invertible .",
    "let @xmath5 be a matrix in @xmath322 , we use the shorthand notation @xmath323,\\,p(\\z)=1 } \\frac{1}{n}\\sum_{i=1}^n p(\\x_i)^2 ,      \\end{aligned}\\ ] ] where for each @xmath202 , @xmath204 is the @xmath202-th column of the matrix @xmath5 .",
    "this corresponds to the empirical christoffel function with input data given by the columns of @xmath5 .",
    "consider the function @xmath324 $ ] defined as follows : @xmath325 it turns out that @xmath326 is a semi - algebraic function ( its graph is a semi - algebraic set ) . roughly speaking",
    "a set is semi - algebraic if it can be defined by finitely many polynomial inequalities .",
    "we refer the reader to @xcite for an introduction to semi - algebraic geometry , we mostly rely on content from chapter 2 .",
    "first , the function @xmath327 is semi - algebraic ( by identifying the space of polynomials with the euclidean space of their coefficients ) and the set @xmath328 is also semi - algebraic .",
    "partial minimization can be expressed by a first order formula , and , by tarski - seidenberg theorem ( see _ e.g. _ ( * ? ? ?",
    "* theorem 2.6 ) ) , this operation preserves semi - algebraicity .",
    "hence , the function @xmath329 is semi - algebraic .",
    "furthermore , theorem [ th : christoffel ] ensures that @xmath330 for any @xmath331 , where @xmath332 is a polynomial in @xmath331 and",
    "hence @xmath333 is semi - algebraic .",
    "finally absolute value is semi - algebraic and using a partial minimization argument again , we have that @xmath326 is a semi - algebraic function .    as a semi - algebraic function , @xmath326 is borel measurable . indeed , using the _ good sets principle _",
    "( @xcite  1.5.1 , p. 35 ) it is sufficient to prove that , for an arbitrary interval - field @xmath334)$ ] is generated by the intervals @xmath335 $ ] of @xmath336 $ ] ; see @xcite  1.4.6 , p. 27 . ]",
    "@xmath335\\subset [ 0,1]$ ] , @xmath337)\\in\\mathcal{b}(\\r^{p\\times n})$ ] .",
    "any such set is the pre - image of a semi - algebraic set by a semi - algebraic map . as proved in (",
    "* corollary 2.9 ) , any such set must be semi - algebraic and hence measurable .",
    "thus , with the notations of theorem [ th : discretization ] , @xmath338 is indeed a random variable for each fixed @xmath339 such that @xmath321 is invertible .",
    "we now turn to the proof of the main result of the theorem . for simplicity",
    "we adopt the following notation for the rest of the proof . for any continuous function @xmath340 , and any subset @xmath341 , @xmath342 } ,      \\end{aligned}\\ ] ] which could be infinite .",
    "we prove that for any @xmath343 , @xmath344 where the probability is taken with respect to the random choice of the sequence of independent samples from @xmath13 and the limit supremum is understood setwise with respect to the underlying events .",
    "fix @xmath343 .",
    "denote by @xmath12 the compact support of @xmath13 .",
    "note that @xmath12 is also the support of @xmath14 with probability one .",
    "from lemma [ lem : prelimdiscrete ] , we have an upper bound on both @xmath11 and @xmath120 of order @xmath345 which holds with probability one .",
    "hence , it is possible to find a compact set @xmath346 containing @xmath12 ( with complement @xmath347 ) such that , almost surely , @xmath348 next , we have the following equivalence @xmath349 on the other hand , since both functions are non negative , from equation ( [ eq : discretization3 ] ) , almost surely , @xmath350 hence the second event in the right hand side of ( [ eq : discretization4 ] ) occurs with probability zero . as a consequence , except for a set of events of measure zero",
    ", we have @xmath351 which in turn implies @xmath352 by assumption the moment matrix @xmath63 is invertible and by the strong law of large numbers , almost surely , @xmath353 must be invertible for sufficiently large @xmath3 .",
    "assume that @xmath353 is invertible , we have @xmath354 using the strong law of large numbers again , almost surely , for @xmath3 sufficiently large , the smallest eigenvalue of @xmath355 is close to that of @xmath356 and hence bounded away from zero . since the first coordinate of @xmath357 is @xmath215 , the denominator in ( [ eq : discretization8 ] ) is bounded away from zero almost surely for sufficiently large @xmath3 .",
    "in addition , since @xmath358 is compact , @xmath357 is bounded on @xmath358 and there exists a constant @xmath359 such that , almost surely , for sufficiently large @xmath3 , @xmath360 where the matrix - norm in the right hand side is the operator norm induced by the euclidean norm . combining ( [ eq : discretization7 ] ) and ( [ eq : discretization9 ] ) , we obtain @xmath361 the strong law of large numbers and the continuity of the matrix inverse @xmath362 at @xmath13 ensure that the right hand side of ( [ eq : discretization10 ] ) is @xmath134 .",
    "this concludes the proof .",
    "this section displays the curves from which the aupr scores were measured in section [ sec : apploutlier ] .",
    "christoffel function and kernel density estimation are presented in figure [ fig : prchristo ] and the one - class svm is presented in figure [ fig : proneclass ] . a detailed discussion",
    "the experiment is given in section [ sec : apploutlier ] .    .",
    "right : kernel density estimation with gaussian kernel and varying scale parameter @xmath175.,title=\"fig : \" ] .",
    "right : kernel density estimation with gaussian kernel and varying scale parameter @xmath175.,title=\"fig : \" ]                l.  bos and b.  della vecchia and g.  mastroianni ( 1998 ) .",
    "on the asymptotics of christoffel functions for centrally symmetric weight functions on the ball in @xmath365 . rend .",
    "palermo 2(52):277290 .",
    "g.  williams , r.  baxter , h.  he , s.  hawkins and l.  gu ( 2002 ) . a comparative study of rnn for outlier detection in data mining .",
    "ieee international conference on data mining ( p. 709 ) .",
    "ieee computer society ."
  ],
  "abstract_text": [
    "<S> we illustrate the potential in statistics and machine learning of the christoffel function , or more precisely , its empirical counterpart associated with a counting measure uniformly supported on a finite set of points . </S>",
    "<S> firstly , we provide a thresholding scheme which allows to approximate the support of a measure from a finite subset of its moments with strong asymptotic guaranties . </S>",
    "<S> secondly , we provide a consistency result which relates the empirical christoffel function and its population counterpart in the limit of large samples . </S>",
    "<S> finally , we illustrate the relevance of our results on simulated and real world datasets for several applications in statistics and machine learning : ( a ) density and support estimation from finite samples , ( b ) outlier and novelty detection and ( c ) affine matching </S>",
    "<S> .    [ section ] [ thm]corollary [ thm]lemma [ thm]proposition    [ thm]definition [ thm]assumption [ thm]remark        c  v u </S>"
  ]
}