{
  "article_text": [
    "network structure has a profound influence over disease dynamics .",
    "there is growing acknowledgement of this fact in the epidemiology literature ( see @xcite for a review ) , where the question of how best to quantify and predict network effects is becoming a central challenge @xcite . at the same time ,",
    "network epidemic models are of considerable interest to the theoretical physics community @xcite , serving as a canonical example of a non - equilibrium process , and providing fertile ground for the application of statistical mechanics techniques to new and interesting problems .",
    "one such technique is the cavity method : invented to tackle problems in statistical inference @xcite and condensed matter physics @xcite , this simple and versatile method has found application in areas as diverse as computer science @xcite and random matrix theory @xcite .",
    "the cavity method was first applied to epidemiology in @xcite ( using the alternative moniker of ` message - passing ' ) , to calculate the expected time development of a network epidemic .",
    "the principle advance provided by the method in that work was the ability to model non - markov epidemics , in which the time that a node remains infective ( the lifetime distribution , or infectious period ) is not a simple memoryless exponential distribution . under a second alias of ` belief -",
    "propagation ' , it has also been applied to the problem of tracing the most likely source of a disease outbreak @xcite .",
    "this work points to another advantage offered by the cavity method ; that it is not restricted to calculating macroscopic quantities , but can provide information about the behaviour of individual nodes . indeed , it is now well - recognised that population heterogeneity can play a very important role in disease outbreaks @xcite .    in this article , we show how to calculate a measure of the infection risk that a particular node poses to the network , as well as the risk posed by the network to the node .",
    "these quantities are manifested in two different realisations of the cavity method , one with ` upstream ' cavities , the other ` downstream ' .",
    "the derivation of the cavity equations for the risk and vulnerability measures is given in the next section , followed by a discussion of their numerical solution .",
    "we then address the role of the lifetime distribution of the disease , which controls the probability of an outbreak occurring , but paradoxically has no effect on its final size .",
    "finally , we show how the cavity method can be used to rank nodes according to their risk or vulnerability , and how these rankings exhibit curious dependencies on the disease dynamics .",
    "consider the spread of a disease over the nodes of a network . in a small period of time @xmath0 each infected node has a chance @xmath1 of transmitting the infection to an uninfected neighbour , and a chance @xmath2 of recovering from the disease",
    ". recovered nodes can not be reinfected .",
    "this is an sir epidemic with poisson rate infections ( @xmath3 is a positive constant ) and general disease lifetime distribution @xmath4 .",
    "write @xmath5 for the risk that a major outbreak occurs if node @xmath6 is the sole initial infective .",
    "thinking about the limit of very large networks , we make an artificial distinction between the local area around node @xmath6 , and the rest of the network , which we call the ` bulk ' .",
    "we will say a major outbreak occurs if node @xmath6 succeeds in transmitting the infection a to non - zero fraction of the bulk . to compute an approximation to this quantity",
    ", we examine the spread of the disease away from the initial infection .    ) considers the onward spread after removing an upstream neighbour ( i.e. closer to the source of the infection ) , whilst ( [ cav_down ] ) considers the chance of infection with a downstream neighbour removed . in both cases",
    "the tree approximation amounts to assuming that the up- and downstream neighbours are uniquely defined . ]",
    "we begin by calculating the probability that @xmath6 infects all the vertices in some subset @xmath7 of its neighbours @xmath8 , and no others .",
    "the fates of these nodes are correlated by their joint exposure to the random length of the infectious period of @xmath6 ; a long infectious period implies that nearly all neighbours will catch the disease , and the opposite holds if @xmath6 is infectious only for a very short time .",
    "if the infectious period has probability density @xmath4 , then we may write @xmath9 after @xmath6 has infected some of its neighbours , the continued survival of the disease depends on those neighbours propagating the infection away from @xmath6 .",
    "summing over all possible collections of infected neighbours we find @xmath10 where @xmath11 is the probability of a major outbreak in a network where each @xmath12 is initially infected , and _",
    "node @xmath6 has been removed_. in words , this equation says that the disease starting at @xmath6 dies out if , whenever @xmath6 infects a set @xmath7 , the disease starting at @xmath7 also dies out .",
    "the task now is to express @xmath11 in terms of the @xmath13 .",
    "if the network contains cycles , then some nodes will be reachable from two or more members of @xmath7 , yet only at most one can succeed in passing the infection .",
    "this gives rise to the inequality @xmath14 to compute a lower bound on @xmath15 it will therefore suffice to assume equality in ( [ cav_approx ] ) .",
    "this approximation is equivalent to assuming that the network is large and tree - like .",
    "as we will see , the results remain surprisingly accurate for networks which do not fit this assumption very well .",
    "indeed the `` unreasonable effectiveness '' of tree approximations appears to be a quite general phenomenon for network processes @xcite .",
    "inserting ( [ pij ] ) and ( [ cav_approx ] ) into ( [ rhoi1 ] ) and assuming equality we can compute @xmath16 where @xmath17    the problem of computing the risk to the network posed by node @xmath6 has thus been transformed in to that of computing the risk posed by the neighbours of @xmath6 in the cavity graph . repeating the same calculations for @xmath13 allows us to derive a closed set of equations @xmath18 these are the upstream cavity equations .",
    "the derivation requires the additional assumption that the risk posed by @xmath19 in the network with @xmath6 and @xmath20 both removed is well - approximated by @xmath21 , that is , we ignore any alternative path between @xmath19 and @xmath6 .",
    "if we are able to solve these equations ( more on this later ) , the results can be fed into equation ( [ r_eq ] ) to provide us with an estimate of the probability of any given node causing a major outbreak .",
    "we may also ask how vulnerable node @xmath6 is to an outbreak that starts somewhere else in the network . write @xmath22 for the probability that @xmath6 is eventually infected in the event of a major outbreak . to compute the cavity approximation for vulnerability",
    ", we trace the possible path of the disease downstream from the bulk to node @xmath6 .",
    "the calculation is somewhat easier in this case , since each neighbour of @xmath6 has an independent chance to attempt to infect it .",
    "this means that the detail of the distribution of infectious periods no longer matters , only the overall chance of an infection , @xmath23 ( known as the _ transmissibility _ ) .",
    "the result , previously derived in @xcite , is @xmath24 where the downstream cavity equations are @xmath25    the distinction between the up- and downstream cavity equations should hopefully be clear : see figure [ drawing ] for a cartoon illustration .",
    "it should also be noted that there is a close relationship between the cavity equations , and the equation for survival probability of a multi - type branching process @xcite .",
    "this should not be surprising as the cavity equations are derived from considerations of the early development of the epidemic , where the branching process approximation is known to apply @xcite .",
    "typically , non - trivial solutions to the cavity equations in either direction can not be found by hand .",
    "fortunately , for general networks the cavity equations are stable under iteration and can be numerically solved to high accuracy with little computational cost . to do this efficiently ,",
    "it is helpful to map to a new network encoding the relations between edges in the cavity equations .",
    "each undirected edge @xmath26 spawns two nodes , @xmath27 and @xmath28 . between two nodes @xmath29 and @xmath30 in the new network , we draw a directed edge from @xmath31 to @xmath32 if @xmath33 is involved in the cavity equation for @xmath34 , that is , if @xmath35 and @xmath36 .",
    "the adjacency matrix @xmath37 of this network is known as the non - backtracking , or hashimoto @xcite , matrix .",
    "it has recently been shown to be of use in spectral clustering @xcite , and occurs in the calculation of the percolation threshold in sparse networks @xcite . using this construction ,",
    "the upstream and downstream cavity equations can be rewritten as @xmath38 where @xmath39 and @xmath40 are the vector functions @xmath41 starting from the initial vector @xmath42 for all @xmath31 , solutions to ( [ udeq ] ) can be found by repeatedly applying the maps @xmath39 or @xmath40 . for @xmath43 ,",
    "the quantity @xmath44 describes the risk that the disease spreads at least distance @xmath45 from node @xmath20 in the absence of node @xmath6 .",
    "similarly , @xmath46 gives the risk that @xmath20 is infected if all nodes in the cavity network of distance greater than @xmath45 are themselves infected .",
    "clearly these quantities are decreasing with @xmath45 and bounded from below by zero , hence the iteration scheme is guaranteed to converge .    for efficient numerical implementation , the integrals ( [ deft ] )",
    "should of course be precomputed ( indeed this can be accomplished analytically whenever the laplace transform of @xmath47 is known ) .",
    "it is possibly less obvious that often a substantial speed - up can be gained by also precomputing the explicit form of cavity equations themselves .",
    "that is , rather than having the computer loop through the subsets @xmath48 during each iteration step , an explicit iteration function can be procedurally generated from ( [ ud ] ) before starting the main loop .",
    "notice that the upstream and downstream equations ( [ udeq ] ) both admit zero as a solution , since it is always possible that the disease fails to spread .",
    "for some parameter values , the zero solution is unstable and the cavity equations admit a solution in @xmath49 corresponding to disease outbreak .",
    "the regimes of extinction and outbreak are separated by a percolation phase transition , and the critical parameter values can be determined by examining the stability of the maps @xmath39 and @xmath40 around zero . from ( [ ud ] )",
    "we compute @xmath50 where @xmath51 is the indicator function giving one for true arguments and zero for false . at the zero fixed point ( @xmath52 for all @xmath31 ) we find that the jacobian matrix is the same for both systems , @xmath53 where @xmath37 is the non - backtracking matrix .",
    "major outbreaks are therefore only possible if @xmath54 , where @xmath55 is the critical value for the percolation transition .",
    "note that the transition point is the same for all nodes , regardless of any heterogeneity in the network .",
    "as shown in @xcite , the role of @xmath56 is a general result for percolation processes on sparse networks .",
    "as briefly mentioned earlier , although the probability of a major outbreak occurring depends on the detail of the lifetime distribution of the disease , the chance of a particular node catching the disease does not .",
    "two different diseases may have the same transmissibility @xmath23 , but one may be more dangerous than the other by virtue of the fact that it is more likely to cause a major outbreak . for fixed transmissibility , which lifetime distribution @xmath4 is the most dangerous ?    to maximise the chance of an outbreak occurring , the disease must guard against the possibility of it dying out in the early stages of its spread .",
    "this is achieved by having a _ deterministic _ infectious period @xmath57\\right)\\,.\\ ] ] mathematically , this follows from jensen s inequality . moving the power of @xmath45 outside the integral in equation ( [ deft ] )",
    "we find that for @xmath58 we have @xmath59 . from the cavity equations ( [ cav_up ] )",
    "we then deduce @xmath60 with equality if and only if @xmath4 is a delta function .",
    "this result was mentioned in @xcite , and goes back to older work using percolation theory @xcite .     and",
    "weibull - distributed lifetimes , on a random 4-regular network with @xmath61 nodes .",
    "thin dark lines show the results of simulations for the fraction of outbreaks affecting more than 10% of the populations always ( lower , purple ) and the average final size of those outbreaks ( upper , green ) .",
    "fat pale lines correspond to the risk and vulnerability predictions of the cavity method .",
    "the dashed line shows the theoretical lower bound for risk , computed using equation ( [ r_geq ] ) .",
    "the centre line @xmath62 corresponds to markov dynamics . ]",
    "we may also ask how low the probability of an outbreak can get when @xmath23 is fixed .",
    "it follows immediately from the definition ( [ deft ] ) that the sequence @xmath63 is positive and decreasing .",
    "thus @xmath64 this rough bound gives the intuition that the risk is minimal when the decay rate of @xmath63 is also minimal .",
    "to achieve this requires a lifetime distribution that is sharply peaked at zero and has a heavy tail .",
    "the weibull family of distributions @xcite describe the time to failure in systems depending on several components , and are a natural choice to model non - markov disease lifetime distributions ( as used in @xcite , for example ) .",
    "in fact , they nicely illustrate the full range of behaviours between the upper and lower bounds given above .",
    "figure [ wei ] shows the results of simulations of epidemics with weibull - distributed lifetimes , @xmath65 , where the parameter @xmath66 controls the shape of the distribution .",
    "the infection rate was held constant at @xmath67 and the same random 4-regular random network was used for each sample .",
    "small values of @xmath66 correspond to the hazard rate of the disease getting smaller as it survives longer .",
    "this makes the decay of @xmath63 slower , and the outbreak probability approaches its theoretical minimum .",
    "the special case @xmath62 corresponds to markov disease dynamics ( i.e. exponential lifetime distribution ) . for large @xmath66 the weibull distribution approaches a delta function and risk",
    "is maximised .    finally , we point out that the line for risk in figure ( [ wei ] ) stays below the line for vulnerability .",
    "this is a general fact .",
    "notice that the right - hand - side of equation ( [ r_leq ] ) exactly corresponds to the form of the downstream cavity equations ( [ cav_down ] ) .",
    "we can conclude that @xmath22 provides an upper bound for @xmath5 .",
    "that is to say , the probability that node @xmath6 will cause a major outbreak if they are the source is always less than their chance of being infected by an outbreak that starts elsewhere .",
    "in a random network of @xmath68 nodes with degrees five and three ( in @xmath69 ratio ) , generated by the configuration model , with markov ( @xmath70 ) disease dynamics .",
    "grey lines show the result of the cavity equations , with nodes number 10 and 75 highlighted in solid green and dashed blue , respectively .",
    "circles and diamonds show the results of stochastic simulations for these two nodes , averaged over @xmath71 samples . ]    we know from the previous section that the vulnerability of a node always exceeds its risk , but how do the risks and vulnerabilities of different nodes in the same network compare ? for a given network and choice of @xmath3 and @xmath4 , the cavity equations can be used to determine @xmath5 and @xmath22 for every node , and this information may be used to rank the nodes according to the risk they pose to the network , or the risk the network poses to them . as we will see , these rankings depend in detail on the nature of the disease .",
    "let us begin by examining vulnerability ranking .",
    "node vulnerability depends on the disease specification only through @xmath23 , so for simplicity we consider markov dynamics , fixing @xmath70 . to generate figure [ vul_rank ] ,",
    "a single random network of @xmath68 nodes was created using the configuration model , and the vulnerability of its nodes computed for various @xmath3 using the cavity method .",
    "two things are immediately noticeable from the plot : ( i ) there is a great deal of heterogeneity between nodes , and ( ii ) the rank order of vulnerability is not preserved as @xmath3 is varied .",
    "in particular , node 10 is more vulnerable than node 75 to less virulent diseases , yet is less vulnerable to more virulent ones .    to help explain this counter - intuitive finding",
    ", we explore the behaviour of the cavity equations near the limits of strongly infectious ( @xmath72 ) and weakly infectious ( @xmath73 ) diseases . differentiating the vulnerability equation ( [ vul ] ) with respect to @xmath23",
    ", we have @xmath74 where @xmath75 is used as short - hand for @xmath76 .",
    "now , as @xmath77 we have @xmath78 also , therefore the product above gives zero unless it is empty .",
    "that is , @xmath79 as @xmath77 unless @xmath6 has only one neighbour . in general , the first non - zero derivative of @xmath22 at @xmath72 is @xmath80 similarly , we differentiate the downstream cavity equations ( [ cav_down ] ) to find that , at @xmath72 , @xmath81 is only non - zero if @xmath20 has exactly one other neighbour @xmath82 , in which case @xmath83 .",
    "tracing a path away from @xmath6 in the direction of @xmath20 we must eventually , after @xmath84 steps reach a node with degree not equal to two ( recall that we ignore the possibility of cycles ) , whose cavity derivative in either case will be zero .",
    "we conclude that @xmath85 .",
    "turning attention now to the percolation transition , we set @xmath86 , where we have @xmath87 . therefore , from ( [ vul_diff ] ) , @xmath88 to make progress , let us suppose that there is some bulk network @xmath37 , which we assume has no special structure and we have solved the cavity equations for that network . to find the value of @xmath89 , we must carry out the expansion above for all paths @xmath90 from @xmath6 to the bulk @xmath37 .",
    "we may write @xmath91 where @xmath92 is the mean cavity vulnerability in the bulk .    bringing the above results together",
    ", we have for each node @xmath6 a pair of expansions , @xmath93 the qualitative insight provided by these equations is the following : vulnerability to highly infectious diseases is mainly controlled by the number of neighbours a node has , whereas vulnerability to weakly infectious diseases depends more subtly on the number and length of paths connecting the node to the infected bulk . the puzzling case of nodes 10 and 75 in figure [ vul_rank ] is explained thus : node 75 has higher degree ( five , compared to three ) , yet is the source of just 91 paths of length three , compared to 136 for node 10 .",
    "we can therefore expect node 10 to more vulnerable close to @xmath55 , but less vulnerable for large @xmath23 .",
    "as one might expect in light of the above , the ranking of nodes according to their risk @xmath5 is also not preserved under varying @xmath3 .",
    "more interestingly , risk rankings are additionally sensitive to the memory characteristics of the disease .",
    "figure [ rel_wei ] shows the result of the cavity equations in a random network with maximum degree five , for weibull distributed infectious periods with @xmath66 varying across two orders of magnitude .",
    "this time @xmath3 has also been varied simultaneously in order to keep @xmath23 fixed .",
    "although node risk is broadly correlated with degree , this is not a hard rule : there is considerable variation , and many changes to the risk ranking occur as @xmath66 is varied ( even though node vulnerability does not change since @xmath23 is held constant ) .",
    "curiously , markov dynamics @xmath62 appear to represent an extreme case , with most nodes experiencing either their highest or lowest relative risk at that point .    , with @xmath3 varied so as to hold constant @xmath94 .",
    "each solid line corresponds to a different node , shaded according to degree ( lighter shades are higher degree ) ; the dashed line gives the mean risk @xmath95 .",
    "right : close up of relative risk @xmath96 for several nodes ; crossing lines correspond to changes in the risk ranking . ]",
    "in the work presented above we have seen how the cavity method can be used to calculate measures of vulnerability and risk in network epidemic models .",
    "the vulnerability of a node to an ongoing outbreak is recovered from the solution of the downstream cavity equations ( [ cav_down ] ) , while the risk of an outbreak occurring with a given starting node is found by the upstream cavity equations ( [ cav_up ] ) .",
    "node vulnerability was found to be independent of the details of the disease lifetime distribution , however , some nodes are more vulnerable than others to weaker infections , yet less vulnerable to stronger ones",
    ". this fact can be understood by an analysis of cavity equations with parameters in the neighbourhood of percolation and complete infection .",
    "the story for node risk is even more complex , as it depends on the memory characteristics of the disease in a non - trivial way . in particular",
    ", we saw how risk is maximised by diseases with deterministic lifetime distributions .",
    "this result suggests that real - world diseases , which are subject to evolutionary pressure to optimise their chance of spreading , should have infectious periods that are much less variable than the equivalent exponential distribution , and indeed this appears to be the case @xcite .",
    "this dependence on disease memory also carries over to the node risk rankings , as seen in figure [ rel_wei ] .",
    "the main drawback of the method is , of course , the reliance on a tree approximation .",
    "although the method has performed well for all the networks considered in this article ( despite most of them containing many cycles ) , accurate predictions can not be made for networks with specific structure that favours the existence of cliques or short cycles .",
    "this is a common problem in the study of epidemics on networks , which is usually tackled via ` moment closure ' methods for differential equations @xcite .",
    "indeed an explicit link has been made between the cavity method and a particular moment closure scheme @xcite .",
    "looking to the future , three interesting questions remain unanswered : ( i ) why do node risk rankings depend on the memory properties of the disease ?",
    "( ii ) why do markov dynamics extremise relative risk ? ( iii ) how might the results described here be modified in networks with high local clustering ? beyond these problems , several straightforward extensions to the work described here are possible .",
    "one may choose to study non - markov infection rates , although this only has the effect of changing the definition of @xmath97 .",
    "more interestingly , fully time - dependent cavity equations can be derived to give a more detailed view of the disease progression ( as was originally done for vulnerability in @xcite ) , and recent work has shown how the method may be used to infer the origin of an outbreak @xcite . for added realism in applications ,",
    "further heterogeneity can be introduced by allowing @xmath3 and @xmath47 to vary across the network .",
    "more generally , the cavity method is widely applicable to other models of cascades on networks , for example , meme spread in social networks or systemic risk in financial markets .",
    "simon cauchemez , achuyt bhattarai , tiffany  l marchbanks , ryan  p fagan , stephen ostroff , neil  m ferguson , david swerdlow , samir  v sodha , mria  e moll , frederick  j angulo , et  al . role of social networks in shaping disease transmission during a community outbreak of 2009 h1n1 pandemic influenza . , 108(7):28252830 , 2011 ."
  ],
  "abstract_text": [
    "<S> which nodes are most vulnerable to an epidemic spreading through a network , and which carry the highest risk of causing a major outbreak if they are the source of the infection ? here </S>",
    "<S> we show how these questions can be answered to good approximation using the cavity method . </S>",
    "<S> several curious properties of node vulnerability and risk are explored : some nodes are more vulnerable than others to weaker infections , yet less vulnerable to stronger ones ; a node is always more likely to be caught in an outbreak than it is to start one , except when the disease has a deterministic lifetime ; the rank order of node risk depends on the details of the distribution of infectious periods . </S>"
  ]
}