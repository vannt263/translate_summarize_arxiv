{
  "article_text": [
    "the constant perturbation methods form a class of numerical methods which were originally devised for the solution of the time - independent one - dimensional schrdinger equation .",
    "the first ideas were described in the seventies ( see @xcite for references ) but the cp methods still prove to be very efficient for not only the one - dimensional time - independent schrdinger equation @xcite but also for sturm - liouville problems @xcite , coupled channel schrdinger equations @xcite and two - dimensional schrdinger problems @xcite .",
    "as noted in @xcite , the cp approach is very closely related to the application of a modified neumann method .",
    "modified neumann methods , as well as cp methods , are very effective for highly oscillatory ordinary differential equations , see @xcite . in the current paper",
    "we extend the techniques to the solution of time - dependent schrdinger problems involving explicitly time - dependent hamiltonians .",
    "we consider the time - dependent schrdinger equation ( in units where @xmath0 ) : @xmath1 with the one - dimensional time - dependent hamiltonian @xmath2 and @xmath3 as the wave function at initial time @xmath4 .",
    "@xmath5 is the reduced mass .",
    "standard techniques found in literate reduce to the solution of a linear ordinary differential equation in @xmath6 of the form @xmath7 where @xmath8 is a column vector with @xmath9 complex components and @xmath10 is an @xmath11 hermitian matrix associated to the hamiltonian .",
    "equation arises when the spatial variable @xmath12 is discretized .",
    "then the entries of @xmath13 are values of the wave function @xmath14 at the nodes of the spatial grid .",
    "equation can also result from a spectral decomposition in which the solution @xmath14 is expanded over @xmath9 eigenfunctions of a time - independent hamiltonian , e.g.  a harmonic oscillator , and the @xmath13 represent the coefficients in this basis set expansion .    instead of taking a fixed set of basis eigenfunctions of a time - independent hamiltonian over the entire @xmath6-range , we will use similar ideas as those proposed in @xcite to tackle 2d stationary equations in an efficient way . in @xcite ixaru",
    "introduced a sectorwise expansion of the 2d solution over eigenfunctions from conveniently tuned 1d hamiltonians . in a similar way",
    ", we divide here the @xmath6-domain in sectors and use in each sector a different time - independent hamiltonian to form the set of eigenfunctions . by choosing in each sector a time - independent hamiltonian which takes into account the form of the potential @xmath15 over this sector , the number @xmath9 of time - independent stationary solutions needed for the expansion can be kept low .",
    "the efficient solution of stationary schrdinger problems forms a crucial part in the proposed spatial discretization . to compute the eigenvalues and the corresponding eigenfunctions , we make use of the highly accurate and efficient cp methods and codes which are available for solving time - independent schrdinger problems . also for the propagation of the time - dependent solution @xmath16 over a sector",
    ", we will use cp - based techniques . by using a cp approach",
    "we are able to tackle the oscillations which can be present both in time and space without the necessity of small steps .",
    "we take the time - dependent equation and assume that the @xmath12-range can be restricted to @xmath17 $ ] and that dirichlet boundary conditions can be imposed in the endpoints @xmath18 and @xmath19 .",
    "first the @xmath20-domain is divided in a succession of rectangular sectors as illustrated in figure [ fig1 ] .",
    "the mesh points on the @xmath6-axis need not to be equidistant . on each rectangular subdomain @xmath17\\times[t_{k-1},t_k]$ ]",
    "the original time - dependent potential function @xmath15 is approximated by the time - independent function @xmath21}(x)=v(x,(t_{k-1}+t_k)/2)$ ] .",
    "when doing this approximation over each sector , we obtain an approximation of the original @xmath15 with a staircase shape in the @xmath6-direction , see figure [ fig2 ] .         and its sectorwise approximation @xmath22.,title=\"fig:\",width=226 ]   and its sectorwise approximation @xmath22.,title=\"fig:\",width=226 ]    let us focus on the propagation of the solution over one sector",
    ". assume the solution @xmath23 is known , either through the initial condition when @xmath24 or through the computation of the solution over the previous sector .",
    "first we solve the time - independent schrdinger eigenvalue problem with potential function @xmath21}(x)$ ] : @xmath25}_n=\\left({\\bar v}^{[k]}(x)-e^{[k]}_n\\right)y^{[k]}_n,\\quad y^{(k)}_n(x_{min})=y^{(k)}_n(x_{max})=0,\\label{se}\\end{aligned}\\ ] ] where the upper label @xmath26 $ ] refers to the specific sector over which we are propagating .",
    "the eigenfunctions are normalized such that y^[k]_n , y^[k]_m=_x_min^x_maxy^[k]_n(x)y^[k]_m(x)dx=_nm , n , m=1,2,3, ",
    ".[eq2]the set of eigenfunctions @xmath27}_n$ ] form an orthonormal basis .",
    "we write the desired @xmath14 over the @xmath28th sector as an expansion over this set , with @xmath6-dependent coefficients : ^[k](x , t)=_m=1^c_m^[k](t)y^[k]_m(x).[eq3]expansion is then introduced into the time - dependent schrdinger equation . after multiplying this by @xmath27}_n(x)$ ] , integrating over @xmath12 and using eq . , we obtain c_n^[k](t)=_m=1^c_m^[k](t),n=1,2,3, ",
    "[csys]where v^[k]_nm(t)=_x_min^x_max y^[k]_n(x ) y^[k]_m(x)dx.[eq5]the propagation over sector @xmath28 is then reduced to the solution of the linear system over the interval @xmath29 $ ] with initial values @xmath30}(t_{k-1})$ ] which are derived from the data obtained on the previous sector . continuity is imposed in @xmath31 , that is @xmath32}(t_{k-1})y^{[k-1]}_m(x)=\\sum_{m=1}^{\\infty}c_m^{[k]}(t_{k-1})y^{[k]}_m(x).\\ ] ] after multiplying this equation with @xmath27}_n(x)$ ] and integrating over @xmath12 , we obtain the initial conditions : c_n^[k](t_k-1)=_m=1^ s_nm^[k]c_m^[k-1](t_k-1)[icc]where @xmath33}$ ] measures the overlap between the eigenfunctions in sector @xmath28 and the ones in sector @xmath34 : s_nm^[k]=_x_min^x_maxy^[k]_n(x)y^[k-1]_m(x)dx.[int2 ]    in practice , some upper value @xmath9 must be imposed for the number of eigenfunctions included in the expansion , and thus for the indices @xmath35 and @xmath36 .",
    "this means that over each sector , @xmath37 integrals need to be computed to obtain @xmath38}v_{nm}(t)=\\delta^{[k]}v_{mn}(t)$ ] for @xmath39 , and @xmath40 integrals to obtain each @xmath33}$ ] .",
    "also the system can be written in matrix form as (t)=a^[k](t)c^[k](t),t,[system]where @xmath41}$ ] is a column vector with @xmath9 components @xmath42}$ ] and @xmath43}(t)$ ] is an @xmath9 by @xmath9 symmetric matrix with elements @xmath44}(t)=-\\imath \\left[\\delta v^{[k]}_{nm}(t)+e^{[k]}_{n}\\delta_{nm}\\right]$ ] .",
    "the initial condition for the system is given by eq .   or in matrix form @xmath45}}(t_{k-1})=s^{[k]}c^{[k-1]}(t_{k-1})$ ] .",
    "the procedure described in the previous section reduces the solution of the time - dependent problem to the solution of time - independent schrdinger problems , linear ode systems of the form , and the computation of the integrals and .",
    "it is crucial to have a computationially efficient approximation technique for the solution of the time - independent schrdinger problems , and to obtain a uniform high accuracy approximation to the eigenvalues and eigenfunctions .",
    "it is well known that the oscillatory behavior of the solutions of time - independent schrdinger problems , force naive integrators to take increasingly smaller steps .",
    "as shown in @xcite , highly accurate and efficient techniques are available in the form of a shooting method employing constant based perturbation ( cp ) methods for the solution of the initial value problem .",
    "cp methods are based on `` approximation of the potential '' . in particular ,",
    "constant reference potential approximations are used and some perturbation corrections are computed from the difference between the constant reference potential and the original one .    in our numerical experiments , we used a cp method of order 12 as it was implemented in the matlab package matslise @xcite ( and earlier in fortran form in @xcite ) to compute accurate approximations of the eigenvalues and evaluations of the eigenfunctions and their first order derivative in a fixed set of meshpoints .",
    "the mesh is formed by subdividing the @xmath12-range in a number of equidistant steps and taking the 4 lobatto nodes over each such step as the meshpoints .",
    "choosing the meshpoints in this way , is convenient for the fast and accurate approximation of the integrals and over each sector ( see further ) .      for schrdinger equations with an explicitly time - dependent hamiltonian ,",
    "a difficulty when constructing accurate and efficient propagators is that fast oscillations in the time - dependent fields apparently necessitate small time steps .",
    "we propose here an effective discretization method for the solution of the linear system , which takes into account the oscillatory nature of the solution .",
    "we again use a cp approach , which is strongly related to the application of a modified neumann scheme , see @xcite .",
    "an alternative is to employ a modified magnus approach , however the computation of the matrix exponential of the magnus series terms is exceedingly expensive , especially when one wants to employ higher - order magnus approximations .",
    "first step is to approximate the matrix @xmath43}$ ] in equation by a constant ( time - independent ) matrix @xmath46}$ ] . for the construction of a second order algorithm , we can use @xmath46}=a^{[k]}((t_{k-1}+t_k)/2)$ ] as a constant approximation . note that in this case @xmath46}$ ] is a diagonal matrix with @xmath46}_{nm}=-\\imath e_n^{[k]}\\delta_{nm}$ ] and that the solution can be easily propagated by @xmath47}(t)=\\exp[(t - t_{k-1}){\\bar a^{[k]}}]c^{[k]}(t_{k-1 } ) , \\quad t \\in[t_{k-1},t_k].\\ ] ] when constructing higher order cp methods , we approximate @xmath43}$ ] by a higher order polynomial approximation , i.e.  by a truncated series over the shifted legendre polynomials : @xmath48}(t_{k-1}+\\delta)\\approx { \\hat a}(\\delta)=\\sum_{m=0}^m a_m h^m p^*_m(\\delta / h),\\quad h = t_k - t_{k-1},\\ ; \\delta \\in [ 0,h],\\ ] ] where the matrix weights @xmath49 are calculated by quadrature ( see @xcite )",
    ". the symmetric matrix @xmath46}=a_0 $ ] is then diagonalized and let @xmath50 be the orthogonal diagonalization matrix , i.e.  @xmath51 .",
    "our propagation algorithm for the solution takes then the following form @xmath47}(t)=dt^d(t - t_{k-1})d^tc^{[k]}(t_{k-1})\\ ] ] with @xmath52 where @xmath53 are perturbation corrections derived from the perturbation @xmath54 .",
    "in fact , by using perturbation theory ( as in @xcite ) one can show that the perturbations @xmath55 satisfy p_q()=a_0^d p_q ( ) + [ a^d()-a_0^d]p_q-1(),p_q(0)=0,[rec]where @xmath56 .",
    "this means that @xmath57 has the following form @xmath58 where n^1=_0^(-_1a_0^d)[a^d(_1)-a_0^d](_1a_0^d)d_1,corresponds exactly to the first term in a modified neumann integral series .",
    "also the expressions for the higher order perturbations are equal to the corresponding term in the modified neumann series .",
    "since @xmath59 has a polynomial form , the integrals in the neumann series terms can be computed analytically . for a fourth order algorithm for instance , it is sufficient to take @xmath60 and one perturbation correction @xmath57 where @xmath61 is given by @xmath62 with @xmath63 and @xmath64 .",
    "in our implementations we used this simple fourth order scheme and applied it once over the full sector - length @xmath65 $ ] or ( if needed to ensure accuracy ) on a subdivision of the sector @xmath65 $ ] .",
    "it is often important to discretize schrdinger equations while preserving unitarity so that the conservation of the norm is ensured .",
    "the second order scheme always preserves the norm and non - unitarity appears only through the correction terms which are added .",
    "the loss of norm conservation is consequently likely to be small , moreover including correction terms improves the accuracy of the method , i.e.  it leads to an approximate solution which is closer to the exact one .",
    "we illustrate this in the numerical experiments section .      also for the quadrature of the integrals involved in the procedure it is important to select the appropriate rules .",
    "the integrands of and contain a product of two wavefunctions of a time - independent schrdinger equation .",
    "these wavefunctions have an oscillatory character in that part of the integration domain where the corresponding energy eigenvalue is larger than the potential .",
    "an alternative to the standard quadrature methods is provided by contemporary methods for highly oscillatory quadrature , an area that has undergone significant developments over the last ten years .",
    "many of these methods were , however , specially devised for integrals of the form @xmath66 where @xmath67 and the nonoscillatory functions @xmath68 and @xmath69 are known @xcite .",
    "eqs .   and do not fit in this @xmath66 framework .",
    "moreover , it may be more convenient for the present application to use the same set of quadrature nodes for each integral instead of frequency - dependent ones , in order to minimize the number of cp eigenfunction evaluations . however , we do have some information available which we can use in the formulation of a specially tuned quadrature rule : we have some knowledge about the frequency of each wavefunction , moreover the cp approach does not only provide us with the values of the wavefunctions at the meshpoints but also those of their first derivative .",
    "we will use this information in the construction of some adapted quadrature rules based on exponential fitting ( ef ) .",
    "these ef rules are not only very effective in the oscillatory part of the integration domain but also in the region where an eigenfunction displays an exponential behavior",
    ". details about ef quadrature can be found in @xcite .",
    "we first consider integral .",
    "the integrand can be generically written as the product @xmath70 , where @xmath71 is an eigenfunction of the schrdinger problem @xmath72 and @xmath73 an eigenfunction of a different schrdinger problem @xmath74 .",
    "as described in @xcite , p.  47",
    ", the eigenfunction @xmath75 corresponding to an eigenvalue @xmath76 , can be written over the meshinterval @xmath77 $ ] as @xmath78 where @xmath79 is a constant approximation of the potential @xmath80}(x)$ ] on the current meshinterval .",
    "note that we have such a constant approximation of the potential available in the cp algorithm .",
    "similarly , @xmath81 based on this structure for both @xmath71 and @xmath73 , we choose to use a 4-point lobatto - ef algorithm of the form _",
    "x_i^x_i+1 i(x)dx=_x - h^x+h i(x)dxh_n=1 ^ 4a_n^(0)i(x+x_nh)+h^2_n=1 ^ 4a_n^(1)i(x+x_nh)[efrule]which is exact for the functions @xmath82 where @xmath83 and @xmath84 .",
    "see @xcite for the construction of such an ef rule .",
    "the integrand of integral has a bit different form which we generically write as @xmath85 .",
    "@xmath71 and @xmath73 are again eigenfunctions for which we have the evaluations of the first derivative available . in many cases",
    "the form of the potential function @xmath15 is explicitly known and the first derivative w.r.t .",
    "@xmath12 of the function @xmath86}(x)$ ] can be evaluated . in this case , the ef method is used .",
    "otherwise , we propose an ef scheme which does not use derivative information and is exact for @xmath87 .",
    "for test problem 1 with @xmath88 in two different @xmath6-ranges : ( a ) @xmath89 $ ] , and ( b ) the highly - oscillatory region @xmath90 $ ] . , title=\"fig:\",width=226 ]   for test problem 1 with @xmath88 in two different @xmath6-ranges : ( a ) @xmath89 $ ] , and ( b ) the highly - oscillatory region @xmath90 $ ] . , title=\"fig:\",width=226 ] +",
    "( a ) +   for test problem 1 with @xmath88 in two different @xmath6-ranges : ( a ) @xmath89 $ ] , and ( b ) the highly - oscillatory region @xmath90 $ ] . , title=\"fig:\",width=226 ]   for test problem 1 with @xmath88 in two different @xmath6-ranges : ( a ) @xmath89 $ ] , and ( b ) the highly - oscillatory region @xmath90 $ ] . , title=\"fig:\",width=226 ] + ( b )    as a first test problem , we consider an equation with a known analytical solution .",
    "the potential is given by @xmath91 and @xmath92 .",
    "for the initial wave function we choose an eigenfunction of the harmonic oscillator @xmath93 where @xmath94 is the hermite polynomial of degree @xmath35 .",
    "the analytic solution is @xmath95 .",
    "the @xmath12-range we used was @xmath96 $ ] .",
    "we applied our cp - based procedure to approximate @xmath14 for @xmath97 $ ] .",
    "figure [ fig : problem1 ] gives an idea about the shape of @xmath14 when @xmath88 .",
    "a cp approximation , obtained with the procedure presented in this paper , is shown .",
    "table [ table1 ] shows some results for different sets of parameter values : @xmath35 is the number of nodes of the initial wave function , @xmath9 is the number of terms in the expansion , @xmath98 in the size of the equidistant steps used in the @xmath12-direction ( note that 2 extra inner lobatto nodes are used in each such step ) , while @xmath99 is the size of the equidistant time steps .",
    "@xmath100 denotes the number of rectangular sectors .",
    "this means that the propagation over each sector requires @xmath101 modified neumann steps .",
    "the conservation of norm and the error in the approximations are measured by the following two quantities which are evaluated in @xmath102 err_n=_x_min^x_max^[k](x , t)^*^[k](x , t)dx-_x_min^x_max_exact(x , t)_exact^*(x , t ) dx,[errn]and err_a=_x_x|(x , t)-_exact(x , t)|,where is evaluated by applying a classical lobatto - quadrature rule with the @xmath12-mesh forming the quadrature nodes .",
    "the results in the table illustrate that high accuracies are reached with small @xmath9 , large sector widths and large step sizes . for a comparison in efficiency",
    ", we included some results obtained with the one - step implicit crank - nicolson scheme ( cn ) , which is one of the widespread numerical schemes for solving time - dependent schrdinger problems .",
    "the cn scheme requires the solution of a system of algebraic equations of size @xmath103 at each time - step .",
    "it is clear that the cn scheme can not be used to obtain high accuracies , similar to the ones obtained with the cp - based scheme , within a reasonable time .",
    "all computations were performed in matlab on a standard desktop computer .",
    ".some results for test problem 1 .",
    "the upper 3 lines of results show @xmath104 , while the lower ones contain @xmath105 .",
    "@xmath106 is the cputime in seconds needed to approximate @xmath14 for one @xmath35 value .",
    "the last columns show results obtained by applying the crank - nicolson method ( cn ) . [",
    "cols=\"^,^,^,^,^,^,^,^,^,^\",options=\"header \" , ]",
    "to accurately simulate the outcome of quantum dynamical experiments with time - dependent hamiltonians , accurate and efficient numerical techniques should be used . in this paper",
    ", we showed how the succesful cp technique can be used in the spatial discretization of a time - dependent schrdinger equation following an approach suggested by ixaru in @xcite , but also for efficient and accurate time stepping in the resulting ode system .",
    "the effectiveness of the approach was illustrated by some numerical examples ."
  ],
  "abstract_text": [
    "<S> we show how the highly accurate and efficient constant perturbation ( cp ) technique for steady - state schrdinger problems can be used in the solution of time - dependent schrdinger problems with explicitly time - dependent hamiltonians , following a technique suggested by ixaru in @xcite . by introducing a sectorwise spatial discretization using bases of accurately cp - computed eigenfunctions of carefully - chosen stationary problems </S>",
    "<S> , we deal with the possible highy oscillatory behaviour of the wave function while keeping the dimension of the resulting ode system low . also for the time - integration of the ode system a very effective cp - based approach can be used . </S>"
  ]
}