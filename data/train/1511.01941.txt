{
  "article_text": [
    "solar flares are powerful events resulting from the sudden conversion of stored magnetic energy to particle acceleration and excess radiation in the corona , and releasing up to @xmath0 total erg of energy  @xcite .",
    "solar flares can have significant detrimental effects on earth , including disruption and damage to satellites , power grids , and telecommunications infrastructure  @xcite .",
    "since coronal magnetic field measurements are not currently available , much research has focused on the inference of coronal magnetic field structure from the photospheric magnetic field . in this , it is assumed that turbulent motions in the photosphere create complex photospheric magnetic configurations  @xcite , and this will then be reflected in complex coronal magnetic configurations  @xcite .",
    "complex coronal field configurations store the energy that is released as a solar flare .",
    "several researchers have studied the use of poisson statistics to relate flare rate of different active region ( ar ) classes ( e.g. , mcintosh or mount wilson classes ) to probability of observing a c- , m- , or x - class flare  @xcite .",
    "other researchers have studied the relationship between quantitative image parameters and the probability of observing a c- , m- , or x - class flare  @xcite .",
    "several researchers have also studied the relation between quantitative image parameters and flare size  @xcite or flare index  @xcite .",
    "to the best of our knowledge , no researchers have studied the direct _ prediction _ of flare size on the basis of quantitative image parameters as we study here .",
    "several researchers have performed a qualitative study of the time evolution of flare parameters by plotting parameters versus time  @xcite .",
    "other researchers have studied flare prediction in light of different predictive time windows  @xcite . related to flare time properties ,",
    "several researchers have studied the relation between quantitative image parameters and flare productivity   and flare rates  @xcite . to the best of our knowledge , no researchers have studied the direct prediction of time - to - flare on the basis of quantitative image parameters as we study here .    in this paper , we use support vector machine regression ( svr ) to predict solar flare size and time - to - flare from quantitative measures of magnetogram complexity . the remainder of this paper is organized as follows . in section",
    "[ sec : svm ] , we briefly introduce regression in general , svr in particular , and other applications of svr to time series analysis . in section [ sec : data_experiment ] , we explain our data set , experimental procedures , and error measures . in section [ sec : results ] we present our results of solar flare size prediction and solar flare time regression . in section [",
    "sec : conclusions ] , we discuss our conclusions and future work .",
    "in the general form of regression , we wish to predict some continuous target variable @xmath1 given some @xmath2-dimensional input vector @xmath3  @xcite . in this work",
    ", we wish to predict the flare size ( `` size regression '' ) or time to flare occurrence ( `` time regression '' ) given a set of features describing magnetic complexity . the equation @xmath4 , which maps input data to the target variable , is determined through optimization of some criterion based on training data .",
    "regression commonly takes the general form  @xcite @xmath5 where @xmath6 is a function whose output indicates the target value @xmath1 for a given input vector @xmath7^\\top$ ] ; @xmath8^\\top$ ] is a vector of weights applied to the basis functions @xmath9 ; basis functions @xmath9 are some ( linear or nonlinear ) function of input data @xmath3 ; and @xmath10^\\top$ ] . in this work",
    ", the 38-dimensional input vector @xmath3 corresponds to the 38 magnetic complexity features described in  @xcite and summarized in table  [ tab : features ] , the weight parameters @xmath11 are chosen to optimize some criterion ( minimization of an @xmath12-insensitive error function for the case of svr ) , and the output @xmath13 indicates the prediction of flare size or time - to - flare .",
    "the function @xmath13 is linearly related to @xmath11 but the transformation @xmath14 allows for introduction of a nonlinear relationship to the input data @xmath3 .",
    "support vector machines ( svms )  @xcite have become popular and are considered state - of - the - art for regression problems  @xcite .",
    "an important property of svms is that they can be formulated as a convex optimization problem , assuring that any local optimum is also a global optimum  @xcite .",
    "support vector regression minimizes the regularized error function @xmath15 where @xmath16 is the inverse regularization parameter , @xmath17 is the total number of training points , @xmath18 is an @xmath12-insensitive error function , @xmath19 is the output for the @xmath20-th training point , @xmath21 is the target for the @xmath20-th training point , and @xmath22 is the euclidean norm .",
    "the use of an @xmath12-insensitive error function returns a value of 0 if the absolute difference @xmath23 and encourages sparse solutions  @xcite . in this work",
    "we use the matlab svm - km toolbox  @xcite and the transformation @xmath24 implicitly defined by the radial basis ( gaussian ) kernel function @xmath25 .",
    "the parameter @xmath12 is chosen based on the specific problem ( size or time regression ) and we optimize the values of @xmath16 and @xmath26 by grid search .",
    "the optimal value of weight vector @xmath11 is determined by minimizing the error function in equation ( [ eq : svr_error ] ) .",
    "this minimization is conducted using a training dataset which consists of @xmath17 pairs of feature vectors and labels @xmath27 ; the performance of the regressor is then determined on the basis of a test dataset consisting of pairs of feature vectors and labels disjoint from the training data . the use of a disjoint test dataset is important since the optimization can overfit a solution to the training data , resulting in an inflated performance when evaluated on the training data . since the parameters @xmath16 and @xmath26 must also be optimized , an additional dataset must be provided for this optimization ; this dataset is commonly called the tuning dataset ( since it is used to tune the parameters of the regressor ) and is disjoint from both the training and testing datasets .      support vector regression has been shown to outperform other nonlinear methods , including multi - layer perceptrons , for time series prediction  @xcite .",
    "time series prediction algorithms have been used in many practical applications such as financial market prediction ( e.g. , @xcite ) , electric utility load forecasting  ( e.g. , @xcite ) , weather and environmental prediction ( e.g. , @xcite ) , biomedical signal processing for estimation of missing microarray data ( e.g. , @xcite ) , and travel time prediction ( e.g. , @xcite ) . in the aforementioned references , there is no significant feature extraction and the focus is generally on prediction using one - dimensional time series data .",
    "image deblurring is studied in  @xcite in which the image regions are reformulated as one - dimensional signals prior to application of svr .",
    "to the best of our knowledge , there are no studies of svr applied to the problem of estimating a continuous label vector from a high - dimensional image feature vector , nor of svr applied to the prediction of solar flare characteristics .",
    "in our previous work  @xcite , we used a large set of line - of - sight michelson doppler imager ( mdi ) magnetograms from 2000 through 2010 .",
    "this included noaa ars 880910933 , and some 594,000 total images .",
    "we describe the complexity of each ar by extracting a large set of features of postulated importance for the build up of magnetic energy and compare these to the onset of solar flares over a range of time periods following each magnetogram .",
    "we consider three general categories of features : ( 1 ) snapshots in space and time , encompassing total magnetic flux , magnetic gradients , and neutral lines , ( 2 ) evolution in time , encompassing flux evolution , and ( 3 ) structures at multiple size scales , encompassing wavelet analysis . in total ,",
    "38 different spatial features are extracted from each magnetogram image as summarized in table  [ tab : features ] and as described in detail in  @xcite . in this work ,",
    "we predict the solar flare sizes or predict the time to flare occurrence ( when in the future a flare is expected to occur ) by redefining the label vector to be continuous rather than discrete .",
    "these continuous label vectors have continuous numbers related to the flare size or time of flare at each flaring region .      here",
    "we describe and define the error measures we use for quantifying the performance of the regression models . in the following equations",
    ", @xmath1 denotes the actual target value , @xmath28 is the target value estimated by regression , and @xmath17 is the total number of data points . for notational simplicity",
    ", we drop the index over @xmath29 and interpret any summations as being over this range .",
    "the root mean square error ( rmse ) measures the square root of the mean square error : @xmath30 the mean absolute error ( mae ) is given by : @xmath31 both the rmse and mae are expressed in the same units as the original target variable @xmath1 and give a measure of the unsigned error .",
    "the relative mean error ( rme ) is defined as : @xmath32 the rme is a signed error which can give a measure of the bias of the regressor , i.e. , whether we consistently over- or under - estimate the target variable @xmath1 .",
    "positive values of rme indicate a systematic underestimation while negative value indicate a systematic overestimation of target variables .",
    "an rme of zero indicates no systematic bias in error .",
    "the pearson s correlation coefficient is given by : @xmath33 where @xmath34 is the mean of @xmath1 over the @xmath17 data points , and @xmath35 is the mean of the estimates @xmath28 over the @xmath17 data points .",
    "@xmath36 measures the linear correlation between the actual flare sizes and predicted ( regressed ) flare sizes , giving a value of @xmath37 if the actual and predicted values are perfectly correlated , 0 if they are completely uncorrelated , and @xmath38 if they are perfectly negatively correlated .        in our size regression experiments ,",
    "the goal is to predict the size of a future solar flare using svr .",
    "we consider two different experiments for size regression . in experiment 1",
    "we apply svr only to those regions which ultimately flare , ignoring the non - flaring regions",
    ". this will give the most accurate results of the discriminative potential of magnetogram complexity features for determining solar flare size .",
    "we note that in an operational scenario , an automated classification algorithm ( such as that presented in  @xcite ) could be used to automatically separate flaring from non - flaring regions prior to size regression . in experiment 2",
    "we apply svr to both flaring and non - flaring regions , as well as consider a thresholding of the regression results for flare prediction .",
    "solar flares are categorized as a- , b- , c- , m- or x - class according to the peak flux ( in watts per square meter , w m@xmath39 ) of 100800 pm x - rays near earth , as measured by the _ geostationary operational environmental satellite _ ( _ goes _ ) . as reference ,",
    "table  [ tab : flare_sizes ] shows the solar flare classes and their corresponding peak fluxes .",
    "these _ goes _ classes are the standard for measuring absolute size of flares ; however , due to the exponential nature of the class definitions , goes classes are not convenient for measuring the error of a size estimate .",
    "for example an error of @xmath40 w m@xmath39 has a very different significance when interpreted in light of a c - class flare than an x - class flare .",
    "as such , we seek a continuous label corresponding to flare size for which a given error can be interpreted independent of the underlying flare class .",
    "this would imply , for example , that an error of 1 arbitrary units would indicate a prediction of a c2.0 rather than a c1.0 _ or _",
    "an x2.0 rather than an x1.0 .    rather than an exponentially spaced label vector",
    ", we define a linearly spaced continuous - valued label vector for flare size as follows and as summarized in table  [ tab : flare_sizes ] .",
    "flare magnitudes are offset by 0 for b - class , 9 for c - class , 18 for m - class , and 27 for x - class .",
    "for example , a c3.3 flare would be assigned value @xmath41 and an m5.7 would be assigned value @xmath42 .",
    "we note that the two a - class flares in our dataset are assigned fractional values close to 1 and are aggregated into the b - class for data balancing ( discussed below ) .",
    "we define this linearly spaced continuous - valued label vector for flare size for a range of different predictive time windows .",
    "thus , for a predictive time window of @xmath43 hours , if an ar flares within @xmath43 hours of the present time , we define the label as the linearly spaced flare size .",
    "since the predictive time window is larger than the nominal cadence of the mdi data ( 96 minutes ) , a single flare event will be regressed independently by multiple feature vectors .",
    "furthermore , it is possible that more than one flare occurs in the given predictive time window .",
    "in such a case , we define the corresponding entry in the label vector to be the largest flare size which occurs in that time window .",
    "we repeat this experiment for @xmath43 in the range @xmath44 $ ] hours in steps of 2 hr .",
    "the error measures are computed to compare the estimated flare sizes with the real flare sizes at each time @xmath43 in the time window .",
    "we further note that the _ goes _ background level will have an effect on the accuracy of the regression for experiment 2 when non - flaring regions are included .",
    "if a flare is predicted to be smaller than the concurrent _ goes _ background flux , the label computed from the _ goes _ flare catalog will indicate no flare and we will see an apparent error equal to the prediction flare size ; it is possible , however , that a flare actually did occur but was missed by the _ goes _ instrument due to the high background .",
    "since the distribution of flares is unbalanced across the classes ( more smaller flares than larger ) , we balance the data by randomly subsampling the larger classes to the size of the smallest class to build a more accurate regression model",
    ". the class with smallest number of data samples will be the x - class flares in our dataset .",
    "we use 100-fold cross validation for each time @xmath45 $ ] .",
    "in other words , we randomly subsample the data 100 times and train a regressor on each of these 100 data subsets ; furthermore , each of these 100 data subsets is balanced such that there is equal representation among the flare classes . since the data balancing inherently removes a large portion of the training data , cross validation in this scenario allows us to better utilize our entire training dataset by considering multiple randomly chosen subsets and averaging the results .",
    "we choose 100-fold cross validation since the number of x - class flares is approximately 1% of the total number of flares in the worst case ; this means that , statistically , we will use each data sample at least once in the training process .",
    "we choose a value of @xmath46 which will penalize errors greater than a tenth of a magnitude ; we choose this value on the basis of the fact that the _ goes _ magnitudes are specified only to a significant digit of a tenth .",
    "the svr inverse regularization parameter @xmath16 controls the smoothness of the decision boundary and the kernel parameter @xmath26 controls the smoothing of the input data ; both @xmath16 and @xmath26 are optimized for @xmath47 hr , 10-fold cross validation , and a tuning dataset consisting of a randomly chosen fourth of the dataset . a time window of @xmath47 hr is used since this is the dataset with the largest number of x - class flares , and 10-fold cross validation is used rather than 100-fold cross validation for computational reasons .",
    "no noticeable difference in average performance was noted with 10-fold versus 100-fold cross validation simulations .      in our time regression experiments ,",
    "the goal is to predict how many hours in the future a flare will occur using svr . in experiment 3",
    "we apply svr only to those regions which ultimately flare . for this experiment",
    "we define a label vector containing the number of hours to the next flare in an ar , as measured from the current time .",
    "since there is no distinguishing between flare sizes in this experiment , there is no need for data balancing .",
    "we choose a value of @xmath48 which corresponds to the 96 minute cadence of the mdi data expressed in hours .",
    "the svr inverse regularization parameter @xmath16 controls the smoothness of the decision boundary and the kernel parameter @xmath26 controls the smoothing of the input data ; both @xmath16 and @xmath26 are optimized using 10-fold cross validation and a * tuning dataset consisting of a * randomly chosen fourth of the data .",
    "in this section , we present results for two different definitions of the basic flare size label vector as defined in table  [ tab : flare_sizes ] . in experiment 1",
    "we use the definitions for the flare label vector directly as summarized in table  [ tab : flare_sizes ] .",
    "experiment 1 is designed to study the discriminatory potential of the 38 magnetogram complexity measures for determining flare size ; we note that in an operational scenario , the ar could first be classified as flaring by a separate classifier ( e.g. ,  @xcite ) . in experiment 2",
    "we additionally include non - flaring regions and assign those regions a flare size of 0 .",
    "experiment 2 is designed to combine flare prediction ( i.e. , will a flare of any size occur ) with flare size prediction .",
    "parameters @xmath16 and @xmath26 are optimized via grid search using a tuning dataset consisting of a randomly chosen fourth of the ars . for each of the 10-fold cross validation runs , this tuning dataset is randomly subsampled to balance the classes by choosing @xmath49 data points from each class for tuning training , where @xmath50 is the size of the smallest class ( x - class flares in all cases ) .",
    "all remaining unbalanced data unseen in the tuning training is used as tuning test data . in other words , we vary parameters @xmath51 and @xmath52 and train 10 regressors for each combination of @xmath16 and @xmath26 using a balanced subset of the tuning dataset while testing performance using the tuning data which is disjoint from that used to train the regressor .",
    "rmse results are computed over the tuning test data and averaged over the 10-fold cross validations ; we find a minimum rmse of approximately 4.9 for @xmath53 and @xmath54 which we use for subsequent size regression simulations in experiment 1 .",
    "we now use the remaining @xmath55 of the ars unseen in tuning to cross validate performance of the size regression .",
    "similar to the @xmath16 and @xmath26 optimization , training data are balanced and all data unused in the balanced training are used as test data for each of the 100 folds .",
    "we plot the rmse , mae , rme , and correlation coefficient @xmath36 for size regression in fig .",
    "[ fig : size_errors ] ; these errors are averaged over the test data ( unseen in training and tuning ) for the 100-fold cross validation runs .",
    "we see an average rmse ( fig .",
    "[ fig : size_errors](a ) ) ranging between 5.6 and 6.4 , with smaller errors for larger predictive time windows . with",
    "our linearly spaced flare size label vector , recall that an error of 1 indicates an error of one magnitude increment ( e.g. , m1.0 versus m2.0 ) and an error of 10 indicates an error of one class increment ( e.g. , m1.0 versus x1.0 ) .",
    "we thus find an rmse of slightly more than half a class .",
    "similarly , we find an average mae ( fig .",
    "[ fig : size_errors](b ) ) between 4.5 and 5.5 , again with smaller errors for larger predictive time windows and again indicating an error of approximately half a class .",
    "looking at the rme in fig .",
    "[ fig : size_errors](c ) , we see that our estimates of flare size are biased toward overestimating by 2.34.3 mag increments with larger bias for smaller predictive time windows . the correlation coefficient in fig .",
    "[ fig : size_errors](d ) ranges from 0.46 to 0.51 , with larger correlation for longer predictive time windows .    in fig .  [",
    "fig : size_errors ] we have included the standard deviation across the 100-fold cross validation runs as error bars .",
    "we note that the smaller time windows have a larger standard deviation ; this is a direct result of the smaller sample sizes for the shorter time windows .",
    "the error bars for all but the 2-hr time window are within the average values for larger time windows in rmse and mae .",
    "thus the trend of decreasing error with increasing time window may be more of an artifact of small sample statistics than underlying physics .",
    "even so , the consistency in error across predictive time windows may indicate a presence of magnetic complexity features correlated to eventual flare size which persist long before flaring .",
    "it also appears that these more persistent magnetic complexity features may allow for better prediction of flare size since the bias shown in rme in fig .",
    "[ fig : size_errors](c ) is smaller with increased window length and r in fig .",
    "[ fig : size_errors](d ) is larger with increased window length .    in fig .",
    "[ fig : size_error_hist](a ) we plot a histogram of the error @xmath56 , aggregated over the 12 predictive time windows and the 100-fold cross validation runs .",
    "we see that the distribution is approximately normal with a mean skewed to -2.7 ( as would be expected from the rme plot in fig .",
    "[ fig : size_errors](c ) ) and a standard deviation of 4.9 . as reference ,",
    "the green line in fig .",
    "[ fig : size_error_hist ] is a sample normal distribution with mean -2.7 , standard deviation 4.9 , and the same total counts as the error histogram .",
    "we additionally plot the histograms of the error @xmath56 for each flare class in fig .",
    "[ fig : size_error_hist](b)(e ) , again aggregated over the 12 predictive time windows and 100-fold cross validation runs .",
    "we see that the mean error is different for the different flare classes .",
    "we find an average error of approximately 3/4 a _ goes _ class for the ab- and x - class flares , albeit overestimating the ab flares and underestimating the x flares .",
    "we find a similar error of approximately 1/3 a _ goes _ class for the c- and m - class flares , again overestimating the smaller ( c - class ) flares and underestimating the larger flares .",
    "parameters @xmath16 and @xmath26 are optimized via grid search using the same tuning dataset and procedure as for experiment 1 , except now including non - flaring regions in the dataset and subsampling procedures .",
    "we find a minimum rmse of approximately 7.2 for @xmath57 and @xmath58 which we use for subsequent size regression simulations in experiment 2 .",
    "we note that the rmse resulting from optimization of @xmath16 and @xmath26 already indicates a higher average error in experiment 2 as compared to experiment 1 .",
    "we now use the remaining @xmath55 of the ars unseen in tuning to cross validate performance of the size regression , using the same procedure as in experiment 1 .",
    "we plot the rmse , mae , rme , and correlation coefficient @xmath36 for size regression in fig .",
    "[ fig : size_errors2 ] .",
    "we see an average rmse ( fig .",
    "[ fig : size_errors2](a ) ) ranging between 6.5 and 7.7 , with smaller errors for larger predictive time windows , corresponding to an rmse of approximately three quarters of a class .",
    "similarly , we find an average mae ( fig .  [ fig : size_errors2](b ) ) between 4.8 and 5.6 , again with smaller errors for larger predictive time windows and indicating an error of approximately half a class .",
    "looking at the rme in fig .",
    "[ fig : size_errors2](c ) , we see that our estimates of flare size are biased toward overestimating by 3.54.7 mag increments with larger bias for smaller predictive time windows . the correlation coefficient in fig .",
    "[ fig : size_errors2](d ) ranges from 0.25 to 0.55 , with larger correlation for longer predictive time windows . in figure",
    "[ fig : size_errors2 ] we have included the standard deviation across the 100-fold cross validation runs as error bars .",
    "we note that again the smaller time windows have a larger standard deviation due to small sample statistics .    in fig .",
    "[ fig : size_error_hist2](a ) we plot a histogram of the error @xmath56 , aggregated over the 12 predictive time windows and the 100-fold cross validation runs . here",
    ", we see a distribution that deviates significantly from normal . as reference , the green line in fig .",
    "[ fig : size_error_hist2](a ) is a sample normal distribution with the sample mean -3.9 , sample standard deviation 5.6 , and the same total counts as the error histogram .",
    "we separately plot the error histogram for non - flaring regions and the different flare classes in fig .",
    "[ fig : size_error_hist2](b)-(f ) .",
    "we see that the distribution of error for non - flaring regions ( fig .  [",
    "fig : size_error_hist2](b ) ) is the source of the non - normal distribution .",
    "furthermore , we find that most of the non - flaring regions were overestimated by the regressor , i.e. , we predicted a flare when the _ goes _ catalog does not indicate one . some of this error can be attributed to the _ goes _ background flux as previously discussed .",
    "overall , we again find different average errors for different flare classes , with a tendency to overestimate small flares and underestimate large flares .",
    "next , we look at the flare prediction accuracy by thresholding the regression results . we define a non - flaring ar to be one with a predicted flare size of @xmath59 and flaring ar to be one with a predicted flare size of @xmath60 where @xmath61 is the chosen threshold",
    ". metrics of flare prediction accuracy will be computed from the entries of the confusion matrix shown in table  [ tab : confusion_matrix ] . in table",
    "[ tab : confusion_matrix ] tp is the true positive ( correct flare prediction ) , fn false negative ( incorrect no - flare prediction ) , fp false positive ( incorrect flare prediction ) , and tn true negative ( correct no - flare prediction ) .",
    "since flares are rare events , the overall prediction accuracy @xmath62 can be misleading .",
    "as such , we also compute the percentage of correctly classified flaring regions ( the true positive rate or tpr , also known as the sensitivity )  @xcite @xmath63 the percentage of correctly classified non - flaring regions ( the true negative rate or tnr , also known as the specificity )  @xcite @xmath64 the heidke skill score  @xcite @xmath65}{(tp+fn)(fn+tn)+(tp+fp)(fp+tn)},\\ ] ] and the true skill score ( tss )  @xcite @xmath66    we vary the threshold @xmath67 $ ] in steps of 0.5 .",
    "note that a threshold of @xmath68 corresponds to all flaring regions in this experiment , a threshold of @xmath69 corresponds to all flares @xmath70c1.0 , a threshold of @xmath71 corresponds to all flares @xmath70m1.0 and a threshold of @xmath72 corresponds to all flares @xmath70x1.0 .",
    "we plot the tpr and tnr versus @xmath61 in fig .",
    "[ fig : prediction_accuracy](a ) and the tss and hss versus @xmath61 in fig .",
    "[ fig : prediction_accuracy](b ) . as reference , using the same 38 features , @xcite obtained tpr @xmath73 0.8 , tnr @xmath73 0.7 , tss @xmath73 0.5 , and hss @xmath73 0.4 for flares @xmath70c1.0 . at a comparable threshold @xmath69",
    ", we find performance in this work to be tpr @xmath74 , tnr @xmath75 , tss @xmath76 , and hss @xmath77 .",
    "we thus find a comparable performance with a slightly lower tpr , higher tnr , and higher tss .",
    "this is not surprising in that we are using the same 38 features as in the flare prediction work of @xcite and are instead usng a more general continuous - valued label vector rather than a discrete two - class label vector .      in this section , in experiment 3 , we use a label vector of the time - to - flare in hours for flaring regions .",
    "experiment 3 is designed to study the discriminatory potential of the 38 magnetogram complexity measures for determining time - to - flare ; we note that in an operational scenario , the ar could first be classified as flaring by a separate classifier ( e.g. ,  @xcite ) .",
    "parameters @xmath16 and @xmath26 are optimized via grid search using the same tuning dataset as experiments 1 and 2 but no data balancing as discussed in section  [ sec : experiment ] .",
    "instead , we use 500 randomly selected data points ( approximately 10% chosen based on computational considerations ) from the tuning dataset for training and the remaining for testing .",
    "we find a minimum rmse of approximately 39.5 hr for @xmath78 and @xmath79 and use these values for subsequent time regression simulations .",
    "we implement 100-fold cross validation and train over the remaining @xmath55 of the data . for each fold , we randomly choose 1000 data points to serve as the training data and the remainder for the test data .",
    "the choice of 1000 training points is motivated by computational considerations and by the approximate size of the balanced training set in experiments 1 and 2 .",
    "averaged across the 100 cross validation runs , we find an rmse of 42.7@xmath800.5 hr , mae of 29.1@xmath800.2 hr , rme of 11.5@xmath801.5 hr , and @xmath36 of 0.44@xmath800.0 .",
    "figure  [ fig : time_error_hist ] shows the histogram of the time prediction error .",
    "we see that the distribution is appears to be a double - sided exponential with a more heavy tail on the positive side with a sample mean of @xmath81 and a sample standard deviation of @xmath82 .",
    "the positive value of mae and the heavy right tail on the error distribution indicate a bias toward underestimating time to flare .",
    "overall , we find the time regression problem to be more error prone than the size regression problem .",
    "this is not surprising given the consistency of the flare size regression results across the different time windows .",
    "it appears ( see discussion in section  [ sec : experiment1 ] ) that the magnetic complexity features are stable across a large window of time , indicating that these magnetic complexity features may not be particularly discriminative for time - based estimates of flaring .",
    "we have studied the prediction of solar flare size and time - to - flare using 38 features describing magnetic complexity of the photospheric magnetic field from a large set of mdi data .",
    "the 38 magnetic complexity features were previously shown to have discriminative potential for flare prediction in  @xcite and were studied here for their discriminative potential in determining the size of a future flare and when a future flare will occur . to the best of our knowledge , these regression problems have not been studied before .",
    "this work uses support vector regression ( svr ) , considered state - of - the - art for time series prediction , to formulate a mapping from the 38-dimensional feature space to a continuous - valued label vector representing flare size or time - to - flare . in the study of size prediction , we have defined a linearly spaced label vector such that an error of 1 arbitrary unit can be interpreted independently of the underlying flare class . in the study of time - to - flare prediction",
    ", we use a label vector with the number of hours to flare .    in size regression ,",
    "when we consider flaring regions only , we find an average error in estimating flare size of approximately half a _ goes _ class . when we additionally consider non - flaring regions , we find an increased average error of approximately 3/4 a _ goes _ class . in both of these experiments , we find a different error distribution for different flare classes , with a tendency to overestimate small flares and underestimate large flares .",
    "we also consider thresholding the regressed flare size for the experiment containing both flaring and non - flaring regions and find a true positive rate of 0.69 and a true negative rate of 0.86 for flare prediction .",
    "these results are consistent with previous studies of flare prediction using these magnetic complexity features  @xcite , with a slightly lower true positive rate and slightly higher true negative rate . the results for both of these size regression experiments are consistent across a wide range of predictive time windows , indicating that the magnetic complexity features may be persistent in appearance long before flare activity .    this conjecture of persistence in appearance across time is supported by our larger error rates of some 40 hr in the time - to - flare regression problem . the 38 magnetic complexity features considered here appear to have discriminative potential for flare size , but their persistence in time makes them less discriminative for the time - to - flare problem .    future scientific work will focus on more study of the discriminative potential of different magnetic complexity features for prediction of flare size as well as the study of the persistence of these features across time .",
    "algorithmically , we also plan to implement other regression methods , namely relevance vector regression , to avoid the computational overhead of optimizing kernel parameters .",
    "additionally , relevance vector regression will allow for a study of the underlying confidence in the regressed values .",
    "other methods of dealing with unbalanced data , e.g. , by penalizing different errors differently  @xcite , may alleviate the differences in error across the flare classes .",
    "finally , the use of more recent hmi data will allow for a larger and richer dataset for training and testing these regression methods .",
    "abramenko , v. i. 2005 , , 228 , 29 abramenko , v. i. , yurchyshyn , v. b. , wang , h. , spirock , t. j. , & goode , p. r. 2003 , , 597 , 1135 al - ghraibah , a. , boucheron , l. e. , & mcateer , r. t. j. 2015 , , 579 , a64 barnes , g. , & leka , k. d. 2006 , , 646 , 1303 bishop , c. m. 2006 , _ pattern recognition and machine learning _ ( new york , ny : springer ) bloomfield , d. s. , higgins , p. a. , mcateer , r. t. j. , & gallagher , p. t. 2012 , , 747 , l41 brown , m. p. s. , grundy , w. n. , lin , d. , cristianini , n. , sugnet , c. w. , furey , t. s. , ares , jr . , m. , & haussler , d. 2000 , pnas , 97 , 262 burges , c. j. c. , knowledge discovery and data mining , 2 , 121 canu , s. , grandvalet , y. , guigue , v. , & rakotomamonjy , a. 2005 , _ svm and kernel methods matlab toolbox _ , ( perception systemes et information , insa de rouen : rouen , france ) colak , t. , & qahwaji , r. 2009 , space weather , 7 , s06001 conlon , p. a. , gallagher , p. t. , mcateer , r. t. j. , ireland , j. , young , c. a. , kestener , p. , hewett , r. j. , & maguire , k. 2008 , , 248 , 297 cui , y. , li , r. , zhang , l. he , y. , & wang , h. 2006 , , 237 , 45 elattar , e. e. , goulermas , j. , & wu , q. h. 2010 , ieee transactions on systems , man , and cybernetics ",
    "part c , 40 , 438 falconer , d. , barghouty a. f. , khazanov , i. , & moore , r. 2011 , space weather , 9 , s04003 fletcher , l. , dennis , b. r. , hudson , h. s. , krucker , s. , phillips , k. , veronig , a. , battaglia , m. , bone , l. , caspi , a. , chen , q. , gallagher , p. , grigis , p. t. , ji , h. , liu , w. , milligan , r. o. , & temmer , m. 2011 , , 159 , 19 georgoulis , m. k. , & rust , d. m. , 2007 , , 661 , l109 guo , j. , zhang , h. , chumak , o. v. , & liu , y. 2006 , , 237 , 25 hagyard , m. j. , stark , b. a. , & venkatakrishnan , p. 1999",
    ", , 184 , 133 hewett , r. j. , gallagher , p. t. , mcateer , r. t. j. , young , c. a. , ireland , j. , conlon , p. a. , & maguire , k. 2008 , , 248 , 311 jing , j. , song , h. , abramenko , v. , tan , c. , & wang , h. 2006 , , 644 , 1273 jing , j. , tan , c. , yuan , y. , wang , b. , wiegelmann , t. , xu , y. , & wang , h. 2010 , , 713 , 440 koskinen , h. , tanskanen , e. , pirjola , r. , pulkkinen , a. , dyer , c. , rodgers , d. , cannon , p. , mandeville , j .- c .",
    ", & boscher , d. 2001 , _ esa tech report esws - rmi - rp-0001 _ , finnish meteorological institute leka , k. d. , & barnes , g. 2003a , , 595 , 1277 li , d. , mersereau , r. m. , & simske , s. 2007 , ieee transactions on neural networks , 18 , 931 mason , j. p. , & hoeksema , j. t. 2010 , , 723 , 634 mcateer , r. t. j. , gallagher , p. t. , & ireland , j. 2005 , , 631 , 628 mcateer , r. t. j. , gallagher , p. t. , & conlon , p.a . , 2010 ,",
    "asr , 45 , 1067 mcateer , r. t. j. , 2015 , , 290 , 7,1897 mcateer , r. t. j. , aschwanden , m.j . ,",
    "dimitropoulou , m. , georgoulis , m.k . , pruessner , g. , morales , l. , ireland , j. , abramenko , v. , 2015 , space sciences review , 10.1007/s11214 - 015 - 0158 - 7 meunier , n. 2004 , , 420 , 333 mohandes , m. a. , halawani , t. o. , rehman , s. , & hussain , a. a. ( 2004 ) renewable energy , 29 , 939 qahwaji , r. , & colak , t. 2007 , , 241 , 195 sammis , i. , tang , f. , & zirin , h. 2000 , , 540 , 583 sapankevych , n. i. , & sankar , r. 2009 , ieee computational intelligence magazine , 4 , 24 schrijver , c. j. 2007 , , 655 , 117 schrijver , c. j. 2014 , space weather , 12 , 487 smola , a. j. , & schlkopf , b. 2004 , statistics and computing , 14 , 199 song , h. , tan , c. , jing , j. , wang , h. , yurchyshyn , v. , & abramenko , v. 2014 , , 254 , 101 tay , f. e. h. , & cao , l. 2001 , omega , 29 , 309 vapnik , v. n. 1998 , _ statisical learning theory _",
    "( new york : wiley ) wang , h. 2006 , , 649 , 490 wang , w. , xu , z. , & lu , j. w. 2003 , engineering computations , 20 , 192 welsch , b. t. , li , y. , schuck , p. w. , & fisher , g. h. 2009 , , 705 , 821 wheatland , m. s. 2000 , , 532 , 1209 wheatland , m. s. 2005 , space weather , 3 , s07003 wu , c .- h .",
    ", ho , j .- m . , & lee , d. t. 2004 , ieee transactions on intelligent transportation systems , 5 , 276 wu , c. l. , chau k. w. , & li , y. s. 2008 , journal of hydrology , 358 , 96 yu , p .- s . , chen , s .-",
    ", & chang , i .-",
    "2006 , journal of hydrology , 328 , 704    lll * gradient features * & * flux evolution features * +  gradient mean &  fe sum +  gradient std &  fe absolute sum +  gradient median &  fe gradient sum +  gradient min &  fe 3@xmath26 area +  gradient max &  fe mean +  gradient skewness &  fe std +  gradient kurtosis &  fe median + * neutral line features * &  fe min +  nl length &  fe max +  nl no . fragments & * wavelet features * +  nl gradient - weighted length &  wavelet energy level 1 +  nl curvature mean &  wavelet energy level 2 +  nl curvature std &  wavelet energy level 3 +  nl curvature median &  wavelet energy level 4 +  nl curvature min &  wavelet energy level 5 +  nl curvature max & * flux features * +  nl bending energy mean &  total unsigned flux +  nl bending energy std &  total signed flux +  nl bending energy median &  total negative flux +  nl bending energy min &  total positive flux +  nl bending energy max &    lll class & peak flux ( w m@xmath83 ) & regression target value + a & @xmath84 & 0.11 + b & @xmath85@xmath86 & 19 + c & @xmath86@xmath40 & 1018 + m & @xmath40@xmath87 & 1927 + x & @xmath88 & 2836 +"
  ],
  "abstract_text": [
    "<S> we study the prediction of solar flare size and time - to - flare using 38 features describing magnetic complexity of the photospheric magnetic field . this work uses support vector regression to formulate a mapping from the 38-dimensional feature space to a continuous - valued label vector representing flare size or time - to - flare . when we consider flaring regions only , we find an average error in estimating flare size of approximately half a _ geostationary operational environmental satellite _ ( _ goes _ ) class . </S>",
    "<S> when we additionally consider non - flaring regions , we find an increased average error of approximately 3/4 a _ goes _ class . </S>",
    "<S> we also consider thresholding the regressed flare size for the experiment containing both flaring and non - flaring regions and find a true positive rate of 0.69 and a true negative rate of 0.86 for flare prediction . </S>",
    "<S> the results for both of these size regression experiments are consistent across a wide range of predictive time windows , indicating that the magnetic complexity features may be persistent in appearance long before flare activity . </S>",
    "<S> this is supported by our larger error rates of some 40 hr in the time - to - flare regression problem . </S>",
    "<S> the 38 magnetic complexity features considered here appear to have discriminative potential for flare size , but their persistence in time makes them less discriminative for the time - to - flare problem . </S>"
  ]
}