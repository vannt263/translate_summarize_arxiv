{
  "article_text": [
    "first - principles calculations based on density functional theory  @xcite ( dft ) and the pseudopotential method are widely used for studying the energetics , structure and dynamics of solids and liquids  @xcite . in the standard approach ,",
    "the occupied kohn - sham orbitals are expanded in terms of plane waves , and the ground state is found by minimizing the total energy with respect to the plane - wave coefficients  @xcite .",
    "calculations on systems of over a hundred atoms with this approach are now quite common .",
    "however , it has proved difficult to go to very much larger systems , because the computational effort in this approach depends on the number of atoms @xmath0 at least as @xmath1 , and asymptotically as @xmath2 .",
    "because of this limitation , there has been a vigorous effort in the past few years to develop linear - scaling methods  @xcite  methods in which the effort depends only linearly on the number of atoms .",
    "we have recently described a general theoretical framework for developing linear - scaling self - consistent dft schemes  @xcite .",
    "we presented one practical way of implementing such a scheme , and investigated its performance for crystalline silicon .",
    "closely related ideas have been reported by other authors  @xcite  an overview of work on linear - scaling methods was given in the introduction of our previous paper  @xcite .",
    "the practical feasibility of linear - scaling dft techniques is thus well established .",
    "however , there are still technical problems to be solved before the techniques can be routinely applied .",
    "our aim here is to study the problem of representing the localized orbitals that appear in linear - scaling methods ( support functions in our terminology )  in other words , the problem of basis functions . to put this in context , we recall briefly the main ideas of our linear - scaling dft method .",
    "standard dft can be expressed in terms of the kohn - sham density matrix @xmath3 .",
    "the total - energy functional can be written in terms of @xmath4 , and the ground state is obtained by minimization with respect to @xmath4 subject to two constraints : @xmath4 is idempotent ( it is a projector , so that its eigenvalues are 0 or 1 ) , and its trace is equal to half the number of electrons .",
    "linear - scaling behavior is obtained by imposing a limitation on the spatial range of @xmath4 : @xmath5 by the variational principle , we then get an upper bound @xmath6 to the true ground - state energy @xmath7 .",
    "since the true ground - state density matrix decays to zero as @xmath8 , we expect that @xmath9 .",
    "to make the scheme practicable , we introduced the further condition that @xmath4 be separable : @xmath10 where the number of support functions @xmath11 is finite .",
    "the limitation on the spatial range of @xmath4 is imposed by requiring that the @xmath11 are non - zero only in localized regions ( `` support regions '' ) and that the spatial range of @xmath12 is limited . in our method , the support regions are centered on the atoms and move with them .    we have shown  @xcite that the condition on the eigenvalues of @xmath4 can be satisfied by the method of li , nunes and vanderbilt  @xcite ( lnv ) : instead of directly varying @xmath4 , we express it as : @xmath13 where the asterisk indicates the continuum analog of matrix multiplication .",
    "as shown by lnv , this representation of @xmath4 not only ensures that its eigenvalues lie in the range @xmath14 $ ] , but it drives them towards the values 0 and 1 . in our scheme , the auxiliary matrix @xmath15 has the same type of separability as @xmath4 : @xmath16 this means that @xmath17 is given by the matrix equation : @xmath18 where @xmath19 is the overlap matrix of support functions : @xmath20 we can therefore summarize the overall scheme as follows .",
    "the total energy is expressed in terms of @xmath4 , which depends on the separable quantity @xmath21 .",
    "the ground - state energy is obtained by minimization with respect to the support functions @xmath11 and the matrix elements @xmath22 , with the @xmath23 confined to localized regions centered on the atoms , and the @xmath22 subject to a spatial cut - off .",
    "the @xmath11 must be allowed to vary freely in the minimization process , just like the kohn - sham orbitals in conventional dft , and we must consider how to represent them .",
    "as always , there is a choice : we can represent them either by their values on a grid  @xcite , or in terms of some set of basis functions . in our previous work",
    "@xcite , we used a grid representation .",
    "this was satisfactory for discussing the feasibility of linear - scaling schemes , but seems to us to suffer from significant drawbacks .",
    "since the support regions are centered on the ions in our method , this means that when the ions move , the boundaries of the regions will cross the grid points . in any simple grid - based scheme , this will cause troublesome discontinuities .",
    "in addition , the finite - difference representation of the kinetic - energy operator in a grid representation causes problems at the boundaries of the regions .",
    "a further point is that in a purely grid - based method we are almost certainly using more variables than are really necessary .",
    "these problems have led us to consider basis - function methods .",
    "we describe in this paper a practical basis - function scheme for linear - scaling dft , and we study its performance in numerical calculations .",
    "the basis consists of an array of localized functions  we call them `` blip functions '' .",
    "there is an array of blip functions for each support region , and the array moves with the region .",
    "the use of such arrays of localized functions as a basis for quantum calculations is not new  @xcite .",
    "however , to our knowledge it has not been discussed before in the context of linear - scaling calculations .",
    "the plan of the paper is as follows . in sec .  2",
    ", we emphasize the importance of considering the relation between blip - function and plane - wave basis sets , and we use this relation to analyze how the calculated ground - state energy will depend on the width and spacing of the blip functions .",
    "we note some advantages of using b - splines as blip functions , and we then present some practical tests which illustrate the convergence of the ground - state energy with respect to blip width and spacing .",
    "we then go on ( sec .",
    "3 ) to discuss the technical problems of using blip - function basis sets in linear - scaling dft .",
    "we report the results of practical tests , which show explicitly how the ground - state energy in linear - scaling dft converges to the value obtained in a standard plane - wave calculation .",
    "section  4 gives a discussion of the results , and presents our conclusions .",
    "some mathematical derivations are given in an appendix .",
    "before we focus on linear - scaling problems , we need to set down some elementary ideas about basis functions . to start with",
    ", we therefore ignore the linear - scaling aspects , and we discuss the general problem of solving schrdinger s equation using basis functions .",
    "it is enough to discuss this in one dimension , and we assume a periodically repeating system , so that the potential @xmath24 acting on the electrons is periodic : @xmath25 , where @xmath26 is any translation vector .",
    "self - consistency questions are irrelevant at this stage , so that @xmath24 is given .",
    "the generalization to three - dimensional self - consistent calculations will be straightforward .    in a plane - wave basis ,",
    "the wavefunctions @xmath27 are expanded as @xmath28 where the reciprocal lattice vectors of the repeating geometry are given by @xmath29 ( @xmath30 is an integer ) , and we include all @xmath31 up to some cut - off @xmath32 .",
    "we obtain the ground - state energy @xmath33 in the given basis by minimization with respect to the @xmath34 , subject to the constraints of orthonormality . for the usual variational reasons ,",
    "@xmath35 is a monotonically decreasing function of @xmath32 which tends to the exact value @xmath7 as @xmath36 .",
    "now instead of plane waves we want to use an array of spatially localized basis functions ( blip functions ) .",
    "let @xmath37 be some localized function , and denote by @xmath38 the translated function @xmath39 , where @xmath40 is an integer and @xmath41 is a spacing , which is chosen so that @xmath42 is an exact multiple of @xmath41 : @xmath43 .",
    "we use the array of blip functions @xmath38 as a basis .",
    "equivalently , we can use any independent linear combinations of the @xmath38 . in considering the relation between blip functions and plane waves ,",
    "it is particularly convenient to work with `` blip waves '' , @xmath44 , defined as : @xmath45 where @xmath46 , and @xmath47 is some normalization constant .",
    "the relation between blip waves and plane waves can be analyzed by considering the fourier representation of @xmath44 .",
    "it is straightforward to show that @xmath44 has fourier components only at wavevectors @xmath48 , where @xmath49 is a reciprocal lattice vector of the blip grid : @xmath50 ( @xmath51 is an integer ) .",
    "in fact : @xmath52 where @xmath53 is the fourier transform of @xmath37 : @xmath54    at this point , it is useful to note that for some choices of @xmath37 the blip - function basis set is exactly equivalent to a plane - wave basis set . for this to happen , @xmath53 must be exactly zero beyond some cut - off wavevector @xmath55",
    ". then provided @xmath56 and provided @xmath57 , all the @xmath58 terms in eq .",
    "( [ eq : blipwave ] ) will vanish and all blip waves for @xmath59 will be identical to plane - waves .",
    "( of course , we must also require that @xmath60 for @xmath61 . )",
    "our main aim in this section is to determine how the total energy converges to the exact value as the width and spacing of the blip functions are varied .",
    "the spacing is controlled by varying @xmath41 , and the width is controlled by scaling each blip function : @xmath62 , where @xmath63 is a scaling factor . in the case of blip functions for which @xmath53 cuts off in the way just described , the convergence of the total energy is easy to describe .",
    "suppose we take a fixed blip width , and hence a fixed wavevector cut - off @xmath55 . if the blip spacing @xmath41 is small enough so that @xmath64 , then it follows from what we have said that the blip basis set is exactly equivalent to a plane - wave basis set having @xmath65 .",
    "this means that the total energy is equal to @xmath66 and is completely independent of @xmath41 when the latter falls below the threshold value @xmath67 .",
    "this is connected with the fact that the blip basis set becomes over - complete when @xmath68 : there are linear dependences between the @xmath69 blip functions @xmath38 .",
    "it follows from this that the behavior of the total energy as a function of blip spacing and blip width is as shown schematically in fig .  1 . as the width is reduced , the cut - off @xmath55 increases in proportion to the scaling factor @xmath63 , so that the threshold spacing @xmath70 is proportional to the width . the energy value @xmath66 obtained for @xmath68 decreases monotonically with the width , as follows from the monotonic decrease of @xmath33 with @xmath32 for a plane - wave basis set",
    "note that in fig .  1 we have shown @xmath71 at fixed width as decreasing monotonically with @xmath41 for @xmath72 .",
    "in fact , this may not always happen .",
    "decrease of @xmath41 does not correspond simply to addition of basis functions and hence to increase of variational freedom : it also involves relocation of the basis functions .",
    "however , what is true is that @xmath71 for @xmath72 is always greater than @xmath71 for @xmath68 , as can be proved from the over - completeness of the blip basis set for @xmath68 . at large spacings ,",
    "the large - width blip basis is expected to give the lower energy , since in this region the poorer representation of long waves should be the dominant source of error .    up to now , we have considered only the rather artificial case where the fourier components of the blip function are strictly zero beyond a cut - off .",
    "this means that the blip function must extend to infinity in real space , and this is clearly no use if we wish to do all calculations in real space .",
    "we actually want @xmath37 to be strictly zero beyond some real - space cut - off @xmath73 : @xmath74 if @xmath75 .",
    "this means that @xmath53 will extend to infinity in reciprocal space .",
    "however , we can expect that with a judicious choice for the form of @xmath37 the fourier components @xmath53 will still fall off very rapidly , so that the behavior of the total energy is still essentially as shown in fig .  1 . if the choice is not judicious , we shall need a considerably greater effort to bring @xmath71 within a specified tolerance of the exact value than if we were using a plane - wave basis set . with a plane - wave basis ,",
    "a certain cut - off @xmath32 is needed in order to achieve a specified tolerance in @xmath71 . with blip functions whose fourier components cut off at @xmath32",
    ", we should need a blip spacing of @xmath76 to achieve the same tolerance .",
    "our requirement on the actual choice of blip function is that the spacing needed to achieve the given tolerance should be not much less than @xmath76 .      given that the blip function cuts off in real space at some distance @xmath73 , it is helpful if the function and some of its derivatives go smoothly to zero at this distance .",
    "if @xmath37 and all its derivatives up to and including the @xmath30th vanish at @xmath77 , then @xmath53 falls off asymptotically as @xmath78 as @xmath79 .",
    "one way of making a given set of derivatives vanish is to build @xmath37 piecewise out of suitable polynomials . as an example",
    ", we examine here the choice of @xmath37 as a b - spline .",
    "b - splines are localized polynomial basis functions that are equivalent to a representation of functions in terms of cubic splines .",
    "a single b - spline @xmath80 centered at the origin and covering the region @xmath81 is built out of third - degree polynomials in the four intervals @xmath82 , @xmath83 , @xmath84 and @xmath85 , and is defined as : @xmath86 the function and its first two derivatives are continuous everywhere .",
    "the fourier transform of @xmath80 , defined as in eq .",
    "( [ eq : fourier ] ) , is : @xmath87 which falls off asymptotically as @xmath88 , as expected .",
    "our choice of blip function is thus @xmath89 , so that @xmath90 .",
    "the transform @xmath91 falls rapidly to small values in the region @xmath92 .",
    "it is exactly zero at the set of wavevectors @xmath93 ( @xmath30 is a non - zero integer ) , and is very small in a rather broad region around each @xmath94 , because the lowest non - vanishing term in a polynomial expansion of @xmath95 is of degree @xmath88 .",
    "this suggests that this choice of blip function will behave rather similarly to one having a fourier cut - off @xmath96 . in other words , if we keep @xmath73 fixed and reduce the blip spacing @xmath41 , the energy should approach the value obtained in a plane - wave calculation having @xmath65 when @xmath97 .",
    "the practical tests that now follow will confirm this .",
    "( we note that b - splines are usually employed with a blip spacing equal to @xmath98 ; here , however , we are allowing the spacing to vary ) .      up to now",
    ", it was convenient to work in one dimension , but for practical tests we clearly want to go to real three - dimensional systems . to do this",
    ", we simply take the blip function @xmath99 to be the product of factors depending on the three cartesian components of @xmath100 : @xmath101 all the considerations outlined above for a blip basis in one dimension apply unchanged to the individual factors @xmath102 etc , which are taken here to be b - splines .",
    "corresponding to the blip grid of spacing @xmath41 in one dimension , the blip functions @xmath99 now sit on the points of a three - dimensional grid which we assume here to be simple cubic .",
    "the statements made above about the properties of the b - spline basis are expected to remain true in this three - dimensional form .",
    "we present here some tests on the performance of a b - spline basis for crystalline si . at first sight , it might appear necessary to write a new code in order to perform such tests .",
    "however , it turns out that rather minor modifications to an existing plane - wave code allow one to produce results that are identical to those that would be obtained with a b - spline basis . for the purpose of the present tests ,",
    "this is sufficient .",
    "the notion behind this device is that blip functions can be expanded in terms of plane waves , so that the function - space spanned by a blip basis is contained within the space spanned by a plane - wave basis , provided the latter has a large enough @xmath32 .",
    "then all we have to do to get the blip basis is to project from the large plane - wave space into the blip space . mathematical details of how to do this projection in practice are given in the appendix .",
    "the practical tests have been done with the castep code  @xcite , which we have modified to perform the necessary projections .",
    "our tests have been done on the diamond - structure si crystal , using the appelbaum - hamann  @xcite local pseudopotential ; this is an empirical pseudopotential , but suffices to illustrate the points of principle at issue here .",
    "the choice of @xmath103-point sampling is not expected to make much difference to the performance of blip functions , and we have done the calculations with a @xmath103-point set corresponding to the lowest - order 4 @xmath103-point monkhorst - pack  @xcite sampling for an 8-atom cubic cell .",
    "if we go the next - order set of 32 @xmath103-points , the total energy per atom changes by less than 0.1  ev . for reference purposes , we have first used castep in its normal unmodified plane - wave form to examine the convergence of total energy with respect to plane - wave cut - off for the appelbaum - hamann potential .",
    "we find that for plane - wave cut - off energies @xmath104 equal to 150 , 250 and 350  ev , the total energies per atom are 115.52 , 115.64 and 115.65  ev .",
    "this means that to obtain an accuracy of 0.1  ev / atom , a cut - off of 150  ev ( corresponding to @xmath105  @xmath106 ) is adequate .",
    "according to the discussion of sec .",
    "2.2 , the properties of this plane - wave basis should be quite well reproduced by a blip - function basis of b - splines having half - width @xmath107   , and the total energy calculated with this basis should converge rapidly to the plane - wave result when the blip spacing falls below @xmath108   .",
    "we have done the tests with two widths of b - splines : @xmath109 1.25 and 1.0   , and in each case we have calculated @xmath71 as a function of the blip spacing @xmath41 . in all cases ,",
    "we have used a plane - wave cut - off large enough to ensure that errors in representing the blip - function basis are negligible compared withe errors attributable to the basis itself .",
    "our results for @xmath71 as a function of @xmath41 ( fig .",
    "2 ) fully confirm our expectations .",
    "first , they have the general form indicated in fig .  1 .",
    "the difference is that since we have no sharp cut - off in reciprocal space , @xmath71 does not become constant when @xmath41 falls below a threshold , but instead continues to decrease towards the exact value .",
    "second , for @xmath110   , @xmath71 does indeed converge rapidly to the plane - wave result when @xmath41 falls below @xmath111   .",
    "third , the larger blip width gives the lower energy at larger spacings .",
    "in our linear - scaling scheme , the support functions @xmath112 must be varied within support regions , which are centered on the atoms .",
    "these regions , taken to be spherical with radius @xmath113 in our previous work , move with the atoms . in the present work , the @xmath23 are represented in terms of blip functions .",
    "each atom has a blip grid attached to it , and this grid moves rigidly with the atom .",
    "the blip functions sit on the point of this moving grid . to make the region localized",
    ", the set of blip - grid points is restricted to those for which the associated blip function is wholly contained within the region radius @xmath113 .",
    "if we denote by @xmath114 the @xmath40th blip function in the region supporting @xmath23 , then the representation is : @xmath115 and the blip coefficients @xmath116 have to be varied to minimize the total energy .",
    "the @xmath23 enter the calculation through their overlap matrix elements and the matrix elements of kinetic and potential energies .",
    "the overlap matrix @xmath19 [ see eq .",
    "( [ eq : overlap ] ) ] can be expressed analytically in terms of the blip coefficients : @xmath117 where @xmath118 is the overlap matrix between blip functions : @xmath119 which is known analytically .",
    "similarly , the kinetic energy matrix elements : @xmath120 can be calculated analytically by writing : @xmath121 where : @xmath122    however , matrix elements of the potential energy can not be treated analytically , and their integrations must be approximated by summation on a grid .",
    "this ` integration grid ' is , of course , completely distinct from the blip grids .",
    "it does not move with the atoms , but is a single grid fixed in space .",
    "if the position of the @xmath51th point on the integration grid is called @xmath123 , then the matrix elements of the local potential ( pseudopotential plus hartree and exchange - correlation potentials ) are approximated by : @xmath124 where @xmath125 is the volume per grid point . for a non - local pseudopotential",
    ", we assume the real - space version of the kleinman - bylander  @xcite representation , and the terms in this are also calculated as a sum over points of the integration grid .",
    "we note that the approximate equivalence of the b - spline and plane - wave bases discussed above gives us an expectation for the required integration - grid spacing _",
    "h_. in a plane - wave calculation , _ h _ should in principle be less than @xmath126 .",
    "but the blip - grid spacing is approximately @xmath127 .",
    "we therefore expect to need @xmath128 .    in order to calculate @xmath129 like this",
    ", we have to know all the values @xmath130 on the integration grid : @xmath131 at first sight , it would seem that each point @xmath123 would be within range of a large number of blip functions , so that many terms would have to be summed over for each @xmath123 in eq .",
    "( [ eq : support ] ) .",
    "in fact , this is not so , provided the blip functions factorize into cartesian components in the way shown in eq .",
    "( [ eq : factor ] ) . to see this ,",
    "assume that the blip grid and integration grid are cubic , let the blip - grid index @xmath40 correspond to the triplet @xmath132 , and let the factorization of @xmath133 be written as : @xmath134 where @xmath135 , @xmath136 and @xmath137 are the cartesian components of @xmath123 ( we suppress the index @xmath138 for brevity ) .",
    "the sum over @xmath40 in eq .",
    "( [ eq : support ] ) can then be performed as a sequence of three summations , the first of which is : @xmath139 the number of operations needed to calculate all these quantities @xmath140 is just the number of points @xmath132 on the blip grid times the number @xmath141 of points @xmath135 for which @xmath142 is non - zero for a given @xmath143 .",
    "this number @xmath141 will generally be rather moderate , but the crucial point is that the number of operations involved is proportional only to @xmath141 and not to @xmath144 .",
    "similar considerations will apply to the sums over @xmath145 and @xmath146 .",
    "it is worth remarking that since we have to calculate @xmath130 anyway , we have the option of calculating @xmath19 by direct summation on the grid as well .",
    "in fact , @xmath147 can also be treated this way , though here one must be more careful , since it is essential that its symmetry ( @xmath148 ) be preserved by whatever scheme we use .",
    "this can be achieved by , for example , calculating the gradient @xmath149 analytically on the integration grid and then using integration by parts to express @xmath147 as an integral over @xmath150 . in the present work ,",
    "we use the analytic forms for @xmath151 and @xmath152 .",
    "a full linear - scaling calculation requires minimization of the total energy with respect to the quantities @xmath153 and @xmath22 .",
    "however , at present we are concerned solely with the representation of @xmath153 , and the cut - off applied to @xmath22 is irrelevant .",
    "for our practical tests of the blip - function basis , we have therefore taken the @xmath22 cut - off to infinity , which is equivalent to exact diagonalization of the kohn - sham equation . apart from this ,",
    "the procedure we use for determining the ground state , i.e. minimizing @xmath71 with respect to the @xmath153 functions , is essentially the same as in our previous work  @xcite .",
    "we use conjugate - gradients  @xcite minimization with respect to the blip - function coefficients @xmath116 .",
    "expressions for the required derivatives are straightforward to derive using the methods outlined earlier  @xcite .",
    "we present here numerical tests both for the appelbaum - hamann  @xcite local pseudopotential for si used in sec .  2 and for a standard kerker  @xcite non - local pseudopotential for si .",
    "the aims of the tests are : first , to show that the b - spline basis gives the accuracy in support - function calculations to be expected from our plane - wave calculations ; and second to examine the convergence of @xmath71 towards the exact plane - wave results as the region radius @xmath113 is increased . for present purposes ,",
    "it is not particularly relevant to perform the tests on large systems .",
    "the tests have been done on perfect - crystal si at the equilibrium lattice parameter , as in sec .",
    ".total energy @xmath71 as a function of integration grid spacing @xmath154 using a region radius @xmath155   .",
    "the blip half - width @xmath73 was set to 0.905    and the blip grid spacing used was 0.4525   .",
    "the zero of energy is set equal to the result obtained with the finest grid .",
    "[ cols=\"^,^,^,^\",options=\"header \" , ]     the results obtained in our very similar tests using the kleinman - bylander form of the kerker pseudopotential for si are also shown in table  2 . in plane - wave calculations ,",
    "the plane - wave cut - off needed for the kerker potential to obtain a given accuracy is very similar to that needed in the appelbaum - hamann potential , and we have therefore used the same b - spline parameters .",
    "tests on the integration - grid spacing show that we can use the value @xmath156   , which is close to what we have used with the local pseudopotential .",
    "the total energy converges in the same rapid manner for @xmath157   , and the agreement of the converged result with the castep value is also similar to what we saw with the appelbaum - hamann pseudopotential .",
    "in exploring the question of basis sets for linear - scaling calculations , we have laid great stress on the relation with plane - wave basis sets .",
    "one reason for doing this is that the plane - wave technique is the canonical method for pseudopotential calculations , and provides the easiest way of generating definitive results by going to basis - set convergence .",
    "we have shown that within the linear - scaling approach the total energy can be taken to convergence by systematically reducing the width and spacing of a blip - function basis set , just as it can be taken to convergence by increasing the plane - wave cut - off in the canonical method . by analyzing the relation between the plane - wave and blip - function bases ,",
    "we have also given simple formulas for estimating the blip width and spacing needed to achieve the same accuracy as a given plane - wave cut - off . in addition , we have shown that the density of integration - grid points relates to the number of blip functions in the same way as it relates to the number of plane waves .",
    "finally , we have seen that the blip - function basis provides a practical way of representing support functions in linear - scaling calculations , and that the total energy converges to the plane - wave result as the region radius is increased .",
    "these results give useful insight into what can be expected of linear - scaling dft calculations .",
    "for large systems , the plane - wave method requires a massive redundancy of information : it describes the space of occupied states using a number of variables of order @xmath158 ( @xmath0 the number of occupied orbitals , @xmath69 the number of plane waves ) , whereas the number of variables in a linear - scaling method is only of order @xmath159 ( @xmath51 the number of basis functions for each support function ) .",
    "this means that the linear - scaling method needs fewer variables than the plane - wave method by a factor @xmath160 .",
    "but we have demonstrated that to achieve a given accuracy the number of blip functions per unit volume is not much greater than the number of plane waves per unit volume .",
    "then the factor @xmath160 is roughly the ratio between the volume of a support region and the volume of the entire system .",
    "the support volume must clearly depend on the nature of the system .",
    "but for the si system , we have seen that convergence is extremely rapid once the region radius exceeds @xmath161",
    " , corresponding to a region volume of 137  @xmath162 , which is about 7 times greater than the volume per atom of 20  @xmath162 . in this example , then , the plane - wave method needs more variables than the linear - scaling method when the number of atoms @xmath163 is greater than @xmath164 , and for larger systems it needs more variables by a ` redundancy factor ' of @xmath165 .",
    "( for a system of 700 atoms , e.g. , the plane - wave redundancy factor would be @xmath166 . ) in this sense , plane - wave calculations on large systems are grossly inefficient .",
    "however , one should be aware that there are other factors in the situation , like the number of iterations needed to reach the ground state in the two methods .",
    "we are not yet in a position to say anything useful about this , but we plan to return to it .    finally , we note an interesting question",
    ". the impressive rate of convergence of ground - state energy with increase of region radius shown in table  2 raises the question of what governs this convergence rate , and whether it will be found in other systems , including metals .",
    "we remark that this is not the same as the well - known question about the rate of decay of the density matrix @xmath167 as @xmath168 , because in our formulation both @xmath11 and @xmath22 play a role in the decay .",
    "our intuition is that this decay is controlled by @xmath22 .",
    "we hope soon to report results on the support functions for different materials , which will shed light on this .",
    "this project was performed in the framework of the u.k .",
    "car - parrinello consortium , and the work of cmg is funded by the high performance computing initiative ( hpci ) through grant gr / k41649 .",
    "the work of eh is supported by epsrc grant gr / j01967 .",
    "the use of b - splines in the work arose from discussions with james annett .",
    "we explain here in more detail how a standard plane - wave code can be used to test the performance of blip - function basis sets ( see sec .",
    "2.3 ) .    in a plane - wave calculation",
    ", the occupied orbitals @xmath169 are expressed as : @xmath170 where @xmath171 goes over all reciprocal lattice vectors whose magnitude is less than the plane - wave cut - off @xmath32 , and @xmath172 is the volume per cell .",
    "( we assume @xmath49-point sampling for simplicity . )",
    "the usual procedure is to minimize the total energy @xmath71 with respect to the plane - wave coefficients @xmath173 , subject to the orthonormality constraints : @xmath174    in a blip - function basis , the orbitals can be regarded as expanded in terms of the blip waves @xmath175 defined by : @xmath176 where the sum goes over all blip - grid points in one repeating cell , and * g * is any of the reciprocal - lattice vectors of the repeating cell in the brillouin zone associated with the blip grid .",
    "( the number of different @xmath171 vectors labelling @xmath177 is thus the same as the number of points of the blip grid in one cell . )",
    "the @xmath178 are orthogonal for different values of @xmath171 , and we assume that the constant @xmath179 is chosen so that the @xmath178 are normalized : @xmath180 then the orbitals are represented in terms of the blip waves as : @xmath181 and the ground state is determined by minimizing @xmath71 with respect to the blip coefficients @xmath182 subject to orthonormality : @xmath183    now the @xmath173 can be expressed in terms of the @xmath182 by using the expansion of @xmath178 in terms of plane waves : @xmath184 \\ ; , \\ ] ] where @xmath185 is the fourier transform of @xmath186 , @xmath187 is the volume per blip - grid point , and @xmath188 goes over the reciprocal - lattice vectors of the blip grid . from this",
    ", we have : @xmath189 \\ ; , \\ ] ] so that : @xmath190 note that in interpreting this equation , @xmath171 must be taken in the first brillouin zone of the blip grid .",
    "this equation implies a relation between the plane - wave coefficients @xmath191 for the same values of @xmath171 but different @xmath188 .",
    "we can therefore reproduce the effect of a blip - function basis set by performing a standard plane - wave calculation in which the @xmath191 are constrained to obey this relation . note that in practice the plane - wave calculation must involve a plane - wave cut - off , so that the @xmath191 will actually be set to zero when @xmath192 exceeds this cut - off .",
    "this is equivalent to setting @xmath193 equal to zero beyond the cut - off , and this amounts to a small smoothing of the blip function in real space .",
    "allowing for this modification , the space spanned by the blip functions is a sub - space of the space spanned by the plane waves .",
    "the constraint on the @xmath191 is therefore a linear relation between these coefficients which expresses the fact that their component orthogonal to the sub - space vanishes .",
    "it can be written as : latexmath:[\\[\\begin{aligned } 0 = c_{i \\ , { \\bf g } + { \\bf \\gamma } } - \\hat{f } ( { \\bf g } + { \\bf \\gamma } ) \\sum_{{\\bf \\gamma}^\\prime } \\hat{f}^\\ast ( { \\bf g } + { \\bf \\gamma}^\\prime ) c_{i \\ , { \\bf g } + { \\bf \\gamma}^\\prime } \\left/ \\right . \\nonumber \\\\ \\sum_{{\\bf \\gamma}^\\prime }     the modifications to the plane - wave code are therefore very simple .",
    "first , the initial guess for the orbitals must be chosen so as to satisfy this condition .",
    "second , when the @xmath191 are updated on the iterative path to the self - consistent ground state , the changes of @xmath191 must be projected so as to satisfy this condition .",
    "this means that if the unconstrained calculation would have produced the changes @xmath195 , these must be replaced by @xmath196 given by : @xmath197 this will produce exactly the same result as if we had worked directly with blip functions ."
  ],
  "abstract_text": [
    "<S> in the framework of a recently reported linear - scaling method for density - functional - pseudopotential calculations , we investigate the use of localized basis functions for such work . </S>",
    "<S> we propose a basis set in which each local orbital is represented in terms of an array of `` blip functions '' on the points of a grid . </S>",
    "<S> we analyze the relation between blip - function basis sets and the plane - wave basis used in standard pseudopotential methods , derive criteria for the approximate equivalence of the two , and describe practical tests of these criteria . </S>",
    "<S> techniques are presented for using blip - function basis sets in linear - scaling calculations , and numerical tests of these techniques are reported for si crystal using both local and non - local pseudopotentials . </S>",
    "<S> we find rapid convergence of the total energy to the values given by standard plane - wave calculations as the radius of the linear - scaling localized orbitals is increased . </S>"
  ]
}