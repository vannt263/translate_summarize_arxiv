{
  "article_text": [
    "reliable numerical predictions of reservoir performance depend on the availability and quality of data describing the heterogeneous reservoir properties , e.g. , permeability and porosity .",
    "data are in general limited in quality and quantity , resulting in significant uncertainty in petrophysical reservoir properties .",
    "furthermore , the computational complexity of a realistic reservoir model imposes limits on the resolution of the numerical model , resulting in unresolved subscale phenomena and subsequent uncertainty in effective parameter properties .",
    "uncertainty due to lack of data and complex physical correlation on multiple scales can often be be described within a stochastic framework to estimate risk or establish confidence in predictions used to make decisions in reservoir management .",
    "propagation of input uncertainty through nonlinear models calls for accurate and robust methods to satisfactorily quantify the effects on quantities of interest . forward",
    "uncertainty quantification aims at providing methods to accurately represent and propagate input uncertainty to the flow - performance predictions in a systematic way .    in the stochastic hydrology community ,",
    "statistical moment equation methods have been popular in order to quantify uncertainty in aquifers with analytical , or semi - analytical , methods @xcite .",
    "the variables and material parameters are decomposed into mean and fluctuation , or as an infinite series , and partial differential equations are derived for the moments of contaminant concentrations or hydraulic head , for example .",
    "examples of moment equation methods include @xcite where integro - differential formulations for the moments of the flux function based on measurements were derived and solved using a finite element method .",
    "the perturbation approach in combination with karhunen - love ( kl ) decomposition based on the covariance kernel of the conductivity was investigated in @xcite .",
    "the closure approximation of the partial differential equations derived in these methods may be inaccurate @xcite , and the resulting expressions are limited to small perturbations , i.e. , small variance of input parameters @xcite .",
    "stochastic analysis of nonlinear two - phase transport - the so - called buckley - leverett problem - based on moment equations in one and two spatial dimensions was presented in @xcite and @xcite . a cumulative density function ( cdf )",
    "method for the buckley - leverett equations with random total volumetric flux was introduced in @xcite .",
    "they derived a partial differential equation ( pde ) for a heaviside function involving the time dependent stochastic solution , and the associated cdf was obtained by integration with respect to the probability measure of the saturation .",
    "the generalized polynomial chaos ( gpc ) framework introduced in the seminal work in @xcite and extended in  @xcite allows for representing uncertainty in pde solutions as functions of uncertainty in the input parameters . unlike the small perturbation assumption frequently made in subsurface flow @xcite",
    ", the gpc framework imposes no formal constraint on the variance of the solution .",
    "the possible limitations in the framework lie instead in the fact that small - scale variations may require large numbers of karhunen - love terms and lead to prohibitive computational cost .",
    "provided that the velocity field can be accurately represented with a moderately small number of karhunen - love expansion terms , the kl - gpc framework should prove to be superior to perturbation based methods .",
    "flow and transport in porous media have been treated within a polynomial chaos framework previously , but most efforts and reported success have been achieved for the flow problem , e.g. , data - driven polynomial chaos for flow in co@xmath0 storage @xcite and infiltration problems in hydrology  @xcite .",
    "the log transformed hydraulic conductivity field was represented by a kl expansion and the hydraulic head obtained through resepectively monte carlo sampling , probabilistic collocation and the stochastic galerkin methods in @xcite .",
    "a similar stochastic flow model was used in @xcite , followed by model reduction of the flow field for efficient monte carlo simulation of the transport problem .    in this work ,",
    "we extend the generalized polynomial chaos and stochastic galerkin framework for the buckley - leverett equations and present analysis for stochastic fractional flow .",
    "the buckley - leverett solution is discontinuous , both in the physical and stochastic spaces .",
    "therefore , we use a localized multiwavelet basis  @xcite to represent uncertainty instead of the classical orthogonal polynomials . a multi - element partitioning of the stochastic space @xcite in combination with local wavelet bases on each stochastic element",
    "was applied to the buckley - leverett problem in @xcite .",
    "the stochastic multi - elements are mutually independent which allows parallell computation of the element - wise solutions , subsequently assembled to the global solution through a fast post - processing step .",
    "the stochastic multi - element method is computationally efficient and well suited to be combined with the methods presented in this paper .",
    "however , this will not be pursued here since the focus is somewhat different .",
    "depending on implementation , we have observed lack of convergence to the true solution and further analysis of the problem is therefore necessary .",
    "numerical properties related to convergence were investigated in a single - dimensional setting in  @xcite . in this paper , the focus is on the properties of the stochastic galerkin system , the representation and resolution of stochastic variables representing the uncertainty , and increasing the computational efficiency through stochastic basis reduction .",
    "the buckley - leverett problem is described by a nonlinear hyperbolic pde , and a stochastic formulation based on generalized polynomial chaos is expected to require a large number of stochastic basis functions for accurate representation .",
    "nevertheless , we believe that it is an attractive alternative to existing methods for solving hyperbolic stochastic pdes , especially when the wave nature of the problem is exploited to obtain local basis reduction . sampling based generalized polynomial chaos methods , such as stochastic collocation @xcite suffer from the curse of dimensionality , and they become infeasible for large problems due to the prohibitive computational cost . with the continuous growth of computer power ,",
    "stochastic galerkin methods including the efficient adaptive and parallelized hybrid stochastic galerkin solver in  @xcite , have been gaining popularity as a powerful alternative to sampling based methods .      in this paper , we provide analysis of the full stochastic galerkin system with pre - computed integrals involving stochastic basis functions and prove that the proposed formulation is hyperbolic .",
    "the full stochastic galerkin projection results in an extended system of equations , but the benefit is that there is no need for repeated expensive numerical quadrature during the flux evaluations .",
    "this is quite different from the approach taken in previous work , e.g.  @xcite , and therefore their hyperbolicity analysis can not be extended to this case .",
    "we outline a methodology to obtain saturation statistics from covariance functions of input parameters using the karhunen - love expansion and the gpc framework with multiwavelets .",
    "stochastic velocity fields are obtained for a line - injection problem based on covariance functions for the velocity components derived in  @xcite .",
    "karhunen - love expansions are also employed to represent a stochastic permeability field that is subsequently used as input to a numerical pressure solver for a quarter five - spot problem .",
    "the velocity field is obtained via darcy s law , and represented as a gpc expansion used to compute the solution to the buckley - leverett problem .",
    "we introduce a new locally reduced - order stochastic galerkin method to alleviate the computational cost of high - order gpc representations of the uncertainties .",
    "the local reduction of the order of multiwavelet expansion does not adversely affect the accuracy of the solution , but reduces the numerical cost by neglecting multiwavelet modes that are locally insignificant .",
    "the performance of the method is demonstrated for one- and two - dimensional ( in physical space ) problems , and for both single and multiple stochastic dimensions .",
    "depending on the problem setup , the speedup observed is up to more than an order of magnitude compared to the standard stochastic galerkin implementation without local basis reduction or other means of adaptivity .",
    "let @xmath1 denote the water saturation in a subsurface porous medium , modeled by the buckley - leverett equation @xmath2 defined on a spatial domain @xmath3 , with the scalar flux function @xmath4 and porosity @xmath5 . the total flux @xmath6 is given by darcy s law : @xmath7 where @xmath8 is pressure and @xmath9 is the total mobility , defined as @xmath10 here",
    ", @xmath11 denotes absolute permeability , @xmath12 ( @xmath13 ) is the relative permeability of the wetting ( @xmath14 ) and non - wetting ( @xmath15 ) phases , respectively , and @xmath16 ( @xmath13 ) denotes the phase viscosity .",
    "we invoke the incompressibility condition @xmath17 to provide an input flux @xmath18 to , we solve with a measured , or estimated , total mobility ( conductivity ) field as input . in the multiphase case",
    ", the total mobility takes the role of hydraulic conductivity . due to limited site - specific measurements ,",
    "stochastic models for the input are commonly assumed .",
    "the permeability field is typically unknown due to the infeasibility of including an exact geologic description .",
    "this results in uncertainty in the total mobility .",
    "we rewrite ( [ eqn : bl_conv_gen ] ) in the form @xmath19    with the relative - permeability functions @xmath20 and @xmath21 , the fractional flow flux function @xmath4 is given by @xmath22 where @xmath23 . for analysis of hyperbolicity of the stochastic formulation",
    ", we will find it useful to express the buckley - leverett equation ( [ eqn : bl_conv ] ) in quasi - linear form , @xmath24 where @xmath25",
    "when the covariance function of a random field is known , it is optimally represented in a spectral expansion by the _ karhunen - love _ expansion @xcite .",
    "the covariance function is often quite difficult to obtain , even for static input parameters ( e.g. , permeability ) , and we are interested in quantifying the uncertainty in output parameters that result from a nonlinear dynamic process ( multiphase transport ) . for output quantities of interest ,",
    "the covariance function is in general not known at all , but we can combine the karhunen - love framework with multiwavelet expansions to represent input random fields , e.g. , permeabilities . the multiwavelet representation",
    "is then employed in order to propagate the uncertainty to the outputs of interest .",
    "consider a vector valued random field @xmath26 in two spatial dimensions with known matrix - valued covariance function @xmath27 where @xmath28 . in the numerical experiments",
    ", @xmath29 will either be equal to the velocity field @xmath30 , or the total mobility determined by the log - permeability field @xmath31 which may be represented as a gaussian random field  @xcite .",
    "a realistic covariance model for the velocity field must in general be based on numerical simulation of the pressure distributions . following @xcite , the field @xmath29 with expectation @xmath32",
    "can be approximated by the truncated karhunen - love expansion @xmath33 where @xmath34 is a random vector where the entries are uncorrelated random variables with probability measure @xmath35 .",
    "the generalized eigenpairs @xmath36 can be determined from the solution of the generalized eigenvalue problem @xmath37 the accuracy of the truncated kl expansion is determined by the order of expansion @xmath38 and the decay of the eigenvalues @xmath39 .",
    "the karhunen - love expansion is bi - orthogonal , i.e. @xmath40 the probability distribution of the random variable @xmath41 is defined by @xmath42 in order to exploit the richness of the stochastic representation by accurately estimating @xmath43 , excessive sampling of   would be required . in the following however , we will _ assume _ that we have sufficient information and choose some probability law for @xmath44 .",
    "a common assumption on the probability law of @xmath45 is gaussian distribution . in this case",
    "the fact that the random variables are uncorrelated also implies that they are independent . note that in general , the entries of the vector @xmath29 are not independent",
    "this will be the case for the random velocity field in @xcite used in section [ sec : num_res_rub90 ] .",
    "it is common in subsurface flow to assume the exponential covariance function , attractive for its analytical expressions for eigenvector - eigenvalue pairs . for the log - permeability field @xmath46 on a domain of size @xmath47 , we assume the separable exponential covariance function @xmath48 with correlation lengths @xmath49 , @xmath50 , variance @xmath51 and @xmath52 . for this covariance function , the eigenvalues @xmath53 and eigenfunctions @xmath54 in   are the ordered products of the one - dimensional eigenpairs , given by respectively @xmath55 and @xmath56 where @xmath57 are the ordered ( @xmath58 ) positive solutions of @xmath59      let @xmath60 be a vector of random variables parameterizing the uncertainties of the input fields defined on a space @xmath61 , where @xmath62 is the set of events , @xmath63 is the @xmath64-algebra and @xmath35 is the probability measure .",
    "we will assume that the entries of @xmath65 are independent and identically distributed . in this work",
    ", @xmath65 is identical to the random vector of the kl expansion introduced in section  [ sec : kl_exp ] .",
    "the inner product of two functionals @xmath66 is defined by @xmath67 the inner product induces a norm denoted @xmath68 .    for @xmath69 ,",
    "let @xmath70 be a univariate basis of e.g. , polynomials that are orthonormal w.r.t .",
    "the measure of @xmath71 , i.e. @xmath72 we obtain a multi - variate basis @xmath73 by the tensor product @xmath74 with the multi - index @xmath75 . for practical calculations",
    ", the multi - index @xmath76 must be truncated in order to generate a finite cardinality basis .",
    "we use a total order @xmath8 basis defined by the index set @xmath77 the total number of basis functions is then @xmath78 to facilitate notation , we re - index the stochastic basis functions starting from 1 .",
    "any @xmath79 can be represented by the generalized polynomial chaos expansion @xmath80 where the coefficients @xmath81 are defined by the projections",
    "@xmath82 then , in single - index notation @xmath83    approximation of the integrals to evaluate the gpc coefficients ( [ eq : proj_coe ] ) in general involves quadrature in multiple dimensions .",
    "tensorization of univariate quadrature rules , e.g. gauss quadrature , quickly become infeasible as the number of stochastic dimensions grows .",
    "sparse quadrature rules offer a computationally attractive alternative .",
    "smolyak s rule based on a subset of weights and points from a range of tensorized quadrature rules @xcite is an important example . instead of computing the stochastic integrals in every temporal and spatial grid point , we derive an extended system based on stochastic projection .",
    "thus , all stochastic integrals are precomputed , and we are left with solving an extended initial - boundary - value problem .",
    "some input and output quantities of interest ( porosity , saturation ) are restricted to intervals that represent physically meaningful solutions .",
    "to ensure that stochastic variation does not lead to unbounded quantities , we use stochastic basis functions with bounded support to represent uncertainty .",
    "wavelet bases obtained from multi - resolution analysis for representation of stochastic functions were introduced in  @xcite .",
    "wavelets are localized basis functions organized in a hierarchy of different resolution levels .",
    "each successive resolution level represents finer features of the solution .",
    "the wavelets have non - overlapping support within each resolution level , and in this sense they are localized .",
    "still , the basis is global due to the overlapping support of wavelets belonging to different resolution levels .",
    "the localization of the basis alleviates the gibbs phenomenon in the proximity of discontinuities in the stochastic dimension .",
    "we start by briefly describing the multiwavelet basis in a single dimension .",
    "a more detailed account can be found in  @xcite .",
    "let @xmath84 be the space of polynomials of degree at most @xmath85 defined on the interval @xmath86 $ ] .",
    "the construction of multiwavelets aims at finding a basis of piecewise polynomials for the orthogonal complement of @xmath84 in the space @xmath87 of polynomials of degree at most @xmath88 . merging the bases of @xmath84 and that of the orthogonal complement of @xmath84 in @xmath87",
    ", we obtain a piecewise polynomial basis for @xmath87 . continuing",
    "the process of finding orthogonal complements in spaces of increasing degree of piecewise polynomials , leads to a basis for @xmath89)$ ] .",
    "we first introduce a smooth polynomial basis on @xmath86 $ ] .",
    "let @xmath90 be the set of legendre polynomials that are defined on @xmath86 $ ] and orthogonal with respect to the uniform measure .",
    "the set @xmath91 is an orthonormal basis for @xmath84 .",
    "following the algorithm in @xcite , we next introduce a set of mother wavelets @xmath92 defined on the domain @xmath93 $ ] . by construction ,",
    "the members of the set @xmath94 are orthogonal to all polynomials of order at most @xmath85 , hence the wavelets are orthogonal to the set @xmath95 of legendre polynomials . based on translations and dilations of the mother wavelets ,",
    "we get the wavelet family @xmath96 we can now define the multiwavelet basis @xmath97 as follows .",
    "let @xmath98 for @xmath99 be the set of legendre polynomials up to order @xmath85 , and concatenate the indices @xmath100 into @xmath101 so that @xmath102 for @xmath103 .",
    "with the multiwavelet basis @xmath104 we can represent any random variable @xmath105 with finite variance as @xmath106 which is in the form ( [ eq : def_gpc ] ) with the global polynomials replaced by piecewise polynomials . in the computations , we truncate the wavelet series both in terms of the piecewise polynomial order @xmath85 and the resolution level @xmath107 .",
    "we retain @xmath108 terms of the multiwavelet expansion . in multiple dimensions",
    ", we use a total order basis within each resolution level , i.e. a total of @xmath109 basis functions .",
    "the truncated wavelet basis is characterized by the piecewise polynomial order @xmath85 and the number of resolution levels @xmath107 . as special cases of the wavelet basis ,",
    "we obtain the legendre polynomial basis for @xmath110 ( @xmath111 ) , and the haar wavelet basis of piecewise constant functions for @xmath112 .",
    "since the legendre polynomials are a subset of the multiwavelets , we will henceforth use the term multiwavelets ( mw ) to denote all the sets of basis functions in this paper .",
    "inserting the mw expansions of @xmath1 and @xmath113 into ( [ eqn : bl_conv ] ) and truncating to a finite order @xmath114 , we arrive at @xmath115 multiplying ( [ eq : bl_w_gpc_v ] ) by @xmath116 , rearranging and integrating w.r.t .",
    "the measure @xmath35 and using the orthogonality of the stochastic basis , we get @xmath117 where @xmath118 denotes the expectation operator w.r.t .",
    "@xmath65 . for completeness of the presentation and for comparison with the analysis",
    "later in this paper , we next reproduce the analysis of hyperbolicity for the buckley - leverett problem that was previously presented for related but different problems in  @xcite .",
    "[ thm : class_hyp_pr ] the stochastic galerkin formulation ( [ eq : bl_sg_mat ] ) of any order @xmath119 is hyperbolic .    the semi - linear form of ( [ eq : bl_sg_mat ] ) in matrix form can be written @xmath120 where @xmath121 , and the jacobian matrices are @xmath122_{kj } = \\left\\langle \\left ( \\sum_{i=1}^{p}v^{(x)}_{i } \\psi_i \\right ) f'\\left(\\sum_{j'=1}^{p}s_{j ' } \\psi_{j ' } \\right ) \\psi_{j}\\psi_{k } \\right\\rangle , \\\\ \\label{eq : jy_def } & [ \\bm{j}_{y}(\\bm{s}^{p})]_{kj } = \\left\\langle \\left ( \\sum_{i=1}^{p}v^{(y)}_{i } \\psi_i \\right ) f'\\left(\\sum_{j'=1}^{p}s_{j ' } \\psi_{j ' } \\right ) \\psi_{j}\\psi_{k } \\right\\rangle.\\end{aligned}\\ ] ] it follows from ( [ eq : jx_def ] ) and ( [ eq : jy_def ] ) that @xmath123 and @xmath124 are both symmetric .",
    "thus , for any real constants @xmath125 , the matrix @xmath126 is also symmetric and has an eigenvector decomposition with real eigenvalues .",
    "it follows that ( [ eq : bl_sg_mat ] ) is hyperbolic for any @xmath127 .",
    "a numerical method for the stochastic galerkin buckley - leverett problem requires the approximation of stochastic integrals over nonlinear functions of @xmath128 ( i.e. , the matrices @xmath129 and @xmath130 defined in ( [ eq : jx_def ] ) and ( [ eq : jy_def ] ) ) at each spatial point and at each time step .",
    "likewise , in order to evaluate the stochastic galerkin flux function numerically , we also need to compute @xmath131 where @xmath132 in the remainder of this section , we will only treat the @xmath133-dimension in the analysis , since the results for the @xmath134-dimension are analogous .",
    "repeated calculations of ( [ eq : inpr_flux ] ) are costly due to the stochastic integrals over rational expressions of the basis functions .",
    "even though direct evaluation of these integrals through , say , a low - order quadrature rule may indeed be feasible to perform online , we would ideally like to avoid online numerical quadrature for the stochastic galerkin system . to alleviate the computational cost",
    ", we introduce an approximation based on repeated application of the _ pseudo - spectral approximation _",
    "the idea behind the pseudo - spectral approximation is to replace complex and costly stochastic integrals with a series of less complex and less costly stochastic integrals that can be pre - computed and used throughout the simulation",
    ". it will be practical to express algebraic operations on mw representations of stochastic variables as sequences of matrix - vector multiplications .",
    "for any functions @xmath135 of order @xmath114 of mw approximations in vector form , @xmath136 , we define the matrices @xmath137 and @xmath138 , @xmath139_{jk } & \\equiv \\sum_{i=1}^{p } \\left\\langle \\psi_i \\psi_j \\psi_k \\right\\rangle a_i , \\quad j , k=1,\\dots , p .",
    "\\\\ \\label{eq : b_def }   [ \\bm{b}(\\bm{a}^{p } , \\bm{b}^{p})]_{jk } & \\equiv \\sum_{h=1}^{p } \\sum_{i=1}^{p }   \\langle \\psi_{h } \\psi_{i } \\psi_{j } \\psi_{k}\\rangle a_{h } b_{i } , \\quad j , k=1,\\dots , p . \\end{aligned}\\ ] ] for inner triple and inner quadruple products of basis functions , respectively . for the computation of the mw coefficients of the product @xmath140 of two stochastic functions",
    "@xmath141 and @xmath142 , we have @xmath143 or , in matrix - vector notation , @xmath144 to compute the mw coefficients of the stochastic product of three functions , @xmath145 we get , by projection onto the first @xmath114 basis functions , @xmath146 equivalently , this product can be written in matrix - vector notation , where the vector of mw coefficients @xmath147 are given by , @xmath148    using the matrix notation introduced above , the stochastic galerkin flux function for the buckley - leverett problem is defined by the vector of mw coefficients @xmath149 that satisfies the linear system @xmath150 \\bm{f}^{\\scriptscriptstyle{p } } = \\bm{b}(\\bm{s}^{p},\\bm{s}^{p})\\bm{u}^{\\scriptscriptstyle{p}}.\\ ] ] note that the proof of hyperbolicity of proposition  [ thm : class_hyp_pr ] does not hold for the stochastic galerkin flux based on evaluation of precomputed stochastic inner products .",
    "next , we will present proof of hyperbolicity applicable to this problem flux formulation .",
    "[ thm : hyperb_pssp ] let @xmath151 be positive definite and let @xmath114 be any order of mw approximation .",
    "then the stochastic galerkin formulation with the flux ( [ eq : quad_sg_flux ] ) is hyperbolic .    by the chain rule , for @xmath152 , @xmath153^{-1 }",
    "\\\\ \\times \\left [ \\bm{b}(\\bm{s}^{p},\\bm{e}_{k } ) - a \\bm{b}(\\bm{e}_{1}-\\bm{s}^{\\scriptscriptstyle{p } } , \\bm{e}_{k } ) \\right ]   \\left [ \\bm{b}(\\bm{s}^{p},\\bm{s}^{p})+a \\bm{b}(\\bm{e}_{1}-\\bm{s}^{\\scriptscriptstyle{p } } , \\bm{e}_{1 } - \\bm{s}^{\\scriptscriptstyle{p } } ) \\right]^{-1 }   \\\\   \\times \\bm{b}(\\bm{s}^{p},\\bm{s}^{p})\\bm{u}^{\\scriptscriptstyle{p } }   + 2 \\left [ \\bm{b}(\\bm{s}^{p},\\bm{s}^{p})+a \\bm{b}(\\bm{e}_{1}-\\bm{s}^{\\scriptscriptstyle{p } } , \\bm{e}_{1 } - \\bm{s}^{\\scriptscriptstyle{p } } ) \\right]^{-1 } \\bm{b}(\\bm{s}^{p},\\bm{u}^{\\scriptscriptstyle{p } } ) \\bm{e}_{k}.\\end{gathered}\\ ] ] let @xmath154^{-1 } \\bm{b}(\\bm{s}^{p},\\bm{s}^{p})$ ] .",
    "then @xmath155^{-1 } \\\\",
    "\\times   \\left [ \\bm{b}(a(\\bm{e}_{1}-\\bm{s}^{p})-\\bm{s}^{p},\\bm{w}^{p})+ \\bm{b}(\\bm{s}^{\\scriptscriptstyle{p } } , \\bm{u}^{\\scriptscriptstyle{p } } ) \\right].\\end{gathered}\\ ] ] thus , the flux jacobian @xmath156 is a product of two symmetric matrices , @xmath157^{-1 } ,   \\nonumber \\\\   & \\bm{m}_{2}=\\left [ \\bm{b}(a(\\bm{e}_{1}-\\bm{s}^{p})-\\bm{s}^{p},\\bm{w}^{p})+ \\bm{b}(\\bm{s}^{\\scriptscriptstyle{p } } , \\bm{u}^{\\scriptscriptstyle{p } } ) \\right ] . \\nonumber\\end{aligned}\\ ] ] by assumption , @xmath158 is positive definite ( since its inverse is positive definite ) , and there exists an invertible and symmetric square root matrix , denoted @xmath159 , that satisfies @xmath160 .",
    "now , @xmath161 is similar to the symmetric matrix @xmath162 . since @xmath156 is similar to a diagonalizable matrix with real eigenvalues , @xmath156 is also diagonalizable with real eigenvalues , hence the flux formulation is hyperbolic .",
    "the evaluation of the matrix @xmath163 through fourth - order tensors is relatively costly , especially in a setting where the number of stochastic dimensions is large .",
    "alternatively , one may instead compute products of three functions by successively computing the mw coefficients of products of two stochastic functions , i.e. introducing the approximation @xmath164 the successive application of the matrix @xmath137 instead of @xmath138 is computationally efficient but introduces a stochastic aliasing error .    as an alternative to",
    ", we may compute the vector of flux mw coefficients @xmath165 by solving the linear system @xmath166   \\bm{f}^{p}= \\bm{a}(\\bm{s}^{p } ) \\bm{s}^{p}\\ ] ] the approximation ( [ eq : trip_sg_flux ] ) is based on successive application of pairwise pseudo - spectral products in order to avoid computation of stochastic inner products of higher order . the flux function ( [ eq : trip_sg_flux ] )",
    "is a suitable approximation if the error is negligible in comparison with ( [ eq : inpr_flux ] ) .",
    "due to discontinuities and other sharp features , an accurate representation of a hyperbolic pde solution in general requires high - order mw expansion . for solutions of odes , at a given time certain parts of the stochastic domain",
    "more significantly affects the solution than other regions of the domain .",
    "a temporally evolving adaptive stochastic basis might be an efficient alternative for these problems  @xcite .",
    "for a fixed point in physical space , we can expect similar behavior of a hyperbolic pde solution : certain regions of stochastic space need a finer basis for accurate representation than others .",
    "however , for a different spatial location , a different region of stochastic space will significantly impact the solution features .",
    "we can localize the stochastic basis in space and time , but we must maintain coupling since the solution at any spatial point will be affected by any given mw mode at some point in time .",
    "this makes adaptive methods for mw solutions of pdes difficult . in particular , for stochastic galerkin methods it is non - trivial to adaptively modify the stochastic basis by modifying the large system matrices involved . as an example , if one wants to compute the flux between two spatially adjacent grid points that are represented by different basis functions , one needs to complement both bases with the missing functions from the adjacent grid points to be able to propagate the flux .",
    "after that , one needs to perform basis reduction to maintain adaptivity of the bases , otherwise nothing is gained in computational cost by localizing the basis functions .    to avoid the cumbersome procedure described above , we devise an adaptive stochastic galerkin method in the following way .",
    "the set of all admissible stochastic basis functions is determined and the inner products corresponding to the matrices @xmath167 and @xmath163 in   and   are computed and stored . for any given point @xmath168 in space and time , the computed solution vector @xmath128 may have negligible entries that can be ignored in the flux evaluation . more generally , assuming that we want to perform a pseudospectral multiplication involving three mw vectors @xmath169 , @xmath170 , and @xmath171 , we first determine their local representations by only retaining the mw coefficients that are significant , i.e. , greater in absolute value than some prescribed small threshold value @xmath172 .",
    "we identify the index set @xmath173 and set @xmath174 .",
    "similarly , reduced basis index sets for all mw expansions involved are identified at a cost that is linear in the order of mw expansion .",
    "the vectors @xmath169 , @xmath170 , and @xmath171 are thus replaced by @xmath175 , @xmath176 , and @xmath177 where @xmath178 . at a reduced cost , we may now approximate the matrices @xmath167 and @xmath163 , @xmath179_{jk } \\approx [ \\tilde{\\bm{a}}(\\bm{a}^{p_{\\bm{a}}})]_{jk } \\equiv \\sum_{i \\in j_{\\bm{a } } } \\left\\langle \\psi_{i}\\psi_{j}\\psi_{k } \\right\\rangle a_{i }",
    ",   \\quad j , k = 1,\\dots , p,\\ ] ] @xmath180_{jk } \\approx [ \\tilde{\\bm{b}}(\\bm{a}^{p_{\\bm{a } } } , \\bm{b}^{p_{\\bm{b}}})]_{jk } \\equiv \\sum_{h \\in j_{\\bm{a } } , i \\in j_{\\bm{b } } } \\left\\langle \\psi_{h } \\psi_{i}\\psi_{j}\\psi_{k } \\right\\rangle a_{h}b_{i } ,   \\quad j , k = 1,\\dots , p.\\ ] ] the matrices @xmath181 and @xmath182 are of the same size @xmath183 as @xmath184 and @xmath185 , but they are formed using fewer floating - points operations .",
    "these matrices are used to compute stochastic products via the matrix - vector products @xmath186 further cost reduction in the evaluations of  - is possible by using the sparsity in @xmath170 in   and the sparsity in @xmath171 in  . in  ,",
    "non - zero columns of @xmath181 that are multiplied with almost - zero entries of @xmath170 have negligible contribution to the matrix - vector product and can be omitted without loss of accuracy . similarly , column vectors of @xmath187 that are multiplied by almost - zero entries of @xmath171 in   can also be omitted .",
    "this is achieved by introducing reduced - size matrices @xmath188 where @xmath189 and @xmath190 .",
    "the construction of the reduced - cost matrix - vector products is systematic and efficient since it only involves a direct ( linear ) search of the vectors @xmath169 , @xmath170 , and @xmath171 to find the index sets @xmath191 , @xmath192 , and @xmath193 .",
    "there is no need to search the matrices for negligible elements .",
    "it is possible to improve on the cost of searching the vectors for significant mw entries by exploiting the hierarchical structures of wavelets .",
    "if the search is performed from coarse levels to fine levels of stochastic partitioning and a wavelet is found to have insignificant impact , then one may terminate the procedure since the descendants of that wavelet will also be negligible .",
    "this strategy is of particular interest in stochastic representations with a large number of wavelet levels but will not be further considered in this work .",
    "note that due to the space - time localization of hyperbolic problems ( traveling waves ) , by setting a very small threshold @xmath172 the approximation is essentially exact , but we nevertheless obtain a substantial cost reduction by avoiding costly operations that have almost zero contribution .",
    "this strategy is pursued in the numerical experiments and no reduction in accuracy is observed - only in computational time - by using the locally reduced - order basis .",
    "the reduced - order stochastic galerkin method can be implemented with any numerical method that can capture the highly discontinuous solution of the extended nonlinear system of hyperbolic pdes .",
    "we use a riemann solver with the hll ( after harten , lax and van leer ) flux introduced in @xcite and further developed by @xcite .",
    "the hll solver relies on estimates of the fastest velocities , @xmath194 and @xmath195 , i.e. the estimated minimum and maximum eigenvalues of the jacobian @xmath196 of the flux .",
    "kurganov et al .",
    "presented a class of central - upwind schemes where their second - order accurate polynomial reconstruction is very similar to the hll flux @xcite .",
    "the numerical flux function we use can thus also be labeled a central - upwind flux .    at the interface between the cells @xmath197 and @xmath198 in a single dimension ,",
    "the vector valued hll flux is defined by @xmath199 where @xmath200 and @xmath201 denote flux - limited left and right states , respectively . in the numerical experiments , we use the the minmod limiter since more diffusive flux limiters might lead to failure in resolving composite waves for non - convex flux functions  @xcite .",
    "in general , obtaining accurate eigenvalue estimates may be computationally costly .",
    "note that in the deterministic case , we expect @xmath202 , and the scheme becomes an upwind scheme , since this implies @xmath203 . however , this is not necessarily the case in the stochastic galerkin setting .",
    "the generalization to two dimensions coincides with the dimension - by - dimension application of the one - dimensional flux function .",
    "it should be noted , however , that the derivation of the scheme is genuinely multi - dimensional .",
    "it has been proven to satisfy a discrete maximum principle subject to a time - step restriction in two dimensions together with the minmod flux limiter @xcite .",
    "this is an important property due to the fact that in many cases dimension - by - dimension treatment of the flux limiters lead to spurious oscillations of the solution @xcite and we do indeed encounter them when the discrete maximum principle in @xcite is not fulfilled . the time - step restriction due to the discrete maximum principle is more strict than the cfl ( courant - friedrichs - lewy ) condition that is necessary but not sufficient to ensure stability for the runge - kutta method used for the time integration .",
    "to study numerical convergence , we first present an example in one spatial dimension and a single stochastic variable . let the velocity @xmath204 be spatially constant ( consistent with the incompressibility assumption ) and uniformly distributed , @xmath205 $ ] , @xmath206 , and consider a riemann problem with @xmath207 for @xmath208 , @xmath209 for @xmath210 . since @xmath204 is random , @xmath1 is also random .",
    "however , the randomness in @xmath204 does not affect the value @xmath211 of the water saturation at the shock .",
    "therefore , the shock location of the stochastic problem can be found by analysis of the characteristics , @xmath212 where @xmath213 is the initial location of the discontinuity . since the velocity @xmath204 is restricted to a finite interval , we expect shocks of the realizations of the solution to be confined to the interval @xmath214 $ ]",
    ". the stochastic galerkin approximation of the original stochastic problem should reflect this fact .",
    "figure [ fig : bl_1dl_p_2_4_8 ] depicts the mean value for different orders of piecewise constant wavelets , @xmath215 ( left ) , @xmath216 ( middle ) and @xmath217 ( right ) .",
    "the multiple discontinuities are located within the interval @xmath218 $ ] corresponding to the spread of the shocks of the original problem , as seen in figure [ fig : bl_1dl_mean_and_var ] .",
    "the numerical convergence in comparison to a monte carlo reference solution of the single - dimensional case was investigated for various values of the viscosity ratio in @xcite .",
    "it was found that multiwavelets with relatively low - order piecewise polynomial were appropriate to represent the solution .",
    "the piecewise linear and quadratic wavelets employed in the numerical results below do not exhibit the oscillations around discontinuities observed when using higher order polynomial representation .",
    "such oscillations are important to avoid since they may lead to unphysical solution values ( e.g. negative saturation ) and breakdown of the numerical method .",
    "the mw approximation deteriorates over time due to the growth of the higher order mw coefficients which makes the stochastic truncation error more severe with time  @xcite .",
    "an interesting phenomenon related to this fact has been noted in the numerical results .",
    "if the stochastic truncation error grows sufficiently large , the lower - order mw coefficients grow in unexpected ways .",
    "this is shown in figure  [ fig : basis_comp_1d ] ( a ) where a @xmath219 ( @xmath220 ) order wavelet basis has been used .",
    "the hll solver yields a mean solution that is not monotone and therefore evidently a poor approximation . for comparison ,",
    "the solution using the more diffusive lax - friedrichs flux with minmod flux limiters yields a monotone solution and might appear as a better choice in this case .",
    "however , this flux function can never capture the true solution unless the mesh is excessively fine .",
    "in contrast , if the order of wavelet refinement is increased as in figure  [ fig : basis_comp_1d ] ( b ) where a @xmath221 ( @xmath222 ) order basis is used , the hll solver performs well and captures the statistics of the solution .",
    "in addition , with a mw basis with sufficient piecewise polynomial order , the discontinuities seen in figure  [ fig : bl_1dl_mean_and_var ] are no longer visible in figure  [ fig : basis_comp_1d ] ( b ) .",
    "we will therefore use the hll solver in the rest of the manuscript and make sure that the stochastic basis employed is rich enough not to result in unphysical solutions similar to those shown in figure  [ fig : basis_comp_1d ] ( a ) .",
    "the system size grows linearly in the mw expansion order @xmath114 and for practical applications it is essential to alleviate the computational cost .",
    "figure  [ fig : temp_comp_1d ] depicts the simulation times as a function of the order of mw expansion .",
    "piecewise linear and piecewise quadratic wavelets are used as basis functions and we compare the solution of the full system with the adaptive reduced - order model described in section  [ sec : adapt_red_order ] . for large @xmath114 , the gain in computational cost is more than an order of magnitude .",
    "( 0,6 ) ; ( 0,6 ) ",
    "( 0,7 ) ;    ( 0,0 ) ",
    "( 6,0 ) ; ( 6,0 ) ",
    "( 7,0 ) ;    ( 0.5,0 )  ( 0.5,5 ) ; ( 1.0,0 ) ",
    "( 1.0,5 ) ; ( 1.5,0 ) ",
    "( 1.5,5 ) ; ( 2.0,0 ) ",
    "( 2.0,5 ) ; ( 2.5,0 ) ",
    "( 2.5,5 ) ; ( 3.0,0 ) ",
    "( 3.0,5 ) ; ( 3.5,0 ) ",
    "( 3.5,5 ) ; ( 4.0,0 ) ",
    "( 4.0,5 ) ; ( 4.5,0 ) ",
    "( 4.5,5 ) ; ( 5,0 ) ",
    "( 5,5 ) ;    ( 0,0.5 ) ",
    "( 5,0.5 ) ; ( 0,1.0 ) ",
    "( 5,1.0 ) ; ( 0,1.5 ) ",
    "( 5,1.5 ) ; ( 0,2.0 ) ",
    "( 5,2.0 ) ; ( 0,2.5 ) ",
    "( 5,2.5 ) ; ( 0,3.0 ) ",
    "( 5,3.0 ) ; ( 0,3.5 )  ( 5,3.5 ) ; ( 0,4.0 ) ",
    "( 5,4.0 ) ; ( 0,4.5 ) ",
    "( 5,4.5 ) ; ( 0,5 ) ",
    "( 5,5 ) ;    at ( 0,-0.25 ) @xmath223 ; at ( 5,0 ) @xmath224 ; at ( 0,5 ) @xmath224 ; at ( 6,0 ) @xmath133 ; at ( 0,6 ) @xmath134 ;    ( -0.4,1.25 )  ( 0.4,1.25 ) ; ( 0.4,1.25 ) ",
    "( 1.4,1.25 ) ; ( -0.4,2.25 )  ( 0.4,2.25 ) ; ( 0.4,2.25 ) ",
    "( 1.4,2.25 ) ; ( -0.4,3.25 )  ( 0.4,3.25 ) ; ( 0.4,3.25 ) ",
    "( 1.4,3.25 ) ; ( -0.4,4.25 )  ( 0.4,4.25 ) ; ( 0.4,4.25 ) ",
    "( 1.4,4.25 ) ; ( 4.6,1.25 ) ",
    "( 5.4,1.25 ) ; ( 5.4,1.25 ) ",
    "( 6.4,1.25 ) ; ( 4.6,2.25 ) ",
    "( 5.4,2.25 ) ; ( 5.4,2.25 ) ",
    "( 6.4,2.25 ) ; ( 4.6,3.25 ) ",
    "( 5.4,3.25 ) ; ( 5.4,3.25 ) ",
    "( 6.4,3.25 ) ; ( 4.6,4.25 ) ",
    "( 5.4,4.25 ) ; ( 5.4,4.25 ) ",
    "( 6.4,4.25 ) ;    ( 0.0,5 )  ( 0.4,5.4 ) ; ( 0.25,5 ) ",
    "( 0.65,5.4 ) ; ( 0.5,5 ) ",
    "( 0.9,5.4 ) ; ( 0.75,5 ) ",
    "( 1.15,5.4 ) ; ( 1.0,5 ) ",
    "( 1.4,5.4 ) ; ( 1.25,5 ) ",
    "( 1.65,5.4 ) ; ( 1.5,5 )  ( 1.9,5.4 ) ; ( 1.75,5 ) ",
    "( 2.15,5.4 ) ; ( 2.0,5 )  ( 2.4,5.4 ) ; ( 2.25,5 ) ",
    "( 2.65,5.4 ) ; ( 2.5,5 ) ",
    "( 2.9,5.4 ) ; ( 2.75,5 ) ",
    "( 3.15,5.4 ) ; ( 3.0,5 ) ",
    "( 3.4,5.4 ) ; ( 3.25,5 ) ",
    "( 3.65,5.4 ) ; ( 3.5,5 ) ",
    "( 3.9,5.4 ) ; ( 3.75,5 )  ( 4.15,5.4 ) ; ( 4.0,5 ) ",
    "( 4.4,5.4 ) ; ( 4.25,5 ) ",
    "( 4.65,5.4 ) ; ( 4.5,5 ) ",
    "( 4.9,5.4 ) ; ( 4.75,5 ) ",
    "( 5.15,5.4 ) ;    ( 0.0,-0.4 )  ( 0.4,0 ) ; ( 0.25,-0.4 )  ( 0.65,0 ) ; ( 0.5,-0.4 )  ( 0.9,0 ) ; ( 0.75,-0.4 )  ( 1.15,0 ) ; ( 1.0,-0.4 ) ",
    "( 1.4,0 ) ; ( 1.25,-0.4 ) ",
    "( 1.65,0 ) ; ( 1.5,-0.4 ) ",
    "( 1.9,0 ) ; ( 1.75,-0.4 ) ",
    "( 2.15,0 ) ; ( 2.0,-0.4 )  ( 2.4,0 ) ; ( 2.25,-0.4 ) ",
    "( 2.65,0 ) ; ( 2.5,-0.4 ) ",
    "( 2.9,0 ) ; ( 2.75,-0.4 ) ",
    "( 3.15,0 ) ; ( 3.0,-0.4 ) ",
    "( 3.4,0 ) ; ( 3.25,-0.4 ) ",
    "( 3.65,0 ) ; ( 3.5,-0.4 ) ",
    "( 3.9,0 ) ; ( 3.75,-0.4 ) ",
    "( 4.15,0 ) ; ( 4.0,-0.4 ) ",
    "( 4.4,0 ) ; ( 4.25,-0.4 ) ",
    "( 4.65,0 ) ; ( 4.5,-0.4 ) ",
    "( 4.9,0 ) ;    ( 8,0 )  ( 8,6 ) ; ( 8,6 ) ",
    "( 8,7 ) ;    ( 8,0 )  ( 14,0 ) ; ( 14,0 ) ",
    "( 15,0 ) ;    ( 8.5,0 ) ",
    "( 8.5,5 ) ; ( 9.0,0 ) ",
    "( 9.0,5 ) ; ( 9.5,0 ) ",
    "( 9.5,5 ) ; ( 10.0,0 )  ( 10.0,5 ) ; ( 10.5,0 ) ",
    "( 10.5,5 ) ; ( 11.0,0 ) ",
    "( 11.0,5 ) ; ( 11.5,0 ) ",
    "( 11.5,5 ) ; ( 12.0,0 ) ",
    "( 12.0,5 ) ; ( 12.5,0 ) ",
    "( 12.5,5 ) ; ( 13,0 ) ",
    "( 13,5 ) ;    ( 8,0.5 ) ",
    "( 13,0.5 ) ; ( 8,1.0 ) ",
    "( 13,1.0 ) ; ( 8,1.5 ) ",
    "( 13,1.5 ) ; ( 8,2.0 )  ( 13,2.0 ) ; ( 8,2.5 ) ",
    "( 13,2.5 ) ; ( 8,3.0 ) ",
    "( 13,3.0 ) ; ( 8,3.5 ) ",
    "( 13,3.5 ) ; ( 8,4.0 ) ",
    "( 13,4.0 ) ; ( 8,4.5 ) ",
    "( 13,4.5 ) ; ( 8,5 ) ",
    "( 13,5 ) ;    at ( 8,-0.25 ) @xmath223 ; at ( 13.1,0 ) @xmath224 ; at ( 14,0 ) @xmath133 ; at ( 7.9,5.1 ) @xmath224 ; at ( 8,6 ) @xmath134 ;    plot [ smooth , tension=1.5 ] coordinates(8,0 ) ( 10.5,2.5 ) ; plot [ smooth , tension=1.5 ] coordinates(10.5,2.5 ) ( 13,5 ) ; ( 10.5,2.5 )  ( 11,3 ) ;    plot [ smooth , tension=0.7 ] coordinates(8,0 ) ( 11.3,2 ) ( 13,5 ) ; plot [ smooth , tension=0.7 ] coordinates(8,0 ) ( 10,3.3 ) ( 13,5 ) ; ( 11.2,1.9 ) ",
    "( 11.4,2.1 ) ; ( 9.9,3.2 )  ( 10.1,3.4 ) ;    plot [ smooth , tension=0.6 ] coordinates(8,0 ) ( 11.75,1.25 ) ( 13,5 ) ; plot [ smooth , tension=0.6 ] coordinates(8,0 ) ( 9.25,3.75 ) ( 13,5 ) ; ( 11.75,1.25 ) ",
    "( 11.90,1.40 ) ; ( 9.25,3.75 ) ",
    "( 9.40,3.90 ) ;    plot [ smooth , tension=0.3 ] coordinates(8,0 ) ( 11.5,0.45 ) ( 12.175,0.825 ) ( 12.55,1.5 ) ( 13,5 ) ; plot [ smooth , tension=0.3 ] coordinates(8,0 ) ( 8.45,3.5 ) ( 8.825,4.175 ) ( 9.5,4.55 ) ( 13,5 ) ; ( 12.175,0.825 )  ( 12.325,0.975 ) ; ( 8.825,4.175 )  ( 8.975,4.325 ) ;    plot [ smooth , tension=0.1 ] coordinates(8,0 ) ( 12.5,0.15 ) ( 12.75,0.25 ) ( 12.85,0.5 ) ( 13,5 ) ; plot [ smooth , tension=0.1 ] coordinates(8,0 ) ( 8.15,4.5 ) ( 8.25,4.75 ) ( 8.5,4.85 ) ( 13,5 ) ; ( 12.69,0.22 )  ( 12.90,0.40 ) ; ( 8.25,4.74 ) ",
    "( 8.40,4.90 ) ;    ( 8.1,-0.4 )  ( 8.5,0 ) ; ( 8.35,-0.4 ) ",
    "( 8.75,0 ) ; ( 8.6,-0.4 ) ",
    "( 9.0,0 ) ; ( 8.85,-0.4 )  ( 9.25,0 ) ; ( 9.1,-0.4 ) ",
    "( 9.5,0 ) ; ( 9.35,-0.4 ) ",
    "( 9.75,0 ) ; ( 9.6,-0.4 ) ",
    "( 10.0,0 ) ; ( 9.85,-0.4 ) ",
    "( 10.25,0 ) ; ( 10.1,-0.4 )  ( 10.5,0 ) ; ( 10.35,-0.4 ) ",
    "( 10.75,0 ) ; ( 10.6,-0.4 ) ",
    "( 11.0,0 ) ; ( 10.85,-0.4 )  ( 11.25,0 ) ; ( 11.1,-0.4 ) ",
    "( 11.5,0 ) ; ( 11.35,-0.4 ) ",
    "( 11.75,0 ) ; ( 11.6,-0.4 ) ",
    "( 12.0,0 ) ; ( 11.85,-0.4 ) ",
    "( 12.25,0 ) ; ( 12.1,-0.4 ) ",
    "( 12.5,0 ) ; ( 12.35,-0.4 ) ",
    "( 12.75,0 ) ; ( 12.6,-0.4 ) ",
    "( 13.0,0 ) ; ( 13.0,0 ) ",
    "( 13.4,0.4 ) ; ( 13.0,0.25 ) ",
    "( 13.4,0.65 ) ; ( 13.0,0.5 ) ",
    "( 13.4,0.9 ) ; ( 13.0,0.75 ) ",
    "( 13.4,1.15 ) ; ( 13.0,1.0 )  ( 13.4,1.4 ) ; ( 13.0,1.25 ) ",
    "( 13.4,1.65 ) ; ( 13.0,1.5 ) ",
    "( 13.4,1.9 ) ; ( 13.0,1.75 ) ",
    "( 13.4,2.15 ) ; ( 13.0,2.0 ) ",
    "( 13.4,2.4 ) ; ( 13.0,2.25 ) ",
    "( 13.4,2.65 ) ; ( 13.0,2.5 ) ",
    "( 13.4,2.9 ) ; ( 13.0,2.75 ) ",
    "( 13.4,3.15 ) ; ( 13.0,3.0 ) ",
    "( 13.4,3.4 ) ; ( 13.0,3.25 ) ",
    "( 13.4,3.65 ) ; ( 13.0,3.5 ) ",
    "( 13.4,3.9 ) ; ( 13.0,3.75 ) ",
    "( 13.4,4.15 ) ; ( 13.0,4.0 ) ",
    "( 13.4,4.4 ) ; ( 13.0,4.25 ) ",
    "( 13.4,4.65 ) ; ( 13.0,4.5 ) ",
    "( 13.4,4.9 ) ; ( 8.0,5.0 ) ",
    "( 8.4,5.4 ) ; ( 8.25,5.0 ) ",
    "( 8.65,5.4 ) ; ( 8.5,5.0 ) ",
    "( 8.9,5.4 ) ; ( 8.75,5.0 ) ",
    "( 9.15,5.4 ) ; ( 9.0,5.0 ) ",
    "( 9.4,5.4 ) ; ( 9.25,5.0 ) ",
    "( 9.65,5.4 ) ; ( 9.5,5.0 ) ",
    "( 9.9,5.4 ) ; ( 9.75,5.0 ) ",
    "( 10.15,5.4 ) ; ( 10.0,5.0 ) ",
    "( 10.4,5.4 ) ; ( 10.25,5.0 ) ",
    "( 10.65,5.4 ) ; ( 10.5,5.0 ) ",
    "( 10.9,5.4 ) ; ( 10.75,5.0 ) ",
    "( 11.15,5.4 ) ; ( 11.0,5.0 ) ",
    "( 11.4,5.4 ) ; ( 11.25,5.0 ) ",
    "( 11.65,5.4 ) ; ( 11.5,5.0 ) ",
    "( 11.9,5.4 ) ; ( 11.75,5.0 ) ",
    "( 12.15,5.4 ) ; ( 12.0,5.0 ) ",
    "( 12.4,5.4 ) ; ( 12.25,5.0 )  ( 12.65,5.4 ) ; ( 12.5,5.0 ) ",
    "( 12.9,5.4 ) ;    ( 7.6,0.1 ) ",
    "( 8.0,0.5 ) ; ( 7.6,0.35 ) ",
    "( 8.0,0.75 ) ; ( 7.6,0.6 ) ",
    "( 8.0,1.0 ) ; ( 7.6,0.85 ) ",
    "( 8.0,1.25 ) ; ( 7.6,1.1 ) ",
    "( 8.0,1.5 ) ; ( 7.6,1.35 ) ",
    "( 8.0,1.75 ) ; ( 7.6,1.6 ) ",
    "( 8.0,2.0 ) ; ( 7.6,1.85 ) ",
    "( 8.0,2.25 ) ; ( 7.6,2.1 ) ",
    "( 8.0,2.5 ) ; ( 7.6,2.35 )  ( 8.0,2.75 ) ; ( 7.6,2.6 ) ",
    "( 8.0,3.0 ) ; ( 7.6,2.85 ) ",
    "( 8.0,3.25 ) ; ( 7.6,3.1 ) ",
    "( 8.0,3.5 ) ; ( 7.6,3.35 ) ",
    "( 8.0,3.75 ) ; ( 7.6,3.6 ) ",
    "( 8.0,4.0 ) ; ( 7.6,3.85 ) ",
    "( 8.0,4.25 ) ; ( 7.6,4.1 ) ",
    "( 8.0,4.5 ) ; ( 7.6,4.35 ) ",
    "( 8.0,4.75 ) ; ( 7.6,4.6 ) ",
    "( 8.0,5.0 ) ;    ( 13,5 ) circle ( 3pt ) ; ( 8,0 ) circle ( 3pt ) ;      consider uniform - in - the - mean flow aligned with the @xmath133-direction and injection along the line @xmath225 , @xmath226 .",
    "the setup is depicted in figure  [ fig : setup ] ( left ) . for the velocity field",
    ", we use the 2d velocity covariance functions derived in @xcite from a log - normal conductivity field .",
    "they are statistically homogeneous , i.e. @xmath227 with @xmath228 , @xmath229 . for reference ,",
    "the covariance matrix entries are plotted in figure [ fig : cov_rub ] .",
    "the color scales of the entries are different for visibility .",
    "the covariance function for the velocity is based on a first order perturbation approximation and was found to be valid for log - transmissivity variances @xmath230 .",
    "note that this puts a restriction on the validity of the input statistics for this test case , but the stochastic transport solver iteself is not subject to this variance restriction .",
    "we believe that the velocity model is sufficiently accurate to demonstrate the representation properties of the kl - mw framework . thus",
    ", for evaluation of the method , we assume that the covariance model represents the true velocity statistics .",
    "the velocity field in @xcite is multi - variate gaussian but we assume that it has a symmetric truncated multi - gaussian distribution , i.e. the shape of the probability density function is essentially gaussian but bounded to an interval that covers 99.7% of the total probability .",
    "the solution of the generalized eigenvalue problem is in general computationally expensive and calls for sophisticated methods @xcite .",
    "however , for this case of stationary covariance , we found that it was sufficient ( in terms of speed and accuracy ) to discretize with simpson s rule , despite the lack of smoothness at @xmath231 .",
    "consistently with rubin , we assume no - flow conditions on the horizontal boundaries @xmath232 and @xmath233 and constant pressure gradient on the boundaries @xmath234 and @xmath235 . for the transport problem",
    ", we impose deterministic injection @xmath207 at @xmath236 along the line @xmath237 .",
    "this condition is enforced weakly through a penalty term which is dependent on the stochastic horizontal velocity @xmath238 .",
    "it is worthwhile to note that the treatment of this boundary condition is essential since the stochastic fluctuation of the transverse velocity @xmath239 would otherwise impact @xmath1 at @xmath236 over time .",
    "the stochastic fluctuation in @xmath239 leads to transport in the @xmath134-direction at the injection boundary .",
    "numerical results are shown in figure  [ fig : line_mean ] for the mean value and in figure  [ fig : line_std ] for the standard deviation of the saturation .",
    "the velocity field is obtained from a permeability field of 4 random dimensions . a total - order basis of up to second - order legendre polynomials was used for the multiwavelet saturation .",
    "the multiwavelet solution is compared to a monte carlo solution based on 1000 samples .",
    "this is a relatively small number , but adding more samples had a negligible effect on the monte carlo solution of this problem .",
    "the monte carlo samples are generated with a deterministic finite volume solver with the flux  .",
    "we use the minmod flux limiter which leads to the correct kruzhkov entropy solution as observed in @xcite .",
    "the uncertainties in both velocity components lead to uncertainty in the location of the saturation front . to resolve the variance in the @xmath134-direction , a relatively fine mesh was required compared to the @xmath133-direction ( @xmath240 , and @xmath241 grid cells , respectively ) .",
    "the mw solution requires finer resolution than any monte carlo sample solution due to small - scale variability in the higher order mw coefficients .",
    "the relative similarities of the monte carlo and mw solutions in figures  [ fig : line_mean ] and [ fig : line_std ] indicate that the spatial mesh is sufficiently fine and that the retained order of mw is sufficient .",
    "we next consider a random velocity field where the mean field is defined by the quarter five - spot problem , i.e. streamlines originating from the lower left corner @xmath242 and ending at the upper right corner @xmath243 of the domain .",
    "no - flow is imposed over the domain boundaries .",
    "the setup is shown in figure  [ fig : setup ] ( right ) . to obtain statistics for the saturation of the quarter five - spot problem",
    ", the multiwavelet representation of the total seepage velocity is determined in a preprocessing step .",
    "we represent the permeability field using the truncated kl expansion based on the assumption of a lognormal random field and an exponential covariance function .",
    "for all spatial grid cells , the permeability field is evaluated at stochastic quadrature points and used as input to an algebraic multi - grid pressure solver  @xcite .",
    "assuming unit porosity , the mw coefficients of the total velocity or flux field are then approximated by numerical quadrature , @xmath244 where @xmath245 and @xmath246 is the set of quadrature points and weights of a @xmath247-point quadrature rule .",
    "note that the weights are accounting for the probability density function of the parameterization vector @xmath65 .",
    "we use the tensorized gauss - legendre quadrature rule in the parameterized matrix package .",
    "numerical results for the statistics of the saturation are shown in figures  [ fig : q5s_mean ] and [ fig : q5s_std ] , for @xmath248 , @xmath249 , and @xmath250 , respectively .",
    "the spatial mesh consists of 50 by 50 spatial cells and an order @xmath251 mw expansion is used for the saturation ( total - order basis in two stochastic dimensions and up to fourth order polynomial reconstruction ) .",
    "the uncertain velocity field results in uncertain location of the front which is where the variance attains its maximum .",
    "an effect of the uncertainty in the saturation front is that the mean solution appears more smeared than any single realization of the saturation field .",
    "the slight smearing observed in the numerical results is thus a stochastic effect rather than a feature of the numerical method .",
    "the mw solution captures the mean and standard deviation .",
    "the difference from the reference monte carlo solution is most clearly visible in the standard deviation for large times .",
    "the numerical error is attributed to the truncation error of the mw expansion . in order to decrease the error , the order of mw expansion",
    "should be increased together with spatial mesh refinement since high - order mw modes vary on a shorter scale than low - order mw modes .",
    "the locally reduced - order method is compared in terms of computational time to the standard stochastic galerkin formulation by varying the order @xmath114 of mw expansion .",
    "the input velocity is obtained from a spatially varying permeability field with lognormal distribution and a kl expansion with 4 stochastic dimensions .",
    "the field is represented by multiwavelets that are not the optimal representation of this input uncertainty . an optimal representation ( in the sense of minimum number of nonzero mw coefficients ) ,",
    "i.e. , basis functions tailored for this velocity field , would admit a more sparse representation and thus allow greater speedup of the locally reduced - order method . as can be inferred from the results displayed in figure  [ fig : temp_comp_2d ] ,",
    "there is still a factor 6 speedup for large @xmath114 .",
    "we have shown that the fully intrusive stochastic galerkin formulation of the buckley - leverett equation is hyperbolic independently of the order of the mw expansion .",
    "the approximate problem thus retains important qualitative features of the original stochastic formulation , e.g. wave propagation of the initial saturation and the emergence of a discontinuous solution in finite time .",
    "this analysis motivated the choice of a shock - capturing finite volume solver with a local reduction of the order of mw expansion for computational efficiency .",
    "for the orders of mw investigated , the numerical solution converges to the reference solution generated by monte carlo sampling .",
    "the numerical solver performs well for the stochastic galerkin formulation of the buckley - leverett problem with the pseudo - spectral flux approximation and multiwavelet representation of the uncertainty . for sufficient spatial resolution ,",
    "the numerical solutions display multiple discontinuities depending on the order @xmath114 of stochastic truncation .",
    "in large - scale problems with multiple sources of uncertainty , discontinuities may not be visible due to lack of resolution and smoothing effects from stochastic averaging .",
    "nevertheless , only a robust numerical scheme with shock - capturing properties can produce a solution that converges with mesh refinement .",
    "two spatially two - dimensional problems have been investigated : a line - injection problem and a quarter five - spot problem . for the line injection problem",
    ", we have shown how to incorporate analytically derived correlation functions in the mw framework .",
    "for the quarter five - spot problem , the mw representation of the input velocity field was obtained from a lognormal permeability field with an algebraic multigrid solver .",
    "the multiple discontinuities are not resolved due to the high order of mw in either problem , but the resolution is still sufficient for good agreement with the monte carlo reference solutions .",
    "we have demonstrated substantial speedup for a locally reduced - order basis stochastic galerkin method , as compared to the standard implementation of the stochastic galerkin method with global basis functions .",
    "the rationale for the method presented here is that solutions of hyperbolic systems consist of waves and thus are localized in space and time . at a given point in space and time ,",
    "only a subset of all waves contribute significantly to the solution .",
    "the method presented is adaptive in the sense that it identifies locally significant waves and use only them in the numerical flux computations .",
    "an attractive feature of the method is that no apriori information about the solution is assumed .",
    "all stochastic modes are updated and this ensures that temporarily insignificant modes are accounted for as soon as they grow above a given threshold .",
    "the method is expected to be efficient also for other problems described by wave propagation , e.g. , computational fluid dynamics .",
    "this will be investigated in more detail elsewhere .",
    "future work also includes evaluation of the presented local basis reduction method on stochastic permeability fields conditioned on measurements .",
    "the adaptivity in the complexity of the stochastic representation should have a significant impact on the total computational cost since the optimal stochastic representation is expected to be highly localized in a spatially heterogeneous field .",
    "the authors would like to gratefully acknowledge the reservoir simulation research program ( supri - b ) at stanford university for funding of this project , and the first author would also like to acknowledge the success centre for co@xmath0 storage under grant 193825/s60 from the research council of norway ( rcn ) for funding .",
    "we also would like to thank dr .",
    "daniel meyer and dr .",
    "anna nissen for help with the design of the quarter five - spot problem and fayadhoi ibrahima for valuable suggestions and advice on the presentation of the material .",
    "s.  p. neuman , s.  orr , prediction of steady state flow in nonuniform geologic media by conditional moments : exact nonlocal formalism , effective conductivities , and weak approximation , water resour .",
    "29  ( 2 ) ( 1993 ) 341364 .",
    "http://dx.doi.org/10.1029/92wr02062 [ ] .",
    "a.  guadagnini , s.  p. neuman , nonlocal and localized analyses of conditional mean steady state flow in bounded , randomly nonuniform domains : 1 .",
    "theory and computational approach , water resour .",
    "35  ( 10 ) ( 1999 ) 29993018 . http://dx.doi.org/10.1029/1999wr900160 [ ] .",
    "k.  d. jarman , a.  m. tartakovsky , a comparison of closures for stochastic advection - diffusion equations , siam / asa journal on uncertainty quantification 1  ( 1 ) ( 2013 ) 319347 .",
    "http://dx.doi.org/10.1137/120897419 [ ] .",
    "d.  xiu , g.  e. karniadakis , the wiener ",
    "askey polynomial chaos for stochastic differential equations , siam j. sci .",
    "comput . 24  ( 2 ) ( 2002 ) 619644 .",
    "http://dx.doi.org/http://dx.doi.org/10.1137/s1064827501387826 [ ] .",
    "s.  oladyshkin , h.  class , r.  helmig , w.  nowak , a concept for data - driven uncertainty quantification and its application to carbon dioxide storage in geological formations , adv .",
    "water resour .",
    "34  ( 11 ) ( 2011 ) 15081518 .",
    "p.  sochala , o.  p. le  matre , polynomial chaos expansion for subsurface flows with uncertain soil parameters , adv .",
    "water resour .",
    "62 , part a ( 2013 ) 139  154 .",
    "http://dx.doi.org/http://dx.doi.org/10.1016/j.advwatres.2013.10.003 [ ] .",
    "f.  mller , p.  jenny , d.  w. meyer , probabilistic collocation and lagrangian sampling for advective tracer transport in randomly heterogeneous porous media , adv .",
    "water resour .",
    "34  ( 12 ) ( 2011 ) 1527  1538 . http://dx.doi.org/10.1016/j.advwatres.2011.09.005 [ ] .",
    "o.  p. le  matre , h.  n. najm , r.  g. ghanem , o.  m. knio , multi - resolution analysis of wiener - type uncertainty propagation schemes , j. comput .",
    "197 ( 2004 ) 502531 . http://dx.doi.org/10.1016/j.jcp.2003.12.020 [ ] .",
    "x.  wan , g.  e. karniadakis , an adaptive multi - element generalized polynomial chaos method for stochastic differential equations , j. comput .",
    "209 ( 2005 ) 617642 . http://dx.doi.org/http://dx.doi.org/10.1016/j.jcp.2005.03.023 [ ] .",
    "m.  kppel , i.  krker , c.  rohde , stochastic modeling for heterogeneous two - phase flow , in : j.  fuhrmann , m.  ohlberger , c.  rohde ( eds . ) , finite volumes for complex applications vii - methods and theoretical aspects , vol .",
    "77 , springer international publishing , 2014 , pp . 353361 .",
    "p.  pettersson , h.  a. tchelepi , stochastic galerkin method for the buckley - leverett problem in heterogeneous formations , in : proc .",
    "14th european conference on the mathematics of oil recovery ecmor xiv , no .",
    "a33 , eage , catania , italy , 2014 .",
    "r.  brger , i.  krker , c.  rohde , a hybrid stochastic galerkin method for uncertainty quantification applied to a conservation law modelling a clarifier - thickener unit , j. appl .",
    "zamm 94  ( 10 ) ( 2014 ) 793817 . http://dx.doi.org/10.1002/zamm.201200174 [ ] .",
    "j.  tryoen , o.  p. le  matre , m.  ndjinga , a.  ern , intrusive galerkin methods with upwinding for uncertain nonlinear hyperbolic systems , j. comput .",
    "229  ( 18 ) ( 2010 ) 6485  6511 .",
    "http://dx.doi.org/doi : 10.1016/j.jcp.2010.05.007 [ ] .",
    "b.  j. debusschere , h.  n. najm , p.  p. pbay , o.  m. knio , r.  g. ghanem , o.  p. le  matre , numerical challenges in the use of polynomial chaos representations for stochastic processes , siam j. sci . comput . 26",
    "( 2005 ) 698719 .",
    "http://dx.doi.org/http://dx.doi.org/10.1137/s1064827503427741 [ ] .",
    "a.  kurganov , s.  noelle , g.  petrova , semidiscrete central - upwind schemes for hyperbolic conservation laws and hamilton  jacobi equations , siam j. sci .",
    "23  ( 3 ) ( 2001 ) 707740 .",
    "http://dx.doi.org/10.1137/s1064827500373413 [ ] .",
    "a.  kurganov , g.  petrova , b.  popov , adaptive semidiscrete central - upwind schemes for nonconvex hyperbolic conservation laws , siam j. sci .",
    "29  ( 6 ) ( 2007 ) 23812401 . http://dx.doi.org/10.1137/040614189 [ ] .",
    "x.  wan , g.  e. karniadakis , long - term behavior of polynomial chaos in stochastic flow simulations , comput .",
    "methods appl .",
    "195 ( 2006 ) 5582  5596 . http://dx.doi.org/http://dx.doi.org/10.1016/j.cma.2005.10.016 [ ] .",
    "d.  w. meyer , h.  a. tchelepi , particle - based transport model with markovian velocity processes for tracer dispersion in highly heterogeneous porous media , water resour .",
    "46  ( 11 ) , w11552 . http://dx.doi.org/10.1029/2009wr008925 [ ] ."
  ],
  "abstract_text": [
    "<S> the accurate representation of the evolution of a discontinuous stochastic solution over time requires a large number of stochastic basis functions . </S>",
    "<S> adaptivity of the stochastic basis to reduce computational cost is challenging in the stochastic galerkin setting since the change of basis affects the system matrix itself . to achieve adaptivity without adding overhead by rewriting the entire system of equations for every grid cell </S>",
    "<S> , we devise a basis reduction method that distinguishes between locally significant and insignificant modes without changing the actual system matrices .    </S>",
    "<S> results are presented for problems in one and two spatial dimensions , with varying number of stochastic dimensions . </S>",
    "<S> we show how to obtain stochastic velocity fields from realistic permeability fields and demonstrate the performance of the stochastic galerkin method with local basis reduction . </S>",
    "<S> the system of conservation laws is discretized with a finite volume method and we demonstrate numerical convergence to the reference solution obtained through monte carlo sampling .    </S>",
    "<S> polynomial chaos , stochastic galerkin method , basis reduction , subsurface flow </S>"
  ]
}