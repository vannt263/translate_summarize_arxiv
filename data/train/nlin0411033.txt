{
  "article_text": [
    "in dealing with systems of equations having a large number of degrees of freedom one frequently adopts an approximation which leads to a nonlinear partial differential equation . for instance , the mean - field approach in the statistical physics is based on the introduction of an order parameter governed by a nonlinear equation .",
    "for example , the mean - field theory of the bose - einstein condensate of a degenerate quantum gas is based on the gross - pitaevskii equation @xcite .",
    "the gross - pitaevskii equation is the nonlinear schrdinger equation with an external potential .",
    "it describes the so - called `` matter waves ''  the nonlinear collective modes of the degenerate quantum gas below the condensation temperature . in many other cases the approximate nonlinear equations , appearing as the leading order description of nonlinear waves in various branches of modern physics , for instance , in nonlinear optics , plasma , and on water , are of the nonlinear schrdinger class ( see , for instance , ref . @xcite and the references therein ) . in physics one",
    "is especially interested in the stationary solutions ( a.k.a . the stationary points ) of the governing equations , in particular , in the stationary points which minimize the energy . only in some exceptional cases",
    "the solution can be obtained analytically and one has to rely on numerical simulations .",
    "if the nonlinear equation in question possesses the lagrangian formulation then the stationary points can be found by a nonlinear optimization method .",
    "we propose a new optimization method for nonlinear partial differential equations , in particular , for the equations of the nonlinear schrdinger ( nls ) type .",
    "the method consists of a numerical minimization of the rayleigh functional . in a broader perspective",
    ", we introduce the concept of rayleigh functional for nonlinear systems and show how it can be employed in both numerical and analytical analysis of equations of physical importance .    in our case ,",
    "the optimization problem is to find the ground state of a nonlinear system , i.e. the stationary solution which minimizes the energy .",
    "we work in the space of smooth functions @xmath0 of @xmath1 spatial variables @xmath2 and time variable , which have bounded @xmath3-norm : @xmath4 .",
    "thus we consider only bounded stationary solutions which decay to zero as @xmath5 and correspond to finite energies .",
    "we adopt the following energy functional : @xmath6 and assume that it has the phase invariance symmetry @xmath7 ( we use the complex conjugate functions @xmath8 and @xmath9 as independent variational variables instead of the real and imaginary parts of @xmath8 ) . the phase invariance symmetry results in conservation of the @xmath3-norm",
    ".    our method also works for the generalization of the energy functional ( [ eq1 ] ) to several variables of variation : @xmath10 , @xmath11 ( this case is discussed below ) , and to the higher order derivatives : @xmath12 , @xmath13 .",
    "we adopt the notations used in statistical physics , an important area for applications .",
    "hence , the dependent variable @xmath14 will be referred to as the order parameter .",
    "the well known gross - pitaevskii functional for the order parameter of a bose - einstein condensate , @xmath15 belongs to the class specified by equation ( [ eq1 ] ) . here",
    "@xmath16 , @xmath17 is the number of atoms in the condensate , @xmath18 is the interaction coefficient due to the s - wave scattering of the atoms and @xmath19 is the trap potential ( created by a magnetic field or non - resonant laser beams ) .",
    "the order parameter is normalized to 1 in equation ( [ eq2 ] ) .",
    "let us briefly recall the basics of the nonlinear optimization .",
    "one is interested in the stationary state , given as @xmath20 , where @xmath21 is the chemical potential .",
    "the euler - lagrange equation corresponding to the energy functional ( [ eq1 ] ) reads @xmath22 here ( and below ) we denote @xmath23 the variational derivative of a functional @xmath24 with respect to @xmath9 ( thus we part with the usual notation of the latter by using the symbol @xmath25 , while @xmath25 is reserved for the usual gradient of a function ) .",
    "the stationary state satisfies the equation @xmath26 .",
    "the idea of the imaginary time relaxation method is based on the fact that the variational derivative of a functional is an analog of the gradient of a function .",
    "thus , by introducing the `` imaginary time '' @xmath27 in equation ( [ eq3 ] ) one forces the order parameter to evolve in the direction of maximum decrease in the energy .",
    "the attractor of such evolution is , hopefully , a local minimum ( in general , just a stationary point ) .",
    "the imaginary time evolution does not conserve the @xmath3-norm and one must normalize the order parameter directly during the evolution . in other words , one allows the order parameter to evolve in the space of arbitrary functions but normalizes the solution after each step by the prescription @xmath28 .",
    "this can be formulated in a single equation : @xmath29    the method of lagrange multipliers can be used to take into account the constraints imposed on the variables of variation ( for instance , the fixed norm ) .",
    "it consists of a numerical minimization of an augmented functional which is the energy functional plus the constraint with a lagrange multiplier .",
    "the combined functional has the stationary solution as its extremal point and the constrained minimization problem is converted into an unconstrained one . in this case , the time evolution of equation ( [ eq4 ] ) can be substituted by a finite - step minimization scheme , such as the method of steepest descent or the conjugate gradient method , supplemented by an appropriate line - search algorithm ( consult , for instance , refs .",
    "@xcite ) . for instance",
    ", the following two functionals are used @xmath30 where the variable of variation is arbitrary ( has arbitrary @xmath3-norm ) .",
    "indeed , the first of these functionals evidently has the stationary solutions as its extremals , while the second has the variation @xmath31 . setting @xmath32",
    "we get the stationary point by equating the variation of @xmath33 to zero .",
    "the use of the functional @xmath33 in the search for the energy minimizers was advocated recently in ref .",
    "the point is that the trivial solution @xmath34 , being an extremal , frequently makes reaching other solutions difficult with the use of the functional @xmath35 , while functional @xmath33 is free from such a flaw .",
    "the simplest numerical realization of the minimization method is given by the steepest descent scheme : @xmath36 where the parameter @xmath37 is selected by an appropriate line - search algorithm .",
    "this paper is organized as follows . in section [ ray ]",
    "we introduce the rayleigh functional for the energy given by equation ( [ eq1 ] ) and discuss its properties as a variational functional .",
    "the generalization to several order parameters is also considered . in section [ num ]",
    "we present examples of the nonlinear optimization based on the rayleigh functional . as an application of the rayleigh functional in the analytical approach , in section [ criticalnls ] we relate an identity satisfied by the stationary solutions of the critical nls equations to the scale invariance symmetry of the rayleigh functional",
    "finally , in section [ concl ] the advantage of the numerical optimization method based on the rayleigh functional is discussed .",
    "before formulating our nonlinear optimization method , it would be instructive to recall how the eigenfunctions of a linear operator can be obtained numerically .",
    "consider , for instance , the textbook problem of finding the eigenvalues and eigenfunctions of the hamiltonian operator @xmath38 for a quantum particle in a potential well ( we use @xmath39 and @xmath40 ) .",
    "this problem can be reformulated as an optimization problem by employing the well - known rayleigh quotient @xcite @xmath41 here the function of variation @xmath8 is arbitrary , i.e. not normalized .",
    "the eigenfunctions are the stationary points of the rayleigh quotient .",
    "indeed @xmath42 where the eigenvalue is given as @xmath43 , i.e. it is the value of @xmath44 at the eigenfunction .",
    "note that the rayleigh quotient allows one to cast the constrained minimization problem ( with the constraint @xmath45 ) into an unconstrained one .",
    "stationary solutions of nonlinear systems , the so - called nonlinear modes , can be considered as the generalization of the eigenfunctions .",
    "they can be found in a way similar to the solution of the above eigenvalue problem .",
    "in contrast to the linear systems , a _ nonlinear _",
    "one usually possesses continuous families of stationary solutions , each solution corresponding to a different chemical potential ( an analog of the energy level in the nonlinear case ) . in general , the chemical potential takes its values from an infinite interval of the real line . by fixing the @xmath3-norm",
    "we introduce it as a parameter in the energy functional .",
    "thus , the chemical potential , being a continuous function of the norm , is also fixed ( in general , we get away with a finite number of _ distinct _ values lying on the different branches of the function @xmath46 ) .",
    "the only exception is the so - called critical case when a continuous family of stationary solutions corresponds to the same @xmath3-norm ( see also section [ criticalnls ] , where we discuss the critical case ) .",
    "therefore , apart from the critical case , by fixing the norm we select a finite number of solutions . among them",
    "there is the energy minimizer ( for a given value of the conserved @xmath3-norm ) .",
    "we can reconstruct the continuous family of the stationary solutions by using different values of the norm . in the case of bose - einstein condensates , for instance , this corresponds to fixing the number of atoms and looking for the corresponding ground state solution .",
    "it is assumed that the nonlinear equation in question has a phase invariance resulting in the @xmath3-norm conservation . in the following",
    "we will distinguish between the normalized and not - normalized functions , denoting the former by @xmath47 and the latter by @xmath0 .",
    "for convenience , we set the @xmath3-norm of the stationary solution equal to 1 , @xmath48 .",
    "this normalization is performed by using a scale transformation of the function of variation and results in the explicit appearance of the value of @xmath3-norm in the energy functional ( note that the chemical potential may also be scaled appropriately , as in equations ( [ eqincoh ] ) and ( [ eqcoh ] ) of section [ num ] ) .",
    "for example , in equation ( [ eq2 ] ) we have the coefficient @xmath17 at the nonlinear term , after we set the @xmath3-norm of the solution to 1 , and the value of the energy functional is , in fact , the energy of the condensate per atom .    for the energy given by equation ( [ eq1 ] )",
    "the following functional can serve as the nonlinear generalization of the rayleigh quotient : @xmath49 here the @xmath3-norm @xmath50 is not fixed but is a functional of @xmath8 and @xmath9 ( since the norm is constant _ function _ of @xmath51 we can take it out of the gradient operator @xmath25 ) .",
    "note that @xmath44 is a compound functional : it depends on the complex conjugate functions @xmath52 and @xmath53 through the normalized ones , @xmath54 and @xmath55 , used in the energy functional @xmath56 .",
    "this simple functional turns out to be very helpful in the search for the energy minimizers .",
    "let us discuss the properties of functional ( [ eq9 ] ) .",
    "first , its extremals are stationary points of the corresponding nonlinear equation , equation ( [ eq3 ] ) , similar as in the case of the rayleigh quotient ( [ eq7 ] ) and equation ( [ eq8 ] ) .",
    "( the unique stationary point is selected by the value of the @xmath3-norm , appearing explicitly in the energy functional as a _ parameter _ ) .",
    "this follows from a simple calculation : @xmath57 @xmath58 @xmath59 where we have used that @xmath60 by interchanging the order of integration in the double integral in formula ( [ eq10 ] ) and gathering the terms with @xmath61 we obtain the variational derivative @xmath62 from equation ( [ eq11 ] ) it is quite clear that the stationary points of equation ( [ eq3 ] ) are extremals of the rayleigh functional and vice versa .",
    "the corresponding chemical potential is equal to the integral in the second term on the r.h.s .",
    "of equation ( [ eq11 ] ) , i.e. @xmath63 which fact can be verified by direct integration of equation ( [ eq3 ] ) , i.e. @xmath64 , and taking into account the normalization of @xmath65 . equation ( [ eq12 ] ) plays here the role of the expression for the energy level @xmath66 in the above problem of a quantum particle .",
    "the rayleigh functional also distinguishes the local minima among the stationary points . to see this",
    "let us compute its second variation .",
    "assuming that @xmath8 is a stationary point , we get @xmath67 @xmath68 where we have used the fact that @xmath65 satisfies the stationary equation @xmath69 . integrating by parts and taking into account the normalization of @xmath65 ,",
    "i.e. @xmath70 , we arrive at @xmath71 the subscript in the first term on the r.h.s . of this equation",
    "means that the variable of variation of the energy functional is , in fact , @xmath54 . taking this into account , one immediately recognizes on the r.h.s . of equation ( [ eq13 ] ) the second variation of the functional @xmath72 defined in equation ( [ eq5 ] ) and evaluated in the space of normalized functions .",
    "therefore , the minima of the lagrange modified energy functional ( for a fixed nonzero @xmath3-norm ) are also minima of the rayleigh functional and vice versa .",
    "importantly , the rayleigh functional does not contain the trivial solution @xmath73 among its extremals , in contrast to the lagrange modified energy functional .",
    "finally , let us discuss the functional of ref .",
    "@xcite , which was proposed as another possible generalization of the rayleigh quotient to the equations of the nonlinear schrdinger type . in the latter work in the numerical search for the stationary solutions of two - dimensional gross - pitaevskii equation the following functional",
    "was employed @xmath74 this functional can be expressed as follows @xmath75 here the rayleigh functional is given by @xmath76 with @xmath77 and @xmath17 is the number of atoms corresponding to the stationary state .",
    "note that the first variation of the rayleigh functional is zero on a stationary solution and the last two terms in formula ( [ eqnull ] ) have nonzero variation unless the norm @xmath50 is kept fixed ( @xmath78 ) .",
    "hence , the functional @xmath79 introduced in ref .",
    "@xcite can not be employed for _ unconstrained _ minimization .",
    "now let us show that , in fact , the euler - lagrange equation for the functional @xmath79 defined by equation ( [ cras ] ) is self - contradictory ( in other words , the first variation of @xmath79 is never zero ) and , hence , does not lead to any stationary solutions at all .",
    "the euler - lagrange equation for the functional ( [ cras ] ) reads @xmath80 where @xmath79 is the value of the functional on the solution . on the other hand , by multiplying the above equation and integrating we get @xmath81 hence @xmath82 and we have arrived at a contradiction unless @xmath83 .",
    "q.e.d .      the rayleigh functional",
    "was introduced above for a nonlinear system described by a single ( complex - valued ) order parameter @xmath52 .",
    "it can be easily generalized to the case several order parameters .",
    "the definition of the rayleigh functional will depend on the number of the conserved @xmath3-norms .",
    "this number is determined by the type of phase invariance of the energy functional .",
    "we will concentrate mainly on the two broad cases : the incoherent and coherent coupling of the order parameters . for simplicity , consider the case of two order parameters : @xmath84 . in the case of incoherent coupling , there are two independent constraints corresponding to the two conserved @xmath3-norms ( the normalization is defined independently for each order parameter : @xmath85 , @xmath86 ) . on the other hand ,",
    "if the coupling is coherent , then there is only one constraint corresponding to conservation of the total @xmath3-norm ( @xmath87 ) .",
    "we also give an example of application of the rayleigh functional to a nonlinear system which does not belong to either of the above cases ( see section [ num ] ) .",
    "an example of the incoherent coupling is the gross - pitaevskii functional for a two - species mixture of degenerate quantum gases in an external trap below the condensation temperature ( see , for instance , ref .",
    "@xcite ) : @xmath88 on the other hand , the coupled - mode approximation for a bose - einstein condensate in the three dimensional parabolic trap modified in one dimension by a laser beam with creation of a central barrier illustrates the coherent coupling : @xmath89 ( for derivation of the coupled - mode system and the applicability conditions consult ref .",
    "the coupling coefficient @xmath90 is proportional to the tunnelling rate through the central barrier of the resulting double - well trap .",
    "it is easy to see that functional ( [ eq14 ] ) admits two independent phase invariance transformations , @xmath91 , while functional ( [ eq15 ] ) admits only the simultaneous phase invariance transformation of both variables with the same @xmath92 .",
    "the rayleigh functionals for the two cases corresponding to equations ( [ eq14 ] ) and ( [ eq15 ] ) are defined as follows : @xmath93 where @xmath94 .",
    "it should be stressed that to define the rayleigh functional one should employ the normalization which follows from the phase invariance in its general form .",
    "for instance , the normalization by the total @xmath3-norm in the incoherent coupling case would allow one to find only the stationary solutions with the same chemical potential for each component of the order parameter , i.e. a very limited class of solutions .",
    "the variational derivative of the rayleigh functional @xmath95 ( [ eq16 ] ) is derived by a mere repetition of the steps which led to equation ( [ eq11 ] ) .",
    "we have @xmath96 where , as usual , the @xmath65-variables are substituted in the energy functional instead of @xmath8-ones , i.e. @xmath97 .",
    "now it is easy to see that , thanks to the equation @xmath98 , the integral on the r.h.s . of formula ( [ eq17 ] ) coincides with the corresponding chemical potential @xmath99 .",
    "thereby the extremals of the rayleigh functional @xmath95 are stationary points of the corresponding nonlinear system of equations",
    ".    the variational derivative of the functional @xmath100 ( [ eq16 ] ) can be most easily obtained from formula ( [ eq11 ] ) by noticing that this rayleigh functional depends on the function @xmath101 through @xmath102 and also through the total norm @xmath103 in all other @xmath65-variables .",
    "therefore , each variable of the energy functional leads to an integral term similar to the second term in equation ( [ eq11 ] ) but multiplied by @xmath104 .",
    "hence the final result : @xmath105 where @xmath106 . to show that the extremals of the rayleigh functional @xmath107 are also stationary points one has to use both stationary equations , i.e. @xmath108 and @xmath109 , multiplied by the complex conjugate functions @xmath110 .",
    "we get @xmath111    let us now find the second variation of the rayleigh functional at a stationary point in the above two cases .",
    "the derivation is similar to that for a single order parameter : one has to use the stationary equations and the normalization constraints for the @xmath65-variables .",
    "we get : @xmath112 @xmath113 in both cases the second variation of the rayleigh functional coincides with that of the lagrange modified energy functional considered in the space of normalized functions . therefore , the minima of the lagrange modified energy functional ( for the fixed values of the conserved @xmath3-norms ) are also minima of the rayleigh functional and vice versa .    concluding this section we note that by introducing the concept of rayleigh functional we have converted the task of finding the stationary points to an unconstrained optimization problem which also distinguishes between the local minima and the saddle points . in the next section",
    "we give examples of application of this optimization method to the numerical search for the stationary states of bose - einstein condesates .",
    "by analogy with the use of the rayleigh quotient in the numerical search for eigenfunctions , the nonlinear optimization can be based on the rayleigh functional .",
    "leaving a mathematically rigorous analysis for future research , let us nevertheless give an heuristic argument .",
    "the rayleigh functional is a compound functional : the energy functional depends on @xmath54 and @xmath55 , while these are functionals of @xmath52 and @xmath53 .",
    "the numerical nonlinear optimization of a functional reduces to that of a smooth function ( though of a large number of variables ) . but",
    "a continuous function on a finite - dimensional sphere ( which in the numerics plays the role of the variable @xmath54 ) always has a minimum . since the second variation of the rayleigh functional is actually the second variation of the lagrange modified energy functional , evaluated in the space of normalized functions , the optimization method based on the rayleigh functional has the capacity to return the absolute minimum .",
    "generally , it converges to a local minimum .",
    "an additional argument in favor of the nonlinear optimization based on the rayleigh functional is provided already by the imaginary time relaxation method  a widely used approach in the computational physics .",
    "indeed , it is precisely the rayleigh functional which is minimized in this method .",
    "let us recall the usual formulation given by equation ( [ eq4 ] ) of section [ intro ] .",
    "first of all , this formulation does not reflect the total change of @xmath8 , since after each numerical step one performs the direct normalization of the updated function .",
    "this means that the variational derivative @xmath114 does not tend to zero , since the norm of the order parameter is not forced to approach a constant value as @xmath115 .",
    "however , one can reformulate the relaxation method for the variable @xmath116 which has a fixed @xmath3-norm .",
    "we have @xmath117 @xmath118 where we have used equation ( [ eq4 ] ) to substitute for @xmath119 .",
    "we see that if the imaginary time relaxation converges , i.e. if @xmath120 , then it converges necessarily to an extremal of the rayleigh functional .",
    "equation ( [ eq21 ] ) , besides revealing a new side of the imaginary time evolution method , manifests its strong drawback : the order parameter evolves continuously and , hence , quite slowly .",
    "but , since it is actually a way to minimize the rayleigh functional , a discrete minimization scheme can be adopted with the order parameter performing a series of finite steps to a local minimum .",
    "we have naturally arrived at the steepest descent formulation : @xmath121 where the parameter @xmath122 is selected by some line - search algorithm .",
    "more advanced gradient methods , for example , the conjugate gradient method , can be employed for the finite - step minimization .",
    "however , we have found that the steepest descent algorithm performs very well in the nonlinear optimization based on the rayleigh functional .    in selecting the step size",
    "@xmath123 we have adopted the barzilai - borwein two - point method @xcite ( see also ref .",
    "there are two closely related barzilai - borwein methods :    [ eq24 ] @xmath124    both methods are fairly equivalent in terms of performance .",
    "the generalization of the numerical scheme ( [ eq23])-([eq24 ] ) to several order parameters is given by the substitution of the scalar function @xmath52 by a vectorial one @xmath125 defined similar to the vectorial function @xmath126 used in formulae ( [ eq17 ] ) and ( [ eq18 ] ) ( in the vector case , the inner product in equations ( [ eq24a ] ) and ( [ eq24b ] ) contains , besides the integral , the hermitian inner product in the finite - dimensional target vector space ) .",
    "in the numerical implementation we have used the spectral collocation method for the spatial grid based on the fourier modes ( see refs .",
    "the accuracy of the obtained solution was checked by direct numerical substitution into the governing equations . in all cases a rapid convergence to the stationary point",
    "was observed .",
    "we have cut off the allowed values of @xmath127 by a small positive number ( in our case @xmath128 ) to have the iteration step always in the direction of decrease of the rayleigh functional .      _ a. incoherent coupling_. our first example of the numerical optimization based on the rayleigh functional is the calculation of the ground state in the two - species bose - einstein condensate of rubidium in the quasi two - dimensional geometry ( the pancake trap )",
    ". the derivation of the governing equations and further discussion can be found in ref .",
    "the energy functional for the two - species bose - einstein condensate is given by the two - dimensional version of equation ( [ eq14 ] ) .",
    "the parameters @xmath129 and @xmath130 account for the different lande magnetic factors .",
    "for the two isotopes of rubidium we have : @xmath131 ( for @xmath132rb ) and @xmath133 ( for @xmath134rb ) , while the interaction coefficients are @xmath135 , @xmath136 , and @xmath137 .",
    "the variational derivative is given by equation ( [ eq17 ] ) .",
    "to simplify the task , we note that the first term of the variational derivatives is the r.h.s of the stationary euler - lagrange equations written for the normalized functions :    [ eqincoh ] @xmath138    here the chemical potentials @xmath139 are defined as follows : @xmath140 , @xmath141 , with @xmath142 being the chemical potential for the order parameter @xmath143 normalized to the number of atoms @xmath144 .",
    "a nontrivial feature of the two - species condensate is that the ground state suffers from the symmetry breaking transformation , if for instance , for a fixed number of atoms of the @xmath132rb isotope the number of atoms of the @xmath134rb isotope increases @xcite . in figure [ fg1 ]",
    "we show the symmetry preserved ( axially symmetric ) ground states , while the symmetry - broken one is illustrated in figure [ fg2 ] .",
    "the axially symmetric states were found by the optimization method projected on the space of axially symmetric functions and formulated in polar coordinates .",
    "the polar radius grid contained 128 points , while the two - dimensional grid was @xmath145 ( we have used the @xmath146-grid to produce figure [ fg2 ] ) .",
    "the initial condition in both cases was the gaussian profile ( modulated by a symmetry - breaking perturbation in case of figure [ fg2 ] ) .",
    "our numerical simulations were performed in the matlab .",
    "the typical number of the iterations to reach the @xmath147 convergence was between 400 - 1000 ( on a personal computer with an amd 1ghz - processor the iterations have taken up to 5 seconds in the axially - symmetric case and up to 30 seconds in the 2d case ) .",
    "_ b. coherent coupling_. consider the following functional @xmath148 @xmath149 which appears in the description of the stationary states of a pair of repulsive and attractive ( @xmath150 ) two - dimensional condensates trapped in an asymmetric double - well potential @xcite ( in this case @xmath17 is proportional to the actual number of condensate atoms with the coefficient of proportionality of the order @xmath151 ) . here",
    "@xmath66 is the zero - point energy difference between the two wells of the external trap and @xmath17 is the total number of atoms . the euler - lagrange equations for the energy functional ( [ eq25 ] ) read :    [ eqcoh ] @xmath152    where @xmath21 coincides with the chemical potential for the order parameter normalized to the number of atoms @xmath17 .    as in the previous example of the incoherent coupling ,",
    "we have observed a rapid convergence of the iterations to the ground state solution .",
    "the numerical minimization was performed in polar coordinates .",
    "the characteristic times to reach the deviation of about @xmath147 are the same as in the previous example ( formulated in polar coordinates ) . to verify that the solutions obtained with the use of the rayleigh functional method are indeed the ground states , we have used another numerical approach which enables one to find all possible stationary states ( consult for more details refs .",
    "the deformation of the ground state with the variation of the zero - point energy difference is illustrated in figure [ fg3 ] , where the condensate of vanishing atomic interaction , @xmath153 , is tunnel - coupled to an attractive condensate .    _",
    "c. arbitrary coupling_. the minimization method based on the rayleigh functional can be applied to systems of equations coupled by a different way than the coherent and incoherent coupling . as an example",
    ", we consider here the bose - einstein condensate in a pancake trap ( in the @xmath154 plane ) , but in contrast to the above considered cases , we take into account the transverse dimension ( @xmath155 ) by using the gaussian variational ansatz with the @xmath156-dependent parameters , @xmath157 for the order parameter in the gross - pitaevskii functional ( [ eq2 ] ) . a similar ansatz was already used with success for the condensate in a cigar shaped trap @xcite . here",
    "the parameter @xmath158 accounts for the transverse motion of the condensate .",
    "we are interested in the stationary solutions which correspond to @xmath159 and are given as @xmath160 and @xmath161 . integrating over the transverse coordinate in the gross - pitaevskii functional ( [ eq2",
    "] ) we get the energy functional for the stationary states : @xmath162 here @xmath163 the transverse oscillator length , @xmath164 is the external potential in 2d .",
    "note that @xmath165 as @xmath166 .",
    "the pancake geometry corresponds to @xmath167 .",
    "the equations satisfied by the stationary states read : @xmath168 @xmath169 where @xmath170 is the @xmath171-wave scattering length .    assuming that the transverse width @xmath172 is of the order of @xmath173 ( which is supported by the numerics ) and estimating the operator @xmath174 we see that the term @xmath175 is much less than @xmath176 for @xmath177 . if this small term is omitted from the energy functional ( [ eqn2 ] ) , the equations for the stationary state become equivalent to the two - dimensional non - polynomial nls equation ( 2d npse ) of ref .",
    "( to compare with the latter reference , though , one should take into account that the coefficient 1/2 is missing there at @xmath178 in the equation which is equivalent to equation ( [ eqn3 ] ) ) .    the essential difference of the energy functional given by equation ( [ eqn2 ] ) from the above considered energy functionals lies in the fact that it has two variables of variation , @xmath179 and @xmath172 , but only one phase invariance exists and is associated with the normalization of @xmath179 .",
    "however , the minimization method based on the rayleigh functional defined with the substitution @xmath180 into the energy functional ( [ eqn2 ] ) works in this case also . to explain this",
    ", we note that one can think of the `` chemical potential '' corresponding to the variable @xmath172 as being equal to zero , thus the variation of the rayleigh functional with respect to @xmath172 coincides with that of the energy functional .",
    "the solutions of equations ( [ eqn3 ] ) and ( [ eqn4 ] ) were searched for in polar coordinates . as the system similar to ( [ eqn3])-([eqn4 ] ) was proposed in ref .",
    "@xcite as an improvement to the nls equation in two dimensions , we aimed to find out when does one need to use this complicated system for the pancake condensate instead of the much simpler 2d nls equation ?",
    "we have found that only in the study of collapse instability for @xmath181 the system ( [ eqn3])-([eqn4 ] ) gives visible improvement over the 2d nls equation . in all other cases ,",
    "if one is not interested in the transverse profile of the condensate , the 2d nls equation gives satisfactory results for the stationary states .",
    "( this , however , may not be so for the arbitrary time - dependent evolution , which is not captured by the 2d npse system of ref .",
    "@xcite since their @xmath182 identically . )    to illustrate this , in fig .",
    "[ fg4 ] we give the relative difference between the solutions @xmath183 of the system ( [ eqn3])-([eqn4 ] ) and the corresponding 2d nls equation for several values of the nonlinearity strength in the case of repulsive condensate ( @xmath184 ) .",
    "the solution is given in the units of @xmath185 , @xmath186 , the radius @xmath187 in terms of @xmath188 , and @xmath21 in terms of @xmath189 .",
    "the dimensionless nonlinearity strength is defined as @xmath190 .",
    "we have set @xmath191 which corresponds to the ratio @xmath192 . the transverse width @xmath172 , given in terms of @xmath173 , is shown in fig . [ fg5 ] .",
    "the maximal difference from @xmath173 is of the order of 10% .",
    "though in the case of attractive condensate the relative difference between the solutions of the system ( [ eqn3])-([eqn4 ] ) and the 2d nls equation is also small , the critical value for collapse differs noticeably .",
    "the critical value of the number of atoms is defined by @xmath193 , i. e. it is the endpoint coordinate of the curves in fig .",
    "the system ( [ eqn3])-([eqn4 ] ) is an improvement over the nls equation in this case , since the critical value differs by only 2% for @xmath194 from the actual value of the 3d condensate obtained in ref .",
    "the 2d nls value is achieved as the asymptotic limit when @xmath195 .",
    "we have argued that the minimization based on the rayleigh functional is always suitable for obtaining the ground state solutions .",
    "however , the possibility of obtaining excited states was not excluded at all .",
    "in contrast to the linear eigenvalue problem of section [ ray ] in the nonlinear case there is no general approach which would guarantee computation of all excited states , though there are some advances in this direction @xcite .",
    "however , a proper selection of the initial condition for minimization may lead to convergence to the `` nearest '' excited state .",
    "we illustrate this on the multi - vortex solutions of a nonlocal gross - pitaevskii equation , which in dimensionless form , in the frame of reference rotating with the frequency @xmath196 , reads ( see the details in ref .",
    "@xcite ) @xmath197 here @xmath198 , @xmath199 is the macdonald function , @xmath200 is the effective range of atomic interaction , @xmath201 is the angular momentum projection on the @xmath155-axis : @xmath202 , where @xmath92 is the polar angle , and @xmath196 is the rotation frequency . for simplicity , we consider the periodic boundary conditions along the @xmath155-axis , @xmath203 .",
    "we searched for new non - axial vortex solutions , involving combinations of vortices and antivortices , which represent the excited states of the system , since in the nonlocal gp equation ( [ gp3d ] ) , similar as the in local one , the stationary vortex solutions involving combinations of vortices and antivortices are never the energy minimizers .",
    "the energy is minimized by tkachenko lattices comprised of vortices only @xcite .    in figures",
    "[ fg7 ] and [ fg8 ] we give two examples of excited states comprised of vortex and anti - vortex combinations ( the right panel ) and the respective energy minimizers ( the left panel ) .",
    "these solutions were found by using the initial conditions with the phase resembling that of the multi - vortex solution in quest .",
    "the ground state solution of a nonlinear partial differential equation is degenerate if fixing the @xmath3-norm does not select a unique chemical potential . in the critical case , when there are infinitely many stationary points with equal energy and the same @xmath3-norm , the nonlinear optimization method based on the rayleigh functional may not converge at all .    to clarify this",
    "let us consider the critical nls equation .",
    "the ground state of the focusing critical nls equation is infinitely degenerate .",
    "it is well - known ( see , for instance , refs .",
    "@xcite ) that the two - dimensional critical nls equation has a family of soliton solutions having the same @xmath3-norm @xmath204 and a specific member @xmath205 satisfying the stationary equation @xmath206 is called the townes soliton . the stationary nls equation",
    "@xmath207 admits the scale invariance given by @xmath208 and @xmath209 .",
    "easy to see that , in two spatial dimensions , the scale invariance preserves the @xmath3-norm of the solution , while the energy of the stationary solution is exactly zero ( see below ) .",
    "this is precisely why one can not obtain the townes soliton by the nonlinear optimization method based on the rayleigh functional  the method fails to converge .",
    "this drawback of the rayleigh functional in the numerical approach turns out into an advantage for the analytical analysis .",
    "indeed , for the critical nls equation it immediately leads to the well - known identity @xcite @xmath210 which is satisfied by any stationary solution .",
    "let us show this .",
    "first of all , it is easy to see that the energy functional of the nls equation @xmath211 has a scale invariance property : @xmath212 for @xmath213 .",
    "the invariance property is transferred to the rayleigh functional : @xmath214 .",
    "differentiation of the latter with respect to the scale invariance factor @xmath215 gives @xmath216 at the stationary point .",
    "hence , the second equality in equation ( [ eq29 ] ) follows .",
    "the first equality is derived by integrating the stationary equation multiplied by @xmath9 and using the already proven equality .    in the above derivation we have explicitly related identity ( [ eq29 ] ) to the scale invariance property .",
    "the scale invariance is responsible for the exact balance of energies in any stationary solution of the critical nls equation : the kinetic energy is balanced by the energy due to the self - interaction .",
    "the identity ( [ eq29 ] ) is well - known .",
    "however , the point we try to make here that its relation to the critical scaling makes such an identity universal , i.e. it appears in connection to any nonlinear equation for which the energy functional has a scaling invariance for a family of solutions with the same @xmath3-norm .",
    "such is also the one - dimensional critical nls equation ( in the stationary form ) @xmath217 in this case the scale invariance is @xmath218 and @xmath219 leads to the energy scaling @xmath220 , with @xmath221 , while the @xmath3-norm @xmath222 remains unchanged .",
    "hence the rayleigh functional scales as follows @xmath214 and , by repetition of the above arguments , we get a similar identity satisfied by the family of stationary solutions : @xmath223    note that one can not use the energy functional in the above argument : the stationary solution is _ not _ an extremal of the energy functional . using the lagrange modified functional will not help either due to the explicit appearance of @xmath21 .",
    "the use of the rayleigh functional is indispensable in this short derivation .",
    "numerical search for stationary points of nonlinear partial differential equations is a difficult problem . to tackle",
    "such a problem one is left to try various methods and choose the one which gives a better performance and accuracy . in this paper",
    "we have proposed a new numerical method , the nonlinear optimization method based on the rayleigh functional .",
    "this method is a natural generalization of poincar s minmax principle for linear equations , formulated with the use of the rayleigh quotient .",
    "it turns out that the imaginary time relaxation method , a widely used method in the computational physics , is just a special case of nonlinear optimization based on the rayleigh functional .",
    "we have used the gradient scheme for minimization of the rayleigh functional , but this is not essential : one can use the minimization schemes which do not require use of the gradient .",
    "the simplicity of the rayleigh functional and its universality for nonlinear equations is one of the advantages of the method .",
    "moreover , the method can distinguish between the local minima and saddle points , since the second variation of the rayleigh functional is equal to the second variation of the lagrange modified energy functional , if the latter is evaluated in the space of normalized functions .",
    "the rayleigh functional takes care of the normalization constraint of the stationary solution .",
    "other constraints , however , have to be treated in the usual way .",
    "there are , however , some exceptional cases when the nonlinear optimization based on the rayleigh functional may fail .",
    "the principal cause of the failure is the infinite degeneracy of the ground state solution .",
    "still , a failure in the numerics is partially compensated by the fact that the very degeneracy allows one to get an important analytical insight relating the scale invariance and an identity satisfied by the stationary solutions in the critical case .",
    "this work was supported by cnpq and fapeal of brazil .",
    "the initial part of this work was done during the author s visit of the instituto de fisica terica , universidade estadual paulista , in so paulo , brazil , which was supported by the fapesp .",
    "we are grateful to jianke yang for helpful suggestions .",
    "99    l. pitaevskii and s. stringari , _ bose - einstein condensation _",
    "( clarendon press , oxford , 2003 ) .    c. sulem and p. l. sulem , _ the nonlinear schrodinger equation : self - focusing and wave - collapse _ , applied mathematical sciences , * 139 * , springer - verlag , 1999 .",
    "r. fletcher , _ practical methods of optimization _ ( 2nd",
    ". edition , jonh wiley & sons , new york , 1987 ) .",
    "j. nocedal , _ theory of algorithms for unconstrained optimization _",
    ", acta numerica * 199 * , 242 ( 1992 ) .",
    "j. j. garca - ripoll and v. m. prez - garca , _ optimizing schrdinger functionals using sobolev gradients : applications to quantum mechanics and nonlinear optics _ , siam j. sci .",
    "* 23 * , 1315 ( 2001 ) .",
    "l. d. landau and e. m. lifshitz , _ quantum mechanics _",
    "( 3rd edition , pergamon press , oxford , 1987 ) .",
    "l. c. crasovan et al , phys .",
    "a * 66 * , 036612 ( 2002 ) .",
    "v. s. shchesnovich , s. b. cavalcanti , _ stable stationary states in two tunnel - coupled two - dimensional condensates with the scattering lengths of opposite signs _ , to appear in j. phys .",
    "a : math . gen .",
    "( 2005 ) .    v. s. shchesnovich , s. b. cavalcanti , and r. a. kraenkel , _ solitons in tunnel - coupled repulsive and attractive condensates _",
    "a * 69 * , 033609 ( 2004 ) .",
    "v. s. shchesnovich , a. m. kamchatnov , and r. a. kraenkel , _ mixed - isotope bose - einstein condensates in rubidium _ ,",
    "a * 69 * , 033601 ( 2004 ) .",
    "j. barzilai and j. m. borwein , _ two - point step gradient methods _ , i m a j. numer . analys .",
    "* 8 * , 141 ( 1988 ) .",
    "m. raydan , _ the barzilai and borwein gradient method for the large scale unconstrained minimization problem _ , siam j. optim . *",
    "7 * , 26 ( 1997 ) .",
    "r. fletcher , _ on the barzilai - borwein method _",
    ", research report department of mathematics , university of dundee , 2001 .",
    "b. fornberg , _ a practical guide to pseudospectral methods _ , ( cambridge , uk : cambridge university press ) 1996 .",
    "j. p. boyd , _ chebyshev and fourier spectral methods _ , ( second ed . ,",
    "new york : dover publications inc . ) 2000 .",
    "l. n. trefethen , _ spectral methods in matlab _ ,",
    "( philadelphia : siam ) 2000 .    v. s. shchesnovich , b. a. malomed , and r. a. kraenkel , _ solitons in bose - einstein condensates trapped in a double - well potential _ , _ physica d _ * 188 * , 213 ( 2004 ) .",
    "l. berge , phys .",
    "rep . * 303 * , 259 ( 1998 ) .",
    "a. m. kamchatnov , and v. s. shchesnovich , phys .",
    "a * 70 * , 023604 ( 2004 ) .",
    "l. salasnich , a. parola , and l. reatto , phys .",
    "a * 65 * , 043614 ( 2002 ) .",
    "a. gammal , t. frederico , and l. tomio , phys .",
    "a * 64 * , 055602 ( 2001 ) .",
    "v. s. shchesnovich and r. a. kraenkel , _ vortices in nonlocal gross - pitaevskii equation _ , j. phys .",
    "a : math . gen . * 37 * , 6633 ( 2004 ) .",
    "the axially symmetric ground state of the two - isotope bose - einstein condensate mixture of rubidium .",
    "the dashed and dotted lines give the order parameters ( normalized to the actual number of atoms ) of @xmath132rb and @xmath134rb isotopes , respectively .",
    "panel ( a ) @xmath224 , @xmath225 and @xmath226 ; panel ( b ) @xmath227 , @xmath228 , @xmath229 and @xmath230 ; panel ( c ) @xmath231 , @xmath232 and @xmath233 ( in dimensionless units ) . ]     the symmetry breaking ground state of the bose - einstein condensate mixture of the isotopes of rubidium .",
    "the left and right panels give the shapes of the order parameters of @xmath132rb and @xmath134rb isotopes , respectively . here",
    "@xmath234 , @xmath235 , @xmath236 and @xmath237 ( in dimensionless units ) . ]",
    "deformation of the ground state of two bose - einstein condensates trapped in an asymmetric double - well potential with variation of the zero - point energy difference .",
    "the picture corresponds to the energy functional ( [ eq25 ] ) .",
    "here @xmath153 , @xmath238 and @xmath239 , the solid line gives @xmath240 , while the dashed one @xmath241 . ]          the stationary vortex solutions for @xmath243 , @xmath244 and @xmath245 .",
    "the left panel shows the 3-vortex solution and the right one  the 5-vortex solution comprised of 4 vortices and 1 antivortex ( in the center ) . ]    the stationary vortex solutions for @xmath243 , @xmath244 and @xmath246 .",
    "the left panel shows the 8-vortex solution and the right one  the 16-vortex solution comprised of 12 vortices and 4 antivortices . ]"
  ],
  "abstract_text": [
    "<S> we introduce rayleigh functional for nonlinear systems . it is defined using the energy functional and the normalization properties of the variables of variation . </S>",
    "<S> the key property of the rayleigh quotient for linear systems is preserved in our definition : the extremals of the rayleigh functional coincide with the stationary solutions of the euler - lagrange equation . moreover , </S>",
    "<S> the second variation of the rayleigh functional defines stability of the solution . </S>",
    "<S> this gives rise to a powerful numerical optimization method in the search for the energy minimizers . </S>",
    "<S> it is shown that the well - known imaginary time relaxation is a special case of our method . to illustrate the method we find the stationary states of bose - einstein condensates in various geometries . </S>",
    "<S> finally , we show that the rayleigh functional also provides a simple way to derive analytical identities satisfied by the stationary solutions of the critical nonlinear equations . </S>"
  ]
}