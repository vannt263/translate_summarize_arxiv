{
  "article_text": [
    "in radio astronomy image analysis , for which approximations of gaussian noise statistics and gaussian source morphologies are suitable , much attention has been paid to least squares 2d elliptical gaussian fitting routines ( e.g. * ? ? ? * ) .",
    "such routines , for example those implemented within the miriad @xcite and aips @xcite packages , are appropriate for source extraction when fitting parameters have been carefully inspected or constrained . however , when left unconstrained , the accuracy of these gaussian fits may become degraded , requiring significant manual inspection overheads to identify poor fits and ensure high quality source extraction .",
    "gaussian fitting routines may therefore be unsuited to the general analysis of large survey data .",
    "in this work we seek to develop a robust alternative to gaussian fitting by utilizing the flood fill algorithm @xcite . in particular , we seek to develop a source extraction procedure that incorporates an accurate , objective , and automated method of background root - mean - square ( rms ) noise estimation , and to develop the first accurate method of source extraction for resolved sources in linear polarization .",
    "additional factors motivating this work are described as follows .",
    "first , a number of large radio surveys are planned for the near future , capitalising on upcoming new or substantially upgraded facilities such as askap @xcite , meerkat @xcite , lofar @xcite , alma @xcite , lwa @xcite , wsrt @xcite , evla @xcite , and many others including vlbi networks and epoch of reionisation instruments . with these facilities will come a number of large surveys in both total intensity and linear polarization , for example emu @xcite , wodan , mightee , possum @xcite , and galfacts @xcite .",
    "the ability to catalogue objects within the large images produced by these surveys , with as little manual intervention as possible , will be key to maximising scientific output .",
    "we seek to develop a robust , automated method of source extraction that requires only the most complex of sources to be manually inspected .",
    "second , recent polarimetric studies have indicated an increase in the fractional polarization of faint extragalactic radio sources ( e.g. * ? ? ? * ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ) , which are difficult to reconcile with population modelling @xcite .",
    "we seek here to subject the process of polarization measurement to close scrutiny , and to provide the community with a measurement tool that has been assessed within a controlled testing environment .    and",
    "third , the flood fill algorithm underpins a number of existing source extraction routines , such as those available in the cupid ( e.g. clumpfind * ? ? ?",
    "* ) and sextractor packages . however , these routines are unable to measure flux densities without performing subsequent gaussian ( or similar ) source fitting .",
    "alternatively , the flood fill algorithm has been used without the subsequent least squares fitting step for the customised analysis of extended , non - gaussian sources in total intensity @xcite and linear polarization . however ,",
    "the raw flood fill algorithm as implemented in these works is not suitable for use with compact ( unresolved or resolved gaussian ) sources , as their flux density measurements suffer from two significant systematic biases . in this work",
    "we describe how to correct for these biases in a robust manner , so as to enable the flood fill approach to handle both gaussian and non - gaussian sources .    we have implemented these bias corrections within a new flood fill program called blobcat , which catalogues blobs in astronomical images .",
    "we use the term _ blob _ in an image - processing sense to represent an island of agglomerated pixels within a sea of noise , and to indicate that its properties are not inferred by fitting ( e.g. least squares ) .",
    "we have designed blobcat for use in radio astronomy , attempting to produce a program capable of encapsulating the entire measurement process between observational image and output catalogue .",
    "this paper is organised as follows . in ",
    "[ sec : hbw ] we describe the algorithms implemented within blobcat , detailing required program inputs , including the minimal set required for operation , and output data products . in ",
    "[ sec : p ] we assess blobcat s peak surface brightness ( sb ) , integrated sb , and positional measurement performance .",
    "we investigate the program s ability to handle unresolved , resolved , and complex ( non - gaussian ) sources in images of total intensity ( stokes @xmath0 ) and linear polarization ( @xmath3 or @xmath4 ; these terms are defined in ",
    "[ sec : hbw ] ) , and discuss issues regarding polarization bias .",
    "for comparison , we also assess the performance of a standard gaussian fitting routine . in ",
    "[ sec : pp ] we discuss two examples of post - processing that may be required to make full use of blobcat s output catalogue ; these are particularly relevant for data containing extended non - gaussian , or multiple blended gaussian , sources . in   [ sec : conc ] we present our summary and conclusions .",
    "blobcat is written in the scripting language python .",
    "the program is designed to catalogue blobs in a two - dimensional ( 2d ) input fits image of sb . to isolate blobs and determine their properties",
    ", blobcat requires an estimate of the background rms noise and degree of bandwidth smearing at each spatial position ( pixel ) within the sb image .",
    "these two diagnostics may be provided to blobcat as either uniform ( spatially - invariant ) values or , more generally , as 2d input fits images that encode the more realistic scenario whereby noise and smearing properties vary with spatial position over the sb image .",
    "an overview of blobcat is presented in fig .",
    "[ fig : figflow ] .        in the following sections we describe the input images and their requirements (   [ sec : hbwii ] ) , the core flood fill algorithm used to isolate blobs (   [ sec : hbwff ] ) , the key morphological assumption (   [ sec : hbwbm ] ) and bias corrections (   [ sec : hbwbc ] ) applied to extract blob properties , the input arguments required to run blobcat (   [ sec : hbwpin ] ) , the output catalogue (   [ sec : hbwpout ] ) , and the optional program outputs (   [ sec : hbwoo ] ) .",
    "blobcat requires up to three input fits images , as outlined in fig .",
    "[ fig : figflow ] . for flexibility , the images of background rms noise and bandwidth smearing are optional , and may instead be replaced by spatially - invariant input values .",
    "blobcat is designed to analyse blobs with positive sb . to detect negative blobs ,",
    "the input sb image must be inverted before use . in this paper",
    "we focus on the analysis of blobs in images of total intensity and linear polarization ( @xmath3 or @xmath4 ) .",
    "blobcat may also be used to analyse images of stokes @xmath1 , @xmath2 , and @xmath5 intensities , though we note that resolved sources exhibiting both positive and negative sb in these images will be incorrectly handled ; we do not attempt to address the analysis of such sources here .",
    "we assume that blobs of interest in total intensity and linear polarization may be characterised by 2d elliptical gaussians , though we do consider the treatment of non - gaussian blobs later in   [ sec : ppbd ] . image pre - processing techniques to remove wide - spread extended features prior to the analysis of more compact sources may be required ( e.g. * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "we assume that images of @xmath4 are produced following the application of rotation measure ( rm ) synthesis and rmclean such that for each spatial pixel located at pixel coordinate @xmath6 , the polarized emission is obtained by taking the peak value in the cleaned faraday dispersion function , namely @xmath7 where @xmath8 is faraday depth .",
    "we note that this definition of @xmath4 assumes faraday spectra along each pixel sightline consisting of no more than a single unresolved faraday component ( additional components will be ignored ) ; analysis with more advanced models of @xmath4 are beyond the scope of this work .",
    "analysis involving equation  ( [ eqn : makelrm ] ) is demonstrated , for example , by and hales et al .",
    "( in preparation ) .",
    "alternatively , images of standard linear polarization , @xmath9 may be used .",
    "see @xcite and @xcite for statistical properties of @xmath3 , and @xcite for statistical properties of both @xmath3 and @xmath4 . for simplicity in subsequent discussion",
    ", we neglect the pixel coordinate notation @xmath6 affixed to all spatially variable parameters , unless required for clarity .",
    "if position - dependent rather than spatially - invariant blob detection thresholds are required , then a background rms noise image must be specified .",
    "the user is required to independently construct a suitable noise map for their sb image , for example using the rms estimation algorithm implemented within the sextractor package .",
    "despite having been originally developed for the analysis of optical photographic plate and ccd data , sextractor has been found to be reliable when generating noise maps from radio data . sextractor determines the rms noise at each spatial pixel in an image by extracting the distribution of pixel values within a local mesh , iteratively clipping the most deviant values until convergence is reached at @xmath103@xmath11 about the median .",
    "the choice of mesh size ( in pixel@xmath12 ) is very important .",
    "if it is too small , the local rms estimate may be biased due to lack of statistically independent measurements or overestimated due to the presence of real sources .",
    "if it is too large , any true small - scale variations in local rms noise may be washed out .",
    "at least @xmath13 independent resolution elements ( beams ) per mesh area are required in order to reduce the uncertainty in estimates of local rms noise to below @xmath14^{{\\scriptscriptstyle}2}[1-n_{{\\scriptscriptstyle}b}^{{\\scriptscriptstyle}-1}]-1\\}^{{\\scriptscriptstyle}0.5}=8\\%$ ] ( using an approximation to the uncertainty of the standard error estimator , suitable for @xmath15 ; p.  63",
    "the mesh area , @xmath16 , may be calculated according to @xmath17 where @xmath18 is the beam volume for a 2d elliptical gaussian with full - width at half - maximum ( fwhm ) along the major and minor axes given by @xmath19 and @xmath20 , respectively , and where @xmath21 is the densest lattice packing for congruent copies of any convex shape ( e.g. circles , ellipses ; * ? ? ?",
    "it is customary in physical sciences to treat rms noise . ]",
    "values , such as those reported by sextractor , as standard errors in order to boost noise estimates in regions where extended non - signal features are present ; namely by defining that @xmath22 . in other words , by using rms noise estimates to calculate local signal - to - noise ratio ( snr ) thresholds for blob detection , it is possible to take into account not only local variations in image sensitivity , but also the possible presence of dc offsets due to artefacts ( e.g. sidelobes ) .",
    "for this reason we recommend the method of using sextractor or a similar package to estimate noise over the method of simply estimating it from , say , stokes @xmath5 because it can take into account features in the data that may be missed by more theoretically motivated expectations .",
    "the procedure described above , incorporating equation  ( [ eqn : nbeam ] ) , may be easily automated to provide objective estimates of rms noise for any noise - dominated image .",
    "finally , we note that the sextractor procedure above is suitable for determining the rms noise in images of stokes @xmath0 , @xmath1 , @xmath2 , or @xmath5 , but not @xmath4 ( nor @xmath3 ) . instead ,",
    "to determine @xmath23 at each spatial location in @xmath4 , sextractor should be run on each constituent @xmath24 and @xmath25 image in each @xmath26th of @xmath27 frequency channels to obtain @xmath28 and @xmath29 .",
    "these in turn may then be combined using weighted least squares as @xcite @xmath30^{\\!{\\scriptscriptstyle}-\\frac{1}{2 } } \\;,\\ ] ] where the term @xmath31 represents the correlation correction factor defined by equation  ( 23 ) from @xcite .",
    "if corrections for position - dependent bandwidth smearing ( chromatic aberration ) are required , then an image detailing the degree of smearing at any location within the sb image must be specified .",
    "bandwidth smearing is due to the finite bandwidth of frequency channels , resulting in a radially - dependent convolution ( smearing ) that worsens as a function of positional offset from the phase tracking centre of a single - pointed radio observation @xcite .",
    "the effect is to decrease the peak sb and to increase the observed size of sources without affecting their integrated sb .",
    "bandwidth smearing needs to be carefully accounted for in mosaics consisting of multiple overlapped pointings .",
    "this is because any location in a mosaicked image , even one situated over a pointing centre , may include multiple contributions from adjacent pointings in which bandwidth smearing is significant @xcite .",
    "the bandwidth smearing image input to blobcat should map out the ratio between the observed smeared peak sb , @xmath32 , and the true unsmeared peak sb , @xmath33 , for all spatial positions within the sb image ( using notation consistent with that introduced later in this work ) .",
    "we denote the local degree of bandwidth smearing as @xmath34      all images input to blobcat must have the same dimensions and be located on the same pixel grid ; for cataloguing purposes we require that the primary image world coordinate system is expressed in equatorial coordinates ( ra - dec ) . in order to measure fitted gaussian peaks to within 1% , at least 5 pixels per resolution",
    "element fwhm should be present ( see appendix a ) .",
    "blobcat does not calculate the jacobian of the transformation between projection plane coordinates and native longitude and latitude .",
    "instead , blobcat requires that input images are gridded to an equal - area projection , so as to ensure that sky area per pixel is preserved .",
    "blobcat supports both zenithal equal - area ( zea ) projection ( the premier scheme for a hemisphere ) and hammer - aitoff ( ait ) equal - area projection ( suitable for all - sky images ) .",
    "failure to use an equal - area projection will lead to systematic biases in blobcat s extracted flux densities and visibility area ( sky density ) calculations ( see   [ sec : hbwpout ] ) .",
    "however , there are two common situations where this equal - area requirement may be relaxed .",
    "the first is when measuring flux densities for unresolved sources by obtaining their peak pixel or fitted peak value ( cf .",
    "appendix  a ) .",
    "the second involves the use of images with non - equal - area projections ; for example , the north - celestial - pole ( ncp ) projection @xcite .",
    "for such images , flux density measurements for resolved sources , which require integration over sb ( i.e. over pixels ) , will only be suitable for sources situated close to the image reference point where distortion effects are minimal . to enable such analysis",
    ", blobcat also supports images in ncp projection or the more general slant orthographic ( sin ) projection .",
    "regridding of input images to one of the zea , ait , ncp , or sin projection schemes may be computed using , for example , the wcslib package .",
    "finally , we remark that equal - area projections do not preserve shape ; it is not possible to conserve both angles and areas when mapping portions of a sphere to a plane .",
    "blobcat uses the flood fill , or thresholding , algorithm @xcite to isolate individual blobs ( islands ) of pixels from within a snr map .",
    "the snr map is formed by taking the pixel - by - pixel ratio between the input sb and background rms noise images . in units of dimensionless snr",
    ", we denote the threshold for detecting blobs as @xmath35 and the cut - off threshold for flooding down to as @xmath36 . by applying thresholds in the snr map rather than the sb image , local variations in sensitivity can be accommodated .",
    "we do not take into account bandwidth smearing at this initial flooding stage ( see   [ sec : hbwpout ] below ) .",
    "we have implemented the highly optimised flood fill algorithm from @xcite within blobcat , which operates as follows .    1 .",
    "locate all pixels in the snr map that have value @xmath37 , including those pixels that would meet this detection threshold if it were not for pixellation attenuation ( see appendix a and comments below ) .",
    "form blobs about each of these pixels by ` flooding ' adjacent pixels that have value @xmath38 .",
    "3 .   for each isolated blob",
    ", perform bias corrections (   [ sec : hbwbc ] ) and catalogue properties (   [ sec : hbwpout ] ) .",
    "we denote the peak sb observed within the peak pixel for each blob by @xmath39 ( with units jy  beam@xmath40 ) , and the resulting observed peak snr by @xmath41 .",
    "to minimise the attenuating effect of pixellation on @xmath39 , blobcat calculates a fitted peak sb for each blob by applying a 2d parabolic fit to a @xmath42 pixel array about the raw peak , as described in appendix a. we denote this fitted peak by @xmath43 , and the resulting fitted peak snr by @xmath44 .",
    "we denote measurements of integrated sb by @xmath45 ( with units jy ) , which are obtained for each blob by summing their flooded pixel intensities and dividing by the beam volume ( @xmath46 ) .",
    "blobcat attempts to perform its internal calculations , as described in the following sections , using the fitted peak quantities @xmath43 and @xmath47 .",
    "if @xmath48 , as may occur for heavily pixellated images ( namely , for small values of @xmath49 and @xmath50 as defined in appendix a ) , then for consistency blobcat sets @xmath51 ( and thus @xmath52 ) to ensure that blobs with @xmath53 yet @xmath54 are not unfairly rejected from the output catalogue . for notational simplicity in subsequent discussion we will use the superscript obs to refer to both unfitted and fitted peak quantities ;",
    "we will not distinguish between obs and fit quantities unless required for clarity .",
    "we now turn to the key morphological assumption used to infer physical properties of these isolated blobs from their raw observed measurements .      in aperture synthesis imaging ,",
    "individual resolution elements are described by the morphology of the dirty beam ( the fourier transform of the sampling distribution ) .",
    "provided that the central core of the dirty beam can be suitably approximated by an elliptical gaussian , then individual resolution elements in the resulting images can be described by 2d elliptical gaussians . in other words ,",
    "point sources will appear as gaussians in an image .",
    "in blobcat we assume that each isolated blob is described by a 2d elliptical gaussian characterised by a peak snr , @xmath55 , and representative major and minor fwhms @xmath56 and @xmath57 , respectively ( representative because these fwhms are never individually measured , as we discuss shortly ) . in   [ sec : pcs ] and   [ sec : ppbd ] we discuss situations where this assumption of gaussian blob morphology is poor .",
    "the general equation for a 2d elliptical gaussian , located at the origin of an arbitrary coordinate frame @xmath58 that is aligned with the major / minor axes , is given by @xmath59 \\;.\\ ] ] this equation is valid for gaussian blobs in noise - free images of either total intensity or linear polarization .",
    "the volume of this 2d gaussian is @xmath60 this general setup , including detection thresholds as defined in   [ sec : hbwff ] , is shown in fig .",
    "[ fig : figblob ] .",
    "blobcat applies two important corrections to each isolated gaussian blob in order to prevent systematic biases from affecting its peak and integrated sb measurements .",
    "these corrections account for :    1 .",
    "the positive peak surface brightness bias exhibited by @xmath39 for resolved blobs ; and 2 .",
    "the negative integrated surface brightness bias exhibited by @xmath45 caused by the limited blob volume accessible to flooding before the cut - off threshold @xmath36 is reached .",
    "an illustration outlining the need for the first correction is presented in fig .",
    "[ fig : figbias ] .    to understand this bias and how to correct for it , we first examine the following experiment .",
    "consider for simplicity that blobs are represented by tophat functions rather than 2d elliptical gaussians , that images are produced with one pixel per resolution element , and that noise is gaussian in character .",
    "noise is always resolved on the same spatial scale as unresolved sources .",
    "therefore , the peak sb of an unresolved blob , here observed as the magnitude of a single pixel , will be affected by a single noise sample which may be positive or negative . for an ensemble of such unresolved blobs ,",
    "each with identical true peak sb but different noise sample , the average observed peak sb will be an unbiased tracer of the true peak sb .",
    "now consider a resolved tophat blob , over which @xmath61 independent noise samples will be present .",
    "the observed peak sb of this resolved blob will depend on the maximum of @xmath61 independent noise samples , rather than @xmath62 for an unresolved blob .",
    "thus the more resolved the blob becomes , the larger @xmath61 becomes , and the less likely it is that a negative noise sample will be selected as the observed peak sb .",
    "the average observed peak sb for an ensemble of identically resolved blobs will therefore be positively biased from its true value . before returning to 2d elliptical gaussians",
    ", we will describe how to correct for this positive bias in the context of order statistics using the simpler tophat blob morphology .    for a sample of @xmath61 independent and identically - distributed variates",
    "@xmath63 ordered such that @xmath64 ( using notation @xmath65 for unordered variates and @xmath66 for ordered variates ) , then @xmath67 is known as the @xmath68th order statistic and @xmath69 . if @xmath70 has density function @xmath71 and distribution function @xmath72 , then @xcite give the density function for @xmath67 as @xmath73^{{\\scriptscriptstyle}k-1 }      \\left[1-f\\!\\left(x\\right)\\right]^{{\\scriptscriptstyle}m - k}\\,.\\end{aligned}\\ ] ] the density function for the maximum of @xmath61 independent gaussian variates with variance @xmath74 is obtained from equation  ( [ eqn : os ] ) by setting @xmath75 , giving @xmath76 \\right\\}^{{\\scriptscriptstyle}m-1 } \\,,\\end{aligned}\\ ] ] where erf is the error function defined by @xmath77 the expectation value for equation  ( [ eqn : maxm ] ) is given by @xmath78      = \\int_{-\\infty}^{\\infty } f\\!\\left(x_{{\\scriptscriptstyle}(m)}\\right ) \\ , dx \\;,\\ ] ] which is plotted for a range of @xmath61 samples in fig .",
    "[ fig : figosm ] .",
    "equation  ( [ eqn : emaxm ] ) represents the average positive bias existing between measurements of observed peak sb and true peak sb for a tophat blob .",
    "given measurement of @xmath61 , namely the number of independent resolution elements present over the extent of the blob , an estimate for the bias can be obtained .",
    "the bias is most pronounced for low snr resolved blobs ; for a tophat blob of extent @xmath79 resolution elements , the bias for a @xmath80 blob is @xmath81 ( see fig .  [",
    "fig : figosm ] ) .",
    "we now return to the scenario whereby blobs are assumed to represent 2d elliptical gaussians . instead of obtaining @xmath61 from the full spatial extent of a tophat blob",
    ", @xmath61 needs to be estimated from the observable properties of a 2d gaussian embedded in noise . in blobcat",
    "we estimate @xmath61 by approximating that the relevant number of independent resolution elements contributing to the positive bias can be extracted from the cross - sectional area contained within a slice of constant - snr at a few @xmath11 below the peak , as parameterised by @xmath82 in fig .",
    "[ fig : figbias ] .",
    "blobcat measures the cross - sectional area for each blob at @xmath83 , which we denote @xmath84 , by flooding from the peak to this threshold and simply counting the number of pixels present .",
    "@xmath61 is then estimated using ( cf .",
    "equation  ( [ eqn : nbeam ] ) ) @xmath85 to determine the positive bias between @xmath39 and @xmath32 for resolved blobs , blobcat uses the following fifth - order polynomial fit to the curve in fig .",
    "[ fig : figosm ] to form a simple lookup table ( rather than solving for equation  ( [ eqn : emaxm ] ) ) , @xmath86 where @xmath87      \\nonumber\\\\      & \\approx & \\frac{s_{{\\scriptscriptstyle}p}^{{\\scriptscriptstyle}\\textrm{obs}}}{s_{{\\scriptscriptstyle}p}}\\;\\ ;      \\left ( = \\frac{a^{{\\scriptscriptstyle}\\textrm{obs}}}{a } \\right ) \\ ; , \\label{eqn : maxmfit2}\\end{aligned}\\ ] ] and where @xmath88 , @xmath89 , @xmath90 , @xmath91 , and @xmath92 .    to illustrate the constraints on selecting @xmath82 , imagine trying to correct",
    "the raw observed peak sb for a resolved gaussian blob , detected with peak @xmath93 , by arbitrarily defining that the relevant spatial extent be measured at @xmath94 .",
    "choosing @xmath61 in this way will overestimate the peak s positive bias , because not even a @xmath95 noise spike located at the @xmath96 contour of the blob could be mistaken for the true peak .",
    "alternatively , choosing too small a value of @xmath82 will not only underestimate the peak bias in the opposite manner to above , but also render @xmath61 vulnerable to additional negative bias due to @xmath84 being fooled ( limited in spatial extent ) by noise troughs near the blob s peak .",
    "we performed simulations to empirically determine the most suitable range of values for @xmath82 .",
    "we found that choosing @xmath97 best corrected for the positive bias exhibited by @xmath39 for resolved blobs in images of either total intensity or linear polarization ( @xmath3 or @xmath4 ) .",
    "we discuss the simulations used to determine this optimum @xmath82 , as well as the general performance of the peak sb bias correction from equation  ( [ eqn : maxmfit ] ) , in ",
    "[ sec : p ] .      to prevent the flood fill algorithm from cascading into noise features adjacent to real blobs",
    ", flooding is terminated at the cut - off threshold , @xmath36 .",
    "the integrated sb measured for each blob , @xmath45 , therefore underestimates the true integrated sb , @xmath98 , because only a limited fraction of the total volume for each blob is ever directly accessed .",
    "we denote this fraction @xmath99 , as indicated in fig .",
    "[ fig : figblob ] .    by integrating the volume flooded between @xmath55 ( true peak snr ) and @xmath36 for a 2d elliptical gaussian blob , and dividing this result by the total volume of the blob ( equation  ( [ eqn : gvol ] ) )",
    ", the fraction of flooded volume @xmath99 is found to be @xmath100 blobcat corrects the observed integrated sb for each detected blob ( regardless of blob dimension ) by simply dividing by @xmath99 , namely @xmath101 it is important to note that @xmath55 in equation  ( [ eqn : blobfrac ] ) is the true peak snr . for resolved blobs ,",
    "the peak bias correction from equation  ( [ eqn : maxmfit ] ) needs to be applied first , so as to debias the observed peak snr , @xmath102 , and return an estimate for the unbiased peak snr , @xmath55 .",
    "the effect of using uncorrected peak snrs for resolved sources in equation  ( [ eqn : blobfrac ] ) is demonstrated in   [ sec : p ] .",
    "the choice of @xmath36 affects the maximum volume that can be flooded within a faint blob . so as to recommend a minimum value , we performed simulations of integrated sb recovery for 2d elliptical gaussian blobs embedded within images of total intensity and linear polarization ; the details of these simulations are discussed in ",
    "[ sec : p ] .",
    "we incrementally reduced @xmath36 in these simulations , seeking a balance between the measurement of as much volume as possible within faint blobs , and the need to avoid bias from potential over - flooding of neighbouring noise features .    in total intensity images for blobs as faint as @xmath103 , we found that a cut - off threshold of @xmath104 was required in order to robustly flood as many true blob pixels as possible whilst avoiding over - flooding of adjacent non - blob ( noise ) pixels . in linear polarization images ( @xmath3 or @xmath4 ) ,",
    "non - gaussian noise statistics typically limit detection thresholds to @xmath105 @xcite .",
    "these images thus require higher flooding thresholds than those for total intensity ; we note that a comparison between the average cross - sectional profile of a gaussian blob embedded in images exhibiting gaussian , @xmath3 , and @xmath4 statistics is presented by @xcite . in images of @xmath4 for blobs as faint as @xmath106",
    ", we found that a cut - off threshold of @xmath107 was suitable .",
    "we note that this value of @xmath36 is dependent on the observational setup used to produce @xmath4 .",
    "to determine an equivalent value of @xmath36 for any @xmath3 or @xmath4 image , a cut - off with equal statistical significance to our suggested @xmath107 value should be calculated ( e.g. see * ? ? ?",
    ".    for a detection threshold of @xmath108 in an image of total intensity , equation  ( [ eqn : blobfrac ] ) with @xmath104 implies that the maximum correction factor for any blob is @xmath109  @xmath110  @xmath111 . in linear polarization , for a detection threshold of @xmath112 and @xmath107 , the maximum correction factor is @xmath109  @xmath110  @xmath113 .",
    "if accurate error estimates are not immediately required , blobcat does not requires many inputs to run .",
    "preliminary analysis can be performed on a single input sb image by specifying three parameters : a background rms noise value ( simply so that snrs can be computed at any spatial location within the image ) , a blob detection snr threshold ( @xmath35 ) , and a cutoff snr threshold for flooding ( @xmath36 ) . however , to make full use of the output catalogue , particularly errors , additional input parameters are required . for completeness , we list all blobcat input arguments in appendix  b.      blobcat produces an output catalogue containing 41 entries for each detected blob . in this section",
    "we list and define these entries , which include final measurements of peak and integrated sb , corrected for bandwidth smearing and clean bias , errors , and the ` visibility ' area for each blob .",
    "the catalogue entries , some of which require various blobcat input arguments to be specified ( see appendix  b ) , are as follows .",
    "_ column 1 : _",
    "i d + blob identification number , ordered by decreasing observed peak snr ( see column 26 ) .",
    "_ column 2 : _ npix + number of flooded pixels comprising blob .",
    "_ columns 3 - 4 : _ x_p , y_p + ra and dec of peak pixel in pixel coordinates .",
    "_ columns 5 - 6 : _",
    "ra_p , dec_p + ra and dec of peak pixel in degrees .",
    "_ column 7 : _ ra_p_err + total position error in ra of peak pixel , which we define as @xmath114 the first term , @xmath115 , represents the positional uncertainty of the phase calibrator , for example with reference to the international celestial reference frame , that was used to produce the sb image .",
    "the second term , @xmath116 , represents the positional uncertainty of the image frame about the ( assumed ) position of the phase calibrator .",
    "given that image positional errors correspond to fourier - plane phase errors , @xmath117 may be estimated by measuring @xmath118 , the standard error of the mean ( sem ) of the variation in the phase corrections resulting from phase self - calibration @xcite . by estimating the fraction of a resolution element by which positions may be in error as @xmath119 , blobcat estimates the frame error as @xmath120 where the factor of @xmath121 projects the 2d sem along one of two orthogonal axes , and where @xmath122 is the projected resolution along the ra - axis .",
    "@xmath122 is given by @xmath123 where @xmath124 is the position angle of the major axis east of north .",
    "the third term , @xmath125 , encapsulates positional error due to the significance of the blob detection , which we define for reasons described later in   [ sec : pisrpos ] and   [ sec : plsrpos ] as @xmath126    _ column 8 : _",
    "dec_p_err + total position error in dec of peak pixel , which we define in a similar manner to equation  ( [ eqn : raerr ] ) as @xmath127 where @xmath128 and where the projected resolution along the dec - axis is given by @xmath129    _ columns 9 - 10 : _",
    "x_c , y_c + ra and dec of area ( unweighted ) centroid in pixel coordinates , @xmath130 where @xmath131 .",
    "_ columns 11 - 12 : _",
    "ra_c , dec_c + ra and dec of unweighted centroid in degrees .",
    "_ column 13 : _ cflag + centroid flag . if @xmath132 is located within a flooded pixel , then @xmath133 ; otherwise @xmath134 .",
    "_ columns 14 - 15 : _ x_wc , y_wc + ra and dec of snr - weighted centroid in pixel coordinates , @xmath135    _ columns 16 - 17 : _",
    "ra_wc , dec_wc + ra and dec of snr - weighted centroid in degrees .",
    "_ column 18 : _ wcflag + weighted centroid flag . if @xmath136 is located within a flooded pixel , then @xmath137 ; otherwise @xmath138 . if @xmath137 , then ra_wc and dec_wc from columns 16 - 17 above are the formal position of the blob .",
    "if @xmath138 , the blob is likely to be significantly non - gaussian ; the weighted - centroid position may not be suitable for formal cataloguing purposes .",
    "manual inspection , or formal cataloguing using the raw peak pixel or area centroid positions , may be required .",
    "_ columns 19 - 22 : _ x_min , x_max , y_min , y_max +",
    "minimum and maximum pixel coordinate in ra ( @xmath139 ) and dec ( @xmath140 ) within blob .    _",
    "column 23 : _",
    "rms + rms noise , @xmath11 , at position of peak pixel .",
    "_ column 24 : _ bwscorr + bandwidth smearing correction , @xmath141 ( from equation  ( [ eqn : bwsval ] ) ) .",
    "_ column 25 : _",
    "m + number of independent resolution elements from equation  ( [ eqn : m ] ) .",
    "@xmath61 is used in equation  ( [ eqn : maxmfit ] ) to correct for the positive peak bias exhibited by resolved blobs . to prevent this bias correction from being applied to noise - affected unresolved blobs ( i.e. where the number of pixels flooded is artificially boosted due to a connected noise feature ) , blobcat only applies the correction to those blobs with @xmath142 ; the suitability of this value was determined empirically .",
    "_ column 26 : _",
    "snr_obs + observed ( raw ) snr , @xmath41 .    _ column 27 : _ snr_fit + fitted snr , @xmath44 .",
    "_ column 28 : _ snr + snr , @xmath55 , corrected for peak bias ( equation  ( [ eqn : maxmfit ] ) ) .",
    "_ column 29 : _ s_p_obs + observed ( raw ) peak sb , @xmath39 .",
    "_ column 30 : _ s_p_fit + fitted peak sb , @xmath43 , obtained using a 2d parabolic fit to a @xmath42 pixel array about the raw peak pixel @xmath143 . if @xmath48 , then blobcat sets @xmath144 so as to use the more accurate measurement ( see appendix a and   [ sec : hbwff ] ) .",
    "_ column 31 : _ s_p + peak sb , @xmath32 , corrected for peak bias ( equation  ( [ eqn : maxmfit ] ) ) .    _ column 32 : _ s_p_cb + peak sb corrected for peak bias and clean bias , @xmath145 .",
    "clean bias is a deconvolution effect that redistributes sb from real blobs to noise peaks , systematically reducing the observed sb of blobs independent of their snr @xcite .",
    "the effect is more pronounced for observations with poor fourier - plane coverage . given the degree of clean bias present in the sb image , @xmath146 ( @xmath147 jy beam@xmath40 )",
    ", blobcat makes the following correction , @xmath148    _ column 33 : _",
    "s_p_cbbws + peak sb corrected for peak bias , clean bias and bandwidth smearing , @xmath149 . using the input value of @xmath150 ( equation  ( [ eqn : bwsval ] ) ) , blobcat corrects for bandwidth smearing with @xmath151 this is the final reported value of the blob s peak sb , to be used for post - processing .",
    "_ column 34 : _",
    "s_p_cbbws_err + error in corrected peak sb , which we define as @xmath152^\\frac{1}{2 } \\ ; ,      \\end{aligned}\\ ] ] where @xmath153 is the absolute calibration error of the sb image and @xmath154 is the pixellation uncertainty ( see appendices a and b ) .",
    "the suitability of this error in linear polarization is discussed in   [ sec : ppol ] .",
    "_ column 35 : _",
    "s_int_obs + observed ( raw ) integrated sb , @xmath45 .    _ column 36 : _",
    "s_int_obscb + observed integrated sb corrected for clean bias , given by @xmath155 this value may be useful for non - gaussian blobs ( see   [ sec : pcs ] ) .    _",
    "column 37 : _ s_int + integrated sb , @xmath98 , calculated by application of blob volume correction ( equation  ( [ eqn : intcorr ] ) ) to @xmath45 .",
    "_ column 38 : _ s_int_cb + integrated sb corrected for clean bias , @xmath156 , calculated by application of blob volume correction ( equation  ( [ eqn : intcorr ] ) ) to @xmath157 .",
    "this is the final reported value of the blob s integrated sb , to be used for post - processing ( though see comments in ",
    "[ sec : pcs ] ) .",
    "_ column 39 : _",
    "s_int_cb_err + error in corrected integrated sb , which we define in a similar manner to s_p_cbbws_err ( see also   [ sec : pi ] ) as @xmath158 the suitability of this error in linear polarization is discussed in   [ sec : ppol ] .",
    "_ column 40 : _",
    "r_est + size estimate of detected blob , @xmath159 , in units of the sky area covered by an unresolved gaussian blob with the same peak sb , taking into account local bandwidth smearing . to derive this estimate",
    "we first focus on an unresolved gaussian blob with fwhm @xmath160 , as defined by the image resolution , and peak sb @xmath32 , as measured from the detected blob . for this unresolved blob , the relationship between its full width at a fraction @xmath161 of its peak sb , which we denote @xmath162 , and its fwhm is given by @xmath163 to calculate @xmath159 we take the ratio between the measured area of the detected blob , @xmath164 , and the area of an ellipse with axes defined by equation  ( [ eqn : rest1 ] ) .",
    "when the broadening effect of bandwidth smearing is included into this ratio , we get @xmath165 the parameter @xmath159 is not intended to be used for quantitative analysis . in   [ sec : pp ] we discuss how @xmath159 may be used to flag blobs that exhibit potentially complex ( non - gaussian ) morphologies for follow - up .    _ column 41 : _",
    "visarea + blobcat can optionally calculate the fraction of visible sky area , namely the fraction of non - blank pixels assuming use of an equal - area projection , over which a blob detected at position @xmath58 could have been detected within the sb image .",
    "this is known as the blob s visibility area .",
    "this area may be used , for example , to calculate a completeness correction when compiling source counts ( e.g. hales et al .",
    ", in preparation ) .",
    "to calculate the visibility area , blobcat takes into account spatial variations in both image sensitivity and bandwidth smearing . for non - blank pixels @xmath6 ,",
    "the fraction of suitable sky area for detecting a blob with equal peak sb to that of a blob located at @xmath58 , where @xmath166 , @xmath167 , is obtained by counting the number of pixels that satisfy @xmath168      to aid visual inspection and post - processing of blobs , blobcat can optionally produce two additional forms of output .",
    "the first is a modified sb fits image in which all flooded pixels have been highlighted ( reset to a large value ; this value may be user - specified , see appendix b ) .",
    "the second is an image overlay in ds9 @xcite or karma @xcite formats , for use with their respective ds9 or kvis fits viewers .",
    "the overlays present the identification number and boundaries in ra and dec for each blob . to illustrate these two optional forms of output , an example output fits image superposed with a kvis overlay is presented in fig .",
    "[ fig : figkvis ] .        blobcat may be easily modified to produce overlays in other suitable formats , for example through use of the pywcs wrapper to wcslib .",
    "we have carried out monte carlo simulations to investigate the performance of blobcat in total intensity and linear polarization , as described in the following sections .",
    "we tested blobcat in total intensity by injecting gaussian sources with peak snrs between @xmath169 into images of gaussian noise , inspecting the accuracy of the recovered sb and positional measurements .",
    "to compare blobcat s flood fill approach with that of standard gaussian fitting , we also carried out these simulations using imfit , a widely used gaussian source fitter from the miriad package @xcite .",
    "gaussian fitting routines such as imfit have been used by many surveys such as nvss @xcite , phoenix @xcite , and summs @xcite .",
    "two classes of source were tested , with the aim of demonstrating the virtues and limitations of blobcat s modified flood fill approach .",
    "the first were unresolved ( point ) sources , selected to demonstrate that flood fill algorithms need not be limited to the parameter space occupied by complex non - gaussian sources .",
    "the second were highly ( and somewhat pathologically ) resolved gaussian sources with fwhms 5 times larger than the image resolution , probing parameter space where parameterised gaussian fitting methods are optimal .",
    "we did not quantitatively address performance relating to non - gaussian sources because of the lack of an obvious standardised test source ; qualitative discussion of non - gaussian blobs is presented in ",
    "[ sec : pcs ] .",
    "we generated 125 independent samples per snr bin using noise images produced as follows . to realistically characterise the noise environment present in images of total intensity",
    ", we obtained stokes @xmath5 data from an individual pointing of the mosaicked 1.4  ghz aperture synthesis observations of @xcite .",
    "we imaged this stokes @xmath5 data using @xmath170 pixels , and convolved to a final circular resolution with ( fwhm ) @xmath171 .",
    "we found this image to be free of sources and artefacts . using sextractor ( see   [ sec : hbwiirms ] ) , we modified this stokes @xmath5 image for use as a master noise image by enforcing zero mean and unit variance throughout sub - regions of size 150 independent resolution elements .",
    "the noise image for each sample was then produced by extracting a randomly positioned thumbnail image from the master noise image , from a pool of over @xmath172 choices .",
    "for each sample we measured the injected source s peak sb , integrated sb , and position using both blobcat and imfit .",
    "we executed imfit using unconstrained gaussian fit parameters , imitating a blind survey . for input point sources",
    ", we also executed imfit using a constrained fit , fixing the source size to the image resolution .",
    "we then compared the output values for these different methods with their true input values .",
    "to prevent source misidentification , we checked that each recovered source extended over its true input location .",
    "we describe the results of these monte carlo simulations for sb measurements in   [ sec : pisrsb ] and for positions in   [ sec : pisrpos ] .",
    "we performed our total intensity monte carlo simulations for a range of flooding thresholds ( @xmath36 ) and peak bias correction factors ( @xmath82 ) , setting the detection threshold ( @xmath35 ) as small as possible so as to limit the induction of sampling bias in the lowest snr bins . for reasons outlined in ",
    "[ sec : hbwbc1]@xmath173[sec : hbwbc2 ] , we found that optimal sb recovery was obtained using @xmath104 and @xmath97 .    in fig .",
    "[ fig : i ] we present the sb results of our simulations , where we have executed blobcat with the optimal @xmath36 and @xmath82 values from above , we have executed imfit with unconstrained gaussian fit parameters , and where we have used median statistics @xcite to robustly prevent noise outliers from biasing intrinsic source extractor properties .",
    "the results obtained from executing imfit with constrained point source fits , using the same simulation data as for the unconstrained fits , are presented in fig .  [",
    "fig : i2 ] .    to put blobcat s performance in perspective , we first discuss the results from imfit , starting with the unconstrained fits from fig .",
    "[ fig : i ] .",
    "the strength of imfit is its ability to perform least squares fitting in order to separate smooth underlying 2d elliptical gaussians from superposed noise fluctuations .",
    "a key requirement of this process is that there are sufficient degrees of freedom ( dofs ) to fit the position , peak sb , major and minor axis , and position angle parameters .",
    "given that the number of dofs is related to the number of independent resolution elements within the fitting region , it is to be expected that imfit will struggle to constrain multiple fit parameters for point - like input sources .",
    "this is reflected in the imfit results from fig .",
    "[ fig : i ] , where the systematic bias in integrated sb measurements for point sources ( top - right panel ; @xmath17415% at @xmath80 ) demonstrates imfit s inability to simultaneously constrain peak sb and angular dimension parameters .",
    "for these point sources , which by definition have the dimensions of a single resolution element and therefore contain essentially one piece of information , namely their brightness , least squares fitting is easily coerced into including adjacent noise peaks into the fit . however , for resolved sources , which by definition extend over multiple independent resolution elements , least squares fitting becomes less likely to misinterpret noise features as true signal , and so becomes more accurate .",
    "the systematic positive bias exhibited by imfit in its measurements of integrated sb for point sources leads to two systematic effects .",
    "first , given that the integrated to peak sb ratio is typically used to select which measure best characterises the flux density of a source ( e.g. * ? ? ?",
    "* ) , the flux densities of faint sources will be systematically overestimated .",
    "second , this ratio is often used to estimate deconvolved angular source sizes ( e.g. * ? ? ?",
    "* ) , which too will become positively biased for faint sources .",
    "we comment on this ratio further in ",
    "[ sec : ppbfd ] .",
    "we now turn to imfit s performance from fig .",
    "[ fig : i2 ] . when there is prior knowledge that a source is unresolved , imfit can be constrained to fit a point source , fixing its fitted dimensions to those of the image resolution .",
    "comparing the results from fig .",
    "[ fig : i ] with those of fig .",
    "[ fig : i2 ] , we find that the point source assumption reduces imfit s integrated sb bias , but does not completely eliminate it .",
    "left behind is a marginal positive bias at low input snr , caused by imfit s residual - minimisation strategy to pull fitted sources towards noise peaks that are directly adjacent to true source peaks .",
    "we comment further on measured positions in   [ sec : pisrpos ] .",
    "returning to the blobcat results from fig .",
    "[ fig : i ] , we find that the recovered peak and integrated sb measurements for point sources are systematically unbiased . this performance enhancement over imfit is due to the reduced influence that nearby noise features can exert over blobcat s integrated sb measurements .",
    "only directly connected noise features can affect flood fill , when the algorithm spills into adjacent noise peaks and is eventually limited by @xmath36 , whereas strong noise peaks separated by a noise trough from the true source may be least square minimised by imfit as statistical fluctuations superposed on a resolved source .    for the resolved source investigated",
    ", imfit clearly outperforms blobcat in avoiding integrated sb systematics",
    ". however , blobcat s systematic underestimate is no worse than @xmath175 , even for sources with peak @xmath176 .",
    "as indicated in fig .",
    "[ fig : i ] , this underestimate would be more severe if the peak bias correction from equation  ( [ eqn : maxmfit ] ) were neglected ; failure to debias the peak sb causes equation  ( [ eqn : intcorr ] ) to underestimate the integrated sb .",
    "we attribute blobcat s difficulty in collecting the full integrated sb for resolved sources to an analogous ` negative ' version of our peak sb correction .",
    "as sources become more resolved , it becomes more likely that negative noise features may limit the spatial extent available for the flood fill algorithm to explore .",
    "this behaviour is not completely offset by positive noise features contributing to the spatial extent of sources , and so a bias is produced . given",
    "how mild the resulting bias is , even for the pathologically resolved source tested , we do not attempt to correct for it within blobcat .    to estimate the uncertainty in blobcat s measurements of peak and integrated sb , we use equations  ( [ eqn : sperr ] ) and ( [ eqn : sierr ] ) .",
    "these errors are indicated by dotted lines in fig .  [",
    "fig : i ] ; we neglect the absolute calibration error ( @xmath153 ) , and set the pixellation error ( @xmath154 ) to 0.5% ( cf .",
    "appendix a ) .",
    "we do not reduce the factor of @xmath11 in equation  ( [ eqn : sierr ] ) by , for example , the square root of the number of independent resolution elements within the spatial extent of the source , as might be appropriate for methods that produce systematically unbiased integrated sb measurements .",
    "instead , we define equation  ( [ eqn : sierr ] ) in a similar manner to equation  ( [ eqn : sperr ] ) , so as to artificially account for blobcat s systematic underestimate of integrated sb for resolved sources . in this way",
    ", the error estimates produced by blobcat realistically encapsulate its true performance .",
    "note that in practice , resolved sources will almost always be less resolved than for our simulated resolved source here .",
    "this implies that our catalogue error estimates are unlikely to underestimate true sb measurement errors .",
    "blobcat catalogues three positions for each detected blob : the raw peak pixel , an area centroid using equation  ( [ eqn : poscent ] ) , and a snr - weighted centroid using equation  ( [ eqn : poswcent ] ) . in fig .",
    "[ fig : ipos ] we compare the accuracy of these measurements , as well position measurements from imfit , in recovering the true input positions for our simulated unresolved and resolved sources .",
    "[ fig : ipos ] indicates that of blobcat s three position measurements , the weighted centroid is optimal for both unresolved and resolved gaussian sources .",
    "the superior performance of the peak pixel position for unresolved sources is an artefact of injecting sources centred on a pixel ; in general the performance of this position measure will be poorer . for resolved sources , the raw peak position is easily corrupted by the peak bias effect described earlier in   [ sec : hbwbc1 ] . for both unresolved and resolved gaussian sources , the area centroid exhibits limited accuracy due to its lack of pixel weighting .    for faint unresolved sources , blobcat s positions are more accurate than those of imfit s unconstrained gaussian fits ;",
    "imfit is limited in its accuracy due to its optimisation attempts to accommodate adjacent noise features through least squares minimisation .",
    "for the pathologically resolved source simulated , imfit s position measurements are more accurate than blobcat s .",
    "to estimate the uncertainty in blobcat s weighted centroid positions , we first look to an uncertainty estimate for imfit . for plotting purposes , the median positional offset exhibited by imfit can be estimated as the median of the quadrature sum of two zero - mean signals representing ra and dec measurements with error @xmath177 ( equation  ( [ eqn : raerr ] ) ) and @xmath178 ( equation  ( [ eqn : decerr ] ) ) , respectively . by using a factor of @xmath179 instead of @xmath180 in equations  ( [ eqn : posfiterrra ] ) and ( [ eqn : posfiterrdec ] ) as suggested for gaussian fitting by @xcite , neglecting calibration and frame errors , using @xmath181 for a circular beam , and noting that the median offset about an input position in 2d is given by the median of a @xcite distribution",
    ", we evaluate the expected median positional offset for imfit as @xmath182 this estimate is indicated by the dotted curve in each panel of fig .",
    "[ fig : ipos ] .",
    "equation  ( [ eqn : posfiterrplot ] ) suitably encapsulates the positional uncertainties exhibited by both imfit and blobcat for unresolved sources .",
    "however , for our heavily resolved source , it systematically underestimates the positional uncertainties exhibited by both the gaussian fit and flood fill approaches . to avoid complexity",
    "we do not attempt to explicitly parameterise the increased positional uncertainty displayed for resolved sources .",
    "instead , we have chosen to simply modify the positional uncertainty equations presented by @xcite to use a factor of @xmath180 ( instead of @xmath183 ) , as presented in equations  ( [ eqn : posfiterrra ] ) and ( [ eqn : posfiterrdec ] ) . these modified equations lead to a more appropriate estimate for the median positional offset , @xmath184 as indicated by the dot - dashed curve in each panel of fig .",
    "[ fig : ipos ] .",
    "the factor of @xmath180 was selected empirically to ensure that for gaussian sources with sizes ranging from unresolved to the heavily resolved source tested , positional uncertainties may be systematically estimated to within @xmath185 of a beam fwhm .",
    "we note that the factor of @xmath180 is also suitable for use with imfit ( see left panels in fig .  [",
    "fig : ipos ] ) .",
    "we tested blobcat in linear polarization , @xmath4 , in a similar manner to that described in ",
    "[ sec : piss ] for total intensity .",
    "we tested the same two classes of source , sampling input peak snrs between @xmath186 ( cf .",
    "equation  ( [ eqn : sigrm ] ) ; also ",
    "[ sec : hbwbc2 ] ) . for comparison",
    ", we also tested the performance of imfit using both constrained and unconstrained gaussian fit parameters .",
    "we generated each of the 125 sample images per snr bin as follows .",
    "we assumed an illustrative observational band centred on 1396  mhz with width 200  mhz , split into @xmath187  mhz channels .",
    "for each frequency channel we obtained two independent noise thumbnails from the master noise image ( cf .",
    "  [ sec : piss ] ) , which we used to represent stokes @xmath1 and @xmath2 noise .",
    "a point ( or resolved ) source with a rm of @xmath188  rad  m@xmath189 , unresolved in faraday space , was then suitably injected into each of the stokes @xmath1 and @xmath2 images across the band .",
    "we define the peak snr of these injected sources as the ratio between their true input peak polarized sb and @xmath23 .",
    "using rm synthesis and rmclean , images of @xmath4 were then produced in accordance with equation  ( [ eqn : makelrm ] ) .",
    "for each sample we then recovered the peak and integrated sb using both blobcat and imfit .",
    "we describe the results of these monte carlo simulations for sb measurements in   [ sec : plsrsb ] and for positions in   [ sec : plsrpos ] .",
    "we performed our linear polarization monte carlo simulations using a range of @xmath35 , @xmath36 , and @xmath82 parameter values , finding that the optimal total intensity value of @xmath97 was suitable for use in polarization as well .",
    "this behaviour of @xmath82 can be understood by comparing profiles through sources embedded within images of total intensity and @xmath4 , as presented by @xcite .",
    "they show that above @xmath190 , gaussian sources embedded within these two environments are very similar in morphology , modulo statistical fluctuations . for this reason , the relevant cross - sectional area for the peak bias correction , @xmath84 in equation  ( [ eqn : m ] ) ,",
    "may be obtained for images of @xmath4 using the same value of @xmath82 as was recommended for total intensity . using this value",
    ", we found that integrated sb recovery was optimised when flooding down to @xmath107 , as discussed earlier in ",
    "[ sec : hbwbc2 ] .    in fig .",
    "[ fig : l ] we present the results of our simulations , where we have executed imfit using unconstrained gaussian fit parameters with a @xmath191 cut - off fitting threshold ( same as @xmath36 ) .",
    "the results obtained from the same simulations by executing imfit with constrained point source fits are presented in fig .",
    "[ fig : l2 ] .    the strong systematic biases exhibited by imfit in fig .",
    "[ fig : l ] suggest that its unconstrained fits are unsuited to the statistical environment of @xmath4 .",
    "we attribute this to a breakdown in the assumption that sources are superposed with gaussian noise fluctuations , as required to perform robust least squares minimisation . when imfit s angular size parameters are fixed to the image resolution ,",
    "the systematic biases in measured sb for input point sources are diminished , as shown in fig .",
    "[ fig : l2 ] . through further experimentation",
    ", we found that systematic imfit biases were unavoidable for all but the most manual , uniquely - constrained fits . reduction or removal of the @xmath191 cut - off threshold , used to prevent faint pixels from entering the gaussian fitting process , was found to worsen systematic trends .",
    "we found similar biases to those described above when using imfit in images of standard linear polarization , @xmath3 .",
    "in contrast , the results from fig .",
    "[ fig : l ] indicate that blobcat s measurements of peak and integrated sb are , in effect , systematically unbiased .",
    "we justify this claim as follows , beginning with peak sb performance .",
    "the small systematic positive bias exhibited by the recovered peak sb is due to the positive semi - definite nature of @xmath192 ; this effect , which is extrinsic to blobcat , is known as polarization bias .",
    "because of the intimate relationship that exists between polarization bias and the specifics of observational setup , as elucidated shortly , blobcat makes no attempt to correct for this bias . to illustrate the variety and complexity of schemes that may be applicable to different data",
    ", we note that corrections designed for @xmath3 ( see * ? ? ?",
    "* ) are not suitable for @xmath4 because they are governed by different statistical distributions @xcite .",
    "furthermore , no fixed ( unparameterised ) correction scheme . as their scheme implicitly assumes a specific observational setup , its applicable parameter space is limited . ]",
    "is suitable for @xmath4 , because the statistical properties of @xmath4 are dependent on the underlying observational characteristics of the data such as frequency coverage and channel width @xcite . instead , more computationally expensive schemes to correct for polarization bias , and potentially eddington bias ( which affects the measured sb of unresolved sources ; *",
    "* ) , may be required ( hales et al .",
    ", in preparation ) . to alleviate polarization bias in blobcat s measurements of peak sb , users must independently apply their own suitably selected correction scheme .",
    "blobcat appears to accurately recover measurements of integrated sb for unresolved sources , apart from a positive bias exhibited at low input snr .",
    "this latter behaviour is due to polarization bias , which affects sources whose pixel magnitudes are predominantly at low snr .",
    "however , this bias is not of significant consequence because , on average for these sources , their ratios of integrated to peak sb will not deviate significantly from @xmath193 . in these cases , their peak values will best represent their flux densities ( cf .",
    "  [ sec : pisrsb ] ; also   [ sec : ppbfd ] ) , which need only be corrected for polarization bias in order to deliver systematically unbiased measurements .    turning to blobcat s measurements of integrated sb for highly resolved sources",
    ", their unbiased nature appears to be due to the fortuitous cancellation of two systematic effects .",
    "the first of these is the negative bias for resolved sources , as seen earlier for total intensity ( lower - right panel of fig .",
    "[ fig : i ] ) .",
    "the second is the positive polarization bias discussed above .",
    "we conjecture that the cancellation of these two effects is robust , regardless of the observational setup dictating the specific statistical description displayed by the input @xmath4 ( or @xmath3 ) image .",
    "our justification for this assertion is that the dominant statistical differences between images of @xmath4 for different observational setups , or between images of @xmath4 and @xmath3 , occur below a threshold of @xmath191 @xcite . given that blobcat ignores data below this cut - off threshold ( for our recommended @xmath107 ) , we are confident that any systematic blob - extraction differences between these images will be below the noise level .",
    "regarding sb measurement uncertainties , we mirror the earlier discussion of total intensity uncertainties from   [ sec : pisrsb ] .",
    "we note that equations  ( [ eqn : sperr ] ) and ( [ eqn : sierr ] ) suitably reflect blobcat s measurement errors in linear polarization , as exhibited by the dotted lines in fig .",
    "[ fig : l ] .",
    "we therefore leave these equations unchanged for use in linear polarization analysis .      in fig .",
    "[ fig : lpos ] we compare the accuracy of position measurements using both blobcat and imfit in recovering the true input positions for our simulated unresolved and resolved sources .    as with sb measurements (   [ sec : plsrsb ] ) , we find that unconstrained gaussian fitting is not appropriate for determining source positions in linear polarization . following from the discussion for positional measurements in total intensity (   [ sec : pisrpos ] )",
    ", we note that blobcat s weighted centroid positions are also suitable for use in linear polarization , as are the uncertainty estimates using equations  ( [ eqn : posfiterrra ] ) and ( [ eqn : posfiterrdec ] ) .",
    "in this section we qualitatively discuss blobcat s performance when analysing blobs that exhibit complex ( resolved , non - gaussian ) morphology .",
    "we do not seek to quantitatively address this performance due to the lack of clear standardised test sources .",
    "possible examples of complex blobs include supernova remnant shells , extended lobes of radio galaxies , radio relics , and extended galactic emission ; we discuss how these blobs may be automatically identified and flagged for follow - up using blobcat in   [ sec : pp ] .",
    "other examples include blended blobs that consist of multiple overlapped individual gaussians ; we discuss these in   [ sec : ppbd ] .    for each detected blob",
    ", blobcat assumes 2d elliptical gaussian morphology (   [ sec : hbwbm ] ) so as to infer a debiased peak sb and a corrected integrated sb (   [ sec : hbwbc ] ) .",
    "if a detected blob is not of true gaussian morphology , then its debiased peak sb is unlikely to be significantly affected .",
    "this is because use of @xmath97 in calculating the relevant cross - sectional area susceptible to peak bias ( using equation  ( [ eqn : maxmfit ] ) ) is still likely to be a suitable choice for non - gaussian blobs .",
    "it is more difficult to generalise the systematic manner in which measurements of corrected integrated sb may differ from their true values .",
    "the simplest observation is that low snr blobs are more vulnerable than high snr blobs to systematic error in their measurements of corrected integrated sb ( cf .",
    "equation  ( [ eqn : intcorr ] ) ) .",
    "however , the fraction of blob volume remaining unflooded below @xmath36 will be small for a low snr blob that is highly - resolved , suggesting that in general , uncorrected integrated sb measurements will be more accurate than corrected integrated sb measurements in estimating flux densities for a majority of complex blobs .",
    "we have verified the general statements above by testing blobcat s performance in handling sources with a range of complex morphologies .",
    "we find that blobcat s performance for slightly extended non - gaussian blobs that consist of blended gaussian components , where the approximation of 2d elliptical gaussian morphology is poor , is in general poorer than the simulation results presented earlier for pathologically resolved gaussian blobs .",
    "however , alternatives for handling such blobs more suitably in post - processing are available , as discussed in ",
    "[ sec : ppbd ] . for highly extended non - gaussian blobs ,",
    "blobcat s measurements of uncorrected integrated sb are in general quite accurate because the fraction of unflooded blob volume is always very small .    in fig .",
    "[ fig : c ] we present two sample non - gaussian blobs in an attempt to illustrate their potential for integrated sb error .",
    "users should judge for themselves whether corrected ( @xmath98 ) or uncorrected ( @xmath45 ) measurements of integrated sb best describe the flux densities of their complex blobs ; to assist with this decision , blobcat reports both values in its output catalogue . if the two values differ by more than a few percent , then the corrected values may be unsuitable , and manual inspection is recommended .",
    "similarly , users should determine which blobcat position measurement is most appropriate for each of their complex blobs ; the snr - weighted centroid may be inappropriate for some blobs .",
    "for example , the weighted centroid position for an arc - shaped radio relic ( i.e. a crescent moon shape ) may be situated beyond the boundaries of its flooded pixels ; the raw peak pixel or area ( unweighted ) centroid position may be more appropriate . to aid users , blobcat catalogues all three position measurements .",
    "in addition , flags are produced ( see   [ sec : hbwpout ] ) so as to indicate whether the centroid positions are situated within or exterior to the flooded pixel confines of each blob .",
    "blobcat is designed to produce an output catalogue that details basic properties of blobs in an image .",
    "depending on the nature of the data and the requirements of the user , additional processing may be required to make full use of the catalogue .    in this section",
    "we highlight two such examples of post - processing .",
    "we first consider a selection procedure for determining which sb measurement ( peak or integrated ) best describes the flux density of a blob .",
    "we then consider a procedure for identifying and analysing blobs that exhibit non - gaussian morphologies .      the choice of whether to represent a blob s flux density by its measured peak or integrated sb is equivalent to asking whether the blob is unresolved or not .",
    "if it is unresolved then the peak sb should be used ( explained as follows ; note also appendix  a ) , while for resolved blobs it is the integrated sb that should be used .    the user is responsible for selecting which of the measurements of peak or integrated sb best represent the true flux density for each detected blob .",
    "we do not automate this process for the same reason that gaussian fitting tasks such as imfit do not , namely that noise features adjacent to faint , unresolved sources may render integrated sb measurements less likely to represent true flux densities than peak sb measurements .",
    "if a user is only interested in a small number of blobs , then as with imfit , more attention can be paid to each individual fit so as to minimise potential fitting errors , for example through fitting constraints in imfit or perhaps suitable pixel masking prior to running blobcat . for such carefully fitted blobs ,",
    "their integrated sb measurements may be used to represent their true flux densities , even if they are faint or unresolved . however , for large sample sizes ( e.g. for a survey ) , it is impractical to consider implementation of such manual , or perhaps even machine - learning enabled , fitting procedures . indeed , attempting to manually fit each source in a survey",
    "may inadvertently bias the resulting flux density measurements due to subjectivity on behalf of the user .",
    "instead , a more appropriate strategy may be initiated by taking the ratio between integrated to peak sb measurements for each blob , so as to characterise the global variance in this ratio as a function of measured snr . by considering the parameter space populated by noise - affected blobs with @xmath194 , an envelope can be designed as a function of snr to select which of the blobs with @xmath195 are likely to be similarly affected by noise . only those blobs with ratios in excess of the envelope criterion may be deemed resolved , and in turn have their flux densities represented by their integrated sb measurements .",
    "all other blobs should have their flux densities represented by their peak sb measurements .",
    "this strategy has been employed for imfit - based surveys of total intensity , e.g. @xcite ; application to total intensity and linear polarization surveys with blobcat will be presented by hales et al .",
    "( in preparation ) .",
    "if a blob is resolved , then an estimate of its deconvolved size may be obtained directly from its integrated to peak sb ratio ( via division of equation  ( [ eqn : gvol ] ) by equation  ( [ eqn : beamvol ] ) ) , namely @xmath196 where the deconvolved angular size can be estimated using the geometric mean as @xmath197 .",
    "again , illustrations of this procedure are available in total intensity using imfit @xcite , and will be presented for total intensity and linear polarization with blobcat by hales et al .",
    "( in preparation ) .",
    "blobcat assumes that isolated blobs are of gaussian morphology in order to catalogue their properties .",
    "this assumption will work well for images that are sparsely populated ( i.e. not confusion limited ) with gaussian sources .",
    "however , if complex blobs are present ( cf .",
    "  [ sec : pcs ] ) this assumption may not always be suitable , requiring additional processing of the complex objects so as to suitably characterise their properties . before commenting on this processing",
    ", we briefly outline a simple procedure by which complex blobs may be first identified .    in equation  ( [ eqn : rest2 ] ) we defined the parameter @xmath159 , which estimates the size of a detected blob in units of the sky area covered by an unresolved gaussian blob with the same peak",
    "if @xmath159 is large , it indicates that a blob is unlikely to be unresolved .    to illustrate how this parameter may be used to identify potentially complex blobs for follow - up",
    ", we preview the general processing steps performed by hales et al .",
    "( in preparation ) to catalogue sources in radio - wavelength images of total intensity and linear polarization ; details of these images are not pertinent to the discussion here , apart from noting that they consist mostly of compact sources ( i.e. there are no wide - spread extended image features ) .",
    "hales et al .",
    "( in preparation ) find that a value of @xmath198 is well - suited for automatically flagging complex blobs .",
    "gaussian fits are attempted for each of these flagged complex blobs with imfit to determine which ones are likely to consist of single or multiple overlapped ( blended ) gaussians .",
    "this procedure is semi - automated to require only two initial manual inputs to imfit : the number of potentially overlapped gaussians , and their cursory positions .",
    "we note here that standard digital imaging techniques such as the laplacian of gaussian operation ( e.g. * ? ? ?",
    "* ) which is implemented within the aegean algorithm @xcite , blob decomposition algorithms such as clumpfind @xcite , or the widely used watershed transform @xcite , may be well suited to performing this step automatically .",
    "hales et al .",
    "( in preparation ) preserve the original blobcat measurements for those blobs that are best fit by a single gaussian . for each blob",
    "identified as being blended , they replace its original blobcat catalogue entry with multiple imfit entries for each individual gaussian component identified .",
    "remaining from this procedure are a small number of extended , non - gausssian blobs that can not be adequately refit using imfit ( as identified due to their large fitting residuals ; we note here that image artefacts may also be included in this list , though too many artefacts could indicate undervaluation of rms noise estimates ) . for each of these remaining blobs , hales et al .",
    "( in preparation ) preserve the original blobcat measurements and perform a final manual inspection to determine which of the integrated sb measurements should be used to represent the blob s flux density ( uncorrected or corrected ;   [ sec : pcs ] ) .",
    "we envisage that the above procedure may be quickly and easily replicated for future surveys . by performing gaussian fitting for only those blobs that blobcat indicates may be complex , it should be possible to robustly and automatically catalogue all but the most non - gaussian of sources in an image .",
    "we have described blobcat , an algorithm designed to identify and catalogue blobs in a 2d fits image of stokes @xmath0 intensity or linear polarization ( @xmath3 or @xmath4 ) .",
    "utilising a gaussian morphology assumption and two key bias corrections , blobcat equips its core flood fill algorithm with the tools necessary to perform robust sb measurement .    written in python , blobcat is easy to use and easy to modify .",
    "it is well - suited to analysis of large blind surveys , requiring little manual intervention for images sparsely populated with unresolved and resolved gaussian sources , and having the ability to account for spatial variations in both image sensitivity and bandwidth smearing . to indicate blobcat s ability to swiftly analyse data",
    ", we note that hales et al .",
    "( in preparation ) produce a catalogue of @xmath199 blobs from an image with @xmath200 pixels , including the use of equal - sized rms and bandwidth smearing images , in less than 60 seconds on a standard desktop computer . while source extractors built around gaussian fitting routines are competitive with blobcat in this raw computing time , though such comparison is implementation - dependent",
    ", subsequent overheads associated with manual source inspection may be greatly minimised when using the latter .",
    "this is because unresolved and resolved gaussian blobs are automatically and accurately processed by blobcat , requiring only non - gaussian blobs to be manually addressed .",
    "accurate estimates of background rms noise are required to ensure robust and accurate operation of blobcat .",
    "we described a simple , objective , and automated procedure by which these estimates may be obtained , which makes use of local background mesh calculations .",
    "we note that this procedure may be used to estimate background rms noise for use with any source extractor , not just blobcat .",
    "we have demonstrated the performance of blobcat through monte carlo simulations of unresolved and resolved gaussian sources .",
    "we benchmarked this performance against that of standard gaussian fitting , finding comparable results in total intensity , and vastly superior results in linear polarization .",
    "our simulations indicate that gaussian fitting is inappropriate for use in linear polarization for all but the most manually - constrained of fits .",
    "blobcat contains at present the only algorithm capable of robustly cataloguing accurate flux densities for resolved or extended sources in linear polarization , without incurring significant systematic biases .    in closing",
    ", we note that blobcat may be suitable for cautious application to image data at non - radio wavelengths , such as optical , provided that the flooding snr cutoff is set to a value high enough to avoid measurement systematics induced by low - snr statistics . optical pixel shot noise ( the poisson regime )",
    "is non - gaussian at low - snr and limits to gaussianity at higher snr , much like the statistics of linear polarization that can be accommodated by blobcat .",
    "modification of blobcat s algorithms may be required to account for wavelength- and instrument - specific descriptions of point spread functions and pixellation errors .",
    "the blobcat program , supplemented with test data to illustrate its use , is available electronically through the world wide web at : http://blobcat.sourceforge.net/  .",
    "we thank the following for helpful discussions and feedback : tim cornwell , mark calabretta , andrew hopkins , elizabeth mahony , paul hancock , greg madsen , and jay banyer .",
    "we thank the anonymous referee for helpful comments that led to the improvement of this paper . c.  a.",
    "h. acknowledges the support of an australian postgraduate award and a csiro oce scholarship .",
    "the centre for all - sky astrophysics is an australian research council centre of excellence , funded by grant ce11e0090 .",
    "99    bertin e. , arnouts s. , 1996 , a&as , 117 , 393    bondi m. , et al . , 2003 , a&a , 403 , 857    brentjens m.  a. , de bruyn a.  g. , 2005 , a&a , 441 , 1217    bridle a.  h. , greisen e.  w. , 1994 , aips memo no .",
    "87 , nrao , charlottesville , va    bridle a.  h. , schwab f.  r. , 1999 , synthesis imaging in radio astronomy ii , 180 , 371    briggs d.  s. , cornwell t.  j. , 1992 , aspc , 25 , 170    briggs d.  s. , 1995 , phd thesis , the new mexico institute of mining and technology    calabretta m.  r. , greisen e.  w. , 2002 , a&a , 395 , 1077    condon j.  j. , 1997 , pasp , 109 , 166    condon j.  j. , cotton w.  d. , greisen e.  w. , yin q.  f. , perley r.  a. , taylor g.  b. , broderick j.  j. , 1998 , aj , 115 , 1693    cornwell t. , fomalont e.  b. , 1999 , synthesis imaging in radio astronomy ii , 180 , 187    david h.  a. , nagaraja h.  n. , 2003 , order statistics ( 3rd ed . ) .",
    "john wiley & sons , nj    deboer d.  r. , et al .",
    ", 2009 , ieee proceedings , 97 , 1507    eddington a.  s. , 1913 , mnras , 73 , 359    ellingson s.  w. , clarke t.  e. , cohen a. , craig j. , kassim n.  e. , pihlstrom y. , rickard l.  j. , taylor , g.  b. , 2009 , ieee proceedings , 97 , 1421    fishkin k.  p. , barsky b.  a. , 1985 , in magnenat - thalmann n. , thalmann d. , ed .",
    "graphics interface 85 .",
    "springer - verlag , tokyo , p. 56",
    "fruchter a.  s. , hook r.  n. , 2002 , pasp , 114 , 144    gaensler b.  m. , landecker t.  l. , taylor a.  r. , possum collaboration , 2010 , baas , 42 , 515    george s.  j. , stil j.  m. , keller b.  w. , 2011 , pasa , in press ( arxiv:1106.5362 )    gooch r. , 1996 , astronomical data analysis software and systems v , 101 , 80    grant j.  k. , taylor a.  r. , stil j.  m. , landecker t.  l. , kothes r. , ransom r.  r. , scott d. , 2010 , apj , 714 , 1689    greisen e.  w. , 1983 , aips memo no .",
    "27 , nrao , charlottesville , va    hales c.  a. , gaensler b.  m. , chatterjee s. , van der swaluw e. , camilo f. , 2009 , apj , 706 , 1316    hales c.  a. , gaensler b.  m. , norris r.  p. , middelberg e. , 2012 , mnras , in press    hancock p.  j. , murphy t. , gaensler b.  m. , hopkins a. , curran j.  r. , 2012 , mnras , 422 , 1812    heald g. , braun r. , edmonds r. , 2009 , a&a , 503 , 409    hills r.  e. , kurz r.  j. , peck a.  b. , 2010 , proc .",
    "spie , 7733 , 773317    holwerda b.  w. , 2005 , arxiv : astro - ph/0512139    hopkins a.  m. , afonso j. , chan b. , cram l.  e. , georgakakis a. , mobasher b. , 2003 , aj , 125 , 465    huynh m.  t. , jackson c.  a. , norris r.  p. , prandoni , i. , 2005 , aj , 130 , 1373    ibar e. , ivison r.  j. , biggs a.  d. , lal d.  v. , best p.  n. , green d.  a. , 2009 , mnras , 397 , 281    johnson n.  l. , kotz s. , 1970 , distributions in statistics : continuous univariate distributions@xmath1731 .",
    "houghton mifflin , ny    johnston s. , et al .",
    ", 2008 , experimental astronomy , 22 , 151    jonas j.  l. , 2009 , ieee proceedings , 97 , 1522    joye w.  a. , mandel e. , 2003 , astronomical data analysis software and systems xii , 295 , 489    leahy p. , fernini i. , 1989 , vla scientific memorandum no . 161 , nrao    lieberman h. , 1978 , in siggraph 78 proceedings .",
    "acm , new york , p. 111",
    "mauch t. , murphy t. , buttery h.  j. , et al .",
    ", 2003 , mnras , 342 , 1117    murphy t. , mauch t. , green a. , hunstead r.  w. , piestrzynska b. , kels a.  p. , sztajer p. , 2007 ,",
    "mnras , 382 , 382    norris r.  p. , et al . , 2006 , aj , 132 , 2409    norris r.  p. , et al . , 2011 , pasa , 28 , 215    oosterloo t. , verheijen m.  a.  w. , van cappellen w. , bakker l. , heald g. , ivashina m. , 2009 , pos(skads2009 ) , 070    oppermann n. , robbers g. , ensslin t.  a. , 2011 , arxiv:1107.2384    osullivan s. , stil j. , taylor a.  r. , ricci r. , grant j.  k. , shorten k. , 2008 , in pos , proc .",
    "vlbi network symp .",
    "for radio astron .",
    ", p. 107",
    "pach j. , agarwal p.  k. , 1995 , combinatorial geometry .",
    "john wiley & sons , ny    pence w.  d. , chiappetti l. , page c.  g. , shaw r.  a. , stobie e. , 2010 , a&a , 524 , a42    perley r.  a. , chandler c.  j. , butler b.  j. , wrobel j.  m. , 2011 , apjl , 739 , l1    rayleigh j.  w.  s. , 1880 , philosophical magazine , 5th series , 10 , 73    roerdink j.  b.  t.  m. , meijster a. , 2000 , fundamenta informaticae , 41 , 187    rottgering h. , et al . , 2010 , pos(iskaf2010 ) , 050    rudnick l. , 2002 , pasp , 114 , 427    rudnick l. , brown s. , 2009 , aj , 137 , 145    sault r.  j. , teuben p.  j. , wright m.  c.  h. , 1995 , astronomical data analysis software and systems iv , 77 , 433    shi h. , liang h. , han j.  l. , hunstead r.  w. , 2010 , mnras , 409 , 821    sonka m. , hlavac v. , boyle r. , 2008 , image processing , analysis , and machine vision ( 3rd ed . ) .",
    "thompson learning , toronto    subrahmanyan r. , ekers r.  d. , saripalli l. , sadler e.  m. , 2010 , mnras , 402 , 2792    taylor a.  r. , salter c.  j. , 2010 , in kothes r. , landecker t. l. , willis a. g. , eds , asp conf .",
    "438 , the dynamic interstellar medium : a celebration of the canadian galactic plane survey .",
    ", san francisco , p. 402",
    "taylor a.  r. , et al .",
    ", 2007 , apj , 666 , 201    tukey j.  w. , 1977 , exploratory data analysis .",
    "addison - wesley , reading , ma    vaillancourt j.  e. , 2006 , pasp , 118 , 1340    williams j.  p. , de geus e.  j. , blitz l. , 1994 , apj , 428 , 693 ; see also http://www.ifa.hawaii.edu/users/jpw/clumpfind.shtml    wootten a. , thompson a.  r. , 2009 , ieee proceedings , 97 , 1463",
    "in radio synthesis imaging , the number of pixels per resolution element ( synthesised beam ) can be adjusted after the original observations have been made .",
    "this is because raw data are obtained in the fourier plane , enabling post facto over - sampling of data in the image plane . by comparison , optical observations are",
    "often under - sampled in the image plane , requiring ingenious methods to utilise their full resolution ( e.g. the drizzle algorithm by * ? ? ?",
    "* ) .    in this appendix we present implications for sb measurements when sampling a radio image with insufficient pixels .",
    "we use the term ` pixellation error ' to refer specifically to the systematic undervaluation of peak sb measurements due to imaging and fitting effects .",
    "we focus on the pixellation error exhibited by two methods of peak sb measurement for unresolved sources .",
    "we first derive a relationship for the pixellation error exhibited by measurements of observed ( raw ) peak sb .",
    "we then compare this peak pixel error to that exhibited by the fitted peak of a 2d parabola , where the fit is obtained using a @xmath42 pixel array about the raw peak pixel ( e.g. as implemented in the miriad task maxfit ) .",
    "we conclude by commenting on the manner in which image pixellation affects measurements of integrated sb .    in conventional radio synthesis imaging , the sky is assumed to be represented by delta functions ; each image pixel is thus a spot sample , as opposed to other sky representations such as piecewise - constant pixels , which require integrals over regions to be computed . to represent the visibility data ,",
    "sources in images deconvolved using the iterative clean algorithm will be of the form @xcite @xmath201(x , y ) \\;,\\ ] ] where @xmath202 is the observed source sb distribution at pixel coordinate @xmath6 , the asterisks indicate convolution , @xmath203 is a basis function that depends on whether the source is centred directly on a pixel or not , @xmath204 represents the clean component model of the source , and @xmath205 is the restoring beam .",
    "we assume that @xmath205 is gaussian .",
    "we define @xmath206 as the fraction of true peak sb observed within the peak pixel of an unresolved source .",
    "we assume @xmath49 and @xmath50 pixels per projected resolution element such that a pixel dimension is @xmath207 ; here , @xmath208 and @xmath209 are the major and minor fwhms that characterise the image resolution ( see introductory remark in   [ sec : hbwbm ] ) , as projected along the ra and dec axes of an image ( see equations  ( [ eqn : presa ] ) and ( [ eqn : presd ] ) ) .    when the true peak for an unresolved 2d elliptical gaussian is centred directly on a pixel , which we denote the ` on - pixel ' case , both the @xmath203 and @xmath204 terms in equation  ( [ eqn : deconvform ] ) are given by delta functions .",
    "the source sb distribution is therefore described by an unattenuated 2d elliptical gaussian with @xmath210 , regardless of the values of @xmath49 and @xmath50 .",
    "when the true peak is centred half - way between pixel centres , which we denote the ` off - pixel ' case , @xmath204 is again a delta function ( representing a point source ) and @xmath205 is a gaussian , but now @xmath203 must consist of a sinc function in order to represent the visibility data for a shifted delta function .",
    "we find that @xmath211 is therefore given by @xmath212      \\bigg[\\frac{\\left(x_{1/2}-l\\right)^2}{n_\\alpha^2}+      \\nonumber \\\\      & & \\frac{\\left(y_{1/2}-m\\right)^2}{n_\\delta^2 }      \\bigg]\\!\\bigg\\ } \\ ; dl \\ , dm \\label{eqn : pixerroffpix}\\,,\\end{aligned}\\ ] ] evaluated at @xmath213 .    in fig .",
    "[ fig : figpix ] we display @xmath214 for the on- and off - pixel cases from above ; to conform with visual expectations , in the upper panel we plot 1d source profiles and their corresponding 1d pixel values by using a simplified 1d version of equation  ( [ eqn : pixerroffpix ] ) ( for which only one integral is required ) .",
    "when the underlying true peak for an unresolved source is centred ( in 2d ) part - way between the on- and off - pixel cases , @xmath214 is given by a value between these two solutions , as illustrated by the shading in the lower panel of fig .",
    "[ fig : figpix ] .",
    "we note that the effect of the sinc function in our off - pixel analysis is essentially negligible , only affecting the plotted curves closer to @xmath215 pixel per fwhm .",
    "nevertheless , we have included the calculation for completeness .    in principle",
    ", the pixellation error exhibited by measurements of observed peak sb ( @xmath214 ) may be minimised by imaging with a large number of pixels per resolution element .",
    "however , in practice , limited computing resources will often prevent the production or subsequent analysis of such heavily sampled images . rather than increasing the image sampling @xmath49 and @xmath50 ,",
    "the accuracy of peak sb measurements may be increased by performing a fit to the peak value using a 2d parabola ; we denote these fitted peak measurements @xmath216 . to demonstrate this increased accuracy , in fig .",
    "[ fig : figpix ] we illustrate the pixellation error exhibited by 2d parabolic fitting , which we define as @xmath217 .",
    "we note that our @xmath218 and @xmath219 curves in fig .",
    "[ fig : figpix ] were obtained analytically ; for brevity we will not reproduce the straightforward derivation of @xmath216 here .",
    "this derivation involves evaluating raw pixel intensities from either spot samples from a 2d gaussian for the on - pixel case , or evaluating equation  ( [ eqn : pixerroffpix ] ) at different pixel positions for the off - pixel case , then performing least squares to solve for an overdetermined system of linear equations ( 6 unknown fit parameters and 9 constraining pixels ) .    both @xmath220 and @xmath216 exhibit pixellation error ; the latter measure of peak",
    "sb is more accurate . to limit pixellation error to within 1% using @xmath220",
    ", at least 12 pixels per fwhm are required ; for @xmath216 , this number falls to around 5 .",
    "we suggest that observers estimate the degree to which their peak sb measurements may be in error due to pixellation , and incorporate this into their error budgets . in blobcat , which catalogues fitted peak sb values ( @xmath216 ) , this is implemented using a pixellation error parameter which we define as @xmath221 ; this parameter is applied in equation  ( [ eqn : sperr ] ) .",
    "we note that inclusion of this parameter will tend to ( slightly ) over - estimate peak sb errors for resolved sources ; we see this as more appropriate than underestimating peak sb errors for point sources because this error is unlikely to be relevant for resolved sources ( where the integrated sb represents the flux density ; see   [ sec : ppbfd ] ) .    finally , we note that integrated sb measurements are less affected by pixellation error than peak pixels .",
    "this is because integrated sb is conserved when summing over multiple pixels .",
    "this conservation is limited only by noise fluctuations and the ratio between the peak snr of a source and the flood fill cutoff . to illustrate this limitation , consider a faint unresolved source situated in a heavily pixellated image ( i.e. where @xmath49 and @xmath50 are small ) .",
    "the profile of this source will be poorly mapped by the pixels , rendering blobcat s integrated sb measurement ( via equation  ( [ eqn : blobfrac ] ) ) vulnerable to negative bias .",
    "however , in general this vulnerability will not be an issue because it is the peak sb that is the important value for unresolved sources ( see   [ sec : ppbfd ] ) .",
    "for completeness , a full list of program input arguments to blobcat is presented below . note that not all arguments may be required for analysis ( see   [ sec : hbwpin]@xmath173[sec : hbwpout ] ;",
    "see also the default values provided in the code ) .",
    "for example , if errors are not required ( or are not suitably defined for a particular observational scenario ) , the input arguments relating to errors below may be ignored .",
    "( conversely , new input arguments may be easily defined by the user and incorporated into blobcat . )    _ argument 1 : _",
    "sb_image.fits + fits image of surface brightness in stokes @xmath0 intensity ( or stokes @xmath1 , @xmath2 , or @xmath5 intensities under limited conditions ) or linear polarization ( @xmath3 or @xmath4 ) ; see   [",
    "sec : hbwiisb ] .        _",
    "argument 4 : _",
    "bwsval + uniform ( spatially - invariant ) level of bandwidth smearing present in the sb image .",
    "this is required if argument 5 is not provided . to ignore bandwidth smearing , this value should be set to @xmath193 .",
    "_ arguments 6 - 8 : _ bmaj , bmin , bpa + image resolution ( beam ) parameters ; these are only required if image header items are incorrect or incomplete ( at present , beam parameters are not standard fits headers ) .",
    "_ argument 11 : _",
    "pmep + maximum estimated peak sb attenuation due to pixellation error ( see appendix a ) ; defined here as the maximum anticipated value of @xmath222 . when set to a value greater than 0",
    ", this parameter will ensure that sources with raw observed peak sb less than the nominated detection threshold ( @xmath223 ) , yet fitted peak sb greater than this threshold ( @xmath224 ) , will be accepted into the catalogue .",
    "if ignored , pmep will default to 1 , causing blobcat to check all blobs with @xmath225 for catalogue acceptance ( though this will increase blobcat s run - time , particularly if @xmath35 and @xmath36 differ greatly in magnitude ) .",
    "_ arguments 20 - 22 : _ minpix , maxpix , pixdim + minimum and maximum accepted blob sizes in pixels , and minimum number of pixels in ra / dec dimensions for accepted blobs ( useful for filtering out easily - identified image artefacts ) ."
  ],
  "abstract_text": [
    "<S> we present blobcat , new source extraction software that utilises the flood fill algorithm to detect and catalogue blobs , or islands of pixels representing sources , in two - dimensional astronomical images . </S>",
    "<S> the software is designed to process radio - wavelength images of both stokes @xmath0 intensity and linear polarization , the latter formed through the quadrature sum of stokes @xmath1 and @xmath2 intensities or as a byproduct of rotation measure synthesis . </S>",
    "<S> we discuss an objective , automated method by which estimates of position - dependent background root - mean - square noise may be obtained and incorporated into blobcat s analysis . </S>",
    "<S> we derive and implement within blobcat corrections for two systematic biases to enable the flood fill algorithm to accurately measure flux densities for gaussian sources . </S>",
    "<S> we discuss the treatment of non - gaussian sources in light of these corrections . </S>",
    "<S> we perform simulations to validate the flux density and positional measurement performance of blobcat , and we benchmark the results against those of a standard gaussian fitting task . </S>",
    "<S> we demonstrate that blobcat exhibits accurate measurement performance in total intensity and , in particular , linear polarization . </S>",
    "<S> blobcat is particularly suited to the analysis of large survey data .    </S>",
    "<S> [ firstpage ]    methods : data analysis , statistical  techniques : image processing , polarimetric . </S>"
  ]
}