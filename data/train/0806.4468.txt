{
  "article_text": [
    "ognitive radio ( cr ) , since the name was coined by mitola in his seminal work @xcite , has drawn intensive attentions from both academic ( see , e.g. , @xcite and references therein ) and industrial ( see , e.g. , @xcite and references therein ) communities ; and to date , many interesting and important results have been obtained . in cr networks ,",
    "the secondary users or crs usually communicate over the same bandwidth originally allocated to an existing primary radio network . in such a scenario ,",
    "the cr transmitters usually need to deal with a fundamental tradeoff between maximizing the secondary network throughput and minimizing the resulted performance degradation of the active primary transmissions .",
    "one commonly known technique used by the secondary users to protect the primary transmissions is _ opportunistic spectrum access _ ( osa ) , originally outlined in @xcite and later introduced by darpa , whereby the secondary user decides to transmit over a particular channel only when all primary transmissions are detected to be off . for osa ,",
    "an enabling technology is to detect the primary transmission on / off status , also known as _ spectrum sensing _ , for which many algorithms have been reported in the literature ( see , e.g. , @xcite and references therein ) .",
    "however , in practical situations with a nonzero misdetection probability for an active primary transmission , it is usually impossible to completely avoid the performance degradation of the primary transmission with the secondary user osa .",
    "another approach different from osa for a cr to maximize its throughput and yet to provide sufficient protection to the primary transmission is allowing the cr to access the channel even when the primary transmissions are active , provided that the resultant interference power , or the so - called _ interference temperature _ ( it ) @xcite , @xcite , at each primary receiver is limited below a predefined value .",
    "this spectrum sharing strategy is also referred to as spectrum underlay @xcite , @xcite or horizontal spectrum sharing @xcite , @xcite . with this strategy , _ dynamic resource allocation _",
    "( dra ) becomes essential , whereby the transmit powers , bit - rates , bandwidths , and antenna beams of the secondary transmitters are dynamically allocated based upon the channel state information ( csi ) in the primary and secondary networks . a number of papers have recently addressed the design of optimal dra schemes to achieve the point - to - point cr channel capacity under the it constraints at the primary receivers ( see , e.g. , @xcite-@xcite ) . on the other hand , since the cr network is in nature a multiuser communication environment , it will be more relevant to consider dra among multiple secondary users in a cr network rather than that for the case of one point - to - point cr channel . deploying the interference - temperature constraint as a practical means to protect the primary transmissions , the conventional network models such as the multiple - access channel ( mac ) , broadcast channel ( bc ) , interference channel ( ic ) , and relay channel ( rc )",
    "can all be considered for the secondary network , resulting in various new cognitive network models and associated problem formulations for dra ( see , e.g. , @xcite-@xcite ) .",
    "it is also noted that there has been study in the literature on the information - theoretic limits of the cr channels by exploiting other types of `` cognitions '' available at the cr terminals different from the it , such as the knowledge of the primary user transmit messages at the cr transmitter @xcite , @xcite , the distributed detection results on the primary transmission status at the cr transmitter and receiver @xcite , the `` soft '' sensing results on the primary transmission @xcite , and the primary transmission on - off statistics @xcite .    in this paper , we focus on the single - input single - output ( siso ) or single - antenna fading cognitive mac ( c - mac ) and cognitive bc ( c - bc ) for the secondary network , where @xmath0 secondary users communicate with the base station ( bs ) of the secondary network in the presence of @xmath1 primary receivers . it is assumed that the bs has the perfect csi on the channels between the bs and all the secondary users , as well as the channels from the bs and each secondary user to all the primary receivers .",
    "thereby , the bs can implement a centralized dynamic power and rate allocation scheme in the secondary network so as to optimize its performance and yet maintain the interference power levels at all the primary receivers below the prescribed thresholds .",
    "an information - theoretic approach is taken in this paper to characterize the maximum sum - rate of secondary users averaged over the channel fading states , termed as _ ergodic sum capacity _",
    ", for both the fading c - mac and c - bc . the ergodic sum capacity can be a relevant measure for the maximum achievable throughput of the secondary network when the data traffic has a sufficiently - large delay tolerance .",
    "as usual ( see , e.g. , @xcite ) , we consider both the long - term ( lt ) transmit - power constraint ( tpc ) that regulates the _ average _ transmit power across all the fading states at the bs or each of the secondary user , as well as the short - term ( st ) tpc that is more restrictive than the lt - tpc by limiting the _ instantaneous _ transmit power at each fading state to be below a certain threshold .",
    "similarly , we also consider both the lt interference - power constraint ( ipc ) that regulates the resultant average interference power over fading at each primary receiver , and the st - ipc that imposes a more strict instantaneous limit on the resultant interference power at each fading state .",
    "the major problem to be addressed in this paper is then to characterize the ergodic sum capacity of the secondary network under different combinations of lt-/st - tpc and lt-/st - ipc .",
    "apparently , such a problem setup is unique for the fading cr networks .",
    "moreover , we are interested in investigating the conditions over each case for the optimality of the dynamic time - division - multiple - access ( d - tdma ) scheme in the secondary network , i.e. , when it is optimal to schedule a single secondary user at each fading state for transmission to achieve the ergodic sum capacity .",
    "these optimality conditions for d - tdma are important to know as when they are satisfied , the single - user decoding and encoding at the secondary bs becomes optimal for the c - mac and c - bc , respectively .",
    "this can lead to a significant complexity reduction compared with the cases where these conditions are not satisfied such that the bs requires more complex multiuser decoding and encoding techniques to achieve the ergodic sum capacity .",
    "information - theoretic studies can be found for the deterministic ( no fading ) siso - mac and siso - bc in , e.g. , @xcite , and for the fading ( parallel ) siso - mac and siso - bc in , e.g. , @xcite-@xcite and @xcite-@xcite , respectively .",
    "in addition , d - tdma has been shown as the optimal transmission scheme to achieve the ergodic sum capacity of the fading siso - mac under the lt - tpc at each transmitter @xcite , @xcite .",
    "thanks to the duality result on the capacity regions of the gaussian mac and bc @xcite , the optimality of d - tdma is also provable for the fading siso - bc to achieve the ergodic sum capacity .",
    "however , to our best knowledge , characterizations of the ergodic sum capacities as well as the optimality conditions for d - tdma over the fading c - mac and c - bc under various mixed transmit - power and interference - power constraints have not been addressed yet in the literature . in this paper",
    ", we will provide the solutions to these problems .",
    "the main results of this paper are summarized below for a brief overview :    * for the fading cognitive siso - mac , we show that d - tdma is optimal for achieving the ergodic sum capacity when the lt - tpc is applied jointly with the lt - ipc .",
    "this result is an extension of that obtained earlier in @xcite for the traditional fading siso - mac without the lt - ipc . for the other three cases of mixed power constraints ,",
    "i.e. , lt - tpc with st - ipc , st - tpc with lt - ipc , and st - tpc with st - ipc , we show that although d - tdma is in general a suboptimal scheme and thus does not achieve the ergodic sum capacity , it can be optimal under some special conditions .",
    "we formally derive these conditions from the karush - kuhn - tucker ( kkt ) conditions @xcite associated with the capacity maximization problems . in particular , for the case of lt - tpc with st - ipc , we show that the optimal number of secondary users that transmit at the same time should be no greater than @xmath2 .",
    "therefore , for small values of @xmath1 , e.g. , @xmath3 corresponding to a single primary receiver , d - tdma is close to being optimal .",
    "furthermore , for all cases considered , we derive the optimal transmit power - control policy for the secondary users to achieve the ergodic sum capacity .",
    "for the two cases of lt - tpc with lt - ipc and st - tpc with lt - ipc , we provide the closed - form solutions for the optimal power allocation at each fading state .",
    "particularly , in the case of st - tpc with lt - ipc , we show that for the active secondary users at one particular fading state , there is at most one user that transmits with power lower than its st power constraint , while all the other active users transmit with their maximum powers . * for the fading cognitive siso - bc , we show that for all considered cases of mixed power constraints , d - tdma is optimal for achieving the ergodic sum capacity .",
    "the optimal transmit power allocations at the bs in these cases have closed - form solutions , which resemble the single - user `` water - filling ( wf ) '' solutions for the well - known fading ( parallel ) gaussian channels @xcite , @xcite .    the rest of this paper is organized as follows .",
    "section [ sec : system model ] provides the system model for the fading c - mac and c - bc .",
    "section [ sec : mac ] and section [ sec : bc ] then present the results on the ergodic sum - capacity , the associated optimal power - control policy , and the optimality conditions for d - tdma , for the fading c - mac and c - bc , respectively , under different mixed lt / st transmit - power and interference - power constraints . section [ sec : numerical results ] provides the numerical results on the ergodic sum capacities of the fading c - mac and c - bc under different mixed power constraints , the capacities with vs. without the tdma constraint , and those with vs. without the optimal power control , and draws some insightful observations pertinent to the optimal dra in cr networks .",
    "finally , section [ sec : conclusions ] concludes this paper .",
    "consider a fading c - mac as shown in fig .",
    "[ fig : c - mac model ] , where @xmath0 crs or secondary users ( sus ) transmit to the secondary bs by sharing the same narrow band with @xmath1 primary receivers ( prs ) , and all terminals are assumed to be equipped with a single antenna each .",
    "a _ block - fading _",
    "( bf ) channel model is assumed for all the channels involved .",
    "furthermore , since this paper considers coherent communications , only the fading channel power gains ( amplitude squares ) are of interest . during each transmission block , the power gain of the fading channel from the @xmath4-th su to the secondary bs is denoted by @xmath5 , while that of the fading channel from the @xmath4-th su to the @xmath6-th pr is denoted by @xmath7 , @xmath8 .",
    "these channel power gains are assumed to be drawn from a vector random process , which we assume to be ergodic over transmission blocks and have a continuous , differentiable joint cumulative distribution function ( cdf ) , denoted by @xmath9 , where @xmath10 $ ] denotes the power gain vector for all the channels of interest .",
    "we further assume that @xmath5 s and @xmath7 s are independent .",
    "in addition , it is assumed that the additive noises ( including any additional interferences from the outside of the secondary network , e.g. , the primary transmitters ) at the secondary bs are independent circular symmetric complex gaussian ( cscg ) random variables , each having zero mean and unit variance , denoted as @xmath11 .",
    "since in this paper we are interested in the information - theoretic limits of the c - mac , it is assumed that the optimal gaussian codebook is used by each su transmitter .",
    "it is assumed that the secondary bs knows _ a priori _ the channel distribution information @xmath9 and furthermore the channel realization @xmath12 at each transmission block .",
    "thereby , the secondary bs is able to schedule transmissions of sus and allocate their transmit power levels and rate values at each transmission block , so as to optimize the performance of the secondary network and yet provide a necessary protection to each of the prs .",
    "we denote the transmit power - control policy for sus as @xmath13 , which specifies a mapping from the fading channel realization @xmath12 to @xmath14 $ ] , where @xmath15 denotes the transmit power assigned to the @xmath4-th su . the long - term ( lt ) transmit - power constraint ( tpc ) for the @xmath4-th su , @xmath16 ,",
    "can then be described as @xmath17\\leq p^{\\rm lt}_k\\ ] ] where the expectation is taken over @xmath12 with respect to ( w.r.t . ) its cdf , @xmath9 , and the short - term ( st ) transmit - power constraint ( tpc ) for the @xmath4-th su is given as @xmath18 similarly , we consider both the lt and st interference - power constraints ( ipcs ) at the @xmath6-th pr , @xmath19 , described as @xmath20\\leq \\gamma^{\\rm lt}_m\\ ] ]    @xmath21    respectively . for a given @xmath13 ,",
    "the maximum achievable sum - rate ( in nats / complex dimension ) of sus averaged over all the fading states can be expressed as ( see , e.g. , @xcite ) @xmath22.\\ ] ] the ergodic sum capacity of the fading c - mac can then be defined as @xmath23 where @xmath24 is the feasible set specified by a particular combination of the lt - tpc , st - tpc , lt - ipc and st - ipc .",
    "note that all of these power constraints are affine and thus specify convex sets of @xmath15 s , so does any of their arbitrary combinations .",
    "therefore , the capacity maximization in ( [ eq : sum capacity mac ] ) is in general a _ convex _ optimization problem , and thus efficient numerical algorithms are available to obtain its solutions . in this paper , we consider @xmath24 to be generated by one of the following four possible combinations of power constraints , which are lt - tpc with lt - ipc , lt - tpc with st - ipc , st - tpc with lt - ipc , and st - tpc with st - ipc , for the purpose of exposition .",
    "next , we consider the siso fading c - bc as shown in fig .",
    "[ fig : c - bc model ] , where the secondary bs transmits to @xmath0 sus while possibly interfering with each of the @xmath1 prs . without loss of generality , we use the same notation , @xmath5 , to denote the channel power gain from the bs to the @xmath4-th su , @xmath16 , as for the c - mac .",
    "the interference channel power gains from the bs to prs are denoted as @xmath25 , @xmath19 , which are assumed to be mutually independent and also independent of @xmath5 s .",
    "similar to the c - mac case , let @xmath26 $ ] denote the power gain vector for all the channels involved in the c - bc , which we assume to be drawn from an ergodic vector random process with a continuous , differentiable joint cdf , denoted by @xmath27 .",
    "it is assumed that the additive noises at all su receivers are independent cscg random variables each distributed as @xmath11 ; and the optimal gaussian codebook is used by the transmitter of the bs . with the available channel distribution information @xmath27 as well as the csi on @xmath5 s and @xmath25 s at each transmission block , the secondary bs designs its downlink transmissions to the sus by dynamically allocating its transmit power levels and rate values .",
    "let @xmath28 denote the transmit power - control policy for the secondary bs , which specifies a mapping from the fading channel realization @xmath29 to its transmit power @xmath30 .",
    "similarly as for c - mac , we define the lt - tpc and st - tpc for the secondary bs as @xmath31\\leq q^{\\rm lt}\\ ] ] where the expectation is taken over @xmath29 w.r.t .",
    "its cdf , @xmath27 , and @xmath32 respectively ; and the lt - ipc and st - ipc at the @xmath6-th pr , @xmath19 , as @xmath33\\leq \\gamma^{\\rm lt}_m\\ ] ] and @xmath34 respectively .",
    "now , consider an auxiliary siso fading c - mac for the siso fading c - bc of interest , where @xmath35 s remain the same as in the c - bc while @xmath36 .",
    "thus , the channel realization @xmath12 in this auxiliary c - mac can be concisely represented by @xmath29 in the c - bc . by applying the mac - bc duality result @xcite at each fading state , for a given @xmath30 , the maximum sum - rate of the c - bc",
    "can be obtained from its auxiliary c - mac as @xmath37 therefore , the ergodic sum capacity of the fading c - bc can be equivalently obtained from its auxiliary fading c - mac as @xmath38 where @xmath39 is specified by a particular combination of ( [ eq : lt tpc bc])-([eq : st ipc bc ] ) , with @xmath30 being replaced by @xmath40 .",
    "note that we can obtain the optimal power - control policy @xmath28 to achieve the ergodic sum capacity of the c - bc from the corresponding optimal @xmath13 by solving the maximization problem in ( [ eq : sum capacity bc new ] ) .",
    "similarly as for @xmath41 in ( [ eq : sum capacity mac ] ) , it can be shown that the optimization problem for obtaining @xmath42 in ( [ eq : sum capacity bc new ] ) is convex .",
    "in this section , we consider the siso fading c - mac under different mixed transmit - power and interference - power constraints . for each case , we derive the optimal power - control policy for achieving the ergodic sum capacity , as well as the conditions for the optimality of d - tdma .",
    "@xmath43-\\sum_{k=1}^k\\lambda_k\\ { \\mathbb{e}[p_k({\\mbox{\\boldmath{$ \\alpha $ } } } ) ] - p^{\\rm lt}_k\\ } -\\sum_{m=1}^m\\mu_m\\left\\{\\mathbb{e}\\left[\\sum_{k=1}^kg_{km}p_k({\\mbox{\\boldmath{$ \\alpha $ } } } ) \\right]- \\gamma^{\\rm lt}_m\\right\\}\\end{aligned}\\ ] ]    from ( [ eq : sum rate mac ] ) and ( [ eq : sum capacity mac ] ) , the ergodic sum capacity under the lt - tpc and the lt - ipc can be obtained by solving the following optimization problem :    [ prob : lt lt mac ] @xmath44 \\\\ \\mathtt { subject \\ to \\",
    "( s.t . ) } & & ( \\ref{eq : lt tpc mac } ) , ( \\ref{eq : lt ipc mac}).\\end{aligned}\\ ] ]    the proposed solution to the above problem is based on the lagrange duality method .",
    "first , we write the lagrangian of this problem as in ( [ eq : lagrangian lt lt ] ) ( shown on the next page ) , where @xmath45 and @xmath46 are the nonnegative dual variables associated with each corresponding power constraint in ( [ eq : lt tpc mac ] ) and ( [ eq : lt ipc mac ] ) , respectively , @xmath16 , @xmath19 .",
    "then , the lagrange dual function , @xmath47 , is defined as @xmath48 the dual function serves as an upper bound on the optimal value of the original ( primal ) problem , denoted by @xmath49 , i.e. , @xmath50 for any nonnegative @xmath45 s and @xmath46 s .",
    "the dual problem is then defined as @xmath51 let the optimal value of the dual problem be denoted by @xmath52 , which is achievable by the optimal dual solutions @xmath53 and @xmath54 , i.e. , @xmath55 . for a convex optimization problem with a strictly feasible point as in our problem , the slater s condition @xcite is satisfied and thus the duality gap , @xmath56 , is indeed zero .",
    "this result ensures that problem [ prob : lt lt mac ] can be equivalently solved from its dual problem , i.e. , by first maximizing its lagrangian to obtain the dual function for some given dual variables , and then minimizing the dual function over the dual variables .",
    "consider first the problem for obtaining @xmath47 with some given @xmath45 s and @xmath46 s .",
    "it is interesting to observe that this dual function can also be written as @xmath57 + \\sum_{k=1}^k\\lambda_kp^{\\rm lt}_k + \\sum_{m=1}^m \\mu_m\\gamma^{\\rm lt}_m\\end{aligned}\\ ] ] where @xmath58 thus , the dual function can be obtained via solving for sub - dual - function @xmath59 s , each for one fading state with channel realization , @xmath12 .",
    "notice that the maximization problems in ( [ eq : dual function per state lt lt ] ) with different @xmath12 s all have the same structure and thus can be solved using the same computational routine . for conciseness",
    ", we drop the @xmath12 in @xmath60@xmath61 s for the maximization problem at each fading state and express it as    [ prob : lt lt mac per state ] @xmath62    this problem is convex since its objective function is concave and its constraints are all linear . by introducing nonnegative dual variables @xmath63 , for the corresponding constraints on the nonnegativity of @xmath64 s , we can write the following kkt conditions @xcite that need to be satisfied by the optimal primal and dual solutions of problem [ prob : lt lt mac per state ] , denoted as @xmath65 and @xmath66 , respectively . @xmath67 with @xmath68 and @xmath69 .",
    "the following lemma can then be obtained from these kkt optimality conditions :    [ lemma : tdma opt lt lt ] the optimal solution of problem [ prob : lt lt mac per state ] has at most one user indexed by @xmath70 , @xmath71 , with @xmath72 , i.e. , the solution follows a d - tdma structure",
    ".    please refer to appendix [ appendix : proof tdma opt lt lt ] .",
    "given lemma [ lemma : tdma opt lt lt ] , the remaining tasks for solving problem [ prob : lt lt mac per state ] are to find the user that transmits at each fading state as well as the optimal transmit power , which are given by the following lemma :    [ lemma : opt power user lt lt ] in the optimal solution of problem [ prob : lt lt mac per state ] , let @xmath70 denote the user that has @xmath73 , and @xmath74 be any of the other users that has @xmath75 , @xmath76",
    ". then user @xmath70 must satisfy @xmath77 the optimal power allocation of user @xmath70 is @xmath78 where @xmath79",
    ".    please refer to appendix [ appendix : proof opt user power lt lt ]",
    ".    solutions of problem [ prob : lt lt mac per state ] across all the fading states are basically an optimal mapping between an arbitrary channel realization and the transmit power allocation for any given @xmath45 s and @xmath46 s , which can then be used to obtain the dual function @xmath47 .",
    "next , the dual function needs to be minimized over @xmath45 s and @xmath46 s to obtain the optimal dual solutions @xmath80 s and @xmath81 s with which the duality gap is zero .",
    "one method to iteratively update @xmath45 s and @xmath46 s toward their optimal values is the ellipsoid method @xcite , of which we omit the details here for brevity .",
    "lemma [ lemma : tdma opt lt lt ] suggests that at each fading state , at most one su can transmit , i.e. , d - tdma is optimal . since this result holds for any given @xmath45 s and @xmath46 s , it must be true for the optimal dual solutions @xmath80 s and @xmath81 s under which the optimal value of the original problem or the ergodic sum capacity is achieved .",
    "therefore , we have the following theorem :    [ theorem : tdma opt lt lt ] d - tdma is optimal across all the fading states for achieving the ergodic sum capacity of the fading c - mac under the lt - tpc jointly with the lt - ipc . the optimal rules to select the su for transmission at a particular fading state and to determine its transmit power are given by lemma [ lemma : opt power user lt lt ] with all @xmath45 s and @xmath46 s replaced by their optimal dual solutions for problem [ prob : lt lt mac ]",
    ".    notice that if the lt - ipc given by ( [ eq : lt ipc mac ] ) is not present in problem [ prob : lt lt mac ] , or equivalently , the lt - ipc values @xmath82 s are sufficiently large such that these constraints are inactive with the optimal power solutions of problem [ prob : lt lt mac ] , it is then easy to verify from its kkt conditions that the optimal dual solutions for all @xmath46 s must be equal to zero .",
    "from ( [ eq : user ordering lt lt ] ) , it then follows that only user @xmath70 with the largest @xmath83 among all the users can probably transmit at a given fading state .",
    "this result is consistent with that obtained earlier in @xcite for the traditional fading siso - mac without the lt - ipc . however , under the additional lt - ipc , from ( [ eq : user ordering lt lt ] ) and ( [ eq : opt power lt lt ] ) it is observed that the selected su for transmission and its transmit power depend on the interference - power `` prices '' @xmath46 s for different prs and the instantaneous interference channel power gains @xmath7 s .",
    "the ergodic sum capacity under the lt - tpc but with the st - ipc can be obtained as the optimal value of the following problem :    [ prob : lt st mac ] @xmath84 \\\\ \\mathtt { s.t .",
    "} & & ( \\ref{eq : lt tpc mac } ) , ( \\ref{eq : st ipc mac}).\\end{aligned}\\ ] ]    similar to problem [ prob : lt lt mac ] , we apply the lagrange duality method to solve the above problem .",
    "however , different from problem [ prob : lt lt mac ] that has both the long - term transmit - power and interference - power constraints , it is noted that in problem [ prob : lt st mac ] , only the transmit - power constraints are long - term while the interference - power constraints are short - term .",
    "therefore , the dual variables associated with the long - term constraints should be introduced first , in order to decompose the problem into individual subproblems over different fading states , to each of which the corresponding short - term constraints can then be applied .",
    "let @xmath45 be the nonnegative dual variable associated with the corresponding lt - tpc in ( [ eq : lt tpc mac ] ) , @xmath16 .",
    "the lagrangian of this problem can then be written as @xmath85 \\nonumber \\\\ & ~ -\\sum_{k=1}^k\\lambda_k\\left\\ { \\mathbb{e}\\left[p_k({\\mbox{\\boldmath{$ \\alpha $ } } } ) \\right]- p^{\\rm lt}_k\\right\\}.\\end{aligned}\\ ] ] let @xmath86 denote the set of @xmath87 specified by the remaining st - ipc in ( [ eq : st ipc mac ] ) . the lagrange dual function",
    "is then expressed as @xmath88 the dual problem is accordingly defined as @xmath89 .",
    "similar to problem [ prob : lt lt mac ] , it can be verified that the duality gap is zero for the convex optimization problem addressed here ; and thus solving its dual problem is equivalent to solving the original problem .",
    "consider first the problem for obtaining @xmath90 with some given @xmath45 s .",
    "similar to problem [ prob : lt lt mac ] , this dual function can be decomposed into individual sub - dual - functions , each for one fading state , i.e. , @xmath91 + \\sum_{k=1}^k\\lambda_kp^{\\rm lt}_k\\end{aligned}\\ ] ] where @xmath92 with @xmath93 denoting the subset of @xmath86 corresponding to the fading state with channel realization @xmath12 . after dropping the @xmath12 in the corresponding maximization problem in ( [ eq : dual function per state lt st ] ) for a particular fading state",
    ", we can express this problem as    [ prob : lt st mac per state ] @xmath94    the above problem is convex , but in general does not have a closed - form solution .",
    "nevertheless , it can be efficiently solved by standard convex optimization techniques , e.g. , the interior point method @xcite , or alternatively , via solving its dual problem ; and for brevity , we omit the details here . after solving problem [ prob : lt st mac per state ] for all the fading states ,",
    "we can obtain the dual function @xmath90 .",
    "next , the minimization of @xmath90 over @xmath45 s can be resolved via the ellipsoid method , similarly like that for problem [ prob : lt lt mac ] .",
    "for this case , we next focus on studying the conditions under which d - tdma is optimal across the fading states .",
    "this can be done by investigating the kkt optimality conditions for problem [ prob : lt st mac per state ] .",
    "first , we introduce nonnegative dual variables @xmath46 , @xmath19 , and @xmath63 , for their associated constraints in ( [ eq : constraint 1 lt st ] ) and ( [ eq : constraint 2 lt st ] ) , respectively .",
    "the kkt conditions for the optimal primal and dual solutions of this problem , denoted as @xmath65 , @xmath54 , and @xmath66 , can then be expressed as @xmath95 with @xmath96 , @xmath69 , and @xmath97 .",
    "notice that in this case @xmath46 s are local variables for each fading state instead of being fixed as in ( [ eq : kkt1 lt lt ] ) for problem [ prob : lt lt mac per state ] . from these kkt conditions , the following lemma",
    "can then be obtained :    [ lemma : tdma opt lt st ] the optimal solution of problem [ prob : lt st mac per state ] has at most @xmath2 secondary users that transmit with strictly positive power levels",
    ".    please refer to appendix [ appendix : proof tdma opt lt st ] .",
    "lemma [ lemma : tdma opt lt st ] suggests that the optimal number of sus that can transmit at each fading state may depend on the number of prs or interference - power constraints . for small values of @xmath1 ,",
    "e.g. , @xmath3 corresponding to a single pr , the number of active sus at each fading state can be at most two , suggesting that d - tdma may be very close to being optimal in this case .    in the theorem",
    "below , we present the general conditions , for any @xmath0 and @xmath1 , under which d - tdma is both necessary and sufficient to be optimal at a particular fading state . again , without loss of generality , here we use @xmath45 s instead of their optimal dual solutions obtained by the ellipsoid method .    [",
    "theorem : tdma opt conditions lt st ] d - tdma is optimal at an arbitrary fading state for achieving the ergodic sum capacity of the fading c - mac under the lt - tpc jointly with the st - ipc if and only if there exists one user @xmath70 ( the user that transmits ) that satisfies either one of the following two sets of conditions .",
    "let @xmath74 be any of the other users , @xmath98 ; and @xmath99 .",
    "* @xmath100 and @xmath101 . in this case ,",
    "@xmath102 ; * @xmath103 and @xmath104 . in this case , @xmath105",
    ".    please refer to appendix [ appendix : proof tdma opt conditions lt st ] .",
    "notice that in theorem [ theorem : tdma opt conditions lt st ] , the first set of conditions holds when the optimal transmit power of the user with the largest @xmath83 among all the users satisfies the st - ipc at all the prs ; the second set of conditions holds when the first set fails to be true , and in this case any of @xmath0 sus can be the selected user for transmission provided that it satisfies the given @xmath106 inequalities .",
    "in the special case where only the st - ipc given by ( [ eq : st ipc mac ] ) is present or active in problem [ prob : lt st mac ] , all @xmath45 s in theorem [ theorem : tdma opt conditions lt st ] can be taken as zeros .",
    "as a result , the first set of conditions can never be true , while the second set of conditions are simplified as @xmath107 , and the optimal power of user @xmath70 that transmits is still @xmath108 .",
    "we thus have the following corollary if it is further assumed that there is only a single pr . for conciseness",
    ", the index @xmath6 for this pr is dropped below .",
    "[ corol : lt st ] in the case that only the st - ipc given by ( [ eq : st ipc mac ] ) is present in problem [ prob : lt st mac ] and , furthermore , @xmath3 , d - tdma is optimal ; and the selected user @xmath70 for transmission satisfies that @xmath109 , with transmit power @xmath110 .      in the case of st - tpc combined with lt - ipc , the ergodic sum capacity is the optimal value of the following optimization problem :    [ prob : st lt mac ] @xmath84 \\\\ \\mathtt { s.t . } & & ( \\ref{eq : st tpc mac } ) , ( \\ref{eq : lt ipc mac}).\\end{aligned}\\ ] ]    again , we apply the lagrange duality method for the above problem .",
    "let @xmath46 s be the nonnegative dual variables associated with the lt - ipc in ( [ eq : lt ipc mac ] ) , @xmath19 .",
    "the lagrangian of problem [ prob : st lt mac ] can then be written as @xmath111\\nonumber \\\\   - \\sum_{m=1}^m\\mu_m\\left\\{\\mathbb{e}\\left[\\sum_{k=1}^kg_{km}p_k({\\mbox{\\boldmath{$ \\alpha $ } } } ) \\right]- \\gamma^{\\rm lt}_m\\right\\}.\\end{aligned}\\ ] ] let @xmath112 denote the set of @xmath87 specified by the remaining st - tpc in ( [ eq : st tpc mac ] ) .",
    "the lagrange dual function is expressed as @xmath113 the dual problem is accordingly defined as @xmath114 .",
    "similar to the previous two cases , this dual function can be equivalently written as @xmath115 + \\sum_{m=1}^m\\mu_k\\gamma^{\\rm lt}_m\\end{aligned}\\ ] ] where @xmath116 with @xmath117 denoting the subset of @xmath112 corresponding to the fading state with channel realization @xmath12 .",
    "after dropping @xmath12 in the maximization problem in ( [ eq : dual function per state st lt ] ) , for each particular fading state we can express this problem as    [ prob : st lt mac per state ] @xmath118    after solving problem [ prob : st lt mac per state ] for all the fading states , we obtain the dual function @xmath119 .",
    "the dual problem that minimizes @xmath119 over @xmath46 s can then be solved again via the ellipsoid method .",
    "next , we present the closed - form solution of problem [ prob : st lt mac per state ] based on its kkt optimality conditions .",
    "let @xmath45 and @xmath120 , @xmath16 , be the dual variables for the corresponding user power constraints in ( [ eq : constraint 1 st lt ] ) and ( [ eq : constraint 2 st lt ] ) , respectively .",
    "the kkt conditions for the optimal primal and dual solutions of this problem , denoted as @xmath65 , @xmath53 , and @xmath66 , can then be expressed as @xmath121 with @xmath68 , @xmath122 , and @xmath123 . from these kkt conditions ,",
    "the following lemma can be first obtained :    [ lemma : opt 1 st lt ] let @xmath70 and @xmath74 be any two arbitrary users , @xmath124 , with @xmath125 and @xmath75 in the optimal solution of problem [ prob : st lt mac per state ] .",
    "then , it must be true that @xmath126",
    ".    please refer to appendix [ appendix : proof lemma 1 st lt ] .",
    "let @xmath127 be a permutation over @xmath128 such that @xmath129 if @xmath130 .",
    "supposing that there are @xmath131 users that can transmit with @xmath132 denoting this set of users , from lemma [ lemma : opt 1 st lt ] it is easy to verify that @xmath133 .",
    "the following lemma then provides the closed - form solution to problem [ prob : st lt mac per state ] :    [ lemma : opt 2 st lt ] the optimal solution of problem [ prob : st lt mac per state ] is @xmath134 where @xmath131 is the largest value of @xmath135 such that @xmath136",
    ".    please refer to appendix [ appendix : proof lemma 2 st lt ] .    from lemma [ lemma : opt 2 st lt ]",
    ", it follows that in the case of st - tpc along with lt - ipc , for the active secondary users at one fading state , there is at most one user that transmits with power lower than its st power constraint , while all the other active users transmit with their maximum powers .",
    "furthermore , from lemma [ lemma : opt 2 st lt ] , we can derive the conditions for the optimality of d - tdma at any fading state , which are stated in the following theorem .",
    "again , without loss of generality , we use @xmath46 s instead of their optimal dual solutions for problem [ prob : st lt mac ] in expressing these conditions .    [",
    "theorem : tdma opt conditions st lt ] d - tdma is optimal at an arbitrary fading state for achieving the ergodic sum capacity of the fading c - mac under the st - tpc jointly with the lt - ipc if and only if user @xmath137 satisfies @xmath138 user @xmath137 is then selected for transmission and its optimal transmit power is @xmath139    from lemma [ lemma : opt 2 st lt ] , it follows that d - tdma is optimal , i.e. , @xmath140 , occurs if and only if ( [ eq : tdma opt st lt ] ) holds . then",
    ", ( [ eq : tdma opt power st lt ] ) is obtained from lemma [ lemma : opt 2 st lt ] by combining the cases of @xmath141 and @xmath142 .    in the case of the traditional fading siso - mac with the user st - tpc",
    "given in ( [ eq : st tpc mac ] ) , but without the lt - ipc given in ( [ eq : lt ipc mac ] ) , it can be easily verified that the ergodic sum capacity is achieved when all users transmit with their maximum available power values given by @xmath143 s at each fading state .",
    "this is consistent with the results obtained in ( [ eq : opt power st lt ] ) by having all @xmath46 s associated with the lt - ipc take zero values . with zero @xmath46 s",
    ", it can be easily verified that the condition given in theorem [ theorem : tdma opt conditions st lt ] is never satisfied , and thus d - tdma can not be optimal in this special case .      the ergodic sum capacity under both the st - tpc and st - ipc can be obtained by solving the following optimization problem :    [ prob : st st mac ] @xmath84 \\\\ \\mathtt { s.t . } & & ( \\ref{eq : st tpc mac } ) , ( \\ref{eq : st ipc mac}).\\end{aligned}\\ ] ]    notice that this case differs from all three previous cases in that all of its power constraints are short - term constraints and thus separable over fading states .",
    "therefore , we can decompose the original problem into individual subproblems each for one fading state .",
    "for conciseness , we drop again the @xmath12 and express the rate maximization problem at a particular fading state as    [ prob : st st mac per state ] @xmath144    the above problem is convex , but in general does not have a closed - form solution .",
    "similar to problem [ prob : lt st mac per state ] , the interior point method @xcite or the lagrange duality method can be used to solve this problem and thus we omit the details here .    for this case ,",
    "we next present in the following theorem the conditions for d - tdma to be optimal at an arbitrary fading state :    [ theorem : tdma opt conditions st st ] d - tdma is optimal at an arbitrary fading state for achieving the ergodic sum capacity of the fading c - mac under the st - tpc jointly with the st - ipc if and only if there exists one user @xmath70 ( the user that transmits ) that satisfies both of the following two conditions .",
    "let @xmath74 be any of the other users , @xmath98 , and @xmath145 .",
    "* @xmath146 ; * @xmath147 .",
    "the optimal transmit power of user @xmath70 is @xmath148",
    ".    please refer to appendix [ appendix : proof tdma opt conditions st st ] .",
    "from ( [ eq : sum capacity bc new ] ) , the ergodic sum capacities for the siso fading c - bc under different mixed tpc and ipc constraints can be obtained as the optimal values of the following optimization problems :    [ prob : bc ] @xmath149 \\nonumber \\\\ \\mathtt { s.t . } & ~ ( \\ref{eq : lt tpc bc } ) , ( \\ref{eq : lt ipc bc } ) \\ ( { \\rm case \\ i : \\ lt - tpc \\ and \\",
    "lt - ipc } ) \\nonumber \\\\ & ~ { \\rm or } ~ ( \\ref{eq : lt tpc bc } ) , ( \\ref{eq : st ipc bc } ) \\",
    "( { \\rm case \\ ii : lt - tpc \\   and \\ st - ipc } ) \\nonumber \\\\ & ~ { \\rm or } ~   ( \\ref{eq : st tpc bc } ) , ( \\ref{eq : lt ipc bc } ) \\ ( { \\rm case \\ iii : \\ st - tpc \\ and \\ lt - ipc } ) \\nonumber \\\\ & ~ { \\rm or } ~   ( \\ref{eq : st tpc bc } ) , ( \\ref{eq : st ipc bc } ) \\ ( { \\rm case \\ iv : \\ st - tpc \\ and \\ st - ipc } ) . \\nonumber\\end{aligned}\\ ] ]    notice that in ( [ eq : lt tpc bc])-([eq : st ipc bc ] ) , the transmit power of the secondary bs at a given fading state , @xmath30 , needs to be replaced by the user sum - power in the dual c - mac , @xmath40 . compared with the problems addressed in section [ sec : mac ] for the c - mac ,",
    "it is easy to see that the corresponding problems in the c - bc case are very similar , e.g. , both have the same objective function , and similar affine constraints in terms of @xmath15 s or @xmath150 s .",
    "thus , we skip the details of derivations and present the results directly in the following theorem :    [ theorem : tdma opt conditions bc ] in each of cases i - iv , d - tdma is optimal across all the fading states for achieving the ergodic sum capacity of the fading c - bc . in each case , the user @xmath70 with the largest @xmath151 among all the users should be selected for transmission at a particular fading state . the optimal rule for assigning the transmit power of the bs at each fading state ( for conciseness @xmath29",
    "is dropped in the following expressions ) in each case is given below .",
    "let @xmath74 be any of the users other than @xmath70 , @xmath98 ; @xmath152 ; and @xmath153 and @xmath46 s are the optimal dual variables associated with the lt - tpc in ( [ eq : lt tpc bc ] ) and the lt - ipc in ( [ eq : lt ipc bc ] ) , respectively , if they appear in any of the following cases .",
    "* case i : @xmath154 * case ii : @xmath155 * case iii : @xmath156 * case iv : @xmath157    in the case of the traditional fading siso - bc without the lt- or st - ipc , by combining the results in @xcite for the fading siso - mac and the mac - bc duality results in @xcite , it can be inferred that it is optimal to deploy d - tdma by transmitting to the user with the largest @xmath151 at each time in terms of maximizing the ergodic sum capacity , regardless of the lt- or st - tpc at the bs .",
    "theorem [ theorem : tdma opt conditions bc ] can thus be considered as the extensions of such result to the siso fading c - bc under the additional lt- or st - ipc .",
    "also notice that the optimal power allocation strategies in ( [ eq : bc power opt 1])-([eq : bc power opt 3 ] ) resemble the well - known `` water - filling ( wf ) '' solutions for the single - user fading channels @xcite , @xcite .",
    "in this section , we present numerical results on the performances of the proposed multiuser dra schemes for some example fading cr networks under different mixed transmit - power and interference - power constraints , namely : case i : lt - tpc with ( w/ ) lt - ipc ; case ii : lt - tpc w/ st - ipc ; case iii : st - tpc w/ lt - ipc ; and case iv : st - tpc w/ st - ipc . for simplicity",
    ", we consider symmetric multiuser channels where all channel complex coefficients are independent cscg random variables distributed as @xmath11 . in total , @xmath158 randomly generated channel power gain vectors for @xmath12 or @xmath29 are used to approximate the actual ergodic sum - rate of the secondary network in each simulation result .",
    "furthermore , we assume that the tpc ( lt or st ) values are identical for all sus , and the ipc ( lt or st ) values are identically equal to one , the same as the additive gaussian noise variance , at all prs . for convenience ,",
    "we use @xmath159 to stand for all @xmath160 s and @xmath161 s , @xmath162 for both @xmath163 and @xmath164 , and @xmath165 for all @xmath166 s and @xmath167 s .",
    "the simulation results are presented in the following subsections .",
    "first , we compare the achievable ergodic sum capacities for the fading cr network under four different cases of mixed tpc and ipc .",
    "[ fig : mac ] shows the results for the fading c - mac with @xmath168 and @xmath3 , and fig .",
    "[ fig : bc ] for the fading c - bc with @xmath169 and @xmath170 .    for the c - mac case",
    ", it is observed in fig .",
    "[ fig : mac ] that the ergodic sum capacity @xmath41 in case i is always the largest while that in case iv is the smallest for any given su transmit power constraint @xmath159 .",
    "this is as expected since both the st - tpc and st - ipc are less favorable from the su s perspective as compared to their lt counterparts : the former one imposes more stringent power constraints than the latter one over the dra in the su network .",
    "it is also observed that as @xmath159 increases , eventually @xmath41 becomes saturated as the ipc ( lt or st ) becomes more dominant than the tpc . on the other hand , for small values of @xmath159 where the tpc is more dominant than the ipc , it is observed that the lt - tpc ( where d - tdma is optimal in case i and close to being optimal in case ii ) leads to a capacity gain over the st - tpc ( where d - tdma is non - optimal in case iii or iv ) due to the well - known _ multiuser diversity _ effect exploited by d - tdma @xcite .",
    "furthermore , @xmath41 in case ii is observed to be initially larger than that in case iii for small values of @xmath159 , but becomes equal to and eventually smaller than that in case iii as @xmath159 increases .",
    "this is due to the facts that for small values of @xmath159 , tpc dominates ipc and furthermore lt - tpc is more flexible over st - tpc ; while for large values of @xmath159 , ipc becomes more dominant over tpc and lt - ipc is more flexible over st - ipc .    for the c - bc case ,",
    "similar results like those in the c - mac are observed .",
    "however , there exists one quite different phenomenon for the c - bc .",
    "as the secondary bs transmit power @xmath162 becomes large , the achievable ergodic sum capacity @xmath42 shown in fig .",
    "[ fig : bc ] under the lt - ipc is much larger than that under the st - ipc , regardless of the lt- or st - tpc , as compared with @xmath171 shown in fig .",
    "[ fig : mac ] .",
    "this is due to the fact that for the c - bc with @xmath170 and a single bs transmitter , the st - ipc can limit the transmit power of the secondary bs more stringently than the case of c - mac shown in fig .",
    "[ fig : mac ] , where there are two su transmitters but only a single pr .",
    "since it is not always the case that both channels from the two sus to the pr have very large gains at a given time , in the c - mac case the su with the smallest instantaneous channel gain to the pr can be selected for transmission , i.e. , there exists an interesting _ new form of multiuser diversity effect _ in the fading c - mac .",
    "in contrast , for the c - bc , the bs is likely to transmit with large power only if both channel gains from the bs to the two prs are reasonably low .",
    "next , we consider the fading c - mac and examine the effect of the tdma constraint on its achievable ergodic sum capacity .",
    "notice that for the fading c - bc , it has been shown in theorem [ theorem : tdma opt conditions bc ] that d - tdma is optimal for all cases of mixed tpc and ipc ; and for the fading c - mac , it has also been shown in theorem [ theorem : tdma opt lt lt ] that d - tdma is optimal in case i. therefore , in this subsection , we only consider the fading c - mac in cases ii , iii , and iv .",
    "we compare the ergodic sum capacity @xmath171 achievable in each of these cases via the optimal dra rule proposed in this paper w / o the tdma constraint against that with an explicit tdma constraint , i.e. , at most one su is selected for transmission at any time .",
    "however , for the cases with the explicit tdma constraint , we still allow dra over the su network to optimally select the su ( i.e. , using d - tdma ) and set its power level for transmission at each fading state , so as to maximize the long - term average sum - rate . for conciseness",
    ", we discuss the optimal dra schemes for the fading c - mac under the explicit tdma constraint in appendix [ appendix : tdma ] .    in figs .",
    "[ fig : mac tdma 2 ] and [ fig : mac tdma ] , we compare the achievable @xmath41 w/ vs. w / o the tdma constraint for cases ii - iv with @xmath168 , @xmath3 , and @xmath172 , respectively .",
    "it is observed in both figures that the achievable @xmath41 in each case of mixed tpc and ipc is larger without the tdma constraint .",
    "this is as expected since tdma is an additional constraint that limits the flexibility of dra in the su network .    in fig .",
    "[ fig : mac tdma 2 ] , it is observed that the gap between the achievable @xmath41 s w/ and w / o the tdma constraint in each of cases ii - iv diminishes as the su transmit power constraint @xmath159 becomes sufficiently large . this phenomenon can be explained as follows .",
    "first , note that as @xmath159 increases , eventually the tpc will become inactive and the ipc becomes the only active power constraint in each case . as a result ,",
    "case ii and case iv only have the ( same ) st - ipc and case iii only has the lt - ipc as active constraints .",
    "thus , the observed phenomenon is justified since d - tdma has been shown to be optimal for the above two cases , according to corollary [ corol : lt st ] ( notice that @xmath3 for fig .",
    "[ fig : mac tdma 2 ] ) and theorem [ theorem : tdma opt lt lt ] ( with all @xmath45 s taking a zero value ) , respectively .",
    "however , in fig .",
    "[ fig : mac tdma ] with @xmath173 , only case iii has the same converged @xmath41 w/ and w / o the tdma constraint as @xmath159 becomes large , according to theorem [ theorem : tdma opt lt lt ] .",
    "in general , the capacity gap between cases w/ and w / o the tdma constraint becomes larger as @xmath0 or @xmath1 increases , as observed by comparing figs .",
    "[ fig : mac tdma 2 ] and [ fig : mac tdma ] . for example ,",
    "for case ii , in fig . [",
    "fig : mac tdma 2 ] with @xmath3 , the capacity gap is negligible for all values of @xmath159 , which is consistent with lemma [ lemma : tdma opt lt st ] ; but it becomes notably large in fig .",
    "[ fig : mac tdma ] with @xmath170 .      at last , we compare the ergodic sum capacity achievable with the optimal dra against the achievable average sum - rate of users via some heuristic fixed resource allocation ( fra ) schemes for the same fading cr network .",
    "for dra , we select the most flexible power allocation scheme for the su network under the lt - tpc and the lt - ipc ( i.e. , case i ) , which is d - tdma based and gives the largest @xmath171 and @xmath42 among all cases of mixed power constraints under the same power - constraint values @xmath159 ( @xmath162 ) and @xmath165 for the fading c - mac ( c - bc ) . for fra ,",
    "we also consider tdma , which uses the simple `` round - robin '' user scheduling rule , under the st - tpc and the st - ipc .",
    "more specifically , for the fading c - mac , at each time the su , say user @xmath70 , which is scheduled for transmission , will transmit a power equal to @xmath174 , while for the fading c - bc , the bs transmits with the power equal to @xmath175 .",
    "notice that the considered fra can be much more easily implemented as compared to the proposed optimal dra .",
    "therefore , we need to examine the capacity gains by the optimal dra over the fra .    in fig .",
    "[ fig : mac comp ] , capacity comparisons between dra and fra are shown for the fading c - mac with @xmath168 or @xmath176 , and @xmath170 . notice that for the dra case we have normalized the su lt - tpc for @xmath177 by a factor of @xmath178 such that the sum of user transmit power constraints for both @xmath168 and @xmath177 are identical .",
    "furthermore , for fair comparison between dra and fra , the su st - tpc values in the fra case are @xmath176 and @xmath178 times the lt - tpc value in the dra for @xmath177 and @xmath168 , respectively .",
    "it is observed that dra achieves substantial throughput gains over fra for both @xmath168 and @xmath177 .",
    "notice that for fra , it can be easily shown that with the user power normalization , the average sum - rate is statistically independent of @xmath0 .",
    "furthermore , multiuser diversity gains in the achievable ergodic sum - rate for the dra are also observed by comparing @xmath177 against @xmath168 , given the same sum of user power constraints .    in fig .",
    "[ fig : bc comp ] , we show the capacity comparisons between the fading c - bc with dra and that with fra , for a fixed secondary bs transmit power constraint @xmath179db , @xmath3 or @xmath176 , and different values of @xmath0 .",
    "since there is only one transmitter at the bs for the c - bc , there is no user power normalization required as in the c - mac case .",
    "the capacity gains by dra over fra are observed to become more significant for both @xmath3 and @xmath180 cases , as @xmath0 increases , due to the multiuser diversity effect . as an example , at @xmath181 , the capacities with dra are @xmath182 and @xmath183 times of that with fra , for @xmath3 and @xmath180 , respectively .",
    "this suggests that in contrast to the conventional fading bc without any ipc , the multiuser diversity gains obtained by the optimal dra become more crucial to the fading c - bc as the number of prs , @xmath1 , becomes larger .",
    "in this paper , we have studied the information - theoretic limits of the cr network under wireless spectrum sharing with an existing primary radio network . by applying the interference - power constraint as a practical means to protect each primary link ,",
    "we characterize the achievable ergodic sum capacity of the fading c - mac and c - bc under different mixed lt-/st - tpc and lt-/st - ipc .",
    "optimal dra schemes for both cases w/ and w / o a tdma constraint are presented .",
    "interestingly , except the cases where the optimality of d - tdma can be analytically proved , it is verified by simulation that there are also many circumstances where d - tdma with the optimal user scheduling and power control performs very closely to the optimal non - tdma - based schemes in the fading c - mac .",
    "furthermore , an interesting new form of multiuser diversity is observed for the fading c - mac by exploiting the additional csi of channels between secondary transmitters and primary receivers , which differs from that in the conventional fading mac by exploiting only the csi of channels between secondary users and bs .",
    "finally , it is worth pointing out that with the techniques introduced in this paper , it is possible to derive the optimal resource allocation for the more general cases where all lt / st tpc and ipc are present , and/or secondary users have different priorities for rate allocation ( i.e. , characterization of the capacity region instead of the sum capacity ) .",
    "moreover , the results in this paper are also applicable to the general channel models consisting of parallel gaussian channels over which the average and instantaneous ( transmit or interference ) power constraints can be applied , e.g. , the frequency - selective fading broadband channel which is decomposable into parallel narrow - band channels at each fading state via the well - known orthogonal - frequency - division - multiplexing ( ofdm ) modulation / demodulation .",
    "suppose that there are two arbitrary users @xmath70 and @xmath74 with @xmath125 and @xmath184 . from ( [ eq : kkt2 lt lt ] )",
    ", it follows that @xmath185 and @xmath186 .",
    "applying this fact to ( [ eq : kkt1 lt lt ] ) , the following equality must hold : @xmath187 since @xmath151 and @xmath188 s are independent of @xmath189 and @xmath190 s , and furthermore @xmath191 , @xmath192 , and @xmath46 s are all constants in problem [ prob : lt lt mac per state ] , it can be inferred that the above equality is satisfied with a zero probability .",
    "thus , it is concluded that there is at most one user with a strictly positive power value .",
    "let user @xmath70 be the user that can transmit , i.e , @xmath73 , while for the other users @xmath193 , @xmath75 .",
    "problem [ prob : lt lt mac per state ] then becomes the maximization of @xmath194 subject to @xmath195 , for which @xmath196 given in ( [ eq : opt power lt lt ] ) can be easily shown to be the optimal solution .",
    "next , we need to show that for the selected user @xmath70 for transmission , if @xmath125 , it must satisfy ( [ eq : user ordering lt lt ] ) . since @xmath125 , from ( [ eq : kkt2 lt lt ] ) it follows that @xmath185 . since @xmath197 , from ( [ eq : kkt1 lt lt ] ) , it follows that @xmath198 from which ( [ eq : user ordering lt lt ] ) can be obtained .",
    "suppose that there are @xmath199 users with @xmath184 , where @xmath200 and @xmath201 .",
    "then from ( [ eq : kkt3 lt st ] ) , it follows that @xmath186 , if @xmath200 .",
    ". from ( [ eq : kkt1 lt st ] ) , the following equalities must hold : @xmath203 removing @xmath204 in the above equations yields @xmath205 where @xmath70 is an arbitrary user index in @xmath206 . notice that in ( [ eq : lt st equalities ] ) there are @xmath1 variables @xmath207 ,  , @xmath208 , but @xmath209 independent equations ( with probability one ) .",
    "therefore , @xmath210 must hold in order for the above equations to have at least one set of solutions .",
    "it then concludes that @xmath199 must be no greater than @xmath2 .      since @xmath75 , @xmath125 , from ( [ eq : kkt2 st lt ] ) and ( [ eq : kkt3 st lt ] ) it follows that @xmath234 and @xmath185 , respectively .",
    "then , from ( [ eq : kkt1 st lt ] ) it follows that @xmath235 from the above two inequalities , lemma [ lemma : opt 1 st lt ] can be easily shown .",
    "the following lemma is required for the proof of lemma [ lemma : opt 2 st lt ] :    [ lemma : opt 3 st lt ] the optimal solution of problem [ prob : st lt mac per state ] has at most one user , indexed by @xmath70 , which satisfies @xmath236 , where @xmath237 ; and the optimal sum - power of transmitting users must satisfy @xmath238 .",
    "suppose that there are two users @xmath70 and @xmath74 with @xmath236 and @xmath239 . from ( [ eq : kkt2 st lt ] ) and ( [ eq : kkt3 st lt ] )",
    ", it follows that @xmath240 and @xmath241 , respectively . using these facts , from ( [ eq : kkt1 st lt ] )",
    ", it follows that the following two equalities must hold at the same time : @xmath242 thus , we have @xmath243 since @xmath151 and @xmath188 s are independent of @xmath189 and @xmath190 s , and @xmath46 s are constants , it is inferred that the above equality is satisfied with a zero probability .",
    "thus , we conclude that there is at most one user @xmath70 with @xmath244 . from ( [ eq : sum power st lt ] )",
    ", we have @xmath245 using ( [ eq : kkt1 st lt ] ) and ( [ eq : equality st lt ] ) , it is easy to see that for any user @xmath246 with @xmath247 , it must satisfy @xmath248 thus , we conclude that @xmath237 .",
    "lemma [ lemma : opt 3 st lt ] suggests that only one of the following two sets of solutions for @xmath249 can be true , which are    * case i : @xmath250 ; * case ii : @xmath251 , and @xmath252 .    since @xmath253",
    ", it then follows that @xmath254    the remaining part to be shown for lemma [ lemma : opt 2 st lt ] is that the optimal number of active users @xmath131 is the largest value of @xmath135 such that @xmath255 first , we show that in both case i and case ii , for any user @xmath256 , the above inequality holds .",
    "since for ( [ eq : inequality st lt ] ) , from lemma [ lemma : opt 1 st lt ] it follows that its left - hand side decreases as @xmath135 increases , while its right - hand side increases with @xmath135 , it is sufficient to show that ( [ eq : inequality st lt ] ) holds for @xmath257 .",
    "this is the case since from ( [ eq : kkt1 st lt ] ) with @xmath258 and @xmath259 , we have @xmath260 next , we show that for any user @xmath261 , ( [ eq : inequality st lt ] ) does not hold .",
    "again , it is sufficient to consider user @xmath262 since if it does not satisfy ( [ eq : inequality st lt ] ) , neither does any of the other users @xmath263 . for user @xmath262 , from ( [ eq : kkt1 st lt ] ) with @xmath264 and @xmath265 , it follows that @xmath266 therefore , it is concluded that ( [ eq : inequality st lt ] ) can be used to determine @xmath131 .",
    "suppose that user @xmath70 transmits with @xmath125 , while for the other users @xmath98 , @xmath75 .",
    "we will consider the following two cases : i ) all @xmath81 s are equal to zero ; ii ) there is one and only one @xmath211 , denoted as @xmath212 , which is strictly positive .",
    "notice that it is impossible for more than one @xmath81 s to be strictly positive at the same time , which can be shown as follows . for user @xmath70 , from ( [ eq : kkt2 lt st ] ) , @xmath213 suggests that @xmath214 .",
    "supposing that there is @xmath215 such that @xmath216 and thus @xmath217 , a contradiction then occurs as @xmath218 holds with a zero probability .",
    "first , we will prove the `` only if '' part of theorem [ theorem : tdma opt conditions lt st ] .",
    "consider initially the case where all @xmath81 s are equal to zero .",
    "suppose that @xmath125 , from ( [ eq : kkt3 lt st ] ) it follows that @xmath185 .",
    "since @xmath219 , from ( [ eq : kkt1 lt st ] ) the followings must be true : @xmath220 thus , user @xmath70 must satisfy @xmath221 .",
    "from ( [ eq : equality lt st ] ) , it follows that @xmath102 in this case .",
    "also notice that from ( [ eq : kkt4 lt st ] ) @xmath222 must hold for @xmath223 .",
    "therefore , we conclude that @xmath224 , where @xmath99 , and thus @xmath225 . therefore , the first set of conditions in theorem [ theorem : tdma opt conditions lt st ] is obtained .    in the second case where there is one and only one @xmath213",
    ", it follows from ( [ eq : kkt2 lt st ] ) that @xmath214 .",
    "since from ( [ eq : kkt4 lt st ] ) we have @xmath226 , it follows that @xmath227 , and thus , again , @xmath99 , and @xmath108 in this case . from ( [ eq : kkt1 lt st ] ) , we have @xmath228 since @xmath213 , from ( [ eq : opt mu lt st ] ) it follows that @xmath229 . furthermore ,",
    "from ( [ eq : kkt1 lt st ] ) , the followings must be true : @xmath230 thus , we have @xmath231 substituting @xmath212 in ( [ eq : opt mu lt st ] ) into the above inequalities yields @xmath232 @xmath233 .",
    "the second set of conditions in theorem [ theorem : tdma opt conditions lt st ] is thus obtained .",
    "next , the `` if '' part of theorem [ theorem : tdma opt conditions lt st ] can be shown easily by the fact that for a strictly - convex optimization problem , the kkt conditions are not only necessary but also sufficient to be satisfied by the unique set of primal and dual optimal solutions @xcite .",
    "the proof of theorem [ theorem : tdma opt conditions st st ] is also based on the kkt optimality conditions for problem [ prob : st st mac per state ] .",
    "let @xmath80 , @xmath81 , and @xmath267 , @xmath268 be the optimal dual variables associated with the constraints in ( [ eq : constraint 1 st st ] ) , ( [ eq : constraint 2 st st ] ) , and ( [ eq : constraint 3 st st ] ) , respectively .",
    "the kkt conditions can then be expressed as @xmath269 with @xmath270 , and @xmath271 .",
    "first , we will prove the `` only if '' part of theorem [ theorem : tdma opt conditions st st ] .",
    "suppose that user @xmath70 should transmit with @xmath125 , while for the other users @xmath272 , @xmath75 . from ( [ eq : kkt2 st st ] ) and ( [ eq : kkt4 st st ] )",
    ", it follows that @xmath273 and @xmath185 , respectively .",
    "we will show that there is one and only one @xmath211 , denoted as @xmath212 , which is strictly positive .",
    "notice that it is impossible for more than one @xmath81 s to be strictly positive at the same time . for user @xmath70 , from ( [ eq : kkt3",
    "st st ] ) , @xmath213 suggests that @xmath214 .",
    "supposing that there is @xmath215 such that @xmath216 and thus @xmath217 , a contradiction then occurs as @xmath218 holds with a zero probability .",
    "second , we will show that it is also impossible for all @xmath81 s to be zero .",
    "if this is the case , ( [ eq : kkt1 st st ] ) for any user @xmath193 , becomes @xmath274 .",
    "this can be true only when @xmath275 , which occurs with a zero probability .",
    "therefore , we conclude that there is one and only one @xmath213 .    since @xmath214 and from ( [ eq : kkt6 st st ] ) we have @xmath226 , it follows that @xmath227 , and thus @xmath99 and @xmath108 . also notice from ( [ eq : kkt5 st st ] ) that in this case @xmath276 must hold . at last , considering ( [ eq : kkt1",
    "st st ] ) for user @xmath70 and any other user @xmath74 , we have @xmath277 thus , we conclude that @xmath278 , must hold .",
    "next , the `` if '' part of theorem [ theorem : tdma opt conditions st st ] follows due to the fact that for a strictly - convex optimization problem , the kkt conditions are both necessary and sufficient for the unique set of primal and dual optimal solutions @xcite .",
    "in this appendix , we formally derive the optimal rule of user selection and power control to achieve the ergodic sum capacity for the siso fading c - mac _ under an explicit tdma constraint _",
    ", in addition to any combination of transmit - power and interference - power constraints .",
    "the tdma constraint implies that at each fading state there is only one su that can transmit .",
    "let @xmath279 be a mapping function that gives the index of the su selected for transmission at a fading state with channel realization @xmath12 .",
    "note that for this particular fading state , @xmath280 , while for the other sus @xmath281 , @xmath282 , @xmath283 .",
    "the ergodic sum capacity of the fading c - mac under tdma constraint can be obtained as @xmath284\\ ] ] where @xmath24 is specified by a particular combination of power constraints described in ( [ eq : lt tpc mac])-([eq : st ipc mac ] ) .",
    "clearly , for any given function @xmath279 , the capacity maximization in ( [ eq : sum capacity mac tdma ] ) over @xmath24 is a convex optimization problem .",
    "however , the maximization over the function @xmath279 may not be necessarily convex , and thus standard convex optimization techniques may not apply directly .",
    "fortunately , it will be shown next that the optimization problem in ( [ eq : sum capacity mac tdma ] ) can be efficiently solved for all considered cases of mixed lt-/st - tpc and lt-/st - ipc .      from ( [ eq : sum capacity mac tdma ] ) , the ergodic sum capacity under the tdma constraint , as well as the lt - tpc in ( [ eq : lt tpc mac ] ) and the lt - ipc in ( [ eq : lt ipc mac ] ) can be obtained by solving the following optimization problem :    [ prob : lt lt mac tdma ] @xmath285 \\nonumber \\\\ \\mathtt { s.t . } & ~~ \\mathbb{e}\\left[p_k({\\mbox{\\boldmath{$ \\alpha $ } } } ) \\cdot{\\mbox{\\boldmath{$ 1 $ } } } ( \\pi({\\mbox{\\boldmath{$ \\alpha $ } } } ) = k)\\right]\\leq p^{\\rm lt}_k , \\ \\forall k \\label{eq : lt tpc mac tdma } \\\\ & ~~ \\mathbb{e}\\left[g_{\\pi({\\mbox{\\boldmath{$ \\alpha $ } } } ) m}p_{\\pi({\\mbox{\\boldmath{$ \\alpha $ } } } ) } ( { \\mbox{\\boldmath{$ \\alpha $ } } } ) \\right]\\leq \\gamma^{\\rm lt}_m , \\",
    "\\forall m \\label{eq : lt ipc mac tdma}\\end{aligned}\\ ] ] where @xmath286 is the indicator function taking the values of 1 or 0 depending on the trueness or falseness of event @xmath287 , respectively .",
    "@xmath288 -\\sum_{k=1}^k\\lambda_k\\left\\ { \\mathbb{e}\\left[p_k({\\mbox{\\boldmath{$ \\alpha $ } } } ) \\cdot{\\mbox{\\boldmath{$ 1 $ } } } ( \\pi({\\mbox{\\boldmath{$ \\alpha $ } } } ) = k)\\right]- p^{\\rm lt}_k\\right\\ } -\\sum_{m=1}^m\\mu_m\\left\\{\\mathbb{e}\\left[g_{\\pi({\\mbox{\\boldmath{$ \\alpha $ } } } ) m}p_{\\pi({\\mbox{\\boldmath{$ \\alpha $ } } } ) } ( { \\mbox{\\boldmath{$ \\alpha $ } } } ) \\right]- \\gamma^{\\rm lt}_m\\right\\}\\end{aligned}\\ ] ]    first , we write the lagrangian of this problem , @xmath289 , as in ( [ eq : lagrangian lt lt tdma ] ) ( shown on the next page ) , where @xmath45 and @xmath46 are the nonnegative dual variables associated with the corresponding constraints in ( [ eq : lt tpc mac tdma ] ) and ( [ eq : lt ipc mac tdma ] ) , respectively , @xmath16 , @xmath19 .",
    "then , the lagrange dual function , @xmath47 , is defined as @xmath290 the dual problem is accordingly defined as @xmath291 . since the problem at hand may not be convex , the duality gap between the optimal values of the original and the dual problems may not be zero .",
    "however , it will be shown in the later part of this subsection that the duality gap for problem [ prob : lt lt mac tdma ] is indeed zero .",
    "we consider only the maximization problem in ( [ eq : lagrange dual lt lt tdma ] ) for obtaining @xmath47 with some given @xmath45 s and @xmath46 s , while the minimization of @xmath47 over @xmath45 s and @xmath46 s can be obtained by the ellipsoid method , since it is always a convex optimization problem . for each fading state ,",
    "the maximization problem in ( [ eq : lagrange dual lt lt tdma ] ) can be expressed as ( with @xmath12 dropped for brevity )      for any given user @xmath293 , the optimal power solution for the above problem can be obtained as @xmath294 substituting this solution into the objective function of problem [ prob : lt lt mac per state tdma ] yields @xmath295 it is easy to verify that the maximization of the above function over @xmath293 is attained with user @xmath70 that satisfies @xmath296 from ( [ eq : opt power lt lt tdma ] ) and ( [ eq : user ordering lt lt tdma ] ) , it follows that the same set of solutions for problem [ prob : lt lt mac per state ] without the tdma constraint , which is given in lemma [ lemma : opt power user lt lt ] , also holds for problem [ prob : lt lt mac per state tdma ] with the tdma constraint .",
    "note that the optimal solutions of problem [ prob : lt lt mac ] without the tdma constraint are also tdma - based , and thus they are also feasible solutions to problem [ prob : lt lt mac tdma ] with the tdma constraint .",
    "since these solutions have also been shown in the above to be optimal for the dual problem of problem [ prob : lt lt mac tdma ] , we conclude that the duality gap is zero for problem [ prob : lt lt mac tdma ] ; and both problem [ prob : lt lt mac ] and problem [ prob : lt lt mac tdma ] have the same set of solutions .",
    "[ [ long - term - transmit - power - and - short - term - interference - power - constraints-1 ] ] long - term transmit - power and short - term interference - power constraints ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~      [ prob : lt st mac tdma ] @xmath297 \\nonumber \\\\ \\mathtt { s.t . } & & ( \\ref{eq : lt tpc mac tdma } ) \\nonumber \\\\ & & g_{\\pi({\\mbox{\\boldmath{$ \\alpha $ } } } ) m}p_{\\pi({\\mbox{\\boldmath{$ \\alpha $ } } } ) } ( { \\mbox{\\boldmath{$ \\alpha $ } } } ) \\leq \\gamma^{\\rm st}_m , \\",
    "\\forall { \\mbox{\\boldmath{$ \\alpha $ } } } , m. \\label{eq : st ipc mac tdma}\\end{aligned}\\ ] ]    similarly as for problem [ prob :",
    "lt lt mac tdma ] , we apply the lagrange duality method for solving the above problem by introducing the nonnegative dual variables @xmath298 , associated with the lt - tpc given in ( [ eq : lt tpc mac tdma ] ) .",
    "however , since problem [ prob : lt st mac tdma ] is not necessarily convex , the duality gap for this problem may not be zero .",
    "nevertheless , it can be verified that problem [ prob : lt st mac tdma ] satisfies the so - called `` time - sharing '' conditions @xcite and thus has a zero duality gap . for brevity , we skip the details of derivations here and present the optimal power - control policy in this case as follows :    in the optimal solution of problem [ prob : lt st mac tdma ] , the user @xmath279 that transmits at a fading state with channel realization @xmath12 maximizes the following expression among all the users ( with @xmath12 dropped for brevity ) : @xmath299 where @xmath300 and @xmath298 , are the optimal dual solutions obtained by the ellipsoid method .",
    "[ [ short - term - transmit - power - and - long - term - interference - power - constraints-1 ] ] short - term transmit - power and long - term interference - power constraints ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~      [ prob : st lt mac tdma ] @xmath297 \\nonumber \\\\ \\mathtt { s.t . } & & p_{\\pi({\\mbox{\\boldmath{$ \\alpha $ } } } ) } ( { \\mbox{\\boldmath{$ \\alpha $ } } } ) \\leq p^{\\rm st}_{\\pi({\\mbox{\\boldmath{$ \\alpha $ } } } ) } , \\",
    "\\forall { \\mbox{\\boldmath{$ \\alpha $ } } } \\label{eq : st tpc mac tdma } \\\\ & & ( \\ref{eq : lt ipc mac tdma } ) .",
    "\\nonumber\\end{aligned}\\ ] ]    by introducing the nonnegative dual variables @xmath301 , associated with the lt - ipc given in ( [ eq : lt ipc mac tdma ] ) , problem [ prob : st lt mac tdma ] can be solved similarly as for problem [ prob : lt st mac tdma ] by the lagrange duality method .",
    "for brevity , we present the optimal power - control policy in this case directly as follows :    in the optimal solution of problem [ prob : st lt mac tdma ] , the user @xmath279 that transmits at a fading state with channel realization @xmath12 maximizes the following expression among all the users ( with @xmath12 dropped for brevity ) : @xmath302 where @xmath303 and @xmath301 , are the optimal dual solutions obtained by the ellipsoid method .          in this case",
    ", all the constraints are separable over the fading states and , thus , this problem is decomposable into independent subproblems each for one fading state . for brevity",
    ", we present the optimal power - control policy in this case directly as follows :    in the optimal solution of problem [ prob : st st mac tdma ] , the user @xmath279 that transmits at a fading state with channel realization @xmath12 maximizes the following expression among all the users ( with @xmath12 dropped for brevity ) : @xmath304 where @xmath305          c. cordeiro , k. challapali , d. birru , and n. s. shankar , `` ieee 802.22 : the first worldwide wireless standard based on cognitive radios , '' in _ proc .",
    "ieee symp .",
    "new frontiers in dynamic spectrum access networks ( dyspan ) _ , pp .",
    "328 - 337 , nov . 2005 .",
    "x. kang , y. c. liang , a. nallanathan , h. garg , and r. zhang , `` optimal power allocation for fading channels in cognitive radio networks : ergodic capacity and outage capacity , '' _ ieee trans .",
    "wireless commun .",
    "_ , vol . 8 , no .",
    "940 - 950 , feb . 2009 .",
    "y. xing , c. n. mathur , m. a. haleem , r. chandramouli , and k. p. subbalakshmi , `` dynamic spectrum access with qos and interference temperature constraints , '' _ ieee trans .",
    "mobile computing _ , vol",
    "423 - 433 , apr . 2007 .",
    "d. tse and s. hanly , `` multi - access fading channels - part i : polymatroid structure , optimal resource allocation and throughput capacities , '' _ ieee trans .",
    "inf . theory _ ,",
    "44 , no . 7 , pp . 2796 - 2815 , nov .",
    "1998 .",
    "s. shamai and a. d. wyner , `` information theoretic considerations for symmetric , cellular , multiple access fading channels - part i , '' _ ieee trans .",
    "inf . theory _ ,",
    "43 , no . 6 , pp .",
    "1877 - 1894 , nov . 1997"
  ],
  "abstract_text": [
    "<S> this paper studies the information - theoretic limits of a secondary or cognitive radio ( cr ) network under spectrum sharing with an existing primary radio network . in particular , the fading cognitive multiple - access channel ( c - mac ) is first studied , where multiple secondary users transmit to the secondary base station ( bs ) under both individual transmit - power constraints and a set of interference - power constraints each applied at one of the primary receivers . </S>",
    "<S> this paper considers the long - term ( lt ) or the short - term ( st ) transmit - power constraint over the fading states at each secondary transmitter , combined with the lt or st interference - power constraint at each primary receiver . in each case , the optimal power allocation scheme is derived for the secondary users to achieve the ergodic sum capacity of the fading c - mac , as well as the conditions for the optimality of the dynamic time - division - multiple - access ( d - tdma ) scheme in the secondary network . the fading cognitive broadcast channel ( c - bc ) that models the downlink transmission in the secondary network is then studied under the lt / st transmit - power constraint at the secondary bs jointly with the lt / st interference - power constraint at each of the primary receivers . </S>",
    "<S> it is shown that d - tdma is indeed optimal for achieving the ergodic sum capacity of the fading c - bc for all combinations of transmit - power and interference - power constraints .    </S>",
    "<S> broadcast channel , cognitive radio , convex optimization , dynamic resource allocation , ergodic capacity , fading channel , interference temperature , multiple - access channel , spectrum sharing , time - division - multiple - access .    </S>",
    "<S> [ section ] [ section ] [ section ] [ section ] [ section ] [ section ] [ section ] </S>"
  ]
}