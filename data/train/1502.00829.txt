{
  "article_text": [
    "a principal aim of many sciences is to model causal systems well enough to provide sound insight into their structures and mechanisms and to provide reliable predictions about the effects of policy interventions .",
    "the modeling process is typically divided into two distinct phases : a model specification phase in which some model ( with free parameters ) is specified , and a parameter estimation and statistical testing phase in which the free parameters of the specified model are estimated and various hypotheses are put to a statistical test . both model specification and parameter estimation",
    "can fruitfully be thought of as search problems .",
    "as pointed out in @xcite , common statistical wisdom dictates that causal effects can not be consistently estimated from observational studies alone unless one observes and adjusts for all possible confounding variables , and knows the time order in which events occurred .",
    "however , @xcite and @xcite developed a framework in which causal relationships are represented by edges in a directed acyclic graph .",
    "they also described asymptotically consistent procedures for determining features of causal structure from data even if we allow for the possibility of unobserved confounding variables and/or an unknown time order , under two assumptions : the causal markov assumption ( roughly , given no unmeasured common causes , each variable is independent of its noneffects conditional on its direct causes ) and the causal faithfulness assumption ( all conditional independence relations that hold in the distribution are entailed by the causal markov assumption ) . under these assumptions , the procedures they propose ( e.g. , the _ sgs _ and the _ pc _ algorithms assuming no unmeasured common causes , and the _ fci _ algorithm which does not assume no unmeasured common causes ) can infer the existence or absence of causal relationships . in particular , spirtes et al .",
    "( @xcite ) , chapters  5 and 6 , proved the fisher consistency of these procedures .",
    "pointwise consistency follows from the fisher consistency and the uniform consistency of the test procedures for conditional independence relationships in certain parametric families that the procedures use .",
    "@xcite proved that under the causal markov and faithfulness assumptions made in @xcite there are no uniformly consistent procedures for estimating features of the causal structure from data , even when there are no unmeasured common causes .",
    "@xcite , @xcite and @xcite introduced a strong causal faithfulness assumption , which , roughly speaking , assumes that no conditional independence relation not entailed by the causal markov assumption `` almost '' holds . @xcite",
    "and @xcite showed that under this strengthened causal faithfulness assumption , some modifications of the pointwise consistent procedures developed in @xcite are uniformly consistent .",
    "@xcite have also successfully applied these procedures to various biological data sets , experimentally confirming some of the causal inferences made by the procedures .",
    "however , the question remains whether the strong causal faithfulness assumption made by @xcite is too strong .",
    "is it likely to be true ?",
    "some analysis done by @xcite indicates that the strengthened causal faithfulness assumption is likely to be false , especially when there are a large number of variables .    in this paper",
    "we investigate a number of different ways in which the strengthened causal faithfulness assumption can be weakened , while still retaining the guarantees of uniformly consistent estimation by modifying the causal estimation procedures .",
    "it is not clear whether the ways we propose to weaken the strong causal faithfulness assumption make it substantially more likely to hold , nor is it clear that all of the modifications that we propose to the estimation procedures make them substantially more accurate in practice .",
    "nevertheless , we believe that the modifications that we propose are a useful first step toward investigating fruitful modifications of the causal faithfulness assumption and causal estimation procedures .    in section  [ sec2 ] we describe the basic setup and assumptions for causal inference . in section  [ sec3 ] we examine various ways to weaken the causal faithfulness assumption and modifications of the estimation procedures that preserve pointwise consistency . in section  [ sec4 ]",
    "we examine weakening the strong causal faithfulness assumption and modification of the estimation procedures that preserves uniform consistency .",
    "finally , in section  [ sec5 ] we summarize the results and describe areas of future research .",
    "we first introduce the graph terminology that we will use .",
    "individual variables are denoted with italicized capital letters , and sets of variables are denoted with bold - faced capital letters .",
    "a _ graph _ @xmath0 consists of a set of _ vertices _ @xmath1 and a set of _ edges _ @xmath2 , where for each @xmath3 .",
    "if @xmath4 and @xmath5 , there is an _ undirected edge _ between _ x _ and _ y _ , denoted by _",
    "x _  _ y_. if @xmath6 and @xmath7 , there is a directed edge between _ x _ and _ y _ , denoted by @xmath8 . if there is a directed edge from _ x _ to _ y _ , or from _ y _ to _ x _ , or there is an undirected edge between _ x _ and _ y _ , then _ x _ and _ y _ are _ adjacent _ in _",
    "g_. @xmath9 is the set of vertices adjacent to _",
    "x_. if all of the edges in a graph _",
    "g _ are directed edges , then _",
    "g _ is a _ directed graph_. a  _ path _ between @xmath10 and @xmath11 in _ g _ is an ordered sequence of vertices @xmath12 such that for @xmath13 , @xmath14 and @xmath15 are adjacent in _ g_. a path between @xmath10 and @xmath11 in _ g _ is a _ directed path _ if for @xmath16 , the edge between @xmath14 and @xmath15 is a directed edge from @xmath14 to @xmath15 .",
    "a  path is _ acyclic _ if no vertex occurs on the path twice .",
    "a  directed graph is _ acyclic _ ( dag ) if all directed paths are acyclic . _",
    "x _ is a _ parent _ of _ y _ and _ y _ is a _ child _ of _ x _ if there is an edge @xmath8 .",
    "@xmath17 is a _ triangle _ in _ g _ if _ x _ is adjacent to _ y _ and _ z _ , and _ y _ is adjacent to _",
    "suppose _ g _ is a graph .",
    "* parents*(_g _ , _ x _ ) is the set of parents of _ x _ in _ g_. _ x _ is an _ ancestor _ of _ y _ ( and _ y _ is a _ descendant _ of _ x _ ) if there is a directed path from _ x _ to _ y_. a  subset of * v * is _ ancestral _ , if it is closed under the ancestor relation .",
    "a triple of vertices @xmath18 is _ unshielded _ if _ x _ is adjacent to _ y _ and _ y _ is adjacent to _ z _ , but _",
    "x _ is not adjacent to _ z_. a triple of vertices @xmath19 is a _ collider _ if there are edges @xmath20 .",
    "a triple of vertices @xmath18 is a _ noncollider _ if _ x _ is adjacent to _ y _ and _ y _ is adjacent to _ z _ , but it is not a collider .    a probability distribution _ p _ over a set of variables * v * satisfies the ( _ local directed _ ) _ markov condition _ for a dag _",
    "g _ if and only if each variable _ v _ in * v * is independent of the set of variables that are neither parents nor descendants of _ v _ in _ g _ , conditional on the parents of _ v _ in _ g_. a _ bayesian network _ is an ordered pair @xmath21 where @xmath22 satisfies the local directed markov condition for _",
    "g_. if @xmath23 , @xmath24 denotes _ p _ and @xmath25 denotes _ g_. two dags @xmath26 and @xmath27 over the same set of variables * v *",
    "are said to be _ markov equivalent _ if all of the conditional independence relations entailed by satisfying the local directed markov condition for @xmath26 are also entailed by satisfying the local directed markov condition for @xmath27 , and vice versa",
    ". a useful characterization of markov equivalence between dags is that two dags are markov equivalent if and only if they have the same adjacencies and the same unshielded colliders ( @xcite , @xcite ) .",
    "markov equivalence class m _ is a set of dags that contains all dags that are markov equivalent to each other .",
    "a markov equivalence class _ m _ can be represented by a graph called a _ pattern _ ; a  pattern _ o _ is a graph such that ( i ) if @xmath8 in every dag in _ m _ , then @xmath8 in _ o _ ; and ( ii ) if @xmath8 in some dag in _ m _ and @xmath28 in some other dag in _",
    ", then _ x _  _ y _ in _ o_. in that case _ o _ is said to _ represent _ _ m _ and each dag in _",
    "if * x * is independent of * y * conditional on * z * , we write @xmath29 , or if _ x _ , _ y _ , and _ z _ are individual variables @xmath30 . in a dag _",
    ", a vertex _ a _ is _ active _ on an acyclic path _",
    "u _ between _ x _ and _ y _ conditional on set * z * of vertices ( not containing _ x _ or _ y _ ) if @xmath31 or @xmath32 , or _ a _ is a noncollider on _ u _ and not in * z * , or _",
    "a _ is a collider on _ u _ that is in * z * or has a descendant in * z*. an acyclic path _",
    "u _ is _ active _ conditional on a set * z * of vertices if every vertex on the path is active relative to * z*. if @xmath33 and * z * does not contain _ x _ or _ y _ , _ x _ is _ d - separated _ from _ y _ conditional on * z * if there is no active acyclic path between _ x _ and _ y _ conditional on * z * ; otherwise _ x _ and _ y _ are _ d - connected _ conditional on * z*. for three disjoint sets * x * , * y * and * z * , * x * is _ d - separated _ from * y * conditional on * z * if there is no acyclic active path between any member of * x * and any member of * y * conditional on * z * ; otherwise * x * and * y * are _ d - connected _ conditional on * z*. if * x * is d - separated from * y * conditional on * z * in dag _ g _ , then @xmath34 in every probability distribution that satisfies the local directed markov condition for _ g _ ( @xcite , @xcite ) . any conditional independence relation that holds in every distribution that satisfies the local directed markov condition for dag _ g _ is _ entailed by _",
    "g__. note , however , that in some distributions that satisfy the local directed markov condition for _ g _ , some conditional independence relation @xmath34 may hold even if * x * is not d - separated from * y * conditional on * z * in _ g _ ; such distributions are said to be _ unfaithful to g_.    there are a number of different parameterizations of a dag _",
    "g _ , which map _ g _ onto distributions that satisfy the local directed markov condition for _",
    "g_. one common parameterization is a recursive linear gaussian structural equation model .",
    "a recursive linear gaussian structural equation model is an ordered triple @xmath35 , where _ g _ is a dag over a set of vertices @xmath36 , _ eq _ is a set of equations , one for each @xmath15 such that @xmath37 where the @xmath38 are real constants known as the structural coefficients , and the @xmath39 are multivariate gaussian that are jointly independent of each other with covariance matrix @xmath40 .",
    "the @xmath41 are referred to as `` error terms . '' in vector notation , where * x * is the vector of @xmath42 , * b * is the matrix of structural coefficients , and @xmath43 is the vector of error terms , @xmath44 the covariance matrix @xmath45 over the error terms , together with the structural equations , determine a distribution over the variables in * x * , which satisfies the local directed markov condition for _ g_. hence , the dag in a recursive linear gaussian structural equation model _ m _ together with the probability distribution generated by the equations and the covariance matrix over the error terms form a bayesian network . because the joint distribution over the nonerror terms of a linear gaussian structural equation model is multivariate gaussian ,",
    "_ x _ is independent of _ y _ conditional on * z * in @xmath24 if and only if @xmath46 , where @xmath47 denotes the conditional or partial correlation between _ x _ and _ y _ conditional on * z * according to @xmath24 .",
    "let @xmath48 denote the structural coefficient of the @xmath49 edge in @xmath25 .",
    "if there is no edge @xmath49 in @xmath25 , then @xmath50 . if _ x _ and _ z _ are adjacent in @xmath51 , then @xmath52 if there is an @xmath53 edge in @xmath25 , and otherwise @xmath54 .",
    "there is a _ causal interpretation _ of recursive linear gaussian structural equation models , in which setting ( as in an experiment , as opposed to observing ) the value of @xmath15 to the fixed value _ x _ is represented by replacing the structural equation for @xmath15 with the equation @xmath55 . under the causal interpretation ,",
    "a recursive linear structural equation model is a _ causal model _ , the dag @xmath51 is a _ causal dag _ , and the pattern that represents @xmath25 is a _",
    "causal pattern_. a causal model with a set of variables * v * is _ causally sufficient _ when every common direct cause of any two variables in * v * is also in * v*. informally , under a causal interpretation , an edge @xmath8 in @xmath25 represents that _ x _ is a direct cause of _ y _ relative to * v*. a causal model of a population is true when the model correctly predicts the results of all possible settings of any subset of the variables ( @xcite , @xcite ) .",
    "there are two assumptions made about the relationship between the causal dag and the population probability distribution that play a key role in causal inference from observational data .",
    "a discussion of the implications of these assumptions , arguments for them , and a discussion of conditions when they should not be assumed are given in @xcite ( @xcite ) , pages  3242 .",
    "in this paper , we will consider only those cases where the causal relations in a given population can be represented by a model whose graph is a dag .",
    "_ causal markov assumption cma_. if the true causal model _ m _ of a population is causally sufficient , every variable in * v * is independent of the variables that are neither its parents nor descendants in @xmath25 conditional on its parents in @xmath25 .",
    "_ causal faithfulness assumption cfa_. every conditional independence relation that holds in the population probability distribution is entailed by the true causal dag of the population .",
    "the causal markov and causal faithfulness assumptions together entail that * x * is independent of * y * conditional on * z * in the population if and only if * x * is d - separated from * y * conditional on * z * in the true causal graph .",
    "a number of algorithms for causal estimation have been proposed that rely on the assumption of the causal sufficiency of the observed variables , the causal markov assumption and the causal faithfulness assumption .",
    "algorithm ( @xcite , @xcite , page  82 ) , for example , is a fisher consistent estimator of causal patterns under these assumptions .",
    "( this , together with a uniformly consistent test of conditional independence , entails that the _ sgs _ algorithm is a pointwise consistent estimator of causal patterns . )    in this section we explore ways to weaken the causal faithfulness assumption that still allow pointwise consistent estimation of ( features of ) causal structure , and we illustrate the ideas by going through a sequence of generalizations of the population version of the _ sgs _ algorithm .",
    "none of the results in this section depend upon assuming gaussianity or linearity .",
    "the basic idea is that although the causal faithfulness assumption is not fully testable ( without knowing the true causal structure ) , it has testable components given the causal markov assumption . under the causal markov assumption , the causal faithfulness assumption entails that the probability distribution admits a perfect dag representation , that is , a dag that entails all and only those conditional independence relations true of the distribution .",
    "whether there is such a dag depends only on the distribution , and so is , in theory , testable . in principle , then , one may adopt a weaker - than - faithfulness assumption and test ( rather than assume ) the testable part of the faithfulness condition .",
    "the _ sgs _ algorithm takes an oracle of conditional independence as input , and outputs a graph on the given set of variables with both directed edges and undirected edges .    _",
    "sgs algorithm_.    1 .",
    "form the complete undirected graph _",
    "h _ on the given set of variables * v*. 2 .   for each pair of variables _ x _ and _ y _ in * v * , search for a subset * s * of @xmath56 such that _ x _ and _ y _ are independent conditional on * s*. remove the edge between _ x _ and _ y _ in _ h _ if and only if such a set is found .",
    "let _ k _ be the graph resulting from s2 .",
    "for each unshielded triple @xmath57 ( i.e. , _ x _ and _ y _ are adjacent , _ y _ and _ z _ are adjacent , but _",
    "x _ and _ z _ are not adjacent ) , a.   if _ x _ and _ z _ are not independent conditional on any subset of @xmath58 that contains _ y _ , then orient the triple as a collider : @xmath59 . b.   if _ x _ and _ z _ are not independent conditional on any subset of @xmath58 that does not contain _ y _ , then mark the triple as a noncollider ( i.e. , not @xmath20 ) .",
    "4 .   execute the following orientation rules until none of them applies : a.   if @xmath60 , and the triple @xmath61 is marked as a noncollider , then orient @xmath62 as @xmath63 .",
    "b.   if @xmath64 and @xmath65 , then orient @xmath65 as @xmath49 .",
    "c.   if @xmath59 , another triple @xmath66 is marked as a noncollider , and @xmath67 , then orient @xmath67 as @xmath68 .",
    "( this rule was not in the original _ sgs _ or _ pc _ algorithm , but added by @xcite , @xcite . )    assuming the oracle of conditional independence is perfectly reliable ( which we will do throughout this section ) , the _ sgs _ algorithm is correct under the causal markov and faithfulness assumptions , in the sense that its output is the pattern that represents the  markov equivalence class containing the true causal dag ( @xcite , @xcite , page  82 ; @xcite , @xcite ) .",
    "the correctness of _ sgs _ follows from the following three properties of d - separation ( @xcite ) :    _ x _ is adjacent to _ y _ in dag _",
    "g _ if and only if _ x _ is not d - separated from _ y _ conditional on any subset of the other variables in _ g_.    if @xmath57 is an unshielded collider in dag _ g _ , then _ x _ is not d - separated from _ z _ conditional on any subset of the other variables in _ g _ that contains _",
    "y_.    if @xmath57 is an unshielded noncollider in dag _",
    ", then _ x _ is not d - separated from _ z _ conditional on any subset of the other variables in _",
    "g _ that does not contain  _",
    "y_.    we shall not reproduce the full proof here , but a few points are worth stressing . first , s2 is the step of inferring adjacencies and nonadjacencies .",
    "the inferred adjacencies , represented by the remaining edges in the graph resulting from s2 , are correct because of the causal markov assumption alone : every dag markov to the given oracle must contain at least these adjacencies . on the other hand , the inferred nonadjacencies ( via removal of edges ) are correct because of the causal faithfulness assumption , or , more precisely , because of the following consequence of the causal faithfulness assumption , which we , following @xcite , will refer to as adjacency - faithfulness .",
    "_ adjacency - faithfulness assumption_. given a set of variables * v * whose true causal dag is _",
    "g _ , if two variables _ x _ , _ y _ are adjacent in _ g _ , then they are not independent conditional on any subset of @xmath56 .    under the adjacency - faithfulness assumption , any edge removed in s2",
    "is correctly removed , because any dag with the adjacency violates the adjacency - faithfulness assumption .",
    "second , the key step of inferring orientations is step s3 , in which unshielded colliders and noncolliders are inferred .",
    "given that the adjacencies and nonadjacencies are all correct , the clauses ( i ) and ( ii ) in step s3 , as formulated here , are justified by the causal markov assumption alone .",
    "take clause ( i ) , for example .",
    "if the unshielded triple @xmath57 is not a collider in the true causal dag , then the causal markov assumption entails that _ x _ and _ z _ are independent conditional on some set that contains _",
    "y_. that is why clause ( i ) is sound .",
    "a  similar argument shows that clause ( ii ) is sound .",
    "this does not mean , however , that the causal faithfulness assumption does not play any role in justifying s3 .",
    "notice that the antecedent of ( i ) and that of ( ii ) do not exhaust the logical possibilities .",
    "they leave out the possibility that _ x _ and _ z _ are independent conditional on some set that contains _ y _ and independent conditional on some set that does not contain _",
    "y_. this omission is justified by the causal faithfulness assumption , or , more precisely , by the following consequence of the causal faithfulness assumption ( @xcite ) :    _ orientation - faithfulness assumption .",
    "_ given a set of variables * v * whose true causal dag is _",
    ", let @xmath57 be any unshielded triple in _",
    "g _ :    if @xmath59 , then _ x _ and _ z _ are not independent conditional on any subset of @xmath69 that contains  _ y _ ;    otherwise , _ x _ and _ z _ are not independent conditional on any subset of @xmath58 that does not contain  _ y_.    obviously , the possibility left out by s3 is indeed ruled out by the orientation - faithfulness assumption .    the orientation - faithfulness assumption ,",
    "if true , justifies a much simpler and more efficient step than s3 : for every unshielded triple @xmath70 , we need check only the set found in s2 that renders _ x _ and _ z _ independent ; the triple is a collider if and only if the set does not contain _",
    "y_. this simplification is used in the _ pc _ algorithm , a well - known , more computationally efficient rendition of the _ sgs _ procedure ( @xcite , @xcite , pages  8485 ) .",
    "moreover , the adjacency - faithfulness condition also justifies a couple of measures to improve the efficiency of s2 , used by the _ pc _ algorithm .",
    "here we are concerned with showing how the basic _ sgs _ procedure may be modified to be correct under increasingly weaker assumptions of faithfulness , so we will not go into the details of the optimization measures in the _ pc _ algorithm .",
    "whether these or similar measures are available to the modified algorithms we introduce below is an important question to be addressed in future work .",
    "let us start with the modification proposed by @xcite , who observed that assuming the causal markov and adjacency - faithfulness assumptions are true , any failure of the orientation - faithfulness assumption is _ detectable _ , in the sense that the probability distribution in question is not both markov and faithful to any dag ( @xcite , @xcite ) . in our formulation of the _ sgs _ algorithm , it is easy to see how failures of orientation - faithfulness can be detected .",
    "as already mentioned , the role of the orientation - faithfulness assumption in justifying the _ sgs _ algorithm is to guarantee that at the step s3 , either the antecedent of ( i ) or that of ( ii ) will obtain .",
    "therefore , if it turns out that for some unshielded triple neither antecedent is satisfied , the orientation - faithfulness assumption is detected to be false for that triple .",
    "this suggests a simple modification to s3 in the _ sgs _ algorithm .",
    "s3*. let _ k _ be the undirected graph resulting from s2 .",
    "for each unshielded triple @xmath57 ,    if _ x _ and _ z _ are not independent conditional on any subset of @xmath58 that contains _ y _ , then orient the triple as a collider : @xmath59 .    if _ x _ and _ z _ are not independent conditional on any subset of @xmath58 that does not contain _ y _ , then mark the triple as a noncollider .    otherwise , mark the triple as ambiguous ( or unfaithful ) .",
    "@xcite applied essentially this modification to the _ pc _ algorithm and called the resulting algorithm the _ conservative pc cpc _ algorithm .",
    "( their results show that the main optimization measures used in the _ pc _ algorithm still apply to this generalization of _ sgs _ because the adjacency - faithfulness condition is still assumed . )",
    "we will thus call the algorithm that results from replacing s3 with s3 * the _ conservative sgs csgs _ algorithm .",
    "it is straightforward to prove that the _ csgs _ algorithm is correct under the causal markov and the adjacency - faithfulness assumptions alone , in the sense that if the causal markov and adjacency - faithfulness assumptions are true and if the oracle of conditional independence is perfectly reliable , then every adjacency , nonadjacency , orientation and marked noncollider in the output of the _ csgs _ are correct . as pointed out in @xcite , the output of the _ csgs",
    "_ can be understood as an _ extended pattern _ that represents a set of patterns .",
    "for example , a sample output used in @xcite is given in figure  [ peng](a ) .",
    "there are two ambiguous unshielded triples in the output : @xmath71 and @xmath72 , which are marked by crossing straight lines .",
    "note that there is no explicit mark for noncolliders , with the understanding that all and only unshielded triples that are not oriented as colliders or marked as ambiguous are ( implicitly ) marked noncolliders .",
    "figure  [ peng](a ) represents a set of three patterns , depicted in figure  [ peng](b)(d ) .",
    "each pattern results from some disambiguation of the ambiguous triples in figure  [ peng](a ) .",
    "the pattern in figure  [ peng](b ) , for example , results from taking the triple @xmath71 as a noncollider and taking the triple @xmath73 as a collider . note that not every disambiguation results in a pattern .",
    "taking both ambiguous triples as noncolliders would force a directed cycle : @xmath74 , and so would not lead to a pattern .",
    "that is why there are only three instead of four patterns in the set represented by figure  [ peng](a ) .",
    "it is easy to see that when the orientation - faithfulness assumption happens to hold , the _ csgs _ output will be a single pattern ( i.e. , without ambiguous triples ) , which is the same as the _ sgs _ output . in other words ,",
    "_ csgs _ is as informative as _ sgs _ when the stronger assumption needed for the output of the latter to be guaranteed to be correct happens to be true",
    ".    the adjacency - faithfulness assumption may be further weakened . in an earlier paper ( zhang and spirtes , @xcite )",
    ", we showed that some violations of the adjacency - faithfulness assumption are also detectable , and we specified some conditions weaker than the adjacency - faithfulness assumption under which any violation of faithfulness ( and so any violation of adjacency - faithfulness ) is detectable .",
    "one of the weaker conditions is known as the causal minimality assumption ( @xcite , @xcite , page  31 ) , which states that the true causal dag is a minimal dag that satisfies the markov condition with the true probability distribution , minimal in the sense that no proper subgraph satisfies the markov condition .",
    "this condition is a consequence of the adjacency - faithfulness assumption .",
    "if the adjacency - faithfulness assumption is true , then no edge can be taken away from the true causal dag without violating the markov condition .",
    "the other weaker condition is named triangle - faithfulness :    _ triangle - faithfulness assumption_. suppose the true causal dag of * v * is _",
    "g_. let _ x _ , _ y _ , _ z _ be any three variables that form a triangle in _",
    "( i.e. , each pair of vertices is adjacent ) :    if _ y _ is a noncollider on the path @xmath75 , then _ x _ and _ z _ are not independent conditional on any subset of @xmath58 that does not contain _ y _ ;    if _ y _ is a collider on the path @xmath57 , then _ x _ and _ z _ are not independent conditional on any subset of @xmath58 that contains _",
    "y_.    clearly , the adjacency - faithfulness assumption entails the triangle - faithfulness assumption , and the latter , intuitively , is much weaker .",
    "our result in @xcite is that given the causal markov , minimality and triangle - faithfulness assumptions , any violation of faithfulness is detectable .",
    "but we did not propose any algorithm that is provably correct under the markov , minimality and triangle - faithfulness assumptions .",
    "what need we modify in the _ sgs _ algorithm if all we can assume are the markov , minimality and triangle - faithfulness assumptions ?",
    "in the step s2 , the inferred adjacencies are still correct , which , as already mentioned , is guaranteed by the causal markov assumption alone .",
    "the inferred nonadjacencies , however , are not necessarily correct , because the adjacency - faithfulness assumption might fail .",
    "so the first modification we need make is to acknowledge that the nonadjacencies resulting from s2 are only `` apparent '' but not `` definite '' : there might still be an edge between two variables even though the edge between them was removed in s2 because a screen - off set was found .",
    "since we do not assume the orientation - faithfulness assumption , obviously we need at least modify s3 into s3*. a further worry is that the unshielded triples resulting from s2 are only `` apparent '' : they might be shielded in the true causal dag but appear to be unshielded due to a failure of adjacency - faithfulness .",
    "fortunately , this possibility does not affect the soundness of s3*. take clause ( i ) for example .",
    "for an apparently unshielded triple @xmath57 , either _ x _ and _ z _ are really nonadjacent in the true dag or they are adjacent . in the former case , clause ( i ) is sound by the markov assumption . in the latter case ,",
    "clause ( i ) is still sound by the triangle - faithfulness assumption .",
    "a similar argument shows that clause ( ii ) is also sound .",
    "so s3 * is still sound .",
    "moreover , clause ( iii ) can now play a bigger role than simply conceding ignorance or ambiguity .",
    "if the antecedent of clause ( iii ) is satisfied , then one can infer that _ x _ and _ z _ are really nonadjacent , for otherwise the triangle - faithfulness assumption would be violated no matter whether @xmath70 is a collider or not .",
    "the soundness of s4 is obviously not affected .",
    "therefore , if we only assume the causal markov , minimality and triangle - faithfulness assumptions , the _ csgs _ algorithm is still correct if we take the nonadjacencies in its output as uninformative ( except for those warranted by s3 * ) .",
    "the question now is whether we can somehow test the adjacency - faithfulness assumption in the procedure and confirm the nonadjacencies when the test returns affirmative .",
    "the following lemma gives a sufficient condition for verifying the adjacency - faithfulness assumption and hence the nonadjacencies in the _ csgs _ output .",
    "( recall that the _ csgs _ output in general represents a set of patterns , and each pattern represents a set of markov equivalent dags . )",
    "a pattern _ o _ is _ markov to an oracle _ when for every dag represented by _ o _ , each vertex is independent of the set of variables that are neither descendants nor parents in the dag conditional on the parents in the dag according to the oracle .",
    "[ le1 ] suppose the causal markov , minimality and triangle - faithfulness assumptions are true , and _",
    "e _ is the output of _ csgs _ given a perfectly reliable oracle of conditional independence .",
    "if every pattern in the set represented by _ e _ is markov to the oracle , then the true causal dag has exactly those adjacencies present in _",
    "e_.    as we already pointed out , the true causal dag , @xmath76 , must have at least the adjacencies in _ e _ ( in order to satisfy the causal markov assumption ) , and must have the colliders and noncolliders in _ e _ ( in order to satisfy the causal markov and the triangle - faithfulness assumptions ) .",
    "now suppose every pattern in the set represented by _",
    "is markov to the oracle , and suppose , for the sake of contradiction , that @xmath76 has still more adjacencies . let _",
    "g _ be the proper subgraph of @xmath76 with just the adjacencies in _",
    "e_. then every unshielded collider and every unshielded noncollider in _",
    "e _ are also present in _",
    "g _ , and other unshielded triples in _",
    "g _ , if any , are ambiguous in _",
    "e_. thus , the pattern that represents the markov equivalence class of _ g _ is in the set represented by _",
    "it follows that _ g _ is markov to the oracle , which shows that @xmath76 is not a minimal graph that is markov to the oracle .",
    "this contradicts the causal minimality assumption .",
    "therefore , @xmath76 has exactly the adjacencies present in _",
    "so we have the following _ very conservative sgs _ ( _ vcsgs _ ) :    _ vcsgs algorithm_.    1 .",
    "form the complete undirected graph _",
    "h _ on the given set of variables * v*. 2 .   for each pair of variables _ x _ and _ y _ in * v * , search for a subset * s * of @xmath56 such that _ x _ and _ y _ are independent conditional on * s*. remove the edge between _ x _ and _ y _ in _ h _ and mark the pair @xmath77 as `` apparently nonadjacent , '' if and only if such a set is found .",
    "let _ k _ be the graph resulting from v2 .",
    "for each apparently unshielded triple @xmath57 ( i.e. , _ x _ and _ y _ are adjacent , _ y _ and _ z _ are adjacent , but _ x _ and _ z _ are apparently nonadjacent ) , a.   if _ x _ and _ z _ are not independent conditional on any subset of @xmath58 that contains _ y _ , then orient the triple as a collider : @xmath59 . b.   if _ x _ and _ z _ are not independent conditional on any subset of @xmath58 that does not contain _ y _ , then mark the triple as a noncollider . c.   otherwise ,",
    "mark the triple as ambiguous ( or unfaithful ) , and mark the pair @xmath78 as `` definitely nonadjacent . ''",
    "execute the same orientation rules as in s4 , until none of them applies .",
    "let _ m _ be the graph resulting from v4 .",
    "for each consistent disambiguation of the ambiguous triples in _ m _",
    "( i.e. , each disambiguation that leads to a pattern ) , test whether the resulting pattern satisfies the markov condition .",
    "if every pattern does , then mark all the `` apparently nonadjacent '' pairs as `` definitely nonadjacent . ''",
    "[ an obvious way to test the markov condition in v5 on a given pattern is to extend the pattern to a dag and test the local markov condition .",
    "that is , we need to test , for each variable _ x _ , whether _ x _ is independent of the variables that are neither its descendants nor its parents conditional on its parents . in linear gaussian models ,",
    "this can be done by regressing _",
    "x _ on its nondescendants and testing whether the regression coefficients are zero for its nonparents . more generally , assuming composition , we need only run a conditional independence test for each nonadjacent pair , and , thus , in the worst case the number of conditional independence tests is @xmath79 , where _ n _ is the number of vertices .",
    "the number of patterns to be tested in v5 is @xmath80 , where _ a _ is the number of ambiguous unshielded triples . ]        as we already explained , steps v1v4 are sound under the causal markov , minimality and triangle - faithfulness assumptions .",
    "lemma [ le1 ] shows that v5 is also sound .",
    "hence , the _ vcsgs _ algorithm is correct under the causal markov , minimality and triangle - faithfulness assumptions , in the sense that given a perfectly reliable oracle of conditional independence , all the adjacencies , definite nonadjacencies , directed edges and marked noncolliders are correct . moreover ,",
    "when the causal faithfulness assumption happens to hold , the _ csgs _ output will be a single pattern and this single pattern will satisfy the markov condition ; hence , the _ vcsgs _ algorithm will return a single pattern with full information about nonadjacencies . therefore , _ vcsgs _ is also as informative as _ sgs _ when the causal faithfulness assumption happens to be true",
    ".    one might think ( or hope ) that the _ vcsgs _ algorithm is as informative as the _ csgs _ algorithm when adjacency - faithfulness ( but not orientation - faithfulness ) happens to hold .",
    "unfortunately this is not true in general because the sufficient condition given in lemma [ le1 ] ( and checked in v5 ) is not necessary for the adjacency - faithfulness assumption .    to illustrate , consider the following example .",
    "suppose the true causal dag is the one given in figure  [ fig2](a ) .",
    "suppose the causal markov assumption and the adjacency - faithfulness assumption are satisfied . and suppose that , besides the conditional independence relations entailed by the graph , the true distribution features one and only one extra conditional independence : @xmath81 , due , for example , to some sort of balancing - out of the path @xmath57 ( active conditional on @xmath82 ) and the path @xmath83 ( active conditional on @xmath82 ) .",
    "this violates the orientation - faithfulness assumption .",
    "the _ csgs _",
    "output will thus be the graph in figure  [ fig2](b ) , in which both the triple @xmath61 and the triple @xmath84 are ambiguous .",
    "this output represents a set of three patterns , as shown in figure  [ fig2](c)(e ) .",
    "( again , the two ambiguous triples can not be noncolliders at the same time . ) however , only the patterns in figure  [ fig2](c ) and [ fig2](d ) satisfy the markov condition . the pattern in figure  [ fig2](e )",
    "violates the markov condition because it entails that @xmath85 , which is not true .",
    "for this example , then , the _ vcsgs _ will not return the full information of nonadjacencies , even though the adjacency - faithfulness assumption is true .    in light of this example",
    ", it is natural to consider the following variant of step v5 in _ vcsgs _ :    v5*. let _",
    "m _ be the graph resulting from v4 . if _ some _ disambiguation of the ambiguous triples in",
    "_ m _ leads to a pattern that satisfies the markov condition , then mark all remaining `` apparently nonadjacent '' pairs as `` definitely nonadjacent . ''",
    "we suspect that v5 * is also sound under the causal markov , minimality and triangle - faithfulness assumptions , but we have not found a proof . in other words , we conjecture that the sufficient condition presented in lemma [ le1 ] can be weakened to that _ some _ pattern in the set represented by the _ csgs _ output satisfies the markov condition .",
    "( this conjecture is a consequence of the following plausible conjecture : suppose a dag _",
    "g _ and a probability distribution _ p _",
    "satisfy the markov , minimality and triangle - faithfulness conditions .",
    "then no dag with strictly fewer adjacencies than in _",
    "g _ is markov to _",
    "we thank an anonymous referee for making the point and the conjecture . )",
    "note that if the adjacency - faithfulness assumption happens to hold , then at least one pattern ( i.e. , the pattern representing the true causal dag ) satisfies the markov condition .",
    "therefore , if our conjecture is true , we can replace v5 with v5 * in the _ vcsgs _ algorithm , and the condition tested in v5 * is both sufficient and necessary for adjacency - faithfulness .",
    "the resulting algorithm will then be as informative as the _ csgs _ algorithm whenever the adjacency - faithfulness assumption happens to hold , and as informative as the _ sgs _ algorithm whenever both the adjacency - faithfulness assumption and the orientation - faithfulness assumption happen to hold .",
    "it is worth noting that if we adopt a natural , interventionist conception of causation ( e.g. , @xcite ) , the causal minimality assumption is guaranteed to be true if the probability distribution is positive ( @xcite , @xcite ) .",
    "since positivity is a property of the probability distribution alone , we may also try to incorporate a test of positivity at the beginning of _ vcsgs _ , and proceed only if the test returns affirmative .",
    "we then need not assume the causal minimality assumption in order to justify the procedure .",
    "in this section we consider sample versions of the _ csgs _ and _ vcsgs _ algorithms , assuming gaussianity and linearity , and prove some positive results on uniform consistency , under a generalization and strengthening of the triangle - faithfulness assumption , which we call the _ k_-triangle - faithfulness assumption .    if a model _ m _ does not satisfy the causal faithfulness assumption , then _",
    "m _ contains a zero partial correlation @xmath86 even though the causal markov assumption does not entail that @xmath87 is zero .",
    "if @xmath88 but is not entailed to be zero for all values of the parameters , the parameters of the model satisfy an algebraic constraint . a set of parameters that satisfies",
    "such an algebraic constraint is a `` surface of unfaithfulness '' in the parameter space that is of a lower dimension than the full parameter space .",
    "lying on such a surface of unfaithfulness is of lebesgue measure zero . for a bayesian with a prior probability over the parameter space that is absolutely continuous with lebesgue measure ,",
    "the prior probability of unfaithfulness is zero .",
    "however , in practice , the _ sgs _ ( or _ pc _ ) algorithm does not have access to the population correlation coefficients .",
    "instead it performs statistical tests of whether a partial correlation is zero .",
    "if @xmath89 is small enough , then with high probability a statistical test of whether @xmath86 equals zero will not reject the null hypothesis .",
    "if @xmath90 fails to be rejected , this can lead to some edges that occur in the true causal dag not appearing in the output of _ sgs _ and to errors in the orientation of edges in the output of _",
    "sgs_. ( such errors can also lead to the output of the _ sgs _ algorithm to fail to be a pattern , either because it contains double - headed edges or undirected nonchordal cycles . )",
    "@xcite showed that even if it is assumed that there are no unfaithful models , there are always models so `` close to unfaithful '' [ i.e. , with @xmath91 nonzero but small enough that a statistical test will probably fail to reject the null hypothesis ] that there is no algorithm that is a uniformly consistent estimator of the pattern of a causal model .",
    "@xcite showed that under a strengthened version of the causal faithfulness assumption , the _ pc _ algorithm is a uniformly consistent estimator of the pattern that represents the true causal dag .",
    "n _ be the sample size .",
    "their strengthened set of assumptions were as follows :    the distribution @xmath92 is multivariate gaussian and faithful to the dag @xmath93 for all _",
    "n_.    the dimension @xmath94 for some @xmath95 .",
    "the maximal number of neighbors in the dag @xmath93 is denoted by @xmath96    the partial correlations between @xmath97 and @xmath98 given @xmath99 for some set @xmath100 are denoted by @xmath101 .",
    "their absolute values are bounded from below and above : @xmath102    we will refer to the assumption that all nonzero partial correlations are bounded below in absolute value by a number greater than zero [ as in the first part of ( a4 ) ] as the strong causal faithfulness assumption . @xcite",
    "provide some reason to believe that unless @xmath103 is quite small , the probability of violating strong causal faithfulness assumption is high , especially when the number of variables is large .",
    "[ this problem with assumption ( a4 ) is somewhat mitigated by the fact that the size of @xmath103 can decrease with increasing sample size . but see @xcite , for an interesting analysis of the asymptotics when @xmath103 approaches zero . ]",
    "it is difficult to see how a uniformly consistent estimator of a causal pattern would be possible without assuming something like the strong causal faithfulness assumption .",
    "however , what we will show is that it is possible to weaken the strong causal faithfulness assumption in several ways as long as the standard of success is not finding a uniformly consistent estimator of the causal pattern , but is instead finding a uniformly consistent estimator of ( some of ) the structural coefficients in a pattern .",
    "the latter standard is compatible with missing some edges that are in the true causal graph , as long as the edges that have not been included in the output have sufficiently small structural coefficients .",
    "we propose to replace the faithfulness assumption in ( a1 ) , and the strong faithfulness assumption with the following assumption , where @xmath104 , as we explained in section  [ sec2 ] , denotes the structural coefficient associated with the edge between _ x _ and _ z_.    _ k - triangle - faithfulness assumption_. given a set of variables * v",
    "* , suppose the true causal model over * v * is _ m _",
    "= @xmath105 , where _",
    "p _ is a gaussian distribution over * v * , and _",
    "g _ is a dag with vertices * v*. for any three variables _ x _ , _ y _ , _ z _ that form a triangle in _",
    "( i.e. , each pair of vertices is adjacent ) ,    if _ y _ is a noncollider on the path @xmath75 , then @xmath106 for all @xmath107 that do not contain _ y _ ; and    if _ y _ is a collider on the path @xmath57 , then @xmath106 for all @xmath108 that do contain _",
    "y_.    as _ k _ approaches 0 , the _ k_-triangle - faithfulness assumption approaches the triangle - faithfulness assumption . for ( small ) @xmath109 ,",
    "the _ k_-triangle - faithfulness assumption prohibits not only exact cancellations of active paths in a triangle , but also _ almost _ cancellations .",
    "the _ k_-triangle - faithfulness assumption is a weakening of the strong causal faithfulness assumption in two ways .",
    "first , triangle - faithfulness is significantly weaker than faithfulness .",
    "second , it does not entail a lower limit on the size of nonzero partial correlations ; it only puts a limit on the size of a nonzero partial correlation in relation to the size of the structural coefficient of an edge that occurs in a triangle .",
    "the strong causal faithfulness assumption entails that there are no very small structural coefficients ( which , if present , entail the existence of some partial correlation that is very small ) .",
    "in contrast , the _ k_-triangle - faithfulness assumption does not entail that there are no nonzero but very small structural coefficients .",
    "however , there is a price to be paid for weakening the strong causal faithfulness assumption ; the estimator we propose is both computationally more intensive than the pc algorithm used in @xcite and also requires testing partial correlations conditional on larger sets of variables , which means some of the tests performed have lower power than the tests performed in the pc algorithm .",
    "our results also depend on the following assumptions .",
    "first , we assume a fixed upper bound to the size of the set of variables that does not change as sample size increases .",
    "we have no reason to think that there are not analogous results that would hold even if , as in @xcite , the number of variables and the degree of the graph increased with the sample size ; however , we have not proved any such results yet .",
    "we also make the assumption of nonvanishing variance ( nvv ) and the assumption of upper bound for partial correlations ( ubc ) :    _ assumption nvvj_. @xmath110    _ assumption ubcc_. @xmath111    the assumption nvv is a slight strengthening of the positivity requirement , which , as we noted in the previous section , is needed to guarantee the causal minimality assumption .",
    "uniform consistency requires that the distributions be bounded away from nonpositivity .",
    "the assumption ubc [ cf .",
    "the second part of assumption ( a4 ) ] is used to guarantee that sample partial correlations are uniformly consistent estimators of population partial correlations ( @xcite ) .",
    "we now proceed to establish two positive results about uniform consistency . in section  [ sec4.1 ]",
    "we show that the _ conservative sgs _ ( _ csgs _ ) algorithm , using uniformly consistent tests of partial correlations , is uniformly consistent in inferring certain features of the causal structure . in section  [ sec4.2 ]",
    "we show that the _ very conservative sgs _ ( _ vcsgs _ ) algorithm , when combined with a uniformly consistent procedure for estimating structural coefficients , provides a uniformly consistent estimator of structural coefficients ( that returns `` unknown '' in some , but not all cases ) .",
    "recall that the _ csgs _ algorithm , given a perfect oracle of conditional independence , is correct under the causal markov , minimality and triangle - faithfulness assumptions , in the sense that the adjacencies , orientations and marked noncolliders in the output are all correct . in gaussian models , we can implement the oracle with tests of zero partial correlations .",
    "a test @xmath112 of @xmath113 versus @xmath114 is a family of functions : @xmath115",
    "one for each sample size , that takes an i.i.d .",
    "sample @xmath116 from the joint distribution over * v * and returns 0 ( acceptance of @xmath117 ) or 1 ( rejection of @xmath118 .",
    "such a test is _ uniformly consistent _ with respect to a set of distributions @xmath119 if and only if    @xmath120 , and    @xmath121 , @xmath122    for simplicity , we assume the variables in * v * are standardized . under the assumption ubc , there are uniformly consistent tests of partial correlations based on sample partial correlations , such as fisher s _ z _ test ( @xcite ; @xcite ) .",
    "we consider a sample version of the _ csgs _ algorithm in which the oracle is replaced by uniformly consistent tests of zero partial correlations in the adjacency step s2 . in the orientation phase , the step s3 * is refined as follows , based on a user chosen parameter _",
    "l_.    s3 * ( sample version ) .",
    "let _ k _ be the undirected graph resulting from the adjacency phase . for each unshielded triple",
    "@xmath123 ,    if there is a set * w * not containing _ y _ such that the test of @xmath124 returns 0 ( i.e. , accepts the hypothesis ) , and for every set * u * that contains _",
    "y _ , the test of @xmath125 returns 1 ( i.e. , rejects the hypothesis ) , and the test of @xmath126 returns 0 ( i.e. , accepts the hypothesis ) , then orient the triple as a collider : @xmath59 .",
    "if there is a set * w * containing _ y _ such that the test of @xmath124 returns 0 ( i.e. , accepts the hypothesis ) , and for every set * u * that does not contain _ y _ , the test of @xmath127 returns 0 ( i.e. , accepts the hypothesis ) , then mark the triple as a noncollider .",
    "otherwise , mark the triple as ambiguous .",
    "larger values of _ l _ return `` unknown '' more often than smaller values of _ l _ , but reduce the probability of an error in orientation at a given sample size .",
    "step s4 remains the same as in the population version .",
    "given any causal model @xmath128 over * v * , let @xmath129 denote the ( random ) output of the _ csgs _ algorithm with parameter _",
    ", given an i.i.d .",
    "sample of size _",
    "n _ from the distribution @xmath24 . say that @xmath130 errs if it contains ( i ) an adjacency not in @xmath25 , or ( ii ) a marked noncollider not in @xmath25 , or ( iii ) an orientation not in @xmath25 .",
    "let @xmath131 be the set of causal models over * v * that respect the _ k_-triangle - faithfulness assumption and the assumptions of nvv(_j _ ) and ubc(_c _ ) .",
    "we shall prove that given the causal sufficiency of the measured variables * v * and the causal markov assumption , @xmath132 in other words , given the causal sufficiency of * v * , the causal markov , _",
    "k_-triangle - faithfulness , nvv(_j _ ) and ubc(_c _ ) assumptions , the _ csgs _ algorithm is uniformly consistent in that the probability of it making a mistake uniformly converges to zero in the large sample limit .",
    "first of all , we prove a useful lemma :    [ le2 ] let @xmath133 . for any @xmath15 and @xmath134 such",
    "that @xmath135 is not an ancestor of @xmath15 , if @xmath136 , then @xmath137\\setminus\\{{{x}_{i}}\\}\\bigr ) \\bigr{\\vert}\\ge { \\vert}{{b}_{j , i } } { \\vert}\\sqrt{j},\\ ] ] where @xmath138 $ ] is an ancestral set that contains @xmath139 but does not contain any descendant of @xmath134 .",
    "let @xmath45 be the correlation matrix for the set of variables @xmath140 , and @xmath141 .",
    "let * b * be the ( lower - triangular ) matrix of structural coefficients in _",
    "m _ restricted to @xmath142 , and var(*e * ) be the ( diagonal ) covariance matrix for the error terms @xmath143 .",
    "then @xmath144 note that @xmath145\\operatorname{var}(\\mathbf{e})^{-1}\\\\ & = & { \\left } [ \\matrix { 1/{{\\varepsilon}_{1 } } & 0 & \\cdots & 0 \\vspace*{2pt } \\cr 0 & 1/{{\\varepsilon}_{2 } } & \\cdots & 0",
    "\\vspace*{2pt } \\cr \\vdots & \\cdots & \\cdots & 0 \\vspace*{2pt } \\cr 0 & \\cdots & 0 & 1/ { { \\varepsilon}_{j } } } { \\right}],\\end{aligned}\\ ] ] where the _ b _ s are the corresponding structural coefficients in _ m _ , and the @xmath146 s are the variances of the corresponding error terms .",
    "thus , @xmath147 = 1/\\varepsilon_j$ ] , and @xmath148 = -b_{j , i}/\\varepsilon_{j}$ ] .",
    "so we have ( @xcite , @xcite ) @xmath149\\setminus\\ { { { x}_{i}}\\}\\bigr)\\\\ & & \\quad=-\\frac{\\mathbf{r}[i , j ] } { { { ( \\mathbf{r}[i , i]\\cdot \\mathbf{r}[j , j ]   ) } ^{1/2}}}= \\frac{{{b}_{j , i}}}{\\mathbf { r}{{[i , i]}^{1/2}}\\varepsilon_{j}^{1/2}}.\\end{aligned}\\ ] ] since @xmath150^{- 1}$ ] is the variance of @xmath15 conditional on all of the other variables in @xmath142 , which is a subset of @xmath151 , @xmath150^{-1 } \\geq \\operatorname{var}_m(x_i|\\mathbf{v } \\setminus\\{x_i\\ } ) \\geq j$ ] . since the variables are standardized and the residual of @xmath15 regressed on the other variables is uncorrelated with @xmath15 , @xmath150^{-1 } \\leq1 $ ] .",
    "similarly , @xmath152 .",
    "@xmath137\\setminus\\{{{x}_{i}}\\}\\bigr ) \\bigr{\\vert}\\ge { \\vert}{{b}_{j , i } } { \\vert}\\sqrt{j}.\\ ] ]    we now categorize the mistakes @xmath130 can make into three kinds .",
    "_ errs in kind i _ if @xmath130 has an adjacency that is not present in @xmath25 ; @xmath130 _ errs in kind ii _",
    "if every adjacency in @xmath130 is in @xmath25 but @xmath130 contains a marked noncollider that is not in @xmath25 ; @xmath130 errs in _ kind iii _ if every adjacency in @xmath130 is in @xmath25 , every marked noncollider in @xmath130 is in @xmath25 , but @xmath130 contains an orientation that is not in @xmath25 .",
    "obviously if @xmath153 errs , it errs in at least one of the three kinds .",
    "the following three lemmas show that for each kind , the probability of @xmath130 erring in that kind uniformly converges to zero .",
    "[ le3 ] given causal sufficiency of the measured variables @xmath1 , the causal markov , _",
    "k_-triangle - faithfulness , nvv(____j ) and ubc(_c _ ) assumptions , @xmath154    @xmath130 has an adjacency not in @xmath25 only if some test of zero partial correlation falsely rejects its null hypothesis . since uniformly consistent tests are used in _ csgs _ , for every @xmath155 , for every test of zero partial correlation @xmath156 , there is a sample size @xmath157 such that for all @xmath158 the supremum ( over @xmath159 of the probability of the test falsely rejecting its null hypothesis is less than @xmath146 . given * v * , there are only finitely many possible tests of zero partial correlations .",
    "thus , for every @xmath160 , there is a sample size _",
    "such that for all @xmath161 , the supremum ( over @xmath162 of the probability of any of the tests falsely rejecting its null hypothesis is less than @xmath146 .",
    "the lemma then follows .",
    "[ le4 ] given causal sufficiency of the measured variables @xmath1 , the causal markov , _",
    "k_-triangle - faithfulness , and nvv(_j _ ) and ubc(_c _ ) assumptions , @xmath163    for any @xmath133 , if @xmath130 errs in kind ii , then @xmath130 contains a marked noncollider , say , @xmath61 which is not in @xmath25 , but every adjacency in @xmath153 is also in @xmath25 , including the adjacency between _ x _ and _ y _ , and that between _ y _ and _ z_. it follows that @xmath70 is a collider in @xmath25 . since _ csgs _ marks a triple as a noncollider only if the triple is unshielded , _ x _ and _ z _ are not adjacent in @xmath130 .",
    "hence , errors of kind ii can be further categorized into two cases : ( ii.1 ) @xmath153 contains an unshielded noncollider that is an _ unshielded _ collider in @xmath25 , and ( ii.2 ) @xmath130 contains an unshielded noncollider that is a _ shielded _ collider in @xmath25 .",
    "we show that the probability of either case uniformly converges to zero .    for case ( ii.1 )",
    "there is an unshielded collider @xmath164 in @xmath25 , so _",
    "x _ and _ z _ are independent conditional on some set of variables * w * that does not contain _ y _ , by the causal markov assumption . then the _ csgs _ algorithm ( falsely ) marks @xmath57 as a noncollider only if the test of @xmath165 ( falsely ) rejects its null hypothesis .",
    "therefore , the _ csgs _ algorithm gives rise to case ( ii.1 ) only if some test of zero partial correlation falsely rejects its null hypothesis .",
    "then , by essentially the same argument as the one used in proving lemma  [ le3 ] , the probability of case ( ii.1 ) uniformly converges to zero as sample size increases .    for case ( ii.2 ) , suppose for the sake of contradiction that the probability of _ csgs _ making such a mistake does not uniformly converge to zero .",
    "then there exists @xmath160 , such that for every sample size _",
    "n _ , there is a model @xmath166 such that the probability of @xmath167 contains an unshielded noncollider that is a shielded collider in @xmath166 is greater than @xmath146 .",
    "now , @xmath167 contains an unshielded noncollider that is a shielded collider in @xmath168 , say @xmath169 , only if there is a set @xmath170 that contains _ y _ such that the test of @xmath171 returns 0 ( i.e. , accepts the hypothesis ) .    without loss of generality ,",
    "suppose @xmath172 is not an ancestor of @xmath173 .",
    "let @xmath174 , where @xmath175 is an ancestral set that contains @xmath173 and @xmath172 but no descendent of @xmath176 .",
    "since @xmath177 is a child of @xmath172 in @xmath178 , @xmath179 does not contain @xmath177 .",
    "then , @xmath180 is marked as a noncollider in @xmath167 only if the test of @xmath181 returns 0 ( i.e. , accepts the hypothesis ) .",
    "the test of @xmath182 will be denoted by @xmath183 and @xmath184 denotes the test of @xmath185 . by our supposition , @xmath186 and @xmath187 .",
    "it follows that for all _ n _ ,    @xmath188 ,    @xmath189 .",
    "\\(1 ) implies that there exists @xmath190 such that @xmath191 , and @xmath192 as @xmath193 since the tests are uniformly consistent .",
    "@xmath194   z^{m(n)})| \\leq|\\rho ( x^{m(n ) } , z^{m(n ) } | \\mathbf{w}^{m(n)})| / k < \\delta_n / k$ ] by _ k_-triangle - faithfulness . by lemma [ le2 ] , @xmath195 .    thus , @xmath196   \\mathbf{w}^{m(n)})|",
    "< \\delta_n(1 + j^{-1/2}/k ) \\rightarrow0 $ ] as @xmath193 . therefore , it is not true that ( 2 ) holds for all _ n _ , which is a contradiction .",
    "so the initial supposition is false .",
    "the probability of case ( ii.2 ) uniformly converges to zero as sample size increases .",
    "[ le5 ] given causal sufficiency of the measured variables @xmath1 , the causal markov , _",
    "k_-triangle - faithfulness , nvv(_j _ ) and ubc(_c _ ) assumptions , @xmath197    given that all the adjacencies and marked noncolliders in @xmath130 are correct , there is a mistaken orientation if and only if there is an unshielded collider in @xmath130 which is not a collider in @xmath25 , for the other orientation rules in step s4 would not lead to any mistaken orientation if all the unshielded colliders were correct .",
    "thus , @xmath130 errs in kind iii only if there is a noncollider @xmath57 in @xmath25 that is marked as an unshielded collider in @xmath130 .",
    "there are then two cases to consider : ( iii.1 ) @xmath198 contains an unshielded collider that is an _ unshielded _ noncollider in @xmath51 , and ( iii.2 ) @xmath130 contains an unshielded collider that is a _ shielded _ noncollider in @xmath25 . the argument for case ( iii.1 ) is extremely similar to that for ( ii.1 ) in the proof of lemma  [ le4 ] , and the argument for case ( iii.2 ) is extremely similar to that for ( ii.2 ) in the proof of lemma  [ le4 ] .",
    "[ th1 ] given causal sufficiency of the measured variables @xmath1 , the causal markov , _",
    "k_-triangle - faithfulness , nvv(_j _ ) and ubc(____c ) assumptions , the _ csgs _ algorithm is uniformly consistent in the sense that @xmath199    it follows from lemmas [ le3][le5 ] [ and the fact that @xmath130 errs if and only if it errs in one of the three kinds ] .",
    "we now combine the structure search with estimation of structural coefficients , when possible .",
    "_ edge estimation algorithm_.    1 .",
    "run the _ csgs _ algorithm on an i.i.d .",
    "sample of size _",
    "n _ from @xmath24 .",
    "2 .   let the output from e1 be @xmath130 .",
    "apply step v5 in the _ vcsgs _ algorithm ( from section  [ sec3 ] ) , using tests of zero partial correlations .",
    "3 .   if the nonadjacencies in @xmath130 are not confirmed in e2 , return `` unknown '' for every pair of variables .",
    "4 .   if the nonadjacencies in @xmath130 are confirmed in e2 , then a.   for every nonadjacent pair @xmath200 , let the estimate @xmath201 be 0 . b.   for each vertex _ z _ such that all of the edges containing _ z _ are oriented in @xmath130 , if _",
    "y _ is a parent of _ z _ in @xmath130 , let the estimate @xmath202 be the sample regression coefficient of _ y _ in the regression of _ z _ on its parents in @xmath130 . c.   for any of the remaining edges , return `` unknown . ''",
    "the basic idea is that we first run the very conservative sgs ( _ vcsgs _ ) algorithm , which , recall , is the _ csgs _ algorithm ( e1 ) plus a step of testing whether the output satisfies the markov condition ( e2 ) .",
    "if the test does not pass , we do not estimate any edge ; if the test passes , we estimate those edges that are into a vertex that is not part of any unoriented edge .",
    "let @xmath203 be an output of the edge estimation algorithm , and @xmath204 be a causal model .",
    "we define the _ structural coefficient distance _ , @xmath205 $ ] , between @xmath203 and @xmath204 to be @xmath206 \\\\ & & \\quad= \\mathop{\\max } _ { i , j } \\bigl { \\vert}{{{\\hat e}_{{m_1}}}({x_i } \\to{x_j } ) - { e_{{m_2}}}({x_i } \\to{x_j})}\\bigr{\\vert},\\end{aligned}\\ ] ] where by convention @xmath207 if @xmath208``unknown . ''",
    "intuitively , the structural coefficient distance between the output and the true causal model measures the ( largest ) estimation error the edge estimation algorithm makes . our goal is to show that under the specified assumptions , the edge estimation algorithm is uniformly consistent , in the sense that for every @xmath209 , the probability of the structural coefficient distance between the output and the true model being greater than @xmath210 uniformly converges to zero .    obviously , by placing no penalty on the uninformative answer of `` unknown , '' there is a trivial algorithm that is uniformly consistent , namely , the algorithm that always returns `` unknown '' for every structural coefficient .",
    "for this reason , @xcite also requires any admissible algorithm to be nontrivial in the sense that it returns an informative answer ( in the large sample limit ) for some possible joint distributions .",
    "the edge estimation algorithm is clearly nontrivial in this sense .",
    "there is no guarantee that it will always output an informative answer for some structural coefficient , and rightly so , because there are cases  for example , when the true causal graph is a complete one and there is no prior information about the causal order  in which every structural coefficient is truly underdetermined or unidentifiable .",
    "an interesting question , however , is whether a given algorithm is maximally informative or complete in the sense that it returns ( in the large sample limit ) `` unknown '' only on those structural coefficients that are truly underdetermined .",
    "the condition in question is of course much stronger than robins et al.s condition of nontriviality .",
    "we suspect that the edge estimation algorithm is not maximally informative in this sense .",
    "( we thank an anonymous referee for raising this issue . )",
    "[ th2 ] given causal sufficiency of the measured variables @xmath1 , the causal markov , _",
    "k_-triangle - faithfulness , nvv(_j _ ) and ubc(_c _ ) assumptions , the edge estimation algorithm is uniformly consistent in the sense that for every @xmath211 @xmath212 > \\delta\\bigr ) = 0,\\ ] ] where @xmath213 is the output of the algorithm given an i.i.d .",
    "sample from @xmath24 .",
    "let * o * be the set of possible graphical outputs of the _ csgs _ algorithm .",
    "given * v * , there are only finitely many graphs in * o*. so it suffices to show that for each @xmath214 , @xmath215 > \\delta|\\\\ & & \\hspace*{88pt}c(l , n , m ) = o\\bigr)\\\\ & & \\quad\\hspace*{51pt}{}\\cdot p_m^n \\bigl(c(l , n , m ) = o\\bigr ) = 0.\\end{aligned}\\ ] ] given _ o _ , @xmath131 can be partitioned into the following three sets : @xmath216    it suffices to show that for each @xmath217 , @xmath218 > \\delta|c(l , n , m ) = o\\bigr)\\\\ & & \\hspace*{48pt}{}\\cdot p_m^n \\bigl(c(l , n , m ) = o\\bigr ) = 0.\\end{aligned}\\ ] ] consider @xmath219 first . given any @xmath220 , the zero estimates in @xmath213 are all correct ( since all nonadjacencies are true ) . for each edge",
    "@xmath221 that is estimated , the true structural coefficient @xmath222 is simply @xmath223 , the population regression coefficient for _ y _ when _ z _ is regressed on its parents in _ o _ , because the set of _ z _ s parents in _ o _ is the same as the set of _ z _ s parents in @xmath25 .",
    "the sampling distribution of the estimate of an edge @xmath224 in @xmath225 is given by @xmath226 where @xmath227 is the variance of the residual for _ z _ when regressed upon @xmath228 in @xmath24 , and @xmath229 is the variance of _ y _ conditional on @xmath230 in @xmath24 ( @xcite , @xcite ) .",
    "the numerator of the variance is bounded above by 1 , since the variance of each variable is 1 , and the residual is independent of the set of variables regressed on .",
    "the denominator is bounded away from zero by assumption nvv(_j _ ) .",
    "hence , sample regression coefficients are uniformly consistent estimators of population regression coefficients under our assumptions , and we have @xmath231 > \\delta|c(l , n , m ) = o\\bigr)\\\\ & & \\hspace*{46pt}{}\\cdot p_m^n \\bigl(c(l , n , m ) = o\\bigr ) \\\\ & & \\quad\\leq\\mathop{\\lim } _ { n \\to\\infty } \\mathop{\\sup } _ { m \\in{\\psi_1 } } p_m^n\\bigl(d\\bigl[\\hat{o } ( m),m\\bigr ] > \\delta|\\\\ & & \\hspace*{96pt } c(l , n , m ) = o\\bigr ) \\\\ & & \\quad = 0.\\end{aligned}\\ ] ] for @xmath232 , note that given any @xmath233 , the _ csgs _ algorithm errs if it outputs _",
    "o_. thus , by theorem [ th1 ] , @xmath234 > \\delta|c(l , n ,",
    "m ) = o\\bigr)\\\\ & & \\hspace*{47pt}{}\\cdot p_m^n \\bigl(c(l , n , m ) = o\\bigr ) \\\\ & & \\quad\\leq\\mathop{\\lim } _ { n \\to\\infty } \\mathop{\\sup } _ { m \\in{\\psi_2 } } p_m^n\\bigl(c(l , n , m ) = o\\bigr ) = 0.\\end{aligned}\\ ] ]    now consider @xmath235 .",
    "let @xmath236 be the population version of @xmath213 , that is , all the sample regression coefficients in @xmath213 are replaced by the corresponding population coefficients .",
    "since sample regression coefficients are uniformly consistent estimators of population regression coefficients under our assumptions , and there are only finitely many regression coefficients to consider , for every @xmath155 , there is a sample size @xmath237 , such that for all @xmath238 , and all @xmath239 , @xmath240 > \\delta/2|c(l , n , m ) = o } \\bigr ) < \\varepsilon.\\ ] ] for any @xmath239 , there are some edges in @xmath25 missing in _ o_. let @xmath241 be the set of edges missing in _ o_. let @xmath242 be the same as _ m _ except that the structural coefficients associated with the edges in @xmath241 are set to zero .",
    "let @xmath243 be the same as @xmath236 except that for each edge with an identified coefficient , the coefficient in @xmath244 is the relevant regression coefficient derived from @xmath245 [ whereas that in @xmath236 is derived from @xmath246 $ ] . by the setup of @xmath242 ,",
    "the identified edge coefficients in @xmath244 are equal to the corresponding edge coefficients in @xmath242 , which are the same as the corresponding edge coefficients in @xmath247 .",
    "thus , the structural coefficient distance between @xmath244 and @xmath247 is simply @xmath248 = \\mathop{\\max } _ { \\langle i , j \\rangle\\in{\\mathbf { e}}(m ) } \\bigl{\\vert}{{e_m}({x_i } \\to{x_j } ) } \\bigr { \\vert}.\\ ] ] for any edge @xmath249 in @xmath225 that has a different edge coefficient in @xmath236 than that in @xmath244 , the edge coefficients are both derived from a regression of _ z _ on @xmath228 , but one is based on @xmath24 and the other is based on @xmath250 . the regression coefficient @xmath251 is equal to the _ y _ component of the vector @xmath252 ( @xcite , @xcite ) , which , given the structure @xmath25 , is a rational function of the structural coefficients in _",
    "m_. since @xmath253 , every submatrix of the covariance matrix for @xmath24 is invertible , and so @xmath254 is defined . for @xmath255 , @xmath256 , where * a * is the smallest ancestral set that contains @xmath228 in @xmath25 .",
    "@xmath257 , where * b * is the submatrix of structural coefficients in @xmath242 for variables in * a * , and @xmath258 is the diagonal covariance matrix of error terms for variables in * a * , which is a submatrix of @xmath259 . since @xmath133 , the variance of every error term is bounded from below by _",
    "j_. thus , @xmath260is defined and so is @xmath261.therefore , @xmath262 and @xmath263 are values of a rational function of the structural coefficients .",
    "a continuous function is uniformly continuous on a closed , bounded interval anywhere that it is defined .",
    "a  rational function is continuous at every point of its domain where its denominator is not zero , that is , where the function value is defined . by lemma  [ le2 ] and assumption ubc(_c _ ) , every structural coefficient @xmath38 in _ m _ lies in the closed bounded interval from @xmath264 to @xmath265 .",
    "obviously the coefficients in @xmath242 still lie in this interval .",
    "hence , given @xmath25 , the difference between @xmath266 and @xmath267 can be arbitrarily small if the differences between the structural coefficients in @xmath242 and those in _",
    "m _ are sufficiently small . given the set of variables * v * , there are only finitely many structures and finitely many relevant regressions to consider .",
    "therefore , there is a @xmath268 such that for every @xmath269 < \\delta/4 $ ] if @xmath270 consider then the partition of @xmath235 into @xmath271 and @xmath272 it follows from the previous argument that for every @xmath273 \\leq d[o(m ) , o(m ' ) ] + d[o(m ' ) , m ] < \\delta/4 + \\gamma < \\delta/2 $ ] . then there is a sample size @xmath237 , such that for all @xmath274 and all @xmath275 , @xmath276 > \\delta|c(l , n , m ) = o } \\bigr ) \\\\ & & \\quad \\leq p_m^n \\bigl ( { d \\bigl [ { \\hat o(m),o(m ) } \\bigr ] > \\delta /2|c(l , n , m ) = o } \\bigr ) \\\\ & & \\quad < \\varepsilon.\\end{aligned}\\ ] ]    for every @xmath277 , there is at least one edge , say , @xmath278 missing from _ o _ such that @xmath279",
    ". then by lemma [ le2 ] , there is a set * u * such that @xmath280 , but _",
    "o _ entails that @xmath281 .",
    "thus , the test of the markov condition in step e2 is passed only if the test of @xmath282 returns 0 ( i.e. , accepts the null hypothesis ) .",
    "note that if the test is not passed , then every structural coefficient is `` unknown , '' and so by definition the structural coefficient distance is zero .",
    "therefore , the distance is greater than @xmath210 ( and so nonzero ) only if the test of @xmath282 returns 0 while @xmath283 . since tests",
    "are uniformly consistent , it follows that there is a sample size @xmath284 , such that for all @xmath285 and all @xmath277 , @xmath286 > \\delta|c(l , n , m ) = o } \\bigr ) < \\varepsilon.\\ ] ] let @xmath287 .",
    "then for all @xmath161 , @xmath288 > \\delta|c(l , n , m ) = o\\bigr)\\\\ & & \\hspace*{24pt}{}\\cdot p_m^n \\bigl(c(l , n , m ) = o\\bigr ) \\\\ & & \\quad\\leq\\mathop{\\sup } _ { m \\in{\\psi_3 } } p_m^n\\bigl(d\\bigl [ \\hat{o } ( m),m\\bigr ] > \\delta|c(l , n , m ) = o\\bigr ) \\\\ & & \\quad < \\varepsilon.\\end{aligned}\\ ] ]",
    "we have shown that there is a pointwise consistent estimator of causal patterns and a uniformly consistent estimator of some of the structural coefficients in causal patterns , even when the causal faithfulness assumption and strong causal faithfulness assumptions are substantially weakened .",
    "k_-triangle faithfulness assumption is a restriction on many fewer partial correlations than the causal faithfulness assumption and the strong causal faithfulness assumptions , and does not entail that there are no edges with very small but nonzero structural coefficients .",
    "there are a number of open problems associated with the causal faithfulness assumption :    is it possible to speed up the _ very conservative sgs _ algorithm to make it applicable to data sets with large numbers of variables ?",
    "if unfaithfulness is detected , is it possible to reduce the number of structural coefficients where the algorithm returns `` unknown ? ''    in practice , on realistic sample sizes , how does the _ very conservative sgs _ algorithm perform ?",
    "[ @xcite , have already shown that the _ conservative pc _ algorithm is more accurate and not significantly slower than the _ pc _ algorithm ] .    is the _",
    "k_-triangle faithfulness assumption unlikely to hold for reasonable values of _ k _ and large numbers of variables",
    "?    is there an assumption weaker than the _",
    "k_-triangle faithfulness assumption for which there is a uniformly consistent estimator for structural coefficients in a causal pattern ?    are there analogous results that apply when the number of variables and the maximum degree of a vertex increases and the size of _ k _ decreases with increasing sample size [ as in the @xcite , results ] ?",
    "are there analogous results that apply when the assumption of causal sufficiency is abandoned ?",
    "are there analogous results that apply for other families of distributions or for nonparametric tests of conditional independence ?",
    "we thank two anonymous referees for helpful comments .",
    "zhang s research was supported in part by the research grants council of hong kong under the general research fund lu341910 ."
  ],
  "abstract_text": [
    "<S> spirtes , glymour and scheines [ _ causation _ , _ prediction _ , _ and search _ ( 1993 ) springer ] described a pointwise consistent estimator of the markov equivalence class of any causal structure that can be represented by a directed acyclic graph for any parametric family with a uniformly consistent test of conditional independence , under the causal markov and causal faithfulness assumptions . </S>",
    "<S> robins et  al . </S>",
    "<S> [ _ biometrika _ * 90 * ( 2003 ) 491515 ] , however , proved that there are no uniformly consistent estimators of markov equivalence classes of causal structures under those assumptions . </S>",
    "<S> subsequently , kalisch and bhlmann [ _ j . </S>",
    "<S> mach . </S>",
    "<S> learn . </S>",
    "<S> res . _ * 8 * ( 2007 ) 613636 ] described a uniformly consistent estimator of the markov equivalence class of a linear gaussian causal structure under the causal markov and strong causal faithfulness assumptions . however , the strong faithfulness assumption may be false with high probability in many domains . </S>",
    "<S> we describe a uniformly consistent estimator of both the markov equivalence class of a linear gaussian causal structure and the identifiable structural coefficients in the markov equivalence class under the causal markov assumption and the considerably weaker _ k_-triangle - faithfulness assumption . </S>"
  ]
}