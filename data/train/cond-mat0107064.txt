{
  "article_text": [
    "computer simulations are becoming more and more important in the study of complex systems . among them",
    "many of the most interesting systems are charged systems , and as such naturally dominated by long range interactions .",
    "this is certainly the case for almost all biological systems where the electrostatic interactions play a dominant role@xcite , but there is also a wealth of technological important substances such as polyelectrolytes , where the charged nature is one of the key ingredient for their functionality @xcite .",
    "the electrostatic interactions can be of monopolar origin , like interactions between proteins , dna , or charged membranes , but also of dipolar nature , because all biological tissues contain water , which is a dipolar substance .",
    "the simultaneous appearance of dipoles and monopoles is of great importance , for example , for protein folding simulations@xcite .",
    "dipolar interactions can also be of technological importance , for example in the application of so called ferrofluids , which are basically dispersed magnetic particles@xcite . however , computer simulations of long range interactions in periodic boundary conditions are notoriously difficult to handle , and possess an unfavorable scaling with the amount of particles involved .",
    "the most often used method to compute the interactions relies on the famous ewald sum@xcite . in the simplest implementations",
    "the involved computation time grows like @xmath0 , or at best like @xmath1 , if the cutoff is optimally varied with the splitting parameter@xcite .",
    "the use of fast fourier transformations ( fft ) can further reduce the scaling to basically @xmath2 .",
    "there have been quite a number of advances in the application of these so - called particle - mesh - ewald techniques for coulomb systems over the last few years@xcite .",
    "an important aspect of all algorithms is the tuning in the sense of speed at well controlled errors .",
    "all algorithms have parameters such as the real space cutoff @xmath3 , the reciprocal space cutoff @xmath4 , the splitting parameter @xmath5 , and for the mesh based methods there are even more . to find the optimal combination and at the same time control",
    "the systematic error is a formidable task , and can not efficiently be achieved by trial and error . for the simulations of point charges ,",
    "there have been reliable error estimates published for the standard ewald summation @xcite , and for the mesh ewald methods pme @xcite and p3 m @xcite . for the dipolar ewald summation ,",
    "there has been just an estimate given for the energy in real - space in ref .. for molecular dynamics ( md ) simulations of dipolar systems , however , we need to know the errors for the forces and the torques . in this article",
    "we give a reliable error estimate for the energy , for the forces , and for the torques , when computed via the standard ewald sum .",
    "we will show the applicability of these estimates by comparing them to well specified systems . moreover we will give a detailed discussion on the optimization of the parameters , which will lead to the most efficient parameters for a predefined error in each observable quantity .",
    "this can all be done prior to the actual simulation , ensuring thus optimal performance at optimally controlled errors .",
    "the article is organized as follows : in sec .",
    "ii we briefly review the important formulas of the ewald summation for dipolar systems .",
    "the theoretical estimates of the cut - off errors in the ewald sum are derived in sec .",
    "iii . in sec .",
    "iv the estimates are compared with numerical accuracy measurements for specified model systems , and they are found to be very precise .",
    "the use of the estimates in determining the optimal parameters and their application to an inhomogeneous system is discussed in sec .",
    "v and vi , respectively .",
    "finally we end with some conclusions in sec .",
    "consider a system of @xmath6 particles with a point - dipole @xmath7 at their center position @xmath8 in a cubic simulation box of length @xmath9 .",
    "if periodic boundary conditions are applied , the total electrostatic energy of the box is given by @xmath10[{{\\mbox{\\boldmath$\\mu$}}}_j\\cdot ( { { \\mathbf{r}}}_{ij}+{{\\mathbf{n}}})]}{\\mid { { \\mathbf{r}}}_{ij}+{{\\mathbf{n}}}\\mid ^{5 } } \\bigg{\\}}.\\ ] ] where @xmath11 .",
    "the sum over @xmath12 is over all simple cubic lattice points , @xmath13 with @xmath14 integers .",
    "the prime indicates that the @xmath15 term must be omitted for @xmath16 .",
    "the slowly decaying long range part of the dipolar potential renders the straightforward summation of eqn.([unormal ] ) impracticable .",
    "the ewald method provides an efficient way of calculating @xmath17 , which splits the problem into two absolutely and rapidly convergent parts , one in real space and one in reciprocal space .",
    "the details of the method are discussed in refs .",
    ", here we only give the final expressions @xmath18 where the real - space @xmath19 , the k - space ( reciprocal - space ) @xmath20 , the self @xmath21 and the surface @xmath22 contributions are respectively given by : @xmath23[{{{\\mbox{\\boldmath$\\mu$}}}}_j \\cdot ( { { { \\mathbf{r}}}}_{ij}+{{\\mathbf{n } } } ) ] c(\\mid { { { \\mathbf{r}}}}_{ij } + { { { \\mathbf{n}}}}\\mid)\\bigg\\},\\label{energyrr}\\\\ u^{(k)}&=&\\frac{1}{2 l^3}\\sum_{{{\\mathbf{k}}}\\in { { \\bbb{z}}}^3,{{{\\mathbf{k } } } } \\ne    0}\\frac{4\\pi}{k^2}\\exp[-(\\pi k/\\alpha l)^2 ] \\sum_{i=1}^{n}\\sum_{j=1}^{n }   ( { { { \\mbox{\\boldmath$\\mu$}}}}_i \\cdot { { { \\mathbf{k}}}})({{{\\mbox{\\boldmath$\\mu$}}}}_j \\cdot { { { \\mathbf{k } } } } ) \\exp(2 \\pi i { { { \\mathbf{k } } } } \\cdot { { { \\mathbf{r}}}}_{ij}/l),\\label{energykk}\\\\ u^{(self)}&= & -\\frac{2\\alpha^3}{3\\sqrt{\\pi}}\\sum_{i=1}^{n}\\mu_i^2,\\label{energyself}\\\\ u^{(surf)}&=&\\frac{2\\pi}{(2\\epsilon^{\\prime}+1)l^3}\\sum_{i=1}^{n}\\sum_{j=1}^{n}{{{\\mbox{\\boldmath$\\mu$}}}}_i \\cdot { { { \\mbox{\\boldmath$\\mu$}}}}_j.\\label{energysurf}\\end{aligned}\\ ] ] here the sums over @xmath24 and @xmath25 are for the particles in the central box and @xmath26/r^3,\\label{functionb}\\\\   c(r)&=&[3{{\\mbox{erfc}}}(\\alpha r)+(2\\alpha r/\\sqrt{\\pi})(3 + 2\\alpha^2 r^2 )          \\exp(-\\alpha^2 r^2)]/r^5.\\label{functionc}\\end{aligned}\\ ] ] the prime on the third sum in eqn.([energyrr ] ) also denotes that the divergent terms @xmath15 for @xmath27 have to be omitted , @xmath28 is the complementary error function .",
    "the inverse length @xmath5 is the splitting parameter of the ewald summation which should be chosen so as to optimize the performance .",
    "the form eqn.([energysurf ] ) given for the surface correction assumes that the set of the periodic replications of the simulation box tends in a spherical way towards an infinite cluster and that the medium outside this sphere is an uniform dielectric with dielectric constant @xmath29 @xcite .",
    "the case of a surrounding vacuum corresponds to @xmath30 and the surface term vanishes for the metallic boundary conditions ( @xmath31 ) .    in practical calculations ,",
    "the infinite sums in eqns.([energyrr ] , [ energykk ] ) are truncated by only taking into account distances which are smaller than some real space cutoff @xmath3 and wave vectors with a modulus smaller than some reciprocal space cutoff @xmath4 . if @xmath32 , the sum in real space ( eqn.([energyrr ] ) ) reduces to the normal minimum image convention .",
    "the double sum over particles in @xmath20 can be replaced by a product of two single sums which is more suitable for numerical calculations .",
    "the force @xmath33 acting on particle @xmath24 is obtained by differentiating the potential energy @xmath17 with respect to @xmath8 , i.e. , @xmath34 with the real - space and k - space contributions given by : @xmath35+[{{{\\mbox{\\boldmath$\\mu$}}}}_i \\cdot ( { { { \\mathbf{r}}}}_{ij}+{{\\mathbf{n}}})]{{{\\mbox{\\boldmath$\\mu$}}}}_j \\ } c(\\mid { { { \\mathbf{r}}}}_{ij}+{{{\\mathbf{n}}}}\\mid ) \\nonumber \\\\ ~ & -&[{{{\\mbox{\\boldmath$\\mu$}}}}_i \\cdot ( { { { \\mathbf{r}}}}_{ij}+{{\\mathbf{n}}})][{{{\\mbox{\\boldmath$\\mu$}}}}_j \\cdot ( { { { \\mathbf{r}}}}_{ij}+{{\\mathbf{n } } } ) ] d(\\mid { { { \\mathbf{r}}}}_{ij}+{{{\\mathbf{n}}}}\\mid)({{{\\mathbf{r}}}}_{ij}+{{{\\mathbf{n } } } } ) \\bigg{\\}},\\label{forceir}\\\\ { { { \\mathbf{f}}}}^{(k)}_i&=&\\frac{2\\pi}{l^4}\\sum_{j=1}^{n } \\sum_{{{\\mathbf{k}}}\\in { { \\bbb{z}}}^3,{{{\\mathbf{k } } } } \\ne    0}\\frac{4\\pi{{{\\mathbf{k}}}}}{k^2 } ( { { { \\mbox{\\boldmath$\\mu$}}}}_i \\cdot { { { \\mathbf{k } } } } ) ( { { { \\mbox{\\boldmath$\\mu$}}}}_j \\cdot { { { \\mathbf{k } } } } ) \\exp[-(\\pi k/ \\alpha l)^2 ] \\sin(2 \\pi { { { \\mathbf{k } } } } \\cdot { { { \\mathbf{r}}}}_{ij}/l),\\label{forceik}\\end{aligned}\\ ] ] where @xmath36/r^7.\\ ] ] since the self and surface energy terms [ eqns.([energyself ] , [ energysurf ] ) ] are independent of the particle positions , they have no contributions to the force , unlike the ewald summation for the coulomb systems where the surface term contributes .",
    "the torque @xmath37 acting on particle @xmath24 is related to the electrostatic field @xmath38 at the location of this particle , @xmath39 with @xmath40 and thus @xmath41[{{{\\mbox{\\boldmath$\\mu$}}}}_j \\cdot ( { { { \\mathbf{r}}}}_{ij}+{{\\mathbf{n } } } ) ] c(\\mid { { { \\mathbf{r}}}}_{ij } + { { { \\mathbf{n}}}}\\mid)\\bigg\\ } , \\label{torqueir}\\\\ { { \\mbox{\\boldmath$\\tau$}}}_i^{(k)}&=&-\\frac{1}{l^3}\\sum_{j=1}^{n } \\sum_{{{\\mathbf{k}}}\\in { { \\bbb{z}}}^3,{{{\\mathbf{k } } } } \\ne    0}\\frac{4\\pi}{k^2}({{{\\mbox{\\boldmath$\\mu$}}}}_i \\times { { { \\mathbf{k}}}})({{{\\mbox{\\boldmath$\\mu$}}}}_j \\cdot { { { \\mathbf{k } } } } )   \\exp[-(\\pi k/ \\alpha l)^2 ] \\exp(2 \\pi i { { { \\mathbf{k } } } }   \\cdot { { { \\mathbf{r}}}}_{ij}/l ) , \\label{torqueik}\\\\ { { \\mbox{\\boldmath$\\tau$}}}_i^{(surf)}&=&-\\frac{4\\pi}{(2\\epsilon^{\\prime}+1)l^3}\\sum_{j=1}^{n}{{{\\mbox{\\boldmath$\\mu$}}}}_i \\times { { { \\mbox{\\boldmath$\\mu$}}}}_j.\\label{torqueisurf}\\end{aligned}\\ ] ]    when performing computational simulations , it is important to control the accuracy properly . in molecular dynamics methods",
    "the accuracy is generally estimated from the root mean square ( rms ) error in the forces:@xcite @xmath42 where @xmath43 is the force on particle @xmath24 calculated by the algorithm under investigation ( here the ewald sum ) and @xmath44 is the _ exact _ force on that particle . in next section , we will derive estimates for the rms error @xmath45 caused by cutting off the ewald summation in real - space and k - space .",
    "the similar estimates are also derived for the cutoff errors in the total energy and torques .",
    "there are no errors involved in the self and surface contributions ( eqns([energyself ] , [ energysurf ] , [ torqueisurf ] ) ) , because no cutoff operations are applied to them .",
    "the real - space cutoff error in the force on particle @xmath24 can be written as@xcite @xmath46 the idea behind this is that the error on @xmath47 originates from the @xmath48 interactions of particle @xmath24 with the other dipolar particles , and each contribution should be proportional to the product of the two dipole moments involved .",
    "the vector @xmath49 gives the direction and magnitude of the error contribution from two unit dipoles in the simulation box , depending on their separation and orientations .",
    "it follows from eqn.([forceir ] ) that @xmath49 is given by @xmath50rc(r ) \\nonumber \\\\ & - & \\hat{{{\\mathbf{r } } } } \\cos \\vartheta(\\hat{{{\\mbox{\\boldmath$\\mu$}}}}_i , \\hat{{{\\mathbf{r}}}})\\cos \\vartheta(\\hat{{{\\mbox{\\boldmath$\\mu$}}}}_j , \\hat{{{\\mathbf{r}}}})r^3 d(r ) \\bigg\\}\\end{aligned}\\ ] ] where @xmath51 and @xmath52 are unit vectors along the dipole orientations on particles @xmath24 and @xmath25 , @xmath53 is the unit vector along @xmath54 , and the sum in ( [ eqchiij ] ) runs over all the periodic images of particle @xmath25 for @xmath55 .",
    "@xmath56 denotes the angle between the vectors @xmath51 and @xmath52 , @xmath57 the angle between @xmath51 and @xmath53 , and so forth .    to derive the estimate of @xmath58",
    ", we assume that the positions and dipole moment orientations of the particles separated by distances larger than @xmath3 are distributed randomly .",
    "this assumption is certainly not valid for all dipolar systems , but it is reasonable as a starting point . for random systems ,",
    "the error contributions from different particles can be assumed to be uncorrelated @xcite @xmath59 where the angular brackets denote the average over all particle configurations .",
    "obviously , the term @xmath60 - the mean square force error for two unit dipoles - can no longer depend on @xmath24 and @xmath25 and is thus written as @xmath61 . using eqns.([simpdf ] , [ uncorre ] ) , it follows that @xmath62 where the quantity @xmath63 is defined as @xmath64 to obtain the configurational average value @xmath65 , we further assume that @xmath66 which can be shown true for reasonably large systems by the law of large numbers along the line of reasoning of ref .. inserting eq.([deltaf1 ] ) into eqs.([rmsforce ] , [ eq : random ] ) we end up with the relation @xmath67    using eqn.([eqchiij ] ) , it follows @xmath68rc(r ) \\nonumber \\\\ & - & \\hat{{{\\mathbf{r } } } } \\cos \\theta\\cos \\vartheta(\\hat{{{\\mbox{\\boldmath$\\mu$}}}}^{\\prime } , \\hat{{{\\mathbf{r}}}})r^3 d(r)\\bigg{\\}}^2,\\end{aligned}\\ ] ] where @xmath69 and @xmath70 denote the unit orientation vectors of two arbitrary dipoles .",
    "the z - axis of the spherical coordinates ( @xmath71 , @xmath72 , @xmath73 ) is chosen to be along the orientation @xmath69 .",
    "that gives @xmath74 and @xmath75 in the integrand of eqn.([eqchi2 ] ) , all the triangular functions about @xmath76 should be replaced by their configuration average values .",
    "this means that the cross terms which contain odd powers of @xmath77 will vanish due to their zero mean value .",
    "the remaining terms @xmath78 are replaced by their mean values of @xmath79 . following the asymptotic expansion formula @xcite @xmath80 which is valid when @xmath81 and @xmath82/dx \\ll f(x)$ ] for @xmath83 , the complementary error function is approximated by @xmath84 eqn.([ercfapp ] )",
    "is introduced into ( [ eqchi2 ] ) through ( [ functionb ] , [ functionc ] ) .",
    "estimating the integral again with eqn.([asym ] ) gives the approximate expression of @xmath61 .",
    "we obtain @xmath85 where the terms @xmath86 and @xmath87 are given by @xmath88 the resulting rms expectation of the real - space cutoff error in the forces is thus @xmath89 the derivation of the expected real - space cutoff errors in the total potential energy and torques follows the same way . for calculating the fluctuation of the error in total energy , it is noted that the interaction energy between two dipoles is evenly shared between them .",
    "that means the sum of @xmath90 over all particles contains each pair contribution twice and thus the fluctuation of the real - space cutoff error is one half of the sum @xcite .",
    "then the rms value of the real - space cutoff error of the total potential energy is estimated as @xmath91^{1/2 } \\exp(-\\alpha^2 r_c^2)\\ ] ] with @xmath92 the rms error on the torques is estimated similarly to the force as @xmath93^{1/2 } \\exp(-\\alpha^2 r_c^2).\\ ] ] eqn.([forcer ] , [ energyr ] , [ torquer ] ) all contain the exponential @xmath94 . for sufficiently low errors , @xmath95 has to be larger than one , for example @xmath96 for an error of @xmath97 .",
    "if only the highest powers of @xmath95 are retained , the estimates of the real - space cutoff errors in the total energy , forces and torques can be reduced to @xmath98 where eqn.([energyrs ] ) is a factor of @xmath99 slightly larger than that given in eqn.(35 ) of ref .. the advantage of these simplified formulas is that they reflect the dependence of the rms errors on @xmath5 and @xmath3 more directly and thus could be used more easily in determining the optimal values of these parameters .      in deriving the estimates of the reciprocal - space ( k - space ) cutoff errors",
    ", we further assume that the radial distribution function of the particles is approximately unity at all distances . following eqn.([forceik ] ) , the k - space cutoff error in the force acting on particle @xmath24",
    "is given by @xmath100 \\sin ( 2 \\pi { { { \\mathbf{k } } } } \\cdot { { { \\mathbf{r}}}}_{ij}/l).\\ ] ] note that the diagonal term ( @xmath101 ) in the sum does not depend on the positions of the particles .",
    "it will provide a systematic contribution to the cutoff error in k - space @xcite . in eqn.([sumfk ] ) this contribution equals to zero , thus there is no systematic part of the error in the forces .",
    "the same thing happens to the error in the torques .",
    "but for the total energy the diagonal terms are positive and the systematic contribution plays a dominant role in the cutoff error .    the off - diagonal terms in eqn.([sumfk ] )",
    "do depend on the positions of the particles and have alternating signs .",
    "the statistical approach in sec .",
    "iii.a can also be used .",
    "similar to eqn.([simpdf ] ) , the off - diagonal contribution to the cutoff error in @xmath102 is given by @xmath103 with @xmath104   i \\exp(2 \\pi i { { { \\mathbf{k } } } } \\cdot { { { \\mathbf{r } } } } / l),\\ ] ] where @xmath54 stands for @xmath105 and @xmath106 is re - written as @xmath107 according to the symmetrical character of the summation over @xmath108 .",
    "@xmath109 is the unit vector along @xmath108 .",
    "since the particles are assumed to be randomly distributed over the simulation box , the fluctuation of @xmath110 can also be written as @xmath111 again @xmath112 is independent of @xmath24 and @xmath25 . using eqn.([chik1 ] ) , we have @xmath113 k^4 dk \\int_{0}^{\\pi } \\sin\\theta d\\theta \\int_{0}^{2\\pi } \\cos^{2}\\vartheta ( \\hat{{{\\mbox{\\boldmath$\\mu$ } } } } , \\hat{{{\\mathbf{k } } } } ) \\cos^{2}\\vartheta(\\hat{{{\\mbox{\\boldmath$\\mu$}}}}^{\\prime},\\hat{{{\\mathbf{k } } } } ) d\\phi.\\ ] ] choosing the z - axis of the spherical coordinates ( @xmath114 ) along the @xmath69 orientation , the same discussion as in eqn.([eqchi2 ] ) gives @xmath115/15.\\ ] ] the rms expectation of the k - space cutoff error in the forces is thus @xmath116.\\ ] ] here the notation @xmath117 is replaced directly with @xmath118 due to the fact of no diagonal contribution .    the derivation of the off - diagonal parts of the cutoff errors in the total energy and torques proceeds in the same way . that the sum over @xmath119 contains each pair contribution",
    "twice has also been considered in the error estimate of the total energy .",
    "the results are given by @xmath120 , \\label{offuk}\\\\ \\delta \\tau^{(k ) } & \\approx &   4 { { \\mathcal m}}^2 l^{-2 } \\alpha ( \\pi k_c/5n)^{1/2 } \\exp[-(\\pi k_c/ \\alpha l)^2 ] .",
    "\\label{torquek}\\end{aligned}\\ ] ] @xmath121 is also used directly instead of @xmath122 .",
    "the diagonal ( systematic ) part of the cutoff error in the total energy can be written as @xmath123 \\label{ukoff } \\nonumber \\\\ ~&\\approx & \\frac{2 \\pi}{l^{3 } \\sqrt{n } } { { \\mathcal m}}^2 \\int_{k_c}^{\\infty } \\exp[-(\\pi k/ \\alpha l)^2 ] k^2 dk \\int_{0}^{\\pi } \\sin \\theta d\\theta \\int_{0}^{2\\pi } \\cos^2\\vartheta(\\hat{{{\\mbox{\\boldmath$\\mu$}}}},\\hat{{{\\mathbf{k } } } } ) d\\phi \\nonumber \\\\ ~&\\approx & \\frac{4}{3 } { { \\mathcal m}}^2 l^{-1 } \\alpha^2 k_c n^{-1/2 }   \\exp[-(\\pi k_c/ \\alpha l)^2],\\end{aligned}\\ ] ] where the sum is again approximated by an integral and the asymptotic expansion formula of eqn.([asym ] ) is used to get the final estimate .",
    "the total k - space cutoff error in the total energy is thus @xmath124 comparing eqn.([ukdiag ] ) with ( [ offuk ] ) , it can be seen that the systematic part of the error is a factor of @xmath125 larger than the statistical part .",
    "hence the systematic contribution is dominant in the k - space cutoff error of the total energy .    assuming that the real - space and reciprocal - space contributions to the error are independent , the total cutoff error in ewald summation can be written as @xmath126 where @xmath127 stands for @xmath128 and @xmath129 .",
    "in this section , we carry out numerical experiments to check the validity of the error estimates derived in the previous section .    in order to make our measurements fully reproducible",
    ", we choose the test system to be consistent with the one described in appendix d of a previous publication:@xcite 100 particles randomly distributed within a cubic box of length @xmath130 , each of them has a unit point - dipole at the center . the coordinates and dipole orientations of the 100 particles",
    "are constructed by generating 500 random numbers @xmath131 ( @xmath132 ) between @xmath133 and @xmath134 .",
    "the first 300 random numbers give the cartesian coordinates of the particles as ( @xmath135 ) .",
    "the remaining 200 numbers distribute the dipole orientations uniformly over a unit sphere s surface by the following way : @xmath136 yielding ( @xmath137 ) .",
    "the function @xmath138 which can be found in many @xmath139 libraries is used as the random number generator .",
    "thus the positions of the particles are exactly the same as that discussed in refs .. our unit conventions are as follows : lengths are measured in @xmath140 and dipoles in @xmath141 .",
    "hence the unit of the energy , force and torque are @xmath142 and @xmath143 , respectively .",
    "the _ exact _ energy , forces and torques are obtained by performing a direct summation in real space with eqn.([unormal ] ) and the related derivatives .",
    "the sum over @xmath12 is built up in a spherical way up to @xmath144 .",
    "the ewald summation calculations are carried out under vacuum condition ( @xmath30 ) in order to compare the results with the direct summation@xcite .",
    "the rms errors in the forces and torques are evaluated directly with the definition of eqn.([rmsforce ] ) .",
    "however , it is inconvenient to do this for the energy due to the existence of the constant contributions ( @xmath21 and @xmath22 ) , so the rms error in the total energy is simply taken as @xmath145 where the angular brackets denote the configuration average .",
    "if only one specific random system is considered , the use of eqn.([rmsenergy ] ) may make the result on @xmath146 somewhat sensitive to the details of the generated configuration .",
    "but it is easy to see that this sensitivity can be diminished by taking an average over several configurations .    in the first step ,",
    "we fix the real - space cutoff to @xmath147 @xmath148 .",
    "the k - space cutoff @xmath4 changes from @xmath149 to @xmath150 .",
    "the resulting curves for the rms errors in the forces and torques are plotted in fig.1(a ) and ( b ) together with the analytical estimates derived in sec .",
    "iii . to avoid the unfavorable sensitivity to configuration details , the result on the rms error of the total energy [ fig.1(c ) ]",
    "is taken from an average over @xmath151 random configurations which are generated one after the other in the same way as the model system .",
    "fig.1(a - c ) show that for each @xmath4 there exists an optimal value of @xmath5 which gives the minimum rms errors . for smaller values of @xmath5 , the error contribution from the real - space",
    "is dominant , while for larger values the k - space contribution dominates .",
    "it can be clearly seen that the analytical estimates accurately predict both the real - space and k - space contributions to @xmath45 , @xmath152 and @xmath146 for all values of @xmath5 .",
    "only for very small values of @xmath4 deviations are observed for large @xmath5 . as will be shown in the next section",
    ", this permits an easy way to determine the optimal parameters for a predefined accuracy .",
    "the discrepancy in the k - space part at very low @xmath4 is to be expected as the replacement of the summation over @xmath108 with an integral in eqn.([chik2 ] ) turns to be a rather crude approximation at this time .",
    "since the optimal values of @xmath4 for the ewald method are ranging between @xmath153 and @xmath154 @xcite , this discrepancy does not affect the validity of the analytical estimates .",
    "as accuracy on the energy may be obscured by unimportant constant contributions and is sensitive to fluctuations , the rms errors on the forces and torques are more suitable for the accuracy measurements in md simulations .",
    "furthermore , since fig.1(a , b ) show the similar behavior of @xmath45 and @xmath152 as function of @xmath5 and @xmath4 ( for example , they give the same optimal value of @xmath5 for each @xmath4 ) , we will concentrate on discussions of @xmath45 in the remaining part of this paper .",
    "the same kind of results , however , have been achieved for @xmath146 and @xmath152 in all the following cases .",
    "as most discussions are focused on the k - space error contributions in fig.1 by changing @xmath4 , we fix @xmath4 in the next step and change different values for @xmath3 in order to further investigate the accuracy of the analytical estimates in predicting the real - space error contributions",
    ". the same model system as in fig.1(a , b ) is studied .",
    "@xmath4 is fixed to 8 and @xmath3 is taken to be @xmath155 and @xmath156 , respectively . for comparison , both eqn.([forcer ] ) and",
    "( [ forcers ] ) are used to estimate @xmath157 .",
    "the results in fig.2 show that the former formula precisely gives the real - space contribution to @xmath45 for all values of @xmath3 .",
    "as expected , eqn.([forcers ] ) underestimates @xmath157 at small values of @xmath5 . since eqns.([energyrs]-[torquers ] ) are obtained under the assumption of @xmath158 , the valid range of these simplified formulas shifts to larger @xmath5 with decrease of @xmath3 . however , if an accuracy as @xmath159 is required in a md simulation so that @xmath5 could not be very small considering the practical limitation of @xmath160 , these estimates are almost as accurate as the full formulas [ eqns.([forcer ] ) , ( [ energyr ] ) and ( [ torquer ] ) ] .    the last step is to demonstrate that the scaling of the rms errors with the particle number and dipole moment distribution is correctly given by @xmath161 .",
    "three random systems which differ only in the values of @xmath162 and @xmath6 are investigated .",
    "the first system is the same as that studied in fig.1 - 2 .",
    "the second system contains 200 particles among which 100 have a dipole strength of @xmath141 and the other 100 have @xmath163 .",
    "the third one contains 400 particles : 100 with @xmath141 , 200 with @xmath164 and 100 with @xmath165 .",
    "hence their values of @xmath166 are respectively given by ( 100 , 100 ) , ( 1000 , 200 ) and ( 10000 , 400 ) , and the ratio of their prefactors is thus @xmath167 . the results of @xmath45 in fig.3 clearly reflect this scaling behavior by the constant shift of the three curves with respect to each other ( note the logarithmic scale in the vertical axis ) . the analytical estimates predict the rms errors very precisely in all the three cases .",
    "in this section , we discuss the use of the analytical formulas derived in sec .",
    "iii to determine the optimal values of @xmath5 , @xmath3 and @xmath4 by which the required accuracy could be satisfied and the computation time is minimized .",
    "the detailed discussions on this subject can also be found in refs ..    the overall computation time for computing the forces with the ewald method is approximately given by @xcite @xmath168 where the primitive overheads @xmath169 and @xmath170 highly depend on the implementation of the code and need to be found by numerical experiments .",
    "as an example , we have carried out the time experiments on a dec personal workstation ( cpu 433mhz ) using a standard fortran 77 compiler . in the implementation the complementary error function and its derivative are calculated with table lookup and the reciprocal - space summation is optimized as in refs .. the linked - cell method is used to deal with the short - range forces ( when doing simulations ) .",
    "the primitive overheads are then found roughly to be @xmath171 and @xmath172 .    for a required accuracy @xmath173 , the parameters @xmath5 , @xmath3 and @xmath4 should be chosen to minimize @xmath174 with respect to the two constraints of the error bounds [ eqns.([forcer ] ) and ( [ forcek ] ) ] , which are restated as @xmath175 . \\label{restatek}\\end{aligned}\\ ] ] in case of @xmath176 , eqn.([forcers ] ) could be used instead of ( [ forcer ] ) so as to show the dependence of the accuracy on the parameters more clearly .",
    "eqn.([restater ] ) and ( [ restatek ] ) provide the qualitative function relations of @xmath3 and @xmath4 with @xmath5 as : @xmath177 and @xmath178 . inserting them into eqn.([time ] ) and differentiating it with respect to @xmath5 yields @xmath179 and thus @xmath180 and @xmath181 .",
    "the minimized computation time is then proportional to @xmath1 with the proportionality constant depending on the accuracy .",
    "the same results can be found for the coulomb ewald method in refs .. this can be easily understood by comparing eqns.([forcer ] ) and ( [ forcek])in sec .",
    "iii of this paper with eqns.(18 ) and ( 32 ) in ref . and finding the same exponential dependences of the cutoff errors on @xmath5 , @xmath3 and @xmath4 for the dipolar and coulomb ewald summations .",
    "the numerical investigation of the functional dependence of the optimal parameters on @xmath6 and @xmath173 are performed by using the primitive overheads obtained above . for",
    "each given @xmath6 and @xmath173 , we at first choose different values for @xmath3 within the inequality @xmath182 .",
    "for each @xmath3 the parameters @xmath5 and @xmath4 are calculated by solving eqns.([restater ] ) and ( [ restatek ] ) .",
    "these values are then introduced into eqn.([time ] ) to figure out the optimal value of @xmath3 which gives the minimum computation time . in calculations the size of the simulation cell is fixed to a dimensionless length of @xmath183 .",
    "the range of accuracy requirement and number of particles are chosen to be @xmath184 to @xmath185 measuring in @xmath186 and @xmath187 to @xmath188 which should cover most of the applications .",
    "the particles are supposed to have an uniform dipole moment of @xmath141 .",
    "the results for the optimal values of the parameters and the corresponding computation time per particle are shown in fig .",
    "4(a - d ) , respectively .",
    "it can be clearly seen that the functional dependence of the parameters and the overall computation time on @xmath6 are just as discussed above .",
    "fig.4(c ) shows that when a high accuracy is required for a system with a small number of particles , the predicted real - space cutoff is larger than half of the box length and @xmath189 must be used .",
    "the optimal @xmath5 values hardly depend on the accuracies .",
    "these results are very similar to that obtained for the coulomb ewald summation in ref .",
    ", except for @xmath180 here and @xmath190 there .",
    "this is because they considered a system of constant density , while we choose the volume of the simulation cell to be constant .",
    "so far we have only used the homogeneous random systems to test the error estimates .",
    "this is of course not always the case in computer experiments .",
    "many simulations will encounter the problem of highly nonuniform distributions of particles . in this section",
    "we use an anisotropic dipolar system to investigate the influence of the inhomogeneity on the rms errors .",
    "the dipolar system we studied is an electrorheological ( er ) fluid consisting of spherical dielectric particles with uniform diameter @xmath191 dispersed in a solvent . in the initial configuration @xmath192 particles",
    "are randomly distributed in a cubic simulation box with side length of @xmath193 , which gives a typical volume fraction of particles as @xmath194 . upon application of an external electric field ,",
    "the dielectric particles are polarized .",
    "each particle has an uniform dipole moment along the field direction ( z - axis ) at its center under the point - dipole approximation .",
    "the electrostatic interaction between the particles will draw them to form chain or cluster structures along the field direction .",
    "this structuring process of the er system in the quiescent state is studied by the brownian dynamic simulation method described in our previous paper @xcite .",
    "the final configuration , which is used for the rms error calculation , is obtained after a long enough simulation time when there is no obvious structure evolution in the system .",
    "the formation of several thick chain - like structures has been observed in the snapshot of the system .",
    "it is also reflected clearly by the appearance of the sharp peaks at the positions of @xmath195 in the radial distribution function ( rdf ) @xmath196 of the final configuration shown in fig.5 , where the rdf of the initial configuration is also plotted for comparison . the rms force error @xmath45 and the corresponding estimates [ eqns.([forcer ] ) and ( [ forcek ] ) ] for the final configuration are given in fig.6 .",
    "a deviation of the estimates from the numerical results could be observed . at smaller values of @xmath5",
    "the prediction of the estimates is smaller than that given by the algorithm , while at large values of @xmath5 it is larger than the actual one . by studying the derivation of the error",
    "estimates , this could be understood qualitatively by the reason that the formation of the chain structures leads to higher local density of the particles and thus results in higher rms errors in the real - space part @xcite .",
    "though this effect also exists in the k - space part , the well ordering , or in other word well spacing , of particles along the z - direction leads to an enhanced k - space accuracy .",
    "this could be partially seen from eqn.([forceik ] ) where only the z - component @xmath197 involves in the calculation due to the z - direction orientation of the dipole moments in this case .    from the numerical curve in fig.6",
    ", the optimal splitting parameter is given to be @xmath198 with a corresponding @xmath199 , while the intersection point of the real and reciprocal space estimates occurs at @xmath200 , which predicts an error of @xmath201 by eqn.([restater ] ) and ( [ restatek ] ) .",
    "if the estimated value of @xmath5 is used , this would result in an error of @xmath202 , which is about @xmath203 larger than that at the calculated optimal value of @xmath5 .",
    "if such a safety margin has already been considered at the beginning of the simulation , the determination of the optimal parameters discussed in the previous section is still a good approach .",
    "in addition , it should be noted that the structure studied in fig.6 is an extreme case in the simulations of er fluids or similar systems such as magnetorheological ( mr ) fluids and ferrofluids . when the thermal agitation is comparable with the dipolar interactions , or even more a shear flow is introduced , the percolating chains or columns will be broken into clusters .",
    "the distribution and orientation of the smaller clusters would have more random characters compared with that studied in this section , and thus a smaller discrepancy between the estimates and actual numerical results could be expected . in any case , if it is suspected that the development of strongly inhomogeneities in the systems may lead to potential failure of the presented error formulas , some simple numerical tests as performed above could provide valuable informations .",
    "the analytical formulas for the cutoff errors in the ewald summation for dipolar systems have been derived in closed form .",
    "errors in the total energy , forces and torques are all considered .",
    "the high quality of these estimates has been proven in different random systems , and thus provides an easy way to determine the optimal tuning parameters which can give the expected accuracy , but minimize the computation time .",
    "based on this , the functional dependence of the optimal splitting parameter @xmath5 , real - space cutoff @xmath3 and reciprocal - space cutoff @xmath4 on the number of particles @xmath6 are discussed qualitatively and confirmed numerically by the timing experiments .",
    "although the validity of the error estimates is subject to some additional requirements , such as the homogeneity of the system , a consultation of these formulas and a priori estimate of the optimal parameters should always be a good starting point in using the ewald summation for simulations of dipolar systems .",
    "we thank h. w. mller and b. dnweg for helpful discussions . financial support from the dfg is gratefully acknowledged .",
    "( a ) , torques @xmath152 ( b ) and total energy @xmath146 ( c ) as a function of the splitting parameter @xmath5 . the results on @xmath45 and @xmath152 are obtained for the model system of 100 randomly distributed dipoles , while @xmath146 is calculated from an average over 10 random configurations which are generated in the same way as the model system .",
    "the real - space cutoff is taken to be @xmath147 .",
    "the dot - dashed curves are the corresponding real - space error estimates achieved with eqn.([forcer ] , [ torquer ] ) and ( [ energyr ] ) .",
    "the dashed curves are the k - space error estimates obtained with eqn.([forcek ] , [ torquek ] ) and ( [ energyk ] ) .",
    "the units of the energy , force and torque are @xmath204 and @xmath143 , respectively.,title=\"fig:\",height=15 ]   ( a ) , torques @xmath152 ( b ) and total energy @xmath146 ( c ) as a function of the splitting parameter @xmath5 . the results on @xmath45 and @xmath152 are obtained for the model system of 100 randomly distributed dipoles , while @xmath146 is calculated from an average over 10 random configurations which are generated in the same way as the model system . the real - space cutoff is taken to be @xmath147 .",
    "the dot - dashed curves are the corresponding real - space error estimates achieved with eqn.([forcer ] , [ torquer ] ) and ( [ energyr ] ) .",
    "the dashed curves are the k - space error estimates obtained with eqn.([forcek ] , [ torquek ] ) and ( [ energyk ] ) .",
    "the units of the energy , force and torque are @xmath204 and @xmath143 , respectively.,title=\"fig:\",height=15 ]     ( a ) , torques @xmath152 ( b ) and total energy @xmath146 ( c ) as a function of the splitting parameter @xmath5 . the results on @xmath45 and @xmath152 are obtained for the model system of 100 randomly distributed dipoles , while @xmath146 is calculated from an average over 10 random configurations which are generated in the same way as the model system . the real - space cutoff is taken to be @xmath147 .",
    "the dot - dashed curves are the corresponding real - space error estimates achieved with eqn.([forcer ] , [ torquer ] ) and ( [ energyr ] ) .",
    "the dashed curves are the k - space error estimates obtained with eqn.([forcek ] , [ torquek ] ) and ( [ energyk ] ) .",
    "the units of the energy , force and torque are @xmath204 and @xmath143 , respectively.,height=15 ]     for the model system .",
    "the k - space cutoff is taken to be @xmath205 . from top",
    "to bottom the real - space cutoff varies like @xmath206 .",
    "the dot - dashed curves are the corresponding real - space error estimates achieved with eqn.([forcer ] ) .",
    "the results obtained with the simplified formula eqn.([forcers ] ) ( the dotted curves ) are also shown for comparison .",
    "the dashed curves are the k - space error estimates obtained with eqn.([forcek ] ) .",
    "the unit of the force is @xmath186.,height=14 ]     scaling of @xmath45 .",
    "the three solid lines show the rms error @xmath45 for systems which are different in their @xmath166 values . from top to bottom they are characterized by ( 10000 , 400 ) , ( 1000 , 200 ) and ( 100 , 100 ) ( the last one is the model system discussed in fig.(1 - 2 ) ) . the real and k - space cutoffs are @xmath147 and @xmath205 , respectively .",
    "the dot - dashed and dashed curves are the corresponding real - space and k - space error estimates obtained with eqn.([forcer ] ) and ( [ forcek ] ) , respectively . the unit of the force is @xmath186.,height=14 ]                 for the final structure of the electrorheological system studied ( solid line ) .",
    "the dot - dashed line is the error estimate for the real - space contribution [ eqn.([forcer ] ) ] and the dashed line is that for the k - space [ eqn.([forcek ] ) ] .",
    "the unit of the force is @xmath208.,height=14 ]"
  ],
  "abstract_text": [
    "<S> theoretical estimates for the cutoff errors in the ewald summation method for dipolar systems are derived . </S>",
    "<S> absolute errors in the total energy , forces and torques , both for the real and reciprocal space parts , are considered . </S>",
    "<S> the applicability of the estimates is tested and confirmed in several numerical examples . </S>",
    "<S> we demonstrate that these estimates can be used easily in determining the optimal parameters of the dipolar ewald summation in the sense that they minimize the computation time for a predefined , user set , accuracy . </S>"
  ]
}