{
  "article_text": [
    "the structure and evolution of the magnetic field ( and the associated electric currents ) that permeates the solar atmosphere play key roles in a variety of dynamical processes observed to occur on the sun .",
    "such processes range from the appearance of extreme ultraviolet ( euv ) and x - ray bright points , to brightenings associated with nanoflare events , to the confinement and redistribution of coronal loop plasma , to reconnection events , to x - ray flares , to the onset and liftoff of the largest mass ejections .",
    "it is believed that many of these observed phenomena take on different morphologies depending on the configurations of the magnetic field , and thus knowledge of such field configurations is becoming an increasingly important factor in discriminating between different classes of events .",
    "the coronal topology is thought to be a critical factor in determining , for example , why some active regions flare , why others do not , how filaments form , and many other topics of interest .",
    "one model of the coronal magnetic field @xmath0 assumes that the corona is static and free of lorentz forces , such that @xmath1 , where @xmath2 is the current density .",
    "this means that @xmath3 , and thus any electric currents must be aligned with the magnetic field . because @xmath4 , it can be shown that @xmath5 , demonstrating that @xmath6 is invariant along field lines of @xmath0 .",
    "the scalar @xmath6 is in general a function of space and identifies how much current flows along each field line . in cases where @xmath6 varies spatially , the problem of solving for @xmath0 ( and @xmath6 ) is nonlinear .",
    "solving for such nonlinear force - free fields ( nlfffs ) requires knowledge of @xmath0 over the complete bounding surface @xmath7 enclosing the solution domain . to be compatible with a force - free field ,",
    "it is necessary for these boundary data @xmath8 to satisfy a number of consistency criteria , which we outline in  [ sec : construction ] and which are explained in detail in @xcite and in @xcite .    in analyzing solar active regions , localized maps of the photospheric vector field",
    "are typically used for the lower bounding surface @xmath9 , and potential fields are used for the other surfaces .",
    "( for the cartesian models discussed herein , we use the convention that the @xmath10 axis is normal to the photosphere , which is located at height @xmath11 . ) the availability of vector field maps produced by recent instrument suites such as the synoptic optical long - term investigations of the sun ( solis ) facility and the hinode spacecraft , building on earlier work done in hawaii with data from the haleakal stokes polarimeter ( hsp ) and by the imaging vector magnetograph ( ivm ) as well as from the hao / nso advanced stokes polarimeter ( asp ) at sacramento peak in new mexico , has spurred investigations that employ coronal - field models based on such measurements .",
    "we anticipate that such research will intensify when regular , space - based vector field maps from the helioseismic and magnetic imager ( hmi ) instrument on board the solar dynamics observatory ( sdo ) become available",
    ".    one goal of nlfff modeling is to provide useful estimates of physical quantities of interest ( e.g. , connectivities , free energies , and magnetic helicities ) for ensembles of active regions , so that these active regions may be systematically analyzed and intercompared .",
    "the use of static , force - free models mitigates some of the computational difficulties associated with solving the more physically realistic , time - dependent problem , as running such dynamical models at the desired spatial and temporal resolutions for multiple active regions typically exceeds current computing capabilities .    there",
    "exist several previous studies of individual active regions where nlfff models are shown to be compatible with various structures in the corona ( e.g. , @xcite ) .",
    "several of these studies provide evidence of good alignment between nlfff model field lines and the locations of observed features such as coronal loop structures observed in euv and x - ray images .",
    "others show that the locations of sigmoids , twisted flux ropes , and/or field line dip locations coincide with analogous features in the nlfff models .",
    "such studies are certainly encouraging , but still it remains difficult to conclusively determine whether these models match a significant fraction of the coronal magnetic field located within the volume overlying an entire active region .    as part of a long - lasting ( e.g. , @xcite ) effort to develop methods that generate more robust nlfff models , a working group ( in which all of the authors of this article are participating ) has held regular workshops over the past several years .",
    "the previous results from this collaboration are presented in @xcite , @xcite , and @xcite . since the launch of hinode in 2006",
    ", we have applied multiple nlfff modeling codes to a few active regions for which hinode vector magnetogram data are available and for which nonpotential features are evident ( e.g. , @xcite ) .",
    "the resulting nlfff models generally differ from each other in many aspects , such as the locations and magnitudes of currents , as well as measurements of magnetic energy in the solution domain . in this article",
    ", we identify several problematic issues that plague the nlfff - modeling endeavor , and use a recent hinode case to illustrate these difficulties .",
    "we describe one representative data - preparation scheme in  [ sec : construction ] , followed in  [ sec : validation ] by a comparison of field lines in the resulting nlfff models to two- and three - dimensional coronal loop paths , the latter determined by analyzing pairs of stereoscopic images . in  [ sec : discuss ] , we explain the primary issues that we believe to impact our ability to reconstruct the coronal field in a robust manner , and also identify and discuss the alternate data - preparation scenarios we tried in addition to those presented in  [ sec : construction ] . concluding remarks are presented in  [ sec : conc ] .",
    "several nlfff extrapolation algorithms ( each implementing one of the three general classes of extrapolation methods ) were applied to boundary conditions deduced from a scan of noaa active region  ( ar ) 10953 , taken by the spectro - polarimeter ( sp ) instrument of the solar optical telescope ( sot ) @xcite on board the hinode spacecraft .",
    "the hinode / sot - sp scan of this active region started at 22:30  ut on 2007 april  30 and took about 30  min to complete .",
    "as the scan progressed , polarization spectra of two magnetically sensitive fe  i lines at 6301.5  and 6302.5  were obtained within the 0@xmath1216@xmath13164@xmath14 slit , from which stokes iquv spectral images were generated . for this scan ( in `` fast - map '' mode ) , the along - slit and slit - scan sampling was 0@xmath1232 , and the total width of of the scan was 160@xmath14 . ar  10953 produced a c8.5 flare about two days after this hinode / sot - sp scan , and a c4.2 flare about four and a half days after this scan , but otherwise the active region was flare - quiet above the c1.0 level .",
    "images from the x - ray telescope ( xrt ) @xcite on board hinode around this time show a series of bright loops in the central region of ar  10953 ( fig .",
    "[ fig1]a ) .",
    "the nlfff algorithms need vector magnetic data as boundary conditions , and determining these boundary maps comprises the first step in constructing a nlfff model .",
    "the conditions pertaining to the lower boundary are determined from a map of the photospheric vector magnetic field from the hinode / sot - sp instrument .",
    "the magnetic components parallel to and transverse to the line of sight , @xmath15 and @xmath16 , are functions of the circular and linear polarization signals , respectively .",
    "constructing @xmath9 requires assuming an atmospheric model ( in this case milne - eddington ) and determining which combinations of magnetic field strengths and filling factors produce the observed polarization signals ( e.g. , @xcite ) .",
    "@xmath15 has uncertainties that are typically an order of magnitude less than @xmath16 .",
    "the next step involves removing the ambiguities in the components of @xmath16 that arise due to the property that the same linear polarization signal can be produced by either of two magnetic field vectors differing by 180@xmath17 of azimuth in the transverse plane .",
    "we choose to perform the disambiguation using the interactive azimuthal ambiguity method ( azam ) , which is one of several methods have been devised and tested to resolve this ambiguity ( see @xcite , and references therein ) .",
    "after disambiguation , the @xmath9 map for ar  10953 is used to produce potential field data with which the extrapolation codes will initialize the computational domain .",
    "our approach is to specify the computational domain ( having an enclosing surface @xmath7 ) that contains much of the coronal volume overlying the active region of interest , such that the lower boundary includes the area for which vector magnetogram data are available .",
    "the initialization field is calculated by embedding the hinode / sot - sp vector magnetogram data in a larger line - of - sight magnetogram observed by the michelson doppler imager ( mdi ) instrument @xcite on board the solar and heliospheric observatory ( soho ) spacecraft ( as shown in fig . [ fig1]d ) .",
    "then , the potential field coefficients corresponding to this enlarged footprint are determined , from which the potential field in the 320@xmath13320@xmath13256-pixel nlfff computational domain is computed .",
    "in addition , the vector field boundary conditions for the side and top boundaries of the computational domain are taken from this same potential field extrapolation , primarily because we expect that the coronal magnetic field becomes largely potential away from the center of the active region , but also because it is useful to specify how unbalanced flux emanating from this active region connects to flux of the opposite polarity located elsewhere on the sun .",
    "the embedded lower - boundary data are then sampled onto a uniform , helioplanar , 320@xmath13320-pixel grid having 580  km pixels , such that the footprint of the computational domain spans a 185.6-mm - square area .",
    "the region for which hinode vector magnetogram data for ar  10953 were available comprise about a 100-mm - by-115-mm subarea of the full lower boundary footprint , outside of which the horizontal components of @xmath9 are set to zero .",
    "thus , in this peripheral region outside the hinode / sot - sp field of view , the field on the lower boundary can either be considered as purely vertical ( for force - free methods which use all three components of the field as boundary conditions ) , or equivalently as having zero vertical current ( for methods which use the vertical component of the field together with the vertical component of the current density ) .",
    "next , to be consistent with a force - free field , it is necessary ( but not sufficient ) that the entire boundary field @xmath8 satisfy several criteria , as delineated in @xcite and in @xcite : namely , ( 1 ) the volume - integrated lorentz force must vanish , ( 2 ) the volume - integrated magnetic torque must vanish , and ( 3 ) the amount of negative - polarity flux through @xmath8 having a given value of @xmath6 must equal the positive - polarity flux through @xmath8 with this same value of @xmath6 .",
    "the first two criteria are relations involving various components of @xmath8 , and are derived from volume integrals of the lorentz force and its first moment .",
    "the third ( `` @xmath6-correspondence '' ) relation operates over all values of @xmath6 present on @xmath8 .",
    "there is of course no guarantee , however , that the values of @xmath9 , coupled with the potential field of @xmath0 for the complement of the enclosing surface , together satisfy these consistency criteria .",
    "our working group attempts to deal with this problem by preprocessing the boundary data before feeding them to the extrapolation codes .",
    "the preprocessing scheme used here ( developed by @xcite ) seeks to adjust the components of @xmath9 so as to satisfy the first two consistency criteria while minimizing the deviations of @xmath9 from their measured values . during this preprocessing step , spatial smoothing",
    "is also applied to @xmath9 to attenuate some of the small - scale magnetic fluctuations that likely die off shortly above the photosphere .",
    "finally , we apply the various nlfff algorithms to these boundary and initial data .",
    "several methods for calculating nlfff models of the coronal magnetic field have been developed and implemented in recent years , including ( 1 ) the optimization method , in which the solution field is evolved to minimize a volume integral such that , if it becomes zero , the field is divergence- and force - free @xcite ; ( 2 ) the evolutionary magnetofrictional method , which solves the magnetic induction equation using a velocity field that advances the solution to a more force - free state @xcite ; and ( 3 ) grad - rubin - style current - field iteration procedures , in which currents are added to the domain and the magnetic field is recomputed in an iterative fashion @xcite .",
    "some of these methods have been implemented by multiple authors .",
    "for brevity , we omit detailed explanations of these numerical schemes as implemented here and instead direct the reader to @xcite and @xcite , and references therein .",
    "although these methods work well when applied to simple test cases @xcite , we have found that the results from each of the methods typically are not consistent with each other when applied to solar data .",
    "the resulting magnetic field configurations differ both qualitatively ( e.g. , in their connectivity ) as well as quantitatively ( e.g. , in the amount of magnetic energy contained within them ) .",
    "in discussing the results from the solar - like test case of @xcite , we described some likely causes of such discrepancies amongst the models . in",
    "what follows , we illustrate these problems in greater detail using the ( solar ) data set at hand .    lcccc    pot & 1.00 &  & 0.02 & 24@xmath17 + wh@xmath18 & 1.03 & 0.24 & 7.4 & 24@xmath17 + tha & 1.04 & 0.52 & 34 . &",
    "25@xmath17 + wh@xmath19 & 1.18 & 0.16 & 1.9 & 27@xmath17 + val & 1.04 & 0.26 & 71 . &",
    "28@xmath17 + am1@xmath19 & 1.25 & 0.09 & 0.72 & 28@xmath17 + am2@xmath19 & 1.22 & 0.12 & 1.7 & 28@xmath17 + can@xmath19 & 1.24 & 0.09 & 1.6 & 28@xmath17 + wie & 1.08 & 0.46 & 20 . &",
    "32@xmath17 + mct & 1.15 & 0.37 & 15 . &",
    "38@xmath17 + rg@xmath19 & 1.04 & 0.37 & 6.2 & 42@xmath17 + rg@xmath18 & 0.87 & 0.42 & 6.4 & 44@xmath17 +    [ table1 ]",
    "the results of twelve extrapolations for ar  10953 ( including the potential field ) , based on the data - preparation steps described in  [ sec : construction ] , are summarized in table  [ table1 ] and figure  [ fig3 ] .",
    "table  [ table1 ] contains domain - averaged metrics characterizing the center of the active region ( corresponding to the region surrounding the leading , negative - polarity sunspot ) , and figure  [ fig3 ] shows representative field lines in this same volume for each of these models .",
    "this central region is a 160@xmath13160@xmath13160-pixel volume , chosen to cover the portion of the lower boundary containing much of hinode / sot - sp magnetogram data ( i.e. , where we have some knowledge about the currents passing through the photosphere ) , and is fully contained within the larger 320@xmath13320@xmath13256-pixel computational domain .",
    "the models considered in table  [ table1 ] and figure  [ fig3 ] are the current - field iteration method as run by wheatland using the values of @xmath6 in either the negative or positive polarity ( hereafter `` wh@xmath19 '' and `` wh@xmath18 '' , respectively ) ; the finite - element grad - rubin - style method ( femq in @xcite ) run using two different parameter sets by amari ( `` am1@xmath19 '' and `` am2@xmath19 '' ) ; the vector - potential grad - rubin - like method ( xtrapol in @xcite ) by canou ( `` can@xmath19 '' ) , or by rgnier using the values of @xmath6 in either the positive ( `` rg@xmath18 '' ) or negative ( `` rg@xmath19 '' ) polarity ; the optimization method using grid refinement as run by wiegelmann ( `` wie '' ) or mctiernan ( `` mct '' ) , or no grid refinement as run by thalmann ( `` tha '' ) ; the magnetofrictional method using grid refinement as run by valori ( `` val '' ) ; and the initial potential solution ( `` pot '' ) .",
    "we find that the am1@xmath19 , am2@xmath19 , can@xmath19 , and wh@xmath19 current - field iteration models contain between 18% and 25% more energy than the potential solution , and have smaller residual lorentz forces and smaller average @xmath20 than the other models .",
    "in addition , the am1@xmath19 , am2@xmath19 , and can@xmath19 models find a strongly twisted flux rope in equilibrium , whose foot points are anchored southeast of the main spot ( mostly outside of the core volume shown in fig .",
    "[ fig3 ] ) , a feature which was anticipated by the analysis of @xcite .",
    "models using the optimization method ( mct , wie , and tha ) contain between 4%15% more energy than the potential solution , but possess more residual lorentz forces than the current - field iteration solutions .",
    "the magnetofrictional model ( val ) has more energy than the potential solution but has larger values of @xmath20 than the optimization or current - field iteration solutions .",
    "based on the results summarized in table  [ table1 ] , the excess magnetic energy ( above the potential field ) for this active region could be anywhere from near zero to about 25% of the potential field energy .",
    "however , it is also possible that the excess energy is significantly larger than 25% when taking into account the uncertainty associated with the inconsistency between the boundary data and the force - free - model assumption ( see  [ sec : chromosphere ] ) .    because of these differences in the resulting nlfff models of ar  10953",
    ", we perform a goodness - of - fit test to determine which of the nlfff models is the best approximation to the observed coronal magnetic field . in the earlier study of @xcite",
    ", we performed this test in both a qualitative and quantitative manner using euv and x - ray imagery , provided respectively by the transition region and coronal explorer ( trace ) and hinode / xrt instruments , by determining which model possessed field lines that were more closely aligned with the projected coronal loop structures visible in the ( two - dimensional ) image plane .",
    "models for which most field lines appeared to be aligned with loops were considered good approximations to the actual coronal magnetic field .",
    "locations where the field was noticeably sheared or twisted were of particular interest because such patterns are usually indicative of the presence of currents ( which the modeling seeks to ascertain ) .",
    "more weight was typically given to regions connected to places at the photospheric boundary where @xmath21 is found to be high , whereas coronal loops located in the periphery of the active region with footpoints located where @xmath21 was lower were likely to be less sensitive to the presence of currents elsewhere in the active region .",
    "for ar  10953 , we overlaid field lines from all of the nlfff models ( as well as the potential field model ) on top of the time - averaged hinode / xrt image shown in figure  [ fig1]a , and used the same criteria listed above to qualitatively determine the better - matching models .",
    "we subjectively judged the field lines in the wh@xmath19 , am1@xmath19 , am2@xmath19 , and can@xmath19 models to be more closely aligned with the xrt loops than any of the others .",
    "an overlay of field lines from the wh@xmath19 model is shown in figure  [ fig1]b .",
    "this judgement is based on good alignment with the tightly curved x - ray loops north of the sunspot ( which is visible in the coaligned magnetogram of this region shown in fig .",
    "[ fig1]d ) , together with a reasonably good match of the loop arcade and fan structures to the south and west of the sunspot .",
    "this judgement is also based on side - by - side comparisons of field line overlays amongst the various candidate models ( including the potential field model ) , from which a relative ranking was determined .",
    "the models listed above came out on top in both instances .    with the aim of determining more quantitatively the best - fit model(s ) for ar  10953",
    ", we also compared the model field lines to three - dimensional trajectories of loop paths .",
    "we are able to do this because ar  10953 was observed by the twin solar terrestrial relations observatory ( stereo ) spacecraft , one of which leads the earth in its orbit around the sun , and the other of which trails the earth . as part of the sun earth connection coronal and heliospheric investigation ( secchi ) instrument suite @xcite , each stereo spacecraft contains an extreme ultraviolet imager ( euvi ) .",
    "the angular separation of the two stereo spacecraft at the time ar  10953 was on disk ( of about 7@xmath17 ) was favorable for stereoscopically determining the three - dimensional trajectories of loops observed in the 171 , 195 , and 284  channels of euvi .",
    "the coordinates of these loop trajectories were obtained by triangulating the positions of common features visible in pairs of concurrent euvi images using the method described in @xcite .    unfortunately , most of the loops visible in the three euvi wavebands lie outside of the central region of ar  10953 ( fig .  [ fig1]c ) , and thus do not overlap the region for which the vector magnetogram data are available ( figs .",
    "[ fig1]d , e ) .",
    "the main reason is that loops located closer to the centers of the active regions tend to emit more in x - ray passbands than in euv passbands .",
    "in addition , large loops at the periphery of active regions are generally easier to reconstruct with stereoscopy , while small loops in the centers of active regions are more difficult to discern from underlying bright features ( such as moss ) and thus can not unambiguously be triangulated .",
    "however , the outlying loops evident in ar  10953 should still sense the presence of currents in the center of the active region , due to ampre s law , and thus might be useful for quantitatively determining the best - matching nlfff model for this active region .",
    "we infer that currents must be present in the ar  10953 corona for two reasons .",
    "first , most of the strong vertical currents in the @xmath21 map are located in the central portion of the active region and presumably flow upward into the corona .",
    "second , field lines from the potential model do not qualitatively match the x - ray and euv loops as well as field lines from the wh@xmath19 , am1@xmath19 , am2@xmath19 , and can@xmath19 models , which are our most nonpotential models and evidently contain currents strong enough to affect the trajectories of many field lines in the central portion of this active region ( cf .",
    "[ fig3 ] ) .    to quantitatively compare the stereo loops and the nlfff - model field lines",
    ", we determine the ( positive ) angle @xmath22 between the stereo - loop and the model - field line trajectories subtended at all stereo - loop points lying inside the full 320@xmath13320@xmath13256-pixel nlfff computational domain .",
    "we then computed the mean of these angles , yielding for each model the domain - averaged misalignment angle metric @xmath23 listed in table  [ table1 ] .",
    "we find that , at least by this particular quantitative measure , none of the nlfff models improve upon the value of @xmath24 found for the potential field model , although several models ( including the qualitatively better - fitting models discussed earlier ) are comparable .",
    "we discuss reasons why none of the models improved upon the potential field metric for @xmath23 in  [ sec : fovissues ] .",
    "given the boundary conditions produced using the data preparation process described in ",
    "[ sec : construction ] , the various nlfff algorithms converged to different solutions for the coronal field above ar  10953 .",
    "a few of the models appear to match the loop structures in the hinode / xrt image , but none of them were able to improve upon the potential field in their alignment with the three - dimensional loop trajectories inferred from stereo / secchi - euvi . in attempting to find a consensus model",
    ", we also applied the nlfff algorithms to different boundary data generated using variants of the data preparation process .",
    "these variations , described in  [ sec : dataprep ] , were run in parallel to those analyzed in  [ sec : validation ] , and also did not produce a viable model .",
    "this inability to generate models that both qualitatively and quantitatively match the coronal loops paths is disappointing , especially given the generally successful application of these algorithms to test cases with known solutions @xcite , including a solar - like test case with quasi - realistic forcing in the lower layers that was meant to approximate some of the forces acting in the solar chromosphere @xcite .",
    "while we realistically expect the various methods to yield somewhat different solutions , we can not fully ascribe the broad range of inconsistencies in the solutions solely to algorithmic differences .",
    "this causes us to examine the entire nlfff modeling process from beginning to end , and in so doing we have identified several additional factors that likely also impact our ability to produce robust models .",
    "these factors are discussed further in  [ sec : fovissues ] and  [ sec : chromosphere ] .",
    "we applied the nlfff algorithms to boundary data produced using eleven variations of the data preparation process , of which only one was outlined in  [",
    "sec : construction ] .",
    "variations involved substituting a different procedure to remove the 180@xmath17 ambiguity of the measured transverse vector field , and/or using different versions of the standard preprocessing algorithm . in total , about 60 different nlfff models for ar  10953 were calculated .",
    "( not all algorithms were run on all of the available boundary data sets . )",
    "the first variant entailed using a different algorithm to remove the 180@xmath17 ambiguity inherent in the vector - magnetogram inversion process .",
    "although there are in fact several algorithms to do this , we chose as an alternative to azam to employ the automated university of hawaii iterative method ( uhim ) @xcite because it has been used extensively in the literature and also scored highly amongst other ambiguity resolution algorithms @xcite .",
    "we found that , while differences exist in , for example , field line trajectories near regions where the ambiguity was resolved differently , the volume - integrated metrics discussed in  [ sec : validation ] and shown in table  [ table1 ] were largely similar for both the azam- and uhim - disambiguated boundary data .    the second variant involved a new version of the method used to preprocess the values of @xmath9 to make the boundary data more consistent with a force - free solution .",
    "our standard scheme pivots and smooths the components of @xmath9 so that the integrated magnetic forces and torques in the overlying volume are reduced as much as possible , while also retaining some fidelity to the measured vector field . for ar  10953",
    ", we also experimented with a preprocessing scheme ( described in @xcite ) that , in addition to the above , seeks to align the horizontal components of @xmath9 with fibrils seen in contemporaneous images of h@xmath6 .",
    "the motivation for this additional preprocessing constraint is to produce boundary data as close as possible to the force - free field expected to exist at the chromospheric level ( to which the h@xmath6 fibrils are assumed parallel ) .",
    "we found , however , that using h@xmath6-fibril information ( observed by the narrowband filter imager of hinode / sot ) did not make a significant difference in the domain - averaged metrics used to characterize the various extrapolation models , although we intend to experiment further with this preprocessing scheme as it is somewhat new .",
    "the third variant was to use the method of preprocessing described in @xcite , the goals of which are the same as the @xcite , but which uses a simulated annealing numerical scheme to find the optimal @xmath9 field . as with the other variations , using this alternate preprocessing scheme did not much affect the resulting global metrics @xcite .",
    "the hinode / sot - sp vector magnetogram data span only the central portion of the ar  10953 , and thus do not cover all of the weaker field and plage that surround the active - region center . here , as in the @xcite case , we chose to extend the nlfff computational domain and embed the vector data in a larger line - of - sight magnetogram .",
    "one benefit of such embedding is that it places the side and top bounding surfaces farther away from the center of the active region , in locations where the coronal magnetic field is presumed more potential and thus more consistent with the boundary conditions applied there .",
    "another reason is that in earlier test cases using boundary data with known solutions ( described in @xcite ) , we found that enlarging the nlfff computational domain improved the solution field in the central region of interest .",
    "we attributed this behavior primarily to the sensitivity of the final solution to the specified boundary conditions , and concluded that moving the side and top boundaries farther away from the region of interest improved the resulting models .",
    "however , there is an important difference between these earlier tests and the current case of ar  10953 . in the @xcite study ,",
    "vector data for the entire ( enlarged ) lower boundary were available , and thus the locations of currents penetrating the entire lower bounding surface , over both polarities , were known .",
    "in contrast , for ar  10953 we have no information about currents located exterior to the region containing the hinode vector magnetogram data , and consequently ( as stated earlier ) the horizontal components of @xmath9 were set to zero in the region outside of the area containing hinode / sot - sp vector data .",
    "this is obviously not correct , but lacking any knowledge of actual horizontal fields there , this approach was presumed to be the least damaging .",
    "however , the lack of satisfactory results suggests that the decision to embed may not be as harmless as originally believed .    the ability of the various nlfff algorithms to find a valid solution ultimately depends upon how they deal with the currents passing through the bounding surfaces of the computational domain .",
    "it is interesting to note that for ar  10953 , as for the @xcite case , the solutions bearing the best resemblance to the hinode / xrt loops , and here were among the best at matching the stereo - loop trajectories , were calculated using the current - field iteration method .",
    "this method differs from the others in that it uses values of @xmath21 and @xmath6 only in one of the polarities ( the well - observed leading polarity , in the case of the best - fit models ) from the lower boundary , while ignoring such measurements in the opposite polarity .",
    "in contrast , the optimization and magnetofrictional methods require that information about currents be available across both polarities .",
    "we suspect that the wheatland current - field iteration algorithm benefits from the additional space in the solution domain because fewer current - carrying field lines intersect the side boundaries ( which causes their values of @xmath6 to be set to zero ) .",
    "however , the wiegelmann optimization algorithm , and the valori magnetofrictional algorithm in particular , perform better when applied to smaller volumes or when the weighting given to the peripheral boundary information is less than that applied to the hinode vector magnetogram data .",
    "many of these problems caused by the embedding process are alleviated when vector magnetogram data are provided over a field of view that covers the locations of all relevant currents associated with the region of interest .",
    "for active - region studies , this often means capturing much of the trailing polarity , which is often more diffuse and extended than the leading polarity .",
    "we therefore conclude that vector magnetogram data of active regions for use by nlfff modeling efforts need to span much of the area above which currents flow .",
    "coverage of the more diffuse , trailing - polarity fields is likely to be especially important because of the tendency for the trailing - polarity field to contain the endpoints of many field lines that carry significant currents ( due to the existence of such currents in the leading polarity , coupled with the assumption that many field lines connect the leading and trailing polarities within the active region of interest ) .    on a related topic",
    ", we suspect that the stereo - loop comparison process described in ",
    "[ sec : validation ] is affected both by the proximity of the stereo loops to the sidewalls of the nlfff computational domain ( where potential - field boundary conditions were applied ) and by their lying outside of the region for which we have vector magnetogram data ( figs .",
    "[ fig1]d , e ) .",
    "consequently , one might not be surprised that the potential model bested the others in matching the stereo loops , but the sizable misalignment angle @xmath23 of 24@xmath17 for the potential model seems to suggest that even these outlying stereo loops do carry some currents .    in light of these issues ,",
    "rather than using the stereo - loop comparison as a discriminator between the collection of nlfff models , we instead view the collectively poor misalignment angles by the nlfff models as another indication that the region over which vector magnetogram data are available needs to be enlarged .",
    "although it is possible to enlarge the nlfff computational domain ( beyond what we have already done ) in order to include even more loops observed by stereo , we again emphasize that the added benefit of doing so without additional vector magnetogram data would be minimal because of the lack of further information about currents flowing through the lower boundary . indeed",
    ", we applied the same current - field iteration method used for wh@xmath19 to larger ( 512@xmath13512-pixel ) boundary data produced using the same process described in ",
    "[ sec : construction ] , and found that the value of @xmath23 for the identical volume used to compute the values of @xmath23 in table  [ table1 ] remained unchanged .",
    "lastly , we recognize that , when compared with stronger - field regions , the transverse field components @xmath16 are not measurable with the same degree of certainty in weaker - field regions such as those likely to lie within the enlarged fields of view for which we are advocating .",
    "the findings presented here , however , suggest that the nlfff modeling algorithms would benefit by having these vector magnetic field data available , even if such data possess higher measurement uncertainties than the stronger fields found closer to the centers of most active regions .      in  [ sec :",
    "construction ] , we described several conditions that the boundary data @xmath8 must satisfy in order to be consistent with a force - free magnetic field .",
    "however , these conditions are never guaranteed to be satisfied on the full bounding surface @xmath7 , which here consists of the vector and line - of - sight magnetogram data for the lower boundary combined with the potential field boundary conditions used for the remainder of the enclosing surface . to partially rectify this problem",
    ", we apply preprocessing to these data to thereby adjust the various components of @xmath9 on @xmath7 such that the boundary data are made more compatible with the equations the nlfff algorithms seek to solve .",
    "even after preprocessing , however , the boundary data can be shown to be incompatible with a force - free field . the wh@xmath19 model , which is one of several models judged to match best on a qualitative basis , only uses the @xmath6 values located in the negative polarity of the active region .",
    "however , the algorithm converged to a solution for which the corresponding @xmath6 values in the positive polarity do not match those indicated by the hinode / sot - sp data .",
    "figure  [ fig2]a illustrates this problem .",
    "there , the @xmath6 values in the wh@xmath19 model from field lines that intersect the lower boundary in the positive polarity are plotted versus the @xmath6 values at the same boundary points deduced from the preprocessed hinode data . for consistent boundary data",
    ", these would be equal .",
    "the scatter evident in the figure indicates that the hinode boundary data , even after preprocessing , are inconsistent with a force - free field .",
    "figure  [ fig2]b illustrates this effect in a different way .",
    "this incompatibility can be illustrated by computing    @xmath25    where @xmath26 is the heaviside step function , and @xmath27 and @xmath28 are , respectively , the flux density and value of @xmath29 at each point on the preprocessed hinode boundary map .",
    "the function @xmath30 signifies the net flux in that subarea of the boundary map for which @xmath31 is larger than a certain threshold @xmath6 . when the @xmath6-correspondence relation holds , the function @xmath30 thus possesses a derivative of zero because such correspondence requires , for any interval @xmath32 , an equal amount of positive and negative flux passing through that subarea of the boundary map having values of @xmath31 between @xmath6 and @xmath33 .",
    "however , figure  [ fig2]b shows that @xmath34 is nonzero over most @xmath6 values for the preprocessed data used here , especially within the range @xmath35 which corresponds to the @xmath6 values possessed by about 80% of the area of the boundary map .",
    "for comparison , the figure includes the function @xmath34 for the unpreprocessed dataset .",
    "the various methods deal with the lack of @xmath6  correspondence in the boundary data in different ways .",
    "current - field iteration methods allow the @xmath6-correspondence condition to be met by ignoring the values of @xmath6 in one polarity .",
    "however , only limited uniqueness results have been found for this approach , and even existence results are limited to the case of an unbounded domain ( see @xcite ) .",
    "it is well known that the current - field iteration method fails to converge in some cases , and this may be due to the absence of a solution , or the absence of a unique solution . in wheatland s implementation of this method , if the solution does not converge , values of @xmath6 are censored ( set to zero ) in the polarity defining the currents going into the corona .",
    "the censorship is imposed at boundary points with @xmath36 less than a threshold value , and that value is increased as required .",
    "additional censorship is also imposed such that field lines intersecting the side and top boundaries carry no current . in practice",
    "it is found that such reduction of the currents flowing into the domain can lead to convergence . the wh@xmath19 model , for example",
    ", censored almost half of the values of @xmath6 in the negative polarity ( corresponding to 43% of the negative - polarity flux ) before convergence was achieved , as illustrated in figure  [ fig4 ] .",
    "valori s magnetofrictional method is prevented from relaxing past an equilibrium state in which the continual injection of inconsistencies into the model ( at the boundaries ) is balanced by their removal via diffusion .",
    "wiegelmann s optimization method does not reach as well - relaxed of a force - free state as some of the other models , even though it disregards some of the boundary mismatches via the tapered nature of the weighting functions towards the edges of the model volume .",
    "there are several reasons why the boundary conditions used for this study ( and other active region studies ) might not satisfy the force - free consistency relations .",
    "the most conspicuous reason is that the photospheric layers of the sun , from which originate the hinode / sot - sp magnetogram data used here , do contain lorentz , buoyancy , and pressure gradient forces and thus are not force - free to begin with @xcite .",
    "additionally , measurement uncertainties in the components of @xmath9 preclude accurate determinations of @xmath21 ( and thus @xmath6 ) on the lower boundary because of the need to take derivatives of the horizontal components of @xmath9 .",
    "another reason is that measurements of the current normal to the enclosing surface are unavailable over much of @xmath7 due to the lack of vector magnetogram data above the photosphere .",
    "another is that the modeling implicitly assumes that the boundary data span a planar surface , and do not take into account effects present in vector magnetograms such as the wilson depression in sunspots and the broad range of line - formation heights across the line .",
    "yet another is that the inversion techniques that produce the vector magnetogram measurements do not fully take into account the multiple components of thin , narrow strands of interleaved magnetic fields that characterize sunspot penumbrae @xcite .",
    "we thus conclude that the nlfff modeling process needs to account for these intrinsic uncertainties in the boundary data , which include everything from measurement uncertainties to the lack of knowledge about how to infer the magnetic field in the force - free region at the base of the corona from the observed photospheric field maps .",
    "we have attempted to model the coronal magnetic field overlying ar  10953 by applying a suite of nlfff algorithms to the photospheric vector field measured using hinode / sot - sp .",
    "these data were remapped , embedded , and preprocessed in various ways in order to produce boundary data for this active region that were also consistent with the force - free assumption . from these boundary data ,",
    "about 60 different nlfff models were constructed .",
    "the resulting variations in these models prompted us to validate the results against images of coronal loops evident in euv or x - ray images .",
    "the goodness of fit was first determined in a qualitative manner by overlaying nlfff - model field lines on hinode / xrt imagery .",
    "this comparison indicated that some models contain field lines that are aligned with the observed loop structures .",
    "however , conclusive determinations of best - matching models , based solely on such overlays , remained difficult because of the indistinct nature of many coronal loops , especially those located near the center of ar  10953 where many of the currents are presumed to lie .",
    "we then turned to stereoscopic determinations of three - dimensional loop paths as a way to quantitatively assess the goodness of fit .",
    "this comparison was also inconclusive , because the loops traced stereoscopically in the stereo / secchi - euvi observations were restricted to the outermost domain of the active region .",
    "this meant that those loops that did fall in the nlfff computational domain lay close to the edge of the computational volume , where model field lines either leave the domain or run close to the side boundaries .",
    "we suspect this quantitative comparison was at least partially compromised by these effects , due to the model fields being sensitive to the way in which the side boundary information is incorporated and to their being located above the portion of the lower boundary for which hinode / sot - sp vector magnetogram data were not available .",
    "as exemplified by the qualitative and quantitative comparisons presented here , we find that it remains difficult to construct and validate coronal magnetic field models of solar active regions that can reliably be used for detailed analyses of a quantitative nature .",
    "our experience with modeling test cases with known solutions had shown that the various algorithms do work when given consistent boundary conditions .",
    "this led us to examine thoroughly the entire nlfff modeling framework in order to identify problematic issues that impact our ability to build useful models of the solar coronal field .",
    "the results of this examination leave us with several possibilities .",
    "first , it may be that useful nlfff extrapolations based on currently available signal - to - noise levels , preprocessing procedures , fields of view , and observable fields are intrinsically infeasible .",
    "a second ( and more hopeful ) possibility is that nlfff extrapolations need both much larger fields of view to better constrain the long field lines high over a region or to distant neighboring regions , and enough spatial resolution to resolve the spatial distribution of on the boundaries .",
    "third , nlfff algorithms need to accommodate the fact that the boundary conditions contain ( sometimes significant ) uncertainties , either from the measurement process ( e.g. , signal - to - noise issues or inadequate resolution of the 180@xmath17 ambiguity ) , or from physical origins ( e.g. , variations in the line - formation height , or most prominently the non - force - free nature of photospheric vector magnetograms ) .",
    "the second possibility can be tested empirically .",
    "one way to do this with current codes and instrumentation is to obtain vector magnetic observations of a substantially smaller active region and its wide surroundings .",
    "this will place the side boundaries relatively farther away from the region of interest , while remaining compatible with the range and resolution of , e.g. , the hinode / sot - sp and with the cartesian nature of the available modeling codes .    to address the third possibility , we have several avenues available .",
    "simple ways to account for boundary data uncertainties include introducing a position - dependent weighting function used in relaxation methods , or modifying the selection criteria for the @xmath6 field in the current - field iterative method .",
    "additionally , the preprocessing of the raw vector data needs to better approximate the physics of the photosphere - to - chromosphere interface in order to transform the observed photospheric field to a realistic approximation of the overlying near - force - free field at the base of the corona .",
    "one way to do that without resorting to more computationally intensive mhd models is to use the magnetohydrostatic concept ( e.g. , @xcite ) and approximate the stratifications for the flux tubes and their surroundings ( or the strongly and weakly magnetic regions ) separately .",
    "finally , in light of our findings in this study and in consideration of the aforementioned goal of constructing models that provide useful estimates of physical quantities of interest , we thus recommend that a particular force - free extrapolation should not be considered a consistent model of an active - region corona unless the following indicators ( at a minimum ) are satisfied : ( 1 ) good alignment of modeled field lines to the coronal loops observed on the solar disk ; ( 2 ) acceptable agreement of the @xmath6-correspondence relation by having similar values of @xmath6 at both ends of all closed field lines , and acceptable agreement with the boundary values of @xmath6 from the data ; while ( 3 ) still realizing low values of the nlfff metrics @xmath37 and @xmath38 .",
    "we gratefully acknowledge prof .",
    "sami solanki and the max - planck - institut fr sonnensystemforschung in katlenburg - lindau , germany , for their hospitality during our most recent workshop , at which the ideas presented in this article were discussed and refined .",
    "hinode is a japanese mission developed and launched by isas / jaxa ( japan ) , with naoj as domestic partner and nasa ( usa ) and stfc ( uk ) as international partners . it is operated by these agencies in cooperation with esa and nsc ( norway ) .",
    "the stereo / secchi data used here are produced by an international consortium of the naval research laboratory ( usa ) , lockheed martin solar and astrophysics laboratory ( usa ) , nasa / goddard space flight center ( usa ) , rutherford appleton laboratory ( uk ) , university of birmingham ( uk ) , max - planck - institut fr sonnensystemforschung ( germany ) , centre spatiale de lige ( belgium ) , institut doptique thorique et applique ( france ) , and institut dastrophysique spatiale ( france ) . m.l.d .",
    ", g.b . , and k.d.l .",
    "were supported by lockheed martin independent research funds .",
    "j.m.m . was supported by nasa grants",
    "nng05144 g and nnx08a156 g . s.r . acknowledges the financial support of the uk stfc . j.k.t . acknowledges support from dfg grant wi  3211/1 - 1 .",
    "g.v . was supported by dfg grant ho  1424/9 - 1 .",
    "t.w . acknowledges support from dlr grant 50  oc  0501 .",
    "is an ircset government of ireland scholar .",
    "t.t . acknowledges support from the international max planck research school on physical processes in the solar system and beyond .                          ,",
    "l. , deluca , e. , austin , g. , bookbinder , j. , caldwell , d. , cheimets , p. , cirtain , j. , cosmo , m. , reid , p. , sette , a. , weber , m. , sakao , t. , kano , r. , shibasaki , k. , hara , h. , tsuneta , s. , kumagai , k. , tamura , t. , shimojo , m. , mccracken , j. , carpenter , j. , haight , h. , siler , r. , wright , e. , tucker , j. , rutledge , h. , barbera , m. , peres , g. , & varisco , s. 2007 , , 243 , 63      , r.  a. , moses , j.  d. , vourlidas , a. , newmark , j.  s. , socker , d.  g. , plunkett , s.  p. , korendyke , c.  m. , cook , j.  w. , hurley , a. , davila , j.  m. , thompson , w.  t. , st cyr , o.  c. , mentzell , e. , mehalick , k. , lemen , j.  r. , wuelser , j.  p. , duncan , d.  w. , tarbell , t.  d. , wolfson , c.  j. , moore , a. , harrison , r.  a. , waltham , n.  r. , lang , j. , davis , c.  j. , eyles , c.  j. , mapson - menard , h. , simnett , g.  m. , halain , j.  p. , defise , j.  m. , mazy , e. , rochus , p. , mercier , r. , ravet , m.  f. , delmotte , f. , auchere , f. , delaboudiniere , j.  p. , bothmer , v. , deutsch , w. , wang , d. , rich , n. , cooper , s. , stephens , v. , maahs , g. , baugh , r. , mcmullin , d. , & carter , t. 2008 , , 136 , 67            , t.  r. , leka , k.  d. , barnes , g. , lites , b.  w. , georgoulis , m.  k. , pevtsov , a.  a. , balasubramaniam , k.  s. , gary , g.  a. , jing , j. , li , j. , liu , y. , wang , h.  n. , abramenko , v. , yurchyshyn , v. , & moon , y .-",
    "2006 , , 237 , 267      , t.  j. , tsuneta , s. , lites , b.  w. , kubo , m. , yokoyama , t. , berger , t.  e. , ichimoto , k. , katsukawa , y. , nagata , s. , shibata , k. , shimizu , t. , shine , r.  a. , suematsu , y. , tarbell , t.  d. , & title , a.  m. 2008 , , 673 , l215            scherrer , p.  h. , bogart , r.  s. , bush , r.  i. , hoeksema , j.  t. , kosovichev , a.  g. , schou , j. , rosenberg , w. , springer , l. , tarbell , t.  d. , title , a. , wolfson , c.  j. , zayer , i. , & the mdi engineering  team .",
    "1995 , , 162 , 129    , c.  j. , derosa , m.  l. , metcalf , t. , barnes , g. , lites , b. , tarbell , t. , mctiernan , j. , valori , g. , wiegelmann , t. , wheatland , m.  s. , amari , t. , aulanier , g. , dmoulin , p. , fuhrmann , m. , kusano , k. , rgnier , s. , & thalmann , j.  k. 2008 , , 675 , 1637            , s. , ichimoto , k. , katsukawa , y. , nagata , s. , otsubo , m. , shimizu , t. , suematsu , y. , nakagiri , m. , noguchi , m. , tarbell , t. , title , a. , shine , r. , rosenberg , w. , hoffmann , c. , jurcevich , b. , kushner , g. , levay , m. , lites , b. , elmore , d. , matsushita , t. , kawaguchi , n. , saito , h. , mikami , i. , hill , l.  d. , & owens , j.  k. 2008 , , 249 , 167"
  ],
  "abstract_text": [
    "<S> nonlinear force - free field ( nlfff ) models are thought to be viable tools for investigating the structure , dynamics and evolution of the coronae of solar active regions . in a series of nlfff modeling studies </S>",
    "<S> , we have found that nlfff models are successful in application to analytic test cases , and relatively successful when applied to numerically constructed sun - like test cases , but they are less successful in application to real solar data . </S>",
    "<S> different nlfff models have been found to have markedly different field line configurations and to provide widely varying estimates of the magnetic free energy in the coronal volume , when applied to solar data . </S>",
    "<S> nlfff models require consistent , force - free vector magnetic boundary data . </S>",
    "<S> however , vector magnetogram observations sampling the photosphere , which is dynamic and contains significant lorentz and buoyancy forces , do not satisfy this requirement , thus creating several major problems for force - free coronal modeling efforts . in this article </S>",
    "<S> , we discuss nlfff modeling of noaa active region 10953 using hinode / sot - sp , hinode / xrt , stereo / secchi - euvi , and soho / mdi observations , and in the process illustrate the three such issues we judge to be critical to the success of nlfff modeling : ( 1 ) vector magnetic field data covering larger areas are needed so that more electric currents associated with the full active regions of interest are measured , ( 2 ) the modeling algorithms need a way to accommodate the various uncertainties in the boundary data , and ( 3 ) a more realistic physical model is needed to approximate the photosphere - to - corona interface in order to better transform the forced photospheric magnetograms into adequate approximations of nearly force - free fields at the base of the corona . </S>",
    "<S> we make recommendations for future modeling efforts to overcome these as yet unsolved problems . </S>"
  ]
}