{
  "article_text": [
    "one of the tasks of time - distance helioseismology @xcite is to map the flow field in the solar convection zone at the highest spatial and temporal resolutions possible . using a cross - correlation technique",
    ", it is possible to estimate the time taken by waves to travel from one point on the solar surface to another .",
    "these travel times contain information about local flows ( e.g. * ? ? ?",
    "* ; * ? ? ?",
    "particularly interesting are flows associated with supergranulation , active regions and sunspots , and connected with the evolving magnetic cycle of the sun .",
    "the devil is in the details of how the flow information is encoded in and extracted from the travel - time measurements .",
    "we study the forward problem in the case of solar surface - gravity waves , also called f modes , which propagate horizontally . for frequencies near 3",
    "mhz the f - mode kinetic energy peaks about 1  mm below the solar surface .",
    "the interaction of f modes with flows has been studied by @xcite , @xcite , @xcite , @xcite , @xcite , and @xcite .",
    "small - scale turbulent convection ( granulation ) excites and damps solar oscillations ( e.g. , * ? ? ?",
    "@xcite and @xcite used the born approximation ( e.g. * ? ? ? * ) to compute the effects of the advection of waves by small - amplitude steady flows on time - distance and ring - diagram measurements .",
    "here we are interested in studying in more detail the sensitivity of f - mode travel times , as measured by time - distance helioseismology , to horizontal steady flows .",
    "we wish to answer the following questions , none of which have been studied before .",
    "how do travel - time shifts depend on travel distance ?",
    "in particular , what is the role of wave damping ?",
    "do travel - time shifts depend linearly on the flow amplitude for typical solar flows ?",
    "if so , when does the linearity break down ? which physical effects contribute to the travel - time perturbations ? is advection of the waves by the flow the only important effect ?",
    "or is the doppler shift of wave sources ( granulation ) by larger - scale flows also relevant ?",
    "is it important to model damping in a frame moving with the flow ? in the limit of weak flows , we can obtain kernel functions that give the linear sensitivity of travel - time perturbations to spatially - varying horizontal flows .",
    "how do sensitivity kernels change with the bandwidth and the central frequency of the f - mode wave packets ?",
    "waves at the solar surface are typically observed in line - of - sight velocity using doppler measurements .",
    "what effect does the projection of the wave velocity onto the line of sight have on the kernels ?",
    "can we find an accurate approximation to the kernels to speed up demanding calculations ?",
    "is it possible to recover the ray approximation of @xcite from the high - frequency limit of the cross - path integral of the sensitivity kernels ( see * ? ? ?",
    "* ) ?    in order to answer these questions , we choose to work with a simplified model of surface - gravity waves .",
    "following @xcite , we consider waves at the free surface of a constant - density half space under constant gravity .",
    "we choose initial conditions such that the wave field remains irrotational .",
    "these assumptions are useful as they simplify the presentation ; they are also sensible as will be shown at the end of the paper through a comparison with a solar - like three - dimensional kernel calculation with otherwise simplified physics .",
    "the layout of the rest of the paper is as follows . in   [ sec : surfacewaves ] we introduce our simple surface - gravity wave model . in   [",
    "sec : uniform ] we study the effect of a uniform flow on wave travel times , finding an exact solution and one using perturbation theory . in ",
    "[ sec : generalflow ] we use the first - order born approximation to obtain the wave field in the case of a small - amplitude spatially - varying flow , and then derive the sensitivity kernels . ",
    "[ sec:3d ] is a comparison with a three - dimensional kernel calculation .",
    "the implications of our findings are discussed in ",
    "[ sec : discussion ] .",
    "following @xcite , we consider a constant - density , incompressible half space @xmath1 , bounded by a free surface at @xmath2 . throughout the paper",
    "we denote the position vector by @xmath3 , whose horizontal component is @xmath4 and @xmath5 is height .",
    "gravitational acceleration , @xmath6 , is constant with @xmath7  ms@xmath8 .",
    "we use a plane - parallel geometry as an approximation to a local patch on the sun : this is valid for wavelengths much less than the solar radius .",
    "we denote by @xmath9 the unit vector pointing toward the observer , which depends on the position on the solar disk but is assumed to be independent of position over the small solar region of interest . the line - of - sight vector @xmath10 decomposes into a horizontal component @xmath11 and a vertical component @xmath12 .",
    "the velocity field has two components : the propagating part , @xmath13 , and the underlying steady horizontal flow , @xmath14 . as mentioned in the introduction and in order to obtain a simple problem , we choose both @xmath15 and @xmath16 to be irrotational at all times .",
    "we introduce the wave velocity potential , @xmath17 , such that @xmath18 the main advantage of this setting is that the problem of surface - gravity wave propagation through flows reduces to a two - dimensional one .",
    "as is appropriate for solar waves , we consider small - amplitude ( linear ) waves .",
    "the linearized hydrodynamic equations we wish to solve are as follows . in the bulk @xmath1 ,",
    "the momentum and continuity equations are @xmath19 , \\\\   { \\mbox{\\boldmath$\\nabla$ } }",
    "^2 \\theta & = & 0 , \\end{aligned}\\ ] ] where @xmath20 is the pressure perturbation , @xmath21 is the density , and @xmath22 is a phenomenological frequency - dependent damping operator ( see * ? ? ? * ) .",
    "the above equations and the ones that follow apply to quantities that were fourier - transformed in time , with @xmath23 the angular frequency ( we use the fourier conventions of * ? ? ? * ) . at the free surface surface @xmath24 , the linearized dynamical and kinematic boundary conditions ( e.g. , * ? ? ?",
    "* ) are @xmath25 where @xmath26 is the elevation of the fluid s surface , and @xmath27 is a stochastic pressure source on the surface that generates the waves @xcite .    in many cases , observations of solar oscillations",
    "are doppler velocity observations ( e.g. * ? ? ?",
    "let us introduce the line - of - sight component of the wave velocity at the surface and at time @xmath28 , @xmath29 , given by @xmath30 the actual measurements involve convolution of @xmath31 with the point - spread function of the telescope .",
    "in addition , the f - mode data analysis includes filtering the observations to select the f - mode ridge in fourier space @xcite .",
    "we denote the resulting data cube by @xmath32 .",
    "the combined effects of the point - spread function and the data filtering can be described by the convolution of a function @xmath33 with @xmath29 : @xmath34 in fourier space , the filtered data @xmath35 , where @xmath36 is the horizontal wave vector , is given by a multiplication of the filter @xmath37 by @xmath38 , @xmath39 as in @xcite , a mode - mass correction is also included in @xmath40 to simulate the response of a solar - like stratified atmosphere .",
    "note that we use the same symbol for a function and its fourier transform : the arguments are used to distinguish the two .",
    "we are first interested in the filtered oscillation signal @xmath41 that would be observed in the absence of any flows ( zero - order terms are denoted with a superscript 0 ) . eliminating the pressure and surface elevation terms , the surface boundary conditions at @xmath2 reduce to @xmath42 where @xmath43 is the complex wavenumber at resonance .",
    "the zero - order damping operator is such that @xmath44 = \\gamma \\theta^0 $ ] with the damping frequency @xmath45 , and @xmath46  mhz is the central frequency @xcite .",
    "the solution of equation  ( [ source ] ) can be found by introducing a green s function .",
    "the final result for @xmath41 ( on the surface ) is then @xmath47,\\ ] ] where @xmath48 is the horizontal gradient .",
    "the zero - order surface velocity potential is given by @xmath49 with @xmath50 where @xmath51 is the horizontal wavenumber .",
    "in summary , equations  ( [ source])-([green ] ) give the observed zero - order filtered wave field at the surface for f modes propagating through the background model with no flows present .",
    "here we study the effect of a horizontal , spatially - uniform steady flow , @xmath52 from equations  ( [ mom - eq])-([surf - eq ] ) we see that the effect of the flow is to transform @xmath23 into @xmath53 .",
    "the doppler shift @xmath54 is the result of a simple galilean transformation @xmath55 .",
    "this transformation applies to all quantities in the problem except the filter @xmath40 , which is applied independently of the flow .",
    "the filtered data cube can thus be expressed in terms of the doppler velocity in the absence of a flow , @xmath56 , according to @xmath57    the fundamental computation in time - distance helioseismology is the cross - covariance of the oscillation signal , measured for two different points @xmath58 and @xmath59 on the solar surface , @xmath60 where the star denotes complex conjugation and @xmath61 is the observation duration . because of horizontal translation invariance ( uniform flow ) , the expectation value of the cross - covariance is the inverse fourier transform of the power spectrum ( e.g. * ? ? ?",
    "* ) : @xmath62 where @xmath63 and @xmath64\\ ] ] is the expectation value of the power spectrum of oscillations .",
    "the computation of @xmath65 requires the knowledge of the source covariance function @xmath66 ; here we choose the same function as in @xcite .",
    "a general configuration of the observation points and notation used throughout the paper is depicted in figure  [ fig : geometry ] .",
    "we now consider two strategies for the computation of the cross - covariance @xmath67 in the case of a uniform flow .",
    "the first is to compute equations  ( [ cross - cov ] ) and ( [ pow ] ) numerically , to obtain what we call the exact solution .",
    "the second is to compute successive approximations to @xmath67 using a taylor expansion in @xmath15 of the power spectrum @xmath65 . for a constant flow",
    ", we have @xmath68 \\\\ \\nonumber & + & \\frac{1}{2 } ( { \\mbox{\\boldmath$k$ } } \\cdot { \\mbox{\\boldmath$u$ } } ) ^2|f|^2\\partial_{\\omega}^2\\left[|\\phi^0|^2\\right ] \\\\ & - & \\frac{1}{6 } ( { \\mbox{\\boldmath$k$ } } \\cdot { \\mbox{\\boldmath$u$ } } ) ^3|f|^2\\partial_{\\omega}^3\\left[|\\phi^0|^2\\right ] + \\dots , \\end{aligned}\\ ] ] where @xmath69 $ ] is the expected power spectrum when @xmath70 .",
    "we may truncate this expansion after each successive term to study the zero- , first- , second- , and third - order cross - covariance ( terms in @xmath71 , @xmath72 , @xmath73 and @xmath74 respectively ) .",
    "figure  [ fig : cross_corr ] shows the cross - covariance function at each level of approximation of the taylor expansion for a uniform flow .",
    "convergence to the exact covariance is observed as higher - order terms are retained .",
    "notice that the phase shift is largely accomplished by the first - order term , while the amplitude correction is largely accomplished by the second - order term .    in this paper",
    ", we are mainly interested in studying travel - time differences , which are obtained by finding the time @xmath75 it takes for waves travelling from @xmath58 to @xmath59 , and subtracting the time @xmath76 for those waves going from @xmath59 to @xmath58 . in other words , @xmath77 this quantity gives information about the underlying flows .",
    "following @xcite , the travel - time difference can be measured from the cross - covariance function according to @xmath78 where @xmath79 is the covariance function in the absence of a flow and @xmath80 is the change in the cross - covariance due to the flow .",
    "the operator i m takes the imaginary part of the expression .    using the zero- , first- , and third - order cross - covariances , as well as the exact cross - covariance",
    ", we now study travel - time differences using equation  ( [ tau - w ] )",
    ". this will provide us with a means to test the first - order born approximation which is developed in   [ sec : born ] , as well as to quantify higher - order terms .",
    "note that the second - order term does not affect travel - time differences because it only introduces perturbations to the cross - covariance that are symmetric in the time lag .",
    "we first study the travel - time differences for various separation distances @xmath81 and flow speeds @xmath82 .",
    "figure  [ fig : tt_v_d ] shows the exact and approximate scaled travel - time differences @xmath83 versus @xmath81 computed at fixed @xmath84 for @xmath85  ms@xmath0 and @xmath86  ms@xmath0 ( @xmath87 ) .",
    "we find that the first - order approximation is within 10% of the exact value for @xmath85  ms@xmath0 and @xmath88  mm , while the error is only about 1% when terms up to @xmath74 are kept .",
    "for a flow that is twice as large , @xmath86  ms@xmath0 , non - linear effects are more important .",
    "the functional dependence at large @xmath81 is partly due to mode damping , as will be shown later in ",
    "[ sec : ray ] .",
    "next we compare this result with observed travel times .",
    "we used 4  hours of quiet sun mdi dopplergrams tracked at a constant rate of @xmath89  ms@xmath0 with respect to the local surface rotation rate in order to mimic the effect of a constant flow .",
    "travel times are then measured using equation  ( [ tau - w ] ) .",
    "figure  [ fig : tt_data_exact ] shows the result .",
    "we find a good agreement between the exact model and the observations .",
    "the agreement is not , however , perfect at short distances ; this is likely to be due to a mismatch between the model and the solar f - mode power spectra .",
    "figure  [ fig : tt_v_u ] shows the variations of @xmath90 as a function of @xmath82 for fixed distances @xmath91  mm and @xmath92  mm .",
    "the first - order approximation is within 10  % of the exact solution for flows with amplitudes less than about 400  ms@xmath0 , although for larger @xmath81 the agreement becomes worse .",
    "however , these results demonstrate that the first - order approximation ( and most likely the kernels given in   [ sec : generalflow ] ) is appropriate for the study of supergranular flows .",
    "let us turn to the question of whether advection of the waves by the flow is the only important effect . to first order in @xmath82 ,",
    "the change in the cross - covariance in the case @xmath93 has three distinct components : @xmath94 .\\end{aligned}\\ ] ] the three terms in brackets in this equation correspond to the effect of the flow on the waves , on the sources , and on the damping .",
    "we can thus determine the relative contribution that each of these physical effects separately has on the first - order travel - time differences .",
    "this is shown in figure  [ fig : tt_3terms ] .",
    "the advection of the waves contributes by far the most to the travel - time difference , making up about 98% of the total value .",
    "we conclude that , for practical applications , we can ignore the effects of the flow on the damping and source functions .",
    "now we relax the assumption of a constant flow and consider a spatially - varying , steady , horizontal , small - amplitude flow @xmath95 .",
    "the general study of the interaction of surface waves with flows involves a number of complications , and we do not attempt to solve the problem in its full generality ; instead we require the flow vorticity be zero . due to the small amplitude of the flow",
    ", the problem may be solved in the first born approximation , which we carry out in   [ sec : born ] and will lead to the sensitivity kernels of   [ sec : ptp ] .      here",
    "we solve the linearized set of hydrodynamic equations introduced in ",
    "[ sec : surfacewaves ] by applying the first born approximation .",
    "we expand each wave quantity @xmath96 into a zero - order term , @xmath97 , and a perturbation term due to the flow , @xmath98 .",
    "we then insert the expanded wave quantities into equations ( [ mom - eq])-([surf - eq ] ) and retain only terms which are of first order . in the bulk , the perturbed velocity potential @xmath99 satisfies the three - dimensional laplace s equation , @xmath100 eliminating the pressure and the surface elevation , the surface boundary conditions at @xmath2 reduce to @xmath101 \\equiv \\delta s . \\label{eq.eqds}\\ ] ] in doing so , we have used the approximations @xmath102 and @xmath103 , which describe the perturbations to the wave sources and the wave damping respectively .",
    "we note that @xmath104 satisfies the same equations as @xmath105 , except for a different source function @xmath106 on the right - hand side of the surface boundary condition , equation  ( [ eq.eqds ] ) .",
    "this is the first born approximation , an equivalent - source description of wave scattering .",
    "using the same green s function as in   [ sec : uniform ] , the first - order surface velocity potential is @xmath107 from which we deduce the perturbation to the filtered data , @xmath108.\\ ] ]      the first - order perturbation to the cross - covariance is obtained by approximating @xmath109 in equation  ( [ tau - w ] ) according to @xmath110 , \\end{aligned}\\ ] ] where @xmath111 is the first - order perturbation to @xmath112 . using the expressions we have found for @xmath41 and @xmath111 , equation  ( [ deltac ] )",
    "can be put into the form @xmath113 where the function @xmath114 , explicitly written in appendix  [ app : curlyc ] , gives the linear sensitivity of the cross - covariance to a spatially - varying flow .",
    "inserting equation  ( [ curlyc ] ) into equation  ( [ tau - w ] ) gives @xmath115 where the function @xmath116 is the two - dimensional sensitivity kernel , defined by @xmath117    figure  [ fig : kerns10 ] shows example kernels for the linear sensitivity of the travel - time difference to small - amplitude flows , for a separation of 10  mm between the observation points and for a vertical line of sight @xmath93 .",
    "a short discussion of the numerical computation of kernels is given in appendix  [ sec : computation ] .",
    "the kernel in figure  [ fig : kerns10]a , @xmath118 , gives the sensitivity of the travel times to @xmath119 and the kernel in figure  [ fig : kerns10]b , @xmath120 , gives the sensitivity to @xmath121 . for reasons of symmetry (",
    "the @xmath120 kernel is antisymmetric with respect to the lines @xmath122 and @xmath123 ) the total integral of @xmath120 is zero .",
    "we observe elliptical and hyperbolic features in the kernels , similar to what was seen in the kernels for the damping rate and the source strength perturbations derived by @xcite .",
    "the elliptical features have been called fresnel zones in geophysics ( e.g. , * ? ? ?",
    "the first fresnel zone bounds the large area between the observation points in figure  [ fig : kerns10 ] where the kernel is negative . that @xmath124 is negative in this region is intuitive : local flows in the @xmath125 direction should speed up waves traveling in this direction while slowing down waves going the opposite way , resulting in negative travel - time differences .",
    "the hyperbolae and ellipses , due to scattering of waves generated by distant excitation events , are discussed futher in ",
    "[ sec : farfield ] .",
    "it is important and instructive to check the born kernels for consistency with the first - order approximation of @xmath126 calculated under the assumption of a constant flow in ",
    "[ sec : uniform ] .",
    "it also enables us to verify the numerical computation of the kernels .",
    "if we again consider a uniform flow , @xmath127 , then from equation  ( [ tau - k ] ) it is possible to spatially integrate the kernels to obtain @xmath128 we have computed kernels for several values of @xmath81 and obtained the corresponding @xmath126 .",
    "the results are shown as large dots in figure  [ fig : tt_v_d ] .",
    "the total integral of @xmath118 is within @xmath129% of the value expected from the first - order approximation , giving us confidence in the numerics .",
    "the kernels in figure  [ fig : kerns10 ] were computed with the line - of - sight vector @xmath93 , i.e. , at solar disk center .",
    "we would like to obtain kernels at any general point on the solar disk .",
    "the variation in the line - of - sight vector across the solar disk is incorporated in our model and appears explicitly in the expression for the kernels ( see appendix  [ app : curlyc ] ) .",
    "foreshortening in the center - to - limb direction ( the point - spread function effectively depends on the direction of @xmath36 ) is another important systematic effect , which has been ignored for the sake of simplicity .",
    "a region on the sun around the solar longitude measured from disk center , @xmath130 , and latitude , @xmath131 , has a local line - of - sight vector approximately given by @xmath132 two examples of kernels computed away from disk center are given in figure  [ fig : kerns10_los ] for coordinates @xmath133 and @xmath134 ( on the equator towards the western limb ) .",
    "the kernel in figure  [ fig : kerns10_los]a is @xmath118 , whereas the kernel in figure  [ fig : kerns10_los]b is @xmath120 , whose observation points lie on the same meridian ( @xmath135 ) .",
    "if the line - of - sight effect did not matter , then the two kernels in figure  [ fig : kerns10_los ] and the kernel of figure  [ fig : kerns10]a would all be identical after rotation of figure  [ fig : kerns10_los]b .",
    "this is not the case , however .    in particular , although these three kernels have the same total integral ( see below ) , the kernel of figure  [ fig : kerns10_los]b looks very different .",
    "this is because , in the case of figure  [ fig : kerns10_los]b , waves that scatter along the line that connects the two observation points have a small component along the line of sight and have thus a small contribution to the cross - covariance function . in general , the flow sensitivity is reduced when the scattered wave at the observation points is travelling perpendicular to the center - to - limb direction . for example , there is about @xmath136  % less sensitivity along the ray path connecting the two observation points for the kernel of figure  [ fig : kerns10_los]b compared to the kernel of figure  [ fig : kerns10]a at disk center .",
    "we have computed the total integral of the kernel as a function of position on the solar disk .",
    "we studied two cases with @xmath134 and varying @xmath130 in the range from @xmath137 to @xmath138 : one in which the observation points lie on the equator and the other in which the observation points lie on the same meridian .",
    "the resulting travel - time differences show very little , if any , variation across the disk .",
    "this means that large scale flows are practically insensitive to line - of - sight effects .",
    "however , judging by the fine structure of the kernels , the line - of - sight effect is important for small - scale flows .      in the uniform flow model it was possible to separate the effects of advection of the waves , of the wave sources , and of the wave damping to determine the contribution of each to the travel - time difference ( see eq .  [ [ deltac_constant ] ] and fig .  [",
    "fig : tt_3terms ] ) .",
    "we concluded that for uniform flows the wave advection is by far the dominant contribution to the travel time shifts .",
    "is this also true for a spatially - varying flow ? using equation  ( [ fullcurlyc ] ) , it is possible to identify the contribution to the kernel due to source advection . at @xmath92  mm",
    "we find that the source advection contribution is about three orders of magnitude less than the contribution from the advection of waves by the flow .",
    "this result is useful for future kernel calculations .",
    "neglecting source advection is an excellent approximation .",
    "this approximation has been used in the past by , e.g. , @xcite , @xcite , and @xcite , although not explicitly justified .",
    "( _ b _ ) , ( _ d _ ) , and ( _ f _ ) computed using the additional filter @xmath139 defined in equation  ( [ gfilt ] ) .",
    "the filter used for the top row has a central wavenumber @xmath140 , for the middle row @xmath141 , and for the bottom row @xmath142 . in each plot",
    "@xmath143 , and @xmath144  mm . for each kernel , @xmath92  mm , and",
    "the units are smm@xmath8 ( km / s)@xmath0 .",
    "the dispersion relation for f modes , @xmath145 , is given by the dashed lines in the power spectra .",
    "the gray scale of the power spectra is linear and truncated for emphasis . ]",
    "@xcite showed how phase - speed filtering affects the properties of p - mode sensitivity kernels for sound speed perturbations .",
    "here we study how f - mode kernels change as the spatial frequency content of the input f - mode power spectrum is varied . to isolate particular f modes",
    ", we apply a multiplicative filter @xmath139 to the wavefield , in addition to the filter @xmath40 that contains the instrumental mtf and a mode - mass correction (   [ sec : uniform ] ) .",
    "this additional multiplicative filter is a simple gaussian function , @xmath146},\\ ] ] with central wavenumber @xmath147 and standard deviation @xmath148 .",
    "note that f modes with different wavenumbers probe different depths ( e.g. * ? ? ?",
    "figure  [ fig : filt_pow_kern_2 ] shows examples of sensitivity kernels , using the filter @xmath139 for @xmath149 , @xmath150 , and @xmath151 and @xmath143 ( @xmath144  mm is the radius of the sun ) . plotted alongside each kernel",
    "is the corresponding filtered power spectrum .",
    "the particular part of the f - mode ridge that is isolated by the additional filtering is evident from these power spectra . as the bandwidth",
    "is reduced by filtering , the kernels show more fine structures and are more spread out in space ( see figure  [ fig : kerns10 ] for a comparison with a kernel computed with the full f - mode power ) . as @xmath147 is varied from smaller to larger values , more and more fine structure becomes apparent in the kernels .",
    "we conclude that the sensitivity kernels must be tuned to account for the correct power spectrum before any high spatial resolution inversion is attempted , especially at scales comparable to the wavelength .       computed from equation  ( [ farfieldkernel ] ) and discussed in   [ sec : farfield ] .",
    "note that this kernel is not defined at the two observation points , given by the crosses .",
    "the spatial integral of this kernel is within @xmath152  % of the spatial integral of the exact kernel ( see fig .  [",
    "fig : kerns10]_a _ ) .",
    "the units are smm@xmath8 ( km / s)@xmath0 .",
    "it is computed in just several seconds . ]    .",
    "the heavy solid line is the cut through the kernel of figure  [ fig : kerns10]_a _ , and the thin line is a cut through the far - field approximate kernel from figure  [ fig : kern_farfield ] . ]",
    "we now consider an approximation to the sensitivity kernels given by equation  ( [ k ] ) .",
    "this is carried out in the far field , i.e. , for points @xmath153 away from the observation points @xmath58 and @xmath59 .",
    "the solution will enable us to speed up the numerical computation of the kernels , as well as to expose some of the main features of the kernels that have already been discussed .",
    "the approximation allows for the analytical solution of the integrals given in equations  ( [ int1])-([int4 ] ) .",
    "the details are presented in appendix  [ app : far - field ] , where the final expression for the approximate kernel is equation  ( [ farfieldkernel ] ) .",
    "figure  [ fig : kern_farfield ] is an example sensitivity kernel computed in the far - field approximation .",
    "it resembles quite well the ` exact ' kernels of   [ sec : ptp ] ( see fig .",
    "[ fig : kerns10]a ) .",
    "the agreement between the exact and far - field kernel is everywhere within 10  % except within a @xmath154  mm radius about the two observation points .",
    "in fact , the far - field kernel is not defined at the observation points .",
    "figure  [ fig : cut_kern_farfield ] shows one - dimensional cuts along the @xmath122 line of both the exact and approximate @xmath118 .",
    "the far - field approximation kernel , equation  ( [ farfieldkernel ] ) , clearly brings out two important features .",
    "the first is the origin of the ellipses and hyperbolae mentioned in ",
    "[ sec : ptp ] . both the ellipses ( @xmath155 ) and hyperbolae ( @xmath156 ) are clearly present in the numerator of expression  ( [ farfieldkernel ] ) .",
    "the second is the presence of damping through the @xmath157 terms ( @xmath158 ) .",
    "the damping causes the kernel to decay by a factor @xmath159 $ ] as one moves away from the ray path , where @xmath160 is the damping rate .",
    "ray theory is a high - frequency approximation . according to @xcite , in the ray approximation the sensitivity of travel times to flows",
    "is confined to the ray path which joins the two observation points . in the case of f modes ,",
    "the ray path is a straight line between the two observation points .",
    "for simplicity we study a configuration where the two observation points lie on the @xmath161 axis , @xmath162 and @xmath163 . the one - way travel - time perturbation becomes @xmath164 where @xmath165 is the local change in @xmath161 component of the wavevector and @xmath166  mhz is the frequency for which the @xmath167-averaged power spectrum is maximum .",
    "for the case of f modes and a flow @xmath168 , the travel - time difference @xmath90 can be approximated as @xmath169    we would like to check whether the two - dimensional kernels derived in this paper reduce to the ray kernels when we compute the cross - path integral , i.e. , when flows vary slowly in the @xmath170 coordinate . in order to facilitate an analytic expression for the travel times , we begin from the far - field approximation of @xmath118 , equation  ( [ farfieldkernel ] ) . following @xcite , the integral of @xmath118 over @xmath170 can be estimated by the method of stationary phase ( sp ) .",
    "we obtain the following @xmath171 with the definition @xmath172 where @xmath173 is an average of the power spectrum over wavenumbers , and is explicitly defined in appendix  [ app : far - field ] .",
    "the functions @xmath174 and @xmath175 are the real and imaginary parts of the complex wavenumber at resonance . for @xmath176  mm , we find that @xmath177  mhz is a weak function of @xmath81 . at shorter distances",
    "however , @xmath178 varies fast with @xmath81 . only in the case when the power distribution @xmath173 peaks around @xmath179 , at large distances @xmath81 , and",
    "in the absence of damping , do we have @xmath180 and thus recover the ray approximation given by equation  ( [ ray ] ) . in practice , damping can not be ignored , and the naive ray kernel should be corrected by replacing @xmath179 by @xmath178 .    figure  [ fig : tt_rayapprox ] shows the travel - time differences for a uniform flow from equation  ( [ sp ] ) for two cases : one with damping present and one with damping set to zero .",
    "the difference between the two cases is quite large .",
    "damping reduces the overall sensitivity to the flow ( _ thick solid line _ ) .",
    "the nonlinearity of the travel times with distance is a direct effect of the damping , and we see that turning off the damping restores linearity ( _ dot - dashed line _ ) . for comparison",
    "we also plot the exact travel - time differences for a uniform flow of @xmath181  ms@xmath0 , studied in   [ sec : uniform ] .",
    "remarkably , for @xmath182  mm , the exact solution and the solution from equation  ( [ sp ] ) are in good agreement , even though there have been two approximations made to arrive at equation  ( [ sp ] ) .",
    "the near - field wiggle at @xmath183  mm is captured by the improved ray approximation .     to @xmath59 .",
    "the exact solution ( _ dashed line _ ) is for a flow @xmath85  ms@xmath0 ( see   [ sec : uniform ] ) .",
    "the thin solid line corresponds to travel - time differences @xmath184 computed using equation  ( [ ray ] ) .",
    "the thick solid line is computed from equation  ( [ sp ] ) and denotes @xmath185 . finally , the dot - dashed line is the travel - time difference from equation  ( [ sp ] ) without any damping .",
    "the central angular frequency @xmath166  mhz . ]",
    "let us consider the mean travel times for point - to - point measurements defined as @xmath186,\\ ] ] where @xmath187 has been previously defined .",
    "it is sometimes assumed that mean travel times are not sensitive to flows .",
    "this is not strictly true , as we now discuss .",
    "following @xcite and   [ sec : ptp ] , we may derive linear sensitivity kernels for mean travel times which satisfy @xmath188 where @xmath189 { \\mbox{\\boldmath$\\cal c$ } } ( { { \\mbox{\\boldmath$x_1$}}},{{\\mbox{\\boldmath$x_2$}}},\\omega;{{\\mbox{\\boldmath$x$}}})\\ , { { \\rm d } } \\omega}{\\int_0^{\\infty}\\omega'^2 |c^0 ( { \\mbox{\\boldmath$\\delta$ } } , \\omega')|^2 \\ , { { \\rm d } } \\omega'}.\\ ] ] here , re takes the real part of the expression in the numerator and hilb[@xmath190 denotes the hilbert transform .    to show how spatially - varying flows are related to mean travel times @xmath191 , we compute the corresponding sensitivity kernels @xmath192 and plot them in figure  [ fig : kerns_mean ] .",
    "first , we point out that the spatial integrals of @xmath193 and @xmath194 are both zero , indicating that a constant flow has no first - order effect on mean travel times .",
    "there are , however , some structures of significant magnitude in these kernels on small length scales ( as large as for the travel - time difference kernel @xmath116 ) .",
    "thus , flows that vary on a scale comparable to the wavelength may leave their signature in the mean travel times .",
    "@xcite computed three - dimensional kernels for the effect of local flows on travel - time differences , taking into account solar stratification but neglecting the advection of sources and damping . as we have shown here , the effects of source and damping advection are , for practical purposes , negligible compared to the direct advection of the waves by the flow .",
    "hence , it is meaningful to compare the two calculations .",
    "the 3d kernels , denoted here as @xmath195 , give the linear sensitivity of travel - time differences to general three - dimensional steady flows , @xmath196 , and satisfy @xmath197 in order to compare the three - dimensional f - mode kernels , @xmath198 , with the two - dimensional kernels computed in the previous sections , we define the depth - integrated kernel @xmath199 where the integral is over all @xmath5 .",
    "the kernels @xmath200 give the sensitivity of travel - time differences to flows which are independent of depth .",
    "figure  [ fig:3dkern_2dkern ] compares an example depth - integrated kernel , @xmath200 , with the corresponding two - dimensional kernel from this paper .",
    "the total integrals of the two kernels agree to within a few percent .",
    "notice , however , that the details of the fine structure are somewhat different .",
    "these differences are likely the result of the somewhat different assumptions regarding the source covariance , the damping model , and the instrumental point - spread function .",
    "the two bottom panels of figure  [ fig:3dkern_2dkern ] show one - dimensional cuts through the two kernels .",
    "the sizes of the first fresnel zones are equal ; this shows that the dominant wavelengths in the two calculations are similar .",
    "the kernel @xmath200 shows somewhat less ringing than the kernel computed in this paper , which could be due to a slightly different frequency content .",
    "the differences in the fine structure of these two kernels demonstrate the importance of accurately modeling the true bandwidth of solar f modes ( see   [ sec : filtering ] ) .",
    "we have shown how to compute f - mode travel - time shifts due to uniform flows .",
    "the result depends on travel distance in a complicated way for several reasons : near - field effects at short travel distances and damping at large distances .",
    "in addition , we find that the linearization of the travel times with the flow amplitude is valid to within 10% for flows with amplitudes less than about @xmath201  ms@xmath0 and travel distances less than about 25  mm . for larger flows or larger distances ,",
    "non - linear effects become important , as the travel times do not scale like the flow .",
    "this non linearity may complicate the interpretation of time - distance measurements because large - amplitude flows are observed on the sun , including , e.g. , rotation ( hence the need to at least remove the main effect of rotation before applying time - distance helioseismology ) .",
    "we computed the two - dimensional sensitivity of f - mode travel times to spatially - varying steady flows , using the first born approximation ( small flow regime ) .",
    "we found that the main physical mechanism responsible for travel - time shifts is , by far , the advection of the waves by the flow .",
    "the effects of the advection of wave sources ( granulation ) and wave damping by the flow are completely negligible .",
    "this will substantially simplify future computations of kernels , and justifies the omission of these terms in previous calculations .",
    "the kernels are also highly sensitive to the frequency content ( central frequency , bandwidth ) of the input f - mode power . correctly tuning the model power spectrum to the observed one is therefore crucial for the use of these kernels in any inversion .",
    "the point - to - point kernels computed here could easily be averaged to obtain point - to - quadrant or point - to - annulus kernels , a standard averaging technique used in time - distance helioseismology .",
    "we showed that , at small spatial scales , the sensitivity kernels for doppler velocity measurements depend very significantly on position on the solar disk and on the angle between the observation points and the center - to - limb direction .",
    "this seriously complicates the interpretation of travel - time measurements as the inversion problem is not a deconvolution .",
    "we note that close to the limb , kernels are nothing like ray theory would suggest .",
    "we caution that we have not considered the effects of foreshortening in this paper ( see * ? ? ?",
    "* for a preliminary discussion ) .",
    "the two - dimensional f - mode kernels are fast to compute ( especially in the far field ) and compare well with depth - integrated three - dimensional kernels .",
    "they may prove quite useful to infer near - surface horizontal flows .",
    "we would like to derive an expression for the function @xmath114 in equation  ( [ curlyc ] ) : @xmath202 first , we use the zero - order and scattered wave fields in equations  ( [ psi0 ] ) and  ( [ dpsi ] ) and plug them into the first - order approximation to the cross - correlation , given by @xmath203,\\ ] ] where the flow @xmath15 is contained in the @xmath111 terms . after some manipulation",
    "one can show upon comparison of equation  ( [ app : deltac - curlyc ] ) and  ( [ app : deltac ] ) that    @xmath204\\\\ & + & { { \\rm i } } ( \\partial_\\omega m_s ) \\left[k^ * ( { \\mbox{\\boldmath$\\delta$ } } _ 2,\\omega ) { \\mbox{\\boldmath$\\nabla$ } } _ { { { \\mbox{\\boldmath$x$}}}}k ( { \\mbox{\\boldmath$\\delta$ } } _ 1,\\omega)-k ( { \\mbox{\\boldmath$\\delta$ } } _ 1,\\omega ) { \\mbox{\\boldmath$\\nabla$ } } _ { { { \\mbox{\\boldmath$x$}}}}k^ * ( { \\mbox{\\boldmath$\\delta$ } } _ 2,\\omega)\\right],\\\\\\nonumber\\end{aligned}\\ ] ]    where we use the notation @xmath205 , @xmath206 , and @xmath63 ( see fig .",
    "[ fig : geometry ] for the geometry schematic ) .",
    "the function @xmath207 is equivalent to the source function in equation  ( [ source ] ) for spatially uncorrelated sources , and is related to the @xmath208 in equation  ( 51 ) of @xcite , where @xmath209 . in the above equation , we defined the following functions : @xmath210 where @xmath211 the second line in equation  ( [ fullcurlyc ] ) is the doppler shift , or advection , of the source function due to the flow .",
    "this term is small compared to the wave advection term in the first line , as discussed in   [",
    "sec : adv ] .",
    "we note that a complicated term has been left out of equation  ( [ fullcurlyc ] ) that contributes only at the observation points @xmath212 and @xmath213 .",
    "we have calculated it , yet it is negligeable for practical applications and so we have ignored it .",
    "we briefly point out some aspects of the numerical computation of the kernels .",
    "the most important step which determines the length of the computation is setting up the initial @xmath214 grid on which the kernels will be calculated .",
    "the kernels of figure  [ fig : kerns10 ] , which lie on a horizontal spatial grid of resolution @xmath215  mm in both @xmath161 and @xmath170 directions ( @xmath216 points ) , are computed in @xmath217  minutes on a single processor machine , for a code written in ` c++ ` . however , this value of the resolution turns out to be unnecessary .",
    "one may use a much coarser grid , and then perform a two - dimensional fourier interpolation to recover the kernels onto a finer grid , if necessary .",
    "we have tested this and found that the coarsest grid we may use for these kernels is roughly of a resolution of @xmath218  mm .",
    "the fourier interpolation method is due to the nyquist - shannon sampling theorem .",
    "this theorem tells us that the minimum resolution necessary to recover the full signal is @xmath219 , where @xmath220 is the dominant wavelength in the problem , which , for f modes at power maximum , is about @xmath152  mm .",
    "implimentation of this speeds up the computation quite effectively .",
    "the spacing for the @xmath167 and @xmath23 grids used for the computation are approximately @xmath221  rad s@xmath0 and @xmath222  mm@xmath0 , over the ranges @xmath223 $ ]  mhz and @xmath224 $ ]  mm@xmath0 .",
    "we would like to find an analytic approximation to the expression for the sensitivity kernels , starting from equation  ( [ k ] ) : @xmath225 we consider for simplicity sensitivity kernels where @xmath93 , and we ignore the source advection term in @xmath114 ( line 2 of eq .  [ [ fullcurlyc ] ] ) , which we have already shown to be quite small .    using the definition of the power spectrum ( eq .",
    "[ [ pow ] ] ) , the zero - order cross - correlation ( eq .  [ [ cross - cov ] ] ) can be written as @xmath226 where @xmath66 is the source function described in appendix  [ app : curlyc ] , @xmath40 is the filter function , and @xmath227 is the complex wavenumber .",
    "similarly , @xmath114 of equation  ( [ fullcurlyc ] ) can be expressed as @xmath228 { { \\rm d } } ^2 { \\mbox{\\boldmath$k$ } } { { \\rm d } } ^2 { \\mbox{\\boldmath$k$ } } ' .\\end{aligned}\\ ] ] the integrals over wavenumber in equation  ( [ app : c0 ] ) and ( [ app : curlycfull ] ) can be performed analytically when the argument of the exponential functions is large , i.e. , in the far - field limit . for any smooth function @xmath229 and horizontal vector @xmath153 , we have , in the limit of large @xmath230 : @xmath231,\\end{aligned}\\ ] ] where @xmath232 and @xmath233 ( see   [ sec : surfacewaves ] ) .    using these integral approximations we can now evaluate the kernel in equation  ( [ k - w ] ) . for simplicity , let the filter function be real and independent of @xmath36 , and to simplify the notation let @xmath234 . integrating equation  ( [ app : c0 ] ) with the help of ( [ app : secondint ] ) yields @xmath235 where @xmath236 is approximately the power spectrum integrated over wavenumber .",
    "note that this term is real .",
    "similarly , from equation  ( [ app : curlycfull ] ) one can show that @xmath237=\\frac{2\\pi\\ , m_s\\kappa_{\\rm r}^5\\ ,    f^2 e^{-\\kappa _ { { \\rm i } } \\sigma}}{\\kappa _ { { \\rm i } } \\sqrt{\\delta_1\\delta_2}}\\left[\\cos(\\kappa_{\\rm r}\\sigma-\\pi/2)-\\cos(\\kappa_{\\rm r}\\lambda)\\right]\\,\\left(\\hat { { \\mbox{\\boldmath$\\delta$ } } } _ 1-\\hat { { \\mbox{\\boldmath$\\delta$ } } } _ 2\\right),\\ ] ] where @xmath238 and @xmath239 , @xmath240 denotes the unit vector in the direction of @xmath241 , and we have used @xmath242 since the imaginary part is small ( damping ) . finally , plugging equations  ( [ c0approx ] ) and  ( [ curlycapprox ] ) into equation  ( [ k - w ] ) gives the far - field approximation to the sensitivity kernel :      as noted in ",
    "[ sec : farfield ] , the kernel is not defined at the observation points ( @xmath244 ) . a plot showing this kernel",
    "is given in figure  [ fig : kern_farfield ] .",
    "expression  ( [ farfieldkernel ] ) reduces to the result of ray theory in the infinite frequency limit , as demonstrated in ",
    "[ sec : ray ] ."
  ],
  "abstract_text": [
    "<S> time - distance helioseismology has shown that f - mode travel times contain information about horizontal flows in the sun . </S>",
    "<S> the purpose of this study is to provide a simple interpretation of these travel times . </S>",
    "<S> we study the interaction of surface - gravity waves with horizontal flows in an incompressible , plane - parallel solar atmosphere . </S>",
    "<S> we show that for uniform flows less than roughly 250  ms@xmath0 , the travel - time shifts are linear in the flow amplitude . for stronger flows , </S>",
    "<S> perturbation theory up to third order is needed to model waveforms . </S>",
    "<S> the case of small - amplitude spatially - varying flows is treated using the first - order born approximation . </S>",
    "<S> we derive two - dimensional frchet kernels that give the sensitivity of travel - time shifts to local flows . </S>",
    "<S> we show that the effect of flows on travel times depends on wave damping and on the direction from which the observations are made . </S>",
    "<S> the main physical effect is the advection of the waves by the flow rather than the advection of wave sources or the effect of flows on wave damping . </S>",
    "<S> we compare the two - dimensional sensitivity kernels with simplified three - dimensional kernels that only account for wave advection and assume a vertical line of sight . </S>",
    "<S> we find that the three - dimensional f - mode kernels approximately separate in the horizontal and vertical coordinates , with the horizontal variations given by the simplified two - dimensional kernels . </S>",
    "<S> this consistency between quite different models gives us confidence in the usefulness of these kernels for interpreting quiet - sun observations . </S>"
  ]
}