{
  "article_text": [
    "in order to estimate the prevalence of diseases , traits or behaviors in particular social groups or even in the entire society , researchers typically rely on samples of the target population . a carefully selected sample may generate satisfactory low standard errors with a bonus of optimizing research resources and time .",
    "a common challenge is to obtain a significant and unbiased sample of the target population .",
    "this is particularly difficult if this population of interest is somehow segregated , stigmatized , or in some other way difficult to reach such that a sampling frame can not be well defined .",
    "these so - called hidden ( or hard - to - reach ) populations may be for example man - who - have - sex - with - man ( msm ) , sex - workers , injecting drug users , criminals , homeless , or minority groups  @xcite .    in 1997 , heckathorn introduced a new methodology to sample hidden populations named respondent - driven sampling ( rds )  @xcite .",
    "rds exploits the underlying social network structure in order to reach the target population through the participants own peers .",
    "the method consists in a variation of the snowball sampling where the statistical estimators have weights to compensate the non - random nature of the recruiting process , i.e.  that individuals with many potential recruiters have a higher chance to be sampled . in rds ,",
    "researchers select seeds to start the recruitment . a seed person then invites a number of other individuals to participate in the survey by passing a coupon to them .",
    "those successfully recruited respond a survey and get new coupons to invite a number of other individuals within their own social network , and the process is repeated until enough participants are recruited .",
    "successful recruitment and participation in the survey are both financially compensated .",
    "a fundamental assumption is that each participant knows the number of his or her own acquaintances in the target population , or in the network jargon , his or her own degree .",
    "this information is used as weights to estimate the prevalence of the variable of interest in the study population .",
    "the perhaps most popular rds statistical estimator is due to volz and heckathorn , who devised a markov process whose equilibrium distribution is the same as the distribution of the target population  @xcite .",
    "this estimator is derived after a series of assumptions regarding both the underlying network structure and the recruitment process _ per se_. although the assumptions are generally reasonable , sometimes they are relatively strict for realistic settings , as for example , the uniformly random selection of peers , persistent successful recruitment , and sampling with replacement  @xcite .",
    "these and other assumptions have been scrutinized in previous theoretical studies and the estimator has performed satisfactory in different scenarios using both synthetic  @xcite and real networks  @xcite . a number of real life studies have also concluded that rds is an effective sampling method for various categories of hidden populations ( see for example refs .",
    "@xcite ) .",
    "social networks are however highly heterogeneous in the sense that the structure of connections can not be represented by characteristic values .",
    "this is the case of the number of contacts per individual or of the level of clustering between them  @xcite .",
    "since the rds dynamics is constrained by the network structure , one may expect that different patterns of connectivity affect the recruitment chains .",
    "for example , the network structure may be such that a recruitment tree grows only in one part of the network  @xcite .",
    "in realistic settings using sampling without replacement , even if all individuals are willing to participate , trees may simply die out because a network has been locally exhausted and bridging nodes block further propagation of coupons to other parts of the network  @xcite .",
    "such situation is not unlikely in highly clustered sub - populations where coupons may simply move around the same group of people .",
    "previous theoretical studies have addressed some of these network constrains by studying the rds performance on either synthetic structures  @xcite or samples of real networks  @xcite .",
    "each approach to model social networks has its own advantages and limitations . on one hand , simple synthetic structures and sampling processes are unrealistic but allows some mathematical treatability and thus intuitive understanding . on the other hand",
    ", samples of real networks may suffer biases themselves due to their own sampling and thus potential incompleteness of data  @xcite .",
    "network clustering is particularly important in the context of social networks and should be carefully assessed .",
    "it may have different meanings but here we associate clustering to social triangles , i.e.  the fact that common contacts of a person are also in contact themselves .",
    "network communities are also a form of clustering in which groups of individuals are more connected between themselves than with individuals in other groups .",
    "as already mentioned , clustering in all its forms is not uniform across a network . in practice , it means that one may find hidden sub - populations within the study population .",
    "examples include social groups with particular features ( e.g.  wealth , foreigners , ethnic minorities ) embedded in the target population  @xcite , transsexuals in populations of msm , or geographically sparse populations  @xcite . while these sub - populations may potentially be removed by defining a more strict sampling frame , social groups ( or communities ) are inherent of social and other human contact networks  @xcite .",
    "note that network clustering is not the same as homophily , that is the tendency of similar individuals to associate , but one may enhance the other .",
    "for example , individuals may share social contacts because they live geographically close , share workplaces , or are structured in organizations ( potentially leading to network clustering ) but may be completely different in other aspects ( low homophily in wealth , health status , gender , infection status , and so on ) .    in this paper",
    ", we use computational algorithms to generate synthetic networks with various levels of clustering and with network communities of various sizes , aiming to reproduce structures observed in real social networks . using realistic parameters ,",
    "we simulate a rds process using these networks and quantify the performance of the rds estimator in different scenarios of the prevalence of an arbitrary variable of interest .",
    "the paper is organized such that we first analyze how triangles and community structure affect how the rds spread in the network when it comes to size of transmission trees and generation of recruitment .",
    "then we investigate how clustering affects the validity and reliability of the rdsii estimator as a function of different willingness to participate ( response - rates ) in the population .",
    "we also test the effect of clustering for scenarios where the variable under study is correlated with the degree of the nodes and the size of the network community .",
    "thereafter , we study the consequences of the biased selection of seeds , the bias induced by network structure in samples of real social networks , and the effect of restarting the seeds during the sampling experiment .",
    "we describe in this section the models used to generate the synthetic networks with different number of triangles and varying levels of community structure , the empirical networks , the model to simulate the rds dynamics , the protocols to artificially distribute the infections in the target population , and the estimator and other statistics used for the analysis .",
    "a social network is defined by a set of nodes representing the population and a set of links representing the social contacts , as for example acquaintances or friendship , between two individuals .",
    "the network structure can be characterized by different network quantities  @xcite .",
    "the most fundamental quantity is the degree @xmath0 that represents the number of links of a node or equivalently the number of contacts of an individual .",
    "the assortativity of a network measures the tendency of nodes with similar degree to be connected .",
    "the number of triangles and the clustering coefficient are used to measure the local clustering in the network .",
    "a triangle corresponds to the situation where two contacts of a node are also in contact themselves , and the clustering coefficient is a normalized count of the number of triangles .",
    "a network community , on the other hand , is a group of nodes that are more connected between themselves than with nodes of other groups .",
    "a fundamental property of the network community structure is that only a few nodes link ( or bridge ) different communities , these nodes are also known as bottlenecks because they constrain the diffusion , or the sampling process , in the network .",
    "if there are only a few bridging nodes , one says that the community structure is strong , whereas many bridging nodes weaken the community structure reducing the bottlenecks between groups .",
    "we use computational algorithms able to generate synthetic networks with tunable number of triangles ( fig .",
    "[ fig:01]b ) or of community structure ( fig .",
    "[ fig:01]c ) .",
    "these algorithms are not expected to reproduce a particular social network but to generate various structures observed in social networks more realistically than previously studied structures  @xcite .",
    "our reference random network is obtained by simply connecting pairs of nodes for a given degree sequence , a procedure that results on a negligible number of triangles and no network community structure ( fig .",
    "[ fig:01]a ) .",
    "this model is also know as the configuration model  @xcite .",
    "the first algorithm , due to serrano and bogua  @xcite , generates networks with a varying number of triangles and assortativity . in this algorithm , an _ a priori _ degree sequence is chosen following a given distribution @xmath1 of node degree @xmath0 .",
    "we choose a power - law degree distribution with a small exponential cutoff , i.e.  @xmath2 .",
    "if no or very small costs are associated with keeping links alive , scale - free distributions are reasonable models for empirical distribution , otherwise we usually observe broad scale distributions not necessarily power - law - like . generally speaking , this degree distribution is thus not expected to be the most appropriate distribution of contacts in real populations but it captures the right - skewed degree heterogeneity typically observed in social groups  @xcite .",
    "this heterogeneity means that the majority of nodes has only a few contacts whereas a small number of them has several contacts .",
    "we fix the minimum possible degree to @xmath3 in order to obtain an average degree @xmath4 .",
    "furthermore , an _ a priori _ clustering coefficient is chosen such that a given number of triangles is defined for each degree class @xmath0 .",
    "the algorithm evolves by randomly selecting three different nodes and forming a triangle between them , respecting the distribution of triangles per degree class .",
    "as soon as no new triangles can be formed , the remaining links are uniformly connected ( i.e.  the configuration model ) such that no links are left unconnected .",
    "self - links are forbidden .",
    "a parameter @xmath5 controls the assortativity ( assortativity increases with decreasing @xmath5 ) and the parameters @xmath6 and @xmath7 control the expected clustering coefficient ( clustering increases with increasing @xmath6 and decreases with increasing @xmath7 ) . in this paper , we use @xmath8 , @xmath9 and @xmath10 ( for the configuration with many triangles ) and @xmath8 , @xmath11 and @xmath10 ( for the configuration with few triangles ) .    the second algorithm , developed by lancichinetti and fortunato  @xcite , is used to create networks with community structure .",
    "here one starts by choosing the distribution of degrees and the distribution of community sizes . in both cases , we use power - law distributions to capture the heterogeneity in the degree and in the community size as observed in some real social networks  @xcite . other choices of probability distribution may be more suitable for specific populations but here again we want to study the heterogeneity in the community sizes",
    "the degree distribution has the same parameters as used in the first algorithm , the power - law distribution of community sizes has exponent @xmath12 and community sizes are limited between @xmath13 and @xmath14 nodes . these values are chosen to guarantee that a sufficient number of communities are large in size and at the same time , enough small - sized communities are represented .",
    "for example , higher values of the exponent would result in relatively more small - sized communities .",
    "these values are also constrained by the number of links and the level of overlapping of communities ( see below ) , and are chosen to generate a network with a single connected component .",
    "the number of overlapping nodes and the number of communities that each node belongs to are inputs of the algorithm .",
    "overlapping means that a number of nodes belong to more than one community ( these are the bridging nodes ) while the rest of the nodes only belong to single communities .",
    "one may further select a mixing parameter @xmath15 to add random links between the bridge nodes and randomly chosen communities ( to weaken the community structure ) .",
    "therefore , small overlapping and small mixing generate stronger community structures .",
    "we set @xmath16 , and select @xmath17 or @xmath14 overlapping nodes in @xmath18 communities respectively for strong and strong - moderate community structures . for moderate - weak and weak community structures , we set respectively @xmath19 , and @xmath17 and @xmath14 overlapping nodes ( in @xmath18 communities as well ) .    for each algorithm , to obtain the statistics , we generate @xmath13 versions of the network with the same set of parameters and with @xmath20 nodes each , which is also the size of the target or study population .",
    "we also study rds using real - life networks .",
    "we perform simulations on 5 samples of empirical contact networks representing different forms of human social relations .",
    "three data sets correspond to email communication , two between members of two distinct universities in europe ( ema1  @xcite , ema2  @xcite ) and one between employees of a company ( enr )  @xcite . in these datasets",
    ", nodes correspond to people and social ties are formed between those who have sent or received at least one email during a given time interval .",
    "one data set corresponds to friendship ties between us high - school students ( adh )  @xcite .",
    "the last data set corresponds to online communication between members of an online dating site ( pok )  @xcite .",
    "similarly to the email networks , if two members have exchanged a message through the online community , a link is made between the respective nodes .",
    "although some of these data sets do not correspond to social networks in which rds would take place , they serve as realistic settings capturing the network structure of actual social relations .",
    "we have selected data sets with diverse sample sizes and network structure in order to cover various contexts and configurations ( table  [ tab:01 ] ) .",
    ".*summary statistics of the empirical networks used in this study . *",
    "number of nodes ( @xmath21 ) ; number of links ( @xmath22 ) ; clustering coefficient @xmath23 ; number of communities @xmath24 ; size of the smallest community @xmath25 and size of the largest community @xmath26 , according to the mapequation algorithm  @xcite . [ cols=\"^,^,^,^,^,^\",options=\"header \" , ]      we simulate the sampling by using a stochastic process reproducing several features of a realistic rds dynamics .",
    "our model further adds a continuous - time framework and the response - rate can be controlled .",
    "we use similar parameters as typically used in the literature  @xcite .",
    "we start by uniformly selecting ( unless otherwise stated ) @xmath13 random nodes as seeds for the recruitment . after a time @xmath27 , sampled from an exponential distribution ,",
    "each seed chooses uniformly three of its contacts and pass one coupon to each of them .",
    "the exponential distribution is chosen because in our model we assume that the recruitment follows a poisson process .",
    "we select the average waiting time to be @xmath18 , meaning that a node waits on average @xmath18 time steps ( e.g.  5 days ) before inviting its contacts . therefore , after waiting @xmath27 time steps , and with probability @xmath28 , that represents the probability of participation ( or response - rate , i.e.  one minus the probability of not returning a coupon ) , each of these contacts recruits three of their own contacts that have not participated yet ( sampling without replacement ) .",
    "if a node accepts to invite its own contacts ( i.e.  accepts to participate ) , we add this node in the sample .",
    "the process continues until all possibilities of new recruitments are exhausted or , at maximum , when a specific sample size is reached . note that this continuous - time model is equivalent to a discrete - time model in which randomly chosen nodes update their status sequentially",
    "we assume that if a node refuses to participate once , it becomes available for recruitment by other nodes as if it was never invited .",
    "we repeat the simulation of the rds dynamics @xmath29 times for each synthetic network and @xmath30 times for each empirical network .          in rds studies ,",
    "one is interested in quantifying the prevalence of some variable @xmath31 in the target population .",
    "this variable may represent , for instance , being tested positive for a given disease , being male or female , the ethnicity , or having a particular physical trait .",
    "in this paper , to simplify the notation , we say that an individual and its respective node is infected with @xmath31 or not infected with @xmath31 .",
    "we use different protocols to infect a fraction of @xmath32 of the network nodes with the quantity @xmath31 .",
    "the remaining nodes are thus assumed to be non - infected .",
    "the reference case ( ri ) corresponds to uniformly selecting the nodes within the target population , i.e.  the infection @xmath31 is uniformly distributed in the network .",
    "the preferential case ( pi ) corresponds to selecting nodes in decreasing order of degree , i.e.  we start at nodes with the highest degree and infect them with @xmath31 until @xmath32 of the nodes become infected . to add some noise ( case pri ) , we select @xmath33 of the infected nodes , cure them , and redistribute these infections uniformly in the network such that the total number of infected nodes remains fixed .",
    "the other two cases consist on infecting nodes according to the community structure . in the first case ( si ) , we initially infect nodes in the smallest communities until @xmath32 of the nodes become infected . in the second case ( bi ) , we infect nodes in the largest communities until the same fraction of @xmath32 of nodes get infected .",
    "to reduce homophily , we add noise by selecting @xmath34 of the infected nodes , curing them , and redistributing these infections uniformly in the network while keeping the total number of infected nodes fixed ( these configurations are named sri for small and bri for large communities ) .      to analyze the recruitment trees , we measure the total number of participants @xmath35 ( i.e.  the sample - size ) , and the size @xmath36 and the number of generations ( or waves ) @xmath37 of each recruitment tree , starting from a seed node @xmath38 .",
    "the proportion of individuals in the population with a certain feature @xmath31 ( @xmath39 ) is estimated by using the rdsii estimator  @xcite :    @xmath40    where @xmath41 is the reported degree of an individual @xmath38 in the social network .",
    "we thus define :    @xmath42    as the average estimate of the prevalence of @xmath31 for @xmath43 simulations with the same set of parameters , with standard deviation given by @xmath44 .",
    "complementary , we define the average bias @xmath45 , i.e.  the difference between the estimate of the prevalence of @xmath31 and the true prevalence of @xmath31 , for @xmath43 simulations , as :    @xmath46    in the results , we show the relative bias in respect to the true value of the prevalence , i.e.  we show @xmath47 . the design effect  @xcite @xmath48 is defined as :    @xmath49    where @xmath50 is the variance of the estimator @xmath39 using rds , and @xmath51 is the variance of the same estimator @xmath39 using simple uniform sampling ( srs ) , i.e.  the same number of nodes ( as in the rds sample ) is uniformly selected in the study population .",
    "the design effect thus measures the number of the sample cases necessary to obtain the same statistics as if a simple random sample was used . in our study ,",
    "@xmath52 ( @xmath29 rds simulations for each of the @xmath13 generated network with fixed parameters , and @xmath30 rds simulations for each of the empirical networks ) .",
    "we first discuss the statistics of recruitment trees for synthetic networks with various levels of clustering and community structure .",
    "we then analyze the performance of the rdsii estimator for different network structures and for different scenarios of prevalence of the infection @xmath31 .",
    "this analysis is followed by results on the convergence of the estimator for increasing sample size on networks with strong community structure .",
    "afterwards , we study the rds performance considering the same scenarios of prevalence of the infection using real social networks and conclude the results section showing the increased bias as a consequence of running a single recruitment tree per time .",
    "we first look at some statistics of the recruitment trees in the case that the entire target population can potentially be recruited , i.e.  the recruitment only stops if no new subject is recruited or if the network is exhausted ( everyone is recruited ) . since",
    "the population is fixed to @xmath20 individuals , this limiting case provides us the maximum possible coverage of the sampling for a given configuration of the rds . in the reference case ( fig .",
    "[ fig:02]a - e ) , only the degree distribution is fixed and the nodes are uniformly connected ( configuration model , see section  [ methods_a ] ) . in this case , if every recruited individual responds to the survey , i.e.  @xmath53 ( see section  [ methods_b ] ) , nearly all the population is recruited .",
    "the recruitment dynamics however is not robust to variations in the response - rate , for example , in our simulations , for @xmath54 , only about @xmath55 of the population is recruited , and this percentage falls to negligible values if @xmath56  @xcite .",
    "successful recruitment in fact occurs only if @xmath57 in the absence of any ( or negligible ) triangles and community structure .",
    "we observe a broad distribution in the size of the recruitment trees ( fig .",
    "[ fig:02]b , c ) .",
    "there is a relatively high chance for the recruitment trees to break down quickly and thus to contain only a few individuals .",
    "this typically happens when a recruitment tree reaches a high - degree node .",
    "high - degree nodes are easily reachable because they have many connections .",
    "once the first recruitment tree passes through one of these high - degree nodes , they become unavailable . consequently",
    ", the recruitment trees arriving afterwards simply die out as soon as they reach these nodes . at the same time , a few recruitment chains persist long enough and generate large trees , potentially sampling large parts of the network from a single initial seed . as expected",
    ", there is a characteristic peak in the number of waves ( fig .",
    "[ fig:02]d , e ) .",
    "( eq .  [ eq:02 ] ) and the respective standard deviation @xmath44 , b , e , h , k ) the average bias @xmath58 ( eq .  [ eq:03 ] ) , and c , f , i , l ) the design effect @xmath48 ( eq .  [ eq:04 ] ) .",
    "the underlying networks have a few number of triangles and weak community structure ( see section  [ methods_a ] ) , and recruitment is limited respectively to @xmath30 ( 1st column ) and to @xmath20 ( 2nd column ) participants . in both cases , @xmath32 of the population",
    "is infected with @xmath31 preferentially towards high degree nodes following either protocol pi ( top 3 rows ) or protocol pir ( bottom 3 rows ) ( see section  [ methods_c ] ) . ]",
    "the increasing level of clustering has some effect in the statistics of the recruitment trees .",
    "in particular , in the absence of communities , a large number of triangles improve recruitment for intermediate values of response - rates ( fig .",
    "[ fig:02]f - j ) .",
    "triangles create redundant paths eliminating bottlenecks in the network , as for example , bottlenecks due to high degree nodes .",
    "high degree nodes make a large number of contacts and thus connect different parts of the network . as mentioned before , as soon as these nodes are recruited , the recruitment chain may not be able to expand beyond them .",
    "on the other hand , if the network has weak ( fig .",
    "[ fig:02]k ) or strong ( fig .",
    "[ fig:02]p , u ) community structure , the number of triangles becomes irrelevant , and the level of community structure defines the sample size . in case of strong community structure ( with low or large number of triangles ) , a maximum of @xmath59 of the population may be recruited ( fig .",
    "[ fig:02]p , u ) .",
    "bottlenecks in this case correspond to nodes bridging communities .",
    "these bottlenecks can not be removed by adding triangles , that only produce local network redundancy , but by connecting more nodes between different communities , i.e.  weaken the community structure . moreover , strong communities imply that response - rates should be higher ( in comparison to the absence of or to weaker communities ) for the recruitment chains to take off and gather sufficient participants . if response - rates are bellow @xmath60 , recruitment is insufficient .",
    "this is a fundamental issue in realistic settings , meaning that highly clustered ( or in other words , highly segregated and marginalized ) populations need a bit higher compensation in order to achieve the same sampling size as one would obtain if studying less segregated groups .",
    "we see that irrespective of the number of triangles or level of community structure , lower response - rates cause a relatively larger number of small recruitment trees together with a few waves ( fig .",
    "[ fig:02]b , d , g , i , l , n , q , s , v , x ) .",
    "this is not only undesirable because the final sample remains small but also because a few waves is not sufficient for the stochastic process to forget the initial conditions and thus reach the stationary state , the condition in which the estimator is expected to be unbiased . in case of strong community structure ( fig .",
    "[ fig:02]s , t , x , y ) , we note a broader variance in the number of waves suggesting that each seed samples the network non - homogeneously .",
    "this may be related to the fact that the communities have different sizes ( or number of nodes ) and thus the bottlenecks between communities are reached at different times by different recruitment chains .          to study the impact of the network structure and response - rates in the rds estimator , we measure four statistics : ( i ) the average rdsii estimator @xmath61 ( eq .  [ eq:02 ] ) and its respective ( ii ) standard deviation @xmath44 , ( iii ) the average bias @xmath58 ( see eq .  [ eq:03 ] ) , and ( iv ) the design effect @xmath48 ( eq",
    ".  [ eq:04 ] ) ( see section  [ methods_d ] ) .",
    "figures  [ fig:03]a - f , m - r show the reference case , i.e.  the configuration model where the only structure is in the degree sequence and the rest is random ( see section  [ methods_a ] ) . in this reference case , if there is no restriction to the sample size in respect to the size of the target population ( i.e.  up to 10000 individuals may be sampled , but actual sample size depends on the response - rate ) , the estimator @xmath61 performs well , although with substantial standard deviation @xmath44 and biases @xmath58 for @xmath56 even if the quantity @xmath31 is uniformly spread in the network ( fig .",
    "[ fig:03]a - c ) .",
    "this is a result of the insufficient sample size for low response - rates .",
    "individuals with a large number of contacts are believed to be more central in a network  @xcite .",
    "these individuals may be for example more likely to get an infection or propagate a piece of information .",
    "we thus test an hypothetical scenario where @xmath31 is concentrated in high - degree nodes ( see protocol pri in section  [ methods_c ] ) .",
    "note that this assumption may be however completely irrelevant in some contexts , but it is useful to understand the mechanisms of sampling . in this case",
    ", the accuracy of the estimator @xmath61 is poor for @xmath62 , i.e.  @xmath31 is under - estimated for both situations , with and without many triangles , and precision is worse for response - rates @xmath63 ( respectively fig .",
    "[ fig:03]j - l and fig .",
    "[ fig:03]d - f ) . as before ,",
    "the poor accuracy is a result of the rds not recruiting sufficient participants .",
    "the under - estimation of the prevalence however suggests that low - degree nodes are not being sufficiently sampled as the sample size gets close to the network size . a substantial bias , given by @xmath58 ,",
    "is also observed .",
    "the design effect varies between 1 and 2 , with some exceptions for @xmath64 in case of many triangles . if the number of participants is limited to only @xmath30 individuals , i.e.  @xmath65 of the total population ( a small fraction of the target population , as usually recommended to guarantee unbiased estimates  @xcite ) , the performance of the estimator @xmath61 and the average bias @xmath58 improves substantially .",
    "however , @xmath31 remains slightly underestimated and the standard deviation @xmath44 increases in the case of many triangles irrespective of the response - rates ( fig .",
    "[ fig:03]v - x ) .",
    "the cost of this improvement however is a much higher design effect ( fig .",
    "[ fig:03]x ) .",
    "figure  [ fig:04]a - f shows that in networks with weak community structure , if @xmath31 is concentrated at the high - degree nodes , the estimates remain good for @xmath66 if the maximum number of participants is low ( up to 500 ) compared to the total size of the target population . in the limiting case where all individuals can potentially participate ( up to 10000 ) ,",
    "@xmath31 is slightly overestimated and substantially underestimated respectively for small and large response - rates , being accurate only for moderate values , i.e.  @xmath67 ( fig .",
    "[ fig:04]g - l ) .",
    "the results suggest that for larger response - rates , there is a significant under - representation of low - degree nodes in the final sample .",
    "this happens because low - degree nodes become increasingly more difficult to sample as the sample size gets close to the network size ( causing finite - size effects ) .",
    "biases are also larger if the community structure is stronger because the recruitment chains die out before exploring some of the communities .",
    "altogether , these results are in accordance with previous recommendations that the sample size should be much smaller than the size of the target population  @xcite in order to achieve good estimates using the rdsii estimator .",
    "some caution however should be pointed out since it is not straightforward to know in advance the size of the target population and thus to estimate the optimal sample size in respect to the target population . if too many subjects are recruited , relatively to the size of the target population , saturation occurs and the network structure induces biases in the estimator due to finite - size effects .",
    "we now simulate scenarios where the variable @xmath31 is concentrated in specific communities , irrespective of the degree of the nodes .",
    "this is a reasonable assumption considering that an infection ( or other particular quantities ) may affect only the population of some geographical region , or for example , a particular group of injecting drug users among msm may be sharing contaminated paraphernalia . by using the know structure of each network , we select @xmath32 of the nodes associated to the smallest communities and infect them with the quantity @xmath31 ( see section  [ methods_c ] ) . in this",
    "setting , the prevalence is underestimate and the estimator has relatively large deviations ( fig .",
    "[ fig:05]a , g ) for strong and strong - moderate community structure .",
    "estimators improve for weaker community structure ( fig .",
    "[ fig:05]m , s ) . even for weak community structure ,",
    "the minimum average bias is about @xmath68 ( fig .",
    "[ fig:05]t ) , being at least @xmath69 in case of strong communities ( fig .",
    "[ fig:05]b ) for @xmath53 . for lower response - rates ,",
    "the bias gets substantially larger , as in the previous experiments .",
    "the design effect is also significantly affected for any level of community structure ( fig .",
    "[ fig:05]c , i , o , u ) .",
    "this means that for strong communities , for example , in order to have the same statistics as if a standard simple random sample was performed , the rds needs up to 40 times the same sample size .",
    "furthermore , if we redistribute the infection of @xmath34 randomly chosen infected nodes to decrease homophily , the overall quality of the statistics improves but still with significant bias , and larger standard deviation and design effect for stronger community structure ( fig .",
    "[ fig:05]d - f , j - l , p - r , v - x ) .     and the respective standard deviation @xmath44 for networks with a , b , e , f , i , j ) strong and c , d , g , h , k , l ) weak community structure . in the 1st column",
    ", @xmath31 is concentrated in the small communities ( sri protocol ) , in the 2nd column , @xmath31 is concentrated in the large communities ( bri protocol ) , and in the 3rd column , @xmath31 is concentrated in the high degree nodes ( pri protocol ) . ]",
    "( eq .  [ eq:02 ] ) and the respective standard deviation @xmath44 , the average bias @xmath58 ( eq .  [ eq:03 ] ) , and the design effect @xmath48 ( eq .  [ eq:04 ] ) . in all cases , @xmath32 of the population is infected with @xmath31 in a - c , g - i ) the smallest communities and in d - f , j - l ) the largest communities ( see section  [ methods_c ] ) .",
    "a - f ) networks with strong communities and g - l ) networks with weak communities . ]",
    "( eq .  [ eq:02 ] ) and the respective standard deviation @xmath44 , the average bias @xmath58 ( eq .  [ eq:03 ] ) , and the design effect @xmath48 ( eq .  [ eq:04 ] ) . in all cases , @xmath32 of the population is infected with @xmath31 in a - c , g - i ) the smallest communities and in d - f , j - l ) the largest communities ( see section  [ methods_c ] ) .",
    "a - f ) networks with strong communities and g - l ) networks with weak communities . ]    on the other hand , we can assume that @xmath31 is unlike to occur in small communities because , for example , nodes associated to these communities are simply less likely to get an infection due to isolation .",
    "social control is also often higher in small groups",
    ". it may therefore be easier to behave in certain ways in larger groups .",
    "people who want to or who have particular behaviors or traits may thus decide to move to larger groups . to simulate this hypothetical scenario , we infect @xmath32 of the nodes in the largest communities ( see section  [ methods_c ] ) .",
    "figure  [ fig:06]a shows that @xmath31 is overestimated for @xmath62 for strong community structure .",
    "these estimates improve for weaker communities , also resulting on smaller standard deviations ( fig .",
    "[ fig:06]g , m , s ) for larger response - rates .",
    "the standard deviation is generally slightly larger in this case in comparison to the case where @xmath31 is concentrated in the small communities .",
    "the design effect is very high for strong community structure ( fig .",
    "[ fig:06]c , i ) , even if homophily is reduced ( fig .",
    "[ fig:06]f , l ) .",
    "we perform the same analysis using networks with the same configuration studied until now but with higher clustering coefficient ( between 0.5 and 0.6 ) and the results remain quantitatively the same ( apart for a few fluctuations ) .",
    "this finding reinforces the previous observation that triangles have a relatively small impact in rds if communities are present in the network .",
    "altogether , these results show the key difference between clustering and homophily that was mentioned in the introduction . in both scenarios ,",
    "the network community structure and the number of triangles are the same , and homophily is high . in the later case ( fig .",
    "[ fig:06 ] ) homophily occurs inside the largest communities whereas in the first case ( fig .",
    "[ fig:05 ] ) it happens in the smallest communities .",
    "the structure - induced biases however remain relatively high even if the homophily is reduced by redistributing a fraction of the infections .      in the previous section ,",
    "we have studied the bias induced by the network structure and the response - rates .",
    "if we fix the response - rate , each realization of the simulation generates a different sample size due to the stochastic nature of the process . in this section , therefore , we fix the response - rate and analyze the effect of the sample size on the estimator .",
    "since recruitment may stop at different times on each simulation , here we estimate the mean and standard deviation for sample size @xmath70 using only simulations in which the recruitment reaches this size @xmath70 .",
    "this means that the estimates for large sample sizes have less data points ( to calculate the mean ) than those for small sample sizes .",
    "previous studies report that in real settings , response - rates may vary between @xmath71 ( for female sex - workers ) and @xmath72 ( for msm ) , with mean and median at about @xmath73  @xcite .",
    "we thus study 3 scenarios for the response - rates : @xmath74 .",
    "figure  [ fig:07 ] shows that for strong community structure , @xmath61 is slightly overestimated for sample sizes smaller than @xmath17 and underestimated for larger sample sizes if @xmath31 is concentrated in the smallest communities ( fig .",
    "[ fig:07]a , b ) . on the other hand ,",
    "the prevalence of @xmath31 is overestimated for sample sizes larger than @xmath17 if @xmath31 is concentrated in the largest communities ( fig .",
    "[ fig:07]e , f ) . in both cases ,",
    "the mismatch is maximized when the sample size is between about @xmath75 and @xmath76 ( i.e.  100 and 1500 participants respectively ) of the study population . if @xmath31 is concentrated in the high degree nodes , @xmath61 is underestimated for increasing sample size ( fig .",
    "[ fig:07]i , j ) but not as much as for the previous cases . on the other hand",
    ", if the community structure is weak , the estimator performs well ( with slight over- and under - estimation of the prevalence for small ( fig .",
    "[ fig:07]c , d ) and large ( fig .",
    "[ fig:07]g , h ) communities , except in the case of @xmath31 being concentrated in high degree node ( fig .",
    "[ fig:07]k , l ) . in this case , the estimates are only good in the range of sample sizes between @xmath17 and @xmath14 nodes .          we have assumed so far that seeds are uniformly chosen within the target population . while this is a reasonable standard assumption in theoretical studies ,",
    "it is hardly met in real contexts because the inherent fact that the study population is hard - to - reach and seed selection is non trivial  @xcite",
    ". a biased selection of seeds can increase the bias in the rds estimators as shown in figs .",
    "[ fig:08 ] and  [ fig:09 ] .",
    "if seeds are selected only between subjects associated to small communities ( here defined as communities with less than 200 members ) , recruitment chains are generally unable to reach beyond those communities and thus the prevalence is overestimated when the infection is concentrated in the smaller communities ( fig .",
    "[ fig:08]a - c ) . on the other hand ,",
    "the prevalence is underestimated if the infection is concentrated in the larger communities ( fig .",
    "[ fig:08]d - f ) .",
    "the mismatch in the estimators are particularly significant if the community structure is stronger , however , the prevalence is also strongly biased for low response - rates ( and weakly biased for high response - rates ) even if the community structure is weak ( fig .",
    "[ fig:08]g - l ) .",
    "this is in contrast to the our previous findings when seeds are uniformly sampled ( fig .",
    "[ fig:05 ] and  [ fig:06 ] ) .",
    "if one selects the seeds in the largest communities ( here defined as communities with more than 500 members ) , recruitment chains tend to stay within the largest communities , which leads to an under - estimation of the prevalence and relatively high biases if the infection is mostly prevalent in the small communities ( fig .",
    "[ fig:09]a - c ) .",
    "the prevalence is overestimated , however , if the infection is mostly prevalent in the largest communities ( fig .",
    "[ fig:09]d - f ) .",
    "results improve for weak community structure , but also in this case , biases and large standard deviations are observed for low response - rates ( fig .",
    "[ fig:09]g - l ) .",
    "note that in these experiments homophily is relatively weak since we use protocols sri and bri .      in the previous sections ,",
    "we have studied the impact of various levels of community structure and number of triangles in rds estimates in contact networks generated using theoretical models .",
    "although the algorithms used to generate the synthetic networks include several properties of real - life networks , empirical networks , with their own sampling and scope limitations , contain correlations that may be challenging to reproduce theoretically . in this section",
    ", we analyze the rds performance using real - life human contact networks in order to be able to extend the conclusions to real scenarios .",
    "following the same protocols to infect preferentially the largest ( bri protocol ) or the smallest ( sri protocol ) communities , or the high degree nodes ( pri protocol ) , we find that in most studied networks , rds performs well to estimate the mean prevalence in these hypothetical scenarios ( although the standard deviations are relatively large ) , with a small variation for different response - rates ( fig .  [ fig:10 ] ) .",
    "the estimates are worse for ema1 and enr datasets , respectively , the smallest and the largest networks ( see table  [ tab:01 ] in section  [ methods_a ] ) .",
    "we see that the average bias is larger than @xmath75 with a few exceptions .",
    "it is also typically larger for @xmath77 .",
    "the design effect is generally somewhere between 1 and 3 ( one exception for @xmath77 and ema2 ) , a result inline to previous suggestions that a design effect of @xmath78 may be used as a general guideline on unknown populations  @xcite .",
    "( eq .  [ eq:02 ] ) and the respective standard deviation @xmath44 , the average bias @xmath58 ( eq .  [ eq:03 ] ) , and the design effect @xmath48 ( eq .  [ eq:04 ] ) .",
    "recruitment is limited to @xmath30 participants . in all cases , @xmath32 of the population",
    "is infected with @xmath31 in a - c , g - i ) the largest communities and in d - f , j - l ) the smallest communities ( see section  [ methods_c ] ) . a - f ) networks with strong communities and g - l ) networks with weak communities . ]",
    "recruitment trees often break down after a few waves in real settings . as discussed above , this is not only a consequence of low response - rates but also the effect of multiple recruitment trees , originating from different seeds , bumping each other and then dying out .",
    "a practical solution to obtain sufficiently large sample sizes is to restart the recruitment with new seeds as soon as the recruitment stops . in this section",
    "we test the effect on the estimators if we start a new seed after the previous recruitment chain has completely stopped , i.e.  seeds start at different points in time .",
    "we assume that the recruitment chain stops either naturally or after reaching a certain size .",
    "in particular , we test the case when the target sample size is @xmath30 participants out of the population of @xmath20 people , using 10 seeds as done in the previous sections . each seed is allowed to recruit ( successfully ) at maximum 50 participants , and a new seed is only selected ( uniformly among non - recruited nodes ) when the current recruitment stops . as usual , the same person may participate only once .",
    "figure  [ fig:11 ] shows that the average estimator is affected and the prevalence is under - estimated if @xmath31 is concentrated in the largest communities and over - estimated if @xmath31 is more likely in smaller communities .",
    "the standard deviations are relatively large in case of strong communities ( fig .",
    "[ fig:11]a , d ) and decreases , but still maintaining relatively large values , for weaker communities ( fig .",
    "[ fig:11]g , j ) .",
    "the average bias and design effect substantially change in comparison to the case when seeds are selected simultaneously , particularly for strong community structure .",
    "the restarting of seeds introduces mixing , or equivalently , random links , in the network structure  @xcite .",
    "moreover , the restriction in the size of the recruitment trees possibly inhibits the sampling process to reach the stationary state , a factor known to cause biases in the estimators  @xcite .",
    "the major consequence of these very large biases is that one is not sure that a single rds experiment ( as is usually the case in reality ) provides a reliable estimate .",
    "selecting exactly one new seed after the current seed has being exhausted is an hypothetical situation .",
    "this extreme case however illustrates that the non - simultaneous selecting of seeds may increase the biases substantially unless only a few re - starts occur .",
    "we expect that more realistic scenarios ( e.g.  initially selecting multiple seeds simultaneously and eventually selecting a few new seeds if the original recruitment trees die out ) lie somewhere between this case and the simultaneous seed sampling studied in section  [ results_b ] .",
    "respondent - driven sampling has been proposed as an effective methodology to estimate the prevalence of variables of interest in hard - to - reach populations .",
    "the approach exploits information on the social contacts for both recruitment and weighting in order to generate accurate estimates of the prevalence .",
    "social networks however are not random but contain patterns of connectivity that may constrain the cascade of sampling . in particular",
    ", nodes have a high heterogeneity in the number of contacts , and networks typically have many triangles and a community structure .    in this paper",
    ", we have studied the bias induced by community structure and network triangles in the rds by using both synthetic and empirical network structures with various levels of clustering , size , degree heterogeneity , and so on .",
    "we have also analyzed the impact of various response - rates in the estimators and quantified the relative bias for combinations of parameters .",
    "altogether , we have identified that the structure of social networks have a relevant impact on rds leading to potential biases in the rds estimator .",
    "the estimator generally performs sufficiently well if response - rates are sufficiently high , the community structure is weak and the prevalence of the variable of interest is not much concentrated in some parts of the network ( low homophily ) .",
    "the high heterogeneity of the network communities implies that sampling chains may get constrained to certain parts of the network and thus the prevalence of the infection may be either under- or over - estimated depending on which part of the network concentrates more infections .",
    "some parts of the network may only be accessed through tight bottlenecks , i.e.  key individuals that bridge the small well - hidden sub - groups and the rest of the population .",
    "if these bridging nodes are not willing to participate in the recruitment or once they are recruited , recruitment trees get trapped within a group of nodes , oversampling them , and generating biases .",
    "the structure of empirical networks may vary in different contexts .",
    "consequently , the expected biases may be also lower or higher for certain social networks .",
    "in particular , biases should increase for sparser networks because less paths are available between the nodes .",
    "in other words , there are more bridging nodes maintaining the network connected and thus the recruitment becomes more sensitive to lower response - rates .",
    "similarly , lower biases are expected in denser networks .",
    "the number of network communities and the distribution of community sizes may be also different than the ones we consider .",
    "many small communities have a significant effect in the sampling , increasing the biases , because they imply on the existence of many bridging nodes and higher chances to divert or break down the recruitment .",
    "we have also assumed that those people who choose to not participate in the first invitation may be invited again .",
    "this possibly introduces a positive correlation between chance to answer the survey and the degree of the node , i.e.  a tendency to oversample high degree nodes not related to clustering or community structure .",
    "since this is not possible for response - rates @xmath79 and we generally observe relatively similar results for decreasing @xmath28 , if this effect occurs , it is only relevant for low response - rates @xmath28 .",
    "this may however explain why we generally observe a transition in the average bias at values above the critical response - rates ( the point where a significant number of individuals is recruited ) .",
    "on the other hand , the effect of clustering and communities should be even higher if we assume that people can not be invited more than once ( or equivalently , if someone refuses to participate the first time , it may refuse the following times as well ) since this is further blocking the access to certain parts of the network .    to understand the effect of the participation probability @xmath28",
    ", we may consider the simple case where a one single coupon is exchanged between individuals , and the sampling is done with replacement  @xcite . in that case , the stochastic process is equivalent to a random walk process if @xmath80 .",
    "the probability @xmath81 of finding a coupon with person @xmath38 is driven by the rate equation @xmath82 where @xmath83 is the adjacency matrix of the social network . in the case of undirected and unweighted networks , where each link is reciprocated and carries the same importance",
    ", the element matrix @xmath84 of the matrix is equal to 1 if there is a link between @xmath38 and @xmath85 and zero otherwise .",
    "the study of this stochastic process has a long tradition in applied mathematics and statistical physics ( e.g.  @xcite ) .",
    "relevant to our results , it is known that the system converges to equilibrium if the underlying network is connected  @xcite . in this regime , nodes would be visited by coupons with a probability proportional to their degree and the whole network is explored , independently on the initial conditions .",
    "equilibrium is reached after a characteristic time scale @xmath86 defined as @xmath87 , where @xmath88 is the first non - zero eigenvalue of the laplacian matrix driving @xmath28 in eq .",
    "( [ ctrw ] ) .",
    "this time scale is associated to the presence of a bottleneck ( the bridging nodes ) between two strongly connected communities in the network . for times smaller than @xmath86",
    ", the random walk has essentially explored almost uniformly one single community , but has not sufficiently explored the other one .",
    "this time scale therefore provides us with a way to estimate the minimal value of @xmath28 needed for the whole graph to be sampled , that is @xmath89 .",
    "the case of sampling with restart is related to the process of random walk with teleportation . in that case , the choice of the seed where to restart the process is known to affect the statistical properties of the sampling of the network  @xcite .",
    "a future theoretical exercise is to adapt those ideas to this context in order to improve the rds estimators on situations where restarting is necessary .",
    "furthermore , using non - backtracking random walks may be a possible theoretical direction to model rds considering sampling without replacement .",
    "those random walks avoid to go back from where they come from , at the previous step , and they are known to explore the network faster  @xcite .    finally , the results of our numerical exercise suggest some general recommendations for studies in real settings : i. experimental researchers should be aware of the potential critical bridge nodes in the study population , which may vary according to the characteristics of the population ; ii .",
    "experimental researchers should aim to response - rates at least above 0.4 in order to reduce the associated biases and uncertainty of the estimates .",
    "this recommended response - rate may be increased if more coupons are used ; iii .",
    "attention should be taken on selecting the seeds as uniformly as possible , particularly aiming to avoid many seeds either in the small or in the large groups ( typically the most reachable individuals ) .",
    "the temptation to start all seeds within well - hidden groups may cause the recruitment to not move beyond these groups ; iv . restarting the seeds ( to get larger sample sizes ) during the ongoing recruitment should be generally avoided .",
    "a better strategy may be to either start the experiment with more seeds or to increase response - rates to avoid dropouts .",
    "lecr is a fnrs charg de recherches .",
    "lecr and aet thank vr for financial support .",
    "lecr and fl conceived the study .",
    "lecr performed the simulations and analyzed the results .",
    "lecr , aet , rl , fl wrote the manuscript .",
    "the authors declare that they have no competing financial interests .",
    "correspondence and requests for materials should be addressed to lecr  .",
    "a. abdul - quader , d. heckathorn , c. mcknight , h. bramson , c. nemeth , k. sabin , k. gallagher , d. des jarlais effectiveness of respondent - driven sampling for recruiting drug users in new york city : findings from a pilot study . j. urban health 83 ( 3 ) 459 - 476 ( 2006 )            w. robinson , j. risser , s. mcgoy , a. becker , h. rehman , m. jefferson , v. griffin , m. wolverton , s. tortu recruiting injection drug users : a three - site comparison of results and experiences with respondent - driven and targeted sampling procedures j. urban health 83 29 - 38 ( 2006 )    c. mcknight , d. des jarlais , h. bramson , l. tower , a. s. abdul - quader , c. nemeth , d. heckathorn respondent - driven sampling in a study of drug users in new york city : notes from the field j. urban health 83 54 - 59 ( 2006 )    d. abramovitz , e. m. volz , s. a. strathdee , t. l. patterson , a. vera , s. d. frost , e. proyecto using - respondent - driven sampling in a hidden population at risk of hiv infection : who do hiv - positive recruiters recruit sex .",
    "26 ( 12 ) 750 - 756 ( 2009 )    m. y. iguchi , a. j. ober , s. h. berry , t. fain , d. d. heckathorn , p. m. gorbach , r. heimer , a. kozlov , l. j. ouellet , s. shoptaw , w. s. zule simultaneous recruitment of drug users and men who have sex with men in the united states and russia using respondent - driven sampling : sampling methods and implications j. urban health 86 ( 1 ) 5 - 13 ( 2009 )      l. f. costa , o. n. oliveira jr .",
    ", g. travieso , f. a. rodrigues , p. r. villas boas , l. antiqueira , m. p. viana , l. e. c. rocha analyzing and modeling real - world phenomena with complex networks : a survey of applications adv .",
    "60(3 ) ( 2011 )      r. d. burt , h. hagan , k. sabin , h. thiede evaluating respondent - driven sampling in a major metropolitan area : comparing injection drug users in the 2005 seattle area national hiv behavioral surveillance system survey with participants in the raven and kiwi studies ann epidemiol .",
    "20 ( 2 ) 159 - 67 ( 2010 )    n. mccreesh , l. g. johnston , a. copas , p. sonnenberg , j. seeley , r. j. hayes , s. d. w. frost , r. g. white evaluation of the role of location and distance in recruitment in respondent - driven sampling int . j. health geographics 10 ( 56 ) ( 2011 )    l. g. johnston , y .- h .",
    "chen , a. silva - santisteban , h. f. raymond an empirical examination of respondent driven sampling design effects among hiv risk groups from studies conducted around the world aids behav .",
    "17 ( 6 ) 2202 - 2210 ( 2013 )                m. malekinejad , l. g. johnston , c. kendall , l. kerr , m. r. rifkin , g. w. rutherford using respondent - driven sampling methodology for hiv biological and behavioral surveillance in international settings : a systematic review aids behav .",
    "12 ( 4 ) s105-s130 ( 2008 )"
  ],
  "abstract_text": [
    "<S> sampling hidden populations is particularly challenging using standard sampling methods mainly because of the lack of a sampling frame . </S>",
    "<S> respondent - driven sampling ( rds ) is an alternative methodology that exploits the social contacts between peers to reach and weight individuals in these hard - to - reach populations . </S>",
    "<S> it is a snowball sampling procedure where the weight of the respondents is adjusted for the likelihood of being sampled due to differences in the number of contacts . in rds , the structure of the social contacts thus defines the sampling process and affects its coverage , for instance by constraining the sampling within a sub - region of the network . in this paper </S>",
    "<S> we study the bias induced by network structures such as social triangles , community structure , and heterogeneities in the number of contacts , in the recruitment trees and in the rds estimator . </S>",
    "<S> we simulate different scenarios of network structures and response - rates to study the potential biases one may expect in real settings . </S>",
    "<S> we find that the prevalence of the estimated variable is associated with the size of the network community to which the individual belongs . </S>",
    "<S> furthermore , we observe that low - degree nodes may be under - sampled in certain situations if the sample and the network are of similar size . </S>",
    "<S> finally , we also show that low response - rates lead to reasonably accurate average estimates of the prevalence but generate relatively large biases .    </S>",
    "<S> biblabel[1]#1 . </S>"
  ]
}