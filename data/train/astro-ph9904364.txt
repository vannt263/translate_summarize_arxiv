{
  "article_text": [
    "structure forms in hierarchically clustering universes as primordial dark matter density fluctuations are amplified by gravity and collapse in a constantly evolving population of virialized dark matter halos . in this scenario",
    "galaxies are envisioned to form as baryons follow the dark matter collapse , dissipate their kinetic energy through shocks , and radiate it away as they settle ( and form stars ) in centrifugally supported structures at the center of dark halos .",
    "galaxies evolve afterwards as a result of mergers between protogalaxies and of further accretion of intergalactic gas ( white & rees 1978 , navarro & white 1993 , cen & ostriker 1993 , navarro , frenk & white 1994 , evrard , summers & davis 1994 , katz , weinberg & hernquist 1996 , bryan et al 1998 , couchman , thomas , & pearce 1995 , yepes et al 1997 , navarro & steinmetz 1997 , tissera , lambas & abadi 1997 , steinmetz & navarro 1998 ) .",
    "gravity , pressure gradients , hydrodynamical shocks , and the ability of gas to radiate are therefore physical processes of crucial importance during the formation of galaxies in a cosmological context .",
    "numerical experiments intended to simulate galaxy formation must therefore capture accurately these essential ingredients on the many different levels of the hierarchy that coexist at a given time .",
    "unfortunately , detailed analytic solutions are not known for relevant analogues of the complex galaxy formation process and it has been difficult to assess properly the accuracy and reliability of these codes ( frenk et al 1999 ) .",
    "previous studies have therefore focussed on the sensitivity and convergence of the results regarding numerical parameters such as the size of the grid used in eulerian hydrodynamical methods ( cen 1992 , bryan et al 1998 ) or the number of particles used in particle - based methods such as the smooth particle hydrodynamics ( sph , see gingold & monaghan 1977 , benz 1990 , hernquist & katz 1989 , navarro & white 1993 , summers 1993 for general introductions to sph ) .",
    "convergence as resolution improves is a necessary condition for simulations to be reliable , but is often not sufficient to ensure that the results are accurate and robust .",
    "there is clearly a need for analytic solutions that describe physical situations similar to the galaxy formation scenario envisioned in cosmological models and that can be used to gauge the performance of cosmological hydrodynamical codes .",
    "spherical infall is one relevant situation for which a detailed solution is known .",
    "bertschinger ( 1985 ) first computed the detailed behaviour of collisional gas being accreted onto a point mass perturber in an einstein - de sitter universe . assuming that only gravity , pressure gradients , and hydrodynamical shocks control the gas behaviour , bertschinger exploited the scalefree nature of all these processes to derive similarity solutions that offer a useful testbed for hydrodynamical codes ( navarro & white 1993 , summers 1993 ) .",
    "one crucial ingredient of the galaxy formation process is , however , missing from these tests : radiative cooling .",
    "this is because the cooling function is the result of atomic processes that are not independent of scale and therefore similarity solutions of the spherical infall problem are not generally available when radiative energy losses are included .",
    "this is true even in the very simplified case when radiation transfer , heat conduction , and magnetic effects are neglected .",
    "self - similarity may still be recovered in situations that include radiative cooling at the expense of placing restrictions on the temperature and density dependence of the cooling function .",
    "for example , bertschinger ( 1989 ) computed the detailed self - similar evolution of cooling flows in isothermal potentials under the assumption that the gas cooling function is a power law of density and temperature , @xmath1 . for @xmath2 ,",
    "this power law resembles the contribution from thermal bremsstrahlung to the overall cooling function , so these results can be usefully applied to the hot , diffuse x - ray emitting gas that fills the intracluster medium of rich galaxy clusters .",
    "unfortunately , these solutions are only valid for isolated systems originally in hydrostatic equilibrium and therefore their applicability to problems where continuous mass accretion play a significant role is limited .",
    "a related approach has been recently described by owen , weinberg & villumsen ( 1988 ) , who derive a family of cooling functions that ensure self - similar evolution in einstein - de sitter universes with power - law initial density fluctuations . in this case ,",
    "similarity is preserved by ensuring that the cooling timescale of an object with characteristic clustering mass ( @xmath3 ) is a fixed fraction of the hubble time .    in this paper",
    "we follow a similar approach and derive similarity solutions for the spherical infall problem that include energy losses due to radiative cooling .",
    "similarity is preserved by choosing a convenient power - law form of the cooling function , and its solutions are compared with the results of direct numerical simulations using a hydrodynamical sph code . because of the restrictions placed on the cooling function , the applicability of the results to realistic models of galaxy formation is not straightforward , but the solutions are very useful as tests of hydrodynamical codes under physical conditions that combine the major ingredients of galaxy formation models : gravitational collapse , pressure gradients , energy dissipation through shocks , and radiative energy losses , _ in a proper cosmological context .",
    "_    we derive the similarity solutions in  2 and compare them with numerical simulations in  3 .",
    "section 4 discusses the results and  5 summarizes our main conclusions .",
    "the evolution of a density perturbation in an einstein - de sitter universe is expected to be self - similar if the initial perturbation contains no physical scales . following fillmore & goldreich ( 1984 ) we characterize the initial perturbation at some initial time @xmath4 by the excess mass within a radial shell of ( initial ) radius @xmath5 , @xmath6 where @xmath7 is the unperturbed mass within @xmath5",
    ", @xmath8 is the critical density for closure , @xmath9 is hubble s constant at @xmath10 , @xmath11 is some reference mass , and @xmath12 . because the mass excess is positive each radial shell is bound to the center and collapses after reaching a ( maximum ) turnaround radius , @xmath13 .",
    "the turnaround radius increases with time as @xmath14 where @xmath15 .",
    "the mass inside the turnaround radius then grows as @xmath16 , where @xmath17 is the usual definition of redshift .",
    "this scaling can be compared with that of the characteristic clustering mass in a scalefree hierarchical clustering universe where the power spectrum of initial density fluctuations is @xmath18 : @xmath19 .",
    "perturbations characterized by a given value of @xmath20 therefore accrete mass at the same rate as a `` typical '' mass concentration in a scalefree universe with @xmath21 .",
    "a central point mass perturbation corresponds to @xmath22 , with @xmath23 and @xmath24 .",
    "this is the case considered by bertschinger ( 1985 ) .    assuming that at @xmath10 the initial velocity field is pure unperturbed hubble flow , @xmath25 , there are no further scales in the problem once the magnitude of initial density perturbation has been specified , and the time evolution of the system must approach self - similarity after a short initial transient .",
    "this implies that a unique solution , expressed in properly scaled variables , describes the structure of system at all times @xmath26 .",
    "it is convenient to express this solution in nondimensional form and , following bertschinger ( 1985 ) , we define dimensionless radii , velocities , densities , pressures , masses , and temperatures as follows , @xmath27 @xmath28 @xmath29 @xmath30 @xmath31 @xmath32 where @xmath33 is the usual ratio of specific heats",
    ".    the equations describing the motion of a collisional fluid with spherical symmetry can be expressed in terms of these dimensionless variables and are given by ( see bertschinger 1985 for details ) , @xmath34 @xmath35 @xmath36 @xmath37 here primes refer to differentiation relative to @xmath38 .",
    "eqs.(4 ) are , respectively , the continuity , euler , adiabatic , and mass equations and are valid for a pressurized fluid flow neglecting radiation , heat conduction , and deviations from spherical symmetry .",
    "pressurization of each radial shell of fluid occurs soon after turnaround as the collapsing shell encounters previously collapsed ones .",
    "because of similarity constraints , the radius at which the shock occurs must be a constant fraction of the turnaround radius , @xmath39 .",
    "outside @xmath40 the evolution of the gas is identical to the turnaround and collapse of a pressureless shell of material . a full solution of eqs.(4 )",
    "can be found by locating the radius of the shock and applying hugoniot shock jump conditions to the exterior pressureless infall values . a parametric form of the preshock cold accretion flow is given by , @xmath41 @xmath42 @xmath43 @xmath44 with @xmath45 .",
    "the shock location depends also on the central boundary conditions , which we take to be that the velocity and mass must vanish , i.e. @xmath46 at @xmath47 .",
    "identifying the values of the variables inside ( outside ) the shock by the subscript 2 ( 1 ) , we have , at @xmath39 , @xmath48 @xmath49 @xmath50 @xmath51 figure 1 shows the resulting density , velocity , temperature and entropy profiles for various values of the initial perturbation parameter @xmath20 . as @xmath20 decreases from unity ( the value corresponding to a point mass perturbation , see solid line ) to @xmath52 ( dashed line ) , the shock moves inwards , the inner density profile becomes shallower and the temperature profile becomes approximately isothermal .",
    "we shall see next how these results are altered by the inclusion of radiative cooling effects .",
    "the results discussed in the previous subsection are only applicable in the limiting case when energy losses due to radiative cooling are neglected .",
    "as discussed in  1 , the cooling function of a plasma with realistic cosmic abundances has a complex dependence on temperature and imposes dimensional physical scales on the problem that violate the conditions required for the existence of self - similar solutions .",
    "similarity solutions may exist only when the cooling processes introduce no further scales in the problem .",
    "this condition can be satisfied by choosing an appropriate cooling function so that the overall cooling efficiency is independent of time",
    ". this can be ensured by demanding , for example , that the cooling radius ( i.e. the radius at which the cooling time equals the age of the universe ) be a fixed fraction of the turnaround radius of the system .",
    "equivalently , one may require that , at some fixed fraction of the turnaround radius , the ratio between the local cooling timescale and the age of the universe be constant and independent of time .",
    "the cooling time is given by @xmath53 where @xmath54 is the specific thermal energy of the gas , and the proportionality in eq.(7 ) is valid at a fixed value of @xmath38 .",
    "the condition @xmath55 is thus satisfied if @xmath56 this condition is independent of @xmath20 and implies that the solution will be self similar regardless of the time dependence of the turnaround radius .",
    "our similarity solutions thus require a weaker dependence on density and a stronger dependence on temperature than expected from thermal bremsstrahlung emission , @xmath57 .",
    "we note , however , that eq.(9 ) is not the only cooling function that would lead to self - similar evolution .",
    "in particular , since the characteristic `` virial temperature '' ( @xmath58 ) of the system is related to its mean density by the growth rate of the turnaround radius , it is possible to retain the @xmath59 dependence characteristic of realistic cooling functions and adjust only the temperature exponent to preserve similarity .",
    "the price one pays is that in this case the temperature exponent of the self - similar cooling function depends on @xmath20 .",
    "more explicitly , @xmath60 , with @xmath61 ( owen et al 1998 ) . in this case , the relative velocities of the cooling radius and the shock radius are equal . we emphasize that our choice of self - similar cooling function ( eq.9 ) is independent of @xmath20 and does not rely on tuning the two velocities to agree with each other .",
    "once the appropriate form of the cooling function has been chosen , the behaviour of the gas can be computed using eqs.(4 ) after modifying the entropy conservation equation ( 4.3 ) to allow for energy losses . in dimensionless form , the modified eq.(4.3 ) now reads @xmath62 at any radius inside the shock , and at all times , the ratio between the local dynamical time ( @xmath63 and the cooling time equals @xmath64 .",
    "equations 4.1 , 4.2 , 4.4 , and 10 can now be solved to describe the post - shock flow once adequate boundary conditions at the center are imposed . as discussed by bertschinger ( 1989 ) ,",
    "three different kinds of solutions can be identified according to the limiting behaviour of the solution near the center .",
    "the first type is a solution where the flow stagnates at some finite radius . infalling gas settles onto this surface , where the density formally diverges . in order to obey self - similarity",
    "the surface must move outwards at the same rate as the turnaround radius .",
    "this kind of solution thus requires a piston to move the surface outwards and is therefore of little physical applicability .",
    "the second type of inner solution corresponds to a flow that extends all the way to @xmath47 so that the local flow time , @xmath65 , near the center becomes much shorter than the cooling time .",
    "these solutions are referred to as `` adiabatic '' solutions , because cooling is unimportant for small @xmath38 .",
    "the mass accretion rate near the center approaches a constant and the accretion speed diverges near the center .",
    "the third kind of solution , sometimes called the `` eigensolution '' , is the limiting adiabatic solution with minimum central mass accretion rate , or , equivalently , the limit of the family of stagnating solutions as the stagnation radius tends to zero .",
    "each of these solutions is characterized by different values of the shock radius , @xmath40 .",
    "values of @xmath40 similar to those obtained neglecting cooling correspond to solutions with stagnation points . as the shock radius moves inwards the stagnation point moves closer to the center and the solution transitions through the eigensolution to the adiabatic case .",
    "figure 2 shows examples of these three different solutions for the case @xmath22 , @xmath66 .",
    "the solution with @xmath67 ( dotted line ) has a stagnation point at @xmath68 where the density diverges and the velocity becomes zero at the surface . there is no mass inside this radius , and the surface is pushed out by a piston to preserve similarity .",
    "as the shock radius is reduced to @xmath69 the flow extends all the way to the center and the infall velocity diverges there .",
    "the eigensolution corresponds to @xmath70 . in this case",
    "the central velocity remains finite at the origin and the flow extends all the way to the center .",
    "in practice , we find this solution numerically by letting the stagnation point , @xmath71 , approach zero .",
    "l|l|l|l @xmath20 & @xmath72 & @xmath73 & @xmath40 + 1 & @xmath74 & 0.0 & 0.3389 + 1 & @xmath74 & 0.1 & 0.1858 + 1 & @xmath74 & 0.3 & 0.0939 +   + 2/3 & 1 & 0.0 & 0.2899 + 2/3 & 1 & 0.1 & 0.1551 + 2/3 & 1 & 0.3 & 0.0733 +   + 1/3 & @xmath75 & 0.0 & 0.1889 + 1/3 & @xmath75 & 0.1 & 0.0996 + 1/3 & @xmath75 & 0.3 & 0.0422 +    noting that the solutions have approximately constant infall velocity in the inner regions , it is possible to determine the asymptotic slopes of the density and pressure profiles . as the velocity tends to a constant , @xmath76 and @xmath77 , where the normalising constants depend on the cooling parameter @xmath73",
    ". the asymptotic velocity is given by @xmath78 .",
    "figure 3 shows how the eigensolutions vary as a function of the cooling efficiency parameter @xmath73 .",
    "as the importance of cooling increases the pressure support inside the shock decreases and the shock radius moves inwards .",
    "perhaps counterintuitively , as cooling becomes more important the temperature inside the shock radius _ increases _ and the density _",
    "decreases_. this is because low entropy gas is `` lost '' to the central mass and , at fixed radius , low entropy gas is replaced by higher entropy gas that moves in from outside .",
    "the `` cooling flow '' thus results in a net _ increase _ in gas entropy at a given radius .",
    "figure 3 illustrates that cooling has a substantial effect on the structure of the system , and suggests that similarity solutions with cooling may provide a stringent test of the capabilities and accuracy of hydrodynamical codes .",
    "we pursue this issue next .",
    "as discussed in  1 , the solutions derived in the previous section can be fruitfully confronted with the results of cosmological hydrodynamical codes .",
    "this comparison is all the more interesting because the test case we discuss in the previous section captures many of the salient features of the galaxy formation process : gravitational collapse , pressurization through shocks , radiative energy losses , cooling flows .",
    "furthermore , because the solutions are self similar in time , a single simulation can be examined at different times and convergence can be directly assessed .",
    "this is important because the importance of numerical resolution varies with time within a single simulation .",
    "for example , the number of particles within the shock radius increases with time , and the ratio between the smallest resolved radius and the turnaround radius decreases with time . because the solution is unique , analyzing the deviations between analytic solution and numerical experiment at different times provides invaluable insight into the role of numerical limitations and their consequence on the subsequent evolution of the system .",
    "we use the smooth particle hydrodynamics code described by navarro & white ( 1993 ) , where details about the numerical procedure should be consulted .",
    "the initial setup is also similar to that described by these authors .",
    "we simulate a spherical region of an einstein - de sitter universe by laying down @xmath79 particles homogeneously inside a sphere of radius @xmath80 .",
    "each particle is given an initial velocity consistent with unperturbed hubble flow , and an external potential is added to mimic a point mass perturbation of mass equal to @xmath81 of the total mass of the sphere .",
    "the external potential is `` softened '' inside a fixed radius @xmath82 in order to prevent divergences , but is fully keplerian outside @xmath83 .",
    "this corresponds to the case @xmath22 in eq.(1 ) .",
    "the gravitational softening of each particle is also chosen to be equal to @xmath83 .",
    "all particles have initially the same temperature , chosen to be much lower than the final virial temperature of the system in order to prevent hydrodynamical effects from becoming important before the gas turns around and passes through the shock .",
    "two different simulations were performed , one with @xmath84 and one with @xmath66 .",
    "the simulations are evolved until the turnaround radius encompasses half of the total number of particles . at the final time , about @xmath85 of the particles have passed through the accretion shock .",
    "figures 4 and 5 show the dimensionless profiles of density , velocity , and temperature averaged in spherical bins of constant logarithmic width .",
    "the dimensionless mass enclosed inside each bin is also shown in the bottom right panel .",
    "each panel shows the result of the simulations at three different times , corresponding to different numbers of particles within the shock radius : @xmath86 ( triangles ) , @xmath87 ( squares ) , and @xmath88 ( circles ) for the simulation without cooling and @xmath89 ( triangles ) , @xmath90 ( squares ) , and @xmath91 ( circles ) for the simulation with cooling .",
    "the analytic eigensolutions corresponding to @xmath84 and @xmath66 are shown with a solid and dashed line , respectively .",
    "the simulation without cooling is in all respects similar to that reported by navarro & white ( 1993 ) , except for the fact that we use about ten times more particles . as shown in figure 4 ,",
    "the density and velocity profiles agree remarkably well with the analytic solution inside the shock radius @xmath40 .",
    "as expected , agreement with the analytic solution improves as more and more particles pass through the shock and the post - shock flow becomes better resolved .",
    "this is especially noticeable in the mass panel , where it is seen that at early times ( triangles ) the simulation deviates from the analytic solution but that the system converges to the right solution at later times .",
    "once about @xmath92 particles have gone through the shock the agreement between the solution and the experiment is remarkably good .",
    "the convergence towards the similarity solution is also convincingly demonstrated in the temperature panel , where the linear temperature scale accentuates the discrepancies near the center .",
    "one important conclusion from this analysis is that although numerical limitations compromise the results of the numerical simulations at early times , these discrepancies have no major effect on the behaviour of the system at late times .",
    "the main deviations from the analytic solutions actually happen beyond the nominal shock radius .",
    "the shock is smoothed over several resolution lengths , and even at late times only outside approximately @xmath93 the preshock flow solution is recovered in the simulations .    as discussed in  2.1 and illustrated directly by the dashed and solid lines in figures 4 and 5 , the similarity solution changes substantially when radiative cooling is included .",
    "the shock radius moves inwards , the post - shock temperature increases , the infall velocity is non zero all the way to the center , and the density decreases at all radii because of the accumulation of cold material at the center",
    ".    figure 5 shows that the numerical results match very well these predicted changes in the post - shock region .",
    "inside @xmath94 the temperature , mass , density , and velocity profiles are almost indistinguishable from the similarity solutions .",
    "remarkably , this is the case even when only @xmath95 ( @xmath96 particles ) of the mass of the system has passed through the shock , and the agreement is seen to improve as more and more particles go through the shock . as noted above , the main shortcoming of the simulation regards the width of the shocked region : particles are seen to respond to the shock as far out as @xmath97 times the nominal shock radius .",
    "it is encouraging , however , to note that the overall trend is correct , and that the volume of the shocked region is substantially smaller than in the case where cooling is neglected .",
    "one important goal of the comparison between simulations and similarity solutions presented above is to assess the reliability of numerical techniques currently being used to simulate the formation of galaxy - sized structures in the universe .",
    "the present study indicates that , to a large degree , sph methods give results that are consistent with analytic solutions in test cases that involve some of the major ingredients believed to play a significant role during galaxy formation .",
    "in particular , our results show that sph codes can reproduce faithfully the changes in temperature , density , and velocity that are associated with strong `` cooling flows '' onto a central perturbation .",
    "the mass inflow rates are also accurately reproduced , and there is no indication that numerical limitations lead to an undue increase or decrement in the amount of mass that cools and flows to the central object .",
    "this is important because it has been argued that sph - like treatments of numerical hydrodynamics may cause an artificial `` overcooling instability '' that exaggerates the importance of radiative cooling losses and leads to the formation of excessively massive gas concentrations at the center of dark halos ( thacker et al 1998 ) .",
    "our study shows that this instability is not present in the test cases we present here .",
    "the rate at which gas cools and gets accreted onto a central clump is proportional to the mass accretion rate through the shock radius and is consistent with that expected from the similarity solution .",
    "there are , however , important differences between the cases considered in our study and in that of thacker et al .",
    "these authors consider gas cooling from a hot gaseous halo _ in hydrostatic equilibrium _ within a dark halo and report a strong dependence of the cooled mass on the numerical resolution of sph simulations .",
    "they also consider a more realistic cooling function that varies with temperature and density in very different ways than the self - similar cooling function we adopt here . because of these caveats",
    ", it may be premature to argue either for or against their findings on the basis of the simulations presented here .",
    "it should be possible , however , to test their arguments using the cooling wave similarity solutions derived by bertschinger ( 1989 ) .",
    "these are a much closer analogue to the case considered by thacker et al and direct comparison between numerical experiments and bertschinger s analytic solutions should provide a definitive assessment regarding the effects of numerical resolution on the cooling and accretion of gas at the center of dark halos .",
    "we plan to carry out this comparison in the near future .",
    "we have derived similarity solutions that describe the spherical collapse , shock , and settling of collisional gas from scalefree perturbations in an einstein - de sitter universe .",
    "our study extends prior work on the subject by taking into account the full effects of energy loss due to radiative cooling processes , under the simplifying assumption that the cooling function is a simple power - law of density and temperature .",
    "this choice ensures that the time evolution of the system is self - similar by requiring that the cooling time of the system at all times is a fixed fraction of the age of the universe .",
    "the solutions take into account many of the processes that are relevant to the assembly of the baryonic component of galaxies in a cosmological scenario : gravitational infall , energy dissipation through shocks , pressure gradients , radiative energy losses , and cooling flows .",
    "analytic solutions such as the ones outlined here are invaluable to assess the reliability and diagnose the shortcomings of numerical techniques currently being used in cosmological simulations .",
    "the tests we present here show that sph simulations reproduce the analytic solutions very well .",
    "no substantial deviations from the predicted central mass accretion rates or from the temperature , density , and velocity profiles are observed inside the shock radius when cooling is included .",
    "the region affected by the shock is , however , is much larger than predicted : effects from the shock are seen as far out as 2 or 3 times the nominal shock radius .",
    "although this does not seem to affect adversely the post - shock behaviour of the gas under the simplifying conditions we adopt , it may have unwanted consequences in cases with more complex infall geometry ( such as mergers ) or that involve a cooling function with a more sensitive dependence on temperature and density than assumed here .",
    "we hope that the work reported here will encourage further efforts to test and improve the numerical treatment of the hydrodynamics of galaxy formation .",
    "this work has been partially supported by the national science and engineering research council of canada .",
    "rgb acknowledges the support of the pparc rolling grant `` extragalactic astronomy and cosmology at durham '' and the use of starlink computing facilities .",
    "mga acknowledges the hospitality of the physics department of durham university ."
  ],
  "abstract_text": [
    "<S> we describe similarity solutions that characterize the collapse of collisional gas onto scalefree perturbations in an einstein - de sitter universe . </S>",
    "<S> we consider the effects of radiative cooling and derive self - similar solutions under the assumption that the cooling function is a power law of density and temperature , @xmath0 . </S>",
    "<S> we use these results to test the ability of smooth particle hydrodynamics ( sph ) techniques to follow the collapse and accretion of shocked , rapidly cooling gas in a cosmological context . </S>",
    "<S> our sph code reproduces the analytical results very well in cases that include or exclude radiative cooling . </S>",
    "<S> no substantial deviations from the predicted central mass accretion rates or from the temperature , density , and velocity profiles are observed in well resolved regions inside the shock radius . </S>",
    "<S> this test problem lends support to the reliability of sph techniques to model the complex process of galaxy formation . </S>"
  ]
}