{
  "article_text": [
    "the calculation of finite temperature electronic properties is one of the most important and challenging aspects of the numerical simulations . in the past several progress",
    "have been done by extending the dft method to finite temperature @xcite or by using quantum monte carlo @xcite ( qmc ) within various path integral formulations @xcite , especially in the study of the hydrogen phase diagram @xcite . in both cases",
    "many problems remain as for instance the lack of an accurate local functional at finite temperature for dft methods prevents so far practical applications , and , within qmc techniques , the difficulty to deal with the fermion sign problem@xcite , restricts the spectrum of applicability to very few cases and very limited temperature ranges . on the other hand",
    "it is clear that , in many physical phenomena , such as the occurrence of magnetic or insulating phases below a critical temperature , the electronic entropy can not be neglected , even when the small ratio @xmath0 between the electronic mass and the atomic one , allows the decoupling of the electronic degrees of freedom from the atomic ones , within an acceptable approximation . in this paper",
    "we aim to extend the validity of the born - oppenheimer approximation in the following sense . by using the smallness of @xmath0",
    "we are generally lead to compute an electronic partition function @xmath1 $ ] at fixed nuclei position : @xmath2 \\label{firstbo } \\\\",
    "z[{\\bf r } ] & = & { \\mathrm{tr}}\\exp ( - h_{\\bf r}/t )   \\end{aligned}\\ ] ] where @xmath3 is the temperature ( here and henceforth the boltzman constant is assumed to be one and we neglet for simplicity the overall constant coming from integration of the atomic momenta ) , @xmath4 is the standard electronic hamiltonian , that includes also the classical ionic contribution , and that depends only parametrically upon the atomic positions @xmath5 .",
    "eq.([firstbo ] ) is the first step of the born - oppenheimer approximation that- we remark- is generally valid for @xmath0 small , namely when the temperature @xmath3 is large enough that quantum effects on protons can be neglected .",
    "the second approximation , usually adopted within the bo approximation , is to assume that the electronic degrees of freedom have a gap much larger than the temperature @xmath3 so that @xmath6 $ ] can be approximated by @xmath7 where @xmath8 is the ground state energy of the hamiltonian @xmath9 in the following derivation we want to avoid the latter approximation , because , as emphasized before , in several cases it may fail even when we are in the limit of small @xmath0 . for instance the occurrence of a broken symmetry phase often implies gapless electronic excitations in @xmath4 , and the approximation @xmath6= \\exp (   - e_0 ( { \\bf r})/t ) $ ] can not be safely assumed .",
    "other examples are conical intersections@xcite , when for some particular ionic positions @xmath4 becomes gapless and nearby the proximity between different ( namely corresponding to low - lying excited states ) bo energy surfaces is possible . in this conditions a pure electronic ground state technique fails as the tunneling between different bo energy surfaces",
    "can not be taken into account consistently .",
    "as the last very important example we mention the calculation of transition rates in chemical reactions , that can not be accurately computed within a pure bo approximation@xcite .",
    "the main task of this paper is to device a method , able to quantify finite temperature properties of realistic systems , within a rigorous variational upper bound of the total free energy @xmath10 , in the limit of small @xmath0 .",
    "the method we propose is supposed to be simple enough to avoid most of the known drawbacks , as does not rely on the knowledge of any particular functional , or , within our variational approximations , can be employed by quantum monte carlo , without facing the so called `` fermion sign problem '' .    the paper is organized as follows .",
    "the derivation of the approximate expression of the electronic partition function introduced and used in this work is given in section  [ s_upperbound ] , and some important but more detailed aspects are reported in appendixes  [ app1 ] , [ app2 ] , [ app_comparisonbo ] and [ app4 ] .",
    "this derivation is not specific for a qmc framework , indeed app .",
    "[ app4 ] is specifically oriented to an implementation of the method into a hartree - fock or dft framework .",
    "next we show how to sample the introduced partition function using a langevin dynamics for the wave function parameters , sections  [ s_mcsamplingzq ] , and the ion coordinates , section  [ s_covlangdyn ] . in section  [ s_results ]",
    "we finally show some results we have obtained using this approach for the hydrogen molecule .",
    "we consider the problem to estimate the finite temperature partition function of an electronic system with @xmath11 electrons and @xmath12 atoms , where we assume in the following that , as discussed in the introduction , the ions are classical particles ,",
    "whose coordinates @xmath5 appear just as simple parameters in the electronic hamiltonian @xmath4 and are confined in a finite volume @xmath13 . therefore , once the ion positions are fixed , we need to evaluate the electronic partition function : @xmath14 = { \\mathrm{tr}}\\exp { \\left(}-\\beta h_{\\bf r }   { \\right)}\\ ] ] where @xmath15 .",
    "our derivation applies for an hamiltonian with a bounded spectrum defined in a finite hilbert space with dimension @xmath16 .",
    "for instance in electronic structure calculation one can consider a finite dimensional basis of localized orbitals around each atom . in order to simplify the notations",
    "we can consider standard creation operators with canonical commutation rules , spanning the finite single electron basis , as for a standard lattice hamiltonian , namely @xmath17 for @xmath18 , where for shorthand notations @xmath19 labels also the spin , namely @xmath20 ( @xmath21 ) refers to spin up(down)-states .",
    "we consider the generic wavefunction @xmath22 , where : @xmath23 | 0 \\rangle   \\end{aligned}\\ ] ] and @xmath24 , for a system of @xmath11 electrons . in the continuous limit",
    "this wave function is the standard jastrow - slater one used in quantum monte carlo in order to describe electron correlation@xcite .",
    "estensions of this wave function are possible using agp@xcite , pfaffian@xcite , backflow@xcite , and the following considerations apply also for these more recent ansatz , because they all contain the slater determinant @xmath25 in a particular limit .    in all cases , the real variational parameters that define the above wave function , namely @xmath26 and @xmath27",
    "are compactly denoted by @xmath28 and since all physical quantities do not depend on the norm of the wave function , we consider the @xmath29manifold of states : @xmath30    the metric in this manifold becomes non trivial as , by a straightforward calculation , the distance between two states @xmath31 and @xmath32 is given by : @xmath33 where summation over repeated indices is assumed , and @xmath34 is a @xmath35 matrix defining the metric tensor of this rather non trivial space , described by @xmath36 independent variational parameters ( e.g. a subset of @xmath26 and @xmath37 ) .",
    "the matrix @xmath34 can be explicitly evaluated and depends only on average first derivatives of the wave function with respect to the parameters @xmath38 : @xmath39 it defines a metric as it is strictly positive definite if all @xmath36 variational parameters are independent and therefore its determinant @xmath40 is non vanishing .",
    "this matrix turns out to be exactly the one used in several optimization techniques@xcite , and can be computed also for correlated systems by sampling the correlations of the quantities @xmath41 over the configuration space @xmath42 where electrons have a definite spin and positions , namely : @xmath43 where the symbol @xmath44 denotes average over a distribution @xmath45 , that can be sampled by standard variational monte carlo .    in eq.([trace ] ) , we use a simple relation for recasting the trace in a finite dimensional hilbert space as an integral of normalized wavefunctions @xmath46 , namely : @xmath47 where @xmath48 is the area of the @xmath49dimensional unit sphere .",
    "we note that this simple relation can be used to establish within a rigorous mathematical framework the finite temperature lanczos method used in ref .. in this technique finite temperature estimates of the partition function are obtained with a finite set of randomly generated states @xmath50 , once it is assumed that @xmath51 , can be computed with high accuracy with the lanczos method .",
    "indeed this is nothing but evaluating statistically the integral in the lhs of eq.([inttrace ] ) , and one does not need any further assumption to validate the method , apart from the fact that error bars have to be computed with standard statistical techniques .    the simple relation ( [ inttrace ] ) can be also extended in the space @xmath52 with non trivial metric , by using the invariant measure @xmath53 , corresponding to the metric tensor @xmath34 : @xmath54 this relation is proven in app.[app1 ] , provided the dimension of the space is large enough , namely contains at least the full space of slater determinant wave functions , where the overall constant has been obtained by using that @xmath6=d$ ] for @xmath55 , as the metric normalization @xmath56 is defined as @xmath57 .",
    "we emphasize here that the relation ( [ basic ] ) is _ exact _ even when the dimension of the space @xmath36 is much smaller than the dimension of the hilbert space .",
    "for instance for real slater determinants the number @xmath58 as they are defined by @xmath11 orbitals each depending on @xmath59 coefficients ( see eq.[formwf ] ) , whereas the hilbert space dimension @xmath16 grows exponentially with @xmath59 and @xmath11 ( see app.[app4 ] for the parametrization of an arbitrary real slater determinant ) ) in practice the number @xmath36 of variational parameters defining the wave function ansatz can be much smaller than that necessary to span all possible slater determinants . in the case @xmath60 we expect that the equation ( [ basic ] ) is still valid but the trace in the rhs is limited to the largest subspace with dimension @xmath61 spanned by the variational ansatz .",
    "moreover a weak dependence on @xmath62 in @xmath56 is also expected when a basis dependent on the atomic positions is used ( it is not the case for a plane wave basis for instance ) .",
    "the calculation can be meaningful also in this case after a careful study of the dependence of the results upon the dimension of the basis chosen , as it is common practice in quantum chemistry calculations .",
    "in fact , in the limiting case when the one particle basis set used to define the orbitals in the slater determinant becomes complete the metric normalization @xmath56 is independent of @xmath62 , because any change of basis is equivalent in this limit to a mapping @xmath63 .",
    "thus @xmath56 , being explicitly covariant , is independent of @xmath62 and can be considered as an irrelevant constant .",
    "therefore , within the completeness assumption , following the simple derivation of app.[app2 ] , we can easily bound the exact electronic partition function @xmath64 $ ] , because , due to the convexity of the exponential function , the expectation value of an exponential operator over a normalized state @xmath65 satisfies : @xmath66 this immediately provides a rigorous lower bound @xmath67 for the partition function @xmath68 : @xmath69 and a corresponding upper bond @xmath70 for the free energy @xmath71 : @xmath72    in this way it is evident that @xmath73 represents an improvement to the standard born - oppenheimer ( bo ) approximation .",
    "in fact in this approximation only one state is assumed to contribute to the integral in eq.([defzq ] ) , namely the lowest energy state of @xmath4 within the ansatz given by @xmath74 : @xmath75   =   \\min_{\\alpha } \\left\\ { \\langle \\alpha | h_{\\bf r } | \\alpha   \\rangle \\right\\}\\ ] ] indeed it is clear that @xmath76 \\right\\}$ ] only at @xmath77 , and represents a very bad approximation to @xmath78 as long as the temperature is raised , whereas the approximate partition function @xmath79 approaches the correct large temperature limit @xmath80 of the exact partition function , while remaining a rigorous upper bound for any @xmath3 .    in app.[app_comparisonbo ]",
    "we see in detail a comparison between the approximated partition function @xmath67 here introduced , and the exact and bo ones , showing that our approximation turns out to be better than the bo one , above a temperature @xmath81 , that remains meaningful in the thermodynamic limit .",
    "in principle the partition function @xmath67 can be sampled by almost standard monte carlo methods , whenever the metric @xmath34 and the expectation value of the energy @xmath82 over the ansatz @xmath83 are known , for instance within the hartree - fock theory , namely when @xmath84 represents just a simple slater determinant .",
    "it is also possible to replace in @xmath67 the expectation value of the energy with any dft functional depending on @xmath84 , through the corresponding density or gradient , the condition of functional minimum being recovered correctly at @xmath77 . for a discussion about the space of parameters for a slater determinant wave function , and the introduction of an invariant measure in this space see app.[app4 ] .",
    "however in the truly correlated case , namely when the ansatz @xmath85 differs from a slater determinant , there are extra complications because both the matrix @xmath34 and @xmath86 are known only within statistical accuracy . in this case",
    "a possible way to sample the partition function @xmath67 and corresponding thermodynamic quantities is to use the penalty method@xcite , introduced some years ago , by using a cost function @xmath87 that can be computed statistically with corresponding error bars .    in the following",
    "we have chosen a different route , by employing a finite temperature molecular dynamics rather than monte carlo sampling , because recent quantum monte carlo packages provide efficient estimates of energy derivatives and ionic forces@xcite .",
    "our goal is to sample points in the electronic parameter space @xmath52 distributed according to the probability distribution defined in eq.([defzq ] ) , by using first order derivatives of the cost function . in the standard cartesian metric",
    "it is common practice to use a langevin dynamics for the variables @xmath88 and @xmath89 , by means of the standard first order equation of motions ( unit mass is assumed for simplicity)@xcite : @xmath90 where @xmath91 is a covariant vector in a finite dimensional euclidean space , whereas @xmath92 is the derivative ( force ) of a potential @xmath13 . by means of this equation",
    "it is well known that it is possible to sample the equilibrium distribution @xmath93 provided we satisfy the fluctuation dissipation theorem given by : @xmath94 now we suppose to change the reference coordinate system by means of a generic transformation of variables @xmath95 ( an @xmath96 dimensional non linear mapping as in general relativity ) .",
    "be the jacobian of the transform given by the matrix @xmath59 : @xmath97 the langevin equation in this new reference can be easily obtained :    @xmath98    where @xmath99 , and the equation ( [ fdeq ] ) that defines the fluctuation dissipation theorem remains unchanged .",
    "the eq.([eq_1ord ] ) is covariant if we just replace the matrix @xmath34 with the matrix defining the metric in a generic curved space : @xmath100 where , as usual , in this formalism repeated indices are assumed summed .",
    "indeed after the given transformation the above metric tensor transforms as : @xmath101 that , as it should , leaves unchanged the covariant first order langevin equation ( [ eq_1ord ] ) .",
    "thus , from the above equation , we obtain the desired result with the matrix @xmath59 given by any solution of the matrix equation : @xmath102    unfortunately eq . ( [ eq_1ord ] ) looks a bit complicated when it is discretized in times @xmath103 , because the integral of the random noise depends explicitly on the curvature of the non linear space by means of the matrix @xmath59 , and the resulting integration is not univocally defined , simply because the solution @xmath104 is not unique , since @xmath105 remains unchanged under the substitution @xmath106 , where @xmath107 is an arbitrary unitary matrix . in order to remove this arbitrariness , according to risken@xcite , we can work out the integral of the equation of motion in a small time interval of length @xmath108 , by requiring also that the corresponding markov process : @xmath109^i   \\nonumber   \\\\ & + & { 1\\over 2 } \\sum\\limits_{k } \\partial_{\\alpha_k } d_{i , k } + y_n^i \\nonumber \\\\",
    "\\langle y_n^i y_n^j \\rangle & = & d_{i , j } = { 2 \\delta \\over \\beta } s^{-1}_{i , j } ( t_n ) \\end{aligned}\\ ] ] has the correct equilibrium distribution for @xmath110 : @xmath111 in fact it is possible to show that , only with the above definition of the drift term , the associated and univocally defined fokker - planck equation for the probability distribution @xmath112 reads for @xmath110 : @xmath113^j \\right\\ } \\nonumber\\end{aligned}\\ ] ] which has the equilibrium distribution @xmath114 satisfying : @xmath115 indeed , by multiplying both sides of the equations by @xmath116 and summing over @xmath117 , we obtain the standard equation for the equilibrium distribution @xmath118 .",
    "we want to implement the above formalism in an ab - initio molecular dynamics ( md ) at finite temperature dealing with electrons and ions within the same formalism , similarly to what was done in the pioneer work by r. car and m. parrinello@xcite . in the following",
    "we will show how the ionic motion can be quite naturally included in the above scheme .",
    "in fact what we obtained before does not hold only for the electronic parameters , but for a generic set of parameters which appear in a variational wavefunction .",
    "the ionic positions @xmath119 can thus be thought as complementary parameters .",
    "the inclusion of this kind of parameters in the above formalism is straightforward : if @xmath12 is the number of atoms , then @xmath34 becomes a @xmath120 block - diagonal matrix .",
    "the mixed elements @xmath121 are always zero since wave functions characterized by different sets of atomic positions are orthogonal . moreover , since the ionic positions @xmath119 belong to the real space , the corresponding metric is the cartesian one , and is defined by a diagonal matrix @xmath122 among all the ion components .",
    "we can esplicitly write down the complete set of equations for both the atomic and electronic parameters .",
    "for the ionic positions we use @xmath123 with @xmath124 and @xmath125 being the force acting on the @xmath126-th ionic cartesian coordinate , while for the electronic variables eq .",
    "( [ eq_a ] ) holds with @xmath127 and where @xmath128 is the force acting on the parameters @xmath52 , i.e , the gradient of the total electronic energy @xmath13 evaluated at fixed @xmath119 with respect to these parameters .",
    "notice also that the time discretization corresponding to the ionic dynamics is defined by the arbitrary constant @xmath129 appearing in the extended metric tensor defined before , namely @xmath130 .",
    "it is clear therefore that the relative speed between electron and ion dynamics can be tuned to optimize efficiency , exactly as in car - parrinello ab - initio molecular dynamics .",
    "we emphasize here that in the limit @xmath131 consistent results are obtained because the equilibrium distribution ( [ equilibrium ] ) remains unaffected by the choice of @xmath129 .",
    "once we set up the discretized equations ( [ eq_a],[eq_r ] ) we can test the above formalism in a simple but realistic case .",
    "we are going to study the @xmath132 molecule , looking at the temperature behavior of the total energy @xmath133 and the bond distance @xmath134 between the two hydrogen atoms .",
    "we start with this simple system because the above quantities can be easily computed , providing therefore useful benchmarks for our technique .    according to app.[app_comparisonbo ]",
    "the distribution sampled by means of this covariant langevin dynamics ( cld ) represents an improvement of the bo only above a temperature @xmath81 . at @xmath77",
    "our approximate free energy @xmath70 coincides with the bo one @xmath135 , but as soon as @xmath136 the @xmath135 becomes better for @xmath137 .",
    "if the temperature is much lower than the electronic gap the bo approximation should be essentially exact and can be easily obtained from the potential energy surface ( pes ) @xmath138 of the @xmath132 molecule .    in the following we are going to show that , in this simple system , we can not distinguish the correct bo low temperature behavior and the one implied by our approximate technique , clearly indicating that @xmath81 should be almost negligible for this system .",
    "to proceed further we need now to specify what type of correlated variational wavefunction ( [ formwf ] ) we adopt in all the following calculations , and its dependence on the two electronic positions @xmath139 and @xmath140 . in the singlet state the orbital function @xmath141 is symmetric and positive and is parametrized here as a product of two factors @xmath142 , where @xmath143 is taken fixed and allows to satisfy the electron - electron and electron - ion cusp conditions , whereas @xmath144 is cusp free and is expanded systematically in a basis of atomic orbitals centered on each atom containing up to 3s and 1p gaussian functions and a constant one @xmath145 .",
    "this amounts to @xmath146 independent variational parameters for the symmetric matrix @xmath147 .",
    "the exponent of the gaussians are kept fixed during our simulations . despite this limitation in the choice of the basis this is acceptable for the @xmath132 molecule in a physically relevant range of distances between the atoms , as it is shown in fig.([f_pesh2 ] ) .",
    "the chosen variational ansatz is particularly useful for evaluating the complicated terms in ( [ eq_a ] ) , i.e. the _ drift - diffusion _ ones which depend linearly from the temperature and require the knowledge of the derivative of the matrix @xmath34 .",
    "this is indeed simpler for the parameters @xmath147 which appear in a linear fashion in the exponential factor @xmath148 in eq.([defj ] ) .",
    "the first step is thus to construct the pes of the molecule ( fig.[f_pesh2 ] ) . in this way we not only acquire the key information for the numerically exact evaluation of the bo observables , but we also check that our choice of the free variational parameters in the wave function allows us to recover the well known pes for this molecule@xcite .     as a function of the bond length @xmath134 obtained by minimizing the energy of our variational wavefunction for fixed @xmath134 ; in doing this we act only on those parameters @xmath88 which are kept free to evolve in the dynamics ( [ eq_a ] ) .",
    "red points : energy with error bars of configurations sampled in a dynamics ( [ eq_a],[eq_r ] ) with @xmath149 . the pes is correctly followed during the simulation . in the inset a little region around the minimum at @xmath150 is enlarged . ]",
    "canonical averages of an observable @xmath151 can be obtained by computing numerically the one dimensional ( conditionally convergent ) integrals @xmath152 on the other hand we can compute @xmath153 as a time average on the langevin dynamics ( [ eq_a],[eq_r ] ) for sufficient low @xmath3 .",
    "the extrapolation @xmath110 involving the discretized time steps is performed in the order @xmath154 .",
    "it is observed ( see fig.[f_extrap ] ) that the @xmath155 dependence of the time averages of the quantities is linear for fixed @xmath108 , a property useful in the extrapolation .     at @xmath156 as a function of @xmath155 for @xmath157 values of @xmath108 .",
    "all the series converge roughly to the same value which is also the expected one ( horizontal dashed line ) obtained with eq .",
    "( [ e_can_av ] ) , simplifying the second extrapolation @xmath110 . ]",
    "finally we show our results for the total energy and the bond distance at varius temperatures in the range between @xmath158 , i.e. from room temperature to @xmath159 .",
    "the forces acting on the parameters and on the ions , as well as the matrix @xmath34 are evaluated by a short qmc run at each iteration of the dynamics . in fig.([f_et ] ) and in fig.([f_rt ] ) we show the outcome of our covariant langevin dynamics simulations .     as a function of temperature .",
    "the range of temperature is well below the electronic gap @xmath160 ( see fig.[f_pesh2 ] ) so the expected exact value is the bo one evaluated by eq .",
    "( [ e_can_av ] ) ( black line ) .",
    "red points are obtained by integrating the coupled equations ( [ eq_a],[eq_r ] ) .",
    "data are in agreement with the predicted values . ]     as a function of temperature . even for this observable",
    "the langevin dynamics ( red points ) give values compatible with the expected ones ( black line ) . ]",
    "we see that our langevin dynamics gives result in very good agreement with the expected bo values .",
    "we stress once again that this dynamics does not require an electronic minimization at each ionic move , realizing an impressive gain from the point of view of the computational cost .     as a function of simulation time at a temperature of @xmath161 .",
    "coloured points ( red , green and blue ) correspond to simulation performed with the dynamics presented in this work , while the grey solid ones are obtained with a dft- langevin bomd .",
    "the time step used in the integration of the equations is @xmath162 and points are plotted every @xmath163 iterations .",
    "the dashed line indicates the distance @xmath164 such that the energy gap between the ground state pes and the first excited one becomes smaller than @xmath3 .",
    "all the cld trajectories show escape events while the dft one describes a stable molecular configuration up to @xmath165 of simulation time ( not shown ) . ]    on the other hand , this kind of dynamics should behave differently with respect to the standard bo - md one when the temperature is raised and for @xmath166 should be more realistic , because corresponding to a more accurate upper bound of the exact free energy @xmath78 . in figures ( [ f_et],[f_rt ] ) we limit the study of the average energy and bond length in a range of temperatures smaller than @xmath167 because , above this value , first dissociation events start to appear during the simulations .",
    "this temperature is in good qualitative agreement with low pressures experiments@xcite . roughly speaking the dissociation probability",
    "depends on the ratio between the thermal energy @xmath3 and the depth of the free energy well @xmath168 through the boltzmann weight@xcite @xmath169 within the assumption that excited electronic eigenstates are well - separated in energy from the ground state .",
    "there are instead examples@xcite in which bo approximation breaks down , particularly near the transition state of a chemical reaction .",
    "in fact , as the reaction coordinate @xmath134 increases , the energy gap between the ground state and the first ( antibonding ) excited state becomes smaller@xcite , for example when @xmath170 this quantity becomes smaller than @xmath171 .",
    "therefore large fluctuations in the bond length , certainly occurring at large temperatures , are in principle not well described under a bo scheme . since by definition , an atomic dissociation requires to sample correctly events with large @xmath134 , we expect to find differences between the standard bo - md and the dynamics generated by ( [ eq_a],[eq_r ] ) , at large enough temperatures . in fig.[f_dissoc ] , we observe that the probability of dissociation is enhanced in our dynamics , which can take implicitely into account also the effective repulsion due to the antibonding state . as expected , this is in sharp contrast with a dft - bo dynamics obtained using the quantum espresso package@xcite . in the latter dynamics large fluctuations in @xmath134 do not lead to dissociation , as is partially shown in fig .",
    "( [ f_dissoc ] ) .",
    "indeed no escape event occurs within dft bo - md , even for a long time dynamics .",
    "moreover in order to compensate the well known overbinding error@xcite of the local density approximation ( lda ) , we have increased the temperature by a factor proportional to the lda energy barrier ( @xmath172 ) , and observed no qualitative changes in the trajectories , always confined around the minimum energy value .",
    "it is clear therefore that , quite generally , the bo - md greatly underestimate the evaluation of the reaction rate if , for instance , a _",
    "_ mean first - passage time__@xcite analysis is performed .",
    "in this paper we have introduced a new promising approach to deal with finite temperature simulations of electronic systems .",
    "the approach is general and , as we have emphasized in the introduction , can be easily extended to several branches of the electronic simulations , from ab - initio finite temperature simulation of realistic systems based on hartree - fock , dft or quantum monte carlo methods , to finite temperature simulations of strongly correlated hamiltonians defined on a lattice . in particular",
    "this technique allows us to improve systematically the born - oppenheimer approximation in a temperature range where the quantum effects on atoms are neglegible . in principle",
    "also these quantum effects can be dealt in a simple way . to this purpose",
    "it is enough to define a quantum ansatz @xmath84 describing electrons and ion coordinates quantum mechanically , including in @xmath173 also variational parameters corresponding to the atomic wave function @xmath174 , for instance described by gaussians centered around the average atomic positions . in that case",
    "the same derivation holds as electrons and ions can be dealt in the same footing , the metric matrix @xmath34 will have non trival off diagonal elements between electronic and atomic variational parameters .",
    "although our first application is limited to the simple @xmath132 molecule with classical atomic coordinates , this extremely simple example already shows that it is possible to catch some qualitatively new behavior , that is not possible to describe with the conventional bo approximation .",
    "namely at large enough temperature the molecule can dissociate due to non adiabatic effects .",
    "we plan to extend our method to larger and more complex realistic systems including also quantum effects for atoms .",
    "unfortunately , so far we have encountered a difficulty to compute in an efficient way the metric tensor @xmath34 and its derivatives for a generic correlated wave function .",
    "for this reason , at present , it looks that the penalty method@xcite could be a more realistic possibility for extending our technique , because the penalty method does not require the evaluation of the derivatives of the metric tensor .",
    "apart for this technical issue there are many open problems that can be tackled with this new technique .",
    "for instance one would like to know the magnetic transition temperature of a piece of material . without taking into account the electronic entropy",
    "this is not possible for most electronic ab - initio methods , but , by applying our technique , a reasonable estimate can be easily obtained . in lattice models ,",
    "an old standing problem is for instance the extension of the gutzwiller variational ansatz to finite temperature calculations . within the variational monte carlo",
    "it has been established that the hubbard model for @xmath175 large enough should be superconducting with a d - wave order parameter .",
    "however it is not possible to predict within the same ansatz the much more interesting superconducting temperature and how it depends on the various details of the model , such as doping and the value of the coulomb repulsion @xmath175 . in our formulation",
    "what can be done at zero temperature can be readily extended to finite temperature and the evaluation of the critical temperature should be straightforward , likewise a standard ( but much more accurate because including electron correlation ) mean field theory at finite temperature .",
    "we acknowledge useful discussions with a. laio and s. de gironcoli .",
    "computational resources were supported by cineca bologna .",
    "in this appendix we use known results of differential geometry in riemann spaces@xcite with tensor metric @xmath34 . in order to prove eq.([basic ] ) , it is enough to consider the complete basis : @xmath176 where @xmath177 is an arbitrary choice of @xmath11 different integers among the @xmath59 possibilities , that defines the hilbert of space of @xmath11 fermions containing @xmath178 independent states . it is simple to realize that it is enough to prove that , given two arbitrary states @xmath179 and @xmath180 , we have : @xmath181 where @xmath182 is an overall constant . indeed , by assuming that the above equation holds , we can insert in eq.([basic ] ) the completeness @xmath183 in both the bra and the ket of numerator in eq.([basic ] ) and obtain : @xmath184 which easily proves eq.([basic ] ) .",
    "in order to establish eq.([statement ] ) we can consider the group of transformations @xmath185 that leaves unchanged the metric tensor @xmath34 defined by : @xmath186 where @xmath107 is a unitary matrix that maps any variational ansatz @xmath52 to a new variational ansatz @xmath187 of the form defined in eq.([formwf ] ) . to this purpose",
    "it is enough to consider the unitary tranformations defined by : @xmath188 where @xmath189 is an arbitrary permutation of the @xmath59 indices .",
    "all the above transformation are real and unitary and therefore conserve the distance between two arbitrary vectors , implying that the metric @xmath190 remains unchanged under all these transformations , when applied to any arbitrary state of the ansatz : @xmath191 in differential geometry these transformations are called isometries , and represent the basis for the classification of symmetric riemann spaces . in this context",
    "they are important to prove the main statement of this appendix .",
    "indeed we can consider any isometry as a change of variable in the integral and obtain that ( since the integration variables are dummy variables we can use @xmath52 in place of @xmath187 ) : @xmath192 now since the set of states is complete the matrix elements @xmath193 define univocally an operator in the given @xmath49 dimensional hilbert space . therefore by applying the relation ( [ basic2 ] ) for all isometries @xmath194 for @xmath195 , we obtain that this operator @xmath196 commutes with all fermion occupation number @xmath197 and therefore has to be diagonal , namely @xmath198 .",
    "on the other hand we can apply eq.([basic2 ] ) for an arbitrary unitary permutation @xmath199 , that is able to connect any state @xmath19 of the hilbert space to any other one @xmath200 , namely @xmath201 .",
    "thus it easily follows that : @xmath202 implying that @xmath203 does not depend on @xmath19 , and this concludes the proof of this appendix .",
    "the expectation value of an operator @xmath196 over a normalized state @xmath52 is equivalent to average @xmath204 over the distribution @xmath205 over the eigenstates @xmath206 of the operator @xmath196 .",
    "in fact it immediately follows that @xmath207 and that @xmath208 . since for any distribution @xmath209 and convex function @xmath210 , it is well known that , from jensen s inequality , we have : @xmath211 where the symbol @xmath212 means averaging over the distribution @xmath209 of the operator @xmath196 , namely @xmath213 . since the operator @xmath82 is hermitian , @xmath82 and @xmath214 are diagonalized by the same eigenvectors , and therefore the distribution @xmath209 is the same for both operators and relation ( [ bound1 ] ) simply follows from the convexity of @xmath210 . then by using the convexity of the function @xmath215 , by applying the above consideration to the operator @xmath216",
    ", we obtain : @xmath217 which concludes the proof of this appendix .",
    "in this appendix we want to investigate the nature of the approximation of the partition function @xmath67 defined in ( [ defzq ] ) and used in this work . in order to do this",
    "we will compare the approximate partition function @xmath67 with the exact @xmath68 and the approximate born - oppenheimer @xmath218 , in the general case when we use @xmath219 variational parameters in the normalized wave function ansatz @xmath85 . to simplify the notations we avoid to use the dependence on the atomic positions @xmath62 .",
    "we assume that the ground state energy @xmath220 is non degenerate and all the eigenvalues @xmath221 , namely the spectrum is bounded and @xmath222 , as well as the maximum gap @xmath223 , grows at most linearly with the number @xmath11 of electrons .",
    "these assumptions are commonly satisfied by physical hamiltonians of interacting fermions .    within these assumptions",
    ", we will see that @xmath224 is an approximation for @xmath225 better than @xmath226 as long as the temperature @xmath3 is larger than a crossover temperature @xmath227 where @xmath228 remains finite for @xmath229 .",
    "as mentioned , we assume to know a complete orthonormal set @xmath230 of eigenstates of the hamiltonian @xmath82 that operates in a @xmath16-dimensional hilbert space .",
    "this implies that at a given temperature @xmath3 the exact partition function is : @xmath231 whereas the bo partition function is : @xmath232 where @xmath233 and the approximate partition function @xmath67 is given in eq.([defzq ] ) .",
    "we remind that we have already proven , using the convexity of the exponential function , that the relation : @xmath234 holds for every @xmath3 , and obviously @xmath235 .    in order to identify the more accurate approximate partition function , namely the one with the larger bound for @xmath225 we consider the ratio between the @xmath67 and @xmath218 : @xmath236 since @xmath224 is essentially a classical partition function over @xmath36 variables , the equipartition theorem immediately implies that : @xmath237 thus the bo approximation is better at low enough temperature , and , our low temperature free energy @xmath238 is expected to be a very bad approximation of the quantum free energy especially when @xmath36 is very large , just because classical and quantum free energy differ substantially at very low temperatures .",
    "the above consideration could lead to the disappointing conclusion that @xmath239 , namely @xmath240 , only for very high temperatures .",
    "however we can easily find a lower bound for @xmath241 by using that the spectrum is bounded , as assumed at the beginning of this appendix :    @xmath242    when the above bound is larger than one , @xmath241 is certainly larger than one , implying @xmath243 .",
    "this occurs for @xmath244 , where @xmath228 is easily determined by @xmath245 .",
    "hence in the thermodynamic limit there exists a finite crossover temperature @xmath81 , as @xmath246 remains finite for @xmath229 , according to our assumptions .",
    "we consider the space @xmath247 of normalized slater determinants in a finite dimensional hilbert space @xmath248 where fermions can occupy @xmath59 different one particle states , denoted by conventional creation operators @xmath249 .",
    "a slater determinant with @xmath11 electrons can be formally written in second quantization notations by means of @xmath250 real numbers @xmath251 : @xmath252 however all the variables of the matrix @xmath253 are highly redundant because , as well known , the slater determinant after the linear transformations @xmath254 is multiplied by a constant @xmath255 , where@xmath256 is an arbitrary @xmath257 matrix and @xmath258 its determinant .",
    "it is clear that , in order to define a slater determinant with unit norm we can consider one constraint latexmath:[$ \\langle \\psi",
    "| \\psi \\rangle =     the @xmath250 matrix @xmath253 , amounting therefore to @xmath260 independent real variables . by the above discussion , the wavefunction @xmath261 is left invariant for all matrix transformation @xmath262 with @xmath263 , defining @xmath264 independent variables for @xmath256 .",
    "thus , it follows that @xmath265 can be parametrized by @xmath266 independent real variables . in a more rigourous mathematical formalism , by neglecting an immaterial overall sign @xmath267 in the definition of @xmath253 , the space @xmath247 represents the coset space @xmath268 , where @xmath268 is the irreducible symmetric riemannian space @xmath269.@xcite we remind here that @xmath270 denotes the group of generic orthogonal matrices , whereas @xmath271 represents the group of orthogonal matrices with determinant one .",
    "similarly @xmath272 represents the group of block diagonal matrices with @xmath257 and @xmath273 blocks , where each block is in turn an orthogonal matrix .",
    "also the symbol @xmath274 indicates that the determinant of this block diagonal matrix ( the products of the determinant of each block , equal to @xmath275 as for any orthogonal matrix ) has to be @xmath276 .",
    "this space @xmath247 is compact ( all the @xmath277 independent variables represent essentially angles of unit vectors in @xmath59 dimensional space ) and there exist a unique ( up to a constant ) measure @xmath278 such that @xmath279 for all @xmath280 where @xmath281 is the group of @xmath282 orthogonal matrices with unit determinant@xcite , namely @xmath283 .",
    "an orthogonal matrix @xmath107 , acts on @xmath284 in an obvious way , namely @xmath285 in eq.([slater ] ) .",
    "the space @xmath247 can be therefore represented by an irreducible symmetric riemannian space . using a matrix @xmath286 we have essentially @xmath59 orthonormal directions ( e.g. the raws of the matrix ) , and the first @xmath11 spans all possible slater determinants in the space @xmath287 . for the previous discussion",
    "this slater determinant will be left unchanged ( up to a sign ) if we multiply the matrix @xmath107 for an arbitrary element of the @xmath288 unitary group , and therefore @xmath287 is equivalent to the space @xmath289 .    as a further proof that @xmath247 is equivalent to @xmath290 it is also easy to verify that the dimension of this space space is exactly @xmath291 .",
    "the dimension of an orthogonal matrix of dimension @xmath16 is @xmath292 , and therefore the dimension of the coset space @xmath293 is @xmath294    in order to represent the irreducible space @xmath290 for @xmath295 , with @xmath291 variables , a possible choice is to define an unconstrained @xmath296 matrix @xmath13 and the corresponding unitary @xmath297 matrix @xmath298 : @xmath299 with the constraint that the positive definite matrix @xmath300 has all eigenvalues bounded by one , namely @xmath301 .",
    "thus we explicitly see that the space is compact . as mentioned before we can identify a wavefunction @xmath302 with the first @xmath11 raws of this unitary matrix @xmath298 , up to a sign ,",
    "so that the orbitals of the determinant are : @xmath303 a measure @xmath304 of the coset ( reducible ) riemann space @xmath305 is said to be an invariant measure when it remains invariant under all unitary transformations @xmath306 , namely @xmath307 .",
    "an invariant measure represented by the matrix @xmath13 is given by : @xmath308 where @xmath182 is an appropriate normalization constant , and @xmath309 is the invariant measure in @xmath310.@xcite although explicit formulas are known for the invariant measure , they look a bit complicated to be implemented in practice .",
    "we are confident that a very convenient expression of the invariant measure is possible in terms of the eigenvalues of @xmath300 , which should amount to only @xmath311 operations .",
    "this would lead immediately to a computationally affordable extension of our method to dft or mean - field type of ansatz .",
    "46ifxundefined [ 1 ] ifx#1 ifnum [ 1 ] # 1firstoftwo secondoftwo ifx [ 1 ] # 1firstoftwo secondoftwo `` `` # 1''''@noop [ 0]secondoftwosanitize@url [ 0 ]",
    " + 12$12  & 12#1212_12%12@startlink[1]@endlink[0]@bib@innerbibempty @noop * * ,   ( ) link:\\doibase 10.1103/physrev.137.a1441 [ * * , ( ) ] @noop * * ,   ( ) @noop * * ,   ( ) @noop _ _ ,   ed . ,  edited by  and  ( ,  ,  ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) in @noop _ _",
    "( ,  )  pp .   @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * , ( ) @noop * * ,   ( ) @noop * * , ( ) link:\\doibase 10.1063/1.437734 [ * * ,   ( ) ] @noop * * ,   ( ) link:\\doibase 10.1063/1.466389 [ * * , ( ) ] link:\\doibase 10.1016/0009 - 2614(93)80015-h [ * * ,   ( ) ] link:\\doibase 10.1016/0009 - 2614(91)90186-d [ * * ,   ( ) ] link:\\doibase    10.1103/revmodphys.66.917 [ * * ,   ( ) ] @noop * * ,   ( ) link:\\doibase 10.1063/1.1604379 [ * * , ( ) ] @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) link:\\doibase 10.1063/1.2746035 [ * * ,   ( ) ] @noop * * ,   ( ) link:\\doibase 10.1063/1.478034 [ * * ,   ( ) ] link:\\doibase 10.1063/1.3516208 [ * * , ( ) ] link:\\doibase 10.1103/physrevlett.100.114501 [ * * ,   ( ) ] @noop _ _ ,  methods of solution and applications  ( ,  ) link:\\doibase 10.1103/physrevlett.55.2471 [ * * ,   ( ) ] @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) link:\\doibase 10.1103/revmodphys.62.251 [ * * ,   ( ) ] @noop * * ,   ( ) @noop @noop * * ,   ( ) @noop `` , ''  ,   ( )"
  ],
  "abstract_text": [
    "<S> we introduce a general technique to compute finite temperature electronic properties by a novel covariant formulation of the electronic partition function . by using a rigorous variational upper bound to the free energy we are led to the evaluation of a partition function that can be computed stochastically by sampling electronic wave functions and atomic positions ( assumed classical ) . in order to achieve this target </S>",
    "<S> we show that it is extremely important to consider the non trivial geometry of the space defined by the wave function ansatz . </S>",
    "<S> the method can be extended to any technique capable to provide an energy value over a given wave function ansatz depending on several variational parameters and atomic positions . </S>",
    "<S> in particular we can take into account electronic correlation , by using the standard variational quantum monte carlo method , that has been so far limited to zero temperature ground state properties . </S>",
    "<S> we show that our approximation reduces correctly to the standard born - oppenheimer ( bo ) one at zero temperature and to the correct high temperature limit . at large enough temperatures </S>",
    "<S> this method allows to improve the bo , providing lower values of the electronic free energy , because within this method it is possible to take into account the electron entropy . </S>",
    "<S> we test this new method on the simple hydrogen molecule , where at low temperature we recover the correct bo low temperature limit . </S>",
    "<S> moreover , we show that the dissociation of the molecule is possible at a temperature much smaller than the bo prediction . several extension of the proposed technique </S>",
    "<S> are also discussed , as for instance the calculation of critical ( magnetic , superconducting ) temperatures , or transition rates in chemical reactions . </S>"
  ]
}