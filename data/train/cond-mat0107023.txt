{
  "article_text": [
    "as a typical massive system , image restoration based on the markov random field ( mrf ) model has been investigated by statistical mechanical technique of disordered spin systems @xcite . among these results , statistical mechanical analysis succeeded in evaluating measure of successfulness for image restoration and made their hyper - parameter dependence clear @xcite .",
    "however , all of those researches were restricted to studies of static properties of image restoration . in the context of bayesian statistical approach",
    ", we usually use the markov chain monte carlo ( mcmc ) method to obtain _ maximum a posteriori _ ( map ) estimate by simulated annealing @xcite , or to calculate expectations over posterior distribution for _ maximum posterior marginal _ ( mpm ) estimation @xcite . in the recent study by nishimori and wong @xcite",
    ", they introduced an infinite range mean - field version of the mrf model and calculated the overlap between the original image and restored one analytically .",
    "however , they did not investigate the dynamical process of image restoration , that is to say , the process of the mcmc method by glauber dynamics to obtain the mpm estimate .",
    "although it is worth while to investigate such dynamical processes in image restoration , relatively little progress has been made in the theoretical understanding of them .",
    "recently , inoue and carlucci @xcite investigated dynamical properties of gray - scale image restoration using the mean - field q - ising spin glass model analytically .",
    "they found that the mpm estimate gets worse than the degraded image when one fails to set the hyper - parameters appropriately .",
    "therefore , it is important to study how we should infer the optimal hyper - parameters . as an approach to estimate the optimal hyper - parameters , _ maximum marginal likelihood _ (",
    "mml ) method has been used by many authors in practical situations @xcite .",
    "if one maximizes the marginal likelihood by gradient descent , boltzmann machine - type learning equations are obtained and these equations contain expectations over both posterior and prior distributions . in order to carry out those expectations , we usually use the mcmc method . however , it is hard to evaluate the performance of the mml estimation due to difficulties to simulate the thermo - dynamically equilibrium state within reliable precision .",
    "therefore , we need some analytical and rigorous studies on the hyper - parameter estimation . obviously , the learning process of the hyper - parameter estimation and the stochastic process of the mcmc method as _",
    "dynamics_. from a view point of statistical mechanics of spin systems , the process of the hyper - parameter estimation is regarded as a dynamics of spin system in which coupling constant and field strength are time dependent variables .",
    "then , time dependence of these variables is determined by the algorithm we choose to maximize the marginal likelihood . as far as we know ,",
    "no studies have ever tried to investigate those dynamical properties analytically . in this paper , we investigate dynamical properties of image restoration including hyper - parameter estimation by using statistical mechanical technique .",
    "this paper is organized as follows . in the next section , according to nishimori and wong @xcite , we explain statistical mechanical formulation of image restoration in the context of the mpm estimation .    in sec .",
    "[ sec3 ] , we derive differential equations with respect to macroscopic observables of the infinite range mean - field mrf model from microscopic master equation . by solving these differential equations",
    ", we discuss relaxation process of image restoration . in sec .",
    "[ sec4 ] , marginal likelihood as a function of hyper - parameters is calculated by replica method .",
    "we also derive boltzmann machine - type learning equations to maximize the marginal likelihood by gradient descent .",
    "flows in hyper - parameter space are obtained by analyzing the learning equations . in the same section ,",
    "we investigate the performance of em ( expectation and maximization ) algorithm @xcite which is widely used to estimate hyper - parameters from incomplete data sets .",
    "it is well known that em algorithm shows faster convergence at the beginning of the algorithm than some other algorithm does .",
    "however , there is no study to make this property clear by using some solvable models . in this section",
    ", we compare the performance of em algorithm with that of gradient descent explicitly .",
    "the final section is devoted to summary .",
    "in this section , we explain how we formulate image restoration as a problem of disordered spin system . according to nishimori and wong @xcite",
    ", we consider black and while image .",
    "then , an original image is denoted by @xmath0-dimensional vector @xmath1 and each pixel @xmath2 takes @xmath3 .",
    "these pixels are located on an arbitrary lattice in two dimension . in order to treat image restoration by statistical mechanics of disordered spin systems",
    ", we should assume that the original image is given by _",
    "a priori _ boltzmann - gibbs distribution @xmath4 where @xmath5 is carried out for all nearest neighboring pixels .",
    "thus , we use a snapshot of the mcmc simulation for the ferromagnetic ising model as an original image .",
    "@xmath6 appearing in the argument of the exponential ( [ ferro ] ) corresponds to temperature .",
    "we obtain pictures of all black or all white when we set @xmath7 , while we obtain random noise pictures in the limit of @xmath8 . a particular original image @xmath9 is degraded to a particular damaged picture @xmath10 by noise channel represented by the following conditional probability @xmath11 where sum @xmath12 is carried out for all pixels and we assumed that each pixel is degraded independently .",
    "@xmath13 represents a noise level of the channel because the above expression is rewritten as @xmath14 with @xmath15 for all pixels independently .",
    "therefore , this kind of noise is referred to as _ binary symmetric channel _ ( bsc ) .",
    "the bsc is easily extended to the _ gaussian channel _ ( gc ) as follows .",
    "@xmath16 if we replace @xmath17 appearing in eq .",
    "( [ gauc1 ] ) by @xmath18 with @xmath19 , the bsc ( eq . ( [ noisebsc ] ) ) is recovered .",
    "we should notice that a sum @xmath20 for an arbitrary function @xmath21 is calculated in terms of @xmath22 as @xmath23 where we defined @xmath24 .",
    "then , bayes theorem gives the posterior distribution @xmath25 where @xmath26 and @xmath27 are hyper - parameters and we introduced models of the prior ( eq .",
    "( [ ferro ] ) ) and the likelihood ( eq .",
    "( [ noisebsc ] ) ) as @xmath28 respectively .",
    "a configuration @xmath29 denotes an estimate of a particular original image @xmath9 . @xmath30 and @xmath31 in eq .",
    "( [ priandlike ] ) are normalization constants given by @xmath32 it is important for us to bear in mind that @xmath31 is independent of @xmath33 for both the bsc and the gc . actually , @xmath31 leads to @xmath34 for the bsc and @xmath35 for the gc . in the context of map estimation ,",
    "we choose the estimate @xmath33 as a grand state of the following hamiltonian ( cost function ) @xmath36 in order to obtain the grand state , we usually use simulated annealing @xcite or mean field annealing @xcite . on the other hand , in the context of mpm estimation , we first calculate the marginal distribution around a single pixel @xmath37 : @xmath38 and we choose the sign of the difference between @xmath39 and @xmath40 as an estimate of the @xmath41-th pixel @xmath42 as @xmath43 in this expression , we defined @xmath44 as an average of the @xmath41-th pixel @xmath37 over the posterior distribution ( [ post00 ] ) and this is written explicitly as @xmath45 this corresponds to a local magnetization of the spin system that is described by the hamiltonian @xmath46 at temperature @xmath47 .",
    "thus , in order to investigate properties of the mpm estimation for image restoration , we should study the random field ising model described by @xmath46 .",
    "then , we are interested in the quantity : @xmath48 which means the averaged overlap between an arbitrary original pixel @xmath2 and the mpm estimate @xmath49 . apparently , the best restoration of the original image is achieved when the overlap @xmath50 is as close to @xmath51 as possible . for this averaged overlap @xmath52 , the next inequality holds @xcite .",
    "@xmath53 this inequality means that the averaged overlap @xmath50 takes its maximum when one sets the hyper - parameters to their true values , namely , @xmath54 and @xmath55 . however , it is impossible to derive the hyper - parameter dependence of the overlap around its optimal value @xmath56 from the above inequality . to investigate this dependence , nishimori and wong @xcite introduced a mean - field version of the mrf model and calculated the overlap as a function of @xmath26 and @xmath27 .",
    "the mean - field model is rather an artificial model in which every pixel is connected to the others , however , this model is very useful to discuss the behavior of macroscopic quantities of the system , like the overlap @xmath50 . using replica method @xcite , one obtains saddle point equations @xmath57 where we defined gaussian integral measure by @xmath58 .",
    "equation ( [ m0 ] ) determines macroscopic properties of the original image given by the hamiltonian @xmath59 at temperature @xmath6 . from statistical mechanical point of view",
    ", @xmath60 corresponds to magnetization of the mean - field ferro - magnetic ising model . for a given @xmath61 , one obtains @xmath60 by solving eq .",
    "( [ m0 ] ) . substituting @xmath61 , @xmath60 and noise parameters @xmath62 ( a center of gaussian ) and @xmath63 ( a standard deviation ) into eq .",
    "( [ m ] ) , one obtains magnetization @xmath64 for the restored image system @xmath33 as a function of @xmath65 and @xmath27 .",
    "then , one substitutes @xmath66 into the expression of @xmath50 , and finds hyper - parameter dependence of the overlap explicitly . in fig .",
    "[ fig1 ] , we plot the overlap @xmath50 as a function of @xmath67 .",
    "we set @xmath68 ( @xmath69 ) and temperature of the original image is chosen as @xmath70 .",
    "the overlap for the two cases of the field @xmath27 , namely , @xmath71 ( a ) and @xmath72 ( b ) are shown .",
    "we should notice that the map estimate is obtained in the limit of @xmath73 keeping the ratio @xmath74 constant .",
    "therefore , the overlap for the map estimate depends on the ratio @xmath74 and takes its maximum when we set @xmath75 ( see fig .",
    "[ fig1 ] ( a ) ) . from this figure",
    ", we see that the overlap takes its maximum at @xmath76 and @xmath77 . in the next section ,",
    "we focus our attention on dynamics of the mpm estimation .",
    "in the previous section , we showed the performance of the mpm estimation .",
    "however , in those calculations , we assumed that the system already reached the equilibrium state .",
    "in other words , each state @xmath33 obeys the boltzmann - gibbs distribution @xmath78 .",
    "when we need to generate the distribution to calculate the mpm estimate @xmath79 , we often use the mcmc method and simulate the equilibrium states on computer .",
    "therefore , it is important to study how the system relaxes to its equilibrium state and grasp the behavior of time evolutionary observables analytically . as far as we know , there is no research to deal with dynamics of image restoration including hyper - parameter estimation analytically . in this section , for the infinite range mean - field mrf model",
    ", we derive differential equations with respect to macroscopic order parameters of the restored image system from microscopic master equation .",
    "first of all , we should remember that a transition rate @xmath80 from @xmath81 to @xmath82 leads to @xmath83 \\right],\\,\\,\\,\\,\\,\\ , h_{k}(\\{\\sigma\\ } ) =    \\frac{j}{n}\\sum_{j}\\sigma_{j}+h\\tau_{k}\\end{aligned}\\ ] ] in the context of the glauber dynamics of the mcmc method .",
    "it is important for us to bear in mind that hamiltonian @xmath46 of the system is rewritten in terms of @xmath84 as @xmath85 where we rescaled the coupling @xmath26 as @xmath86 to take a proper thermo - dynamic limit ( hamiltonian should be of order @xmath0 ) .",
    "then , probability @xmath87 that the system visits a state @xmath33 at time @xmath88 obeys the master equation @xmath89 \\label{dpdt}\\end{aligned}\\ ] ] where we defined single spin flip operator @xmath90 by @xmath91 distribution @xmath92 , which is probability that the system has macroscopic order parameters @xmath93 at time @xmath88 , is written in terms of the distribution @xmath87 of the microscopic state @xmath33 as @xmath94 where @xmath95 is a delta function . taking a derivative of @xmath92 with respect to @xmath88 and substituting eq .",
    "( [ dpdt ] ) into this expression and making a taylor expansion in powers of @xmath96 and @xmath97 ( so - called _ kramers - moyal expansion _ ) , we obtain @xmath98 thus , we derived the time dependent distribution of macroscopic quantities from the microscopic master equation eq .",
    "( [ dpdt ] ) .",
    "finally , we construct differential equations with respect to the macroscopic quantities @xmath64 and @xmath99 . substituting a form of distribution @xmath100 into eq .",
    "( [ dpdt2 ] ) and calculating some integrals , we obtain @xmath101 these two equations describe a relaxation of the system to the equilibrium state .",
    "we should notice that order parameter @xmath99 is a slave variable in the sense that the order parameter @xmath64 relaxes independently , whereas the relaxation of @xmath99 depends on @xmath64 .",
    "therefore , the behavior of @xmath99 is completely determined by @xmath64 . for this reason , from now on , we disregard eq .",
    "( [ dadt ] ) .",
    "it is easy to see that in the limit of @xmath102 and @xmath103 , the saddle point equation ( [ m ] ) is recovered .",
    "as the overlap @xmath50 is written in terms of @xmath64 [ see eq .",
    "( [ m ] ) ] , time evolution of the overlap is obtained by substituting the time dependence of the magnetization @xmath104 into the expression of @xmath50 . using the same technique as the procedure to derive the differential equation with respect to @xmath64 ,",
    "the differential equation for the magnetization @xmath105 of the prior system @xmath106 is obtained as @xmath107 although in these equations we regard the hyper - parameters @xmath26 and @xmath27 as constant variables , one should treat them as time dependent parameters , that is , @xmath108 and @xmath109 from a view point of hyper - parameter estimation . of course , details of the time dependence of @xmath108 and @xmath109 depend on a particular algorithm of hyper - parameter estimation . in the next section ,",
    "we investigate properties of hyper - parameter estimation as dynamical process of coupling constant @xmath108 and field strength @xmath109 .",
    "in the previous two sections , we investigated both static and dynamical properties of image restoration . from those results",
    ", we obtained hyper - parameter dependence of the overlap explicitly .",
    "moreover , for a particular constant hyper - parameter set @xmath110 , we derived the differential equations which describe the relaxation of the system .",
    "as one of the authors reported in @xcite , if one fails to set the hyper - parameters appropriately , the restored image gets worse than the degraded image . in practical situations",
    ", we do not know the optimal value of the hyper - parameters before we carry out the mcmc simulations .",
    "therefore , we need to determine the optimal value by using only information about the degraded image @xmath111 . of course , it is possible for us to construct some robust algorithms for hyper - parameter tuning and several authors reported such algorithms based on _ selective freezing _",
    "@xcite or _ quantum fluctuation _ @xcite .",
    "however , if one seeks the optimal restoration , hyper - parameter estimation becomes a very important problem .",
    "about ten years ago , iba @xcite studied the performance of the mml method with the assistance of the mcmc simulations for the same problem as ours .",
    "however , as he mentioned in his paper , the results are not enough to make its performance clear due to the difficulties of simulating the equilibrium state within reliable precision . with this fact in mind , in this section ,",
    "we calculate marginal likelihood as a function of hyper - parameters analytically . from the marginal likelihood",
    ", we derive boltzmann machine - type learning equations and investigate their behavior quantitatively .      in statistics ,",
    "maximum marginal likelihood ( mml ) method is used to infer hyper - parameters appearing in the posterior distribution @xcite . in the context of image restoration , marginal likelihood ( logarithm of marginal likelihood )",
    "is given by @xmath112 where @xmath30 and @xmath31 are given by eq .",
    "( [ normalconsts ] )",
    ". we should remember that @xmath31 is independent of @xmath33 for both cases of the bsc and the gc .",
    "usually , we attempt to maximize the marginal likelihood by using gradient descent with respect to @xmath26 and @xmath27 .",
    "this result leads to the following boltzmann machine - type learning equations @xmath113 where @xmath114 and @xmath115 are relaxation times .",
    "thus , by solving these two equations , we maximize the marginal likelihood @xmath116 and obtain the values of hyper - parameters as a fixed point of the equations .",
    "then , we should notice that these two equations contain expectations of the quantities @xmath117 and @xmath118 over the posterior and the prior distributions .",
    "therefore , when we solve eqs .",
    "( [ djdt ] ) , ( [ dhdt ] ) numerically , we should calculate these expectations at each time step of the euler method .",
    "iba @xcite carried out the mcmc method to calculate the expectations and evaluated time dependence of the hyper - parameters @xmath26 and @xmath27 numerically . however , the accuracy of his computer simulation is not reliable because the time to simulate the equilibrium state is not enough .",
    "accordingly , it is worth while to investigate the performance of the mml method analytically using the solvable model . in this subsection",
    ", we use the infinite range mean - field mrf model and solve the learning equations ( [ djdt]),([dhdt ] ) exactly . as our interest is averaged performance of the mml method , we should calculate the averaged marginal likelihood : @xmath119_{\\{\\xi,\\tau\\ } } & = &     \\left [ { \\log}\\sum_{\\sigma}{\\rm e}^{\\frac{j}{n}\\sum_{ij } \\sigma_{i}\\sigma_{j } + h\\sum_{i}\\tau_{i}\\sigma_{i } } \\right]_{\\{\\xi,\\tau\\ } }   - \\left [ { \\log}\\sum_{\\sigma } { \\rm e}^{\\frac{j}{n}\\sum_{ij}\\sigma_{i } \\sigma_{j } } \\right]_{\\{\\xi,\\tau\\ } } \\nonumber \\\\ \\mbox { } & - &     \\left [ { \\log}z_{l } \\right]_{\\{\\xi,\\tau\\ } } \\label{marginal - like}\\end{aligned}\\ ] ] where the bracket @xmath120_{\\{\\xi,\\tau\\}}$ ] means the average over the distribution @xmath121 and the sum @xmath5 should be carried out for all pairs of pixels .",
    "we should keep in mind that we rescaled the coupling constant as @xmath86 to make the averaged marginal likelihood ( difference of free energy ) of order @xmath0 . in general , it is hard to carry out this kind of average , namely , @xmath122_{\\{\\xi,\\tau\\}}$ ] .",
    "then , we replace the average with an average of the @xmath123-th moment of @xmath124 , that is , @xmath125 by using @xmath126_{\\{\\xi,\\tau\\ } } & = &   \\displaystyle{\\lim_{n\\rightarrow 0 } } \\frac{[z^{n}]_{\\{\\xi,\\tau\\}}-1}{n}.\\end{aligned}\\ ] ] this is refereed to as _ replica method _ @xcite . by using the replica method",
    ", we obtain the averaged marginal likelihood per pixel as @xmath127_{\\{\\xi,\\tau\\ } } } { n } & = &   -\\frac{j}{2}m^{2}+\\frac{\\sum_{\\xi } { \\rm e}^{\\beta_{s}m_{0}\\xi } } { 2{\\cosh}(\\beta_{s}m_{0 } ) } \\int_{-\\infty}^{\\infty } dx \\,{\\log}\\,2{\\cosh } ( jm+h\\tau x+h\\tau_{0 } \\xi )   \\nonumber \\\\ \\mbox { } & + & \\frac{j}{2}m_{1}^{2 } - { \\log}\\ , 2{\\cosh}(m_{1}j)+\\frac{\\tau_{0}}{2\\tau^{2 } } -\\frac{\\tau^{2}h^{2}}{2}\\,\\equiv\\ , -k(j , h)\\end{aligned}\\ ] ] where @xmath64 and @xmath105 are magnetizations of the spin systems described by the posterior and the prior , respectively .",
    "it should be noticed that as we used the gc ( eqs .",
    "( [ gauc1 ] ) , ( [ gauc2 ] ) ) , the average @xmath128_{\\{\\xi,\\tau\\}}$ ] simply led to @xmath129 ( see eq .",
    "( [ gauc3 ] ) ) .    in fig .",
    "[ fig2 ] , we plot the averaged marginal likelihood as a function of @xmath26 and @xmath27 . in this figure , we see that the averaged marginal likelihood takes its maximum when we choose the hyper - parameters @xmath110 so as to be identical to their true values @xmath130 ( we set @xmath131 ) .",
    "this fact is easily checked by the following inequality @xcite @xmath132_{\\{\\xi,\\tau\\ } } \\ } - \\{-[k(j , h : \\{\\xi,\\tau\\})]_{\\{\\xi,\\tau\\ } } \\ }   \\nonumber \\\\ \\mbox { } & = &   \\sum_{\\xi,\\tau } p_{\\beta_{\\tau}}(\\{\\tau\\}|\\{\\xi\\ } ) p_{\\beta_{s}}(\\{\\xi\\ } ) { \\log}\\sum_{\\sigma}p_{\\beta_{\\tau}}(\\{\\tau\\}|\\{\\sigma\\ } ) p_{\\beta_{s}}(\\{\\sigma\\ } )   \\nonumber \\\\",
    "\\mbox { } & - &   \\sum_{\\xi,\\tau } p_{\\beta_{\\tau}}(\\{\\tau\\}|\\{\\xi\\ } ) p_{\\beta_{s}}(\\{\\xi\\ } ) { \\log}\\sum_{\\sigma}p_{h}(\\{\\tau\\}|\\{\\sigma\\ } ) p_{j}(\\{\\sigma\\ } ) \\nonumber \\\\ \\mbox { } & = &    \\sum_{\\tau } p_{\\beta_{s},\\beta_{\\tau}}(\\{\\tau\\ } ) { \\log}(p_{\\beta_{s},\\beta_{\\tau}}(\\{\\tau\\})/ p_{j , h}(\\{\\tau\\ } ) ) \\geq 0\\end{aligned}\\ ] ] where we used non - negativity of _ kullback - libeler information _ and we defined @xmath133 @xmath134 @xmath135 thus , we confirm that our mean - field model is not against this general inequality .",
    "we should mentioned that static properties of the hyper - parameter estimation was investigated by several authors using the generalized gaussian model @xcite , mean - field approximation @xcite and cluster variation method @xcite .",
    "for the marginal likelihood ( [ marginal - like ] ) , averaged learning equations with respect to @xmath26 and @xmath27 are obtained by gradient descent : @xmath136_{\\{\\xi,\\tau\\}},\\,\\,\\,\\,\\ , c_{h}\\frac{\\partial h}{\\partial t } =    -\\left [ \\frac{\\partial k(j , h : \\{\\xi,\\tau\\})}{\\partial h } \\right]_{\\{\\xi,\\tau\\}}.\\end{aligned}\\ ] ] the right hand sides of the above equations are also evaluated by the replica method .",
    "after some algebra , we obtain @xmath137 where we should remember that @xmath64 and @xmath105 obey the differential equations @xmath138 by solving these coupled equations , we obtain time dependences of the hyper - parameters @xmath139 and relaxation process of the systems , namely , @xmath140 . in this paper , we fix the relaxation times as @xmath141 .    in fig .",
    "[ fig3 ] , we plot time dependences of the hyper - parameters @xmath142 and order parameters @xmath143 . from this figure",
    ", we see that the final state of the hyper - parameters is optimal , namely , @xmath144 and this convergent point is independent of the initial conditions .",
    "time evolutions of the overlap @xmath50 are also plotted in fig .",
    "[ fig4 ] ( upper figure ) .",
    "we find that the overlap @xmath50 converges to the best possible value in fig .",
    "[ fig1 ] . in fig .",
    "[ fig5 ] , we plot flows of hyper - parameter @xmath26-@xmath27 . from this figure , we find that each flow does not take the shortest path to the solution and goes a long way around the solution .      in the previous subsection",
    ", we investigated the process of the mml method by gradient decent as a dynamics . in this section ,",
    "we analyze the performance of _ em algorithm _ @xcite as another candidate to maximize the marginal likelihood .    in em",
    "algorithm , we first average the log - likelihood function @xmath145 over the time dependent posterior distribution @xmath146 this average is referred to as _ q - function_. as we are interested in the averaged behavior of the q - function , we need the following averaged q - function : @xmath147_{\\{\\xi,\\tau\\ } } \\nonumber \\\\ \\mbox { } & = &   j\\left [ \\frac{\\sum_{\\sigma } ( \\sum_{ij}\\sigma_{i}\\sigma_{j } ) { \\rm e}^{\\frac{j_{t}}{n}\\sum_{ij}\\sigma_{i}\\sigma_{j } + h_{t}\\sum_{i}\\tau_{i}\\sigma_{i } } } { \\sum_{\\sigma } { \\rm e}^{\\frac{j_{t}}{n}\\sum_{ij}\\sigma_{i}\\sigma_{j } + h_{t}\\sum_{i}\\tau_{i}\\sigma_{i } } } \\right]_{\\{\\xi,\\tau\\ } } \\nonumber \\\\ \\mbox { } & + & h \\left [ \\frac{\\sum_{\\sigma } ( \\sum_{i}\\tau_{i}\\sigma_{i } ) { \\rm e}^{\\frac{j_{t}}{n}\\sum_{ij}\\sigma_{i}\\sigma_{j } + h_{t}\\sum_{i}\\tau_{i}\\sigma_{i } } } { \\sum_{\\sigma } { \\rm e}^{\\frac{j_{t}}{n}\\sum_{ij}\\sigma_{i}\\sigma_{j } + h_{t}\\sum_{i}\\tau_{i}\\sigma_{i } } } \\right]_{\\{\\xi,\\tau\\ } } \\nonumber \\\\ \\mbox { } & - &   \\log \\sum_{\\sigma } { \\exp } \\left ( \\frac{j}{n}\\sum_{ij}\\sigma_{i}\\sigma_{j }",
    "\\right ) + \\frac{n\\tau_{0}^{2}}{2\\tau^{2 } } -\\frac{n\\tau^{2}h^{2}}{2 } \\label{qfunc}\\end{aligned}\\ ] ] where we divided the coupling constants @xmath26 and @xmath148 by @xmath0 to take a proper thermo - dynamic limit .",
    "then , em algorithm is summarized as follows .",
    "+ set initial values of the hyper - parameters @xmath149 , @xmath150 and @xmath151 .",
    "+ iterate the following e ( expectation ) and m ( maximization ) steps until an appropriate convergence condition is satisfied . *",
    "* e step : calculate @xmath152 . *",
    "* m step : update @xmath148 and @xmath153 by @xmath154 and @xmath155 .    for our infinite range mean - field mrf model , the averages @xmath120_{\\{\\xi,\\tau\\}}$ ] in eq .",
    "( [ qfunc ] ) are calculated by using the replica method and we obtain @xmath156 at the next time step , @xmath157 and @xmath158 are given by the conditions @xmath159 and @xmath160 .",
    "these two conditions lead to non - linear maps : @xmath161 }   \\label{emdj } \\\\",
    "h_{t+1 } & = &   \\frac{\\sum_{\\xi}{\\rm e}^{\\beta_{s}m_{0}\\xi } } { 2\\tau^{2}{\\cosh}(\\beta_{s}m_{0 } ) } \\int_{-\\infty}^{\\infty } dx\\,(\\tau x+\\tau_{0}\\xi ) { \\tanh } ( j_{t}m(t)+h_{t}\\tau x+h_{t}\\tau_{0}\\xi )   \\label{emdh}.\\end{aligned}\\ ] ] in the above non - linear maps , @xmath104 and @xmath162 are time dependent magnetizations for the systems described by the posterior @xmath163 and the the prior @xmath164 , respectively .",
    "by using mean - field treatment , we obtain non - linear maps with respect to @xmath104 and @xmath162 as @xmath165 by solving these non - linear maps eqs .",
    "( [ emdj])-([emdm1 ] ) , we obtain the time dependence of the hyper - parameters @xmath166 and the magnetizations @xmath167 .",
    "we plot the results in fig .",
    "[ fig4 ] ( lower figure ) , fig .",
    "[ fig5 ] and fig .",
    "[ fig6 ] . from these figures",
    ", we see that both the mml method by gradient descent and em algorithm obtain the optimal hyper - parameters @xmath168 , however , em algorithm shows faster convergence than the mml by gradient descent .",
    "in addition , the flows of em algorithm in the hyper - parameter space are shorter than those of the mml by gradient descent . from the posterior distribution appearing in the q - function ( [ qfunc ] )",
    ", we see that performance of em algorithm highly depends on the initial choice of the hyper - parameters @xmath149 and @xmath150 .",
    "therefore , for the systems which have lots of local minima , the final solution is sensitive to the initial condition on the hyper - parameters . however , for our model system ( the infinite range random field ising model ) , there is no local minima in the marginal likelihood function . as the result",
    ", the final state of em algorithm is independent of the initial conditions .",
    "in this paper , we investigated dynamical properties of image restoration by using statistical mechanics .",
    "we introduced an infinite range mean - field version of the mrf model and solved it analytically .",
    "we derived differential equations with respect to the macroscopic order parameters from the microscopic master equation .",
    "we also studied dynamics of hyper - parameter estimation in the context of the maximum marginal likelihood method by using gradient descent and em algorithm . for the mml method by gradient descent",
    ", boltzmann machine - type learning equations were evaluated analytically by the replica method . on the other hand",
    ", em algorithm led to non - linear maps and these maps were also evaluated analytically .",
    "we compared these two algorithms and found that for both algorithms , we obtain the optimal hyper - parameters .",
    "we also found that the speed of convergence for em algorithm is faster than that of the mml method by gradient descent .",
    "in addition , the paths to the solution in hyper - parameter space by em algorithm are shorter than those of the mml by gradient descent .",
    "thus , in this paper , we could compare two different methods to estimate hyper - parameters without any computer simulations .",
    "our analytical treatments are applicable to studies of performance for the other method including _ deterministic annealing em algorithm",
    ". moreover , besides image restoration , our approach is useful for the other problems , for example , learning by bayesian neural networks @xcite , time series predictions @xcite or density estimation problem @xcite .",
    "+   + we thank hidetoshi nishimori , masato okada , yukito iba and david saad for fruitful discussions .",
    "our special thanks are due to toshiyuki tanaka for useful discussions and comments .    9999 j. m. pryce and a. d. bruce , j. phys .",
    "a : math . gen . * 28 * 511 ( 1995 ) .",
    "h. nishimori and k. y. m. wong , phys .",
    "e * 60 * 132 ( 1999 ) .",
    "d. m. carlucci and j. inoue , phys .",
    "e * 60 * 2547 ( 1999 ) .",
    "j. inoue and d. m. carlucci , phys .",
    "e * 64 * 036121 ( 2001 ) .",
    "s. geman and d. geman , ieee trans . on pattern analysis and machine intelligence * 6 * 721 ( 1984 ) .",
    "j. marroquin , s. mitter and t. poggio , journal of the american statistical association * 82 * 76 ( 1989 ) .",
    "s. geman and d. e. mcclure , bull .",
    "inst . * 52 * 5 ( 1987 ) .",
    "a. p. dempster , n. m. laird and d. b. rubin , journal of the royal statistics , series b ( methodological ) * 39 * 1 ( 1977 ) .",
    "s. kirkpatrick , g. d. gellatt jr . and",
    "m. p. vecchi , science * 220 * 671 ( 1983 ) .",
    "d. geiger and f. girosi , ieee trans . on pattern analysis and machine intelligence",
    "* 13 * 401(1991 ) .",
    "d. sherrington and s. kirkpatrick , phys .",
    "lett . * 35 * 1792(1975 ) .",
    "y. iba , proceedings of the institute of statistical mathematics , ( in japanese ) , * 39 * 1 ( 1991 ) .",
    "k. y. m. wong and h. nishimori , phys .",
    "e * 62 * 179 ( 2000 ) .",
    "j. inoue , phys .",
    "e * 63 * 046114 ( 2001 ) .",
    "z. zhou , r. m. leahy and j. qi , ieee trans .",
    "image processing * 6 * 844 ( 1997 ) .",
    "y. iba , j. phys . a : math . and gen .",
    "* 32 * 3875 ( 1999 ) .",
    "k. tanaka and j. inoue , technical report of the institute of electronics , information and communication engineers , ( in japanese ) , * prmu2000 - 125 * 41 ( 2000 ) .",
    "k. tanaka , transactions of the japanese society for artificial intelligence * 16 * 246 ( 2001 ) .",
    "r. l. streit and t. e. luginbuhl , ieee trans . on neural networks",
    "* 5 * 764 ( 1994 ) .",
    "n. ueda and r. nakano , neural networks * 11 * 271 ( 1998 ) .",
    "d. j. c. mackay , _ bayesian methods for backpropagation networks _ , in _ models of neural networks iii _ , eds .",
    "e. domany , j. l. van hemmen and k. schulten , ( springer - verlag : berlin , 1996 ) .",
    "b. j. frey , _ graphical model for machine learning and digital communication _ , ( the mit press , 1998 )",
    ". t. matsumoto , y. nakajima , m. saito , j. sugi and h. hamagishi , to appear in ieee trans . on signal processing ( 2001 ) .",
    "n. barkai and h. sompolinsky , phys .",
    "e * 50 * 1766 ( 1994 ) ."
  ],
  "abstract_text": [
    "<S> dynamical properties of image restoration and hyper - parameter estimation are investigated by means of statistical mechanics . </S>",
    "<S> we introduce an exactly solvable model for image restoration and derive differential equations with respect to macroscopic quantities . from these equations , </S>",
    "<S> we evaluate relaxation processes of the system to the equilibrium state . </S>",
    "<S> our statistical mechanical approach also enable us to investigate the hyper - parameter estimation by means of maximization of marginal likelihood by using gradient decent and em algorithm from dynamical point of view .    </S>",
    "<S> = 14000    pacs numbers : 02.50.-r , 05.20.-y , 05.50.-q </S>"
  ]
}