{
  "article_text": [
    "in various types of musical performance , one component of the musical expression is conveyed in the short - term manipulation of tempo , with tempo modulation reflecting musical phrase structure @xcite .",
    "this has motivated various authors to construct automatic analyses of the arc - shaped tempo modulations in recorded musical performances , with or without score - derived information to supplement the analysis @xcite .",
    "( see also @xcite who fit piecewise linear arcs to rock and jazz data , applying similar techniques but to genres in which the underlying tempo is held more fixed . )",
    "machine understanding of tempo , including its variability , can be useful in live human - machine interaction @xcite .",
    "however most current online tempo - tracking systems converge to an estimate of the current tempo , modelling expressive variations as deviations rather than as components of an unfolding tempo expression . in this paper",
    "we work towards the understanding of tempo arcs in a real - time system , paving the way for automatic accompaniment systems which follow the expressive tempo modulation of players in a more natural way .",
    "we also consider tempo arcs within a probabilistic framework .",
    "previous authors have approached piecewise arc estimation using dynamic programming ( dp ) with cost functions based on squared error @xcite .",
    "these are useful and can provide efficient estimation , but by setting the problem in a probabilistic framework ( and providing the corresponding viterbi - like dp estimator ) , we gain some advantages : prior beliefs about the length and shape of arcs can be expressed coherently as prior distributions ; measurement noise is explicitly modelled ; and the goodness - of - fit of models is represented meaningfully as posterior probabilities , which allows for model comparison as well as integration with other workflow components which can make use of estimates annotated with probability values . note that while we describe a fully probabilistic model , for efficient inference we will develop a maximum a posteriori ( map ) estimator , which returns only the maximum probability parameter settings given the priors and the data .    in the following",
    "we will describe our model of arcs in time - series data , and develop an efficient map estimation technique based on least - squares optimisation and viterbi - like dp .",
    "the approach requires some kind of unsmoothed instantaneous tempo estimate as its input , which may come from a tempo tracker or from a simple measurement such as inter - onset interval ( ioi )",
    ". we will then discuss how the estimator can be used for immediate - future tempo prediction , and how it can be applied to multiple levels simultaneously .",
    "finally we will apply the technique to tempo data from three professional piano performances , and discuss what the analysis reflects in the performances .",
    "for our basic model , we consider tempo to evolve as a function of metrical position ( beat number ) @xmath0 in a musical piece as a series of connected arcs , where each arc s duration , curvature and slope are independently drawn from prior distributions ( to be described shortly ) .",
    "our model is deliberately simple , and agnostic of any score information that might be available .",
    "to sample from this model , we pick an initial tempo at the starting time , then define a single upwards tempo arc which starts from that point , and the tempo trajectory ( speeding up and then slowing down ) over a number of measures . any tempo data which may be measured during this interval is modelled as being drawn from the arc plus some amount of gaussian noise .",
    "once the ending breakpoint of this arc is reached , the next arc is sampled from the same priors , using the ending tempo as the new starting tempo .",
    "hence each tempo arc is conditionally independent of all previous observations once the starting tempo is determined , i.e.  once the previous arc s parameters are fixed .",
    "this assumption of conditional independence is slightly unrealistic , since it ignores long - range relationships between tempo arcs , but it accounts for the most important interactions and makes inference tractable .",
    "our basic model is also only single - level , assuming that a single arc contributes to the current tempo at any moment , rather than considering for example contributions from multiple timescales such as piece - level , movement - level , phrase - level and bar - level combined . in section [ sec : multiscale ] we will consider a simple multi - scale extension of our technique , which we will apply in our analysis of piano performance data .",
    "( for an alternative approach in which various components can be simultaneously active see @xcite . )      to fit a single arc shape to data , one can use standard quadratic regression , fitting a function of the form @xmath1 and minimising the @xmath2 prediction error over the supplied data for @xmath3 . in the bayesian context ,",
    "we wish to incorporate our prior beliefs about the regression parameters ( here @xmath4 , @xmath5 and @xmath6 ) , which is related to the optimisation concept of _ regularisation _ , the class of techniques which aims to prevent overfitting by favouring certain parameter settings .",
    "in fact , a gaussian prior on a regression parameter can be shown to be equivalent to the conventional @xmath2-norm regularisation of the parameters @xcite , summarised as : @xmath7 this equivalence is useful because it allows us to use common convex optimisation algorithms to perform the equivalent regularised least squares optimisation , and they will yield the map estimate for the probabilistic model .",
    "however , in this context a standard gaussian prior is not exactly what we require , since we are expecting upwards arcs and not troughs  we are expecting @xmath6 in equation [ eq : simplequad ] to be negative .",
    "a more appropriate choice of prior might be a negative log - gaussian distribution , which allows us to specify a `` centre of mass '' for the arc shapes ( expressed through the log - mean and log - standard - deviation parameters ) , yet better represents our expectation that tempo arcs will always have negative curvature , ( almost ) flat and extremely strongly curved arcs being equally rare .",
    "the unconventional choice of prior might seem to remove the equivalence of the map regression technique with standard regularised least squres . yet",
    "if we rewrite our function to be @xmath8 then our prior belief about this modified parameter @xmath6 becomes a gaussian , yielding a negative - log - gaussian in combination with our function .",
    "in addition , we will use a standard gaussian prior on @xmath5 .",
    "we could do the same for @xmath4 but instead we will use an improper uniform prior , for reasons which will be described in section [ sec : multi ] .",
    "therefore , our priors for equation [ eq : modquad ] will be gaussian priors on @xmath5 and @xmath6 , which can easily be converted to the equivalent @xmath2-regularisation terms for optimisation .",
    "the strength of the regularisation ( the value of the regularisation coefficient ) reflects the specificity of our priors versus our data  specifically , the regularisation parameter is given by the noise variance divided by the prior variance @xcite .",
    "again , we see how the probabilistic setting helps to ground our problem , connecting the strength of the regularisation directly to our prior beliefs about the model and the data rather than manually - tuned parameters .",
    "if a time - series is composed of multiple arcs and the breakpoints are known , then fitting multiple arcs is as simple as performing the above single - arc fit for each subsection of the time series ( as in figure  [ fig : toydatatwoarcs ] ) .",
    "additionally , one should take care of the arc s dependence upon its predecessor ( to enforce that they meet up ) , which is not shown in these plots . in our case",
    ", we want to estimate the breakpoint locations as well as the arc shapes between those breakpoints .",
    "this can be performed by iterating over all possible combinations of one breakpoint , two breakpoints , three (  ) for the dataset , and choosing the result with the lowest cost ( the highest posterior likelihood ) .",
    "the bayesian setting makes it possible to compare these different alternatives ( e.g. one single arc vs.  one arc for every datapoint ) without having to add arbitrary terms to counter overfitting ; instead , we specify a prior distribution over the arc durations , which in combination with the other priors and data likelihoods yields a map probability for any proposed set of arcs . in this paper",
    "we choose a log - normal prior distribution over arc durations .",
    "see figure [ fig : toydatatwoarcs ] for some examples of different sets of arcs fitting to a synthetic dataset , and the posterior ( log-)probabilities associated .    in order for only a single tempo value to exist at each breakpoint ( and",
    "not a discontinuous leap from one tempo to another ) , we fit each arc under the constraint that its starting value equals the ending value of the previous arc .",
    "this removes one degree of freedom from the function to be fit ( equation [ eq : modquad ] ) which otherwise has three free parameters .",
    "we implement this by constraining the value of @xmath4 in the optimisation so that the function evaluates to the predetermined value at the appropriate time - point .",
    "the least - squares optimisation therefore only operates on @xmath5 and @xmath6 .",
    "the number of possible combinations of arcs for even a small time - series ( such as figure [ fig : toydatatwoarcs ] ) grows quickly very large , and so it is impractical to iterate all combinations .",
    "this is where dynamic programming ( dp ) can help .",
    "here we describe our dp algorithm , which , like the well - known viterbi algorithm , maintains a record of the most likely route that leads to each of a set of possible states . rather than applying it to the states of a hidden markov model ,",
    "we apply it to the possibility that each incoming datum represents a breakpoint .",
    "assume that the first incoming datum is a breakpoint .",
    "( this assumption can be relaxed , in a similar way to the treatment of the final datum which we consider later . ) then , for each incoming datum ( @xmath9 , @xmath10 ) , we find what would be the most likely path _ if it were certainly _ a breakpoint .",
    "we do this by finding the most appropriate past datum ( @xmath11 , @xmath12 ) which could begin an arc to the current datum  where the appropriateness is judged from the map probability of said arc , combined with the map probability of the whole multiple - arc history that leads up to that past datum ( recursively defined ) .    with our lognormal prior on the arc lengths ( and with many common choices of prior )",
    ", the probability mass is concentrated at an expected time - scale , and very long arcs are highly improbable _ a priori_. hence in practice we truncate the search over potential previous arc points to some maximum limit @xmath13 ( i.e.  @xmath14 ) .    thus , for every incoming data point we perform no more than @xmath13 single - arc fits , then store the details of the chosen arc , the map probability so far , and a pointer back to the datapoint at the start of the chosen single arc . the simplest way to choose",
    "the overall map estimate is then to pick another definite breakpoint ( for example , the last datum if the performance has finished ) and backtrack from there to recover the map arc path .",
    "the time complexity of the algorithm depends strongly on that of the convex optimisation used to perform a single - arc fit .",
    "assume that the complexity of a single - arc fit is proportional to the number of data points @xmath15 included in the fit , where @xmath14 .",
    "then for each incoming data point a search is performed for one subset each of 2 , 3 , ",
    "k data points , which essentially yields an order @xmath16(@xmath17 ) process .",
    "for online processing this is manageable if @xmath13 is not too large .",
    "analysing a whole dataset of @xmath18 points then has time complexity @xmath16(@xmath19 ) .",
    "( compare this to the broadly similar complexity analysis of @xcite . )",
    "the space complexity is simply @xmath16(@xmath18 ) , or @xmath16(@xmath13 ) if the full arc history since the very beginning does not need to be stored .",
    "this is because a small fixed amount of data is stored per datapoint .",
    "as discussed , if we know the performance has finished then we can find the viterbi path leading to a breakpoint at the final data point received .",
    "however , we would also like to determine the most likely set of arcs in cases where the performance might not have finished ( e.g.  for real - time interactive systems ) , and thus where we do not wish to assert that the latest datum is a breakpoint .",
    "we wish to be able to estimate an arc which may still be in progress .",
    "if we can , this has a specific benefit of predicting the immediate future evolution of the tempo modulations ( until the end of the present arc ) , which may be particularly useful for real - time interaction .",
    "we can carry this out in our current approach as follows .",
    "since an arc s duration ( as well as the curve - fit ) affects its map probability , in the case where the latest arc may or may not be terminating we must iterate over the arc s possible durations and pick the most likely . to do this we choose a set of future time - points as candidate breakpoints , @xmath20  @xmath21 ( e.g.  an evenly - spaced tatum grid of @xmath22 future points )",
    ". then we supply these data to the viterbi update process exactly as is done with actual data , but with no associated @xmath23 values .",
    "these `` hypothetical '' viterbi updates will use these time - points to determine the arc - lengths being estimated , and in normalising the data subset , but will not include them in the arc - fitting process .",
    "it will therefore yield a map probability estimate for each of the time - points as if an arc extended from the real data as far as this hypothetical breakpoint . out of these possibilities ,",
    "the one with the highest map probability is the map estimate for an arc which includes the latest real datum and some portion of the hypothetical future points . (",
    "the hypothetical viterbi updates are not preserved : if more data comes in , it is appended to the viterbi storage corresponding only to the actual data . )",
    "the model we describe operates at one level , with expected arc durations given by the corresponding prior .",
    "our model is adaptable to any time - scale by simply adapting the prior .",
    "it does not however automatically lend itself to simultaneous consideration of multiple active timescales .",
    "multi - scale analysis can be carried out by analysing a dataset with one timescale , then analysing the residual at a second timescale .",
    "this residual - based decomposition has been used previously in the literature ( e.g.  @xcite ) ; it requires a strong hierarchical assumption that the arcs at the first timescale do not depend at all on those at the second timescale , while the second is subordinate to the first .",
    "we consider this to be unrealistic , since there may well be interactions between the different timescales on which a performer s expression evolves .",
    "however this assumption leads to a tractable analysis .",
    "note also that this approach to multi - scale estimation requires the first analysis to be completed ( so that the residual is known ) before the second scale can be analysed .",
    "some dp approach may be possible to enable both to be calculated online , but we have not developed that here .",
    "for the present work , the single - scale viterbi tracking is applicable and useful for online tracking , while multi - scale analysis is an offline process , which we will next apply to modelling of pre - recorded tempo data .",
    "we applied our analysis to an existing set of annotations of three performances of beethoven s _ moonlight sonata_. the annotations by elaine chew have previously been analysed by chew with reference to observations noted by jeanne bamberger @xcite .",
    "for each of three well - known performances of the piece  by daniel barenboim ( 1987 ) , maurizio pollini ( 1992 ) and artur schnabel ( 2009)the first 15 bars have been annotated with note onset times , which correspond to regular triplet eighth - note timings .",
    "we implemented the algorithm in python , using the ` scipy.optimize.fmin ` optimiser to solve individual regressions .",
    "source code is available .",
    "( note that this development implementation is not generally fast enough for real - time use . )",
    "instantaneous tempo was derived from these inter - onset intervals , then analysed using a two - pass version of our algorithm : first the data was analysed using an arc - duration prior centred on four bars ; then the residual was analysed using an arc - duration prior centred on one bar .",
    "this choice of timescales is a relatively generic choice which might reasonably be considered to reflect a performer s short - term and medium - term state ; however it might also be said to be a form of basic contextual information about the relevant timescales in the current piece . for the current study",
    ", we confine ourselves to priors with log - normal shapes , though an explicitly score - derived or corpus - derived prior could have a more tailored and perhaps multimodal shape .",
    "figure [ fig : manual_analyses ] shows a set of manual annotations of hierarchically embedded phrases , and figure [ fig : twoarcsthree ] shows the automatically computed results .",
    "the automatic analyses show some notable similarities with the manual one at the shorter time scale , and significant differences at the longer time scale .",
    "the difficulty of the longer time scale analysis may be explained by figure [ fig : moonlight_phrases ] , which shows one plausible set of phrase groupings for this excerpt ; the overlapping \\{5,5,7 } bar phrases do not fit easily into a four - bar duration framework .",
    "nevertheless , the longer time scale analysis ( centred on four bars ) highlights differences between the performances : pollini s performance appears to contain relatively little variation on this level , as the fit yields long and shallow arcs , with breakpoints near positions 48 , 96 and 168 ( structurally important positions ; 96 is where the key - change occurs ) .",
    "on the other hand , both barenboim and schnabel s tempo curves exhibit fairly deep and varied arcs .",
    "schnabel s performance exhibits the most dramatic variation in the first four bars until around measure 48 : this first four - bar section corresponds to the opening statement of the basic progression , before the melody enters in the fifth bar ( and the underlying progression repeats ) .",
    "bamberger described schnabel as performing them `` as if in one long breath '' ( quoted in @xcite ) , not quite reflected in our automatic analysis .    on the shorter time scale ,",
    "the analysis tends to group phrases into one - bar or two - bar arcs .",
    "aspects of the musical structure are reflected in the arcs observed .",
    "sections of the melody which lend themselves to two - bar phrasing ( e.g.  7296 ) are generally reflected in longer arcs crossing bar lines .",
    "conversely , in the region 96132 the change to the new key unfolds as each new chord enters at the start of a bar , and the tempo curves for all three performers reflect an expressive focus on this feature , with one - bar arcs which are more closely locked to the bar - lines than elsewhere .",
    "note that in this section schnabel matches pollini in exhibiting a long and shallow arc on the slow timescale , with all the expressive variation concentrated on the one - bar arcs .    over the excerpt generally ,",
    "the breakpoints for schnabel are further away from the barline than the others , as was observed in chew s manual analysis .",
    "we can quantify this by measuring the mean deviances of arc endpoints from the barlines in each performance .",
    "the resulting mean deviances confirm our observations ( table [ tbl : dev ] ) .",
    ".mean deviance from the barlines of the arc endpoints inferred for each performance , averaged over the short - timescale arcs in each case .",
    "[ cols=\"<,>\",options=\"header \" , ]     we have extended the plots slightly beyond the 180 annotated data points , to illustrate the immediate - future predictions made by the model .",
    "( this is done for both timescales , though only the longer timescale ( in red ) shows noticeable extended arcs . )",
    "all the performers , and especially schnabel , exhibit an acceleration towards the end of the annotated data , reflected in the predictions of an upward arc followed by a gradual slowing over the next bar .",
    "this type of prediction is plausible for such expressively - timed music .    to illustrate the effect that the prior parameters have upon the regression ,",
    "figure [ fig : twoarcsthreeb ] shows the same analysis as figure [ fig : twoarcsthree ] but with the standard deviation of the noise prior set at 4.0 rather than 3.0 .",
    "the increase in the assumed noise variance leads the algorithm to `` trust '' the data less and the prior slightly more ( cf .",
    "equation [ eq : equivalence ] ) . in our example , some of the breakpoints for the long - term arcs ( in red ) have changed , losing some detail , though most of the detail of the second - level analysis ( in blue ) is consistent .",
    "we have described a model with similarities to some previous piecewise - arc models of musical expression , but with a bayesian formulation which facilitates model comparison and the principled incorporation of prior beliefs .",
    "we have also described an efficient viterbi - like dynamic programming approach to estimation of the model from data .",
    "the approach provides scope to apply the model to real - time score - free performance tracking , including prediction of immediate future tempo modulation .",
    "source code for the algorithm ( in python ) is available .",
    "we have applied the model in a two - level analysis to data from expressive piano performance , illustrating the algorithm s capacity to operate at different time - scales , and to recover expressive arc information that corresponds with some musicological observations regarding phrasing and timing .",
    "further research would be needed to develop a model of multiple simultaneously - active levels of expression which can be applied online as with our single - level viterbi - like algorithm .",
    "similar arcs have been observed and analysed in loudness information extracted from performances @xcite .",
    "it would also be useful to combine loudness information with tempo information in this model ."
  ],
  "abstract_text": [
    "<S> in musical performances with expressive tempo modulation , the tempo variation can be modelled as a sequence of tempo arcs . </S>",
    "<S> previous authors have used this idea to estimate series of piecewise arc segments from data . in this paper </S>",
    "<S> we describe a probabilistic model for a time - series process of this nature , and use this to perform inference of single- and multi - level arc processes from data . </S>",
    "<S> we describe an efficient viterbi - like process for map inference of arcs . </S>",
    "<S> our approach is score - agnostic , and together with efficient inference allows for online analysis of performances including improvisations , and can predict immediate future tempo trajectories .    , </S>",
    "<S> expression , viterbi , time series </S>"
  ]
}