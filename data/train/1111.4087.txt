{
  "article_text": [
    "the main aim of this paper is to investigate the effectiveness of alternating direction implicit ( adi ) time discretization schemes in the numerical solution of three - dimensional time - dependent partial differential equations ( pdes ) arising in financial option valuation theory . as a prototype case we consider the heston ",
    "hull  white pde , but our conclusions concerning adi schemes extend to many other related three - dimensional models .",
    "consider the asset price process given by the system of stochastic differential equations ( sdes ) @xmath0 the random variables @xmath1 , @xmath2 , @xmath3 represent , respectively , the asset price , its variance and the interest rate at time @xmath4 .",
    "the parameters @xmath5 , @xmath6 , @xmath7 and @xmath8 , @xmath9 are given positive real constants and @xmath10 denotes a given deterministic , positive function of time , called the mean - reversion level .",
    "the @xmath11 , @xmath12 , @xmath13 are brownian motions under a risk - neutral measure with given correlation factors @xmath14 , @xmath15 , @xmath16 $ ] such that the pertinent correlation matrix is positive semidefinite",
    ".    the asset price model ( [ sde ] ) can be viewed as an extension of the popular heston stochastic volatility model ( heston ( 1993 ) ) where the interest rate is not constant but also follows a stochastic process , described here by the hull  white model ( hull & white ( 1990 ) ) .",
    "the function @xmath10 is chosen as to match the current term structure of interest rates .",
    "the hybrid heston ",
    "hull  white model ( [ sde ] ) has recently been studied in giese ( 2006 ) , muskulus , in t hout , bierkens et al ( 2007 ) , grzelak , oosterlee & van  weeren ( 2009 ) , grzelak & oosterlee ( 2011 ) and can lead to a more accurate valuation of option products that are sensitive to both volatility and interest rates .",
    "let @xmath17 be given .",
    "if at time @xmath18 the asset price equals @xmath19 , the variance equals @xmath20 and the interest rate equals @xmath21 , then for a european - style option with maturity time @xmath22 and payoff function @xmath23 the risk - neutral value is given by @xmath24,\\ ] ] where @xmath25 denotes conditional expectation under the risk - neutral measure . in this paper",
    "we consider @xmath26 .",
    "common arguments in financial mathematics imply that if the option value function @xmath27 is sufficiently smooth then it satisfies the pde @xmath28 for @xmath29 , @xmath30 , @xmath31 and @xmath32 . here",
    "@xmath31 since the hull ",
    "white model yields any , positive or negative , value for the interest rate .",
    "we refer to ( [ hhwpde ] ) as the _ heston ",
    "white ( hhw ) pde_. it forms a time - dependent convection - diffusion - reaction equation on an unbounded , three - dimensional spatial domain .",
    "the hhw pde contains three mixed spatial - derivative terms , stemming from the correlations between the underlying brownian motions .",
    "next , if @xmath33 then all second - order derivative terms , apart from the @xmath34 term , vanish .",
    "this degeneracy feature is already familiar from other financial pdes , such as the heston pde .",
    "finally , we note that the coefficient of the @xmath35 term is time - dependent .",
    "the hhw pde is complemented by initial and boundary conditions that are determined by the specific option under consideration .",
    "the initial condition is given by the payoff function , @xmath36 boundary conditions will be discussed below .    the initial - boundary value problem for the hhw pde does not admit analytic solutions in ( semi ) closed - form in general .",
    "an exception concerns european call options if the two correlations @xmath15 and @xmath37 are equal to zero .",
    "then a direct extension of heston s ( 1993 ) formula is available ; it is given in the appendix .",
    "for the numerical solution of the hhw pde we consider the well - known and versatile method - of - lines approach , see eg , hundsdorfer & verwer ( 2003 ) . here",
    "the pde is first discretized in the spatial variables @xmath19 ,  @xmath20 ,  @xmath21 .",
    "this leads to a system of stiff ordinary differential equations , the so - called semidiscrete system , which is subsequently solved by applying a suitable time discretization method . since the hhw pde is three - dimensional ,",
    "the obtained semidiscrete systems are very large and also possess a large bandwidth . as a consequence ,",
    "the selection of the time discretization method is critical for its effective numerical solution . to this purpose ,",
    "we analyze in the present paper splitting schemes of the adi type .",
    "an outline of the rest of our paper is as follows . in section  [ space ]",
    "we describe the spatial discretization of the hhw pde . here",
    "finite difference schemes on nonuniform spatial grids are applied . in section  [ adi ]",
    "we formulate and discuss the four adi schemes under consideration in this paper : the douglas scheme , the craig ",
    "sneyd scheme , the modified craig  sneyd scheme and the hundsdorfer  verwer scheme . in section  [ numexp ] extensive numerical tests with these adi schemes are presented . here",
    "we investigate in detail the temporal discretization errors .",
    "our tests include arbitrary correlation factors , time - dependent mean - reversion levels , cases where the feller condition is satisfied and cases where it is not .",
    "in addition , both european call options and up - and - out call options are considered .",
    "section [ concl ] gives conclusions and issues for future research .",
    "in this section we describe the spatial discretization of the hhw pde . for ease of presentation , we consider here european call options .",
    "thus @xmath38 with given strike price @xmath39 .",
    "the spatial discretization is readily adapted to various exotic options ; cf also section  [ numexp ] .      for the semidiscretization ,",
    "the spatial domain is first restricted to a bounded set @xmath40\\times [ 0,v_{\\max } ] \\times [ -r_{\\max},r_{\\max}]$ ] with fixed values @xmath41 , @xmath42 , @xmath43 chosen sufficiently large .",
    "the following boundary conditions are imposed ,    [ bc ] u(s , v , r , t)&=  0 & whenever  s=0 , + ( s , v , r , t)&=  1 & whenever  s = s _ , + u(s , v , r , t)&=  s & whenever  v = v _ , + ( s , v , r , t)&=  0 & whenever  r = r_.    0.1cmclearly these conditions are of dirichlet and neumann type . condition ( [ bc]a ) is obvious , ( [ bc]b ) and ( [ bc]c ) have already been used in the literature for the heston pde , and ( [ bc]d ) appears to be new . concerning the latter condition , it is straightforward to prove that under the black ",
    "scholes model the rho of a european call option vanishes for extreme values of the spot interest rate , and it is plausible that this holds under the asset price model ( [ sde ] ) as well .    at the important , special boundary @xmath44 we consider inserting @xmath44 into the hhw pde .",
    "this is motivated by a theorem of ekstrm & tysk ( 2011 ) revealing that in the cox ",
    "ross model , which corresponds to @xmath2 in the sde ( [ sde ] ) , the resulting equation is fulfilled by the risk - neutral option value .",
    "we note the remarkable fact that this holds irrespective of whether or not the feller condition @xmath45 , well - known from the sde literature , is satisfied .",
    "the hhw pde is semidiscretized on a nonuniform cartesian spatial grid .",
    "the nonuniform grid defined in this section is advantageous over a uniform one .",
    "this will be illustrated by numerical experiments in section [ numexp ] .    in the @xmath19-direction we consider placing relatively many mesh points throughout a given interval @xmath46\\subset [ 0,s_{\\max}]$ ] containing the strike @xmath47 .",
    "this is natural , firstly , because this is the region of interest in applications , and secondly , it alleviates numerical difficulties due to the initial ( payoff ) function @xmath23 that has a discontinuous derivative at @xmath48 .",
    "let integer @xmath49 and parameter @xmath50 and let equidistant points be given with @xmath51 note that @xmath52 .",
    "the mesh @xmath53 is then defined through the transformation @xmath54 where @xmath55 0.2cmthis mesh for @xmath19 is uniform inside the interval @xmath46 $ ] and it is nonuniform outside .",
    "the parameter @xmath56 controls the fraction of points @xmath57 that lie inside .",
    "put @xmath58 .",
    "it is readily seen that the above mesh is smooth , in the sense that there exist real constants @xmath59 , @xmath60 , @xmath61 such that the mesh widths @xmath62 satisfy @xmath63    1.5 cm , @xmath20 , @xmath21 with @xmath64 and @xmath65 , @xmath66 , @xmath67.,title=\"fig:\",scaledwidth=85.0% ]    for the @xmath20- and @xmath21-directions we define nonuniform meshes of the same type as considered in , eg , tavella & randall ( 2000 ) and in t hout & foulon ( 2010 ) .",
    "let integers @xmath68 , @xmath69 and parameters @xmath70 , @xmath71 , @xmath72 and let equidistant points and be given by @xmath73 with @xmath74 and @xmath75 with @xmath76.\\ ] ] then meshes @xmath77 and @xmath78 are defined by @xmath79 it is easily verified that the meshes for @xmath20 and @xmath21 defined above are also smooth . the parameters @xmath71 and @xmath80 control , respectively , the fraction of points @xmath81 that lie near @xmath44 and the fraction of points @xmath82 that lie near a given interest rate level  @xmath83 . here @xmath70 is chosen depending on the specific mean - reversion function  @xmath10 . for the @xmath20-mesh",
    ", besides the fact that the region @xmath84 is of practical importance , it is natural to place relatively many mesh points there for numerical reasons , as the hhw pde is convection - dominated in the @xmath20-direction for @xmath84 and the initial function is nonsmooth .",
    "in this paper we set @xmath85 , @xmath86 , @xmath87 .",
    "this renders the error induced by the restriction of the spatial domain of the hhw pde to be negligible in our experiments .",
    "based on numerical tests , the parameters of the grid have been taken equal to @xmath88 , @xmath89 , @xmath90 and , with @xmath91 , @xmath92 a further investigation into possibly better parameter values than above may be interesting , but this is out of the scope of the present paper .",
    "figure  [ meshes ] displays sample meshes for the three spatial directions if @xmath64 and @xmath65 , @xmath66 , @xmath67 .",
    "it is clear that the mesh points in the @xmath19- , @xmath20- and @xmath21-directions are concentrated , respectively , near @xmath48 , @xmath44 and @xmath83 .",
    "let @xmath93 be any given function , let @xmath94 be any given increasing sequence of mesh points , and @xmath95 for all @xmath96 .",
    "to approximate the first and second derivatives of @xmath97 , we employ the following well - known fd formulas :    @xmath98    with @xmath99    note that and are central schemes whereas and are backward and forward schemes , respectively . if @xmath100 is any given function of two variables @xmath101 , then we approximate the mixed derivative @xmath102 at any point @xmath103 by successive application of the scheme in the @xmath104- and @xmath105-directions .",
    "this is equivalent to a fd formula based on a 9-point stencil centered about @xmath103 .",
    "the fd schemes under consideration all possess a second - order truncation error on smooth meshes whenever @xmath97 is sufficiently often continuously differentiable .",
    "the actual fd discretization of the initial - boundary value problem for the hhw pde is performed as follows . in view of the dirichlet conditions ( [ bc]a ) and ( [ bc]c ) , the relevant set of grid points is @xmath106 at this grid , each spatial derivative appearing in ( [ hhwpde ] )",
    "is replaced by its corresponding central fd approximation , except :    * in the region @xmath107 the backward scheme ( [ backw ] ) is applied for @xmath108 .",
    "this is done to alleviate spurious oscillations in the fd solution when @xmath7 is small .",
    "it is well - known that such oscillations notably arise with central schemes if there is strong advection towards a dirichlet boundary .",
    "* at the boundary @xmath109 the derivatives in the @xmath19-direction need to be considered .",
    "the neumann condition ( [ bc]b ) of course yields @xmath110 and it subsequently implies that @xmath111 and @xmath112 vanish there .",
    "next , @xmath113 is approximated at @xmath114 by the scheme ( [ diffusion ] ) with virtual point @xmath115 where the value at this point is defined by linear extrapolation , using the value at @xmath116 and the ( given ) derivative at @xmath117 .",
    "* at the boundary @xmath44 we consider setting @xmath44 in the hhw pde , see subsection [ bcs ] . here",
    "@xmath118 is approximated using the forward scheme ( [ forw ] ) .",
    "we remark that this is done independently of whether or not the feller condition holds .",
    "all other derivative terms in the @xmath20-direction vanish if @xmath44 and are trivially dealt with .",
    "* at the boundaries @xmath119 the neumann conditions ( [ bc]d ) are incorporated similarly as for @xmath19 above .",
    "the fd discretization of the initial - boundary value problem for the hhw pde leads to an initial value problem for a system of stiff ordinary differential equations ( odes ) , @xmath120 here @xmath121 , for @xmath122 , is a given real square matrix and @xmath123 is a given real vector that is determined by the boundary conditions .",
    "the entries of the solution vector @xmath124 form approximations to the option values @xmath125 at the spatial grid points @xmath126 , ordered in a convenient way .",
    "the vector @xmath127 is directly obtained by evaluation of the initial function at @xmath128 .",
    "we refer to ( [ ode ] ) as the _ semidiscrete hhw pde_. the size of this system equals @xmath129 and is very large in general . in the experiments in this paper , we shall deal with sizes up to approximately one million .",
    "selecting a suitable time discretization scheme for the semidiscrete hhw pde ( [ ode ] ) is the key to obtaining an effective full numerical solution method for the hhw initial - boundary value problem .",
    "popular standard methods such as the crank  nicolson scheme are often not efficient anymore .",
    "the reason for this lies in the fact that in each new time step very large systems of linear equations need to be solved involving the matrix @xmath121 for one or more new values of  @xmath130 . due to its large bandwidth ,",
    "this is computationally very demanding .    for the time discretization of the semidiscrete hhw pde",
    ", we consider in the present paper splitting schemes of the adi type . here , the matrix @xmath121 is decomposed into four simpler matrices , @xmath131 the matrix @xmath132 represents the part of @xmath121 that stems from the fd discretization of all mixed derivative terms in the hhw pde .",
    "note that @xmath132 is nonzero whenever at least one of the correlation factors @xmath14 , @xmath15 , @xmath37 is nonzero . in line with the classical adi idea , the matrices @xmath133 , @xmath134 , @xmath135 represent the parts of @xmath121 that stem from the fd discretization of all spatial derivatives in the @xmath19- , @xmath20- and @xmath21-directions , respectively .",
    "the @xmath136 term in ( [ hhwpde ] ) is distributed evenly over @xmath133 , @xmath134 , @xmath135 .",
    "we decompose @xmath137 analogously to @xmath121 .",
    "the matrices @xmath133 , @xmath134 , @xmath135 are essentially tridiagonal , pentadiagonal and tridiagonal , respectively .",
    "note that the time - dependency of @xmath121 is only passed on to the matrix @xmath135 , ie , the matrices @xmath132 , @xmath133 , @xmath134 are time - independent .",
    "let @xmath138 be a given real parameter and @xmath139 with integer @xmath140 .",
    "set @xmath141 and @xmath142 .",
    "we study four adi schemes which all generate , in a one - step manner , successive approximations @xmath143 to the solution vectors @xmath144 of ( [ ode ] ) for @xmath145 .",
    "0.5cm__douglas ( do ) scheme : _ _ @xmath146 0.3cm__craig  sneyd ( cs ) scheme : _",
    "_ @xmath147 0.3cm__modified craig  sneyd ( mcs ) scheme : _ _",
    "@xmath148 0.3cm__hundsdorfer  verwer ( hv ) scheme : _",
    "_ @xmath149 0.2 cm the cs , mcs , hv schemes can be viewed as different extensions to the do scheme .",
    "the cs and mcs schemes are equivalent if ( and only if ) @xmath150 .",
    "it is readily observed that in the four adi schemes the @xmath132 part , representing all mixed derivatives in the hhw pde , is always treated in an _ explicit _ fashion . the first papers to propose this kind of adaptation of the classical adi schemes to pdes with mixed derivative terms are , to our knowledge , mckee & mitchell ( 1970 ) and craig & sneyd ( 1988 ) .    following the classical adi approach , the @xmath133 , @xmath134 ,",
    "@xmath135 parts are treated in an _ implicit _ fashion . in every step of each scheme ,",
    "systems of linear equations need to be solved , successively involving the matrices @xmath151 for @xmath152 and @xmath153 , where @xmath154 is the identity matrix .",
    "as all these matrices have a fixed , small bandwidth ( of at most five ) this can be done efficiently by @xmath155 factorization .",
    "note that for @xmath152 the pertinent matrices are further independent of the step index @xmath156 , and hence , their @xmath155 factorizations can be computed once , beforehand , and then used in all time steps .    by taylor expansion one obtains ( after some elaborate calculations ) the classical order of consistency of each adi scheme , ie , the order of consistency in the nonstiff sense . for any given  @xmath157 , the order of the do scheme is just one if @xmath132 is nonzero .",
    "this low order is due to the fact that the @xmath132 part is treated in a simple , explicit euler fashion .",
    "the cs scheme has order two provided @xmath150 .",
    "the mcs and hv schemes are of order two for any given @xmath157 . with the latter schemes",
    ", the parameter @xmath157 can thus be chosen to meet additional requirements .",
    "a detailed discussion , with ample references to the literature , concerning the above four adi schemes has been given in in t hout & welfert ( 2007 , 2009 ) .",
    "the do and cs schemes are already often applied to pdes in finance , see eg , andersen & andreasen ( 2000 ) , lipton ( 2001 ) , randall ( 2002 ) and andersen & piterbarg ( 2010 ) .",
    "more recently , the mcs and hv schemes have gained interest , see eg , in t hout ( 2007 ) , dang , christara , jackson & lakhany ( 2010 ) , in t hout & foulon ( 2010 ) , haentjens & in t hout ( 2010 ) , egloff ( 2011 ) and itkin & carr ( 2011 ) .    for an effective application of numerical schemes , stability is imperative .",
    "the stability of adi schemes in the case of pdes possessing mixed derivative terms has been analyzed by a number of authors in the literature .",
    "this stability analysis has been performed in the von neumann ( fourier ) framework .",
    "here one considers application to the semidiscretized convection - diffusion equation @xmath158 on a rectangular domain , with constant real vector @xmath159 and constant , positive semidefinite real matrix @xmath160 , with periodic boundary condition , on a uniform spatial grid , and one studies stability in the @xmath161-norm .",
    "note that the presence of mixed derivative terms corresponds to the matrix @xmath162 being nondiagonal .",
    "a desirable property is _ unconditional _ stability , ie , without any restriction on the time step @xmath163 .",
    "the most comprehensive stability results for the do , cs , mcs and hv schemes in the literature up to now , relevant to pdes with mixed derivative terms , are given in in t hout & welfert ( 2007 , 2009 ) , in t hout & mishra ( 2010 , 2011 ) .",
    "we review the main conclusions from loc cit pertinent to two and three spatial dimensions . here",
    "stability is always understood in the von neumann sense and unconditional . to formulate some of the results , we consider for @xmath164 $ ] the following condition on @xmath162 ,",
    "@xmath165 can be viewed as a measure for the relative size of the mixed derivative coefficients . because @xmath162 is positive semidefinite , the condition ( [ gamma ] )",
    "is always fulfilled with @xmath166 .",
    "but in actual applications , in particular the hhw pde , one usually has more information , namely @xmath167 .    for two - dimensional convection - diffusion equations with mixed derivative term ,",
    "the do and cs schemes are both stable whenever @xmath168 . if there is no convection ( @xmath169 )",
    ", then the mcs and hv schemes are stable whenever @xmath170 and @xmath171 , respectively . for the mcs scheme",
    ", stability has been proved for general two - dimensional equations , with convection , if next , based on strong numerical evidence , stability of the mcs scheme for the special value @xmath172 was conjectured under the mild , additional condition that ( [ gamma ] ) holds with @xmath173 . for the hv scheme , stability for general two - dimensional equations",
    "has been conjectured for all @xmath174 .",
    "we note that the latter bound stems from lanser , blom & verwer ( 2001 ) , who proved it to be necessary and sufficient for stability in the case of two - dimensional equations without mixed derivatives .    for three - dimensional problems , positive results on the stability of the adi schemes",
    "have been derived for pure diffusion equations with mixed derivative terms . in this case",
    ", it has been shown that the do , cs , mcs and hv schemes are stable whenever , @xmath168 , @xmath175 and @xmath176 , respectively .    at this moment",
    "sufficient conditions on @xmath157 for stability of the adi schemes pertinent to general three - dimensional convection - diffusion equations with mixed derivative terms are lacking in the literature .",
    "accordingly , we select the parameters @xmath157 , in the subsequent experiments , on the basis of the present results , reviewed above .    in practical applications",
    "it turns out that a smaller value @xmath157 often leads to a smaller error constant . in view of this , we choose @xmath157 as small as possible under the requirement of ( unconditional ) stability .",
    "in this section we present extensive numerical tests with the four adi schemes , , , in the application to the semidiscrete hhw pde described in section [ space ] .",
    "this yields important insight in their actual stability and convergence behavior and mutual performance .",
    "we consider the hhw model with arbitrary ( nonzero ) correlation factors , with time - dependent mean - reversion levels , for cases where the feller condition is satisfied and for cases where it is not .",
    "in addition , we deal with european call options as well as up - and - out call options .    for the diffusion matrix of the hhw pde ,",
    "@xmath177 it is easily verified that the condition ( [ gamma ] ) holds with @xmath178 .",
    "based on the stability and accuracy results discussed in section  [ adi ] we select , for this value  @xmath179 ,    * the do  scheme with @xmath180 * the cs  scheme with @xmath181 * the mcs scheme with @xmath182 * the hv  scheme with @xmath183 .",
    "the do scheme has classical order one and the cs , mcs , hv schemes all possess classical order two .",
    "note that the mcs scheme has @xmath184 .    for the adi schemes under consideration we shall study in this section the _ global temporal discretization error _ , defined by @xmath185 where @xmath186 with integer @xmath140 and @xmath187 denotes the exact solution vector to the semidiscrete hhw pde ( [ ode ] ) at time @xmath22 .",
    "the index @xmath188 corresponds to the spatial grid point @xmath189 and @xmath190 is a natural region of interest , to be specified below .",
    "if @xmath191 , then a semi closed - form analytic formula for european call option values is known , see the appendix .",
    "we shall employ this formula to validate the fd discretization of the hhw pde from section  [ space ] and to study the _ global spatial discretization error _ in this case , defined by @xmath192    the temporal and spatial discretization errors are both measured in the maximum norm , which is highly relevant to financial applications . in order to compute ( [ et ] ) and ( [ es ] ) for a given spatial grid , we use a sufficiently accurate reference value for @xmath187 , obtained by applying the mcs scheme to ( [ ode ] ) with @xmath193 and @xmath194 time steps , respectively .    for efficiency of the spatial discretization it turns out that one can place relatively less grid points in the @xmath20- and @xmath21-directions than in the @xmath19-direction .",
    "accordingly , we choose in the following the numbers of grid points in the three spatial directions as @xmath195 , @xmath196 with integer  @xmath197 .",
    "note that the size of the semidiscrete hhw system equals @xmath198 .",
    "we are interested in mean - reversion levels @xmath10 that are time - dependent . as an example , we choose @xmath199 with positive constants @xmath200 , @xmath201 , @xmath202 and @xmath203 .",
    "this choice for  @xmath10 is somewhat arbitrary , but the conclusions obtained below on the numerical schemes are the same for other ( more realistic ) time - dependent mean - reversion levels . for the mesh in the @xmath21-direction , defined in subsection [ grid ] , we take @xmath204 .",
    ".parameters for the heston  hull  white model . [ cols=\"^,<,<,<,<,<,<\",options=\"header \" , ]     figure  [ exactbarrier ] displays the numerically obtained up - and - out call option values in the six cases of table  [ cases1 ] for barrier @xmath205 and ( sampled ) spot interest rates @xmath206 on the @xmath207-domain @xmath208\\times [ 0,1)$ ] . here",
    "the fd discretization has been applied with @xmath209 and for the time discretization the hv scheme is used with @xmath210 .",
    "we study in detail the performance of the four adi schemes .",
    "similar to the case of european call options , figure  [ temporalerror2a ] shows the temporal discretization errors @xmath211 in the case of up - and - out call options for a sequence of step sizes @xmath212 when @xmath209 .",
    "as a first observation , it is clear from figure  [ temporalerror2a ] that the unfavorable feature of relatively large temporal errors for moderate step sizes is more pronounced compared to the case of vanilla options , especially for the cs scheme , cf subsection [ eurcall ] .",
    "we attribute this to the additional discontinuity of the payoff function at the barrier @xmath213 .",
    "we therefore consider application of a damping procedure at @xmath214 . instead of performing two substeps at @xmath214 with step size @xmath215 by the implicit euler scheme , which forms a common approach ,",
    "we employ here the do scheme , with parameter value @xmath216 .",
    "this is computationally more attractive when dealing with multidimensional pdes .",
    "figure  [ temporalerror2b ] shows the temporal discretization errors in the case of up - and - out call options when two initial substeps with the do scheme and @xmath216 are applied .",
    "clearly , the behavior of the temporal error as a function of the step size has become regular and , in most cases , at only a limited loss of accuracy for small @xmath217 ( an exception being the cs scheme in case e ) .",
    "hence , the present damping procedure performs satisfactory .",
    "applying two substeps of the implicit euler scheme for the damping would yield similar or somewhat smaller temporal errors than those in figure [ temporalerror2b ] .",
    "however , we find that this comes at a much higher computational cost , also when iterative solvers , like bicgstab , are applied .",
    "we thus infer that damping with the do scheme is more efficient .    as a main positive conclusion ,",
    "the numerical results for all adi schemes are consistent with an unconditionally stable behavior : the temporal discretization errors are bounded from above by a moderate value and decay monotonically as @xmath217 decreases , which is obtained for any value  @xmath197 tested .",
    "a closer inspection of the results displayed in figure [ temporalerror2b ] yields that the temporal errors behave for sufficiently small @xmath217 as @xmath218 with @xmath219 for the do scheme and @xmath220 for the cs , mcs , hv schemes , with constants @xmath221 .",
    "experiments with different values of @xmath197 reveal that both @xmath222 and @xmath221 are only weakly dependent on the number of spatial grid points @xmath223 , indicating that the error behavior is valid in a stiff , hence favorable , sense .",
    "note further that the difference in performance between the do scheme and the cs , mcs , hv schemes is often less striking than in the case of vanilla options , but for the latter three schemes combined with damping still a higher order and increased accuracy is obtained .",
    "in this paper we studied adi schemes in the numerical solution of the three - dimensional hhw pde : the do scheme , the cs scheme , the mcs scheme and the hv scheme , each with a well  chosen parameter @xmath157 .",
    "extensive experiments have been conducted for six cases of parameter sets for the hhw model , including correlations that are all nonzero , time - dependent mean - reversion levels , and short and long maturities . in three cases",
    "the feller condition is not fulfilled .",
    "we considered both european call options and up - and - out call options .",
    "our tests have shown that all adi schemes perform very well in terms of stability , accuracy and efficiency .",
    "in particular they always reveal an unconditionally stable behavior .",
    "next , the do scheme always has a stiff order of convergence equal to one .",
    "the cs , mcs , hv schemes show a stiff order of convergence equal to two for european call options and , when combined with damping , between 1.6 and 2.0 for up - and - out call options .",
    "based on the numerical experiments and the theoretical stability results , we find that the mcs scheme with @xmath224 and the hv scheme with @xmath225 are preferable . here",
    "also the cs scheme with @xmath227 is a good candidate .",
    "for the latter scheme , a damping procedure at @xmath214 is always recommended .",
    "damping can be done efficiently , in an adi fashion , by applying the do scheme with @xmath228 .",
    "the do , cs , mcs and hv schemes are expected to perform well and possess similar favorable properties as obtained in this paper in the numerical solution of many other three - dimensional pdes and for other exotic options .",
    "also , the adi schemes can directly be applied , with high efficiency , when any other fd discretization is employed , as the matrices @xmath229 ( @xmath230 ) always have a small bandwidth .",
    "we shall investigate other applications in future research .",
    "at the same time , a further theoretical stability analysis of the adi schemes will be carried out .",
    "here we give the semi closed - form analytic formula for european call option values @xmath231 under the hhw model ( [ sde ] ) with @xmath191 as derived in muskulus , in t hout , bierkens et al ( 2007 ) .",
    "the notation is adapted to our present situation .",
    "we put @xmath232 .",
    "the solution presented in loc cit is of a form similar to the black  scholes formula , @xmath233 here @xmath234 denotes the value at time @xmath235 of a zero - coupon bond that pays 1 at maturity , given that at time @xmath235 the short rate equals @xmath21 . for this , it is well - known that    [ bf ] b(r , ) & = & e^c(r , ) , + c(r , ) & = & -(1-e^-a(t- ) ) -_^t b()(1-e^-a(t-))d + & & +  ( t-+ e^-a(t-)- e^-2a(t-)- ) .",
    "the @xmath236 , @xmath237 can be viewed as probabilities and are retrieved from characteristic functions @xmath238 , @xmath239 by inversion : @xmath240dy \\quad { \\rm for}~j=1,2.\\ ] ] with @xmath241 .",
    "the functions @xmath238 , @xmath239 have the form @xmath242 let @xmath243 , @xmath244 and @xmath245 .",
    "then @xmath246 next , let @xmath247 and @xmath248 then @xmath249.\\ ] ] finally , @xmath250 \\right\\ } \\nonumber \\\\ & & + ( \\imi y-\\delta_j)\\int_\\tau^t b(\\lambda)\\left(1-e^{-a(t-\\lambda)}\\right)d\\lambda \\nonumber\\\\ & & + \\frac{\\sigma_2 ^ 2}{2 } \\left ( \\frac{\\imi y -\\delta_j}{a } \\right)^2 \\left ( t-\\tau + \\frac{2}{a } e^{-a(t-\\tau)}-\\frac{1}{2a } e^{-2a(t-\\tau)}-\\frac{3}{2a}\\right).\\end{aligned}\\ ] ]    the above valuation formula is easily seen to constitute a proper extension of heston s ( 1993 ) formula , by taking @xmath251 and @xmath252 .",
    "it can be approximated to any accuracy , by a direct adaptation of numerical integration techniques already well studied in the literature for heston s formula .",
    "we note that the additional integrals involving the function @xmath10 can be exactly determined in our particular case of ( [ meanr ] ) .",
    "the authors gratefully acknowledge peter forsyth for a stimulating discussion , convincing them of the proper boundary condition for the hhw pde at @xmath44 and pointing them to the work by ekstrm & tysk .",
    "the authors also thank jan van casteren for a valuable , unpublished note on the validity of the hhw pde .",
    "furthermore , they are indebted to sven foulon for providing an implementation of heston s formula for european call options , which we extended to our case . this work has been supported financially by the research foundation ",
    "flanders , fwo contract no",
    ".  g.0125.08 .",
    "d.  m.  dang , c.  c.  christara , k.  r.  jackson & a.  lakhany , _ a pde pricing framework for cross - currency interest rate derivatives _ , proc .",
    "comp . sc .",
    "( iccs ) , proc .",
    "comp . sc . * 1 * ( 2010 ) 23712380 .",
    "a.  giese , _ on the pricing of auto - callable equity structures in the presence of stochastic volatility and stochastic interest rates _ , presentation mathfinance workshop , frankfurt ( 2006 ) .",
    "+ available at www.mathfinance.com/workshop/2006/papers/giese/slides.pdf      l.  a.  grzelak , c.  w.  oosterlee & s.  van  weeren , _ extension of stochastic volatility equity models with the hull ",
    "white interest rate process _",
    ", published online in quant .",
    "( 2009 ) , doi:10.1080/14697680903170809 .",
    "t.  haentjens & k.  j.  in  t  hout , _ adi finite difference discretization of the heston",
    " hull  white pde _ , in : numerical analysis and applied mathematics , eds .",
    "t.  e.  simos et al , aip conf",
    ". proc . * 1281 * ( 2010 ) 19951999 .",
    "k.  j.  in  t  hout & c.  mishra , _ a stability result for the modified craig ",
    "sneyd scheme applied to 2d and 3d pure diffusion equations _ , in : numerical analysis and applied mathematics , eds .",
    "t.  e.  simos et al , aip conf .",
    "* 1281 * ( 2010 ) 20292032 .",
    "k.  j.  in t hout & b.  d.  welfert , _ unconditional stability of second - order adi schemes applied to multi - dimensional diffusion equations with mixed derivative terms _ , appl .",
    "numer . math .",
    "* 59 * ( 2009 ) 677692 .",
    "m.  muskulus , k.  j.  in  t  hout , j.  bierkens , a.  p.  c.  van  der  ploeg , j.  in  t  panhuis , f.  fang , b.  janssens & c.  w.  oosterlee , _ the ing problem : a problem from the financial industry _ , proc .",
    "58th european study group mathematics with industry , eds .",
    "r.  h.  bisseling et al , utrecht ( 2007 ) 91115 .",
    "g.  winkler , t.  apel & u.  wystup , _ valuation of options in heston s stochastic volatility model using finite element methods _ , in : foreign exchange risk , eds .",
    "j.  hakala & u.  wystup , risk books , london ( 2002 ) 283303 ."
  ],
  "abstract_text": [
    "<S> in this paper we investigate the effectiveness of alternating direction implicit ( adi ) time discretization schemes in the numerical solution of the three - dimensional heston  hull </S>",
    "<S>  white partial differential equation , which is semidiscretized by applying finite difference schemes on nonuniform spatial grids . </S>",
    "<S> we consider the heston  </S>",
    "<S> hull  white model with arbitrary correlation factors , with time - dependent mean - reversion levels , with short and long maturities , for cases where the feller condition is satisfied and for cases where it is not . </S>",
    "<S> in addition , both european - style call options and up - and - out call options are considered . </S>",
    "<S> it is shown through extensive tests that adi schemes , with a proper choice of their parameters , perform very well in all situations - in terms of stability , accuracy and efficiency . </S>"
  ]
}