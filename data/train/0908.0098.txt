{
  "article_text": [
    "the neighbor - joining ( nj ) algorithm was introduced by saitou and nei @xcite and is widely used to reconstruct a phylogenetic tree from an alignment of dna sequences because of its accuracy and computational speed .",
    "the nj algorithm is a distance - based method which takes all pairwise distances computed from the data as its input , and outputs a tree topology which realizes these pairwise distances , if there is such a topology ( see fig .",
    "[ fig : sampletree ] ) .",
    "note that the nj algorithm is consistent , i.e. , it returns the additive tree if the input distance matrix is a tree metric .",
    "if the input distance matrix is not a tree metric , then the nj algorithm returns a tree topology which induces a tree metric that is `` close '' to the input . since it is one of the most popular methods for reconstructing a tree among biologists , it is important to study how the nj algorithm works .",
    "-0.2 in    -0.2 in    a number of attempts have been made to understand the good results obtained with the nj algorithm , especially given the problems with the inference procedures used for estimating pairwise distances .",
    "for example , bryant showed that the _ q - criterion _ ( defined in in section [ qcriterion ] ) is in fact the unique selection criterion which is linear , permutation invariant , and _ consistent _ , i.e. , it correctly finds the tree corresponding to a tree metric @xcite .",
    "gascuel and steel gave a nice review of how the nj algorithm works @xcite .",
    "one of the most important questions in studying the behavior of the nj algorithm is to analyze its performance with pairwise distances that are not tree metrics , especially when all pairwise distances are estimated via the maximum likelihood estimation ( mle ) . in 1999",
    ", atteson showed that if the distance estimates are at most half the minimal edge length of the tree away from their true value then the nj algorithm will reconstruct the correct tree @xcite .",
    "however , levy et al .",
    "noted that atteson s criterion frequently fails to be satisfied even though the nj algorithm returns the true tree topology @xcite .",
    "recent work of @xcite extended atteson s work .",
    "mihaescu et al .",
    "showed that the nj algorithm returns the true tree topology when it works locally for the quartets in the tree @xcite .",
    "this result gives another criterion for when then nj algorithm returns the correct tree topology and atteson s theorem is a special case of mihaescu et al.s theorem .    for every input distance matrix ,",
    "the nj algorithm returns a certain tree topology .",
    "it may happen that the minimum q - criterion is taken by more than one pair of taxa at some step . in practice",
    ", the nj algorithm will then have to choose one cherry in order to return a definite result , but for our analysis we assume that in those cases the nj algorithm will return a set containing all tree topologies resulting from picking optimal cherries .",
    "there are only finitely many tree topologies , and for every topology @xmath2 we get a subset @xmath3 of the sample space ( input space ) such that for all distance matrices in @xmath3 one possible answer of the nj algorithm is @xmath2",
    ". we aim at describing these sets @xmath3 and the relation between them .",
    "one notices that the q - criteria are all linear in the pairwise distances",
    ". the nj algorithm will pick cherries in a particular order and output a particular tree @xmath2 if and only if the pairwise distances satisfy a system of linear inequalities , whose solution set forms a polyhedral cone in @xmath0 .",
    "eickmeyer et al . called such a cone a _ neighbor - joining cone , _ or _",
    "nj cone_. thus the nj algorithm will output a particular tree @xmath2 if and only if the distance data lies in a union of nj cones @xcite .    in @xcite ,",
    "eickmeyer et al . studied the optimality of the nj algorithm compared to the balanced minimum evolution ( bme ) method and focused on polyhedral subdivisions of the space of dissimilarity maps for the bme method and the nj algorithm .",
    "eickmeyer et al . also studied the geometry and combinatorics of the nj cones for @xmath4 in addition to the _ bme cones _ for @xmath5 . using geometry of the nj cones for @xmath4",
    ", they showed that the polyhedral subdivision of the space of dissimilarity maps with the nj algorithm does not form a fan for @xmath6 and that the union of the nj cones for a particular tree topology is not convex .",
    "this means that the nj algorithm is not convex , i.e. , there are distance matrices @xmath7 , such that nj produces the same tree @xmath8 on both inputs @xmath9 and @xmath10 , but it produces a different tree @xmath11 on the input @xmath12 ( see @xcite for an example ) .    in this paper , we focus on describing geometry and combinatorics of the nj cones for six taxa as well as some simulation study using the nj cones for one of the questions in @xcite , that is , what is the robustness of the nj algorithm to small perturbations of tree metrics for @xmath4 . this paper is organized as follows : in section [ sec : nj ] we will describe the nj algorithm and define the nj cones .",
    "section [ c5 ] states the hyperplane representations of the nj cones for @xmath4 .",
    "section [ 6taxa ] describes in summary the geometry and combinatorics of the nj cones for @xmath13 .",
    "section [ simulations ] shows some simulation studies on the robustness of the nj algorithm to small perturbations of tree metrics for @xmath4 with the tree models from @xcite .",
    "we end by discussing some open problems in section [ problem ] .",
    "the nj algorithm is a _ distance - based method _ which takes a _ distance matrix _ , a symmetric matrix @xmath14 with @xmath15 representing pairwise distances of a set of @xmath1 taxa @xmath16 , as the input . through this paper",
    ", we do not assume anything on an input data except it is symmetric and @xmath17 .",
    "because of symmetry , the input can be seen as a vector of dimension @xmath18 .",
    "we arrange the entries row - wise .",
    "we denote row / column - indices by pairs of letters such as @xmath19 , @xmath20 , @xmath21 , @xmath22 , while denoting single indices into the `` flattened '' vector by letters @xmath23 .",
    "the two indexing methods are used simultaneously in the hope that no confusion will arise .",
    "thus , in the four taxa example we have @xmath24 . in general , we get @xmath25 with @xmath26 and for @xmath27 we get @xmath28 -0.1 in      the nj algorithm starts by computing the so called _ q - criterion _ or the _ cherry picking criterion _ , given by the formula @xmath29 this is a key of the nj algorithm to choose which pair of taxa is a neighbor .",
    "[ saitou ] let @xmath30 for all pair of taxa @xmath31 be the tree metric corresponding to the tree @xmath32 .",
    "then the pair @xmath33 which minimizes @xmath34 for all pair of taxa @xmath31 forms a neighbor .",
    "arranging the q - criteria for all pairs in a matrix yields again a symmetric matrix , and ignoring the diagonal entries we can see it as a vector of dimension @xmath35 just like the input data .",
    "moreover , the q - criterion is obtained from the input data by a linear transformation : @xmath36 and the entries of the matrix @xmath37 are given by @xmath38 where @xmath39 is the row / column - index equivalent to @xmath40 and likewise for @xmath41 and @xmath42 .",
    "when no confusion arises about the number of taxa , we abbreviate @xmath37 to @xmath43 . after computing the q - criterion @xmath44 , the nj algorithm proceeds by finding the minimum entry of @xmath44 , or , equivalently , the maximum entry of @xmath45 .",
    "the two nodes forming the chosen pair ( there may be several pairs with minimal q - criterion ) are then joined ( `` cherry picking '' ) , i.e. , they are removed from the set of nodes and a new node is created .",
    "suppose out of our @xmath1 taxa @xmath46 , the first cherry to be picked is @xmath47 , so the taxa @xmath48 and @xmath49 are joined to form a new node , which we view as the new node number @xmath48 .",
    "the reduced pairwise distance matrix is one row and one column shorter than the original one , and by our choice of which cherry we picked , only the entries in the rightmost column and bottom row differ from the original ones .",
    "explicitly , @xmath50 and we see that the reduced distance matrix depends linearly on the original one : @xmath51 with @xmath52 , where @xmath53 the process of picking cherries is repeated until there are only three taxa left , which are then joined to a single new node .    we note that since new distances @xmath54 are always linear combinations of the previous distances , all q - criteria computed throughout the nj algorithm are linear combinations of the original pairwise distances .",
    "thus , for every possible tree topology @xmath2 outputted by the nj algorithm ( and every possible ordering @xmath55 of picked cherries that results in topology @xmath2 ) , there is a polyhedral cone @xmath56 of dissimilarity maps .",
    "the nj algorithm will output @xmath2 and pick cherries in the order @xmath55 iff the input lies in the cone @xmath57 .",
    "we call the cones @xmath57 _ neighbor - joining cones _ , or _",
    "nj cones_. -0.1 in      we first note that there is an @xmath1-dimensional linear subspace of @xmath58 which does not affect the outcome of the nj algorithm ( see @xcite ) . for a node @xmath19",
    "we define its _ shift vector _ @xmath59 by @xmath60 which represents a tree where the leaf @xmath19 has distance 1 from all other leaves and all other distances are zero",
    ". the q - criterion of any such vector is @xmath61 for all pairs , so adding any linear combination of shift vectors to an input vector does not change the relative values of the q - criteria .",
    "also , regardless of which pair of nodes we join , the reduced distance matrix of a shift vector is again a shift vector ( of lower dimension ) , whose q - criterion will also be constant .",
    "thus , for any input vector @xmath62 , the behavior of the nj algorithm on @xmath62 will be the same as on @xmath63 if @xmath64 is any linear combination of shift vectors .",
    "we call the subspace generated by shift vectors @xmath65 .",
    "we note that the difference of any two shift vectors is in the kernel of @xmath43 , and the sum of all shift vectors is the constant vector with all entries equal to @xmath1 .",
    "if we fix a node @xmath19 then the set @xmath66 is linearly independent .",
    "-0.1 in      after computing the q - criterion @xmath44 , the nj algorithm proceeds by finding the minimum entry of it , or , equivalently , the maximum entry of @xmath45 .",
    "the set @xmath67 of all q - vectors for which @xmath68 is minimal is given by the normal cone at the vertex @xmath69 to the ( negative ) simplex @xmath70 where @xmath71 are the unit vectors in @xmath72 .",
    "the normal cone is defined in the usual way by @xmath73 with @xmath74 denoting the inner product in @xmath58 .",
    "substituting @xmath75 into gives @xmath76 therefore the set @xmath77 of all _ parameter _ vectors @xmath62 for which the nj algorithm will select cherry @xmath40 in the first step is the normal cone at @xmath78 to the polytope @xmath79 the shifting lemma implies that the affine dimension of the polytope @xmath80 is at most @xmath81 .",
    "computations using ` polymake ` show that this upper bound gives the true value .",
    "if equality holds for one of the inner products in this formula , then there are two cherries with the same q - criterion .",
    "as the number of taxa increases , the resulting polytope gets more complicated very quickly . by symmetry ,",
    "the number of facets adjacent to a vertex is the same for every vertex , but this number grows following a strange pattern .",
    "see table 1 for some calculated values .",
    "we also computed f - vectors for @xmath80 via polymake . with @xmath4",
    ", we have @xmath82 , with @xmath13 , @xmath83 , and with @xmath84 we ran polymake over several hours and it took more than @xmath85 gb ram .",
    "therefore , we could not compute them .",
    "-0.2 in    [ tab : polytopes ]    .the polytopes @xmath80 for some small numbers of taxa @xmath1 . [ cols=\"^,^,^,^,^ \" , ]     -0.2 in    suppose we have a cone @xmath86 defined by hyperplanes @xmath87 , i.e. , @xmath88 and we want to find the closest point in @xmath86 from some given point @xmath89 . because @xmath86 is convex , for @xmath90-norm there is only one such point , which we call @xmath91 .",
    "if @xmath92 then @xmath93 and we are done . if not , there is at least one @xmath94 with @xmath95 , and @xmath91 must satisfy @xmath96 .",
    "now the problem reduces to a lower dimensional problem of the same kind : we project @xmath89 orthogonally into the hyperplane @xmath97 defined by @xmath98 and call the new vector @xmath99 . also , @xmath100 is a facet of @xmath86 , and in particular a cone , so we proceed by finding the closest point in this cone from @xmath99 .",
    "we say an input vector ( distance matrix ) is _ correctly classified _ if the vector is in one of the cones where the vector representation of the tree metric ( noiseless input ) is .",
    "we say an input vector is _ incorrectly classified _ if the vector is in the complement of the cones where the vector representation of the tree metric is . for input vectors ( distance matrices ) which are correctly classified by the nj algorithm",
    ", we compute the minimum distance to any cone giving a different tree topology .",
    "this distance gives a measure of robustness or confidence in the result , with bigger distances meaning greater reliability .",
    "the results are plotted in the left half of fig .",
    "[ fig : simplots ] and in fig .",
    "[ fig : goodstat ] .",
    "note that the distance of the noiseless input , i.e. , the tree metric from the tree we used for generating the data samples , gives an indication of what order of magnitude to expect with these values .    for input vectors",
    "to which the nj algorithm returns with a tree topology different from the correct tree topology , we compute the distances to the two cones for which the correct answer is given and take the minimum of the two .",
    "the bigger this distance is , the further we are off .",
    "the results are shown in the right half of fig .",
    "[ fig : simplots ] and in fig .",
    "[ fig : badstat ] .    from our results in fig .",
    "[ fig : goodstat ] and fig .",
    "[ fig : badstat ] , one notices that the nj algorithm returns the correct tree more often with @xmath101 than with @xmath102 . these results are consistent with the results in @xcite .",
    "note that any possible quartet in @xmath102 has a smaller ( or equal ) length of its internal edge than in @xmath101 ( see fig .",
    "[ fig : t1t2 ] ) .",
    "gascuel and steel defined this measure as _ neighborliness _ @xcite .",
    "mihaescu et al .",
    "showed that the nj algorithm returns the correct tree if it works correctly locally for the quartets in the tree @xcite .",
    "the neighborliness of a quartet is one of the most important factors to reconstruct the quartet correctly , i.e. , the shorter it is the more difficult the nj algorithm returns the correct quartet .",
    "[ fig : simplots ] shows that most of the input vectors lie around the boundary of cones , including the noiseless input vector ( the tree metric ) .",
    "this shows that the tree models @xmath102 and @xmath101 are difficult for the nj algorithms to reconstruct the correct trees .",
    "all source code for these simulations described in this paper will be available at authors websites .",
    "-0.1 in    can we use the nj cones for analyzing how the nj algorithm works if each pairwise distance is assumed to be of the form @xmath103 where @xmath104 is the unknown true tree metric , and @xmath105 is a collection of independent normally distributed random variables ? we think this would be very interesting and relevant .    with any @xmath1 , is there an efficient method for computing ( or approximating ) the distance between a given pairwise distance vector and the boundary of the nj optimality region which contains it ?",
    "this problem is equivalent to projecting a point inside a _ polytopal complex _ @xmath106 onto the boundary of @xmath106 .",
    "note that the size of the complex grows very fast with @xmath1 .",
    "how fast does the number of the complex grow ? this would allow assigning a confidence score to the tree topology computed by the nj algorithm .    5 atteson , k. : the performance of neighbor - joining methods of phylogenetic reconstruction .",
    "algorithmica , * 25 * ( 1999 ) 251278 .",
    "bryant , d. : on the uniqueness of the selection criterion in neighbor - joining .",
    "j. classif .",
    "* 22 * ( 2005 ) 315 .",
    "felsenstein , j. : evolutionary trees from dna sequences : a maximum likelihood approach .",
    "journal of molecular evolution * 17 * ( 1981 ) 368376 .",
    "galtier , n. , gascuel , o. , and jean - marie , a. : markov models in molecular evolution . in _ statistical methods in molecular evolution _ edited by nielsen , r. , ( 2005 ) 324 .",
    "gawrilow , e. and joswig , m. : polymake : a framework for analyzing convex polytopes . in",
    "_ polytopes  combinatorics and computation _ , edited by g kalai and gm ziegler ( 2000 ) 4374 .",
    "kimura , m. : a simple method for estimating evolutionary rates of base substitution through comparative studies of nucleotide sequences . journal of molecular evolution * 16 * ( 1980 ) 111120 .",
    "neyman , j. : molecular studies of evolution : a source of novel statistical problems . in _ statistical decision theory and related topics _ edited by gupta , s. , yackel , j. , new york academic press , ( 1971 ) 127 .",
    "jukes , h.t . and cantor ,",
    "c. : evolution of protein molecules . in _",
    "mammalian protein metabolism _ edited by hn munro , new york academic press , ( 1969 ) 2132 .",
    "levy , d. , yoshida , r. and pachter , l. : neighbor - joining with phylogenetic diversity estimates . molecular biology and evolution",
    "* 23 * ( 2006 ) 491498 .",
    "mihaescu , r. , levy , d. , and pachter , l. : why neighbor - joining works .",
    "( 2006 ) arxiv : cs.ds/0602041 .",
    "olsen , g.j . ,",
    "matsuda , h. , hagstrom , r. , and overbeek , r. : fastdnaml : a tool for construction of phylogenetic trees of dna sequences using maximum likelihood .",
    "* 10 * ( 1994 ) 4148 ."
  ],
  "abstract_text": [
    "<S> in 2007 , eickmeyer et al . showed that the tree topologies outputted by the neighbor - joining ( nj ) algorithm and the balanced minimum evolution ( bme ) method for phylogenetic reconstruction are each determined by a polyhedral subdivision of the space of dissimilarity maps @xmath0 , where @xmath1 is the number of taxa . in this paper </S>",
    "<S> , we will analyze the behavior of the neighbor - joining algorithm on five and six taxa and study the geometry and combinatorics of the polyhedral subdivision of the space of dissimilarity maps for six taxa as well as hyperplane representations of each polyhedral subdivision . </S>",
    "<S> we also study simulations for one of the questions stated by eickmeyer et al . , that is , the robustness of the nj algorithm to small perturbations of tree metrics , with tree models which are known to be hard to be reconstructed via the nj algorithm . </S>"
  ]
}