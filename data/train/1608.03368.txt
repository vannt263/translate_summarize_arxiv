{
  "article_text": [
    "in this paper we investigate a class of digraphs that can be viewed as a digraph generalization of interval graphs . a graph",
    "@xmath1 is an _ interval graph _ if it is the intersection graph of a family of intervals on the real line , i.e. , if there exist intervals @xmath2 such that @xmath3 if and only if @xmath4 .",
    "interval graphs are one of the most popular and useful graph classes ; they admit efficient recognition algorithms , elegant obstruction characterizations , and frequently occur in practice @xcite .",
    "the classical digraph versions of interval graphs @xcite lack many of these desirable attributes , although the authors have ( in an paper joint with t. feder and j. huang ) proposed a version of interval digraphs that shares with interval graphs many nice properties ; that version only applies to reflexive digraphs ( that is , digraphs in which every vertex has a loop ) @xcite .",
    "specifically , a reflexive digraph @xmath1 is an _ adjusted interval digraph _ if there are two families of real intervals @xmath5 , such that @xmath3 if and only if @xmath6 . adjusted interval digraphs have efficient recognition algorithms , forbidden structure characterizations , and certain desirable algorithmic properties .",
    "this suggested what should be the analogue of interval graphs amongst reflexive digraphs .",
    "the question of which general digraphs should be viewed as an appropriate extension of interval graphs remained open .",
    "there is , however , a natural concept for what interval digraphs should be . to motivate this concept ,",
    "we introduce the notion of a polymorphism .",
    "given digraphs @xmath7 and @xmath1 , a _ homomorphism _ of @xmath7 to @xmath1 is a mapping @xmath8 such that @xmath9 implies @xmath10 .",
    "a _ product _ of digraphs @xmath7 and @xmath1 has the vertex set @xmath11 and arc set @xmath12 consisting of all pairs @xmath13 such that @xmath9 and @xmath14 .",
    "the product of @xmath0 copies of the same graph @xmath1 is denoted by @xmath15 .",
    "a _ polymorphism _ of @xmath1 of order @xmath0 is a homomorphism of @xmath15 to @xmath1 . in other words",
    ", it is a mapping @xmath16 from the set of @xmath0-tuples over @xmath17 to @xmath17 such that if @xmath18 for @xmath19 , then @xmath20 .",
    "polymorphisms of @xmath1 play a pivotal role in recognizing digraphs ( and more general relational systems ) @xmath7 that admit a homomorphism to @xmath1 @xcite , cf .",
    "also @xcite .",
    "a polymorphism @xmath16 is _ conservative _ if each value @xmath21 is one of the arguments @xmath22 .",
    "a binary ( order two ) @xmath16 polymorphism that is conservative and commutative ( @xmath23 for all vertices @xmath24 ) will be called a _ cc polymorphism_. if @xmath16 is additionally associative ( @xmath25 for all vertices @xmath26 ) it will be called a _ conservative semi - lattice _ or an _",
    "csl polymorphism_. a csl polymorphism of @xmath1 naturally defines a binary relation @xmath27 on the vertices of @xmath1 by @xmath27 if and only if @xmath28 ; by associativity , the relation @xmath29 is a linear order on @xmath17 , which we call a _ min ordering _ of @xmath1 . in other words ,",
    "an ordering of vertices @xmath30 @xmath31 of @xmath1 is a min ordering if and only if @xmath32 .",
    "yet another way to state this is as follows .",
    "the ordering @xmath33 of @xmath17 is a min ordering if and only if @xmath34 and @xmath35 implies that @xmath36 .",
    "it is also clear that , conversely , a min ordering @xmath37 of @xmath1 defines a csl polymorphism @xmath38 by @xmath39 .",
    "interval graphs are known to have an ordering characterization : @xmath1 is an interval graph if and only if @xmath17 can be linearly ordered @xmath33 so that @xmath40 and @xmath41 imply that @xmath3 .",
    "however , it is easy to check , see @xcite , that a reflexive graph @xmath1 ( every vertex has a loop ) is an interval graph if and only if it has a min ordering .",
    "( note that it is reasonable to define an interval graph to be reflexive , since any interval intersects itself . )",
    "it is also known that a reflexive digraph is an adjusted interval digraph if and only if it has a min ordering .",
    "moreover , min ordering on bigraphs ( bipartite graphs , or more precisely bipartite digraphs with all edges between the parts oriented in the same direction ) characterizes the class complements of circular arc graphs @xcite , a natural generalization of interval graphs in the class of bipartite graphs @xcite .",
    "thus , it has long been believed that digraphs with min ordering are the right notion for the general version of interval digraphs .",
    "however , it was not known whether this class of digraphs can be recognized in polynomial time , whether it has an obstruction characterization , and whether it has any geometric meaning .",
    "we remedy the situation on all three fronts .",
    "we give a geometric representation of the class of digraphs with a min ordering , we give an obstruction characterization of it , and we also give a certifying polynomial time recognition algorithm for the class .",
    "the existence of such an algorithm was posed as an open problem in @xcite ; it is somewhat unexpected , since for more general relational structures the recognition problem is known to be np - complete @xcite .",
    "we note that for structures with two binary relations ( digraphs with two kinds of arcs ) , the recognition problem of having a min ordering is np - complete , via a reduction ( from a preliminary version of @xcite ) similar to that in the proof of theorem 4.9 @xcite .",
    "other questions about the existence of polymorphisms of various kinds have turned out to also be interesting @xcite . in particular , the existence of conservative polymorphisms is a hereditary property ( if @xmath1 has a particular kind of conservative polymorphism , then so does any induced subgraph of @xmath1 ) . thus these questions present interesting problems in graph theory . in particular , we note that there are forbidden induced substructure characterizations for the existence of conservative majority @xcite and conservative maltsev @xcite polymorphisms .",
    "a polymorphism @xmath16 of @xmath1 of order @xmath0 is _ totally symmetric _ if @xmath42 @xmath43 whenever the sets @xmath44 and @xmath45 are the same .",
    "a _ set polymorphism _ of @xmath1 is a mapping @xmath16 of the non - empty subsets of @xmath17 to @xmath17 , such that @xmath46 whenever @xmath47 are non - empty subsets of @xmath17 with the property that for each @xmath48 there is a @xmath49 with @xmath50 and also for every @xmath49 there is an @xmath48 with @xmath50 .",
    "it is easy to see , cf .",
    "@xcite , that @xmath1 has a conservative set polymorphism if and only if it has conservative totally symmetric polymorphisms of all orders @xmath0 .",
    "in such a case we say @xmath1 has a cts polymorphism .",
    "we note that a digraph @xmath1 that admits a csl polymorphism also admits a cts polymorphism : the conservative set function that assigns to each set @xmath51 the minimum under the min ordering .",
    "moreover , a cts polymorphism applies to all orders , including order two , whence it implies a cc polymorphism .",
    "thus the class of digraphs with a min ordering is included in the class of digraphs with a conservative set polymorphism , which is included in the class of digraphs with a cc polymorphism .",
    "we will give forbidden induced structure characterizations for all three of these digraph classes , from which it will follow that ( surprisingly ) the first two classes coincide . in all three cases ,",
    "the characterizations yield polynomial time recognition algorithms .",
    "although this was known for cc polymorphisms @xcite ( even known to be in non - deterministic logspace @xcite ) , it was open for csl and cts polymorphisms @xcite .",
    "we emphasize that our results are specific to digraphs ; for more general relational structures it is known , for instance , that the existence of csl polymorphisms is np - complete , even with two binary relations @xcite .",
    "in this section we introduce a geometric representation of digraphs that admit a min - ordering .",
    "let @xmath52 be a circle with two distinguished points ( the _ poles _ ) @xmath53 and @xmath51 , and let @xmath1 be a digraph .",
    "let @xmath54 and @xmath55 be two families of arcs on @xmath52 such that each @xmath56 contains @xmath53 but not @xmath51 , and each @xmath57 contains @xmath51 but not @xmath53 .",
    "we say that the families @xmath56 and @xmath57 are _ consistent _ if they have the same clockwise order of their clockwise ends , i.e. , if the clockwise end of @xmath56 precedes in the clockwise order the clockwise end of @xmath58 if and only if the clockwise end of @xmath57 precedes in the clockwise order the clockwise end of @xmath59 .",
    "suppose two families @xmath60 are consistent ; we define an ordering @xmath37 on @xmath17 where @xmath61 if and only if the clockwise end of @xmath56 precedes in the clockwise order the clockwise end of @xmath58 ; we call @xmath37 the ordering _ generated by _",
    "the consistent families @xmath60 .",
    "a _ bi - arc representation _ of a digraph @xmath1 is a consistent pair of families of circular arcs , @xmath5 , such that @xmath3 if and only if @xmath62 and @xmath57 are disjoint .",
    "a digraph @xmath1 is called a _ bi - arc digraph _ if it has a bi - arc representation .",
    "[ bi - arc - min ] a digraph @xmath1 admits a min ordering if and only if @xmath1 is a bi - arc digraph .",
    "* proof : * suppose @xmath60 form a bi - arc representation of @xmath1 .",
    "we claim that the ordering @xmath37 generated by @xmath60 is a min ordering of @xmath1 . indeed , suppose @xmath63 and @xmath64 have @xmath65 .",
    "then @xmath66 spans the area of the circle between @xmath53 and the clockwise end of @xmath62 , and @xmath57 spans the area of the circle between @xmath51 and the clockwise end of @xmath67 .",
    "( see figure [ bi - arcs - short ] . )",
    "this implies that @xmath62 and @xmath67 are disjoint : indeed , the counterclockwise end of @xmath62 is blocked from reaching @xmath67 by @xmath57 ( since@xmath3 ) , and the counterclockwise end of @xmath67 is blocked from reaching @xmath62 by @xmath66 ( since@xmath68 ) .",
    "( the clockwise ends are fixed by the ordering @xmath37 . )",
    "conversely , suppose @xmath37 is a min ordering of @xmath1 .",
    "we construct families of arcs @xmath56 and @xmath57 , with @xmath69 , as follows .",
    "the intervals will @xmath56 contain @xmath53 but not @xmath51 , the intervals @xmath57 will contain @xmath51 but not @xmath53 .",
    "the clockwise ends of @xmath56 are arranged in clockwise order according to @xmath37 , as are the clockwise ends of @xmath57 .",
    "the counterclockwise ends will now be organized so that @xmath5 becomes a bi - arc representation of @xmath1 . for each vertex @xmath69 , let @xmath70 denote the last out - neighbour of @xmath71 , and let @xmath72 denote the last in - neighbour of @xmath71 , where `` last '' refers to the order @xmath37 .",
    "then we extend each @xmath56 counterclockwise as far as possible without intersecting @xmath73 , and extend each @xmath57 counterclockwise as far as possible without intersecting @xmath74 .",
    "we claim this is a bi - arc representation of @xmath1 . clearly , if @xmath75 , then @xmath56 intersects @xmath59 by the construction , and similarly for @xmath76 we have @xmath57 intersecting @xmath62 .",
    "this leaves disjoint all pairs @xmath77 such that @xmath78 and @xmath79 ; since @xmath80 are edges of @xmath1 , the definition of min ordering implies that @xmath81 is in fact an edge of @xmath1 , as required .",
    "a digraph @xmath1 consists of a vertex set @xmath17 and an arc set @xmath83 .",
    "each arc is an ordered pair of vertices .",
    "we say that @xmath3 is an arc from @xmath84 to @xmath71 .",
    "sometimes we emphasize this by saying that @xmath81 is a _",
    "forward arc _ of @xmath1 , and also say @xmath85 is a _ backward arc _ of @xmath1 .",
    "we say that @xmath86 are _ adjacent _ in @xmath1 if @xmath81 is a forward or a backward arc of @xmath1 .",
    "a _ walk _ in @xmath1 is a sequence @xmath87 of consecutively adjacent vertices of @xmath1 ; note that a walk has a designated first and last vertex .",
    "@xmath88 @xmath89 is a walk in which all @xmath90 are distinct .",
    "a walk @xmath87 is _ closed _ if @xmath91 and a _ cycle _ if all other @xmath90 are distinct .",
    "a walk is _ directed _ if all its arcs are forward .",
    "a vertex @xmath92 is said to be _",
    "reachable _ from a vertex @xmath84 in @xmath1 if there is a directed walk from @xmath84 to @xmath92 in @xmath1 ; a set @xmath93 is _ reachable _ from a set @xmath94 if some vertex of @xmath93 is reachable from some vertex of @xmath94 .    for walks",
    "@xmath95 from @xmath96 to @xmath97 , and @xmath98 from @xmath97 to @xmath99 , we denote by @xmath100 the walk from @xmath96 to @xmath99 which is the concatenation of @xmath95 and @xmath98 , and by @xmath101 the walk @xmath95 traversed in the opposite direction , from @xmath97 to @xmath96 .",
    "we call @xmath101 the _ reverse _ of @xmath95 . for a closed walk @xmath52 , we denote by @xmath102 the concatenation of @xmath52 with itself @xmath96 times .",
    "the _ net length _ of a walk is the number of forward arcs minus the number of backward arcs .",
    "a closed walk is _ balanced _ if it has net length zero ; otherwise it is _ unbalanced_. note that in an unbalanced closed walk we may always choose a direction in which the net length is positive ( or negative ) .",
    "a digraph is _ unbalanced _ if it contains an unbalanced closed walk ( or equivalently an unbalanced cycle ) ; otherwise it is _ balanced_. it is easy to see that a digraph is balanced if and only if it admits a _ labeling _ of vertices by non - negative integers so that each arc goes from a vertex with a label @xmath103 to a vertex with a label @xmath104 .",
    "the _ height _ of @xmath1 is the maximum net length of a walk in @xmath1 .",
    "note that an unbalanced digraph has infinite height , and the height of a balanced digraph is the greatest label in a non - negative labeling in which some vertex has label zero .    for a walk @xmath105 and any @xmath106 , we denote by @xmath107 $ ] the walk @xmath108 , and",
    "call it a _ prefix _ of @xmath95 if @xmath109 . if @xmath87 is a walk in @xmath1 of net length @xmath110 .",
    "we say that @xmath1 is _ constricted from below _ if the net length of any prefix @xmath111 $ ] is non - negative , and is _ constricted from above _ if the net length of any prefix is at most @xmath0 .",
    "we also say that @xmath95 is _ constricted _ if it is constricted both from below and from above .",
    "moreover , we say that @xmath95 is _ strongly _ constricted from below or above , if the corresponding net lengths are strictly positive or smaller than @xmath0 . for walks @xmath95 of net length @xmath112 , we say that @xmath95 is ( strongly or not ) constricted below , or above , or both , if the above definitions apply to the reverse walk @xmath101 .",
    "consider a cycle @xmath52 in @xmath1 of non - zero net length @xmath0 .",
    "a vertex @xmath71 is _ extremal _ in @xmath52 if either @xmath113 and traversing @xmath52 in the positive direction yields a walk constricted from below , or @xmath114 and traversing @xmath52 in the negative direction yields a walk constricted from above .",
    "we observe that a cycle @xmath52 of positive net length @xmath0 has @xmath0 extremal vertices , since starting at any vertex @xmath115 the net length of the prefix @xmath116 $ ] varies from @xmath117 to a possibly negative minimum @xmath118 , but ending with @xmath113 .",
    "we can let @xmath119 be the last vertex with the net length of @xmath120 $ ] equal to the minimum @xmath118 ( possibly @xmath121 if @xmath122 ) .",
    "we can let @xmath123 be the last vertex with the net length of @xmath124 $ ] equal to @xmath125 .",
    "note that each walk @xmath126 $ ] is constricted from below and has net length one .",
    "we also note for future reference that any other extremal vertex of @xmath52 has a walk of net length zero to one of @xmath127 .",
    "similar observations apply when @xmath52 has a negative net length .",
    "a cycle of @xmath1 is _ induced _ if @xmath1 contains no other arcs on the vertices of the cycle . in particular ,",
    "an induced cycle with more than one vertex does not contain a loop .",
    "the following lemma is well known .",
    "( for a proof , see @xcite or lemma 2.36 in @xcite ) .",
    "[ typer ] let @xmath128 and @xmath129 be two constricted walks of net length @xmath130",
    ". there exists a constricted path @xmath95 of net length @xmath130 that admits a homomorphism @xmath131 to @xmath128 and a homomorphism @xmath132 to @xmath129 , such that each @xmath133 takes the starting vertex of @xmath95 to the starting vertex of @xmath134 and the ending vertex of @xmath95 to the ending vertex of @xmath134 .",
    "we call @xmath95 a _ common pre - image _ of @xmath128 and @xmath129 . in particular , we emphasize that we use the term _ pre - image _ of a path @xmath135 to be a path @xmath95 that admits a homomorphism to @xmath135 taking the first vertex of @xmath95 to the first vertex of @xmath135 and the last vertex of @xmath95 to the last vertex of @xmath135 .",
    "we visualize @xmath95 as following the arcs of @xmath128 ( respectively @xmath129 ) , starting where @xmath128 ( respectively @xmath129 ) starts and ending where @xmath128 ( respectively @xmath129 ) ends , but possibly taking intermediate back and forth steps .",
    "when we mention pre - images of walks , we shall always assume that the pre - image starts at the starting vertex and ends at the ending vertex of the original walk .",
    "in this section we introduce a construction that will be used throughout the paper .",
    "we also illustrate the techniques on the easy case of cc polymorphisms .",
    "as mentioned earlier , the existence of cc polymorphisms is well understood ; it is solvable by 2-sat @xcite , so it is both known to be decidable in polynomial time and characterized by forbidden substructures @xcite . in fact , it is shown in @xcite that it can be decided in non - determinstic logspace .",
    "nevertheless , we present our obstructions to the existence of cc polymorphism because they illuminate the general obstructions to csl polymorphisms , and underscore the relationship between the two types of polymorphisms and their obstructions .",
    "suppose @xmath16 is a cc polymorphism of @xmath1 .",
    "if @xmath136 but @xmath137 , then @xmath28 implies @xmath138 .",
    "a similar situation arises if @xmath139 but @xmath140 : again @xmath28 implies @xmath138 .",
    "we define two walks @xmath87 and @xmath141 in @xmath1 to be _ congruent _ , if they follow the same pattern of forward and backward arcs , i.e. , @xmath142 is a forward ( backward ) arc if and only if @xmath143 is a forward ( backward ) arc ( respectively ) .",
    "suppose the walks @xmath144 as above are congruent .",
    "we say an arc @xmath145 is _ a faithful arc from @xmath95 to @xmath98 _ , if it is a forward ( backward ) arc when @xmath142 is a forward ( backward ) arc ( respectively ) , and we say an arc @xmath146 is _ a faithful arc from @xmath98 to @xmath95 _ , if it is a forward ( backward ) arc when @xmath142 is a forward ( backward ) arc ( respectively ) .",
    "we say that @xmath95 _ avoids _",
    "@xmath98 if there is no faithful arc @xmath145 from @xmath95 to @xmath98 , for some @xmath147 .",
    "we note for future reference that if two congruent walks @xmath144 avoid each other , then the same is true for any common pre - images @xmath148 .",
    "( note that if @xmath95 avoids @xmath98 , it is not necessarily true that @xmath135 avoids @xmath149 because of the back steps involved in the pre - images . )    we define the _ pair digraph _ @xmath150 as follows .",
    "the pairs of @xmath150 are all ordered pairs @xmath151 of distinct vertices of @xmath1 , and @xmath152 just if    * @xmath153 but @xmath137 , or * @xmath139 but @xmath140 .    in the former case",
    "we call the arc @xmath152 a _ positive arc _ , and the the second case we call it a _ negative arc_. we say positive arc @xmath154 is _ symmetric _ if @xmath153 but @xmath155 we say negative arc @xmath154 is _ symmetric _ if @xmath156 but @xmath157",
    ". a path in @xmath150 is symmetric if all its arcs are symmetric .",
    "note that in @xmath150 we have an arc from @xmath151 to @xmath158 if and only if there is an arc from @xmath159 to @xmath160 .",
    "we call this the _ skew property _ of @xmath150",
    ".    note that a directed walk @xmath161 in @xmath150 corresponds precisely to a pair of congruent walks @xmath144 in @xmath1 such that @xmath95 avoids @xmath98 .",
    "the _ net value _ of the directed walk @xmath161 is defined to be the net length of the walk @xmath95 ( or @xmath98 ) .",
    "it is the difference between the number of positive and negative arcs of @xmath161 .",
    "we say that @xmath161 has _ constricted values _",
    "if the walk @xmath95 ( or @xmath98 ) is constricted , i.e. , if each initial segment of @xmath161 has net value between zero and the net value of @xmath161 . walks with values constricted below or above are defined similarly .    according to our observation , having a walk in @xmath150 from @xmath151 to @xmath158 means that @xmath28 implies that @xmath138 in any cc polymorphism @xmath16 of @xmath1 . in particular , for any strong component @xmath52 of @xmath150 , and any cc polymorphism @xmath16 of @xmath1 , either all pairs @xmath162 are mapped by @xmath16 to the first coordinate or all are mapped to the second coordinate . moreover , if @xmath163 is reachable from @xmath164 in @xmath150 , and @xmath16 maps pairs in @xmath164 to the first coordinate , then it also maps pairs in @xmath163 to the first coordinate . an _ invertible pair _ of @xmath1 is a vertex @xmath151 of @xmath150 such that @xmath151 and @xmath159 are in the same strong component of @xmath150 . it is easy to see , using the skew property of @xmath150 , that if one vertex of a strong component of @xmath150 is invertible , then so are all others , and , that if @xmath1 has no invertible pairs , then each component @xmath52 has a corresponding _ dual _ component @xmath165 such that @xmath162 if and only if @xmath166 .",
    "in fact , constructing a cc polymorphism for @xmath1 amounts to selecting , one strong component from each pair @xmath167 of dual strong components , to map @xmath16 to the first coordinate , in such a way , that if @xmath163 is reachable from @xmath164 in @xmath150 , and @xmath164 was selected , then @xmath163 is also selected .",
    "this is easy to do , for instance by the following algorithm .",
    "we say that a strong component @xmath52 of a digraph is _ ripe _ if no other strong component is reachable from it .",
    "the algorithm begins by selecting a ripe strong component @xmath52 of @xmath150 , and deleting it and its dual @xmath165 from @xmath150 , continuing the same way with the remaining digraph .",
    "this algorithm clearly selects exactly one pair from @xmath168 for each @xmath169 .",
    "it remains to prove that if @xmath151 is selected and @xmath154 is an arc of @xmath150 , then @xmath158 is also selected .",
    "this is clear if @xmath170 are from the same strong component of @xmath150 .",
    "otherwise , suppose for a contradiction , that @xmath151 was selected in a component @xmath52 after @xmath158 was deleted in a component @xmath171 , where @xmath172 was selected ( before @xmath52 ) . by the skew property of @xmath150 , we see that @xmath172 has an arc to @xmath165 , so it was selected when it was not yet ripe .",
    "[ cc ] a digraph @xmath1 admits a cc polymorphism if and only if no strong component of @xmath150 contains an invertible pair .",
    "if @xmath37 is a min ordering of @xmath1 , then @xmath173 ( with respect to @xmath37 ) is a cc polymorphism of @xmath1 , so much of the above observations apply verbatim . if @xmath136 but @xmath137 , ( or if @xmath139 but @xmath140 ) , then @xmath174 implies @xmath175 .",
    "( note that otherwise @xmath176 would violate the min property ) .",
    "a _ circuit _ in @xmath150 is a set of pairs @xmath177 of @xmath150 .",
    "note that an invertible pair of @xmath1 is a circuit with @xmath178 in a strong component of @xmath150 .",
    "if a strong component of @xmath150 contains a circuit , then @xmath1 can not have a min ordering , since @xmath179 implies @xmath180 ( and similarly for @xmath181 ) , contradicting the transitivity of @xmath37 .",
    "we have proved one direction of the following result .",
    "[ inv ] a digraph @xmath1 admits a min ordering if and only if no strong component of @xmath150 contains a circuit .",
    "this nicely complements theorem [ cc ] , highlighting the difference in the obstructions .",
    "we now single out a particular situation in which a circuit occurs in one strong component of the pair digraph @xmath150 .",
    "[ cyc ] if @xmath1 contains an induced cycle of net length greater than one , then a strong component of @xmath150 contains a circuit .",
    "* proof : * suppose @xmath52 is an induced cycle of net length @xmath182 . recall that the cycle @xmath52 has @xmath0 extremal vertices @xmath127 with each @xmath126 $ ] ( subscript addition modulo @xmath0 ) constricted from below and of net length one .",
    "we shall show that @xmath183 @xmath184 belong to the same strong component of @xmath150 .",
    "indeed , for any @xmath185 , we shall exhibit a directed walk in @xmath150 from @xmath186 to @xmath187 .",
    "these walks in @xmath150 will be constructed out of pairs of walks on the cycle @xmath52 .",
    "assume first that the height of @xmath188 $ ] is at most the height of @xmath126 $ ] . to be able to use lemma [ typer ]",
    ", we consider the last vertex @xmath189 of @xmath126 $ ] maximizing the g of @xmath190 $ ] , and the first vertex @xmath191 of @xmath126 $ ] such that @xmath192 $ ] has net length one .",
    "now @xmath193 $ ] and @xmath190 $ ] are constricted and have the same net length . thus by lemma [ typer ] they have a common pre - image @xmath194 . also @xmath195 $ ] and @xmath196 $ ] are constricted and have the same net length ; thus they also have a common pre - image @xmath197 .",
    "let @xmath198 be the walk in @xmath52 from @xmath199 to @xmath123 corresponding to @xmath200 , and let @xmath201 be the walk in @xmath52 from @xmath123 to @xmath202 corresponding to @xmath200 .",
    "we claim that @xmath198 avoids @xmath201 .",
    "consider the @xmath203-th vertex @xmath84 of @xmath198 , and the @xmath204-st vertex @xmath71 of @xmath201 .",
    "note that the net lengths of @xmath205 $ ] and @xmath206 $ ] differ by two ; since @xmath52 is an induced cycle of net length is greater than one , there can be no faithful arc between @xmath84 and @xmath71 .",
    "this implies that there is a directed path in @xmath150 from @xmath207 to @xmath208 .",
    "if the height of @xmath188 $ ] is greater than the height of @xmath126 $ ] , we argue analogously .",
    "we denote by @xmath95 the infinite walk obtained by continuously following @xmath52 in the positive direction .",
    "let @xmath189 be the last vertex of @xmath188 $ ] maximizing the net length of @xmath209 $ ] , and let @xmath191 be the first vertex of @xmath95 after @xmath202 such that @xmath210 $ ] has net length zero .",
    "now lemma [ typer ] can be applied to the walks @xmath209 $ ] with @xmath211 $ ] , and to the walks @xmath212 $ ] with @xmath213 $ ] , yielding a common pre - image @xmath194 for the former pair and a common pre - image @xmath197 for the latter pair .",
    "the walk @xmath198 in @xmath52 from @xmath199 to @xmath123 corresponding to @xmath200 again avoids the walk @xmath201 in @xmath95 from @xmath123 to @xmath202 corresponding to @xmath200 .",
    "@xmath82    we note that the avoidance of the walks did nt quite need that the cycle @xmath52 be induced .",
    "it should just not have certain chords .",
    "we state a useful version as follows .",
    "[ circuit - cycle ] suppose @xmath52 is a closed walk in @xmath1 of net length greater than one , and @xmath24 are two extremal vertices of @xmath52 such that the net length of @xmath214 $ ] is positive .",
    "let @xmath215 be the infinite walk starting at @xmath115 , obtained by continuously following the cycle @xmath52 in the positive direction and let @xmath216 be obtained the same way starting at @xmath217 .",
    "if @xmath218 have common pre - images @xmath219 such that @xmath198 avoids @xmath201 , then some strong component of @xmath150 contains a circuit .",
    "we now formulate some useful facts .",
    "the first two deal with a situation where four walks @xmath220 start in four distinct vertices , but the end vertices of walks @xmath197 and @xmath52 coincide .",
    "note that this means that @xmath197 does not avoid @xmath52 , and vice versa .",
    "( at the last step , there is a faithful arc . )",
    "the statements serve to identify situations in which all the other pairs avoid each other , i.e. , @xmath194 avoids @xmath221 ; @xmath197 avoids @xmath222 ; @xmath52 avoids @xmath222 ; and @xmath172 avoids @xmath223 . in the first lemma ,",
    "we start with congruent walks @xmath220 , while in the second lemma only @xmath224 are congruent , and @xmath225 are congruent ; but on the other hand , all four walks are constricted and have the same height , so we can replace them by their common pre - images by lemma [ typer ] .    for simplicity , for two pairs",
    "@xmath226 let @xmath227 denote that @xmath228 is reachable from @xmath229 in @xmath150 and also denote a direct path in @xmath150 from @xmath229 to @xmath228 .",
    "if there is not direct path in @xmath150 from @xmath229 to @xmath228 then we write @xmath230 .",
    "[ strong - core ] let @xmath220 be four congruent walks in @xmath1 , from @xmath231 to @xmath232 respectively , such that @xmath194 avoids @xmath197 and @xmath52 avoids @xmath172 .",
    "suppose in @xmath150    * @xmath233 and @xmath234 , * @xmath235 and @xmath236    then all pairs from @xmath220 avoid each other , except the pair @xmath237 .",
    "* proof : * let @xmath194 be the walk @xmath238 , @xmath197 the walk @xmath239 , @xmath52 the walk @xmath240 , and @xmath172 the walk @xmath241 .",
    "let @xmath242 denote the statement that all pairs from @xmath243 , b[b_{i+1},b ] , c[c_{i+1},b ] , d[d_{i+1},d]$ ] avoid each other , except possibly @xmath244 , c[c_{i+1},b]$ ] .",
    "the lemma claims that @xmath245 holds , while @xmath246 holds vacuously .",
    "therefore , let @xmath247 be the first index such that @xmath242 holds .",
    "note that @xmath248 is not a faithful arc .",
    "otherwise , @xmath249 in @xmath150 by combining two walks in @xmath1 , namely the walk @xmath250 $ ] concatenated with @xmath251 $ ] , and the walk @xmath197 .",
    "this implies that @xmath252 is also not a faithful arc , since otherwise @xmath253 by combining the walks @xmath194 and @xmath254 $ ] concatenated with @xmath251 $ ] .",
    "( this uses the fact that @xmath248 is not a faithful arc . )    by a similar line of reasoning , we conclude that    * @xmath255 is not a faithful arc ( as otherwise @xmath256 ) , and then @xmath257 is not a faithful arc ( otherwise @xmath258 ) .",
    "* @xmath259 is not a faithful arc ( as otherwise @xmath260 ) , and @xmath261 is not a faithful arc ( as otherwise @xmath256 ) .    together with the fact that @xmath262 and @xmath263 are not faithful arcs ( corresponding to the assumption that @xmath194 avoids @xmath197 and @xmath52 avoids @xmath172 ) , we obtain a contradiction with the minimality of @xmath103 ; therefore @xmath109 , and the lemma is proved .",
    "@xmath82    a similar result applies to walks that are not all congruent , as long as they are constricted and have the same net length .",
    "( of course the walks that are avoiding pairs must be congruent by definition . )    [ strong - core1 ] let @xmath220 be four constricted walks of the same net length , from @xmath231 to @xmath232 respectively , such that @xmath224 are congruent and @xmath194 avoids @xmath197 , and @xmath225 are congruent and @xmath52 avoids @xmath172 .",
    "suppose in @xmath150    * @xmath233 and @xmath234 , * @xmath235 and @xmath236    then there exist congruent walks @xmath264 that are pre - images of @xmath220 respectively , such that all pairs from @xmath264 avoid each other , except the pair @xmath265 and hence @xmath266 avoid each other and @xmath267 avoid each other .",
    "* proof : * let @xmath194 be the walk @xmath238 , @xmath197 the walk @xmath239 , @xmath52 the walk @xmath268 , and @xmath172 the walk @xmath269 .",
    "we prove the corollary by induction on the sum of the lengths @xmath270 .",
    "if @xmath271 , i.e. , @xmath272 , this holds trivially .",
    "suppose first that @xmath220 are strongly constricted from below .",
    "this means that the first two arcs in each walk are forward arcs , and the walks @xmath273 are also constricted walks of the same net length , with the first two congruent and the last two congruent .",
    "moreover , in @xmath150 , neither @xmath274 nor @xmath275 is reachable from @xmath276 , otherwise they would also be reachable from @xmath277 because @xmath194 is assumed to avoid @xmath197 . similarly",
    ", neither @xmath274 nor @xmath275 is reachable from @xmath278 . by the induction hypothesis",
    ", @xmath273 have congruent pre - images @xmath279 in which all pairs except @xmath280 avoid each other . noting that @xmath281 starts in @xmath282 , we let @xmath283 consist of @xmath284 concatenated with @xmath281 ( i.e. , @xmath285 ) , let @xmath286 be @xmath287 concatenated with @xmath288 , and similarly for @xmath165 and @xmath171",
    ". since @xmath264 are all congruent , we can apply lemma [ strong - core ] , and conclude that all pairs avoid each other , except the pair @xmath265 .",
    "in the rest of the proof we will show that @xmath197 also avoids @xmath194 , and that @xmath172 also avoids @xmath52 ; in other words , that @xmath224 avoid each other and that @xmath225 avoid each other . by repeated application of lemma [ typer ]",
    "we conclude that there exist congruent walks @xmath264 from @xmath231 to @xmath232 that are pre - images of @xmath220 respectively .",
    "since @xmath194 and @xmath197 are congruent and avoid each other , the walks @xmath289 follow the same sequence of back and forth steps inside @xmath224 , and also avoid each other .",
    "( note that if @xmath289 take a backward step along @xmath224 we can only conclude @xmath283 avoids @xmath286 if we know that also @xmath197 avoids @xmath194 . )",
    "similarly , @xmath290 also avoid each other .",
    "therefore we can now apply lemma [ strong - core ] to @xmath264 and conclude that all pairs from @xmath264 avoid each other , except the pair @xmath265 .",
    "since we have already considered the case when all four walks @xmath220 are strongly constricted from below , we may assume , up to symmetry , that @xmath224 are not strongly constricted from below , i.e. , that there exists a subscript @xmath291 such that @xmath292 $ ] and @xmath293 $ ] have net length zero .",
    "we take the subscript @xmath203 is as large as possible , therefore @xmath294 , b[b_j , b]$ ] are strongly constricted from below and have the same net length as @xmath225 .",
    "we now apply the induction hypothesis to @xmath294 , b[b_j , b ] , c , d$ ] and conclude that @xmath294 , b[b_j , b ] , c , d$ ] have congruent pre - images that pairwise avoid each other ( except for the pre - images of @xmath295 , c$ ] ) .",
    "this implies that @xmath294 , b[b_j , b]$ ] also avoid each other , and @xmath225 also avoid each other .",
    "if @xmath225 were also not strongly constricted from below , we could draw the similar conclusion that @xmath224 avoid each other , as claimed .",
    "however , in general @xmath225 may happen to be strongly constricted from below , and we proceed more carefully as follows : recall that our goal is to prove that @xmath194 and @xmath197 avoid each other .",
    "noting that by the definition of @xmath203 the arcs @xmath296 and @xmath297 are backward arcs ; moreover , the first arcs @xmath298 of @xmath225 are forward arcs .",
    "since @xmath194 avoids @xmath197 and @xmath52 and @xmath172 avoid each other , we can apply lemma [ strong - core ] to @xmath299 , b[b_{j-1},b ] , c_2c_1 + c , d_2d_1 + d$ ] and conclude that @xmath299 , b[b_{j-1},b]$ ] have pre - images that avoid each other , and hence that @xmath299 , b[b_{j-1},b]$ ] also avoid each other .",
    "the idea of the proof is to continue this way backwards on @xmath224 until proving that they avoid each other in their entirety .",
    "thus let @xmath106 be the minimum subscript such that @xmath300 , b[b_i , b]$ ] avoid each other and there exists an @xmath301 such that @xmath302 $ ] has a common pre - image with a walk @xmath303 in @xmath52 that starts in some vertex @xmath304 and ends in @xmath305 ; then @xmath300 $ ] has a common pre - image with @xmath306 .",
    "( of course , this is also a pre - image of @xmath307 $ ] and @xmath308 where @xmath309 is congruent to @xmath303 and starts in @xmath310 and ends in @xmath311 . )",
    "we have just shown that @xmath312 and for @xmath313 we can take @xmath314 . we claim that @xmath315 , which means in particular that @xmath224 avoid each other .",
    "we proceed by contradiction .",
    "let @xmath316 be congruent walks that are pre - images of @xmath300 , b[b_i , b ] , w_c + c , w_d + d$ ] respectively , and denote by @xmath317 the @xmath318-th vertices of these walks respectively .",
    "suppose first that @xmath319 is a forward arc .",
    "we would like to show that @xmath320 , b[b_{i-1},b]$ ] avoid each other and have a common pre - image with @xmath321 that starts in some @xmath322 .",
    "if @xmath323 is also a forward arc , we can set @xmath324 and argue as above , adding @xmath319 to @xmath198 and @xmath325 to @xmath326 .",
    "otherwise , we claim there is another vertex @xmath327 and another walk @xmath328 in @xmath52 that starts in @xmath329 and ends in @xmath305 and has a common pre - image with @xmath302 $ ] , and such that @xmath323 is a forward arc ( so we can proceed as above ) .",
    "note that we have @xmath330 ; we let @xmath318 be the last subscript such that @xmath331 $ ] is constricted from below and has net length zero .",
    "then it is easy to see that @xmath332 is a backward arc .",
    "indeed , the net length of @xmath302 $ ] is strictly negative , as @xmath319 is a forward arc , @xmath194 is constricted , and @xmath333 $ ] has net length zero .",
    "since @xmath198 and @xmath326 are congruent , @xmath334 is also a backward arc , and we can set @xmath335 . it remains to construct a walk @xmath328 in @xmath52 , from @xmath329 to @xmath305 that has a common pre - image with @xmath302 $ ] .",
    "note that the walk @xmath331 $ ] from @xmath330 to @xmath336 is congruent with the walk @xmath337 $ ] from @xmath338 to @xmath339 .",
    "both are constricted from below , and have the same maximum net length of a subwalk ; say @xmath340 $ ] and @xmath341 $ ] are of maximum net length . then applying lemma [ typer ] twice ( once to @xmath340 , z^{-1}[z_t , z_s]$ ] and once to @xmath342 , z[z_t , z_s]$ ]",
    ", we obtain congruent walks @xmath343 from @xmath344 to @xmath344 and from @xmath329 to @xmath304 respectively . then the concatenation @xmath345 is a walk in @xmath52 from @xmath329 to @xmath305 that has a common pre - image @xmath346 with @xmath302 $ ] , as required .",
    "when @xmath319 is a backward arc , the proof is similar . if @xmath323 is also a backward arc , we proceed as usual",
    "otherwise , we let @xmath318 be the last subscript such that @xmath331 $ ] is constricted from above and of net length zero .",
    "this again means that @xmath332 and hence also @xmath334 is a forward arc , and we set @xmath335 . then choosing @xmath347 so that the net length of @xmath340 $ ] is minimized , and applying lemma [ typer ] twice  to @xmath340 , z^{-1}[z_t , z_s]$ ] and to @xmath342 , z[z_t , z_s]$ ] , we obtain congruent walks @xmath343 from @xmath344 to @xmath344 and from @xmath329 to @xmath304 respectively , which yield the walk @xmath348 in @xmath52 from @xmath329 to @xmath305 that has a common pre - image @xmath346 with @xmath302 $ ] , as required .",
    "@xmath82    here is another useful version of the lemma ( cf .",
    "figure [ ms ] ) .        [ m ]",
    "suppose that @xmath349 are integers , @xmath350 is a circuit in @xmath150 , and , for each @xmath351 , @xmath352 are vertices of @xmath1 , and @xmath353 are walks in @xmath1 , such that the following statements hold ( subscript addition modulo @xmath354 ) :    1 .",
    "@xmath355 is a constricted walk from @xmath356 to @xmath357 of net length @xmath301 2 .",
    "@xmath358 is a constricted walk from @xmath359 to @xmath360 of net length @xmath301 3 .",
    "@xmath361 is a constricted walk from @xmath357 to @xmath344 of net length @xmath362 4 .",
    "@xmath363 is a constricted walk from @xmath360 to @xmath344 of net length @xmath362 5 .",
    "@xmath364 is congruent to and avoids @xmath365 6 .",
    "if @xmath366 , then @xmath367    let @xmath52 be any one of the the walks @xmath361 or @xmath363 or @xmath368 or of @xmath369 , and let @xmath172 be any one of the walks @xmath370 or @xmath371 or @xmath372 or of @xmath373 , with @xmath374 .",
    "then @xmath225 have common pre - images that avoid each other .",
    "note that condition 5 implies that @xmath375 in @xmath150 , and therefore condition 6 implies that    1 .   if @xmath376 in @xmath150 , then @xmath377    another way to state the conclusion of the lemma is the following .",
    "_ there are common pre - images of all @xmath378 , such that any two pre - images of walks with different subscripts avoid each other . _    the lemma",
    "will often be used for walks where @xmath379 and/or @xmath380 ( or even @xmath381 ) .     * proof : * we prove the lemma with @xmath382 , and it is easy to check that the proof allows any smaller @xmath383 .",
    "we first prove that any @xmath384 with @xmath374 have common pre - images that avoid each other .",
    "we proceed by induction on @xmath385 .",
    "if @xmath386 , say @xmath387 , we may apply corollary [ strong - core1 ] to the walks @xmath388 .",
    "indeed , @xmath389 avoids @xmath363 and @xmath361 avoids @xmath390 by 5 , and since the same condition also implies that @xmath391 in @xmath150 , condition 6 implies that @xmath392 and @xmath393 , and similarly for @xmath394 .",
    "( here we used the fact that @xmath395 . )    for the induction step , we again assume that @xmath396 and consider @xmath397 . by the induction hypothesis , there are common pre - images of @xmath384 that avoid each other and also common pre - images of @xmath398 that avoid each other . as noted earlier , we may assume that all these pre - images are congruent to each other .",
    "now assume there is a faithful arc from @xmath358 to @xmath399 , or from @xmath399 to @xmath358 .",
    "it is easy to trace walks from @xmath400 on reverses of @xmath384 ( that are known to avoid each other ) up to the faithful arc , use the faithful arc , and then follow the walks @xmath401 , also known to avoid each other to @xmath402 .",
    "this contradicts condition 7 , and completes the induction proof .    a symmetric argument yields that any @xmath403 with @xmath374 have common pre - images that avoid each other .",
    "it now follows that any @xmath404 have common pre - images that avoid each other .",
    "indeed , @xmath405 are congruent by assumption , so it suffices to take the common pre - images of @xmath406 that avoid each other , we have just constructed , and also use the same pre - image for @xmath361 . then if there was a faithful arc between @xmath361 and @xmath371 ( in either direction ) , we could use it to reach @xmath407 from @xmath408 , using the walks @xmath409 a portion of @xmath390 , the faithful arc , and a portion of @xmath371 .",
    "this contradicts condition 6 of the lemma .",
    "( we note that since @xmath410 , we can always choose @xmath411 so that @xmath412 . )",
    "next we argue that for each @xmath413 there are common pre - images to @xmath414 , such that each pair except for the pre - images of @xmath415 and @xmath416 avoid each other .",
    "this will in particular imply that the pre - images of @xmath355 and @xmath416 avoid each other , and the pre - images of @xmath355 and @xmath399 avoid each other .",
    "it will also imply that @xmath417 avoid each other , and thus @xmath418 avoid each other for all @xmath413 .",
    "this will imply the corresponding statements also about their reverses .",
    "for any @xmath374 , consider a new digraph @xmath419 obtained from @xmath1 by the addition of three new vertices @xmath420 and four new arcs @xmath421 .",
    "then in @xmath419 we will apply corollary [ strong - core1 ] to the walks @xmath422 , @xmath423 , to conclude that @xmath424 as well as @xmath425 have common pre - images that avoid each other .",
    "the assumptions of corollary [ strong - core1 ] are easy to check using the statements we have already proved .",
    "for instance , @xmath426 since otherwise we would have @xmath427 .",
    "since we have already proved that @xmath428 avoid each other , this implies that @xmath429 , contradicting assumption 6 of the lemma .        it remains to check the primed walks against the reverses of the unprimed walks .",
    "the arguments are symmetric , we focus on finding common pre - images of @xmath430 .",
    "we again construct a new digraph @xmath419 with added vertices @xmath420 and arcs @xmath431 .",
    "it is again easy to check , from the statements already proved , that corollary [ strong - core1 ] applies to the walks @xmath432 to imply that @xmath361 and @xmath372 avoid each other , and that @xmath361 and @xmath433 as well as @xmath361 and @xmath434 also avoid each other .",
    "in this section we analyze a minimal circuit in @xmath150 under certain conditions and we derive properties of @xmath150 .",
    "we later use them to proof of the correctness of the algorithm .",
    "let @xmath51 be a set of pairs in @xmath435 .",
    "let @xmath436 denote the set of pairs in @xmath150 that are reachable from @xmath51 .",
    "note that @xmath436 includes @xmath51 .",
    "we call @xmath436 the _ out - section _ of @xmath51 .",
    "let @xmath437 be a circuit in @xmath436 .",
    "we say this circuit is _ minimal _ if there is no path from a pair in @xmath51 that can reach to @xmath438 to any of @xmath400 , @xmath439 , @xmath440 .",
    "let @xmath51 be a set of pairs in @xmath150 .",
    "for a pair @xmath441 we may or may not have a path from another pair in @xmath51 to @xmath151 with a positive net value .",
    "if such a path exists we call @xmath151 a _ @xmath442-pair _ with respect to @xmath51 and associate to each @xmath442-pair @xmath151 a path @xmath443 of net value one constricted from below and ending at @xmath151 .",
    "[ itit ] let @xmath51 be a set of pairs in @xmath150 and suppose @xmath436 has a minimal circuit @xmath444 ( @xmath395 ) such that each @xmath445 is a @xmath442-pair with respect to @xmath436 .",
    "there exists another circuit @xmath446 of the pairs in @xmath436 , and walks @xmath447 , in @xmath1 , such that @xmath448 are walks of net length one , constricted from below , @xmath134 from @xmath449 to @xmath344 , @xmath450 from @xmath451 to @xmath452 , and such that @xmath134 and @xmath450 are congruent and avoid each other .",
    "* proof : * let @xmath453 , @xmath454 , be a path from @xmath455 to @xmath445 .",
    "we will find @xmath456 vertices @xmath449 from amongst the @xmath457 vertices @xmath458 which satisfy the conclusion . as an intermediate step",
    ", we will find @xmath456 vertices @xmath459 of the @xmath457 vertices @xmath460 which also yield a circuit in @xmath436 .",
    "for any @xmath103 , if @xmath461 we let @xmath462 and @xmath463 and if @xmath464 we let @xmath465 and @xmath466 .",
    "we first prove that each pair @xmath467 in the circuit @xmath468 can be reached from the corresponding pair @xmath445 .",
    "first consider the case that @xmath469 , in which we have @xmath470 .",
    "we refer to figure [ 3z ] to summarize the steps of the proof .",
    "first of all , we find corresponding vertices @xmath471 so that the green walks @xmath52 from @xmath130 to @xmath344 and @xmath172 from @xmath472 to @xmath452 have net length @xmath473 .",
    "then corollary [ strong - core1 ] is applied to the four green walks @xmath220 , to conclude that @xmath224 avoid each other and @xmath225 also avoid each other .",
    "then we can use lemma [ m ] on the suggested blue walks . specifically , the blue walk from @xmath356 to @xmath84 , then taking @xmath194 to @xmath344 and then use @xmath474 again ; the blue walk from @xmath475 to @xmath71 followed by @xmath476 ; and the blue walk @xmath477 .",
    "we conclude that the walk @xmath474 and the walk @xmath478 concatenated with the walk from @xmath71 to @xmath475 have common pre - images that avoid each other .",
    "thus @xmath479 and @xmath480 . then using similar arguments to the red walks of height @xmath481",
    "we conclude that @xmath482 and from @xmath483 .",
    "this allows us to replace @xmath344 by @xmath359 and @xmath452 by @xmath475 in the circuit @xmath484 .",
    "( the proof in case @xmath469 is symmetric . )    if @xmath485 and @xmath486 , then @xmath487 and @xmath488 .",
    "lemma [ m ] can be similarly used to conclude that @xmath489 .",
    "in fact , by an argument identical to the one in the proof of lemma [ bit ] , as illustrated in the figure [ plusminus ] , one can show , that @xmath490 are all reachable from each other , in fact that the paths depicted in figure [ plusminus ] ( of net length zero , constricted from below ) avoid each other .    in case @xmath491 and @xmath492 , we have @xmath493 , and by using lemma [ m ] in a fashion similar to the above proofs , we conclude easily that there are the walks from @xmath344 to @xmath459 and from @xmath452 to @xmath494 that avoid each other and are of net length zero , constricted from below .",
    "we now show that @xmath495 and @xmath496 are not arcs of @xmath1 , completing the proof of the lemma .",
    "in fact , this has already been observed ( by appealing to the proof of lemma [ bit ] ) for the @xmath103 which have @xmath485 and @xmath486 .    if @xmath469 .",
    "in fact , we assume @xmath497 for some @xmath498 .",
    "note that this means that @xmath499 .",
    "we first note that since @xmath500 and @xmath501 we already know that @xmath502 is not an arc of @xmath1 . by symmetry",
    ", @xmath503 is also not an arc of @xmath1 .",
    "next we argue that @xmath504 is not an arc of @xmath1 as otherwise @xmath505 contradicting the minimality of @xmath456 .",
    "this implies that @xmath506 is not an arc of @xmath1 , as otherwise @xmath507 and eventually @xmath508 ( using lemma [ m ] on suitable portions of the walks ) . the same arguments imply that @xmath509 and @xmath510 , and so on until @xmath511 and @xmath512 .",
    "( these will all be used later . )",
    "now we proceed to show that @xmath513 is not arc of @xmath1 , otherwise @xmath514 ( which we have shown to be reachable from @xmath515 ) can reach @xmath516 because @xmath517 is not an arc of @xmath1 .",
    "this contradicts the minimality of @xmath456 .",
    "note that now we have both @xmath518 and @xmath512 .",
    "the first fact implies that @xmath519 .",
    "the second fact implies that we can repeat the argument to conclude that @xmath520 , and continue the argument in this way , eventually showing that @xmath521 ) and @xmath522 .",
    "it remains to consider those @xmath103 that have @xmath491 and @xmath492 . in this case ,",
    "@xmath523 and @xmath524 .",
    "if @xmath525 , then @xmath526 , and we can use the previous argument to conclude that @xmath506 and @xmath527 are not arcs of @xmath1 .",
    "this implies that @xmath528 is also not an arc of @xmath1 , otherwise the walk @xmath529 avoids the walk @xmath530 and hence the pair @xmath531 @xmath532 , contradicting the minimality of @xmath456 .    on the other hand ,",
    "if @xmath533 we have @xmath534 and we use another previous case to conclude that @xmath535 and @xmath536 are not arcs of @xmath1 , and hence there is walk from @xmath475 to @xmath356 that avoids a walk from @xmath537 to itself , thereby the pair @xmath538 is also in @xmath436 , again yielding a contradiction .",
    "@xmath82 + each unbalanced strong component @xmath52 of @xmath150 contains a directed cycle @xmath172 of non - zero net value @xmath130 , corresponding to two closed walks @xmath539 in @xmath1 , with @xmath540 avoiding @xmath541 , each of net length @xmath130 .",
    "note that @xmath130 could be positive or negative . as observed earlier ,",
    "if @xmath542 , then any extremal vertex @xmath151 of @xmath172 must initiate an infinite directed walk @xmath543 with @xmath544 , continuously winding around @xmath172 in the positive direction , such that the net values of any portion @xmath545 $ ] are non - negative ( the net values are constricted from below ) and unbounded ( for any @xmath546 some @xmath545 $ ] has net value @xmath0 ) .",
    "[ claim ] let @xmath547 be a subset of unbalanced pairs such that if @xmath548 then @xmath549 .",
    "suppose @xmath550 contains a circuit and let @xmath551 be a minimal circuit in @xmath550",
    ". then the following statements hold .    1 .",
    "@xmath395 and there exists a circuit @xmath552 consisting of extremal pairs .",
    "each @xmath445 can be reached from the corresponding @xmath553 by a symmetric walk in @xmath150 with positive net value .",
    "3 .   there are infinite walks @xmath134 , @xmath554 , starting at @xmath555 such that @xmath556 , @xmath557 , avoid each other .",
    "* proof : * for contradiction suppose @xmath178 .",
    "this means @xmath558 for some @xmath548 and @xmath559 for some @xmath560 now by skew symmetry we have @xmath561 , a contradiction unless @xmath562 and @xmath563 and hence @xmath564 , again a contradiction .",
    "therefore @xmath565 .",
    "+ for each @xmath103 , let @xmath566 be the strong component of @xmath150 containing an extremal pair in @xmath51 where @xmath445 is reached from @xmath566 , and let @xmath567 be a directed cycle in @xmath566 .",
    "+    [ bit ]    we may assume each @xmath445 is a @xmath442-pair with respect to @xmath550 .",
    "* proof : * let @xmath453 be a path from @xmath568 to @xmath445 which is constricted from below and has net value one . consider first a subscript @xmath103 such that @xmath567 has positive net value .",
    "then , as observed above , there is an infinite directed walk @xmath161 continuously winding around @xmath567 in the positive direction , whose net values are constricted from below and unbounded . by following @xmath161 as far as necessary and then following a path that lead from @xmath566 to @xmath445 ( such a path exists both when @xmath445 is in @xmath566 or reachable from @xmath566 )",
    ", we obtain a walk @xmath569 in @xmath150 that has values constricted from below .",
    "we let @xmath570 be the last vertex on @xmath569 such that the net value of @xmath571 $ ] is one , and we set @xmath572 $ ] .",
    "let @xmath473 be the maximum net value of a prefix of @xmath573 , i.e. , of a walk @xmath574 $ ] for any @xmath151 .",
    "note that @xmath473 could be one , in case the values of @xmath573 are also constricted from above , i.e. , @xmath573 is just one arc in @xmath150 .",
    "we emphasize for future reference that in this case the walk @xmath573 arises from @xmath569 that started on the cycle @xmath567 .",
    "a similar argument applies to a subscript @xmath103 such that @xmath567 has negative net value , but following the walk @xmath161 discussed above ( unbounded and non - positive ) and then a path from @xmath567 to @xmath445 , we obtain a walk @xmath569 in @xmath150 that has values constricted from above but * not * constricted from below .",
    "indeed , in such a case we can again let @xmath570 be the last vertex on @xmath569 such that the net value of @xmath571 $ ] is one and set @xmath572 $ ] .",
    "suppose next that there are two subscripts @xmath575 ( addition modulo @xmath456 ) such that both @xmath567 and @xmath576 have negative net values , and both @xmath569 and @xmath577 have constricted values , from some pairs @xmath578 to @xmath579 respectively .",
    "we may assume that the pairs @xmath580 are on the cycles @xmath581 , and that the net values of @xmath582 are the same ( by choosing for their starting vertices a suitable extremal vertex on each @xmath567 ) .",
    "in this context , corollary [ strong - core1 ] applies to the four walks @xmath220 in @xmath1 corresponding to @xmath582 , and we conclude that , in particular , @xmath224 avoid each other and @xmath225 avoid each other .",
    "this implies that the reverse traversal of the cycles @xmath581 is also a cycle in @xmath150 , of positive net value , and we can proceed as in the case when @xmath581 had positive net value .",
    "thus it remains to consider the case when @xmath567 has negative net value , and the values of @xmath569 are constricted ( both from below and from above ) , and @xmath583 have positive net values .",
    "we illustrate this part of the proof in figure [ plusminus ] .",
    "each walk in @xmath150 is depicted as two walks in @xmath1 where the first avoids the second .",
    "( the avoided arcs are depicted as dotted lines . )",
    "we show in the figure the starting vertex @xmath584 of @xmath585 , its ending vertex @xmath586 , as well as the starting vertex @xmath587 of @xmath588 , and its ending vertex @xmath589 ) . in the illustration",
    "we assume neither @xmath585 nor @xmath588 is constricted from above .",
    "( the proof in the cases where one or both are constricted is similar and easier . ) without loss of generality , we assume that @xmath590 as depicted . as shown ,",
    "we let @xmath591 be the second vertex of @xmath585 and @xmath592 the second vertex of @xmath588 .",
    "we also show a constricted walk @xmath569 ending in @xmath445 .",
    "we assume @xmath593 is the last vertex on @xmath585 that maximizes the net value of the prefix @xmath594 $ ] , and @xmath595 the last vertex of @xmath569 so that @xmath596 $ ] and @xmath597 $ ] have the same net values .",
    "( note that both these walks have constricted values . )",
    "the walk @xmath585 in @xmath150 corresponds to two walks @xmath598 @xmath599 in @xmath1 , as depicted , where the first avoids the second , in particular @xmath194 avoids @xmath197 and @xmath283 avoids @xmath286 .",
    "( @xmath194 is the portion from @xmath600 to @xmath601 and @xmath283 the portion from @xmath601 to @xmath602 , and similarly for @xmath197 ) .",
    "now we claim the following facts .    1 .",
    "the walks @xmath264 have common pre - images that avoid each other , except for the pre - images of @xmath286 and @xmath165 2 .",
    "the walks @xmath603 and @xmath604 have common pre - images that avoid each other 3 .   the pairs @xmath586 and @xmath605 are reachable from each other 4 .",
    "the walks @xmath604 and @xmath606 have common pre - images that avoid each other 5 .   the pairs @xmath445 and @xmath607 are reachable from each other    item 1 follows directly by lemma [ strong - core ] because the minimality of the circuit @xmath608 @xmath609 implies that @xmath610 or @xmath611 or @xmath612 can not be in @xmath550 .",
    "therefore lemma [ m ] applies to the walks @xmath613 , using the same minimality arguments , verifying items 2 and 4 .",
    "items 3 and 5 follow from 2 and 4 .",
    "items 3 and 5 imply that we can replace @xmath344 by @xmath614 and obtain another circuit of pairs @xmath615 in @xmath550 .",
    "a similar argument shows that we may replace @xmath452 by @xmath616 . in the rest of the proof",
    "we assume that we have made the replacement , i.e. , that @xmath617 .",
    "we now show that , in the new circuit , the path @xmath573 actually exists , namely , that the ( single - arc ) walks @xmath618 and @xmath619 avoid each other , and hence the new @xmath445 and @xmath620 are reachable from each other .",
    "first , we observe that @xmath621 is not an arc , otherwise @xmath622 , contradicting the minimality of the circuit .",
    "then @xmath623 is not an arc , otherwise @xmath624 , yielding the same kind of contradiction .",
    "finally , @xmath625 is not an arc , otherwise @xmath626 is reachable from @xmath587 , and hence @xmath627 , by one more application of lemma [ m ] .",
    "@xmath82    having the vertices @xmath628 , allows us to modify the circuit @xmath629 @xmath609 one step towards satisfying the theorem [ claim ] .",
    "claim [ itit ] has a stronger version as follows :    [ ititit ] for every integer @xmath546 , there exists circuit @xmath630 of pairs in @xmath550 , and walks @xmath631 , in @xmath1 such that each pair @xmath632 are walks of net length @xmath0 constricted from below , @xmath633 is from @xmath634 to @xmath344 , @xmath635 from @xmath636 to @xmath452 , such that @xmath633 and @xmath635 are congruent and avoid each other .",
    "moreover , the walk @xmath637 is a suffix of the walk @xmath638 for each @xmath0 , and similarly for @xmath639 .    by reversing the walks @xmath632 and increasing @xmath0 arbitrarily high , we prove the following fact .    [ iviv ]    there exist infinite walks @xmath640 in @xmath1 , where @xmath242 starts in @xmath344 and @xmath641 starts in @xmath452 such that @xmath642 are congruent and avoid each other .",
    "moreover , the net lengths of these walks are unbounded from below .",
    "consider the set of pairs @xmath643 of corresponding vertices in @xmath642 ; since @xmath642 avoid each other , these pairs @xmath643 are all from the same strong component of @xmath150 as @xmath445 ( which we called @xmath566 ) .",
    "therefore , eventually the same pair @xmath643 is repeated .",
    "this means that each @xmath566 contains a circuit of positive net value .",
    "hence , we may assume that each cycle @xmath567 ( our unbalanced cycle of choice in the component @xmath566 ) is in fact of positive net value .",
    "thus we can avoid the complications in the proof of lemma [ bit ] : the first alternative , that @xmath567 has positive net value , applies in all cases .",
    "this has effect on the walks @xmath644 and also @xmath642 above .",
    "in particular , the corresponding pairs @xmath643 of vertices on walks @xmath642 may be assumed to eventually reach the cycle @xmath567 , and then remain on that cycle .",
    "this uses lemma [ bit ] in conjunction with lemma [ itit ] , continually replacing the circuit until we get a circuit @xmath552 until each @xmath553 is on the cycle @xmath567 in @xmath150 .",
    "moreover , we can continue doing this until @xmath553 is an extremal vertex of @xmath567 .",
    "( recall that there exist @xmath130 extremal pairs , where @xmath130 is the net length of @xmath567 . )    for future reference we note that we can reverse the walks @xmath642 .",
    "[ iviviv ] there exist infinite walks @xmath645 in @xmath1 , where @xmath450 starts in @xmath555 and @xmath646 starts in @xmath647 such that @xmath648 are congruent and avoid each other .",
    "moreover , these walks are constricted from below and their net lengths are unbounded from above .",
    "it is important to note that the walks @xmath648 are obtained by continuously following the cycle @xmath567 in the positive direction .    by applying corollary [ m ] to suitable (",
    "repeated ) increasing prefixes of the walks @xmath648 we can easily conclude that they have pre - images , say @xmath134 , that all avoid each other , except for the corresponding ( intersecting ) walks @xmath649 .",
    "in particular we obtain the following useful conclusion that complete the proof of theorem [ claim ] ( 3 ) : + * there are infinite walks @xmath650 , in @xmath567 , starting in @xmath555 , that all avoid each other .",
    "* @xmath82    [ no - path - from - ai - aj ] let @xmath547 be a subset of unbalanced pairs such that if @xmath548 then @xmath549 .",
    "suppose @xmath550 contains a circuit and let @xmath551 ( @xmath565 ) be a minimal circuit in @xmath550 .",
    "then there is no path in @xmath150 from @xmath445 to any of @xmath651 , @xmath652 .",
    "* proof : * by theorem [ claim ] both pairs @xmath653 are extremal pairs on cycles @xmath567 and @xmath654 respectively .",
    "let @xmath161 be the walk from @xmath553 to @xmath655 we may assume that @xmath567 is constricted from above .",
    "otherwise we add to the beginning of @xmath161 a walk @xmath656 obtained by going around the cycle @xmath567 ( in negative direction ) sufficiently many times and adding to the end of @xmath161 walk @xmath657 obtained by going around the cycle @xmath654 ( in negative direction ) sufficiently many times ( this is possible since @xmath658 avoid each other , and @xmath659 avoid each other ) .",
    "let @xmath660 .",
    "consider two vertices @xmath661 and @xmath662 .",
    "where the portion of @xmath663 $ ] and @xmath664 $ ] are congruent ( avoid each other ) and have the same net value as @xmath161 . now by corollary [ strong - core1 ] we conclude that @xmath665 and @xmath666 avoid each other",
    ". therefore @xmath553 and @xmath667 are in the same strong component .",
    "thus by we may assume that @xmath567 is the cycle that contains both @xmath653 ( we replace @xmath567 by a cycle that goes around @xmath567 ( in positive direction ) sufficiently many times and then it follows @xmath161 to @xmath667 and then going around @xmath654 once and then back to @xmath553 on @xmath668 ) .",
    "observe that @xmath567 now has net value greater than @xmath669 .    by theorem [ claim ] ( 2 ) the walks",
    "@xmath134 and @xmath670 around @xmath567 avoid each other and we can apply corollary [ circuit - cycle ] to conclude that some component of @xmath150 contains a circuit , a contradiction . by similar argument from from the previous proposition",
    "we have the following .",
    "there is no path in @xmath150 from @xmath611 to @xmath445 , and in particular there is no path from @xmath671 to @xmath609 .",
    "@xmath82 + the following proposition will be used in the last section .",
    "recall that we have denoted by @xmath566 the ( strong ) component of @xmath150 containing the pair @xmath445 .",
    "a digraph is _ symmetric _ if for each arc @xmath81 the arc @xmath85 is also present .",
    "[ all - avoid - in - di ] let @xmath547 be a subset of unbalanced pairs such that if @xmath548 then @xmath549 .",
    "suppose @xmath550 contains a circuit and let @xmath551 ( @xmath565 ) be a minimal circuit in @xmath550 .",
    "then each component @xmath566 is a symmetric digraph .     *",
    "proof : * we will show that every walk @xmath656 in @xmath566 from some @xmath672 to @xmath445 consists of two walks , @xmath198 from @xmath99 to @xmath344 and @xmath201 from @xmath673 to @xmath452 , that avoid each other . since every arc of @xmath566 lies on a such a walk , this proves the proposition . by theorem [ claim ] ( 2 ) , there exists a circuit @xmath674 of extremal pairs where @xmath675 are in the same component @xmath566 .",
    "recall that @xmath553 lies on @xmath567 ( which is a closed walk of positive net value ) .",
    "we also note by theorem [ claim ] ( 3 ) that @xmath658 are obtained by repeatedly following cycle @xmath567 in positive direction ( see also claim [ iviviv ] ) .",
    "consider a walk @xmath161 from @xmath553 to @xmath672 in @xmath566 that has a negative net value and it is constricted from above .",
    "such a walk is obtained by starting at @xmath553 and going around the cycle @xmath567 in negative direction sufficiently many times and then going to @xmath672 ) .",
    "now consider the walk @xmath656 going from @xmath672 to @xmath553 and then following the walk @xmath657 around the cycle @xmath567 in the negative direction , so that @xmath676 is constricted and has negative net value , ( again this can be obtained by going around @xmath567 in negative direction sufficiently many times ) .",
    "the walk @xmath676 gives two constricted walks @xmath224 from some @xmath677 to @xmath677 respectively , where @xmath194 avoids @xmath197 .",
    "now let @xmath225 be two walks from @xmath678 to @xmath679 respectively , that avoid each other and have the same negative net value as @xmath194 .",
    "( we may assume @xmath680 and @xmath681 ) .",
    "now by corollary [ strong - core1 ] we conclude that @xmath224 avoid each other and hence the walks @xmath198 and @xmath201 constituting @xmath656 avoid each other .",
    "this implies that @xmath566 is symmetric .",
    "a strong component of @xmath150 is _ balanced _ if every closed directed walk in that component has net value zero , i.e. , the same number of positive and negative arcs .",
    "a pair of @xmath150 is called balanced if it lies in a balanced strong component .",
    "let @xmath682 be the sub - digraph of @xmath150 induced by balanced pairs .",
    "the pairs in @xmath682 can be assigned _ levels _ so that if @xmath683 is a positive arc in @xmath150 , then the level of @xmath672 is one more than the level of @xmath684 , and if @xmath683 is a negative arc in @xmath150 , then the level of @xmath672 is one less than the level of @xmath684 .",
    "[ good - set ] we say a set @xmath547 of the pairs in @xmath150 is _ good _ if it has the following properties :    1 .",
    "if @xmath548 then @xmath549 2 .",
    "there is a vertex of @xmath685 on level @xmath301 and for all pairs @xmath151 of @xmath547 with level @xmath686 either @xmath687 or @xmath688 .",
    "recall that @xmath550 is the set of pairs that are reachable from @xmath547 .",
    "[ structure - balanced - circuit ] let @xmath689 be a set of pairs satisfying the property ( 2 ) of a good set .",
    "let @xmath547 be a good subset of @xmath689 consisting of all the pairs of @xmath689 that are on lower level than @xmath301 .",
    "suppose @xmath690 contains a circuit , and let @xmath551 be a minimal circuit in @xmath550",
    ". then one the following statements holds .",
    "1 .   @xmath178 and there exists @xmath691 such that @xmath692 2 .",
    "@xmath395 and if @xmath693 are @xmath442-pairs with respect to @xmath550 then there is no path in @xmath150 from @xmath694 to any of @xmath695 and @xmath696 .",
    "* proof : * if @xmath178 then there exists @xmath697 such that @xmath698 and @xmath699 . now",
    "we also notice that by he assumption for @xmath547 , @xmath700 .",
    "therefore we get a contradiction .",
    "it is easy to see that if @xmath395 then the circuit is on level @xmath301 of @xmath682 , i.e. the pairs of the circuit that belong to @xmath682 are on level @xmath301 .",
    "first we note that @xmath694 is not a @xmath442-pair . otherwise according to assumptions for @xmath547 , @xmath701 , and",
    "hence we get a shorter circuit .",
    "we may assume @xmath702 .",
    "now we show that @xmath703 .",
    "let @xmath570 be the first vertex on @xmath704 and @xmath408 be the second vertex and we may assume that @xmath705 $ ] has net value zero and constricted from below ( note that we use the notation used in the lemma [ itit ] and most of the argument for this case is similar to argument in lemma [ itit ] ) . by the argument similar to the one in lemma [ itit ] it follows that @xmath706 is not an arc of @xmath1 ( as otherwise @xmath707 and also @xmath708 are in the same strong component and hence @xmath709 exists , a contradiction ) .",
    "moreover , @xmath710 as otherwise @xmath711 . observe that as it shown in lemma [ itit ] @xmath712 are in the same strong component of @xmath150 . now",
    "@xmath713 , and @xmath714 .",
    "therefore for some @xmath715 we have @xmath716 , a contradiction .",
    "note that @xmath717 ( since @xmath706 is not an arc ) .",
    "now @xmath570 and @xmath587 are in @xmath436 since they are on a lower level than @xmath301 and therefore @xmath718 or @xmath719 ( the former is not possible as it would imply a circuit of level @xmath686 in @xmath689 , a contradiction to @xmath689 being a good set ) .",
    "thus we have @xmath720 .",
    "now @xmath721 and ( as shown in lemma [ itit ] , @xmath708 are in the same strong component of @xmath150 ) .",
    "therefore @xmath722 .",
    "thus @xmath694 is a @xmath442-pair , a contradiction .",
    "+ we note that if @xmath696 is a @xmath442-pair then we according to lemma [ itit ] there is a circuit on a lower level of @xmath682 .",
    "thereofer @xmath696 is not a @xmath442-pair .",
    "we also note @xmath723 as otherwise @xmath724 and hence @xmath696 is a @xmath442-pair , a contradiction .",
    "similarly @xmath725 .",
    "now suppose @xmath726 and there exits a path @xmath161 from @xmath694 to @xmath696 . since neither of @xmath727 is a @xmath442-pair , @xmath161 is constricted from below .",
    "let @xmath728 be the height of @xmath704 and @xmath729 be the height of @xmath730 and assume @xmath731 ( the argument for @xmath732 is symmetric ) .",
    "as we showed we have @xmath733 .",
    "now by applying the lemma [ strong - core1 ] on suitable portion of @xmath730 and @xmath161 we conclude that @xmath734 avoid each other where @xmath735 .",
    "this would mean @xmath694 and @xmath696 are in the same strong component of @xmath150 , a contradiction to the choice of @xmath547 .",
    "@xmath82 + the stronger version of theorem [ structure - balanced - circuit ] is the following corollary .",
    "[ strong - structure - balanced ] let @xmath689 be a set of pairs satisfying the property ( 2 ) of a good set .",
    "let @xmath547 be a good subset of @xmath689 consisting of all the pairs of @xmath689 that are on lower level than @xmath301 .",
    "suppose @xmath736 , @xmath737 are @xmath442-pairs in @xmath689 .",
    "then there is no path in @xmath150 from @xmath738 , @xmath739 , to @xmath740 , @xmath741 .",
    "* proof : * by comparing the height of the path from @xmath738 to @xmath740 and the height of @xmath742 , and applying similar argument as in the proof of theorem [ structure - balanced - circuit ] , we get a contradiction .",
    "@xmath82 + following the proof of the lemma [ itit ] one can obtain the following corollary .    [ on - the - same - level - circuit ] let @xmath51 be a set of pairs .",
    "suppose @xmath436 contains a circuit and let @xmath743 ( @xmath395 ) be a minimal circuit in @xmath436 .",
    "if @xmath445 is a @xmath442-pair with respect to @xmath436 then let @xmath408 be the second vertex on @xmath704 otherwise let @xmath744 be a constricted walk from below of net value zero from @xmath745 to @xmath445 ( @xmath744 could be just a path in strong component containing @xmath445 .",
    "then there exists another circuit @xmath746 of pairs , and walks @xmath747 , in @xmath1 , such that @xmath748 are walks of net length zero , constricted from below , @xmath749 from @xmath750 to @xmath344 , @xmath450 from @xmath751 to @xmath452 , and such that @xmath749 and @xmath752 are congruent and avoid each other . here",
    "each @xmath753 is either @xmath408 or @xmath754 or @xmath755 or @xmath756 .",
    "[ not - imply - two ] let @xmath51 be a set of pairs .",
    "suppose @xmath436 contains a circuit and let @xmath743 , ( @xmath757 ) be a minimal circuit in @xmath436 let @xmath758 be a walk from @xmath759 to @xmath445 of net value zero and let @xmath760 be a walk from @xmath277 to @xmath589 of net value zero",
    ". then at least one of the @xmath761 is not constricted from below .",
    "* proof : * for contradiction @xmath758 and @xmath760 both are constricted from below .",
    "we may assume @xmath729 the height of @xmath758 is at most @xmath762 ; the height of @xmath760",
    ". now by corollary [ on - the - same - level - circuit ] and the proof of the lemma [ itit ] @xmath763 are in the same strong component , a contradiction . similarly if @xmath764 then @xmath765 and @xmath766 are in the same strong component of @xmath150 , a contradiction .",
    "@xmath82    [ 3-source - balanced ] let @xmath767 be three vertices such that there exist a path @xmath768 in @xmath150 from @xmath769 to @xmath151 and there exists a path @xmath770 in @xmath150 from @xmath771 to @xmath772 where both @xmath773 are constricted from below and have net value zero .",
    "then there is no path @xmath774 in @xmath150 from @xmath775 to @xmath776 which is contracted from below and has net value zero .",
    "* proof : * suppose this is not the case and @xmath774 exists . up to symmetry suppose @xmath777 the height of @xmath774 is bigger than @xmath778 the height of @xmath770 respectively .",
    "we observe that @xmath779 and @xmath780 . for contradiction suppose @xmath781 .",
    "let @xmath782 and now there is a circuit @xmath783 in @xmath550 .",
    "since @xmath784 and @xmath781 , we get a contradiction by corollary [ not - imply - two ] .",
    "similarly @xmath779 .",
    "these would also imply that @xmath785 and @xmath786 . by the symmetry @xmath787 ,",
    "@xmath788 and @xmath789 , @xmath790 .",
    "let @xmath791 and @xmath792 and let @xmath593 be a vertex on @xmath774 where @xmath793 $ ] is constricted from above and has height @xmath794 .",
    "let @xmath793= ( a_2,a_0)$ ] .",
    "now by applying corollary [ strong - core1 ] on @xmath795 we conclude that @xmath796 avoid each other . this would imply that @xmath772 and @xmath771 are in the same strong component of @xmath150 , contradiction . @xmath82",
    "we are now ready to claim the converse of theorem [ inv ] .",
    "[ main ] a digraph @xmath1 admits a min ordering if and only if no strong component of the pair digraph @xmath150 contains a circuit .    to prove the converse",
    ", we introduce an algorithm to construct a min ordering @xmath37 of @xmath1 , provided no strong component of the pair digraph @xmath150 contains a circuit",
    ". this will prove theorem [ main ] .",
    "thus we shall assume that no strong component of @xmath150 contains a circuit .    at each stage of the algorithm",
    ", there are some pairs of @xmath150 that have been _ chosen _ , and others that have been _",
    "discarded_. let @xmath797 denote the set of chosen pairs , and @xmath798 the set of discarded pairs ; the pairs in the set @xmath799 are called the _ remaining _ pairs .",
    "initially we will have @xmath800 , and throughout the algorithm we will maintain the following properties :    * @xmath801 if and only if @xmath802 ; * if @xmath801 and @xmath803 then @xmath804 ;    consequently , we will always have @xmath805 , and each strong component of @xmath150 lies entirely in one of the three sets @xmath806 .",
    "moreover , at the end of the algorithm the set @xmath51 will be empty and we will have the following additional property :    * if @xmath801 and @xmath807 then @xmath808    a step of the algorithm will consist of _ selecting _ one vertex @xmath809 to be chosen ( moving @xmath684 to @xmath797 ) , and choosing all pairs @xmath810 that can be reached from @xmath684 in @xmath150 .",
    "( it is easy to check that a vertex that can be reached from @xmath809 in @xmath150 can not be in @xmath798 : otherwise @xmath811 can reach @xmath812 , thus @xmath813 , contradicting @xmath810 . ) so we use the term _ selected vertex _ for this special vertex , and the term _ selected _ strong component for the strong component of @xmath150 containing the selected vertex .",
    "recall that a strong component of @xmath150 is _ balanced _ if every closed directed walk has net value zero , i.e. , the same number of positive and negative arcs .",
    "a pair of @xmath150 is called balanced if it lies in a balanced strong component .",
    "let @xmath682 be the sub - digraph of @xmath150 induced by balanced pairs .",
    "the pairs in @xmath682 can be assigned _ levels _ so that if @xmath683 is a positive arc in @xmath150 , then the level of @xmath672 is one more than the level of @xmath684 , and if @xmath683 is a negative arc in @xmath150 , then the level of @xmath672 is one less than the level of @xmath684 .",
    "recall that a strong component of @xmath150 is _ balanced _ if every closed directed walk has net value zero , i.e. , the same number of positive and negative arcs .",
    "let @xmath682 be the set of balanced components in @xmath150 .",
    "the pairs in @xmath682 can be assigned _ levels _ so that if @xmath683 is a positive arc in @xmath150 , then the level of @xmath672 is one more than the level of @xmath684 , and if @xmath683 is a negative arc in @xmath150 , then the level of @xmath672 is one less than the level of @xmath684 .    in each unbalanced strong component @xmath52",
    "we have a cycle @xmath814 of non - zero net value .",
    "we denote by @xmath815 the set of all extremal pairs of the cycle @xmath814 .",
    "a vertex @xmath816 is a _ source _ for a set @xmath817 , if for every vertex @xmath818 we have the following property :    * no @xmath819 is reachable from any @xmath809 in @xmath150    let @xmath820 .",
    "we say @xmath284 is a source for @xmath51 _ with respect to _ @xmath197 when for every @xmath759 there is no chain of pairs @xmath821 all in @xmath197 .",
    "construct @xmath150 and compute its ( strong ) components return false set @xmath51 = the set of all extremal pairs extremal pairs are in unbalanced components set @xmath800 find a source @xmath284 for @xmath51 move all pairs from @xmath51 reachable from @xmath277 to @xmath797 move all pairs from @xmath51 that can reach @xmath822 to @xmath798    construct @xmath682 , set @xmath823 , and compute the levels of all pairs    set @xmath51 = the set of all pairs at the lowest level @xmath301 of @xmath824 , and remove them from @xmath824 find a source @xmath284 for @xmath51 with respect to @xmath825 move all pairs from @xmath51 reachable from @xmath277 to @xmath797 move all pairs from @xmath51 that can reach @xmath822 to @xmath798    note that the moves in lines 10,11,18,19 mean remove the moved vertices from the set @xmath51 .",
    "we will show that a source exists for any of the sets @xmath51 encountered by the algorithm .",
    "proposition [ phase1 ] shows this for the first phase of the algorithm , handling unbalanced strong components ( lines 4 - 11 ) .",
    "it also shows that that throughout this phase the set @xmath797 does not contain a circuit .",
    "proposition [ phase2 ] similarly handles the second phase ( lines 12 - 19 ) , handling the remaining balanced components of @xmath150 .",
    "in other words , the set @xmath797 does not contain a circuit throughout the execution of the algorithm .    at the end of the algorithm we exactly one pair from each @xmath168 is chosen ( present in @xmath797 ) . recall",
    "that the choices ensure that if @xmath826 and it has an arc to @xmath158 in @xmath150 , then @xmath827 as well .",
    "we define a binary relation @xmath37 by setting @xmath174 if @xmath826 .",
    "since there is no circuit among the chosen pairs , the relation @xmath37 is transitive , and hence a total order .",
    "moreover , @xmath37 is a min ordering . indeed , suppose @xmath828 and @xmath829 but @xmath137 .",
    "note that @xmath830 has an arc to @xmath831 in @xmath150 ; thus since @xmath832 , the pair @xmath833 , and so @xmath831 should have been in @xmath797 as well , contrary to @xmath834 .    in what follows",
    "we assume that there is no circuit in a strong component of @xmath150 .",
    "we say a pair @xmath835 in an unbalanced strong component of @xmath150 is _ half extremal _ if at least one of the @xmath836 is extremal .    [ no - circuit - in - hat - of - sources ] suppose @xmath837 and @xmath838 consisting of half extremal pairs in @xmath150 .",
    "suppose @xmath839 , @xmath840 , is a source for @xmath646 consisting of all pairs in @xmath824 that involves only vertices @xmath841 .",
    "then @xmath842 has no circuit .",
    "* proof : * for contradiction suppose @xmath842 contains a minimal circuit @xmath843 . since each @xmath646 has a source , it is easy to see that @xmath395 .",
    "according to the theorem [ claim ] there exists another circuit @xmath674 where each @xmath553 is extremal and lies in the directed cycle @xmath567 in a strong component of @xmath150 . by theorem",
    "[ claim ] , @xmath844 are in the same strong component of @xmath150 .    by theorem [ claim ]",
    "( 2 ) we observe that for every @xmath845 , @xmath846 is in an unbalanced component .",
    "therefore if one of the @xmath847 s is a source for some @xmath646 then it would mean we have @xmath848 as well , yielding a shorter circuit .",
    "if none of @xmath849 s is a source then each @xmath553 is in some strong component @xmath566 where it has an extremal pair @xmath277 and @xmath284 was a source for some @xmath850 where @xmath203 is the minimum subscript .",
    "now by proposition [ all - avoid - in - di ] we may assume that @xmath277 and @xmath553 lies on the same cycle @xmath567 ( this can be assumed by starting from @xmath553 and go around @xmath567 and then to @xmath277 on the path in @xmath566 and then back on the same path ( the arcs in @xmath566 are symmetric by corollary [ all - avoid - in - di ] ) to @xmath445 ) .    by applying the corollary [ ititit ] sufficiently many times ( the net value between @xmath277 and @xmath553 in @xmath567 )",
    "we may assume that there exist another circuit such that @xmath851 is one of the pair of the circuit and @xmath852 and @xmath851 are in the same strong component .",
    "since @xmath203 is the minimum subscript , there does not exist @xmath853 such that @xmath854 are the pairs of this circuit .",
    "this means that @xmath178 .",
    "in this case we have @xmath855 and @xmath856 .",
    "now by skew symmetry we have @xmath857 contradiction to @xmath284 being a source for @xmath850 . @xmath82    [ there - is - source ] any set of half extremal pairs such that @xmath809 implies that @xmath858 has a source .",
    "* proof : * let @xmath94 be the set of vertices of @xmath1 that appear , as a first or second coordinate , in pairs of @xmath51 .",
    "we use induction on @xmath859 .",
    "we first observe that if @xmath860 , then @xmath51 has a source . indeed , suppose @xmath861 . if @xmath862 is not a source for @xmath51 , we must have both @xmath863 in @xmath51 and @xmath864 reachable from @xmath865 in @xmath150 ; and if @xmath866 is not a source for @xmath51 we also must have @xmath865 reachable from @xmath864 in @xmath150 .",
    "this would mean that @xmath867 is an invertible pair , i.e. , a circuit in a strong component of @xmath150 , a contradiction .",
    "thus there is a source for @xmath51 .",
    "assume the statement for any set of size @xmath118 and let @xmath94 have @xmath868 elements say @xmath869 . for simplicity",
    "when we say @xmath870 is a source for @xmath871 , we mean @xmath115 is a source for all the pairs @xmath809 where @xmath872 . by induction hypothesis",
    "we may assume that @xmath862 is a source for @xmath873 .",
    "observe that there exists @xmath874 such that @xmath839 , @xmath875 is a source for @xmath876 and @xmath839 , @xmath877 is a source for @xmath841 and @xmath84 is a source for @xmath878 .",
    "by induction hypothesis the set @xmath879 has a source .",
    "now if @xmath880 then @xmath866 is a source for @xmath94 . this is because if @xmath881 then either @xmath882 or @xmath883 and hence @xmath884 must be in @xmath51 .",
    "we say @xmath885 are _ not exchangeable _ if @xmath886 and @xmath887 , @xmath888 .",
    "if @xmath885 are exchangeable then we can assume that @xmath889 is also source for @xmath890 .",
    "otherwise we must have @xmath891 and hence @xmath885 are not exchangeable .    now suppose @xmath862 is not a source for @xmath94 as otherwise we are done .",
    "this would mean @xmath892 where @xmath893 . since @xmath862 is a source for @xmath873 , either @xmath894 or @xmath895 .",
    "if @xmath896 then we may assume @xmath897 where @xmath301 is the smallest subscript .",
    "we also assume @xmath84 is not a source for @xmath94 as otherwise we are done .",
    "therefore there is a path in @xmath150 from @xmath898 to @xmath899 where @xmath900 and @xmath901 .",
    "we may assume that @xmath203 is a minimum subscript .",
    "let @xmath902 where @xmath903 and @xmath904 , @xmath905 are not exchangeable and @xmath906 are not exchangeable and @xmath907 is the smallest subscript .",
    "we may assume that @xmath908 as otherwise we can exchange @xmath909 .",
    "note that when @xmath910 we have @xmath911 and hence in this case we may assume that @xmath130 is the smallest subscript . in what follows",
    "we may assume that @xmath912 .",
    "the case @xmath910 is easier and is handled by similar argument for @xmath913 .",
    "no we may assume that @xmath914 is the minimum subscript .",
    "this would mean we assume that @xmath915 as otherwise we would exchange @xmath914 with @xmath916 and continuing exchanging @xmath914 with the previous element . by continuing this argument",
    "we may assume that @xmath917 is @xmath918 and so on .",
    "therefore we may assume that @xmath908 , @xmath919 , @xmath920 , @xmath921 and @xmath922 .",
    "this means @xmath923 .",
    "* @xmath924 .",
    "now there exists a circuit @xmath925 in @xmath926 .",
    "either @xmath164 is a minimal circuit and has length more than two or @xmath927 , @xmath928 . in the former case",
    "we have @xmath927 and we also had @xmath929 .",
    "these would imply that @xmath930 , a contradiction to @xmath842 does not have a circuit according to lemma [ no - circuit - in - hat - of - sources ] . here",
    "@xmath931 .",
    "we continue by assuming @xmath164 is minimal .",
    "this means we may assume @xmath932 , @xmath933 .",
    "moreover , @xmath934 as otherwise we have a circuit in @xmath842 .",
    "however , there exists a path from @xmath929 .",
    "this is a contradiction by lemma [ no - path - from - ai - aj ] . + * case 2 .",
    "* @xmath935 .",
    "first suppose @xmath936 .",
    "we may assume that @xmath84 is on the its latest position . by",
    "that we mean @xmath84 can not be exchanged with @xmath937 .",
    "this means that @xmath938 are not exchangeable and hence similar to the previous case there exists a circuit @xmath939 in @xmath940 .",
    "however , since @xmath941 , we get a contradiction by lemma [ no - path - from - ai - aj ] .",
    "similar argument would apply when @xmath942 . @xmath82    [ phase1 ] in every execution of line 5 of the algorithm , the set @xmath51 has a source .",
    "thus we can always execute line 8 of the algorithm .",
    "moreover , after executing the loop in lines 9 - 11 , the set @xmath797 will not contain a circuit .",
    "* proof : * note that at each stage of the algorithm the set @xmath51 in lines @xmath943 has all the remaining extremal pairs and hence set @xmath944 is the set of all remaining half extremal pairs . by lemma [ there - is - source ] , @xmath547 has a source and hence @xmath51 has a source .",
    "now it is easy to see that @xmath797 is @xmath842 where @xmath824 satisfies the conditions of lemma [ no - circuit - in - hat - of - sources ] .",
    "therefore @xmath797 will not contain a circuit . @xmath82",
    "[ phase2 ] any set of pairs on a level @xmath301 of @xmath682 has a source with respect to @xmath797 .",
    "thus we can always execute line 16 of the algorithm .",
    "moreover , after executing the loop in lines 17 - 19 , the set @xmath797 will not contain a circuit .",
    "* proof : * we first show the following fact .",
    "let @xmath945 be a chain of pairs in @xmath797 , each being a @xmath442-pair with respect to @xmath797 .",
    "then each @xmath839 , @xmath840 , is a source for @xmath646 consisting of all pairs @xmath946 , @xmath947 .",
    "otherwise suppose @xmath839 is not a source for @xmath646 .",
    "therefore @xmath948 , @xmath949 . but",
    "this is a contradiction according to corollary [ strong - structure - balanced ] .",
    "let @xmath950 and let @xmath951 be the set of all pairs @xmath946 , @xmath952 , of @xmath150 such that @xmath946 is either a @xmath442-pair with respect to @xmath797 or @xmath946 is on level @xmath301 of @xmath682 .",
    "suppose @xmath953 , @xmath840 , is a source for @xmath242 consisting of all pairs in @xmath951 that involves only vertices @xmath841 .",
    "we also assume @xmath951 has the following property .",
    "@xmath951 contains all the pairs @xmath151 that are @xmath442-pairs with respect to @xmath797 .",
    "it contains the pairs @xmath151 where there is a chain @xmath954 of all @xmath442-pairs with respect to @xmath797 and lastly it contains some pairs @xmath151 on level @xmath301 of @xmath682 with priority given to @xmath151 such that @xmath955 if one exists .",
    "let @xmath956 be any vertex in @xmath957 where @xmath958 for any @xmath959 , @xmath960 is on level @xmath301 of @xmath682 .",
    "moreover if there are several such @xmath956 we chose @xmath956 such that @xmath961 if one exists .",
    "let @xmath962 be the set of all pairs @xmath963 , @xmath964 , each on level @xmath301 of @xmath682 .",
    "then @xmath962 has a source with respect to @xmath951 .",
    "* proof : * for contradiction suppose there is no source for @xmath962 .",
    "since @xmath956 is not a source , we have @xmath965 , @xmath966 .",
    "suppose also @xmath862 is not a source for @xmath967 .",
    "therefore we have @xmath892 where @xmath968 .",
    "moreover since @xmath969 , @xmath970 , @xmath971 as otherwise @xmath972 .",
    "similarly @xmath882 as otherwise when @xmath973 we have @xmath974 and hence @xmath975 .",
    "to summarize we have @xmath961 and @xmath965 . +",
    "* case 1 . * @xmath910 .",
    "we have @xmath976 .",
    "now we have @xmath977 .",
    "now there is a circuit @xmath978 in @xmath967 . by definition @xmath979",
    "and hence we may assume @xmath980 as otherwise we get a shorter circuit .",
    "to summarize , we have @xmath981 .",
    "now there exists a circuit @xmath982 in @xmath967 .",
    "note that we may assume at least one of the @xmath983 is not a @xmath442-pair with respect to @xmath797 .",
    "otherwise we get a circuit on a lower level of @xmath797 by lemma [ itit ] .",
    "moreover we may assume at least one of the @xmath984 is not a @xmath442-pair with respect to @xmath797 .",
    "first suppose two of the three pairs in @xmath52 are @xmath442-pairs with respect to @xmath797 , say @xmath985 .",
    "now all the pairs of @xmath797 together with three pairs @xmath986 satisfies the conduction of theorem [ structure - balanced - circuit ] . since @xmath961",
    ", we get a contradiction by theorem [ structure - balanced - circuit ] .",
    "now we may assume that at most one of the pairs in @xmath52 is a @xmath442-pair with respect with @xmath797 .",
    "note that this means none of @xmath984 is a @xmath442-pair .",
    "therefore the path from @xmath987 to @xmath988 and the path from @xmath987 to @xmath960 are constricted from below and have net value zero .",
    "now let @xmath547 be the set of @xmath989 .",
    "it is easy to see that circuit @xmath52 is minimal in @xmath550 and since @xmath990 , and @xmath961 , we get a contradiction by corollary [ not - imply - two ] . + * case 2 .",
    "* @xmath991 .",
    "first assume that @xmath992 .",
    "note that @xmath993 so in this case we may assume @xmath994 .",
    "this means we have @xmath995 .",
    "if @xmath865 is not a @xmath442-pair with respect to @xmath797 then @xmath996 according to the choice of @xmath951 ( we have @xmath961 ) and we get a contradiction by lemma [ 3-source - balanced ] .",
    "so we may assume that @xmath865 is a @xmath442-pair with respect to @xmath797 .",
    "now again by similar argument as in the proof of lemma [ 3-source - balanced ] ( considering the height of the path from @xmath864 to @xmath865 and the height of the path from @xmath987 to @xmath960 and the height of @xmath997 ) we get a contradiction",
    ".    therefore @xmath998 .",
    "note that @xmath999 .",
    "now we have the circuit @xmath1000 in @xmath1001 .",
    "since @xmath1002 , we may assume that @xmath1003 is a circuit in @xmath967 .",
    "for simplicity we may assume @xmath994 .",
    "we note that @xmath758 which is a path in @xmath150 from @xmath987 to @xmath960 is constricted from below and has net value zero .",
    "also @xmath1004 which a the path in @xmath150 from @xmath1005 to @xmath1006 is constricted from below and has net value zero .",
    "first assume that the height of @xmath758 is smaller than the height of @xmath1004 .",
    "now consider the set @xmath1007 and observe that there is a circuit @xmath1008 in @xmath550 .",
    "similar to the proof of lemma [ 3-source - balanced ] ( by applying lemma [ m ] ) we conclude that @xmath1009 are in the same strong component of @xmath150 , a contradiction .",
    "therefore we may assume that the height of @xmath758 is greater than the height of @xmath1004 .",
    "now consider the circuit @xmath1010 is @xmath550 where @xmath1011 .",
    "therefore again by similar argument as in the proof of lemma [ 3-source - balanced ] , we conclude that the two walks of @xmath1012 in @xmath1 where @xmath1013 avoid each other . by lemma [ m ] on suitable portion of @xmath1012 and",
    "the walks in @xmath1 that give rise to @xmath758 ( and the fact that @xmath1012 avoid each other ) , we conclude that @xmath1014 , implying that @xmath1015 , a contradiction . @xmath82",
    "+ the above claim allows us to view remaining balanced pairs on level @xmath301 step by step and at each step we show that there is a source for a subsets of unbalanced pairs on level @xmath301 .    after executing the loop in lines 17 - 19",
    ", the set @xmath797 will not contain a circuit .",
    "* proof : * suppose by selecting a pair @xmath151 on level @xmath301 at some stage of the algorithm ( from line 17 to 19 ) we close a circuit @xmath350 .",
    "we again suppose that up to this point no circuits were created , and that @xmath456 is as small as possible .",
    "if @xmath445 is not a @xmath442-pair then let @xmath408 be a selected vertex on level @xmath301 where @xmath1016 and let @xmath569 be a walk from @xmath408 to @xmath445 and we may assume that @xmath569 reaches to the maximum height .",
    "if @xmath1017 is a @xmath442-pair then let @xmath1018 be a vertex on the level @xmath301 such that the portion of @xmath1019 from @xmath1020 to @xmath1017 is constricted from below and has net value zero .",
    "let @xmath473 be the height of @xmath569 and @xmath1021 be the height of @xmath1022 minus one .",
    "let @xmath1023 be a pair where @xmath1024 is the source .",
    "this means for every other @xmath1025 the algorithm selects @xmath1026 before @xmath1027 which contains @xmath1025 .",
    "now as we argued in the unbalanced case and according to corollary [ on - the - same - level - circuit ] there exists another circuit @xmath1028 where @xmath467 is already chosen or is selected ( belongs to @xmath797 ) .",
    "note that @xmath1029 is a subset of @xmath1030 .",
    "however , according to the choice of @xmath1031 there must be a source in @xmath547 but this is a contradiction to having a source . @xmath82",
    "a @xmath0-_min ordering _ of a digraph @xmath1 is a partition of @xmath17 into @xmath0 subsets @xmath1032 , and a linear ordering @xmath37 of each of these subsets @xmath1033 , such that each edge of @xmath1 belongs to some @xmath1034 , @xmath1035 , and @xmath1036 and @xmath1037 imply that @xmath1038 for any @xmath1039 , @xmath1040 , with all subscript addition modulo @xmath0 .",
    "theorem [ bi - arc - min ] can be extended to @xmath0-min orderings as follows . a @xmath0-_arc representation _ of a digraph @xmath1 on a circle @xmath52 with @xmath1041 special points ( _ poles _ @xmath1042 ( in this clockwise order ) consists of intervals @xmath5 consistent as before , now each @xmath56 containing @xmath1043 , for some @xmath1035 , and no other poles , and each @xmath57 containing @xmath1044 , for some @xmath1035 , and no other poles , such that @xmath3 if and only if @xmath62 and @xmath57 are disjoint .",
    "a digraph @xmath1045 is a k - arc digraph if and only if it admits a @xmath0-min ordering .",
    "@xmath82    in some cases when min orderings do not exist ,",
    "there may still exist extended min orderings , which is sufficient for the polynomial solvability of lhom@xmath1046 @xcite .",
    "we denote by @xmath1047 the directed cycle on vertices @xmath1048 .",
    "we shall assume in this section that @xmath1 is weakly connected .",
    "this assumption allows us to conclude that any two homomorphisms @xmath1049 of @xmath1 to @xmath1047 define the same partition of @xmath17 into the sets @xmath1050 , and we will refer to these sets without explicitly defining a homomorphism @xmath301 .",
    "thus suppose @xmath1 is homomorphic to @xmath1047 , and let @xmath1033 be the partition of @xmath17 corresponding to all such homomorphisms .",
    "note that any @xmath1 is homomorphic to the one - vertex digraph with a loop @xmath1047 , and a @xmath669-min ordering of @xmath1 is just the usual min ordering .",
    "also note that a min ordering of a digraph @xmath1 becomes a @xmath0-min ordering of @xmath1 for any @xmath1047 that @xmath1 is homomorphic to . however , there are digraphs homomorphic to @xmath1047 which have a @xmath0-min ordering but do not have a min ordering - for instance @xmath1047 ( with @xmath1051 ) .",
    "we observe for future reference that an unbalanced digraph @xmath1 has only a limited range of possible values of @xmath0 for which it could be homomorphic to @xmath1047 , and hence a limited range of possible values of @xmath0 for which it could have a @xmath0-min orderings .",
    "it is easy to see that a cycle @xmath52 admits a homomorphism to @xmath1047 only if the net length of @xmath52 is divisible by @xmath0 @xcite .",
    "thus any cycle of net length @xmath1052 in @xmath1 limits the possible values of @xmath0 to the divisors of @xmath287 . if @xmath1 is balanced , it is easy to see that @xmath1 has a @xmath0-min ordering for some @xmath0 if and only if it has a min ordering .    for a digraph @xmath1 homomorphic to @xmath1047",
    "we shall consider the following version of the pair digraph .",
    "the digraph @xmath1053 is the subgraph of @xmath150 induced by all ordered pairs @xmath151 belonging to the same set @xmath1033 .",
    "we say that @xmath229 is a _",
    "symmetrically @xmath0-invertible pair _ in @xmath1 if @xmath1053 contains a walk joining @xmath229 and @xmath1054 .",
    "thus a symmetrically @xmath0-invertible pair is a symmetrically invertible pair in @xmath1 in which @xmath84 and @xmath71 belong to the same set @xmath1033 .",
    "note that @xmath1 may contain symmetrically invertible pairs , but no symmetrically @xmath0-invertible pair .",
    "consider , for instance the directed hexagon @xmath1055 .",
    "the pair @xmath1056 is symmetrically invertible and symmetrically @xmath1057-invertible , but not symmetrically @xmath1058-invertible .",
    "the extended version of our main theorem follows .",
    "[ main - k ] the following statements are equivalent for a weakly connected digraph @xmath1 .    1 .",
    "@xmath1 admits a @xmath0-min ordering 2 .",
    "there exists a positive integer @xmath0 such that @xmath1 is homomorphic to @xmath1047 and no component of @xmath1053 contains a circuit     * proof : * we shall in fact prove that the following statements are equivalent for a positive integer @xmath0 such that @xmath1 is homomorphic to @xmath1047 :    1 .",
    "@xmath1 admits a @xmath0-min ordering 2 .",
    "no component of @xmath1053 contains a circuit    suppose @xmath1 admits linear orderings @xmath37 of sets @xmath1033 satisfying the min property between consecutive sets @xmath1059 .",
    "any circuit @xmath1060 in @xmath1053 must have all vertices @xmath1061 in the same set @xmath1033 , and hence if all the pairs @xmath187 were in the same component of @xmath1053 we would obtain the same contradiction with transitivity of @xmath37 as above the statement of theorem [ inv ] .",
    "this proves that 1 implies 2 .",
    "now we prove that 2 implies 1 .",
    "thus assume that @xmath1 is homomorphic to @xmath1047 and no strong component of @xmath1053 contains a circuit .",
    "we shall construct a @xmath0-min ordering of @xmath1 .",
    "we have again the components of @xmath1053 in dual pairs @xmath167 , where @xmath165 consists of the reverses of the pairs in @xmath52 , and we can proceed with a similar algorithm as before . at each stage of the algorithm ,",
    "some component of @xmath1053 is chosen and its dual component discarded .",
    "we again choose a component @xmath198 according to the rules in algorithm [ alg - main ] .",
    "the proof of correctness is analogous to the proof of propositions [ phase1 ] , [ phase2 ] .",
    "@xmath82    we again note that the theorem implies a polynomial time algorithm to test whether an input digraph @xmath1 has a @xmath0-min min ordering .",
    "as noted above , it suffices to check for each component of @xmath1 separately , so we may assume that @xmath1 is weakly connected .",
    "if @xmath1 is balanced , we have already observed this is only possible if @xmath1 has a min ordering , which we can check in polynomial time .",
    "otherwise we find any unbalanced cycle in @xmath1 , say , of net length @xmath287 , and then test for circuits in components @xmath1053 for all @xmath0 that divide @xmath287 .",
    "we have provided polynomial time algorithms , obstruction characterizations , and geometric representations , for digraphs admitting a min ordering , i.e. , a csl polymorphism .",
    "we believe they are a useful generalization of interval graphs , encompassing adjusted interval digraphs , monotone proper interval digraphs , complements of circular arcs of clique covering number two , two - dimensional ray graphs , and other well known classes .",
    "we now point out that the class of digraphs admitting a set polymorphism , i.e. , cts polymorphisms of all orders , coincides with the the class of digraphs with a min ordering , and so is equal to the class of bi - arc digraphs .",
    "[ before - last ] if there exists a circuit in a strong component of @xmath150 then either @xmath150 contains an invertible or there exists a closed walk @xmath161 composed of walks @xmath1062 , w[v_1,v_2], ...",
    ",w[v_r , v_0]$ ] with the following properties : each @xmath1063 $ ] is constricted from below , has a positive net length @xmath130 and @xmath1063 $ ] and @xmath1064 $ ] avoid each other for every @xmath1065 ( @xmath1066 )     * proof : * suppose @xmath350 is a circuit in a strong component @xmath1067 of @xmath150 .",
    "we may assume that the circuit has the minimum length and @xmath565 .",
    "note the if the circuit is not minimum then there is a minimum circuit which is implied by @xmath1067",
    ". if this is the case then by the properties shown in section [ structure - property ] for the minimum circuit when @xmath52 is unbalance then there is also a circuit which all belong to the same strong component @xmath1067 .",
    "if @xmath1067 is balanced then one can show there is a pair @xmath151 on the lowest level of @xmath1067 where for each pair in the circuit there exists a path constricted from below from @xmath151 to that pair .",
    "this means we can apply the lemma [ itit ] several times as necessary and conclude that there is a circuit on the lowest level of @xmath1067 .",
    "now we may assume that for every pair of the circuit there exists a path ( with net value zero and constricted from below ) from @xmath151 to that pair .",
    "but this is a contradiction according to [ not - imply - two ] .",
    "suppose @xmath52 is unbalanced and observe that by theorem [ claim ] we may assume that @xmath1068 , @xmath554 , and @xmath445 is extremal and all lie on one cycle @xmath1069 in @xmath52 .",
    "this can be done because all the pairs lie on the same strong component @xmath52 .",
    "we also assume that the net value of such @xmath567 is minimum .",
    "we may assume that the net value of a directed path @xmath161 from @xmath445 to @xmath589 is not zero .",
    "otherwise @xmath161 is constricted from below since @xmath445 is an extremal pair and hence @xmath1070 where @xmath355 and @xmath358 avoid each other ( part of @xmath658 ) .",
    "now it is easy to see that there is a path from @xmath445 to @xmath694 ( a walk from @xmath344 to a vertex with the maximum height on @xmath355 and then back to @xmath344 and a walk on @xmath358 from @xmath452 to @xmath1071 would give to a path in @xmath150 from @xmath445 to @xmath694 ) and hence we get a shorter circuit .",
    "consider the walks @xmath134 from theorem [ claim ] ( 2 ) .",
    "each walk @xmath134 starts at @xmath344 and it is constricted and has unbounded positive net length .",
    "every @xmath134 and @xmath670 avoid each other .",
    "moreover @xmath134 is obtained by walking around the closed walk @xmath198 .",
    "thus without loss of generality let the net value of portion of @xmath567 from @xmath1072 to @xmath1073 has the smallest positive net value @xmath301 and let the net value of @xmath567 be @xmath118 where @xmath118 is minimum .",
    "note that @xmath1074 .",
    "note that @xmath1075 and @xmath128 avoid each other .",
    "let @xmath1076 be the closed walk starting at @xmath1077 corresponding to @xmath1075 .",
    "note that @xmath1076 is also a closed walk starting at @xmath1078 corresponding to @xmath128 .    now consider the following walks : @xmath1079 $ ] , where @xmath1080 and @xmath1081 and @xmath1082 $ ] ; @xmath1083 where @xmath1084 is a extremal vertex on @xmath1076 and @xmath1085 has net length @xmath301 .",
    "observe that @xmath1086 , @xmath1087 avoid each other since @xmath1088 avoid each other .",
    "now at some point we must have @xmath1089 .",
    "without loss of generality we may assume that @xmath1090 .",
    "note that @xmath1091 because @xmath1076 has at most @xmath118 extremal pairs .",
    "note that the net value of @xmath567 is @xmath1092 .",
    "now @xmath1093 is a circuit in @xmath52 .",
    "we show that @xmath569 and @xmath1085 avoid each other for every @xmath1065 .",
    "note that if there is a faithful arc from the @xmath287-th vertex of @xmath1094 to the @xmath1095-th vertex of @xmath1096 then we would have @xmath1097 ( using the faithful arc at index @xmath287 ) and because @xmath1086 avoid each other and @xmath1098 avoid each other we conclude that @xmath1099 and @xmath1100 are both in @xmath1067 .",
    "on the other hand both @xmath1101 are in @xmath1067 and hence @xmath1102 are in @xmath1067 , a contradiction .",
    "therefore for every @xmath103 we have @xmath1103 avoid each other .",
    "now if @xmath980 then we are done so we may assume that @xmath1104 .",
    "let @xmath673 be the smallest integer such that @xmath1085 and @xmath1105 do not avoid each other ( @xmath1106 ) .",
    "note without loss of generality we may assume that @xmath1107",
    ". without loss of generality assume that @xmath1108 do not avoid each other and @xmath1107 . by considering the last faithful arc on @xmath1109 to @xmath1110",
    "we conclude that @xmath1111 has net value @xmath301 and since @xmath1112 avoid each other and @xmath1113 avoid each other , @xmath1114 are in @xmath1067 .",
    "we also note that using the faithful arc from @xmath1109 to @xmath1110 we have @xmath1115 which is a walk of net value zero and hence @xmath1116 has net value @xmath301 .",
    "now we have a circuit @xmath1117 , and a closed walk that consists of @xmath1118 and has net length @xmath1119 .",
    "this is a contradiction to the assumption about the net value of @xmath567 .",
    "* proof : * since a min ordering allows to define a conservative set polymorphism as the minimum , it suffices to show that a digraph that does not have a min ordering also can not have a conservative set polymorphism . we show this by showing that a circuit in one component of @xmath150 means that @xmath1 does not have a conservative set polymorphism .",
    "so suppose @xmath350 is a circuit in a strong component @xmath52 of @xmath150 . by theorem",
    "[ before - last ] either there exists an invertible pair and hence there is no cls polymorphism or there exists a closed walk @xmath161 composed of walks @xmath1062 , w[v_1,v_2], ... ,w[v_r , v_0]$ ] with the following properties : each @xmath1063 $ ] is constricted from below , and has a positive net value @xmath130 and @xmath1063 $ ] and @xmath1064 $ ] avoid each other for every @xmath1065 ( @xmath1066 ) .",
    "we remark that in the proof we have only used the fact that @xmath1 does not have a conservative cyclic polymorphism .",
    "thus we have actually proved that the class of bi - arc digraphs coincides with each of the following classes of digraphs :                k.s .",
    "booth and g.s .",
    "testing for the consecutive ones property , interval graphs , and graph planarity using pq - tree algorithms , journal of computer and system sciences 13 ( 1976 ) 335  379 .",
    "h. chen , and b. larose . asking the metaquestions in constraint tractability , arxiv:1604.00932 .",
    "corneil , s. olariu , and l. stewart . the lbfs structure and recognition of interval graphs , siam j. discrete math .",
    "23 ( 2009 ) 19051953 . c. carvalho , l. egri , m. jackson , and todd niven .",
    "on maltsev digraphs , electr . j. comb .",
    "22(1 ) : p1.47 ( 2015 )                    d.r .",
    "fulkerson , and o.a . gross .",
    "incidence matrices and interval graphs , pacific j. math . 15 ( 1965 ) 835855 .",
    "m. c. golumbic . *",
    "* a**lgorithmic graph theory and perfect graphs , academic press , new york ( 1980 ) .",
    "m. habib , r. mcconnell , c. paul , and l. viennot .",
    "lex - bfs and partition refinement , with applications to transitive orientation , interval graph recognition and consecutive ones testing , theoretical computer science 234 ( 2000 ) 5984 ."
  ],
  "abstract_text": [
    "<S> we introduce the class of bi - arc digraphs , and show they coincide with the class of digraphs that admit a conservative semi - lattice polymorphism , i.e. , a min ordering . </S>",
    "<S> surprisingly this turns out to be also the class of digraphs that admit totally symmetric conservative polymorphisms of all arities . </S>",
    "<S> we give an obstruction characterization of , and a polynomial time recognition algorithm for , this class of digraphs . </S>",
    "<S> the existence of a polynomial time algorithm was an open problem due to bagan , durand , filiot , and gauwin .    </S>",
    "<S> we also discuss a generalization to @xmath0-arc digraphs , which has a similar obstruction characterization and recognition algorithm .    when restricted to undirected graphs , </S>",
    "<S> the class of bi - arc digraphs is included in the previously studied class of bi - arc graphs . </S>",
    "<S> in particular , restricted to reflexive graphs , bi - arc digraphs coincide precisely with the well known class of interval graphs . restricted to reflexive digraphs </S>",
    "<S> , they coincide precisely with the class of adjusted interval digraphs , and restricted to bigraphs , they coincide precisely with the class of two directional ray graphs . </S>",
    "<S> all these classes have been previously investigated as analogues of interval graphs . </S>",
    "<S> we believe that , in a certain sense , bi - arc digraphs are the most general digraph version of interval graphs with nice algorithms and characterizations .    </S>",
    "<S> the second author used these results to give an approximation algorithm for the minimum cost homomorphism problem to a bi - arc digraph . </S>"
  ]
}