{
  "article_text": [
    "the exponential growth in available computing power has made hybrid and fully kinetic plasma simulations increasingly feasible for a variety of space plasma applications .",
    "non - exhaustive examples include hybrid particle - in - cell ( hybrid - pic ) simulations of planetary environments @xcite and magnetospheres @xcite , full - pic studies of magnetic reconnection @xcite , local hybrid - vlasov simulations of wave - particle interactions in the solar wind @xcite or full - vlasov simulations of the kelvin - helmholtz instability @xcite .",
    "vlasiator is a new self - consistent hybrid - vlasov simulation code in which the ions ( protons ) are treated kinetically via vlasov s equation and electrons are a massless charge - neutralizing fluid .",
    "it is based on a robust finite volume method , which has been optimized for the modeling of the entire magnetosphere of the earth@xcite ( http://vlasiator.fmi.fi ) . to our knowledge",
    ", vlasiator is the first hybrid - vlasov code to allow simulations on this scale .",
    "an important advantage of the hybrid - vlasov model with respect to ( hybrid-)pic methods is the absence of noise related to the low number of particles representing the distribution function , as hybrid - vlasov algorithms propagate the full distribution function in the six - dimensional phase space using vlasov s equation .",
    "the uniform sampling in velocity space provides a description of the distribution function with a quality comparable to spacecraft measurements .",
    "however , the six - dimensional representation of the distribution function in the hybrid - vlasov approach makes the memory and computing requirements high , even for modern massively parallel supercomputers .",
    "the hybrid - vlasov scheme is a relatively new approach to computational plasma physics at large scales because of the aforementioned need of computing resources .",
    "hence it is critical to provide basic benchmarks to assess the possibilities and limits of the model in terms of its physical features . as part of the verification of vlasiator",
    "we perform local simulations to investigate the propagation of low-@xmath0 plasma waves in the hybrid - vlasov model by studying wave dispersion in a variety of cases .",
    "the dispersion of the left- and right - hand polarized modes as well as the ion - acoustic waves propagating parallel to the magnetic field has been used before to verify a hybrid - vlasov simulation code@xcite .",
    "we extend this test to include more plasma wave modes in all propagation directions ranging from parallel to perpendicular to the magnetic field and present dispersion surface plots .",
    "the cases included here are in a range of parameters relevant to understand global magnetospheric simulations .",
    "thus this study helps bolstering the interpretation of current and future large - scale simulations of the magnetosphere of the earth in 2 + 3 and 3 + 3 spatial and velocity dimensions .",
    "we compare the results obtained with vlasiator to the solutions calculated using the waves in homogeneous , anisotropic multicomponent plasmas code ( whamp , https://github.com/irfu/whamp ) , which solves the linearized kinetic dispersion equation numerically@xcite .",
    "the simple and robust solution approach of whamp starting from the general dispersion equation and its strong establishment as a tool for the determination of wave dispersion in homogeneous plasmas make it an ideal tool to verify vlasiator results .",
    "since the central interest of vlasiator lies in simulating the entire magnetosphere of the earth , we focus on wave modes at spatial and temporal ion scales . in ideal magnetohydrodynamic ( mhd )",
    "theory the only possible wave modes are the alfvn wave , which is a shear electromagnetic mode propagating at all angles except perpendicularly to the magnetic field , and the fast and slow magnetosonic modes , which are compressional electromagnetic modes propagating at an oblique angle with respect to the magnetic field@xcite .",
    "the dispersion equation of the shear alfvn wave is given by @xmath1 where @xmath2 is the angular frequency , @xmath3 the wave number , @xmath4 ( @xmath5 : magnetic field intensity , @xmath6 : permeability of vacuum , @xmath7 : mass density ) is the alfvn speed and @xmath8 is the angle between the wave vector @xmath9 and the magnetic field vector @xmath10 . the fast ( @xmath11 ) and slow ( @xmath12 ) magnetosonic wave dispersion equation is given by @xmath13 where @xmath14 ( @xmath15 : boltzmann constant , @xmath16 : temperature , @xmath17 : ion mass ) is the sound speed . in a low-@xmath0 plasma we have @xmath18 . for parallel propagation ( @xmath19 ) , the alfvn and fast magnetosonic modes coincide and the mode propagates at @xmath20 , whereas the slow magnetosonic mode becomes the sound wave propagating at @xmath21 . in the perpendicular case ( @xmath22 ) ,",
    "the alfvn and slow mode can not propagate and only the fast magnetosonic mode propagating at magnetosonic speed @xmath23 subsists",
    ". these modes are dispersionless .",
    "multi - fluid and kinetic theories describe more plasma wave modes .",
    "the left- and right - hand polarized modes ( l- and r - mode hereafter ) propagate along or quasi - parallel to the magnetic field .",
    "they couple to the ion and electron gyromotion , therefore they resonate at the ion and electron gyrofrequency , respectively . in the low frequency ,",
    "small wave number limit both modes converge towards the ideal mhd alfvn mode .",
    "the last wave modes in the range of frequencies and wavelengths of interest in this paper are the ion bernstein modes , which are electrostatic ion - cyclotron resonances ( quasi-)perpendicular to the magnetic field . their dispersion equation can be expressed in terms of infinite sums of bessel functions in the hybrid - vlasov model@xcite .",
    "a thorough review of plasma wave dispersion surfaces obtained with whamp at ion and electron scales ( including the modes introduced in this section ) is given by @xcite .",
    "this paper is organized as follows . in section [ sec : models_methods ] we present vlasiator and whamp as well as the simulation setup used with vlasiator .",
    "then we present our results in section [ sec : results ] .",
    "we show the importance of the hall term in ohm s law , and we study dispersion curves for parallel , perpendicular and oblique propagation as well as dispersion surfaces .",
    "we discuss the results in section [ sec : discussion ] and conclusions are drawn in section [ sec : conclusions ] .",
    "the solver for vlasov s equation implemented in the hybrid - vlasov model of vlasiator is based on a three - dimensional wave propagation algorithm@xcite applied separately to translation in position space and acceleration in velocity space .",
    "it is self - consistently coupled to a field solver@xcite which uses divergence - free magnetic field reconstruction@xcite .",
    "we only introduce here the solver features relevant to this study .",
    "vlasiator solves vlasov s equation @xmath24 where @xmath25 and @xmath26 are the spatial and velocity coordinates , @xmath27 is time , @xmath28 is the six - dimensional phase - space density of ions with mass @xmath29 and charge @xmath30 , and acceleration @xmath31 is due to the lorentz force @xmath32 in which @xmath33 is the electric field and @xmath10 is the magnetic field .    in the hybrid - vlasov model vlasov s equation is coupled to maxwell s equations .",
    "the displacement current is neglected in the ampre - maxwell law and the equations take the form @xmath34 where @xmath35 is the total current density .",
    "note that the equation @xmath36 is respected by the field propagation algorithm of vlasiator by construction , provided the initial conditions are divergence - free@xcite .",
    "ohm s law describes the relationship between the electric and the magnetic field .",
    "it is needed to close the hybrid - vlasov system of equations , when updating the magnetic field using faraday s law ( eq .  [ eq : maxwell - faraday ] ) . in the present study vlasiator",
    "is using the ideal ohm s law supplemented by a hall term ( rightmost term in eq .",
    "[ eq : ohms - law ] ) with first - order spatial accuracy : @xmath37 the ion charge density @xmath38 and ( ion ) bulk velocity @xmath39 are obtained from velocity moments of the distribution function , @xmath35 is computed using eq .  .",
    "this effectively represents electrons as a massless , charge - neutralizing fluid .",
    "the rest of the solvers in vlasiator retain second - order spatial accuracy throughout in smooth cases . in cases with strong spatial gradients  in position or velocity space alike  flux limiters effectively reduce the spatial accuracy of the solvers in order to preserve the numerical stability of the scheme .",
    "note that although the hall term in the computation of the electric field can be neglected using the ideal ohm s law , it has to be retained in the electric field input into the lorentz force ( eq .  [ eq : lorentz ] ) in order to model bulk forces on the ions .",
    "this makes vlasiator a proper hall - less hybrid model when the hall term in ohm s law is not used@xcite .",
    "whamp is a code solving the linear analytic dispersion equation of waves in magnetized plasmas .",
    "it can include several populations with differing number density , mass , temperature , loss cone , anisotropy and drift parameters for anisotropic maxwellian distributions@xcite .",
    "a general form of the plasma wave dispersion equation is @xmath40 , where @xmath41 is the dispersion tensor and @xmath33 the wave electric field .",
    "solutions can be found by equating the determinant of the dispersion tensor to zero , @xmath42 .",
    "whamp solves this in a linearized form using a pad approximant to ensure a fast computation yet good approximation of the result .",
    "the whamp interface is designed to take in the plasma parameters initially and then allow to query the solution point by point in the ( @xmath9-@xmath2 ) space . given an initial ( @xmath43,@xmath44 ) point whamp tries to find a wave mode close - by and returns the frequency , wave vector and growth rate of the mode among others .",
    "a script querying whamp systematically is used to ease comparison with the full dispersion plots and surfaces obtained with vlasiator following the methods presented in the next section .    when comparing whamp and vlasiator results , the electron temperature @xmath45 in whamp is set to a small value in order to mimic the absence of electron pressure gradient effects in our hybrid - vlasov model .",
    "the electron temperature is ignored in vlasiator , effectively suppressing in the model the ion - acoustic wave for which @xmath46 must hold .",
    "the simulation setup of vlasiator in the present study consists of a one - dimensional spatial domain along the @xmath47-axis , constraining the wave vector to be in that direction , with fully periodic boundary conditions .",
    "the angle between the magnetic field and the wave vector is defined by setting the magnetic field orientation with respect to the simulation box .",
    "the initial conditions are uniform up to small random perturbations in the number density and bulk velocity .",
    "the velocity distribution is isotropic and maxwellian , therefore excluding waves growing from anisotropy - driven instabilities .",
    "the system relaxes and no forcing is applied during the simulation .    a two - dimensional space - time ( @xmath47-@xmath27 ) dataset is formed by saving the spatial profile of a bulk variable at every ( constant ) time step .",
    "the total run time is typically several ion gyroperiods .",
    "the data is first windowed along the time dimension using a hamming window to reduce the noise induced by the abrupt start and stop of the time series .",
    "then it is subjected to a discrete fourier transformation to produce a ( @xmath3-@xmath2 ) dispersion plot .",
    "dispersion surfaces are computed by extracting the points above a threshold in each ( @xmath3-@xmath2 ) dataset to retrieve the dispersion branches for multiple angles .",
    "the extracted data is interpolated and re - sampled on a cartesian coordinate grid to obtain smoother dispersion surfaces more readily comparable with the dispersion surfaces from whamp .",
    "the simulation and plasma parameters of all vlasiator simulations presented in this paper are given in table [ tab : simulation_parameters ] .",
    "whamp uses exactly the same parameters as input , except for the electron temperature as discussed above .",
    ".parameters of the vlasiator simulations presented in this paper .",
    "the propagation angles with respect to the magnetic field are @xmath48 for the parallel cases without and with hall term ( fig .",
    "[ fig : par ] ) ; @xmath49 for the perpendicular case ( fig .",
    "[ fig : perp ] ) ; @xmath50 for the dispersion surfaces ( fig .",
    "[ fig : surfaces ] ) ; and @xmath51 for the oblique case ( fig .",
    "[ fig : oblique ] ) . [ cols=\"<,^,^ \" , ]     [ tab : simulation_parameters ] [ tab : plasma_parameters ]",
    "in ideal mhd , ohm s law takes the form @xmath52 where @xmath53 is the bulk velocity and the hall term @xmath54 has been omitted with respect to equation .",
    "the absence of spatial scales in this form of ohm s law in the hybrid - vlasov model prevents the kinetic coupling of the ions to any wave mode .",
    "there are thus no resonances and the wave modes present are the non - dispersive ideal mhd wave modes . in the parallel case",
    "this means that the only wave mode one can observe in the dispersion plot is the ideal mhd alfvn wave ( eq .  [ eq : disp_mhd_alfven ] ) , as illustrated in figure [ fig : par ] on the left - hand side ( @xmath48 ) .",
    "all other cases hereafter were obtained using the hall term in ohm s law .    ) with the ideal ohm s law ( left ) and ohm s law including the hall term ( right ) .",
    "further parameters are given in table [ tab : plasma_parameters ] .",
    "wavelengths are scaled to the ion gyroradius @xmath55 , frequencies to the ion gyrofrequency @xmath56 .",
    "the dashed line represents the ideal mhd alfvn wave speed @xmath57 .",
    "the curves represent the whamp solution . without the hall term vlasiator only shows the non - dispersive ideal mhd alfvn mode . with the hall term in ohm s law",
    "the l - mode resonates at @xmath56 , while the higher - frequency branch is the r - mode . ]    using @xmath58 ( eq.[eq : maxwell - ampere ] ) the hall term can be expressed as @xmath59 .",
    "it becomes apparent in this form that through the current density , spatial derivatives of the magnetic field and thus spatial scales are introduced .",
    "one consequence is that wave dispersion can occur in the hybrid - vlasov model and one departs from the ideal mhd description .",
    "the dispersion plot for the same parameters but with the hall term included is presented on the right - hand side of figure [ fig : par ] . as expected the l - mode has a resonance at the fundamental ion gyrofrequency .",
    "the r - mode on the other hand is not expected to resonate at @xmath60 ( beyond the upper edge of the figure ) because of the lack of electron physics in our hybrid - vlasov model . at low frequencies and low wave numbers",
    "the two modes converge towards the ideal mhd alfvn wave . without the hall term in ohm s law",
    ", the simulation result matches the ideal mhd theory . with the hall term",
    ", the simulation result matches the dispersion obtained by whamp .",
    "the reason for the slight discrepancy in the r - mode at higher frequencies is analyzed in paragraph [ sec : surf_oblique ] below .      in the perpendicular propagation case ( @xmath49 ) shown in figure [ fig : perp ]",
    "the dispersion plot exhibits the ion bernstein modes , which are relatively weak but correspond well to the whamp solution .",
    "the non - propagating mode at @xmath56 and its harmonic at @xmath61 are due to the initial random perturbations fluctuating at the ion gyrofrequency throughout the simulation domain at all spatial scales .",
    "the strongest mode in the plot is the magnetosonic mode , which is non - dispersive in vlasiator .",
    "it shows dispersion in the whamp solution and bends towards the lower - hybrid plateau ( top of the plot and beyond ) , a feature not reproduced by vlasiator again due to lacking electron physics in the hybrid - vlasov model .    )",
    "including the hall term in ohm s law .",
    "further parameters are given in table [ tab : plasma_parameters ] .",
    "the curves represent the whamp solution .",
    "the magnetosonic mode is non - dispersive in vlasiator whereas it bends towards the lower - hybrid plateau in whamp ( top of the plot and beyond ) , the first few ion bernstein modes are visible but relatively weak.,scaledwidth=50.0% ]      following the tradition established by @xcite to study wave dispersion using dispersion surfaces in the @xmath62 space , we produced the dispersion surfaces for vlasiator as well .",
    "the comparison of the vlasiator dispersion surfaces with the whamp solution is shown in figure [ fig : surfaces ] .",
    "the whamp solution is plotted regardless of the damping or the relative amplitude of the modes .",
    "this explains the smaller extent of the l - mode surface ( lower surface ) as well as the absence of the ion bernstein modes in this regime in the vlasiator results .    in order to convey a better impression of the relation between the vlasiator and whamp solutions the dispersion for oblique propagation at @xmath51",
    "is presented in figure [ fig : oblique ] .",
    "a first observation is that vlasiator and whamp consistently show a strong damping of the l - mode beyond @xmath63 ; the signal weakens in vlasiator and whamp does not pick the mode any more .",
    "another observation is that while at low frequencies and long wavelengths both solutions overlap completely , the r - mode does not match exactly at higher @xmath2 , in a similar way as was observed for the parallel propagation case in paragraph [ sec : parallel ] .",
    "increasing the spatial resolution of the vlasiator simulation improves the situation , in that the vlasiator r - mode is closer to the whamp solution for a longer range .",
    "this indicates that the spatial accuracy of the code , and especially the accuracy of the hall term , which is currently of lower order than the vlasov and field solvers , is responsible for this discrepancy .    .",
    "left : whamp results .",
    "right : vlasiator results interpolated and re - sampled from simulations at propagation angles @xmath50 .",
    "lower surface : l - mode .",
    "higher surface : r - mode .",
    "the non - dispersive surface at @xmath64 in the whamp solution is the first ion bernstein mode .",
    "the whamp solution is plotted regardless of the damping of the modes . ]    ) including the hall term in ohm s law .",
    "further parameters are given in table [ tab : plasma_parameters ] .",
    "the black curves represent the whamp solution .",
    "the dashed line represents the ideal mhd alfvn wave speed @xmath57.,scaledwidth=50.0% ]",
    "in this study we show that the wave dispersion results from vlasiator are closely matched by the whamp solution in all propagation directions . the good correspondence between these two essentially different approaches to solving vlasov s equation , namely the linearized kinetic theory and the hybrid - vlasov simulation , is an indicator of the good quality of the vlasiator results .",
    "they clearly show that the hall term in ohm s law is critical to go beyond ideal mhd in terms of wave modes described by the hybrid - vlasov model .",
    "introducing spatial scales through the derivatives of the magnetic field , the hall term in ohm s law makes wave dispersion possible .",
    "in particular the l- and r - modes split and the l - mode , coupling to the ion gyromotion , resonates at the ion gyrofrequency .",
    "in addition to this , the ion bernstein modes are a feature which arises purely from the kinetic description of magnetized plasma .",
    "two major consequences and expected shortcomings of the limited electron physics of the hybrid - vlasov model are that the r - mode should not resonate at any frequency , and that the magnetosonic mode does not couple to electrons to form the lower - hybrid plateau at the ion - electron lower - hybrid frequency @xmath65 in quasi - perpendicular propagation .",
    "this work is a major step in the verification of vlasiator and it provides vital insight into the model s wave modes .",
    "the aim of the development of vlasiator is to provide the first self - consistent hybrid - vlasov model able to simulate the entire magnetosphere of the earth including ion - kinetic effects .",
    "plasma wave modes are a key feature which should be described accurately by the model and properly understood in order to interpret global magnetospheric simulations .",
    "it is important to note that the splitting of wave modes introduced by the hall term in ohm s law also occurs on temporal and spatial scales comparable to and longer than the ion scales .",
    "these long scales are of primary interest in global magnetospheric simulations using a hybrid code in which the emphasis is placed on ion kinetics . therefore differences are expected to appear between hall - less simulations of the magnetosphere and their counterparts using the hall term in ohm s law , even if the ion gyroradius were not resolved . adding the hall term to ohm s law in vlasiator is expected to make the described physics richer but suitable numerical accuracy and stability in global magnetospheric simulations",
    "will only be achieved with a hall term of appropriate spatial accuracy .",
    "realistic results have already been obtained nevertheless in successful hall - less magnetospheric simulations , comparing favorably to observed phenomena@xcite .",
    "by studying the dispersion of plasma waves in the hybrid - vlasov model of the new vlasiator code and comparing it to the linearized solution computed with whamp , we provide a key verification benchmark for vlasiator .",
    "the match between the two fundamentally different approaches is excellent , even with a hall term in ohm s law of first - order spatial accuracy .",
    "this study underlines the importance of using a sufficiently rich ohm s law in the hybrid - vlasov model to obtain a kinetic description of waves departing from ideal mhd , even on temporal and spatial scales typically associated with ideal mhd .",
    "the future addition of terms to ohm s law such as the electron pressure gradient term is expected to play a significant role as well in introducing richer electron physics , the lower - hybrid plateau for example .",
    "this will improve the quality of the model and the variety of physical phenomena included in it , even more so in the perspective of implementing adaptive mesh refinement in vlasiator to resolve ion - kinetic scales in selected regions .",
    "we acknowledge that the results of this research have been achieved using the prace ( partnership for advanced computing in europe ) research infrastructure resource hermit based in germany at the high performance computing center stuttgart ( hlrs ) .",
    "the quantifying energy circulation in space plasmas ( quespace ) project , in which vlasiator is developed , has received funding from the european research council under the european community s seventh framework programme ( fp-7/2007 - 2013/erc ) agreement no .",
    "the work of yk , dp , sa and mp has been supported by the academy of finland .",
    "24ifxundefined [ 1 ] ifx#1 ifnum [ 1 ] # 1firstoftwo secondoftwo ifx [ 1 ] # 1firstoftwo secondoftwo `` `` # 1''''@noop [ 0]secondoftwosanitize@url [ 0 ]",
    " + 12$12  & 12#1212_12%12@startlink[1]@endlink[0]@bib@innerbibempty link:\\doibase 10.1029/2007ja012348 [ * * ,   ( ) ] link:\\doibase 10.1029/91ja00671 [ * * ,   ( ) ] link:\\doibase 10.1029/2003ja009991 [ * * ,   ( ) ] link:\\doibase 10.1029/2005ja011243 [ * * ,   ( ) ] link:\\doibase 10.1029/2005ja011169 [ * * ,   ( ) ] link:\\doibase 10.1016/j.jcp.2011.11.004 [ * * ,   ( ) ] link:\\doibase    10.1029/2011ja017464 [ * * ,   ( ) ] link:\\doibase 10.1063/1.4817961 [ * * , ( ) ] link:\\doibase 10.1063/1.3420278 [ * * ( ) ,  10.1063/1.3420278 ] link:\\doibase    10.1063/1.3422547 [ * * ,   ( ) ] link:\\doibase 10.1016/j.parco.2013.05.001 [ * * ,   ( ) ] link:\\doibase    10.1016/j.jastp.2012.09.013 [ * * ,   ( ) ] link:\\doibase 10.1016/j.jcp.2007.01.001 [ * * ,   ( ) ] @noop * * ( ) link:\\doibase fixme [ * * ,   ( ) ] @noop _ _  ( , )   link:\\doibase    10.1016/0021 - 9991(92)90372 - 6 [ * * ,   ( ) ] link:\\doibase 10.1017/s0022377800002270 [ * * ,   ( ) ] link:\\doibase 10.1006/jcph.1996.5603 [ * * , ( ) ] link:\\doibase 10.1006/jcph.2000.6606 [ * * , ( ) ] link:\\doibase 10.1016/j.jcp.2003.09.016 [ * * , ( ) ] link:\\doibase 10.1016/j.jcp.2008.12.003 [ * * ,   ( ) ] link:\\doibase 10.1029/2004ja010478 [ * * , ( ) ] http://www.cospar.fi/fincospar2013/slides/friday/6_5%20kempf.pdf [ `` , ''  ]"
  ],
  "abstract_text": [
    "<S> vlasiator is a new hybrid - vlasov plasma simulation code aimed at simulating the entire magnetosphere of the earth . </S>",
    "<S> the code treats ions ( protons ) kinetically through vlasov s equation in the six - dimensional phase space while electrons are a massless charge - neutralizing fluid [ m. palmroth _ </S>",
    "<S> et al . _ , journal of atmospheric and solar - terrestrial physics * 99 * , 41 ( 2013 ) ; a. sandroos _ </S>",
    "<S> et al . _ , parallel computing * 39 * , 306 ( 2013 ) ] . for first global simulations of the magnetosphere , </S>",
    "<S> it is critical to verify and validate the model by established methods . here , as part of the verification of vlasiator </S>",
    "<S> , we characterize the low-@xmath0 plasma wave modes described by this model and compare with the solution computed by the waves in homogeneous , anisotropic multicomponent plasmas ( whamp ) code [ k. rnnmark , kiruna geophysical institute reports * 179 * ( 1982 ) ] , using dispersion curves and surfaces produced with both programs . </S>",
    "<S> the match between the two fundamentally different approaches is excellent in the low - frequency , long wavelength range which is of interest in global magnetospheric simulations . </S>",
    "<S> the left - hand and right - hand polarized wave modes as well as the bernstein modes in the vlasiator simulations agree well with the whamp solutions . </S>",
    "<S> vlasiator allows a direct investigation of the importance of the hall term by including it in or excluding it from ohm s law in simulations . </S>",
    "<S> this is illustrated showing examples of waves obtained using the ideal ohm s law and ohm s law including the hall term . </S>",
    "<S> our analysis emphasizes the role of the hall term in ohm s law in obtaining wave modes departing from ideal magnetohydrodynamics in the hybrid - vlasov model .    </S>",
    "<S> copyright 2013 american institute of physics . </S>",
    "<S> this article may be downloaded for personal use only . </S>",
    "<S> any other use requires prior permission of the author and the american institute of physics .    </S>",
    "<S> the following article appeared in physics of plasmas * 20 * , 112114 ( 2013 ) and may be found at http://dx.doi.org/10.1063/1.4835315 . </S>"
  ]
}