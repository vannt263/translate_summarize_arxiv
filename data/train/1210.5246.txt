{
  "article_text": [
    "galaxies are complex systems consisting of a multitude of components that often require different approaches for both analytical and numerical study .",
    "the gaseous component can be described with the classic hydrodynamics equations ( che ) thanks to frequent collisions between constituent particles that act to isotropise the local pressure . on the other hand ,",
    "stellar and dark matter particles lack collisions which effectively means the local pressure is anisotropic and should be described by a stress tensor . although this modification is rather straightforward to implement in the che ( see e.g. * ? ? ?",
    "* ; * ? ? ?",
    "* ) , this approach has mostly been applied to analytical and semi - analytical studies of growing instabilities in stellar systems ( e.g. * ? ? ?",
    "when it comes to numerical simulations of collisionless galactic components , n - body methods have often been the method of choice ( e.g. * ? ? ?",
    "one owes this to the relative ease with which they can be implemented and one can start modelling three - dimensional collisionless systems - often with rather small numbers of particles . in particular , large dark - matter - only n - body simulations",
    "( e.g. the _ millennium simulation _",
    "* ) have led to significant advances in our understanding of cosmological structure formation , allowing some of the founding tenets of the current paradigm to be tested .",
    "as simulations have grown in complexity , incorporating the effects of baryonic matter , it has become necessary for theorists to develop a wider range of techniques to model the gaseous component .",
    "for this , there exist two dominant approaches ; that of smooth particle hydrodynamics ( sph ) and alternatively , grid codes . whilst both approaches agree for simple tests where analytic solutions are available ,",
    "discrepancies are still often found when modelling more complex phenomena .",
    "sph  is very robust and memory efficient , allowing large cosmological runs to self - consistently model the effects of gas physics and collisionless matter ( see for example the _ owls _ and _ gimic _ simulations ; * ? ? ?",
    "* ; * ? ? ?",
    "* ) . however , due to the higher shock capturing powers and more flexible refinement criteria of mesh codes , along with the tendency of sph  to suppress the formation of hydrodynamic instabilities and turbulent mixing @xcite , grid codes present a powerful alternative .",
    "in particular , grid based schemes are better suited to modelling small - scale physical processes such as heat conduction and radiative transfer .",
    "unfortunately , when coupling the collisionless matter to the collisionally dominated baryonic matter , it begins to become clear that the n - body approach is not always ideally suited to grid codes . in sph",
    "the gas is discretised into particles of a given mass , allowing the effects of gravity to be calculated using an n - body method in a very convenient self - consistent manner for all components .",
    "grid codes however require the mapping of the collisionless particle masses to the mesh , from which the global density field can be used to obtain the gravitational potential .",
    "this can be done using the multigrid technique @xcite with either a nested grid or adaptive mesh refinement ( amr ) .",
    "alternatively a fourier transform or a hybrid of the two can accelerate this process .",
    "once the gravitational acceleration is computed on the grid , it is then interpolated back to the particles . these are updated using a leapfrog method .",
    "this particle - mesh approach , a mapping of discrete particle properties to and from the mesh , represents a series of scientific and technical limitations to grid codes which degrade the physical reliability of their results and hampers the scalability of grid based simulations .",
    "these include :    * _ spurious generation of entropy _ - the particle - mesh technique allows numerical noise to be introduced if insufficient particles are present in a given resolution element or `` cell . ''",
    "it has been argued by @xcite that in regions where the mesh is over - sampled relative to the number density of particles , then some cells may receive mass mapped from particles whilst their neighbours may not .",
    "this can lead to strong variations in the local density field when realistically the field should be smooth and continuous .",
    "this can drive spurious weak shocks and turbulence on small scales , generating an unphysical entropy excess .",
    "@xcite cites this as the origin of the higher entropy cores seen in galaxy cluster simulations when run using grid codes , compared to those run with sph  codes which have cuspy low entropy cores @xcite . +",
    "as actually these particles should represent a continuous mass field , this effect can be limited by mapping the discrete mass of a given particle over a larger region using some pre - defined kernel function ( for example the  cloud - in - cell  technique ; * ? ? ?",
    "* ) , this however leads to more technical problems .",
    "* _ increased communication overhead _ - in massively parallel programs , a large amount of effort is often put into minimising communication between different nodes over the network .",
    "such communication is relatively time consuming , with latencies ( the time taken to establish and terminate a communication ) many orders of magnitude greater than the clock speed of the processor . as such",
    ", many calculations could be performed whilst waiting for a given group of processes to communicate , and if there is a list of different processes to communicate with , the time adds up .",
    "therefore any common communication scheme and grouping of messages , along with a reduction in the number of different nodes to which we must communicate with , presents a significant speed up in the code . +",
    "when particle masses are mapped using a kernel , there will inevitably be some overlap with neighbouring cells which may or may not reside on different nodes . although communication over the network is natural for any parallel simulation , it is lower when dealing with a system which advects only fluxes through cell surfaces instead of a system which can map mass to any neighbouring cell , whether it is directly adjacent to a face or merely in contact with an edge or vertex of the cell .",
    "this is demonstrated in figure  [ fig : pmvsflux ] in which a schematic layout of two dimensional ( 2d ) block of cells ( as used in the flash  code ) is shown along with the dashed outline of the neighbouring blocks which surround it .",
    "the internal cells in the block are shown in red and a surrounding layer four guardcells deep contains boundary data copied from neighbouring blocks .",
    "grey cells are guardcells which do not need to be updated or communicated for the given scheme , whilst green cells are guardcells which need to be updated or exchanged with neighbours . a 2d hydrodynamic simulation ( top panel )",
    "requires the communication of boundary data to compute the four fluxes through its cell faces with the grey corner guardcells not being used .",
    "the bottom panel however , shows how mapping of particle mass over a kernel of finite size can lead to particle properties being mapped to any of the surrounding guardcells .",
    "this data then needs to be communicated to the internal cells of the blocks to which they correspond .",
    "thus in 2d the communication overhead is doubled , whilst in 3d it can increase by a factor of 3.3 ( 6 face fluxes / 20 edge and corner cells to which mass may be mapped ) .",
    "sophisticated space filling curves can help optimise the distribution of blocks ( or individual cells ) across nodes so that as many adjacent neighbours as possible reside on the same processor , minimising inter - node communication .",
    "however increased overhead remains unavoidable , especially as we always remain bottle - necked by the slowest processor if the simulation is to proceed in lock - step .",
    "* _ poor load balancing _ - the use of particles in conjunction with a mesh also presents a load - balancing issue as many forms of astrophysical structure formation result in the natural concentration of the majority of mass in dense compact regions .",
    "this leads to too many particles accumulating in one or two cells whilst the remaining cells have few or none , even if the initial particle distribution is fairly uniform .",
    "ultimately , the mass field ends up poorly sampled in the under - dense regions of the simulation whilst the mapping of properties to and from the mesh is performed by a limited number of cells within the densest regions . as already mentioned , the hydrodynamics requires that as many neighbouring cells as possible be stored on the same processor",
    ". therefore these heavily occupied dense cells are all stored on the same few processors leading to extremely poor load balancing .",
    "although distributing these dense blocks more evenly would improve the load balancing for the particle - mesh algorithm , it would ruin the load balancing for the hydrodynamics , creating an impossible system to optimise .",
    "fortunately the use of the collisionless boltzmann moment equations allows us to overcome all of these limitations since it allows the stellar and dark matter components to be represented as a collisionless fluid in a near identical manner to the standard baryonic gas .",
    "this removes the need to develop a separate parallelisation scheme for the particle - mesh approach and allows us to use the same well parallelised hydrodynamics scheme . instead of communicating guardcell data for the gas and stellar material separately",
    ", the data can now be grouped and communicated all at once , minimising the latency overhead and maximising bandwidth usage .",
    "ideal load - balancing is also achieved as the time taken to calculate the inter - cell fluxes is independent of the amount of collisionless mass within a cell .",
    "thus processors will not be left idle whilst others calculate , provided that the cells are evenly distributed across processors .",
    "given that the hydrodynamics in the flash  amr  code we use has been shown to scale well for tens of thousands of processors @xcite , then by using the same parallelisation scheme for the collisionless material , we naturally preserve this scaling . in an era of increasingly large and complex simulations , this scalability is vital in keeping performance in - line with scientific requirements .    most importantly , as the density of the collisionless material is now represented in each cell continuously , this removes the potential for spurious generation of entropy through discreteness effects introduced when mapping particle properties to the mesh .",
    "it also removes limitations involved when converting gas into stars of discrete masses - problematic if cells contain insufficient mass but yet have densities that satisfy star formation criteria .",
    "we present in this paper our new implementation of the boltzmann moment equations which allows collisionless material to be modelled as a collisionless fluid on the mesh",
    ". a major application of this technique will be in modelling the behaviour of large collections of stars , such as those in a galaxy , as a collisionless fluid in much the same way that we model gas hydrodynamics in grid codes",
    ". we will therefore refer to it from here on as `` collisionless stellar hydrodynamics . ''",
    "we begin in   [ sec : boltzmanneqns ] with a derivation of the zeroth , first and second order moment equations of the collisionless boltzmann equation and then proceed in   [ sec : numericalschemes ] to outline the flash  hydrodynamic code (   [ sec : flashcode ] ) and the different numerical schemes we use to numerically integrate the equations .",
    "these include both a simpler riemann solver free technique (   [ sec : ktscheme ] ) and a more sophisticated riemann solver scheme with characteristic tracing (   [ sec : riemannsolver ] ) .",
    "in   [ sec : tests ] we outline our discovery of how standard hydrodynamic test problems for which analytic solutions are known , can be modified under special conditions to reproduce the results of a collisionless fluid .",
    "this enables us to use the sod - shock - tube test problem to test our results , the findings of which are given in ",
    "[ sec : sodshock ] .",
    "we continue our tests with both a pressure - free spherical collapse test (   [ sec : sphercollapse ] ) and an anisotropic collapse with non - isotropic dispersion tensor in   [ sec : anisocollapse ] . as a more complex test of our collisionless stellar hydrodynamics , in   [ sec : diskgal ] we track the growth of a two armed spiral in a stellar disc , contrasting the resulting structure with the predictions of the swing amplification theory .",
    "we then conclude our findings with an overview of our results , a discussion of the runtime performance of our code and the future implications of our work in   [ sec : summary ]",
    "the dynamics of collisionless particles are fundamentally described by the collisionless boltzmann equation for the distribution function of particles in the six dimensional position - velocity phase space @xmath0 @xmath1 where @xmath2 is the acceleration due to gravity and curvilinear terms ( in non - cartesian coordinate systems ) . in this paper , we use cartesian coordinates and hence @xmath3 .",
    "equation  ( [ boltzmann ] ) is a six - dimensional , time - dependent partial differential equation and although its direct numerical solution is possible ( see , e.g. * ? ? ?",
    "* ) high resolution simulations are prohibitively expensive even for the most powerful supercomputers .",
    "n - body methods circumvent this problem by solving a system of ordinary differential equations for the dynamics of individual particles , which on galactic scales often represent a cluster of objects rather than individual physical entities .",
    "in contrast to this _ discrete _ mechanics approach , a _ continuous",
    "_ mechanics approach is based on taking the first three velocity moments of equation  ( [ boltzmann ] ) .",
    "more specifically , equation  ( [ boltzmann ] ) is multiplied by ten quantities @xmath4 , where @xmath5 , and integrated over the velocity space @xmath6 to obtain partial differential equations for the volume density @xmath7 , the mean velocity @xmath8 , and velocity dispersions @xmath9 of collisionless particles .",
    "the resulting continuity , momentum , and velocity dispersion equations , named boltzmann moment equations ( bme ) , are as follows , + @xmath10 here , @xmath11 and @xmath12 is the symmetric velocity dispersion tensor .",
    "all indices obey the usual einstein summation rule .",
    "equations  ( [ contin])-([dispers ] ) are closed by using the usual zero - heat - flux approximation and setting the third - order moments to zero , @xmath13 .",
    "we discuss the applicability of this approximation in appendix b.    equations  ( [ contin ] ) and ( [ moment ] ) are in fact the jeans equations ( e.g. * ? ? ?",
    "* ) , from which the classic hydrodynamics equation are derived assuming a diagonal and isotropic form of the stress tensor @xmath14 and introducing the gas pressure @xmath15 and internal energy per unit volume @xmath16 , where @xmath17 and @xmath18 are the number of translational and total ( translational plus internal ) degrees of freedom . in the boltzmann moment equations ( bme ) ,",
    "no simplifying assumptions regarding the form of the stress tensor are made . due to this reason",
    ", every component of @xmath14 needs to be evolved in time separately .",
    "equation  ( [ dispers ] ) does that for the quantity @xmath19 , which can be regarded as an analogue to the total energy @xmath20 in the che . in total",
    ", one has 10 equations for ten unknown quantities : @xmath21 , @xmath22 , and @xmath23 .",
    "we note that equations  ( [ contin])-([dispers ] ) can be convolved to the usual che if an isotropic and diagonal form of @xmath14 is assumed ( see appendix a ) .",
    "the fundamental similarity of the bme with the che makes it straightforward to couple collisionless ( stars , dark matter ) and collisional ( gas , dust ) galactic subsystems in one grid - based code .",
    "below , we provide a detailed implementation of two numerical solvers which can accurately follow the behaviour of a collisionless fluid in the flash  amr  code .",
    "a full solution of the collisionless boltzmann equation requires a detailed knowledge of the velocity phase space distribution function for a collisionless fluid . unfortunately no known solution is currently available and therefore the first scheme we choose to implement is one which neither requires any detailed knowledge of the systems equation of state , nor any consideration of the behaviour of the different entropy and pressure waves around cell interfaces as would be used by more sophisticated riemann solver schemes . for this purpose",
    "we adopt the unsplit solver of @xcite for hyperbolic partial differential equations ( kt scheme  hereafter ) .",
    "the scheme is second order accurate in both space and time using a simplistic runge - kutta midpoint technique to ensure that the solution is second order accurate in time .",
    "this removes the need to deconvolve the moment equations into their separate eigenvectors within the riemann interaction fan . despite being riemann",
    "solver free , leading to an averaging over interactions within the riemann fan , when modelling a conventional ideal gas @xcite have shown that it possess very low numerical diffusion and can accurately capture sharp shocks and contact discontinuities .",
    "this makes it an ideal means to test the reliability of higher order more sophisticated schemes and as it is also highly extensible , higher order moments of the boltzmann equation can be readily incorporated .",
    "the second scheme we implement involves a more accurate modified state reconstruction using a new set of eigenvectors so that riemann solvers can be directly applied . unlike the kt scheme",
    ", the riemann solver approach achieves second order accuracy in time by reconstructing the time averaged fluid properties ( primitive or characteristic ) using more detailed knowledge of the eigenvector structure of the fluid equations .",
    "this grants the shock superior resolving powers , allowing sharper changes in the fluid variables to be tracked with less numerical diffusion .",
    "the scheme is also found to be relatively efficient compared to more dissipative schemes .",
    "as far as the authors are aware , this represents the first time that direct solution of the riemann problem for an anisotropic collisionless fluid has been achieved , with previous efforts focussing on either the use of less complex schemes such as the aforementioned kt scheme  or alternatively more complete direct integration of the collisionless boltzmann equation which represents a more significant computational overhead .",
    "flash  was developed at the alliance centre for astrophysical thermonuclear flashes as part of a doe grant .",
    "originally intended for the study of x - ray bursts and supernovae , it has since been adapted for many astrophysical conditions and now includes modules for relativistic hydrodynamics , thermal conduction , radiative cooling , magneto - hydrodynamics , thermonuclear burning , self - gravity and particle dynamics via a particle - mesh approach . in this study",
    "we use flash version 3.2 .",
    "the code is massively parallel , scaling well over more than tens of thousands of processors @xcite , and is highly modular enabling several different solvers for the hydrodynamics and stellar dynamics to be introduced .",
    "the code features an oct - tree structure with the simulation being divided into `` blocks '' , each of which contains a fixed number of cells ; @xmath24 in each dimension for our simulations .",
    "in addition to these cells , an additional four `` guardcells '' either side of the internal cells are required , which contain a copy of the properties of the neighbouring blocks in - case they are stored on a different node .",
    "the code is capable of adaptive mesh refinement , increasing the resolution in regions where a user defined refinement criteria is satisfied and conversely removing refinement in regions where excessive refinement is both unnecessary and wasteful .",
    "refinement is achieved by sub - dividing each `` parent '' block into @xmath25 `` child '' blocks .",
    "those at the highest level of refinement for their region of space are termed `` leaf blocks . ''",
    "the code enforces a maximum jump of two between levels of refinement . at refinement level @xmath26",
    ", a fully refined amr grid will have a total of @xmath27 cells on a side .    to identify regions of rapid flow change , flash s refinement and de - refinement criteria",
    "can incorporate the adapted @xcite error estimator .",
    "this calculates the modified second derivative of the desired variable , normalised by the average of its gradient over one cell . with this applied to the density",
    "as is common place , we impose maximum and minimum levels of refinement ; @xmath28 and @xmath29",
    ".      we implement into the flash  amr  code the semi - implicit numerical advection scheme of @xcite .",
    "we briefly outline the scheme below but refer readers to their paper for a more in - depth discussion . in conjunction with the semi - implicit scheme",
    ", we use a runge - kutta integration scheme for the temporal integration using the following time derivative for the fluid variables , @xmath30 ( eqn 4.2 in * ? ? ?",
    "* ) , @xmath31 where the numerical fluxes are defined as , @xmath32    here @xmath33 and @xmath34 represent the fluid variable values at the left and right side of cell @xmath17 with the indices @xmath35 and @xmath36 representing the interpolated values to the left and right sides of the respective cell interfaces .",
    "the fluxes @xmath37 are those taken from the derived bme ( [ contin ] , [ moment ] and [ dispers ] ) .",
    "the quantity @xmath38 represents the `` spectral frequency '' of the system ;    @xmath39    as this is the speed with which information is propagated , it is unsurprising that this equates to the effective sound speed of the collisionless fluid .",
    "this can be computed component wise with no loss of numerical accuracy , or alternatively as we show in   [ sec : tests ] that it is possible to reconcile the bme with the che , we can use the conventional sound speed formula ( [ eqn : soundspeed ] ) in a directionally dependant manner .",
    "this makes use of a value for @xmath40 and the dispersion tensor @xmath41 which can be treated as a directionally dependant pressure @xmath42 .",
    "@xmath43    the scheme can easily be extended to arbitrary orders of temporal and spatial accuracy ( see * ? ? ?",
    "* ) , however we choose to implement a second order accurate runge - kutta solver , providing a good compromise between accuracy and computational cost .",
    "higher order schemes would require additional guardcell updates at the many midpoints , increasing communication overhead , whereas the second order accurate scheme can perform the update using just the information in locally stored guardcells .",
    "the only modification which needs to be made in order for the scheme to function well with the adaptive mesh , is that flux conservation be checked at refinement boundaries .",
    "fluxes calculated for higher resolution cells are considered to be more accurate than those at lower levels of refinement .",
    "therefore the mean flux from the four higher resolution cells on a refinement boundary is calculated and passed to the neighbouring block at the coarser level of refinement to be used in place of the locally calculated flux .",
    "we implement our riemann solver based collisionless stellar hydrodynamics module into flash  using the muscl - hancock dimensionally unsplit scheme which has already been successfully implemented for the che including magneto - hydrodynamics @xcite .",
    "we adopt an unsplit approach over a less memory intensive split version ( e.g. ppm of * ? ? ?",
    "* ) given its superior ability to preserve flow symmetries .",
    "this is necessary given the highly non - linear nature of the bme which would otherwise quickly exaggerate any anisotropies . as an aside",
    ", we also note that we have significantly reduced the memory consumption of the default muscl - hancock scheme provided with flash  through more efficient memory management , ensuring that the increased memory overhead of using the unsplit scheme is equivalent to only a single extra amr block .",
    "the results for the reduced memory version are of course bit - wise identical to the default release .",
    "our collisionless scheme differs from the standard hydrodynamics scheme primarily through our determination of the new eigenvalues and eigenvectors which are required for the characteristic tracing step .",
    "this allows for the calculation of the time averaged fluid properties which can then be used to calculate the second order accurate fluxes using a conventional riemann solver such as the approximate hll family of schemes including the hllc solver ( see , e.g. * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ) or more accurate roe scheme @xcite .",
    "we begin by expressing the zeroth , first and second order moments of the boltzmann equation ( see equations [ contin ] , [ moment ] and [ dispers ] ) in compact matrix notation form ( neglecting gravity for the moment ) , @xmath44    with the conserved advection quantities @xmath45 and their corresponding fluxes * f*(*u * ) , * g*(*u * ) and * h*(*u * ) in the respective @xmath46 , @xmath47 and @xmath48-directions being ,    @xmath49   ,    &   { \\bf f}({\\bf u } )   = \\left [   \\begin{array}{l }   \\rho v_x \\\\",
    "\\rho v_x v_x + \\rho\\sigma_{xx}^2\\\\   \\rho v_y v_x",
    "\\\\   \\rho v_z v_x \\\\",
    "e_{xx } v_x + 2\\rho\\sigma_{xx}^2 v_x\\\\   e_{yy } v_x \\\\",
    "e_{zz } v_x \\\\ \\end{array }   \\right ]   ,    \\\\    { \\bf g}({\\bf u } ) = \\left [   \\begin{array}{l }   \\rho v_y \\\\   \\rho v_x v_y \\\\   \\rho v_y v_y + \\rho\\sigma_{yy}^2\\\\   \\rho v_z v_y \\\\",
    "e_{xx } v_y \\\\",
    "e_{yy } v_y + 2\\rho\\sigma_{yy}^2 v_y\\\\   e_{zz } v_y \\\\ \\end{array }   \\right ]   ,    &    { \\bf h}({\\bf u } ) = \\left [   \\begin{array}{l }   \\rho v_z \\\\   \\rho v_x v_z",
    "\\\\   \\rho v_y v_z \\\\   \\rho v_z v_z + \\rho\\sigma_{zz}^2 \\\\",
    "e_{xx } v_z \\\\",
    "e_{yy } v_z \\\\",
    "e_{zz } v_z + 2\\rho\\sigma_{zz}^2 v_z\\\\ \\end{array }   \\right ] , \\end{array } \\label{conservedfluxes}\\ ] ] where @xmath50 . for simplicity , in this paper",
    "we assume a diagonalised velocity dispersion tensor in the above flux vectors , neglecting off diagonal terms , ie .",
    "@xmath51 . as the dimensions of the matrix and therefore complexity of the problem",
    "grow quickly with the increasing order of moments that we consider , we leave the tracking of the off diagonal terms and higher order moments to our next paper .    by taking the conservative equations and expanding the derivatives ,",
    "it is possible to express equivalent advection equations for the primitive quantities ; density , bulk velocity and velocity dispersion :    @xmath52 ,    &   \\tilde{{\\bf f}}({\\bf w } ) = \\left [   \\begin{array}{l }   \\rho v_x \\\\   v_x v_x + \\sigma_{xx}^2\\\\   v_y v_x \\\\   v_z v_x",
    "\\\\   \\rho\\sigma_{xx}^2 v_x + \\gamma \\rho\\sigma_{xx}^2 v_x\\\\   \\rho\\sigma_{yy}^2 v_x \\\\   \\rho\\sigma_{zz}^2 v_x \\\\",
    "\\end{array }   \\right ] ,    \\\\",
    "\\tilde{{\\bf g}}({\\bf w } ) = \\left [   \\begin{array}{l }   \\rho v_y \\\\   v_x v_y",
    "\\\\   v_y v_y + \\sigma_{yy}^2\\\\   v_z v_y \\\\",
    "\\rho\\sigma_{xx}^2 v_y \\\\   \\rho\\sigma_{yy}^2 v_y + \\gamma \\rho\\sigma_{yy}^2 v_y\\\\   \\rho\\sigma_{zz}^2 v_y \\\\ \\end{array }   \\right ] ,    &    \\tilde{{\\bf h}}({\\bf w } ) = \\left [   \\begin{array}{l }   \\rho v_z",
    "\\\\   v_x v_z \\\\   v_y v_z \\\\",
    "v_z v_z + \\sigma_{zz}^2 \\\\",
    "\\rho\\sigma_{xx}^2 v_z \\\\",
    "\\rho\\sigma_{yy}^2 v_z \\\\   \\rho\\sigma_{zz}^2 v_z + \\gamma \\rho\\sigma_{zz}^2 v_z\\\\ \\end{array }   \\right ] , \\end{array } \\label{primitivefluxes}\\ ] ] where @xmath53 ( see   [ sec : tests ] ) .    for brevity",
    "we now consider just the @xmath46-directional flux vectors in the conserved quantities , @xmath54 and primitive variables , @xmath55 . as the components of the primitive flux vectors @xmath56 are each functions of the individual primitive quantities @xmath57 , the jacobian of the system in the x - direction , @xmath58 , can be expressed in terms of the partial derivatives of @xmath55 with respect to @xmath59 :    @xmath60 \\ ; .\\ ] ]    the eigenvalues @xmath61 of the system are then obtained by solving for the roots of the polynomial ,    @xmath62    where @xmath63 is the identity matrix .",
    "physically , the eigenvalues represent the speeds of signal propagation within the system and are thus important for determining the extent to which fluid bounding a cell interface affects the flux through it over the time step .",
    "unlike a collisionally dominated fluid which has five eigenvalues , the ( diagonalised ) collisionless fluid has seven to account for the anisotropy in the dispersion tensor ( for a non - diagonalised version , this increases to ten ) .",
    "we determine the eigenvalues for the @xmath46-direction to be    @xmath64^t \\ ; , \\label{eigenvalues}\\ ] ]    with @xmath65 being the sound speed in the @xmath46-direction .",
    "the directionally dependant sound speed , @xmath66 , is in close analogy to that of a standard collisionally dominated gas , @xmath67    the right eigenvectors of the jacobian , @xmath68 , are those that obey the relation @xmath69 whilst the left eigenvectors of the jacobian , @xmath70 , are those which satisfy @xmath71 . using the jacobian for the primitive variable matrix equations ,    @xmath72 \\ ; , \\label{jacobian}\\ ] ]    and the equivalent eigenvalues ( [ eigenvalues ] )",
    ", the eigenvector matrices are found to be :    @xmath73 \\ ; , \\label{righteigvec}\\ ] ]    @xmath74 \\ ; . \\label{lefteigvec}\\ ] ]    with the general form of the eigenvalues and corresponding eigenvectors calculated , we can implement them into the muscl - hancock scheme in - line with the approach taken by @xcite which we outline below .",
    "first we compute the left , right and central differences of the primitive variables using the cell centred values within each cell , where @xmath17 is the cell index .",
    "@xmath75 we then map them onto the characteristic variables using the left eigenvectors calculated using ( [ lefteigvec ] ) , where @xmath76 is the matrix corresponding to the @xmath77 row of the left eigenvector matrix , and the primitive variables @xmath78 are defined at the cell centres , @xmath79 as the scheme is higher than first order , the reconstruction of the time averaged variables at the cell interfaces , can lead to the formation of new non - physical local maxima or decreasing minima . to prevent their formation which otherwise leads to spurious post shock oscillations , we apply monotonicity constraints to the characteristic differences , ensuring that the time averaged variables are total variation diminishing ( tvd , see * ? ? ?",
    "* ) , @xmath80 the monotonised differences are then projected back onto the primitive variables , where @xmath81 is the matrix corresponding to the @xmath77 column of the right eigenvector matrix ( [ righteigvec ] ) ,    @xmath82    we now calculate the values of the primitives at the left , @xmath83 , and right , @xmath84 , cell interfaces using the primitive variable monotonised differences ,    @xmath85 \\delta { \\bf w}_{i}^m   \\ ; , \\label{stoneeqn40 }   \\\\",
    "\\tilde{{\\bf w}}_{r , i-1/2 } = { \\bf w}_{i } - \\left [ \\frac{1}{2 } - max(\\lambda_{i}^{0 } , 0 ) \\frac{\\delta t}{2\\delta x } \\right ] \\delta { \\bf w}_{i}^m \\ ; , \\label{stoneeqn41}\\end{aligned}\\ ] ]    where @xmath86 and @xmath87 are the largest and smallest eigenvalues based upon the cell centred data .",
    "we can now perform the characteristic tracing step , removing from the quantities calculated in equations ( [ stoneeqn40 ] ) and ( [ stoneeqn41 ] ) , contributions from each set of waves that travelled towards the interface but did not reach it during the forward half - time - step @xmath88 using @xcite ,    @xmath89 { \\tilde { \\bf r}}_i^{\\alpha } \\ ; , \\label{stoneeqn42 }   \\\\ { \\bf w}_{r , i-1/2 } = \\tilde{{\\bf w}}_{r , i-1/2 } + \\frac{\\delta t}{2\\delta x}\\sum_{{\\lambda}^{\\alpha } < 0 } \\left [ ( \\lambda_i^0 - \\lambda_i^{\\alpha}){\\tilde { \\bf l}}^{\\alpha } \\cdot \\delta { \\bf w}_i^m \\right ] { \\tilde { \\bf r}}_i^{\\alpha } \\ ; . \\label{stoneeqn43}\\end{aligned}\\ ] ]    with time averaged primitive values calculated for each cell face , godunov s fluxes can now be computed and applied using a conventional riemann solver technique such as the accurate roe scheme .",
    "if using an approximate riemann solver such as the hll scheme , then due to the averaging of the intermediate eigenstates between the fastest left and right waves , it is necessary to add the additional terms ( [ stoneeqn44 ] ) and ( [ stoneeqn45 ] ) shown below , to equations  ( [ stoneeqn42 ] ) and ( [ stoneeqn43 ] ) respectively .",
    "@xmath90 { \\tilde { \\bf r}}_i^{\\alpha } \\ ; , \\label{stoneeqn44 }   \\\\ { \\bf w}_{r , i-1/2 } = - \\frac{\\delta t}{2\\delta x}\\sum_{{\\lambda}^{\\alpha } > 0 } \\left [ ( \\lambda_i^{\\alpha } - \\lambda_i^{0}){\\tilde { \\bf l}}^{\\alpha } \\cdot \\delta { \\bf w}_i^m \\right ] { \\tilde { \\bf r}}_i^{\\alpha } \\ ; . \\label{stoneeqn45}\\end{aligned}\\ ] ]    these remove the effect of waves which propagate away from the cell interface which would otherwise be included , allowing for the scheme to achieve second order accuracy .",
    "through the use of operator splitting , we can deal with the addition of extra source and sink terms , including gravity , separately after the collisionless stellar hydrodynamics step . to ensure that the gravitational acceleration term is kept second order accurate in time , we store the acceleration from the previous time step and interpolate forward to account for temporal variation in the gravitational field",
    ". additional source and sink terms can include star formation and supernova , although we only consider gravity in this paper .",
    "notwithstanding a formal similarity of the che and bme , testing the latter is nontrivial as it requires knowing analytical solutions for the dynamics of _ collisionless _ systems .",
    "fortunately , some of the test problems that are used to benchmark the performance of hydro codes can be adapted to test the collisionless systems .",
    "this is because equations  ( [ contin])-([dispers ] ) can be made formally identical to those of classical hydrodynamics in special cases . indeed , for a one - dimensional flow of a non - gravitating collisionless fluid along the @xmath46-direction , the bme become @xmath91 = 0 \\ ; .\\end{aligned}\\ ] ] if we now assume that @xmath92 is equal to the gas pressure @xmath93 in classic hydrodynamics and @xmath94 then as @xmath95 , i.e. the ratio of specific heats @xmath96 is equal to 3 , then equations  ( [ contin1d])-([dispers1d ] ) turn into the following form @xmath97 = 0 \\ ; , \\end{aligned}\\ ] ] which are exactly one - dimensional classic hydrodynamics equations .",
    "the fact that the bme for a one - dimensional flow turns into the che for @xmath53 is not a coincidence but is related to the fact that a one - dimensional flow of a collisionless fluid has only _ one _ translational degree of freedom @xmath98 , unlike a collisional fluid which can still be characterised by @xmath99 due to frequent collisions that equipartition the kinetic energy of particles between the three translational degrees of freedom .",
    "this means that in order to properly describe the one - dimensional flow of a collisionless fluid using the classical hydrodynamics approach , one needs to assume that the fluid has only one translational degree of freedom , i.e. @xmath100 .",
    "it is straightforward to show that for a two - dimensional flow of a collisionless fluid , one needs to consider a specific case with @xmath101 and @xmath102 and also @xmath103 , i.e. a flow of a collisional fluid with two degrees of freedom .",
    "the above analysis allows us to use the standard sod shock tube problem , often employed to benchmark collisional hydro codes . to generate an analytic solution to a one - dimensional discontinuous state along the @xmath46-coordinate , we choose @xmath53 and use the standard solution procedure @xcite .",
    "for a two - dimensional discontinuous state in the @xmath104 plane at an arbitrary angle @xmath105 to the @xmath46-direction , an analytic solution is obtained by choosing @xmath103 .    in the 1d case ,",
    "we run the test along the @xmath46-coordinate and set @xmath92 and @xmath21 at @xmath106 $ ] to 1.0 , while at @xmath107 $ ] the x - component of the stress tensor is set to 0.1 and the stellar density is 0.125 .",
    "the numerical resolution is 200 grid zones and the cells are equidistantly spaced . in the 2d case , we align the initial fluid discontinuity along the [ 1,1,0 ] plane and use the same densities and velocity dispersions as were set for the 1d setup setting @xmath108 in order to yield agreement with the results for an isotropic collisionally dominated gas .",
    "this yields a shock wave which propagates at @xmath109 to the @xmath46 and @xmath47 axes .",
    "again we use 200 cells in the @xmath46 and @xmath47 directions and note that the setup can easily be extended to three dimensions although for brevity we do not show these here .",
    "figures  [ fig1 ] and [ fig2 ] show the results of our tests for the 1d and 2d setups , respectively , at @xmath110=0.1 using the hllc riemann solver . in particular ,",
    "the top - left , top - right , bottom - left , and bottom - right images show the density , velocity , the x - component of the stress tensor @xmath111 , and @xmath112 . the latter two quantities may be regarded as analogues to the gas pressure @xmath93 and internal energy density @xmath113 in classical hydrodynamics . in the 1d case , the plotted velocity is @xmath114 , whereas in the 2d case we plot the absolute value of velocity @xmath115 along the diagonal @xmath116 , i.e. , along the direction of the shock wave propagation .",
    "it is evident that the riemann - solver - based numerical scheme can trace the shock waves ( propagating to the right ) very well , usually within one to two grid zones .",
    "contact discontinuities ( propagating to the left ) are smeared to a greater extent , usually by 5 - 6 grid zones .",
    "nevertheless , the position of the shock waves and contact discontinuities along with the values of the flow variables are reproduced quite accurately .    in a conventional collisional shock",
    ", the energy of the macroscopic motion of the gas is transfered through collisions into random isotropic kinetic motions of the particles ( thermal energy ) . in a collisionless fluid , the energy of macroscopic motion is transfered into an effective increase in the velocity dispersion as stellar streams with different velocities mix at the shock front .",
    "open circles in figure  [ fig3 ] present the results of the 1d sod shock tube test using the kt scheme .",
    "it is evident that this scheme does not provide as good an agreement with the analytic solution as the hllc riemann solver , particularly for the velocity dispersion ( bottom - right panel ) . in the kt scheme ,",
    "the shock fronts and contact discontinuities are smeared out over roughly twice as many grid zones as in the hllc scheme .",
    "however encouragingly , the positions of the shocks and discontinuities and also the values of the flow variables are still accurately reproduced .",
    "all in all , the hllc scheme shows an undoubtedly superior performance though at a higher cpu cost , with the kt scheme typically taking around 22% less time to run and a near identical amount of memory .",
    "the gravitational collapse of a pressure - free sphere is used to assess the code s ability to accurately treat converging spherical flows on the cartesian grid .",
    "this test is also useful for estimating the performance of the gravitational potential solver on dynamical problems for which one has to use a finite - difference form of the gravitational potential _",
    "gradient_. since the test setup involves no stress tensor , the resulting equations are identical in the collisionless and collisional fluid dynamics cases and one can use an analytic solution describing the collapse of every mass shell in the limit of an infinite sphere radius @xcite .    to run this test , we set a cold homogeneous sphere of unit radius and density ( for convenience , the gravitational constant is also set to unity ) and let it collapse under its own gravity .",
    "we use a block size of @xmath117 cells and six levels of refinement leading to an effective grid size of @xmath118 cells .",
    "we adopt isolated gravitational boundary conditions .",
    "unfortunately , we must consider a cloud of finite radius in cartesian geometry with a sharp outer boundary to preserve the cloud sphericity . as a result",
    ", a rarefaction wave develops after the onset of the collapse , propagating towards the coordinate origin and necessitating complicated corrections to the analytic solution .",
    "figure  [ fig4 ] compares the results of our numerical simulation with the `` uncorrected '' analytic solution of @xcite ( solid line ) at 0.985 free fall timescales , when the initial density has increased by nearly three orders of magnitude .",
    "the majority of cells within the sphere lie upon the analytic solution indicating a good homologous collapse with only a small peak above the analytic solution forming within the very central few cells .",
    "in addition to this small peak , the initially sharp boundary of the cloud is smeared out over several cells as a result of the rarefaction developing .",
    "the analytic radii of the cloud however shows reasonable agreement with the radii at which the half peak density is reached . in general , our results are found to be in strong agreement with those of other authors applying this test problem to the classic hydrodynamics ( e.g. , * ? ? ?",
    "* ) .      as a third test , to demonstrate that the code can model the formation of anisotropies , we initialise two copies of the same sphere as in   [ sec : sphercollapse ] with a non - negligible dispersion tensor . in one",
    "we initially set an isotropic dispersion tensor whilst in the second we initially weight the different diagonal terms @xmath119 with the ratio of @xmath120 .",
    "we set the system up so that the initial maximum effective dispersion energy is only 25% of that needed to support the sphere against gravitational collapse .",
    "this allows the sphere to collapse down from its initially symmetric configuration and deform into an ellipsoid .",
    "the velocity dispersion is then free to change as the simulation evolves .",
    "we plot in figure  [ fig5 ] the density contour for @xmath121 at regular time intervals for both the cloud with an isotropic dispersion tensor ( left hand panel ) and an anisotropic dispersion tensor ( right hand panel ) .",
    "the isotropic dispersion tensor leads to a collapse which is isotropic as expected whilst in the anisotropic case , the collapse proceeds quickest in the direction with the lowest dispersion term .",
    "this leads to a flattening of the sphere into an ellipse .    in figure  [ fig6 ]",
    "we plot the ellipticity of the collapsing anisotropic cloud as a function of time .",
    "the ellipticity is determined to be the ratio between the minor and major axes of the ellipsoid over a specified iso - density surface .",
    "the solid line corresponds to the ellipticity of the iso - density surface of @xmath122 and the dashed line is the ellipticity for @xmath123 .",
    "initially , since the velocity dispersion is lowest in the x - direction , material along that axes collapses fastest , with the ellipticity increasing as the density builds .",
    "this leads to a greater effective pressure , @xmath124 , from the velocity dispersion .",
    "eventually the core collapses to a density and pressure sufficient to stop further collapse . at this point",
    "the sphere begins to isotropise as material from the other two axial directions catches up and falls onto the core .",
    "this collapse of material onto the core , drives up the pressure and material is forced out around @xmath125 along the x - direction where least resistance is offered .",
    "this again increases the ellipticity and results in the major and minor axes of the ellipse switching places as the x - axis becomes the major instead of the minor axis and vice versa for the z - axis .",
    "the system then oscillates between a high degree of ellipticity and near spherical symmetry as the different axes of the ellipsoid collapse and rebound at different times and speeds .",
    "these oscillations repeat over many free fall timescales .",
    "material at a lower density follows the same cyclical pattern of varying ellipticity but with less pronounced maxima and minima . as a result of the non - linear nature of the collapse and its relative separation from the violent oscillations within the core , transitions at lower density are also smoother .",
    "the final test problem describes the growth of a spiral structure in a gravitationally unstable stellar disc .",
    "the stability analysis of a thin stellar disc to a local axisymmetric perturbation states that the disc is gravitationally unstable if @xcite @xmath126 where @xmath127 is the radial stellar velocity dispersion , @xmath128 is the epicycle frequency , and @xmath129 is the stellar surface density . a finite disc thickness and non - axisymmetric perturbations may increase the critical toomre parameter @xmath130 by a factor of unity .",
    "the initial setup consists of a self - gravitating , rotating stellar disc submerged in a fixed dark matter ( dm ) halo .",
    "the latter is described by the quasi - isothermal density profile of the form @xmath131 where @xmath132 is the galactocentric distance .",
    "the central density @xmath133  pc@xmath134 and the characteristic scale length of the quasi - isothermal halo @xmath135  kpc are calculated based on the assumed dm halo mass @xmath136 and halo radius , @xmath137  kpc , using relations provided in @xcite .",
    "the computational box spans 30  kpc in each coordinate direction @xmath138 .",
    "the numerical procedure for generating a rotationally supported stellar disc in the combined gravitational potential of stars and dm halo is described in detail in @xcite .",
    "the rotation curve , the radial gas surface density profile and the radial profile of the toomre parameter @xmath139 of the initial stellar disc are plotted in fig .",
    "[ figsp1 ] with the solid , dashed , and dot - dashed lines , respectively .",
    "evidently , the disc is initially gravitationally unstable .",
    "figure  [ figsp2 ] presents a series of disc images at several successive times since the beginning of numerical simulations .",
    "usually , an initial seed perturbation is required to drive the system out of equilibrium and initiate the growth of a spiral structure .",
    "however , in our case , the initial perturbation is introduced due to a re - map of the initial equilibrium configuration from the cylindrical coordinates @xcite onto the cartesian coordinates ( the flash code ) .",
    "the growth of a two - armed spiral mode is apparent in the figure .    to quantify the growth rate of spiral modes in our model ,",
    "we employ global fourier amplitudes defined as @xmath140 where @xmath141 is the spiral mode , @xmath142 is the surface density of the stellar disc , @xmath143 is the polar angle , and @xmath144 is the total mass of the stellar disc .",
    "the amplitudes are calculated on a square region with size @xmath145  kpc , which is centred on the coordinate origin and encompasses the growing spiral .",
    "the global fourier amplitudes can be regarded as the amplitude of a spiral density perturbation relative to the surface density of the axisymmetric disc .",
    "figure  [ figsp3 ] shows the temporal evolution of the first six global fourier amplitudes ( in log units ) in our model stellar disc .",
    "initially all amplitudes are negligibly small except for that corresponding to the @xmath146 mode .",
    "this is a numerical artifact and arises due to the finite resolution within the core .",
    "similar to the results of @xcite in which they model a static king - profile that is initially in hydrostatic equilibrium , the finite resolution within the core leads to an under - resolved gravitational potential .",
    "this results in a slight relaxation and expansion of the very central region .",
    "an outward flow of material results through the faces of the central most cell and due to the fact that our disk is constructed so as to promote the growth of gravitational instabilities , this generates a small yet non - negligible perturbation .",
    "although similar behaviour may occur in all mesh codes , those using cartesian geometries are particularly susceptible given their strong natural bias for flows along the axes of the mesh . despite being present from the very onset of the simulation , the @xmath146 mode slowly decays and does not lead to the growth of a spurious four armed spiral given the dominance of the @xmath147 mode at late times by around two orders of magnitude .",
    "the @xmath147 mode demonstrates the fastest growth rate .",
    "it saturates at around @xmath148  myr and declines slowly in the subsequent evolution due to continuing disc heating .",
    "the maximum amplitude of the @xmath147 mode is about @xmath149 , which suggests a non - axisymmetric density perturbation of about 2% relative to the underlying axisymmetric disc .",
    "an appealing physical interpretation for the growth of a spiral structure in our model disc is swing amplification .",
    "amplification occurs when any leading spiral disturbance , e.g. , introduced by the initial seed perturbation , unwinds into a trailing one due to differential rotation ( e.g. * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "in addition , swing amplification needs a feedback mechanism that can constantly feed a disc with leading spiral disturbances . trailing short - wavelength disturbances propagating through the disc centre and emerging on the other side as leading ones provide a feedback for the swing amplifier @xcite .",
    "we can check if the growth mechanism of our spiral structure is consistent with the predictions of the swing amplification theory . for our spiral pattern to be triggered by the swing amplifier",
    ", there should be no inner lindblad resonance ( ilr ) for the @xmath147 mode .",
    "otherwise , the corresponding trailing disturbances will damp at the ilr , thus failing to pass through the disc centre and promoting the growth of the @xmath147 mode .",
    "figure  [ figsp4 ] shows the radial profiles of @xmath150 and @xmath151 at @xmath152  myr , where @xmath150 is the angular velocity of the stellar disc and @xmath128 is the epicycle frequency .",
    "both quantities are the azimuth averages .",
    "in particular , the solid and dashed lines show the corresponding values for the @xmath147 and @xmath153 modes , respectively .",
    "the dash - dot - dot - dotted and dash - dotted lines show the angular velocity @xmath154 of the global spiral pattern measured at two distinct positions in the disc : 2.0  kpc and 4.0  kpc . in theory ,",
    "@xmath154 should be independent of radius , though in practice it is always slightly faster in the inner regions than in the outer ones due to gradual winding of a spiral pattern .",
    "the radial position of lindblad resonances are determined as @xmath155 , i.e. , as the radial distance where the forcing frequency of the spiral pattern coincides with the epicycle frequency of the stars .",
    "in particular , the inner and outer lindblad resonances correspond to the plus and minus signs , respectively .",
    "figure  [ figsp4 ] demonstrates that there is clearly no ilr for the @xmath147 mode , whereas there is one marginally for the @xmath153 mode ( and thus for any higher - order mode ) .",
    "indeed , the dash - dotted and dash - dot - dot - dotted lines never intersect the @xmath156 curve , whereas they do intersect the @xmath157 curve at @xmath158  kpc , thus damping @xmath153 disturbances that try to pass through the disc center . although slight growth over time of the @xmath153 mode is observed in figure  [ figsp3 ] , it is damped relative to the @xmath147 mode by over two orders of magnitude .",
    "higher order modes for which a clearer ilr will be present are damped to a much greater extent .",
    "this explains why the @xmath147 mode ( and not any higher - order mode ) ultimately dominates the spiral pattern .",
    "another consistency check on our model is the position of the outer lindblad resonance ( olr ) .",
    "spiral disturbances can not propagate through the olr , which effectively limits the radial extent of a spiral pattern .",
    "figure  [ figsp4 ] indicates that the olr for the @xmath147 mode is located approximately at 4  kpc and this value is in agreement with the radial extent of the spiral pattern in fig .",
    "[ figsp2 ] .",
    "we conclude that our numerical results are in general agreement with the predictions of the swing amplification theory .",
    "in this paper we have outlined a series of important limitations that are encountered in mesh codes when using the particle - mesh technique . used to consistently integrate collisionless stellar or dark matter components into simulations which model gas physics on an eulerian mesh , the particle - mesh technique has the advantage of being relatively straight forward to implement but is unfortunately subject to several key limitations .",
    "from a technical perspective these include poor load balancing and increased communication overhead . from a physical point of view",
    ", discreteness effects incurred when discrete particle properties are mapped to the mesh , are believed to result in spurious entropy generation . in galaxy formation simulations , this can have a significant influence on the reservoir of cold gas available to form stars , potentially changing the entire dynamics of the system .    to overcome these limitations",
    "we have proposed the use of the collisionless boltzmann moment equations as a powerful alternative .",
    "such an approach allows us to model the collective properties of collisionless objects such as stars as a fluid , instead of relying upon the traditional n - body approach . in this paper",
    "we refer to this approach as `` collisionless stellar hydrodynamics '' given its primary use in the modelling of the properties of large collections of stars , such as those in a galaxy , in much the same way as we model gases in eulerian grid codes .",
    "although direct integration of the collisionless boltzmann equation has been undertaken by other authors , it is often prohibitively expensive to perform .",
    "this arises as it is necessary to track both the spatial domain and its corresponding velocity phase space .",
    "however @xcite demonstrates that the ability to resolve small scale velocity fluctuations is much greater in these codes than for conventional n - body simulations .    instead of a costly direct integration of the boltzmann equation",
    ", we opt to derive the zeroth , first and second order moments under the usual zero heat flux approximation and taking the third order moments to be negligible .",
    "although ultimately an approximation , we show that this yields results in - line with a series of demanding test problems , requiring a factor of @xmath159 less memory than is needed using direct integration over the complete velocity phase space .",
    "we implement these new collisionless stellar hydrodynamic equations into the massively parallel flash  amr  code using two different numerical solvers for hyperbolic partial differential equations .",
    "the first scheme by @xcite , requires no information on the equation of state of a collisionless fluid or any assumptions about the behaviour of fluid interactions within the riemann fan .",
    "this riemann solver free prescription allows us to track sharp discontinuities with relatively low numerical diffusion and provides a very useful comparison with which to compare our more sophisticated second scheme . in future ,",
    "its extensibility is hoped to be used to explore the impact of including the higher order moments which we exclude here .    by assuming a diagonalised dispersion tensor , we have derived the eigenvalues and eigenvectors for the first three moments of the collisionless boltzmann equations .",
    "these have been implemented into a characteristic tracing method based on the muscl - hancock unsplit advection scheme .",
    "this allows time averaged primitive states to be calculated at the cell interfaces using characteristic tracing , from which time averaged fluxes can be computed using a range of riemann solvers .",
    "we validate our code using a suite of tests with analytic solutions , including some commonly used to benchmark conventional hydrodynamic codes . by realising that the classic hydrodynamic equations and boltzmann moment equations can be reconciled under certain conditions , we are able to generate analytic solutions for the sod shock test which are applicable for collisionless systems . of particular note",
    ", we find that since a collisionless fluid has only one degree of freedom in a given direction and is unable to equipartition the kinetic energy of particles between the three dimensions through collisions , it has an effective ratio of specific heats , @xmath160 .",
    "thus in 1d , a sod shock solution for a collisionally dominated gas with @xmath160 , matches that for a collisionless fluid . using this insight",
    ", we confirm that our numerical schemes ; both the kt scheme  and characteristic tracing method , accurately reproduce analytic solutions .",
    "although the kt scheme  runs 22% faster with near identical memory consumption , our riemann solver based scheme shows notably better resolving power of sharp shocks and discontinuities , spreading them over roughly half the number of cells .    through the use of a spherical pressure - free collapse problem",
    ", we confirm that the code can maintain good flow symmetry in convergent flows in the absence of any anisotropy in the dispersion tensor .",
    "agreement with the peak density within the collapsed sphere also confirms the validity of the poisson solver used in flash . through the inclusion of a non - negligible anisotropic dispersion tensor , we extend the spherical collapse to observe the behaviour of an initially homologous spherical cloud as it collapses and deforms into an elliptical profile . although initial behaviour of the system occurs in - line with expectations , the long term behaviour is more complicated with repeated transitions between an elliptical and spherical profile , along with switching of the major and minor axes after the initial core implosion . although the inclusion of gas physics may help to isotropise the internal structure of the cloud and damp these oscillations , they will nevertheless remain important to the dynamics outside of the core .",
    "we will explore in more detail interactions between the collisionally dominated gas physics and the stellar material in future papers .",
    "in particular , we will extend our scheme to include off - diagonal terms and a more thorough exploration of the effects of higher order terms .",
    "although powerful in its current form , the addition of off - diagonal terms in the velocity dispersion tensor will allow us to directly measure the vertex deviation , a key observable used for probing galactic structure . to date observers have made extensive measurements of our own milky way s vertex deviations which can hide detailed information about the kinematic properties of the bar and spiral arms .",
    "however noise in particle based simulations has made accurate theoretical predictions difficult , something which our new collisionless stellar hydrodynamics code can allow us to overcome . having already confirmed the applicability of the collisionless stellar hydrodynamics code to the formation of spiral structure , we have found excellent agreement between our numerical simulations of the growing spiral pattern and the predictions of the swing amplification theory , with the correct relation between the disc size and the outer lindblad resonances being observed .",
    "as a final note , we find the time taken in flash  for the riemann solver based collisionless stellar hydrodynamics routine is only 7% greater than that for the original classic hydrodynamic scheme , allowing the collisionless stellar hydrodynamics to scale linearly with the classic hydrodynamics .",
    "we also find that instead of doubling the overall amount of time spent communicating when both gas and collisionless stellar hydrodynamics are included , our grouping of communications results in a net increase of only 1.2% to the overall communication time compared to that of just a single phase hydrodynamic scheme .",
    "thus we conclude by confirming that our new collisionless stellar hydrodynamic approach using the boltzmann moment equations both preserves the excellent scaling previously demonstrated in flash  as well as enhancing the level of detail we can expect to be able to extract from our results , with none of the discreteness effects observed for particle - mesh techniques .",
    "the authors acknowledge the generous support of the austrian fwf for project numbers p21097-n16 ( nigel l. mitchell ) and lise meitner fellowship m1255-n16 ( eduard i. vorobyov ) .",
    "the software used in this work was in part developed by the doe nnsa - asc oascr flash center at the university of chicago .",
    "the computations were performed at the vienna scientific cluster ( vsc ) and the astrocluster of the institute for astrophysics , funded by the university of vienna .",
    "on general grounds one can argue that the boltzmann moment equations ( [ contin])-([dispers ] ) should convolve to the classic hydrodynamics equations ( che ) if the stress tensor @xmath14 is diagonal and isotropic . in this section",
    "we demonstrate this by assuming that @xmath161 for @xmath162 and @xmath163 , implying that @xmath164 .",
    "the equation of continuity ( [ contin ] ) is identical to that of the che and the momenta equations ( [ moment ] ) trivially turn into their collisional counterparts with a substitution @xmath165 ( and identical relations for other components ) , where @xmath93 is the gas pressure .",
    "it takes a bit more math to show that the dispersion equations  ( [ dispers ] ) can be convolved to the equation for the total energy per unit volume @xmath166 .",
    "let us expand equation  ( [ dispers ] ) into the component form in cartesian coordinates .",
    "@xmath167 after summing up equations  ( [ eqn1])-([eqn3 ] ) we obtain @xmath168 \\nonumber \\\\   \\label{eqn4 } & - & \\rho u_i a_i = 0 \\ ; , \\end{aligned}\\ ] ] where we have divided the resulting equation by a factor of 2 and have taken into account that @xmath164 and @xmath169 . in the classical hydrodynamics the gas pressure relates to the internal energy density via the relation @xmath170 , where @xmath171 for a flow with three translational degrees of freedom , meaning that @xmath172 in the above equation .",
    "the final step is to note extract the diagonal part from the symmetric tensor @xmath173 by introducing the viscous stress tensor @xmath174 .",
    "@xmath175 with this final transformation , equation  ( [ eqn4 ] ) turns into the usual hydrodynamics equation for the total energy per unit volume @xmath176 of a viscous fluid .",
    "@xmath177 - \\rho u_i a_i = 0 \\ ; .\\ ] ]",
    "when deriving the boltzmann moment equations , each equation for the @xmath178-th moment inevitably requires the knowledge of the @xmath179 moment .",
    "this chain is conventionally closed by setting the third - order moments to zero , i.e. , @xmath13 . in this section ,",
    "we discuss the validity of this approximation .    for this purpose",
    "it is useful to refer to a similar problem in the collisional hydrodynamics , for which the closure problem exists as well .",
    "indeed , the che are derived from the _ collisional _ boltzmann equation and if the zero - heat - flux approximation were relaxed , then equation  ( [ eqn5 ] ) would have an additional term @xmath180 a contemporary swindle is to use the empirical fourier law for thermal conduction and assume that @xmath181 where @xmath182 is the gas temperature and @xmath183 is the heat conduction coefficient .",
    "unfortunately , such a trick can not be applied to a collisionless fluid as it , strictly speaking , has no temperature due to the lack of local thermal equilibrium .",
    "however , this analysis can give us an insight as to when the zero - heat - flux approximation can not be neglected .",
    "in the che , such a situation arises on a quasi - stationary contact discontinuity between two gases with vastly different temperatures when the thermal diffusion time scale @xmath184 can be much shorter than dynamical one @xmath185 , where @xmath186 is the characteristic size of the system . in most astrophysical environments , however , the bulk motions of gas ensure that @xmath187 and the third - order moments can be neglected .    in the case of collisionless systems ,",
    "the diffusion time scale is played by the typical relaxation time @xmath188 , which should be compared against @xmath189 .",
    "it is apparent that the zero - heat - flux approximation is expected to be valid if @xmath190 this condition is usually met in any rotationally supported system like a galactic stellar disc , with @xcite highlighting stellar dynamic models which show the third order moments decay faster than the relaxation timescales .",
    "this means that the zero - heat - flux approximation is approached faster than isotropisation .",
    "however , this condition may break in globular clusters that are thought to be supported against gravitational collapse by random motions of stars ( i.e. , by high velocity dispersions ) .",
    "this does not invalidate the whole boltzmann moment approach approach , but simply means that an important piece of physics is missing and needs to be taken into account .",
    "we work on developing useful approximations that can treat such cases in collisionless fluids .",
    "antypas , k.b . , calder , a.  c. , dubey , a. , gallagher , j.  b. joshi , j. , lamb , d.  q. , linde , t. , lusk , e. et al .",
    ", `` flash : applications and future . '' , parallel computational fluid dynamics 2005 : theory and applications , 2006 , 325 ( elsevier science )"
  ],
  "abstract_text": [
    "<S> the dominant constituents of the universe s matter are believed to be collisionless in nature and thus their modelling in any self - consistent simulation is extremely important . for simulations that deal only with dark matter or stellar systems , </S>",
    "<S> the conventional n - body technique is fast , memory efficient , and relatively simple to implement . </S>",
    "<S> however when extending simulations to include the effects of gas physics , mesh codes are at a distinct disadvantage compared to sph  codes . whereas implementing the n - body approach into sph  codes is fairly trivial , the particle - mesh technique used in mesh codes to couple collisionless stars and dark matter to the gas on the mesh , has a series of significant scientific and technical limitations . </S>",
    "<S> these include spurious entropy generation resulting from discreteness effects , poor load balancing and increased communication overhead which spoil the excellent scaling in massively parallel grid codes .    in this paper </S>",
    "<S> we propose the use of the collisionless boltzmann moment equations as a means to model the collisionless material as a fluid on the mesh , implementing it into the massively parallel flash  amr  code . </S>",
    "<S> this approach which we term `` collisionless stellar hydrodynamics '' enables us to do away with the particle - mesh approach and since the parallelisation scheme is identical to that used for the hydrodynamics , it preserves the excellent scaling of the flash  code already demonstrated on peta - flop machines .    </S>",
    "<S> we find that the classic hydrodynamic equations and the boltzmann moment equations can be reconciled under specific conditions , allowing us to generate analytic solutions for collisionless systems using conventional test problems . </S>",
    "<S> we confirm the validity of our approach using a suite of demanding test problems , including the use of a modified sod shock test . by deriving the relevant eigenvalues and eigenvectors of the boltzmann moment equations , we are able to use high order accurate characteristic tracing methods with riemann solvers to generate numerical solutions which show excellent agreement with our analytic solutions . </S>",
    "<S> we conclude by demonstrating the ability of our code to model complex phenomena by simulating the evolution of a two armed spiral galaxy whose properties agree with those predicted by the swing amplification theory .    </S>",
    "<S> methods : numerical  hydrodynamics </S>"
  ]
}