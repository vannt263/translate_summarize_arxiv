{
  "article_text": [
    "this paper is a companion to @xcite , which established the algebraic generating function for @xmath0-avoiding permutations conjectured by vaclav kotesovec @xcite . in similar vein",
    ", vladimir kruchinin @xcite has conjectured the @xmath1 for @xmath2-avoiding permutations , where @xmath3 denotes the for the catalan numbers .",
    "we will show that do indeed have this .",
    "first , we use the combinatorial interpretation of the invert transform to reduce the problem to counting _ indecomposable _ .",
    "then we exhibit a bijective mapping from the set of indecomposable of length @xmath4 to the union of cartesian products @xmath5 , where @xmath6 is the set of indecomposable 321-avoiding permutations of length @xmath7 and @xmath8 is the set of integer sequences @xmath9 satisfying @xmath10 and @xmath11 for @xmath12 .",
    "the counting sequences for the sets @xmath13 and @xmath8 are known , and the result follows readily .",
    "section 2 recalls the notion of indecomposability and the application of the invert transform to indecomposable permutations .",
    "section 3 reviews nonnegative lattice paths and integer sequences whose successive entries increase by at most 1 , that is , elements of @xmath8 .",
    "section 4 defines some notions relevant for our bijection .",
    "section 5 presents the main bijection and section 6 explains why it works .",
    "section 7 ties everything together .",
    "a _ standard _ permutation is one on an initial segment of the positive integers and to _ standardize _ a permutation on a set of positive integers means to replace its smallest entry by 1 , next smallest by 2 and so on , thereby obtaining a standard permutation . in the context of pattern avoidance , we consider standard permutations written in one - line form ( that is , as lists ) . when a standard permutation is written in two - line form",
    ", it may be possible to insert some vertical bars to obtain subpermutations , not necessarily standard , as in @xmath14 .",
    "after inserting the largest possible number ( 0 or more ) of such bars , as in @xmath15 , we obtain the _ components _ of the permutation , here 312 , 654 , 7 .",
    "a permutation is _ indecomposable _ if it has exactly one component .",
    "( thus the permutation 1 is indecomposable but the empty permutation is not . )    let @xmath16 denote the for and @xmath17 the for indecomposable .",
    "clearly , a permutation avoids @xmath2 if and only if each of its components does so .",
    "hence , the combinatorial interpretation of the invert transform ( see @xcite for example ) implies that @xmath18 and our problem is reduced to showing that @xmath19 .",
    "it is well known that the `` ballot number '' @xmath20 @xmath21 ( with @xmath22 if @xmath23 and @xmath24 if @xmath25 ) counts nonnegative paths of @xmath26 upsteps @xmath27 and @xmath4 downsteps @xmath28 , where nonnegative means the path never dips below , the horizontal line through its initial vertex ( see , e.g. , @xcite ) .",
    "a nonnegative path of @xmath4 upsteps and @xmath4 downsteps is a _ dyck _ path and its _ size _ is @xmath4 .",
    "a nonempty dyck path is _ indecomposable _ if its only return to is at the end . the returns to split a dyck path into its ( indecomposable ) components .",
    "the number of indecomposable dyck paths of size @xmath4 is @xmath29 ( delete the first and last steps to obtain a one - size - smaller dyck path ) .",
    "@xmath30 [ count1 ] the number of indecomposable 321-avoiding permutations on @xmath31 $ ] is @xmath29 .",
    "one method is to observe that krattenthaler s bijection @xcite from 321-avoiding permutations on @xmath31 $ ] to dyck paths of size @xmath4 preserves components in the obvious sense and so sends indecomposable permutations to indecomposable paths .    given a nonnegative path , successively delete the first peak ( @xmath32 ) recording its height above until no peaks remain , as in figure 1 ( heights prepended to existing list ) .",
    "= 0.4 cm @xmath33    the path on the left produces the list of heights 3442 and this is a map from nonnegative paths of @xmath26 @xmath34s and @xmath4 @xmath35s to @xmath36 .    to reverse the map ,",
    "suppose given @xmath37 .",
    "start with a path of @xmath38s . then successively insert a peak at height @xmath39 into the initial ascent of the current path so that its top vertex is at height @xmath40 .",
    "this produces a path whose first peak is at height @xmath39 and the growth condition @xmath41 is just what is needed to enable the next step .",
    "so the map is a bijection and we have    @xmath30 [ count2 ] @xmath42 .",
    "the preceding construction will be mirrored in section [ whyworks ] below when we insert a `` peak '' entry into a permutation so that if it has `` height '' @xmath43 , then there are @xmath44 possibilities for the next insertion .",
    "by ( slight ) abuse of language , to delete an entry @xmath45 $ ] from a permutation @xmath46 on @xmath31 $ ] means to erase @xmath47 and then subtract 1 from each entry @xmath48 ; @xmath49 denotes the resulting permutation .",
    "the non-@xmath47 entries of @xmath46 correspond in an obvious way to the entries of @xmath49 .",
    "conversely , to insert @xmath47 in position @xmath50 means to increment by 1 each entry @xmath51 and then place @xmath47 in position @xmath50 ; we use @xmath52 to denote the result .",
    "thus , for @xmath53 .",
    "again , the entries of @xmath46 correspond naturally to the non-@xmath47 entries of @xmath54 . the adjective / noun is short for left - to - right maximum in a permutation .",
    "* _ henceforth , for brevity , we use the unadorned term `` avoider '' to mean an indecomposable @xmath55-avoider . _ *    a _",
    "key-2 _ entry in an avoider is an entry that serves as the `` 2 '' in either a 321 pattern or a 4312 pattern .",
    "for example , the key-2 entries in 6174235 are 4 and 3 .",
    "clearly , an avoider with no key-2 entries is a 321-avoider .",
    "the term key-2 is mnemonic but somewhat ungainly and to add a little color , * we will refer to a key-2 entry as a _",
    "entry*.    the _ peak _ entry in an avoider that contains ( one or more ) 321 patterns is the larger of the last `` 1 '' of a 321 and its ( immediate ) predecessor . the terminology is justified because the peak is indeed a : suppose @xmath56 is the last `` 1 '' of a 321 in an avoider , say the last `` 1 '' of @xmath57 , and @xmath47 is the predecessor of @xmath56 .",
    "if @xmath58 , then @xmath56 is the `` 2 '' of the 4312 pattern @xmath59 . if @xmath60 , then @xmath61 or @xmath62 . in the former case , @xmath47 is the `` 2 '' of the 321 pattern @xmath57 ; in the latter case , @xmath63 ( else @xmath59 is a proscribed 3241 ) and so @xmath47 is the `` 2 '' of the 321 pattern @xmath64 .",
    "see figure 2 for some examples of avoiders with blue entries so colored and peak blue entry highlighted .",
    "we let @xmath65 denote the set of avoiders ( indecomposable @xmath66-avoiding permutations ) of length @xmath4 , and similarly @xmath67 is the set of indecomposable @xmath68-avoiding permutations . set @xmath69 .",
    "for @xmath70 , there is a bijection @xmath71    here is its description .",
    "suppose given @xmath72 .",
    "if @xmath73 , then @xmath46 is already 321-avoiding and @xmath74 is the image pair , where @xmath75 denotes the empty list . if @xmath76 , the idea is to successively delete the ( current ) peak entry recording , in the same right to left fashion as in figure 1 , its `` height '' , appropriately defined , until a 321-avoider @xmath77 is obtained .",
    "then the image pair is @xmath78 , where @xmath79 is the list of heights .",
    "the trick is to find the correct definition of height , and it s a doozy .    to this end ,",
    "associate to each 321-containing permutation @xmath46 a triple @xmath80 , all integers except that @xmath81 may be infinite : @xmath56 is the last `` 1 '' of a 321 in @xmath46 , @xmath82 is the rightmost entry to the left of @xmath56 that exceeds @xmath56 , and @xmath81 is the first non - lrmax entry after @xmath56 ( with @xmath83 if there is no such lrmax ) .",
    "thus , for @xmath84 , we have @xmath85 and for @xmath86 , we have @xmath87 .    [ w ] if @xmath46 is a @xmath68-containing avoider with associated triple @xmath88 , then there is an entry @xmath89 in @xmath46 such that @xmath90 is a @xmath68 pattern in @xmath46 .    proof .",
    "since @xmath56 is the `` 1 '' of a 321 , there is a sublist @xmath91 in @xmath46 with @xmath92 . by definition of @xmath82",
    ", @xmath93 must lie weakly to the left of @xmath82 and so @xmath94 . if @xmath95 , take @xmath96 .",
    "otherwise , @xmath97 and @xmath93 must both be @xmath98 and @xmath99 is a forbidden 3241 pattern .",
    "if @xmath46 is a @xmath68-containing avoider with associated triple @xmath88 and @xmath81 is finite , then @xmath100 .    proof . if not , @xmath101 would be a 321 , violating the definition of @xmath56 as the last `` 1 '' of a 321 .    for reasons to become clear , we call the disjoint union @xmath102 \\cup [ c+1,n]$ ] the _ peak - insertion set _ for @xmath46 where @xmath103=\\emptyset$ ] if @xmath104 .",
    "furthermore , for a 321-avoiding permutation on @xmath31 $ ] , set @xmath105 and define its peak - insertion set to be @xmath103=[2,n]$ ] ( the @xmath56 and @xmath82 evaporate in this case ) .",
    "next , we arrange the peak - insertion set of an avoider @xmath46 into a suitably ordered list , called the _ peak - insertion list _ of @xmath46 . taken left to right , the entries @xmath106 of @xmath46 form a list @xmath107 and the non - entries @xmath108 form a list @xmath109 .",
    "thus @xmath110 $ ] .",
    "obviously , @xmath107 is an increasing list , and so is @xmath109 for otherwise , in the 321-containing case , @xmath56 would not be the last `` 1 '' of a 321 , and in the 321-avoiding case , a 321 would actually be present . split @xmath107 into maximal runs of consecutive integers @xmath111 .",
    "likewise , split @xmath109 into maximal runs of consecutive integers but this time written as @xmath112 , where @xmath113 is the first entry of the @xmath50-th run and @xmath114 may be empty .",
    "there is the same number of runs in @xmath107 as in @xmath109 because ( i ) the smallest run contains @xmath115 and comes from @xmath109 since @xmath81 is not a , ( ii ) thereafter the runs alternate between @xmath107 and @xmath109 , and ( iii ) the largest run contains @xmath4 , a , and so comes from @xmath107 .    the _ peak - insertion list _ of @xmath46 is now defined to be the peak - insertion set of @xmath46 listed in the following order ( @xmath116 denotes the reversal of the list @xmath79 ) : @xmath117 where the terminal segment starting at @xmath82 is omitted if @xmath46 is 321-avoiding .",
    "note that @xmath115 is missing and the list consists of @xmath102 \\cup [ c+1,n]$ ]  ( or @xmath103 $ ] in the 321-avoiding case ) , as it should .",
    "for example , for the avoider shown in matrix form in figure 3 , we have @xmath118 and runs in @xmath107 and @xmath109 as follows .",
    "@xmath119 a_{i } & = & 13 \\ \\,14 \\ \\ , 15 & \\",
    "\\,17\\ \\ , 18 &   \\ \\,22 \\",
    "\\,23   \\ \\ , 24   \\",
    "\\ , 25   \\\\",
    "b_{i}|b_{i } & =   & 10 \\ | \\ 11 \\ \\,12   & \\ \\,16 \\ |\\ \\eps   & \\ \\,19 \\ | \\   20 \\ \\,21 \\end{array}\\ ] ] here , @xmath120 and the ordering in the peak - insertion list is @xmath121    we can now define the _ height _ of the peak entry @xmath47 in a 321-containing avoider @xmath46 : it is the position of @xmath47 in the peak - insertion list of @xmath49 .",
    "( we will see later that @xmath47 must be in the peak - insertion set of @xmath49 . )",
    "there is a graphical way to visualize the ordering in the peak - insertion list . as illustrated in figure 3 , for each @xmath47 in the peak - insertion set @xmath102 \\cup [ c+1,n]$ ] of @xmath46 , insert a bullet at vertex @xmath122 in the matrix diagram of @xmath46 where the abscissa @xmath123 is determined as follows . for @xmath124 , insert the bullet as far right as possible so that the region below and to the right of the bullet is nonempty . for @xmath125 $ ] ,",
    "let @xmath50 denote the position of @xmath56 in @xmath46 . then , for @xmath126,\\ x = i+1 $ ] , and for @xmath127 .",
    "if the bullets are arranged in order of distance from the vertical line @xmath128 and , for bullets at the same distance from @xmath128 , in order of distance from the horizontal line @xmath129 or @xmath130 if @xmath104 ( heavy line in figure 3 ) , then their @xmath47 s form the peak - insertion list .    the mapping is illustrated in figure 4 , which shows that @xmath131 .",
    "we need to establish several facts to show the map does all it claims to and is invertible .",
    "suppose @xmath47 is the peak entry of a @xmath68-containing avoider @xmath46 .",
    "then @xmath132i@xmath133 @xmath49 is again an avoider , @xmath132ii@xmath133 the blue entries of @xmath46 other than @xmath47 become the entries of @xmath49 , and @xmath132iii@xmath133 @xmath47 is in the peak - insertion set of @xmath49 .    proof .",
    "( i ) @xmath49 inherits the @xmath2-avoiding property from @xmath46 . if @xmath49 was decomposable then the entries other than @xmath47 in the 321 or 4312 pattern containing @xmath47 in @xmath46 would correspond to entries in the same component of @xmath49 .",
    "but then @xmath46 would also be decomposable , obviously in the 321 case , and because the `` 1 '' and `` 2 '' can be chosen adjacent in the 4312 case .",
    "( ii ) no new blue entry can be introduced and no non - peak blue entry is lost because if the deleted entry @xmath47 is the `` 1 '' of a 321 , then the `` 2 '' , a blue entry in @xmath46 , is still the `` 2 '' of a 321 in @xmath49 since the predecessor of @xmath47 in @xmath46 is @xmath134 and so serves as a `` 1 '' in place of @xmath47 .",
    "also , the peak blue entry can not possibly be the `` 4 '' , `` 3 '' , or `` 1 '' of a 4312 , so no blue entry in @xmath46 that is the `` 2 '' of a 4312 loses its blue status in @xmath49 .",
    "( iii ) this will be proved in contrapositive form in proposition [ bigone ] below .",
    "[ misc ] suppose @xmath46 is a @xmath68-containing avoider with associated triple @xmath88 .",
    "@xmath132i@xmath135 if @xmath81 is finite , then all entries after @xmath56 in @xmath46 are @xmath108 .",
    "@xmath132ii@xmath135 if @xmath104 or @xmath81 is finite and @xmath136 , then @xmath137 lies to the left of @xmath82 in @xmath46 .",
    "@xmath132iii@xmath135 if @xmath104 , then @xmath56 is the last entry of @xmath46 .",
    "@xmath132iv@xmath135 suppose @xmath138 is an entry of @xmath46 .",
    "then @xmath139 is a in @xmath46 provided @xmath139 lies to the left of @xmath81 in @xmath46 in case @xmath81 is finite .    proof .",
    "( i ) all entries after @xmath81 are @xmath140 else @xmath56 would not be the last `` 1 '' of a 321 . if the assertion fails , take @xmath47 to be the rightmost offending entry in @xmath46 .",
    "clearly , @xmath47 lies between @xmath56 and @xmath81 in @xmath46 and @xmath141 and region @xmath142 in the schematic of figure 5 is empty because @xmath47 is the rightmost offender .",
    "also , @xmath143 is empty since @xmath47 is a ( by definition of @xmath81 ) , @xmath144 is empty else @xmath56 is the `` 2 '' of a 321 , and @xmath145 is empty else @xmath81 is the `` 2 '' of a 321 .",
    "these empty regions force @xmath47 to be a fixed point and @xmath46 to be decomposable .",
    "\\(ii ) first , @xmath137 can not lie between @xmath82 and @xmath56 in @xmath46 by definition of @xmath82 . if @xmath104 , we are done by part ( i ) .",
    "so suppose @xmath81 is finite .",
    "the entry @xmath146 whose existence is guaranteed by prop.[w ] implies that @xmath137 is not a , violating the definition of @xmath81 if @xmath137 lies between @xmath56 and @xmath81 . if @xmath137 lies to the right of @xmath81 , then @xmath147 is the `` 21 '' of a 321 ( since @xmath81 is not a ) , contradicting the assumption that @xmath56 is the last `` 1 '' of a 321 .",
    "\\(iii ) if not , then all entries after @xmath56 would be entries , and the last entry would be @xmath4 , violating indecomposability .",
    "\\(iv ) suppose @xmath138 is an offender .",
    "if @xmath104 , @xmath139 lies to the left of @xmath82 by part ( iii ) and the definition of @xmath82 . if @xmath81 is finite , @xmath139 lies to the left of @xmath56 by definition of @xmath81 , and so lies to the left of @xmath82 by definition of @xmath82 . in either case , @xmath139 is a non - lying to the left of @xmath82 .",
    "then @xmath148 is the `` 321 '' of a forbidden 4321 .    for each @xmath47 in the peak - insertion set of an avoider @xmath46 on @xmath31 $ ]",
    ", there is exactly one position @xmath50 such that @xmath149 @xmath132insertion of @xmath47 at position @xmath50@xmath133 satisfies @xmath132i@xmath133 @xmath77 is an avoider , @xmath132ii@xmath133 the peak entry of @xmath77 is @xmath47 , and @xmath132iii@xmath133 @xmath77 has just one more blue entry than @xmath46 .",
    "also , for @xmath47 not in the peak - insertion set of @xmath46 , there is no such @xmath50 .    proof .",
    "first , suppose @xmath150 $ ] .",
    "let @xmath139 be the rightmost entry of @xmath46 that is @xmath151 .",
    "insert @xmath47 immediately to the left of @xmath139 .",
    "suppose @xmath46 has the matrix form depicted schematically in figure 6 where the bullet represents the inserted entry and @xmath139 its successor .",
    "then @xmath145 is empty ( contains no entries ) by definition of @xmath47 .",
    "if @xmath143 were also empty , @xmath46 would be decomposable .",
    "thus @xmath47 is the `` 2 '' of a 321 , making @xmath47 blue in @xmath152 and , clearly , it is the peak blue entry . on the other hand ,",
    "if @xmath47 is inserted to the right of @xmath139 it will not be blue , and if inserted to the left of @xmath139 but not adjacent to @xmath81 , it may be blue but will not be the peak blue .    now suppose @xmath125 $ ] .",
    "if @xmath153 , insert @xmath47 just before @xmath56 ( @xmath47 will be the `` 2 '' of a 321 ) , and if @xmath126 $ ] , insert @xmath47 just after @xmath56 ( @xmath47 will be the `` 2 '' of a 4312 ) .",
    "similar considerations show that , for this insertion point , @xmath47 will be the peak blue entry in @xmath152 and the only new blue entry .",
    "also no other insertion point will do .",
    "as for the last assertion , if @xmath46 is 321-avoiding , the peak - insertion set is @xmath154 $ ] and 1 can not be a blue entry in @xmath155 because , by definition , blue entries exceed 1 .",
    "now suppose @xmath46 is 321-containing with associated @xmath156 .",
    "if @xmath157 is inserted to the left of @xmath56 , it can not be the larger of the last `` 1 '' of a 321 and its predecessor in @xmath152 ; if inserted to the right of @xmath56 , a descending quadruple is present in @xmath152 .",
    "next , suppose @xmath158 $ ] ( @xmath159 in case @xmath104 ) .",
    "if @xmath47 is inserted to the left of @xmath56 , then it is not the larger of @xmath56 and the predecessor of @xmath56 unless it actually is the predecessor of @xmath56 , but in that case @xmath160 is a forbidden 3241 by lemma [ misc](ii ) ; if @xmath47 is inserted between @xmath56 and @xmath81 in case @xmath81 is finite or after @xmath56 in case @xmath104 , @xmath47 can not be the `` 1 '' of a 321 in @xmath152 by lemma [ misc](iv ) and so @xmath47 is certainly not the larger of the last `` 1 '' of a 321 and its predecessor in @xmath152 ; if @xmath47 is inserted after @xmath81 , then it is the last `` 1 '' of a 321 in @xmath152 , but is not larger than its predecessor and so is not peak .",
    "[ bigone ] for an avoider @xmath46 , as @xmath47 ranges from left to right over the peak - insertion list of @xmath46 , the length of the peak - insertion list of @xmath161 ranges from left to right over the interval @xmath162 , where @xmath7 denotes the length of the peak - insertion list of @xmath46 and @xmath163 is the @xmath50 of the preceding proposition .    proof .",
    "recall that every avoider @xmath46 is associated with an @xmath88 triple if it is 321-containing and with a singleton @xmath105 otherwise , and the peak - insertion set for @xmath46 is @xmath102 \\cup [ c+1,n]$ ] with the first interval absent if @xmath46 is 321-avoiding and the second interval absent if @xmath104 .",
    "we need to determine the triples , denoted @xmath164 , for each @xmath161 with @xmath47 in the peak - insertion list of @xmath46 . in the peak - insertion list of @xmath46 ,",
    "the entries @xmath140 all occur before the entries @xmath165 .    split the entries @xmath140 into segments consisting of increasing runs as illustrated in figure 7 for an avoider on @xmath31=[25]$ ] with @xmath118 and peak - insertion set @xmath102 \\cup [ c+1,n ] = [ 5,8 ] \\cup [ 11,25]$ ] .",
    "then for @xmath124 in the peak - insertion list of @xmath46 , the @xmath166 and @xmath167 of @xmath161 are as follows : ( i ) @xmath168 is one less than the smallest entry in the segment containing @xmath47 , ( ii ) @xmath169 , and ( iii ) @xmath167 is one more than the largest entry in the segment containing @xmath47 ( or @xmath170 if this largest entry is @xmath4 ) . for @xmath63 in the peak - insertion list of @xmath46 ,",
    "the @xmath171 is @xmath137 , the @xmath167 is @xmath172 , while @xmath173 for @xmath174 $ ] and @xmath175 for @xmath61 .",
    "we leave the reader to verify the truth of these assertions with the visual aid that each pair @xmath176 is shown as a bullet at vertex @xmath177 in figure 7 .",
    "so , `` expanding '' the @xmath176 bullet into a cell containing the entry @xmath47 gives the matrix diagram of @xmath178 .",
    "it is now clear that the size of the peak - insertion set ( sps in figure 7 ) starts at 2 and increases by 1 thereafter as @xmath47 ranges across the peak - insertion list of @xmath46 .",
    "from propositions [ count1 ] and [ count2 ] and the preceding bijection , we find that the number @xmath179 of indecomposable @xmath2-avoiding permutations of length @xmath4 is given by @xmath180 and , for @xmath181 , @xmath182 this is sequence in oeis @xcite with @xmath183 where @xmath184 is the for the catalan numbers , and by section [ indecinvert ] , the claimed for @xmath2-avoiding permutations follows .",
    "the counting sequence for @xmath185-avoiders can be succinctly described as the invert transform of the catalan transform of the catalan numbers ."
  ],
  "abstract_text": [
    "<S> we show that permutations avoiding both of the ( classical ) patterns 4321 and 3241 have the algebraic conjectured by vladimir kruchinin .    </S>",
    "<S> [ theorem]definition [ theorem]lemma [ theorem]proposition [ theorem]corollary    permutations avoiding 4321 and 3241 have an algebraic generating function    david callan + department of statistics , university of wisconsin - madison + 1300 university avenue , madison , wi  53706 - 1532 + * callan@stat.wisc.edu * + june 12 , 2013 </S>"
  ]
}