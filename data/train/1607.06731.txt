{
  "article_text": [
    "quantum graphs were recently introduced as general models to explore the fundamental limits of nonlinear optics and to discover the topological and geometrical properties of structures that maximize the nonlinear optical response@xcite . like other hamiltonian models , quantum graphs with specific shapes and topologies have nonlinear optical response near the fundamental limits@xcite .",
    "a quantum graph is a metric graph on which electron dynamics is confined to the edges of the graph .",
    "quantum graphs were first studied as tractable molecular models@xcite and have been invoked as models of mesoscopic systems@xcite , optical waveguides @xcite , quantum wires@xcite , excitations in fractals @xcite , and fullerines , graphene , and carbon nanotubes@xcite .",
    "quantum graphs are also exactly solvable models of quantum chaos@xcite . in nonlinear optics ,",
    "quantum graphs are models of a branched nano - wire structure , or a quasi - linear molecule , such as a donor - acceptor , with side groups .",
    "the solution of quantum graphs for nonlinear optics has used the sum over states perturbation theory developed decades ago@xcite .",
    "the process requires determination of the eigenfunctions and energies of the graph for large numbers of states , and careful determination of the degenerate states comprising the spectrum .",
    "a monte carlo calculation of the response for a simple graph can take hours of computer time , frequent checks that the solutions for each graph are correct through the use of sum rules , and careful delineation of all degeneracies .",
    "the value of such simulations to the molecular designer has been investigated , and new design rules have been posited@xcite .",
    "but the method does not scale well to graphs with many edges and large numbers of degenerate states that are often impossible to determine from a direct diagonalization of the hamiltonian .    recently , the dalgarno - lewis ( dl ) formulation of perturbation theory@xcite has been adapted to off - resonance and dispersive nonlinear optics@xcite .",
    "the dl approach requires knowledge of only the ground state of the structure .",
    "( for intrinsic nonlinearities@xcite , the ground and first excited state energies are also required . ) as such , it offers a huge computational advantage for large - scale calculations , as only a single eigenfunction must be specified .",
    "degeneracies are implicitly incorporated into the dl formulation .",
    "application of the dl formalism to quantum graphs opens up the possibility of a general computational approach for exploring the theory of fundamental limits , as well as for simulating molecular and nanostructures that might achieve larger intrinsic nonlinear optical responses .",
    "section [ sec : qg ] reviews the solution of quantum graphs and the use of the sum over states to compute the nonlinearities .",
    "section [ sec : dl ] introduce the dl formalism and formally adapts it directly to quantum graphs .",
    "section [ sec : dlqg ] develops the general algorithm for solving quantum graphs using the results of section [ sec : dl ] and illustrates it with wire , star , loop , and a composite , seven - edged graph , and displays the accuracy and computational speedup of the method over the sum over states .",
    "section [ sec : end ] summarizes the benefits of the method and its extension to dispersive nonlinear optics .",
    "optimization studies using quantum graphs are based upon monte carlo computations with tens to hundreds of thousands of possible geometries for a particular topology , such as a star or loop motif@xcite , or a composite of stars , loops , and wires . for each structure ,",
    "the hamiltonian is diagonalized to find the energy spectrum @xmath0 and the eigenstates @xmath1 , where @xmath2 is the mode number .",
    "the transition moments @xmath3 are computed for the graph using a union operation@xcite , and the first and second hyperpolarizability tensors @xmath4 and @xmath5 are calculated using perturbation theory based upon the sum over states@xcite : @xmath6 and @xmath7 where @xmath8 , @xmath9 , and the permutation operator p permutes all indices into all possible permutations without regard to order .",
    "the indices are @xmath10 for a planar graph embedded in two - dimensional space .",
    "both hyperpolarizabilities have been normalized to their maximum values@xcite and are bounded above by unity .",
    "the lower bound on @xmath11 is zero , while that for @xmath5 is @xmath12 .",
    "the geometry of the structure largely determines the total contributions of the transition moments from each edge , each of which is determined by the mode overlap of the eigenfunctions with the appropriate position operator and the relative orientation of the edges . tailoring this overlap and the change in the dipole moment for electron excitation from the ground state to an excited state can lead to a giant enhancement of the nonlinear optical response due to phase disruption of the eigenfunctions @xmath13 , where @xmath14 is measured along the graph@xcite .",
    "figure [ fig : graph5edge ] illustrates the notation for computation with quantum graphs .",
    "each edge has a coordinate @xmath15 measured along the edge from zero to @xmath16 and an angle @xmath17 with respect to an external axis , which we choose to be the @xmath18 for convenience .",
    "the edge functions @xmath19 for edge @xmath20 and mode @xmath2 on that edge satisfy @xmath21 , where the energies @xmath0 are the same on all @xmath20 edges .",
    "the full eigenfunctions @xmath22 are constructed using a mathematical union operation @xmath23 operating on all @xmath24 edges@xcite .",
    "the hilbert space for the solutions to the entire graph is a direct sum of those for each individual edge .",
    "the interpretation of the coordinates in eqn [ edgeunion ] is that when the electron is on edge @xmath20 , the eigenfunction @xmath25 is equal to @xmath26 for any mode @xmath2 .",
    "+    the construction of the union of edge functions to make an eigenfunction of the graph requires matching of boundary conditions at the vertices within the graph . for quantum graph unions ,",
    "the boundary conditions are that the edge functions at each vertex are equal , and that the net probability flux into or out of a vertex is zero , or equivalently @xmath27 where the sum is over the @xmath28 edges going into or out of the vertex @xmath29 .",
    "there are always enough boundary conditions to compute all of the constants of integration from the solutions of the edge functions .",
    "the transition moments are computed by projecting the coordinate vector @xmath30 for a given edge @xmath31 onto the @xmath18 to compute @xmath32 and onto the @xmath33 to compute @xmath34 for each edge .",
    "projected into coordinate space , the transition moments take the form of sums of definite integrals .",
    "for example , for @xmath35 , we get @xmath36 where the sum is over the @xmath24 edges , with a similar expression with @xmath37 for @xmath38 .",
    "the solution of a quantum graph yields the spectrum and transition moments required by eqns [ beta_ijk ] and [ gamma_ijkl ] for the hyperpolarizability tensors .",
    "once a graph is specified by its metric variables @xmath39 and the potentials acting on each edge , the dependence of the magnitudes of the hyperpolarizabilities on the geometry and topology of the graph is computable and may be studied using cartesian or spherical tensor analysis@xcite .",
    "explorations of the topological structures maximizing the hyperpolarizabilities require computation of @xmath4 and @xmath5 for each of tens of thousands of graphs .",
    "computation for each graph requires solving the graph for its energies and eigenfunctions , typically for at least @xmath40 modes , depending on the nature of the potential energy .",
    "a single monte carlo run for a simple three - edged graph might require several hours of execution time on an eight - threaded , quad - core intel @xmath41 cpu clocked at @xmath42 .",
    "the computation requires careful handling of the solutions of the graph to ensure that any and all degenerate states are discovered and enumerated . for a typical computation ,",
    "it is necessary to invoke the thomas - reiche - kuhn ( trk ) sum rules@xcite to ensure that all such states have been correctly captured and the spectra correctly determined@xcite .",
    "computation of a quantum graph for nonlinear optics is an elaborate procedure that is time - consuming and often frustrating when graph geometries produce numerous degeneracies .",
    "the dalgarno - lewis perturbation theory offers a simplification of the monte carlo computation and an execution time speedup of over a factor of @xmath43 .",
    "the dalgarno - lewis perturbation method has been reviewed in the literature@xcite and in classic quantum mechanics textbooks@xcite .",
    "a paper in the present volume describes its application to dispersive nonlinear optics and solves a number of one - dimensional examples .",
    "quantum graphs are quasi - one dimensional objects , with particle motion along the edges of the graph and not transverse to it . but they live in two dimensions and have @xmath44 and @xmath45 projections that contribute to the hyperpolarizability tensors .",
    "moreover , their hilbert space is a direct sum of hilbert spaces for each of the edges , which adds complexity to the dl formalism and for which no algorithms have yet been developed .",
    "this section summaries the dl formalism for one dimension and then extends it to quantum graphs for the first time .",
    "the dalgarno - lewis method for perturbation theory in one dimension begins by assuming the existence of an operator @xmath46 whose commutator with the hamiltonian @xmath47 takes the form @xmath48=\\bar{x}\\ ] ] with @xmath49 .",
    "the right - hand side is essentially the perturbing potential on a molecule in an electric field , @xmath50 , with the ground state expectation value subtracted and the electric charge e dropped , as it will be incorporated elsewhere later .",
    "acting on the ground state with both sides of eqn [ commfh ] yields @xmath51|0\\rangle = \\bar{x}|0\\rangle\\ ] ] if we operate on the left of both sides of eqn [ commfh ] with @xmath52 and use @xmath53 , we get @xmath54 which defines matrix elements of the f operator in a way that allows a substitution into the sum over states expressions for @xmath55 : @xmath56 where the last line in eqn [ betaxxx ] follows by using completeness of the eigenstates .",
    "if the dl operator exists , then the first hyperpolarizability is computable through the ground state expectation value of the composite operator @xmath57 .",
    "evidently , the effect of the perturbation on the excited states and their contributions to @xmath55 are embodied in the @xmath46 operator .    to obtain a spatial representation for @xmath46 that we may use in computations , we project eqn [ commfh ] into coordinate space as follows .",
    "the hamiltonian , in coordinate space , is given by @xmath58 we want to project eqn [ definef ] into position space , where we know @xmath59 is the ground state wavefunction .",
    "we will need the projection of f into x - space , which is defined through @xmath60 which defines the function @xmath61 .",
    "we are asserting that @xmath61 exists for our operator .",
    "if we can derive an expression for it , then we will have found a representation for the @xmath46 operator and may use eqn [ betaxxx ] to compute the first hyperpolarizability as an expectation value of @xmath57 in the _ unperturbed _ ground state .",
    "note that we do not even need to know the spectrum .",
    "the energy scale wo nt enter into the problem until we divide by @xmath62 from the theory of fundamental limits .",
    "we ll return to this later .",
    "projecting the left - hand side ( lhs ) of eqn [ commfh ] into x - coordinate space gives @xmath63 projecting the right - hand side of eqn [ commfh ] into coordinate space yields @xmath64 equating eqns [ lhsf ] , and [ rhsf ] , we get the differential equation @xmath65 the general solution to eqn [ diffeqforf ] is obtained with two quadratures : @xmath66    eqn [ fofx ] is the main result .",
    "note that the lower limit of the inner integral could have been chosen to be some value @xmath67 , where @xmath68 , but we choose @xmath69 for quantum graphs .",
    "once the ground state wavefunction is known , the function @xmath61 may be found by analytical or numerical integration , once two boundary conditions are specified .",
    "actually , for bounded problems , such as a quantum well where the wavefunction vanishes at each end , the second term in eqn [ fofx ] vanishes without specifying a boundary condition @xmath70 .",
    "we may always choose @xmath71 any way we please , because the operator @xmath46 is determined by a commutator and is therefore only known up to a constant anyway .    to calculate @xmath72 from the sum over states , we need an additional operator @xmath73 .",
    "in analogy with eqn [ commfh ] , we intuit that this is @xmath74|0\\rangle = \\big[\\bar{x}f-\\langle 0|\\bar{x}f|0\\rangle\\big ] |0\\rangle\\ ] ] which leads to a differential equation for @xmath75 , the projection of @xmath73 into coordinate space .",
    "the solution to this equation may be written down by inspection of eqn [ fofx ] and is @xmath76 \\psi_{0}(x'')^{2 } + \\frac{\\hbar^2}{2m}g'(0)\\psi_{0}(0)^{2}\\bigg).\\nonumber\\end{aligned}\\ ] ] eqn [ commgh ] implies that @xmath77 which may be used to write eqn [ gamma_ijkl ] in a compact sum of ground state expectation values of operator products of the form @xmath78 with integers @xmath79 .",
    "we present an explicit form in the next section that is applicable to quantum graphs .",
    "note that we have defined the action of the anti - hermitian operator @xmath46 on the ground state @xmath80 to be equal in x - space to @xmath81 .",
    "this implies that the adjoint has a minus sign : @xmath82 becomes @xmath83 .",
    "this is important because operator products like @xmath84 will produce minus signs when they are sandwiched between ground states .",
    "the same is true for @xmath73 if it acts to the left .",
    "we can easily extended the one dimensional dalgarno - lewis formalism to quasi - one dimensional graphs using the fact that the hamiltonian rotates as a quadratic form , viz . ,",
    "@xmath85 and ignoring the transverse part@xcite .",
    "this implies that all of our one - dimensional work carries through for the @xmath46 and @xmath73 functions , except now the coordinates on the right hand side of eqn [ commfh ] and [ commgh ] are either @xmath44 or @xmath45 , depending on the transition moment one wishes to calculate . with this in mind , we arrive at @xmath86 where @xmath87 and @xmath88 .",
    "the coordinate variable @xmath14 is measured along the graph edges .",
    "the wavefunction and dl functions in eqn [ fi ] are unions of functions defined on the graph edges .",
    "the interpretation of the integral is that when @xmath14 is on edge @xmath20 , the values of the edge functions on edge @xmath20 are to be used , and the coordinate variable spans the range of that edge function .",
    "we quantify this description in section [ sec : dlqg ] .    for @xmath72 , we use the new set of functions , @xmath89 defined by the commutator @xmath90=\\bar{r}^{i}f_{j}-<0|\\bar{r}^{i}f_{j}|0>$ ] , which translates in s - space to an equation for @xmath91 which is identical to that for @xmath92 in eqn [ fi ] , but with an inner integrand given by the product @xmath93 expressed in s - space .",
    "the explicit form is @xmath94 \\psi_{0}(s'')^{2 } ds''\\nonumber \\\\ & + & \\frac{\\hbar^2}{2m}{g_{ij}(0)}'\\psi_{0}(0)^{2}\\bigg).\\nonumber\\end{aligned}\\ ] ] note that the @xmath14 variable appearing in each of eqns [ fi ] and [ gij ] roams over the entire graph and that @xmath95 is the ground state wavefunction for the graph , which is the union of the edge functions .",
    "it is now straightforward to derive simple expressions for the hyperpolarizabilities .",
    "first , we note that it is always possible to add a constant to f to make @xmath96 so we will assume that has always been done .",
    "eqn [ fn0 ] then allows us to write the expression for @xmath4 in eqn [ beta_ijk ] without energy denominators as @xmath97 we note that we can also add a constant to g to make @xmath98 without changing the commutator that defined g. we will always assume we have done this . given this , we may use eqn [ gn0 ] to write down the general expressions for @xmath99 as @xmath100    this completes the _ formal _ specification of the f and g functions , and their use in calculating the hyperpolarizabilities . to apply this formalism to quantum graphs , we must express the dl functions in the language of the direct sum hilbert space they represent .",
    "for graphs , the meaning of eigenfunctions @xmath25 and ground state expectation values require sharp definition of the union operation that stitches together the hilbert spaces on each edge to yield a direct sum hilbert space with energies equal to those of the spaces for each edge .",
    "continuity and flux conservation , eqn [ flux ] , showed how this is accomplished for the edge functions . with this algorithm , eqn [ moments ] showed how expectation values of operators acting across a graph are calculated , edge by edge , for transition moments .",
    "for @xmath92 and @xmath89 , we need the union of an @xmath46 or @xmath73 function tied to each edge : @xmath101 with a similar union operation defined for @xmath89 : @xmath102 here and going forward , the index @xmath31 refers to the cartesian component @xmath44 or @xmath45 of an object , while the index @xmath20 refers to a mode number .",
    "the matching of the edge @xmath103 and @xmath104 functions at vertices is accomplished by demanding continuity of each at the vertex and a net flow into or out of the vertex equal to zero . a ground state expectation value of the form of eqn [ moments ] ( with m = n=0 )",
    "but for @xmath105 , say , would then be calculated as @xmath106 with a similar expression for expectation values of other products of operators .",
    "the boundary conditions arising from the union operation completely specify all integration constants appearing in the edge dl functions and provide a general solution to the problem of calculating the first and second hyperpolarizabilities from only expectation values of products of dl operators . for clarity , going forward , _",
    "we drop the mode subscript @xmath107 on the edge functions in the ground state by writing @xmath108_.    the explicit forms of the @xmath103 and @xmath104 dl edge functions are @xmath109 and @xmath110 \\phi^{(p)}(s_{p}'')^2 ds''\\nonumber \\\\ & + & \\frac{\\hbar^2}{2m}{g'_{ij}}^{(p)}(0){\\phi^{(p)}(0)}^2\\bigg).\\nonumber\\end{aligned}\\ ] ] where the angular brackets signify the expectation value in the ground state dl edge function .",
    "the integration constants are selected to satisfy the boundary conditions on the dl functions so their union is a function that is the projection of the dl operator @xmath46 or @xmath73 into coordinate space over the entire graph .",
    "the boundary conditions are that the @xmath111 are equal at the vertex where the edges which they are index meet , and the sum of the derivatives with respect to their edge coordinates , measured into or out of a vertex , of all edges meeting at that vertex vanishes .",
    "similar conditions hold for @xmath104 and its derivatives .",
    "the first integral of the dl equation for @xmath111 for any edge p of a graph may be written as @xmath112 where @xmath113 for the ith edge . here",
    ", @xmath114 is the offset from the origin for edge p , and @xmath115 . in particular",
    ", the following relationship holds at the endpoints of an edge : @xmath116 note that each dl function for edge @xmath20 has two integration constants .",
    "we show how the boundary conditions determine these constants .",
    "write eqn [ fip ] as @xmath117 where the first integration constants are @xmath118 and are proportional to the net flux entering edge @xmath20",
    ". now write eqn [ fp2 ] as @xmath119\\ ] ] which is proportional to the net flux exiting edge @xmath20 times the square of the @xmath120 edge function evaluated at the exit vertex",
    ". eqns [ cp ] and [ cout ] reveal that two edges @xmath121 and @xmath122 have a common vertex , say at @xmath123 , then the @xmath124 and @xmath125 for edges @xmath121 and @xmath122 are related by flux conservation .",
    "eqns [ cp ] and [ cout ] may thus be used to conserve dl function flux at each vertex .",
    "a final set of equations matches the values of the dl functions at each vertex : @xmath126 for every set of @xmath127 edges that come together at vertex @xmath29 , and the notation @xmath128 means evaluate at the position @xmath129 for that edge at vertex @xmath29 .",
    "the continuity of @xmath130 and conservation of @xmath131 resemble the boundary conditions on the edge functions in a quantum graph .",
    "these embody the definition of a union of functions operating on the edges .    for the g functions , a similar approach applies , with eqn [ gijp ] replaced by @xmath132\\phi^{(p)}(s''_{p})^2\\nonumber \\\\ & + & d_{p}\\bigg)\\nonumber\\end{aligned}\\ ] ] for the xx component , with suitable modifications made for the yy and off - diagonal components .",
    "the constants @xmath133 are proportional to the @xmath134 flux entering edge @xmath20 .",
    "@xmath135 where this latter derivative may be obtained from an expression similar to eqn [ fp2 ] , viz . ,",
    "@xmath136\\phi^{(p)}(s'_{p})^2\\nonumber \\\\ & \\equiv & \\frac{2m}{\\hbar^2}\\langle\\big[\\bar{x}_{p}f_{x}^{(p)}-\\langle 0|\\bar{x}f_{x}|0\\rangle\\big]\\rangle\\nonumber\\end{aligned}\\ ] ] leading to @xmath137\\rangle\\bigg]\\ ] ] where again the brackets on the last term are the ground state expectation value in edge @xmath20 .",
    "eqns [ dp ] and [ dout ] may be used to conserve dl function flux at each vertex",
    ". a final set of equations matches the values of the dl functions at each vertex : @xmath138 for every set of @xmath127 edges that come together at vertex @xmath29 , where again the notation @xmath128 means evaluate at the position @xmath129 for that edge at vertex @xmath29 .",
    "the method derived in this section is applicable to any quantum graph .",
    "it is easy to use and will be illustrated with examples of wires , stars , and loops , and then applied to solve a seven - edge graph with three stars .",
    "this graph may have numerous degeneracies , depending on the relative edge lengths , that are challenging to discover@xcite . with the dl method",
    ", the solutions may be written down by inspection and easily coded , requiring only the ground state of the graph .",
    "this is an enormous simplification in solving the graph and leads to reduction in execution time for a large scale monte - carlo calculation from several hours to several minutes .    in the following examples , we consider @xmath139 for clarity .",
    "a similar set of results applies for the y direction by replacing x with y in the inner integrals transition moment on each edge .",
    "_ we suppress the x - index to simplify notation_.      consider a three wire graph , as shown in the left panel of figure [ fig:3graphs ] .",
    "we need to solve for the @xmath130 ( and @xmath140 ) on each edge so that we may compute matrix elements of the union over edges of @xmath141 ( and @xmath142 ) in the ground state .",
    "+    examining the graph and eqn [ cp ] , it is easy to see that @xmath143 because the edge function @xmath144 . to calculate @xmath145",
    ", we note that it is just the flux entering edge 2 , which is also the flux exiting edge 1 , and by eqn [ cout ] , we get @xmath146 , so @xmath147 . continuing , the flux entering edge three is @xmath148 is the flux exiting edge 2 , which by eqn [ cout ] is @xmath149 , so @xmath150 . summarizing , @xmath151 where the last equality in eqn [ ci3wire ] follows from the fact that summing over all edges e , @xmath152 by definition of @xmath153 .",
    "eqn [ fbc ] then requires that @xmath154 it is straightforward to arrange these conditions once the fs are computed from eqns [ fip ] , [ cp ] , and [ cout ] .",
    "note that this leaves one overall undetermined constant , @xmath155 .",
    "we can always choose this constant such that the unions of the edge dl functions have zero ground state expectation value , @xmath156 .",
    "the gs are computed in the same way using [ gijp ] , [ dp ] , and [ dout ] .",
    "this allows us to use the simple expressions for the hyperpolarizabilities displayed in eqns [ beta_ijk_simple ] and [ gamma_ijkl_simple ] .",
    "consider next a 3-star graph , as shown in the center panel of figure [ fig:3graphs ] .",
    "if we write the three edges in the canonical form of eqn [ fip ] and measure distance from the center vertex , we find from eqn [ cp ] and eqn [ cout ] that @xmath157 , @xmath158 , and @xmath159 which is also equal to @xmath160 by eqn [ sumxbar ] .",
    "all of the @xmath130 are equal at the central vertex , and this is automatically satisfied if each of the f constants in eqn [ fi ] are equal .",
    "the value of this single constant may be set by demanding @xmath156 , as noted above .",
    "figure [ fig : beta_tensors_vs_angles_dl_3star_degen ] shows the results of using dl to calculate all of the tensor components of @xmath4 for a 3-star graph with two fixed edges of lengths @xmath161 and @xmath162 , angles of @xmath163 and @xmath164 degrees relative to the x - axis , and one rotating edge of fixed length @xmath165 , and compares them to those calculated by using the sum over states with thirty modes .",
    "the dl method works with high precision .",
    "figure [ fig : gamma_tensors_vs_angles_dl_3star_degen ] shows the calculations for @xmath5 .",
    "note that the length scale is arbitrary , as these are intrinsic hyperpolarizabilities ; the relative lengths determine the response of the structure .",
    "the most remarkable thing about using dl for these sets of star graphs is that states @xmath166 , @xmath167 , etc .",
    "are degenerate in energy ( where @xmath168 is the ground state ) , and the sum over states calculation requires identification of these states and diagonalization of the degenerate subspaces before it may be used .",
    "the dl computations do nt know about any of this  they just require the ( nodeless ) ground state wavefunction .",
    "the dl operators , which implicitly sum up all of the contributions in perturbation theory from the excited states , automatically account for the degeneracies , as they followed from completeness of the unperturbed eigenstates .     for the 3-star graph with those obtained using the full sos for all tensor components . in the legend , @xmath169 , etc.,title=\"fig:\",width=326 ] +     for the 3-star graph with those obtained using the full sos for all tensor components . in the legend , @xmath170 , etc.,title=\"fig:\",width=326 ]",
    "+    the second remarkable feature of the dl summation technique is illustrated in figure [ fig : speedup ] , which shows the massive speedup of dl over the sum over states with large numbers of modes .",
    "+     and @xmath89 functions for the closed loop graphs , showing their periodicity , as expected .",
    "numerical values on the y axis have been suppressed for clarity.,title=\"fig:\",width=326 ] +      figure [ fig:3graphs ] , right , shows a three - sided , closed loop graph .",
    "the computation of @xmath4 and @xmath5 for this class of graphs has been extensively discussed@xcite .",
    "the ground state is nondegenerate , and is a constant , with zero energy .",
    "the excited state spectrum is doubly - degenerate .",
    "the eigenvalues are @xmath171 , where @xmath172 is the perimeter of the loop",
    ".    the computation of the hyperpolarizabilities using dl may be accomplished by using eqn [ fip ] but with a single edge and sequential calculation@xcite .",
    "for the x direction , say , we get @xmath173 with a similar equation for the y component of f. for a continuous wire graph , including a loop , we may use the sequential edge method of calculation@xcite , where we measure distance s along the graph from an arbitrary starting point and change the value of @xmath174 in eqn [ fsingle ] when we move from one edge to the next . in this way",
    ", we can solve for the f and g functions for this graph by using eqn [ fsingle ] and an equivalent one for g by selecting the correct boundary conditions .",
    "for a loop graph , we demand that @xmath175 , in order to make f periodic as the particle circulates the graph . from eqn [ fsingle ] , this requires that the first integration constant c be chosen so that the double integral on the right hand side vanishes at @xmath176 .",
    "we arrive at @xmath177 for the first integration constant .",
    "finally , we note that the slopes are continuous , @xmath178 , since the integral of @xmath179 over the graph is zero by definition .",
    "similar remarks hold for the @xmath73 functions .",
    "for example , for @xmath73 in the x - direction , we find @xmath180\\phi(s'')^{2}+ d\\right)\\nonumber\\end{aligned}\\ ] ] where the first integration constant is given by @xmath181\\phi(s'')^{2}\\right)\\nonumber \\\\ & \\div&\\int_{0}^{l}\\frac{ds'}{\\phi(s')^{2}}\\nonumber\\end{aligned}\\ ] ]    fig [ fig : fgloop ] shows the two f functions and for g for the loop graph .",
    "it is clear that the boundary conditions caused the functions to assume periodic behavior .",
    "+    we can extend the general algorithm to more complicated structures , such as the three prong graph having seven edges ( a star at each end , and a star connecting these ) , shown in the left panel of figure [ fig:3prong ] .",
    "for convenience , we can put the origin at the first star vertex , where edges @xmath182 are joined . using the algorithm in eqn 4",
    ", we need to find seven first constants of integration , @xmath183 .",
    "these are given by @xmath184 note that we could have used the algorithm to rewrite @xmath185 as @xmath186 by eqn [ sumxbar ] .",
    "figure [ fig : panel1_quad_3prong ] shows the edge functions along the graph and illustrates their continuity and the conservation of flux .",
    "the edge lengths @xmath187 to @xmath188 are @xmath189 , and @xmath190 , in arbitrary units , and their respective angles , in degrees , are @xmath191 , and @xmath107 .",
    "edges 1,2,4,6,7 terminate at an infinite potential wall , and the edge functions vanish there , as may be seen in the figure .",
    "figure [ fig : panel2_quad_3prong ] shows that the sos and dl results are identical using this formalism .",
    "the dl calculations executed ten times faster than using 20 modes in the sos calculation . moreover , the solution of the sos calculation required careful computation of the amplitudes due to degeneracies in the graph .",
    "as graphs get larger , degeneracies become very difficult to compute , and the sos method is impractical .",
    "the dl method does not require any information other than the ground state , which is nondegenerate .",
    "+     +    figures [ fig : panel3_quad_3prong ] and [ fig : panel4_quad_3prong ] show the @xmath92 function along the x and y directions , respectively .",
    "the figures show that the computation has produced edge dl functions that are continuous and have conserved slope at their vertices .",
    "functions for all graph edges using the same ordering scheme as used in fig [ fig : panel1_quad_3prong ] for the edge functions note that the dl edge functions are continuous at the vertices , and their derivatives are conserved at the vertices.,title=\"fig:\",width=326 ] +     functions for all graph edges using the same ordering scheme as used in fig [ fig : panel1_quad_3prong ] for the edge functions .",
    "note that the dl edge functions are continuous at the vertices , and their derivatives are conserved at the vertices.,title=\"fig:\",width=326 ] +",
    "the computation of the optical nonlinearities of quasi - one dimensional systems , modeled by quantum graphs , has been adapted from the sum over states ( sos ) to the dalgarno - lewis ( dl ) method and resulted in an execution time speedup of anywhere from a factor of @xmath40 for a simple star graph . for large - scale monte carlo simulations normally taking hours with the sos , the computation time is reduced to well under half an hour and often requires only a few minutes .",
    "sos requires solving the quantum graph for all of its eigenfunctions and energies , whereas dl requires only knowledge of the ground state and , for intrinsic nonlinearities , the first two energy levels .",
    "a quantum graph with many edges has an exceedingly complex secular equation whose @xmath192 roots must be found for an sos over @xmath192 states .",
    "often , the roots are so closely spaced that numerical solutions are inaccurate , and it is impossible , a priori , to even know which roots are degenerate , let alone what the degree of degeneracy is .",
    "subspaces of eigenfunctions with degenerate states must be diagonalized .",
    "the time to sum over states for @xmath193 scales as @xmath194 , while for @xmath72 , it scales as @xmath195 . the adaptation of the dl method for quantum graphs provides a fast , reliable way for researchers to solve quantum graph models that would otherwise be nearly intractable .",
    "another benefit of the dl method is that it requires only the ground state of the system .",
    "this implies that one can , in principle , attempt to model structures with large response by testing various models of charge distribution in the ground state of a molecule . in a real system",
    ", the hamiltonian determines the exact eigenstates and spectra , and for a given set of boundary conditions , the ground state would be unique .",
    "for modeling a system , one could mock up a ground state based upon intuition about how the charge is distributed in a test molecule , and then compute @xmath193 and @xmath72 using the dl method .",
    "the test molecule s actual hamiltonian might not produce a ground state that exactly resembles the mocked up version , but the result should be meaningful .",
    "the dl method has been solved for the dispersive case and is presented in a paper in this special issue .",
    "the extension of the dl method for graphs to include dispersion is identical to the presentation here , except that the dl functions take a different form that depends on the optical frequencies and the linewidths .",
    "smm and mgk thank the national science foundation ( eccs-1128076 ) for generously supporting this work .",
    "j.  r. platt , `` free - electron network model for conjugated systems .",
    "a demonstration model showing bond order and``free valence''in conjugated hydrocarbons , '' the journal of chemical physics * 21 * , 15971600 ( 1953 ) .",
    "j.  snchez - gil , v.  freilikher , i.  yurkevich , and a.  maradudin , `` coexistence of ballistic transport , diffusion , and localization in surface disordered waveguides , '' physical review letters * 80 * , 948 ( 1998 ) .      c.  amovilli , f.  e. leys , and n.  h. march , `` electronic energy spectrum of two - dimensional solids and a chain of c atoms from a quantum network model , '' journal of mathematical chemistry * 36 * , 93112 ( 2004 ) .",
    "f.  e. leys , c.  amovilli , and n.  h. march , `` topology , connectivity , and electronic structure of c and b cages and the corresponding nanotubes , '' journal of chemical information and computer sciences * 44 * , 122135 ( 2004 ) ."
  ],
  "abstract_text": [
    "<S> we develop an algorithm to apply the dalgarno - lewis ( dl ) perturbation theory to quantum graphs with multiple , connected edges . </S>",
    "<S> we use it to calculate the nonlinear optical hyperpolarizability tensors for graphs and show that it replicates the sum over states computations , but executes ten to fifty times faster . </S>",
    "<S> dl requires only knowledge of the ground state of the graph , eliminating the requirement to determine all possible degeneracies of a complex network . </S>",
    "<S> the algorithm is general and may be applied to any quantum graph . </S>"
  ]
}