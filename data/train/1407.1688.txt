{
  "article_text": [
    "the problem of the behaviour of stars in a galaxy is of interest because it gives insight into the formation processes and evolution of these galaxies .",
    "most notably it has led to the proposition of _ dark matter _ in order to explain the observed velocities of stars @xcite .",
    "one can model a galaxy in a brute force sense by simply producing a simulation of the @xmath0 stars ( or dark matter particles ) , give them initial conditions and let them all interact with one another via the gravitational force . as well as being computationally time consuming , as typically @xmath1 @xcite , the insight gained from such methods is limited . in order to gain an understanding of the system it is the statistical distribution of orbits that are of interest ( 4.1 of @xcite ) and these",
    "can be more easily reached through appropriate simplifications .",
    "if one concentrates on a single star and releases it in a galaxy , one can ask ,  what trajectory will it follow ? \" . as we do not want to do the integration of the @xmath0-body interactions , the orbit is calculated by smoothing the mass distribution of all the other stars so that we can produce a _",
    "galactic potential _ in which the star travels @xcite . from the observed structures of galaxies the luminous mass distribution can be deduced and many different analytic forms of potential have been proposed ( see chapter 2 of @xcite for a review ) .    the smoothing is valid because the gravitational force is purely attractive so no shielding of the force occurs .",
    "thus , in a galaxy , the force on a star is dominated by the contribution from the large number of distant stars rather than that of the nearest neighbour stars ( 1.2 of @xcite ) .",
    "further assumptions in this method include that the galaxy is in a steady state , such that the lifetime of the stars are much greater than one orbital period ( table 11.1 of @xcite ) .",
    "it is also implicit that no two stars in the model will collide , which is valid as the number density of stars in a typical galaxy is relatively low , radius of the disc @xmath2 and thickness of @xmath3 gives a number density of 0.6 stars per cubic parsec .",
    "data from @xcite . ] . for a given potential , under these assumptions",
    ", the trajectory only depends on the initial conditions , which correspond to six constants of motion ( 3.1.1 of @xcite ) . by varying the initial conditions one can explore the orbits allowed by that potential .",
    "the galactic potentials that will be considered here will always have at least three integrals of motion associated with them , which are constants that are not explicit functions of time ( 3.1.1 of @xcite ) .",
    "as an example of the simplest case , take a spherical potential : here we have the hamiltonian and the three components of angular momentum being conserved . in the general case",
    "the hamiltonian is conserved , along with at least two other quantities that are not necessarily the angular momenta .",
    "it is possible , for periodic systems , to use functions of these integrals as momentum coordinates @xcite .",
    "one can do so provided the functions are isolating integrals and the conjugate coordinates to the momenta form a global coordinate system ( see [ sec : aacoords ] ) . in this case",
    "the momenta are called actions and have conjugate coordinates called angles , which can be normalised with an amplitude of @xmath4 .",
    "the advantage of transforming to action - angle coordinates is that the equations of motion become exceedingly simple .",
    "the hamiltonian is a function of the actions only and the angles increase linearly in time with constant frequencies @xmath5 @xcite .",
    "furthermore the actions are adiabatic invariants , so do not change when the system is varied slowly , and thus become a useful tool in perturbation theory to treat non - steady state systems @xcite@xcite . for these reasons",
    "use of action - angle coordinates extends far beyond that in the study of galactic and planetary dynamics to include atomic , molecular , plasma and high energy physics @xcite .",
    "the three actions uniquely describe an orbit in a galactic potential , by labelling the phase space volume occupied by the angles @xcite .",
    "the angles describe the location on a given orbit , but carry no defining information .",
    "it is then possible to reduce the six dimensional phase space to a three dimensional one , given just by the actions , which can then be drawn @xcite .",
    "the locations of points within this phase space diagram allow a classification of the types of orbits allowed in a given potential by construction of the _",
    "distribution function_. the distribution function is the fundamental description of the system and is used extensively in @xmath0-body simulations ( 4.7.1 of @xcite ) .",
    "traditionally the action - angle coordinates of an arbitrary potential have been found by calculating the terms in an expansion of a generating function using best - fit methods @xcite@xcite@xcite@xcite .",
    "where the generating function maps the analytically known action - angle variables of a  toy \" hamiltonian to the action - angle variables of the  target \" hamiltonian .",
    "this report details a new method for calculating the actions in an arbitrary galactic potential .",
    "the actions @xmath6 are found as functions of the cartesian phase space data points of an integrated orbit in the potential . furthermore the method does not require explicit knowledge of the generating function and by using the fiestas algorithm @xcite the required averaging is computationally fast .",
    "it is possible that the orbit could be one extracted from an @xmath0-body simulation and thus the method can be used to construct the distribution function and classify orbits in such simulations .",
    "the report develops as follows : in [ sec : background ] the background theory on generating functions and action - angle coordinates is covered .",
    "then [ sec : analyticpots ] discusses the forms of potentials which have analytic expressions for the action - angle coordinates .",
    "[ sec : algtheory ] covers the theory that justifies the approach taken for the algorithm .",
    "this is followed in [ sec : algpract ] with an account of the practical implementation of the algorithm .",
    "[ sec : orbint ] covers details of the orbit integrator used to generate the required data to test the algorithm .",
    "in [ sec : ellipsoid ] the ellipsoidal potential is introduced with its use in cartesian coordinates outlined .",
    "[ sec : results ] presents the results of using the ellipsoidal potential to test the algorithm , given known actions .",
    "a discussion of the results follows in [ sec : discussion ] , detailing how the procedure had to be improved . finally , in [ sec : conclusions ] the report is summed up and possible future work discussed .",
    "first the concept of a generating function , which will be used extensively , is detailed .",
    "then the theory behind action - angle coordinates and a description of how one finds their form for a given system is presented . for a detailed background in the mathematics that underpins this sections see _ nash & sen 1983 _",
    "@xcite for topology and _ arnold 1989 _",
    "@xcite for classical mechanics .",
    "given two canonical coordinate systems @xmath7 and @xmath8 the generating function @xmath9 is a function of two of the variables , one from each of the two coordinate systems , that transforms between the two systems @xcite .",
    "for example , if @xmath10 then the other two coordinates are found from @xmath11          in action - angle coordinates the trajectories of particles are described by the angles , whilst the constant actions label the orbit .",
    "the set of phase space coordinates on which @xmath12 is a @xmath13-torus , with @xmath13 being the number of degrees of freedom of the system . in the case in hand",
    "we have a 3-torus , so we have a cube with volume @xmath14 .",
    "the axes are labelled between @xmath15 to @xmath4 and the coordinates at the planes on each axis at @xmath15 and @xmath4 identified with each other , see figure [ fig : torus ] .",
    "this description follows from liouville s theorem @xcite .",
    "the actions themselves are isolating integrals , @xmath16 . isolating integrals are functions of the six phase space coordinates that are constant on smooth five dimensional surfaces in phase space @xcite , @xmath17    as we assume that there exist three isolating integrals , the orbit we consider has the property of quasiperiodicity @xcite@xcite .",
    "a quasiperiodic orbit is one in which the equation describing the temporal evolution of the coordinates of a particle in the potential , @xmath18 , can be written as a discrete fourier series , where the frequencies are integer linear combinations of three fundamental frequencies .",
    "the quasiperiodic nature of the system then directly relates to the angle coordinates as the fundamental frequencies are associated with the @xmath19 of the angles .",
    "although not all potentials allow quasiperiodic orbits , so long as the orbits are close to being quasiperiodic the assumption of three isolating integrals should still hold @xcite .    in order for the isolating integrals to be actions they must also have conjugate coordinates which form a global coordinate system @xcite . to form a global coordinate system",
    "the angles must describe trajectories that each take one entire loop around the torus , and they must return to the same point after the loop . the action is then defined @xcite as @xmath20 where the integral is along a closed path @xmath21 that goes from a point on one face of the cube in figure [ fig : torus ] to the associated point on the opposite face .",
    "it is important that a complete loop is made because otherwise the angles will only be local variables .",
    "when the data does not form a closed loop it is not possible to use the definition ( [ actionint ] ) .",
    "but one can still transform to action - angle variables from a given canonical coordinate system by use of a generating function @xcite .",
    "the problem is to find the appropriate generating function for the transformation .",
    "this can be done by solving the hamilton - jacobi equation , which in general is problematic , as it is non - linear .",
    "we look for a generating function @xmath22 so that @xmath23 then the time independent hamilton - jacobi equation takes the form @xcite @xmath24 where @xmath25 is the energy and @xmath26 is the hamiltonian of the system . the method used to solve ( [ hj ] ) then usually relies on assuming a solution which is separable in each position variable @xmath27 and thus the solution is reached through the normal separation of variables procedure @xcite .",
    "there are a limited number of potentials for which the action - angle coordinates are analytically known in terms of the cartesian coordinates .",
    "the algorithm , that will be described in [ sec : algtheory ] , utilises these as  toy \" potentials to assign values of actions and angles to points from the integrated orbit in cartesian space .",
    "the two potentials that are used are the isochrone and the simple harmonic oscillator ( sho ) potentials @xcite .",
    "these are used because the general form of trajectories in these potentials covers the two main types of bound orbits that can exist in an arbitrary galactic potential .",
    "the isochrone is an axisymmetric potential and produces loop orbits ( figure [ fig : boxloop]a ) which conserve angular momentum along a given axis .",
    "the sho does not conserve angular momentum and produces box orbits ( figure [ fig : boxloop]b ) .",
    "the choice of which type of potential to use is based on the type of orbit being fitted , which is discussed in [ sec : algpract ] .",
    "the isochrone potential ( 2.2.2 of @xcite ) is @xmath28 which in the limit @xmath29 reduces to the kepler potential and in the limit @xmath30 reduces to the spherical harmonic potential . @xmath31 and @xmath32 are free parameters , that physically would represent the total mass , @xmath33 , of the galaxy and the characteristic radius , @xmath32 , at which the potential starts to fall as @xmath34 after being spherically harmonic ( goes as @xmath35 ) in the centre . if these orbits are not closed then in position space they fill the volume of a 2-torus .    the sho potential ( 3.5.1 of @xcite ) @xmath36 gives box orbits , so named because if left to run over a sufficiently long time such an orbit fills a cuboid in position space .",
    "the @xmath37 are free parameters that can be considered physically as the frequencies of oscillations in each coordinate direction .",
    "the relationships between the two coordinate systems for the isochrone potential can be found in appendix [ sec : aaana ] .",
    "the derivation for the sho potential is outlined here because it is relatively simple and thus illustrates the method well ( the two dimensional case is treated in 3.5.1 of @xcite and is easily generalised to three dimensions ) .",
    "the hamiltonian for the sho is clearly separable into the three cartesian components .",
    "thus , the hamilton - jacobi equation is solved by writing the generating function as @xmath38 which then gives an expression that can be solved by separation of variables for @xmath9 in terms of the @xmath27 .",
    "the actions are then found by considering the change in the generating function given by taking a loop around the torus of @xmath4 along one of the axes and then normalising by @xmath4 .",
    "this gives @xmath39 once the generating function is known the angles can be computed by taking the partial derivative given in the second equation of ( [ ptheta ] ) so that @xmath40",
    "the procedure for the algorithm is as follows : a set of phase space data points describing an orbit in an arbitrary potential have an analytic potential fitted to them based on the type of orbit .",
    "if the orbit is a loop , an isochrone potential is fitted and if it is a box then a harmonic potential is fitted .",
    "the fitted potential then plays the role of the  toy \" potential .",
    "values of actions and angles for each of the data points can be assigned from the known relations between cartesian coordinates and action - angle coordinates of these potentials",
    ". however , these actions will not be constants , because the potential that the orbit has been integrated in will differ from the isochrone or sho potential .",
    "the actions of the  target \" potential are then extracted by considering a canonical transformation , where the key process involves an average being taken over the angle coordinates .    in order to perform the transformation a generating function of the form @xmath41 is considered .",
    "this generating function transforms from the coordinates of the  toy \" potential @xmath42 to the coordinates of the  target \" potential @xmath43 .",
    "because the system is periodic we can expand the generating function as a fourier series @xcite giving the general form @xmath44 remembering that @xmath45 is a constant ; then as the coefficients @xmath46 are functions of the @xmath45 only , they too are constants .",
    "the @xmath47 are three - vectors with integer values .",
    "the @xmath48 are computed through @xmath49 which gives , on rearranging for the target action , @xmath50 now , on taking the average over the @xmath51 variables @xmath52 because the second term in ( [ j ] ) is a sum of periodic functions that on averaging over a whole period vanish .",
    "so all that needs to be done is to calculate @xmath53",
    "the code that has been written takes as an input a list of cartesian phase space coordinates that describe an orbit in an arbitrary potential and gives an output of three actions for that orbit .",
    "appendix [ sec : flowdiagram ] includes a basic flow diagram of the algorithm .",
    "the algorithm first decides whether the orbit is best described as a loop or a box orbit .",
    "the choice between the two is based on the fact that in loop orbits there is a well defined sense of rotation about one of the axes , whereas this is not true for box orbits .",
    "two methods of identifying this rotation have been tested .",
    "the first method computes the mean angular momentum along the three axes and the standard deviation of each mean .",
    "if the standard deviation is greater than the mean in all three directions the orbit is a box .",
    "otherwise the angular momentum is conserved in at least one direction , giving a loop orbit .    in the second method",
    "the sign of the angular momentum is calculated at each point .",
    "if the sign changes then this clearly implies that there is no well defined sense of rotation about that axis .",
    "if the sign of all three components does change then one concludes that it is a box orbit .",
    "otherwise it is a loop .",
    "the second method has proven , during running the algorithm , to be more robust in identifying the two orbit types and has thus been chosen as the preferred method .",
    "this is because the first method requires a large number of data points fairly spread across the phase space of the orbit in order to accurately calculate the statistical quantities required for the analysis , whereas the second method can stop as soon as the signs on all three axes have changed .    in the case of a loop orbit",
    "it is important to identify which axis has the well defined sense of rotation .",
    "this is because that axis must be passed as the z - axis to the code which converts the cartesian coordinates to action - angle coordinates .    the chosen toy potential ( see [ sec : analyticpots ] )",
    "is then fitted to the data points using a levenberg - marquardt fitting algorithm , which was written following @xcite .",
    "this is done through the free parameters available in the potentials , plus an extra additive energy term , that adds another degree of freedom and allows for a better fit . knowing the parameters it is then possible to assign the action and angle coordinates for each data point .",
    "the levenberg - marquardt algorithm works by minimising @xmath54 through a damped gauss - newton algorithm @xcite .",
    "the @xmath55 are the hamiltonian of the chosen toy potential evaluated at each data point .",
    "the average of the actions over the angles is then taken following [ sec : algtheory ] .",
    "however , because we have a discrete set of data the integral in ( [ jintegral ] ) turns into a sum @xmath56 the denominator is ideally @xmath14 by the normalisation of the @xmath51 coordinates , but remains an explicit sum in the algorithm so that the result is always properly normalised .",
    "the volume is found by using the binary tree method of the fiestas algorithm @xcite .",
    "this calculates the density of the data points in angle space and can easily be modified to give the volumes .",
    "fiestas works by systematically dividing the volume of the angle space into two , alternately along each coordinate axis , until only one point exists in each box .",
    "the size of the box then gives a measure of the volume around each angle space point .",
    "the method calculates the mean coordinate value of all the data points within a given box and then divides that box halfway between the two points nearest the mean , so that there are approximately an equal number of points on each side of the division .",
    "the fiestas algorithm is the key to being able to compute the average in a short period of time , as previous methods could take hours , if not days , to calculate the volumes , whilst fiestas takes seconds @xcite .",
    "the orbit integrator follows the runge - kutta ( rk ) fifth - order method described in _ numerical recipes _",
    "runge - kutta methods are an extension of the simple euler method of iteration where the next coordinate point @xmath57 can be found from the previous point @xmath27 as @xmath58 where @xmath59 is the time derivative of @xmath27 and @xmath60 is the size of the time step .",
    "the time step has to be sufficiently small that the linear approximation holds .",
    "rk methods split the time step and evaluate the velocity at each intermediate point , then combine each term as a linear sum with coefficients selected to get a better estimate of the next position .",
    "the coefficients are usually based on the taylor expansion of the position . in the fifth - order method used , each time step involves six separate function evaluations .    the rk method solves first order differential equations .",
    "we have hamilton s equations @xcite of the form @xmath61 which need to be solved simultaneously .",
    "the rk code was modified to evaluate both equations , at each step , through the integration .",
    "the integrator employs a step size checking procedure , where the error of each step is estimated and if this exceeds a predefined error parameter the step size is reduced until the error is within allowed limits",
    ". it also increases the step size if the calculated error is below a certain limit , so the integration proceeds sufficiently quickly .",
    "the error parameter allows one to control the required accuracy of the integrator and plays an important role in ensuring that the orbits conserve energy .",
    "to test that the algorithm produced the correct actions an output scheme was designed whereby the  perfect ellipsoid \" potential was used .",
    "this has actions which can be expressed analytically .",
    "the principle of the method involves fixing the actions , in a given potential , which thus define the initial conditions . on converting these to cartesian",
    "coordinates one can then integrate the orbit in the ellipsoidal potential to get a set of cartesian phase space points for the orbit and use the algorithm developed to extract the actions from this data .",
    "the extracted actions are then compared to the initial ones to measure the accuracy of the procedure .",
    "all the details of the ellipsoidal potential are covered extensively in the classic paper by de zeeuw @xcite . in the first two parts of this section the results from this paper that are most relevant to this project are included .",
    "the ellipsoidal potential is generated from the density distribution @xmath62 where @xmath63 the potential is given in appendix [ sec : ellipsepot ] and the parameters @xmath64 and @xmath65 provide the scale length along each axis of the ellipsoid .",
    "there are four key types of orbit in the ellipsoidal potential ( see figure 8 of @xcite ) .",
    "three of the types de zeeuw calls",
    " tube \" orbits , of which two lie along the x - axis and one along the z - axis ; these have a well defined sense of rotation about these axes and thus one would expect to associate these with loop orbits in the isochrone . the other type of orbit is a box , and corresponds to that of an sho in the limit of small oscillations around the centre of the potential .",
    "however , this box is not bound by flat planes as in the sho case but by surfaces of hyperboloids and ellipsoids .      in his paper",
    "de zeeuw shows that the hamilton - jacobi equation is separable in ellipsoidal coordinates .",
    "consequently the actions can then be expressed analytically , in a similar manner to the sho case in [ sec : conversion ] .",
    "ellipsoidal coordinates are defined as the roots of the cubic equation for @xmath66 @xmath67 the three roots are labelled by @xmath68 and they satisfy @xmath69 surfaces of constant @xmath70 label ellipsoids , whilst surfaces of constant @xmath71 and @xmath72 label hyperboloids . using equation [ defellipsoid ] one can write the ellipsoidal potential in ellipsoidal coordinates , this form can be found in appendix [ sec : ellipsecoordspot ] .",
    "the solution of the hamilton - jacobi equation gives the momenta in ellipsoidal coordinates as @xmath73,\\end{aligned}\\ ] ] where @xmath25 is the energy of the system , @xmath74 are separation constants and @xmath75^{-1}.\\ ] ] the form of the known function @xmath76 can be found in appendix [ sec : ellipseftau ] .",
    "note that the momenta are purely functions of one of the ellipsoidal coordinates only , reminiscent of the sho case .",
    "it is important that the right hand side of ( [ ptau2 ] ) is positive , such that the momenta are real . as such , it is not sufficient that the @xmath66 only satisfy the inequalities ( [ restriction ] ) , especially seeing as they do not put an upper bound on @xmath70 .",
    "the range of positive values of each @xmath77 is set by the parameters @xmath78 and @xmath65 .",
    "the potential is fixed by choosing @xmath64 and @xmath65 , then @xmath79 and @xmath80 are chosen such that the orbit is bound . for a bound orbit",
    "the total energy is negative , thus requiring @xmath81 and that @xmath82 @xcite .",
    "an algorithm was written to identify the range over which @xmath77 is positive .",
    "this first identified the lower bounds by starting at the given lower bounds ( [ restriction ] ) and incrementing @xmath66 until @xmath83 .",
    "the value was then refined by stepping back once , decreasing the step size and incrementing until @xmath83 again ; repeating until a pre - defined accuracy was reached .",
    "an upper bound on the @xmath70 term was estimated by incrementing from the lower bound up until @xmath84 became negative .",
    "this could be a number of orders of magnitude larger than the lower bound and thus a check was built in to increase the step size if @xmath84 was not decreasing fast enough .",
    "the upper bound was then found following a similar method as for the lower bound for all @xmath66s but approaching from above rather than below .",
    "the method also checks to ensure that the increment does not overshoot the limits imposed by ( [ restriction ] ) .",
    "the values of the @xmath66s chosen for the initial conditions were taken to be the mean of the upper and lower boundary values for each @xmath66 .      in order to initialise the orbit integrator the initial conditions need to be given in cartesian",
    "the transformation from ellipsoidal position coordinates to cartesian position coordinates comes from the definition ( [ defellipsoid ] ) and is given in appendix [ sec : ellipse2cart ] . in order to transform the momenta into cartesian form",
    "the generating function @xcite @xmath85 is used .",
    "the form of the generating function arises because the ellipsoidal momenta are functions of one coordinate only .",
    "this then gives @xmath86    the partial derivatives in ( [ px ] ) are found by inverting the jacobian constructed from the @xmath87 that are easily computed from the equations in appendix [ sec : ellipse2cart ] .",
    "the inverted jacobian is given in [ sec : ellipsejacobian ] .",
    "the transformation made above for the momenta has been checked by computing the energy in both coordinate systems .",
    "the expression for the energy in ellipsoidal coordinates can be found in appendix [ sec : ellipseenergy ] .",
    "the three actions for the ellipsoidal potential correspond to one for each of the three coordinates @xmath88 .",
    "the initial actions are calculated using a factor of four times equation [ actionint ] , where the range of the integral is over the regions of the @xmath66s that were found in [ sec : rangeoftau ] .",
    "the factor of four arises in order that complete oscillations in each of the coordinates are considered @xcite",
    ".    the function @xmath89 can be very steep as the boundary values of @xmath66 are approached , so a suitable coordinate transformation is made to correctly sample these regions .",
    "this takes the form @xmath90 where @xmath91 is the upper bound on the given @xmath66 , @xmath92 is the lower bound on that @xmath66 and @xmath93 ranges between @xmath94 .",
    "the direct output of the actions from the algorithm suggested that there was a significant deviation from the initial chosen actions .",
    "the reason for this forms the main part of the discussion in [ sec : discussion ] . essentially , it was found that this was because of insufficient sampling of the angle space .",
    "figure [ fig : ellipsevaryn ] presents examples of the results plotted for an increasing number of data points @xmath13 .",
    "the curve @xmath95 was then fitted to the data , where @xmath96 and @xmath65 are fitting parameters , with @xmath97 . in the limit as @xmath98 , giving a value of the action for infinite sampling .",
    "the data presented in tables [ loopell ] and [ boxell ] give the results of this fitting procedure .",
    "the initial actions are given as the target values .",
    "table [ loopell ] are results for a loop orbit of the short axis tube type and those of table [ boxell ] are for a box orbit .",
    "the parameters for the potential used were @xmath99 .    [ cols=\"^,^,^,^\",options=\"header \" , ]     all but one of the fits of the data were calculated from data points in the range @xmath100 with an interval of @xmath101 .",
    "the box orbit @xmath102 fit was taken between @xmath103 and @xmath104 due to noise at low @xmath13 . only the @xmath104 orbit needed",
    "to be integrated because all orbits lower than this could be extracted from the data set .",
    "this is beneficial as such orbit integration regimes can take a significant amount of time .",
    "the upper limit of @xmath104 existed because of memory limitations . in some cases",
    "an upper limit of the number of allowed points may also be set by the requirement that no two points may be coincident , as the fiestas algorithm can not then calculate the volume of these two points .",
    "the results presented above demonstrate that the technique works to , at best , 0.75% accuracy . however , it is also clear that this accuracy is not evenly distributed across the actions .",
    "figure [ fig : ellipsevaryn ] suggests a reason for this in that the data points do not form a smooth curve and that this becomes less smooth for the smaller targeted action ( figure [ fig : ellipsevaryn]b ) .",
    "this noise causes a large uncertainty in the fit that is used and thus contributes to the lower accuracy of the result .",
    "the integrals to produce the target actions were checked by decreasing the step size used in the integration and finding that the outputted value did not vary within at least four significant figures .",
    "as this was significantly less than the variation in the calculated actions using the algorithm then these were assumed to be the correct values .",
    "the time taken to compute three actions is @xmath105 for a sample of @xmath104 data points .",
    "this is comparable to the time taken of @xmath106 for a two dimensional system using best - fit methods @xcite .",
    "however , in order to do the fit as @xmath107 the actions need to be calculated multiple times and so increases computation time to the order of an hour .",
    "in this section the discrepancies are discussed and the reasons for them elucidated .",
    "the main contributing factor is an insufficient sampling of angle space due to an inhomogeneous distribution of angles .",
    "it is demonstrated that this also leads to the observed noise and so the reduced accuracy of the results .          the main issue that reduces the accuracy of the method is a non - uniform distribution of points in angle space . in order to investigate this the simple case of orbits in a harmonic potential",
    "were considered .",
    "choices of three frequencies , @xmath108 , were made for the target potential and the orbit integrated in this potential .",
    "a second set of frequencies , @xmath109 , were then chosen for the toy potential and the actions and angles corresponding to that toy potential calculated for the data points of the integrated orbit . the averaging procedure , as described in [ sec : algpract ] ,",
    "was then followed to calculate the actions .",
    "the curves in figure [ fig : shoactions]a display how the value of @xmath110 calculated in the above method varies with the toy frequency .",
    "the value for @xmath111 was chosen , giving @xmath112 .",
    "one can see that when the two frequencies match on the graph the action is correctly calculated by the algorithm . however , for increasing @xmath113 the calculated action increases .",
    "the action increases also , after passing through a minimum , for decreasing @xmath113 .",
    "it is important to note that the target value of the action does not occur at the minimum of this plot .",
    "the reason for the trend of increasing action with toy frequency appears to be because of a bias that is introduced into the averaging procedure by having the incorrect frequency . from ( [ shotheta ] )",
    "it is clear that if the frequency is higher than the target frequency , then the values of the angles assigned by the toy potential will cluster about @xmath114 and @xmath4 .",
    "this clustering corresponds to the apocentre of the orbit .",
    "there is then an increased density of points around apocentre so the volume associated with each point will be reduced .",
    "considering equation [ shoj ] for the actions , a larger value of the frequency at apocentre will increase the value of the action .",
    "the same result holds true for smaller frequencies , which cluster about pericentre .    as the averaging procedure sums over the product of the action at a data point and the corresponding volume",
    ", one would expect that the larger action would counteract the smaller volume and produce the correct target action . however , these two factors are not equal . at apocentre",
    "the action simply changes by a factor of @xmath115 , whilst the angle has a similar reciprocal factor but non - linearity is introduced in taking the arctangent in ( [ shotheta ] ) .",
    "one would also expect to see such biasing in the isochrone case when the parameters for the fit do not match perfectly .",
    "this can be seen in figure [ fig : sampling]b , where even for a large sampling of angle space , there is clear inhomogeneity in the distribution of points .",
    "figure [ fig : sampling ] illustrates that this clustering occurs when both the sho and isochrone potentials are used as toy potentials for orbits in the ellipsoidal potential .",
    "the bias is always going to occur in the ellipsoidal case because the potential in which the trajectory has been integrated will never match exactly either of the toy potentials .",
    "it should also be noted that , even if the frequency matches , there are more points at apocentre than at pericentre because a star will naturally spend more time at apocentre than at pericentre due to it possessing a lower velocity at apocentre .",
    "this is somewhat corrected by the orbit integrator taking larger steps at apocentre , however , this does not generally compensate sufficiently .",
    "so there is always an underlying bias in the data set towards putting points at apocentre and this is emphasised further by the clustering seen for large frequencies .      in an attempt to increase the number density of points in the regions where",
    "the data had been skewed away from , the number of sampling points was increased .",
    "the different curves in figure [ fig : shoactions]a show the effect of increasing the number of points , @xmath13 .",
    "it is clear that as one increases @xmath13 the gradient of the curves decreases .",
    "plotting the values for a fixed toy frequency , taken at @xmath116 , against the number of sampling points one can see that the slope converges .",
    "figure [ fig : shoactions]b shows this data with a fit of equation [ fit ] .",
    "the value of the parameter @xmath117 deviates from the target action of 8.0 by 0.8% .",
    "the success of this method justified the use of the same technique in calculating the actions from the ellipsoidal potential .",
    "this approach should also work for low frequencies , though the divergence seen in figure [ fig : shoactions]a as @xmath118 may prove troublesome .",
    "therefore , one would also require that @xmath119 , which would only become an issue if the orbit being considered was confined to a plane .",
    "the reason that this extrapolation works is because taking the limit as @xmath120 in the discrete sum in ( [ discreteaverage ] ) effectively reproduces the integral form of the equation that was introduced in ( [ jintegral ] ) .",
    "the noise in figure [ fig : ellipsevaryn ] becomes worse for smaller target actions .",
    "it is possible that this is because the angle space volumes are of order @xmath121 , which compares to the same order of magnitude as the smallest target action . on this scale errors in the volume estimation by the fiestas algorithm",
    "become important .",
    "the estimated angle space volume can be significantly different from the  real \" volume because in a space that has clusters of data points , the points on the boundary of the cluster can end up being assigned larger than expected volumes at the detriment of points in the sparser region .",
    "this can clearly be seen in figure [ fig : fiestas ] , which is a two dimensional example that illustrates the results fiestas produces .",
    "the small number of points in the figure were chosen to make it clear how the division process works and emphasise the problem of dealing with clusters .",
    "the volumes assigned to the points in ( a ) and ( b ) are significantly different , even though they are in regions of a similar density of points .",
    "this misallocation of volumes occurs because in order to be metric free fiestas only compares points along one coordinate axis at a time , which loses information on the density of points in the other coordinate directions .",
    "in this report action - angle coordinates have been introduced along with the key concept of a generating function .",
    "the theory of calculating actions via averaging procedures was presented along with an algorithm to complete the process numerically .",
    "the ellipsoidal potential and ellipsoidal coordinates were introduced and the principle of the method was demonstrated to work , achieving for some actions an accuracy of order @xmath122 or better .",
    "the reason for the limited success was discussed and the sampling problem identified . a method to improve the results",
    "was developed and implemented , however , noise from the volume estimation hindered the effectiveness of this approach for small actions .",
    "the averaging approach presented for calculating actions is currently restricted to orbits that can be fitted reasonably well by either an isochrone or sho potential , such that the parameters allow for a smooth curve to be constructed to take the limit as @xmath107 .",
    "the fit of the potential has to be reasonably good so that all the angles are not clumped together , causing fiestas to fail for high @xmath13 integrations , which are required to construct an accurate infinite sampling fit .    to deal with orbits that are not fit well by either an isochrone or sho potential it would be interesting to produce a code that would fit the ellipsoidal potential to an orbit",
    "this would be beneficial because it could allow for a better covering of the transition region between a loop and a box orbit .",
    "the issue of noise could be addressed by modifying the orbit integrator to increase the number density of points in the regions of angle space which are sparsely populated .",
    "this would then remove the problem of dealing with the boundaries between high and low density regions and give better estimates for the volumes .",
    "it could also reduce the insufficient sampling of angle space problem and thus the necessity to take the limit as @xmath107 .",
    "however , there is some difficulty in identifying the required step size in cartesian space that would produce a near uniform distribution of points in angle space .",
    "this is especially true in the isochrone case due to having to invert the complicated relationships between the two coordinate systems ( appendix [ sec : aaana ] ) .",
    "it would also mean that the orbit integration would have to be carried out a second time .",
    "an alternative approach to dealing with the noise would be to use a metric based volume calculation .",
    "the metric in this case would be trivial because it is only needed for the angle space .",
    "however , the disadvantage would then be the loss of the speed associated with the fiestas method .",
    "thus , for a more accurate calculation it seems inevitable that a slower procedure is required .",
    "therefore , in comparison with the current best - fit methods @xcite the method presented here still has a long way to be developed in order to compete both on computation time and accuracy .",
    "it may become useful so long as the problems discussed above could be resolved and then actions could be calculated accurately enough such that the @xmath107 fit would no longer be required .",
    "i would like to thank my supervisor james binney , as well as paul mcmillan , for their most useful guidance and support during this project .",
    "99    arnold v.i.,1989 , mathematical methods of classical mechanics ; springer - verlag : new york , 2nd ed .",
    "ascasibar y. and binney j. , 2005 , numerical estimation of densities .",
    "mnras 356 : 872882 .",
    "bertonea g. , hooper d. , silk j. , 2004 , particle dark matter : evidence , candidates and constraints , physics reports 405 279390 .",
    "binney j. , tremaine s. , 2008 , galactic dynamics .",
    "princeton , nj , princeton university press .",
    "binney j. , galactic dynamics , 2011 tenerife winter school .",
    "de castro a.s . , 1999 ,",
    "point transformations are canonical transformations , eur .",
    "dendy r. , ( chapter 11 : binney j. ) , 1993 , plasma physics : an introductory course , cambridge university press . kaasalainen m. , binney j. , 1994 , construction of invariant tori and integrable hamiltonians , phys . rev . lett .",
    "73 , 23772381 madsen k. , nielsen h.b . , tingleff o. , methods for non - linear least squares problems , 2nd edition , april 2004 , informatics and mathematical modelling , technical university of denmark .",
    "mcgill c. , binney j. , 1990 , torus construction in gravitational potentials , mnras , 244 , 634 mcmillan p. j. and binney j. j. , 2008 , disassembling the galaxy with angle - action coordinates .",
    "mnras 390 : 429437 .",
    "merritt d. , elliptical galaxy dynamics , 1999 , publications of the astronomical society of the pacific , vol .",
    "129 - 168 .",
    "mittrapiyanuruk p. , robot vision laboratory , purdue university https://engineering.purdue.edu/kak/courses-i-teach/ece661.08/homework/hw5_lm_handout.pdf nash c. , sen s. , 1983 , topology and geometry for physicists , academic press .",
    "press w. h. , flannery b. p. , teukolsky s. a. , and vetterline w. t. , 1986 , numerical recipes , cambridge university press , new york .",
    "reiman a.h .",
    ", pomphrey n. , may 1991 , computation of magnetic coordinates and action - angle variables , journal of computational physics , volume 94 , issue 1 , pages 225 - 249 .",
    "spiegel m.r . , 1967 , schaum s outline of theory and problems of theoretical mechanics : with an introduction to lagrange s equations and hamiltonian theory , mcgraw - hill",
    ". de zeeuw t. , 1985 , elliptical galaxies with separable potentials , mnras , vol .",
    "216 , p. 273 - 334 .",
    "here the relationship between cartesian and action - angle coordinates is described for the case of the isochrone potential .",
    "this is taken from the derivation in 3.5.2 of _ galactic dynamics _",
    "the code to implement this conversion was provided by paul mcmillan .    for the isochrone case",
    "the actions are @xmath123 where @xmath81 and is the total energy of the system , @xmath124 is the total angular momentum , @xmath125 is the angular momentum around the z - axis , being the axis of rotation , @xmath31 and @xmath32 are the parameters of the potential .",
    "the angles have a slightly more complicated form , using spherical polar coordinates @xmath126 the first is given by @xmath127 with @xmath128 . for the next two angles",
    "the following definitions are required @xmath129 where the relation to spherical polars comes in the last term with @xmath35 .",
    "so then the angles are @xmath130 and @xmath131\\left[\\theta_3 - 2\\mathrm{arctan}\\left(\\sqrt{\\frac{1+e+2b / c}{1-e+2b / c}}\\mathrm{tan}(\\frac{1}{2}\\eta)\\right)\\right]\\nonumber \\\\   - \\mathrm{arctan}\\left[\\sqrt{\\frac{1+e}{1-e}}\\mathrm{tan}(\\frac{1}{2}\\eta)\\right].\\end{aligned}\\ ] ] where @xmath132 .",
    "this appendix summarises the results from @xcite which are relevant to this project , as well as the inverted jacobian in [ sec : ellipsejacobian ] that has been derived .",
    "the ellipsoidal potential in cartesian coordinates is , @xmath133 where @xmath134 are constant real parameters and the physical prefactor has been set to unity .",
    "the spatial derivative of this potential is what is used to calculate the acceleration in the orbit integrator .",
    "the integral is computed numerically by making the transformation @xmath135 where the limits now run from @xmath136 where @xmath137 is an upper limit chosen to replicate reaching infinity .",
    "technically the upper limit of the integral in the new coordinate system is still infinity , however , the integrand dies off sufficiently quickly at large @xmath138 and @xmath93 that once @xmath139 the integrand is practically zero .",
    "the choice of coordinate transformation simply allows for a quicker integration regime , as @xmath140 goes to infinity much quicker than @xmath138 .          with the physical parameters set to unity",
    "the function @xmath76 takes the form @xmath143 the integral is completed by numerical integration after transforming to coordinates @xmath144 and the range of integration runs between 1 and 0 .",
    "this is derived by taking the partial derivatives of the above relations ( [ cartesianfromellipse ] ) , constructing the jacobian matrix and then inverting it to give @xmath146 and with @xmath147 replaced by the expressions in [ sec : ellipse2cart ] ."
  ],
  "abstract_text": [
    "<S> action - angle coordinates are an essential tool for understanding the properties of the six dimensional phase space involved in orbits of stars in galactic potentials . a new method , which does not require specific knowledge of a generating function , is described , implemented and tested that calculates the actions of an orbit in an arbitrary potential of an integrable hamiltonian given a set of cartesian phase space points . </S>",
    "<S> the method chooses between the simple harmonic oscillator and isochrone potentials to fit the data using a levenberg - marquardt routine . </S>",
    "<S> an average is taken over the angle coordinates by calculating volumes in phase space using the metric free fiestas algorithm . </S>",
    "<S> the perfect ellipsoidal potential , with actions chosen _ a priori _ , is used to test the output of the algorithm , giving some results that agree within 1% . </S>",
    "<S> minimisation of a sampling error is discussed along with an identification of a source of noise in the data .    2 </S>"
  ]
}