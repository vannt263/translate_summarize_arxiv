{
  "article_text": [
    "this is the first in a series of two papers in which we present the results of a study with the hubble space telescope ( hst ) of the line - of - sight velocities of stars in the central few arcsec of the globular cluster m15 ( ngc 7078 ) .",
    "the present paper discusses the spectroscopic observations with the hst space telescope imaging spectrograph ( stis ) and the extraction and calibration of the stellar spectra .",
    "it also discusses the construction of a photometric catalog from hst imaging with the second wide field and planetary camera ( wfpc2 ) , which proved essential in the reduction and interpretation of the data . the second paper ( gerssen et al .",
    "2002 , hereafter paper  ii ) discusses the determination of line - of - sight velocities from the spectra , and the implications for the dynamics and structure of m15 .",
    "the main motivation for our study is to better constrain the possible presence of an intermediate - mass black hole in the center of m15 .",
    "such a black hole was hinted at by previous work ( e.g. , peterson , seitzer & cudworth 1989 ; gebhardt et al .",
    "2000a ) , but the limited quality of the data precluded very strong conclusions ( see the review in van der marel 2001 ) .",
    "the globular cluster m15 at a distance of 10 kpc has one of the highest central densities of any globular cluster in our galaxy .",
    "the high density has likely affected the stellar population , as evidenced by the presence of two bright x - ray sources ( white & angelini 2001 ) and several millisecond pulsars ( phinney 1993 ) .",
    "a variety of interesting dynamical and structural evolutionary phenomena have been predicted to occur at high stellar densities , including mass segregation and the possible formation of a central black hole ( hut et al .",
    "1992 ; meylan & heggie 1997 ; see the additional discussion in the introductory section of paper ii ) . as a result",
    ", m15 has been one of the globular clusters for which the structure and dynamics have been most intensively studied in the past decade .",
    "studies of the dynamics of m15 have focused primarily on the determination of line - of - sight velocities of individual stars , using either spectroscopy with single apertures , long - slits or fibers ( peterson et al .  1989 ; dubath & meylan 1994 ; dull et al .  1997 ; drukier et al .  1998 ) , or using imaging fabry - perot spectrophotometry ( gebhardt et al .  1994 , 1997 , 2000a ) .",
    "integrated light measurements using single apertures have also been attempted ( peterson et al .  1989 ; dubath , meylan & mayor 1994 ) , but are only of limited use ; integrated light spectra are dominated by the light from only a few bright giants , and as a result , inferred velocity dispersions are dominated by shot noise ( zaggia et al .",
    "1992 , 1993 ; dubath et al .",
    "1994 ) .",
    "line - of - sight velocities are now known for @xmath5 m15 stars , as compiled and analyzed by gebhardt et al .",
    "( 2000a ) .",
    "the projected velocity dispersion profile increases inwards from @xmath6 at @xmath7 arcmin , to @xmath8 @xmath9 .",
    "the velocity dispersion is approximately constant at smaller radii , and is @xmath10 at the innermost available radius @xmath11 .",
    "the rotational properties of m15 are quite peculiar .",
    "the position angle of the projected rotation axis in the central region is @xmath12 different from that at larger radii , and the rotation amplitude increases to @xmath13 for @xmath14 , so that @xmath15 in this region .",
    "a plausible explanation for these properties is still lacking .    to improve our understanding of the central mass distribution in m15 , it is of crucial importance to obtain more stellar velocities close to the center .",
    "however , velocity determinations at @xmath16 are very difficult due to severe crowding and the presence of a few bright giants in the central arcsec .",
    "gebhardt et al .",
    "( 2000a ) used an imaging fabry - perot spectrophotometer with adaptive optics on the cfht , and obtained fwhm values as small as @xmath17 .",
    "the strehl ratio was only @xmath18% , so that even in these observations the light from the fainter turnoff and main - sequence stars in the central arcsec was overwhelmed by the psf wings of the nearby giants . as a result",
    ", there are only 5 stars with known velocities within @xmath19 from the cluster center .",
    "to improve upon this situation we initiated the project on which we report here , in which we used hst / stis to map the center of m15 spectroscopically at high spatial resolution . in the future , additional kinematic data on m15 may come available from stellar proper motion measurements with hst , using techniques such as those described by anderson & king ( 2000 ) .",
    "however , at present no such measurements are available .",
    "this paper is organized as follows .",
    "section  [ s : imaging ] describes the construction of a stellar catalog from wfpc2 data .",
    "this catalog is essential for a proper interpretation of the m15 spectra .",
    "it is distributed electronically as part of the present paper .",
    "section  [ s : calibspec ] describes stis spectra of a bright field star which were obtained to calibrate the stis point spread function ( psf ) and line - spread function ( lsf ) .",
    "section  [ s : specm15 ] describes the m15 stis spectroscopy , the observational setup and data reduction , and an analysis of the achieved slit positioning accuracies .",
    "the velocity calibration accuracy of the spectra is the most crucial aspect of the observations , and this issue is discussed in detail .",
    "section  [ s : indstars ] discusses the algorithm adopted for the extraction of individual stellar spectra .",
    "these spectra form the end - product of the present paper .",
    "they are used in paper  ii to determine line - of - sight velocities and to study the structure and dynamics of m15 .",
    "section  [ s : conc ] presents concluding remarks .",
    "for proper planning and interpretation of long - slit spectra of m15 it is necessary to know the positions and magnitudes of the stars in m15 . because m15 is dense , and its central regions are crowded , it is important to determine these quantities from high spatial resolution data .",
    "several imaging studies of m15 were undertaken with the hst in the years 1990 - 1994 ( lauer et al .",
    "1991 ; ferraro & paresce 1993 ; stetson 1994 ; de marchi & paresce 1994 ; yanny et al .",
    "1994 ) , but these suffered from the aberrated hst psf .",
    "imaging studies with the faint object camera ( foc ) on the refurbished hst ( with costar ) were reported by de marchi & paresce ( 1996 ) and sosin & king ( 1997 ) . however , while foc provided a sharp and well - sampled psf , it had only a very small field of view and its data were hard to calibrate accurately .",
    "data from wfpc2 are therefore preferable ; see biretta et al .",
    "( 2001 ) for a detailed description of this instrument .",
    "wfpc2 images of m15 were obtained on april 7 , 1994 in the context of hst program go-5324 ( pi : yanny ) .",
    "results from these observations were reported in a study led by one of us ( guhathakurta et al .",
    "1996 , hereafter g96 ) .",
    "data were obtained using the filters f336w , f439w and f555w , respectively , which correspond roughly to the johnson u , b and v bands .",
    "the g96 paper provides a detailed discussion of the data acquisition and reduction .",
    "their figure  1 shows a large scale black - and - white image of m15 , while their figure  2 shows a ` true - color ' image of the central @xmath20 .",
    "the photometric analysis of g96 yielded a list of stars , and for each star its position on one of the wfpc2 chips and the countrate in each of the filters .",
    "this list is the starting point of the present analysis . while g96 applied both an astrometric calibration ( the transformation from chip position to right ascension ra and declination dec ) and a photometric calibration ( the transformation from count - rate to johnson u , b and v magnitudes ) to their star list , these were not particularly accurate .",
    "the wfpc2 had only just been installed on hst when the g96 data were obtained , and there was little information available on the appropriate astrometric and photometric transformation equations when their paper was written .",
    "this was not a problem for the g96 study , which focused on a determination of the stellar number density profile of m15 .",
    "however , for the present application both astrometric and photometric accuracy are important , and we therefore decided to apply an improved calibration to the g96 star list .",
    "for the astrometric calibration we first ran the iraf / stsdas task uchcoord , as recommended by the hst data handbook ( voit et al .  1997 ) .",
    "this properly sets the image header parameters for the wfpc2 plate scales and chip - to - chip rotations .",
    "the task metric was then used to transform the pixel coordinates of each star to ra and dec in the guide star coordinate system ( gscs ) . for the position of the m15 cluster center we adopted the pixel position calculated by g96 ( which has an estimated @xmath21 uncertainty of @xmath22 in each coordinate ) . for each star the relative position with respect to the cluster center is given by @xmath23 and @xmath24 . in the following it is more convenient to work in a right - handed cartesian coordinate system , so we define @xmath25 and @xmath26 .",
    "the 1@xmath27 absolute accuracy of the gscs is only @xmath28 .",
    "however , the absolute astrometric accuracy can be improved using the star ac211 .",
    "this x - ray source has a radio counterpart for which the position is determined to within @xmath0 accuracy .",
    "kulkarni et al .",
    "( 1990 ) find for ac211 that @xmath29 and @xmath30 .",
    "we find for ac211 that @xmath31 and @xmath32 .",
    "this implies that the m15 cluster center is at @xmath33 and @xmath34 in the radio coordinate system .",
    "this differs by @xmath35 from the position that was calculated in gscs , consistent with the absolute accuracy of the latter .      for the photometric calibration we started with the count rates ( i.e. , the integrated counts divided by the exposure time ) determined by g96 .",
    "these had been corrected to an equivalent aperture with a radius of @xmath36 , although the actual photometry was performed with a smaller aperture .",
    "these count rates were first corrected for geometric distortion and then for the wfpc2 charge transfer efficiency ( cte ) problem , as described in the hst data handbook ( voit et al .",
    "for the cte correction we used the formulae given by whitmore & heyer ( 1997 ) .",
    "however , we increased their recommended corrections by a factor 3 , to take into account that the cte was more of a problem before april 24 , 1994 ( i.e. , when the m15 data were taken ) . on this date",
    "the wfpc2 temperature was lowered from @xmath37c to @xmath38c .",
    "the factor of 3 was chosen on the basis of quantitative comparisons of the cte effect at the two different temperatures ( holtzman et al .",
    "we then transformed the count rates to johnson u , b and v magnitudes using the procedures described by holtzman et al .",
    "( 1995b ) .",
    "several iterations were performed to get the color terms correct in the transformation equations .",
    "the filter- and chip - dependent change in throughput that occurred on april 24 , 1994 was taken into account , using the values given in the wfpc2 data handbook ( voit et al .",
    "1997 ) .",
    "the above steps provide an optimal relative photometric calibration for the data",
    ". however , the absolute calibration remains uncertain due to uncertainties in aperture corrections and contamination - related throughput corrections .",
    "this is the case for wfpc2 data in general , but is particularly important for data taken before april 24 , 1994 .",
    "wfpc2 was operated at @xmath37c for only a few months , and the instrument calibrations available for this period are considerably less accurate than those available for subsequent data .",
    "we therefore applied a constant additive correction to all the stellar magnitudes for a given filter+ccd combination .",
    "the corrections were chosen to align the red giant branch ( rgb ) and horizontal branch ( hb ) features in color - magnitude diagrams ( cmds ) with the corresponding features in well - calibrated ground - based data ( durrell & harris 1993 ; stetson 1994 ) .",
    "the corrections ranged from @xmath39@xmath40 mag . with these corrections",
    "we estimate the calibration of the final catalog to be accurate to @xmath41  mag in @xmath42 and @xmath43 and to @xmath44  mag in @xmath45 .",
    "this is sufficient for the purposes of the present project .",
    "the final stellar catalog contains 31,983 stars with their positions and u , b and v magnitudes .",
    "it is distributed electronically as part of this paper .",
    "for reference , the first 25 entries are listed in table  [ t : catalog ] .",
    "each star has an i d number .",
    "these numbers were already used for cross - identification purposes by gebhardt et al .",
    "( 2000a ) in their compilation of m15 stars with ground - based line - of - sight velocity determinations . the spatial distribution of the stars in our wfpc2 catalog is shown in figure  [ f : catimage ] .",
    "the footprint of the wfpc2 field of view is clearly visible . towards the east the catalog extends as far as @xmath46 arcmin from the cluster center . for comparison ,",
    "the half - mass radius of m15 is @xmath47 arcmin and the tidal radius is @xmath48 arcmin ( harris 1996 ) , so the catalog only covers the central part of m15 .",
    "note from figure  [ f : catimage ] that stars are not detected along the ccd chip boundaries .",
    "stars within @xmath49 from the cluster center are all detected on the pc chip , and this inner region of m15 is therefore spatially complete in the catalog .",
    "figure  [ f : cmd ] shows a cmd of @xmath43 vs.  @xmath50 for the stars in the catalog .",
    "the well - known stellar - evolutionary features of the main sequence , subgiant branch , rgb , hb , and blue stragglers are all easily discernible .",
    "the increased width of the hb between @xmath51 ( the instability strip ) is due to rr lyrae variables .",
    "the implications of the morphology and position of the observed cmd features for the age , metallicity and stellar population of m15 have all been addressed previously ( e.g. , durrell & harris 1993 ; ferraro & paresce 1993 ; stetson 1994 ; de marchi & paresce 1994 ; yanny et al .",
    "1994 ; de marchi & paresce 1996 ; sosin & king 1997 ) and will not be discussed here .",
    "the large color spread of the main sequence at faint magnitudes is due to photometric errors .",
    "the photometric errors and completeness of the catalog , and their dependence on distance from the cluster center , were discussed in detail by g96 .",
    "the catalog is essentially complete for magnitudes brighter than @xmath52 , and the completeness drops steadily towards fainter magnitudes .",
    "no stars are detected fainter than @xmath53 .",
    "we were awarded 25 orbits in the context of hst program go-8262 ( pi : van der marel ) for a spectroscopic study of the central region of m15 .",
    "all observations were taken with stis ( see leitherer et al .",
    "2001 for a detailed description of this instrument ) . for all observations we used the 52x0.1 slit , which has a calibrated width of @xmath54 ( bohlin & hartig 1998 ) .",
    "as dispersive element we used the g430 m grating centered at a wavelength of 5216 .",
    "this yields spectra that cover the region from 50735359 .",
    "this wavelength range has often been used for kinematical studies and it includes the mg b triplet region around 5175 .",
    "the pixel size in the spatial direction is @xmath55 ( bowers & baum 1998 ) .",
    "the pixel size in the spectral direction is 0.276 .",
    "the latter corresponds to @xmath56 at the center of the wavelength range . for comparison , the central velocity dispersion of m15",
    "has previously been measured to be @xmath57 ( gebhardt et al .",
    "2000a ) , so for a proper understanding of the m15 kinematics the doppler shifts must be measured to a fraction of a pixel accuracy .",
    "this requires accurate calibration , and a detailed understanding of the stis point spread function ( psf ) and line - spread function ( lsf ) . for this reason we used one orbit on june 14 , 1999 , for a set of calibration observations of a bright field star .      for the calibration observations we chose to observe the star hd 122563 , an extremely metal - poor field giant with magnitude @xmath58 . at the start of the orbit",
    "an acq acquisition procedure was executed to put the star near the center of the slit .",
    "this procedure has a nominal accuracy between @xmath59 ( leitherer et al .",
    "2001 ) and @xmath60 ( voit et al .",
    "it was not necessary to achieve better pointing accuracy than this , so we did not perform an additional ( more accurate ) acq / peak procedure .",
    "a series of small telescope slews were then used to successively position the star at 14 different positions relative to the slit , as shown schematically in figure  [ f : hdslit ] . at each position",
    "two spectra were obtained .",
    "these were dithered by an integer number of @xmath61 pixels in the direction parallel to the slit , to allow removal of ccd defects during data reduction .",
    "the exposure times ranged from 2 to 20 seconds per exposure .",
    "the longer exposure times were used when the star was offset perpendicularly from the center of the slit , so as to obtain an approximately similar signal - to - noise ratio ( @xmath3 ) for all exposures .",
    "we used 2-pixel on - chip binning in the spatial direction to obtain an effective pixel size of @xmath62 .    the stis mode selection mechanism ( which selects and positions the grating ) has a small mechanical non - repeatability .",
    "this causes an uncertainty ( amounting to a few pixels ) in the relative position of the 2d spectrum with respect to the ccd rows and columns .",
    "in addition , slight drifts in this position ( of the order of @xmath39 pixel ) can occur over the course of an orbit .",
    "for accurate calibration it is therefore important that contemporaneous spectra of an arc lamp are obtained . for the calibration star observations we obtained five exposures of an arc lamp , spread equally in time between the beginning and the end of the orbit .",
    "our data reduction procedures are based on the default stis reduction pipeline . however , we applied a number of modifications and additional calibrations to obtain more accurate results .",
    "we started with the raw data files , and used the iraf / stsdas task getref to ensure that the relevant header keywords point to the most appropriate calibration files .",
    "subsequently , the basic2d task was run to perform the tasks of data quality initialization , bias subtraction , dark current subtraction , and flat - fielding .",
    "for the dark current subtraction we used the ` superdark ' frames that are generated by stsci on a weekly basis .",
    "we experimented with the use of daily darks , but found that they did not improve the results due to their lower @xmath3 .",
    "we fitted and subtracted a spatially linear background from all frames to ensure that source - free regions along the slit were consistent with zero .",
    "the two exposures obtained at each stellar position were then aligned and co - added .",
    "the latter was done with the task ocrrej , which rejects cosmic rays and ccd defects .",
    "bad columns were corrected using linear interpolation .",
    "after these steps a significant number of bad pixels remain in the data .",
    "positive outliers are generally pixels that are ` hot ' in the data frame but normal in the ( non - contemporaneous ) dark frame , while for negative outliers the opposite is generally the case .",
    "all outliers were interpolated over using the task cosmicrays ( to find the negative outliers the science frame was multiplied by minus one ) .",
    "the arc lamp spectra were reduced similarly as the object spectra .",
    "the wavecal task was then used to determine the shift of the spectra with respect to a fiducial spectrum maintained in the hst data archive . these mode selection mechanism ( msm )",
    "shifts were interpolated linearly in time over the course of the observations to determine the msm shift appropriate for each individual exposure of the target .",
    "an additional complication in the velocity calibration arises from the fact that hst moves around the earth with an orbital velocity of @xmath63 .",
    "this can cause velocity shifts between observations taken at different times of up to @xmath64 .",
    "this exceeds the velocity dispersion of m15 , and it is therefore imperative to correct for this .",
    "this is not normally done by the stis / ccd pipeline .",
    "however , the support files that are created and delivered with hst data contain header keywords ( velocstx , velocsty , velocstz ) that contain the three - dimensional velocity vector of hst ( as measured halfway through the exposure time ) .",
    "phil hodge ( priv .",
    "comm . ) kindly provided a routine to calculate the velocity component in the direction of the target , given its ra and dec .",
    "we used this routine to calculate this velocity for each exposure .    for each exposure , the hst velocity shift was combined with the msm wavelength shift calculated previously ( using the fact that 1 pixel is @xmath65 at the center of the wavelength range ) .",
    "the shifts calculated for different exposures at the same target position were then averaged , weighted by the individual exposure times .",
    "these shifts were then written to the header keywords in the co - added and reduced target spectra .",
    "the task x2d was then used to read these keywords , and perform a two - dimensional rectification to a linear heliocentric wavelength scale along rows , and a linear spatial scale along columns .",
    "this also performs a flux calibration to units of @xmath66 .",
    "one problem in all stis spectroscopy of point sources is the fact that the spatial pixel size of @xmath55 undersamples the hst psf .",
    "for the calibration star observations we used 2-pixel on - chip binning in the spatial direction to obtain an effective pixel size of @xmath62 , which further increases the undersampling .",
    "it is useful to have an understanding of the influence of this on the inferred spectra .    for any spectrograph ,",
    "a spectrum that falls on the ccd is generally slightly titled ( by of order a few degrees ) with respect to the detector rows . for a point source that is well sampled , the 2d spectrum will have the appearance of a smooth tilted line",
    ". however , for a point source that is undersampled , the 2d spectrum will a have the appearance of a stairwell . during data reduction ,",
    "the spectrum is interpolated and rotated to make it align with the rows of the frame .",
    "however , this does not remove any undersampling . in an undersampled situation ,",
    "the rectified spectrum will on average be horizontal , but it will have the zig - zag appearance of an un - tilted stairwell .",
    "if all the rows in the rectified spectrum are summed , one recovers the correct spectral shape .",
    "however , any horizontal cut along an individual row will have strong low - frequency undulations multiplied into the spectrum .",
    "these effects are illustrated in figure  [ f : undersamp ] , which shows the results for one of the two - dimensional spectra of the calibration star .",
    "the top curve is the rectified spectrum summed along all rows , which provides a fairly accurate representation of the actual spectrum of the star .",
    "by contrast , the bottom curve shows the spectrum for the brightest row in the rectified image .",
    "it has low - frequency undulations multiplied into the spectrum .",
    "individual rows in all of the rectified spectra obtained for our program look similar to this .",
    "we obtained most of the m15 data without spatial rebinning , but this does not remove the undulations .",
    "it merely decreases their amplitude and increases their frequency by a factor of 2 .    at first glance",
    ", one might think that an undulating spectrum such as in figure  [ f : undersamp ] is completely useless , unless one can somehow correct for the undersampling . however , it turns out that for the present purposes these undulations are not a problem at all .",
    "we wish to measure radial velocities from the doppler shifts in absorption lines .",
    "the absorption lines are much narrower than the undulations in the spectrum , and their positions are not in any way affected . in cross - correlation techniques one always filters out low frequency components , and we have found that this efficiently removes any influence of the undulations on the inferred velocities .",
    "figure  [ f : crosscor ] illustrates this by showing the cross - correlation function of the two spectra shown in figure  [ f : undersamp ] , both without and with low - frequency filtering .",
    "the tests described below and in paper  ii have convinced us that the undulations do not in any way compromise our ability to infer radial velocities .      after the reduction of the calibration star data",
    ", we have 14 different two - dimensional spectra . in each spectrum",
    "there is signal in more than one row , because the stis psf is not a delta function .",
    "all rows that contain signal can be analyzed as separate spectra .",
    "for the analysis it proved useful to also have a single grand - total one - dimensional spectrum for each position of the calibration star .",
    "such spectra were obtained by co - adding all rows in a given two - dimensional frame .",
    "we wish to use the spectra to calibrate the stis psf and lsf . for each spectrum ( either for a given row , or grand - total ) we therefore extracted two numbers : ( a ) the total count rate per second @xmath67 summed over all wavelengths ; and ( b ) the wavelength shift @xmath68 of the spectrum with respect to some fixed standard spectrum .",
    "the standard was chosen to be the grand - total spectrum obtained with the star at the origin of the coordinate system shown in figure  [ f : hdslit ] .",
    "the wavelength shifts were determined by cross - correlation , using techniques that are described in detail in paper  ii .",
    "figure  [ f : calibtot ] shows @xmath67 and @xmath68 as function of the offset @xmath69 of the star perpendicular to the slit ( defined as in figure  [ f : hdslit ] ) .",
    "the count - rate @xmath67 was normalized arbitrarily ; its absolute value scales linearly with the brightness of the star , and is of no interest in the present context .",
    "the count - rate is large if the star is centered in the slit , and of course , it drops if the star is moved further from the slit .",
    "however , the count - rate remains positive even if the star is outside the slit , due to the wings of the psf .",
    "the peak of @xmath67 identifies the center of the slit , @xmath70 .",
    "this peak does not occur at @xmath71 , which implies that the star was not perfectly centered in the slit after the target acquisition procedure .",
    "the shift @xmath68 is measured in pixels ( in the wavelength direction ) .",
    "it is not a constant number , but shows a well - defined behavior as function of @xmath69 .",
    "the observed behavior is easily understood qualitatively . at each wavelength",
    ", the grating makes an image of the slit on the detector .",
    "if the light that enters through the slit is not centered in the slit , then the observer perceives a shift in wavelength .",
    "let @xmath72 be the shift ( with respect to the arbitrary standard ) for a source placed in the center of the slit ( @xmath73 ) .",
    "if the calibration star is positioned at @xmath74 , then the intensity - weighted average @xmath69 coordinate of the light that enters through the slit has @xmath75 .",
    "this is perceived as a positive wavelength shift , @xmath76 . alternatively ,",
    "if @xmath77 , then @xmath78 . if a star is moved out of the center of the slit , then initially @xmath79 increases monotonically",
    ". however , this behavior ultimately reverses . for large values of @xmath80 only light in the wings of the psf enters through the slit .",
    "these wings have relatively small intensity gradients , and the slit will be illuminated more or less homogeneously .",
    "this causes @xmath79 to revert to values near zero .    it is easy to see that @xmath81 can never be more than half the slit width , i.e. , @xmath82 ( this limit corresponds to a delta function psf ) .",
    "taking into account the anamorphic magnification of the grating , one detector pixel in the wavelength direction corresponds to @xmath83 ( bowers & baum 1998 ) .",
    "thus one always has @xmath84 pixels , or alternatively that the peak - to - peak variation in @xmath68 must be less than @xmath85 pixels .",
    "the observed peak - to - peak variation in @xmath68 is less , but still amounts to @xmath86 pixels ( cf .",
    "figure  [ f : calibtot ] ) .",
    "this corresponds to @xmath87 , which is more than the m15 velocity dispersion .",
    "it is therefore important to be able to model this effect , and to correct for it in the analysis of the m15 data .      to model the calibration star data we consider the case of observations of a point source through a rectangular aperture .",
    "the aperture size is @xmath88 , where @xmath89 is the slit width and @xmath90 the pixel size .",
    "we adopt a coordinate system with the origin at the center of the aperture .",
    "we assume that the psf can be modeled as a circularly symmetric sum of gaussians , @xmath91 .",
    "\\label{psfgauss}\\ ] ] the individual @xmath92 may be either positive or negative , but must satisfy @xmath93 .",
    "the associated encircled flux curve @xmath94 is given by @xmath95 .",
    "\\label{encircled}\\ ] ] we assume that the aperture is perfectly rectangular , with no diffraction off the aperture edges . let the target be a point source positioned at @xmath96 .",
    "the fraction of the light from the point source that is observed through the aperture is then @xmath97             -\\mathop{\\rm erf}\\nolimits              \\left",
    "[ \\fr{x_0-(a_x/2)}{\\sqrt{2}\\ > \\sigma_i } \\right ]       \\right \\rbrace \\ >       \\left \\lbrace \\mathop{\\rm erf}\\nolimits              \\left",
    "[ \\fr{y_0+(a_y/2)}{\\sqrt{2}\\ > \\sigma_i } \\right ]             -\\mathop{\\rm erf}\\nolimits              \\left [ \\fr{y_0-(a_y/2)}{\\sqrt{2}\\ > \\sigma_i } \\right ]       \\right \\rbrace , \\label{psffrac}\\ ] ] where @xmath98 is the error function ( van der marel 1995 ) . the normalized intensity distribution in the @xmath99 direction , integrated over the @xmath100-direction , of the light that enters through the aperture , is @xmath101 \\",
    ">         \\left \\lbrace",
    "\\mathop{\\rm erf}\\nolimits                \\left [ { { y_0+(a_y/2 ) } \\over { \\sqrt{2}\\ > \\sigma_i } } \\right ]               -\\mathop{\\rm erf}\\nolimits                \\left [ { { y_0-(a_y/2 ) } \\over { \\sqrt{2}\\ > \\sigma_i } } \\right ]         \\right \\rbrace ,            & \\quad \\vert x \\vert \\leq { { a_x}\\over2 }         ; \\\\       0 ,   & \\quad \\vert x \\vert > { { a_x}\\over2 }            .",
    "\\end{array } \\right .",
    "\\label{fofx}\\ ] ] for our observational setup , the coordinate @xmath99 is related to the wavelength @xmath102 through the equation @xmath103 .",
    "the lsf is the convolution of @xmath104 with the additional broadening functions due to the microroughness of the grating , the natural diffraction properties of light , and the binning into pixels ( van der marel , de zeeuw & rix 1997 ) .",
    "however , the latter are all to lowest order symmetric functions of wavelength that do not cause net wavelength shifts .",
    "the only net wavelength shift therefore comes from the fact that @xmath105 ( the intensity - weighted average @xmath99-coordinate of the light that enters through the aperture ) is generally different from zero ( the x - coordinate of the aperture center ) .",
    "integration of equation  ( [ fofx ] ) yields @xmath106 -             \\exp \\left   [ - \\left ( { { x_0-(a_x/2 ) } \\over                                     { \\sqrt{2}\\ > \\sigma_i } } \\right ) ^2                  \\right ]          \\right \\rbrace \\nonumber \\\\ & & \\times         \\left \\lbrace \\mathop{\\rm erf}\\nolimits                \\left [ { { y_0+(a_y/2 ) } \\over { \\sqrt{2}\\ > \\sigma_i } } \\right ]               -\\mathop{\\rm erf}\\nolimits                \\left [ { { y_0-(a_y/2 ) } \\over { \\sqrt{2}\\ > \\sigma_i } } \\right ]         \\right \\rbrace",
    ".   \\label{xmean}\\end{aligned}\\ ] ] with the above equations we are now in a position to model the observed quantities @xmath67 and @xmath68 .",
    "the count - rate @xmath107 , where @xmath108 is a constant that is proportional to the brightness of the target and the transmission of the telescope+instrument system .",
    "the wavelength shift @xmath68 is @xmath109 , or alternatively in terms of velocity , @xmath110 .",
    "the latter equation is formally valid only at the central wavelength of the grating setting , but the dependence on wavelength can be neglected in the present context .    one additional effect needs to be taken into account , namely the pixel scattering function of the ccd . a photon that falls onto a given detector pixel",
    "has a finite probability of being detected in an adjacent pixel .",
    "this effect can be quantitatively described as convolution with a kernel of size @xmath111 pixels .",
    "the tinytim software package ( krist & hook 2001 ) provides an approximation for this kernel at wavelengths of 4000 and 5500 .",
    "these can be interpolated to the central wavelength of the our observations , which yields : @xmath112 .",
    "the convolution in the spectral direction of the ccd corresponds to a symmetric line broadening , which does affect our radial velocity measurements for m15 .",
    "the only important effect in the present context is the spatial broadening along the slit .",
    "this is described by the 3 pixel convolution kernel @xmath113 , which is the spatial projection of the @xmath111 kernel listed above . to obtain predictions for the observed values @xmath67 and @xmath68 at a pixel @xmath114 along the slit , one must first calculate the predictions at pixels @xmath115 , @xmath114 , and @xmath116 , and then apply the convolution kernel : @xmath117    to interpret the calibration star data we need to fit several unknowns .",
    "the most important parameters to be determined are the parameters @xmath92 and @xmath118 that describe the multi - gaussian psf in equation  ( [ psfgauss ] ) .",
    "in addition , there are : ( a ) the constant @xmath108 defined through the equation @xmath119 ; ( b ) the position @xmath70 of the slit center , which measures the accuracy of the target acquisition procedure ; ( c ) the shift @xmath120 ( with respect to the arbitrary standard ) for a source placed in the center of the slit ; and ( d ) the offset @xmath121 of the target with respect to the center of a pixel along the slit , at the end of the target acquisition procedure .",
    "we assume that all telescope slews between observations were accurate , as they are believed to be ( to the level of milli - arcsecs ) .",
    "the relative positions of the star for the different observations are thus fixed by the values commanded to the telescope ( which are shown in figure  [ f : hdslit ] ) .    to constrain all the unknown parameters we used the measurements for @xmath67 and @xmath68 , not only for the grand - total spectra as shown in figure  [ f : hdslit ] , but also for each of the rows in the individual two - dimensional spectra . while these constraints by themselves were sufficient to obtain acceptable results , we found that the calibration star data do not very accurately constrain the psf at intermediate and large radii .",
    "to improve this situation we used a model estimate for @xmath122 as an additional constraint in the fit .",
    "for this , the tinytim software was used to calculate the stis psf at the central wavelength of our observations . while this psf is formally appropriate only for the stis imaging mode , no better approximation for spectroscopy is readily available .",
    "the tinytim psf and its associated encircled flux curve are shown in figure  [ f : psf ] .",
    "of course , addition of a model psf as a constraint in the fit can make the results worse rather than better , if the model psf is not in fact consistent with the calibration star data .",
    "we have found no evidence for this , and in fact , from a variety of tests we conclude that the two are fully consistent .    to determine the complete set of parameters in our multi - gaussian psf model that best fits all the combined constraints , we used a ` downhill simplex ' minimization routine ( press et al .",
    "we found that adequate results were obtained with @xmath123 gaussians in the multi - gaussian psf .",
    "the thin solid curves in figures  [ f : calibtot ] and  [ f : psf ] shows the predictions of the best fitting model with this @xmath124 .",
    "the parameters of the multi - gaussian psf are listed in table  [ t : psf ] .      as has been discussed ,",
    "there are many complications in the determination of stellar velocities with hst / stis at the few km / s level : hst orbits the earth as it exposes ; the wavelength scale may drift during an orbit ; and a wavelength shift is perceived for a star that is not perfectly centered in the slit .",
    "the most important result of the calibration star observations is therefore the data - model comparison shown in the bottom panel of figure  [ f : calibtot ] .",
    "the model predictions fit the observed wavelength shifts @xmath68 with an rms residual of @xmath125 pixels .",
    "this corresponds to @xmath126 .",
    "so if the position of a star with respect to the slit is known , then the observed line of sight velocity can be calibrated to this accuracy . since the central velocity dispersion of m15 is @xmath127 , this accuracy is sufficient for the purposes of the present program .",
    "the excellent fit in the bottom panel of figure  [ f : calibtot ] verifies not only our psf and lsf modeling procedures , but also provides a stringent test of our data acquisition strategy and data reduction procedures .",
    "figure  [ f : psf ] shows that our multi - gaussian psf model is essentially a smooth fit to the true psf .",
    "computational convenience is gained , but some of the intricate detail of the psf is lost .",
    "most noticeably , the multi - gaussian psf does not reproduce the first airy ring of the psf ( see in particular the middle panel of figure  [ f : psf ] ) .",
    "however , this is no reason for great concern . to appreciate this , note that the psf is itself a purely theoretical construct that is generally unobservable .",
    "what is observed is the convolution of the psf with the response function of an individual pixel , denoted the ` effective psf ' ( epsf ) by anderson & king ( 2000 ) . due to the convolution with the pixel size ,",
    "the airy rings are much less pronounced in the epsf than in the psf . as a result ,",
    "the epsf of our model is much closer to the true epsf , than is the psf of our model to true psf .",
    "in fact , the observable quantities of interest for this program are exactly those shown in figure  [ f : calibtot ] , and indeed , those are adequately reproduced by the model .",
    "we obtained spectra of the central region of m15 for a period of 24 hst orbits , separated over 6 different visits . the first visit ( 5 orbits )",
    "was executed on october 21 , 1999 .",
    "based on the analysis of the data from the first visit some minor modifications were made to the observing strategy .",
    "the remaining visits were then planned for the third week of may 2001 .",
    "indeed , the data for visit 2 ( 4 orbits ) were obtained on may 15 , 2001 . however , on may 16 , 2001 , the primary ( side 1 ) set of stis electronics failed , which took the instrument out of commission for two months .",
    "stis was then revived using the redundant ( side 2 ) set .",
    "this did not affect the instrument characteristics in a major way , apart from a minor increase in the detector read - noise and a somewhat different dark count rate .",
    "the remaining visits 35 ( 4 orbits each ) and  6 ( 3 orbits ) executed between october 2226 , 2001 .    a complete log of the observations is presented in table  [ t : obslog ] .",
    "all observations were done with the same slit width and grating setting as described in section  [ s : calibspec ] .",
    "exposures were taken at 18 different positions covering the central region of the cluster .",
    "figure  [ f : center ] shows the slit positions as they were commanded to the telescope .",
    "the accuracy with which the intended positioning was achieved is discussed in section  [ ss : slitpos ] below .",
    "for all observations the slit was aligned along position angle @xmath128 ( measured from north over east ) .",
    "this pa was chosen to allow the most flexible scheduling of the observations , and is otherwise fairly arbitrary . at each slit position we obtained spectra for a total exposure time that ranged from 46 to 60 minutes .",
    "three or four exposures were obtained per position .",
    "individual exposures were dithered by 4 pixels along the slit , to allow removal of ccd defects during data reduction . in visit  1",
    "we placed the central region of m15 near the center of the ccd . in subsequent visits we placed the central region near row 900 ( out of 1024 ) , to mitigate the loss of signal due to deteriorations in the cte of the stis / ccd . in no case",
    "did we apply on - chip rebinning in the spectral direction , given that the @xmath65 size of a single pixel is already large compared to the m15 velocity dispersion .",
    "however , in the first visit we applied 2-pixel on - chip rebinning in the spatial direction ( as for the calibration star observations discussed in section  [ s : calibspec ] ) to minimize the read - noise component in the spectra . in subsequent visits we did not apply such on - chip rebinning , to minimize the effects of psf undersampling in the spatial direction . the large majority of the orbits consisted of the same simple observational sequence : an arc lamp exposure , followed by three target exposures and then another arc lamp exposure . in the end , the spectra from all visits had sufficient quality to achieve the science goals of our program .    blind pointings with hst are accurate only at the level of @xmath129 , due to the accuracy of the gscs . to position the stis slit on m15 with the required accuracy it is therefore necessary to perform a target acquisition .",
    "stis target acquisitions work by centering on the brightest object in a @xmath130 field . to ensure that the target acquisition would not acquire the wrong target",
    ", we searched for a bright and relatively isolated star in m15 .",
    "the cross in figure  [ f : catimage ] marks the spatial position of the star that was chosen ( # 27604 in the wfpc2 catalog ) .",
    "its position in the @xmath131 coordinate system defined in section  [ ss : astrometric ] is @xmath132 .",
    "its position in the m15 cmd shown in figure  [ f : cmd ] is also indicated by a cross .",
    "each visit started with an acquisition of this star , consisting of an acq acquisition procedure .",
    "in most visits we then slewed the telescope to the intended position near the center of m15 to take the spectra .",
    "however , in visits  1 and  6 we performed an additional acq / peak acquisition procedure ( leitherer et al .",
    "2001 ) and obtained spectra of the acquisition star , before slewing to the center of m15 . in visit  1",
    "we also repeated this procedure at the end of the visit , to allow an independent check of the repeatability of the velocity measurements for this particular star .",
    "the positional accuracy of the target acquisitions and the slews is discussed in section  [ ss : slitpos ] below .",
    "we generally performed a target acquisition only at the beginning of the first orbit of each visit , and not in any of the subsequent orbits .",
    "the data reduction of the m15 spectra was similar to the reduction of the calibration star spectra discussed in section  [ ss : calibreduc ] , including the wavelength calibration using arc lamp spectra obtained in the same orbit , and the correction for the hst velocity during the observations .",
    "this yields for each slit position a single two - dimensional frame with a linear heliocentric wavelength scale along rows , and a linear spatial scale along columns .    one difference between the observations of m15 and those of the calibration star is that we obtained only two arc - lamp spectra per orbit for m15 , as compared to five for the calibration star .",
    "we did some quantitative analysis to address to what extent this may affect the analysis .",
    "the arc lamp spectra show that there are drifts in the wavelength scale over the course of a visit .",
    "these drifts are generally smoothly varying , and are fairly well modeled as a linear function of time . in the worst case ( visit  2 ) the drift was @xmath133 pixels over the 4 orbits of the visit . because we do in fact take two arc - lamp spectra per orbit , we can correct for most of this . in the reduction of the m15 spectra",
    "we assume that the wavelength scale for a given exposure can be obtained by linear interpolation in time between the results for the nearest arc lamp spectra . to test the accuracy of this",
    ", we applied this same procedure to each of the arc - lamp spectra .",
    "this yields the difference between the actual wavelength scale and the one that is obtained by linear interpolation between the previous and the next arc - lamp exposure in the visit .",
    "the rms difference for all arc lamp spectra was found to be @xmath134 pixels , which corresponds to only @xmath135 .",
    "this accuracy is sufficient for the purposes of the project , especially since other effects already set a lower limit to the velocity accuracy of @xmath126 ( cf .",
    "section  [ ss : calibdiscuss ] ) .      for accurate velocity determination of an m15 star it is essential to know its position with respect to the slit .",
    "from the wfpc2 imaging we know where all the stars are on the sky ( see  section  [ s : imaging ] ) .",
    "so the next step is to determine the exact positioning of the slits for all observations . for this we analyzed and modeled the observed intensity profiles along the slit .",
    "these essentially provide one - dimensional ( linear ) images of m15 , which uniquely constrain the telescope pointing .    to model an observed intensity profile along the slit we proceed as follows .",
    "for each star in the wfpc2 catalog we use the observed johnson b and v magnitudes to estimate the flux @xmath136 at 5216 ( the center of the wavelength range for the spectra ) .",
    "we choose a trial position of the slit on the sky . for each pixel along the slit",
    "we calculate the flux contributed by each star , using the formulae derived in section  [ ss : psflsf ] . adding the contributions of all stars in the catalog yields the predicted intensity profile along the slit for the given assumed slit position .",
    "this profile can be compared to the observed profile in a @xmath137 sense ( using an arbitrary scaling that corresponds to the efficiency of the telescope+instrument system ) .",
    "looping over a fine grid of possible slit positions yields the position with minimum @xmath137 , which corresponds to the estimated position of the slit on the sky . to obtain adequate fits we found that we had to add a smooth , low - intensity model for the light contribution of faint stars that are missing from the wfpc2 catalog due to incompleteness .",
    "as an example of the procedure , figure  [ f : intprof ] shows the final data - model comparison for one of the slit positions .    the accuracy with which hst can achieve a requested roll angle is @xmath138 .",
    "the accuracy with which the slit pa on the sky is known is dominated by the calibration uncertainty in the relative angle of the slit within the instrument , which is @xmath139 .",
    "this is small enough that it can be neglected in the present context .",
    "we therefore did not include the slit pa as a free parameter in the fits to the intensity profiles , but kept it fixed at the value commanded to the telescope .",
    "to confirm the validity of this approach we did a number of test runs in which we fitted observed m15 intensity profiles with the slit pa treated as a free parameter .",
    "these tests indeed implied pa values consistent with the value commanded to the telescope , to within the quoted uncertainty .",
    "the intensity profile modeling yields for each observation the actual pointing position of the telescope during the exposures .",
    "the intended pointings are known as well , so it is possible to determine for each observation the offset @xmath140 of the actual pointing from the intended pointing .",
    "the results are shown in figure  [ f : pointings ] .",
    "observations from the same visit are shown with the same plot symbol .",
    "the offsets satisfy @xmath141 and @xmath142 for all observations .",
    "these absolute pointing accuracies are not so important in the present context ; the aim of the observational strategy was to scan the central region of m15 , and not to point at any object in particular .",
    "however , it is important to know the accuracy of our determinations of @xmath140 . to this end",
    "we need to understand the sources of the inferred pointing offsets .",
    "the first source of pointing error is the limited astrometric accuracy of the wfpc2 catalog .",
    "figure  [ f : catimage ] shows that the star that was used for target acquisitions was on a different ccd chip in the wfpc2 observations than the center of m15 .",
    "the astrometric calibration of wfpc2 is considerably less accurate across ccd chips than within a given ccd chip ( @xmath0 as compared to @xmath143 , according to the hst data handbook ; voit et al .",
    "since the slew that we applied from the acquisition star to the m15 center was based on the astrometry of our catalog , an error in this astrometry would yield a fixed non - zero component to the offsets @xmath140 for all observations .",
    "the second source of pointing error is the limited accuracy with which the positions of the apertures are known within the stis instrument .",
    "an acq acquisition centers the target in the 0.2x0.2 aperture . on - board software",
    "then applies a telescope slew to place the target behind the science aperture ( the 52x0.1 in the present case ) .",
    "if there is an error in the expected position of the science aperture , this yields a fixed non - zero pointing error relative to the slit .",
    "we obtained the data for visit  2 in a configuration that is rotated by @xmath144 with respect to that for the other visits .",
    "so any component in the offsets @xmath140 due to this effect would have the opposite sign for visit  2 as compared to the other visits .",
    "figure  [ f : catimage ] shows that the average offset for visit  2 is @xmath145 , whereas the average for all the other visits is @xmath146 .",
    "so there is indeed evidence for pointing errors of this nature .",
    "the third source of pointing error is the limited accuracy of the target acquisitions that start each visit . for most visits we only used an acq acquisition procedure , and not the more accurate acq / peak procedure .",
    "the former has a nominal accuracy between @xmath59 ( leitherer et al .",
    "2001 ) and @xmath60 ( voit et al .",
    "1997 ) .",
    "the fourth source of pointing error is the limited accuracy of the @xmath147 slews from the acquisition star to the m15 center .",
    "the nominal accuracy of such slews is @xmath148 ( downes & rose 2001 ) .",
    "the first four sources of error can explain both the size and the scatter in the pointing offsets for different visits . however , these error sources predict identical offsets for all observations in the same visit . in reality",
    ", there is some scatter among the pointing offsets for observations in the same visit , but this scatter is very small : @xmath143 in the @xmath69 direction , and @xmath1 in the @xmath149 direction .",
    "we attribute this to the fifth source of pointing error : small pointing drifts during a visit as a result of thermal effects on the telescope ( downes & rose 2001 ) .",
    "the small scatter in the offsets for observations in the same visit implies that our models for determining the slit positions from the data must be very accurate",
    ". the numerical accuracy can be no worse than @xmath1 in each coordinate .",
    "an error of this size in the stis @xmath69 coordinate corresponds to a wavelength shift @xmath150 of at most @xmath134 pixels , cf .",
    "the bottom panel of figure  [ f : calibtot ] .",
    "this corresponds to @xmath151 .",
    "this accuracy is sufficient for the purposes of the project , especially since other effects already set a lower limit to the velocity accuracy of @xmath126 ( cf .  section  [ ss : calibdiscuss ] ) .",
    "each row in each of the 18 calibrated and rectified two - dimensional spectra contains the spectrum for a small aperture on the sky . from the analysis in section  [ ss : slitpos ] , the positions of these apertures are known with a ( two - dimensional ) accuracy better than @xmath59 .",
    "figure  [ f : apertures ] shows the inferred aperture positionings for the central region of m15 . in total",
    "there are 19,200 spectra in the dataset .",
    "most spectra contain very little signal from any star , and are therefore of little use in the analysis .",
    "however , some spectra do contain considerable signal from one or more m15 stars .",
    "many stars contribute significantly to more than one aperture . for proper analysis we therefore developed an algorithm to extract the spectra of individual stars .",
    "the algorithm starts with the same modeling procedure used in sections  [ ss : psflsf ] and  [ ss : slitpos ] . from the known positions of all apertures @xmath114 and all stars @xmath152 we calculate predictions for three sets of quantities : ( i ) @xmath153 , the total flux observed in an aperture @xmath114 ; ( ii ) @xmath154 , the total flux contributed by star @xmath152 to aperture @xmath114 ; and ( iii ) @xmath155 , the velocity offset with which star @xmath152 contributes flux to aperture @xmath114 .",
    "let @xmath156 be the total flux of star @xmath152 .",
    "we define @xmath157 to be the fraction of the flux of star @xmath152 that falls in aperture @xmath114 .",
    "we also define @xmath158 to be the fraction of the total flux in aperture @xmath114 that is contributed by star @xmath152 . for each aperture @xmath114",
    "there is one star @xmath152 in the catalog for which @xmath159 has the largest value .",
    "we denote the index number of this star as @xmath160 .",
    "we denote an aperture as ` usable ' if the following three statements are true : ( i ) @xmath161 ( i.e. , there is a single star that contributes at least half of all the flux in the aperture ) ; ( ii ) @xmath162 ( i.e. , there is a non - negligible amount of flux from this star in the aperture ; this limit corresponds to a @xmath43-band magnitude of @xmath163 ) ; and ( iii ) @xmath164 ( the aperture contains a non - negligible fraction of the total flux of this star ) .",
    "apertures that are not usable are ignored in all of the subsequent analysis . for each star",
    "@xmath152 we then make a list of all the apertures @xmath114 for which @xmath165 .",
    "let @xmath166 be the number of apertures for which this is the case .",
    "we denote a star to be ` significant ' for our study if @xmath167 .",
    "we call the spectra for the usable apertures that make up @xmath166 the ` usable ' spectra for star @xmath152 .",
    "in the full dataset there are 1741 usable spectra for 636 significant stars .",
    "the goal is to combine the @xmath166 usable spectra for each significant star @xmath152 into a final spectrum for that star .",
    "this can be done by taking the exposure - time weighted average of the usable spectra .",
    "however , there is the possibility to include or exclude each usable spectrum in or from the average , so there are @xmath168 possible combinations to do the averaging .",
    "specifically , one does not want to include spectra whose main effect is to increase the amount of noise or blending in the average .",
    "we developed an algorithm to optimize the quality of the final spectrum .",
    "the stis data reduction pipeline creates an error frame for each spectrum .",
    "we use the data frames and the error frames to calculate for each usable spectrum the median flux @xmath169 from the star ( i.e. , the median observed flux multiplied by @xmath159 ) and the median noise . from these quantities",
    "we calculate the signal - to - noise ratio @xmath3 for all of the @xmath168 possible combinations of spectra .",
    "we also calculate for all combinations the fraction @xmath170 of the total flux in the averaged spectrum that is due to the significant star .",
    "we rejected all combinations in which @xmath170 is smaller than some value @xmath171 .",
    "of the remaining combinations we adopt the one that produces the highest @xmath3 . the instrumental velocity shift @xmath172 of the final average spectrum of star @xmath152",
    "is calculated as the weighted average of the @xmath155 for the apertures @xmath114 that are used in the combination ; the weighting is done using the product of exposure time and the flux @xmath169 .",
    "we adopted @xmath173 in the extraction , to ensure that the fraction of the flux in the final spectrum that is blended in from other stars is less than 25% .",
    "for the spectra to be useful for kinematical analysis they must have a sufficient @xmath3 . as demonstrated in paper  ii ,",
    "an average @xmath174 per pixel is a minimum requirement ( although not a sufficient requirement ) to obtain meaningful line - of - sight velocity measurements .",
    "all extracted spectra that did not satisfy this requirement were discarded .",
    "this ultimately yielded ` acceptable ' spectra for 131 stars , out of which 15 stars are within @xmath175 from the cluster center , 39 stars are within @xmath176 , and 87 stars are within @xmath177 .",
    "figure  [ f : spectra ] shows the spectra for four stars in the final sample .",
    "all four spectra correspond to stars on the giant branch . from top to bottom , the @xmath43 magnitudes range from @xmath178 to @xmath179 while the average @xmath3 per pixel ranges from @xmath180 to @xmath181 .",
    "although the bottom spectrum is quite noisy , the mg b triplet lines at @xmath182 are still clearly visible .",
    "the faintest star for which we were able to extract a spectrum with @xmath183 from the stis data has magnitude @xmath184 , which is just above the main sequence turnoff .",
    "the spectra in figure  [ f : spectra ] are all reasonably ` flat ' , and do not show the undulations seen in figure  [ f : undersamp ] .",
    "this is because the spectra are sums of individual apertures for several slit positions .",
    "each of the individual spectra has undulations , but these tend to cancel in the final co - addition .",
    "approximately 10 per cent of the stars in our final list of 131 are based on only a single aperture .",
    "the final spectra for these stars show undulations similar to those in figure  [ f : undersamp ] .",
    "as explained in section  [ ss : undersampling ] , this does not compromise our ability to infer radial velocities for these stars .",
    "the 131 individual stellar spectra that we extracted from the stis data form the end product of the present paper .",
    "it is shown in paper ii that accurate velocities can be determined for 64 of these stars .",
    "the spatial and color - magnitude distributions of these stars are discussed in paper ii .",
    "that paper also discussed the implications of the inferred velocities for our understanding of the structure and kinematics of m15 .",
    "the globular cluster m15 is one of the densest globular clusters in our galaxy .",
    "a variety of interesting dynamical and structural evolutionary phenomena have been predicted to occur at high stellar densities , including mass segregation and the possible formation of a central black hole .",
    "stellar kinematical data are required required to address these issues observationally .",
    "while m15 has been one of the globular clusters that has been most intensively studied in the past decades , ground - based data have only been able to provide limited information in the central few arcsec .",
    "we therefore executed a project to map the center of m15 spectroscopically at high spatial resolution with hst / stis .",
    "our observational project is at the limit of what is feasible with hst / stis .",
    "the pixel size of our spectra corresponds to @xmath65 , which exceeds the central velocity dispersion of m15 ( @xmath185 ; gebhardt et al .",
    "extreme care therefore had to be taken in the reduction and velocity calibration of the data .",
    "the main result of the present paper is that we have in fact succeeded in extracting accurately calibrated spectra from our data .",
    "the implications of this for our understanding of m15 are discussed in paper ii .    to be able to properly interpret the long - slit spectra , we started by creating a stellar catalog for m15 .",
    "we used the hst / wfpc2 data discussed previously by g96 , but we performed an improved astrometric and photometric calibration .",
    "the final stellar catalog contains 31,983 stars with their positions and u , b and v magnitudes .",
    "it is spatially complete within @xmath49 from the cluster center , and extends as far as @xmath46 arcmin from the cluster center in some directions .",
    "the catalog contains stars down to magnitude @xmath53 , and it is photometrically complete for stars brighter than @xmath52 .    for proper calibration of the m15 spectra we performed a set of observations of a bright field star , with the star placed at various positions with respect to the slit .",
    "after basic data reduction and correction for the velocity of hst around the earth we used these spectra for modeling the psf and lsf of stis .",
    "this is particularly important for understanding the apparent velocity shift for a star that is offset from the center of the slit .",
    "we derive a simple multi - gaussian model for the psf that reproduces the observed shifts with an rms residual of only @xmath126 ( for a known stellar position with respect to the slit ) .",
    "spatial undersampling causes artificial undulations in the spectra , but this only affects low frequencies and does not affect the determination of radial velocities through cross - correlation .",
    "the m15 observations consisted of 6 hst visits spread over 2 years .",
    "the central region of the cluster was ` scanned ' by consecutively placing the @xmath0 slit at 18 adjacent positions .",
    "the intensity profiles along the slits were used to accurately determine the actual slit positions on the sky . with use of our wfpc2 catalog and psf model",
    "we find that these positions can be determined to an accuracy of @xmath1 in each coordinate .",
    "positional errors in our knowledge of the slit positions translate directly into velocity errors , but with the achieved positional accuracy these errors are no larger than @xmath151 .",
    "the reduced and calibrated data set contains 19,200 stis spectra , each for a different aperture position in m15 .",
    "we developed an algorithm that co - adds the spectra for individual apertures , so as to extract spectra of individual stars with minimum blending and maximum @xmath3 .",
    "our data allowed us to extract spectra with an average @xmath183 per pixel for a total of 131 stars , out of which 15 stars are within @xmath175 from the cluster center , 39 stars are within @xmath176 , and 87 stars are within @xmath177 . in paper",
    "ii we show that reliable line - of - sight velocities can be derived for 64 of these stars , and that this provides enough new information to significantly improve our understanding of the dynamics and structure of m15 .",
    "support for proposals # 8262 was provided by nasa through a grant from the space telescope science institute , which is operated by the association of universities for research in astronomy , inc .",
    ", under nasa contract nas 5 - 26555 .",
    "we thank pierre dubath for helpful advice in the early stages of this project , and brian yanny , don schneider and john bahcall for collaboration on the acquisition of the wfpc2 data .",
    "we thank the anonymous referee for useful feedback that helped improve the presentation of the paper .",
    "rrrccc 1 & 16.343 & 10.269 & 20.467 & 21.313 & 20.869 + 2 & 18.180 & 8.384 & 20.889 & 21.701 & 21.624 + 3 & 7.251 & 19.504 & 20.271 & 20.900 & 20.623 + 4 & 18.725 & 7.807 & 19.363 & 19.893 & 19.738 + 5 & 2.529 & 24.193 & 20.256 & 20.583 & 20.534 + 6 & 2.170 & 24.551 & 20.325 & 20.994 & 20.738 + 7 & 17.248 & 9.263 & 20.738 & 21.234 & 21.206 + 8 & 11.883 & 14.729 & 14.659 & 15.562 & 15.894 + 9 & 1.843 & 24.853 & 20.619 & 21.485 & 21.278 + 10 & 15.338 & 11.195 & 19.454 & 19.935 & 19.840 + 11 & 22.580 & 3.733 & 20.957 & 21.767 & 21.958 + 12 & 19.811 & 6.584 & 18.549 & 19.215 & 19.148 + 13 & 6.533 & 20.103 & 19.973 & 20.440 & 20.372 + 14 & 3.334 & 23.280 & 20.557 & 21.253 & 20.911 + 15 & 16.777 & 9.611 & 20.453 & 21.105 & 20.926 + 16 & 3.759 & 22.784 & 20.885 & 21.633 & 21.377 + 17 & 8.709 & 17.789 & 20.776 & 21.377 & 21.155 + 18 & 13.186 & 13.240 & 20.985 & 22.073 & 21.703 + 19 & 8.817 & 17.666 & 19.188 & 19.698 & 19.478 + 20 & 21.074 & 5.129 & 19.719 & 20.445 & 20.145 + 21 & 4.649 & 21.815 & 20.424 & 20.885 & 20.718 + 22 & 6.399 & 20.045 & 20.568 & 21.132 & 20.988 + 23 & 20.324 & 5.839 & 20.359 & 21.056 & 20.829 + 24 & 6.592 & 19.834 & 19.828 & 20.382 & 20.294 + 25 & 16.308 & 9.954 & 20.307 & 21.043 & 20.993 +      ccccc @xmath196 & 2862 & 4 & 1 & 6 + @xmath197 & 2790 & 4 & 2 & 1 + @xmath198 & 2760 & 3 & 2 & 1 + @xmath199 & 2760 & 3 & 2 & 1 + @xmath200 & 2760 & 3 & 2 & 1 + @xmath201 & 3113 & 4 & 1 & 2 + @xmath202 & 3578 & 4 & 1 & 2 + @xmath203 & 3556 & 4 & 1 & 2 + @xmath204 & 3113 & 4 & 1 & 3 + @xmath205 & 3578 & 4 & 1 & 3 + @xmath206 & 3556 & 4 & 1 & 3 + @xmath207 & 3113 & 4 & 1 & 4 + @xmath208 & 3578 & 4 & 1 & 4 + @xmath209 & 3556 & 4 & 1 & 4 + @xmath210 & 3113 & 4 & 1 & 5 + @xmath211 & 3578 & 4 & 1 & 5 + @xmath212 & 3556 & 4 & 1 & 5 + @xmath213 & 3554 & 4 & 1 & 6 +"
  ],
  "abstract_text": [
    "<S> in this series of two papers we describe a project with the space telescope imaging spectrograph ( stis ) on hubble space telescope ( hst ) to measure the line - of - sight velocities of stars in the central few arcsec of the dense globular cluster m15 . the main goal of this project is to search for the possible presence of an intermediate mass central black hole . </S>",
    "<S> this first paper focuses on the observations and reduction of the data . </S>",
    "<S> we ` scanned ' the central region of m15 spectroscopically by consecutively placing the @xmath0 hst / stis slit at 18 adjacent positions . </S>",
    "<S> the spectral pixel size exceeds the velocity dispersion of m15 . </S>",
    "<S> this puts the project at the limit of what is feasible with stis , and exceedingly careful and complicated data reduction and analysis were required . </S>",
    "<S> we applied corrections for the following effects : ( a ) drifts in the stis wavelength scale during an hst orbit ; ( b ) the orbital velocity component of hst along the line - of - sight to the cluster , and its variations during the hst orbit ; and ( c ) the apparent wavelength shift that is perceived for a star that is not centered in the slit . </S>",
    "<S> the latter correction is particularly complicated and requires many pieces of information : ( 1 ) the positions and magnitudes of all the stars near the center of m15 ; ( 2 ) the accurate positionings of the stis slits during the observations ; ( 3 ) and the hst / stis point - spread function ( psf ) and line - spread function ( lsf ) . to address the first issue we created a stellar catalog of m15 from the existing hst / wfpc2 data discussed previously by guhathakurta et al .  </S>",
    "<S> ( 1996 ) , but with an improved astrometric and photometric calibration . </S>",
    "<S> the catalog is distributed electronically as part of this paper . </S>",
    "<S> it contains 31,983 stars with their positions and u , b and v magnitudes . to address the second issue we model the observed intensity profiles along the stis slits to determine the slit positionings to @xmath1 accuracy in each coordinate . to address the third issue we obtained observations of a bright field star to which we fitted multi - gaussian psf and lsf models . upon reduction of the m15 spectroscopy </S>",
    "<S> we ultimately obtain 19,200 one - dimensional stis spectra , each for a different aperture position in m15 , with a velocity scale accurate to better than @xmath2 . </S>",
    "<S> we develop an algorithm that co - adds the spectra for individual apertures and use it to extract spectra of individual stars with minimum blending and maximum @xmath3 . in paper  ii ( gerssen et al . ) </S>",
    "<S> we use these spectra to extract reliable line - of - sight velocities for 64 stars , half of which reside within @xmath4 from the cluster center . </S>",
    "<S> these velocities constrain the central structure , dynamics and mass distribution of the cluster .    # </S>",
    "<S> 1#2    # 1    ' '' ''    # 1    ' '' ''    # 1    ' '' ''    _ # 1 _    ' '' '' </S>"
  ]
}