{
  "article_text": [
    "the kohn - sham density functional theory ( dft ) of electrons is specified by density functionals that model the exchange and correlation energy of electrons .",
    "these functionals are presently limited by inaccuracies in reference data , insufficient physical constraints , and simplification to convenient but approximate mathematical forms . in most cases , these functionals have an explicit analytic form and their numerical evaluation is straightforward",
    ". however , increasing the accuracy of functionals inevitably requires more complicated forms .",
    "more complex functionals require improved numerical methods to evaluate them both accurately and efficiently .    in this paper , we reassess the numerical evaluation of the semilocal exchange energy component of the heyd - scuseria - ernzerhof ( hse ) functional @xcite , which can not be expressed exactly in a closed analytic form .",
    "its evaluation requires additional numerical approximations and is subject to numerical errors . to date , it has had three distinct implementations @xcite .",
    "they differ primarily in their numerical integration of an electron exchange hole with a screened coulomb interaction .",
    "they also embody different regularizations of the underlying exchange hole model @xcite , which breaks down in the limit of large electron density gradients .",
    "we reevaluate these details and present a new method for approximating the integral that is simple and free of discontinuities and singularities .",
    "our proposed reformulation is accurate to single precision ( @xmath0 ) to reduce numerical errors far below the physical uncertainties of the hse functional and limit the inevitable growth of errors in functional derivatives .",
    "it had been shown that the basic physics contained in the hse exchange hole can be captured in more efficiently computable exchange hole models @xcite .",
    "this is an example of using physical modeling to resolve the difficulty of numerically evaluating the hse functional .",
    "however , those results are not numerically identical to the hse functional and thus these constitute a distinct density functional .",
    "we consider an alternate approach : directly confront the numerical evaluation of the existing hse functional as an application of approximation theory .",
    "this approach makes use of several basic elements of approximation theory that include nonlinear minimax approximation , special function evaluation , and error analysis .",
    "our result serves as a definitive numerical implementation of the hse semilocal exchange functional and demonstrates how increased sophistication in numerical analysis expands the set of numerically tractable models that might be used in the construction of future density functionals .    the paper is organized as follows .",
    "first , we review the hse functional .",
    "second , we define a new regularization to ensure that its value and derivatives are well - defined .",
    "third , we derive a new scheme for numerically integrating the exchange hole based on an approximation of the complementary error function with gaussians .",
    "finally , we assess the accuracy of our new implementation and compare with previous implementations for functional values and first derivatives .",
    "for clarity , we summarize the details of the hse functional that are relevant to discussions of the exchange hole integration .",
    "the hse correlation energy is identical to the perdew - burke - ernzerhof ( pbe ) functional @xcite and is not of interest here .",
    "the hse exchange energy can be written as @xmath1 the terms of this expression are defined by a splitting of the coulomb interaction with error functions into a short - range `` screened '' interaction and a long - range tail , @xmath2 the first term of eq .",
    "( [ exchange_energy ] ) is the fock exchange energy computed with the short - ranged screened coulomb interaction , @xmath3 which requires access to the spinful kohn - sham density matrix , @xmath4 .",
    "the remaining terms replace the density matrix with an exchange hole model @xcite , @xmath5 , that is averaged over angle and assumes no mixing of electron spins , @xmath6 with an introduction of the specific pbe semilocal exchange hole model , @xmath7 , and a switch to inter - electron coordinates , @xmath8 , the semilocal component of the exchange energy is written as the integral over a spatially local exchange energy density per electron , @xmath9 @xmath10 has the same form , except with @xmath11 replaced by @xmath12 .",
    "these terms depend on the electron density , @xmath13 , the reduced density gradient , @xmath14 , and the fermi wavevector , @xmath15 .",
    "all equations and results in this paper are in hartree atomic units .",
    "the @xmath16 function that defines the pbe exchange hole model is non - positive , obeys a normalization constraint , @xmath17 and reproduces the pbe exchange gradient enhancement factor , @xmath18 when integrated with the coulomb interaction , @xmath19 with these constraints , @xmath16 was fit @xcite based on properties of the uniform electron gas , a principle of minimum information , analytic integrability of eqs .",
    "( [ jnorm ] ) and ( [ jfit ] ) , and exact solubility of eq .",
    "( [ jnorm ] ) .",
    "the exchange hole function only appears in calculations within integrals containing a gaussian weight function , @xmath20 \\frac{(c_2 + f)^{3.5}}{(c_2 + f + a)^3 } \\notag \\\\   & \\ \\ \\ \\ \\mathrm{with } \\ \\ \\ \\",
    "c_1 = 0.4516064 , \\ \\",
    "c_2 = 0.57786348 , \\notag \\\\   & \\ \\ \\ \\ \\ \\ \\ \\ \\ \\   \\ \\ \\ \\ c_3 = 0.16520372 , \\ \\",
    "c_4 = 0.0068635965 .",
    "\\notag\\end{aligned}\\ ] ] here @xmath21 contains the exponential integral function , @xmath22 , @xmath23 the variable @xmath24 ( denoted @xmath25 in the original paper @xcite ) is defined implicitly to satisfy eq .",
    "( [ jfit ] ) , which now can be written as @xmath26 . the original version of eq . ( [ xhole_int ] ) was in terms of a different set of five numerical coefficients , which we have rearranged into four different coefficients",
    "@xmath27  for compactness and simplicity .",
    "the pbe exchange hole model used by the hse functional has two mathematical pathologies that complicate its use .",
    "first , eq .",
    "( [ jfit ] ) is satisfied by two values of @xmath24 for @xmath28 and can not be satisfied by any value of @xmath24 for @xmath29 .",
    "second , all partial derivatives of eq .",
    "( [ xhole_int ] ) with @xmath24 diverge at @xmath30 ( when @xmath31 ) while all derivatives of @xmath32 with @xmath33 are finite .",
    "if @xmath34 is modeled as @xmath35 for @xmath36 ( @xmath37 was used in the original numerical fit @xcite ) , the @xmath38 derivative of eq .",
    "( [ xhole_int ] ) with @xmath33 will diverge erroneously at @xmath31 and can not match the correct response of @xmath32 .",
    "the exact @xmath34 is non - analytic at @xmath31 and approaches zero faster than a power law as @xmath39 .",
    "the primary goals of regularizing the exchange hole model are to satisfy eq .",
    "( [ jfit ] ) for all @xmath33 and to ensure all derivatives of the functional are well - behaved for all @xmath33 .",
    "secondary goals are simplicity and efficiency .",
    "we regularize the large-@xmath33 limit without altering the small-@xmath33 behavior by changing the explicit @xmath33-dependence in eq .",
    "( [ xhole_int ] ) from @xmath33 to @xmath40 which smoothly and monotonically limits the range of @xmath33 from @xmath41 to @xmath42 .",
    "we make an arbitrary choice of @xmath43 and @xmath44 , which does not alter eq .",
    "( [ jfit ] ) for small , physical values of @xmath33 and guarantees that it has a solution for all values of @xmath33 .",
    "this is similar to the previously proposed regularization @xcite , but strictly prevents unwanted alterations to the functional for @xmath45 .    the regularized form of @xmath34 is defined to satisfy @xmath46 the revised @xmath34 still causes numerical problems with derivatives of @xmath47 when the non - analytic behavior at @xmath31 is approximated by a rational function .",
    "this issue is resolved by either approximating @xmath34 with a form that exactly reproduces its non - analytic behavior at @xmath31 or by numerically evaluating @xmath34 as a solution of eq .",
    "( [ fdef ] ) .",
    "we choose the latter option and apply newton s method to eq .",
    "( [ fdef ] ) with @xmath34 initialized at its previous rational approximation @xcite .",
    "all the singularities at @xmath30 in eq .",
    "( [ xhole_int ] ) are contained in @xmath21 at @xmath48 .",
    "its evaluation requires a careful cancellation of logarithmic singularities between the two terms .",
    "an algorithm @xcite for the numerical evaluation of @xmath22 prescribes a power series for small @xmath49 and a continued fraction for large @xmath49 .",
    "we incorporate this result into two series expansions of @xmath21 , for @xmath50 as @xmath51 where @xmath52 is euler s constant , and @xmath53 for @xmath54 .",
    "to converge @xmath21 to single precision for all @xmath49 , each expansion requires @xmath55 terms .",
    "the difficulty of integrating the exchange hole with the range - separated coulomb interaction originates from the error function in eq .",
    "( [ separated_integral ] ) .",
    "the analytic form of the exchange hole was originally chosen by ernzerhof and perdew to simplify the integrals in eqs .",
    "( [ jnorm ] ) and ( [ jfit ] ) without considering the difficulty of other integrals .",
    "a simple method for integrating eq . ( [ separated_integral ] ) is to approximate it with something that is analytically integrable .",
    "specifically , we seek to approximate the complementary error function as a sum of gaussians , @xmath56 given such an approximation , we simplify the key integral , @xmath57 because the exchange hole is non - positive , we construct a simple bound on the error of this approximation , @xmath58 with a relative error factor defined as @xmath59 this analysis naturally limits the numerical errors in the hse exchange energy to be a fraction of the pbe exchange energy . also , the error is independent of the scaling of the argument in @xmath60 .",
    "our numerical integration scheme is optimized by minimizing eq .",
    "( [ min_error ] ) over the choice of @xmath61 and @xmath62 , which is done once and then tabulated .",
    "this nonlinear minimax optimization is linearized to form @xmath63 this is solved using the remez exchange algorithm , a standard tool in approximation theory @xcite . with these solutions , we continuously evolve the exponents as @xmath64 until convergence .",
    "this process is not globally convergent and requires a reasonable initial guess for @xmath61 , which is guided by solutions at smaller values of @xmath65 .",
    "the goal of reducing the error factor @xmath66 to below the single precision machine-@xmath67 , @xmath68 , is achieved for @xmath69 and the coefficients are given in table [ fit_coef ] .",
    "there is no need to reduce @xmath67 further because physical modeling errors in the hse functional are orders of magnitude larger than the present numerical errors .",
    ".[fit_coef ] coefficients that minimize eq .",
    "( [ min_error ] ) for @xmath70 . [ cols=\"^,^,^\",options=\"header \" , ]     with this numerical integration scheme , the hse semilocal exchange energy density from eq .",
    "( [ separated_integral ] ) reduces to @xmath71",
    "we have incorporated our new implementation of the hse semilocal exchange functional into a development version of the libxc library of dft functionals @xcite .",
    "this contribution includes first derivatives , which are mostly straightforward to derive .",
    "derivatives of @xmath21 can be related back to its value using the identity @xmath72 .",
    "for example , its first derivative is @xmath73 derivatives of @xmath34 can be calculated from its implicit definition in eq .",
    "( [ fdef ] ) , the first of which is @xmath74 } { \\frac{\\delta}{\\delta f } i(\\tilde{s}(s),0 ) } .\\ ] ]    we compare the new implementation to both a high - accuracy brute - force numerical integration of the exchange hole and the second hse implementation @xcite .",
    "while the second version of hse is not the newest or most accurate , it is the most widely used .",
    "it is the only version available in vasp @xcite , espresso @xcite , and the present development version of libxc .",
    "the accuracy of the two implementations is shown in fig .",
    "[ accuracy ] .",
    "we achieve the target of single precision relative error ( @xmath0 ) in the functional , while the old implementation has relative errors of up to @xmath75 .",
    "the errors are amplified by derivatives , but the stringent accuracy requirements of the new implementation keep first derivative errors below @xmath76 . the relative error in the first derivatives",
    "gets as large as @xmath77 for the old implementation .",
    "accuracy of implementations of the hse semilocal exchange energy .",
    "the new implementation is shown in the left column ( a , c , e ) , and the old is shown in the right column ( b , d , f ) .",
    "the first row ( a , b ) shows the energy density per electron , @xmath78 . the second row ( c , d ) shows the density derivative of the energy density per volume , @xmath79 $ ] . the third row ( e ,",
    "f ) shows the density - gradient derivative of the energy density per volume , @xmath80 $ ] .",
    "the relative error between high - accuracy values , @xmath81 , and approximations , @xmath82 , is plotted as @xmath83 .",
    "we set @xmath84 to a typical material value of @xmath85 and consider a range of parameters : @xmath86 $ ] and @xmath87 $ ] .",
    ", width=340 ]",
    "an important long - term goal of electronic structure research is the continued improvement of accuracy within electronic structure simulations . in this paper",
    ", we have demonstrated an instance where numerical errors in a popular dft exchange - correlation functional ( hse ) are significant .",
    "we have analyzed these errors , devised an accurate and efficient method to eliminate them , and disseminated our new hse implementation in the open - source libxc library .",
    "this result suggests that electronic structure research needs to increase its awareness of numerical errors and standards of numerical analysis .",
    "improvements in physical modeling of electron correlation alone can not lower simulation errors below the floor set by numerical errors .",
    "sandia national laboratories is a multi - program laboratory managed and operated by sandia corporation , a wholly owned subsidiary of lockheed martin corporation , for the u.s .",
    "department of energy s national nuclear security administration under contract de - ac04 - 94al85000 .",
    "11ifxundefined [ 1 ] ifx#1 ifnum [ 1 ] # 1firstoftwo secondoftwo ifx [ 1 ] # 1firstoftwo secondoftwo `` `` # 1''''@noop [ 0]secondoftwosanitize@url [ 0 ]  + 12$12  & 12#1212_12%12@startlink[1]@endlink[0]@bib@innerbibempty @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * , ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop _ _ ,  ed .",
    "( ,  ) @noop * * , ( ) @noop * * ,   ( ) @noop * * , ( )"
  ],
  "abstract_text": [
    "<S> the numerical implementation of an exchange - correlation functional is not always an accurate reproduction of its theoretical specification . for example , </S>",
    "<S> density functionals for exchange and correlation can be defined by an exchange or correlation hole function that is integrated with the coulomb interaction to form an energy . </S>",
    "<S> this construction can be used to modify a density functional for use with any electron - electron interaction . </S>",
    "<S> its most prominent use is in the heyd - scuseria - ernzerhof ( hse ) functional that generalizes the perdew - burke - ernzerhof ( pbe ) model of exchange to a screened coulomb interaction with an error function form . </S>",
    "<S> however , we find non - negligible numerical errors in the standard implementation of the hse exchange hole integration . </S>",
    "<S> we formulate and implement a new method for evaluating the exchange hole integration that is simple , accurate , and efficient . </S>",
    "<S> its numerical errors are bounded and minimized by applying basic elements of approximation theory . </S>"
  ]
}