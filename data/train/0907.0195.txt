{
  "article_text": [
    "one of the most active areas of condensed matter theory is the development of new algorithms to simulate and predict the behavior of materials exhibiting strong correlations .",
    "recent developments in the dynamical mean - field theory ( dmft)@xcite , a powerful many - body approach , hold great promise for more accurate and realistic descriptions of physical properties of this challenging class of materials .",
    "the crucial step towards realistic description of strongly correlated materials was the formulation of dft+dmft@xcite , a method formed by the combination of density functional theory ( dft ) and dmft ( for a review see ref .  ) .",
    "to date , this method already has substantially advanced our understanding of the physics of the mott transition in real materials and demonstrated its ability to explain phenomena including the structural phase diagrams of actinides  @xcite , phonon response  @xcite , optical conductivity  @xcite , valence and x - ray absorption  @xcite and transport  @xcite of archetypal strongly correlated materials .",
    "at present , much effort is devoted to the development of a robust and precise implementation of dft+dmft using state of the art dft electronic structure codes@xcite and advanced impurity solvers@xcite .",
    "this article describes in detail the implementation of this method within full - potential codes .",
    "there are three major issues that arise in dft+dmft implementations : i ) quality of the basis set , ii ) quality of the impurity solvers , and iii ) choice of correlated orbitals onto which the full green s function is projected .",
    "modern dft implementations largely resolve the first issue , recent development of new impurity solvers  @xcite have focused attention on the second , while the third is rarely discussed in the literature .",
    "many dft+dmft proposals in the literature are based on downfolding to low energy model hamiltonians  @xcite , which requires an atomic set of orbitals and treats the kinetic operator on the level of an effective tight binding model .",
    "in contrast , we avoid the ambiguities of downfolding and instead keep the kinetic part of the hamiltonian and electronic charge expressed in a highly accurate full potential basis set .",
    "the advantage of our method is its ability to perform fully self - consistent electronic charge calculations .",
    "we concentrate here on the linear augmented plane wave basis ( lapw )  @xcite as implemented in the wien2k code @xcite and the lmto basis as implemented in lmtart  @xcite , in combination with the impurity solvers based on the hybridization expansion @xcite .",
    "the first half of the article introduces the basic steps of implementing the dft+dmft algorithm and provides a pedagogical introduction to the method .",
    "section [ basis_set ] is devoted to a crucial element of the dft+dmft formalism , namely the projection of the full electronic green s function to the correlated subset .",
    "we show that the projection used in the lda+u method leads to non - causal dft+dmft equations , while the projection on to the solution of the schrdinger equation within the muffin - tin ( mt ) spheres misses electronic spectral weight .",
    "we propose a new projection that leads to causal dmft equations and captures all electronic spectral weight .",
    "section [ sfunctional ] derives the dft+dmft equations from a baym - kadanoff - like functional formalism .",
    "section [ algorithm ] provides a detailed flowchart of all the steps of the algorithm . in section [ complex - tetrahedra",
    "] we discuss the necessary changes to the tetrahedron method when used in the context of dmft .",
    "section [ transport ] described the algorithm to compute transport properties within dft+dmft .",
    "section [ impurity - solvers ] describes the impurity solvers based on the hybridization expansion , the one crossing approximation ( oca ) , and the _ bold _ continuous time quantum monte carlo algorithm ( @xmath3-ctqmc ) .",
    "finally , section [ ancont ] discusses a new algorithm for analytic continuation of the self - energy from the imaginary to real axis .    in the second half of the article",
    ", we describe the results obtained by applying our new implementation of dft+dmft to several correlated materials . as a first test of the algorithm , in section [ ce - test ] we present its application to elemental cerium .",
    "section [ 115 ] is devoted to a class of heavy fermion materials , cerhin@xmath0 , cecoin@xmath0 and ceirin@xmath0 , dubbed ce-155 materials .",
    "we show the difference in the electronic structure among these three materials and demonstrate that the ce @xmath1 electrons are most localized in cerhin@xmath0 and order antiferromagnetically below @xmath4k , in agreement with experiment , while the ce @xmath1 electrons are most itinerant in ceirin5 .",
    "we explain the origin of the subtle difference between the three ce-115 compounds from the electronic structure point of view .",
    "dft+dmft contains some aspects of band theory , adding a `` frequency - dependent local potential '' to the kohn - sham hamiltonian .",
    "it also contains some aspects of quantum chemistry , carrying out an exact local configuration interaction procedure by summing all local diagrams , which requires the definition of an `` atomic - like '' or `` local '' green s function .",
    "the operation of extracting the local green s function @xmath5 from the full green s function @xmath6 is called projection ( or truncation ) . the reverse operation of expressing the local time - dependent potential @xmath7 , derived from the solution of the atomic problem in the presence of a mean - field environment , is called embedding .",
    "the various dft+dmft implementations differ not only in the choice of basis set , but also in the choice of the projection - embedding step .",
    "these ingredients are sketched schematically in fig .",
    "[ sketch0 ] .",
    "the projection - embedding step connects the atomic and solid state physics , and its proper definition is a conceptual issue of dft+dmft method .    in the current formulation of dft+dmft@xcite",
    ", one must define the correlated orbitals to which the coulomb correlation is applied , i.e. , @xmath8 , where @xmath9 is a localized orbital .",
    "usually , this is achieved by transforming the dft hamiltonian to a set of localized wannier orbitals .",
    "these wannier orbitals are then identified as the local correlated orbitals of dmft .",
    "various choices of these orbitals were proposed in the literature , including tight - binding lmto s @xcite , non - orthogonal lmto s @xcite , nth - order muffin - tin orbitals @xcite , numerically - orthogonalized lmto s @xcite , and maximally - localized wannier orbitals @xcite .",
    "the basis functions must fully respect the symmetries of the problem and be atom - centered , rather than bond - centered .",
    "hence maximally - localized wannier functions  @xcite are not a good starting point for dmft .",
    "localized basis sets are a better starting point for our purposes , but the non - orthogonality of these sets pose a serious challenge .",
    "straighforward orthogonalization mixes the character of the orbitals , resulting in mixed the partial occupancies and partial density of states , leading to incorrect partial electron counts .",
    "for example , within modern dft implementations , cerium metal has approximately one @xmath1 electron .",
    "nave orthogonalization results in a considerably higher @xmath1 electron count , leading to an unphysical dmft solution .",
    "even more challenging is the formulation of the good localized orbitals in full - potential basis sets . here",
    ", multiple basis functions are used to obtain more variational freedom . to implement dmft in such basis sets ,",
    "the group of orbitals representing the correlated electrons in the solid must be contracted to form a single set of atomic - like heavy orbitals , i.e. , one @xmath1 orbital per ce atom , one @xmath10 orbital per fe atom , etc .    a straighforward projection on to the orbital angular momentum eigenfunctions @xmath11 leads to non - causal dmft equations , which result in an unphysical auxiliary impurity problem .",
    "the second often - employed choice is the projection on to the solution of the schrdinger ( dirac ) equation inside the mt sphere @xmath12 .",
    "while this choice is certainly superior to the straighforward projection , it does not take into account the contributions due to the energy derivative of the radial wave function @xmath13 and the localized orbitals ( lo ) at other energies @xmath14 , and hence misses some electronic spectral weight of the correlated orbital .",
    "alternative choices are possible which simultaneously capture all spectral weight and obey causality .",
    "we implemented one of them and we believe it is superior to other choices in the literature .",
    "the central objects of dmft are the local green s function and the local self - energy of the orbitals within the correlated subset .",
    "we specify the projection scheme by the projection operator @xmath15 , which defines the mapping between real - space objects and their orbital counterparts @xmath16 ( see fig .",
    "[ sketch0 ] ) .",
    "the operator @xmath17 acts on the full green s function @xmath6 and gives the correlated green s function @xmath18  @xcite @xmath19 the integrals over @xmath20 and @xmath21 are performed inside the sphere of size @xmath22 around the correlated atom at position @xmath23 .",
    "the subscript @xmath24 can index spherical harmonics @xmath25 , cubic harmonics , or relativistic harmonics @xmath26 , depending on the system symmetry .",
    "we always choose the basis which minimizes the off - diagonal elements of the correlated green s function in order to reduce the minus - sign problem in monte - carlo impurity solvers . in general , @xmath17 is a multidimensional tensor with one pair of indices in the space of local correlated orbitals @xmath27 and the other pair in the space of the full basis set , which can be expressed in a real space @xmath28 or kohn - sham @xmath29 basis , where @xmath30 and @xmath31 are band indices .    the inverse process of embedding @xmath32 , i.e. the mapping between the correlated orbitals and real - space @xmath33 , is defined by the same four - index tensor",
    "however , instead of integrals over real - space , its application is through a discrete sum over the local degrees of freedom , @xmath34 here @xmath35 means to only sum over correlated orbitals . in actinides ,",
    "the sum would run over @xmath36 orbitals , in lanthanides over @xmath1 and in transition metals over @xmath10 orbitals .",
    "@xmath23 runs over all atoms in the solid and @xmath20 over the full space .",
    "note that within the correlated hilbert subspace , the embedding and projection should give unity @xmath37 , i.e. , @xmath38 while the projection from the full hilbert space to the correlated set , followed by embedding , gives the correlated local green s function in real space @xmath39 @xmath40 which is the central object of the functional definition of the dmft described below .",
    "in general , the two operators @xmath17 and @xmath32 could be different , but they must satisfy the condition eq .",
    "( [ ppunity ] ) .",
    "the two simplest projections , namely , the projection on to the orbital angular momentum functions @xmath41 , and the projection on to the solution of the schrdinger equation , can be explicitly written as @xmath42 where @xmath43 is the vector defined with the origin placed at the atomic position @xmath44 , and @xmath45 is the solution of the radial schrdinger equation for angular momentum @xmath46 at a fixed energy @xmath47 .    in the following , we will show that the projection @xmath48 , used in some implementations of dmft @xcite , captures the full spectral weight of the correlated character @xmath24 , but leads to non - causal dmft equations",
    ". on the other hand @xmath49 gives causal dmft equations , but misses some spectral weight .",
    "in our view , a good dft+dmft implementation should satisfy the following conditions    * _ correct correlated spectral weight _ : the projected density of states , computed from the projected green s function , @xmath50,\\ ] ] should capture the partial electronic weight inside a given mt sphere at all frequencies , i.e. , @xmath51 .",
    "in particular , @xmath52 must include the electronic weight contained in @xmath53 and local orbitals .",
    "projection should not include any weigh of other character , nor miss correlated weight . *",
    "_ dmft equations are causal _ : for any causal self - energy @xmath54 , the dmft self - consistency condition @xmath55 \\label{causal1}\\end{gathered}\\ ] ] should give a causal hybridization function @xmath56 .",
    "here we used projections @xmath57 in momentum space as opposed to their real - space definitions in eqs .",
    "( [ gll1 ] ) and ( [ pp00 ] ) , ( [ pp01 ] ) . *",
    "_ sufficient accuracy of the hybridization function _ : the hybridization function is usually very sensitive to the choice of the projector .",
    "therefore , we require that in the relevant low energy region , the hybridization function is similar to its dft counterpart .",
    "explicitly , @xmath58 must be sufficiently close to its dft estimate , @xmath59 .",
    "here @xmath60 stands for the full green s function @xmath6 when @xmath61 .",
    "the choice of @xmath61 is dictated by the fact that the hybridization @xmath62 , computed by @xmath48 is not well behaved for @xmath63 , as we will show below .",
    "the motivation for using p0 in the above equation is that we want to project the full hilbert space to a correlated subset with pure angular momentum , either _",
    "f _ or _ d _ , but not to a mixure of characters . * _ good representation of kinetic energy and electronic density _ : finally , it is crucial to faithfully represent the kinetic energy operator @xmath64 and electronic density in real space , a feat most modern dft implementations achieve .",
    "the dft+dmft implementation should not reduce the precision already achieved in dft underlying code .    downfolding to only a few low energy bands",
    "clearly violates the condition number ( 3 ) , since the hybridization outside the downfolded window vanishes .",
    "a more severe problem is that downfolding approximates the kinetic energy operator by expressing it in a small atomic - like basis set , hence condition ( 4 ) is violated .",
    "therefore , we will focus our discussion on dft+dmft implemented within full - potential basis sets where all bands are kept at each stage of the calculation .",
    "downfolding to a sufficiently large energy window may sometimes be helpful due to its conceptual simplicity , but this approach can not compute the electronic charge self - consistently , as is possible in our implementation .",
    "moreover , the localized orbitals chosen in the downfolding procedure combined with the limited number of hoppings retained often can not faithfully represent the original kohn - sham bands .    to be more concrete",
    ", we will give the proofs of the _ `` weight loss problem '' _ and _ `` causality problem '' _ within the full - potential lapw basis .",
    "the equivalent derivation is possible for the full - potential lmto basis . inside the mt spheres ,",
    "the full - potential lapw basis functions can be written  @xcite @xmath65 where @xmath66 corresponds to the solution of the schrdinger equation @xmath67 at a fixed energy @xmath47 , @xmath68 to the energy derivative of the same solution @xmath69 , and @xmath70 to a localized orbitals at additional linearization energies @xmath71 . here",
    "@xmath23 runs over the atoms in the unit cell .",
    "the kohn - sham states @xmath72 are superpositions of the basis functions @xmath73 and take the following form inside the mt spheres : @xmath74 where @xmath75 , or equivalently , @xmath76 .    the projectors ( [ pp00 ] ) and ( [ pp01 ] ) can be expressed in the kohn - sham basis : @xmath77 hence , projector @xmath48 takes the form @xmath78 using projector @xmath48 , we get the following expression for the partial density of states @xmath79 which exactly coincides with the dft partial dos .",
    "hence @xmath48 satisfies the condition number ( 1 ) .",
    "however , it does not lead to causal dmft equations .    to show that , consider the limit of a diverging self - energy , @xmath80 , as is relevant for the mott insulators . despite the diverging @xmath54 , the projection must still produce a finite hybridization . in the case",
    "when all the bands at the energy of the pole are correlated , the hybridization should vanish . in this limit , the dmft self - consistency condition ( [ causal1 ] ) takes the form @xmath81^{-1}_{ij } \\label{causal1}\\end{aligned}\\ ] ] where @xmath82 stands for the two band indices constituting a matrix in @xmath83 to be inverted .",
    "since @xmath62 is finite while @xmath54 diverges , we neglect @xmath62 to obtain the condition for causal projection , @xmath84^{-1}_{ij}. \\label{causal2}\\end{aligned}\\ ] ] this equation must be satisfied for any matrix form of the self - energy @xmath54 .",
    "moreover , it has to be satisfied for each @xmath24 and @xmath85 .",
    "we will show below that eq .",
    "( [ causal2 ] ) is satisfied for a separable projection ( see eq .",
    "[ separable ] for a definition ) , while for a non - separable projection , it likely is not .",
    "one can check explicitely that @xmath48 violates the condition eq .",
    "( [ causal2 ] ) . only after applying an additional trace over @xmath86",
    "will the two matrices @xmath87 cancel .",
    "however , for any given choice of @xmath86 , @xmath48 does not satisfy the causality condition . instead a pole in the self - energy results in a diverging @xmath62 , with the imaginary part having the wrong sign . the projection @xmath48 is implemented in the _ qtl _ package @xcite of wien2k@xcite .",
    "the lda+u implementation within wien2k  @xcite also uses @xmath48 , but this does not cause any causality issues since the problem is unique to dft+dmft . additionally , simple impurity solvers such as hubbard - i ( ref .  ) do not incorporate a true hybridization so they also avoid issues with causality .    finally , let us mention an attractive feature of @xmath48 . within this scheme ,",
    "the self - energy is independent of the radial distance from the atom @xmath88 , having only angular dependence in the form @xmath89 .",
    "this matches the conceptual fact that the impurity solver within the dmft framework can not determine the radial dependence of the self - energy .",
    "the impurity solver can only be used to obtain the angular dependence of @xmath54 by determining the expansion coefficeints @xmath90 . in the absence of any knowledge of the radial dependence of @xmath54 ,",
    "the natural choice is a constant function , independent of radius @xmath88 .",
    "since @xmath91 is a function of two vectors , a radial delta function would be an obvious choice .",
    "however , issues with causality preclude the use of this projection .    the second projection @xmath49 of eq .",
    "( [ pp01 ] ) takes the following form in the kohn - sham basis : @xmath92 the partial density of states computed from the correlated green s function using @xmath49 is @xmath93 comparing eq .",
    "( [ dos1 ] ) with ( [ dos0 ] ) , we notice that @xmath94 is replaced by @xmath95 , which leads to incorrect spectral weight . in particular , for @xmath68 , the original overlap in eq .",
    "( [ dos0 ] ) is @xmath96 , while the overlap obtained by @xmath49 , vanishes .",
    "causality is not violated for any projection @xmath97 , which is separable , i.e. , can be cast into the form @xmath98 the condition eq .",
    "( [ causal2 ] ) can then be expressed as @xmath99 which is clearly satisfied when @xmath100 is invertible matrix because @xmath101 .",
    "this is satisfied when the kohn - sham hilbert space is of larger dimension than the correlated hilbert space .",
    "the projection @xmath49 leads to causal dmft equations , and therefore is a better choice than @xmath48 .",
    "however , some spectral weight is lost at energies away from the linearization energy @xmath47 . to this end",
    ", we also implemented an alternative projection within wien2k package @xcite , which preserves both causality and spectral weight .",
    "this projector is given by    @xmath102    here index @xmath24 runs over the local basis in which the green s function is minimally off - diagonal ( cubic harmonics or relativistic harmonics ) .",
    "the projector is separable , as postulated in eq .",
    "( [ separable ] ) , and the transformation @xmath103 is @xmath104 with @xmath105 hence the dmft equations are causal . moreover , @xmath106 is identical to @xmath107 and hence the partial density of states @xmath108 , obtained by @xmath109 , is identical to eq .",
    "( [ dos0 ] ) .",
    "hence the projection correctly captures the partial spectral weight .",
    "knowledgeable reader would notice that the projection is slightly non - local because @xmath110 is weakly momentum dependent . at energies",
    "where @xmath111 or local orbital substantially contribute to the spectral weight ( away from the fermi level ) , we give up locality in expense of correctly capturing the spectral weight .",
    "all projection schemes lead to slightly non - orthonormal correlated green s function .",
    "this is because the interstitial weight is not taken into account and because the full potential basis is overcomplete . to have an orthonormal impurity problem",
    ", we compute the overlap @xmath112 and renormalize @xmath113 .",
    "finally , we remark that the segment of our code which builds projections @xmath48 , @xmath49 and @xmath109 within wien2k  @xcite is based on the _ qtl _ package of pavel novak  @xcite .",
    "similar projections within lda+dmft method were proposed before .",
    "in particular the method by b. amadon et.al .",
    "@xcite proposed to construct the wannier functions for the correlated subset only , while the dmft equations were solved in the kohn - sham basis , restricted to some subset of low energy bands .",
    "the local orbitals used for the projection were either all - electron atomic partial waves in the paw framework , or pseudo - atomic wave functions in mixed - basis pseudopotential code . hence ,",
    "in the language of projectors , the method was similar to choosing the projector to be @xmath114 , where @xmath115 is the the partial waves or pseudo - atomic wave function .",
    "while this method is clearly causal , it looses spectral weight of the correlated angular momentum character .",
    "moreover , the implementation of the method did not allow the self - consistent evaluation of the electronic charge .",
    "the method of anisimov _ et.al .",
    "_  @xcite also proposed a construction of the wannier functions using an arbitrary set of localized orbitals . in their work ,",
    "the lda hamiltonian was truncated to wannier representation for the purpose of obtaining the dmft self - energy .",
    "this simplifies the self - consistent dmft problem , but makes it impossible to implement the charge self - consistency .",
    "finally , savrasov et.al .",
    "@xcite proposed a projector particular to lmto basis set , for which causality was not proven .",
    "to derive the dft+dmft equations , we define a functional of the correlated green s function @xmath5 and extremise it . the correlated green s function @xmath5 is defined by eq .",
    "( [ corrg ] ) , and the functional to be extremise is @xmath116 = -{\\mathrm{tr}}\\ln(g^{-1 } ) - { \\mathrm{tr}}[\\sigma^{tot } g ] + \\phi[{{\\cal g}},\\rho ] , \\label{functional}\\ ] ] where @xmath117 runs over all space ( orbitals , momenta ) and time ( frequency ) .",
    "the quantities apprearing in the above functional are    @xmath118\\delta({{\\mathbf{r}}}-{{\\mathbf{r}}}')-\\sigma^{tot}_\\omega({{\\mathbf{r}}},{{\\mathbf{r } } } ' )    \\label{g1}\\\\ & & \\sigma^{tot}_\\omega({{\\mathbf{r}}},{{\\mathbf{r } } } ' ) =    \\left[v_h({{\\mathbf{r}}})+v_{xc}({{\\mathbf{r}}})\\right]\\delta({{\\mathbf{r}}}-{{\\mathbf{r } } } ' ) +    \\left[\\sigma_\\omega({{\\mathbf{r}}},{{\\mathbf{r}}}')-e_{dc}\\delta({{\\mathbf{r}}}-{{\\mathbf{r}}}')\\right]\\theta(r < s )    \\label{s1}\\\\ & & \\phi[{{\\cal g}},\\rho ] = \\phi_h[\\rho ] + \\phi_{xc}[\\rho ] + \\phi_{dmft}[{{\\cal g } } ] - \\phi_{dc}[{{\\cal g } } ]    \\label{p1x}\\\\ & &   \\rho = \\widetilde{{\\mathrm{tr}}}[g ] \\nonumber\\end{aligned}\\ ] ]    where @xmath119 is trace over time only ( not space ) , @xmath120 is the potentials due to ions , @xmath121 are the hartree , and exchange - correlation potential , respectively . @xmath122 $ ] is the sum of all local two particle irreducible skeleton diagrams constructed from @xmath123 , and the coulomb repulsion @xmath124 ( screened by orbitals not contained in @xmath123 ) , and @xmath125 is the double counting functional .",
    "we assume that the coulomb interaction @xmath124 has the same form as in the atom , i.e. ,    @xmath126    however , the slater integrals are reduced due to screening effects . typically , we renormalize @xmath127 by 30% , from their atomic values , while @xmath128 , being renormalized more , can be estimate by constraint lda or constraint rpa @xcite .    to extremize the functional eq .",
    "( [ functional ] ) , we take @xmath123 and @xmath129 as independent variables , and use the following functional dependence : @xmath130 $ ] , @xmath122 $ ] , @xmath131 $ ] , @xmath132 $ ] are functionals of @xmath123 .",
    "consequently , @xmath133 is also a functional of @xmath123 , i.e. , @xmath134 $ ] . on the other hand ,",
    "@xmath135 $ ] , @xmath136 $ ] , @xmath137 $ ] , @xmath138 $ ] are functionals of the total electron density , hence @xmath133 is also a functional of @xmath129 since @xmath139+v_{xc}[\\rho]]$ ] .",
    "finally it is easy to check that @xmath140={\\mathrm{tr}}[(v_{h}+v_{xc})\\rho]+{\\mathrm{tr}}[(\\sigma - e_{dc}){{\\cal g}}].\\ ] ] with the above functional dependence in mind , minimization with respect to @xmath123 gives @xmath141}{\\delta{{\\cal g } } } -\\frac{\\delta\\phi_{dc}[{{\\cal g}}]}{\\delta{{\\cal g}}},\\ ] ] and minimization with respect to @xmath129 leads to @xmath142}{\\delta\\rho}+\\frac{\\delta\\phi_{xc}[\\rho]}{\\delta\\rho}.\\ ] ] hence the hartree and exchange - correlation potential are computed in the same way as in dft method ( note however @xmath129 is electron density in the presence of dmft self - energy ) , while the dmft self - energy is the sum of all local feynman diagrams , constructed from @xmath123 and coulomb interaction @xmath124 . to sum up all local diagrams , constructed from @xmath123 and screened coulomb interaction @xmath124 , we solve an auxiliary quantum impurity problem , which has @xmath143 as the impurity green s function , and @xmath54 as the impurity self - energy @xmath144 .",
    "the impurity green s function is @xmath145 , hence the dmft self - consistency condition reads @xmath146 where @xmath147 , and @xmath148 is the interaction included in dft ( double counting ) .",
    "the self - consistency condition takes the explicit form    @xmath149\\delta({{\\mathbf{r}}}-{{\\mathbf{r } } } ' )",
    "- \\sum_{l_1 l_2\\in h }    p({{\\mathbf{r}}}'{{\\mathbf{r}}},\\tau l_1l_2 )    \\overline{\\sigma}^{\\tau}_{l_2   l_1 }    \\right\\}^{-1 }    \\nonumber \\\\ = \\left[\\left(i\\omega - e^{\\tau}_{imp}-\\sigma^{\\tau}-\\delta^{\\tau}\\right)^{-1}\\right]_{ll ' } \\label{scc}\\end{aligned}\\ ] ]    where @xmath150 and @xmath22 is the muffin - tin radius .    for efficient evaluation of the dmft self - consistency condition",
    "( [ scc ] ) , we choose to work in the kohn - sham ( ks ) basis . at each dft+dmft iteration",
    ", we first solve the ks - eigenvalue problem @xmath151\\psi_{{{\\mathbf{k}}}i}({{\\mathbf{r } } } ) = \\epsilon_{{{\\mathbf{k}}}i}\\psi_{{{\\mathbf{k}}}i}.\\ ] ] then we express the projection @xmath17 in ks basis , @xmath152 , where @xmath153 run over all bands .",
    "we then perform the embedding of the self - energy , i.e. , transforming it from dmft base to the ks base @xmath154 in ks - base , we can invert the green s function eq .  ( [ scc ] ) , to obtain the practical form of the self - consistency condition @xmath155_{ji } \\label{gdef}\\\\ { { \\cal g}}^{\\tau}_{ll'}&=&\\left[\\frac{1}{i\\omega - e^{\\tau}_{imp}-\\sigma^{\\tau}(\\omega)-\\delta^{\\tau}(\\omega)}\\right]_{ll ' } \\label{sccdef}\\end{aligned}\\ ] ]",
    "this is of course equivalent to eq .",
    "( [ scc ] ) .",
    "finally we solve this self - consistency equation for a given self - energy @xmath7 to obtain the hybridization function @xmath156 and the impurity levels @xmath157 .",
    "we note in passing that the self - energy @xmath7 is a complex function , and its imaginary part is related to the electron - electron scattering rate , which is very large in correlated materials . in mott insulators",
    ", it is even diverging .",
    "hence the dmft `` effective hamiltonian '' @xmath158 can not be diagonalized by standard methods to obatin a set of eigenvalues , i.e. , bands .",
    "the eigenvalues are complex and hence only the spectral weight @xmath159 is a well defined quantity .",
    "the absence of well defined bands in correlated materials makes computational techniques more challenging .",
    "for example , the calculation of the chemical potential is far more demanding because one can not assign a unity of charge to each fully occupied band .",
    "rather all complex eigenvalues , even those which are far from the fermi level , need to be carefully considered .",
    "this point will be addressed below in section  [ algorithm ] , item 5 .",
    "further , the tetrahedron method @xcite , a very useful technique to reduce the number of necessary momentum points in practical calculation , is not applicable since it needs real eigenvalues .",
    "we address the necessary generalization of this method is chapter  [ complex - tetrahedra ] .    note that generalization of the projector and the lda+dmft formalism to cluster - dmft is very straightforward .",
    "one needs to increase the unit cell to include more sites of the same atom type .",
    "the self - energy and the green s function become matrices in index @xmath23 , i.e. , @xmath160 , @xmath161 .",
    "the transformation @xmath17 is also straightforwardly generalized to matrix form @xmath162 .",
    "the only difference in the definition of the projector eq .",
    "( [ p2p ] ) is that @xmath163 is replaced by @xmath164 ( @xmath165 remains unchanged ) , which amounts to the integral over two different spheres around two atoms of the same type . finally , in cluster - dmft case , the self - energy in ks - basis eq .",
    "( [ sigdef ] ) has to be summed over both @xmath23 and @xmath166 , and self - consistency condition eq .",
    "( [ sccdef ] ) becomes a matrix equation in @xmath167 .",
    "the challenging part of the cluster - dmft formalism is in solving the cluster - impurity problem . in combination with impurity solvers based on",
    "the hybridization expansion ( discussed below ) the computational effort grows exponentially with the number of correlated sites . in the weak coupling impurity solvers",
    ", the computational effort grows as a power - law , however , these techniques usually can not reach the interesting regime of strong correlations and low temperatures .",
    "the major bottleneck in evaluating the dmft self - consistency condition in our method is the multiplication of the projector @xmath168 with @xmath54 in eq .",
    "( [ sigdef ] ) and multiplication of projection with green s function @xmath169 in eq .",
    "( [ gdef ] ) .",
    "since projection @xmath109 is separable , one can write the operation in terms of matrix products . still , these sums run over all @xmath170-points ( typically few thousands ) and all frequency points ( typically few hundreds ) .    for the efficient implementation of the set of eqs .",
    "( [ sigdef ] ) and ( [ gdef ] ) , we first notice that the transformation @xmath97 ( or its separable part @xmath103 ) is very large and is not desirable to be written to the computer hard disc .",
    "hence we generate it only for one @xmath170-point at a time , and evaluate both products at this particular @xmath170-point .",
    "non - negligible amount of time is necessary to generate the transformation eq .",
    "( [ p2p ] ) , and because this transformation does not depend on frequency , it needs to be used for all frequencies in eqs .",
    "( [ sigdef ] ) and ( [ gdef ] ) .",
    "hence paralization over frequency is not implemented , while paralization over @xmath170-points is .",
    "note that because of the sum over atoms ( @xmath23 ) in eq .",
    "( [ sigdef ] ) , the transformation for all atoms needs to be computed first , and only then the sum in eq .",
    "( [ sigdef ] ) can be evaluated and the self - consistency condition eq .",
    "( [ sccdef ] ) can be inverted .    to optimize the sum in eqs .",
    "( [ sigdef ] ) and ( [ gdef ] ) , one can notice that local quantities like self - energy and local green s function possess a large degree of symmetry when written in proper basis ( real harmonics , relativistic harmonics ) : many off - diagonal matrix elements vanish , and many matrix elements are equivalent .",
    "for example , in a @xmath171 system with cubic symmetry , one has only two types of self - energy @xmath172 and @xmath173 .",
    "hence , instead of summing over @xmath174 matrix elements in eq .",
    "( [ sigdef ] ) , one can rewrite the sum over two matrix elements @xmath175 , i.e. , @xmath176 where @xmath177 and the indices @xmath178 here stand for the real harmonics rather than spheric harmonics .",
    "the later transformation is independent of frequency , while the sum eq .",
    "( [ sigdef_optimize ] ) needs to be performed for all frequencies , hence the compact form of the transformation saves a lot of computer time .",
    "the implementation of the dft+dmft algorithm is done in the following few steps :    * @xmath179 : we converge the lda / gga equations to get the starting electronic charge @xmath179 .",
    "we use the non - spin polarized solution as starting point . in the ordered state ,",
    "the dmft self - energy is allowed to break the symmetry , while typically the exchange - correlation potential is not allowed to break the symmetry ( lda rather than lsda ) .",
    "+ in this preparation step we also obtain good estimates for the coulomb repulsion @xmath103 ( which is represented by slater integrals @xmath128 , @xmath180 , @xmath181 and @xmath182 ) .",
    "slater integrals are computed by the atomic physics program of ref .  , and they are scaled down by 30% to account for the screening in the solid .",
    "the @xmath128 terms is very different from the atomic @xmath128 and is obtained by constraint lda calculation , or constraint rpa calculation @xcite .",
    "* @xmath183 : we solve the dft ks - eigenvalue problem @xmath184 to obtaine ks eigenvectors , core , and semicore charge , and linearization energies @xmath185 . *",
    "@xmath186 we start with a guess for the lattice self - energy correction @xmath187 ( here @xmath188 is the dynamic part of the self - energy with the property @xmath189 ) .",
    "a reasonable starting point is @xmath190 and @xmath191 .",
    "the potential in the first dmft iteration is thus the dft potential .",
    "* @xmath192 : next we embed the dmft self - energy @xmath193 ( shifted by double counting ) to kohn - sham base by the transformation eq .",
    "( [ sigdef ] ) to obtain @xmath194 . *",
    "@xmath195 : using the current dmft self - energy @xmath196 , and the current dft ks - potential @xmath197 , we compute the current chemical potential .",
    "this is done in the followin steps : * * complex eigenvalues @xmath198 of the full green s function are found in the large enough energy interval ( at least [ @xmath199,@xmath200 ) by solving @xmath201c_{jl}^{{\\mathbf{k}}}(\\omega)=c^{{\\mathbf{k}}}_{il}(\\omega)\\varepsilon_{{{\\mathbf{k}}}l}(\\omega).\\ ] ] here @xmath202 are dmft eigenvectors expressed in ks base .",
    "the dmft eigenvalues outside this interval are set to dft eigenvalues .",
    "we need only eigenvalues in this step , but not eigenvectors . *",
    "* the chemical potential is determined using precomputed complex and frequency dependent eigenvalues @xmath203 . on imaginary axis",
    "we solve @xmath204 and on real axis we solve @xmath205 if enough @xmath170-points can be afforded , we use special point method , otherwise the `` complex tetrahedron method '' can be used ( see chapter  [ complex - tetrahedra ] ) . + for numerical evaluation of the real axis density , we discretize the integral @xmath206 with @xmath207 and @xmath208 .",
    "when using the special point method , the integral over frequency is evaluated analytically , and the terms of the form @xmath209 are summed up .",
    "alteratively , we sometimes use the complex tetrahedron method , where the four - dimensional integral is evaluated analytically ( see chapter  [ complex - tetrahedra ] ) + when dmft is done on imaginary axis ( using imaginary time impurity solvers ) , we evaluate @xmath210\\nonumber\\\\       & & -\\frac{1}{\\pi}\\arctan\\left(\\frac{\\varepsilon_{{{\\mathbf{k}}}l}^{\\infty}-\\mu}{\\omega_n}\\right)+       \\frac{1}{\\pi}\\arctan\\left(\\frac{\\varepsilon_{{{\\mathbf{k}}}l}^0-\\mu}{\\omega_n}\\right )      \\end{aligned}\\ ] ] here @xmath211 is the real part of the eigenvalue at arbitrary frequency .",
    "we choose the lowest or the last mastubara point .",
    "again , the tetrahedron method can be used for momentum sum .",
    "+ for mott insulators , the above described method is not very efficient , because even a small numerical error in computing @xmath212 places chemical potential at the edge of the hubbard band , either upper or lower .",
    "this instability usually does not allow one to reach a stable self - consistent solution .",
    "we devised the following method to remove this instability : * * the diagonal components of the self - energy were fitted by a pole - like expression @xmath213 . *",
    "* next , we neglected broadening of the pole ( @xmath214 ) , which should be small in the mott insulating state .",
    "we computed a quasiparticle approximation for the green s function @xmath215 , i.e. , @xmath216 where @xmath217 is part of the projector @xmath218 defined above . *",
    "* the above green s function formulae can be cast into a block form @xmath219^{-1}\\equiv \\left(i\\omega - h_{{{\\mathbf{k}}}}^{qp}\\right).\\ ] ] here @xmath220 is the quasiparticle hamiltonian which can be diagonalized to obtain the quasiparticle bands .",
    "we notice that the number of quasiparticle bands of the mott insulator is larger then the number of kohn - sham bands because mott insulators have at least two hubbard bands .",
    "the quasiparticle bands are not very accurate away from the fermi level , however they are sufficiently acurate at low energy and allow one to identify gaps at the fermi level .",
    "once a gap in the spectra of @xmath220 is identified , the charge is computed using the full dmft density matrix to verify the neutrality of the solid .",
    "if the solid is neutral when chemical potential is in the gap , the chemical potential is set to the middle of the gap .",
    "* @xmath62 : impurity hybridization function @xmath56 and impurity levels @xmath221 are computed in this step .",
    "+ we use equation ( [ gdef ] ) to get @xmath222 and we use the high frequency expansion of both equations ( [ gdef ] ) and ( [ sccdef ] ) to determin impurity levels @xmath223 * @xmath224 : impurity solver uses @xmath225 , @xmath221 , and coulomb repulsion @xmath103 ( which is represented by slater integrals @xmath128 , @xmath180 , @xmath181 and @xmath182 ) as the input and gives the new self - energy @xmath226 as the output .",
    "+ currently we integrated the following impurity solvers : oca ( see chapter [ oca ] ) , non - crossing approximation ( nca ) , continuous time quantum monte carlo ( ctqmc )  @xcite .",
    "the latter is implemented on imaginary axis , and the former two on real axis .",
    "+ before the impurity solver is run , we exactly diagonalize the atomic problem in the presence of crystal fields , to obtain all atomic energies @xmath227 and the matrix elements of electron creation operator in the atomic basis @xmath228 .",
    "since the impurity levels can change during the iteration , the crystal field of the atomic problem can change as well . in case of @xmath229-systems , the crystal field splittings",
    "are small and one can assume that they do not change substantially from their dft value .",
    "hence the exact diagonalization can be done only once at the beginning . for the @xmath171-systems ,",
    "the crystal field splittings are larger , and this approximation is in general not necessary satisfactory , hence the exact diagonalization needs to be repeated in the charge self - consistent cycle .",
    "a special care needs to be taken here when using ctqmc . to speed up the convergence of ctqmc solver",
    ", we typically start simulation with the status of the kink distribution from previous dmft step .",
    "since exact diagonalization can reorder eigenstates , these kinks need to be properly renumbered , to efficiently restart simulation . *",
    "@xmath230 : it is very hard to achieve reasonably precise self - energy at high frequency with impurity solvers based on hybridization expansion .",
    "however , to correctly compute electronic charge , it is crucial that the self - energy at high frequency approaches its hartree - fock value and the impurity green s function and self - energy at large frequency properly behave",
    ". hence we correct @xmath231 at each iteration .",
    "this is quite straighforward , given the fact that impurity solvers determine the impurity density very precisely .",
    "this steps only corrects the high energy tails of the impurity green s function and impurity self - energy , while we make sure that the low energy part , which is computed very precisely by these methods , is not altered .",
    "+ in the case of ctqmc solver , we compute the atomic green s function using ctqmc probabilities for each atomic state ( see ref .   for details ) .",
    "the high - frequency tails of the self - energy can then be computed .",
    "these analytic tails are then used instead of noisy qmc data .",
    "+ in oca and nca impurity solvers , we project out very high excited atomic states .",
    "this has negligible effect on the low energy physics , however , it results in a missing weight at high frequency , and hence wrong self - energy at infinity . to correct for this deficiency ,",
    "we add two lorentzians to the impurity green s function @xmath232 typically with @xmath233 and @xmath234 . here",
    "we omitted the subscript @xmath235 for the impurity green s function @xmath52 for clarity .",
    "the parameters @xmath236 are determined by the following constraints : * * _ normalization _ :",
    "@xmath237 , where @xmath238 is the integral of @xmath239 . * * _ density _ : @xmath240 , where @xmath241 and @xmath242 is the impurity density determined by the impurity solver in an alternative , more precise way ( from pseudo - particle density ) . *",
    "* @xmath231 : @xmath243 , where @xmath244 is the first moment @xmath245 . +",
    "once the following three constrains are satisfied , the self - energy at high frequency approaches its hartree - fock value , and the spectral function respects the total impurity density .",
    "* @xmath246 : using the new impurity self - energy , we determine the new lattice self - energy @xmath247 , where @xmath248 , with @xmath249 the correlated nominal occupancy . * _ goto 4 _ : if the convergence of charge is hard to achieve , we iterate the dmft loop a few times .",
    "we call this loop the dmft loop .",
    "if the dmft loop is to be iterated , jump to 4 . *",
    "@xmath250 : the eigevalue problem is solved for all momentum and frequency points , @xmath201c^{\\omega , r}_{{{\\mathbf{k}}}jl}=c^{\\omega , r}_{{{\\mathbf{k}}}il}\\varepsilon_{{{\\mathbf{k}}}l\\omega}.\\ ] ] here we evaluate both , eigenvalues and eigenvectors . since this is a non - hermitian eigenvalue problem , the left and right eigenvectors are not complex conjugates of each other .",
    "we use notation @xmath251 for the right and @xmath252 for the left eigenvector .",
    "+ using the dmft eigenvalues , we recompute the chemical potential as in 5 .",
    "+ we then recompute the electronic charge from the dmft eigenvectors @xmath253 where @xmath254 are kohn - sham eigenvectors ( solutions of the lda eigenvalue problem ) .",
    "the electronic valence charge on real axis is @xmath255 and on imaginary axis is @xmath256 + we compute the electronic charge using similar technique as used above to compute the chemical potential .",
    "the electronic charge is @xmath257 the weights @xmath258 on real axis are combuted as @xmath259 with @xmath260 and @xmath261 , @xmath262 .",
    "+ on imaginary axis we evaluate the weights by the following expression @xmath263 + note that the dmft density matrix @xmath264 is a hermitian matrix in kohn - sham band indeces @xmath30 and @xmath31 .",
    "hence , we can use eigenvalue techniques for hermitian matrices to decompose @xmath265 into @xmath266 the lda+dmft electronic charge can then be evaluated by rotated kohn - sham vectors , and dmft weights @xmath267 by @xmath268 w_{{{\\mathbf{k}}},l}\\left[\\sum_j \\psi^*_{{{\\mathbf{k}}}j}({{\\mathbf{r}}})u^*_{{{\\mathbf{k}}},jl}\\right].\\ ] ] hence , the code to compute the lda charge can be simply converted to compute the dmft charge by just replacing the kohn - sham lda weight by dmft weight @xmath267 , and by rotating the kohn - sham eigenvectors by the above computed eigenvectors @xmath269 .",
    "+ finally , the dft core and dft semicore charge is added to the valence charge , and the resulting total charge is renormalized in the standard way , such that the charge neutrality is satisfied to high accuracy . *",
    "@xmath270:the total energy is computed on the output density @xmath179 , using the low temperature limit of the functional eq .",
    "( [ functional ] ) evaluated on the dft+dmft solution : @xmath271 + \\frac{1}{2}{\\mathrm{tr}}[\\sigma g ] + e_{h}+e_{xc}-\\phi_{dc } \\nonumber\\ ] ] for computation , the formula is cast into the following form @xmath272 - \\int(v_{h}({{\\mathbf{r}}})+v_{xc}({{\\mathbf{r}}}))\\rho({{\\mathbf{r}}})d{{\\mathbf{r}}}\\nonumber \\\\ & + & e_{h}+e_{xc}+\\frac{1}{2}{\\mathrm{tr}}[\\sigma g]-\\phi_{dc } \\nonumber\\end{aligned}\\ ] ] and evaluated by @xmath273 where @xmath274 is the dmft density matrix defined above , and @xmath275 is the impurity potential energy , which can be computed very precisely by most impurity solvers , such as ctqmc or oca .",
    "for example , in ctqmc we sample probability for each atomis state @xmath276 . using these probabilities",
    ", we can evaluate @xmath277 .",
    "* _ mix _ : the total electronic charge is mixed with the charge from previous iterations using multi - secant mixing of marks and luke @xcite . *",
    "_ dft _ : in this step , we recompute the dft potential ( hartree , exchange - correlation potential ) , the kohn - sham orbitals and linearization energies . * _ goto 11 _ : if the self consistency is hard to achieve , jump to 11 and determine the best electronic charge @xmath179 on the current impurity self - energy @xmath54 .",
    "we call this loop the lda loop . *",
    "_ goto 6 _ if the electronic charge and self - energy are not converged , jump to 6 .",
    "we call this loop the charge loop .",
    "the calculation of the electronic density , as well as the correlated green s function , requires precise evaluation of integrals , which contain diverging poles . in systems with many atoms per unit cell",
    ", one can not afford enough @xmath170-points to get hybridization function @xmath56 smooth on a scale of temperature @xmath278 without introducing artifical broadening larger than @xmath278 .",
    "hence , to avoid artifical broadening larger than the low energy scale , we need to use alternative summation over momentum .",
    "the tetrahedron method @xcite is used in this case . in the context of dft+dmft",
    ", an aditional complication is that the eigenvalues are complex numbers . although the analytic formulas for the integration over a tetrahedron can straighforwardly be evaluated , and are given in appendix a , a more severe problem is the interpolation of the multidimensional complex functions @xmath279 in momentum space .",
    "below we give details on a method to overcome this difficulty .",
    "computation of the green s function requires the evaluation of the following integral @xmath280 which can be rewriten as @xmath281 where the sum runs over all tetrahedrons @xmath282 , and integral needs to be performed over the particular tetrahedron @xmath282 .",
    "@xmath30 is the band index .",
    "the linear interpolation of @xmath283 and linear interpolation of @xmath284 in momentum space leads to analytic formulas for the weight functions @xmath285 ( given in appendix a ) , which can be used to evaluate @xmath286 to higher precision by @xmath287 .",
    "similarly , the electron density is computed by @xmath288 we take a frequency mesh , which is sufficiently dense at zero freqeuncy that it can resolve the fermi function @xmath289 , and we approximate @xmath290 here the integral @xmath291 is the integral over a particular tetrahedron @xmath282 .",
    "the weights can again be computed analytically and are give in appendix a.    to evaluate the integral over a tetrahedron @xmath282 , which has corners in momentum points @xmath292 , we need to interpolate the eigenvalues @xmath293 inside the volume of the tetrahedron .",
    "since there are many crossing bands ( index @xmath30 ) , it is not at all simple to find a good interpolation of @xmath294 inside the tetrahedron .    in the standard tetrahedron method , where eigenvalues are real numbers , one sorts the eigenvalues at each @xmath295-point , to get the vector of increasing energies @xmath296 , and then one linearly interpolates each sorted component of the vector @xmath297 inside the tetrahedron . hence all crossings are avoided .",
    "it is however important that no artifical crossings are obtained in the interpolation , because a crossing gives a diverging contribution to the integral .",
    "complex eigenvalues , which appear in dft+dmft , can not be sorted .",
    "hence the interpolation is not at all simple .",
    "a reasonable attempt would be to sort eigenvalues according to their real parts , and just neglect their imaginary parts when sorting .",
    "it turns out that in strongly correlated regime , where the self - energy becomes very large at some frequency points , the error in tetrahedron method is so large that the hybridization function can become non - causal in such points . due to this non - adequate interpolation",
    ", the green s function has a lot of noise , superimposed on a smooth curve . however , hybridization function , which is many times more sensitive than the green s function , has unbearable large error , which cause enormous error in the solution of the impurity problem .    to overcome this problem",
    ", we implemented a special type of smooth interpolation , based on the idea that the absolute value of the energy should not change much from one k - point to its neighboring k - point . for each tetrahedron , we minimize the following functional @xmath298 where the 6 @xmath299 of the tetrahedron corners are : @xmath300 , and @xmath30 runs over all bands .",
    "we minimize the functional with respect to the order of eigenvalues in all corners of the tetrahedra .    to minimize the above functional",
    ", we can choose an arbitrary order of bands in the first @xmath295-point @xmath301 , and then we have to permute the components of the other three @xmath295-points ( @xmath302,@xmath303,@xmath304 ) .",
    "hence the number of all possible trial steps is @xmath305 , where @xmath249 is the number of bands , and is typically of the order of few hundred .",
    "obviously , not all arrangements of the eigenvalues can be tried .",
    "our algorithm for sorting the eigenvalues is    * sort the eigenvalues according to their real parts .",
    "* use metropolis monte carlo method ( for @xmath306 ) to flip components of a vectors @xmath307 .",
    "try to flip components in any of the momentum points @xmath308 .",
    "the trial steps are chosen in such a way that the probability for flipping two eigenvalues , which have very different real parts , is very small .",
    "we typically choose an exponential distribution function with probability @xmath309 .",
    "in this section , we will give the efficient algorithm to compute the dc conductivity within dft+dmft .",
    "the higher order transport coefficients can be computed along the similar lines , although the computation becomes more technically involved .",
    "the dc - conductivity can in general be expressed by @xmath310 where the current - current correlation function @xmath311 is expressed diagrammatically through the electron green s functions and the current vertex function by    @xmath312    here @xmath313 is the current vertex function , which satisfies the integral equation @xmath314    and @xmath315 is the particle hole irreducible vertex , whose limit at zero frequency and fermi momenta is the landau interaction function .",
    "@xmath316 are velocities , given by @xmath317 all quantities are expressed in a bloch - basis , for example the kohn - sham basis , which diagonalizes the static part of the action .    in general ,",
    "the two particle vertex function is very difficult to compute . in some cases ,",
    "the vertex corrections vanish and the transport quantities can be computed from the lowest order bubble diagram .",
    "if self - energy is momentum independent , and the single band approximation is appropriate , the vertex correction vanish , as shown by khurana @xcite . in multiband system ,",
    "the following set of conditions are sufficient for the vertex correction to vanish :    * the irreducible vertex function is local , i.e. , @xmath318 does not depend on @xmath170 or @xmath319 .",
    "* velocities are odd functions of momentum , i.e. , @xmath320 * green s function is even functions of momentum , i.e. , @xmath321 .    under the above conditions , it is clear from eq .",
    "( [ vertexfunction ] ) that only the zeroth order term remains and vertex is unrenormalized @xmath322 .",
    "consider the first order term @xmath323 in eq .",
    "( [ vertexfunction ] ) or the second order term @xmath324 in eq .",
    "( [ vertexfunction ] ) .",
    "the function being summed is odd in @xmath319 and @xmath325 , respectively , and hence the terms vanish .",
    "under which circumstances the above three conditions are met ?",
    "the first condition is exact in the limit of infinite dimensions .",
    "thus in dynamical mean field theory , the irreducible vertex is local . for many three dimensional systems ,",
    "it is believed to be an excellent approximation . however , the velocities are not necessary odd functions of momentum , in particular , they are obviously nonzero in strict atomic limit , thus violating the condition ( 2 ) .",
    "finally , the third condition is obviously satisfied in single band theories with local self - energy , where @xmath326 because @xmath327 . in dynamical mean field theory the self - energy operator is approximated by a purely local quantity .",
    "however , the local approximation is made in a localized basis .",
    "the self - energy in the kohn - sham basis is given by eq .",
    "( [ sigdef ] ) , and is obviously momentum dependent . in general case ,",
    "the resulting self - energy @xmath328 is not an even function of momentum , and hence @xmath329 .    due to difficulties in computing the two particle vertex function to high accuracy on real axis ,",
    "the vast majority of theoretical calculations ignore the vertex corrections to conductivity . at present",
    "it is not clear how important the vertex corrections to optical conductivity and transport are in correlated electron materials .",
    "they are likely small because they vanish at low energy , where an effective single band approximation is possible . and they are also small at intermediate energies where the interband transitions give major contribution to optical conductivity .",
    "however , a thorough investigation of the vertex corrections and consequently appearance of excitons in correlated materials is a very interesting avenue for future research .    in the absence of vertex corrections , the current - current corelation function eq .",
    "( [ opt_chi ] ) becomes @xmath330\\times \\nonumber\\\\ { \\mathrm{tr}}\\left(\\rho_{{{\\mathbf{k}}}}(y)v^{{{\\mathbf{k}}}\\mu}\\rho_{{\\mathbf{k}}}(y-\\omega)v^{{{\\mathbf{k}}}\\nu}\\right ) \\label{chin}\\end{aligned}\\ ] ] where @xmath331 .",
    "both spectral density @xmath332 and velocity @xmath333 are matrices in orbital indices and trace is taken over the orbitals and spins in eq .",
    "( [ chin ] ) . finally , the real part of the dc conductivity is given by @xmath334    the dynamic self - energy is computed by an impurity solver , which is implemented either on the real or imaginary axis . the most precise impurity solvers , such as ctqmc , are implemented on imaginary axis ,",
    "hence we would like to formulate the method also for the case of imaginary axis self - energy . since the dc transport is sensitive to the behaviour of the self - energy at low frequency , we take the power expansion for @xmath335 and we determine the coefficients directly on imaginary axis @xmath336 for the dc conductivity , the expansion to the quadratic order is quite accurate . however , for the thermoelectric power , the truncation at quadratic order is not sufficient since the qubic terms in the self - energy expansion ( the asymmetry of the scattering rate ) is crucial even at low temperature ( see ref .",
    "@xcite ) .",
    "we first embed the quasiparticle renormalization amplitude @xmath337 and scattering rate @xmath338 to the kohn - sham basis using eq .",
    "( [ sigdef ] ) , i.e. , @xmath339 and @xmath340 .",
    "then we can express the low energy electron green s function in the kohn - sham basis as @xmath341 here @xmath337 and @xmath342 are hermitian matrices , while @xmath343 has both real and imaginary parts and is a complex non - hermitian matrix .",
    "next we compute the square root @xmath344 through the eigensystem of @xmath342 .",
    "we thus have @xmath345 we first solve the non - hermitian eigenvalue problem @xmath346 a^r_{{\\mathbf{k}}}= a^r_{{\\mathbf{k}}}e_{{\\mathbf{k}}}\\\\ a^l_{{\\mathbf{k}}}\\left[r_{{\\mathbf{k}}}(\\varepsilon_{{{\\mathbf{k}}}}-\\mu + \\sigma(0 ) ) r_{{\\mathbf{k}}}\\right ] = e_{{\\mathbf{k}}}a^l_{{\\mathbf{k}}},\\end{aligned}\\ ] ] and compute the scattering rate in the eigenbase @xmath347 to get @xmath348 here we used @xmath349 .",
    "next we insert eq .",
    "( [ grn ] ) into ( [ sigmab ] ) and we neglect the off - diagonal components of the scattering rate ( @xmath350 ) , since the scattering between quasiparticles is subleading at low temperature .",
    "we thus obtain @xmath351\\end{aligned}\\ ] ] where @xmath352 the integrals @xmath353 and @xmath354 have multiple poles and need to be treated by care .",
    "we first rewrite @xmath353 and @xmath354 in terms of the following functions @xmath355 if @xmath356 , we have @xmath357 and if @xmath358 we approximate @xmath359 here we neglected the term proportional to @xmath360 in the denominator , since the derivative of the fermi function constrains @xmath361 and since the interband transition give subleading contribution to the drude peak .",
    "a special care needs to be taken to compute the integrals @xmath362 , @xmath363 and @xmath364 to high enough precision and avoid divergencies .",
    "we give details on their evaluation in appendix  [ appb ]",
    "the impurity solvers based on the hybridization expansion have a long history and were often employed to solve the problem of a degenerate magnetic impurity in a metallic host @xcite . in the past , most of calculations were limited to the lowest order self - consistent approximation , called the non - crossing approximation ( nca ) .",
    "recently , many generalization of the approach were studied @xcite , to overcome the difficulty of the nca at low temperature , below the kondo temperature .",
    "it is well known that the nca approximation fails to recover the fermi liquid fixed point at low temperature and low energy .",
    "typically there are three types of problems with nca : i ) the kondo temperature is correct when only one type of charge fluctuations is dominant ( like @xmath365 , which is equivalent to the limit of @xmath366 ) . when more than one charge fluctuation needs to be considered ( @xmath367 and @xmath368 ) the kondo temperature is severely underestimated and hence the kondo peak is too narrow .",
    "ii ) the asymmetry of the kondo - suhl resonance and its height is exaggerated in nca .",
    "iii ) at very low temperatures @xmath369 an additional spurious peak at zero frequency appears .    for dmft applications ,",
    "the problem iii ) is not very severe , while the other two are .",
    "the first problem can be corrected by a very moderate computational expense .",
    "adding the first subleading feynman diagrams @xcite , named one crossing approximation ( oca ) @xcite cures the problem of the low energy scale .",
    "it also substantially improves the asymmetry of the kondo peak as well as its width .",
    "not surprisingly , in the context of dmft , the oca approximation gives correct critical @xmath103 of the mott transition in the hubbard model , while nca severely underestimates it .",
    "in contrast to other higher order conserving approximations @xcite , the oca approximation is relatively straighforward to generalized to the arbitrary impurity problem . due its attractive features",
    ", oca was used in many dmft applications , such as unraveling the mixed valence state in pu @xcite , the coherence - incoherence crossover in ce-115 materials @xcite , the transport properties in titanides @xcite , the @xmath370 to @xmath371 transition in ce , etc .",
    "compared to exact solution , as obtained by ctqmc , the oca approximations typically gives very precise probability for all atomic states @xcite ( the histogram ) , quite precise coherence scale , and the quasiparticle renormalization amplitude ( the width of the kondo peak ) , which is typically only slightly underestimated . at temperatures below the coherence scale , the oca method",
    ", however , still suffers from slight overestimation of the height of the kondo peak , and hence causality violation in the context of dmft .",
    "hence , the oca approximation has to be used with care , especially in the systems with high coherence scale , and the systems with only moderate correlations .",
    "the oca equations for the one band problem were given by many authors @xcite , and their generalization to multiband situation was briefly discussed in the review ref .  , the generalized equations were however , not yet given , hence we will give them for the general multiorbital impurity problem , as relevant in the electronic structure calculations in section [ oca ] .",
    "recently , a renewed interest in the hybridization expansion arouse , once it was shown @xcite that the feynman diagrams can be efficiently sampled by monte carlo importance sampling .",
    "the current implementation of this algorithm , as applied to realistic material problems , was discussed in plenty of detail recently @xcite , and it will not be repeated here .    here we will rather outline an alternative monte carlo sampling approach , which was not yet discussed in the literature nor implemented .",
    "it is natural to ask if there exists an alternative regrouping of diagrams in monte carlo sampling , such that nca approximation would be the lowest order contribution in the hybridization expansion , i.e. , the two kinks approximation .",
    "we detail the method below in section [ cbctqmc ] , and show results of a simplified implementation , which truncates the sampling at a finite order ( up to fifth order in hybridization ) .",
    "the ctqmc @xcite solver is the most efficient exact solver for electronic structure problems ( see for example ref .   and ref .  ) . on the other hand ,",
    "the oca impurity solver is very accurate in many correlated systems with narrow bands .",
    "for example , it gives correct critical @xmath103 in hubbard model , correct kondo scale in kondo lattice model , etc .",
    "the current implementation of ctqmc is equivalent to pseudoparticle formulation of the expansion around the atomic limit , however , with bare pseudoparticle propagators .",
    "it is thus natural to expect that the dressed pseudoparticle propagators would make the algorithm more efficient , since the two kinks approximation is equivalent to nca , and the four kinks approximation to oca .",
    "the basic idea of the _ bold ctqmc _",
    "algorithm is to sample the skeleton feynman diagrams , with propagators being _ dressed _",
    "@xcite . the monte carlo importance sampling samples all such diagrams , with the probability proportional to their luttinger - ward functional @xmath372 .",
    "hence contributions to all pseudoparticle self - energies can be straighforwardly sampled within this approach .    although the formalism of hybridization expansion on real axis was developed long ago ( see for example ref . ) , its imaginary axis counterpart was not yet given .",
    "to our knowledge , the nca equations have not yet been implemented on imaginary axis , because of the problems with diverging term in the projected dyson equation ( see eq .",
    "( [ pdyson ] ) below ) .    in the hybridization expansion ,",
    "the pseudoparticles are introduced to diagonalize the atomic part of the hamiltonian .",
    "the impurity problem is cast into the form @xmath373 where we used completeness @xmath374 for atomic states @xmath375 .",
    "each atomic state is represented by corresponding pseudoparticle @xmath376 , and the completness of atomic basis gives a constraint for pseudoparticles @xmath377 .",
    "the hamiltonian is then given by @xmath378 and the action is @xmath379 where @xmath380 .",
    "we also define @xmath381 .",
    "any physical quantity has to be evaluated in the @xmath382 subspace .",
    "this is achieved by letting @xmath383 , to separate the spectra of @xmath384 , @xmath382 , @xmath385 , @xmath386 .",
    "then we use the abrikosov s trick to pick out the @xmath382 subspace . the expectation value , which we want to compute is @xmath387 while accesible quantities are @xmath388 .",
    "if operator @xmath389 vanishes in the absence of impurity ( in @xmath384 subspace ) , the physical expectation value can be computed by @xmath390 this is clear from expansion @xmath391 notice also that in the @xmath383 limit @xmath392 can be used to obtain impurity free energy .    in more general case , when @xmath393 does not vanish in @xmath384 subspace , eq .",
    "( [ abrikosov ] ) should be replace by @xmath394 .",
    "the green s functions for pseudoparticles obey the dyson equation , @xmath395 where the energies of all pseudoparticles are shifted by @xmath396 compared to atomic energies @xmath227 , due to @xmath397 term in the hamiltonian . in general , the green s functions for pseudoparticles are off - diagonal .",
    "the states which correspond to the same superstate , defined in ref .  ,",
    "obey a matrix analog of the above dyson equation .",
    "however , here we will give equations for diagonal case , since the generalization is less transparent , but straighforward .",
    "the numeric limit of @xmath398 is very untractable for computer .",
    "since bold - ctqmc is implemented in imaginary time , we thus want to analytically project the pseudoparticle equations on imaginary time axis .    before the limit",
    "@xmath383 is taken , the pseudoparticle green s functions are given by @xmath399 the poles of the green s function @xmath400 are at large frequencies , comparable to @xmath396 , while @xmath401 vanishes for @xmath402 .",
    "hence @xmath403 vanishes because @xmath404 vanishes .",
    "we thus have @xmath405 this equations demonstrate the well known fact that the pseudoparticles can not propagate back in time .    to derive a set of well posed projected equations ,",
    "we introduce projected green s functions , which remain well behaved in the limit @xmath383 , and are used for numeric implementation @xmath406 of course , these projected propagators vanish for @xmath407 .",
    "the projected propagators are analogous to the well known projected functions on the real axis ( see ref .  )",
    "@xmath408 since @xmath409 is the usual @xmath410 transformation between the imaginary time and real frequency .",
    "our goal is to write all equations in terms of projected @xmath411 and analogous @xmath188 functions , which do not contain @xmath396 and are numerically well behaved .",
    "the problem however is that the projected quantities do not have fermionic nor bosonic character , and hence can not be represented on imaginary frequency axis .",
    "the dyson equation eq .",
    "( [ dyson0 ] ) can be expressed in terms of projected functions by @xmath412 but its evaluation is far from straightforward . for convenience",
    ", we drop the index @xmath413 from @xmath227 , @xmath414 , and @xmath415 .",
    "we need to evaluate this formula in the limit @xmath383 .",
    "it is however not possible to perform the limit numerically because the exponential factors grow as @xmath416 while the poles are in infinity on the real axis .    for the implementation of the bold - ctqmc",
    ", it is crucial to find numerically tractable form of the projected dyson equation . to this end , we perform expansion in powers of @xmath188 , to get @xmath417 where @xmath418 .",
    "the summation over imaginary frequency can now be performed , to obtain    @xmath419 \\label{longexp}\\end{aligned}\\ ] ]    note that the limits of integration are constraint to the phase space of forward propagating pseudoparticles .",
    "namely , the limit of @xmath383 does not allow the time difference in the exponent to be negative .    to evaluate the projected dyson equation in a stable way",
    ", we first evaluate the following moment - functions @xmath420 and then we convolve the moment - functions with @xmath188 .",
    "( [ longexp ] ) is hence implemented by @xmath421 where @xmath422 note that all terms in the expansion have the same sign ( note @xmath423 ) , hence the expansion converges quite fast , and we typically need between 30 - 50 terms for numerically sufficient precison .",
    "convolutions can be evaluated by standard method of fourier transforms , or , they can be cast into the form of matrix multiplications , once the matrix @xmath424 is precomputed and used for all terms in the expansion .",
    "it is instructive to check the formula in two simple limits : i ) @xmath425 , evaluates to @xmath426 ; ii ) @xmath427 and @xmath428 evaluates to @xmath429 .",
    "the latter limit is very instructive because it shows that @xmath411 can exponentially grow at low temperature and finite @xmath23 .",
    "this is well known problem from implementing the nca equations on real axis . to keep @xmath430 finite , and peaked around the origin on real axis ( @xmath430 roughly constant in @xmath23 ) , one needs to shift all pseudoparticle energies @xmath431 to sufficiently positive energies , such that @xmath432 , where @xmath433 is of the order unity .",
    "namely , in grand canonical ensemble , the pseudoparticle charge @xmath434 , defined in eq .",
    "( [ q0 ] ) , is @xmath435 indeed vanishes in the physical @xmath382 subspace .",
    "once the projection is done , the physical quantities in @xmath382 subspace are invariant with respect to shift of all pseudoparticle energies by the same amount .",
    "if we introduce a finite shift @xmath431 ( which is equivalent to @xmath436 ) , charge @xmath437 will decrease for @xmath438 while the product @xmath439 will remain the same .",
    "similarly , all physical quantities are invariant , while the projected pseudoparticle quantities are not .",
    "hence , for numerical stable evaluations , it is crucial to choose the shift @xmath440 such that pseudoparticle propagators are finite .",
    "a large @xmath440 will make them exponentially small , while vanishing @xmath440 will cause @xmath414 to diverge at @xmath441 .",
    "we thus need to fix the value of @xmath440 properly .",
    "two possible choices are @xmath442 or @xmath443 , where @xmath444 is the pseuodoparticle , which corresponds to the ground state of the atom .    the basic idea for the bold - ctqmc is to sample self - energies for all pseudoparticles as well as the local green s function .",
    "this is easiest to achive by defining the probabilty to be proportional to the absolute value of the luttinger - ward functional @xmath445|$ ] , and the self - energies then become @xmath446}{\\delta g_{m'm}}\\\\ g_{\\alpha\\beta}&=&\\frac{1}{\\langle q\\rangle}\\frac{\\delta \\phi[g,\\delta]}{\\delta \\delta_{\\beta\\alpha}}\\end{aligned}\\ ] ] where the first equation is contribution to the pseudoparticles self - energies , and the second is contribution to the real - electron green s function ( the impurity green s function ) .    the second identify might be less obvious , but it follows from the fact that the impurity green s function is the t - matrix for the conduction electrons @xmath447 we have seen above that @xmath448 carries a factor of @xmath449 , and we will show below that @xmath372 also carries the same factor @xmath449 , hence the pseudoparticle self - energy @xmath450 is of the order of unity . on the other hand , the conduction electron self - energy @xmath451 is proportional to @xmath452/\\delta\\delta$ ] , and hence vanishes as @xmath453 . therefore both @xmath451 and @xmath454 are proportional to @xmath453 .",
    "the expansion of the equation eq .",
    "( [ t - matrix ] ) in powers of @xmath453 shows that i ) conduction electron propagator @xmath455 is unrenormalized in this theory ( or equivalently the bare hybridization @xmath62 appears in functional @xmath456 $ ] ) ; ii ) the impurity green s function , evaluated in the grand - canonical ensemble @xmath454 is equal to @xmath452/\\delta\\delta$ ] , which vanishes as @xmath453 .",
    "however , the physical quantities like the electron green s function must be evaluated in @xmath382 subspace , using eq .",
    "( [ abrikosov ] ) .",
    "the resulting ratio is of order unity and is invariant with respect to shift of @xmath440 , as explained above .",
    "the luttinger - ward functional @xmath456 $ ] for the lowest order contribution ( two kinks ) , known under the name nca , is given by @xmath457 = \\int_0^\\beta d\\tau g_{mm'}(\\tau)g_{n'n}(\\beta-\\tau)\\delta_{\\alpha\\beta}(-\\tau)\\nonumber\\\\ \\times ( f^{\\alpha})_{nm}(f^{\\beta\\dagger})_{m'n'}\\end{aligned}\\ ] ] note that if integration variable is shifted to @xmath458 , additional minus sign can appear . in case of regular fermions and bosons ,",
    "this minus sign is automatically taken care of by the antiperiodicity of fermionic green s functions @xmath459 .",
    "the pseudoparticle green s functions however vanish at negative times , and one needs to add @xmath441 to the negative argument , and add an overal minus sign when @xmath441 is added to the fermionic green s function .",
    "the corresponding pseudoparticle self - energies are @xmath460}{\\delta g_{n'n}(\\beta-\\tau)}\\end{aligned}\\ ] ] where @xmath461 is @xmath462 ( -1 ) if @xmath249 corresponds to pseudo - boson ( pseudo - fermion ) .",
    "again , this minus sign is because negative times are not allowed for pseudoparticles .",
    "each pseudoparticle propagator carries an exponent @xmath463 , and the sum of exponents is always @xmath453 .",
    "this holds for all diagrams composed of exactly one loop of pseudoparticles .",
    "these are the only diagrams that give contribution to the physical quantities .",
    "if we take out the exponential factors , the nca functional takes the form @xmath457 = e^{-\\beta\\lambda}\\int_0^\\beta d\\tau \\widetilde{g}_{mm'}(\\tau)\\widetilde{g}_{n'n}(\\beta-\\tau)\\delta_{\\alpha\\beta}(-\\tau)\\nonumber\\\\ \\times ( f^{\\alpha})_{nm}(f^{\\beta\\dagger})_{m'n'}\\end{aligned}\\ ] ] if we denote @xmath464=e^{\\beta\\lambda}\\phi[g,\\delta]$ ] , we see that @xmath465 hence @xmath466}{\\delta \\widetilde{g}_{n'n}(\\beta-\\tau ) } \\label{sigmadd}\\ ] ] the projected @xmath467 $ ] has exactly the same form as @xmath456 $ ] , we only need to replace @xmath468 .",
    "the nca diagram hence becomes @xmath469 = \\int_0^\\beta d\\tau \\widetilde{g}_{mm'}(\\tau)\\widetilde{g}_{n'n}(\\beta-\\tau)\\delta_{\\alpha\\beta}(-\\tau)\\nonumber\\\\ \\times ( f^{\\alpha})_{nm}(f^{\\beta\\dagger})_{m'n ' } \\label{ncal}\\end{aligned}\\ ] ]    from eqs .",
    "( [ sigmadd ] ) and  ( [ ncal ] ) it is clear that we achieved the goal of expressing all equations in terms of projected quantities , which do not depend on variable @xmath396 , and are numerically well behaved .",
    "the projected second order diagram , which correspond to oca approximation , is given by    @xmath470 = \\int_0^\\beta d\\tau_4\\int_{0}^{\\tau_4 } d\\tau_3\\int_{0}^{\\tau_3 } d\\tau_2\\int_0^{\\tau_2}d\\tau_1 \\widetilde{g}_{m_0 m_0'}(\\tau_1-\\tau_4+\\beta)\\widetilde{g}_{m_1 m_1'}(\\tau_2-\\tau_1 ) \\widetilde{g}_{m_2 m_2'}(\\tau_3-\\tau_2 ) \\widetilde{g}_{m_3 m_3'}(\\tau_4-\\tau_3 ) \\nonumber\\\\ ( f^{\\alpha\\dagger})_{m_1 ' m_0}\\delta_{\\alpha\\beta}(\\tau_1-\\tau_3)(f^\\beta)_{m_3 ' m_2 } ( f^{\\alpha'\\dagger})_{m_2 ' m_1 } \\delta_{\\alpha'\\beta'}(\\tau_2 ) ( f^{\\beta'})_{m_0 ' m_3}\\end{aligned}\\ ] ]    the projected pseudoparticles vanish at negative times and are well behaved at positive times . for the purpose of properly evaluating the feynman diagrams in time , we can extend them to negative times without any loss of generality .",
    "the pseudo - bosons hence become periodic , and the pseudo - fermions antiperiodic .",
    "the annoying minus signs @xmath471 can then be eliminated . however , the projected pseudoparticles can not be fourier transformed to imaginary frequency , and they do not obey the usual dyson equation , but rather a more complicated type of dyson equations derived in eq .",
    "( [ longexp ] ) .",
    "the pseudoparticles can be analytically continued to real frequencies , and all pseudoparticles satisfy fermionic - type of continuation , given in eq .",
    "( [ analtc ] ) .",
    "finally , the monte carlo algorithm must generate any skeleton diagram of any order . the probability to accept",
    "the diagram is proportional to its @xmath472|$ ] .",
    "the contribution to pseudoparticle self - energy is then @xmath473 , where @xmath474 means the average in the markov proces , where weights are proportional to @xmath475 .",
    "similarly , the impurity green s function can be sampled by @xmath476 .",
    "the sampled self - energies will only be proportional to the exact self - energies .",
    "the renormalization factor can easily be found knowing the probability for nca diagram , and its value .",
    "the requirement to sample the skeleton diagrams prohibits us to combine many diagrams into determinant of hybridization functions @xmath62 , as it was achieved in the algorithm by werner et.al .",
    "similar type of trick of combining the diagrams into determinant of @xmath62 s would substantially improve the efficiency of the algorithm .",
    "it is however not clear how to eliminate non - skeleton diagrams from determinant , and keep the updating formulas efficient .    to test the above described algorithm , and to check its performance and convergence",
    ", we implemented a simplified version of the bold - ctqmc for the canonical anderson impurity model .",
    "we sampled all diagrams up to certain order starting with first order ( nca ) , second order ( oca ) and up to fifth order .",
    "the fifth order takes only minutes on a typical personal computer .",
    "we first found the topology of all diagrams of certain order , the prefactor and the sign of each diagram . in fig .",
    "[ bctqmc - diags ] we plotted the diagrams for the first few orders ( second - @xmath477 , ...",
    "fouth - @xmath478 ) .",
    "we colored the diagrams according to their sign , positive with black and negative with red .",
    "there are four nca diagrams , two oca diagrams , 8 third order diagrams ( 4 positive and 4 negative ) , 44 forth order diagrams ( 24 positive and 20 negative ) , 320 fifth order diagrams ( 128 positive and 192 negative ) .",
    "we evaluated exactly the nca and oca diagrams , and we used metropolis algorithm to sample the time arguments for higher order diagrams .",
    "the probability for the acceptance of a set of imaginary times was taken to be proportional to the value of the total @xmath479 , hence at fifth order 320 diagrams were evaluated at each monte carlo step . while this algorithm can not be used at very high orders in perturbation theory due to exponential growth in the number of diagrams , its advantage is in large improvement of the sign problem .",
    "namely , the diagrams of the same order and the same time arguments tend to cancel at higher orders .",
    "since we evaluate all of them at each monte carlo step , the sign problem is almost completely eliminated .",
    "the non - interacting limit @xmath480 is the hardest case for the hybridization expansion algorithm , because the coherence temperature is infinite .",
    "here we present test of the algorithm in the case of half - filled non - interacting hubbard model on the bethe lattice within dmft .",
    "we want to emphasize that the algorithm becomes more efficient and faster converging in strongly interacting limit @xmath481 , a case which will be presented elsewhere .    in fig .",
    "[ bctqmc - g1](a ) we show the impurity green s function on imaginary axis ( at @xmath482 ) when the perturbation theory is truncated at certain order .",
    "we also display the exact result by the dashed line .",
    "while the nca curve clearly deviates from the exact result , the higer order approximations are hardly distinguished from the exact curve on this plot . in fig .",
    "[ bctqmc - g1]b we show separately the contributions to the green s function from different orders in perturbation theory .",
    "as expected the contribution from the lowest two orders is large , while the higher order contributions are smaller .",
    "this shows why oca approximation is so successful in many realistic situations .",
    "the fifth order contribution is on average only @xmath483 , and never exceeds @xmath484 .    in fig .",
    "[ bctqmc - g2 ] we zoom - in the exponential drop of the green s function at short times .",
    "we see that the convergence with the perturbation order is very encouraging .    for efficiency of the bold - ctqmc ,",
    "it is important to monitor the sign of each individual diagram . in fig .",
    "[ bctqmc - sign ] we show separately the contribution to the impurity green s function from the diagrams with positive @xmath372 and those with negative @xmath372 , together with the sum of the two . at the third order ,",
    "the sum is around 70% of the positive contribution , while at the forth and fifth order , the sign drops to 0.2 and 0.07 , respectively . as explained above , the current implementation of the method , which groups together all diagrams of a certain order in perturbation theory , does not have a substantial minus sign problem .",
    "however , this method becomes expensive at high orders , and thus one needs to resort to sampling of individual diagrams , which can be performed to arbitrary high order . in the latter case , there will be a minus sign problem , as estimated here .",
    "in this section we will give the most general formulas for the one crossing approximation , and we will explain the crucial steps in implementing the algorithm .",
    "we start with lowest order approximation , which is the non - crossing approximation . when evaluating these diagrams , we have to consider only two hilbert subspaces of constant @xmath485 at once , i.e. , @xmath485 and @xmath486 .",
    "the first step is to compute all eigenvalues and eigenvectors of the atom in the subspace @xmath485 and @xmath486 .",
    "we then group together the atomic eigenstates , which are degenerate , i.e. , have the same atomic energy @xmath227 . in the next step we check which of these degeneracy s survive in the presence of the crystal field environment ( impurity hybridization @xmath62 ) , and which off - diagonal propagators need to be considered .",
    "we evaluate the following matrix elements @xmath487 here @xmath3 runs in the hilbert subspace of @xmath485 and @xmath229 in the hilbert supspace of @xmath486 .",
    "the matrix elements @xmath488 and @xmath489 where @xmath490 is electron destruction operator .",
    "the sum runs only over the @xmath229 states which are degenerate and over one electron states @xmath370 which are also degenerate and for which @xmath491 is nonzero in the considered crystal field symmetry .",
    "the resulting matrix elements @xmath492 have the same symmetry as the propagators of the pseudoparticles @xmath493 . clearly , in high symmetry crystal environment , most of the off - diagional matrix elements vanish and the degeneracy of @xmath494 is high , but in low symmetry environment and in the broken symmetry state , many of the off - diagonal propagators become crucial .    once the symmtry of the propagators is known , we determine all nonvanishing bubbles ( nca diagrams ) and the matrix elements for each bubble .",
    "the nca matrix elements are @xmath495 where we sum only over degenerate states @xmath496 and degenerate crystal field components @xmath370 .",
    "the luttinger - ward functional and the self - energy corrections are depicted in fig .",
    "[ ncalw ] .",
    "we associate a factor @xmath497 to each vertex that marks the creation of electron in bath @xmath370 . accordingly",
    ", we add a factor @xmath498 for each vertex of electron anhilation .    in the next step ,",
    "we precompute the matrix elements of the one - crossing diagrams , which are depicted in fig .",
    "[ ocalw ] . here",
    "we need to select three different hilbert subspaces : @xmath499 , @xmath485 , and @xmath486 to compute @xmath500 here @xmath3 , @xmath229 , @xmath501 run over the states with @xmath499 , @xmath485 and @xmath486 number of particles , respectively .",
    "we add only the most important crossing corrections , for which the particle number @xmath485 is in the hilbert subspace of the ground state of the atom .",
    "we also select @xmath502 to be only the ground state multiplet of the atom , or the atomic states with energy very close to the ground state energy .",
    "we compute the matrix elements @xmath503 and @xmath504 only once in the dmft self - consistent loop and we save them into the input file for oca impurity solver . the matrix elements @xmath503 , @xmath504 do need to be updated in the outer lda+dmft charge loop .",
    "we typically update them every three to four charge steps , since the relative crystal field splittings usually change very little during lda+dmft iterations .",
    "the atomic energies @xmath227 change much more ( due to the chemical potential shift ) , and need to be updated at every step .",
    "the nca diagrams on the real axis can be evaluated with conventional techniques , and after the projection , they take the following form    @xmath505    @xmath506    @xmath507    where @xmath508 .",
    "the pseudoparticle propagators @xmath133 and the pseudoparticle self - energies are related by the dyson equation . the eq .",
    "[ hpseudo ] shows that @xmath509 .",
    "many of the pseudoparticle propagators and hybridization functions are degenerate , hence in practice we do not need to sum over all possible @xmath3 , @xmath229 and @xmath370 indices , but we rather use the precomputed matrix elements @xmath510 , which make sure that no equivalent diagram ( a diagram which has the same frequency dependence ) is not computed multiple times .    to take care of the diverging exponential factors ,",
    "we work with the projected quantities @xmath511 and @xmath512 , as explained above . the pseudoparticles have typically very sharp almost diverging structure near the treshold energy , which is not easy to fourier transform .",
    "hence we can not use the fourier transform for convolutions .",
    "we rather cast the above equation into the form for matrix multiplication , for which fast linear algebra packages such as blas , exist .",
    "we use the logarithmic mesh to resolve the fine structure of the pseudoparticle green s functions .",
    "it is important to realize that the number of baths @xmath370 is quite small ( of the order of @xmath513 for correlated orbital of angular momentum @xmath24 ) , while the number of atomic states is much bigger .",
    "hence we precompute the integral and the first moment of functions @xmath514 and of @xmath515 for all @xmath516 . within trapezoid rule ,",
    "the values and the first moments of these quantities are enough to compute the above convolutions with matrix multiplications on any given mesh .    to see that , lets consider an arbitrary convolution @xmath517 here the function @xmath518 is defined on a certain mesh @xmath519 , on which it is well resolved , i.e. , @xmath520 .",
    "the function @xmath521 is defined on another mesh @xmath522 , i.e. , @xmath523 .",
    "the convolution can be safely calculated on the union of both mashes @xmath524 .",
    "one of the meshes should be shifted for @xmath525 , thus for each outside frequency , a different union of the two meshes should be formed and only then the convolution can be safely evaluated .",
    "this is very time consuming and not done in practice .",
    "when a certain @xmath229 function needs to be convolved with many other functions ( like @xmath514 in our example above ) , we use the followin trick .",
    "we first precompute the integral and the first moment of the function @xmath526 we then calculate the convolution without building a new inside mesh .",
    "let s use the mesh @xmath519 which resolves function @xmath286 .",
    "then , in the spirit of trapezoid rule , we can linearly interpolate @xmath286 between the points @xmath527f(x - z)dx.\\ ] ] this integral can be expressed by the above defined functions . to show that",
    ", let us rewrite the convolution and expressed it by the new function @xmath528 which is defined on the same mesh as @xmath286 and with which the covolution is a simple scalar product @xmath529 \\nonumber\\\\    \\equiv \\sum_i g_i \\langle f\\rangle_{i z } dh_i .\\end{aligned}\\ ] ] thus @xmath530 is    @xmath531-f_2(x_{i+1}-z)+f_2(x_i - z)}{(x_{i+1}-x_{i-1})(x_{i+1}-x_i)}- \\right.\\\\ \\left .",
    "-\\frac{(x_{i-1}-z)[f_1(x_i - z)-f_1(x_{i-1}-z)]-f_2(x_i - z)+f_2(x_{i-1}-z ) ] }       { ( x_{i+1}-x_{i-1})(x_{i}-x_{i-1 } ) } \\right]\\end{aligned}\\ ] ]    hence the convolution of @xmath229 with many functions @xmath532 can be computed at once @xmath533 by the following matrix product @xmath534 .",
    "once the nca contributions are evaluated , we add the second order diagrams , which correspond to oca approximation and are depicted in fig .",
    "[ ocalw ] .",
    "they take the explicit form    @xmath535    @xmath536    @xmath537\\times \\nonumber\\\\ & \\times&\\int\\frac{dy}{\\pi}f(-y)\\delta^{''}_{\\alpha\\alpha'}(y)g_{b_1 b_2}(\\omega - y ) \\int",
    "\\frac{dx}{\\pi}f(x)\\delta^{''}_{\\beta\\beta'}(x)g_{a_1 a_2}(\\omega+x)g_{f_3 f_4}(\\omega+x - y)\\end{aligned}\\ ] ]    @xmath538\\times\\\\ & \\times&\\frac{1}{e^{\\alpha\\lambda}\\langle q\\rangle f(-\\epsilon)}\\int dy e^{-\\alpha y } \\int\\frac{dx}{\\pi}f(x)\\delta^{''}_{\\alpha\\alpha'}(x){\\textrm{im}}\\left\\{g_{b_1 b_2}(y)g_{f_1 f_2}(x+y)\\right\\}{\\textrm{im}}\\left\\{g_{f_3 f_4}(\\epsilon+y)g_{a_1 a_2}(\\epsilon+x+y)\\right\\ } \\nonumber\\end{aligned}\\ ] ]    in practice , we do not sum over all @xmath229 , @xmath3 and @xmath501 indices .",
    "as explained above , we precompute the matrix elements @xmath539 for the most important processes .",
    "we take only the low lying atomic states into account ( only @xmath229 s which are part of the ground state multiplet or with energy very close to the ground state ) .",
    "we also take into account the degeneracy of all atomic states and the degeneracy of baths @xmath370 , in order to avoid computing the equivalent diagram mutliple times .",
    "finally , the convolutions for the oca approximation can also be cast into the form of matrix multiplication , once the first moment and integrals of a few functions are precomputed .",
    "the monte carlo impurity solvers are implemented on imaginary axis where the quantity being sampled is real and many times even `` sign - free '' .",
    "the results obtained in this way are exact , except for the statistical noise .",
    "however , even a tiny statistical error on imaginary axis precludes the analytic continuation by pade type of methods . the standard method , to overcome the difficulty of the singularity of the kernel , is the maximum entropy method ( mem ) .",
    "the basic idea of this method is to find a function on the real axis , which is very close to monte carlo data on imaginary axis ( within statistical error ) , and is smooth function on real axis , locally not very different from a chosen model function .",
    "this approach works very well for analytical continuation of the green s function @xmath540 to obtain spectral function on real axis , i.e. , to solve the integral equation @xmath541 for @xmath239 .",
    "knowing the spectral function , it is however not possible to obtain the momentum resolved spectra , or optical conductivity , or transport coefficients . to compute these properties",
    ", it is essential to analytically continue the self - energy , rather then the green s function .",
    "the self - energy of correlated materials is however very hard to analytically continue with maximum entropy method , because the self - energy typically has very sharp feature or even poles , which separate the low energy part of the spectra ( the quasiparticle peak ) from the high energy part of the spectra ( the hubbard bands ) . due to the maximum entropy method requirements of smoothness ,",
    "the analytically continued self - energy at low energy is typically polluted with the near - by poles , which appear in the self - energy at the intermediate energy .    a successful analytic continuation method for self - enery needs to met the following conditions :    * imaginary axis self - energy is equal to monte carlo data within the statistical error * real axis self - energy function must be locally smooth * the power - expansion around zero frequency should match the quantum monte carlo data on both , real and imaginar axis .",
    "while the first two conditions are met by mem , the last is not .",
    "we developed an alternative method , which mets the above conditions and was very successfully used in combination with ctqmc for pnictides @xcite , cuprates @xcite , vo@xmath542 and other materials .",
    "although the method has many parameters , which needs to be choosen appropriately , we can always check its accuracy by recomputing the spectral function of the lattice , using analytically continued self - energy , and comparing the spectral function to the maximum entropy continued spectra .",
    "we expand the self - energy in terms of modified gaussians @xmath543 , and we add a polynomial function around zero frequency @xmath544 the modified gaussians @xmath545 have a unique peoperty that they are peaked at @xmath546 , with the width of approximately @xmath546 , while they exponentially vanish at zero frequency .",
    "they are asymmetric with slow decay away from zero and very fast decay towards zero frequency .",
    "we choose the modified gaussians centered on a logarithmic mesh of @xmath547 with @xmath548 .",
    "the modified gaussians functions were used in connection with constructing the nrg spectral function @xcite .",
    "we typically take the parameter @xmath3 to be @xmath549 .    since the modified gaussians all vanish at zero frequency , we add a polynomial function around zero frequency .",
    "the coefficients of the polinomial are determined by fitting the imaginary axis self - energy , i.e. , @xmath550 which can be analytically continued to @xmath551 the polynomial has to drop - off sufficiently fast at high frequency , hence we choose the following function @xmath552 where the upper choice is made for metals and the lower choice for insulators and very bad metals . in the fl regime , we have @xmath553 , @xmath554 .",
    "the coefficient @xmath555 is determined by the condition @xmath556    for speed , we precompute @xmath557 and @xmath558 by @xmath559 similarly , we also precompute @xmath560 and @xmath561 . also the integral of the functions @xmath562 and",
    "@xmath563 are precomputed .",
    "the coefficients @xmath564 in expansion eq .  ( [ sigm ] )",
    "are determined by minimizing the following functional    @xmath565    here @xmath566 in the first term runs over the imaginary frequencies which are sampled by qmc ( and not over the analytically added tail ) .",
    "the second terms imposes the correct value of the integral of the self - energy .",
    "the integral of the expansion ( [ sigm ] ) is @xmath567 which needs to match the @xmath568 tail of the qmc data @xmath569 finally , the last three terms ensure that the value , and the first two derivatives of the analytically continued self - energy at zero frequency match the derivatives on imaginary axis . for minimization",
    ", we use the l - bfgs - b alrorithm of ref .  .",
    "to test our implementation of dft+dmft within wien2k method , we show in figs .",
    "[ cedos ] and [ cedos2 ] results for cerium @xmath370 to @xmath371 transition .    at a temperature",
    "less than @xmath570k and pressure less than 20@xmath571kbar , elemental cerium undergoes a transition between two isostructural phases : a high pressure phase or @xmath370 phase and a low pressure @xmath371 phase . in @xmath370-ce",
    "the @xmath229 electron is delocalized while in @xmath371-ce the @xmath229 electron is localized .",
    "the transition is well accounted for by phenomenological kondo volume collapse picture @xcite .",
    "we treat only the ce @xmath572 electrons as strongly correlated thus requiring full energy resolution , while all other electrons such as ce @xmath573 are assumed to be well described by the gga .",
    "we choose @xmath574ev and @xmath575ev for the coulomb interaction .",
    "the value of @xmath103 was obtained by constraint dft calculation @xcite and @xmath576 was computed using the atomic physics program of ref .   and reduced by 30% to account for the screening in the solid .",
    "both phases of ce have fcc unit cell with quite different volumes , @xmath577 and @xmath578 .",
    "the results were converged with 5000-@xmath170 points , we use the gga functional for the dft part and use oca and ctqmc impurity solver to solve the auxliliary impurity problem .    the results in fig .",
    "[ cedos ] ( obtained by oca ) and fig .",
    "[ cedos2 ] ( obtained by ctqmc ) are practically identical and very similar to previous lda(lmto)+dmft results @xcite .",
    "one can clearly see the broad quasiparticle peak in @xmath370-ce , split by the spin - orbit coupling @xmath579ev .",
    "the lower peak has mostly @xmath580 character and the upper peak mostly @xmath581-character .",
    "the system is in good fermi liquid regime at the temperature of @xmath582k used in the calculation .",
    "the second phase with larger volume is in local moment regime with no visible kondo peak at the fermi level , but enhanced hubbard bands .",
    "it is instructive to examine the hybridization function @xmath583 as computed by lda and self - consistent dmft ( see fig .  [ cehybrid ] ) .",
    "it turns out that in ce , the low energy hybridization function is substantially reduced compared to its lda value .",
    "the two large peaks at @xmath584ev and @xmath585ev are absent in dmft hybridization .",
    "since the coherence scale is exponential function of hybridization , the coherence scale is lower in dmft than it would be in so called one - shot dmft .",
    "it is known from the early days of the kondo volume collapse theory @xcite , that the lda hybridization in a one - shot calculation was too big and had to be renormalized by phenomenological parameter @xcite .",
    "dmft reduces the hybridization through the collective screening effects and hence is able to give correct coherence scale of the problem .",
    "finally , let us show optical conductivity , as implemented in lda(wien2k)+dmft method .",
    "the overal agrement with previous lda+dmft results  @xcite is very good .",
    "the new computational results are in even slightly better agreement with experiment of ref .  , since they both clearly display a shoulder around @xmath586ev in @xmath370-ce , which we can now clearly identify as excitations across the split quasiparticle peak .",
    "the splitting is due to spin - orbit coupling in ce .",
    "the heavy fermion 115 materials have a chemical formula ce@xmath587in@xmath0 , where @xmath587 is either co , rh or ir .",
    "they crystallize in layered tetragonal structure shown in fig .",
    "[ structure ] , composed of ce - in layers and @xmath587-in layers .    at high temperature ,",
    "the low energy electronic states are composed of mainly the broad @xmath573 bands of in and ce .",
    "the ce-@xmath1 electrons are localized and their spectra is mostly contained in hubbard bands , which are more than @xmath588ev away from the fermi level .",
    "these electrons behave as local magnetic moments . as the temperature",
    "is reduced , the moments combine with the conduction electrons to form a fluid of very heavy quasiparticles , with masses that are two or three orders of magnitude larger then the mass of the electrons .",
    "the low temperature physics of 115 materials is very puzzling .",
    "the heavy fermion physics comes primarily from the ce - in layer .",
    "indeed , the related material cein@xmath589 has only the ce - in layers ( no @xmath587-in layer ) , and also displays a similar heavy fermion properties with superconductivity at very low temperature .",
    "however , 115 materials are very sensitive to the substitution of the transition metal ion in the @xmath587-in layer although co , rh and ir ions have the same valence ( they are isovalent ) .",
    "indeed the three 115 materials have dramatically different low energy properties : cecoin@xmath0 is a superconductor with @xmath590k , cerhin@xmath0 is antiferromagnet with @xmath591k , while ceirin@xmath0 is superconductor with @xmath592 of only @xmath593k .",
    "a fundamental question arises : why are the low energy properties of 115 materials so different",
    "?    a hint to the resolution of this problem was given in ref .",
    ", where the dft+dmft calculation for ceirin@xmath0 indicated that the ce @xmath1 electrons hybridize stronger to the out of plane in-@xmath594 electrons , than the in - plane in @xmath594 electrons .",
    "here we carried out the dft+dmft calculation for all three 115 materials and we show the difference in electronic structure between the three materials .",
    "we used the code based on lda - lmto code of ref .   as well as",
    "the new lapw code based on wien2k  @xcite code .",
    "the results obtained by our dft+dmft method in the two codes are almost indistinguishable . for the impurity solver , we used both oca ( described above ) and ctqmc @xcite . the analytic continuation of ctqmc results was performed with the method described in chapter [ ancont ] .",
    "[ dos]a shows the total density of states ( dos ) and the partial ce-@xmath1 dos for all three materials at low temperature of 7@xmath571k .",
    "the transition metal ion dos is peaked around binding energy 2ev , where the difference of dos is large .",
    "the partial ce-@xmath1 dos of the three compound is very similar , except at the very low energy .",
    "[ dos]b zooms - in the low energy part of the spectra .",
    "we see that ceirin@xmath0 compound has the largest quasiparticle peak , the cecoin@xmath0 follows , while the cerhin@xmath0 has substantially smaller quasiparticle peak at the same temperature of @xmath595k .    our view on the localization - itinerancy in 115 materials",
    "is sketched in fig .",
    "[ sketch ] .",
    "rh compound is most localized , while ir compound is most itinerant .",
    "co compound is similar to ir compound , but slightly less itinerant than ir-115 .",
    "it is well known from the pressure experiments  @xcite that rh compound is more localized then co compound .",
    "namely , under pressure of 1  gpa the rh compound becomes superconducting , and at pressure of @xmath596gpa reaches similar maximum t@xmath597 as is the maximum t@xmath597 of co compound @xcite .",
    "hence the pressure of the order of gpa sufficiently increases the ce-@xmath1 hybridization that it overcome the difference between localization of the electrons in the two compounds .",
    "experimentally it is a bit less clear what is the relation between ir and co compound , since both compounds are superconductors at low t. ir compound has somewhat smaller specific heat coefficient in normal state than co compound ( @xmath598  mj/@xmath599 for ir-115 versus 1000  mj/@xmath599 for co-115 )  @xcite .",
    "ir compound has also somewhat lower resistivity in the normal state @xcite .",
    "moreover , nuclear quadrupol resonance ( nqr ) measurements of @xmath600 @xcite suggest that ir - compound might be more itinerant than other ce - compound . indeed pressurizing the ceirin@xmath0 @xcite along the crystallographic @xmath601-direction , which increases itinerancy @xcite , decreases t@xmath597 .",
    "furthermore , it was shown that cd - doping acts as reverse pressure in 115 s @xcite .",
    "since higher cd - doping is necessary for appearance of antiferromagnetic phase in ceirin@xmath0 than in cecoin@xmath0 , this is also suggestive of more itinerant nature of ir - compound .",
    "our results are thus consistent with the resistivity experiments @xcite , nqr experiments @xcite and recent pressure experiments @xcite , and indicate that ir compound is on the itinerant side of the phase diagram .",
    "hence the low superconducting transition temperature might be connected with too itinerant nature of carriers .",
    "we further analize the difference in itinerancy by plotting the hybridization function at zero frequency @xmath602 resolved in crystal field basis .",
    "the @xmath603 dimensional matrix of hybridizations has a 6 dimensional @xmath604 component and a 9 dimensional @xmath605 component .",
    "the itinerancy ( the quasiparticle peak ) is almost entirely from the @xmath604 component , hence we will not analize @xmath605 part . the degeneracy of the @xmath580 shell is lifted in tetragonal crystal environment and hybridization splits into @xmath606 , @xmath607 and @xmath608 components .",
    "the @xmath608 corresponds to @xmath609 , while @xmath607 and @xmath606 correspond approximately to @xmath610 and @xmath611 , respectively . in fig .",
    "[ 115-hybrid ] we plot the hybridization ( @xmath612/\\pi$ ] ) in polar coordinates with ce atom in the center and in atoms around .",
    "the plot is the cut in @xmath613 direction .",
    "the three dimensional orbitals that correspond to the three crystal fields are plotted in the lower pannel of fig .",
    "[ 115-hybrid ] together with the real space positions of in and ce atoms .",
    "in this decomposition , hybridizations @xmath607 and @xmath606 are pointing towards out of plane in ( in@xmath542 ) and in - plane in ( in@xmath614 ) , respectively .",
    "the third component , @xmath608 is pointing towards transition metal ion .",
    "when comparing hybridization of the three 115 compounds , the ir compound has all three components of the hybridization larger than the other two compounds . in co-115",
    "all three hybridizations are slightly smaller , while in rh-115 all three hybridizations are substantially smaller .",
    "furthermore , comparing the strength of the three components of the hybridization , one can notice that in ir compound the @xmath607 component , pointing towards out - of plane in , is largest .",
    "this is consistent with the experimental finding of oeschler  _ et al . _",
    "@xcite that the grneisen parameters in @xmath601-direction is 2.5 times bigger that in @xmath501 direction , resulting in larger effective coherence scale in @xmath601-direction .    in co",
    "- compund the @xmath607 and @xmath608 components have similar strength , while @xmath606 is smaller , hence the hybridization in @xmath601-direction is still more important than in @xmath615-plane , consistent with grneisen parameter measurements  @xcite .",
    "it was shown in ref .   that the double peak structure of the optical conductivity is directly related to the strength of the two hybridizations .",
    "the hybridization gap in one part of the momentum space is larger , and is primarily due to out of plane in , and the hybridization gap in some other part of momentum space , controled mainly by the in - plane in , is smaller , resulting in double peak structure of the mid - infrared optics peak . optical measurements on cecoin@xmath0 of singley  _ _ et al__@xcite demonstrated very clearly that the mid - infrared peak is split into two peaks , one at @xmath616@xmath617 and one at @xmath618@xmath617 , which can hint towards substantial difference in the two types of hybridization .    finally , in contrast to ir and co compound , rh compound has largest @xmath608 hybridization , followed by @xmath607 and @xmath606 .    in fig .",
    "[ qstm ] we show the frequency dependent hybridization function @xmath619 to demonstrate that the retardation effects in heavy fermion materials are very nontrivial and that the buildup of the quasiparticle peak in spectral function usually results in a sharp peak in hybridization , on the background of the depleted region of hybridization .",
    "the peak is sometimes called the collective hybridization , because it arises from the lattice effects .",
    "namely , the ce-@xmath1 electrons on neighboring atoms also become delocalized , enhancing the hybridization at low energy . however , the spd - electrons need to screen many ce-@xmath1 moments , and therefore the effective @xmath573 hybridization is actually slightly reduced , resulting in depletion away from the fermi level , sometimes called kondo hole .",
    "our results demonstrate that the degree of itinerancy is controlled by the _",
    "collective hybridization _ , encoded into",
    "the weiss mean field hybridization @xmath56 within dmft .",
    "but what is the origin of the difference between the three compounds ? in fig .",
    "[ sketch ] we show the parameters of the lattice structure , namely the ce - in(1 ) distance , the ce - in(2 ) distance and the angle between the cein@xmath589 plane and out of plane in ( in@xmath542 ) . from these numbers ,",
    "it is clear that none of the three quantities follows the trend of itinerancy .",
    "hence the difference in the lattice structure is likely not the key element .    to demonstrate that the difference in the lattice structure is not the driving force",
    ", we performed the dmft calculation for the three compounds using the same lattice structure of ceirin@xmath0 .",
    "the results were very similar to the results plotted in fig .",
    "[ dos ] , with only slight increase in itinerancy of rh compound .",
    "this demonstrates that the chemistry of the transition metal ion ( difference between @xmath10 , @xmath620 and @xmath621 orbitals ) is the driving force of the itinerancy , and not the diffrence in the crystal structure .",
    "the latter are the secondary effects .    since cerhin@xmath0 remains in local moment regime down to very low tempeture of the order of the rkky interaction , it is worth trying to stabilize a magnetic solution within dmft .",
    "to this end , we doubled the unit cell and allowed the comensurate antiferromagnetic ordering with the wave vector @xmath622 . experimentally , the order is a helical spiral with wave vector @xmath623 and @xmath624 of @xmath625k .",
    "the broken symmetry solution can be stabilized below @xmath626k as shown in fig .",
    "[ rh - moment ] .",
    "the magnetization has a typical mean field form , as expected for a theory with spatial mean - field character like dmft .",
    "an interesting question is how does the large moment antiferromagnetic solution change the emerging quasiparticle peak .",
    "we have shown in fig .",
    "[ dos ] that even in more localized cerhin@xmath0 a peak starts to develop at the fermi level by decreasing temperature , hence coherence starts to develop at quite high temperature similar to the other two compounds .",
    "however , the height of the quasiparticle peak is smaller and the scattering rate of ce-@xmath1 orbital ( imaginary part of the self - energy ) is higher in cerhin@xmath0 .",
    "the long range order state develops from a state with a partially screened moment . in fig .",
    "[ rh - dos ] we show the density of states of the two phases , the paramagnetic state and the neel state .",
    "the latter has no quasiparticle peak left and only a very broad background of the @xmath229 spectral weigh remains at the fermi level .",
    "the lower panel of fig .",
    "[ rh - dos ] compares a very coherent quasiparticle peak of ceirin@xmath0 with the partially screened state of cerhin@xmath0 above @xmath627 and in the ordered state below @xmath627 , to emphasize the dramatic difference in the density of state at low energy .",
    "because the full coherence of quasiparticles is not reached to very low temperature in cerhin@xmath0 , and the non - local rkky interaction is strong enough , it interrupts the formation of coherent quasiparticles . within dmft ,",
    "this is reflected in two stable solutions of dmft equations , the paramagnetic and the magnetic solution .",
    "we note that we did not prove the stability of the magnetic solution compared to the paramagnetic solution , because this would require a comparison between free energies , a task beyond our current capabilities .",
    "however , our experience from model calculations suggests that when the magnetic dmft solution can be stabilized , it usually has lower free energy than the nonmagnetic solution .",
    "in the first part of the article , we discussed in detail the implementation of dft+dmft in full potential methods .",
    "we defined the central object of the dmft , the local green s function using a projection operator .",
    "we showed that the projector used in lda+u implementations leads to non - causal dmft equations and that the straightforward projection to the solution of the schrdinger equation within the muffin tin sphere leads to spectral weight loss .",
    "we suggested an alternative projection that resolves these shortcomings .",
    "we sketched the algorithmic steps within an implemention of dft+dmft in the full potential methods , using a formulation which avoids the ambiguities of downfolding or wannier orbital construction .",
    "hence , the kinetic energy operator and electron density are * not approximated * by a tight - binding parameterization , which allowed us to carry out a charge density self - consistent calculation .    in the second part of the article , we concentrated on impurity solvers based on the hybridization expansion .",
    "we derived the equations for the * bold * continuous time quantum monte carlo ( ctqmc ) method , which samples the _ dressed _",
    "propagators , as opposed the bare propagators sampled in current ctqmc methods .",
    "we showed a few test results for simplified implementation of the method . in this part of the article we also gave detailed formulas for the impurity solver called the one - crossing approximation , which can be viewed as the four kink approximation within the bold ctqmc .",
    "finally we give details on a new analytic continuation method , which can continue the self - energy from the imaginary to the real axis .",
    "this step is crucial when computing the response functions within dmft , as done in section  [ transport ] for transport coefficients .    in the third part of the article",
    ", we presented the test results of our dft+dmft implementation on a classical problem of strong correlations , the isostructural transition of elemental cerium from its @xmath371 phase at high temperature to its @xmath370 phase at low temperature .    in the last part of the article",
    ", we applied the dft+dmft method to a group of heavy fermion compounds , namely ceirin@xmath0 , cecoin@xmath0 and cerhin@xmath0 , collectively dubbed the ce-115s . although the isovalent substitution of a transition metal ion does not substantially alter the ce - in planes , which are believed to be responsible for the heavy mass in these compounds , the ground state properties of these materials are very different .",
    "we analyzed the electronic structure of the three ce-115 materials and showed that the ce-@xmath1 electrons in cerhin@xmath0 are more localized that those in the other two 115 compounds , in agreement with experiments .",
    "below @xmath2k , an antiferromagnetic dft+dmft solution in cerhin@xmath0 is stable , while cecoin@xmath0 and ceirin@xmath0 remain paramagnetic ( the afm solution is not stable ) down to the lowest temperature @xmath628k explored in our calculation .",
    "the hybridization in ceirin@xmath0 is very anisotropic with the largest component pointing towards the out - of - plane in .",
    "the hybridization is slightly smaller in cecoin@xmath0 , hence we believe ceirin@xmath0 to be more itinerant than the other two compounds .",
    "we speculate that the reason cecoin@xmath0 exhibits the highest superconducting t@xmath597 is due to the fact that it is at the border between itinerancy and localization , while ceirin@xmath0 is on the itinerant side of the phase diagram and cerhin@xmath0 is on the localized side .",
    "the position of cerhin@xmath0 in the phase diagram is clear from the pressure experiments , while the position of ceirin@xmath0 is less obvious .",
    "we believe that recent uniaxial pressure experiments  @xcite confirm our view , since the @xmath601-axis compression , which makes ceirin@xmath0 more itinerant , decreases the superconducting @xmath592 .",
    "we thank gabriel kotliar for careful reading of the manuscript and numerous usefull suggestions from the early stage of the project till its completion .",
    "we are grateful to jim allen and david pines for fruitful discussion .",
    "k.h was supported by grant nsf nfs dmr-0746395 and dmr-0806937 , and alfred p. sloan fellowship .",
    "c.h.y was funded by nsf dmr-0806937 and k.k . by petroleium research fund 48802-dni10 .",
    "* note added : * as the writing of this work was being completed , we became aware of a related work of m.  aichhorn _ et al .",
    "_ ( arxiv : 0906.3735 ) also reporting on an implementation of lda+dmft in a lapw code .",
    "however , in contrast to our implementation , the authors used downfolding method to obtain a tight - binding model hamiltonian , and hence could not compute electronic charge self - consistently . in the process of downfolding",
    ", the authors used projection @xmath49 defined in section  [ basis_set ] . furthermore , the impurity solver did not take into account the full coulomb interaction eq .",
    "( [ coulombuu ] ) .",
    "only the density - density part of the interaction was considered by m.  aichhorn _ et al .",
    "_ ( only the @xmath525 component of the hund s coupling ) which allows substantial simplification of the impurity solver , but leads to improper description of the multiplet structure of the correlated atoms .",
    "the formulas for tetrahedron integral in case of complex eigenvalues are very similar to the case of real eigenvalues .",
    "however , a special attention needs to be payed to choose the right branch - cut in logarithms , such that all terms in the sum are causal .",
    "first step in tetrahedron method consists of dividing the first brillouin zone into tetrahedra which fill up whole space .",
    "each thrahedra has four corners .",
    "the energy is thus interpolated @xmath629 , where @xmath501 , @xmath3 and @xmath601 run between 0 and 1 when visiting corners of tetrahedra .    for the green s function",
    "we need integral of the form @xmath630 and for the electron density and the chemical potential we need @xmath631    the integral is first written as the sum over all tetrahedra and the integral in the interior of tetrahedra : @xmath632 the latter is evaluated analytically using linear interpolation inside the volume of the tetrahedra for both the nominator and denominator @xmath633 here we used a short notation @xmath634    the integrals are analytic and a closed expression for computing the green s function is @xmath635 where @xmath636\\right\\ } \\ ] ] and @xmath637 means @xmath638 and @xmath639 .",
    "notice that only @xmath640 and @xmath641 can appear in @xmath642 ( not @xmath643 ) to ensure causality .",
    "namely , imaginary part of all @xmath644 is strictly negative , hence the expression @xmath645 contains @xmath646 and @xmath647 , which both have imaginary part in the interval @xmath648 $ ] .",
    "similarly , the formulas for the integral over frequency @xmath649 are @xmath650 where @xmath651 + \\log(x+y ) \\nonumber\\\\ & + & u^3+\\frac{1}{2}u^2-u \\}\\end{aligned}\\ ] ] and @xmath652",
    "to compute the transport coefficients , we need to evaluate to high precision the following integrals @xmath653      the first integral of eq .",
    "( [ p1 ] ) is computed numerically , except in the following cases @xmath657 where @xmath658 is precomputed on a fine mesh and interpolated using cubic spline interpolation .",
    "the constants @xmath659 are @xmath660    the second integral of eq .",
    "( [ p2 ] ) is computed numerically , except in the following cases i ) @xmath661 : in this limit it becomes @xmath662 , ii ) @xmath663 : in this case , the power expansion in terms of @xmath664 is performed and all terms are analytically evaluated .    similarly we treat integral eq .",
    "( [ q2 ] ) . for @xmath655 , @xmath665",
    "we approximate @xmath666 and for @xmath667 we perform the power expansion in terms of @xmath668 and analytically evaluated the resulting integrals .",
    "h.  keiter and j.c .",
    "kimball , int .",
    "j. magn . 1 , 233 , ( 1971 ) .",
    "n.  grewe and h.  keiter , phys .",
    "b * 24 * , 4420 ( 1981 ) .",
    "y.  kuramoto , z. phys .",
    "b * 53 * , 37 ( 1983 ) .",
    "n.  grewe , z. phys .",
    "b * 53 * , 271 ( 1983 ) .",
    "h.  keiter and g.  morandi , phys . rep . *",
    "109 * , 227 ( 1984 ) .",
    "p. coleman , phys .",
    "b * 29 * , 3035 ( 1984 ) .",
    "dft(lmto)+dmft results for various correlated materials are collected in a database available at ` ttp://`auleweb.rutgers.edu / database/ .",
    "the dft(lmto)+dmft code is available for download at the same adress .",
    "the dft(wien2k)+dmft will be posted at the same address .",
    "h. shishido , r. settai , d. aoli , s. ikeda , h. nakawaki , n. nakamura , t. iizuka , y. inada , k. sugiyama , t. takeuchi , k. kindo , t.  c.  kobayashi , y. haga , h. harima , y. aoki , t. namiki , h. sato , and y. nuki , j. phys .",
    "jpn , * 71 * , 162 ( 2002 ) ."
  ],
  "abstract_text": [
    "<S> we implemented the charge self - consistent combination of density functional theory and dynamical mean field theory ( dmft ) in two full - potential methods , the augmented plane wave and the linear muffin - tin orbital methods . </S>",
    "<S> we categorize the commonly used projection methods in terms of the causality of the resulting dmft equations and the amount of partial spectral weight retained . </S>",
    "<S> the detailed flow of the dynamical mean field algorithm is described , including the computation of response functions such as transport coefficients . </S>",
    "<S> we discuss the implementation of the impurity solvers based on hybridization expansion and an analytic continuation method for self - energy . </S>",
    "<S> we also derive the formalism for the bold continuous time quantum monte carlo method . </S>",
    "<S> we test our method on a classic problem in strongly correlated physics , the isostructural transition in ce metal . </S>",
    "<S> we apply our method to the class of heavy fermion materials ceirin@xmath0 , cecoin@xmath0 and cerhin@xmath0 and show that the ce @xmath1 electrons are more localized in cerhin@xmath0 than in the other two , a result corroborated by experiment . </S>",
    "<S> we show that ceirin@xmath0 is the most itinerant and has a very anisotropic hybridization , pointing mostly towards the out - of - plane in atoms . </S>",
    "<S> in cerhin@xmath0 we stabilized the antiferromagnetic dmft solution below @xmath2k , in close agreement with the experimental nel temperature . </S>"
  ]
}