{
  "article_text": [
    "triangles and rectangles have many applications in mathematics , engineering and science .",
    "the finite element method @xcite ( fem ) and the boundary element method @xcite ( bem ) rely especially heavily on triangles and rectangles as basic elements for their discretization procedure . in order to obtain the system of equations with the nodal function values of the elements in fem and bem , numerical or analytical integrations over the elements",
    "are needed .",
    "the main subject of our paper is 3-dimensional electric potential and field calculation of charged triangular and rectangular bem elements .",
    "electric field calculation is important in many areas of physics : electron and ion optics , charged particle beams , charged particle traps , electron microscopy , electron spectroscopy , plasma and ion sources , electron guns , etc .",
    "@xcite . a special kind of electron and ion energy spectroscopy is realized by the mac - e filter spectrometers , where the integral energy spectrum is measured by the combination of electrostatic retardation and magnetic adiabatic collimation .",
    "examples are the mainz and troitsk electron spectrometers @xcite , the aspect proton spectrometer @xcite , and the katrin pre- and main electron spectrometers @xcite .",
    "high accuracy electric field and potential computations are indispensable for precise and reliable charged particle tracking calculations for these experiments . for this purpose the open source c++ codes _ kemfield _ @xcite and _ kassiopeia _ @xcite are used in the katrin and aspect experiments .    for the purpose of electric potential and field computation with bem @xcite",
    ", the surface of the electrodes is discretized by many small boundary elements , and a linear algebraic equation system is obtained for the unknown charge densities of the individual elements . to solve these equations , either a direct or an iterative method is used .",
    "when the charge densities are known , the potential and field at an arbitrary point ( called field point ) can be computed by summing the potential and field contributions of all elements .",
    "the electric potential and field of a single charged element at the field point can be expressed by analytical or numerical integration of the point - charge coulomb formula times the charge density over the element surface . in the simplest case of constant bem element ,",
    "the charge density is assumed to be constant over the element surface .",
    "it is a general belief that analytical integration is more accurate than numerical integration .",
    "this is in many cases true , but not always .",
    "a simple example with one - dimensional integral and small integration interval ( sec . [ sectionanalytical ] ) shows that analytical integration can have a large rounding error , due to the finite arithmetic precision of the computer @xcite , while a simple numerical integration has in this case a much higher accuracy .",
    "analytically calculated electric potential and field formulas of charged triangles and rectangles show a similar behavior for large distance ratios ; the latter is defined as the distance of the element center and the field point divided by the average side length of the element : for field points far from the element the distance ratio is large .",
    "[ sectionanalytical ] presents a few plots for the relative error of the analytical potential and field of triangles and rectangles as a function of the distance ratio .",
    "one can see that for field points far from the element the analytically computed potential and field values have significant rounding errors that are much higher than the machine epsilon of the corresponding arithmetic precision @xcite that is used for the computation .",
    "the analytical integration formulas of refs . @xcite and",
    "@xcite were used for these plots .",
    "there are many other published analytical integration results for potential and field calculation of triangles and rectangles @xcite , and these suffer probably from the same rounding error that increases with the distance ratio .",
    "the rounding errors are caused by the transcendental functions ( e.g. log , atan2 etc . ) in the analytical formulas and by the well - known subtraction cancellation problem of finite - digit floating - point arithmetic computations .",
    "another disadvantage of the analytical integrations is that the analytical potential and field formulas are rather complicated , and consequently the calculations are rather time consuming .",
    "according to the aforementioned simple example with one - dimensional integration , one can eliminate the rounding error problem of the analytical potential and field calculations by using numerical integration .",
    "the two - dimensional numerical integration could be performed by two subsequent one - dimensional integrations , using e.g. the efficient gauss - legendre quadrature method with 16 nodes for each dimension @xcite . if the field point is not too close to the triangle or rectangle , this bi - quadrature method results in very accurate integral values .",
    "in fact , we use this method as a reference integration in order to define the errors of the other integration methods .",
    "nevertheless , if the goal is also to minimize the computation time , then it is more expedient to use the gaussian cubature method for two - dimensional numerical integration , because it has fewer function evaluations for a targeted accuracy . in sec .",
    "[ sectioncubature ] we present a short overview about the numerical integration of an arbitrary function over a triangle or a rectangle with gaussian cubature .",
    "the integral is approximated by a weighted sum of the function values at a given number of gaussian points .",
    "the accuracy of this approximation is defined by the degree of the cubature formula , which usually increases with the number @xmath0 of gaussian points .",
    "appendices a and b contain ten tables of the gaussian points and weights of five different gaussian cubature formulas for triangles and rectangles .",
    "these formulas have various number of gaussian points ( from @xmath1 to @xmath2 ) and degrees of accuracy ( from 3 to 13 ) .    in sec . [ sectionpotentialfield ]",
    "we apply the general gaussian cubature formulas for electric potential and field calculation of triangles and rectangles with constant charge density .",
    "the mathematical formalism of the gaussian cubature integration is illustrated by a nice physical picture : the triangles and rectangles with continuous charge distribution are replaced by discrete point charges , and the complicated two - dimensional integration of the potential - field calculation is substantially simplified by using the potential and field formulas of point charges .",
    "the figures in sec .",
    "[ sectionpotentialfield ] reveal that for field points far from the elements the gaussian cubature method has high accuracy and is exempt from the rounding error problem of the analytical integrations .",
    "the relative error of the potential and field calculation with a given gaussian cubature formula is about @xmath3 above some distance ratio limit ( with double precision computer arithmetics ) , and increases with decreasing distance ratio below this limit , which decreases with increasing number of gaussian points ( i.e. for more accurate cubature formulas ) . for small distance ratios , e.g. @xmath4 ,",
    "the gaussian cubature formulas presented in our paper are not accurate enough , and analytical integration should be used in this region .",
    "[ sectionmanyelements ] contains results for accuracy comparisons of potential and field simulations with two complex electrode geometries containing 1.5 million triangles and 1.5 million rectangles , respectively .",
    "the table in this section shows that the relative errors of the gaussian cubature calculations are much smaller than the errors of the analytical calculations .",
    "in fact , the gaussian cubature relative error values are close to @xmath3 , i.e. the best accuracy that is possible to obtain with the double precision arithmetic that is used in these computations .",
    "[ sectioncomptime ] presents an additional advantage of the gaussian cubature method : the potential and field calculations with low-@xmath0 cubature formulas are significantly faster than the corresponding simulations with analytical integration .",
    "e.g. the 7-point cubature method in cpu computations is about five times faster than the analytical integration method of ref .",
    "@xcite and more than ten times faster than the analytical integration method of ref .",
    ". the larger speed of the gaussian cubature method is due to its simplicity : it needs the evaluation of only one square root and one division operation for each gaussian point , in addition to multiplications and additions , while the analytical integration methods need many time consuming transcendental function evaluations ( like log , atan2 etc . ) .",
    "of course , for the elements with smaller distance ratios the cubature formulas with larger number of points ( e.g. 12 , 19 or 33 ) have to be used ( to get an acceptable accuracy level ) , and they are slower ( although still faster than the analytical methods ) .",
    "nevertheless , the distance ratio distribution plots in sec .",
    "[ sectionmanyelements ] show that for most of the elements of a typical electrode geometry the fast 7-point cubature method can be used .",
    "let us first consider the simple one - dimensional integral of the function @xmath5 from 1 to @xmath6 . the analytical result from the newton - leibniz formula is @xmath7 , and this is for small @xmath8 a typical example for loss of accuracy ( digits ) when subtracting two almost equal numbers .",
    "the problem is that the computer stores in a floating - point arithmetic number always a finite number of digits @xcite , and a few of them can disappear at subtraction .",
    "therefore , the relative error of the above integral for small @xmath8 is much larger than the machine epsilon of the floating - point number system that is used for the computation .",
    "if a high accuracy is required for the integral value with small @xmath8 , it is better to use numerical integration , e.g. gaussian quadrature . with double precision arithmetic and with gauss - legendre quadrature @xcite using 16 x 16 integration nodes , the relative error of the integral is smaller than @xmath3 , i.e. the numerical integration has the maximal precision that is possible to achieve with the corresponding floating - point number system .",
    "one can see this by the independence of the integral value on the number of integration nodes , or by comparing with a higher precision ( e.g. long double ) computation . due to this fact",
    ", we can get the accuracy of the analytical integral values by comparing them with the numerical quadrature values : @xmath9 .",
    "[ figexptest ] presents the relative error @xmath10 of the analytical integral above as a function of @xmath11 , for three different c++ floating - point arithmetic types : float , double and long double . the relative error increases with @xmath11 and decreases with increasing precision of the floating - point arithmetic .",
    "it is then obvious that the analytical integration has a rounding error which can be for small integration interval size @xmath8 much larger than the precision of the floating - point arithmetic type that is used for the calculation .",
    "the numerical integration ( like gaussian quadrature ) is , however , devoid of this precision loss problem .     as function of @xmath11 , for float , double and long double c++ arithmetic types.,scaledwidth=65.0% ]",
    "let us continue now with electric potential and field computation of triangles and rectangles with constant charge density @xmath12 .",
    "the potential @xmath13 and field @xmath14 at field point @xmath15 can be generally written ( in si units ) as surface integrals over the element :    @xmath16    where @xmath17 denotes the integration point on the element surface .",
    "we introduce the distance @xmath18 between the field point @xmath15 and the center point ( centroid ) @xmath19 of the triangle or rectangle : @xmath20 , and the average side length @xmath21 of the triangle or rectangle ( e.g. @xmath22 , with triangle side lengths @xmath23 , @xmath24 and @xmath25 ) .",
    "then , the distance ratio of the element and field point combination is defined as @xmath26 ; this corresponds to the @xmath11 parameter of the one - dimensional integral described above .    in order to investigate the potential and field calculation of triangles and rectangles , we carried out the following procedure",
    ". first , we generated the corner points of triangles or rectangles randomly inside a cube with unit lengths and the direction unit vector of the field point also randomly relative to the triangle or rectangle centroid .",
    "then , for a fixed distance ratio both the element ( triangle or rectangle ) and the field point are defined .",
    "we computed the potential and field of the element with unit charge density at the field point by two different analytical integration methods : first , with refs .",
    "@xcite ( app . a and b ) and @xcite ( app .",
    "a ) , and second , with refs . @xcite ( eqs . 63 and 74 ) and @xcite .",
    "in order to obtain the error of the analytical integrals , we also calculated the potential and field by numerical integration , using two successive one - dimensional gauss - legendre quadratures ( gl2 ) @xcite with @xmath27 integration nodes for both integrations .",
    "if the field point is located not too close to the element ( i.e. for distance ratio above two ) , the latter method yields a relative accuracy which is close to the precision of the applied floating - point arithmetic type ( e.g. order of @xmath3 for double precision in c++ ) .",
    "one can check that the gl2 integral values do not change if the discretization number @xmath28 is changed , and possible rounding errors can be tested by comparing double and long double calculations .",
    "the relative error of the analytically computed potential is then : @xmath29 . for the field",
    "@xmath14 we define the relative error in the following way : @xmath30 , where the sum goes over the components @xmath31 , @xmath32 and @xmath33 .",
    "we generate 1000 elements and field point direction vectors for each distance ratio , and we take the average of the above defined relative error values . in this case",
    "the triangles and rectangles have small ( mainly below ten ) aspect ratios ( ar ) .",
    "the triangle aspect ratio is defined as the longest side length divided by the corresponding height .",
    "similarly , the rectangle aspect ratio is the longer side divided by the shorter side .",
    "figures [ figtriangleanal ] and [ figrectangleanal ] present the above defined averaged relative errors for triangle and rectangle potential and field , computed by the analytical integration formulas of refs .",
    "@xcite , as a function of the distance ratio , for three different floating - point arithmetic types ( float , double and long double of the c++ language ) with low aspect ratio elements , and also for larger ( ar=200 ) aspect ratio elements . for small distance ratio ( below five ) , the relative error values are close to the corresponding floating - point arithmetic precision .",
    "note that our gauss - legendre quadrature implementation has double precision accuracy , therefore the relative error in case of long double precision is not smaller than @xmath3 or so .",
    "furthermore , the plots show that the relative error of the analytical integrals increases with the distance ratio and also with the aspect ratio , while it decreases with increasing precision of the floating - point arithmetic type .",
    "it is obvious that the analytical integrals have significant rounding errors for large distance ratio .",
    "these potential and field errors are even much larger for triangles and rectangles with large aspect ratio , as one can see in fig .",
    "[ figaranalytical ] .",
    "we conjecture that all other analytically integrated potential and field formulas in the literature ( refs .",
    "@xcite ) have similarly large rounding errors for field points located far from the elements .",
    "the rounding error problem of the analytical integration can be solved by using numerical integration for field points far away from the element .",
    "gaussian quadrature and cubature are efficient numerical integration techniques @xcite which can yield high accuracies with a minimal number of nodes ( function evaluation points )",
    ".    the integral of an arbitrary function @xmath34 over a surface element can be generally approximated by gaussian cubature as    @xmath35    where @xmath36 and @xmath37 are the gaussian points ( nodes , knots ) and weights , respectively , and @xmath38 denotes the area of the element .",
    "the remainder @xmath39 is the absolute error of the gaussian cubature integral formula .    to parametrize the gaussian points @xmath36 , it is expedient to use local coordinates : they rely on the element geometry for their definition and",
    "are generally called natural coordinates @xcite . in the case of rectangles",
    ", it is advantageous to use a local coordinate system whose axes are parallel with the side unit vectors @xmath40 and @xmath41 of the rectangle .",
    "an arbitrary point @xmath17 on the plane of the rectangle can be parametrized by the local natural coordinates @xmath31 and @xmath32 :    @xmath42    where @xmath43 denotes the rectangle center , and @xmath23 and @xmath24 are the two side lengths ; see fig .",
    "[ figrectangleq ] . for @xmath44 and @xmath45",
    "the point @xmath17 is inside the rectangle , otherwise it is outside .    for the parametrization of points in a triangle",
    "it is advantageous to use the so - called barycentric or area coordinates .",
    "an arbitrary point @xmath17 on the plane of the triangle can be written as a linear combination of the triangle vertex vectors @xmath46 , @xmath47 and @xmath48 :    @xmath49    where @xmath50 , @xmath51 and @xmath52 are the barycentric coordinates .",
    "they are all less than 1 if the point @xmath17 is inside the triangle . for @xmath53 :",
    "@xmath54 , and for @xmath55 the point @xmath17 is on the line @xmath56 .",
    "@xmath57 corresponds to the centroid of the triangle .",
    "the coordinate @xmath58 is equal to the ratio of the triangle areas @xmath59 and @xmath60 ( and similarly for @xmath51 and @xmath61 ) , as one can see in fig .",
    "[ figtriangleq ] . due to this property ,",
    "the barycentric coordinates are also called area coordinates ( see refs .",
    "@xcite ) .",
    "the computation time of a gaussian cubature formula is proportional to the number of gaussian points ( nodes ) @xmath0 .",
    "a good formula has small error ( remainder @xmath39 in eq .",
    "[ eqcubatureformula ] ) with small @xmath0 .",
    "usually , a two - dimensional gaussian cubature formula is constructed so that it is exact ( with @xmath62 ) for all possible monomials @xmath63 with @xmath64 , but for @xmath65 the remainder @xmath39 is not zero .",
    "the integer @xmath66 is called the degree of the cubature formula .",
    "a large degree @xmath66 corresponds to high accuracy , but the number of nodes @xmath0 , and so the computation time , also increases with @xmath66 .",
    "the definition of the degree above makes it plausible how to determine the nodes and weights for two - dimensional gaussian cubature formulas : first , one calculates the integral ( analytically or numerically ) on the left - hand side of eq .",
    "[ eqcubatureformula ] for several different monomial functions @xmath63 ( with @xmath67 ) .",
    "then , each integral value is set equal to the cubature sum formula on the right - hand side of eq .",
    "[ eqcubatureformula ] ( with @xmath62 ) .",
    "one obtains then the nodes and weights by solving this nonlinear equation system , which is obviously a difficult task , especially for large @xmath0 and @xmath66 .",
    "it is expedient to have all weights positive ( to reduce rounding errors ) and all nodes inside the element .",
    "gaussian point coordinates and weights for triangles and rectangles with various @xmath0 and @xmath66 values can be found in several books @xcite and in many publications @xcite .",
    "examples for very high degree cubature formulas are : @xmath68 for triangles in @xcite , and @xmath69 for rectangles in @xcite .",
    "there are several review papers about the subject in the literature @xcite .    in app .",
    "[ appendixtriangles ] we present barycentric coordinates and weights of five different gaussian cubature formulas for triangles : @xmath70 ( table [ tabletriangle4 ] ) , @xmath71 ( table [ tabletriangle7 ] ) , @xmath72 ( table [ tabletriangle12 ] ) , @xmath73 ( table [ tabletriangle19 ] ) and @xmath74 ( table [ tabletriangle33 ] ) .",
    "[ appendixrectangles ] contains cartesian natural coordinates and weights of five different gaussian cubature formulas for rectangles : @xmath70 ( table [ tablerectangle4 ] ) , @xmath71 ( table [ tablerectangle7 ] ) , @xmath72 ( table [ tablerectangle12 ] ) , @xmath75 ( table [ tablerectangle17 ] ) and @xmath76 ( table [ tablerectangle33 ] ) . in most cases ,",
    "one row in a table corresponds to several nodes with equal weights : the coordinates of the other nodes can be obtained by various permutations or sign changes of the given numbers ( see the table captions for detailed explanations ) .",
    "figures [ figtriangle ] and [ figrectangle ] show a few examples for the gaussian points of a triangle and a rectangle . in fig .",
    "[ figtriangle7 ] , point 1 corresponds to the first row in table [ tabletriangle7 ] ( this is the centroid of the triangle ) .",
    "points 2 to 4 correspond to the second row : for point 2 @xmath77 , for point 3 @xmath78 , and for point 4 @xmath79 ( the other barycentric coordinates are @xmath80 ) . similarly ,",
    "points 5 to 7 correspond to the third row in that table .",
    "these figures can be useful to understand the multiplicity structure of the tables in app .",
    "[ appendixtriangles ] and [ appendixrectangles ] .",
    "the electric potential and field of an arbitrary constant bem element ( with constant charge density @xmath12 ) at a field point @xmath15 can be approximated by gaussian cubature as : @xmath81 where @xmath82 denotes the charge of point @xmath83 , and @xmath84 is the total charge of the element .",
    "we have then a nice and intuitive physical picture of the gaussian cubature formalism : the bem element with continuous charge density is replaced by discrete point charges , whereas the charge @xmath85 at the gaussian point @xmath36 is proportional to the gaussian weight @xmath37 , and the sum of the individual charges @xmath85 is equal to the total charge of the element ( see eq .",
    "[ eqcubatureformula ] ) . obviously , it is much more easier to compute the potential and field produced by point charges instead of continuous charge distributions . as we will see below",
    ", the point charge method is not only easier but also more precise , at least for field points which are not too close to the element .",
    "in addition , the point charge calculation is typically faster than the analytical integration with continuous charge distribution ( see sec . [ sectioncomptime ] ) .    in order to investigate the performance of the gaussian cubature or point charge approximation for potential and field calculation of triangles and rectangles",
    ", we used the same procedure that is described in sec .",
    "[ sectionanalytical ] .",
    "first , for a fixed element and field point , the relative error of the potential computed by gaussian cubature is defined as : @xmath86 , where @xmath87 is computed by two - dimensional gauss - legendre integration .",
    "a similar formula holds for the field error ( see in sec .",
    "[ sectionanalytical ] ) . then , 1000 elements and field point directions are randomly generated for a fixed distance ratio , and the averages of the relative error values are calculated for 500 different distance ratio values from 2 to 10000 .",
    "figures [ figtrianglerwgcubature ] and [ figrectanglerwgcubature ] present the averaged relative error of the potential and field for triangles and rectangles as a function of the distance ratio , for the ten gaussian cubature approximations described in app . [ appendixtriangles ] and [ appendixrectangles ] , together with the relative error of the analytical integration described in refs . @xcite",
    "( with double precision arithmetic type ) .",
    "one can see that , while the relative error of the analytical integration is small for field points close to the element ( small distance ratio ) , and it increases with the distance ratio , the behavior of the gaussian cubature error is just the opposite : it is large for field points near the element , and it decreases with the distance ratio .",
    "in fact , the accuracy of the gaussian cubature at high distance ratio is limited only by the finite - digit computer arithmetic precision .",
    "therefore , it seems that the analytical and numerical integration methods complement each other : to get high accuracy everywhere , one should use analytical integration for field points close to the element and numerical integration farther away .",
    "it is also conspicuous from the figures that the cubature formulas with more gaussian points @xmath0 have higher accuracy and can be used also for field points closer to the elements to obtain a given accuracy level ( e.g. @xmath3 ) .",
    "the computation time for the potential or field simulation by gaussian cubature is approximately proportional to @xmath0 , therefore , in order to minimize the computation time , it is expedient to use several different cubature formulas : for large distance ratio dr one can use a cubature formula with smaller @xmath0 , and for smaller dr one should use a formula with larger @xmath0 .",
    "e.g. to obtain @xmath88 relative accuracy level for the triangle potential , one should use the following cubature formulas in the various distance ratio intervals : @xmath1 for @xmath89 , @xmath90 for @xmath91 , @xmath92 for @xmath93 , @xmath94 for @xmath95 , @xmath2 for @xmath96 , and analytical integration for @xmath4 . in the case of triangle field",
    "these limits are slightly higher .",
    "if both the potential and the field has to be computed for a field point in one computation step , then one should use the limits defined by the field ; namely , in this case the same gaussian points and weights can always be used for both calculations .",
    "we showed in sec .",
    "[ sectionanalytical ] that the relative error of the analytically computed potential and field increases with the triangle and rectangle aspect ratio .",
    "we investigated the aspect ratio dependence also for gaussian cubature .",
    "[ figarcubature ] presents the error of the 7-point gaussian cubature field as a function of the aspect ratio , for dr=300 distance ratio ; the potential error and higher - order gaussian cubatures have a similar behavior .",
    "one can see that the triangle potential and field error of the gaussian cubature increases with the aspect ratio .",
    "therefore , a large number of triangles with high aspect ratios should be avoided in bem calculations , if high accuracy computations are required . on the other hand ,",
    "the gaussian cubature potential and field calculations of rectangles seem not to be sensitive to the rectangle aspect ratio .",
    "finally , we mention that a triangle can be mapped into a rectangle by the duffy transformation @xcite , therefore the numerical integration over a triangle by gaussian cubature can also be done by using the duffy transformation in conjunction with the gaussian cubature formulas for rectangles of app .",
    "[ appendixrectangles ] , instead of the triangle formulas of app .",
    "[ appendixtriangles ] . in this case , however , we get much larger errors for the potential and field of triangles than by using the gaussian cubature formulas for triangles . e.g. the relative error of the triangle field at dr=100 with the duffy transformation and the 7-point rectangle cubature formula is about @xmath97 ,",
    "in contrast with the few times @xmath3 error of the triangle 7-point gaussian cubature formula ( see fig .",
    "[ figtrianglefieldrwgcubature ] ) .",
    "the main goal of potential and field calculation of charged triangles and rectangles is to apply these elements for electric potential and field computations of complex electrode systems with bem .",
    "therefore , it is important to compare the accuracy of the analytical and numerical integration methods not only for individual elements , but also for electrode systems with many elements . in this section , we present results for two electric field simulations : one of them contains only triangles as bem elements , the other one only rectangles . for this purpose , we discretized the main spectrometer vessel and inner electrodes of the katrin experiment first by 1.5 million triangles and second by 1.5 million rectangles , using a dipole electrode potential configuration .",
    "the katrin main spectrometer inner electrode system has a complicated wire electrode system @xcite but in our models the wire electrodes are replaced by full electrode surfaces .",
    "[ figmainspec ] shows a two - dimensional plot ( z - y plane ) of the katrin main spectrometer vessel and inner electrode system . for further details about this spectrometer",
    "we refer to ref .",
    "the dipole electrode model discretizations are explained in detail in ref .",
    "@xcite .",
    "figure [ figardist ] presents the aspect ratio distribution of the two models ( left : triangles , right : rectangles ) .",
    "one can see that especially the triangle model has many triangles with large ( @xmath98 ) aspect ratios .",
    "figure [ figdrdist ] shows the distance ratio distributions for these two models for the central field point @xmath99 . due to the large number of elements and the small element sizes ( relative to typical field point",
    " element distances ) , most of the distance ratio values are above 100 , where the fast 7-point cubature method can be applied .",
    "the electrode discretization has been assembled with the software tool _",
    ", which is a c++ library allowing to define arbitrary three - dimensional electrode geometries in a text file based on the extensible markup language ( xml ) @xcite",
    ". the meshed geometry data , which contains also information on the applied electric potentials , can be automatically created from the input and transferred to the field computation program _ kemfield_. the latter @xcite is a library , written in c++ , which can solve electrostatic and magnetostatic problems with bem .",
    "the electrostatics code part contains several logically separated classes which are responsible for    * computation of boundary integrals over single surface ( mesh ) elements ; * linear algebra routines for determining the charge densities by solving a linear algebraic equation system . * integrating field solver , and * field solving with fast fourier transform on multipoles ( fftm ) @xcite .",
    "_ kemfield _ profits from a very small memory footprint through usage of shell matrices that are not stored in memory , allowing to solve for arbitrary large equation systems with the robin hood iterative method @xcite .",
    "furthermore kemfield profits from libraries and computing languages , like mpi ( messaging parsing interface ) @xcite and opencl @xcite in order to gain computation speed from parallel platforms like multi - core cpus and highly parallel graphical processors .    with the computed charge density values , the electric potential and field at an arbitrary field point can be calculated by summing the potential and field contributions of the individual elements . in order to compare the relative errors of the various field computation methods , we generated randomly 3000 field points inside a cylinder with 9 m length and 3.5 m radius ( centered at the katrin main spectrometer vessel center ) , and we computed the average of the relative errors defined in secs .",
    "[ sectionanalytical ] and [ sectionpotentialfield ] . as reference",
    "potential and field values , we used the gauss - legendre biquadrature method desribed in sec .",
    "[ sectionanalytical ] .",
    "table [ tableerrorcomparison ] summarizes our results for two different analytical methods and for gaussian cubature . in the case of triangles , we performed two calculations : first , with all triangles , and second , using only the small aspect ratio ( @xmath100 ) triangles ( since we showed in secs .",
    "[ sectionanalytical ] and [ sectionpotentialfield ] that both the analytical and the gaussian cubature calculations for triangles are sensitive to the aspect ratio ) .",
    "one can see in table [ tableerrorcomparison ] the following features : a , the gaussian cubature integration method has much smaller relative errors than both analytical integrations : the potential error is practically double precision , while the field error is somewhat larger , but also close to the double precision level ; b , the analytical method 2 ( refs .",
    "@xcite ) has smaller errors than the analytical method 1 ( refs .",
    "@xcite ) ; c , the potential errors are in all cases smaller than the field errors ; d , in case of using only smaller aspect ratio triangles , the errors are smaller than with all ( i.e. also large aspect ratio ) triangles .",
    "we mention here that we tried to reduce the potential and field rounding errors of the 1.5 million elements by kahan summation @xcite , but with no success .",
    "in addition to the large relative potential and field errors , the analytical 1 method of refs .",
    "@xcite has the following problem for the field computation of triangles : at some very sharply defined field points ( e.g. @xmath99 ) the relative field error is extremely large ( more than 10 ) , i.e. the field value is completely wrong , and in some cases one gets nan or inf results ( with c++ compiler ) . only a few triangles ( from the 1.5 million )",
    "are responsible for these wrong field values ( they have small  @xmath100 ",
    "aspect ratio ) .",
    ".average relative error of potential and field simulation of triangles and rectangles at 3000 field points , computed with two different analytical methods and with gaussian cubature .",
    "analytical 1 : refs . @xcite ; analytical 2 : refs .",
    "[ tableerrorcomparison ] [ cols=\"<,^,^,^\",options=\"header \" , ]                                v. m. lobashev , the search for the neutrino mass by direct method in the tritium beta - decay and perspectives of study it in the project katrin , http://dx.doi.org/10.1016/s0375-9474(03)00985-0[_nucl .",
    "a _ , vol .",
    "719 , 153c , 2003 . ]",
    "f. glck et al . , the neutron decay retardation spectrometer aspect : electromagnetic design and systematic effects , http://dx.doi.org/10.1140/epja/i2004-10057-1[_eur .",
    "j. a _ , vol .",
    "23 , 135 , 2005 ; ] s. baessler et al .",
    ", first measurements with the neutron decay spectrometer aspect , http://dx.doi.org/10.1140/epja/i2008-10660-0[_eur .",
    "j. a _ , vol .",
    "38 , 17 , 2008 . ]",
    "j. angrik et al .",
    "( katrin collaboration ) , katrin design report 2004 , http://bibliothek.fzk.de/zb/berichte/fzka7090.pdf[wissenschaftliche berichte fzka 7090 .",
    "] ` http://bibliothek.fzk.de/zb/berichte/fzka7090.pdf ` .",
    "t. j. corona , methodology and application of high performance electrostatic field simulation in the katrin experiment , https://cdr.lib.unc.edu/record/uuid:6f44a9c2-f053-404a-b726-b960d5772619[phd thesis , chapel hill , 2014 . ]                j. formaggio et al . , solving for micro- and macro - scale electrostatic configurations using the robin hood algorithm , http://dx.doi.org/10.2528/pierb11112106[progress in electromagnetics research b 39 , 1 - 37 , 2011 . ]",
    "i. hnninen , m. taskinen , and j. sarvas , singularity subtraction integral formulae for surface integral equations with rwg , rooftop and hybrid basis functions , http://dx.doi.org/10.2528/pier06051901[progress in electromagnetics research 63 , 243278 , 2006 . ]",
    "s. m. rao et al . , a simple numerical solution procedure for statics problems involving arbitrary - shaped surfaces , http://dx.doi.org/10.1109/tap.1979.1142171[ieee transactions on antennas and propagation 27 , 604 - 608 , 1979 . ]    e. e. okon and r. f. harrington , the potential due to a uniform source distribution over a triangular domain , http://dx.doi.org/10.1002/nme.1620180911[international journal for numerical methods in engineering 18 , 1401 - 1419 , 1982 . ]    k. davey and s. hinduja , analytical integration of linear three - dimensional triangular elements in bem , http://dx.doi.org/10.1016/0307-904x(89)90093-0[applied mathematical modelling 13 , 450 - 461 , 1989 . ]    a. tatematsu , s. hamada and t. takuma , analytical expressions of potential and electric field generated by a triangular surface charge with a high - order charge density distribution , http://onlinelibrary.wiley.com/doi/10.1002/eej.1155/pdf[electrical engineering in japan 139 , 9 - 17 , 2002 . ]",
    "s. lopez - pena , a. g. polimeridis , and j. r. mosig , on the analytic - numeric treatment of weakly singular integrals on arbitrary polygonal domains , http://dx.doi.org/10.2528/pier11050504[progress in electromagnetics research , vol .",
    "117 , 339 - 355 , 2011 . ]",
    "a. b. birtles , b. j. mayo and a. w. bennett , computer technique for solving 3-dimensional electron - optics and capacitance problems , http://ieeexplore.ieee.org/stamp/stamp.jsp?tp=&arnumber=5250968[proc .",
    "iee 120 , 213 - 220 , 1973 . ]",
    "erratum : http://ieeexplore.ieee.org/stamp/stamp.jsp?tp=&arnumber=5250991[proc .",
    "iee 120 , 559 , 1973 . ]",
    "s. papanicolopulos , computation of moderate - degree fully - symmetric cubature rules on the triangle using symmetric polynomials and algebraic solving , http://dx.doi.org/10.1016/j.camwa.2015.02.014[computers and mathematics with applications 69 , 650 - 666 , 2015 .",
    "]            p. rabinowitz and n. richter , perfectly symmetric two - dimensional integration formulas with minimal numbers of points , http://dx.doi.org/10.1090/s0025-5718-1969-0258281-4[mathematics of computation 23 , 765 - 779 , 1969 . ]",
    "i. p. omelyan and v. b. solovyan , improved cubature formulae of high degrees of exactness for the square , http://dx.doi.org/10.1016/j.cam.2005.04.005[journal of computational and applied mathematics 188 , 190204 , 2006 . ]",
    "d. a. dunavant , high degree efficient symmetrical gaussian quadrature rules for the triangle , http://dx.doi.org/10.1002/nme.1620210612[international journal for numerical methods in engineering 21 , 1129 - 1148 , 1985 . ]    a. haegemans and r. piessens , construction of cubature formulas of degree eleven for symmetric planar regions , using orthogonal polynomials , http://dx.doi.org/10.1007/bf01462267[numer .",
    "25 , 139 - 148 , 1976 . ]",
    "a. haegemans and r. piessens , construction of cubature formulas of degree seven and nine symmetric planar regions , using orthogonal polynomials , http://dx.doi.org/10.1137/0714029[siam journal on numerical analysis 14 , 492 - 508 , 1977 . ]    m. e. laursen and m. gellert , some criteria for numerically integrated matrices and quadrature formulas for triangles , http://dx.doi.org/10.1002/nme.1620120107[international journal for numerical methods in engineering 12 , 67 - 76 , 1978 . ]                              e. stone , d. gohara , and g. shi , opencl : a parallel programming standard for heterogeneous computing systems , http://dx.doi.org/10.1109/mcse.2010.69[computing in science and engineering , 12 , 66 - 72 , 2010 . ]              j. barrett , j. formaggio and t. j. corona , a method to calculate the spherical multipole expansion of the electrostatic charge distribution on a triangular boundary element , http://dx.doi.org/10.2528/pierb15061904 [ progress in electromagnetics research b 63 , 123 - 143 , 2015 . ]"
  ],
  "abstract_text": [
    "<S> it is a widely held view that analytical integration is more accurate than the numerical one . in some special cases , however , numerical integration can be more advantageous than analytical integration . in our paper </S>",
    "<S> we show this benefit for the case of electric potential and field computation of charged triangles and rectangles applied in the boundary element method ( bem ) . </S>",
    "<S> analytical potential and field formulas are rather complicated ( even in the simplest case of constant charge densities ) , they have usually large computation times , and at field points far from the elements they suffer from large rounding errors . on the other hand , gaussian cubature , which is an efficient numerical integration method , yields simple and fast potential and field formulas that are very accurate far from the elements . </S>",
    "<S> the simplicity of the method is demonstrated by the physical picture : the triangles and rectangles with their continuous charge distributions are replaced by discrete point charges , whose simple potential and field formulas explain the higher accuracy and speed of this method . </S>",
    "<S> we implemented the gaussian cubature method for the purpose of bem computations both with cpu and gpu , and we compare its performance with two different analytical integration methods . </S>",
    "<S> the ten different gaussian cubature formulas presented in our paper can be used for arbitrary high - precision and fast integrations over triangles and rectangles . </S>"
  ]
}