{
  "article_text": [
    "detrended flucuatation analysis ( dfa ) was introduced in a study of long - range dependence in dna sequences @xcite .",
    "it has later been applied in a wide range of scientific disciplines @xcite .",
    "some recent examples are found in scientific studies of climate @xcite , finance @xcite and medicine @xcite .",
    "the most common usage of dfa is to estimate the hurst exponent .",
    "the assumption is then that the input signal has second - moments that are scaling . if this assumption is satisfied the dfa fluctuation function @xmath0 scales as a power - law @xmath9 where @xmath10 denotes the mathematical expectation operator .",
    "important examples of stochastic processes @xmath11 with scaling properties are self - similar and multifractal models , see e.g. @xcite . for this large class of models the existing @xmath12-moments",
    "satisfy @xmath13 .",
    "in particular , if the variance is finite , the second moments are scaling and we define the hurst exponent @xmath2 by the relation @xmath14 .",
    "the power - law of the dfa fluctuation function in this case ( @xmath4 ) has been established empirically .",
    "a mathematical proof has not been published prior to this paper , except for random walks ( @xmath15 ) @xcite .    for stationary stochastic processes",
    "@xmath11 with second - moments that are scaling , the hurst exponent is in the range @xmath3 . for @xmath16 ,",
    "@xmath11 is white noise , while @xmath17 implies an auto - correlation function ( acf ) @xmath18 on the form @xmath19 for @xmath20 the acf is negative for all time lags @xmath21 , while for @xmath22 the acf is positive .",
    "moreover , in the persistent case ( @xmath22 ) , the acf decays so slowly that the series @xmath23 diverges .    in the case of a stationary input signal @xmath11 , with hurst exponent @xmath3 ,",
    ".   has been partly proved .",
    "@xcite constructed a proof for dfa1 .",
    "dfa@xmath24 , or dfa of order @xmath24 , means that a @xmath24th order polynomial is applied in the dfa algorithm ( section [ sec3]a ) . for hurst exponents restricted to the range @xmath25 ,",
    "the proof has been extended to include higher order polynomials @xmath26 @xcite .",
    "we make the new observation that , for @xmath27 , in order for eq .   to be satisfied , it is the exact auto - covariance function ( acvf ) that must be used .",
    "if one instead apply the asymptotic acvf , then @xmath28 .    for stationary signals @xcite showed that the squared dfa fluctuation function is equal , in expectation , to a weighted sum of the acvf @xmath29 : @xmath30 where the weight function @xmath31 will be defined in section  [ sec3 ] .",
    "we present the more general result @xmath32 where @xmath33 ^ 2 $ ] , which also holds for non - stationary stochastic processes with stationary increments .",
    "the quantity @xmath34 is known as the variogram .",
    "we note that the relationship between dfa and the power spectral density was derived , partly based on numerical calculations , in @xcite .",
    "eqs .  and .",
    "have applications beyond proving eq .  .",
    "for instance , one can compute the exact finite - size bias for signals that are scaling , as well as studying dfa for signals that are not scaling .",
    "in @xcite the bias of dfa for stochastic processes with hurst exponents in the range @xmath35 was found by means of monte carlo .",
    "an analytical study of the behaviour of dfa for auto - regressive processes of order one ( ar(1 ) ) was investigated in @xcite .",
    "we demonstrate the use of eqs .  and .   by simple extensions of the aforementioned examples",
    ".    as a final application of the new theory presented in this paper , we propose estimators ( modifications of the dfa fluctuation function ) that can handle missing data in regularly sampled time series . one simple way of handling missing data is to apply linear interpolation , random re - sampling or mean filling .",
    "however , this will typically destroy , or add artificial , correlations to the time series under study .",
    "the effect on dfa using these three gap - filling techniques was examined in @xcite for signals with hurst exponents @xmath3 .",
    "it was found that these interpolation schemes introduced significant deviation from the expected scaling .",
    "in contrast , the modified fluctuation functions we propose have the property of equality in expectation to the fluctuation function in the gap - free case . for the wavelet variance ,",
    "estimators that can handle missing data in a proper statistical way was presented in @xcite .",
    "these wavelet variances are similar in construction to the dfa estimators we present .",
    "this paper is organised as follows . in section  [ sec2 ]",
    "we review the definition of hurst exponent adopted in this paper .",
    "examples of stochastic processes with well - defined hurst exponents are given . in section  [ sec3 ]",
    ", we present the relationship between dfa and acvf / variogram , and the proof of eq .  .",
    "examples of applications are given in section  [ sec3 ] : bias for scaling signals , dfa of ornstein - uhlenbeck processes and modification of the dfa fluctuation function to handle missing data .",
    "let @xmath11 be a stochastic process with mean @xmath36 .",
    "if + i ) @xmath11 is non - stationary with stationary increments and @xmath37 ^ 2\\propto t^{2 h-2 } , \\label{defh1}\\ ] ] or + ii ) @xmath11 is stationary and @xmath38 ^ 2\\propto t^{2 h},\\quad",
    "y(t)=\\sum_{k=1}^t x(k ) , \\label{defh2}\\ ] ] holds , then we define @xmath2 to be the hurst exponent of the process @xmath11 .",
    "the hurst exponent determines the correlation at all time scales .",
    "assume that @xmath11 has hurst exponent @xmath4 , i.e. , @xmath11 is non - stationary .",
    "we have @xmath39 by stationary increments @xmath40 it follows that @xmath41 with @xmath42 and @xmath43 .",
    "the increments @xmath44 have hurst exponent @xmath45 .",
    "the acvf @xmath46 of the increments follows from , and is given by @xmath47 for @xmath48 the increments are white noise , while for @xmath49 the acvf is asymptotically a power - law @xmath50 as @xmath51 .",
    "thus , @xmath52 implies dependent increments . choosing @xmath53 results in negatively correlated increments , while for @xmath54 the increments are persistent .",
    "moreover , in the persistent case , the acvf decays so slowly that the series @xmath55 diverges .      if , in addition to hurst exponents in the range @xmath4 , we require that @xmath11 is gaussian , then this define the class of fractional brownian motions ( fbm s ) whose increments are known as fractional gaussian noises ( fgn s ) @xcite .",
    "an fbm is an example of a self - similar process . by definition self - similar processes @xmath11 , with self - similar exponent @xmath45 ,",
    "satisfy the the scale - invariance @xmath56 with @xmath57 @xcite , and where  @xmath58 \" denotes equality in finite - dimensional distributions .",
    "the class of log - infinitely divisible multifractal processes @xcite also satisify eq .  , but now @xmath59 is random variable with an arbitrarily log - infinitely divisible distribution . the scaling law eq",
    ".   implies @xmath13 .",
    "thus , if the second moments exist the hurst exponent @xmath2 is given by the relation @xmath14 .",
    "these examples are summarised in table  [ t1 ] .",
    "we emphasise that neither multifractality or self - similarity is needed to have a process with well - defined hurst exponent .",
    "an example is the class of smoothly truncated lvy flights ( stlf s ) @xcite . for stlf s",
    "all moments exist , and the property of stationary and independent increments implies a hurst exponent @xmath15 .",
    "the stlf behaves like a lvy flight on small time scales , while on long time scales , the statistics are close to brownian motion @xcite .",
    "thus , it is clearly not self - similar nor multifractal , which was proven in @xcite .",
    ".examples of stochastic processes with well - defined hurst - exponents @xmath2 .",
    "finite variance is assumed in all examples . [ cols=\"<,^\",options=\"header \" , ]",
    "let @xmath60 be the input to dfa .",
    "the first step in dfa is to construct the profile @xmath61 for a given scale @xmath62 one considers windows of length @xmath62 . in each window",
    "a polynomial of degree @xmath24 is fitted to the profile .",
    "subtracting the fitted polynomial from the profile gives a set of residuals . from these residuals",
    "the variance is calculated .",
    "we denote by @xmath63 the residual variance .",
    "the squared fluctuation function @xmath64 is the average of @xmath65 . to express the residual variance mathematically",
    ", we introduce some notation .",
    "define the vector @xmath66^t$ ] .",
    "let @xmath67 be the @xmath68 design matrix in the ordinary least square ( ols ) regression . that is , row @xmath69 of @xmath67 is the vector @xmath70 .",
    "define @xmath71 which is known as the hat matrix in statistics .",
    "the residual variance is given by @xmath72 where @xmath73 is the @xmath74 identity matrix .",
    "for dfa2 ( top figure ) and dfa5 ( bottom figure ) . the weight function @xmath31 is defined in the text . ]",
    "it is convenient to express the squared fluctuation function explicitly in terms of the input series .",
    "let @xmath75^t$ ] .",
    "we define the @xmath76 matrix @xmath77 by letting element @xmath78 of @xmath77 be equal to one if @xmath79 and zero otherwise .",
    "left - multiplying @xmath77 with @xmath80 gives the vector of cumulative sums @xmath81 .",
    "define @xmath82 and let @xmath83 be element @xmath84 of the matrix @xmath85 .",
    "the fluctuation function can be written @xmath86 in the definition of dfa the profile is constructed for the whole time series prior to windowing .",
    "states that constructing the profile in each window gives the same residual variance ( squared fluctuation function ) . a proof is found in appendix  [ va ] . in the sequel",
    "we make the assumption that @xmath87 .",
    "denote by @xmath88 the auto - covariance function ( acvf ) of @xmath11 . applying the expectation operator to eq .",
    ", it is seen that @xmath89    if we add the further restriction of stationarity of the process @xmath11 , eq .",
    "simplifies to eq .  , with @xmath90 and @xmath91 let us note that the weight functions @xmath31 can be computed exactly . in this work",
    "this has been done using mathematica .",
    "the weight function for dfa1 and dfa2 are listed in table  [ tabell2 ] , while the map @xmath92 for dfa2 and dfa5 are shown in fig .",
    "[ fig1 ] .    while eq .   seemingly is time - dependent when @xmath11 is non - stationary with stationary increments , this is not the case . to establish that @xmath93 does not depend on the window @xmath94 , we use the following form of the residual variance @xmath95 ^ 2 , \\label{f3}\\ ] ] with proof found in appendix  [ va ] .",
    "applying the expectation operator to eq .",
    "results in eq .  , with @xmath31 the weight function defined in eq .",
    "we note that eq",
    ".   also holds when @xmath11 is stationary .",
    "since @xmath96 does not depend on the window @xmath94 , it follows that @xmath97 .",
    "c c @xmath24 & @xmath31 + 1 & @xmath98 + 2 & @xmath99 +      c cccccccccccccccccccccc @xmath12 & 0&1 & 2 & 3 & 4 & 5 & 6 & 7 & 8 & 9 & 10 & 11 & 12 & 13 & 14 & 15 +   + 1 & @xmath100 & @xmath101 & @xmath102 & @xmath103 & @xmath104 & @xmath105 + 2 & @xmath106 & @xmath107 & @xmath108 & @xmath109 & @xmath110 & @xmath111&@xmath112 & @xmath113 + 3 & @xmath114 & @xmath115 & @xmath116 & @xmath117&@xmath112 & @xmath118 & @xmath110 & @xmath119 & @xmath104 & @xmath120 + 4 & @xmath121&@xmath101&@xmath122&@xmath123&@xmath104 & @xmath124 & @xmath104 & @xmath125 & @xmath104 & @xmath126 & @xmath110 & @xmath127 + 5 & @xmath128 & @xmath115 & @xmath129 & @xmath130 & @xmath104 & @xmath131 & @xmath104 & @xmath132 & @xmath110 & @xmath133 & @xmath110 & @xmath134 & @xmath104 & @xmath135 + 6 & @xmath136 & @xmath101&@xmath137 & @xmath138&@xmath104 & @xmath139 & @xmath110 & @xmath140 & @xmath110 & @xmath141 & @xmath110 & @xmath142&@xmath104 & @xmath143 & @xmath110 & @xmath144 +    we are now in a position to prove @xmath145 for input signals @xmath11 with hurst exponents @xmath146 .",
    "we assume @xmath147 . in the appendix",
    "we derive the asymptotic weight function @xmath148 , which takes the form @xmath149 expressions for the coefficients @xmath150 can be found in appendix  [ vb ] .",
    "the values of @xmath150 for orders @xmath151 are listed in table  [ tabell3 ] .    for @xmath7 , using eq .   and",
    "the asymptotic weight function , yield the asserted scaling : @xmath152    in the stationary case @xmath3 , using eq .",
    ", we find @xmath153 white noise ( @xmath154 ) is trivial : @xmath155 for @xmath156 , in eq .",
    "the second term dominates the first term .",
    "coupled with the asymptotic form of the acvf we have @xmath157    for @xmath158 the two terms in eq .",
    "scales as @xmath62 . however , the linear term cancels and we end up with the expected scaling : denote by @xmath18 the auto - correlation function ( acf ) , i.e. , @xmath159 .",
    "it is well - known that @xmath160 ( e.g. , @xcite ) .",
    "since @xmath161 , and the acf is a symmetric function , we have @xmath162 .",
    "in @xcite the bias ( of the dfa fluctuation function ) for hurst exponents @xmath164 was found by means of monte carlo . from this bias",
    "they proposed the modified dfa fluctuation function @xmath165 with @xmath166 if we assume @xmath167 is large such that @xmath168 holds ( approximately ) , then @xmath169 which implies @xmath170",
    ".    we can use eq .   to calculate the bias for signals with hurst exponents @xmath3 .",
    "an example is shown in fig .",
    "[ figa]a where we have used @xmath171 .",
    "of course , this give similar result as in @xcite ( see their fig",
    ". 2a ) . using eq .",
    "we can also compute the bias for signals with hurst exponents @xmath4 .",
    "the bias for @xmath172 is shown in fig .",
    "[ figa]b .",
    "the correction functions eq .   for @xmath171 and @xmath172",
    "are shown in fig .",
    "a practical problem is that @xmath173 depends on the ( unknown ) hurst exponent . in @xcite this dependence",
    "was found to be weak for @xmath164 .",
    "based on this finding the authors suggested to use eq .   with the correction function for @xmath16 . while using this modified dfa",
    "will improve the scaling for @xmath174 , it will actually increase the bias for signals with hurst exponents @xmath7 . for @xmath171 and @xmath172 ,",
    "this can be seen from figs .",
    "[ figa ] and [ figb ] , where we observe that the bias has different signs .     and ( b ) @xmath172 . in both figures",
    "( a , b ) the graphs from bottom to top corresponds to dfa of increasing order @xmath24 , from @xmath175 ( bottom ) to @xmath176 ( top ) .",
    "dashed lines are the asymptotic scaling @xmath177 ( see text ) .",
    "the squared fluctuation functions have been shifted by factors @xmath178 . ]     for input signals with hurst exponent ( a ) @xmath171 and ( b ) @xmath172 in both figures ( a , b ) the graphs from bottom to top corresponds to dfa of decreasing order @xmath24 , from @xmath176 ( bottom ) to @xmath175 ( top ) .",
    "the correction functions has been shifted by factors @xmath179 . ]",
    "another application is to study the behaviour of dfa for signals that are not scaling .",
    "here we consider the class of ornstein - uhlenbeck ( ou ) processes .",
    "an ou is the solution to the langevin equation @xmath180 where @xmath181 is a standard ( @xmath182 ) brownian motion , @xmath183 is a scale parameter and @xmath184 is the characteristic correlation time .",
    "we choose initial condition such that @xmath11 is stationary .",
    "this imply that the auto - covariance function takes the form @xmath185 again , we can use eq .   to calculate the expected value of the squared dfa fluctuation .",
    "an example is shown in fig .",
    "[ figou ] .",
    "while ou processes do not have well - defined hurst exponents as defined in section  [ sec2 ] , the second moments scales asymptotically : on long time scales ( @xmath186 ) @xmath11 is white noise , while on short time scales ( @xmath187 ) @xmath11 converges to a brownian motion .",
    "thus , for the dfa fluctuation function we should expect a scaling exponent close to @xmath16 on long time scales .",
    "it is seen in fig .",
    "[ figou ] that this holds . on small time",
    "scales we need to keep in mind that there is a bias in dfa for signals that are scaling .",
    "relevant here is the bias for random walks ( @xmath15 ) . in fig .",
    "[ figou ] it is seen that the ou dfa fluctuation function , with @xmath188 , is consistent with random walks on small time scales .",
    "we note that an ar(1 ) is an discretised ou process , and more results on the ar(1 ) dfa fluctuation function can be found in @xcite .",
    "( blue curve ) .",
    "the red points are dfa1 for random walks ( hurst exponent @xmath15 ) . ]      based on eq .",
    "we can modify dfa to handle missing data .",
    "define @xmath189 to be zero if @xmath11 is missing and one otherwise .",
    "we make the assumption that at least one @xmath190 is non - missing .",
    "a sufficient , but not necessary , condition for this to hold is that at least one window contain no gaps .",
    "let @xmath191 we propose the estimator @xmath192 ^ 2\\times \\nonumber \\\\ & & \\delta(t+k ) \\delta(t+j ) .",
    "\\label{fhat}\\end{aligned}\\ ] ] we define @xmath193 to be the average of @xmath194 ( averaging over the different windows @xmath94 used ) . without missing data the fluctuation function @xmath8 is the same as fluctuation function @xmath0 in the gap - free case . for a time series with gaps",
    ", @xmath8 is equal in expectation to @xmath0 .",
    "the equality @xmath195 holds if the input signal is stationary or non - stationary with stationary increments : applying the expectation operator on eq .",
    "we have @xmath196 and since at least one @xmath197 is assumed non - zero , the equality @xmath195 follows .",
    "an alternative estimator , based on eq .  , is @xmath198 and @xmath199 defined as the average of @xmath200 .",
    "it is straight - forward to verify that @xmath201 for stationary input signals .",
    "however , for input signals that are non - stationary with stationary increments , @xmath202 does not have the desirable property of equality in expectation to the fluctuation function @xmath0 in the gap - free case . as an example , consider a input signal with hurst exponent @xmath4 . in the gap - free case ,",
    "the time - dependent part of the expected squared fluctuation vanish , i.e. , @xmath203 see eq .   in the appendix .",
    "for @xmath200 the time - dependent part will not , in general , vanish .",
    "this is due to the additional multiplicative factors @xmath204 in eq .  .",
    "several new propositions , with proofs , for dfa have been presented .",
    "this include the relationship between the dfa fluctuation function and acvf / variograms , which was derived from the sample forms eqs .   and .",
    "we have proven the power - law scaling of the dfa fluctuation function for stochastic processes with hurst exponents @xmath146 .",
    "these results was derived under the assumption that the input signal in dfa has mean zero .",
    "however , we can replace the assumption of mean zero with a polynomial trend of order @xmath12 , provided @xmath205 .",
    "see appendix  [ v1 ] for a proof .",
    "results on trends not accounted for in dfa can be found in @xcite .",
    "we have demonstrated that the new theory of dfa has applications .",
    "for this purpose we used the weight functions and asymptotic weight functions .",
    "the mathematica code for these functions are found as supplementary material to this article .    some of the theory presented in this paper is probably a suitable starting point to prove the correctness of the multfractal dfa introduced in @xcite , as well as the variance and limiting distribution of the dfa fluctuation function .",
    "this work has received support from the norwegian research council under contract 229754/e10 .",
    "recall the definition of the weight matrix @xmath206 and hat matrix @xmath207 since @xmath208 is a projection matrix , vectors @xmath209 that are in the row - space of @xmath67 will be mapped to itself , i.e. @xmath210 , and thus @xmath211 .",
    "@xmath212 : let @xmath213 be a @xmath214 vector of ones . for @xmath215 @xmath216 the proof is completed by noting that @xmath213 is in the the row - space of @xmath67 .",
    "+   + @xmath212 : this equality holds if @xmath217 fix @xmath69 and consider the sum @xmath218 which is element @xmath69 of the vector @xmath219 .",
    "we have @xmath220 , which is in the row - space of @xmath67 .",
    "thus @xmath221 .",
    "since this holds for all @xmath222 , we can conclude that @xmath223 since @xmath85 is a symmetric matrix we also have @xmath224      we want to show that the relationship between the dfa fluctuation function and acvf / variograms , eqs .   and , and the power - law scaling of the dfa fluctuation function eq .",
    ", remains valid when certain trends is superposed the signal .",
    "let @xmath225 be a stochastic process with mean zero and acvf @xmath88 .",
    "it is assumed that @xmath225 is either stationary or non - stationary with stationary increments .",
    "define @xmath226 where @xmath12 is an integer in the range @xmath227 .",
    "let @xmath228 by eq .",
    "we have @xmath229 since @xmath230 , the middle terms vanish in expectation , and thus @xmath231 we have @xmath232 where @xmath233^t$ ] .",
    "one can use the formulas for sums of powers , e.g. @xcite , to verify that @xmath234 is in the row - space of @xmath67 .",
    "hence @xmath235 and thus @xmath236",
    "the weight matrix can be written @xmath237 where @xmath208 is the hat matrix defined in eq .  .",
    "element @xmath78 of @xmath77 is one if @xmath79 and zero otherwise .",
    "thus , element @xmath78 in the first matrix product is @xmath238 summing the @xmath239th ( sub)-diagonal yield @xmath240    calculating the term @xmath241 is more tedious , but straight - forward .",
    "let us start with the hat matrix @xmath208 .",
    "denote by @xmath242 element @xmath78 of the inverse of @xmath243 . by observing that column @xmath239 of @xmath67",
    "is @xmath244 , we see that @xmath245    @xmath246_{i_1,i_2}= \\sum _ { k_1=i_1}^s \\sum _ { k_2=i_2}^s q_{k_1,k_2}\\nonumber&&\\\\ = \\sum _ { k_1=i_1}^s \\sum _ { k_2=i_2}^s\\sum_{d=1,l=1}^{m+1 }   k_1^{d-1}k_2^{l-1}(b b^t)^{-1}_{d , l}\\nonumber\\\\ \\sim \\sum_{d=1,l=1}^{m+1 }   ( s^{d}-i_1^{d } )   ( s^{l}-i_2^l)/(dl)(b b^t)^{-1}_{d , l } \\label{dhd}\\end{aligned}\\ ] ]                  22ifxundefined [ 1 ] ifx#1 ifnum [ 1 ] # 1firstoftwo secondoftwo ifx [ 1 ] # 1firstoftwo secondoftwo `` `` # 1''''@noop [ 0]secondoftwosanitize@url [ 0 ]  + 12$12  & 12#1212_12%12@startlink[1]@endlink[0]@bib@innerbibempty @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop _ _  ( ,  ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop _ _ ,  vol .",
    "( ,  ) @noop * * ,   ( ) @noop * * ,   ( ) @noop `` , ''"
  ],
  "abstract_text": [
    "<S> the scaling function @xmath0 in detrended fluctuation analysis ( dfa ) scales as @xmath1 for stochastic processes with hurst exponents @xmath2 . </S>",
    "<S> we prove this scaling law for both stationary stochastic processes with @xmath3 , and non - stationary stochastic processes with @xmath4 . </S>",
    "<S> for @xmath5 we observe that using the asymptotic ( power - law ) auto - correlation function ( acf ) yield @xmath6 . </S>",
    "<S> we also show that the fluctuation function in dfa is equal in expectation to : i ) a weighted sum of the acf ii ) a weighted sum of the second order structure function . </S>",
    "<S> these results enable us to compute the exact finite - size bias for signals that are scaling , as well as studying dfa for signals that do not have power - law statistics . </S>",
    "<S> we illustrate this with examples , where we find that a previous suggested modified dfa will increase the bias for signals with hurst exponents @xmath7 . as a final application of the new theory , we present an estimator @xmath8 that can handle missing data in regularly sampled time series without the need for interpolation schemes . under mild regularity conditions , @xmath8 is equal in expectation to the fluctuation function @xmath0 in the gap - free case . </S>"
  ]
}