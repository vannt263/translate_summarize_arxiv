{
  "article_text": [
    "non - local means ( nlm ) is a data - driven diffusion mechanism that was introduced by buades et al . in @xcite .",
    "it has proved to be a simple yet powerful method for image denoising . in this method",
    ", a given pixel is denoised using a weighted average of other pixels in the ( noisy ) image . in particular , given a noisy image @xmath0 , the denoised image @xmath1 at pixel @xmath2 is computed using the formula @xmath3 where @xmath4 is some weight ( affinity ) assigned to pixels @xmath2 and @xmath5 .",
    "the sum in is ideally performed over the whole image . in practice , however , one restricts @xmath5 to a geometric neighborhood of @xmath2 , e.g. , to a sufficiently large window of size @xmath6 @xcite .",
    "the central idea in @xcite was to set the weights using image patches centered around each pixel , namely as @xmath7 where @xmath8 and @xmath9 are the image patches of size @xmath10 centered at pixels @xmath2 and @xmath5 . here",
    ", @xmath11 is the euclidean norm of patch @xmath12 as a point in @xmath13 , and @xmath14 is a smoothing parameter .",
    "thus , pixels with similar neighborhoods are given larger weights compared to pixels whose neighborhoods look different .",
    "the algorithm makes explicit use of the fact that repetitive patterns appear in most natural images .",
    "it is remarkable that the simple formula in often provides state - of - the - art results in image denoising @xcite .",
    "one outstanding feature of nlm is that , in comparison to other denoising techniques such as gaussian smoothing , anisotropic diffusion , total variation denoising , and wavelet regularization , the so - called method noise ( difference of the denoised and the noisy image ) in nlm appears more like white noise @xcite .",
    "we refer the reader to @xcite for a detailed review of the algorithm .",
    "the rest of the letter is organized as follows . in section [ s2 ]",
    ", we explain how the denoising performance of nlm can be improved in the vicinity of edges using the euclidean median .",
    "based on this observation , we propose a new denoising algorithm in section [ s3 ] and discuss its implementation .",
    "this is followed by some preliminary denoising results in section [ s4 ] , where we compare our new algorithm with nlm .",
    "we conclude with some remarks in section [ s5 ] .",
    "the denoising performance of nlm depends entirely on the reliability of the weights @xmath4 .",
    "the weights are , however , computed from the noisy image and not the clean image .",
    "noise affects the distribution of weights , particularly when the noise is large . by noise ,",
    "we will always mean zero - centered white gaussian noise with variance @xmath15 in the rest of the discussion .",
    "+    to understand the effect of noise and to motivate the main idea of the paper , we perform a simple experiment .",
    "we consider the particular case where the pixel of interest is close to an ( ideal ) edge .",
    "for this , we take a clean edge profile of unit height and add noise ( @xmath16 ) to it .",
    "this is shown in fig .",
    "we now select a point of interest a few pixels to the right of the edge ( marked with a star ) .",
    "the goal is to estimate its true value from its neighboring points using nlm .",
    "to do so , we take 3-sample patches around each point ( @xmath17 ) , and a search window of @xmath18 . the patches are shown as points in @xmath19-dimensions in fig [ fig3 ] .",
    "the clean patch for the point of interest is at @xmath20 .",
    "we now use to compute the weights , where we set @xmath21 .",
    "the weights corresponding to the point of interest are shown in fig .",
    "[ fig2 ] . using the noisy weights",
    ", we obtain an estimate of around @xmath22 .",
    "this estimate has a geometric interpretation .",
    "it is the center coordinate of the euclidean mean @xmath23 , where @xmath24 are the weights in fig .",
    "[ fig2 ] , and @xmath9 are the patches in fig .",
    "the euclidean mean is marked with a purple diamond in fig .",
    "[ figii ] .",
    "note that the patches drawn from the search window are clustered around the centers @xmath25 and @xmath26 .",
    "for the point of interest , the points around @xmath27 are the outliers , while the ones around @xmath28 are the inliers .",
    "the noise reduces the relative gap in the corresponding weights , causing the mean to drift away from the inliers toward the outliers .",
    "+    note that the euclidean mean is the minimizer of @xmath29 over all patches @xmath12 .",
    "our main observation is that , if we instead compute the minimizer of @xmath30 over all @xmath12 , and take the center coordinate of @xmath12 , then we get a much better estimate .",
    "indeed , the denoised value turns out to be around @xmath31 in this case .",
    "the above minimizer is called the euclidean median ( or the geometric median ) in the literature @xcite",
    ". we will often simply call it the median .",
    "we repeated the above experiment using several noise realizations , and consistently got better results using the median .",
    "averaged over @xmath32 trials , the denoised value using the mean and median were found to be @xmath33 and @xmath34 , respectively . indeed , in fig .",
    "[ figii ] , note how close the median is to the true patch compared to the mean .",
    "this does not come as a surprise since it is well - known that the median is more robust to outliers than the mean .",
    "this fact has a rather simple explanation in one dimension . in higher dimensions ,",
    "note that the former is minimizer of ( the square of ) the weighted @xmath35 norm of the distances @xmath36 , while the latter is the minimizer of the weighted @xmath37 norm of these distances .",
    "it is this use of the @xmath37 norm over the @xmath35 norm that makes the euclidean median more robust to outliers @xcite .",
    "following the above observation , we propose algorithm [ algo1 ] below which we call the non - local euclidean medians ( nlem ) . we use @xmath38 to denote the search window of size @xmath6 centered at pixel @xmath2 .    * input * : noisy image @xmath0 , and parameters @xmath39 .",
    "* return * : denoised image @xmath1 .",
    "( 1 ) estimate noise variance @xmath15 , and set @xmath40 ( 2 ) extract patch @xmath41 at every pixel @xmath2 . ( 3 ) for every pixel @xmath2 , do ( a ) set @xmath42 for every @xmath43 .",
    "( b ) find patch @xmath12 that minimizes @xmath44 .",
    "( c ) assign @xmath45 the value of the center pixel in @xmath12 .",
    "the difference with nlm is in step @xmath46b which involves the computation of the euclidean median .",
    "that is , given points @xmath47 and weights @xmath48 , we are required to find @xmath49 that minimizes the convex cost @xmath50 .",
    "there exists an extensive literature on the computation of the euclidean median ; see @xcite , and the references therein .",
    "the simplest algorithm in this area is the so - called weiszfeld algorithm @xcite .",
    "this is , in fact , based on the method of iteratively reweighted least squares ( irls ) , which has received renewed interest in the compressed sensing community in the context of @xmath37 minimization @xcite . starting from an estimate @xmath51 ,",
    "the idea is to set the next iterate as @xmath52 this is a least - squares problem , and the minimizer is given by @xmath53 where @xmath54 .",
    "starting with an initial guess , one keeps repeating this process until convergence . in practice , one needs to address the situation when @xmath51 gets close to some @xmath55 , which causes @xmath56 to blow up . in the weiszfeld algorithm ,",
    "one keeps track of the proximity of @xmath51 to all the @xmath55 , and @xmath57 is set to be @xmath58 if @xmath59 for some @xmath2 .",
    "it has been proved by many authors that the iterates converge globally , and even linearly ( exponentially fast ) under certain conditions , e.g. , see discussion in @xcite .",
    "following the recent ideas in @xcite , we have also tried regularizing by adding a small bias , namely by setting @xmath60 .",
    "the bias @xmath61 is updated at each iterate , e.g. , one starts with @xmath62 and gradually shrinks it to zero .",
    "the convergence properties of a particular flavor of this algorithm are discussed in @xcite .",
    "we have tried both the weiszfeld algorithm and the one in @xcite .",
    "experiments show us that faster convergence is obtained using the latter , typically within @xmath19 to @xmath63 steps .",
    "the overall computational complexity of nlem is @xmath64 per pixel , where @xmath65 is the average number of irls iterations .",
    "the complexity of the standard nlm is @xmath66 per pixel .",
    "we now present the result of some preliminary denoising experiments . for this , we have used the synthetic images shown in fig .",
    "[ figiii ] and some natural images . for nlem , we computed the euclidean median using the simple irls scheme described in @xcite . for all experiments ,",
    "we have set @xmath67 , and @xmath68 for both algorithms .",
    "these are the standard settings originally proposed in @xcite .",
    "first , we considered the _ checker _ image",
    ". we added noise with @xmath69 resulting in a peak - signal - to - noise ratio ( psnr ) of @xmath70 .",
    "the psnr improved to @xmath71 after applying nlm , and with nlem this further went up to @xmath72 ( averaged over @xmath32 noise realizations ) .",
    "this @xmath73 improvement is perfectly explained by the arguments provided in section [ s2 ] .",
    "indeed , in fig.[fig6 ] , we have marked those pixels where the estimate from nlem is significantly closer to the clean image than that obtained using nlm .",
    "more precisely , denote the original image by @xmath74 , the noisy image by @xmath75 , and the denoised images from nlm and nlem by @xmath45 and @xmath76 .",
    "then the `` + '' in the figure denotes pixels @xmath2 where @xmath77 .",
    "note that these points are concentrated around the edges where the median performs better than the mean .",
    "so what happens when we change the noise level ?",
    "we went from @xmath78 to @xmath79 in steps of @xmath32 .",
    "the plots of the corresponding psnrs are shown in fig .",
    "[ fig8 ] . at low noise levels ( @xmath80 ) , we see that nlm performs as good or even better than nlem . this is because at low noise levels the true neighbors in patch space are well identified , at least in the smooth regions .",
    "the difference between them is then mainly due to noise , and since the noise is gaussian , the least - squares approach in nlm gives statistically optimal results in the smooth regions . on the other hand , at low noise levels , the two clusters in fig .",
    "[ figii ] are well separated and hence the weights @xmath4 for nlm are good enough to push the mean towards the right cluster .",
    "the median and mean in this case are thus very close in the vicinity of edges . at higher noise levels",
    ", the situation completely reverses and nlem performs consistently better than nlm . in fig .",
    "[ fig8 ] , we see this phase transition occurs at around @xmath81 .",
    "the improvement in psnr is quite significant beyond this noise level , ranging between @xmath82 and @xmath83 .",
    "the exact psnrs are given in table [ table1 ] .",
    "+    next , we tried the above experiment on the _ circles _ image .",
    "the results are given in table [ table1 ] .",
    "the phase transition in thsi case occurs around @xmath84 .",
    "nlm performs significantly better before this point , but beyond the phase transition , nlem begins to perform better , and the gain in psnr over nlm can be as large as @xmath85 . the method noise for nlm and nlem obtained from a typical denoising experiment",
    "are shown in fig .",
    "[ figvi ] .",
    "note that the method noise for nlem appears more white ( with less structural features ) than that for nlm .    finally , we considered some benchmark natural images , namely _ house _ , _ barbara _ , and _ lena_.",
    "the psnrs obtained from nlm and nlem for these images at different noise levels are shown in table [ table1 ] .",
    "the table also compares the structural similarity ( ssim ) indices @xcite obtained from the two methods .",
    "note that a phase transition in ssim is also observed for some of the images . in fig .",
    "[ fig7 ] , we show the pixels where nlem does better ( in the sense defined earlier ) than nlm for the _ house _ image at @xmath86 . we again see that these pixels are concentrated around the edges",
    ".    the improvements in psnr and ssim are quite dramatic for the synthetic images _ checker _ and _",
    "circles_. this is expected because they contain many edges and the edges have large transitions .",
    "the improvement in psnr and ssim are less dramatic for the natural images .",
    "but , considering that nlm already provides top quality denoising results , this small improvement is already significant .",
    "we have also noticed that the performance of nlem ( and that of nlm ) can be further improved by considering only the top @xmath87 of the @xmath88 neighbors with largest weights .",
    "this simple modification improves both nlm and nlem ( and also their run time ) , while still maintaining their order in terms of psnr performance .",
    "a comparison of the four different methods is given in fig .",
    "the results provided here are rather incomplete , but they already provide a good indication of the denoising potential of nlem at large noise levels . while we have considered a fixed setting for the parameters , our general observation based on extensive experiments is that nlem consistently performs better than nlm beyond the phase transition , irrespective of the parameter settings . in future , we plan to investigate ways of further improving nlem , and study the effect of the parameters on its denoising performance .",
    "[ cols=\"<,^ , > , > , > , > , > , > , > , > , > , > \" , ]     l c rrrrrrrrrr    & & + & nlm & * 99.41 & * 98.66 & 97.59 & 95.51 & 92.32 & 88.35 & 83.37 & 78.05 & 72.31 & 66.47 + & nlem & 99.36 & 98.51 & * 97.60 & * 96.30 & * 94.03 &",
    "* 91.18 & * 87.81 & * 84.04 & * 79.59 & * 74.51 + * * * * * * * * * *    & nlm & * 96.31 & * 94.02 & * 91.43 & 88.66 & 85.79 & 82.49 & 78.28 & 73.28 & 68.13 & 63.54 + & nlem & 95.28 & 93.60 & 91.20 & * 88.74 & * 86.30 & * 83.75 & * 80.90 & * 77.85 & * 74.21 & * 70.21 + * * * * * * * * * *    & nlm &",
    "* 86.90 & * 81.80 & 76.93 & 72.97 & 69.57 & 66.86 & 64.38 & 62.24 & 60.33 & 58.55 + & nlem & 86.86 & 81.25 & * 77.61 & * 73.85 & * 70.51 & * 67.77 & * 65.21 & * 62.96 & * 60.97 & * 59.03 + * * * * * * * * * *    & nlm & 89.95 & 79.48 & 71.32 & 65.20 & 60.79 & 57.42 & 54.64 & 52.58 & 50.78 & 49.27 + & nlem & * 90.25 & * 80.38 & * 72.49 & * 66.48 & * 62.04 & * 58.57 & * 55.64 & * 53.45 & * 51.50 & * 49.86 + * * * * * * * * * *    & nlm & 86.95 & 80.41 & 76.45 & 73.42 & 70.80 & 68.45 & 66.46 & 64.66 & 62.94 & 61.32 + & nlem & * 87.06 & * 80.57 & * 76.77 & * 73.97 & * 71.50 & * 69.21 & * 67.20 & * 65.32 & * 63.52 & * 61.81 + * * * * * * * * * *    [ table1 ]",
    "the purpose of this note was to communicate the idea that one can improve ( often substantially ) the denoising results of nlm by replacing the @xmath35 regression on patch space by the more robust @xmath37 regression .",
    "this led us to propose the nlem algorithm .",
    "the experimental results presented in this paper reveal two facts : ( a ) phase transition phenomena  nlem starts to perform better ( in terms of psnr ) beyond a certain noise level , and ( b ) the bulk of the improvement comes from pixels close to sharp edges .",
    "the latter fact indicates that nlem is better suited for denoising images that have many sharp edges .",
    "this suggests that we could get similar psnr improvements if we simply used nlem in the vicinity of edges and the less expensive nlm elsewhere .",
    "unfortunately , it is difficult to get a reliable edge map from the noisy image .",
    "on the other hand , observation ( b ) suggests that , by comparing the denoising results of nlm and nlem , one can devise a robust method of detecting edges at large noise levels .",
    "we note that wang et al .",
    "have recently proposed a non - local median - based estimator in @xcite .",
    "this can be considered as a special case of nlem corresponding to @xmath89 , where single pixels ( instead of patches ) are used for the median computation . on the other hand ,",
    "some authors have proposed median - based estimators for nlm where the noisy image is median filtered before computing the weights @xcite . in fact , most of the recent innovations in nlm were concerned with better ways of computing the weights ; e.g. , see @xcite , and reference therein .",
    "it would be interesting to see if the idea of robust euclidean medians could be used to complement these innovations .",
    "i. daubechies , r. devore , m. fornasier , c. s. gunturk `` iteratively reweighted least squares minimization for sparse recovery , '' communications on pure and applied mathematics , vol .",
    "63 , pp . 1 - 38 , 2009 .",
    "c. chung , r. fulton , d. d. feng , s. meikle , `` median non - local means filtering for low snr image denoising : application to pet with anatomical knowledge , '' ieee nuclear science symposium conference record , pp . 3613 - 3618 , 2010 .",
    "z. wang , a. c. bovik , h. r. sheikh , e. p. simoncelli , `` image quality assessment : from error visibility to structural similarity , '' ieee transactions on image processing , vol .",
    "600 - 612 , 2004 ."
  ],
  "abstract_text": [
    "<S> in this letter , we note that the denoising performance of non - local means ( nlm ) at large noise levels can be improved by replacing the mean by the euclidean median . </S>",
    "<S> we call this new denoising algorithm the non - local euclidean medians ( nlem ) . at the heart of nlem </S>",
    "<S> is the observation that the median is more robust to outliers than the mean . in particular , we provide a simple geometric insight that explains why nlem performs better than nlm in the vicinity of edges , particularly at large noise levels . </S>",
    "<S> nlem can be efficiently implemented using iteratively reweighted least squares , and its computational complexity is comparable to that of nlm . </S>",
    "<S> we provide some preliminary results to study the proposed algorithm and to compare it with nlm .    </S>",
    "<S> * keywords : * image denoising , non - local means , euclidean median , iteratively reweighted least squares ( irls ) , weiszfeld algorithm . </S>"
  ]
}