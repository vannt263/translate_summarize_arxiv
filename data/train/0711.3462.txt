{
  "article_text": [
    "the problem of optimal `` map - making '' or `` image reconstruction '' is complex and multi - faceted , with the basic procedures and even the terminology differing dramatically between different sub - fields of astronomy .",
    "the method adopted depends on the form in which the data are gathered , and on the dominant source of systematic effects . from the optical to the near - ir one talks about combining `` frames '' , along with measurements of `` darks '' and `` flat - fields '' . for the reduction of cosmic microwave background ( cmb ) data",
    "the now conventional method is to start from the principle that there is a linear algebra approach to solving the maximum likelihood problem .",
    "however , this has only been feasible up until now because of the limited number of detectors in the typical cmb experiment , and the fact that correlated signals among the detectors can be effectively ignored .",
    "because of the rapid development of large bolometer arrays , the question which arises is : how does one adapt the cmb approach to dealing with substantial numbers of detectors , and where there are significant cross - correlations of noise between the detector timestreams .",
    "data from the balloon - borne large aperture submillimeter telescope ( blast , devlin et al .",
    "2004 ) represent a new challenge for bolometric timestream - to - map algorithms .",
    "recent cmb experiments which use detectors similar to those used on blast , such as boomerang @xcite and archeops @xcite , only use a handful of separate bolometers .",
    "furthermore , these experiments off - axis designs lead to small correlations between detectors .",
    "consequently , the correlations could be ignored at the map - making stage , and each detector timestream could be treated as an independent sub - set of the data .",
    "this has changed for blast , which has up to 139 detectors per band , with significant correlations induced by the on - axis design , as well as the higher frequencies of the observations . just by itself ,",
    "the large number of channels increases the impact of even small time stream correlations , the contribution from which does not integrate down with increasing number of detectors , unlike the uncorrelated noise .",
    "the high level of correlation ( largely induced by temperature drifts in the obscuring secondary supports in blast ) make it important that the correlations be handled carefully in the map - making process .",
    "this paper describes a signal and noise estimation procedure including correlations ( sanepic ) which has been developed for the analysis of blast .",
    "this algorithm will also have application to many next generation experiments which will involve both noise correlations between channels ( including correlations from the atmosphere ) and very large numbers of detectors .",
    "this includes the next generation of larger - format arrays for use in ground- and balloon - based instruments at microwave and millimeter wavelengths , which will have typically thousands of detectors .",
    "this paper is arranged as follows .",
    "we next describe the pertinent aspects of blast . in section  3 , the longest section",
    ", we set out our basic map - making method .",
    "simulations we use for testing the method are described in section  4 , with results presented in section  5 , demonstrating the benefit of accounting for the correlated noise in blast - like observations . finally some of the maps obtained from the june 2005 blast flight are presented in section  6 .",
    "the map - making procedure presented in this paper has been used to analyze the data from the blast 2005 flight .",
    "we will use blast as a specific example for the application of sanepic throughout the paper .",
    "we describe blast in section  [ sub : blast ] , we then summarize the pre - processing of the data prior to map - making in section [ sub : process ] . in section  [ sub : model ] , we derive a model of the data that we will use for the map - making .      the balloon - borne large - aperture submillimeter telescope incorporates a 2-m primary mirror , and large format bolometer arrays operating at 250 , 350 , and 500@xmath0 m , designed to have 144 , 96 and 48 bolometers , respectively ( of which 139 , 88 and 43 , respectively , were used ) . the instrument is described in detail in @xcite .",
    "the low atmospheric opacity at the operating altitude of @xmath1 km allows blast to map the sky very quickly compared to ground - based experiments and to conduct large area shallow surveys as well as very deep surveys of the sky @xcite .",
    "the blast wavelengths are near the peak of the spectral energy distribution of cold galactic dust , which gives blast the ability to conduct unique extragalactic and galactic submillimeter surveys with high spatial resolution and sensitivity .",
    "blast thus enables studies of the distribution of very high - redshift galaxies and of star forming regions in our galaxy .",
    "the typical observing strategy consists of scanning the telescope back and forth in azimuth , covering the entire field by slowly varying the elevation .",
    "cross - linking of the data is assured by scanning the same field at another time of the day .",
    "typical scanning strategies are given in @xcite .",
    "the first scientific flight of blast took place in june 2005 from the esrange arctic base in sweden to the canadian arctic .",
    "a total of @xmath2 100 hours of data were taken in a variety of galactic fields .",
    "they include a star forming region ( vulpecula ) over @xmath3 , described in @xcite , three other fields of similar size in the galactic plane ( which will be the focus of future papers ) , an integration towards the elais - n1 field ( see oliver et al .",
    "2000 ) , the cas a  supernovae remnant over about @xmath4 ( hargrave et al .  in preparation ) , and several compact galactic and extra - galactic sources @xcite .",
    "hereafter we refer to these as the blast05 data , to distinguish them from the data taken during the december 2006 antarctic flight .",
    "the processing of blast data from detector timestreams to the final map product involves several steps prior to map - making .",
    "each of these steps is designed to remove a particular ( or several ) artifact(s ) from the data , and sometimes requires iterating , since some effects need to be removed simultaneously . in the following ,",
    "we summarize the main processing stages leading to the time - ordered segments which are used as inputs for the map - making process .",
    "we start by identifying events in the data which are sharply localized in time , such as spikes from cosmic rays hits and other spurious sources .",
    "we use a method which allows us to discriminate between the different events depending on their signature in the data .",
    "spikes which involve only a single sample are flagged and the corrupted samples are replaced by the average value of the samples in the vicinity .",
    "the data are deconvolved from the low - pass filter applied by the readout electronics .",
    "this filter has a frequency cut off of approximately @xmath5hz and is designed to avoid high frequency noise aliasing .",
    "the deconvolution is performed in fourier space .",
    "in addition , we have applied a low - pass cosine filter which limits the noise power from increasing at very high frequency ( above @xmath6hz ) due to deconvolution .",
    "we have checked that the noise power spectrum is relatively flat after these deconvolution operations .",
    "finally , cosmic ray hits and other localized artifacts in the data timestreams are detected and cut out .",
    "in order to avoid biasing our data products by having systematically more false event detections located where the sky is bright ( e.g. ,  when scanning a point source ) , we iterate this process  we make maps starting from data which has been cleaned using the process described above , subtract the maps from each original data - set , and reprocess the data .",
    "the maps calculated at this intermediate stage are obtained by simply rebinning the data into pixels after strongly high - pass filtering .",
    "the filter applied is a butterworth filter with a frequency cut off of @xmath7hz , which is of the order of the knee frequency of the noise . even if this operation suppresses most of the intermediate to large scales of the sky signal in the maps ,",
    "it does not very much alter the signal from localized sources , at least to the level of accuracy needed at this stage , and it has the advantage of removing most of the stripes in the maps due to @xmath8 noise .",
    "we have verified that the resulting bias for bright calibrators is less than 1% .",
    "about 2% of the data from the blast05 flight was removed due to cosmic ray events .",
    "most of the events affected a single detector timestream , although some events affected a whole array at the same time .",
    "detected spikes ( from cosmic rays but also other spurious effects ) are flagged over small time intervals of typically 1  second in the data .",
    "one second is too large an interval to simply ignore , so the corrupted data need to be replaced with random noise generated in a way that as much as possible preserves the statistical properties of the data . in the later map - making stage , which is partly performed in fourier space , we assume continuity of the data",
    ". we could perform this gap - filling with a constrained noise realization ( see e.g. , stompor et al .",
    "however , since the gap intervals are significantly smaller than the inverse of the knee frequency of the noise power spectrum ( @xmath9hz ) , the noise can be well approximated by the sum of a white component plus a straight line of some slope across the gap .",
    "specifically , we generate white noise in each gap with a standard deviation measured from the data in the vicinity of the gap , and add a baseline with the parameters fit using 20 samples on each side .",
    "the white noise generation is for restoring as best as possible the stationarity of the data ( generated samples are not reprojected to the map at the end ) .",
    "after having filled the gaps in the timestreams , we filter out very low frequency drifts which are poorly accounted for in the map - making procedure .",
    "a fifth - order polynomial is fit to the data and removed from each data segment in order to reduce fluctuations on timescales larger than the length of the considered segment which , depending on the specific case , varies from 30 minutes to a few hours .",
    "these fluctuations are poorly described because of the limited number of fourier modes , and would cause leakage at all timescales ( for instance a gradient in the timestream is described by a wide range of fourier modes ) , degrading the efficiency of map - making .",
    "note that we experimented with various polynomials and other effective high - pass filters ; we found that the results were not very sensitive to precisely how this is done , but some such filtering is certainly required .",
    "the degree of the polynomial was chosen empirically as a compromise between suppressing the artifacts and keeping the large scale signals in the final maps .",
    "using simulations , we have checked that the effect on the transfer function of the signal in the final map is weak .",
    "the resulting data segments are then corrected for the time - varying calibration ( see truch et al",
    ".  2007 ) using measurements of an internal calibration lamp @xcite .",
    "finally , the data segments are apodized at the edges over @xmath10 samples and are high - pass filtered at @xmath11hz with a butterworth filter .",
    "this filtering has very little effect on the final maps , since modes in the data at lower frequencies that are cut in this way are not expected to contribute significantly to the signals . we discuss the choices of filters further in section  [ sub : implem ] .",
    "accurate pointing reconstruction is a complicated procedure for balloon - borne telescopes , and this affects the map - making task through the pointing matrix ( defined in section  [ sub : model ] ) .",
    "the pointing reconstruction procedure is described in detail in @xcite .",
    "the next important step in reducing the blast data , which is calibration of the detectors , is detailed in @xcite .",
    "having performed the cleaning procedure described in the previous sub - section , the resulting data timestreams can be modeled very accurately as the sum of pure signal and pure noise contributions .",
    "the data for detector @xmath12 observing at a given wavelength and at time sample @xmath13 can be written as @xmath14_{tp } ~s_{p } + n_{it } ,    \\label{eq : linmodel}\\ ] ] where @xmath15 labels the pixels in the final map , @xmath16 is the pointing matrix for bolometer @xmath12 ( whose elements , indexed with time @xmath13 and pixel @xmath15 , give the weight of the contribution of pixel @xmath15 to the sample at time @xmath13 for bolometer @xmath12 ) , @xmath17 is the signal amplitude at pixel @xmath15 , and the noise amplitude at time @xmath13 for bolometer @xmath12 is @xmath18 .",
    "summation over repeated indices is assumed here .    ideally , the element @xmath19_{tp}$ ] of the pointing matrix is equal to the value of the beam response @xmath20 , where @xmath21 points to the pixel @xmath15 location , @xmath22 is the location of the beam center at time @xmath13 , and @xmath23 is a rotation matrix which depends on the rotation angle at time @xmath13 between the telescope and sky coordinate systems . in principle",
    "one could then recover a map of the sky",
    "_ deconvolved _ with the instrumental point spread function ( psf ) .",
    "however , in practice this would be unacceptably noisy , as well as computationally intractable , because of the prohibitive volume of data . even although @xmath16 might have mostly zero elements , it is nevertheless a huge matrix . it",
    "may _ be feasible to deconvolve a non - trivial beam response ( e.g.  like the blast05 beams , as shown in truch et al .",
    "2007 ) at the same time performing the map - making step , through an approximate treatment of the sparse pointing matrix .",
    "but we did not pursue that approach here .",
    "in the simple case where the beam is symmetric , the map - making problem becomes tractable , provided one restricts oneself to reconstructing a map of the instrument - convolved sky .",
    "we can then consider @xmath24 in equation  [ eq : linmodel ] as the map of the sky convolved with the beam , and consequently @xmath16 indicates simply where the detector points in the sky at a given time .",
    "in this case , @xmath16 is an ultimately sparse matrix with , in the blast case , simply a 1 in a single entry of each row .",
    "this approach , which has been conventional for cmb map - making ( although with some adaptation for chopped data ) , is what we use in the following analysis .",
    "it gives no loss of information provided that the map pixels are sufficiently small , and one can simply assign all the flux from a bolometer s to the map pixel to which it points at each time interval .",
    "the requirement for accuracy is that the pixel size is smaller by a factor three or more than the full width at half maximum ( fwhm ) of the instrumental psf ; in that case the additional convolution with the pixel shape gives negligible loss of angular resolution .",
    "the noise term @xmath18 in the model represents the sum of all contributions to the timestreams which do not reproject on the sky .",
    "this will in general include instrumental noise , fluctuations in atmospheric emission and other loading and unrecognized cosmic ray hits .",
    "in general , some of those noise contributions will induce strong correlations between detector timestreams . in this paper",
    ", we adopt a very general model of the noise where the noise covariance matrix : @xmath25 ( for bolometer indices @xmath12 , @xmath26 and time indices @xmath13 , @xmath27 ) has possibly non - zero elements even for @xmath28 .",
    "a key assumption , as we will see later , is that the noise is gaussian ( so that @xmath29 is sufficient to describe all the statistical properties of the noise ) and stationary ( constraining @xmath29 , see sections  [ sub : nn ] and [ sub : detdetcorr ] ) .    in the specific case of blast05 observations , a very significant correlation of the noise",
    "is found in the timestreams , and we have shown that a more constraining model provides a very good description of the data .",
    "an independent component analysis @xcite of the data enabled us to find that the noise and its correlations can be described to a high degree of accuracy by a noise component which is _ not _ correlated between detectors , together with a single _ common - mode _ component seen by all the detectors at a given wavelength ( some correlations is also seen between detectors from different wavelength but we have chosen to treat each wavelength independently ) .",
    "the common part of the noise is instantaneous , meaning that the same common - mode noise is seen at the same time by all the detectors . in our model ,",
    "the noise term in equation  [ eq : linmodel ] is then decomposed as : @xmath30 where the first term is the noise which is uncorrelated between detectors and the second term represents the common - mode component of the noise , rescaled by an amplitude parameter @xmath31 which depends on the detector but not on time .",
    "this model can be generalized easily to deal with multiple noise components in timestreams .    in the following section , we present a method to reconstruct @xmath24 given the data , in the framework of the linear model ( equation  [ eq : linmodel ] ) and in the presence of correlated noise between detector timestreams .",
    "the use of maximum likelihood map - making techniques has been developed by many authors for application to cosmic microwave background data - sets @xcite . some other approach are more specific to destriping for _ planck_-like scanning strategies @xcite .",
    "since there is already a large number of publications on the topic , here we present only a very brief overview of the approach of maximum likelihood map - making techniques .    assuming the simple linear model given by equation  [ eq : linmodel ] , the log - likelihood of the data can be calculated under the assumption that the noise is gaussian and stationary .",
    "the solution is @xmath32 where @xmath33 is the noise covariance matrix in the time domain , and @xmath34 denotes transpose . maximizing the above equation with respect to the map parameters @xmath35 ( suppressing the pixel indices here for convenience ) leads to the following well known estimator : @xmath36 the inverse pixel - pixel covariance matrix of the noise in the map is the term in brackets in this equation , i.e. @xmath37 computation of the solution to equation  [ eq : solmap ] is far from trivial for most astronomical applications , due to the large amount of data , and hence this poses a difficult numerical challenge .",
    "the noise covariance matrix @xmath38 is a very large matrix of size the number of samples squared , which could easily be millions , while @xmath39 may be more reasonable in size but has no obvious symmetries , and so is still difficult to invert .",
    "nevertheless , we have implemented a method aimed at finding the maximum likelihood solution given by equation  [ eq : solmap ] when there are a large number of detectors and in the presence of possible correlations in the noise between different detector timestreams .      in the simple case of dealing only with independent noise between detectors ,",
    "our matrix - inversion method is very similar to the madcap method , described in @xcite .",
    "however , we have developed our new approach to deal efficiently with multi - detector data in the presence of correlated noise between detectors ( described in detail in section  [ sub : detdetcorr ] ) . in this section ,",
    "we summarize the basic ideas for the simpler 1-detector 1-scan case .    in order to find the maximum likelihood solution of the map ( equation  [ eq : solmap ] ) , we have developed two different algorithms .",
    "they both allow us to solve the linear system @xmath40 , with @xmath41 .",
    "the first approach explicitly computes the inverse pixel - pixel covariance matrix @xmath42 , and we refer to this as the ` brute - force algorithm ' .",
    "the second approach uses iterations which converge to the maximum likelihood map without the need for computing @xmath42 , and we refer to this as the ` iterative algorithm ' .",
    "both approaches require as a first step the computation of the inverse of the time - time noise covariance matrix @xmath38 .      in practice ,",
    "even when we have knowledge of the statistical properties of the data as described by the power spectrum @xmath44 , the brute - force inversion of @xmath38 is not tractable because of its enormous size  for a single blast detector observing for 10 hours at a data - rate of @xmath45hz , the matrix has approximately @xmath46 elements .",
    "however , if we make the approximation that each data segment is `` circulant '' , meaning that the beginning and the end of a segment are connected without discontinuity and that there are no gaps in the data , then the matrix @xmath38 is also circulant ( see section  [ sub : gaps ] for a description of how we treat gaps in the data ) .",
    "circulant matrices are much easier to store and to invert . with this approximation",
    "the matrix can be written @xmath47 where the correlation function @xmath48 between samples @xmath13 and @xmath27 depends only on the separation between the two samples . a circulant matrix has the property of having a diagonal matrix counterpart in fourier space .    let @xmath49 be the discrete fourier operator , we have @xmath50 where @xmath51 denotes transpose conjugation , and @xmath52 is a diagonal matrix whose diagonal is described by the power spectrum of the data segment , @xmath53 the inverse of the noise covariance matrix is @xmath54 and because @xmath55 is a diagonal matrix , @xmath56 is also circulant , so that knowledge of only one row is enough to describe the entire matrix . then the inverse covariance matrix can be written @xmath57_{tt ' } = \\bar{c}(|t - t'|),\\ ] ] with @xmath58 where @xmath59 represents the inverse fourier transform .",
    "the inverse of the covariance matrix can then be computed directly using the power spectrum of the data .",
    "this is a very fast operation ( @xmath60 , with @xmath61 the number of samples ) , and does not require large memory since only one row of the matrix is computed .",
    "the approximation that the data segments are ring - shaped or circulant might seem unreasonable , but in the end this only has an effect on a small fraction of the matrix . for data with large - scale correlations ( data described by a @xmath8 power spectrum , for instance ) , the approximation implies an assumption that the two edges of the segment are very correlated . in reality",
    ", there is obviously little correlation at long timescales compared to short timescales , so extra striping could be introduced in the maps if one steps across the two edges of the data segment .",
    "we have addressed this problem in two ways in order to avoid introducing artifacts in the final map . in the case where we explicitly compute the inverse pixel - pixel covariance matrix @xmath42 ( as in the brute - force inversion algorithm ) , for the estimation of @xmath38 entering in the computation of @xmath62 ,",
    "we constrain @xmath63 for @xmath64 , with @xmath61 being the number of samples in the segment ; this is sometimes known as `` the madcap approximation '' in the literature .",
    "it is important to note that this approximation can not be used for the computation of @xmath65 , because it is performed partly in fourier space ( see section  [ subsub : and ] ) .",
    "instead we have apodized the data @xmath66 at the edges , and we have removed a low - order polynomial ( 5th order in practice ) to reduce fluctuations having typical timescales of order ( or larger than ) the data segment ( see section [ sub : process ] ) .",
    "this is reasonable , since those scales are not well described by a limited number of fourier modes , and hence will always be hard to reconstruct .",
    "the computation of the inverse pixel - pixel covariance matrix , which is described in this section , is required only in the brute - force inversion algorithm , or for an accurate error estimation in the pixel domain .",
    "since the pointing matrix has only one non - zero element per row in our simple model ( one data sample is associated with a single map pixel ) , the matrix multiplication @xmath67 requires a single loop going across all the non - zero elements of @xmath56 . for most cases ,",
    "a dominant faction of the map - making computing time will be devoted to this operation .",
    "if the data are only correlated within a typical length @xmath68 , we have the property : @xmath69 for @xmath70 , and @xmath56 is a band - diagonal matrix ( elements separated from the diagonal by more than @xmath68 are negligible ) .",
    "the number of elements to go through in the loop is of the order of , but smaller than @xmath71 , which is hopefully much smaller than the size of the matrix itself .",
    "unfortunately , if the noise is described by a power spectrum of the form @xmath72 , the correlation length of the noise is basically of the order of the length of the whole data - set .",
    "however , the amplitude of the correlation is decreasing for very long timescales and becomes negligible beyond a certain scale .",
    "the function @xmath73 can then be artificially set to zero for @xmath74 , with @xmath75 chosen empirically so that the correlation of the noise is low enough for scales longer than @xmath75 , and also that there is very little constraint on the signal at those scales .",
    "for the specific case of blast observations , we find that @xmath76s is a good compromise , as illustrated in figure  [ fig : invc ] .",
    "the noise strongly dominates the signal in blast observations for scales longer than @xmath75 ( corresponding to frequencies smaller than @xmath11hz ) , since : ( 1 ) this frequency is well below the knee frequency of the noise power spectrum ; and ( 2 ) there is very little signal at frequencies smaller than @xmath11hz , which is more than ten times smaller than the scanning frequency .",
    "therefore we have used @xmath77s for the computation of the noise covariance matrix .",
    "the impact of fixing @xmath78 for @xmath74 in the initial power spectrum is shown in figure  [ fig : invc ] .",
    "we can see a tight relation between the power spectrum and the inverse covariance matrix , since getting @xmath78 for @xmath74 can be obtained only by modifying the power spectrum at frequencies smaller that 1/@xmath75 .      in the computation of @xmath80 , which is necessary for both of our algorithms , the multiplication @xmath81 is performed in fourier space where the noise covariance matrix is diagonal .",
    "we obtain this vector by dividing the fourier transform of the data by the power spectrum of the noise .",
    "another way to represent this is by considering that since @xmath56 is circulant , @xmath81 is a convolution operation . assuming that this model holds , the resulting data vector @xmath82 contains whitened noise .",
    "the remaining operation @xmath83 just performs the addition of the filtered data sample onto the pixels of @xmath35 ( i.e.  the map ) , and hence is very fast .    in the case of blast observations , since we are not attempting to recover useful information from timescales larger than @xmath84s , we perform a high - pass pre - filtering of the input data @xmath66 at @xmath11hz .      in the matrix inversion algorithm ,",
    "@xmath42 is directly computed , as described in section  [ subsub : invnpp ] .",
    "the next step is to solve the linear system @xmath85^{-1}x$ ] . for small maps ,",
    "in which @xmath42 can be stored in memory , we perform a cholesky decomposition . for larger maps , we write the matrix to disk and perform an iterative inversion of the system using a conjugate gradient method with pre - conditioner .",
    "this algorithm allows one to easily perform multiple monte - carlo simulations , since the pixel - pixel covariance matrix , being independent on the data realization , can be computed once ( this is assuming that the noise power spectrum is known and does not have to be estimated from the data themselves ) , and used for all the realizations of simulated data .",
    "another advantage of this approach is that it allows for the exact computation of the errors in the map , which are given by the covariance matrix .",
    "however , the matrix inversion algorithm is generally slower than the iterative algorithm which we will discuss next , and can be used only for relatively small maps ; we found that we were limited to around 200,000 pixels if the matrix is written to disk , or less than 20,000 pixels if the matrix is stored in memory .",
    "we now present an iterative algorithm based on conjugate gradient with pre - conditioner to obtain the maximum likelihood solution for the map ( a similar algorithm has been used in @xcite ) .",
    "let us rewrite equation  [ eq : solmap ] , which relates the best estimate of the map with the data , after multiplying both sides by the pixel - pixel covariance matrix : @xmath86 if we define @xmath87 as an estimate of the map at iteration @xmath88 , the conjugate gradient method allows to solve the linear system by minimizing iteratively the following criterion : @xmath89 where @xmath90 this criterion is indeed minimum and equal to zero if @xmath87 is the maximum likelihood solution .",
    "one can interpret @xmath91 as the weighted variance of the difference between two map vectors .",
    "the first of these vectors , @xmath92 , is the inverse pixel - pixel covariance matrix times the current estimate of the map , while the second vector , @xmath93 , is a map constructed by simply co - adding pre - whitened data .",
    "we decide that convergence is reached when the quantity @xmath94 ( which is much easier to compute than @xmath91 , and also converges to zero ) gets smaller than a predefined value . in practice",
    "the number of iterations required for convergence is of the order of 100 .",
    "the conjugate gradient method is not described here , since it is a fairly standard numerical tool , and the interested reader can find many descriptions in the literature.[multiblock footnote omitted ] instead of describing the details , we focus here on aspects which are specific to our map - making process . in particular ,",
    "let us describe the computation of @xmath95 , which is the time - consuming part of the optimization and has to be performed at each iteration ( the computation of @xmath93 , also time consuming , but needs to be done only once , since none of the parameters are changing through the iterations ) ; the other operations for updating the map at each iteration are significantly faster .",
    "one advantage of this iterative algorithm is that the computation of the full pixel - pixel covariance matrix is not required , and the operation @xmath95 can be done step by step .",
    "indeed , we start by computing @xmath96 , which is an estimate of a `` signal '' timestream .",
    "this operation is equivalent to scanning over the current estimate of the map using the pointing solution .",
    "the subsequent operation @xmath97 ( which should now be familiar ) , is carried out in fourier space , as described in section  [ subsub : and ] ( without applying any extra filtering ) , and in section  [ sub : detdetcorr ] for the case of correlated noise between detectors .",
    "this iterative approach is in general much faster than the brute - force inversion approach , because the most time - consuming operations are performed in fourier space .",
    "it also requires less memory , since @xmath42 is not explicitly computed . of course",
    ", if there are found to be ( or known to be ) non - trivial correlations in @xmath42 , then it may have to be calculated explicitly , hence requiring the brute - force approach .",
    "however , provided the pixel - pixel correlations only involve relatively few pixels , it should be possible to calculate a restricted part of ( or perhaps an approximation for ) @xmath42 in a modified iterative approach .",
    "a related concept is discussed in section  [ sub : errorestim ] .      in the previous sub - section",
    ", we presented the general method for the simple case where only a single continuous observation is considered .",
    "we now describe how we combine observations from different detectors at the same wavelength , as well as different data segments obtained over different `` visits '' during the flight , where by `` visit '' we mean a period in the data which starts after a sufficiently long gap , or after the observation of a different region of the sky .    for convenience , the data vector @xmath66 in our model ( equation  [ eq : linmodel ] ) now contains all the individual data segments from different detectors , and also within a single channel , concatenated end to end . the noise vector @xmath98 in equation  [ eq : linmodel ]",
    "is defined in a similar manner .",
    "the matrix @xmath99 in equation  [ eq : linmodel ] is then the result of stacking individual pointing matrices .",
    "the maximum likelihood solution is also written as in equation  [ eq : solmap ] , with @xmath38 becoming the full covariance matrix of the noise , including all the channels and data chunks . to start with ,",
    "let us assume that there is no correlation of the noise between data segments .",
    "this is a very good assumption if we consider data segments obtained over different visits , but is certainly not a good approximation for segments obtained simultaneously with different channels , since we found a very strong common - mode noise between detectors .",
    "we will consider the simple no - correlation case first , and then in the next sub - section ( section  [ sub : detdetcorr ] ) we will generalize the map - making method to account for noise correlations from different detectors .    in the absence of correlations between data segments ,",
    "the time - time noise covariance matrix @xmath38 is block - diagonal and each block can be inverted separately .",
    "defining @xmath100 as the sub - covariance matrix for the data in segment number @xmath101 , and @xmath102 as the sub - pointing matrix going from the map to the data segment @xmath101 , the inverse pixel - pixel covariance matrix can be written as @xmath103 the computation time for obtaining this matrix is proportional to the number of data segments . in this simple case",
    "the computation of @xmath104 can be written @xmath105 where the computation of each term is fast and can be performed partly in fourier space .",
    "we now allow for the presence of correlations in the noise between different detectors . in the case of multiple visits ,",
    "the noise covariance matrix , @xmath38 , still has null cross - terms for samples from two different data visits .",
    "therefore , if the data vector is sorted by visit , then @xmath38 is block diagonal and each block contains the correlation coefficients between all the detectors for the samples within the time interval defined as a single visit .",
    "each visit can be treated independently , since the sub - matrices can be inverted separately , and equation  [ eq : combscan ] is still valid , but in this case @xmath101 is the label for the blocks in @xmath38 . in the following ,",
    "we therefore focus on a single visit , and consider observations by all the detectors ; the generalization to multiple visits should be clear .    to simplify the notation , let @xmath38 denote the noise covariance matrix for the visit being considered , with @xmath66 and @xmath98 being the data and noise vectors , respectively , containing the timestream segments for all the detectors put end to end , and @xmath106 being a block of @xmath38 of size @xmath107 , corresponding to the noise correlations between detectors @xmath12 and @xmath108 .",
    "let us define @xmath109 the multi - channel fourier transform operator such that @xmath110 with @xmath111 containing end - to - end fourier transforms of each data segment .",
    "@xmath109 is a block - diagonal matrix , and each block is the fourier transform operator @xmath49 for one data segment .      from equation  [ eq : fourcov ] , we can calculate the inverse covariance matrix of the noise in real space : @xmath124 then , a block of @xmath56 between detectors @xmath12 and @xmath108 can be written @xmath57_{ij } = f^\\dagger [ r^{-1}]_{ij } f.\\ ] ] because @xmath125_{ij}$ ] is a diagonal matrix ( as discussed previously ) @xmath126_{ij}$ ] is circulant , and is related to the inverse of the matrix containing the cross- and auto - power spectra of the noise : @xmath57_{ijtt ' } = { \\cal f}^{-1}\\left\\ { [ p^{-1}]_{ij}\\right\\}(t ' - t ) .",
    "\\label{eq : invncorr}\\ ] ] from this relation , we can see that in practice @xmath56 is relatively easy to construct , since each of its blocks ( referring to each pair of detectors ) is a circulant matrix , so only a row of each sub - matrix needs to be calculated using the fast fourier transform .",
    "finally , in the case the noise covariance matrix is used for multiplication in real space ( as in the brute - force algorithm ) , the same approximation described in section  [ sub : implem ] is performed on each block of @xmath56 , i.e. , @xmath126_{ijtt'}=0 $ ] for @xmath127 ( or for @xmath128 if @xmath129 ) .",
    "the global structure of the final inverse noise covariance matrix is illustrated in figure  [ fig : mapinvn ] .",
    "in the text ) for three detectors and for only 10 minutes of data ( corresponding to 60,000 samples per detector ) .",
    "the matrix is computed following equation  [ eq : invncorr ] , and the approximations described in section  [ sub : detdetcorr ] are applied .",
    "the cross- and auto - power spectra of the noise , used for the calculation of @xmath56 , are computed from the data themselves ( one of the auto - power spectra is shown in figure  [ fig : noisesp ] , the cross - power spectra are an unbiased measure of the common - mode signal shown in the same figure ) .",
    "each sub - matrix is circulant and corresponds to a particular pair of detectors .",
    "one can see that the off - diagonal sub - matrices have amplitudes of the same order as that of the diagonal sub - matrices .",
    "this is due to the very high level of noise correlation between detectors . ]    in our model of the data ( equation  [ eq : lincmod ] ) in which all the correlations between detectors are described by a single common - mode , @xmath121 can be related to the power spectra of the common - mode and of the uncorrelated part of the noise between detectors : @xmath130 this relation can be generalized if multiple common - mode components are present : @xmath131 would then be a mixing matrix and @xmath132 becomes the covariance matrix of these noise components .",
    "having computed the inverse noise covariance matrix of the timestreams , we can express ( using equation  [ eq : invnpix ] ) the noise covariance matrix in the pixel domain : @xmath133_{ij}~a_j,\\ ] ] where , as before , @xmath12 and @xmath108 label the detectors .",
    "the computation time for @xmath42 is now proportional to the number of detectors squared .",
    "the calculation of @xmath134 is straightforward : @xmath135_{ij}~d_j,\\ ] ] and this is fast , since ( as already shown ) the operation @xmath126_{ij } d_j$ ] is a convolution , which can be performed in fourier space .",
    "one can see from equation  [ eq : invncorr ] that @xmath136 can be expressed directly with respect to the cross- and auto - power spectra of the noise : @xmath137_{ij}(\\omega ) .",
    "\\bar{d}_j(w)\\right\\}.\\ ] ]    the formalism presented above can also be generalized easily to deal with detectors operating at different wavelenths .",
    "the map vector @xmath35 could be merging different maps at different wavelengths and the noise matrix @xmath38 would account for all the correlations of the noise between detectors .",
    "the joint multi - band map - making would be suitable in practice when some contaminations from thermal fluctuations in the instrument or atmospheric emission are present , because they correlate the noise at all wavelengths .",
    "the maximum likelihood solution for the final map depends on the noise power spectra for each data - set ( through @xmath38 in equation  [ eq : solmap ] ) , which are assumed to be perfectly known .",
    "however , in practice the noise power spectra have to be inferred from the data themselves and some uncertainties are associated with this iterative process .    in practice",
    "a first ( approximate ) estimate of the noise power spectrum can be obtained by rebinning the power spectra of each data segment , neglecting the contribution of the astrophysical signal in the timelines .",
    "indeed , for most of the fields observed with blast , and in particular for blank extragalactic fields ( like the elais - n1 field in blast s flight from sweden ) , the noise is highly dominant over the sky signal at all frequencies .",
    "however , this is not true for measurements of bright regions in the galactic plane . therefore , for the first iteration s noise estimate we focus on the data taken for about 6 hours while scanning the deepest extragalactic field ( elais - n1 ) and use this to estimate the noise power spectra , which then become the noise input for making the first set of maps of _ all _ of our fields .",
    "this approach is not entirely satisfactory , since the noise is not stationary during the flight  the noise power spectra are seen to vary over long timescales , although they are quite constant within a single visit of each field .",
    "this non - stationarity appears most obvious when there are variations of the scanning strategy between different visits ( a change of the scanning frequency induces a variation of the location of peaks in the power spectrum ) , but can also occur due to variations of detector loading or the detector bias being changed during the flight .    because of the observed non - stationarity of the noise , we would like an independent estimate of the noise power spectra for each visit for each of the observed fields . after starting from a first estimate of the noise power spectra based on elais - n1 data",
    "as described above , we adopt an iterative approach between maps and noise power spectra . at each iteration ,",
    "the estimated maps are subtracted from the data , prior to noise power spectrum estimation .",
    "we can summarize our procedure in the following steps :    * estimate @xmath138 from @xmath66 using a field known to have little signal ; * compute @xmath139 from equation  [ eq : solmap ] ( and also equation  [ eq : invncorr ] or [ eq : pktobc ] , depending on the noise correlation being considered ) using @xmath138 as input ; * estimate @xmath44 from @xmath140 ; * re - estimate @xmath139 from equation  [ eq : solmap ] using @xmath44 , and iterate on these last two steps until convergence is achieved .",
    "we stop iterating when the noise power spectra do not vary by more than 1 per thousand from iteration to iteration ( and find that in practice only 3 to 6 iterations are necessary to reach convergence ) .",
    "we now focus on how we estimate the noise power spectra @xmath44 in steps 1 and 3 .",
    "for the simplest case , where no correlations are assumed between detectors , we simply compute a bin - averaged power spectrum for each data segment : @xmath141 where , for bin number @xmath142 , @xmath143 , @xmath101 labels the data segment , and @xmath144 is the data vector from which an estimate of the map has already been subtracted . we have chosen logarithmic spacing between bins and an estimate of @xmath44 for each @xmath119 mode is obtained by logarithmic interpolation , which leads to a smooth power spectrum estimate .    in the more complicated case where correlations between detectors are assumed to be important and",
    "therefore are not neglected , we must estimate , for every iteration , each cross- and auto - power spectrum of the data between detectors , @xmath145 , which enter into the computation of the inverse noise covariance matrix ( equation  [ eq : invncorr ] ) . each cross - power spectrum could be directly estimated as in equation  [ eq : binavp ] ( using @xmath146 and @xmath147 in the formulae for detectors @xmath12 and @xmath108 ) , but instead we choose to reduce the number of parameters to estimate at each step , by assuming that the data are described by a common mode between detectors plus _ independent _ noise ( equation  [ eq : lincmod ] ) . in the framework of this model ,",
    "the expected cross- and auto - power spectra depend directly on the following parameters : @xmath131 , the amplitude of the common mode in each channel ; @xmath148 , the power spectrum of the common - mode part ; and @xmath149 , the power spectrum of the noise component , which is independent between detectors .",
    "the relation between the model of @xmath44 and the parameters has been shown in equation  [ eq : modspcorr ] .",
    "these parameters are typically not known _ a priori _ , and must be measured using the data themselves .",
    "we use a blind ` component separation ' method developed for an entirely different problem in @xcite .",
    "this allows us to obtain a single estimate of all the parameters described previously , by simultaneously using all the observed timestreams of a given field for all the detectors in a specified channel ( i.e.  at a single frequency ) .",
    "the method is known to be the maximum likelihood solution for a gaussian and stationary model of both the noise and the common - mode .",
    "the cross- and auto - power spectra @xmath44 are then computed following equation  [ eq : modspcorr ] , using these same estimated parameters .",
    "figure  [ fig : noisesp ] shows the estimated noise power spectra in a sample of blast data for one representative detector using three hours of timestreams during scans of the elais - n1 field ( which is known to be essentially devoid of signal ) .",
    "m detectors , using about three hours of data , corresponding to scans of the elais - n1 field . the dotted curve correspond to the estimated power spectrum of the common - mode between detectors at @xmath150 m , rescaled by an amplitude factor for the specific detector being considered ( @xmath31 in the text , where @xmath12 is the detector index ) , also estimated using the data themselves .",
    "the dashed curve represents the estimated power spectrum of the uncorrelated part of the noise for this detector .",
    "the common - mode is very strong in these data and dominates over the uncorrelated noise at frequencies lower than about @xmath151hz .",
    "most of the low frequency noise excess comes from this common - mode .",
    "the uncorrelated part of the noise shows a knee frequency of less than @xmath152hz , which is 510 times smaller than for the total noise power spectrum .",
    "the power of the uncorrelated noise is thus reduced by a factor of about 100 at low frequencies .",
    "the excess signal at the scanning frequency ( peak around @xmath153hz in the power spectrum ) is completely common between detectors . ]",
    "the auto - power spectrum is shown , as well as its decomposition in terms of the common - mode power spectrum and the uncorrelated noise power spectrum .    because our estimate of the converged map of the sky @xmath139 is not perfect and contains contributions from residual noise , then in subtracting a simulated signal timeline from the data to estimate the noise power spectrum we reintroduce some noise to the data which could potentially bias our estimate of the noise power spectrum @xcite . however",
    "this effect is greatly reduced by the large redundancy in each pixel of the final maps , as a result of the many repeated scans and the large number of detectors at each wavelength .",
    "the bias can be neglected to first order for blast , since the noise level per pixel in the final map is much smaller than the noise in individual detector timestreams .      in order to derive the formalism presented so far",
    ", we have assumed that each data segment is stationary and hence consists of a continuous series of data points .",
    "however , we have seen in section  [ sub : process ] that the blast05 data contain multiple gaps of typical size less than one second .",
    "the amount of data in these gaps is a few percent of the total . in order to reasonably restore the continuity of the data we have filled the gaps with random noise , as described in section  [ sub : process ] .",
    "the data samples generated in the gaps are not reprojected into the final map but are directed to `` dummy '' pixels . in principal , the optimal approach would be to create one dummy pixel per flagged data sample , avoiding the possibility of several simulated samples falling on the same pixel ( through the rebinning of flagged pixels we do not want to introduce any spurious constraints for the map - making process which could arise from adding crossings over different time intervals ) .",
    "however , the approach of using one dummy pixel per gap sample is impractical , because the total number of dummy pixels would be excessive for typical blast observations , and the pixel - pixel covariance matrix ( which has size the total number of pixels squared ) would be prohibitive to store and compute .",
    "we have adopted a simpler approach , which does not lead to the mathematically exact solution , but comes very close ( as has been shown in simulations ) .",
    "this consists of rejecting ( for the computation of @xmath42 ) all the elements of @xmath43 associated with flagged samples .",
    "this is equivalent to removing from @xmath42 the rows and columns corresponding to the dummy pixels before the inversion of the matrix , as opposed to after inversion , which would be the correct treatment discussed above .",
    "this approach is also equivalent to assuming null off - diagonal terms for those rows and columns .",
    "however , such dummy pixels are obviously correlated to some degree with the real pixels in the map , and hence this can not be entirely correct .",
    "nevertheless , we have verified that this approximation has a small impact ( a few percent only ) on the final map for most of the angular scales which are sampled , although we found some differences at very large angular scales , sizes of the order of the map size . for",
    "now , we have not put much effort into recovering those very large scales because they are subject to other effects , as discussed in section  [ subsub : sigonlyivcg ] . the minimal impact on the final map",
    "has been verified using pure signal simulations and by comparing the results obtained between our simple approach and the correct map - making solution .",
    "this approach works to a high degree of accuracy on most scales because the gaps are small and do not introduce important discontinuities in the timestreams .",
    "we have used this simple approach because it gives sufficiently accurate results over the relevant angular scales , while being simple and fast to implement .",
    "however , another iterative procedure could be adopted , which would lead to the exact solution . in this approach , we define two maps . the first map `` a''is made from only the uncorrupted ( i.e.  real sky ) samples , while the second map `` b '' is obtained from projecting the simulated ( i.e.  for gap - filling ) samples .",
    "the difficulty arises in deciding what to do when simulated data from different scans or detectors fall in the same pixel ",
    "one might want the `` generated signal '' ( and not necessarily the noise ) to be identical in both measurements , in order to satisfy the map - making hypothesis . if this condition is not satisfied , then some artifacts may be introduced into both maps . here is a solution to this problem :    1 .",
    "generate a first set of maps `` a '' and `` b '' after filling the gaps in the timestreams with white noise + a linear baseline .",
    "2 .   fill the gaps in the data with the best estimate of the signal in map `` a ''",
    "together with white noise + a baseline which is fitted in the gap vicinity of the data `` minus '' signal timestream .",
    "3 .   recompute the maps `` a '' and `` b '' .",
    "step 2 ensures that the signal is the same for each generated sample falling in the same pixel of map `` b '' .",
    "this approach can also be coupled with the procedure for estimating the noise power spectra described in section  [ sub : nsp ] .",
    "preliminary results indicate that this approach works in practice .",
    "detailed studies will be presented in a future publication .",
    "for some specific observed fields we may have strong priors about the sky emission at a given location . for instance , we know that over some regions the astronomical signal should vary very smoothly or should be very weak with respect to the noise , at least outside some localized region .",
    "this is the case in particular when we map bright extragalactic sources in order to calibrate the detectors and estimate the beams ; in these cases , regions beyond some predefined distance from the beam center can be assumed to have null flux ( or a constant relative flux in the map , since we do not have access to the dc level in maps ) .",
    "if we really have strong prior knowledge that we are dealing with a bright localized region , then we can take a further drastic step  we can constrain the map to have the same value in some domains of the sky by defining a single pixel containing all the data samples falling in that region .    in practice",
    ", we define a small box centered at the source location and constrain the part of the map outside this box to have a constant value .",
    "this is a very efficient way to remove stripes from the map , since the extremities of all the paths across the map are re - adjusted .",
    "we have used this technique to make maps of the isolated calibrators observed by blast ( truch et al .",
    "2007 ) .",
    "the variance of the noise in each pixel of the final map and its correlations are directly given by the pixel - pixel covariance matrix @xmath154 .",
    "this is true given the following assumptions : that our model of the data holds , in particular that the noise is a purely gaussian random process , which may not be the case in practice at low frequencies ; and that our estimate of the sample - sample noise covariance matrix @xmath155 is accurate enough that the errors do not propagate significantly into the final map .",
    "as already mentioned , we never explicitly compute the covariance matrix , but rather its inverse .",
    "the direct inversion would take a prohibitive computation time for most applications .",
    "however , to first order , we can obtain an estimate of the errors by inverting the diagonal part of @xmath42 only , neglecting the off - diagonal terms .",
    "this is equivalent to assuming that the noise in the final map is white .",
    "we have checked with the help of simulations that this very simple approximation is accurate to better than 10 percent for all our blast05 fields , even for those with very poor cross - linking .",
    "provided that the size of the map is reasonably small , so that we are able to explicitly calculate @xmath39 , we can obtain an accurate estimate of the errors for a limited ( and small ) number of pixels in the map .",
    "the variance for pixel @xmath15 , and the covariance with respect to the other pixels of the map , can be computed by solving the linear system : @xmath156 where @xmath157 is a unitary vector with a single 1 for pixel @xmath15 .",
    "if the cholesky decomposition of the matrix has already been performed for the map - making procedure , the computation of equation  [ eq : var ] is relatively fast and hence can be carried out for a grid of non - adjacent pixels , for example .",
    "this can be used to check the validity of the error prediction approximation described in the previous paragraph .      for the brute - force inversion algorithm ( in which the full inverse pixel - pixel covariance matrix @xmath42 is computed ) , five minutes of computation with a single @xmath158ghz processor are needed to process 2 hours of data from a single detector at a rate of @xmath45hz . the computational time is proportional to the number of samples if this is longer than the assumed correlation length of the noise in the data ( which has been evaluated to be @xmath159s in blast05 timestreams ) . if noise correlations between detectors are also to be accounted for , the computational time is proportional to the square of the number of detectors .",
    "most of the computing time is spent on calculating @xmath42 .",
    "inversion of the linear system to estimate the map @xmath35 is relatively fast ( a few minutes to a few hours for maps of several square degrees in size ) .    for the iterative algorithm ,",
    "about two minutes of computational time is required for two hours of data ( under the same conditions described above ) .",
    "this assumes that 100 iterations are necessary to reach convergence ( which is a realistic number for most applications ) , and the algorithm scales with @xmath160 .",
    "the situation is much better than for the brut - force inversion algorithm if correlations between detectors are included . in that case",
    ", the algorithm scales with the square of the number of detectors if this exceeds about 40 .",
    "if there are fewer than about 40 detectors then the algorithm scales linearly with the number of detectors . as an example , if there are 100 detectors , then including noise correlations between the detectors increases the computational time by a factor of four with respect to the `` no - correlation '' case .",
    "the full processing of 10 hours of blast05 data at all wavelengths , including detector - detector correlations , can be done with a single processor in a few days .    in terms of memory ,",
    "the brute - force inversion algorithm requires storage of the full @xmath42 matrix .",
    "however , for the iterative algorithm , only vectors of the size of the maps need to be kept in memory , which is much less demanding .",
    "we now focus on the application of sanepic to data .",
    "our aim is to develop tests to validate our method using simulated blast observations .",
    "we derive conclusions about how well low frequency noise in the maps can be reduced , depending on observational parameters such as scanning strategy , and we compare the results obtained with those from simpler methods based on filtering the data , e.g. , common - mode subtraction . in this section",
    ", we describe the simulations performed to test the sanepic method .",
    "we have generated several different sets of simulations of blast timestreams .",
    "each set of simulated timestreams , representing one particular observed field , is generated for all the blast detectors used for the analysis of real data ( 132 at 250@xmath0 m , 78 at 350@xmath0 m and 39 at 500@xmath0 m ) and is the sum of simulated astrophysical signal , independent noise , and common - mode noise between all detectors .",
    "the noise is generated randomly with gaussian statistics , given fixed power spectra derived from real blast05 data .",
    "figure  [ fig : noisesp ] shows an example of the power spectrum of the noise in the data used as input to the simulations for one of the fields .",
    "the part of the noise which is independent between detectors is generated for every detector timestream and has a power spectrum well described on average by a relatively flat plateau for frequencies larger than about @xmath161hz , and by a part proportional to @xmath162 for smaller frequencies ( these characteristics vary slightly from detector to detector ) .",
    "our knowledge of the real bolometer noise power spectrum at low frequency is limited by the very dominant common mode . in simulations ,",
    "the common - mode noise is generated once for all detectors and has a power spectrum very well fit by a power law with an index equal to approximately 2.5 , together with some broad peaks , the largest being at the scanning frequency ( the amplitude of the peak depends on the scanning strategy and the observed field ) .",
    "the common - mode power spectrum has an amplitude such that it reaches the level of the independent noise at about @xmath9hz ( see figure  [ fig : noisesp ] ) .",
    "the generated common - mode timestream is multiplied by an amplitude factor which varies from detector to detector by @xmath163 and is added to the simulated detector timestreams .",
    "the amplitude factors used for the simulations have been estimated from the data themselves .    in order to represent the astrophysical signal , we have simulated simple maps of diffuse emission with a power spectrum proportional to @xmath164 , as for typical galactic cirrus emission ( e.g.  miville - deschnes et al .",
    "maps are generated following gaussian statistics with a resolution of 1@xmath165 , much higher than the typical pixel sizes in the final maps , in order to reduce artifacts due to re - pixelization .",
    "the amplitude of the fluctuations of the simulated map is chosen to match the expected level of signal in each observed field .",
    "the simulated maps are scanned using blast05 pointing , and pure signal timestreams are generated for each detector .",
    "signal and noise timestreams are added at the end of the procedure ( but see section  [ sub : results ] for an explanation of why this operation is not always carried out ) .",
    "we have generated two sets of simulations which correspond to two different fields observed by blast .",
    "we selected two fields that were observed with very different scanning strategies , since the performance of the map - making procedure is very dependent on scanning strategy ; this allows us to test sanepic in two very different configurations . in the first case",
    "the scanning was performed mainly in a single direction over a short time interval , while in the second case the field was observed several times during the flight at different scanning angles , to achieve significant cross - linking in the map .",
    "the first data - set uses observations of the cas a  supernova remnant emission which comprises about 20 minutes of data .",
    "blast observations of this field and derived conclusions will be described in detail in hargrave et al .",
    "( in preparation ) .",
    "the rectangular region mapped has a size of the order of @xmath4 and was scanned two times back and forth over a short time interval .",
    "we have generated simulations corresponding to all the detectors at 250@xmath0 m ( we used a total of 132 detectors ) .",
    "the second data - set reproduces the observations of the intermediate velocity cloud ivc g86.5 + 59.6 ( hereafter ` g86 ' ) .",
    "simulations include four different visits of the field performed during the flight at very different time intervals ( ranging from a few hours to more than a day ) .",
    "each continuous observation segment has a size which varies from one to two hours .",
    "two scanning directions are dominant , which form an angle close to 50@xmath166 .",
    "the region covered has a size of about @xmath167 on the sky .",
    "simulations for this field are performed specifically for all the 500@xmath0 m detectors ( 41 detectors used ) .",
    "similar monte carlo simulations at 250@xmath0 m would have taken a factor of 10 longer , while we believe that the conclusion would remain unchanged .",
    "a total of 20 sets of simulations of the observations for each field have been performed . for each set",
    "we vary the realization of the noise and of the signal input map .",
    "about four hours of computing time are needed to create one realization of a full set of simulations of g86  with a single processor , compared to a few minutes for the cas a  simulations .",
    "this is using the pre - computed full pixel - pixel covariance matrix , which was also used to analyze the real data .",
    "we now present the results obtained with sanepic applied to the two sets of simulated data . in each case",
    ", we compare the final map with other maps obtained using simpler map - making procedures . for these tests",
    "we have assumed that the noise power spectra are perfectly known , rather than estimated separately from each data - set ; in practice we fix the noise power spectra to be the ones from the simulations .",
    "we have verified that relaxing this constraint has almost negligible change on the final maps .    for these simulated data - sets ,",
    "we have applied some pre - processing of the timestreams before applying sanepic , just as we do for the real data .",
    "we have systematically removed a 5th order polynomial from each timestream segment and weakly high - pass filtered the data , as described in section  [ sub : process ] . finally , for the gap - filling we flag the simulated data at the same locations as in the real data in order to check the influence of the flagging procedure in the final maps .    in the following",
    "we have applied sanepic independently to pure noise timestreams ( containing independent noise and common - mode noise , but without simulated astrophysical signal ) and to pure signal timestreams .",
    "this procedure allows us to easily derive conclusions about the noise properties in the final maps , as well as about the signal , without biasing the results , because sanepic is a linear method ( as shown by equation  [ eq : solmap ] ) .",
    "this is only strictly true if the noise power spectrum is fixed as done here , and not estimated simultaneously along with the maps .",
    "then , applying sanepic on pure noise timestreams and pure signal timestreams independently and adding the two final maps is rigorously equivalent to applying sanepic on signal plus noise timestreams .",
    "this has been checked numerically , and we find that the difference is consistent with double floating precision error",
    ". an important consequence of this is that the properties of the noise in the final map are independent of the signal - to - noise ratio .",
    "we first study the maps resulting from the noise - only timestreams in the configuration of cas a  observations .",
    "the chosen pixel size of the map is 25@xmath165 and matches the pixel size of the maps discussed in hargrave et al .",
    "( in preparation ) .",
    "we compare the noise maps obtained from three different procedures :    * case 1 : use sanepic with the correct treatment of the correlated noise .",
    "* case 2 : use sanepic fixing the correlation of noise between detectors to zero and fixing the noise power spectrum for each detector to the power spectrum of the sum of uncorrelated noise and common mode .",
    "this procedure is very similar to more standard map - makers in the literature ( e.g. , stompor et al .",
    "* case 3 : make a simple re - projection of the data onto a pixelized map by simply averaging the data falling in each pixel , after having filtered the timestream data with the same very weak low - pass filter used for sanepic .",
    "this procedure is sometimes called `` co - addition '' .",
    "figure  [ fig : mapncasa_corr ] shows computed noise maps for one of the realizations of the noise in each of the three cases .",
    "as expected , the map obtained with the simple pixel binning approach contains a very large amount of low frequency noise , with strong striping visible along the scan direction .",
    "residual low frequency noise can also be seen in the map obtained using sanepic _ without _ accounting for the noise correlations between detectors .",
    "we do not expect this method to be very efficient , since it is very non - optimal in cases ( such as this example ) where a very large fraction of the noise is correlated between detectors .",
    "in contrast , the noise map obtained with sanepic is quite satisfactory , showing reduced power at low frequency as compared to the previous case .",
    "nevertheless , some very weak excess power is seen in the cross - scan direction .",
    "this is expected , since the map is not cross - linked , and very poor constraints can be put on the cross - scan directions at low spatial frequencies ( two positions in the map separated by more than the size of the array in the cross - scan direction are observed far apart in time ) .    in order to quantify the level of low frequency noise in the maps ,",
    "we compute the 1-d power spectra of the maps , averaged over the 20 realizations of the simulated data . for the computation of power spectra , we take into account only the central part of each map , where the level of redundancy in the observations is high ( we use only the highest signal - to - noise region in the maps ) . to do so",
    ", we apply an apodized mask to the maps going smoothly from 0 at the edges to 1 .",
    "figure  [ fig : noise1dspcasa ] shows the noise power spectra in the three cases .    ) .",
    "error bars are computed from the dispersion of measurements among the realizations . for comparison ,",
    "the upper dotted curve ( decreasing almost like a power law at all scales ) represents the power spectrum of the pure simulated signal in the final map .",
    "the solid curve represents the power spectrum of the final map obtained with real data using sanepic , with correlations included .",
    "this shows the benefit of taking into account correlations of the noise between detectors in the map - making procedure , reducing the noise structure far below that of the signal in the map .",
    "the real data power spectrum shows that the signal dominates at all angular scales larger than about 3@xmath168 and at smaller scales we can see that white noise at the expected level dominates in the map .",
    "the drop of power at around a 3@xmath168 scale is due to the blast05 beam . ]",
    "the noise level in the simple re - projection map is obviously very poor at all scales .",
    "both of the other map - makers reach the white noise level for scales smaller than 3@xmath168 and have excess power at larger angular scales .",
    "nevertheless , the gain between full sanepic and sanepic without correlations is very important at all scales larger than about 2@xmath168 and reaches a maximum value of about 10 at around 20@xmath168 angular scales .",
    "an interesting fact is that the knee frequency of the noise power spectrum in the optimal case here corresponds to the inverse of the physical scale of the detector array in the cross - scan direction ( which is of the order of 6@xmath168 ) . indeed , there are no observational redundancies on scales larger than the array in the cross - scan direction in the absence of cross - linking in the map .",
    "thus the very long timescale @xmath8 noise present in the timestreams is not efficiently removed and re - projects in the final map at large angular scales .",
    "this effect is also present along the scan direction , but with a lower amplitude as the map is scanned back and forth .",
    "the trend of the large angular scale power spectrum of the noise in the map just follows the trend of the low frequency noise power spectrum in the timestreams .",
    "we will see in section [ subsub : crosslink ] that this effect is reduced when there are multiple scanning directions in the map .    in order to determine the direction in which the noise power is strongest in the map ,",
    "we have also computed the 2-dimensional noise power spectrum .",
    "the map of the 2-d power spectrum of the noise obtained with sanepic ( noise correlations included ) is shown in figure  [ fig : sp2dnoisecasa_corr ] .",
    "the large bright spot around the center corresponds to a relatively isotropic component of correlated noise ( at least at large angular scales ) .",
    "it contains a large fraction of the noise power at large angular scales ( seen in the 1-d power spectrum in figure  [ fig : noise1dspcasa ] ) .",
    "a smaller , but significant fraction of the correlated noise is concentrated in directions perpendicular to the scan direction , as can be seen in the figure . as already discussed , the reason for this excess power is that the noise in the cross - scan direction is poorly constrained .",
    "this cross - scan component of the noise is significant all the way up to the pixel scale .",
    "we now focus on the signal - only timestream simulations . in order to demonstrate the superior performance of sanepic relative to simpler methods based on data filtering , we compare with a map - making method which consists of the following : we first remove the whole array average from each detector timestream and",
    "then make maps using sanepic , assuming no correlations between detectors .",
    "removing the array average reduces the signal to almost zero for scales larger than the array and so we expect no large scale structures to survive in the map .",
    "this sanepic `` common - mode subtraction '' method is still a better procedure than just reprojecting the data ( after common - mode subtraction ) with a well chosen filtering to suppress noise drifts ( at @xmath169hz , for instance , since that corresponds to the knee frequency of the independent part of the noise ) .",
    "this latter method is commonly used in the submillimeter community and is referred to as `` sky removal '' in reduction of scuba data @xcite .",
    "figure  [ fig : mapscasa ] shows the input map for one of the signal realizations ( left panel ) , as well as the maps obtained with sanepic ( correlations included , central panel ) and with the common - mode subtraction method ( right panel ) .",
    "results are expected to be worse in the second case , because of the extra filtering and also because sanepic gives less weighting to modes at lower frequency which are more contaminated by independent noise .",
    "we can see from figure  [ fig : mapscasa ] that part of the very large scale fluctuations with sizes of the order of the map are removed using sanepic , but apart from those very large scales , the input map and the sanepic map look very similar .",
    "more differences can be seen in the map obtained with the common - mode subtraction method .",
    "this is quantified in figure [ fig:1dpowercasa ] , which compares the 1-d power spectra of the two output maps , averaged over 20 simulations and multiplied by @xmath170 .",
    "recall that the input spectrum varies as @xmath164 and so deviations from a flat line are the result of the map - making reconstruction .",
    "note that the vertical scale is linear in figure  [ fig:1dpowercasa ] .    , displayed on a linear scale and averaged over 20 realizations of the simulations .",
    "the large angular scale behavior shows the effectively filtering of each map - making procedure , while the drop off at small scales is caused by the psf . ]    with sanepic , the power of the reconstructed map decreases for scales larger than about 30@xmath168 .",
    "there are three reasons for this : the power spectrum is computed over only a small fraction of the sky ( and for an apodized map ) , so that structures of the order of the map size are never fully recovered ; there is weak filtering of the timestreams at @xmath171hz and through the 5th order polynomial subtraction ; modes in the maps that are very weakly constrained in the map - making procedure tend not to be reconstructed through the matrix inversion procedure , since the matrix is very ill - conditioned and numerical problems occur .",
    "the last two effects are the dominant ones . as a result , modes which are preferentially filtered are those which lie perpendicular to the scan direction .    at angular scales smaller than about 2@xmath168",
    ", the power slightly decreases due to the smoothing effect of the pixelization .",
    "the transfer function at those scales is well described by a sinc function .",
    "turning now to the common - mode subtraction method , the power in the map is significantly reduced for scales larger than about 10@xmath168 , and drops rapidly to zero .",
    "this is because the common - mode subtraction removes power on all scales larger than the array . on smaller scales ,",
    "the filtering effect is relatively weak , and is reduced when the number of detectors increases .    for these particular simulations",
    "the common - mode subtraction method ( using sanepic , but with no correlations ) does not in fact perform _ very _ poorly compared to the sanepic optimal approach .",
    "this is because the observed field is small , with a size just a few times bigger than the array , and structure at scales smaller than the array size are not strongly affected .",
    "this particular map is also not cross - linked .",
    "however , the situation is different for large cross - linked maps like the vulpecula field , as discussed in section  [ sub : vulpecula ] .",
    "we now focus on the set of simulations of the g86  field at 500@xmath0 m . as in the previous example",
    ", we first examine the maps resulting from noise - only simulated timestreams using three methods : optimal sanepic ( with noise correlations taken into account ) ; sanepic without considering noise correlations between detectors ; and the simple co - add method .",
    "the chosen pixel size for the reconstructed maps is 1@xmath168 , which allows for inversion of the covariance matrix with a single processor and hence rapid monte carlo simulations .",
    "the conclusions drawn would remain unchanged if the pixel size was reduced .",
    "figure  [ fig : mapnivcg86 ] shows the final noise maps in the three cases for one realization of the simulations .",
    "the simple re - projection map is obviously very stripy and would be of little use as an estimate of the signal ; nevertheless it helps to visualize the directions of scanning in the map .",
    "we can see two main directions covering the central region of the map , oriented at about 50@xmath166 to each other .",
    "a third scanning direction is also visible but has a much smaller weight .",
    "the central part of the map is the cross - linked region , where we expect the more optimal map - making procedures to excel .    in the map obtained using sanepic _ without _ considering noise correlations between detectors ( middle panel of figure  [ fig : mapnivcg86 ] ) , some large scale noise is still visible in the map , even if almost no residual striping is apparent in the cross - linked region .",
    "indeed , too much weight is given to the large timescales in the timestreams ( which are basically common between all the detectors ) as compared to the smaller timescales for which there are more independent measurements , because the degree of correlation of the noise is weaker .",
    "the residual noise at large angular scales is much weaker in the sanepic map in which we account for the proper correlations of the noise between detectors ( left panel of figure  [ fig : mapnivcg86 ] ) .",
    "the noise in this map looks particularly white .",
    "the noise level in each simulated map is quantified in figure  [ fig : noise1dspivcg86 ] , showing the 1-d power spectrum of residual noise averaged over 20 simulations , and computed over the cross - linked region ( which has a diameter of about 100@xmath168 ) .    ) , for the blast05 g86  scanning configuration .",
    "these power spectra are computed only in the cross - linked region of the maps , which forms a large disk of about 100@xmath168 diameter and can be easily identified in figure  [ fig : mapnivcg86 ] .",
    "the dashed curve is for the simple re - projection map ( right panel of figure  [ fig : mapnivcg86 ] ) , the dot - dashed curve is for sanepic _ without _ consideration of noise correlations between detectors ( middle panel of figure  [ fig : mapnivcg86 ] ) , and the triple - dot - dashed curve is for sanepic _ including _ the correlation treatment ( left panel of figure  [ fig : mapnivcg86 ] ) .",
    "the horizontal line indicates the level of white noise in the map predicted by the map - making procedure .",
    "error bars are estimated from the dispersion among measurements for all the realizations .",
    "residual low frequency noise in the optimal sanepic map is very low , thanks to the multiple scanning directions of this field .",
    "the situation is much better than for the cas a  observational configuration , which had a single scan direction ( figure  [ fig : noise1dspcasa ] ) . ]",
    "while several orders of magnitude are gained in the noise power at all scales using the sanepic `` no correlation '' method as compared to the simple re - projection method , accounting for the correlations with sanepic allows us to further reduce the noise power on scales ranging from 20@xmath168 to the size of the map by an additional factor of @xmath172 . toward smaller scales ,",
    "the gain between the sanepic correlation versus no correlation test cases is still very significant down to about 10@xmath168 , where the both methods start to approach the white noise level . in the optimal map obtained with sanepic",
    "the ratio between the noise power spectrum at large scales and the white noise level is around 20 , which is relatively small .",
    "figure  [ fig:2dspectrumivcg86 ] shows the 2-d power spectra of the noise in the sanepic map averaged over 20 realizations . as expected , the large scale noise is more important in directions perpendicular to the scans .    ) for the blast05 g86  scanning configuration . ]",
    "we now focus on signal - only simulations for g86 . as in the case of the cas a  configuration ,",
    "we compare the performance of sanepic with respect to the simpler common - mode subtraction method .",
    "figure  [ fig : mapsivcg86 ] shows the pure signal input map for one realization of the simulations ( left panel ) compared with two recovered maps .",
    "the first output map is obtained with sanepic including correlations between detectors ( middle panel ) , while the second is obtained by subtracting the common mode between all detectors , followed by applying sanepic , but neglecting noise correlations between detectors ( right panel ) .",
    "we see that the very largest scales are not recovered by sanepic .",
    "this is because of the weak filtering applied to the timestreams and , to a greater extent , because of inversion problems with sanepic on scales of the order of the size of the map ( these scales are very poorly constrained by the map - making procedure ) . in the common - mode subtraction method , only the very largest scales are suppressed by the map - making procedure itself , but the filtering effect is more dramatic and extends to much smaller scales .    the effective filtering is quantified in figure  [ fig:1dpowerivcg86 ] , which shows the power spectra of output maps averaged over 20 simulations of pure signal timestreams .",
    "again the power spectra are multiplied by @xmath170 for comparison purposes .    , but for the blast05 g86   scanning configuration .",
    "power spectra are multiplied by @xmath170 , so that a flat line would indicate no filtering .",
    "the drop off at small angular scales is due to the blast05 psf . ]    in this case sanepic works well on scales up to about half a degree , above which it fails to recover structure in the map ; this limit corresponds to scales of about a quarter of the map and larger .",
    "the filtering effect is much more pronounced in the map produced with the common - mode subtraction method , being strong for all scales above around 14@xmath168 .",
    "this is of course expected , since subtracting the average of the array strongly reduces the signal on scales larger than the array size .",
    "therefore , in order to recover large and intermediate scale structure in the maps , it is beneficial to use sanepic instead of other methods that are based on simply filtering the data .",
    "the relative level of residual noise at low spatial frequency in the maps is significantly reduced in the g86  observational configuration as compared to the cas a  configuration .",
    "the fundamental difference is that the g86  observations contain multiple ( essentially two for most of the data ) scanning directions , while the cas a  observations are realized with only two passes across the field in the same direction .",
    "multiple scanning directions give a huge number of additional constraints for the map - making procedure .",
    "in particular , large scale structures in the map are much better recovered in directions parallel to scans , because the noise there is smaller . thus having multiple scanning angles allows for recovery of the sky fluctuations for all directions , and ends up giving almost no weight to the individual loosely constrained cross - scan k - modes .",
    "differences in the results for maps from these two example scanning strategies can be quantified in two ways .",
    "first of all , for the g86  scanning strategy , the transition between white noise and `` excess '' large scale noise in the map occurs at a scale around 10@xmath168 , while the same transition occurs at a scale of around 3@xmath168 for the cas a  scanning strategy .",
    "secondly , the ratio between large scale noise power and white noise power is larger by more than two orders of magnitude for cas a  than for g86 . on the other hand ,",
    "some caution should be taken to not over - interpret this comparison , because the pixel size we used is larger for the g86  map ( 1@xmath168 ) as compared to the cas a  map ( 25@xmath165 ) , and therefore the number of crossings per pixel is greater for the g86  map .",
    "nevertheless , this simulation exercise has demonstrated that cross - linking in the map is extremely beneficial , particularly for recovering the large scale structures in the map .      when carrying out a complex data processing procedure , it is important to check whether the results are biased in any way .",
    "we have found that the transfer function of the map - making procedure , defined as the ratio between the amplitude of fluctuations in the output pure signal map relative to the input map , is not always exactly unity , even for intermediate and small angular scales in the map .",
    "for example , in the cas a  configuration at 250@xmath0 m the fluctuation amplitudes in the final map are reduced by 3% on average as compared to the input map , almost uniformly across spatial frequencies and directions .",
    "this global discrepancy reaches the level of 9% at 500@xmath0 m .",
    "moreover , it is also present for the g86  configuration .",
    "we believe that this reduction is due to the fact that the pixel - pixel covariance is ill - conditioned and numerical imprecision occurs in the matrix inversion .",
    "we find that the bias tends to be smaller when the number of detectors is larger and also when the number of constraints increases , like when we have multiple scanning directions , or when we map isolated bright sources ( presented in truch et al .",
    "2007 ) and constrain the data outside a defined region to have a constant flux ( see section  [ sub : pixconstr ] for details of this procedure ) . since this bias can be estimated using simulations , it is straightforward to correct for .",
    "we have found that it is not always important , e.g.  for the large galactic map in the vulpecula region analyzed in chapin et al .",
    "( 2007 ) the bias is negligible .",
    "now that we have looked at signal - only and noise - only simulations , we now turn to real blast data . in this section ,",
    "we show maps of two example fields from the blast05 data which have been obtained using sanepic .",
    "figure  [ fig : mapcasa250 ] shows the map obtained from the observations of the cas a  field at 250@xmath0 m using sanepic including full consideration of the noise correlated between detectors .",
    "detailed analysis of the maps at the three wavelengths is described in hargrave et al .",
    "( in preparation ) .",
    "the properties of the noise and the transfer function of the signal in the map have been studied in detail from monte carlo simulations in section [ sub : casacase ] .",
    "results from such simulations are used to characterize the map .",
    "the power spectrum of this map has been compared to results from simulations in figure  [ fig : noise1dspcasa ] .",
    "m made from blast05 data using sanepic including noise correlations between detectors .",
    "the map is represented in galactic coordinates with 25@xmath165 pixels and has a size of about @xmath4 . ]",
    "the map structures are relatively smooth , due to the blast05 point spread function , which has a width of the order of 3@xmath168 , causing the drop in the 1-d power spectrum below those spatial scales .",
    "the signal clearly dominates over noise on angular scales larger than about 3@xmath168 , and the diffuse structure should be reliable up to a large fraction of the overall map size .",
    "another field observed during the blast05 campaign is centered in the galactic plane close to the open cluster ngc 6823 in the constellation of vulpecula .",
    "the region mapped has a size of about @xmath3 and was chosen for its high - mass star formation activity .",
    "complete analysis of this observed field is presented in @xcite .",
    "a few hours of these data were taken at different time intervals during the flight . by design , this field has been observed with very different scanning directions , and is therefore it should be possible to recover diffuse large scale structures .",
    "the map of the observed region at 250@xmath0 m obtained with sanepic is shown in figure  [ fig : mapl5b250 ] ( left panel ) .",
    "for comparison ( right panel ) , we have computed another map using a much simpler method which consists of removing the array average signal at each timestep for all of the timestreams and reprojecting the data onto the map after filtering .",
    "this is like the `` sky removal '' procedure often carried out for ground - based submillimeter data ( see also section  [ sec : casasignal ] ) .",
    "one can see that it suppresses almost all the diffuse structure in the map .",
    "no residual striping is visible in the map obtained with sanepic ( left panel of figure  [ fig : mapl5b250 ] ) , mainly due to the presence of multiple scanning directions for this field .",
    "large scale structures in the map are successfully recovered with sanepic , as can easily be seen by comparing with the right panel of figure  [ fig : mapl5b250 ] .",
    "this recovery applies to scales which are significantly larger than the array size .",
    "however , the resulting effective filtering after applying the `` array average subtraction '' method induces negative signals near bright sources in the map , while no such filtering effect is seen in the sanepic map ( except perhaps near the edges of the map ) .",
    "this shows that optimal map - making methods ( in the sense of least squares ) like sanepic are better suited to recover point sources in the maps as well as diffuse structures .",
    "large format detector arrays operating at far - ir and submillimeter wavelengths are becoming the norm , rather than the exception .",
    "ground - based instruments are plagued with common - mode emission arising from the earth s atmosphere . and as we have found with blast , the same applies to high frequency balloon - borne instruments , where we see correlated noise from thermal as well as atmospheric effects .",
    "there is an expectation that even upcoming satellites might be faced with similar issues , because of thermal variations in the spacecraft , for example . in general",
    ", we expect that correlated noise between detectors will be a major issue which all such experiments have to deal with , and we expect that the sanepic approach , which we have described here , will be widely applicable . indeed , there is evidence from existing arrays ( e.g. ,  sharc - ii and aztec ) that once there are many detectors , there are _ multiple _ correlations between sub - sets of the detectors , as well as an overall common - mode term .",
    "consequently , one sees correlations between contiguous blocks of detectors on the array , or sets of detectors which share amplifiers or are otherwise coupled through the electronics .",
    "provided that these correlations can be investigated and their behavior modelled , it is straightforward to extend the sanepic approach to deal with several distinct sources of correlated noise . hence we expect the sanepic approach to be applicable to future instruments such as scuba-2 , spire , act , _ planck",
    "_ hfi and others .",
    "there are also many experiments being planned which use large detector arrays to perform sensitive polarization measurements , and we see no reason why the sanepic approach could not also be extended to polarimetry .    the blast collaboration acknowledges the support of nasa through grant numbers nag5 - 12785 , nag5 - 13301 and nngo-6gi11 g , the canadian space agency ( csa ) , canada s natural sciences and engineering research council ( nserc ) , and the uk particle physics & astronomy research council ( pparc ) . we would also like to thank the columbia scientific balloon facility ( csbf ) staff for their outstanding work .",
    "we are grateful to matthew hasselfield and duncan hanson for valuable discussions which contributed to the development of sanepic .",
    "lo acknowledges partial support by the puerto rico space grant consortium and by the fondo istitucional para la investigacion of the university of puerto rico .",
    "cbn acknowledges support from the canadian institute for advanced research .",
    "this research made use of westgrid computing resources , which are funded in part by the canada foundation for innovation , alberta innovation and science , bc advanced education , and the participating research institutions ."
  ],
  "abstract_text": [
    "<S> we describe a map - making method which we have developed for the balloon - borne large aperture submillimeter telescope ( blast ) experiment , but which should have general application to data from other submillimeter arrays . our method uses a maximum likelihood based approach , with several approximations , which allows images to be constructed using large amounts of data with fairly modest computer memory and processing requirements . this new approach </S>",
    "<S> , signal and noise estimation procedure including correlations ( sanepic ) , builds upon several previous methods , but focuses specifically on the regime where there is a large number of detectors sampling the same map of the sky , and explicitly allowing for the the possibility of strong correlations between the detector timestreams . </S>",
    "<S> we provide real and simulated examples of how well this method performs compared with more simplistic map - makers based on filtering . </S>",
    "<S> we discuss two separate implementations of sanepic : a brute - force approach , in which the inverse pixel - pixel covariance matrix is computed ; and an iterative approach , which is much more efficient for large maps . </S>",
    "<S> sanepic has been successfully used to produce maps using data from the 2005 blast flight . </S>"
  ]
}