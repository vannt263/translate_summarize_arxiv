{
  "article_text": [
    "the understanding of ferroelectric and piezoelectric materials , whose physics is dominated by soft phonon modes , has benefited greatly from the availability of first - principles methods for calculating phonon properties . in general , these methods can be classified into two main types , the direct or frozen - phonon approach@xcite and the linear - response approach.@xcite in the former approach , the properties of phonons at commensurate wavevectors are obtained from supercell calculations of forces or total - energy changes between between equilibrium and distorted structures . in the latter approach , based on density - functional perturbation theory ( dfpt ) ,",
    "expressions are derived for the second derivatives of the total energy with respect to atomic displacements , and these are calculated by solving a sternheimer equation@xcite or by using minimization methods.@xcite compared to the direct approach , the linear - response approach has important advantages in that time - consuming supercell calculations are avoided and phonons of arbitrary wavevector can be treated with a cost that is independent of wavevector . however , existing linear - response methods work only at zero electric field .",
    "the development of first - principles methods for treating the effect of an electric field @xmath0 in a periodic system has been impeded by the presence of the electrostatic potential @xmath1 in the hamiltonian .",
    "this potential is linear in real space and unbounded from below , and thus is incompatible with periodic boundary conditions .",
    "the electronic bandstructure becomes ill - defined after application of a potential of this kind .",
    "many attempts have been made to overcome this difficulty .",
    "for example , linear - response approaches have been used to treat the electric field as a perturbation.@xcite it is possible to formulate these approaches so that only the off - diagonal elements of the position operator , which remain well defined , are needed , thus allowing for the calculation of born effective charges , dielectric constants , etc . since it is a perturbative approach , a finite electric field can not be introduced .",
    "recently , a total - energy method for treating insulators in nonzero electric fields has been proposed.@xcite in this approach , an electric enthalpy functional is defined as a sum of the usual kohn - sham energy and an @xmath2 term expressing the linear coupling of the electric field to the polarization @xmath3 .",
    "the enthalpy functional is minimized with respect to field - polarized bloch states , and the information on the response to the electric field is contained in these optimized bloch states . using this approach",
    ", it is possible to carry out calculations of dynamical effective charges , dielectric susceptibilities , piezoelectric constants , etc . ,",
    "using finite - difference methods.@xcite it would also be possible to use it to study phonon properties in finite electric field , but with the aforementioned limitations ( large supercells , commensurate wavevectors ) of the direct approach .    in this work ,",
    "we build upon these recent developments by showing how to extend the linear - response methods so that they can be applied to the finite - field case .",
    "that is , we formulate dfpt for the case in which the unperturbed system is an insulator in a finite electric field .",
    "focusing on the case of phonon perturbations , we derive a tractable computational scheme and demonstrate its effectiveness by carrying out calculations of phonon properties of polar semiconductors in finite electric fields .",
    "this paper is organized as follows . in sec .",
    "[ sec : tef ] we review the total - energy functional appropriate for describing an insulator in an electric field , and discuss the effect of the electric field on the phonon frequencies both for our exact theory and for a previous approximate theory .",
    "the second - order expansion of the total - energy functional is derived in sec .",
    "[ sec : peeef ] , and expressions for the force - constant matrix are given , first for phonons at the brillouin zone center and then for arbitrary phonons . in sec .",
    "[ sec : test ] we report some test calculations of field - induced changes of phonon frequencies in the iii - v semiconductors gaas and alas . section v contains a brief summary and conclusion .",
    "we start from the electric enthalpy functional @xcite @xmath4=e_{\\rm ks}[\\r;\\psi ] -\\omega \\e\\cdot \\pmac[\\psi ]   , \\label{eq : ftotal}\\ ] ] where @xmath5 has the same form as the usual kohn - sham energy functional in the absence of an electric field . here",
    "@xmath6 is the cell volume , @xmath7 is the macroscopic polarization , @xmath0 is the homogeneous electric field , @xmath8 are the atomic positions , and @xmath9 are the field - polarized bloch functions .",
    "note that @xmath7 has both ionic and electronic contributions .",
    "the former is an explicit function of @xmath8 , while the latter is an implicit function of @xmath8 through the bloch functions , which also depend on the atomic positions .",
    "when an electric field is present , a local minimum of this functional describes a long - lived metastable state of the system rather than a true ground state ( indeed , a true ground state does not exist in finite electric field).@xcite    according to the modern theory of polarization,@xcite the electronic contribution to the macroscopic polarization is given by @xmath10 where @xmath11 is the charge of an electron ( @xmath12 ) , @xmath13=2 for spin degeneracy , @xmath14 is the number of occupied bands , @xmath15 are the cell - periodic bloch functions , and the integral is over the brillouin zone ( bz ) . making the transition to a discretized k - point mesh ,",
    "this can be written in a form @xmath16 that is amenable to practical calculations . in this expression , for each lattice direction @xmath17 associated with primitive lattice vector @xmath18 , the bz is sampled by @xmath19 strings of k - points , each with @xmath20 points spanning along the reciprocal lattice vector conjugate to @xmath18 , and @xmath21 are the overlap matrices between cell - periodic bloch vectors at neighboring locations along the string . because eqs .",
    "( [ eq : pmacc]-[eq : pmac ] ) can be expressed in terms of berry phases , this is sometimes referred to as the `` berry - phase theory '' of polarization .",
    "we work in the framework of a classical zero - temperature theory of lattice dynamics , so that quantum zero - point and thermal anharmonic effects are neglected . in this context ,",
    "the phonon frequencies of a crystalline insulator depend upon an applied electric field in three ways : ( i ) via the variation of the equilibrium lattice vectors ( i.e. , strain ) with applied field ; ( ii ) via the changes in the equilibrium atomic coordinates , even at fixed strain ; and ( iii ) via the changes in the electronic wavefunctions , even at fixed atomic coordinates and strain .",
    "effects of type ( i ) ( essentially , piezoelectric and electrostrictive effects ) are beyond the scope of the present work , but are relatively easy to include if needed .",
    "this can be done by computing the relaxed strain state as a function of electric field using the approach of ref .  , and then computing the phonon frequencies in finite electric field for these relaxed structures using the methods given here .",
    "therefore , in the remainder of the paper , the lattice vectors are assumed to be independent of electric field unless otherwise stated , and we will focus on effects of type ( ii ) ( `` lattice effects '' ) and type ( iii ) ( `` electronic effects '' ) .    in order to separate these two types of effects ,",
    "we first write the change in phonon frequency resulting from the application of the electric field as @xmath22 where @xmath23 is the phonon frequency extracted from the second derivative of the total energy of eq .",
    "( [ eq : ftotal ] ) with respect to the phonon amplitude of the mode of wavevector @xmath24 , evaluated at displaced coordinated @xmath25 and with electrons experiencing electric field @xmath0 . also , @xmath26 are the relaxed atomic coordinates at electric field @xmath0 , while @xmath27 are the relaxed atomic coordinates at zero electric field",
    ". then eq .",
    "( [ eq : dwtot ] ) can be decomposed as @xmath28 where the electronic part of the response is defined to be @xmath29 and the lattice ( or `` ionic '' ) part of the response is defined to be @xmath30 in other words , the electronic contribution reflects the influence of the electric field on the wavefunctions , and thereby on the force - constant matrix , but evaluated at the zero - field equilibrium coordinates . by contrast , the ionic contribution reflects the additional frequency shift that results from the field - induced ionic displacements .    the finite - electric - field approach of refs .",
    "- provides the methodology needed to compute the relaxed coordinates @xmath26 , and the electronic states , at finite electric field @xmath0 .",
    "the remainder of this work is devoted to developing and testing the techniques for computing @xmath23 for given @xmath24 , @xmath31 , and @xmath0 , needed for the evaluation of eq .",
    "( [ eq : dwtot ] ) .",
    "we shall also use these methods to calculate the various quantities needed to perform the decomposition of eqs .",
    "( [ eq : dwtwo]-[eq : wion ] ) , so that we can also present results for @xmath32 and @xmath33 separately in sec .",
    "[ sec : test ] .",
    "our approach above is essentially an exact one , in which eq .",
    "( [ eq : dwtot ] ) is evaluated by computing all needed quantities at finite electric field .",
    "however , we will also compare our approach with an approximate scheme that has been developed in the literature over the last few years,@xcite in which the electronic contribution is neglected and the lattice contribution is approximated in such a way that the finite - electric - field approach of refs .",
    "- is not needed .",
    "this approximate theory can be formulated by starting with the approximate electric enthalpy functional@xcite",
    "ks}[\\r ] -\\omega \\e\\cdot \\pmac^{(0)}[\\r ]   \\label{eq : fsai},\\ ] ] where @xmath35 $ ] is the _ zero - field _ ground - state kohn - sham energy at coordinates @xmath25 , and @xmath36 is the corresponding _ zero - field _ electronic polarization . in the presence of an applied electric field",
    "@xmath0 , the equilibrium coordinates that minimize eq .",
    "( [ eq : fsai ] ) satisfy the force - balance equation @xmath37 where @xmath38 is the _ zero - field _ dynamical effective charge tensor .",
    "that is , the sole effect of the electric field is to make an extra contribution to the atomic forces that determine the relaxed displacements ; the electrons themselves do not `` feel '' the electric field except indirectly through these displacements . in ref .",
    ", it was shown that this theory amounts to treating the coupling of the electric field to the electronic degrees of freedom in linear order only , while treating the coupling to the lattice degrees of freedom to all orders .",
    "such a theory has been shown to give good accuracy in cases where the polarization is dominated by soft polar phonon modes , but not in systems in which the electronic and lattice polarizations are comparable.@xcite    in this approximate theory , the effect of the electric field on the lattice dielectric properties@xcite and phonon frequencies@xcite comes about through the field - induced atomic displacements .",
    "thus , in the notation of eqs .",
    "( [ eq : dwtot]-[eq : wion ] ) , the frequency shift ( relative to zero field ) is @xmath39 in this approximation , where @xmath40 is the equilibrium position according to eq .",
    "( [ eq : forcebal ] )",
    ". we will make comparisons between the exact @xmath26 and the approximate @xmath40 , and the corresponding frequency shifts @xmath41 and @xmath42 later in sec .",
    "[ sec : test ] .",
    "we consider an expansion of the properties of the system in terms of small displacements @xmath43 of the atoms away from their equilibrium positions , resulting in changes in the charge density , wavefunctions , total energy , etc",
    ". we will be more precise about the definition of @xmath43 shortly .",
    "we adopt a notation in which the perturbed physical quantities are expanded in powers of @xmath43 as @xmath44 where @xmath45 .",
    "the immediate dependence upon atomic coordinates is through the external potential @xmath46 , which has no electric - field dependence and thus depends upon coordinates and pseudopotentials in the same way as in the zero - field case .",
    "the changes in electronic wavefunctions , charge density , etc . can then be regarded as being induced by the changes in @xmath47 .",
    "the nuclear positions can be expressed as @xmath48 where @xmath49 is a lattice vector , @xmath50 is a basis vector within the unit cell , and @xmath51 is the instantaneous displacement of atom @xmath52 in cell @xmath53 .",
    "we consider in this section a phonon of wavevector @xmath54 , so that the perturbation does not change the periodicity of the crystal , and the perturbed wavefunctions satisfy the same periodic boundary condition as the unperturbed ones . to be more precise , we choose one sublattice @xmath52 and one cartesian direction @xmath55 and let @xmath56 ( independent of @xmath53 ) , so that we are effectively moving one sublattice in one direction while while freezing all other sublattice displacements . since the electric enthalpy functional of eq .",
    "( [ eq : ftotal ] ) is variational with respect to the field - polarized bloch functions under the constraints of orthonormality , a constrained variational principle exists for the second - order derivative of this functional with respect to atomic displacements.@xcite in particular , the correct first - order perturbed wavefunctions @xmath57 can be obtained by minimizing the second - order expansion of the total energy with respect to atomic displacements , @xmath58&= &     \\min_{\\psi^{(1)}}\\bigg(e_{\\rm ks}[\\psi^{(0)}_{m\\k};\\psi^{(1)}_{m\\k}]\\\\ & & -\\omega \\pmac[\\psi^{(0)}_{m\\k};\\psi^{(1)}_{m\\k}]\\cdot \\e\\bigg)^{(2 ) } , \\label{eq : ftwo}\\end{aligned}\\ ] ] subject to the constraints @xmath59 ( where @xmath60 and @xmath53 run over occupied states ) .",
    "the fact that only zero - order and first - order wavefunctions appear in eq .",
    "( [ eq : ftwo ] ) is a consequence of the `` 2@xmath53 + 1 theorem.''@xcite    recalling that @xmath61 is the first - order wavefunction response to a small real displacement @xmath43 of basis atom @xmath62 along cartesian direction @xmath55 , we can expand the external potential as @xmath63 where @xmath64 @xmath65 etc . from this",
    "we shall construct the second - order energy @xmath66 of eq .",
    "( [ eq : ftwo ] ) , which has to be minimized in order to find @xmath61 . the minimized value of @xmath66 gives , as a byproduct , the diagonal element of the force - constant matrix associated with displacement @xmath67 .",
    "once the @xmath61 have been computed for all @xmath67 , the off - diagonal elements of the force - constant matrix can be calculated using a version of the @xmath68 theorem as will be described in sec .",
    "[ sec : fcmatrix ] .      in practice",
    ", we always work on a discretized mesh of k - points , and we have to take into account the orthogonality constraints among wavefunctions at a given k - point on the mesh . here",
    ", we are following the `` perturbation expansion after discretization '' ( pead ) approach introduced in ref .  .",
    "that is , we write down the energy functional in its discretized form , and then consistently derive perturbation theory from this energy functional . introducing lagrange multipliers",
    "@xmath69 to enforce the orthonormality constraints @xmath70 where @xmath71 are the bloch wavefunctions , and letting @xmath72 be the number of k - points , the effective total - energy functional of eq .",
    "( [ eq : ftotal ] ) can be written as @xmath73 where @xmath74 , @xmath75 , and @xmath76 are the kohn - sham , berry - phase , and lagrange - multiplier terms , respectively .",
    "the first and last of these are given by @xmath77 , \\label{eq : fbiga}\\ ] ] and @xmath78 where @xmath72 is the number of k - points in the bz .",
    "as for the berry - phase term , we modify the notation of eq .",
    "( [ eq : pmac ] ) slightly to write this as @xmath79 where @xmath80 and @xmath81 is the reciprocal lattice mesh vector in lattice direction @xmath17 .",
    "( that is , @xmath82 and @xmath83 are neighboring k - points in one of the @xmath19 strings of k - points running in the reciprocal lattice direction conjugate to @xmath18 . )",
    "recall that the matrix of bloch overlaps was defined in eq .",
    "( [ eq : sdef ] ) .",
    "we now expand all quantities in orders of the perturbation , e.g. , @xmath84 , etc .",
    "similarly , we expand @xmath85 , and we also define @xmath86^{-1 } \\label{eq : qdef}\\ ] ] to be the inverse of the zero - order @xmath87 matrix . applying the @xmath68 theorem to eq .",
    "( [ eq : fbig ] ) , the variational second - order derivative of the total - energy functional is @xmath88 where @xmath89     + e_{\\rm hxc}^{(2)}[n ] \\ ; , \\label{eq : ftwoa } \\\\",
    "\\nonumber\\\\ f^{(2)}_{\\rm bp}&=&- \\frac{ef}{4\\pi}\\sum_{i=1}^{3}\\frac{\\e \\cdot a_i } { n_{\\perp } ^{(i ) } } \\sum_{\\k}d^{(2)}_{\\k,\\k+\\g_i } \\ ; , \\label{eq : ftwob } \\\\",
    "\\nonumber\\\\ f^{(2)}_{\\rm lm}&= & \\frac{1}{n}-\\sum_{{\\bf k},mn } \\big [ \\ ,     \\lambda^{(1)}_{{\\bf k},mn } \\ , \\big ( \\ ,     \\langle\\psi_{m{\\bf k}}^{(1)}|\\psi_{n{\\bf k}}^{(0)}\\rangle + \\langle \\psi_{m{\\bf k}}^{(0)}|\\psi_{n{\\bf k}}^{(1)}\\rangle \\ , \\big ) \\nonumber\\\\ & & \\hskip 2.6 cm    + \\lambda^{(0)}_{{\\bf k},mn}\\langle     \\psi_{m{\\bf k}}^{(1)}|\\psi_{n{\\bf k}}^{(1)}\\rangle   \\ , \\big ] \\;. \\label{eq : ftwoc}\\end{aligned}\\ ] ] in the berry - phase term , eq .",
    "( [ eq : ftwob ] ) , we use the approach of ref .   to obtain the expansion of @xmath90 with respect to the perturbation .",
    "it then follows that @xmath91 \\label{eq : dtwo}\\ ] ] where @xmath92 , @xmath93 and @xmath94 are regarded as @xmath95 matrices ( @xmath96 is the number of occupied bands ) , matrix products are implied , and tr is a matrix trace running over the occupied bands . finally , in the lagrange - multiplier term",
    ", eq .  ( [ eq : ftwoc ] ) , a contribution @xmath97 has been dropped from eq .",
    "( [ eq : ftwoc ] ) because the zero - order wavefunctions , which have been calculated in advance , always satisfy the orthonormality constraints @xmath98 .",
    "moreover , the zero - order lagrange multipliers are made diagonal by a rotation among zero - order wavefunctions at each k point , and the first - order wavefunctions are made orthogonal to the zero - order ones at each iterative step , so that eq .",
    "( [ eq : ftwoc ] ) simplifies further to become just @xmath99 here , we have restored the notation @xmath100 for the diagonal zero - order lagrange multipliers .",
    "the second - order expansion of the electric enthalpy functional in eq .",
    "( [ eq : fparts ] ) is minimized with respect to the first - order wavefunctions using a  band - by - band \" conjugate - gradient algorithm.@xcite for a given point @xmath82 and band @xmath60 , the steepest - descent direction at iteration @xmath101 is @xmath102 , where @xmath66 is given by eqs .",
    "( [ eq : ftwoa]-[eq : ftwob ] ) and ( [ eq : ftwocp ] ) .",
    "the derivatives of @xmath103 and @xmath104 are straightforward ; the new element in the presence of an electric field is the term @xmath105 where @xmath106 in this equation , @xmath107 and @xmath108 are regarded as vectors of length @xmath96 ( e.g. , @xmath109 , @xmath110 ) , and vector - matrix and matrix - matrix products of dimension @xmath96 are implied inside the parentheses .",
    "also , @xmath111 are the first - order perturbed overlap matrices at neighboring k - points .",
    "the standard procedure translates the steepest - descent directions @xmath112 into preconditioned conjugate - gradient search directions @xmath113 .",
    "an improved wavefunction for iteration @xmath114 is then obtained by letting @xmath115 where @xmath116 is a real number to be determined .",
    "since the @xmath116-dependence of @xmath117 is quadratic , the minimum of @xmath66 along the conjugate - gradient direction is easily determined to be @xmath118      to calculate phonon frequencies , we have to construct the force - constant matrix @xmath119 each diagonal element @xmath120 has already been obtained by minimizing the @xmath66 in eq .  ( [ eq : fparts ] ) for the corresponding perturbation @xmath121 . the off - diagonal elements @xmath122 can also be determined using only the first - order wavefunctions @xmath123 using the ( non - variational ) expression @xmath124 where @xmath125 etc .      in the case of a phonon of arbitrary wavevector @xmath24 ,",
    "the displacements of the atoms are essentially of the form @xmath126 , where @xmath43 is a complex number .",
    "however , a perturbation of this form does not lead by itself to a hermitian perturbation of the hamiltonian .",
    "this is unacceptable , because we want the second - order energy to remain real , so that it can be straightforwardly minimized .",
    "thus , we follow the approach of ref .   and take the displacements to be @xmath127 leading to @xmath128 where @xmath129 @xmath130 etc . similarly , the field - dependent bloch wavefunctions @xmath9 and enthalpy functional @xmath131 can also be expanded in terms of @xmath43 and its hermitian conjugate as @xmath132 and @xmath133&=&\\lambda f^{(0)}[\\e]+f_{\\q}^{(1)}[\\e ] + \\lambda^*f_{{-\\bf q}}^{(1)}[\\e]\\\\ \\nonumber & + & \\lambda^{2}f_{\\q,\\q}^{(2)}[\\e ] + 2\\lambda \\lambda^{*}f_{\\q,{-\\bf q}}^{(2)}[\\e]\\\\ & + & { \\lambda^{*}}^{2}f_{{-\\bf q},{-\\bf q}}^{(2)}[\\e ] + ... \\;. \\label{eq : fqexpan}\\end{aligned}\\ ] ] the first - order wavefunctions in response to a perturbation with wavevector @xmath24 have translational properties @xmath134 that differ from those of the zero - order wavefunctions @xmath135 as a result , we can not simply work in terms of perturbed bloch functions or use the usual berry - phase expression in terms of strings of bloch functions .",
    "also , in contrast to the @xmath24=0 case , in which only one set of first - order wavefunctions was needed , we now need to solve for two sets @xmath136 corresponding to the non - hermitian perturbation at wavevector @xmath24 and its hermitian conjugate at wavevector @xmath137.@xcite    we now proceed to write out the second - order energy functional @xmath138 $ ] , corresponding to the sum of the quadratic terms in eq .",
    "( [ eq : fqexpan ] ) , and minimize it simultaneously with respect to @xmath139 and @xmath140 .    first , making the same decomposition as in eq .",
    "( [ eq : fparts ] ) , we find that the kohn - sham part is @xmath141 + e_{-\\q,\\q}^{(2)}[\\psi^{(0)}_{m{\\bf k}};\\psi^{(1)}_{{m{\\bf k}},\\q } ] \\;,\\ ] ] where @xmath142 note that terms @xmath143 and @xmath144 vanish , essentially because such terms transform like perturbations of wavevector @xmath145 which , except when @xmath146 equals a reciprocal lattice vector , are inconsistent with crystal periodicity and thus can not appear in the energy expression .",
    "( if @xmath146 is equal to a reciprocal lattice vector , @xmath143 and @xmath144 still vanish , as can be shown using time - reversal symmetry . )",
    "second , we consider the berry - phase coupling term .",
    "the treatment of this term is rather subtle because , as mentioned above , the perturbed wavefunctions are now admixtures of parts with periodicity as in eq .",
    "( [ eq : kqbc ] ) and as in eq .",
    "( [ eq : kbc ] ) , so that the usual berry - phase formula for the polarization@xcite can not be used .",
    "a different approach is needed now in order to express the polarization in terms of the perturbed wavefunctions . for this purpose",
    ", we consider a virtual supercell in which the wavevectors @xmath82 and @xmath24 would be commensurate , and make use of the definition introduced by resta@xcite specialized to the non - interacting case . the details of this treatment are deferred to the appendix , but the results can be written in the relatively simple form @xmath147 where @xmath148 \\label{eq : loops}\\end{aligned}\\ ] ] with @xmath149 given by eq .",
    "( [ eq : qdef ] ) and the superscript notation @xmath150 . from eqs .",
    "( [ eq : sdef ] ) and ( [ eq : kqbc ] ) , we can write these explicitly as @xmath151 @xmath152 @xmath153 third , the treatment of the lagrange - multiplier term is straightforward ; in analogy with eq .",
    "( [ eq : ftwocp ] ) , we obtain @xmath154    if we look closely at eq .",
    "( [ eq : loops ] ) , we see that the second term involves not simply pairs of k - points separated by the mesh vector @xmath155 , but _",
    "quartets _ of k - points , as illustrated in fig .",
    "[ fig : kpoint ] . reading from left to right in the second term of eq .",
    "( [ eq : loops ] ) , the k - point labels are @xmath82 , then @xmath156 , then @xmath157 , then @xmath158 , and finally back to @xmath82 .",
    "this is the loop illustrated in fig .",
    "[ fig : kpoint ] .",
    "each dark arrow represents a matrix element of @xmath159 , @xmath160 , or @xmath94 ; the gray arrow indicates the phonon @xmath24-vector .",
    "these loops arise because there are two kinds of coupling between k - points entering into the present theory .",
    "first , even in the absence of the phonon perturbation , wavevectors at neighboring k - points separated by mesh vector @xmath155 are coupled by the @xmath2 term in the energy functional .",
    "second , the phonon introduces a perturbation at wavevector @xmath24 .",
    "it is the interplay between these two types of inter - k - point coupling that is responsible for the appearance of these four - point loops in the expression for @xmath161 .",
    "the implementation of the conjugate - gradient minimization algorithm proceeds in a manner very similar to that outlined in sec .",
    "[ sec : cg ] . naively , one would have to work simultaneously with the two search - direction vectors @xmath162 where @xmath163 are the periodic parts of @xmath164 .",
    "however , minimizing the second - order energy @xmath66 with respect to two sets of first - order wavefunctions @xmath165 would double the computational cost and would involve substantial restructuring of existing computer codes .",
    "we can avoid this by using the fact that the second - order energy is invariant under time reversal to eliminate one set of first - order wavefunctions @xmath166 in favor of the other set @xmath167 following the approach given in ref .  .",
    "specifically , the two sets of first - order wavefunctions are related by @xmath168 where @xmath169 is an arbitrary phase independent of @xmath170 .",
    "the arbitrary phase @xmath169 cancels out in the expression of @xmath66 since every term in @xmath66 is independent of the phase of the first - order wavefunctions .",
    "thus , we choose @xmath171 for simplicity and write the second - order energy functional in terms of wavefunctions @xmath172 only .",
    "the minimization procedure now proceeds in a manner similar to the zero - wavevector case , except that the calculation of the berry - phase part involves some vector - matrix - matrix products as in eq .",
    "( [ eq : matmul ] ) , but circulating around three of the sides of the loop in fig .",
    "[ fig : kpoint ] . since @xmath66 remains in a quadratic form ,",
    "the minimum of @xmath66 is again easily searched along the conjugate - gradient direction .",
    "wavefunctions are updated over k - points one after another , and the first - order wavefunctions are updated .",
    "this procedure continues until the self - consistent potential is converged .",
    "once the first - order responses of wavefunctions are obtained , the diagonal elements of the dynamical matrix are obtained by evaluating @xmath66 , and the off - diagonal elements are obtained from a straightforward generalization of eq .",
    "( [ eq : eod ] ) , @xmath173",
    "in order to test our method , we have carried out calculations of the frequency shifts induced by electric fields in two iii - v semiconductors , alas and gaas .",
    "we have chosen these two materials because they are well - studied systems both experimentally and theoretically , and because the symmetry allows some phonon mode frequencies to shift linearly with electric field while others shift quadratically . since our main purpose is to check the internal consistency of our theoretical approach , we focus on making comparisons between the shifts calculated using our new linear - response method and those calculated using standard finite - difference methods . moreover , as mentioned at the start of sec .",
    "[ sec : exact ] , we have chosen to neglect changes in phonon frequencies that enter through the electric - field induced strains ( piezoelectric and electrostrictive effects ) , and we do this consistently in both the linear - response and finite - difference calculations .",
    "for this reason , our results are not immediately suitable for comparison with experimental measurements .",
    "our calculations are carried out using a plane - wave pseudopotential approach to density - functional theory .",
    "we use the abinit code package,@xcite which incorporates the finite electric field method of souza _",
    "et al._@xcite for the ground - state and frozen - phonon calculations in finite electric field .",
    "we then carried out the linear - response calculations with a version of the code that we have modified to implement the linear - response formulas of the previous section .",
    "the details of the calculations are as follows .",
    "we use troullier - martins norm - conserving pseudopotentials,@xcite the teter pade parameterization@xcite of the local - density approximation , and a plane - wave cutoff of 16 hartree .",
    "a 10@xmath17410@xmath17410 monkhorst - pack@xcite k - point sampling was used , and we chose lattice constants of 10.62  and 10.30  for alas and gaas , respectively .",
    "the crystals are oriented so that the vector @xmath175 points from a ga or al atom to an as atom .",
    "lrrrr & & mode & fd & lr & fd & lr @xmath176 o1 & @xmath1773.856 & @xmath1773.856 & @xmath1775.941 & @xmath1775.941 @xmath176 o2 & @xmath1770.282 & @xmath1770.281 & @xmath1770.300 & @xmath1770.299 @xmath176 o3 & 3.548 & 3.548 & 5.647 & 5.647 l lo & 2.701 & 2.703 & 4.282&4.282 l to1 & @xmath1773.749&@xmath1773.749 & @xmath1775.663&@xmath1775.663",
    "l to2 & 0.567&0.564 & 0.952 & 0.952 x lo & 0.050 & 0.050 & @xmath1770.243 & @xmath1770.243 x to1 & @xmath1773.953 & @xmath1773.953 & @xmath1776.083 & @xmath1776.083 x to2 & 3.753 & 3.753 & 5.919 & 5.919    [ table:1 ]    table [ table:1 ] shows the changes in phonon frequencies resulting from an electric field applied along a cartesian direction at several high - symmetry q - points in gaas and alas . both the electronic and ionic contributions , eqs .",
    "( [ eq : wel]-[eq : wion ] ) , are included .",
    "we first relaxed the atomic coordinates in the finite electric field until the maximum force on any atom was less than @xmath178hartree / bohr .",
    "we then carried out the linear - response calculation , and in addition , to check the internal consistency of our linear - response method , we carried out a corresponding calculation using a finite - difference frozen - phonon approach . for the latter ,",
    "the atoms were displaced according to the normal modes obtained from our linear - response calculation , with the largest displacement being 0.0025 bohr .",
    "( because the electric field lowers the symmetry , the symmetry - reduced set of k - points is not the same as in the absence of the electric field . )",
    "the agreement between the finite - different approach and the new linear - response implementation can be seen to be excellent , with the small differences visible for some modes being attributable to truncation in the finite - difference formula and the finite density of the k - point mesh .    in table",
    "[ table : twopart ] , we decompose the frequency shifts into the ionic contribution @xmath179 and the electronic contribution @xmath180 defined by eqs .",
    "( [ eq : wion ] ) and ( [ eq : wel ] ) , respectively , calculated using the linear - response approach .",
    "it is clear that the largest contributions are ionic in origin .",
    "for example , the large , roughly equal and opposite shifts of the o1 and o3 modes at @xmath176 arise from the ionic terms . however , there are special cases ( e.g. , o2 at @xmath176 and lo at x ) for which the ionic contribution happens to be small , so that the electronic contribution is comparable in magnitude .",
    "the pattern of ionic splittings appearing at @xmath176 can be understood as follows . because the non - analytic long - range coulomb contribution is not included",
    ", the three optical modes at @xmath176 are initially degenerate with frequency @xmath181 in the unperturbed lattice . a first - order electric field along @xmath182",
    "induces a first - order relative displacement @xmath183 of the two sublattices , also along @xmath182 . by symmetry considerations ,",
    "the perturbed dynamical matrix is given , up to quadratic order in @xmath183 , as @xmath184 the off - diagonal @xmath185 term arises from the @xmath186 coupling in the expansion of the total energy in displacements ; this is the only third - order term allowed by symmetry .",
    "the @xmath187 and @xmath52 terms arise from fourth - order couplings of the form @xmath188 and @xmath189 respectively .",
    "the eigenvalues of this matrix are proportional to @xmath190 and @xmath191 .",
    "thus , two of the modes should be perturbed at first order in the field - induced displacements with a pattern of equal and opposite frequency shifts , while all three modes should have smaller shifts arising from the quadratic terms .",
    "this is just what is observed in the pattern of frequency shifts shown in table [ table : twopart ] .",
    "( the symmetry of the pattern of electronic splittings is the same , but it turns out that the linear shift is much smaller in this case , so that for the chosen electric field , the linear and quadratic contributions to the electronic frequency shift have similar magnitudes . ) a similar analysis can be used to understand the patterns of frequency shifts at the @xmath96 and @xmath192 points .",
    "lrrrr & & & ion & elec . & ion & elec .",
    "o1 & @xmath1773.659&@xmath1770.198 & @xmath1775.684 & @xmath1770.257 @xmath176 o2 & @xmath1770.146 & @xmath1770.135 & @xmath1770.123 & @xmath1770.177@xmath176 o3 & 3.655 & @xmath1770.107 & 5.589 & 0.058 l lo & 2.341 & 0.362 & 3.633 & 0.649 l to1 & @xmath1773.486 & @xmath1770.262 & @xmath1775.628 & @xmath1770.034l to2 & 1.181 & @xmath1770.617 & 1.658 & @xmath1770.707 x lo & 0.122 & @xmath1770.073 & @xmath1770.033 & @xmath1770.209 x to1 & @xmath1773.411 & @xmath1770.543 & @xmath1775.658 & @xmath1770.424 x to2 & 3.388 & 0.365 & 5.609 & 0.310    [ table : twopart ]    we have also plotted , in fig .  [ fig : test ] , the calculated total frequency shift @xmath193 and its electronic contribution @xmath194 along the line from @xmath176 to l for the case of alas .",
    "( the ` lo ' and ` to ' symmetry labels are not strictly appropriate here because the electric field along @xmath182 mixes the mode eigenvectors ; the notation indicates the mode that would be arrived at by turning off the field . )",
    "in contrast to the results presented in tables [ table:1]-[table : twopart ] , the frequencies at @xmath176 in fig .",
    "[ fig : test ] were computed by including the long - range non - analytic coulomb contribution for @xmath195 in order to extend the curves to @xmath196 .",
    "( because the direct linear - response calculation of the dynamical effective charge and dielectric susceptibility tensors are not yet developed and implemented in the presence of a finite electric field , the needed tensor elements were computed by finite differences . )",
    "it is clearly evident that the electronic terms remain much smaller than the ionic ones for all three optical modes over the entire branch in @xmath197-space .",
    "llcrrr & & & & & ( 10@xmath198 ) & lo & to1 & to2 gaas & approx .",
    "& 5.07 & 2.63 & @xmath1773.89 & 1.37 & exact & 4.95 & 2.34 & @xmath1773.49 & 1.18 alas & approx . & 5.69 & 3.75 & @xmath1775.66 & 1.65 & exact & 5.62 & 3.63 & @xmath1775.63 & 1.66    [ table : three ]    returning now to the comparison between our exact theory of sec .",
    "[ sec : exact ] and the approximate theory of sec .  [ sec : approx ] , we compare the equilibrium positions and phonon frequencies predicted by these theories in table [ table : three ] .",
    "recall that @xmath199 is calculated in the approximate theory by using eq .",
    "( [ eq : forcebal ] ) . using this force",
    ", the ion coordinates were again relaxed to a tolerance of @xmath178 ( hartree / bohr ) on the forces .",
    "it can be seen that @xmath199 is predicted quite well by the approximate theory , with errors of only @xmath2002% , confirming that the displacements can be calculated to good accuracy using a linearized theory for this magnitude of electric field .",
    "the changes in the phonon frequencies resulting from these displacements ( evaluated at zero and non - zero field for the approximate and exact theories respectively ) are listed in the remaining columns of table [ table : three ] .",
    "the discrepancies in the phonon frequencies are now somewhat larger , approaching 15% in some cases .",
    "this indicates that the approximate theory is able to give a moderately good description of the phonon frequency shifts of gaas in this field range , but the exact theory is needed for accurate predictions .",
    "( also , recall that the approximate theory does not provide any estimate for the electronic contributions , which are not included in table [ table : three ] . )    finally , we illustrate our ability to calculate the nonlinear field dependence of the phonon frequencies by presenting the calculated optical @xmath96-point phonon frequencies of alas in fig .  [",
    "fig : nonlin ] as a function of electric field along @xmath182 .",
    "these are again the results of our exact theory , obtained by including both ionic and electronic contributions .",
    "the two to modes are degenerate at zero field , as they should be .",
    "all three modes show a linear component that dominates their behavior in this range of fields .",
    "however , a quadratic component is also clearly evident , illustrating the ability of the present approach to describe such nonlinear behavior .",
    "we have developed a method for computing the phonon frequencies of an insulator in the presence of a homogeneous , static electric field .",
    "the extension of density - functional perturbation theory to this case has been accomplished by carrying out a careful expansion of the field - dependent energy functional @xmath201 , where @xmath202 is the berry - phase polarization , with respect to phonon modes both at @xmath196 and at arbitrary @xmath197 . in the general case of nonzero @xmath197 , there is a subtle interplay between the couplings between neighboring k - points introduced by the electric field and the further - neighbor couplings introduced by the @xmath197-vector , so that terms arise that require the evaluation of four - sided loops in k - space .",
    "however , with the judicious use of time - reversal symmetry , the needed evaluations can be reduced to a form that is not difficult to implement in an existing dfpt code .",
    "we have carried out test calculations on two iii - v semiconductors , alas and gaas , in order to test the correctness of our implementation .",
    "a comparison of the results of linear - response and finite - difference calculations shows excellent agreement , thus validating our approach .",
    "we also decompose the frequency shifts into `` lattice '' and `` electronic '' contributions and quantify these , and we find that the lattice contributions ( i.e. , those resulting from induced displacements in the reference equilibrium structure ) are usually , but not always , dominant .",
    "we also evaluated the accuracy of an approximate method for computing the lattice contribution , in which only zero - field inputs are needed .",
    "we found that this approximate approach gives a good rough description , but that the full method is needed for an accurate calculation .",
    "our linear - response method has the same advantages , relative to the finite - difference approach , as in zero electric field . even for a phonon at @xmath176 ,",
    "our approach is more direct and simplifies the calculation of the phonon frequencies .",
    "however , its real advantage is realized for phonons at arbitrary @xmath197 , because the frequency can still be obtained efficiently from a calculation on a single unit cell without the need for imposing commensurability of the @xmath197-vector and computing the mode frequencies for the corresponding supercell .",
    "we also emphasize that the method is not limited to infinitesimal electric fields .",
    "we thus expect the method will prove broadly useful for the study of linear and nonlinear effects of electric bias on the lattice vibrational properties of insulating materials .",
    "this work was supported by nsf grants dmr-0233925 and dmr-0549198 .",
    "we wish to thank i.  souza for assistance in the early stages of the project .",
    "the formula for the electric polarization given in the original work of king - smith and vanderbilt@xcite is not a suitable starting point for the phonon perturbation analysis that we wish to derive here , because a perturbation of nonzero wavevector @xmath24 acting on a bloch function generates a wavefunction that is no longer of bloch form .",
    "that is , while the zero - order wavefunction @xmath203 transforms as @xmath204 under a translation by @xmath8 , the first - order wavefunction @xmath205 transforms as @xmath206 .    to solve this problem ,",
    "we first restrict ourselves to the case of a regular mesh of @xmath207 k - points in the brillouin zone .",
    "as is well known , one can regard the bloch functions at these k - points as being the solutions at a single k - point of the downfolded brillouin zone of an @xmath208 supercell . then , as long as the wavevector @xmath24 is a reciprocal lattice vector of the supercell , or @xmath209 , the phonon perturbation will be commensurate with the supercell , and the perturbed wavefunction will continue to be a zone - center bloch function of the supercell .",
    "we thus restrict our analysis to this case .",
    "a formula for the berry - phase polarization for single - k - point sampling of a supercell has been provided by resta.@xcite starting from a general many - body formulation in terms of a definition of the position operator suitable for periodic boundary conditions , and then specializing to the case of a single - particle hamiltonian , resta s derivation leads to @xmath210 where the berry phase in lattice direction @xmath55 is given by @xmath211 here @xmath212 where @xmath213 is the primitive reciprocal mesh vector in lattice direction @xmath55 and @xmath214 runs over all of the occupied states of the supercell .",
    "expanding the matrix @xmath215 in powers of @xmath43 and @xmath216 , @xmath217 the expansion of @xmath218 takes the form @xcite @xmath219 + \\lambda^*\\,\\textrm{tr}[m_\\alpha^{(0,1)}q_\\alpha]\\nonumber\\\\ & + & \\lambda^2\\,\\textrm{tr}[2m_\\alpha^{(2,0)}q_\\alpha -m_\\alpha^{(1,0)}q_\\alpha m_\\alpha^{(1,0)}q_\\alpha]\\nonumber\\\\ & + & \\lambda^{*2}\\,\\textrm{tr}[2m_\\alpha^{(0,2)}q_\\alpha -m_\\alpha^{(0,1)}q_\\alpha m_\\alpha^{(0,1)}q_\\alpha]\\nonumber\\\\ & + & |\\lambda|^2\\,\\textrm{tr}[2m_\\alpha^{(1,1)}q_\\alpha -m_\\alpha^{(1,0)}q_\\alpha m_\\alpha^{(0,1)}q_\\alpha\\nonumber\\\\ & & \\qquad\\qquad - m_\\alpha^{(0,1)}q_\\alpha m_\\alpha^{(1,0)}q_\\alpha]\\nonumber\\\\ & + & \\textrm{higer order terms } \\;,\\end{aligned}\\ ] ] where @xmath220^{-1}$ ] .    from the physical point of view",
    ", the terms proportional to @xmath43 , @xmath216 , @xmath221 , and @xmath222 should vanish as a result of translational symmetry .",
    "for example , a term linear in @xmath43 should transform like @xmath223 under translation by a lattice vector @xmath8 , but such a form is inappropriate in an expression for the energy , which must be an invariant under translation .",
    "we have confirmed this by explicitly carrying out the matrix multiplications for these terms and checking that the traces are zero . using the cyclic property of the trace to combine the last two terms",
    ", we find that the overall second - order change in @xmath224 is @xmath225 \\;. \\label{eq : logdeta}\\end{aligned}\\ ] ]    in our case , the orbitals @xmath226 appearing in eq .",
    "( [ eq : mm ] ) are the perturbed wavefunctions originating from the unperturbed states labeled by band @xmath60 and k - point @xmath82 of the primitive cell , so that we can let @xmath227 and @xmath228 substituting eq .",
    "( [ eq : psione ] ) into eq .  ( [ eq : mexpan ] ) , we find @xmath229 @xmath230 @xmath231 and @xmath232^{-1}$ ] where @xmath233    the transformation properties of the zero- and first - order wavefunctions under translations , given by eqs .",
    "( [ eq : kbc ] ) and ( [ eq : kqbc ] ) , impose sharp constraints upon which of the terms in eqs .",
    "( [ eq : zba]-[eq : zaa ] ) can be non - zero .",
    "for example , for @xmath234 in eq .",
    "( [ eq : zba ] ) , the term @xmath235 is only non - zero if @xmath236 .",
    "similarly , @xmath237 is only non - zero if @xmath238 . in practice , we define primitive - cell - periodic functions @xmath239 and @xmath240 so that @xmath241 where @xmath242 ( subscript @xmath55 is now implicit ) . defining @xmath243^{-1}$ ] and taking into account the constraints on k - points embodied in the delta functions in eq .",
    "( [ eq : deltas ] ) , the two terms in eq .",
    "( [ eq : logdeta ] ) become @xmath244=\\sum_\\k     \\textrm{tr}[s^{(1,1)}_{\\k,\\k+\\g } q_{\\k+\\g,\\k}]\\ ] ] and @xmath245=     \\sum_\\k \\textrm{tr}[s^{(1,0)}_{\\k,\\k+\\g-\\q } \\nonumber\\\\ & & \\qquad   \\times q_{\\k+\\g-\\q,\\k-\\q } s^{(0,1)}_{\\k-\\q,\\k+\\g } q_{\\k+\\g,\\k } ] \\;.\\end{aligned}\\ ] ] in these equations , the trace on the left - hand side is over all occupied states of the supercell , while on the right - hand side it is over bands of the primitive cell .",
    "these are the terms that appear in eq .",
    "( [ eq : loops ] ) in the main text , and that determine the pattern of k - point loops illustrated in fig .",
    "[ fig : kpoint ] .",
    "the abinit code is a common project of the universit catholique de louvain , corning incorporated , and other contributors ( www.abinit.org ) .",
    "see : x. gonze and others , comp .",
    "science * 25 * , 478 ( 2002 ) ."
  ],
  "abstract_text": [
    "<S> we present a perturbative method for calculating phonon properties of an insulator in the presence of a finite electric field . </S>",
    "<S> the starting point is a variational total - energy functional with a field - coupling term that represents the effect of the electric field . </S>",
    "<S> this total - energy functional is expanded in small atomic displacements within the framework of density - functional perturbation theory . </S>",
    "<S> the linear response of field - polarized bloch functions to atomic displacements is obtained by minimizing the second - order derivatives of the total - energy functional . in the general case of nonzero phonon wavevector </S>",
    "<S> , there is a subtle interplay between the couplings between neighboring k - points introduced by the presence of the electric field in the reference state , and further - neighbor k - point couplings determined by the wavevector of the phonon perturbation . as a result , </S>",
    "<S> terms arise in the perturbation expansion that take the form of four - sided loops in k - space . </S>",
    "<S> we implement the method in the abinit code and perform illustrative calculations of the field - dependent phonon frequencies for iii - v semiconductors . </S>"
  ]
}