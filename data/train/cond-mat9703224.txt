{
  "article_text": [
    "computing the linear response functions ( and the density of states ) of large systems with thousands of atoms by using conventional methods requires to calculate the eigenvalues and eigenvectors of @xmath3 hamiltonian matrices ( @xmath4 ) from the lowest state to the fermi energy and beyond it .",
    "the standard diagonalization routines are too much time - consuming in treating these problems because their computing time is proportional to @xmath5",
    ". therefore efficient numerical algorithms , such as recursive green s function methods @xcite , the lanczos methods @xcite , the chebyshev polynomial expansion @xcite , and conjugate gradient methods @xcite have been developed and applied to various problems .    in this paper , we present an efficient method for calculating the linear response functions of large quantum system .",
    "we give up the calculation of each exact eigenstates , instead we compute linear response functions by integrating the time - dependent schroedinger equations for a finite period determined by the required energy resolution . since it avoids @xmath0 computational efforts of matrix diagonalization , it requires only @xmath1 computational efforts for sparse hamiltonian matrices . to realize this scheme , we exploit several numerical techniques such as the chebyshev polynomial expansion of matrix functions @xcite , random state vectors @xcite , hamiltonian matrix discretized in real space @xcite , the time - dependent schroedinger equation discretized in real time @xcite",
    "in this section , we describe how we reached the conclusion that we can calculate efficiently the linear response functions of large quantum systems by using the time - dependent homogeneous schroedinger equations .",
    "let us compare the computational efforts of the conventional diagonalization method and the time - dependent method by counting the number of floating point multiplications as a function of matrix dimension @xmath6 , and show that time - dependent method is more efficient when large number of eigenstates are involved .",
    "first , we review the relation between the eigenstate representation and the time - dependent representation of linear response functions .",
    "the linear response function @xmath7 of an observable @xmath8 due to a _ monochromatic _",
    "perturbation @xmath9 is calculated by time - dependent perturbation theory @xcite , @xmath10 where @xmath11 and @xmath12 are the groundstate of the many electron system and its energy , respectively ; @xmath13 and @xmath14 are the frequency and its resolution , respectively ; @xmath15 is the integration time .",
    "we use atomic units ( a.u . ) , and indicate complex conjugate by `` c.c . '' . in numerical calculation of ( [ eq : chi.time ] )",
    ", we have to discretize it in time , e.g. , @xmath16 where @xmath17 is the number of timesteps , @xmath18 is the integration time in ( [ eq : chi.time ] ) , and @xmath19 is the width of timestep . on the other hand , we obtain the eigenstate representation by inserting @xmath20 into ( [ eq : chi.time0 ] ) , @xmath21    next , we show the estimated computational efforts in table  [ tbl : compare ] .",
    "the diagonalization method for @xmath22 hamiltonian matrix requires memory space of @xmath23 and computational effort of @xmath24 . on the other hand ,",
    "the time - dependent method requires memory space of @xmath23 and computational effort of @xmath25 where @xmath26 is the number of timesteps determined by the required energy resolution ( see section  [ subsec : homo ] ) . by choosing an appropriate basis set",
    ", we can make the hamiltonian a sparse matrix having only @xmath27 non - zero matrix elements @xcite . as the result ,",
    "the computational effort and the memory space of the time - dependent method are reduced to @xmath28 and @xmath27 , respectively .",
    "thus the time - dependent method can be more efficient than diagonalization method in large @xmath6 limit .",
    "table  [ tbl : equations ] classifies various time - dependent methods in terms of kind of equation and homogeneity .",
    "though the newton equations of harmonic oscillators @xcite are mathematically equivalent to the schroedinger equations in the eigenstate representation , use of the schroedinger equation @xcite has advantage that we can exploit well developed concepts and formalism of quantum theory .",
    "it is true especially when we want to deal with quantum systems .",
    "therefore , in this article , we study only the schroedinger equations .      in this subsection",
    "we show that inhomogeneous time - dependent equations are more inefficient than homogeneous ones .",
    "this conclusion is valid not only for the schroedinger equation ( particle source method @xcite ) but also for the newton equation ( forced oscillator method @xcite ) because both equations are equivalent in the eigenstate representation .",
    "let us define the computational effort of the time - dependent method by the number of timesteps @xmath17 .",
    "then the computational effort @xmath26 is determined by the integration time @xmath18 , because the maximum width of timestep is limited by the _ sampling theorem _",
    "@xcite independent of the detail of the method we use .",
    "the timestep should be much smaller than the inverse of band width , @xmath29 , to reproduce the correct spectrum since , otherwise , according to ( [ eq : chi.time.discrete ] ) we can not distinguish the eigenvalues @xcite",
    "@xmath30    in the following , we evaluate @xmath18 for homogeneous and inhomogeneous schroedinger equations to calculate the real - time green s functions at many frequencies , @xmath31 , within a required relative accuracy @xmath32 .",
    "it turns out that @xmath18 of inhomogeneous equations can be much longer than that of homogeneous equations .",
    "this conclusion applies to the linear response functions , too .",
    "first let us try to calculate the green s function by solving the homogeneous equation , @xmath33 with the initial condition @xmath34 .",
    "the auxiliary vectors are calculated as @xmath35 where we have neglected the second term of ( [ green.1.1 ] ) by assuming @xmath18 is large enough so that @xmath36",
    ". therefore we estimate @xmath26 for the homogeneous equation as @xmath37    next let us calculate the green s function by solving the inhomogeneous schroedinger equation , @xmath38 with the initial condition @xmath39 .",
    "the solution at large @xmath18 becomes @xmath40 where @xmath18 satisfies @xmath41 .",
    "then the auxiliary vectors @xmath42 are defined as @xmath43 where we have neglected the second term of ( [ green.m3 ] ) by assuming that @xmath44 is large enough so that @xmath45 .",
    "therefore @xmath26 becomes @xmath46 which can be much larger than @xmath47 when @xmath48 is small .",
    "in this section , we apply the time - dependent homogeneous schroedinger equation to calculate efficiently the linear response functions and density of states of non - interacting electron systems , since it is well known that there exist wide and practically important areas in condensed matter physics where non - interacting electron models are useful to predict various physical properties .",
    "hereafter we assume that the system is described by the one - electron hamiltonian , @xmath49      for non - interacting electrons , the linear response function ( [ eq : chi.eigen ] ) can be rewritten by using one - particle eigenstates as @xcite @xmath50 where @xmath51 is the fermi energy , and @xmath52 and @xmath53 are the occupied and empty one - particle states , respectively .",
    "this formula can be again rewritten in time - dependent representation as @xmath54 where the double brackets indicate the statistical average over random vectors @xmath55 , and @xmath56 is the time correlation function defined by @xmath57 equations ( [ eq : chi.numerical.1 ] ) and ( [ eq : correlation ] ) are the main result of this paper . note that calculating the trace over the initial states @xmath52 by using random vectors reduces the computational effort by a factor of @xmath6 . as the result ,",
    "the computational effort still remains @xmath27 in spite of the double summation in ( [ eq : chi.eigen.one ] ) .    in the above equations , we have introduced several numerical techniques",
    "firstly , the time - dependent statevectors , @xmath58 are calculated by the leap frog method @xcite @xmath59 due to this discretization , the hamiltonian matrix becomes sparse and the matrix vector multiplication in ( [ eq : frog ] ) can be done with @xmath27 computational complexity .",
    "we use @xmath60 formula in this paper .",
    "secondly , the matrix step function for a normalized hermitian matrix @xmath61 whose eigenvalues @xmath62 are in the range @xmath63 $ ] is defined in its eigenstate basis @xmath64 by using this step function , we can avoid the difficulties in the partial sum in ( [ eq : chi.time.one ] ) .",
    "operation of this function on an arbitrary vector @xmath65 is numerically approximated by the chebyshev polynomial expansion @xcite , @xmath66 where each term of the right hand side is calculated by vector recursion formulae @xmath67 to use this matrix function in ( [ eq : timevector ] ) , we should normalize the hamiltonian matrix so that @xmath68 has eigenvalues in the range @xmath69 $ ] .",
    "thirdly , we define random vectors with random phase by @xmath70 are basis vectors and @xmath71 are uniform random variables that satisfy @xmath72",
    ". then we can derive various useful identities such as @xmath73 = \\sum_{e_m } \\langle e_m|a|e_m \\rangle \\end{aligned}\\ ] ] equation ( [ eq : random.norm ] ) shows that each random vector is normalized to @xmath6 , the number of one - particle eigenstates .",
    "equation ( [ eq : random.complete ] ) shows that random vectors have normalized completeness .",
    "equation ( [ eq : random.trace ] ) shows that the expectation value of an operator by random vectors gives the trace of the operator .",
    "we used this identity to calculate the trace over @xmath74 in ( [ eq : chi.numerical.1 ] ) and ( [ eq : correlation ] ) .",
    "these random vectors with random _ phase _ are more useful in calculating expectation values than random vectors with random _ amplitude _ since each random vectors are automatically normalized .",
    "finally the formula for numerical calculation of polarizability function @xmath75 with @xmath76 becomes @xmath77 where @xmath78 is the volume of the supercell , and the dipole moment operators @xmath79 are modified to momentum operators by partial integration .",
    "we also inserted a low energy projection operator @xmath80 into ( [ eq : chi.correlator.numerical ] ) to eliminate unphysical high energy components of the random vectors .",
    "this filter is much more effective than the quadratic filter used in @xcite . in calculating very large systems ,",
    "we need only few random vectors for statistical averaging , since the fluctuation becomes smaller as the system size @xmath6 becomes larger @xcite .    figure  [ fig : harmonic.eps ] shows the dielectric function @xmath81 of four electrons in three dimensional harmonic potential @xmath82 calculated with @xmath83 cubic meshes , @xmath84 , @xmath85 .",
    "three random vectors are used .",
    "the analytical result @xcite @xmath86 is also shown for comparison , where @xmath87 is the number of electrons in the supercell of volume @xmath78 .",
    "the deviation from the exact result near @xmath88 is due to finite @xmath14 .",
    "the result shows that our method works very well for @xmath89 .",
    "figure  [ fig : silicon.crystal.eps ] shows the dielectric function with energy resolution @xmath90 of silicon crystal consisting of @xmath91 si atoms in a cubic supercell of @xmath92 unit cells .",
    "each unit cell is divided into @xmath93 cubic meshes .",
    "one random vector is used .",
    "we used the empirical local pseudopotential in reference @xcite .",
    "the result agrees with experimental results and other theoretical calculations @xcite .    in some cases we may want to ask which part of the real space the electrons contributing to the linear response function come from .",
    "we can answer to this question by calculating the linear response function by restricting the range of the trace in ( [ eq : chi.dielectric.numerical ] ) within a real space domain @xmath94 .",
    "this can be done by replacing @xmath95 by @xmath96 where @xmath97 is the real space projection operator onto @xmath94 .",
    "the density of states of the system can be calculated as @xcite @xmath98 \\right)\\end{aligned}\\ ] ] by combining ( [ eq : green.1.2.many ] ) and ( [ eq : trace.monte.appendix ] ) .",
    "figure  [ fig : harmonic.dos ] shows the numerical and analytical results of the density of states in 3d harmonic potential with @xmath83 cubic meshes , @xmath84 , and @xmath99 .",
    "three random vectors are used .",
    "figure  [ fig : crystal.dos ] shows the density of states of silicon crystal consisting of @xmath91 si atoms in a cubic supercell of @xmath92 unit cells .",
    "each unit cell is divided into @xmath93 cubic meshes .",
    "the energy resolution is @xmath90 .",
    "three random vectors are used .",
    "we can also calculate the _ local _ density of states integrated in a given domain @xmath94 by using the real space projection operator @xmath100 to restrict the summation in ( [ eq : random.def ] ) within @xmath94 , @xmath101 \\right ) .\\end{aligned}\\ ] ]    photonic band structures in two - dimensional periodic structure of dielectric material @xcite can also be calculated by using ( [ eq : dos ] ) or ( [ eq : localdos ] ) since the maxwell equations of this system are reduced to the schroedinger equation with position dependent mass , i.e. , @xmath102 for @xmath103-mode where @xmath104 is the @xmath105-component of the magnetic field , and @xmath106 for @xmath107-mode where @xmath108 is the @xmath105-component of the electric field .",
    "figure  [ fig:5 ] shows a typical structure of two - dimensional photonic crystal cavities used in our calculation , and fig .",
    "[ fig:6 ] shows the calculated density of states as a function of frequency and wave number .",
    "in this article we proposed a new numerical method suitable for calculating the linear response functions ( and the density of states ) of non - interacting electrons , in which the sum over the initial one - particle states are efficiently calculated by using random vectors .",
    "the advantage of this method compared to the chebyshev polynomial method by wang to calculate optical absorption of non - interacting electrons @xcite is that our method can calculate not only the imaginary part but also the real part of the linear response functions at the same time , and that it can calculate them without any input - output of statevectors on external storage . as the result , our method can calculate much larger systems than wang s method .",
    "the chebyshev polynomial method of degree @xmath26 should store @xmath109 statevectors of size @xmath27 on external storage to make the table of @xmath110 generalized chebyshev moments @xmath111 and may take very long i / o time .",
    "the application of this method to photonic band structures , silicon nanocrystalites , and periodic structures of chaotic systems will be presented elsewhere @xcite .",
    "one of the authors ( t.i ) wishes to thank prof .",
    "masuo suzuki and the referee of this article for their encouragement .",
    "the calculations were performed on fujitsu vpp500 at riken and issp .            for a review see , e.g. , d.w .",
    "bullet , r.  haydock , v.  heine , and m.j .",
    "kelly , in _ solid state physics _ edited by h.  erhenreich , f.  seitz , and d.  turnbull ( academic , new york , 1980 ) , vol .",
    "35 ; e.  dagotto , rev . mod . phys . * 66 * , 763 ( 1994 ) .",
    "y.  huang , w.  zhu , d.j .",
    "kouri , d.k .",
    "hoffman , chem .",
    ". letts . * 206 * , 96 ( 1993 ) ; w.  zhu , y.  huang , d.j .",
    "kouri , c.  chandler , d.k .",
    "hoffman , chem .",
    ". letts . * 217 * , 73 ( 1994 ) ; d.j .",
    "kouri , w.  zhu , g.a .",
    "parker , d.k .",
    "hoffman , chem .",
    ". letts . * 238 * , 395 ( 1995 ) ; g.a .",
    "parker , w.  zhu , y.  huang , d.k .",
    "hoffman , d.j .",
    "kouri , comp .",
    "comm . * 96 * , 27 ( 1996 ) ; d.j .",
    "kouri , y.  huang , d.k .",
    "hoffman , in _ dynamics of molecules and chemical reactions _ ,",
    "wyatt and j.z.h .",
    "zhang , marcel dekker , new york , p. 307",
    "( 1996 ) .",
    "silver , and h.  roder , int .",
    "physics c*5 * , 735 ( 1994 ) ; r.n .",
    "silver , h.  roeder , a.h .",
    "voter , and j.d .",
    "kress , j. comp .",
    "phys . * 124 * , 115 ( 1996 ) .",
    "h.  roeder , h.  fehshke , r.n .",
    "silver rn , europhysics letters * 28 * , 257 ( 1994 ) .",
    "c.  leforestier , r.h .",
    "bisseling , c.  cerjan , m.d .",
    "feit , r.  friesner , a.  guldberg , a.  hammerich , g.  jolicard , w.  karrlein , h.- d.  meyer , n.  lipkin , o.  roncero , and r.  kosloff , j. comp . phys . * 94 * , 59 ( 1991 ) , and references therein .",
    "k.  yakubo , t.  nakayama , and h.j .",
    "maris , j.  phys .",
    ". jpn . * 60 * , 3249 ( 1991 ) ; t.  terao , k.  yakubo , and t.  nakayama , phys . rev . * e50 * , 566 ( 1994 ) ; t.  nakayama , in _ computational physics as a new frontier in condensed matter research _ edited by h. takayama , m. tsukada , h. shiba , f. yonezawa , m. imada and y. okabe , ( physical society of japan , tokyo , 1995 ) isbn4 - 89027 - 004 - 3 .",
    "@xmath112{\\makebox[60mm]{calculation } } & \\mbox{computation } & \\mbox{memory } & \\mbox{computation } & \\mbox{memory } \\\\",
    "\\hline e_m , |e_m\\rangle            & n^3 & n^2 & n^3 & n^2 \\\\",
    "\\langle e_g| a |e_n\\rangle & n^2 & n    & n    & n    \\\\ \\displaystyle \\sum_{m }                            & n    & n    & n    & n    \\\\ \\hline \\end{array}\\ ] ]    @xmath113{\\makebox[60mm]{calculation } } & \\mbox{computation } & \\mbox{memory } & \\mbox{computation } & \\mbox{memory } \\\\",
    "\\hline e^{-ihm\\delta t } b | e_g \\rangle                & m n^2 & n^2 & m n & n \\\\ \\langle e_g| a e^{-ihm\\delta t } b   |e_g\\rangle & n^2    & n    & n    & n    \\\\",
    "\\displaystyle \\sum_{m=0}^m                            & m    & 1    & m    & 1    \\\\ \\hline \\end{array}\\ ] ]"
  ],
  "abstract_text": [
    "<S> an o(n ) algorithm is proposed for calculating linear response functions of non - interacting electrons . </S>",
    "<S> this algorithm is simple and suitable to parallel- and vector- computation . </S>",
    "<S> since it avoids @xmath0 computational effort of matrix diagonalization , it requires only @xmath1 computational efforts where @xmath2 is the dimension of the statevector . </S>",
    "<S> the use of this @xmath1 algorithm is very effective since otherwise we have to calculate large number of eigenstates , i.e. , the occupied one - electron states up to the fermi energy and the unoccupied states with higher energy . </S>",
    "<S> the advantage of this method compared to the chebyshev polynomial method recently developed by wang ( l.w .  </S>",
    "<S> wang , phys . </S>",
    "<S> rev . </S>",
    "<S> b * 49 * , 10154 ( 1994);l.w .  </S>",
    "<S> wang , phys . </S>",
    "<S> rev . </S>",
    "<S> lett . * 73 * , 1039 ( 1994 ) ) is that our method can calculate linear response functions without any storage of huge statevectors on external storage .    </S>",
    "<S> pacs : 02.70.-c </S>"
  ]
}