{
  "article_text": [
    "one of the most intriguing features of quantum mechanical description of physical objects consists in presence of quantum superpositions and especially of entangled states @xcite . at the very beginning of the quantum theory development such states",
    "were found to possess quite counterintuitive ( from the classical point of view ) properties @xcite . during the 20th century",
    "the attitude of physicists to such quantum states evolved from perceiving them as either evidences of theory incompleteness or interesting but quite useless features of the world @xcite to understanding the opportunities provided by such quantum objects for solving numerous tasks of information processing @xcite .",
    "it has been shown that quantum no - cloning theorem @xcite provides unconditional security of quantum cryptography protocols @xcite , while using entangled states of quantum register can lead to essential speed - up of solving several classes of complicated computational tasks @xcite .    from this point of view entanglement",
    "represents an important resource for different information tasks .",
    "on the other hand , entanglement itself requires some physical resources for its generation and , thus , can be considered as an intermediate step on the way from physical devices to accomplishing tasks of information processing . similarly to many other situations , the resources available nowadays for entanglement generation are limited , and one of the most important problems is to find methods for obtaining results as good as possible using as few resources as possible .    among systems , being promising for efficient entanglement generation , optical field modes take their place due to possibility of long - distance transmission with relatively low decoherence and quite simple manipulation of the states with linear optics and photodetectors . considering optical entanglement generation",
    ", one can divide necessary elements into two classes : quite simple elements , available `` freely '' ( linear optical devices , photodetectors not resolving photon number , classical optical states ) , and _ resources _  all other elements , being quite challenging for construction .",
    "it is impossible to generate entanglement with the first group of elements only ( see e.g. refs .",
    "@xcite ) , and , therefore , some resources are necessarily required . the main resource , used for entanglement generation by optical methods , is nonlinearity , either measurement - induced @xcite or provided by interaction between the field modes in some medium .",
    "the corresponding physical resources are special detectors ( e.g. resolving photon number @xcite ) and nonlinear media respectively .",
    "entangled states can be created also by means of linear optics from nonclassical states , which in their turn require nonlinearity for their generation .",
    "many quantum information processing and communication tasks ( quantum cryptography , distributed quantum computation , teleportation of quantum states ) require distribution of entanglement between parties , separated by noisy medium .",
    "for such tasks a high - quality quantum channel also becomes an important physical resource .",
    "so , the two main resources , required for generating entanglement between distant states with optical methods , are nonlinear interaction and a quantum channel",
    ". therefore , efficient entanglement generation corresponds in this case to creating strongly entangled states with weak nonlinear interactions and noisy quantum channels ( only such systems are available nowadays ) .    in present paper",
    "we consider weak local cross - kerr interaction as a resource for creating nonlocal nonclassical states of spatially separated optical field modes .",
    "certain progress has already been achieved in this field of research @xcite , especially in the case of creating qubit - like entangled states . however , it remained quite challenging to create more general classes of entangled states with such limited resources .",
    "we propose a protocol for creating wide class of qudit - type states ( including entangled states ) with arbitrary dimensionality in continuous variable ( optical ) system using weak cross - kerr nonlinearity ( as the main physical resources ) , linear beamsplitters , detectors not resolving photon numbers , and sources of coherent states .",
    "we show that entanglement of the states , created with our protocol , can be higher than unity ( which is the limit for qubit - type states , that can be created by previously proposed methods ) and , thus , our protocol provides more effective use of limited physical resources .",
    "this paper is organized as follows . in the next section",
    "we discuss the main ideas of entanglement generation between distant sites when local nonlinear interaction and non - ideal quantum channel are available .",
    "then the main operations of the proposed protocol and corresponding state transformations are presented .",
    "section  [ sec : discrim ] is devoted to discussion of the peculiarities of projecting the `` raw '' weakly entangled system state onto strongly entangled desired final state .",
    "it is shown that parameters of the protocol are determined in the unique way by the desired final state , and corresponding relations are found . in section  [ sec : special ] we demonstrate several applications of the protocol to creation of nonclassical and entangled states of optical field modes . in the last section",
    "we prove applicability of the protocol for entanglement generation under realistic conditions by taking into account decoherence , limited efficiency and dark counts of photodetectors , and uncertainty of nonlinear coupling constants .",
    "cross - kerr interaction itself can be used for generating entangled states starting from uncorrelated states of a pair of quantum objects .",
    "suppose a field mode @xmath0 in a coherent state @xmath1 interacts with another system ( another optical field mode @xmath2 @xcite or an atomic system @xcite ) .",
    "due to the interaction the phase of the coherent state amplitude @xmath3 of the mode @xmath0 is shifted by the value , proportional to the number of excitations @xmath4 of the system @xmath2 : latexmath:[\\[\\label{eqn27 } |n\\rangle_a |\\gamma \\rangle_c \\rightarrow |n\\rangle_a    effective strength of the interaction .",
    "if the initial state of the object @xmath2 is a superposition of states with different excitation numbers ( e.g. a coherent state @xmath6 in the case of field mode ) , the final state of the considered system will be an entangled state , composed by pairwise combinations of coherent states with different phases of mode @xmath7 and number states of the system @xmath2 ( fig .",
    "[ fig0](a ) ) .",
    "cc * ( a ) * & + &   +   + * ( b ) * & + &   +   + * ( c ) * & + &   +    however , experimentally observed nonlinear interactions are quite weak @xcite : the effective nonlinearity strengthes , predicted in the most promising 4-level atomic systems with electromagnetically induced transparency on the basis of theoretical calculations and experimental data , have the order of @xmath8 @xcite . the magnitude of phase space displacement caused by such cross - kerr interaction is proportional to @xmath9 , and in general case the final state can be weakly entangled .",
    "one of the solutions of the problem consists in effective nonlinearity enhancement by using intense fields @xmath0 : for @xmath10 the displacement magnitude can be large enough ( @xmath11 ) even for small @xmath12 @xcite .",
    "entanglement generation gets more complicated if we take into account not only limited available nonlinearity , but also noisy medium between the sites ( fig .",
    "[ fig0](b ) ) .",
    "then decoherence strongly limits maximal possible amplitudes of the transmitted field @xmath0 ( @xmath13 ) , while the amplitude of field @xmath2 or the number of excitations in the atomic system is also limited by losses in local storage .",
    "therefore , this simple scheme is not applicable for generating strongly entangled states when the sites are separated by noisy media .",
    "hence , under realistic conditions a more sophisticated scheme , including some kind of entanglement enhancement , is required .",
    "one way of obtaining strongly entangled quantum state is to implement entanglement distillation @xcite .",
    "this approach requires storage of quite a large number of initial weakly entangled states and can be quite challenging .",
    "another solution of the problem can be based on probabilistic entanglement enhancement @xcite . for this purpose one can design certain measurement ,",
    "carried out at bob s site , with successful outcome transforming initial weakly entangled state into a strongly entangled state .",
    "direct measurement of the state of field mode @xmath7 makes this mode inaccessible for any further use .",
    "measurements , implemented with linear optics and photodetectors not resolving photon number on field modes , obtained by splitting the mode @xmath7 , completely determine the state of the mode and destroy entanglement .",
    "therefore , some kind of nonlinearity is required at bob s site , too .",
    "it is quite natural to suppose that this nonlinear interaction is the same as the one at alice s site ( see e.g. refs .",
    "several schemes , based on probabilistic entanglement enhancement by a measurement at bob s site , have already been proposed for entangling distantly separated field modes , when effective strength of nonlinear interactions @xmath12 is equal to @xmath14 ( strong nonlinear interaction ) @xcite , and for entangling atomic qubits @xcite as well as for creating qubit - type entangled states of optical field modes @xcite , when only small nonlinearity is available .    in present paper",
    "we solve a more general task of designing the measurement scheme for creation of arbitrary qudit - type state ( including entangled states ) from a wide class of possible states in continuous variable system using weak cross - kerr nonlinearity , linear optical devices , detectors and sources of coherent states .",
    "the set of achievable final states of the field modes @xmath2 and @xmath15 has the form of a sum of phase - correlated pairs of coherent states of the modes : @xmath16 where coefficients @xmath17 are arbitrary and can be fixed in an appropriate way for obtaining the state , most useful for certain practical applications .",
    "we consider the following system ( see fig .  [ fig1 ] ) : alice and bob posses local field modes @xmath2 and @xmath15 referred to below as main field modes ; the probe beam ( ancillary mode ) is denoted as mode @xmath0 ; mode @xmath18 is a reference field , transmitted from alice to bob immediately before ( or after ) ancillary field for decreasing influence of dephasing in the quantum channel on the final states .",
    "main field modes , the ancillary and the reference fields are prepared in coherent states ( @xmath19 for alice s mode @xmath2 , @xmath20 for bob s mode @xmath15 , @xmath1 for the probe field @xmath0 and @xmath21 for the reference field @xmath18 ) .",
    "the initial state of the system is therefore uncorrelated one .",
    "local cross - kerr interaction of the modes @xmath2 and @xmath0 ( with effective strength @xmath12  the phase of a coherent state of mode @xmath2 increases by @xmath12 radians per each photon in @xmath0 ) leads to generation of correlations between the number of photons in the mode @xmath0 and the phase of the coherent state of the mode @xmath2 .",
    "then the field @xmath0 is transmitted to bob s site through the quantum channel . in this section",
    "we suppose for simplicity that all correlations are preserved by the channel .",
    "after local interaction of the modes @xmath15 and @xmath0 ( the effective strength of the interaction is supposed in this section to be also equal to @xmath12 ) , taking place afterwards , the phases of the main modes @xmath2 and @xmath15 become correlated with the number of photons in the mode @xmath0 : @xmath22 where @xmath23 .",
    "however , the correlations , generated in the system , are weak in a realistic case . for small ancillary field amplitudes @xmath24 ,",
    "required for decreasing decoherence in the quantum channel @xcite , the entanglement between the states of the mode @xmath2 possessed by alice and the modes @xmath15 and @xmath0 possessed by bob is much less than unity : @xmath25 where @xmath26 .",
    "as discussed in the previous section , the last stage of the protocol consists in detection of the probe beam state .",
    "this operation should lead ( in the case of successful outcome ) to transformation of the weakly correlated 3-modes state into a strongly correlated 2-modes state of the form ( [ eqn3 ] ) .",
    "the idea of obtaining the desired strongly correlated final state ( [ eqn3 ] ) from the state ( [ eqn1 ] ) is based on the following decomposition : @xmath27 where @xmath28 denotes the part of the system state , orthogonal to @xmath29 , and the vector @xmath29 is uniquely defined as @xmath30 thus , the transformation of the state ( [ eqn1 ] ) into the state ( [ eqn3 ] ) for arbitrary coefficients @xmath17 can be realized by successful discrimination of the state @xmath29 from a set of ancillary mode states , containing @xmath29 and a complete system of states , orthogonal to @xmath29 .",
    "the most simple from theoretical point of view way of discriminating the state @xmath29 is implementing projective measurement described by operator @xmath31 which satisfies the following relation : @xmath32    however , implementation of such measurement without additional _ resources _ ( e.g. nonlinear interaction ) can be too complicated or impossible .",
    "solution of this problem is discussed in the next section , and the discrimination technique , based on a special case of general class of povm measurements  `` elimination '' measurements ,  is proposed .",
    "an important fact that can be used for designing required discrimination protocol is that coherent states represent a natural basis for linear optical devices ( the set of coherent states is closed under linear optical transformations ) . from this point of view",
    ", it is convenient to base the discrimination scheme on comparing the state of the probe beam @xmath0 with certain coherent states , obtained by splitting the reference mode @xmath18 .",
    "however , coherent states are nonorthogonal .",
    "it is this problem that leads to impossibility of implementing the discussed above projective measurement in a general case with linear optics .",
    "an important set of measurements , implementable with linear beamsplitters and photodetectors for coherent states , is the set of `` elimination '' measurements ( see e.g. refs .",
    "@xcite and fig .",
    "[ fig2](a ) below )  the measurements with successful outcomes manifesting that the field mode state _ is not _ certain coherent state .",
    "the concept of measurements with outcomes , manifesting that the input state _ is not _ certain fixed state , was proposed in refs .",
    "@xcite as a part of unambiguous discrimination of two non - orthogonal states .",
    "the concept of `` elimination '' measurements was generalized in ref .",
    "@xcite for the case of discrimination between @xmath33 symmetric coherent states on a circle on phase plane with linear optical elements and photodetectors . in these papers",
    "the system was supposed to be prepared in _",
    "one _ of the states from a fixed _ finite _ set ( e.g. symmetric coherent states on a circle : @xmath34 , @xmath35 ) .",
    "discrimination of one of the states ( e.g. @xmath36 ) is equivalent to _ elimination _ of all the remaining states from the fixed set ( in the considered example @xmath37 , @xmath38 ) .",
    "considering ancillary mode states in our protocol , one faces a more general situation .",
    "a complete set of independent states is infinite for a field mode , and the measured state does not necessarily coincide with certain basis vector , but can represent a superposition of basis vectors . therefore , complete description of state transformations , occurring when elimination measurements are carried out , requires a more rigorous operator definition of the concept of elimination measurements .",
    "we define _ measurement , eliminating state @xmath39 , _ as any povm - type measurement ( described by povm @xmath40 , @xmath41^+ \\hat a_i   = 1 $ ] ) with at least one of the outcomes ( referred to in this paper as successful ) being characterized by operator , denoted in further consideration as @xmath42 , with the property @xmath43 having obtained this outcome , one can with certainty conclude that the measured state _ was not _",
    "the state @xmath39 .",
    "considering a set of measurements eliminating states @xmath44 , we will require ( simultaneously with eq .",
    "( [ eqn7 ] ) for all vectors @xmath45 ) commutativity of operators , characterizing successful outcomes of the measurements : @xmath46=0.\\ ] ] this condition means that successful elimination of the state @xmath47 must not destroy the result of elimination of the state @xmath45 for any pair of the states @xmath47 and @xmath45 from the considered set .",
    "the conditions ( [ eqn7 ] ) , ( [ eqn23 ] ) lead to the following important implication , useful for designing the required discrimination scheme .",
    "let the set @xmath48 , ... , @xmath49 describe successful outcomes of corresponding elimination measurements .",
    "any state @xmath50 from the considered state space @xmath51 , is transformed into the state @xmath52 where contribution of @xmath53 only did not vanish .",
    "the final state of the system differs from the state @xmath53 , but it is a completely defined state and can be transformed unitarily into @xmath53 ( in our protocol the ancillary mode is finally discarded and this transformation is not necessary ) .",
    "therefore , one can state that successful elimination of all the basis vectors except @xmath53 leads to successful _",
    "discrimination _ of the state @xmath53 .",
    "generalization of the definition to the case , when several operators @xmath54 , @xmath55 , correspond to successful elimination of the state @xmath56 : @xmath57 , is straightforward : eq .",
    "( [ eqn23 ] ) retains its form and must be valid for all @xmath58 , used instead of single operator @xmath59 .",
    "the result , described by eq .",
    "( [ eqn30 ] ) , also remains valid .",
    "the described above technique can be used exactly for discrimination of the state @xmath29 of the ancillary mode @xmath0 in a special case of finite - dimensional space of input states .",
    "suppose that the final state of the whole system ( modes @xmath2 , @xmath15 and @xmath0 ) can be decomposed using finite number of ancillary field mode states , and these states together with the state @xmath29 span @xmath60-dimensional space .",
    "then we can choose @xmath61 such independent vectors @xmath62 , @xmath63 , orthogonal to @xmath29 , that the system @xmath64 is complete in corresponding subspace .",
    "as shown above , discrimination of the state @xmath29 corresponds to successful elimination of the vectors @xmath62 , @xmath65 .",
    "such finite - dimensional case can be realized , for instance , when the nonlinearity strength is equal to @xmath66 , where @xmath33 is an integer @xcite . in these special case the state of the modes @xmath2 , @xmath15 and @xmath0",
    "after the nonlinear interactions can be represented as a sum of @xmath33 terms consisting of coherent state of the form @xmath67 of the ancillary mode @xmath0 and corresponding entangled state of modes @xmath2 and @xmath15 . discrimination of a fixed state @xmath68 ( by elimination of @xmath69 coherent states @xmath70 , @xmath71 ) maps initial weakly - entangled state onto strongly - entangled final state of the modes @xmath2 and @xmath15 .    in general infinite - dimensional case , however , the state of the system can not be decomposed in such a way and the described discrimination technique can be applied approximately . for the considered state ( [ eqn1 ] ) and for small ancillary field amplitudes @xmath13 high accuracy of exploiting the discrimination technique can be achieved by restricting consideration by a space of states with limited photon numbers .",
    "suppose the expression ( [ eqn3 ] ) for the desired final state has @xmath72 nonzero terms , i.e. @xmath73 for @xmath74 .",
    "then eq .",
    "( [ eqn5 ] ) for the state @xmath29 also has @xmath72 nonzero terms and this state belongs to @xmath60-dimensional subspace of states with limited photons numbers @xmath75 . according to eq .",
    "( [ eqn1 ] ) , the probability of presence of more than @xmath61 photons in the mode @xmath0 is proportional to @xmath76 and is small for the considered system .",
    "therefore , the state ( [ eqn1 ] ) with probability close to unity belongs to the same @xmath60-dimensional subspace as the state @xmath77 : @xmath78 where @xmath79 . if we construct a measurement , which leads to correct discrimination of the state @xmath29 for the subspace , spanned by the state vectors with photon numbers @xmath75 , the distance between the obtained state ( for the ideal system ) and the desired final state @xmath80 will have the order not greater than @xmath81 where @xmath82 is the probability of successful generation of the desired final state .",
    "therefore , if the probability @xmath82 has the order at least @xmath83 , the error of exploiting the approximate discrimination technique will have the order @xmath84 which is much smaller than the decrease of the final state fidelity caused by non - ideality of the quantum channel .",
    "calculations below show that this condition is fulfilled for the considered system .",
    "thus , for generating the state @xmath85 composed by the sum of @xmath72 phase correlated pairs of coherent states of modes @xmath2 and @xmath15 , one needs to construct a scheme for elimination of @xmath61 vectors @xmath62 , @xmath65 .",
    "the next step of designing the scheme for discrimination of the state @xmath29 is construction of the set of independent states @xmath86 in the form suitable for realizing elimination measurements with linear optical elements and photodetectors .",
    "realization of such measurement for coherent states is known ( see e.g. ref .",
    "@xcite ) , therefore , it is desirable that the basis states @xmath87 be coherent states @xmath88 with amplitudes @xmath89 . in this case",
    "the orthogonality conditions have the form @xmath90 .",
    "then the coherent states amplitudes @xmath91 can be found as @xmath61 roots of the @xmath61-th order equation @xmath92 and are uniquely defined for any given set @xmath93 .",
    "these statements are correct in the nondegenerate case .",
    "presence of degenerate roots of eq .",
    "( [ eqn8 ] ) leads to linear dependence of the set @xmath94 . in this case",
    "additional vectors must be added to the set to provide completeness .",
    "these vectors can be constructed in the following way .",
    "if the root @xmath95 has the multiplicity @xmath96 , then for @xmath97 holds @xmath98 on the other hand , @xmath99 eqs .",
    "( [ eqn9])([eqn10 ] ) prove orthogonality of the vectors @xmath100 to @xmath101 for @xmath102 . instead of @xmath103 copies of the vector @xmath104",
    "we obtain @xmath103 vectors @xmath105 , @xmath106 , that are ( i ) independent and ( ii ) orthogonal to @xmath29 .",
    "thus , in general case the set of vectors @xmath107 , where @xmath108 and index @xmath109 enumerates distinct roots of eq .",
    "( [ eqn8 ] ) , is the required set of @xmath61 independent vectors , orthogonal to @xmath29 .",
    "this set of states can be constructed for any desired final state of the form ( [ eqn3 ] ) with finite number of terms and is uniquely defined for a fixed set of coefficients @xmath93 .",
    "therefore , eq",
    ".  ( [ eqn8 ] ) provides the unique solution of the problem of generating any final state of the form  ( [ eqn3 ] ) with minimal exploited resources .      in the nondegenerate case discrimination of the state @xmath110",
    "is based on quite a well known technique of eliminating coherent states ( fig .",
    "[ fig2 ] ) .",
    "for example , for eliminating a single coherent state @xmath111 the measured state is displaced in phase space by the magnitude @xmath112 ( the displacement is described by operator @xmath113 ) .",
    "the displacement operator transforms coherent state @xmath114 into the vacuum state , and detection of photons in the field mode after the displacement ( fig .",
    "[ fig2](a ) ) manifests that the measured state _ was not _",
    "it should be noted that the considered detectors need not resolve photon numbers or be 100% efficient .",
    "cc * ( a ) * & + & .",
    "@xmath115 is the operator of coherent displacement with the magnitude @xmath112 . *",
    "( b ) * scheme for elimination of a set of coherent states latexmath:[$    measurement for a single coherent state @xmath114 with the coherent displacement operator @xmath115 being effectively realized by mixing the mode @xmath0 with the reference mode @xmath117 in coherent state @xmath118 at linear beamsplitter @xmath119 . *",
    "( d ) * scheme for elimination of coherent states @xmath120 , @xmath121 , with linear beamsplitters ( @xmath119 , ... , @xmath122 ; @xmath123 , ... , @xmath124 ) and photodetectors(@xmath125 , ... , @xmath126 ) ; reference coherent states for implementing necessary displacements in phase space are obtained by splitting reference field @xmath18 and applying phase shifts @xmath127 ,  ... , @xmath128.,title=\"fig : \" ] +   + * ( b ) * & + & .",
    "@xmath115 is the operator of coherent displacement with the magnitude @xmath112 .",
    "* ( b ) * scheme for elimination of a set of coherent states latexmath:[$    measurement for a single coherent state @xmath114 with the coherent displacement operator @xmath115 being effectively realized by mixing the mode @xmath0 with the reference mode @xmath117 in coherent state @xmath118 at linear beamsplitter @xmath119 . *",
    "( d ) * scheme for elimination of coherent states @xmath120 , @xmath121 , with linear beamsplitters ( @xmath119 , ... , @xmath122 ; @xmath123 , ... , @xmath124 ) and photodetectors(@xmath125 , ... , @xmath126 ) ; reference coherent states for implementing necessary displacements in phase space are obtained by splitting reference field @xmath18 and applying phase shifts @xmath127 ,  ... , @xmath128.,title=\"fig : \" ] +   + * ( c ) * & + & .",
    "@xmath115 is the operator of coherent displacement with the magnitude @xmath112 . *",
    "( b ) * scheme for elimination of a set of coherent states latexmath:[$    measurement for a single coherent state @xmath114 with the coherent displacement operator @xmath115 being effectively realized by mixing the mode @xmath0 with the reference mode @xmath117 in coherent state @xmath118 at linear beamsplitter @xmath119 . *",
    "( d ) * scheme for elimination of coherent states @xmath120 , @xmath121 , with linear beamsplitters ( @xmath119 , ... , @xmath122 ; @xmath123 , ... , @xmath124 ) and photodetectors(@xmath125 , ... , @xmath126 ) ; reference coherent states for implementing necessary displacements in phase space are obtained by splitting reference field @xmath18 and applying phase shifts @xmath127 ,  ... , @xmath128.,title=\"fig : \" ] +   + * ( d ) * & + & .",
    "@xmath115 is the operator of coherent displacement with the magnitude @xmath112 . *",
    "( b ) * scheme for elimination of a set of coherent states latexmath:[$    measurement for a single coherent state @xmath114 with the coherent displacement operator @xmath115 being effectively realized by mixing the mode @xmath0 with the reference mode @xmath117 in coherent state @xmath118 at linear beamsplitter @xmath119 . *",
    "( d ) * scheme for elimination of coherent states @xmath120 , @xmath121 , with linear beamsplitters ( @xmath119 , ... , @xmath122 ; @xmath123 , ... , @xmath124 ) and",
    "photodetectors(@xmath125 , ... , @xmath126 ) ; reference coherent states for implementing necessary displacements in phase space are obtained by splitting reference field @xmath18 and applying phase shifts @xmath127 ,  ... , @xmath128.,title=\"fig : \" ] +    elimination of a set of coherent states @xmath129 can be carried out in a similar way by splitting the field mode @xmath0 into @xmath61 modes ( fig .",
    "[ fig2](b ) ) .",
    "each of the obtained modes is used for eliminating one of the coherent states @xmath88 . in this case",
    "obtaining photocounts ( `` clicks '' ) from all the detectors corresponds to successful outcomes of elimination of all the vectors @xmath130 and , thus , to successful discrimination of @xmath131 .",
    "the displacement operators can be effectively realized by mixing the field mode @xmath0 with additional reference modes @xmath117 ,  ... , @xmath132 in corresponding coherent states @xmath133 ,  ... , @xmath134 ( prepared by splitting the reference mode @xmath18 and applying additional phase shifts ) at linear beamsplitters ( fig .  [ fig2](c ) ) .",
    "for example , for elimination of a single coherent state @xmath114 one mixes the mode @xmath0 with a single reference mode @xmath117 at linear beamsplitter @xmath119 with transmittance @xmath135 ( fig .",
    "[ fig2](c ) ) .",
    "if the amplitude of the reference mode coherent state equals @xmath136 and the measured state of the mode @xmath0 is @xmath137 , after mixing at the beamsplitter the modes will be in the state @xmath138 .",
    "the obtained state of the mode @xmath0 can be used for some further operations , while the mode @xmath117 appears just in the state , required for implementing elimination measurement : the amplitude of the initial coherent state @xmath139 is displaced by magnitude @xmath112 .",
    "additional phase factor @xmath140 is irrelevant for detection of presence of photons in the mode , and decrease of the field intensity by the factor @xmath141 influences only the probability of detecting photons and , thus , of obtaining successful elimination outcome . in an important case , when the mode @xmath0 is discarded after the elimination measurement , the efficiency of the measurement can be improved by requiring @xmath142 ( then @xmath143 and success probability is approximately the same as for the scheme in fig .",
    "[ fig2](a ) ) .",
    "the scheme suitable for implementing elimination measurements in general case of @xmath61 coherent states @xmath144 is shown in fig .",
    "[ fig2](d ) .",
    "if the measured state of the mode @xmath0 is coherent state @xmath139 , we require the states of the reference modes @xmath145 after mixing with the mode @xmath0 at beamsplitters to be coherent states @xmath146 , where @xmath147 is certain coefficient independent of the mode number @xmath148 .",
    "these states correspond to displacement of the amplitude @xmath149 of the measured coherent state by magnitudes @xmath150 and can be used for carrying out corresponding elimination measurements .",
    "transmittances @xmath151 of the beamsplitters @xmath152 in this case are defined in the unique way by the above requirement of obtaining correct coherent displacements . as in the case of single coherent state @xmath114",
    ", we require the transmittance of the last beam splitter to be small : @xmath153 ( the mode @xmath0 is discarded after implementing elimination measurements ) .",
    "the condition of dividing the amplitude @xmath149 of measured coherent state into equal parts @xmath147 between the modes @xmath145 leads to the following system of equations for the beamsplitter transmittances ( we define parameters @xmath154 by @xmath155 ) : @xmath156 solving these equations together with the requirement @xmath157 , one finds the following expressions for the transmittances of the beamsplitters : @xmath158 and coefficient @xmath147 : @xmath159    the amplitudes of the reference modes coherent states @xmath160 are also defined in the unique way by the requirement of obtaining correct coherent displacements in implemented elimination measurements .",
    "the following recurrent system of equation can be obtained : @xmath161 where @xmath162 is the amplitude of reference coherent state , mixed to the mode @xmath0 by first @xmath148 beamsplitters .",
    "the solution of this system of equations is @xmath163    as stated above , coherent states of reference mode @xmath145 with the required amplitudes @xmath164 can be obtained by splitting coherent state @xmath165 of the mode @xmath18 ( fig .  [ fig2](d ) ) .",
    "the transmittances @xmath166 of the beamsplitters @xmath167 and the phase shifts @xmath168 are solutions of the following system of equations : @xmath169 the system contains @xmath61 complex equations for @xmath170 real variables @xmath171 ,  ... , @xmath172 , @xmath127 ,  ... , @xmath128 , @xmath173 , @xmath174 .",
    "the solution of the equations is quite cumbersome , and we will provide it in explicit form only for certain special cases , discussed below .      in the degenerate case we need to eliminate not only coherent states , but also the states of the form @xmath175 , created from coherent states by adding fixed number of photons ( photons - added coherent states  pacs ) .",
    "we will show that elimination of pacs can be done exactly in the same way as elimination of coherent states @xmath88 .    for designing a scheme , suitable for elimination of the coherent state with",
    "one added photon , e.g. @xmath176 , it is useful to notice that when a beam with a single - photon excitation is split into two parts by a beamsplitter , the excitation can be detected in one of the two beams , but not in both of the beams simultaneously . if the mode @xmath0 , the state of which is measured , is initially in the state @xmath176 , after splitting the mode into two parts ( e.g. modes @xmath177 and @xmath178 ) we obtain a superposition state @xmath179 , where the added photon can be found in one of the modes , but never in the two modes simultaneously .",
    "therefore , for all the terms of the superposition at least one of the modes is in coherent state @xmath180 .",
    "if we implement measurements , eliminating the state @xmath180 , for both of the modes , two successful outcomes can never be obtained , if the measured state of the mode @xmath0 was latexmath:[$\\hat c^+    outcomes of the elimination measurements correspond to _ elimination _ of the pacs with one added photon latexmath:[$\\hat",
    "c^+    would be obtained , if we tried to eliminate two coherent states @xmath114 and @xmath182 with equal amplitudes @xmath183 by the method , suitable for nondegenerate case .",
    "elimination of a pacs with @xmath184 added photons ( e.g. @xmath185 ) can be carried out in a similar way , taking into account that when a mode with @xmath184 photons is split into @xmath186 parts , it is impossible to detect a photon in each of the @xmath186 modes simultaneously .",
    "therefore , for elimination of the state @xmath187 one can splits the mode @xmath0 into @xmath186 modes .",
    "when @xmath184 photons , added to coherent state @xmath111 according to the definition of the state @xmath185 , are distributed between @xmath186 modes , at least one mode appear in coherent state @xmath188 without added photons .",
    "therefore , @xmath186 successful outcomes of elimination of coherent state @xmath188 for the @xmath186 modes can not be obtained simultaneously if the initial state of the mode @xmath0 is the state @xmath187 ( or any of the states @xmath114 , @xmath189 ,  ... , @xmath190 with lesser numbers of added photons ) .",
    "thus , obtaining successful outcomes of the @xmath186 measurements , eliminating coherent state @xmath188 , corresponds to elimination of the state @xmath187 , as well as of the states @xmath114 , @xmath191 ,  ... , @xmath190 . as in the case , discussed in the previous paragraph",
    ", exactly the same scheme could be used for elimination of the set of coherent states @xmath111 ,  ... , @xmath192 with equal amplitudes @xmath193 if the case were considered as nondegenerate .",
    "the full algorithm of designing discrimination scheme for degenerate case can be summarized as follows . at first , @xmath61 roots @xmath150 of eq .",
    "( [ eqn8 ] ) are found .",
    "then the set of coherent states @xmath88 is constructed .",
    "if the root @xmath95 has multiplicity @xmath194 , @xmath103 `` copies '' of the coherent state @xmath104 are replaced by @xmath103 independent states @xmath104 , @xmath195 ,  ... , @xmath196 . in the obtained set of independent states single coherent states",
    "are eliminated by the method , discussed in the previous subsection .",
    "sets of the states @xmath197 , @xmath195 ,  ... , @xmath198 with different numbers of photons , added to the same coherent state , are eliminated by carrying out measurements , eliminating coherent state @xmath199 ( with amplitude , decreased by splitting ) , for @xmath103 modes , obtained after splitting the mode @xmath0 .",
    "therefore , @xmath103 `` copies '' of the root @xmath95 , appearing in the list of roots of eq .",
    "( [ eqn8 ] ) , correspond in the final discrimination scheme to @xmath103-fold elimination of the coherent state @xmath104 .",
    "it means that one need not make any difference between degenerate and nondegenerate roots of eq .",
    "( [ eqn8 ] ) , eliminating coherent states @xmath88 as many times , as they appear in the list of roots of eq .",
    "( [ eqn8 ] ) .",
    "thus , the scheme , designed for discrimination of the state @xmath29 in nondegenerate case ( fig .",
    "[ fig2](d ) ) , is also suitable for degenerate case .",
    "quite interesting result of applicability of the same scheme for both nondegenerate and degenerate case can be given more rigorous mathematical proof on the basis of operator definition of elimination measurements ( eqs .",
    "( [ eqn7 ] ) , ( [ eqn23 ] ) ) .    as shown in appendix  [ app1 ] ( see eq .",
    "( [ eqn49a ] ) ) , transformation of the system density matrix in the case of successful outcomes of the @xmath61 measurements , eliminating coherent states @xmath88 , ( photocounts obtained from all the detectors @xmath200 ) has the form @xmath201 where density matrices @xmath202 and @xmath203 describe the system state before and after implementing elimination measurements respectively ; superoperator @xmath204 ( eq .  ( [ eqn32 ] ) ) describes the part of system state transformation , which does not depend on measurement outcomes ; the sets of operators @xmath205 correspond to successful elimination of coherent states @xmath88 : @xmath206 @xmath207 ) are degenerate , i.e. that successful outcome of `` @xmath103-fold elimination '' of the state @xmath104 , corresponding to the root @xmath95 with multiplicity @xmath103 , ( or , in other words , successful elimination of @xmath103 `` copies '' of the state @xmath104 ) corresponds to elimination of the states @xmath104 , @xmath195 ,  ... , @xmath196 .",
    "the successful result of `` @xmath103-fold elimination '' of the state @xmath104 is described by operator @xmath208 where @xmath209 .",
    "the expression @xmath210 contains powers of operator @xmath211 not less than @xmath212 for @xmath213 . therefore , operator ( [ eqn52 ] ) corresponds to elimination of the states @xmath214 , @xmath215 : @xmath216 which proves the conclusion made in the previous subsection .      for obtaining the expression for the final state of the main field modes @xmath2 and @xmath15 after discrimination of the state @xmath29 by elimination measurements , it is convenient to introduce `` phase - shifting '' operator @xmath217 ( it describes change of the main field modes state after cross - kerr interaction with the mode @xmath0 possessing 1 photon ) and to represent state @xmath218 ( described by eq .",
    "( [ eqn1 ] ) ) using operator of coherent displacement with operator - type argument : @xmath219 with the following property : @xmath220 which leads to significant simplification of eq .",
    "( [ eqn49 ] ) for the final state density matrix . as shown in appendix  [ app1 ] ( eqs .",
    "( [ eqn59 ] ) , ( [ eqn60 ] ) ) , the final state of main field modes @xmath2 and @xmath15 after elimination of all the states @xmath221 and subsequent discarding the ancillary mode @xmath0 is described by density matrix @xmath222 the obtained expression means that the distance between the desired final state and the state @xmath223 , generated by the scheme , has the order @xmath224 and is small enough to be neglected when nonideality of the system is taken into account .    it should be noted that in certain cases the final states , generated when `` clicks '' were obtained not from all the detectors , can also be useful ( `` semi - successful '' results ) .",
    "such states are described by expressions , similar to eq .",
    "( [ eqn15 ] ) but without multipliers , corresponding to the detectors ( with numbers @xmath225 , @xmath226 , ... ) that did not produce `` clicks '' : @xmath227 this expression can be decomposed in the form , similar to the desired final state ( [ eqn3 ] ) but with lower possible degree of entanglement : @xmath228 e.g. for the case of absence of only one photocount the number of terms equals to @xmath61 ( instead of @xmath72 ) and the coefficients @xmath229 can be found as @xmath230 where @xmath231 .    in the next section we provide several examples of final states that can be generated by the protocol for successful and `` semi - successful '' discrimination outcomes .",
    "as the first example of possible applications of the protocol to nonclassical states generation we consider creation of a superposition of states of modes @xmath2 and @xmath15 with correlated photon numbers . we show that such superpositions arise quite naturally in our protocol and then use them to illustrate general formalism , developed in section  [ sec : discrim ] .",
    "as discussed above ( see eq .",
    "( [ eqn27 ] ) ) , cross - kerr interaction correlates photon number of one of the interacting modes with the phase of coherent state of the other mode .",
    "the state @xmath232 , obtained after cross - kerr interaction of the main modes @xmath2 and @xmath15 with the ancillary mode @xmath0 , can be considered either as a superposition , where phases of coherent states of the modes @xmath2 and @xmath15 are proportional to the number of photons in the mode @xmath0 ( eq . ( [ eqn1 ] ) ) , or alternatively as a superposition , where the phase of coherent state of the mode @xmath0 is proportional to the total number of photons in the modes @xmath2 and @xmath15 .",
    "the latter interpretation of the state @xmath232 implies that discrimination of coherent state @xmath233 of the ancillary mode @xmath7 fixes the total number of photons in modes @xmath2 and @xmath15 to be equal to @xmath4 .",
    "the final state @xmath85 in this case is a superposition of fock states of the modes @xmath2 and @xmath15 with the number of photons in each mode varying form 0 to @xmath4 and the total number of photons being equal to @xmath4 for each term .",
    "mathematically this statement can be proved in the following way .",
    "the state @xmath234 can be decomposed in the form : @xmath235 where @xmath236 is a superposition of states of the modes @xmath2 and @xmath15 with fixed total number of photons ( equal to @xmath4 ) ; function @xmath237 is defined as @xmath238 , @xmath239 ; we assume for simplicity that @xmath240 .",
    "suppose that only @xmath61 terms are significant in the superposition ( [ eqn34 ] ) : @xmath241 for @xmath74 , @xmath242 then successful outcome of elimination of @xmath61 coherent states @xmath243 with subsequent discarding of the ancillary mode @xmath0 transforms the state @xmath244 into the following state of the modes @xmath2 and @xmath15 with correlated photon numbers , described above : @xmath245    generation of states of the form ( [ eqn105 ] ) can be described by general formalism , developed in section  [ sec : discrim ] .",
    "for this purpose we find coefficients @xmath17 , for which the general final state @xmath85 ( eq .  ( [ eqn3 ] ) )",
    "is equivalent for the desired final state @xmath246 ( eq .",
    "( [ eqn105 ] ) ) . then coherent states amplitudes @xmath150 can be found by solving eq .",
    "( [ eqn8 ] ) , and expressions for the parameters of discrimination scheme can be derived .    the general expression eq .",
    "( [ eqn3 ] ) for the final state of the modes @xmath2 and @xmath15 can be transformed to the following form : @xmath247 by decomposing coherent states @xmath248 and @xmath249 in terms of fock states , where states @xmath250 are defined by eq .  ( [ eqn80 ] ) .    in order to obtain @xmath251 , the coefficients @xmath17 must satisfy the following system of equations :",
    "@xmath252 before solving this system , it is useful to compare it with eq .",
    "( [ eqn8 ] ) for the amplitudes @xmath150 and to notice , that if coefficients @xmath17 satisfy eq .",
    "( [ eqn107 ] ) , @xmath61 complex numbers @xmath253 , @xmath254 , apparently represent the @xmath61 roots of eq .",
    "( [ eqn8 ] ) .",
    "then , coefficients @xmath17 are defined in the unique way ( except for overall normalization constant ) by the complete system of roots and are equal to @xmath255    for example , if the desired final state is the following one @xmath256 coefficients @xmath17 must be equal to @xmath257 , @xmath258 , @xmath259 ( for unnormalized state ) . amplitudes of the coherent states @xmath88 , eliminated in discrimination scheme , are equal to @xmath260 and @xmath261 in this case . according to eq .",
    "( [ eqn35 ] ) , transmittances of the beamsplitters @xmath119 and @xmath262 are equal approximately to @xmath263 ( for @xmath264 ) and @xmath265 .",
    "the amplitudes of the reference coherent states , defined by eq .",
    "( [ eqn75 ] ) , are @xmath266 and @xmath267 . solving the system of equations ( [ eqn76 ] ) , one finds @xmath268 , @xmath269 , @xmath270 .    for coefficients @xmath271 ( eq .",
    "( [ eqn26 ] ) ) , characterizing final state in the case of `` semi - successful '' outcomes of discrimination when the desired final state for successful outcome is described by eq .",
    "( [ eqn109 ] ) , one obtains the following expressions : @xmath272 , @xmath273 , @xmath274 , @xmath275 .",
    "the final state , generated when `` click '' was obtained from detector @xmath276 , is approximately a vacuum state : @xmath277 while the state , generated when `` click '' was obtained from detector @xmath125 , belongs to the class of states , described by eq .",
    "( [ eqn105 ] ) : @xmath278 and , therefore , can be useful for certain applications .",
    "another group of examples represents states of the form eq .",
    "( [ eqn3 ] ) with maximal entanglement , which is possible for a scheme with fixed number of photodetectors @xmath61 ( and , therefore , with fixed number of terms in the expression ( [ eqn3 ] ) for the final state @xmath85 ) .    in the most simple case of schemes with 1 detector ( @xmath279 ) the coefficients @xmath17 in eq .",
    "( [ eqn3 ] ) , maximizing the final entanglement , can be found analytically as @xmath280 where for simplicity we consider unnormalized final state .",
    "additional condition , required for maximization of entanglement in this case , is @xmath281 ( for simplicity we will assume without loss of generality that @xmath282 ) .",
    "the final state of the system is approximately a bell state @xmath283 is the orthonormal basis for the states of the modes @xmath2 and @xmath15 : @xmath284 consists of the only state @xmath114 with the amplitude @xmath285 , defined by eq .",
    "( [ eqn8 ] ) .",
    "the transmittance of the beam splitter @xmath119 ( fig .  [ fig2](c ) ) equals @xmath286 , and the amplitude of the reference coherent state is @xmath287 .",
    "for the scheme with two detectors ( @xmath288 ) the coefficients @xmath17 , providing maximal entanglement , can be found analytically for systems with @xmath289 and @xmath290 in two limiting cases : @xmath291 ( low distinguishability of main field modes coherent states with and without phase shift equal to @xmath12 : @xmath292 ) and @xmath293 ( high distinguishability : @xmath294 ) .    for @xmath291 the final entanglement is maximal for @xmath295 the final state of the system is @xmath296 are orthonormal basis vectors for the mode @xmath2 and the basis vectors @xmath297 for the mode @xmath15 are defined in a similar way ( with @xmath298 being replaced by @xmath299 ) ; coefficients @xmath300 are determined by the condition of orthonormality of the system of basis vectors .",
    "the final state ( [ eqn14 ] ) possesses entanglement @xmath301 , which is higher than the maximal value , achievable for a pair of qubits .",
    "in this case the coherent states @xmath302 and @xmath303 , exploited in the detection scheme , possess close amplitudes @xmath304 .",
    "transmittances of the beamsplitters @xmath119 and @xmath262 are equal approximately to @xmath263 ( for @xmath264 ) and @xmath305 ; amplitudes of the reference coherent states are @xmath306 and @xmath307 . the parameters of discrimination scheme , defined by eq .",
    "( [ eqn76 ] ) , are equal to @xmath308 , @xmath309 , @xmath270 .    in the opposite",
    "limiting case @xmath310 ( such condition is satisfied simultaneously with @xmath289 in the systems with intense fields @xmath2 and @xmath15 ) entanglement reaches the bound for 3-level system @xmath311 when the parameters are @xmath312    the final state in this case has the form @xmath313 are defined by eq .",
    "( [ eqn112 ] ) above .",
    "amplitudes of coherent states @xmath314 and @xmath315 are equal to @xmath316 .",
    "the transmittances of the beamsplitters @xmath119 and @xmath262 and the amplitudes @xmath317 , @xmath318 of reference modes coherent states are the same functions of the amplitudes @xmath319 and @xmath320 as in the previously discussed limiting case . solving the system of equations ( [ eqn76 ] ) , one can find @xmath321 , @xmath309 , @xmath322 .    for intermediate values of distinguishability ( @xmath323 ) , as well as for greater numbers of detectors ( @xmath324 ) , optimal coefficients",
    "@xmath17 can be found numerically .",
    "the values of maximally possible entanglement for schemes with fixed number of detectors are shown in fig .",
    "[ fig3 ] ( solid lines ) .",
    "one can see that the maximal possible value of entanglement grows with increase of the detectors number @xmath61 , and in certain cases it may be considered as more effective use of fixed resources ( nonlinear interaction , quantum channel ) than can be achieved in schemes with qubit - type entanglement .    .",
    "solid lines : maximal entanglement , possible for generation in the scheme with fixed number of photodetectors @xmath61 : @xmath279 ( 1 ) , @xmath288 ( 2 ) , @xmath325 ( 3 ) . dashed lines ( 2a , 2b ) : entanglement of the final state , generated by the scheme with @xmath288 detectors with optimized coefficients @xmath17 in `` semi - successful '' case ( one photocount instead of two",
    "; entanglement does not depend on the number of the detector , which `` clicked '' ) .",
    "dot - dashed lines ( 3a , 3b , 3c ) : final state entanglement for @xmath325 and 1 absent photocount .",
    "dotted lines ( 3d , 3e , 3f ; line 3f coincides with the solid line 1 ) : final entanglement for @xmath325 and 2 absent photocounts . ]",
    "[ fig3 ] also illustrates entanglement of final states , generated by these schemes for `` semi - successful '' outcomes ( obtaining photocounts from lesser number of detectors ; dashed , dotted and dot - dashed lines in fig .",
    "[ fig3 ] ) .",
    "these final states possess non - zero entanglement and in certain cases can also be useful for solving information processing tasks .",
    "for example , the scheme with @xmath325 detectors , optimized for obtaining maximal entanglement in the case of successful discrimination outcome , in the case of two absent photocounts can also produce maximally entangled state from the space of states @xmath85 with 2 non - zero terms ( line 3f in fig .",
    "[ fig3 ] ) .",
    "in previous sections we assumed for simplicity that the quantum channel and photodetectors are ideal . in order to prove realizability of the proposed entanglement generation method in realistic situations we discuss influence of system nonideality on the fidelity of obtaining final state .    in real system decoherence and dephasing",
    "accompany all the stages of the protocol : implementation of nonlinear interaction , transmission of the probe beam through the quantum channel , storage of main modes @xmath2 and @xmath15 in local resonators .",
    "all these factors can be taken into account by solving corresponding master equations @xcite . however , for the system , considered in our paper , influence of some of the factors on the fidelity of final state generation is supposed to be small .",
    "therefore , for the purpose of simplifying further description , we take into account only the following factors that can limit applicability of our protocol :    1 .",
    "[ nonid1 ] decoherence of modes @xmath2 and @xmath15 during cross - kerr interaction with probe beam @xmath0 ( decoherence of the mode @xmath0 is assumed to have negligible effect due to much smaller amplitude of the probe beam : @xmath326 inaccuracies in the nonlinearity values of the used kerr media ( we assume that effective strengthes of nonlinear interactions carried out by alice and bob are equal to @xmath327 and @xmath328 respectively and differ from the value @xmath12 used in the scheme optimization ) ; 3 .",
    "[ nonid3 ] decoherence caused by nonideality of local resonator at alice s site ( bob s resonator is not used for storing part of an entangled state for a long time , and its nonideality is supposed to effect the final state fidelity negligibly ; dephasing in the resonators is assumed to be small due to controllable laboratory conditions ) ; 4 .   [ nonid4 ] decoherence and dephasing in the quantum channel ; 5 .   [ nonid5 ] limited efficiency ( probability of detecting a photon , present in the field mode , equals @xmath329 ) and dark counts of photodetectors ( obtaining photocount with probability @xmath330 when the mode is in the vacuum state ) .",
    "for describing nonideality of the system we consider four stages of the protocol separately and find ( super-)operators , describing difference between the states , obtained in ideal and nonideal systems .",
    "it should be noted that operator , transforming one fixed state into another fixed state ( ideal state into nonideal one in the considered case ) , is not defined in the unique way : its action on states from orthogonal space can be arbitrary . in further consideration",
    "we try to choose operators , acting on the main modes only ( but not on the ancillary one ) , from sets of equivalent operators , transforming ideal density matrix into the nonideal one .",
    "then the final state after implementing all the stages of the protocol is expected to be presented in the form of certain superoperator , acting on the ideal final state @xmath331 of the main modes @xmath332 and @xmath15 .",
    "the first stage of the protocol is cross - kerr interaction of modes @xmath2 and @xmath0 .",
    "we describe this nonlinear interaction in nonideal case by the following master equation : @xmath333 + \\kappa_1",
    "\\hat l ( \\hat a ) \\rho,\\ ] ] where @xmath334 + \\left [ \\hat x , \\rho \\hat x \\right]$ ] . as discussed above ( item [ nonid1 ] in the list of nonideality types ) , the only kind of nonideality taken into account by eq .",
    "( [ eqn61 ] ) is decoherence of the mode @xmath2 .    assuming that the duration of interaction is @xmath335",
    ", one can characterize the nonlinear interaction by effective strength @xmath336 and relative loses rate @xmath337 ( @xmath338 , where @xmath339 and @xmath340 are beam intensities before and after the interaction ) .    in the ideal case ( @xmath341 ) state transformation due to discussed cross - kerr interaction",
    "is described by unitary operator @xmath342 the initial uncorrelated state latexmath:[$|\\alpha\\rangle_a",
    "|\\beta\\rangle_b    where the phase of coherent state of the mode @xmath2 is proportional to the number of photons in the mode @xmath0 : @xmath344    transformation of the system state in the nonideal case can be found by solving the master equation eq .",
    "( [ eqn61 ] ) with the initial condition @xmath345 , where @xmath346 is the initial uncorrelated density matrix ( initial amplitudes @xmath347 , @xmath348 , @xmath349 of coherent states in the nonideal case must be larger that the amplitudes @xmath298 , @xmath299 , @xmath3 that are expected to characterize final state ) .",
    "the solution can be found by representing the density matrix of the modes @xmath2 and @xmath0 in the form @xmath350 which is preserved during evolution . substituting this decomposition into eq .",
    "( [ eqn61 ] ) and solving the resulting system of differential equations , one can obtain the following expressions for the quantities @xmath351 and @xmath352 at the end of the considered stage of the protocol : @xmath353 @xmath354 where smallness of nonideality is assumed for simplicity of derived expressions .",
    "the exponential factor in eq .",
    "( [ eqn89 ] ) describes influence of kerr medium nonideality on the state , obtained after the interaction . for characterizing transition from the ideal state eq .",
    "( [ eqn114 ] ) to the nonideal one the following superoperator , acting in the state space of the mode @xmath2 , can be chosen from the class of equivalent operators , describing this state transformation : @xmath355 this superoperator adds small phase shift to the coefficients before coherent states of the mode @xmath2 and decreases non - diagonal elements of the density matrix .",
    "another factor , which influences fidelity of the final state generation but is not connected with nonideality of the kerr medium itself , is deviation of the nonlinearity effective strength @xmath356 from its expected value @xmath12 , used during optimization of the discrimination scheme parameters .",
    "this factor can be accounted for by introducing superoperator @xmath357 which provides additional phase shift to coherent states of the mode @xmath2 .",
    "the second stage of the protocol consists in transmission of the ancillary field from alice to bob . at the same time",
    "the mode @xmath358 , already correlated with the ancillary mode @xmath0 , is stored at alice s site .",
    "these two modes interact with the environment independently , and corresponding kinds of nonideality are considered separately .",
    "decoherence of the mode @xmath2 in nonideal local resonator is described by the following master equation : @xmath359 if duration of this stage is equal to @xmath360 , relative losses rate equals to @xmath361 .    the solution of eq .",
    "( [ eqn116 ] ) can be found in the way , similar to the one used for the previous stage of the protocol .",
    "the amplitude of coherent states of the mode @xmath2 @xmath362 after this stage of the protocol must be equal to its final value @xmath298 .",
    "the influence of decoherence in alice s local resonator on the state of the system can be described by the superoperator @xmath363 transforming the system state in the same way as @xmath364 .",
    "interaction with the environment of the ancillary mode @xmath0 during the second stage of the protocol is described by master equation @xmath365 where the first and the second terms describe decoherence and dephasing of the mode @xmath0 respectively ( see item [ nonid4 ] in the list of nonideality factors ) . for characterizing this type of system nonideality",
    "one can introduce relative losses rate @xmath366 and mean phase error @xmath367 .",
    "due to commutativity of @xmath368 and @xmath369 ( in the sense that @xmath370 ) , the master equation eq .",
    "( [ eqn62 ] ) can be divided into two independent parts , describing decoherence and dephasing",
    ".    state transformation because of decoherence has the form : @xmath371 dephasing of the mode @xmath0 transforms the system state as @xmath372    as stated above , for certain simplification of further consideration it is useful to choose superoperators , acting on the main field modes only , from the set of equivalent superoperators , describing transition between ideal and nonideal case . for this purpose",
    "we take into account that in the expression ( [ eqn114 ] ) for the ideal system state number states @xmath373 of the ancillary mode appear in pairs with coherent states @xmath374 .",
    "therefore , decrease of non - diagonal density matrix elements in the basis of fock states of the mode @xmath0 is equivalent to corresponding decrease of non - diagonal elements for the mode @xmath2 in the basis of coherent states . in a similar way , discrete changes of photon number in the mode @xmath0 , caused by energy losses in the quantum channel and described by eq .",
    "( [ eqn65 ] ) , are equivalent to corresponding discrete changes of phase of the mode @xmath2 .",
    "after certain mathematical calculations , one can show that the difference between ideal and nonideal states , caused by decoherence and dephasing of the mode @xmath0 , can be described by superoperators @xmath375 and @xmath376 respectively .",
    "the third stage of the protocol is cross - kerr interaction of modes @xmath15 and @xmath0 , described by the following master equation : @xmath377 + \\kappa_3 \\hat l ( \\hat b ) \\rho,\\ ] ] and characterized by effective nonlinearity strength @xmath378 and relative losses rate @xmath379 ( we will assume for simplicity that @xmath380 ) , where @xmath381 is the duration of the interaction .    in the ideal case",
    "this nonlinear interaction is described by operator @xmath382 with the obtained state latexmath:[$\\hat u_{bc } \\hat u_{ac }    @xmath232 ( see eq .",
    "( [ eqn1 ] ) ) .    for nonideal system , master equation eq .",
    "( [ eqn63 ] ) can be solved exactly in the same way as eq .",
    "( [ eqn61 ] ) .",
    "the superoperator , describing transition between ideal and nonideal cases , has the form @xmath384 and , similarly to @xmath385 , adds small phase shift to the coefficients before coherent states of the mode @xmath15 and decreases non - diagonal elements of the density matrix .",
    "deviation of the nonlinearity effective strength @xmath386 from its expected value @xmath12 can be accounted for by introducing the following superoperator , describing additional phase shift to coherent states of the mode @xmath15 : @xmath387      the last stage of the protocol is discrimination of the state @xmath29 of the mode @xmath0 at bob s site .",
    "this stage includes operations on the ancillary mode @xmath0 only and does not influence directly modes @xmath2 and @xmath15 ( their state is transformed due to previously generated correlations with the ancillary mode ) .",
    "all the superoperators @xmath385 , @xmath388 , @xmath389 , @xmath390 , @xmath391 , @xmath392 , @xmath393 , introduced for describing nonideality of the three preceding stages of the protocol , act on the state spaces of the mode @xmath2 and @xmath15 .",
    "therefore , they must commute with any superoperators , characterizing the last stage of the protocol , and can be considered as acting _ after _ implementation of nonideal discrimination measurement . for such consideration the input state of the discrimination scheme is the state @xmath234 , defined by eq .",
    "( [ eqn1 ] ) .    for the ideal system , obtaining successful outcome of all the elimination measurements , followed by discarding of the mode @xmath7 ,",
    "transforms the input weakly entangled state @xmath232 into the desired final state @xmath394 ( see eqs .",
    "( [ eqn56 ] ) , ( [ eqn15 ] ) ) .",
    "probability of this successful outcome equals @xmath395 of registering photons  see item [ nonid5 ] in the list of types of system nonideality ) leads to decrease of probability of obtaining successful discrimination outcome , effectively reducing fraction @xmath147 of the coherent state amplitude of the ancillary mode , interacting with photodetectors , by factor @xmath396 : @xmath397 .",
    "then one - run success probability for nonideal detection scheme is equal to @xmath398    dark counts of photodetectors lead to mixing density matrices , characteristic to `` semi - successful '' outcomes , to the final density matrix , corresponding to successful elimination of all the states @xmath88 .",
    "then , according to eqs .",
    "( [ eqn56])([eqn26 ] ) , successful discrimination of the state @xmath29 by the scheme with nonideal photodetectors transforms the state @xmath399 into the following mixed state : @xmath400 where @xmath148-th term corresponds to presence of @xmath401 dark counts .      summarizing the results concerning discussed types of system nonideality",
    ", we can express the density matrix of the final state of the modes @xmath2 and @xmath15 in the following form : @xmath402    this expression can be simplified by taking into account that coherent states of the modes @xmath2 and @xmath15 posses correlated phases in all terms of the expression for the density matrix @xmath403 ( eq .  ( [ eqn97 ] ) ) and",
    "appear only in groups of the form @xmath404 or @xmath405 .",
    "therefore , superoperators @xmath406 , @xmath389 , @xmath407 , @xmath408 act at the system state in the same way : they add small phase shifts to the coefficients @xmath17 ( or @xmath409 ) and decreases non - diagonal elements of the density matrix . due to commutativity of the superoperators , they can be collected in a single superoperator @xmath410 transforming pairs of coefficients @xmath411 of the state @xmath412 ( as well as pairs of coefficients @xmath413 with the similar meaning , defined by eq .",
    "( [ eqn26 ] ) ) in the following way : @xmath414 where @xmath415 is a phase difference per photon and @xmath416 describes decay of non - diagonal elements of density matrix .    the first term in the exponent of eq .",
    "( [ eqn85 ] ) corresponds to changing phase of coefficients @xmath17 and can be compensated by corresponding changes in the detection scheme ( by replacing @xmath150 by @xmath417 in expressions for the scheme parameters ) .",
    "therefore , only the second term of the exponent is essential for estimation of the deviation of the nonideal final state from the ideal one .    finally , expression ( [ eqn77 ] ) for the density matrix , obtained in for nonideal system , can be rewritten using the notations of eq .",
    "( [ eqn22 ] ) in the form @xmath418 where @xmath419 . in further consideration",
    "we assume that all types of nonideality , present in the system , are weak enough and the fidelity is close to unity ( such systems are most useful from the practical point of view ) .",
    "then the density matrix , defined by eq .",
    "( [ eqn79 ] ) , is approximately equal to @xmath420 where notation @xmath421 is introduced for the superoperators ; only the leading order of small parameters , characterizing nonideality of the system , is taken into account .      according to the standard definition , the fidelity of generating the desired final state @xmath85 equals @xmath422 where @xmath423 is the actual final state of the main field modes @xmath2 and @xmath15 , defined by eqs .",
    "( [ eqn79 ] ) , ( [ eqn74 ] ) .    using eqs .",
    "( [ eqn74 ] ) , ( [ eqn83 ] ) and carrying out quite straightforward mathematical calculations , one can obtain the following expression for the fidelity of final state generation : @xmath424 where @xmath425 .    for further consideration it is convenient to introduce unnormalized states @xmath426 , which are useful , for example , when exponent is decomposed in eq .",
    "( [ eqn85 ] ) .",
    "then it is quite easy to show that @xmath427 where we suppose that the term proportional to @xmath428 vanishes due to correct phase compensation .",
    "representing states of the form @xmath429 and @xmath430 as @xmath431 and decomposing exponents in power series in this expression , one can simplify the term in the sum in eq .",
    "( [ eqn98 ] ) , corresponding to deviations of nonlinearity strengthes from their expected value @xmath12 : @xmath432    analytical expression for the remaining term in the sum can be found in two limiting cases : @xmath433 for @xmath291 and @xmath434 for @xmath293 .",
    "( [ eqn98 ] ) , ( [ eqn99 ] ) , ( [ eqn100])([eqn16 ] ) provide the expression for the final state generation fidelity for any desired final state @xmath85 described by eq .",
    "( [ eqn3 ] ) .      further simplification of the derived above equations for the final state fidelity can be carried out in special cases , considered in section  [ sec : special ] .",
    "we discuss the states with maximal entanglement , possible for a scheme with fixed number of detectors ( @xmath279 and @xmath288 ) . on the basis of explicit expressions for the fidelity of such states generation we find conditions , that must be imposed on the system parameters in order to obtain sufficiently high fidelity of final state generation .    for most of physical systems , suitable for implementation of the protocol , assumptions that @xmath289 and @xmath435 are valid .",
    "in this paper we discuss analytical results obtained under these assumptions only ( however , the opposite limiting case @xmath293 can also be described analytically ) .    for maximally entangled state , generated by the scheme with @xmath279 detector ( eqs .",
    "( [ eqn11 ] ) , ( [ eqn12 ] ) ) , we obtain @xmath436 @xmath437 and @xmath438 where @xmath439 are relative inaccuracies of the nonlinear interaction strengthes ; we assumed for simplicity that @xmath290 and @xmath440 .",
    "for the scheme with @xmath288 detectors and coefficients @xmath17 described by eq .",
    "( [ eqn13 ] ) the form of eqs .",
    "( [ eqn101])([eqn103 ] ) remains the same , but expressions in the right hand side of eqs .",
    "( [ eqn101 ] ) , ( [ eqn102 ] ) get numerical factor 2 .",
    "the finally obtained expression for decrease of the final state fidelity contains 6 distinct terms , corresponding to different types of processes in the system : eq .",
    "( [ eqn101 ] ) corresponds to 3 terms , proportional to @xmath441 , @xmath442 and @xmath443 ( see eq .",
    "( [ eqn87 ] ) for @xmath444 ) ; eq .",
    "( [ eqn102 ] ) and eq .",
    "( [ eqn103 ] ) provide expressions for the terms , describing nonlinearity strength inaccuracies and nonideality of photodetectors respectively ; eq .",
    "( [ eqn90 ] ) corresponds to decoherence of the mode @xmath0 that can be described by effective discrete phase errors in the mode @xmath2 . in order to estimate parameters values , suitable for final state generation with sufficient fidelity ,",
    "we require each of the discussed 6 terms to be not greater than some small value @xmath445 , @xmath446 ( then the fidelity will be not less than @xmath447 ) .",
    "the obtained 6 inequalities can be used for finding 6 independent system parameters .    for this purpose",
    "we divide parameters , describing the system , into four groups :    1 .",
    "parameters @xmath330 , @xmath396 , @xmath448 characterize exploited `` local '' equipment ( photodetectors , maximal field intensities providing small decoherence during local operations ) and are supposed to be fixed by characteristics of existing equipment ; in numerical estimations we assume that dark count probability has the values @xmath449 when detectors efficiency equals @xmath450 and @xmath451 for @xmath452 ( such values can be achieved for ingaas / inp photodetectors @xcite ) ; we also assume that @xmath453 ; 2 .",
    "parameters @xmath12 , @xmath454 , @xmath455 , @xmath442 characterize local cross - kerr interaction ; we use the inequalities to estimate these parameters values and to find out whether such nonlinear interaction can be realized experimentally ; 3 .",
    "parameters @xmath456 , @xmath441 , @xmath443 characterize properties of the quantum channel and local resonator and determine maximal distance of entanglement generation ; 4 .   the ancillary field amplitude @xmath457 can be changed and is chosen so as to provide maximal success probability for sufficiently high fidelity of the final state generation .",
    "therefore , the discussed inequalities , providing sufficient fidelity , can be expressed in the following way ( for @xmath279 ; for @xmath288 the conditions are the same except for numerical factor 1/2 in conditions 2 , 3 , 4 , 6 ) : @xmath458    the first of the conditions limits acceptable losses in the quantum channel .",
    "this limitation is fundamental for optical methods of information processing when dark counts of photodetectors are present ( see e.g. comments in ref .",
    "for instance , for the considered above parameters and the desired fidelity @xmath459 the maximal acceptable attenuation of the channel is limited by values @xmath460 , which for optical fiber with attenuation 0.20  db / km correspond to maximal distances about @xmath461 .",
    "however , it should be noted , that entanglement generation at such distances requires quite long storage of the field @xmath2 in alice s local resonator . the value of the resonator finesse , required for preserving sufficient state fidelity and defined on the basis of the second condition of eq .",
    "( [ eqn21 ] ) , is about @xmath462 in this case .",
    "even greater values have already been predicted theoretically for crystalline whispering gallery mode resonators @xcite .",
    "experimentally demonstrated high - quality resonators are characterized by values up to @xmath463 @xcite . therefore , we believe that the protocol will be more suitable for efficient entanglement generation when the best available quantum channel connecting alice s and bob s sites is lossier than optical fiber .",
    "the third condition provides lower bound on the nonlinearity value . for @xmath464 and the considered above parameters the minimal nonlinearity strength is @xmath465 .",
    "such values has already been predicted in existing systems for the case of precise radiation focusing @xcite . it should be noted , that not only nonlinearity strength , but also acceptable signal attenuation during cross - kerr interaction is limited ( the fourth condition of eq .",
    "( [ eqn21 ] ) leads to requirement @xmath466 ) .    the fifth condition of eq .",
    "( [ eqn21 ] ) limits maximal probe beam intensities and determines the maximal possible one - run success probability for the protocol , described by eq .",
    "( [ eqn82 ] ) . for the protocol with @xmath279 detector",
    "the success probability is sufficiently large for all losses values not exceeding the limit determined by the first condition of eq .",
    "( [ eqn21 ] ) ( fig .",
    "[ fig4 ] ) . for @xmath467 generation of the desired final state can be implemented without too large number of ancillary field transmissions for losses not more than approximately 14  db ( which correspond to the distances up to 70  km in optical fiber ) .",
    "cc * ( a ) * & + &   on the relative losses rate @xmath456 for the protocol with @xmath61 photodetectors for fixed fidelity of final state generation @xmath459 : @xmath279 ( 1 ) , @xmath288 ( 2 ) .",
    "dotted line corresponds to the limit of entanglement generation because of dark counts of detectors . *",
    "( b ) * dependence of one - run success probability @xmath82 on the desired fidelity @xmath468 for the protocol with @xmath61 photodetectors and different losses rates @xmath456 : @xmath279 , @xmath469 ( 1 ) , @xmath279 , @xmath470 ( 2 ) , @xmath288 , @xmath469 ( 3 ) , @xmath288 , @xmath470 ( 4).,title=\"fig : \" ] +   + * ( b ) * & + &   on the relative losses rate @xmath456 for the protocol with @xmath61 photodetectors for fixed fidelity of final state generation @xmath459 : @xmath279 ( 1 ) , @xmath288 ( 2 ) .",
    "dotted line corresponds to the limit of entanglement generation because of dark counts of detectors . *",
    "( b ) * dependence of one - run success probability @xmath82 on the desired fidelity @xmath468 for the protocol with @xmath61 photodetectors and different losses rates @xmath456 : @xmath279 , @xmath469 ( 1 ) , @xmath279 , @xmath470 ( 2 ) , @xmath288 , @xmath469 ( 3 ) , @xmath288 , @xmath470 ( 4).,title=\"fig : \" ] +   +    the maximal acceptable relative inaccuracies of nonlinearity strengthes @xmath471 , @xmath472 , defined by the last condition of eq .",
    "( [ eqn21 ] ) , are equal to 0.09 for @xmath279 and to 0.06 for @xmath288 .",
    "such parameters values can be achieved in real systems , and , therefore , our calculations prove applicability of the protocol for entanglement generation between sites , separated by lossy media , using contemporary experimental equipment .",
    "to summarize , in the present work we have proposed a protocol for creating a wide class of qudit - type states ( including entangled states ) with arbitrary dimensionality in continuous variable system using weak cross - kerr nonlinearity , linear beamsplitters , detectors not resolving photon numbers , and sources of coherent states .",
    "the method of entanglement generation is based on using an ancillary field mode , transmitted from alice s site to bob s one through lossy quantum channel .",
    "weak nonlinear interaction of the mode with the main field modes possessed by alice and bob leads to creation of a weakly entangled 3-modes state .",
    "the main problem , solved in our work is designing a scheme for the ancillary mode state measuring leading to probabilistic entanglement enhancement and transforming the `` raw '' weakly correlated state into highly entangled final one .",
    "the found povm measurement is shown to be implementable with linear optics and photodetectors , not resolving photon numbers , on the basis of elimination measurements .",
    "the equation , defining parameters of the detection scheme for a given desired final state in a unique way , is also derived in our paper .",
    "our calculations prove applicability of the proposed protocol in the case of realistic photodetectors with limited efficiency and dark counts , nonlinear kerr interaction with decaying modes , uncertainty of coupling constants , and lossy quantum channel .",
    "it has been shown that the protocol can be used for creating quantum states with entanglement higher than unity and , therefore , in certain cases corresponds to more effective use of resources than can be achieved for protocols based on entangling qubit systems .",
    "the fidelity of final state generation @xmath459 can be achieved when a quantum channel with losses rate up to @xmath460 is available ( it corresponds to distances up to 140  km for optical fiber ) .",
    "required cross - kerr nonlinearity is @xmath473 and can be created using contemporary equipment .",
    "the work has been supported partially by the european commission via project `` engineering quantum information in nanostructured diamond '' .",
    "here we provide mathematical description of system state transformation when measurements , eliminating coherent states @xmath474 , are implemented . the considered measurement scheme is shown in fig .",
    "[ fig2](d ) .",
    "the mode @xmath0 is mixed at linear beamsplitters with @xmath61 reference modes @xmath475 , prepared in coherent states @xmath476 by splitting the initial coherent state of the mode @xmath18 .",
    "then photodetectors @xmath200 determine presence of photons in the modes @xmath145 .",
    "let the state of modes @xmath2 , @xmath15 and @xmath0 before elimination measurements be described by density matrix @xmath202 .",
    "taking into account that coherent states represent a natural basis for describing linear optical transformations , it is convenient to decompose the input density matrix in terms of coherent states of the mode @xmath0 @xmath477 where @xmath478 is an operator - valued function of variable @xmath149 ( acting as an operator on the modes @xmath2 and @xmath15 ) , analogous to glauber function of one - mode field .    the state of the expanded system , composed by the main modes @xmath358 and @xmath15 , the ancillary mode @xmath0 and reference modes @xmath145 , after mixing the ancillary mode @xmath0 with reference modes @xmath145 at beamsplitters is described by the following density matrix :        using eq .",
    "( [ eqn39 ] ) one can represent the density matrix ( [ eqn38 ] ) in the form @xmath482 where latexmath:[$|\\psi(\\gamma_x)\\rangle_{cd_1 ... d_k } = \\hat t_{c d_k } ...",
    "\\hat t_{c d_1 } |\\gamma_x \\rangle_c |\\tilde \\gamma_1 \\rangle_{d_1 }",
    "...     the values of transmittances @xmath151 of the beamsplitters @xmath152 ( eq .  ( [ eqn35 ] ) ) and amplitudes @xmath164 of the reference modes @xmath145 ( eq .  ( [ eqn75 ] ) ) are chosen in such a way , that amplitude of coherent state @xmath139 of the ancillary mode is split in equal parts between the modes @xmath145 , and each of the reference modes effectively undergoes coherent displacement @xmath484 : @xmath485 where @xmath486 is a linear function of the amplitude @xmath149 of the ancillary mode coherent state , equal to @xmath487    measuring presence of photons in the modes @xmath145 by the photodetectors can be described by a set of pairs of projective operators @xmath488 describing absence and presence of photons in corresponding field mode respectively .        where the type of used projector ( `` + '' or `` - '' ) depends on the obtained measurement outcome .",
    "this expression can be simplified using the following relation : @xmath490 where @xmath491 and @xmath492 are the sets of photon numbers , corresponding to the measurement outcomes `` - '' ( absence of photons detected ) and `` + '' ( photocount obtained ) respectively .",
    "introducing superoperator , which describes measurement - invariant part of the ancillary mode state transformation by the definition @xmath493 one can transform eq .",
    "( [ eqn31 ] ) for the density matrix @xmath203 to the form @xmath494      eq .  ( [ eqn33 ] ) describes transformation of the system density matrix by elimination measurements in the form , similar to the one , corresponding to povm measurements .",
    "it should be noted , however , that , the standard normalization condition is satisfied only for complete state transformation by the measuring setup ( including action of superoperator @xmath204 and @xmath61 operators @xmath497 ,  ... , @xmath498 ) rather than for single state elimination .",
    "operators @xmath499 for @xmath500 correspond to the definition eq .",
    "( [ eqn7 ] ) of operators , describing successful elimination of the state @xmath88 : @xmath501 ) , ( [ eqn23 ] ) , we can define operators @xmath502 , eliminating coherent state @xmath503 , as @xmath504 these operators satisfy the conditions , provided by eqs .",
    "( [ eqn7 ] ) , ( [ eqn23 ] ) : @xmath505=0 \\quad \\mbox{for all } n_i,\\,n_j.\\ ] ]        where eqs .",
    "( [ eqn46 ] ) , ( [ eqn58 ] ) were taken into account . for small ancillary field amplitudes",
    "@xmath13 the main contribution to the final state density matrix is made by the term with @xmath509 ( the most probable case of successful elimination of the states @xmath510 corresponds to detection of exactly 1 photon by each of the detectors ) . after discarding mode @xmath0 , the final state of modes @xmath2 and @xmath15 is described by density matrix"
  ],
  "abstract_text": [
    "<S> entanglement represents an important resource for quantum information processing , but its generation itself requires physical resources that are limited . </S>",
    "<S> we propose a scheme for generating a wide class of entangled qudit - type states of optical field modes at sites separated by noisy medium when only weak optical nonlinearities are available at both sites . </S>",
    "<S> the protocol is also based on exploiting a weak probe field , transmitted between the sites and used for generation of quantum correlations between two spatially separated field modes . </S>",
    "<S> the idea of probabilistic entanglement enhancement by measurement is discussed , and corresponding scheme for measuring the probe field state with linear optics and photodetectors not resolving photon numbers is proposed . </S>",
    "<S> it is shown that the protocol is applicable in the case when decoherence , limited efficiency and dark counts of photodetectors , and uncertainty of nonlinear coupling constants are present . </S>"
  ]
}