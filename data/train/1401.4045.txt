{
  "article_text": [
    "quantification ( uq ) is a fast growing sector in interdisciplinary research : its applications span political science @xcite , computational biology@xcite , climate science @xcite , economic and financial processes @xcite , industrial and civil engineering @xcite , as well as many other disciplines . in a broad sense uncertainty quantification is a domain of applied mathematics ; the variety of its applications has promoted a large number of approaches and methods to address the problem .",
    "uncertainty quantification is an issue in scientific computing .",
    "reviews of ongoing research in this field can be found in @xcite ; interested readers can find further information in the bibliography of the cited references .",
    "software systems , such as dakota @xcite , psuade @xcite and similar codes reviewed in @xcite , have been developed to facilitate this task , mainly focusing on methods and algorithms for sensitivity analysis and statistical evaluation of uncertainties .",
    "uncertainty quantification is especially relevant to physics simulation , where the ability to estimate the reliability of simulated results is critical to establish it as a predictive instrument for experimental research .",
    "nevertheless , relatively limited attention has been invested so far into the problem of quantifying the uncertainties of the outcome of monte carlo particle transport in general terms .",
    "investigations of uncertainty quantification in the domain of monte carlo particle transport mainly concern applications to nuclear power systems , such as @xcite .",
    "common experimental practice in other application areas , such as high energy physics experiments , focuses on the validation of specific use cases by direct comparison of simulation results and experimental measurements : representative examples of this practice can be found in @xcite , which concern experiments at the lhc ( large hadron collider ) .",
    "hardly any effort has been invested so far in estimating the predictive capabilities of simulation codes , such as egs5 @xcite , egsnrc @xcite , fluka @xcite , geant4 @xcite , its5 @xcite , mcnp @xcite or penelope @xcite , commonly used in these experiments : this ability would be useful in experimental scenarios where direct validation of simulation use cases would be difficult or not practically feasible , for instance in some space science projects , astroparticle physics experiments and medical physics investigations , as well as in the process of detector design , where the hardware that is simulated may not yet exist .",
    "this paper defines a theoretical foundation for the calculation of the uncertainties affecting simulated observables , which are a consequence of the uncertainties affecting the input to the simulation itself .",
    "this capability is the basis for establishing the predictive reliability of monte carlo transport codes in experimental practice .",
    "the quantification of the uncertainties that affect the results of monte carlo simulation as a consequence of the uncertainties associated with its physical input is a vast and complex problem , which requires extensive scientific research .",
    "this paper is not intended to present an exhaustive solution to the problem , nor to document applications to real - life experimental scenarios simulated with general purpose monte carlo transport codes ; its scope is limited to setting a theoretical ground , which to the best of our knowledge has never been previously documented in the literature , to enable further conceptual and mathematical progress in this field in view of future experimental applications .    a preliminary report of this study is documented in @xcite .",
    "uncertainty quantification in the context of a computational system is the process of identifying , characterizing , and quantifying those factors that could affect the accuracy of the computational results @xcite .",
    "uncertainties can arise from many sources ; the computational model propagates them into uncertainties in the results .",
    "this problem is usually referred to as forward uncertainty quantification . in experimental practice one",
    "encounters also the problem of backward uncertainty quantification , i.e. the assessment of the uncertainties that may be present in a model : this issue is of raising interest for its applicability in robust design , as it concerns the ability of making a rational choice among different conceptual designs that can be drafted .",
    "uncertainties in the results can derive from the conceptual model upon which a computational system is constructed , the formulation of the model in the software and the actual computation process .",
    "possible sources of uncertainties are characterized in @xcite :    1 .   _",
    "parameter uncertainty _ identifies situations where some of the computer code inputs are unknown ; 2 .",
    "_ model inadequacy _ may derive from _ structural uncertainty _ related , for instance , to approximations in the used model , and from _ algorithmic uncertainty _ related to the numerical methods employed to solve the model ; 3 .   _ residual variability _ occurs when the process itself may be inherently unpredictable and stochastic , or the model itself is not fully specified ; 4 .   _",
    "parametric variability _",
    "concerns use cases where some of the inputs are intentionally uncontrolled or unspecified , therefore they contribute a further component of uncertainty to the predicted process .",
    "parameter uncertainty plays a major role in monte carlo simulations of particle transport , since in practice all the physical input to the simulation is affected by uncertainties : the cross sections determining particle interactions either derive from interpolations of experimental measurements , which are affected by uncertainties , or from analytical models , which in turn involve experimental or theoretical uncertainties .",
    "in addition , parameter uncertainties are involved in the model of the experimental set - up : they concern the geometrical dimensions and material composition of the apparatus , and the conditions of its operation , such as electromagnetic fields , pressure and temperature .",
    "algorithmic uncertainty , as defined by @xcite , derives from the numerical methods employed to solve the model : in this acception it is implicit in the monte carlo transport process , which is a statistical determination of some physical quantities ( densities , fluxes , energy deposition etc . ) of experimental interest through sampling methods .",
    "structural uncertainties may be present in the physics models on which the transport is based : for instance , some effects may be neglected a priori in the formulation of the models ( e.g. those deriving from the molecular composition of materials , or their solid structure ) , or the models may involve assumptions that are questionable in some energy range of the transported particles . condensed history methods fall into this category : they are approximate monte carlo methods to deal with physics processes affected by infrared divergence and involving a large number of collisions with very small changes in direction and in energy , which would require a prohibitive investment of computing resources to be treated exactly . moreover , the concept itself of particle transport is an approximation to the real world : monte carlo codes for particle transport are based on the assumption of classical particles moving between localized interaction points , while quantum mechanics is implicit in the determination of the cross sections involved in the process .    whereas these concepts provide guidance in the identification of possible sources of uncertainties , a rigid scheme of classifications",
    "can hardly capture the complexity of the problem domain .",
    "for instance , parameter and structural uncertainties are often intertwined in monte carlo codes for particle transport , as input data often actually embed physics models : theoretical calculations that describe particle interactions with matter are usually tabulated in data libraries , or transformed into look - up tables in the initialization phase of the monte carlo simulation to reduce the computational burden of the simulation .",
    "these data implicitly contain modeling assumptions and approximations ; the associated uncertainties , although treated as parameter uncertainties , may encompass a component of model inadequacy .",
    "the problem domain encompasses correlated and uncorrelated uncertainties . in the context of monte carlo simulation for particle transport , correlated uncertainties",
    "may originate from systematic errors in the physical data required for the simulation , while uncorrelated ones may be associated with statistical errors of input experimental parameters .",
    "mixed and more complex situations may also occur , for instance where experimental data with their associated uncertainties are used in connection to physical models , whose validity is in turn variable .",
    "this paper deals with forward propagation of uncertainties in monte carlo simulation .",
    "the conceptual abstractions involved in the process of uncertainty propagation and their functional relationships are illustrated in fig .",
    "[ fig : over ] .",
    "input parameters of the simulation are affected by uncertainties : conceptually , this situation corresponds to executing simulations with many possible input parameters , which vary compatible with their associated probability distributions , and produce many possible outputs .",
    "the statistical properties of the outcome of the simulations represent the effect of input uncertainties .",
    "the following section elaborates a mathematical foundation for the calculation of uncertainties in observables produced by a monte carlo simulation , which derive from the uncertainties affecting quantities fed into the particle transport process .",
    "the adopted approach aims at a complete determination of the probability distribution function ( pdf ) of the output observable ; in this respect , it differs from other approaches to uncertainty quantification , such as those pursued by dakota , psuade and similar software tools , which focus on the management of large ensembles of calculations used in a statistical evaluation of uncertainty .",
    "although the theoretical foundations and calculation methods developed in this paper are generally applicable to any input parameters , the following discussions are mainly focused on the quantification of the effects of physical uncertainties , and their interplay with the algorithmic uncertainties associated with the monte carlo sampling process .",
    "theoretical investigations are carried out in a simplified calculation environment , which retains the essential conceptual features characterizing the problem domain . the scheme for uncertainty propagation",
    "is initially developed for quantifying the effects on an observable associated with the uncertainties affecting a single parameter .",
    "the conceptual foundation established in the present paper is the basis for further calculations in more complex environments , representing more realistic experimental scenarios , which are intended to follow .",
    "the theoretical elaboration described in section [ sec_theory ] establishes that it is in principle possible to disentangle the effect of parameter uncertainties from algorithmic uncertainties : it is possible to determine a probability distribution of the outcome of the original physical problem deriving from parameter uncertainties alone . by algorithmic uncertainties we mean those related only to the numerical methods employed to solve the underlying transport equations , i.e. from monte carlo sampling , as defined in section [ sec_domain ] .",
    "the effect of monte carlo sampling consists of blurring the distribution resulting from the propagation of parameter uncertainties with some statistical noise .",
    "the next stage of investigation consists of devising a procedure , based on these findings , to calculate in practice the probability distribution of the possible outcomes of an observable within a desired margin of statistical error .",
    "the possibility of performing this calculation by means of a small number of monte carlo simulations is examined in section  [ sec_statcalc ] , while other practical aspects of uncertainty quantification are discussed in section  [ sec_methods ] .",
    "the discussion of the theoretical aspects of the problem is supported by a heuristic investigation , documented in section  [ sec_application ] , which illustrates empirically the process of uncertainty propagation and the conclusions deriving from its mathematical foundation .",
    "in the context of this paper it is assumed that uncertainties affecting the physical input to monte carlo particle transport are known .",
    "their quantitative knowledge is established by evaluation procedures applied to data libraries of experimental origin , such as some components of @xcite , and dedicated validation tests , such as those documented in @xcite",
    ". this assumption does not reflect the real status of general purpose monte carlo codes for particle transport : although some of them have been widely used for decades , the validation of their physics modeling is still in progress , and quantitative assessments of the uncertainties associated with their basic physics parameters are scarcely documented in the literature .",
    "this process is further hindered by the presence of epistemic uncertainties , i.e. intrinsic knowledge gaps @xcite .",
    "the current incomplete quantification of the physical input uncertainties in monte carlo particle transport codes does not hinder the conceptual foundation of the theoretical scheme discussed in this paper .",
    "nevertheless , such knowledge is required for practical applicability of the findings of this paper , i.e. for the calculation of uncertainties affecting output observables .",
    "the subject under study is how the sources of uncertainty in the input to the simulation , wherever they originate , are mathematically mapped to uncertainties in the simulation results .",
    "we show that under some general conditions , which are elucidated in the following , monte carlo simulation transfers the distribution of input data uncertainties into the distribution of the results , preserving the same functional form or with a form derived from it , and adding some statistical fluctuation .      if one runs many monte carlo simulations , each one encompassing @xmath0 events , varying one of the physical parameters involved in particle transport ( identified here with @xmath1 ) in some interval with probability distribution @xmath2 , then the final distribution @xmath3 for the value @xmath4 of any desired observable @xmath5 , which depends on the value of @xmath1 , is expected to be @xmath6 \\sqrt{\\frac{\\displaystyle n}{\\displaystyle 2\\pi\\sigma_{x_0}^2 } } \\nonumber\\end{aligned}\\ ] ] where we finally integrated over the possible values of the physical parameter @xmath1 with their probabilities . here",
    "@xmath4 is a stochastic variable because it represents the sampled statistical mean of the contributions to the requested observable from the @xmath0 events and @xmath7 is its sampled variance .",
    "this result derives from the central limit theorem , if @xmath0 is sufficiently large to make @xmath7 independent from @xmath0 itself .",
    "when writing this equation , we made a further assumption : namely that a function @xmath8 exists , which relates any input value of @xmath1 to a corresponding value for the peak position of the observable means distribution .",
    "this assumption relies on the interpretation of the process of simulation as a surrogate for the solution of the boltzmann transport equation .",
    "the function @xmath8 represents the parametric dependence of the physical solution we produce through the simulation to a variation of the input parameter .",
    "full knowledge of @xmath8 is equivalent to the ability of solving the transport equation .",
    "if this function is invertible - a fact that , as we shall see later in sect.[sec_appl_linear ] , can be established when necessary - we may change the variable of integration from @xmath1 to @xmath9 ; using @xmath10 , we obtain in the limit @xmath11 @xmath12 where we used the identity @xmath13\\nonumber\\end{aligned}\\ ] ] stemming from the exponential representation of dirac @xmath14 function .",
    "if the function @xmath15 is invertible only over subintervals of the variability interval for @xmath1 - that is the same physical solution @xmath9 results from different values of the input parameter @xmath1 - we must slightly modify ( [ eqn : fin ] ) by summing over all the possible solutions of the equation @xmath10 .    equation ( [ eqn : fin ] ) states that we are able to exactly know how the input probability distribution of physical data transfers into the final result , provided we are able to determine the unknown function @xmath16 .",
    "this conclusion is the theoretical foundation for uncertainty quantification .",
    "we derived equation ( [ eqn : fin ] ) in the context of monte carlo simulation ; nevertheless , through the limit @xmath11 the formula has dropped any direct reference to the monte carlo simulation environment and expresses a general property of forward propagation of uncertainty for an arbitrary deterministic problem .",
    "in other environments this expression is known as the markov formula@xcite .",
    "the theory here presented is valid independently from the number of unknowns : the first line of ( [ eqn : fin ] ) holds even if @xmath17 and @xmath18 .      the correctness of the method outlined in section [ sec_theoeq ] can be verified in a scenario where the outcome of a monte carlo calculation is an exactly solvable problem .    as an example , we consider the calculation of the area of a circle ; we assume that the radius of the circle is known with some uncertainty .",
    "the solution @xmath19 is invertible as @xmath20 for @xmath21 ( the only physically acceptable solution ) , where @xmath22 is the area and @xmath23 is the radius .    on the basis of equation ( [ eqn : fin ] ) ,",
    "the expected probability distribution function for the area of a circle with input uncertainty on the measure of its radius is : @xmath24 where @xmath25 is the pdf for the unknown input radius .",
    "if , for example , @xmath25 is a flat distribution with @xmath26 , then @xmath27     for the area of a circle as a function of @xmath22 with randomly chosen radii @xmath28 ( thick black curve ) , together with the empirical distributions ( grey ) coming from 100000 monte carlo estimates of the same area . in ( a ) the monte carlo simulation encompasses 500 samples , in ( b ) 50000 . in ( a ) the standard deviation on @xmath29 at the fixed value @xmath30 is also shown with two dashed lines , width=340 ]    we consider a test case where the radius is uniformly distributed in the interval @xmath28 ( in arbitrary units ) , so that @xmath31 and @xmath32 ( in arbitrary units ) .",
    "the results of the monte carlo calculation of the area are compared with the theoretical prediction of equation ( [ eqn : theopre ] ) of its pdf in fig .",
    "[ fig : metropolis ] : the two histograms correspond to the empirical distribution of the area resulting from 500 and 50000 monte carlo samples respectively , each sample encompassing 100000 estimates , while the thick curve represents the theoretical pdf as in ( [ eqn : theopre ] ) .",
    "the consistency of the pdf of the simulated observable with the theoretical prediction ( @xmath33 ) is qualitatively visible , and appears more evident in the plot resulting from the larger monte carlo sample ; it is quantitatively confirmed with 0.05 significance by a statistical comparison of the results : the p - values are respectively 0.083 and 0.910 for a cramer - von - mises test with a bin width of 0.01 .",
    "the blurring effect deriving from the process of monte carlo calculation is also manifest .",
    "this verification test is also instrumental to highlight an issue , which will be discussed more extensively in section [ sec_application ] : the interplay of different statistical errors in the process of monte carlo sampling .    the upper plot of fig .",
    "[ fig : metropolis ] also shows the standard deviation on @xmath29 at the fixed value @xmath30 with two dashed lines .",
    "this should help the reader to understand that within the process of monte carlo sampling the exact result expressed in equation ( [ eqn : fin ] ) implies the mixing of two different statistical errors : one deriving from the finiteness of the number of events @xmath0 in each mc simulation ( see equation ( [ eqn : start ] ) , and one stemming from the finiteness of the number of monte carlo really run .",
    "the effect of the former is clearly visible on the sides of the empirical distribution , which are exponentially smeared around the exact values @xmath34 and @xmath35 by an amount @xmath36 . the comparison of fig .",
    "[ fig : metropolis](a ) and [ fig : metropolis](b ) makes also visually evident the limiting process in going from ( [ eqn : start ] ) to ( [ eqn : fin ] ) : in ( b ) @xmath37 is reduced by a factor 10 with ( therefore it can not be visually displayed in the plot ) , because we used 100 times more monte carlo samples .",
    "the oscillations of the empirical distribution around its theoretical value within the interval of allowed values @xmath38 are , instead , a consequence of the finiteness of the number @xmath39 of the number of monte carlo simulations really run : their amplitude is ruled by @xmath40 .",
    "the theoretical elaboration in section  [ sec_theoeq ] has reduced the problem of uncertainty quantification from the computationally demanding production of the empirical distribution , requiring a large number of monte carlo simulation runs ( as depicted in fig .  [",
    "fig : over ] ) , to the determination of the parameters fixing the form of the expected theoretical distribution : in this verification test they are @xmath41 , @xmath35 and the exponent of its power form . in this test case",
    "they are all known , since the given problem is analytically solvable ; in a realistic situation these parameters must be determined through the simulation itself . in section  [ sec_appl_pdf ] we will show that it is possible to determine these parameters with an accuracy ruled by @xmath42 through a small number of monte carlo runs . in this example",
    "the observable @xmath9 coincides with the area @xmath22 .",
    "equation ( [ eqn : fin ] ) is fundamental to the purpose of uncertainty quantification , as it relates the functional form of the output pdf @xmath3 to those of @xmath43 , which is a necessary input , and of @xmath44 or @xmath15 .",
    "nevertheless , equation ( [ eqn : fin ] ) is of limited practical usefulness to quantify the uncertainties of observables resulting from monte carlo simulation , since it is equivalent to solving the transport equation : if one were able to do this , one would not need any monte carlo simulation at all .",
    "a remark is here in order : equation ( [ eqn : fin ] ) is an exact relation , even if we derived it starting from ( [ eqn : start ] ) which is valid only for a mc simulation ; knowledge of @xmath15 enables to know the required form of @xmath3 from which any statistical information about the observable @xmath4 can be extracted .",
    "then in principle whichever solver for the transport equation can be used to this purpose , not only mc simulation .",
    "most part of the discussion in this section and in sect.[sec_methods ] can be translated accordingly , by substituting `` statistical accuracy '' with `` numerical accuracy '' and `` mc simulation '' with `` numerical solver for the transport equation '' .    a practical approach to address the problem consists of using the monte carlo",
    "simulation process itself to statistically estimate the unknown function @xmath44 : this is possible , because any single monte carlo run , executed with a fixed value of @xmath1 , gives a statistical estimate of the value of @xmath15 .",
    "uncertainty quantification requires the ability to perform this estimate within some predefined margin of error .",
    "it is worth noting that the task discussed here is not the prediction of the simulated pdf for @xmath4 resulting from a large number of monte carlo simulations , which would be computationally expensive , but only the calculation of the parameters determining the final exact pdf @xmath3 defined in ( [ eqn : fin ] ) .",
    "this task becomes particularly simple when the relation @xmath15 is linear , or can be treated as approximately linear , as it happens for instance in the example we give in the following ( see fig .",
    "[ fig_lin ] ) . in this case equation  ( [ eqn : fin ] ) reduces to @xmath45 which represents the pdf for the observable means as a linear map of the pdf for the unknown input physical parameter .",
    "the two parameters characterizing the linear map can be practically determined with any predefined margin of statistical accuracy by running two monte carlo simulations for two distinct values of the input variable @xmath1 .",
    "while it is unlikely that @xmath15 is linear in general , any function can be approximated by a linear relation in a sufficiently small interval @xcite .",
    "for the practical purpose of reducing equation  ( [ eqn : fin ] ) to the easily manageable form of equation  ( [ eqn : finsimp ] ) , it is sufficient that @xmath15 can be considered linear over an interval relevant to the simulation scenario : over the whole variability interval , if the input distribution is supported on a bound interval , otherwise over some predefined confidence interval",
    ".    the hypothesis of a linear approximation of the functional form of @xmath16 in the experimental scenario under study can be verified by running monte carlo simulations for a few suitably chosen points in the variability interval for @xmath1 . as a minimal requirement for estimating the suitability of a linear approximation one could envisage three simulations , for instance at the two interval extrema and at the mode , while a more powerful test of the hypothesis of linearity could be performed with a larger number of simulation runs .",
    "the same conceptual procedure applies if , instead of a linear relationship , one considers other computationally manageable approximations , for instance a power representation of the form @xmath46    the procedure described above to statistically determine the parameters of the theoretical probability distribution function of an observable is computationally less expensive than determining the probability distribution function of the observable from a large number of monte carlo simulations , each one performed with a different value of the input parameter consistent with its uncertainty .",
    "we illustrate here an application of the method for uncertainty quantification elaborated in the previous sections . the calculation is performed in a streamlined simulation environment , which is identified in the following as `` toy monte carlo '' : although simplified , this computational scenario implements all the essential elements of the conceptual framework of uncertainty quantification illustrated in fig .",
    "[ fig : over1 ] .",
    "this example of application serves also as an environment for heuristic analysis , with the purpose of identifying methods of more general applicability .",
    "the toy monte carlo is a lightweight simulation system , interfaced to the computational environment of mathematica @xcite for further elaboration of its results .",
    "it is an instrument for verification and heuristic investigation of theoretical features of monte carlo particle transport relevant to the problem of uncertainty quantification ; it is not intended to implement physics and experimental modeling functionality for real - life simulation application scenarios .",
    "it consists of a random path generator , which is ruled by two constant parameters , describing the relative probability of absorption ( @xmath47 ) and scattering processes ( @xmath48 ) a transported particle may undergo .",
    "the user is free to modify these parameters .",
    "this simplified situation physically corresponds to the transport of neutral particles through a uniform medium , with energy independent absorption and scattering cross sections , the scattering occurring always in s - wave ( i.e. scattering angles in the center - of - mass frame are sampled from an uniform distribution ) .    within this streamlined simulation context the units in which lengths and macroscopic cross sections are expressed are not relevant ; therefore for simplicity we use arbitrary units for these two quantities , with the only constraint of being one the reciprocal of the other .",
    "the experimental configuration consists of an isotropic primary particle source located at the origin of a sphere of uniform material .",
    "the radius of the sphere is 5 in arbitrary units .    in the application example",
    "considered here we focus on the track length as an observable ( @xmath49 in the following ) of interest in the simulation ; nevertheless the issues discussed in the following are not specific to this observable , rather they highlight general features of the process of estimating the uncertainty associated with a result produced by the simulation . the observable",
    "is scored in two sensitive volumes , consisting of a cube of side 0.2 in arbitrary units : one with center located in ( 0.1,0.1,0.1 ) , and one centered in ( 0.7,0.7,0.7 ) .",
    "the execution of the monte carlo simulation contributes to the result through the statistical sampling process .",
    "if the physical parameters @xmath47 and @xmath48 are affected by uncertainties , we expect the simulation outcome to be sensitive to the effects of parameter uncertainties mixed with algorithmic uncertainties .",
    "we stress that this toy monte carlo is only used to verify and to exemplify results that have been derived on a theoretical ground in section [ sec_theory ] : its use does not constitute a limitation to the validity of the theoretical assessments established in this paper , rather it represents an auxiliary tool to our investigation .",
    ", each encompassing @xmath50 events , for an observable scored close to the primary particle source ( see text ) , produced with different values of the @xmath48 input physical parameter : @xmath51 ( white histogram ) , @xmath52 ( grey histogram ) and @xmath53 ( black histogram).,width=336 ]    , each encompassing @xmath50 events , for an observable scored far away from the primary particle source ( see text ) , produced with different values of the @xmath48 input physical parameter : @xmath51 ( white histogram ) , @xmath52 ( grey histogram ) and @xmath53 ( black histogram ) .",
    ", width=336 ]    the events generated in the course of a monte carlo simulation contribute to determine observables of experimental interest .",
    "each particle trajectory encompassed in an event is the result of a sequence of random interactions sampled from some statistics ; the observable score from single events itself is a stochastic variable with some unknown distribution .",
    "the outcome of the monte carlo simulation is the mean of the contributions from single events .",
    "nevertheless , we can not directly determine the mean , the variance , the standard deviation or any other properties of the distribution of the observable exactly , because we do not know the distribution itself : we can only estimate these quantities from the statistical sample . as a consequence ,",
    "the observable mean estimate itself is a stochastic variable .    as a first example",
    ", we illustrate the effect of algorithmic uncertainties , i.e. of uncertainties purely due to the monte carlo sampling process .",
    "we consider three physical scenarios , where @xmath48 assumes the values 1.0 ,  1.1 and 1.2 respectively ( in arbitrary units ) , while @xmath47 is fixed and has value  0.1 ( in arbitrary units ) . in this use case",
    "the physical parameters @xmath48 and @xmath47 are assumed to be exempt from uncertainties .",
    "for each physical scenario we execute 1000 monte carlo runs , each one encompassing @xmath50 events corresponding to the transport of a single primary particle .",
    "the resulting distributions of the observable , corresponding to the three different values of @xmath48 assumed in the simulation , are plotted in fig .",
    "[ fig_1 ] and fig .",
    "[ fig_1a ] for the sensitive volume at closer and larger distance from the source mentioned in section [ toymc ] , respectively . for graphical reasons here and in the following",
    "we make use of the unusual notation @xmath54 , even if the observable scored is in arbitrary units : this notation has the purpose to indicate that the same units ( even if arbitrary ) have been used in all the plots ; the indicated multiplier means that in fig .",
    "[ fig_1 ] the @xmath4-scale starts from @xmath55 while in fig .",
    "[ fig_1a ] starts from @xmath56 .",
    "if the number of generated events is sufficiently large , the central limit theorem ensures that , whatever is the unknown observable distribution , the distribution of the observable mean estimates produced by running many monte carlo simulations is approximately gaussian , with standard deviation @xmath57    the two experimental configurations , characterized by different distances between the source and the detector , give rise to different statistical errors , because a larger number of events contribute to the observable score , if the sensitive volume is closer to the source .      within the context of the toy monte carlo",
    ", we consider a scenario where one of the input parameters is affected by uncertainties : its value may vary over some interval with some probability distribution . for simplicity we assume it to be a uniform distribution , which is corresponds to the typical scenario of an epistemic uncertainty .    in this application example @xmath48 is sampled from a flat distribution in the interval @xmath58 .",
    "we perform @xmath59 monte carlo simulation runs , each one with a different value of @xmath48 ; each simulation encompasses a predefined number @xmath0 of events . as described in section [ toymc ] , the track length observable is scored in two volumes at different distances from the primary particle source .",
    "[ fig_22a ] shows the distribution of the estimated observable means close to the source resulting from the simulation ; the four histograms correspond to different number @xmath0 of events in each simulation run . for a relatively small number of generated events , illustrated in the top row of histograms in fig .",
    "[ fig_22a ] , the distribution of the observable mean estimates resembles a gaussian distribution . by increasing the number of generated events from fig .",
    "[ fig_22a](a ) to fig .",
    "[ fig_22a](b ) , the width of the distribution decreases ( roughly with @xmath60 ) . for larger values of @xmath0",
    "the width stabilizes to a constant value and the histogram no longer resembles a gaussian distribution : eventually it appears consistent with a flat distribution .",
    "[ fig_33 ] , corresponding to the observable scored at larger distance from the primary particle source , exhibits the same qualitative behavior , although the process of approaching a final stable distribution appears slower in this case .",
    "this is a consequence , as noted in section  [ sec_appl_algorithmic ] , of the larger statistical error associated with sensitive volumes far from the source .",
    "this example shows qualitatively that , apart from some additional statistical noise , the distribution of observables resulting from the monte carlo simulation process retains a functional form that is related to the input distribution of the uncertainties of the parameters on which they depend .",
    "these empirical observations are consistent with the theoretical foundations discussed in section [ sec_theory ] .",
    "equation ( [ eqn : fin ] ) indicates that the task of uncertainty quantification is reduced to the determination of the output pdf @xmath3 . from this distribution",
    "one can extract all the necessary information to quantify the knowledge of the output physical variable @xmath4 produced by the simulation , such as the desired confidence intervals . in the following",
    "we show how one can determine the characteristics of the pdf of the simulated observable with predefined accuracy in the simple application scenario introduced in section [ sec_appl_cross ] . to do this we examine the properties of the distribution from which simulation results are actually sampled - eq .",
    "( [ eqn : start ] ) - that we indicate here as @xmath61 , to distinguish it from the exact result @xmath3 .    in the case of a flat distribution of the input parameter @xmath62 over an interval @xmath63 ,",
    "the integral in equation ( [ eqn : start ] ) can be evaluated analytically even for finite @xmath0 , if we assume that @xmath64 is independent from @xmath48 and that @xmath65 is linear .",
    "the first assumption is justified , if one considers results at the lowest order in @xmath66 @xcite ; we recall that @xmath67 is the standard deviation of the required observable ( not the one of its mean ) , as it results from the simulation .",
    "the second assumption is discussed in detail in section  [ sec_appl_linear ] . under these two conditions the empirical distribution coming from the monte carlo simulation resulting from ( [ eqn :",
    "start ] ) is : @xmath68\\nonumber\\end{aligned}\\ ] ] being @xmath69dt\\,;\\ ] ] or @xmath70 \\",
    ", \\label{eqn : emp}\\end{aligned}\\ ] ] in equation ( [ eqn : emp ] ) @xmath71 are the extrema of the range of variability of the observable mean , or @xmath72 and @xmath73 .    the behavior of @xmath61 is illlustrated in fig .",
    "[ fig_errfun ] for different values of @xmath74 : one can observe that the larger the value of simulated events @xmath0 , the more closely the curve resembles a flat distribution , which reflects the flat distribution of the input parameter .",
    "[ fig_errfun ] shows that the behavior of the empirical pdf is directly ruled by the sole parameter @xmath74 .",
    "the behavior of the analytically calculated @xmath61 appears consistent with the outcome observed in the toy monte carlo .",
    "the key point to note is that @xmath61 from equation   ( [ eqn : emp ] ) is the distribution from which observable means are actually sampled : by running many monte carlo simulations one can obtain a statistical sample from it , as is illustrated in figs .",
    "[ fig_22a ] and [ fig_33 ] .",
    "the histograms in these figures , which derive from the execution of a finite number of monte carlo simulations , are approximations of analytical curves as shown in fig .",
    "[ fig_errfun ] .",
    "the form they assume derives from the interplay between two different statistical errors : the one coming from each monte carlo run ( @xmath74 ) and the one coming from the finiteness of the number of monte carlo runs , as noted earlier in section[sect : verify ] .     for different values of @xmath74 :",
    "dotted line , @xmath76 dashed line and @xmath77 solid line.,width=336 ]          in some experimental scenarios knowledge of the range of variability of the simulation outcome , rather than complete quantification of the uncertainty of the observable mean , would be sufficient .",
    "this range of variability can be considered as the epistemic uncertainty of the observable produced by the simulation ; for such a concept to be meaningful in a context of uncertainty quantification , one should be able to estimate a priori the statistical indetermination by which it is affected . in the application scenario considered here this requirement corresponds to knowing the statistical indetermination of extrema of the interval @xmath78 $ ] .    for this purpose",
    "we observe that for any fixed value of @xmath79 and @xmath80 , a value @xmath81 exists , such that @xmath82 in particular , @xmath83 . in this interval",
    "the error function differs from @xmath84 more than @xmath85 .",
    "the value of @xmath0 , i.e. the number of generated events , fixes the statistical indetermination on the evaluation of the true epistemic uncertainty @xmath78 $ ] of the simulated observable .",
    "one can choose @xmath0 such that the intervals in @xmath4 over which both error functions in ( [ eqn : emp ] ) differ from @xmath84 by a predetermined amount are as small as requested : to reduce @xmath14 one must increase @xmath0 . in practical terms , this means that the interval of variability of the observable can be determined with any predefined statistical accuracy by two monte carlo runs , corresponding to the values @xmath86 and @xmath87 of the input parameter , encompassing an adequate number of events @xmath0 .    from the previous discussion",
    "one can evince that for @xmath88 to represent an adequate approximation of a flat distribution the condition @xmath89 should be satisfied .",
    "this condition relates the scale of @xmath90 ( that is the accuracy of a single monte carlo run ) and the range of variability of the observable mean .      in the previous discussion",
    "we have assumed a linear relationship @xmath91 between the peak position of the observable means distribution and the input parameter .",
    "this assumption can be verified by running a few monte carlo simulations for some values of the input parameters within its range of variability .",
    "the results of performing this procedure in the context of our toy monte carlo are illustrated in fig .",
    "[ fig_lin ] .",
    "each plot shows the outcome of the simulation for 21 equidistant fixed values of @xmath48 in the range of variability @xmath92 together with their @xmath93 confidence intervals .",
    "we display @xmath93 intervals instead of conventional @xmath94 intervals for better visibility in the plots .",
    "the four plots correspond to different positions of the detector with respect to the primary particle source , with center located at 0.1 , 0.5 , 0.9 and 1.3 arbitrary units from the source .",
    "the number of events generated in each simulation is @xmath95 .",
    "the result of a linear fit to the simulated data is superimposed to the plots .",
    "a linear relation @xmath91 qualitatively appears a justified approximation , although the statistical degradation of the quality of a linear fit is clearly visible , when the observable is scored at larger distance from the source .",
    "it is quantitatively supported by the p - values of the linear fit : 0.995 , 0.993 , 0.997 and 0.985 respectively , for increasing distance from the source . at increasing distances of the detector from the source a larger number of events",
    "can be generated , if necessary , to reduce the size of the confidence intervals for the parameters of the fit : in practical cases a detailed statistical analysis is recommended , since the knowledge of the expected pdf @xmath3 is affected by the uncertainties in the best - fit parameters for the relation @xmath91 .",
    "this method can be used more generally to investigate possible approximations of the @xmath91 functional relationship .",
    "the resulting fitted function @xmath15 can be inserted directly in equation ( [ eqn : fin ] ) to obtain the output pdf .",
    "the theoretical findings of section [ sec_theory ] and the heuristic investigation of section [ sec_application ] in a simple application environment support the definition of a path for the calculation of the uncertainties of simulation observables in a generic scenario .",
    "we summarize it here from the practical perspective of a monte carlo simulation user .",
    "this procedure assumes that the uncertainties of input parameters are known .",
    "equation ( [ eqn : fin ] ) states that the form of the output pdf is assured by theory . as a consequence",
    ", the process of uncertainty quantification is reduced to determining the parameters required for its calculation : this problem in turn consists of determining the unknown function @xmath15 , which represents the response of the observable means to the variation of the input parameter , or its inverse @xmath44 .    from a monte carlo user perspective",
    ", the process involves the investigation of two properties of the output .",
    "the first concerns the extrema of the output variability interval for the observable means , that is the maximum output uncertainty .",
    "these extrema can be found with an arbitrary predefined precision with two monte carlo runs , the first using as input @xmath96 , the second using as input @xmath97 .",
    "we stress that this is not a full quantification of the uncertainty , if nothing is known about the relation @xmath15 ; these two values , together with the statistical uncertainties on their determination , define an interval of variability for the output , not its probability distribution inside this interval .",
    "a remark is here necessary , regarding the possibility of an input pdf not supported on a bounded interval - this is the case for instance of a normal distribution which is supported on @xmath98 : we suggest in this case to first identify an interval of interest for the input , for instance associated with a given confidence interval for the input , and to proceed on with the analysis . in this case",
    "one will not obtain the output pdf , but the output pdf conditioned to the probability of the input to be in this interval .",
    "approximate knowledge of the function @xmath15 can be achieved through statistical investigation , by performing a number of monte carlo simulations , involving different values of the input over its variability interval ( or over the chosen confidence interval for the input unknown ) , to devise a suitable functional approximation .",
    "how to select these simulation configurations is a problem - dependent task ; in the absence of any specific indications , a proper starting choice could be a set of equidistant points , but an adaptive procedure could be useful or necessary , especially if @xmath15 is not linear or if the input pdf is not flat .",
    "this process profits from knowing a priori that condition ( [ eqn : cond ] ) must be fulfilled , as was elucidated in the discussion of the application example in section [ sec_appl_ab ] .    from this procedure one can estimate quantitatively confidence intervals for the value of the output observable @xmath4 .",
    "the computational resources needed for this investigation depend on the required accuracy of the estimate , but they are significantly lower than the computational investment needed to obtain directly an empirical approximation to @xmath3 : the above outlined procedure involves a limited number of simulation runs , while direct evaluation of the uncertainty of an observable according to the procedure depicted in fig .",
    "[ fig : over ] requires executing a larger number @xmath99 of simulations to produce a distribution of observable means with adequate statistical precision . to give an example , we used @xmath100 to obtain fig .",
    "[ fig_22a ] and [ fig_33 ] .",
    "we have shown that , under wide and verifiable conditions , the process of monte carlo simulation transfers the input probability distribution function ( pdf ) of the physical data on which the simulation depends into a predictable pdf of the observable means , which are the outcome of the simulation .    often , due to the narrowness of the variability interval involved , the same functional form of the pdf may apply both to input and output uncertainties , by means of a simple linear mapping , whose parameters can be deduced with predetermined accuracy by running a small number of monte carlo simulations .",
    "the process of uncertainty quantification is intertwined with the mathematical method used to solve the problem that relates the input to the output : in monte carlo particle transport uncertainty quantification is blurred by the stochastic process of sampling , which is involved in transferring input uncertainties into the output .    the procedure for uncertainty quantification here presented applies easily when one , or a small number of , physical parameters are involved , and if they can be independently analyzed : in experimental practice this scenario applies to simulations where a few physics features play a dominant role in determining the key observables subject to investigation .",
    "the present approach is hardly practicable when many input physical data can vary simultaneously .",
    "methods to extend it to a multidimensional case , also taking into account that some variations may not be considered independent , are currently being developed and will be documented in forthcoming publications : the present paper provides the essential theoretical reference for extensions to more complex physical scenarios and mathematical calculations .",
    "the authors thank the infn computing and networking committee ( ccr ) for supporting this research .",
    "l. p. swiler , t. l. paez , and r. l. mayes , `` epistemic uncertainty quantification tutorial '' , in _ proc .",
    "imac - xxvii , conf . and exposition on structural dynamics _ , soc .",
    "structural mech . ,",
    "orlando , paper 294 , 2009 .",
    "b. m. adams et al .",
    ", `` dakota , a multilevel parallel object - oriented framework for design optimization , parameter estimation , uncertainty quantification , and sensitivity analysis '' , version 5.2 theory manual , sandia report sand2011 - 9106 , albuquerque , 2011 .",
    "m. n. avramova and k. n. ivanov , `` verification , validation and uncertainty quantification in multi - physics modeling for nuclear reactor design and safety analysis '' , _ progr .",
    "nucl . energy _ , vol .",
    "52 , no . 7 , pp .",
    "601 - 614 , 2010 .",
    "m. sternat , w. s. charlton and t. f. nichols , `` monte - carlo burnup calculation uncertainty quantification and propagation determination '' , in _ proc .",
    "comp . meth .",
    "sci . and eng .",
    "( m&c 2011 ) _ , on cd - rom , american nuclear society ( ans ) , 2011 .",
    "c. j. diez , j. j. herrero , o. cabellos , and j. s. martinez , `` propagation of cross - section uncertainties in criticality calculations in the framework of uam - phase i using mcnpx-2.7e and scale-6.1 '' , _ sci .",
    "nucl . installations _ , vol .",
    "2013 , pp . 380284 , 2013 .",
    "i. kawrakow , e. mainegra - hing , d. w. o. rogers , f. tessier and b. r. b. walters ,  the egsnrc code system : monte carlo simulation of electron and photon transport \" , nrcc pirs-701 report , 5th printing , 2010 .",
    "j.  baro , j.  sempau , j. m.  fernndez - varea , and f.  salvat , `` penelope , an algorithm for monte carlo simulation of the penetration and energy loss of electrons and positrons in matter '' , _ nucl .",
    "b _ , vol . 100 , no",
    "31 - 46 , 1995 .",
    "m. b. chadwick et al .",
    ", `` endf / b - vii.1 nuclear data for science and technology : cross sections , covariances , fission product yields and decay data '' , _ nucl . data",
    "sheets _ , vol .",
    "112 , no . 12 , pp . 2887 - 3152 , 2011 .",
    "s. guatelli , a. mantero , b. mascialino , p. nieminen , m. g. pia , and v. zampichelli , `` validation of geant4 atomic relaxation against the nist physical reference data '' , _ ieee trans .",
    "594 - 603 , 2007 .",
    "m. g. pia , m. begalli , a. lechner , l. quintieri , and p. saracco , `` physics - related epistemic uncertainties of proton depth dose simulation '' , _ ieee trans .",
    "2805 - 2830 , 2010 ."
  ],
  "abstract_text": [
    "<S> we introduce a theoretical framework for the calculation of uncertainties affecting observables produced by monte carlo particle transport , which derive from uncertainties in physical parameters input into simulation . </S>",
    "<S> the theoretical developments are complemented by a heuristic application , which illustrates the method of calculation in a streamlined simulation environment .    </S>",
    "<S> monte carlo , simulation , uncertainty quantification </S>"
  ]
}