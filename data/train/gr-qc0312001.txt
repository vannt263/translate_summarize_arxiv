{
  "article_text": [
    "the construction of an accurate and stable numerical implementation of einstein equations in settings such as three dimensional binary black hole collisions represents a major challenge . indeed , although significant progress has been achieved in the last few years ( see  @xcite and references therein ) , the goal remains elusive . in practice ,",
    "numerical or continuum instabilities often arise , rendering particular simulations of little use after some time , or at high enough resolutions . due to the complicated set of equations one is dealing with , coupled to the often scarce computational resources , tracking down the source of problems",
    "is usually difficult . faced with this situation , a possible strategy is to make use of techniques that systematically control different aspects of the problem under consideration .",
    "one possibility for such a strategy can be achieved by proceeding along the following lines :    first , as has been emphasized in a number of works @xcite , by choosing a well posed initial - boundary value problem ( ibvp ) , which is a necessary condition for a numerically stable implementation ( see , for example , @xcite ) .",
    "a symmetric hyperbolic system with maximally dissipative boundary conditions is an example of a system that defines such a well posed problem .",
    "furthermore , the boundary conditions should not only define a well posed initial value problem but also must conform to the physical situation in mind .",
    "for instance , they should preserve the constraints and have minimal spurious influence on the solution .",
    "second , by translating the previous analytically - framed considerations into the numerical arena .",
    "that is , by constructing a numerically stable scheme for the ibvp under consideration .",
    "one way of doing so is by constructing difference operators and imposing the discrete boundary conditions in a way such that the steps followed at the continuum to show well posedness can be reproduced at the discrete level @xcite .",
    "third , by implementing the equations so that spurious growth in time of the solution is removed or minimized .",
    "a numerically stable implementation need not free the simulation from errors that at fixed resolution grow fast in time ( although at fixed time they would go away with resolution ) .",
    "there are a number of possible alternatives for this effect to be minimized .",
    "one option is to achieve semi - discrete or discrete _ strict stability _ , i.e. given a sharp energy estimate at the continuum , to discretize in a way such that the estimate also holds at the semi - discrete or discrete levels @xcite . in this way , growth in the numerical solution that is not called for by the continuum system is ruled out . in this strategy",
    "one must count with a sharp energy estimate for the problem at hand , such as those of @xcite .",
    "an alternative and/or complementary way is to consider the addition of a small amount of artificial dissipation ( in a way that does not spoil the available discrete energy estimates and numerical stability ) .",
    "sometimes this is enough to partially or completely rule out errors growing fast in time , and in addition it helps to control high frequency modes .",
    "there are other cases , in which a sharp estimate is not available , and for which the addition of some artificial dissipation does not rule out undesired growth in the solution either .",
    "this happens quite often in evolutions of einstein s equations in the strong field regime .",
    "one possibility in such a case is to realize that even though a sharp energy estimate for the main evolution system might not be available , an ideal one for the subsidiary system that describes how the constraints propagate is trivially obtained @xcite .",
    "namely , at the continuum one would like the constraints when perturbed to ( for example ) remain constant as a function of time , or decay to zero @xcite .",
    "similarly , at the discrete level one may want constraint violations to remain close to their initial , discretization value . once some desired estimate for the constraints is chosen , one can enforce it in a number of ways .",
    "one of them is to dynamically redefine the equations during evolution off of the constraints surface @xcite .    in this paper we present results obtained with a fully non - linear code that evolves einstein s equations in a three - dimensional setting , analyzing implementations of techniques that ensure some of the desired properties",
    "just discussed .",
    "the particular formulation of the equations that we use is a symmetric hyperbolic one with a dynamical gauge condition ( more precisely , a slight generalization of the bona - masso slicing conditions ) presented in ref .",
    "@xcite , and summarized in section [ formulation ] . in section [ minimization ] details on how free constraint - functions in the formulation can be dynamically adjusted to ensure minimal growth of some energy , or norm , associated with constraints , is discussed in the context of the symmetric hyperbolic formulation here used .",
    "section [ preliminar ] briefly summarizes the numerical techniques used in this paper , already presented in ref .",
    "@xcite , and the details of the test - beds here studied .",
    "one of these test - beds is the study of a periodic gauge wave , presented in section [ gauge_wave ] .",
    "there we show that the use of a symmetric hyperbolic formulation and a small amount of artificial dissipation suffices to evolve this solution with rather large amplitudes and for long times .",
    "the other test - bed that we study is a non - spinning , stationary black hole with excision of the singularity and dynamic minimization of the constraints growth .",
    "a detailed analysis is presented in section [ bh ] , discussing several issues relevant to the constraint minimization technique and the results of fully three - dimensional simulations whose lifetime is considerably extended by making use of this technique .",
    "section [ final ] summarizes and discusses the main lessons of this work and points out possible extensions of it .",
    "in this paper we use the symmetric hyperbolic formulation of the einstein equations admitting a dynamical lapse introduced in  @xcite .",
    "this system has thirty - four variables , including : the three metric , @xmath0 , the extrinsic curvature , @xmath1 , and the lapse , @xmath2 .",
    "further , variables @xmath3 and @xmath4 are constructed from the spatial derivatives of @xmath0 and @xmath2 , respectively , and introduced as independent variables to make the system first order in space . when all constraints are satisfied these variables satisfy @xmath5 and @xmath6 .",
    "the evolution equations in this formulation are : @xmath7 where we define @xmath8 .",
    "the ricci tensor in eq .",
    "( [ kdot ] ) is written as @xmath9 where @xmath10 , @xmath11 , and @xmath12 finally , the second order derivatives of @xmath2 that appear in eq .",
    "( [ kdot ] ) are calculated as @xmath13    the slicing condition , eq .",
    "( [ ndot ] ) , contains two functions , @xmath14 and @xmath15 .",
    "the function @xmath16 may be any function of the lapse , the trace of the extrinsic curvature , @xmath17 , and the spacetime coordinates , with the condition that @xmath18 .",
    "the function @xmath19 is a gauge source function , and is specified _ a priori _ but in an arbitrary way as a function only of the spacetime coordinates .",
    "this slicing is a generalization of the bona ",
    "masso slicing conditions , obtained by setting @xmath20 and @xmath21 .",
    "moreover , choosing @xmath22 and @xmath23 gives the harmonic time slicing condition , or a generalized harmonic condition if @xmath24 .",
    "the time harmonic slicing condition , or its generalized form , is the choice used for all runs in this paper .",
    "finally , the shift , @xmath25 , must also be specified _ a priori _ as an arbitrary function of spacetime .",
    "the einstein equations are a constrained system , and the evolution equations here considered are not only subject to the physical constraints , the hamiltonian and momentum ones , but also non - physical constraints that come from introducing first - order variables .",
    "the hamiltonian constraint is @xmath26 where @xmath27 and the ricci tensor given by eq  ( [ eq : ricci ] ) .",
    "the momentum constraints , @xmath28 , are @xmath29 finally , the non - physical constraints , @xmath30 and @xmath31 , are defined as @xmath32ij}.\\end{aligned}\\ ] ]    the einstein equations resulting from the 3 + 1 adm decomposition are only weakly hyperbolic . however , it is possible to manipulate the principal part of the equations by adding the constraints in specific combinations to the evolution equations in order to obtain a strongly or symmetric hyperbolic system of equations @xcite . in the system here",
    "considered , the constraints are added to the rhs of eqs .",
    "( [ gdot][adot ] ) , and the spacetime constraint - functions @xmath33 are introduced as multiplicative factors to the constraints . requiring the evolution system to be symmetric hyperbolic",
    "imposes algebraic conditions on these factors , as discussed below , and they are not treated as completely independent . typically these factors are taken to be constant _ parameters _ , however this restriction is actually not needed for strong or symmetric hyperbolicity of the system to hold .",
    "moreover , we wish to exploit some freedom in choosing these constraint - functions to minimize the effect of constraint violating modes that may appear in the solution  @xcite . thus , we choose the factors to be functions of time but constant in space ( future work will concentrate in allowing for space dependence ) : @xmath34 . therefore , here we will refer to these factors as _ constraint - functions _ rather than _",
    "parameters_.    the characteristic speeds of the system are @xmath35 , @xmath36 , @xmath37 , with @xmath38 and @xmath39 .",
    "there are two strongly hyperbolic multiple constraint - function families with @xmath40 and @xmath41 , which correspond to propagation speeds along the light cone and the hypersurface normal .",
    "one such family has three free constraint - functions @xmath42 : @xmath43 a second family has only two free constraint - functions @xmath44 : @xmath45    in this paper we set @xmath46 to simplify the calculation of the characteristic variables needed to impose maximally dissipative boundary conditions .",
    "this gives a symmetric hyperbolic system with one free constraint - function @xmath47 @xmath48 and another symmetric system with two varying constraint - functions @xmath49 : @xmath50 one can show that these families not only are strongly hyperbolic as shown in  @xcite but , as mentioned above , also symmetric hyperbolic  @xcite .",
    "the formulation of the einstein equations summarized in the previous section is made symmetric hyperbolic by adding constraints to the evolution equations multiplied by the time - dependent constraint - functions . requiring that the propagation speeds",
    "be along the light cones or @xmath51constant hypersurfaces normal , and a further simplification obtained by setting @xmath52 , results in two families of equations .",
    "the first has a single free constraint - function , @xmath53 , and the second has two constraint - functions , @xmath54 .",
    "several papers have been presented showing that the long - term stability of 3d numerical simulations is extremely sensitive to these constraint - functions , even if symmetric hyperbolicity is guaranteed independently of the values these constraint - functions take @xcite . recently , in  @xcite a method to dynamically choose these constraint - functions by minimizing the constraint growth during the evolution has been presented .",
    "we here include a brief summary of this method , and discuss its particular application to the black hole runs presented later in this paper .",
    "consider a system of hyperbolic equations with constraint terms , @xmath55 , written schematically @xmath56 where @xmath57 , @xmath58 and @xmath55 are vector valued functions , and @xmath59 is a matrix ( generally not square ) that is a function of the spacetime .",
    "( note that in this section @xmath55 represents a vector function of general constraint variables , and not specifically the momentum constraint introduced in the previous section . ) here the indices @xmath60 range over the size of each vector or matrix function , while the indices @xmath61 will label points on a discrete grid .",
    "we then define an _ energy _ or _ norm _ of the discrete constraint variables , e.g. , @xmath62 where @xmath63 are the number of points in the @xmath64 directions , and where we have omitted the grid indices @xmath61 to simplify the notation .",
    "the time derivative of the norm can be calculated using eq .",
    "( [ linearc ] ) @xmath65 and therefore can be known in closed form provided the matrix valued sums @xmath66",
    "\\times   \\nonumber \\\\ & &   \\left[\\sum_c(a^cd_cu_b ) + b_b\\right ]   \\label{split1 }   \\\\ { \\cal i}^{\\mu}_{bc } & = &   \\sum_{ijk } \\sum_{a }       \\frac{c_a}{n_xn_yn_z } \\times   \\nonumber \\\\ & & \\left[\\frac{\\partial c_a } { \\partial u_b}+     \\sum_k\\frac{\\partial c_a}{\\partial d_k u_b}d_k \\right]c_c \\label{split2}\\end{aligned}\\ ] ] are computed during evolution ; where @xmath67 is the discrete derivative approximation to @xmath68 .",
    "we then use the dependence of the energy growth on the free constraint - functions to achieve some desired behavior for the constraints , i.e. , solving eq .",
    "( [ split ] ) for @xmath59 . for example , if we choose does not denote an index , as before .",
    "similarly , the subscript in @xmath69 indicates that the quantity is related to @xmath70 through eq.([a ] ) . ]",
    "@xmath71 any violation of the constraints will decay exponentially @xmath72 as discussed in  @xcite , one good option among many others seems to be choosing a tolerance @xmath73 value for the norm of the constraints that is close to its initial , discretization value , and solving for @xmath59 such that the constraints decay to this tolerance value after a given relaxation time .",
    "this can be done by adopting an @xmath70 such that after time @xmath74 the constraints have the value @xmath73 .",
    "replacing @xmath75 by @xmath73 in equation ( [ decay ] ) and solving for @xmath70 gives @xmath76 if one then solves @xmath77 for @xmath78 , with @xmath70 given by eq.([a ] ) , the value of the norm @xmath79 should be @xmath73 , independent of its initial value .    in principle ,",
    "eq.([eq_for_mu ] ) has non - unique solutions , since the equation is scalar and @xmath59 is a matrix . as discussed in section",
    "[ runs ] , this non - uniqueness is sometimes crucial for making this a practical method for controlling growth in the constraints .",
    "we also note that the technique discussed in this section can be implemented without affecting symmetric hyperbolicity  @xcite .",
    "finally , we now describe how @xmath80 is calculated for the symmetric hyperbolic families of the einstein equations used in this paper .",
    "the time derivative of the energy for the constraints is @xmath81 for the single - function family , eq .",
    "( [ monoparametric ] ) , @xmath82 that is , @xmath83 with @xmath84    the evaluation of @xmath80 as a function of @xmath53 is a two - step process . in order to compute the quantities @xmath85 and @xmath86 , so as to obtain the dependence of the time derivative of the energy in terms of @xmath53 , eq.([edot_mono ] ) , _ two _ evaluations of @xmath87 are required to extract the individual contributions .",
    "for example , the homogeneous term is obtained performing a set of evaluations with @xmath88 , @xmath89 once this term is known , @xmath90 is obtained doing a set of evaluations with an arbitrary but non - vanishing @xmath91 , @xmath92 this involves at each step an evaluation of the right hand side of the evolution equations and of the spatial derivatives of such right hand side , and evaluation of the derivatives of the constraints with respect to the main variables and with respect to their spatial derivatives ( all of this at each grid point ) the constraints , and therefore their derivatives , do not depend on the constraint - functions . therefore they need to be computed only once at any given time .",
    "similarly for the two - function family ( [ biparametric ] ) : the time derivative of the norm of the constraints is @xmath93 with [ c.f .",
    "( [ biparametric ] ) ] @xmath94 and @xmath95    at any given time , four sets of evaluations are needed to numerically compute the quantities @xmath96 in eq .",
    "( [ edot_bi ] ) . for example , as in the single constraint - function case , the homogeneous term is obtained through a set of evaluations with @xmath97 , @xmath98 once this is known , @xmath99 is obtained doing a set of evaluations with an arbitrary but non - vanishing @xmath100 , and @xmath101 , @xmath102 two more sets of evaluations are needed in order to construct @xmath103 and @xmath104 : given @xmath105 and @xmath106 arbitrary but different , @xmath107 , it is straightforward to see that @xmath108 \\label{edot_chi}\\end{aligned}\\ ] ]    the quantities @xmath109 , @xmath86 , @xmath110 thus obtained are independent of what values @xmath111 are used in eqs .",
    "( [ edot_eta],[edot_gamma ] , [ edot_chi ] ) .",
    "we make use of this fact to perform a non - trivial test of self - consistency in our simulations .",
    "namely , during evolution we construct these quantities @xmath109 , @xmath86 , @xmath110 using , at each time step , several different values of @xmath111 , and we check that the result is , indeed , independent of that choice .",
    "we proceed in a similar way with the single - constraint - function family .",
    "in this section we introduce the numerical methods that we use , and then outline two physical problems , the gauge wave and a schwarzschild black hole , that we will analyze in this paper .",
    "these spacetimes will be used in our numerical implementation of einstein equations written in the first order form detailed in section ii equations ( [ gdot ] ) through ( [ adot]).      we use numerical techniques based on the energy method for hyperbolic equations  @xcite .",
    "this method allows one to identify numerically stable discretizations by construction for initial - boundary value problems for linear , symmetric hyperbolic systems . while we focus here on nonlinear einstein equations",
    ", we note that some numerical instabilities in the einstein system are also observed in the linear regime .",
    "methods that are known to be numerically stable for the linearized einstein equations thus function both as a foundation and guide for moving to the nonlinear problem .",
    "our numerical scheme uses second order spatial difference operators that satisfy summation by parts , as well as an extension of the standard kreiss ",
    "oliger dissipation operator that takes into account the presence of ( inner and outer ) boundaries .",
    "this operator , which we call @xmath112 , is added to the right - hand side of the evolution equations , @xmath113 , with a free ( non negative ) multiplicative parameter @xmath114 .",
    "paper  @xcite describes in detail this operator ; here to fix ideas we include it for the non - excision case .",
    "it is , on each direction , @xmath115    maximally dissipative boundary conditions are imposed numerically through projections that are orthogonal in the linear case .",
    "we use third order runge - kutta to integrate the equations in time .",
    "the computational domain consists of an uniform cartesian grid ( @xmath116 ) .",
    "the black hole simulations employ a cubical inner boundary to excise the singularity from the computational domain . unless otherwise stated , the simulations presented throughout the paper use a dissipative parameter @xmath117 and courant factor @xmath118 .",
    "this choice for @xmath119 is motivated by the fact that , at least for the second order wave equation written in first order form , it gives the maximum courant factor allowed by von - neumann stability ( see @xcite ) . for additional information on our numerical scheme",
    "see  @xcite .",
    "boundary conditions are specified via maximally dissipative boundary conditions where needed .",
    "these are introduced by finding all the incoming modes and setting the time derivative of these to zero .",
    "maximally dissipative boundary conditions can be written in the form @xmath120 where @xmath121 is `` sufficiently small , '' such that an energy estimate for the ibvp can be derived for symmetric hyperbolic systems in more than one dimension ( see , e.g. , @xcite . ) .",
    "the function @xmath122 is an _ a priori _ but arbitrary function of the spacetime coordinates in the boundary and time .",
    "the combination of maximally dissipative boundary conditions and a symmetric hyperbolic evolution system define a well - posed initial - boundary value problem .",
    "however , these boundary conditions in general are _ not _ constraint - preserving . for the evolutions presented here , setting the time derivative of _ all _ the incoming modes to zero is consistent with preserving the constraints at the boundary because the exact solution is known .",
    "however , this will not hold in general and future work will concentrate on evolutions with constraint - preserving boundary conditions .",
    "we first test our numerical method by studying a gauge wave defined by @xmath123 which corresponds to a coordinate transformation in the @xmath124 plane , of flat spacetime .",
    "the analytic solution for the gauge wave is obtained by setting the gauge source function to zero , @xmath125 , in eq .",
    "( [ adot ] ) : @xmath126 and the shift @xmath127 .",
    "we adopt periodic boundary conditions to simplify the analysis by eliminating possible boundary effects .",
    "we then examine in some detail tests with schwarzschild spacetime , which describes a static non - spinning black hole .",
    "the singularity inside the black hole is excised , which restricts the possible slicings ( surfaces of constant time ) that we consider to those that smoothly penetrate the black hole horizon , such that we can place an inner boundary inside of the horizon . in the present work we consider a schwarzschild black hole in kerr - schild ( ks )",
    "or ingoing eddington - finkelstein coordinates . in these coordinates ,",
    "the metric of the spacetime is given by the line element : @xmath128 where , @xmath129 the gauge source function @xmath19 is read off from the exact solution .",
    "the gauge wave is a simple , non - trivial numerical test problem , as it is free of boundaries , the amplitude of the fields can be controlled by a single parameter , and it does not lead to any singularity .",
    "this solution is used to compare the performance of different implementations of einstein s equations  @xcite . despite its simplicity at the analytical level",
    ", this test illustrates the challenges associated with the numerical implementation of einstein equations   @xcite .",
    "in particular , it is often observed that for amplitudes @xmath130 , the numerical solutions display exponential growth and loss of convergence .    since in the cases discussed in this paper the analytical solution",
    "is known , the convergence factor can be defined as @xmath131 with @xmath16 the variable under consideration , @xmath132 and @xmath133 its numerical ( at resolution @xmath134 ) and analytical solutions , respectively .    in the present context",
    ", the gauge wave is used for two purposes .",
    "first , it allows us to probe the stability of our numerical method , showing its advantages and present limitations .",
    "second , it sheds light on possible sources of instabilities or spurious growth often encountered in these tests .",
    "in particular , we are able to establish that _ constraint violations _ , if any , grow quite slowly , allowing one to accurately follow the system for thousands of crossing times , even for large values of the amplitude parameter @xmath135 .",
    "we have ran our simulations for a wide range of values for @xmath135 , observing qualitatively the same results .",
    "note that one can readily show that the constraints , @xmath136 , @xmath137 , and @xmath138 , for the gauge wave in this formulation are satisfied to round - off level if the variables depend solely on @xmath139 .",
    "that @xmath136 , @xmath137 are satisfied follows directly from the fact that @xmath140 , @xmath141 , @xmath142 ; with @xmath143 arbitrary functions .",
    "note that : ( i ) at any @xmath144 hypersurface , @xmath0 describes a flat metric and so @xmath145 analytically .",
    "furthermore , at the numerical level all terms in @xmath146 cancel , including those describing the truncation errors in the derivatives .",
    "( ii ) @xmath147 and @xmath148 are zero algebraically and so , coupled to ( i ) , @xmath136 , @xmath137 are satisfied numerically to round - off level .",
    "( iii ) @xmath138 is defined by the conmutator of two derivatives ; since the only non - trivial components are in the @xmath149 direction , the only surviving one is @xmath150xx}$ ] which is trivially satisfied .",
    "consequently , the value of the constraint - function multiplying them in the right hand side of the evolution equations do not play a significant role .",
    "this observation holds for the variables depending solely on @xmath139 , as mentioned , this is indeed the case throughout our runs .",
    "therefore , for these tests we adopt the two - constraint - function family formulation with fixed values for the constraint - functions : @xmath151 .",
    "we concentrate on two non - linear cases with relatively large amplitudes : @xmath152 and @xmath153 .",
    "for example , when @xmath152 , @xmath154 ranges over the interval @xmath155 $ ] , and over @xmath156 $ ] when @xmath153 . in @xcite , an independent analysis and code for the linear equations around the gauge wave",
    "was presented , illustrating the tendency of the numerical solution to grow exponentially unless some small amount of dissipation is added to the rhs .",
    "the computational domain is chosen to be @xmath157 $ ] , and is represented on a uniform grid with spacing @xmath158 .",
    "the gauge wave is really a one dimensional problem , with a non - trivial dependence only on @xmath124 .",
    "the solution is constant in the @xmath159 coordinates , thus only a few points are need to represent the field in these directions .",
    "we therefore use @xmath160 points with @xmath161 in the @xmath149 direction , and five points in each of the @xmath159 directions ( though tests were performed with uniform grids , equally spaced in all directions obtaining exactly the same results as expected ) . in the gauge wave tests , we chose a courant factor of @xmath162 so as to make a more direct comparison with similar tests presented in the literature ( see for instance @xcite ) .",
    "figures [ logenergy05 ] , [ log_g05 ] and [ con_a05 ] illustrate our results for the gauge wave with amplitude @xmath152 .",
    "figure  [ logenergy05 ] shows for three different resolutions the logarithm of the energy for the constraints as a function of time , for @xmath163 crossing times .",
    "the lowest resolution shows a slowly growing behavior , but this is considerably diminished as better refined ones are considered .",
    "note that even for the coarsest resolution , the energy remains smaller than @xmath164 .    in this type of simulation",
    ", phase differences between the numerical and exact solutions typically cause the error to vary in an oscillatory way : the error going back to a small value after some time , when the numerical solution achieves a phase difference of @xmath165 relative to the exact one  @xcite . to give a phase - independent indication of the errors with respect to the exact solution , in figure [ log_g05 ] we show the relative error in the maximum attained by @xmath154 , compared to the exact value . a slow growth is observed .",
    "in particular , the error in the maximum of the function is @xmath166 even after @xmath163 crossing times for the finest discretization .",
    "[ log_g05 ] also explicitly shows that the amount of dissipation is very small , as the amplitude is not damped even in very long runs .",
    "the crossing of lines in fig .",
    "[ log_g05 ] _ does not _ imply lack of convergence , since one is not necessarily comparing the field at the same points .",
    "( for an explicit convergence illustration of the solution itself , we present some results for the more stringent @xmath153 case ) .",
    "figure [ logenergy05 ] explicitly shows convergence of the constraints to zero , while figure  [ con_a05 ] displays the associated convergence factors for those simulations .",
    "the latter are obtained by dividing the energy for different resolutions in pairs ( i.e. , @xmath167 and @xmath168 ) . for a second order accurate code this convergence factor should be two in the convergent regime .",
    "figure  [ con_a05 ] shows that second order convergence is lost after some time , but this is expected for such long simulations , owing to accumulation of truncation error .",
    "however , the convergence factor gets closer to two when computed with the two highest resolutions .    .",
    "three different resolutions are used , the coarsest run exhibits a slow growth which is negligible at higher resolutions.,height=226 ]     ( compared to its exact value ) versus number of crossing times for the simulations of figure  [ logenergy05].,height=226 ]    .",
    "[ log_g05 ]     and fig .",
    "[ logenergy05 ] .",
    "this figure shows the convergence factors obtained by dividing the energy found at different resolutions in consecutive pairs .",
    "the oscillations observed are a product of phase velocities differing at different resolutions.,height=226 ]      increasing the amplitude of the gauge wave introduces some complications when comparing to lower amplitude runs _ at the same resolutions .",
    "_ for example , at the coarsest resolution ( @xmath169 ) the fields and the energy grow considerably : after @xmath170 crossing times the energy is of order @xmath171 . clearly , even in the convergent regime , errors of this magnitude mean the numerical solution is of little use",
    ". simulations with errors below ten percent last until about @xmath172 crossing times for this particular grid resolution . to demonstrate the effect of resolution on the quality of the solution , we take @xmath170 crossing times as the end - point of our simulations .",
    "figures  [ logenergy1 ] , [ log_g1 ] and [ con_a1 ] illustrate the results .",
    "the energy of the constraints , as shown in figure  [ logenergy1 ] , shows marked exponential growth , with a large growth rate for the coarsest resolution . however , increasing the resolution diminishes the growth rate considerably , and simulations can be extended for at least @xmath173 crossing times ( at which point we simply stopped the simulations , with small errors ) .    figure  [ log_g1 ] shows the relative error in the maximum attained by @xmath154 for the high amplitude gauge wave @xmath153 . again , a rapid raise in the error is clearly seen for the coarsest resolution , but this effect is less noticeable at higher resolutions . at @xmath170 crossing times , the error in the maximum of the function is less than ten percent . finally , the convergence of the code is explicitly illustrated in fig .",
    "[ con_a1 ] , which shows the convergence factors obtained by taking the energy for the constraints at different resolutions and dividing them in pairs .",
    "the order of convergence of the constraints to zero is close to two for some time , and the lenght of this time increases with resolution . finally , to illustrate the overall quality of the obtained numerical solution for different resolutions , figures [ snap ] , [ snapconvergefactor ] and [ snapconverge ] display explicit comparisons between the exact solution and the middle and fine resolutions ( @xmath174 ) .",
    "figure [ snap ] presents snapshots of the solution at @xmath175 and @xmath176 crossing times , clearly both drifts in phase and amplitudes are observed for the middle resolution while for the finer one the difference is mainly observed in the phase . despite these differences , the solution obtained is converging to the exact one .",
    "figure [ snapconvergefactor ] provides the convergence factor calculated with the two resolutions . as before",
    ", the factor deviates from its expected value after a while , but this improves with resolution .",
    "finally figure [ snapconverge ] shows the @xmath177 norm of the difference between the exact and numerical solutions .",
    "clearly even after @xmath172 crossing times , the fine resolution stays close to the exact solution and does not exhibit growth faster than the expected linear one .",
    "gauge wave simulations .",
    "the coarsest resolution exhibits a marked growth after @xmath172 crossing times , though with higher resolutions this effect becomes negligible.,height=226 ]     for the simulations of fig .",
    "[ logenergy1 ] .",
    "the errors exhibit a slow growth which diminishes with resolution.,height=226 ]     and [ log_g1 ] , obtained by dividing the energy for each resolution in consecutive pairs . as in figure",
    "[ con_a05 ] , after some time the convergence factors deviate from the expected value of two , but this difference diminishes when the two highest resolutions are used to compute the convergence factor.,height=226 ]     and @xmath176 crossing times displaying the exact solution and the numerically calculated ones for the middle ( @xmath178 ) and fine ( @xmath179 ) resolutions .",
    "convergence to the exact solution is evident as resolution is increased.,height=226 ]         norm of error in the numerical solution .",
    "although a faster than linear growth is observed for the middle resolution , this effect converges away as a finer resolution is considered.,height=226 ]      as mentioned above , the constraints @xmath136 , @xmath137 , and @xmath138 are initially satisfied to the level of round - off in the gauge wave tests .",
    "for grids with at least @xmath180 points , these constraints remain quite small throughout the runs , even for the high amplitude case , @xmath153 .",
    "this has several consequences :    * first , most hyperbolic formulations differ , among other things , in how the constraints are added to the right hand side of the equations  @xcite .",
    "since the constraints themselves stay negligible small , we expect the conclusions found with this test should be applicable to most hyperbolic formulations with the same choice of lapse and shift .",
    "namely , that the use of symmetric hyperbolic systems and numerical techniques guaranteeing stability at the linear level , plus the addition of a small amount of dissipation stabilizes the problem . for instance , without the use of dissipation , for the case @xmath153 and @xmath180 points we can follow the system for about ten crossing times before the errors in the numerical solution become of order one . with a small dissipative term , on the other hand , the system after @xmath181 crossing times does not yet exhibit errors of order one . *",
    "second , the minimization technique presented in section  [ minimization ] explicitly makes use of non - homogeneous terms ( in the free constraint - functions ) in the expression for the energy growth in order to minimize it",
    ". however , in the current case these non - homogeneous terms are considerably smaller than the homogeneous contribution .",
    "therefore , one would need to use huge constraint - function values for them to play a role in minimizing the growth , which would require the use of an extremely small courant factor .",
    "note that the formulation used employs the addition of the constraints @xmath136 , @xmath137 and @xmath138 but not @xmath182 and @xmath183 .",
    "the latter ones are _ not _ satisfied to round - off level but just to truncation level initially . as a result",
    "one could have considered a constraint energy which includes them or a modification of the formulation employed by the addition of these constraints in a suitable manner .",
    "we have not explored these options in the present work as in the black hole case the non - homogeneous terms in the constraint energy are not negligible as in the gauge wave case . indeed , this is what would be expected for generic scenarios .",
    "we now turn our attention to the schwarzschild black hole spacetime .    in this case",
    "discretization errors ( that is , due to finite grid spacing ) make the constraints start - off at non - negligible values and so the minimization technique can be used to pick up preferred formulations for this problem . before applying the minimization procedure",
    "we examine the system with fixed constraint - functions with the goal of understanding some specific issues . as in the rest of the paper ,",
    "the simulations of this section are done with the two - constraint - function family of formulations discussed in section ii ( the reason for not using the single - constraint - function family is explained in section [ why_not ] ) ; and the fixed values for @xmath184 and @xmath185 here used are , in the absence of any other obvious choices , @xmath186 . recall that this two - constraint - function family is symmetric hyperbolic for _ any _ values of @xmath185 and @xmath184 , in particular for @xmath186    next we study the influence of the position of the inner boundary ; the outer boundaries ( their influences being discussed later in the paper ) are kept at the same position , @xmath187 in all the runs of this section .",
    "the outer boundaries are chosen quite close on purpose , to make the turn - around time for the runs shorter for the rather detailed analysis of this section .",
    "however , it should be clear that the points here made are quite independent on the particular position for the outer boundaries chosen . later",
    ", when applying the minimization of the constraints , we will choose several different values for the position of the outer boundary .",
    "black hole excision is usually based on the assumption that an inner boundary ( ib ) can be placed on the domain such that information from this boundary does not enter the computational domain .",
    "the boundary is supposed to be contained inside the black hole and _ also _ to be purely outflow , i.e. , all modes propagate off of the grid at the boundary .",
    "this requirement places strenuous demands on cubical excision for a schwarzschild black hole in kerr - schild , painlevee - gullstrand or the martel - poisson @xcite coordinates : the cube must be inside @xmath188 in each direction .",
    "this forces one to excise very close to the singularity , where gradients in the solution can become very large , requiring very high resolution near the excision boundary to adequately resolve the solution .",
    "finally , we note that this requirement follows directly from the physical properties of the schwarzschild solution in these coordinates , and is independent of the particular formulation of the einstein equations  @xcite .    with our current uniform cartesian code , we are not able to provide the resolution required to adequately represent the schwarzschild solution close to the singularity .",
    "while we are actively working on solutions to this problem , currently our only practical alternative is to place the inner boundary inside the event horizon , but outside the region specified by the outflow condition , i.e. , the solution has incoming modes on the inner boundary .",
    "one could attempt to provide data for the incoming modes on the excision boundary .",
    "however , there is no general theory well - posed problems when the principal part rank , i.e. , number , of zero speed modes on the boundary , is not constant .",
    "moreover , ill - posed problems for such configurations are known .",
    "thus we simply do not apply boundary conditions to the incoming modes on the inner boundary , resulting formally in an ill - posed problem  @xcite . in this section , however , we argue that errors from this inconsistency do not prevent us from learning much about the numerical properties of our formulation for black hole spacetimes .",
    "figure ( [ inner ] ) shows the results of simulations with different positions for the inner boundary ( ib ) , with @xmath189 , obtained without imposing boundary conditions at the ib .",
    "the ib at @xmath190 ( i.e. half the length of a cube centered at the origin ) corresponds to a purely outflow boundary . at the other extreme",
    ", the inner boundary at @xmath191 gives an inner boundary that penetrates outside the event horizon .",
    "the cases between @xmath190 and @xmath191 correspond to ib inside the black hole , with inflow portions .",
    "all runs shown in fig .",
    "[ inner ] , except the first with ib at @xmath190 , should have convergence problems , since not giving boundary conditions is inconsistent with the structure of the characteristic modes .",
    "however , one also sees that at this resolution , placing the inner boundary so close to the singularity causes the code to run a factor of ten less , presumably because of lack of resolution .    ) , and different position for the inner boundary ( ib ) .",
    "the resolution is @xmath192 .",
    ", height=226 ]    .",
    "[ inner ]    figure ( [ convergence1 ] ) shows a convergence test for a configuration test with a the excision boundary at @xmath193 with resolutions @xmath189 , @xmath194 , @xmath195 . from here on the errors shown in the plots",
    "are those of the numerical solution @xmath196 relative and with respect to the exact one @xmath197 ; more precisely , the @xmath177 norm of @xmath198 where the sum is over the components of the vector valued functions @xmath199 .    this test can give some indication of possible numerical stability problems . while the solution diverges in all cases ,",
    "the fact that the code appears to converge in the short term indicates that at these resolutions , and for these run times , the expected instability owing to improper boundary placement appears to grow slower than other unstable modes in the solution .",
    "thus we can still obtain valuable information about the solution and its numerical properties .",
    "finally , we emphasize that the inconsistent inner boundary probably leads to convergence difficulties that could be detected with more extensive tests , such as performing a fourier decomposition of the numerical solution , and a convergence test frequency by frequency likely would make the numerical instability manifest , see for instance @xcite .    , inner and outer boundaries at @xmath193 and @xmath200 , respectively.,title=\"fig:\",height=226 ] , inner and outer boundaries at @xmath193 and @xmath200 , respectively.,title=\"fig:\",height=226 ]      in this section we examine several issues that arise in the constraint energy minimization procedure .",
    "we consider only the two - constraint - function family of formulations of the equations for all constraint minimization runs .",
    "the single - constraint - function formulation is inadequate because , as mentioned above , the free constraint - function @xmath53 may not equal zero .",
    "thus @xmath53 may only be negative or only positive during an entire run to be a continuous function of time .",
    "this considerably limits the power of the dynamic minimization technique , since in order to control the constraints one might need at some time a positive value of @xmath53 and at some other time a negative one .",
    "indeed , this occurs as figure  ( [ chi ] ) shows . for this resolution and location of inner and outer boundaries",
    "the initial discretization error for the constraints leads to a value of the energy of @xmath201 figure [ chi ] thus shows two evolutions , one with a negative seed value , @xmath202 , and a tolerance value @xmath203 .",
    "the second run has a tolerance value of @xmath204 , and as seed value @xmath205 . in both cases @xmath206 . in both cases",
    "@xmath53 changes sign , indicating that this can be expected in general , and that there is no continuous interpolation for @xmath47 in the limit @xmath207 such that @xmath208 .     would need to change sign in order to achieve certain control on the constraints .",
    "therefore , it would not have a continuous limit when @xmath209 .",
    "for this reason , the two - constraint - function formulation is used throughout this paper.,height=226 ]      , computed through the semi - discrete prediction and through numerical differentiation .",
    "the remarkable agreement between the two indicates that the semi - discrete analysis used to calculate the constraint minimization is faithful representation of the fully discrete evolution.,height=226 ]    the constraint minimization method , as described in section [ minimization ] , is based on _ semi - discrete _ equations , where the spatial derivatives are discrete , but time continuous .",
    "while a fully discretized method could be developed , we simply use the semi - discrete analysis here . in the limit @xmath210",
    ", one naturally expects this semi - discrete analysis to be a perfect description of the fully discrete scheme .",
    "here we verify that the fully discrete evolutions are , indeed , very well approximated by the semi - discrete analysis , cf .",
    "( [ split ] ) , even for rather large courant factors , such as @xmath211 that we use for the black hole runs of this paper .",
    "figure  [ energy ] shows results of an evolution with inner boundary at @xmath212 , outer boundaries at @xmath213 , and @xmath189 .",
    "there are two curves for the time derivative of the energy , @xmath80 .",
    "the first curve is obtained via the semi - discrete prediction , eq .",
    "( [ split ] ) , with the matrix valued integrals @xmath214 computed during evolution .",
    "the second curve is obtained from second order , centered differences of the energy , @xmath215 .",
    "both curves agree remarkably well , which indicates that the semi - discrete expression for @xmath80 captures the dynamic constraint behavior in the fully - discrete simulation with a courant factor of @xmath118 .    as another illustration of this",
    ", figure  [ energywave ] shows the results obtained for one of the gauge wave tests presented above : @xmath152 , @xmath216 points , and @xmath217 . for a clean visualization of the agreement",
    "we show here a period of time between @xmath218 and @xmath219 crossing times .",
    "the agreement of the curves is evident .",
    "show the effects of varying the frequency of performing the constraint minimization , as well as the dependence on @xmath69 .",
    "the constraint - function @xmath185 for @xmath220 is not shown as the run crashes very early and the scale in the time axis for the associated plot is not logarithmic.,title=\"fig:\",height=226 ]   show the effects of varying the frequency of performing the constraint minimization , as well as the dependence on @xmath69 .",
    "the constraint - function @xmath185 for @xmath220 is not shown as the run crashes very early and the scale in the time axis for the associated plot is not logarithmic.,title=\"fig:\",height=226 ]    we now consider some practical questions that arise when performing the constraint minimization method , namely : how often should the minimization be performed ? , and how fast should the constraint - functions multiplying the constraints in the rhs be allowed to change ?",
    "the minimization procedure can be computationally expensive , making it advantageous to perform the analysis infrequently if possible .",
    "( note that the evaluation of the constraint energy require knowledge of the right hand side of the equations , so _",
    "each _ evaluation takes about as much computer time as is required in a time - step ) .",
    "the second question relates to how fast the constraint - functions are allowed to vary by setting @xmath69 , which is used to estimate how many steps are required for @xmath215 to relax to the tolerance value , @xmath73 .",
    "furthermore , can one trade the frequency of the constraint minimization with different values of @xmath69 ? for example , is performing the minimization at every iteration with a large value of @xmath69 equivalent to performing the minimization every certain number of steps with a smaller value of @xmath69 ? .",
    "we will see that it is preferable to perform the minimization at every time step .",
    "figure  ( [ energy1_every_it_1 ] ) shows the results of runs with the same numerical constraint - functions as in the previous subsection : outer boundaries at @xmath187 , inner boundary at @xmath193 , @xmath117 , @xmath118 , @xmath221 points , and a tolerance value @xmath222 , performing the minimization at every time step , but now with different values of @xmath69 .",
    "the constraint - function @xmath184 is fixed to @xmath223 , and the minimization of the constraints is applied using @xmath185 , as described in section  [ minimization ] .",
    "the constraint energy , @xmath215 is shown in the upper panel , and @xmath224 in the lower panel . with a fixed courant factor , small values of @xmath69",
    "are problematic because large and fast variations in @xmath224 are allowed and , as shown in the figure , do occur . on the other hand , large values of @xmath69",
    "can let the energy grow too much .",
    "compare now figure  ( [ energy1_every_it_10 ] ) , where the minimization is now applied every ten time steps . as can be seen , it is better to apply the minimization at every time step",
    ". otherwise the energy appears to grow too fast between recalculations of the constraint - functions . finally , we note that this behavior may be model dependent , and in other scenarios it may be possible to use the minimization less frequently . in this paper , however , we perform the minimization after every time iteration .    ) , except that here the minimization is done every @xmath225 iterations . comparing it with the previous plot",
    ", it seems clear that performing the minimization at every iteration seems a better option , title=\"fig:\",height=226 ] ) , except that here the minimization is done every @xmath225 iterations . comparing it with the previous plot",
    ", it seems clear that performing the minimization at every iteration seems a better option , title=\"fig:\",height=226 ]    .",
    "[ energy1_every_it_10 ]       demonstrate the influence of the tolerance value , @xmath73 , on the results of the constraint minimization .",
    "the two - constraint - function formulation is used , with @xmath223 and @xmath224 chosen dynamically .",
    "the results are not sensitive to the chosen tolerance value , provided that one avoids large variations in @xmath224 by using appropriate values of @xmath69 .",
    "however , notice that `` appropriate '' values of @xmath69 naturally keep the value of the energy close to its initial , discretization value ( here given by @xmath226 .",
    "therefore , keeping the constraint energy near its initial discretization value appears to give the best results .",
    "this figure shows runs with @xmath227 and @xmath228 .",
    "[ tolerance2 ] shows runs with @xmath222 and @xmath229.,title=\"fig:\",height=226 ]   demonstrate the influence of the tolerance value , @xmath73 , on the results of the constraint minimization .",
    "the two - constraint - function formulation is used , with @xmath223 and @xmath224 chosen dynamically .",
    "the results are not sensitive to the chosen tolerance value , provided that one avoids large variations in @xmath224 by using appropriate values of @xmath69 .",
    "however , notice that `` appropriate '' values of @xmath69 naturally keep the value of the energy close to its initial , discretization value ( here given by @xmath226 .",
    "therefore , keeping the constraint energy near its initial discretization value appears to give the best results .",
    "this figure shows runs with @xmath227 and @xmath228 .",
    "[ tolerance2 ] shows runs with @xmath222 and @xmath229.,title=\"fig:\",height=226 ]     and @xmath229 .",
    "see fig .",
    "[ tolerance ] for additional information.,title=\"fig:\",height=226 ]   and @xmath229 .",
    "see fig .",
    "[ tolerance ] for additional information.,title=\"fig:\",height=226 ]    we choose constraint - functions in the constraint minimization procedure such that the energy , @xmath215 , decays to a tolerance value , @xmath73 , after certain number of time steps , @xmath69 . in this section",
    "we discuss reasonable choices for @xmath73 , and discuss its the influence on the final solution .",
    "there are some reasons to believe that a value close to the initial discretization error is a good choice  @xcite . here",
    "we present additional evidence for this by comparing simulations with different values of @xmath73 and @xmath69 .",
    "figures  [ tolerance ] and [ tolerance2 ] show @xmath215 as a function of time , for @xmath230 respectively , each one with @xmath231 .",
    "it can be seen that one can indeed perform similarly choosing a tolerance value that is below the discretization error by using an appropriate value for @xmath69 . but notice that the longest runs are obtained when @xmath215 naturally has a value near the initial discretization error . even if @xmath73 is very small",
    ", a large value for @xmath69 allows the constraints - functions to change only very slowly , resulting in slow changes of @xmath215 towards @xmath73 . in summary , a combination of @xmath73 and @xmath69 that keeps @xmath215 near the initial discretization error appears to give the best results .       for the @xmath232 cases of the previous plot , in more detail .",
    "notice the scale in the @xmath206 case , @xmath233 changes a lot per time step .",
    "on the other hand , notice how in the @xmath234 case @xmath224 changes slower but still changes , and eventually it needs to take very large values in order to control the constraints.,title=\"fig:\",height=226 ]   for the @xmath232 cases of the previous plot , in more detail .",
    "notice the scale in the @xmath206 case , @xmath233 changes a lot per time step .",
    "on the other hand , notice how in the @xmath234 case @xmath224 changes slower but still changes , and eventually it needs to take very large values in order to control the constraints.,title=\"fig:\",height=226 ]    fig .",
    "( [ energy1_every_it_1 ] ) shows that the constraint minimization gives an improvement of five to ten times in the lifetime of the simulations , compared to the results shown in fig .",
    "( [ inner ] ) , the method does not prevent the eventual code crash when @xmath215 is very large .",
    "given that the constraint minimization method is designed to prevent this , we consider possible reasons why the method eventually fails .",
    "operationally , the failure seems to occur because large scale variations of @xmath185 on ever decreasing time scales are required at late times .",
    "it is not possible for the code to resolve such variations in the fields with a fixed courant factor .",
    "this was partly analyzed in section  [ every ] , where we discussed the dependence of @xmath224 on @xmath69 ( see figure  [ etas ] ) .",
    "furthermore , when @xmath69 is large , @xmath215 does not return immediately to a value near @xmath73 , but changes are affected slowly .",
    "thus , if @xmath215 grows on time scales of a large number of steps , the minimization method is unable to halt the growth . having evidence of why the code crashes , we now can attempt improvements o the method , as discussed in the next section .      in this section",
    "we exploit the freedom in the two - constraint - function family to extend the lifetime of black hole simulations .",
    "the tolerance value for the energy is chosen to be a value roughly one order of magnitude larger than the initial discretization error , and @xmath69 is set to either @xmath235 or @xmath236 .",
    "the boundaries are placed at @xmath200 , as in the runs discussed previously , and also at @xmath237 and @xmath238 .",
    "we exploit the fact that there are two free constraint - functions to achieve not only a given tolerance value , but also to minimize the change in the constraint - functions @xmath239 , to prevent fast variations in these constraint - functions , as explained below .",
    "thus , with two constraint - functions to achieve the desired tolerance value , we can impose an additional condition to minimize the variation in the constraint - functions from one time step to the other one .",
    "the motivation for this condition comes from the discussion in the previous section on the limitations of the constraint minimization technique , where large oscillations in the constraint - functions were needed in order to keep the constraints under control .",
    "therefore , it seems reasonable at this stage to conjecture that the lifetime would be extended even more if one was able to apply the constraint minimization in a way such that fast variations in the constraint - functions are not needed .",
    "as shown below , this conjecture seems to be correct .",
    "therefore , within all the constraint - functions that achieve the desired energy growth for the constraints , we choose at time step @xmath240 the pair that minimizes the quantity @xmath241 ^ 2        + \\left [ \\gamma ( n+1 ) - \\gamma(n ) \\right]^2 \\label{triangle}\\ ] ]    to apply this condition , consider that eq .",
    "( [ edot_bi ] ) indicates that @xmath80 is non - linear in @xmath242 but linear in @xmath185 , allowing one to solve for @xmath185 such that @xmath243 , @xmath244 where , as in section iii , @xmath70 is given by eq.([a ] ) .",
    "a set of values for @xmath184 is chosen within some arbitrary , large interval . for each @xmath184",
    "the corresponding @xmath185 given by eq .",
    "( [ eta_tent ] ) is computed , and the pair @xmath245 that minimizes @xmath246 defined in eq .",
    "( [ triangle ] ) is chosen .",
    "as explained in section , the constraint - functions @xmath247 can take any value , except for @xmath248 , value for which the equations are singular .",
    "therefore , there are two `` branches '' , we have only explored the one associated with @xmath249 , by using as seed values @xmath250 and restricting the minimization procedure to values @xmath251 .",
    "as discussed next , almost an extra order of magnitude in the lifetime of the simulations can be obtained , and the run that initially lasted for  @xmath237 without the minimization of the constraints , now runs for around @xmath252 ( without any symmetry ",
    "bitant , octant , or of any other type imposed ) .      , @xmath253 , @xmath228 , and @xmath254 .",
    ", title=\"fig:\",height=226 ] , @xmath253 , @xmath228 , and @xmath254 . , title=\"fig:\",height=226 ]    figure  [ bi_dyn_bound5 m ] shows the results of a simulation with resolution @xmath253 , @xmath228 ( close to the initial discretization error value , given by eq .",
    "[ tol5 m ] ) and @xmath254 .",
    "the figure shows that as the code crashes the constraint - functions start having large and fast variations .",
    "a natural question that this raises is whether these variations are a cause or consequence of the code crashing . for reasons discussed below",
    ", they appear to be a consequence .",
    "figure  [ bi_dyn_bound5ma ] shows the same run as that shown in fig .",
    "[ bi_dyn_bound5 m ] , except that the minimization is stopped at @xmath255 ( at which point the constraint - functions are , nearly constant ) , and from there on the last value of the constraint - functions is used ; namely , @xmath256 the code still crashes at roughly the same time .",
    "therefore , the variations in the constraint - functions observed in fig .",
    "[ bi_dyn_bound5 m ] do not cause the code to crash , but appear to be a consequence of other instabilities . figure  [ bi_dyn_conv_bound5 m ] shows a convergence test with two resolutions ( @xmath253 , @xmath257 ) , and keeping the constraint - functions ( obtained from the @xmath253 resolution run ) fixed after @xmath255 .    .",
    "the figure compares the resulting energy for the constraints with that of the previous figure ( shown at late times only , since because of the setup the runs are identical up to @xmath258).,height=226 ]    .,title=\"fig:\",height=226 ] .,title=\"fig:\",height=226 ]    .",
    "[ bi_dyn_conv_bound5 m ]    another measure of the error in the solution is the mass of the apparent horizon .",
    "figure  [ ah ] shows this mass using the dynamic constraint - functions obtained from the simulation of figure  [ bi_dyn_bound5 m ] and by running at each iteration thornburg s apparent horizon finder  @xcite . for the coarsest resolution ,",
    "the initial value of the mass , as given by the horizon finder , is @xmath259 .",
    "compared to this value , the initial oscillations have a relative error of less than one percent . after some time",
    ", the mass approximately settles down to a value that is around @xmath260 , which corresponds to an error of the order of one part in one thousand . for the higher resolution ,",
    "the initial value of the mass as given by the horizon finder is @xmath261 . with respect to this value",
    "the initial oscillations are at most of the order of one part in one thousand , and at late times the apparent horizon mass settles down to @xmath262 , which corresponds to a relative error of one part in @xmath263 .        even though the constraint - functions do not settle down completely to a stationary value , they oscillate very little .",
    "one question that this raises is how does the code perform if one fixes these values given by eq .",
    "( [ pars5 m ] ) from the very beginning .",
    "the plots in figure  [ comparison ] make this comparison .",
    "interestingly , the run with dynamsic minimization runs slightly longer , even when the constraint - functions after some time are essentially constant , and even though the solution being evolved is stationary at the analytical level .",
    "this shows that the dynamic minimization not only requires little experimentation but also seems to be effective in that it naturally allows for variations in time that accommodate to the variations of the numerical solution .    ) ] .,title=\"fig:\",height=226 ] ) ] .,title=\"fig:\",height=226 ]      we now examine data from a configuration equivalent to that of the previous section , except that now that the boundaries are at @xmath264 .",
    "the initial discretization value for the energy is @xmath265 , and @xmath222 , and @xmath266 are chosen . as seen in the previous case",
    ", the constraint - functions eventually settle into oscillations about fixed values , @xmath267 as shown in figure  [ bi_dyn_bound10 m ] .",
    "these steady - state values are quite different from the previous configuration with boundaries at @xmath200 , see eq.([pars5 m ] ) .",
    "this raises the question of what would happen if one ran with boundaries at @xmath237 , and fixed constraint - functions given by eq.([pars10 m ] ) in one case and eq.([pars5 m ] ) in the other .",
    "figure  [ comparisonb10 m ] makes this comparison .",
    "as expected , the constraint - functions obtained from the run with dynamic minimization and boundaries at @xmath200 do not perform as well as those obtained with boundaries at @xmath237 .",
    "however , even using the constraint - functions obtained from the simulation with boundaries at @xmath200 is much better than using a naive choice ( say , @xmath268 , which for the resolution of fig .",
    "[ comparisonb10 m ] runs for less than @xmath269 , as shown in fig .",
    "[ convergence1 ] ) .    , @xmath253 , @xmath222 , and @xmath266 . ,",
    "title=\"fig:\",height=226 ] , @xmath253 , @xmath222 , and @xmath266 .",
    ", title=\"fig:\",height=226 ]    , using fixed , but fine tuned constraint - functions , obtained from runs with boundaries at @xmath200 and @xmath237.,height=226 ]     and the simulation of fig .",
    "[ comparisonb10 m ] with constraint - functions given by eq.([pars10 m ] ) . a logarithmic scale in time",
    "is used in order to show the oscillations in more detail .",
    "the oscillations are not caused by time variations in the constraint - functions , since they are also present in the fixed - constraint - functions case.,height=226 ]    figure  [ ah_b10 m ] shows the apparent horizon mass , for the simulations of figures  [ bi_dyn_bound10 m ] , and one simulation from fig .",
    "[ comparisonb10 m ] with constraint - function values given by eq.([pars10 m ] ) . in both cases",
    "the resolution is coarse , @xmath253 . as for the case with boundaries at @xmath200 and with the same resolution ,",
    "the errors are less than one percent when compared to the mass given by the initial data . from fig .  [ ah_b10 m ] one can also see that the oscillations in the mass do not seem to be caused by the time variation of the constraint - functions , as they are still present in the case in which fixed constraint - functions are used .      finally , we consider a configuration with boundaries at @xmath238 , though with less detail as before .",
    "figure  [ bi_dyn_bound15 m ] shows results data equivalent to those discussed for figures  [ bi_dyn_bound5 m ] and  [ bi_dyn_bound10 m ] , except now that the boundaries are at @xmath238 .",
    "the initial , discretization value for the energy is @xmath270 , and @xmath229 , @xmath271 was used .",
    "the minimization of the constraint - functions is stopped at @xmath272 , at which point the constraint - functions are approximately constant , and equal to @xmath273 figure  [ bi_dyn_bound15 m ] shows that the dependence of the lifetime on the location of the outer boundaries is not monotonic , as for this case the code runs for , roughly , @xmath274 , while with boundaries at @xmath237 and @xmath200 it ran for around @xmath275 , and @xmath276 , respectively",
    ". a detailed analysis of such dependence would be computationally expensive and beyond the scope of this work , and may even depend on the details of the constraint minimization , such as the values for @xmath73 and @xmath69 .    ,",
    "@xmath277 , @xmath229 , and @xmath266 .",
    "the constraint - functions are constant for @xmath278 , where they are @xmath279 ; thus , there is no response of the constraint functions when the code is about to crash.,title=\"fig:\",height=226 ] , @xmath277 , @xmath229 , and @xmath266 .",
    "the constraint - functions are constant for @xmath278 , where they are @xmath279 ; thus , there is no response of the constraint functions when the code is about to crash.,title=\"fig:\",height=226 ]",
    "this paper presents a number of new techniques applied to the simulation of einstein equations , namely : ( 1 ) a symmetric hyperbolic formulation with live gauges ; ( 2 ) a numerical discretization based on the energy method with difference operators that satisfy summation by parts and a projection method to apply boundary conditions ; ( 3 ) a constraint minimization method for dynamically choosing constraint - functions that multiply the constraints in the evolution equations without requiring special knowledge of the solution .",
    "we use a generalization of the bona - masso slicing conditions , and to date , this is the only formulation of einstein s equations with this slicing conditions known to be symmetric hyperbolic ( for symmetric hyperbolic formulations with other dynamical gauge conditions see @xcite ) .",
    "there are _ strongly hyperbolic _ formulations with this gauge ( see , for example , @xcite and references therein ) , though , recall that contrary to some common belief , strong hyperbolicity does not automatically define a well - posed initial value problem ( ivp ) . a well - posed ivp for strongly hyperbolic can be found by requiring the existence of a smooth symmetrizer .",
    "however , this smoothness is a non - trivial condition and it is usually not studied in formulations of einstein s equations .",
    "some algebraic conditions do imply the existence of a smooth - symmetrizer @xcite , but for the bona - masso slicings these conditions can only be a priori guaranteed for the time - harmonic subcase  @xcite . in the presence of boundaries",
    "the situation is even more complicated : there are examples in the context of einstein s equations explicitly showing ill posedness of certain strongly hyperbolic equations which do have smooth symmetrizers , when maximally dissipative boundary conditions are used ( while for symmetric systems such a problem is known to be well posed ) @xcite .",
    "while we use time harmonic slicing in this paper , the freedom to use other slicing conditions could prove useful in other scenarios  @xcite .",
    "finite difference discretizations based on the energy method  @xcite exploit results that rigorously guarantee linear numerical stability of ivps as well as ibvps .",
    "in particular , stable simulations of the gauge wave with periodic boundary conditions are obtained for large values of amplitude , @xmath135 , for at least a thousand crossing times .",
    "these simulations show that the constraints remain well behaved throughout the evolution , indicating that constraint violations , if any , grow very slowly in time . for the black hole cases , where both inner and outer boundaries are present ,",
    "these numerical techniques allow for a clean handling of particularly delicate issues .",
    "for instance , defining the difference and dissipative operators at these boundaries , and how boundary conditions are imposed ( in particular , in non - smooth boundaries ) are addressed in a completely systematic way .",
    "numerical stability guarantees that errors do go away with resolution , but at fixed resolution they can still grow quickly in time .",
    "these fast growing errors can be introduced by the continuum instabilities , triggered by numerical errors , by the numerical scheme , or any combination of the above .",
    "the technique explored here  @xcite , automatically adjusts the formulation of einstein s equations in such a way that the discrete constraint violations follow some prescribed behavior ( for example , their norm remains close to its initial , discretization value ) .",
    "there are a number of lessons learned from the application of this dynamic minimization procedure in this paper , which are worth highlighting :    1 .",
    "the semi - discrete picture describes what happens in the fully discrete case remarkably well , even for cases that are highly non - stationary .",
    "here by semi - discrete one means a picture that assumes time to be continuous , but space to be discretized with an arbitrary ( not necessarily small ) grid spacing .",
    "the technique of  @xcite can be used not only as a practical tool for extending the lifetime of the simulations , but also for gaining conceptual insight in the problem of constraints violations in free evolutions .",
    "sometimes very large adjustments must occur on short time scales in order to control the constraints , which may become too fast or large for a fixed courant factor .",
    "there are two issues related to this observation : 1 .",
    "very likely this same feature is present in many other cases , where different formulations of the equations and numerical techniques are used .",
    "it clearly points out a limitation in adjusting the equations so as to minimize the constraints growth , independently of what the adjustment technique is .",
    "nevertheless , the identification of this limitation points out a way to proceed with the technique of @xcite .",
    "namely , to take advantage of many - constraint - function formulations by redefining the equations in a way such that not only a given behavior for the constraints is achieved , but also the adjustment varies as little as possible between two time steps , as done in section [ runs ] .",
    "+ the results of section [ runs ] confirms to a good extent the validity of the previous discussion .    as a practical matter",
    "the lifetime of the full 3d black hole simulations are extended from around @xmath280 up to @xmath252 .",
    "this is achieved without employing symmetry restrictions ( like octant , bitant or any other ) , or previous knowledge of the expected solution . when employing symmetries the code actually runs much longer .",
    "for example , figure [ octant ] shows a fully @xmath281 simulation with boundaries at @xmath237 , using the values around which the parameters settle down after a while , given by eq.([pars10 m ] ) ( that is , one of the simulations of fig.[comparisonb10 m ] ) , compared to the same simulation in octant symmetry , which for convenience was stopped at @xmath282 .",
    "run with fixed and fined - tuned parameters , given by eq.([pars10 m ] ) , compared to the same run in octant symmetry , which was stopped at @xmath282.,height=226 ]    at this point it is not clear why the code crashes after @xmath252 .",
    "one possibility could be the presence of a numerical instability caused by the inconsistency of having an inner boundary that is not purely outflow , but is treated as if it was .",
    "although we have done some convergence tests , numerical instabilities are sometimes subtle , and very detailed and careful convergence tests have to be done in order to detect them , especially when the initial data has few and low frequencies ( as is here the case ) @xcite .",
    "however , an important feature of _ all _ the simulations here presented , _ including those of section [ runs ] _ , is that large values of @xmath69 had to be used in order to prevent large and quick variations in the constraint - functions .",
    "therefore , one _ is not _ completely controlling the constraints  for that a value of @xmath69 of order one would have to be used  and they _ do _ grow .",
    "therefore , one possibility for achieving small values of @xmath69 without large and quick variations in the constraint - functions would be to introduce more free constraint - functions and to make use of this extra freedom as in section [ runs ] .",
    "the results of section  [ runs ] strongly suggest that this should extend the lifetime even more , but more work must be done in order to explicitly study this .",
    "finally , the constraint minimization method is designed to dynamically control the constraints growth without any a priori knowledge of the solution .",
    "therefore , a natural next step also seems to be an application to dynamical spacetimes .",
    "this research was supported in part by the nsf under grant numbers phy0244335 , phy0326311 , phy0244699 , phy9800973 and int0204937 to louisiana state university , phy9907949 to the university of california at santa barbara and by the horace hearne jr .",
    "laboratory for theoretical physics .",
    "the authors thank the kitp at the university of california at santa barbara for hospitality .",
    "l.l . and m.t",
    ". thank the caltech visitors program in numerical relativity for hospitality where the initial stages of this work began .",
    "l.l . has been partially supported by the alfred p. sloan foundation .",
    "this work has been supported in part through lsu s center for applied information technology and learning , which is funded through louisiana legislative appropriation .",
    "computations were done at lsu s center for applied information technology and learning , and parallelized with the cactus computational toolkit  @xcite .",
    "the simulations presented also used the publicly available apparent horizon finder ahfinderdirect , from the cactuseinstein thorn .",
    "we thank jorge pullin and olivier sarbach for helpful discussions throughout this project ; peter diener for an interface with the cactuseinstein thorn , and for help in running the apparent horizon finder ; jonathan thornburg for discussions and help with ahfinderdirect ; and monika lee , joel tohline and ed seidel for their support from lsu s center for computation and technology ( cct ) .",
    "in addition , this paper made use of several analytical results , due to olivier sarbach , regarding symmetrizability of the equations and characteristic variables decomposition , for the formulation presented in ref .",
    "@xcite , that had not been worked out in that reference ; we thank him for working out those results and making them available to us for this work .",
    "finally , we thank ian hawke , carlos palenzuela , jorge pullin , oscar reula , olivier sarbach , and erik schnetter for comments on the manuscript .",
    "m. andersson and r. matzner , gr - qc/0307055 ; u. sperhake , k. l. smith , b. kelly , p. laguna , and d. shoemaker , gr - qc/0307015 ; h - j yo , t. w. baumgarte , and s. l. shapiro , phys .",
    "d * 66 * 084026 ( 2002 ) ; m. a. scheel , l. e. kidder , l. lindblom , h. p. pfeiffer , and s a. teukolsky , phys .",
    "d * 66 * , 124005 ( 2002 ) ; m. alcubierre , b. brugmann , d. pollney , e. seidel , r. takahashi , phys . rev .",
    "d * 64 * , 061501 ( 2001 ) .",
    "g. calabrese and o. sarbach , j. math .",
    "* 44 * , 3888 ( 2003 ) ; g. calabrese , j. pullin , o. sarbach , m. tiglio , and o. reula , commun .",
    "phys . * 240 * , 377 ( 2003 ) ; b. szilagyi and j. winicour , phys .",
    "d * 68 * , 041501 ( 2003 ) ; b. szilagyi , b. schmidt and j. winicour , phys .",
    "d * 65 * , 064015 ( 2002 ) ; h. friedrich and g. nagy , commun .",
    "* 201 * , 619 ( 1999 ) .",
    "olsson `` summation by parts , projections and stability .",
    "i '' , mathematics of computation * 64 * , 1035 ( 1995 ) ; `` supplement to summation by parts , projections and stability .",
    "i '' , mathematics of computation * 64 * , s23 ( 1995 ) ; `` summation by parts , projections and stability . ii '' , mathematics of computation * 64 * , 1473 ( 1995 ) .",
    "h. friedrich and a. rendall , in _",
    "einstein s field equations and their physical interpretation _ , edited by b. g. schmidt ( springer - verlag , berlin , 2000 ) , pp .",
    "127 - 223 ; o. reula , living rev .",
    "rel.*1 * , 3 ( 1998 ) .",
    "m. scheel , l. kidder , l. lindblom , h. pfeiffer , and s. teukolsky , phys .",
    "d * 66 * , 124005 ( 2002 ) ; l. lindblom and m. scheel , phys .",
    "d * 66 * , 084014 ( 2002 ) ; l. kidder , m. scheel and s. teukolsky , phys .",
    "d * 64 * , 064017 ( 2001 ) ;                            m. alcubierre , a. corichi , j. a. gonzalez , d. nunez , and m. salgado , class .",
    "grav . * 20 * , 395 ( 2003 ) ; m. alcubierre , class . quant . grav . *",
    "20 * , 607 ( 2003 ) ; m. alcubierre , b. brugmann , p. diener , m. koppitz , d. pollney , e. seidel , and r. takahashi , phys . rev .",
    "d * 67 * , 084023 ( 2003 ) ; c. bona , j. masso , e. seidel , andj .",
    "stela , phys .",
    "d * 56 * , 3405 ( 1997 ) ; c. bona , j. masso , e. seidel , and j stela , phys . rev . lett . * 75 * , 600 ( 1995 ) ."
  ],
  "abstract_text": [
    "<S> we present three - dimensional simulations of einstein equations implementing a symmetric hyperbolic system of equations with dynamical lapse . </S>",
    "<S> the numerical implementation makes use of techniques that guarantee linear numerical stability for the associated initial - boundary value problem . </S>",
    "<S> the code is first tested with a gauge wave solution , where rather larger amplitudes and for significantly longer times are obtained with respect to other state of the art implementations . additionally , by minimizing a suitably defined energy for the constraints in terms of free constraint - functions in the formulation one can dynamically single out preferred values of these functions for the problem at hand . </S>",
    "<S> we apply the technique to fully three - dimensional simulations of a stationary black hole spacetime with excision of the singularity , considerably extending the lifetime of the simulations . </S>"
  ]
}