{
  "article_text": [
    "we hope to be able to use the current wealth of lyman-@xmath0 absorption data to constrain the shape and normalisation of the density power spectrum and thus the cosmological model .",
    "the extraction of this information is complicated by gas physics , the ultraviolet flux , the star formation history and supernova energy injection . by employing gasdynamical simulations",
    ", we can incorporate the detailed high - redshift environment of the clouds self - consistently .",
    "we perform our lyman-@xmath0 simulations using the sph method in conjunction with a gravity solver based on the multigrid method .",
    "we describe our code , with attention to the novel features , in section  [ code ]    simulations have to be carefully constructed to achieve both the necessary resolution and simultaneously provide a good sample of the universe .",
    "large scale power is also of particular importance for producing the correct tidal environment for lyman-@xmath0 clouds .",
    "recent lyman-@xmath0 simulations ( _ e.g. _ @xcite , @xcite , @xcite , @xcite and @xcite ) have traded good @xmath5-space resolution @xmath6 h mpc@xmath7 kpc against size , @xmath8 mpc .",
    "we address these design issues in section  [ ic ] and see also bond & wadsley ( 1996 ) , ( hereafter bw ) .    in generating the line statistics of the artificial lyman-@xmath0 spectra ,",
    "it is important to fit the lines in a manner directly comparable with observations ( @xcite , @xcite ) .",
    "our method of fitting voigt profiles is described with our results in section  [ results ]",
    "smoothed particle hydrodynamics ( sph ) is a fully lagrangian method for fluid dynamics .",
    "it has been demonstrated to be robust and flexible ( _ e.g. _ review by @xcite ) .",
    "sph has the advantage of following collapse of structure with constant mass resolution .",
    "eulerian codes have high gas resolution in voids , but structures arising from small scale perturbations in the early universe are limited to the mass resolution , which is similar in both methods .",
    "eulerian codes without adaptive refinement smooth structure in collapsing regions .",
    "we use a predictor - corrector time stepping scheme allowing us to vary the global timestep .",
    "the code runs very quickly at first , but slows when the particle - particle section of the gravity solver becomes dominant .",
    "the code includes radiative cooling and photoionization heating with equilibrium abundances .",
    "the species we consider are h , h@xmath9 , he , he@xmath9 , he@xmath10 and e@xmath11",
    ".    we make use of a highly stable , 2nd order implicit scheme for the energy equation to avoid excessively small timesteps associated with the heating / cooling timescales .",
    "we find an iterative solution for the energy , @xmath12 , @xmath13 the predicted midpoint values for @xmath14 and the @xmath15 work are used .",
    "iterative full multigrid techniques provide an excellent alternative to fourier based pm methods . though comparable in speed for a periodic computation ,",
    "the multigrid method requires less work for free boundary calculations , by roughly a factor of two .",
    "in addition , we take advantage of previous time - step information to increase speed even further by reducing the number of iterations required for convergence .",
    "we employ a multipole expansion of the particle potentials to provide boundary conditions for the free boundary calculation .",
    "we have added particle - particle interactions to dramatically augment the resolution of our gravity solver .",
    "the resulting p@xmath16 mg code achieves @xmath31% force errors .    for these simulations we have multiple particle masses .",
    "we make use of nested grids to optimise our computational costs .",
    "we use a @xmath17 grid with p - p around the high resolution core region with an additional @xmath18 grid with no p - p forces for the lowest resolution particles whose function is only to provide long range tidal forces .",
    "this provides for a maximum resolution of 1 kpc .",
    "we set this as the resolution limit for our gas and gravity .",
    "sph relies on weighted sums over near neighbours to estimate all fluid quantities including the pressure forces that move the particles .",
    "the method is adaptive , with the smoothing length for the weighted sum being a direct measure of the local resolution .",
    "appropriately varying smoothing lengths , @xmath19 , are essential to any sph implementation .",
    "methods based on numerically estimated quantities such as divergence or density are susceptible to noise whereas what we require is a good sample of neighbouring particles within @xmath20 . to this end",
    "we count neighbours in three equi - volume shells around each particle , @xmath21 , @xmath22 and @xmath23 .",
    "we update @xmath19 by interpolating over these bins to have 36 neighbours within @xmath24 .",
    "we perform the counting during the density summation ( to avoid extra computation ) for use during the next timestep .",
    "the sph method involves only pairwise interactions , giving exact momentum and energy conservation .",
    "it also relies upon explicit artificial viscosity to model shocks correctly .",
    "the artificial viscosity for particle @xmath25 , contributed by a neighbour @xmath26 , is a function of @xmath27 .",
    "this form can not differentiate between truly converging flows and pure shear flows .",
    "numerical viscosity is thus indiscriminately applied unless a switch is used , such as @xmath28 ( _ e.g. _ @xcite ) . rather than finding the exact divergence and vorticity to flag particles in strongly convergent ( shocking ) regions , we use a similar form that is easier to calculate",
    ", @xmath29    a linked - list of particles allocated to a grid of cells is an extremely fast method for locating particle neighbours .",
    "tree structure is an alternative method , though roughly six times slower for uniform densities and very memory intensive .",
    "however , with high density contrasts , many particles may accumulate in a few link list cells , rendering the method locally @xmath30 and thus very slow .",
    "we adaptively refine our linked list grid to avoid this problem - to a maximum level of four binary sub - divisions .",
    "the storage requirements are naturally much larger but the resulting method slows by only a factor of three in extremely clustered arrangements .",
    "the photoionization levels and heating are determined by the background uv flux , in particular the flux at the ionization edge for hydrogen , @xmath31 .",
    "observations of the proximity effect hint at little evolution in @xmath31 over the range @xmath32 to @xmath33 ( _ e.g. _ @xcite ) .",
    "as shown in the left panel of figure  [ uvda ] , we apply both a fixed flux ( 1 ) and a strongly evolving flux similar to that of @xcite lowered to fit the continuum depression data ( 2 ) , given by the functional form , @xmath34 .",
    "these choices should roughly bracket the true mean uv flux .",
    "the small scale nature of the clouds demands high resolution numerical work , especially as the collisionless nature of the dark matter plus radiative cooling prevent the classical jean s length , @xmath35 h@xmath7 mpc from setting a minimum scale .",
    "@xmath36 refers to density parameter in non - relativistic matter .",
    "we simulate regions of comoving diameter @xmath37 ( @xmath38 for the cdm model , @xmath39 for the cdm+@xmath2 model ) with @xmath40 gas and @xmath40 dark matter particles at our highest resolution .",
    "we enclose this in a medium resolution buffer of gas and dark matter particles with 8 times the mass , out to @xmath41 and then massive tide particles with 64 times the mass , out to @xmath42 .",
    "we apply a linearly evolved external shear to the entire volume , derived from the initial conditions .",
    "thus we make considerable effort to model the long wave , tidal environment well .",
    "we use a sophisticated constrained field code to set up the initial displacements from unperturbed lattice positions , using the zeldovich approximation .",
    "it allows for arbitrary types and numbers of constraints .",
    "our initial conditions finely sample an enormous range of @xmath5-space , down to @xmath43 for these simulations ( see figure  1 of bw ) .",
    "periodic simulations must truncate the large scale power beyond the scale of the fundamental mode of the box and the power spectrum is still very flat at @xmath44 hmpc@xmath7 , the scale of lyman-@xmath0 simulations .",
    "most simulations use random regions of the universe .",
    "we prefer to have control parameters which govern some of the major large scale characteristics of the simulation volume .",
    "we constrain the density ( via @xmath45 ) , bulk flow and tidal fields smoothed over three gaussian filtered scales @xmath46 , where @xmath47 the overdensity of the region relative to the _ rms _ fluctuation level @xmath48 .",
    "more details and applications of our peak constraint approach are described in bw . for these simulations ,",
    "we fix @xmath45 for @xmath49 mpc and use mean field expectations to set the other parameters , and the values at two other scales , 1.0 and 1.5 @xmath50 .",
    "the @xmath45 s used are shown in table  [ table ] .",
    "rare events which form large `` bright '' galaxies by @xmath4 in the patch require higher @xmath45 .",
    "@xmath45 has a gaussian probability distribution , allowing us to appropriately weight and combine simulations of different @xmath45 to create a sample broadly representative of the universe . in creating samples of lyman-@xmath0 statistics , the solid angle on the sky",
    "subtended and length of spectra generated by the region add further weighting .",
    ".initial conditions used in this work .",
    "[ cols=\"<,<,^ , < , < , < , < \" , ]     [ table ]    we describe results for two cosmological models : standard cdm , normalised to @xmath51 with @xmath52 , @xmath53 ; cobe - normalised cdm+@xmath2 , with @xmath54 , @xmath55 and @xmath56 ( shape parameter @xmath57 and tilt @xmath58 , which gives a theory in agreement with the shape of the observed large scale power spectrum , see figure  1 of bw ) .",
    "we required that @xmath59 at @xmath60 and the number of baryons in the simulation volume to be the same in both models .",
    "to analyse our simulations we produce artificial spectra , with signal to noise of 100 and 5  kms@xmath7 pixels .",
    "we sample a regular spatial grid of lines of sight running along the three axial directions through our simulations .",
    "a typical line of sight is @xmath3500 km@xmath61 long and a single simulation sample @xmath62 km@xmath61 at z=3 .",
    "we fit voigt profiles using an automated profile fitting program , designed to emulate the methods employed by observers .",
    "the program identifies each group of lines as a region in the spectrum where the flux drops below 98% of the continuum .",
    "@xmath63 minimization is used to fit first one line , then two lines and so on . the number of lines that produces the lowest _",
    "reduced_-@xmath64 is used .",
    "@xmath65 is the number of degrees of freedom remaining for the fit , estimated as 1 per 2 pixels in the line group region minus 3 for each line used in the fit . in practice",
    "a line group rarely needs more than 6 lines for a good fit .",
    "the left panels show the dramatic effect of varying @xmath45 and hence the shear field .",
    "the filamentary structure is greatly enhanced in even slightly overdense regions .",
    "this has important repercussions in the types and numbers of ly@xmath0 absorption lines produced , as shown in the bottom left panel of figure  [ fnhi ] .",
    "simulating overdense regions or voids like these is not possible in a periodic box of a similar size , because the density averaged over the box must remain equal to the universal mean value . even for significantly larger boxes",
    "this is a problem .    comparing the cdm and cdm+@xmath2 runs ( top left and right panels in figure  [ crosssection ] respectively )",
    ", it can be seen that the flatter spectrum in the cdm+@xmath2 case makes the filaments more prominent and the dwarf galaxies less so , but without it having a major impact on the @xmath66 frequency curve .",
    "the difference in normalisation is due to the width in redshift of the simulation volume in each cosmology , @xmath67 .",
    "the high resolution size is @xmath68=5 mpc , comoving , in all simulations .",
    "dividing by the ratio of @xmath69 at z=3 moves the cdm+@xmath2 curve down by 0.09 on the top right panel of figure  [ fnhi ] .",
    "the left hand panels of figure  [ fnhi ] demonstrate that an appropriate fixed choice of @xmath70 can reproduce the observed statistics very well .",
    "we have statistically combined 5 cdm simulations to effectively produce a good sample of the universe that includes rarer regions .",
    "the advantage of this over a single large simulation is great resolution and importance sampling .",
    "the contribution of different regions is apparent .",
    "the voids , @xmath71 , cause a lowering of the curve , especially at low column depths .",
    "the results of a low resolution run ( half that of the standard ones ) are shown represented by crosses in the top right panel of figure  [ fnhi ] .",
    "though it underpredicts the low column lines , the high column lines are overpredicted relative to our higher resolution runs : limited resolution mimicks heating by `` puffing '' up the cores of cold lumps out to greater sizes and thus gives higher cross sections .    in the top right panel of figure  [ fnhi ]",
    "we demonstrate that attempts to renormalise simulations with inappropriate values of the ionizing flux will fail to give the correct frequency of @xmath66 .",
    "the curves of interest are the cdm line with a fixed uv history and the scaled low uv points ( triangles ) .",
    "these simulations are otherwise identical and have been processed with a fixed value of @xmath72 .",
    "what _ does _ scale fairly well is the continuum depression , @xmath73 , shown in the right panel of figure  [ uvda ] .",
    "@xmath73 is defined at the mean value of @xmath74 for a spectral region .",
    "this is because the dominant contributors to the optical depth are lines with @xmath75 , resulting from barely overdense material for which the uv flux history is less important .",
    "the past history of the uv flux is important for the formation of dense gaseous clumps , as illustrated in the top left and centre right panels of figure  [ crosssection ] ; the same uv flux was applied for the post - processing analysis , but the simulation shown in the centre right panel experienced a low uv flux during its evolution ( curve ( 2 ) in figure  [ uvda ] ) .",
    "applying a different flux in post - processing the calculation can of course have no effect on the density distribution and thus can not compensate for a different history .    subtracting a power law , derived from the @xcite low end slope , from the @xmath76 curve of figure  [ fnhi ] reveals interesting features in the data .",
    "if the bumps at @xmath77 and @xmath78 ( where self shielding of the uv flux starts to become important ) are real , they may allow simulations to finely discriminate between parameter choices .",
    "the data appear to follow a power law slope of 1.9 in the range @xmath79@xmath80 , which our runs with fixed flux reproduce and those with low uv flux at early times do not .",
    "this is also apparent in the results of @xcite who apply a uv flux that slowly increases with redshift .",
    "simulations that calculate the uv flux history ( @xcite , @xcite ) perform fairly well , suggesting that a more detailed self - consistent treatment could produce a strong result .",
    "the excess of intermediate column lines seen for the low uv simulations may be due to unrealistically low energy input at early times ; specifically there should be input from early stars .",
    "we are testing this hypothesis using a uv flux history similar to curve ( 3 ) in figure  [ uvda ] .",
    "star formation and supernova feedback would also inhibit the formation of the extremely dense , cool clumps associated with this excess . we are now incorporating these processes using a general chemical evolution code .",
    "_ we have illustrated that the lyman alpha forest is a sensitive probe of the conditions that operated at @xmath81 to @xmath82 .",
    "it is clear that we must produce a comprehensive sample if we are to deliver reliable predictions to the observers of the clouds .",
    "finding forest observables that allow us to separate the influence of primordial power spectrum shape and amplitude , cosmological parameters such as @xmath83 , @xmath84 , @xmath85 , @xmath86 and @xmath87 , the ionization history and local energy injection from galaxies ( feedback ) will be a challenge to the growing group of cloud simulators , in close collaboration with the observers of the forest .",
    "nonetheless it is clear that the basic model ( whether cdm or cdm+@xmath2 ) with @xmath88 at @xmath4 provides a rather good fit to the data .",
    "_    support from the canadian institute for advanced research and nserc is gratefully acknowledged .",
    "we would like to thank john lattanzio and joe monaghan , who were involved in the early phases of this project , using an sph - multigrid code of earlier vintage ."
  ],
  "abstract_text": [
    "<S> our understanding of the lyman-@xmath0 forest has received a great boost with the advent of the keck telescope and large 3d hydrodynamical simulations . </S>",
    "<S> we present new simulations using the sph technique with a p@xmath1 mg ( particle - particle particle - multigrid ) non - periodic gravity solver . </S>",
    "<S> our method employs a high resolution ( 1 kpc ) inner volume , essential for capturing the complex gas physics , a larger low resolution volume , essential for correct larger scale tidal fields and a self - consistently applied , uniform tidal field to model the influence of ultra long waves . </S>",
    "<S> we include a photoionizing uv flux and relevant atomic cooling processes . </S>",
    "<S> we use constrained field realisations to probe a selection of environments and construct a statistical sample representative of the wider universe . </S>",
    "<S> we generate artificial lyman-@xmath0 spectra and fit voigt profiles . </S>",
    "<S> we examine the importance of ( 1 ) the photoionizing flux level and history , ( 2 ) tidal environment and ( 3 ) differing cosmologies , including cdm and cdm+@xmath2 . with an appropriate choice for the uv flux , we find that the data is fit quite well if the rms density contrast is @xmath3 1 at @xmath4 on galaxy scales . </S>"
  ]
}