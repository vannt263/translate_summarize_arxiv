{
  "article_text": [
    "computer simulation has been established as a technique for studying the systems with many degrees of freedom such as spin glasses and proteins .",
    "the difficulties in studying such systems stem from the fact that the conformational space is very large and there exist a huge number of local minimum energy states . for studying interesting phenomena or calculating quantities such as the transition of states or the free energy of the system ,",
    "a global sampling of the conformational space and uniform sampling on energy space is desired .",
    "canonical simulations at high temperatures realize the global sampling but low energy states are poorly sampled . at low temperatures",
    ", simulations can sample low energy states but the global search is difficult . in order to overcome these difficulties , many generalized - ensemble algorithms have been developed such as the multicanonical algorithm  @xcite and the replica exchange method ( rem )  @xcite .    the multicanonical method is based on artificial weight factor by which a simulation realizes a flat energy histogram .",
    "this weight factor is not known _ a priori _ and has to be determined by iterating simulations and estimations .",
    "if the value of the weight factor is partially too large or small , then it causes to disturb a random walk in energy space .",
    "therefore , the multicanonical weight factor needs to be fairly accurate .",
    "however , obtaining an accurate weight factor is often difficult and requires a great deal of expertise . in rem",
    ", a number of non - interacting replicas of the original system at different temperatures are simulated independently and simultaneously .",
    "every few steps the temperatures of pairs of replicas are exchanged , subject to a detailed balance condition . as the system size increases , however , the required number of replicas also greatly increases .",
    "in such a huge simulation system , it takes an unrealistically long cpu time for a replica to traverse the entire temperature range .",
    "wang and landau  @xcite proposed a simulation method to sample conformational space efficiently . in their method",
    "( hereafter referred to as the wl method ) , the weight factor is automatically estimated while the multicanonical simulation is performed .",
    "this method is originally based on a monte carlo ( mc ) algorithm .    in this paper , we focus on efficient sampling over the conformational space of an all - atom model of protein . molecular dynamics ( md ) and mc are the standard techniques for all atom protein simulations",
    ". it is recognized that the sampling efficiency of the mc method is comparable , or sometimes superior to md for liquid simulations . in protein simulations , however , md shows about 1.5 times better sampling efficiency  @xcite .",
    "this difference is attributed to the inertia force term in md , which does not exist in mc .",
    "recently , md with the wl method was applied to simulations of solutions  @xcite in which the original wl algorithm was applied to md simulations in a straightforward manner . as we mention in detail later",
    ", the simple application of the wl method to md does not work well for a protein system for a number of reasons .",
    "first , in the multicanonical md or related methods such as the wl md , not only the density of states but its derivative are required . in the wl method , the density of states is rugged , so that its derivative is of poor accuracy .",
    "second , as the wl method realizes quick random walk in energy space then for a polymer such as a protein , temperature changes occur in a time scale shorter than is necessary for a change of the structure of the whole molecule .",
    "eventually it takes a long time for a meaningful structural change to occur . in this paper",
    ", we present techniques for implementing an efficient wl md method to circumvent these problems .",
    "this paper is organized as follows .",
    "we describe a detailed formulation of the wang - landau molecular dynamics ( wlmd ) method in sec . [",
    "sec : method ] . in sec .",
    "[ sec : model ] , we introduce the model system for the present study , the met - enkephalin , a 5-residue peptide , and the trp - cage , a 20-residue protein .",
    "next , we compare the sampling efficiency of the current method with that of the replica exchange md ( remd ) method in sec . [",
    "sec : result ] .",
    "wang and landau have developed a very powerful mc simulation technique for efficiently sampling conformational space . in their method , the transition probability from energy @xmath0 to @xmath1 is given by @xmath2 where @xmath3 is the density of states .",
    "this is the same as in the standard multicanonical mc method .",
    "since @xmath3 is not known _ a priori _ , one has to determine it by some means . in conventional multicanonical simulations , it is determined by iterating short preliminary simulations using @xmath4 where @xmath5 and @xmath6 are the density of states and the histogram in the @xmath7th simulation , respectively , and @xmath8 is a set of allowed energy levels .",
    "what is unique of the wl method resides in the scheme for updating @xmath3 .",
    "when an energy level , @xmath9 , is visited at the time step , @xmath7 , the existing @xmath3 is modified by a modification factor @xmath10 , i. e. , @xmath11 for a given energy , @xmath12 , if @xmath5 is smaller than the true density of state , @xmath3 , the energy state @xmath12 is sampled intensively so that @xmath5 is updated to approach the true value , @xmath3 . on the contrary , if @xmath13 , the sampling of the energy state , @xmath12 , is suppressed and other energy states are extensively sampled . although @xmath3 is unknown at the very beginning of simulation , @xmath5 approaches the true value quickly and automatically . since @xmath5 is updated every step , it is possible for the system to escape local minima in a very short period of time .",
    "we apply the wl method to md simulations .",
    "the equation of motion for the multicanonical md is given by  @xcite @xmath14 where @xmath15 , @xmath16 , and @xmath17 represent mass , velocity , and coordinate of @xmath18th atom , and the inverse temperature , @xmath19 ( @xmath20 is the boltzmann constant ) , with the simulation temperature , @xmath21 .",
    "@xmath22 is referred to as the multicanonical temperature . in a straightforward application of the wl method to md",
    ", the density of states , @xmath3 , could be estimated according to eq .",
    "( [ eq : wang - landau ] ) .",
    "however , such a simple method does not work well in practice .",
    "it is necessary to accurately estimate not only @xmath3 but also its derivative @xmath22 . in numerical calculation , @xmath3 is divided into bins , and each bin is given a discrete value .",
    "in general , the estimate of @xmath22 is of low accuracy due to the ruggedness between neighboring bins . in order to smooth this ruggedness ,",
    "we approximate canonical energy distribution at various temperatures by the gaussian distribution and combine them with the weighted histogram method ( wham )  @xcite for updating @xmath5 and estimating the multicanonical temperature .    in the canonical ensemble at an inverse temperature , @xmath23 ,",
    "the distribution of energy @xmath12 is written as @xmath24 where @xmath3 is the density of states and @xmath25 the last equation [ eq . ( [ eq : single2 ] ) ] defines the partition function .",
    "the canonical distribution usually has a bell - like shape . at the energy",
    "@xmath26 corresponding to the peak of the distribution , the equation @xmath27 is satisfied .",
    "this is rewritten as @xmath28 by comparing eqs .",
    "( [ eq : betamu ] ) and ( [ eq : canopeak ] ) , one can see that the multicanonical temperature @xmath22 at energy @xmath12 is the temperature of a canonical ensemble whose peak energy is @xmath12 . if @xmath26 and @xmath3 are known , it is possible to solve eq .",
    "( [ eq : canopeak ] ) for @xmath23 . however , it is difficult to evaluate @xmath29 since @xmath30 is inaccurate if @xmath3 is estimated from a simulation ( which is the case in practice ) . on the other hand ,",
    "it is relatively easy to estimate the thermal average @xmath31 as @xmath32 where @xmath5 is the density of states estimated from the simulation .",
    "the variance of the energy can be estimated in the same manner , @xmath33 hansmann  @xcite suggested using @xmath31 instead of @xmath29 . in his prescription , @xmath22 is determined from the table of @xmath31 .",
    "the canonical distribution of the systems that we are interested in is similar to the gaussian distribution . using @xmath31 and the deviation @xmath34 at @xmath23 , we assume that the following approximation holds : @xmath35 which can be rearranged , using eqs .",
    "( [ eq : canodis ] ) and ( [ eq : gaussdis ] ) , to @xmath36 it is possible to calculate the right - hand side from a canonical simulation , but the accuracy decrease as @xmath37 increases . in order to keep the accuracy for a wide energy range , @xmath3",
    "is estimated by using the wham technique with a number of temperatures , @xmath38 where @xmath39 and @xmath40 s are appropriate weight factors ( see below ) . @xmath3 and @xmath41 can be obtained by solving eqs .",
    "( [ eq : wham1 ] ) and ( [ eq : wham2 ] ) iteratively . from eqs .",
    "( [ eq : gaussdis ] ) and ( [ eq : wham1 ] ) , it follows that @xmath42 which can be further reduced , by using eq .",
    "( [ eq : canodis ] ) , to @xmath43 both @xmath3 and @xmath41 vanish in this expression .",
    "we use this equation for estimating the multicanonical temperatures .",
    "note that eq .",
    "( [ eq : gaussdis ] ) is not exact .",
    "this implies that our method may not be suitable for a system with doubly peaked distribution , for example .",
    "nevertheless , such an error should be small if we use a sufficiently large number of temperatures .    in a wlmd simulation",
    ", we need to specify the lowest and highest temperatures for the system ( @xmath44 and @xmath45 , respectively ) , and prepare energy bins and temperatures corresponding to each energy bin .",
    "the initial estimate of the density of states , @xmath46 , is obtained as follows .",
    "we first run a short ( say , 100 steps ) canonical md simulation at the inverse temperature @xmath45 ( corresponding to the highest temperature ) , and calculate the average and variance of the energy from this short simulation .",
    "we then apply eqs .",
    "( [ eq : single ] ) and ( [ eq : single2 ] ) iteratively , which yields the initial estimate @xmath46 .",
    "the rest of a wlmd proceeds as follows .",
    "+ ( 1 ) set @xmath47 and @xmath48 .",
    "\\(2 ) a canonical md is performed for a very short period of time ( say , 100 steps ) according to eq .",
    "( [ eq : motion1 ] ) with fixed @xmath49 . during this period ,",
    "the time average @xmath50 and the variance @xmath51 of the energy are estimated . the gaussian energy distribution based on these values",
    "is denoted @xmath52 .",
    "let the energy value of the last step of this canonical simulation be @xmath53 .",
    "let @xmath54 and @xmath55 .",
    "\\(3 ) the average and variance of energy at the inverse temperature @xmath45 are estimated using all the energy values that have been visited with @xmath56 up to this time step . using these values ,",
    "the gaussian distribution @xmath57 is obtained .",
    "similarly , the gaussian distribution at @xmath44 , @xmath58 , is estimated .",
    "@xmath58 is set to zero if the simulation has never visited this temperature .",
    "\\(4 ) for each energy bin , @xmath59 , calculate the corresponding temperature @xmath60 according to eq .",
    "( [ eq : dlogn2 ] ) with the gaussians @xmath61 , @xmath57 , @xmath58 , and @xmath52 .",
    "the weight @xmath40 is set to 1 except for @xmath52 for which the weight is set to a specified modification factor @xmath62 [ this factor corresponds to @xmath63 in eq .",
    "( [ eq : wang - landau ] ) ] .",
    "( note that , for @xmath64 , @xmath61 is not yet defined and is set to zero . )",
    "\\(5 ) using the temperatures @xmath65 obtained in the previous step , calculate , from eqs .",
    "( [ eq : average ] ) and ( [ eq : variance ] ) as well as the current estimate of the density of states @xmath5 , the average and variance , @xmath66 and @xmath67 , and the gaussian distribution , @xmath68 .",
    "\\(6 ) iterate steps 4 and 5 until all the @xmath65 s converge .",
    "\\(7 ) update the density of states using eqs .",
    "( [ eq : wham1 ] ) and ( [ eq : wham2 ] ) and the gaussians to obtain the next estimate @xmath69 .",
    "\\(8 ) estimate the next multicanonical temperature @xmath70 according to eq .",
    "( [ eq : dlogn2 ] ) at the energy of the last canonical md step , @xmath53 .",
    "if @xmath71 or @xmath72 , @xmath70 is evaluated at @xmath73 or @xmath74 , respectively .",
    "this is necessary for a stable simulation .",
    "\\(9 ) set @xmath75 and go back to step 2 .",
    "+ in order to avoid numerical overflow in the calculation of @xmath69 in the step 7 , we limit the summation in eq .",
    "( [ eq : wham1 ] ) to those inverse temperatures @xmath65 satisfying @xmath76 recently , kim _ et al . _",
    "@xcite developed the method to determine the multicanonical temperature automatically .",
    "the notable points in their method are the short period update and adding the derivative of histogram to the multicanonical temperature .",
    "while their method is different from our method in the way to update the histogram , the idea of the short term update is common .",
    "they use the finite difference of raw data ( energy histogram ) for update .",
    "since the present method uses the gaussian mask and the wham technique to estimate the density of states and its derivative , it is expected to be more robust .      when we first applied the above method to a protein system , a random walk in the energy space was readily realized .",
    "however , the protein conformation changed very little in the whole process .",
    "it was found that the energy change predominantly originated from the bond length and the bond angle deviations . as a result ,",
    "the bond energy almost solely contributed to @xmath3 . to avoid this artifact , we separated the bond interaction from the non - bond interaction , and applied the multicanonical ensemble only to the non - bond interaction .",
    "the energies of bond and non - bond interactions are written as @xmath77 and @xmath78 , respectively , i. e. , @xmath79 using @xmath77 and @xmath78 , density of state is represented as @xmath80 .",
    "the equations of motion with the @xmath80 is now expressed as @xmath81 with @xmath82 then it is possible to give different temperatures for bond and non - bond interactions . in order to suppress the motion due to the bond interaction and to facilitate global conformational changes ,",
    "@xmath83 is fixed whereas @xmath84 is varied according to the wlmd scheme from a low to high temperature .",
    "we carried out simulations using a customized version of the presto molecular simulation package  @xcite , in which the all - atom version of the amber force - field parameters ( c96 )  @xcite was used .",
    "we used the met - enkephalin [ protein data bank ( pdb ) code : 1plw ; amino acid sequence : yggfm ] as a model system for checking the correctness of the method .",
    "eight independent wlmd simulations were conducted for 10 ns ( 80 ns in total ) , starting from the extended conformation with the temperature ranging between 200 and 700 k. no solvent effect was included but a distance - dependent dielectric constant was used ( @xmath85 , where @xmath86 is the inter - atomic distance ) .",
    "the density of states was updated every 1000 steps ( unit time step was 0.5 fs ) .",
    "the objective of these simulations is to check whether the present method can yield a plausible density of states compared to the remd simulations .",
    "therefore , the modification factor for the density of states was initially set to @xmath87 which was decreased by the factor of 0.8 every 1 ns .",
    "this procedure is analogous to that proposed originally by wang and landau @xcite .    for comparison",
    ", we carried out an extensive remd simulation with eight replicas , each running 100 ns .",
    "temperatures ranged between 200 and 700 k , and were distributed exponentially .",
    "replica - exchanges were tried every 20 steps .",
    "the average exchange acceptance ratio was approximately @xmath88% . for the calculation of principal components and density of states , those conformations generated during the first 1 ns of the simulation",
    "were discarded .",
    "the protein used for demonstrating the efficiency of the method is a 20-residue protein , trp - cage ( pdb code : 1l2y ; amino acid sequence : nlyiq wlkdg gpssg rpppg ) , which was derived from the c - terminal fragments of a 39-residue exendin-4 peptide  @xcite .",
    "physicochemical studies showed that trp - cage folds spontaneously and cooperatively .",
    "it contains a short @xmath89-helix in residues 2 - 9 , a @xmath90-helix in residues 11 - 14 , and a c - terminal polyproline ii helix to pack against the central tryptophan ( trp-6 ) .",
    "several simulation studies on this trp - cage have already been published  @xcite .",
    "an implicit solvent model  @xcite was used with the dielectric constant was set equal to @xmath91 , where @xmath86 is distance between point charges .",
    "furthermore , we employed an empirical dihedral angle potential which was developed in our laboratory  @xcite .",
    "the simulations were started from an extended conformation .",
    "the unit time step was set to 0.5 fs , and we ran md simulations for 10 ns .",
    "we set @xmath92 k , @xmath93 k , @xmath94 k , the multicanonical temperature was updated every 400 steps ( 0.2 ps ) .",
    "the number of energy bins was set to 256 .",
    "we carried out 24 runs with different random initial velocities .",
    "the modification factor for the density of states is set such that @xmath95 .    for comparison ,",
    "an alternative simulation with remd was performed under the equivalent condition , that is , 24 replicas each running for 10 ns .",
    "temperatures exponentially varied from 200 to 700 k and swapping was carried out every 400 steps .",
    "the average acceptance ratio was @xmath96% .",
    "the run time required for one wlmd simulation was 184193 h ( 189 h on average ) on an intel pentium iii ( 1ghz ) processor .",
    "for remd , the run time per cpu was 207 h. wlmd seems slightly more efficient than remd in spite of the extra effort required for the wham iterations .",
    "the lower computational efficiency of remd is caused by the synchronization process which is necessary for different replicas to exchange .",
    "in order to check the correctness of wlmd , we first compare the results of wlmd and remd for a small peptide met - enkephalin . figure [ fig : enk - pca ]",
    "shows that the conformational spaces sampled by the two methods closely overlap , indicating that wlmd can sample the conformational space as widely as remd .",
    "however , it should be noted that 10 times more points are plotted for remd than wlmd : if we plot the same number of points , the remd result looks much more sparse .",
    "[ sec : result ]        for a wlmd simulation to work at all , good estimate of the density of states should be obtained as the simulation proceeds .",
    "we compare the density of states obtained by eight wlmd simulations with that obtained by a long remd simulation in fig .",
    "[ fig : enk - dos ] .",
    "again , we see that the results of the two methods agree quite well .",
    "a close examination reveals that wlmd slightly overestimates the density of low energy ( @xmath97 kcal / mol ) states ( fig .",
    "[ fig : enk - dos ] , lower part ) compared to remd .",
    "nevertheless , such difference is of a small fraction ( @xmath98 ) of the entire range of the density of states .",
    "since wlmd is simply a method to efficiently estimate the density of states for multicanonical md , we can always further refine the density of states using an ordinary multicanonical md procedure .              in order to check",
    "if the density of states is still accurately estimated for this bigger protein , we plotted the density of states obtained by three independent wlmd simulations ( fig .",
    "[ fig : dos ] ) .",
    "although we can not know the exact density of states , the consistency among these estimates of density of states suggests that the present scheme is at least self - consistent . in order to calculate thermodynamic quantities , one should gradually decrease the value of @xmath99 toward zero and set @xmath100 for the production run , as suggested by wang and landau  @xcite . in the present example with trp - cage ,",
    "our purpose is efficient sampling of low energy conformations but not calculating thermodynamic quantities so that @xmath99 is always kept greater than 0 .",
    "we next compare the ( non - bond ) energy trajectories of wlmd and remd simulations ( fig .",
    "[ fig : ene ] ) .",
    "we selected three trajectories arbitrarily from 24 simulations or replicas .",
    "it is immediately apparent that the wlmd trajectories ( fig .",
    "[ fig : ene ] , upper panel ) traverse a wide range of energy very rapidly compared to the remd trajectories ( fig .",
    "[ fig : ene ] , lower panel ) .",
    "in fact , one trajectory of remd seems to be trapped in a local minimum .",
    "a similar trend is also observed for temperature trajectories ( fig .",
    "[ fig : temp ] ) .",
    "the multicanonical temperature changes very rapidly but smoothly in wlmd ( fig .",
    "[ fig : temp ] , upper panel ) while the temperature changes rather slowly in remd ( fig .",
    "[ fig : temp ] , lower panel ) .",
    "one reason for such a behavior in wlmd is that the multicanonical temperature can vary continuously between @xmath101 ( 200 k ) and @xmath102 ( 700 k ) as it is determined by eq .",
    "( [ eq : dlogn2 ] ) . on the other hand , in remd",
    ", there are only 24 allowed and fixed temperatures if we use 24 replicas so that the acceptance ratio of temperature swapping can be arbitrarily small .",
    "although rapid traversal of a wide energy or temperature range is necessary , it is not sufficient for efficient sampling of conformational space .",
    "in fact , rapid energy change may be associated with very localized motions such as bond stretching . in order to examine the sampling efficiency of wlmd",
    ", we first checked the trajectories of the coordinate root mean square deviation ( crms ) from the native structure of trp - cage ( fig .",
    "[ fig : crms ] ) . as expected , crms changes more slowly ( fig .",
    "[ fig : crms ] ) than might be suggested by the energy trajectories ( fig .",
    "[ fig : ene ] ) in both wlmd and remd .",
    "nevertheless , wlmd is much less prone to being trapped in local minima and conformations appear to keep moving compared to remd .",
    "a similar trend was observed for the trajectories of end - to - end distance ( not shown ) .      in order to visualize the efficiency of conformational sampling",
    ", we carried out principal component analysis  @xcite . out of 1200000 conformations",
    "saved during 24 wlmd simulations , 50000 lowest energy conformations were extracted , to which 50000 lowest energy conformations out of 1200000 saved during the remd simulation ( 24 replicas ) were added .",
    "these 100000 conformations were used to define the principal axes .",
    "conformations sampled in wlmd and remd were then projected onto the principal space ( fig .",
    "[ fig : pca ] ) .",
    "it is apparent from fig .",
    "[ fig : pca ] that wlmd covers much more space than remd . to confirm this observation more quantitatively , we divided the space spanned by the first three principal axes ( each from -25 to 25  ) into small cells ( 1.0 @xmath103 1.0 @xmath103 1.0 @xmath104 ) , and counted the number of occupied cells .",
    "out of 125000 cells , 4335 ( including the cell containing the native structure ) were occupied by wlmd while only 1174 by remd and the native structure cell was not occupied .",
    "therefore , in terms of the cell occupancy , wlmd is 3.7 times more efficient than remd for sampling protein conformations .        in summary",
    ", we formulated the wang - landau molecular dynamics method .",
    "in so doing , we adopted the gaussian masking for updating the density of states , and developed a technique to reliably estimate the multicanonical temperature . it was shown that the wlmd method indeed samples conformational space of a protein more efficiently than the replica exchange md method . apart from the inaccuracy in the molecular force field",
    ", the present method will serve as a useful tool for simulation studies of protein molecules ."
  ],
  "abstract_text": [
    "<S> multicanonical molecular dynamics ( md ) is a powerful technique for sampling conformations on rugged potential surfaces such as protein . </S>",
    "<S> however , it is notoriously difficult to estimate the multicanonical temperature effectively . </S>",
    "<S> wang and landau developed a convenient method for estimating the density of states based on a multicanonical monte carlo method . in their method , the density of states is calculated autonomously during a simulation . in this paper , we develop a set of techniques to effectively apply the wang - landau method to md simulations . in the multicanonical md , </S>",
    "<S> the estimation of the derivative of the density of states is critical . in order to estimate it accurately , </S>",
    "<S> we devise two original improvements . </S>",
    "<S> first , the correction for the density of states is made smooth by using the gaussian distribution obtained by a short canonical simulation . </S>",
    "<S> second , an approximation is applied to the derivative , which is based on the gaussian distribution and the multiple weighted histogram technique . </S>",
    "<S> a test of this method was performed with small polypeptides , met - enkephalin and trp - cage , and it is demonstrated that wang - landau md is consistent with replica exchange md but can sample much larger conformational space . </S>"
  ]
}