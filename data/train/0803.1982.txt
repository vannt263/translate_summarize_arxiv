{
  "article_text": [
    "quantum mechanics has been successfully used to describe experimental phenomena for close to a century . however , it was only much more recently that the idea of using quantum mechanical evolution to process information was conceived  @xcite .",
    "this is revolutionizing the way we view the complexity of information processing .",
    "in particular , quantum information processors ( qips ) may be able to perform certain computational tasks , such as factoring large integers or simulating quantum systems , exponentially faster than classical computers @xcite .",
    "one of the difficulties in applying quantum mechanics to information processing is that quantum effects are extremely delicate and difficult to detect .",
    "the system must be well isolated from the environment , or decoherence will quickly destroy the quantum superpositions and entanglement that the qips exploit and reduce the system to a probabilistic classical state .",
    "it has only recently been realized that it is possible to efficiently encode quantum information to protect it from decoherence .",
    "as a result , the control and isolation of quantum information systems need not be arbitrarily good .",
    "it suffices for the computationally relevant error probability per basic quantum gate to be @xmath0 @xcite and with extreme overheads @xmath1 @xcite . in practice",
    ", satisfying this error bound requires balancing the needs for strong interactions to be able to apply quantum gates and good isolation to ensure that the quantum systems evolve coherently .",
    "moreover , in the context of building a large - scale qip , the classical resources required to implement the desired control must scale efficiently with the size of the qip .",
    "this is an extraordinary challenge , but the prospect of being able to exploit the power of quantum computing has provided the impetus to explore many technologies in the pursuit of a scalable quantum computer @xcite .    one such technology is based on nuclear magnetic resonance phenomena .",
    "nuclear magnetic resonance ( nmr ) phenomena are well described by quantum mechanics , and the control technology developed over its more than 50 years of existence has allowed for sophisticated pulse sequences that exploit the full range of the system dynamics . by leveraging nmr engineering experience and its well developed control technology , nmr has been used to realize many of the first demonstrations of quantum algorithms .    as nmr quantum information experiments increased in complexity ,",
    "so did the quantum control methods used . in the first implementations of quantum algorithms on small molecules , such as the deutsch - jozsa @xcite and grover s @xcite algorithms , preparation of the three - qubit ghz state @xcite and the implementation of the three - qubit quantum error correction code@xcite ,",
    "the control sequences were written entirely by hand based on well - known techniques from nmr and heuristic optimization . in later more sophisticated experiments on larger molecules , such as a seven - qubit cat state experiment and the implementation of the five - qubit code @xcite",
    ", the control sequences were still based on standard nmr radio frequency ( rf ) shaped pulses , but , due to the large number of degrees of freedom , a computer compiler was built to systematically , numerically optimize the pulse sequences . using similar techniques ,",
    "vandersypen et al . demonstrated the simplest instance of shor s factoring algorithm on a seven - qubit register @xcite . at the same time , cory s group at mit developed a different control approach based on the design of numerically optimized high - fidelity pulses that refocussed all unwanted interactions @xcite .",
    "more recently , both approaches have been used to control a 13-qubit system @xcite .",
    "the availability of long - lasting coherence and high - fidelity control makes nmr an ideal test - bed for quantum control techniques . in this paper",
    "we present two approaches to nmr quantum control that we have used .",
    "the first approach applies optimal - control theory to achieve high fidelity and robust control over small spin systems .",
    "the second is a scalable technique , where a well chosen approximation allows for imperfect control elements to be placed in sequence while controlling the error buildup .",
    "we show how the two methods can be combined to apply optimal control methods to larger systems in a scalable manner .",
    "the sequence of basic operations needed to implement an algorithm can be described in the circuit model of quantum computing . in this model the sequence of operations is given by a quantum circuit , a time - ordered sequence of quantum gates to be applied to the quantum systems .",
    "a typical quantum circuit has three main components : initialization , implementation of the unitary evolution that realizes the desired algorithm , and a final measurement to obtain the algorithm s output . in this paper",
    "we focus on the unitary evolution .",
    "we show how one can modulate the available control parameters to implement a universal set of quantum gates and how one can combine the gates to realize a complete quantum circuit .",
    "the paper is divided into the following sections : in section [ nmr_section ] the relevant aspects of the system and principles of control in an nmr qip are explained ; in section [ control_section ] we describe both control methods : an optimal control method based on an exact description of the system , and an efficient approximation scheme based on subsystems ; in section [ merge_section ] , we explain why they form a basis for a flexible and general framework to design practical quantum control methods .",
    "more details about the technical implementations of such methods for liquid state nmr can be found in the appendices .",
    "the basic principles of nmr are available in many textbooks @xcite , and their use in quantum computing has been reviewed in @xcite . here we discuss only the relevant basics . in liquid - state nmr",
    "the qubits are the spin-@xmath2 nuclei of a molecule .",
    "the number of spin-@xmath2 nuclei in a molecule gives the number of qubits .",
    "a sample with approximately @xmath3 identical molecules dissolved in a liquid solvent is placed in a large static magnetic field that provides the quantization axis and is conventionally taken to define the z axis .",
    "ideally all the molecules experience the same fields and so undergo identical evolution .",
    "since each molecule realizes a qip , this is an example of ensemble quantum computing .",
    "the nuclei interact with the static field , which produces a zeeman splitting between the two energy levels ( spin aligned or anti - aligned with the static field ) , giving the hamiltonian @xmath4 where @xmath5 is the gyromagnetic ratio of nucleus @xmath6 , @xmath7 is the strength of the magnetic field and @xmath8 is the pauli operator @xmath9 ( similarly , we use @xmath10/@xmath11 for @xmath12/@xmath13 ) .",
    "we always assume that the static magnetic field is along the z direction .",
    "it is convenient to use a semi - classical picture of the spins precessing about the magnetic field with an angular frequency @xmath14 .",
    "the larmor frequency is @xmath15 and is on the order of tens to hundreds of megahertz in today s superconducting magnets . in the absence of symmetry of the molecule ,",
    "each nuclear site in the molecule experiences a different electronic environment .",
    "the electron cloud partially shields the nuclei from the applied magnetic field so that the local magnetic field experienced by each nucleus is slightly different .",
    "this gives each nucleus a slightly different larmor frequency called the chemical shift , denoted by @xmath16 in eq .",
    "[ hzeeman ] .",
    "this separation in frequency space(of a few kilohertz ) is what allows different nuclei of the same nuclear species to be distinguished and selectively addressed .",
    "different nuclear species have different gyromagnetic ratios , so their larmor frequencies are usually widely separated by tens or hundreds of megahertz in frequency space .",
    "the contrast between the homonuclear and heteronuclear frequency ranges leads to huge differences in the timescales for homonuclear and heteronuclear control .",
    "it is only when a purely heteronuclear system is considered that single - qubit rotations are much faster ( approximately three orders of magnitude ) than two - qubit coupling gates .",
    "the nuclear spins interact with each other by two mechanisms : a direct spin - spin coupling via the dipolar interaction , and an indirect electron - mediated interaction , the j coupling . in the liquid state ,",
    "the rapid tumbling motion of the molecules averages out the dipolar coupling between the nuclei , both within the same molecule and ( to a good approximation ) between molecules @xcite .",
    "this leaves only the weaker and isotropic j coupling .",
    "the coupling hamiltonian between spins @xmath6 and @xmath17 is of an exchange form , @xmath18 since this coupling is mediated by the electrons binding the two nuclei , there is no j coupling between different molecules .",
    "if the difference in the resonant frequencies of the two nuclei involved is much greater than the coupling strength , then a secular approximation is valid .",
    "the off - diagonal terms can be ignored and the coupling is reduced to the weak - coupling ising form where the @xmath19 and @xmath20 terms are dropped : @xmath21    this approximation is always valid for heteronuclear systems and for the majority of the homonuclear systems considered for a qip . with this approximation ,",
    "all the terms in the internal hamiltonian commute , and tracking the system during periods of free evolution becomes particularly straightforward .",
    "this can be used to simplify the control schemes .",
    "the internal hamiltonian enables one - qubit rotations about the @xmath8 axis and two - qubit controlled-@xmath8 gates .",
    "however , for universal control , one - qubit rotations about another axis are needed .",
    "these are implemented by control - field hamiltonians . by applying an rf field",
    ", we can induce transitions between energy levels whose energy difference is resonant with the field . in the rotating frame",
    "the control field hamiltonian can be described as , @xmath22 up to the hardware limitations of the spectrometer , it is possible to arbitrarily control the amplitude ( @xmath23 , the nutation or rabi frequency ) and phase ( @xmath24 ) . with a standard liquid - state probe ,",
    "nutation frequencies of up to 30 khz are feasible .",
    "if the rf frequency is on resonance with the spins larmor frequency , then in the rotating frame the contribution to the hamiltonian of the static magnetic field along @xmath8 vanishes and the rf field looks like a constant field about an axis @xmath24 from the x - axis .",
    "hence , the spins precess about this axis at a frequency @xmath23 , and we can induce rotations about any axis in the @xmath10-@xmath11 plane in the rotating frame . in the pulsing frequency rotating frame , spins whose transition frequencies are off - resonant have an additional @xmath8 component in their hamiltonian , and the effective rotation axis will be the vector sum of the rf field and the off - resonant @xmath8 field .",
    "if the spins are far off - resonance then this rotation axis will be close to the z axis and the spins will not be rotated into the plane .",
    "however , the spins are not completely unaffected and pick up an additional phase or z rotation known as the transient bloch - seigert shift @xcite , which must be accounted for ( see section [ compilercontrol ] ) .",
    "the combination of the internal hamiltonian and the control fields gives universal control i.e. it is possible to implement any unitary transformation on the system .",
    "the challenge is to find the control fields as a function of time that drive the system through the desired evolution .",
    "some subtle effects arise from the fact that nmr qip s utilize an ensemble of quantum systems , rather than a single one , as is commonly assumed in quantum computing :    _ state preparation .",
    "_ in the liquid state the sample temperature can not vary much from room temperature .",
    "even with the very strong fields available , the zeeman energy splitting is much smaller than the available thermal energy and so the thermal state is highly mixed , with only a very small ( @xmath25 ) bias towards the ground state .",
    "the thermal state for a single spin is of the form @xmath26 in nmr quantum information processing experiments , the evolution of the state is to a good approximation unital , meaning that the identity component of the state is preserved ( the experiment time is much shorter than @xmath27 ) .",
    "in addition , the identity component is not directly observable because it has no effect on sample magnetization . for our purposes",
    ", it is sufficient to observe the dynamics of the second component of the state , called the deviation density matrix , which is pure .",
    "this component is called the pseudo - pure state .",
    "the idea of and method for preparing pseudo - pure states can be generalized to multiple qubits : @xmath28 where @xmath29 describes a pure quantum state on @xmath30 qubits and @xmath31 is the dimension of the hilbert space .",
    "unfortunately , the standard preparation methods @xcite are inefficient and @xmath32 decays exponentially with the number of qubits in a pseudo - pure state .",
    "thus the signal quickly disappears in the noise , and this limits the use of traditional nmr methods to manipulate quantum information to less than approximately 15 qubits .",
    "furthermore , because the initial state is so highly mixed , the states are provably separable , and a classical model , although somewhat contrived , can describe the results of nmr experiments @xcite .",
    "nevertheless , one can still use pseudo - pure states to explore quantum control issues .",
    "it should be emphatically stated that the efficiency of pseudo - pure states is not a fundamental limitation to the scalability of an nmr qip , and scalable , efficient algorithms have been developed to create pure states with nmr @xcite .",
    "these algorithms are not yet practical with current technology in liquid state nmr .",
    "however , they are practical in other magnetic resonance systems where high polarization is achievable , such as solid - state nmr @xcite , electron - spin resonance ( esr ) @xcite .",
    "we expect the control techniques developed here to readily transfer to these systems .",
    "_ measurement .",
    "_ in standard implementations of a qip , the ability to make single - qubit projective measurements is assumed .",
    "however , in the ensemble framework of nmr we can measure only the expectation value of certain observables averaged over the ensemble of identical systems .",
    "fortunately , most quantum algorithms can be modified to fit this framework @xcite .",
    "furthermore , the ensemble measurement is also sufficient to measure the fidelity of any unitary transformation applied to an initial pseudo - pure state .",
    "this makes it possible to benchmark control processes .",
    "there are some subtle issues regarding the coarseness of the measurement , the size of the system and how much the system is disturbed by the measurement @xcite ; however , for typical samples these can be ignored .    despite the problems due to the ensemble nature of the system , the resulting hamiltonian and control principles are applicable to many different systems .",
    "examples include other spin systems , such as solid - state nmr @xcite , or electron - nuclear systems in organic crystals @xcite , quantum dots @xcite or nitrogen - vacancy centers in diamond @xcite , and even non - spin systems governed by effective spin hamiltonians such as superconducting qubits @xcite .",
    "the control principles developed should therefore find application to these other , potentially more practically scalable systems .",
    "standard approaches to control in nmr spin systems are well known @xcite and have permeated other quantum information processing technologies . in the present work we describe two different approaches taken by our group to design and optimize pulse sequences , each addressing an important issue . first , given an accurate model of our system and apparatus , we can design high - fidelity control sequences by simulation and optimization .",
    "second , we make some well chosen approximations to our model to design accurate and robust sequences",
    "_ efficiently_.      by applying standard optimal control theory methods to the problem of controlling quantum systems , high fidelity control sequences can be found .",
    "the basic idea is to let some form of numerical optimization search for the pulse shape of the control fields that exactly implements the desired unitary gate : the pulse will internally refocus all unwanted couplings and bloch - siegert shifts .",
    "although we are left with little physical intuition about the path the system is driven through , very high fidelity control sequences are possible in a variety of situations where simple shaped pulses do not work .",
    "two concerns with this powerful approach are its efficiency and practicality . in principle , since universal control is available , there exists a pulse shape that will implement any desired unitary .",
    "however , finding it requires a simulation of the full system which limits the optimal control approach to systems of less than approximately 8 qubits on a desktop computer and 10 qubits on larger clusters @xcite .",
    "in addition , the pulse may require many hundreds if not thousands of time steps that need to be optimized , giving a large parameter space over which to optimize .",
    "a huge search space combined with expensive function evaluations leads to a difficult optimization problem .",
    "quantum optimal control is well studied in the context of driving chemical reactions with shaped laser pulses .",
    "however , this addresses a state transformation problem , whereas for quantum computing purposes , it is necessary to solve the much more difficult problem of realizing a unitary transformation that works for all input states .",
    "the total hamiltonian is the sum of the rf control hamiltonians and the internal hamiltonian , @xmath33 as discussed in section [ nmr_section ] , the internal hamiltonian is of the form @xmath34 .",
    "this gives us z rotations and controlled z evolution , which is the basis of the two qubit gates .",
    "the internal hamiltonian is time - independent and its parameters can be obtained with high precision from standard spectroscopic techniques and fitting software .",
    "the free parameters that can be used to control the evolution of the system are in the rf  hamiltonian : @xmath35 , where @xmath36 lists the spins sensitive to the rf pulse , which is the spins of the same nuclear species .",
    "the optimal control problem is to find the values of the control fields @xmath37 that ensure that the total unitary evolution is as close as possible to the desired one .",
    "there will be many control field sequences that give the correct evolution , but to minimize decoherence the time - optimal solution is preferred . for relatively simple systems with two or three qubits , and with a few potentially unrealistic assumptions on the experimentally available control , this can be solved analytically @xcite .",
    "however , for bigger systems it is necessary to use a numerical optimization procedure to find control sequences .",
    "the algorithms start with a random guess for the control fields , which are discretized at a sufficiently high resolution in time .",
    "the system is then simulated and the unitary @xmath38 is obtained .",
    "this is then compared with the goal unitary @xmath39 through a well chosen fitness function .",
    "since global phases are irrelevant , a suitable choice that gives freedom in the global phase is the hilbert - schmidt ( hs ) fidelity , defined by @xmath40 this fidelity measure can be seen as an imperfect motion reversal and is linearly related to the average fidelity , defined as the squared state overlap between the ideal output state and the simulated output state averaged ( haar measure ) over all input states @xcite . given this fitness function , any numerical optimization scheme can be used to search for the highest - fidelity pulse .",
    "the first work on numerically optimizing rf control for an nmr qip was performed by cory s group at mit @xcite .",
    "their approach was to simplify both the search space and the function evaluations by using pulses consisting of blocks of constant amplitude , phase and frequency .",
    "approximately 10 to 30 of these blocks were combined into a composite pulse called a `` strongly modulating pulse '' .",
    "thus there were only 10 to 30 time steps to evaluate and compose in order to compute the overall unitary .",
    "the parameter space of the composite pulse was then searched with a simplex search algorithm .",
    "this method successfully found high fidelity pulses that were experimentally implemented in a variety of quantum information processing demonstrations @xcite .",
    "however , the search method is not optimal and has difficulty finding high fidelity pulses for more than four qubits .",
    "in addition , the pulses have sharp discontinuities between the blocks that lead to transient effects in pulse generation and in the nmr probe resonant circuit and suboptimal experimental implementation .",
    "a substantial improvement was made by applying standard optimal control theory to the problem .",
    "this resulted in the gradient ascent pulse engineering or grape algorithm of khaneja et al .",
    "if a pulse is digitized the control fields become a sequence @xmath41 where @xmath42 $ ] denotes the @xmath43 timestep .",
    "the unitary for each timestep is , @xmath44.\\ ] ] where @xmath45 for example and @xmath46 is the length of the timestep . to first order",
    ", the derivative of the unitary propagator with respect to the control fields can be evaluated without finite differencing or another matrix exponential as , @xmath47 where we require @xmath48 for the approximate derivative to be accurate . the total unitary for the pulse",
    "can be calculated as the product of each timestep unitary , @xmath49 the gradient of the fitness function eq .",
    "[ tracefidelity ] can now be explicitly calculated as @xmath50\\end{gathered}\\ ] ] thus by storing the forwards and backward propagation of the unitary and substituting eq .",
    "[ approxgradient ] into eq .",
    "[ totalgradient ] , gradient information about the fitness function can be obtained without finite differencing or recalculation of the entire propagator .",
    "the gradient leads to a much more efficient search determining the direction in which the control parameters should be moved to improve the fitness function .",
    "this information can be used by simple steepest - ascent hill - climbing algorithm to optimize the pulse .",
    "an important advantage of the grape method is that the more efficient search method allows the pulse to be defined with many more points so that smooth  spectrometer friendly \" pulses can be obtained , as explained in the appendix . our code is based on the published algorithm @xcite with some modifications also discussed in the appendix .",
    "it finds high fidelity ( above @xmath51 hs fidelity including experimental inhomogeneities in rf and static fields ) in a number of systems with up to seven qubits .",
    "the optimization method finds only local maximum in the search space so that better pulses may exist , but the local maxima found have proven to be sufficient for high fidelity control .",
    "the numerically optimized control sequences drive the system through a complicated and nonintuitive path . as a result it is possible that small errors in the model of the system and apparatus could lead to a much lower fidelity pulse .",
    "fortunately , the optimization method can be modified so that the pulses are robust in the presence of static inhomogeneities in the system and the control hamiltonian .",
    "for example , due to mismatch of magnetic susceptibilities of the sample and sample tube and imperfect shimming , the static magnetic field varies across the sample .",
    "we can demand that the control sequence implement the same desired unitary for a range of static magnetic fields , so that the pulse is robust given the corresponding variations in the larmor frequencies .",
    "another practical example is that the amplitude of the control fields may not be perfectly calibrated and again vary across the sample because of coil geometry , so we can also demand that our pulse implement the desired unitary for a range of control powers .",
    "robustness with respect to both these effects for a particular seven - qubit pulse is shown in figure [ grapepulse ] .      because the classical cost of simulating the full quantum dynamics grows exponentially with the system size , it is not possible to apply optimal control in larger systems .",
    "some well - chosen simplifications and approximations must be made to the model .",
    "the control sequence is constructed from simple predefined but imperfect building blocks ( for example standard frequency selective pulses ) .",
    "the blocks are then systematically put together to form a pulse sequence ensuring that the errors in the building blocks do not build up excessively as the sequence progresses .",
    "it is possible to efficiently design such sequences only if we judiciously simplify the model and take into account only the largest and first order errors in the blocks .",
    "typical building blocks are one - qubit unitaries that involve selectively rotating one spin . if the spins have distinct resonant frequencies , this corresponds to frequency selective pulses .",
    "the problem of obtaining such pulses has of course had much attention in the long history of nmr .",
    "the most successful approach has been to use shaped pulses , and a huge variety of increasingly complicated shaped pulses have been developed with various bandwidths , excitation profiles ( tipping angles as a function of chemical shift ) and robustness to experimental imperfections @xcite . in the linear regime",
    "the excitation profile in frequency space of a pulse is related to its fourier transform . as one would expect , the longer the pulse , the more selective it is in frequency space .",
    "furthermore , one can tailor the excitation profile by shaping the pulse .",
    "for example , a gaussian shaped pulse has a gaussian shaped excitation profile .",
    "thus , given the internal hamiltonian of the molecule , it is straightforward to design a set of pulses for single spin rotations .",
    "an example of a pulse and its excitation profile is shown in figure [ simplepulse ] .     a portion of a single - scan carbon thermal spectrum of the fully labeled molecule trans - crotonic acid at 16.4 t , showing three qubits , @xmath52,@xmath53 and @xmath54 .",
    "see appendix for details of the molecule . by modulating the amplitude of a pulse sent at a frequency resonant with the chemical shift of @xmath52",
    "we can selectively rotate @xmath52 .",
    "shown in the inset is a truncated inverse secant pulse of @xmath55 .",
    "overlain on the spectrum is the excitation profile of a 90 degree pulse and the inversion profile of a 180 degree pulse of this length .",
    "the profiles are expressed as a fraction of the goal tipping angles .",
    "it is clear that the pulse affects @xmath52 but does not significantly excite @xmath53 or @xmath54 . as discussed in the text , @xmath53 and @xmath54 experience a transient bloch - siegert effect , which must be accounted for in a quantum computing experiment . ]    for many nmr spectroscopy experiments , it is sufficient to consider only the excitation profile , but for quantum computing purposes we need to accurately keep track of all the effects of the pulse . in particular there are off - resonant and coupling effects .",
    "although the resonant frequency of a particular spin may be far outside the excitation bandwidth of a selective pulse intended for another spin ( so that there is no rotation about an axis in the plane ) , there still is a substantial phase evolution from the off - resonant or transient bloch - siegert effect @xcite . to first order ,",
    "the effect of an off - resonant pulse is to shift the resonant frequency of the spins , inducing an extra phase rotation .",
    "for example , a spin 3 khz off - resonant from a 1 ms pulse that performs a 180 degree rotation on an on - resonance spin will experience an additional phase shift of @xmath56 degrees .",
    "this is non - negligible and must be accounted for .",
    "secondly , the couplings still evolve during the pulse ( which may have a duration comparable to @xmath57 ) , and the coupling hamiltonians do not commute with the rf hamiltonian . particularly for long pulses on spins that have strong couplings ,",
    "there are substantial deviations from the ideal action of the pulse .",
    "these can be partially countered by self - refocussing pulses @xcite , such as the hermite pulses ( see table [ subsystem_table ] ) .",
    "both the off - resonant and the coupling effects can be accounted for through a decomposition scheme where the imperfections are unravelled from the simulated pulse and represented as phase and coupling errors before and after the ideal pulse . a similar method with symmetric negative time evolution was presented in ref .",
    "the method described here is more accurate and general .",
    "the simulated pulse is modeled by the following decomposition : @xmath58 this decomposition resolves the simulated pulse into the ideal unitary operator sandwiched on either side by z rotations ( to account for the bloch - seigert shift and the chemical shift evolution during the pulse ) and zz couplings to account for the couplings that occurred during the pulse ( see fig .",
    "[ pulsedecomp ] ) .",
    "this model for the pre- and post - error terms does not work for arbitrary pulses , but in the relevant case of spin selective pulses , it will capture most of the first order dynamics .",
    "all couplings that do not involve the target qubit are trivial to extract and can be perfectly reversed . for couplings involving the target qubit ,",
    "the control fields modulate the coupling necessitating a numerical optimization of the error terms . for 90 degree pulses zz pre- and post - error terms can represent coupling evolution during the pulse .",
    "however , for 180 degree pulses , because the ideal pulse should refocus the couplings , zz error terms are not sufficient , and self - refocussing pulses are desirable .",
    "since the pre- and post - error terms do not commute with the control hamiltonian , the decomposition faithfully represents the true dynamics only when @xmath59 where @xmath46 is the length of the pulse and @xmath60 is the strongest coupling .",
    "the optimal parameters for the z and zz `` error '' terms can be determined by use of an efficient procedure .",
    "a set of single - spin and pairs - of - spins simulations is sufficient to capture off - resonant effects and some first - order coupling contributions , since the hamiltonian contains only one- and two - body terms , and all the pre- and post - error terms commute with each other .",
    "the simulations are of a fixed one- or two - qubit size , hence there are only @xmath61 simulations to perform . from these simulations ,",
    "the optimal pre- and post - error terms are determined by use of a numerical search .",
    "see appendix [ pulsecompiler_appendix ] for a detailed description of how to obtain the error terms .",
    "the key points are that an efficient approximate description of the pulse is possible , and that the deviations from the ideal pulse in the decomposition can be corrected later as part of a larger pulse sequence by means of periods of free evolution and individual rotating frames adjustments ( as shown in fig .",
    "[ pulsedecomp ] ) .",
    "an example decomposition of the pulse implementing a 90 degree rotation on @xmath52 ( shown in figure [ simplepulse ] ) is given in table [ pulsedecomp_numerical ] .",
    "the representation of the pulse as eq .",
    "[ decomp ] has an average fidelity of 99.96  % with respect to a simulation of the full system dynamics .",
    "c_4 + m & 0.0 & 0.41 & -0.04 & 7.95 & -0.41 & 0.41 & -0.06 + h_1 & 0.41 & 0.0 & 0.98 & 0.18 & 11.32 & -0.11 & 0.41 + h_2 & -0.04 & 0.98 & 0.0 & 0.34 & 0.0 & 10.07 & 0.24 + c_1 & 7.95 & 0.18 & 0.34 & 1.72 & 2.98 & 0.09 & 0.44 + c_2 & -0.41 & 11.32 & 0.0 & 3.00 & 0.0 & 4.95 & 0.09 + c_3 & 0.41 & -0.11 & 10.07 & 0.09 & 4.95 & 7.12 & 4.40 + c_4 & -0.06 & 0.41 & 0.24 & 0.44 & 0.09 & 4.40 & -6.92 +        these pulse representations give us the building blocks for one - qubit gates .",
    "two - qubit gates are achieved by periods of free evolution during which the coupling terms in the hamiltonian evolve . if a coupling term is allowed to evolve for a time @xmath57 , then a controlled-@xmath8 gate ( up to one - qubit @xmath8 rotations ) is implemented between the coupled spins .",
    "all undesired couplings must be refocussed with 180 degree pulses . putting the pulses and delays together to form a pulse sequence that implements",
    "a desired algorithm has been automated through the use of a sequence compiler .",
    "several further simplifications are used .",
    "individual rotating frames are defined for each spin .",
    "just as the rotating frame for a single spin eliminates the zeeman term in the hamiltonian , individual rotating frames eliminate all chemical shift terms from the internal hamiltonian .",
    "this could be implemented by a transmitter dedicated to each spin and rotating at that spin s chemical shift , but this is experimentally prohibitive .",
    "the phase evolution caused by the chemical shift term in the hamiltonian is simply a z rotation , and this evolution can be tracked with respect to some fixed reference frame .",
    "similarly the evolution of the transmitter at its frequency can be tracked , and when a pulse is required , the pulse phase is adjusted to obtain the correct phase in the spin s rotating frame .",
    "similarly the observation phase must also be calculated and adjusted .",
    "this tracking greatly simplifies the pulse sequences by eliminating the need to refocus the chemical shift evolution .",
    "it also allows z rotations to be implemented instantaneously and with high precision through a frame change  that is by simply modifying the phases of subsequent pulses and potentially the observation phase .",
    "thus it is worth transforming the quantum circuits to use z rotations preferentially .",
    "a drawback of individual reference frames is that it is not always possible for the pulse to have the correct phase in two different reference frames , so global pulses that nontrivially affect multiple spins are not always feasible , and hence they must be decomposed into a sequence of simpler pulses .",
    "the coupling gates are implemented with delay periods to allow the desired couplings to evolve .",
    "unfortunately , the undesired couplings also evolve .",
    "the unwanted couplings can be refocussed with a series of 180 degree pulses by means of standard , efficient algorithms @xcite . however , it is not necessary to refocus all unwanted couplings during every evolution period .",
    "it is sufficient to track the evolution , and refocus it only when needed @xcite .",
    "single qubit gates and the z and zz error terms in their representation commute with the terms of the internal hamiltonian , except those involving the target nucleus .",
    "therefore , we can let couplings evolve through many gates and need to arrive at the goal coupling only when a noncommuting pulse affects either member of the coupling pair .",
    "the refocussing scheme can be made more efficient by the use of  virtual 180s \" .",
    "conventionally , every time a refocussing pulse is used , a second refocussing pulse must be applied at the end of the period to cancel the first one and ensure that all the spins return to the their initial state , so that the computation is unaffected by the refocussing . while the first refocussing pulse is needed to physically refocus the coupling , the second one can be made virtual and not physically applied .",
    "the virtual 180 can be implemented by pushing it forwards or backwards ( the virtual 180 can be created before or after the physically applied refocussing pulse ) through the pulse sequence until it can be merged with another pulse . if it is another refocussing pulse , then it can cancel with the virtual 180 created at that refocussing event . or , if it is a computational pulse , the virtual 180 can be absorbed by modifying the phase of the pulse and introducing a frame change ( see appendix [ pulsecompiler_appendix ] for details ) .",
    "all these techniques are combined into an efficient pulse compiler .",
    "the pulse compiler loads the information about the internal hamiltonian , the effective pulse decompositions ( eq . [ decomp ] ) and the desired pulse sequence with a suitable refocussing scheme .",
    "it can then optimize the delays between the pulses , the timing of the refocussing pulses and the phases of the pulses to best implement the desired sequence . at any point in the sequence , phase or coupling error terms from the decomposition",
    "are compensated for by use of the phase tracking calculations or are absorbed in the refocusing scheme ( see figure [ pulsedecomp ] ) .",
    "this allows for long pulse sequences to be constructed while avoiding excessive error accumulation . for further details of the sequence compiler ,",
    "see appendix [ sequencecompiler_appendix ] .",
    "the sequence compiler can optimize only the delays between events and it must be given a suitable sequence of refocussing pulses to start with .",
    "designing an exact refocusing scheme may require many refocusing pulses , and each refocussing pulse takes a finite duration and introduces its own errors .",
    "in some cases , the theoretical control accuracy gained by bringing the calculated @xmath62 coupling evolution closer to the goal is lost due to decoherence and pulse imperfections .",
    "there is therefore a trade - off between the theoretical accuracy of the control scheme and its duration and number of refocussing pulses . in practice",
    "this entails designing a good refocussing scheme and optimizing it .",
    "the total error from unrefocussed @xmath62 couplings can be calculated and determined whether it is acceptably low . if not , additional refocussing pulses are added to correct the errors and improve the optimization .",
    "in addition , a penalty function prevents the optimization from using excessive time for refocussing schemes .",
    "each method described above has its strengths and limitations . optimal control theory can give robust and time - optimal control sequences for strongly coupled systems , where conventional pulse design fails .",
    "however , the method is intrinsically unscalable and is limited in the number of spins it can handle in practice .",
    "the number of qubits currently available in nmr already pushes these methods to their limit .",
    "the pre- and post - error method with pairwise simulations provides a scalable , efficient solution to the design of control sequences but is limited by the properties of the pre - defined pulses , particularly the fidelity of the error - term representation . on long pulses targeting spins with strong couplings , the decomposition of eq .",
    "[ decomp ] may fail to give a high fidelity representation of the pulse , and better pulse engineering is needed . here",
    "we show how the two methods can be combined to allow optimal control techniques to be applied to larger systems .",
    "a more computer science approach to scaling up optimal control techniques also utilizing subsystems has also been considered in ref .",
    "@xcite .",
    "the idea is to consider only a subsystem of the qip s qubits in designing the optimal control pulse . in nmr ,",
    "particularly relevant subsystems consist of the spins of the same nuclear type , for example , all protons . a pulse that is designed on the subsystem without consideration for the other spins does not implement the desired unitary on the whole system . to determine the effect of the pulse on the entire system , pair - wise simulations between the subsystem and the other spins are performed .",
    "these simulations capture and track both the evolution of the internal hamiltonian on the other spins , and deviations due to couplings between the subsystems .",
    "the pulse on the full system can then be represented in the same manner as described above by adding pre- and post - error terms , which can be accounted for during the optimization of the refocusing scheme and the phase tracking calculations as part of a larger sequence .",
    "there is no guarantee that the pulse decomposition with the error terms will give a high fidelity representation .",
    "the optimal control pulse drives the subsystem through some complicated trajectory , and it may not be possible to extract the effect of the couplings to other systems as simple zz errors before and after the ideal gate . in general this",
    "decomposition works well for short one - qubit unitaries but breaks down for two - qubit gates taking more time .",
    "however , whereas the pulse is optimized considering only subsystem 1 , it can be made robust to the effect of couplings to other subsystems by incoherently averaging over the states of the other subsystems as described in ref .",
    "this is equivalent to making the pulse robust against larmor frequency variations .",
    "thus , averaging over all possible states is not necessary , and making the pulse robust to frequency shifts from the sum of the j couplings is sufficient .",
    "this will make the pulse more difficult to find , but the obtained pulse will have a higher fidelity representation on the full system .        to illustrate the basic ideas , consider a register of qubits organized into subsystem blocks , as illustrated in figure [ subsystems ] .",
    "take for example the first subsystem of fig .",
    "[ subsystems ] consisting of three proton spins , where the other subsystems consist of other nuclear types .",
    "it may be that to effect a one - qubit rotation on , say , qubit @xmath63 by a simple method requires a very long selective pulse , because the chemical shift difference to the nearest spin is small .",
    "then , the effect of the couplings can not be taken into account by only @xmath8 and @xmath62 pre- and post - error terms , because @xmath64 is too large .",
    "however , one can find an optimal control pulse that considers only subsystem 1 and that refocusses the intra - subsystem couplings while implementing the ideal gate",
    ". perturbations due to inter - subsystem couplings and the internal evolution of the other subsystems during the pulse can then be taken into account by pre- and post - error terms .",
    "the utility of such a scheme can be demonstrated on the crotonic acid molecule ( see appendix [ crotonic_appendix ] for details of the molecule ) , where the natural subsystems are the three proton qubits and and the four carbon qubits . because of their refocussing properties , 180 degree rotations are more difficult to find and to represent .",
    "however 180 degree rotations can easily be found for all the spins by use of this subsystem technique and then represented through subsystem pair - wise simulations .",
    "for example a pulse on methyl is found by considering only the proton subsystem , and then , to determine the dynamics on the full system , simulations are performed on individual and pairs of the five subystems , @xmath65 , @xmath66 ; @xmath67 ; @xmath68 ; and @xmath69 .",
    "the results are summarized in table [ subsystem_table ] and compared with the pulse representations of standard pulse designs .",
    "the crotonic acid molecule is not ideally suited to this approach because of the large couplings between subystems ; nevertheless , the subystem grape pulses have similar or better fidelities than standard pulses of a similar or longer length .",
    "in particular the grape pulses have consistently high fidelities even where other pulses , such as selective pulses on @xmath70 and @xmath71 , break down .",
    "furthermore , since the clock of decoherence is always ticking , shorter pulses usually perform better .",
    ".[subsystem_table ] table comparing the performance of optimal control pulses constructed and corrected by using the subsystem approach ( last column ) to more conventional shaped pulses ( first two columns ) .",
    "all pulses implement one - qubit 180 degree rotations ( see text ) .",
    "the crotonic acid molecule is not ideally suited to the subystem approach because of the large couplings between subystems .",
    "this required all the pulses except for that on @xmath72 to be made robust to the other subystems with incoherent averaging over chemical shifts of the j coupling strength in order to obtain high fidelities .",
    "[ cols=\"^,^,^,^,^,^,^ \" , ]     finding an optimal control pulse on the entire system such as in figure [ grapepulse ] may give shorter , higher fidelity pulses than the subsystem with the error term strategy described above .",
    "this is because the optimal control method is able to exploit more control handles .",
    "however , optimization over the full system is too difficult for large systems , whereas the methods used to find the pulses in table [ subsystem_table ] are scalable if the subsystems used are kept small .",
    "the combination of optimal control and use of pre- and post - error terms is therefore well suited for designing control sequence for the class of qips made of subsystems with strong internal couplings but weaker coupling between subystems .",
    "liquid state nmr has led to the development of numerical methods to find accurate pulses to control simple systems robust against errors from perturbations in fields , amplitudes and other spins . together with methods for accounting for or refocussing phases and couplings",
    ", we have a basis to _ efficiently _ design _ robust _ control sequences for qips made of weakly coupled blocks of qubits . within blocks ,",
    "faster dynamics are handled by pulses obtained by optimal control methods .",
    "pre- and post - error term analysis can be performed on such pulses to evaluate perturbations due to the other blocks . on",
    "can then combine such pulses to efficiently construct a sequence to implement the desired algorithm .",
    "phase tracking and numerical optimization of the refocussing scheme allows us to correct pulse errors , thus avoiding error accumulation , and to implement gates between different subystems .",
    "the combined model of control presented here can be applied to other ising type models .",
    "a potential example is in superconducting qubits , where the hamiltonian can be written in a pseudo - spin form that is similar to the liquid state nmr hamiltonian @xcite .",
    "it is conceivable that the control fields would affect only a small number of qubits at a time , thus ensuring the presence of natural subystems to use for optimal control .",
    "we thank k. rose for his assistance in coding the sequence compiler , m. silva and d. kribbs for the algorithm to deterministically compute the worst case fidelity , and m. ditty for technical assistance with the spectrometer .",
    "we also greatly appreciate the helpful discussions with d. cory and the editorial help of bryan eastin and scott glancy .",
    "this work was funded by arda , aro and nserc .",
    "contributions to this work by nist , an agency of the us government , are not subject to copyright laws .",
    "47 natexlab#1#1bibnamefont #",
    "1#1bibfnamefont # 1#1citenamefont # 1#1url # 1`#1`urlprefix[2]#2 [ 2][]#2    , * * , ( ) .    ,",
    "_ _ ( , ) .    ,",
    "* * , ( ) .    , * * , ( ) .    * * ( ) .    , , , , ,",
    "* * , ( ) .    , , , * * , ( ) .",
    ", , , , , * * , ( ) .    , , , , , , , , * * , ( ) .    , , , , * * , ( ) .    , , , , * * , ( ) .    , , , , , , * * , ( ) .    , , , , , , * * , ( ) .",
    ", , , , , , , , , , * * , ( pages  ) ( ) .    , _ _ , international series of monographs on chemistry ( , ) .",
    ", _ _ ( , ) .    , , , , , , , , , , ,",
    "* * , ( ) .    , * * , ( pages  ) ( ) .    , ph.d . thesis , ( ) .    , * * ( ) .    , * * , ( ) .    , , , * * , ( ) .    , * * , ( ) .    , , , * * , ( ) .    , * * , ( ) .    , , , , ,",
    "* * , ( ) .    , in _ _",
    "( , , ) , pp . , isbn .    , , , , , , , * * , ( pages  ) ( ) .    , * * , ( pages  ) ( ) .    , * * , ( pages  ) ( ) .    , , , , , , ,",
    ", * * , ( ) .    , , , , , , , , * * , ( ) .    , pp . ( ) , http://www.arxiv.org/abs/cond-mat/0508729 .    , ,",
    ", , , in _ _ ( ) , pp . .    , , , , * * , ( pages  ) ( ) .    , , , * * , ( ) .    , * * , ( ) .    , , , , , * * , ( pages  ) ( ) .    , , , , , * * , ( ) .    , , , ,",
    "* * , ( pages  ) ( ) .    ,",
    "* * , ( ) .    , * * , ( ) .    , , ,",
    ", * * , ( ) .    , , , , * * , ( pages  ) ( ) .    , , , p. ( ) .",
    ", , , , , , , * * , ( ) .    , * * , ( ) .",
    "crotonic acid offers a total of seven qubits : two protons and the methyl group ( red ) and four @xmath73-labelled carbons ( blue ) .",
    "the methyl group consists of three magnetically equivalent protons that form spin-@xmath74 and spin-@xmath2 subspaces . with an appropriate pulse sequence we can select the spin-@xmath2 subspace and treat it as a qubit .",
    "the internal hamiltonian of the system is shown below .",
    "crotonic acid internal hamiltonian parameters as determined by spectral fitting in a 700 mhz spectrometer .",
    "diagonal elements give chemical shifts ( in hertz ) with respect to the base frequency for proton and carbon transmitters .",
    "the off - diagonal elements give j coupling terms also in hertz . ]",
    "the grape code developed at iqc is closely based on the search algorithm presented in ref .",
    "@xcite . here",
    "we emphasize only the specific modifications we have implemented that help to achieve high experimental fidelity .",
    "the parameters for the initial random guess have a significant impact on the success of the search and the type of pulse found . for good experimental implementation ,",
    "smoothly varying low power pulses are best .",
    "therefore the algorithm is initialized with a smooth low - power guess .",
    "for example , in a 250 point pulse every 25th point is random with a maximum range of @xmath75 of the maximum power available , and cubic splines are used to interpolate the rest of the points . for finding unitary gates , the fitness function is the hs fidelity defined in eq [ tracefidelity ] . for good experimental fidelity",
    "the pulse is made robust to variation in rf field strength and/or calibration errors by taking an average of the fitness function defined over a range of rf field strengths .",
    "a 3 point distribution at rf power multipliers of 0.95 , 1 and 1.05 gives good results .",
    "robustness to variation in internal hamiltonian parameters such as chemical shifts can also be put into the fitness function ; however , for typical liquid state linewidths the pulses found are more than sufficiently robust .",
    "this feature can also be used for incoherent averaging in the subsystem approach .",
    "the convergence of the search algorithm is dramatically improved by the use of conjugate gradient techniques .    to minimize decoherence",
    ", it is desirable to minimize the pulse duration .",
    "however , because we do not apriori know even approximately what this duration should be , it would take many optimizations for different durations to find the optimum .",
    "furthermore , the time optimal point may require unrealistically high powers or fast pulse variations .",
    "instead , we allow the length of time for each step of the pulse to vary and use timestep derivatives to converge quickly to a good pulse duration .",
    "a penalty function is added to limit the total time of the pulse and push the optimization towards shorter pulse times .    for high fidelity experimental control , smooth and slowly varying ",
    "spectrometer friendly \" pulses are ideal , although the desired criteria can be enforced in the search with more sophisticated techniques @xcite .",
    "these techniques require defining the pulse by many points .",
    "we have found a simple method to systematically find sufficiently smooth pulses for large systems , where defining pulses by many points is not feasible :    1 .",
    "find a high - fidelity pulse using relatively long time steps , e.g. @xmath76s .",
    "2 .   digitally smooth this pulse with shorter timesteps of , e.g. @xmath77s , making sure that the pulse bandwidth is within the system limitations .",
    "3 .   use this smoothed version of the pulse as an initial guess for the numerical optimization .",
    "there will be a small loss of fidelity from the smoothing .",
    "nevertheless , it will be a good starting point .",
    "4 .   if necessary , repeat the smoothing and optimization procedure .",
    "empirically we have found that the re - optimization of the pulse in the third step changes the pulse very little , and once the new optimized pulse is determined , it is still sufficiently smooth .",
    "it is also necessary to ensure that the beginning and end of the pulse go to zero to ensure a smooth experimental turn - on / off .",
    "this can be achieved with a penalty function that penalizes high powers at the beginning and the end .    in combining the two methods of control described in this paper",
    "we have discovered an additional method that can be used to reduce the time neded to find pulses on larger systems .",
    "this method provides a practical way to find certain types of pulses only on large systems , but it does not address scalability issues .",
    "if the system can be decomposed into possibly overlapping subsystems such that for each subsystem , the desired unitary operator factors into one acting on the subsystem and another acting on the complement , then we can find good pulses by defining the fitness function as a weighted sum of fitness functions for each subsystem .",
    "the subsystems must be defined so that the dominant dynamics of the system is captured .",
    "in particular , every strong coupling must be internal to at least one of the subsystems .",
    "we simulate each subsystem separately to reduce the simulation complexity .",
    "unlike the scalable sub - system approach discussed in section iv , the optimal control subystems will cover the entire system and the pulse is expected to implement the desired unitary on the full system without pre- or post - error terms .",
    "take as an example the crotonic acid system with seven qubits .",
    "the molecule is shown in figure [ croto_table ] .",
    "pulses implementing one - qubit rotations have the desired factorization property with respect to any subsystem . to capture the strong couplings",
    ", we use the following four overlapping subsystems : @xmath78 , @xmath79 , @xmath80 , and @xmath81 .",
    "@xmath72 is covered by two subsystems capturing its strongest couplings .",
    "if the pulse refocusses these strong couplings to @xmath82 and @xmath52 it is likely to also refocus weaker couplings to say @xmath54 without additional optimization . in general",
    "though , if the pulse performs the desired subystem unitaries with high fidelity there is no guarantee that the smaller unconsidered couplings and/or many - body effects will not give a much lower fidelity implementation on the full system .",
    "empirically however , we have found the constructed pulses work well on the full system , both for short one - qubit gates and for longer coupling gates .",
    "furthermore , it substantially speeds up finding pulses for the seven qubit system . the pulse shown if figure [ grapepulse ] was found with this method .",
    "it has 99.9 % fidelity averaged over the above subsystems and showed a 99.7 % fidelity on the entire seven qubit system .",
    "the efficient pre- and post - error term analysis described in section [ compilercontrol ] contains two steps : the first is to _ efficiently _ compute the relevant dynamics of the system under the rf pulse ; the second is to extract optimal pre- and post - error terms that are correctable and give a good representation of the simulated pulse .",
    "+ _ capture the relevant dynamics : _ consider an illustrative three spin system .",
    "spins 1 and 2 are of the same species , whereas spin 3 is different .",
    "the propagator @xmath83 of a pulse affecting spins 1 and 2 can be written as @xmath84 where the control and internal hamiltonian terms are defined as above .",
    "if the control fields are functions of time , the pulse must be discretized and integrated over many time steps .",
    "the dynamics of the system can be expanded into contributions of different coupling order .",
    "if coupling effects are ignored , then the zeroth - order @xmath85 can be computed by three independent single spin simulations as @xmath86    the effects of the coupling can then be added in a perturbative manner .",
    "the first step is to consider the effect of the couplings between pairs of spins or subsystems : couplings 1 - 2 , 2 - 3 and 1 - 3 are considered . by considering only pairs of spins , coherent indirect coupling effects are lost .",
    "for example , there is an extra effect on the dynamics of qubit 1 from the coupling to qubit 2 because qubit 2 is in turn affected by the coupling to qubit 3 .",
    "these higher order coupling effects can be neglected when coupling effects during the pulse are small . moreover , for soft selective pulses in the weak coupling approximation , many of the second - order contributions vanish because all the internal hamiltonians of the off - resonant spins commute with each other , so that in most cases , stopping at first order is sufficient to encompass all the relevant dynamics .",
    "if the pulse is found using optimal control theory rather than a pre - defined simple pulse shape , it may drive the system through a nonintuitive path that makes use of indirect coupling dynamics to achieve the desired unitary . therefore we need to perform a set of simulations between the subsystem defined for the optimal control and each of the other spins . for example , a grape pulse may be found by considering only the carbon subsystem . each pairwise simulation encompasses the carbon spins and one of the proton spins .",
    "the computational resources required are larger than for a simple spin pairwise simulation , but they still scale polynomially with the total register size , provided the subsystems are of constant size . + _",
    "search for the optimal error terms : _ from the efficient simulations of the previous paragraph , we need to determine the pre- and post - error terms surrounding the ideal operation .",
    "this is achieved through a simple numerical search optimizing the following fitness function : @xmath87 this compares the simulated unitary to its representation as the ideal unitary , restricted to the relevant qubits , sandwiched between the pre- and post - error terms .",
    "this fitness function is sensitive to global phase because we are considering only a subsystem , and so to be consistent when representing the gates on the full system , local phases matter . to extract the optimal error terms one can use a classical search algorithm .",
    "note that this search is performed on a relatively low - dimensional parameter space . for pulses designed for one qubit ,",
    "the single spin simulations require only two parameters for the phases in the error terms on this spin . in the pairwise simulations",
    "there are six parameters for the phases in the @xmath8 and @xmath62 error terms on the coupled spins .",
    "_ error term computation : _ for standard shaped pulses designed to act independently on one or more spins , the following procedure allows one to compute error terms for the pulse representation .    1 .",
    "perform single spin simulations including the rf control fields for each spin and optimize the z error terms ( with respect to the intended evolution on the spin ) to capture the effects of the chemical shift and the transient bloch - siegert effect .",
    "perform simulations of each pair of spins , including the pairwise coupling and the rf control fields .",
    "optimize the z and zz error terms with respect to the intended evolution on both spins . remove the contribution of the z error terms found in the first step from the ones found here ( by dividing the terms or subtracting the exponents ) to account for the fact that the simulation also accounts for the effects modeled in the first step . call these the `` incremental z error terms '' .",
    "3 .   determine the z error terms for each spin as the product of the terms found in the first step and the incremental terms from each pair - wise simulation involving this spin .",
    "the zz error terms are the ones found in the second step .    if the pulse is designed to have an independent action on a set of subsystems , the procedure needs to be modified by replacing the single - spin and pairwise simulations with single - subsystem and pairs - of - subsystems simulations .",
    "this requires optimizing both z and zz error terms for the single - subsystem simulations , and determining incremental contributions for the pair simulations by removing the contributions already obtained for spins and pairs internal to each subsystem .",
    "the sequence compiler was built to automate , as much as possible , the design of pulse sequences for an nmr qip .",
    "the compiler takes as one input the fixed information about the internal hamiltonian , namely the chemical shifts and j coupling values , and the error term information for the pulses obtained by optimal control and implementing the set of one - qubit rotations needed .",
    "the second input is a representation of a goal sequence of quantum evolutions that implements the desired algorithm or quantum network .",
    "the sequence compiler then determines delays between pulses so as to minimize the total error of the implementation compared to the intended evolution .",
    "the goal sequence is described with a purpose built language .",
    "here is an example of such a sequence :      this sequence requests a 90 degree rotation about the x - axis on @xmath72 followed by a zz90 ( equivalent to a controlled z gate up to single qubit z rotations ) coupling gate between @xmath72 and @xmath52 followed by a 90 degree one - qubit gate on @xmath52 and a final z rotation on @xmath53 . during the coupling period",
    "a `` floating '' refocussing pulse of 180 degrees about the y - axis is executed on c3 .",
    "the @ instructions specify state assumptions that may simplify the optimization .",
    "the output of the compiler is a pulse sequence that can be directly executed by the spectrometer .",
    "the compiler automates a number of the tasks discussed in section [ compilercontrol ] .",
    "* phase tracking : to avoid having to use one physical spectrometer channel per qubit , the compiler tracks the evolution of the nuclear rotating frames and the spectrometer channel frames throughout the computation .",
    "when a pulse about a certain axis is required for a nucleus , a simple calculation of the phase difference between the channel frame and the nuclear frame determines the phase at which the pulse should be sent in the channel frame to achieve a specific phase in the target nuclear frame . as noted above this freedom allows us to avoid having to refocus the chemical shifts at every step .",
    "it also allows free ( pulse - less ) implementation of z rotations by executing a frame change on the target nuclei and updating the phases of all subsequent pulses .",
    "in addition , the relative phase evolution of the nuclei and the observation channel are tracked and the observation phase is adjusted appropriately .",
    "the frequency changes can be implemented by either changing the transmitter frequency or phase ramping the pulse .",
    "the phase tracking calculations assume that the frequency change is phase coherent , but experimentally this is not always the case ( particularly for large frequency changes ) , and we have achieved more consistent results with phase ramping on our spectrometer .",
    "* state assumptions : in some algorithms the state of the system might be known at certain steps .",
    "for example , at the beginning of the algorithm we may know that a particular qubit is in the state @xmath88 or the maximally mixed state @xmath89 .",
    "this can simplify the refocussing and phase tracking calculations .",
    "for example , if two spins are in the maximally mixed state , the coupling between them has no effect and so does not need to be refocussed . if a qubit is in a pseudo - pure state then its coupling effect with the other spins is reduced to an additional z rotation , which can be accounted for with the phase tracking calculation .",
    "state assumptions are implemented by specifying the nuclear states after pulse commands , as shown in the example .",
    "the compiler also implements some elementary state update rules . *",
    "cancellation of _ virtual180s _ : a refocussing pulse refocusses the couplings as desired but also affects the computation . as discussed in the text , conventionally this has been avoided by placing refocussing pulses in pairs to ensure that the state of the refocussed spin is not changed . however",
    ", this second refocussing pulse can be considered a virtual 180 that does not have to be implemented physically . as such it can be implemented by absorbing it into the next operation , modifying this operation appropriately . using the notation @xmath90 to denote a rotation of @xmath91 about the axis an angle @xmath24 away from the x - axis in the x - y plane , the following rotations are equivalent : @xmath92 where we use matrix multiplication and trigonometric identities to determine @xmath93 and @xmath94 : @xmath95 that is , a 180 degree pulse at phase @xmath96 followed by a 90 degree pulse at phase @xmath97 is equivalent to a 90 degree pulse at phase @xmath98 followed by a rotation about the z axis of @xmath99 .",
    "since the z rotation comes for free as a frame change , we have eliminated the need to do the second 180 .",
    "the compiler keeps track of these _ virtual180s _ , which considerably simplifies writing pulse programs .",
    "the _ virtual180 _ can also be sent backwards through the pulse program in a similar manner and absorbed into a preceding pulse . in some cases",
    "this may help the refocussing scheme . *",
    "optimization of delays : the pulse sequence can be considered as a sequence of events ( computation and refocussing pulses ) with delays in between .",
    "the delays between pulses serve the dual purposes of allowing desired coupling gates to occur and also allowing time for refocussing unwanted coupling effects .",
    "the refocussing pulses change the direction in which the couplings are evolving , which can help reach the coupling goals . at the beginning of each event certain couplings",
    "must be at their goal values . in most cases , only those couplings that do not commute with the pulse s intended effect have a fixed goal target .",
    "other couplings are simply tracked until a fixed goal is required @xcite .",
    "the coupling evolution for each pair of spins is calculated at each event from both the coupling evolution during the delays and the coupling errors terms in the pulse representations . for those pairs that have a fixed target at this event the calculated coupling",
    "is compared to the goal .",
    "a euclidian distance function is defined as the sum squared error between the goal and actual couplings and is related to an estimate of fidelity loss for the whole sequence .",
    "optimizing the pulse sequence is now reduced to the task of optimizing the delays between each period .",
    "this is handled by a simple iterative optimization to minimize the total contribution to the distance function of the events bounding the delays .",
    "that is , the delays are individually optimized one by one , starting at the last one .",
    "after the first one is optimized , the sequential optimization starts again at the last one , repeating the process until the improvement is smaller than a threshold , or a goal distance is achieved .",
    "although effective , this optimization strategy is simplistic and easily gets trapped in local minima . it would be useful to develop strategies that optimize all delays together with a non - linear least - squares optimization and consider different distance functions such as maximal error ."
  ],
  "abstract_text": [
    "<S> in building a quantum information processor ( qip ) , the challenge is to coherently control a large quantum system well enough to perform an arbitrary quantum algorithm and to be able to correct errors induced by decoherence . </S>",
    "<S> nuclear magnetic resonance ( nmr ) qips offer an excellent test - bed on which to develop and benchmark tools and techniques to control quantum systems . two main issues to consider when designing control methods are accuracy and efficiency , for which two complementary approaches have been developed so far to control qubit registers with liquid - state nmr methods . </S>",
    "<S> the first applies optimal control theory to numerically optimize the control fields to implement unitary operations on low dimensional systems with high fidelity . </S>",
    "<S> the second technique is based on the efficient optimization of a sequence of imperfect control elements so that implementation of a full quantum algorithm is possible while minimizing error accumulation . </S>",
    "<S> this article summarizes our work in implementing both of these methods . </S>",
    "<S> furthermore , we show that taken together , they form a basis to design quantum - control methods for a block - architecture qip so that large system size is not a barrier to implementing optimal control techniques . </S>"
  ]
}