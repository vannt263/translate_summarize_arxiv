{
  "article_text": [
    "when @xmath0 are two asset price procsses , the basic spread option with maturity @xmath1 and strike @xmath2 is the contract that pays @xmath3 at time @xmath1 . from the risk - neutral expectation formula ,",
    "the time @xmath4 price of this option , assuming a constant interest rate @xmath5 , must be @xmath6\\ .\\label{rnpricing}\\ ] ]    the literature on applications of spread options is extensive , and is reviewed by carmona and durrleman @xcite who explore further applications of spread options beyond the case of equities modelled by geometric brownian motion , notably energy trading .",
    "for example , the `` crack spread '' is the difference between the prices of crude oil and natural gas .",
    "`` spark spreads '' refer to differences between the price of electricity and the price of fuel : options on spark spreads are widely used by power plant operators to optimize their revenue streams .",
    "energy pricing requires models with mean reversion and jumps very different from geometric brownian motion , and pricing spread options in such situations can be challenging .",
    "closed formulas for are known only for a limited set of cases . in the bachelier stock model , @xmath7 is an arithmetic brownian motion , and in this case has a black - scholes type formula for any @xmath8 . in the special case @xmath9",
    "when @xmath10 is geometric brownian motion , is given by the margrabe formula @xcite .",
    "in the important case where @xmath10 is geometric brownian motion and @xmath11 , no explicit pricing formula is known .",
    "therefore there is a long history of approximation methods .",
    "numerical integration methods , typically monte carlo based , are often employed .",
    "dempster and hong @xcite introduced a numerical integration method based on double fast fourier transforms ( fft ) that is efficient for geometric brownian motion and certain more general asset price processes .",
    "another stream of research develops analytical methods applicable to log normal models that involve linear approximations of the nonlinear exercise boundary .",
    "such methods are often very fast , but their accuracy is usually not easy to determine .",
    "kirk @xcite presented an analytical approximation that performs well in practice .",
    "carmona and durrleman @xcite used a family of lower bounds for the spread option price to obtain an analytical approximation formula that apparently leads to acceptable accuracy .",
    "moreover these results extend to approximate values for the greeks .",
    "deng , li and zhou @xcite have developed a systematic analytical approximation scheme which is perhaps even more reliable .",
    "next to having analytical option pricing formulas , the fastest option pricing engines by numerical integration are usually those based on the fast fourier transform methods introduced by carr and madan @xcite .",
    "their interest was in option pricing for geometric lvy process models like the variance gamma ( vg ) model , but their basic framework has been adapted to a host of other models where the characteristic function of the returns is known .    the main purpose of the present paper is to give a new numerical integration method for computing spread options in two or higher dimensions via ffts , applicable to any model for which the characteristic function of the joint return process is given analytically .",
    "our method is completely different from prior approaches , and consequently has distinct advantages , notably the flexibility to include a wide range of desirable asset return models , with a competitive computational expense .",
    "the results we describe all stem from the following fundamental new result that gives a fourier representation of the basic spread option payoff function @xmath12 .",
    "note that this spread option payoff is without loss of generality : we can reduce the general case @xmath13 to @xmath14 by using scaling and interchange of @xmath15 and @xmath16 .",
    "[ mainprop ] for any real numbers @xmath17 with @xmath18 and @xmath19 @xmath20 here @xmath21 is the complex gamma function defined for @xmath22 by the integral @xmath23 .",
    "we write @xmath24 and @xmath25 and the notation @xmath26 denotes the ( unconjugated ) matrix transpose .    using this result ,",
    "whose proof is given in the appendix , we will find we can follow the logic of carr and madan to derive numerical algorithms for efficient computation of a variety of spread options and their greeks .",
    "the basic strategy to compute is to combine with an explicit formula for the characteristic function of the bivariate random variable @xmath27 . for the remainder of this paper , we make a simplifying assumption that the dynamics of @xmath28 is _ homogeneous _ , which is equivalent to the following factorization of the characteristic function @xmath29=e^{iux'_0}\\phi(u;t ) ,   \\quad \\phi(u;t):=e_{0}[e^{iux_t'}]\\ .\\ ] ] then , if @xmath30 is the price process for two traded assets , the spread option formula can be written @xmath31\\nonumber\\\\   & = & ( 2\\pi)^{-2}e^{-rt}\\iint_{\\mathbb{r}^2+i\\epsilon } e_{x_0}[e^{iux_t ' } ] \\hat p(u ) d^2u\\nonumber\\\\   & = & ( 2\\pi)^{-2}e^{-rt}\\iint_{\\mathbb{r}^2+i\\epsilon}e^{iux'_0 } \\phi(u;t ) \\hat p(u ) d^2u\\ .",
    "\\label{spread }   \\end{aligned}\\ ] ] the greeks are handled in exactly the same way .",
    "for example , the delta @xmath32 is obtained as a function of @xmath33 by replacing @xmath34 in by @xmath35 .",
    "explicit double fourier integrals like this can be approximated numerically by a two dimensional fft .",
    "such approximations involve both a truncation and discretization of the integral , and the two properties that determine their accuracy are the decay of the integrand of in @xmath36-space , and the decay of the function @xmath37 in @xmath38-space .",
    "the remaining issue of computing the gamma function is not a real difficulty .",
    "fast and accurate computation of the complex gamma function in for example , matlab , is based on the lanczos approximation popularized by @xcite or @xmath39 '' . ] .    in this paper , we demonstrate how our method performs in three different models for spread options on two stocks , namely the geometric brownian motion ( gbm ) , a three factor stochastic volatility ( sv ) model and the variance gamma ( vg ) model .",
    "section 2 provides the essential definitions of the three types of models , including explicit formulas for their bivariate characteristic functions .",
    "section 3 discusses how the two dimensional fft can be implemented for our problem , and gives a heuristic picture of how the accuracy and speed will depend on the choices made in the implementation .",
    "section 4 gives the detailed results of the performance of the method in the three models .",
    "in that section , the accuracy of each model is compared to benchmark values computed by an independent method for a reference set of option prices .",
    "we also demonstrate that the computation of the spread option greeks in such models is equally feasible .",
    "section 5 extends all the above results to spread options on three or more assets . while in such cases",
    "the formulation is simple , the resulting higher dimensional ffts are in practice much slower to compute .",
    "in the two - asset black - scholes model , the vector @xmath40 has components @xmath41 , j=1,2\\ ] ] where @xmath42 and @xmath43 are risk - neutral brownian motions with constant correlation @xmath44 . the joint characteristic function of @xmath45 as a function of @xmath46 is of the form @xmath47 with @xmath48\\ ] ] where @xmath49 $ ] and @xmath50 .",
    "here we use implied matrix multiplication , and the @xmath51 denotes the ( unconjugated ) matrix transpose . substituting this expression into yields the spread option formula @xmath52\\hat p ( u)d^2u\\ .\\ ] ] as we discuss in section 3 , we recommend that this be computed numerically using the fft .      the spread option problem in a three factor stochastic volatility model was given as an example by dempster and hong @xcite .",
    "their model is defined by the sde for @xmath53 : @xmath54\\\\ dx_2&= & [ ( r-\\delta_2-\\sigma_2 ^ 2/2 ) dt+\\sigma_2\\sqrt{v}dw^2]\\\\ dv&=&\\kappa(\\mu - v)dt + \\sigma_v \\sqrt{v } dw^v\\end{aligned}\\ ] ] where @xmath55 & = & \\rho dt \\\\ eq[dw^1 dw^v ] & = & \\rho_1 dt \\\\ eq[dw^2 dw^v ] & = & \\rho_2 dt .",
    "\\end{aligned}\\ ] ] as discussed in that paper , it has the joint characteristic function @xmath47 where @xmath56\\biggr]\\end{aligned}\\ ] ] where @xmath57\\\\ \\gamma&:=&\\kappa - i(\\rho_1\\sigma_1u_1+\\rho_2\\sigma_2u_2)\\sigma_\\nu\\\\ \\theta&:=&\\sqrt{\\gamma^2 - 2\\sigma_v^2\\zeta}\\ .\\end{aligned}\\ ] ]      many stock price models are of the form @xmath58 where @xmath59 is a lvy process for which the characteristic function is explicitly known .",
    "we illustrate with example of the vg process introduced by @xcite , the three parameter process @xmath60 with lvy characteristic triple @xmath61 where the lvy measure is @xmath62/|x|$ ] for positive constants @xmath63 .",
    "the characteristic function of @xmath60 is @xmath64^{-\\lambda t}.\\ ] ]    to demonstrate the effects of correlation , we take a bivariate vg model driven by three independent vg processes @xmath65 with common parameters @xmath66 and @xmath67 .",
    "the bivariate log return process @xmath27 is a mixture : @xmath68 here @xmath69 $ ] leads to dependence between the two return processes , but leaves their marginal laws unchanged .",
    "an easy calculation leads to the bivariate characteristic function @xmath47 with @xmath70^{-\\alpha\\lambda t}\\label{vgchar}\\\\&&\\hspace{-1.7cm}\\times \\left[1+i\\left(\\frac{1}{a_-}-\\frac{1}{a_+ } \\right)u_1+\\frac{u^2_1}{a_-a_+}\\right]^{-(1-\\alpha)\\lambda t}\\left[1+i\\left(\\frac{1}{a_-}-\\frac{1}{a_+ }",
    "\\right)u_2+\\frac{u^2_2}{a_-a_+}\\right]^{-(1-\\alpha)\\lambda t}\\ .\\nonumber\\end{aligned}\\ ] ]",
    "to compute in these models we approximate the double integral by a double sum over the lattice @xmath71 for appropriate choices of @xmath72 for the fft it is convenient to take @xmath73 to be a power of @xmath74 and lattice spacing @xmath75 such that truncation of the @xmath36-integrals to @xmath76 $ ] and discretization leads to an acceptable error .",
    "finally , we choose initial values @xmath77 to lie on the reciprocal lattice with spacing @xmath78 : @xmath79    for any @xmath80 with @xmath81 we then have the approximation @xmath82 now , as usual for the discrete fft , as long as @xmath73 is even , @xmath83 this leads to the double inverse discrete fourier transform @xmath84\\nonumber\\\\ & = & ( -1)^{\\ell_1+\\ell_2}e^{-rt}\\left(\\frac{\\eta n}{2\\pi}\\right)^2e^{-\\epsilon x(\\ell)'}[\\mbox{ifft2}(h ) ] (   \\ell ) \\label{spreadfft}\\end{aligned}\\ ] ] where @xmath85    the selection of suitable values for @xmath86 and @xmath75 is a somewhat subtle issue when implementing the above fft approximation of .",
    "we now briefly discuss separately the truncation error and discretization error .",
    "the pure truncation error , defined by taking @xmath87 keeping @xmath88 fixed , can be made small if the integrand of is small outside the square @xmath89\\times [ -\\bar u+i\\epsilon_2,\\bar u+i\\epsilon_2]$ ] .",
    "corollary [ corol ] , proved in the appendix , gives an @xmath90 upper bound on @xmath91 , while @xmath92 can generally been seen directly to have some @xmath36-decay . typically , with some caveats , if one picks @xmath93 large enough so that @xmath94 and has decay outside the square , then the truncation error will be less than @xmath95 .    the pure discretization error , defined by taking @xmath96 while keeping @xmath75 fixed , can be made small if @xmath97 , taken as a function of @xmath98 , has rapid decay in @xmath99 .",
    "this is related to the smoothness of @xmath92 and the choice of @xmath100 .",
    "the first two models are not very sensitive to @xmath100 , but in the vg model the following conditions are needed to ensure that singularities in @xmath36 space are avoided : @xmath101 the error in the approximation with @xmath102 and @xmath75 finite , is given by the formula @xmath103 typically , with some caveats , the norm of this can be made smaller than @xmath104 for @xmath105 ^ 2 $ ] if @xmath106 and @xmath107 is @xmath108 and rapidly decaying outside the square @xmath109 ^ 2 $ ] .    in summary",
    ", one expects that the combined truncation and discretization error will be @xmath110 if @xmath93 and @xmath111 are each chosen as above .",
    "the fft method can also be applied to the greeks , enabling us to tackle hedging and other interesting problems .",
    "it is particularly efficient for the gbm model , where differentiation under the integral sign is always permissible .",
    "for instance , the fft formula for vega ( the sensitivity to @xmath112 ) takes the form : + @xmath113 (   \\ell)\\ ; \\\\",
    "\\frac{\\partial{h ( k)}}{\\partial{\\sigma_1}}&=&\\left[-(u(k)+i\\epsilon)\\left(i \\frac{\\partial{\\sigma^2}}{\\partial{\\sigma_1}}'+\\frac{\\partial{\\sigma}}{\\partial{\\sigma_1 } } (   u (   k)+i \\epsilon)'\\right)t/2\\right ] h(k)\\ , \\end{aligned}\\ ] ] where @xmath114 $ ] and @xmath115 $ ] .",
    "other greeks including those of higher orders can be computed in similar fashion .",
    "this method needs to be used with care for the sv and vg models , since it is possible that differentiation leads to an integrand that decays slowly .",
    "our numerical experiments were coded and implemented in matlab version 7.6.0 on an intel 2.80 ghz machine running under linux with 1 gb physical memory . if they were coded in c++ with similar algorithms",
    ", we should expect to see much faster performance .",
    "all the following experiments were run with @xmath116 .",
    "the strength of the fft method is demonstrated by comparison with benchmarks . based on a selection of @xmath117 ,",
    "the objective function we measure is defined as @xmath118 where @xmath119 and @xmath120 are fft computed prices and benchmark prices for the @xmath121 combination .",
    "we chose @xmath122 and fixed the strike @xmath14 , leading to 36 prices contributing to the objective function .",
    "these choices cover a wide range of moneyness , from deep out - of - the - money to deep in - the - money .",
    "since these combinations all lie on lattices @xmath123 corresponding to @xmath124 and @xmath125 for integers @xmath126 , all 36 prices @xmath119 can be computed simultaneously with one fft .",
    "figure [ rmserror2dgbm ] shows how the fft method performs in the 2-dimensional geometric brownian motion model for different choices of @xmath73 and @xmath93 .",
    "since the two factors are bivariate normal , benchmark prices can be calculated to high accuracy by one dimensional integrations . in figure [ rmserror2dgbm ]",
    "we can clearly see the effects of both truncation errors and discretization errors . for a fixed @xmath93 , the objective function decreases when @xmath73 increases .",
    "the @xmath127 curve flattens out near @xmath128 due to its truncation error of that magnitude . in turn",
    ", we can quantify its discretization errors with respect to @xmath73 by subtracting the truncation error from the total error .",
    "the flattening of the other three curves near @xmath129 should be attributed to matlab round - off errors : because of the rapid decrease of the characteristic function @xmath34 , their truncation error is negligible . for a fixed @xmath73 ,",
    "increasing @xmath93 brings two effects : reducing truncation error and enlarging discretization error .",
    "these effects are well demonstrated in figure [ rmserror2dgbm ] .     for the numerical computation of the gbm spread option versus the benchmark .",
    "errors are plotted against the grid size for different choices of @xmath93 .",
    "the parameter values are taken from @xcite : @xmath130 . ]    for the stochastic volatility model , no analytical or numerical method we know is consistently more accurate to serve as benchmark .",
    "instead , we used monte carlo simulation to achieve a moderate degree of accuracy .",
    "each benchmark price was created by @xmath131 simulations , each consisting of 2000 time steps .",
    "no variance reduction was employed .",
    "the resulting objective function is shown in figure [ rmserrorsvsimu ] .",
    "the objective function only decreases to near @xmath132 , reflecting the inaccuracy of the benchmark .",
    "a comparable graph ( not shown ) , using benchmark prices computed with the fft method with @xmath133 and @xmath134 , showed similar behaviour to figure [ rmserror2dgbm ] , and is consistent with accuracies at the level of round - off .",
    "the computational cost to reduce the monte carlo simulation error to a comparable level would be prohibitive .     for the numerical computation of the sv spread option versus the benchmark monte carlo simulation values computed with @xmath131 simulations each of which consists of 2000 time steps .",
    "the parameter values are taken from @xcite : @xmath135 . ]",
    "the vg model also lacks a reliable benchmark , so again we used monte carlo simulation . since the vg process can be simulated as a brownian motion time - changed by a gamma process , mc is here much more efficient than for the sv model , and we were able to run @xmath136 simulations with antithetic variates for each price .",
    "the objective function is shown in figure [ rmserrorvgjump ] .",
    "the truncation error for @xmath137 is about @xmath138 .",
    "the other three curves flatten out near @xmath139 , which is presumably the accuracy of the benchmark .",
    "a comparable graph ( not shown ) , using benchmark prices computed with the fft method with @xmath133 and @xmath134 , showed similar behaviour to figure [ rmserror2dgbm ] , and is consistent with the fft method being capable of producing accuracies at the level of round - off .",
    "for the numerical computation of the vg spread option versus the benchmark values computed with monte carlo simulation , where @xmath136 simulations are performed for each price .",
    "errors are plotted against the grid size for five different choices of @xmath93 .",
    "the parameters are : @xmath140 ]    the strength of the fft method is further illustrated by the computation of individual prices shown in tables [ tb : twogbm ] to [ tb : vg ] .",
    "the columns labeled `` analytic '' and `` simulation '' refer to the type of benchmark used .",
    "one can observe that an fft with @xmath141 is capable of producing very high accuracy in all three models . in the gbm model ,",
    "the errors are simply due to round - off .",
    "the discrepancies in the vg model are small too , less than 1 basis point .",
    "the apparent discrepancies in the sv model we attribute to the inaccurate benchmark , rather than the fft method itself .",
    ".prices for the two - factor gbm model of @xcite for different choices of @xmath73 .",
    "the parameter values are the same as figure [ rmserror2dgbm ] except we fix @xmath142 . [",
    "cols=\"^,^,^,^,^,^\",options=\"header \" , ]     [ tb : ffttime ]",
    "the ideas of section 2 turn out to extend naturally to basket options with payoffs @xmath143 for @xmath144 .",
    "the analysis is based on a simple result proved in the appendix :    [ prop2 ] let @xmath145 and @xmath146 with @xmath147 for all @xmath148 .",
    "then @xmath149    as before we write @xmath150 and seek to compute for @xmath151 , @xmath152 @xmath153 we introduce the factor @xmath154 and interchange the @xmath155 integral with the @xmath38 integrals .",
    "then using proposition [ prop2 ] one finds @xmath156d\\tilde xdz\\\\ & = & \\int_{\\mathbb{r}^{2}}e^{-i\\tilde u\\tilde x}(e^{\\tilde x}-e^z-1)^+\\left[\\int_{\\mathbb{r}^m}e^z\\delta(e^z-\\sum_{m=1}^m e^{x_m } ) e^{-iux ' } d^{m}x\\right]d\\tilde xdz\\\\ & = & \\frac{\\prod_{m=1}^m\\gamma(-iu_m)}{\\gamma(-i\\sum_{m=1}^m u_m ) } \\int_{\\mathbb{r}^{2}}e^{-i\\tilde u\\tilde x}e^{-i(\\sum_{m=1}^m u_m)z}(e^{\\tilde x}-e^z-1)^+d\\tilde xdz\\end{aligned}\\ ] ] when we can apply proposition 1 , we obtain the result :    [ prop3 ] for any real numbers @xmath157 with @xmath158 for all @xmath148 and @xmath159 @xmath160 where @xmath161",
    "this paper presents a fundamentally new approach to the valuation of spread options , an important class of financial contracts .",
    "the method is based on a newly discovered explicit formula for the fourier transform of the spread option payoff in terms of the gamma function .",
    "this mathematical result leads to simple and transparent algorithms for computing spread options in all dimensions .",
    "the powerful tool of the fast fourier transform provides an accurate and efficient implementation of the fundamental result .",
    "the difficulties and pitfalls of the fft , of which there are admittedly several , are by now well understood , and thus the reliability and stability properties of our method are rather clear .    many important processes in finance , particularly affine models and lvy jump models , have well known explicit characteristic functions , and can be included in the method with little difficulty .",
    "thus the method can be easily applied to important problems arising in energy and commodity markets .",
    "finally , the greeks can be systematically evaluated for such models , with similar performance and little extra work .",
    "* proof of theorem [ mainprop ] :  * suppose @xmath162 .",
    "one can then verify either directly or from the argument that follows that @xmath163 is in @xmath164 .",
    "therefore , application of the fourier inversion theorem to @xmath163 implies that p ( x)=(2)^-2_^2+ie^i uxg ( u ) d^2 u [ pft]where @xmath165 by restricting to the domain @xmath166 we have g ( u)&= & ^_0e^-iu_1x_1dx_1 + & = & ^_0e^-iu_1x_1(e^x_1 - 1)^1-iu_2dx_1  .",
    "the change of variables @xmath167 then leads to @xmath168 the beta function @xmath169 is defined for any complex @xmath170 with @xmath171 by @xmath172 from this , and the property @xmath173 follow the formulas [ gform ] g ( u)==  .        * proof :  * first note that for @xmath177 , @xmath178 . then and",
    "a symmetric formula with @xmath179 leads to the upper bound @xmath180 but since @xmath181 is monotonic and @xmath182 for all @xmath183 , the required result follows .",
    "we prove the proposition by induction .",
    "the above equation trivially holds when @xmath186 .",
    "now suppose it holds for @xmath187 . then for @xmath188 lhs&=&_^n+1  p(p - q_n+1-_m=1^n q_m)q_n+1 ^ -iu_n+1 - 1_m=1^n q_m^-iu_m-1 d^n+1q + & = & _ 0^p ( p - q_n+1)^-i(_m=1^n u_m ) q_n+1",
    "^ -iu_n+1 - 1 dq_n+1  .",
    "the above step makes use of the result when @xmath187 .",
    "the proof is then complete when one notices that the @xmath189 integral is simply @xmath190 multiplied by a beta function with parameters @xmath191 and @xmath192 .",
    "height 2pt depth -1.6pt width 23pt , _ pricing and hedging spread options in a log - normal model _ , tech .",
    "report , princeton university , 2003 .",
    "available at + ` orfe.princeton.edu/~rcarmona/download/fe/spread.pdf `  ."
  ],
  "abstract_text": [
    "<S> spread options are a fundamental class of derivative contract written on multiple assets , and are widely used in a range of financial markets . </S>",
    "<S> there is a long history of approximation methods for computing such products , but as yet there is no preferred approach that is accurate , efficient and flexible enough to apply in general models . </S>",
    "<S> the present paper introduces a new formula for general spread option pricing based on fourier analysis of the spread option payoff function . </S>",
    "<S> our detailed investigation proves the effectiveness of a fast fourier transform implementation of this formula for the computation of prices . </S>",
    "<S> it is found to be easy to implement , stable , efficient and applicable in a wide variety of asset pricing models .    * keywords :  * spread options , multivariate spread options , jump - diffusions , fast fourier transform , gamma function .    * </S>",
    "<S> ams subject classification :  * 33b15 , 65t50 , 91b28 </S>"
  ]
}