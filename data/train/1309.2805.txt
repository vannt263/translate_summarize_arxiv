{
  "article_text": [
    "one of the key questions of computational epidemiology is how best to distribute limited resources of treatment and vaccination so that they will be most effective in suppressing or reducing outbreaks of disease .",
    "this problem is heightened by the entangled networks of interactions via which diseases can spread : in a large complex network , contact with a high - degree hub can see a virus spread rapidly throughout the population even if the probability of transmission from an individual contact is low @xcite .",
    "early works on network immunization drew attention to the differences between random immunization and targeted immunization strategies @xcite .",
    "a simple random immunization strategy can consist in fixing a fraction or a density of immunized nodes and averaging the outcome of the epidemic process over all possible realizations of the immunization set . on the contrary , targeted immunization strategies correlate the choice of immunized nodes with some topological feature , such as the degree or other centrality measures .",
    "this can be experimentally shown to have some positive effect in reducing the spread of diseases @xcite .",
    "most topologically - based algorithms for immunization follow an incremental procedure , in which the set of immunized nodes is initially empty then it is progressively filled adding one by one the nodes that are most relevant with respect to a particular topological metric . despite the computational cost , recalculating the topological metric after each immunization step ( i.e. after removing the immunized node from the graph ) usually provides much better results than computing it only once on the original graph @xcite .",
    "further improvements were obtained by means of more complex immunization strategies , based on graph partitioning @xcite and on the optimization of the susceptible size @xcite . beside the heterogeneity of contacts , also clustering ,",
    "community structure and modularity have a major impact on disease dynamics @xcite , therefore the same immunization strategy can produce contrasting results on networks with different topological features .",
    "this is a consequence of the fact that topological heuristic methods neglect important features of the spreading rule and most common metrics used to measure their effectiveness , such as the largest connected component or the largest non - immune cluster size , are proxies that may not reflect the true susceptibility to an epidemic .",
    "these techniques also neglect the cost of vaccination , which may vary widely depending on the chosen target .    to overcome these limitations , several authors tried to quantify more explicitly the effects of immunization strategies on the outbreak dynamics @xcite and network immunization",
    "was mathematically formulated as a proper optimization problem , that can be proven to be np - hard in a plethora of different variants @xcite .",
    "standard optimization techniques such as monte - carlo ( mc ) methods or integer / linear programming are computationally very expensive and may take a prohibitive amount of time to reach reasonably good results even on relatively small networks . on the other hand , the _ greedy _ optimization strategies usually proposed are guaranteed to approximate the optimal result by a constant factor only in some fortunate case @xcite .",
    "recent progress in combinatorial optimization have shown that algorithms based on the message - passing principle , and developed using methods from the statistical physics of disordered systems , outperform in many cases both greedy algorithms and simulated annealing , even in complex optimization problem involving stochastic parameters @xcite and dynamical rules @xcite .",
    "in many cases in which mc algorithms get trapped in local minima of the ( free-)energy function , message - passing algorithms can find considerably better results . the remarkable performances of these algorithms are combined with considerably good computation time scaling properties . while on a wide variety of optimization problems the computational complexity of simulated annealing scales exponentially with the system size , message - passing algorithms typically require a time that scales roughly linearly with the number of messages ( i.e. the number of edges ) .    in this paper we show that , under some approximations , network immunization can be written as a constrained optimization problem , in which the constraints are fixed - point equations for some local ( node or edge ) variables describing the average stationary state of the dynamics . these constraints and a suitably defined objective ( energy ) function are then used to derive a message - passing approach to the optimization problem , and to design efficient algorithms on large networks .",
    "we apply this method to find optimal immunization strategies for both susceptible - infected - recovered ( sir ) and susceptible - infected - susceptible ( sis ) models .",
    "in section [ sec2 ] we recall the main ideas and formulas of mean - field methods in epidemic models , that are usually used to estimate the average stationary properties of an epidemic outbreak .",
    "the optimal immunization problem is introduced in section [ sec3 ] , opportunely defined in terms of mean - field quantities .",
    "section [ sec4 ] is devoted to the definition of the message - passing approach and the derivation of the corresponding belief - propagation ( bp ) and max - sum ( ms ) equations . in section [ sec5 ]",
    ", we use bp to understand in detail the immunization properties on the prototypical case of random regular graphs .",
    "the comparison with other optimization methods on more general graphs is discussed in section [ sec6 ] .",
    "over the years , a large number of stochastic epidemic models have been introduced , with the aim of addressing some specific features of different diseases @xcite . in the most simple model , the epidemic spreading induces in the nodes irreversible stochastic transitions from a _ susceptible _ state to an _ infected _ one .",
    "infected individuals can _ recover _ either returning to the susceptible state or becoming permanently resistant to the disease .",
    "one can then increase the complexity of the stochastic model introducing other intermediate states , or compartments , such as _ exposure _ and _ latency_. in the following , we discuss the most basic models of epidemic spreading , providing for each of them a set of approximated equations of mean - field type valid on very general graph structures .",
    "their solution describes the statistical properties of the stationary state corresponding to a given set of initial conditions and external parameters .",
    "in addition , such equations allow to measure the level of infection once a configuration of initially immunized nodes is chosen .",
    "the _ susceptible - infected - recovered _",
    "( sir ) model was formulated by kermack and mckendrick @xcite to describe the irreversible propagation through a population of individuals of an infectious disease , such as measles , mumps , or cholera .",
    "the sir stochastic dynamics is defined over a graph @xmath0 , representing the contact network of a set @xmath1 of individuals . at any given time step @xmath2 ( e.g. a day )",
    ", a node @xmath3 can be in one of three states : susceptible ( @xmath4 ) , infected ( @xmath5 ) , and recovered / removed ( @xmath6 ) .",
    "the state of node @xmath3 at time @xmath2 is represented by a variable @xmath7 .",
    "we assume that each node @xmath3 is initially infected with probability @xmath8 $ ] ( independent of the other nodes ) . at each time step ,",
    "an infected node @xmath3 can first spread the disease to each susceptible neighbor @xmath9 with given probability @xmath10 $ ] , then recover with probability @xmath11 .",
    "once recovered , individuals do not get sick anymore ( they are effectively removed from the graph ) . the probability that an infected node @xmath3 directly transmits the disease to @xmath9 before @xmath3 recovers is given by @xmath12",
    "it is thus possible to construct a completely static representation of the process that maps the final state onto the outcome of a bond percolation process @xcite .",
    "this relationship can be made mathematically clear as follows .",
    "let us consider a tree - like graph and define @xmath13 to be the probability that node @xmath3 is eventually infected when considering the graph obtained in the absence of the neighboring node @xmath9 .",
    "exploiting the factorization of probabilities on the sub - branches of the tree emerging from @xmath3 , the quantity @xmath13 satisfies the equation @xmath14\\ ] ] where @xmath15 denotes the set of neighbors of @xmath3",
    ". since infected nodes eventually recover , in the final state nodes can only be either in the susceptible state or in the recovered one . from the knowledge of the conditional marginals",
    "@xmath13 , one can compute the probability @xmath16 that a node @xmath3 is eventually infected , i.e. the probability that @xmath3 is recovered in the final state , @xmath17.\\ ] ]     of nodes that have been infected by the final ( infinite ) time in the sir dynamics on a random regular graph of @xmath18 nodes and degree @xmath19 , as function of the transmission probability @xmath20 for @xmath21 ( from left to right ) .",
    "the symmetric bars indicate the fluctuations around the average value computed on @xmath22 realizations of the stochastic process . the red full line is computed from the solution of - .",
    "[ fig - sir - ip ] ]    although - are exact only on trees , they have been successfully applied to study the sir model also on general random graphs @xcite . a comparison between the solutions of these equations and the results of simulations of the sir stochastic process is shown in figure [ fig - sir - ip ] for a random regular graph ( rrg ) of @xmath18 nodes and degree @xmath19 . for simplicity we considered uniform self - infection probabilities",
    "@xmath23 , @xmath24 and uniform transmission probabilities @xmath25 , @xmath26 . in the sir stochastic process , we defined a measure of the `` outbreak '' size as the average fraction @xmath27 of nodes that have been infected during the epidemic spreading . since all infected nodes eventually recover , this metric can be also defined as @xmath28\\ ] ] where @xmath29 $ ] is the probability that node @xmath3 is eventually recovered . in fig.[fig - sir - ip ] , @xmath27 is plotted as function of the transmission probability @xmath20 for @xmath21 .",
    "the results , obtained averaging over @xmath22 realization of the stochastic process , are reported as black circles , while the symmetric bars indicate the fluctuations around the average behavior .",
    "the average behavior can also be computed from the solutions of - , exploiting the fact that , in the tree - like approximation @xmath29 \\simeq m_i$ ] .",
    "the results are reported as a red full line in fig.[fig - sir - ip ] .",
    "the agreement between the mean - field theory represented by - and the simulations is very good for sufficiently large values of @xmath30 , then it deteriorates for @xmath30 of the order of @xmath31 and large values of @xmath20 .",
    "the reason for such a discrepancy is that eqs .",
    "are correct on tree - like structures , i.e. when the disease transmission events to one node coming from two neighbors are not correlated .",
    "the `` decorrelation '' assumption is not correct when the actual number of sources of spontaneous infection is very small .",
    "this is obvious in the case of a unique source of infection : the contagion path has the same source , hence the infection of a node due to disease transmission from her neighbors is a highly correlated process , that is not well captured by - .",
    "more precisely the solution to eqs .",
    "- gives an upper bound for the real probability to be infected @xcite . in the limit of infinitely large networks",
    ", this approach is expected to provide a correct description of the average final state of the system for any finite value of @xmath30 and @xmath20 .",
    "equations - can be easily modified to include immunization of nodes . by considering a set of binary variable @xmath32 , in which @xmath33",
    "if node @xmath3 is immune to the disease , we get @xmath24 and @xmath26    @xmath34 \\right\\},\\ ] ]    @xmath35\\right\\}.\\ ] ]    given a configuration @xmath36 of immune nodes , that we call _ immunization set _ , the solution of - provides a measure of the corresponding epidemic outbreak .",
    "it is possible to show that for a given set of parameters @xmath37 and @xmath38 , the solution of - is unique , therefore each configuration of immune nodes @xmath39 corresponds to a unique solution of the equations - .",
    "this property will be crucial for the validity of the optimization method developed in this work .",
    "the _ susceptible - infected - susceptible _ ( sis ) model is the prototype of reversible models of epidemic spreading , in which after recovery a node is again susceptible of being infected @xcite .",
    "the state of node @xmath3 at time @xmath2 is now represented by a binary variable @xmath40 . at each time step , an infected node @xmath3 can transmit the disease to each of its susceptible neighbors @xmath9 with probability @xmath41 , while it recovers with rate @xmath11 ( becoming susceptible again ) . the stochastic process admits an absorbing state in which all nodes are susceptible and the disease has disappeared from the population .",
    "when the transmission probabilities are sufficiently large , an active stationary state also exists , that is metastable and attractive for the dynamical process .",
    "although in any finite population a fluctuation will eventually bring the system into the absorbing state , the lifetime of the metastable endemic state scales with the size of the graph in such a way that an absorbing phase transition as function of the transmission probabilities is expected to occur in the thermodynamic limit .",
    "the critical threshold usually depends on the parameters of the dynamical process as well as on the topological structure of the underlying interaction graph . a variant of the sis model with spontaneous self - infection was recently introduced @xcite in order to simplify the numerical and mathematical analysis of the model .",
    "the presence of spontaneous self - infection destroys the absorbing state , whereas the metastable state becomes the ( unique ) stationary state of the dynamics . on the other hand , for a given small self - infection probability , the dynamics shows a clear boundary between low infection region and a region of global spreading as function of the transmission probabilities . by scaling down self - infection",
    ", one can extrapolate information on the epidemic phase transition occurring for zero self - infection , avoiding the problems associated with the existence of an absorbing state .",
    "the sis model on a given graph with @xmath42 nodes is a markov chain with @xmath43 states , whose stationary probability distribution can not be explicitly computed for large systems .",
    "a simple mean - field approximation that turned out to provide a good qualitative and quantitive description of the stationary state of the sis model is obtained replacing the exact probability distribution by a product measure over the nodes of the graph @xcite .",
    "this factorization , also known as the _ @xmath42-intertwined model _ , leads to a set of `` quenched '' mean - field equations for the evolution of single - node infection probabilities @xmath16 with @xmath44 .",
    "notice the difference between the sir and sis cases : while in the sir model @xmath16 indicates the ( mean - field ) probability that node @xmath3 is eventually infected before the final state , in the sis model it represents the ( mean - field ) probability that @xmath3 is infected in the stationary state of the dynamics .",
    "in the `` quenched '' mean - field approximation , the infection probability of node @xmath3 at time @xmath2 satisfies the equation @xmath45 \\right\\}\\ ] ] where @xmath46 is the transmission probability from @xmath9 to @xmath3 , @xmath47 is the spontaneous self - infection probability . in the stationary state ,",
    "the mean - field variables @xmath48 are given by the solution of the fixed - point equations @xmath49}{r_i + q_i+ ( 1-q_i ) \\left[1-\\prod_{j\\in\\partial i } ( 1- p_{ji } m_j ) \\right]}\\ ] ] where @xmath50 says whether node @xmath3 is immune or not . as for the sis model , it is possible to show that the mean - field quantity @xmath16 gives an upper bound for the real value of the infection probability of node @xmath3 in the stationary state @xcite .",
    "the approximation can be improved considering second - order quantities , i.e. deriving closed equations for single - point marginals and pair - correlations , but the actual form of these equations is not unique and depends on the moment closure approximation adopted @xcite . nevertheless , in most cases equations already provide a very good description of the stationary state of the sis stochastic process .    a measure of the outbreak size of the epidemics is given by the average fraction @xmath27 of infected nodes in the active stationary state .",
    "if the stationary state is infinitely long - lived , @xmath27 can be operatively defined as @xmath51\\right\\}\\ ] ] where @xmath52 $ ] is equal to 1 when the argument is verified and 0 otherwise . in practice ,",
    "simulations are performed for a finite time , that is chosen to be much longer than the time necessary to converge to the stationary state .",
    "figure [ fig - sis - ip ] displays the behavior of @xmath27 as function of the transmission probabilities @xmath20 , for different values of the self - infection probability @xmath30 , on a random regular graph of @xmath18 nodes and degree @xmath19 .",
    "the dashed line is the same quantity computed as @xmath53 , i.e. approximating the probability that node @xmath3 is infected in the stationary state by the mean - field one @xmath16 obtained solving .",
    "the agreement between mean - field predictions and results of the simulations is very good in almost all regimes of the parameters .     of infected nodes in the stationary state ( @xmath54 steps ) of the sis dynamics on a random regular graph of @xmath18 nodes and degree @xmath19 , as function of the transmission probability @xmath20 for @xmath30 between @xmath55 and @xmath56 .",
    "the symmetric bars indicate the fluctuations around the average value computed on @xmath22 realizations of the stochastic process . the red dashed line is computed from the solution of .",
    "[ fig - sis - ip ] ]      both sir and sis epidemic models are often formulated in continuous time , where spontaneous self - infection probabilities and transmission probabilities are replaced by rates .",
    "while the time - dependent evolution of the dynamical processes can be quite different from that of their discrete - time counterpart , the stationary behavior at long - time can be similarly described in terms of percolation - like equations . in continuous time",
    ", transmission events can be modeled as independent poisson processes , therefore the probability that , in a sufficiently small interval of time , a node is infected from the neighbors is proportional to the sum of the independent probabilities of the individual transmission events . once @xmath57 and @xmath58",
    "are intended as probability rates , this reduces to replace the term @xmath59 with @xmath60 in both - and .",
    "preventing or eradicating diseases entails a trade - off between the costs of treating and hospitalizing infected individuals and the cost of distributing vaccines / drugs .",
    "when the contact network is known and these costs can be estimated , one can devise an optimization problem , in which the optimal immunization set is the configuration of immunized nodes that minimizes a properly defined energy function . in the sir stochastic process",
    "we consider the following energy function @xmath61\\ ] ] in which @xmath62 is the cost of immunization of node @xmath3 , @xmath63 is a loss , i.e. the cost associated with the infection of node @xmath3 , while @xmath64 $ ] is the probability that node @xmath3 eventually recovers ( i.e. the probability that the node has been infected during the epidemic spreading ) given the configuration @xmath39 of immunized nodes . estimating the probability @xmath64 $ ] from the simulations of the stochastic sir process is very cumbersome , making the optimization problem practically unsolvable for sufficiently large graphs .",
    "in fact , it is known that finding the probability that a node becomes infected in the course of an epidemic in sir and related models is an np - hard problem @xcite .",
    "the energy function for the optimal immunization problem for the sis model can be defined in a similar way to be @xmath65.\\ ] ] likewise the sir case , computing @xmath66 from direct simulations of the stochastic dynamics is a very demanding task .    the problem of finding the configuration of seeds that minimizes an energy function associated with a given dynamical model has been investigated by several authors in the recent past .",
    "even for simple stochastic propagation models , such as the independent cascade model @xcite , several versions of this optimization problem have been introduced and shown to be np - hard . to the best of our knowledge ,",
    "the methods proposed to solve this class of problems are mostly based on greedy approaches , that scale reasonably well with the system size but give solutions that only in very peculiar cases provide good approximations of the real optima .    in this work",
    "we employ a simplified approach , based on the mean - field representation of the dynamical process .",
    "we replace the energy functions @xmath67 and @xmath68 with a unique energy function defined as @xmath69 in which @xmath70 , @xmath16 is the solution of - and for the sir and sis models respectively .",
    "this energy can now be computed easily for any configuration @xmath39 of immunized nodes , solving the corresponding set of self - consistent equations for @xmath71 .",
    "once we know how to compute the energy function , the optimization problem can be studied with different methods .",
    "the simplest optimization method is a _",
    "greedy algorithm _ that resembles the incremental procedure used in topologically - based heuristics . starting from an empty set of immunized nodes , the greedy principle imposes to select the node",
    "whose immunization causes the largest drop in the energy function .",
    "once the node is included in the set of immunized nodes , a second node is chosen following the same greedy principle .",
    "one - by - one all nodes are added to the immunization set . under this criterion ,",
    "the best configuration of immunized nodes is the one that realizes the lowest energy .",
    "the greedy algorithm is fast but it presents several drawbacks : first , there is no guarantee that the best solution found is the optimal one ; moreover , we can not stop the greedy procedure before almost all nodes are added to the immunization set , because the energy function can display several local minima during this process .",
    "another famous optimization method is _ simulated annealing _ , in which a mc algorithm is used to find the configuration @xmath39 minimizing the energy @xmath72 . for a sufficiently slow annealing schedule ,",
    "the algorithm is guaranteed of finding the minimum , i.e. the optimal immunization set .",
    "however , this can be computationally unfeasible in large graphs , since mc algorithms get trapped in local minima of the ( free-)energy function and the convergence to the global one requires a time that can scale exponentially with the system size . in the next section",
    ", we will develop a message - passing approach to the optimal immunization problem .",
    "message - passing algorithms can find the global optimum or , in general , considerably better results than simulated annealing in a running time that scales only linearly with the number of messages ( i.e. the number of edges ) .",
    "the implementation details of the greedy algorithm and simulated annealing are described in appendix [ app - algo ] .",
    "since each configuration of immunized nodes corresponds to a unique value of the energy function , we can define a probability function @xmath73 by associating to each configuration @xmath39 a boltzmann weight @xmath74 and tracing over the variables @xmath75 with the constraint that they are a solution of the corresponding percolation - like equations .",
    "it follows that the equations in and in become a set of hard constraints for the auxiliary variables @xmath75 that must be included in the optimization problem in addition to the energetic terms . as for standard constraint - satisfaction problems over discrete variables ( i.e. @xmath39 ) defined on the vertices of a graph it is possible to apply the cavity method @xcite and to develop efficient message - passing algorithms , such as bp and ms .    in the following",
    "we present the derivation of the bp and ms equations both for the sir and sis models , we discuss the approximation methods employed and the convolution technique used to to solve them efficiently .",
    ", the other includes the immunization variables @xmath76 .",
    "there is a factor node for each node @xmath3 of the original graph , including the energetic term @xmath77 and all hard - constraints @xmath78 involving node @xmath3 as first label .",
    "[ fig - fgsir ] ]    in the sir model , equations   define the values assumed by the auxiliary variables @xmath75 for each configuration of immunized nodes @xmath39 .",
    "the relevant variables on which we must trace to compute the probability weight associated with configuration @xmath39 are @xmath79 , with the condition that they satisfy .",
    "let us consider the partition function of the problem @xmath80 where the integration over @xmath81 selects ( for each @xmath39 ) the unique set of values of @xmath75 that satisfies the constraints @xmath82 and where the energy is @xmath83\\right\\}.\\end{aligned}\\ ] ] the probability associated with a configuration of immunized nodes @xmath39 is @xmath84 in order to derive the bp equations , we consider an infinite tree , and we marginalize over all variables but @xmath9 . in this way we obtain the probability @xmath85 for the variable @xmath86 , @xmath87 in which the factorization over the neighbors @xmath3 of @xmath9 comes from the fact that in a tree each sub - branch is independent of the others , and the partial partition function of the sub - branch is represented by the  cavity marginal \" or bp message @xmath88 .",
    "the latter denotes the joint probability for the auxiliary variables @xmath13 and @xmath89 in absence of the hard - constraints over node @xmath9 ( i.e. @xmath90 ) and of the energetic term @xmath91 ; they satisfy the bp equations @xmath92 unlike most common cases , the bp message @xmath93 depends on both auxiliary variables defined in the edge @xmath94 .",
    "this happens because both of them enter in the definition of the energetic term ( in fact , they are both contributing to @xmath95 ) . on the contrary",
    "the set of hard constraints @xmath96 does not depend on the variable @xmath13 .",
    "it follows that in cases in which the energetic term @xmath97 does not depend on @xmath95 ( e.g. for @xmath98 in ) , it can be shown that @xmath93 only depends on @xmath13 .    from the bp marginals",
    "we can compute the single - site total probability marginal @xmath99 , @xmath100 that represents the probability distribution of the values assumed by the variable @xmath16 on that node .",
    "the update rule of the bp equations can be represented graphically on a factor graph as shown in fig.[fig - fgsir ] .",
    "the cavity message @xmath88 is a real function defined on the square @xmath101\\times [ 0,1]$ ] .",
    "since there is no information on the shape of this function , we proceed discretizing the interval @xmath101 $ ] in a number @xmath102 of bins , and solving numerically assuming that @xmath88 is defined on a two - dimensional mesh of @xmath103 identical cells . because of discretization , the hard constraints in are only approximately satisfied . in the following , the integrals over @xmath75 variables will be replaced by sums whenever we consider discretized versions of the equations . with a naive discretization , it is not easy to keep under control the propagation of the error during the iteration of the bp update rule .",
    "we also considered a relaxed version of the constraints for which we can bound the error due to the discretization , however we checked numerically that the two versions of the algorithm give practically the same results .",
    "the computation time of the update rule in the bp equations as written in scales as @xmath104 , where @xmath105 is the degree of node @xmath3 , making the trace over all configurations of the neighbors practically unfeasible on most graphs .",
    "the computational complexity of the bp update rule can be considerably reduced by exploiting the properties of convolutions of messages .",
    "for an arbitrary set @xmath106 , we define the convolution function @xmath107 } } \\prod_{k\\in d } p_{ki}\\left(m_{ki } , q_i + ( 1-q_i)\\left[1- \\frac{t}{1-m_{ki}p_{ki } } \\right]\\right)\\ ] ] where @xmath108 $ ] so that @xmath109",
    ". then , for any disjoint sets @xmath110 and @xmath111 , we have @xmath112 one can start from the empty set and add one by one the elements of @xmath113 , using the convolution rules . finally , the convolution function over the complete set @xmath113 can be used to compute the out - coming message as @xmath114 where the two terms , defined as    @xmath115    refer to node @xmath3 being immunized or not ( the proportionality symbol as usual means that the message has to be properly normalized ) . using the convolution trick ,",
    "the computational complexity of the update rule on a node of degree @xmath116 reduces to @xmath117 .",
    "the factor @xmath118 comes from the computation of the trace over the auxiliary variables @xmath119 by means of a convolution function : for each value of the @xmath102 values taken by @xmath120 , we have to sum over all @xmath102 values taken by @xmath121 and by @xmath122 .    finally , in order to explore directly the optimal immunization assignments",
    ", we can define the ms messages @xmath123 for an arbitrary set @xmath106 , we define the convolution function @xmath124 } } \\sum_{k\\in d } \\hat{p}_{ki}\\left(m_{ki } , q_i + ( 1-q_i)\\left[1- \\frac{t}{1-m_{ki}p_{ki } } \\right]\\right)\\ ] ] where @xmath108 $ ] so that @xmath109",
    ". then , for any disjoint sets @xmath110 and @xmath111 , we have @xmath125 the ms equations ( in their discretized and efficient version ) read @xmath126 where @xmath127 is an ( irrelevant ) additive constant , and    @xmath128      in the sis model , the relevant auxiliary variables by means of which we can connect the configuration of immunized nodes with the corresponding energy value are the mean - field variables @xmath48 satisfying .",
    "as done for the sir model , we introduce eqs .   as a set of hard constraints in a statistical mechanics model by means of the partition function @xmath129 where now we have @xmath130}{r_i+q_i+(1-q_i)\\left[1-\\prod_{j\\in { \\partial}i}(1-p_{ji}m_{j})\\right]}\\right)\\ ] ] and the usual energy term @xmath131 the probability associated to a configuration of immunized nodes @xmath39",
    "is @xmath132 we repeat the same derivation as before , assuming that the graph is an infinite tree .",
    "marginalizing over all variables but @xmath9 , we compute the probability @xmath85 for the variable @xmath86 as@xmath133 where the bp messages @xmath134 satisfy the bp equations @xmath135 and it represents the joint probability that the mean - field variables on @xmath3 and @xmath9 assume values @xmath16 and @xmath95 in absence of the constraint @xmath136 and of the energetic term @xmath91 .",
    "figure [ fig - fgsis ] displays a graphical representation of the bp equations on the corresponding factor graph .",
    "the single - site total probability marginal @xmath99 is given by @xmath137    , the other includes the immunization variables @xmath76 .",
    "there is a factor node for each node @xmath3 of the original graph , including the energetic term @xmath77 and the hard - constraint @xmath138 .",
    "[ fig - fgsis ] ]    as already described for the sir model , the bp equations can be solved numerically using a discretized version of the messages , in which the @xmath101 $ ] interval is divided in @xmath102 bins . in this way , however , the number of operations required to compute the trace in scales exponentially with the degree of the node , therefore we employ again the convolution method . for an arbitrary set @xmath106 , we define the quantity @xmath139 } } \\prod_{k\\in d } p_{ki}(m_{k } , m_{i}).\\ ] ] then , for any disjoint sets @xmath110 and @xmath111 , we have @xmath140 and the bp equations become @xmath141}{r_i+q_i+(1-q_i)\\left[1-(1-p_{ji}m_{j})s\\right]}\\right ) e^{-\\beta\\mathscr{e}_i(s_i , m_i ) }   \\\\ & = & e^{-\\beta\\mu c_i }   + m_{\\partial i{\\setminus}j } \\left(\\frac{1-m_i - r_i m_i}{(1-q_i)(1-m_i)(1-p_{ji}m_j)},m_i\\right ) e^{-\\beta\\epsilon\\ell_i m_i}.\\end{aligned}\\ ] ]    again we can derive ms equations @xmath142 where    @xmath143    and @xmath127 is an ( irrelevant ) additive constant .",
    "on a general graph , the bp equations and are valid under the hypothesis of fast decay of correlations with the distance or replica symmetric ( rs ) assumption @xcite . under this assumption ,",
    "the statistical properties of the system are described by a unique gibbs state ( i.e. replica symmetry ) , and the bp equations admit a unique solution .",
    "random graphs are natural benchmark structures for evaluating the quality of the results obtained solving numerically the bp equations with histograms and the performances of the corresponding optimization method . in order to isolate and study the effects of immunization on the statistical properties of epidemic spreading , we consider a completely homogeneous setup : a rrg with uniform values of both spontaneous self - infection and disease transmission along the edges , i.e. @xmath23 , @xmath24 and @xmath25 , @xmath26 . for the sake of simplicity",
    ", we also consider uniform loss parameters and uniform immunization costs , i.e. @xmath144 , @xmath24 . in the bp approach",
    "explained in section [ sec4 ] , we can give a larger statistical weight to allocations of the immunized nodes that correspond to lower values of the energy .",
    "increasing @xmath145 for @xmath146 ( see ) , the distribution @xmath73 becomes biased towards immunization sets that generate a smaller expected number of infected nodes compared to random immunizations of the same density . in the limit of @xmath147 the weight is concentrated on the minima of the energy function , i.e. on the optimal immunization sets . in this framework",
    "an interesting global observable is the generalization of the quantity @xmath27 defined in section [ sec3 ] when we perform an average over all possible immunization sets @xmath39 with the corresponding weight @xmath73 .",
    "we call this quantity @xmath148",
    ". we can exploit the definition of @xmath27 in terms of the variables @xmath75 , and use bp to obtain an estimate of @xmath148 , @xmath149 where @xmath99 is given by and for the sir and sis models respectively .",
    "the chemical potential @xmath150 can be used to control the average fraction of immunized nodes , denoted by @xmath151 , that is computed from the solution of the bp equations as @xmath152 and for @xmath153 we use and for the sir and sis models respectively .",
    "it is thus possible to compute @xmath148 as function of @xmath151 for a fixed choice of the other parameters .",
    "we present here results obtained for infinitely large regular random graphs , obtained using the bp equations in the single - link approximation , i.e. when we solve self - consistently the bp equations assuming all nodes to have essentially the same statistical properties . for both sir and sis models ,",
    "the results of the bp equations in the single - link approximation are shown in fig.[fig - optbp ] with the choice of parameters @xmath154 and @xmath155 and different values of @xmath156 and @xmath145 . in the case of random immunization ( @xmath157 ) , the results obtained using bp on infinitely large rrg are compared with the average behavior observed by sampling the solutions of - ( and respectively ) and by simulating the sir ( and sis ) stochastic process on finite rrg of @xmath18 nodes .",
    "the latter are obtained sampling over @xmath158 configurations of immunized nodes for each value of @xmath151 .",
    "the agreement is very good for both models .    , with uniform self - infection probability @xmath154 and uniform transmission probability @xmath155 .",
    "( a ) for the sir model , we plot the average density of nodes that got infected during the epidemic spreading @xmath148 as function of the average density @xmath151 of immunized nodes .",
    "bp results on infinitely large graphs are reported for @xmath98 and @xmath159 ( black full line ) and for @xmath160 and @xmath159 ( red dashed line ) , 5 ( green dot - dashed line ) , 10 ( blue double - dot - dashed line ) , and 20 ( violet dot - double - dashed line ) .",
    "results of sampling over eqs.- ( orange circles ) , corresponding to random immunization , are also displayed .",
    "( b ) for the sis model , we plot the average density @xmath148 of infected nodes in the stationary state as function of the average density @xmath151 of immunized nodes .",
    "bp results on infinitely large graphs are reported for @xmath98 and @xmath159 ( black full line ) and for @xmath160 and @xmath159 ( red dashed line ) , 5 ( green dot - dashed line ) , 10 ( blue double - dot - dashed line ) , and 20 ( violet dot - double - dashed line ) .",
    "results of sampling over eqs .",
    "( orange circles ) , corresponding to random immunization , are also displayed .",
    "[ fig - optbp],title=\"fig : \" ] , with uniform self - infection probability @xmath154 and uniform transmission probability @xmath155 . ( a ) for the sir model , we plot the average density of nodes that got infected during the epidemic spreading @xmath148 as function of the average density @xmath151 of immunized nodes .",
    "bp results on infinitely large graphs are reported for @xmath98 and @xmath159 ( black full line ) and for @xmath160 and @xmath159 ( red dashed line ) , 5 ( green dot - dashed line ) , 10 ( blue double - dot - dashed line ) , and 20 ( violet dot - double - dashed line ) .",
    "results of sampling over eqs.- ( orange circles ) , corresponding to random immunization , are also displayed .",
    "( b ) for the sis model , we plot the average density @xmath148 of infected nodes in the stationary state as function of the average density @xmath151 of immunized nodes .",
    "bp results on infinitely large graphs are reported for @xmath98 and @xmath159 ( black full line ) and for @xmath160 and @xmath159 ( red dashed line ) , 5 ( green dot - dashed line ) , 10 ( blue double - dot - dashed line ) , and 20 ( violet dot - double - dashed line ) .",
    "results of sampling over eqs .",
    "( orange circles ) , corresponding to random immunization , are also displayed .",
    "[ fig - optbp],title=\"fig : \" ]    increasing @xmath145 for @xmath160 , the solutions of the bp equations show a monotonic decrease in the density of infected nodes .",
    "the reduction of the infection level is particularly visible for intermediate values of @xmath151 , while it becomes almost negligible at small and large density of immunized nodes .",
    "the fact that the density @xmath151 is not directly fixed ( as for micro - canonical systems ) , but it is implicitly varied as an effect of tuning the chemical potential @xmath150 and then evaluated from the outcome of the bp equations , is the cause of an undesirable issue at large values of @xmath145 .",
    "it happens that , for large @xmath145 , the free - energy of the statistical mechanics problem is not convex over the whole interval @xmath101 $ ] of values assumed by @xmath151 .",
    "the legendre transform , implicitly used in the cavity method  @xcite , spontaneously selects the convex envelope of the free - energy , limiting the interval of the possible values assumed by the density of immunized nodes .",
    "this is visible in fig.[fig - optbp ] , as increasing @xmath145 for @xmath160 the curves get interrupted at some ( non - zero ) value of @xmath151 .",
    "this means that , for that choice of the parameters , smaller non - zero immunization sets are , in energetic terms , less convenient than no immunization at all ( i.e. of the point at @xmath161 ) . to eliminate this phenomenon",
    ", one can fix the value of @xmath151 introducing an adaptive external field that is self - consistently adjusted during the iterations of the bp equations @xcite . using this technique",
    "we were able to explore all values of the density of immunized nodes , although the procedure is not guarantee to converge at all values of @xmath145 .",
    "more precisely , we computed the set of points indicated with black dots in fig.[fig - optbp ] , that correspond to the best results ( lowest value of @xmath148 ) obtained varying @xmath145 at fixed values of @xmath162 .",
    "we expect these results to be very close to the optimal ones for a large graph .    , with uniform self - infection probability @xmath163 and uniform transmission probability @xmath155 .",
    "for the sir model ( a - b ) , we plot the average density of nodes that got infected during the epidemic spreading @xmath148 as function of the average density @xmath151 of immunized nodes , both in the random case ( open circles ) and under optimization ( full circles ) . for the sis model ( c - d )",
    ", we plot the average density @xmath148 of infected nodes in the stationary state as function of the average density @xmath151 of immunized nodes , both in the random case ( open circles ) and under optimization ( full circles ) .",
    "[ fig - optbp2],title=\"fig : \" ] , with uniform self - infection probability @xmath163 and uniform transmission probability @xmath155 . for the sir model ( a - b )",
    ", we plot the average density of nodes that got infected during the epidemic spreading @xmath148 as function of the average density @xmath151 of immunized nodes , both in the random case ( open circles ) and under optimization ( full circles ) . for the sis model ( c - d ) , we plot the average density @xmath148 of infected nodes in the stationary state as function of the average density @xmath151 of immunized nodes , both in the random case ( open circles ) and under optimization ( full circles ) .",
    "[ fig - optbp2],title=\"fig : \" ]    upon decreasing the spontaneous self - infection probability @xmath30 , the effect of the optimization becomes more pronounced .",
    "this is shown in fig.[fig - optbp2 ] , where the results of optimization are compared with random immunization both for @xmath154 and @xmath164 . in the same figure , we also plot the entropy @xmath165 of the immunization sets as function of the density @xmath162 ( computed from the solution of the bp equations as in @xcite ) .",
    "the red dashed lines , referring to random immunization , is the standard entropy curve given by @xmath166 and derived from a binomial distribution of @xmath167 immunized nodes among the @xmath42 possible ones .",
    "red full lines instead represent the entropy curves under strong optimization , i.e. corresponding to low energy states . in this case",
    ", the entropy becomes negative for sufficiently small values of @xmath151 , meaning that no configurations of immunized nodes can be found in the gibbs state defined at that temperature ( this is related to the non - convexity argument explained before ) .",
    "in other words , in that region it is ( energetically ) more convenient to let the disease spread naturally ( with no immune ) than performing immunization .",
    "with the bp analysis we can go beyond the study of the average macroscopic behavior and focus on more informative quantities , such as the distribution @xmath99 . in the absence of immunization",
    ", @xmath99 is a delta function because the equations ( and ) have a unique solution . after averaging over a set of configurations of immunized nodes , each node @xmath3",
    "is represented by a distribution @xmath99 instead of a single value of infection probability @xmath16 . in a completely homogeneous setup ( i.e. random regular graph and uniform parameters )",
    "all nodes have the same statistical properties , therefore we can ignore the node label in the distribution and assume @xmath168 , @xmath24 .",
    "when the set of immunized nodes is drawn from a uniform distribution ( i.e. @xmath157 ) , we can directly compare the shape of @xmath169 obtained solving the bp equations with that obtained either by explicitly simulating the stochastic process or by repeatedly solving the mean - field equations with a large sample of configurations of immunized nodes .",
    "examples of the results obtained for the sir model on rrg of degree @xmath19 , @xmath154 and @xmath155 are displayed in figure [ fig - pmsir ] .",
    "the shape of the distribution @xmath169 varies considerably for different values of the average immunization density @xmath151 .",
    "the comparison between the results for @xmath98 and the empirical distributions obtained by sampling solutions of - and by means of simulations of the stochastic dynamics is very favorable .",
    "the agreement between bp and sampling results seems not to be affected by the discretization of the @xmath101 $ ] interval employed in order to solve the bp equations ( here @xmath170 ) .",
    "also the agreement with the results of simulations is very good , and it improves increasing the number of configurations of immunized nodes employed in the simulations ( here we performed an average over @xmath22 realizations at fixed density ) .",
    "the distribution is always very heterogeneous and the average value ( reported in fig.[fig - optbp ] ) is not at all representative of the behavior of the system . in general",
    ", @xmath169 is characterized by a series of isolated peaks at low values of @xmath171 and by a continuous distribution in the bulk .",
    "the origin of the delta peaks is strictly related with the local structure of the graph around a node after immunization .",
    "for instance , the first peak for @xmath172 corresponds to isolated nodes , i.e. nodes that are completely surrounded by immunized ones and thus disconnected from the rest of the graph .",
    "such nodes are infected with probability @xmath30 , that is exactly the position of the first delta peak .",
    "a second peak occurs at @xmath173 , corresponding to the probability of a node being part of an isolated infected dimer . for infected trimers ( chain of length three )",
    ", the central node corresponds to @xmath174 , while the external nodes have @xmath175 .",
    "these peaks are visible in figure [ fig - pmsir ]",
    ". then one can continue identifying other local clusters , such as star - like structures and small chains , each one corresponding to an isolated peak in the distribution .",
    "the continuous bulk of the distribution should be instead identified with a superposition of values due to large - scale clusters of infected nodes .     of the probability @xmath171 that a node got infected during the sir process on random regular graphs of degree @xmath19 for @xmath176 .",
    "results are computed using bp by means of ( black full line ) on infinite networks , by sampling solutions of - ( red dashed lines ) and by means of simulations of the stochastic dynamics , both on a finite network of @xmath18 nodes and with a sample of @xmath22 immunization sets .",
    "[ fig - pmsir ] ]    in figure [ fig - pmsis ] we reported a similar plot for the sis model .",
    "the structure of @xmath169 is generally different , with few isolated peaks in which the weight of the distribution concentrates .",
    "this effect could be due to the naive mean - field approximation applied at the level of the equations used as hard - constraints , that is less accurate than that applied in the sir model .",
    "of the probability @xmath171 that a node is infected in the stationary state of the sis process on random regular graphs of degree @xmath19 for @xmath177 .",
    "results are computed using bp by means of ( black full line ) on infinite networks , by sampling solutions of ( red dashed lines ) and by means of simulations of the stochastic dynamics , both on a finite network of @xmath18 nodes and with a sample of @xmath22 immunization sets .",
    "[ fig - pmsis ] ]    there is a remarkable difference in the shape of @xmath169 when a non - uniform weight is associated with immunization sets that generate different levels of infection . in the bp formalism , this is done by increasing @xmath156 from zero .",
    "figure [ fig - optpe - sir]a displays the distribution @xmath169 for the sir model at a fixed value of @xmath178 , @xmath160 and different values of @xmath145 . increasing @xmath145",
    "the distribution concentrates on a narrower interval of values of @xmath171 .",
    "the information in these plots is important because it can be used to compute , for a given node in a graph , the probability that such node is infected for a given immunization strategy .",
    "one can also ask how many immunization sets exist at a given density @xmath162 that generate an average infection level of @xmath179 . for a rrg with degree @xmath19 and @xmath180 ,",
    "this is shown in fig.[fig - optpe - sir]b , where we plot the entropy of immunization sets of fixed density as function of @xmath148 .",
    "these results are obtained from the solutions of the bp equations increasing @xmath145 from 1 ( for @xmath160 ) . in figure",
    "[ fig - optpe - sis ] we report analogue plots for the sis model with @xmath180 . for a random allocation of immunized nodes ( black circles in fig.[fig - optpe - sis]a ) , @xmath169 exhibits ( in addition to a delta in zero ) a series of narrow peaks at positive @xmath171 .",
    "increasing @xmath145 , those at larger @xmath171 slowly disappear leaving only a delta peak at @xmath181 .",
    "fig.[fig - optpe - sis]b shows the behavior of the entropy curve at @xmath180 for the sis model . in both models ,",
    "the entropy at @xmath180 does not vanish continuously when the minimum value of infection @xmath148 is reached , but it remains considerably large .",
    "this is in accord with the behavior of the entropy curves displayed in fig.[fig - optbp2 ] .",
    "a continuously vanishing behavior can be observed instead if we select a density value that falls in the region in which , at large @xmath145 , the entropy curve becomes negative ( see later discussion about ms results ) .     of the probability @xmath171 that a node got infected during the sir process on random regular graphs of degree @xmath19 , @xmath154 , @xmath155 , @xmath182 and different values of @xmath145 and @xmath156 .",
    "( b ) entropy of immunization sets of density @xmath183 as function of @xmath148 ( obtained in creasing @xmath145 for @xmath160 ) .",
    "[ fig - optpe - sir],title=\"fig : \" ]   of the probability @xmath171 that a node got infected during the sir process on random regular graphs of degree @xmath19 , @xmath154 , @xmath155 , @xmath182 and different values of @xmath145 and @xmath156 .",
    "( b ) entropy of immunization sets of density @xmath183 as function of @xmath148 ( obtained in creasing @xmath145 for @xmath160 ) .",
    "[ fig - optpe - sir],title=\"fig : \" ]     of the probability @xmath171 that a node is infected in the stationary state of the sis process on random regular graphs of degree @xmath19 , @xmath154 , @xmath155 , @xmath182 and different values of @xmath145 and @xmath156 .",
    "( b ) entropy of immunization sets of density @xmath183 as function of @xmath148 ( obtained in creasing @xmath145 for @xmath160 ) .",
    "[ fig - optpe - sis],title=\"fig : \" ]   of the probability @xmath171 that a node is infected in the stationary state of the sis process on random regular graphs of degree @xmath19 , @xmath154 , @xmath155 , @xmath182 and different values of @xmath145 and @xmath156 .",
    "( b ) entropy of immunization sets of density @xmath183 as function of @xmath148 ( obtained in creasing @xmath145 for @xmath160 ) .",
    "[ fig - optpe - sis],title=\"fig : \" ]    for @xmath154 , the bp results have been obtained using a discretization of the interval @xmath101 $ ] in @xmath184 bins . in general , the smallest possible non - zero value assumed by @xmath171 is @xmath185 , therefore in order to have a sufficiently good resolution , one should always use @xmath186 . as the time complexity of the bp and",
    "ms algorithms scales as @xmath118 , working with histograms when @xmath30 is small is a problem .",
    "a possible solution is that of adopting a mixed representation , such as @xmath187.\\ ] ] that exploits the knowledge of the position of the first @xmath188 delta peaks of the distribution @xmath169 computed solving the underlying equations for @xmath71 or @xmath13 on small structures .",
    "this approach will be developed in a future work .",
    "a comparison between different optimization methods should take into account both the performances of the optimization and the efficiency of the algorithms .",
    "random regular graphs with uniform parameters are not a particularly good setup to compare different methods because all nodes are equally important .",
    "this is visible in fig.[fig - rrgcompare]a which displays , for the sir model , the curve @xmath148 as function of @xmath151 obtained by several different immunization algorithms : a recalculated degree centrality ( green dot - dashed line ) , recalculated eigenvector centrality ( blue line ) , greedy algorithm ( maroon dashed line ) and density - constrained simulated annealing ( red squares ) .",
    "the results on a rrg with @xmath18 are compared with the best optimization predicted using density - constrained bp equations on infinitely large rrg ( violet crosses ) .",
    "for the same optimization problem , the energy as function of the density of immunized nodes is shown in fig.[fig - rrgcompare]b ( we set @xmath189 ) .",
    "greedy and topologically - based algorithms perform very similarly , and approximately the same result is obtained with fixed - density simulated annealing , even in case of rather slow annealing schedules with up to @xmath190 steps between @xmath191 and @xmath192 .",
    "the bp prediction suggests that ( at least for infinitely large graphs ) slightly lower energy values could be reached for intermediate values of @xmath151 .",
    "remarkably , using just @xmath193 bins , the ms algorithm was able to find an immunization set at such lower energies ( black vertical cross ) , that is expected to be the optimal one .",
    "we note that the plain ms equations do not always converge .",
    "to overcome this difficulty , we employed the reinforcement technique  @xcite .",
    "we also ran simulated annealing with @xmath194 steps and without density constraints , and we found the same optimal point .",
    "notice that , although the computational time of mc based methods is comparable with that of ms for graphs of few thousands of nodes , simulating annealing becomes unfeasible for large - scale networks .",
    "nodes and degree @xmath19 for the sir model ( with @xmath154 , @xmath155 ) : ( a ) average fraction of infected nodes @xmath148 vs. average fraction of immunized nodes @xmath151 , ( b ) energy ( for @xmath195 ) vs. average fraction of immunized nodes @xmath151 . reported results include : simulated annealing ( red squares ) , eigenvectors centrality ( blue full line ) , degree centrality ( green dot - dashed line ) , greedy ( maroon dashed line ) and the best obtained solving fixed - density bp equations ( violet crosses ) and ms ( black vertical cross ) .",
    "random immunization is also reported ( black line for the bp results with @xmath157 and yellow circles for the results of direct stochastic simulations ) .",
    "[ fig - rrgcompare ] ]    we also analyzed some epidemic properties associated with the immunization set found by ms and compared them to those expected solving the bp equations in the single - link approximation at the same density @xmath196 .",
    "figure [ fig - optpe - sir363]a displays the behavior of @xmath169 computed using bp for different values of @xmath156 and @xmath145 , and the same quantity obtained solving - for the configuration of immunized nodes obtained using the ms algorithm ( crosses ) .",
    "the accord between the latter and the bp results for large @xmath145 values is very good .",
    "for the same choice of parameters , figure [ fig - optpe - sir363]b shows the entropy as function of the density of infected nodes @xmath179 ( obtained performing bp for increasing values of @xmath145 )",
    ". the entropy decreases monotonically and vanishes at @xmath197 , that indicates the minimum level of infection attainable at that density of immunized nodes .",
    "the vertical line marking the density of immunized nodes found in the solution obtained using the ms algorithm on a graph of @xmath18 nodes perfectly matches this lower bound .     of the probability @xmath171 that a node got infected during the sir process on random regular graphs of degree @xmath19 , @xmath154 , @xmath155 , @xmath182 and different values of @xmath145 and @xmath156 .",
    "( b ) entropy of immunization sets of density @xmath198 as function of @xmath148 ( obtained in creasing @xmath145 for @xmath160 ) .",
    "[ fig - optpe - sir363],title=\"fig : \" ]   of the probability @xmath171 that a node got infected during the sir process on random regular graphs of degree @xmath19 , @xmath154 , @xmath155 , @xmath182 and different values of @xmath145 and @xmath156 .",
    "( b ) entropy of immunization sets of density @xmath198 as function of @xmath148 ( obtained in creasing @xmath145 for @xmath160 ) .",
    "[ fig - optpe - sir363],title=\"fig : \" ]    we performed the comparison between different optimization algorithms on a real - world network with non - homogeneous topology .",
    "the chosen network , a fully symmetric version of a friendship network among 685 students of a school in the u.s .",
    "@xcite , is of moderate size in order to make possible a direct comparison of the different methods with a simulated annealing with sufficiently slow annealing schedule .",
    "figure [ fig - school1sir ] shows that , increasing the density of immunized nodes , greedy methods rapidly depart from the optimal curve obtained with density - constrained simulated annealing . on the contrary , heuristic algorithms based of topological metrics",
    "performs quite well in finding low energy immunization sets , possibly because of the heterogeneous topological structure of the graph .",
    "the optimal point found using the ms algorithm is slightly better than those obtained with all other methods .",
    ", @xmath155 ) on a friendship network of @xmath199 individuals : ( a ) average fraction of infected nodes @xmath148 vs. average fraction of immunized nodes @xmath151 , ( b ) energy ( for @xmath200 ) vs. average fraction of immunized nodes @xmath151 .",
    "we report results obtained using : an energy - based greedy algorithm ( black full line ) , fixed - density simulated annealing ( red circles ) , degree centrality ( blue dot - dashed line ) and eigenvector centrality ( green dashed line ) , ms ( black cross ) .",
    "[ fig - school1sir ] ]    when inhomogeneous costs are added , the algorithms based on topological metrics are ruled out .",
    "although they might work very well for some values of @xmath150 ( the parameter governing the tradeoff between terms in the energy ) , they do not take into account the contribution to the energy associated with the additional parameters .",
    "energy - based methods are more flexible as they adapt to variations of all parameters appearing in the energy .",
    "the greedy algorithm is however limited by the incremental procedure , that finds local minima of the energy with a rather small density of immunized nodes .",
    "adding further nodes to the immunization set , the results tend to worsen . on the contrary , simulated annealing and the ms algorithm",
    "are able to find immunization sets with a larger number of immunized nodes but overall less expensive .",
    "this phenomenon is observed in the data reported in figure [ fig - karatesir ] , where we analyzed immunization strategies for the sir model on the famous zachary s karate club network of @xmath201 individuals .",
    "on such a small network , the immunization sets obtained by simulated annealing ( performed with @xmath190 mc steps between @xmath191 and @xmath202 ) are likely to correspond to the global energy minima ( for each value of @xmath151 ) . in order to generate a rough energy landscape , we considered immunization costs that are correlated with the degree of the nodes ( @xmath203 , where @xmath105 is the degree of @xmath3 ) .",
    "figure [ fig - karatesir ] shows that both for @xmath154 and @xmath164 , changing the trade - off between the terms of the energy ( i.e. increasing @xmath150 ) the optimal immunization set is found at very different ( larger ) values of the density @xmath151 .",
    "ms correctly finds the optimal immunization set for all cases under study ( black vertical crosses in fig.[fig - karatesir ] ) .     for immunization sets obtained using degree ( green triangles ) and eigenvector centrality ( black circles ) , the greedy algorithm ( red squares ) , and fixed - density simulated annealing ( blue crosses ) , for the sir model on zachary s karate club network of @xmath204 individuals .",
    "the ms results are indicated by black vertical crosses .",
    "the immunization cost was assumed to be half of the degree of a node .",
    "[ fig - karatesir ] ]",
    "in this work , we considered the optimization problem of targeted network immunization against epidemic spreads . the corresponding energy function to be minimized is a tradeoff between the costs of immunizing nodes and the expected extent of the infection .",
    "this optimization problem turns out to be computationally worst - case intractable ; it was proven np hard even for very simple stochastic propagation models . for two prototypical models of stochastic epidemic spreading , the sir and sis models , we considered mean - field equations that can be used to evaluate the level of infection in the stationary state associated to every configuration of immunized nodes .",
    "the original energy function and the problem of finding the optimal immunization set can be ( approximately ) recast in terms of these mean - field variables in a mixed representation in which the selection of nodes to be immunized is represented by binary variables and the local level of infection ( in the stationary state ) is expressed by continuous variables in @xmath101 $ ] . in this formulation ,",
    "constraints and energy terms are local , allowing the application of the cavity method and the development of efficient message - passing algorithms such as bp .",
    "our results obtained using bp equations on random regular graphs shed light on the statistical properties of immunization sets , uncovering in which regions of the parameter space , and to what extent , targeted immunization is actually more effective than random immunization .",
    "the zero - temperature limit of these equations gives the ms algorithm , that can be used to find a solution to the optimization problem .",
    "we showed , both on synthetic and real networks , that the ms algorithm outperforms several popular immunization methods based on topological metrics and greedy strategies .",
    "the solution found using ms is not guarantee to be optimal , therefore we also performed simulated annealing , that is able to reach the optimum , at least for a sufficiently slow ( maybe exponential ) annealing schedule . for networks of moderate size",
    ", we could compare the lowest - energy immunization set found by mc methods with the solution found by ms .",
    "the latter was always at least as good as the former , providing an experimental evidence of the validity of the optimization technique .",
    "moreover , unlike mc - based methods , the ms algorithm scales only linearly with the network size . as a drawback ,",
    "the algorithm scales as @xmath118 , where @xmath102 is the number of bins necessary to represent the distribution of real values as histograms .",
    "we emphasize that the discretization method used in the current implementation is a very naive and straight - forward one , and there are several ways to considerably reduce @xmath102 by adopting more efficient representation of the messages ( as explained in sec.[sec5 ] ) .",
    "for this reason we expect that message - passing algorithms as the one proposed here could be used to study the immunization problem even on very large networks",
    ". this will be the scope of future research .",
    "the results of the comparison between different optimization methods on a variety of networks show that , as long as the network and the parameters are sufficiently homogeneous , all methods give approximately the same results . in this case",
    ", heuristic strategies based on topological metrics , such as degree - centrality or eigenvector centrality could be preferred , as they are very simple and fast .",
    "when the energy function includes inhomogeneous costs , simpler heuristics turned out to be sub - optimal in our experiments .",
    "moreover , greedy - based methods , that take into account the correct energy function , are based on a progressive scheme ( as immunized nodes are added incrementally ) and often fail to reach the ground state whenever the energy landscape is rugged .",
    "this is well demonstrated by results obtained on the small , but representative , zachary s karate club network .",
    "the method presented here could be applied to a number of other optimization problems including , but not restricted to , other epidemic models in discrete or continuous time , provided that similar fixed - point equations are defined for node or edge variables .",
    "the control variables in that case could be a set of node - dependent external parameters . using message - passing techniques it could be possible to select the configuration of external parameters that corresponds to some desired outcome for the global state of the system .",
    "this general formulation opens to a wide spectra of applications in problems involving the control of network dynamics .",
    "the heuristic algorithms considered in the paper are based on an incremental procedure , by means of which the algorithm adds one by one nodes to the immunization set , each time choosing the node that minimizes some score function .",
    "hence , given a graph @xmath205 and one of the scoring strategies described below , the immunization algorithm is based on the following iteration :        the actual definition of the score vector depends on the heuristic strategy considered . for degree centrality",
    ", the score of a node is just the number of non - immunized neighbors . for the eigenvector centrality",
    ", the score of a node is recursively a function of the scores of neighbors , @xmath210 where @xmath211 is a properly defined constant .",
    "the score vector @xmath207 satisfies the eigenvector equation @xmath212 , where @xmath213 is adjacency matrix , such that @xmath214 if there is an edge between nodes @xmath3 and @xmath9 and @xmath215 otherwise . under the condition that @xmath216 and the graph is connected , the constant @xmath211 corresponds to the greatest eigenvalue of the adjacency matrix ( perron - frobenius theorem )",
    "hence , the score vector @xmath207 can be computed by iteration from a homogeneous initial condition @xmath217 , @xmath24 using the power method , i.e. defining @xmath218 where @xmath219 is an appropriately defined normalization constant ( recomputed at each time step ) .",
    "if the iteration converges , it gives the eigenvector centrality of the nodes .    in the greedy algorithm implemented in the present paper ,",
    "the score of a node @xmath3 is equal to the variation in energy , computed from , associated with the addition of @xmath3 to the immunization set . given @xmath220 and @xmath221 , we define @xmath222      the space of @xmath43 binary configurations corresponding to immunization sets can be sampled using a montecarlo algorithm , that at large inverse temperature converges towards the the minima of the energy function @xmath97 . in practice ,",
    "starting from a randomly selected binary configuration , the convergence to a global minimum can be achieved only using an annealing schedule that guarantees a sufficiently slow decrease in temperature . given a randomly chosen initial condition @xmath223 , and an initial value @xmath224 for the inverse temperature @xmath145 , the adopted annealing schedule reaches a final value @xmath225 in a number @xmath226 of proposed single - spin flip .",
    "unfortunately , the number @xmath226 of steps required to reach the minimum of the energy at large @xmath145 often scales exponentially with the system size @xmath42 .      *",
    "choose an initial condition @xmath227 , set @xmath228 ; * randomly select a node @xmath3 to be flipped ; * given @xmath229 and @xmath230 compute the variation of energy @xmath231 ; * accept the move @xmath232 with probability @xmath233 ; * set @xmath234 * if @xmath235 , then go to point 1 .    in our simulations we tested different experimental setups , using both linear schedule with @xmath236 and a faster exponential one ,",
    "in which @xmath237 $ ] .",
    "we usually considered @xmath238 and @xmath225 between @xmath158 and @xmath22 with a number of single - spin proposed moves @xmath226 between @xmath190 and @xmath239 .    in the fixed - density simulated annealing algorithm",
    ", we considered only moves that do no change the number of immunized nodes , such as immunization exchange moves . in this case , the overall algorithm consists in repeating the annealing schedule for any possible value of the number of immunized nodes from @xmath240 to @xmath42 .",
    "52ifxundefined [ 1 ] ifx#1 ifnum [ 1 ] # 1firstoftwo secondoftwo ifx [ 1 ] # 1firstoftwo secondoftwo `` `` # 1''''@noop [ 0]secondoftwosanitize@url [ 0 ]",
    " + 12$12  & 12#1212_12%12@startlink[1]@endlink[0]@bib@innerbibempty link:\\doibase    10.1103/physrevlett.86.3200 [ * * ,   ( ) ] link:\\doibase    10.1103/physreve.63.066117 [ * * ,   ( ) ] link:\\doibase 10.1103/physreve.65.036104 [ * * ,   ( ) ] link:\\doibase 10.1103/physreve.65.056109 [ * * ,   ( ) ] link:\\doibase    10.1103/physrevlett.91.247901 [ * * ,   ( ) ] link:\\doibase    10.1209/epl / i2004 - 10286 - 2 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevlett.101.058701 [ * * , ( ) ] link:\\doibase 10.1371/journal.pone.0022124 [ * * ,   ( ) ] link:\\doibase 10.1103/physreve.84.061911 [ * * ,   ( ) ] link:\\doibase    10.1088/1367 - 2630/11/12/123018 [ * * ,   ( ) ] link:\\doibase    10.1371/journal.pcbi.1000736 [ * * ,   ( ) ] link:\\doibase 10.1002/rsa.20315 [ * * ,   ( ) ] link:\\doibase 10.1080/15427951.2009.10129184 [ * * ,   ( ) ] in  link:\\doibase    10.1109/drcn.2011.6076889 [ _ _ ] ( )  pp .",
    "link:\\doibase    10.1209/0295 - 5075/99/68007 [ * * ,   ( ) ] http://arxiv.org/abs/1303.3984[__ ] ,  ( ) link:\\doibase 10.1016/j.procs.2013.05.454 [ * * , ( ) ] in  link:\\doibase    10.1145/956750.956769 [ _ _ ] ,  ( ,  ,  )  p.",
    "@noop _ _ ,  ( ,  ) link:\\doibase 10.1016/j.jcss.2006.02.003 [ * * ,   ( ) ] in  link:\\doibase 10.1145/1807342.1807370 [ _ _ ] ,  ( ,  ,  )  p.   in  link:\\doibase    10.1145/1963405.1963499 [ _ _ ] ,  ( ,  ,  )  p.",
    "link:\\doibase 10.1007/s00134 - 011 - 2341-y [ * * ,   ( ) ] in  link:\\doibase 10.1145/2380718.2380746 [ _ _ ] ,  ( ,  ,  )  p.   ( ,  ) link:\\doibase    10.1088/1742 - 5468/2011/11/p11009 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevlett.106.190601 [ * * ,   ( ) ] link:\\doibase    10.1103/physreve.87.062115 [ * * ,   ( ) ] http://arxiv.org/abs/1203.1426[__ ] ,  ( ) @noop _ _  ( ,  ,  ) link:\\doibase    10.1137/s0036144500371907 [ * * ,   ( ) ] link:\\doibase    10.1098/rspa.1927.0118 [ * * ,   ( ) ] link:\\doibase    10.1103/physreve.66.016128 [ * * ,   ( ) ] link:\\doibase 10.1088/1742 - 5468/2005/08/p08011 [ * * ,   ( ) ] link:\\doibase    10.1103/physreve.82.016101 [ * * ,   ( ) ] link:\\doibase    10.1145/1284680.1284681 [ * * ,   ( ) ] link:\\doibase    10.1103/physrevlett.105.218701 [ * * ,   ( ) ] link:\\doibase    10.1007/s00607 - 011 - 0155-y [ * * ,   ( ) ] link:\\doibase 10.1016/j.comcom.2012.04.015 [ * * ,   ( ) ] link:\\doibase    10.1209/0295 - 5075/97/48004 [ * * ,   ( ) ] link:\\doibase 10.1103/physreve.86.016116 [ * * ,   ( ) ] link:\\doibase 10.1103/physreve.87.012811 [ * * ,   ( ) ] link:\\doibase    10.1103/physreve.86.026116 [ * * ,   ( ) ] link:\\doibase 10.1103/physreve.82.035101 [ * * ,   ( ) ] link:\\doibase    10.1103/physrevlett.109.128702 [ * * ,   ( ) ] link:\\doibase 10.1016/j.mbs.2012.07.002 [ * * , ( ) ] @noop _ _ , vol .",
    "( ,  ) @noop _ _  ( , ) link:\\doibase    10.1103/physrevlett.104.207208 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevlett.101.037208 [ * * ,   ( ) ] link:\\doibase    10.1073/pnas.1004751108 [ * * ,   ( ) ] ,   link:\\doibase    10.1016/s0378 - 8733(01)00042 - 9 [ * * ,   ( ) ]"
  ],
  "abstract_text": [
    "<S> the problem of targeted network immunization can be defined as the one of finding a subset of nodes in a network to immunize or vaccinate in order to minimize a tradeoff between the cost of vaccination and the final ( stationary ) expected infection under a given epidemic model . </S>",
    "<S> although computing the expected infection is a hard computational problem , simple and efficient mean - field approximations have been put forward in the literature in recent years . </S>",
    "<S> the optimization problem can be recast into a constrained one in which the constraints enforce local mean - field equations describing the average stationary state of the epidemic process . for a wide class of epidemic models , including the susceptible </S>",
    "<S> - infected - removed and the susceptible - infected - susceptible models , we define a message - passing approach to network immunization that allows us to study the statistical properties of epidemic outbreaks in the presence of immunized nodes as well as to find ( nearly ) optimal immunization sets for a given choice of parameters and costs . </S>",
    "<S> the algorithm scales linearly with the size of the graph and it can be made efficient even on large networks . we compare its performance with topologically based heuristics , greedy methods , and simulated annealing . </S>"
  ]
}