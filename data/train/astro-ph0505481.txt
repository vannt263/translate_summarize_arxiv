{
  "article_text": [
    "many astrophysical phenomena involve gas moving at relativistic speeds .",
    "classical sources include active galactic nuclei ( agn ) , microquasars , pulsar wind nebulae and gamma - ray bursts ( grbs ) .",
    "more recently , conclusive evidence has mounted that a subset of core collapse supernovae are associated with long duration ( @xmath0 s ) grbs ( e.g. , * ? ? ?",
    "* ; * ? ? ?",
    "astrophysical processes at the endpoint of stellar evolution thus appear capable of accelerating flows to ultra - relativistic speed ( @xmath1 , where @xmath2 denotes lorentz factor . )    additionally , the fading afterglows of cosmological grbs are now observed with an increasing rate by the swift satellite @xcite .",
    "grb afterglows are produced after the gamma - ray producing relativistic flow transfers its energy to the circum - burst medium in the form of a strong relativistic shock .",
    "of particular interest is evidence that the ejecta producing grbs and their afterglows are beamed into jets .",
    "the quality of current afterglow observations require high - resolution multi - dimensional simulations of jetted relativistic shocks for interpretation .",
    "relativistic hydrodynamics simulations are more difficult than newtonian simulations @xcite . however , there has been much progress in relativistic numerical simulations during the past decade due to the development of modern numerical methods and the increasing power of computers .",
    "we refer the reader to a comprehensive review of numerical relativistic hydrodynamics by @xcite and references therein . the so - called high - resolution shock - capturing ( hrsc ) methods , which are based on the fact that special relativistic hydrodynamics ( srhd ) with causal equation of state is a hyperbolic system of conservation laws @xcite , are particularly promising in modern numerical simulations .",
    "they can achieve very high accuracy and handle ultra - relativistic flows , strong shocks and contact discontinuities extremely well .",
    "genesis @xcite is a very efficient scheme based on hrsc techniques .",
    "the high - order essentially non - oscillatory ( eno ) shock capturing schemes @xcite have been very successful in numerically solving hyperbolic systems e.g. , the eulerian gas dynamics equations .",
    "eno - based methods have previously been implemented for computational relativistic hydrodynamics @xcite .",
    "the weighted essentially non - oscillatory ( weno ) schemes ( e.g. , * ? ? ? * ; * ? ? ?",
    "* ) are recent developments following the philosophy of eno schemes .",
    "adaptive mesh refinement ( amr ) has played an increasingly important role in many branches of numerical astrophysics including e.g. , cosmology , star formation , jets , interacting binaries , stellar wind collisions , and supernova explosion and remnant evolution ( see * ? ? ? * and references therein ) .",
    "examples of recent work in numerical astrophysics include using amr to solve the equations of hydrodynamics @xcite , magnetohydrodynamics ( mhd ) @xcite , special relativistic hydrodynamics ( srhd ) @xcite , general relativistic hydrodynamics @xcite and general relativistic mhd @xcite .    in this paper , we describe a new modular , highly accurate , special relativistic hydrodynamics code with adaptive mesh refinement , ram ( * r*elativistic * a*daptive * m*esh ) .",
    "the modular design of the code allows us to easily change between various algorithms .",
    "we have implemented the fifth - order weno scheme of @xcite in srhd for the first time as one of the modules .",
    "we have also implemented an hrsc module using the modified marquina flux formula @xcite and piecewise parabolic reconstruction @xcite similar to the genesis code @xcite .",
    "we also use piecewise linear reconstruction ( plm ) with both weno and hrsc and perform comparisons between all methods for several standard test cases .",
    "we present detailed tests of the code demonstrating its ability to handle the extreme resolution requirements of simulating ultra - relativistic flows .    a primary motivation in writing the ram code is to study the relativistic explosions producing cosmological grbs .",
    "we plan to use ram to simulate the relativistic flows produced at the endpoint of stellar evolution .",
    "in particular , numerical simulations of the collapsar model for grbs @xcite are very challenging because of the ultra - relativistic speed and detailed micro - physics involved in the problem",
    ". relativistic hydrodynamical simulations of jets in collapsars have been done successfully by several authors @xcite using the genesis method .",
    "we plan to use ram to extend these calculations to higher resolution over a larger dynamic range in lengthscale made possible by amr .",
    "in   [ sec : eqns ] we present the fundamental equations of srhd and describe the conserved variables evolved by our code . in ",
    "[ sec : schemes ] we describe the flux differenced semi - discrete form of the equations we solve , the algorithms used for construction of numerical fluxes and how the equations are integrated in time . in ",
    "[ sec : test ] we present results from standard test problems on a fixed uniform mesh including convergence tests . in   [ sec : amr ] we describe the adaptive mesh refinement algorithm employed in ram by utilizing components of the flash code @xcite , which in turn adapted the paramesh package @xcite . in ",
    "[ sec : amrtest ] we present test problems run with amr in one , two , and three dimensions including riemann problems with transverse velocity , a 2d axisymmetric jet in cylindrical coordinates and a 3d blast wave . in   [ sec : summary ] we summarize the results of the paper . in appendix  [ app ]",
    "we provide details of our implementation of srhd in curvilinear coordinates .",
    "the governing equations of special relativistic hydrodynamics ( srhd ) describe the conservation of rest mass and stress - energy of a fluid : @xmath3 and @xmath4 where @xmath5 is the rest mass density measured in the fluid frame , @xmath6 is the fluid four - velocity , @xmath2 is the lorentz factor , @xmath7 is the speed of light , @xmath8 is the classical three - velocity , @xmath9 is the stress - energy tensor of the fluid and the subscript @xmath10 denotes the covariant derivative . for a perfect fluid",
    "the stress - energy tensor is @xmath11 where @xmath12 is the relativistic specific enthalpy , @xmath13 is the specific internal energy , @xmath14 is the pressure and @xmath15 is the inverse metric which here we take to be the minkowski metric though extension to curved spacetimes is evident .    srhd can be written as a set of conservation laws ( see , e.g. * ? ? ?",
    "* ) , @xmath16 where the conserved variable @xmath17 is given by @xmath18 and the fluxes are given by @xmath19 here @xmath20 is the kronecker symbol and @xmath21 is the velocity . the conserved variables @xmath17 include rest mass density , @xmath22 , the momentum density , @xmath23 , and energy density , @xmath24 .",
    "they are measured in the laboratory frame , and are given by ( assuming the speed of light @xmath25 ) , @xmath26 where @xmath27 , @xmath2 is the lorentz factor .",
    "the equations  [ dudt ] are closed by an equation of state ( eos ) given by @xmath28 . for an ideal gas ,",
    "the eos reads , @xmath29 where @xmath30 is the adiabatic index of the ideal gas .",
    "to numerically solve eq .",
    "[ dudt ] , each spatial dimension is discretized into cells . using the method of lines , the time dependent evolution of eq .",
    "[ dudt ] can be expressed in the semi - discrete form @xmath31 where @xmath32 , @xmath33 and @xmath34 are the fluxes at the cell interface .    in order to achieve high - order accuracy in time ,",
    "the time integration is done using a high - order total variation diminishing ( tvd ) runge - kutta scheme @xcite , which combines the first - order forward euler steps and involves prediction and correction .",
    "for example , the third - order accuracy can be achieved via @xmath35 where @xmath36 is the right hand side of eq .",
    "[ disdudt ] , @xmath37 is the final value after advancing one time step from @xmath38 . besides the third - order runge - kutta method ( rk3 ) , the standard fourth - order runge - kutta ( rk4 ) and fifth - order runge - kutta method ( rk5 ) @xcite can also be used for time integration .",
    "we usually use tvd rk3 in our calculations unless otherwise stated .",
    "we have also implemented and tested rk4 and rk5 and use them in some calculations .",
    "note the method of lines , treats information from corner zones differently than methods using time - averaged fluxes which make some use of corner information when implemented with strang splitting .",
    "recently , dimensionally unsplit methods have been developed @xcite which use the corner - transport upwind ( ctu ) method of @xcite to include corner information completely .",
    "ram , however , uses the third - order runge - kutta algorithm for time integration consisting of several forward euler substeps which are corrected to achieve high accuracy .",
    "since the final results after one full time step are computed through several substeps , the corner cells ( e.g. , ( @xmath39 ) ) of a zone at ( @xmath40 ) affect its evolution in a full step , although this is not the case for an individual substep (   [ sec : f - x ] &   [ sec : u - x ] ) . in this sense , ram",
    ", is dimensionally unsplit .",
    "comparison with codes using ctu methods on multi - dimensional test problems would be of value to perform in the future .",
    "we note that multi - dimensional test problems we have run with ram preserve symmetries present in the initial conditions ( see , e.g. , fig .",
    "[ fig : riemann2d ] ) .    to solve the fluxes across the cell interfaces ,",
    "we have implemented two schemes .",
    "both schemes involve a reconstruction step to compute the variables at the cell interfaces . in the first class of schemes (   [ sec : f - x ] ) , the reconstruction is carried out on fluxes .",
    "the interface flux is obtained by , @xmath41 where the stencil @xmath42 depends on the choice of the reconstruction scheme .",
    "this class can be considered finite difference schemes .",
    "we use f - x to denote this class of schemes , where x stands for the reconstruction scheme . in the other class of schemes (   [ sec : u - x ] ) , the reconstruction is carried out on the unknown variables .",
    "then the interface unknowns , @xmath43 , are used to obtain interface fluxes , @xmath44 where @xmath45 and @xmath46 denote the left and right side of the interface @xmath47 , respectively .",
    "the flux function @xmath48 is an approximate riemann solver .",
    "the cell unknowns @xmath49 are considered as cell averages .",
    "thus , the second class can be considered as finite volume schemes .",
    "we use u - x to denote the second class of schemes , where x stands for the reconstruction scheme .      in the f - x schemes ,",
    "we have implemented the weighted essentially non - oscillatory ( weno ) scheme and piecewise linear method ( plm ) for the reconstruction of fluxes .",
    "essentially non - oscillatory ( eno ) finite difference schemes @xcite for equations of hyperbolic conservation laws use adaptive stencils in calculating the fluxes across the cell interfaces so that high - order accuracy can be achieved and numerical oscillations near discontinuities can be significantly reduced .",
    "later total variation diminishing ( tvd ) runge - kutta methods were applied to eno schemes to make the schemes more computationally efficient , and the eno reconstructions were carried out on fluxes instead of cell averages @xcite .",
    "eno schemes have been further improved by many researchers ( see * ? ? ? * for a review ) .",
    "one improved scheme is the fourth - order weighted essentially non - oscillatory ( weno ) scheme which was first introduced by @xcite . in the weno schemes , a weighted combination of several possible stencils",
    "are used instead of just one stencil .",
    "this would improve the accuracy while keeping the essentially non - oscillatory property near discontinuities .",
    "a new algorithm for computing the weights has been used in a modified fifth - order weno scheme developed by @xcite .",
    "the weno scheme of @xcite has been applied by @xcite to cosmological simulations . in this paper , we have implemented the fifth - order modified weno scheme of @xcite in special relativistic hydrodynamics .",
    "the weno schemes for hyperbolic conservation laws have various forms @xcite .",
    "the particular weno scheme we use is the characteristic - wise flux splitting finite difference scheme .    in the weno scheme",
    ", the partial differential equations are discretized into cells in spatial dimensions ( eq .",
    "[ disdudt ] ) .",
    "the evolution of the partial differential equations is solved by using a tvd runge - kutta scheme .",
    "the key component of the weno scheme is to compute the fluxes at the cell interfaces . as an example",
    ", we shall consider the @xmath50-direction flux across the cell interface between @xmath51 and @xmath52 .",
    "we shall assume that states at @xmath53 , @xmath54 , @xmath55 , and @xmath56 are either in the computational domain or can be supplied by boundary conditions .",
    "first , we construct a roe type average state at the cell interface @xmath57 from the left state at @xmath51 and right state at @xmath52 .",
    "the eigenvectors of the average state will be used as the basis for the decomposition of fluxes , @xmath58 , where @xmath59 .",
    "we use @xmath60 as weight @xcite to compute the weighted averaged of pressure , density , and velocity . strictly speaking",
    ", this does not satisfy all of the roe s conditions @xcite .",
    "however , we do not use the average state to compute the flux directly .",
    "therefore strict roe s conditions are not required .",
    "indeed , simply taking arithmetic averages of the primitive variables also works very well .    for special relativistic hydrodynamics equations , the complete characteristic structure of these hyperbolic equations",
    "have been derived by @xcite .",
    "thus it is feasible to extend the characteristic - wise weno to special relativistic hydrodynamics knowing the eigenvalues and eigenvectors of the jacobian matrices of the equations .",
    "the eigenvalues of the jacobian matrices , @xmath61 namely the speed of characteristic waves , can have different signs .",
    "in other words , these waves could propagate towards different directions .",
    "the second step of the weno scheme is to split the flux into left - going and right - going fluxes so that we can treat them separately",
    ". this flux splitting approach can avoid entropy violation and make the scheme more robust .",
    "we use the local lax - freiderichs splitting given by , @xmath62 where @xmath63 is the local maximum of the absolute values of wave speed for states at @xmath64 .",
    "the eigenvalues are all positive for the right - going flux @xmath65 , whereas they are negative for the left - going flux @xmath66 .",
    "because of the obvious symmetry between the left - going flux @xmath66 and right - going flux @xmath65 , we shall only consider here the right - going waves .",
    "the stencil for the right - going waves at @xmath47 , which consists of @xmath67 in the fifth - order weno scheme , is slightly upwind - biased .",
    "we can expand @xmath68 , where @xmath69 , in terms of the five right eigenvectors @xcite of the average state at @xmath47 , @xmath70 , where @xmath71 .",
    "the expansion is given by , @xmath72 where , @xmath73 .",
    "it is very straightforward to compute @xmath74 since we also know the left eigenvectors , @xmath75 , of the jacobian matrix .",
    "@xmath74 is given by , @xmath76    given @xmath74 , we can construct the coefficients @xmath77 for the cell interface at @xmath57 by giving different weights to different @xmath74 .",
    "the weights depend upon the smoothness of the stencils , and smooth stencils are given more weight .",
    "this results in the fifth - order accuracy in smooth region and eno near discontinuities . for the details of",
    "how the weights are chosen in the weno reconstruction scheme , we refer the readers to the work of @xcite .    using the coefficients @xmath77 , where @xmath78 denotes characteristic waves , the right - going flux at the cell interface at @xmath57",
    "is given by , @xmath79 because of the obvious symmetry , the left - going flux , @xmath80 , can be computed in the similar procedure . note",
    "that the left - going flux is also upwind - biased , namely right - biased .    in computing the weno weights , a parameter , @xmath13 ,",
    "is introduced to avoid denominator being zero .",
    "this is the only free parameter in the weno scheme .",
    "moreover , the results are insensitive to the value of @xmath13 as long as it is a small number about @xmath81 .",
    "we use f - weno to denote the above method , which uses the weno scheme for the characteristic - wise reconstruction of splitted fluxes .",
    "the reconstruction of the coefficients @xmath77 from @xmath74 can also be computed using other high - order reconstruction algorithms instead of the weno reconstruction algorithm of @xcite .",
    "besides the weno , we have also implemented the plm for the reconstruction with a generalized minmod slope limiter @xcite .",
    "given @xmath82 , @xmath83 , and @xmath84 , the left - biased interface value reads , @xmath85 where @xmath86 , and the minmod function reads , @xmath87 here the @xmath88 function returns the sign of the number .",
    "this becomes the more diffusive normal minmod limiter when @xmath89 , and becomes the monotonized central - difference limiter of @xcite when @xmath90 .",
    "we usually use @xmath91 unless otherwise stated .",
    "we call this method f - plm .",
    "our numerical tests show that the results of f - plm are comparable to those of f - weno (   [ sec : test ] ) .",
    "besides the f - x schemes (   [ sec : f - x ] ) , we have also implemented another method of computing the flux at the interface to work with the runge - kutta scheme for time integration of eq .",
    "[ disdudt ] . in this class of schemes , u - x , instead of reconstructing flux directly as in the f - x schemes , a left state and a right state at the interface are reconstructed , and then the flux at the interface is calculated using these two states .",
    "a lot of recent methods , including the so - called high - resolution shock - capturing ( hrsc ) methods like the genesis method @xcite and some high - resolution central schemes @xcite , can be considered to be in this category .",
    "their main difference is how to compute the flux at the interface given the left and right states and how to reconstruct interface states .",
    "in the hrsc methods , an approximate riemann solver utilizing the information of the characteristic waves is used , whereas the central schemes use simplified expressions for the flux without using the characteristic information beyond the fastest wave speed , which is nevertheless required for the courant - friedrich - levy ( cfl ) condition .",
    "the reconstruction of states at the cell interfaces is usually performed by a high - order interpolation method like the piecewise parabolic method ( ppm ) @xcite or piecewise linear method ( plm ) .",
    "we have implemented both reconstruction methods in the ram code . for the parameters in the ppm algorithm",
    ", we choose the values suggested by @xcite for almost all the tests with ppm .",
    "we consider it undesirable to fine - tune these parameters to achieve better agreement with analytic solutions for specific tests .",
    "doing so , we believe , can create a false sense of how a given code performs in general simulations for which the exact solution is not previously known . for the plm algorithm , we use a generalized minmod slope limiter as described in   [ sec : f - x ] .",
    "again , the parameter @xmath91 is used by default .",
    "the reconstruction is performed on the so - called primitive variables instead of conserved variables because unphysical conserved variables may arise otherwise .",
    "the pressure and the proper density are reconstructed directly , whereas velocities are reconstructed using a combination of reconstructing three - velocity and lorentz factor . since both the velocities and lorentz factor are reconstructed , they are unlikely to be self consistent . to make them consistent ,",
    "four - velocities are derived by multiplying three - velocities with lorentz factor . using these four - velocities ,",
    "new consistent velocities and lorentz factor could be derived .",
    "we found that this procedure is usually more robust than using only three - velocities or only four - velocities for the construction of velocity and lorentz factor .    to compute the flux across the cell interface",
    "given the reconstructed right and left states at the interface , we have implemented several riemann solvers including the modified marquina s flux @xcite , local lax - friedrichs flux and relativistic hlle @xcite in the ram code .",
    "a comparison of several schemes for computing the flux has been performed by @xcite .",
    "they have shown that the results are relatively independent of the flux schemes .",
    "for the results shown in this paper , the modified marquina s algorithm is used to compute the interface fluxes .      since",
    "our code is explicit , the time step for integration is subject to the courant - friedrich - levy ( cfl ) condition .",
    "we usually choose a cfl number to be @xmath92-@xmath93 .",
    "unfortunately , it is not always failsafe .",
    "occasionally unphysical results can be produced for ultra - relativistic flows unless a very small cfl number or a diffusive scheme is used . but a very small cfl number is sometimes unacceptable because of the time it costs . to make the code robust ,",
    "a fall - back mechanism is employed in our code , though we found that such failures rarely occur .",
    "that is a normal cfl number is used for the first try of time integrations .",
    "if it fails , the code will return to the beginning of the failed step and use more diffusive schemes for reconstruction and/or use a smaller time step .",
    "the recalculation with more diffusive schemes is performed on the whole grid , when amr is not being used .",
    "the fall - back method on amr grids will be further discussed in ",
    "[ sec : amr ] .",
    "the fall - back requires us to keep a copy of the original states of conserved variables for a period of the whole runge - kutta step in order to be able to fall back .",
    "fortunately , the runge - kutta scheme we use @xcite requires the original states to be saved anyway ( eqns .",
    "[ eq : rk3:1 ] ,  [ eq : rk3:2 ] ,  &  [ eq : rk3:3 ] ) .",
    "thus it does not increase the memory usage of the computation .",
    "in the subsequent steps , the normal reconstruction scheme will be used and the cfl number will gradually increase to its normal value if it was previously decreased .",
    "the fall - back mechanism makes the code almost failsafe .",
    "if unphysical results persist even when the first - order method is employed and a very small time step is used , the numerical simulation will stop .",
    "one possible remedy when the code runs out of methods is to set the pressure of bad cells to a floor value .",
    "fortunately this has never happened in our simulations .    in each time step , conserved variables @xmath94 are updated directly . in order to calculate the fluxes at the cell interfaces , physical variables : pressure ,",
    "proper rest mass density and velocity need to be computed .",
    "the processes of recovering physical variables from conserved variables involve a quartic equation for velocity ( e.g. , * ? ? ?",
    "* ) . though the quartic can be solved analytically , computing the analytic solution is actually more expensive than a simple numerical root finder , such as newton - raphson iteration . before the newton - raphson iteration , a certain condition , @xmath95 ,",
    "is checked to make sure that physical results can be produced from given conserved variables .",
    "sometimes , unphysical results , such as negative pressure and large velocity @xmath96 , will be produced .",
    "then the fall - back mechanism will be used until physical results are produced or the maximum allowed number of fall - back is reached .",
    "for any numerical code , it is very important to do substantial tests .",
    "we have done a series of tests with our code .",
    "some of the tests are the so - called riemann problems , which consist of computing the decay of an initial discontinuity of two constant states .",
    "it is possible to get exact solutions for relativistic riemann problems @xcite .",
    "we have also done some extensively studied problems which have no analytic solutions . in all cases , our results are comparable to published results . in this section , we will present our numerical results for some standard tests . we will compare four schemes (   [ sec : schemes ] ) : the finite difference characteristic - wise weno , the finite difference characteristic - wise plm , the finite volume component - wise ppm and the finite volume component - wise plm , denoted by f - weno , f - plm , u - ppm , and u - plm , respectively . a cfl number of 0.5 is used for these tests unless otherwise stated .      in this test ,",
    "the one - dimensional numerical region ( @xmath97 ) initially consists of two constant states : @xmath98 , @xmath99 , @xmath100 and @xmath101 , @xmath102 , @xmath103 , where @xmath104 stands for the left state , and @xmath48 the right state .",
    "the fluid is assumed to be an ideal gas with an adiabatic index @xmath105 .",
    "the initial discontinuity is at @xmath106 .",
    "the results are shown in fig .",
    "[ fig : rie1d1 ] . in this test problem ,",
    "the evolution of the initial discontinuity gives rise to a shock , a rarefaction wave , and a contact discontinuity .",
    "this is a fairly easy test .",
    "all modern special relativistic hydrodynamics codes can capture the expected features , acquire correct positions of the shock front , contact discontinuity and rarefaction wave . to quantitatively measure the errors , we calculated the @xmath107 norm errors , @xmath108 , where @xmath109 is the exact solution at @xmath110 and @xmath111 is the numerical result",
    ". the @xmath107 norm errors of density for four schemes with various grid resolutions at @xmath112 are shown in table  [ tab : rie1d1 ] .",
    "the accuracy of our results is comparable to that of @xcite .",
    "the order of the convergence rate is about @xmath113 .",
    "this is consistent with the fact that there are discontinuities in the solution .",
    "cccc f - weno & 100 & 1.31e-1 & + & 200 & 7.25e-2 & 0.85 + & 400 & 3.32e-2 & 1.1 + & 800 & 2.08e-2 & 0.67 + & 1600 & 1.00e-2 & 1.1 + & 3200 & 5.07e-3 & 0.98 + f - plm & 100 & 1.47e-1 & + & 200 & 8.50e-2 & 0.79 + & 400 & 4.06e-2 & 1.1 + & 800 & 2.33e-2 & 0.80 + & 1600 & 1.22e-2 & 0.93 + & 3200 & 7.48e-3 & 0.71 + u - ppm & 100 & 1.27e-1 & + & 200 & 7.30e-2 & 0.80 + & 400 & 3.47e-2 & 1.1 + & 800 & 1.97e-2 & 0.82 + & 1600 & 9.77e-3 & 1.0 + & 3200 & 5.10e-3 & 0.94 + u - plm & 100 & 1.32e-1 & + & 200 & 8.57e-2 & 0.62 + & 400 & 3.86e-2 & 1.2 + & 800 & 2.27e-2 & 0.77 + & 1600 & 1.15e-2 & 0.98 + & 3200 & 6.48e-3 & 0.83      in this test , the one - dimensional numerical region ( @xmath97 ) initially consists of two constant states : @xmath114 , @xmath115 , @xmath100 and @xmath116 , @xmath102 , @xmath103 , where @xmath104 stands for the left state , and @xmath48 the right state .",
    "the fluid is assumed to be an ideal gas with an adiabatic index @xmath105 .",
    "the initial discontinuity is at @xmath106 .",
    "the results are shown in fig .",
    "[ fig : rie1d2 ] . in this test problem",
    ", the evolution of the initial discontinuity gives rise to a right - moving shock , a left - moving rarefaction wave , and a contact discontinuity in between . behind the shock",
    ", there is an extremely thin dense shell .",
    "the width of the shell is only @xmath117 at @xmath112 .",
    "with 400 uniform zones for @xmath97 , the thin shell is only covered by @xmath118 zones . due to the smearing at the contact discontinuity and the shock , it is not surprising that the thin shell is not well resolved in our results with only 400 zones . at this resolution",
    "the maximum density in the shell for f - weno , f - plm , u - ppm and u - plm is 79% , 69% , 72% and 63% of the analytic value .",
    "however , there is no difficulty in resolving the thin shell with increased resolution .",
    "we have calculated the @xmath107 norm errors of density for various numerical resolutions ( see table [ tab : rie1d2 ] ) and achieve convergence as expected for problems with sharp discontinuities .",
    "the results are consistent with other published results ( e.g. , * ? ? ?",
    "cccc f - weno & 100 & 2.10e-1 & + & 200 & 1.42e-1 & 0.56 + & 400 & 9.29e-2 & 0.61 + & 800 & 5.54e-2 & 0.75 + & 1600 & 2.54e-2 & 1.1 + & 3200 & 1.51e-2 & 0.75 + f - plm & 100 & 1.96e-1 & + & 200 & 1.42e-1 & 0.46 + & 400 & 1.06e-1 & 0.42 + & 800 & 7.21e-2 & 0.56 + & 1600 & 3.92e-2 & 0.88 + & 3200 & 2.44e-2 & 0.68 + u - ppm & 100 & 2.18e-1 & + & 200 & 1.52e-1 & 0.52 + & 400 & 9.52e-2 & 0.68 + & 800 & 5.42e-2 & 0.81 + & 1600 & 2.67e-2 & 1.0 + & 3200 & 1.67e-2 & 0.68 + u - plm & 100 & 2.13e-1 & + & 200 & 1.65e-1 & 0.37 + & 400 & 1.25e-1 & 0.41 + & 800 & 8.68e-2 & 0.53 + & 1600 & 4.49e-2 & 0.95 + & 3200 & 2.71e-2 & 0.73      in this test , the one - dimensional numerical region ( @xmath97 ) initially consists of two constant states : @xmath119 , @xmath115 , @xmath120 and @xmath121 , @xmath102 , @xmath103 , where @xmath104 stands for the left state , and @xmath48 the right state .",
    "the fluid is assumed to be an ideal gas with an adiabatic index @xmath122 .",
    "the initial discontinuity is at @xmath106 .",
    "the results are shown in fig .",
    "[ fig : rie1d3 ] . in this problem",
    "a strong reverse shock forms in which post - shock oscillations are visible for the u - ppm and u - plm simulations , especially in the pressure profile . in the f - weno simulation ,",
    "the post - shock pressure oscillations is smaller those in the u - x simulations . in the f - plm simulation",
    "the post - shock pressure oscillation is nearly invisible to the eye , though they are still present at the 0.1% level .",
    "reducing the cfl number from 0.5 decreases the post - shock oscillations but does not eliminate them completely .",
    "table  [ tab : rie1d3 ] presents the @xmath107 norm errors and @xmath107 order convergence rates for this problem .",
    "note that the u - ppm scheme is more accurate and converges faster for this problem than other schemes .",
    "this is due to the fact that u - ppm scheme captures the contact discontinuity in fewer zones ( [ fig : rie1d3 ] ) .",
    "cccc f - weno & 100 & 9.97e-2 & + & 200 & 6.29e-2 & 0.67 + & 400 & 3.01e-2 & 1.1 + & 800 & 1.69e-2 & 0.83 + & 1600 & 9.48e-3 & 0.83 + & 3200 & 5.24e-3 & 0.86 + f - plm & 100 & 1.12e-1 & + & 200 & 6.98e-2 & 0.68 + & 400 & 3.45e-2 & 1.0 + & 800 & 1.94e-2 & 0.83 + & 1600 & 1.13e-2 & 0.78 + & 3200 & 6.54e-3 & 0.79 + u - ppm & 100 & 9.72e-2 & + & 200 & 5.60e-2 & 0.80 + & 400 & 2.49e-2 & 1.2 + & 800 & 1.30e-2 & 0.94 + & 1600 & 6.06e-3 & 1.1 + & 3200 & 3.11e-3 & 0.96 + u - plm & 100 & 9.53e-2 & + & 200 & 6.32e-2 & 0.59 + & 400 & 2.99e-2 & 1.1 + & 800 & 1.78e-2 & 0.75 + & 1600 & 1.04e-2 & 0.78 + & 3200 & 6.10e-3 & 0.77      many problems of interest in hydrodynamics involve strong shear flows .",
    "astrophysical jets include shearing layers where mixing of ambient material into the fast jet flow may be important .",
    "it is therefore important to test the ability of numerical codes to handle riemann problems with velocity components transverse to the direction of propagation of the main flow . in newtonian hydrodynamics the transverse momentum",
    "is simply advected with the flow and is not coupled directly to the equation of motion in the longitudinal direction .",
    "no serious difficulty is introduced by the presence of transverse velocity components though transverse kinetic energy dissipated through viscous dissipation can alter the longitudinal motion by affecting the pressure . however , in relativistic flow ,",
    "transverse velocities are directly coupled to the dynamics along all directions by the lorentz factor which depends on all velocity components .",
    "this coupling makes relativistic riemann problems with transverse velocity much more difficult to solve correctly in a numerical code .",
    "in particular , higher resolution is needed .",
    "under - resolved simulations produce incorrect shock positions along the normal direction . here",
    ", we present relatively easy 1d tests of riemann problems including transverse velocity which can be resolved with moderate resolution . in   [ sec : rievy2 ] we show tests requiring high resolution and demonstrate the ability of adaptive mesh refinement to accurately simulate very relativistic flows with significant transverse velocity components .    in this test ,",
    "the one - dimensional numerical region ( @xmath97 ) initially consists of two constant states : @xmath114 , @xmath115 , @xmath123 , @xmath124 and @xmath116 , @xmath125 , @xmath126 , @xmath127 , where @xmath104 stands for the left state , and @xmath48 the right state .",
    "the fluid is assumed to be an ideal gas with an adiabatic index @xmath128 .",
    "the initial discontinuity is at @xmath106 .",
    "the results are shown in fig .",
    "[ fig : rievy1 ] . in this test",
    ", the presence of transverse velocity alters the structure of the riemann problem @xcite .",
    "this problem is relatively easy because the transverse velocity is in the cold gas of the right state , not in the relativistically hot left state or in the rarefaction fan which subsequently propagates into it .",
    "the simulation agrees well with the analytic solution even at the relatively modest resolution of 400 zones .",
    "table  [ tab : rievy1 ] presents the @xmath107 norm errors and @xmath107 order convergence rates for this problem .",
    "cccc f - weno & 100 & 7.58e-1 & + & 200 & 3.92e-1 & 0.95 + & 400 & 2.31e-1 & 0.76 + & 800 & 1.18e-1 & 0.97 + & 1600 & 6.58e-2 & 0.84 + & 3200 & 3.44e-2 & 0.94 + f - plm & 100 & 8.26e-1 & + & 200 & 4.59e-1 & 0.85 + & 400 & 2.77e-1 & 0.73 + & 800 & 1.49e-1 & 0.89 + & 1600 & 8.00e-2 & 0.90 + & 3200 & 4.63e-2 & 0.79 + u - ppm & 100 & 8.48e-1 & + & 200 & 4.25e-1 & 1.0 + & 400 & 2.41e-1 & 0.82 + & 800 & 1.27e-1 & 0.92 + & 1600 & 6.43e-2 & 0.99 + & 3200 & 3.34e-2 & 0.95 + u - plm & 100 & 9.00e-1 & + & 200 & 4.72e-1 & 0.93 + & 400 & 2.88e-1 & 0.71 + & 800 & 1.52e-1 & 0.92 + & 1600 & 8.86e-2 & 0.78 + & 3200 & 4.95e-2 & 0.84      the shock heating problem is a standard test to study the ability of a code to handle very strong shocks with sufficiently few zones and without excessive post shock oscillations .",
    "cold gas flows toward a reflecting boundary at @xmath129 and a reverse strong shock forms and propagates to the left decelerating the gas to zero speed .",
    "the gas has an initial speed of @xmath130 ( corresponding to a lorentz factor of @xmath131 ) and initial density of @xmath132 .",
    "due to conservation of energy and the fact the gas initially has nearly zero internal energy compared to kinetic energy ( we use a small value @xmath133 for numerical reasons ) , the specific internal energy after the shock is simply @xmath134",
    ". the compression ratio across the shock can be arbitrarily large in the relativistic case and is given by @xmath135 where @xmath136 is the adiabatic index of the gas .",
    "in this case @xmath122 so @xmath137 and the shock velocity is given by @xmath138 . in fig .",
    "[ fig : heating1d ] we show our results for a uniform mesh of 100 zones compared with the analytic solution at @xmath139 .",
    "we note that for this problem with a constant state behind the shock , as opposed to a thin shell which might more naturally occur in a realistic flow , the maximum lorentz factor that can be achieved numerically is just limited by floating point precision .",
    "the parameter @xmath140 in the minmod slope limiter for u - plm is set to be @xmath141 in this test to eliminate strong oscillations which would appear if the default value @xmath91 is used in u - plm .",
    "in this test with u - ppm , stronger dissipation is also needed to avoid crashes .",
    "in particular , one of the ppm parameters , @xmath142 , is set to be @xmath143 instead of the default value @xmath144 ( see * ? ? ?",
    "* for the meaning of this parameter ) .",
    "the reflecting wall at @xmath129 poses difficulties for numerical simulations and gives rise to visible errors for zones near the wall .",
    "the errors of density at the nearest zone to the reflecting wall are 3.9% , 2.4% , 7.4% , and 4.3% , for f - weno , f - plm , u - ppm , and u - plm , respectively .",
    "for this particular problem with very strong shock but simple structure , more diffusive schemes f - plm and u - plm perform better than f - weno and u - ppm .",
    "most tests presented in this paper involve strong shocks .",
    "in addition to tests with discontinuities , it is also very important to test the capability of the schemes to handle smooth flows . in this section",
    ", we present two tests involving the isentropic evolution of smooth flows in 1d and 2d .    in the first test",
    ", a one - dimensional isentropic smooth pulse is set up in a uniform reference state , and the run stops some time before a shock is formed .",
    "the test is similar to the convergence tests performed by @xcite for their newtonian hydrodynamics code .",
    "the initial density structure at @xmath145 is given by @xmath146 where @xmath147 is the density of the reference state and @xmath148 here @xmath63 is the amplitude of the pulse and @xmath104 the width of the pulse .",
    "the pressure is given by the isentropic relation , @xmath149 , where @xmath150 is a constant .",
    "the initial velocity of the reference state is @xmath151 .",
    "the initial velocity inside the pulse at @xmath145 is set up by assuming one of the two riemann invariants , @xmath152 is constant across the whole region , where @xmath153 is the sound speed .",
    "we note that the other riemann invariant , @xmath154 is not constant .",
    "the exact solution of the test can be obtained by using standard characteristic analysis .",
    "the pulse will have a smooth shape before a shock eventually forms .",
    "the width and height of the pulse does not change before the shock forms .",
    "but the pulse will become increasingly asymmetric as the shape of the front of the pulse becomes steeper during the propagation ( see fig .",
    "[ fig : isen ] ) . behind the moving pulse",
    ", the fluid goes back to the reference state .",
    "our computational region for this test is @xmath155 .",
    "the reference state is , @xmath156 , the amplitude of the pulse is @xmath157 , and the width is @xmath158 .",
    "the adiabatic index in the equation of state is @xmath128 .",
    "we have run this test with different schemes and various numerical resolution . because the flow is very smooth",
    ", all methods perform very well for this test .",
    "[ fig : isen ] shows the exact solution and the numerical results of f - weno with 80 uniform zones .",
    "the results of the convergence rates are shown in table  [ tab : isen ] .",
    "various runge - kutta methods , including the third - order tvd scheme , standard fourth - order scheme ( rk4 ) and fifth - order scheme ( rk5 ) have been used in this test .",
    "we find that the f - weno scheme , which is fifth - order accurate in space and third - order accurate in time , has an @xmath107 order convergence rate of @xmath159 for this one - dimensional test with smooth flow .",
    "for the f - weno - rk4 and f - weno - rk5 schemes , which are fourth and fifth - order accurate in time integration respectively , order of convergence rates up to @xmath160 can be achieved . note that the difference between the results of rk4 and rk5 is very small . for schemes other than weno , including schemes using rk4 or rk5 ,",
    "the order of convergence rate is about 2 ( table  [ tab : isen ] ) .",
    "these results clearly show that the fifth - order weno scheme is very accurate and converges very quickly for smooth flows .",
    "cccc f - weno & 80 & 2.07e-3 & + & 160 & 1.10e-4 & 4.2 + & 320 & 1.70e-5 & 2.7 + & 640 & 1.47e-6 & 3.5 + & 1280 & 1.58e-7 & 3.2 + & 2560 & 1.91e-8 & 3.1 + & 5120 & 2.37e-9 & 3.0 + f - weno - rk4 & 80 & 1.87e-3 & + & 160 & 1.18e-4 & 4.0 + & 320 & 1.31e-5 & 3.2 + & 640 & 6.80e-7 & 4.3 + & 1280 & 2.54e-8 & 4.7 + & 2560 & 7.91e-10 & 5.0 + & 5120 & 2.38e-11 & 5.1 + f - weno - rk5 & 80 & 1.87e-3 & + & 160 & 1.17e-4 & 4.0 + & 320 & 1.30e-5 & 3.2 + & 640 & 6.82e-7 & 4.3 + & 1280 & 2.54e-8 & 4.7 + & 2560 & 8.01e-10 & 5.0 + & 5120 & 2.40e-11 & 5.1 + f - plm & 80 & 8.79e-3 & + & 160 & 4.05e-3 & 1.1 + & 320 & 1.22e-3 & 1.7 + & 640 & 3.10e-4 & 2.0 + & 1280 & 7.83e-5 & 2.0 + & 2560 & 1.96e-5 & 2.0 + & 5120 & 4.92e-6 & 2.0 + f - plm - rk4 & 80 & 8.85e-3 & + & 160 & 4.06e-3 & 1.1 + & 320 & 1.21e-3 & 1.7 + & 640 & 3.11e-4 & 2.0 + & 1280 & 7.84e-5 & 2.0 + & 2560 & 1.97e-5 & 2.0 + & 5120 & 4.93e-6 & 2.0 + u - ppm & 80 & 1.11e-2 & + & 160 & 2.47e-3 & 2.2 + & 320 & 7.02e-4 & 1.8 + & 640 & 1.38e-4 & 2.3 + & 1280 & 2.92e-5 & 2.2 + & 2560 & 6.48e-6 & 2.2 + & 5120 & 1.52e-6 & 2.1 + u - ppm - rk4 & 80 & 1.10e-2 & + & 160 & 2.56e-3 & 2.1 + & 320 & 5.74e-4 & 2.2 + & 640 & 1.34e-4 & 2.1 + & 1280 & 3.10e-5 & 2.1 + & 2560 & 7.33e-6 & 2.1 + & 5120 & 1.82e-6 & 2.1 + u - plm & 80 & 1.12e-2 & + & 160 & 3.56e-3 & 1.7 + & 320 & 1.03e-3 & 1.8 + & 640 & 2.61e-4 & 2.0 + & 1280 & 6.50e-5 & 2.0 + & 2560 & 1.62e-5 & 2.0 + & 5120 & 4.03e-6 & 2.0 + u - plm - rk4 & 80 & 1.12e-2 & + & 160 & 3.56e-3 & 1.7 + & 320 & 1.02e-3 & 1.8 + & 640 & 2.60e-4 & 2.0 + & 1280 & 6.49e-5 & 2.0 + & 2560 & 1.62e-5 & 2.0 + & 5120 & 4.04e-6 & 2.0    ppm is generally 3rd - order accurate in space , but the flattening procedure and the requirement of monotonic profiles degrades the accuracy of the scheme at places like local extrema or where the second derivatives of variables are large .",
    "thus its accuracy can be as low as first - order in some places .",
    "moreover , in the u - ppm scheme , the reconstruction is carried out on primitive variables , not conservative variables .",
    "the conservative variables are cell averages .",
    "but the primitive variables converted from conservative variables are not exactly cell averages .",
    "however , the ppm reconstruction algorithm regards them as cell averages .",
    "therefore the interface values of primitive variables may not have third - order accuracy .",
    "thus it is reasonable that the u - ppm scheme does not achieve a third - order convergence rate .    in the second test ,",
    "we have performed two - dimensional calculations to assess the convergence rate of the weno scheme in multi - dimension .",
    "the computational region in this test consists of a two - dimensional box in cartesian coordinates with @xmath161 and @xmath162 .",
    "the boundary conditions are periodic for all four sides of the box . like the one - dimensional test of isentropic flows",
    ", there is a static uniform reference state , which is set to @xmath163 .",
    "pulses which are periodic in space are added to the system . along the direction of @xmath164 ,",
    "the profile is periodic with a spatial period of @xmath165 , and the profile is constant along the direction perpendicular to the vector @xmath166 .",
    "thus the spatial periods along the @xmath50 and @xmath167-direction are 3.75 and 5.0 , respectively .",
    "note that these are consistent with the size of the computational box with periodic boundaries .",
    "the pulses move along the direction of the vector @xmath166 .",
    "the initial density profile is given by @xmath168 ( eqs .",
    "[ eq : rhocolella ] & [ eq : fcolella ] ) , where @xmath169 , the distance to the center of the nearest pulse , is given by @xmath170 , here @xmath171 returns the reminder of the division @xmath172 , and @xmath173 .",
    "the amplitude of the pulse is @xmath157 , and the width is @xmath174 .",
    "the adiabatic index in the equation of state is @xmath128 .",
    "similar to the one - dimensional test , the initial pressure is given by the isentropic relation , and the initial velocity by assuming the riemann invariant , @xmath175 is constant .",
    "we have run the two - dimensional test using the weno scheme with three runge - kutta methods : rk3 , rk4 and rk5 .",
    "results of the @xmath107 norm errors and convergence rate are shown in table  [ tab : isen2d ] .",
    "similar to the one - dimensional test , both f - weno - rk4 and f - weno - rk5 performs better than f - weno , which uses rk3 .",
    "but the difference of errors between f - weno - rk4 and f - weno - rk5 is very small",
    ". therefore , for this test it is not worth using the more expensive rk5 for time integration .",
    "cccc f - weno & @xmath176 & 7.35e-2 & + & @xmath177 & 4.43e-3 & 4.1 + & @xmath178 & 8.04e-4 & 2.5 + & @xmath179 & 9.62e-5 & 3.1 + & @xmath180 & 1.12e-5 & 3.1 + f - weno - rk4 & @xmath176 & 7.24e-2 & + & @xmath177 & 4.75e-3 & 3.9 + & @xmath178 & 4.70e-4 & 3.3 + & @xmath179 & 3.18e-5 & 3.9 + & @xmath180 & 1.24e-6 & 4.7 + f - weno - rk5 & @xmath176 & 7.19e-2 & + & @xmath177 & 4.67e-3 & 3.9 + & @xmath178 & 4.61e-4 & 3.3 + & @xmath179 & 3.13e-5 & 3.9 + & @xmath180 & 1.22e-6 & 4.7      in order to test the ability of our code to handle strong shocks in multiple dimensions , we have performed standard tests published in the literature .",
    "the emery step @xcite consists of a horizontal wind flowing into a step , represented as a reflecting boundary condition .",
    "the corner of the step represents a singular point of the rarefaction fan . as the wind collides with the step a reverse shock propagates back into the wind forming a bow shock which reflects off the upper boundary and forms a mach stem which should remain straight and initially almost vertical . since this structure can remain aligned with the vertical coordinate of the numerical grid , problems",
    "such as `` odd - even decoupling '' in some numerical schemes can act to incorrectly modify the stem @xcite .",
    "we simulate the emery step in a computational box with @xmath181 and @xmath182 with 240 zones in the @xmath50-direction and 80 in the @xmath167-direction .",
    "the step is represented as a reflecting boundary of height 0.2 beginning at @xmath183 and continuing along the length of the box .",
    "the upper boundary and lower boundary for @xmath184 are also both reflecting . initially the box is filled with @xmath185 gas moving at @xmath186 .",
    "the left boundary is an inflow with the same quantities .",
    "the right boundary is outflow .",
    "the adiabatic index in the equation of state is @xmath187 .",
    "the newtonian mach number is 3.0 , and the corresponding relativistic mach number @xmath188 , where @xmath189 is the classical mach number , @xmath2 is the lorentz factor of the gas and @xmath190 is the lorentz factor of sound speed in the gas , is @xmath191 .",
    "our results are shown in fig .",
    "[ fig : emery ] .",
    "these results are comparable to those of @xcite .",
    "some numerical methods require special entropy fixes to accurately simulate the flow near the step corner .",
    "no such code modification was implemented or required for the simulations presented here because we are only interested in the global structures , especially the shocks .",
    "though numerical boundary artifacts exist near the corner , the global solutions are not affected .",
    "the f - plm and f - weno methods are clearly superior for this problem .",
    "u - ppm and u - plm are noisy both downstream of the reverse shock and along the top of the step .",
    "presumably the results of u - ppm and u - plm could be improved by tuning the ppm parameters and the @xmath140 parameter in the minmod slope limiter . for this problem",
    "we use the standard cfl number of 0.5 . reducing this number could not improve the results for u - ppm and u - plm .",
    "a high resolution run employing amr is shown in   [ sec : emery_amr ] .      in order to compare with existing multi - dimensional srhd codes",
    "we repeat the two - dimensional shock tube problem suggested by @xcite and repeated by @xcite .",
    "this test consists of a cartesian box divided into four equal area constant states : @xmath192 where ne stands for the upper right quarter of the box ( @xmath193 , @xmath194 ) , nw the upper left quarter ( @xmath195 , @xmath194 ) , sw the lower left quarter ( @xmath196 , @xmath197 ) and se the lower right quarter ( @xmath198 , @xmath197 ) .",
    "we use constant zoning of @xmath199 zones , a @xmath128 adiabatic equation of state , outflow boundary conditions in all directions and a cfl number of 0.5 .    in the f - plm run of this test , the parameter @xmath140 in the minmod slope limiter is set to @xmath200 instead of the default value @xmath201 to avoid crashes .",
    "our results of four schemes are shown in fig .",
    "[ fig : riemann2d ] .",
    "the interface between panels nw and sw and the interface between panels se and sw are stationary contact discontinuities with jumps in transverse velocity .",
    "we note that the contact discontinuities have been smeared and numerical artifacts are clearly shown in the density contours at panel sw , as in the results in the literature @xcite .",
    "indeed less prominent numerical artifacts also exist in panels nw and se , though they do not show up in the figures of 30 contours .",
    "the appearance of two curved shocks and the elongated diagonal spike of density in between in panel ne is in agreement with the results of @xcite , whereas the diagonal feature is much less prominent in the results of @xcite .",
    "we note that the initial interface between panels ne and nw and the interface between panels ne and se are not simple shock waves .",
    "a similar test problem with simple waves at all initial interfaces ( two contact discontinuities and two shocks ) has been performed by @xcite to test their multidimensional relativistic ppm code .",
    "solutions to hyperbolic partial differential equations ( pdes ) are frequently smooth in large fractions of the computational volume yet contain sharp transitions in localized regions . in the smooth regions ,",
    "relatively coarse numerical zoning may be sufficient to accurately represent the solution , while finer zoning is needed where sharp transitions occur .",
    "adaptive mesh refinement @xcite creates finer numerical meshes to adequately resolve steep gradients and thin layers where they exist . for computational efficiency ,",
    "coarser meshes are used in smooth regions so that computing power is not wasted over - resolving regions where high resolution is unnecessary . as the solution evolves , the mesh structure adapts to provide appropriate resolution where needed at a given time .",
    "the srhd equations are pdes which admit the formation of extremely sharp transitions in the form of shock waves , thin shells and contact discontinuities .",
    "these structures coexist with smoothly flowing regions in different parts of the computational domain .",
    "amr is a powerful tool to handle the resolution required to adequately capture these features .    in the ram code",
    ", we utilize the amr tools in the flash code version 2.3 @xcite , which in turn is a modified version of the paramesh amr package @xcite .",
    "paramesh is a block - structured amr package .",
    "it uses a hierarchy of nested , logically cartesian blocks which typically have eight zones per dimension for a total of @xmath202 zones per block , where @xmath203 1 , 2 or 3 is the dimensionality of the simulation .",
    "finer level blocks are a factor of two higher in resolution in each direction so that each block is either at the highest level of refinement or contains @xmath204 daughter blocks .",
    "flux conservation at jumps of refinement is imposed by replacing fluxes computed at the courser level of refinement with appropriate sums of fluxes at the finer level .",
    "refinement or derefinement of a block is generally determined by calculating an approximate numerical second derivative of fluid variables which can be specified at runtime .",
    "other kinds of criteria can also be used for specific problems ( see e.g. , ",
    "[ sec : kh ] ) . in flash , the one - dimensional normalized second derivative , which is a measurement of error , is given by , @xmath205 where the last term in the denominator is a low pass filter to avoid excessive refinement on small fluctuations , and @xmath13 is an adjustable parameter for the low - pass filter . by default",
    ", we use @xmath206 except for the test problem in   [ sec : rievy2 ] .",
    "the one - dimensional expression can be generalized to multi - dimension @xcite .",
    "typically pressure , density and lorentz factor are used to estimate the error norm , @xmath207 , once every two steps .",
    "if the maximum error norm on a block is larger than the value of a parameter , @xmath208 , the block will be marked for refinement .",
    "if the maximum error norm on a block is less than the value of a parameter , @xmath209 , the block will be marked for derefinement .",
    "the default values for the above two parameters in the tests shown in this paper are set to @xmath210 , and @xmath211 except for the test problem in   [ sec : rievy2 ] .",
    "when amr refines a block , quadratic interpolation algorithms are used for prolongation operations between refinement levels .",
    "the prolongation operation is performed on the conserved variables .",
    "then the conversion of conserved variables to primitive variables is performed .",
    "the conversion could fail in principle , but this has never happened in our simulations because the refinement is performed when the solution is still very smooth .",
    "if the conversion fails , the problem can be fixed by using first - order prolongation .",
    "the solutions on parent blocks , which are not evolved , are obtained by restriction operations .    in ",
    "[ sec : fallback ] , we discussed the fall - back mechanism , which makes our code more robust .",
    "when amr is used , the cells in which unphysical results appear are almost always at the finest level of refinement .",
    "thus we only need to apply the more diffusive schemes for reconstruction to the finest level . for coarser levels",
    ", we still use the standard reconstruction scheme in the recalculation .",
    "flash handles parallelization using the message passing interface ( mpi ) library and uses an estimate of the work per processor to balance the computational load among processors .",
    "in this section , we present results of the amr on some test problems .",
    "all the tests shown are performed with the f - weno scheme , which is very robust and accurate for all the tests we have performed .",
    "we use f - weno - a and f - weno - u to denote the f - weno scheme with adaptive mesh and uniform grid , respectively .      in   [ sec :",
    "rievy1 ] , we tested out schemes on a one - dimensional riemann problem with non - zero transverse velocity .",
    "that test problem is relatively easy and can be resolved with modest resolution ( e.g. , 400 zones ) . to fully exercise the code",
    ", we perform a very severe test requiring very high resolution to resolve the complicate structure of the transverse velocity .    in this test ,",
    "the one - dimensional numerical region ( @xmath97 ) initially consists of two constant states : @xmath114 , @xmath115 , @xmath123 , @xmath212 and @xmath116 , @xmath125 , @xmath126 , @xmath213 , where @xmath104 stands for the left state , and @xmath48 the right state .",
    "the fluid is assumed to be an ideal gas with an adiabatic index @xmath128 .",
    "the initial discontinuity is at @xmath106 .",
    "the results at @xmath214 are shown in fig .",
    "[ fig : rievy2 ] . in this test",
    ", the breakup of the initial discontinuity evolves into a shock moving towards the right , a rarefaction wave moving towards the left , and a contact discontinuity in between .",
    "it is interesting to note the differences among this test problem , a similar problem in ",
    "[ sec : rie1d2 ] , which has no transverse velocity , and the problem in   [ sec : rievy1 ] , which has transverse velocity on the right side .",
    "the presence of large transverse velocity on the left make the shock move slower than that in the previous problems .",
    "compared to the previous problems , the density jump is smaller and the post shock dense shell is wider .",
    "however , these differences do not make this problem easier .",
    "the distance between the tail of the rarefaction wave and the contact discontinuity is much smaller in this test .",
    "more interesting is the structure of the transverse velocity . inside the rarefaction wave , the transverse velocity increases from @xmath215 at the head of the rarefaction wave to @xmath216 and then decreases to @xmath217 at the tail of the rarefaction wave . while the lorentz factor increases monotonically from @xmath218 at the head to @xmath219 at the tail of the rarefaction wave",
    "both the normal and transverse velocity stay constant in the thin shell between the tail of the rarefaction wave and the contact discontinuity .",
    "the presence of a very large lorentz factor ( @xmath220 ) in that thin shell on the left side of the contact discontinuity requires extremely high resolution to resolve the structure . across the contact discontinuity ,",
    "pressure and normal velocity do not change , while density and transverse velocity have a jump in their values . at the shock front",
    ", the post shock state has a transverse velocity of @xmath221 , which is smaller than the pre - shock value @xmath215 .",
    "the results ( fig .  [ fig : rievy2 ] ) clearly demonstrate the demand of high resolution when strong shear flows present . in low resolution runs ,",
    "the position of the shock front and the contact discontinuity were not correctly captured .",
    "even with @xmath222 zones , there is still visible errors for transverse velocity at the contact discontinuity . in the cases like this",
    ", we argue that amr could be a powerful tool . for the sake of comparison , we run the test with various uniform grids and amr grids with correspondingly equivalent resolutions . for this test , the amr parameters ( [ sec : amr ] )",
    "are set to @xmath223 , @xmath224 , and @xmath225 . for the amr grids ,",
    "the fine zoning follows the shock front and the contact discontinuity automatically , while coarse zoning is used at smooth region like the middle of the rarefaction wave . in one of the runs ,",
    "8 levels of refinement are used .",
    "that is the finest zones are 128 times smaller than the coarsest zones .",
    "the amr makes the resolution of this run equivalent to @xmath222 uniform zones",
    ". meanwhile amr runs are much faster than their corresponding uniform zoning runs .",
    "the measurement of global errors is shown in table  [ tab : rievy2 ] .",
    "as we expected , results from amr are comparable to those from uniform zoning , even though coarse zoning is used in most of the computational region .",
    "this is due to the fact that the global error is dominated by the discontinuities where high resolution is used in amr runs .",
    "ccccc uniform & 1 & 400 & 5.21e-1 & + & 1 & 800 & 3.63e-1 & 0.52 + & 1 & 1600 & 2.33e-1 & 0.64 + & 1 & 3200 & 1.26e-1 & 0.89 + & 1 & 6400 & 6.49e-2 & 0.96 + & 1 & 12800 & 3.38e-2 & 0.94 + & 1 & 25600 & 1.80e-2 & 0.91 + & 1 & 51200 & 9.95e-3 & 0.86 + adaptive & 1 & 400 & 5.21e-1 & + & 2 & 800 & 3.63e-1 & 0.52 + & 3 & 1600 & 2.33e-1 & 0.64 + & 4 & 3200 & 1.26e-1 & 0.89 + & 5 & 6400 & 6.55e-2 & 0.94 + & 6 & 12800 & 3.49e-2 & 0.91 + & 7 & 25600 & 1.90e-2 & 0.88 + & 8 & 51200 & 1.07e-2 & 0.83    note that the behavior of transverse velocity in _ one - dimensional _ riemann problems is purely due to relativistic effects .",
    "one might have the following argument which would lead to the wrong conclusion that transverse velocity can not change in one - dimensional riemann problems .",
    "the initial transverse velocity before the breakup could disappear by transferring to a new reference frame which moves along the transverse direction in the original laboratory frame . in the new frame",
    ", no transverse velocity would develop if the initial transverse velocity in that frame is zero .",
    "after the breakup of the initial discontinuity , one could transfer back to the original frame .",
    "the second lorentz transformation would make the transverse velocity in the original back to its original value . thus the transverse velocity in the original frame should be fixed during the evolution of the riemann problem .",
    "however , relativistic effects invalidate the above argument .",
    "suppose the original setup is a two - dimensional tube and there is a diaphragm at the initial discontinuity .",
    "the breakup of the initial discontinuity is caused by taking the diaphragm away .",
    "this problem can be considered one - dimensional in the original frame because of the obvious symmetry .",
    "however , in the second reference frame , which moves along the transverse direction , the problem can no longer be considered one - dimensional .",
    "the simultaneous disappearance of the diaphragm at different places in the transverse direction in the original frame does not happen simultaneously in the second frame .",
    "therefore , transverse velocity does change in both the original and the second frame . this conclusion can also be seen directly from the governing equations ( eq .",
    "[ dudt ] ) and the definition of the conserved mass and momentum densities ( eqs .",
    "[ d ] and [ sj ] ) .",
    "these imply that the srhd evolution equations preserve @xmath226 across shocks and rarefaction fans , where @xmath227 is a velocity component transverse to the propagation direction of these waves .",
    "since , in general , @xmath228 and @xmath2 change , @xmath227 is generally not conserved .      on amr grids ,",
    "there are jumps in resolution at the boundaries between computational regions at different levels of refinement .",
    "spurious effects such as the reflection of waves could arise at these boundaries . if amr performs as desired , the effects should be negligible because the structure at the refinement boundaries should be very smooth . to assess the effects of jumps in refinement in the worst case scenario , we present an advection test on a fixed staggered mesh .",
    "we set up a computational grid with a range of refinement levels , but we turn off adaptive refinement and derefinement so that the mesh remains spatially variable but constant in time ( see fig .",
    "[ fig : advection ] ) .    in this test ,",
    "the computational region consists of a two - dimensional box in cartesian coordinates with @xmath229 and @xmath230 .",
    "all the boundaries are periodic .",
    "a fixed mesh with 4 levels of refinement is set up on the grid . on this non - adaptive staggered mesh ( fig .",
    "[ fig : advection ] ) , there is a reference state of @xmath231 , @xmath232 , @xmath233 , @xmath234 , with a pulse only in density .",
    "the density profile is given by @xmath235 ( eqs .",
    "[ eq : rhocolella ] & [ eq : fcolella ] ) , where @xmath236 is the distance to the center of the box , and the two parameters ( the amplitude and width of the pulse ) in the density profile are set to @xmath237 , @xmath238 .",
    "the adiabatic index in the equation of state is @xmath128 in this test .",
    "the density pulse will advect on the periodic numerical grid at an angle of @xmath239 with respect to the @xmath50-axis and move across the refinement boundaries .",
    "the results are shown in fig .",
    "[ fig : advection ] .",
    "as it propagates , the pulse becomes wider due to numerical viscosity .",
    "however , no spurious waves are visible , and the pulse is still symmetric . at @xmath240 ,",
    "the fluctuation in pressure is only at the level of @xmath241 .",
    "such a small fluctuation , which is probably due to round - off errors in floating point operations , suggests that spurious effects due to the jump in refinement is acceptably small in our simulations .",
    "many authors have performed two - dimensional simulations to study the morphology and dynamics of relativistic jets ( e.g. , * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ) mainly in the context of agns .",
    "these results confirmed the formation of the basic features of a jet , i.e. , beam , cocoon , mach disk and bow shock , which have been observed in newtonian hydrodynamic simulations ( e.g. , * ? ? ? * ) .",
    "it was also found that relativistic jets are more stable and propagate more efficiently than newtonian ones .",
    "three - dimensional relativistic hydrodynamic simulations of jets have also been performed to study three - dimensional effects , such as 3d instabilities and precession of jets @xcite .    in this test",
    ", we simulate a relativistic jet which is relevant in astrophysics .",
    "the computational region is a two - dimensional cylindrical box ( @xmath242 , @xmath243 ) .",
    "the details of treating curvilinear coordinates including both cylindrical and spherical coordinates can be found in appendix  [ app ] .",
    "for the sake of comparison , we use the same parameters for this problem as model c2 of @xcite .",
    "the initial parameters of the relativistic jet beam are , @xmath244 and @xmath245 .",
    "the classical mach number of the jet is set to @xmath246 , and the corresponding relativistic mach number , @xmath247 , where @xmath248 is the lorentz factor of the jet beam and @xmath190 is the lorentz factor of sound speed in the jet , is @xmath249 .",
    "@xmath128 is used for the equation of state .",
    "initially the computational region is filled with a uniform medium with @xmath250 , and @xmath251 .",
    "the pressure of the medium , which is chosen to match the pressure of the jet , is @xmath252 .",
    "the initial relativistic jet is injected through the inlet part ( @xmath253 ) of the low-@xmath254 boundary by assigning the state of jet material to the boundary .",
    "outflow boundary conditions with zero gradients of variables are used at the other part ( @xmath255 ) of the low-@xmath254 boundary , high-@xmath254 boundary , and high-@xmath236 boundary .",
    "a reflecting boundary is used at the symmetric axis where @xmath256 .",
    "our numerical results at @xmath257 are shown in fig .",
    "[ fig : jet ] .",
    "it is shown that no carbuncle , which is a pathological phenomenon in some schemes @xcite , is generated in these simulations .",
    "we have performed the simulations with two different resolutions using f - weno - a . in both calculations ,",
    "the lowest level of the grid consists of @xmath258 zones .",
    "the corresponding spatial resolution at this level is @xmath259 zones per jet beam radius .",
    "the total levels of refinement are 5 and 7 , for the two calculations , respectively .",
    "this corresponds to an equivalent resolution of @xmath260 and @xmath261 zones per jet beam radius , for the two calculations , respectively .",
    "the model in this test is highly supersonic , and relativistic effects from ultra - relativistic motion dominates those from internal energy @xcite .",
    "the expected morphological features of such a relativistic jet are observed .",
    "a bow shock is formed due to the supersonic motion of the jet .",
    "the medium is shocked by the bow shock .",
    "the jet beam is slowed down at the mach disk and feeds the cocoon .",
    "the shocked jet beam moves sideways and then even backwards .",
    "the discontinuity between the shocked jet material and shocked medium material admit kelvin - helmholtz instabilities in the cocoon .",
    "the average speed of the jet head is @xmath262 .",
    "this agrees with the essentially one - dimensional analytic estimate , @xmath263 @xcite . comparing the results from the two calculations with different resolutions",
    ", we found that the global structure and the propagation speed of the jet are almost identical though more mixing due to kelvin - helmholtz instabilities is observed in the high resolution run .",
    "the presence of the strong shear motion between the jet beam and the back flows challenges numerical codes . even though a smaller cfl number , 0.3 , is used in this test , our code still falls back to more diffusive schemes occasionally .",
    "we consider this as a signal that the calculations are still under - resolved for such strong shear flows .",
    "we note that this is the only test that the fall - back scheme (   [ sec : fallback ] ) is used .    admittedly , this test problem is not ideal for amr . at later times ,",
    "most of the region is at the highest refinement level because of the rich structures inside the bow shock .",
    "however , amr still saves a lot of computer time because the external medium requires very low resolution during most of the time .",
    "the relativistic kelvin - helmholtz instability is of great interest in many astrophysical problems .",
    "for instance , a key unanswered question for grb jets is whether or not the relativistic outflows can remain sufficiently clean or whether baryons will be mixed into the flow lowering the maximum asymptotic lorentz factor below the values required by observations .",
    "this problem is especially relevant for collapsars in which the jet must propagate through a star .",
    "the kelvin - helmholtz instability for relativistic jets has been studied both numerically and analytically ( e.g. , * ? ? ?",
    "* ; * ? ? ?",
    "more recently , @xcite have performed a series of studies on the linear growth and long - term nonlinear evolution of two - dimensional relativistic planar jets . in this section",
    "we present two numerical tests of the kelvin - helmholtz instability .",
    "it is well known that ultra - relativistic flows suppress the kelvin - helmholtz instabilities ( see * ? ? ? * for a recent analytical work ) . in the first test in this section",
    ", we present a numerical simulation of the kelvin - helmholtz instability with mildly relativistic speeds to demonstrate the ability of amr for problems involving small scale structures .",
    "the computational region consists of a two - dimensional box with @xmath97 and @xmath264 .",
    "f - weno - a with 5 levels of refinement is used in this calculation .",
    "the equivalent spatial resolution is @xmath265 zones .",
    "the upper half of the box is filled with a gas with @xmath266 , @xmath267 , @xmath268 and @xmath269 , whereas the bottom half with @xmath270 , @xmath271 , @xmath272 and @xmath269 .",
    "@xmath128 is used for the equation of state of ideal gas .",
    "periodic boundary conditions are used for the right and left boundary . the initial interface which separates the two fluids",
    "is described by @xmath273 .",
    "this small perturbation triggers the kelvin - helmholtz instability .",
    "[ fig : kh ] shows a series of snapshots of the results .",
    "the rolling up of the interface forms small vortices .",
    "this process continues to form larger vortices from smaller vortices and becomes unstable .    to allow for a direct comparison with previous results on the relativistic kelvin - helmholtz instability , we repeated model  d10 in @xcite for a relativistic sheared planar jet using the ram code . in this test ,",
    "the computational region consists of a two - dimensional box in cartesian coordinates with @xmath274 and @xmath275 .",
    "the jet and ambient medium initially have the same pressure , @xmath276 .",
    "the jet , which moves along the @xmath50-direction , has initial density of @xmath277 , and an initial lorentz factor of @xmath278 .",
    "the static ambient medium has initial density of @xmath279 . to allow for a continuous transition between the jet and medium ,",
    "the profiles of density and velocity are smoothed as follows , @xmath280 @xmath281 where the jet radius @xmath282 is set to @xmath141 , and the steepness parameter @xmath283 is set to @xmath284 .",
    "the adiabatic index in the equation of state is @xmath122 .",
    "a periodic boundary condition is imposed at both the low-@xmath50 and high-@xmath50 boundary . to excite the kelvin - helmholtz instability ,",
    "a small initial perturbation is given to the transverse velocity , @xmath285 : @xmath286 }    \\sin^2{[(n+1)\\pi y ] } \\frac{y}{|y| } } \\right\\ }   \\nonumber \\\\",
    "+ \\frac{v_1}{m } \\left\\ { \\sum^{m-1}_{m=0 } { \\sin{[(m+1)k_mx + \\phi_m ] }    \\sin^2{[(m+1)\\pi y ] } } \\right\\ } , \\nonumber \\\\\\end{aligned}\\ ] ] where @xmath287 ( perucho 2005 , private communication ) is the amplitude , @xmath288 are the wavenumbers of the modes , @xmath289 are the random phases for each mode , @xmath290 is the number of symmetric modes , and @xmath291 is the number of antisymmetric modes .",
    "the wavenumbers for these modes are given by @xmath292 , where @xmath293 , and @xmath294 is the length of the periodic box in @xmath50-direction .    in the test of model d10 ,",
    "6 levels of mesh refinement are used . on the finest level ,",
    "the resolution is 32 zones and 256 zones per unit length at @xmath50 and @xmath167-direction respectively . in this test",
    ", resolution is concentrated at the interface between the jet material and ambient medium . instead of using the general refinement criteria (   [ sec : amr ] )",
    ", we use the composition of jet material and ambient medium to determine whether refinement or derefinement should be performed .",
    "more specifically , the refinement level will be brought to the highest if the mass fraction of jet material is @xmath295 , or otherwise will be marked for derefinement .",
    "figures  [ fig : kh0 ] & [ fig : kh1 ] show the results of model d10 using f - weno - a .",
    "our results agree with those of @xcite .",
    "the evolution of the kelvin - helmholtz instability consists of three regimes : linear , saturation and non - linear ( see * ? ? ? * for more details ) . in the linear regime",
    ", the perturbations of the longitudinal velocity , @xmath296 , transverse velocity , @xmath285 , and pressure all grow exponentially ( fig .",
    "[ fig : kh0 ] ) . at the end of the linear regime , @xmath297 ,",
    "the growth of the longitudinal velocity perturbation starts to saturate , while both the transverse velocity and pressure perturbations still grow exponentially . in the saturation regime , the continuous growth of the perturbation of transverse velocity , @xmath285 results in the distortion of the jet beam ( fig .",
    "[ fig : kh1 ] ) .",
    "the transition of the saturation to fully non - linear happens when the pressure perturbation and transverse velocity perturbation reach their peak at @xmath298 and @xmath299 respectively . in the non - linear regime",
    "the jet material is completely mixed with the ambient medium by turbulent motions .",
    "the emery step is a standard test involving the flow in a wind tunnel encountering a reflecting step boundary .",
    "we have shown the results with four different schemes ( f - weno , f - plm , u - ppm , and u - plm ) on uniform grids in   [ sec : emery ] . here",
    ", we repeat the test with f - weno - a on adaptive meshes .",
    "the setup of this problem is the same as in   [ sec : emery ] , except that an amr grid with 5 levels is used instead of uniform grids .",
    "the equivalent resolution is @xmath300 zones on a two - dimensional box of @xmath181 and @xmath301 . in other words , this corresponds to a zoning of @xmath302 .",
    "again , no special treatment for the step other than a reflecting boundary is used because we are only interested in the global structures of shocks .",
    "this problem involves a mach reflection of a strong shock by the upper boundary , and then the reflected shock is reflected again by the step .",
    "amr should work very well for this problem because much of the computational volume is smooth flow requiring only low resolution .",
    "thus this problem can test not only the ability of the amr code to capture strong shocks , but also its ability to adaptively refine and derefine the mesh as discontinuities evolve .",
    "it is shown in fig .",
    "[ fig : emery_amr ] that the amr in our code captures the sharp transitions in the flow where and when they occur .",
    "even the weak contact discontinuity originating from the bottom of the mach stem is detected and captured by the amr .",
    "it is interesting to note that no kelvin - helmholtz instability develops along the contact discontinuity though it does for non - relativistic flow .",
    "double mach reflection of a strong shock has often been used to test newtonian hydrodynamics codes since it was first introduced by @xcite .",
    "the computational region consists of a two - dimensional box with @xmath303 and @xmath182 .",
    "a reflecting wall is placed at the @xmath304 part of the low-@xmath167 boundary .",
    "a strong shock is moving towards right with its front making a 60 degree angle with respect to the @xmath50-axis .",
    "the reflection of the incident shock could give arise to a double mach reflection .",
    "two mach stems and two contact discontinuities would appear .",
    "the first contact discontinuity extends from the first triple shock point to the reflecting wall and then is pushed by the pressure gradient there and forms a jet parallel to the wall .",
    "the original setup of the problem can not be used for special relativistic hydrodynamics because the specific parameters chosen are not appropriate for the relativistic case . to test our relativistic schemes",
    ", we modified the original parameters of the problem .",
    "the adiabatic index in the equation of state is @xmath187 .",
    "the unshocked gas has @xmath305 , @xmath306 , and @xmath307 . the classical mach number of the shock , @xmath308 , where @xmath309 is the speed of the shock front and @xmath153 is the sound speed of the unshocked gas , is 10 . using the relativistic shock jump conditions",
    ", we can set up the shocked gas .",
    "the shock front initially intersects the lower boundary at the edge of the wall , @xmath310 .",
    "the @xmath311 part of the low-@xmath167 boundary and the low-@xmath50 boundary are set to the exact post - shock state . at @xmath312 ,",
    "the boundary conditions are set to either post - shock or pre - shock conditions depending upon the exact motion of the shock .",
    "the post - shock gas moves at a speed of @xmath313 , and the shock speed is @xmath314 .",
    "we would have made the shock ultra - relativistic .",
    "however , an ultra - relativistic shock can not generate a mach reflection .",
    "this is qualitatively understandable .",
    "suppose that the shock front makes an angle of @xmath140 with respect to the wall and the shock velocity is @xmath309 .",
    "the velocity of the intersection point of the shock and the wall would be @xmath315 . with ultra - relativistic shock velocity ,",
    "the intersection point can move faster than the speed of light .",
    "note that this does not violate relativity because the velocity of the intersection is not a physical velocity .",
    "even if a mach stem can be formed initially , the vertical mach stem can not move faster then the speed of light , and thus can not follow the motion of the oblique incident shock",
    ". therefore no permanent mach stem is possible when the shock moves too fast .",
    "we have performed this test with both adaptive mesh ( f - weno - a ) and uniform grid ( f - weno - u ) .",
    "our results are shown in fig .",
    "[ fig : dmr ] . for the adaptive mesh ,",
    "4 levels of refinement are used with the lowest level containing @xmath316 zones .",
    "the equivalent resolution is @xmath317 . for the uniform grid ,",
    "@xmath318 zones are used .",
    "the results from f - weno - a can be compared with those from f - weno - u .",
    "the amr scheme works very well and the highest level of refinement follows the motion of shocks and discontinuities while most of the computational region is at lower refinement levels . it is shown in fig .  [",
    "fig : dmr ] that density contours for f - weno - a and f - weno - u are almost identical .",
    "our results do not suffer from some pathological behaviors obtained with some schemes @xcite .",
    "there are no kinked mach stems .",
    "and the region behind the slowly moving shock near the left edge of the reflecting wall is very smooth .      in this test ,",
    "we study a three dimensional spherical blast wave using cartesian coordinates .",
    "since no analytic solution exists for this problem , we compare the three dimensional solution to a high resolution one dimensional simulation run with spherical coordinates . for the sake of comparison",
    ", we perform the same test run by @xcite .",
    "see their fig .",
    "the computational domain is a cubic box , @xmath97 , @xmath319 , @xmath320 , with a base resolution of 40 zones in each direction .",
    "we use up to 4 levels of amr so the effective resolution is @xmath321 zones .",
    "an initial discontinuity is at @xmath322 , where @xmath48 is the distance to the center of the cartesian coordinates .",
    "the region inside the interface , @xmath323 , contains a gas with @xmath266 , @xmath267 , whereas the region outside it , @xmath324 contains a gas with @xmath266 , @xmath325 .",
    "@xmath128 is used for the equation of state .",
    "both gases are at rest initially . similar to the one - dimensional riemann problem",
    ", the decay of the initial discontinuity will give arise to a spherically symmetric shock moving outwards , a spherical rarefaction wave moving inwards , and a `` contact discontinuity '' in between .",
    "note that the system could eventually evolve into a selfsimilar blandford - mckee solution for ultra - relativistic blast waves @xcite if the initial conditions are modified to make an even stronger explosion .",
    "the boundaries at @xmath326 , @xmath327 and @xmath328 are reflecting , whereas all other boundaries are zero gradient outflows .",
    "[ fig : bw3d ] shows the result at @xmath112 for a simulation using a cfl number of 0.3 .",
    "the solid line is a one - dimensional simulation run using spherical coordinates with 4000 uniform zones .",
    "the details of the treatment of curvilinear coordinates can be found in the appendix .",
    "the results with three - dimensional cartesian coordinates agree with the high resolution results with one - dimensional spherical coordinates .",
    "the shock front is captured with @xmath329 zones .",
    "the spherical symmetry is kept in the overall structure of the numerical results using cartesian coordinates .",
    "many challenging problems in numerical astrophysics require the computing power made possible by massively parallel supercomputers .",
    "these include state - of - the - art machines available through the national supercomputing centers and the national laboratories , as well as the linux clusters available in an increasing number of institutions . in order to take full advantage of available computational power ,",
    "it is necessary to develop computer code and utilize packages which run efficiently on a variety of parallel platforms and scale well with the number of processors used .",
    "large simulations , especially in 3d , require the use of large numbers of parallel processors to run in a reasonable amount of time . in order to use parallel resources efficiently ,",
    "it is necessary to test how well a code scales with number of processors used .",
    "scaling information is important for planning the size of numerical simulations which are possible to run efficiently .",
    "it is also impoortant for using an efficient number of processors for a given job .",
    "we have tested ram on several major national supercomputers as well as smaller clusters and find that it scales very well ( figure  [ fig : efficiency ] ) .",
    "ram has been extensively tested on nasa s columbia supercomputer on up to 504 processors .",
    "a scaling analysis for a stellar collapse simulation run with a spatially variable temporally fixed grid shows how ram scales from 32 to 340 processors ( figure  [ fig : efficiency ] , upper lines ) . for this constant total work job ,",
    "ram runs at 93% maximum efficiency when going from 32 to 128 processors and 88% maximum efficiency when going from 128 to 340 processors .",
    "we define efficiency when going from @xmath283 to @xmath78 processors as @xmath330 , where @xmath331 is the run time with @xmath50 processors . in a different simulation of a relativistic shock using a spatially and temporally adaptive mesh ( figure  [ fig : efficiency ] , lower lines ) ,",
    "processing time scales with 80% of maximum efficiency when going from 32 to 128 processors , and 65% efficiency going from 128 to 340 processors on columbia .",
    "this simulation required more communication among processors due to the continual refinement and derefinement as flow features moved through the computational domain .",
    "since the ram code is based on flash 2.3 , we expect the scaling and efficiency to be similar .",
    "more details on the scaling and efficiency of the flash code can be found in @xcite .",
    "we have presented a new special relativistic hydrodynamics code with adaptive mesh refinement .",
    "the code is modular and includes four combinations of reconstruction and hydrodynamics solvers we have termed f - weno , f - plm , u - ppm and u - plm . in this paper , we focus attention on f - weno , a characteristic - wise , finite difference weno scheme utilizing the full characteristic decomposition of the srhd equations .",
    "the scheme is fifth - order accurate in smooth regions .",
    "this is the first time that this high - order scheme has been implemented for relativistic hydrodynamics .",
    "we demonstrate that , while somewhat more complex , this method is highly accurate and stable .",
    "it has the added advantage of not containing tunable parameters which substantially modify the performance of the algorithm .",
    "the u - ppm scheme utilizes an approximate riemann solver ( e.g. , modified marquina flux formula ) and is equivalent to the genesis code @xcite .",
    "u - plm and f - plm , use linear reconstruction and are more diffusive , though somewhat stabler , versions of u - ppm and f - weno .",
    "for some problems these more diffusive schemes perform better when suppression of spurious oscillations near discontinuities is desirable .",
    "the higher - order methods sometimes produce numerical oscillations near strong discontinuities leading to values of conserved variables which are inconsistent with primitive fluid variables .",
    "this inconsistency can lead to code crashes .",
    "we therefore have implemented a failsafe scheme , which saves the previous solution at all times .",
    "if a numerical step results in an unacceptable solution , we return to the previous step and repeat the hydrodynamics calculation with increasingly diffusive schemes which , due to their diffusive nature , are more likely to produce consistent variables .",
    "this procedure greatly increases code robustness .",
    "numerical relativistic hydrodynamics is more difficult than the newtonian case for several fundamental reasons .",
    "first , due to relativistic effects , structures in relativistic flows tend to be thinner requiring higher spatial resolution .",
    "second , unlike shocks in newtonian hydrodynamics , the density jump across relativistic shocks can be arbitrarily large and is limited only by the lorentz factor ( see eq .  [ sigma ] ) .",
    "third , the non - linear coupling between the velocity components in relativistic flows remains a very challenging numerical problem .",
    "the lorentz factor depends on all velocity components and couples transverse velocity into the dynamics in the normal direction .",
    "the difficulty is in resolving contact discontinuities which move with respect to the numerical grid .",
    "some smearing of contact discontinuities is inevitable due to numerical diffusion error .",
    "when transverse velocity components are present they experience jumps across contact discontinuities with corresponding jumps in the lorentz factor , unlike the case with no transverse velocity in which the lorentz factor is continuous across contact discontinuities . because the conserved variables depend on different powers of the lorentz factor , the numerically smeared states generate spurious waves from the discontinuity which corrupt the solution .",
    "an additional , though less serious , difficulty is that pressure jumps across the shock and inside the rarefaction fan have a steeper dependence on normal velocity when transverse velocities are present .",
    "these problems can be solved by increasing spatial resolution .",
    "a major advantage of ram is its high accuracy coupled with amr for extremely high effective resolution .",
    "we have found that ram is able to achieve sufficient resolution to correctly solve challenging numerical problems .",
    "since amr concentrates the spatial resolution where it is needed , sufficient accuracy is achieved efficiently , enabling challenging multi - dimensional simulations to be undertaken .    the high accuracy achieved with ram",
    "is demonstrated to be of critical importance for solving relativistic flows with strong shear , even in the more challenging case when transverse velocity is present in high pressure states into which rarefaction fans are propagating .",
    "under - resolved simulations with many combinations of reconstruction and hydrodynamics solvers produce incorrect post - shock values and positions as seen in fig .",
    "[ fig : rievy2 ] .",
    "we believe this problem is generic to most or all relativistic hydrodynamics codes currently in use ( see also * ? ? ?",
    "* ) . in this work , we succeed in obtaining agreement with the analytic solution for a riemann problem with transverse velocity of @xmath332 by using 8 levels of amr .",
    "we are confident that we can use ram to adequately resolve flows with strong shear which have not previously been adequately resolved .",
    "it is worth noting that u - ppm and u - plm schemes do not require the complete characteristic information of the jacobian matrix of the srhd system .",
    "however , this information is needed for the characteristic - wise schemes ( f - weno and f - plm ) making them more difficult to implement .",
    "our numerical experiments have shown that the extra effort is justified .",
    "we have also implemented other f - x schemes for comparison including the fifth - order monoticity - preserving scheme ( mp5 ) of @xcite and third - order weno ( weno3 ) @xcite . in our numerical experiments",
    "we have found that mp5 generates excessive spurious numerical oscillations , while weno3 is exceedingly diffusive . the fifth - order weno scheme implemented in this work ( see   [ sec : f - x ] ) is free from these liabilities .    in order to simulate systems of astrophysical interest",
    "we have included physics modules relevant for the study of grbs , sn and black hole accretion .",
    "ram includes physical equations of state , neutrino cooling and nuclear physics .",
    "it is intended initially to address open theoretical questions in the study of gamma - ray bursts and supernova explosions .",
    "w.z . has been supported by nasa through chandra postdoctoral fellowship pf4 - 50036 awarded by the chandra x - ray observatory center , and the doe program for scientific discovery through advanced computing ( scidac ; de - fc02 - 01er41176 ) .",
    "a.m. acknowledges support at the institute for advanced study from the keck foundation .",
    "we acknowledge nasa theory grant nag5 - 12036 for the october , 2003 grb meeting at uc santa cruz during which this work was initiated and nasa grant swif03 - 0000 - 0060 for travel funds supporting this collaboration .",
    "we thank the institute for nuclear theory at university of washington for hospitality during part of the time over which this work was completed .",
    "we acknowledge the use of the ucsc upsand cluster supported by an nsf mri grant ast-0079757 , the scheides cluster at the institute for advanced study , nasa s columbia computer and resources of the national energy research scientific computing center .",
    "the software used in this work was in part developed by the doe - supported asci / alliance center for astrophysical thermonuclear flashes at the university of chicago .",
    "specifically , we use the paramesh amr and i / o tools from flash version 2.3 .",
    "the hydrodynamics code is original to this work .",
    "we would like to thank m. zingale for many helpful conversations , especially on the flash code , j. stone for many detailed and useful comments on the manuscript and the anonymous referee for his / her thorough review .",
    "when a method which is valid in cartesian coordinates is extended to curvilinear coordinates care must be taken to avoid the introduction of errors related to the mesh geometry .",
    "we treat the extension to non - cartesian coordinates carefully to avoid errors especially near coordinate singularities . here",
    "we describe the extension of our code to cylindrical and spherical coordinate geometries .    in cylindrical coordinates ( @xmath236 , @xmath140 , @xmath254 ) , the governing srhd equation can be written as , @xmath333 where the subscripts , @xmath236 , @xmath140 and @xmath254 stand for radial , azimuthal and axial directions in cylindrical coordinates .",
    "all fluid variables have the same meaning as in   [ sec : eqns ] .",
    "the above equations for cylindrical coordinates can be easily discretized into , @xmath334 where the subscripts i , j and k denote the @xmath236- , @xmath140- and @xmath254-discretization , respectively .",
    "the subscripts @xmath335 , @xmath336 , and @xmath337 , refer to cell interfaces .",
    "@xmath338 is the mean value of the conserved variable at the cell ( @xmath339,@xmath340,@xmath341 ) .",
    "@xmath342 are the numerical fluxes at the cell interfaces . the source term , @xmath343 , can be calculated according to the right - hand sides of equations  [ eqn : c0 ] , [ eqn : c1 ] , [ eqn : c2 ] , [ eqn : c3 ] and [ eqn : c4 ] .",
    "similarly , the governing equation in spherical coordinates ( @xmath236 , @xmath140 , @xmath344 ) can be written as , @xmath345 @xmath346 @xmath347 @xmath348 @xmath349 where the subscripts , @xmath236 , @xmath140 and @xmath344 stand for radial , polar and azimuthal directions in spherical coordinates .",
    "all fluid variables have the same meaning as in   [ sec : eqns ] .",
    "the discretized equations for spherical coordinates read @xmath350 where the subscripts i , j and k denote the @xmath236- , @xmath140- and @xmath344-discretization , respectively .",
    "the subscripts @xmath335 , @xmath336 , and @xmath337 , refer to cell interfaces ."
  ],
  "abstract_text": [
    "<S> we have developed a new computer code , ram , to solve the conservative equations of special relativistic hydrodynamics ( srhd ) using adaptive mesh refinement ( amr ) on parallel computers . </S>",
    "<S> we have implemented a characteristic - wise , finite difference , weighted essentially non - oscillatory ( weno ) scheme using the full characteristic decomposition of the srhd equations to achieve fifth - order accuracy in space . for time </S>",
    "<S> integration we use the method of lines with a third - order total variation diminishing ( tvd ) runge - kutta scheme . </S>",
    "<S> we have also implemented fourth and fifth order runge - kutta time integration schemes for comparison . </S>",
    "<S> the implementation of amr and parallelization is based on the flash code . </S>",
    "<S> ram is modular and includes the capability to easily swap hydrodynamics solvers , reconstruction methods and physics modules . </S>",
    "<S> in addition to weno we have implemented a finite volume module with the piecewise parabolic method ( ppm ) for reconstruction and the modified marquina approximate riemann solver to work with tvd runge - kutta time integration . </S>",
    "<S> we examine the difficulty of accurately simulating shear flows in numerical relativistic hydrodynamics codes . </S>",
    "<S> we show that under - resolved simulations of simple test problems with transverse velocity components produce incorrect results and demonstrate the ability of ram to correctly solve these problems . </S>",
    "<S> ram has been tested in one , two and three dimensions and in cartesian , cylindrical and spherical coordinates . </S>",
    "<S> we have demonstrated fifth - order accuracy for weno in one and two dimensions and performed detailed comparison with other schemes for which we show significantly lower convergence rates . </S>",
    "<S> extensive testing is presented demonstrating the ability of ram to address challenging open questions in relativistic astrophysics . </S>"
  ]
}