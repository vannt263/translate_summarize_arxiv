{
  "article_text": [
    "the profile of hii region around an isolated source of uv photons is an old topic in astrophysics .",
    "a classical result was given by strmgren ( 1939 ) , who showed that the profile of the spherical hii region of a point source embedded in a uniformly distributed hydrogen gas with number density @xmath0 at radial coordinate @xmath1 can be approximately described by a step function as @xmath2 = \\left \\ { \\begin{array}{ll }                              1 , & { \\rm if \\ } r < r_s \\\\                              0 , & { \\rm if \\ } r > r_s \\\\                             \\end{array }                                \\right .\\ ] ] where the fraction of ionized hydrogen @xmath3 , @xmath4 being the number density of ionized hydrogen . that is , hydrogen gas is sharply divided into two regions : within a sphere with strmgren radius @xmath5 around the source , hydrogen is fully ionized , while outside the sphere hydrogen atoms remain neutral .",
    "@xmath5 is determined by the balance between ionization and recombination @xmath6 where @xmath7 is the emission of ionizing photons of the source , and @xmath8 is the recombination coefficient of hii ( osterbrock & ferland 2005 ) .",
    "the sharp boundary at @xmath9 is the ionization front ( i - front ) separating the hii and hi regions .",
    "the problem of the strmgren sphere has once again attracted many studies recently , because the formation of hii regions around high redshift quasars , galaxies and first stars is crucial to understanding the evolution of the reionization ( cen & haiman 2000 ; madau & rees 2000 ; ciardi et al .",
    "2001 ; ricotti et al . 2002 ; wyithe & loeb , 2004 ; kitayama , et al .",
    "2004 ; whalen et al . 2004",
    "; yu , 2005 ; yu & lu 2005 ; alvarez et al . 2006 , iliev et al .",
    "2006 ) . unlike the static solution eq.([eq1 ] ) , new studies focus on the dynamical behavior of the ionized sphere , such as the time - dependence of the ionization profile @xmath10 , the propagation of the i - front . besides the hii region and the i - front",
    ", a high kinetic temperature region also exists around the uv photon source due to the photon - heating of gas .",
    "similar to the i - front , there is also a t - front separating heated and un - heated gas .",
    "the temperature profile @xmath11 and the t - front are important for probing reionization .",
    "for instance , the region with high kinetic temperature @xmath12 and low @xmath13 would be the 21 cm emission region associated with sources at the reionization epoch ( tozzi et al .",
    "2000 ; wyithe et al .",
    "2005 ; cen , 2006 ; chen & miralda - escude 2006 ) .",
    "although the possible existence of a 21 cm emission shell around high redshift quasars and first stars has been addressed qualitatively or semi - analytically in these references , a serious calculation seems to be still lacking .",
    "many numerical solvers for the radiative transfer equation have been proposed ( ciardi et al . 2001 , gnedin & abel 2001 , sokasian et al .",
    "2001 , nakamoto et al .",
    "2001 ; razoumov et al .",
    "2002 , cen 2002 , maselli et al .",
    "2003 , shapiro et al . , 2004 ;",
    "rijkhorst et al .",
    "2005 ; mellema et al .",
    "2006 ; susa 2006 , whalen & norman 2006 ) .",
    "these solvers provide numerical results of the i - front .",
    "however , the results are still diverse due to the usage of different approximations .",
    "some of the results show that the time scale of the i - front evolution is sensitively dependent on the intensity of source ( white et al .",
    "2003 ) , while some yield intensity - independent evolution ( e.g. mellema et al .",
    "this is because the retardation of photon propagation is ignored in the later , while the recombination is ignored in the former .",
    "therefore , it is worth to re - calculate this problem without above - mentioned assumptions .",
    "it has been pointed out that to study the dynamical features of the i- and t - fronts , one would need to apply high - resolution shock - capturing schemes similar to those developed in fluid dynamics ( razoumov & scott 1999 ) .",
    "the finite difference weno scheme is an algorithm satisfying this requirement .",
    "moreover , although the fraction of the remained neutral hydrogen within the ionized sphere is extremely small , it is not zero .",
    "the small fraction is important to estimate the ly-@xmath14 photon leaking at high redshifts .",
    "therefore , a proper algorithm for the dynamical properties of the ionized sphere should be able to , on the one hand , effectively capture sharp profile of ionization and temperature around the i- and t - fronts , and , on the other hand , give a precise value of the remained neutral hydrogen between the discontinuities .",
    "this can also be satisfied by the weno algorithm .",
    "the weno algorithm has proved to have high order of accuracy and good convergence in capturing discontinuities and complicated structures in fluid as well as to be significantly superior over piecewise smooth solutions containing discontinuities ( shu 2003 ) .",
    "we have shown that the weno algorithm is indeed effective for solving radiative transfer problem with discontinuities with high accuracy .",
    "for instance , it can follow the propagation of a sharp i - front and the step function cut - off of retardation ( qiu et al .",
    "we now develop this method to solve both ionization and temperature profiles . it is not a trivial generalization . because the rate equations of heating - cooling and ionization - recombination are stiff , the time integration of the weno scheme can not be directly implemented .",
    "a proper strategy to save computational cost on time integration will be developed .",
    "a long - term motivation of this work , as we mentioned in ( qiu et al .",
    "2006 ) , is to develop a weno solver of hydrodynamic / radiative transfer problems , similar to the development of a hybrid algorithm of hydrodynamic / n - body simulation based on weno scheme ( feng et al .",
    "2004 ) .",
    "the paper is organized as follows .",
    "section 2 describes the problem and equations needed to be solved .",
    "section 3 presents the weno numerical scheme .",
    "section 4 gives the solutions of the temperature and ionization profiles and the evolution of energy spectrum of photons .",
    "a discussion and conclusion are given in section 5 .",
    "details of the atomic processes are listed in the appendix .",
    "to demonstrate the algorithm , we consider the ionization of a uniformly distributed hydrogen gas in space @xmath15 with number density @xmath0 by a point uv photon source located at the center @xmath16 . adding helium component in the gas is straightforward and will not change the algorithm for radiative transfer .",
    "if the time scale @xmath17 of the growth of the ionized sphere is less than @xmath18 , @xmath19 being the hubble parameter , the expansion of the universe can be ignored .",
    "the radiative transfer equation of the specific intensity @xmath20 is then ( see the appendix ) @xmath21 where @xmath22 is the frequency of photon .",
    "the source term , @xmath23 , is given by @xmath24 where @xmath25 is the energy distribution of photons emitted by the central source per unit time within the frequency range from @xmath22 to @xmath26 .",
    "we assume the energy spectrum of uv photons to be of a power law @xmath27 , and @xmath28 is the ionization energy of the ground state of hydrogen @xmath29 ev .",
    "integration of @xmath30 over @xmath22 gives the total intensity ( energy per unit time ) of ionizing photons emitted by the source , @xmath31 .",
    "the absorption coefficient of eq.([eq3 ] ) is @xmath32 , where the cross section @xmath33 and @xmath34 @xmath35 .",
    "the evolution of the number density of neutral hydrogen hi , @xmath36 , is governed by the ionization equation , @xmath37 where @xmath38 is the fraction of neutral hydrogen , and @xmath39 is the number density of electrons . obviously , @xmath40 . in eq.([eq5 ] )",
    ", @xmath41 is the recombination coefficient and @xmath42 is the collision ionization rate .",
    "the photoionization rate @xmath43 is given by @xmath44 the kinetic temperature of baryon gas is determined by the equation @xmath45 where @xmath46 erg @xmath47 is the boltzmann constant and the temperature @xmath12 is in unit of k. the details of the heating @xmath48 and cooling @xmath49 are given in the appendix .",
    "in the numerical implementation , it is convenient to introduce the dimensionless variables of time , space and frequency defined by @xmath50 , @xmath51 and @xmath52 . @xmath53 is the optical depth of ionizing photon in neutral hydrogen gas with density @xmath0 .",
    "therefore , @xmath54 and @xmath55 are respectively , the time and distance in units of mean free flight time and mean free path of ionizing photon @xmath56 in the non - ionized background hydrogen gas @xmath0 . for the @xmath57cdm model , @xmath58 @xmath59 , where @xmath60 is redshift , @xmath61 myrs and @xmath62 mpc .",
    "correspondingly , the intensity is rescaled by @xmath63 .",
    "thus , eqs.([eq3 ] ) , ( [ eq5 ] ) , ( [ eq6 ] ) and ( [ eq7 ] ) become @xmath64 and @xmath65 @xmath66 @xmath67 where we have assumed @xmath68 and @xmath69    the point source condition eq.([eq4 ] ) requires @xmath70 .",
    "if we take @xmath71 , the total intensity of the source is given by @xmath72    in our numerical calculation , we solve the system of equations ( [ eq8 ] ) , ( [ eq9 ] ) and ( [ eq11 ] ) for the specific intensity @xmath73 , the fraction of the neutral hydrogen @xmath74 and the temperature @xmath12 as functions of the radius @xmath55 , frequency @xmath75 and time @xmath54 .",
    "we will drop the prime in the variables @xmath73 , @xmath55 , @xmath75 and @xmath54 in this section below , when there is no ambiguity , and keep prime in the variables in showing the numerical results .    to solve the radiative transfer equation",
    ", we adopt the fifth - order finite difference weno scheme with anti - diffusive flux corrections .",
    "the fifth - order finite difference weno scheme was designed in ( jiang @xmath76 shu 1996 ) and the anti - diffusive flux corrections to the high order finite difference scheme was designed in ( xu @xmath76 shu 2005 ) .",
    "the objective of the anti - diffusive flux corrections is to sharpen the contact discontinuities in the numerical solution of the weno scheme as well as to maintain high order accuracy .",
    "a fourth order quadrature formula is used in the computation of integration in equations ( [ eq10 ] ) and ( [ eq1112 ] ) .",
    "the third order tvd runge - kutta time discretization is used in time integration for the system of equations ( [ eq8 ] ) , ( [ eq9 ] ) and ( [ eq11 ] ) .",
    "we now describe our numerical algorithm in more detail .",
    "the computational domain is @xmath77 \\times [ 1 , \\nu_{max}]$ ] , where @xmath78 and @xmath79 are chosen such that @xmath80 for @xmath81 or @xmath82 . in our computation ,",
    "@xmath83 and @xmath84 .",
    "the computational domain is discretized into a uniform mesh in the @xmath85-direction and into a smooth non - uniform mesh in the @xmath22-direction .",
    "the uniform mesh in the @xmath85-direction is @xmath86 and the non - uniform mesh in the @xmath22-direction is taken to be @xmath87 which is allowed because only integration , e.g. in equations ( [ eq10 ] ) and ( [ eq1112 ] ) , is involved in the computation with respect to the @xmath22-variable . in our model , large @xmath22 contributes little in equations ( [ eq10 ] ) and ( [ eq1112 ] ) , therefore the non - uniform mesh is designed in a way such that the mesh becomes coarser for larger @xmath22 .      to approximate the spatial derivative in equation ( [ eq8 ] ) , the weno scheme with anti - diffusive flux corrections is used",
    ". specifically , to calculate @xmath88 , the variable @xmath22 is fixed and the approximation is performed along the @xmath85-line @xmath89 where the numerical flux @xmath90 is obtained with the procedure given below .",
    "we can use the upwind fluxes without flux splitting in the fifth order weno approximation because the wind direction is fixed ( positive ) . to obtain the sharp resolution of the contact discontinuities , the anti - diffusive",
    "flux corrections are used in our code .",
    "first , we denote @xmath91 where @xmath0 and @xmath92 are fixed .",
    "the numerical flux from the regular weno procedure is obtained by @xmath93 where @xmath94 are the three third order fluxes on three different stencils given by @xmath95 and the nonlinear weights @xmath96 are given by @xmath97 with the linear weights @xmath98 given by @xmath99 and the smoothness indicators @xmath100 given by @xmath101 @xmath102 is a parameter to avoid the denominator to become 0 and is taken as @xmath103 times the maximum magnitude of the initial condition @xmath104 in the computation of this paper .",
    "the reconstruction of the finite difference weno flux on the downwind side @xmath105 is obtained in a mirror symmetric fashion with respect to @xmath106 as that for @xmath107 .",
    "the anti - diffusive flux corrections are based on the fluxes obtained from the regular weno procedure .",
    "it is given by @xmath108 where @xmath109 is the cfl number and the minmod function is defined as @xmath110 @xmath111 in eq.([eq41 ] ) is the discontinuity indicator between 0 and 1 , defined as @xmath112 where @xmath113 with @xmath114 being a small positive number taken as @xmath115 in our computation . @xmath116 and @xmath117 are the maximum and minimum values of @xmath118 for all grid points . with the definition",
    "above , we will have @xmath119 .",
    "@xmath120 in the smooth regions and @xmath121 is close to 1 near strong discontinuities .",
    "the purpose of the anti - diffusive flux corrections is to improve the resolution of contact discontinuities without sacrificing accuracy and stability of the original weno scheme .      the integration in equations ( [ eq10 ] ) and ( [ eq1112 ] ) is approximated by a fourth order quadrature formula @xmath122 where @xmath123 , and the weights @xmath124",
    "are given by @xmath125 again we refer to ( qiu et al .",
    "2006 ) for details of implementation .      when considering the time integration for the system of equations ( [ eq8 ] ) , ( [ eq9 ] ) and ( [ eq11 ] ) , we start with the third order tvd runge - kutta time discretization in ( shu @xmath76 osher 1988 ) . for the system of odes",
    "@xmath126 this time discretization reads @xmath127    the runge - kutta method needs to be modified considering the modification on the anti - diffusive flux @xmath128 by @xmath129 where the spatial derivative @xmath130 term in operator @xmath131 is defined by ( [ shuadd60 ] ) with the anti - diffusive flux @xmath132 given by eq.([eq41 ] ) , and @xmath130 in the operator @xmath133 is defined by the modified anti - diffusive flux @xmath134 as @xmath135 and @xmath130 in the operator @xmath136 is defined by the modified anti - diffusive flux @xmath137 ,",
    "@xmath138 here @xmath139 , @xmath140 .",
    "the difficulty of a direct implementation of the scheme lies in the stiffness of equations ( [ eq9 ] ) and ( [ eq11 ] ) . especially for strong sources ,",
    "when j(r=0 ) is large , one needs very small time step @xmath141 to guarantee the stability of the numerical scheme , therefore huge computational cost for long time integration .    by observing that    * though ( [ eq9 ] ) and ( [ eq11 ] ) are stiff odes , ( [ eq8 ] ) involving the spatial derivative is not a stiff equation . * the weno procedure with the anti - diffusive flux corrections in approximating the spatial derivative is the major cost at each time step . * implicit numerical method in time evolution has milder time step restriction than the explicit one .",
    "we have settled down with the following strategies to save the computational cost    * we use different time scales to solve j in ( [ eq8 ] ) and to solve @xmath142 and t in ( [ eq9 ] ) and ( [ eq11 ] ) . the time step for j , say @xmath141 , is larger , while the time step for @xmath142 and t , say @xmath143 with @xmath144 being the number of small time steps in a large time step , is much smaller . by doing this",
    ", we take advantage of the non - stiffness of ( [ eq8 ] ) and eliminate the cost of the weno procedure with flux corrections for each small time step . * in each small time step @xmath145 , we use a semi - implicit numerical method for strong sources to proceed in time for @xmath142 and t , which greatly releases the severe time step restriction for the sake of the stability of the scheme .",
    "the number of small time steps @xmath145 in one large time step @xmath141 is thus greatly reduced , hence the saving of the computational cost .",
    "more precisely , we modify the third order tvd runge - kutta time discretization in the following procedure    1 .",
    "we have the initial condition of j , @xmath142 and @xmath12 at t=0 .",
    "let us denote @xmath146 @xmath147 2 .   for a large time step @xmath141 , we evolve @xmath148 , @xmath149 and @xmath150 by three inner stages to @xmath151 , @xmath152 and @xmath153 . *",
    "@xmath151 : + @xmath154 , @xmath155 , @xmath151 are updated according to ( [ rk1_a ] ) , ( [ rk2_a ] ) , ( [ rk3_a ] ) . * @xmath152 , @xmath153 : + let us denote @xmath156 and @xmath157 instead of ( [ rk1 ] ) , @xmath158 and @xmath159 are evolved by @xmath160 where @xmath161 is the evolution of the solution by the euler - forward method for @xmath144 times , with the euler - forward method at each time step defined as @xmath162 instead of ( [ rk2 ] ) , the second inner stage @xmath163=@xmath164 is updated by @xmath165 with @xmath166 being the evolution of the solution by the euler - forward method for @xmath144 times based on @xmath154 as @xmath167 finally , instead of ( [ rk3 ] ) , @xmath152 and @xmath153 are computed as @xmath168 with @xmath169 obtained in a similar manner as in the previous step but based on @xmath155 @xmath170 3 .",
    "when the source is strong , ( [ eq9 ] ) and ( [ eq11 ] ) suffer from severe time step restriction , we use a semi - implicit scheme instead of ( [ euler - for ] ) in our code to release the severe time step restriction and to save computational cost . the procedure of the implementation is the same as described above except that ( [ euler - for ] ) is replaced by @xmath171 ( [ fhi_im ] ) is computed by solving a quadratic equation with the root located between 0 and 1 , since @xmath172 is a quadratic function of @xmath142 , and ( [ t_im ] ) is computed by the newton iteration method .",
    "( [ euler - for2 ] ) and ( [ euler - for3 ] ) are modified in a similar way as ( [ euler - for ] ) .",
    "the boundary conditions are implemented as follows    * inflow boundary condition at r=0 : + @xmath173 . *",
    "the boundary condition at @xmath174 : + @xmath175      in this subsection , we perform a grid refinement convergence study for the numerical scheme we proposed above , to assess the accuracy of the computational result for the typical mesh sizes that we will use in next section .",
    "we test our numerical schemes for the case with the strongest source intensity , i.e. @xmath176 erg @xmath177 .",
    "this is the toughest situation for our numerical simulation , as the scheme suffers severe time step restriction due to the stiffness of the ode .",
    "we use both the multi - time - scale strategy and semi - implicit time discretization described in the previous subsections , and compare the results obtained with @xmath178 points in @xmath85 and @xmath179 points in @xmath22 , which is the typical mesh size used in next section , and with a _ coarser _ mesh consisting of @xmath180 points in @xmath85 and @xmath181 points in @xmath22 , in figure [ fig1 ] .",
    "the results with these two mesh sizes match very well , indicating that our numerical results are already numerically convergent at the coarser mesh .",
    "the numerical results reported in next section with the finer mesh should therefore be reliable .",
    "( left ) and @xmath182 ( right ) with the source of @xmath183 erg s@xmath184 at time @xmath185 myrs ( @xmath186 ) .",
    "the power - law frequency spectrum has the index @xmath187 , and the reionization redshift is taken to be @xmath188 .",
    "the solid line is the numerical result with the typical mesh @xmath189 , @xmath190 , and the circles indicate the numerical result with a coarser mesh @xmath191 , @xmath192 . ,",
    "title=\"fig:\",width=188 ]   ( left ) and @xmath182 ( right ) with the source of @xmath183 erg s@xmath184 at time @xmath185 myrs ( @xmath186 ) .",
    "the power - law frequency spectrum has the index @xmath187 , and the reionization redshift is taken to be @xmath188 .",
    "the solid line is the numerical result with the typical mesh @xmath189 , @xmath190 , and the circles indicate the numerical result with a coarser mesh @xmath191 , @xmath192 . ,",
    "title=\"fig:\",width=188 ]    we also test the accuracy of our multi - time - scale strategy by comparing the numerical results of evolving ( [ eq8 ] ) , ( [ eq9 ] ) and ( [ eq11 ] ) together with single , extremely small time step , and that of updating ( [ eq8 ] ) , ( [ eq9 ] ) and ( [ eq11 ] ) by the multi - time - scale strategy with ( @xmath145 , @xmath141 ) .",
    "these two approaches produce numerical solutions in good agreement , see figure [ fig2 ] .",
    "( left ) and @xmath182 ( right ) with the source of @xmath193 erg s@xmath184 at time @xmath194 myrs ( @xmath195 ) .",
    "the power - law frequency spectrum has the index @xmath187 , and the redshift is taken to be @xmath188 .",
    "the numerical mesh is @xmath191 and @xmath190 .",
    "the solid line is the numerical solution with single , extremely small time step , and the circles indicate the numerical solution with the multi - time - scale strategy . ,",
    "title=\"fig:\",width=188 ]   ( left ) and @xmath182 ( right ) with the source of @xmath193 erg s@xmath184 at time @xmath194 myrs ( @xmath195 ) .",
    "the power - law frequency spectrum has the index @xmath187 , and the redshift is taken to be @xmath188 .",
    "the numerical mesh is @xmath191 and @xmath190 .",
    "the solid line is the numerical solution with single , extremely small time step , and the circles indicate the numerical solution with the multi - time - scale strategy . , title=\"fig:\",width=188 ]    additional grid refinement study , not reported here to save space , has been performed to assure the numerical convergence of the results reported in next section",
    "the results in this section are obtained with the numerical algorithm described in the previous section .",
    "the code is stable for all the cases reported in this section . as indicated in the previous section 3.7 , and we have performed grid refinement study for some representative examples to ensure that the results reported are numerically converged solutions .    in our calculation , we use the explicit time discretization to solve ( [ eq9 ] ) and ( [ eq11 ] ) when @xmath196 erg @xmath177 , and semi - implicit scheme when @xmath197 erg @xmath177 , @xmath198 erg @xmath177 and @xmath183 erg @xmath177 in each of the small time step @xmath145 in the multi - time - scale strategy .",
    "we calculate the profiles of @xmath200 and @xmath201 around a point source .",
    "the result is presented in figure [ fig3 ] , which shows the time - dependence of the profiles @xmath201 and @xmath200 for sources with intensity , respectively from top to bottom panels , @xmath202 , @xmath203 , @xmath204 and @xmath205 erg s@xmath184 with @xmath187 and @xmath188 .",
    "the emission rate of the number of photons is roughly @xmath206 , @xmath207 , @xmath208 and @xmath209 s@xmath184 .",
    "( left ) and @xmath200 ( right ) , in which @xmath85 and @xmath55 are the physical and dimenssionless distance , respectively . from top to bottom : for sources of @xmath210 , @xmath211 , @xmath198 and @xmath183 erg s@xmath184 at time @xmath212 ( dash dot dot ) , 0.36 ( long dash ) , 0.53 ( dash dot ) , 0.71 ( dash ) , and 0.89 ( solid line ) myrs . the power - law frequency spectrum has the index @xmath187 , and the redshift is taken to be @xmath188 .",
    "the mesh has @xmath213=4000 , @xmath214=200 grid points .",
    ", title=\"fig:\",width=188 ]   ( left ) and @xmath200 ( right ) , in which @xmath85 and @xmath55 are the physical and dimenssionless distance , respectively . from top to bottom : for sources of @xmath210 , @xmath211 , @xmath198 and @xmath183 erg s@xmath184 at time @xmath212 ( dash dot dot ) , 0.36 ( long dash ) , 0.53 ( dash dot ) , 0.71 ( dash ) , and 0.89 ( solid line ) myrs . the power - law frequency spectrum has the index @xmath187 , and the redshift is taken to be @xmath188 .",
    "the mesh has @xmath213=4000 , @xmath214=200 grid points .",
    ", title=\"fig:\",width=188 ]     ( left ) and @xmath200 ( right ) , in which @xmath85 and @xmath55 are the physical and dimenssionless distance , respectively . from top to bottom : for sources of @xmath210 , @xmath211 , @xmath198 and @xmath183 erg s@xmath184 at time @xmath212 ( dash dot dot ) , 0.36 ( long dash ) , 0.53 ( dash dot ) , 0.71 ( dash ) , and 0.89 ( solid line ) myrs . the power - law frequency spectrum has the index @xmath187 , and the redshift is taken to be @xmath188 .",
    "the mesh has @xmath213=4000 , @xmath214=200 grid points .",
    ", title=\"fig:\",width=188 ]   ( left ) and @xmath200 ( right ) , in which @xmath85 and @xmath55 are the physical and dimenssionless distance , respectively . from top to bottom : for sources of @xmath210 , @xmath211 , @xmath198 and @xmath183 erg s@xmath184 at time @xmath212 ( dash dot dot ) , 0.36 ( long dash ) , 0.53 ( dash dot ) , 0.71 ( dash ) , and 0.89 ( solid line ) myrs . the power - law frequency spectrum has the index @xmath187 , and the redshift is taken to be @xmath188 .",
    "the mesh has @xmath213=4000 , @xmath214=200 grid points . ,",
    "title=\"fig:\",width=188 ]     ( left ) and @xmath200 ( right ) , in which @xmath85 and @xmath55 are the physical and dimenssionless distance , respectively . from top to bottom : for sources of @xmath210 , @xmath211 , @xmath198 and @xmath183 erg s@xmath184 at time @xmath212 ( dash dot dot ) , 0.36 ( long dash ) , 0.53 ( dash dot ) , 0.71 ( dash ) , and 0.89 ( solid line ) myrs . the power - law frequency spectrum has the index @xmath187 , and the redshift is taken to be @xmath188 .",
    "the mesh has @xmath213=4000 , @xmath214=200 grid points .",
    ", title=\"fig:\",width=188 ]   ( left ) and @xmath200 ( right ) , in which @xmath85 and @xmath55 are the physical and dimenssionless distance , respectively . from top to bottom :",
    "for sources of @xmath210 , @xmath211 , @xmath198 and @xmath183 erg s@xmath184 at time @xmath212 ( dash dot dot ) , 0.36 ( long dash ) , 0.53 ( dash dot ) , 0.71 ( dash ) , and 0.89 ( solid line ) myrs .",
    "the power - law frequency spectrum has the index @xmath187 , and the redshift is taken to be @xmath188 .",
    "the mesh has @xmath213=4000 , @xmath214=200 grid points .",
    ", title=\"fig:\",width=188 ]     ( left ) and @xmath200 ( right ) , in which @xmath85 and @xmath55 are the physical and dimenssionless distance , respectively . from top to bottom : for sources of @xmath210 , @xmath211 , @xmath198 and @xmath183 erg s@xmath184 at time @xmath212 ( dash dot dot ) , 0.36 ( long dash ) , 0.53 ( dash dot ) , 0.71 ( dash ) , and 0.89 ( solid line ) myrs . the power - law frequency spectrum has the index @xmath187 , and the redshift is taken to be @xmath188 .",
    "the mesh has @xmath213=4000 , @xmath214=200 grid points . , title=\"fig:\",width=188 ]   ( left ) and @xmath200 ( right ) , in which @xmath85 and @xmath55 are the physical and dimenssionless distance , respectively . from top to bottom : for sources of @xmath210 , @xmath211 , @xmath198 and @xmath183 erg s@xmath184 at time @xmath212 ( dash dot dot ) , 0.36 ( long dash ) , 0.53 ( dash dot ) , 0.71 ( dash ) , and 0.89 ( solid line ) myrs .",
    "the power - law frequency spectrum has the index @xmath187 , and the redshift is taken to be @xmath188 .",
    "the mesh has @xmath213=4000 , @xmath214=200 grid points .",
    ", title=\"fig:\",width=188 ]    figure [ fig3 ] shows that the ionized sphere generally has a sharp i - front .",
    "the time - dependent profile @xmath201 may still be approximately described as a strmgren sphere with time - dependent size @xmath215 as @xmath216 the code can well reveal the propagation of the i - front @xmath217 . unlike the solution eq.([eq1 ] ) , @xmath199 is not zero in @xmath218 .",
    "although the neutral hydrogen @xmath199 remained in @xmath218 is very small , it can not be ignored , because the heating of gas is given by the hard photons absorption of neutral hydrogen hi [ eq.(a8 ) ] . the high temperature within the ionized sphere is actually maintained by the ionization of the small fraction therein by all the ionizing photons [ eq.([eq22a ] ) ] .",
    "figure [ fig3 ] indicates that @xmath199 within @xmath218 is sensitive to the intensity of the source .",
    "this is important for investigating leakage of the ly-@xmath14 photon .",
    "figure [ fig3 ] shows that the temperature profiles @xmath11 within the i - front @xmath218 are simple .",
    "the temperature keeps around a constant @xmath219 k. an interesting feature is that for strong sources , the temperature at the center ( @xmath220 ) is not the highest and is even lower than the constant temperature .",
    "this is because the ionizing ( soft ) photon flux at the center is very strong , the number of @xmath221 is extremely low ( see figure [ fig3 ] ) , and then , the heating rate is lower .",
    "a common feature of @xmath11 is that the size of heated region is generally larger than that of ionized region at all time .",
    "that is , hydrogen gas is already significantly heated before being ionized .",
    "the gas is firstly heated up , and then ionized .",
    "the region between the t - front and the i - front is a pre - heating layer , in which the temperature can be as high as @xmath222 k , or even larger . for a source of @xmath223 erg s@xmath184 at @xmath224 , the physical size of the ionized region at time 0.36",
    "mys is about 0.06 mpc , while the physical size of the region with temperature larger than @xmath225 k is about 0.08 mpc . when @xmath185 mys , the two physical sizes are , respectively , about 0.1 mpc , and 0.16 mpc , or comoving size 1 mpc , and 1.6 mpc .",
    "therefore , for strong sources , the time scales and comoving length scales of the pre - heating layer are in the range of cosmological interest .",
    "an important feature of the ionization profile is that @xmath226 can be approximately written as @xmath227 $ ] , where @xmath228 is time - independent , and @xmath215 is only a function of @xmath17 .",
    "that is , all the time - dependence of @xmath199 can be described by the i - front @xmath215 . in the region",
    "@xmath218 , the ionization profile @xmath229 is time - independent .",
    "it can be given by a static or stationary solution of the radiative transfer equation .",
    "this property has been applied in some codes for radiative transfer , in which the ionization field is given by the static solution of the radiative transfer equation for a given matter distribution .",
    "for the temperature profile , one might also approximately define a t - front function by a step function as @xmath230 $ ] .",
    "however , unlike the i - front , the temperature profile can not be rewritten as @xmath231 $ ] , where @xmath232 is time - independent .",
    "that is , the @xmath85-dependence of the function @xmath200 can not be separated with @xmath17 .",
    "especially , the function @xmath11 in the range between the i- and t - fronts actually always depends strongly on @xmath17 .",
    "figure [ fig3 ] shows that , for a very strong source @xmath233 erg s@xmath184 , we have @xmath234 , i.e. the ionizing front moves with a speed close to the speed of light . for a weak source @xmath235 erg s@xmath184",
    ", the profile @xmath201 does not show a significant expansion of the i - front if time @xmath17 is larger than a few of free flight times of ionizing photons .",
    "this result is also evident in figure [ fig4 ] on @xmath236 versus @xmath17 .",
    "@xmath236 is defined by @xmath237 .",
    "it denotes the size , within which , i.e. @xmath238 , 90% hydrogen are ionized .",
    "therefore , it can be used for the i - front . for a strong source , such as @xmath239 ergs s@xmath184 , we have approximately @xmath240 , which implies that the ionizing region grows with an ionizing front propagating with almost the speed of light . for weak sources",
    ", @xmath236 are also following @xmath17 at very small @xmath17 , but become @xmath241 when @xmath17 is large .",
    "the weaker the sources , the earlier the stage of @xmath241 takes place .",
    "this point is more clearly shown in the right panel of figure [ fig4 ] .",
    "we see that the speed @xmath242 is close to @xmath243 when @xmath17 is small , and then the speed decreases with @xmath17 by a power law @xmath244 with @xmath245 .",
    "one can define a time @xmath246 , larger than which , the speed @xmath242 starts to decrease with @xmath17 by the power law . at time @xmath247 , the ionizing sphere is still expanding , but very slowly .",
    "it will finally approach a solution , of which the ionization equilibrium is approximately established , and the ionized sphere becomes time - independent .",
    "the time @xmath246 depends on the source intensity .",
    "the stronger the source , the larger the time @xmath246 .    , which is the solution of @xmath237 .",
    "the light solid line is @xmath240 .",
    "right panel : @xmath248 vs. @xmath17 .",
    "other parameters and the mesh in the numerical simulation are the same as those in figure [ fig3 ] . the sources are taken to be @xmath249 ( dash dot dot ) , @xmath211 ( dash dot ) , @xmath198 ( dash ) , and @xmath183 ( solid line ) erg s@xmath184 .",
    "time @xmath54 is dimensionless .",
    ", title=\"fig:\",width=226 ] , which is the solution of @xmath237 .",
    "the light solid line is @xmath240 .",
    "right panel : @xmath248 vs. @xmath17 .",
    "other parameters and the mesh in the numerical simulation are the same as those in figure [ fig3 ] . the sources are taken to be @xmath249 ( dash dot dot ) , @xmath211 ( dash dot ) , @xmath198 ( dash ) , and @xmath183 ( solid line ) erg s@xmath184 .",
    "time @xmath54 is dimensionless .",
    ", title=\"fig:\",width=226 ]    obviously , the speed of the propagation of t - front can not be larger than the speed of light , and therefore , the t - front will approximately coincide with the i - front when @xmath250 . only in this period ,",
    "the ionized sphere is the same as the heated sphere . when @xmath247 , the t - front starts to exceed the i - front , and the pre - heating layer is formed .",
    "therefore , the formation of pre - heated layer happens later for a stronger source .",
    "figure [ fig5 ] gives a comparison of @xmath199 and @xmath11 at time @xmath185 myrs for sources with different intensity .",
    "we can see that the pre - heating layer has been well established at time @xmath185 myrs for all sources with @xmath251 erg s@xmath184 , while the t - front of the source with @xmath252 erg s@xmath184 is still about the same as the i - front .",
    "one can expect that for a source of @xmath253 erg s@xmath184 , a preheated layer will be formed at time @xmath254 myrs and on comoving distance @xmath255 mpc from the source .",
    "( left panel ) and @xmath232 ( right panel ) at time @xmath185 myrs for sources with intensity @xmath249 ( dash dot dot ) , @xmath211 ( dash dot ) , @xmath198 ( dash ) , and @xmath183 ( solid line ) erg s@xmath184 . @xmath85 and @xmath55 are the physical and dimensionless distance , respectively .",
    "the power - law frequency spectrum has index @xmath187 .",
    "the redshift is taken to be @xmath188 .",
    "the mesh in the numerical simulation is the same as that in figure [ fig3 ] .",
    ", title=\"fig:\",width=226 ]   ( left panel ) and @xmath232 ( right panel ) at time @xmath185 myrs for sources with intensity @xmath249 ( dash dot dot ) , @xmath211 ( dash dot ) , @xmath198 ( dash ) , and @xmath183 ( solid line ) erg s@xmath184 . @xmath85 and @xmath55 are the physical and dimensionless distance , respectively .",
    "the power - law frequency spectrum has index @xmath187 .",
    "the redshift is taken to be @xmath188 .",
    "the mesh in the numerical simulation is the same as that in figure [ fig3 ] .",
    ", title=\"fig:\",width=226 ]      the formation of the pre - heated layer with high @xmath12 and high @xmath74 is due to the lack of soft photons beyond the i - front , while hard photons are still abundant in that region . in other words , the energy spectrum of the photons",
    "is significantly hardened around the i - front .",
    "we now directly demonstrate the evolution of the photon frequency spectrum , as our code can effectively reveal the evolution of radiations in the @xmath22-space .",
    "the left panel of figure [ fig6 ] gives the frequency spectra of 1 . ) source @xmath256 erg s@xmath184 at time @xmath185 myrs and physical distance @xmath257 , 0.11 , and 0.14 mpc , and 2 . )",
    "source @xmath258 erg s@xmath184 at time @xmath185 myrs and physical distance @xmath259 and 0.24 mpc .",
    "we can see a significant @xmath85-dependence of the frequency spectrum . at a small @xmath85 the spectra are still almost the same as the original power - law spectrum @xmath260 with @xmath187 , while at large @xmath85 , they significantly deviate from the original power - law .",
    "all photons of @xmath261 , are exhausted within @xmath262 mpc . at high frequency @xmath263 ,",
    "the spectra are still of power - law with @xmath187 , while at @xmath264 they are substantially dropped .",
    "it shows a peak at @xmath265 , and looks like a spectrum with self - absorption .",
    "however , unlike a self - absorption spectrum , the position of the peak is not fixed in the frequency - space , it moves to higher frequency with time .",
    "namely , the photon energy spectrum is harder at later time .",
    "vs. @xmath266 at time @xmath185 myrs . 1 . ) left panel : for the source @xmath267 erg s@xmath184 , at physical distance @xmath257 ( dash dot ) , 0.11 ( dash ) and 0.14 ( solid line ) mpc ; and 2 . ) right panel : for the source @xmath258 erg s@xmath184 at physical distance @xmath259 ( dash ) and 0.24 ( solid line ) mpc .",
    "redshift is @xmath188 .",
    "the mesh in the numerical simulation is the same as that in figure [ fig3 ] .",
    ", title=\"fig:\",width=226 ]   vs. @xmath266 at time @xmath185 myrs . 1 . )",
    "left panel : for the source @xmath267 erg s@xmath184 , at physical distance @xmath257 ( dash dot ) , 0.11 ( dash ) and 0.14 ( solid line ) mpc ; and 2 . ) right panel : for the source @xmath258 erg s@xmath184 at physical distance @xmath259 ( dash ) and 0.24 ( solid line ) mpc .",
    "redshift is @xmath188 .",
    "the mesh in the numerical simulation is the same as that in figure [ fig3 ] .",
    ", title=\"fig:\",width=226 ]    the spectral hardening can be measured by the index of power law defined as @xmath268 figure [ fig7 ] plots @xmath14 vs. @xmath22 for the frequency spectra of figure [ fig6 ] . obviously , in the band @xmath269 , @xmath14 becomes smaller at larger @xmath85 .",
    "both figures [ fig6 ] and [ fig7 ] show that the frequency spectra of photons depend strongly on @xmath17 and @xmath85 when @xmath17 and @xmath85 are close to or inside the pre - heating layer .     vs. @xmath266 for the source @xmath258 erg s@xmath184 at physical distance @xmath259 ( dash ) and 0.24 ( solid line ) mpc .",
    "redshift is @xmath188 .",
    "the mesh in the numerical simulation is the same as that in figure [ fig3 ] .",
    ", width=226 ]",
    "we have described weno scheme which is able to solve the phase - space distribution function of photons in an isolated ionized patch around individual source in the early stage of reionization .",
    "this algorithm can produce robust results for the propagation of the i- and t - fronts .",
    "it can also give stable results for the time - dependent distribution of the small fraction of neutral hydrogen within the i - front .",
    "we have developed the method to deal with the stiffness of rate equations in time integration .",
    "consequently , the computational speed is acceptable .",
    "this algorithm can be applied to problems with a wide range of intensity of sources , from @xmath270 to 10@xmath271 erg s@xmath184 with a power law spectrum at redshift @xmath188 . since this algorithm treat the frequency space as well as physical space , it can also be used for sources with other frequency spectrum .",
    "we have not considered helium and secondary effects in the atomic processes yet , however the algorithm has no practical difficulty to include these factors .",
    "we show that a common feature of the uv photon sources in the reionization epoch is to form a preheating region . in the first stage the i- and t - fronts in baryon gas are coincident , and propagate with the speed about the same as the speed of light .",
    "when the frequency spectrum of the uv photons is hardened , the evolution enters into the second stage .",
    "the propagation speeds of both the ionizing and heating fronts are less than that of light , but the t - front is always moving faster than the ionizing front . in the spherical shell between the i- and t - fronts , the kinetic temperature of gas can be as large as @xmath272 , while atoms are almost neural . obviously , the shell would be of interest in the search for the 21 cm emission from the reionization epoch .",
    "the details of the preheating region are sensitively dependent on the parameters of the problems . for instance",
    ", the radius and thickness of the preheated shell do not show a scaling relation on their dependence of the source intensity .",
    "therefore , an algorithm , which can properly handle models with various parameters is necessary .    using these results",
    ", one can make comments on some numerical solvers used for the radiative transfer equations .",
    "several solvers are based on the approximation of omitting the time - derivative term of the radiative transfer equation ( nakamoto et al . 2001 ; cen 2002 ; razoumov et al .",
    "2002 ; rijkhorst et al .",
    "2005 ; susa 2006 ) .",
    "they calculate the static ionization field for a given uniform or non - uniform density fields of cosmic baryon matter .",
    "these codes essentially are generalizing the static solution eq.([eq1 ] ) to the case of inhomogeneous background distribution of baryon matter , and multiple sources .",
    "such an approximation is useful to calculate the ionization field for each given inhomogeneous mass field of baryon matter , but it will no longer be a good approximation when the retardation effect due to photon propagation is important . for the problem of ionization profiles around a point source ,",
    "the retardation of photon is not always negligible .",
    "for instance , one finds the following parameters have been used in the model : the ionization and heating at comoving distance @xmath273 h@xmath184 mpc from a point source of age @xmath274 yrs at redshift @xmath275 ( e.g. cen , 2006 ) .",
    "these parameters already violated the retardation constraint @xmath276 .",
    "the retardation effect can be seen from the time - dependence of the i - front , @xmath277 .",
    "if the retardation effect is negligible , an analytical solution of @xmath277 is given by e.g. whalen & norman ( 2006 ) @xmath278^{1/3},\\ ] ] where @xmath279 is the static radius of the strmgren sphere given by eq.(2 ) , and @xmath280 is recombination time scale . according to eq.([shuadd61 ] ) , the time scale of the @xmath281 evolution is @xmath282 , which is independent of the source intensity @xmath30 .",
    "that is , @xmath283 only if @xmath284 , regardless @xmath7",
    ". however , figure [ fig4 ] shows that time scale of the @xmath236 evolution is @xmath7-dependent .",
    "this result also holds if we replace @xmath236 by , e.g. @xmath285 , and is true for a monochromatic source too .    considering the retardation effect , an analytical solution of @xmath277",
    "is approximately given by the following algebraic equation ( white et al .",
    "2003 ) @xmath286^{1/3}.\\ ] ] according to eq.([shuadd62 ] ) , when @xmath287 , the speed of the i - front , @xmath288 , and when @xmath289 , @xmath290 .",
    "it is qualitatively consistent with @xmath242 shown in figure [ fig4 ] .",
    "first , the time scale of the @xmath236 evolution is approximately @xmath291 , the larger the @xmath7 , the longer the @xmath292 .",
    "second , @xmath293 decreases with @xmath17 by a power law @xmath294 when @xmath17 is large .",
    "however , the power law index @xmath295 .",
    "this is expected , because eq.([shuadd62 ] ) does not include the effect of recombination , which leads to a slower decrease than @xmath242 .",
    "a common assumption used in eqs.([shuadd61 ] ) and ( [ shuadd62 ] ) is that the distribution @xmath199 is described by a step function like eq.([eq1 ] ) . obviously , it ignores the neutral hydrogen hi probably remained within @xmath281 .",
    "the tiny fraction of hi may also be hardly calculated well by monte - carlo codes ( ciardi et al .",
    "2001 ; maselli et al .",
    "2003 ) , which yield large numerical errors due to possion shot noise .",
    "the weno algorithm has been successfully applied to kinetic equations of the distribution function in the phase space with one or two spatial dimensions and two or three phase space dimensions with acceptable computational speed ( carrillo et al . 2006 ) .",
    "we believe that it is not difficult to implement the weno algorithm for radiative transfer problems with similar dimensions in the phase space .    in our calculation , the evolution the cosmic baryon gas is not tracked by the hydrodynamic equations , but is simply assumed to have a uniform distribution with density @xmath0 .",
    "this treatment would be reasonable if the typical time scale of the relevant hydrodynamic effects are less than that of the i- and t - fronts .",
    "for instance , dynamical effects associated with sonic propagation would be negligible in solving the propagation of the i- and t - fronts .",
    "of course , one can expect that richer results will be yielded if the weno scheme for radiative transfer problems can be incorporated with the euler hydrodynamics .",
    "since the weno scheme for the cosmological hydrodynamical simulation has already been well established , it would be possible to develop a unified radiation / n - body / hydrodynamics code for cosmological problems .    * acknowledgments .",
    "*    this work is supported in part by the us nsf under the grants ast-0506734 and ast-0507340 .",
    "llf acknowledges support from the national science foundation of china under the grant 10573036 .",
    "for an ionized sphere associated with a point photon source , the radiation transfer ( rt ) equation is ( bernstein , 1988 , qiu et al .",
    "2006 ) @xmath296 where @xmath297 is the specific intensity , @xmath298 the cosmic factor , @xmath299 , @xmath22 the frequency of photon and @xmath300 a unit vector in the direction of photon propagation . in eq.([eqa1 ] ) , we take @xmath301 .",
    "@xmath302 and @xmath23 are , respectively , the absorption and sources of photons . the absorption coefficient of eq.([eqa1 ] )",
    "is given by @xmath303 where the cross section @xmath304 .",
    "\\5 . cooling .",
    "since only the recombination cooling is important , we have @xmath314 ^ 2 \\\\",
    "\\nonumber     & + & 1.42\\times 10^{-27 } t^{1/2}[1-f_{\\rm hi}]^2 \\\\",
    "\\nonumber     & + & 2.45\\times 10^{-21}t^{1/2 } e^{-157809.1/t}(1+t_5^{1/2})^{-1 }     ( 1-f_{\\rm hi})f_{\\rm hi }       \\\\\\nonumber     & + & 7.5\\times 10^{-19 } e^{-118348/t}(1+t_5^{1/2})^{-1 } ( 1-f_{\\rm hi})f_{\\rm hi}\\end{aligned}\\ ] ] where @xmath308 .",
    "the terms on the r.h.s . of eq.([eq16 ] ) are , respectively , the recombination cooling , collisional ionization cooling , collisional excitation cooling and bremsstrahlung .",
    "both @xmath48 and @xmath49 are in the unit of ergs @xmath315 s@xmath184 ."
  ],
  "abstract_text": [
    "<S> we develop a numerical solver for radiative transfer problems based on the weighted essentially nonoscillatory ( weno ) scheme modified with anti - diffusive flux corrections , in order to solve the temperature and ionization profiles around a point source of photons in the reionization epoch . </S>",
    "<S> algorithms for such simulation must be able to handle the following two features : 1 . </S>",
    "<S> the sharp profiles of ionization and temperature at the ionizing front ( i - front ) and the heating front ( t - front ) , and 2 . </S>",
    "<S> the fraction of neutral hydrogen within the ionized sphere is extremely small due to the stiffness of the rate equations of atom processes . </S>",
    "<S> the weno scheme can properly handle these two features , as it has been shown to have high order of accuracy and good convergence in capturing discontinuities and complicated structures in fluid as well as to be significantly superior over piecewise smooth solutions containing discontinuities . with this algorithm </S>",
    "<S> , we show the time - dependence of the preheated shell around a uv photon source . in the first stage </S>",
    "<S> the i - front and t - front are coincident , and propagate with almost the speed of light . in later stage , when the frequency spectrum of uv photons is hardened , the speeds of propagation of the ionizing and heating fronts are both significantly less than the speed of light , and the heating front is always beyond the ionizing front . in the spherical shell between the i- and t - fronts , the igm is heated , while atoms keep almost neutral . </S>",
    "<S> the time scale of the preheated shell evolution is dependent on the intensity of the photon source . </S>",
    "<S> we also find that the details of the pre - heated shell and the distribution of neutral hydrogen remained in the ionized sphere are actually sensitive to the parameters used . </S>",
    "<S> the weno algorithm can provide stable and robust solutions to study these details .    </S>",
    "<S> ,    ,    ,    cosmology : theory , gravitation , hydrodynamics , methods : numerical , shock waves 95.30.jx , 07.05.tp , 98.80.-k </S>"
  ]
}