{
  "article_text": [
    "registration refers to the process of finding an optimal one - to - one correspondence between images or surfaces .",
    "it has been extensively applied to different areas such as medical imaging , computer graphics and computer visions .",
    "for example , in medical imaging , registration is always needed for statistical shape analysis , morphometry and processing of signals on brain surfaces ( e.g. , denoising or filtering ) . while in computer graphics , surface registration is needed for texture mapping , which aligns each vertex to a position of the texture image , to improve the visualization of the surface mesh .",
    "developing an effective algorithm for registration is therefore very important .",
    "surface registration between simple surfaces , such as simply - connected open surfaces or genus-0 closed surfaces , has been extensively studied .",
    "a lot of effective algorithms have been proposed . however , as far as we know , very few literatures have been reported on the registration between high - genus surfaces .",
    "the high - genus topology of the surfaces poses a great challenge to register the surfaces .",
    "a possible approach to cope with high - genus surface registration is by introducing cuts to partition the surface into several simply - connected patches .",
    "registration can then be carried out in a patch - by - patch manner . as a result ,",
    "consistent cuts are required , which is usually difficult to locate and prone to error .",
    "motivated by this , we are interested in developing a geometric registration algorithm for high - genus surfaces , which does not involve the introduction of boundary cuts .    in this paper , we propose an effective way to obtain registrations between high - genus surfaces without introducing any cuts , which matches the geometry as much as possible .",
    "the key idea is to conformally parameterize the surface into its universal covering , which is either the 2d euclidean plane @xmath2 or the hyperbolic disk @xmath3 , using the discrete ricci flow method .",
    "registration can then be done on the universal covering space by minimizing a shape mismatching energy measuring the geometric dissimilarity between the surfaces .",
    "our proposed algorithm effectively computes a smooth registration between high - genus surfaces that matches geometric information as much as possible . to test the performance of the proposed method ,",
    "numerical experiments have been done on synthetic high - genus surface data .",
    "results show that our proposed algorithm is effective in registering high - genus surfaces with complete geometric matching .",
    "the proposed method has also been applied to register anatomical structures for medical imaging , which demonstrates the usefulness of the proposed algorithm .",
    "the rest of the paper is organized as follows . in section 2",
    ", we describe some previous works closely related to our paper . in section 3",
    ", we introduce some basic mathematical concepts .",
    "the proposed algorithm for high - genus surface registration is explained in detail in section 4 .",
    "the detailed numerical implementation of the algorithm will be described in section 5 . in section 6 ,",
    "we show the numerical experimental results .",
    "conclusion and future works are described in section 7 .",
    "in this section , we will describe some previous works closely related to our works .",
    "our proposed algorithm requires surface parameterization of the high - genus surface onto its universal covering space .",
    "surface parameterization has been extensively studied , for which different representations of bijective surface maps have been proposed .",
    "conformal registration , which minimizes angular distortion , has been widely used to obtain a smooth 1 - 1 correspondence between surfaces @xcite .",
    "for example , hurdal et al .",
    "@xcite proposed to compute the conformal parameterizations using circle packing and applied it to registration of human brains .",
    "@xcite proposed to compute the conformal parameterizations of human brain surfaces for registration using harmonic energy minimization and holomorphic 1-forms .",
    "conformal registration is advantageous for it preserves the local geometry well .    surface registration , which aims to find an optimal one - to - one correspondence between surfaces , has also been extensive studied .",
    "various algorithms have been proposed by different research groups .",
    "landmark - free registration has been proposed to obtain 1 - 1 correspondences between shapes without feature landmarks .",
    "different algorithms have been proposed to obtain registrations based on the shape information ( such as curvatures ) defined on the surfaces .",
    "lyttelton et al .",
    "@xcite computed surface parameterizations with surface curvature matching .",
    "fischl et al .",
    "@xcite proposed an algorithm for brain registration that better aligns cortical folding patterns , by minimizing the mean squared difference between the convexity of the surface and the average convexity across a set of subjects .",
    "lord et al .",
    "@xcite proposed to match surfaces by minimizing the deviation of the registration from isometry .",
    "yeo et al .",
    "@xcite proposed the spherical demons method , which adopted the diffeomorphic demons algorithm @xcite , to drive surfaces into correspondence based on the mean curvature and average convexity .",
    "quasi - conformal mappings have been applied to obtain surface registration with bounded conformality distortion @xcite .",
    "for example , lui et al .",
    "@xcite proposed to compute quasi - conformal registration between hippocampal surfaces based on the holomorphic beltrami flow method , which matches geometric quantities ( such as curvatures ) and minimizes the conformality distortion @xcite .",
    "most of the above registration algorithms can not match feature landmarks , such as sulcal landmarks on the human brains , consistently . to alleviate this issue ,",
    "landmark - matching registration algorithms are proposed by various research groups .",
    "bookstein et al .",
    "@xcite proposed to obtain a registration that matches landmarks as much as possible using a thin - plate spline regularization ( or biharmonic regularization ) .",
    "tosun et al .",
    "@xcite proposed to combine iterative closest point registration , parametric relaxation and inverse stereographic projection to align cortical sulci across brain surfaces .",
    "these diffeomorphisms obtained can better match landmark features , although not perfectly .",
    "wang et al .",
    "@xcite proposed to compute the optimized conformal parameterizations of brain surfaces by minimizing a compounded energy .",
    "all of the above algorithms represent surface maps with their 3d coordinate functions .",
    "special attention is required to ensure the bijectivity of the resulting registration . besides , smooth vector field has also been proposed to represent surface maps .",
    "lui et al .",
    "@xcite proposed the use of vector fields to represent surface maps and reconstruct them through integral flow equations .",
    "they obtained shape - based landmark matching harmonic maps by looking for the best vector fields minimizing a shape energy .",
    "the use of vector fields to represent surface maps makes optimization easier , but they can not describe all surface maps .",
    "time dependent vector fields can be used to represent the set of all surface maps . for example , joshi et al .",
    "@xcite proposed the generation of large deformation diffeomorphisms for landmark point matching , where the registrations are generated as solutions to the transport equation of time dependent vector fields . the time dependent vector fields facilitate the optimization procedure , although it may not be a good representation of surface maps since it requires more memory .",
    "later , lin et al .",
    "@xcite propose a unified variational approach for registration of gene expression data to neuroanatomical mouse atlas in two dimensions that matches feature landmarks .",
    "again , landmarks can not be exactly matched .",
    "note that inexact landmark - matching registrations are sometimes beneficial . in the case",
    "when landmark points / curves are not entirely accurate , this method is more tolerant of errors in labeling landmarks and gives better parameterization . most of the above algorithms deal with the registration problem between simply - connected open or closed surfaces",
    "in this section , we describe some basic mathematical concepts related to our algorithms . for details ,",
    "we refer the readers to @xcite@xcite@xcite .",
    "a surface @xmath4 with a riemannian metric is called a _ riemann surface_. given two riemann surfaces @xmath5 and @xmath6 , a map @xmath7 is _ conformal _ if it preserves the surface metric up to a multiplicative factor called the conformal factor .",
    "an immediate consequence is that every conformal map preserves angles . with the angle - preserving property",
    ", a conformal map effectively preserves the local geometry of the surface structure .    according to the riemann uniformization theorem",
    ", every riemann surface admits a conformal riemannian metric of constant gaussian curvature .",
    "such metric is called the uniformization metric .",
    "the uniformization metric for a genus @xmath8 surface induces 0 gaussian curvature , whereas a genus @xmath9 surface induces @xmath10 gaussian curvature , which is called the hyperbolic metric of the surface .",
    "given a high - genus surface @xmath4 ( with genus @xmath0 ) , @xmath4 is associated with a universal covering space @xmath11 . a universal covering space is a simply - connected space with a continuous surjective conformal map @xmath12 satisfying the following : for any @xmath13 , there exists an open neighborhood @xmath14 of @xmath15 such that @xmath16 is a disjoint union of open sets in @xmath17 . when @xmath8 , @xmath17 is equal to the whole plane @xmath1 . when @xmath18 , @xmath17 is the unit disk equipped with the hyperbolic metric , which is called the poincar disk @xmath3 .",
    "the poincar disk @xmath3 is a unit disk with metric defined as follows : @xmath19    the distance between two points @xmath20 and @xmath21 on poincare disk is given by : @xmath22    all rigid motions on poincar disk are _ mobis transformations _ : @xmath23\\ ] ]    a generalization of conformal maps is the _ quasi - conformal _ maps , which are orientation preserving homeomorphisms between riemann surfaces with bounded conformality distortion , in the sense that their first order approximations takes small circles to small ellipses of bounded eccentricity @xcite .",
    "thus , a conformal homeomorphism that maps a small circle to a small circle can also be regarded as quasi - conformal .",
    "surface registrations and parameterizations can be considered as quasi - conformal maps .",
    "mathematically , @xmath24 is quasi - conformal provided that it satisfies the beltrami equation : @xmath25 for some complex valued lebesgue measurable @xmath26 satisfying @xmath27 .",
    "@xmath26 is called the _ beltrami coefficient _ , which is a measure of non - conformality . in particular , the map @xmath28 is conformal around a small neighborhood of @xmath15 when @xmath29 . from @xmath30 ,",
    "we can determine the angles of the directions of maximal magnification and shrinking and the amount of them as well .",
    "specifically , the angle of maximal magnification is @xmath31 with magnifying factor @xmath32 ; the angle of maximal shrinking is the orthogonal angle @xmath33 with shrinking factor @xmath34 .",
    "the distortion or dilation is given by : @xmath35    thus , the beltrami coefficient @xmath26 gives us all the information about the properties of the map .",
    "given a beltrami coefficient @xmath36 with @xmath37 .",
    "there is always a quasiconformal mapping from @xmath2 onto itself which satisfies the beltrami equation in the distribution sense @xcite .",
    "in this section , we explain our algorithm for registering high - genus surfaces in details .",
    "the basic idea is to embed the surfaces into their universal covering spaces and register them on the universal covering space .",
    "our proposed algorithm can be divided into three main stages :    1 .",
    "* embedding of the high - genus surface into the universal covering space : * the high - genus surfaces are first conformally parameterized into its universal covering spaces in @xmath1 , which is the euclidean plane @xmath2 for @xmath8 and hyperbolic disk @xmath3 for @xmath38 , using the discrete ricci flow method .",
    "2 .   * computing the initial registration * harmonic registration between the fundamental domains is computed as an initial registration .",
    "* shape matching registration : * a surface registration which matches the geometry is obtained by minimizing a shape mismatching energy on the universal covering space .    in the following , we will describe each stages in detail .      in this work ,",
    "the surface registration is computed on the universal covering space in @xmath1 of the high - genus surfaces .",
    "this simplifies the calculation , since all computations can be done in the two dimensional space .    in this work ,",
    "the embedding of @xmath4 into its universal covering space @xmath17 is computed using the ricci flow method introduced by gu et al .",
    "ricci flow is the process to conformally deform the surface metric @xmath39 according to its induced gaussian curvature @xmath40 .",
    "the process is similar to heat flow on manifolds : @xmath41 where @xmath42 ( @xmath8 ) or @xmath43 ( @xmath38 ) is target curvature .",
    "convergence of this process is guaranteed by hamilton s theorem .",
    "@xmath44 is the desired uniformization metric .    to obtain the embedding , the surface @xmath4 is firstly sliced along the cut graph @xmath45 to get the fundamental domain of @xmath4 , denoted as @xmath46",
    "let @xmath13 be a base point on the surface @xmath4 .",
    "then , there are many _ closed loops _ based at @xmath15 . two loops @xmath47 and @xmath48 are said to be equivalent if one can be deformed into the other without breaking .",
    "mathematically , there exists a homotopy @xmath49\\times [ 0,1]\\to s$ ] such that @xmath50 and @xmath51 . all equivalent closed loops equivalent to each other form an equivalence class .",
    "the set of all equivalence classes form a group , which is called _ fundamental group _ ,",
    "@xmath52 , of @xmath4 .",
    "suppose @xmath53 is a basis of @xmath52 .",
    "slicing along the basis , the high - genus surface will become a simply connected open surface , which is called _ fundamental domain_.    the fundamental group basis @xmath54",
    "is called _ canonical _ if any two loops intersect only at the base point @xmath15 . from algebraic topology ,",
    "the boundary of the fundamental domain with respect to the canonical loops or cuts is given by @xmath55    in this paper , we apply the greedy approach proposed in @xcite to compute the homotopic basis . each canonical cut is the chosen to be the shortest path in its equivalent class .        with the uniformization metric , the fundamental domain @xmath46 can be embedded onto a region @xmath56 in its universal covering space . for genus one closed surface ,",
    "the universal covering is the euclidean plane @xmath2 ( see figure [ fig : illustrationucs](a ) ) . for genus",
    "greater than one , the universal covering is the poincar disk @xmath3 ( see figure [ fig : illustrationucs](b ) )",
    ". let @xmath57 , where @xmath14 is the index set .",
    "@xmath56 belongs to one of the pieces , @xmath58 .",
    "also , @xmath59 and @xmath60 intersect at the boundaries only if @xmath61 . by glueing all @xmath59 s together",
    ", the universal covering can be obtained .",
    "note that the canonical cuts are introduced to obtain the universal covering only . during the registration process",
    ", the canonical cuts on the source surface are allowed to move freely on the target surface , since the whole process will be done on the universal coverings . in other words ,",
    "the correspondences between canonical cuts are not required .",
    "it avoids the issue of finding a consistent cuts to obtain the accurate registration .",
    "we first compute an initial surface registration between two high - genus surfaces @xmath62 and @xmath63 of genus @xmath64 .",
    "an initial map can be chosen as the harmonic map by fixing the correspondence of the boundary cuts .",
    "let @xmath65 and @xmath66 be the canonical fundamental domains of @xmath62 and @xmath63 respectively , computed in the first stage as described in the previous subsection . in this subsection ,",
    "the metric used is always chosen to be the euclidean metric if @xmath8 and the hyperbolic metric if @xmath38 .",
    "the canonical polygon has @xmath67 vertices and hence @xmath67 edges .",
    "vertices of the canonical polygon corresponding to the single base point @xmath15 on the surface .",
    "all edges are geodesics .",
    "let @xmath68 and @xmath69 be the base point of @xmath62 and @xmath63 respectively , @xmath70 corresponds to @xmath71 . with these base points , @xmath62 and @xmath63 can be conformally mapped to their fundamental domains @xmath65 and @xmath66 in their universal covering spaces ( see figure 1 ) .",
    "we denote the conformal parameteriztions by @xmath72 and @xmath73 . to obtain an initial registration between @xmath62 and @xmath63 , we compute a mapping @xmath74 between @xmath65 and @xmath66 .",
    "@xmath75 gives us an initial mapping between @xmath62 and @xmath63 .",
    "here , we assume corresponding edges between two canonical polygons can be matched .",
    "in other words , we assume the boundary condition @xmath76 is given , through the arc - length parameterization .",
    "note that the boundary cuts on each surfaces might not exactly correspond to each others .",
    "however , since canonical cuts are chosen , the edges corresponds to the shortest loops on the surfaces . as a result ,",
    "the initial boundary correspondence is a reasonable guess for the initial registration . with the boundary correspondence @xmath77 , a unique harmonic map between the two canonical polygons can be computed .",
    "the harmonic map @xmath78 can be computed by minimizing harmonic energy @xmath79    minimizing the above energy functional is equivalent to solve following pde @xmath80 where @xmath81 is laplace - beltrami operator under the uniformization metric .",
    "this initial registration provide us with a smooth mapping between @xmath62 and @xmath63 .",
    "note that there are also other choices of initial maps , such as patch by patch registration or landmark matching registration .",
    "now , to obtain a geometric matching registration , we propose to refine the registration from the initial registration to match a geometric mismatching energy .",
    "the detailed numerical implementation of the initial registration will be described in section [ shapematching ] .      in the previous subsection",
    ", we use hyperbolic harmonic map between two canonical polygons as initial registration .",
    "we assume that the boundary cuts are properly matched .",
    "edges of canonical polygon are ( hyperbolic ) shortest loops on surface which pass the base point .",
    "however , the shortest loops depend on the uniformaization metric , which do not directly take the geometric information of the surfaces into consideration .",
    "constraining the boundary cuts to be exactly matched often induces error in the final registration . to obtain a better geometric matching registration ,",
    "we propose a variational approach , which minimizes a geometric mismatching energy , without fixing the correspondences of the boundary cuts .",
    "surface curvatures are important quantities to describe the surface geometry .",
    "we therefore consider an energy functional which measures the curvature mismatching under a registration @xmath82 .",
    "more specifically , we propose to find an optimal diffeomorphism @xmath83 which minimizes the following energy functional @xmath84 : @xmath85    where @xmath86 are mean curvatures on @xmath62 and @xmath63 respectively , and @xmath87 are the gauss curvatures on @xmath62 and @xmath63 respectively .    the first term , which is the harmonic energy , controls the smoothmess of the registration .",
    "the last two terms , which measure the mistmatching of surface curvatures , are used to match the surface geometry .",
    "solving the above variational problem ( [ energye ] ) directly on the surfaces is challenging . to simplify the optimization process",
    ", we propose to solve the problem on the universal covering spaces of @xmath62 and @xmath63 .",
    "let @xmath88 and @xmath89 be the covering maps of @xmath62 and @xmath63 respectively .",
    "suppose @xmath90 , where @xmath91 is the index set and @xmath92 intersects with @xmath93 at their boundaries if @xmath94 .",
    "similarly , we let @xmath95 , where@xmath96 intersects with @xmath97 at their boundaries if @xmath94 .",
    "we then proceed to look for a diffeomorphism @xmath98 , which is the lifting of the optimal registration @xmath99 . in other words",
    ", we require that @xmath100    equation ( [ periodic ] ) ensures that @xmath101 satisfies the periodic condition on the covering spaces . in practice , suppose the canonical cuts on @xmath62 is given by @xmath54 , we require that @xmath102 where @xmath103 and @xmath104 are the deck transformations .    since @xmath101 is the lifting of @xmath105 , it minimizes the following energy functional : @xmath106 subject to the constraint that @xmath107 for all @xmath108 .",
    "@xmath109 are called the fuchsian group generators , which are the generators of the deck transformation group of @xmath63 . when @xmath8 , @xmath103 and @xmath110 are just translations in @xmath1 . when @xmath38 , @xmath103 and @xmath110 are mobis transformations of the unit disk , which can be computed explicitly .",
    "we will describe the computation of @xmath111 .",
    "the other fuchsian group generators can be obtained in the same way .",
    "suppose the starting point and ending points of @xmath112 are @xmath113 and @xmath114 , and the starting point and ending points of @xmath115 are @xmath116 and @xmath117 .",
    "we need to look for a mobis transformation @xmath111 such that @xmath118 and @xmath119 .",
    "we first compute a mobis transformation to map @xmath113 to the origin , which is given by : @xmath120 .",
    "then , @xmath121 maps @xmath122 to a radial euclidean line .",
    "let the angle between @xmath123 and the real axis be @xmath124 , and let @xmath125 .",
    "then , @xmath126 maps @xmath113 to the origin and @xmath122 to the real axis .",
    "similarly , we can find mobis transformation @xmath127 and @xmath128 such that @xmath129 maps @xmath117 to the origin and @xmath130 to the real axis .",
    "the deck transformation @xmath111 is then given by : @xmath131 .    to solve the optimization problem ( [ energyeh ] ) ,",
    "we use a splitting method to minimize : @xmath132    fixing @xmath64 , we first minimize @xmath133 : @xmath134    at each point @xmath135 , we consider the taylor s expansion of @xmath136 and @xmath137 about @xmath138 , @xmath139    plugging equations ( [ taylor ] ) into equation ( [ e1 ] ) , we look for a small perturbation from @xmath64 to @xmath77 such that @xmath140 is minimized .",
    "it can be done by solving the following pde : @xmath141    in the discrete case , the above problem can be solved by the guass - newton method , which will be described in the next section .",
    "next , fixing @xmath77 , we minimize @xmath142    @xmath143 can be minimized by solving the elliptic pde : @xmath144    recall that the registration computed should satisfy the constraint ( [ periodic ] ) .",
    "hence , we enforce this constraint when solving equation ( [ e2gradient ] ) . in the discrete case",
    ", the above problem becomes a nonlinear system , which can be solved effectively using newton s method .    in this way",
    ", we can minimize @xmath145 alternatively over @xmath64 and @xmath77 . more specifically ,",
    "suppose @xmath146 is obtained at the n - th iteration , we fix @xmath147 to obtain @xmath148 by solving equation ( [ e1pde ] ) .",
    "we then fix @xmath148 to obtain @xmath149 by solving equation([e2gradient ] ) .",
    "one crucial issue in computing the surface registration is to preserve its bijectivity . in this work ,",
    "we propose to enforce the bijectivity using the beltrami coefficient of the surface map .",
    "let @xmath150 be the mapping between the universal coverings of @xmath62 and @xmath63 .",
    "we need to ensure that @xmath64 is bijective .",
    "every mapping @xmath64 is associated with a beltrami coefficient , @xmath151 , which is a complex - valued function defined on @xmath152 .",
    "@xmath64 is bijective if and only if its jacobian @xmath153 everywhere .",
    "simple checking gives @xmath154 hence , @xmath64 is bijective if and only if @xmath155 everywhere .",
    "motivated by the above observation , we propose to enforce @xmath156 in each iterations during the optimization process described in the last subsection .",
    "this can be done as follows .",
    "suppose @xmath147 is obtained at the n - th iteration .",
    "let @xmath157 be a small parameter .",
    "we first compute : @xmath158 we then smooth @xmath159 by minimizing the following energy functional : @xmath160    the above minimization problem is equivalent to solving the following pdes : @xmath161 subject to the constraint that for every @xmath162 @xmath163 for all @xmath164 and @xmath165 for all @xmath166 .",
    "once a smooth beltrami coefficient @xmath167 is obtained , we need to find a quasi - conformal map @xmath168 whose beltrami coefficient closely resemble to @xmath167 .",
    "suppose @xmath169 with beltrami coefficient @xmath170 .",
    "we can write @xmath171 and @xmath172 as linear combinations of @xmath173 and @xmath174 , @xmath175 where @xmath176 ; @xmath177 ; @xmath178 .    similarly , @xmath179    since @xmath180 , we obtain @xmath181    where @xmath182 .",
    "therefore , to construct @xmath168 , we let @xmath183 and solve equation ( [ eqt : beltramipde ] ) subject to the constraint that @xmath184 for all @xmath108 .",
    "the details of the numerical implementation will be explained in the next section .",
    "we summarize our proposed high - genus surface registration algorithm as follows .",
    "@xmath185 _ ( high - genus surface registration )",
    "_ + @xmath186 _ high - genus surface @xmath62 and @xmath63 _ + @xmath187 _ geometric matching surface registration @xmath82 _ +    1 .   _",
    "compute the conformal parameterizations @xmath188 and @xmath189 of @xmath62 and @xmath63 respectively ; _ 2 .",
    "_ compute the initial mapping @xmath190 ; let @xmath191 ; _ 3 .",
    "_ given @xmath192 at n - th iteration , obtain @xmath148 by fixing @xmath147 and solving equation [ e1pde ] ; fixing @xmath148 , obtain @xmath149 by solving equation [ e2gradient ] ; _ 4 .",
    "_ compute the beltrami coefficient @xmath193 of @xmath149 ; obtain a smooth beltrami coefficient @xmath194 by solving equations [ mucrop ] and [ smoothmupde ] ; _ 5 .   _",
    "obtain a quasi - conformal map @xmath195 from @xmath194 by solving equation [ eqt : beltramipde ] ; _ 6 .   _",
    "if @xmath196 , continue . otherwise , stop the iteration . _",
    "in this section , we describe in details the numerical implementation of our proposed algorithm .",
    "all our computations are done on the universal covering space , which is @xmath2 for genus one surfaces and @xmath3 for high genus surfaces .",
    "the universal covering space consists of infinite copies of fundamental domains , which are unique up to deck transformations .",
    "many important operators are identical on each fundamental domains . for example , the laplace - beltrami operator , which is crucial in our model , are identical on each fundamental domain , since it is invariant to rigid motions . based on this observation , the numerical implementation can be done on one piece of the fundamental domain , while allowing its boundary to be mapped freely onto the universal covering space of the target surface . in other words , boundary correspondences between the canonical cuts of the two surfaces",
    "are not enforced .",
    "laplace - beltrami operator plays a crucial role in our proposed algorithm .",
    "most key steps involve solving a poisson equation on the universal covering space . in this subsection , we describe how to discretize laplace - beltrami operator on the fundamental domain , which can be lifted to the universal covering space .",
    "poisson s equation can then be solved on the universal covering space .",
    "+ on triangle mesh , laplace - beltrami operator can be discretized by the cotangent formula : @xmath197 where @xmath198 is the set of vertex indices of one - ring neighbors of vertex @xmath199 ; @xmath200 where @xmath201 and @xmath202 are the two angles facing the edge @xmath203 $ ] .",
    "we use @xmath199 denote both the @xmath204 vertex and it s complex coordinate .",
    "then we obtain the poisson equation in matrix form : @xmath205 where @xmath206 is a square matrix , @xmath207 .",
    "the computation on each vertex only uses its one - ring neighbor vertices .",
    "so we can discretize the laplace - beltrami operator on each vertex of the fundamental domain .",
    "but on boundary of fundamental domain , the discretization will use vertices outside the fundamental domain ( see figure [ fig : poincare_boundary_illustration ] ) .",
    "every vertex outside the fundamental domain has a unique copy inside the fundamental domain up to a rigid motion . whenever computation involves vertices outside the fundamental domain",
    ", we will refer to its inside copy .",
    "note that this is also valid for base points , so we have a valid discretization on base points .",
    "we always fix base points by letting @xmath208 if @xmath209,@xmath210 for a base point @xmath199 . for a vertex on boundary except base points , the discretization will be @xmath211 where @xmath198 is the set of vertex indices of one - ring neighbors of vertex @xmath199 on the fundamental domain , @xmath212 is the set of vertex indices of one - ring neighbors of vertex @xmath199 outside the fundamental domain , while @xmath213 denotes the set of vertex indices of one - ring neighbors of vertex @xmath199 inside the fundamental domain .",
    "for example , in figure [ fig : poincare_boundary_illustration ] , @xmath214 , @xmath215 , @xmath216 .    for simplicity ,",
    "we let @xmath217 .",
    "the laplace - beltrami operator becomes @xmath218    suppose @xmath219 is outside the fundamental domain .",
    "we denote the the inside copy of vertex @xmath219 by @xmath220 .",
    "let @xmath221 be the deck transformation that moves @xmath222 to @xmath220 , that is , @xmath223 , we have @xmath224    the second equality uses the fact that laplace - beltrami operator is rigid - motion invariant .    with this discretization , the poison s equation can be rewriten in a matrix form : @xmath225 where @xmath226 is the matrix representation of the laplace - beltrami operator , and @xmath227 is a deck transformation that transforms outside neighbor @xmath228 of vertex @xmath199 to its inside copy @xmath229 and is zero elsewhere .    for genus one surfaces ,",
    "deck transformations are linear translation and so @xmath230 is a linear operator .",
    "combining @xmath230 into @xmath206 , equation [ poisonmatrix ] becomes a linear system and can be solved efficiently .",
    "however , for higher genus surfaces , deck transformations are mobis transformation , which is nonlinear .",
    "equation [ poisonmatrix ] becomes a nonlinear system .",
    "it can be solved by newton s method efficiently .",
    "let @xmath231 .",
    "@xmath232 is the gradient of @xmath233 , where @xmath234 is computed element - wisely .",
    "the problem can then be solved using standard newton s method :    1 .",
    "initialize @xmath235 by @xmath236 , which is current position ; 2 .",
    "compute @xmath237 , if @xmath238 , stop the process ; 3 .",
    "compute @xmath239 , solve @xmath114 from equation @xmath240 ; if @xmath241 , stop the process ; otherwise , let @xmath242 and go to step 2 .",
    "the linear equation in step 3 can be solved by lu factorization , which turns out to be quite efficient . in our numerical computation , we observe that the newton s method converges very quickly :",
    "usually two or three iterations will achieve @xmath243 accuracy .",
    "we use an alternating approach to minimize the proposed energy function . in each iteration , we first minimize @xmath133 to get @xmath77 , then minimize @xmath244 to get @xmath64 .",
    "we first discuss the minimization of @xmath133 . with the linear approximation ( [ taylor ] )",
    ", we have @xmath245 then the minimization problem can be solved individually for each vertex @xmath15 in least square sense : @xmath246 let @xmath247 we have @xmath248 in computation , the inversion @xmath249 can be obtained by sherman - morrison formula .",
    "let @xmath250 , @xmath251 , then @xmath252 , @xmath253 .",
    "apply sherman - morrison formula twice , we have @xmath254 hence we have a simple solution for @xmath77 . if we consider either mean curvature @xmath255 or gaussian curvature @xmath256 , i.e. , @xmath257 or @xmath258 , the expression of @xmath77 can be further simplified .",
    "for example , if @xmath259 , we have @xmath260 hence , @xmath261    the minimization of @xmath244 is obtained by solving equation ( [ e2gradient ] ) : @xmath262 where laplace operator is discretized by cotangent formula . +",
    "since the operation discussed in section 5.1 will not affect identity matrix , it can be applied to this equation .",
    "so we have @xmath263 this nonlinear equation is then solved by newton s method . for genus one surfaces , it is still linear , we can solve it directly .      to ensure bijectivity ,",
    "a smoothing operation on beltrami coefficient is applied .",
    "then we reconstruct the mapping from smoothed beltrami coefficient by solving the beltrami equation . +",
    "the beltrami equation is in fact a poisson equation with a generalized laplace - beltrami operator ( see equation [ eqt : beltramipde ] ) .",
    "we can solve the equation as described in section [ solvingpoison ] .",
    "since we have a generalized laplace - beltrami operator , cotangent formula ca nt be used .",
    "we use discretization scheme proposed in @xcite , which also uses one - ring neighborhood to discretize the generalized laplace - beltrami operator .",
    "hence , the method described in section [ solvingpoison ] can still be applied .",
    "more specifically , the gradient operator @xmath264 can be discretized by linear approximation . for a triangle @xmath265 , @xmath266 the coordinates of three vertices , let @xmath267 , we have @xmath268 where @xmath269 is the area of the triangle , @xmath270 .",
    "+ then we obtain the discrete gradient operator at vertex @xmath271 : @xmath272 where @xmath273 be the collection of neighborhood faces attached to vertex @xmath271 . note that in the summation we omit the superscripts on @xmath28 and @xmath274 to avoid confusion .",
    "+ similarly , the discretization of divergence operator @xmath275 for a vector @xmath276 : @xmath277    the discretization of equation ( [ eqt : beltramipde ] ) can be obtained by applying above two formulas .",
    "+ following the discussion in section [ solvingpoison ] , the beltrami equation can be formulated as @xmath278    the above equation is linear in the case of genus one surfaces and is nonlinear in the case of higher genus surfaces . by solving the equation , we will get reconstructed quasi - conformal map associated to the smoothed beltrami coefficient .",
    "to test the efficacy of the proposed algorithm , experiments have been carried out on synthetic high - genus surface data together with real medical data ( vertebrae bone and vestibular system ) .",
    "we first test our algorithm on synthetic surface data .",
    "[ [ example-1 ] ] example 1 + + + + + + + + +    in our first examples , we test the proposed method on a standard torus of genus one .",
    "figure [ fig : tours1](a ) and ( b ) show two genus-1 torus , denoted by @xmath62 and @xmath63 respectively , with different intensity functions defined on each of them .",
    "the two surfaces are parameterized onto their universal covering spaces , and registration between the two surfaces is computed on the 2d parameter domains .",
    "the intensity functions on each surfaces are plotted on their universal covering spaces , which are shown in ( c ) and ( d ) .",
    "figure [ fig : torus2](a ) shows the registration result that matches the intensity functions .",
    "the intensity function defined on @xmath62 is mapped to @xmath63 using the obtained registration .",
    "( b ) shows the registration result on the universal covering spaces .",
    "the intensity functions are perfectly matched under the obtained registration ( compared with figure [ fig : tours1](d ) ) .",
    "note that the boundary cuts are not fixed .",
    "they move freely on the universal covering space , which satisfy the periodic conditions .",
    "figure [ fig : torus3 ] shows the curvature mismatching energy , harmonic energy and total energy versus iterations . all of them decrease monotonically as iteration increases .",
    "it demonstrates that our algorithm computes the optimized harmonic map between the genus-1 surfaces that matches the intensity functions as much as possible .",
    "[ [ example-2 ] ] example 2 + + + + + + + + +    we test our proposed algorithm to obtain geometric matching registration between two synthetic genus-1 surfaces through matching their curvatures . figure [ fig : torusbump1](a ) and ( b ) show two synthetic genus-1 surfaces , with three bumps added to each surfaces located at different positions .",
    "the colormaps on each surfaces are given by their mean curvatures .",
    "using our proposed method , we compute both the registration without curvature matching and the registration with curvature matching . the registration result is shown in figure [ fig : torusbump2 ] .",
    "the color intensity on @xmath62 ( given by the mean curvature ) is mapped to @xmath63 using the obtained registrations .",
    "the registration without curvature matching can not match the feature bumps on the two surfaces , whereas the registration with curvature matching can match the bumps consistently .",
    "it illustrates that our proposed method can obtain a better registration that matches geometry between the two surfaces . the curvature mismatching energy , harmonic energy and total energy versus iterations are shown in figure [ fig : torusbump3 ] .",
    "again , all energies decrease monotonically as iteration increases and converge in about 30 iterations .",
    "[ [ example-3 ] ] example 3 + + + + + + + + +    we now test our algorithm on synthetic genus-2 surfaces .",
    "figure [ fig : genus21](a ) and ( b ) show two genus-2 surfaces , denoted by @xmath62 and @xmath63 respectively , with different intensity functions defined on each of them .",
    "the two surfaces are parameterized onto their universal covering spaces , and registration between the two surfaces is computed on the 2d parameter domains .",
    "the intensity functions on each surfaces are plotted on their universal covering spaces , which are shown in ( c ) and ( d ) . in figure",
    "[ fig : genus22](a ) , we shows obtained registration between the two surfaces that matches the intensity functions .",
    "the intensity function defined on @xmath62 is mapped to @xmath63 using the obtained registration .",
    "( b ) shows the registration result on the universal covering spaces .",
    "the intensity functions are perfectly matched under the obtained registration ( compared with figure ( d ) ) .",
    "again , the boundary cuts are not fixed .",
    "they move freely on the universal covering space , which satisfy the periodic conditions .",
    "figure [ fig : genus23 ] shows the curvature mismatching energy , harmonic energy and total energy versus iterations .",
    "all of them decrease monotonically as iteration increases .",
    "it illustrates that our algorithm computes the optimized ( hyperbolic ) harmonic map between the genus-2 surfaces that matches the intensity functions as much as possible .",
    "[ [ example-4 ] ] example 4 + + + + + + + + +    we also test our method on two synthetic genus-2 surfaces .",
    "figure [ fig : eight1](a ) and ( b ) show two synthetic genus-2 surfaces , with two bumps added to each surfaces located at different positions .",
    "the colormaps on each surfaces are given by their mean curvatures .",
    "using our proposed method , we compute both the registration without curvature matching and the registration with curvature matching .",
    "the registration results are shown in figure [ fig : eightregistration ] .",
    "the color intensity on @xmath62 ( given by the mean curvature ) is mapped to @xmath63 using the obtained registrations .",
    "the registration without curvature matching can not match the feature bumps on the two surfaces ( see the regions in the highlighted boxes ) .",
    "it is however observed that the registration with curvature matching can match the bumps consistently .",
    "it again demonstrates the effectiveness of our proposed method to obtain a geometric matching registration between genus-2 surfaces .",
    "figure [ fig : eightenergy ] shows the curvature mismatching energy , harmonic energy and total energy versus iterations .",
    "again , all energies decrease monotonically as iteration increases and converge in about 20 iterations .                  in medical imaging , study shape changes of anatomical structures are important for the purpose of disease analysis . to perform shape analysis effectively ,",
    "an accurate surface registration between anatomical structures is necessary . in this subsection",
    ", we will show two applications of our proposed algorithm in medical imaging to register two real medical data , namely , 1 . the vertebrae bone and 2 . the vestibular system .",
    "[ [ example-5-vertebrae - bone ] ] example 5 ( vertebrae bone ) + + + + + + + + + + + + + + + + + + + + + + + + + +    the study of morphological changes of the vertebrae is important in detecting vertebral fractures and degenerative shape changes . an accurate and meaningful registration between the vertebrae bone surfaces is therefore important . using our proposed algorithm ,",
    "a geometric matching surface registration between different vertebrae bones can be obtained .",
    "figure [ fig : boneillustration](a ) and ( b ) show the vertebrae bones of two different subjects .",
    "they are both of genus one .",
    "our goal is to find a geometric matching registration between the two surfaces .",
    "the registration result of the vertebrae bones using our proposed algorithm is shown in figure [ fig : boneregistered ] .",
    "( a ) shows the vertebrae bone surface of subject 1 , colored by its mean curvature .",
    "the color intensity ( given by the mean curvature ) on the vertebrae bone of subject 1 is mapped to the vertebrae bone of subject 2 in ( b ) , using the obtained registration .",
    "note that the high curvature regions are consistently matched .",
    "for example , the `` hammers '' on the vertebae bone of subject 1 ( labeled as region i - vi ) are matched consistently with the `` hammers '' on the vertebae bone of subject 2 .",
    "( c ) and ( d ) shows the registration result on the universal covering spaces .",
    "note that the boundary cuts are not fixed .",
    "they move freely on the universal covering space , which satisfy the periodic conditions .",
    "figure [ fig : boneenergy ] shows the curvature mismatching energy , harmonic energy and total energy versus iterations of our algorithm . all energies monotonically decrease as iteration increases .",
    "in particular , curvature mismatching energy decreases monotonically , which means the optimal map obtained matches curvatures as much as possible .",
    "[ [ example-6-vestibular - system ] ] example 6 ( vestibular system ) + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    the vestibular system ( vs ) is an inner structure of the ear , which is responsible for perception of head movements and sending postural signals to the brain .",
    "the shape analysis of the vestibular system plays an important role in understanding a disease called adolescent idiopathic scoliosis ( ais ) , which is a 3d spinal deformity affecting about 4% schoolchildren worldwide .",
    "it therefore calls for the need to register the vestibular systems .",
    "the vestibular system is of genus 3 .",
    "the high - genus topology of the surface poses great challenges to obtain the surface registration .",
    "using our proposed algorithm , we obtain a geometric matching surface registration between the vestibular systems .",
    "figure [ fig : vsillustration](a ) and ( b ) show the vestibular systems of two different subjects .",
    "they are both of genus three .",
    "our goal is to find a geometric matching registration between the two surfaces .",
    "the registration result of the vestibular systems using our proposed algorithm is shown in figure [ fig : vsregistered ] .",
    "( a ) shows the vestibular system of subject 1 , colored by its mean curvature . the color intensity ( given by the mean curvature ) on the vestibular system of subject 1",
    "is mapped to the vestibular system of subject 2 in ( b ) , using the obtained registration .",
    "note that the corresponding regions are consistently matched .",
    "for example , the three canals of each surfaces are matched consistently .",
    "( c ) and ( d ) shows the registration result on the universal covering spaces .",
    "note that the boundary cuts are not fixed .",
    "they move freely on the universal covering space , which satisfy the periodic conditions .",
    "figure [ fig : vsenergy ] shows the curvature mismatching energy , harmonic energy and total energy versus iterations of our algorithm . all energies monotonically decrease as iteration increases .",
    "in particular , curvature mismatching energy decreases monotonically , which means the optimal registration obtained matches curvatures as much as possible .",
    "in this work , we propose a method to obtain geometric registrations between high - genus ( @xmath0 ) surfaces , without introducing consistent cuts . the key idea is to conformally parameterize the surface into its universal covering space in @xmath1 .",
    "registration can then be done on the universal covering by minimizing a shape mismatching energy measuring the geometric dissimilarity between the surfaces .",
    "our proposed algorithm effectively computes a smooth registration between high - genus surfaces that matches geometric information as much as possible . to test the performance of the proposed method ,",
    "numerical experiments have been done on synthetic high - genus surface data .",
    "results show that our proposed algorithm is effective in registering high - genus surfaces with complete geometric matching .",
    "the proposed method has also been applied to registration of anatomical structures for medical imaging , which demonstrates the usefulness of the proposed algorithm . in the future",
    ", we will apply the proposed algorithm to register more anatomical structures , such as the vestibular system and the vertebrae bone , for the purpose of disease analysis .",
    "lok ming lui is supported by rgc grf ( project i d : 2130271 ) and cuhk direct grant ( project i d : 2060413 ) .",
    "the medical data are provided by cuhk medical school ."
  ],
  "abstract_text": [
    "<S> this paper presents a method to obtain geometric registrations between high - genus ( @xmath0 ) surfaces . </S>",
    "<S> surface registration between simple surfaces , such as simply - connected open surfaces , has been well studied . however , </S>",
    "<S> very few works have been carried out for the registration of high - genus surfaces . </S>",
    "<S> the high - genus topology of the surface poses great challenge for surface registration . </S>",
    "<S> a possible approach is to partition surfaces into simply - connected patches and registration is done patch by patch . </S>",
    "<S> consistent cuts are required , which are usually difficult to obtain and prone to error . in this work , </S>",
    "<S> we propose an effective way to obtain geometric registration between high - genus surfaces without introducing consistent cuts . </S>",
    "<S> the key idea is to conformally parameterize the surface into its universal covering space , which is either the euclidean plane or the hyperbolic disk embedded in @xmath1 . </S>",
    "<S> registration can then be done on the universal covering space by minimizing a shape mismatching energy measuring the geometric dissimilarity between the two surfaces . </S>",
    "<S> our proposed algorithm effectively computes a smooth registration between high - genus surfaces that matches geometric information as much as possible . </S>",
    "<S> the algorithm can also be applied to find a smooth and bijective registration minimizing any general energy functionals . </S>",
    "<S> numerical experiments on high - genus surface data show that our proposed method is effective for registering high - genus surfaces with geometric matching . </S>",
    "<S> we also applied the method to register anatomical structures for medical imaging , which demonstrates the usefulness of the proposed algorithm .    </S>",
    "<S> surface registration , high - genus surface , universal covering space , conformal parameterization , shape mismatching energy </S>"
  ]
}