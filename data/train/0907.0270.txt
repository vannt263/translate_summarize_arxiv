{
  "article_text": [
    "the problem of jet reconstruction is ubiquitous in the analysis of particle physics experimental data .",
    "the celebrated asymptotic freedom of partons at high energies  @xcite leads to a description of particle interactions in which there is little or no interference between the hard scattering and the hadronization stages .",
    "the kinematic properties of parent partons are imprinted on jets , and this allows the experimentalists to reconstruct the physics at the characteristic scales of a few fermi ( 10@xmath0  m ) from the large - scale energy deposition structures observed in a  particle detector .",
    "the fftjet software package described in the current article allows its users to implement a variety of jet reconstruction scenarios following the same basic two - stage approach : first , pattern recognition is performed whereby `` preclusters '' are found in the @xmath1 and @xmath2 are the variables which define the direction of the energy deposit .",
    "@xmath2 is the azimuthal angle , while the meaning of @xmath3 is user - selectable ( typically , rapidity or pseudorapidity ) . ] and then jet energies are reconstructed using preclusters as initial approximate jet locations .",
    "this approach has several important advantages over the cone and jet reconstruction algorithms  @xcite used at currently operating hadron collider experiments :    * the techniques used to determine jet energies are not necessarily optimal for determining the event topology ( _ i.e. _ , the number of jets ) .",
    "these problems are distinct and should be solved separately .",
    "the tasks of defining `` what is a jet '' , locating jets , selecting the event topology , and reconstructing jet energies are cleanly separated . *",
    "the knowledge of the jet shape asymmetry in the can be effectively utilized which results in a superior algorithm performance in the presence of a magnetic field .",
    "* provisions can be made for efficient suppression of the detector noise both at the pattern recognition and at the energy reconstruction stages .",
    "the computational complexity of the pattern recognition stage is @xmath4 , where @xmath5 is on the order of the number of towers in the detector calorimeter and @xmath6 is the user - selectable number of angular resolution scales ( cone and algorithms use only one resolution scale ) .",
    "this complexity is independent from the detector occupancy and thus allows for predictable execution times which can be important for online use .",
    "the computational complexity of the jet energy reconstruction stage is @xmath7 where @xmath8 is the number of jets found and @xmath9 is the number of objects ( 4-vectors ) used to describe the event energy flow ( @xmath10 ) .",
    "the main computational engine behind the pattern recognition stage is discrete fast fourier transform ( dfft ) .",
    "the fftjet package is designed to take advantage of widespread availability of dfft implementations .",
    "the pattern recognition code can be easily adapted to run on a  variety of hardware platforms including digital signal processors ( dsps ) and graphics processing units ( gpus ) .",
    "the necessity of improving pattern recognition capabilities of jet reconstruction algorithms has been recognized both in the context of multijet , high occupancy events and in the cases when massive particles decaying hadronically via electroweak interaction ( @xmath11 and @xmath12 bosons , top quarks ) are sufficiently boosted so that the energy flow of their decay products can not be partitioned into well - separated jets . due to software availability , lhc - targeted studies of particle physics processes of this kind utilized predominantly sequential recombination techniques ( see ref .",
    "@xcite for a  recent review ) .",
    "the fftjet package is designed to provide advanced pattern recognition performance in a  global algorithm .",
    "the jet reconstruction model implemented in fftjet was originally inspired by refs .",
    "@xcite and  @xcite and initially proposed in  @xcite .",
    "the study by cheng  @xcite establishes an  important connection between the iterative cone algorithm and kernel density estimation ( kde )  @xcite .",
    "cheng proves that the locations of stable cone centers correspond to modes ( peaks ) of the energy density built in the using kernel density estimation with the epanechnikov kernel .",
    "that is , all such centers can be found by convolving the empirical energy density @xmath13 with the function @xmath14 and then funding all local maxima of the convolution .",
    "here , @xmath15 is an energy variable whose precise meaning is user - defined ( typically , transverse momentum or transverse energy of a  particle , calorimeter tower , _ etc . _ ) , @xmath16 is the two - dimensional delta function , and the sum is performed over all energy deposits expected to be jet constituents ( typically , leptons and photons produced in the hard scattering process are excluded ) .",
    "@xmath17 is the cone radius in the @xmath1 .",
    "the connection between the iterative cone algorithm and kde immediately suggests an  efficient implementation of a seedless cone algorithm : one should discretize the calorimeter signals ( or mc particles ) on a regular grid in the @xmath1 , perform the convolution by dfft , and find the peaks .",
    "this approach , however , does not address an  important problem inherent in the cone - based jet reconstruction .",
    "this problem manifests itself as the pattern recognition ambiguity illustrated in figure  [ split ] .",
    "= 2.0 in    two energy deposits of similar magnitude separated by a distance larger than @xmath17 but smaller than @xmath18 produce three stable cone centers whose positions are shown with the arrows at the bottom of the figure . in various implementations of cone - based jet reconstruction procedures ,",
    "this problem is usually addressed by the `` split - merge '' stage which happens after the stable cone locations are determined . during this stage ,",
    "jets are merged if the energy which falls into the common region exceeds a  predefined fraction of the energy of the jet with smaller magnitude . even if the search for stable cones is performed in the infrared and collinear safe manner ,",
    "the outcome of the split - merge stage is often unstable because the decision on whether to merge the two jets depends on the minute details of the energy deposition structure .",
    "another way to look at this problem and a possible solution is illustrated in figure  [ trouble ] .",
    "= 5.5 in    the third stable cone center between the two energy deposits happens because the sum of two epanechnikov kernels placed at the locations of the deposits has a spurious peak in the middle .",
    "however , there is a variety of kernels which do not suffer from this problem . in particular ,",
    "the gaussian kernel produces either two ( narrow kernel ) or one ( wide kernel ) peaks , as shown .",
    "even though one still has to address the question of choosing the kernel width , the gaussian kernel has a very important advantage : the whole split - merge stage is no longer necessary .",
    "an intelligent choice of the kernel width ( or the @xmath17 parameter in the and cone algorithms ) can not be performed until some assumptions are made about the expected jet shapes .",
    "in fact , optimal choice will be different for different signals .",
    "for example , a data analysis which searches for high energy dijet events with two well - separated jets is likely to make very different assumptions about jets from a  data analysis which looks for @xmath19 events in the all - hadronic , 6-jet mode .",
    "moreover , the optimal width is not necessarily the same for every jet in an event , as low momentum jets tend to have wider angular profiles , especially in the presence of magnetic field . because of this",
    ", it is interesting to look at the jet structure of an event using a variety of kernel width ( cone radius , _ etc .",
    "_ ) choices . in the limit of continuous kernel width",
    "we arrive to a description of event energy flow known as `` mode tree '' in the nonparametric statistics literature or `` scale - space image representation '' in the computer vision theory .",
    "the information contained in such a description permits multiple optimization strategies for jet reconstruction which will be discussed in section  [ sec : strategies ] .",
    "the fftjet approach differs significantly from the majority of jet reconstruction algorithms in the following way : no attempt is made to define outright what is a jet and how particle jets should look like .",
    "instead , the _ package user _ introduces an operational jet definition by selecting the pattern recognition kernel and the jet membership function which describes the jet shape . given this definition ,",
    "the code efficiently searches for jet - like structures in the event energy flow pattern .",
    "the rationale for this view of jet reconstruction comes from the realization that , in practice , there is no single optimal jet definition for different particle processes . also , the instrumental effects ( nonlinear response and finite energy resolution of the calorimeter , presence of the magnetic field in the detector , material in front of the calorimeter , pile - up , noise , _ etc .",
    "_ ) must be taken into account , and will almost surely dominate the systematic error of any precision measurement based on jets . therefore , a  unified algorithmic definition of `` what is a jet '' can not be achieved across different measurements in a variety of experimental setups .",
    "the users of the fftjet package are expected to reconstruct jets using the following sequence of steps :    1 .",
    "the event energy flow is discretized using a grid in the @xmath1 .",
    "the discretized energy distribution is convolved with a kernel function @xmath20 , where @xmath21 is the resolution scale parameter which determines the width and , possibly , the shape of the kernel .",
    "many standard kernel functions are included in the fftjet package , and user - defined kernels can be seamlessly added as well .",
    "the convolution is performed by dfft .",
    "3 .   the peaks of the convolved energy distributions are found .",
    "these are potential `` preclusters '' .",
    "preclusters with small magnitudes are eliminated in order to suppress the calorimeter noise .",
    "steps 2 through 4 are repeated as many times as necessary using different values of @xmath21 .",
    "the resulting preclusters are arranged in the `` clustering tree '' structure .",
    "6 .   using the clustering tree information and assumptions about the signal spectrum",
    ", a  decision is made about the event topology by choosing a set of preclusters .",
    "these preclusters are passed to the jet energy reconstruction stage .",
    "jet constituents are determined as follows .",
    "the event is viewed as a  collection of energy deposits characterized by their direction @xmath22 and energy variable @xmath15 .",
    "depending on the environment in which the code is used , these deposits can originate from detector calorimeter cells , reconstructed tracks , monte carlo particles , _ etc . _",
    "a  cluster membership function @xmath23 is associated with each precluster @xmath24 at angular coordinates @xmath25 and scale @xmath26 .",
    "there is also a  membership function for the unclustered energy / underlying event .",
    "the cluster membership functions are evaluated for every energy deposit in the event . in the `` crisp '' clustering scenario ,",
    "an energy deposit is assigned to the jet whose membership function for this deposit is the largest . in the `` fuzzy '' scenario , the deposit is split between all jets with weights proportional to their respective membership function values ( the sum of all weights is normalized to 1 to ensure energy conservation ) .",
    "jet energies are calculated according to one of the standard recombination schemes using weights determined in the previous step .",
    "this sequence will work well for a wide variety of hep data analyses . yet",
    ", if necessary , the balance between the code speed and the precision of jet energy determination can be shifted in either direction .",
    "for example , to speed things up , the pattern recognition can be performed at a  single predefined scale @xmath27 .",
    "alternatively , to further improve the jet energy resolution , the last two steps of the algorithm can be applied iteratively . in such a procedure , the jet directions @xmath25 and the membership function scales @xmath26 are updated at each iteration using reconstructed jets from the previous iteration until some convergence criterion is satisfied .",
    "the fftjet package is designed with the goals of flexibility and extensibility in mind .",
    "the code is written in the standard c++ programming language .",
    "most of the fftjet classes are either templates or they inherit from abstract base classes .",
    "this freedom of choice allows the user to tailor fftjet easily to the needs of a  particular data analysis and software environment , but it can also be daunting at the beginning . the intent of this section is to provide helpful guidelines for making important decisions about algorithm details and to explain how these details may affect the algorithm performance .",
    "the purpose of the energy discretization step is to create a grid equidistant in the and to populate this grid with the observed energy values .",
    "several typical use cases are envisioned :    * the analysis is using calorimeter data collected by an experiment ( or any other data with intrinsic granularity ) . in this case the cell sizes in @xmath3 and @xmath2 should be chosen in such a way that they reflect the spacing of the calorimeter towers . at the same time , the number of bins should allow for subsequent efficient dfft of the gridded data , so that exact powers of two are preferred . in case",
    "the calorimeter granularity is not constant throughout the full @xmath3 acceptance range or if the calorimeter towers are not rectangular , the fftjet package includes regridding facilities which can aid in mapping the data onto rectangular equidistant grid with minimal loss of information . *",
    "the event energy flow representation includes tracking data obtained by particle flow analysis or by other similar means . in this case",
    "the grid is filled in a manner which preserves the @xmath3-@xmath2 centroid of each energy deposit .",
    "the grid size should be chosen in such a way that the binning effects do not prevent the user from seeing the smallest interesting detail . a good rule of thumb ( based on the nyquist sampling theorem )",
    "is that in each direction the discretization grid granularity should be two times finer than the typical size of such a detail .",
    "* monte carlo particle data are analyzed , and the user wants to simulate binning effects of a realistic calorimeter . in this case the fftjet gridding code can function as a histogram with cylindrical topology",
    ".      pattern recognition is performed in fftjet by convolving the discretized event energy flow with a kernel function and then finding the peaks of the obtained smoothed energy distribution .",
    "peak coordinates are determined with subcell precision : the smoothed energy flow shape is fitted in a @xmath28 rectangle near each local maximum with a two - dimensional quadratic polynomial by least squares method .",
    "the location of the polynomial maximum is then used as the peak position or the peak is discarded if the hessian matrix of the fitted polynomial is not negative definite .    the optimal choice of the pattern recognition kernel will depend on the analysis strategy and the amount of information the user has about the signal and the background at the time pattern recognition is performed . the typical role which kernel plays",
    "is that of the low - pass spatial filter in the @xmath3-@xmath2 space : it is supposed to enhance jet - like structures present in the event and it has to suppress higher spatial frequency random noise present due to fluctuations in the showering and hadronization processes , instrumental noise , _",
    "etc_. if signal and background properties are well understood , the filter can be designed to provide optimal pattern recognition for the process of interest ( wiener filtering  @xcite ) .",
    "this , however , is not a  typical usage for a jet clustering algorithm in a hep experiment .",
    "instead , it is often more desirable to cluster jets in a generic manner consistent with a  wide variety of signal and background hypotheses .",
    "the fftjet package can aid the user in implementing several different pattern recognition strategies .",
    "a fast and efficient jet finding can be performed at a  single resolution scale ( which is similar to using jets reconstructed at one cone radius ) . here",
    ", a proper kernel choice allows not only to avoid the split - merge stage but also to take into account the nonsymmetrical jet shape in the presence of a  magnetic field .",
    "indeed , at sufficiently high values of transverse momenta ( above @xmath29  gev/@xmath30 or so ) the width of the transverse jet energy profile scales inversely proportional to jet @xmath31 . at the same time",
    ", the angular distance between the direction of the jet axis and the location where charged particles hit the calorimeter in the magnetic field also scales in the inverse proportion to particle s @xmath32 is inversely proportional to particle s radius of gyration and , therefore , inversely proportional to particle s @xmath31 as well . ]",
    "this leads to a  situation in which the jets have a  characteristic @xmath3 to @xmath2 width ratio which remains stable through a  wide range of jet energies .",
    "modern hep experiments often employ cone and algorithms for jet reconstruction using several different values of the @xmath17 parameter which determines characteristic jet width .",
    "the fftjet package takes this strategy to its logical conclusion and allows the user to view the energy flow in the event as a collection of jet structures reconstructed using a continuous range of angular resolution scales . in order to locate patterns which correspond to actual physics processes in this `` scale space '' view of jet reconstruction",
    ", it becomes essential to establish hierarchical relationships between structures found at larger and smaller scales .",
    "if we want to establish these relationships in a  meaningful way , the number of jets found should decrease when the resolution scale increases .",
    "this places an  important technical requirement on the kernel or sequence of kernels used at different scales : the number of peaks found after convolving the kernel with the event energy structure should decrease with increasing scale , no matter how the event energy flow looks like .",
    "it turns out that , in the form stated above , this requirement is very strict .",
    "it is not known at this time whether such a kernel or a sequence of kernels can actually be constructed .",
    "nevertheless , the gaussian kernel comes very close to fulfilling this requirement for all practical purposes . in general , an optimal choice of a pattern recognition kernel should result both in good local properties of the reconstructed jets ( robustness with respect to small variations in jet energy flow and resistance to noise ) and in good scaling properties : the event topology should vary naturally in the scale space .    perhaps , the most useful general - purpose multiresolution kernel implemented in the fftjet package is the gaussian kernel corrected for the energy flow discretization effects .",
    "this kernel is the green s function of the two - dimensional anisotropic diffusion equation with the discretized laplacian operator ( the rationale for this approach and the formula for the isotropic diffusion case is given in @xcite ) . unlike the standard gaussian kernel which is strongly affected by binning effects when its width becomes comparable to the grid bin size , the corrected kernel behaves meaningfully at small scales , and gracefully converges to the discrete delta function at the zero scale limit .",
    "the kernel is defined by its fourier transform representation : @xmath33 where    @xmath34 , @xmath35 is the @xmath3 frequency .",
    "@xmath36 , @xmath37 is the @xmath2 frequency .",
    "@xmath38 is the _ effective _ width of the grid cells in @xmath3 ( scaled so that the full @xmath3 range of the grid is @xmath39 ) .",
    "@xmath40 is the width of the grid cells in @xmath2 .",
    "@xmath41 is the _ effective _ kernel width parameter in @xmath3 . in the limit of small cell sizes and",
    "when @xmath42 , it corresponds to the standard deviation of the gaussian kernel .",
    "@xmath43 is the kernel width parameter in @xmath2 .",
    "in addition to its excellent performance in the multiresolution context , the gaussian kernel has another useful feature . for",
    "well - separated , symmetric jets the peak magnitude dependence on the resolution scale , @xmath44 , is the laplace transform of the transverse energy profile . to @xmath2 width ratio makes it a good approximation even in the presence of a strong magnetic field . ] therefore , a reasonable estimate of the jet transverse energy can be obtained from @xmath45 where @xmath46 is a proper normalization constant which depends on the binning of the energy discretization grid . with the parameter @xmath47 , and then extrapolate towards @xmath48 . ]",
    "this initial estimate can be used by the energy recombination stage of the algorithm .",
    "the clustering tree represents the agglomeration of peaks ( preclusters ) found by multiresolution spatial filtering into a single hierarchical structure .",
    "the tree is constructed using a distance function .",
    "a precluster found at some resolution scale @xmath49 is assigned a parent from the previous ( larger ) resolution scale @xmath50 as follows : the distance between the precluster at the scale @xmath49 is calculated to all preclusters at the scale @xmath50 .",
    "the precluster at the scale @xmath50 with the smallest such distance becomes the parent .",
    "this simple agglomeration strategy follows the approach of ref .",
    "@xcite and has the advantage that the obtained tree structure can also be utilized as a balltree  @xcite .",
    "other agglomeration strategies are possible  ( see @xcite and references therein ) and may be implemented in the future fftjet releases .    the choice of the function which defines the distance between the preclusters is up to the user of the package .",
    "the implementation must at least ensure that the distance can never be negative , the distance from any precluster to itself is zero , the distance is symmetric for preclusters found at the same resolution scale , and that the triangle inequality is satisfied for any three preclusters .",
    "the package itself provides one such distance function defined as @xmath51 , independent from peak magnitudes and resolution scales used .",
    "the bandwidth values @xmath52 and @xmath53 are typically chosen so that @xmath54 and @xmath55 , and then @xmath56 is the only parameter needed to define the distance function .    once the parent / daughter relationships are established between preclusters found at different resolution scales , dependence of various precluster characteristics on the scale parameter",
    "can be analyzed . by default",
    ", fftjet calculates the following precluster properties :    * the speed with which the peak magnitude changes as the function of scale .",
    "this is an approximate value of @xmath57 . * the speed with which the precluster location drifts in the scale space .",
    "if the distance between precluster is defined by the angular distance @xmath58 described above , this becomes @xmath59 , with @xmath60 . *",
    "precluster lifetime in the scale space .",
    "it is computed as @xmath61 where @xmath62 and @xmath63 define the range of resolution scales for which the precluster exists as a  distinct feature of the energy distribution .",
    "typically , the lifetime is traced from the smallest scale in the clustering tree to the scale where the precluster becomes a part of a  larger precluster .",
    "if the tree is constructed using a pattern recognition kernel which generates spurious preclusters , this quantity can be used for trimming such preclusters .",
    "* distance to the nearest neighbor precluster at the same resolution scale .",
    "together with the precluster locations , scales , and peak magnitudes , these quantities are collected in a single class which describes precluster properties in fftjet .",
    "each node of the clustering tree is associated with one object of this class .",
    "the fftjet package contains facilities for visualizing clustering trees with the opendx scientific visualization system  @xcite .",
    "various precluster properties can be mapped into the size and color of opendx glyphs , while the precluster location in the and the precluster resolution scale are mapped into the glyph coordinates in a three - dimensional scene .",
    "an  opendx view of a  clustering tree is shown in figure  [ opendxexample ] . on a computer screen , this view can be interactively shifted , scaled , and rotated with a virtual trackball .",
    "= 5.3 in      to determine the event topology , the user must introduce some assumptions about the signal properties .",
    "the clustering tree functionality allows for an efficient implementation of a  variety of pattern recognition strategies tuned to locate precluster patterns consistent with the properties of the expected signal .",
    "a  few possible strategies are listed below .",
    "* the traditional approach consists in choosing the single best resolution scale according to some optimization criterion .",
    "for example , the fraction of events in which the number of reconstructed jets equals the number of partons produced at the leading order perturbation theory is maximized for the signal of interest . in the multiscale reconstruction paradigm",
    ", this approach can be improved upon by avoiding situations in which the chosen resolution scale is close to a bifurcation point  the scale at which two smaller preclusters form a bigger one . near the bifurcation point",
    "the locations of the affected preclusters become very sensitive to small changes in the event energy flow .",
    "this problem results in an increased uncertainty of jet energy and direction determination .",
    "the bifurcation points can be avoided by detecting them in the scale space with the clustering tree , and by using slightly modified resolution scales in case such points are found . * for each event , one can choose a scale for which the number of clusters , @xmath8 , corresponds to the number of jets expected in the signal . in order to make sure that this jet configuration indeed represents a salient feature of the event energy flow , some characterization of the configuration stability must be provided .",
    "this stability can be described by the configuration `` lifetime '' in the scale space .",
    "a reasonable lifetime function is @xmath64 , where @xmath65 and @xmath66 are , respectively , the maximum and the minimum resolution scales for which the tree has exactly @xmath8 clusters .",
    "then the appropriate lifetime function should also depend on @xmath8 .",
    "for example , @xmath67 could be a good choice , with @xmath68 chosen empirically depending on the process under study ( @xmath69 ) .",
    "more complicated , powerful definition of the lifetime in the scale space is proposed in  @xcite . ] * scale - space differential blob detectors  @xcite can potentially be used to identify jets .",
    "* nontrivial clustering patterns are identified in the signal , and similar patterns are searched for in the clustering tree .",
    "for example , boosted resonances , such as @xmath11 bosons or top quarks , are expected to produce one wide jet at higher resolution scales which has a  prominent substructure at lower scales . *",
    "the scale is chosen separately for each jet , in a manner consistent with the expected event topology .",
    "for example , if the cluster does not split across a range of scales and its position in the remains stable , it will be advantageous to use a  @xmath70-dependent jet shape model for energy determination .",
    "the name `` membership function '' is borrowed from the fuzzy sets theory  @xcite .",
    "the fftjet membership functions serve a similar purpose : they reflect the probabilities of energy deposits to belong to jets .",
    "however , the range of fftjet membership function values is not limited to the interval [ 0 , 1 ] , instead any non - negative real value is allowed .",
    "the jet membership functions employed by fftjet have a continuous scale parameter which will be called `` recombination scale '' for the remainder of this paper .",
    "a membership function is associated with each precluster @xmath24 located at angular coordinates @xmath25 : @xmath23 . here , @xmath15 is the magnitude of the transverse energy ( or momentum ) of the energy deposit located at angular coordinates @xmath22 .",
    "the recombination scale @xmath26 may or may not coincide with the precluster resolution scale .",
    "defined in this manner , the membership function is invariant with respect to shifts in the @xmath3 and @xmath2 coordinates but not with respect to changing the recombination scale or permuting the jets .",
    "the noise / unclustered energy membership function @xmath71 has no characteristic scale .",
    "two recombination modes are supported by the fftjet code : `` crisp '' and `` fuzzy . '' in the `` crisp '' mode , each energy deposit is assigned to the jet ( or noise / unclustered energy ) whose membership function value evaluated for that deposit is the highest . in the `` fuzzy '' mode ,",
    "each energy deposit is distributed among all jets and the unclustered energy with weights calculated for jet number @xmath24 as @xmath72 and for the noise / unclustered energy as @xmath73 the weights calculated in this manner are normalized  by @xmath74 for each @xmath3 , @xmath2 which ensures that energy and momentum can be conserved during the recombination procedure .",
    "the choice of the jet membership function and the recombination mode is up to the user of the package .",
    "it is expected that the most precise determination of jet energies will be achieved by using detailed jet shape models which will be called `` detector - level jet fragmentation functions '' . such jet models are defined by @xmath75 where @xmath5 is the number of energy discretization grid cells into which a jet deposits its energy , @xmath70 is the actual jet @xmath70 , the jet direction is shifted to @xmath76 , and angular brackets stand for averaging over a  large number of jets .",
    "it is natural in this case to set the recombination scale @xmath21 to @xmath77 .",
    "the functions @xmath78 defined in this manner are normalized  by @xmath79 and @xmath80 it is unlikely that in practice one will be able to represent these jet models by simple parametrized functional expressions .",
    "fftjet provides a solution to this problem in the form of multidimensional interpolation tables .",
    "construction and serialization of such tables is discussed in the fftjet package user manual  @xcite .    within the fftjet framework it is possible to associate different jet membership functions with different preclusters ,",
    "so the user can take advantage of even more detailed jet models which can depend , for example , on the assumed jet flavor , electromagnetic energy fraction , separation from other jets , _ etc . _ on the other hand , simpler models will be less susceptible to systematic errors and model misspecifications , and can potentially result in simplified calibration procedures .",
    "for example , the recombination behavior of the cone algorithm can be reproduced within fftjet by using crisp clustering with the epanechnikov kernel used as the jet membership function .",
    "note that in this case the membership function is not unique : in the crisp mode identical jets will be generated by any membership function which depends only on @xmath81 and which decreases monotonically from a positive value when @xmath82 to zero when @xmath83 . for use with the cone - like algorithm ,",
    "it is sufficient to specify @xmath84 , where @xmath85 is a very small positive constant .    within fftjet",
    ", energy resolution performance of the cone algorithm can be easily improved upon in two ways : by introducing different bandwidth values for @xmath3 and @xmath2 variables ( as illustrated in section  [ sec : perf ] of this paper ) , and by choosing the @xmath17 parameter separately for each jet , in a manner consistent with the event topology discovered during the pattern recognition stage .",
    "it may also be interesting to apply cone - like recombination stage iteratively , using a  procedure in which the cone radius for the next iteration depends on the jet @xmath70 determined during the previous iteration .",
    "( @xmath68 must be negative to ensure convergence ) .",
    "the optimal choice of @xmath68 will depend on the balance of uncertainties due to event occupancy , calorimeter noise and energy resolution , pileup , out - of - cone leakage , _ etc . _",
    "the simple choice of @xmath86 can be advocated on the basis of kinematic arguments alone  @xcite . ]      at the time of this writing , three energy recombination schemes are supported by fftjet code .",
    "the first two are straightforward weighted modifications of the schemes commonly employed at the hadron collider experiments .",
    "the third one sets the jet direction to the precluster direction",
    ". the latter definition can potentially be useful for high occupancy / high noise events or when pattern recognition is performed with filters optimized for some specific signal and background processes .",
    "1 .   weighted 4-vector recombination scheme ( often called @xmath87-scheme ) : @xmath88 where @xmath89 is the 4-vector associated with the energy deposit at @xmath22 . for `` crisp '' clustering ,",
    "all weights @xmath90 for jet number @xmath24 are either 0 or 1 . 2 .   weighted original snowmass scheme (",
    "also called @xmath91 or @xmath70 centroid scheme ) : @xmath92 @xmath93 the variable @xmath15 is chosen by the user .",
    "normally , this should be either @xmath94 ( if @xmath3 represents pseudorapidity ) or @xmath70 ( if @xmath3 represents rapidity ) .",
    "@xmath95 is defined as @xmath96 moved to the interval from @xmath97 to @xmath98 .",
    "this recombination scheme can potentially outperform the 4-vector scheme when jets are reconstructed using calorimeter towers , and a strong magnetic field is present in the detector .",
    "precluster direction scheme : @xmath99    the energy recombination step can be performed using as input either a  collection of 4-vectors or the discretized energy flow in the .",
    "the latter approach may be convenient for reconstructing jets from calorimeter data .",
    "the details of the algorithm mapping into c++ classes and the user api are described in the fftjet package user manual distributed together with the code  @xcite .",
    "the package comes with several top - level driver classes which combine multiple steps of the algorithm into convenient api units .",
    "example executables are provided .",
    "these examples illustrate package usage with both single - scale and multiresolution pattern recognition stages .",
    "this section illustrates fftjet performance with a cone - like , easy to calibrate jet model and a simple synthetic dataset .",
    "it is assumed that jets are reconstructed with a projective geometry calorimeter placed in a 3.8  t magnetic field .",
    "the width of each calorimeter tower in @xmath3 and @xmath2 is taken to be @xmath100 .",
    "two distinct , independent light quark jets per event are generated using pythia  6.4  @xcite single jet gun , using default pythia tune .",
    "the @xmath70 of the first jet is fixed at 50 gev/@xmath30 and its direction is randomized across the face of one of the calorimeter towers near @xmath101 .",
    "the second jet is directed inside a circle around the first jet in such a manner that the distribution of @xmath102 is flat and the orientation of the @xmath103 vector is uniform and random .",
    "the @xmath70 spectrum of the second jet is flat between 1  and 100  gev/@xmath30 .",
    "the 4-momenta of these jets are defined as the sum of the 4-momenta of all stable particles within the jet except neutrinos .",
    "stable charged particles are propagated along helical trajectories to the assumed calorimeter radius of 2.0  m , while the neutral particles fly straight .",
    "the energies are accumulated for each tower separately .",
    "neutrinos and the charged particles which do not have enough transverse momentum to reach the calorimeter do not contribute .",
    "the shower development in the calorimeter is not modeled .",
    "the calorimeter is assumed to have ideal energy response and a  noise of @xmath104  gev per tower .",
    "the tower threshold of @xmath105 is applied before the jet reconstruction is performed . in this virtual setup , the calorimeter granularity , noise , magnetic field , and tower threshold are not far from the values actually used in real particle detectors , while the ideal energy response permits characterization of the jet energy resolution performance of different algorithms without having to disentangle the detector effects .",
    "the jet reconstruction algorithms compared are :    * _ fftjet-1 _ : the fftjet package is configured to use a single - scale pattern recognition stage .",
    "the pattern recognition kernel is the gaussian kernel corrected for the energy flow discretization effects , as described in section  [ sec : patker ] .",
    "the parameter @xmath41 is set to 0.1 , @xmath43 is set to 0.3 , the peak magnitude cutoff is 0.4 .",
    "crisp clustering is used , with jet membership function represented by the elliptical cone : @xmath106 with @xmath107 and @xmath108 .",
    "the area of the base of such a  cone is the same as the area of the circle with @xmath109 . in this configuration ,",
    "the jet membership function has no dependence on @xmath15 , @xmath21 , or jet number .",
    "the background membership function is a small constant . *",
    "_ siscone _ : the siscone algorithm  @xcite is configured with @xmath109 , the minimal @xmath70 for protojets 0.5  gev/@xmath30 , and unlimited number of passes .",
    "the overlap parameter for the split - merge stage is set to 0.75 .",
    "the standalone algorithm implementation is used  @xcite .",
    "* @xmath110 : the algorithm is used with @xmath109 and minimal @xmath70 for protojets 0.5  gev/@xmath30 . * _ anti_-@xmath110 : the anti - algorithm  @xcite is used with @xmath109 and minimal @xmath70 for protojets 0.5  gev/@xmath30 . both and anti- algorithms implementations are taken from the fastjet package  @xcite .",
    "the 4-vector recombination scheme is used with all algorithms .",
    "similar jet size parameters are chosen so that the conclusions of this study are not expected to change with the inclusion of uncertainty contributions from the calorimeter energy resolution and pileup .",
    "figures  [ fig : eff ] and  [ fig : uncert ] compare the event reconstruction efficiencies and the relative @xmath70 reconstruction uncertainties for these algorithms .",
    "these characteristics are presented as functions of @xmath111 between the two generated jets and the generated transverse momentum of the second jet , @xmath112 ( flat spectra in @xmath111 and @xmath112 were chosen precisely in order to simplify construction and interpretation of these plots ) . on average , @xmath113 events",
    "were generated per each @xmath114 bin plotted .",
    "to determine the efficiency , the reconstructed jets are matched to the generated jets in the @xmath1 .",
    "first , the pair of jets with the smallest value of @xmath115 is determined and removed from subsequent consideration .",
    "then the best match is determined for the remaining generated jet .",
    "the efficiency is defined as the fraction of events in which both @xmath116 values are below 0.3 .",
    "@xmath117    the relative @xmath70 reconstruction uncertainty is defined as the width of the @xmath118 distribution in each @xmath114 bin ( using only events which satisfy the @xmath119 requirement ) , where @xmath120 is the transverse momentum of the reconstructed jet matched to the second generated jet .",
    "the width is calculated as one half of the difference between 84.13@xmath121 and 15.87@xmath121 percentiles . for the gaussian distribution ,",
    "this robust estimate of the width coincides with the standard deviation .",
    "the distributions are corrected in each bin so that the median is exactly 1 ( _ i.e. _ , @xmath120 values are multiplied by a constant calculated separately for each bin ) . in the plots ,",
    "the width estimate is shown only for the bins for which the reconstruction efficiency defined in the above manner exceeds 50% ( at lower efficiencies the width is dominated by mismatched jets ) .",
    "@xmath122    figure  [ fig : uncertrat ] presents the uncertainty ratios in which the relative @xmath70 reconstruction uncertainties for different algorithms are in the numerator and the _ fftjet-1 _",
    "uncertainty is in the denominator .",
    "the division is performed bin - by - bin , and the result is set to zero if either the numerator efficiency or the denominator efficiency for that bin is less than 50% .",
    "@xmath123    median uncertainty ratios ( using non - zero bins only ) are listed in table  [ table : recoresults ] .",
    "the table also shows the average fake rate which is defined for the purpose of this study as the fraction of events which have a reconstructed jet with @xmath124  gev/@xmath30 not matched to a generated jet ( _ i.e. _ , there are two other reconstructed jets which produce better matches ) .",
    ".summary of the results within the @xmath125 and @xmath126  gev/@xmath30 limits .",
    "these numbers can be viewed as an  approximate guide for ordering jet algorithms according to their performance in a  strong magnetic field . [",
    "cols=\"^,^,^,^,^\",options=\"header \" , ]     due to a more appropriate jet shape model ( elliptical instead of circular ) , _ fftjet-1 _ outperforms all other algorithms used in this study by a  significant margin .",
    "the intrinsic jet @xmath70 resolution uncertainties of other algorithms are larger than the _ fftjet-1 _",
    "uncertainty by @xmath12730% .",
    "it is clear from fig .",
    "[ fig : eff ] that the _ siscone _ algorithm performance is significantly hampered by the split - merge stage which creates a  complicated efficiency dependence on @xmath111 and @xmath112 and results in a reduced efficiency overall . because of this problem , _",
    "siscone _ can not be recommended for reconstructing multijet , high occupancy events .",
    "it can also be argued that , compared to and _ anti_-@xmath1 , the efficiency pattern exhibited by _",
    "fftjet-1 _ can potentially be more useful .",
    "_ fftjet-1 _ remains efficient at smaller @xmath111 values instead of the low @xmath112 region where reliable jet reconstruction is prevented by poor jet @xmath70 resolution .",
    "the author thanks the jet algorithms group of the cms collaboration for comments and discussions . the development of the fftjet package was supported in part by the us department of energy grant de - fg02 - 95er40938 ."
  ],
  "abstract_text": [
    "<S> this article describes the fftjet software package designed to perform jet reconstruction in the analysis of high energy physics ( hep ) experimental data . </S>",
    "<S> a  two - stage approach is adopted in which pattern recognition is performed first , utilizing multiresolution filtering techniques in the frequency domain . </S>",
    "<S> jet energy reconstruction follows , conditional upon the choice of signal topology . </S>",
    "<S> the method is efficient , global , collinear and infrared safe , and allows the user to identify and avoid the event topology bifurcation points when energy reconstruction is performed .    </S>",
    "<S> jet algorithms , fft , multiresolution , fuzzy clustering 13.87.-a , 29.85.-c    * program summary *    _ authors : _ </S>",
    "<S> i.  volobouev + _ program title : _ fftjet + _ program url : _ http://projects.hepforge.org/fftjet/ + _ journal reference : _ </S>",
    "<S> + _ catalogue identifier : _ + _ licensing provisions : _ mit license + _ programming language : _ c++ + _ </S>",
    "<S> computer : _ any computer with a modern c++ compiler + _ operating system : _ unix , linux + _ classification : _ </S>",
    "<S> 11.9 + _ external routines / libraries : _ fftw , opendx ( optional ) + _ nature of problem : _ particle jet reconstruction in high energy physics collider data + _ solution method : _ the task is split into two distinct stages : pattern recognition and jet energy reconstruction . </S>",
    "<S> multiresolution filtering techniques in the fourier domain are utilized at the pattern recognition stage . </S>",
    "<S> energy reconstruction is accomplished using weights generated by cluster membership functions . both crisp and fuzzy </S>",
    "<S> clustering is supported . </S>",
    "<S> + _ running time : _ variable , depends on the event occupancy and algorithm used . </S>"
  ]
}