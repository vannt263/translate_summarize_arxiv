{
  "article_text": [
    "distribution of entanglement is an essential task in quantum communication  @xcite .",
    "entanglement can be used to make highly secure communication channels due to the sensitivity of entangled quantum systems to external influences  @xcite .",
    "while this sensitivity makes it possible to detect any attack from an eavesdropper , it also makes it hard to distribute entanglement over large distances since any noise from the enviroment quickly destroyes the entanglement .",
    "direct transmission of a quantum signal suffers from loss and decoherence from the transmission channel , which results in an exponential decrease of the rate with distance  @xcite . to overcome this problem ,",
    "it has been proposed to use quantum repeaters , where entanglement is first created over short distances by direct transmission and then stored in quantum memories until it can be swapped to larger distances  @xcite ( see fig .  [",
    "fig : figure1 ] ) .",
    "much effort has been devoted to the construction of quantum repeaters based on atomic ensembles , where the large number of atoms , in principle , enables highly efficient quantum memories  @xcite . nonetheless , the limited efficiencies demonstrated in current experiments with atomic ensembles  @xcite prevents the construction of a practical quantum repeater based on currently existing setups .",
    "single emitter systems such as color centers and trapped ions have also been considered for quantum repeaters  @xcite .",
    "the long coherence times demonstrated with , e.g. trapped ions make them desirable as quantum memories .",
    "nonetheless , entanglement needs to be created non - locally between two memories in the initial step of a repeater .",
    "this requires efficient transfer of information from the quantum memories onto light in the form of single photons . to this end",
    ", it is an advantage to place the emitter inside a cavity , which can greatly enhance the light - emitter coupling  @xcite .",
    "entanglement swapping can then be performed with a cavity mediated cnot gate  @xcite but in this case , the detrimental effect of cavity loss and spontaneous emission from the emitters may prevent obtaining efficient entanglement swapping .",
    "the parameter characterizing the effect of dissipation in the emitter - cavity system is the cooperativity , @xmath1 .",
    "it has been argued that a direct implementation of gates in a cavity will make the gate fidelity , @xmath2 , have a poor scaling of @xmath3 @xcite . to overcome this problem for current cavities with limited @xmath1 , it has been suggested to employ entanglement purification after each swap operation to boost the entanglement but this either requires a large number of resources or a time consuming sequential generation of purification pairs  @xcite .",
    "here we analyze and compare a number of cavity - based quantum repeaters which combines various proposals for entanglement generation and cavity - assisted cnot gates .",
    "we find that the best scheme is where high - fidelity entanglement is generated using a two - photon detection scheme similar to ref .",
    "@xcite and swapped to large distances using the heralded cz - gate proposed in ref .",
    "the heralded gate enables nearly perfect entanglement swapping when successful allowing for many swaps without the need of entanglement purification . as a result",
    ", high - rate entanglement distribution is achieved even for low cooperativities .",
    "compared to the other cavity - based repeaters , this high - fidelity repeater achieves up to two orders of magnitude higher secret key rate ( see below ) for realistic parameters and large distances ( @xmath0 km ) .",
    "specifically , we have compared to repeaters where entanglement is generated using a single - photon detection scheme similar to ref .",
    "@xcite , which allows for a better rate at the expense of fidelity .",
    "furthermore we have considered schemes where entanglement swapping is achieved using the deterministic cnot gate suggested in ref .",
    "@xcite , combining it with the local entanglement generation scheme of ref .",
    "the advantage of this gate is that the fidelity scales as @xmath4 , which is a significant improvement of the @xmath5 scaling characterizing the performance of a direct implementation of gates in a cavity . as a result",
    ", long - distance entanglement distribution can also be achieved with this gate but it requires cooperativities above @xmath6 , which might be challenging to achieve experimentally .",
    "furthermore , we include the possibility of initial purification in repeaters based on the single - photon detection scheme in order to allow for the higher rate of this scheme to compensate for the lower fidelity compared to the two - photon detection scheme .",
    "to reflect a realistic near - term approach to quantum repeaters , we only consider scenarios with 2 or 4 qubits per repeater station .",
    "for the same reason , we also do not consider the possibility of intermediate entanglement purification .",
    "here , initial purification refers to purification in the elementary links ( see fig .  [",
    "fig : figure1 ] ) while intermediate purification refers to purification in the subsequent stages of a repeater .",
    "we have numerically optimized all the considered repeater schemes for a range of cooperativities and distances to find the highest achievable secret key rate ( see below ) .",
    "note that a similar optimization of repeater schemes based on dynamical programming was described in ref .",
    "@xcite . in that work ,",
    "both initial and intermediate entanglement purification was considered assuming high - fidelity operations .",
    "our optimization is less detailed since we do not consider intermediate purification . on the other hand ,",
    "we include how the errors of the operations depend on the physical parameters such as the cooperativity and investigate concrete physical implementations . finally , we compare the high - fidelity repeater considered here to both an ion - trap repeater and one of the best repeaters based on atomic ensembles  @xcite . for a distance of 1000 km ,",
    "the high - fidelity repeater outperforms both of these schemes for @xmath7 .",
    "we will first describe the details of the high - fidelity quantum repeater , which we find to have the best performance and later discuss and compare with the various other schemes .",
    "the first step in any quantum repeater is to create non - local entanglement in the elementary links ( see fig .  [",
    "fig : figure1 ] ) .",
    "connected by repeater stations pictured as cavities containing single emitters . after creating entanglement in the elementary links the entanglement",
    "is swapped to larger distances by combining the elementary links .",
    "the numbers to the right in the figure refers to the swap level of the repeater . in the first swap level , the four elementary links are connected pairwise to make two longer links . in the second swap levels",
    "these two links are connected to create entanglement over the total distance .",
    "the total number of swap levels is thus 2 for this depicted setup .",
    ", width=288,height=144 ]    to this end , a two - photon detection scheme , as proposed in ref .",
    "@xcite , is considered .",
    "the basic setup is shown in fig .",
    "[ fig : figure2](a ) .     denotes the cavity coupling .",
    "for the two - photon scheme the levels @xmath8 and @xmath9 are assumed to have equal coupling of @xmath10 to the excited state @xmath11.,scaledwidth=50.0% ]    both emitters are initially prepared in the excited state @xmath11 by a strong excitation pulse and the cavity is assumed to couple both the @xmath12 and @xmath13 transitions with equal coupling strength @xmath10 ( see fig .  [",
    "fig : figure2](b ) ) .",
    "the two transitions are , however , assumed to produce photons with different polarizations such that the emission of a cavity photon creates an entangled state between the photon and the emitter of the form @xmath14 where @xmath15 ( @xmath16 ) is the single photon state with polarization 1 ( 2 ) .",
    "the probability of one of the emitters to emit a photon of either polarization through the cavity , into an optical fiber transmitting it to the detection stage during a time interval @xmath17 $ ] is @xmath18 assuming perfect outcoupling to the fiber and that the decay rate of the cavity , @xmath19 , is much larger than the cavity coupling , @xmath20 .",
    "we have here introduced the cooperativity @xmath21 , where @xmath22 is the spontaneous emission rate of the emitters into modes other than the cavity .",
    "this is the key parameter characterizing the performance of the cavity - based repeaters .",
    "the photons are sent from the cavities to a central polarizing beam splitter ( pbs ) .",
    "if two photons of the same polarizations are incident on the pbs , they leave in different output ports , while photons of different polarization leave in the same output port .",
    "the outputs are then sent to a second set of polarizing beam splitters and all four outputs of these are finally measured with single photon detectors ( spd ) .",
    "a click in a detector in each arm heralds the creation of the bell state @xmath23 between the emitters up to a local qubit rotation .",
    "neglecting dark counts of the detectors , the heralded fidelity is unity ( see app .",
    "[ two ] ) while the success probability of the scheme is @xmath24 with @xmath25 being the total detection efficiency including inefficient outcoupling of the cavity light , losses in the transmission fibers and imperfect detectors .",
    "compared to schemes based on single - photon detection ( see below ) the rate of this two - photon detection scheme decreases rapidly with decreasing @xmath25 . on the other hand it has a high fidelity , which is desirable for the subsequent stages of entanglement swapping as we will show below .    for entanglement swapping",
    "we find that the best performance is achieved using the heralded cz - gate described in ref .",
    "the gate was described in detail for @xmath26rb atoms in ref .  @xcite but it can be easily generalized to any set of emitters , which have the appropriate level structure ( see fig .  [",
    "fig : figure3 ] ) . note that the gate operation relies on only qubit state @xmath9 coupling to the cavity while the states @xmath8 and @xmath9 had equal cavity couplings in the entanglement generation scheme . to achieve this change in couplings ,",
    "the state @xmath8 should be mapped to another level in between the entanglement generation and the gate operation . for a realization with alkali atoms where the qubit states would be realized in the hyperfine grounds states , this could be achieved by applying a magnetic field to resolve the hyperfine states and applying a microwave pulse resonant with only the @xmath8 state .    in the heralded gate ,",
    "the cavity is assumed to contain two qubit atoms and one auxiliary atom to facilitate the gate .",
    "the auxiliary atom is initialized in a state @xmath27 that does not couple to the cavity and it would therefore not interfere with the entanglement generation scheme . by addressing the auxiliary atom with a weak laser pulse ,",
    "an ac stark shift is introduced , which gives a phase that depends on the state of the qubit atoms .",
    "together with single qubit rotations , this enables a cz - gate between the two qubit atoms .",
    "furthermore , the auxiliary atom can function as an error detector in the sense that any cavity decay or spontaneous emission changes the state of the atom . performing a heralding measurement of the state of the auxiliary atom at the end of the driving pulse removes all dissipative errors . as a consequence",
    ", the gate gets limited only by non - adiabatic effects . as shown in ref .",
    "@xcite , a heralded error below @xmath28 is possible with a gate time of @xmath29 , where @xmath22 is the atomic linewidth .",
    "the failure probability of the gate scales as @xmath5 and the high fidelity thus comes at the cost of a finite but possibly low failure probability .",
    "a cz gate combined with single qubit rotations is sufficient to perform direct entanglement swapping . for simplicity , we assume perfect single qubit rotations and 100% efficient measurement of atomic states for all schemes considered .",
    "relaxing this assumption will in general decrease the rate of all the considered repeater schemes but schemes with a high number of swap levels like the high - fidelity repeater will be influenced more on the rate than schemes with a low number of swap levels .",
    "the advantage of the high - fidelity repeater can be understood by considering the requirement for reaching a certain threshold fidelity , @xmath30 of the distributed pair . in this case",
    ", the maximum number of swap levels is @xmath31 , where @xmath32 are the errors of the initial entanglement generation and the entanglement swapping respectively .",
    "the combination of the high - fidelity two - photon detection scheme and the heralded gate thus makes it possible to have a repeater with many elementary links while maintaining a high fidelity of the final distributed pair even for low cooperativities since the error of the heralded gate is still high in this regime .",
    "we imagine that the distributed entanglement is used to generate a secret key between two parties referred to as alice and bob .",
    "there exist various quantum key distribution schemes @xcite , however , the general idea is that alice and bob can exclude that an eavesdropper has any information about the key by measuring their qubits and compairing results .",
    "we will assume that a six - state version of the bb84 protocol described in ref .",
    "@xcite is used to generate the secret key .",
    "this protocol consists of three main steps .",
    "first alice and bob picks a basis according to some probability distribution and measure the state of their qubits thereby producing two bit strings referred to as the _ raw key_. afterwards they compare their choice of basis and only keep the bits where they chose the same measurement basis thereby producing a _ sifted key_. finally , alice and bob estimate the information that some eavesdropper could possibly have obtained about their key and perform privacy amplification @xcite . if the errors are not too big , they can obtain a shorter but completely secure key . for the six - state protocol , the secret key rate ,",
    "@xmath33 can be defined as @xmath34 where @xmath35 is the distribution rate of the entangled pairs , @xmath36 is the probability that alice and bob choose the same measurement basis and @xmath37 is the secret key fraction , which depends on the fidelity of the distributed pairs .",
    "we assume a worst case scenario where the distributed pairs are werner states of the form @xmath38 for such states , it is shown in ref .",
    "@xcite that the secret key fraction in the six - state protocol can be estimated in the limit of infinitely long raw keys to be @xmath39 where @xmath40 and @xmath41 is the binary entropy .",
    "is valid in the limit of perfect sifting and privacy amplification , which we assume to be the case .",
    "furthermore , we assume an asymmetric version of the six state protocol , where one basis is used almost all the time such that @xmath42 @xcite . fig .",
    "[ fig : figure5 ] shows how the secret key fraction depends on the fidelity of the distributed pairs .    ) as a function of the infidelity , @xmath43 , of the final entangled pair .",
    "for @xmath44 it is no longer possible to extract a secret key from the raw keys.,scaledwidth=45.0% ]    as shown in the figure , high - fidelity pairs are required in order to have a non - vanishing secret key fraction .",
    "again this points to the high - fidelity two - photon detection scheme and the nearly error - free heralded entanglement swapping as the best choice for the repeater .",
    "the main goal of the quantum repeater is to overcome the effect of fiber losses .",
    "we model the fiber losses with a transmission efficiency @xmath45 , where @xmath46 is the length of the elementary links of the repeater and @xmath47 is the fiber attenuation length .",
    "@xmath48 enters in the total detection efficiency @xmath25 as described above .",
    "for a given resource of @xmath49 repeater stations , one can either use all stations in a single repeater with @xmath50 swap levels or one can construct a number of parallel , independently operated chains of repeaters with less swap levels . increasing the number of swap levels , decreases the fiber losses in the elementary links and thus increases the rate of entanglement generation . if , however , the length of the elementary links is already small , such that , e.g. imperfect spd dominates the rate , then increasing the number of swap levels does not lead to any improvement . in this case",
    "it is advantageous to use the extra repeater stations to make another repeater with less swap levels , which runs in parallel with the already existing one . to make a proper assessment of the performance of repeater one should therefore include that adding swap levels costs resources in the form of additional repeater stations . in our comparison",
    ", we therefore consider a normalized secret key rate , @xmath51/ (  #  of stations ) , which is the secret key rate divided by the total number of repeater station instead of the bare secret key rate . to evaluate the performance of the repeater we calculate the achievable rate @xmath52 as described in appendix  [ app : rate ] with the assumptions summarized in table [ tab : parameter ] about fiber losses etc .. the resulting rate for various swap level used in the repeater",
    "is shown in fig .",
    "[ fig : figurex4 ] as a function of distance . as",
    "seen in the figure , the optimal number of swap level changes with distance while considering the normalized secret key rate .",
    "the rate was calculated as described in app .",
    "[ app : rate ] for a cooperativity of 100 with the assumptions summarized in table [ tab : parameter ] about fiber losses , detection efficiencies etc . for distances",
    "@xmath53 km , only a single swap level is needed since the fiber losses are relatively small while more swap levels are needed as the distance increases .    ) as a function of the distribution distance for a high - fidelity repeater consisting of the two - photon entanglement generation scheme and the heralded gate for entanglement swapping .",
    "we have considered @xmath54 and 4 swap levels and have assumed a cooperativity of @xmath55100 and two qubits per repeater station .",
    "the secret key rate was calculated as described in app .",
    "[ app : rate ] with the assumptions summarized in table [ tab : parameter ] .",
    ", scaledwidth=48.0% ]    in most repeater schemes , the qubits in each repeater station are assumed to be operated simultaneously with half of the qubits being used to generate entanglement with the neighbouring station to each side such that entanglement attempts in all the elementary links are done simultaneously .",
    "we will refer to this as a _ parallel _ repeater .",
    "we will , however , also consider another sequential way of operating the qubits , where all qubits in a station are first used to make entanglement in one elementary link .",
    "after this has been obtained , all but one qubit are then used to make entanglement over the neighboring link in the opposite direction .",
    "this is referred to as a _ sequential _ repeater .",
    "the advantage of the sequential repeater is that the rate of the lowest level in the repeater , the entanglement generation , is increased .",
    "this comes at the cost of a waiting time between entanglement attempts in neighboring links .",
    "as the number of qubits per repeater station increases the sequential repeater will start to outperform the parallel repeater .",
    "we find that this happens with 4 qubits per repeater station ( see sec .",
    "[ sec : optim ] ) .",
    "we have found that the high - fidelity repeater that we have described above outperforms a number of other cavity - based repeater schemes , which can be contructed with different schemes of entanglement generation and cnot gates .",
    "below , we describe the constituents of these other schemes and compare them to those of the high - fidelity repeater      it has also been suggested to use single - photon detection schemes similar to ref .",
    "@xcite to generate entanglement in the elementary links .",
    "the setup of a single - photon detection scheme is also shown in fig .  [",
    "fig : figure2 ] .",
    "we assume that the two emitters are initially prepared in a state @xmath56 by a weak excitation pulse such that the excitation probability is @xmath57 .",
    "an emitter can then go from state @xmath11 to state @xmath9 by emitting a cavity photon .",
    "the emitted photons are collected from the cavities and combined on a balanced beam splitter ( bs ) on a central station between the two cavities . neglecting losses , the detection of a single photon after the bs will project the state of the emitters into the bell state @xmath58 up to a single qubit rotation in the limit @xmath59 where we can neglect the possibility of double excitations .",
    "the probability of an emitter to go from @xmath11 to @xmath9 , by emission of a cavity photon during a time interval @xmath17 $ ] , is @xmath60 ( see eq .  ) under similar assumptions as in the two - photon scheme described above .",
    "neglecting dark counts but including losses , the total probability of a single click at the central station is @xmath61 with @xmath25 being the total detection efficiency as for the two - photon scheme .",
    "the first term is the probability to emit and detect a single photon while the second term is the probability of emitting two cavity photons but only getting a single click ( we assume that we do not have access to number - resolving detectors ) .",
    "the probability , to have a single click and have created the state @xmath62 , is @xmath63 .",
    "the average heralded fidelity conditioned on a single click is thus @xmath64 .",
    "to lowest order in @xmath65 , @xmath66 while the success probability is @xmath67 .",
    "there is thus a tradeoff set by @xmath57 between the success probability and the fidelity for the single - photon detection scheme .",
    "this is in contrast to the two - photon detection scheme where @xmath68 regardless of success probability .",
    "the success probability of the single - photon detection scheme is not as sensitive to the detection efficiency @xmath25 as the two - photon detection scheme as shown in fig .",
    "[ fig : figurex3 ] .",
    "if the detection efficiency @xmath25 is large , the two - photon scheme is desirable since it will have both a high success probability and a high fidelity .",
    "however , if @xmath25 is small , the single - photon scheme will be advantageous since it has a relatively high success probability . due to the possible high success probability but limited fidelity of the single - photon scheme , it might be desirable to combine it with entanglement purification to increase the final fidelity . in this way",
    "the higher success probability of the single - photon scheme may compensate the lower fidelity .",
    "we have therefore considered the possibility of initial entanglement purification in repeaters based on the single - photon detection scheme as described below .      based on a detailed analysis of the various errors that limit the fidelity for the single - photon scheme including dark counts of the detectors ( see app .",
    "[ single ] for details ) , we find that the purification protocol of ref .",
    "@xcite effectively corrects for the errors in the single - photon scheme and we assume that this is used for the initial purification .",
    "however , as pointed out in ref .",
    "@xcite an improved fidelity , at the expense of a factor of @xmath69 in the success probability , can be obtained by only accepting outcomes where the two heralding qubits are found in state @xmath70 instead of also accepting @xmath71 outcomes .",
    "we will also consider this modification to the purification protocol in ref .",
    "the protocol relies on a cnot operation , which we assume to be made with the same gate used to perform the subsequent entanglement swapping ( see below ) . to reflect the most realistic near - term quantum repeaters we consider at most 4 qubits per repeater stations .",
    "we therefore assume that the purification is performed in a pumping scheme  @xcite , where the fidelity of a single pair is pumped by combining it with pairs of lower fidelity since this requires the lowest number of qubits per station .",
    "the effect of combining the single - photon scheme with initial purification is shown in fig .",
    "[ fig : figurex3 ] where , for simplicity , the purification is assumed to be performed with a deterministic gate with perfect fidelity and without the modification of ref .",
    "if high fidelity pairs are desired for , e.g. , a repeater with many swap levels , entanglement purification can increase the rate of the entanglement generation",
    ". for high collection efficiencies it is , however , desirable to use the two photon scheme since this has a higher rate .",
    "in particular the two photon scheme becomes desirable if high fidelity pairs are required .     and",
    "@xmath72 both without purification ( @xmath73 ) and with one round of purification ( @xmath74 ) .",
    "the rate is shown as a function of the total detection efficiency @xmath25 .",
    "we have neglected dark counts and assumed that the cnot gate is deterministic and have perfect fidelity .",
    "the rate has been calculated as described in app .",
    "[ app : rate ] .",
    "furthermore , we have assumed that each repeater station contains 4 qubits , which are either used for purification or to increase the rate of the entanglement generation .",
    ", scaledwidth=50.0% ]      in our analysis , both the initial purification and the subsequent entanglement swapping involves a cavity - based cnot gate . besides the heralded cnot gate used in the high - fidelity repeater , which we will refer to as _ gate 1 _ , a deterministic cavity - based gate proposed in ref .",
    "@xcite could be used . combining the gate scheme of ref .",
    "@xcite with the local entanglement generation scheme of ref .",
    "@xcite results in a deterministic cnot gate with an error scaling as @xmath75",
    ". we will refer to this gate as _",
    "gate 2_. this gate does not require an auxiliary atom as gate 1 but rather two auxiliary levels in the qubit atoms as shown in fig .  [ fig : figure4a ] .    in this scheme",
    ", the quantum information is stored in the horizontal / qubit degree of freedom ( subscripts @xmath76 and @xmath77 ) and the vertical / level degree of freedom ( denoted @xmath20 and @xmath78 ) is used to make an entanglement assisted cnot gate between the atoms . separating the qubit degree of freedom from the level degree of freedom , the gate works by ideally making the transformation @xmath79 where @xmath80 denote the vertical states and @xmath81 ( @xmath82 ) is the qubit state of the first ( second ) qubit , which could be entangled with atoms at neighboring repeater stations .",
    "the entanglement between the levels @xmath27 and @xmath83 can be used to make a cnot gate , if the levels of the atoms can be measured non - destructively , i.e. without revealing any information about the qubit state as described in ref .",
    "@xcite . both the transformation shown in eq .   and",
    "the non - destructive measurements can be obtained by sending a weak coherent pulse onto a two - sided cavity and detecting any reflected light ( see fig .  [",
    "fig : figure4b ] and app .",
    "[ app : cnot ] ) .",
    "if the light is resonant with the empty cavity mode , atoms in @xmath83 will shift the cavity resonance .",
    "consequently , photons will be reflected and constitutes a qnd measurement of the presence of atoms in @xmath83 .",
    "spontaneous emission from the atoms will limit the fidelity of the gate to @xmath84 , where @xmath85 is the detection efficiency and @xmath21 is the cooperativity .",
    "the gate time is limited by the time of the single qubit rotations and the coherent pulses .",
    "we assume that this gives a gate time on the order of 10 @xmath86s .    as a benchmark",
    ", we also consider a naive approach where a direct gate between two qubits is made in a cavity without the use of an auxliary atom or auxliary atomic states .",
    "to characterize such a gate we consider a situation where the setup of gate 1 is used to make a deterministic gate by simply ignoring the heralding condition .",
    "we will refer to this gate as _",
    "gate 3_. for such a gate , we find that the gate fidelity will scale as @xmath87 and the time of the gate will be limited by the time of the single qubit rotations which we assume to be @xmath88 @xmath86s .",
    "the characteristics of the three gates we consider are summarized in table [ tab : table2 ] and illustrated in fig .",
    "[ fig : figurex2 ] .",
    ".the characteristics of the three gates considered for the cavity - based repeaters .",
    "@xmath1 is the cooperativity of the atom - cavity system and @xmath85 is the single photon detection efficiency in gate 2 .",
    "the time of the single qubit rotations is assumed to be 10 @xmath86s . [ cols=\"^,^,^,^\",options=\"header \" , ]     the free parameters in the optimizations are the number of swap levels , the number of purifications with / without the modification of ref .",
    "@xcite and whether a parallel or sequential repeater protocol is used . in the optimizations , we calculate the secret key rate on a grid of all these parameters and pick the combination giving the highest rate .",
    "[ fig : figurex6 ] shows a specific example where the combination of the single - photon scheme with gate 2 is investigated for a parallel repeater and a cooperativity of 100 .    ) as a function of the distribution distance ( distance ) for a parallel repeater based on the single photon generation scheme and gate 2 .",
    "the cooperativity was assumed to be 100 and we assumed 4 qubits per repeater station .",
    "the optimal number of swap levels ( @xmath50 ) and purification rounds ( @xmath89 ) for a given distance can be directly read off from the plot as the combination giving the highest rate . note",
    "that because the gate fidelity is limited , curves with @xmath90 and @xmath91 are not shown since they result in a much lower secret key rate .",
    "the purification schemes was considered to be without the modification of ref .",
    "@xcite.,scaledwidth=46.0% ]    the number of swap levels and purifications , giving the highest rate for a specific distance , can be directly read off from the figure .",
    "the same calculations are then done for a sequential repeater protocol and compared to the parallel repeater protocol with / without the modified purification in order to find the highest rate for this specific combination of entanglement generation scheme and cnot gate .",
    "this is done for all combinations of entanglement generation schemes and cnot gates .",
    "the optimal evolution time , @xmath92 , and excitation probability , @xmath65 , in the entanglement generation schemes are found for each grid point using a built - in numerical optimization in the program matlab .",
    "the key parameter , determining the performance of the cnot gates , is the cooperativity ( see table [ tab : table2 ] ) .",
    "we therefore optimize for cooperativities @xmath93 $ ] and distances between 100 km and 1000 km .",
    "finally , the optimizations are performed for both 2 qubits per repeater station and 4 qubits per repeater station .",
    "note that the auxiliary atom used in gate 1 is not counted as a qubit and schemes based on this gate thus in principle contain an additional atom per repeater station .",
    "we model the effect of the non - perfect gates , as depolarizing channels such that the output of a gate operation described by a unitary @xmath94 working on a set @xmath95 of two qubits is @xmath96 where @xmath97 is the fidelity of the gate , @xmath98 is the identity matrix of the set , @xmath99 is the trace over the set and @xmath100 is the initial density matrix describing the system before the gate operation .",
    "we use eq .   to propagate the density matrix from the entanglement generation ( see app .  [ single]-[two ] ) through the steps of initial purification and entanglement swapping and calculate the average fidelity of the distributed pairs . to calculate the secret key fraction , we treat the distributed pairs as werner states as described in sec .  [",
    "sec : secret ] .    [ h ] +    [ h ] +    the secret key rates per repeater station of the high - fidelity repeater and the other cavity - based repeaters",
    "are shown in fig .",
    "[ fig : figurex7 ] for distances @xmath101 $ ] km and a cooperativity of 100 and in fig .",
    "[ fig : figurex8 ] for a distance of 1000 km and cooperativities in the interval @xmath102 $ ] . as shown in fig .",
    "[ fig : figurex7 ] , the repeaters based on gate 3 are simply not able to distribute entanglement over large distances for realistic cooperativities . as a consequence , repeaters based on gate 3 do not appear on fig .",
    "[ fig : figurex8 ] since their secret key rate is simply too low",
    ".    in general , the high - fidelity repeater ( 2-photon , gate 1 ) achieves the highest secret key rate for a broad range of cooperativities and long distances @xmath103 km .",
    "this reflects both that this protocol allows for a higher number of swap levels and that the secret key rate favors the distribution of high - fidelity pairs since these gives the highest secret fraction ( see fig .",
    "[ fig : figure5 ] ) .",
    "it is also apparent from fig .",
    "[ fig : figurex8 ] that while repeaters based on gate 2 need cooperativities above 100 for a distance of 1000 km , repeaters based on gate 1 are able to function with much lower cooperativities around @xmath104 .",
    "this is because the heralded gate has nearly unit fidelity independent of the cooperativity . for high cooperativities and/or low distances",
    ", a repeater based on the two - photon detection scheme and gate 2 can give a slightly higher secret key rate than the high - fidelity repeater .",
    "this improvement is , however , less than a factor of 2 in the secret key rate .",
    "the steps in the rates of the schemes based on gate 2 in fig .",
    "[ fig : figurex8 ] originate from the fact that as the cooperativity increases , the fidelity of gate 2 increases and at some point the fidelity is high enough to allow for another swap level , which makes the rate increase abruptly . from the optimizations",
    ", we find that the sequential repeater architecture achieves slightly higher rates ( less than a factor 2 ) than the parallel repeater architecture for 4 qubits per repeater station , while the opposite is the case for 2 qubits per repeater station .    in general , repeaters based on the two - photon detection schemes outperform repeaters based on the single - photon detection scheme except for repeaters based on gate 3 .",
    "this reflects that repeaters based on gate 3 can not perform many swap levels since the fidelity simply decreases too rapidly with the number of swap levels .",
    "the result of the optimization was that no swap levels were actually preferred for repeaters based on gate 3 for @xmath105 .",
    "as a result , the elementary links in these repeaters are long and fiber losses therefore significantly decrease the total detection probability @xmath25 in the entanglement generation schemes . in the limit of very low @xmath25 ,",
    "the one - photon scheme is advantageous since the success probability only depend linearly on @xmath25 . for the optimizations",
    ", we have assumed that the combined efficiency of the spd detectors and outcoupling of light from the cavities is @xmath10650% .",
    "if this efficiency is smaller , repeaters based on single - photon detection may be desirable .",
    "we also find that the purification protocol , in general , performs better with than without the modification of ref .",
    "the improvement is , however , limited to a factor of @xmath107 for the parameters considered in figs .",
    "[ fig : figurex7]-[fig : figurex8 ] .",
    "it is important to stress that the rates plotted in figs .",
    "[ fig : figurex7]-[fig : figurex8 ] , are the secret key rates divided by the total number of repeater stations .",
    "the actual distribution rate can thus be obtained by multiplying with the number of repeater stations .",
    "for the high - fidelity repeater , we find a secret key rate of @xmath10816 hz over 1000 km for 33 repeater stations and a cooperativity of 1000 assuming 2 qubits per repeater station .",
    "for a more modest cooperativity of 100 , a secret key rate of @xmath1081.5 hz over 1000 km can be obtained .",
    "we can compare the rate found here to the rate obtainable with repeaters based on atomic ensembles . in ref .",
    "@xcite an efficient repeater based on atomic ensembles is described , which achieves one of the highest distribution rates for repeaters based on atomic ensembles  @xcite .",
    "the fidelity of the distributed pair and the distribution rate are derived in ref .",
    "@xcite for a repeater with four swap levels corresponding to 17 repeater stations . based on this",
    ", we have calculated the secret key rate assuming an optimistic , basic repetition rate of the ensembles of 100 mhz and memory and spd efficiencies of 90% .",
    "the rate of the ensemble - based repeater is also shown in figs .",
    "[ fig : figurex7]-[fig : figurex8 ] for similar assumptions about fiber losses etc . as for the cavity - based repeaters .",
    "we have assumed that the repeater uses four swap levels for all distances even though a smaller number of swap levels may be desirable for smaller distances ( @xmath109 km )  @xcite . for a distance of 1000 km",
    ", we find a rate of @xmath110 hz for 33 repeater stations .",
    "this shows that repeaters based on individual atoms in cavities may be very promising candidates for realizing efficient quantum repeaters with rates exceeding those obtainable with atomic ensembles .",
    "the main reason for this is that very efficient entanglement swapping can be realized in the cavity - based repeaters which greatly enhances the distribution rates for long distances . on the contrary ,",
    "repeaters based on atomic ensembles and linear optics have an upper limit on the swapping efficiency of 50% .    for comparison",
    "we have also considered a repeater based on ion traps where there is no cavity to collect the light .",
    "non - local entanglement can still be created by collecting the emitted light with a lens as demonstrated in ref .",
    "@xcite where a collection efficiency of 10% was reported .",
    "the entanglement swapping can be realized using a gate , which has been demonstrated experimentally with a fidelity of 99.3% and a gate time of @xmath111 @xmath86s  @xcite .",
    "note that this fidelity was measured for the generation of a single state in ref .",
    "@xcite but we will assume it to be the fidelity of the entanglement swap .",
    "the rate of such a ion - trap repeater is shown in figs .",
    "[ fig : figurex7]-[fig : figurex8 ] with assumptions about fiber losses etc . summarized in tab .",
    "[ tab : parameter ] . we have assumed a collection efficiency of 10% and as a result , the one photon scheme with modified purification performs better than the two - photon scheme for 4 qubits per repeater station .",
    "however for two qubits , where purification is not possible , the two - photon scheme is in general advantageous except for small distances ( @xmath112 200 km ) .",
    "we have assumed a gate fidelity of 99.3% and have plotted the highest rate obtainable with either the one - photon or two - photon scheme .",
    "it is seen that the high - fidelity repeater outperforms the ion - trap repeater for @xmath7 , which is mainly due to the low collection efficiency in the entanglement generation .",
    "the ultimate rate obtainable with a repeater with perfect deterministic entanglement swapping and entanglement generation based on the two - photon detection scheme with a collection efficiency set by @xmath113 is also shown in figs .",
    "[ fig : figurex7]-[fig : figurex8 ] under our assumptions about fiber loss , detection efficiency etc .. a similar repeater was considered in ref .",
    "@xcite to demonstrate the feasibility of repeaters based on trapped ions . for @xmath114 ,",
    "the high - fidelity repeater achieves only a factor of @xmath69 slower rate than this ultimate limit for a distance of 1000 km .",
    "in conclusion , we have performed a detailed analysis of quantum repeaters based on individual emitters in optical cavities .",
    "we have found that a high - fidelity repeater based on the heralded gate described in ref .  @xcite combined with a two - photon detection scheme is the best option over a large parameter regime and enables high secret key rates over large distances even for limited cooperativities @xmath115 . compared with a number of other cavity based repeaters it achieves rates , which are up to two orders of magnitude faster for long distances ( 1000 km ) and cooperativities @xmath115 . for small distances or higher cooperativities , a repeater based on the deterministic cnot gate described in ref .",
    "@xcite combined with a two - photon detection scheme can achieve rates which are slightly higher than the high - fidelity repeater but the improvement is less than a factor of 2 .",
    "we have also compared the high - fidelity repeater to the repeater in ref .",
    "@xcite , which is based on atomic ensembles . for",
    "a distance of 1000 km and @xmath116 the high - fidelity repeater begins to outperform the ensemble - based repeater and an improvement of more than two orders of magnitude in the secret key rate is possible for @xmath117 .",
    "the main reason for the advantage of the high - fidelity repeater is that entanglement can be swapped very efficiently using the heralded cnot gate described in ref .",
    "consequently , the number of swap levels in the repeater can be increased without the need of intermediate purification which greatly enhances the rate for large distances .",
    "a similar advantage could in principle be achieved by resorting to a trapped ion system where efficient gates can be implemented . for current systems ,",
    "the collection efficiencies are , however , so low that a trapped ion system could be outperformed by a cavity system with a limited finesse of @xmath118 .",
    "if the collection efficiency could be overcome , e.g. by placing the ions in a cavity with a high cooperativity , the rate can be substantially improved , but with @xmath119 the high fidelity repeater investigated here is within a factor of two of this ideal repeater .",
    "it should , however , be noted that we have compared schemes with strong physical differences in our analysis .",
    "the high - fidelity repeater requires an extra auxiliary atom while auxiliary atomic levels are required to decrease the error of the deterministic cavity - based cnot gates .",
    "the ensemble - based and ion - trap repeaters are also very different physical systems compared to the cavity - based repeaters with individual atoms . the different experimental difficulties in realizing the physical requirements for the various repeater schemes should be included in a more advanced assessment .    finally , we note that while we have investigated a number of different possible repeater protocols there may be even more advantages procedures . hence the results that we have derived here should be seen as lower limits to the achievable communication rates .",
    "a particular interesting possibility could be to investigate proposals along the lines of ref .",
    "@xcite , which also rely on heralding measurements to detect errors during entanglement generation and two qubit operations . possibly some of the ideas from these schemes could be used to improve the communication beyond what we have found here .",
    "we gratefully acknowledge the support from the lundbeck foundation , the carlsberg foundation , nsf , cua , darpa , afosr muri , and arl . the research leading to these results has also received funding from the european research council under the european union s seventh framework programme ( fp/2007 - 2003 ) through siqs ( grant no .",
    "600645 ) and erc grant qios ( grant no .",
    "the setup of the single - photon scheme is described in sec .",
    "[ sec:1phot ] .",
    "the single photon detectors are assumed to have a dark count probability of @xmath120 and an efficiency of @xmath85 while the transmission efficiency of the fibers is denoted @xmath48 . as described in sec .",
    "[ sec : generation ] , the probability of an emitter to go from the excited state , @xmath11 to the ground state @xmath9 is @xmath60 while the excitation probability is @xmath57 .",
    "the scheme is conditioned on a single click at the central station . depending on",
    "which detector gave the click , a single qubit rotation can be employed such that ideally the state @xmath62 is created .",
    "going through all the possibilities of obtaining a single click at the central station , we find that the density matrix following a single click , and possible subsequent single qubit rotations , is @xmath121 with coefficients @xmath122 \\nonumber \\\\ \\alpha_{1}&=&\\frac{1}{p_{\\text{1click}}}\\big[\\frac{1}{2}\\epsilon^{2}(1-p_{\\text{phot}})^{2}p_{\\text{dark}}(1-p_{\\text{dark}})\\big ] \\nonumber \\\\ \\beta_{1}&=&\\frac{1}{p_{\\text{1click}}}\\big[\\frac{1}{2}\\eta_{\\text{d}}\\eta_{\\text{f}}p_{\\text{phot}}\\epsilon^{4}(1-p_{\\text{phot}})(1-p_{\\text{dark}})\\nonumber \\\\ & & + 2(1-\\eta_{\\text{f}})p_{\\text{phot}}\\epsilon^{2}(1-\\epsilon^{2})p_{\\text{dark}}(1-p_{\\text{dark } } ) \\nonumber \\\\ & & + ( 1-\\eta_{\\text{d}}\\eta_{\\text{f}})p_{\\text{phot}}\\epsilon^{4}(1-p_{\\text{phot}})p_{\\text{dark}}(1-p_{\\text{dark}})\\nonumber \\\\ & & + ( 1-\\epsilon^{2})\\epsilon^{2}(1-p_{\\text{phot}})p_{\\text{dark}}(1-p_{\\text{dark } } ) \\nonumber \\\\ & & + \\frac{1}{2}\\epsilon^{2}(1-p_{\\text{phot}})^{2}p_{\\text{dark}}(1-p_{\\text{dark } } ) \\nonumber \\\\ & & + 2\\eta_{\\text{f}}(1-\\eta_{\\text{d}})p_{\\text{phot}}\\epsilon^{2}(1-\\epsilon^{2})p_{\\text{dark}}(1-p_{\\text{dark}})\\big ] \\nonumber \\\\ \\tilde{\\alpha}_{1}&=&\\frac{1}{p_{\\text{1click}}}\\big[2(1-\\epsilon^{2})^{2}p_{\\text{dark}}(1-p_{\\text{dark}})\\nonumber \\\\ & & + 2(1-\\epsilon^{2})\\epsilon^{2}(1-p_{\\text{phot}})p_{\\text{dark}}(1-p_{\\text{dark}})\\big ] \\nonumber \\\\ \\tilde{\\beta}_{1}&=&\\frac{1}{p_{\\text{1click}}}\\big[\\eta_{\\text{d}}\\eta_{\\text{f}}p_{\\text{phot}}\\epsilon^{4}(1-p_{\\text{phot}})(1-p_{\\text{dark}})\\nonumber \\\\ & & + 2(1-\\eta_{\\text{d}}\\eta_{\\text{f}})p_{\\text{phot}}\\epsilon^{4}(1-p_{\\text{phot}})p_{\\text{dark}}(1-p_{\\text{dark } } ) \\nonumber \\\\ & & + 2(1-\\eta_{\\text{d}}\\eta_{\\text{f}})^{2}p_{\\text{phot}}^{2}\\epsilon^{4}p_{\\text{dark}}(1-p_{\\text{dark}})\\nonumber \\\\ & & + 2(1-\\eta_{\\text{d}}\\eta_{\\text{f}})\\eta_{\\text{d}}\\eta_{\\text{f}}p_{\\text{phot}}^{2}\\epsilon^{4}(1-p_{\\text{dark}})^{2}\\big ] . \\end{aligned}\\ ] ] here we have assumed that with probability @xmath123 , an emitter is excited but spontaneously decay to the ground states instead of emitting a cavity photon .",
    "furthermore , we have assumed that the decay rates to the two ground states are equal such that the emitter ends up in @xmath124 .",
    "note that the detectors are not assumed to be number resolving .",
    "@xmath125 is the total success probability given by @xmath126 assuming @xmath127 , the dominant error is where both qubits are excited but only a single click is detected at the central station .",
    "this leaves the qubits in the state @xmath128 and this error is efficiently detected by the purification scheme described in ref .",
    "for the two photon scheme described in sec .",
    "[ sec : generation ] , we condition on a click in two detectors .",
    "once again we assume that appropriate single qubit rotations are employed depending on which detector combination clicked such that ideally the state @xmath129 is created .",
    "we find that the density matrix describing the qubit state after a successful event is @xmath130 where we have defined @xmath131 \\nonumber \\\\ \\alpha_{2}&=&\\frac{(1-p_{\\text{dark}})^{2}}{p_{\\text{2click}}}\\big[\\eta_{d}(1-\\eta_{\\text{f}})\\eta_{\\text{f}}p_{\\text{dark}}p_{\\text{phot}}^{2}\\nonumber \\\\ & & + p_{\\text{dark}}^{2}(1-p_{\\text{phot}})^{2}+\\eta_{\\text{d}}\\eta_{\\text{f}}p_{\\text{dark}}p_{\\text{phot}}(1-p_{\\text{phot}})\\nonumber \\\\ & & + ( 1-\\eta_{\\text{f}})^{2}p_{\\text{phot}}^{2}p_{\\text{dark}}^{2}\\nonumber \\\\ & & + 2\\eta_{\\text{f}}(1-\\eta_{\\text{d}})(1-\\eta_{\\text{f}})p_{\\text{phot}}^{2}p_{\\text{dark}}^{2}\\nonumber \\\\ & & + 2(1-\\eta_{\\text{d}}\\eta_{\\text{f}})p_{\\text{phot}}(1-p_{\\text{phot}})p_{\\text{dark}}^{2}\\nonumber \\\\ & & + \\eta_{\\text{d}}(1-\\eta_{\\text{d}})\\eta_{\\text{f}}^{2}p_{\\text{dark}}p_{\\text{phot}}^{2}\\nonumber \\\\ & & + \\eta_{\\text{f}}^{2}(1-\\eta_{\\text{d}})^{2}p_{\\text{phot}}^{2}p_{\\text{dark}}^{2}\\big ] \\nonumber \\\\ \\beta_{2}&=&\\alpha_{2}+\\frac{(1-p_{\\text{dark}})^{2}}{p_{\\text{2click}}}\\big[\\eta_{\\text{d}}(1-\\eta_{\\text{d}})\\eta_{\\text{f}}^{2}p_{\\text{dark}}p_{\\text{phot}}^{2}\\nonumber \\\\ & & + \\eta_{\\text{f}}^{2}(1-\\eta_{\\text{d}})^{2}p_{\\text{phot}}^{2}p_{\\text{dark}}^{2}\\big ] .",
    "\\end{aligned}\\ ] ] the success probability @xmath132 is @xmath133\\end{aligned}\\ ] ] as in the single - photon scheme , we have not assumed number resolving detectors and we have assumed that with probability ( @xmath134 ) , an emitter spontaneously decay to one of the ground states resulting in the state @xmath124 .",
    "here we describe the local entanglement generation scheme presented in ref .",
    "@xcite , which can be used to make a deterministic cnot gate as described in sec .",
    "[ sec : cnotgate ] .",
    "we assume that weak coherent light is continuously shined onto the cavity such that at most one photon is in the cavity at all times .",
    "a single - photon detector continuously monitors if any photons are reflected from the cavity and the coherent light is blocked if a click is recorded before @xmath135 photons on average have been sent onto the cavity . if no click was recorded during this time , both atoms are interpreted as being in the @xmath20 levels .",
    "the steps of the entangling scheme are the following .    1 .",
    "both atoms are initially prepared in the superposition @xmath136 by e.g. a @xmath137-pulse .",
    "coherent light is sent onto the cavity . if a click is recorded before on average @xmath138 photons",
    "have been sent onto the cavity , the levels of the atoms are flipped ( @xmath139 ) .",
    "if no click is recorded , the atoms are interpreted as being in @xmath140 and the procedure is repeated from step 1 .",
    "3 .   conditioned on the first click",
    ", another coherent light pulse is sent onto the cavity after the levels of the atoms have been flipped . if a click is recorded before @xmath141 photons on average have been sent onto the cavity , the entangling scheme is considered to be a success . here",
    "@xmath142 is the average number of photons that had been sent onto the cavity before the first click .",
    "if no click is recorded , the atoms are interpreted as being in @xmath140 and the procedure is repeated from step 1 .",
    "as described above , the entangling scheme is repeated until it is successful leading to a deterministic creation of entanglement in the end . as described in ref .",
    "@xcite a series of non - destructive measurements of the atoms together with single qubit rotations can be used to make a cnot operation after the entanglement has been created .",
    "the non - destructive measurements can be performed using the same technique of monitoring reflected light as in the entangling scheme and we assume that we can effectively tune the couplings to the cavity such that possibly only a single atom couples .",
    "here we analyse the rate of entanglement distribution for the different repeater architectures considered in the main text .",
    "the total rate of the repeater is set by the average time of entanglement creation , initial purification and entanglement swapping .",
    "assuming that entanglement generation has a success probability , @xmath143 , we estimate the average time @xmath144 it takes to generate @xmath145 entangled pairs in one elementary link using @xmath146 qubits , which can be operated in parallel , as @xmath147 here @xmath148 is the speed of light in the fibers and @xmath149 is the time of local operations such as initialization of the qubits .",
    "the factor @xmath150 can be thought of as the average number of coin tosses needed to get at least @xmath145 tails if we have access to @xmath146 coins , which we can flip simultaneously and the probability of tail is @xmath143 for each coin @xcite .",
    "it is furthermore assumed that coins showing tail after a toss are kept and only the coins showing head are tossed again until @xmath145 tails are obtained . in the repeater context , the coins are entanglement generation attempts and tail is successful entanglement generation . the time it takes per `` toss '' is @xmath151 . to calculate the expressions for @xmath152",
    ", we follow the lines of ref .",
    "@xcite where similar factors are derived .",
    "the expression for @xmath153 is already derived in ref .",
    "@xcite and their result is stated below @xmath154 for @xmath155 where @xmath156 , we only need to find expressions for @xmath157 with @xmath158 , @xmath159 with @xmath160 and @xmath161 since we have a maximum of 4 qubits pr .",
    "repeater station .",
    "for @xmath162 , we have that @xmath163[(q^{2})^{l-1}pq ] \\nonumber \\\\ & & + \\binom{3}{1}\\binom{2}{2}\\sum_{k=1}^{\\infty}\\sum_{l=1}^{\\infty}(k+l)[(q^{3})^{k-1}pq^{2}]\\nonumber \\\\ & & \\times[(q^{2})^{l-1}p^{2}],\\end{aligned}\\ ] ] where @xmath164 . the first term in eq .",
    "describes the situations where three tails are obtained in a single toss after a given number of tosses , where all coins showed head",
    ". we will refer tosses where all coins show tail as failed tosses .",
    "the second term describes the situation where we get two tails in the same toss after a given number of failed tosses .",
    "the third and fourth terms are where we get a single tail after a given number of failed tosses .",
    "the coin showing tail is then kept and the two remaining coins are tossed until we obtain another tail ( third term ) or two tails simultaneously ( fourth term ) . the geometric series in eq .",
    "can be solved to give @xmath165 where the approximate expression is for @xmath166 .",
    "note that the factor of @xmath167 corresponds to a simple picture where it on average takes @xmath168 attempts to get the first tail using 3 coins and @xmath169 attempts to get the second using the remaining @xmath170 coins . in a similar manner",
    ", we find that @xmath171 here the approximate expressions are all for @xmath166 and they correspond to the expressions one would get using simple pictures similar to the one described above in the discussion of @xmath162 .",
    "after creating a number of entangled pairs in an elementary link of the repeater , they may be combined to create a purified pair of higher fidelity .",
    "as previously mentioned , we assume an entanglement pumping scheme since this requires less qubit resources than a cascading scheme . let @xmath172 denote the success probability of the purification operation , which depends on the fidelity of the two initial pairs ( @xmath173 ) and the fidelity of the cnot gate used in the purification operation .",
    "note that @xmath174 also contains the success probability of the cnot gate used in the purification for the heralded gate .",
    "we estimate the average time @xmath175 , it takes to make one purified pair from two initial pairs of fidelity @xmath173 , using @xmath146 qubits in parallel in the entanglement generation step , as @xmath176 where @xmath177 is the time of the purification operation including the classical comunication time required to compare results . here",
    "@xmath178 is the time of the cnot operation and @xmath179 is the communication time between the two repeater stations sharing the entangled pairs . to further pump the entanglement of the purified pair",
    ", a new entangled pair is subsequently created using @xmath180 qubits operated in parallel .",
    "the average time it takes to make @xmath89 rounds of purification is thus estimated as @xmath181 with @xmath182 . here @xmath183 is the fidelity of the purified pair after @xmath184 purifications .",
    "the total rate of a repeater , consisting both of purification and entanglement swapping , depends on the specific repeater achitecture .",
    "we will first consider the case of both a parallel and sequential repeater operated with deterministic gates and afterwards the same situations with probabilistic gates .",
    "for a parallel repeater with @xmath50 swap levels and deterministic gates , we first estimate the average time it takes to generate @xmath185 purified pairs , i.e. a purified pair in each elementary link .",
    "we assume that each pair is purified @xmath89 times such that the time to generate one purified pair is @xmath186 where we have solved the recurrence in eq .  .",
    "we now wish to estimate the total time , @xmath187 it takes to make purification in every elementary link , i.e. the time it takes to make @xmath185 pairs",
    ". a lower limit of @xmath187 is simply @xmath188 but this is a very crude estimate if the purification have a limited success probability since the time is not determined by the average time but by the average time for the last link to succeed .",
    "we therefore make another estimate of the average time by treating @xmath188 as consisting of @xmath189 independent binomial events with probabilities @xmath190 we then estimate the average time , @xmath191 it takes to make @xmath185 purified pairs as @xmath192 eq .",
    "is a better estimate for the average time than @xmath188 in the limit of small success probabilities since it takes into account that we need success in all links .",
    "this is contained in the factors @xmath193 .",
    "however , it overestimates the average distribution time when the purification has a large success probability .",
    "how much it overestimates depends on @xmath50 and @xmath89 . comparing @xmath188 to eq .",
    "we find numerically that for @xmath194 and @xmath195 there is a factor @xmath107 between the two estimates , in the limit of large success probability for the purification operation . as discussed in sec .",
    "[ sec : optim ] we never consider more than 5 swap levels in our optimization and since we have a limited number of qubits pr .",
    "repeater station , we will never have to consider more than 2 rounds of purification .",
    "we can therefore use the estimate for @xmath187 given in eq .  .",
    "to get the average time it takes to distribute one entangled pair over the total distance , @xmath196 , of the repeater , we need to add the time of the entanglement swapping , @xmath197 to @xmath187",
    ". we estimate @xmath198 as @xmath199 where the first term is the time of the classical communication and @xmath178 is the time of the cnot operation involved in the swap procedure .",
    "the average distribution rate , of a parallel repeater with deterministic gates , is thus @xmath200 .    for a repeater using sequential entanglement creation with deterministic gates",
    ", we estimate the time it takes to generate purified pairs in all @xmath185 pairs as @xmath201 here we have indicated that the number of qubits , which can be operated in parallel is @xmath202 for the first @xmath203 pairs and @xmath204 for the next @xmath203 pair compared to the parallel repeater , where only @xmath146 qubits can be used in all @xmath185 pairs .",
    "note , that we have assumed that first entanglement is established in half of the links and only when this is completed , entanglement is created in the remaining half of the links .",
    "this is clearly not the fastest way of operating the repeater but it gives an upper limit of the average distribution time and hence a lower limit on the rate .",
    "the entanglement swapping of the sequential repeater is exactly the same as for the parallel repeater and the average total rate , of the sequential repeater with deterministic gates , is thus @xmath205 .      to estimate the total , average distribution time of a repeater using parallel entanglement creation with @xmath50 swap levels and probabilistic gates , we will again treat @xmath188 as consisting of @xmath189 independent binomial events , as we did for the deterministic gates .",
    "the time it takes to make a single swap can be estimated as @xmath206 where @xmath207 is the probability of the swap operation , i.e. the probability of the cnot gate .",
    "can be iterated such that the average time it takes to make @xmath50 swap levels is estimated as @xmath208 where @xmath209 here @xmath210 is either @xmath211 or @xmath212 . in the limit of @xmath213 and assuming no initial purification , eq .",
    "reduces to the well - known fomula @xcite @xmath214 since @xmath215 and the time of local operations in the swaps can be neglected in this limit .",
    "however , for higher success probabilities , eq .   more accurately estimates the average distribution time .",
    "the average rate of a parallel repeater with probabilistic gates and @xmath50 swap levels is then @xmath216 . from a numerical study",
    ", we again find that for @xmath217 and @xmath218 , eq",
    ".   underestimates the average distribution rate with a factor that increases with the number of swap levels , @xmath50 .",
    "however , for @xmath219 and @xmath195 , we find that this factor is @xmath107 .",
    "the operation of a sequential repeater with probabilistic gates is not straightforward since it is unclear how the sequential generation of entanglement should take place after a failed swap operation .",
    "we therefore choose to assume that initially , entanglement is generated in all @xmath185 links sequentially .",
    "when this is completed the first round of entanglement swapping is performed .",
    "if a swap fails , entanglement is restored in a parallel manner in this section , i.e. the sequential operation is only employed in the initial generation of entanglement . thus if @xmath220th swaps fail in the first swap level an extra waiting time of @xmath221 is needed to restore entanglement in the @xmath222th links in a parallel manner and swap them successfully .",
    "is very similar to eq .  , which estimates the time needed for a single swap at the first swap level .",
    "nonetheless , the functions @xmath223 , which appears in eq",
    ".   takes into account that we need @xmath220 successful swaps instead of only a single swap .",
    "furthermore , we assume that the swap operations of a swap level is only initiated when all swap operations in the preceeding level have been successful .",
    "the average time , it takes for all swap operations in the first level to succeed , is then estimated as @xmath224,\\end{aligned}\\ ] ] where @xmath225 is the kronecker delta symbol and @xmath226 .",
    "it is seen that in the limit @xmath227 , eq .",
    "correctly reduces to @xmath228 , which simply is the time of the classical communication of the results of the bell measurements and the time of the local operations .",
    "can be generalized such that the time it takes to perform the @xmath145th swap level is @xmath229,\\end{aligned}\\ ] ] which can be compared to eq .   which estimates the time to make a successful swap at the @xmath50th level ( let @xmath230 for comparison ) .",
    "once again the functions @xmath223 takes into account that we need @xmath220th successful swaps instead of just a single successful swap .",
    "the total rate of a sequential repeater with probabilistic gates and @xmath50 swap levels can then be estimated as @xmath231 .",
    "37ifxundefined [ 1 ] ifx#1 ifnum [ 1 ] # 1firstoftwo secondoftwo ifx [ 1 ] # 1firstoftwo secondoftwo `` `` # 1''''@noop [ 0]secondoftwosanitize@url [ 0 ]",
    " + 12$12  & 12#1212_12%12@startlink[1]@endlink[0]@bib@innerbibempty link:\\doibase 10.1038/nature07127 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevlett.78.3221 [ * * ,   ( ) ] \\doibase doi:10.1088/0034 - 4885/76/9/096001 [ * * ,   ( ) ] link:\\doibase 10.1103/revmodphys.81.1301 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevlett.81.5932 [ * * ,   ( ) ] link:\\doibase 10.1038/35106500 [ * * ,   ( ) ] link:\\doibase 10.1103/revmodphys.83.33 [ * * ,   ( ) ] @noop ( ) link:\\doibase 10.1103/revmodphys.82.1041 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevlett.96.070504 [ * * ,   ( ) ] link:\\doibase 10.1103/physreva.79.042340 [ * * ,   ( ) ] link:\\doibase 10.1038/nature11023 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevlett.75.3788 [ * * ,   ( ) ] link:\\doibase 10.1103/physreva.52.3554 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevlett.106.090502 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevlett.91.097905 [ * * ,   ( ) ] link:\\doibase    10.1103/physrevlett.76.722 [ * * ,   ( ) ] link:\\doibase    10.1103/physrevlett.77.2818 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevlett.84.4002",
    "[ * * ,   ( ) ] link:\\doibase    10.1038/35074041 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevlett.90.253601 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevlett.114.110502 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevlett.91.067901 [ * * , ( ) ] link:\\doibase 10.1103/physrevlett.90.127903 [ * * ,   ( ) ] link:\\doibase 10.1073/pnas.0703284104 [ * * ,   ( ) ] @noop ( ) link:\\doibase",
    "10.1103/physrevlett.67.661 [ * * , ( ) ] link:\\doibase 10.1103/physrevlett.81.3018 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevx.4.041041 [ * * ,   ( ) ] link:\\doibase 10.1088/0034 - 4885/70/8/r03 [ * * ( ) ,  10.1088/0034 - 4885/70/8/r03 ] link:\\doibase 10.1038/ncomms4376 [ * * ( ) ,  10.1038/ncomms4376 ] link:\\doibase    10.1103/physreva.77.062301 [ *",
    "* ,   ( ) ] link:\\doibase 10.1038/nphys3150 [ * * ,   ( ) ] link:\\doibase 10.1038/nphys961 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevlett.79.5178 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevlett.78.4293 [ * * ,   ( ) ] link:\\doibase 10.1103/physreva.83.012323 [ * * , ( ) ]"
  ],
  "abstract_text": [
    "<S> individual atoms in optical cavities can provide an efficient interface between stationary qubits and flying qubits ( photons ) , which is an essentiel building block for quantum communication . </S>",
    "<S> furthermore , cavity assisted controlled - not ( cnot ) gates can be used for swapping entanglement to long distances in a quantum repeater setup . nonetheless , dissipation introduced by the cavity during the cnot </S>",
    "<S> may increase the experimental difficulty in obtaining long - distance entanglement distribution using these systems . </S>",
    "<S> we analyse and compare a number of cavity - based repeater schemes combining various entanglement generation schemes and cavity assisted cnot gates . </S>",
    "<S> we find that a scheme , where high - fidelity entanglement is first generated in a two - photon detection scheme and then swapped to long distances using a recently proposed heralded cz - gate exhibits superior performance compared to the other schemes . </S>",
    "<S> the heralded gate moves the effect of dissipation from the fidelity to the success probability of the gate thereby enabling high - fidelity entanglement swapping . as a result </S>",
    "<S> , high - rate entanglement distribution can be achieved over long distances even for low cooperativities of the atom - cavity systems . </S>",
    "<S> this high - fidelity repeater is shown to outperform the other cavity - based schemes by up to two orders of magnitude in the rate for realistic parameters and large distances ( @xmath0 km ) . </S>"
  ]
}