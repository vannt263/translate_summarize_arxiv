{
  "article_text": [
    "one of the most thrilling challenges in the study of the cosmic microwave background ( cmb ) is to deal with the problem of separating the cosmological signal from the different foregrounds and noises that appear in cmb experiments",
    ". this problem will be specially relevant in future high - resolution experiments such as map ( bennett et al .",
    "1996 ) and planck ( mandolesi et al . 1998 , puget et al . 1998 ) . from the point of view of determining constraints on fundamental cosmological parameters , the different foregrounds ( synchrotron emission , galactic dust , free - free radiation , thermal and kinetic sunyaev - zeldovich ( sz ) emission from galaxy clusters and extragalactic point sources ) are considered as contaminants and therefore must be removed together with the noise in order to extract the cosmological signal . besides , knowledge about each of these contaminants has a great scientific relevance on itself .",
    "therefore , it is of exceptional importance to be provided with good techniques of denoising and foreground separation .",
    "there are several methods already available to perform the separation of the different components in cmb observations , such as the ones based on wiener filter ( tegmark and efstathiou 1996 , bouchet and gispert 1999 ) and on maximum entropy methods ( mem , hobson et al .",
    "1998 , 1999 ; stolyarov et al .",
    "all these methods take advantage of the different statistical properties of the cmb and the foregrounds ( e.g. different angular power spectra ) as well as the knowledge of their distinctive frequency dependence . when neither the spatial distribution of the foregrounds nor its frequency dependence are well known the performance of these separation methods dramatically drops .",
    "such is the case of point sources , whose spatial distribution and abundance remains uncertain and whose frequency dependence is not well known .",
    "besides , they can show temporal and even spectral variability .",
    "extragalactic point sources should be removed from the maps before any analysis should be performed .",
    "maximum entropy methods can produce a catalogue of point sources as a residual ( noise ) from the separation process .",
    "however , only the faintest sources are recovered , and the brightest ones can still be observed in the residuals . the independent component analysis technique ( baccigalupi et al 2000 , maino et al 2001 ) has also been applied to this problem with promising results : it has the advantage that , unlike the previous methods , it does not need any prior knowledge of the components to be separated , but its weakest point is actually the separation of point sources .",
    "filtering techniques have been successful in both denoising and extracting the brightest point sources from cmb maps .",
    "tegmark and oliveira - costa 1998 presented a filtering scheme that minimizes the variance of the map .",
    "however , their filter does not produce a maximum gain ( considered as the ratio between the @xmath5-level of the source after filtering and the @xmath5-level of the source before filtering ) at the scale of the source .",
    "all the point sources in a cmb map will have the same profile and size ( the convolution of a @xmath6-dirac source with the antenna beam ) and the filtering process should take advantage of this fact using a filter optimal for that particular profile and size ( scale ) .",
    "wavelet techniques are specially suitable to deal with scales and spatial location at the same time .",
    "the application of the mexican hat wavelet ( mhw ) to realistic simulations was presented in cayn et al .",
    "( 2000 ) and extended in vielva et al .",
    "( 2000a ) .",
    "the principal advantage of this method is that no specific assumptions about the statistical properties of the point source population or the underlying emission from the cmb and other foregrounds is required .",
    "the mhw and mem techniques have successfully been combined to extract both faint and bright point sources at the same time ( vielva et al",
    ". 2000b ) .",
    "it is desirable to exploit to the maximum the mentioned scale distinctiveness of point sources . in sanz",
    "et al . 2001",
    "( s01 , hereafter ) , a method was presented to , for a given source brightness profile and given the statistical properties of the background ( cmb plus foregrounds and noise ) , derive the analytic shape of the optimal filter for the particular considered case .",
    "that kind of filter was called optimal pseudo - filter. s01 defines as an optimal pseudo - filter one that a ) is unbiased , b ) gives a maximum at the position and scale of the source and c ) gives the minimum variance of pseudo - filter coefficients ( i.e. is an efficient estimator of the amplitude of the sources ) under assumptions a ) and b ) .",
    "they considered one , two and three - dimensional cases and showed that the mhw is optimal ( in the mentioned sense ) or nearly optimal for a two - dimensional gaussian profile and reasonable foreground conditions .",
    "after carefully thinking about the terminology used in that previous work , we have decided to substitute the rather confusing pseudo - filter term by _",
    "adaptive filter_. this is so because a filter that satisfies conditions a ) to c ) _ adapts _ itself to the characteristics of the signal and the noise . in the following we will use adaptive filter in the same sense as pseudo - filter in s01 .",
    "although two - dimensional maps are the most useful and extended form to show cmb data , they are only available after an exhaustive process of analysis and reduction of the raw data from cmb experiments .",
    "these experiments scan different patches of the sky in a sequence producing a unidimensional set of time ordered data ( tod ) .",
    "tods suffer from lower signal - to - noise ratios than final two - dimensional maps , but on the other hand are less likely to show artifacts coming from the data reduction , such as pixel - to - pixel noise correlations .",
    "moreover , tods can be analyzed in ( almost ) real time during the observations in order to produce early ( preliminary ) catalogs of sources .    in this paper",
    "we apply the techniques developed in s01 to realistic simulations of the tod coming from one of the 30ghz planck lfi s channels . in section  [ formalism ]",
    "we summarize some of the conclusions of s01 and present the semi - analytic adaptive filter that should be used in a realistic case .",
    "section  [ data ] describes the simulations used in this work . in section  [ analysis ] we describe the analysis of the simulated data . in section  [ results ]",
    "we describe the performance of the optimal adaptive filter , comparing it with other filtering schemes such as gaussian filter and mhw .",
    "finally , in section  [ conclusions ] we discuss our conclusions and give an outline of future work in this field .",
    "the general formalism of adaptive filters in an n - dimensional image was presented in s01 .",
    "tods can be considered as a particular case of a one - dimensional image ( a spectrum is another interesting case ) .",
    "the image data values can be expressed as @xmath7 where @xmath8 is the time , @xmath9 represents a symmetric source and @xmath10 is a homogeneous and isotropic background with mean value @xmath11 and characterized by the power spectrum @xmath12 ( @xmath13 is the absolute value of the wave vector associated to @xmath8 ) . if @xmath14 is the amplitude of the source we can introduce the profile @xmath15 as @xmath16 . let us introduce a centrally symmetric adaptive filter @xmath17 @xmath18 where @xmath19 defines a translation whereas @xmath20 defines a scaling .",
    "the adaptive filtered field is defined as : @xmath21 in the last equivalence we have expressed the convolution as a product in fourier space .",
    "following s01 , it is possible to derive the analytic form of the _ optimal _ adaptive filter for a given source profile , once we have defined what we mean by _ optimal_. let us define an _ optimal _ adaptive filter as one that satisfies the following conditions :    1 .",
    "there exists a scale @xmath22 such that at the point source position ( @xmath23 ) @xmath24 has a maximum at that scale .",
    "2 .   @xmath25 , i.e. @xmath26 is an unbiased estimator of the amplitude of the source .",
    "the variance of @xmath27 has a minimum at the scale @xmath22 , i.e. we have an efficient estimator .",
    "given these three conditions , the solution ( adaptive filter ) is found to be : @xmath28\\ ] ] @xmath29 ^ 2 , \\ \\",
    "\\delta = ac - b^2 \\end{aligned}\\ ] ] the limits of the integrals go from @xmath30 to @xmath31 .    in s01",
    "analytic expressions for gaussian sources and backgrounds of the type @xmath32 were derived . in a more realistic case",
    ", the background can not be modelled in such a simple way , and integrals in ( [ integrals ] ) should be numerically estimated . when dealing with real data ( or realistic simulations such as those used in this work )",
    "we must perform the following steps : first , determine the power spectrum of the background directly from the image .",
    "second , evaluate integrals ( [ integrals ] ) .",
    "third , build the adaptive filter ( [ eqfilter ] ) and make the convolution ( [ filtered ] ) .",
    "finally , we can proceed to detect the sources , for example looking for peaks above a certain @xmath5-level in the coefficient ( filtered ) image .",
    "when determining the power spectrum of an image we obtain the power spectrum of both the background and the sources together . in the following we consider that the contribution of the point sources to the total power spectrum is negligible",
    "this is a reasonable assumption in a realistic case , specially at medium and high wavelengths where the emission of ir and radio sources is weak .",
    "another problem related to power spectrum determination is the variance of the power spectrum estimator .",
    "the variance of one - dimensional power spectrum estimators tends to be larger than that of two - dimensional cases because the number of sample points is usually smaller .",
    "a possible solution to this problem is to estimate low resolution power spectra .",
    "however , a large amount of information is lost at scales that are crucial for the determination of the adaptive filters . for this work we chose to average the estimated power spectra of adjacent rings of the tod ( corresponding to regions of the sky separated by only a few arcminutes and therefore possessing very similar underlying power spectra ) .",
    "a typical profile of the optimal adaptive filter ( in fourier space ) for a section of the simulated tod used in this paper is shown in figure  [ fig1 ] .",
    "the profile ( solid line ) is irregular due to the roughness of the estimated power spectrum .",
    "these irregularities reflect the particularities of the data and define the scales where the adaptive filter is more or less efficient . for comparison , a mexican hat wavelet ( dashed line ) and a gaussian ( dotted line ) ,",
    "both of them with a width equal to the width of the source , are also shown .",
    "for this work we chose the 30 ghz lfi28 channel of planck because of the relatively small size of its resulting tod .",
    "higher frequencies , in spite of being expected to show more contribution from point sources due to their higher resolution and the contribution of ir sources at @xmath33 ghz , lead to huge tod sets and require many hours of computation to be simulated and analysed on an average computer and will be analyzed in a future work .",
    "our data simulates a 6 months run of the 30 ghz lfi28 channel of planck , covering the whole sky except for two circles of @xmath34 around the ecliptic poles .",
    "the sky simulation consist of the addition ( in flux ) of a cmb simulation and three templates , each for the galactic synchrotron radiation , galactic dust and thermal sz .",
    "these templates have been generated using proper models that are freely distributed among the planck collaboration .",
    "this sky is then combined with a map of point sources , generated from a catalog performed following the model of toffolatti et al .",
    "1998 ( that is not public for the planck collaboration ) and then observed by the planck pipeline simulator for one of the lfi 30 ghz radiometers ; resulting in a tod for the observed sky ( cmb , foregrounds and point sources ) plus instrumental noise .",
    "the data are ordered in circular rings centered on points situated on the ecliptic .",
    "the angle between the pointing axis and the rotation axis for the lfi28 instrument is @xmath35 .",
    "the maximum separation between two consecutive rings is @xmath36 ( at the intersection with the ecliptic plane ) .",
    "each ring results from the average of 60 revolutions of the detector around the rotation axis , corresponding to one hour of integration time , and contains 1950 measures of antenna temperature .",
    "there are a total of 4383 of such rings , leading to 8546850 measures of temperature .",
    "the antenna has a fwhm of @xmath37 and its response slightly differs from a circular gaussian one .",
    "the simulation contains cmb emission , different extended foregrounds ( galactic synchrotron , dust and free - free , thermal and kinetic sz emission from clusters , etc ) , point sources and instrumental noise .",
    "both white noise and @xmath38 noise are present .",
    "the knee frequency @xmath39 is set to be @xmath40 mhz ( less than the frequency of rotation ) . in the lower panel of figure  [ fig2 ]",
    "we show a segment of one of the rings of the simulation .",
    "there is a bright point source near pixel 400 ( in fact , it is the brightest source in the simulation ) .",
    "apart from this extraordinarily bright source , the features that dominate the image are galactic emission ( the large peaks around pixels 150 and 940 ) and noise .",
    "the complete set of simulated tod was filtered using the optimal adaptive filter described in section  [ data ] .",
    "each individual ring was filtered separately . the power spectrum that appears in equations ( [ eqfilter ] ) and ( [ integrals ] )",
    "was obtained by averaging the estimated power spectra of twenty - one consecutive rings ( the ring that is being filtered , the ten previous rings and the ten subsequent rings ) .    in order to detect the sources from the filtered image",
    "one can set a certain threshold over the dispersion of the filtered ring and look for connected regions ( peaks ) above that threshold .",
    "that would be the most direct detection method if the different rings were independent of their neighbours .",
    "this is not the case , since adjacent rings scan very close regions and each source is expected to appear in more than one ring .",
    "the use of information coming from neighbouring rings allows to increase the effective signal to noise ratio of the detections and to discard spurious sources due to noise fluctuations .",
    "the most straightforward way to detect sources is then to perform a kind of two - dimensional thresholding , looking for connected pixels at equal latitude that appear _ in several adjacent rings_. in a first approximation , the position of the source will be the position of the maximum of that region of connected pixels .",
    "we will show that this approximation is good enough for the purpose of locating the sources with an error comparable to @xmath41 of the antenna fwhm .",
    "two different regimes of noise have to be removed in order to optimize the detection of the sources .",
    "the large scale features due to galaxy foregrounds as well as cmb fluctuations are strongly correlated between a given ring of data and its neighbours .",
    "on the other hand , the small scale noise , dominated by white instrumental noise , is expected to be nearly independent from one ring to another .",
    "this suggests a further step in the idea of combining information from nearby rings to increase the signal to noise ratio of the sources . by averaging each ring data ( before filtering ) we can construct a synthetic tod in which the large scale fluctuations are almost the same than in the original tod but",
    "the noise at the scale of the pixel has been greatly diminished .",
    "the @xmath38 will still be present in the averaged tod .",
    "the point sources of the original tod are replaced in the averaged tod by gaussians of amplitude @xmath42 where @xmath43 is the true amplitude of the source , @xmath44 is the number of rings that are averaged , @xmath45 is the beam width and the distance @xmath46 is the geodesic ( spherical ) angular distance between the pixel corresponding to the position of the source and the pixel that is being added to calculate the average .",
    "this is true when the beam is a perfect gaussian because in that case the average is a weighted sum of gaussians of equal width , that is , a new gaussian of the same width and amplitude given by eq .",
    "( [ average ] ) .",
    "therefore , we can filter the rather denoised , synthetic tod , instead of the original tod and correct the amplitude of the sources that we will detect using eq .",
    "( [ average ] ) in order to recover an estimate @xmath47 of the true amplitude @xmath43 .",
    "although the planck pipeline simulator uses a realistic beam , we assumed for this work that the beam is a perfect gaussian . in section  [ results ] it will be shown that this approximation works reasonably well .",
    "however , future work should take into account real beams ; the 30 ghz detector is expected to be slightly elliptic .",
    "this asymmetry will introduce complicate effects in the map making and analysis . in the case of tod",
    "the effect of ellipticity , when projected over the scan trajectory , is a change in the ` effective width ' of the beam .",
    "therefore , the scale - adaptive filter should be calculated for such ` effective width ' .",
    "more complicated asymmetries will require more careful treatment .",
    "future work will deal with this issue .",
    "in order to determine the goodness of the averaging of close rings we performed two different filterings of the tod . in the first case ,",
    "the raw data of the tod were filtered ring by ring as described in the section  [ analysis ] . in the second case , a synthetic tod in which each individual ring was the average of the original ring ( at that position ) with the twelve neighbours was constructed .",
    "the number of rings averaged is such that at the maximum ring spatial separation region on the sky ( the ecliptic equator ) the separation between the two most separated rings is approximately equal to the fwhm of the beam . after filtering ,",
    "the detection and extraction was performed looking for sets of 5 or more connected pixels ( in the 2-dimensional sense ) .",
    "a lesser number of connected pixels required would lead to a much higher number of spurious detections . to check",
    "if the detections correspond to real sources we compare with the catalogue of the 1000 brightest sources present in the simulations .",
    "this catalogue is complete and its flux limit is clearly lower than the expected flux limit of the detected sources .    in the lower panel of figure  [ fig3 ]",
    "the number of detections ( defined as the number of peaks encountered above a certain threshold that correspond to a real source in the reference catalog ) above several @xmath5 thresholds is shown for the case where the data have been averaged ( filled circles and solid line ) and the case where they have not ( open circles and dashed line ) .",
    "the remaining quantities of interest ( such as estimation of the amplitudes , fluxes , etc . ) concerning the detection / extraction of sources over the averaged and then filtered tod are shown in table  [ tb1 ] and will be discussed later .",
    "as expected , the number of sources detected when analysing the synthetic tod is 4 to 5 times higher to the number of sources detected over the original , filtered tod for every @xmath5 level .",
    "c c c c c c c c @xmath5 & detected & spurious & mean offset & m.r.a.e . &",
    "@xmath48 & min .",
    "flux & compl .",
    "flux + & sources & sources & ( @xmath49 ) & ( @xmath50 ) & ( @xmath50 ) & ( jy ) & ( jy ) +   +   +   + 2.5 & 549 & 1368 & 14.08 & 24.22 & 3.15 & 0.542 & 4.337 + 3.0 & 403 & 296 & 13.56 & 24.32 & 1.31 & 0.644 & 4.337 + 3.5 & 351 & 54 & 12.73 & 21.75 & -4.91 & 0.760 & 4.337 + 4.0 & 224 & 22 & 12.49 & 20.98 & -7.69 & 0.885 & 4.337 + 5.0 & 150 & 9 & 12.20 & 19.82 & -14.85 & 1.065 & 4.337 + 5.5 & 124 & 5 & 12.03 & 20.38 & -15.54 & 1.197 & 4.337 +   +   +   + 2.5 & 11 & 11 & 18.88 & 538.4 & 537.0 & 6.511 & 17.070 + 3.0 & 7 & 6 & 17.84 & 746.4 & 744.2 & 8.787 & 10.070 + 3.5 & 7 & 13 & 17.50 & 898.1 & 898.1 & 7.908 & 18.866 + 4.0 & 4 & 11 & 17.24 & 1281.7 & 1281.7 & 10.340 & 18.866 + 5.0 & 4 & 12 & 13.09 & 1985.3 & 1985.3 & 13.926 & 18.866 + 5.5 & 4 & 15 & 13.09 & 1985.3 & 1985.3 & 13.926 & 18.866 +   +   +   + 2.5 & 473 & 413 & 12.83 & 21.46 & 4.27 & 0.531 & 4.337 + 3.0 & 361 & 130 & 12.66 & 20.76 & 2.52 & 0.693 & 4.337 + 3.5 & 270 & 63 & 12.67 & 20.46 & 0.45 & 0.761 & 4.337 + 4.0 & 196 & 59 & 12.40 & 18.47 & -4.22 & 0.844 & 4.337 + 5.0 & 139 & 49 & 12.50 & 19.47 & -4.96 & 0.957 & 4.337 + 5.5 & 118 & 44 & 12.41 & 19.83 & -5.53 & 1.099 & 4.337 +    apart from having the greatest number of detections , it is also of great importance to reduce as much as possible the number of spurious detections . in the lower panel of figure  [ fig4 ] ( labeled as",
    "simple detection ) the ratio between spurious and true detections is represented for the case where the data have been averaged ( filled circles and solid line ) and the case where they have not ( open circles and dashed line ) .",
    "the ratio is lower for the case in which the data have not been averaged .",
    "it is evident that a kind of compromise has to be reached between gain and reliability .",
    "if we arbitrarily set a maximum proportion of spurious sources versus true ones , say a @xmath4 ( represented in fig .",
    "[ fig4 ] with an horizontal dashed line ) , we can determine the minimum @xmath5 level that satisfies this condition .",
    "in this example , for the case of non - averaged rings , we can reach the @xmath51 and find 80 sources ( to a minimum flux of 4.33 jy ) with a @xmath52 of spurious detections .",
    "for the case of averaged rings , we must go to the @xmath0 level , where we find 224 sources ( to a minimum flux of 0.885 jy ) with a @xmath53 of spurious detections .",
    "we conclude that the averaging of neighbouring rings is a valid strategy to reduce pixel - scale noise . in the following",
    ", all the results will refer to filtering of averaged rings .",
    "the number of detections and spurious sources found with the optimal adaptive filter applied to a synthetic tod is shown in table  [ tb1 ] . the determination of the position of the source , the mean relative absolute error in the determination of the amplitude ( defined as @xmath54 , where @xmath55 is the estimated amplitude and @xmath56 is the real amplitude ) , the mean bias ( defined in the same way as the m.r.a.e , but without the absolute value ) , the minimum flux reached and the completeness flux",
    "are also included in table  [ tb1 ] . in each case",
    "the mean error in the position of the sources is comparable with the size of the pixel of the tod , @xmath57 .",
    "the determination of the amplitude using eq .",
    "( [ average ] ) has relative errors ranging from @xmath58 at @xmath51 threshold to @xmath59 at @xmath60 .",
    "the error decreases as the detection threshold increases .",
    "this indicates that the estimation of the amplitude of weak sources is less accurate than the estimation of the amplitude of bright ones .",
    "also , the determination of the amplitude is biased to higher values at low @xmath5 levels and to lower values ( negative bias ) at high @xmath5 levels .",
    "the positive bias for weak sources arises due to the peak finding algorithm : it finds preferently the maxima in pixels where the noise contribution is positive .",
    "let us consider for a while the possible causes for the mentioned bias and how to deal with it .",
    "scale - adaptive filter is designed to be an unbiased estimator of the amplitude of the sources .",
    "thus , _ the method is unbiased_. however , in practise it is found a small bias .",
    "the origin of this bias can be found in two different kind of effects . on the one hand ,",
    "the bias introduced by the detection method : this bias was described in the last paragraph and is related with the well - known ` detection bias ' . on the other hand , bias may arise due to the non - ideality of the data . in first place ,",
    "the profiles considered in the design of the filters are continuous whereas real data is pixelised .",
    "therefore , the correlation between the ( continuous ) filter and the ( pixelised ) source profile is not perfect , this resulting in a non - ideal performance of the filter . in second place ,",
    "the limits in the integrals ( [ integrals ] ) are from @xmath30 to @xmath31 , whereas in real data the frequencies are limited by the sizes of the data set and the pixel .",
    "therefore , integrals ( [ integrals ] ) can only be approximately calculated .",
    "this leads to an inaccuracy in the determination of the shape of the filter and , more important for the bias , the _ normalization _ ( the @xmath61 in the mentioned integrals ) .",
    "another source of bias appears when the assumption about the profile of the sources is wrong .",
    "for example , we have assumed that the detector beam is gaussian , while in fact it is not ; this could explain the bias in our results .",
    "in so1 it was found using simple simulations that the bias due to the non - ideality of the data was negative .",
    "similarly , the negative bias that appear here is interpreted in the way described above . in practise",
    ", it is difficult to distinguish from the data the different contributions to the bias among the ones above mentioned . a possibility to overcome",
    "the bias is to calibrate it using a great number of simulations with the same background and artificial sources of known amplitude .",
    "once removed the ` systematic ' bias , the remaining error will be statistical .",
    "this kind of study will be carried on in a future work .    in the case",
    "we are considering the bias is never greater than @xmath62 . at intermediate thresholds ,",
    "the ( positive ) effects of detection bias and the non - ideality of the data ( negative ) tend to cancel and , _ on average _ , the amplitude estimates are unbiased . to compare with other classical filters we repeated the process using a gaussian filter and a mexican hat wavelet ( mhw , hereafter ) , both of them with a width equal to the beam width of the antenna ( @xmath63 ) .",
    "the normalization of both filters was chosen so that the coefficient at the position of the source is equal to the amplitude of the source ( that is , the filtering process does not change the amplitude of the sources ) .",
    "the adaptive filter automatically satisfies this condition ( condition 2 for an optimal adaptive filter ) . while the mhw and the optimal adaptive filters are both band - pass filters , the gaussian is a low - pass filter , so the comparison with the gaussian is a bit unfair : the gaussian is expected to perform significantly worse than the other two filters .",
    "the number of detections above several thresholds for the two classical filters together with the optimal adaptive filter are shown in table  [ tb1 ] .",
    "the number of detections is similar for the mhw and the optimal adaptive filter , yet are slightly higher for the optimal adaptive filter .",
    "the lowest number of detections corresponds to the gaussian filter . in the lower panel of figure  [ fig5 ]",
    "the number of detections with the three different filters is compared .",
    "detections with the optimal adaptive filter are shown with open circles and solid line .",
    "the open boxes and dashed line corresponds to mhw detections and the triangles and dashed line corresponds to gaussian filter detections .",
    "the ratio between spurious and true detections for the three filters is shown in the top panel of figure  [ fig5 ] .",
    "except for the @xmath64 level , the gaussian filter produces the worst ratio .",
    "the optimal adaptive filter gives spurious to detected ( @xmath65 ) ratios that quickly decline with increasing @xmath5 thresholds .",
    "the @xmath65 ratio for the mhw remains almost constant with @xmath5 in the considered cases and clearly exceeds the ratio obtained with the optimal adaptive filter .",
    "the m.r.a.e . and the bias in the determination of the amplitude are huge in the case of the gaussian filter .",
    "both have very similar values .",
    "that means that the main source of error is systematic ( the filter is biased ) .",
    "considering the m.r.a.e , the mhw seems to give amplitude estimates a few percent better than the optimal adaptive filter .",
    "flux limits are similar in the mhw and optimal adaptive filter cases .",
    "the gaussian filter leads to higher inferior flux and completeness limits .",
    "figure  [ fig2 ] provides a useful insight into what is happening with the different filters .",
    "the gaussian filter smoothes the image , removing very efficiently the small scale noise but allowing the large structures ( the galaxy and others extended fluctuations ) to remain in the image .",
    "the naive @xmath5 thresholding counts these bright , large structures as sources , leading to a big relative number of spurious detections .",
    "besides , the sources that by chance lie on valleys of the background can not be detected . on the other hand , sources that lie on areas of positive background are enhanced and can be more easily detected .",
    "this can explain the large and positive bias in the detections with the gaussian filter .",
    "both mhw and optimal adaptive filter are better prepared to deal with this problem than the gaussian window .",
    "their profiles in fourier space drop to zero at low frequencies and thus they are efficient in removing large scale structures .",
    "images filtered with the mhw and the optimal adaptive filter in figure  [ fig2 ] are similar .",
    "a visual inspection reveals that mhw smoothes better the high - frequency fluctuations .",
    "the optimal adaptive filter is more efficient in removing medium and large structures .",
    "the fluctuations around pixel 150 ( corresponding to one of the two observations of the galaxy in the ring ) are better removed with the optimal adaptive filter than with the mhw .",
    "this is more apparent in figure  [ fig1 ] where the profiles of the different filters in fourier space clearly indicate the faster drop of the adaptive filter at low frequencies ( large scales ) and its slower drop at high frequencies ( small scales ) .",
    "the mhw can have the same problem as the gaussian filter .",
    "however , the probability of this problem should be smaller due to its better efficiency in removing the galaxy and other large - scale structures .",
    "this effect explains the higher @xmath65 ratio and the trend to positive bias .",
    "we conclude that the optimal adaptive filter detects point sources better than the mhw and the gaussian window .",
    "the number of detections is comparable to the number of detections with the mhw and clearly higher than with the gaussian window .",
    "the relative number of spurious detections with the optimal adaptive filter is lower , except for very low detection thresholds , than with the mhw and the gaussian window . over @xmath0",
    "the contamination of spurious detections is lower than @xmath4 . at this level ( @xmath0 ) the number of expected sources in all the sky is of a few hundreds ( 224 in our simulation ) above fluxes of around 0.9 jy .",
    "some tests can be performed in order to discover if the number of spurious sources , the most unpleasant effect of the filtering and detection process , can be reduced .",
    "where do these spurious detections come from ?",
    "one possibility is that the peak finding algorithm is detecting the galaxy or other large - scale features .",
    "such structure will appear in several adjacent rings , as sources do , and therefore a possibility of confusion exists . to test this potential source of contamination , we repeated the analysis excluding a band of @xmath66 centered on the galactic plane ( corresponding to a @xmath67 of the sky area ) .",
    "the top panels of figures  [ fig3 ] and  [ fig4 ] show the number of detections and the ratio of spurious / true detections , respectively , for the optimal adaptive filter in the cases where the rings have been averaged ( as explained before , filled circles ) and where they have not ( open circles ) . in the first section of table  [ tb2 ] are the results for the case of averaged rings ( the tabulated quantities are the same than in table  [ tb1 ] ) are shown .",
    "the decrease in the number of detections corresponds to the one expected for a uniform distribution of sources in the sky ( around @xmath68 ) .",
    "this indicates that the density of detections around the galactic plane is not substantially different from the density of detections in other regions , less contaminated , of the sky .",
    "this can be seen in figure  [ fig6 ] , where the @xmath0 detections have been represented in galactic coordinates ( the galactic plane being represented by a dashed line ) .",
    "the ratio between spurious and true detections remains almost untouched for low @xmath5 .",
    "for higher @xmath5 levels , the proportion of spurious detections that are due to the galactic plane increases dramatically ( comparing tables  [ tb1 ] and  [ tb2 ] we see that this proportion increases from a @xmath69 at @xmath64 to a @xmath70 at @xmath71 ) .",
    "this indicates that the contamination by the galaxy dominates at high signal to noise ratios , whereas low - intensity contamination is dominated by noise fluctuations . in all cases ,",
    "the number of peaks that correspond to the galaxy is much smaller than the number of detected sources , thus implying that the optimal adaptive filter deals efficiently with large scale backgrounds .",
    "c c c c c c c c @xmath5 & detected & spurious & mean offset & m.r.a.e . &",
    "@xmath72 & min .",
    "flux & compl .",
    "flux + & sources & sources & ( @xmath49 ) & ( @xmath50 ) & ( @xmath50 ) & ( jy ) & ( jy ) +   +   +   + 2.5 & 520 & 1272 & 14.06 & 23.79 & 2.67 & 0.542 & 13.722 + 3.0 & 379 & 257 & 13.51 & 23.69 & 0.58 & 0.644 & 13.722 + 3.5 & 280 & 34 & 12.67 & 20.87 & -6.04 & 0.760 & 13.722 + 4.0 & 212 & 8 & 12.45 & 20.05 & -8.97 & 0.885 & 13.722 + 5.0 & 142 & 1 & 12.16 & 18.73 & -16.25 & 1.066 & 13.722 + 5.5 & 118 & 1 & 11.94 & 18.97 & -17.22 & 1.197 & 13.722 +   +   +   + 2.5 & 454 & 347 & 12.76 & 20.21 & 2.79 & 0.531 & 13.72 + 3.0 & 342 & 87 & 12.54 & 19.04 & 0.42 & 0.693 & 13.72 + 3.5 & 256 & 25 & 12.49 & 18.28 & -2.37 & 0.806 & 13.72 + 4.0 & 187 & 14 & 12.15 & 15.71 & -7.65 & 0.844 & 13.72 + 5.0 & 129 & 7 & 12.18 & 15.07 & -10.64 & 0.957 & 13.72 + 5.5 & 108 & 7 & 12.01 & 14.60 & -12.37 & 1.099 & 13.72 +    we stated before that the higher number of spurious detections of mhw could be due to its non - optimal performance at large scales . to further test this hypothesis we repeated the test for the mhw , now considering only the peaks found outside a @xmath73 band centered in the galactic plane , as we did with the optimal adaptive filter before .",
    "the results are shown in the last section of table  [ tb2 ] .",
    "most of the spurious sources ( specially at high @xmath5 ) lied near the galactic plane , as we expected .",
    "and yet the remaining number of spurious sources is still greater than in the equivalent optimal adaptive filter case .",
    "the number of detections and the flux limits remain similar to the optimal adaptive filter case .",
    "the m.r.a.e .",
    "is also similar in the two cases .",
    "finally , the mean bias in the determination of the amplitude is negative for high @xmath5 thresholds , as happens with the optimal adaptive filter .",
    "note that the mhw used in this work has the same scale as the antenna .",
    "in fact , that scale is not the optimal for detection ( vielva et al .",
    "the optimal scale of the mhw for a particular case has to be determined from the power spectrum of the data .",
    "this in a certain way mimics the determination of the optimal scale @xmath74 _ that is automatically included _ in the optimal adaptive filter via eqs .",
    "( [ eqfilter ] ) and ( [ integrals ] ) .",
    "the mhw at its optimal scales resembles the shape of the optimal adaptive filter in fourier space ( in the sense that its maximum is located near the maximum of the optimal adaptive filter ) and thus the effectiveness of both filters should be similar .    in order to further decrease the number of spurious detections ,",
    "we could take advantage of the fact that , in many realistic cases , due to the sky coverage of the experiment and its scanning strategy , many positions of the sky can be measured more than once ( that is , at different epochs ) . for example",
    ", a source of @xmath75 latitude will be detected once when the center of the ring is located on longitude @xmath76 , being @xmath20 the radius of the ring , and once again several months later , when the center of the ring is located on longitude @xmath77 .",
    "when this occurs , it would be possible to almost duplicate the amount of information in some areas of the sky and therefore improve both the sensitivity and the reliability of the detection .",
    "however , such a refined detection can not be done when the data do not cover the whole sky , and therefore is useless for the construction of an early catalogue of sources during the mission s flight .",
    "we have simulated and analysed a sequence of time ordered data such as the one that the future planck 30 ghz lfi28 channel will produce after the first 6 months of flight .",
    "the data include all the main foregrounds as well as cmb fluctuations , point sources and instrumental noise .",
    "the resulting tod has been ring - averaged in order to remove pixel - scale noise and then filtered with an optimal adaptive filter that includes the spectral properties of the data in order to maximize the detection of sources of a particular shape ( gaussian ) and scale ( the scale of the antenna ) .",
    "the optimal adaptive filter was designed to produce an unbiased , efficient estimator of the amplitude of the sources at their position and to give a maximum of detections at the characteristic scale of the sources .",
    "the detection of the sources was performed by thresholding the filtered tod and looking for connected sets of peaks belonging to adjacent rings . at a @xmath0 detection level 224",
    "sources over a flux of 0.88 jy are detected with a mean relative error ( in absolute value ) of @xmath78 and a systematic bias of @xmath79 .",
    "the position of the sources in the sky is determined with errors inferior to the size of the antenna .",
    "the catalogue of detected sources is complete at fluxes @xmath3 4.337 jy .",
    "the number of spurious detections is 22 .",
    "the performance of the optimal adaptive filter has been compared with the performances under the same conditions of a gaussian window and a mexican hat wavelet ( mhw ) of width equal to the beam width .",
    "the number of sources detected with the optimal adaptive filter is comparable to the number of sources detected with the mhw and much higher than the number of sources detected with the gaussian .",
    "however , the optimal adaptive filter finds a significantly lower number of spurious sources than the other two filters .",
    "this is due to the fact that the optimal adaptive filter removes better the large scale fluctuations ( e.g. the galaxy ) than the other two filters . to test this hypothesis a @xmath66 band around the galactic plane",
    "was removed and the analysis was repeated with the optimal adaptive filter and the mhw .",
    "this test shows that most of the spurious detections that were found with the mhw were located on the galactic plane , whereas spurious detections that were found with the optimal adaptive filter are uniformly distributed in the sky .",
    "the mean absolute error in the determination of amplitudes is slightly higher in the case of the optimal adaptive filter than in the mhw case .",
    "the estimation of the amplitudes with the gaussian window suffer from very large errors . in most cases ,",
    "the gaussian detects only the galaxy .",
    "the number of spurious detections can be reduced by means of further analysis after the filtering .",
    "for example , when the sky coverage of the scan is big enough some areas of the sky can be observed twice or more times , increasing the signal to noise ratio of the sources that lie in such areas .",
    "this point is out of the scope of the present work , in which we only present the filter as a first step in the data reduction .    in conclusion ,",
    "the optimal adaptive filter is an efficient , unbiased and reliable tool for the detection and extraction of punctual sources from tod .",
    "a few hundred of sources over 1 jy will be detected in the 30 ghz channels of the future planck mission with @xmath80 of spurious detections .",
    "the catalogue will be complete at fluxes @xmath81 jy .",
    "one possible application of this technique would be the elaboration of early catalogues of sources . a greater number of detections is expected at higher frequencies .",
    "the simulation and analysis of such frequencies will be performed in a future work .",
    "the authors strongly appreciate all the comments , suggestions and careful reading done by matthias bartelmann and fabio pasian .",
    "the tod used in this work for point source detection was generated by the planck pipeline simulator of the dpc level - s .",
    "the sky simulations , pointings and other data is available for the planck consortia at http://www.mpa-garching.mpg.de/simdata .",
    "we specially thank matthias bartelmann and klaus dolag for their help in the generation of the simulations and their support during this work .",
    "the work presented here has used extensively the software package healpix ( hierarchical , equal area and iso - latitude pixelisation of the sphere ) ; we thank the developing group : krzysztof m. gorski , e.f .",
    "hivon , benjamin d. wandelt , antony j. banday , f.k .",
    "hansen and matthias bartelmann .",
    "the healpix package is available at this address : http://www.eso.org/science/healpix    we thank laura cayn and patricio vielva for useful suggestions and comments .",
    "dh acknowledges support from a spanish mec fpu fellowship .",
    "we thank feder project 1fd97 - 1769-c04 - 01 , spanish dgesic project pb98 - 0531-c02 - 01 and intas project intas - open-97 - 1192 for partial financial support .",
    "baccigalupi , c. , bedini , l. , burigana , c. , de zotti , g. , farusi , a. , maino , d. , maris , m. , perrotta , f. , salerno , e. , toffolatti , l. , & tonazzini , a. , 2000 , mnras , 318 , 769 .",
    "bennett , c. et al .",
    "1996 , map homepage http://map.gsfc.nasa.gov bouchet , f.r . & gispert , r. 1999 , new astronomy vol .",
    "4 , no . 6 , 443 .",
    "cayn , l. , sanz , j.l . ,",
    "barreiro , r.b .",
    ", martnez - gonzlez , e. , vielva , p. , toffolatti , l. , silk , j. , diego , j.m . & argeso , f. 2000 , mnras , 315 , 757 .",
    "hobson , m.p . ,",
    "jones , a.w . ,",
    "lasenby , a.n . & bouchet , f.r .",
    "1998 , mnras , 300 , 1 .",
    "hobson , m.p . ,",
    "barreiro , r.b . ,",
    "toffolatti , l. , lasenby , a.n . ,",
    "sanz , j.l .",
    ", jones , a.w . , & bouchet , f.r .",
    "1999 , mnras , 306 , 232 .",
    "mandolesi , n. et al .",
    "1998 , proposal submitted to esa for the planck low frequency instrument .",
    "maino d. , farusi a. , baccigalupi c. , perrotta f. , banday a.j . , bedini l. , burigana c. , de zotti g. , gorski k.m . , salerno e. , 2001 , mnras submitted , astro - ph/0108362 puget , j.l .",
    "1998 , proposal submitted to esa for the planck high frequency instrument .",
    "sanz , j.l . ,",
    "herranz , d. and martnez - gonzlez , 2001 , apj , 552 , 484s .",
    "stolyarov , v. , hobson , m.p . , ashdown , m.a.j . and",
    "lasenby , a.n .",
    "2001 , submitted to mnras , astro - ph/0105432 .",
    "tegmark , m. & efstathiou , g. 1996 , mnras , 281 , 1927 .",
    "tegmark , m. & oliveira - costa , a. 1998 , apj , 500 , 83 .",
    "toffolati , l. , argeso , f. , de zotti , g. , mazzei , p. , franceschini , a. , danese , l. and burigana , c. 1998 , mnras , 297 , 117 .",
    "vielva , p. , martnez - gonzlez , e. , cayn , l. , diego , j.m . ,",
    "sanz , j.l . & toffolatti , l. , 2000 , mnras , 326 , 181 .",
    "vielva , p. , barreiro , r.b . ,",
    "hobson , m.p . , martnez - gonzlez , e. , lasenby , a.n . ,",
    "sanz , j.l . & toffolatti , l. , 2000 , mnras , accepted ."
  ],
  "abstract_text": [
    "<S> wavelet - related techniques have proven useful in the processing and analysis of one and two dimensional data sets ( spectra in the former case , images in the latter ) . in this work </S>",
    "<S> we apply adaptive filters , introduced in a previous work ( sanz et al . </S>",
    "<S> 2001 ) , to optimize the detection and extraction of point sources from a one - dimensional array of time - ordered data such as the one that will be produced by the future 30 ghz lfi28 channel of the esa planck mission . at a @xmath0 detection level 224 </S>",
    "<S> sources over a flux of 0.88 jy are detected with a mean relative error ( in absolute value ) of @xmath1 and a systematic bias of @xmath2 . </S>",
    "<S> the position of the sources in the sky is determined with errors inferior to the size of the pixel . </S>",
    "<S> the catalogue of detected sources is complete at fluxes @xmath3 4.3 jy . </S>",
    "<S> the number of spurious detections is less than a @xmath4 of the true detections . </S>",
    "<S> we compared the results with the ones obtained by filtering with a gaussian filter and a mexican hat wavelet of width equal to the scale of the sources . </S>",
    "<S> the adaptive filter outperforms the other filters in all considered cases . </S>",
    "<S> we conclude that optimal adaptive filters are well suited to detect and extract sources with a given profile embedded in a background of known statistical properties . in the planck case , they could be useful to obtain a real - time preliminary catalogue of extragalactic sources , which would have a great scientific interest , e. g. for follow - up observations .    </S>",
    "<S> methods : data analysis , cosmology : cosmic microwave background </S>"
  ]
}