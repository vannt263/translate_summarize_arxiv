{
  "article_text": [
    "in this paper , we propose a simple general method for the simulation of a one - dimensional diffusion bridge .",
    "our main motivation is that simulation of diffusion bridges plays a fundamental role in simulation - based likelihood inference ( including bayesian inference ) for discretely sampled diffusion processes and other diffusion - type processes like stochastic volatility models .",
    "our approach is based on the following simple way of constructing a process that at time zero starts from @xmath1 and at time @xmath2 ends in @xmath3 , where @xmath1 and @xmath3 are given numbers .",
    "one diffusion process , @xmath4 , is started from the point @xmath1 , while an independent diffusion , @xmath5 , with the same dynamics , is started from the point @xmath3 .",
    "the time of the second diffusion is reversed , so that the time starts at @xmath2 and goes downwards to zero .",
    "suppose the process @xmath4 hits the sample path of the time reversed diffusion @xmath6 , and let @xmath7 denote the first time the two paths intersect .",
    "then the process that for @xmath8 is equal to @xmath4 , and for @xmath9 equals @xmath6 , is obviously a process in the time interval @xmath10 $ ] that starts at @xmath1 and ends at @xmath3 .",
    "conditional on the event that the two processes intersect , we show that the process constructed in this way is indeed an approximation to a realization of a diffusion bridge between the two points .",
    "a simple rejection sampler is thus obtained by repeatedly simulating the two diffusions until they hit each other .",
    "the diffusions can be simulated by means of simple procedures like the milstein scheme , see kloeden and platen @xcite , so the new method is easy to implement for likelihood inference for discretely sampled diffusion processes .",
    "this approximate diffusion bridge is used as proposal for a metropolis ",
    "hastings algorithm that has an exact diffusion bridge as its target distribution .",
    "the algorithm uses the pseudo - marginal approach of andrieu and roberts @xcite and is easy to implement : to calculate the rejection probability , a number of independent diffusions are simulated and it is determined whether or not they intersect the proposed bridge trajectory.=1    diffusion bridge simulation is a highly non - trivial problem that has been investigated actively over the last 1015 years .",
    "a lucid exposition of the problems and the state - of - the - art can be found in papaspiliopoulos and roberts @xcite .",
    "it was previously thought impossible to simulate diffusion bridges by means of simple procedures , because a rejection sampler that tries to hit the prescribed end - point for the bridge ( or a small neighbourhood around it ) will have an excessively high rejection probability .",
    "the rejection sampler presented in this paper has a quite acceptable rejection probability because what must be hit is a sample path rather than a point .",
    "the first diffusion bridge simulation methods in the literature were based on the metropolis ",
    "hastings algorithm with a proposal distribution given by a process that is forced to go from @xmath1 to @xmath3 , see , for example , roberts and stramer @xcite or durham and gallant @xcite .",
    "later beskos , papaspiliopoulos and roberts @xcite developed algorithms for exact simulation of diffusion bridges .",
    "these are rejection sampling algorithms that use in a clever way a measure change and simulation of a brownian bridge , which can easily be simulated . under strong boundedness conditions",
    "the algorithm is relatively simple , whereas it is more complex under weaker condition .",
    "lin , chen and mykland @xcite proposed a sequential monte carlo method for simulating diffusion bridges with a resampling scheme guided by the empirical distribution of backward paths .",
    "the spirit of this approach has similarities to the methods proposed here .",
    "an advantage of the method proposed in the present paper is that the same simple algorithm can be used for all one - dimensional diffusions with a finite speed - measure , and that it is easy to understand and to implement .",
    "it is also worth noting that the method does not require that the diffusion is transformed into one with unit diffusion coefficient .",
    "though such a transformation exists under very general conditions for one - dimensional diffusions , the transformation is not in closed form for many interesting examples .",
    "such a transformation is , for instance , required for the exact algorithm of beskos , papaspiliopoulos and roberts @xcite .",
    "another , and perhaps more important , advantage is that it works particularly well for long time intervals . for ergodic diffusions , the computational complexity of our method",
    "is shown to be linear in the distance between the two end - points of the diffusion bridge .",
    "this is illustrated in a simulation study where the computer time increases linearly with the interval length , while it seems to grow at least exponentially with the interval length for the exact ea algorithms of beskos , papaspiliopoulos and roberts @xcite .",
    "thus , the ea algorithm is likely not to work for long time intervals .",
    "importantly , it is shown that for ergodic diffusions the approximate method proposed here simulates an essentially exact diffusion bridge in long time intervals ( apart from the discretization error ) . for exponentially mixing diffusions , which covers most diffusions used in practice",
    ", the distribution of the simulated process goes to that of a diffusion bridge exponentially fast as a function of the interval length .",
    "thus the proposed method provides a useful supplement to previously published methods because it works particularly well for long time intervals , where the other methods tend not to work .",
    "it is worth noting that simulation - based likelihood inference for discretely sampled diffusions is mainly important for long time intervals , because for short time intervals several simpler methods provide highly efficient estimators , see the following discussion.=1    the main challenge to likelihood based inference for diffusion models is that the transition density , and hence the likelihood function , is not explicitly available and must therefore be approximated . when the sampling frequency is relatively high , which is often the case for financial data , rather crude approximations to the likelihood functions , like those in ozaki @xcite , bollerslev and wooldridge @xcite , bibby and srensen and kessler @xcite , give estimators with a high efficiency .",
    "this follows from results based on high frequency asymptotics in srensen @xcite .",
    "when the interval between the observation times is relatively long , more accurate approximations to the transition density are needed .",
    "one approach is numerical approximations , either by solving the kolmogorov pde numerically , for example , poulsen @xcite and hurn , jeisman and lindsay , or by expansions , for example , at - sahalia @xcite and forman and srensen @xcite .",
    "alternatively , likelihood inference can be based on simulations , an approach that goes back to the seminal paper by pedersen @xcite , whose method is , however , computationally costly because he did not use bridge simulation .",
    "the inference problem can be viewed as a missing data problem .",
    "if the diffusion process had been observed continuously , the likelihood functions would be explicitly given by the girsanov formula , but the diffusion has been observed at discrete time points only , so the continuous - time paths between the observation points can be considered as missing data . this way of viewing the problem , which goes back to dacunha - castelle and florens - zmirou @xcite , makes it natural to apply either the em - algorithm or the gibbs sampler .",
    "to do so , it is necessary to simulate the missing continuous paths between the observations conditional on the observations , which is exactly simulation of diffusion bridges .",
    "it was a significant break - through when this was simultaneously realized by several authors , see roberts and stramer @xcite , elerian , chib and shephard @xcite , eraker @xcite and durham and gallant @xcite , and approaches based on bridge simulation has since been used by several authors including golightly and wilkinson , beskos , papaspiliopoulos and roberts @xcite , delyon and hu , beskos , papaspiliopoulos and roberts @xcite and lin",
    "_ et al_. @xcite . to illustrate how our bridge simulation method can be used for likelihood inference , we modify an em - algorithm in beskos , papaspiliopoulos , roberts and fearnhead @xcite by using our simple simulation method.=1    diffusion bridge simulation is also crucial to simulation - based inference for other types of diffusion process data than discrete time observations .",
    "chib , pitt and shephard @xcite presented a general approach to simulation - based bayesian inference for diffusion models when the data are discrete time observations of rather general , and possibly random , functionals of the continuous sample path , see also golightly and wilkinson .",
    "this approach covers for instance diffusions observed discretely with measurement error and discretely sampled stochastic volatility models . in this approach too , the underlying continuous time diffusion process must be simulated conditionally on the observations , which is done by a metropolis ",
    "hastings algorithm .",
    "the algorithm mixes badly if the entire sample path is updated simultaneously , so the interval is divided into random subintervals that are updated sequentially .",
    "the sample path in a subinterval must be simulated conditionally of the values of the diffusion in the other intervals , which by the markov property is diffusion bridge simulation given the values at the end - points .",
    "this method can be modified by using the bridge simulation method proposed here .",
    "baltazar - larios and srensen @xcite presented an em - algorithm for integrated diffusions observed discretely with measurement error based on the ideas in chib _",
    "et al_. @xcite , but using the bridge simulation method of the present paper , and showed that the method worked well in simulation studies .",
    "we shall briefly review the results of this paper.=1    the paper is organized as follows . in section  [ sec2 ] , we first present the new approximate bridge simulation method and show in what sense it approximates a diffusion bridge",
    ". then results are given about exactness and small rejection probabilities for long time intervals .",
    "finally , the approximate bridges are used as proposal in a metropolis ",
    "hastings algorithm that has an exact diffusion bridge as its target distribution . in section  [ sim",
    "] , the approximate bridge simulation method is compared to exact simulation methods in two examples , the ornstein  uhlenbeck process and the hyperbolic diffusion .",
    "the study indicates that our method provides a very accurate approximation to the distribution of a diffusion bridge , except for bridges that are very unlikely to occur when using the method for likelihood inference .",
    "an em - algorithm for discretely observed diffusions based on the proposed bridge simulation method is briefly presented in section  [ sec4 ] .",
    "it is demonstrated how the algorithm simplifies for an exponential family of diffusions ( i.e. , when drift is linear in the parameters ) . in this case ,",
    "bayesian inference is considered too .",
    "finally , an application of the proposed method to estimation for discretely observed integrated diffusions with measurement errors in baltazar - larios and srensen @xcite is briefly reviewed .",
    "section  [ sec5 ] concludes .",
    "let @xmath11 be a one - dimensional diffusion given by the stochastic differential equation @xmath12 where @xmath13 is a wiener process , and where the coefficients @xmath14 and @xmath15 are sufficiently regular to ensure that the equation has a unique weak solution that is a strong markov process .",
    "let @xmath1 and @xmath3 be given points in the state space of @xmath16 .",
    "we present a method for simulating an approximation to a sample path of @xmath16 such that @xmath17 and @xmath18 . a solution of ( [ basicsde ] ) in the interval @xmath19 $ ] such that @xmath20 and @xmath21 will be called a @xmath22-bridge .",
    "when @xmath23 and @xmath24 , we sometimes simply call it an @xmath25-bridge",
    ". we will denote the transition density of @xmath16 by @xmath26 .",
    "specifically , the conditional density of @xmath27 given @xmath28 is @xmath29 .",
    "the state space of @xmath16 is denoted by @xmath30 where @xmath31 .",
    "let @xmath32 and @xmath33 be two independent standard wiener processes , and define @xmath34 and @xmath35 as the solutions to @xmath36 the main idea of the paper is to realize an approximation to a @xmath37-bridge by simulating the process @xmath34 from @xmath1 forward in time , and @xmath35 from @xmath3 backward in time starting at time @xmath38 . if the samples paths of the two processes intersect , they can be combined into a realization of a process that approximates a @xmath37-bridge .",
    "thus to simulate an approximate diffusion bridge in the interval @xmath39 $ ] , we can use any of the several methods available to simulate the diffusions @xmath34 and @xmath35 , see , for example , kleoden and platen @xcite .",
    "let @xmath40 , @xmath41 and @xmath42 , @xmath41 be ( independent ) simulations of @xmath34 and @xmath35 in @xmath39 $ ] with step size @xmath43 .",
    "then a simulation of an approximation to a @xmath37-bridge is obtained by the following rejection sampling scheme .",
    "keep simulating @xmath44 and @xmath45 until the sample paths cross , that is , until there is an @xmath46 such that either @xmath47 and @xmath48 or @xmath49 and @xmath50 .",
    "once a trajectory crossing has been obtained , define @xmath51 where @xmath52 if @xmath53 , and @xmath54 if @xmath55 .",
    "then @xmath56 approximates a @xmath37-bridge under the condition of theorem  [ diffusionbridge ] . on top of the usual influence of the step size @xmath57 on the quality of the individual simulated trajectories",
    ", the step size also controls the probability that a trajectory crossing is not detected .",
    "therefore , it is advisable to choose @xmath57 smaller than usual .",
    "the rejection probability ( the probability of no trajectory crossing ) depends on the drift and diffusion coefficients , on the values of @xmath1 and @xmath3 , and on the length of the interval @xmath38 .",
    "it is shown below that for ergodic diffusions the rejection probability is small when @xmath38 is large ( theorem  [ rejectionprob ] ) .",
    "simulation studies in section  [ sim ] indicate that the number of rejections is small when @xmath1 and @xmath3 are not very far apart .",
    "when the simulation algorithm is used to make likelihood inference for discretely observed diffusion processes ( section  [ sec4 ] ) , this is the typical situation for relatively frequent sampling times , and as just noted , there are in general few rejections when an ergodic diffusion has been sampled at a low frequency .",
    "the distribution of the process that is simulated by the algorithm above and the sense in which it is an approximation of a diffusion bridge is seen from the following theorem , where @xmath58 is the density of the speed measure of the diffusion . here",
    "@xmath59 is an arbitrary point in the state space @xmath30 .",
    "[ diffusionbridge ] let @xmath60 ( @xmath61 ) and define @xmath62 assume that @xmath63 then the distribution of @xmath64 , conditional on the event @xmath65 , equals the distribution of a @xmath37-bridge , conditional on the event that the bridge is hit by an independent diffusion with stochastic differential equation ( [ basicsde ] ) and initial distribution with density @xmath66 .    before proving theorem  [ diffusionbridge ]",
    ", we prove a lemma on the distribution of a time - reversed diffusion .",
    "quite generally , the density ( [ speed ] ) of the speed measure for any one - dimensional diffusion satisfies the balance equation @xmath67 see ito and mckean @xcite , page 149 . under the condition ( [ finitespeed ] )",
    "that the speed measure is finite , an invariant probability measure exists and has the density function @xmath68    [ lemmafundamental ] define the time - reversed process @xmath69 by @xmath70 .",
    "the process @xmath69 and the conditional process @xmath71 given that @xmath18 have the same transition densities @xmath72 assume that ( [ finitespeed ] ) holds .",
    "then the distribution of @xmath73 is equal to the conditional distribution of the process @xmath71 with @xmath74 given that @xmath18 .",
    "the second identity in ( [ bridgetransition ] ) follows from ( [ balance ] ) .",
    "the first expression for @xmath75 is the well - known expression for the transition density of a diffusion bridge ending in @xmath3 at time 1 , see fitzsimmons , pitman and yor @xcite , page 111 .",
    "it can be easily established by direct calculation . the second expression for @xmath75",
    "can similarly be obtained as the transition density of @xmath76 by direct calculation .",
    "the conditional density of @xmath77 given @xmath78 ( @xmath79 ) is @xmath80    now suppose that ( [ finitespeed ] ) holds , and assume that @xmath81 .",
    "then @xmath82 , and the joint density of @xmath83 is @xmath84 , again by ( [ balance ] ) .",
    "hence , the conditional density of @xmath85 given @xmath18 is @xmath86 .",
    "obviously , the density of @xmath87 is @xmath88 , so the process @xmath69 and the conditional process @xmath71 given that @xmath18 have the same transition densities and the same initial distribution .",
    "therefore , they have the same distribution .",
    "note that the results of lemma  [ lemmafundamental ] hold for a multivariate diffusion too , provided that a function @xmath89 exists such that @xmath90 .",
    "diffusions with this property are called @xmath89-symmetric , see the discussion in kent @xcite .",
    "the second assertion of the lemma holds provided that @xmath89 is an integrable function on the state space .",
    "proof of theorem  [ diffusionbridge ] let @xmath91 be a standard wiener processes independent of @xmath32 , and let @xmath92 be the solution of @xmath93 where the distribution of @xmath94 has the density @xmath95 given by ( [ invdensity ] ) .",
    "finally , let @xmath0 be the first time the diffusion @xmath92 hits the sample path of @xmath34 .",
    "define a process by @xmath96 on @xmath97 , and @xmath98 on @xmath99 . by the strong markov property @xmath100",
    "has the same distribution as @xmath34 .",
    "from now on , we condition on @xmath101 . since @xmath102 the theorem follows because by lemma  [ lemmafundamental ] the distribution of @xmath103 equals that of @xmath104 conditional on @xmath101 , so that @xmath105 .",
    "the event @xmath106 is the event that @xmath100 is a @xmath37-diffusion bridge and that the diffusion bridge is hit by @xmath92 , which under the condition @xmath101 has the initial distribution @xmath107 ( see the proof of lemma  [ lemmafundamental ] ) .    by symmetry , we see that the distribution of the process @xmath108 defined by @xmath109 where @xmath110 , is that of a @xmath37-bridge conditional on the event that the bridge is hit by @xmath111 , where @xmath92 is an independent diffusion with stochastic differential equation ( [ basicsde ] ) and initial distribution with density @xmath112 . here",
    "we use @xmath34 until the last time it crosses the trajectory of @xmath113 , which happens at time @xmath114 .",
    "obviously , an approximate diffusion bridge can also be simulated by using @xmath108 .",
    "we can consider the diffusions , diffusion bridges and the approximate diffusion bridge @xmath115 as elements of the canonical space , @xmath116 , of continuous functions defined on the time interval @xmath39 $ ] .",
    "each of these processes induce a probability measure on the usual sigma - algebra generated by the cylinder sets .",
    "let @xmath117 denote the radon  nikodym derivative of the distribution of the @xmath37-diffusion bridge with respect to a dominating measure .",
    "the diffusion bridge solves a stochastic differential equation with the same diffusion coefficient as in ( [ basicsde ] ) , see , for example , ( 4.4 ) in papaspiliopoulos and roberts @xcite , so the density @xmath117 is given by girsanov s theorem . since the drift for the bridge is unbounded at the end point , one has to choose the dominating measure carefully : it must correspond to another bridge , see papaspiliopoulos and roberts @xcite , page 322 , and delyon and hu . similarly let @xmath118 and @xmath119 denote the densities of the distributions of the approximate bridge @xmath115 and of a diffusion with stochastic differential equation ( [ basicsde ] ) and initial distribution with density @xmath120 , respectively .",
    "let us call a diffusion of the latter type a @xmath121-diffusion . finally , for any @xmath122 , let @xmath123 be the set of functions @xmath124 that intersect @xmath125 .",
    "specifically , @xmath126 where @xmath127 \\}$ ] . with these definitions ,",
    "the relation between the distribution of the approximate bridge @xmath115 and the exact @xmath37-diffusion bridge is @xmath128 here @xmath129 where @xmath130 , @xmath16 and @xmath100 are independent , @xmath16 is a @xmath37-diffusion bridge , and @xmath100 is a @xmath121-diffusion . clearly , @xmath131 is the probability that @xmath100 hits the trajectory @xmath125 , while @xmath132 is probability that a @xmath37-bridge is hit by an independent diffusion with initial distribution @xmath107 . to prove equation ( [ z - density ] ) , note that the joint density of a diffusion bridge and an independent @xmath121-diffusion given that they intersect is=-1 @xmath133=0 from this expression , ( [ z - density ] ) follows by marginalization .",
    "equation ( [ z - density ] ) is important in two ways : it gives an explicit expression of the quality of our approximate simulation method , and more importantly , it can be used to improve the approximation . in section [ sec2.3 ] ,",
    "we will present two mcmc - algorithms , that improves the quality of the approximation .",
    "in fact , one of them gives exact diffusion bridges .    obviously , the quality of our approximate bridge simulation scheme depends on the probability @xmath132 that a @xmath37-bridge is hit by an independent diffusion with initial distribution @xmath107 .",
    "when @xmath132 is close to one , the simulated process is essentially a @xmath134-bridge .",
    "it is important to realize that the probability @xmath132 is not equal to the acceptance probability @xmath135 .",
    "it is quite possible that @xmath135 is small , while @xmath132 is close to one .",
    "this happens , for instance , for a diffusion with mean reversion to a level @xmath136 when @xmath137 . in the next subsection",
    ", we prove that @xmath132 is close to one for long time intervals , provided that the diffusion is ergodic . in section  [ sim ] , we shall investigate when @xmath132 can otherwise be expected to be close to one , and when a good approximation to a diffusion bridge is obtained .",
    "simulations indicate that also when @xmath132 is not close to one ( but also not close to zero ) , the distribution of the simulated bridge is often indistinguishable from the distribution of an exact diffusion bridge .",
    "we shall now prove that for ergodic diffusions , the probability @xmath132 that a @xmath37-bridge is hit by an independent diffusion with initial distribution @xmath107 is close to one when @xmath38 is large .",
    "this implies that for large time intervals , the probability that the process @xmath115 defined in theorem  [ diffusionbridge ] is a @xmath37-bridge is close to one , that is , the simulated process is essentially a @xmath37-bridge .",
    "this is very fortunate , because the strength of the method presented in this paper is that , contrary to other methods for simulating diffusion bridges , it works well numerically for long intervals , see section  [ sim ] and theorem  [ rejectionprob ] .",
    "a diffusion processes satisfying ( [ finitespeed ] ) is ergodic if @xmath138 where @xmath139 is given by ( [ speed ] ) .",
    "the convergence of the probability @xmath132 to one is exponentially fast in @xmath38 when the diffusion process has a spectral gap @xmath140 , that is , when the infimum @xmath141 of the non - zero eigenvalues of the spectrum of the infinitesimal generator of the diffusion is strictly positive . for one - dimensional diffusions , a spectral gap is equivalent to @xmath0-mixing .",
    "most ergodic diffusions used in practice have this property . easily checked conditions on the drift and diffusion coefficients ensuring a spectral gap and hence exponential convergence of @xmath132 can be found in florens - zmirou @xcite , hansen and scheinkman , hansen , scheinkman and touzi @xcite and genon - catalot , jeantheau and lardo @xcite .",
    "a simple example is a diffusion with linear drift @xmath142 , @xmath143 , which has a spectral gap @xmath144 , provided that the invariant probability measure ( [ invdensity ] ) has finite second moment , cf .",
    "hansen _ et al_. @xcite .",
    "thus by theorem  [ largeintervals ] , @xmath145 , so the simple method gives a good approximation when @xmath146 is moderately large , that is , when either @xmath38 is large or when the diffusion moves fast ( @xmath147 large ) .",
    "the pearson diffusions provide a useful broad class of diffusions with linear drift ; see forman and srensen @xcite .",
    "ergodic diffusions with linear drift and an arbitrary stationary distribution were given in bibby , skovgaard and srensen @xcite .",
    "for a general diffusion satisfying ( [ finitespeed ] ) and ( [ infinscale ] ) , hansen _ et al_. @xcite showed that if the function @xmath148 has nonzero limits as @xmath149 and @xmath150 , then the diffusion has a spectral gap @xmath140 .",
    "genon - catalot _",
    "al_. @xcite gave an explicit lower bound for @xmath141 , which gives a useful bound on the rate of convergence of the probability @xmath132 .",
    "to give this lower bound , we need the functions ( defined on the state space of the diffusion ) @xmath151 and @xmath152 where @xmath153 is the scale function @xmath154 genon - catalot _ et al_. @xcite showed that @xmath155 if the limits of @xmath156 exist and are nonzero , then @xmath157 , and theorem  [ largeintervals ] implies that @xmath158 .",
    "the results discussed here are summarized in the following theorem .",
    "[ largeintervals ] for ergodic diffusions @xmath159 as @xmath160 .",
    "if the diffusion has a spectral gap @xmath140 , then @xmath161    @xmath132 is the probability that a @xmath37-bridge @xmath162 is hit by an independent diffusion @xmath163 with initial distribution @xmath107 .",
    "let @xmath125 denote the point from which @xmath163 starts , and assume that @xmath164 .",
    "the case @xmath165 can be treated similarly .    by karlin and mcgregor @xcite ( page 1144 ) the probability that @xmath166 and @xmath167 without having been coincident in @xmath168 $ ] ( conditional on @xmath169 ) is @xmath170 here @xmath75 is an arbitrary real number . that the result holds for time - inhomogeneous diffusions too follows from karlin @xcite . since the diffusion is ergodic",
    ", @xmath171 converges weakly to the stationary distribution with density @xmath95 .",
    "then the density of @xmath172 ( cf .",
    "( [ bridgetransition ] ) ) satisfies @xmath173 as @xmath160 .",
    "hence @xmath174\\bigr ) \\atop   p_\\nu\\bigl((-\\infty , q]\\bigr ) } \\enskip { p_\\nu\\bigl((q,\\infty]\\bigr ) \\atop      p_\\nu\\bigl((q,\\infty]\\bigr ) } \\right\\ } = 0,\\ ] ] as @xmath160 , where @xmath175 denotes the stationary distribution .",
    "this implies that @xmath176 .",
    "now assume that @xmath177 , where @xmath141 is the infimum of the nonzero eigenvalues of the spectrum of the infinitesimal generator of the diffusion .",
    "then @xmath178 , see , for example , karlin and taylor @xcite , page 332 , and it follows that the density function of @xmath172 also satisfies that @xmath179 . hence ,",
    "@xmath180\\bigr ) \\atop   p_\\nu\\bigl((-\\infty , q]\\bigr ) } \\enskip { p_\\nu\\bigl((q,\\infty]\\bigr ) \\atop p_\\nu\\bigl((q,\\infty]\\bigr ) } \\right\\ } + \\mathrm{o}\\bigl(\\mathrm{e}^{-\\lambda\\delta/2}\\bigr ) = \\mathrm{o } \\bigl(\\mathrm{e}^{-\\lambda\\delta/2}\\bigr).\\ ] ]    if we replace @xmath181 by the time @xmath182 ( @xmath183 ) in the proof , it follows that @xmath184 . in practice",
    ", this refinement does not make much difference .",
    "a similar result can be proved for the rejection probability in the same way .",
    "let @xmath185 denote the rejection probability .",
    "[ rejectionprob ] for ergodic diffusions @xmath186 as @xmath160 .",
    "if the diffusion has a spectral gap @xmath140 , then @xmath187    theorem  [ rejectionprob ] implies that for ergodic diffusions the computational complexity of our method is linear in the time distance between the two end - points of the diffusion bridge , provided that the diffusion is simulated by a scheme that is linear in the interval length .",
    "this is true of simple simulation method like the milstein scheme .      since we know the relationship between the distribution of an exact diffusion bridge and the distribution of our simple approximation , cf .",
    "( [ z - density ] ) , it is natural to consider a metropolis ",
    "hastings algorithm for which the proposal is our simple simulation method and the target distribution is the distribution of an exact diffusion bridge . in each step",
    ", we draw an independent sample path @xmath188 with distribution given by @xmath118 by means of the simple simulation method .",
    "the proposed sample path is accepted with probability @xmath189 , where @xmath190 here @xmath191 is the previously accepted sample path , and @xmath192 is the probability that the sample path @xmath125 is hit by an independent @xmath121-diffusion , given by ( [ pi ] ) .",
    "the mh - algorithm produces draws of exact diffusion bridges , but as @xmath192 is not explicitly known , the algorithm can not be used as it stands .",
    "one possibility is to use a monte carlo within metropolis algorithm .",
    "this can be done by simulating in each step @xmath193 independent @xmath121-diffusions , @xmath194 and estimate @xmath192 consistently by @xmath195 if @xmath193 is sufficiently large , this would certainly produce a very good approximation to a diffusion bridge , but not exact diffusion bridges .",
    "usually , the density function @xmath120 is not explicitly known , but a @xmath121-diffusion can be simulated as follows .",
    "simulate the solution @xmath196 to ( [ basicsde ] ) in the time interval @xmath197 $ ] with @xmath198 .",
    "then @xmath199 , @xmath200 $ ] , is a @xmath121-diffusion .    in order to simulate exact diffusion bridges",
    ", we propose an mcmc algorithm of the pseudo - marginal type studied in andrieu and roberts @xcite .",
    "the basic idea of the pseudo - marginal approach is to replace the factor in the acceptance ratio , which we can not calculate , @xmath201 by an unbiased mcmc estimate .",
    "the beauty of the method is that by including the mcmc draws needed for the estimate of @xmath202 in the mh - markov chain , the marginal equilibrium distribution of the bridge draws is exactly @xmath117 , irrespective of the randomness of the estimate of @xmath202 .",
    "define a random variable @xmath2 in the following way . for a given sample path @xmath203 ,",
    "simulate a sequence of independent @xmath121-diffusions @xmath204 until a sample path is obtained that intersects @xmath125 .",
    "then @xmath2 is defined as the number of the first @xmath205 that hits @xmath125 : @xmath206 by results for the geometric distribution @xmath207 , so if @xmath208 is a vector of @xmath193 independent draws of @xmath2 , then an unbiased and consistent estimator of @xmath202 is=-1 @xmath209=0 now consider the following mh - algorithm , where draws of @xmath210 are included in the markov chain . in each step",
    ", we draw ( independently of the previous draws ) a sample paths @xmath188 by the simple algorithm , and with @xmath211 we draw a vector of @xmath193 independent @xmath2-values , @xmath212 .",
    "note that the distribution of @xmath213 depends on @xmath188 .",
    "the proposed update @xmath214 is accepted with probability @xmath215 where @xmath216 by results in andrieu and roberts @xcite , the target distribution of @xmath16 is that of an exact diffusion bridge .",
    "in fact , since @xmath217 where @xmath218 is the conditional density of @xmath210 given @xmath219 , we see that the density of the target distribution is @xmath220 where we have used ( [ z - density ] ) .",
    "since @xmath221 is an unbiased estimator of @xmath202 conditionally on @xmath125 , we find by marginalizing that the density of @xmath16 is @xmath117 , the density function of an exact diffusion bridge .    to produce diffusion bridges by the proposed pseudo - marginal mh - algorithm , a number of sample paths of ordinary diffusions must be simulated .",
    "if these sample paths are simulated by an approximate method , like the milstein scheme , a small discretization error is introduced .",
    "this problem can , however , be avoided by using the methods for exactly simulating diffusions developed by beskos , papaspiliopoulos and roberts @xcite . by combining our exact mh bridge simulation algorithm with exact diffusion simulation methods",
    ", exact diffusion bridges can be efficiently simulated even in long time intervals .    for ergodic diffusions ,",
    "the computational complexity of the exact algorithm is linear in the interval length @xmath38 . in the previous subsection",
    ", we saw that simulation of the proposal is linear in @xmath38 , and the expected number of @xmath121-diffusions simulated in the @xmath46th m  h step is @xmath222 . for a diffusion bridge @xmath16 , the expectation of @xmath223 is @xmath132 , which by theorem  [ largeintervals ] converges to one as @xmath160 .",
    "since @xmath132 is usually not small , each iteration of the m  h - algorithm producing exact diffusion bridges is not expected to require much more computing time than the approximate algorithm .",
    "finally , since the acceptance ratio tends to one as @xmath160 , the acceptance rate is high when @xmath38 is large .",
    "in this section , we investigate simulation of two examples of diffusion bridges for which our new methods can be compared to other exact algorithms , the ornstein  uhlenbeck process and the hyperbolic diffusion .",
    "we compare the distribution of exact bridge simulations to the distribution of the process obtained by our approximate bridge simulation method .",
    "it is found that the approximation is very accurate in most cases , including bridges that are likely to occur in applications to likelihood inference .",
    "we also compare cpu execution times , and illustrate how our exact m  h simulation method provides an exact bridge in the extreme cases where the approximate method does not provide a good approximation .",
    "first , we consider an ornstein  uhlenbeck bridge , which is a solution to the stochastic differential equation @xmath224 conditionally on @xmath17 and @xmath225 for some @xmath226 . from the well - known gaussian transition densities of the ornstein  uhlenbeck process we can calculate the transition densities of the ornstein  uhlenbeck bridge by ( [ bridgetransition ] ) .",
    "thus , we could in principle simulate the ornstein  uhlenbeck bridge by sampling transitions from these densities .",
    "the following well - known alternative method is , however , numerically more stable .",
    "[ lemmamichael ] generate @xmath227 , where @xmath228 , by @xmath229 and @xmath230 where the @xmath231s are independent and @xmath232 .",
    "define @xmath233 then @xmath234 is distributed like an ornstein  uhlenbeck bridge with @xmath235 and @xmath236 .",
    "diffusion bridges obtained by our approximate method to that based on 25,000 exactly simulated diffusion bridges .",
    "the left plot is for the ornstein  uhlenbeck bridge and the right plot is for the hyperbolic diffusion bridge .",
    "exact simulations are obtained by the method in lemma [ lemmamichael ] for the ornstein  uhlenbeck bridge and by the exact algorithm of beskos , papaspiliopoulos and roberts for the hyperbolic diffusion bridge . ]    , @xmath237 , @xmath238 and @xmath239 ornstein  uhlenbeck bridges obtained by our approximate method to that based on 25,000 exactly simulated ornstein  uhlenbeck bridges .",
    "exact simulations are obtained by the method in lemma [ lemmamichael ] . ]    in all examples considered in the following we simulated 25,000 ( or 10,000 ) realizations of diffusion bridges over the time interval @xmath240 $ ] .",
    "the euler scheme was used with discretization level @xmath241 ( step size @xmath242 ) . for the ornstein  uhlenbeck process",
    "the euler scheme is equal to the milstein scheme .",
    "the methods were implemented in fortran 90 on a dell precision m65 workstation ( laptop ) .    for the ornstein  uhlenbeck bridge , we chose the parameter values @xmath243 and @xmath244 .",
    "first we considered a bridge that started at @xmath245 and ended at @xmath245 .",
    "we compare our approximate method based on theorem  [ diffusionbridge ] to the exact algorithm of lemma  [ lemmamichael ] . to the left in figure  [ simulation1 ] ,",
    "we have plotted the quantiles of the empirical distribution at the time point @xmath246 obtained by our approximate method against the quantiles of the empirical distribution obtained by the exact algorithm .",
    "the two distributions appear to be equal .",
    "similar comparisons of quantiles at time 0.5 for our approximate method to quantiles of an exact bridge are presented in figure  [ simulation2 ] for @xmath247 , @xmath237 , @xmath238 and @xmath239 ornstein  uhlenbeck bridges . in all four cases ,",
    "the two distributions seem to be essentially equal , except for a very small negative bias for the @xmath237-bridge .",
    "similar results were found for several other comparisons of distributions with similar values of the start and end points , @xmath1 and @xmath3 .",
    "the cpu execution time ( in seconds ) to simulate 10,000 ornstein  uhlenbeck bridges using our approximate method for the various starting points , @xmath1 , and end points , @xmath3 , are given in table  [ outab ] together with estimated rejection probabilities ( @xmath248 , see theorem  [ rejectionprob ] ) .",
    "the table also gives the probabilities that an ornstein  uhlenbeck process moves from @xmath1 to @xmath3 or farther in the time interval @xmath240 $ ] .",
    "we see that for moves that are likely to appear in data sets , the cpu times and rejection probabilities are small , and the cpu times are only slightly larger than the execution time for the exact algorithm which is about 0.5 cpu seconds . for more unlikely moves",
    "the rejection probability is quite large , but also in these cases the execution time is not a problem in applications .",
    "the last column of table  [ outab ] gives the ( estimated ) probability of the event that an exact @xmath25-bridge is not hit by an independent diffusion with initial distribution @xmath249 .",
    "these probabilities were found by simulating exact ornstein  uhlenbeck bridges and independent ornstein ",
    "uhlenbeck processes with initial distribution @xmath249 .",
    "if this probability were zero , our approximate method would simulate an exact diffusion bridge .",
    "the probabilities are small , but not negligible .",
    "it is remarkable that the approximate method gives a quite accurate approximation to a diffusion bridge in spite of this .",
    "the reason must be that the diffusion bridges are not hit by the independent diffusion in a systematic way for the @xmath1 and @xmath3 values considered here .",
    "=    @ld2.1d1.2d1.4d1.2@ & & & & + @xmath250 & 0.5 & 0.17 & & 0.28 + @xmath251 & 0.7 & 0.41 & 0.1 & 0.21 + @xmath252 & 1.7 & 0.77 & 0.006 & 0.08 + @xmath253 & 1.9 & 0.80 & 0.02 & 0.16 + @xmath254 & 11.9 & 0.97 & 0.0005 & 0.06 +    in order to test our approximate method in an extreme situation , we simulated 25,000 ornstein  uhlenbeck bridges that started from @xmath2552 and ended in 2 .",
    "the probability that an ornstein  uhlenbeck process with parameters @xmath243 and @xmath244 moves from @xmath2552 to 2 or farther in the time interval @xmath240 $ ] equals the probability that a standard normal distribution is larger than 4.04 , which is 0.00003 , so this a indeed a very extreme event .",
    "not surprisingly that rejection rate was very high , but as appears from figure  [ simulationextreme ] the distribution at time @xmath246 fits the distribution obtained by exact simulation very well .",
    "ornstein  uhlenbeck bridges obtained by our approximate method to that based on 25,000 exactly simulated ornstein  uhlenbeck bridges . ]",
    "( left ) and @xmath256 ( right ) ornstein  uhlenbeck bridges obtained by our approximate method to that based on 25,000 exactly simulated ornstein  uhlenbeck bridges .",
    "exact simulations are obtained by the method in lemma [ lemmamichael ] . ]",
    "( left ) and @xmath256 ( right ) ornstein  uhlenbeck bridges obtained by our approximate method to that based on 25,000 exactly simulated ornstein  uhlenbeck bridges , where the bridges that were not hit by an independent diffusion with initial distribution @xmath249 were removed from the sample . in the second row ,",
    "q plots compare the empirical distributions at time 0.5 based on 25,000 simulated @xmath257 ( left ) and @xmath256 ( right ) ornstein  uhlenbeck bridges obtained by our metropolis ",
    "hastings algorithm ( after a burn - in of 5000 iterations ) to that based on 25,000 exactly simulated ornstein  uhlenbeck bridges . ]",
    "the only situation we have been able to find where the distribution obtained by our approximate simulation method differs appreciably from the distribution of an exact bridge is when the start and end points , @xmath1 and @xmath3 , have the same sign and are both far from the equilibrium point zero .",
    "this is to be expected because we simulate an exact bridge conditional on the event that it is hit by an independent diffusion with initial distribution @xmath249 .",
    "when @xmath3 is far from zero , most of the probability mass of @xmath249 is located considerably closer to zero than @xmath3 ( because of the drift towards zero ) . the independent diffusion will tend to move towards zero , while the @xmath25-bridge will tend to stay relatively close to @xmath1 and @xmath3 .",
    "only trajectories of the bridge that move sufficiently towards zero has a reasonable chance of being hit by the independent diffusion .",
    "this creates a bias towards zero .",
    "the comparison of quantiles at time 0.5 and time 0.1 for @xmath257 and @xmath256 bridges are presented in figure  [ simulation3 ] . as expected from the consideration above , there is a positive bias .",
    "the time point 0.5 was chosen in most simulations because it is expected that this is the time point where it is most difficult to get a good approximation of the distribution of a diffusion bridge .",
    "the comparison of distributions at time 0.1 illustrate that the approximate method works better close to the end - points of the time interval , where the bias is considerably smaller .",
    "several similar comparisons confirm that the approximate method works better close to the end - points than at time 0.5 .",
    "ornstein  uhlenbeck bridge at time 0.5 obtained by our metropolis ",
    "hastings algorithm . ]",
    "=    @ld1.2d1.2d1.3 & & & + @xmath258 & 0.09 & 0.55 & 0.05 + @xmath259 & 0.24 & 0.74 & 0.003 +    the first row of figure  [ simulation4 ] illustrates theorem  [ diffusionbridge ] .",
    "for the @xmath257 and @xmath256 ornstein  uhlenbeck bridges q ",
    "q plots compare empirical distributions at time 0.5 of 25,000 approximate simulations to the similar empirical distributions based on 25,000 exactly simulated ornstein  uhlenbeck bridges , where the simulated bridges were removed from the sample if the bridge was not hit by an independent diffusion with initial distribution @xmath249 . as expected from theorem  [ diffusionbridge ] ,",
    "the two distributions appear to be equal ( there is a numerical problem in the left tail for the @xmath257-bridge ) .",
    "we know from figure  [ simulation3 ] that this distribution differs from that of the unconditional bridge . in the second row of figure  [ simulation4 ] , q ",
    "q plots compare the empirical distributions at time 0.5 based on 25,000 @xmath257 ( left ) and @xmath256 ( right ) ornstein  uhlenbeck bridges simulated by our mh - algorithm to the empirical distribution based on 25,000 exactly simulated ornstein  uhlenbeck bridges . for the mh - algorithm the burn - in was 5000 iterations and @xmath260 ( the number of @xmath2-values simulated in each step ) .",
    "the algorithm worked well for a much shorter burn - in and for @xmath261 .",
    "also these distributions appear to be equal ( again there is a numerical problem in the left tail for the @xmath257-bridge ) .",
    "the autocorrelations of the mh - algorithm decreases very quickly to zero .",
    "the empirical autocorrelation function of the successive values of the @xmath256 ornstein  uhlenbeck bridge at time 0.5 obtained by our metropolis ",
    "hastings algorithm is plotted in figure  [ simulation5 ] . after less than 10 iterations",
    "the correlation is essentially zero .",
    "table  [ outab1 ] gives estimated rejection probabilities ( of the approximate rejection sampler ) and the probability that an exact @xmath25-bridge is not hit by an independent diffusion with initial distribution @xmath249 .",
    "as expected from the discussion above , the probabilities of not being hit is quite substantial .",
    "the last column gives the probability that a stationary ornstein  uhlenbeck process is a distance @xmath262 or more from zero .",
    "we see that the process will only spend very little time in the parts of the state space , where the approximate method is biased .",
    "next we consider the hyperbolic diffusion which is the solution to @xmath263 with @xmath264 and @xmath265 .",
    "the hyperbolic diffusion was introduced by barndorff - nielsen @xcite .",
    "it is ergodic with the standardized symmetric hyperbolic distribution as invariant distribution , see , for example , bibby and srensen @xcite . in this case",
    "the transition density is not explicitly known , but we can compare our method to the exact ea1 algorithm by beskos , papaspiliopoulos and roberts @xcite .",
    "it is applicable to diffusion processes on the form @xmath266 provided that @xmath14 is continuously differentiable , and the function @xmath267 is bounded from above and below for all @xmath125 , conditions satisfied by the hyperbolic diffusion process .",
    "the algorithm by beskos , papaspiliopoulos and roberts @xcite is very quick for short intervals as it essentially only requires one simulation of a brownian bridge if it is not rejected .",
    "rejection in the ea1 algorithm is not very costly computationally in our example since it is only a few points that are thrown away per rejection .",
    "thus , we compare our algorithm to a very efficient method .",
    "again we simulated 25,000 bridges using the euler scheme with a 100 points subdivision of @xmath240 $ ] . also for the hyperbolic diffusion the euler scheme equals the milstein scheme .",
    "the parameter values were @xmath268 .",
    "we start with a bridge from 0 to 0 and compare our approximate method to the exact ea1 algorithm . to the right in figure  [ simulation1 ] , we have plotted the quantiles of the empirical distribution at the time point @xmath246 obtained by our approximate method against the quantiles of the empirical distribution obtained by the exact ea1 algorithm .",
    "also for this example the two distributions appear to be equal .",
    "table  [ hyperbolictab ] shows cpu execution times to simulate 10,000 hyperbolic diffusion bridges by our approximate method for various starting points , @xmath1 , and end points , @xmath3 .",
    "also estimated rejection probabilities are given .",
    "the pattern is similar to that for the ornstein  uhlenbeck process . for moves that are likely to appear in data sets , the cpu times and rejection probabilities are small , and for unlikely moves the execution time is not a problem in applications , even though the rejection probability is quite large .",
    "the execution time for the ea1 algorithm was 0.3 cpu seconds , which , as expected , is faster than our method . note that there is no reason to consider diffusions for which the ea1 algorithm does not work in order to compare our method to the more complicated simulation methods ea2 and ea3 in beskos , papaspiliopoulos and roberts @xcite and beskos _",
    "et al_. @xcite .",
    "the ea2 and ea3 algorithms are clearly more time consuming than ea1 , while execution times for our methods can be expected to be approximately as for the two examples considered here .",
    "=    @ld2.1d1.2 & & + @xmath250 & 0.6 & 0.14 + @xmath269 & 0.8 & 0.36 + @xmath270 & 2.1 & 0.77 + @xmath253 & 2.0 & 0.76 + @xmath254 & 12.6 & 0.96 +    =    @d1.1d1.2d3.0d3.2d9.0 & & + [ -5pt ] & & + & & & & + 0.5 & 0.52 & 819 & 0.28 & 14497 + 1.0 & 0.99 & 307 & 0.59 & 53087 + 1.5 & 1.45 & 102 & 1.05 & 163599 + 2.0 & 1.93 & 44 & 1.92 & 457226 + 2.5 & 2.40 & 17 & 4.00 & 1242922 + 3.0 & 2.88 & 6 & 10.01 & 3491838 + 3.5 & 3.36 & 2 & 26.86 & 9357310 + 4.0 & 3.83 & 0 & 75.79 & 25232418 + 4.5 & 4.31 & 0 & 222.09 & 69299642 + 5.0 & 4.79 & 0 & 641.70 & 187069771 +    beskos , papaspiliopoulos and roberts @xcite noted that the computing time of their exact algorithm is large for diffusion bridges over long time intervals .",
    "it is therefore of interest to compare computer time and rejection probabilities for our approximate algorithm to the ea1 algorithm .",
    "to do so , we simulated 10,000 trajectories of the @xmath271-bridge for the hyperbolic diffusion with @xmath272 .",
    "this was done for values of the interval length @xmath38 ranging from 0.5 to 5 .",
    "the cpu execution time ( in seconds ) used to simulate the 10,000 trajectories are given in table  [ intervallenght ] .",
    "we see that for this particular diffusion the two methods use the same cpu time for an interval length of two . for smaller interval lengths",
    "the exact algorithm is somewhat faster , whereas our approximate method is much faster for long intervals .",
    "the simulations confirm that the computational complexity of the proposed method is linear in the interval length @xmath38 as shown in section  [ sec2 ] , whereas the complexity appears to grow at least exponentially with @xmath38 for the exact algorithm ; see figure  [ intervallengthplots ] .",
    "the main reason is that for long intervals the number of rejections becomes very large for the algorithm in beskos , papaspiliopoulos and roberts @xcite , while our approximate algorithm has a very small rejection probability for long intervals .",
    "the rapid decrease of the rejection probabilities for the approximate method as a function of @xmath38 is expected from theorem  [ rejectionprob ] .",
    "-bridges with @xmath272 . in the left plot the cpu time is plotted against @xmath38 for our approximate method , while in the right plot the logarithm of the cpu time is plotted against @xmath38 for the ea1 method in beskos _ et al_. @xcite . ]",
    "the main motivation for the theory developed in this papers is the central role diffusion bridge simulation plays in simulated likelihood - based inference for processes of the diffusion type .",
    "therefore , we end the paper by giving two examples of application of our diffusion bridge simulation method to maximum likelihood estimation first for discretely observed diffusion processes then for integrated diffusions observed with measurement error .      first",
    ", we present an em - algorithm for finding the maximum likelihood estimator for discretely observed diffusion processes . we also briefly discuss aspects of bayesian inference .",
    "consider the diffusion process @xmath273 where @xmath14 and @xmath147 are unknown parameters to be estimated , and @xmath13 is the standard wiener process .",
    "we assume that @xmath274 for all @xmath125 in the state interval .",
    "suppose that the only data available from a realization of the diffusion process are observations at times @xmath275 , @xmath276 , @xmath277 .    as explained in the , discrete time observation of a continuous time process can be viewed as an incomplete observation problem , so the em - algorithm ( dempster , laird and rubin @xcite ) is a natural method for finding the maximum likelihood estimator of the parameters .",
    "maximum likelihood estimation for discretely observed markov jump processes was treated in this way by bladt and srensen @xcite .",
    "unfortunately , the probability measures corresponding to complete continuous time observation of the diffusion model given by ( [ basicmodel ] ) are singular because the diffusion coefficient depends on the parameter @xmath147 .",
    "it is therefore not straightforward to implement the em - algorithm , but an approach in the spirit of roberts and stramer @xcite was proposed by beskos , papaspiliopoulos and roberts @xcite . in the following , we summarize a modification of this approach using our diffusion bridge simulation technique .",
    "the transformation @xmath278 is essential . here",
    "@xmath279 is some arbitrary , but appropriately chosen , point in the state interval . by ito",
    "s formula , @xmath280 solves @xmath281 where @xmath282 in ( [ y ] ) , the diffusion coefficient does not depend on the parameters , so the probability measures are equivalent and the likelihood function can be found . to do so the function @xmath283 where @xmath284 is needed .",
    "note that @xmath285 , and that the functions @xmath286 and @xmath287 are closely related to the density @xmath288 of the stationary distribution of the original diffusion model given by ( [ basicmodel ] ) .",
    "specifically , @xmath289 equals @xmath290 apart from an additive constant .",
    "thus , when the stationary density is known , the only problem is to find @xmath291 and its inverse .",
    "this is for instance the case for the pearson diffusions studied by forman and srensen @xcite .",
    "the problem with the transformation @xmath292 is that it is parameter dependent , while we need to keep the original discrete time data fixed when running the em - algorithm . to get around this problem ,",
    "define @xmath293 for @xmath294 , @xmath295 . here",
    "@xmath296 denotes the @xmath297-bridge for the diffusion ( [ y ] ) with parameter values @xmath298 and @xmath299 , and @xmath296 , @xmath295 are independent . then the em - algorithm works as follows",
    ". let @xmath300 be initial values of the parameters .",
    "( e - step ) calculate the function @xmath301 ^ 2/(t_i - t_{i-1 } ) - \\sum_{i=2}^n \\log\\bigl ( \\sigma_\\beta(x_i)\\bigr ) \\\\ & & { } -\\frac{1}{2 } \\sum _ { i=2}^n { { \\mathbb{e}}}_{z^{(i,\\alpha_0,\\beta_0 ) } } \\biggl ( \\int _ { t_{i-1}}^{t_i } \\bigl [ \\mu_{\\alpha,\\beta}^{\\prime } \\bigl(y^{*}_t(\\beta,\\beta_0)\\bigr)+ \\mu_{\\alpha , \\beta } \\bigl(y^{*}_t(\\beta , \\beta_0)\\bigr)^2 \\bigr ] \\,\\mathrm{d}t \\biggr).\\end{aligned}\\ ] ]    ( m - step ) @xmath302 .",
    "go to ( 1 ) .    in the e - step",
    ", @xmath303 means that the data points are fixed so that only the diffusion bridge is random , and expectation is with respect to the distribution of the diffusion bridge .",
    "thus , the expectations in the e - step can be approximated by simulating diffusion bridges by our exact mh - method and averaging ( after a burn - in period ) .",
    "arguments that @xmath304 is the conditional expectation of the relevant continuous time likelihood function can be found in roberts and stramer @xcite and beskos , papaspiliopoulos , roberts and fearnhead @xcite . as pointed out in the latter paper , the conditional expectation can also be calculated as @xmath305 where @xmath306 is a uniformly distributed random variable on @xmath307 $ ] that is independent of @xmath296 and the data .    in the m -",
    "step the maximization of @xmath304 must in general be done by a suitable maximization algorithm . with modern software ( e.g. , the r - function optim ) ,",
    "this is not a problem .",
    "when the drift of the original diffusion model ( [ basicmodel ] ) depends linearly on the vector of parameters @xmath14 , that is , when @xmath308 where @xmath309 are known functions , then the maximization problem is simplified somewhat .",
    "when the drift has this form , and when the diffusion parameter @xmath147 is fixed , the model for continuous time observation of @xmath16 as well as the transformed process @xmath100 is an exponential family of stochastic processes , see kchler and srensen @xcite , page 27 .",
    "we can therefore take advantage of well known properties of exponential families of diffusions .    for the em - algorithm the specification ( [ paramlindrift ] )",
    "implies that the function @xmath304 has the form @xmath310 where @xmath311 \\,\\mathrm{d}t \\biggr),\\end{aligned}\\ ] ] with @xmath312 , @xmath313 and @xmath314 ^ 2/(t_i - t_{i-1 } ) - \\sum _ { i=2}^n \\log\\bigl(\\sigma_\\beta(x_i ) \\bigr ) \\\\ & & { } + \\frac14 \\sum_{j=2}^n { { \\mathbb{e}}}_{z^{(j,\\alpha_0,\\beta_0 ) } } \\biggl ( \\int_{t_{j-1}}^{t_j } \\biggl [ \\sigma_\\beta''\\bigl(h_\\beta^{-1 } \\bigl(y^*_t(\\beta,\\beta_0)\\bigr)\\bigr ) \\sigma_\\beta \\bigl(h_\\beta^{-1 } \\bigl(y^*_t(\\beta,\\beta_0)\\bigr)\\bigr ) \\\\ & & \\hphantom{{}+ \\frac14 \\sum_{j=2}^n { { \\mathbb{e}}}_{z^{(j,\\alpha_0,\\beta_0 ) } } ( \\int_{t_{j-1}}^{t_j } \\biggl[}{}- \\frac12 \\bigl\\ { \\sigma_\\beta'\\bigl(h_\\beta^{-1 } \\bigl(y^*_t(\\beta,\\beta_0)\\bigr)\\bigr)\\bigr \\}^2 \\biggr ] \\,\\mathrm{d}t \\biggr).\\end{aligned}\\ ] ] for a fixed value of @xmath147 , the function @xmath315 is maximal for @xmath316 where @xmath317 , @xmath318 and @xmath319 .",
    "this is provided that @xmath320 is invertible , which it is when the functions @xmath321 , @xmath322 are linearly independent .",
    "thus , @xmath304 attains its maximal value at @xmath323 , where @xmath324 maximizes @xmath325    the gibbs sampler for bayesian inference for discretely observed diffusion processes proposed by roberts and stramer @xcite can also be modified by replacing the mcmc algorithm for simulating diffusion bridges in that paper by our diffusion bridge simulation method .",
    "we will not go into any detail for general diffusions , but will limit ourselves to pointing out that when the drift has the form ( [ paramlindrift ] ) , then the ( continuous time ) posterior distribution of @xmath14 simplifies .",
    "choose as the prior for @xmath14 the conjugate prior for an exponential family of diffusions ( see kchler and srensen @xcite , page 51 ) , which here is a multivariate normal distribution with expectation @xmath326 and covariance matrix @xmath327 . then the posterior of @xmath14 ( given @xmath328 and given simulated diffusion bridges ) is a @xmath329-dimensional normal distribution with expectation @xmath330 and covariance matrix @xmath331 , where @xmath332 , @xmath319 , @xmath333 \\,\\mathrm{d}t,\\end{aligned}\\ ] ] and @xmath334      here we present an em - algorithm to find the maximum likelihood estimator when an integrated diffusion is observed with measurement errors .",
    "the method was proposed and studied by baltazar - larios and srensen @xcite .",
    "we consider again the diffusion process @xmath16 given by ( [ basicmodel ] ) , but here the data are of the form @xmath335 where @xmath336 , @xmath337 are mutually independent and independent of @xmath338 , and @xmath339 .",
    "we assume that @xmath16 is stationary and ergodic .",
    "the variance of the measurement error , @xmath340 , is an extra unknown parameter , so we need to estimate the parameter @xmath341 .",
    "we can think of the data set @xmath342 as an incomplete observation of a full data set given by the sample path @xmath343 $ ] and the measurement errors @xmath344 , or equivalently @xmath345 $ ] and @xmath342 . to apply the em - algorithm ,",
    "we need to find the likelihood function for the full data set and the conditional expectation of this full log - likelihood function given the observations @xmath342 .",
    "conditionally on the sample path of @xmath16 , the observations @xmath346 , @xmath337 are independent and normal distributed with expectation @xmath347 and variance @xmath340 .",
    "again we need to apply the transformation ( [ h - trans ] ) because the probability measures are singular . by expressing the data @xmath346 in terms of the process @xmath100 , using the parameter - dependent transformation @xmath291 , and by girsanov s theorem",
    ", we find that the log - likelihood function for the full data set is @xmath348\\bigr)\\nonumber\\\\   & & \\quad = \\sum_{i=1}^n \\log \\varphi\\biggl(v_i;\\int_{t_{i-1}}^{t_i}h^{-1}_\\beta(y_s)\\,\\mathrm{d}s , \\tau^2\\biggr)+ g_{\\alpha,\\beta}\\bigl(h^{-1}_\\beta(y_{t_n } ) \\bigr ) \\\\ & & \\qquad { }   -g_{\\alpha,\\beta}\\bigl(h^{-1}_\\beta(y_{0 } ) \\bigr ) -\\frac{1}{2}\\int_{0}^{t_n } \\bigl ( \\mu_{\\alpha,\\beta}(y_t)^2 + \\mu'_{\\alpha,\\beta}(u_t ) \\bigr)\\,\\mathrm{d}t , \\nonumber\\end{aligned}\\ ] ] where @xmath349 denotes the normal density function with mean @xmath1 and variance @xmath3 .",
    "the em - algorithm works as follow . let the initial value @xmath350 be any value of the parameter vector @xmath351 .",
    "( e - step ) generate @xmath352 sample paths of the diffusion process @xmath16 , @xmath353 , conditional on the observations @xmath354 using the parameter value @xmath355 , and calculate @xmath356\\bigr)\\ ] ] for a suitable burn - in period @xmath357 and @xmath352 sufficiently large .",
    "( m - step ) @xmath358 argmax @xmath359    go to ( 1 ) .    to implement this algorithm ,",
    "the main issue is how to generate sample paths of @xmath16 conditionally on @xmath354 , where the relation between the @xmath346s and @xmath16 is given by ( [ 2.1 ] ) .",
    "this can be done by means of a metropolis ",
    "hastings algorithm .",
    "however , if the sample path in the entire time interval @xmath360 $ ] is updated in one step , the rejection probability is typically very large . therefore , it is more efficient to randomly divide the time interval into subintervals and update the sample path in each of the subintervals conditional on the rest of the sample path , which corresponds to simulating a diffusion bridge in each subinterval ( except the end - intervals ) .",
    "this is a modification of the method in chib _",
    "et al_. @xcite , where we use the algorithm for diffusion bridge simulation proposed in section  [ sec2 ] . in the following ,",
    "the parameter value @xmath351 is fixed .",
    "start by generating an initial unrestricted stationary sample path , @xmath361\\}$ ] , of the diffusion given by ( [ basicmodel ] ) , and set @xmath362 .",
    "generate a sample path @xmath363\\}$ ] conditional on @xmath100 by updating subsets of the sample path :    a.   randomly split the time interval from @xmath360 $ ] into @xmath364 blocks , and write these subsampling times as @xmath365 where each @xmath366 is one of the end - points of the integration intervals , @xmath367 , @xmath368 .",
    "let @xmath369 denote the collection of all observations @xmath370 for which @xmath371",
    ". b.   draw @xmath372 from the stationary distribution , and simulate the conditional subpath @xmath373\\ } | y_{\\{k\\ } } , x_{\\tau_{k-1}}^{(l)},x_{\\tau_k}^{(l-1)},$ ] for @xmath374 .",
    "finally , simulate @xmath375\\ } | y_{\\{k\\ } } , x_{\\tau_{k-1}}^{(l)}$ ] .",
    "@xmath376 .",
    "go to ( 1 ) .",
    "the random time intervals can for instance be generated by independent poisson variables .",
    "simulation of a @xmath377-bridge conditional on @xmath378 , the data in @xmath379 $ ] , can be done by a metropolis ",
    "hastings algorithm that uses the bridge simulation method introduced in section  [ sec2 ] as proposal and accepts a proposed bridge @xmath380 with probability @xmath381 where the end - point @xmath382 is equal to @xmath367 , @xmath383 is the number of observations in the interval @xmath379 $ ] ( the observations are @xmath384 ) , and @xmath385 is the bridge in the previous step of the mh - algorithm .    in a simulation study by baltazar - larios and srensen @xcite , where the approximate algorithm of section [ sec2.1 ] was used to simulate diffusion bridges ,",
    "this em - algorithm worked well .",
    "the study considered 1500 observations of ornstein  uhlenbeck and cir processes integrated over time intervals of length one .",
    "three versions of the em - algorithm were investigated , where the expected number of observations in each random subinterval was 11 , 21 and 31 , respectively .",
    "we have presented a straightforward way of simulating an approximation to a diffusion bridge and an easily implementable metropolis ",
    "hastings algorithm that uses the approximate simulation as proposal and has exact diffusion bridges as the target distribution .",
    "advantages of the new method is that it is easy to understand and to implement , that the same simple algorithm can be used for all one - dimensional diffusion processes with finite speed measure , and most importantly , that the method works particularly well for long time intervals , where other methods tends not to work or to be very time consuming .",
    "the method allows the use of simple simulation procedures like the milstein scheme for bridge simulation .",
    "the simulation study showed that the one - dimensional distributions obtained by the approximate method compare accurately to the results from exact simulations for bridges corresponding to data that are likely in discrete - time samples from diffusion models .    for ergodic diffusions ,",
    "the computational complexity was shown to be linear in the interval length for our approximate method as well as for our exact method .",
    "the simulation study showed that the computing time for the approximate algorithm for small time intervals is of the same order of magnitude as for the exact ea1 method and for long intervals it is much faster than the ea1 method .",
    "thus our new diffusion bridge simulation method is highly suitable for likelihood inference for discretely observed diffusions and can be used to simplify and in some cases speed up methods for likelihood inference and bayesian inference ( the em - algorithm and the gibbs sampler ) for discretely observed diffusion processes .",
    "the method is also potentially useful for inference for more general diffusion type models like stochastic volatility models .",
    "the authors are grateful to the referees for their insightful comments that have improved the paper very considerably .",
    "the research of michael srensen was supported by the danish center for accounting and finance funded by the danish social science research council , by the center for research in econometric analysis of time series funded by the danish national research foundation , and by a grant from the university of copenhagen programme of excellence ."
  ],
  "abstract_text": [
    "<S> with a view to statistical inference for discretely observed diffusion models , we propose simple methods of simulating diffusion bridges , approximately and exactly . </S>",
    "<S> diffusion bridge simulation plays a fundamental role in likelihood and bayesian inference for diffusion processes . </S>",
    "<S> first a simple method of simulating approximate diffusion bridges is proposed and studied . </S>",
    "<S> then these approximate bridges are used as proposal for an easily implemented metropolis  </S>",
    "<S> hastings algorithm that produces exact diffusion bridges . </S>",
    "<S> the new method utilizes time - reversibility properties of one - dimensional diffusions and is applicable to all one - dimensional diffusion processes with finite speed - measure . </S>",
    "<S> one advantage of the new approach is that simple simulation methods like the milstein scheme can be applied to bridge simulation . </S>",
    "<S> another advantage over previous bridge simulation methods is that the proposed method works well for diffusion bridges in long intervals because the computational complexity of the method is linear in the length of the interval . for @xmath0-mixing diffusions the approximate method </S>",
    "<S> is shown to be particularly accurate for long time intervals . in a simulation study </S>",
    "<S> , we investigate the accuracy and efficiency of the approximate method and compare it to exact simulation methods . in the study , </S>",
    "<S> our method provides a very good approximation to the distribution of a diffusion bridge for bridges that are likely to occur in applications to statistical inference . to illustrate the usefulness of the new method , we present an em - algorithm for a discretely observed diffusion process . </S>"
  ]
}