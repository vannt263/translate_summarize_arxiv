{
  "article_text": [
    "in a series of seminal papers in the 1950s and 1960s , paul erds and alfrd rnyi proposed and studied one of the earliest theoretical models of a network , the random graph @xcite .",
    "this minimal model consists of @xmath0 nodes or vertices , joined by links or edges which are placed between pairs of vertices chosen uniformly at random .",
    "erds and rnyi gave a number of versions of their model .",
    "the most commonly studied is the one denoted @xmath1 , in which each possible edge between two vertices is present with independent probability  @xmath2 , and absent with probability  @xmath3 .",
    "technically , in fact , @xmath1 is the _ ensemble _ of graphs of @xmath0 vertices in which each graph appears with the probability appropriate to its number of edges .",
    "vertices and @xmath4 edges this probability is @xmath5 , where @xmath6 . ]    often one wishes to express properties of @xmath1 not in terms of @xmath2 but in terms of the average degree @xmath7 of a vertex .",
    "( the degree of a vertex is the number of edges connected to that vertex . )",
    "the average number of edges on the graph as a whole is @xmath8 , and the average number of _ ends _ of edges is twice this , since each edge has two ends .",
    "so the average degree of a vertex is @xmath9 where the last approximate equality is good for large  @xmath0 .",
    "thus , once we know  @xmath0 , any property that can be expressed in terms of  @xmath2 can also be expressed in terms of  @xmath7 .",
    "the erds ",
    "rnyi random graph has a number of desirable properties as a model of a network .",
    "in particular it is found that many of its ensemble average properties can be calculated exactly in the limit of large  @xmath0 @xcite .",
    "for example , one interesting feature , which was demonstrated in the original papers by erds and rnyi , is that the model shows a phase transition with increasing @xmath7 at which a giant component forms .",
    "a component is a subset of vertices in the graph each of which is reachable from the others by some path through the network . for small values of @xmath7 ,",
    "when there are few edges in the graph , it is not surprising to find that most vertices are disconnected from one another , and components are small , having an average size that remains constant as the graph becomes large .",
    "however , there is a critical value of @xmath7 above which the one largest component in the graph contains a finite fraction @xmath10 of the total number of vertices , i.e. ,  its size @xmath11 scales linearly with the size of the whole graph .",
    "this largest component is the giant component . in general",
    "there will be other components in addition to the giant component , but these are still small , having an average size that remains constant as the graph grows larger .",
    "the phase transition at which the giant component forms occurs precisely at @xmath12 .",
    "if we regard the fraction @xmath10 of the graph occupied by the largest component as an order parameter , then the transition falls in the same universality class as the mean - field percolation transition @xcite .",
    "the formation of a giant component in the random graph is reminiscent of the behaviour of many real - world networks .",
    "one can imagine loose - knit networks for which there are so few edges that , presumably , the network has no giant component , and all vertices are connected to only a few others .",
    "the social network in which pairs of people are connected if they have had a conversation within the last 60 seconds , for example , is probably so sparse that it has no giant component .",
    "the network in which people are connected if they have _ ever _ had a conversation , on the other hand , is very densely connected and certainly has a giant component .",
    "however , the random graph differs from real - world networks in some fundamental ways also .",
    "two differences in particular have been noted in the recent literature @xcite .",
    "first , as pointed out by watts and strogatz  ( @xcite ; @xcite ) real - world networks show strong clustering or network transitivity , where erds and rnyi s model does not .",
    "a network is said to show clustering if the probability of two vertices being connected by an edge is higher when the vertices in question have a common neighbour .",
    "that is , there is another vertex in the network to which they are both attached .",
    "watts and strogatz measured this clustering by defining a clustering coefficient  @xmath13 , which is the average probability that two neighbours of a given vertex are also neighbours of one another . in many real - world networks the clustering coefficient is found to have a high value , anywhere from a few percent to 50 percent or even more . in the random graph of erds and rnyi on the other hand ,",
    "the probabilities of vertex pairs being connected by edges are by definition independent , so that there is no greater probability of two vertices being connected if they have a mutual neighbour than if they do not .",
    "this means that the clustering coefficient for a random graph is simply @xmath14 , or equivalently @xmath15 . in table",
    "[ clustering ] we compare clustering coefficients for a number of real - world networks with their values on a random graph with the same number of vertices and edges .",
    "the graphs listed in the table are :    .number of vertices  @xmath0 , mean degree  @xmath7 , and clustering coefficient  @xmath13 for a number of different networks .",
    "numbers are taken from @xmath16@xcite , @xmath17@xcite , @xmath18@xcite , @xmath19@xcite , @xmath20@xcite , @xmath21@xcite , @xmath22@xcite , @xmath23@xcite , @xmath24@xcite .",
    "[ cols= \" < , > , > , < , < \" , ]     * internet : a graph of the fibre optic connections that comprise the internet , at the level of so - called `` autonomous systems . ''",
    "an autonomous system is a group of computers within which data flow is handled autonomously , while data flow between groups is conveyed over the public internet .",
    "examples of autonomous systems might be the computers at a company , a university , or an internet service provider . * world - wide web : a graph of sites on the world - wide web",
    "in which edges represent `` hyperlinks '' connecting one site to another .",
    "a site in this case means a collection of pages residing on a server with a given name . although hyperlinks are directional , their direction has been ignored in this calculation of the clustering coefficient . *",
    "power grid : a graph of the western states electricity transmission grid in the united states .",
    "vertices represent stations and substations ; edges represent transmission lines .",
    "* biology collaborations : a graph of collaborations between researchers working in biology and medicine .",
    "a collaboration between two scientists is defined in this case as coauthorship of a paper that was catalogued in the medline bibliographic database between 1995 and 1999 inclusive . * mathematics collaborations : a similar collaboration graph for mathematicians , derived from the archives of _ mathematical reviews_. * film actor collaborations : a graph of collaborations between film actors , where a collaboration means that the two actors in question have appeared in a film together .",
    "the data are from the internet movie database . * company directors : a collaboration graph of the directors of companies in the fortune 1000 for 1999 . ( the fortune 1000 is the 1000 us companies with the highest revenues during the year in question . )",
    "collaboration in this case means that two directors served on the board of a fortune 1000 company together .",
    "* word co - occurrences : a graph in which the vertices represent words in the english language , and an edge signifies that the vertices it connects frequently occur in adjacent positions in sentences . * neural network : a graph of the neural network of the worm _ c.  elegans . _ * metabolic network : a graph of interactions forming a part of the energy generation and small building block synthesis metabolism of the bacterium _",
    "_ vertices represent substrates and products , and edges represent interactions . * food web : the food web of predator  prey interactions between species in ythan estuary , a marine estuary near aberdeen , scotland . like the links in the world - wide web graph",
    ", the directed nature of the interactions in this food web have been neglected for the purposes of calculating the clustering coefficient .    as the table shows , the agreement between the clustering coefficients in the real networks and in the corresponding random graphs is not good .",
    "the real and theoretical figures differ by as much as four orders of magnitude in some cases .",
    "clearly , the random graph does a poor job of capturing this particular property of networks .",
    "to to to    a second way in which random graphs differ from their real - world counterparts is in their degree distributions , a point which has been emphasized particularly in the work of albert , barabsi , and collaborators @xcite .",
    "the probability @xmath25 that a vertex in an erds  rnyi random graph has degree exactly  @xmath26 is given by the binomial distribution : @xmath27 in the limit where @xmath28 , this becomes @xmath29 which is the well - known poisson distribution .",
    "both binomial and poisson distributions are strongly peaked about the mean  @xmath7 , and have a large-@xmath26 tail that decays rapidly as @xmath30 .",
    "we can compare these predictions to the degree distributions of real networks by constructing histograms of the degrees of vertices in the real networks .",
    "we show some examples , taken from the networks described above , in fig .",
    "[ degree ] .",
    "as the figure shows , in most cases the degree distribution of the real network is very different from the poisson distribution .",
    "many of the networks , including internet and world - wide web graphs , appear to have power - law degree distributions @xcite , which means that a small but non - negligible fraction of the vertices in these networks have very large degree .",
    "this behaviour is quite unlike the rapidly decaying poisson degree distribution , and can have profound effects on the behaviour of the network , as we will see later in this paper .",
    "other networks , particularly the collaboration graphs , appear to have power - law degree distributions with an exponential cutoff at high degree @xcite , while others still , such as the graph of company directors , seem to have degree distributions with a purely exponential tail @xcite .",
    "the power grid of table  [ clustering ] is another example of a network that has an exponential degree distribution @xcite .    in this paper",
    "we show how to generalize the erds ",
    "rnyi random graph to mimic the clustering and degree properties of real - world networks .",
    "in fact , most of the paper is devoted to extensions that correct the degree distribution , for which an elegant body of theory has been developed in the last few years . however , towards the end of the paper we also consider ways in which clustering can be introduced into random graphs .",
    "work on this latter problem is significantly less far advanced than work on degree distributions , and we have at present only a few preliminary results . whether these results can be extended , and how , are open questions .",
    "it is relatively straightforward to generate random graphs that have non - poisson degree distributions .",
    "the method for doing this has been discussed a number of times in the literature , but appears to have been put forward first by bender and canfield  bc78 .",
    "the trick is to restrict oneself to a specific degree _ sequence _ ,",
    "i.e. ,  to a specified set @xmath31 of the degrees of the vertices @xmath32 .",
    "typically this set will be chosen in such a way that the fraction of vertices having degree @xmath26 will tend to the desired degree distribution @xmath25 as @xmath0 becomes large . for practical purposes however , such as numerical simulation , it is almost always adequate simply to draw a degree sequence @xmath31 from the distribution @xmath25 directly .",
    "once one has one s degree sequence , the method for generating the graph is as follows : one gives each vertex @xmath33 a number @xmath34 of `` stubs''ends of edges emerging from the vertex  and then one chooses pairs of these stubs uniformly at random and joins them together to make complete edges . when all stubs have been used up , the resulting graph is a random member of the ensemble of graphs with the desired degree sequence .",
    "is even . ]",
    "note that , because of the @xmath35 possible permutations of the stubs emerging from the @xmath33th vertex , there are @xmath36 different ways of generating each graph in the ensemble .",
    "however , this factor is constant so long as the degree sequence @xmath31 is held fixed , so it does not prevent the method from sampling the ensemble correctly .",
    "this is the reason why we restrict ourselves to a fixed degree sequence  merely fixing the degree distribution is not adequate to ensure that the method described here generates graphs uniformly at random from the desired ensemble .",
    "the method of bender and canfield does not allow us to specify a clustering coefficient for our graph .",
    "( the clustering coefficient had not been invented yet when bender and canfield were writing in 1978 . )",
    "indeed the fact that the clustering coefficient is not specified is one of the crucial properties of these graphs that makes it possible , as we will show , to solve exactly for many of their properties in the limit of large graph size . as an example of why this is important ,",
    "consider the following simple calculation .",
    "the mean number of neighbours of a randomly chosen vertex  a in a graph with degree distribution  @xmath25 is @xmath37 .",
    "suppose however that we want to know the mean number of second neighbours of vertex  a , i.e. ,  the mean number of vertices two steps away from  a in the graph . in a network with clustering , many of the second neighbours of a vertex are also first neighbours  the friend of my friend is also my friend  and we would have to allow for this effect to order avoid overcounting the number of second neighbours .",
    "in our random graphs however , no allowances need be made .",
    "the probability that one of the second neighbours of  a is also a first neighbour goes as @xmath38 in the random graph , regardless of degree distribution , and hence can be ignored in the limit of large  @xmath0 .",
    "there is another effect , however , that we certainly must take into account if we wish to compute correctly the number of second neighbours : the degree distribution of the first neighbour of a vertex is not the same as the degree distribution of vertices on the graph as a whole .",
    "because a high - degree vertex has more edges connected to it , there is a higher chance that any given edge on the graph will be connected to it , in precise proportion to the vertex s degree .",
    "thus the probability distribution of the degree of the vertex to which an edge leads is proportional to @xmath39 and not just  @xmath25 @xcite .",
    "this distinction is absolutely crucial to all the further developments of this paper , and the reader will find it worthwhile to make sure that he or she is comfortable with it before continuing .",
    "in fact , we are interested here not in the complete degree of the vertex reached by following an edge from  a , but in the number of edges emerging from such a vertex other than the one we arrived along , since the latter edge only leads back to vertex  a and so does not contribute to the number of second neighbours of  a. this number is one less than the total degree of the vertex and its correctly normalized distribution is therefore @xmath40 , or equivalently @xmath41 the average degree of such a vertex is then @xmath42 this is the average number of vertices two steps away from our vertex  a via a particular one of its neighbours . multiplying this by the mean degree of  a , which is just @xmath43",
    ", we thus find that the mean number of second neighbours of a vertex is @xmath44 if we evaluate this expression using the poisson degree distribution , eq .",
    "( [ poisson ] ) , then we get @xmath45the mean number of second neighbours of a vertex in an erds  rnyi random graph is just the square of the mean number of first neighbours .",
    "this is a special case however . for most degree distributions",
    "( [ z2 ] ) will be dominated by the term @xmath46 , so the number of second neighbours is roughly the mean square degree , rather than the square of the mean . for broad distributions such as those seen in fig",
    ".  [ degree ] , these two quantities can be very different @xcite .",
    "we can extend this calculation to further neighbours also . the average number of edges leading from each second neighbour , other than the one we arrived along , is also given by  ( [ avqk ] ) , and indeed this is true at any distance @xmath4 away from vertex  a. thus the average number of neighbours at distance @xmath4 is @xmath47 where @xmath48 and @xmath49 is given by eq .",
    "( [ z2 ] ) . iterating this equation",
    "we then determine that @xmath50^{m-1 } z_1 .",
    "\\label{zm}\\ ] ] depending on whether @xmath49 is greater than @xmath51 or not , this expression will either diverge or converge exponentially as @xmath4 becomes large , so that the average total number of neighbours of vertex a at all distances is finite if @xmath52 or infinite if @xmath53 ( in the limit of infinite  @xmath0 ) .",
    "is deliberately missed out here , since it is non - trivial to show how the graph behaves exactly at this transition point @xcite . for our current practical purposes",
    "however , this matters little , since the chances of any real graph being precisely at the transition point are negligible . ]",
    "if this number is finite , then clearly there can be no giant component in the graph .",
    "conversely , if it is infinite , then there must be a giant component .",
    "thus the graph shows a phase transition similar to that of the erds  rnyi graph precisely at the point where @xmath54 . making use of eq .",
    "( [ z2 ] ) and rearranging , we find that this condition is also equivalent to @xmath55 , or , as it is more commonly written , @xmath56 this condition for the position of the phase transition in a random graph with arbitrary degree sequence was first given by molloy and reed  mr95 .",
    "an interesting feature of eq .",
    "( [ mrcondition ] ) is that , because of the factor @xmath57 , vertices of degree zero and degree two contribute nothing to the sum , and therefore the number of such vertices does not affect the position of the phase transition or the existence of the giant component .",
    "it is easy to see why this should be the case for vertices of degree zero ; obviously one can remove ( or add ) degree - zero vertices without changing the fact of whether a giant component does or does not exist in a graph . but",
    "why vertices of degree two ?",
    "this has a simple explanation also : removing vertices of degree two does not change the topological structure of a graph because all such vertices fall in the middle of edges between other pairs of vertices",
    ". we can therefore remove ( or add ) any number of such vertices without affecting the existence of the giant component .",
    "another quantity of interest in many networks is the typical distance through the network between pairs of vertices @xcite .",
    "we can use eq .",
    "( [ zm ] ) to make a calculation of this quantity for our random graph as follows .",
    "if we are `` below '' the phase transition of eq .",
    "( [ mrcondition ] ) , in the regime where there is no giant component , then most pairs of vertices will not be connected to one another at all , so vertex  vertex distance has little meaning .",
    "well above the transition on the other hand , where there is a giant component , all vertices in this giant component are connected by some path to all others .",
    "( [ zm ] ) tells us the average number of vertices a distance @xmath4 away from a given vertex  a in the giant component .",
    "when the total number of vertices within distance @xmath4 is equal to the size @xmath0 of the whole graph , @xmath4  is equal to the so - called `` radius ''  @xmath58 of the network around vertex  a. indeed , since @xmath59 well above the transition , the number of vertices at distance @xmath4 grows quickly with  @xmath4 in this regime ( see eq .",
    "( [ zm ] ) again ) , which means that most of the vertices in the network will be far from  a , around distance  @xmath58 , and @xmath58 is thus also approximately equal to the average vertex ",
    "vertex distance  @xmath60 .",
    "well above the transition therefore , @xmath60 is given approximately by @xmath61 , or @xmath62 for the special case of the erds ",
    "rnyi random graph , for which @xmath63 and @xmath64 as noted above , this expression reduces to the well - known standard formula for this case : @xmath65 @xcite .    the important point to notice about eq .",
    "( [ ell ] ) is that the vertex ",
    "vertex distance increases logarithmically with the graph size  @xmath0 , i.e. ,  it grows rather slowly .. since the giant components of neither our models nor our real - world networks are tree - like , however , this is not a problem . ] even for very large networks we expect the typical distance through the network from one vertex to another to be quite small . in social networks",
    "this effect is known as the small - world effect , and was famously observed by the experimental psychologist stanley milgram in the letter - passing experiments he conducted in the 1960s @xcite .",
    "more recently it has been observed also in many other networks including non - social networks @xcite .",
    "this should come as no great surprise to us however . on the contrary , it would be surprising if most networks did _ not _ show the small - world effect .",
    "if we define the diameter @xmath66 of a graph to be the _ maximum _ distance between any two connected vertices in the graph , then it can be proven rigorously that the fraction of all possible graphs with @xmath0 vertices and @xmath4 edges for which @xmath67 for some constant @xmath68 tends to zero as @xmath0 becomes large @xcite . and clearly if the diameter increases as @xmath69 or slower , then so also must the average vertex ",
    "vertex distance .",
    "thus our chances of finding a network that does not show the small - world effect are very small for large  @xmath0 .    as a test of eq .",
    "( [ ell ] ) , fig .",
    "[ z1z2size ] compares our predictions of average distance  @xmath60 with direct measurements for fourteen different scientific collaboration networks , including the biology and mathematics networks of table  [ clustering ] . in this figure , each network is represented by a single point , whose position along the horizontal axis corresponds to the theoretically predicted value of @xmath60 and along the vertical axis the measured value .",
    "( [ ell ] ) were exactly correct , all the points in the figure would fall on the dotted diagonal line . since we know that the equation is only approximate",
    ", it comes as no surprise that the points do not fall perfectly along this line , but the results are encouraging nonetheless ; in most cases the theoretical prediction is close to the correct result and the overall scaling of @xmath60 with @xmath69 is clear . if the theory were equally successful for networks of other types , it would provide a useful way of estimating average vertex  vertex separation .",
    "since @xmath51 and @xmath49 are local quantities that can be calculated at least approximately from measurements on only a small portion of the network , it would in many cases be considerably simpler and more practical to apply eq .",
    "( [ ell ] ) than to measure  @xmath60 directly .",
    "although our random graph model does not allow us to fix the level of clustering in the network , we can still calculate an average clustering coefficient for the bender ",
    "canfield ensemble easily enough .",
    "consider a particular vertex  a again .",
    "the @xmath33th neighbour of  a has @xmath34 edges emerging from it other than the edge attached to  a , and @xmath34 is distributed according to the distribution @xmath70 , eq .",
    "( [ defsqk ] ) .",
    "the probability that this vertex is connected to another neighbour @xmath71 is @xmath72 , where @xmath73 is also distributed according to  @xmath70 , and average of this probability is precisely the clustering coefficient : @xmath74 ^ 2    = { z\\over n}\\,\\biggl[{{\\langlek^2\\rangle}-{\\langlek\\rangle}\\over{\\langlek\\rangle}^2}\\biggr]^2    = { z\\over n}\\,\\biggl[c_v^2+{z-1\\over z}\\biggr]^2 .",
    "\\label{crg}\\ ] ] the quantity @xmath75 is the so - called coefficient of variation of the degree distribution  the ratio of the standard deviation to the mean .",
    "thus the clustering coefficient for the random graph with a non - poisson degree distribution is equal to its value @xmath76 for the poisson - distributed case , times a function whose leading term goes as the fourth power of the coefficient of variation of the degree distribution .",
    "so the clustering coefficient still vanishes with increasing graph size , but may have a much larger leading coefficient , since @xmath75 can be quite large , especially for degree distributions with long tails , such as those seen in fig .",
    "[ degree ] .",
    "take for example the world - wide web .",
    "if one ignores the directed nature of links on the web , then the resulting graph is measured to have quite a high clustering coefficient of @xmath77 @xcite , as shown in table  [ clustering ] .",
    "the erds ",
    "rnyi random graph with the same @xmath0 and  @xmath7 , by contrast , has a clustering coefficient of only @xmath78 . however , if we use the degree distribution shown in fig .",
    "[ degree]a to calculate a mean degree and coefficient of variation for the web , we get @xmath79 and @xmath80 , which means that @xmath81 .",
    "( [ crg ] ) then tells us that the random graph with the correct degree distribution would actually have a clustering coefficient of @xmath82 .",
    "this is still about a factor of two away from the correct answer , but a lot closer to the mark than the original estimate , which was off by a factor of more than  400 .",
    "furthermore , the degree distribution used in this calculation was truncated at @xmath83 .",
    "( the data were supplied to author in this form . ) without this truncation , the coefficient of variation would presumably be larger still .",
    "it seems possible therefore , that most , if not all , of the clustering seen in the web can be accounted for merely as a result of the long - tailed degree distribution .",
    "thus the fact that our random graph models do not explicitly include clustering is not necessarily a problem .",
    "on the other hand , some of the other networks of table  [ clustering ] do show significantly higher clustering than would be predicted by eq .",
    "( [ crg ] ) . for these",
    ", our random graphs will be an imperfect model , although as we will see they still have much to contribute .",
    "extension of our models to include clustering explicitly is discussed in section  [ ripples ] .",
    "it would be possible to continue the analysis of our random graph models using the simple methods of this section",
    ". however , this leads to a lot of tedious algebra which can be avoided by introducing an elegant tool , the probability generating function .",
    "in this section we describe the use of probability generating functions to calculate the properties of random graphs .",
    "our presentation closely follows that of newman  _ et  al .",
    "_  nsw01 .",
    "a probability generating function is an alternative representation of a probability distribution .",
    "take the probability distribution @xmath25 introduced in the previous section , for instance , which is the distribution of vertex degrees in a graph .",
    "the corresponding generating function is @xmath84 it is clear that this function captures all of the information present in the original distribution  @xmath25 , since we can recover @xmath25 from @xmath85 by simple differentiation : @xmath86 we say that the function @xmath87 `` generates '' the probability distribution  @xmath25 .",
    "we can also define a generating function for the distribution  @xmath70 , eq .",
    "( [ defsqk ] ) , of other edges leaving the vertex we reach by following an edge in the graph : @xmath88 where @xmath89 denotes the first derivative of @xmath85 with respect to its argument",
    ". this generating function will be useful to us in following developments .",
    "generating functions have some properties that will be of use in this paper .",
    "first , if the distribution they generate is properly normalized then @xmath90 second , the mean of the distribution can be calculated directly by differentiation : @xmath91 indeed we can calculate any moment of the distribution by taking a suitable derivative . in general , @xmath92_{x=1}. \\label{moments}\\ ] ]    third , and most important , if a generating function generates the probability distribution of some property @xmath26 of an object , such as the degree of a vertex , then the sum of that property over @xmath0 independent such objects is distributed according to the @xmath0th power of the generating function .",
    "thus the sum of the degrees of @xmath0 randomly chosen vertices on our graph has a distribution which is generated by the function @xmath93^n$ ] . to see this , note that the coefficient of @xmath94 in @xmath93^n$ ] has one term of the form @xmath95 for every set @xmath31 of the degrees of the @xmath0 vertices such that @xmath96 . but these terms are precisely the probabilities that the degrees sum to  @xmath4 in every possible way , and hence @xmath93^n$ ] is the correct generating function .",
    "this property is the reason why generating functions are useful in the study of random graphs .",
    "most of the results of this paper rely on it .      to make these ideas more concrete ,",
    "let us consider some specific examples of generating functions .",
    "suppose for instance that we are interested in the standard erds ",
    "rnyi random graph , with its poisson degree distribution . substituting eq .",
    "( [ poisson ] ) into  ( [ defsg0 ] ) , we get @xmath97 this is the generating function for the poisson distribution .",
    "the generating function @xmath98 for vertices reached by following an edge is also easily found , from eq .",
    "( [ defsg1 ] ) : @xmath99 thus , for the case of the poisson distribution we have @xmath100 .",
    "this identity is the reason why the properties of the erds  rnyi random graph are particularly simple to solve analytically .    as a second example , consider a graph with an exponential degree distribution : @xmath101 where @xmath102 is a constant .",
    "the generating function for this distribution is @xmath103 and @xmath104 ^ 2.\\ ] ]    as a third example , consider a graph in which all vertices have degree  0 , 1 , 2 , or  3 with probabilities @xmath105 .",
    "then the generating functions take the form of simple polynomials @xmath106",
    "we now apply our generating functions to the calculation of a variety of properties of undirected graphs . in section",
    "[ directed ] we extend the method to directed graphs as well .",
    "the most basic property we will consider is the distribution of the sizes of connected components of vertices in the graph . let us suppose for the moment that we are below the phase transition , in the regime in which there is no giant component .",
    "( we will consider the regime above the phase transition in a moment . ) as discussed in section  [ rg ] , the calculations will depend crucially on the fact that our graphs do not have significant clustering .",
    "instead , the clustering coefficient  the probability that two of your friends are also friends of one another  is given by eq .",
    "( [ crg ] ) , which tends to zero as @xmath107 .",
    "the probability of any two randomly chosen vertices @xmath33 and @xmath71 with degrees @xmath34 and @xmath73 being connected is the same regardless of where the vertices are .",
    "it is always equal to @xmath108 , and hence also tends to zero as @xmath107 .",
    "this means that _ any finite component of connected vertices has no closed loops in it , _ and this is the crucial property that makes exact solutions possible . in physics jargon ,",
    "all finite components are tree - like .    given this , we can calculate the distribution of component sizes below the transition as follows .",
    "consider a randomly chosen edge somewhere in our graph and imagine following that edge to one of its ends and then to every other vertex reachable from that end .",
    "this set of vertices we refer to as the cluster at the end of a randomly chosen edge .",
    "let @xmath109 be the generating function that generates the distribution of sizes of such clusters , in terms of numbers of vertices .",
    "each cluster can take many different forms , as shown in fig .",
    "we can follow our randomly chosen edge and find only a single vertex at its end , with no further edges emanating from it . or we can find a vertex with one or more edges emanating from it .",
    "each edge then leads to another complete cluster whose size is also distributed according to  @xmath109 .",
    "the number of edges @xmath26 emanating from our vertex , other than the one along which we arrived , is distributed according to the distribution @xmath70 of eq .",
    "( [ defsqk ] ) , and , using the multiplication property of generating functions from section  [ properties ] , the distribution of the sum of the sizes of the @xmath26 clusters that they lead to is generated by  @xmath110^k$ ] .",
    "thus the total number of vertices reachable by following our randomly chosen edge is generated by @xmath111^k = x g_1(h_1(x ) ) , \\label{defsh1}\\ ] ] where the leading factor of @xmath112 accounts for the one vertex at the end of our edge , and we have made use of eq .",
    "( [ defsg1 ] ) .",
    "the quantity we actually want to know is the distribution of the sizes of the clusters to which a randomly chosen vertex belongs .",
    "the number of edges emanating from such a vertex is distributed according to the degree distribution  @xmath25 , and each such edge leads to a cluster whose size in vertices is drawn from the distribution generated by the function @xmath109 above .",
    "thus the size of the complete component to which a randomly vertex belongs is generated by @xmath113^k = x g_0(h_1(x ) ) .",
    "\\label{defsh0}\\ ] ] now we can calculate the complete distribution of component sizes by solving  ( [ defsh1 ] ) self - consistently for @xmath109 and then substituting the result into  ( [ defsh0 ] ) .",
    "consider for instance the third example from section  [ examples ] , of a graph in which all vertices have degree three or less . then eq .",
    "( [ defsh1 ] ) implies that @xmath114 is a solution of the quadratic equation @xmath115 or @xmath116 substituting this into eq .",
    "( [ defsh0 ] ) and differentiating @xmath4 times then gives the probability that a randomly chosen vertex belongs to a component of exactly @xmath4 vertices total .",
    "unfortunately , cases such as this in which we can solve exactly for @xmath117 and @xmath109 are rare",
    ". more often no closed - form solution is possible .",
    "( for the simple poissonian case of the erds  rnyi random graph , for instance , eq .",
    "( [ defsh1 ] ) is transcendental and has no closed - form solution . )",
    "we can still find closed - form expressions for the generating functions up to any finite order in @xmath112 however , by iteration of  ( [ defsh1 ] ) . to see this ,",
    "suppose that we have an approximate expression for @xmath109 that is correct up to some finite order  @xmath94 , but possibly incorrect at order @xmath118 and higher .",
    "if we substitute this approximate expression into the right - hand side of eq .",
    "( [ defsh1 ] ) , we get a new expression for @xmath109 and , because of the leading factor of  @xmath112 , the only contributions to the coefficient of @xmath118 in this expression come from the coefficients of @xmath94 and lower in the old expression .",
    "since these lower coefficients were exactly correct , it immediately follows that the coefficient of @xmath118 in the new expression is correct also .",
    "thus , if we start with the expression @xmath119 , which is correct to order  @xmath120 , substitute it into  ( [ defsh1 ] ) , and iterate , then on each iteration we will generate an expression for @xmath109 that is accurate to one order higher .",
    "after @xmath4 iterations , we will have an expression in which the coefficients for all orders up to and including @xmath118 are exactly correct .",
    "take for example the erds ",
    "rnyi random graph with its poisson degree distribution , for which @xmath121 , as shown in section  [ examples ] .",
    "then , noting that @xmath122 for this case , we find that the first few iterations of eq .",
    "( [ defsh1 ] ) give    @xmath123    and so forth , from which we conclude that the probabilities @xmath124 of a randomly chosen site belonging to components of size @xmath125 are @xmath126    with a good symbolic manipulation program it is straightforward to calculate such probabilities to order 100 or so . if we require probabilities to higher order it is still possible to use eqs .",
    "( [ defsh1 ] ) and  ( [ defsh0 ] ) to get answers , by iterating  ( [ defsh1 ] ) numerically from a starting value of @xmath127 .",
    "doing this for a variety of different values of @xmath112 close to @xmath128 , we can use the results to calculate the derivatives of @xmath117 and so evaluate the  @xmath124 .",
    "unfortunately , this technique is only usable for the first few @xmath124 , because , as is usually the case with numerical derivatives , limits on the precision of floating - point numbers result in large errors at higher orders . to circumvent this problem",
    "we can employ a technique suggested by moore and newman  mn00b , and evaluate the derivatives instead by numerically integrating the cauchy formula @xmath129 where the integral is performed around any contour surrounding the origin but inside the first pole in  @xmath130 .",
    "for the best precision , moore and newman suggest using the largest such contour possible . in the present case , where @xmath124 is a properly normalized probability distribution",
    ", it is straightforward to show that @xmath130 must always converge within the unit circle and hence we recommend using this circle as the contour .",
    "doing so appears to give excellent results in practice  @xcite , with a thousand or more derivatives easily calculable in reasonable time .",
    "although , as we have seen , it is not usually possible to calculate the probability distribution of component sizes  @xmath124 to all orders in closed form , we can calculate moments of the distribution , which in many cases is more useful anyway .",
    "the simplest case is the first moment , the mean component size . as we saw in section  [ properties ] , the mean of the distribution generated by a generating function is given by the derivative of the generating function evaluated at unity ( eq .  ( [ mean ] ) ) .",
    "below the phase transition , the component size distribution is generated by @xmath117 , eq .",
    "( [ defsh0 ] ) , and hence the mean component size below the transition is @xmath131_{x=1 }         = 1 + g_0'(1 ) h_1'(1 ) , \\label{avs1}\\ ] ] where we have made use of the fact , eq .",
    "( [ normalization ] ) , that properly normalized generating functions are equal to  1 at @xmath132 , so that @xmath133 .",
    "the value of @xmath134 we can calculate from eq .",
    "( [ defsh1 ] ) by differentiating and rearranging to give @xmath135 and substituting into  ( [ avs1 ] ) we find @xmath136 this expression can also be written in a number of other forms .",
    "for example , we note that @xmath137 where we have made use of eq .",
    "( [ z2 ] ) . substituting into  ( [ avs2 ] )",
    "then gives the average component size below the transition as @xmath138    this expression has a divergence at @xmath139 , which signifies the formation of the giant component and gives an alternative and more rigorous derivation of the position of the critical point to that given in section  [ rg ] . using eq .",
    "( [ avs2 ] ) , we could also write the condition for the phase transition as @xmath140 .      the calculations of the previous sections concerned the behaviour of the graph below the phase transition where there is no giant component in the graph .",
    "almost all graphs studied empirically seem to be in the regime above the transition and do have a giant component .",
    "( this may be a tautologous statement , since it probably rarely occurs to researchers to consider a network representation of a set of objects or people so loosely linked that there is no connection between most pairs . )",
    "can our generating function techniques be extended to this regime ?",
    "as we now show , they can , although we will have to use some tricks to make things work .",
    "the problem is that the giant component is not a component like those we have considered so far .",
    "those components had a finite average size , which meant that in the limit of large graph size they were all tree - like , containing no closed loops , as discussed in section  [ sizes ] .",
    "the giant component , on the other hand , scales , by definition , as the size of the graph as a whole , and therefore becomes infinite as @xmath107 .",
    "this means that there will in general be loops in the giant component , which makes all the arguments of the previous sections break down .",
    "this problem can be fixed however by the following simple ploy . above the transition , we define @xmath117 and @xmath109 to be the generating functions for the distributions of component sizes _ excluding _ the giant component .",
    "the non - giant components are still tree - like even above the transition , so eqs .",
    "( [ defsh1 ] ) and  ( [ defsh0 ] ) are correct for this definition .",
    "the only difference is that now @xmath141 is no longer equal to  1 ( and neither is @xmath142 ) .",
    "instead , @xmath143 which follows because the sum over @xmath144 is now over only the non - giant components , so the probabilities @xmath124 no longer add up to  1 .",
    "this result is very useful ; it allows us to calculate the size  @xmath10 of the giant component above the transition as a fraction of the total graph size , since @xmath145 . from eqs .",
    "( [ defsh1 ] ) and  ( [ defsh0 ] ) , we can see that @xmath10 must be the solution of the equations @xmath146 where @xmath147 . as with the calculation of the component size distribution in section",
    "[ sizes ] , these equations are not normally solvable in closed form , but a solution can be found to arbitrary numerical accuracy by iteration starting from a suitable initial value of  @xmath148 , such as @xmath149 .",
    "we can also calculate the average sizes of the non - giant components in the standard way by differentiating eq .",
    "( [ defsh0 ] ) .",
    "we must be careful however , for a couple of reasons .",
    "first , we can no longer assume that @xmath150 as is the case below the transition .",
    "second , since the distribution @xmath124 is not normalized to  1 , we have to perform the normalization ourselves .",
    "the correct expression for the average component size is @xmath151\\nonumber\\\\         & = & 1 + { zv^2\\over [ 1-s][1-g_1'(v)]},\\end{aligned}\\ ] ] where  @xmath148 and  @xmath10 are found from eq .",
    "( [ defsu ] ) .",
    "it is straightforward to verify that this becomes equal to eq .",
    "( [ avs2 ] ) when we are below the transition and @xmath152 , @xmath153 .    as an example of these results ,",
    "we show in fig .",
    "[ gcavs ] the size of the giant component and the average ( non - giant ) component size for graphs with an exponential degree distribution of the form of eq .",
    "( [ expdist ] ) , as a function of the exponential constant  @xmath102 .",
    "as the figure shows , there is a divergence in the average component size at the phase transition , with the giant component becoming non - zero smoothly above the transition .",
    "those accustomed to the physics of continuous phase transitions will find this behaviour familiar ; the size of the giant component acts as an order parameter here , as it did in the erds  rnyi random graph in the introduction to this paper , and the average component size behaves like a susceptibility . indeed one can define and calculate critical exponents for the transition using this analogy , and as with the erds  rnyi model , their values put us in the same universality class as the mean - field ( i.e. ,  infinite dimension ) percolation transition @xcite .",
    "the phase transition in fig .",
    "[ gcavs ] takes place just a little below @xmath154 when @xmath140 , which gives a critical value of @xmath155",
    "some of the graphs discussed in the introduction to this paper are directed graphs .",
    "that is , the edges in the network have a direction to them .",
    "examples are the world - wide web , in which hyperlinks from one page to another point in only one direction , and food webs , in which predator  prey interactions are asymmetric and can be thought of as pointing from predator to prey .",
    "other recently studied examples of directed networks include telephone call graphs @xcite , citation networks @xcite , and email networks @xcite .    directed networks are more complex than their undirected counterparts . for a start , each vertex in an directed network has two degrees , an in - degree , which is the number of edges that point into the vertex , and an out - degree , which is the number pointing out .",
    "there are also , correspondingly , two degree distributions .",
    "in fact , to be completely general , we must allow for a joint degree distribution of in- and out - degree : we define @xmath156 to be the probability that a randomly chosen vertex simultaneously has in - degree  @xmath71 and out - degree  @xmath26 . defining a joint distribution like this allows for the possibility that the in- and out - degrees may be correlated .",
    "for example in a graph where every vertex had precisely the same in- and out - degree , @xmath156  would be non - zero if and only if @xmath157 .",
    "the component structure of a directed graph is more complex than that of an undirected graph also , because a directed path may exist through the network from vertex  a to vertex  b , but that does not guarantee that one exists from b to  a. as a result , any vertex  a belongs to components of four different types :    1 .",
    "the in - component is the set of vertices from which a can be reached .",
    "the out - component is the set of vertices which can be reached from  a. 3 .",
    "the strongly connected component is the set of vertices from which vertex  a can be reached _ and _ which can be reached from  a. 4 .",
    "the weakly connected component is the set of vertices that can be reached from  a ignoring the directed nature of the edges altogether .",
    "the weakly connected component is just the normal component to which a belongs if one treats the graph as undirected .",
    "clearly the details of weakly connected components can be worked out using the formalism of section  [ undirected ] , so we will ignore this case . for vertex",
    "a to belong to a strongly connected component of size greater than one , there must be at least one other vertex that can both be reached from  a and from which a can be reached .",
    "this however implies that there is a closed loop of directed edges in the graph , something which , as we saw in section  [ sizes ] , does not happen in the limit of large graph size .",
    "so we ignore this case also .",
    "the two remaining cases , the in- and out - components , we consider in more detail in the following sections .      because the degree distribution @xmath156 for a directed graph is a function of two variables , the corresponding generating function is also : @xmath158 this function satisfies the normalization condition @xmath159 , and the means of the in- and out - degree distributions are given by its first derivatives with respect to @xmath112 and  @xmath160 .",
    "however , there is _ only one _ mean degree @xmath7 for a directed graph , since every edge must start and end at a site .",
    "this means that the total and hence also the average numbers of in - going and out - going edges are the same .",
    "this gives rise to a constraint on the generating function of the form @xmath161 and there is a corresponding constraint on the probability distribution @xmath156 itself , which can be written @xmath162    from @xmath163 , we can now define single - argument generating functions @xmath87 and @xmath164 for the number of out - going edges leaving a randomly chosen vertex , and the number leaving the vertex reached by following a randomly chosen edge .",
    "these play a similar role to the functions of the same name in section  [ undirected ] .",
    "we can also define generating functions @xmath165 and @xmath166 for the number of edges arriving at a vertex .",
    "these functions are given by @xmath167 once we have these functions , many results follow as before .",
    "the probability distribution of the numbers of vertices reachable from a randomly chosen vertex in a directed graph ",
    "i.e . ,  of the sizes of the out - components",
    " is generated by the function @xmath168 , where @xmath169 is a solution of @xmath170 , just as before .",
    "( a similar and obvious pair of equations governs the sizes of the in - components . )",
    "the average out - component size for the case where there is no giant component is then given by eq .",
    "( [ avs2 ] ) , and thus the point at which a giant component first appears is given once more by @xmath171 .",
    "substituting eq .",
    "( [ defsg0g1 ] ) into this expression gives the explicit condition @xmath172 for the first appearance of the giant component .",
    "this expression is the equivalent for the directed graph of eq .",
    "( [ mrcondition ] ) .",
    "it is also possible , and equally valid , to define the position at which the giant component appears by @xmath173 , which provides an alternative derivation for eq .",
    "( [ directedpt ] ) .",
    "but this raises an interesting issue . which giant component are we talking about ?",
    "just as with the small components , there are four types of giant component , the giant in- and out - components , and the giant weakly and strongly connected components . furthermore , while the giant weakly connected component is as before trivial , the giant strongly connected component does not normally vanish as the other strongly connected components do .",
    "there is no reason why a giant component should contain no loops , and therefore no reason why we should not have a non - zero giant strongly connected component .",
    "the condition for the position of the phase transition given above is derived from the point at which the mean size of the out - component reachable from a vertex diverges , and thus this is the position at which the giant _ in_-component forms ( since above this point an extensive number of vertices can be reached starting from one vertex , and hence that vertex must belong to the giant in - component ) .",
    "furthermore , as we have seen , we get the same condition if we ask where the mean in - component size diverges , i.e. ,  where the giant _ out_-component forms , and so we conclude that both giant in- and out - components appear at the same time , at the point given by eq .",
    "( [ directedpt ] ) .",
    "the sizes of these two giant components can also be calculated with only a little extra effort .",
    "as before , we can generalize the functions @xmath174 and @xmath169 to the regime above the transition by defining them to be the generating functions for the non - giant out - components in this regime . in that case , @xmath141 is equal to the fraction of all vertices that have a finite out - component .",
    "but any vertex  a that has only a finite out - component can not , by definition , belong to the giant _",
    "_ in-__component , i.e. ,  there definitely do not exist an extensive number of vertices that can be reached from  a. thus the size of the giant in - component is simply @xmath175 , which can be calculated as before from eq .",
    "( [ defsu ] ) .",
    "similarly the size of the giant out - component can be calculated from  ( [ defsu ] ) with @xmath176 and @xmath177 .    to calculate the size of the giant strongly connected component",
    ", we observe the following @xcite . if at least one of a vertex s outgoing edges leads to anywhere in the giant _",
    "in_-component , then one can reach the giant strongly connected component from that vertex .",
    "conversely , if at least one of a vertex s incoming edges leads from anywhere in the giant _",
    "out_-component , then the vertex can be reached from the strongly connected component . if and only if both of these conditions are satisfied simultaneously , then the vertex belongs to the giant strongly connected component itself .",
    "consider then the outgoing edges .",
    "the function @xmath109 gives the probability distribution of the sizes of finite out - components reached by following a randomly chosen edge .",
    "this implies that @xmath142 is the total probability that an edge leads to a finite out - component ( i.e. ,  _ not _ to the giant in - component ) and as before ( eq .  ( [ defsu ] ) ) @xmath142 is the fixed point of @xmath98 , which we denote by  @xmath148 . for a vertex with @xmath26 outgoing edges ,",
    "@xmath178  is then the probability that all of them lead to finite components and @xmath179 is the probability that at least one edge leads to the giant in - component .",
    "similarly the probability that at least one incoming edge leads from the giant out - component is @xmath180 , where @xmath181 is the fixed point of @xmath182 and @xmath71 is the in - degree of the vertex .",
    "thus the probability that a vertex with in- and out - degrees @xmath71 and @xmath26 is in the giant strongly connected component is @xmath183 , and the average of this probability over all vertices , which is also the fractional size of the giant strongly connected component ,  is @xmath184 where @xmath181 and @xmath148 are solutions of @xmath185 and we have made use of the definition , eq .",
    "( [ jointgen ] ) , of @xmath163 .",
    "noting that @xmath186 below the transition at which the giant in- and out - components appear , and that @xmath159 , we see that the giant strongly connected component also first appears at the transition point given by eq .",
    "( [ directedpt ] ) .",
    "thus there are in general two phase transitions in a directed graph : the one at which the giant weakly connected component appears , and the one at which the other three giant components all appear .",
    "applying the theory of directed random graphs to real directed networks has proved difficult so far , because experimenters rarely measure the joint in- and out - degree distribution @xmath156 that is needed to perform the calculations described above .",
    "a few results can be calculated without the joint distribution  see newman  _ et  al . _",
    "nsw01 , for instance . by and large ,",
    "however , the theory presented in this section is still awaiting empirical tests .",
    "far fewer analytical results exist for networks that incorporate clustering than for the non - clustered networks of the previous sections . a first attempt at extending random graph models to incorporate clustering has been made by the present author , who studied the correction to the quantity @xmath49the average number of next - nearest neighbours of a vertex  in graphs with a non - zero clustering coefficient  @xmath13 @xcite .    consider a vertex  a , with its first and second neighbours in the network arrayed around it in two concentric rings . in a normal random graph",
    ", a neighbour of  a that has degree @xmath4 contributes @xmath187 vertices to the ring of second neighbours of  a , as discussed in section  [ rg ] .",
    "that is , all of the second neighbours of  a are independent ; each of them is a new vertex never before seen .",
    "this is the reasoning that led to our earlier expression , eq .",
    "( [ z2 ] ) : @xmath188 . in a clustered network",
    "however , the picture is different . in a clustered network , many of the neighbours of a s neighbour are neighbours of  a themselves .",
    "this is the meaning of clustering : your friend s friend is also your friend . in fact , by definition , an average fraction @xmath13 of the @xmath187 neighbours are themselves neighbours of the central vertex  a and hence should not be counted as second neighbours .",
    "correspondingly , this reduces our estimate of @xmath49 by a factor of @xmath189 to give @xmath190 .    but",
    "this is not all .",
    "there is another effect we need to take into account if we are to estimate @xmath49 correctly .",
    "it is also possible that we are overcounting the second neighbours of  a because some of them are neighbours of more than one of the first neighbours .",
    "in other words , you may know two people who have another friend in common , whom you personally do nt know .",
    "such connections create `` squares '' in the network , whose density can be quantified by the so - called mutuality  @xmath191 : @xmath192 in words , @xmath191 measures the average number of paths of length two leading to a vertex s second neighbour . as a result of the mutuality effect",
    ", our current estimate of @xmath49 will be too great by a factor of  @xmath193 , and hence a better estimate is @xmath194    but now we have a problem . calculating the mutuality @xmath191 using eq .",
    "( [ defsm ] ) requires that we know the mean number of individuals two steps away from the central vertex  a. but this mean number is precisely the quantity @xmath49 that our calculation is supposed to estimate in the first place .",
    "there is a partial solution to this problem .",
    "consider the two configurations depicted in fig .",
    "[ arrangement ] , parts  ( a ) and  ( b ) . in  ( a ) our vertex  a has two neighbours d and  e , both of whom are connected to  f , although f is not itself an neighbour of  a. the same is true in  ( b ) , but now d and  e are friends of one another also .",
    "empirically , it appears that in many networks situation  ( a ) is quite uncommon , while situation  ( b ) is much more common .",
    "and we can estimate the frequency of occurrence of ( b ) from a knowledge of the clustering coefficient .",
    "consider fig .",
    "[ arrangement]c .",
    "the central vertex  a shares an edge with  d , which shares an edge with  f. how many other paths of length two are there from  a to  f ?",
    "well , if a has @xmath195 neighbours , then by the definition of the clustering coefficient , d  will be connected to @xmath196 of them on average .",
    "the edge between vertices  d and  e in the figure is an example of one such .",
    "but now  d is connected to both e and  f , and hence , using the definition of the clustering coefficient again , e  and  f will themselves be connected ( dotted line ) with probability equal to the clustering coefficient  @xmath13 . thus there will on average be @xmath197 other paths of length  2 to  f , or @xmath198 paths in total , counting the one that runs through  d.",
    "this is the average factor by which we will overcount the number of second neighbours of  a because of the mutuality effect .",
    "as shown by newman  newman02a , the mutuality coefficient is then given by @xmath199\\rangle}\\over{\\langlek\\rangle}}. \\label{mutuality}\\ ] ] substituting this into eq .",
    "( [ betterz2 ] ) then gives us an estimate of  @xmath49 .",
    "in essence what eq .",
    "( [ mutuality ] ) does is estimate the value of @xmath191 in a network in which triangles of ties are common , but squares that are not composed of adjacent triangles are assumed to occur with frequency no greater than one would expect in a purely random network .",
    "it is only an approximate expression , since this assumption will usually not be obeyed perfectly .",
    "nonetheless , it appears to give good results .",
    "the author applied eqs .",
    "( [ betterz2 ] ) and  ( [ mutuality ] ) to estimation of @xmath49 for the two coauthorship networks of fig .",
    "[ degree]c , and found that they gave results accurate to within 10% in both cases .",
    "this calculation is certainly only a first step .",
    "ideally we would like to be able to calculate numbers of vertices at any distance from a randomly chosen central vertex in the presence of clustering , and to do it exactly rather than just approximately .",
    "if this were possible , then , as in section  [ rg ] , one could use the ratio of the numbers of vertices at different distances to derive a condition for the position of the phase transition at which a giant component forms on a clustered graph .",
    "at present it is not clear if such a calculation is possible .",
    "in addition to providing an analytic framework for calculating topological properties of networks , such as typical path lengths or distributions of cluster sizes , random graphs form a useful substrate for studying the behaviour of phenomena that take place on networks . analytic work in this area",
    "is in its infancy ; here we describe two examples of recent work on models that use ideas drawn from percolation theory .      as emphasized by albert and co - workers , the highly skewed degree distributions of fig .",
    "[ degree ] have substantial implications for the robustness of networks to the removal of vertices @xcite . because most of the vertices in a network with such a degree distribution typically have low degree , the random removal of vertices from the network has little effect on the connectivity of the remaining vertices , i.e. ,  on the existence of paths between pairs of vertices , a crucial property of networks such as the internet , for which functionality relies on connectivity . in particular , removal of vertices with degree zero or",
    "one will never have any effect on the connectivity of the remaining vertices .",
    "( vertices of degree zero are not connected to anyone else anyway , and vertices of degree one do not lie on any path between another pair of vertices . )",
    "conversely , however , the specific removal of the vertices in the network with the highest degree frequently has a devastating effect .",
    "these vertices lie on many of the paths between pairs of other vertices and their removal can destroy the connectivity of the network in short order .",
    "this was first demonstrated numerically by albert  _ et  al . _",
    "ajb00 and independently by broder  _ et  al . _",
    "broder00 using data for subsets of the world - wide web .",
    "more recently however it has been demonstrated analytically also , for random graphs with arbitrary degree distributions , by callaway  _ et  al . _",
    "cnsw00 and by cohen  _ et  al .",
    "_  cebh01 . here",
    "we follow the derivation of callaway  _ et  al .",
    "_ , which closely mirrors some of the earlier mathematical developments of this paper .",
    "consider a simple model defined on a network in which each vertex is either `` present '' or `` absent '' .",
    "absent vertices are vertices that have either been removed , or more realistically are present but non - functional , such as internet routers that have failed or web sites whose host computer has gone down .",
    "we define a probability @xmath200 of being present which is some arbitrary function of the degree  @xmath26 of a vertex , and then define the generating function @xmath201 whose coefficients are the probabilities that a vertex has degree  @xmath26 and is present .",
    "note that this generating function is not equal to  1 at @xmath132 ; instead it is equal to the fraction of all vertices that are present . by analogy with eq .",
    "( [ defsg1 ] ) we also define @xmath202 then the distributions of the sizes of connected clusters of present vertices reachable from a randomly chosen vertex or edge are generated respectively by @xmath203 which are logical equivalents of eqs .",
    "( [ defsh1 ] ) and  ( [ defsh0 ] ) .",
    "take for instance the case of random failure of vertices . in this case",
    ", the probability @xmath200 of a vertex being present is independent of the degree  @xmath26 and just equal to a constant  @xmath204 , which means that @xmath205 where @xmath85 and @xmath98 are the standard generating functions for vertex degree , eqs .",
    "( [ defsg0 ] ) and  ( [ defsg1 ] ) .",
    "this implies that the mean size of a cluster of connected and present vertices is @xmath206,\\ ] ] and the model has a phase transition at the critical value of  @xmath204 @xmath207 if a fraction @xmath208 of the vertices are present in the network , then there will be no giant component .",
    "this is the point at which the network ceases to be functional in terms of connectivity .",
    "when there is no giant component , connecting paths exist only within small isolated groups of vertices , but no long - range connectivity exists . for a communication network such as the internet , this would be fatal . as we would expect from the arguments above however , @xmath209  is usually a very small number for networks with skewed degree distributions .",
    "for example , if a network has a pure power - law degree distribution with exponent  @xmath210 , as both the internet and the world - wide web appear to do ( see fig .  [ degree]a and  [ degree]b ) , then @xmath211 where @xmath212 is the riemann @xmath213-function .",
    "this expression is formally zero for all @xmath214 . since none of the distributions in fig .",
    "[ degree ] have an exponent greater than  3 , it follows that , at least to the extent that these graphs can be modelled as random graphs , none of them has a phase transition at all .",
    "no matter how many vertices fail in these networks , as long as the failing vertices are selected at random without regard for degree , there will always be a giant component in the network and an extensive fraction of the vertices will be connected to one another . in this sense ,",
    "networks with power - law distributed degrees are highly robust , as the numerical experiments of albert  _ et  al .",
    "_  ajb00 and broder  _ et  al . _",
    "broder00 also found .    but now consider the case in which the vertices are removed in decreasing order of their degrees , starting with the highest degree vertex .",
    "mathematically we can represent this by setting @xmath215 where @xmath216 is the heaviside step function @xmath217 this is equivalent to setting the upper limit of the sum in eq .",
    "( [ defsf0 ] ) to @xmath218 .    for this case",
    "we need to use the full definition of @xmath117 and @xmath109 , eq .",
    "( [ fullh0h1 ] ) , which gives the position of the phase transition as the point at which @xmath173 , or @xmath219 taking the example of our power - law degree distribution again , @xmath220 , this then implies that the phase transition occurs at a value @xmath221 of @xmath218 satisfying @xmath222 where @xmath223 is the @xmath0th harmonic number of order  @xmath58 : @xmath224    this solution is not in a very useful form however .",
    "what we really want to know is what fraction @xmath225 of the vertices have been removed when we reach the transition .",
    "this fraction is given by @xmath226 although we can not eliminate @xmath221 from  ( [ defskc ] ) and  ( [ defsfc ] ) to get @xmath225 in closed form , we can solve eq .",
    "( [ defskc ] ) numerically for @xmath221 and substitute into  ( [ defsfc ] ) .",
    "the result is shown as a function of @xmath210 in fig .",
    "[ figfc ] .",
    "as the figure shows , one need only remove a very small fraction of the high - degree vertices to destroy the giant component in a power - law graph , always less than  3% , with the most robust graphs being those around @xmath227 , interestingly quite close to the exponent seen in a number of real - world networks ( fig .",
    "( [ degree ] ) ) .",
    "below @xmath228 , there is no real solution for @xmath225 : power - law distributions with @xmath229 have no finite mean anyway and therefore make little sense physically . and @xmath230 for all values @xmath231 , where the latter figure is the solution of @xmath232 , because the underlying network itself has no giant component for such values of  @xmath210 @xcite .",
    "overall , therefore , our results agree with the findings of the previous numerical studies that graphs with skewed degree distributions , such as power laws , can be highly robust to the random removal of vertices , but extremely fragile to the specific removal of their highest - degree vertices .",
    "an important application of the theory of networks is in epidemiology , the study of the spread of disease .",
    "diseases are communicated from one host to another by physical contact , and the pattern of who has contact with whom forms a contact network whose structure has implications for the shape of epidemics .",
    "in particular , the small - world effect discussed in section  [ rg ] means that diseases will spread through a community much faster than one might otherwise imagine .    in the standard mathematical treatments of diseases , researchers use the so - called fully mixed approximation , in which it is assumed that every individual has equal chance of contact with every other .",
    "this is an unrealistic assumption , but it has proven popular because it allows one to write differential equations for the time evolution of the disease that can be solved or numerically integrated with relative ease .",
    "more realistic treatments have also been given in which populations are divided into groups according to age or other characteristics .",
    "these models are still fully mixed within each group however . to go beyond these approximations ,",
    "we need to incorporate a full network structure into the model , and the random graphs of this paper and the generating function methods we have developed to handle them provide a good basis for doing this .    in this section",
    "we show that the most fundamental standard model of disease propagation , the sir model , and a large set of its generalized forms , can be solved on random graphs by mapping them onto percolation problems .",
    "these solutions provide exact criteria for deciding when an epidemic will occur , how many people will be affected , and how the network structure or the transmission properties of the disease could be modified in order to prevent the epidemic .",
    "first formulated ( though never published ) by lowell reed and wade hampton frost in the 1920s , the sir model @xcite is a model of disease propagation in which members of a population are divided into three classes : susceptible  ( s ) , meaning they are free of the disease but can catch it ; infective  ( i ) , meaning they have the disease and can pass it on to others ; and removed  ( r ) , meaning they have recovered from the disease or died , and can no longer pass it on .",
    "there is a fixed probability per unit time that an infective individual will pass the disease to a susceptible individual with whom they have contact , rendering that individual infective .",
    "individuals who contract the disease remain infective for a certain time period before recovering ( or dying ) and thereby losing their infectivity .",
    "as first pointed out by grassberger  grassberger83 , the sir model on a network can be simply mapped to a bond percolation process .",
    "consider an outbreak on a network that starts with a single individual and spreads to encompass some subset of the network .",
    "the vertices of the network represent potential hosts and the edges represent pairs of hosts who have contact with one another . if we imagine occupying or colouring in all the edges that result in transmission of the disease during the current outbreak , then the set of vertices representing the hosts infected in this outbreak form a connected percolation cluster of occupied edges .",
    "furthermore , it is easy to convince oneself that each edge is occupied with independent probability . if we denote by @xmath233 the time for which an infected host remains infective and by @xmath58 the probability per unit time that that host will infect one of its neighbours in the network , then the total probability of infection is @xmath234 this quantity we call the transmissibility , and it is the probability that any edge on the network is occupied . the size distribution of outbreaks of the disease is then given by the size distribution of percolation clusters on the network when edges are occupied with this probability .",
    "when the mean cluster size diverges , we get outbreaks that occupy a finite fraction of the entire network , i.e. ,  epidemics ; the percolation threshold corresponds to what an epidemiologist would call the epidemic threshold for the disease . above this threshold , there exists a giant component for the percolation problem , whose size corresponds to the size of the epidemic .",
    "thus , if we can solve bond percolation on our random graphs , we can also solve the sir model .",
    "in fact , we can also solve a generalized form of the sir in which both @xmath233 and @xmath58 are allowed to vary across the network . if @xmath233 and @xmath58 instead of being constant are picked at random for each vertex or edge from some distributions @xmath235 and @xmath236 ,",
    "then the probability of percolation along any edge is simply the average of eq .",
    "( [ defstrans1 ] ) over these two distributions @xcite : @xmath237      the bond percolation problem on a random graph can be solved by techniques very similar to those of section  [ resilience ] @xcite .",
    "the equivalent of eq .",
    "( [ siteperc ] ) for bond percolation with bond occupation probability  @xmath238 is @xmath239 which gives an average outbreak size below the epidemic threshold of @xmath240 the threshold itself then falls at the point where @xmath241 , giving a critical transmissibility of @xmath242 where we have used eq .",
    "( [ z2 ] ) .",
    "the size  @xmath10 of the epidemic above the epidemic transition can be calculated by finding the solution of @xmath243 which will normally have to be solved numerically , since closed form solutions are rare .",
    "it is also interesting to ask what the probability is that an outbreak starting with a single carrier will become an epidemic .",
    "this is precisely equal to the probability that the carrier belongs to the giant percolating cluster , which is also just equal to  @xmath10 .",
    "the probability that a given infection event ( i.e. ,  transmission along a given edge ) will give rise to an epidemic is @xmath244 .",
    "newman and co - workers have given a variety of further generalizations of these solutions to networks with structure of various kinds , models in which the probabilities of transmission between pairs of hosts are correlated in various ways , and models incorporating vaccination , either random or targeted , which is represented as a site percolation process @xcite .",
    "to give one example , consider the network by which a sexually transmitted disease is communicated , which is also the network of sexual partnerships between individuals .",
    "in a recent study of 2810 respondents , liljeros  _ et  al .",
    "_  liljeros01 recorded the numbers of sexual partners of men and women over the course of a year . from their data",
    "it appears that the distributions of these numbers follow a power law similar to those of the distributions in fig .",
    "[ degree ] , with exponents @xmath210 that fall in the range @xmath245 to  @xmath246 .",
    "if we assume that the disease of interest is transmitted primarily by contacts between men and women ( true only for some diseases ) , then to a good approximation the network of contacts is bipartite , having two separate sets of vertices representing men and women and edges representing contacts running only between vertices of unlike kinds .",
    "we define two pairs of generating functions for males and females : @xmath247 where @xmath248 and @xmath70 are the two degree distributions and @xmath249 and @xmath250 are their means .",
    "we can then develop expressions similar to eqs .",
    "( [ outbreak ] ) and  ( [ epidemic ] ) for an epidemic on this new network .",
    "we find , for instance , that the epidemic transition takes place at the point where @xmath251 $ ] where @xmath252 and @xmath253 are the transmissibilities for male - to - female and female - to - male infection respectively .",
    "one important result that follows immediately is that if the degree distributions are truly power - law in form , then there exists an epidemic transition only for a small range of values of the exponent @xmath210 of the power law .",
    "let us assume , as appears to be the case @xcite , that the exponents are roughly equal for men and women : @xmath254 .",
    "then if @xmath214 , we find that @xmath255 , which is only possible if at least one of the transmissibilities @xmath252 and @xmath253 is zero .",
    "as long as both are positive , we will always be in the epidemic regime , and this would clearly be bad news .",
    "no amount of precautionary measures to reduce the probability of transmission would ever eradicate the disease .",
    "( similar results have been seen in other types of models also @xcite . )",
    "conversely , if @xmath256 , where @xmath257 is the solution of @xmath232 , we find that @xmath258 , which is not possible .",
    "( this latter result arises because networks with @xmath256 have no giant component at all , as mentioned in section  [ resilience ] @xcite . ) in this regime then , no epidemic can ever occur , which would be good news . only in the small intermediate region @xmath259",
    "does the model possess an epidemic transition .",
    "interestingly , the real - world network measured by liljeros  _ et  al . _  liljeros01 appears to fall precisely in this region , with @xmath260 .",
    "if true , this would be both good and bad news . on the bad side",
    ", it means that epidemics can occur .",
    "but on the good side , it means that that it is in theory possible to prevent an epidemic by reducing the probability of transmission , which is precisely what most health education campaigns attempt to do .",
    "the predicted critical value of the transmissibility is @xmath261 $ ] , which gives @xmath262 for @xmath263 .",
    "epidemic behaviour would cease were it possible to arrange that @xmath264 .",
    "in this paper we have given an introduction to the use of random graphs as models of real - world networks .",
    "we have shown ( section  [ rg ] ) how the much studied random graph model of erds and rnyi can be generalized to the case of arbitrary degree distributions , allowing us to mimic the highly skewed degree distributions seen in many networks .",
    "the resulting models can be solved exactly using generating function methods in the case where there is no clustering ( sections  [ gfs ] and  [ undirected ] ) .",
    "if clustering is introduced , then solutions become significantly harder , and only a few approximate analytic results are known ( section  [ ripples ] ) .",
    "we have also given solutions for the properties of directed random graphs ( section  [ directed ] ) , in which each edge has a direction that it points in .",
    "directed graphs are useful as models of the world - wide web and food webs , amongst other things . in the last part of this paper ( section  [ models ] ) we have given two examples of the use of random graphs as a substrate for models of dynamical processes taking place on networks , the first being a model of network robustness under failure of vertices ( e.g. ,  failure of routers on the internet ) , and the second being a model of the spread of disease across the network of physical contacts between disease hosts .",
    "both of these models can be mapped onto percolation problems of one kind of another , which can then be solved exactly , again using generating function methods .",
    "there are many conceivable extensions of the theory presented in this paper .",
    "in particular , there is room for many more and diverse models of processes taking place on networks .",
    "it would also be of great interest if it proved possible to extend the results of section  [ ripples ] to obtain exact or approximate estimates of the global properties of networks with non - zero clustering .",
    "the author thanks duncan callaway , peter dodds , michelle girvan , andr krzywicki , len sander , steve strogatz and duncan watts for useful and entertaining conversations .",
    "thanks are also due to jerry davis , paul ginsparg , jerry grossman , oleg khovayko , david lipman , heath oconnell , grigoriy starchenko , geoff west and janet wiener for providing data used in some of the examples .",
    "the original research described in this paper was supported in part by the us national science foundation under grant number dms0109086 .",
    "aiello , w. , chung , f. and lu , l. , 2000 . a random graph model for massive graphs .",
    "in _ proceedings of the 32nd annual acm symposium on theory of computing _ , pp . 171180 .",
    "association of computing machinery , new york .",
    "ancel , l.  w. , newman , m. e.  j. , martin , m. and schrag , s. , 2001 .",
    "applying network theory to epidemics : modelling the spread and control of mycoplasma pneumoniae .",
    "working paper 0112078 , santa fe institute ."
  ],
  "abstract_text": [
    "<S> the random graph of erds and rnyi is one of the oldest and best studied models of a network , and possesses the considerable advantage of being exactly solvable for many of its average properties . </S>",
    "<S> however , as a model of real - world networks such as the internet , social networks or biological networks it leaves a lot to be desired . in particular </S>",
    "<S> , it differs from real networks in two crucial ways : it lacks network clustering or transitivity , and it has an unrealistic poissonian degree distribution . </S>",
    "<S> in this paper we review some recent work on generalizations of the random graph aimed at correcting these shortcomings . </S>",
    "<S> we describe generalized random graph models of both directed and undirected networks that incorporate arbitrary non - poisson degree distributions , and extensions of these models that incorporate clustering too . </S>",
    "<S> we also describe two recent applications of random graph models to the problems of network robustness and of epidemics spreading on contact networks . </S>"
  ]
}