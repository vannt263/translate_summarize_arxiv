{
  "article_text": [
    "the problem of testing whether two data generating distributions are equal has been studied extensively in the statistical and machine learning literatures .",
    "practical applications range from speech recognition to fmri and genomic data analysis .",
    "parametric approaches typically test for divergence between two distributions using statistics based on a standardized difference of the two sample means , _",
    "e.g. _ , student s @xmath0-statistic in the univariate case or hotelling s @xmath1-statistic in the multivariate case  @xcite . a variety of non - parametric rank - based tests have also been proposed .",
    "more recently , @xcite and  @xcite devised kernel - based statistics for homogeneity tests in a function space .",
    "in several settings of interest , prior information on the structure of the distribution shift is available as a graph on the variables .",
    "specifically , suppose we observe @xmath2 from a first multivariate normal distribution @xmath3 and @xmath4 from a second such distribution @xmath5 . in cases where an undirected graph @xmath6 encoding some type of covariance information in @xmath7 is given ,",
    "the putative _ location _ or _ mean shift _ @xmath8 may be expected to be coherent with @xmath9 .",
    "that is , @xmath10 viewed as a function of @xmath9 is _ smooth _ , in the sense that the shifts @xmath11 and @xmath12 for two connected nodes @xmath13 and @xmath14 are similar .",
    "classical tests , such as hotelling s @xmath1-test , consider the null hypothesis @xmath15 against the alternative @xmath16 , without reference to the graph .",
    "our goal is to take into account the graph structure of the variables in order to build a more powerful two - sample test of means under smooth - shift alternatives .    just as a natural notion of smoothness of functions on a euclidean space",
    "can be defined through the notion of dirichlet energy and controlled by fourier decomposition and filtering  @xcite , it is well - known  @xcite that the smoothness of functions on a graph can be naturally defined and controlled through spectral analysis of the graph laplacian . in particular , the eigenvectors of the laplacian provide a basis of functions which vary on the graph at increasing frequencies ( corresponding to the increasing eigenvalues ) . in this paper , we propose to compare two populations in terms of the first few components of the graph - fourier basis or , equivalently , in the original space , after filtering out high - frequency components .",
    "an important motivation for the development of our graph - structured test is the detection of groups of genes whose expression changes between two conditions .",
    "for example , identifying groups of genes that are differentially expressed ( de ) between patients for which a particular treatment is effective and patients which are resistant to the treatment may give insight into the resistance mechanism and even suggest targets for new drugs .",
    "in such a context , expression data from high - throughput microarray and sequencing assays gain much in relevance from their association with graph - structured prior information on the genes , _",
    "e.g. _ , gene ontology ( go ; http://www.geneontology.org ) or kyoto encyclopedia of genes and genomes ( kegg ; http://www.genome.jp/kegg ) .",
    "most approaches to the joint analysis of gene expression data and gene graph data involve two distinct steps .",
    "firstly , tests of differential expression are performed separately for each gene .",
    "then , these univariate ( gene - level ) testing results are extended to the level of gene sets , _",
    "e.g. _ , by assessing the over - representation of de genes in each set based on @xmath17-values for fisher s exact test ( or a @xmath18 approximation thereof ) adjusted for multiple testing  @xcite or based on permutation adjusted @xmath17-values for weighted kolmogorov - smirnov - like statistics  @xcite . another family of methods directly performs multivariate tests of differential expression for groups of genes , _ e.g. _ , hotelling s",
    "@xmath1-test  @xcite .",
    "it is known  @xcite that the former family of approaches can lead to incorrect interpretations , as the sampling units for the tests in the second step become the genes ( as opposed to the patients ) and these are expected to have strongly correlated expression measures .",
    "this suggests that direct multivariate testing of gene set differential expression is more appropriate than posterior aggregation of individual gene - level tests . on the other hand , while hotelling s @xmath1-statistic is known to perform well in small dimensions , it loses power very quickly with increasing dimension  @xcite , essentially because it is based on the inverse of the empirical covariance matrix which becomes ill - conditioned .",
    "in addition , such direct multivariate tests on unstructured gene sets do not take advantage of information on gene regulation or other relevant biological properties . an increasing number of regulation networks are becoming available , specifying , for example , which genes activate or inhibit the expression of which other genes . as stated before , incorporating such biological knowledge in de tests is important . indeed ,",
    "if it is known that a particular gene in a tested gene set activates the expression of another , then one expects the two genes to have coherent ( differential ) expression patterns , _",
    "e.g. _ , higher expression of the first gene in resistant patients should be accompanied by higher expression of the second gene in these patients .",
    "accordingly , the first main contribution of this paper is to propose and validate multivariate test statistics for identifying distribution shifts that are coherent with a given graph structure .",
    "next , given a large graph and observations from two data generating distributions on the graph , a more general problem is the identification of smaller non - homogeneous subgraphs , _",
    "i.e. _ , subgraphs on which the two distributions ( restricted to these subgraphs ) are significantly different .",
    "this is very relevant in the context of tests for gene set differential expression : given a large set of genes , together with their known regulation network , or the concatenation of several such overlapping sets , it is important to discover novel gene sets whose expression change significantly between two conditions .",
    "currently - available gene sets have often been defined in terms of other phenomena than that under study and physicians may be interested in discovering sets of genes affecting in a concerted manner a specific phenotype .",
    "our second main contribution is therefore to develop algorithms that allow the exhaustive testing of all the subgraphs of a large graph , while accounting for the multiplicity issue arising from the vast number of subgraphs .    as the problem of identifying variables or groups of variables which differ in distribution between two populations is closely - related to supervised learning , our proposed approach is similar to several learning methods .",
    "@xcite use filtering in the fourier space of a graph to train linear classifiers of gene expression profiles whose weights are smooth on a gene network",
    ". however , their classifier enforces global smoothness on the large regularization network of all the genes , whereas we are concerned with the selection of gene sets with locally - smooth expression shift between populations . in  @xcite ,",
    "sparse learning methods are used to build a classifier based on a small number of gene sets .",
    "while this approach leads in practice to the selection of groups of variables whose distributions differ between the two classes , the objective is to achieve the best classification performance with the smallest possible number of groups . as a result , correlated groups of variables are typically not selected .",
    "other related work includes  @xcite , who proposed an adaptive neyman test in the fourier space for time - series .",
    "however , as illustrated below in section  [ sec : experiments ] , direct translation of the adaptive neyman statistic to the graph case is problematic , as assumptions on fourier coefficients which are true for time - series do not hold for graphs . in addition , the neyman statistic converges very slowly towards its asymptotic distribution and the required calibration by bootstrapping renders its application to our subgraph discovery context difficult .",
    "by contrast , other methods do not account for shift smoothness and try to address the loss of power caused by the poor conditioning of the @xmath1-statistic by applying it after dimensionality reduction  @xcite or by omitting the inverse covariance matrix and adjusting instead by its trace  @xcite .",
    "@xcite recently proposed de tests , where a probabilistic graphical model is built from a gene network .",
    "however , this model is used for gene - level de tests , which then have to be combined to test at the level of gene sets .",
    "several approaches for subgraph discovery , like that of  @xcite , are based on a heuristic to identify the most differentially expressed subgraphs and do not amount to testing exactly all the subgraphs . concerning the discovery of distribution - shifted subgraphs , @xcite",
    "propose a graph laplacian - based testing procedure to identify groups of interacting proteins whose genes contain a large number of mutations .",
    "their approach does not enforce any smoothness on the detected patterns ( smoothness is not necessarily expected in this context ) and the graph laplacian is only used to ensure that very connected genes do not lead to spurious detection . the gene expression network analysis ( gxna )",
    "method of @xcite detects differentially expressed subgraphs based on a greedy search algorithm and gene set de scoring functions that do not account for the graph structure .    the rest of this paper is organized as follows : section  [ sec : smooth ] introduces elements of fourier analysis for graphs which are needed to develop our method .",
    "section  [ sec : test ] presents our graph - structured two - sample test statistic and states results on power gain for smooth - shift alternatives .",
    "section  [ sec : discovery ] describes procedures for systematically testing all the subgraphs of a large graph .",
    "section  [ sec : experiments ] presents results for synthetic data as well as breast cancer gene expression and kegg data .",
    "finally , section  [ sec : discussion ] summarizes our findings and outlines ongoing work .",
    "the fundamental idea of harmonic analysis for functions defined on a euclidean space is to build a basis of the function space , such that each basis function varies at a different frequency .",
    "the basis functions are typically sinusoids .",
    "they were originally obtained in an attempt to solve the heat equation , as the eigenfunctions of the laplace operator , with corresponding eigenvalues proportional to the frequencies of the sinusoids .",
    "any function can then be decomposed on the basis as a linear combination of sinusoids of increasing frequency .",
    "the set of projections of the function on the basis sinusoids gives a dual representation of the function , often referred to as fourier transform .",
    "this representation is useful for filtering functions , by removing or shrinking coefficients associated with high frequencies , as these are typically expected to reflect noise , and then taking the inverse fourier transform .",
    "the resulting filtered function contains the same signal in the low frequencies as the original function .",
    "a related concept is the dirichlet energy of a function @xmath19 on an open subspace @xmath20 , defined as @xmath21 where @xmath22 is the gradient operator , a measure of variation that is consistent with the laplace operator . in particular ,",
    "the dirichlet energy of the basis functions is proportional to their associated frequencies .    for functions on a euclidean space , natural notions of smoothness , along with the dirichlet energy and dual representation in the frequency domain by projection on a fourier basis ,",
    "are therefore classically defined from the laplace operator and its spectral decomposition .",
    "likewise , notions of smoothness for functions on graphs can be defined based on the graph laplacian . specifically , consider an undirected graph @xmath23 , with @xmath24 nodes , adjacency matrix @xmath25 , and degree matrix @xmath26 , where @xmath27 is a unit column - vector , @xmath28 is the diagonal matrix with diagonal @xmath29 for any vector @xmath29 , and @xmath30 .",
    "let @xmath31 denote a function that associates a real value to each node of the graph @xmath9 .",
    "the laplacian matrix of @xmath9 is typically defined as @xmath32 or @xmath33 for the normalized version .",
    "more generally , given any gradient matrix @xmath34 , defined on @xmath9 and associating to each function on the graph its variation on each edge , it is possible to derive a corresponding laplacian matrix following the classical definition of the laplace operator , @xmath35 , where @xmath36 is the divergence operator defined as the negative of the adjoint operator of the gradient  @xcite . any desired notion of variation may be encoded in a gradient function and thus translated into its associated dirichlet energy @xmath37 , for a function @xmath19 defined on the graph @xmath9 . a common choice of gradient is the finite difference operator @xmath38 .",
    "this definition leads to the unnormalized laplacian above .",
    "the corresponding energy function is @xmath39 .",
    "let @xmath40 denote the spectral decomposition of the laplacian , where @xmath41 is the diagonal matrix of eigenvalues @xmath42 and the columns of the matrix @xmath43 are the corresponding eigenvectors @xmath44 .",
    "then , by definition , the eigenvectors of @xmath45 are functions of increasing energy , as @xmath46 for all @xmath47 . in the remainder of this paper",
    ", we denote by @xmath48 the fourier coefficients of a function @xmath19 defined on a graph .",
    "if the above two notions of smoothness are not appropriate for a particular application , other gradients , leading to other laplacian matrices , may be devised to build the function basis .",
    "for example , introducing weights on the edges of a graph and using these weights in the normalized version of the finite differences allows the incorporation of prior belief on where a shift in distributions is expected to be smooth . for applications like structured",
    "gene set differential expression detection , one may use negative weights for edges that reflect an expected negative correlation between two variables , _",
    "e.g. _ , a gene @xmath49 whose expression inhibits the expression of another gene @xmath50 . in this case , a small variation of the shift on the edge between @xmath49 and @xmath50 should correspond to a small @xmath51 .",
    "accordingly , the gradient should be defined as @xmath52 , where @xmath53 is @xmath54 for negative interactions and @xmath55 for positive interactions .",
    "the eigenvectors of the corresponding laplacian @xmath56 are functions of increasing @xmath57 , an appropriate notion of smoothness for the application at hand .",
    "a signed laplacian can be recovered from the classical definition @xmath58 , where @xmath59 is allowed to have negative entries .",
    "note that such a smoothness function is used as a penalty for semi - supervised learning in  @xcite .",
    "as an example , figure  [ fig : ev ] displays the eigenvectors of the signed laplacian @xmath56 for a simple four - node graph with @xmath60 the first eigenvector , corresponding to the smallest frequency ( eigenvalue of zero ) , can be viewed as a `` constant '' function on the graph , in the sense that its absolute value is identical for all the nodes , but nodes connected by an edge with negative weight take on values of opposite in sign . by contrast , the last eigenvector , corresponding to the highest frequency , is such that nodes connected by positive edges take on values of opposite sign and nodes connected by negative edges take on values of the same sign .     for a simple four - node graph .",
    "the corresponding eigenvalues are @xmath61 .",
    "nodes are colored according to the value of the eigenvector , where green corresponds to high positive values , red to high negative values , and black to @xmath62 .",
    "`` t''-shaped edges have negative weights.,title=\"fig : \" ]   for a simple four - node graph .",
    "the corresponding eigenvalues are @xmath61 .",
    "nodes are colored according to the value of the eigenvector , where green corresponds to high positive values , red to high negative values , and black to @xmath62 .",
    "`` t''-shaped edges have negative weights.,title=\"fig : \" ]   for a simple four - node graph .",
    "the corresponding eigenvalues are @xmath61 .",
    "nodes are colored according to the value of the eigenvector , where green corresponds to high positive values , red to high negative values , and black to @xmath62 .",
    "`` t''-shaped edges have negative weights.,title=\"fig : \" ]   for a simple four - node graph .",
    "the corresponding eigenvalues are @xmath61 .",
    "nodes are colored according to the value of the eigenvector , where green corresponds to high positive values , red to high negative values , and black to @xmath62 .",
    "`` t''-shaped edges have negative weights.,title=\"fig : \" ]",
    "for multivariate normal distributions , hotelling s @xmath1-test , a classical test of location shift , is known to be uniformly most powerful invariant against global - shift alternatives .",
    "the test statistic is based on the squared _ mahalanobis norm _ of the sample mean shift and is given by @xmath63 , where @xmath64 , @xmath65 , and @xmath66 denote , respectively , the sample sizes , means , and pooled covariance matrix , for random samples drawn from two @xmath17-dimensional gaussian distributions , @xmath67 , @xmath68 . under the null hypothesis @xmath15 of equal means , @xmath69 follows a ( central ) @xmath70-distribution @xmath71 , where @xmath72 . in general",
    ", @xmath69 follows a non - central @xmath70-distribution @xmath73 , where the non - centrality parameter is a function of the mahalanobis norm of the mean shift @xmath10 , @xmath74 , which we refer to as _ distribution shift_. in the remainder of this paper , unless otherwise specified , @xmath1-statistics are assumed to follow the nominal @xmath70-distribution , _",
    "e.g. _ , for critical value and power calculations .    for any graph - fourier basis @xmath43",
    ", direct calculation shows that @xmath75 , _",
    "i.e. _ , the statistic @xmath1 in the original space and the statistic @xmath76 in the graph - fourier space are identical .",
    "more generally , for @xmath77 , the statistic in the original space after filtering out frequencies above @xmath78 is the same as the statistic @xmath79 restricted to the first @xmath78 coefficients in the graph - fourier space : @xmath80 } \\left(u_{[k]}^\\top \\hat{\\sigma } u_{[k]}\\right)^{-1}u_{[k]}^\\top ( \\bar{x}_1 - \\bar{x}_2 ) \\\\ & = \\frac{n_1n_2}{n_1+n_2}(\\bar{x}_1 - \\bar{x}_2)^\\top u 1_{k } u^\\top \\left(u 1_{k } u^\\top \\hat{\\sigma }    u 1_{k } u^\\top\\right)^{+}u 1_{k } u^\\top ( \\bar{x}_1 - \\bar{x}_2),\\end{aligned}\\ ] ] where @xmath81 denotes the generalized inverse of a matrix @xmath25 , the @xmath82 matrix @xmath83}$ ] denotes the restriction of @xmath43 to its first @xmath78 columns , and @xmath84 is a @xmath85 diagonal matrix , with @xmath49th diagonal element equal to one if @xmath86 and zero otherwise . note that as retaining the first @xmath78 fourier components is a _ non - invertible _ transformation , this filtering indeed has an effect on the test statistic , that is , we have @xmath87 in general .",
    "as the mahalanobis norm is invariant to linear invertible transformations , using an invertible filtering ( such as weighting each fourier component according to its corresponding eigenvalue ) would have no impact on the test statistic .",
    "hotelling s @xmath1-test is known to behave poorly in high dimension ; the following lemma shows that gains in power can be achieved by filtering .",
    "specifically , let @xmath88 and @xmath89 denote , respectively , the mean shift and covariance matrix in the graph - fourier space .",
    "given @xmath77 , let @xmath90}^\\top\\left(\\sigma_{[k]}\\right)^{-1}\\delta_{[k]}$ ] denote the distribution shift restricted to the first @xmath78 dimensions of @xmath10 and @xmath91 , _ i.e. _ , based on only the first @xmath78 elements of @xmath10 , @xmath92 , and the first @xmath93 diagonal block of @xmath91 , @xmath94 .",
    "under the assumption that the distribution shift is smooth , _",
    "i.e. _ , lies mostly at the beginning of the graph spectrum , so that @xmath95 is nearly maximal for a small value of @xmath78 , lemma  [ lem : das ] states that performing hotelling s test in the graph - fourier space restricted to its first @xmath78 components yields more power than testing in the full graph - fourier space .",
    "equivalently , the test is more powerful in the original space after filtering than in the original unfiltered space .",
    "note that this result holds because retaining the first @xmath78 fourier components is a _ non - invertible _ transformation .",
    "[ lem : das ] for any level @xmath96 and any @xmath97 , there exists @xmath98 such that @xmath99 where @xmath100 is the power of hotelling s @xmath1-test at level @xmath96 in dimension @xmath78 for a distribution shift @xmath101 , according to the nominal @xmath70-distribution @xmath102 .",
    "this lemma is a direct application of corollary @xmath103 in  @xcite to hotelling s @xmath1-test in the graph - fourier space .",
    "the bottom line of the proof of  @xcite s result is that @xmath104 can be shown to be a continuous and strictly decreasing function of @xmath78 , so that a strictly positive increase in the non - centrality parameter @xmath101 of the @xmath70-distribution is necessary to maintain power when increasing dimension .",
    "in particular , a direct application of lemma  [ lem : das ] yields the following corollary :    [ cor : smooth ] if @xmath105 , then @xmath106    according to corollary  [ cor : smooth ] , if the distribution shift lies in the first @xmath78 fourier coefficients , then testing in this subspace yields strictly more power than using additional coefficients .",
    "in particular , if there exists @xmath107 such that @xmath108 ( _ i.e. _ , the mean shift is smooth ) and @xmath109 is block - diagonal such that @xmath110 , then gains in power are obtained by testing in the first @xmath78 fourier components . although non - necessary , this condition is plausible when the mean shift lies at the beginning of the spectrum , as the coefficients which do not contain the shift are not expected to be correlated with the ones that do contain it .",
    "note that the result in lemma  [ lem : das ] is even more general , as testing in the first @xmath78 fourier components can increase power even when the distribution shift partially lies in the remaining components , as long as the latter portion is below a certain threshold .",
    "figure  [ fig : shiftinc ] illustrates , under different settings , the increase in distribution shift necessary to maintain a given power level against the number of added coefficients .",
    "if for some reason one expects that the mean shift @xmath10 is smooth ( rather than the distribution shift @xmath111 ) , _ i.e. _ , @xmath112 lies at the beginning of the spectrum , and that the covariance between coefficients that contain the shift and those that do not is non - zero , then one should use test statistics based on estimators of the unstandardized _ euclidean norm _",
    "@xmath113 of this shift , _",
    "e.g. _ , @xmath114  @xcite[equation @xmath115 or @xmath116  @xcite .",
    "results similar to lemma  [ lem : das ] can be derived for these statistics .",
    "namely , the corresponding tests gain asymptotic power when applied at the beginning of the spectrum , provided the euclidean norm of @xmath10 only increases moderately as coefficients for higher frequencies are added .",
    "the results follow from  @xcite[theorem  @xmath117 and @xcite[equations @xmath118@xmath119 , using the fact that , by cauchy s interlacing theorem , the trace of the square of any positive semi - definite matrix is larger than the trace of the square of any principal submatrix .",
    "-test to maintain a given power when increasing the number of tested fourier coefficients : @xmath120 vs. @xmath121 such that @xmath122 .",
    "power @xmath123 computed under the non - central @xmath70-distribution @xmath124 , for @xmath125 observations , @xmath126 , and @xmath127 .",
    "each line corresponds to the fixed shift @xmath128 and power @xmath129 pair indicated in the legend .",
    "right : zoom on the first @xmath130 dimensions .",
    ", title=\"fig : \" ] -test to maintain a given power when increasing the number of tested fourier coefficients : @xmath120 vs. @xmath121 such that @xmath122 .",
    "power @xmath123 computed under the non - central @xmath70-distribution @xmath124 , for @xmath125 observations , @xmath126 , and @xmath127 .",
    "each line corresponds to the fixed shift @xmath128 and power @xmath129 pair indicated in the legend .",
    "right : zoom on the first @xmath130 dimensions .",
    ", title=\"fig : \" ]",
    "a systematic approach for discovering non - homogeneous subgraphs , _",
    "i.e. _ , subgraphs of a large graph that exhibit a significant shift in means , is to test all of them . in practice , however , this can represent an intractable number of tests , so it is important to be able to rapidly identify sets of subgraphs that all satisfy the null hypothesis of equal means . to this end , we devise a pruning approach based on an upper bound on the value of the test statistic for any subgraph containing a given set of nodes .",
    "given a large graph @xmath9 with @xmath17 nodes , we adopt the following classical branch - and - bound - like approach to test subgraphs of size @xmath131 at level @xmath96 .",
    "we start by checking , for each node in @xmath9 , whether the hotelling @xmath1-statistic in the first @xmath78 graph - fourier components of any subgraph of size @xmath132 containing this node can be guaranteed to be below the level-@xmath96 critical value @xmath133 ( _ e.g. _ , @xmath134-quantile of @xmath135 distribution ) .",
    "if this is the case , the node is removed from the graph .",
    "we then repeat the procedure on the edges of the remaining graph and , iteratively , on the subgraphs up to size @xmath136 , at which point we test all the remaining subgraphs of size @xmath132 .    specifically , for a subgraph @xmath137 of @xmath9 of size @xmath138 , hotelling s @xmath1-statistic in the first @xmath139 graph - fourier components of @xmath137 is defined as @xmath140 } \\left ( u_{[k]}^\\top \\hat{\\sigma}(g ) u_{[k ] } \\right)^{-1}u_{[k]}^\\top ( \\bar{x}_1(g ) - \\bar{x}_2(g)),\\ ] ] where @xmath83}$ ] is the @xmath141 restriction of the matrix of @xmath132 eigenvectors of the laplacian of @xmath137 to its first @xmath78 columns ( _ i.e. _ , @xmath83}(g)$ ] , where we omit @xmath137 to ease notation ) and @xmath142 , and @xmath143 are , respectively , the empirical means and pooled covariance matrix restricted to the nodes in @xmath137 . we make use of the following upper bound on @xmath144 .    [",
    "lem : neighbound ] for any subgraph @xmath137 of @xmath9 of size @xmath138 , any subgraph @xmath145 of @xmath137 of size @xmath146 , and any @xmath139 , then @xmath147 where @xmath148 is the @xmath149-neighborhood of @xmath145 , that is , the union of the nodes of @xmath145 and the nodes whose shortest path to a node of @xmath145 is less than or equal to @xmath149 .",
    "the proof involves the following result :    [ lem : bessel ] let @xmath150 be an invertible matrix and @xmath151 , @xmath77 , be a matrix with orthonormal columns . for any @xmath152 , @xmath153    first note",
    "that , by orthonormality of the columns of @xmath154 , @xmath155 is indeed invertible , and that @xmath156 where @xmath157 is an orthogonal projection , with eigenvalues either @xmath62 or @xmath55 . thus , @xmath158 is positive - semi - definite , as its eigenvalues are also either @xmath62 or @xmath55 .",
    "the result follows from properties of products of positive - semi - definite matrices .",
    "we can now prove lemma  [ lem : neighbound ] .    by lemma  [ lem : bessel ] , @xmath159 as @xmath160 ,",
    "applying lemma  [ lem : bessel ] a second time with the compression from @xmath161 to the nodes of @xmath137 yields the result .",
    "note that the bound takes into account the fact that the @xmath1-statistic is eventually computed in the first few components of a basis which is not known beforehand  : at each step , for each potential subgraph @xmath145 which would include the subgraph @xmath137 which we consider for pruning , the @xmath162 that we need to upper bound depends on the graph laplacian of @xmath145 .",
    "for `` small - world '' graphs above a certain level of connectivity and @xmath132 large enough , the @xmath163-neighborhood of @xmath145 , @xmath164 , tends to be large , at least at the beginning of the above exact algorithm , and the number of tests actually performed wo nt decrease much compared to the total number of possible tests .",
    "one can , however , identify much more efficiently the subgraphs whose sample mean shift in the first @xmath78 components of the graph - fourier space has euclidean norm @xmath165}(g)\\| = \\|u_{[k]}^\\top(\\bar{x}_1(g ) - \\bar{x}_2(g))\\|$ ] above a certain threshold .",
    "indeed , it is straightforward to see that @xmath166}^\\top(\\bar{x}_1(g ) - \\bar{x}_2(g))\\|^2 & \\leq \\|u^\\top(\\bar{x}_1(g ) - \\bar{x}_2(g))\\|^2\\\\   & = \\|\\bar{x}_1(g ) - \\bar{x}_2(g)\\|^2 \\\\ & \\leq \\|\\bar{x}_1(g')-\\bar{x}_2(g')\\|^2 \\\\ + & \\max_{v_1,\\ldots , v_{q - s}\\in\\nu(g',q - s)}\\|\\bar{x}_1(v_1,\\ldots , v_{q - s})-\\bar{x}_2(v_1,\\ldots , v_{q - s})\\|^2.\\end{aligned}\\ ] ] this inequality can then be used in the procedure of section  [ sec : exact ] , to identify all subgraphs for which the euclidean norm of the sample mean shift exceeds a given threshold : @xmath165}(g)\\|^2 > \\theta$ ] .",
    "for any @xmath96 , if this threshold @xmath167 is low enough , all the subgraphs with @xmath168 are included in this set . performing the actual @xmath1-test on these pre - selected subgraphs yields exactly the set of subgraphs that would have been identified using the exact procedure of section  [ sec : exact ] .",
    "more precisely , we have the following result :    [ lem : nc ] for any threshold @xmath169 , @xmath170 , and any subgraph @xmath137 of size @xmath132 such that @xmath165}(g)\\|^2 < \\theta$ ] , @xmath171}(g ) ) < \\frac{nn_1n_2\\theta}{(n_1+n_2 ) t^2_{\\alpha , k}},\\ ] ] where @xmath133 is the level-@xmath96 critical value for @xmath79 ( _ e.g. _ , @xmath134-quantile of @xmath135 ) , @xmath172 and @xmath173}(g))$ ] denotes the smallest eigenvalue of @xmath174}(g ) =    u_{[k]}\\hat{\\sigma}(g)u_{[k]}^\\top$ ] .    as @xmath175}(g))^{-1}\\lambda_{min}(\\hat{\\tilde{\\sigma}}_{[k]}(g ) )    \\succeq 0 $ ] , it follows that , for any @xmath29 , @xmath176}(g))^{-1}x \\leq    \\frac{\\|x\\|^2}{\\lambda_{min}(\\hat{\\tilde{\\sigma}}_{[k]}(g))}.\\ ] ]    lemma  [ lem : nc ] states that for any subgraph which would be detected by hotelling s",
    "@xmath1-statistic @xmath144 but not by the euclidean criterion @xmath165}(g)\\|^2 $ ] , the sample covariance matrix in the restricted graph - fourier space has an eigenvalue below a certain threshold .",
    "this implies that such false negative subgraphs ( from the euclidean approximation to the exact algorithm ) always have a small mean shift in the graph - fourier space , but in a direction of small variance . in context of gene expression",
    ", this is related to the well - known issue of the detection of de genes by virtue of their small variances .",
    "even though the differences in expression appear to be highly significant for these genes , they correspond to small effects that are not interesting from a practical point of view ( _ i.e. _ , biologically insignificant ) .",
    "methods for addressing this problem are proposed in  @xcite .",
    "note that @xmath177}(g)))$ ] ; thus , the remark on variances holds for both the graph - fourier and original spaces .",
    "however , if @xmath132 is large , we expect @xmath178 to be very small , while filtering somehow controls the conditioning of the covariance matrix .      testing for homogeneity over the potentially large number of subgraphs investigated as part of the above algorithms immediately raises the issue of multiple testing .",
    "however , the present multiplicity problem is unusual , in the sense that one does not know in advance the total number of tests and which tests will be performed specifically .",
    "standard multiple testing procedures , such as those in @xcite , are therefore not immediately applicable .    in an attempt to address the multiplicity issue",
    ", we apply a permutation procedure to control the number of false positive subgraphs under the complete null hypothesis of identical distributions in the two populations .",
    "specifically , one permutes the class / population labels ( 1 or 2 ) of the @xmath179 observations and applies the non - homogeneous subgraph discovery algorithm to the permuted data to yield a certain number of false positive subgraphs . repeating this procedure a sufficiently large number of times produces an estimate of the distribution of the number of type i errors under the complete null hypothesis of identical distributions .",
    "we evaluate the empirical behavior of the procedures proposed in sections  [ sec : test ] and [ sec : discovery ] , first on synthetic data , then on breast cancer microarray data analyzed in context of kegg pathways .",
    "the performance of the graph - structured test is assessed in cases where the distribution shift @xmath101 satisfies the smoothness assumptions described in section  [ sec : test ] .",
    "we first generate a connected random graph with @xmath180 nodes .",
    "next , we generate @xmath181 datasets , each comprising @xmath182 gaussian random vectors in @xmath183 , with null mean shift @xmath10 for @xmath184 datasets and mean shift @xmath185 for the remaining @xmath184 . for the latter datasets ,",
    "the non - zero shift is built in the first @xmath186 fourier coefficients ( the shift being zero for the remaining @xmath187 coefficients ) and an inverse fourier transformation is applied to random vectors generated in the graph - fourier space .",
    "we consider two covariance settings : in the first one , the covariance matrix in the graph - fourier space is diagonal with diagonal elements at @xmath188 . in the second one",
    ", correlation is introduced between the shifted coefficients only . specifically , for @xmath189 , @xmath190 if @xmath191 , @xmath192 otherwise .",
    "figure  [ fig : rocs ] displays receiver operator characteristic ( roc ) curves for mean shift detection by the standard hotelling @xmath1-test , @xmath1 in the first @xmath193 fourier coefficients , @xmath1 in the first @xmath193 principal components ( pc ) , the adaptive neyman test of  @xcite , and a modified version of this test where the correct value of @xmath193 is specified .",
    "note that we do not consider sparse learning approaches  @xcite , but it would be straightforward to design a realistic setting where such approaches are outperformed by testing , _",
    "e.g. _ , by adding correlation between some of the functions under @xmath194 .",
    "the first important comparison is between the classical hotelling @xmath1-test versus the @xmath1-test in the graph - fourier space . as expected from lemma  [ lem : das ] , testing in the restricted space where the shift lies performs much better than testing in the full space which includes irrelevant coefficients .",
    "the difference can be made arbitrarily large by increasing the dimension @xmath17 and keeping the shift unchanged .",
    "the graph - structured test retains a large advantage even for moderately smooth shifts , _",
    "e.g. _ , when @xmath186 and @xmath195 .",
    "of course , this corresponds to the optimistic case where the number of shifted coefficients @xmath193 is known .",
    "figure  [ fig : miss ] shows the power of the test in the graph - fourier space for various choices of @xmath78 . even when missing some coefficients ( @xmath196 ) or adding a few non - relevant ones ( @xmath197 ) , the power of the graph - structured test is higher than that of the @xmath1-test in the full space . the principal component approach is shown because it was proposed for the application which motivated our work  @xcite and as it illustrates that the performance improvement originates not only from dimensionality reduction , but also from the fact that this reduction is in a direction that does not decrease the shift .",
    "we emphasize that power entirely depends on the nature of the shift and that a pc - based test would outperform our fourier - based test when the shift lies in the first principal components rather than fourier coefficients .",
    "the statistics of  @xcite and @xcite are also largely outperformed by our graph - structured statistic ( roc curves not shown in figure  [ fig : rocs ] for the sake of readability ) , which illustrates that working in the graph - fourier space solves the problem of high - dimensionality for which these statistics were designed . here again , for a non - smooth shift , the comparison would be less favorable . finally , we consider the adaptive neyman test of @xcite , which takes advantage of smoothness assumptions for time - series .",
    "this test differs from our graph - structured test , as fourier coefficients for stationary time - series are known to be asymptotically independent and gaussian . for graphs",
    ", the asymptotics would be in the number of nodes , which is typically small , and necessary conditions such as stationarity are more difficult to define and unlikely to hold for data like gene expression measurements . in the uncorrelated",
    "setting , the modified version of the @xcite statistic based the true number of non - zero coefficients performs approximately as well as the graph - structured @xmath1 .",
    "however , for correlated data , it loses power and both versions can have arbitrarily degraded performance .",
    "this , together with the need to use the bootstrap to calibrate this test , illustrates that direct transposition of the @xcite test to the graph context is not optimal .",
    "-test in the graph - fourier space with an actual mean shift evenly distributed among the first @xmath198 coefficients . ]    to evaluate the performance of the subgraph discovery algorithms proposed in section  [ sec : discovery ] , we generated a graph of @xmath199 nodes formed by tightly - connected hubs of sizes sampled from a poisson distribution with parameter 10 and only weak connections between these hubs ( figure  [ fig : randg ] ) .",
    "such a graph structure mimics the typical topology of gene regulation networks .",
    "we randomly selected one subgraph of @xmath200 nodes to be non - homogeneous , with smooth shift in the first @xmath186 fourier coefficients .",
    "the mean shift was set to zero on the rest of the graph .",
    "we set the norm of the mean shift to @xmath55 and the covariance matrix to identity , so that detecting the shifted subgraph is impossible by just looking at the mean shift on the graph .",
    "we evaluated run - time for full enumeration , the exact branch - and - bound algorithm based on lemma  [ lem : neighbound ] ( section [ sec : exact ] ) , and the approximate algorithm based on the euclidean norm ( section  [ sec : euclidean ] ) .",
    "we also examined run - time on data with permuted class labels , as the subgraph discovery procedure is to be run on such data to evaluate the number of false positives and adjust for multiple testing .",
    "averaging over @xmath201 runs , the full enumeration procedure took @xmath202 seconds per run and the exact branch - and - bound @xmath203 seconds on the non - permuted data and @xmath204 seconds on permuted data . over @xmath199 runs ,",
    "the approximation at @xmath205 ( @xmath206 ) took @xmath207 seconds ( @xmath208 on permuted data ) and the approximation at @xmath209 ( @xmath210 ) took @xmath211 seconds ( @xmath212 on permuted data ) .",
    "the latter approximation missed the non - homogeneous subgraph in @xmath213 of the runs .    while neither the exact nor the approximate bounds are efficient enough to allow systematic testing on huge graphs for which the exact approach would be impossible , they allow a significant gain in speed , especially for permuted data , and will thus prove to be very useful for multiple testing adjustment .",
    "we also validated our methods using the microarray dataset of  @xcite , which comprises expression measures for @xmath214 genes in @xmath215 patients treated with tamoxifen . using distant metastasis free survival as a primary endpoint , @xmath216",
    "patients are labeled as resistant to tamoxifen and @xmath217 are labeled as sensitive to tamoxifen .",
    "our goal was to detect structured groups of genes which are differentially expressed between resistant and sensitive patients .",
    "we first tested individually @xmath218 connected components from @xmath219 kegg pathways corresponding to known gene regulation networks , using the classical hotelling @xmath1-test and the @xmath1-test in the graph - fourier space retaining only the first @xmath220 fourier coefficients ( @xmath221 ) .",
    "for each of the @xmath218 graphs , ( unadjusted ) @xmath17-values were computed under the nominal @xmath70-distributions @xmath222 and @xmath223 , respectively .",
    "figure  [ fig : path ] shows the pathway for which the ratio of graph - fourier to full space @xmath17-values is the lowest ( _ i.e. _ , most significant for graph - structured test relative to classical test ) and the pathway for which it is the highest .",
    "as expected , the former corresponds to a shift which appears to be coherent with the network ( even on edges corresponding to inhibition ) , while the latter is a small network with non - smooth shift . more generally , the classical approach tends to select very small networks .",
    "the coherent pathway selected by our graph - structured test corresponds to _ leukocyte transendothelial migration_. to the best of our knowledge , this pathway is not specifically known to be involved in tamoxifen resistance . however , its role in resistance is plausible , as leukocyte infiltration was recently found to be involved in breast tumor invasion  @xcite ; more generally , the immune system and inflammatory response are closely - related to the evolution of cancer .    -values .",
    "bottom : regulation network ( alzheimer s disease ) with the highest ratio of graph - fourier to full space @xmath17-values .",
    "nodes are colored according to the value of the difference in means , with green corresponding to high positive values , red to high negative values , and black to @xmath62 .",
    "red arrows denote activations , blue arrows inhibition.,title=\"fig : \" ] -values .",
    "bottom : regulation network ( alzheimer s disease ) with the highest ratio of graph - fourier to full space @xmath17-values .",
    "nodes are colored according to the value of the difference in means , with green corresponding to high positive values , red to high negative values , and black to @xmath62 .",
    "red arrows denote activations , blue arrows inhibition.,title=\"fig : \" ]    we then ran our branch - and - bound non - homogeneous subgraph discovery procedure on the cell cycle pathway , which , after restriction to edges of known sign ( inhibition or activation ) , has @xmath224 nodes and @xmath225 edges .",
    "specifically , we sought to detect differentially expressed subgraphs of size @xmath226 , after pre - selecting those for which the squared euclidean norm of the empirical shift exceeded @xmath227 ; for a test in the first @xmath228 fourier components at level @xmath229 , this corresponded to @xmath230 and to an expected removal of @xmath231 of the subgraphs under the approximation that the squared euclidean norm of the subgraphs follows a @xmath232-distribution .    for @xmath229 ,",
    "none of the @xmath233 runs on permuted data gave any positive subgraph and @xmath234 overlapping subgraphs ( figure  [ fig : firstgraphsign ] ) were detected on the original data , corresponding to a connected subnetwork of @xmath235 genes .",
    "some of these genes have large individual differential expression , namely tp53 whose mutation has been long - known to be involved in tamoxifen resistance @xcite .",
    "e2f1 , whose expression level was recently shown to be involved in tamoxifen resistance @xcite , is also part of the identified network , as well as ccnd1 @xcite .",
    "some other genes in the network have quite low @xmath0-statistics and would not have been detected individually .",
    "this is the case of ccne1 and cdk2 , which were also described in @xcite as part of the same mechanism as e2f1 .",
    "similarly , cdkn1a was recently found to be involved in anti - strogene treatment resistance @xcite and in ovarian cancer which is also a hormone - dependent cancer @xcite .",
    "the networks also contains rb1 , a tumor suppressor whose expression or loss is known to be correlated to tamoxifen resistance @xcite .",
    "rb1 is inhibited by cdk4 , whose inhibition has been described in @xcite as acting synergistically with tamoxifen or trastuzumab . more generally , a large part of the network displayed on figure  2a of @xcite is included in our network , along with other known actors of tamoxifen resistance .",
    "our system - based approach to pathway discovery therefore directly identifies a set of interacting important genes and may therefore prove to be more efficient than iterative individual identification of single actors .    .",
    "nodes are colored according to the value of the difference in means , with green corresponding to high positive values , red to high negative values , and black to @xmath62 .",
    "red arrows denote activations , blue arrows inhibition . ]",
    "we developed a graph - structured two - sample test of means , for problems in which the distribution shift is assumed to be smooth on a given graph .",
    "we proved quantitative results on power gains for such smooth - shift alternatives and devised branch - and - bound algorithms to systematically apply our test to all the subgraphs of a large graph .",
    "the first algorithm is exact and reduces the number of explicitly tested subgraphs .",
    "the second is approximate , with no false positives and a quantitative result on the type of false negatives ( with respect to the exact algorithm ) .",
    "the non - homogeneous subgraph discovery method involves performing a larger number of tests , with highly - dependent test statistics .",
    "however , as the actual number of tested hypotheses is unknown , standard multiple testing procedures are not directly applicable .",
    "instead , we use a permutation procedure to estimate the distribution of the number of false positive subgraphs . such resampling procedures ( bootstrap or permutation )",
    "are feasible due to the manageable run - time of the pruning algorithms of section [ sec : discovery ] .",
    "results on synthetic data illustrate the good power properties of our graph - structured test under smooth - shift alternatives , as well as the good performance of our branch - and - bound - like algorithms for subgraph discovery .",
    "very promising results are also obtained on the drug resistance microarray dataset of @xcite .",
    "future work should investigate the use of other bases , such as graph - wavelets  @xcite , which would allow the detection of shifts with spatially - located non - smoothness , for example , to take into account errors in existing networks .",
    "more systematic procedures for cutoff selection should also be considered , _",
    "e.g. _ , two - step method proposed in  @xcite or adaptive approaches as in  @xcite .",
    "the pruning algorithm would naturally benefit from sharper bounds .",
    "such bounds could be obtained by controlling the condition number of all covariance matrices , using , for example , regularized statistics which still have known non - asymptotic distributions , such as those of  @xcite . concerning multiple testing",
    ", procedures should be devised to exploit the dependence structure between the tested subgraphs and to deal with the unknown number of tests .",
    "the proposed approach could also be enriched to take into account different types of data , _",
    "e.g. _ , copy number for the detection of de gene pathways .",
    "more subtle notions of smoothness , _",
    "e.g. _ , `` and '' and `` or '' logical relations  @xcite , could also be included .",
    "an interesting alternative application would be to explore the list of pathways which are known to be differentially expressed ( or detected by the classical @xmath1-test ) , but which are not detected by the graph - fourier approach , to infer possible mis - annotation in the network .",
    "other applications of two - sample tests with smooth - shift on a graph include fmri and eqtl association studies .    finally , it would be of interest to compare our testing approach with structured sparse learning , for the purpose of identifying expression signatures that are predictive of drug resistance .",
    "methods should be compared in terms of prediction accuracy and stability of the selected genes across different datasets , a central and difficult problem in the design of such signatures  @xcite .",
    "the comparison should also take into account the merits of the sparsity - inducing norm over the hypothesis testing - based selection , as well as the influence of the smoothness assumption .",
    "the latter could indeed also be integrated in a sparsity - inducing penalty by applying , _",
    "e.g. _ , @xcite to the reduced graph - fourier representation of the pathways , yielding a special case of multiple kernel learning  @xcite .",
    "the authors thank zad harchaoui , nourredine el karoui , and terry speed for very helpful discussions and suggestions , and the uc berkeley center for computational biology genentech innovation fellowship and the cancer genome atlas project for funding ."
  ],
  "abstract_text": [
    "<S> we consider multivariate two - sample tests of means , where the location shift between the two populations is expected to be related to a known graph structure . </S>",
    "<S> an important application of such tests is the detection of differentially expressed genes between two patient populations , as shifts in expression levels are expected to be coherent with the structure of graphs reflecting gene properties such as biological process , molecular function , regulation , or metabolism . for a fixed graph of interest , we demonstrate that accounting for graph structure can yield more powerful tests under the assumption of smooth distribution shift on the graph . </S>",
    "<S> we also investigate the identification of non - homogeneous subgraphs of a given large graph , which poses both computational and multiple testing problems . </S>",
    "<S> the relevance and benefits of the proposed approach are illustrated on synthetic data and on breast cancer gene expression data analyzed in context of kegg pathways . </S>"
  ]
}