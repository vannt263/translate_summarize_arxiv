{
  "article_text": [
    "a hamilton decomposition of a graph or digraph @xmath1 is a set of edge - disjoint hamilton cycles which together cover all the edges of  @xmath1 .",
    "the topic has a long history but some of the main questions remain open . in 1892 , walecki showed that the edge set of the complete graph @xmath4 on @xmath2 vertices has a hamilton decomposition if @xmath2 is odd ( see e.g.  @xcite for the construction ) .",
    "if @xmath2 is even , then @xmath2 is not a factor of @xmath5 , so clearly @xmath4 does not have such a decomposition .",
    "walecki s result implies that a complete digraph @xmath1 on @xmath2 vertices has a hamilton decomposition if @xmath2 is odd .",
    "more generally , tillson  @xcite proved that a complete digraph @xmath1 on @xmath2 vertices has a hamilton decomposition if and only if @xmath6 .",
    "a tournament is an orientation of a complete graph .",
    "we say that a tournament is _ regular _ if every vertex has equal in- and outdegree .",
    "thus regular tournaments contain an odd number @xmath2 of vertices and each vertex has in- and outdegree @xmath7 .",
    "the following beautiful conjecture of kelly  ( see e.g.  @xcite ) , which has attracted much attention , states that every regular tournament has a hamilton decomposition :    [ kelly ] every regular tournament on @xmath2 vertices can be decomposed into @xmath7 edge - disjoint hamilton cycles .",
    "in this paper we prove an approximate version of kelly s conjecture .",
    "[ main1 ] for every @xmath0 there exists an integer @xmath8 so that every regular tournament on @xmath9 vertices contains at least @xmath3 edge - disjoint hamilton cycles .",
    "in fact , we prove the following stronger result , where we consider orientations of almost complete graphs which are almost regular .",
    "an _ oriented graph _ is obtained from an undirected graph by orienting its edges .",
    "so it has at most one edge between every pair of vertices , whereas a digraph may have an edge in each direction .",
    "[ main ] for every @xmath10 there exist @xmath11 and @xmath12 such that the following holds .",
    "suppose that @xmath1 is an oriented graph on @xmath13 vertices such that every vertex in @xmath1 has in- and outdegree at least @xmath14 .",
    "then @xmath1 contains at least @xmath15 edge - disjoint hamilton cycles .",
    "the _ minimum semidegree _",
    "@xmath16 of an oriented graph @xmath1 is the minimum of its minimum outdegree and its minimum indegree .",
    "so the minimum semidegree of a regular tournament on @xmath2 vertices is @xmath7 .",
    "most of the previous partial results towards kelly s conjecture have been obtained by giving bounds on the minimum semidegree of an oriented graph which guarantees a hamilton cycle .",
    "this approach was first used by jackson  @xcite , who showed that every regular tournament on at least 5 vertices contains a hamilton cycle and a hamilton path which are edge - disjoint .",
    "zhang  @xcite then showed that every such tournament contains two edge - disjoint hamilton cycles .",
    "improved bounds on the value of @xmath16 which forces a hamilton cycle were then found by thomassen  @xcite , hggkvist  @xcite , hggkvist and thomason  @xcite as well as kelly , khn and osthus  @xcite .",
    "finally , keevash , khn and osthus  @xcite showed that every sufficiently large oriented graph  @xmath1 on @xmath2 vertices with @xmath17 contains a hamilton cycle .",
    "this bound on @xmath18 is best possible and confirmed a conjecture of hggkvist  @xcite .",
    "note that this result implies that every sufficiently large regular tournament on @xmath2 vertices contains at least @xmath19 edge - disjoint hamilton cycles .",
    "this was the best bound so far towards kelly s conjecture .",
    "kelly s conjecture has also been verified for @xmath20 by alspach ( see the survey  @xcite ) .",
    "a result of frieze and krivelevich  @xcite states that theorem  [ main ] holds for ` quasi - random ' tournaments .",
    "as indicated below , we will build on some of their ideas in the proof of theorem  [ main ] .",
    "it turns out that theorem  [ main ] can be generalized even further : any large almost regular oriented graph on @xmath2 vertices whose in- and outdegrees are all a little larger than @xmath21 can almost be decomposed into hamilton cycles .",
    "the corresponding modifications to the proof of theorem  [ main ] are described in section  [ 38 ] .",
    "we also discuss some further open questions in that section .",
    "jackson  @xcite also introduced the following bipartite version of kelly s conjecture ( both versions are also discussed e.g.  in the handbook article by bondy  @xcite ) .",
    "bipartite tournament _ is an orientation of a complete bipartite graph .",
    "[ kellybip ] every regular bipartite tournament has a hamilton decomposition .",
    "an undirected version of conjecture  [ kellybip ] was proved independently by auerbach and laskar  @xcite , as well as hetyei  @xcite .",
    "however , a bipartite version of theorem  [ main ] does not hold , because there are almost regular bipartite tournaments which do not even contain a single hamilton cycle .",
    "( consider for instance the following ` blow - up ' of a 4-cycle : the vertices are split into 4 parts @xmath22 whose sizes are almost but not exactly equal , and we have all edges from @xmath23 to @xmath24 , with indices modulo 4 . )    kelly s conjecture has been generalized in several directions .",
    "for instance , given an oriented graph @xmath1 , define its _ excess _ by @xmath25 where @xmath26 denotes the number of outneighbours of the vertex @xmath27 , and @xmath28 the number of its inneighbours .",
    "pullman ( see e.g.  conjecture  8.25 in  @xcite ) conjectured that if @xmath1 is an oriented graph such that @xmath29 for all vertices @xmath27 of @xmath1 , where @xmath30 is odd , then @xmath1 has a decomposition into @xmath31 directed paths . to see that this would imply kelly s conjecture ,",
    "let @xmath1 be the oriented graph obtained from a regular tournament by deleting a vertex .",
    "another generalization was made by bang - jensen and yeo  @xcite , who conjectured that every @xmath32-edge - connected tournament has a decomposition into @xmath32 spanning strong digraphs .    in  @xcite ,",
    "thomassen also formulated the following weakening of kelly s conjecture .",
    "[ thomconj ] if @xmath1 is a regular tournament on @xmath33 vertices and @xmath34 is any set of at most @xmath35 edges of @xmath1 , then @xmath36 has a hamilton cycle .    in  @xcite , we proved a result on the existence of hamilton cycles in ` robust expander digraphs ' which implies conjecture  [ thomconj ] for large tournaments ( see  @xcite for details ) .",
    "@xcite also contains the related conjecture that for any @xmath37 , there is an @xmath38 so that every strongly @xmath38-connected tournament contains @xmath39 edge - disjoint hamilton cycles .",
    "further support for kelly s conjecture was also provided by thomassen  @xcite , who showed that the edges of every regular tournament on @xmath2 vertices can be covered by @xmath40 hamilton cycles . in  @xcite",
    "the first two authors observed that one can use theorem  [ main ] to reduce this to @xmath41 hamilton cycles .",
    "a discussion of further recent results about hamilton cycles in directed graphs can be found in the survey  @xcite .",
    "it seems likely that the techniques developed in this paper will also be useful in solving further problems .",
    "in fact , christofides , khn and osthus  @xcite used similar ideas to prove approximate versions of the following two long - standing conjectures of nash - williams  @xcite :    let @xmath1 be a @xmath42-regular graph on at most @xmath43 vertices , where @xmath44 .",
    "then @xmath1 has a hamilton decomposition .",
    "[ nwconj2 ] let @xmath1 be a graph on @xmath2 vertices with minimum degree at least @xmath45",
    ". then @xmath1 contains @xmath46 edge - disjoint hamilton cycles .",
    "( actually , nash - williams initially formulated conjecture  [ nwconj2 ] with the term @xmath19 replaced by @xmath47 , but babai found a counterexample to this . )",
    "another related problem was raised by erds ( see  @xcite ) , who asked whether almost all tournaments @xmath1 have at least @xmath18 edge - disjoint hamilton cycles .",
    "note that an affirmative answer would not directly imply that kelly s conjecture holds for almost all regular tournaments , which would of course be an interesting result in itself .",
    "there are also a number of corresponding questions for random undirected graphs ( see e.g.  @xcite ) .    after giving an outline of the argument in the next section",
    ", we will state a directed version of the regularity lemma and some related results in section  [ 3 ] .",
    "section  [ 4 ] contains statements and proofs of several auxiliary results , mostly on ( almost ) @xmath48-factors in ( almost ) regular oriented graphs .",
    "the proof of theorem  [ main ] is given in section  [ 5 ] . a generalization of theorem  [ main ] to oriented graphs with smaller degrees is discussed in section  [ 38 ] .",
    "suppose we are given a regular tournament @xmath1 on @xmath2 vertices and our aim is to ` almost ' decompose it into hamilton cycles .",
    "one possible approach might be the following : first remove a spanning regular oriented subgraph @xmath49 whose degree @xmath50 satisfies @xmath51 .",
    "let @xmath52 be the remaining oriented subgraph of @xmath1 .",
    "now consider a decomposition of @xmath52 into @xmath48-factors @xmath53 ( which clearly exists ) .",
    "next , try to transform each @xmath54 into a hamilton cycle by removing some of its edges and adding some suitable edges of @xmath49 .",
    "this is of course impossible if many of the @xmath54 consist of many cycles .",
    "however , an auxiliary result of frieze and krivelevich in  @xcite implies that we can ` almost ' decompose @xmath52 so that each @xmath48-factor @xmath54 consists of only a few cycles .",
    "if @xmath49 were a ` quasi - random ' oriented graph , then ( as in  @xcite ) one could use it to successively ` merge ' the cycles of each @xmath54 into hamilton cycles using a ` rotation - extension ' argument : delete an edge of a cycle @xmath55 of @xmath54 to obtain a path @xmath56 from @xmath57 to @xmath58 , say . if there is an edge of @xmath49 from @xmath58 to another cycle @xmath59 of @xmath54 , then extend @xmath56 to include the vertices of @xmath59 ( and similarly for @xmath57 ) .",
    "continue until there is no such edge .",
    "then ( in @xmath49 ) the current endvertices of the path @xmath56 have many neighbours on @xmath56",
    ". one can use this together with the quasi - randomness of @xmath49 to transform @xmath56 into a cycle with the same vertices as @xmath56 . now repeat this , until we have merged all the cycles into a single ( hamilton ) cycle .",
    "of course , one has to be careful to maintain the quasi - randomness of @xmath49 in carrying out this ` rotation - extension ' process for the successive @xmath54 ( the fact that @xmath54 contains only few cycles is important for this ) .",
    "the main problem is that @xmath1 need not contain such a spanning ` quasi - random ' subgraph @xmath49 .",
    "so instead , in section  [ applydrl ] we use szemerdi s regularity lemma to decompose @xmath1 into quasi - random subgraphs .",
    "we then choose both our @xmath48-factors @xmath54 and the graph @xmath49 according to the structure of this decomposition .",
    "more precisely , we apply a directed version of szemerdi s regularity lemma to obtain a partition of the vertices of @xmath1 into a bounded number of clusters @xmath60 so that almost all of the bipartite subgraphs spanned by ordered pairs of clusters are quasi - random ( see section  [ 3.3 ] for the precise statement ) .",
    "this then yields a reduced digraph @xmath61 , whose vertices correspond to the clusters , with an edge from one cluster @xmath62 to another cluster @xmath63 if the edges from @xmath62 to @xmath63 in @xmath1 form a quasi - random graph .",
    "( note that @xmath61 need not be oriented . )",
    "we view @xmath61 as a weighted digraph whose edge weights are the densities of the corresponding ordered pair of clusters .",
    "we then obtain an unweighted multidigraph @xmath64 from @xmath61 as follows : given an edge @xmath65 of @xmath61 joining a cluster @xmath62 to @xmath63 , replace it with @xmath66 copies of @xmath65 , where @xmath67 is approximately proportional to the density of the ordered pair @xmath68 .",
    "it is not hard to show that @xmath64 is approximately regular ( see lemma  [ multimin ] ) .",
    "if @xmath64 were regular , then it would have a decomposition into @xmath48-factors , but this assumption may not be true .",
    "however , we can show that @xmath64 can ` almost ' be decomposed into ` almost ' @xmath48-factors .",
    "in other words , there exist edge - disjoint collections @xmath69 of vertex - disjoint cycles in @xmath64 such that each @xmath70 covers almost all of the clusters in @xmath64 ( see lemma  [ multifactor1 ] ) .",
    "now we choose edge - disjoint oriented spanning subgraphs @xmath71 of @xmath1 so that each @xmath72 corresponds to @xmath70 .",
    "for this , consider an edge @xmath65 of @xmath61 from @xmath62 to @xmath63 and suppose for example that @xmath73 , @xmath74 and @xmath75 are the only @xmath70 containing copies of @xmath65 in @xmath64 . then for each edge of @xmath1 from @xmath62 to @xmath63 in turn , we assign it to one of @xmath76 , @xmath77 and @xmath78 with equal probability .",
    "then with high probability , each @xmath72 consists of bipartite quasi - random oriented graphs which together form a disjoint union of ` blown - up ' cycles .",
    "moreover , we can arrange that all the vertices have degree close to @xmath79 ( here @xmath80 is the cluster size and @xmath81 a small parameter which does not depend on @xmath82 ) .",
    "we now remove a small proportion of the edges from @xmath1 ( and thus from each @xmath72 ) to form oriented subgraphs @xmath83 of @xmath1 , where @xmath84 .",
    "ideally , we would like to show that each @xmath72 can almost be decomposed into hamilton cycles .",
    "since the @xmath72 are edge - disjoint , this would yield the required result .",
    "one obvious obstacle is that the @xmath72 need not be spanning subgraphs of @xmath1 ( because of the exceptional set @xmath85 returned by the regularity lemma and because the @xmath70 are not spanning . )",
    "so in section  [ sec : incorp ] we add suitable edges between @xmath72 and the leftover vertices to form edge - disjoint oriented spanning subgraphs @xmath86 of @xmath1 where every vertex has degree close to @xmath79 .",
    "( the edges of @xmath87 and @xmath88 are used in this step . ) but the distribution of the edges added in this step may be somewhat ` unbalanced ' , with some vertices of @xmath72 sending out or receiving too many of them .",
    "in fact , as discussed at the beginning of section  [ skel ] , we can not even guarantee that @xmath86 has a single @xmath48-factor .",
    "we overcome this new difficulty by adding carefully chosen further edges ( from @xmath89 this time ) to each @xmath86 which compensate the above imbalances .",
    "once these edges have been added , in section  [ nicefactor ] we can use the max - flow min - cut theorem to almost decompose each @xmath86 into @xmath48-factors @xmath90 .",
    "( this is one of the points where we use the fact that the @xmath72 consist of quasi - random graphs which form a union of blown - up cycles . )",
    "moreover , ( i ) the number of cycles in each of these @xmath48-factors is not too large and ( ii ) most of the cycles inherit the structure of @xmath70 .",
    "more precisely , ( ii ) means that most vertices @xmath91 of @xmath72 have the following property : let @xmath62 be the cluster containing @xmath91 and let @xmath92 be the successor of @xmath62 in @xmath70 .",
    "then the successor @xmath93 of @xmath91 in @xmath90 lies in @xmath92 .    in section  [ 4.6 ] we can use ( i ) and ( ii ) to merge the cycles of each @xmath90 into a @xmath48-factor @xmath94 consisting only of a bounded number of cycles  for each cycle @xmath95 of @xmath70 , all the vertices of @xmath86 which lie in clusters of @xmath95 will lie in the same cycle of @xmath96 .",
    "we will apply a rotation - extension argument for this , where the additional edges ( i.e.  those not in @xmath90 ) come from @xmath97 .",
    "finally , in section  [ merging ] we will use the fact that @xmath64 contains many short paths to merge each @xmath94 into a single hamilton cycle .",
    "the additional edges will come from @xmath98 and @xmath99 this time .",
    "throughout this paper we omit floors and ceilings whenever this does not affect the argument . given a graph @xmath1",
    ", we denote the degree of a vertex @xmath100 by @xmath101 and the maximum degree of @xmath1 by @xmath102 . given two vertices @xmath103 and @xmath104 of a digraph @xmath1 , we write @xmath105 for the edge directed from @xmath103 to @xmath104 .",
    "we denote by @xmath106 the set of all outneighbours of  @xmath103 .",
    "so @xmath106 consists of all those @xmath107 for which @xmath108 .",
    "we have an analogous definition for @xmath109 given a multidigraph @xmath1 , we denote by @xmath110 the _ multiset _ of vertices where a vertex @xmath107 appears @xmath32 times in @xmath111 if @xmath1 contains precisely @xmath32 edges from  @xmath103 to  @xmath104 .",
    "again , we have an analogous definition for @xmath112 . we will write @xmath113 for example , if this is unambiguous . given a vertex @xmath103 of a digraph or multidigraph @xmath1 , we write @xmath114 for the outdegree of @xmath103 , @xmath115 for its indegree and @xmath116 for its degree .",
    "the maximum of the maximum outdegree @xmath117 and the maximum indegree @xmath118 is denoted by @xmath119 .",
    "the _ minimum semidegree _",
    "@xmath16 of @xmath1 is the minimum of its minimum outdegree @xmath120 and its minimum indegree @xmath121 . throughout the paper we will use @xmath122 , @xmath123 and @xmath124 as ` shorthand ' notation . for example , @xmath125 is read as @xmath126 and @xmath127 .",
    "a _ 1-factor _ of a multidigraph  @xmath1 is a collection of vertex - disjoint cycles in  @xmath1 which together cover all the vertices of  @xmath1 .",
    "given @xmath128 , we write @xmath129 to denote the number of edges in @xmath1 with startpoint in @xmath34 and endpoint in @xmath130 . similarly , if @xmath1 is an undirected graph , we write @xmath129 for the number of all edges between @xmath34 and  @xmath130 . given a multiset @xmath131 and a set @xmath132 we define @xmath133 to be the multiset where @xmath103 appears as an element precisely @xmath32 times in @xmath133 if @xmath134 , @xmath135 and @xmath103 appears precisely @xmath32 times in @xmath131 .",
    "we write @xmath136 for @xmath137 $ ] .",
    "we will often use the following chernoff bound for binomial and hypergeometric distributions ( see e.g.  ) . recall that the binomial random variable with parameters @xmath138 is the sum of @xmath2 independent bernoulli variables , each taking value @xmath48 with probability @xmath139 or @xmath140 with probability @xmath141 .",
    "the hypergeometric random variable @xmath131 with parameters @xmath142 is defined as follows .",
    "we let @xmath143 be a set of size @xmath2 , fix @xmath144 of size @xmath145 , pick a uniformly random @xmath146 of size @xmath147 , then define @xmath148 .",
    "note that @xmath149 .",
    "[ chernoff ] suppose @xmath131 has binomial or hypergeometric distribution and @xmath150",
    ". then @xmath151 .      in the proof of theorem  [ main ]",
    "we will use the directed version of szemerdi s regularity lemma .",
    "before we can state it we need some more notation and definitions .",
    "density _ of an undirected bipartite graph @xmath1 with vertex classes  @xmath34 and  @xmath130 is defined to be @xmath152 we will write @xmath153 if this is unambiguous .",
    "given any @xmath154 , we say that @xmath1 is _ @xmath155$]-regular _ if for all sets @xmath156 and @xmath157 with @xmath158 and @xmath159 we have @xmath160 . in the case when @xmath161 we say that @xmath1 is _",
    "@xmath162-regular_.    given @xmath163 we say that @xmath1 is _ @xmath164-super - regular _",
    "if all sets @xmath156 and @xmath157 with @xmath158 and @xmath159 satisfy @xmath165 and , furthermore , if @xmath166 for all @xmath167 and @xmath168 for all @xmath169 .",
    "note that this is a slight variation of the standard definition .",
    "given disjoint vertex sets  @xmath34 and  @xmath130 in a digraph  @xmath1 , we write @xmath170 for the oriented bipartite subgraph of  @xmath1 whose vertex classes are  @xmath34 and  @xmath130 and whose edges are all the edges from  @xmath34 to  @xmath130 in  @xmath1 .",
    "we say @xmath170 is _ @xmath171$]-regular and has density  @xmath172 _ if this holds for the underlying undirected bipartite graph of @xmath170 .",
    "( note that the ordering of the pair @xmath170 is important here . ) in the case when @xmath173 we say that _",
    "@xmath170 is @xmath162-regular and has density @xmath172_. similarly , given @xmath163 we say @xmath170 is _ @xmath174-super - regular _ if this holds for the underlying undirected bipartite graph .    the diregularity lemma is a variant of the regularity lemma for digraphs due to alon and shapira  @xcite .",
    "its proof is similar to the undirected version .",
    "we will use the degree form of the diregularity lemma which can be derived from the standard version in the same manner as the undirected degree form ( see  @xcite for a sketch of the latter ) .",
    "[ dilemma ] for every @xmath175 and every integer  @xmath176 there are integers  @xmath177 and  @xmath8 such that if  @xmath1 is a digraph on @xmath178 vertices and @xmath179 $ ] is any real number , then there is a partition of the vertex set of  @xmath1 into @xmath180 and a spanning subdigraph  @xmath52 of  @xmath1 such that the following holds :    * @xmath181 , * @xmath182 , * @xmath183 , * @xmath184 for all vertices @xmath185 , * for all @xmath186 the digraph @xmath187 $ ] is empty , * for all @xmath188 with @xmath189 the pair @xmath190 is @xmath191-regular and has density either  @xmath140 or at least  @xmath30 .",
    "we call @xmath192 _ clusters _ , @xmath85 the _ exceptional set _ and the vertices in  @xmath85 _ exceptional vertices_. we refer to  @xmath52 as the _ pure digraph_. the last condition of the lemma says that all pairs of clusters are @xmath162-regular in both directions ( but possibly with different densities )",
    ". the _ reduced digraph  @xmath61 of  @xmath1 with parameters @xmath191 , @xmath30 and  @xmath176 _ is the digraph whose vertices are @xmath193 and in which @xmath194 is an edge precisely when @xmath190 is @xmath191-regular and has density at least  @xmath30 .",
    "the next result shows that we can partition the set of edges of an @xmath162-(super)-regular pair into edge - disjoint subgraphs such that each of them is still ( super)-regular .",
    "[ split ] let @xmath195 and suppose @xmath196 .",
    "then there exists an integer @xmath197 such that for all @xmath198 the following holds .",
    "* suppose that @xmath199 is an @xmath162-regular pair of density @xmath30 where @xmath200 .",
    "then there are @xmath201 edge - disjoint spanning subgraphs @xmath202 of @xmath1 such that each @xmath203 is @xmath204$]-regular of density @xmath205 . *",
    "if @xmath206 and @xmath199 is @xmath164-super - regular with @xmath200 . then there are two edge - disjoint spanning subgraphs @xmath207 and @xmath208 of @xmath1 such that each @xmath203 is @xmath209-super - regular .",
    "we first prove  ( i ) .",
    "suppose we have chosen @xmath210 sufficiently large .",
    "initially set @xmath211 for each @xmath212 .",
    "we consider each edge of @xmath1 in turn and add it to each @xmath213 with probability @xmath214 , independently of all other edges of  @xmath1 .",
    "so the probability that @xmath105 is added to none of the @xmath203 is @xmath215 .",
    "moreover , @xmath216 .    given @xmath156 and @xmath157 with @xmath217 we have that @xmath218 .",
    "thus @xmath219 for each @xmath82 .",
    "proposition  [ chernoff ] for the binomial distribution implies that with high probability @xmath220 for each @xmath221 and every @xmath156 and @xmath157 with @xmath217 .",
    "such  @xmath203 are as required in  ( i ) .",
    "the proof of  ( ii ) is similar . indeed , as in ( i ) one can show that with high probability any @xmath222 and @xmath157 with @xmath217 satisfy @xmath223 ( for @xmath224 ) .",
    "moreover , each vertex @xmath225 satisfies @xmath226 ( for @xmath224 ) and similarly for the vertices in  @xmath130 .",
    "so again proposition  [ chernoff ] for the binomial distribution implies that with high probability @xmath227 for all @xmath225 and @xmath228 for all @xmath229 .",
    "altogether this shows that with high probability both @xmath207 and @xmath208 are @xmath209-super - regular .",
    "suppose @xmath230 and let @xmath1 be a digraph .",
    "let @xmath61 and @xmath52 denote the reduced digraph and pure digraph respectively , obtained by applying lemma  [ dilemma ] to @xmath1 with parameters @xmath231 and @xmath176 .",
    "for each edge @xmath232 of  @xmath61 we write @xmath233 for the density of @xmath234 .",
    "( so @xmath235 . ) the _ reduced multidigraph _ @xmath64 of @xmath1 with parameters @xmath236 and @xmath176 is obtained from @xmath61 by setting @xmath237 and adding @xmath238 directed edges from @xmath60 to @xmath239 whenever @xmath240 .",
    "we will always consider the reduced multidigraph @xmath64 of a digraph @xmath1 whose order is sufficiently large in order to apply lemma  [ split ] to any pair @xmath234 of clusters with @xmath240 .",
    "let @xmath241 and @xmath242 be the spanning subgraphs of @xmath190 obtained from lemma  [ split ] .",
    "( so each @xmath243 is @xmath162-regular of density @xmath244 . )",
    "let @xmath245 denote the directed edges from @xmath60 to @xmath239 in @xmath64 .",
    "we associate each @xmath246 with the edges in @xmath243 .",
    "[ multimin ] let @xmath247 and let @xmath1 be a digraph of sufficiently large order @xmath2 with @xmath248 and @xmath249 .",
    "apply lemma  [ dilemma ] with parameters @xmath231 and @xmath176 to obtain a pure digraph @xmath52 and a reduced digraph @xmath61 of @xmath1 .",
    "let @xmath64 denote the reduced multidigraph of @xmath1 with parameters @xmath236 and @xmath176 .",
    "then @xmath250    note the corresponding upper bound would not hold if we considered @xmath61 instead of @xmath64 here .",
    "given any @xmath251 , let @xmath233 denote the density of @xmath190",
    ". then @xmath252 by lemma  [ dilemma ]",
    ". thus @xmath253 so indeed @xmath254 .",
    "similar arguments can be used to show that @xmath255 and @xmath256 .",
    "we will also need the well - known fact that for any cycle @xmath55 of the reduced multigraph @xmath64 we can delete a small number of vertices from the clusters in  @xmath55 in order to ensure that each edge of @xmath55 corresponds to a super - regular pair .",
    "we include a proof for completeness .",
    "[ superreg ] let @xmath257 be a cycle in the reduced multigraph  @xmath64 as in lemma  [ multimin ] .",
    "for each @xmath258 let @xmath259 denote the edge of @xmath55 which joins @xmath260 to  @xmath261 ( where @xmath262 )",
    ". then we can choose subclusters @xmath263 of size @xmath264 such that @xmath265 is @xmath266-super - regular ( for each @xmath258 ) .",
    "recall that for each @xmath267 the digraph @xmath268 corresponding to the edge @xmath259 of @xmath55 is @xmath162-regular and has density @xmath244 .",
    "so @xmath260 contains at most @xmath269 vertices whose outdegree in @xmath268 is either at most @xmath270 or at least @xmath271 .",
    "similarly , there are at most @xmath269 vertices in @xmath260 whose indegree in @xmath272 is either at most @xmath270 or at least @xmath271 .",
    "let @xmath273 be a set of size @xmath274 obtained from @xmath260 by deleting all these vertices ( and some additional vertices if necessary ) .",
    "it is easy to check that @xmath275 are subclusters as required .",
    "finally , we will use the following crude version of the fact that every @xmath155$]-regular pair contains a subgraph of given maximum degree @xmath276 whose average degree is close to @xmath276 .",
    "[ boundmax ] suppose that @xmath277 and that @xmath278 is an @xmath155$]-regular pair of density @xmath279 with @xmath2 vertices in each class .",
    "then @xmath278 contains a subgraph @xmath49 whose maximum degree is at most @xmath280 and whose average degree is at least @xmath281 .",
    "let @xmath282 be the set of vertices of degree at least @xmath283 and define @xmath284 similarly .",
    "then @xmath285 . let @xmath286 and @xmath287 .",
    "then @xmath288 is still @xmath289$]-regular of density at least @xmath290 . now consider a spanning subgraph @xmath49 of @xmath288 which is obtained from @xmath288 by including each edge with probability @xmath291 .",
    "so the expected degree of every vertex is at most @xmath292 and the expected number of edges of @xmath49 is at least @xmath293 .",
    "now apply the chernoff bound on the binomial distribution in proposition  [ chernoff ] to each of the vertex degrees and to the total number of edges in @xmath49 to see that with high probability @xmath49 has the desired properties .",
    "our main aim in this subsection is to show that the reduced multidigraph @xmath64 contains a collection of ` almost ' 1-factors which together cover almost all the edges of  @xmath64 ( see lemma  [ multifactor1 ] ) . to prove this",
    "we will need the following result which implies @xmath64 contains many edges between any two sufficiently large sets .",
    "the second part of the lemma will be used in section  [ sec : shifted ] .",
    "[ keevashmult ] let @xmath294 .",
    "suppose that @xmath1 is an oriented graph of order @xmath2 with @xmath295 .",
    "let @xmath61 and @xmath64 denote the reduced digraph and the reduced multidigraph of @xmath1 obtained by applying lemma  [ dilemma ] ( with parameters @xmath296 and @xmath297 respectively ) .",
    "let @xmath298 . then the following properties hold .",
    "* let @xmath299 be such that @xmath300 ) \\geq ( 1/2-c)|x|/\\beta$ ] .",
    "then for all ( not necessarily disjoint ) subsets @xmath34 and @xmath130 of @xmath131 of size at least @xmath301 there are at least @xmath302 directed edges from @xmath34 to @xmath130 in  @xmath64 .",
    "* let @xmath303 denote the spanning subdigraph of @xmath61 obtained by deleting all edges which correspond to pairs of density at most @xmath172 ( in the pure digraph @xmath52 ) .",
    "then @xmath304 and for all ( not necessarily disjoint ) subsets @xmath34 and @xmath130 of @xmath305 of size at least @xmath306 there are at least @xmath307 directed edges from @xmath34 to @xmath130 in  @xmath303 .",
    "we first prove  ( i ) .",
    "recall that for every edge @xmath232 of @xmath61 there are precisely @xmath238 edges from @xmath308 to @xmath239 in @xmath64 , where @xmath233 denotes the density of @xmath309 . but",
    "@xmath310 since @xmath1 is oriented and so @xmath64 contains at most @xmath311 edges between @xmath60 and @xmath239 ( here we count the edges in both directions ) .    by deleting vertices from @xmath34 and @xmath130",
    "if necessary we may assume that @xmath312 .",
    "we will distinguish two cases .",
    "suppose first that @xmath313 and let @xmath314 .",
    "define @xmath315 and @xmath316 .",
    "then @xmath317}(v)-e(y,\\overline{y})-e(\\overline{y},y)\\\\ & { \\ge } & |y|(1 - 2c)|x|/\\beta -|y|(|x|-|y|)/\\beta = |y|(|y|-2c|x|)/\\beta\\ge |x|^2/(30\\beta).\\end{aligned}\\ ] ] so suppose next that @xmath318",
    ". then @xmath319 .",
    "therefore , @xmath320}(v)-e(a,\\overline{a\\cup b})-e(a)\\\\ & { \\ge } &     & \\ge & |a|[(1/2-c)-(1/5 + 2c)-(1/2-c)/2]|x|/\\beta\\ge |x|^2/(60\\beta),\\end{aligned}\\ ] ] as required .    to prove  ( ii )",
    "we consider the weighted digraph @xmath321 obtained from @xmath303 by giving each edge @xmath232 of @xmath303 weight @xmath233 . given a cluster @xmath60 , we write @xmath322 for the sum of the weights of all edges sent out by  @xmath60 in  @xmath321 .",
    "we define @xmath323 similarly and write @xmath324 for the minimum of @xmath325 over all clusters  @xmath60 .",
    "note that @xmath326 .",
    "moreover , lemma  [ dilemma ] implies that @xmath327 .",
    "thus each @xmath328 satisfies @xmath329 and so @xmath330 . arguing in the same way for inweights gives us @xmath331",
    "let @xmath332 be as in  ( ii ) .",
    "similarly as in  ( i ) ( setting @xmath333 and @xmath334 in the calculations ) one can show that the sum of all weights of the edges from  @xmath34 to @xmath130 in  @xmath321 is at least @xmath307 .",
    "but this implies that @xmath303 contains at least @xmath307 edges from  @xmath34 to  @xmath130 .",
    "[ multifactor1 ] let @xmath335 .",
    "suppose that @xmath1 is an oriented graph of order @xmath2 with @xmath295 .",
    "let @xmath64 denote the reduced multidigraph of @xmath1 with parameters @xmath336 and @xmath176 obtained by applying lemma  [ dilemma ] .",
    "let @xmath337 . then there exist edge - disjoint collections @xmath69 of vertex - disjoint cycles in @xmath64 such that each @xmath70 covers all but at most @xmath338 of the clusters in @xmath64 .",
    "let @xmath339 .",
    "since @xmath340 , lemma  [ multimin ] implies that @xmath341    first we find a set of clusters @xmath342 with the following properties :    * @xmath343 , * @xmath344 for all @xmath345 .",
    "we obtain @xmath131 by choosing a set of @xmath346 clusters uniformly at random",
    ". then each cluster @xmath60 satisfies @xmath347 proposition  [ chernoff ] for the hypergeometric distribution now implies that with nonzero probability @xmath131 satisfies our desired conditions .",
    "( recall that @xmath348 is a multiset .",
    "formally proposition  [ chernoff ] does not apply to multisets .",
    "however , for each @xmath349 we can apply proposition  [ chernoff ] to the set of all those clusters which appear at least @xmath350 times in @xmath351 , and similarly for @xmath352 . )",
    "note that @xmath353 for each @xmath354 .",
    "we now add a small number of _ temporary edges _ to @xmath355 in order to turn it into an @xmath356-regular multidigraph where @xmath357 .",
    "we do this as follows .",
    "as long as @xmath355 is not @xmath356-regular there exist @xmath358 such that @xmath60 has outdegree less than @xmath356 and @xmath239 has indegree less than @xmath356 . in this case",
    "we add an edge from @xmath60 to @xmath239 .",
    "( note we may have @xmath359 , in which case we add a loop . )",
    "we decompose the edge set of @xmath360 into @xmath356 1-factors @xmath361 .",
    "( to see that we can do this , consider the bipartite multigraph @xmath49 where both vertex classes @xmath362 consist of a copy of @xmath363 and we have @xmath364 edges between @xmath167 and @xmath169 if there are precisely @xmath364 edges from @xmath57 to  @xmath58 in @xmath355 , including the temporary edges . then @xmath49 is regular and so has a perfect matching .",
    "this corresponds to a @xmath48-factor @xmath365 .",
    "now remove the edges of @xmath365 from  @xmath49 and continue to find @xmath366 in the same way . )",
    "since at each cluster we added at most @xmath367 temporary edges , all but at most @xmath368 of the @xmath369 contain at most @xmath370 temporary edges . by relabeling",
    "if necessary we may assume that @xmath371 are such @xmath48-factors .",
    "we now remove the temporary edges from each of these @xmath48-factors , though we still refer to the digraphs obtained in this way as @xmath371 .",
    "so each @xmath369 spans @xmath355 and consists of cycles and at most @xmath372 paths .",
    "our aim is to use the clusters in @xmath131 to piece up these paths into cycles in order to obtain edge - disjoint directed subgraphs @xmath373 of @xmath64 where each @xmath70 is a collection of vertex - disjoint cycles and @xmath374 .",
    "let @xmath375 denote all the paths lying in one of @xmath371 ( so @xmath376 ) .",
    "our next task is to find edge - disjoint paths and cycles @xmath377 of length  @xmath378 in @xmath64 with the following properties .    *",
    "if @xmath379 consists of a single cluster @xmath380 then @xmath381 is a cycle consisting of @xmath382 clusters in @xmath131 as well as @xmath383 . *",
    "if @xmath379 is a path of length @xmath384 then @xmath381 is a path whose startpoint is the endpoint of @xmath379 .",
    "similarly the endpoint of @xmath381 is the startpoint of @xmath379 . * if @xmath379 is a path of length @xmath385 then the internal clusters in the path @xmath381 lie in  @xmath131 . *",
    "if @xmath386 and @xmath387 lie in the same @xmath369 then @xmath388 and @xmath389 are vertex - disjoint",
    ".    so conditions ( i)(iii ) imply that @xmath390 is a directed cycle for each @xmath391 .",
    "assuming we have found such paths and cycles @xmath377 , we define @xmath392 as follows .",
    "suppose @xmath393 are the paths in @xmath369 .",
    "then we obtain @xmath70 from @xmath369 by adding the paths and cycles @xmath394 to @xmath369 .",
    "condition  ( iv ) ensures that the @xmath70 are indeed collections of vertex - disjoint cycles .",
    "it remains to show the existence of @xmath377 .",
    "suppose that for some @xmath395 we have already found @xmath396 and now need to define @xmath381 .",
    "consider @xmath379 and suppose it lies in @xmath369 .",
    "let @xmath397 denote the startpoint of @xmath379 and @xmath398 its endpoint .",
    "we call an edge @xmath399 in @xmath64 _ free _ if it has not been used in one of @xmath400 .",
    "let @xmath130 be the set of all those clusters @xmath401 for which at least @xmath402 of the edges at @xmath403 in @xmath404 $ ] are not free .",
    "our next aim is to show that @xmath130 is small . more precisely , @xmath405 to see this , note that @xmath406 edges of @xmath407 $ ] lie in one of @xmath408",
    "thus , @xmath409 .",
    "( the extra factor of  2 comes from the fact that we may have counted edges at the vertices in  @xmath130 twice . ) since @xmath410 this implies that @xmath411 , as desired .",
    "we will only use clusters in @xmath412 when constructing @xmath381 . note that @xmath397 receives at most @xmath413 edges from @xmath130 in @xmath64 .",
    "since we added at most @xmath414 temporary edges to @xmath355 per cluster , @xmath397 can be the startpoint or endpoint of at most @xmath414 of the paths @xmath415 .",
    "thus @xmath397 lies in at most @xmath416 of the paths and cycles",
    "@xmath408 . in particular , at most @xmath417 edges at @xmath418 in @xmath64",
    "are not free .",
    "we will avoid such edges when constructing @xmath381 .",
    "for each of @xmath408 we have used @xmath382 clusters in @xmath131 .",
    "let @xmath419 denote the paths which lie in @xmath369 ( so @xmath420 ) .",
    "thus at most @xmath421 clusters in @xmath131 already lie in the paths and cycles @xmath394 .",
    "so for @xmath381 to satisfy ( iv ) , the inneighbour of @xmath397 on @xmath381 must not be one of these clusters .",
    "note that @xmath397 receives at most @xmath422 edges in @xmath64 from these clusters .",
    "thus in total we can not use @xmath423 of the edges which @xmath397 receives from @xmath131 in @xmath64 .",
    "but @xmath424 and so we can still choose a suitable cluster @xmath425 in @xmath426 which will play the role of the inneighbour of @xmath397 on @xmath381 .",
    "let @xmath427 denote the corresponding free edge in @xmath64 which we will use in @xmath381 .",
    "a similar argument shows that we can find a cluster @xmath428 to play the role of the outneighbour of @xmath398 on @xmath381 .",
    "so @xmath429 , @xmath430 does not lie on any of @xmath431 and there is a free edge @xmath432 in @xmath64 .",
    "we need to choose the outneighbour @xmath433 of @xmath430 on @xmath381 such that @xmath434 , @xmath433 has not been used in @xmath435 and there is a free edge from @xmath430 to @xmath433 in @xmath64 .",
    "let @xmath436 denote the set of all clusters in @xmath437 which satisfy these conditions .",
    "since @xmath438 at most @xmath439 edges at @xmath430 in @xmath404 $ ] are not free .",
    "so @xmath430 sends out at least @xmath440 free edges to @xmath441 in @xmath64 . on the other hand , as before one can show that @xmath430 sends at most @xmath422 edges to clusters in @xmath437 which already lie in @xmath431 .",
    "hence , @xmath442\\geq ( 1/2 - 3c)|x|$ ] .",
    "similarly we need to choose the inneighbour @xmath443 of @xmath425 on @xmath381 such that @xmath444 , @xmath443 has not been used in @xmath431 and so that @xmath64 contains a free edge from @xmath443 to @xmath425 .",
    "let @xmath445 denote the set of all clusters in @xmath437 which satisfy these conditions .",
    "as before one can show that @xmath446 .",
    "recall that @xmath300)\\geq ( 1/2 - 5d)|x|/\\beta$ ] by our choice of  @xmath131 .",
    "thus lemma  [ keevashmult](i ) implies that @xmath404 $ ] contains at least @xmath447 edges from @xmath436 to @xmath445 . since all but at most @xmath448 edges of @xmath64 are free",
    ", there is a free edge @xmath449 from @xmath436 to @xmath445 .",
    "let @xmath450 be a free edge from @xmath430 to @xmath433 in @xmath64 and let @xmath451 be a free edge from @xmath443 to @xmath452 ( such edges exist by definition of @xmath436 and @xmath445 ) .",
    "we take @xmath381 to be the directed path or cycle which consists of the edges @xmath432 , @xmath453 , @xmath454 , @xmath455 and @xmath456 .",
    "frieze and krivelevich  @xcite showed that every @xmath457-super - regular pair @xmath458 contains a regular subgraph @xmath459 whose density is almost the same as that of @xmath458 .",
    "the following lemma is an extension of this , where we can require @xmath459 to have a given degree sequence , as long as this degree sequence is almost regular .",
    "[ fandk ] let @xmath460 .",
    "suppose that @xmath461 is an @xmath462-super - regular pair where @xmath463 .",
    "define @xmath464 .",
    "suppose we have a non - negative integer @xmath465 associated with each @xmath466 and a non - negative integer @xmath467 associated with each @xmath468 such that @xmath469 .",
    "then @xmath458 contains a spanning subgraph @xmath470 in which @xmath471 is the degree of @xmath466 and @xmath472 is the degree of @xmath468 .",
    "we first obtain a directed network @xmath143 from @xmath458 by adding a source @xmath364 and a sink @xmath473 .",
    "we add an edge @xmath474 of capacity @xmath475 for each @xmath466 and an edge @xmath476 of capacity @xmath477 for each @xmath468 .",
    "we give all the edges in @xmath458 capacity @xmath48 and direct them from @xmath62 to  @xmath403 .",
    "our aim is to show that the capacity of any cut is at least @xmath478 . by the max - flow",
    "min - cut theorem this would imply that @xmath143 admits a flow of value @xmath479 , which by construction of @xmath143 implies the existence of our desired subgraph  @xmath459 .",
    "so consider any @xmath480-cut @xmath481 where @xmath482 with @xmath483 and @xmath484 .",
    "let @xmath485 and @xmath486 the capacity of this cut is @xmath487 and so our aim is to show that @xmath488 now @xmath489 by ( [ aim1 ] ) we may assume that @xmath490 .",
    "( since otherwise @xmath491 and thus ( [ aim ] ) is satisfied . ) similarly by ( [ aim2 ] ) we may assume that @xmath492 . let @xmath493 .",
    "we now consider several cases .    * case 1 . * @xmath494 and @xmath495    since @xmath458 is @xmath496-super - regular we have that @xmath497 ( the last inequality follows since @xmath498 . )",
    "together with  ( [ aim1 ] ) this implies ( [ aim ] ) .",
    "* @xmath494 , @xmath499 and @xmath500    again since @xmath458 is @xmath496-super - regular we have that @xmath501 as before , to prove  ( [ aim ] ) we will show that @xmath502 thus by ( [ eqaim ] ) it suffices to show that @xmath503 .",
    "we know that @xmath504 since @xmath505 hence , @xmath506 .",
    "so @xmath503 as @xmath500 so indeed ( [ aim ] ) is satisfied .    *",
    "* @xmath494 , @xmath499 and @xmath507    by  ( [ aim2 ] ) in order to prove  ( [ aim ] ) it suffices to show that @xmath508 since  ( [ eqaim ] ) also holds in this case , this means that it suffices to show that @xmath509 .",
    "since @xmath510 and @xmath511 we have that @xmath512 .",
    "thus @xmath513 and so indeed ( [ aim ] ) holds .",
    "* @xmath514    since @xmath490 we have that @xmath515 .",
    "hence , @xmath516 and so by ( [ aim1 ] ) we see that ( [ aim ] ) is satisfied , as desired .",
    "* @xmath517 .",
    "similarly as in case  4 it follows that @xmath518 . indeed , if @xmath519 then @xmath520 and as @xmath521 this implies @xmath522 , a contradiction .",
    "it is easy to see that every regular oriented graph @xmath1 contains a @xmath48-factor .",
    "the following result states that if @xmath1 is also dense , then ( i ) we can guarantee a @xmath48-factor with few cycles .",
    "such @xmath48-factors have the advantage that we can transform them into a hamilton cycle by adding / deleting a comparatively small number of edges . ( ii )",
    "implies that even if @xmath1 contains a sparse ` bad ' subgraph @xmath49 , then there will be a @xmath48-factor which does not contain ` too many ' edges of @xmath49 .",
    "[ 1factororiented ] let @xmath523 and @xmath524 .",
    "let @xmath1 be a @xmath525-regular oriented graph whose order @xmath2 is sufficiently large and where @xmath526 .",
    "suppose @xmath527 are sets of vertices in @xmath1 with @xmath528 .",
    "let @xmath49 be an oriented subgraph of @xmath1 such that @xmath529 for all @xmath530 ( for each @xmath82 ) .",
    "then @xmath1 has a @xmath48-factor @xmath531 such that    * @xmath531 contains at most @xmath532 cycles ; * for each @xmath82 , at most @xmath533 edges of @xmath534 are incident to @xmath23 .",
    "to prove this result we will use ideas similar to those used by frieze and krivelevich  @xcite . in particular , we will use the following bounds on the number of perfect matchings in a bipartite graph .",
    "[ matchingbounds ] suppose that @xmath130 is a bipartite graph whose vertex classes have size @xmath2 and @xmath535 are the degrees of the vertices in one of these vertex classes .",
    "let @xmath536 denote the number of perfect matchings in @xmath130 .",
    "then @xmath537 furthermore , if @xmath130 is @xmath525-regular then @xmath538    the upper bound in theorem  [ matchingbounds ] was proved by brgman  @xcite .",
    "the lower bound is a consequence of the van der waerden conjecture which was proved independently by egorychev  @xcite and falikman  @xcite",
    ".    we will deduce ( i ) from the following result in  @xcite , which in turn is similar to lemma  2 in  @xcite .",
    "[ 2factor ] for all @xmath539 there exists @xmath540 such that the following holds .",
    "let @xmath130 be a @xmath541-regular bipartite graph whose vertex classes @xmath62 and @xmath63 satisfy @xmath542 .",
    "let @xmath543 be any perfect matching from @xmath62 to @xmath63 which is disjoint from @xmath130 .",
    "let @xmath544 be a perfect matching chosen uniformly at random from the set of all perfect matchings in @xmath130 .",
    "let @xmath545 be the resulting @xmath546-factor .",
    "then the probability that @xmath531 contains more than @xmath532 cycles is at most @xmath547 .",
    "* proof of lemma  [ 1factororiented ] . * consider the @xmath525-regular bipartite graph @xmath130 whose vertex classes @xmath548 are copies of @xmath549 and where @xmath550 is joined to @xmath551 if @xmath105 is a directed edge in @xmath1 .",
    "note that every perfect matching in @xmath130 corresponds to a @xmath48-factor of @xmath1 and vice versa .",
    "let @xmath536 denote the number of perfect matchings of @xmath130 .",
    "then @xmath552 by theorem  [ matchingbounds ] .",
    "here we have also used stirling s formula which implies that for sufficiently large @xmath80 , @xmath553 we now count the number @xmath554 of @xmath48-factors of @xmath1 which contain more than @xmath533 edges of @xmath49 which are incident to @xmath23 . note that @xmath555 indeed , the term @xmath556 in  ( [ mured1 ] ) gives an upper bound for the number of ways we can choose @xmath533 edges from @xmath49 which are incident to @xmath23 such that no two of these edges have the same startpoint and no two of these edges have the same endpoint .",
    "the term @xmath557 in  ( [ mured1 ] ) uses the upper bound in theorem  [ matchingbounds ] to give a bound on the number of @xmath48-factors in @xmath1 containing @xmath558 fixed edges .",
    "now @xmath559 since @xmath560 and @xmath561 since @xmath562 .",
    "furthermore , @xmath563 so by ( [ mured1 ] ) we have that @xmath564 since @xmath565 , @xmath566 and @xmath2 is sufficiently large .",
    "now we apply lemma  [ 2factor ] to @xmath130 where @xmath543 is the identity matching ( i.e.  every vertex in @xmath567 is matched to its copy in @xmath568 ) .",
    "then a cycle of length @xmath569 in @xmath570 corresponds to a cycle of length @xmath39 in @xmath1 .",
    "so , since @xmath2 is sufficiently large , the number of @xmath48-factors of @xmath1 containing more than @xmath532 cycles is at most @xmath571 .",
    "so there exists a @xmath48-factor @xmath531 of @xmath1 which satisfies ( i ) and ( ii ) .",
    "the following lemma will be a useful tool when transforming @xmath48-factors into hamilton cycles .",
    "given such a @xmath48-factor @xmath531 , we will obtain a path @xmath56 by cutting up and connecting several cycles in @xmath531 ( as described in the proof sketch in section  [ sketch ] ) .",
    "we will then apply the lemma to obtain a cycle @xmath55 containing precisely the vertices of @xmath56 .",
    "[ rotationlemma ] let @xmath572 .",
    "let @xmath1 be an oriented graph on @xmath573 vertices .",
    "suppose that @xmath62 and @xmath403 are disjoint subsets of @xmath549 of size @xmath80 with the following property : @xmath574 suppose that @xmath575 is a directed path in @xmath1 where @xmath576 and @xmath577 .",
    "let @xmath131 denote the set of inneighbours @xmath578 of @xmath579 which lie on @xmath56 so that @xmath466 and @xmath580",
    ". similarly let @xmath132 denote the set of outneighbours @xmath578 of @xmath581 which lie on @xmath56 so that @xmath582 and @xmath583 .",
    "suppose that @xmath584 .",
    "then there exists a cycle @xmath55 in @xmath1 containing precisely the vertices of @xmath56 such that @xmath585 .",
    "furthermore , @xmath586 consists of edges from  @xmath131 to  @xmath587 and edges from  @xmath588 to  @xmath132 .",
    "( here @xmath587 is the set of successors of vertices in  @xmath131 on @xmath56 and @xmath588 is the set of predecessors of vertices in  @xmath132 on  @xmath56 . )",
    "clearly we may assume that @xmath589 .",
    "let @xmath590 denote the set of the first @xmath591 vertices in @xmath131 along @xmath56 and @xmath592 the set of the last @xmath593 vertices in @xmath131 along @xmath56 .",
    "we define @xmath594 and @xmath595 analogously .",
    "so @xmath596 and @xmath597 .",
    "we have two cases to consider .    * case 1 . *",
    "all the vertices in @xmath590 precede those in @xmath595 along @xmath56 .",
    "partition @xmath598 where @xmath599 denotes the set of the first @xmath600 vertices in @xmath590 along @xmath56 .",
    "we partition @xmath595 into @xmath601 and @xmath602 analogously .",
    "let @xmath603 denote the set of successors on @xmath56 of the vertices in @xmath604 and @xmath605 the set of predecessors of the vertices in @xmath601 .",
    "so @xmath606 and @xmath607 .",
    "further define    * @xmath608 and * @xmath609 .",
    "so @xmath610 and @xmath611 .    from ( [ label ] )",
    "it follows that @xmath612 and similarly @xmath613 . since @xmath610 and @xmath611 , by ( [ label ] ) @xmath1 contains an edge @xmath614 from @xmath615 to @xmath616 .",
    "since @xmath617 , by definition of @xmath616 it follows that @xmath1 contains an edge @xmath618 for some @xmath619 .",
    "likewise , since @xmath620 , there is an edge @xmath621 for some @xmath622 .",
    "furthermore , @xmath623 and @xmath624 are edges of @xmath1 by definition of @xmath625 and @xmath605 .",
    "it is easy to check that the cycle @xmath626 has the required properties ( see figure  1 ) .",
    "for example , @xmath586 consists of the edges @xmath627 , @xmath628 , @xmath629 and @xmath630 .",
    "the former two edges go from  @xmath131 to  @xmath587 and the latter two from  @xmath588 to  @xmath132 .",
    "[ fig : rotation ]    [ ] [ ] @xmath579 [ ] [ ] @xmath631 [ ] [ ] @xmath632 [ ] [ ] @xmath633 [ ] [ ]  @xmath634 [ ] [ ] @xmath635 [ ] [ ] @xmath636 [ ] [ ] @xmath637 [ ] [ ] @xmath638 [ ] [ ] @xmath581   from case  1,title=\"fig : \" ]    * case 2 . *",
    "all the vertices in @xmath594 precede those in @xmath592 along @xmath56 .",
    "let @xmath639 be the predecessors of the vertices in @xmath594 and @xmath640 the successors of the vertices in @xmath592 on @xmath56 .",
    "so @xmath641 and @xmath642 and @xmath643 .",
    "thus by  ( [ label ] ) there exists an edge @xmath644 from @xmath645 to @xmath646 .",
    "again , it is easy to check that the cycle @xmath647 has the desired properties .",
    "suppose @xmath61 is a digraph and @xmath531 is a collection of vertex - disjoint cycles with @xmath648 .",
    "a _ closed shifted walk @xmath63 in  @xmath61 with respect to @xmath531 _ is a walk in @xmath649 of the form @xmath650 where    * @xmath651 is the set of all cycles in @xmath531 ; * @xmath475 lies on @xmath72 and @xmath652 is the successor of @xmath475 on @xmath72 for each @xmath653 ; * @xmath654 is an edge of @xmath61 ( here @xmath655 ) .",
    "note that the cycles @xmath656 are not necessarily distinct .",
    "if a cycle @xmath72 in @xmath531 appears exactly @xmath473 times in @xmath63 we say that @xmath72 is _ traversed @xmath473 times_. note that a closed shifted walk @xmath63 has the property that for every cycle @xmath55 of @xmath531 , every vertex of @xmath55 is visited the same number of times by @xmath63 .",
    "the next lemma will be used in section  [ merging ] to combine cycles of @xmath1 which correspond to different cycles of @xmath531 into a single ( hamilton ) cycle .",
    "shifted walks were introduced in  @xcite , where they were used for a similar purpose .",
    "[ shiftedwalk ] let @xmath657 .",
    "suppose that @xmath1 is an oriented graph of order @xmath2 with @xmath295 .",
    "let @xmath61 denote the reduced digraph of @xmath1 with parameters @xmath658 and @xmath176 obtained by applying lemma  [ dilemma ] .",
    "let @xmath659 .",
    "let @xmath303 denote the spanning subgraph of @xmath61 obtained by deleting all edges which correspond to pairs of density at most @xmath172 in the pure digraph  @xmath52 .",
    "let @xmath531 be a collection of vertex - disjoint cycles with @xmath660 and @xmath661 .",
    "then @xmath303 contains a closed shifted walk with respect to @xmath531 so that each cycle @xmath55 in @xmath531 is traversed at most @xmath662 times .",
    "let @xmath663 denote the cycles of @xmath531 .",
    "we construct our closed shifted walk @xmath63 as follows : for each cycle @xmath72 , choose an arbitrary vertex @xmath664 lying on @xmath72 and let @xmath665 denote its successor on  @xmath72 .",
    "let @xmath666 and let @xmath667 be the set of predecessors of @xmath668 on @xmath531 .",
    "similarly , let @xmath669 and let @xmath670 be the set of successors of @xmath60 on @xmath531 . since @xmath304 by lemma  [ keevashmult](ii ) , we have @xmath671 and @xmath672 .",
    "so by lemma  [ keevashmult](ii ) there is an edge @xmath673 from @xmath667 to @xmath674 in @xmath303 .",
    "then we obtain a walk @xmath675 from @xmath676 to @xmath677 by first traversing @xmath72 to reach @xmath664 , then use the edge from @xmath664 to the successor @xmath578 of @xmath678 , then traverse the cycle in  @xmath531 containing @xmath578 as far as @xmath679 , then use the edge @xmath673 , then traverse the cycle in  @xmath531 containing @xmath680 as far as @xmath681 , and finally use the edge @xmath682 .",
    "( here @xmath683 . )",
    "@xmath63 is obtained by concatenating the @xmath675 .",
    "without loss of generality we may assume that @xmath684 .",
    "define further constants satisfying @xmath685    let @xmath1 be an oriented graph of order @xmath686 such that @xmath687 .",
    "apply the diregularity lemma ( lemma  [ dilemma ] ) to @xmath1 with parameters @xmath231 and @xmath176 to obtain clusters @xmath688 of size @xmath80 , an exceptional set @xmath85 , a pure digraph @xmath52 and a reduced digraph @xmath61 ( so @xmath689 ) .",
    "let @xmath303 be the spanning subdigraph of  @xmath61 whose edges correspond to pairs of density at least  @xmath172 .",
    "so @xmath232 is an edge of  @xmath303 if @xmath190 has density at least  @xmath172 .",
    "let @xmath64 denote the reduced multidigraph of @xmath1 with parameters @xmath236 and @xmath176 .",
    "for each edge @xmath232 of @xmath61 let @xmath233 denote the density of the @xmath162-regular pair @xmath190 .",
    "recall that each edge @xmath690 is associated with the @xmath32th spanning subgraph @xmath243 of @xmath190 obtained by applying lemma  [ split ] with parameters @xmath691 and @xmath692 .",
    "each @xmath243 is @xmath162-regular with density @xmath244 .",
    "lemma  [ multimin ] implies that @xmath693 ( the second inequality holds since @xmath694 . )",
    "apply lemma  [ multifactor1 ] to @xmath64 in order to obtain @xmath695 edge - disjoint collections @xmath69 of vertex - disjoint cycles in @xmath64 such that each @xmath70 contains all but at most @xmath346 of the clusters in @xmath64 .",
    "let @xmath696 denote the set of all those vertices in @xmath1 which do not lie in clusters covered by  @xmath70 .",
    "so @xmath697 for all @xmath84 and @xmath698 .",
    "we now apply lemma  [ superreg ] to each cycle in @xmath70 to obtain subclusters of size @xmath264 such that the edges of @xmath70 now correspond to @xmath266-super - regular pairs . by removing one extra vertex from each cluster",
    "if necessary we may assume that @xmath274 is even .",
    "all vertices not belonging to the chosen subclusters of @xmath70 are added to @xmath696 .",
    "so now latexmath:[\\ ] ] we proceed similarly for all vertices in @xmath760 , with the random choices being independent for different vertices @xmath781 .",
    "( note that every edge of @xmath1 is free with respect to at most one vertex in  @xmath760 . ) then using the lower bound on @xmath757 for all @xmath781 we have @xmath790 for each @xmath711 and all @xmath752 .",
    "as before , applying the chernoff type bound in proposition  [ chernoff ] for each @xmath82 and summing up the failure probabilities over all  @xmath82 shows that with nonzero probability the following properties hold :    * ( [ freedeg])([freein ] ) imply that @xmath791 for each @xmath792 . * ( [ inc ] ) implies that @xmath793 for each @xmath752 .",
    "together with the properties of @xmath86 established after choosing the edges at the vertices in @xmath768 it follows that @xmath794 for every @xmath795 and @xmath796 for every @xmath752 .",
    "furthermore , @xmath769 are still edge - disjoint since when dealing with the vertices in @xmath760 we only added free edges . by discarding any edges assigned to @xmath86 which lie entirely in @xmath696 we can ensure that  ( i ) holds",
    ". so altogether ( i)(iii ) are satisfied , as desired .",
    "as mentioned in the previous section we will use each of the @xmath86 to piece together roughly @xmath748 hamilton cycles of @xmath1 .",
    "we will achieve this by firstly adding some more special edges to each @xmath86 ( see section  [ skel ] ) and then almost decomposing each @xmath86 into @xmath48-factors .",
    "however , in order to use these @xmath48-factors to create hamilton cycles we will need to ensure that no @xmath48-factor contains a @xmath546-path with start- and endpoint in @xmath696 , and midpoint in @xmath72 .",
    "unfortunately @xmath86 might contain such paths . to avoid them",
    ", we will ` randomly split ' each  @xmath86 .",
    "we start by considering a random partition of each @xmath797 . using the chernoff bound in proposition  [ chernoff ] for the hypergeometric distribution",
    "one can show that there exists a partition of @xmath403 into subclusters @xmath798 and @xmath799 so that the following conditions hold :    * @xmath800 for each @xmath797 .",
    "* @xmath801 and @xmath802 for each @xmath750 .",
    "( here @xmath803 and @xmath804 . )",
    "recall that each edge @xmath805 corresponds to the @xmath739-super - regular pair @xmath737 .",
    "let @xmath806 .",
    "so @xmath807 apply lemma  [ split](ii ) to obtain a partition @xmath808 of the edge set of @xmath737 so that the following condition holds :    * the edges of @xmath809 and @xmath810 both induce an @xmath811-super - regular pair which spans @xmath737 .",
    "we now partition @xmath86 into two oriented spanning subgraphs @xmath812 and @xmath813 as follows .    *",
    "the edge set of @xmath812 is the union of all @xmath809 ( over all edges @xmath701 of @xmath70 ) together with all the edges in @xmath86 from @xmath696 to @xmath814 , and all edges in  @xmath86 from @xmath815 to @xmath696 . *",
    "the edge set of @xmath813 is the union of all @xmath810 ( over all edges @xmath701 of @xmath70 ) together with all the edges in @xmath86 from @xmath696 to @xmath815 , and all edges in  @xmath86 from @xmath814 to @xmath696 .",
    "note that neither @xmath812 nor @xmath813 contains the type of @xmath546-paths we wish to avoid . for each @xmath711",
    "we use lemma  [ split](ii ) to partition the edge set of each @xmath97 to obtain edge - disjoint oriented spanning subgraphs @xmath816 and @xmath817 so that the following condition holds :    * for each edge @xmath701 in @xmath70 , both @xmath816 and @xmath817 contain a spanning oriented subgraph of @xmath722 which is @xmath818-super - regular .",
    "moreover , all edges in @xmath816 and @xmath817 belong to one of these pairs .",
    "similarly we partition the edge set of each @xmath99 to obtain edge - disjoint oriented spanning subgraphs @xmath819 and @xmath820 so that the following condition holds :    * for each edge @xmath701 in @xmath70 , both @xmath819 and @xmath820 contain a spanning oriented subgraph of @xmath722 which is @xmath821-super - regular .",
    "moreover , all edges in @xmath819 and @xmath820 belong to one of these pairs .",
    "we pair @xmath816 and @xmath819 with @xmath812 and pair @xmath817 and @xmath820 with @xmath813 .",
    "we now have @xmath822 edge - disjoint oriented subgraphs of @xmath1 , namely @xmath823 .",
    "to simplify notation , we relabel these oriented graphs as @xmath824 where @xmath825 we similarly relabel the oriented graphs @xmath826 as @xmath827 and relabel @xmath828 as @xmath829 in such a way that @xmath97 and @xmath99 are the oriented graphs which we paired with @xmath86 . for each @xmath82",
    "we still use the notation @xmath70 , @xmath72 and @xmath696 in the usual way . now",
    "( i ) from section  [ sec : incorp ] becomes    * @xmath830 where @xmath103 has neighbours only in @xmath72 , for all @xmath750 ,    while ( ii ) and ( iii ) remain valid .",
    "note that all vertices ( including the vertices of @xmath696 ) in each @xmath86 now have in- and outdegree close to @xmath831 . in section  [ nicefactor ]",
    "our aim is to find a @xmath832-regular oriented subgraph of @xmath86 , where @xmath833 however , this may not be possible : suppose for instance that @xmath696 consists of a single vertex @xmath103 , @xmath70 consists of 2 cycles @xmath55 and @xmath59 and that all outneighbours of @xmath103 lie on @xmath55 and all inneighbours lie on @xmath59 .",
    "then @xmath86 does not even contain a @xmath48-factor .",
    "a similar problem arises if for example @xmath696 consists of a single vertex @xmath103 , @xmath70 consists of a single cycle @xmath834 , all outneighbours of @xmath103 lie in the cluster @xmath568 and all inneighbours in the cluster @xmath835 .",
    "note that in both situations , the edges between @xmath696 and @xmath72 are not ` well - distributed ' or ` balanced ' . to overcome this problem",
    ", we add further edges to @xmath72 which will ` balance out ' the edges between @xmath72 and @xmath696 which we added previously . these edges will be part of the skeleton walks which we define below . to motivate the definition of the skeleton walks",
    "it may be helpful to consider the second example above : suppose that we add an edge @xmath65 from @xmath567 to @xmath836",
    ". then @xmath86 now has a @xmath48-factor . in general",
    ", we can not find such an edge , but it will turn out that we can find a collection of 5 edges fulfilling the same purpose .",
    "a _ skeleton walk _ @xmath837 in @xmath1 with respect to @xmath86 is a collection of distinct edges @xmath838 , @xmath839 , @xmath840 , @xmath841 and @xmath842 of @xmath1 with the following properties :    * @xmath843 and all vertices in @xmath844 lie in @xmath72 . * given some @xmath845 , let @xmath846 denote the cluster in  @xmath70 containing @xmath847 and let @xmath55 denote the cycle in @xmath70 containing @xmath403",
    ". then @xmath848 , where @xmath849 is the predecessor of @xmath403 on @xmath55 .",
    "note that whenever @xmath850 is a union of edge - disjoint skeleton walks and @xmath851 is a cluster in @xmath70 , the number of edges in @xmath850 whose endpoint is in @xmath403 is the same as the number of edges in @xmath850 whose startpoint is in @xmath852 . as indicated above , this",
    "` balanced ' property will be crucial when finding a @xmath832-regular oriented subgraph of @xmath86 in section  [ nicefactor ] .",
    "the 2nd , 3rd and 4th edge of each skeleton walk  @xmath853 with respect to  @xmath86 will lie in the ` random ' graph  @xmath89 chosen in section  [ applydrl ] .",
    "more precisely , each of these three edges will lie in a ` slice ' @xmath854 of  @xmath89 assigned to  @xmath86 .",
    "we will now partition  @xmath89 into these ` slices ' @xmath855 . to do this , recall that any edge @xmath701 in @xmath64 corresponds to an @xmath162-regular pair of density at least @xmath718 in @xmath89 . here",
    "@xmath705 and @xmath706 are viewed as clusters in @xmath64 , so @xmath856 .",
    "apply lemma  [ split](i ) to each such pair of clusters to find edge - disjoint oriented subgraphs @xmath857 of @xmath89 so that for each @xmath854 all the edges @xmath701 in @xmath64 correspond to @xmath858$]-regular pairs with density at least @xmath859 in @xmath854 .",
    "recall that by  ( i@xmath860 ) in section  [ randomsplit ] each vertex @xmath861 has at least @xmath862 outneighbours in @xmath72 and at least @xmath863 inneighbours in @xmath72 .",
    "we pair @xmath832 of these outneighbours @xmath864 with distinct inneighbours @xmath865 . for each of these @xmath832 pairs",
    "@xmath866 we wish to find a skeleton walk with respect to  @xmath86 whose @xmath48st edge is @xmath867 and whose @xmath378th edge is @xmath868 .",
    "we denote the union of these @xmath832 pairs @xmath869 of edges over all @xmath795 by @xmath870 .",
    "in section  [ randomsplit ] we partitioned each cluster @xmath797 into subclusters @xmath798 and  @xmath799 .",
    "we next show how to choose the skeleton walks for all those @xmath86 for which each edge in @xmath86 with startpoint in @xmath696 has its endpoint in @xmath814 ( and so each edge in @xmath86 with endpoint in @xmath696 has startpoint in @xmath815 ) .",
    "the other case is similar , one only has to interchange @xmath814 and @xmath815 .",
    "[ skelg ] we can find a set @xmath871 of @xmath872 skeleton walks with respect to  @xmath86 , one for each pair of edges in @xmath870 , such that @xmath871 has the following properties :    * for each skeleton walk in @xmath871 , its @xmath546nd , @xmath873rd and @xmath382th edge all lie in @xmath854 and all these edges have their startpoint in @xmath815 and endpoint in @xmath814 .",
    "* any two of the skeleton walks in @xmath871 are edge - disjoint . *",
    "every @xmath752 is incident to at most @xmath874 edges belonging to the skeleton walks in @xmath871 .",
    "note that @xmath875 by ( [ v0 ] ) and ( [ tau ] ) . to find @xmath871",
    ", we will first find so - called shadow skeleton walks ( here the internal edges are edges of @xmath64 instead of @xmath1 ) .",
    "more precisely , a _ shadow skeleton walk _",
    "@xmath876 with respect to @xmath86 is a collection of two edges @xmath838 , @xmath842 of @xmath1 and three edges @xmath877 , @xmath878 , @xmath879 of @xmath64 with the following properties :    * @xmath838 , @xmath842 is a pair in @xmath870 . *",
    "@xmath880 , @xmath881 and each @xmath882 is a vertex of a cycle in @xmath70 and @xmath883 is the predecessor of @xmath882 on that cycle .",
    "note that in the second condition we slightly abused the notation : as @xmath882 is a cluster in  @xmath64 , it only corresponds to a cluster in  @xmath70 ( which has size  @xmath274 and is a subcluster of the one in  @xmath64 ) .",
    "however , in order to simplify our exposition , we will use the same notation for a cluster in  @xmath64 as for the cluster in  @xmath70 corresponding to it .",
    "we refer to the edge @xmath884 as the @xmath350th edge of the shadow skeleton walk @xmath876 .",
    "given a collection @xmath885 of shadow skeleton walks ( with respect to @xmath86 ) we say an edge of @xmath64 is _ bad _ if it is used at least @xmath886 times in @xmath885 , and _ very bad _ if it is used at least @xmath887 times in @xmath885 .",
    "we say an edge from @xmath403 to @xmath62 in @xmath64 is _",
    "@xmath888-bad _ if it is used at least @xmath130 times as a @xmath546nd edge in the shadow skeleton walks of @xmath885 . an edge from @xmath63 to @xmath403 in @xmath64 is _ @xmath889-bad _ if it is used at least @xmath130 times as a @xmath382th edge in the shadow skeleton walks of  @xmath885 .    to prove claim  [ skelg ] we will first prove the following result .",
    "[ shadow ] we can find a collection @xmath890 of @xmath872 shadow skeleton walks with respect to @xmath86 , one for each of pair in @xmath870 , such that the following condition holds :    * for each @xmath891 , every edge in @xmath64 is used at most @xmath130 times as a @xmath350th edge of some shadow skeleton walk in @xmath890 . in particular",
    "no edge in @xmath64 is very bad .",
    "suppose that we have already found @xmath892 of our desired shadow skeleton walks for @xmath86 .",
    "let @xmath869 be a pair in @xmath870 for which we have yet to define a shadow skeleton walk .",
    "we will now find such a shadow skeleton walk @xmath876 .",
    "suppose @xmath893 and @xmath894 , where @xmath895 .",
    "let @xmath403 denote the predecessor of @xmath896 in @xmath897 and @xmath63 the successor of @xmath898 in @xmath70 .",
    "we define @xmath899 to consist of all those clusters @xmath900 for which there exists an edge from @xmath403 to @xmath62 in @xmath64 which is not @xmath888-bad . by definition of @xmath86 ( condition  ( ii ) in section  [ sec : incorp ] )",
    ", each @xmath752 has at most @xmath901 inneighbours in @xmath696 in @xmath86 .",
    "so the number of @xmath888-bad edges is at most @xmath902 together with  ( [ rmdeg ] ) this implies that @xmath903 similarly we define @xmath904 to consist of all those clusters @xmath900 for which there exists an edge from @xmath62 to @xmath63 in @xmath64 which is not @xmath905-bad .",
    "again , @xmath906 .",
    "let @xmath907 denote the set of those clusters which are the predecessors in @xmath70 of a cluster in @xmath899 .",
    "similarly let @xmath908 denote the set of those clusters which are the successors in @xmath70 of a cluster in @xmath904 .",
    "so @xmath909 and @xmath910 .",
    "by lemma  [ keevashmult](i ) applied with @xmath911 there exist at least @xmath912 edges in @xmath64 from @xmath907 to @xmath908 . on the other hand ,",
    "the number of bad edges is at most @xmath913 so we can choose an edge @xmath914 from @xmath907 to @xmath908 in @xmath64 which is not bad .",
    "let @xmath587 denote the successor of @xmath131 in @xmath70 and @xmath588 the predecessor of @xmath132 in @xmath70 .",
    "thus @xmath915 and @xmath916 and so there is an edge @xmath917 in @xmath64 which is not @xmath888-bad and an edge @xmath918 which is not @xmath905-bad .",
    "let @xmath876 be the shadow skeleton walk consisting of the edges @xmath867 , @xmath917 , @xmath914 , @xmath918 , and @xmath868 .",
    "then we can add @xmath876 to our collection of @xmath39 skeleton walks that we have found already .",
    "we now use claim  [ shadow ] to prove claim  [ skelg ] .",
    "55*proof of claim  [ skelg ] .",
    "* we apply claim  [ shadow ] to obtain a collection @xmath890 of shadow skeleton walks .",
    "we will replace each edge of @xmath64 in these shadow skeleton walks with a distinct edge of @xmath854 to obtain our desired collection @xmath871 of skeleton walks .    recall that each edge @xmath919 in @xmath64 corresponds to an @xmath920$]-regular pair of density at least @xmath921 in @xmath854 .",
    "thus in @xmath854 the edges from @xmath799 to @xmath922 induce a @xmath923$]-regular pair of density @xmath924 .",
    "( here @xmath925 and @xmath926 are the partitions of @xmath403 and @xmath63 chosen in section  [ randomsplit ] . )",
    "let @xmath927 and note that @xmath928 .",
    "so we can now apply lemma  [ boundmax ] to @xmath929 to obtain a subgraph @xmath930 $ ] with maximum degree at most @xmath931 and at least @xmath932 edges .",
    "we do this for all those edges in @xmath64 which are used in a shadow skeleton walk in @xmath890 .",
    "since no edge in @xmath64 is very bad , for each @xmath933 we can replace an edge @xmath919 in @xmath876 with a distinct edge @xmath65 from @xmath799 to @xmath922 lying in @xmath930 $ ] .",
    "thus we obtain a collection @xmath871 of skeleton walks which satisfy properties ( i ) and ( ii ) of claim  [ skelg ] .",
    "note that by the construction of @xmath871 every vertex @xmath752 is incident to at most @xmath934 edges which play the role of a @xmath546nd , @xmath873rd or @xmath382th edge in a skeleton walk in @xmath871 .",
    "condition  ( ii ) in section  [ sec : incorp ] implies that @xmath104 is incident to at most @xmath935 edges which play the role of a 1st or 5th edge in a skeleton walk in @xmath871 .",
    "so in total @xmath104 is incident to at most @xmath936 edges of the skeleton walks in @xmath871 .",
    "hence ( iii ) and thus the entire claim is satisfied .",
    "we now add the edges of the skeleton walks in @xmath871 to @xmath86 .",
    "moreover , for each @xmath795 we delete all those edges at  @xmath103 which do not lie in a skeleton walk in  @xmath871 .",
    "our aim in this section is to find a suitable collection of 1-factors in each  @xmath86 which together cover almost all the edges of  @xmath86 . in order to do this , we first choose a @xmath832-regular spanning oriented subgraph @xmath937 of @xmath86 and then apply lemma  [ 1factororiented ] to  @xmath937",
    ".    we will refer to all those edges in @xmath86 which lie in a skeleton walk in @xmath871 as _ red _ , and all other edges in @xmath86 as _ white_. given @xmath797 and @xmath938 , we denote by @xmath939 the set of all those vertices which receive a white edge from  @xmath103 in  @xmath86 .",
    "similarly we denote by @xmath940 the set of all those vertices which send out a white edge to @xmath103 in @xmath86 .",
    "so @xmath941 and @xmath942 , where @xmath896 and @xmath852 are the successor and the predecessor of @xmath403 in @xmath70 .",
    "note that @xmath86 has the following properties :    * @xmath943 for each @xmath750 .",
    "moreover , @xmath103 does not have any in- or outneighbours in @xmath696 . *",
    "every path in  @xmath86 consisting of two red edges has its midpoint in  @xmath696 .",
    "* for each @xmath944 the white edges in @xmath86 from @xmath239 to @xmath945 induce a @xmath946-super - regular pair @xmath947 . *",
    "every vertex @xmath948 receives at most @xmath949 red edges and sends out at most @xmath950 red edges in @xmath86 . * in total , the vertices in @xmath86 lying in a cluster @xmath951 send out the same number of red edges as the vertices in @xmath945 receive .    in order to find our @xmath832-regular spanning oriented subgraph of @xmath86 , consider any edge @xmath952 . given any @xmath953 ,",
    "let @xmath954 denote the number of red edges sent out by @xmath955 in @xmath86 .",
    "similarly given any @xmath956 , let @xmath957 denote the number of red edges received by @xmath958 in @xmath86 .",
    "by @xmath959 we have that @xmath960 and by @xmath961 we have that @xmath962 thus we can apply lemma  [ fandk ] to obtain an oriented spanning subgraph of @xmath947 in which each @xmath955 has outdegree @xmath963 and each @xmath958 has indegree @xmath964 .",
    "we apply lemma  [ fandk ] to each @xmath952 .",
    "the union of all these oriented subgraphs together with the red edges in @xmath86 clearly yield a @xmath832-regular oriented subgraph @xmath965 of @xmath86 , as desired .",
    "we will use the following claim to almost decompose @xmath965 into @xmath48-factors with certain useful properties .",
    "[ nice1factors ] let @xmath966 be a spanning @xmath525-regular oriented subgraph of @xmath86 where @xmath967 .",
    "then @xmath966 contains a @xmath48-factor @xmath968 with the following properties :    * @xmath968 contains at most @xmath532 cycles . * for each @xmath951",
    ", @xmath968 contains at most @xmath969 red edges incident to vertices in @xmath239 .",
    "* let @xmath970 denote the set of vertices which are incident to a red edge in @xmath968 . then @xmath971 for each @xmath972 .",
    "* @xmath973 for each @xmath972 .    a direct application of lemma  [ 1factororiented ] to @xmath966 proves the claim .",
    "indeed , we apply the lemma with @xmath974 , @xmath975 , @xmath976 and with the oriented spanning subgraph of @xmath966 whose edge set consists precisely of the red edges in @xmath966 playing the role of @xmath49 .",
    "furthermore , the clusters in @xmath977 together with the sets @xmath978 and @xmath979 ( for each @xmath972 ) play the role of the @xmath980 .    repeatedly applying claim  [ nice1factors ]",
    "we obtain edge - disjoint @xmath48-factors @xmath981 of @xmath86 satisfying conditions ( i)(iv ) of the claim , where @xmath982 our aim is now to transform each of the @xmath90 into a hamilton cycle using the edges of @xmath97 , @xmath98 and @xmath99 .",
    "let @xmath983 denote the cycles in @xmath70 and define @xmath984 to be the set of vertices in @xmath86 which lie in clusters in the cycle @xmath985 .",
    "in this subsection , for each @xmath82 and @xmath350 we will merge the cycles in @xmath90 to obtain a @xmath48-factor @xmath94 consisting of at most @xmath986 cycles .",
    "recall from section  [ nicefactor ] that we call the edges of @xmath86 which lie on a skeleton walk in @xmath871 red and the non - red edges of @xmath86 white .",
    "we call the edges of the ` random ' oriented graph @xmath97 defined in section  [ applydrl ] _",
    "green_. ( recall that @xmath97 was modified in section  [ randomsplit ] . )",
    "we will use the edges from @xmath97 to obtain @xmath48-factors @xmath987 for each @xmath86 with the following properties :    * if @xmath988 or @xmath989 then @xmath94 and @xmath990 are edge - disjoint . * for each @xmath991 all @xmath992 which send out a white edge in @xmath90 lie on the same cycle @xmath55 in @xmath94 . *",
    "@xmath993 for all @xmath82 and @xmath350 .",
    "moreover , @xmath994 consists of green and white edges only .",
    "* for every edge in @xmath90 both endvertices lie on the same cycle in  @xmath94 . *",
    "all the red edges in @xmath90 still lie in @xmath94 .    before showing the existence of @xmath48-factors satisfying ( @xmath740)(@xmath995 ) , we will derive two further properties ( @xmath996 ) and ( @xmath997 ) from them which we will use in the next subsection .",
    "so suppose that @xmath94 is a @xmath48-factor satisfying the above conditions .",
    "consider any cluster @xmath846 .",
    "claim  [ nice1factors](ii ) implies that @xmath90 contains at most @xmath998 red edges with startpoint in @xmath403 .",
    "so the cycle @xmath55 in @xmath94 which contains all vertices @xmath999 sending out a white edge in @xmath90 must contain at least @xmath1000 such vertices @xmath103 .",
    "in particular there are at least @xmath1001 vertices @xmath1002 which lie on @xmath55 .",
    "so some of these vertices @xmath104 send out a white edge in @xmath90 .",
    "but by @xmath1003 this means that @xmath55 contains all those vertices @xmath1002 which send out a white edge in @xmath90 .",
    "repeating this argument shows that @xmath55 contains all vertices in @xmath1004 which send out a white edge in @xmath90 ( here @xmath985 is the cycle on @xmath70 that contains @xmath403 ) .",
    "furthermore , by property @xmath1005 , @xmath55 contains all vertices in @xmath1004 which receive a white edge in @xmath90 . by property  @xmath1006 in section  [ nicefactor ]",
    "no vertex of @xmath72 is both the a startpoint of a red edge in @xmath86 and an endpoint of a red edge in @xmath86 .",
    "so this implies that all vertices in @xmath984 lie on @xmath55 .",
    "thus if we obtain @xmath48-factors @xmath1007 satisfying @xmath1008@xmath1009 then the following conditions also hold :    * for each @xmath1010 and each @xmath1011 all the vertices in @xmath984 lie on the same cycle in @xmath94 . * for each @xmath846 and each @xmath1012 at most @xmath1013 vertices in  @xmath403 lie on a red edge in  @xmath94 .",
    "( condition  @xmath1014 follows from claim  [ nice1factors](ii ) and the ` moreover ' part of  @xmath1015 . )    for every @xmath82 , we will define the 1-factors @xmath987 sequentially .",
    "initially , we let @xmath1016 .",
    "so the @xmath94 satisfy all conditions except @xmath1017 .",
    "next , we describe how to modify @xmath1018 so that it also satisfies @xmath1019 ) .",
    "recall from section  [ randomsplit ] that for each edge @xmath1020 of @xmath70 the pair @xmath1021 is @xmath1022-super - regular and thus @xmath1023 .",
    "furthermore , whenever @xmath797 and @xmath938 , the outneighbourhood of @xmath103 in @xmath97 lies in @xmath896 and the inneighbourhood of @xmath103 in @xmath97 lies in @xmath852 .",
    "let @xmath816 denote the oriented spanning subgraph of @xmath97 whose edge set consists of those edges @xmath105 of @xmath97 for which @xmath103 is not a startpoint of a red edge in our current @xmath48-factor @xmath1018 and @xmath104 is not an endpoint of a red edge in @xmath1018 .",
    "consider a white edge @xmath105 in @xmath1018 .",
    "claim  [ nice1factors](iii ) implies that @xmath103 sends out at most @xmath1024 green edges @xmath1025 in @xmath97 which do not lie in @xmath816 .",
    "so @xmath1026 .",
    "similarly , @xmath1027 .",
    "( however , if @xmath1028 is a red edge in @xmath1018 then @xmath1029 . )",
    "thus we have the following properties of @xmath97 and @xmath816 :    * for each @xmath846 all the edges in  @xmath97 sent out by vertices in  @xmath403 go to  @xmath896 . * if @xmath105 is a white edge in @xmath1018 then @xmath1030 . *",
    "consider any @xmath797 .",
    "let @xmath1031 and @xmath1032 be such that @xmath1033",
    ". then @xmath1034 .    if @xmath1018 does not satisfy ( @xmath1035 ) , then it contains cycles @xmath1036 such that there is a cluster @xmath797 and white edges @xmath105 on  @xmath55 and @xmath1037 on  @xmath1038 with @xmath1039 and @xmath1040 .",
    "we have 3 cases to consider .",
    "firstly , we may have a green edge @xmath1041 such that @xmath1042 lies on a cycle @xmath1043 in @xmath1018 .",
    "then @xmath1044 and @xmath1042 is the endpoint of a white edge in @xmath1018 ( by @xmath1045 and the definition of @xmath816 ) .",
    "secondly , there may be a green edge @xmath1046 such that @xmath1047 lies on a cycle @xmath1048 in @xmath1018 .",
    "so here @xmath1049 is the startpoint of a white edge in @xmath1018 .",
    "if neither of these cases hold , then @xmath1050 lies on @xmath55 and @xmath1051 lies on @xmath1038 . since @xmath1052 by  ( @xmath1053 )",
    ", we can use  ( @xmath1054 ) to find a green edge @xmath1055 from @xmath1051 to @xmath1050 .",
    "then @xmath1056 , @xmath1057 , @xmath1058 is the startpoint of a white edge in @xmath1018 and @xmath1059 is the endpoint of a white edge in @xmath1018 .",
    "we will only consider the first of these 3 cases .",
    "the other cases can be dealt with analogously : in the second case @xmath1047 plays the role of @xmath103 and @xmath1060 plays the role of @xmath1042 . in the third case @xmath1058",
    "plays the role of @xmath103 and @xmath1059 plays the role of @xmath1042 .",
    "so let us assume that the first case holds , i.e.  there is a green edge @xmath1041 such that @xmath1042 lies on a cycle @xmath1043 in @xmath1018 and @xmath1042 lies on a white edge @xmath1061 on @xmath59 .",
    "let @xmath56 denote the directed path @xmath1062 from @xmath1063 to @xmath1064 .",
    "suppose that the endpoint @xmath1047 of @xmath56 lies on a green edge @xmath1065 such that @xmath27 lies outside  @xmath56 .",
    "then @xmath1066 is the endpoint of a white edge @xmath1028 lying on the cycle @xmath1067 in @xmath1018 which contains  @xmath27 .",
    "we extend @xmath56 by replacing @xmath56 and @xmath1067 with @xmath1068 .",
    "we make similar extensions if the startpoint @xmath104 of @xmath56 has an inneighbour in @xmath816 outside @xmath56 .",
    "we repeat this ` extension ' procedure as long as we can .",
    "let @xmath56 denote the path obtained in this way , say @xmath56 joins @xmath1069 to @xmath1070 .",
    "note that @xmath57 must be the endpoint of a white edge in @xmath1018 and @xmath58 the startpoint of a white edge in @xmath1018 .",
    "we will now apply a ` rotation ' procedure to close @xmath56 into a cycle . by ( @xmath1053 ) @xmath57",
    "has at least @xmath1071 inneighbours in @xmath816 and @xmath58 has at least @xmath1071 outneighbours in @xmath816 and all these in- and outneighbours lie on @xmath56 since we could not extend @xmath56 any further .",
    "let @xmath1072 and @xmath1073 .",
    "so @xmath1074 and @xmath1075 and @xmath1076 by  @xmath1045 .",
    "moreover , whenever @xmath1077 and @xmath1078 is the successor of  @xmath1079 on  @xmath56 , then either @xmath1080 was a white edge in @xmath1018 or @xmath1081 .",
    "thus in both cases @xmath1082 .",
    "so the set @xmath587 of successors in  @xmath56 of all the vertices in  @xmath131 lies in  @xmath896 and no vertex in  @xmath131 sends out a red edge in  @xmath56 .",
    "similarly one can show that the set @xmath588 of predecessors in  @xmath56 of all the vertices in  @xmath132 lies in  @xmath403 and no vertex in  @xmath132 receives a red edge in  @xmath56 .",
    "together with  ( @xmath1054 ) this shows that we can apply lemma  [ rotationlemma ] with @xmath1083 playing the role of @xmath1 and @xmath896 playing the role of  @xmath403 and @xmath403 playing the role of @xmath62 to obtain a cycle @xmath1084 containing precisely the vertices of @xmath56 such that @xmath1085 , @xmath1086 and such that @xmath1087 consists of edges from @xmath131 to  @xmath587 and edges from  @xmath588 to  @xmath132 .",
    "thus @xmath1087 contains no red edges .",
    "replacing @xmath56 with @xmath1084 gives us a @xmath48-factor ( which we still call @xmath94 ) with fewer cycles .",
    "also note that if the number of cycles is reduced by @xmath39 , then we use at most @xmath1088 edges in @xmath97 to achieve this .",
    "so @xmath94 still satisfies all requirements with the possible exception of ( @xmath1035 ) .",
    "if it still does not satisfy ( @xmath1035 ) , we will repeatedly apply this ` rotation - extension ' procedure until the current @xmath48-factor @xmath1018 also satisfies ( @xmath1035 ) .",
    "however , we need to be careful since we do not want to use edges of @xmath97 several times in this process . simply deleting the edges we use may not work as ( @xmath1089 ) might fail later on ( when we will repeat the above process for @xmath94 with @xmath1090 ) .",
    "so each time we modify @xmath1018 , we also modify @xmath97 as follows . all the edges from @xmath97 which are used in @xmath1018",
    "are removed from @xmath97 .",
    "all the edges which are removed from @xmath1018 in the rotation - extension procedure are added to @xmath97 .",
    "( note that by  @xmath1091 we never add red edges to @xmath97 . )",
    "when we refer to @xmath97 , we always mean the ` current ' version of @xmath97 , not the original one .",
    "furthermore , at every step we still refer to an edge of @xmath97 as green , even if initially the edge did not lie in @xmath97 . similarly at every step we refer to the non - red edges of our current @xmath48-factor as white , even if initially they belonged to @xmath97 .",
    "note that if we added a green edge @xmath1025 into @xmath1018 , then @xmath103 lost an outneighbour in @xmath97 , namely @xmath1042 .",
    "however , @xmath1009 implies that we also moved some ( white ) edge @xmath105 of @xmath1018 to @xmath97 , where @xmath104 lies in the same cluster @xmath1092 as @xmath1042 ( here @xmath992 ) .",
    "so we still have that @xmath1093 .",
    "similarly , at any stage @xmath1094 .",
    "when @xmath97 is modified , then @xmath816 is modified accordingly . this will occur if we add some white edges to @xmath97 whose start or endpoint lies on a red edge in @xmath1018 .",
    "however , claim  [ nice1factors](iv ) implies that at any stage we still have @xmath1095 also note that by ( @xmath1096 ) , the modified version of @xmath97 still satisfies @xmath1097 so @xmath97 and @xmath816 will satisfy ( @xmath1098)(@xmath1099 ) throughout and thus the above argument still works .",
    "so after at most @xmath532 steps @xmath1018 will also satisfy ( @xmath1035 ) .",
    "suppose that for some @xmath1100 we have found @xmath48-factors @xmath1101 satisfying @xmath1008@xmath1009 .",
    "we can now carry out the rotation - extension procedure for @xmath94 in the same way as for @xmath1018 until @xmath94 also satisfies ( @xmath1035 ) . in the construction of @xmath94",
    ", we do not use the original @xmath97 , but the modified version obtained in the construction of @xmath1102 .",
    "we then introduce the oriented spanning subgraph @xmath816 of @xmath97 similarly as before ( but with respect to the current @xmath48-factor @xmath94 )",
    ". then all the above bounds on these graphs still hold , except that in the middle expression of  ( [ h3i ] ) we multiply the term @xmath1103 by @xmath350 to account for the total number of edges removed from @xmath97 so far . but this does not affect the next inequality . so eventually , all the @xmath94 will satisfy ( @xmath740)(@xmath995 ) .      our final aim is to piece together the cycles in @xmath94 , for each @xmath82 and @xmath350 , to obtain edge - disjoint hamilton cycles of @xmath1 . since we have @xmath1104 @xmath48-factors @xmath1007 for each @xmath86 , in total we will find @xmath1105 edge - disjoint hamilton cycles of @xmath1 , as desired .",
    "recall that @xmath303 was defined in section  [ applydrl ] . given any @xmath82 ,",
    "apply lemma  [ shiftedwalk ] to obtain a closed shifted walk @xmath1106 in @xmath303 with respect to  @xmath70 such that each cycle in @xmath70 is traversed at most @xmath662 times .",
    "so @xmath1107 is the set of all cycles in @xmath70 , @xmath1108 is the successor of @xmath1109 on @xmath1110 and @xmath1111 for each @xmath1112 ( where @xmath1113 ) .",
    "moreover , @xmath1114 for each @xmath48-factor @xmath94 we will now use the edges of @xmath98 and @xmath99 to obtain a hamilton cycle @xmath1115 with the following properties :    * if @xmath1116 or @xmath989 then @xmath1115 and @xmath1117 are edge - disjoint . * @xmath1118 consists of edges from @xmath94 , @xmath98 and @xmath99 only .",
    "* there are at most @xmath1119 edges from @xmath98 lying in @xmath1115 .",
    "* there are at most @xmath1120 edges from @xmath99 lying in @xmath1115 .    for each @xmath350 , we will use @xmath1121 to ` guide ' us how to merge the cycles in @xmath94 into the hamilton cycle @xmath1115 .",
    "suppose that we have already defined @xmath1122 of the hamilton cycles @xmath1117 satisfying ( i)(iv ) , but have yet to define @xmath1115 .",
    "we remove all those edges which have been used in these @xmath39 hamilton cycles from both  @xmath98 and @xmath99 .    for each @xmath797 , we denote by @xmath1123 the subcluster of @xmath403 containing all those vertices which do not lie on a red edge in @xmath94 .",
    "we refer to @xmath1123 as the _ white subcluster of @xmath403_. thus @xmath1124 by property  @xmath1014 in section  [ 4.6 ] .",
    "note that the outneighbours of the vertices in @xmath1123 on @xmath94 all lie in @xmath896 while their inneighbours lie in @xmath852 .",
    "for each @xmath1125 we will denote the white subcluster of a cluster @xmath1109 by @xmath1126 .",
    "we use similar notation for @xmath1108 and @xmath1127 .    consider any @xmath1128 . recall that @xmath62 and @xmath403 are viewed as clusters of size @xmath80 in @xmath303 , but when considering @xmath70 we are in fact considering subclusters of @xmath62 and @xmath403 of size @xmath274 . when viewed as clusters in @xmath303",
    ", @xmath1129 initially corresponded to an @xmath162-regular pair of density at least @xmath1130 in @xmath98 .",
    "thus when viewed as clusters in @xmath70 , @xmath1129 initially corresponded to a @xmath1131-regular pair of density at least @xmath1132 in @xmath98 .",
    "moreover , initially the edges from @xmath1133 to @xmath1123 in @xmath98 induce a @xmath1134-regular pair of density at least @xmath1135 .",
    "however , we have removed all the edges lying in the @xmath39 hamilton cycles @xmath1117 which we have defined already .",
    "property  ( iii ) implies that we have removed at most @xmath1136 edges from @xmath98 .",
    "thus we have the following property :    * given any @xmath1137 , let @xmath1138 , @xmath1139 be such that @xmath1140",
    ". then @xmath1141 .",
    "when constructing @xmath1115 we will remove at most @xmath1119 more edges from @xmath98 .",
    "but since @xmath1142 is far from being tight , it will hold throughout the argument below . similarly , the initial definition of @xmath99 ( c.f .",
    "section  [ randomsplit ] ) and  ( iv ) together imply the following property :    * consider any edge @xmath1143 .",
    "let @xmath1031 and @xmath1032 be such that @xmath1144",
    ". then @xmath1145 .",
    "we now construct @xmath1115 from @xmath94 .",
    "condition  @xmath1146 in section  [ 4.6 ] implies that , for each @xmath1125 , every vertex in @xmath1147 lies on the same cycle , @xmath1148 say , in @xmath94 .",
    "let @xmath1149 be such that @xmath1150 has at least @xmath1151 outneighbours in @xmath98 which lie in @xmath1152 . by  @xmath1142 all but at most @xmath1153 vertices in @xmath1154 have this property .",
    "note that the outneighbour in @xmath94 of any such vertex lies in @xmath1155 .",
    "however , by  @xmath1156 all but at most @xmath1157 vertices in @xmath1155 have at least @xmath1158 inneighbours in @xmath99 which lie in @xmath1154 .",
    "thus we can choose @xmath1150 with the additional property that its outneighbour @xmath1159 in @xmath94 has at least @xmath1160 inneighbours in @xmath99 which lie in  @xmath1154 .",
    "let @xmath56 denote the directed path @xmath1161 from  @xmath1162 to @xmath1150 .",
    "we now have two cases to consider .    * case 1 .",
    "* @xmath1163 .",
    "note that @xmath1150 has at least @xmath1164 outneighbours @xmath1165 in @xmath1166 such that the inneighbour of @xmath1167 in  @xmath94 lies in @xmath1168 .",
    "however , by  @xmath1169 all but at most @xmath1153 vertices in @xmath1168 have at least @xmath1170 outneighbours in @xmath98 which lie in @xmath1171 .",
    "thus we can choose an outneighbour @xmath1165 of @xmath1150 in @xmath98 such that the inneighbour @xmath1172 of @xmath1167 in  @xmath94 lies in @xmath1168 and @xmath1172 has at least @xmath1170 outneighbours in @xmath98 which lie in @xmath1171 .",
    "we extend @xmath56 by replacing it with @xmath1173 .",
    "* case 2 . * @xmath1174 .",
    "in this case the vertices in @xmath1175 already lie on @xmath56 .",
    "we will use the following claim to modify @xmath56 .",
    "[ rotateclaim ] there is a vertex @xmath1176 such that :    * @xmath1177 . *",
    "the predecessor @xmath1178 of @xmath1179 on @xmath56 lies in @xmath1168 .",
    "* there is an edge @xmath1180 in @xmath99 such that @xmath1181 and @xmath1179 precedes @xmath1167 on @xmath56 ( but need not be its immediate predecessor ) . *",
    "the predecessor @xmath1172 of @xmath1167 on @xmath56 lies in @xmath1168 .",
    "* @xmath1172 has at least @xmath1170 outneighbours in @xmath98 which lie in @xmath1171 .",
    "[ ] [ ] @xmath1162 [ ] [ ] @xmath1182 [ ] [ ] @xmath1183 [ ] [ ] @xmath1184 [ ] [ ] @xmath1185 [ ] [ ] @xmath1186   in case  2,title=\"fig : \" ]    since @xmath1187 has at least @xmath1170 outneighbours in @xmath98 which lie in @xmath1188 , at least @xmath1189 of these outneighbours @xmath104 are such that the predecessor @xmath103 of @xmath104 on @xmath56 lies in @xmath1168 and at least @xmath1190 outneighbours of @xmath103 in @xmath98 lie in @xmath1171 .",
    "this follows since all such vertices @xmath104 have their predecessor on @xmath56 lying in @xmath1191 ( since @xmath1192 ) , since @xmath1193 and since by  @xmath1169 all but at most @xmath1153 vertices in @xmath1168 have at least @xmath1190 outneighbours in @xmath1171 .",
    "let @xmath595 denote the set of all such vertices @xmath104 , and let @xmath592 denote the set of all such vertices @xmath103 .",
    "so @xmath1194 , @xmath1195 , @xmath1196 .",
    "let @xmath1197 denote the set of the first @xmath1198 vertices in @xmath592 on @xmath56 and @xmath1199 the set of the last @xmath1200 vertices in @xmath595 on @xmath56 .",
    "then  @xmath1201 implies the existence of an edge @xmath1202 from @xmath1203 to @xmath1204 in  @xmath99 .",
    "then the successor @xmath1179 of @xmath1178 on @xmath56 satisfies the claim .",
    "let @xmath1205 and @xmath1167 be as in claim  [ rotateclaim ] .",
    "we modify @xmath56 by replacing @xmath56 with @xmath1206 ( see figure  2 ) .    in either of the above cases we obtain a path @xmath56 from @xmath1162 to some vertex @xmath1207 which has at least @xmath1170 outneighbours in @xmath98 lying in  @xmath1171 .",
    "we can repeat the above process : if @xmath1208 then we extend @xmath56 as in case  1 .",
    "if @xmath1209 or @xmath1210 then we modify @xmath56 as in case  2 . in both cases",
    "we obtain a new path @xmath56 which starts in @xmath1162 and ends in some @xmath1211 that has at least @xmath1170 outneighbours in @xmath98 lying in @xmath1212",
    ". we can continue this process , for each @xmath1148 in turn , until we obtain a path @xmath56 which contains all the vertices in @xmath1213 ( and thus all the vertices in @xmath1 ) , starts in @xmath1162 and ends in some @xmath1214 having at least @xmath1170 outneighbours in @xmath98 which lie in @xmath1215 .",
    "[ rotateclaim2 ] there is a vertex @xmath1216 such that :    * @xmath1217 . *",
    "the predecessor @xmath1218 of @xmath1219 on @xmath56 lies in @xmath1154 .",
    "* there is an edge @xmath1220 in @xmath99 such that @xmath1221 and @xmath1219 precedes @xmath1222 on @xmath56 . *",
    "the predecessor @xmath1223 of @xmath1222 on @xmath56 lies in @xmath1154 .",
    "* @xmath1223 has at least @xmath1224 outneighbours in @xmath99 which lie in @xmath1215 .",
    "the proof is almost identical to that of claim  [ rotateclaim ] except that we apply @xmath1201 to ensure that @xmath1223 has at least @xmath1224 outneighbours in @xmath99 which lie in @xmath1215 .",
    "let @xmath1225 and @xmath1222 be as in claim  [ rotateclaim2 ] .",
    "we modify @xmath56 by replacing it with the path @xmath1226 from @xmath1162 to @xmath1223 .",
    "so @xmath56 is a hamilton path in  @xmath1 which is edge - disjoint from the @xmath39 hamilton cycles @xmath1117 already defined . in each of the @xmath364 steps in our construction of @xmath56",
    "we have added at most one edge from each of @xmath98 and @xmath99 .",
    "so by  ( [ s ] ) @xmath56 contains at most @xmath1119 edges from @xmath98 and at most @xmath1119 edges from  @xmath99 .",
    "all other edges of @xmath56 lie in @xmath94 .",
    "recall that @xmath1162 has at least @xmath1160 inneighbours in @xmath99 which lie in @xmath1154 and @xmath1223 has at least @xmath1224 outneighbours in @xmath99 which lie in @xmath1215 .",
    "thus we can apply lemma  [ rotationlemma ] to @xmath1227 with @xmath1228 playing the role of @xmath403 and @xmath1229 playing the role of @xmath62 to obtain a hamilton cycle @xmath1115 in @xmath1 where @xmath1230 . by construction , @xmath1115 satisfies ( i)(iv ) .",
    "thus we can indeed find @xmath1231 hamilton cycles in @xmath1 , as desired .",
    "in this section , we describe how theorem  [ main ] can be extended to ` almost regular ' oriented graphs whose minimum semidegree is larger than @xmath21 .",
    "more precisely , we say that an oriented graph @xmath1 on @xmath2 vertices is _",
    "@xmath1232-regular _ if @xmath1233 and @xmath1234 .",
    "[ main38 ] for every @xmath1235 there exist @xmath1236 and @xmath1237 such that the following holds .",
    "suppose that @xmath1 is an @xmath1238-regular oriented graph on @xmath13 vertices where @xmath1239 .",
    "then @xmath1 contains at least @xmath1240 edge - disjoint hamilton cycles .",
    "theorem  [ main38 ] is best possible in the sense that there are almost regular oriented graphs whose semidegrees are all close to @xmath21 but which do not contain a hamilton cycle .",
    "these were first found by hggkvist  @xcite .",
    "however , we believe that if one requires @xmath1 to be completely regular , then one can actually obtain a hamilton decomposition of @xmath1 . note this would be a significant generalization of kelly s conjecture .    for every @xmath1235 there exists @xmath1236 such that for all @xmath1241 and all @xmath1242 each @xmath1243-regular oriented graph on @xmath2 vertices has a decomposition into hamilton cycles .",
    "at present we do not even have any examples to rule out the possibility that one can reduce the constant @xmath1244 in the above conjecture :    is there a constant @xmath1245 such that for every sufficiently large @xmath2 every @xmath1246-regular oriented graph @xmath1 on @xmath2 vertices has a hamilton decomposition or at least a set of edge - disjoint hamilton cycles covering almost all edges of @xmath1 ?",
    "it is clear that we can not take @xmath1247 since there are non - hamiltonian @xmath32-regular oriented graphs on @xmath2 vertices with @xmath1248 ( consider a union of 2 regular tournaments ) .",
    "* sketch proof of theorem  [ main38 ] .",
    "* the proof of theorem  [ main38 ] is similar to that of theorem  [ main ] .",
    "a detailed proof of theorem  [ main38 ] can be found in  @xcite .",
    "the main use of the assumption of high minimum semidegree in our proof of theorem  [ main ] was that for any pair @xmath34 , @xmath130 of large sets of vertices , we could assume the existence of many edges between @xmath34 and @xmath130 ( see lemma  [ keevashmult ] ) .",
    "this enabled us to prove the existence of very short paths , shifted walks and skeleton walks between arbitrary pairs of vertices .",
    "lemma  [ keevashmult ] does not hold under the weaker degree conditions of theorem  [ main38 ] . however , ( e.g.  by lemma  4.1 in  @xcite ) these degree conditions are strong enough to imply the following ` expansion property ' : for any set @xmath853 of vertices , we have that @xmath1249 ( provided @xmath1250 is not too close to @xmath2 ) .",
    "lemma  3.2 in  @xcite implies that this expansion property is also inherited by the reduced graph .",
    "so in the proof of lemma  [ multifactor1 ] , this expansion property can be used to find paths of length @xmath1251 which join up given pairs of vertices .",
    "similarly , in lemma  [ shiftedwalk ] we find closed shifted walks so that each cycle @xmath55 in @xmath531 is traversed @xmath1251 times instead of just @xmath873 times ( such a result is proved explicitly in corollary  4.3 of  @xcite ) .",
    "finally , in the proof of claim  [ shadow ] we now find shadow skeleton walks whose length is @xmath1251 instead of 5 . in each of these cases ,",
    "the increase in length does not affect the remainder of the proof .",
    "we would like to thank demetres christofides for helpful discussions .",
    "10 n.  alon and a.  shapira , testing subgraphs in directed graphs , _ journal of computer and system sciences _",
    "* 69 * ( 2004 ) , 354382 .",
    "b. alspach , j .- c .",
    "bermond and d. sotteau , decompositions into cycles .",
    "i. hamilton decompositions , _ cycles and rays ( montreal , pq , 1987 ) _ , kluwer acad .",
    "publ . , dordrecht , 1990 , 918 .",
    "d. khn and d. osthus , embedding large subgraphs into dense graphs , in _ surveys in combinatorics _ ( s. huczynska , j.d .",
    "mitchell and c.m .",
    "roney - dougal eds . ) , _ london math .",
    "lecture notes _  * 365 * , 137167 , cambridge university press , 2009 .",
    "c.st.j.a .",
    "nash - williams , edge - disjoint hamiltonian circuits in graphs with vertices of large valency , in _ 1971 studies in pure mathematics ( presented to richard rado ) _ , academic press , london , 1971 , 157183 .",
    "a. treglown , _ phd thesis , university of birmingham _ , in preparation .",
    "zhang , every regular tournament has two arc - disjoint hamilton cycles , j.  qufu normal college , special issue oper .",
    "research ( 1980 ) , 7081 ."
  ],
  "abstract_text": [
    "<S> we show that every sufficiently large regular tournament can almost completely be decomposed into edge - disjoint hamilton cycles . </S>",
    "<S> more precisely , for each @xmath0 every regular tournament @xmath1 of sufficiently large order @xmath2 contains at least @xmath3 edge - disjoint hamilton cycles . </S>",
    "<S> this gives an approximate solution to a conjecture of kelly from 1968 . </S>",
    "<S> our result also extends to almost regular tournaments .        </S>",
    "<S> msc2000 : 5c20 , 5c35 , 5c45 . </S>"
  ]
}