{
  "article_text": [
    "the vast majority of materials in nature as well as in engineering applications have underlying microstructures , and often , the length scale of the heterogeneites is much smaller than that of the system to be analyzed . in such cases ,",
    "direct numerical simulations are typically prohibitive , and coarse - graining procedures have been developed to characterize the effective behavior of the material .",
    "a popular computational homogenization approach , that takes advantage of the separation of length scales , is the so - called fe@xmath0 method .",
    "this numerical strategy considers a ( coarse ) finite element discretization for the macroscopic domain , and evaluates the effective behavior of the material at each quadrature point through a representative volume element ( rve ) , where the microstructure is resolved .",
    "this approach is capable of dealing with general geometries , materials , and loading conditions , and takes into consideration the evolution of the microstructure .",
    "it has been successfully applied to a wide range of problems , including composites @xcite , polycrystalline materials @xcite , elastic and plastic porous media @xcite , quasi - brittle separation laws @xcite and wave propagation in metamaterials @xcite .",
    "the coupling and energetic consistency between the two levels of representation in fe@xmath0 methods is based on the seminal papers of hill @xcite and subsequent developments by other authors @xcite . in particular ,",
    "the often called hill s theorems and hill - mandel principle of macrohomogeneity establish , in their original form , that the average strain and stress over the rve are appropriate macroscopic quantities with which to describe the homogenized constitutive behavior , both in the linear and finite kinematic setting @xcite .",
    "these average quantities depend exclusively on the value of the corresponding microscopic object at the boundary of the rve ; and they thus enable the formulation of a boundary value problem ( with either neumann , dirichlet or periodic boundary conditions ) from which the effective behavior may be obtained .    to the best of the author s knowledge ,",
    "the above micro - macro relations and variational reformulations @xcite and extensions to account for surfaces of discontinuities ( @xcite , section 2.4 ) , or body forces or inertial terms @xcite , all rely on the strong form of the equilibrium equation and successive application of the divergence theorem .",
    "however , these averaging relations are commonly used in finite element schemes , where the stress field may fail to be continuous , as is the case , for instance , for piecewise linear shape functions , and the balance equations are only satisfied in a weak sense .",
    "it is therefore , a priori , unclear whether hill s relations hold exactly , or only approximately , in a discrete setting .",
    "this is an important issue for error estimations in multiscale finite element methods .    in this paper ,",
    "the three fundamental averaging statements are shown to hold exactly for standard finite element discretizations :",
    "( i ) the volume - averaged deformation gradient relation ; ( ii ) the volume - averaged stress relation ; and ( iii ) the energy average relation or so - called hill - mandel principle of macrohomogeneity .",
    "the proofs are conducted initially in the static setting with no body forces , and then extended to the more general case where body forces and/or inertial effects are present . in each case , the three classical types of boundary conditions are considered : affine displacement , periodic , and uniform traction boundary conditions .",
    "the statements are derived from the properties of the shape functions and the weak form of the momentum balance equations , and the use of the divergence theorem is limited to continuous fields such as the deformation mapping . in the interest of generality , the proofs are conducted in the finite kinematic setting .",
    "finally , a finite element simulation over a highly irregular rve with a coarse mesh is employed to numerically verify the discrete averaging relations .",
    "simple extension and simple shear deformation modes are considered using displacement , tractions or periodic boundary conditions .",
    "the analyses are based on the lagrangian formulation of continuum mechanics . in this",
    "setting , the deformation of a material point @xmath1 in the reference configuration @xmath2 at time @xmath3 is characterized by the deformation mapping @xmath4 .",
    "this mapping satisfies the momentum balance equations , which under sufficient smoothness , read @xmath5 where @xmath6 is the first piola - kirchhoff stress tensor , @xmath7 and @xmath8 are the prescribed deformation mapping and traction respectively , and @xmath9 is the outward unit normal to the domain in the undeformed configuration . for",
    "static loading , @xmath10 represents the body forces , whereas @xmath11 also includes the inertial forces in the dynamic setting , i.e.  @xmath12 .",
    "furthermore , the deformation gradient will be denoted by @xmath13 , where @xmath14 represents the material gradient . as usual",
    ", it is required that @xmath15 , and @xmath16 . in order to distinguish between the micro- and macro - variables ,",
    "the superscript @xmath17 will be employed for the latter , whereas no superscript will be used for the microscopic quantities .",
    "the macroscopic fields will often result as the average of the corresponding microscopic objects .",
    "this average operation will be written as @xmath18 where @xmath19 denotes the volume associated to @xmath20 and @xmath21 is the volume differential . where needed",
    ", the surface differential will be denoted as @xmath22 .",
    "some derivations in the following sections will make use of standard indicial notation and einstein summation convention .",
    "lower case indices will then be used to refer to the deformed configuration and upper case indices for the reference configuration .",
    "the multiscale finite element method fe@xmath0 solves a boundary value problem for an rve at each quadrature point of the macroscopic scale .",
    "different types of boundary conditions can be imposed at the rve in order to couple the micro- and macro - solution : affine displacement , periodic or traction boundary conditions .",
    "the linear displacement boundary conditions read @xmath23 where the macroscopic displacement field @xmath24 is often obviated in classical static analyses with divergence - free stresses , as a rigid body translation leaves the results unaltered , cf .",
    "@xcite chapter 1 .",
    "however , in the presence of body forces or inertial , it is both , physically and mathematically meaningful to inform the rve of the macroscopic translations , the rotations already being included in the deformation gradient @xcite .",
    "another boundary condition which is frequently employed is uniform traction boundary condition , @xmath25 it is well known that @xcite affine displacement boundary conditions result in stiffer solutions , whereas uniform traction boundary conditions are the most compliant .",
    "an intermediate behavior can be achieved with periodic boundary conditions @xmath26 where @xmath27 stands for the fluctuation field , which is periodic along each pair of parallel sides ( faces in three dimensions ) .",
    "similar to the case with affine boundary conditions , the macroscopic translation is unnecessary for static problems with no body forces .",
    "once a coupling strategy between the micro and macro scale is chosen , the multiscale fe@xmath0 problem , obeying eqs .",
    "- at both scales , is resolved via a finite element discretization , not necessarily of the same type for the micro and macro problem .",
    "here we consider conventional @xmath28 finite element discretizations @xcite for the rve of the form @xmath29 where @xmath30 represents the set of nodes , with associated degrees of freedom @xmath31 , and @xmath32 are the corresponding shape functions , smooth within each element .",
    "these shape functions are required to have local support ( each @xmath32 vanishes over any element not containing the node @xmath33 ) and to have the kronecker delta property , @xmath34 .",
    "furthermore , they shall satisfy the properties of partition of unity and linear field reproduction , i.e. , @xmath35 which allow an exact representation of arbitrary rigid body motions and uniform deformations .",
    "these requirements for the shape functions will be essential for the derivations in sections [ sec : discretetheorems_nob ] and [ sec : discreteresults_b ] .",
    "the weak form of the equilibrium equations associated the finite element discretization can then be readily obtained from the strong form , cf .",
    "eq .  . towards that goal",
    ", it will result convenient to separate the node set @xmath36 into interior nodes ( ody nodes ) @xmath37 and boundary nodes ( at the ontour of the domain ) @xmath38 , cf .",
    "[ fig : setnodes ] , and make use of the fact that the shape functions @xmath39 have a zero value at the boundary of the domain @xmath40 ( by the local support property of the shape functions ) .",
    "then , the weak form of the balance equations reads @xmath41 equation shall be satisfied for any admissible variation of the nodal positions @xmath42 , and , in particular , for the variation of any specific interior node @xmath43 , while setting a null value for the variation of all the other nodes .",
    "equivalently , @xmath44 the variations of the nodes \\{@xmath45 } depend on the boundary conditions used . for affine displacement boundary conditions , cf .",
    "eq .  , @xmath46 = 0 , and therefore no additional equations follow . for periodic boundary conditions , cf .",
    "eq .  , @xmath47 and the equilibrium equations for the boundary nodes read @xmath48 in the absence of inertial and body forces , this equation is equivalent to anti - periodic boundary surface traction . finally , for uniform traction boundary conditions , cf .",
    "eq .  , the weak form of the balance law for the boundary nodes is @xmath49 these equations may be readily simplified for the case with no body forces or inertia ( @xmath50 ) , which is studied first .",
    "the averaging statements for a representative volume element were initially developed for systems with negligible inertial and body forces and consist on the following three statements    * averaging theorem for the deformation gradient : for any @xmath51 compatible ( i.e.  @xmath52 ) and @xmath53 on @xmath40 , with @xmath54 periodic or null , the macroscopic deformation gradient @xmath55 is equal to the average of its microscopic counterpart : @xmath56 . * averaging theorem for the first piola - kirchhoff stress tensor : for any @xmath57 in equilibrium ( i.e.  @xmath58 ) and @xmath59 on @xmath40 , the macroscopic stress tensor @xmath60 is equal to the average of the microscopic analog : @xmath61 .",
    "* hill - mandel principle : for any @xmath51 compatible and any @xmath57 in equilibrium , not necessarily related to each other , and for any of the three standard types of boundary conditions ( affine displacements , periodic or stress boundary conditions ) , the following equality holds : @xmath62 . in view of the previous two relations , this principle establishes the energy rate consistency between the micro and macro scale .    in this section",
    ", we show that these averaging results hold exactly under a finite element discretization .",
    "this implies that only the nodes at the boundary are required to satisfy the displacement boundary conditions , and the equilibrium equations , both , in the body and with the external tractions , are only satisfied weakly , cf .  eqs .  . furthermore , for the hill - mandel principle , the deformation gradient @xmath51 and the stress tensor @xmath57 will not be required to be related to each other , but they shall result from an identical finite element discretization ( same set of nodes and associated shape functions ) .",
    "the proofs are shown below for the three types of boundary conditions .      the first case considered is that of affine displacement boundary conditions of an rve , in accordance with the macroscopic deformation gradient @xmath63 . in that case",
    "the boundary nodes @xmath38 are required to satisfy @xmath64      equation is sufficient to show that the macroscopic deformation gradient tensor is the volume average of its microscopic analogue over the rve . since the displacement field is continuous over the domain and smooth in each element of the finite element discretization , the divergence theorem can be directly applied to @xmath65 over @xmath20",
    ". then , @xmath66 where the sum has been simplified to the boundary nodes , since the shape functions associated to the interior nodes , @xmath39 , have a zero value at @xmath40 .",
    "next , we make use of the displacement boundary conditions on the node set @xmath38 , cf .",
    "eq .  , and , again , use the fact that @xmath39 has a zero value at @xmath40 @xmath67 finally , by the linear representation property of shape functions , cf .",
    "eq .  , and",
    "the application of the divergence theorem , the sought - after result is obtained @xmath68 or equivalently , @xmath69 in analogy with the continuum strain averaging result , the above proof is purely kinematical in nature and it is independent of the microscopic equilibrium equations .",
    "next , we proceed to prove the so - called hill - mandel principle for a compatible rate of deformation gradient @xmath70 , and a stress tensor @xmath57 in equilibrium , i.e.  satisfying eq .   with @xmath71 .",
    "the average microscopic ( virtual ) power can be written as @xmath72 + \\int_{\\omega_0 } p_{ij } \\sum_c \\dot \\varphi_{ci } n_{c , j } \\ , dv,\\ ] ] where the sum over all nodes \\{@xmath33 } has been divided into the sum over the interior nodes \\{@xmath43 } and the boundary nodes \\{@xmath45}. the sum over \\{@xmath43 } vanishes by the weak form of the equilibrium equations , cf .",
    "eq .   with @xmath71 ; and the sum over \\{@xmath45 } can be rewritten , applying the boundary conditions given by eq .  , as @xmath73 \\dot f^{\\text{m}}_{iq}.\\ ] ]",
    "the sum can then be extended to the set of all nodes by the equilibrium equations of the inner nodes , cf .",
    "eq .   with @xmath71 ,",
    "from which it follows that @xmath74 \\dot f^{\\text{m}}_{iq}.\\ ] ] additionally , from the properties of the shape functions , cf .",
    "eq .  , it is readily obtained that @xmath75 and therefore @xmath76\\dot f^{\\text{m}}_{ij}.\\end{aligned}\\ ] ] by making use of the previously derived relation for the deformation gradient , i.e. @xmath77 , we have @xmath78 this completes the proof of hill - mandel principle under a finite element discretization with linear displacement boundary condition .      the dirichlet boundary conditions considered in the previous section may be relaxed , i.e.  softer response , by allowing a periodic fluctuation field @xmath27 . under these considerations ,",
    "the boundary nodes are required to satisfy the following relationship , @xmath79      the proof of the average theorem for the deformation gradient follows in a very similar manner to the case with dirichlet boundary conditions . indeed , by making use of eq .   and the displacement constraints on boundary nodes , cf .",
    "eq .  , it follows that @xmath80 the last term on the right hand side of the equation vanishes as each pair of boundary edges have an identical displacement fluctuation and opposite outward normals .",
    "then , by extending the sum over \\{@xmath45 } to the full set of nodes ( zero value of @xmath39 on @xmath40 ) , making use of the linear field reproduction property of the shape functions , cf",
    ".  eq .  , and the divergence theorem , it follows that @xmath81 thus , the classical averaging statement of the macroscopic deformation tensor is recovered , @xmath82 , and is again independent of microscopic equilibrium equations .",
    "next , we proceed to prove hill s energy consistency relation for a deformation rate @xmath83 compatible and deriving from a periodic mapping @xmath84 , and for a stress tensor @xmath57 satisfying the weak equilibrium equations given by eqs .   and with @xmath71 . similarly to eq .",
    ", the average of the microscopic energy rate obtained from the finite element solution is given by @xmath85 \\dot \\varphi_{ib } + \\int_{\\omega_0 } p_{ij } \\sum_c \\dot \\varphi_{ci } n_{c , j } \\",
    ", dv , \\end{split}\\ ] ] where the set of nodes @xmath30 has been divided into interior nodes @xmath37 and nodes at the contour @xmath38 .",
    "the term associated to the inner nodes vanished by the equilibrium equations .",
    "then , by making use of the periodic boundary conditions , cf",
    ".  eq .  , and the anti - periodicity of @xmath86 , cf .",
    ", one obtains @xmath87 \\dot f^{\\text{m}}_{iq } + \\sum_c \\dot{\\tilde{\\varphi}}_{ci } \\left [ \\int_{\\omega_0 } p_{ij }   n_{c , j }   \\ , dv\\right ] = \\bigg[\\int_{\\omega_0 } p_{ij } \\sum_c x_{cq } n_{c , j}\\ , dv \\bigg ] \\dot f^{\\text{m}}_{iq } .\\end{gathered}\\ ] ] the proof then follows in an identical manner to the case with affine boundary conditions , see derivations after eq .  , leading as well to @xmath88 .",
    "this completes the proof of hill - mandel principle in discrete setting with periodic boundary conditions .",
    "the third and last case considered is that of uniform traction boundary conditions , given by the macroscopic stress tensor @xmath89 , @xmath90      we proceed to show the volume - averaged relation of the stress tensor , under the boundary conditions given by eq .  .",
    "the volume integral of the microscopic stress over the rve domain is @xmath91 where we have used the property of the shape functions given by eq .",
    "and the equilibrium equations for interior nodes @xmath37 , cf .",
    "eq .   with @xmath71 . then , by substituting the weak form of the traction boundary condition , cf .",
    "eq .   with @xmath71 , one obtains @xmath92 we may then extend the sum to all nodes @xmath30 , as the shape functions associated to nodes @xmath37 are zero at @xmath40 .",
    "this results in @xmath93 where we have further used the exact linear representation property of the shape functions , cf .",
    "eq .  , and applied the divergence theorem .",
    "the well - known averaging theorem is then recovered exactly @xmath94 and follows from the equilibrium equations , in this case , in weak form .",
    "finally , we derive the hill - mandel principle for the finite element problem with stress boundary conditions .",
    "similar to the previous section , we make use of the governing equations corresponding to the node sets @xmath37 and @xmath38 , cf .",
    "eqs .   and with @xmath71 , respectively , and",
    "obtain @xmath95 the shape functions associated to nodes @xmath37 are zero at @xmath40 and the last sum of the above equation may thus be extended to the full set of nodes @xmath30 .",
    "it then follows that @xmath96 where the divergence theorem has been applied . by substituting the previously derived relation @xmath97 ,",
    "we obtain the sought - after result @xmath98",
    "in this section , we extend the previous results to account for the presence of body forces or inertial terms , which are both considered in the term @xmath99 . the boundary value problem for the rve with periodic displacement boundary conditions and traction boundary conditions",
    "are considered separately , as well . the case with affine dirichlet boundary conditions",
    "is omitted here , as its derivation is analogous to that of the periodic scenario .      in order to consider the work performed by the inertial and body forces , the boundary conditions on the microscopic domain read , for the parodic case , as @xmath100 where @xmath101 informs the rve of the macroscopic translation .",
    "as mentioned through the narrative , the averaging results for the deformation gradient are purely kinematical in nature and independent of the equilibrium equations .",
    "they thus hold as well in the presence of body forces or inertial terms .",
    "note that the term @xmath102 has an identical treatment to @xmath27 in the derivations and therefore , the proof remains the same as that of section [ sec : perbc_f ] .      a micro - macro relation analogous to the classical hill - mandel principle has been obtained for non - zero value of the body forces or inertia @xcite .",
    "it reads @xmath103 and of course , it reduces to the standard relation , @xmath104 , when the body forces and inertia terms vanish .    in the following ,",
    "we proceed to prove that this relation holds exactly under a finite element discretization .",
    "the left hand side of the equation reads @xmath105   + \\sum_c \\dot \\varphi_{ci } \\left[\\int_{\\omega_0 } \\left(p_{ij } n_{c ,",
    "j}-b_i n_c \\right ) \\ , dv \\right ]   \\\\   & =   \\sum_c \\dot \\varphi_{ci } \\left[\\int_{\\omega_0 } \\left(p_{ij } n_{c , j}- b_i n_c \\right ) \\ , dv \\right ] , \\end{split}\\ ] ] where we have divided the full set of nodes into boundary nodes and interior nodes and have applied the equilibrium equation for the interior nodes , cf .  eq .  . next , we make use of the boundary conditions given by eq .  , and obtain @xmath106\\\\ & \\phantom{=}+   \\sum_c \\dot f^{\\text{m}}_{iq } x_{qc } \\left[\\int_{\\omega_0 } \\left(p_{ij } n_{c , j}- b_i n_c \\right ) \\ , dv \\right ]   \\\\   & \\phantom{=}+ \\sum_c   \\dot { \\tilde{\\varphi}}_{ci } \\left[\\int_{\\omega_0 } \\left(p_{ij } n_{c , j}- b_i n_c \\right ) \\ , dv \\right ] , \\\\ \\end{split}\\ ] ] where the last term on the right hand side vanishes due to the periodicity of @xmath107 and anti - periodicity of the term in brackets , cf .",
    "eq .. then , by using eq .   and extending the remaining sums to the full set of nodes \\{@xmath33 } , one obtains @xmath108",
    "+ \\sum_a \\dot f^{\\text{m}}_{iq } x_{qa } \\left[\\int_{\\omega_0 } \\left(p_{ij } n_{a ,",
    "j}-b_i n_a \\right ) \\ , dv \\right ]   \\\\ & =   \\dot \\varphi^{\\text{m}}_{i } \\bigg[\\int_{\\omega_0 } \\big(p_{ij } \\sum_a n_{a , j}- b_i \\sum_a n_a \\big ) \\ , dv \\bigg]+   \\dot f^{\\text{m}}_{iq }   \\bigg[\\int_{\\omega_0 } \\big(p_{ij } \\sum_a n_{a , j } x_{qa}-b_i \\sum_a n_a x_{qa } \\big ) \\ , dv \\bigg ] .   \\\\",
    "\\end{split}\\ ] ] finally , the use of properties of the shape functions , cf .  eqs .   and , delivers @xmath109 \\dot f^{\\text{m}}_{ij}-   \\left[\\int_{\\omega_0 } b_i   \\ , dv \\right ] \\dot \\varphi^{\\text{m}}_{i}\\ ] ] where we have further used the fact that eq",
    ".   implies @xmath110 .",
    "this above result , together with the already derived expression @xmath111 , completes the desired proof .      when inertial or body forces are considered , a modified averaging statement for the the first piola - kirchhoff stress tensor has been obtained in the smooth case @xcite .",
    "it reads @xmath112 we show below that this equivalence holds exactly under a finite element discretization .      using the properties of the shape functions , cf .",
    "eqs .   and , and the equilibrium equations for interior nodes @xmath37 , cf .",
    "eq .  , the right hand side of eq",
    ".   reads @xmath113 then , by substituting the governing equations of boundary nodes @xmath38 , cf .",
    ", we have @xmath114 the shape functions associated to nodes @xmath37 are zero at @xmath40 and therefore the sum in the last term of the above equation may be extended over all nodes .",
    "then , by the linear representation of the shape functions , cf .",
    "eq .  , and application of the divergence theorem , the sought - after result is obtained @xmath115      in this section , we proceed to derive eq .   for the finite element solution of an rve with uniform traction boundary condition . in this case",
    ", the finite element solution may be non - unique due to the undetermined value of the translations for the static problem , among other possible sources of non - uniqueness . yet , these translations are important in the presence of body forces , as they contribute to the work these forces perform .",
    "it then results convenient to separate the nodal deformation mapping @xmath31 into the macroscopic translation , and the fluctuation around that value .",
    "equivalently , @xmath116 , which satisfies @xmath117 . then , using the weak form of the equilibrium equations associated to nodes @xmath37 , cf .",
    "eq .  , it follows that @xmath118 then , by substituting the governing equations of boundary nodes @xmath38 , cf .",
    ", we obtain @xmath119 the shape functions associated to nodes @xmath37 are zero at @xmath40 , and , therefore @xmath120 finally , application of divergence theorem gives , @xmath121 substituting the previously obtained relation @xmath122 , we obtain the desired relation @xmath123",
    "in this section , the volume - averaged relations are verified numerically over an rve for the three types of boundary conditions considered ( affine , periodic , and traction boundary conditions ) , and two modes of deformation ( simple extension and simple shear ) .",
    "figure [ sche](a ) shows the domain of the rve , which is a unit square composed of three materials : al , cu and ni .",
    "these materials are arranged with no geometric symmetry , providing a general and irregular form of rve .",
    "furthermore , a coarse mesh is intentionally employed to highlight the validity of the results , even when far away from the smooth exact solution . in particular , the microscopic domain is divided into 8 identical linear triangular elements , as shown in figure [ sche](b ) , and linear shape functions are used for the finite element discretization .",
    "simulations are performed using comsol multiphysics software , where hyperelastic constitutive relations ( neo - hookean ) are used for the three materials , whose properties are listed in table [ materials ] .",
    "the details of the simulations are provided below along the text .",
    "[ h ]    l*7cr + & al & cu & ni + density @xmath124 ( kg/@xmath125 ) & 2700 & 8960 & 8900 + lam constant @xmath126 ( gpa ) & 60.49 & 95.15 & 136.4 + lam constant @xmath127 ( gpa ) & 25.93 & 44.78 & 80.15 +    [ 1 ]      we begin by considering the plane - strain extension of the the rve previously described according to the macroscopic deformation gradient @xmath128=[1.2 , 0 ; 0 , 1]$ ] .",
    "computationally , this macroscopic deformation is applied in 20 uniform steps , and at each of these steps , the stress and deformation gradient of each element is computed .",
    "tables [ exlin ] and [ experi ] show the values of each component of @xmath51 and @xmath57 for each element in the final configuration , represented in figures [ exd](a ) and ( b ) , for the affine and the periodic boundary conditions , respectively .",
    "[ h ]    as the results of tables [ exlin](b ) and [ experi](b ) indicate , the average relation @xmath129 is satisfied exactly , up to machine precision , for both affine and periodic boundary conditions .",
    "that is , @xmath130      \\frac{1}{8}\\sum_{e=1}^8 ( f_{21})_e & \\frac{1}{8}\\sum_{e=1}^8 ( f_{22})_e     \\end{bmatrix }      = \\begin{bmatrix }      \\,1.2 &   0\\,\\\\      \\,0 & 1\\ ,    \\end{bmatrix } , \\ ] ] where the sum is performed over the elements of the triangular mesh .",
    "a similar calculation can be carried out at each time step for the deformation gradient and the stress tensor , allowing us to verify the hill - mandel principle .",
    "for the linear displacement boundary conditions , the volumetric average of the strain energy stored during the deformation process is @xmath131 while the energy evaluated from the macroscopic ( averaged ) quantities leads to @xmath132 which has , as expected , an identical value .",
    "similarly , for the periodic boundary condition , the hill - mandel principle is verified exactly , with @xmath133 .",
    "a similar verification analysis is performed for a simple shear mode according to the macroscopic deformation gradient @xmath128=[1 , 0.2 ; 0 , 1]$ ] .",
    "the corresponding deformed meshes of rve are shown in figure for the affine and periodic boundary conditions , respectively , and the components of the stress and deformation gradient tensor for the final configuration are recorded in tables [ shlin ] and [ shperi ] for each element of the mesh . as indicated in the tables , the average deformation gradient coincides for both types of boundary conditions with the imposed macroscopic deformation , verifying the averaging relation @xmath129 .",
    "[ h ]    similarly , hill - mandel principle holds exactly under the finite element discretization . for linear displacement boundary condition , @xmath134 , and for periodic boundary conditions , @xmath135 .",
    "next , we examine the averaging relations when the rve is subjected to uniform traction boundary conditions . in particular , the following examples consider an applied macroscopic traction of @xmath136$]=[1 , 0 ; 0 , 0 ] gpa for a simple extension mode and @xmath137=[@xmath138 , @xmath139 ; @xmath140 , @xmath141=[0 , 1 ; 1 , 0 ] gpa for a simple shear mode .",
    "the loading step size is set to 0.1gpa when the non - zero stress component is smaller than 0.4 gpa , and to 0.01gpa in the following range .",
    "figure [ trac](a ) and ( b ) shows the deformed meshes of rve for both modes of deformation .",
    "[ h ]    the components of the stress tensor and the deformation tensor at the last step of deformation for all the elements have been listed in tables [ extrac ] and [ shtrac ] for simple extension mode and simple shear mode , respectively .",
    "the results indicate that the volume average of the stress tensor is exactly equal to @xmath60 , up to machine precision , verifying the discrete stress averaging result derived in section [ sec : uniformtraction_nob ] .",
    "similarly , the hill - mandel principle is verified numerically . for simple extension mode ,",
    "the micro- and macro - work coincide and are equal to @xmath142 , whereas for the simple shear mode , @xmath143 .",
    "the numerical examples above confirm the validity of the stress and strain averaging relations as well as hill - mandel principle for a finite element discretization regardless of the size of the rve or the mesh size .",
    "the energetic consistency relation , i.e.  @xmath144 , is demonstrated for stresses and strains that belong to the same boundary value problem , as this is often its primary use . yet",
    ", this relation only requires a compatible deformation gradient and a stress tensor in equilibrium that share the same finite element discretization .",
    "however , they are not required to be related to each other , as shown in the analytical derivations .",
    "in summary , the averaging relations needed to establish the consistency between the two levels of description in computational homogenization methods ( fe@xmath0 ) are shown to be exact under standard finite element discretizations .",
    "these are the stress and strain averaging relations as well as hill - mandel principle of energetic consistency .",
    "the proofs are performed in the finite kinematic setting , for generality , and are shown to hold for the three standard type of boundary conditions ( affine displacement , uniform stress and periodic boundary conditions ) for static or dynamic loading . the analytical proofs",
    "are further supported by numerical examples of a highly asymmetric rve with a coarse finite element discretization .",
    "this work provides a solid foundation to the applications of hill s averaging theorems in rve - based multiscale finite element methods with conventional dirichlet , neumann or periodic boundary conditions .",
    "c. reina acknowledges discussions with prof .",
    "michael ortiz .",
    "[ exlin ]    l*7cr + number & @xmath145(pa ) & @xmath146(pa ) & @xmath147(pa ) & @xmath148(pa ) + 1 & 5.540445662129311e10 & -3.697775921110617e9 & -3.697775921110617e9 & 1.872085738015028e10 + 2 & 4.564975169177103e10 & -2.311265268571417e9 & -2.311265268571417e9 & 2.098423482999226e10 + 3 & 3.116295439474504e10 & 7.745539252061372e8 & 7.745539252061372e8 & 1.996623282454363e10 + 4 & 3.694029850600000e10 & 0 & 0 & 1.902985074600000e10 + 5 & 3.694029850600000e10 & 0 & 0 & 1.902985074600000e10 + 6 & 4.271764261725496e10 & -7.745539252061372e8 & -7.745539252061372e8 & 1.809346866745638e10 + 7 & 2.765210896757578e10 & 7.475944449735475e8 & 7.475944449735475e8 & 1.488959713525095e10 + 8 & 2.421352284198325e10 & 1.196070730162412e9 & 1.196070730162412e9 & 1.533834135993035e10 +    l*7cr + number & @xmath149 & @xmath150 & @xmath151 & @xmath152 + 1 & 1.2 & -0.04613415672758626 & 0 & 0.9711642142698373 + 2 & 1.153865843272414 & 0 & -0.028835785730162634 & 1 + 3 & 1.153865843272414 & 0.04613415672758626 & -0.028835785730162634 & 1.028835785730163 + 4 & 1.2 & 0 & 0 & 1 + 5 & 1.2 & 0 & 0 & 1 + 6 & 1.246134156727586 & -0.04613415672758626 & 0.028835785730162634 & 0.9711642142698373 + 7 & 1.246134156727586 & 0 & 0.028835785730162634 & 1 + 8 & 1.2 & 0.04613415672758626 & 0 & 1.028835785730163 + average & 1.200000000000000 & 0 & 0 & 1 +        l*7cr + number & @xmath145(pa ) & @xmath146(pa ) & @xmath147(pa ) & @xmath148(pa ) + 1 & 4.272877655616882e10 & 6.532528423931364e-7 & 6.532528423931364e-7 & 1.517259313986339e10 + 2 & 4.272877655616881e10 & 2.780854427286705e-7 & 2.780854427286705e-7 & 1.517259313986339e10 + 3 & 3.003952559993056e10 & 1.398135338753770e-6 & 1.398135338753770e-6 & 1.806628499750840e10 + 4 & 3.003952559993057e10 & 1.297020385082037e-6 & 1.297020385082037e-6 & 1.806628499750839e10 + 5 & 4.384107141206944e10 & -5.423341730090870e-8 & -5.423341730090870e-8 & 1.999341649449161e10 + 6 & 4.384107141206944e10 & -1.242786967781129e-6 & -1.242786967781129e-6 & 1.999341649449161e10 + 7 & 2.892723074402995e10 & -8.994862469441367e-7 & -8.994862469441367e-7 & 1.709972463684661e10 + 8 & 2.892723074402994e10 & -3.140181817261574e-8 & -3.140181817261574e-8 & 1.709972463684661e10 +      l*7cr + number & @xmath149 & @xmath150 & @xmath151 & @xmath152 + 1 & 1.152799641638063 & 0 & 0 & 0.9809015450978975 + 2 & 1.152799641638063 & 0 & 0 & 0.9809015450978975 + 3 & 1.152799641638063 & 0 & 0 & 1.019098454902103 + 4 & 1.152799641638063 & 0 & 0 & 1.019098454902103 + 5 & 1.247200358361937 & 0 & 0 & 0.9809015450978975 + 6 & 1.247200358361937 & 0 & 0 & 0.9809015450978975 + 7 & 1.247200358361937 & 0 & 0 & 1.019098454902103 + 8 & 1.247200358361937 & 0 & 0 & 1.019098454902103 + average & 1.200000000000000 & 0 & 0 & 1 +        l*7cr + number & @xmath145(pa ) & @xmath146(pa ) & @xmath147(pa ) & @xmath148(pa ) + 1 & -2.130595379666259e9 & 1.477835058908113e10 & 1.477835058908113e10 & -4.634962905504009e9 + 2 & -4.634962905504009e9 & 1.477835058908113e10 & 1.477835058908113e10 & -2.130595379666260e9 + 3 & -1.399028340492011e9 & 8.955223880000000e9 & 8.955223880000000e9 & 1.399028340492011e9 + 4 & 0 & 8.955223880000000e9 & 8.955223880000000e9 & 0 + 5 & 0 & 8.955223880000000e9 & 8.955223880000000e9 & 0 + 6 & 1.399028340492011e9 & 8.955223880000000e9 & 8.955223880000000e9 & -1.399028340492011e9 + 7 & 1.755118475952594e9 & 5.590212526640496e9 & 5.590212526640496e9 & 9.450637946716006e8 + 8 & 9.450637946716006e8 & 5.590212526640497e9 & 5.590212526640497e9 & 1.755118475952594e9 +      l*7cr + number & @xmath149 & @xmath150 & @xmath151 & @xmath152 + 1 & 1 & 0.1843775168634644 & 0 & 0.9843775168634644 + 2 & 0.9843775168634644 & 0.2 & -0.01562248313653562 & 1 + 3 & 0.9843775168634644 & 0.2156224831365357 & -0.01562248313653562 & 1.015622483136536 + 4 & 1 & 0.2 & 0 & 1 + 5 & 1 & 0.2 & 0 & 1 + 6 & 1.015622483136536 & 0.1843775168634644 & 0.01562248313653562 & 0.9843775168634644 + 7 & 1.015622483136536 & 0.2 & 0.01562248313653562 & 1 + 8 & 1 &",
    "0.2156224831365357 & 0 & 1.015622483136536 + average & 1 & 0.2000000000000000 & 0 & 1 +        l*7cr + number & @xmath145(pa ) & @xmath146(pa ) & @xmath147(pa ) & @xmath148(pa ) + 1 & 1.892653704593794e-6 & 7.835820896554924e9 & 7.835820896554924e9 & 4.117337246423158e-6 + 2 & 7.064054015297273e-7 & 7.835820896554925e9 & 7.835820896554925e9 & 1.536736099019807e-6 + 3 & -6.602305766684191e-7 & 8.955223880000004e9 & 8.955223880000004e9 & -1.281624060558984e-6 + 4 & 4.633653368252543e-6 & 8.955223880000004e9 & 8.955223880000004e9 & 1.684227316024411e-6 + 5 & 4.928428739833904e-7 & 8.955223880000000e9 & 8.955223880000000e9 & 9.566949906492653e-7 + 6 & 3.883709277785474e-8 & 8.955223880000000e9 & 8.955223880000000e9 & 1.903017544449548e-6 + 7 & -1.092893533105891e-6 & 7.835820896554928e9 & 7.835820896554928e9 & -1.001675136507230e-6 + 8 & -3.537979237633326e-6 & 7.835820896554928e9 & 7.835820896554928e9 & -2.458595741300362e-6 +      l*7cr + number & @xmath149 & @xmath150 & @xmath151 & @xmath152 + 1 & 1 & 0.1488805970187594 & -0.05111940298124053 & 1 + 2 & 1 & 0.1488805970187594 & -0.05111940298124052 & 1 + 3 & 1 & 0.2511194029812406 & -0.05111940298124052 & 1 + 4 & 1 & 0.2511194029812406 & -0.05111940298124052 & 1 + 5 & 1 & 0.1488805970187594 & 0.05111940298124053 & 1 + 6 & 1 & 0.1488805970187594 & 0.05111940298124052 & 1 + 7 & 1 & 0.2511194029812406 & 0.05111940298124052 & 1 + 8 & 1 & 0.2511194029812406 & 0.05111940298124052 & 1 + average & 1 & 0.2000000000000000 & 0 & 1 +        l*7cr + number & @xmath145(gpa ) & @xmath146(gpa ) & @xmath147(gpa ) & @xmath148(gpa ) + 1 & 1.039825026165646 & 0.04820528954458368 & 0.04866128855931545 & -0.2416297163702212 + 2 & 1.320203739079774 & -0.03982502616563410 & -0.03874395172276655 & -0.04866128855930084 + 3 & 0.6802710990595731 & 0.02932516104756559 & 0.02946016137955194 & -0.1912627316990225 + 4 & 0.9597001356950392 & -0.04029986430498470 & -0.03937749821610080 & -0.03937749821606967 + 5 & 1.034848686668402 & 0.03484868666840837 & 0.03433176606052552 & 0.03433176606052036 + 6 & 1.300707598404531 & -0.04322895004735811 & -0.04357035273468100 & 0.2559592388690298 + 7 & 0.7026611918618899 & 0.03821747693482153 & 0.03716704160995366 & 0.02792845493580790 + 8 & 0.9617825230651917 & -0.02724277367740260 & -0.02792845493579822 & 0.2027117749793306 + average & 1.000000000000006 & -0.00000000000000004 & 0.000000000000000001 & 0.0000000000000093 +      l*7cr + number & @xmath149 & @xmath150 & @xmath151 & @xmath152 + 1 & 1.004937304707261 & -2.689342182920912e-4 & 8.747038856957929e-4 & 0.9969235353724314 + 2 & 1.005765870068560 & -1.097499579591548e-3 & 6.054301474451633e-4 & 0.9971928091106821 + 3 & 1.005765870068560 & 5.280152905005938e-5 & 6.054301474451633e-4 & 0.9960071216113445 + 4 & 1.007269717597589 & -1.451045999979014e-3 & 5.567276539679379e-4 & 0.9960558241048217 + 5 & 1.007549975212814 & 8.729795948439010e-4 & -9.583423724183159e-5 & 0.9963105708813713 + 6 & 1.008691889025950 & -2.689342182920912e-4 & -7.087987283018901e-4 & 0.9969235353724314 + 7 & 1.008691889025950 & 2.172935797205065e-3 & -7.087987283018901e-4 & 0.9955870601989383 + 8 & 1.010812023294105 & 5.280152905005938e-5 & -1.128860140708145e-3 & 0.9960071216113445 +        l*7cr + number & @xmath145(gpa ) & @xmath146(gpa ) & @xmath147(gpa ) & @xmath148(gpa ) + 1 & 0.04560639290814648 & 0.9543878256031890 & 0.9543936070918476 & -0.015047074289714631 + 2 & -0.01504707428965104 & 0.9543936070918378 & 0.9543878256031800 & 0.045606392908200080 + 3 & -0.06074680125388290 & 1.060613153272475 & 1.061397992038798 & -0.068434256720068380 + 4 & 0.03018748263543562 & 1.030187482635433 & 1.029820575266174 & 0.029820575266171635 + 5 & 0.02982057526613236 & 1.029820575266177 & 1.030187482635437 & 0.030187482635397278 + 6 & -0.06843425672007669 & 1.061397992038797 & 1.060613153272471 & -0.060746801253881974 + 7 & -6.77692342451637e-3 & 0.9546093951216100 & 0.9545899689704889 & 0.045390604878376570 + 8 & 0.04539060487842260 & 0.9545899689704804 & 0.9546093951216026 & -6.7769234244772734e-3 + average & 0.0000000000000013 & 1.000000000000000 & 1.000000000000000 & 0.0000000000000004 +      l*7cr + number & @xmath149 & @xmath150 & @xmath151 & @xmath152 + 1 & 1.000242207581661 & 5.764948592700328e-3 & 6.143346763082536e-3 & 0.9998638094113029 + 2 & 0.9998638094113029 & 6.143346763057936e-3 & 5.764948592724816e-3 & 1.000242207581661 + 3 & 0.9998638094113029 & 0.01791376094498578 & 5.764948592724816e-3 & 0.9997780280404228 + 4 & 1.000156756804026 & 0.01762081355226269 & 5.390318334383442e-3 & 1.000152658298764 + 5 & 1.000152658298764 & 5.390318334358900e-3 & 0.01762081355228730 & 1.000156756804026 + 6 & 0.9997780280404227 & 5.764948592700328e-3 & 0.01791376094501020 & 0.9998638094113029 + 7 & 0.9997780280404227 & 0.01892022363786956 & 0.01791376094501020 & 1.000784490733306 + 8 & 1.000784490733307 & 0.01791376094498578 & 0.01892022363789369 & 0.9997780280404228 +        blanco , p.  j. , snchez , p.  j. , de  souza  neto , e.  a. , feijo , r.  a. , 2014 .",
    "variational foundations and generalized unified theory of rve - based multiscale models .",
    "archives of computational methods in engineering , 163 .",
    "feyel , f. , chaboche , j .- l . , 2000 .",
    "fe 2 multiscale approach for modelling the elastoviscoplastic behaviour of long fibre sic / ti composite materials . computer methods in applied mechanics and engineering 183  ( 3 ) , 309330 .",
    "miehe , c. , schotte , j. , lambrecht , m. , 2002 .",
    "homogenization of inelastic solid materials at finite strains based on incremental minimization principles .",
    "application to the texture analysis of polycrystals .",
    "journal of the mechanics and physics of solids 50  ( 10 ) , 21232167 .",
    "miehe , c. , schrder , j. , schotte , j. , 1999 .",
    "computational homogenization analysis in finite plasticity simulation of texture development in polycrystalline materials .",
    "computer methods in applied mechanics and engineering 171  ( 3 ) , 387418 .",
    "nguyen , v.  p. , lloberas - valls , o. , stroeven , m. , sluys , l.  j. , 2011 .",
    "homogenization - based multiscale crack modelling : from micro - diffusive damage to macro - cracks .",
    "computer methods in applied mechanics and engineering 200  ( 9 ) , 12201236 .",
    "peri , d. , de  souza  neto , e. , feijo , r. , partovi , m. , molina , a. , 2011 . on micro - to - macro transitions for multi - scale analysis of non - linear heterogeneous materials : unified variational basis and finite element implementation .",
    "international journal for numerical methods in engineering 87  ( 1 - 5 ) , 149170 .",
    "pham , k. , kouznetsova , v. , geers , m. , 2013 .",
    "transient computational homogenization for heterogeneous materials under dynamic excitation .",
    "journal of the mechanics and physics of solids 61  ( 11 ) , 21252146 .",
    "reina , c. , li , b. , weinberg , k. , ortiz , m. , 2013 .",
    "a micromechanical model of distributed damage due to void growth in general materials and under general deformation histories .",
    "international journal for numerical methods in engineering 93  ( 6 ) , 575611 .",
    "smit , r. , brekelmans , w. , meijer , h. , 1998 .",
    "prediction of the mechanical behavior of nonlinear heterogeneous systems by multi - level finite element modeling .",
    "computer methods in applied mechanics and engineering 155  ( 1 ) , 181192 .",
    "terada , k. , hori , m. , kyoya , t. , kikuchi , n. , 2000 .",
    "simulation of the multi - scale convergence in computational homogenization approaches .",
    "international journal of solids and structures 37  ( 16 ) , 22852311 ."
  ],
  "abstract_text": [
    "<S> the well - known hill s averaging theorems for stresses and strains as well as the so - called hill - mandel principle of macrohomogeneity are essential ingredients for the coupling and the consistency between the micro and macro scales in multiscale finite element procedures ( fe@xmath0 ) . </S>",
    "<S> we show in this paper that these averaging relations hold exactly under standard finite element discretizations , even if the stress field is discontinuous across elements and the standard proofs based on the divergence theorem are no longer suitable . </S>",
    "<S> the discrete averaging results are derived for the three classical types of boundary conditions ( affine displacement , periodic and uniform traction boundary conditions ) using the properties of the shape functions and the weak form of the microscopic equilibrium equations . the analytical proofs </S>",
    "<S> are further verified numerically through a simple finite element simulation of an irregular representative volume element undergoing large deformations . </S>",
    "<S> furthermore , the proofs are extended to include the effects of body forces and inertia , and the results are consistent with those in the smooth continuum setting . </S>",
    "<S> this work provides a solid foundation to apply hill s averaging relations in multiscale finite element methods without introducing an additional error in the scale transition due to the discretization . </S>"
  ]
}