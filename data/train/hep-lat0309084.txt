{
  "article_text": [
    "computations with two flavours of dynamical staggered quarks are quite popular at present .",
    "there are a number of possible problems with such calculations such as flavour symmetry breaking and non - locality of the square - root of the four - flavour action . in this investigation",
    "we shall ignore these and consider only the possible errors introduced through algorithmic approximations .",
    "we propose the use of the rational hybrid monte carlo ( rhmc ) algorithm @xcite .",
    "this method is stochastically exact , in the sense that it is free from molecular dynamics ( md ) stepsize errors .",
    "it is comparable to the usual @xmath0 algorithm @xcite in performance , but without the need for extrapolation in the md stepsize  @xmath1 .",
    "all hybrid molecular dynamics ( hmd ) algorithms have the same underlying structure : a fictitious momentum field is introduced , and the gauge field is integrated along classical trajectories in fictitious time , interleaved with refreshment of the momenta from a gaussian heatbath . when integrating hamilton s equations the evaluation of the fermionic contribution to the force acting on the gauge fields is the costliest part of generating full qcd gauge field configurations .",
    "most algorithmic developments are techniques to calculate the fermionic force more efficiently .",
    "the desired probability distribution for the gauge fields @xmath2 with @xmath3 flavours of staggered fermions is @xmath4^{\\nf/4 } , \\label{eq : pu}\\ ] ] where @xmath5 is the staggered fermion kernel and @xmath6 is the gauge action .",
    "thus for @xmath7 flavours of fermion we require the square root of the fermion determinant .",
    "choosing a suitable normalisation the spectrum of the staggered fermion kernel @xmath5 is contained in the interval @xmath8 $ ] , where @xmath9 .",
    "the identity @xmath10 allows us to express the determinant as a term in the action , and the number of flavours just appears as a factor in front of this term , @xmath11 . in the @xmath0 algorithm @xcite the evaluation of the force corresponding to this trace",
    "is performed stochastically , as computing it exactly would be prohibitively expensive . to do this without introducing @xmath12 errors we introduce an auxilliary field that is evaluated at time @xmath13 along each integration step . for two flavours",
    "this breaks time - reversal invariance , violates liouville s theorem , and leads to an irreversible and non area - preserving algorithm : as such , it can not be made exact by the inclusion of a metropolis step .",
    "a detailed analysis of the errors in the probability distribution produced by this algorithm was presented in  @xcite .",
    "rhmd @xcite uses a uses a rational approximation to fractional powers @xmath14 of a matrix .",
    "this is analogous to the use of polynomial approximations introduced in @xcite , but optimal ( chebyshev ) rational approximations give a much closer approximation over a given interval than the corresponding polynomials of similar degree ( fig .",
    "[ fig : rat - error ] ) . the best choice for this rational approximation would seem to be given by a relative minimax approximation : this has the property that it is guaranteed to deviate by at most an amount @xmath15 relative to the correct value over a given interval , @xmath16 .",
    "the errors are of the same kind as those introduced by the use of floating - point arithmetic .",
    "the maximum error @xmath15 falls exponentially with the degree of the rational approximation used .",
    "= 0.5    -6ex    we approximate the determinant in  ( [ eq : pu ] ) as a gaussian integral over a bosonic ( pseudofermion ) field @xmath17 , @xmath18 where @xmath19 in the spectral norm .",
    "the rhmd algorithm proceeds as follows    * a momentum refreshment heatbath using gaussian noise : @xmath20 . * a pseudofermion heatbath using gaussian noise : @xmath21^{-1 } \\xi$ ] , where @xmath22 . note that the inverse @xmath23 is itself a rational function .",
    "* an md trajectory consisting of @xmath24 steps with hamiltonian @xmath25 with @xmath26 in the spectral norm .",
    "this leads to an algorithm which has finite stepsize errors of @xmath27 and errors of @xmath28 and @xmath29 incurred from the use of rational approximations .",
    "rational functions can be expressed as a product or as a partial fraction expansion , @xmath30    in partial fraction form @xcite the pseudofermionic force takes the form @xmath31 where @xmath32 .",
    "a multishift solver @xcite can be used to compute all the @xmath33 in a common krylov space .",
    "the computational cost of generating the appropriate krylov space depends upon the smallest shift , and the only extra cost is that of updating the extra @xmath34 solution vectors .",
    "the rhmc algorithm is similar to rhmd but with the addition of a metropolis accept / reject step . the acceptance probability for this is given by @xmath35 where @xmath36 .",
    "if we use a high enough degree rational approximation @xmath37 such that @xmath38 ( unit of least precision for the floating point arithmetic used ) in the computation of the pseudofermion heatbath and of @xmath39 we can ignore the explicit determinants in ( [ eq : probrat ] ) without introducing any systematic errors beyond the ever - present rounding errors . in practice",
    "we find that it is sufficiently cheap to use the same ( machine accuracy ) rational approximation for the md integration as well ( @xmath40 ) , although this is not logically required .",
    "rhmcn @xcite allows the use of a lower degree rational approximation @xmath37 while keeping the algorithm exact .",
    "the algorithm replaces the metropolis step with a kennedy - kuti ( kk ) @xcite noisy accept / reject step .",
    "a stochastic summation is used to estimate the determinant ratio in  ( [ eq : probrat ] ) .",
    "the acceptance probability is defined as @xmath41 for @xmath42 and @xmath43 respectively , where @xmath44 is an unbiased ( noisy ) estimator of the determinant ratio occurring in  ( [ eq : probrat ] ) and @xmath45 are parameters used to ensure the resultant probability distribution lies in the range @xmath46 $ ] . when @xmath47 the average acceptance rate is @xmath48 .",
    "the use of multishift solvers in the implementation of the rational algorithms results in a lower computational cost than might otherwise be expected . on a @xmath49 lattice with @xmath50 , @xmath51 , and @xmath52 the time to perform one trajectory of length @xmath53 on a single node pentium  4 processor with no assembler optimisations is 274 minutes for the @xmath0 algorithm .",
    "rhmc takes 318 minutes when a degree  10 rational function is used .",
    "although a single @xmath0 trajectory is faster , rhmc compares very favourably when it is remembered that an @xmath27 extrapolation ought to be carried out when using the inexact @xmath0 algorithm .",
    "the computational cost of using rhmcn is unfavourable compared with rhmc .",
    "although a lower degree rational approximation can be used this does not give a large benefit because of the efficacy of the multishift solver . to ensure negligible probability violations occur when",
    "@xmath54 the kk acceptance test becomes increasingly expensive for large volumes and small quark masses .",
    "the cost of performing a single trajectory using the parameters given above with a degree 6 rational approximation and typical stochastic summation parameters is 385 minutes .",
    "we found that setting @xmath55 to give @xmath56 gives as large an acceptance rate as feasible without incurring excessive violations , but for large @xmath57 and small @xmath58 it was found necessary to reduce this to about @xmath59 .",
    "we have found that it is easy and cheap to compute rational powers of the staggered fermion kernel to within machine accuracy using chebyshev rational approximations expressed as partial fractions , and applied using a multishift solver .",
    "this form of the rhmc algorithm thus enables the exact hmc algorithm to be extended to the case of an arbitrary number of flavours .",
    "the ability to use krylov space solvers makes rhmc faster than the phmc algorithm  @xcite . in terms of computational cost",
    "there is very little to chose between the @xmath0 and rhmc algorithms .",
    "since this seems to be the only possible advantage of @xmath0 over rhmc , we conclude that there is no reason for the continued use of the @xmath0 algorithm .",
    "we would like to thank robert edwards , ivan horvth , blint jo , and stefan sint for discussions ."
  ],
  "abstract_text": [
    "<S> we describe an implementation of the rational hybrid monte carlo ( rhmc ) algorithm for dynamical computations with two flavours of staggered quarks . </S>",
    "<S> we discuss several variants of the method , the performance and possible sources of error for each of them , and we compare the performance and results to the inexact @xmath0 algorithm . </S>"
  ]
}