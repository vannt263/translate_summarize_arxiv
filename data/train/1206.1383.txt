{
  "article_text": [
    "gravitational lensing is the physical phenomenon where gravitational fields perturb the trajectory of light rays and therefore distort observed images @xcite . in particular , the study of weak gravitational lensing involves measuring the statistical properties of an ensemble of distorted galaxy images ( see * ? ? ?",
    "weak gravitational lensing is , in principle , one of the most powerful probes of dark matter and dark energy . by measuring , at different redshifts , the statistical distortion of background galaxies due to large scale cosmic structures  the `` cosmic shear ''  it is possible to place extremely tight constraints on the nature of dark energy @xcite .",
    "however , in future wide - field weak lensing surveys such as those planned with the dark energy survey , lsst @xcite , and euclid , extremely large datasets will greatly reduce the statistical errors , making these experiments systematics - limited .",
    "a major source of systematic error in weak lensing comes from our incomplete knowledge of the psf . to account for the effect of the psf on observed galaxy images ,",
    "we need a model for it at every galaxy position ; these models can be constrained by images of stars , which provide noisy estimates of the psf shape that are more sparsely distributed than the galaxies .",
    "this is the `` psf interpolation problem '' . in an earlier paper ( * ? ? ?",
    "* hereafter c12 ) , we quantified the spatial variation in the psf shapes for a typical lsst 15-second exposure due to various physical effects , such as optics misalignments and atmospheric turbulence .",
    "we found that , although most of the psf anisotropy due to instrumental effects varies smoothly over the field of view , the atmospheric turbulence can generate psf spatial variation on a wide range of scales in these short exposures , with patterns that do not repeat over time .",
    "this poses a new psf interpolation challenge quite different from that faced by previous studies , which relied on images with longer exposure times and/or contained large instrumental effects that dominate the errors .",
    "these atmospheric features have been observed in short exposure ( @xmath3 seconds ) images by , for example , @xcite and ( * ? ? ?",
    "* hereafter h12 ) ;    in weak lensing analyses to date , the scheme used most often to interpolate the psf between sparsely sampled stars has been to fit a low order two - dimensional spatial polynomial function to the stars shape parameters .",
    "however , for future synoptic wide - field surveys , such as lsst , where high cadence imaging is required , short exposures are inevitable .",
    "it is therefore important to re - examine the traditional psf interpolation techniques , and develop new interpolation algorithms that are better suited for these data .",
    "a deliberate effort is being made to study in detail the psf patterns for lsst by carrying out end - to - end , photon - by - photon image simulations using the lsst photon simulator (; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "the ray - tracing procedure includes models for the instrument response , telescope optics , and , most importantly for our purposes , the atmosphere . for a full description of the atmospheric model and quantitative comparison of the model against real data ,",
    "we refer the reader to ( * ? ? ?",
    "* hereafter p12 ) . in this work ,",
    "our focus is on studying the psf interpolation problem , for which we require simulated data containing _ realistic atmospheric psfs , with a range of strengths and spatial scales_. the images meet these criteria , as we demonstrated in p12 by comparing the relevant psf characteristics in our simulated images with those seen by h12 in short exposure images taken by the megacam wide - field camera ( 1 degree@xmath4 ) on the canada - france - hawaii telescope ( cfht ) . in this work",
    "we therefore test our new algorithm on simulated images , for which we know the underlying psf spatial variation .    working with simulated images",
    "is vital for this particular task , since existing data that are suitable for our tests are very limited  our tests require wide - field , short - exposure images with high stellar densities , and taken under a wide range of atmospheric conditions .",
    "simulations , with sufficiently high fidelity , allow us to test the absolute , as well as relative , accuracy of our algorithm in a more controlled fashion and with higher statistics .",
    "our approach can be seen as the next step beyond that taken by @xcite , who re - sampled psf patterns observed in subaru images . here , we use to generate large numbers of predicted lsst images with the relevant exposure time , 15 seconds  effectively amplifying the data taken with cfht for a more rigorous testing .",
    "the primary aim of this paper is to introduce a new psf interpolation technique , and test it under controlled conditions . in both real and simulated psf patterns",
    "we observe structure due to the atmosphere on many different angular scales : this motivates us to model the underlying anisotropy maps using a range of different - sized smoothing kernels .",
    "we infer the pixel values of these underlying maps from the noisy , sparsely sampled stellar shape data given a non - committal entropic prior .",
    "we quantitatively compare this new maximum entropy method with two other methods that represent the current standards , and investigate the performance of all three using high - fidelity simulations over a range of observing conditions .",
    "the structure of this paper is as follows . in",
    ", we review briefly the relevant weak lensing theory and the psf interpolation problem for weak lensing .",
    "we then describe , in , our new psf interpolation method and give arguments for why it is well - suited for the particular problem at hand . in",
    "we use simulated images to quantify the performance of our new method against two strawman psf interpolation techniques .",
    "we also define the metrics that we use to quantify the performance of a given interpolation method .",
    "the results of this programme are presented in .",
    "we then discuss their implications in terms of the systematic errors in cosmic shear measurement for future weak lensing surveys and make suggestions for further improvements on in .",
    "we conclude in .",
    "in the weak lensing regime , the effect of gravitational lensing is to add a small offset to the intrinsic ellipticity of each galaxy , where ellipticity is typically defined as a two - component complex `` spinor '' , @xmath5 .",
    "the resulting observed ellipticity is a noisy but unbiased estimator of the applied shear .",
    "we then constructs certain statistics from these shear estimators to infer cosmology .",
    "one of the most popular statistics is the two - point ellipticity correlation function @xmath6 for the ensemble of galaxies : @xmath7 where the angle brackets indicate an average over galaxy pairs separated by @xmath8 ( with one galaxy located at @xmath9 ) and the subscripts @xmath10 and @xmath11 indicate an isotropised decomposition of @xmath12 along the line connecting a certain pair of galaxies .",
    "the shear correlation functions predicted from cosmology , compared with these observed galaxy ellipticity correlation functions , provide a route by which the cosmological parameters can be inferred .",
    "the major challenge in a ground - based weak lensing analysis is to account for the instrumental and atmospheric psf contribution to the observed galaxy shapes , such that these effects do not systematically contaminate the shear signal one wishes to measure .",
    "this involves `` deconvolving '' ( approximately ) the psf from the galaxy images , where the psf at each galaxy s location is `` interpolated '' from the shapes of nearby stars .",
    "however , to date , the psf interpolation problem has been taken to be of secondary importance , since the psf ellipticity patterns in existing images appear to be largely instrumental in origin , somewhat repeatable , and well - modelled by smoothly - varying functions such as low - order polynomials . however , as we showed in p12 and c12 , this may not be the case for future instruments such as lsst , which are specifically designed for weak lensing and have extremely tight requirements on the instrument - induced psf anisotropy . in these circumstances ,",
    "the atmospheric effects , which used to be subdominant to instrumental effects , now become one of the key components in determining the psf shape and the psf spatial variation .",
    "this implies that the psf shapes may no longer be smoothly varying across the field and modelling the psf variation with such assumptions may be problematic .",
    "in addition , since the atmospheric effects are more pronounced in short exposures , datasets such as lsst , which are composed of sets of multi - epoch short exposure images instead of one long exposure , may suffer more from the atmospheric effects in single exposures when constructing the psf model from interpolation .    to illustrate this psf interpolation challenge , we show in two single - component ( @xmath13 ) , model - subtracted stellar ellipticity maps from 74-second exposure images taken with the cfht megacam on a dense stellar field ( @xmath14 stars per arcmin@xmath4 ) .",
    "the two images used to construct were taken on the same patch of sky but in two different nights , which appear to have very different atmospheric conditions .",
    "the data in are taken from two of the catalogues used in h12 , so we refer to their paper for further details of the dataset .",
    "note that a 2nd - order polynomial was subtracted from the raw ellipticity measurements ( as explained in h12 )  this accounts for most of the instrumental psf contribution , but may also have removed some large scale atmospheric features .",
    "these images demonstrate that psf spatial patters contain the characteristic high frequency structures from the atmosphere , which is the main motivation for our new psf interpolation method .",
    "as seen in , the atmospheric psf anisotropy patterns can contain structure on a range of angular scales , with both patchy and striped features .",
    "this motivates us to look for flexible functions with which to model this spatial variability , which we can then fit to the sparsely sampled stellar psf shape data in any given situation .      casting the psf interpolation problem as an image restoration problem in this way allows us to properly take into account the observational errors on the measured star shapes , and propagate those errors into uncertainties on the interpolant .",
    "an iterative likelihood fit is performed : at each step , the two ellipticity components of each stellar image are predicted from the model underlying ellipticity fields and compared to the measured stellar ellipticities .    both the predicted and observed data are inputs to the likelihood function . under the assumption of uncorrelated gaussian stellar shape uncertainties  @xmath15 , this can be written for the first ellipticity component as the following probability distribution ( pdf ) for the data : @xmath16 ^ 2        \\right ) } ,    \\label{eq : lhood }     \\end{aligned}\\ ] ] and likewise for @xmath17 .    in , @xmath18 is a parameter vector that represents the model .",
    "it is the components of this parameter vector ( and its companion @xmath19 for @xmath17 ) that we vary to fit the stellar shape data .",
    "we choose to parameterise the flexible interpolation functions @xmath20 and @xmath21 with pixelated grids on the sky .",
    "we compute the predicted ellipticity at the @xmath22th star position , @xmath23 , by linear interpolation between the neighbouring pixels : we choose the pixel scale of each grid on our maps such that each pixel contains approximately 1 target point , on average , such that the linear interpolation choice does not affect the final prediction .",
    "for our test data , we fix the model map sizes at @xmath24 pixels for each ellipticity component .",
    "such free - form discretised functions like @xmath18 and @xmath19 have as many parameters to be inferred as there are pixels in the grids .",
    "however , we would like to impose some smoothness on these maps , such that structure on a range of angular scales can be predicted .",
    "we do this by constructing each map from a weighted sum of seven `` hidden '' maps , each convolved with a gaussian `` intrinsic correlation function '' ( icf ) of a different angular scale : the result is known as the `` visible '' map .",
    "this procedure provides an efficient way of introducing smooth , correlated structure on a variety of angular scales . in our notation",
    ", @xmath25 stands for `` hidden . ''",
    "we therefore have @xmath26 hidden pixel values to vary during the fit , for each ellipticity component .",
    "the convolutions with the icf kernels reduce the effective number of free parameters , but even so many of these will still turn out not to be constrained by the few hundred data points in the field .",
    "the choice of prior pdf for the parameters in the @xmath25 is therefore important .",
    "we take the pixel values of the hidden images to be uncorrelated by construction , and assign a _",
    "positive - negative entropic prior _ for them  ( * ? ? ?",
    "* hereafter mhl04 ) .",
    "this has the effect of suppressing structure in the maps unless it is required by the data . in this way",
    "we give the method plenty of flexibility to fit the data well , but regularise to avoid over - fitting .",
    "such a multi - scale maximum entropy method was first used by @xcite , and is implemented in the publicaly available code @xcite .",
    "we illustrate the construction of a multi - scale ellipticity component map in , showing how a range of different features on different angular scales can be modelled .                                                            ' '' ''        this model is similar in both essence and outcomes to one comprising a pixelated map and its ``  trous '' wavelet transform , as shown in some detail by mhl04 .",
    "this wavelet transform can also be written as a set of convolutions ; the implementation of mhl04 works well when making maps of the cmb temperature anisotropies , which also exhibit patchy features on a range of angular scales . just like",
    "wavelet basis functions , the gaussian icfs we use have characteristic angular scales  @xmath27 that increase approximately exponentially : the smallest is a single map pixel ( @xmath28 ) , while the largest is approximately @xmath29 pixels in size .",
    "the icfs are normalised to unit volume .",
    "the entropic prior pdf for a single hidden pixel value @xmath30 takes the following form @xmath31\\ ; , \\\\",
    "s(h_i ) & = \\psi_i - 2m_i - h_i \\log{\\left(\\frac{\\psi_i - h_i}{2 m_i}\\right ) } \\ ; , \\label{eq : entropic_prior}\\end{aligned}\\ ] ] where @xmath32 .",
    "this distribution peaks at zero and is symmetric .",
    "the `` regularisation constant '' @xmath33 is a ( nuisance ) hyperparameter that parametrises the prior distribution .",
    "@xmath33 is inferred from the data via the bayesian evidence internally by , and controls the final importance of the prior relative to the data .",
    "the `` model '' values @xmath34 ( which we take to be constant over each hidden image ) are also hyper - parameters , that determine the ease with which structure develops at each resolution scale : the smaller the value of @xmath34 , the stronger the suppression of features at that scale",
    ".      at this point we might ask whether we can inject any more information into the problem by choosing values of the @xmath34 to reflect the statistical properties of the simulated atmospheric psf patterns . for a given pixel value , the",
    "entropic prior has approximate width @xmath35 , where @xmath36 is the rms width of an approximating gaussian ( mhl04 ) .",
    "this suggests that a possible algorithm for assigning the prior width at a particular resolution scale is to consider the variance of pixel histograms of low noise `` true '' multi - scale icf hidden ellipticity maps at that scale .    to do this ,",
    "we generate a special set of 100 simulated images with an ultra - high density of stars and low noise .",
    "these unphysically dense star fields allow us to access the true psf ellipticity pattern expected in the short exposures .",
    "the simulations are then run through to be effectively `` decomposed '' into the 7 different scales , corresponding to the 7 icfs .",
    "we generated one histogram for each of the 7 resolution scales that contain the pixel values ( @xmath13 and @xmath37 ) in the hidden images for all 100 atmospheric psf patterns on those scales .",
    "these histograms , as shown in , are more peaked , and have broader wings , than a gaussian distribution . the entropic prior pdf ( in blue ) , while still imperfect , is a slightly better approximation to these distributions .",
    "we found the rms widths of the average histograms at the different scales increase from the smallest scale to the largest scale as : @xmath38=[0.0003 , 0.0002 , 0.0027 , 0.0050 , 0.0064 , 0.0089 , 0.0188 ] .",
    "there is very little power on the smallest two scales and nonlinear increase from the remaining middle to large scales .",
    "we adopt these numbers as the width for the entropic priors throughout the rest of the paper .",
    "we find that informing the priors in this way largely improves the accuracy of the psf model constructed by , compared to using flat , non - informative priors .",
    "we also find that using the default prior set in ( which was optimised for cmb temperature map reconstruction ) results in well - behaved psf models , although quantitatively worse than the priors constructed from realistic simulations described above and @xmath39 values in the case of using with the priors to interpolate the psf ellipticities for the same set of simulations in .",
    "( see for the definition of these two statistics . )",
    "quantitatively , using the priors increases @xmath40 by @xmath41 and @xmath39 by @xmath42 compared to using the priors derived from simulations . ] .    as an aside",
    ", we note that the process of assigning prior widths for the different angular scales plays a very similar role to the assignment of the range parameter in the covariance function of the gaussian process at the heart of a kriging interpolation @xcite .",
    "the kriging range parameter could also be derived by inspecting large numbers of high density simulated starfields , to capture the information present in the data - constrained atmospheric turbulence model in its most useful form .",
    "the posterior pdf , @xmath43 , for the hidden pixel values given the data can be approximated by a multivariate gaussian , centred at the maximum posterior point .",
    "the maximum posterior maps provide our best estimates for the psf shape parameters at any target point in the field .",
    "sample maps can be drawn from the posterior pdf in order to provide approximate uncertainties on these estimated psf parameters .",
    "we find that 100 sample maps provide a sufficiently accurate standard deviation map , which we use for the uncertainties on the predicted psf ellipticity estimates .",
    "this gaussian approximation ( including the maximum of the posterior , the covariance matrix of the parameters , and the associated evidence ) is computed using the code , available on request from maxent data consultants .",
    "details of the implementation can be found in @xcite .",
    "as discussed in , since the existing datasets are insufficient for us to perform a systematic test with , we depend on to generate a large number of simulated images .",
    "we refer to p12 , @xcite and @xcite for a complete description of and in specific the details of the atmospheric model . here , to facilitate comparison with parallel psf interpolation studies , we provide a very brief overview of the atmospheric model .    at the heart of the atmospheric model",
    "is a system of seven - layer frozen kolmogorov screens @xcite .",
    "these screens are constructed with density fluctuations obeying a full three - dimensional kolmogorov energy spectrum of @xmath44 , with values for the mean seeing , inner and outer turbulence scale assigned to each individual screen .",
    "all screens contain a wide range of turbulent structures , and these screens are carried by wind in different directions over the course of the exposure time .",
    "the distributions of wind speeds and atmosphere structure function parameters that uses are based on observed data taken near the lsst site at cerro pachon , chile . in p12 , we demonstrated that with this atmospheric model , the simulations from show sufficiently realistic atmosphere - induced psf spatial variation for the purpose of weak lensing studies .",
    "although was designed to simulate images from lsst in particular , the atmospheric model in generates psf patterns qualitatively generic to most large aperture telescopes .",
    "the result of this study can thus be easily extended to estimate the performance of our psf interpolation method on other instruments .",
    "we use a mock stellar catalogue to generate realistic images of star fields .",
    "the catalogue is based on the model of @xcite , and contains a realistic population of stars in a typical lsst field with corresponding characteristics for each star .",
    "the average observed density of the population is @xmath45 , which corresponds to that expected at a galactic latitude of @xmath46 ; the equatorial coordinates of the portion of the star catalogue used for this baseline simulated field was @xmath47 degrees .",
    "two competing factors come into play in the psf interpolation problem : ( 1 ) the complexity of the psf patterns , and ( 2 ) the number of stars available for constructing a psf model ( or effectively , the galactic latitude ) . the more complex the psf pattern , or the fewer stars available to interpolate , the more challenging it is to infer the psf model from stars .",
    "the two effects are tested separately with the simulation and analysis pipeline described below .",
    "we address ( 1 ) by generating 100 realisations of the atmospheric psf patterns , and `` observing '' the mock star fields at these 100 different `` epochs . ''",
    "we generate these psf realisations using the realistic distribution of atmospheric parameters described in p12 .",
    "the median psf size in our simulations is @xmath48  for lsst , this corresponds to approximately half of the exposures with the best image quality .",
    "each atmosphere realisation creates a unique psf pattern ; simulating 100 independently corresponds to a low - cadence survey campaign where observations are well - separated in time .    to investigate ( 2 )",
    ", we do not actually simulate star fields at different galactic latitudes .",
    "instead , we create an over - sampled stellar catalogue based on the same stellar population used for ( 1 ) , so that our input catalogue contains higher stellar density than an `` average '' field , while retaining the same signal to noise threshold in all `` detected '' star catalogs .",
    "we then down - sample at the detection catalogue level to achieve any desired stellar density used for interpolation  which can then be associated with a given galactic latitude . in this analysis",
    ", we consider stellar densities between the range 4 and 0.25 @xmath49 , which approximately covers the range of galactic latitudes @xmath50 .",
    "as will be explained later , the stellar density quoted here is after a signal - to - noise ratio ( snr ) cut , which eliminates very dim stars and noise peaks ( @xmath5123.5 ) .",
    "in reality , harder cuts may be used to guarantee purity of the star sample .    for each of the above scenarios we generate one image containing only the expected stars at their given positions , and a second image containing an ultra - dense grid of bright stars ( @xmath52 ) to sample the `` true '' psf pattern .",
    "noise corresponding to a sky background level of 22  mag / arcsec@xmath4 was added to the star field images .",
    "all images were generated in the @xmath53 band for a single ccd sensor near the center of the lsst focal plane , which corresponds to a 13.6@xmath5413.6@xmath55 field on the sky .",
    "the suite of simulated images were analysed using the same pipeline , in which stars were first detected using the source extractor package , and then catalogued using the software developed by nick kaiser .",
    "shape estimation was performed using the routine `` getshapes '' .",
    "we use the output `` e[0 ] '' and `` e[1 ] '' as our representative measures of ellipticity ( @xmath56 and @xmath57 in ) and retained stars measured with parameter `` @xmath58 '' larger than 25 ( equivalent to a signal - to - noise cut @xmath5913 ) . in the absence of uncertainty estimates on the ellipticity components , we propagate @xmath58 as the stars statistical weight .    , together with two other psf modelling methods , polynomial",
    "fitting and boxcar smoothing ( details of our implementation of which are given in ) , were then applied to the detected stars . from each method , the output was a list of predicted values of the psf ellipticity at the ultra - dense grid positions of the bright stars in the `` true psf '' image .",
    "these grid positions stand for background galaxy positions in a real lensing analysis . in this way we were able to compare the output catalogues directly with the true underlying ellipticity maps .      to quantitatively evaluate the performance of the different psf interpolation techniques , we employ two performance metrics in this paper .",
    "the first metric , @xmath40 , is defined to be the root - mean - square of the psf ellipticity model error : @xmath60 where @xmath61    the second metric , @xmath39 , is defined as the average amplitude of the two - point correlation function of the psf ellipticity model errors in the scales of interest : @xmath62 where @xmath63 is the correlation function of @xmath64 .",
    "the absolute value in the integrand prevents the anti - correlation regime canceling out some of the correlation signal .",
    "we use @xmath65 and @xmath66 in our single lsst ccd sensor ( @xmath67 ) simulations .",
    "this range is chosen to sample the correlated psf model errors on the full sensor while eliminating small scales far below the average stellar separation and large scales that come close to the boundaries .",
    "note that @xmath40 measures the level of the absolute errors in a certain psf model , while @xmath39 is a measure of the _ spatial correlation _ of the psf model errors , in addition to their absolute levels .",
    "this motivates us to take the ratio of these two contributions and define an auxiliary metric @xmath68 : @xmath69 @xmath68 is a _ relative _ measure of the how spatially - correlated the residual ellipticities are , independent of the absolute magnitude of the residual ellipticities .",
    "as seen in later sections , this figure facilitates our comparison of different psf interpolation methods .      in the main analysis in this paper ( )",
    ", we quantify the errors on the psf ellipticity model for different interpolation techniques for a _ single lsst exposure_. in reality , one can suppress the systematic errors that are independent between frames when properly combining multiple exposures .",
    "it is the final _ combined _ systematic error of all the data that impacts the cosmological constraints from weak lensing .",
    "when the multiple exposures are far separated in time , the atmospheric conditions are different and one expects the psf patterns to be independent .",
    "similarly , the errors on the psf model are also expected to be independent .",
    "this suggests that when averaging the ellipticity measurement of the same galaxy over @xmath70 exposures , the ellipticity errors from the atmosphere are expected to reduced as @xmath71 ( corresponding to @xmath40 ) , and the correlation of these errors should drop by @xmath72 ( corresponding to @xmath39 ) , or :    @xmath73    @xmath74    this can be nicely demonstrated by performing the following test : we take the 100 realisations of simulated atmospheric psf and average the psf model prediction at each position over the first @xmath70 frames . @xmath40 and @xmath39 is then calculated for the `` average frame '' and plotted against @xmath70 in .",
    "the two statistics scale with @xmath70 as expected in and , which confirms that the errors produced by all three interpolation methods used in this paper are stochastic over different exposures .",
    "we use the results in to support arguments later in , where we estimate the number of exposures needed to reach a certain level of psf model accuracy .",
    "+      +      +      +   +     +   +    the 100 atmospheric realisations in our simulation suite provide a wide range of psf patterns .",
    "for example , three very different psf patterns on a single lsst ccd sensor are shown in the top row of , where the colours represent true psf @xmath13 values .",
    "we treat the @xmath13 and @xmath37 patterns as they were independent , as noted earlier , and only show @xmath13 here .",
    "we observe that the left column ( a ) contains a psf pattern with some large - scale stripes that vary smoothly across the ccd sensor , with very fine ripples aligned at a direction different from the large stripes ; the middle column ( b ) contains medium - size blobs without any preferred direction ; finally , the right column ( c ) shows nearly equal strength of stripes in two nearly orthogonal directions , creating a grainy high - frequency pattern .",
    "when attempting to model these patterns at a typical galactic latitude of @xmath46 ( stellar density @xmath75 ) , the stars available to us for reconstructing these psf patterns are shown in the second row on the same ellipticity colour scale .",
    "the last three rows of show the psf model generated from three different psf interpolation techniques in the following order : , 5th - order polynomial fitting and @xmath76-pixel boxcar smoothing .",
    "visually , one can readily see the power of in modelling the very different psf patterns over the other two methods . in ( a )",
    ", all three methods failed to model the fine ripples , since they are much finer than the average stellar separations .",
    "they all do , however , manage to pick up the smooth `` stripe '' component .",
    "both the polynomial and boxcar model in this case show bad behaviours on the edges of the field , due to the small number of ill - measured stars dominating the model . in ( b )",
    ", where the underlying psf patterns consist of mainly medium scale `` patches '' , the gaussian icf used in enables the model to capture these features nicely , which is not possible with a polynomial model . the boxcar model , on the other hand , is limited by the size of the filter , which in this case is slightly larger than the patches in the patterns . finally in the right column",
    "( c ) , we show an example where the polynomial model becomes worse than even a simple boxcar smoothing . in this case",
    "the psf pattern almost has no power on the large scales , causing the polynomial model to be entirely dominated by the noise .    in all the cases shown here",
    ", we can see the flexible multi - scale algorithm allows to model structures on a large number of scales , and is well regulated by the prior construction thus less sensitive to noise .",
    "the absolute correlation functions @xmath77 for the three examples in are shown in .",
    "in general , the model errors are more correlated on small scales due to the sparse sampling , and the limited resolution for all three modelling techniques",
    ". the shape of these correlation functions can be either smooth or oscillating .",
    "in particular , for polynomial models , the shape of @xmath78 has some characteristic features : a transition from positive ( correlation ) to negative ( anti - correlation ) always appear at 3@xmath55  @xmath79 . as discussed in h12 , this is a result of both the modelling method and the true atmospheric psf pattern",
    ".    shows , for the 100 different realisations of the atmosphere , the median behaviour of these ellipticity error correlation functions with the error bars indicating the standard deviation of the 100 curves divided by @xmath80 . the median @xmath40 and @xmath39 values for these 100 atmospheric realisations are listed in .",
    "the final column @xmath68 , as explained earlier , is a measure of the _ relative _ reduction in spatially - correlated residual ellipticity for the level of spatial correlation in the model errors independent of the absolute errors .",
    "quantitatively , provides @xmath81 improvement in the absolute ellipticity modelling error , or @xmath40 , over the 5th - order polynomial and @xmath82 improvement over the boxcar smoothing model . for the correlation of these errors , or @xmath39 , performs @xmath83 times better than the polynomial model and @xmath14 times better than boxcar smoothing .",
    "the corresponding @xmath68 values suggest that the model errors from is @xmath84 times less correlated than that from polynomial models and @xmath85 times less correlated than that from boxcar models .",
    "notice that the main power in lies not in the absolute reduction of the model errors , but in the fact that the flexible free - form model creates makes errors less correlated in space , which is an important property for measurements like cosmic shear , where the main signal is embedded in the spatial correlation of galaxy shapes .",
    ".median metric @xmath40 and @xmath39 for the three psf interpolation techniques for 100 different psf patterns sampled at the nominal stellar density of @xmath86 .",
    "the final column @xmath68 is a measure of the level of the spatial correlations in the psf model errors , independent of the absolute errors . [",
    "cols=\"^,^,^,^\",options=\"header \" , ]     however , we note that is a rather simplistic estimation that does not account properly for the correlation properties of these errors and the spurious shear arising from a realistic psf correction pipeline .",
    "an alternative and more realistic approach to interpret the results from our study in terms of shear measurements is to turn to c12 , where we looked at the additive spurious shear correlation function by actually measuring these levels on high fidelity simulations .",
    "we concluded in c12 that the polynomial psf model generates spurious shear correlation approximately at the level required by ar08 in the optimistic case and 2 times too high in the pessimistic case .",
    "correlating galaxy ellipticities in different exposures has been one of the proposed solutions to the problem of stochastic atmospheric psf correlations @xcite .",
    "this , however , comes at the price of decreasing the statistical power of the survey .",
    "exploring the tradeoff between statistical and systematic psf interpolation errors using this technique is not the main focus of this paper .",
    "here , we have effectively assumed a -style @xcite analysis , where the psf ellipticity map is estimated for each exposure , the galaxy images deconvolved , and the ellipticity estimates simply averaged .",
    "this assumption is justified by the behaviour of the residual psf ellipticity correlation function with increasing @xmath70 as we have shown .",
    "we presume that when correlating between different exposures , it will still be beneficial to start with a more accurately - interpolated psf model .      on a standard 64-bit 2@xmath112.2  ghz processor ,",
    "takes on average @xmath5913.0 seconds per lsst ccd sensor per pair of shape parameters ( @xmath87 ) .",
    "adding error estimation ( sampling from the posterior cloud ) adds an extra @xmath599 sec of run time .",
    "this is about an order of magnitude slower than the two other techniques we investigated . for more complicated shape parametrisation",
    "the runtime would increase linearly with the number of parameters , and also with the number of images analysed .",
    "for example , if were to be used for in the lsst data processing pipeline , the psf model in each exposure on the @xmath59200 ccd sensors would need to be calculated in @xmath59 19 seconds ( 15-second exposure + 2-second readout + 2-second shutter open / close ) .",
    "this demands @xmath59200 computers running for the psf reconstruction alone .",
    "though large , these numbers are not outrageous considering the expected decrease in unit cost for computers over the next decade and the possibility of further accelerating the code via hardware parallelisation such as gpus .    in the meantime , we recommend that the current code can be used for smaller scale datasets when extremely accurately interpolated psf maps are vital for the specific science goal . as well as weak lensing",
    ", these might include reconstructing the detailed structures of complex objects , and precision photometry of faint objects .",
    "in this paper we have introduced a new psf interpolation method , , based on a multi - scale maximum - entropy image reconstruction code .",
    "the problem we set out to solve is reconstructing the multi - scale spatial variations of psf shapes , due to atmospheric turbulence , in short exposure images , from sparsely distributed , noisily measured stars  a potential problem for future weak lensing surveys such as lsst .",
    "our analysis of simulated data allows us to draw the following conclusions :    * compared with two other psf interpolation methods , one of which is commonly used in current data analyses , provides more accurately interpolated psf shapes : the absolute residual ellipticities improve @xmath88 while the correlated residual ellipticities are a factor 3 10 smaller than the other two methods , over a wide range of different psf patterns and stellar densities . *",
    "when combining multi - epoch datasets , the interpolation errors due to the atmosphere are stochastic , decreasing with the number of exposures taken as @xmath71 .",
    "the correlation function amplitude decreases as @xmath72 . *   *     while it may still become a practical solution even for large datasets such as lsst , the relatively high computational cost of powerful algorithms like should motivate the development of faster inference methods .",
    "the paper by @xcite appeared as we were completing this study : their results are complementary to those presented here , in that they investigate the psf interpolation problem on larger scales , using re - sampled real subaru data that is less dominated by the atmosphere .",
    "it would be very interesting to apply their kriging technique to our simulated data , and compare performance in terms of accuracy and speed .",
    "like @xcite , we have demonstrated the benefits of using very flexible models , but also the use of methods both inspired and constrained by realistic simulations . injecting statistical information about",
    "the atmospheric psf anisotropy into interpolation methods appears to be a fruitful approach .",
    "all the simulated data used in this paper is freely available at the following website : http://www.slac.stanford.edu/~chihway / psfent/.",
    "lsst project activities are supported in part by the national science foundation through governing cooperative agreement 0809409 managed by the association of universities for research in astronomy ( aura ) , and the department of energy under contract de - ac02 - 76-sfo0515 with the slac national accelerator laboratory .",
    "additional lsst funding comes from private donations , grants to universities , and in - kind support from lsstc institutional members .",
    "pjm acknowledges support from the royal society in the form of a university research fellowship .",
    "this work was supported in part by the u.s .",
    "department of energy under contract number de - ac02 - 76sf00515 .",
    "we thank catherine heymans , barney rowe and lance miller for useful discussions ; and catherine heymans and barney rowe for making their cfht results available before publication .",
    "we also thank beth willman , robert lupton and david wittman for useful comments which have helped improve this paper substantially .",
    "[ lastpage ]",
    "as discussed in , in most current weak lensing pipelines , the psf spatial variation is assumed to be smoothly varying on scaled comparable to the field and can thus be modelled with some low order polynomial functions .",
    "we have shown that psf patterns from short exposures , however , display higher frequency spatial variations that require higher order fits . as a result , we have examined polynomials of order 2 to 5 as psf models and found that 2nd - order models are insufficient in representing the psf variations ; 3rd - order models are usually sufficient , but occasionally an even higher order model is needed .",
    "we choose to use 5th - order models in our main analyses , but have confirmed that in most cases , the results are identical to 3rd - order fits .",
    "we minimise the effective @xmath89 : @xmath90 where @xmath91 is a two dimensional , @xmath92th order polynomial function of @xmath93 , @xmath94 are the fitting parameters and we use the signal - to - noise ratio of each star as @xmath95 .      alternatively , we examine the approach of modelling the psf by directly smoothing the stellar ellipticities with a boxcar filter . in this approach , stars need to first be binned into large pixels , where we assign a weighted average ellipticity to each pixel @xmath96 , defined : @xmath97 the size of the pixels are determined by the number of stars  we pixilate the image so that in each pixel contains approximately 1 star . a boxcar filter of size @xmath98 pixels",
    "is then applied to the large pixel grid so that the ellipticity of pixel @xmath96 is replaced by the average ellipticity of the neighbouring @xmath99 pixels : @xmath100 the original coordinates are then recovered so that the modelled psf ellipticities of all points falling in pixel @xmath96 will be @xmath101",
    "@xmath102}{\\langle r^{2}\\rangle }    = \\frac{\\sqrt{\\langle ( \\delta r^2)^{2}\\rangle}}{\\langle r^{2}\\rangle},\\ ] ] where @xmath103     +   +   +   +   +",
    "@xmath104 @xmath105 @xmath106"
  ],
  "abstract_text": [
    "<S> in this paper we present a new method , , for interpolating the psf shape parameters , based on reconstructing underlying shape parameter maps with a multi - scale maximum entropy algorithm . </S>",
    "<S> we demonstrate , using images from the lsst photon simulator , the performance of our approach relative to a 5th - order polynomial fit ( representing the current standard ) and a simple boxcar smoothing technique . </S>",
    "<S> quantitatively , predicts more accurate psf models in all scenarios and the residual psf errors are spatially less correlated . </S>",
    "<S> this improvement in psf interpolation leads to a factor of 3.5 lower systematic errors in the shear power spectrum on scales smaller than @xmath0 , compared to polynomial fitting . </S>",
    "<S> we estimate that with and for stellar densities greater than @xmath11@xmath2 , the spurious shear correlation from psf interpolation , after combining a complete 10-year dataset from lsst , is lower than the corresponding statistical uncertainties on the cosmic shear power spectrum , even under a conservative scenario .    </S>",
    "<S> [ firstpage ]    cosmology : observations  gravitational lensing  </S>",
    "<S> atmospheric effects  methods : data analysis  techniques : image processing  surveys : lsst </S>"
  ]
}