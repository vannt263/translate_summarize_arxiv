{
  "article_text": [
    "for a system of @xmath0 lotka - volterra equations , as given by eq .  3 of the main text ,",
    "the well - known lyapunov function can be written as v(^)=_i=1^s(x^_i - x^_i - x^_ix^_i / x^_i ) , where @xmath59 for all @xmath5 , @xmath25 is a unique global minimum , and the time evolution is  @xcite = -_i=1^s(x^_i - x^_i)(a^_ij+a^_ji)(x^_j - x^_j ) . under replicator dynamics , the right - hand - side of eq .",
    "sm.2 , with @xmath60 , is the leading term in an expansion of @xmath61 about @xmath62 .",
    "therefore , @xmath25 is globally stable , and @xmath62 is at least locally stable , if @xmath36 is positive definite .",
    "the main text restricts attention to lotka - volterra dynamics in which all the @xmath19 and @xmath20 share the same sign , but the rescaling of eq .",
    "5 can be applied more generally .",
    "of course , the rescaling of eq .",
    "5 fails when parameters are tuned such that @xmath63 or @xmath64 for some @xmath5 , but this problem occurs with vanishing probability when @xmath19 and @xmath20 are empirically estimated .",
    "[ pp ] illustrates our ability , in a predator - prey system , to infer the phenomenology of our multivariate moran process from the corresponding lotka - volterra equations .",
    "a stable fixed point of the lotka - volterra system at @xmath42 anticipates the mean value of the prey s marginal stationary distribution .",
    "1.15 cm , for system size @xmath65 , initial condition @xmath66 , intrinsic growth rates @xmath67 , @xmath68 , and interaction strengths @xmath69 , @xmath70 , @xmath71 . at long times",
    ", the conditional probability approaches a quasi - stationary distribution with a local maximum anticipated by the stable fixed point of the lotka - volterra dynamics.,title=\"fig:\",width=236 ]                the main text establishes an analytical correspondence between our multivariate moran process and equilibrium lotka - volterra phenomenology for any given number of types . here , we provide a multi - type example in which the equilibrium phenomenology of our moran process is anticipated by the corresponding lotka - volterra dynamics .",
    "we construct a consumer - resource system with @xmath72 types and @xmath73 individuals where the fifth type ( consumer ) benefits from the first four types ( resources ) .",
    "parameters are chosen such that , after the re - scalings of eq .  5 ,",
    "the interaction matrix , with elements @xmath74 , is a^= (    ccccc 1.333 & 0.211 & 0.222 & 0.222 & 0.022 + 0.222 & 1.053 & 0.222 & 0.222 & 0.022 + 0.222 & 0.211 & 0.889 & 0.222 & 0.022 + 0.222 & 0.211 & 0.222 & 0.667 & 0.022 + -1.000 & -0.684 & -0.556 & -0.333 & 0.914    ) , the vector of intrinsic growth rates , with elements @xmath75 , is r^=(0.300 ,  0.300 ,  0.300 ,  0.300 ,  -0.200 ) , and all numerical values have been rounded to the nearest one - thousandth .",
    "trajectories of the re - scaled lotka - volterra system are plotted in fig .",
    "[ mt]a with filled semicircles indicating equilibrium abundances that are globally stable due to @xmath76 being positive definite .",
    "the dynamics of our moran process were simulated with the gillespie algorithm  @xcite as implemented in the python package stompy  @xcite .",
    "we ran 2000 stochastic trajectories and calculated statistics over time bins of width @xmath77=1 .",
    "[ mt]b plots means and standard deviations for integrated marginal distributions conditioned against extinction or dominance by any single type . clearly , at long - times ,",
    "mean abundances of marginal stationary distributions in the multivariate moran process converge to stable equilibrium abundances of the corresponding lotka - volterra dynamics . even over short and intermediate time scales ,",
    "the dynamics are remarkably similar .",
    "while simulations of our multivariate moran process become computationally intensive as the number of types becomes large , the lotka - volterra system remains relatively easy to integrate ."
  ],
  "abstract_text": [
    "<S> for a population with any given number of types , we construct a new multivariate moran process with frequency - dependent selection and establish , analytically , a correspondence to equilibrium lotka - volterra phenomenology . </S>",
    "<S> this correspondence , on the one hand , allows us to infer the phenomenology of our moran process based on much simpler lokta - volterra phenomenology , and on the other , allows us to study lotka - volterra dynamics within the finite populations of a moran process . </S>",
    "<S> applications to community ecology , population genetics , and evolutionary game theory are discussed .    </S>",
    "<S> the moran process , originally formulated in the context of population genetics  @xcite , has been applied to a wide range of systems in the biological sciences and statistical physics  @xcite . </S>",
    "<S> multivariate moran models prescribe mean - field stochastic dynamics for birth and death in a population with a fixed number of individuals and any given number of types  @xcite . </S>",
    "<S> the deterministic limit yields replicator equations that model the evolution of type frequencies in large populations  @xcite . for either the multivariate moran process or the corresponding replicator equations </S>",
    "<S> , types might be alleles , as in the population genetics of a single locus  @xcite ; species , as in the neutral theory of community ecology  @xcite ; or strategies , as in evolutionary game theory  @xcite . here , we build on a previous study of frequency-_independent _ selection  @xcite to construct , for any given number of types , a new multivariate moran model with frequency-_dependent _ selection and demonstrate , analytically , that the corresponding replicator equations exhibit equilibrium lotka - volterra phenomenology . </S>",
    "<S> the results presented here are distinct from the well - known equivalence of @xmath0 replicator equations and @xmath1 lotka - volterra equations  @xcite . </S>",
    "<S> furthermore , our choice of frequency - dependent selection generates @xmath0 replicator equations with the equilibrium phenomenology of @xmath0 lotka - volterra equations . </S>",
    "<S>  lotka - volterra equations \" in this context does not refer to the special case of neutrally stable , two - species , predator - prey dynamics , but rather to the general case of mean - field deterministic dynamics for a population with any number of well - mixed types and linearized density - dependent growth rates  @xcite . </S>",
    "<S> these generalized lotka - volterra equations are frequently used to model competitive dynamics in ecological communities  @xcite . </S>",
    "<S> indeed , the two - species case may be the simplest dynamical system to exhibit the niche mechanism for stabilizing coexistence , in which ( i ) demographic rates must vary among species , ( ii ) abundances for each species must increase when rare , and ( iii ) _ </S>",
    "<S> intra_specific competition must exceed _ </S>",
    "<S> inter_specific competition  @xcite . by embedding lotka - volterra dynamics within a multivariate moran process </S>",
    "<S> , we obtain a theoretical framework in which equilibrium moran phenomenology may be inferred from much simpler lotka - volterra phenomenology , and lotka - volterra dynamics may be studied within the finite populations of a moran process . </S>",
    "<S> this framework offers new insights on community ecology , population genetics , and evolutionary game theory .    in a multivariate moran process for @xmath0 types and @xmath2 individuals , the allowed states are vectors of nonnegative integers , @xmath3 , such that @xmath4 for each @xmath5 and @xmath6 . </S>",
    "<S> the allowed transitions are a single death event immediately followed by a single birth event in order to maintain a total of @xmath2 individuals . in the absence of selection , i.e.  the neutral limit , per capita rates of birth and death are equivalent . </S>",
    "<S> if we ignore mutation and migration , the neutral transition rate for a death event in type @xmath5 immediately followed by a birth event in type @xmath7 is simply t_ij = ( ) , where only @xmath8 individuals are present after the death of @xmath5 and prior to the birth of @xmath7 . </S>",
    "<S> dynamics are governed by a multivariate master equation that we can write as  @xcite = _ i=1^s_j=1^s(t_ij+_i-_jp_+_i-_j - t_jip _ ) _ ij , where @xmath9 is the probability of state @xmath10 , @xmath11 is a unit vector , and @xmath12 is a dimensionless measure of time </S>",
    "<S> . the @xmath13 , where @xmath14 , for @xmath15 , and @xmath16 otherwise , eliminate transitions to non - allowed states . </S>",
    "<S> the stochastic process contains @xmath0 absorbing states where a single species dominates such that @xmath17 for some @xmath5 . </S>",
    "<S> the more familiar univariate moran process is obtained from the marginal dynamics of eq .  </S>",
    "<S> [ master ]  @xcite .    for @xmath0 types , </S>",
    "<S> the lotka - volterra equations can be written as = x_if_i ( ) , where @xmath18 is the density of type @xmath5 and f_i()=r_i-_j=1^s a_ijx_j , is a density - dependent growth rate parameterized by @xmath19 , the intrinsic growth rate of type @xmath5 in the absence of all others , and @xmath20 , the additive per capita impact of type @xmath7 on the growth rate of type @xmath5 . </S>",
    "<S> we focus for now on _ competition _ among types such that @xmath21 and @xmath22 for all @xmath5 and @xmath7 . in community ecology , the @xmath23 </S>",
    "<S> are referred to as  intraspecific competition strengths \" and the @xmath20 , with @xmath24 , as  interspecific competition strengths \" . without loss of generality , we can re - scale the lotka - volterra equations such that r^_i , a^_ij(_k=1^sr_k ) , -0.45 cm x^_ix_i , ^_k=1^sr_k , and if a coexisting fixed point , @xmath25 , exists , with @xmath26 for all @xmath5 , then _ i=1^sx^_i=1 .    with these preliminaries , </S>",
    "<S> we first construct a new multivariate moran process and then establish a correspondence to equilibrium lotka - volterra phenomenology . for the construction phase , </S>",
    "<S> we seek frequency - dependent selection coefficients similar in form to the density - dependent growth rates of the lotka - volterra equations but remaining nonnegative for all states and parameter values . towards this end , the growth rates of a ricker model  @xcite inspire our choice of frequency - dependent selection coefficients w_i(r^_i-_k=1^s a^_ik ) , and we expand on eq .  </S>",
    "<S> [ snmt ] to impose the transition rates t_ij = ( ) , where various subtractions account for the death of type @xmath5 prior to the birth of type @xmath7 . in the context of population genetics , </S>",
    "<S> the @xmath27 are reproductive fitnesses , and the multivariate moran process of eq .  </S>",
    "<S> [ master ] with the transition rates of eq .  </S>",
    "<S> [ snnmt ] provides a framework for multiallelic , frequency - dependent selection that is not limited by the usual assumptions of weak selection or symmetry under the exchange of alleles  @xcite . </S>",
    "<S> symmetry under exchangeability only obtains in the neutral limit where eq .  </S>",
    "<S> [ snnmt ] reduces to eq .  </S>",
    "<S> [ snmt ] for @xmath28 and @xmath29 for all @xmath5 and @xmath7 .     </S>",
    "<S> 0.00 cm   0.00 cm     -0.425 cm    -0.5 cm    the deterministic limit of eq .  [ master ] , with the transition rates of eq .  </S>",
    "<S> [ snnmt ] , is given by = n_j=1(t_ji - t_ij ) where @xmath30 . </S>",
    "<S> a simplification is obtained in the case of weak asymmetries where a^_ij<<_k=1^s a^_ikn_k , w_i<<_k=1^s w_kn_k , for every @xmath5 , @xmath7 , and @xmath10 .  weak asymmetries \" in our multivariate moran process are similar to  weak selection \" in a univariate moran process  @xcite , but due to the weighted sums over @xmath31 that appear in eq .  </S>",
    "<S> [ asymmreq ] , our asymmetry requirements depend on population size , @xmath2 , as highlighted below in the discussion of fig .  </S>",
    "<S> [ rvsj ] . if we assume sufficiently weak asymmetries , and if we transform variables from densities , @xmath32 , to frequencies , @xmath33 , eq .  [ deterlimitv0 ] can be approximated by the replicator equation ~p_i ( c_i ( ) - 1 ) , where the replicator fitness is c_i ( ) , and @xmath34 is defined by eq .  [ introwi ] upon substituting @xmath35 for @xmath31 . </S>",
    "<S> the mean replicator fitness is unity at all times , and therefore , never decreases - a standard requirement of replicator dynamics  @xcite .    to establish a correspondence to equilibrium lotka - volterra phenomenology </S>",
    "<S> , we note that a coexisting fixed point for the lotka - volterra system of eq .  </S>",
    "<S> [ lv ] is also a coexisting fixed point for the replicator system of eq .  </S>",
    "<S> [ deterlimit ] ^*=^. but in addition to this identity , we find a correspondence in stability : if the matrix with elements given by @xmath36 is positive definite , then the coexisting fixed point is globally stable in the lotka - volterra system and at least locally stable in the replicator system . </S>",
    "<S> the proof for any given number of types employs the well - known lyapunov function for lotka - volterra dynamics  @xcite ( see supplemental material ) . in the special case of @xmath37 competition , </S>",
    "<S> if @xmath38 and @xmath39 , then the replicator and lotka - volterra equations share a stable coexisting fixed point and each type can invade when rare . </S>",
    "<S> the latter inequalities , which imply that @xmath40 , quantify the three requirements of niche theory that were highlighted in the introduction .    to illustrate how lotka - volterra phenomenology can facilitate inference on our multivariate moran process </S>",
    "<S> , we consider a two - type population where eq .  </S>",
    "<S> [ master ] can be re - written as a univariate birth - death process  @xcite with rates of gain and loss given by b_i & = & ( ) , + d_i & = & ( ) , + and @xmath41 . </S>",
    "<S> starting from a known initial abundance , fig .  </S>",
    "<S> [ msi ] integrates the marginal distribution of type 1 conditioned against extinction and dominance . </S>",
    "<S> we consider three cases : a ) the neutral limit , b ) destabilized coexistence due to interspecific exceeding intraspecific competition , and c ) stabilized coexistence due to intraspecific exceeding interspecific competition . </S>",
    "<S> the quasi - stationary distribution emerging at long times is ( a ) flat , ( b ) peaked at extinction and dominance , or ( c ) peaked at coexistence . in the corresponding lotka - volterra equations , </S>",
    "<S> the stability of the coexisting fixed point at @xmath42 allows us to infer the shape of the quasi - stationary distribution with ( a ) neutral stability linked to a flat distribution , ( b ) instability linked to a local minimum , and ( c ) stability linked to a local maximum  @xcite . as @xmath2 becomes large , </S>",
    "<S> fluctuations become rare and the peaks in figs .  [ </S>",
    "<S> msi]b and [ msi]c approach delta functions . </S>",
    "<S> if we interpret fig .  [ msi ] in the context of diploid population genetics , we find that interspecific exceeding intraspecific competition yields a scenario of  underdominance \" ( fig .  </S>",
    "<S> [ msi]b ) , in which selection favors homozygous over heterozygous populations , and intraspecific exceeding interspecific competition yields a scenario of  overdominance \" ( fig .  </S>",
    "<S> [ msi]c ) , in which selection favors heterozygosity  @xcite . </S>",
    "<S> the supplemental material provides predator - prey and multi - type examples to further illustrate the use of lotka - volterra dynamics to anticipate the phenomenology of our multivariate moran process . for the multi - type example </S>",
    "<S> , moran dynamics are simulated with the gillespie algorithm  @xcite as implemented in the python package stompy  @xcite .    </S>",
    "<S> , as a function of the number of individuals , @xmath2 , in a two - type population where @xmath43 , @xmath44 , and @xmath45 ( light grey ) , @xmath46 ( dark grey ) , or @xmath47 ( black ) , with @xmath48 and @xmath49 . </S>",
    "<S> type 1 is always excluded as @xmath50 , but for sufficiently small @xmath2 , the @xmath51 asymmetry is sufficiently strong that frequency - dependent selection yields fixation rates above the neutral limit ( dashed line ) . ]    </S>",
    "<S> -0.5 cm    -0.5 cm    but we also need to consider cases where the assumptions of eq .  </S>",
    "<S> [ asymmreq ] break down , and the correspondence between moran process and lotka - volterra system no longer holds . </S>",
    "<S> fortunately , in this regime , the moran process remains valid for strong asymmetries and allows us to study lotka - volterra dynamics within finite populations . </S>",
    "<S> as an example , consider fixation rates , or the expected rate at which individuals of a given type grow to dominate a population given a fixed rate of repeated introduction . in a two - type population , the fixation rate of type 1 is given by  @xcite r = n(1+_k=1^n-1_i=1^k)^-1 , in our nondimensionalized time units . </S>",
    "<S> for large populations that satisfy the weak asymmetry requirements of eq .  </S>",
    "<S> [ asymmreq ] , fixation rates are vanishingly small when @xmath52 , and as expected from lotka - volterra dynamics , type 1 can not invade type 2 . however , in the stochastic dynamics of small populations with strong asymmetries , the introduction of a single individual of type 1 can disproportionately impact the fitness of type 2 if @xmath51 . for three different values of @xmath53 , fig .  </S>",
    "<S> [ rvsj ] plots fixation rates against population sizes in a scenario where @xmath52 . when @xmath54 , fixation rates lie above the neutral limit of @xmath55 for sufficiently small populations . </S>",
    "<S> therefore , in our multivariate moran process , strong asymmetries in finite populations can favor invasion even when the corresponding lokta - volterra system for an infinite population predicts exclusion .    </S>",
    "<S> we conclude by discussing two applications of our framework for merging moran and lotka - volterra dynamics . in community ecology , </S>",
    "<S> the past decade has witnessed an enormous interest in predicting large - scale abundance distributions based on neutral models for individual interactions . the foundational work of caswell  @xcite and hubbell  @xcite applied the neutral moran models of population genetics to competitive ecological communities , such as the canopy trees in a tropical forest where light - gaps are quickly filled and the total number of individuals may be approximated as a constant . for these models , </S>",
    "<S> types correspond to species and genetic variation within each species is ignored . </S>",
    "<S> efforts to determine the relative importance of deterministic niche dynamics and stochastic neutral dynamics in structuring ecological communities have been limited by the lack of a common analytical framework . </S>",
    "<S> fortunately , by adding mutation or migration to the transition rates of our multivariate moran process , where selection occurs on the level of species rather than alleles in this context , we can unify hubbell s formulation of neutral theory  @xcite with niche theory  @xcite . </S>",
    "<S> in particular , with the addition of a small mutation rate , the deterministic limit of our multivariate moran process yields a replicator - mutator equation  @xcite exhibiting equilibrium lotka - volterra phenomenology up to small corrections . </S>",
    "<S> this non - neutral framework , in which niche stabilization can delay extinction , offers a simple solution to hubbell s problem of short species lifetimes  @xcite .    merging moran and lotka - volterra dynamics </S>",
    "<S> is also relevant to evolutionary game theory . indeed , fig  [ rvsj ] is reminiscent of results in nowak _ </S>",
    "<S> et al . _  </S>",
    "<S> @xcite for a univariate moran process with frequency - dependent selection that models evolutionary games in finite populations . </S>",
    "<S> their definition of reproductive fitness can be mapped onto a first - order expansion of eq .  </S>",
    "<S> [ introwi ] if we now assume that @xmath56 and @xmath57 for all @xmath5 and @xmath7 . in this regime </S>",
    "<S> , the equilibrium phenomenology of our re - scaled lotka - volterra and replicator equations matches the usual expectations for two - strategy games , such as the prisoner s dilemma  @xcite and repeated prisoner s dilemma  @xcite , given @xmath58 and payoff matrix . + our multivariate moran process with frequency - dependent selection provides a general framework for modeling the stochastic dynamics of evolutionary games with any given number of strategies in a finite population .    </S>",
    "<S> we are grateful for productive conversations with bill creskoe , jessica green , matt holland , marcel holyoak , tim keitt , sivan leviyang , timo maarleveld , patrick phillips , annette ostling , bruce rannala , sahotra sarkar , sebastian schreiber , and an annonymous reviewer . </S>",
    "<S> our work is partially supported by the nsf through their emerging frontiers grant ( 0827460 ) to a.  h.  and by the james s. mcdonnell foundation through their studying complex systems grant ( 220020138 ) to w.  f.  f.    32 natexlab#1#1bibnamefont # 1#1bibfnamefont # 1#1citenamefont # 1#1url # 1`#1`urlprefix[2]#2 [ 2][]#2    , _ _ ( , ) .    , </S>",
    "<S> _ _ ( , ) .    , , , * * , ( ) .    , </S>",
    "<S> * * , ( ) .    , </S>",
    "<S> * * , ( ) .    , , , , , * * , ( ) .    , * * , ( ) .    , * * , ( ) .    </S>",
    "<S> , , , * * , ( ) .    , _ _ , oxford series in ecology and evolution ( , ) .    , _ _ ( , ) , ed .    , * * , ( ) .    </S>",
    "<S> , _ _ ( , ) .    , _ _ ( , ) .    , * * , ( ) .    , _ _ ( , ) .    , * * , ( ) .    , </S>",
    "<S> , , , * * , ( ) .    , </S>",
    "<S> * * , ( ) .    , _ _ ( , ) .    , _ _ ( , ) .    , * * , ( ) .    , * * , ( ) .    , * * , ( ) .    , in _ _ </S>",
    "<S> ( , ) .    , * * , ( ) .    , </S>",
    "<S> _ _ ( , ) .    , * * , ( ) .    , ( ) .    , , , </S>",
    "<S> , * * , ( ) .    , </S>",
    "<S> * * , ( ) .    , , , , * * , ( ) . </S>"
  ]
}