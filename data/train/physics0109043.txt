{
  "article_text": [
    "to fully understand chemical dynamics phenomena it is necessary to know the underlying potential energy surfaces ( pes )  @xcite .",
    "surfaces can be obtained by two means : _ ab initio _",
    "calculations  @xcite and the inversion of suitable laboratory data  @xcite .",
    "this paper is concerned with an emerging class of laboratory data  @xcite with special features for inversion purposes .",
    "traditional sources of laboratory data for inversion produce an indirect route to the potential requiring the solution of schrdinger s equation  @xcite in the process",
    ". an alternative suggestion  @xcite has been put forth to utilize ultrafast probability density data from diffraction observations or other means  @xcite to extract adiabatic potential surfaces .",
    "such data consists of the absolute square of the wavefunction .",
    "although the phase of the overall wavefunction is not available , there is sufficient information in this data to extract the potential fully quantum mechanically _ without _ the solution of schrdinger s equation . instead , the proposed procedure rigorously reformulates the inversion algorithm as a linear integral equation utilizing ehrenfest s theorem  @xcite for the position operator .",
    "additional attractive features of this algorithm are ( a ) the procedure may be operated non - iteratively , ( b ) no knowledge is required of the molecular excitation process leading to the data and ( c ) the regions where the potential may be reliably extracted are automatically revealed by the data .",
    "extensive efforts are under way to achieve the necessary temporal and spatial resolution of the probability density data necessary for inversion processes as well as for other applications  @xcite . in anticipation of these developments",
    "a number of algorithmic challenges require attention to provide the means to invert such data .",
    "this paper aims to build on the previous work  @xcite and address some of these needs . in particular this paper will consider ( i ) optimal choices for regularizing the inversion procedure , ( ii ) incorporation of multiple data sets and ( iii ) inclusion of data sampled at discrete time intervals .",
    "these concepts are developed and illustrated for the simulated inversion of a double well potential .",
    "the paper is organized as follows . the basic inversion procedure and the model system",
    "are given in section  [ sec : inversion_scheme ] .",
    "based on the inversion algorithm derived in ref .",
    "@xcite an extended regularization procedure is presented in section  [ sec : regularization ] followed by a discussion of a modified time integration scheme applicable to different types of experimental data sampling .",
    "this development naturally leads to consideration of an optimal combination of data from different measurements . a proof on how to optimally combine the data is given in appendix  [ sec : optimality_proof ] .",
    "the stability of this data combination procedure under the influence of noise is discussed as well .",
    "section  [ sec : summary ] summarizes the findings of this paper .",
    "the algorithms developed in this paper will be illustrated for a one - dimensional system but the generalization to higher dimensions is straightforward  @xcite : the major difference with higher dimensions is the additional computational effort involved .",
    "atomic units are used throughout this work .    for a system",
    "whose dynamics is governed by the schrdinger equation @xmath0    \\psi(x , t)\\ ] ] the time evolution of the average position obeys ehrenfest s theorem @xmath1 where @xmath2 and @xmath3 . in this work the probability density @xmath4 is assumed to be observed in the laboratory and the goal is to determine the potential energy surface ( pes ) @xmath5 from the gradient @xmath6 .",
    "following  @xcite , eq.([eq : ehrenfest ] ) can be used to construct a gaussian least squares minimization problem to determine the pes gradient @xmath6 @xmath7 ^ 2 { \\text{d}}t\\;.    \\label{eq : j0_def}\\ ] ] the time averaging acts as a filtering process to increase inversion reliability by gathering together more data .",
    "this will generally increase reliability which in principle is only limited by the exploratory ability of the wavepacket . beyond some point in time little information on the potential may be gained by taking further temporal data starting from any potential initial condition .",
    "variation with respect to @xmath6 results in a fredholm integral equation of the first kind @xmath8 with righthand side ( rhs ) @xmath9 and symmetric , positive semidefinite kernel @xmath10 treated as an inverse problem , eq.([eq : orig_inverseproblem ] ) produces the desired pes gradient @xmath6 as its solution . for numerical implementation",
    "we resort to the matrix version and its formal solution @xmath11 here the integral in eq.([eq : orig_inverseproblem ] ) is evaluated at points of equal spacing @xmath12 .",
    "this approach to seeking the pes has a number of attractive features  @xcite .",
    "the formulation requires no knowledge of any preparatory steps to produce a specific @xmath13 which evolves freely to produce @xmath4 .",
    "the generation of @xmath14 and @xmath15 depends only on @xmath4 and begins when the observation process is started .",
    "moreover , although this is a fully quantum mechanical treatment there is no need to solve schrdinger s equation to extract the pes .",
    "the dominant entries of @xmath14 and @xmath15 automatically reveal the portions of the pes that may be reliably extracted .",
    "the linear nature of eq.([eq : orig_inverseproblem ] ) is very attractive from a practical perspective .    notwithstanding these attractions ,",
    "a principal problem to manage is the generally singular nature of the kernel of the integral equation in eq.([eq : orig_inverseproblem ] ) .",
    "the kernel s nullspace makes it difficult to solve the inverse problem and leads to an unstable and ambiguous solution @xmath6 , two characteristics that generally define the ill - posedness of inverse problems .",
    "there are two major reasons for the ill - posedness of the inverse problem in eqs .",
    "( [ eq : orig_inverseproblem ] ) and  ( [ eq : orig_inverseproblem_matrix ] ) .",
    "firstly , it is not possible to continuously monitor the wavepacket with arbitrary accuracy and information is lost due to discrete data sampling in space and time . secondly , the ill - posedness is due to the wavepacket only exploring a subspace of the pes . in regions untouched by the wavepacket with @xmath16 for all observation times @xmath17",
    "the kernel entries vanish as @xmath18 .",
    "hence these regions correspond to zero - entry rows and columns in the kernel matrix @xmath19 and constitute its nontrivial nullspace . in general , the solution @xmath6 will only be reliable in regions where @xmath4 has significant magnitude during its evolution",
    ". the inversion procedure can manage the null space with the help of a suitable regularization procedure .",
    "singular value decomposition and iterative solution schemes are available ( cf .  @xcite for an overview ) , but here we will employ extended tikhonov regularization ( see section  [ sec : regularization ] ) .    the procedures developed in this paper are applied to a simulated inversion with a system taken to have a slightly asymmetric double well potential  @xcite @xmath20 with parameters @xmath21 in the work of n.  doli _ et al . _",
    "@xcite this pes represents a one dimensional model for the intramolecular proton transfer in substituted malonaldehyde ( see fig .  [",
    "fig : malonaldehyd ] ) .",
    "the particle mass is accordingly that of hydrogen .",
    "the wavepacket propagations to obtain the simulated @xmath4 data employed the split operator method ( cf .",
    "@xcite ) . for propagation as well as inversion",
    "we used a grid with 8192 points over the range @xmath22 .",
    "a time step @xmath23 was chosen and total propagation time was @xmath24 .",
    "the small values of @xmath25 and @xmath26 ensured good convergence of the numerical propagation procedure .",
    "the initial wavefunctions were normalized gaussian wavepackets of width @xmath27 .",
    "as stated earlier , the inversion algorithm requires no knowledge of how these packets were formed , but generally one may assume that a suitable external laser field was applied for times @xmath28 .",
    "the initial packets were placed at the left ( l ) and right minimum ( r ) of the pes , on top of the barrier ( t ) , and at a location high on the potential ( h ) .",
    "the wavepacket positions are illustrated in fig .",
    "[ fig : malonaldehyd ] and their exact values , the associated average energies and the classical turning points at these energies are given table  [ tab : energy ] .",
    "the inversion process employed a time step and grid spacing that differed from those used in the propagation , as high spatial and temporal resolution is difficult to attain in the laboratory .",
    "hence , we employed only a portion of all the available propagation data @xmath4 in time and space .",
    "we will present inversion results using every 16th propagation grid point ( i.e. , @xmath29 ) and every fifth available snapshot ( i.e. , @xmath30 ) ; even fewer snapshots could be used over a longer period of time with the criterion that roughly the same total amount of data is retained .",
    "the inversion results from these lower resolution data are very encouraging .",
    "the kernel matrices @xmath31 for condition h and t are shown in fig .",
    "[ fig : kernel ] ; similar plots apply to the cases l and r. the kernels are symmetric with respect to @xmath32 and their values cover a large dynamic range from @xmath33 down to @xmath34 on the plotted domain .",
    "significant entries are found predominantly on the matrix diagonal , close to the origin of the wavepacket , and also in the vicinity of the classical turning points . beyond the classical turning points at a distance of approximately @xmath35 the kernel values fall off very rapidly for both configurations .    for configuration h in fig .",
    "[ fig : kernel]a the initial narrow gaussian is peaked at the hydrogen distance @xmath36 with corresponding large entries around @xmath37 .",
    "the wavepacket starts to spread and acquires momentum as it slides down the pes , which results in the broadening diagonal trace observed as the central structure in fig .",
    "[ fig : kernel]a . when the wavepacket reaches its lefthand turning point it spreads further ( star structure around @xmath38 ) before it returns .",
    "this pattern coincides with the motion of the average position @xmath39 displayed for configuration h in fig .",
    "[ fig : individual_reconstruction]a .",
    "even higher symmetry can be observed for configuration t s kernel matrix @xmath19 in fig .",
    "[ fig : kernel]b .",
    "the initial gaussian remains centered around @xmath40 and spreads to the left and righthand well only .",
    "this is further supported by the motionless average position @xmath41 in fig .",
    "[ fig : individual_reconstruction]a .",
    "hence large entries in @xmath19 result in the vicinity of @xmath42 and the wavepacket s symmetrical spread to the left and righthand side of the pes produces the spikes along the @xmath43-axis for @xmath44 . due the kernel s symmetry",
    "these spikes reappear as lines along the @xmath45-axis for @xmath46 .",
    "large contributions for @xmath32 will again lead to a pronouced diagonal and add to the snowflake appearance of fig .",
    "[ fig : kernel]b .    the features of the kernels in fig .  [ fig : kernel ]",
    "coincide with the nature of the inverse problem mentioned earlier : symmetry , ill - posedness , and automatic identification of the range where the pes may be be reliably extractable ( i.e. , where the kernel entries are large ) . for configuration",
    "h the relevant range is @xmath47 and for configuration t only the vicinity of the barrier top should yield reliable pes information . in both cases",
    "we can not expect reasonable solutions beyond @xmath35 , which coincides with the classical turning points given in table  [ tab : energy ] .",
    "tikhonov regularization  @xcite is straightforward to implement with simple control provided by suitable weight parameters .",
    "it provides a well defined means to stabilize the inversion and extract reliable pes information in those regions allowed by the data .",
    "this investigation goes beyond the initial work  @xcite to carefully explore various regularization options .",
    "regularization has the goal of improving the accuracy of the solution , assuring stability and ease of use including computational simplicity .",
    "the functional @xmath48 was augmented by a regularization term involving a set of increasingly higher order differential operators acting on @xmath6 @xmath49 ^ 2 \\,{\\text{d}}x\\ ; , \\label{eq : j1_def}\\ ] ] with real coefficients @xmath50 and a reference length @xmath51 . in practice @xmath51",
    "may be thought of as the spatial resolution of the data and in the present numerical simulation it was taken as @xmath12 . for a multidimensional system , @xmath51 and @xmath52 will become direction dependent tensors .",
    "the parameter @xmath51 acts to ensure that all the new terms added to @xmath48 have the same units as @xmath53 ^ 2 $ ] as well as permits comparison of the roles of the dimensionless regularization parameters @xmath52 for different @xmath54 and different grid spacings @xmath12 .",
    "the previous work  @xcite did not employ a reference length as only the @xmath55 regularization term was considered .",
    "the parameter @xmath56 penalizes the value of @xmath6 .",
    "the new terms go beyond and impose extra pressure on the gradient ( @xmath57 ) , the curvature ( @xmath58 ) of @xmath6 , etc ..    variation of @xmath59 with respect to @xmath6 yields the modified inversion prescription @xmath60\\,u(x')\\ , { \\text{d}}x ' = b(x)\\;.     \\label{eq : new_reg_inverseproblem}\\ ] ] the sum added to @xmath48 in eq.([eq : j1_def ] ) for regularization consisted of purely positive terms with derivatives of up to @xmath61th order , resulting in an alternating series of only even derivatives up to order @xmath62 in eq.([eq : new_reg_inverseproblem ] ) .",
    "moreover , the fredholm integral equation of the first kind has been transformed into an integro - differential equation for @xmath6 with the added terms dominating in the regions where kernel is singular .    due to the rapid growth in the order of the derivatives it is often sufficient to set @xmath63 , i.e. , retaining standard , gradient , and curvature tikhonov regularization . for numerical application eq.([eq : new_reg_inverseproblem ] ) may be transformed into the matrix problem @xmath64\\cdot\\bbox u\\,\\delta x= \\bbox b\\ , , \\label{eq : orig_reg_inverseproblem_matrix}\\ ] ] employing the unit matrix @xmath65 , as well as the second @xmath66 and the forth order differentiation band matrices @xmath67 these are simple differencing expressions for the derivatives involved .",
    "higher order expressions for the derivatives could be considered , but finite data resolution and laboratory noise will generally not warrant or support the added complexity .    to investigate the inverse solution s dependence on the various regularization parameters in eq.([eq : orig_reg_inverseproblem_matrix ] ) several parameter scans for all four configurations l , t , r",
    ", h were performed for different resolutions @xmath12 and combinations of @xmath52-parameters . for the discussion in this paper",
    ", we selected typical results for the situation of h with @xmath68 . the curves in fig .",
    "[ fig : scans ] show the solution defect @xmath69 and the system defect @xmath70 as defined below in eqs.([eq : solution_defect ] ) and ( [ eq : rhs_defect ] ) .",
    "while only @xmath70 is an experimentally accessible figure of merit , an investigation of @xmath69 here allows for quantifying the quality of the inverse solution . for both error measures reported the plots",
    "are generated for each @xmath52 independently while the others are kept zero .",
    "figures [ fig : scans]a and [ fig : scans]b display the solution defect @xmath71^{1/2}\\;.\\ ] ] figure  [ fig : scans]a is computed with @xmath72 , @xmath73 ( i.e. the central domain indicated in fig .",
    "[ fig : kernel ] and table  [ tab : energy ] within which the inversion is expected to be valid ) and fig .",
    "[ fig : scans]b with @xmath74 , @xmath75 ( i.e. , the full simulation range ) .",
    "the differences between the two cases are striking .",
    "the corresponding solution defects show a completely different shape with minima that differ by several orders of magnitude in @xmath52 . in fig .",
    "[ fig : scans]b the magnitude of the error in the active domain @xmath76 is overestimated .",
    "this behavior in fig .",
    "[ fig : scans]b is due to large deviations between the exact gradient and the inversion solution for the gradient , which can not be recovered reliably in the domain s outer limits .",
    "thus we conclude that @xmath69 scans should only be computed over the regions actually reached to a significant degree by the wavepacket ( cf . ,",
    "[ fig : scans]a ) to achieve reliable estimates of the inversion quality .",
    "the latter point is illustrated in figs .",
    "[ fig : individual_reconstruction]b and [ fig : individual_reconstruction]c with the inverted results for @xmath6 ane @xmath5 with pure @xmath77 regularization of configurations h / h@xmath78 where @xmath77 is given in table  [ tab : scan ] .",
    "the two cases h / h@xmath78 differ in the domain employed in the inversion ( i.e. , the active domain for h and the full domain for h@xmath78 ) and in the choice of optimal @xmath77 determined according to the @xmath69 scans .",
    "thus we further conclude that the inversion process should be confined to the active domain to maintain stability .    to find suitable integration regions from the laboratory data",
    "the normalized lefthand @xmath79 and righthand variance @xmath80 of the position operator can be helpful .",
    "together with the position average @xmath81 they can provide an estimate for the pes domain predominantly covered by the wavepacket motion .",
    "we present all three quantities ( @xmath41 and @xmath82 as grey shaded regions ) in fig .",
    "[ fig : individual_reconstruction]a .",
    "the results clearly show that for configuration h the range @xmath83 is suitable . for configurations",
    "l , t , r an even smaller range is best ( cf . , table  [ tab : scan ] ) .",
    "all the computations revealed that a gradient tikhonov regularization based on @xmath77 performs better than the standard regularization based on @xmath56 utilized earlier  @xcite .",
    "there is some additional improvement in choosing the curvature regularization @xmath84 , but we found it to be less stable for coarse grids , which will be the standard situation in actual application .",
    "we also found little improvement in mixing the different regularization schemes .",
    "in general the @xmath85 regularization with the largest errors masks the positive effects of the others .",
    "hence for all cases of the pes reconstruction we utilized only @xmath77 regularization ( cf . , the inversion in figs .",
    "[ fig : individual_reconstruction]a and [ fig : individual_reconstruction]b with the optimal parameters given in table  [ tab : scan ] ) .    as a measure of inversion quality and the role of regularization",
    ", we desire a quantity that is strictly available from the laboratory data @xmath4 .",
    "a good choice is the system defect @xmath70 defined by the norm of satisfying the system equation  ( [ eq : orig_inverseproblem ] ) with the inverse solution @xmath6 found via eq .",
    "( [ eq : new_reg_inverseproblem ] ) @xmath86^{1/2 } \\;.\\ ] ] the values of @xmath70 will depend on the regularization parameters @xmath52 .",
    "weak regularization will produce a small value of @xmath70 , but likely artificial structures in the pes . over regularization",
    "will result in a smooth pes , that is systematically in error with diminished influence from the kernel @xmath14 on the inverse solution .",
    "the best choice for the @xmath52 is generally where @xmath70 has risen and leveled off in a stable region as shown in fig .",
    "[ fig : scans]c .",
    "the figure shows that @xmath70 naturally tends to zero as @xmath87 and monotonically rises until it reaches a plateau .",
    "there is very good agreement between the values of @xmath52 which show good results for @xmath69 in fig .",
    "[ fig : scans]a and the stable regularization region identified in fig .",
    "[ fig : scans]c",
    ". thus @xmath70 should be of practical utility in assigning regularization parameter values .",
    "the generally self - similar structures in figs .",
    "[ fig : scans]a and [ fig : scans]c suggest that every regularization operator has a roughly similar effect .",
    "this added robustness is also attractive for practical application if it holds up regardless of the system .",
    "sections  [ sec : optimal_rec ] and  [ sec : rho_combi ] will cover different approaches to combining distinct sets of laboratory density data . finally section  [ sec : noise ] will explore the impact of data noise on the inversion .      the functional @xmath88 in its original form in eq.([eq : j0_def ] ) is expressed in terms of a uniform , continuous time integration of observed @xmath4 data .",
    "however , experimental circumstances including measurements at discrete snapshots in time or changes in the quality of data sampling may necessitate employing a weight function @xmath89 for a generalized approach to the time integration in the functional @xmath48 .",
    "thus we define @xmath90 as @xmath91 ^ 2\\omega(t)\\ , { \\text{d}}t\\;.\\ ] ] the choice @xmath92/t$ ] , with @xmath93 being the heaviside step function , will reduce @xmath90 to @xmath48 .",
    "variation of eq.([eq : weighted_j0 ] ) leads to a modified inverse problem @xmath94 with the new kernel @xmath95 and rhs @xmath96 the weight @xmath89 does not alter the regularization terms in eq.([eq : new_reg_inverseproblem ] ) .",
    "if @xmath97 is rewritten using partial integration over time , then the weight function must be considered in this process .",
    "the above equations were applied to two generic cases .",
    "first , we considered data gathered as snapshots in time i.e. , @xmath98 , and evaluated eqs .",
    "( [ eq : kernel_matrix_weighted ] ) and  ( [ eq : rhs_weighted ] ) with this weight .",
    "this procedure simply reduced all time integrations to sums over the sampled @xmath99 data .",
    "next , we considered the case in which the measurement process has been divided into two continuous time intervals of length @xmath100 and @xmath101 separated by a period of time @xmath102",
    ". a reasonable choice of weights would either be @xmath103 or @xmath104 the choice depends on the desired emphasis to be given to the two data intervals .",
    "here we chose to give the longer interval a larger contribution in @xmath105 than the shorter one , and this can be better achieved with using eq.([eq : equal_weighting_intervals ] ) ; this choice is reasonable , provided the measured data @xmath4 in both intervals are of comparable quality .",
    "clearly many other issues can be incorporated into the choice of @xmath89 dictated by what is known about the nature of the data and the information sought about the pes .",
    "the kernel is now @xmath106 and the rhs reads @xmath107    the interpretation of the weight in eq.([eq : equal_weighting_intervals ] ) is associated with performance of the inversion with an interrupted gathering of data from a _ single _ experiment . to explore this point further",
    "it is useful to rewrite eqs.([eq : kernel_intervals ] ) and  ( [ eq : rhs_intervals ] ) as @xmath108 u(x')\\,{\\text{d}}x ' \\label{eq : combination } = b_1(x)+b_2(x)\\;,\\ ] ] where the indices `` 1 '' and `` 2 '' denote the evident two data time domains . in this form",
    "the gathering of data from _",
    "one interrupted _ experiment can also be interpreted as finding the simultaneous solution to the inverse problem of _ two different _ experiments .",
    "these two experiments could possibly be prepared with distinct controls could , for example , explore different regions of the pes .",
    "we found that it is optimal to simply combine these sets of data by addition as indicated in eq.([eq : combination ] ) .",
    "this procedure will yield an inverse solution @xmath109 with accuracy greater than a linear combination @xmath110 of separate solutions to the individual problems `` 1 '' and `` 2 '' as explained below .",
    "consider two experiments that yield two different inverse solutions satisfying their respective system equation @xmath111 naturally there should be only a unique exact @xmath112 for the physical system .",
    "hence both system solutions @xmath113 in eq.([eq:2_experiments_ansatz ] ) can be decomposed into the exact solution and contamination pieces from the kernel s nullspace @xmath114 the functions @xmath115 and @xmath116 are associated with the nullspace of the two kernels with @xmath117 being the contamination from the common nullspace of @xmath118 and @xmath119 and @xmath120 the residual contribution unique to the respective kernel .",
    "the goal is to use the data to find an optimal solution @xmath109 with the smallest possible nullspace contribution .    exploiting the linearity of the inverse problem",
    ", we may add the two pieces of eq.([eq:2_experiments_ansatz ] ) to get @xmath121 this does nt fully satisfy eq.([eq : combination ] ) and it is in general not possible to construct the optimal solution @xmath109 as a linear combination @xmath122 with constant coefficients @xmath123 . to elucidate this point",
    ", we insert @xmath109 into eq.([eq : combination ] ) and with the help of eqs.([eq:2_experiments_ansatz ] ) and  ( [ eq : solution_decomposition ] ) we get the cross terms @xmath124 where the prefactors @xmath125 , @xmath54 have been omitted . hence @xmath109 is not an optimal solution of eq.([eq : combination ] ) since it leaves errors @xmath126 that can not be eliminated .",
    "however , by employing eq .",
    "( [ eq : combination ] ) and adding the kernels and rhss we can improve the quality of the inversion .",
    "no error terms like @xmath126 will appear since by construction the resulting @xmath109 can be decomposed as @xmath127 .",
    "a contribution from @xmath128 as in eq.([eq : solution_decomposition ] ) will not arise , as proved in appendix  [ sec : optimality_proof ] .",
    "thus , the solution of the combined problem will gain in quality by virtue of the reduced nullspace of the new kernel @xmath129 .",
    "these optimality results are rigorous but it must be added that in general any combination of a finite amount of data will not fully eliminate the nullspace .",
    "however in the cases under comparison here the assumption that a similar degree of robustness can be attained certainly holds true .",
    "as argued above , we chose the weighting function in eq.([eq : equal_weighting_intervals ] ) to result in observation - duration proportional entries in @xmath130 and @xmath131 .",
    "hence it is quite natural to add @xmath132 .",
    "however , choosing the approach eq.([eq : weighting_intervals ] ) normalizes each data set independently .",
    "this logic naturally leads to considering the optimal combination of data to form @xmath133 where @xmath134 and @xmath135 are positive constants .",
    "this specially weighted form , or a positive definite combination @xmath136 with @xmath137 , might be useful especially in the presence of different degrees of noise in the two data sets .",
    "an iterative numerical scheme to optimize @xmath138 could then help to improve the solution by minimizing the effects of nullspace contamination .",
    "the optimal combination of data by addition of kernels @xmath139 and rhss @xmath140 presented above was applied to the double well system with results for the gradient @xmath6 and pes @xmath5 shown in fig .",
    "[ fig : combi_reconstruction ] .",
    "information was successively added to the kernel @xmath14 by combining the data sets to form lt , ltr , and ltrh with the notation based on the initial conditions shown in fig .",
    "[ fig : malonaldehyd ] . in each case",
    "all configurations are weighted equally .",
    "the optimal @xmath77 values employed and defect measures are given in table  [ tab : scan ] .    while the individual inverse problem solutions based on l , t , r , and h reproduce the potential in their respective neighborhoods quite well , they fail to give adequate results for the other portions of the potential . on the other hand ,",
    "the reconstruction of large parts of the pes is successful if we optimally combine the data of the three experiments ltr .",
    "however , contrary to intuition , we observe that the solution is less satisfactory from combining all the data ltrh ; some additional oscillations appear along with a dip in the vicinity of the initial wavepacket for h. apparently the nullspace of the expanded domain can not be fully managed by @xmath77 regularization alone ; no attempt was made to simultaneously introduce @xmath56 and @xmath84 regularization .",
    "several other schemes for combining the raw density data can be envisioned , apart from the approach in section  [ sec : optimal_rec ] .",
    "one candidate would be the direct combination of @xmath4 data from different experiments . as an illustration we will treat the case of two different @xmath99 s with @xmath141 and @xmath142 being a positive constant .",
    "this combination is physically acceptable , as ehrenfest s theorem in eq.([eq : ehrenfest ] ) is linear in the probability density .",
    "insertion of this sum into the functional @xmath88 and variation with respect to @xmath6 will yield a formulation analogous to the one describing inversion under the influence of noise in the data ( see section  [ sec : noise ] ) in eq.([eq : noise_inverse ] ) upon comparison of eqs.([eq : noise_ansatz ] ) and ( [ eq : rho_ansatz ] ) .",
    "the terms proportional to @xmath143 and @xmath144 will exactly correspond to what was found earlier in eq.([eq : combination ] ) .",
    "however , the terms proportional to @xmath142 represent a cross correlation between @xmath145 and @xmath146 .",
    "these cross terms can be significant , and they act to introduce an element of undesirable structure , often oscillatory , in the equations determining @xmath6 . on physical grounds",
    "it is also artificial to directly correlate the independent experimental data @xmath145 and @xmath146 when seeking @xmath6 .",
    "hence , the scheme of adding together the bare @xmath99-data is expected to produce unreliable results . to support this argument we present a test on such a @xmath99-combination consisting of the sum of all four densities of the initial configurations l , t , r , and h @xmath147 the corresponding inverted gradient and pes respectively",
    "are shown in figs .",
    "[ fig : combi_reconstruction]a and [ fig : combi_reconstruction]b .",
    "the solution is rather poor and far worse than the ltrh combination using the same data .",
    "this result should not be taken to construe that other combinations of data might not give satisfactory results .",
    "however , the combination of @xmath148 and @xmath149 in section  [ sec : optimal_rec ] is quite natural and produces excellent inversion results .",
    "any real @xmath99-data will always be contaminated by some degree of noise . in an additive model",
    "this noise contaminated data @xmath150 can be represented as @xmath151 where @xmath152 is a ordering parameter and the noise is described by the spatio - temporal function @xmath153 .",
    "we assume that @xmath153 is a randomly varying function with vanishing average contribution and free from systematic error such that @xmath154 for any function @xmath155 of bounded norm over time that is not correlated with @xmath153 .    inserting the ansatz in eq.([eq : noise_ansatz ] ) into the functional @xmath88 in eq.([eq : j0_def ] ) and taking the first variation ,",
    "the equation determining @xmath6 is obtained @xmath156 the terms proportional to @xmath143 recover the original unperturbed system in eqs.([eq : orig_inverseproblem]-[eq : a_def ] ) . assuming the data noise level to be small , the terms in @xmath144 on both sides of eq.([eq : noise_inverse ] ) can be neglected .",
    "we first turn to the kernel side of eq.([eq : noise_inverse ] ) and denote all terms in @xmath157 as the error kernel @xmath158 @xmath159 each term involves the computation of two - point spatial correlations between functions .",
    "however , the functions @xmath160 and @xmath99 are uncorrelated , and the temporal integral of their product is expected to result in only small random contributions to the kernel over @xmath43 and @xmath45 , especially for longer time integration as follows from eq .",
    "( [ eq : noise_condition ] ) . following similar logic , the terms proportional to @xmath157 on the rhs of eq.([eq : noise_inverse ] ) should be negligible , especially for long time integration .",
    "neglecting the @xmath144 terms finally leaves only the first term proportional to @xmath143 on the rhs .",
    "hence , the functional @xmath48 exhibits some inherent capability to deal with slightly noisy data .",
    "the time integration process averages out these noise effects so that they should have a decreasing impact on the inverse solution @xmath6 .",
    "longer periods of temporal data should make their behavior better .",
    "these results are also in accordance with the stability analysis presented in  @xcite .",
    "resorting to the matrix version of the inverse problem ( cf .",
    ", eq.([eq : orig_reg_inverseproblem_matrix ] ) ) the authors proved ( eq.(25 ) in ref .",
    "@xcite ) that the relative error in the solution @xmath161 after regularization is bounded by the relative errors in the data @xmath162 and @xmath163",
    ".    moreover it was found ( eqs.(41 ) and ( 49 )  @xcite ) that small perturbations in the noise @xmath164 will result in small proportional perturbations in @xmath165 and @xmath166 , which is excellent behavior for any application with finite time integration .",
    "these results can now be extended to the long time integration limit where the @xmath157 terms in eq.([eq : a - error ] ) should further diminish in significance for @xmath167 .",
    "similar arguments apply to the rhs  @xmath165  @xcite .",
    "equation  ( [ eq : a - error ] ) also demonstrates why the direct combination of bare @xmath4 data discussed in section  [ sec : rho_combi ] performs less satisfactory than the optimal combination scheme in section  [ sec : optimal_rec ] .",
    "in contrast to the slightly perturbed system cross term @xmath168 above , the analogous term arising from directly combining the @xmath99 data will not vanish .",
    "this will introduce an undesirable error contribution to the inverse problem .",
    "in contrast , the optimal combination scheme for different sets of data in section  [ sec : optimal_rec ] should profit from the inherent stability of the inversion procedure to deal with slightly noisy systems since this technique involves a sequence of separate time integrations .",
    "this paper presented new results that improve and extend a recently suggested procedure  @xcite to extract potential energy surfaces ( pes ) from the emerging experimentally observable probability density @xmath169 data .",
    "the results of this paper should also be applicable to the more general case of extracting the dipole function from the additional observation of the applied laser electric field  @xcite .    an easy to implement regularization scheme",
    "was introduced , which increases the accuracy of the computed pes without loss of numerical stability .",
    "furthermore an optimal reconstruction method was presented which combines data from different measurements .",
    "this scheme was argued to be optimal in the sense of reducing the nullspace of the inverse problem and hence increasing the domain of the extracted pes .",
    "evidence was presented that this scheme is stable under the influence of noise , but further investigations will be necessary to fully confirm these results .",
    "we hope that the developments in this paper stimulate the generation of appropriate probability density data for inversion implementation .",
    "the authors would like to acknowledge karsten sundermann who shared interest in this subject from its inception .",
    "rdvr thanks `` fonds der chemischen industrie '' and hr would like to acknowledge the department of energy .",
    "lk acknowledges dfg s financial support through the project `` spp femtosekundenspektroskopie '' .",
    "he also would like to thank angelika hofmann for the propagation code and jens schneider as well as berthold - georg englert for discussions .",
    "this section presents the lemma and its proof underlying the optimal combination of data from different measurements .",
    "[ lemma ] given two hermitian , positive semidefinite operators @xmath170 acting on the hilbert space @xmath171 and their sum @xmath172 with coefficients @xmath173 , it then holds that @xmath174 for finite dimensional ranges this implies that @xmath175    in other words : adding two positive semidefinite , hermitian operators will reduce the nullspace of the combined operator to that of the intersection of both nullspaces . the generalization to a finite sum of operators @xmath176 with constant @xmath177 is evident .",
    "neither positivity nor hermiticity can be omitted . without the former criterion ,",
    "a counter example is @xmath178 , with @xmath179 . as an example , without the latter criterion , the two @xmath180 operators @xmath181 with ranks 3 , 2 , and 1 lead to the contradiction @xmath182 .",
    "proof : as both operators @xmath183 and @xmath184 are hermitian , they have diagonal representations with respect to their eigenvectors @xmath185 and @xmath186 . without loss of generality",
    "we choose the normalized eigenvectors @xmath187 as the basis of @xmath171 .",
    "clearly , @xmath171 can be decomposed in the following two ways into orthogonal subspaces @xmath188 and also @xmath189 in a similar fashion we can partition the spectrum of @xmath183 , and hence @xmath171 s basis , into all eigenvectors that form a basis of @xmath190 and those that generate @xmath191 . since @xmath171 is a complete linear space and @xmath192 are linear operators , it is sufficient to consider the basis states only . for any such state @xmath193",
    "we find @xmath194 where we define the mean @xmath195 .",
    "this quantity is always positive ( or zero ) by virtue of @xmath184 being positive semidefinite .    in accordance with the decomposition in eqs.([eq : decompose_space_a ] ) and ( [ eq : decompose_space_b ] ) four different cases are to be distinguished : @xmath196 therefore only ( basis ) vectors that lie in _ both _ nullspaces will belong to the nullspace of @xmath31 , which proves the first part of the lemma .",
    "the second part follows from the linear algebraic dimension relation @xmath197 where `` + '' on the lefthand side denotes all linear combinations of the vectors in both ranges .",
    "now , any vector that lies either in @xmath190 or in @xmath198 will , with an argument similar to eq.([eq : fall_differentiation ] ) , always be in @xmath199 .",
    "we are thus allowed to replace @xmath200 which completes our proof .",
    "we note that the lemma s first part could have been proved without using a basis .",
    "the decomposition eq.([eq : decompose_space_a ] ) and the differentiation of eq.([eq : fall_differentiation ] ) into @xmath202 or @xmath203 for any @xmath204 suffices .",
    "however , the second part of the lemma requires the basis vectors .                                                                          for @xmath15 ,",
    "a related issue pointed out in  @xcite is the stability of @xmath15 in view of the need to take the second time derivative of the probability density .",
    "an approach based on partial integration over time has been proposed calling for a first order time derivative only .",
    "however , a check of the inversion performance based on partial integration produced unsatisfactory results .",
    "it will always be extremely difficult to reliably compute the terms @xmath205 at only a few @xmath4 snapshots in time .",
    "one inevitably needs to work with one - sided derivatives at @xmath206 and @xmath207 , which significantly diminishes the accuracy .",
    "ldcdd configuration index & @xmath208 & @xmath209 & + & & & left & right + h & 1.75 & 0.081 & -2.1563 & 2.1534 + r & 0.9977&0.055 & -2.0013 & 1.9978 + t & 0.0052&0.061 & -2.0403 & 2.0370 + l&-1.002 & 0.054 & -1.9996 & 1.9961    the configuration indices",
    "h , r , t , and k corresponding to the locations of wavepacket initial positions are shown in fig .",
    "[ fig : malonaldehyd ] .",
    "all wavepackets start with equal width @xmath27 and are initially at rest centered at the respective starting position @xmath208 .",
    "the average energy of each packet as well as the corresponding turning points of an equivalent classical particle of the same energy are given .",
    "[ tab : energy ]    lddddd configuration & @xmath77 & @xmath210&@xmath211 & @xmath212 & @xmath213 + h@xmath78 & 3.3@xmath214 & -4.0&4.0 & 384.58 & 0.03 + h & 1.0 & -2.0&2.0 & 11.52 & 23.46 + r & 0.033 & -1.5&1.5 & 7.16 & 1.06 + t & 0.007 & -1.5&1.5 & 9.02 & 0.05",
    "+ l & 0.033 & -1.5&1.5 & 6.53 & 1.07 + @xmath215 & 100.0 & -1.5&1.5 & 9.53 & 111.63 + ltrh & 0.333 & -1.5&1.5 & 3.83 & 12.42 + ltr & 0.01 & -1.5&1.5 & 2.78 & 0.70 + lt & 0.01 & -1.5&1.5 & 3.10 & 0.49    in this numerical case study the optimal regularization parameter value @xmath77 was identified by scanning its effect on the solution defect @xmath69 .",
    "the inversion domains are @xmath216 .",
    "the system defect is @xmath70 .",
    "the first five rows apply to the individual pes reconstructions shown in fig .",
    "[ fig : individual_reconstruction ] , and the last four rows refer to measurement combinations shown in fig .",
    "[ fig : combi_reconstruction ] . see the text for details .",
    "[ tab : scan ]      .",
    "( a ) configuration h and ( b ) configuration t. the numerical values for the matrix entries range from @xmath217 on the diagonal to @xmath218 on the boundaries .",
    "the contour levels correspond to : 1 ( outer line ) , 31 , 61 ,  , 211.,title=\"fig:\",width=302 ]     parameter scans performed with configuration h. panels ( a ) and ( b ) display the solution defect @xmath69 with respect to two different inversion ranges : @xmath219 and @xmath220 , respectively .",
    "panel ( c ) shows the system defect @xmath70 for the entire domain @xmath221.,title=\"fig:\",width=302 ]        fig .",
    "[ fig : individual_reconstruction ] .",
    "extractions of the potential under the conditions given in table  [ tab : scan ] .",
    "( a ) the time evolution of the position average @xmath41 accompanied by the left- and righthand variance ( i.e. , shaded regions bounded by eqs.([eq : left_variance ] ) and  ( [ eq : right_variance ] ) ) to indicate the regions predominantly covered by the probability densities .",
    "the grey domains on the extreme left and right mark classically forbidden areas ( cf .",
    "table  [ tab : energy]).(b ) the reconstructed @xmath6 and the corresponding potential @xmath5 in ( c ) with a suitably chosen additive constant . for comparison the exact solutions are included as dashed lines .",
    "the individual curves have been offset for graphical reasons and the detailed presentation of @xmath5 is restricted to @xmath222 since the boundary regions will not be extracted correctly due to lack of data sampling there .",
    "-combined data @xmath223 .",
    "see the text and table  [ tab : scan ] for details .",
    "the curves for the derivative @xmath6 in ( a ) and the pes in ( b ) have been offset for graphical clarity and exact solutions ( dashed lines ) added for comparison .",
    "for optimal combinations of the data the original and reconstructed pes are almost indistinguishable.,title=\"fig:\",width=264 ]"
  ],
  "abstract_text": [
    "<S> a novel algorithm was recently presented to utilize emerging time dependent probability density data to extract molecular potential energy surfaces . </S>",
    "<S> this paper builds on the previous work and seeks to enhance the capabilities of the extraction algorithm : an improved method of removing the generally ill - posed nature of the inverse problem is introduced via an extended tikhonov regularization and methods for choosing the optimal regularization parameters are discussed . </S>",
    "<S> several ways to incorporate multiple data sets are investigated , including the means to optimally combine data from many experiments exploring different portions of the potential . </S>",
    "<S> in addition , results are presented on the stability of the inversion procedure , including the optimal combination scheme , under the influence of data noise . </S>",
    "<S> the method is applied to the simulated inversion of a double well system to illustrate the various points . </S>"
  ]
}