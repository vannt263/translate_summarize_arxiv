{
  "article_text": [
    "multi - way relay networks ( mwrns ) , where a single relay facilitates all users in the network to exchange information with every other user , have important potential applications in teleconferencing , data exchange in a sensor network or file sharing in a social network x @xcite .",
    "a mwrn is a generalization of two - way relay networks ( twrns ) , which enable bidirectional information exchange between two users and are widely recognized in the literature for their improved spectral efficiency , compared to conventional relaying  @xcite .",
    "note that multi - user twrns  @xcite , where each user exchanges information with a pre - assigned user only , can be considered as a special case of mwrns .",
    "the users in a mwrn can adopt either pairwise transmission  @xcite or non - pairwise transmission  @xcite strategy for message exchange .",
    "though non - pairwise transmission can offer larger spectral efficiency , its benefits come at the expense of additional signal processing complexity at the relay @xcite .",
    "hence , in this paper , we focus on pairwise transmission strategy .",
    "recently , pairwise transmission based mwrns have been studied for different relaying protocols , e.g. , functional decode and forward ( fdf ) @xcite , decode and forward  @xcite , amplify and forward  @xcite and compute and forward @xcite protocols .",
    "it was shown in  @xcite that pairwise fdf with binary linear codes for mwrn , where the relay decodes a function of the users messages rather than the individual messages from a user pair , is theoretically the optimal strategy since it achieves the common rate .",
    "also it was shown in  @xcite that for a mwrn with lattice codes in an additive white gaussian noise ( awgn ) channel , the pairwise fdf achieves the common rate .",
    "hence , in this paper , we consider fdf mwrn .    in a pairwise transmission",
    "based fdf mwrn , user pair formation is a critical issue . in this regard ,",
    "two different pairing schemes have been proposed in the literature . in the pairing scheme in  @xcite ,",
    "the @xmath1 and the @xmath2 users form a pair at the @xmath1 time slot , where @xmath3 $ ] and @xmath4 is the number of users in the mwrn . in the pairing scheme in @xcite , instead of consecutive users as in the pairing scheme in  @xcite , the @xmath1 and the @xmath5 user form a pair at the @xmath1 time slot when @xmath6 and the @xmath2 and @xmath5 user form a pair at the @xmath1 time slot when @xmath7 , where @xmath8 denotes the floor operation .",
    "the achievable rates for these two existing pairing schemes were analyzed in  @xcite , while the average bit error rate ( ber ) for the first pairing scheme was analyzed in @xcite .",
    "a major drawback of the above two pairing schemes is that they arbitrarily select users for pair formation and do not take the users channel information into account when pairing the users .",
    "this is crucial since in a mwrn , the decision about each user depends on the decisions about all other users transmitting before it .",
    "thus , in the above pairing schemes , if any user experiences poor channel conditions , it can lead to incorrect detection of another user s message , which can adversely impact the system performance due to error propagation .",
    "we also note that a recent paper on opportunistic pairing @xcite also suffers from the error propagation problem similar to @xcite .    in this paper , we propose a novel pairing scheme for user pair formation in a fdf mwrn . in this scheme ,",
    "each user is paired with a common user , which is chosen by the relay as the user with the best average channel gain .",
    "this allows the user with the best channel conditions to contribute to improving the overall system performance by reducing the error propagation in the network .",
    "the major contributions of this paper are as follows :    * considering an @xmath4-user fdf mwrn employing sufficiently large dimension lattice codes , we derive upper bounds for the common rate and sum rate with the proposed pairing scheme ( cf .",
    "theorems @xmath9 ) .",
    "* considering an @xmath4-user fdf mwrn with @xmath0-ary quadrature amplitude modulation ( qam ) based transmission , which is a special case of lattice code based transmission , we derive the asymptotic average ser with the proposed pairing scheme ( cf .",
    "theorem @xmath10 ) . * we present important insights , obtained from a careful analysis of the results in theorems 1 - 3 , in the form of propositions 1 - 9 . analyzing the results in theorems 1 - 3 ,",
    "we compare the performance of the proposed pairing scheme with the existing pairing schemes and show that : * * for the equal average channel gain scenario , the average common rate and the average sum rate are the same for the proposed and existing pairing schemes , but the average ser improves with the proposed pairing scheme ( cf .",
    "propositions @xmath11 , @xmath12 and @xmath13 ) . * * for the unequal average channel gain scenario , the average common rate , the average sum rate and the average ser all improve for the proposed pairing scheme ( cf . propositions @xmath14 , @xmath15 and @xmath16 ) . * * for the variable average channel gain scenario , the average common rate for the proposed pairing scheme is practically the same as the existing schemes , whereas , the average sum rate and the average ser improve for the proposed pairing scheme ( cf . propositions @xmath10 ,",
    "@xmath17 and @xmath18 ) .",
    "the rest of the paper is organized as follows .",
    "the system model is presented in section  [ sec : sys_model ] .",
    "the proposed pairing scheme is discussed in section [ sec : pairing ] and the general lattice code based transmissions with the proposed pairing scheme are presented in section  [ sec : signal ] .",
    "the common rate and the sum rate for a fdf mwrn with the proposed scheme is derived in section [ performance ] .",
    "the average ser is derived in section [ error ] .",
    "the numerical and simulation results for verification of the analytical solutions are provided in section [ sec : results ] .",
    "finally , conclusions are provided in section [ conclusion ] .    throughout this paper",
    ", we use the following notations : @xmath19 denotes the estimate of a message , @xmath20 denotes that the message is estimated for the second time , @xmath21 denotes absolute value of a complex variable , @xmath22 denotes euclidean norm , @xmath23 denotes the argument , @xmath24 denotes the maximum value , @xmath25 denotes the minimum value , @xmath26 $ ] denotes the expected value of a random variable , @xmath8 denotes the floor operation , @xmath27 denotes logarithm to the base two and @xmath28 is the gaussian q - function .",
    "-user multi - way relay network ( mwrn ) , where the users exchange information with each other via the relay @xmath29 . here , ` ts ' means time slot and user @xmath11 is considered to be the common user ( for illustration purpose).,scaledwidth=95.0% ]    we consider an @xmath4-user mwrn , where all the users exchange their information with each other through a single relay , as illustrated in fig .",
    "[ fig : fig1 ] . in this setup ,",
    "a pair of users communicate with each other at a time , while , the remaining users are silent .",
    "we assume that the users transmit in a half - duplex manner and they do not have any direct link in between them .",
    "the information exchange takes place in two phases@xmath30multiple access and broadcast phase@xmath30each comprising @xmath31 time slots for an @xmath4-user mwrn @xcite . in the _ multiple access phase _ , the users transmit their data in a pairwise manner . in the _ broadcast phase _ , the relay broadcasts the decoded network coded message to all users .",
    "after @xmath32 time slots , all users have the network coded messages corresponding to each user pair and then they utilize self information to extract the messages of all the other users .",
    "we refer to these @xmath32 time slots in the two phases as one _ time frame_. that is , in each time frame , each user transmits a message packet of length @xmath33 and the relay transmits @xmath34 message packets , each of length @xmath33 .",
    "thus , a total of @xmath35 message packets are communicated in an entire time frame .",
    "we choose the index for time slot and time frame as @xmath36 and @xmath37 , respectively , and the message index as @xmath38 where , @xmath39 $ ] , @xmath40 $ ] and @xmath41 $ ] , where , @xmath42 is the total number of time frames .",
    "the transmission power of each user is @xmath43 , whereas , the transmission power of the relay is @xmath44 . at the @xmath45 time frame and the @xmath46 time slot , the channel from the @xmath47 user to the relay",
    "is denoted by @xmath48 and the channel from the relay to the @xmath47 user by @xmath49 , where @xmath50 $ ] .",
    "we make the following assumptions regarding the channels :    * the channels are assumed to be block rayleigh fading channels , which remain constant during one message packet transmission in a certain time slot in a certain multiple access or broadcast phase . the channels in different time slots ( e.g. , @xmath51 and @xmath52 ) and different time frames ( e.g. , @xmath51 and @xmath53 ) are considered to be independent .",
    "also , the channels from users to the relay ( e.g. , @xmath48 ) and the channels from the relay to users ( e.g. , @xmath49 ) are reciprocal . * the fading channel coefficients are zero mean complex - valued gaussian random variables with variances @xmath54 . *",
    "the perfect instantaneous channel state information ( csi ) of all users is available to the relay .",
    "the users have access to the self csi only , which has been assumed in many research works  @xcite . *",
    "perfect channel phase synchronization is assumed because physical layer network coding requires that the signals arrive at the relay with the same phase and this allows benchmark performance to be determined @xcite .",
    "we consider the following three different channel scenarios in this work :    1 .",
    "_ equal average channel gain scenario : _ all the channels from the relay to the users and the users to the relay have equal average channel gain , which remain fixed for all time frames .",
    "that is , @xmath55=e[\\mid h_{2,r}^{t_s , t_f}\\mid^2]= ... =e[\\mid h_{l , r}^{t_s , t_f}\\mid^2]$ ] .",
    "unequal average channel gain scenario : _ all the channels from the relay to the users and the users to the relay have unequal average channel gains which remain fixed for all the time frames .",
    "that is , @xmath56\\neq e[\\mid h_{2,r}^{t_s , t_f}\\mid^2]\\neq ... \\neq e[\\mid h_{l , r}^{t_s , t_f}\\mid^2]$ ] and @xmath57=e[\\mid h_{j , r}^{t_s,2}\\mid^2]= ... =e[\\mid h_{j , r}^{t_s , f}\\mid^2]$ ] .",
    "_ variable average channel gain scenario : _ all the channels from the relay to the users and the users to the relay have unequal average channel gains and the channel conditions change after a block of @xmath58 ( @xmath59 ) time frames .",
    "that is , @xmath56\\neq e[\\mid h_{2,r}^{t_s , t_f}\\mid^2]\\neq ... \\neq e[\\mid h_{l , r}^{t_s , t_f}\\mid^2]$ ] and @xmath60=e[\\mid h_{j , r}^{t_s , at'_f+2}\\mid^2]= ...",
    "=e[\\mid h_{j , r}^{t_s,(a+1)t'_f}\\mid^2]$ ] for @xmath50 $ ] and @xmath61 , where @xmath58 is the number of time frames after which the unequal average channel gains change .",
    "the above scenarios can model a wide variety of practical channel scenarios .",
    "for example , the equal average channel gain scenario is applicable to satellite communications , where the users are equidistant from the relay .",
    "the unequal average channel gain scenario is applicable to fixed users ( e.g. , located at home or workplace ) in a network , where the users distances from the relay are unequal but remain fixed .",
    "the variable average channel gain scenario is applicable to mobile users in a network , where the users distances from the relay are unequal and vary due to user mobility .",
    "in this section , we propose a new pairing scheme for user pair formation in the multiple access phase ( illustrated in fig . [",
    "fig : fig1 ] ) which is defined by the following set of principles :    p1 : :    the common user is selected by the relay to be the user that has the    best average channel gain in the system .",
    "p2 : :    the common user s index is broadcast by the relay prior to each    multiple access phase .",
    "this common user transmits in all the time    slots in the multiple access phase and the other users take turns to    form a pair with this common user .",
    "p3 : :    the common user is kept fixed for all the time slots within a certain    time frame . after some time frames , the common user might change    depending upon the changing channel conditions .",
    "the proposed pairing scheme allows the best channel in the system to contribute towards the error - free detection of each user s message , which would not be possible if the common user is chosen without considering the channel conditions , as in @xcite .",
    "note that taking channel state information into account is a well established design principle in wireless communication systems @xcite .    in the propsed scheme ,",
    "since the common user is involved in all the transmissions in the multiple access phase , an issue of transmission fairness arises . in the context of the proposed scheme , on average",
    ", each user should transmit the same number of times ( equivalently consume the same amount of power overall ) .",
    "we propose to achieve transmission fairness for the three channel scenarios , considered in this work , in the following manner    1 .   _",
    "equal average channel gain scenario : _ in this scenario , to maintain transmission fairness among the users , we randomly select a different common user in each time frame so that , on average , every user gets the opportunity to become the common user .",
    "unequal average channel gain scenario : _ in this scenario , the common user s transmission power must be scaled by @xmath34 , since it transmits @xmath34 times , whereas , other users transmit only once .",
    "variable average channel gain scenario : _ in this scenario , during each time frame , the user with the best average channel gain is chosen as the common user and this process is repeated for every time frame so that , on average , every user with changing channel conditions , gets the opportunity to become the common user .",
    "in this section , we discuss the general lattice code based transmissions with the proposed pairing scheme in a mwrn .",
    "we denote the @xmath62 user as the common user and the @xmath1 user as the other users , where , @xmath63 $ ] and @xmath64 . for the rest of this paper , we consider message exchange within a certain time frame and choose to omit the superscript @xmath37 from the symbols for simplifying the notations .      as our proposed pairing scheme",
    "is based on lattice codes , we first present the definitions of some primary operations on lattice codes , which we have used in the later subsections . our notations for lattice codes follow those of @xcite .",
    "further details on lattice codes are available in @xcite .",
    "an @xmath65-dimensional lattice is a discrete subgroup of the @xmath65-dimensional complex field @xmath66 under the normal vector addition operation and can be expressed as @xcite : @xmath67    where , @xmath68 is the generator matrix corresponding to the lattice @xmath69 and @xmath70 is the set of integers .",
    "* the nearest neighbour lattice quantizer maps a point @xmath71 to a nearest lattice point @xmath72 in euclidean distance @xcite .",
    "that is , @xmath73 * the modulo-@xmath69 operation is defined by @xmath74 @xcite . * the voronoi region @xmath75 denotes the set of all points in the @xmath65-dimensional complex field @xmath66 , which are closest to the zero vector @xcite",
    ", i.e. , @xmath76 * @xmath77 denotes the mapping of messages from a finite dimensional field to lattice points , i.e. , @xmath78 , where @xmath79 is a message from a finite dimensional field . *",
    "a coarse lattice @xmath69 is nested in a fine lattice @xmath80 , i.e. , @xmath81 , so that the messages mapped into fine lattice points remain in the voronoi region of the coarse lattice . * the dither vectors @xmath82 are generated independently from a uniform distribution over the fundamental voronoi region @xmath83 .      in this phase ,",
    "the common user and one other user transmit simultaneously using fdf based on lattice codes and the relay receives the sum of the signals , i.e. , at the @xmath84 time slot , users @xmath85 and @xmath86 transmit simultaneously .      in a certain time frame ,",
    "the message packet of the @xmath1 user is denoted by @xmath87    where , the elements @xmath88 are generated independently and uniformly over a finite field .",
    "similarly , the message packet of the @xmath62 user is given by @xmath89 for @xmath39 $ ] .    during a certain time frame ,",
    "in the @xmath90 time slot , the @xmath62 user and the @xmath1 user transmit their messages using lattice codes @xmath91 and @xmath92 , respectively , which can be given by @xcite :    [ eq : lattice_code ] @xmath93    where , @xmath94 and @xmath95 are the dither vectors for the @xmath62 and the @xmath1 user .",
    "the dither vectors are generated at the users and transmitted to the relay prior to message transmission in the multiple access phase @xcite .",
    "the relay receives the signal @xmath96 , where @xmath97    where @xmath98 is the zero mean complex awgn at the relay with noise variance @xmath99 per dimension and @xmath100 is the noise power .      in this phase , the relay broadcasts the decoded network coded message and each user receives it .",
    "the relay scales the received signal with a scalar coefficient @xmath101 @xcite and removes the dithers @xmath102 scaled by @xmath103 and @xmath104 , respectively .",
    "the resulting signal is given by    @xmath105\\mod\\lambda\\nonumber\\\\ & = [ \\sqrt{p}h_{i , r}^{t_s}x_i^{t_s , t}+\\sqrt{p}h_{\\ell",
    ", r}^{t_s } x_\\ell^{t_s , t}+(\\alpha-1)\\sqrt{p}(h_{i , r}^{t_s}x_i^{t_s , t}+ h_{\\ell , r}^{t_s}x_\\ell^{t_s , t})+\\alpha n_1-\\sqrt{p}h_{i , r}^{t_s}d_i-\\sqrt{p}h_{\\ell , r}^{t_s } d_\\ell]\\nonumber\\mod\\lambda\\nonumber\\\\ & = [ \\sqrt{p}h_{i , r}^{t_s}\\psi(w_i^t)+\\sqrt{p}h_{\\ell , r}^{t_s } \\psi(w_\\ell^{t_s , t})+n]\\mod\\lambda,\\end{aligned}\\ ] ]    where , @xmath106 and @xmath101 is chosen to minimize the noise variance @xcite .",
    "the relay decodes the signal in with a lattice quantizer @xcite to obtain an estimate @xmath107 which is a function of the messages @xmath108 and @xmath109 . since , for sufficiently large @xmath65 , pr@xmath110 approaches zero @xcite , @xmath111 .",
    "the relay then adds a dither @xmath112 with the network coded message which is generated at the relay and broadcast to the users prior to message transmission in the broadcast phase @xcite .",
    "then it broadcasts the resulting message using lattice codes , which is given as @xmath113 , where @xmath114 .",
    "the @xmath47 user receives @xmath115 , where @xmath116    and @xmath117 is the zero mean complex awgn at the user with noise variance @xmath118 per dimension . at the end of the broadcast phase",
    ", the @xmath47 user scales the received signal with a scalar coefficient @xmath119 and removes the dithers @xmath112 multiplied by @xmath120 .",
    "the resulting signal is    @xmath121\\mod\\lambda = & [ \\sqrt{p_r}h_{r , j}^{t_s}\\hat{v}^{t_s , t}_{i,\\ell}+(\\beta_j-1)\\sqrt{p_r}h_{r , j}^{t_s}\\hat{v}^{t_s , t}_{i,\\ell}+\\beta_jn_2]\\mod\\lambda   \\nonumber \\\\ & = [ \\sqrt{p_r}h_{r , j}^{t_s}\\hat{v}_{i,\\ell}^{t_s , t}+n']\\mod\\lambda,\\end{aligned}\\ ] ]    where , @xmath122 and @xmath119 is chosen to minimize the noise variance @xcite .",
    "the users then detect the received signal with a lattice quantizer @xcite and obtain the estimate @xmath123 @xmath124 , assuming that the lattice dimension is large enough such that pr@xmath125 approaches zero . after decoding all the network coded messages",
    ", each user performs message extraction of every other user by canceling self information .      for the common user ( @xmath62 user )",
    ", this message extraction involves simply subtracting the lattice point corresponding to its own message from the lattice network coded messages @xmath126 .",
    "the process can be shown as @xmath127 , \\ell\\neq i. \\ ] ]      for other users , the process is different from the common user . at first",
    ", the @xmath1 user subtracts the scaled lattice point corresponding to its own message , i.e. , @xmath128 from the network coded message received in the @xmath84 time slot ( i.e. , @xmath126 ) and extracts the message of the @xmath62 user as @xmath129 .",
    "after that , it utilizes the extracted message of the @xmath62 user to obtain the messages of other users in a similar manner .",
    "the message extraction process in this case can be shown as @xmath130,m\\neq i,\\ell.\\ ] ]",
    "in this section , we investigate common rate and sum rate of the mwrn with the proposed pairing scheme .",
    "we first analyze the snr of each user pair in a mwrn and use these results to obtain expressions for the achievable rates . for the rest of this paper",
    ", we simplify the notations by omitting the time slot superscript @xmath36 .      in a fdf mwrn",
    ", the decoding operation is performed after both the multiple access phase and the broadcast phase .",
    "thus , we need to consider the snr at the users and the snr at the relay , separately .",
    "the snr at the users have the same expressions for all the three pairing schemes .",
    "the signal transmission from the relay to any user @xmath50 $ ] is the same as that in a point - to - point fading channel .",
    "thus , the snr of the @xmath131)$ ] user s signal received at the @xmath47 user is given by : @xmath132 where , the numerator represents power of the signal part in and the denominator represents the power of the noise term @xmath133 in .      in a fdf mwrn based on lattice coding with the proposed pairing scheme , the snr of the received signal at the relay can be obtained from as @xmath134    where , the numerator represents the power of the signal part ( i.e. , @xmath135 in ) and the denominator represents the power of the noise terms @xmath136 in .    for the pairing scheme in @xcite , the snr received at the relay can be expressed as @xmath137    similarly , for the pairing scheme in @xcite , the snr at the relay is given by @xmath138    note that , and have the same form and differ in the indices of the channel coefficients , which is determined by the pairing scheme .",
    "common rate indicates the maximum possible information rate of the system that can be exchanged with negligible error .",
    "it can be a useful metric for the systems where all the users have the same amount of information to exchange @xcite . assuming lattice codes with sufficiently large dimensions are employed , the common rate for an @xmath4-user fdf mwrn is given by @xcite @xmath139}\\{r_{c,\\ell-1}\\},\\ ] ]    where , the factor @xmath140 is due to the fact that the complete message exchange requires @xmath31 time slots and @xmath141 is the achievable rate in the @xmath84 time slot , given by @xmath142    where , @xmath143 and @xmath144 are the maximum achievable rates at the @xmath84 time slot during the multiple access phase and the broadcast phase , respectively .",
    "next , we derive the upper bounds on the maximum achievable rates in the multiple access and broadcast phases .",
    "[ th : cap ] for the proposed pairing scheme in a fdf mwrn , the maximum achievable rate during the @xmath84 time slot in the multiple access phase is upper bounded by @xmath145    and the maximum achievable rate during the @xmath84 time slot in the broadcast phase is upper bounded by @xmath146}\\mid h_{j , r}\\mid^2p_r}{n_0}\\right).\\ ] ]    see appendix a.    note that the common rate for the pairing scheme in @xcite and in @xcite can be obtained by replacing the subscript @xmath85 with @xmath147 and @xmath148 , respectively in and using , and",
    ".    using theorem [ th : cap ] and substituting in and , the average common rate for the proposed pairing scheme can be given as in ,    @xmath149&\\leq \\frac{1}{2(l-1)}e\\left[\\log\\left(\\min\\left(\\frac{1}{1 + \\frac{\\mid h_{\\ell , r}\\mid^2}{\\mid h_{i , r}\\mid^2}}+\\frac{p\\mid h_{i , r}\\mid^2}{n_0},\\frac{1}{1+\\frac{\\mid h_{i , r}\\mid^2}{\\mid h_{\\ell , r}\\mid^2}}+\\frac{p\\mid h_{\\ell , r}\\mid^2}{n_0}\\right)\\right)\\right]\\label{eq : r1}\\\\ & \\leq \\frac{1}{2(l-1)}\\log \\left(e\\left[\\min\\left(\\frac{1}{1 + \\frac{\\mid h_{\\ell , r}\\mid^2}{\\mid h_{i , r}\\mid^2}}+\\frac{p\\mid h_{i , r}\\mid^2}{n_0},\\frac{1}{1+\\frac{\\mid h_{i , r}\\mid^2}{\\mid h_{\\ell , r}\\mid^2}}+\\frac{p\\mid h_{\\ell , r}\\mid^2}{n_0}\\right)\\right]\\right)\\label{eq : jensen}\\\\ & \\leq \\frac{1}{2(l-1)}\\log \\left(\\min\\left ( e\\left[\\frac{1}{1 + \\frac{\\mid h_{\\ell , r}\\mid^2}{\\mid h_{i , r}\\mid^2}}+\\frac{p\\mid h_{i , r}\\mid^2}{n_0}\\right],e\\left[\\frac{1}{1+\\frac{\\mid h_{i , r}\\mid^2}{\\mid h_{\\ell , r}\\mid^2}}+\\frac{p\\mid h_{\\ell , r}\\mid^2}{n_0}\\right]\\right)\\right)\\label{eq : mean}\\\\ & = \\frac{1}{2(l-1)}\\log\\left(\\min\\left(\\frac{1}{1 + \\frac{\\sigma _ { h_{\\ell , r}}^2}{\\sigma _ { h_{i , r}}^2}}+\\frac{p\\sigma_{h_{i , r}}^2}{n_0},\\frac{1}{1+\\frac{\\sigma _ { h_{i , r}}^2}{\\sigma _ { h_{\\ell , r}}^2}}+\\frac{p\\sigma_{h_{\\ell , r}}^2}{n_0}\\right)\\right),\\label{eq : rcnew}\\end{aligned}\\ ] ]    where the inequality in holds from jensen s inequality and",
    "the inequality comes from the fact that @xmath150\\leq e[a_1],e[a_2]$ ] , where @xmath151 are independent random variables .",
    "similarly , the average common rate for the pairing scheme in @xcite can be expressed as @xmath152\\leq \\frac{1}{2(l-1)}\\log\\left(\\min\\left(\\frac{1}{1 + \\frac{\\sigma _ { h_{\\ell , r}}^2}{\\sigma _",
    "{ h_{\\ell-1,r}}^2}}+\\frac{p\\sigma_{h_{\\ell-1,r}}^2}{n_0},\\frac{1}{1+\\frac{\\sigma _ { h_{\\ell-1,r}}^2}{\\sigma _",
    "{ h_{\\ell , r}}^2}}+\\frac{p\\sigma_{h_{\\ell , r}}^2}{n_0}\\right)\\right),\\ ] ]    and the average common rate for the pairing scheme in @xcite can be given as    @xmath153\\leq \\frac{1}{2(l-1)}&\\log\\left(\\min\\left(\\frac{1}{1 + \\frac{\\sigma _ { h_{\\ell-1,r}}^2}{\\sigma _ { h_{l-\\ell+2,r}}^2}}+\\frac{p\\sigma_{h_{l-\\ell+2,r}}^2}{n_0},\\frac{1}{1+\\frac{\\sigma _ { h_{l-\\ell+2,r}}^2}{\\sigma _ { h_{\\ell-1,r}}^2}}+\\frac{p\\sigma_{h_{\\ell-1,r}}^2}{n_0},\\right.\\right.\\nonumber\\\\ & \\left.\\left .",
    "\\frac{1}{1 + \\frac{\\sigma _ { h_{\\ell , r}}^2}{\\sigma _",
    "_ { h_{l-\\ell+2,r}}^2}{\\sigma _ { h_{\\ell , r}}^2}}+\\frac{p\\sigma_{h_{\\ell , r}}^2}{n_0}\\right)\\right).\\end{aligned}\\ ] ]    while @xmath30 do not provide tight upper bounds on the average common rate , they allow an analytical comparison of the proposed and existing pairing schemes .",
    "the main results from the analytical comparison are summarized in the propositions 1@xmath303 .",
    "note that in section [ sec : results ] , the actual expressions of the instantaneous rates are averaged over a large number of channel realizations to corroborate the insights presented in propositions 1@xmath303 .    [",
    "prop : eq_cap ] the average common rate for the proposed pairing scheme and the pairing schemes in @xcite and  @xcite are the same for the equal average channel gain scenario",
    ".    see appendix b.    [ prop : uneq_cap ] the average common rate for the proposed pairing scheme is larger than that of the pairing schemes in @xcite and @xcite for the unequal average channel gain scenario .",
    "see appendix b.    [ prop : var_cap ] the average common rate for the proposed pairing scheme is practically the same as that of the pairing schemes in @xcite and @xcite , for the variable average channel gain scenario .",
    "see appendix b.      the sum rate indicates the maximum throughput of the system . for a fdf mwrn",
    ", the sum rate can be defined as the sum of the achievable rates of all users for a complete round of information exchange .",
    "[ th : sum ] for the proposed pairing scheme in a fdf mwrn , the sum rate is given by : @xmath154    see appendix c.    note that the sum rate for the pairing scheme in @xcite and the pairing scheme in @xcite can be obtained by replacing the subscript @xmath85 with @xmath147 and @xmath148 , respectively in . using theorem [ th : sum ]",
    ", the average sum rate ( averaged over all channel realizations ) for the proposed pairing scheme can be given as in , using similar steps as in , and .",
    "@xmath155\\leq\\frac{1}{2(l-1)}\\sum_{\\ell=1 , \\ell\\neq i}^{l}\\left(\\log\\left(\\frac{1}{1+\\frac{\\sigma^2 _ { h_{\\ell , r}}}{\\sigma^2_{h_{i , r}}}}+\\frac{p\\sigma^2 _ { h_{i , r}}}{n_0}\\right)+\\log\\left(\\frac{1}{1+\\frac{\\sigma^2 _ { h_{i , r}}}{\\sigma^2_{h_{\\ell , r}}}}+\\frac{p\\sigma^2 _ { h_{\\ell , r}}}{n_0}\\right)\\right),\\label{eq : rsavg}\\end{aligned}\\ ] ]    similarly , the average sum rate for the pairing scheme in @xcite can be written as    and the average sum rate for the pairing scheme in @xcite can be written as    @xmath156&\\leq \\frac{1}{2(l-1)}\\sum_{\\ell=2}^{\\lfloor l/2\\rfloor+1}\\left(\\log\\left(\\frac{1}{1+\\frac{\\sigma^2 _",
    "{ h_{\\ell-1,r}}}{\\sigma^2_{h_{l-\\ell+2,r}}}}+\\frac{p\\sigma^2 _ { h_{l-\\ell+2,r}}}{n_0}\\right)+\\log\\left(\\frac{1}{1+\\frac{\\sigma^2 _ { h_{l-\\ell+2,r}}}{\\sigma^2_{h_{\\ell-1,r}}}}+\\frac{p\\sigma^2 _ { h_{\\ell-1,r}}}{n_0}\\right)\\right)\\nonumber\\\\ & + \\sum_{\\ell=\\lfloor l/2\\rfloor+2}^{l}\\left(\\log\\left(\\frac{1}{1+\\frac{\\sigma^2 _",
    "{ h_{\\ell , r}}}{\\sigma^2_{h_{l-\\ell+2,r}}}}+\\frac{p\\sigma^2 _ { h_{l-\\ell+2,r}}}{n_0}\\right)+\\log\\left(\\frac{1}{1+\\frac{\\sigma^2 _ { h_{l-\\ell+2,r}}}{\\sigma^2_{h_{\\ell , r}}}}+\\frac{p\\sigma^2 _ { h_{\\ell , r}}}{n_0}\\right)\\right).\\end{aligned}\\ ] ]",
    "@xmath30 provide upper bounds on the actual average sum rate and they allow an analytical comparison of the proposed and existing pairing schemes .",
    "the main results are summarized in propositions 4@xmath306 .",
    "note that similar to the case of common rate , in section [ sec : results ] , the actual expression for the instantaneous sum rate in is averaged over a large number of channel realizations to validate the insights presented in the propositions 4@xmath306 .",
    "[ prop : eq_sum ] the average sum rate of the proposed pairing scheme and the pairing schemes in @xcite and @xcite are the same for the equal average channel gain scenario .",
    "see appendix d.    [ prop : uneq_sum ] the average sum rate of the proposed pairing scheme is larger than that of the pairing schemes in @xcite and @xcite for the unequal average channel gain scenario .",
    "see appendix d.    [ prop : var_sum ] the average sum rate of the proposed pairing scheme is larger than that of the pairing schemes in @xcite and @xcite for the variable average channel gain scenario .",
    "see appendix d.",
    "in this section , we characterize the error performance of a fdf mwrn with the new pairing scheme . we provide the analytical derivations for @xmath0-qam modulation , which is a @xmath14 dimensional lattice code and",
    "is widely used in practical wireless communication systems .      in the @xmath0-qam modulated fdf mwrn system , during a certain time frame , in the @xmath90 time slot , the @xmath62 user and the @xmath1 user transmit their messages @xmath108 and @xmath157 which are @xmath0-qam modulated to @xmath158 and @xmath159 , respectively , where @xmath160 and @xmath161 .",
    "the relay receives the signal @xmath162 ( see ) and decodes it using ml criterion  @xcite and obtains an estimate @xmath163 of the network coded symbol @xmath164 as in @xcite .",
    "the relay then broadcasts the estimated network coded signal after @xmath0-qam modulation , which is given as @xmath165 .",
    "the @xmath47 ( @xmath50 $ ] ) user receives @xmath166 ( see ) and detects the received signal through ml criterion  @xcite to obtain the estimate @xmath167 .",
    "after decoding all the network coded messages , each user performs message extraction . for the common user ( @xmath62 user )",
    ", this message extraction involves subtracting its own message @xmath168 from the network coded messages @xmath167 and then performing the modulo-@xmath0 operation .",
    "the process can be shown as    @xmath169    for other users , the message extraction process can be shown as    @xmath170      in this subsection , we investigate the error performance of a fdf mwrn with the proposed pairing scheme . unlike the pairing schemes in @xcite and @xcite , the error performance of all the users is not the same for the proposed pairing scheme .",
    "hence , we need to obtain separate expressions for the error probabilities at the common user ( @xmath62 user ) and other users ( @xmath1 user ) .    first , we obtain the probability of incorrectly decoding a network coded message at the common user and the other users .",
    "since , any @xmath0-qam signal with square constellation ( i.e. , @xmath171 ) can be decomposed to two @xmath172-pam signals @xcite , the network coded signal from a linear combination of two @xmath0-qam signals can be decomposed to a network coded signal from two @xmath172-pam signals .",
    "thus , we can obtain the probability that the @xmath62 ( common ) user incorrectly decodes the network coded message involving its own message and the @xmath173 user s message , as : @xmath174    where @xmath175 is the probability of incorrectly decoding a network coded message resulting from the sum of two @xmath172-pam signals from the @xmath62 and the @xmath173 user and is derived in appendix e.    similarly , the probability that the @xmath1 ( other ) user incorrectly decodes the network coded message involving the @xmath62 user s message and its own message or other user s messages is given as : @xmath176,m\\neq i,\\ell$}. \\end{array } \\right.\\end{aligned}\\ ] ]    where @xmath177 is the probability of incorrectly decoding a network coded message , i.e. , the sum of two @xmath172-pam signals of the @xmath1 and the @xmath173 user and can be obtained from appendix e. using and , the average ser at the common user and the other users can be derived using the technique proposed in @xcite .",
    "the result is summarized in the following theorem .",
    "[ th : aber ] for the proposed pairing scheme in a fdf mwrn , the average ser at the @xmath62 ( common ) user is given by : @xmath178    and the average ser at the @xmath1 ( other ) users is given by : @xmath179    see appendix f.    from theorem [ th : aber ] , it can be identified that the average ser at the other ( @xmath1 ) users is at least twice compared to the average ser at the common ( @xmath62 ) user .",
    "this can be intuitively explained from the fact that the @xmath62 user needs to correctly decode only one network coded message ( @xmath180 ) to correctly decode the @xmath173 user s message .",
    "however , the @xmath1 user needs to correctly decode two network coded messages ( @xmath181 and @xmath182 ) to correctly decode the @xmath173 user s message .",
    "thus , the average ser at the other users would at least be twice compared to that at the common user .",
    "using theorem [ th : aber ] and the average ser result for the pairing scheme in @xcite , we can compare the performance of the proposed and the existing pairing schemes .",
    "note that the error performance of the pairing scheme in @xcite would be the same as the pairing scheme in @xcite , as the basic pairing process is the same for both these schemes and only the pairing orders are different .",
    "the main results are summarized in propositions 7@xmath309 .",
    "[ prop : eq_aber ] the average ser of an @xmath4-user fdf mwrn with the proposed pairing scheme is lower than the pairing scheme in @xcite by a factor of @xmath183 for the common user and a factor of approximately @xmath184 for other users under the equal average channel gain scenario .    see appendix g.    [ prop : uneq_aber ] the average ser of an @xmath4-user fdf mwrn with the proposed pairing scheme is always lower than the pairing scheme in @xcite for all users under the unequal average channel gain scenario .",
    "see appendix g.    [ prop : var_aber ] the average ser of an @xmath4-user fdf mwrn with the proposed pairing scheme is always lower than the pairing scheme in @xcite for all users under the variable average channel gain scenario .",
    "see appendix g.    from propositions [ prop : eq_aber]-[prop : var_aber ] , it is clear that choosing the user with the best average channel gain as the common user reduces the average ser of the fdf mwrn .",
    "in this section , we provide numerical results to verify the insights provided in propositions [ prop : eq_cap]@xmath30[prop : var_sum ] .",
    "we also provide simulation results to verify propositions [ prop : eq_aber]@xmath30[prop : var_aber ] .",
    "we consider an @xmath185 user fdf mwrn where each user transmits a packet of @xmath186 bits and uses @xmath187-qam modulation . the power at the users , @xmath43 and the power at the relay , @xmath44 are assumed to be equal and normalized to unity .",
    "the snr per bit per user is defined as @xmath188 . following @xcite , the average channel gain for the @xmath47 user",
    "is modeled by @xmath189 , where @xmath190 is the reference distance , @xmath191 is the distance between the @xmath47 user and the relay which is assumed to be uniformly randomly distributed between @xmath192 and @xmath190 , and @xmath193 is the path loss exponent , which is assumed to be @xmath10 .",
    "such a distance based channel model takes into account large scale path loss and has been widely considered in the literature @xcite .",
    "all distances , once chosen , remain constant for unequal channel gain scenario and are randomly chosen every time frame ( i.e. , worst case , @xmath194 ) for variable channel gain scenario .",
    "note that all the distances are the same for the equal average channel gain scenario .",
    "all results are averaged over @xmath195 time frames .",
    "[ fig : fig5 ] shows the common rate for the proposed and the existing pairing schemes in an @xmath185 user fdf mwrn .",
    "all the numerical results are obtained by averaging the instantaneous common rates for the pairing schemes over a large number of channel realizations .",
    "[ fig : su1 ] shows that all the pairing schemes have the same average common rate in equal average channel gain scenario , which verifies proposition [ prop : eq_cap ] .",
    "the common rate of the proposed pairing scheme is larger than the existing pairing schemes for the unequal average channel gain scenario in fig .",
    "[ fig : su2 ] .",
    "this is because , scaling the common user s power to ensure transmission fairness decreases the ratio of the maximum and the minimum average channel gains in , resulting in a larger common rate . for variable average channel gain scenario",
    ", we can see that the common rate for the proposed scheme is practically the same as that of the existing pairing schemes .",
    "this verifies propositions [ prop : uneq_cap ] and [ prop : var_cap ] , respectively .",
    "[ fig : fig6 ] shows the sum rate for the proposed and the existing pairing schemes in an @xmath185 user fdf mwrn for the three channel scenarios .",
    "all the numerical results are obtained by averaging the instantaneous sum rates for the pairing schemes over a large number of channel realizations .",
    "[ fig : su4 ] shows that all the pairing schemes have the same average sum rate for equal average channel gain scenario , which verifies proposition [ prop : eq_sum ] . similarly , fig . [",
    "fig : su5 ] and fig .",
    "[ fig : su6 ] show that the average sum rate for the proposed pairing scheme is larger than the existing pairing schemes , which is in line with the propositions [ prop : uneq_sum ] and [ prop : var_sum ] .",
    "intuitively , this can be explained as follows . in the proposed pairing scheme ,",
    "the common user with the maximum average channel gain transmits more times than the other users . unless all the average channel gains are equal , this results in a larger sum rate compared to the existing pairing schemes .      to illustrate robustness of the proposed pairing scheme , we consider two special cases of the variable average channel gain scenario , where ( i ) @xmath196 of the users have distances below @xmath197 ( i.e. , only a small proportion of the users are close to the relay and so , they have good channel conditions ) and ( ii ) @xmath198 of the users have distances below @xmath197 ( i.e. , a large proportion of users have good channel conditions ) .",
    "[ fig : su7 ] plots the average common rate and fig .",
    "[ fig : su8 ] plots the average sum rate for the proposed and existing pairing schemes .",
    "we can see from fig .",
    "[ fig : su7 ] that the common rate does not change much when either @xmath196 or @xmath198 of users have good channel conditions as it depends upon the minimum average channel gain in the system .",
    "however , we can see from fig .",
    "[ fig : su8 ] that when the number of users with good channel conditions falls from @xmath198 to @xmath196 , the sum rate of the proposed scheme degrades to a much lesser extent , compared to the existing pairing schemes .",
    "this is because the average sum rate of the proposed pairing scheme depends to a greater extent on the common user s average channel gain compared to the other users average channel gain ( as evident from ) .",
    "however , for the existing pairing schemes , the sum rate depends on all the channel gains equally ( as evident from and ) and degrades to a greater extent .",
    "this illustrates the robustness of the proposed pairing scheme .",
    "figures [ fig : su9 ] , [ fig : su10 ] and [ fig : su11 ] plot the average ser of the proposed and the existing pairing schemes in an @xmath185 user fdf mwrn for equal channel gain scenario ( fig .",
    "[ fig : su9 ] ) , unequal channel gain scenario ( fig .",
    "[ fig : su10 ] ) and variable channel gain scenario ( fig .",
    "[ fig : su11 ] ) .",
    "we can see from all the figures that the simulation results match perfectly with the analytical results at mid to high snrs .",
    "this verifies the accuracy of theorem [ th : aber ] .",
    "note that the existing pairing schemes in @xcite and @xcite have the same average ser .",
    "so , only the results for pairing scheme in @xcite have been shown in the above figures .",
    "figures [ fig : su9 ] , [ fig : su10 ] and [ fig : su11 ] show that the proposed pairing scheme outperforms the existing pairing schemes , in terms of average ser , which verifies propositions [ prop : eq_aber]-[prop : var_aber ] .",
    "in addition , fig .",
    "[ fig : su9 ] shows that the average ser at the common user and other users are @xmath15 times and nearly @xmath199 times less than that of the existing pairing schemes .",
    "this verifies the insight presented by remark 1 and proposition [ prop : eq_aber ] .",
    "[ fig : su12 ] plots the average ser of the proposed and the existing pairing schemes for the special cases of the variable average channel gain scenario when ( i ) @xmath196 of the users",
    "have distances below @xmath197 and ( ii ) @xmath198 of the users have distances below @xmath197 .",
    "the figure shows that the average ser for the existing pairing schemes worsens by a larger extent compared to that of the proposed scheme with the degradation in the users channel conditions . for the proposed pairing scheme ,",
    "when the number of users with good channel conditions increases from @xmath196 to @xmath198 , the average ser at other users improve significantly and approaches the average ser at the common user .",
    "this is because the average ser at the @xmath1 user depends not only on its own channel conditions , but also the channel conditions of the common ( @xmath62 ) user and the @xmath173 user ( see ) .",
    "this improvement in the overall channel conditions results in improvement in the average ser , which illustrates the superiority of the proposed pairing scheme .",
    "in this paper , we have proposed a novel user pairing scheme in a fdf mwrn .",
    "we have derived the upper bound on the average common rate ( theorem [ th : cap ] ) and the average sum rate ( theorem [ th : sum ] ) and the asymptotic average ser ( theorem [ th : aber ] ) for the proposed pairing scheme .",
    "we have analyzed the results in theorems [ th : cap]-[th : aber ] to compare the performance of the proposed scheme with existing pairing schemes under different channel scenarios .",
    "the main insights are summarized in propositions [ prop : eq_cap]-[prop : var_aber ] .",
    "our analysis shows that the proposed pairing scheme improves the aforementioned performance metrics compared to that of the existing pairing schemes for different channel conditions .",
    "in the proposed pairing scheme , the @xmath62 and the @xmath1 user transmit simultaneously in the @xmath84 time slot in the multiple access phase .",
    "also , in the broadcast phase , in the @xmath84 time slot , the relay broadcasts the decoded network coded message to all the users . for the _ multiple access phase _",
    ", the optimum values of @xmath101 and @xmath119 in and , respectively , are obtained by setting @xmath200 and @xmath201 , where @xmath136 and @xmath133 are given in and , respectively . from this , we obtain @xmath202 and @xmath203 . substituting these values in and , and can be derived following the steps in @xcite and @xcite , which are summarized as follows .",
    "first , we assume that there exists a rate @xmath204 for which pr@xmath110 ( see ) is upper bounded by @xmath205 , where @xmath206 is the poltyrev exponent , @xmath207 @xcite is the volume to noise ratio of the lattice @xmath69 with respect to the noise @xmath136 , @xmath208 indicates that the difference between @xmath209 and @xmath210 is a first degree function of @xmath65 and @xmath69 is poltyrev - good @xcite .",
    "then calculating @xmath209 and comparing with @xmath211 gives in theorem  [ th : cap ] .",
    "for the _ broadcast phase _ , in theorem",
    "[ th : cap ] can be obtained from the point to point channel of the users .",
    "the details are omitted here for the sake of brevity .",
    "this completes the proof .",
    "_ proof of proposition 1 : _ for the equal average channel gain scenario , @xmath212 .",
    "thus , the average common rate expressed by , and becomes the same for all the three pairing schemes .",
    "this proves proposition [ prop : eq_cap ] .",
    "_ proof of proposition 2 : _ for unequal average channel gain scenario , as explained in section  [ sec : pairing ] , the transmit power of the @xmath62 user needs to be scaled by @xmath34 to ensure transmission fairness . as a result",
    ", @xmath213 can be replaced by @xmath214 in . in addition , for a fair comparison with the existing pairing schemes , the transmit power @xmath43 in the proposed scheme , needs to be multiplied by a factor @xmath215 .",
    "this is because in the proposed pairing scheme , the common user transmits @xmath34 times with power @xmath216 and the other @xmath34 users transmit once with power @xmath43 .",
    "hence , the average power per user becomes @xmath43 .",
    "however , for the existing pairing schemes , the average power per user is @xmath217 .",
    "overall , can be modified by scaling @xmath218 with @xmath31 and replacing @xmath43 with @xmath219 .",
    "thus , the average common rate in is    @xmath220\\leq \\frac{1}{2(l-1)}\\log\\left(\\min\\left(\\frac{1}{1 + \\frac{(l-1)\\sigma _ { h_{\\ell , r}}^2}{\\sigma _ { h_{i , r}}^2}}+\\frac{(2l-2)p\\sigma_{h_{i , r}}^2}{(l-1)n_0},\\frac{1}{1+\\frac{\\sigma _ { h_{i , r}}^2}{(l-1)\\sigma _ { h_{\\ell , r}}^2}}+\\frac{(2l-2)p\\sigma_{h_{\\ell , r}}^2}{n_0}\\right)\\right).\\ ] ]    we consider two cases :    * _ case 1 _ : @xmath221 . in this case , the second quantity in the right hand side of will be the minimum .",
    "then , comparing and shows that @xmath222 .",
    "thus , the average common rate for scheme @xcite will be smaller than that for the proposed pairing scheme , when @xmath223 .",
    "similarly , it can be shown that for the pairing scheme in @xcite , the average common rate is smaller than that for the proposed scheme for @xmath224 . * _ case 2 _ : @xmath225 . in this case , the first quantity in the right hand side of will be the minimum . then comparing and shows that the common rate of scheme @xcite will be smaller than that of the proposed pairing scheme , when @xmath226 .",
    "similarly , it can be shown that for the pairing scheme in @xcite , the average common rate is smaller than that of the proposed scheme for @xmath227 .    combining the result from the two cases , the proposed pairing scheme will have larger average common rate compared to the two other pairing schemes , which proves proposition [ prop : uneq_cap ] .",
    "_ proof of proposition 3 : _ for the variable channel gain scenario , @xmath218 in is the largest average channel gain in the system .",
    "thus , from , it can be shown that @xmath228 and the second quantity in the right hand side of the inequality in is the minimum . then comparing and",
    "would show that @xmath229 .",
    "similarly , from and , it can be shown that @xmath230 and @xmath231 .",
    "however , the impact of either of these ratios on the overall average common rate is small compared to that of the term @xmath232 in , and .",
    "thus , the common rate for the proposed scheme will be practically the same as that of the existing pairing schemes in @xcite and @xcite , which proves proposition [ prop : var_cap ] .",
    "the achievable rate at the @xmath84 time slot can be obtained from . since , @xmath233 , the achievable rate at the @xmath84 time slot will be determined by the achievable rate at the corresponding time slot in the multiple access phase .",
    "then , obtaining the achievable rate in all the time slots and adding them results into .",
    "the detailed steps are omitted here for the sake of brevity .",
    "_ proof of proposition 4 : _ for the equal average channel gain scenario , @xmath212 .",
    "thus , the sum rates expressed by , and become the same for all the three pairing schemes , which proves proposition [ prop : eq_sum ] .",
    "_ proof of proposition 5 : _ for the unequal average channel gain scenario , if the common user is made to transmit at all the time slots with scaled power , the sum rate can be obtained from with @xmath218 scaled by @xmath31 and @xmath43 replaced with @xmath219 . in this case , the average sum rate in becomes    @xmath234&=\\frac{1}{2(l-1)}\\sum_{\\ell=1 , \\ell\\neq i}^{l}\\left(\\log\\left(\\frac{1}{1+\\frac{(l-1)\\sigma^2 _ { h_{\\ell , r}}}{\\sigma^2_{h_{i , r}}}}+\\frac{(2l-2)p\\sigma^2 _ { h_{i , r}}}{(l-1)n_0}\\right)+\\log\\left(\\frac{1}{1+\\frac{\\sigma^2 _ { h_{i , r}}}{(l-1)\\sigma^2_{h_{\\ell , r}}}}+\\frac{(2l-2)p\\sigma^2 _ { h_{\\ell , r}}}{n_0}\\right)\\right).\\end{aligned}\\ ] ]    comparing and shows that @xmath235 and @xmath236 . in a similar manner",
    ", it can be shown that the average sum rate of the proposed scheme is larger than that of the scheme in @xcite .",
    "this completes the proof for proposition [ prop : uneq_sum ] .",
    "_ proof of proposition 6 : _ for the variable average channel gain scenario , we have @xmath237 .",
    "hence , it is clear that @xmath238 .",
    "similarly , it can be shown that @xmath239 . thus the proposed pairing scheme will have a larger average sum rate ( given by ) ,",
    "compared to that of the pairing schemes in @xcite and @xcite ( given by and , respectively ) .",
    "this proves proposition [ prop : var_sum ] .",
    "in this appendix , we derive the probability of incorrectly decoding a pam network coded signal by building on the symbol mapping idea in @xcite .",
    "we detail the necessary steps to obtain an exact expression for use in the analysis .",
    "we assume @xmath172-pam signals at the @xmath62 and the @xmath173 users , such that the users signals can take values from the set @xmath240 and we denote each element of the set @xmath241 as @xmath242 .",
    "the true network coded signal resulting from the sum of the @xmath172-pam signals have a constellation with @xmath243 points , which takes values from the set @xmath244 . in a noiseless environment , the relay maps the network coded signal to a @xmath172-pam signal @xmath242 in such a way that the same network coded signal",
    "is not mapped to different elements of @xmath241 ( i.e. , there is no ambiguity ) .",
    "this can be ensured by mapping the network coded signal into modulo-@xmath172 sum of the actual symbols at the @xmath62 and the @xmath173 user . in a noisy environment , the relay maps the network coded signal into @xmath245 and broadcasts to the users , who decode the signal as @xmath246 .",
    "the end - to - end probability of incorrectly detecting a network - coded signal resulting from @xmath172-pam signals , can be obtained from the sum of the off - diagonal elements of the product of two @xmath247 matrices @xmath248 and @xmath249 , with elements @xmath250 and @xmath251 , respectively , where @xmath252 $ ] , multiplied by the factor @xmath172 .",
    "that is ,    @xmath253    the coefficients @xmath254 can be obtained by calculating the probability that the signal received at the relay whose mean ( which takes value from the set @xmath255 ) should be mapped to @xmath256 , falls in the decision region for the signal whose mean is mapped to @xmath257 .",
    "thus , @xmath254 can be expressed as the sum of @xmath258-functions , as follows :    @xmath259    where , @xmath260 represents the snr of the @xmath62 and the @xmath173 users signal at the relay for @xmath0-qam modulation and can be obtained as    @xmath261    where @xmath262 is the average energy of symbols for @xmath172-pam modulation ( e.g. , @xmath263 for @xmath264 ) .    similarly , the coefficients @xmath265 can be obtained by calculating the probability that the signal received at the @xmath62 user with mean @xmath266 , falls in the decision region for the signal with mean @xmath267 .",
    "thus ,    @xmath268    where @xmath269 represents the snr at the @xmath62 user . the coefficients @xmath270 and @xmath271 for @xmath264 ( or @xmath272 ) , have been tabulated in table [ table : ab ] .",
    "@xmath273 & & @xmath274 & @xmath275 & @xmath276 & @xmath277 & & @xmath278 & @xmath279 & @xmath280 & @xmath281 + & @xmath282 & @xmath283 & @xmath11 & @xmath192&@xmath284 & & & & & + & @xmath285 & 0 & @xmath286 & @xmath287 & @xmath288 & & & & & + & @xmath289 & 0 & @xmath284 & @xmath286 & @xmath290 & & & & & + & @xmath291 & @xmath11 & @xmath288 & @xmath192 & @xmath292 & & & & & + & @xmath293 & @xmath292 & @xmath290 & @xmath192 & @xmath192 & & & & & + & @xmath294 & 0 & @xmath292 & @xmath290 & @xmath192 & & & & & + & @xmath282 & @xmath11 & @xmath11 & @xmath192&@xmath192 & & & & & + & @xmath285 & -1/2 & @xmath192 & @xmath295 & @xmath11 & & & & & + & @xmath289 & 1/2 & @xmath192 & @xmath296 & @xmath286 & & & & & + & @xmath291 & @xmath295 & @xmath11 & @xmath295 & @xmath192 & & & & & + & @xmath293 & @xmath296 & @xmath286 & @xmath296 & @xmath192 & & & & & + & @xmath294 & 0 & @xmath192 & @xmath192 & @xmath192 & & & & & + & @xmath282 & @xmath11 & @xmath11 & @xmath283&@xmath284 & & & & & + & @xmath285 & 7/4 & @xmath286 & @xmath192 & @xmath288 & & & & & + & @xmath289 & -1 & @xmath284 & @xmath192 & @xmath290 & & & & & + & @xmath291 & @xmath192 & @xmath288 & @xmath11 & @xmath292 & & & & & + & @xmath293 & @xmath192 & @xmath290 & @xmath292 & @xmath192 & & & & & + & @xmath294 & @xmath290 & @xmath292 & @xmath192 & @xmath192 & & & & & + & @xmath282 & @xmath11 & @xmath192 & @xmath11&@xmath297 & & & & & + & @xmath285 & -1 & @xmath14 & @xmath286 & @xmath192 & & & & & + & @xmath289 & 1 & @xmath297 & @xmath11 & @xmath192 & & & & & + & @xmath291 & @xmath192 & @xmath192 & @xmath192 & @xmath192 & & & & & + & @xmath293 & @xmath192 & @xmath192 & @xmath192 & @xmath192 & & & & & + & @xmath294 & @xmath192 & @xmath192 & @xmath192 & @xmath192 & & & & & +",
    "the proof follows the steps outlined in @xcite , which are applicable to any user pairing scheme . however , for the proposed pairing scheme , we need to modify these steps to take into account different error probabilities at the common user and the other users .",
    "the modified steps can be summarized as follows :    1 .",
    "determine the probabilities that the @xmath62 user and the @xmath1 user incorrectly decode a network coded message , respectively .",
    "2 .   define the possible error cases for the @xmath298)$ ] error event at the @xmath62 and the @xmath299user , where the @xmath300 error event means that exactly @xmath301 number of users messages are incorrectly decoded .",
    "3 .   express the probabilities of the aforementioned error cases in terms of the probabilities of incorrectly decoding a network coded message .",
    "4 .   combine the probabilities of different error cases to determine the probability of the @xmath300 error event at the @xmath62 and the @xmath1 user .",
    "5 .   obtain the expected probability of all the error events to determine the exact average ser expression .",
    "apply the high snr approximation to obtain approximate but accurate average ser expressions .",
    "now , we illustrate these steps in detail : + _ _ : the probabilities of incorrectly decoding a network coded message at the @xmath62 and the @xmath1 user are obtained in and , respectively .    _ _ : in the proposed pairing scheme , @xmath301 error events can occur in two cases    * @xmath302 : if the decoding user incorrectly extracts exactly @xmath301 users messages except the @xmath62 user s message .",
    "that is , the decoding user ( @xmath47 user , where @xmath50 $ ] ) incorrectly decodes @xmath301 network coded messages @xmath303 and correctly decodes the remaining @xmath304 network coded messages , where @xmath305 , m_1\\neq m_2\\neq ... \\neq m_k\\neq j$ ] . *",
    "@xmath306 : if the decoding user incorrectly decodes exactly @xmath301 users messages including the @xmath62 user s message .",
    "this happens when the decoding user ( @xmath1 user , where @xmath307 , \\ell\\neq i$ ] ) incorrectly decodes @xmath182 and correctly decodes @xmath308 other network coded messages , @xmath309 and incorrectly decodes the remaining @xmath304 messages , where @xmath310 , m_1\\neq m_2\\neq ... \\neq m_{k-1}\\neq i,\\ell$ ] .",
    "note that , the error case @xmath302 is applicable both for the common user and the other users .",
    "however , case @xmath306 is applicable only for users except the common user . _ _ : the probabilities of the aforementioned error cases for the @xmath62 and the @xmath1 users are    @xmath311 @xmath312 @xmath313    _ _ : the probability of @xmath301 error events for the @xmath62 and the @xmath1 user can be expressed as @xmath314 _ _ : since , each user decodes @xmath31 other users messages in an @xmath4-user mwrn , there are @xmath31 possible error events . thus , averaging over all the possible error events , the average ser at the @xmath62 and the @xmath1 user can be obtained as : @xmath315 _ _ : at high snr , the higher order error terms in can be neglected .",
    "thus , @xmath316 and @xmath317 for @xmath318 ( see and ) .",
    "similarly , @xmath319 for @xmath320 ( see ) .",
    "thus , at high snr , can be approximated as @xmath321 in addition , at high snr , we can approximate the terms @xmath322 , @xmath323 and @xmath324 in , and to be @xmath11 .",
    "thus , substituting , and in , the average ser at the @xmath62 and the @xmath1 user at high snr can be expressed as    @xmath325    finally , replacing @xmath326 with @xmath327 in the above equation completes the proof .",
    "_ proof of proposition 7 : _ for the equal average channel gain scenario , the error probabilities @xmath328 for all @xmath50 $ ] .",
    "thus , the average ser expressions in and for the proposed pairing scheme can be simplified as : @xmath329 the average ser for the scheme in @xcite can be given by @xcite : @xmath330      _ proof of proposition 8 : _ for the unequal average channel gain scenario , the average ser expressions for the proposed pairing scheme is given by and , with @xmath331 and @xmath332 .",
    "for the scheme in @xcite , the average ser at the @xmath333)$ ] user can be written as @xmath334        * _ case 1 _ : @xmath337>e[\\mid h_{m , r}\\mid^2]$ ] . in this case , + thus , @xmath338\\geq e[\\gamma_r(m)]$ ] . *",
    "_ case 2 _ : @xmath337<e[\\mid h_{m , r}\\mid^2]$ ] . in this case , @xmath339\\leq e[\\frac{(2l-2)p\\mid h_{i , r}\\mid^2}{5(l-1)n_0}]$ ] and since , @xmath340 , @xmath341 $ ] @xmath342 $ ] . thus , @xmath338\\geq e[\\gamma_r(m)]$ ] .    from the above cases , the probability @xmath343 and @xmath344 for the proposed scheme would be larger than @xmath345 for scheme @xcite .",
    "thus , comparing , and shows that the average ser for the proposed scheme would be smaller than that for scheme @xcite .",
    "this proves proposition [ prop : uneq_aber ] .",
    "_ proof of proposition 9 : _ for the variable average channel gain scenario , the average ser expression for the proposed pairing scheme is given by and .",
    "the average ser for the pairing scheme in @xcite is the same as in .",
    "now , comparing @xmath343 ( from ) , @xmath344 ( from ) and @xmath345 ( from ) shows that the only terms which are different in all these probabilities are @xmath260 and @xmath346 . note that , if @xmath347>e[\\mid { h}_{m+1,r}\\mid^2]$ ] , then @xmath348\\geq e[\\min(\\mid { h}_{m+1,r}\\mid^2,\\mid { h}_{m , r}\\mid^2)]$ ] .",
    "thus , @xmath338\\geq e[\\gamma_r(m)]$ ] and in effect , from , and , the error probability for the new pairing scheme would be less than that for scheme @xcite . as a result , the average ser for the proposed scheme is less than that of scheme @xcite ( in ) for both @xmath349 and @xmath350 , which proves proposition [ prop : var_aber ] .",
    "y.  ma , t.  huang , j.  li , j.  yuan , z.  lin , and b.  vucetic , `` novel nested convolutional lattice codes for multi - way relaying systems over fading channels , '' in _ proc .",
    "ieee wcnc _ , apr .",
    "2013 , pp .",
    "26712676 .",
    "a.  yang , z.  fei , c.  xing , m.  xiao , j.  yuan , and j.  kuang , `` design of binary network codes for multiuser multiway relay networks , '' _ ieee trans .",
    "_ , vol .",
    "62 , no .  8 , pp . 37863799 , oct .",
    "2013 .",
    "j.  n. laneman , d.  n.  c. tse , and g.  w. wornell , `` cooperative diversity in wireless networks : efficient protocols and outage behavior , '' _ ieee trans .",
    "inf . theory _",
    "50 , no .  12 , pp .",
    "30623080 , dec . 2004 .",
    "w.  xu , x.  dong , and w .- s .",
    "lu , `` joint precoding optimization for multiuser multi - antenna relaying downlinks using quadratic programming , '' _ ieee trans .",
    "_ , vol .",
    "59 , no .  5 , pp .",
    "12281235 , may 2011 .",
    "j.  zhang , f.  roemer , m.  haardt , a.  khabbazibasmenj , and s.  vorobyov , `` sum rate maximization for multi - pair two - way relaying with single - antenna amplify and forward relays , '' in _ proc .",
    "icassp _ , mar .",
    "2012 , pp .",
    "24772480 .",
    "n.  yang , p.  yeoh , m.  elkashlan , i.  collings , and z.  chen , `` two - way relaying with multi - antenna sources : beamforming and antenna selection , '' _ ieee trans .",
    "_ , vol .",
    "61 , no .  9 , pp .",
    "39964008 , nov . 2012 .",
    "r.  h.  y. louie , y.  li , and b.  vucetic , `` practical physical layer network coding for two - way relay channels : performance analysis and comparison , '' _ ieee trans .",
    "wireless commun .",
    "_ , vol .  9 , no .  2 , pp . 764777 , feb . 2010",
    "z.  zhao , z.  ding , m.  peng , w.  wang , and k.  k. leung , `` a special case of multi - way relay channel : when beamforming is not applicable , '' _ ieee trans .",
    "wireless commun .",
    "_ , vol .  10 , no .  7 , pp . 20462051 , jul",
    ". 2011 .",
    "r.  chang , s .-",
    "lin , and w .- h .",
    "chung , `` symbol and bit mapping optimization for physical - layer network coding with pulse amplitude modulation , '' _ ieee trans .",
    "wireless commun .",
    "_ , vol .  12 , no .  8 , pp .",
    "39563967 , aug .",
    "f.  tabataba , p.  sadeghi , c.  hucher , and m.  pakravan , `` impact of channel estimation errors and power allocation on analog network coding and routing in two - way relaying , '' _ ieee trans .",
    "_ , vol .",
    "61 , no .  7 , pp . 32233239 , sep ."
  ],
  "abstract_text": [
    "<S> in this paper , we consider a functional decode and forward ( fdf ) multi - way relay network ( mwrn ) where a common user facilitates each user in the network to obtain messages from all other users . </S>",
    "<S> we propose a novel user pairing scheme , which is based on the principle of selecting a common user with the best average channel gain . </S>",
    "<S> this allows the user with the best channel conditions to contribute to the overall system performance . assuming lattice code based transmissions , we derive upper bounds on the average common rate and the average sum rate with the proposed pairing scheme </S>",
    "<S> . considering @xmath0-ary quadrature amplitude modulation with square constellation as a special case of lattice code transmission , we derive asymptotic average symbol error rate ( ser ) of the mwrn . </S>",
    "<S> we show that in terms of the achievable rates , the proposed pairing scheme outperforms the existing pairing schemes under a wide range of channel scenarios . </S>",
    "<S> the proposed pairing scheme also has lower average ser compared to existing schemes . </S>",
    "<S> we show that overall , the mwrn performance with the proposed pairing scheme is more robust , compared to existing pairing schemes , especially under worst case channel conditions when majority of users have poor average channel gains .    </S>",
    "<S> multi - way relay network , functional decode and forward , pairing scheme , wireless network coding . </S>"
  ]
}