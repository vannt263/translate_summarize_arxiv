{
  "article_text": [
    "scientific research progress is critically based on the correct exploitation of data obtained at the limit of the technological capabilities . thus prior to data",
    "analysis and interpretation , the quality of the data treatment must be assured in order to guarantee that the information content in that data is preserved . in observational astrophysics , and",
    "in particular imaging with ground - based telescopes , data treatment is performed following data reduction procedures .",
    "the main goal of such reduction processes is to minimize the influence of data acquisition imperfections on the estimation of the desired astronomical measurements ( see e.g.  @xcite for a short review on noise sources and reduction processes of ccd data ) .",
    "for this purpose , one must perform appropriate manipulations of data and calibration frames , the latter properly planned and obtained to facilitate the reduction procedure . in this sense , image flatfielding and sky subtraction constitute two of the most common and important reduction steps .",
    "their relevance should not be underestimated , since inadequate flatfielding or sky subtraction easily leads to the introduction of systematic uncertainties in the data .",
    "contrary to random errors , which can be controlled by applying normal statistical methods , the systematic uncertainties can propagate hidden within the arithmetically manipulated data to the final measurements , where their impact may considerably bias their interpretation .    concerning image flatfielding ,",
    "the corresponding calibration frames needed to proceed through this reduction step are typically divided into two categories : images intended to provide high - frequency scale sensitivity variations ( the pixel - to - pixel response ) , and images whose goal is to facilitate the removal of the two - dimensional low - frequency scale sensitivity variations of the detectors .",
    "the former are usually obtained from continuum lamps ( either within the instrument itself or by illuminating a flat screen or the inner dome of the telescope ) , although the colour of such lamps are not expected to match the spectral energy distributions of the science targets , and ideally dark night sky flats , obtained by pointing the telescope to a _ blank field _ should be observed instead .",
    "since this is quite expensive in terms of observing time , this approach is very rarely used .",
    "the low - frequency flatfields are usually twilight exposures .",
    "the problem here is that the time during which the sky surface brightness is high enough to clearly overpass the signal of any star in the field of view , but not too high to saturate the frames , are placed on two time windows every day , one at the beginning of the evening twilight and the other at the end of the morning twilight .",
    "the observational strategy typically consist on obtaining a series of images , shifting the telescope position a few arcseconds between the different exposures in order to avoid the bright stars in the field of view to appear in the same detector pixels .",
    "those pixels are afterwards masked when combining the individual exposures during the reduction procedure . in any case",
    "very bright stars need to be avoided since the point spread function of these objects can introduce spikes and artifacts that are not so easily removed during the reduction of the flatfield images . for this purpose",
    "the use of _ blank fields _ is the best option .",
    "sky subtraction can not always be performed by measuring the night sky level in the same frame where the scientific targets are present .",
    "this is especially true when the target dimensions are comparable to the detector field of view . in that circumstance separate sky frames are observed , by pointing the telescope to a position devoid of stars as much as possible . for the sky subtraction procedure to be successful ,",
    "it is essential that these separate sky images are obtained under identical observing conditions , i.e.  very close in time and sky position , since this is the only way to prevent varying observing conditions that modify the sky surface brightness .    from the above discussion",
    "it is clear that the observation of sky regions devoid of stars down to a given magnitude is a very important aspect to be taken into account when carrying out astronomical observations .",
    "to date , no systematic catalogue is available providing the location in the sky of blank fields for varying limiting magnitudes . with modern instrumentation intended to be used in large imaging surveys",
    ", the problem is expected to become more demanding . the situation is also starting to be important in spectroscopic observations , since the advent of integral field units with high multiplexing capabilities ( and thus , increasingly larger field of view ) ,",
    "are expected to be one of the most common instrumentation in ground - based observatories .",
    "the work presented in this paper describes a method that helps to determine the availability of blank fields in any region of the celestial sphere , based on the use of the delaunay triangulation .",
    "the method has been employed to generate catalogues of blank fields to varying limiting magnitudes . in order to facilitate the use of these catalogues ,",
    "we have created tesela , a new tool accessible through the web which provides a simple interface that allows the user to retrieve the list of blank fields available near a given position in the sky .",
    "section  [ section : tessellating - the - sky ] of this paper describes the method and presents some statistical analysis of its application to the @xcite catalogue .",
    "section  [ section : tesela ] describes the new tool tesela . the detailed description of the tessellation of sky subregions is presented in the appendix .",
    "the delaunay triangulation @xcite is a subdivision of a geometric object ( e.g.  a surface or a volume ) into a set of simplices . a simplex , or @xmath0-simplex to be specific ,",
    "is the @xmath0-dimensional analogue of a triangle .",
    "more precisely , a simplex is the convex hull ( convex envelope ) of a set of @xmath1 points .    in particular , for the euclidean planar ( 2-dimensional ) case , given a set of points ,",
    "also called nodes , the delaunay triangulation becomes a subdivision of the plane into triangles , whose vertices are nodes . for each of these triangles , it is possible to determine its associated circumcircle , the circle passing exactly through the three vertices of the triangle , and whose center , the circumcentre , can easily be computed as the intersection of the three perpendicular bisectors .",
    "interestingly , in a delaunay triangulation all the triangles satisfy the _ empty circumcircle interior property _ , which states that all the circumcircles are empty , i.e. , there are no nodes inside any of the computed circumcircles .",
    "fortunately the delaunay triangulation is not restricted to the euclidean 2-dimensional case .",
    "it can be applied to other surfaces , in particular to the 2-dimensional surface of a 3-dimensional sphere . in this situation",
    ", the tessellation of the spherical surface is built with spherical triangles , i.e. , triangles on the sphere whose sides are great circles .",
    "the empty circumcircle interior property of the delaunay triangulation provides a straightforward method for a systematic search of regions in the celestial sphere free from stars .",
    "if one computes the delaunay triangulation in the 2-dimensional surface of a sphere , using as nodes the location of the stars down to a given threshold visual magnitude ( @xmath2 ) , the above property guarantees that all the circumcircles are void of stars brighter than that magnitude ( see fig .",
    "[ ini - triangulation ] ) .",
    "thus , the circumdiameter of every circumcircle determines the maximum field of view that can be employed in that region of the sky as blank field .        in this work",
    "we have applied the delaunay triangulation to the stellar catalogue . contains astrometric and photometric information for the 2.5  million brightest stars in the sky , and it is complete up to magnitude _ v _  =  11.5  mag .",
    "photometric data consists of two pass - bands ( _ b@xmath3 _ and _ v@xmath3 _ , close to johnson b and  v ; @xcite ) .",
    "typical uncertainties are 60  mas in position and 0.1  mag in photometry .",
    "in addition to the main catalogue , we have used the first supplement , which lists another 17,588  bright stars from the hipparcos and catalogues which are not in .    in order to proceed with the triangulation , we have made use of stripack @xcite , a fortran 77 software package that employs an incremental algorithm to build a delaunay triangulation of a set of points on the surface of the unit sphere . for @xmath4 nodes ,",
    "the storage requirement for the triangulation is @xmath5 integer storage locations in addition to @xmath6 nodal coordinates",
    ". the computation scales as .",
    "it is important to highlight that the original software was written using single - precision floating arithmetic , which turns out to be insufficient when dealing with astronomical coordinates with accuracy @xmath7  1  arcsec .",
    "for the work presented here , we have modified the software code in order to use double - precision floating arithmetic , which guarantees the proper computation of the triangulation when working with star separations approaching a few arcseconds .      in principle",
    "it is straightforward to obtain a list of blank fields for the whole celestial sphere by using as input a stellar catalogue including stars down to a given magnitude .",
    "however , considering that the number of stars grows very rapidly with increasing limiting magnitude , this approach may turn out to become nonviable , either in terms of computer memory or considering computing time . in fig .",
    "[ cputime ] we show the time taken by our computer in function of the number of stars ( nodes ) to carry out the tessellation of the catalogue .",
    "each dot corresponds to an increase of 0.5  mag in @xmath8 , in the range from 6.0 to 10.0  mag .",
    "although the cpu time depends on the characteristic of the machine used for the tessellation , the most important aspect is the exponential increase of the required time with @xmath8 , mainly due to the exponential growth of the number of stars ( see table  [ result ] ) .",
    "in addition , since the tessellation of the whole celestial sphere demands memory storage ( for stellar coordinates plus auxiliary variables ) that scales with the number of stars , this approach requires excessively large memory capacity for faint magnitudes .     from 6 to  10 in steps of 0.5  mag . ]    in these circumstances our approach is to subdivide the whole celestial sphere in many smaller subregions ( with some overlap among them ) , in order to individually compute the delaunay triangulation in each of these smaller patches and , finally , merge the separate blank field lists .",
    "however the merging process is not immediate , since in this scenario the fact that the triangulation is computed in small subregions have an additional side effect that must be properly handled : when the subregion area is smaller than a single hemisphere , the convex envelope of the stars within that subregion has an interior zone ( the subregion ) and a larger exterior zone ( the celestial sphere excluding the considered subregion ) .",
    "this means that the triangulation has boundary edges , i.e.  triangles sides that are not shared with other triangles ( see details in * ? ? ?",
    "* ) . in practice ,",
    "the problem arises when one computes the circumcircles of the boundary triangles , since in these cases those circumcircles may easily expand beyond the limits of the considered subregion , where no stars are present because they have not been included as input for the triangulation . a graphical illustration of this problem is shown in fig .",
    "[ figure : bt - problem ] .",
    "figure  [ figure : bt - problem]a displays the initial triangulation obtained after computing the delaunay triangulation of the subregion of the celestial sphere centered around the equatorial coordinates and ( j2000.0 ) within a radius of @xmath9 , and using stars brighter than ( note that the orion constellation is close to the center of the field , whereas the bright stars sirius , procyon and aldebaran appear at the south - east , east and north - west , respectively ) .",
    "the sky region is represented using a lambert s equal area projection .",
    "the thick red line indicates the limit of the @xmath9  radius",
    ". once the triangulation has been computed , the next step is the calculation of the circumcircle associated to each triangle . fig .",
    "[ figure : bt - problem]b shows all the circumcircles obtained for the triangulation derived in the previous step .",
    "the circumcircles that are fully circumscribed within the @xmath9  radius are displayed with green colour , whereas the circumcircles that expand beyond that limit are represented in magenta .",
    "it is obvious that the latter will not be , in general , appropriate blank fields , since they have been computed assuming that no stars were present beyond the red thick line .",
    "however , even in these cases several possibilities can be envisaged in order to obtain valid blank fields starting from the information provided by the affected boundary triangles , while respecting the constraint imposed by the proximity of the boundary of the subregion .",
    "we discuss in appendix  [ appendix : boundary - triangles ] several of these possibilities .",
    "the result of following such approach is displayed in fig .",
    "[ figure : bt - problem]c .    , and using stars brighter than .",
    "see explanation in the text ( section  [ smaller - subregions]).,title=\"fig : \" ] , and using stars brighter than .",
    "see explanation in the text ( section  [ smaller - subregions]).,title=\"fig : \" ] , and using stars brighter than .",
    "see explanation in the text ( section  [ smaller - subregions]).,title=\"fig : \" ]    finally , the blank field lists obtained for the different sky subregions need to be merged . in our case",
    ", we have applied this procedure when tessellating the sky for @xmath10 and  11.0  mag . in particular , we have divided the whole celestial sphere in 578  circular subregions of  @xmath11 radius , where the centre of each subregion is separated by  @xmath12 in declination and by  @xmath13 in right ascension .",
    "considering that the maximum blank field radius obtained for @xmath14  mag is  @xmath15 ( see table  [ result ] ) , this separation between subregions provides an excellent overlap among them . within the overlapping areas",
    "there are duplicated blank fields and additional blank fields that were not permitted to expand beyond their corresponding boundary limit .",
    "consequently , to obtain the final catalogue , we have removed both the repeated blank fields and those due to the border effect ( typically inscribed within larger blank fields of neighbouring subregions ) .",
    "the latter were easy to identify because they circumscribe less than 3 stars .",
    "thus , the final all - sky blank field catalogue is not affected by the number , size and overlap of the subregions that we have employed .      as described above ,",
    "provides photometry data in two pass - bands ( _ b@xmath3 _ and _ v@xmath3 _ ) .",
    "we have applied the delaunay triangulation to each pass - band separately , and to the combination of both . to obtain the initial collections of stars",
    ", we have selected from both the main and the supplement catalogues all stars with magnitude lower than @xmath2 in a given filter . in the case of using both filters ,",
    "the star magnitude should be lower than @xmath2 in either of the two filters .",
    "these initial collections of stars are still not suitable to compute the delaunay triangulation due to the presence of stars with insufficient separation .",
    "for that reason , we decided to `` merge '' into single objects all the stars closer than 1  arcsec , similar to a typical seeing under good wheather conditions .",
    "the resulting visual magnitude for the combined objects was computed as the sum of the fluxes of the merged stars .",
    "the coordinates of the new objects were placed in the line connecting the merged stars , closer to the brightest star ( using a weighting scheme dependent on the individual brightness of the combined stars ) .",
    "this merging process does not reduce substantially the final number of stars , but it makes the triangulation process easier by removing unnecessary very small triangles for which the computations are prone to rounding errors .",
    "we have applied the triangulation method to the merged star lists as described above , with threshold magnitudes between 6 and  11  mag in steps of 0.5  mag .",
    "the resulting blank field catalogues are accessible through the tesela tool ( explained in section  [ section : tesela ] ) .",
    "rrrrrrrrrrrrr & & & ( 4 ) & ( 5 ) & ( 6 ) & ( 7 ) & ( 8) & ( 9 ) & ( 10 ) & ( 11 ) & ( 12 ) & + & & & @xmath16 & @xmath17 & @xmath18 & @xmath19 & @xmath20 & @xmath21 & @xmath22 & @xmath23 & @xmath24 & + & & & ( deg ) & ( deg ) & & ( deg ) & ( deg ) & ( deg ) & & & & + 6.0 & 4,648 & 9,292 & 2.111 & 0.120 & @xmath25 & 2.067 & 0.928 & 5.805 & @xmath26 & 0.436 & 10 & 0.02 + 6.5 & 8,083 & 16,162 & 1.592 & 0.110 & @xmath27 & 1.559 & 0.691 & 5.047 & @xmath28 & 0.581 & 11 & 0.03 + 7.0 & 14,229 & 28,454 & 1.211 & 0.080 & @xmath29 & 1.182 & 0.525 & 3.702 & @xmath30 & 0.767 & 11 & 0.06 + 7.5 & 24,551 & 49,098 & 0.914 & 0.060 & @xmath31 & 0.893 & 0.400 & 2.932 & @xmath32 & 1.011 & 10 & 0.15 + 8.0 & 41,989 & 83,974 & 0.696 & 0.052 & @xmath33 & 0.679 & 0.302 & 2.510 & @xmath34 & 1.335 & 11 & 0.41 + 8.5 & 71,491 & 142,978 & 0.528 & 0.042 & @xmath35 & 0.514 & 0.233 & 2.051 & @xmath36 & 1.752 & 10 & 1.13 + 9.0 & 120,381 & 240,758 & 0.405 & 0.032 & @xmath37 & 0.392 & 0.180 & 1.557 & @xmath38 & 2.294 & 10 & 3.21 + 9.5 & 200,835 & 401,666 & 0.310 & 0.026 & @xmath39 & 0.300 & 0.140 & 1.273 & @xmath40 & 2.995 & 10 & 8.88 + 10.0 & 328,819 & 657,634 & 0.240 & 0.022 & @xmath41 & 0.231 & 0.109 & 1.051 & @xmath42 & 3.850 & 9 & 23.76 + 10.5 & 538,719 & 1,077,434 & 0.185 & 0.020 & @xmath43 & 0.177 & 0.086 & 0.943 & @xmath44 & 4.998 & 9 &  + 11.0 & 871,336 & 1,742,668 & 0.143 & 0.018 & @xmath45 & 0.137 & 0.068 & 0.853 & @xmath46 & 6.460 & 9 &  + & 0.96 & 1.27 & 1.719 &  & 0.31 & 1.725 & 1.31 & 1.80 & 0.35 & 1.753 &  & 6.7 + & 0.03 & 0.03 & 0.011 &  & 0.04 & 0.009 & 0.02 & 0.05 & 0.04 & 0.012 &  & 0.2 + & 0.455 & 0.455 & 0.2339 &  & 0.506 & 0.2362 & 0.227 & 0.176 & 0.513 & 0.2340 &  & 0.80 + & 0.004 & 0.004 & 0.0013 &  & 0.004 & 0.0011 & 0.002 & 0.006 & 0.005 & 0.0014 &  & 0.03 + & 0.9994 & 0.9994 & 0.9997 &  & 0.9992 & 0.9998 & 0.9990 & 0.9901 & 0.9993 & 0.9997 &  & 0.9909 +    as an example , we present the results of the triangulation for _",
    "v@xmath3 _ in fig .",
    "[ figure : histograms ] .",
    "the different histograms correspond to the distributions of the number of blank fields as a function of the blank field radius , for different threshold magnitudes @xmath47 .",
    "the resulting histograms are positively skewed and although , as a first order approach , they can approximately be fitted with a normal distribution ( green curves ) , better fits are obtained using @xmath48 functions with @xmath24 degrees of freedom ( red curves ) .",
    "note that the use of a chi - square law is just an empirical result , obtained after trying to fit different well - known skewed distributions , like lognormal and @xmath49 distributions ( the latter with @xmath50 and @xmath51 degrees of freedom ) , and finding that the best fits were obtained using @xmath49 when @xmath52 , which is equivalent to use a @xmath53 distribution ( see e.g. * ? ? ?",
    "it is not the goal of this work to provide a physical justification for this behavior .",
    "the quantitative description of the above results are presented in table  [ result ] . the threshold magnitude @xmath8 is given in the first column .",
    "the number of stars @xmath54 ( i.e. nodes ) and the number of blank field regions found @xmath55 are listed in the second and third columns , respectively .",
    "the fourth column indicates the median blank field radius @xmath16 and column  ( 5 ) is the bin width @xmath17 for the histogram distributions ( some of them displayed in fig .",
    "[ figure : histograms ] ) employed to derive the parametric fits given in the next columns .",
    "the amplitude @xmath18 , mean radius @xmath56 and standard deviation @xmath20 , obtained from the fit of the each histogram to a normal distribution of the form are listed in columns  ( 6 ) to  ( 8) , respectively .",
    "the maximum blank field radius appears in column  ( 9 ) .",
    "the coefficients of the fit to a chi - square distribution of the form , where @xmath22 is the amplitude , @xmath23 is a scaling factor for @xmath57 , and @xmath24 is the number of degrees of freedom , are given in columns  ( 10 ) to  ( 12 ) .",
    "finally , column  ( 13 ) indicates the cpu time taken for the triangulation when tessellating the whole celestial sphere at once .    as we have shown in fig.[cputime ] , the required cpu computing time increases exponentially with @xmath2 . for this reason",
    ", we have derived the delanuay triangulation for the whole celestial sphere at once just up to magnitude 10 , and in overlaping smaller regions ( as explained in section  [ smaller - subregions ] ) for higher @xmath2 .",
    "we have analysed the results of the triangulation for _",
    "v@xmath3_. for _ b@xmath3 _ and the combination of both filters the results are very similar .",
    "not surprisingly , there is an excellent correlation between most of the parameters listed in table  [ result ] and @xmath47 .",
    "the correlations can be very well fitted using linear regressions of the form , being @xmath58 and defining @xmath59 as the base-10 logarithm of the considered parameter .",
    "the intercept @xmath60 and slope @xmath61 of the regressions ( together with their associated uncertainties @xmath62 and @xmath63 ) are given at the bottom of each column .",
    "the final entry indicates the coefficient of determination @xmath64 , which in all the cases reveals the excellent correlation between the fitted data .",
    "it is also interesting to examine the characteristics of the derived blank fields at a given limiting magnitude .",
    "for example we have analyzed two illustrative diagrams corresponding to the case , which are represented in fig .",
    "[ figure : estadisticas ] . diagram .",
    "[ figure : estadisticas](a ) displays the variation in the number of regions as a function of the absolute value of galactic latitude @xmath65 .",
    "not surprisingly , the number of regions must decrease as the latitude increases , since the area of a spherical annulus ( shown with the red symbols ) is maximum at the galactic equator and tends to zero when @xmath66 approaches @xmath67 .",
    "however , this variation is not enough to explain the difference between the histogram and the red symbols , which clearly indicates that the number of regions is highly concentrated toward the galactic equator , which is simply the result of the higher stellar densitiy in that region .",
    "the diagram  [ figure : estadisticas](b ) shows that even though the number of available blank fields unavoidably decreases with galactic latitude , their typical size , and the variation of sizes among them , increase with @xmath65 approaching the galactic poles .",
    "the extrapolation to fainter magnitudes of the exponential variations of the parameters listed in table  [ result ] , together with the unavoidable increasing difficulty when approaching low galactic latitudes , strongly supports the need for an automatic tool that helps to identify suitable blank fields when observing with medium / large size telescopes .",
    "in order to provide an easy way to access the blank field catalogues , we have created tesela , a web accesible tool , developed within the spanish virtual observatory , which can be publicly accessed through the following url : + http://sdc.cab.inta-csic.es/tesela .",
    "the tool consists of a database containing the stars and the already computed blank fields regions , and an user - friendly interface for accesing the data .",
    "tesela allows the users to perform a cone - search around a position in the sky , i.e.  to obtain the list of blank fields available around a given sky position ( right ascension and declination ) and within a fixed radius around that position . through its search form",
    "( see fig.[tesela ] ) , users can select the threshold magnitude @xmath2 , the filter to be used ( _ b@xmath3 _ , _ v@xmath3 _ , or the combination of both ) , and define a minimum radius for the blank field regions .",
    "this last option may be especially important to fulfill observing requirements , e.g. , to ensure that the blank field is larger than the field of view of a given instrument .",
    "tesela presents the result of the cone - search in two tables , one for blank fields ( ra , dec , radius ) and the other for the stars ( ra , dec , @xmath68 and/or @xmath8 ) in the searching area .",
    "these tables can be downloaded in csv format for further use .",
    "tesela also provides users with the possibility of visualizing the data . to do that , tesela takes advantage of aladin @xcite , a virtual observatory ( vo ) compliant software that allows users to visualise and analyse digitised astronomical images , and superimpose entries from astronomical catalogues or databases available from the vo services . thanks to this connection with aladin ,",
    "we have provided tesela with the full capacity and power of the vo .        in fig .",
    "[ aladin ] we show an example of how tesela visualizes the data using aladin .",
    "tesela sends to aladin the stars of the region , which are loaded in the first plane .",
    "the search area is plotted in a second layer with a red circle ; another layer depicting the blank fields with blue circles is created , and finally , a last layer shows the objects of ngc  2000.0 ( the complete new general catalogue and index catalogue of nebulae and star clusters ; @xcite ) . using this aladin window ,",
    "users are allowed to load images and catalogues both locally and from the vo , having full access to the whole universe resident in the vo .",
    "this can be very helpful to determine the potential influence of relatively bright nebulae and extragalactic sources in the sought regions .",
    "note also that , for obvious reasons , solar system objects have been not considered , and they must be taken into account in order to make use of blank field regions close to the ecliptic at a given date .",
    "so far , the current version of tesela allows users to access a collection of blank fields obtained from the optical tycho-2 catalogue .",
    "but tesela has been conceived as a dynamic tool , which will be improved in the future with both deeper optical catalogues and catalogues in others wavelength ranges .",
    "any future change in the tool will be properly documented in its web site .",
    "we would like to thank the anonymous referee for the careful reading of the manuscript and for her / his comments , which have helped to clarify this paper .",
    "this work was partially funded by the spanish micinn under the consolider - ingenio 2010 program grant csd2006 - 00070 : first science with the gtc .",
    "this work was also supported by the spanish programa nacional de astronoma y astrofsica under grants and , and by astromadrid under project .",
    "this work has made use of aladin developed at the centre de donnes astronomiques de strasbourg , france .",
    "99 , f. , fernique , p. , bienaym , o. , et  al . 2000 ,",
    "a&as , 143 , 33 calabretta , m.  r. , & greisen , e.  w.  2002 , a&a , 395 , 1077 cepa , j. , et al .  2000 , proc .",
    "spie , 4008 , 623 delaunay b. , 1934 , sur la sphre vide , bull .",
    "ussr , 793800 gilliland r.l .",
    ", 1992 , details of noise sources and reduction processes . in : howell s.b .",
    "( ed . ) asp conf .",
    "23 , astronomical ccd observing and reduction techniques , p. 68 , e. , fabricius , c. , makarov , v.  v. , et  al .",
    "2000 , a&a , 355 , l27 , m.  a.  c. , lindegren , l. , kovalevsky , j. , et  al .",
    "1997 , a&a , 323 , l49 press , w.h . ,",
    "teukolsky , s.a . , vetterling , w.t . , and flannery , b.t . , numerical recipes : the art of scientific computing , 3rd ed .",
    ", cambridge univ . press , new york , 2007 .",
    "renka r.j .",
    ", 1997 , algorithm  772 : stripack : delaunay triangulation and voronoi diagram on the surface of a sphere , acm transactions on mathematical software , 23 , 416434 sinnott , r.  w.  1997 , vizier online data catalog , vii/118 , 0 weisstein e.w.2011 ,  sphere point picking .",
    " from mathworld  a wolfram web resource : +",
    "although tessellating small sky subregions is a good approach to the problem of deriving blank fields when dealing with very large stellar catalogues , the discussion of section  [ smaller - subregions ] revealed that the delaunay triangulation of such subregions leads to the situation displayed in fig .",
    "[ figure : bt - problem]b , where many circumcircles associated to boundary triangles ( shown in magenta colour in that figure ) clearly expand beyond the limit of the considered subregion .",
    "although in this case those circumcircles can be easily discarded , it is possible to derive , starting from the coordinates of the corresponding boundary triangles , new circles devoided of stars that remain within the boundary of the sky subregion .",
    "this appendix describes in more detail different approaches that can be employed in this circumstance .    in what follows we are considering the celestial sphere as the unit sphere centered at the origin @xmath69 .",
    "the sky subregion where the blank fields will be searched for is the surface of a spherical cap , which center is given by the unit vector @xmath70 , and the angular radius of such subregion , as measured from @xmath69 , is @xmath71 ( see fig .  [",
    "figure : step0 ] ) .",
    "the delaunay triangulation will be computed with all the stars ( down to a given magnitude ) within that sky subregion . denoting the unit vectors poiting to these stars as @xmath72 ( with @xmath73 , being @xmath74 the total number of stars within the subregion ) , it is obvious that the condition that all these stars must satisfy is @xmath75 we are also assuming that @xmath76 , i.e. , the sky subregion area under consideration is smaller than a single hemisphere .",
    "the delaunay triangulation provides the coordinates of the three nodes ( stars ) of all the triangles resulting from the tessellation procedure ( see fig .  [",
    "figure : step0 ] ) .",
    "let denote the unit vectors pointing from @xmath69 toward the three nodes of each triangle , given in counterclockwise order , as @xmath77 , the unit vector @xmath78 marking the circumcentre of any triangle can be easily computed as ( see e.g. * ? ? ?",
    "* ) @xmath79 note that since the three nodes define a plane , the two vectors and are contained in that plane , and their cross product provides a new vector perpendicular to the plane . of the two possible directions of that vector ,",
    "the fact that the nodes are given in counterclockwise order guarantees that @xmath78 points toward the spherical triangle defined by @xmath80 , @xmath81 , and @xmath82 .",
    "in addition , the modulus calculated in the denominator of eq .",
    "[ eq : circumcenter ] assures that @xmath78 is normalised .",
    "it is not difficult to show that the circumcentre is equidistant from all the three nodes , which allows to compute the circumradius of the circumcircle from the inner product of @xmath78 with any of the node vectors @xmath83 on the other hand , the angular distance between the circumcenter and the center of the sky subregion can be determined as @xmath84 the condition that must be met for any circumcircle to be inscribed within that subregion is then @xmath85 if the above condition does not hold , the computed circumcircle expands beyond the sky subregion and can not be used as a valid blank field . under this circumstance",
    "other options need to be considered , as explained in the next steps .",
    "no matter how close to the boundary of the sky subregion is located any triangle computed during the tessellation , the circle inscribed in those triangles are always within the subregion .",
    "these _ incircles _ are centered at a particular point , the _ incenter _ , which is equidistant from the three sides of the triangles and that corresponds to the intersection of the three bisectors through the vertices of those triangles ( see fig .",
    "[ figure : steps]a ) .",
    "the unit vector  @xmath86 pointing from  @xmath69 toward the incenter of a given triangle can be obtained as @xmath87 where @xmath88 is the unitary vector perpendicular to the plane defined by the origin and the nodes at @xmath89 and  @xmath90 , @xmath91 defined in this way , and considering that the three triangle nodes are given in counterclockwise order , the three normal vectors @xmath92 , @xmath93 and @xmath94 are always pointing toward the interior of the triangles .",
    "it is also easy to show that the inner product provides the radius of the incircle as @xmath95 whose value is the same for @xmath96 , @xmath97 or  @xmath98 . note the use of the @xmath99 function instead of the @xmath100 in the previous expression ; since @xmath88 is perpendicular to the plane defined by the origin @xmath69 and the nodes at @xmath89 and @xmath90 , the angular distance @xmath101 between @xmath86 and that plane must be computed as @xmath102 minus the angle subtended by @xmath86 and @xmath88 .    by construction",
    "it is obvious that incircles will always be regions devoided of stars , since they are inscribed in the considered triangles , that in turn are inscribed in the circumcircles , which , by the empty circumcircle interior property ( see section  [ subsection : delaunay - triangulation ] ) do not contain any star . for that reason",
    "they constitute a first solution to the problem with the boundary triangles which circumcircles expand beyond the limit of the sky subregion under tessellation .",
    "once the incircle of a given boundary triangle has been computed , it is very likely that the incenter does not coincide with the circumcenter . in this case",
    "it is possible to enlarge the incircle by increasing the radius @xmath101 to the closest triangle node as measured from the incenter ( see fig .",
    "[ figure : steps]b ) . to facilitate the explanation of the procedure , let rename the unit vectors pointing toward the three nodes of each triangle as @xmath103 , @xmath104 , and @xmath105 , where the subscript indicates the ordering of the nodes as a function of their proximity to the incenter .",
    "the enlargement of the angular distance connecting @xmath86 with @xmath103 provides a new radius than can be expressed as @xmath106 however , although the the new enlarged circle will only pass through one of the nodes and leave outside the other two nodes , it is possible that other neighbouring stars can enter into its interior .",
    "for that reason , instead of eq .",
    "[ equation : radius - incenter - enlarged ] it is necessary to use @xmath107 ,   \\,\\ , \\forall i=1,\\ldots , n_{{{\\mbox{\\scriptsize stars } } } } , \\label{equation : radius - incenter - enlarged - final}\\ ] ] which already includes the relation given in eq .",
    "[ equation : radius - incenter - enlarged ] , since the three nodes are part ot the set of stars .    before accepting @xmath108 as a valid radius for a blank field",
    ", it is required to check that with this new radius the resulting circle ( centered at the triangle incenter ) does not exceed the boundary of the sky subregion .",
    "this is performed in a similar way as previously employed in step  0 .",
    "first the angular distance between the incenter and the center of the sky subregion is determined as @xmath109 the condition that must be met by the enlarged circle is then @xmath110 if the above condition is not satisfied , a revised version of the radius can be computed as @xmath111    note that , so far , the valid blank field is still centered around the triangle incenter . however , by removing this constraint , it is possible to obtain an even larger valid blank field by allowing its center to move from the incenter toward the directions of the other two nodes following the great circles connecting these points .",
    "next we describe the procedure of shifting the centre of the blank field along the line connecting the incenter with the node corresponding to @xmath104 . the resulting new center @xmath112 ( see fig .  [",
    "figure : steps]c ) will be a point equidistant from @xmath103 and @xmath104 .",
    "the situation with the third node will be identical interchanging @xmath104 by @xmath105 in the following description ( see fig .  [",
    "figure : steps]d ) .",
    "the first step consists in computing the midpoint in the triangle side connecting @xmath103 and @xmath104 .",
    "the unitary vector pointing toward this point is given by @xmath113 the sought new center @xmath112 can be obtained as the intersection of the great circle defined by two vectors @xmath114 and @xmath78 with the great circle defined by the two vectors @xmath86 and @xmath104 . this intersection can be easily computed as @xmath115 where the @xmath116 sign indicates two initial solutions from which the closest vector to @xmath86 must be selected . the angular distance from the new center @xmath112 to either @xmath103 and @xmath104 is now @xmath117 next , it is necessary to check that no new stars ( different from the ones at the triangle nodes ) have entered within the new circle .",
    "this can be computed as @xmath118   \\right\\},\\ ] ] where @xmath73 .",
    "note that it must also be checked that with this new radius @xmath119 the circle centered at @xmath112 is still within the sky subregion . in a similar same as we proceeded in step  2 ,",
    "the distance from @xmath112 to @xmath70 is determined as @xmath120 and then the condition that must be satified can be written as @xmath121 if the previous condition does not hold , the radius of the blank field can be redefined as @xmath122      [ [ step-2-shift - the - center - between - the - incenter - and - the - circumcenter ] ] _ step 2 : shift the center between the incenter and the circumcenter _ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~    independently of the success of the previous step , another possibility worth being explored is shifting the center of the blank field along the great circle connecting the incenter with the circumcenter , with the constraint that the new circle does not cross the sky subregion boundary ( see fig .  [",
    "figure : steps]e ) .    for this computation the bisection method can easily be employed . since the solution for",
    "the new center will be a point in the great circle connecting @xmath86 with @xmath78 , it is possible to use two auxiliary vectors @xmath124 and  @xmath125 which are initialized as and .",
    "then the process enters into an iterative procedure in which the following steps are performed :    1 .",
    "the midpoint on the great circle connecting @xmath124 and  @xmath125 is determined as @xmath126 2 .",
    "the minimum angular distance from the previous point to any of the triangle nodes is evaluated using @xmath127 , \\quad        \\mbox{with $ i=1 $ , 2 or 3.}\\ ] ] 3 .   the angular distance from @xmath128 to the border of the sky subregion is also determined as @xmath129 4 .",
    "if the two previous angular distances are equal within a given tolerance ( for our purposes @xmath130  arcsec is enough ) , the iterative procedure halts and the final result is defined as .",
    "otherwise one of the auxiliary vectors must be redefined according to @xmath131 and the process is iterated by repeating steps ( i)(iv ) .    at the end of the iterative process a new center",
    "@xmath132 has been computed ( see fig .  [",
    "figure : steps]e ) , which is equidistant to the nearest triangle node and to the boundary of the sky subregion , i.e. , .",
    "it is important to highlight that new radius @xmath134 will not necessarily be larger than the radii previously derived in steps  2 and  3 ( in fact , the example illustrating this appendix shows that the blank field in fig .",
    "[ figure : steps]d centered at @xmath112 with radius @xmath135 is larger than the blank field in fig .",
    "[ figure : steps]e centered at @xmath132 with radius @xmath136 ) .",
    "[ [ step-3-random - search - in - the - intersection - between - the - circumcircle - and - the - sky - subregion ] ] _ step 3 : random search in the intersection between the circumcircle and the sky subregion _ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~    a final , but also effective , brute force method consists in using a random search of a valid blank field center within the intersection region between the circumcircle and the sky subregion ( see fig .",
    "[ figure : steps]f ) . for this purpose ,",
    "random points are generated on that region , imposing that any small area has to contain , on average , the same number of points ( see e.g. * ? ? ?",
    "for each random point @xmath137 the valid blank field radius is evaluated as @xmath138 ,   \\quad \\forall i=1,\\ldots , n_{{\\mbox{\\scriptsize stars}}}.\\ ] ] it is also necessary to check that the resulting blank field remains inscribed in the sky subregion . for that purpose",
    "the distance from the center to the border of the subregion is determined using @xmath139 and the corresponding condition to be verified is @xmath140 if this is not the case , the value of the radius can be refined using @xmath141    obviously , the solution obtained with this method must be compared with the solutions derived in the previous steps in order to decide which one provides the largest blank field in the neighborhood of the considered boundary triangle .",
    "the three steps just described produce different possible valid blank fields associated to each boundary triangle .",
    "the adopted valid blank field in each case will be the largest among those alternatives .",
    "it is interesting to investigate the successfullness of the three steps providing the largest blank field . as a first - order estimation of these numbers",
    ", we have measured the percentage of success of each step when tessellating random stellar fields . since the success ratio for step  3 depends on the number of random points drawn within the intersection region between the circumcircle and the sky subregion , we have computed those percentages using different numbers of random points .",
    "the results are displayed in fig .",
    "[ stepspercent ] .",
    "each colour in this figure indicates a fixed number of random points employed in step  3 .",
    "when no random points are used ( represented in red colour ) , the median percentage of success of steps  1 and  2 are 23% and 77% , respectively .",
    "not surprisingly these values decrease as the number of random points in step  3 increases , reaching a stable situation as far as the number of random points exceeds a few hundred .",
    "in particular , for @xmath142 random points the median percentages of success ( represented in magenta colour ) are 10% , 24% and 66% for steps 1 , 2 and  3 , respectively .      .",
    "the bottom and top of each box show the 25th and 75th percentiles , whereas the thick horizontal line marks the median .",
    "the whiskers ( vertical dashed lines ) show 1.5  times the interquartile range . since each colour represents a fixed number of random points employed in the search for valid a blank field region in step  3 , the sum of the percentages in the three steps for a fixed colour is  100 . ]"
  ],
  "abstract_text": [
    "<S> the observation of _ blank fields _ , regions of the sky devoid of stars down to a given threshold magnitude , constitutes one of the typical important calibration procedures required for the proper reduction of astronomical data obtained in imaging mode . </S>",
    "<S> this work describes a method , based on the use of the delaunay triangulation on the surface of a sphere , that allows the easy generation of blank fields catalogues . </S>",
    "<S> in addition to that , a new tool named tesela , accessible through the web , has been created to facilitate the user to retrieve , and visualise using the vo - tool aladin , the blank fields available near a given position in the sky .    </S>",
    "<S> [ firstpage ]    methods : data analysis  methods : numerical  virtual observatory tools </S>"
  ]
}