{
  "article_text": [
    "pointing models are widely exploited in telescope control in order to correct for mechanical and manufacturing imperfections of the various parts of the system .",
    "the basic concept of a pointing model is to figure out and quantify the difference between the targeted and the apparent position of the telescope throughout the observations .",
    "this quantification can be done using lookup tables with some grid spacing as well as using analytical approaches where these functions are related to the physical behaviour of the telescope mechanics .    in most of the pointing models ,",
    "either in the case of equatorial mounts @xcite , altitude - azimuth mounts @xcite or complex systems of more telescopes @xcite the raw , uncorrected positions of the various axes ( hour axis , declination axis , azimuth axis or elevation axis ) are read from high precision rotary encoders .",
    "such encoders provide a precision within fractions of arcseconds or even hundredths of arcseconds .",
    "there are other types of pointing models that involve mems accelerometers @xcite instead of such encoders .",
    "the attainable precision is much lower in the case of these integrated accelerometers ( currently it is in the range of an arcminute ) . despite the lower precision",
    ", these solutions also have advantages , including the redundant operation ( via the various constraints between the accelerometer channels ) , the resistance to unintentional tampering and the possibility of installation without modifying or altering the drivers .",
    "the goal of our work presented here is to provide a strictly mathematical approach for finding analytical pointing models which provide an rms accuracy within a few arcseconds .",
    "first , in sec .",
    "[ sec : isotropic ] we detail the mathematical formalism used in the derivation of an isotropic pointing model .",
    "this model is then extended in sec .",
    "[ sec : anisotropic ] with terms that quantify a generalized form of dependence by performing expansions of spherical harmonics .",
    "these expansions allow the model to take into account various forms of anisotropic behaviour , for instance the torques inducted by gravity or misalignments of the gearing . in sec .",
    "[ sec : implementation ] we report results of test measurements validating these models , as well as we detail how the pointing model can be implemented . finally , our work is summarized in sec .",
    "[ sec : summary ] .",
    "basically , telescope mechanics are treated as a serial robot formed by two subsequent stages where the two stages are performing ( nearly ) orthogonal rotation . throughout this paper",
    "we present the calculations in first equatorial coordinate system , however , a similar approach can be involved for alt - az mechanics by simply replacing the variables appropriately . in the case of an equatorial mount , the first shaft ( whose bearings",
    "are fixed to the ground ) is responsible for the rotation around the hour axis while the second , perpendicular stage is responsible for setting the declination . in the following ,",
    "we recall briefly the main ideas behind the isotropic approach used in @xcite .    throughout the derivation of our models ,",
    "let us exploit the cartesian representation of celestial coordinates .",
    "let us define the standard direction of the telescope tube to the @xmath1 axis , i.e. without any rotation , the telescope directed to the vector of @xmath2 .",
    "this is in accordance with the historic parameterization of the first equatorial system if we treat the hour angle @xmath3 and declination @xmath4 values as polar angles .",
    "however , one should keep in mind that this parameterization yields a left - handed @xmath5 system of reference ( see fig .",
    "[ fig : lefthanded ] ) .",
    "an arbitrary point at the sky is then defined by the vector @xmath6 while @xmath7 .",
    "if one treats the whole telescope system as a series of active rotations , then one can write @xmath8 where the rotation matrices @xmath9 and @xmath10 are defined as @xmath11 as it can be recognized , the assumption in eq .",
    "( [ eq : tdnaive ] ) is valid only in ideal circumstances . in real applications ,",
    "the various deflections presented in the telescope system are quantified by the rotation matrices @xmath12 , @xmath13 and @xmath14 using the relation @xmath15 here , @xmath12 quantifies the misalignments of the telescope hour axis with respect to the ground , @xmath13 quantifies the misalignments of the declination axis with respect to the hour axis while @xmath14 quantifies the misalignments of the detector or the tube with respect to the declination axis .",
    "these matrices of @xmath12 , @xmath13 and @xmath14 are quite close to unity . hence , a first - order series expansion can be involved in order to approximate these .",
    "the idea is based on the well - known relation between skew - symmetric and orthogonal matrices .",
    "namely , for any skew - symmetric matrix @xmath16 , the exponential of @xmath17 is always an orthogonal matrix with unity determinant . in practice ,",
    "let us write these in the form of @xmath18 we call the pointing model _ isotropic _",
    "if the matrices @xmath12 , @xmath13 and @xmath14 do not depend on the telescope position .    here",
    "we give the full expansion of @xmath19 up to the first order . in the formula presented below , @xmath20 ,",
    "@xmath21 , @xmath22 and @xmath23 denote @xmath24 , @xmath25 , @xmath26 and @xmath27 , respectively : @xmath28 during the expansion , the matrices proportional to @xmath29 and @xmath30 are going to be exactly the same like the matrices proportional to @xmath31 and @xmath32 .",
    "hence , the above equation depends only on @xmath33 and @xmath34 . therefore , in the following we use @xmath35 and @xmath36 in our computations .",
    "if the expansion above ( eq .  [ eq : pexpand ] ) is multiplied by the reference vector @xmath37 , the term proportional to @xmath38 will also vanish .",
    "this term effects computations only when the information provided by the apparent field rotation is also included in the pointing model since the first column of the respective matrix is identical to zero .",
    "all in all , the expansion of eq .",
    "( [ eq : tdmatrices ] ) is @xmath39 this equation can be written in the form of @xmath40 where the vector @xmath41 is defined by eq .",
    "( [ eq : pdef ] ) , the parameter vector of @xmath42 is equivalent to @xmath43 and the @xmath44 are defined accordingly to eq .",
    "( [ eq : tdvectexpansion ] ) .    the parameters ( @xmath45 ) can be obtained by a linear least squares regression if a series of observations is known with reported mount axis encoder positions of @xmath46 as well as the respective _ apparent _ positions of @xmath47 . here , `` apparent '' refers to the hour angle and declination values after correcting for precession , nutation , aberration and refraction as well as one should accurately obtain the @xmath48 differences throughout the derivation of the local sidereal time instances ( see * ? ? ?",
    "* ; * ? ? ?",
    "* for more details ) .",
    "once this series of @xmath49 measurements is known , one has to minimize the merit function @xmath50 where @xmath51 ^ 2.\\nonumber\\ ] ] minimization of the above equation for @xmath52 yields a linear array of equations whose solution is then straightforward . due to the three dimensional nature of the @xmath53 vectors ,",
    "this equation for @xmath52 implies @xmath54 independent terms .",
    "however , the effective number for degrees of freedom is only @xmath55 since for all @xmath56 values and for all observations , @xmath57 in other words , these 6 base vectors of @xmath58 defined in the expansion ( [ eq : pexpansion ] ) are always perpendicular to the observation direction @xmath59 .    in the following",
    "we extend the isotropic model described above with terms that provide significantly better accuracy .",
    ".coefficients of the expansion of the pointing model up to the first order in the spherical harmonics .",
    "note that the terms marked with stars ( @xmath60 ) and dots ( @xmath61 ) are not linearly independent .",
    "hence , the first order expansion of the pointing model has 22 independent coefficients instead of 24 .",
    "[ cols= \" < , < , < , < , < \" , ]",
    "the idea behind the isotropic pointing model is the fact that the parameters @xmath45 of the respective expansion do not depend on the the pointing direction defined by @xmath3 and/or @xmath4 . in order to attain better accuracy",
    ", we investigate now how the matrices @xmath12 , @xmath13 and @xmath14 and hence the parameters @xmath45 can depend on the position of the telescope .",
    "recalling earlier works ( see e.g. * ? ? ?",
    "* ) , we examine the expansion of these terms via spherical harmonics .",
    "namely , each of the @xmath45 constants are replaced by a linear combination of spherical harmonics up to a certain order @xmath62 . here",
    "@xmath62 is the maximum order of the corresponding spherical harmonics and the respective legendre polynomials ( see also later on for the actual definitions ) . in practice ,",
    "let us extend eq .",
    "( [ eq : pexpansion ] ) as @xmath63 where @xmath64 represent the real orthogonal spherical harmonics with the indices @xmath65 : @xmath66 in the above definition , the terms @xmath67 denote the associated legendre polynomials .",
    "the constants @xmath68 can have arbitrary but non - zero values since in eq .",
    "( [ eq : pyyexpansion ] ) , the @xmath69 functions are multiplied by an unknown parameter . the series for the first three orders are @xmath70 in table  [ table : ypointingcoeffs ] , we also summarize the terms @xmath71 up to the order of @xmath72 .",
    "it is essential to note that an important property of the terms @xmath71 is the ambiguity due to the lack of linear independence between some of the terms .",
    "for instance , up to the order of @xmath73 , there are two relations that should be taken into account : @xmath74 these relations are valid for arbitrary values of @xmath75 and hence in the first case ( eq .  [ eq : l1lin1 ] ) either @xmath76 or @xmath77 should be omitted from the model fit . in the second case ( eq .  [ eq : l1lin2 ] ) , one of the terms @xmath78 , @xmath79 or @xmath80 should be omitted .",
    "we also mark these terms affected by the linear dependence in table  [ table : ypointingcoeffs ] . due to the presence of these two equations",
    ", the @xmath73 anisotropic pointing model has @xmath81 free parameters in total .    for completeness",
    ", we give here the six additional respective relations which appear if we consider spherical harmonics expansion up to the order of @xmath82 : @xmath83 the omission of the respective @xmath84 parameters should be done according to these relations .",
    "for example , the first respective parameters in eqs .",
    "( [ eq : yl2r1])([eq : yl2r6 ] ) , i.e. @xmath85 , @xmath86 , @xmath87 , @xmath88 , @xmath89 and @xmath90 can forcibly be set to zero during the fitting procedures ( along with , for instance , the parameters @xmath77 and @xmath80 , see above ) .",
    "therefore , the @xmath82 anisotropic pointing model has @xmath91 free parameters in total .",
    "our initial attempt was to create a pointing model that is completely based on a direct mathematical approach .",
    "however , the various quantities appearing in the expansion , i.e. the coefficients of @xmath84 as well as the respective functions of @xmath71 can be assigned to various physical characteristics of the telescope mount . in the following",
    ", we briefly summarize these `` roles '' of the various @xmath84 coefficients .      as it is known from earlier works ( see e.g. * ? ? ?",
    "* ; * ? ? ?",
    "* ) , the most essential parameters of a telescope pointing correction functions are related to the polar displacement , the encoder zero point offsets and the non - orthogonality deviation of the two axes .",
    "indeed , it can be recognized that @xmath92 and @xmath93 are the terms that are proportional to the polar displacement ( in azimuthal and elevation directions , respectively ) , @xmath94 is the hour angle encoder offset , @xmath95 is the deviation from the right angle between the two axes and @xmath96 is the declination encoder offset .",
    "the term @xmath97 is the deviation of the optical axis in the direction of sidereal rotation .",
    "one of the most frequently cited anisotropic properties of a telescope mount arises from the gravity of earth .",
    "gravity yields a deflection of the telescope tube directly as well as indirectly via the unbalanced axes . as the barycenter of the various parts moves along as",
    "the telescope is slewing to various celestial positions , the net torque also results in anisotropic pointing offsets . in practice ,",
    "the equatorial and declination stages are usually driven by worm gears . hence",
    ", another kind of anisotropy appears in the mechanical system if we consider the ellipticity and/or eccentricity of the driven worm gears of these axes .",
    "further details and examples about the interpretation of various anisotropic coefficients are found below , in sec .",
    "[ sec : tests ] .",
    "an expansion by spherical harmonics can be used to include additional terms that have a dedicated physical relevance .",
    "a prominent example can be the characterization of periodic errors .",
    "most of the classic telescope mounts are worm - geared systems and due to the limited resolution of the rotary encoders , raw hour angle and declination values are recovered from multi - turn encoders mounted to the worm shaft instead of the gear shaft .",
    "let us suppose a gear ratio of @xmath98 .",
    "as the term @xmath99 quantifies the encoder zero point offset in the hour angle , it can be deduced that the two additional terms of @xmath100 characterize the periodic error .",
    "namely , @xmath101 is proportional to the amplitude of the periodic error while the angle @xmath102 tells us the phase of the periodic error at @xmath103 encoder position .",
    "in order to use the pointing model in practice , one should consider how it can be implemented for `` real '' telescopes .",
    "the actual implementation has to have two essential parts :    * first , one should obtain an appropriately chosen series of astrometric calibration frames of the given instrument in order to obtain the respective @xmath46 and @xmath47 values needed for the model .",
    "afterwards , once these data are known , the parameters of the pointing model are needed to be fitted . *",
    "second , `` implementation '' also refers to the insertion of the model parameters into the telescope control system ( tcs ) in order to have a benefit during the observations .    in this section ,",
    "we summarize our method of implementation , considering both the model parameter regression as well as the integration in a tcs .      to implement our model",
    ", one should employ a classic , purely linear least squares regression analysis on functions containing merely linear combinations of trigonometric expressions . by considering the definitions of the linear least squares method ( @xmath52 ,",
    "[ eq : chi2sum ] ) as well as the actual model ( see eq .",
    "[ eq : pyyexpansion ] ) , one could derive that the merit function needed to be minimized is @xmath104 ^ 2,\\ ] ] where @xmath105 if @xmath106 , we get the isotropic pointing model ( having @xmath107 parameters in total ) while for @xmath73 and @xmath82 , we get the anisotropic cases with @xmath108 and @xmath109 free parameters . of course , the value of @xmath62 can further be increased , however , one should keep in mind that additional identities similar to eqs .",
    "( [ eq : l1lin1])-([eq : l1lin2 ] ) and/or eqs .",
    "( [ eq : yl2r1])-([eq : yl2r6 ] ) will appear during the expansions .    our current implementation for minimizing @xmath52",
    "is based on shell scripts written in the language of ` bash ` .",
    "these scripts exploit standard unix text processing utilities as well as the ` lfit ` utility of the fitsh package @xcite .",
    "this implementation expects a four - column input file ( where each line contains the @xmath110 values ) and it is available on the fitsh website in the `` examples '' section .",
    "once the pointing model parameters are known , they should be integrated in the tcs . however , such an integration needs a lower level access to the tcs software stack while the above described procedure for obtaining the coefficients can be done by anyone who has observational access to the telescope .",
    "there are two ways to use the model :    * first , eq .",
    "( [ eq : pyyexpansion ] ) ( or eq .  [ eq : pexpansion ] when considering only anisotropic models ) should be evaluated when one computes the _ apparent _ equatorial coordinates based on the encoder values .",
    "this type of calculation is performed when the tcs is asked to report the current position , i.e. _ after _ the _ reading _ of the encoders on the mount axes . *",
    "second , the _ inverse _ form of eq .",
    "( [ eq : pyyexpansion ] ) needs to be evaluated during pointing and tracking of the telescopes .",
    "namely , if one has to determine the encoder values based on the apparent first equatorial coordinates .",
    "this type of calculation is performed when the tcs is commanded to slew the telescope to a certain position , i.e. _ before _ targeting the motors ( and/or any mechanisms ) .",
    "any software library that handles pointing model evaluation needs to be ready for implementing both of the above types .    in practice ,",
    "the inversion of eq .",
    "( [ eq : pyyexpansion ] ) can be implemented by changing the sign in the series expansion coefficients .",
    "this type of inversion yields systematic offsets in the order of @xmath111 .",
    "if the typical mount deflections are in the range of a few arcminutes ( i.e. a milliradian ) , then the error caused by this improper inversion yields a systematic effect in the range of sub - arcsecond scale ( i.e. microradians ) which is usually sufficient .",
    "if higher accuracy is needed , the inversion can be done in a two - step iteration , yielding errors in the range of @xmath112 . since practical applications do not rely on subsequent evaluation of the pointing model corrections",
    ", these errors do not accumulate .",
    "the above cited `` examples '' section of the fitsh webpage contains a full implementation of an ansi c library that can also be integrated in a tcs . in addition , this section of the webpage links some code snippets taken from the currently running version of an 1-m class telescope control software ( see below the next subsection for more details ) .      in order to test the feasibility of our model we conducted a series of observations with the recently refurbished 1-meter ritchey  chrtien - coud ( rcc ) telescope of the konkoly observatory .",
    "this telescope is installed on an english cross - axis mount .",
    "the northern pillar of this type of mount strictly limits the slew domain of the telescope within a certain range since the tube is unable to observe objects close to lower culmination . in the available telescope motion domain we defined a grid of ( @xmath113 ) values and exposures",
    "were taken on each grid point with a net time of 20 seconds . in total",
    ", we gathered 81 images covering the sky nearly uniformly with the inclusion of polar crossing . due to the partially cloudy weather ,",
    "only 69 of these images have successfully been analyzed in order to have accurate astrometric solutions .",
    "the positions of these measurements are displayed in fig .",
    "[ fig : rccaxes ] . images were acquired with an andor ixon-888 frame - transfer electron - multiplying ccd camera ( emccd ) and reduced with the standard calibration procedures using the fitsh utilities @xcite . since",
    "the net field - of - view of the optical setup is relatively small ( @xmath114 ) , astrometric solutions were derived using images acquired in parallel with a guider telescope . for an initial solution",
    ", we exploited the offline version of the astrometry.net package @xcite while the cross - matching of the two camera images as well as the final astrometric solutions were obtained with the appropriate tasks of the fitsh package using the usno catalogue @xcite as a reference .",
    "after obtaining the j2000.0 centroids of each frame , apparent first equatorial coordinates ( hour angle and declination ) were obtained after correcting for precession , nutation , aberration and refraction using the standard procedures @xcite .",
    "the list of encoder positions read at the exposure midpoint was used as an input series of @xmath46 values while the corrected astrometric solutions were used as an input series of @xmath47 values .",
    "the unbiased residuals of the isotropic , the first - order anisotropic and the second - order anisotropic pointing models were @xmath115 , @xmath116 and @xmath117 radians , respectively ( where @xmath118 denotes the residuals corresponding to the @xmath62th order in the spherical harmonics expansion ) . since one arcsecond is equal to @xmath119 radians , these values correspond to @xmath120 , @xmath121 and @xmath122 .",
    "we note here that without any pointing model applied ( which is similar to setting forcibly all of the coefficients @xmath84 to zero ) , the residual is @xmath123 radian , equivalent to @xmath124 .",
    "this is @xmath125 times larger even than the residual corresponding to the isotropic ( @xmath106 ) case .",
    "we plot the typical structures of pointing model residuals for the @xmath106 and @xmath73 case in the two panels of fig .",
    "[ fig : residual ] .    the fitted values and the respective uncertainties of the model coefficients can also be used to measure the actual deflections of the telescope .",
    "for instance , in our case the isotropic model yields values for the polar displacement and encoder zero point offsets that can be used for tuning the telescope .",
    "the actual values for the polar displacement are @xmath126 , @xmath127 while the encoder zero points are @xmath128 and @xmath129 radians .",
    "it also turns out that the deviation of the two axes is also significant , being in the range of arcminute ( @xmath130 ) . however",
    ", this value represents an _ average _ value for these deflections since the effects described in sec .",
    "[ sec : interpretation : anisotropic ] can yield an anisotropy in any of the previously mentioned values .",
    "indeed , for instance , the deviation of the two axes shows a clear dependence on the telescope position itself , namely the corresponding coefficients are @xmath131 , @xmath132 , @xmath133 and @xmath134 ( also in radians ) .",
    "it means that the deflection of the two axes can _ vary _ with a full amplitude of at least @xmath135 arcminutes on the total telescope motion domain .",
    "we also included two terms corresponding to the @xmath136 gear ratio of the hour axis worm - drive of the rcc telescope .",
    "this inclusion yielded a decrement of the unbiased @xmath52 values of @xmath137 ( which should be compared to @xmath138 , where @xmath139 , the number of the frames and @xmath140 , the number of parameters in the @xmath73 anisotropic model ) .",
    "at the first glance , this fact might prove that the pointing model is improved by this additional term .",
    "however , compared to the total degrees of freedom , this decrement is marginal as well as the respective amplitude that differs from zero only by 1.5-sigma .",
    "in addition , total measured periodic error of this telescope is @xmath141 , which is well below the residuals of the model .",
    "all in all , we can conclude that _ this _ telescope can not benefit with this inclusion , but other telescopes ( e.g. amateur - class mechanics with typical periodic errors in the range of tens of arcseconds ) might do so .",
    "it should be noted that spherical harmonics yield the same values while we observe the same celestial position before and after polar crossing . in other words , @xmath142 for all values of @xmath3 and @xmath4 .",
    "however , some anisotropic physical effects ( see sec .",
    "[ sec : interpretation : anisotropic ] above ) might have different yields depending on the pier side of the telescope . since the telescope can reach most of the target positions in both configurations , it is worth separating the coefficients corresponding to these two configuration domains . here",
    "we define two target points to be in the same configuration if the telescope can be re - positioned between the two points without polar crossing .",
    "the easiest way to do this is to consider points with @xmath143 and @xmath144 in independent fits .",
    "indeed , our analysis yields an unbiased residual of @xmath145 and @xmath146 for the @xmath73 model if the two parts of the sky are treated separately .",
    "both residuals are significantly smaller than the residual of @xmath121 and even a bit smaller than the @xmath82 model for the full coverage .",
    "if we perform this separation in the isotropic model , the unbiased residuals are going to be roughly the same ( namely , @xmath147 and @xmath148 , in our case ) .",
    "in this paper we have presented a generic analytical anisotropic telescope pointing model derived from purely mathematical considerations .",
    "our results show that this type of approach provides rms residuals comparable and even better than earlier types of pointing models .",
    "it should be noted , however , that this pointing model does not account directly the temperature dependence of the telescope system .",
    "based on earlier works @xcite , the coefficients for the drifts of the various parameters due to the thermal expansion can be as large as @xmath149 per degrees celsius .",
    "hence , the accuracy of the ambient temperature should be within a few degrees celsius in order to recover the pointing with an accuracy comparable to the rms residuals .",
    "uncertainties in the refraction model , for instance a variation of @xmath150 in the pressure and/or @xmath151 degrees celsius in the temperature yield an offset of @xmath152 even at moderate ( @xmath153 degrees of ) elevations above the horizon .",
    "although an improper refraction model can be corrected via the @xmath69 functions , the correction factors depend on the temperature and/or the density profile of the layers in the atmosphere . a major advantage of our model is the lack of parameterization via polar coordinates . in our tests ,",
    "one of the grid points had a declination of @xmath154 and it is also a well behaved point , not an outlier  despite the fact that the respective value of @xmath155 is more than @xmath156 . in order to have a successful implementation for our model , one should employ only classic linear least squares regression analysis on functions containing purely trigonometric expressions .",
    "the implementation of both the model fit and the model evaluation functions is straightforward , and is demonstrated on the fitsh webpage .",
    "we thank the detailed review and the valuable comments of the anonymous referee .",
    "we also thank emese plachy and lszl molnr the careful proof corrections .",
    "our project has been supported by the hungarian academy of sciences via the grant lp2012 - 31 as well as via the hungarian otka grants k-104607 , k-109276 and k-113117 ."
  ],
  "abstract_text": [
    "<S> this paper describes an alternative approach for generating pointing models for telescopes equipped with serial kinematics , esp . </S>",
    "<S> equatorial or alt - az mounts . </S>",
    "<S> our model construction does not exploit any assumption for the underlying physical constraints of the mount , however , one can assign various effects to the respective components of the equations . in order to recover the pointing model parameters , classical linear least squares </S>",
    "<S> fitting procedures can be applied . </S>",
    "<S> this parameterization also lacks any kind of parametric singularity . </S>",
    "<S> we demonstrate the efficiency of this type of model on real measurements with meter - class telescopes where the results provide a root mean square accuracy of @xmath0 arcseconds . </S>"
  ]
}