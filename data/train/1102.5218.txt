{
  "article_text": [
    "for various reasons , such as camera optics , alignment errors , filter irregularities , non - flat ccds , and ccd manufacturing defects , the mapping of the square array of square pixels of a detector onto the tangent - plane projection of the sky requires a non - linear transformation .",
    "positions measured within the pixel grid need to be corrected for geometric distortion ( gd ) before they can be accurately compared with other positions in the same image , or compared with positions measured in other image .    while almost all scientific programs must make use of the distortion solution , most are relatively insensitive to it .",
    "so long as each detector pixel is mapped to within a fraction of a pixel of its true location in a distortion - corrected reference frame , the resampling accuracy is not compromised .",
    "for this reason , the formal requirement for distortion calibration for wfc3 was 0.2 pixel to enable ` multidrizzle ` in the calibration pipeline to generate stacked associations .",
    "kozhurina - platais et al .",
    "( 2009 ;  isr 2009 - 33 ) and mcclean et al .",
    "( 2010 ;  isr 2009 - 041 ) have demonstrated that the current official solution is accurate to 0.05 pixel ( 2 mas ) , clearly meeting the needs of the pipeline .",
    "scientific programs that are focused on astrometry make more stringent demands on the distortion solution .",
    "these programs must analyze the raw , un - resampled pixels of the distorted images in order to attain the highest possible position accuracy .",
    "similarly , these programs require a more accurate distortion solution to relate measured positions to one another .",
    "in general , positions can be measured to a precision of 0.01 pixel for a well - exposed star , so we would like to have a distortion solution that is at least this accurate .",
    "such a precision is well below the formal calibration requirements , but if it can be shown that the solution is stable at that level , then an improved calibration will enable many astrometry - related programs .",
    "in a previous paper ( bellini & bedin 2009 , hereafter paper  i ) , we used the limited set of dithered exposures taken during smov ( servicing mission observatory verification ) and an existing acs / wfc astrometric reference frame as a flat - field to derive a set of 3@xmath2-order - polynomial correction coefficients to represent the geometric distortion in wfc3/uvis .",
    "the solution was derived independently for each of the two ccds for each of the three broad - band ultraviolet filters f225w , f275w and f336w .",
    "we found that by applying our correction it was possible to remove the gd over the entire area of each chip to an average 1-d accuracy of 0.025 pixels ( i.e. , 1 mas ) . at the time , the lack of sufficient observations collected at different roll angles and dithers prevented a more accurate self - calibration - based solution .",
    "the calibration data collected over the past year has enabled us to undertake the next step in modeling the gd of wfc3/uvis detectors .",
    "the large number of dithers and multiple roll angles now available allow us to construct a 2010-based reference frame that is free of the proper - motion ( pm ) errors inherent in the previous 2002-epoch acs catalog .",
    "the calibration data has enabled us to extend the gd solution to the rest of the major broad - band filters and to improve the accuracy of the solution to about 0.008 pixel .",
    "this is below the precision with which we can measure a well - exposed stars in a single exposure .",
    "improvements beyond this are unlikely , as breathing and other temporal variations make a more accurate `` average '' solution unnecessary .    as we will see in sect .",
    "[ sec2 ] , the uvis chips contain distortion with very complex variations on relatively small spatial scales , which would be very unwieldy to model with simple polynomials .",
    "therefore we chose to model the gd with two components : a simple 3@xmath0-order polynomial and an empirically - derived table of residuals ( the look - up table ) .",
    "these look - up tables ( one per chip / filter combination ) simultaneously absorb _",
    "i ) _ the complicated effects caused by the non - perfectly uniform and flat surfaces of the filters ( for an example in the case of acs / wfc , see anderson & king 2006 , hereafter ak06 ) and _ ii ) _ the astrometric imprint of manufacturing defects on the uvis ccd pixel arrays .",
    "this approach was pursued with success on both acs / hrc and acs / wfc detectors ( anderson 2002 , ak06 ) , for which the gd correction based on polynomials plus look - up tables is still the best available to date .",
    "the data used in this paper come from the @xmath3  cen calibration field , and were collected under programs pid-11452 ( pi - quijano ) and pid-11911 ( pi - sabbi ) during 4 epochs :  2009 july 15 ( 2009.54 ) , 2010 january 1214 ( 2010.04 ) , 2010 april 2829 ( 2010.33 ) and 2010 june 30july 4 ( 2010.51 ) . during",
    "the january and april 2010 runs guide - star failures made it necessary to repeat some of the exposures of pid-11911 .",
    "moreover , between the first and the second epoch the telescope focus changed significantly . the summary of the observations used in this work is given in table  [ tab1 ] .",
    "in addition to large dithers of the size of @xmath41000 pixels ( i.e.  @xmath440@xmath5 ) , at least 2 orientations were available for each filter .",
    "star positions and fluxes were obtained as described in paper  i , using a spatially - variable psf - fitting method , which will be described in detail in a subsequent paper of this series .",
    "the gd solution was constructed in three stages . we began by treating each chip independently .",
    "we first solved for the 3@xmath0-order polynomial that provides the lion s share of the correction for each chip . after subtracting this global component of the solution , we were then able to see and model the fine - scale component of the solution , caused by detector and filter irregularities . finally , with the solution for each chip nailed down , we found the global linear parameters that mapped both chips into a convenient meta - chip reference frame .",
    "in paper  i we derived a 3@xmath0-order polynomial solution for the gd for filters f225w , f275w and f336w ; here our aim in this section is to obtain the polynomial solution for seven other broad - band filters for which suitable observations are available , namely : f390w , f438w , f555w , f606w , f775w , f814w and f850lp .    whereas in paper  i we had to use an astrometric reference catalog that was taken several years prior in order to extract the gd solution",
    ", we can now perform a self - calibration of the gd thanks to the improved number of images at different roll angles offered by the new data set .",
    "self - calibrations can often be more accurate than calibrations that reference a standard field , since stars in standard fields can move due to proper motions and since the brightness range where stars in the catalog are well measured may not correspond to the brightness range where stars in the calibration exposures are well measured .",
    "furthermore , the images may have different crowding issues and measurement qualities from the catalog .",
    "we followed the prescriptions given in anderson & king ( 2003 ) for wfpc2 and subsequently used by the same authors to derive the gd correction for the acs / hrc ( anderson & king 2004 ) and for the acs / wfc ( ak06 ) .",
    "the same strategy was also used by two of us to calibrate a ground - based instrument ( see bellini & bedin 2010 for details ) .",
    "briefly , we started with the f336w gd - solution of paper  i as first guess to correct star positions for the seven redward of f336w ( from f390w to f850lp ) and created a master frame for each filter independently .",
    "we then performed the iterative procedure described in paper  i to improve the polynomial coefficients . with a better gd solution ,",
    "we then re - constructed the master frames and repeated the entire process three times . a fourth repetition of the procedure provided negligible improvement . the 3@xmath0-order polynomial coefficients for all 10 of the broad - band filters are hard - coded in the `",
    "fortran ` subroutine available at the website described given in section  [ sec : conc ] .",
    "as an example , the coefficients for filter f606w are reported in table  [ tab2 ] ( coefficients for all the ten filters are shown in table  a in the electronic version of the paper ) .",
    "the next step in the procedure was to examine the residuals from the polynomial solution . to do this",
    "we transformed the master - frame position for each star back into the raw frame of each exposure using a conformal linear transformation and the inverse distortion solution .",
    "the residual was then the difference between where the star was observed in the frame @xmath6 and where it should have been in that frame , according to the master frame . in figure",
    "[ fig : res_before ] we plot this residual as a function of raw chip coordinate .",
    "each black dot represents a single star measured in single exposure .",
    "we combine all the exposures together to see the overall trends .",
    "individual residuals were then averaged within small ( @xmath4113-pixel size ) cells ( conveniently defined as described in the next section ) and are plotted as arrow vectors ( magnified by a factor of 2500 ) .",
    "these residuals exhibit a pattern with unexpected abrupt discontinuities ( denoted with the solid red lines ) .",
    "we note that while some of the large - scale trends could be partially removed by adopting higher - order polynomials , these discontinuities , which have about the same amplitude as the remaining large - scale trends ( @xmath40.02 pixels ) , would still remain .",
    "these residuals are very similar to those seen in kozhurina - platais et al .",
    "( 2010 ) .",
    "it is interesting to note that these @xmath40.02 pixel systematic trends are perfectly consistent with the larger - than - expected residual dispersion already noted in paper  i. these fine - scale trends were simply washed out by the large internal motions of the @xmath3  cen stars ( @xmath40.15 wfc3/uvis pixel ) over the 7-year baseline between the reference - frame observations of go-9442 in 2002 and the wfc3/uvis observations of pid-11452 in 2009 .",
    "the top panel of fig .",
    "[ fig : fetta ] shows the residuals @xmath7 plotted against the @xmath8 coordinates , for stars measured within a 100-pixel - tall strip , centered at @xmath9 , extracted from chip[1 ] .",
    "this is the bottom chip , and the first extension in the ` _ flt ` file .",
    "this chip is named uvis2 , but to avoid ambiguity ( and to maintain the convention in paper  i ) we will refer to it with brackets , according to its order within the ` fits`-image extensions . ] .    constraining the @xmath7 residuals within a vertical strip highlights the sharp changes in the residual trend .",
    "it is important to note that these discontinuities are present in _ both _ axes of the wfc3/uvis detectors and not only along a single axis , as was the case for wfpc2 ( anderson & king 1999 ) or acs / wfc ( anderson 2002 ) .    the bottom panel of fig .",
    "[ fig : fetta ] shows that these boundaries show up as single - row excursions of up to @xmath10% in the f814w flat fields .",
    "this was also seen for wfpc2 and acs / wfc .",
    "these discontinuities can be explained as small manufacturing defects in the ccds , analogous to those found for the wfpc2 and acs / wfc detectors .",
    "these defects arose from an imperfect alignment between the silicon wafer and the mask used to generate the ccds pixel boundaries during lithographic projection ( see kozhurina - platais et al .",
    "indeed , at the location where these repositioning errors are found , pixels are wider or narrower in one direction . as a consequence ,",
    "these pixels are respectively brighter or fainter on the flat field , since they collect more or less light .",
    "this also leads to the observed astrometric discontinuities .",
    "the @xmath11-axis pattern of these lithographic features on wfc3/uvis ccds are a single pixel wide in the flat field and have a period of 675 pixels along the @xmath8 axis for both chips , extending back and forth from the central position @xmath12 . , @xmath13 pixels . ]",
    "note that this implies that we are left with the first and last 23.5-pixel - wide vertical strips where the discontinuity is repeated .",
    "the horizontal feature along the @xmath11 axis consists of a single 2-pixel - wide discontinuity , centered at @xmath14 pixels for chip[1 ] and at @xmath15 pixels for chip[2 ] .",
    "these discontinuities are located symmetrically with respect to the gap between the two chips ( horizontal solid red lines in fig .",
    "[ fig : res_before ] ) . a careful look at fig .",
    "[ fig : fetta ] reveals hints of finer discontinuities on both astrometry ( top panel ) and flat field ( bottom panel ) , but at much lower amplitudes ( a few thousandths of a pixel and @xmath16% ) , however it s hard to assess their significance .",
    "our aim here was to find a simple correction of the gd following the basic principle : `` we see a systematic error , and we empirically find a correction for it '' .",
    "we therefore decided to keep a polynomial of the third order , as we did in paper  i , to remove most of the gd ( down to the @xmath17 mas level ) , and then to use a single look - up table ( one for each chip and filter ) to correct all the smaller - scale positional systematic errors .",
    "this approach was able to provide accuracies down to 0.008 pixel ( @xmath18 mas ) , as we will show in the next section .",
    "we set up the look - up table as follows .",
    "first we defined @xmath8 boundaries alongside the lithographic feature discontinuities ( red solid lines in fig .  [",
    "fig : res_before ] ) .",
    "we subdivided each of the 675-@xmath8-pixel - wide regions into six 112.5-pixel - wide sub - regions , for a total of 36 such subdivisions plus two 23.5-pixel - wide regions at the left and right edges of each chip . to maintain a similar sampling along the @xmath11 axis",
    ", we defined 18 sub - divisions . as",
    "the horizontal component of the lithographic feature divides the two chips in two parts of 911 and 1140 pixels tall , we made 8 subdivisions for the 911-@xmath11-pixel one ( 113.875 pixels each ) and 10 for the other ( 114 pixels each ) . at the end",
    "we produced an array of @xmath19 almost - square cells , plus two 23.5-pixel - wide strips at the short edges of each chip , each made of 18 rectangular cells ( grey dashed lines in figs .",
    "[ fig : res_before ] ) .",
    "cell dimensions were ultimately dictated by the necessity to have enough grid - points to finely sample the gd and to have an adequate number of stars within each cell to robustly measure the value of the grid points in the look - up table .",
    "we always had more than 30 stars in each cell to constrain the value of the table , even for the filters with the fewest number of well - exposed stars .",
    "typically we had well over 100 stars per cell .",
    "figure  [ fig : scheme ] shows an example of the geometry adopted for the look - up tables .",
    "thick solid lines mark detector edges , dashed lines identify lithographic discontinuities , while dotted lines highlight cell borders .",
    "we used stars within each cell to compute @xmath20-clipped median positional residuals @xmath21 and @xmath22 , which are assigned to the corresponding grid point ( open circles ) .",
    "when a cell adjoins either detector edges or lithographic discontinuities , the grid point is displaced to the edge of the cell , as shown .",
    "we use a semicircle to indicate when a grid point corresponds to a discontinuity .    for any given location on the chip , the look - up table correction is given by a bi - linear interpolation among the surrounding four grid points ( as illustrated by the arrows in fig .",
    "[ fig : scheme ] ) .",
    "in the two 23.5-pixel - wide strips the correction is given by a linear interpolation of the two closest grid points along the @xmath11 axis .",
    "to derive the look - up table we used a master frame which is itself affected by these lithographic features , since it was constructed from positions that had not been corrected for them .",
    "once we had a first estimate of the tabular corrections , we re - determined an improved master frame by correcting our raw catalogs with both the polynomial and the look - up table component .",
    "we repeated the whole process of building up master frames and improving the table values three times .",
    "a fourth iteration proved to offer negligible improvement .",
    "figure  [ fig : res_after ] shows positional residuals in the raw reference system , after our final look - up table plus polynomial gd correction is applied .",
    "residual vectors are now magnified by a factor 100@xmath23000 .",
    "all the lithographic features and all other high - frequency patterns seen on fig .",
    "[ fig : res_before ] appear to be completely removed .",
    "one of the best estimates of the true errors of the gd solution is given by the magnitude of the dispersion ( computed as the 68.27@xmath24 percentile ) of the positional residuals ( rms ) of each star ( @xmath25 ) observed in each image ( @xmath26 ) , which have been gd - corrected and transformed into the master frame @xmath27 .",
    "these are computed as : @xmath28 } =             \\sqrt { ( x_i^{t_{j}}-x_{{\\rm master},i})^2                  + ( y_i^{t_{j}}-y_{{\\rm master},i})^2 } .\\ ] ] only stars observed at least in 3 individual images are used to compute the rms .",
    "figure  [ fig : res ] shows these dispersions as a function of the corresponding instrumental magnitude for different filters.$ ] ) . ]",
    "saturation typically sets in brightward of @xmath4@xmath2913.5 ( marked by the left blue vertical line ) . for well - exposed stars ( typically between magnitude @xmath2913.5 and @xmath2912.5 , but we include fainter stars for f225w and f275w filters to improve the statistics ) , the 68.27@xmath24 percentile levels of the positional rms are marked by red horizontal lines .",
    "the corresponding 1-d values are displayed at the top of each panel , in units of both pixels and mas .",
    "the best results are obtained for redder filters .",
    "here we used all the images listed in table  [ tab1 ] ( two to four different epochs for each filter ) to compute positional rms .",
    "we will see in the next section that , by selecting only images within the same epoch , positional dispersions are even smaller .",
    "we noted that very blue and very red stars behave differently with respect to our gd correction when observed through the bluest filters ( kozhurina - platais et al .",
    "( 2011 ) see a similar effect ) .",
    "this is probably due to a chromatic effect induced by fused - silica ccd windows within the optical system , which refract differently blue and red photons and have a sharp increase of the refractive index below 4000   ( george hartig , personal communication ) . as a consequence ,",
    "the f225w , f275w and f336w filters are the most affected .    to better understand how much astrometry will suffer from this phenomenon",
    ", we performed the following test .",
    "we chose the f225w and f275w data sets for which the effect is maximized and both extreme horizontal branch ( ehb , with a temperature above 40@xmath23000@xmath23k ) and red giant branch ( rgb , with a temperature of @xmath43000@xmath23k ) stars have about the same luminosity ( i.e. , our positional dispersions have the same size ) .",
    "we also required images to be taken within the same epoch 2010.04 ( 9 exposures for each filter ) , to avoid cluster internal - motion effects .    in the f225w vs. f225w@xmath29f275w cmd we selected relatively bright ( f225w@xmath30@xmath299.7 ) , unsaturated stars of intermediate color ( marked in green on the left panel of fig .",
    "[ fig : brtest ] ) and used them to compute a linear transformation from the f275w master frame into the f225w frame . on the same cmd we also selected other groups of stars with the same luminosity criteria : ( i ) a blue set made up of ehb and hot white - dwarf stars ; ( ii ) a red set containing intermediate rgb stars and ( iii ) a final purple set populated by rgb - tip stars .",
    "comparing star positional residuals we found that green stars are distributed around ( 0,0 ) , as we would have expected since their positions formed the basis for the transformations , while stars of the other groups were found to have residuals located in significantly different positions ( up to @xmath31 pixels away ) .",
    "on the right panel of fig .  [",
    "fig : brtest ] we show the vector - point diagram for selected stars , which are color coded as on the left panel of the same figure .",
    "median position residuals for each group of stars are marked by full circles of the same colors .",
    "the size of the circle indicates the formal error in the median . a systematic trend of the displacements as a function of stellar color is clear .",
    "further investigations will be required to fully characterize this chromatic effect .",
    "the globular cluster @xmath3  cen has the largest internal - proper - motion dispersion among galactic globular clusters despite being more than two times farther than the closest ones ( 4.7 kpc , van der marel & anderson 2010 , versus 2.2 kpc for m  4 and 2.3 kpc for ngc  6397 , harris 1996 , dec .",
    "2010 revision ) . in this section",
    "we show that , by applying our gd solution , we are able to measure this dispersion in just a few months .    to minimize chromatic effects , we used only f814w images and created three distortion - free frames , one for each of the three available epochs ( @xmath32=2010.04 , @xmath33=2010.33 , @xmath34=2010.51 , hereafter @xmath35 , @xmath36 , @xmath37 respectively ) .",
    "we selected well - exposed , unsaturated stars ( instrumental magnitude @xmath38 ) in common to all the three epochs , and compared the positional displacements seen between @xmath39 and @xmath40 .    detection of the intrinsic motion of the stars would reveal itself as a correlation between the displacements @xmath39 and @xmath40 , proportional to the ratio of the respective time baselines @xmath41 . on the contrary , had these displacements been dominated by random errors , we would expect no correlation at all between the two displacements , or at least a correlation with a different slope .",
    "this is shown on the left panels of fig .",
    "[ fig : ipm ] , where we see a clear correlation between the two coupled epochs in both the @xmath42- and @xmath43-directions ( top and bottom panels , respectively ) .",
    "note that the slope of the straight line simply corresponds to the ratio between the two time base - lines and it is not a fit to the data points .",
    "if we assume a gaussian distribution for the observed displacements , the dispersions along the line , and those perpendicular to it , can give us an estimate of the intrinsic proper - motion and the errors dispersion , respectively .",
    "in the following we will derive a crude estimate for both .",
    "we used the symbols @xmath44 and @xmath45 [ in mas ] to indicate the standard deviation of the displacements @xmath39 and @xmath40 .",
    "we then considered that the _ observed _ proper - motion dispersion , @xmath46 , is related to the intrinsic proper - motion dispersion ( @xmath47 ) and the measurement errors ( @xmath48 ) by the following equation : @xmath49.\\ ] ] therefore @xmath47 can be obtained as : @xmath50.\\ ] ]    the quantity @xmath46 can also be computed as the ratio between the displacements dispersions and their time baseline : and @xmath36 to be similar , a reasonable working hypothesis . ]",
    "@xmath51,\\ ] ] from which follows the relation : @xmath52.\\ ] ]    we defined the dispersion of data points along the line in fig.[fig : ipm ] as @xmath53 , which is an observable quantity and related to the others by the equation @xmath54,\\ ] ] which implies @xmath55.\\ ] ] the latter , substituted in eq .",
    "[ eq2 ] , gives @xmath56},\\ ] ] which relates the observed proper - motion dispersion to the observed dispersion along the expected correlation .",
    "assuming any deviation from the line to represents the total error of the data point , an estimate of @xmath48 can be obtained by the dispersion of data points perpendicularly to the line : @xmath57},\\ ] ]    top - right panel of fig .",
    "[ fig : ipm ] shows the histograms of the @xmath42-displacement dispersions along ( filled circles ) and perpendicular ( open circles ) to the expected correlations .",
    "poisson error bars and gaussian best fits are also shown .",
    "standard deviations @xmath53 and @xmath58 are computed as the 68.27@xmath24 percentile of the distribution residuals around their median value .",
    "the bottom - right panel shows the same for @xmath43-axis displacement dispersions .    taking the average of @xmath53 and @xmath58 from the displacements along @xmath42 and @xmath43 , we had @xmath59 mas and @xmath60 mas . by using the previous equations  [ eq1 ] ,  [ eq3 ] and [ eq4 ]",
    ", we obtained an intrinsic dispersion of @xmath61 mas yr@xmath62 , which is in remarkable agreement with the value @xmath63 mas yr@xmath62 measured by anderson & van der marel ( 2010 ) using a time baseline almost 9 times larger ( 4.07 years vs.  172 days ! ) , and more images .",
    "this result is even more astonishing if we consider that we did not use local transformations ( see , e.g. , bedin et al .",
    "2003 ; anderson et al .",
    "2006 , anderson & van der marel 2010 ) which would further reduce systematic residuals in the gd solution , as well as any correction for breathing ( which can introduce small low - order terms ) or charge - transfer inefficiency ( which is already plaguing this new camera ; see figure  [ fig : cti ] ) .    as a final external check on the achieved accuracy",
    ", we can assume the uncertainties on @xmath35 to cancel out and @xmath36 and @xmath37 to equally contribute to @xmath64 ( @xmath65 ) .",
    "having @xmath49 exposures per epoch , we can infer a 1-d positional accuracy of 0.008 pixels , @xmath40.3 mas ( @xmath66 ) , which is consistent with the value reported in fig .",
    "[ fig : res ] .",
    "it should also be noted that , at this level of accuracy , there is a considerable interplay between the derived psf models and the gd solution , which might play some role on the achievable astrometric precision .",
    "on account of breathing and other phenomena , the distortion solution is not perfectly stable over time .",
    "the impact of breathing is not well enough understood to predict its impact on the distortion , so the best we can hope to achieve is an average distortion solution and a sense of how stable the solution is about this average .",
    "it is typically the low - order terms that are the most time - variable , so it made sense above to construct the best single - chip - based solution first and only later to consider the less accurate larger - scale terms that relate the two chips to a common frame .",
    "we do that here with the understanding , that for the highest - precision differential astrometry , it is always best to perform the measurements as locally as possible , provided that there are an adequate number of reference stars .",
    "some projects , however have few reference objects and require knowledge of the distortion over the full extent of the field of view ( fov ) .",
    "we solved for these global terms in several stages .",
    "first , we put the two chips into a meta coordinate frame .",
    "next , we solved for the linear skew terms present in the combined system .",
    "then we solved for the overall scaling , so that all filters would have the same scaling , in terms of pixels per arcsecond .",
    "finally , we solved for the positional offset between the filters .",
    "we based our meta - coordinate frame on the distortion - corrected frame of the bottom chip ( chip[1 ] ) .",
    "the bottom chip is already in this system , so we simply needed to find the transformation that put the top chip ( chip[2 ] ) into this same system . since there is a gap of about 35 pixels between the frames , the two chips of a single exposure naturally have no sources in common",
    "this means that we will have to use an intermediate set of observations to accomplish the mapping .",
    "we took all the f606w observations and identified all pairs of observations that had either an offset of more than 500 pixels or an orientation difference of more than 10 degrees .",
    "( if the pointings are too similar then the overlap will not be sufficient . )",
    "since we wanted as many different pairs of exposures as possible , we also incorporated images from pid-12094 ( pi - kozhurina - platais ) , which provides additional roll angles .",
    "there were a total of 32 variously overlapping f606w exposures , so in general we could work with 992 overlapping pairs .    for each qualifying pair , we found which chip(s ) in the first exposure had significant overlap with both chips in the second exposure .",
    "we first corrected all positions for distortion using the solution found above .",
    "we next used the positions of common stars to solve for the 4-parameter conformal linear transformation from the top chip of the second exposure into the overlapping chip of the first exposure .",
    "we then solved for the analogous transformation from the overlapping chip to the bottom chip of the second exposure . by combining these two linear transformations",
    ", we were able to bootstrap positions in the top chip to positions in the bottom chip .    using all pairs of exposures with good intermediate - chip overlap",
    ", we found a transformation of the form : @xmath67    where @xmath68 and @xmath69 to relate the distortion - corrected coordinates in the top chip @xmath70 into the system of the bottom frame .",
    "this was found for each exposure where both of its chips overlapped significantly with a chip from a different exposure .",
    "we then found average values for the six parameters .",
    "this gave us a rough meta - frame system .",
    "since the single - chip overlaps can be limited , we then iterated this solution , this time using both chips in the comparison exposure ( by means of the meta solution ) to examine any residuals in the positioning of the top chip relative to the bottom .",
    "we converged upon : @xmath71 for the f606w data set .",
    "this means that the central pixel of the top chip ( 2048,1024 ) , where @xmath72 and @xmath73 are zero , is located at coordinate @xmath74 = @xmath75 in the distortion - corrected frame of the bottom chip .",
    "the near - conformal nature of this transformation ( @xmath76 and @xmath77 ) demonstrates that the skew was accurately measured in the original solution .",
    "now that we had a master frame for the f606w exposures , we used the f606w data set as comparison images to solve for the same parameters for the other filters .",
    "we would expect them to be similar , but since the solution for each filter was found independent of the other filters , there could be small scale or orientation changes that would impact the chip[1 ] frame , and hence the location of chip[2 ] in chip[1 ] coordinates .",
    "table  [ tab3 ] provides these inter - chip transformation parameters for all filters .",
    "[ cols=\"^ , > , > , > , > , > , > , > , > , > \" , ]      the solution for each chip / filter combination described above was performed without reference to other chips and filters .",
    "the goal of this section is to tie everything together into a common system . in the coordinate transformations above",
    ", we always solved for a scale before we examined residuals .",
    "the reason for this is that the scale of the telescope is always changing , partly due to breathing and partly due to velocity aberration .    now that the offset and rotation for each chip / filter combination had been determined to place each of the chips into a common master frame , the overall scale was the last of the linear parameters to be solved for . to do this",
    ", we constructed a master frame based on only the f606w exposures using only transformations allowed for offset and rotation , but no scale changes .",
    "this way , the frame would represent the average scale of the f606w exposures .",
    "we then transformed the positions of the stars in each of the exposures for each filter ( 203 in total , including the pid-12094 data ) into this reference frame and took note of the scale factor of the linear transformation .",
    "we plot this scale factor for each exposure on the top panels of figure  [ fig : scale_by_filt ] .",
    "the images are ordered by filter and the filters are separated by a vertical dotted line .",
    "it is clear that there is some trend with filter , but there is considerable intra - filter scatter as well .",
    "this scatter could be due to velocity aberration or breathing .",
    "we divided each of the above scale measurements by the ` vafactor ` keyword , taken from the image header .",
    "it reports the expected special - relativistic variation in the plate scale , which is related to the dot - product between the average telescope velocity vector during the exposure and the direction to the target ( see cox & gilliland 2002 ) . after making this deterministic correction",
    ", we found that the global exposures for each filter were now consistent to within 0.01 pixel ( as shown on the bottom panels of fig .",
    "[ fig : scale_by_filt ] ) .",
    "we solved for the average scaling for each filter and included this correction in the meta distortion solution .",
    "the average scaling we found for each filter is given in the eighth column of table  [ tab3 ] .",
    "they are in good qualitative agreement with the findings in figure 2 of kozhurina - platais et al .",
    "we note that the linear terms of uvis appear to be considerably more stable than those of acs / wfc .",
    "figure 6 of anderson ( 2006 ) shows that the acs fov changes in radius by @xmath780.03 pixel due to breathing , while the residuals here are about 0.01 pixel .",
    "we want emphasize that breathing can introduce errors larger than 0.008 pixel into the distortion solution .",
    "our single - chip - based gd correction was generated comparing largely half - chip to half - chip positions ( due to the dithering scheme of the exposures ) .",
    "therefore , the global effect due to breathing is reduced to about a quarter with respect to what it would be by comparing whole chips to whole chips ( since errors tend to be quadratic ) .",
    "wedge effects can cause individual filters to induce small shifts in the positions of stars on the chip . since the zeropoint of our distortion solution for each filter is entirely arbitrary",
    ", we have the flexibility of choosing it in a convenient way .",
    "we would like the distortion solution to have the property that , if a star is observed through two different filters with no dither , the two filters will report the same distortion - corrected position for the star , even if the wedge effect may cause the apparent positions on the chip to differ by more than a pixel .",
    "we identified two sets of consecutive exposures of the @xmath3  cen central field that had no commanded ` pos - targs ` between them and found the offset for each filter that best registered its distortion - corrected positions with those of the f606w images .",
    "these offsets are given in the last two columns of table  [ tab3 ] .",
    "based on the agreement between the two comparisons we have for each filter , these offsets should be accurate to about 0.05 pixel .",
    "note that the offset for f775w is quite large ( 1.47 pixel ) ; the others are typically 0.5 pixel .",
    "the distortion solution presented here was constructed to match the pixel scale and orientation of the center of chip[1 ] . to determine the absolute scale of this frame , we compared the commanded offsets in arcseconds ( from the commanded pos_targs ) with the achieved offsets ( in pixels ) .",
    "pid-11911 contained visits in which 9 exposures in f606w were taken in a 3@xmath793 grid with offsets of 40  between the exposures .",
    "we measured the achieved offsets from the central exposure in distortion - corrected pixels and found that the grid spacing in pixels corresponded to 1005.67 pixels in one visit and 1005.79 in the second visit .",
    "this implies a plate scale for our frame of @xmath80 pixels per arcsecond , which corresponds to @xmath81 mas pixel@xmath62 .",
    "this value is consistent with the independent estimate of the scale given in paper  i ( @xmath82 mas , internal errors only ) , which is based on the best knowledge of the acs / wfc absolute scale .",
    "after establishing all of these global parameters as described , we noticed that the frame we had adopted , which was centered on the central pixel of chip[1 ] ( the bottom chip ) , extended into negative coordinates in the lower left of the frame .",
    "this is due to our choice of center and the nature of the intrinsic skew present in the detector .",
    "since it is often convenient to work with positive coordinates , we decided to add 200 to the meta coordinate system in @xmath43 , so that positions within the detector would always have positive coordinate values .",
    "by using a large number of well dithered data - sets taken with different roll angles , we have modeled the gd of wfc3/uvis by means of a self - calibration .",
    "the solution is an improvement with respect to paper  i and consists of a set of third - order - correction coefficients plus a finely - spaced look - up table of residuals for each chip in 10 filters , namely :  f225w , f275w , f336w , f390w , f438w , f555w , f606w , f775w , f814w and f850lp .",
    "the hybrid solution has been shown to correct the manufacturing defects and the high - spatial frequency residuals seen in paper  i.    the use of these corrections removes the distortion over the entire area of each chip to an accuracy significantly better than @xmath40.01 pixel ( i.e. better than @xmath40.4 mas ) . as a demonstrative test we applied our solution to f814w exposures collected at different epochs and were able to measure the internal motion of @xmath3  cen in just few months , finding values consistent with the most recent determinations .",
    "the initial solution was constructed for each chip for each filter independently .",
    "this is because we did not want any possible motion between the chips or large - scale breathing non - linearities to impact our solution .",
    "once we had the solution for each filter and chip , we unified them into a single common coordinate system .",
    "we found the linear transformation that took the top chip into the frame of the bottom chip for each filter , we found the relative scalings between the different filters and finally we found the offsets caused by the wedge - effect of each filter .",
    "we make our ` fortran ` routine ` wfc3_uvis_gc.f ` publicly available ( at the url ` www.stsci.edu/\\simjayander/wfc3uv_gc/ ` ) to the astronomical community .",
    "it requires 4 quantities in input : the raw positions @xmath8 and @xmath11 , the chip number and the filter . in output",
    "it produces corrected positions @xmath83 and @xmath84 in the meta - coordinate frame .",
    "in addition to the ` fortran ` code , we will also provide the solution in the form of simple fits images .",
    "the `` image_format '' directory of the website above contains forty images , one for each coordinate / chip / filter combination . as an example , the image gc_wfc3uvis_f606w_chip1x.fits is a 4096@xmath792051 real@xmath854 image with each pixel in the image giving the @xmath42 coordinate of the distortion - corrected position of that pixel . to distortion - correct decimal pixel locations , the image can simply be interpolated bi - linearly .",
    "these images should make our solution accessible for those who use languages other than ` fortran ` .",
    "finally , we want to state clearly to the reader that this is not the official gd calibration .",
    "the idctab file , which contains independent polynomial calibrations for the 10 uvis filters , is installed in stsci s calibration database system and is used for the opus pipeline processing of rectified ` drz ` images ( kozhurina - platais et al .",
    "2009 , 2010 ) .",
    "the two solutions were designed for different goals .",
    "ours was constructed with high - precision differential astrometry in mind , while the official solution was more focused on the absolute transformation onto the focal plane .",
    "we thank alceste z.  bonanos for polishing the manuscript .",
    "a.b .  acknowledges the support by the stsci under the 2008 graduate research assistantship program and by miur under program prin2007 ( prot .",
    "20075tp5k9 ) .",
    "kozhurina - platais , v. , cox , c , petro , l. , dulude , m. , and mack , j. _ `` multi - wavelength geometric distortion solution for wfc3/uvis and ir '' _ in proceedings of the 2010 hst calibration workshop , eds .",
    "s. deustua and c. oliveira ( baltimore : stsci ) , in press ( 2010 ) ."
  ],
  "abstract_text": [
    "<S> we present an improved geometric - distortion solution for the _ hubble space telescope _ uvis channel of wide field camera 3 for ten broad - band filters . </S>",
    "<S> the solution is made up of three parts :  ( 1 ) a 3@xmath0-order polynomial to deal with the general optical distortion , ( 2 ) a table of residuals that accounts for both chip - related anomalies and fine - structure introduced by the filter , and ( 3 ) a linear transformation to put the two chips into a convenient master frame . the final correction is better than 0.008 pixel ( @xmath1 mas ) in each coordinate . </S>",
    "<S> we provide the solution in two different forms : a ` fortran ` subroutine and a set of ` fits ` files , one for each filter / chip / coordinate . </S>"
  ]
}