{
  "article_text": [
    "no planet orbits on a precisely keplerian orbit : post - newtonian corrections , stellar oblateness , and , most importantly , planetary perturbations cause deviations from a periodic ephemeris for transiting exoplanets @xcite .",
    "transit - timing variations ( ttvs ) have been used to confirm that transit signals are in fact due to planets @xcite , to detect and characterize non - transiting planets @xcite , and to make precise measurements of the masses and dynamical states of multi - transiting exoplanet systems ( e.g. * ? ? ?",
    "* ) .    for the latter two applications , fast computation of ttvs",
    "is required for rapid searching through parameter space for perturbing companions , and for rapid computation of the posterior distributions of the masses and orbital elements of transiting planet systems .",
    "numerical computation of ttvs can be sped up through symplectic integration , through a more efficient numerical solution of kepler s equation , and through transit time interpolation @xcite ; however , this approach can still be too computationally intensive for high multiplicity systems , and does not pinpoint the physical origin of constraints upon planetary system properties .",
    "analytic formulae based on perturbation theory can greatly speed computation , but the perturbation theory to high order in eccentricity and inclination becomes complicated quickly , and numerical codes that implement the analytic formulae have not been released or widely used @xcite . much can be accomplished with first order ( in eccentricity ) perturbation theory because orbital eccentricities of many planets exhibiting ttvs are small .",
    "ttvs are most easily observed for pairs of planets near a mean motion resonance ; thanks to the low eccentricity of the systems in consideration @xcite , the first order resonances are most represented among ttv pairs , and it is for first order resonances that a first order theory is adequate .",
    "ttvs caused by these first order resonant interactions are primarily sinusoidal and are subject to a degeneracy between mass and eccentricity @xcite , caused by mixing of two frequencies of perturbation which are aliased at the frequency of the transiting planet , as explained in an elegant analysis by ( * ? ? ?",
    "* hereafter lxw12 ) . to break this degeneracy",
    "requires the measurement of additional modes , such as the short - timescale ttvs known as ` chopping ' variations @xcite , or statistical analysis of many systems @xcite .",
    "in addition , the lxw12 analysis is only approximate , and breaks down for pairs further from resonance @xcite .",
    "these issues motivate the current paper in which we derive an explicit formula for ttvs accurate to first order in eccentricity and planet - star mass ratio , valid for ( nearly ) plane - parallel transiting planets ( although @xcite showed that mutual inclinations of planets can be large and still be well described by coplanar ttvs ) .",
    "we expect that these results will be useful a ) for determining how different frequencies within the ttv signal constrain the planetary masses and orbital elements @xcite ; b ) for analyzing systems with a large number of interacting transiting planets by making linear additions of the analytic formula for pairs of planets @xcite ; and c ) for rapid search through parameter space of perturbing planets .",
    "we first summarize the ttv solution to first order in eccentricity and mass in ",
    "[ ttv_result ] ( the full derivation is given in appendix [ ttv_calculation ] ) .",
    "we then compare these with prior results , both analytic and numeric (  [ ttv_comparison ] ) , including comparison of analytic and numeric analyses of specific systems .",
    "we discuss the numerical implementation and speed in  [ numerics ] .",
    "we end with a discussion of the possible applications and future directions (  [ conclusions ] ) .",
    "here we give a complete summary of the assumptions and variables used , and the solution to the first - order equations for readers that wish to simply use the results of this computation .",
    "the details of the derivation are given in appendix [ ttv_calculation ] .",
    "since multi - planet transiting systems typically have nearly edge - on orbits and hence small mutual inclinations , it is usually sufficient in analytic approximations to treat the problem in the plane - parallel approximation .",
    "this leaves four orbital elements for each planet ( semi - major axis , @xmath0 , mean longitude , @xmath1 , eccentricity , @xmath2 , and longitude of periastron , @xmath3 ) , plus the mass ratio of each planet to the star , @xmath4 , where @xmath5 is the mass of the inner planet , @xmath6 is the mass of the outer planet , and @xmath7 is the mass of the star . for nearly circular planetary orbits , there are two small dimensionless parameters in the problem : @xmath8 and @xmath2 .",
    "the usual procedure for computing transit timing variations is to : 1 ) to write down a hamiltonian ( or disturbing function ) for perturbations due to another planet ; 2 ) expand the hamiltonian as a function of the orbital elements to the order in eccentricity desired plus one ( e.g.  if a transit timing solution is needed to first order in eccentricity , then the hamiltonian must be expanded to second order in eccentricity ) , including the linear combinations of mean - longitudes leading to the important resonant terms necessary for sufficient accuracy ; 3 ) compute the variation in the orbital elements using hamilton s equations , which are four first - order partial differential equations for each planet , and involves differentiating the hamiltonian with respect to the orbital elements ( which can be a rather complex operation ) ; 4 ) integrate the resulting equations as a function of time ; 5 ) compute the true longitudes , @xmath9 , as a function of time , where @xmath10 is the unperturbed keplerian orbit , and @xmath11 is the perturbation of the @xmath12th planet caused by its planet companion(s ) ; 6 ) compute the transit timing variations : @xmath13 this is the approach taken by @xcite , @xcite , and lxw12 . a different approach employing hamiltonian perturbation theory @xcite",
    "was used in @xcite .",
    "this involves determining the canonical transformation between the full canonical orbital element set and the average set ; the ttvs , which are deviations from an average  keplerian \" orbit , can be derived from this transformation .",
    "the standard procedure outlined in detail above ( based on hamilton s equations ) has the advantages of requiring only first - order differential equations for the computation , and the advantage of using standard methods in celestial mechanics for the computation .",
    "however , there are two possible drawbacks : 1 ) the expansion of the hamiltonian in orbital elements can be rather complex ; 2 ) the main quantity of interest for transit - timing variations is @xmath11 , rather than the perturbed orbital elements .",
    "the derivation based on canonical transformations @xcite , though elegant , has the disadvantage of requiring the extra machinery and knowledge of hamiltonian perturbation theory .    in our new derivation",
    "we forgo computing the orbital elements , and simply treat the problem in polar coordinates @xmath14 .",
    "we then use newton s equations in terms of a disturbing function which can be expressed as a function of polar coordinates , with the added advantage that newton s equations make clearer which forces are causing the perturbations .",
    "this approach has some possible advantages : 1 ) only two differential equations are necessary ( albeit second - order rather than first - order ) ; 2 ) the derivatives of the disturbing function with respect to the polar coordinates are easy to compute ; 3 ) the perturbed polar coordinates directly yield the transit timing variations ; 4 ) the resulting expression is more compact than in the hamiltonian formulation .",
    "the second - order differential equation may seem like a drawback , but it can be solved using complex notation ( as in lxw12 ) and by expanding the derivatives of the disturbing function in terms of orbital elements , which yields harmonic functions which are easy to integrate . the final answer is expressed as a sum over harmonics of the perturbing planet s orbital frequency @xcite . each coefficient for each planet in the harmonic series solution can be solved for by inverting three two - by - two matrices , which have a standard format , resulting directly in the transit timing variations at a particular frequency .",
    "the unperturbed orbital frequencies , @xmath15 , are defined by @xmath16 . as usual , @xmath17 .",
    "we define @xmath18 where @xmath19 is the laplace coefficient , @xmath20 the difference in mean longitude of the planets is @xmath21 .",
    "auxiliary dimensionless quantities are : @xmath22 the functions @xmath23 we use below are given by : @xmath24    to use this solution in computing ttvs , the longitudes need to be computed from the observed transit times ; the mean ephemeris , @xmath25 , may be used in computing the ( unperturbed ) orbital ephemeris .",
    "now , the mean longitudes are given to first order in eccentricity by @xmath26 if we assume that the orbital reference is along the line of sight , and thus @xmath27 at the times of transit .",
    "the solutions for the inner planet ( @xmath28 ) and outer planet ( @xmath29 ) are given by : @xmath30 } + f_{1,j}^{(+1)}e_1 \\sin{\\left[j\\psi+(\\lambda_1-\\varpi_1)\\right]}\\cr & + & f_{1,j-1}^{(-2)}e_2\\sin{\\left[j\\psi-(\\lambda_1-\\varpi_2)\\right ] } + f_{1,j+1}^{(+2)}e_2 \\sin{\\left[j\\psi+(\\lambda_1-\\varpi_2)\\right]}\\big],\\cr \\delta t_2 & = & \\frac{p_2}{2\\pi } \\mu_1 \\sum_{j\\ge 1 } \\big[f_{2,j}^{(0 ) } \\sin{(j\\psi ) } + f_{2,j}^{(-2 ) } e_2 \\sin{\\left[j\\psi-(\\lambda_2-\\varpi_2)\\right ] } + f_{2,j}^{(+2 ) } e_2 \\sin{\\left[j\\psi+(\\lambda_2-\\varpi_2)\\right]}\\cr & + & f_{2,j+1}^{(-1 ) } e_1 \\sin{\\left[j\\psi-(\\lambda_2-\\varpi_1)\\right ] } + f_{2,j-1}^{(+1 ) } e_1 \\sin{\\left[j\\psi+(\\lambda_2-\\varpi_1)\\right]}\\big],\\end{aligned}\\ ] ] where the functions @xmath31 are given by : @xmath32 where @xmath33 , @xmath34 , and @xmath35 and @xmath36 , @xmath37 , and @xmath38 are given in table [ tab01 ] , and @xmath39 is the kronecker delta function .",
    "note that the top signs in @xmath40 correspond to @xmath41 values , while the bottom correspond to @xmath42 .",
    "the functions @xmath31 are solely a function of @xmath43 , @xmath44 , and @xmath45 .",
    "cclll[tab01 ] @xmath12 & @xmath44 & @xmath46 $ ] & @xmath47 $ ] & @xmath48 $ ] 1 & @xmath49 $ ] & @xmath50 & @xmath51 & @xmath52 1 & @xmath531 & @xmath54 & @xmath55 & @xmath56 1 & @xmath532 & @xmath57 & @xmath58 & @xmath592 & @xmath60 $ ] & @xmath61 & @xmath62 & @xmath632 & @xmath64 & @xmath65 & @xmath66 & @xmath672 & @xmath68 & @xmath69 & @xmath70 & @xmath71    in practice the sum over @xmath43 from 1 to @xmath72 must be truncated at a finite value of @xmath73 . typically @xmath73 does not need to be chosen to be too large since the laplace coefficients decline in amplitude with @xmath43 @xcite .",
    "we recommend choosing a @xmath73 large enough such that the resulting computation is converged .    as an example of using table [ tab01 ] , the coefficient @xmath74 has @xmath75 , @xmath76 , @xmath77 and @xmath78 , @xmath79 , @xmath80 , and @xmath81 .",
    "then , the coefficient is given by : @xmath82",
    "the zeroth - order solution ( in the limit @xmath83 ) compares exactly with the results given in @xcite , @xcite , and @xcite which were derived with hamilton s equations and the approach based on canonical transformations ; this is reassuring given the very different approach used in this derivation .",
    "we have also rederived the first - order eccentricity equations using the approach based on canonical perturbation theory employed in @xcite , and found exact agreement with the results presented here to first order in eccentricity .    in figures ( [ inner_coefficients ] ) and ( [ outer_coefficients ] ) we plot the eccentricity - dependent coefficients , @xmath84 , as a function of period ratio , @xmath85 .",
    "the zeroth - order eccentricity coefficients are plotted in @xcite .",
    "the first - order coefficients can show three singularities for the terms with superscripts @xmath86 and @xmath87 near first - order resonance , second - order resonance , and @xmath88 .     for the inner planet .",
    "the dashed lines show where the coefficients are negative . ]     for the outer planet .",
    "the dashed lines show where the coefficients are negative . ]",
    "lxw12 present a formula valid near ( but not in ) first order mean - motion resonances that captures the behavior of resonant terms in an elegant , but approximate , manner .",
    "here we compare the complete formulae given here to their near - resonant formulae .",
    "the expressions for @xmath89 and @xmath90 do not show the same dependence in the denominator as the expressions in lxw12 ; their expression just contains the resonant frequency , @xmath91 , while ours contains additional frequencies .",
    "we carried out the partial fraction expansion of @xmath89 to isolate the denominator which matches lxw12 s expression , and we find that the expressions agree exactly with their expressions ( a28 ) and ( a29 ) .    to compare our full expression with lxw12 s , we have computed the eccentricity - dependent @xmath92 ( near 2:3 ) expression for the inner and outer planets ( as this term is unaffected by the indirect terms ) .",
    "we re - write the ttv formulae derived here and in lxw12 for the @xmath93th planet perturbed by planet @xmath94 as @xmath95\\end{aligned}\\ ] ] where we have set @xmath96 at transit ( this incurs some error , at order @xmath97 , but that is a second order effect since we are comparing the ttv term linear in @xmath97 ) . when written in this way , the amplitude and phase depend only on @xmath98 , and @xmath99 .    for the 3:2 resonance , the lxw12 resonant term depends on @xmath100 and @xmath101 , which both decline quickly away from resonance , and thus other terms that depend on @xmath102 and @xmath103 make a more significant contribution further from resonance ; hence our formulae agree close to resonance but diverge away from exact commensurability .",
    "figure [ fig : lxw12 ] shows the fractional error in the amplitude @xmath104 and phase @xmath105 of the terms that are proportional to the eccentricities of the planets for @xmath106 radians .",
    "the error in the lxw12 expression ( a28 ) and ( a29 ) reaches @xmath10720% at a 5% separation from exact resonance in this case ; if we use the further approximate expression given in their main paper in lieu of ( a28 ) , the discrepancy for the inner planet increases to @xmath10730% .",
    "this is similar to the error in the zeroth - order component of their expression @xcite .",
    "the zeroth- and first - order eccentricity terms have a different dependence on longitudes : for example , for the inner planet the zeroth order term scales as @xmath108 , while the first order term scales as @xmath109 , where @xmath110 .",
    "since the mean longitude of the inner planet is nearly identical at each transit of the inner planet , the @xmath111 term in the exponent is approximately constant , while the @xmath112 dependence is identical in both terms , leading to aliasing of these coefficients .",
    "thus the error incurred in their approximation can lead to a different phase dependence and amplitude for this aliased term away from resonance .",
    "terms of our analytic expression .",
    "black indicates dependence on the @xmath102 term , while red indicates the dependence on the @xmath103 term .",
    "the top show the fractional errors in the amplitudes of the inner ( left ) and outer ( right ) planets .",
    "the bottom shows the fractional error on the phases . ]",
    "we have carried out extensive integrations of three - body systems using _ ttvfast _",
    "@xcite , and compared the results with the first - order analytic formulae ( equation [ timing_solution ] ) .",
    "note that the _ ttvfast _ code uses the convention of the longitude of periastron being measured from the sky plane to match the convention of radial velocity surveys , while here we use the observer s line of sight as the reference direction , as done in lxw12 and @xcite .",
    "the longitudes computed from the _ ttvfast _ code need to have @xmath113 subtracted to make the plots shown below .",
    "in addition , the orbital elements accepted by _",
    "ttvfast _ are the instantaneous / osculating orbital elements ( initial conditions ) at the specified initial time , while the orbital elements used in these formulae are the mean orbital elements of the planets over the timescale of the observations .",
    "figure [ fig01 ] compares the precision of the analytic formula as a function of @xmath114 and eccentricity of both planets , which are set to be equal , @xmath115 .",
    "we have set @xmath116 , which we found ( approximately ) maximizes the discrepancy of the analytic model compared with the n - body model , and @xmath117 which ( approximately ) minimizes the discrepancy ; hence the figures bracket the precision of the analytic model .",
    "this is due to the fact that the anti - aligned longitude geometry causes the planets to be closer at conjunctions that occur when the inner planet is at apoapse and the outer is at periapse ; their proximity at these conjunctions causes their gravitational interactions to be more sensitive to deviations from the epicyclic approximation , which are second order in eccentricity , and thus missing from our computation .",
    "we have assumed that the period of the inner planet is @xmath118 days , and we have integrated the system with _",
    "ttvfast _ for 1600 days , about the duration of the initial kepler mission , assuming plane - parallel orbits . for these tests",
    "we assume @xmath119 , and we selected random values for the longitudes of the planets at the initial time .",
    "for each set of initial conditions , we output the orbital elements at regular intervals during the n - body integration , from which we computed the average orbital elements over the duration of the integration .",
    "these averaged orbital elements were used for computing the amplitudes of the analytic model , which we summed up to @xmath120 .",
    "we optimized the fit of the analytic formula to the numerical ttvs by allowing the ephemerides of the planets to vary in the formula , but holding the eccentricity vectors and mass ratios fixed at the values computed from the time - averaged n - body simulation , while we computed @xmath45 in the analytic formula from the ratio of the periods derived from the best - fit ephemerides .",
    "the fractional precision was computed from the rms of the residuals of the best analytic model fit to the ttvs , divided by the rms of the ttvs computed from the n - body integration .",
    "figure [ fig01 ] shows that the formula works to better than 10% precision for a wide range of @xmath121 parameter space .",
    "however , it fails near resonances , most significantly for the @xmath43:@xmath122 resonances indicated in green , and @xmath43:@xmath123 in blue . for the outer planet",
    ", there are narrow regions near @xmath124:@xmath43 period ratios for which the formula does poorly .",
    "the disagreement grows in breadth for larger eccentricities .",
    "this diagram can be used to pinpoint the relevance of the analytic formula for a particular system , and we suggest that the analytic formulae should be used with caution in the regions where the formula disagrees by more than 10% precision .",
    "most of the regions where the formula fails are near resonance . in these cases ,",
    "the residuals can frequently be fit by sinusoidal variations at the relevant resonant frequencies of the higher order resonant terms that are not captured in the first - order model ; when including these sinusoidal terms in the fit , the residuals drop dramatically near the resonances .",
    "thus , the analytic first - order solution plus a sinusoid with arbitrary amplitude and phase can be used for systems in which only the shape of the transit timing variations plus the specific variations of the non - resonant terms is necessary ( although this approach breaks down for large enough eccentricity ) .    ) ; right : anti - aligned longitudes of periastron ( @xmath125 ) .",
    "the dotted lines indicate the 10% precision level .",
    "cyan dots show the approximate position of kepler-18b / c at the 85.15% posterior eccentricity value , while magenta is used for kepler-28 .",
    "the region in the upper right is hill unstable ; these models were not computed , and default to 100% uncertainty in this plot .",
    "the green dashed lines show the locations of @xmath43:@xmath122 resonances , while the blue dashed lines show @xmath43:@xmath123.,title=\"fig : \" ] ) ; right : anti - aligned longitudes of periastron ( @xmath125 ) .",
    "the dotted lines indicate the 10% precision level .",
    "cyan dots show the approximate position of kepler-18b / c at the 85.15% posterior eccentricity value , while magenta is used for kepler-28 .",
    "the region in the upper right is hill unstable ; these models were not computed , and default to 100% uncertainty in this plot .",
    "the green dashed lines show the locations of @xmath43:@xmath122 resonances , while the blue dashed lines show @xmath43:@xmath123.,title=\"fig : \" ]      we have carried out simulations for a range of masses , keeping @xmath126 .",
    "we find that the fractional error of the analytic formula grows near resonances and near @xmath88 as the mass increases with weaker dependence upon eccentricity . for small @xmath45 ,",
    "the formula works well up to @xmath127 , while near @xmath124:@xmath128 period ratio , for example , the error broadens around the resonance .",
    "figure [ mass_error ] shows the fractional error in the formula ( computed as in the eccentricity dependent case ) for @xmath129 ( the mass dependence of the precision is nearly independent of eccentricity ) with @xmath125 ( the results look very similar for @xmath117 ) .",
    "the formula is accurate for a broad range of masses , but for some systems , such as planet hunters 3c / d , indicated in cyan in fig .",
    "[ mass_error ] , the discrepancy becomes large , @xmath130% ( the masses and eccentricity vectors for this plot differ from ph3c / d , but a plot made for the parameters of that pair of planets looks very similar ) .     and mass ratio of the planets to the star ( @xmath131 ) .",
    "top : inner planet ; bottom : outer planet .",
    "the dotted line indicates the 10% precision level .",
    "cyan dots show the approximate position of ph3 ( although note that ph3 does not have equal masses ; however , the plot is similar for parameters appropriate for ph3 ) .",
    "the region in the upper right is hill unstable ; these models were not computed , and default to 100% uncertainty in this plot .",
    "the green dashed lines show the locations of @xmath43:@xmath122 resonances , while the blue dashed lines show @xmath43:@xmath123 . ]",
    "we have carried out fits to systems with two interacting planets described in lxw12 , and we have re - fit planet hunters ( ph3 ) c / d .",
    "we have carried out n - body dynamical analyses using _ ttvfast _ in addition to fits with the analytic first - order formula in order to assess its utility in analyzing multi - planet systems .",
    "our first case is kepler-18c / d , which was published by @xcite and also analyzed by lxw12 .",
    "we used the same transit times and uncertainties from the @xcite paper to allow for direct comparison to their results ; these transit times were also used in lxw12 .",
    "we carried out a markov chain monte carlo ( mcmc ) analysis using an affine - invariant population approach @xcite .",
    "we allow a multiplicative factor for the timing uncertainties on each planet and we place a uniform prior on the eccentricity of each planet @xcite .",
    "figure [ fig02 ] shows a comparison of the results of the mcmc analyses with n - body integration versus the analytic formulae with @xmath132 .",
    "for this system the mass ratios are @xmath133 and the eccentricities are of order @xmath134 ( 1-@xmath135 ) , while @xmath136 , which is a regime in which the first - order formula is accurate to @xmath1379% compared with n - body integration ( see figure [ fig01 ] ; the cyan dot indicates the approximate location of the upper end of the eccentricities of kepler-18c / d ) . for conversion of the mass ratios to planet masses , we assume that @xmath138 ( we ignore the uncertainty on this stellar mass ) .",
    "the masses of the planets derived from n - body are @xmath139 and @xmath140 , while from the analytic formula are @xmath141 and @xmath142 .",
    "these are well within @xmath143 of one another , the markov chain posteriors show very similar distributions ( fig .",
    "[ fig02 ] ) .",
    "we note that these results differ from those reported by @xcite who used n - body to estimate the transit times , found the best fit using levenberg - marquardt optimization , and estimated the uncertainties from the hessian matrix at the best fit parameters rather than a full posterior analysis .",
    "our results also differ from the estimates in lxw12 , which only solve for a ` nominal ' mass assuming zero eccentricity using the approximate near - resonant formula .",
    "we feel that our results should be superior to these prior results , and warrant a more extensive analysis with the full kepler dataset as well as radial velocity measurements .",
    "we next compared analyses of the kepler-28 system , which was originally studied by @xcite , and included in the analysis of lxw12 .",
    "we used the transit times published by @xcite , and followed the same procedure as kepler-18 .",
    "figure [ kepler28 ] shows a comparison of the masses and eccentricity vectors for this system , which has a mean period ratio of @xmath144 , just wide of 2:3 period ratio , corresponding to @xmath145 .",
    "the masses are poorly constrained due to the degeneracy with eccentricity , which allows the eccentricity to wander to larger values .",
    "for conversion of the mass ratios to planet masses , we assume that @xmath146 ( we ignore the uncertainty on this stellar mass ) .",
    "a comparison between the mass constraints from n - body and the analytic formula gives : @xmath147 versus @xmath148 , and @xmath149 versus @xmath150 .",
    "the 85% confidence value of @xmath102 is 0.098 , while for @xmath103 is 0.076 , while the longitudes of periastron within the posterior distribution are primarily anti - aligned ; the location of these points is indicated with a magenta datapoint in figure [ fig01 ] . note that in the anti - aligned @xmath151 case the analytic formula is valid to larger eccentricities , and thus is adequate to describe this system .",
    "as figure [ mass_error ] indicates , the planet hunters 3 ( ph3 ) system , the outer two planets ( c / d ) analyzed in @xcite , has a large discrepancy due to the large mass of the outer planet .",
    "the excellent agreement with the chopping formula given in @xcite is still imperfect ; the figure in that paper was mistakenly produced with larger timing error bars than used in @xcite which caused the agreement to appear slightly better than the first - order formula indicates .",
    "figure [ ph3_masses ] shows the results of a comparison of n - body and analytic fits to the ph3 transit times given in @xcite ; the planet masses assume @xmath152 .",
    "the analytic formula gives a significant discrepancy due to the large mass of the outer planet and due to the proximity to the 1:2 period ratio .",
    "to confirm that the large mass of ph3d led to this discrepancy , we took the best - fit parameters resulting from our n - body analysis of the real ph3 data , and reduced the masses of the outer two planets by a factor of 10 . using the outer two planets alone",
    ", we simulated transit times and added gaussian noise at a level of @xmath153 that of the noise of the real data to maintain the same signal - to - noise ratio as the actual data .",
    "we then modeled this simulated data using _ ttvfast _ and the analytic formulae .",
    "we found that the agreement between the n - body and analytic analyses becomes excellent ( fig .",
    "[ ph3_masses ] ) .          the two - body solution can be used for more than two bodies by addition of two - body ttv solutions for each pair of two planets @xcite : @xmath154 where @xmath155 are the solutions from equation ( [ timing_solution ] ) for the @xmath156th planet due to the @xmath157th planet . the sum over @xmath43 for each pair of planets",
    "can be carried up to @xmath73 to give sufficient precision for that pair of planets that is smaller than the measured timing precision .",
    "our first system of study is kepler-51 @xcite , consisting of planets with period ratios close to 1:2:3 .",
    "we used the transit times reported in @xcite to carry out dynamical models with n - body/_ttvfast _ and with an analytic ttv signal given as the sum of the ttvs of the three adjacent pairs of planets .",
    "we included up to @xmath158 in the ttv signals .",
    "the results show excellent agreement ; figure [ kep51_ttvs ] shows the measured transit - timing variations , as well as the best - fit n - body and analytic ttvs .",
    "the results of the mcmc analyses are compared in figure [ kepler51 ] which shows the posterior distribution of masses and eccentricities measured with both analyses , assuming @xmath159 . for two of the planets the eccentricities are consistent with zero ; in these cases the tail of the eccentricity histogram is heavier for the n - body than the for the analytic formula .",
    "the masses of the inner two planets from our n - body and analytic mcmc analyses agree well with the masses from the analysis in @xcite , while the mass of the outer planet is small by @xmath160 .",
    "the primary computational burden of equation ( [ timing_solution ] ) lies in computing the laplace coefficients .",
    "we use a series solution for these coefficients , which gives both speed and accuracy , using code shared by jack wisdom .",
    "the secondary computational burden is in computing the sine and cosine terms , which involves four angles , and thus requires eight evaluations .",
    "we carry out the computation of higher @xmath43 sines and cosines using trigonometric addition formulae , which means we only need to compute eight trigonometric functions at each transit time once ; the rest are gotten from addition and multiplication of these .    in the cases that we run a markov chain for a set of planets ,",
    "the initial value of @xmath45 is known fairly well from the period ratio of the planets . in this case",
    "the laplace coefficients and their derivatives needed for the solution can be taylor expanded at the @xmath45 given by an initial fit to the transit times , and these coefficients can be stored for evaluation of the coefficients at slightly different values of @xmath45 encountered during the mcmc simulation .",
    "this approach would not work if @xmath45 is being varied over a grid ( for example , in the case of searching for a perturbing planet with unknown period ) ; however , computational efficiency can still be achieved by reusing the laplace coefficients at different eccentricities @xcite .",
    "we have coded the first - order formula , equation ( [ timing_solution ] ) , in c , idl , python , and julia @xcite .",
    "we carried out a benchmark comparison of the julia implementation of the formula with the c implementation of _ ttvfast _ , and we find that it is @xmath161 faster when the laplace coefficients are approximated from a taylor expansion . as _",
    "ttvfast _ is about 20 times faster than ttvs computed with standard n - body integrators , this represents nearly four orders of magnitude in speed up , similar to that found by @xcite .",
    "note that if integer period ratios are chosen , sometimes the denominators of @xmath89 and @xmath162 can become infinite , causing divergence ; we expect that this will not be encountered in practice as the formulae only apply to non - resonant planets .",
    "the code implementing these equations may be accessed at https://github.com/ericagol/ttvfaster .",
    "in modeling transit timing variations , degeneracies and computational speed can each prohibit the accurate measurement of transiting planet masses and orbital properties , with their attendant uncertainties .",
    "the degeneracy due to aliasing near first order resonances ( lxw12 ) can be broken with very high signal - to - noise due to the slight difference in the eccentricity dependence as a function of period ratio , as well the presence of perturbations at other frequencies @xcite .",
    "here we have tried to improve the modeling of the terms which are linearly dependent upon eccentricity to provide a higher - fidelity analytic model to address both the degeneracy and the computation barriers .    to this end , we have presented a first - order solution in eccentricity and mass ratio to the plane - parallel , near - circular 3-body problem on timescales shorter than the secular timescale .",
    "this improves to first order in eccentricity the original solution given in @xcite which was derived to zeroth order in eccentricity and first order in mass ratio ( this solution has also been given in different forms in @xcite and @xcite ) .",
    "the expressions are accurate compared with numerical integration over a wide range of parameter space relevant to the hundreds of multi - transiting planetary systems being found at short orbital periods with kepler @xcite .",
    "we find that this expression is more accurate than the stripped - down near - resonant formula given in lxw12 , although their formula has a simpler form which clearly highlights the mass - eccentricity degeneracy .",
    "the first - order eccentricity formulae also can be used to model more than two planets with linear combinations of 2-planet formulae , and works well for the system we tested here , kepler-51 .",
    "we used an approach starting with the newtonian equations of motion rather than the hamiltonian , and compute the perturbed polar coordinates of the planets orbits ; this approach is akin to solving dispersion relations of differential equations for mode and stability analysis ( for example , the magneto - rotational instability is derived with this approach , @xcite ) .",
    "the unperturbed solution to these differential equations represents keplerian motion expanded in eccentricity .",
    "the terms with various frequencies in the disturbing function give an inhomogeneous component to the solution , which cause ttvs to vary at frequencies which depend upon integer combinations of the orbital frequencies of the two planets .",
    "since the answer obtained in the end is the same as in the hamiltonian ( for @xmath163 ) and canonical transformation approaches , this approach might be useful pedagogically for those more familiar with stability analyses .",
    "in addition , this approach might be useful for other problems , such as a stability analysis of a two - planet system or for carrying out the ttv computation to second - order in mass ratios @xmath8 .",
    "the latter is interesting as it would reveal how ttvs of a transiting planet may be used to measure the mass of that planet ( and not just the mass of the perturbing planet ) .",
    "we expect that these formulae will be used in carrying out initial fits to multi - transiting planets which show ttvs @xcite , in searching for companion perturbing planets to isolated planets showing ttvs , in characterizing multi - planet systems with ttvs to confirm and check for convergence of n - body mcmc analyses , in forecasting ttv amplitude for follow - up measurement , in estimating the optimum times for transit observation , and in making predictions for transit times to plan observations",
    ". it should be useful for estimating the densities , masses , and radii of the host stars and their exoplanets @xcite , and in comparing the ttv solutions to radial velocity solutions for the masses and orbits of exoplanets .",
    "the analytic nature of our solution should be amenable to automatic differentiation @xcite , which could speed up optimization based on gradient computation , and could also enable hamiltonian / hybrid markov chain monte carlo @xcite .",
    "when a large number of planets transit a star and each show evidence for dynamical interactions , the number of free parameters describing the system becomes large , and thus mcmc becomes prohibitively computationally expensive .",
    "the first - order analytic formula developed here can be used for modeling these systems if their masses and eccentricities are in the allowable range . as the formula is about 400 times faster than _ ttvfast _",
    ", which is already about 20 times faster than bulirsch - stoer based integrators , the total speedup of about 8000 should make running chains long enough to converge more feasible , especially in tandem with parallel computation which can be easily adapted for population mcmc @xcite .",
    "the analytic formula also has the advantage of being able to pinpoint which features in the ttvs constrain the parameters of the system ( lwx12 ) . since the ttvs of a planet display harmonics of the perturbing planet @xcite",
    ", the amplitudes and phases of each of these harmonics can be measured directly from the ttvs , and then these can be used to place individual constraints upon the masses and eccentricity vectors of the planets .",
    "the regions where the constraints overlap may reveal the consistency and uniqueness of the solution for the system parameters in some cases @xcite .",
    "although in principle ttvs allow for unique measurements of planet mass and eccentricities , degeneracies between these parameters are often found for systems with low signal to noise . in these cases ,",
    "the eccentricities can become extremely large , indicating unstable orbits , as long as the masses are adjusted in a corresponding manner .",
    "we applied hill stability to avoid this problem when using the analytic formulae ; the full n - body computation avoids this issue naturally since large eccentricities introduce second - order ( and higher ) variations ( that our calculation ignores ) which prevent the high - eccentricity cases from fitting the data well .",
    "it may be possible to break some degeneracies with transit duration variations @xcite , which can be computed with the same formalism we have described here , albeit in the plane - parallel limit .",
    "the first - order formulae described here could be extended to higher order in eccentricity and/or mass ratio , albeit with much more computational effort .",
    "a slightly more accurate formula might be obtained by computing the longitudes from kepler s equation at the times of transit of each planet rather than using the first - order eccentricity formula ( [ longitude ] ) , as well as using the exact formula for @xmath164 at the transit times in equation ( [ ttv ] ) ; this requires very little additional computational effort , but @xmath11 will still be only accurate to first order in eccentricity . the solutions for the perturbed polar coordinates , @xmath165 , can be derived in the same manner that we have derived the transit timing variations .",
    "these are needed for carrying out the higher - order perturbation solutions , and in turn could be used for modeling astrometric variations , radial velocity varations , and pulsar timing variations of host stars to account for the interactions of planets to first order in eccentricity .",
    "ea acknowledges support from nasa grants nnx13af20 g , nnx13af62 g , and nasa astrobiology institute s virtual planetary laboratory , supported by nasa under cooperative agreement nnh05zda001c .",
    "this research was supported in part by the national science foundation under grant no .",
    "nsf phy11 - 25915 .",
    "ea thanks the kavli institute for theoretical physics and the organizers of the  dynamics and evolution of earth - like planets \" workshop where a portion of this work was completed ; this manuscript is preprint number nsf - kitp-15 - 132 .",
    "kd acknowledges support from the joint center for planetary astronomy fellowship .",
    "we thank jack wisdom for sharing laplace.c which computes laplace coefficients and their derivatives with series summation , we thank eric ford for advice on implementation of the formula in julia , and we thank brett morris and ethan kruse for advice on implementation of the formula in python ( requested by the referee ) .",
    "here we give the detailed derivation of the first - order solution presented in section [ ttv_result ] .",
    "we start with the equations of motion in murray & dermott ( md ) , 6.10 - 6.11 , which are in heliocentric coordinates .",
    "we use the index @xmath12 to label the planets , and denote the inner planet with @xmath28 and outer with @xmath29 .",
    "ttvs can be computed from the true longitudes , @xmath166 and @xmath167 , with respect to the star ; hence heliocentric coordinates are ideal for transit timing computation .",
    "we convert the equations of motion to polar coordinates , and isolate the radial and longitudinal equations : @xmath168 the first equation can be rewritten as the time derivative of specific angular momentum , @xmath169 , and without the disturbing force it expresses conservation of angular momentum , while the second equation includes centripetal acceleration in the radial direction as the second term on the left hand side .",
    "the term @xmath170 is the standard keplerian potential , while @xmath171 is the disturbing function which reflects the gravitational potential energy of planet - planet interactions . because the planet - planet interactions lead to only small perturbations of the base keplerian orbits , we seek a solution to equations ( [ forceequations1 ] ) of the form : @xmath172 and @xmath173 , where @xmath174 is the unperturbed keplerian polar coordinates of the orbits , and @xmath175 are the small perturbations .",
    "we can then plug these solutions into the equations of motion ( [ forceequations1 ] ) and expand in powers of @xmath176 , mass ratio , and eccentricity .",
    "we normalize @xmath177 by @xmath0 , which is the semi - major axis of the unperturbed keplerian orbit ( we do not perturb @xmath0 , @xmath3 , or @xmath2 , so they are fixed at the mean , unperturbed values ) . then @xmath178 , where @xmath179 is a dimensionless radial coordinate , so that @xmath180 and @xmath181 .",
    "the solution to the unperturbed orbits to first order in eccentricity is @xmath182 = \\lambda_i + 2e_i \\sin{(\\lambda_i-\\varpi_i)}$ ] and @xmath183 $ ] where @xmath110 , @xmath184 is the complex eccentricity vector ( lxw12 ) , @xmath185 is the complex conjugate of @xmath186 , and @xmath187 $ ] is the real part .",
    "the perturbed equations become : @xmath188 in these equations , we have cancelled the terms for the unperturbed keplerian on both sides of the equation . from hereon we will drop the ` @xmath189 ' subscript from the unperturbed keplerian orbital elements . to first order in eccentricity , the ttvs of the @xmath12th planet are : @xmath190 where @xmath191 is the perturbed solution to zeroth order in eccentricity .",
    "to lowest order in eccentricity , @xmath192 , so : @xmath193      let the specific angular momentum equal @xmath194 . since @xmath169 is a constant , @xmath195 .",
    "to first order in eccentricity , @xmath196 , where @xmath197 . substituting these into the above equations , and expanding to first order in eccentricity , we find @xmath198 note that the terms with @xmath179 or @xmath199 are first order in eccentricity ; hence , the other quantities in these terms need to only be expanded to zeroth order in eccentricity . denoting the zeroth - order solutions as @xmath200 and @xmath201",
    ", we find the differential equations governing the transit timing solution : @xmath202 we assume that both sides of these equations are complex , and the final solution is found from taking their real parts .",
    "the quantity @xmath171 is the disturbing function , which for the inner planet can be broken into two pieces : @xmath203 ( md 6.44 ) , where @xmath204 and @xmath205 . for the outer planet ,",
    "there are also two pieces , @xmath206 , where @xmath207 ( md 6.45 ) . as usual , @xmath17 .      the expansion for @xmath208 is given in md 6.66 .",
    "we are considering the plane - parallel case , so @xmath209 , in which case we only need to include the @xmath210 term .",
    "also , we would like a solution that is first order in eccentricity ( of the unperturbed keplerian orbit ) , so the term in brackets in md 6.66 needs to be expanded to second order in @xmath211 ( noting again that @xmath179 is first order in eccentricity ) : @xmath212 where @xmath213 ( md 6.63 ) and @xmath214 is a laplace coefficient ( md 6.67 ) .",
    "we define @xmath215 to simplify the expressions below .",
    "we rewrite @xmath208 in complex notation ( in the plane - parallel limit , expanded to second order in @xmath216 ) , giving : @xmath217,\\cr { \\cal r}_{d,0 } & = & \\frac{1}{2 } \\left(\\tilde{a}_{000}+ \\tilde{a}_{010 }",
    "\\epsilon_1 + \\tilde{a}_{001 } \\epsilon_2 + \\frac{1}{2}\\tilde{a}_{002}\\epsilon_2 ^ 2 + \\tilde{a}_{011}\\epsilon_{1}\\epsilon_2 + \\frac{1}{2 } \\tilde{a}_{020}\\epsilon_1 ^ 2\\right).\\end{aligned}\\ ] ] where we have used the fact that @xmath218 since @xmath219 .",
    "likewise , @xmath220.\\ ] ]    taking the derivative of @xmath208 and @xmath221 with respect to @xmath166 gives to first order in @xmath222 : @xmath223,\\ ] ] where we have used @xmath224 and @xmath8 .",
    "the derivative of @xmath225 with respect to @xmath222 is : @xmath226.\\end{aligned}\\ ] ]    for the outer planet , @xmath227.\\ ] ] the derivative of @xmath228 with respect to @xmath229 is : @xmath230.\\end{aligned}\\ ] ]    the angles and radii in the derivatives of the disturbing function can be expanded to first order in eccentricity , yielding : @xmath231.\\cr \\frac{1}{a_1 ^ 2}\\frac{\\partial { \\cal r}_1}{\\partial \\epsilon_1 } & = & n_1 ^ 2 \\mu_2 \\alpha re\\bigg[\\tfrac{1}{2}\\tilde{a}_{010}-\\tfrac{1}{2}\\tilde{a}_{020 } z_1e^{-\\mathbbm{i}\\lambda_1 } -\\tfrac{1}{2}\\tilde{a}_{011}z_2e^{-\\mathbbm{i}\\lambda_2 } + \\sum_{j\\ge 1 } e^{\\mathbbm{i}j\\psi}\\bigg(\\big(\\tilde{a}_{j10}-\\alpha\\delta_{j1}\\big)\\cr & + & \\left(j\\tilde{a}_{j10}-\\tfrac{1}{2}\\tilde{a}_{j20}-\\alpha\\delta_{j1}\\right)z_1^ * e^ { i\\lambda_1 }   +   \\left(-j\\tilde{a}_{j10}-\\tfrac{1}{2}\\tilde{a}_{j20}+\\alpha\\delta_{j1}\\right)z_1    e^{-\\mathbbm{i}\\lambda_1}\\cr & + & \\left(-j\\tilde{a}_{j10}-\\tfrac{1}{2}\\tilde{a}_{j11}\\right)z_2^ * e^ { i\\lambda_2 }   +   \\left(j\\tilde{a}_{j10}-\\tfrac{1}{2}\\tilde{a}_{j11}-2\\alpha\\delta_{j1}\\right)z_2    e^{-\\mathbbm{i}\\lambda_2}\\bigg)\\bigg].\\end{aligned}\\ ] ] where @xmath21 .",
    "we have also combined the @xmath232 eccentricity terms since @xmath233 .    for the outer planet ,",
    "@xmath234.\\cr \\frac{1}{a_2 ^ 2}\\frac{\\partial { \\cal r}_2}{\\partial \\epsilon_2 } & = & n_2 ^ 2 \\mu_1 re\\bigg[\\tfrac{1}{2}\\tilde{a}_{001 } - \\tfrac{1}{2}\\tilde{a}_{011}z_1^ * e^{\\mathbbm{i}\\lambda_1 } - \\tfrac{1}{2}\\tilde{a}_{002}z_2^ * e^{\\mathbbm{i}\\lambda_2 } + \\sum_{j\\ge 1 } e^{\\mathbbm{i}j\\psi}\\bigg(\\big(\\tilde{a}_{j01}-\\alpha^{-2}\\delta_{j1}\\big)\\cr & + & \\left(j\\tilde{a}_{j01}-\\tfrac{1}{2}\\tilde{a}_{j11}-2\\alpha^{-2}\\delta_{j1}\\right)z_1^ * e^ { i\\lambda_1 }   +   \\left(-j\\tilde{a}_{j01}-\\tfrac{1}{2}\\tilde{a}_{j11}\\right)z_1    e^{-\\mathbbm{i}\\lambda_1}\\cr & + & \\left(-j\\tilde{a}_{j01}-\\tfrac{1}{2}\\tilde{a}_{j02}+\\alpha^{-2}\\delta_{j1}\\right)z_2^ * e^ { i\\lambda_2 }   +   \\left(j\\tilde{a}_{j01}-\\tfrac{1}{2}\\tilde{a}_{j02}-\\alpha^{-2}\\delta_{j1}\\right)z_2    e^{-\\mathbbm{i}\\lambda_2}\\bigg)\\bigg].\\end{aligned}\\ ] ]      the derivatives of the complex disturbing function contain terms that are proportional to @xmath235 , @xmath236 for @xmath237 .",
    "we treat these terms as harmonic driving terms , and solve the inhomogeneous partial differential equations term by term .",
    "we expand the complex solutions for @xmath238 and @xmath239 as trial solutions : @xmath240 and @xmath241 we also define the solutions to zeroth order in eccentricity as : @xmath242 then , the ( real ) transit timing variations are equal to @xmath243,\\cr \\delta t_{1,j}^{(0 ) } & = & -n_1^{-1 } re(\\delta \\theta_{1,j}^{(0 ) } e^{\\mathbbm{i}j\\psi})\\cr \\delta t_{1,j}^{(\\pm k ) } & = & -n_1^{-1 } re\\left(\\left(\\delta \\theta_{1,j}^{(\\pm k)}-\\delta \\theta_{1,j}^{(0 ) } \\delta_{k1}\\right ) e_k e^{\\mathbbm{i}(j\\psi\\pm ( \\lambda_k-\\varpi_k))}\\right),%\\cr % \\delta t_{1,0}^{(-2 ) } & = & -n_1^{-1 } re\\left(\\delta \\theta_{1,0}^{(-2 ) } e_2 e^{-\\mathbbm{i}(\\lambda_2-\\varpi_2)}\\right),\\end{aligned}\\ ] ] and @xmath244,\\cr \\delta t_{2,j}^{(0 ) } & = & -n_2^{-1 } re(\\delta \\theta_{2,j}^{(0 ) } e^{\\mathbbm{i}j\\psi})\\cr \\delta t_{2,j}^{(\\pm k ) } & = & -n_2^{-1 } re\\left(\\left(\\delta \\theta_{2,j}^{(\\pm k)}-\\delta \\theta_{2,j}^{(0 ) } \\delta_{k2}\\right ) e_k e^{\\mathbbm{i}(j\\psi\\pm ( \\lambda_k-\\varpi_k))}\\right),%\\cr % \\delta t_{2,0}^{(+1 ) } & = & -n_2^{-1 } re\\left(\\delta \\theta_{2,0}^{(+1 ) } e_1 e^{\\mathbbm{i}(\\lambda_1-\\varpi_1)}\\right),\\end{aligned}\\ ] ]      substituting the @xmath245 trial solutions into the above differential equations , to zeroth order in eccentricity we find for the inner planet : @xmath246 where @xmath247 and we have divided the equations by @xmath248 to make dimensionless .",
    "similarly we can write down the equations for the coefficients to first order in @xmath102 .",
    "note that to solve for @xmath249 , we need to compute @xmath250 .",
    "hence we can subtract the matrix on the left times the vector @xmath251 from both sides of the equation .",
    "this may be rewritten in dimensionless form as : @xmath252 the solutions of equation [ first_matrix ] for @xmath253 may be plugged into the first term on the right hand side of this equation to solve for the first order eccentricity terms .    to first order in @xmath103 in dimensionless form ( for @xmath254 ) , @xmath255 where @xmath256 and @xmath257 .",
    "note that for @xmath258 the @xmath259 term becomes @xmath260 .",
    "the frequency dependence of this term is at the keplerian frequency of the inner planet , @xmath261 , and the determinant of the left hand matrix becomes zero as the second row of the matrix is equal to @xmath262 times the first row .",
    "this singularity occurs due to the fact that the equations become those of a resonantly driven oscillator , which means that the amplitude grows linearly with time ( or , equivalently on short timescales , the keplerian frequency is shifted ) .",
    "this term is not relevant for transit - timing analyses as it occurs at the frequency of the transiting planet and grows on the secular timescale ; consequently we will drop this term for now and discuss below in appendix b.    for @xmath232 , @xmath263      defining @xmath264 , dividing this equation by @xmath265 gives the dimensionless form of : @xmath266 and for the equations to first order in @xmath102 for @xmath254 ,    @xmath267    where @xmath268 , while for @xmath232 , @xmath269 and for first order in @xmath103 , @xmath270    the function @xmath89 originates from the inversion of the matrices in the left hand side of equations ( [ first_matrix])-([last_matrix ] ) , which each have the form of : @xmath271 where @xmath33 is the dimensionless frequency in units of the orbital frequency of the transiting planet .",
    "since ttvs only depend upon @xmath272 , then only the first term in the inverse of this matrix times the right hand side of the equation gives the function @xmath89 .",
    "these terms are driven by the disturbing function only .",
    "the function @xmath162 results from the driving terms caused by appearance of the zeroth - order eccentricity equation on the right hand side of the linearized equations ( [ inner_planet ] ) .",
    "these can be expressed as the inverse of the zeroth - order matrix times the coefficients of the disturbing function driving the ttvs at zeroth order ; the first term on the right hand sides of equations ( [ inner_e1 ] ) and ( [ outer_e2 ] ) times the inverse of the matrix on the left hand side yield the functions @xmath162 .    the expressions for @xmath89 and @xmath162 result from the coefficients in equations ( [ first_matrix]-[last_matrix ] ) which can be found by inverting the matrices .",
    "note that the coefficients of @xmath273 are imaginary , while @xmath274 are real ; thus , @xmath273 , and hence @xmath275 , will always have a sine dependence , while @xmath276 will always have a cosine dependence .    as with the inner planet , for @xmath258",
    "the @xmath277 term becomes @xmath278 .",
    "the frequency dependence of this term is at the keplerian frequency of the outer planet , @xmath279 , and hence the determinant of the left hand matrix becomes zero as the second row of the matrix is equal to @xmath262 times the first row ( as occurs for the inner planet ) .",
    "we will drop this term for now and discuss next in appendix b.    appendix b",
    "in the foregoing analysis we neglected the presence of secular terms , which in the disturbing function appear at zero frequency as well as at the keplerian frequency of the planet that is being perturbed .",
    "these terms cause corrections of @xmath280 to the ephemeris of the planet , and thus cause an error of @xmath280 to the computation of @xmath45 from the best - fit mean period .",
    "the correction to @xmath45 affects the coefficients of the ttvs at order @xmath281 , and so it can be neglected for the purposes of the first order in eccentricity transit timing solution .",
    "however , the solution we present here may have other applications , such as for radial - velocity planets or astrometric motion , which are not aliased at the orbital frequency of the planets , and so these secular terms enter at the @xmath280 level . in this appendix",
    "we compute these secular terms to first order in @xmath282 and @xmath97 .    in the equations of motion",
    "for the inner planet , to include the secular and keplerian frequency terms , we will use angular momentum , @xmath283 in lieu of angle @xmath166 .",
    "the equations of motion become : @xmath284 where we have made the substitution @xmath285 into equations ( [ forceequations1 ] ) and we have divided by @xmath286 . in equation [ disturbing1 ]",
    "we keep only the secular terms and terms at frequency @xmath261 , giving : @xmath287\\cr \\ddot \\epsilon_1 - \\frac{l_1 ^ 2}{a_1 ^ 4(1+\\epsilon_1)^3 } & = & -\\frac{n_1 ^ 2}{(1+\\epsilon_1)^{2 } } + n_1 ^ 2 \\mu_2 \\alpha re\\big[\\tfrac{1}{2}\\tilde{a}_{010 } - \\tfrac{1}{2 } \\tilde{a}_{020}z_1^ * e^{\\mathbbm{i}\\lambda_1 } -(\\tilde{a}_{110}+\\tfrac{1}{2}\\tilde{a}_{111})z_2^ * e^{\\mathbbm{i}\\lambda_1}\\big].\\end{aligned}\\ ] ] for the inner planet , and similarly for the outer planet @xmath288\\cr \\ddot \\epsilon_2 - \\frac{l_2 ^ 2}{a_2 ^ 4(1+\\epsilon_2)^3 } & = & -\\frac{n_2 ^ 2}{(1+\\epsilon_2)^{2 } } + \\tfrac{1}{2}n_2 ^ 2 \\mu_1 re\\left[\\tilde{a}_{001 } - \\tilde{a}_{002}z_2^ * e^{\\mathbbm{i}\\lambda_2 } -(2\\tilde{a}_{101}+\\tilde{a}_{111})z_1^ * e^{\\mathbbm{i}\\lambda_2}\\right],\\end{aligned}\\ ] ] where we have taken the complex conjugate since this does not change the real component .",
    "the solution for the inner planet s angular momentum to first order in eccentricity is : @xmath289\\big).\\ ] ] this can be substituted into the equation for @xmath222 , keeping terms of order eccentricity , to obtain : @xmath290\\cr g_1 & = & \\tfrac{1}{2}(3\\tilde{a}_{010}+\\tilde{a}_{020})z_1^*+(2\\tilde{a}_{100}+\\tilde{a}_{101}+\\tilde{a}_{110 } + \\tfrac{1}{2}\\tilde{a}_{111})z_2^*.\\end{aligned}\\ ] ] note that we have chosen the constant of integration in @xmath283 to cancel the constant term in the disturbing function derivative that appears in the equation for @xmath222 so that the @xmath222 does not have an offset .",
    "this is because we prefer to specify the value of the semi - major axis in the initial conditions .",
    "the solution to this equation is : @xmath291.\\ ] ] note that this solution grows in amplitude linearly with time ; however , the growth is slow , occuring on the secular timescale times the inverse of the eccentricity .",
    "a similar solution can be derived for the outer planet , with : @xmath294\\big).\\ ] ] as before , this can be substituted into the equation for @xmath229 : @xmath295\\cr g_2 & = & \\tfrac{1}{2}(3\\tilde{a}_{001}+\\tilde{a}_{002})z_2^*+(2\\tilde{a}_{100}+\\tilde{a}_{110}+\\tilde{a}_{101 } + \\tfrac{1}{2}\\tilde{a}_{111})z_1^*.\\end{aligned}\\ ] ] this equation has solution @xmath296.\\ ] ]    substituting this into the relation @xmath297 and integrating @xmath298 with respect to time yields : @xmath299.\\end{aligned}\\ ] ] we have verified these solutions by plugging them back into the differential equations , both analytically and numerically .",
    "the solutions for @xmath300 can be transformed to timing variations with @xmath301 ."
  ],
  "abstract_text": [
    "<S> characterization of transiting planets with transit timing variations ( ttvs ) requires understanding how to translate the observed ttvs into masses and orbital elements of the planets . </S>",
    "<S> this can be challenging in multi - planet transiting systems , but fortunately these systems tend to be nearly plane - parallel and low eccentricity . here we present a novel derivation of analytic formulae for ttvs that are accurate to first order in the planet - star mass ratios and in the orbital eccentricities . </S>",
    "<S> these formulae are accurate in proximity to first order resonances , as well as away from resonance , and compare well with more computationally expensive n - body integrations in the low eccentricity , low mass - ratio regime when applied to simulated and to actual multi - transiting kepler planet systems . </S>",
    "<S> we make code available for implementing these formulae . </S>"
  ]
}