{
  "article_text": [
    "the analysis of time series data is an important tool in many areas of astrophysics , including research involving white dwarfs , black holes , and neutron stars . in the study of neutron stars ,",
    "time series analysis has had particular importance for pulsar research due to the high coherence of pulsar periodicities . while many techniques can be used to investigate the properties of these periodic signals , the computational efficiency of the fast fourier transform ( fft )",
    "makes fourier analysis the preferred approach for many applications ( see e.g. * ? ? ?",
    "the literature contains literally hundreds of descriptions of various aspects of fourier analysis , most of which deal with signal detection using the power spectrum .",
    "because of this concentration on power spectra , many researchers discard a wealth of information provided by the fourier phases .",
    "techniques which use this phase information exist that can provide insight into many useful signal properties . while many of these techniques have been known for some time ( see e.g. * ? ? ?",
    "* ) , few have appeared in textbooks or refereed journals , and fewer still have been presented with any sort of derivation or insight into their assumptions and/or limitations .",
    "a second , more practical problem with most astronomical fourier analysis is its concentration on short time series .",
    "we define `` short '' to mean either that the full time series of binned or sampled data can fit into the core memory of your computer ( @xmath0 points ) , or for data consisting of events ( such as photon arrival times in x - ray astronomy ) , that the time resolution ( @xmath1 ) of each event makes up a non - negligible fraction of the total time duration ( @xmath2 ) of the data ( @xmath3 ) .",
    "billion point ffts have been used successfully in the past ( e.g. * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ) , but each required the use of state - of - the - art supercomputing facilities . today , such analyses are possible using clusters of workstations or even individual desktop machines .",
    "many projects , such as pulsar searches of globular clusters , astero- or helioseismological observations , and gravitational wave experiments , require extremely large fourier transforms in order to make the highest sensitivity ( i.e.   _ coherent _ ) searches for pulsations , and to extract the maximum amount of information from signals found in these searches .",
    "it is our goal in this paper to present some useful fourier analysis techniques , that for various reasons are used only rarely when working with long time series .",
    "most of our examples pertain to pulsar searches of very long time series , but the methods can be used in the fourier analysis of virtually any coherent periodicity .",
    "this paper will briefly discuss the properties of the dft , its response to periodic signals and noise , and methods for its computation .",
    "we will discuss methods for interpolating fourier amplitudes , estimating a signal s duration and centroid in time , accurately determining its frequency and frequency derivative , correcting for changing pulsation frequency during an observation , and estimating the phase- or amplitude modulation of a signal .",
    "such techniques allow the detection of signals whose frequencies or amplitudes change significantly during an observation  for instance , due to orbital motion or pulsar spin - down .",
    "in order to present more advanced fourier techniques later , we first review some fundamentals of the dft and its most common implementation , the fft . since thorough discussions of the fourier transform in both its continuous and discrete variants exist in the literature ( e.g. * ? ? ? * ) , we will mention only a few topics of particular relevance to astrophysical data analysis , closely following @xcite .",
    "the @xmath4 element of the discrete fourier transform ( dft ) , of a uniformly - spaced time series @xmath5 ( @xmath6 ) is defined as @xmath7 where @xmath8 and @xmath9 is the fourier frequency or wavenumber ( @xmath10 ) . for a time",
    "spacing @xmath1 between successive data elements , the frequency of the @xmath4 element is @xmath11 , where @xmath2 is the total time duration of the sequence being transformed .",
    "this frequency spacing of @xmath12 , for evenly sampled , un - padded and non - windowed data , is often called the independent fourier spacing ( ifs ) , and defines the finest frequency resolution available while maintaining completely independent fourier amplitudes . fourier frequency @xmath13 is known as the nyquist frequency .",
    "if we view the dft summation in the complex plane , we see that it is a simple vector addition with each element rotated by @xmath14 from the previous element .",
    "if the @xmath5 have a constant value , the sum will form @xmath9 regular @xmath15-sided polygons with each polygon returning near to the origin , and with the last one returning exactly to the origin . therefore , the dft of a constant data string will be identically zero for all @xmath16 , and equal to the sum of the data elements for @xmath17 ( the `` dc '' frequency element ) .    for most astrophysical observations ,",
    "the data points are real - valued .",
    "this property adds an important feature to fourier transforms of these time series  they are symmetric about the nyquist frequency , such that @xmath18 , where @xmath19 represents the complex conjugate of @xmath20 .",
    "this symmetry allows us to calculate the full dft of a time series by computing amplitudes at only half of the normal fourier frequencies , thereby speeding up computation of the dft by nearly a factor of two ( e.g. , * ? ? ?",
    "when deriving properties and techniques based on dfts , it is often both computationally and intuitively easier to work with a time - normalized data series , where @xmath21 and @xmath22 represents the fraction of the observation complete at any given instant ( such that @xmath23 ) . in this case , instead of working with frequencies @xmath24 , or integral wavenumbers @xmath9 , we define @xmath25 , which represents any real wavenumber ( including non - integers ) . if the number of samples , @xmath26 , from our data source , @xmath27 , is large , we can compute a continuous ft @xmath28 which is almost identical to our dft when @xmath29 , and produces very high accuracy estimates of the fourier amplitudes at any frequency such that @xmath30 .",
    "we will use this approximation in many of our derivations .",
    "the fast fourier transform is a family of well - known computer algorithms which quickly calculate a dft in only @xmath31 operations as opposed to the @xmath32 operations of a brute - force dft .",
    "ffts , their computation , and their origins have been described in numerous articles and books over the last few decades ( see * ? ? ? * for an introduction ) .",
    "therefore , we will describe only a few special versions which have become generally known only recently and which are useful in the analysis of extremely long time series .",
    "high energy pulsar searches using photon counting systems ( infrared , optical , x - ray , and gamma - ray detectors ) or pointed radio telescope searches ( for example , searching globular clusters ) often utilize very high sampling rates ( i.e.  @xmath33 khz ) and very long integration times of hours , days , or even weeks",
    ". these observations result in time series with hundreds of millions or even billions of data points .",
    "the subsequent ffts are impossible to perform using conventional fft algorithms unless the full time series fits into the core memory of the computer being used . utilizing special `` out - of - core '' fft methods",
    ", we can transform such huge arrays using distributed memory parallel systems or with a single workstation and manageable numbers of passes through the data stored on external media .",
    "most of these methods are based on the `` four - step '' fft and/or special external media array permutation methods @xcite .",
    "closely following the derivation described in @xcite , we can think of our one - dimensional time series as a `` c - like '' or row - ordered , two - dimensional matrix of size @xmath34 , where @xmath35 is the number of columns ( i.e.  the length of a row ) and @xmath36 the number of rows ( i.e.  the length of a column ) .",
    "using this data decomposition , the fft is computed by _ 1 . _  ffting the columns of the matrix , _ 2 . _  multiplying the data by complex `` twiddle factors '' , _ 3 . _  ffting the rows of the matrix , and _ 4",
    ". _   matrix transposing the result .",
    "if we define indices @xmath37 , @xmath38 , @xmath39 , and @xmath40 , we can write our signal and its dft amplitudes as @xmath41 and @xmath42 substituting into the definition of the dft ( eqn .",
    "[ ftdef ] ) and simplifying we get @xmath43 \\ { \\mathrm{e}}^{-2 \\pi { \\mathrm{i}}xm / n_c}.\\ ] ] notice that the bracketed terms are really @xmath35 dfts of length @xmath36  ffts of the matrix columns multiplied by the `` twiddle factor '' @xmath44 .",
    "we denote these column ffts as @xmath45 we now see that the outer summation is @xmath36 dfts of length @xmath35  ffts of the matrix rows composed of the @xmath46 terms .",
    "we denote the result of these transforms as @xmath47 to recover the full fft in its normal order , we simply transpose @xmath48 @xmath49    the `` four - step '' algorithm only needs small portions of the data in memory at any one time . unfortunately , the short ffts are strided in memory by instead of being stored contiguously .",
    "this results in a significant inefficiency in today s cache - based processors and requires inter - node communications when distributing the short ffts over many processors on parallel computer systems .",
    "these shortcomings can be overcome with the `` six - step '' algorithm @xcite .",
    "if the initial data set is transposed from a @xmath50 matrix into a @xmath51 matrix , the strided column ffts of length @xmath36 become contiguous row ffts .",
    "this memory locality facilitates the use of processor cache systems , greatly increasing memory response times , and allows independent calculation of the row ffts by different processors in parallel systems . a second transpose operation after the row ffts",
    "have been calculated counteracts the effects of the first transpose operation and makes the next set of row ffts contiguous in memory as well .",
    "the fft is finished with a final transpose operation which brings the data into normal order .",
    "these transpose operations are relatively efficient on distributed memory parallel systems with fast inter - node communications , and add little time to the overall fft .",
    "in fact , for applications with very large @xmath26 , the time required to move the data from external media to computer memory and vice versa tends to dominate the fft time .",
    "the `` six - step '' algorithm has become the `` standard '' fft algorithm for distributed memory systems where the serial nature and large number of short ffts exploit parallel computation strengths .",
    "unfortunately , if the data does not all fit into the core memory of a workstation or parallel machine , the transposes become extremely slow operations since data must be read to and written from much slower external media .",
    "@xcite devised optimized methods for dealing with such data permutations on external media including the `` two - pass '' fft algorithm .      @xcite and @xcite both describe how a very large data set may be fourier transformed with only two read - write passes through externally stored data if a scratch area on the external media the same size as the input data set exists .",
    "the method uses the `` four - step '' algorithm with out - of - core transposes .",
    "these transpose algorithms allow blocked external media access and perform most of the transposition work in core memory .",
    "while external media access speeds and transfer rates are orders of magnitude slower than core - memory systems , the `` two - pass '' algorithm allows huge arrays to be transformed in manageable times .",
    "if our data @xmath5 are composed of some constant value @xmath52 plus random real - valued noise fluctuations @xmath53 with zero mean , the transform terms become @xmath54 the linear nature of the fourier transform allows us to treat the dft of the @xmath53 independently from the constant length steps , @xmath52 .",
    "since the complex phase factor for a given @xmath55 and @xmath9 is fixed , the direction of each element in the sum is nearly fixed . however , since the sign of the @xmath53 may be either positive or negative , the vector direction of the @xmath56 element may be reversed .",
    "thus , the dft of the @xmath53 creates a kind of random walk in the complex plane .",
    "the statistical properties of this random walk for dfts of pure noise have been well studied ( see , e.g. * ? ? ?",
    "* ) , and result in power spectra distributed according to an exponential distribution ( a @xmath57 distribution with 2 degrees of freedom ) with average and standard deviation equal to @xmath58 . if we normalize the powers by dividing by @xmath58 , the probability for a power @xmath59 in a single bin to equal or exceed a power @xmath60 by chance is in the presence of noise ( see   [ sec : signoise ] ) .",
    "this difference is important in setting upper limits on the amplitudes of periodic signals as discussed in @xcite . ]",
    "@xmath61 similarly , if we sum @xmath62 properly normalized powers , the probability for the summed power @xmath63 to exceed a power @xmath60 is given by @xmath64 which is the probability for a @xmath57 distribution of @xmath65 degrees of freedom to exceed @xmath66 .",
    "such an _ incoherent _ ( since no phase information is used ) summation of powers is often useful when searching for signals suspected of having power in many harmonics ( see  [ sec : nonsinusoid ] ) .",
    "proper normalization of the powers is essential for an accurate estimate of a signal s statistical significance or lack thereof .",
    "we often can not normalize our power spectrum by simply dividing by @xmath58 , since frequency - dependent noise may be present throughout our power spectrum  perhaps as a result of instrumental , atmospheric , or astrophysical processes .",
    "typically , these processes produce noise which increases in strength towards the low - frequency part of the spectrum and is correspondingly called _",
    "red noise_.    techniques to flatten or remove this `` coloured '' noise component from the power spectrum are described by @xcite , and usually involve dividing short portions of the power spectrum by the locally determined average power level , @xmath67 , such that @xmath68 as long as the number of averaged powers is small enough such that the power spectrum is roughly constant over the range in question , a _ white noise _ like power spectrum is produced with average and standard deviation of approximately one and an exponential distribution ( eqn .",
    "[ powprob ] ) .",
    "since strong narrow - band signals near some frequency of interest will skew a local power average upwards ( and correspondingly decrease the calculated significance of a signal detection ) , it is important to exclude such powers from the calculation of @xmath67 . a simple and effective way to accomplish",
    "this is by normalizing with a corrected local median power level instead of the local power average .",
    "an exponential distribution with unity mean and standard deviation has a median of @xmath69 .",
    "therefore , dividing a section of raw powers by @xmath70 times the local median value is theoretically equivalent to normalizing with the local mean , but has the advantage of being insensitive to high - power outliers in the spectrum .",
    "more advanced algorithms for the removal of `` coloured '' noise and power normalization do exist .",
    "a simple example involves fitting polynomial models to portions of the power spectrum and then dividing by them out .",
    "these methods work well for fourier frequencies near zero where the assumption of roughly equivalent power levels for the local powers may be unwarranted .    for the special case where the noise in our data is purely poissonian ( i.e.  for binned photons in an optical or x - ray observation )",
    ", we have @xmath71 . in this case , our properly normalized power for the @xmath4 dft element is @xmath72 where @xmath73 is the sum of the @xmath5 ( or the total number of photons for a photon - counting system ) , which is also equal to the `` dc '' frequency value of the ft ( see  [ sec : dft ] ) .",
    "however , the same processes that caused the `` coloured '' noise discussed above can significantly alter this situation and require a power normalization based on local powers ( see eqn .",
    "[ locpow ] ) .",
    "one of the more useful properties of the ft for astronomical purposes is its response to periodic signals .",
    "since all real periodic signals can be expanded into a series of sinusoids it is important to understand the ft response to a simple sine wave .",
    "if we now let our @xmath5 represent a sampled cosinusoid of amplitude @xmath74 , phase @xmath75 , and frequency @xmath76 ( where wavenumber @xmath25 is an integer and @xmath77 an `` integral frequency '' ) , we can write    @xmath78    from this expression , we see that the @xmath4 element of the dft is given by    @xmath79    and represents the summation of two vectors in the complex plane . for @xmath80 ,",
    "the first term traces out @xmath81 complete `` rotations '' ( pseudo - polygons which start and end at the origin ) in the complex plane ( since @xmath82 is an integer ) , giving a net contribution of zero to the @xmath4 dft element .",
    "the second term traces out @xmath83 complete rotations and once again contributes nothing to the @xmath4 dft element ( since @xmath9 and @xmath25 are both positive and therefore @xmath84 .    when @xmath85 , however , the consecutive terms in the summation add coherently ( i.e.  in phase and therefore without rotation ) , since the rotation caused by the dft exponential exactly cancels that from the signal exponential ( the fourier transform `` derotates '' the signal ) . as a result ,",
    "each element of the sum is a step in the complex plane of magnitude @xmath86 in a direction parallel to the one set by the arbitrary initial phase of the signal , @xmath75 . for a cosinusoidal signal with integral frequency @xmath77",
    ", the dft will be uniformly zero , except in the @xmath87 frequency bin , where the response is @xmath88    the fourier response is more complicated for sinusoids with non - integral frequencies ( i.e.  wavenumber @xmath25 is a non - negative real number ) .",
    "the @xmath4 dft element is still given by eqn .",
    "[ eq : fftcosine ] , but not all of the signal ends up in a single dft bin @xmath20 . when @xmath89 $ ] ( where @xmath90 $ ] is the nearest integer to @xmath25 ) , the first term in eqn .",
    "[ eq : fftcosine ] traces out a fraction ( @xmath82 ) of a complete rotation in the complex plane , while the second term traces out @xmath91 $ ] complete rotations , plus an additional fractional rotation .",
    "when @xmath26 is large , these complete and fractional `` rotations '' can be treated as circles and arcs respectively .",
    "therefore , the first term of eqn .",
    "[ eq : fftcosine ] results in a semi - circular arc of length @xmath92 _ along the arc _ , while the second term produces a semi - circular arc of length @xmath93)$ ] along the arc .",
    "the dft response is simply a vector drawn from the origin to the end of the arc ( see fig .",
    "[ fig : vectors ] ) . since virtually",
    "all astrophysical applications involve @xmath94 , where the first term dominates the response , we will ignore the second term in the rest of our analysis .",
    "the final response is a chord subtending @xmath95 radians of a circle of radius @xmath96 .",
    "the equation for the length of a chord is @xmath97 where @xmath98 is the arc length and @xmath99 is the angle subtended by the chord .",
    "the curvature of the arc away from the signal s starting phase @xmath75 results in a phase change of @xmath100 .",
    "therefore , the dft response and power are    @xmath101 \\\\      & = & \\frac{na}{2 } \\ , { \\mathrm{e}}^{{\\mathrm{i}}\\phi } \\ , \\ , { \\mathrm{e}}^{-{\\mathrm{i}}\\pi ( k - r ) }      \\ , \\frac{\\sin[\\pi ( k - r)]}{\\pi ( k - r ) }   \\\\      \\label{eq : cosresp }      & = & a_o \\ { \\mathrm{e}}^{-{\\mathrm{i}}\\pi ( k - r ) } \\ , { { \\rm sinc}}\\left[\\pi(k - r)\\right ] \\\\      p_k       & = & \\left| a_k \\right|^2 = p_o \\ { { \\rm sinc}}^2 \\left[\\pi(k - r)\\right ] ,    \\end{aligned}\\ ] ]    where @xmath102 is the dft response for an integral frequency signal ( eqn .",
    "[ eq : theocosresp ] ) , @xmath103 is the corresponding fourier power , and the @xmath104 function is defined as @xmath105 .",
    "this result is easily confirmed by a direct integration of eqn .",
    "[ eq : ftintegral ] where @xmath27 is equal to eqn .",
    "[ eq : cosineexp ] with @xmath106 .    the @xmath104 factor in eqn .",
    "[ eq : cosresp ] produces a loss of sensitivity for the standard fft to most real - world signals ( where @xmath25 is not an integer ) .",
    "this effect , often called `` scalloping '' ( e.g. * ? ? ?",
    "* ) , is shown in fig .",
    "[ fig : interbin ] , and causes a worst - case ( when @xmath107 ) amplitude reduction of @xmath108  a nearly @xmath109 loss of signal power . on average , scalloping results in a @xmath110 loss of signal power @xcite .",
    "it is important to remember , though , that this loss in sensitivity is due to the finite frequency resolution of the fft algorithm rather than an intrinsic feature of the data itself . in ",
    "[ sec : interpolation ] we discuss various methods to reduce or even eliminate this loss of sensitivity .",
    "many real - world periodic signals are not sinusoidal .",
    "fortunately , we can expand all real - valued pulsations as a series of @xmath62 sinusoidal components    @xmath111    where @xmath112 specifies the harmonic number ( with @xmath113 known as the `` fundamental '' ) , and @xmath114 and @xmath115 represent the amplitude and phase of each component respectively . due to the linear nature of the ft",
    ", we can treat the harmonics as independent sinusoidal signals .",
    "each of these sinusoids produces a fourier response equivalent to eqn .",
    "[ eq : cosresp ] , except that @xmath116 becomes @xmath117 .    for nearly sinusoidal pulsations only the first few terms of eqn .",
    "[ eq : cosseries ] contain significant amplitudes , @xmath114 .",
    "this results in a similarly small number of significant peaks in the corresponding power spectrum of the data .",
    "low duty - cycle pulsations ( i.e. those with a pulse that is short compared to the pulse period ) , such as most radio pulsars , on the other hand , have dozens of significant terms in their expansions and therefore harmonics in their power spectra .",
    "a useful pulsation model , particularly for radio and x - ray pulsars , can be constructed based on a modified von mises distribution ( mvmd ) @xmath118 where @xmath119 is the instantaneous time , @xmath120 is the modified bessel function of zeroth order , and the shape parameter , @xmath121 , determines the width of the function ( e.g. * ? ? ? * ) . in the limit as @xmath122 ,",
    "the mvmd becomes a sinusoid , while as @xmath123 , it becomes a gaussian ( see fig .  [",
    "fig : mvmd ] ) .",
    "the integral of the mvmd over a single pulse period is simply @xmath74 , all of which is pulsed ( i.e.  the pulsed fraction is one ) . the full - width at half - maximum ( fwhm ) as a fraction of a pulse , is @xmath124\\right\\},\\ ] ] and the maximum value is @xmath125    the ft of the mvmd can be computed in a particularly convenient form for harmonic analysis . according to ( * ? ? ?",
    "9.6.34 ) , we can expand the exponential in the mvmd as @xmath126 where @xmath127 is the modified bessel function of order @xmath128 .",
    "when combined with the rest of the mvmd definition we have @xmath129 this expression is simply a `` dc '' term ( since the integral over a pulse equals @xmath74 ) plus a series of independent cosinusoidal harmonics .",
    "after fourier transforming ( i.e.  substituting into eqn .",
    "[ eq : ftintegral ] with @xmath130 ) , we are left with a series of harmonics of amplitude @xmath131 $ ] and phase @xmath132 at fourier frequency @xmath133 .",
    "it is important to note that as @xmath134 and the pulse becomes narrower , the fourier amplitudes of the low order harmonics are twice that of a sinusoid with the same pulsed fraction ( see the dashed line in fig .  [",
    "fig : harmonics ] ) .",
    "this fact , along with the large number of harmonics that low duty - cycle pulsations generate , can significantly increase search sensitivities to such pulsations ( see fig .",
    "[ fig : sensitivities ] ) .",
    "[ fig : harmonics ] shows the approximate number of significant harmonics ( meaning that a harmonic s amplitude is greater than one - half the amplitude of the fundamental ) generated by an mvmd pulsation , as well as a histogram of the duty - cycles of over 600 radio pulsars ( the majority of which are from * ? ? ?",
    "most radio pulsars have duty - cycles @xmath135 corresponding to @xmath136 significant harmonics  assuming a sufficient data sample rate .      when a periodic signal is present in a noisy time series , a sum of @xmath62 powers @xmath63 , containing some amount of signal power @xmath137 , is no longer described by a @xmath57 distribution with @xmath65 degrees of freedom ( see   [ sec : noise ] ) .",
    "@xcite calculated the expectation value and variance of @xmath63 as @xmath138 and @xmath139 respectfully .",
    "he also derived the exact probability density function for @xmath63 which can be integrated to give the probability that @xmath63 is greater than or equal to some power @xmath60 , @xmath140 when @xmath141 this equation reduces to eqn .",
    "[ powsumprob ] .",
    "the fact that the probability density function for a signal plus noise is different from a @xmath57 distribution with @xmath65 degrees of freedom is very important when trying to determine the sensitivity of a search for pulsations or an upper limit to the amplitude of a periodic signal present in a time series .",
    "@xcite describe a procedure for correctly determining search sensitivities and upper limits using the equations of @xcite .      since many of today s astronomical time series come from photon counting experiments , it is important to raise some of the issues particular to fourier analysis of such data .",
    "if we can assume purely poissonian statistics , a power spectrum of pure noise is flat , and can be normalized simply by dividing by the total number of photons in the data ( the zeroth or `` dc '' frequency bin from the dft  see  [ sec : noise ] ) .",
    "in addition to this difference in power spectrum normalization , the other points worth noting come from the fact that photon counting data is based on the measurement of events rather than the instantaneous sampling of a continuous process .",
    "one important issue that is beyond the scope of this paper is dead - time correction .",
    "dead - time effects modify a detector s sensitivity to photons for some time after the detection of an earlier photon .",
    "these effects can cause complicated non - linear and frequency - dependent systematics during fourier analysis .",
    "we refer the reader to @xcite and references therein , for a thorough discussion of this topic .      many high - energy telescopes and detectors produce time series of binned photons rather than the sampled data produced by radio telescopes .",
    "since binning essentially averages a periodic signal s instantaneous rate over the binning time ( @xmath1 ) , it modifies the fourier response to the signal .",
    "binning removes phase information from the data and causes the fourier response to sinusoidal pulsations to become frequency - dependent  resulting in decreased sensitivity at high frequencies ( e.g. * ? ? ?",
    "* ; * ? ? ?",
    "the frequency - dependent loss in fourier amplitude due to binning is @xmath142 or @xmath143 .",
    "the binned data fourier response to a sinusoid is therefore eqn .",
    "[ eq : cosresp ] times this factor .",
    "this decrease in sensitivity corresponds to a loss in signal power of about @xmath144 at half the nyquist frequency and @xmath145 at the nyquist frequency itself .    for poissonian noise ( i.e.  from a photon - counting experiment that does not introduce count - rate dependent systematics ) , which is independent of the sampling interval , the fourier response is flat over all frequencies .",
    "this is in contrast to a sinusoidal signal passing through the same system which suffers the frequency - dependent attenuation described above@xcite .",
    "such behavior is important when trying to estimate limits or amplitudes for pulsations in a time series @xcite .",
    "the fourier analysis of gamma - ray or x - ray observations often places us in a very unique regime  very long integration times ( @xmath146s ) with very low numbers of counts ( @xmath147 photons ) .",
    "in addition , due to visibility constraints based on the orbits of the telescopes , large fractions of the time between the first and last photons may be devoid of counts .",
    "fourier analysis of such data can overwhelm present computational resources .",
    "for example , a @xmath148s observation ( about 11.6  days ) with photon time - of - arrival ( toa ) resolution of @xmath149s would require a 10  gpt fft for a full - resolution analysis .",
    "such ffts , while possible , are extremely difficult to compute unless very special and dedicated hardware resources are available .",
    "if this data contains only a small number of photons , however , we can exactly compute the dft over any frequency range and to any frequency resolution using a brute - force implementation of the ft .",
    "if we treat each toa as a sample of amplitude one , an exact dft amplitude at arbitrary fourier frequency @xmath25 becomes @xmath150 where @xmath151 is the number of photons , @xmath152 is the toa of the @xmath153 photon , @xmath154 is the time of the start of the observation , and @xmath2 is the total duration of the observation .",
    "very quick harmonic - summing searches of an observation are possible using this technique , with the added benefit that `` scalloping '' ( see  [ sec : sinusoid ] ) is non - existent .    since eqn .",
    "[ eq : dftexact ] only involves a summation over the number of photons , it can be computed quickly if @xmath151 is relatively small .",
    "great increases in computation speed can be had if we search a regular grid of fourier frequencies .",
    "trigonometric recurrences such as    @xmath155",
    "\\\\      \\sin(\\theta + \\delta ) & = & \\sin(\\theta ) -      \\left[\\alpha\\sin(\\theta)-\\beta\\cos(\\theta)\\right ] ,    \\end{aligned}\\ ] ]    where @xmath156 and @xmath157 , allow extremely efficient calculation of the complex exponential for each toa @xcite .",
    "this technique allows one to calculate billions of fourier frequencies from a few hundred photons using only modest computational resources .",
    "the potential for up to a 30% decrease in signal - to - noise ( @xmath158 ) due to an essentially arbitrary difference between the signal frequency and the integer frequency of the nearest fourier bin is clearly a drawback in the use of the dft ( see  [ sec : sinusoid ] ) .",
    "however , if we could calculate the fourier transform ( ft ) at a higher frequency resolution than the @xmath12 spacing that results from the fft , we could significantly reduce or eliminate scalloping and effectively flatten the fourier response as a function of frequency .",
    "one possibility for increasing the frequency resolution is to simply calculate the dft by a brute force summation at frequencies between the integer frequencies .",
    "such a technique is possible in special situations ( see   [ sec : lowcount ] ) , but for most applications , the computational costs would be unacceptably high .",
    "another well - known possibility is to `` pad '' the end of the time series with a large number of points with values equivalent to the mean of the data .",
    "the padding adds no power to the data but it does increase the fourier resolution since @xmath2 has been artificially increased by the padding . while this technique is simple and effective for short time series , the difficulties involved in performing very long ffts (  [ sec : longffts ] ) makes this technique difficult when dealing with long time series .    yet another way to calculate",
    "a higher - resolution fourier response is to use the complex amplitudes produced by the standard fft to interpolate responses at non - integer frequencies  a process known as `` fine - binning '' or `` fourier interpolation '' ( e.g. * ? ? ?",
    "similar techniques allow the full recovery of a signal s theoretical coherent response provided that the signal s behavior during the observation is either known or can be guessed .",
    "the purpose of fourier interpolation is to calculate a complex fourier amplitude at an arbitrary frequency @xmath159 , where @xmath25 is any real number , such that the result is sufficiently close to the exact calculation , @xmath160 we can rewrite this expression as @xmath161.\\ ] ] where the @xmath20 are the complex fft amplitudes at the integer frequencies @xmath162 ( see appendix  [ app : fourinterp ] and  [ sec : correlation ] for a derivation and discussion of this result ) .    the @xmath104 function in eqn .",
    "[ eq : conv1 ] , provides the key to computing an accurate interpolated amplitude using a relatively small number of operations .",
    "since @xmath163\\to0 $ ] as @xmath164 , the expansion of @xmath165 in terms of the @xmath20 is dominated by the local fourier amplitudes ( i.e.  where @xmath166 ) .",
    "we can therefore approximate @xmath165 as @xmath167-m/2}^{[r]+m/2 } a_k \\ { \\mathrm{e}}^{-{\\mathrm{i}}\\pi(r - k ) }     { { \\rm sinc}}\\left[\\pi(r - k)\\right],\\ ] ] where @xmath90 $ ] is the nearest integer to @xmath25 , and @xmath62 is the number of neighboring fft bins used in the interpolation .",
    "note that the interpolation is simply a correlation of the local fft spectrum around the desired frequency element with a `` template '' response  in this case the theoretical response of a dft to a sinusoid as described by eqn .",
    "[ eq : cosresp ] .    the upper panel in fig .",
    "[ fig : ngc6544 ] shows both the raw fft power spectrum ( denoted by grey dots ) and the interpolated power spectrum ( the line connecting the dots ) for a radio observation of the short - period binary pulsar psr  j1807@xmath1682459 . the spectra cover a narrow frequency range near the pulsar s rotational frequency and were calculated using @xmath169 and a frequency step size of @xmath170 ( compared to the raw fft frequency step size of @xmath171 ) . note that the interpolated spectrum reveals much more information regarding the shape of the frequency profile  including the true amplitude and location of the maximum in fourier power .",
    "we will see in  [ sec : sigprops ] how this can be used to deduce further information regarding the signal properties .",
    "a computationally less expensive version of fourier interpolation is `` interbinning , '' where we approximate the ft response at half - integer frequencies using only the nearest 2 integer frequency bins . by using the fourier interpolation equation ( eqn .",
    "[ eq : interp ] ) with @xmath172 , ignoring an overall phase shift , and boosting the response such that the best - case response ( at half - integer frequencies ) is equivalent to the full response , we get @xmath173 this particular formulation of interbinning was reported by @xcite , and its response is shown in fig .",
    "[ fig : interbin ] .",
    "@xcite have contributed a correction to this formula for use when the data are padded at the end .",
    "interbinning is extremely useful since such a computationally inexpensive calculation reduces the maximum loss of signal - to - noise from @xmath174 or @xmath175 at a frequency offset of  bin to @xmath176 at an offset of @xmath177 bins .",
    "this large but cheaply - obtained reduction in scalloping can be extremely beneficial when searching large numbers of fft bins and interbins .",
    "it is important to note that interbins as defined above have three different properties than integer fft bins .",
    "first , they have different noise properties , which makes calculation of the significance of interbin powers much more difficult .",
    "second , each interbin is correlated with the integer bins it was created from , meaning that interbins are not independent fourier trials ( see  [ sec : dft ] for a discussion of the ifs ) . and",
    "finally , interbins do not recover the correct phase of a sinusoid at the interbin frequency .",
    "in general , since interbins are most commonly used during searches to simply identify signals in the power spectrum that would otherwise have been lost due to scalloping , these weaknesses do not degrade the usefulness of their calculation .",
    "when a signal is identified , a full - scale interpolation of the fourier amplitudes around the signal using eqn .",
    "[ eq : interp ] allows accurate estimates to be made of the signal s significance and other properties ( see  [ sec : sigprops ] ) .",
    "fourier interpolation serves as a specific example of a much more general technique  the ability to completely recover the fully coherent response for virtually any signal . for fourier interpolation",
    ", we can exactly calculate the response of any fourier frequency based purely on the properties of the ft . to correct the fourier transform s response to a particular signal , we must know not only the properties of the ft , but the properties of the signal we are looking for as well .",
    "for the cases we will discuss , this ability comes in one of two forms : matched filtering in the fourier domain using only the `` local '' fourier amplitudes near the fourier frequencies of interest ( which we call the `` correlation technique '' ) , or the straightening of the curved fourier vector addition in the complex plane ( which we will call `` vector bending '' ) .      in order to illustrate these two methods ,",
    "we demonstrate how to correct for a signal whose response is reduced due to a constant frequency derivative @xmath178  ( or in fourier frequency bins , @xmath179 ) .",
    "the dft operates , as we noted in ",
    "[ sec : sinusoid ] , by `` derotating '' the vector addition of the data in the complex plane by changing the phases of each of the vector elements  causing a straight line to form for a sinusoidal signal with integral frequency . in the presence of a frequency derivative",
    "however , the signal frequency may change by one or more frequency bins over the course of the observation .",
    "the complex phase corrections provided by the dft will fail to completely derotate the data , and pulsation power will be `` smeared '' across several nearby frequency bins  causing a decrease in the measured dft response ( e.g. * ? ? ? * ) .",
    "[ fig : vectors ] illustrates this effect in the complex plane .    as with a frequency error , an uncorrected frequency derivative causes the vector addition to form an arc ,",
    "although in this case quasi - parabolic rather than circular .",
    "the decreased dft response equals the distance from the origin to the end of the arc .",
    "this distance is significantly shorter than that of a coherently detected signal which equals the the length along the arc",
    ".    signals with constant or nearly constant @xmath178  are quite common in pulsar astronomy  especially when dealing with time series of very long duration . in such long observations ,",
    "even the very small spin - downs typical of pulsars can cause a signal to drift across numerous fourier bins .",
    "the doppler effects of binary pulsar orbits cause similar frequency drifting when the observation time is much shorter than the orbital period .",
    "the `` standard '' method to correct for a constant frequency derivative is to `` stretch '' the original time series to compensate for the known or assumed @xmath178 .",
    "this process involves re - sampling the data ensemble @xmath5 using a transformation similar to @xmath180 where @xmath181 is the time used when sampling the original data , @xmath178  is the frequency derivative , and @xmath182 is the initial frequency of the signal .",
    "additional details and variations on the theme can be found in @xcite and @xcite .    by stretching the data using the appropriate transform and then ffting the corrected time series",
    ", we can recover the fully coherent response .",
    "such techniques have been used with significant success in searches of relatively short time - series ( e.g. * ? ? ?",
    ". however , this technique runs into significant difficulties when trying large numbers of transformations using long time series where computation of the fft is non - trivial . both techniques that we will mention",
    "allow full corrections to be made to a signal without requiring multiple ffts of the full original data set .",
    "the correlation technique is the more powerful of the two methods , and uses matched filtering in the fourier domain to `` sweep - up '' signal spread over a number of frequency bins into a single bin . in astrophysical applications , we usually have some sort of `` pure '' signal ( like a harmonic from a millisecond pulsar ) , whose frequency changes as a function of time due to some other process ( such as orbital motion or pulsar spin - down ) . in the fourier domain ,",
    "these processes cause the perfect @xmath104-like response of a harmonic to be spread over numerous local fourier bins  in effect , the @xmath104 response is convolved with a finite impulse response ( fir ) filter ( where finite in this case refers to a small portion , say @xmath62 bins , of the frequency range analyzed rather than a short period of time ) . if we can predict the complex form ( and phase ) of that fir filter , we can recover the coherent response ( i.e.  the perfect @xmath104-function ) by correlating the appropriate fourier bins with a `` frequency - reversed '' and complex - conjugated template that matches the filter .    in mathematical terms ,",
    "consider a signal with a normalized fourier response of @xmath183 , where @xmath184 is simply the frequency offset of bin @xmath9 from some reference frequency @xmath185 , which goes to zero as @xmath186 approaches some number of bins @xmath187 .",
    "for fourier interpolation as described in ",
    "[ sec : interpolation ] , this response is equal to eqn .",
    "[ eq : cosresp ] without the @xmath116 factor ( i.e.  normalized to an amplitude of one for a coherent response ) .",
    "the complex - valued fourier response of such a signal at frequency @xmath185 can be calculated with the sum @xmath188-m/2}^{[r_o]+m/2 } a_k\\ a_{r_o - k}^*.\\ ] ] if @xmath185 is initially unknown ( i.e.  we are searching for a signal with the response shape as defined by the template but at an unknown frequency ) we simply compute this summation at a range of frequencies @xmath25 .",
    "calculating eqn .",
    "[ eq : correlation ] over a range of evenly spaced frequencies is equivalent to correlating the raw fft amplitudes with the template and is therefore most efficiently computed using short ffts and the convolution theorem . with ffts of length @xmath189 ,",
    "such that @xmath190 , we can search a very - long fft of length @xmath191 for any signal whose @xmath183 we can compute , using overlap - and - save or overlap - and - add techniques ( see e.g. * ? ? ?",
    "such calculations have advantages over standard time - domain `` stretching '' techniques in that that they are memory local and can be easily parallelized  important properties when dealing with very - long time - series and modern distributed memory computer architectures .    moving to our example of a signal with a constant frequency derivative ,",
    "a single harmonic of the signal has the form    @xmath192 \\\\    & = & \\frac{a}{2}\\left[{\\mathrm{e}}^{2\\pi{\\mathrm{i}}\\left(r_o u +           \\frac{\\dot{r}}{2}u^{2}\\right ) }      { \\mathrm{e}}^{{\\mathrm{i}}\\phi}+{\\mathrm{e}}^{-2\\pi{\\mathrm{i}}\\left(r_o u + \\frac{\\dot{r}}{2}u^{2}\\right ) }      { \\mathrm{e}}^{-{\\mathrm{i}}\\phi}\\right],\\end{aligned}\\ ] ]    where we use the same notation as ",
    "[ sec : dft ] . neglecting the second term as in ",
    "[ sec : sinusoid ] and fourier transforming at some `` center '' or average frequency @xmath193 , we get @xmath194 where @xmath195 , and the real `` center '' frequency of the signal is @xmath196 .",
    "this integral can be evaluated in closed form @xmath197\\right\\}\\ ] ] where @xmath198 @xmath199 and @xmath200 and @xmath201 are the fresnel integrals @xmath202 the fourier transform response then becomes @xmath203\\right\\}.\\ ] ]    using the correlation technique , the coherent response can be recovered by convolving local fourier amplitudes with the `` frequency - reversed '' and complex - conjugated template as defined by eqn .",
    "[ eq : ffdotresp ] .",
    "this response , at average fourier frequency @xmath204 and fourier frequency derivative @xmath205 can therefore be written as @xmath206-m/2}^{k=\\left[r\\right]+m/2}a_{k }    \\ \\frac{1}{\\sqrt{2\\dot{r}}}\\left({\\mathrm{e}}^{{\\mathrm{i}}\\pi\\frac{q_k^2}{\\dot{r } } }      \\left\\{s\\left(z_k\\right)-s\\left(y_k\\right)-        { \\mathrm{i}}\\left[c\\left(y_k\\right)-c\\left(z_k\\right)\\right]\\right\\}\\right).\\ ] ]    eqn .",
    "[ eq : ffdotcorr ] takes into account the fact that the signal has been `` spread '' relatively evenly into the @xmath205 closest frequency bins to @xmath207 , while an additional small amount of signal has `` leaked '' into bins further away  much like the non - zero wings of the @xmath104-like response to a constant frequency signal . as a rule of thumb",
    ", the correct fourier amplitude will be well - approximated if @xmath62 is chosen such that @xmath208 .",
    "large scale searches of pulsations with constant frequency derivatives have been conducted using the correlation technique .",
    "a successful example is a search for pulsars in globular cluster ngc  6544 using data taken with the parkes radio telescope @xcite .",
    "the search was conducted using an fft of 13865600 points over fourier @xmath205 values from @xmath209 to @xmath210 with a step - size of @xmath211 and included the calculation of amplitudes at half - bin frequency intervals .",
    "the search resulted in the detection of the 3.06ms psr  j1807 - 2459 in a low - mass binary with orbital period 1.7h , the second shortest radio pulsar orbital period known .",
    "a detailed view of the pulsar s fundamental harmonic is shown in fig .  [",
    "fig : ngc6544 ] .",
    "the plot was calculated using the correlation technique with spacings of @xmath212 and @xmath213 .",
    "the generation of such a piece of the @xmath24@xmath178  plane takes only a fraction of a second on a rather modest workstation .",
    "vector bending is one of the simplest and most straightforward methods to correct a fourier response that has been smeared over several local frequency bins . as we described in ",
    "[ sec : dft ] , the dft can be thought of as the vector addition of @xmath26 complex numbers .",
    "this addition produces a straight line in the complex plane for a coherently detected sinusoid . for a sinusoid with a non - integral or time - varying pulsation frequency ,",
    "the standard dft addition produces a curved shape ( see fig .",
    "[ fig : vectors ] ) .",
    "since the amplitude of the fourier response is the distance between the origin and the end - point of the vector addition , any curvature in the vector addition implies non - optimal signal detection .",
    "the precise shape of the response curve in the complex plane depends on the mismatch of the signal s ( possibly time - dependent ) pulsation frequency and the frequency used in forming the dft addition ( i.e.   the closest fft bin ) .",
    "regardless of the shape , though , for short enough segments of the curve , the segments differ little from straight lines .",
    "we can therefore approximate the shape of the curve as a sum of @xmath214 linear segments , each of which contains @xmath215 points from the full - resolution vector addition . in terms of the @xmath87 dft amplitude , we can write this as @xmath216 where @xmath217 .",
    "this is equivalent to calculating and then summing @xmath214 independent dfts ( the @xmath218 ) , each of which suffers virtually no loss in sensitivity when the curvature over a segment is small .    using these vector addition segments or sub - vectors , we can correct for the loss of sensitivity due to curvature by simply straightening the vector addition .",
    "if we can predict the true pulsation frequency of a signal as a function of time , we can predict how much curvature will accumulate in each sub - vector and then remove it by rotating the segment appropriately .    for our example of a signal with constant frequency derivative , the instantaneous phase ( ignoring the intrinsic phase of the signal ) is equal to    @xmath219    where @xmath220 is the initial pulsation frequency of the signal , and @xmath221 is the frequency derivative .",
    "the process of taking a dft removes an instantaneous phase equivalent to @xmath222 from the signal ( see eqn .",
    "[ eq : ftintegral ] ) .",
    "so the instantaneous phase error is equal to    @xmath223    therefore , to correct a particular signal using vector bending , we first calculate the @xmath218 using eqn .",
    "[ eq : fold ] for a particular fourier frequency @xmath25 ( such as the frequency of a known pulsar ) .",
    "now we attempt to un - bend the full fourier response by summing the @xmath218 after correcting for the phase errors @xmath224 as defined by eqn .",
    "[ eq : phierror ] .",
    "the corrected response is equal to @xmath225 a choice of @xmath226 will essentially eliminate the loss of response for reasonable frequency offsets and frequency derivatives ( i.e. less than a few 10s of fourier bins ) .    while impractical for large - scale searches due to the fact that the @xmath218 must be recomputed every few @xmath25 , vector bending offers significant computational advantages in certain situations .",
    "in particular , x - ray observations often consist of short ( @xmath227 hour ) `` on - source '' segments separated by hours , days , or even weeks of `` off - source '' time ( see also  [ sec : photon ] ) .",
    "an fft of the entire time series might be prohibitively expensive .",
    "however , if we can determine an `` initial guess '' frequency ( e.g.  by ffting one segment of the observation or from an ephemeris ) , we can quickly calculate the @xmath228 at this frequency from the `` on - source '' intervals alone .",
    "we can reconstruct the @xmath24@xmath178  plane around our frequency of interest without ever creating the full `` filled - in '' or padded time series , let alone calculating a potentially huge fft .",
    "such techniques have allowed us to perform frequency analysis of very - long stretches of data from rosat observations of psr  b0540 - 59 @xcite .",
    "similarly , fig .",
    "[ fig : vectors ] shows the use of the method for a 2.4day observation of the crab pulsar .",
    "besides correcting for losses of sensitivity , fourier interpolation and the other response correcting techniques mentioned in  [ sec : respcorr ] allow us to determine other useful properties of a detected signal . using detailed amplitude and phase information from a signal s fourier harmonics , we can estimate properties such as the statistical significance of the signal , the location and duration of the signal in the time series ( the `` centroid '' and `` purity '' respectively ) , the precise pulsation frequency , and estimates of the measurement errors for fourier power and phase .",
    "the first step when estimating signal properties in the fourier domain is to isolate the true peak of the fourier response in power .",
    "this is easily accomplished by using the matched filtering techniques to generate an oversampled grid of amplitudes near and around the signal candidate ( see figs .",
    "[ fig : ffdot ] and [ fig : ngc6544 ] ) .",
    "simple optimization algorithms such as the downhill simplex method can then be used to refine the peak location ( e.g. * ? ? ?",
    "once the peak has been located , estimates of the first and second derivatives of power and phase with respect to fourier frequency , obtained using fourier interpolation , can be used to calculate various useful signal properties @xcite .      when the peak of the fourier response has been located as a function of fourier frequency and the other search parameters ,",
    "the measured power is defined as @xmath229 where @xmath230 is the expected noise power and is usually described by one of @xmath58 , @xmath67 , or @xmath151 as discussed in  [ sec : noise ] .",
    "* see  [ sec : signoise ] ) showed that since the measured power is a random variable due to the presence of noise , its variance is @xmath231 , where @xmath232 is the power caused by the signal . since we do not _ a priori _ know the true signal power , a good estimate for the variance of the measured power is simply @xmath233 since @xmath234 .    using @xmath235 , as well as the knowledge that a sinusoid of amplitude @xmath74 in a noisy time series produces a power with an expectation value of @xmath236 ( see   [ sec : sinusoid ] )",
    ", we can estimate the signal amplitude as @xmath237 for binned data containing a signal with fourier frequency @xmath25 , the measured power should be multiplied by @xmath238 to correct for the loss in sensitivity due to binning ( see   [ sec : binned ] ) .",
    "@xcite provide detailed instructions on how to estimate upper limits on pulsation amplitudes as well as estimates of the overall sensitivity of a search .",
    "the statistical significance of a signal is also determined by @xmath235 .",
    "the probability that noise caused a particular power to equal or exceed @xmath235 is given by @xmath239 ( eqn .",
    "[ powprob ] with @xmath240 ) .",
    "but for a search over @xmath241 independent fourier powers , the probability that at least one of the noise powers exceeds @xmath235 is given by @xmath242 @xcite show how to use this information to set detection thresholds that minimize the number of spurious candidate signals and give high confidence that signals with powers above the thresholds are real .",
    "using the real and imaginary parts of the peak fourier response , we can also calculate the phase of the sinusoidal signal as @xmath243\\ ] ] radians .",
    "using similar arguments as for the measured power , the variance of the measured phase is approximately @xmath244 radians .",
    "astronomical observations of pulsations effectively consist of a _ window _ of on - source time where pulsations are present , and the rest of the time when they are not . for most of this paper",
    "we have assumed that a signal is present throughout the observation as evidenced by the limits of integration for eqn .",
    "[ eq : ftintegral ] , which in time - normalized units go from @xmath23 , or equivalently , from @xmath119 . in effect , pulsations such as that defined in eqn .",
    "[ eq : cosine ] are multiplied by a square window function defined as 1 during the observation and 0 at all other times .",
    "this window function is simply a property of the dft and is due to the finite duration of our observation .",
    "it is possible , though , and for various reasons often likely , that a signal we are observing turns on and off or varies in intensity during an observation .",
    "the behavior of the signal itself effectively defines a new window function , @xmath245 . by measuring the moments of this window function with respect to time , we can determine approximately where in our data a signal is located and for how long .",
    "the approximate location of a signal in a time - normalized time series is described by its centroid , @xmath246 which is proportional to the first moment of the window function with respect to time .",
    "more specifically , @xmath247 @xcite wrote this in terms of the measured fourier response as @xmath248 where @xmath249 and @xmath250 is the phase measured at the peak of the fourier response ( i.e.  @xmath251 ) and @xmath25 is the fourier frequency ( see appendix  [ app : centroid ] for a derivation ) .",
    "signals present throughout an observation have @xmath252 while those present in only the first or second halves of the observation have @xmath253 or @xmath254 respectively .",
    "the second moment of the window function with respect to time is related to the moment of inertia of a function and can therefore be used to estimate the root - mean - squared ( rms ) dispersion of the pulsations in time about the centroid . using this information , @xcite defined a parameter called the `` purity '' ( and symbolized by @xmath255 ) as @xmath256 where @xmath249 is the measured power at the the peak of the fourier response ( i.e.  @xmath235 , see appendix  [ app : purity ] for a derivation ) .",
    "the scaling in eqn .",
    "[ eq : purity ] is chosen such that the rms dispersion of the signal about the centroid for a window function @xmath245 , is equivalent to that of a rectangular window function of duration @xmath255 ( in units of the time series length ) centered on the centroid .",
    "a signal present throughout the data would have @xmath257 , while one present in only half the data ( in a continuous section ) would have @xmath258 .",
    "signals present only at the start and end of an observation but absent in the middle have @xmath259 .",
    "purity can also help to identify sidelobes caused by a periodic modulation of a signal as these fourier amplitudes have @xmath260 .",
    "since the location and duration of a signal in an time series affects the fourier response , it is important to understand how eqn .",
    "[ eq : cosresp ] changes if a signal is present during only part of an observation . in appendix",
    "[ app : response ] , we show that when close to the peak of a signal s fourier response , @xmath261\\ ] ] where @xmath262 , @xmath263 is the intrinsic phase of the signal , and @xmath185 is the true signal frequency ( in fft bins ) .",
    "this equation demonstrates that for centroids different from @xmath264 , the phase shift between consecutive fft bins differs from the @xmath265 radians shown in eqn .",
    "[ eq : cosresp ] .",
    "similarly , for purity values different from 1 , neighboring fft bins show more or less correlation with each other ( i.e.  the central peak of the sinc  function changes its width ) .",
    "the true pulsation frequency of the signal is located at the point where @xmath266 . furthermore , given the response in eqn .",
    "[ eq : cpresp ] , we can show ( appendix  [ app : freqsigma ] ) that the uncertainty in this measurement ( in fourier bins ) is given by @xmath267 this uncertainty is considerably smaller than the often - quoted `` frequency error '' for the fft of one bin width , which is simply the frequency resolution returned by the fft algorithm .",
    "if the correlation method is used to isolate a peak in the @xmath24@xmath178   plane as shown in figs  [ fig : ffdot ] and [ fig : ngc6544 ] , we can calculate the uncertainty in the measured @xmath205 value by using similar arguments and methods as for the frequency uncertainty ( see appendix  [ app : fdotsigma ] for a derivation ) .",
    "the uncertainty in the @xmath205 ( in fourier bins ) is approximately @xmath268",
    "in this paper we have described techniques that allow sophisticated and fully coherent fourier analysis of very long time series .",
    "most of these techniques use the wealth of information provided by the fourier phases  information discarded during `` standard '' analyses based on raw power spectra .",
    "significant gains in sensitivity and efficiency are possible when using fourier phase information during the search for periodic signals ( using the fourier domain matched filtering techniques described in  [ sec : respcorr ] ) and when characterizing signals that are known to be present in the data ( using the parameters described in ",
    "[ sec : sigprops ] ) .",
    "the methods of fourier domain matched filtering allow efficient , memory local , and inherently parallel analysis of extremely long time series with only modest computational resources .",
    "billion point out - of - core ffts followed by fully coherent matched filtering pulsation searches are possible on `` standard '' workstations .",
    "more traditional time domain based techniques ( such as acceleration searches performed by stretching or compressing the time series followed by large in - core ffts ) on similarly sized time series require specialized high - performance computing resources , assuming they can be performed at all .",
    "as astronomical instruments become more sophisticated and specialized , time series of ever increasing duration and time resolution will appear .",
    "the fourier domain techniques described in this paper should prove to be essential tools in their analysis .",
    "_ acknowledgments _",
    "we would like to thank g.  fazio for supporting our research and encouraging us in this work .",
    "additional thanks go to j.  grindlay , b.  schmidt , f.  seward , r.  narayan , v.  kaspi , and l.  greenhill for their encouragement and comments .",
    "many of the computations for this paper were performed on equipment purchased with nsf grant phy 9507695 .",
    "s.m.r . acknowledges the support of a tomlinson fellowship awarded by mcgill university .",
    "is supported in part by an nsf career grant .",
    "following the derivation found in @xcite , we begin with the definition of the @xmath4 dft element @xmath269 which we then rewrite by substituting the inverse dft for the @xmath5    @xmath270    the last summation can be computed exactly using the identity @xmath271 such that when @xmath272 we have    @xmath273}{\\sin\\left[\\pi(k - l)/n\\right ] } \\\\      & \\simeq & { \\mathrm{e}}^{-{\\mathrm{i}}\\pi(k - l)}\\frac{\\sin\\left[\\pi(k - l)\\right]}{\\pi(k - l)/n } \\\\      \\label{appb2 }      & \\simeq & n\\ { \\mathrm{e}}^{-{\\mathrm{i}}\\pi(k - l ) } { { \\rm sinc}}\\left[\\pi(k - l)\\right ] .",
    "\\end{aligned}\\ ] ]    substituting this expression into eqn .",
    "[ appb1 ] and changing the integer frequency @xmath9 into a continuous real - valued frequency @xmath25 , we arrive at eqn .",
    "[ eq : conv1 ] @xmath274.\\ ] ]",
    "for a given fourier frequency offset @xmath275 , where @xmath185 is the fourier frequency of the signal , the magnitude of the fourier response and the power go as ( see appendix  [ app : response ] )    @xmath276    where @xmath255 is the signal purity .",
    "we can expand the @xmath104 function in order to approximate the expression for the power near the peak of the response as @xmath277 ^ 2     \\simeq p_{meas } \\left[1 -       \\frac{\\left(\\pi\\alpha\\delta_r\\right)^2}{3}\\right].\\ ] ] taking the derivative of power with respect to @xmath25 and solving for @xmath278 we obtain @xmath279 as expected , when the fourier frequency equals the true frequency of the pulsations ( i.e.  @xmath280 ) , the fourier response peaks and @xmath281 .    in order to estimate the uncertainty in @xmath278 ,",
    "we apply standard propagation of errors to arrive at @xmath282 where we have replaced @xmath283 with @xmath284 to simplify the notation .",
    "the derivative of the power at the true frequency can be approximated using finite differences as @xmath285 where we have simply renamed @xmath286 and @xmath287 .",
    "the uncertainty in @xmath284 can also be approximated using finite differences and error propagation . since @xmath288 and @xmath289",
    "are highly correlated when @xmath290 , their uncertainties are also correlated giving @xmath291    now , we turn to the question of the uncertainty in @xmath288 , closely following @xcite . the amplitude of the fourier response at the true signal frequency can be written as @xmath292 where @xmath293 are the points in our time series as defined in eqn .",
    "[ ftdef ] , but scaled using the appropriate @xmath230 such that the measured power , @xmath235 , is properly normalized ( see   [ sec : noise ] ) . similarly , the @xmath294 represent the pulsation phases at times @xmath295 , but rotated by the measured fourier phase , @xmath251 , such that the result of the vector addition lies along the real axis in the complex plane ( i.e.  the final complex phase is zero ) . in effect",
    ", this transform isolates components of the data that are parallel to the final fourier response .    at a small frequency",
    "offset @xmath278 from the true frequency , we can expand the power in a similar fashion as @xmath296 where @xmath297 are the `` phase errors '' introduced by the frequency offset .",
    "the phase errors add curvature to the vector addition and are defined as @xmath298 where @xmath22 is the normalized time , @xmath299 .",
    "the @xmath264 term in eqn .",
    "[ eq : deltadef ] removes the accumulated phase error over the course of the observation ( i.e.  @xmath300 ) and makes the vector summation of eqn .",
    "[ eq : freq_pexpand ] finish on the real axis . expanding the cosine in eqn .",
    "[ eq : powexpand ] gives @xmath301    considering the uncertainties in the separate terms of eqn .",
    "[ eq : powexpand2 ] , since the cosine term is an even function of @xmath297 , it is symmetric about @xmath185 , and therefore does not contribute to the uncertainty in the @xmath284 measurement as defined by eqn .",
    "[ eq : dpow_diff ] . for the sine term ,",
    "given that the @xmath302 `` derotates '' the signal onto the real axis by definition , we see that @xmath303 furthermore , since the @xmath294 and @xmath297 are uncorrelated , the average value of this term will be zero , @xmath304 and has no systematic effect on @xmath288 .",
    "however , we can calculate the fluctuations introduced by this term @xmath305 where the cross - terms average to zero since @xmath294 and @xmath297 are uncorrelated .",
    "due to the normalization of the @xmath306 , the sum component averages to @xmath264 .",
    "the @xmath297 component has an average of    @xmath307    therefore eqn .",
    "[ eq : sine_fluct ] is equal to @xmath308 , and the variance of @xmath309 will be @xmath310 to get the standard deviation we take the square root of this expression . propagating errors to get",
    "the uncertainty in @xmath288 adds a factor of @xmath311 to give @xmath312 where we have used the approximation @xmath313 . finally , substituting into equations  [ eq : sigpp ] and  [ eq : sigr ] , we have @xmath314    a much simpler derivation of eqn .",
    "[ eq : rerror ] is possible if we realize that properly normalized powers times two are distributed according to a @xmath57 distribution with 2 degrees of freedom ( see   [ sec : noise ] ) .",
    "for such a distribution , a @xmath315 error corresponds to a change in the measured @xmath57 of @xmath264 . in the case of powers",
    ", the @xmath316 errors can therefore be found by starting with the expansion of the power around @xmath317 as given in eqn .",
    "[ eq : powexpand1 ] , @xmath318 =     p_{meas } - \\frac{1}{2},\\ ] ] and then solving for the @xmath278 that corresponds to @xmath319 .",
    "this gives @xmath320",
    "if a peak in the @xmath24@xmath178  plane has been isolated using techniques similar to those shown in  [ sec : correlation ] , we can calculate the error in the measurement of the true fourier frequency derivative @xmath322 in a manner similar to that for the frequency uncertainty as described in appendix  [ app : freqsigma ] .",
    "signals with non - zero frequency derivatives have fourier peaks which are located off the @xmath323 line in the @xmath24@xmath178  plane , but the _ shapes _ of those peaks are independent of @xmath205 and in fact depend only on the window function of the signal ( see appendix  [ app : response ] ) .",
    "the shape of the response in power as a function of @xmath324 at the `` correct '' fourier frequency @xmath325 is described by eqn .",
    "[ eq : ffdotresp ] , and can be written as @xmath326,\\ ] ] when @xmath327 is defined as @xmath328 this definition of @xmath327 keeps the magnitude of the fourier response symmetric about @xmath327 no matter what the value of @xmath329 .",
    "the power as a function of @xmath329 is therefore @xmath330 ^ 2 +      \\left[c\\left(\\sqrt{\\frac{\\alpha^2\\delta_{\\dot{r}}}{2}}\\right)\\right]^2\\right\\}.\\ ] ]    if we expand the fresnel integrals about @xmath331 as @xmath332 and then substitute , the power becomes @xmath333.\\ ] ] taking the derivative of @xmath334 with respect to @xmath205 and solving for @xmath329 gives @xmath335    from propagation of errors , @xmath336 where @xmath337 .",
    "similarly , after using a finite difference estimate of the power derivative following appendix  [ app : freqsigma ] , we find @xmath338 where @xmath339 represents the power as measured at @xmath340 .",
    "closely following appendix  [ app : freqsigma ] , we represent @xmath341 as a sum of the parallel components of the properly normalized time series points , @xmath306 , as @xmath342 the @xmath297 are the `` phase errors '' introduced when @xmath343 , and are defined as @xmath344 where the @xmath22 term comes from keeping the response symmetric about @xmath185 ( i.e.  @xmath345 ) and the @xmath346 removes the accumulated phase error over the course of the observation ( i.e.  @xmath347 ) and makes the vector summation of eqn .",
    "[ eq : fdot_pexpand ] finish on the real axis .    expanding the cosine term of eqn .",
    "[ eq : fdot_pexpand ] gives @xmath348 the first term shortens both @xmath339 and @xmath349 by the same amount and does not affect the derivative of power . for the sine term ,",
    "since @xmath294 and @xmath297 are uncorrelated , the average value is zero ( see appendix  [ app : freqsigma ] ) , but its fluctuations are important . to calculate the fluctuations",
    ", we square the terms and get @xmath350 due to the normalization of the @xmath306 , @xmath351 averages to @xmath264 as before , and we can directly calculate @xmath352 as    @xmath353    the fluctuations from the sine term are therefore @xmath354 , and since squaring eqn .",
    "[ eq : fdot_pexpand ] doubles the errors , the standard deviation of @xmath339 is @xmath355 substituting into equations  [ eq : fdot_sigpderiv ] and then  [ eq : fdot_sigrdot ] as in appendix  [ app : freqsigma ] gives us the uncertainty in the frequency derivative @xmath356",
    "the centroid is a measure of the approximate location of a signal in a time series as estimated by the first moment of the signal with respect to time ( see   [ sec : cen+pur ] ) .",
    "we can think of a sinusoidal signal in our data as being always present but modulated in intensity by some window function @xmath245 , where @xmath357 is the normalized time and @xmath2 is the length of the observation .",
    "a `` normal '' observation of a pulsar of constant intensity would therefore have @xmath358 when @xmath359 and @xmath360 at all other times ( i.e.  a square window ) .",
    "our signal is therefore described by @xmath361 where @xmath74 is the amplitude , @xmath362 is the fourier frequency , and @xmath263 is the phase of the sinusoid at time @xmath363 .",
    "since the centroid of a function is proportional to the first moment of the function with respect to time , we can easily calculate the centroid using the moment theorem of fourier transforms .",
    "@xcite does this and defines the centroid as @xmath364 where @xmath365 and @xmath366 are the fourier transform and its first derivative with respect to @xmath25 measured at @xmath367 .",
    "[ eq : true_centroid ] is not directly applicable for our sinusoidal signal since the information about the window function in eqn .",
    "[ eq : cent_sigdef ] has been shifted to the frequency of the sinusoid in accordance with the modulation theorem of fourier transforms .",
    "accordingly , we can apply the modulation theorem to eqn .",
    "[ eq : true_centroid ] which gives us @xmath368    finally , we can write @xmath369 in phasor form as @xmath370 where @xmath371 and @xmath372 represent the fourier amplitude and phase as functions of the fourier frequency @xmath25 . the derivative with respect to fourier frequency can be written @xmath373 at the frequency of our signal , the amplitude is @xmath374 and the fourier response is at its peak , making @xmath375 . therefore @xmath376 substituting eqn .",
    "[ eq : cent_aderiv ] into eqn .",
    "[ eq : mod_centroid ] we arrive at @xmath377 which is equivalent to eqn .",
    "[ eq : centroid ] .",
    "we can also estimate the uncertainty on the measured value of the centroid .",
    "following appendix  [ app : freqsigma ] from eqns .",
    "[ eq : powexpand]@xmath168[eq : amp_variance ] , we note that the same noise fluctuations introduced when offsetting from the true pulsation frequency by a small amount @xmath278 that effect the fourier amplitude will also effect the fourier phases . when @xmath278 is small and the powers are properly normalized , the amplitude fluctuations of eqn .",
    "[ eq : sine_fluct ] with variance @xmath378 correspond to an uncertainty in the phase measurement of @xmath379radians and therefore @xmath380",
    "the `` purity '' of a signal ( see   [ sec : cen+pur ] ) is a measure of the rms dispersion of the pulsations in time with respect to the centroid and is directly proportional to the variance in time of the window function of the sinusoid from eqn .",
    "[ eq : cent_sigdef ] .",
    "the time variance is defined as @xmath381 but can be written as    @xmath382 ^ 2}{4\\pi^2\\left[a(0)\\right]^2 } ,    \\end{aligned}\\ ] ]    using the moment theorem for fourier transforms ( see e.g. * ? ? ?",
    "since our signal is sinusoidal ( see appendix  [ app : centroid ] ) , application of the modulation theorem gives    @xmath383 ^ 2}{4\\pi^2\\left[a(r_o)\\right]^2 } \\\\      & = & -\\frac{a''(r_o)}{4\\pi^2 a(r_o ) } - \\hat{c}^2 .",
    "\\end{aligned}\\ ] ]    using @xmath384 and remembering that @xmath375 , the second derivative of the fourier amplitude is @xmath385 from appendix  [ app : centroid ] , we know that @xmath386 which makes the first term of eqn .",
    "[ eq : aderiv2 ] equal to zero since @xmath387 and the second term equal to @xmath388 .",
    "the second derivative of power at the peak response can be written as @xmath389 making the third term equal to @xmath390 . substituting into eqn .",
    "[ eq : mod_variance ] and simplifying gives @xmath391    if we normalize the variance using the value obtained for a signal present throughout the observation ( i.e.  a square window where @xmath392 from @xmath23 and zero elsewhere  which we will call a _ pure _ signal ) where @xmath393 and then taking the square - root , we are left with @xmath394 which is equivalent to eqn .  [",
    "eq : purity ] .    in order to estimate the uncertainty in the measurement of @xmath255",
    ", we note that by squaring eqn .",
    "[ eq : purity2 ] and substituting the finite difference approximation of @xmath395 where @xmath278 corresponds to a small frequency offset from the measured peak power @xmath249 , we get @xmath396 this means that @xmath397 where @xmath398 and the extra factor of @xmath399 comes from converting @xmath400 to @xmath401 .",
    "we can then expand the fourier amplitude around the peak of the signal as in eqn .",
    "[ eq : powexpand2 ] , where we see that the amplitude fluctuations from the sine term ( which is anti - symmetric about @xmath185 ) will cancel after the addition of @xmath402 and @xmath403 in the finite difference approximation shown above .",
    "conversely , the fluctuations due to the cosine term ( which is symmetric about @xmath185 ) will add .",
    "these fluctuations can be computed by taking the variance of the first non - constant term in the expansion of @xmath404 which is @xmath405 .",
    "the computation gives    @xmath406 ^ 2\\right\\}\\\\      & = & \\pi^4\\delta_r^4\\left[\\frac{1}{20}-\\left(\\frac{1}{6}\\right)^2\\right]\\\\      & = & \\frac{\\pi^4\\delta_r^4}{45 } ,    \\end{aligned}\\ ] ]    and since the variations in the @xmath407 term average to @xmath264 , just like the @xmath408 term did in eqn .",
    "[ eq : sine_fluct ] , the standard deviation of @xmath409 is equal to @xmath410 doubling the error when converting from amplitudes to powers and then doubling it again due to the addition of the errors from the power offsets in eqn .",
    "[ eq : pdddiff ] gives @xmath411 finally , by substituting into eqn .",
    "[ eq : purerrfact ] , we get @xmath412",
    "in order to consider the effects of centroid and purity on the fourier response to a sinusoidal signal as described by eqn .  [",
    "eq : cent_sigdef ] , we initially assume a fourier response equal to eqn .  [",
    "eq : cosresp ] of @xmath413\\ ] ] where @xmath262 , @xmath263 is the intrinsic phase of the signal , and @xmath185 is the true signal frequency ( in fft bins ) .",
    "this response is correct only for signals with a square window function ( i.e.  @xmath414 from @xmath23 and zero elsewhere ) .    from eqn .",
    "[ eq : cpdep ] we see that a change in fourier frequency of a single fourier bin causes a change in the measured fourier phase of @xmath265radians .",
    "this phase change is also visible from the centroid equation for a pure signal with @xmath252 , where @xmath415 for every @xmath416 . rewriting the centroid equation and integrating",
    ", we see that the fourier phase near the peak response goes as @xmath417 when @xmath418 , @xmath419 , allowing us to solve for the constant of integration , @xmath420 . substituting into eqn .",
    "[ eq : phase_cent ] , we see that the phase of the fourier response is equal to @xmath421 therefore , for signals that have centroids different from @xmath264 , the phase change across a single fourier bin is different from the usual @xmath265radians .    the purity , as described in ",
    "[ sec : sigprops ] and appendix  [ app : purity ] , is the effective duration of a square window which reproduces the measured rms dispersion of the signal in time about the centroid .",
    "since the fourier response to a square window goes as @xmath422 , where @xmath423 , we can see that replacing the window of length @xmath2 with one of effective duration @xmath424 causes the fourier response to go as @xmath425 .",
    "this fact is also approximately true for more complicated window functions as long as @xmath426 .",
    "the fourier response to a windowed sinusoid is therefore @xmath427.\\ ] ] numerical simulations show that this approximation is valid for purity values @xmath428 .",
    "these same `` effective duration '' arguments also apply to the shape of the response in the @xmath178  direction of the @xmath24@xmath178  plane .",
    "a change in the effective duration of a signal causes a change in the @xmath178   response since @xmath429 , or equivalently , @xmath430 .",
    "the results of this change can be calculated by directly substituting @xmath431 for @xmath205  in eqn .",
    "[ eq : ffdotresp ] , as was done in appendix  [ app : fdotsigma ] ."
  ],
  "abstract_text": [
    "<S> in this paper , we present an assortment of both standard and advanced fourier techniques that are useful in the analysis of astrophysical time series of very long duration   where the observation time is much greater than the time resolution of the individual data points . </S>",
    "<S> we begin by reviewing the operational characteristics of fourier transforms ( fts ) of time series data , including power spectral statistics , discussing some of the differences between analyses of binned data , sampled data , and event data , and briefly discuss algorithms for calculating discrete fourier transforms ( dfts ) of very long time series . </S>",
    "<S> we then discuss the response of dfts to periodic signals , and present techniques to recover fourier amplitude `` lost '' during simple traditional analyses if the periodicities change frequency during the observation . </S>",
    "<S> these techniques include fourier interpolation which allows us to correct the response for signals that occur between fourier frequency bins . </S>",
    "<S> we then present techniques for estimating additional signal properties such as the signal s centroid and duration in time , the first and second derivatives of the frequency , the pulsed fraction , and an overall estimate of the significance of a detection . </S>",
    "<S> finally , we present a recipe for a basic but thorough fourier analysis of a time series for well - behaved pulsations . </S>"
  ]
}