{
  "article_text": [
    "the estimation of the particle species content in a sample of reconstructed tracks is a recurrent problem in particle physics . to this purpose ,",
    "different experimental techniques are used to obtain information about the particle type ; typical examples are the measurement of the particle time - of - flight ( _ tof _ ) from the production vertex to a given position inside the detector , or the measurement of the particle energy loss per unit length of the traveled path due to the interaction with the detector material ( @xmath4 ) .",
    "+ the information provided by these techniques is related to the particle type but typically depends also on the track momentum . + it is common practice to include the particle identification ( _ pid _ ) information in a maximum likelihood ( ml ) fit in order to estimate the particle species content of the sample . on the other hand",
    ", the strong momentum dependence of the separation power between different particles may lead to strongly biased results , if not properly treated in the ml fit .",
    "+ to be more specific , let s consider a mixture of known particle species , for example pions ( @xmath5 ) , kaons ( _ k _ ) , protons ( _ p _ ) , and electrons ( _ e _ ) , and assume that the _ pid _ information is provided by the @xmath4 measurement in a drift chamber . using the separating power provided by the _",
    "pid _ , we want to estimate the unknown fractions @xmath6 , @xmath7 , @xmath8 , and @xmath9 of each particle type contained in the sample by means of a ml fit .",
    "our observables are the measured @xmath4 response ( that we will indicate as _ x _ ) and the momentum of the particle _ p_. we then label as @xmath10 the particle hypothesis and the conditional probability density function of @xmath11 for track @xmath12 , given @xmath13 and @xmath10 , will be indicated as @xmath14 .",
    "+ finally , the likelihood function is expressed as : @xmath15 where @xmath12 is the track index , with the additional condition : @xmath16 in practice , we often have poor information on the distributions of the additional observables ( @xmath17 in our example )",
    ". sometimes they are completely unknown .",
    "this is the case , for example , of particles produced during the hadronization of @xmath18 mesons mesons hadronization , that represents a major issue in the development of flavor tagging algorithms like the same side kaon tagging @xcite . ] : the momentum distribution of each particle type is unknown and the correct likelihood function as defined in ( [ eq : likeright ] ) can not be constructed .",
    "+ note that using the conditional likelihood function : @xmath19 may lead to strongly biased results , if our additional variable , the momentum in our example , has different distributions for different particle types since the @xmath17 term can not be factorized in ( [ eq : likeright ] ) . as discussed in @xcite and shown in @xcite specifically for the particle species estimation , whenever the templates used in a multi - component fit depend on additional observables , it is necessary to use the complete likelihood expression , and explicitly include the probability distributions of all observables . in our example",
    "this implies that we need to include the momentum distributions of each particle type in the likelihood .",
    "the crucial question is how to avoid strong bias in the particle fraction estimation when the momentum distributions of each particle type are unknown . + in @xcite",
    "it was shown that a possible solution to this problem is to use a series expansion of the unknown distributions ; the fourier coefficients of the series are free parameters determined by the fit .",
    "+ in this paper we propose a different strategy , based on the idea that if the fit is performed in sufficiently small momentum intervals , the bias due to the use of the likelihood function ( [ eq : likewrong ] ) is small and it goes to zero as the momentum interval width decreases . in sec .  [ sec : likelihood ] we present a simple procedure to perform the fit and show that we can extract the unknown momentum distributions of each particle type in a completely data driven mode without any _ a priori _ assumption on the corresponding functional forms .",
    "+ in sec .",
    "[ sec : other ] , given the results of our fitting procedure , we describe a powerful technique to extract the distribution of any kinematical variable for any particle type , with the proper normalization . finally , in sec .",
    "[ sec : pythiamc ] some applications of the method to pythia  @xcite monte carlo samples simulated with the cdf detector  @xcite are shown .",
    "as anticipated above , we restrict ourselves to the particles contained in small momentum intervals of equal width @xmath20 . in each bin",
    "we estimate the particle content using a ml fit by observing that if @xmath21 is sufficiently small , the bias introduced by using the conditional likelihood of ( [ eq : likewrong ] ) is negligible .",
    "as will be evident in the following , we find more convenient to use an extended likelihood ( el ) fit ( see @xcite for a definition ) . in each momentum bin",
    "@xmath22 the extended likelihood function takes the form : @xmath23 where @xmath24 is the total number of particles in the @xmath22-th momentum bin , @xmath25 is the number of different particle species , @xmath26 is the number of particles of type @xmath27 , @xmath11 is the _ pid _ response for the @xmath22-th momentum bin and @xmath28 is the conditional probability density function associated to @xmath29 for the particle type @xmath10 in the @xmath22-th momentum bin . in the rest of the paper we will simplify the notation by setting @xmath30 .",
    "the el must be maximized with respect to the free parameters @xmath26 .",
    "+ we notice that , given its particular form , the first derivative of our el function can be evaluated analytically as : @xmath31 the critical points of ( [ eq : likelihoodform ] ) can be obtained using an iterative algorithm . in particular , starting from a first guess on our parameters , @xmath32 , we can define an iterative procedure , a _",
    "picard iteration _",
    "@xcite , of the form : @xmath33 where at every step @xmath34 of the iteration , we estimate the @xmath35 that will be used as input values for the step @xmath36 .",
    "the iteration converges to the roots of ( [ eq : derive ] ) .",
    "similarly , we can write the analytical expression of the second derivative of ( [ eq : likelihoodform ] ) and estimate the statistical error of our parameters from the inverse of the covariance matrix @xmath37 of the fit in the @xmath22-th momentum bin as : @xmath38 our iterative procedure is equivalent to the _ channel likelihood _ method introduced in  @xcite .",
    "it can be easily shown that the channel likelihood method is a maximization of an el function of the form ( [ eq : likelihoodform ] ) using an iterative scheme similar to the one we propose . +",
    "this approach has several advantages : no functional shape is assumed for the momentum spectra , the method , provided the @xmath39 templates , is completely data driven ; all the fits can be performed in parallel , that is the iteration can be done in all momentum bins at the same time ; the algorithm is very fast and stable respect to the initial guess on the @xmath26 .",
    "+ once we obtain convergence of the iterative process , we can write the fraction of each particle type as : @xmath40 observing that each bin content is fitted independently , the corresponding statistical uncertainty is : @xmath41 finally , since we are performing the fit in each momentum bin , the arrays of @xmath26 can be interpreted as _ histograms _ ,",
    "that reasonably approximate the true momentum distributions of each particle type . in this way , we obtained an unbiased estimation of the particle composition , although the @xmath42 were unknown , and , at the same time , a reasonable estimation of the @xmath43 themselves .",
    "+        we test our method on parametric monte carlo samples .",
    "each sample consists of 20,000 particles .",
    "different momentum spectra are used to generate each particle type and the corresponding fractions are fixed at : @xmath44 , @xmath45 , @xmath46 , and @xmath47 .",
    "we divide the sample in 50 momentum bins from 0.45 gev/@xmath48 up to 5 gev/@xmath48 and a el fit is performed in each momentum bin .",
    "if no particle falls in a given bin , the corresponding fit is not performed for obvious reasons .",
    "we repeat the fit on 500 parametric samples to extract the residual distributions of the estimators .",
    "no significant bias is observed as summarized in tab .",
    "[ tab : toy2 ] . +",
    "another interesting test is the residual distribution of the estimators in each momentum bin for the 500 samples .",
    "[ fig : resbin ] shows the residuals of the four estimators as a function of the bin number ( i.e. momentum ) . in each plot , each point represents the mean value , while the error bar represents the width of the distribution of the residual .",
    "we observe no significant bias .",
    "examples of the unknown momentum distributions obtained from the fit are shown in fig .",
    "[ fig : pt ] . + a very good agreement between the true distributions ( filled histograms ) and the fit ( dots ) is observed for all particle types .",
    ".mean values of the residuals of the particle fractions ( integrated on all momentum bins ) estimated in 500 parametric samples .",
    "[ tab : toy2 ] [ cols=\"^,^,^,^,^\",options=\"header \" , ]      distributions ( filled histograms ) and the result from the fit ( dots ) .",
    "[ fig : pt],width=480 ]     distributions overlaid to the corresponding data _",
    "splot_. [ fig : eta],width=480 ]     distributions overlaid to the corresponding data _",
    "splot_. [ fig : deltar],width=480 ]     distributions overlaid to the corresponding data _ splot_. [ fig : plrel],width=480 ]",
    "we have presented a method to estimate the distributions of kinematical variables of different particle species using information from _ pid _ detectors .",
    "this method is shown to work very well on monte carlo data allowing the determination of the fractional composition of a mixed sample of particle types with remarkable precision .",
    "we use a likelihood function that correctly contains the @xmath49 s of all the relevant event observables and therefore avoids a common mistake leading to strongly biased estimations .",
    "this approach looks very promising for the determination of distributions of different types of particles produced , for example , in conjunction with a @xmath18 meson in a completely data - driven mode , without making any prior assumption on their functional forms .",
    "we would like to thank the cdf collaboration for providing the monte carlo samples used in this paper and for the very useful discussions and suggestions .",
    "00 cdf collaboration , phys .",
    "97 ( 2006 ) 242003 .",
    "g.  punzi , comments on likelihood fits with variable resolution , phystat03 , stanford , california , usa , 2003 ( arxiv : physics/0401045 ) .",
    "p.  catastini and g.  punzi , bias - free estimation in multicomponent maximum likelihood fits with component - dependent templates , phystat05 , oxford , united kingdom , 2005 ( arxiv : physics/0605130 ) .",
    "t.  sjstrand _ et al .",
    "_ , computer phys",
    ". commun . 135",
    "( 2001 ) 238 .",
    "we use version 6.216 .",
    "cdf collaboration , phys .",
    "d 71 ( 2005 ) 032001 ; cdf collaboration , the cdf - ii techincal design report , fermilab - pub-96 - 390-e , 1996 .",
    "g.  cowan , statistical data analysis , oxford university press , oxford , 1998 .",
    "ortega and w.c .",
    "rheinboldt , iterative solution of nonlinear equations in several variables , siam publications , philadelphia , 2000 .",
    "p.e .  condon and p.l .",
    "cowell , phys .",
    "d 9 ( 1974 ) 2558 . m.  pivk and f.r .",
    "le diberder , nucl .",
    "instrum.meth .",
    "a 555 ( 2005 ) 356 ( arxiv : physics/0402083 ) ."
  ],
  "abstract_text": [
    "<S> we describe a statistical method to avoid biased estimation of the content of different particle species . </S>",
    "<S> we consider the case when the particle identification information strongly depends on some kinematical variables , whose distributions are unknown and different for each particles species . we show that the proposed procedure provides properly normalized and completely data - driven estimation of the unknown distributions without any a priori assumption on their functional form . </S>",
    "<S> moreover , we demonstrate that the method can be generalized to any kinematical distribution of the particles .     </S>",
    "<S> * a statistical prescription to estimate properly normalized distributions of different particle species *    m.  casarsa@xmath0 p.  catastini@xmath1 g.  punzi@xmath2 l.  ristori@xmath3    _ _ + _ _ + _ _ + _ _ </S>"
  ]
}