{
  "article_text": [
    "image analysis is a fundamental task in observational astronomy . for instance , new techniques , such as weak gravitational lensing ( see reviews by mellier 1999 ; bartelmann & schneider 2000 ) , microlensing ( mao 1999 ) and the search for supernovae ( riess 2000 ; perlmutter et al .",
    "1998 ) , have great scientific promise , but require high precision image processing and analysis . as a result ,",
    "a number of sophisticated data analysis packages ( eg .",
    "focas in iraf , jarvis & tyson 1986 ; sextractor , bertin & arnouts 1996 , etc ) and techniques ( eg . wavelet analysis , see review by stark , murtagh & bijaoui 1998 ; image subtraction , alard & lupton 1998 ; shear measurement , kaiser , squires & broadhurst 1995 , kaiser 2000 , and kuijken 2000 ) have been developed .    in this paper",
    ", we present a new method for image analysis .",
    "it is based on the linear decomposition of each object into a series of localised basis functions with different shapes , which we call ` shapelets ' . as a basis",
    "set we choose weighted hermite polynomials .",
    "they correspond to perturbations about a circular gaussian , and , in their asymptotic form , to the edgeworth expansion in several dimensions .",
    "they are also the eigenstates of the 2-dimensional quantum harmonic oscillator ( qho ) , and thus allow us to use the powerful formalism developed for this problem .",
    "they have remarkable properties .",
    "in particular , they are ( up to a rescaling ) invariant under fourier transforms and thus yield a simple analytical form for convolutions .",
    "we derive a number of practical tools which can use used to compute the characteristics of the object ( centroid , flux , radius , etc ) from its shapelet coefficients .",
    "our method differs from the wavelet transform which decomposes the image into a sum of basis functions of different scales but with a set shape . in our method",
    ", the image is decomposed into a collection of compact disjoint objects of arbitrary shapes and is thus particularly adapted to astronomical images .    as an example , we show how images of galaxies observed with the hubble space telescope ( hst ) can be represented and strongly compressed using shapelets .",
    "we also discuss several applications of shapelets , such as archival of large photometric catalogues , gravitational lensing and image de - projection .",
    "a precise method to measure the shear induced by weak lensing on galaxy images is presented in an adjoining paper ( refregier & bacon 2001 , paper ii ) .",
    "the application of shapelets to interferometric images will be presented in chang & refregier ( 2001 ) .",
    "the analytical results derived in this paper may also be useful for any application using the edgeworth expansion , such as , for instance , the study of the growth of cosmological perturbations ( juskiewicz et al .",
    "1995 and reference therein ) .",
    "this paper is organised as follows . in  [ one_d ]",
    ", we describe the main properties of 1-dimensional shapelets and discuss their connection to the qho . in  [ two_d_cartesian ] , we show how 2-dimensional shapelets can be formed and derive a number of practical analytical results . in ",
    "[ convolution ] , we discuss how the shapelet states behave under convolutions . in ",
    "[ two_d_polar ] , we derive polar shapelets from the cartesian basis functions and describe some of their properties . in  [ applications ] , we discuss several direct applications of shapelets .",
    "our conclusions are presented in  [ conclusion ] .",
    "we first consider the description of a localised object in 1-dimension . for this purpose ,",
    "we first define the dimensionless basis functions @xmath0^{-\\frac{1}{2 } } h_{n}(x ) e^{-\\frac{x^2}{2}}\\ ] ] where @xmath1 is a non - negative integer and @xmath2 is a hermite polynomial of order @xmath1 .",
    "these functions are orthonormal in the sense that @xmath3 where @xmath4 is the kronecker delta symbol .",
    "the first few functions are plotted on figure  [ fig : hermite ] .",
    "these functions , which we call ` shapelets ' , can be thought of as shape perturbations around the gaussian @xmath5 ,    to describe an object in practice , we use the dimensional basis functions @xmath6 where @xmath7 is a characteristic scale , which is typically chosen to be close to the size of the object .",
    "these functions are also orthonormal , i.e. @xmath8    this infinite set of functions forms a complete basis for smooth and integrable functions .",
    "thus , a ( sufficiently well behaved ) object profile @xmath9 can be expanded as @xmath10 from the orthonormality condition ( eq .  [ [ eq : orthonorm ] ] ) , the shapelet coefficients are given by @xmath11 in practice , the series of equation  ( [ eq : decompose ] ) will converge quickly if the object @xmath9 is sufficiently localised , and if @xmath7 and the origin @xmath12 are not too different from the size and location of the object . this series representation is referred to as the gram - charlier series , or , in its asymptotic form , as the edgeworth expansion ( see eg .",
    "juiszkiewicz 1995 and reference therein ) .",
    "these basis functions have a number of useful properties .",
    "let us first consider their fourier transform , which , for an arbitrary function @xmath9 , is defined as @xmath13 with these conventions , the fourier transform of the dimensionless basis function @xmath14 is @xmath15 thus , up to a phase factor , the dimensionless basis functions are invariant under fourier transforms .",
    "this very useful property can be understood in physical terms from the analogy with the quantum harmonic oscillator ( see  [ qho ] ) .",
    "the fourier transform of the dimensional basis function @xmath16 is given by @xmath17 thus , the fourier transform acts on the basis functions with an unsurprising change of scale @xmath18 .      as we now discuss , the above basis functions are the eigenstates of the quantum harmonic oscillator ( qho ) , which allows us to exploit the readily available formalism developed for this problem .",
    "let us consider a qho with mass @xmath19 and natural frequency @xmath20 .",
    "if distances are measured in units of @xmath21 and energies in units of @xmath22 , the hamiltonian for this system is @xmath23\\ ] ] where @xmath24 and @xmath25 are the position and momentum operators respectively . in the @xmath26-representation , they are given by @xmath27 and commute as @xmath28 = i$ ] .",
    "as is well known , the basis functions @xmath29 are the eigenfunctions of the hamiltonian , with @xmath30 clearly , @xmath31 is symmetric under a permutation of @xmath24 and @xmath25 ( see eq .",
    "[ [ eq : qho_hamiltonian ] ] ) , thus explaining the invariance of @xmath32 under fourier transforms ( eq .  [ [ eq : phi_tilde ] ] ) .    of particular practical interest",
    "are the lowering and raising operators , which are defined as @xmath33 where @xmath34 is the hermitian conjugate .",
    "they commute as @xmath35 = 1 $ ] , and act on the basis functions as @xmath36 the hamiltonian can then be rewritten as @xmath37 , where the number operator @xmath38 has the property that @xmath39 when convenient , we will use the bra - ket notation of quantum mechanics .",
    "for instance , the @xmath40 state is written as @xmath41 and has an @xmath26-representation given by @xmath42 .",
    "the dimensional basis functions are the eigenfunctions of the hamiltonian @xmath43.\\ ] ] the eigenstates are labeled as @xmath44 and obey @xmath45 .",
    "the hermite basis functions have a number of further convenient properties which we will need later and summarise here .",
    "we first notice , by inspecting figure  [ fig : hermite ] , that the basis functions @xmath46 acquire both a larger extent and smaller scale oscillations when the order @xmath1 is increased , keeping @xmath7 constant .",
    "this can be described more precisely by considering the characteristic radius @xmath47 of a basis function , defined by @xmath48 . as is well known from quantum mechanics and can easily derived using equation  ( [ eq : a_adagger ] ) , this rms radius is given by @xmath49 .",
    "similarly , the characteristic size @xmath50 of the small scale ( oscillatory ) features in a basis function of order @xmath1 is defined as the rms inverse radius in fourier space , i.e. by @xmath51 . as can again be verified using raising and lower operators , the radius is given by @xmath52 .",
    "thus a decomposition which includes modes from @xmath53 to @xmath54 can represent features with scales ranging between the two limits @xmath55 and @xmath56 . in ",
    "[ astrometry ] below , we show how these scales can be used to fine a good choice of @xmath7 for an object .",
    "[ th_min_max_1d ] .",
    "another important property relates to the rescaling of a shapelet function .",
    "let us for instance consider a function @xmath57 , which has been decomposed into shapelets of scale @xmath7 .",
    "it can be sometimes convenient to express it in terms of basis functions with a different scale @xmath58 , as @xmath59 .",
    "the relation between the coefficients @xmath60 and @xmath61 is derived in appendix  [ rescaling ] and involves the overlap matrix @xmath62 , whose analytic form is given by equation  ( [ eq : beta1_beta2 ] ) .",
    "finally , we note that the basis functions obey the integral property @xmath63^{\\frac{1}{2 } } \\left ( \\begin{array}{c }",
    "n \\\\ n/2 \\end{array } \\right)^{\\frac{1}{2}},\\ ] ] for @xmath1 even ( the integral vanishes otherwise ) , where the parenthesis denotes the binomial coefficient and a convenient shorthand notation was used on the left - hand side .",
    "this can be derived using the generating function of hermite polynomials ( eg . arfken 1985 ) .",
    "in this section , we construct 2-dimensional shapelets by taking products of the 1-dimensional shapelets described above .",
    "we then study the properties of the resulting ` cartesian ' basis functions , and derive a number of analytical results which are useful in practice .",
    "basis functions for 2-dimensional objects can be constructed by taking the tensor product of two 1-dimensional basis functions .",
    "we thus define the dimensionless functions @xmath64 where @xmath65 and @xmath66 .",
    "dimensional basis functions are defined as . @xmath67",
    "these 2-dimensional shapelets are again orthonormal , in the sense that @xmath68 the functions @xmath69 are eigenstates of the 2-dimensional qho whose hamiltonian is @xmath70,\\ ] ] where @xmath71 and @xmath72 are the position and momentum operators for each dimension .",
    "the first few 2-dimensional shapelets are shown on figure  [ fig : phi ] .",
    "again , they can be thought of as perturbations around the 2-dimensional gaussian @xmath73 .",
    "these basis functions form a complete orthonormal basis for smooth , integrable functions of two variables . a ( well behaved ) 2-dimensional function @xmath74 , such as the image of an object ,",
    "can thus be decomposed as @xmath75 where the shapelet coefficients are given by @xmath76 figure  [ fig : hst ] show how an image observed with hst can be decomposed and reconstructed using shapelets .",
    "the resulting distribution of the coefficients is shown on figure  [ fig : hst_coef ] .",
    "more examples can be found on figure  [ fig : compress ] .",
    "these examples and associated applications will be discussed in detail in  [ applications ] .    of practical interest ,",
    "is the choice of an appropriate shapelet scale @xmath7 and maximum order @xmath54 for the faithful and efficient decomposition of a given image . using arguments similar to those of ",
    "[ th_min_max_1d ] , it is easy to show that a decomposition in 2-dimensions which include shapelets of scale @xmath7 with order ranging from @xmath77 to @xmath54 can only describe features with scales between the two limits @xmath78 thus , if the function has features with scales ranging from @xmath79 ( eg . the size of the object or that of the image ) and @xmath80 ( eg . the pixel size , or the size of a smoothing kernel ) , a good choice of @xmath7 and @xmath54 will be @xmath81 in practice , this provides a good first guess , which can be refined using a few iterations ( see  [ astrometry ] ) .",
    "[ th_min_max ]      the most basic quantities to measure for an object image are its total flux ( photometry ) , centroid position ( astrometry ) and size .",
    "let us first decompose the intensity @xmath82 of the object into shapelet coefficients @xmath83 as in equation  ( [ eq : decompose_2d ] ) .    using the integral property of equation  ( [ eq:1n ] ) , it is then easy to show that the total flux @xmath84 of the object is @xmath85 where the sum is over even values of @xmath86 and @xmath87 .",
    "using equations  ( [ eq:1n ] ) and ( [ eq : a_adagger ] ) , one can also show that the centroid of the object @xmath88 is given by @xmath89 and similarly for @xmath90 .",
    "similarly , the rms radius @xmath91 defined by @xmath92 is given by @xmath93 these expressions can be used , by iteration , to find the optimal centre and scale of the basis functions .",
    "let us consider a general coordinate transformation of the form @xmath94 , where @xmath95 is a @xmath96 matrix , @xmath97 is a small displacement .",
    "such a transformation can arise for instance from a translation , rotation or from the action of gravitational lensing .",
    "we assume that the transformation matrix @xmath95 and the displacement @xmath98 are small and constant across the object .",
    "we parametrise the matrix @xmath95 following the gravitational lensing conventions as @xmath99 where @xmath100 describes rotations and the convergence @xmath101 describes overall dilatations and contractions .",
    "the shear @xmath102 ( @xmath103 ) describes stretches and compressions along ( at @xmath104 from ) the x - axis .",
    "the displacements @xmath105 and @xmath106 correspond to translations along the @xmath26 and @xmath107-axis , respectively .    under this transformation ,",
    "the intensity @xmath82 of an object becomes @xmath108 since we are now considering infinitesimal transformations , we can taylor expand this expression and only keep the terms which are first order in @xmath109 . after using equations  ( [ eq : xp ] ) and ( [ eq : a_adagger ] ) , we find @xmath110 where @xmath111 , @xmath112 , @xmath113 and @xmath114 are the operators generating rotation , convergence , shears and translations , respectively , and where we have used the einstein summation convention .",
    "the generators are given by @xmath115 the rotation generator @xmath111 is thus simply equal to the angular momentum operator in 2-dimensions @xmath116 up to a factor of @xmath117 .",
    "similarly , the translation generator @xmath114 is simply equal to the the linear momentum operator @xmath118 , up to the same factor .",
    "these expressions along with equation  ( [ eq : a_action ] ) make it easy to compute the effect of these transformations on the basis functions @xmath119 . for instance",
    ", the generator of translations along the @xmath26-axis has a matrix representation @xmath120 given by @xmath121 \\delta_{m_2,n_2},\\ ] ] and similarly for the other generators .",
    "the meaning of the generators can be seen by studying their action on the ground state .",
    "for instance , it is easy to see that under the action of a shear @xmath102 , the ground state @xmath122 becomes @xmath123.\\ ] ] the action of the different transformations on the ground states can be calculated in the same way and are shown in figure  [ fig : gen ] .",
    "clearly , their action is as expected from their definition .",
    "since the ground state is circularly symmetric , the rotation operator vanishes when applied to @xmath122 , i.e. @xmath124 .",
    "more instructively , we can consider the effect of @xmath111 on an asymmetric state like @xmath125 . it is also shown in the bottom row of the figure .",
    "as expected the state @xmath125 is rotated counter - clockwise by the rotation operator .",
    "finite transformations can be produced by exponentiating the generators .",
    "for instance , after a finite rotation by an angle @xmath100 the function @xmath126 becomes @xmath127 and similarly for the shear and convergence .      in this section",
    ", we study the uncertainty induced by noise on the basis function decomposition , in the case of correlated and uncorrelated background noise , and of poisson noise . the observed intensity of an object is @xmath128 where @xmath82 is the intrinsic intensity of the object and @xmath129 is the noise .",
    "the noise is taken to be unbiased , so that @xmath130 and is characterised by its correlation function @xmath131 . here",
    "the brackets refer to an ensemble average over noise realisations .",
    "the observed basis coefficients are then @xmath132 and are unbiased , i.e. @xmath133 where @xmath134 are the intrinsic coefficients .",
    "it is then easy to show that the covariance matrix @xmath135 \\equiv \\langle ( f'_{{\\mathbf k } } - \\langle f'_{{\\mathbf k } } \\rangle ) ( f'_{{\\mathbf l } } - \\langle f'_{{\\mathbf l } } \\rangle ) \\rangle$ ] for the observed coefficients is given by @xmath136 =     \\int d^{2}x \\int d^{2}x ' ~b_{k}({\\mathbf x},\\beta )     \\eta({\\mathbf x},{\\mathbf x } ' ) b_{l}({\\mathbf x},\\beta).\\ ] ]    to be more specific , we first consider the case of homogeneous background noise , as can be produced by sky or instrumental backgrounds .",
    "if the background noise is uncorrelated , @xmath137 , where @xmath138 is the _ rms _ noise . as a result , the covariance matrix reduces to @xmath139 = \\sigma_{n}^{2 } \\delta_{lk},\\ ] ] where we have used the orthonormality of the basis functions ( eq .  [ [ eq : orthonorm ] ] ) . in this case , the covariance matrix is thus diagonal , so that each coefficient is statistically independent .",
    "moreover , the diagonal elements are all equal . uncorrelated noise thus populates each coefficient equally , and is thus `` white '' as in the case of fourier transforms .    in the case of spatially",
    "correlated but homogeneous noise , the noise correlation function is only a function of separation and can thus be written as @xmath140 . as a result ,",
    "equation  ( [ eq : cov_general ] ) reduces to the integral of a convolution and can thus be written symbolically as @xmath139 =   \\langle { \\mathbf k } , \\beta | \\eta * ( { \\mathbf l } , \\beta ) \\rangle,\\ ] ] in the notation of equation  ( [ eq : cnml_notation ] ) . a convenient way to evaluate this is to decompose @xmath141 itself into basis functions and then to use the results of  [ convolution ] below .",
    "spatial correlations in the noise thus produces correlations in the coefficients .",
    "another case of practical interest is that in which the noise is dominated by poisson shot noise . if the intensities are measured in units of photon counts , the noise correlation function is then @xmath142 . as a result ,",
    "the covariance matrix is @xmath139 =   \\sum_{{\\mathbf m } } f_{{\\mathbf m } }    b^{(3)}_{{\\mathbf k},{\\mathbf l},{\\mathbf m}},\\ ] ] where @xmath143 is the 3-product integral defined in equation  ( [ eq : b3 ] ) below , and which is evaluated analytically in paper ii . in this case again , the covariance coefficient is made non - diagonal by the noise correlation , but is easily calculable analytically .",
    "we now show how shapelets behave under convolutions , an operation which often occurs in practice ( eg . under the action of psf , seeing , smoothing , etc ) .",
    "we start by considering convolution by a general kernel in 1-dimensions , and then study the special case of smoothing by a gaussian .",
    "finally , we treat the 2-dimensional case , and illustrate the results with the example of an hst galaxy image .",
    "let us first consider the convolution of two arbitrary 1-dimensional functions @xmath9 and @xmath144 .",
    "their convolution @xmath145 can be written as @xmath146 each function can be decomposed into our basis functions with scales @xmath147 , @xmath7 and @xmath148 .",
    "these scales are chosen to be most convenient in each case .",
    "the coefficients are then @xmath149 , @xmath150 , @xmath151 .",
    "our aim is to find an expression which relates @xmath152 to @xmath60 and @xmath153 .",
    "since convolution is a bi - linear operation , this relation will be of the form @xmath154 where the convolution tensor can be written symbolically as @xmath155 and is a function of the scale lengths . using the properties of the basis functions under fourier transforms ( eq .  [ [ eq : b_tilde ] ] ) ,",
    "it is easy to show that the convolution tensor is given by @xmath156 where the 3-product integral is @xmath157 is defined as @xmath158 as we show in paper ii , this integral can be easily evaluated analytically with a recurrence relation .",
    "the special case consisting of smoothing by a gaussian is useful in practice . in this case",
    ", we let @xmath159 which is normalised so that @xmath160 .",
    "we can then write the coefficients for the smoothed function @xmath145 as @xmath161 where @xmath162 is the smoothing matrix .",
    "the gaussian @xmath144 can be thought as a ( non - normalised ) @xmath53 shapelet state of amplitude @xmath163 , so that @xmath164 .",
    "using the generating function for hermite polynomials , one can show that , for the natural choice of @xmath165 , the smoothing matrix is given by @xmath166 for @xmath167 and even ( @xmath168 vanishes otherwise ) , and where @xmath169 .",
    "figure  [ fig : smooth ] shows how this analytic formula can be used to efficiently smooth a 2-dimensional image ( see discussion in  [ convolution_2d ] below ) .",
    "an intuitive feeling for the effect of convolution on the shapelet coefficients can be obtained from figure  [ fig : gmatrix ] , which graphically shows the smoothing matrix @xmath170 for different values of the smoothing scale @xmath7 . as expected , the smoothing matrix approaches the identity matrix in the limit of vanishing smoothing scale ( @xmath171 ) . on the other hand , for very large smoothing kernels ( @xmath172 )",
    "it reduces to a projection of all the input modes @xmath19 onto the @xmath53 output mode . for intermediate scales ,",
    "the smoothing matrix takes the form of a band which rotates from the vertical to the horizontal as the smoothing scale @xmath7 is increased .",
    "smoothing thus corresponds to a projection of the input modes into output modes of smaller order .",
    "the high - order modes indeed have oscillations on small scales and are thus gradually lost when we increase the smoothing scale @xmath7 .",
    "let us now consider the convolution of two 2-dimensional functions , such as @xmath173 we again first decompose each function into shapelet coefficients @xmath174 , @xmath175 , and @xmath176 with shapelet scales @xmath147 , @xmath7 and @xmath148 respectively , and where @xmath177 as before . because convolution is bilinear we can again relate the convolved to the unconvolved coefficients by @xmath178 where @xmath179 is the 2-dimensional convolution tensor . from the separability of the 2-dimensional basis functions ( see eq .",
    "[ [ eq : phi_n1n2 ] ) , it is easy to show that this tensor is equal to @xmath180 where the tensors appearing on the right - hand side are the 1-dimensional convolution tensor defined in equation  ( [ eq : c_nml ] ) .",
    "we can also consider the special case of smoothing with a 2-dimensional gaussian . in this case ,",
    "@xmath181 , which is normalised so that @xmath182 .",
    "the smoothed coefficients are then given by @xmath183 where @xmath184 is the 2-dimensional smoothing matrix .",
    "it is again easy to show that it is equal to @xmath185 in terms of the 1-dimensional smoothing matrix defined in  [ smoothing_1d ] . with the natural choice @xmath186",
    ", it can be evaluated using equation  ( [ eq : g_nm ] ) .",
    "figure  [ fig : smooth ] shows the how the galaxy image of figure  [ fig : hst ] can be smoothed using our shapelet method .",
    "the resulting image is indistinguishable from that derived using ordinary convolution in real - space ( also shown ) .",
    "the shapelet method is however computationally very efficient when the coefficient matrix is sparse as is the case here ( see figure  [ fig : hst_coef ] ) .",
    "the effect of smoothing on the shapelet coefficients of this galaxy can be seen in figure  [ fig : hst_coef_smooth ] .",
    "for clarity , the smoothing scale was enhanced to @xmath187 pixels . clearly ,",
    "convolution amounts to a projection onto the lower order states , as discussed in  [ smoothing_1d ] .",
    "the cartesian basis functions discussed above are separable in the cartesian coordinates @xmath188 and @xmath189 .",
    "it is also useful to construct basis functions which are separable in the polar coordinates @xmath26 and @xmath190 .",
    "these are eigenstates of the hamiltonian @xmath31 and of the angular momentum @xmath191 simultaneously , and thus have a number of convenient features . in this section ,",
    "we show how they can be constructed and study some of their properties .",
    "to construct the polar basis functions , we first define the left and right lowering operators as ( see eg .",
    "cohen - tannoudji et al .",
    "1977 ) @xmath192 the associated raising operators are @xmath193 and @xmath194 , respectively .",
    "the only non - vanishing commutators between these operators are @xmath195 = [ \\hat{a}_{r},\\hat{a}_{r}^{\\dagger}]=1.\\ ] ] the hamiltonian ( eq .  [ [ eq : hamiltonian_2d ] ] ) and angular momentum ( eq .  [ [ eq : l ] ] ) operators for the 2-dimensional qho can be then be written as @xmath196 where the left - handed and right - handed number operators are naturally defined as @xmath197 the operators @xmath193 , @xmath194 , @xmath198 , and @xmath199 can thus be thought of as creating and destroying left- and right - handed quanta .      since the operators @xmath200 and",
    "@xmath201 form a complete set of commuting observables , their eigenstates @xmath202 provide a complete basis for our function space .",
    "these states are defined @xmath203 , and similarly for @xmath200 , for @xmath204 @xmath205 non - negative integers .",
    "they can be constructed by applying the raising operators several times on the ground state @xmath206 , as @xmath207 from equation  ( [ eq : hl_lr ] ) , it is easy to see that @xmath208 we can therefore relabel these states in terms of their energy and angular momentum quantum numbers , @xmath209 and @xmath210 , as @xmath211 the angular momentum quantum number takes on the @xmath212 values given by @xmath213 .      using the @xmath26-representation of @xmath193 and @xmath194",
    ", one can show that the basis functions @xmath214 for the angular momentum states are given by @xmath215^{-\\frac{1}{2 } } h_{n_{l},n_{r}}(x ) e^{-x^{2}/2 } e^{i(n_{r}-n_{l})\\varphi},\\ ] ] where @xmath216 are polynomials , which we call ` polar hermite polynomials ' .",
    "they can be computed by noting that @xmath217 and by using the recursion relation @xmath218 the diagonal polynomials can be computed using @xmath219 the first few polar hermite polynomials are listed in table  [ tab : hpolar ] .",
    "they have a number of useful properties .",
    "in particular , they are symmetric , i.e. @xmath220 and their derivative obey @xmath221    dimensional polar basis functions can be constructed as @xmath222 it is easy to check that these are orthonormal , i.e. that @xmath223 @xmath224 the radial dependence @xmath225 of the first few polar shapelet functions is shown in figure  [ fig : polar ] .    .first few polar hermite polynomials [ cols= \" < \" , ]",
    "because the polar shapelet states are eigenstates of the angular momentum , they have simple rotational properties .",
    "indeed , under a finite rotation by an angle @xmath100 , the polar states transform as @xmath226 where we have used the exponentiation ( eq .",
    "[ [ eq : rot_finite ] ] ) of the rotation generator @xmath227 ( eq .  [ [ eq : generators ] ] ) to operate a finite rotation .",
    "in this basis , finite rotations thus corresponds only to a phase factor .",
    "it is therefore a simple matter to rotate an arbitrary function @xmath82 .",
    "first , we decompose it into polar shapelet coefficients @xmath228 , with an appropriate shapelet scale @xmath7 .",
    "the coefficients @xmath229 of the rotated function @xmath230 are then given simply by @xmath231    by contrast , operating a finite rotation in the cartesian basis requires an infinite number of applications of the @xmath111 operator ( see eq .",
    "[ [ eq : rot_finite ] ] ) and is thus impractical . on the other hand , convolutions do not have simple analytical expressions in the polar basis , as they do in the cartesian basis ( see  [ convolution ] and paper ii ) .",
    "the results of  [ pol_cart ] , can thus be conveniently used to convert from one basis to the other , depending on the operation to be performed .",
    "now that we have developed the main formalism for shapelets , we illustrate the method using images from the hubble space telescope ( hst ) .",
    "we also discuss several direct applications of shapelets .      as an example",
    ", we apply the shapelet decomposition method to images of galaxies found in the hubble deep field ( hdf ; williams et al .",
    "1996 ) , the deepest images observed with the hubble space telescope ( hst ) .",
    "figure  [ fig : hst ] shows the original @xmath232 image @xmath82 of one such galaxy ( upper - left hand panel ) . using equation  ( [ eq : decompose_2d ] )",
    ", we first compute the shapelet coefficients @xmath233 of the galaxy with a shapelet scale @xmath187 pixels .",
    "we then reconstruct the image using equation  ( [ eq : coefs_2d ] ) including coefficients up to a maximum order @xmath234 .",
    "the resulting reconstructed images are shown on the figure for different values of @xmath235 .",
    "as @xmath54 is increased , more small scale and large scale features are recovered , as expected from the properties of our basis functions ( see  [ th_min_max_1d ] ) . for @xmath236 ,",
    "the reconstructed image is almost indistinguishable from the original .",
    "figure  [ fig : hst_coef ] gives a graphical representation of the shapelet coefficient matrix @xmath237 for this image .",
    "this can be thought as the representation of the galaxy in ` shapelet space ' .",
    "as is apparent on the figure , the coefficient matrix is rather sparse .",
    "the fact that the odd coefficients are small results from the fact that the shapelet center was chosen to be close to the centroid of the galaxy .",
    "the coefficients are negligibly small beyond @xmath238 , thus explaining why we obtain a virtually full reconstruction with @xmath236 .",
    "because of the sparse nature of the coefficient matrix , we can hope to recover the image from only the first few largest coefficients .",
    "figure  [ fig : compress ] shows the reconstruction of the galaxy of figure  [ fig : hst ] and of two other hdf galaxies , by keeping only the @xmath239 coefficients with largest absolute value @xmath240 . as can be seen from the top two panels , the galaxy image can be faithfully recovered with the top @xmath241 coefficients , yielding a compression factor @xmath242 of 62 compared to the original image which contained @xmath243 pixels .",
    "( the bookeeping required to keep track of selected coefficients only requires 1 bit per coefficient , and thus results only in a small overhead relatively to this compression factor ) . for the other two galaxies shown in the middle and bottom rows , compression factors of about 40 - 90 are achieved .",
    "note that the galaxy in the bottom row has a simpler structure and thus affords more compression .",
    "we have seen above that the first few shapelet coefficients capture most of the structure of galaxy images and thus allow strong data compressions .",
    "this can be very useful for upcoming and future large galaxy surveys such as the sloan digital sky survey ( sdss ; gunn & weinberg 1995 ) , or that derived from the planned snap mission ( perlmutter et al .",
    "one can imagine storing the first few shapelet coefficients in the catalog , thus both saving storage and conveying compactly the shape information of each each galaxy .",
    "the flux , centroid , major and minor axes and position angle of each galaxy could then be computed from their shapelet coefficients directly ( as described in  [ astrometry ] ) , thus avoiding the need to consider several definitions of magnitudes . since galaxy shapes in different wavelengths",
    "are strongly correlated , the treatment of multi - colour data could be done efficiently by decomposing differences of the images in different pass - bands and again keeping the largest coefficients .",
    "the resulting catalogue could then also be useful for study of galaxy morphology and classification in shapelet space .",
    "several astronomical techniques ( eg . high - precision astrometry and photometry , microlensing , weak lensing , supernova searches , etc ) require correction for the point - spread function ( psf ) of the telescope across an image .",
    "for instance , alard & lupton ( 1998 ) have developed a technique to take the difference of two images convolved with a spatially varying psf .",
    "shapelets provide a convenient correction method for the psf : the psf shape can be measured at different positions in the field using bright stars and then decomposed into shapelet coefficients ; a 2-dimensional polynomial fit for each shapelet coefficient as a function of position can then be performed to derive a model of the psf shape at any point ( cf . alard & lupton 1998 and kaiser 2000 who used this approach with other sets of basis functions ) .",
    "the convolution matrix can then be inverted to compute the shapelet coefficients of objects prior to convolution . as discussed in ",
    "[ convolution ] , convolution amounts to a projection onto lower shapelet order . as a result",
    "only low order coefficients can be recovered .",
    "another approach consist of fitting the deconvolved shapelet coefficients convolved to the psf model to the data ( cf .",
    "kuijken 2000 ) .",
    "the analytical properties of shapelets under convolution ( see  [ convolution ] and paper ii ) greatly facilitate and clarify the procedure .",
    "a detailed study of deconvolution using shapelets will be presented in paper ii .",
    "gravitational lensing is a powerful method to directly probe the mass of astrophysical objects .",
    "in particular , the weak coherent distortions induced by lensing on the images of background galaxies provide a direct measure of the distribution of mass in the universe .",
    "this weak lensing method is now routinely used to study galaxy clusters , and has recently been detected in the field ( see reviews by mellier 1999 ; bartelmann & schneider ; mellier et al .",
    "2000 ) . because the lensing effect is only of a few percent on large scales , a precise method for measuring the shear is required .",
    "the original methods of bonnet & mellier ( 1995 ) and of kaiser , squires & broadhurst ( ksb ; 1995 ) are not sufficiently accurate and stable for the upcoming weak lensing surveys .",
    "thus , several new methods have been proposed ( kuijken 1999 ; rhodes , refregier & groth 2000 ; kaiser 2000 ) . as we briefly describe below",
    ", the remarkable properties of our basis functions , make shapelets particularly well suited for providing the basis of a new method .",
    "let us consider a galaxy with an unlensed intensity @xmath82 .",
    "we have shown in  [ transformations ] that under the action of a weak shear @xmath244 , the lensed intensity is @xmath245 after decomposing these intensities into our basis functions @xmath246 ( eq .",
    "[ [ eq : decompose_2d ] ] ) , this becomes a relation between the lensed and the unlensed coefficients given by @xmath247 where @xmath248 is the shear generator matrix given in equation ( [ eq : generators ] ) .",
    "the goal for weak lensing is to estimate the shear from the shapes of an ensemble of galaxies which are assumed to be randomly oriented prior to lensing . in the widely used ksb method , this is done by considering the effect of lensing on the gaussian - weighted quadrupole moments of the galaxy images .",
    "these are exactly equal to the @xmath249 coefficients in our shapelet decomposition . in as sense",
    ", our method thus generalises this approach and capture all the available shape information of galaxies . because the shear matrix is simple in our cartesian basis , we can then construct an estimator for the shear by comparing the distribution of the lensed shapelet coefficients @xmath250 to that of a training set @xmath233 for which lensing is known to be negligible .",
    "this can be done either by constructing a linear shear estimator from the observed coefficients or by using a maximum likelihood technique . in paper ii , we follow the first approach and show that shapelets can be used to derive precise shear recovery in realistic simulations of deep optical images ( see bacon et al . 2001 ) .",
    "as luppino & kaiser ( 1997 ) discussed , the shear acts , in practice , after the smearing produced by the psf . to account for this , we can first model the psf across the field , as described in  [ psf_modeling ] .",
    "then one of the methods mentioned in this section can be used to derive the deconvolved coefficients from the observed convolved ones .",
    "again , a detailed study of this deconvolution method and its impact in weak lensing measurement will be presented in paper ii .",
    "shapelets can also be used for strong lensing applications , such as the modeling of cluster or galaxy potentials using multiple images and giant arcs . in  [ transformations ] , we concentrated mainly on first order distortions , but also mentioned that distortions of arbitrary amplitudes can be derived by exponentiating the shear and convergence operators ( see eq .",
    "[ [ eq : rot_finite ] ] ) .",
    "an equivalent method to compute the effect of large distortions on the shapelet coefficients is to use the analytical expression for rescaling of appendix  [ rescaling ] .",
    "one can then model the shape of the lensed object using shapelets and explore a large class of lens models efficiently by computing the lensed image coefficients analytically .",
    "another possibility is to also model the gravitational potential of the lens using shapelets .",
    "another important problem in astronomy is that of deprojection .",
    "for instance , the 2-dimensional images of galaxies and clusters of galaxies observed on the sky are projections of their 3-dimensional distributions .",
    "one can hope to reconstruct the 3-dimensional distribution of these systems by combining observations at different wavelengths . these indeed probe different physical processes , and therefore correspond to different weighting along the line of sight . here , we show how shapelets can be used to solve this problem .    to",
    "so so , we consider the simple , yet practical example of a cluster of galaxies observed both through its x - ray emission ( see eg .",
    "sarazin 1988 for a review ) and sunyaev - zeldovich ( sz ) effect ( sunyaev & zeldovich 1972 ; see birkinshaw 1999 , for a review ) .",
    "cluster deprojection is a long standing problem in astrophysics , and has been studied by several groups ( see the recent solution by dor et al .",
    "2001 , and references therein ) . here",
    ", we assume , for simplicity , that the cluster gas is isothermal . the x - ray emissivity of the cluster can then be written as ( eg . sarazin 1988 ) @xmath251 where @xmath100 is the 3-dimensional electron density of the gas , @xmath252 is the line - of - sight coordinate , and @xmath253 is a constant which depends on the wavelength of observation , the gas temperature , and the distance to the cluster .",
    "the comptonisation parameter @xmath254 from the sz effect can be observed as temperature anisotropies of the cosmic microwave background ( see review by birkinshaw 1999 ) .",
    "it is proportional to the electron pressure integrated along the line of sight , and thus be written , for an isothermal cluster as @xmath255 where @xmath256 is a constant which again depends on the wavelength of observation , the gas temperature , and distance to the cluster .",
    "our goal is to reconstruct the three - dimensional gas density @xmath257 from measurements of @xmath258 and @xmath254 .    for this purpose ,",
    "let us decompose these two observed images into 2-dimensional shapelets as @xmath259 ,  and  @xmath260 .",
    "we choose the same shapelet scale @xmath7 for @xmath261 , @xmath262 and @xmath100 and thus drop it to simplify the notation . in analogy with the discussion in  [ 2d_cartesian_def ] , we can also define 3-dimensional basis functions @xmath263 as products of three 1-dimensional shapelets .",
    "this allows us to decompose the 3-dimensional gas density distribution as @xmath264 using the properties of the shapelet basis functions , it is then easy to show that the shapelet coefficients for the x - ray emissivity can be written as @xmath265 where @xmath266 is the ubiquitous 3-product integral defined in equation  ( [ eq : b3 ] ) , and @xmath267 in this context .",
    "similarly , the coefficients for the comptonisation parameter can be written as @xmath268 where @xmath269 is the integral defined in equation  ( [ eq:1n ] ) .",
    "the direct approach , which consists in solving these two equations of the desired coefficients @xmath270 , is probably difficult in practice .",
    "a more convenient approach is to derive an estimate for @xmath270 by @xmath271-fitting these coefficients to the observables @xmath272 and @xmath273 taking into account the noise in each measurement .",
    "the @xmath271 procedure also produces the covariance matrix for the coefficients @xmath270 , and thus allows us to study any degeneracy present in the deprojection .",
    "this is greatly facilitated in practice by the analytic forms for @xmath274 ( eq .  [ [ eq:1n ] ] ) and for @xmath266 ( see paper ii ) , and the fact that the fitted model is linear in its output parameters @xmath270 .    note that our method is fully general and does not assume that the cluster distribution has any specific form .",
    "in particular , it could be particularly useful if the sz observations are performed with an interferometer as is the case for recent measurements ( see carlstrom et al . 1999 , and reference therein ) .",
    "in this case , the interferometer yields a measurement of the fourier transform of @xmath254 , and can thus make use of the dual properties of our shapelet functions under fourier transforms ( eq .  [ [ eq : b_tilde ] ] ) .",
    "a more thorough study of the deprojection using shapelets is left to future work .",
    "a study of the use of shapelets for reconstructing images with interferometers will be presented in chang & refregier ( 2001 ) .",
    "we have described and developed a new method for analysing images .",
    "it is based on the decomposition of the objects in the image into a series of basis functions of different shapes , or ` shapelets ' .",
    "the method is fully linear and uses a number of powerful properties of the basis functions . in particular",
    ", we showed that hermite basis functions have simple analytic properties under convolution , noise , rotations , distortions , and rescaling .",
    "these functions are eigenfunctions of the qho and thus allow us to use the formalism developed for this problem .",
    "for instance , we showed that transformations such as translations , rotations , shears and dilatations can be expressed as simple combinations of the raising and lowering operators .",
    "another remarkable property of these functions is that they are ( up to a rescaling ) their own fourier transforms .",
    "this is a unique property , which stems from the special symmetry of the qho hamiltonian .",
    "we derived analytical expressions for the flux , centroid and radius of the object , from its shapelet coefficients .",
    "we also constructed polar shapelets which give the explicit rotational properties of the object .",
    "it is interesting to compare our method to the wavelet method ( see review by stark , murtagh & bijaoui 1998 ) . in this latter method ,",
    "the image is decomposed into a sum of basis functions located on a grid across the image .",
    "the basis functions are taken to have a range of sizes , but have all the same shape .",
    "wavelets are thus ideal to decompose an image into different scales , which can then be analysed separately . our method , on the other hand models the image as a collection of discrete objects of arbitrary shapes and sizes .",
    "it is therefore particularly well adapted to the treatment of astronomical images , which are typically composed of a superposition of compact disjoint objects .",
    "the two methods can thus be thought as complementary .",
    "for instance , one can use wavelets to remove large - scale background variations , and to search and detect objects in the image .",
    "the resulting object catalog can then be used as the input to the shapelet method , which will then characterise the shape of each object in detail .",
    "our method potentially has a wide range of applications .",
    "it can be viewed as a new representation of images which makes object shapes easy to study and modify .",
    "for instance , we applied our method to galaxy images found in the hdf and showed how they could be well represented with a small number of shapelet coefficients .",
    "this can be used to compress galaxy images by a factor of 40 - 90 , and could thus have important applications for galaxy archival .",
    "we also discussed several direct applications of shapelets to measurements of gravitational lensing , and the problems of de - projection and psf correction .",
    "other applications to be explored are that of multi - colour shapelets and of the study of galaxy morphology and classification using shapelets .",
    "our original motivation for developing this method was to find a robust and precise method to measure weak lensing distortions in the presence of a psf .",
    "the application of shapelets to this problem and to the general problem of deconvolution will be presented in detail in paper ii .",
    "the application of shapelets to image reconstructions from interferometric observations will be presented in chang & refregier 2001 .",
    "the author is indebted to david bacon , tzu - ching chang and r. chitra for useful and stimulating discussions during the development of this method .",
    "he is supported by the eec tmr network on gravitational lensing and by a wolfson college research fellowship .",
    "in this appendix , we show how we can easily operate a change of scale @xmath7 for the decomposition of a function in 1-dimension .",
    "this is convenient for finding the optimal scale @xmath7 for a given function .",
    "in addition , such a change of scale occurs when a 2-dimensional image is distorted by gravitational lensing .",
    "let us consider a function @xmath275 which we decompose ( as in eq .",
    "[ [ eq : decompose ] ] ) into two sets of basis functions with scales @xmath276 and @xmath277 as @xmath278 the coefficients in each basis are related by @xmath279 using the generating function of hermite polynomials , one can show that the transformation matrix is given by @xmath280 where @xmath281 and @xmath282 is equal to @xmath283 if @xmath86 , @xmath87 and @xmath284 are all odd or all even , and is equal to 0 otherwise . in the limiting case",
    "where @xmath285 , the transformation matrix reduces to @xmath286 , in agreement with the orthonormal properties of the basis functions ( eq .  [ [ eq : orthonorm ] ] ) .",
    "99 alard , c. & lupton , r.h .",
    ", 1998 , apj , 503 , 325 arfken , g. 1985 , mathematical methods for phycisists , ( academic press : san diego , ca ) bacon , d. , refregier , a. , clowe , d. , ellis , r. , 2001 , accepted by mnras , preprint astroph/0007023 bartelmann , m. , & schneider , p. 2000 , preprint astro - ph/0007023 bertin e. & arnouts s. , 1996 , a&as , 117 , 393 birnkinshaw , m. , 1999 , phys .",
    "310 , 97 bonnet h. & mellier y. , 1995 , a&a , 303 , 331 carlstrom , j.e .",
    "et al . , 1999 , in nobel symposium particle physics and the universe ",
    ", to appear in physica scripta and world scientific , eds .",
    "l. bergstrom , p. carlson and c. fransson , preprint astro - ph/9905255 .",
    "chang , t. & refregier , a. , 2001 , in preparation cohen - tannoudji , c. , diu , b. & lalou , 1977 , quantum mechanics , ( hermann : paris ) dor , o. , bouchet , f.r .",
    ", mellier , y. , & teyssier , r. , 2001 , submitted to a&a , astro - ph/0102165 gunn , j.e . ,",
    "weinberg , d.h .",
    ", 1995 , in wide field spectroscopy and the distant universe , 35th herstmoncieux conference , eds .",
    "maddox s. & aragon - salamanca jarvis , j.f . & tyson , j.a . , 1981 , aj , 86 , 476 juszkiewicz , r. et al .",
    "1995 , apj , 442 , 39 kaiser , n. , squires , g. , broadhurst , t. , 1995 , ( ksb ) apj , 449 , 460 .",
    "kaiser , n. , 2000 , apj , 537 , 555 kuijken , k. , 1999 , a&a , 352 , 355 .",
    "luppino , g.a . , & kaiser , n. , 1997 , apj , 475 , 20 mao , s. 1999 , procs of _ gravitational lensing : recent progress and future goals _ , boston university , july 1999 , eds .",
    "brainerd and c.s .",
    "kochanek , preprint astro - ph/9909302 mellier , y. 1999 , ara&a , 37 , 127 mellier , y. et al .",
    "2000 , to appear in the eso proceedings `` deep fields '' , garching oct 9 - 12 , 2000 , preprint astro - ph/0101130 perlmutter et al . 1998 , preprint astro - ph/9812473 perlmutter et al . , 2001 ,",
    "snap web site , http://snap.lbl.gov/ refregier & bacon , 2001 ( paper ii ) , submitted to mnras , preprint available on astro - ph rhodes , j. , refregier , a. , & groth , e. 2000 , apj , 536 , 79 riess , a. , to appear as pasp review , preprint astro - ph/0005229 sarazin , c.l .",
    ", 1988 , _ x - ray emmissions from clusters of galaxies _ , ( cambridge univ . press : cambridge )",
    "sunyaev , r.a . & zeldovich , ya.b .",
    ", 1972 , comm .",
    "space phys . , 4 , 173 strack , j .- l . ,",
    "murtagh , f. , & bijaoui , a. , 1998 , _ image processing and data analysis _ , ( cambridge : cambridge , uk ) williams , r.e . , et al",
    ". 1996 , aj , 112 , 1335"
  ],
  "abstract_text": [
    "<S> we present a new method for the analysis of images , a fundamental task in observational astronomy . it is based on the linear decomposition of each object in the image into a series of localised basis functions of different shapes , which we call ` shapelets ' . </S>",
    "<S> a particularly useful set of complete and orthonormal shapelets is that consisting of weighted hermite polynomials , which correspond to perturbations around a circular gaussian . </S>",
    "<S> they are also the eigenstates of the 2-dimensional quantum harmonic oscillator , and thus allow us to use the powerful formalism developed for this problem . among their remarkable properties , they are invariant under fourier transforms ( up to a rescaling ) , leading to an analytic form for convolutions . </S>",
    "<S> the generator of linear transformations such as translations , rotations , shears and dilatations can be written as simple combinations of raising and lowering operators . </S>",
    "<S> we derive analytic expressions for practical quantities , such as the centroid ( astrometry ) , flux ( photometry ) and radius of the object , in terms of its shapelet coefficients . </S>",
    "<S> we also construct polar basis functions which are eigenstates of the angular momentum operator , and thus have simple properties under rotations . as an example </S>",
    "<S> , we apply the method to hubble space telescope images , and show that the small number of shapelet coefficients required to represent galaxy images lead to compression factors of about 40 to 90 . </S>",
    "<S> we discuss applications of shapelets for the archival of large photometric surveys , for weak and strong gravitational lensing and for image deprojection .    </S>",
    "<S> = = = = = = = =    # 1 # 1 # 1 # 1 @mathgroup@group @mathgroup@normal@groupeurmn @mathgroup@bold@groupeurbn @mathgroup@group @mathgroup@normal@groupmsamn @mathgroup@bold@groupmsamn = `` 019 = ' ' 016 = `` 040 = ' ' 336 = \" 33e = = = = = = = =    # 1 # 1 # 1 # 1 = = = = = = = =    [ firstpage ]    methods : data analysis , analytical ; techniques : image processing , surveys , gravitational lensing </S>"
  ]
}