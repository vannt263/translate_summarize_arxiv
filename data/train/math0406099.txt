{
  "article_text": [
    "one of the important questions of real enumerative geometry is : for a real algebraic surface @xmath0 , how many real rational curves in an ample linear system @xmath1 pass through a conjugation - invariant configuration of @xmath2 distinct generic points in @xmath0 ?",
    "similarly to the complex case , where the answer is given by gromov - witten invariants , the recently discovered welschinger invariants @xcite appear to be an ultimate tool to handle the question over the reals .",
    "in particular , they led to non - trivial positive lower bounds for the numbers in question , provided that the configuration consisted of only real points @xcite .",
    "so far no closed or recursive formula is found for the welschinger invariants , and tropical enumerative geometry @xcite provides the only known approach to compute them . in the present paper",
    "we express the welschinger invariants for configurations of real and imaginary conjugate points on real toric del pezzo surfaces via the number of certain subdivisions of the corresponding convex lattice polygons",
    ".    * welschinger invariants .",
    "* let @xmath0 be @xmath3 , or the hyperboloid @xmath4 , or the plane @xmath5 blown up at @xmath6 generic real points , equipped with the standard real structure .",
    "let @xmath7 be a real ample divisor on @xmath0 , and let the non - negative integers @xmath8 satisfy @xmath9 denote by @xmath10 the set of configurations of @xmath11 distinct points of @xmath0 such that @xmath12 of them are real and the rest form @xmath13 pairs of imaginary conjugate points .",
    "the welschinger number @xmath14 is the sum of weights of all the real rational curves in @xmath1 , passing through a generic configuration @xmath15 , where the weight of a real rational curve @xmath16 is @xmath17 if it has an even number of real solitary nodes , and is @xmath18 otherwise .",
    "the surfaces @xmath0 as above are the only toric surfaces , whose complex structure determines a symplectic structure which is generic in its deformation class , and thus , by welschinger s",
    "theorem @xcite , @xmath14 does not depend on the choice of a generic element @xmath15 ( a simple proof of the latter independence in the algebraic setting is found in @xcite ) .",
    "the importance of the welschinger invariant comes from an immediate inequality @xmath19 where @xmath20 is the number of real rational curves in @xmath1 passing through a generic configuration @xmath15 , and @xmath21 is the number of complex rational curves in @xmath1 , passing through generic @xmath11 points in @xmath0 .",
    "we should notice that even the existence of a positive lower bound for @xmath20 was not reached by any other method , beginning with the case of plane quartics .",
    "* a tropical calculation of the welschinger invariant . * our approach to calculating the welschinger invariant is quite similar to that in @xcite , and it heavily relies on the enumerative tropical algebraic geometry developed in @xcite .",
    "more precisely , we replace the complex field @xmath22 by the field @xmath23 of the complex locally convergent puiseux series equipped with the standard complex conjugation and with a non - archimedean valuation @xmath24 a rational curve over @xmath25 passing through a generic configuration @xmath26 is represented as an equisingular family of real rational curves in @xmath0 over the punctured disc , and its limit at the disc center determines a tropical curve in @xmath27 ( called a _ real rational tropical curve _ ) , which passes through the configuration @xmath28 , coordinate - wise @xmath29-projection of @xmath30 .",
    "our first main result is theorem [ tnn1 ] ( section [ secn14 ] ) , which precisely describes the real rational tropical curves , passing through generic configurations of points in @xmath31 , and , for any such real rational tropical curve @xmath32 , determines the contribution to the welschinger invariant of all the real algebraic curves , projecting to @xmath32 .",
    "the proof is based on the techniques of @xcite .    in the case of configurations , consisting of only real points ,",
    "this result has been obtained in @xcite .",
    "we notice that an extension of the tropical formula to the case of configurations of real and imaginary conjugate points , requires some further development of the techniques of tropical enumerative geometry , which we present in this paper .",
    "the principal difficulty in the latter case is that the configuration @xmath33 contains fewer points than @xmath30 , since a pair of conjugate points projects to the same point in @xmath27 .",
    "the second main result is theorem [ cnn1 ] ( section [ secn10 ] ) , which reduces the count of real rational tropical curves , passing through a generic configuration in @xmath31 , to the count of the total weight of certain lattice paths in the convex lattice polygon corresponding to the divisor @xmath7 .",
    "the weight of a lattice path is the sum of welschinger numbers of certain subdivisions of the given polygon into convex lattice subpolygons , which can be produced from the lattice path in a finite combinatorial algorithm ( section [ secn10 ] ) .",
    "here we follow the mikhalkin s idea to place the configuration @xmath28 on a straight line",
    ".    * applications . *",
    "the tropical formula turns the computation of welschinger invariants into a purely combinatorial problem on geometry of lattice paths and lattice subdivisions of convex lattice polygons .",
    "we present here some results , obtained in this way jointly with i. itenberg and v. kharlamov ( see @xcite for a detailed presentation and proofs ) .",
    "these results concern the positivity of welschinger invariants , their monotone behavior with respect to the number of imaginary points in configurations , and the asymptotics with respect to the growing degree of the divisor @xmath7 .",
    "we formulate a few natural conjectures .",
    "the positivity of @xmath34 for all real toric del pezzo surfaces and ample divisors @xmath7 was shown in @xcite .",
    "for @xmath35 , the invariants @xmath14 can vanish ( see , for example , computation of @xmath36 , @xmath37 being a line in the plane , in section [ secn12 ] ) .",
    "[ tn5 ] ( @xcite ) ( 1 ) the invariants @xmath38 are positive for all ample divisors @xmath7 and all @xmath39 , satisfying ( [ enn36 ] ) .",
    "\\(2 ) the following inequalities hold :    1 .",
    "@xmath40 , for @xmath41 , @xmath4 , @xmath42 , or @xmath43 , with @xmath7 an ample divisor such that @xmath44 ; 2 .",
    "@xmath45 , and @xmath46 , for @xmath47 , @xmath48 , and an ample divisor @xmath7 .",
    "( @xcite ) for a real unnodal del pezzo surface @xmath0 and any ample divisor @xmath7 on @xmath0 , the welschinger invariants @xmath14 are positive as @xmath49 $ ] , and are non - negative for @xmath50 $ ] .",
    "furthermore , they satisfy the monotonicity relation @xmath51 \\ .\\ ] ]    we notice that the monotonicity and non - negativity of welschinger invariants are closely related , since , by @xcite , theorem 2.2 , the first difference of the function @xmath52 is twice the welschinger invariant for the surface @xmath0 blown up at one real point .",
    "[ tn4 ] ( @xcite ) the welschinger invariants of the plane satisfy the relation @xmath53 for @xmath54 , or @xmath5 , @xmath55 , it holds that @xmath56    this means that the number of real rational curves passing through any generic conjugation - invariant configuration of points in @xmath0 , where @xmath13 is bounded as in the assertion , is asymptotically equal to the number of all complex rational curves in the logarithmic scale .",
    "we propose a natural extension of theorem [ tn4 ] to all del pezzo surfaces and other values of @xmath13 :    [ con2 ] ( @xcite ) let @xmath7 be an ample divisor on a real unnodal del pezzo surface @xmath0 .",
    "then , for any fixed @xmath39 , @xmath57    the following statement implies conjecture [ con2 ] for the hyperboloid :    [ tnn10 ] ( @xcite ) let @xmath7 be an ample divisor on @xmath4 of bi - degree @xmath58 , @xmath59 , and let a sequence of positive integers @xmath60 satisfy @xmath61",
    ". then @xmath62    * organization of the material . *",
    "the paper is structured as follows : in section [ secn13 ] we introduce tropical curves , in section [ sec2 ] we describe tropical limits of rational curves defined over the field @xmath25 , in section [ secn14 ] we prove the tropical formula for welschinger invariants , in section [ secn15 ] we obtain an explicit combinatorial description for welschinger invariants via lattice paths and subdivisions of convex lattice polygons .",
    "* acknowledgements .",
    "* i am grateful to i. itenberg and v. kharlamov for very valuable discussions .",
    "i thank the referee for a careful reading of the manuscript and pointing out a number of defects in the preliminary version .",
    "in sections [ secn13 ] and [ secn14 ] we assume that @xmath63 is a non - degenerate lattice polygon in @xmath27 , @xmath64 is a toric surface associated with @xmath63 , and @xmath1 is the tautological linear system , generated by the monomials @xmath65 , @xmath66 .",
    "in particular , the surfaces @xmath3 , @xmath4 , @xmath5 , @xmath48 , are naturally associated with the polygons shown in figure [ fn2 ] :    * the triangle @xmath67 , if @xmath41 , @xmath68 , * the rectangle @xmath69 , if @xmath54 , @xmath70 , * the trapeze @xmath71 if @xmath72 , @xmath73 , * the pentagon @xmath74 , if @xmath75 , @xmath76 , * the hexagon @xmath77 if @xmath78 , @xmath79 .",
    "observe that @xmath80    the amoeba @xmath81 of a curve @xmath82 is defined as the closure of the set @xmath83 . by kapranov s theorem ( see @xcite ) the amoeba @xmath81 of a curve @xmath82 , given by the equation @xmath84 with @xmath63 as the newton polygon of @xmath85 , is the corner locus of the convex piece - wise linear function @xmath86 in particular , @xmath81 is a planar graph with all vertices of valency @xmath87 , consisting of closed segments and rays .",
    "an amoeba @xmath32 with newton polygon @xmath63 is called _ reducible _ , if @xmath32 is the union of two amoebas @xmath88 with newton polygons @xmath89 such that @xmath90 ( minkowski sum ) .",
    "take the convex hull @xmath91 of the set @xmath92 and define the function @xmath93 this is a convex piece - wise linear function , whose linearity domains form a subdivision @xmath94 does not depend on the choice of a polynomial @xmath85 defining the curve @xmath16 .",
    "] of @xmath63 into convex lattice polygons @xmath95 .",
    "the function @xmath96 is legendre dual to @xmath97 ( see , for instance , @xcite ) , and thus , the subdivision @xmath94 is combinatorially dual to the pair @xmath98 .",
    "we define the _ tropical curve _ , corresponding to the algebraic curve @xmath16 , as a balanced graph , supported at @xmath81 ( cf .",
    "@xcite ) , i.e. , this is the non - archimedean amoeba @xmath81 , whose edges are assigned weights equal to the lattice lengths of a segment @xmath99 with integral endpoints as @xmath100 . ] of the dual edges of @xmath94 .",
    "the subdivision @xmath94 can be uniquely restored from the tropical curve @xmath81 @xcite ( we denote a tropical curve and the supporting amoeba by the same symbol , no confusion will arise ) .",
    "let @xmath32 be a tropical curve with newton polygon @xmath63 , given by a tropical polynomial ( [ enn1 ] ) .",
    "on the right - hand side of formula ( [ enn1 ] ) we remove unnecessary linear functions , take the terms @xmath101 in the remaining linear functions as variables , and factorizing by common shift , obtain the space @xmath102 , where @xmath103 is the set of the vertices of the dual subdivision @xmath104 .",
    "the set @xmath105 of tropical curves with newton polygon @xmath63 , which are combinatorially isotopic to the given curve ( or , equivalently , are dual to the same subdivision @xmath104 of @xmath63 ) , is defined in @xmath102 by certain linear relations and inequalities , and thus forms a convex polyhedron .",
    "its dimension is called the _ rank _ of the tropical curve @xmath32 . clearly , the rank of a tropical curve @xmath106 is bounded from below by the _ virtual rank _",
    "@xmath107 where @xmath108 is the set of vertices of @xmath32 , and @xmath109 is the valency of the vertex @xmath110 . in terms of @xmath104 , @xmath111 where @xmath103 , @xmath112 are the sets of vertices of @xmath104 and @xmath113 , respectively .    [ drev1 ]",
    "let @xmath114 be distinct points , @xmath32 a tropical curve with newton polygon @xmath63 .",
    "the set of tropical curves @xmath115 such that @xmath116 are vertices of @xmath117 , and @xmath118 imposes a number of linear conditions on the variables @xmath101 , introduced above .",
    "we say , that the pair of configurations @xmath119 is in @xmath32-generic position if the aforemention set of curves @xmath117 either is empty , or has codimension @xmath120 in @xmath121 .",
    "we say that a configuration @xmath122 is @xmath63-generic , if it is generic for any division into a pair of configurations and any tropical curve with newton polygon @xmath63 .",
    "[ lnn4 ] the set of @xmath63-generic configurations of @xmath123 points in @xmath31 is dense in the set of all @xmath123-tuples in @xmath31 . in particular , if a tropical curve @xmath32 with newton polygon @xmath63 passes through a @xmath63-generic configuration @xmath114 so that @xmath116 are vertices of @xmath32 , then @xmath124    the requirements , imposed by the pair of configurations @xmath119 on @xmath115 , can be written as linear conditions on the variables @xmath101 in @xmath102 , two for a vertex @xmath125 of @xmath117 , and one for @xmath126 .",
    "the failure of generality in this case means just a linear relation to the coordinates of @xmath122 .",
    "since there are only finitely many combinatorial types of tropical curves with newton polygon @xmath63 , we obtain that the set of @xmath63-generic @xmath123-tuples is the complement of finitely many hyperplanes in @xmath127 .",
    "a maximal straight line interval , contained in @xmath81 , is called an _ extended edge _ of @xmath81 .",
    "the edges of @xmath81 , forming an extended edge , are dual to a sequence of parallel edges of @xmath94 ordered so that each two successive edges of this sequence belong to one polygon @xmath128 .",
    "we say that an extended edge of @xmath81 is dual to each of the edges of @xmath94 in the corresponding sequence .    having a tropical curve @xmath81 with newton polygon @xmath63 and a @xmath63-generic configuration of point on it , we call the set of vertices of @xmath81 , coinciding with points of the configuration , and the set of extended edges of @xmath81 , containing points of the configuration in their interior , a _",
    "basic set of extended edges and vertices _ of @xmath81 .",
    "we work over the field @xmath129 and its real subfield @xmath130 .",
    "fix some @xmath63-generic collections of points @xmath131 and @xmath132 in @xmath31 .",
    "let @xmath133 be generic points , satisfying @xmath134 , @xmath135 , and let @xmath136 , @xmath137 , @xmath138 , be generic points in @xmath139 , satisfying @xmath140 , @xmath141 , @xmath137 , @xmath138 .",
    "that is @xmath142 and @xmath143 @xmath144    let a rational curve @xmath82 , given by a polynomial @xmath145 be defined over @xmath25 , and pass through @xmath146 , @xmath147 , and @xmath148 , @xmath149 , @xmath138 .",
    "changing the parameter @xmath150 , we make all the exponents of @xmath151 in @xmath152 , @xmath153 , integral and the function @xmath96 integral - valued at integral points .",
    "introduce the polyhedron @xmath154 it defines a toric variety @xmath155 , which is naturally fibred over @xmath22 so that the fibres @xmath156 , @xmath157 , are isomorphic to @xmath158 , and @xmath159 is the union of toric surfaces @xmath160 , @xmath161 , with @xmath162 being the faces of the graph of @xmath96 . by the choice of @xmath96 , @xmath163 , and we shall write that @xmath164 . then ( [ enn3 ] ) defines an analytic surface @xmath165 in a neighborhood of @xmath159 , which , by @xcite , lemma 2.3 , fibers into equisingular rational curves @xmath166 , and whose closure intersects @xmath159 along the curve @xmath167 that can be identified with @xmath168 . passing",
    "if necessary to a finite cyclic covering ramified along @xmath159 , we can make @xmath169 non - singular everywhere but may be at finitely many points , corresponding to the vertices of @xmath91 , and , in addition , make the surfaces @xmath170 , @xmath171 , smooth and intersecting transversally in @xmath172 . as in @xcite , we define the tropical limit ( tropicalization ) of the curve @xmath16 to be the pair , consisting of the tropical curve @xmath81 , and a collection of real curves @xmath173 , @xmath171 , which are defined by @xmath174 respectively , where @xmath175 , @xmath153 .",
    "a tropical curve @xmath81 is called _ nodal _ if the polygons of the dual subdivision @xmath94 are triangles and parallelograms .",
    "recall that , by @xcite , lemma 2.2 , @xmath176 if @xmath81 is nodal .",
    "notice also that the weights of the edges of a nodal tropical curve @xmath81 are constant along its extended edges , and thus , one can speak of weights of extended edges of nodal tropical curves .",
    "an irreducible nodal tropical curve @xmath81 is called _ real rational of type _",
    "@xmath177 with @xmath8 , satisfying ( [ enn36 ] ) , and @xmath178 , if    * @xmath179 , * the weights of the semi - infinite edges of @xmath81 are @xmath17 or @xmath180 , i.e. , the edges of @xmath94 lying on @xmath181 are of length @xmath17 or @xmath180 .",
    "[ pn1 ] under the assumptions of section [ sec2 ] , @xmath81 is a real rational tropical curve of type @xmath177 for some @xmath182 , passing through @xmath183 and @xmath184 in such a way that precisely @xmath185 of the points @xmath184 are trivalent vertices of @xmath81 , whereas @xmath183 and the remaining @xmath186 points among @xmath184 ( which we denote @xmath187 ) are not vertices of @xmath81 , and , moreover , @xmath187 lie on edges of @xmath81 of even weight . furthermore , for @xmath171 ,    * if @xmath113 is a parallelogram , then @xmath188 is the product of a monomial and few irreducible binomials , * if @xmath113 is a triangle , then @xmath189 is either a real rational curve crossing at @xmath190 , @xmath191 , or @xmath192 points , at which it is unibranch , or @xmath189 is the union of two imaginary conjugate rational curves such that any component of @xmath189 crosses @xmath193 at precisely three points and is unibranch there .",
    "our argumentation is similar to that in @xcite , section 3.3 , used to establish that the non - archimedean amoebas of nodal curves in toric surfaces passing through a respective number of generic points , are nodal .    .",
    "let @xmath194 and @xmath195 be vertices of @xmath81 for some @xmath196 , @xmath178 , and @xmath197 , @xmath198 , @xmath199 , @xmath200 , not be vertices . by ( [ enn2 ] ) , @xmath201    by @xcite , lemma 2.2 , we have @xmath202 where @xmath203 @xmath204 being the number of @xmath205-gons in @xmath94 , and @xmath206 being the number of @xmath207-gons in @xmath94 whose opposite edges are parallel . substituting the two latter relations into ( [ enn17 ] ) and using the euler formula for the subdivision @xmath94 , one obtains @xmath208    denote by @xmath209 the euler characteristic of the normalization .",
    "let @xmath210 , @xmath211 , be all the components of @xmath212 , @xmath213 , repeating each component @xmath210 with its multiplicity in @xmath212 , and let @xmath214 be the number of local branches of @xmath210 centered along @xmath215 .",
    "since the rational curves @xmath216 , @xmath217 , degenerate into @xmath167 in a flat family , all the components @xmath210 of @xmath167 are rational in view of the inequality for geometric genera @xmath218 ( see @xcite , proposition 2.4 , or @xcite . ] ) .",
    "denote by @xmath219 the set of components @xmath210 , defined by irreducible binomials , and by @xmath220 the set of remaining components @xmath210 .",
    "let @xmath221 be the union of regular neighborhoods in the three - fold @xmath222 of the intersection points of @xmath167 with @xmath223 .",
    "then @xmath224@xmath225 the latter inequality following from @xcite , lemma 3.2 and remark 3.4 , where @xmath226 stands for the number of local branches ( counting multiplicities ) of the curves @xmath227 centered at @xmath228 with @xmath99 running over all the edges of @xmath63 .    .",
    "for an estimation of the right - hand side of ( [ enn18 ] ) we shall construct some graph @xmath229 .",
    "first , we compactify @xmath27 into @xmath230 by adding an infinite point @xmath231",
    ". the tropical curve @xmath81 is then compactified by closing the semi - infinite edges with the point @xmath231 .    for any @xmath171 ,",
    "the reduced curve @xmath232 is split into irreducible real components and pairs of imaginary conjugate irreducible components .",
    "all such real components or pairs of imaginary conjugate components for all @xmath171 , except for real irreducible components from the set @xmath233 , and the point @xmath231 are taken as the vertices of the graph @xmath234 .",
    "if @xmath235 is a common edge , and components @xmath236 or @xmath189 and @xmath237 of @xmath238 contain a common pair of imaginary conjugate points in @xmath228 , then we join @xmath236 and @xmath237 by an edge .",
    "if @xmath239 is an edge of @xmath113 , and a component @xmath236 of @xmath189 contains a pair of imaginary conjugate points in @xmath228 , then we join @xmath236 and @xmath231 by an edge .",
    "the constructed graph @xmath234 is then transformed as follows .",
    "let @xmath236 be a part of @xmath189 , consisting of two imaginary conjugate components from the set @xmath233 .",
    "the curve @xmath236 intersects with @xmath240 and @xmath241 , where @xmath242 is a pair of parallel edges of @xmath113 .",
    "if @xmath243 , @xmath244 , then we remove the vertex @xmath236 and all ending at it edges , and instead join by an edge any two curves @xmath245 and @xmath246 which have been joined with @xmath236 .",
    "if @xmath247 and @xmath248 , then we get rid of the vertex @xmath236 of the graph and all adjacent edges , instead connecting @xmath231 with any curve @xmath245 , which has been joined with @xmath236 . in this manner , we get rid of one - by - one all the vertices of @xmath249 , corresponding to the curves @xmath236 which consist of two imaginary conjugate components from the set @xmath233 .",
    "we observe that the graph @xmath234 naturally projects to @xmath250 , when sending any vertex @xmath236 of @xmath234 to the vertex @xmath251 of @xmath81 dual to @xmath113 , and sending edges of @xmath234 to respective segments of the compactified extended edges of @xmath250 .",
    "the required graph @xmath229 will be a subgraph of @xmath234 .",
    "first , we define a subgraph @xmath252 of @xmath234 as follows .",
    "each point @xmath199 , @xmath200 , lies on an edge of @xmath81 .",
    "let @xmath99 be the dual edge of @xmath94 .",
    "by @xcite , formula ( 3.7.17 ) , @xmath253 , where @xmath254 is the truncation of the polynomial @xmath255 , defined by ( [ enn7 ] ) , on the edge @xmath99 , and @xmath256 are taken from formula ( [ enn38 ] ) . that is , @xmath228 contains a pair of distinct imaginary conjugate points , @xmath257 and @xmath258 , which belong to curves @xmath189 such that @xmath259 .",
    "hence the edge of @xmath81 , containing @xmath199 , is covered by the projection of some edges of @xmath234 .",
    "we choose one such covering edge of @xmath234 , denote it by @xmath260 , and build the graph @xmath252 from the edges @xmath260 , @xmath200 , with their endpoints as vertices of @xmath252 .",
    "notice that due to the @xmath63-generic position of the points @xmath199 , @xmath200 , the graph @xmath261 is the union of trees , the valency of its vertices that differ from @xmath231 is at most two , and the intersection of the projections of any two of its edges is finite .",
    "a vertex @xmath262 of @xmath252 of valency two corresponds to some curve @xmath236 , @xmath263 .",
    "if @xmath236 is the union of two imaginary conjugate rational curves such that each of them crosses @xmath193 at precisely three points , and is unibranch at these intersection points , then we call the vertex @xmath251 of @xmath252 an _ extendable vertex_. notice that the components of @xmath236 are defined by polynomials with the same newton triangle , and are determined by @xmath199 , @xmath200 , up to a finite choice in view of @xcite , lemma 3.5 .",
    "furthermore , due to the generality of the coefficients @xmath264 in ( [ enn38 ] ) , the intersection @xmath265 is either empty or a pair of imaginary conjugate points for any @xmath266 .",
    "exactly one of these pairs lies on an edge of @xmath113 , whose dual @xmath81-edge is not covered by @xmath252 . however , the latter @xmath81-edge is covered by some edges of @xmath234 with an endpoint @xmath236 .",
    "we choose one such edge of @xmath234 and append it to @xmath252 .    performing this procedure for all extendable vertices of @xmath252",
    ", we obtain a graph @xmath267 .",
    "next we determine the extendable vertices of @xmath267 , using the same definition , and append , if necessary , new edges to @xmath267 , obtaining @xmath268 . repeating this procedure",
    ", we finally end up with some subgraph @xmath229 of @xmath234 .    .",
    "an important observation is that no new edge in @xmath269 can join two extendable vertices of @xmath252 .",
    "indeed , the position of two non - adjacent extendable vertices of @xmath252 is uniquely determined by the position of the corresponding four points among @xmath195 , and thus , due to the generality of the latter points , the straight line through the given extendable vertices is not orthogonal to any of the segments joining integral points in @xmath63 . by a similar reason , no edge from @xmath270 can join two extendable vertices of @xmath271 , @xmath272 .",
    "in particular , this means that the number of edges in @xmath273 is equal to the total number of extendable vertices in @xmath274 .",
    "furthermore , assume that @xmath236 is a @xmath275-valent vertex of @xmath229 , @xmath276 , which is not extendable for any @xmath271 , @xmath277",
    ". then @xmath236 can not be the union of two imaginary conjugate rational curves , such that each of them crosses @xmath193 at precisely @xmath275 points and is unibranch there .",
    "indeed , if the situation were as described , the position of any @xmath278 of the intersection points of a component of @xmath236 with @xmath279 would determine this component and the fourth intersection point uniquely up to a finite choice .",
    "thus , the relation on the coordinates of the intersection points of @xmath236 with @xmath193 would imply a relation on the coordinates of the points @xmath280 , @xmath200 , contrary to their general choice .",
    "in particular , this implies that the contribution of such a vertex to the sum on the right - hand side of ( [ enn18 ] ) is @xmath281 , and the equality corresponds to the case of @xmath236 being the union of two imaginary conjugate components such that a component crosses @xmath193 at @xmath282 points and is unibranch there .",
    "we also observe that the points @xmath194 and @xmath195 , which are vertices of @xmath81 by assumption , are not projections of the vertices of @xmath229 . indeed",
    ", the points @xmath194 and @xmath195 can not be projections of the vertices of @xmath252 in view of a general position of these points with respect to @xmath199 , @xmath200 , which in turn determine the projections of the edges of @xmath252 .",
    "next , the projections of the edges of @xmath267 , and thus , the projections of the extendable vertices of @xmath267 are determined by @xmath252 up to a finite choice , where the number of choices is bounded from above by the total number of possible lattice edges in @xmath63 . by induction",
    "we get that the projections of the edges and vertices of @xmath229 are determined by @xmath199 , @xmath200 , up to a finite choice , and hence the general position of the points @xmath194 and @xmath195 does not allow them to be the projections of the vertices of @xmath229 .    .",
    "denote by @xmath283 , @xmath284 , the number of @xmath275-valent vertices of @xmath229 different from @xmath231 .",
    "denote by @xmath285 the number of trivalent vertices of @xmath229 which are extendable for some @xmath271 , @xmath277 . at last , denote by @xmath286 the valency of the vertex @xmath231 of @xmath229 .",
    "then the contribution of a vertex of @xmath229 to the right - hand side of ( [ enn18 ] ) is    * @xmath287 , if it is a vertex of valency @xmath288 , * @xmath289 , if it is a vertex of valency @xmath276 , which is not extendable for any @xmath271 , @xmath277 , * @xmath290 , if it is a trivalent vertex , which is extendable for some @xmath291 , @xmath292 ,    and thus , the total contribution of the vertices of @xmath229 is @xmath293 since the total number of edges of @xmath229 is @xmath294 , we can rewrite the latter inequality as @xmath295    denote by @xmath296 the number of polygons in @xmath94 , which are dual to the vertices of @xmath81 not covered by the vertices of @xmath229 , and which are not even - gons , whose pairs of opposite sides are parallel . clearly , a curve @xmath189 corresponding to such a polygon @xmath113 , contains a component from the set @xmath297 , and thus , contributes @xmath298 to the sum on the right - hand side of ( [ enn18 ] ) .",
    "that is , inequality ( [ enn18 ] ) implies @xmath299 @xmath300 with an equality only if    * the vertices of @xmath229 injectively project to the set of vertices of @xmath81 , which are dual to polygons different from even - gons , whose all pairs of opposite sides are parallel ; * if @xmath113 is an odd - gon , whose dual vertex of @xmath81 is not covered by the vertices of @xmath229 , then @xmath189 contains precisely one ( counting multiplicities ) component from @xmath220 , and , moreover , this component crosses @xmath193 at precisely three points and is unibranch there .",
    "combining ( [ enn19 ] ) and ( [ enn21 ] ) , we derive @xmath301 @xmath302@xmath303 the immediate relation @xmath304 excludes the case of a non - nodal tropical curve @xmath81 , and , in the case of a nodal tropical @xmath81 , implies the equality in ( [ enn22 ] ) and in ( [ enn44 ] ) with the restriction @xmath305 on the valency of vertices of @xmath229 .",
    "we then collect all the equality conditions mentioned above into the following restrictions :    1",
    ".   relations ( [ enn17 ] ) and ( [ enn18 ] ) are equalities with @xmath306 and @xmath307 ; 2 .",
    "the edges of @xmath94 lying in @xmath181 have length @xmath17 or @xmath180 ; 3 .",
    "the semi - infinite extended edges of @xmath32 , which are dual to the edges of @xmath104 of length @xmath308 lying on @xmath181 , belong to the graph @xmath229 ; 4 .",
    "any curve @xmath189 , @xmath309 , crosses the divisors @xmath228 , @xmath310 only at its non - singular points , and all these intersections are transversal ; 5 .",
    "all the components of the curves @xmath189 with newton parallelograms @xmath113 belong to @xmath233 ; 6 .   the curves @xmath189 , @xmath263 , such that @xmath113 is a triangle dual to a vertex of @xmath81 outside @xmath229 , are rational , intersecting @xmath193 at precisely three points being unibranch there ; 7 .",
    "if @xmath113 , @xmath263 , is dual to a univalent vertex of @xmath229 , then @xmath113 is a triangle , @xmath189 is rational and crosses @xmath193 at precisely four points being unibranch there ; 8 .   if @xmath113 , @xmath311 , is dual to a bivalent vertex of @xmath229 , then @xmath113 is a triangle , @xmath189 is rational and crosses @xmath193 at precisely five points being unibranch there ; 9 .",
    "if @xmath113 , @xmath263 , is dual to a trivalent vertex of @xmath229 , extendable for some @xmath271 , then @xmath113 is a triangle , @xmath189 is the union of two imaginary conjugate rational curves , each of them crossing @xmath193 at precisely three points being unibranch there .    .",
    "now we show that @xmath81 is irreducible , and that any trivalent vertex of @xmath229 is extendable for some @xmath271 , @xmath277 .",
    "first , the equality in ( [ enn18 ] ) means that , in the deformation @xmath216 , @xmath312 , no intersection point of any two distinct components of @xmath212 , @xmath213 , is smoothed out . assuming that @xmath81 is reducible , and using the description of the curves @xmath189 , obtained in step 4",
    ", we immediately conclude that then the curve @xmath216 , @xmath157 , becomes reducible .",
    "second , the existence of a trivalent vertex of @xmath229 , which was not extendable for all @xmath271 , @xmath277 , would mean a non - trivial relation to the position of the points @xmath199 , @xmath200 , contrary to their @xmath63-generality .    .",
    "to complete the proof of proposition [ pn1 ] , it remains to verify that the points @xmath195 can not be four - valent vertices of @xmath81 .",
    "assume on the contrary that , say , @xmath313 is a four - valent vertex of @xmath81 , which is dual to a parallelogram @xmath113 .",
    "the points @xmath314 and @xmath315 pick out two conjugate binomial components of the curve @xmath189 , which cross two toric divisors of @xmath279 , corresponding to a pair of parallel sides of @xmath113 .",
    "let these sides be dual to an extended edge @xmath316 of @xmath81 ; denote by @xmath317 the other extended edge of @xmath81 , passing through @xmath313 .",
    "we claim that @xmath81 can be deformed inside @xmath105 so that the deformed tropical curves will pass through the configuration @xmath318 , the points @xmath319 will remain their vertices , and the edge @xmath317 will move out of @xmath313 . indeed , by ( [ enn17 ] ) , reducing the requirement that @xmath317 passes through @xmath313",
    ", we obtain at least one - dimensional family of curves in @xmath105 , whereas , keeping that requirement we obtain only the curve @xmath81 . by lemma [ lnn11](1 ) , presented below in section [ secn14 ] , any of the above deformed tropical curves equipped with the same limit curves @xmath227 gives rise to a real rational curve in @xmath320 , passing through @xmath146 , @xmath147 , and @xmath148 , @xmath149 , @xmath138 .",
    "thus , we obtain infinitely many such curves in @xmath320 , contradicting to the generality of @xmath146 , @xmath147 , and @xmath148 , @xmath149 , @xmath138 .",
    "[ rnn1 ] we point out that , given a real tropical curve as in the assertion of proposition [ pn1 ] , and a collection of curves @xmath227 , as described in the proof , the curves @xmath216 , @xmath157 , which may appear from these data , are irreducible provided that the graph @xmath229 differs from @xmath81 .",
    "the latter holds if , for example , @xmath321 .",
    "given a real rational tropical curve @xmath32 of type @xmath177 with newton polygon @xmath63 , passing through the points @xmath183 and @xmath184 as described in proposition [ pn1 ] , to decide what are the curves @xmath227 , we have to know the graph @xmath229 , which appeared in the proof of proposition [ pn1 ] .",
    "we can reconstruct @xmath229 in the following way .",
    "take all the extended edges of @xmath32 passing through those points of @xmath184 , which are not vertices of @xmath32 . recall that all these edges are of even weight",
    "their union together with endpoints ( including @xmath231 if necessary ) constitutes the graph @xmath252 .",
    "let @xmath322 be the set of bivalent vertices of @xmath252 , different from @xmath231 .",
    "take any subset @xmath323 and , for each @xmath324 , add to @xmath252 the extended edge of @xmath32 with endpoint @xmath251 , which is not in @xmath252 .",
    "the new graph is denoted by @xmath267 .",
    "then we take any subset @xmath325 , and append the extended edges to @xmath267 in a similar manner . in finitely many steps we end up with some graph @xmath229 , whose vertices are some trivalent vertices of @xmath32 and , perhaps , @xmath231 , whose edges are some extendable edges of @xmath32 . notice that all the edges of @xmath229 necessarily have even weight . by the restrictions obtained in step 4 of the proof of proposition [ pn1 ] ,",
    "the set of trivalent vertices of @xmath229 must be @xmath326 .",
    "[ lnn5 ] in the notation of section [ secn2 ] , let @xmath113 be a triangle in @xmath94 , dual to a vertex of @xmath81 , which differs from @xmath184 , and is not a vertex of @xmath229 . then @xmath189 is a real rational nodal curve , crossing @xmath193 at precisely three points , where it is non - singular .",
    "the number of real solitary nodes of @xmath189 has the same parity as @xmath327 .",
    "furthermore , if the lengths of edges of @xmath113 are odd , and we are given the coefficients of the polynomial @xmath188 at the vertices of @xmath113 , then @xmath188 and thereby @xmath189 are determined uniquely .",
    "the statements immediately follow from @xcite , lemma 3.5 and proposition 6.1 .",
    "[ lnn6 ] in the notation of section [ secn2 ] , let @xmath113 be a triangle in @xmath94 , dual to a vertex @xmath199 , @xmath328 , of @xmath81 . then @xmath189 is a real rational nodal curve , crossing @xmath193 at precisely three points , where it is non - singular .",
    "the number of real solitary nodes of @xmath189 has the same parity as @xmath327 .",
    "furthermore , if the lengths of edges of @xmath113 are odd , then there are precisely @xmath329 real curves @xmath189 as above , where @xmath329 is the double euclidean area of @xmath113 .",
    "the fact that @xmath189 is non - singular along @xmath193 , is nodal , and the number of solitary real nodes is @xmath327 @xmath330 , follows from @xcite , lemma 3.5 and proposition 6.1 . to establish the last statement of the lemma",
    ", we perform an affine transformation of the lattice @xmath331 , which takes @xmath113 into the triangle with vertices @xmath332 , @xmath333 , @xmath334 with odd @xmath335 and even @xmath336 such that @xmath337 , @xmath338 .",
    "then @xmath189 has parameterization @xmath339 , @xmath340 in suitable affine coordinates @xmath341 , where @xmath342 .",
    "the condition that @xmath113 is dual to @xmath199 means that there is @xmath343 such that @xmath344 , @xmath345 , where @xmath256 are defined by ( [ enn38 ] ) . due to the generality of @xmath256 , the two latter equations have @xmath346 distinct solutions @xmath347 .",
    "[ lnn7 ] in the notation of section [ secn2 ] , let @xmath113 be a triangle in @xmath94 , dual to a univalent vertex of the graph @xmath229 . then @xmath189 is a real rational nodal curve , crossing @xmath193 at precisely four points , two real and two imaginary conjugate , where it is non - singular .",
    "the number of real solitary nodes of @xmath189 is equal to @xmath327 @xmath330 .",
    "assume that @xmath113 has two edges of odd length and one edge of even length , and we are given the intersection points of @xmath189 with @xmath193 .",
    "then there are @xmath348 such curves @xmath189 , where @xmath349 is the edge of even length .    a suitable affine automorphism of the lattice @xmath331 takes @xmath113 into the triangle with vertices @xmath332 , @xmath350 , @xmath351 , where @xmath337 , @xmath352 .",
    "we choose a parameterization @xmath353 of @xmath189 such that the value @xmath354 corresponds to the intersection point of @xmath189 with @xmath355)$ ] , and the values @xmath356 correspond to the intersection points with @xmath357)$ ] .",
    "then @xmath358 where @xmath359 .",
    "this immediately proves that @xmath189 is non - singular along @xmath193 , as well as the fact that @xmath189 is nodal and has no real non - solitary nodes ( cf .",
    "@xcite , proposition 6.1 ) .",
    "assume now that @xmath360 is odd .",
    "the conditions of the fixed intersection points with @xmath193 reduce to the system of equations @xmath361 which has @xmath362 distinct solutions @xmath363 .",
    "[ lnn8 ] in the notation of section [ secn2 ] , let @xmath113 be a triangle in @xmath94 , dual to a bivalent vertex of the graph @xmath229 . then @xmath189 is a real rational nodal curve , crossing @xmath193 at precisely five points , one real and two pairs of imaginary conjugate points , where it is non - singular .    as in the proof of lemma [ lnn7 ] , we can assume that @xmath364 with integers @xmath365 , @xmath352 .",
    "we choose a parameterization @xmath353 of @xmath189 so that the value @xmath354 corresponds to the intersection point of @xmath189 with @xmath355)$ ] , the values @xmath356 correspond to the intersection points with @xmath357)$ ] , and the values @xmath366 for some @xmath367 correspond to the intersection points with @xmath368)$ ] .",
    "then @xmath369 with some @xmath370 .",
    "it is immediate that @xmath189 is non - singular at @xmath371 . along the proof of proposition [ pn1 ] ,",
    "the two pairs of imaginary intersection points of @xmath189 with @xmath193 are generic , which reads as a system of equations on @xmath372 : @xmath373 with some generic @xmath374 .",
    "this results in a finitely many generic values for @xmath375 .",
    "in particular , we obtain that @xmath376 do not vanish simultaneously in @xmath377 , or , equivalently , @xmath189 is an immersed line @xmath378 into @xmath279 .",
    "the condition that three local branches of @xmath189 are centered at some point of @xmath379 reduces to a system of four equations @xmath380 which leads to an algebraic relation on @xmath375 and @xmath381 , contradicting their generality .",
    "[ lnn9 ] in the notation of section [ secn2 ] , let @xmath113 be a triangle in @xmath94 , dual to a trivalent vertex of the graph @xmath229 . then @xmath189 is the union of two imaginary conjugate nodal rational curves , which cross each other transversally at their non - singular points .",
    "furthermore , each of these rational curves crosses @xmath193 at precisely three imaginary points , where it is non - singular .",
    "the number of real solitary nodes of @xmath189 is equal to @xmath382 @xmath330 . given the intersection points of @xmath189 with @xmath240 , @xmath241 , @xmath242 being two edges of @xmath113 , the number of curves like @xmath189 is equal to @xmath383 .    from the proof of proposition [ pn1 ] we know that @xmath189 must be the union of two conjugate rational curves , each of them crossing @xmath193 at three points , where they are unibranch .",
    "again along the proof of proposition [ pn1 ] , the two pairs of conjugate intersection points of @xmath189 with @xmath384 are generic , and thus , the components of @xmath189 are nodal and non - singular along @xmath193 , they intersect transversally and only at their non - singular points .",
    "in particular , @xmath189 has no non - solitary real nodes , and hence the number of its solitary real nodes has parity of @xmath382 . for a component of @xmath189",
    ", we have two choices of a pair of intersection points with @xmath384 up to conjugation .",
    "furthermore , fixing these intersection points , we have by @xcite , lemma 3.5 , @xmath385 choices for a given component , and the proclaimed number of choices for @xmath189 follows .      using the structure of the curves @xmath227 which appear in the tropical limit of the curve @xmath386 , we refine the tropical limit along the procedures described in @xcite , sections 3.5 and 3.6 .",
    "namely , the local branches of the curves @xmath227 , which are tangent to the divisors @xmath387 , are naturally combined into disjoint pairs @xmath388 such that either    * @xmath389 and @xmath390 are centered at the same point @xmath391 , where @xmath99 is a common edge of two triangles , or * @xmath389 is centered at a point @xmath391 ; @xmath390 is centered at a point @xmath392 with @xmath393 being parallel edges of two triangles , dual to the same extended edge of @xmath81 , and such that @xmath257 and @xmath394 are joined by a sequence of components of @xmath167 from the set @xmath233 .    along the procedures of @xcite , sections 3.5 and 3.6",
    ", for any pair @xmath388 , the polynomial @xmath395 , defining the curve @xmath16 , determines a complex polynomial @xmath396 such that ( i ) it has newton triangle @xmath397 , where @xmath123 is the intersection number of @xmath389 with @xmath228 , and the coefficient of @xmath398 is zero , ( ii ) the polynomial @xmath399 defies a rational nodal curve @xmath400 in @xmath401 .",
    "furthermore , the polynomials @xmath402 , defining the curves @xmath227 and given by ( [ enn7 ] ) , determine the coefficients of @xmath399 at the vertices of @xmath403 .    among the results of @xcite , lemma 3.9 and proposition 6.1 , we shall use the following one :    [ lnn10 ] in the above notation , assume that @xmath404 and @xmath405 .",
    "then there are precisely @xmath123 polynomials @xmath406 which define nodal rational curves in @xmath401 .",
    "if @xmath407 are real and @xmath123 is even , then there are precisely two real polynomials ( [ enn35 ] ) , which define rational nodal curves in @xmath401 ; furthermore , one of these curves has @xmath408 real solitary nodes , and the other has no such nodes . if @xmath407 are real and @xmath123 is odd , then there is only one real polynomial ( [ enn35 ] ) , which defines a rational nodal curve , and this curve has @xmath408 real solitary nodes .",
    "let @xmath32 be a real rational tropical curve of type @xmath177 with newton polygon @xmath63 , passing through @xmath131 and @xmath132 in such a way that @xmath195 are trivalent vertices of @xmath32 , and the points @xmath183 and @xmath409 lie in the interior parts of some edges of @xmath32 .",
    "we intend to define the welschinger number @xmath410 , which later will be equated with the contribution to the welschinger number of all the real rational curves in the linear system @xmath1 on the surface @xmath411 , which pass through the points @xmath146 , @xmath135 , and @xmath412 , @xmath137 , and project onto the tropical curve @xmath32 .    among the possible graphs @xmath229 , inscribed in the given tropical curve @xmath32 along the rules presented at the end of section [ secn2 ] , there is the maximal graph @xmath413 .",
    "it is uniquely determined by the disposition of the sets @xmath414 and @xmath415 on @xmath32 , and is obtained by letting @xmath416 , @xmath417 , and so on , in the notation of section [ secn2 ] .",
    "if there is an even weight edge of @xmath32 lying outside @xmath413 , we put @xmath418 .",
    "assume that the edges of @xmath32 outside @xmath413 have odd weights .",
    "let @xmath104 be the dual subdivision of @xmath63 .",
    "then the triangles of @xmath104 dual to the vertices @xmath195 of @xmath32 have all edges of odd length , the triangles dual to the univalent vertices of @xmath413 have two odd length edges and one edge of even length , the triangles dual to the trivalent vertices of @xmath413 are _ even _ , that is , all edges are of even length",
    ". then we put @xmath419 where @xmath420 is the number of integral points , which lie strictly inside the triangles of @xmath104 , @xmath421 is the number of the even triangles , @xmath422 is the number of of the triangles of even lattice area , and @xmath423 runs over all the triangles of even lattice area , or dual to @xmath195 .",
    "let @xmath0 be a del pezzo toric surface , associated with a lattice polygon @xmath63 as defined in section [ sec1 ] , and @xmath424 be the corresponding real ample divisor .",
    "let the non - negative integers @xmath8 satisfy ( [ enn13 ] ) .    [ tnn1 ] in the above notation and assumptions , let a collection of distinct points @xmath425 in @xmath426 be @xmath63-generic , and the distinct points @xmath427 , @xmath135 , and @xmath428 , @xmath429 , be generic among those , satisfying @xmath430 then one has @xmath431 where @xmath131 , @xmath132 , and @xmath432 ranges over all real rational tropical curves of type @xmath177 with newton polygon @xmath63 , which pass through @xmath318 in such a way that precisely @xmath185 points of @xmath415 are trivalent vertices of @xmath432 , and the other points of @xmath415 are interior points of edges of @xmath432 , having even weight .    _",
    "step 1_. a @xmath63-general position of the points @xmath318 and the general choice of the respective points @xmath146 , @xmath135 , and @xmath433 , @xmath429 , ensure all the generality assumptions used in the proof of proposition [ pn1 ] .",
    "hence , in particular , the real rational curves in the linear system @xmath1 on the surface @xmath434 , passing through @xmath146 , @xmath135 , and @xmath412 , @xmath137 , are projected by @xmath435 to the real rational tropical curves as described in the assertion of theorem [ tnn1 ] .    .",
    "let @xmath32 be a real rational tropical curve of type @xmath177 , satisfying the conditions of theorem [ tnn1 ] , @xmath104 the dual subdivision of @xmath63 into polygons @xmath95 , and @xmath229 a graph constructed as described at the end of section [ secn2 ] . without loss of generality assume that @xmath436 are vertices of @xmath32 .",
    "a collection of real polynomials @xmath437 with newton polygons @xmath95 , respectively , is called an _ admissible tropicalization _ if    * for any common edge @xmath438 , the truncations @xmath254 and @xmath439 coincide ; * if an edge @xmath349 is dual to an edge of @xmath32 , passing through @xmath197 , @xmath440 ( or through @xmath441 , @xmath442 ) , then @xmath443 ( resp . , @xmath444 ) ;",
    "* if a triangle @xmath113 is dual to @xmath441 , @xmath445 , then @xmath446 ; * if @xmath113 is a parallelogram , then @xmath188 is split into the product of a monomial and few binomials ; * if a triangle @xmath113 is dual to a vertex of @xmath32 outside the graph @xmath229 , then @xmath188 defines a real rational curve in @xmath279 , which crosses @xmath193 at precisely three points and is non - singular there ; * if a triangle @xmath113 is dual to a univalent ( or bivalent ) vertex of @xmath229 , then @xmath188 defines a real rational curve in @xmath279 , which crosses @xmath193 at two real and a pair of imaginary conjugate points ( resp .",
    ", at one real and two pairs of imaginary conjugate points ) and is non - singular there ; * if a triangle @xmath113 is dual to a trivalent vertex of @xmath229 , then the curve @xmath447 in @xmath279 is split into a pair of imaginary conjugate rational curves , each of them crossing @xmath193 at precisely three imaginary points being non - singular there .",
    "next we define an _ admissible refined tropicalization _ associated with @xmath32 and @xmath229 .",
    "first , we consider the set of the local branches of curves @xmath448 , @xmath171 , which are tangent to @xmath223 , and , following the instructions of section [ secnn4 ] , distribute these branches into disjoint pairs . with each pair",
    "@xmath388 we associate a triangle @xmath449 , where @xmath123 is the intersection number of @xmath389 ( or @xmath390 ) with @xmath223 . if @xmath389 and @xmath390 are branches of curves @xmath189 and @xmath238 , respectively , centered at the same point on @xmath228 , @xmath438 , we perform the refinement procedure described in @xcite , section 3.5 .",
    "the corresponding transformations of the polygons @xmath450 and the polynomials @xmath451 , namely , the coordinate change induced by @xmath452 and the shift @xmath453 , are illustrated in figure [ fign2 ] ( see @xcite , section 3.5 , for all details ) .",
    "notice that the ( transformed ) polynomials @xmath451 determine the coefficients of @xmath454 , @xmath455 , and @xmath17 .",
    "( 13,6)(0,0 ) ( 0,0)(1,0)3(0,0)(0,1)6 ( 1,2)(1,-1)1(2,1)(1,2)1 ( 1,2)(1,3)1(1,2)(2,1)2(2,5)(1,-2)1 ( 3.5,2.9)(1,0)1(3.5,3.1)(1,0)1 ( 4.6,3.0)(-1,1)0.4(4.6,3.0)(-1,-1)0.4 ( 5,2)(1,0)3(5,0)(0,1)6 ( 5,3)(1,0)2(5,3)(1,2)1 ( 5,3)(1,-2)1(6,5)(1,-2)1(6,1)(1,2)1 ( 8.5,2.9)(1,0)1.5(8.5,3.1)(1,0)1.5 ( 10.1,3.0)(-1,1)0.4(10.1,3.0)(-1,-1)0.4(4.7,3)@xmath17 ( 11,2)(1,0)3(11,0)(0,1)6(11,3)(13,3 ) ( 13,3)(13,2 ) ( 11,4)(2,-1)2(11,5)(1,0)1 ( 12,5)(1,-2)1(11,2)(2,1)2(11,2)(0,-1)1 ( 11,1)(1,0)1(12,1)(1,2)1 ( 0.7,3.5)@xmath113(1.2,1.0)@xmath456(1.8,2.7)@xmath99 ( 6.8,4)@xmath457(6.5,1.2)@xmath458(6,3.1)@xmath316 ( 12.8,4)@xmath459(11.7,0.5)@xmath460(12.9,1.6)@xmath123 ( 10.6,3.9)@xmath180(3.7,3.6)@xmath461 ( 8.7,3.3)(10.7,2.8)@xmath17    if branches @xmath462 , forming a pair , are centered at points @xmath391 , @xmath392 , where @xmath463 , then we perform the refinement procedure , described in @xcite , section 3.6 , and illustrated in figure [ fign3 ] .",
    "namely , figures [ fign3](b , c ) indicate the transforms induced by some @xmath464 and by a shift @xmath453 .",
    "the convex piece - wise linear function @xmath465 , whose graph projects onto the subdivision @xmath104 , induces a convex piece - wise linear function @xmath466 on the polygons , shown in figure [ fign3](c ) except for the trapezoid @xmath467 .",
    "the generality of the configuration @xmath318 yields , in particular , the generality of the function @xmath468 in the following sense : no four parallel edges of the graph of @xmath468 lie on two parallel planes .",
    "thus , @xmath468 can uniquely be extended to @xmath467 as a convex piece - wise linear function , which defines a subdivision of @xmath467 into parallelograms and a translate of @xmath403 ( see , for example , figure [ fign3](d ) ) .",
    "furthermore , those polynomials @xmath402 , whose newton polygons contain @xmath393 and all the parallel to them edges of @xmath104 ( see figure [ fign3](a ) ) , after transformations determine the coefficients at the integral points on the part of the boundary of @xmath467 common with other polygons .",
    "this uniquely determines the polynomials with newton parallelograms inside @xmath467 , which are split into products of a monomial and binomials . finally , we determine the ( non - zero ) coefficients corresponding to the vertices of the triangle inside @xmath467 , and which we respectively assign to the vertices of @xmath403 .",
    "( 14,16)(3,0 ) ( 0,9)(1,0)6(0,9)(0,1)7 ( 1,12)(0,1)2(1,12)(2,1)2 ( 1,12)(2,-1)2(1,14)(1,1)1(1,14)(2,1)2 ( 2,15)(1,0)1(3,11)(1,-1)1 ( 3,11)(2,1)2(3,13)(0,1)2(3,13)(2,-1)2 ( 4,10)(1,2)1(2.8,8.3 ) ( 7,9)(1,0)6(7,9)(0,1)7 ( 8,14)(1,-2)1(8,14)(1,1)1 ( 9,11)(0,1)1(9,11)(1,0)3(8,14)(1,0)3 ( 9,11)(1,-1)1(9,12)(1,0)3 ( 9,15)(2,-1)2(10,10)(2,1)2(11,14)(1,-2)1 ( 12,11)(0,1)1(9.8,8.3 ) ( 14,9)(1,0)6(14,9)(0,1)7 ( 14,10)(3,1)3(14,10)(1,0)4 ( 18,10)(1,1)1(17,11)(1,0)2(17,11)(0,1)1 ( 17,12)(1,0)1(17,12)(0,1)2 ( 18,12)(1,-1)1(17,14)(1,0)2(18,12)(1,2)1 ( 14,15)(3,-1)3(14,15)(1,0)4(18,15)(1,-1)1(16.8,8.3)(17,9)(17,11)(17.1,9.1)@xmath123(15.4,12.3)@xmath467 ( 7,1)(1,0)6(7,1)(0,1)7 ( 7,2)(3,1)3(7,2)(1,0)4 ( 11,2)(1,1)1(10,3)(1,0)2(10,3)(0,1)1 ( 10,4)(1,0)1(10,4)(0,1)2 ( 11,4)(1,-1)1(10,6)(1,0)2(11,4)(1,2)1 ( 7,7)(3,-1)3(7,7)(1,0)4(11,7)(1,-1)1 ( 7,3)(3,1)3(7,5)(3,-1)3(9.8,0.3 )    denote by @xmath469 the set of all pairs @xmath388 of local branches as above . to obtain an admissible refined tropicalization , we extend an admissible tropicalization @xmath402 by adding ( complex ) polynomials @xmath396 with newton polygons @xmath403 , @xmath470 , such that    * any @xmath399 is given by formula ( [ enn35 ] ) with the coefficients @xmath405 , prescribed as explained above ; * the curve @xmath471 is rational nodal ; * if @xmath388 is real then @xmath399 is real ; * if @xmath388 is imaginary , and @xmath472 is the conjugate pair , then @xmath473 .    the curves @xmath474 , @xmath171 , and @xmath475 , @xmath470 , are called _ admissible tropicalization curves_.    .",
    "let us be given a tropical curve @xmath32 and an admissible refined tropicalization @xmath476 , @xmath161 , @xmath399 , @xmath470 , as described in step 2 .",
    "we state    [ lnn11 ] ( 1 ) under the above assumptions , there exists a polynomial @xmath477 $ ] with newton polygon @xmath63 such that @xmath165 is a rational nodal curve @xmath16 in @xmath434 , and the refined tropical limit of the polynomial @xmath395 consists of the tropical curve @xmath32 and the polynomials @xmath476 , @xmath161 , @xmath399 , @xmath470 .",
    "all these curves @xmath16 have the same number of real solitary nodes , which is equal to the total number of such nodes over all the curves @xmath478 , @xmath161 , and @xmath475 , @xmath470 .",
    "\\(2 ) the number of the above curves @xmath16 , passing through @xmath146 , @xmath135 , and @xmath412 , @xmath137 , is finite , and depends only on @xmath32 and on the polynomials @xmath476 , @xmath161 . furthermore , if all the edges of @xmath32 outside the graph @xmath413 have odd weight , then the number of such curves @xmath16 is equal to @xmath479 , where @xmath480 is the edge of @xmath104 , dual to the edge of @xmath32 passing through @xmath199 , @xmath200 .",
    "the proof , based on @xcite , theorem 5 , is presented in section [ secn5 ] .    .",
    "by proposition [ pn1 ] , the real rational curves in the linear system @xmath1 on @xmath434 , passing through @xmath146 , @xmath135 , and @xmath412 , @xmath137 , project onto real rational tropical curves as described in the assertion of theorem [ tnn1 ] , and their refined tropical limits determine ( up to a real constant factor ) an admissible refined tropicalization , associated with @xmath32 and a respective graph @xmath229 .",
    "we claim that , if there is an edge of @xmath32 of even weight , which is not included in @xmath229 , then the total contribution to @xmath14 of the real rational curves in @xmath434 , having @xmath32 and @xmath229 in their tropical limits , is zero .",
    "indeed , by restriction ( r3 ) obtained in step 4 of the proof of proposition [ pn1 ] , semi - infinite edges of @xmath32 of even weight belong to @xmath229 .",
    "let @xmath188 , @xmath171 , @xmath399 , @xmath470 , be an admissible tropicalization associated with @xmath32 and @xmath229 .",
    "an edge of @xmath32 of even weight outside @xmath229 must have two endpoints , and hence there is a pair @xmath481 of real local branches , having an even intersection multiplicity with @xmath223 . by lemma [ lnn10 ] ,",
    "the polynomial @xmath482 can be replaced by another polynomial @xmath483 keeping the admissibility property . by lemma [ lnn11 ]",
    ", these admissible refined tropical limits produce an equal number of real rational curves in @xmath1 , but they have different parity of the number of real solitary nodes ( see again lemma [ lnn10 ] ) .",
    "thus , the only pairs @xmath484 , which contribute to @xmath14 are @xmath485 such that all edges of @xmath32 outside @xmath413 have odd weight .    .",
    "in the previous notation and assumptions , let @xmath32 have no edge of even weight outside @xmath413 . by lemmas [ lnn5 ] , [ lnn6 ] , [ lnn7 ] , [ lnn9 ] , and [ lnn10 ] , all the real rational curves in @xmath1 arising along lemma [ lnn11 ] from admissible refined tropicalizations associated with @xmath32 and @xmath413 , have the same number of real solitary nodes @xmath330 , and the parity is given by the sign of @xmath410 as defined in section [ secn3 ] .",
    "thus , to complete the proof of theorem [ tnn1 ] , we have to count the number of admissible refined tropicalizations associated with @xmath32 and @xmath413 and considered up to multiplication by a non - zero real constant .",
    "first , by lemma [ lnn6 ] , we have @xmath486 choices for admissible curves with newton triangles , dual to @xmath195 , where @xmath423 runs over all these triangles .",
    "second , the above choice and the coordinates of the points @xmath146 , @xmath135 , and the points @xmath487 , @xmath442 , determine the intersections of the possible admissible tropicalization curves @xmath227 with @xmath488 , where @xmath316 runs over all edges of the subdivision @xmath104 , dual to the extended edges of @xmath32 , passing through @xmath197 , @xmath135 , and @xmath441 , @xmath137 .",
    "let @xmath489 be the union of all these extended edges of @xmath32 .",
    "the graph @xmath489 is a union of trees , whose vertices differing from @xmath184 have valency at most two .",
    "notice that the position of the remaining edges of @xmath32 is prescribed by @xmath489 ( provided that the combinatorial type of the pair @xmath490 is fixed ) .",
    "this yields that the graph @xmath489 has a bivalent vertex @xmath491 , and there is an extended edge @xmath492 in @xmath493 starting at @xmath491 .",
    "notice that @xmath492 can not join two vertices of @xmath489 of valency two ( this can be verified precisely as a similar statement on the graphs @xmath271 , @xmath277 in step 3 of the proof of proposition [ pn1 ] ) . put @xmath494 .    for an admissible tropicalization curve with newton triangle @xmath423 , dual to @xmath491 , we know the intersections with @xmath495 with @xmath496 , being any two edges of the newton triangle .",
    "then , by lemmas [ lnn5 ] , [ lnn7 ] , and [ lnn9 ] , the choice of such an admissible tropicalization curve can be made ( i ) in a unique way , if all the edges of @xmath423 have odd length , ( ii ) in @xmath497 ways , if @xmath316 has an even length and @xmath317 has an odd length , ( iii ) in @xmath498 ways , if both @xmath316 and @xmath317 have even length .",
    "next , by a similar reason , there is a bivalent vertex @xmath499 of @xmath500 , and the extended edge @xmath501 of @xmath502 , starting at @xmath499 , which does not end up at another bivalent vertex of @xmath500 .",
    "we then reconstruct a compatible admissible tropicalization curve with newton triangle dual to @xmath499 . proceeding in the same manner",
    ", we complete the reconstruction of all the admissible tropicalization curves @xmath227 .",
    "it follows immediately that the reconstruction of @xmath227 can be done in @xmath503 ways , where @xmath504 is the number of even triangles in @xmath104 , @xmath423 runs over all triangles in @xmath104 , containing an even length edge , @xmath505 runs over all the extended edges of @xmath32 of even weight with two endpoints , @xmath506 runs over all the extended edges of @xmath32 , passing through @xmath199 , @xmath200 , and at last , @xmath507 denotes the weight .    by lemma [ lnn10 ] , for any collection of admissible tropicalization curves @xmath227 , we can find @xmath508 compatible collections of admissible refining tropicalization curves @xmath400 , @xmath509 , where @xmath505 runs over all the extended edges of @xmath32 of even weight .",
    "combining these computations with the result of lemma [ lnn11 ] , we complete the proof .",
    "_ step 1_. the subdivision @xmath104 , the convex piece - wise linear function @xmath465 , and the collection of admissible tropicalization curves @xmath212 ,",
    "@xmath161 , @xmath400 , @xmath510 , satisfy the conditions of the patchworking theorem 5 from @xcite , section 5.3 .",
    "indeed , the assumptions of @xcite , section 5.1 , are easily verified .",
    "an orientation @xmath511 of the tropical curve @xmath32 , required in the assertion of theorem 5 @xcite , can be chosen so that all edges of @xmath32 form angles @xmath512 $ ] with the horizontal coordinate axis",
    ". then all the triads @xmath513 , @xmath171 , and all the deformation patterns , given by the curves @xmath400 , @xmath470 , are transversal ( in the sense of @xcite , section 5.2 ) by @xcite , lemmas 5.5 and 5.6",
    ". hence @xcite , theorem 5 , provides the existence of a real nodal rational curve @xmath16 in the linear system @xmath1 on @xmath434 , whose refined tropical limit consists of @xmath32 and @xmath212 , @xmath161 , @xmath400 , @xmath510 .",
    "moreover , the number of real solitary nodes of any of such curves @xmath16 is equal to the total number of real solitary nodes of the refined tropicalization @xmath212 , @xmath161 , and @xmath400 , @xmath470 .    to further impose the conditions @xmath514 , @xmath135 , @xmath429",
    ", we need a description of the complete family of curves @xmath515 as above .",
    "such a description is not given in the assertion of theorem 5 @xcite , but we shall extract it from the proof of that theorem , for which we refer to @xcite .",
    "the proof goes as follows .",
    "the curves @xmath16 are represented by polynomials @xmath516\\ , \\ ] ] where @xmath517 the rationality requirement is expressed as a system of equations on the unknowns @xmath518 , whose linearization at @xmath519 appears to be independent , and thus , the implicit function theorem applies , resulting in the existence of a family of the aforementioned curves @xmath386 , smoothly depending on some parameters .",
    "thus , we shall assume that @xmath520 , where @xmath491 is some vertex of @xmath63 , since the polynomials in @xmath521 $ ] are considered up to a constant factor , and then we have only to indicate , which of @xmath522 , @xmath523 , can be chosen as independent parameters .    .",
    "we start by reducing the set of variables @xmath522 , @xmath523 up to the following set .",
    "denote by @xmath524 the set of ( integral ) middle points @xmath525 of all the edges @xmath99 of @xmath104 , dual to the extended edges of @xmath32 belonging to the graph @xmath413 .",
    "we shall show that independent variables can be chosen among @xmath526 where @xmath103 stands for the set of vertices of @xmath104 .    along the proof of theorem 5",
    "as presented in @xcite , the rationality condition for @xmath16 reduces to equations for @xmath522 , @xmath523 , which , up to terms containing @xmath151 to a positive power , coincide with the equations of the transversality of all the triples @xmath527 , @xmath171 , which are written for the coefficients of the polynomials @xmath528    the transversality condition for a parallelogram @xmath113 ( recall that @xmath529 consists of two non - parallel edges ) implies by @xcite , lemma 5.1 , @xmath530 @xmath531 with some real linear functions @xmath532 , @xmath533 , as well as the following relation : for any pair @xmath393 of parallel edges of @xmath113 , it holds that @xmath534 where @xmath535 and @xmath536 run over the integral points of @xmath99 , and @xmath537 are obtained from @xmath538 , respectively , by a shift taking @xmath99 to @xmath316 .    by @xcite , definition 5.2",
    ", the transversality of a triple @xmath527 with a triangle @xmath113 means that the condition to pass through the nodes of the curve @xmath189 , and the relations @xmath539 are independent for curves @xmath16 in the linear system @xmath540 on @xmath279 . from the description of the curves @xmath189 and the riemann - roch theorem ( in the form of lemma 5.5 @xcite ) , it can easily be verified that conditions ( [ enn40 ] ) result in @xmath541    combining ( [ enn39 ] ) and ( [ enn42 ] ) , we obtain that the variables @xmath522 , @xmath542 , can be expressed via variables ( [ enn43 ] ) .    .",
    "we finally select an independent set of variables among ( [ enn43 ] ) .    in each parallelogram @xmath113",
    "there is a unique vertex , which does not belong to @xmath529 .",
    "we remove all such vertices from @xmath103 and denote the complement set by @xmath543 . without loss of generality , assume that @xmath544 .",
    "the extended edge of @xmath32 , passing through a point @xmath199 , @xmath200 , is dual to one or a few parallel edges of @xmath104 ; we pick up one of these edges of @xmath104 , denote it by @xmath480 , and introduce the set @xmath545 .",
    "we claim that @xmath522 , @xmath546 , is a complete set of independent variables , parameterizing the family of real rational curves @xmath16 as in the assertion of lemma [ lnn11 ] .    indeed ,",
    "first , we notice that @xmath547 defines a partial order on the set of parallelograms of @xmath104 , which we complete up to a linear order , and then , following the chosen order , we can restore all the variables @xmath522 , @xmath548 , by means of relations ( [ enn41 ] ) , restricted to the vertices of the parallelograms .",
    "second , we notice that if an extended edge @xmath549 of @xmath32 is dual to several ( parallel ) edges of @xmath104 , say @xmath550 , then we can find @xmath522 with @xmath551 , @xmath552 , using relations ( [ enn41 ] ) and the knowledge of @xmath553 , @xmath554 .    third , having the variables @xmath553 , @xmath555 , and using relations ( [ enn42 ] ) , we can find all the variables @xmath522 , @xmath556 .",
    "namely , we follow the algorithm of construction of the graph @xmath413 , starting with the graph @xmath252 ( see steps 2 and 3 of the proof of proposition [ pn1 ] , and the beginning of section [ secn3 ] ) . that is ,",
    "we begin with the knowledge of @xmath522 , @xmath557 for all edges @xmath99 of @xmath104 , dual to the edges of the graph @xmath252 .",
    "we successively append extended edges of @xmath32 to @xmath252 so that each time we have a triangle @xmath113 and the variables @xmath522 , where @xmath535 ranges over the vertices of @xmath113 and over @xmath558 , @xmath496 being any two edges of @xmath113",
    ". then relations ( [ enn42 ] ) allow us to find @xmath522 with @xmath559 , @xmath560 being the third edge of @xmath113 .",
    "thus , the variables @xmath522 , @xmath546 , determine the variables @xmath522 , @xmath561 , and hence , as shown before , all the variables @xmath522 , @xmath562 .",
    "at last , we observe that @xmath563 is the dimension of the variety of rational curves in the linear system @xmath1 on the surface @xmath0 , which confirms the independence of the variables @xmath522 , @xmath546 .",
    "a particular consequence of the result obtained in this step is that the variables @xmath522 , @xmath564 are independent of the variables @xmath522 , @xmath548 , and that equations ( [ enn41 ] ) , restricted to the vertices of all the parallelograms in @xmath104 , impose @xmath565 independent conditions on the latter set of variables is the number of parallelograms in @xmath104 . ] .    .",
    "the requirement to pass through the points @xmath146 , @xmath135 , and @xmath412 , @xmath137 , applied to the family of the real rational curves @xmath16 with the given refined tropical limit , can be formalized as follows .",
    "let a vertex @xmath441 , @xmath445 , of @xmath32 be dual to a triangle @xmath113 .",
    "then the equations @xmath566 coincide up to terms , containing @xmath151 to a positive power , with equations @xmath446 with @xmath264 introduced in ( [ enn38 ] ) . by riemann - roch",
    "( see lemma [ lnn6 ] ) the two latter equations together with ( [ enn42 ] ) , restricted to @xmath113 , impose @xmath567 independent conditions on the variables @xmath553 , @xmath568 , and thus , one can conclude with @xmath569 where @xmath570 are the vertices of @xmath113 .",
    "let a point @xmath197 , @xmath440 , belong to an extended edge @xmath549 of @xmath32 , whose endpoints are dual to triangles @xmath450 ( the fact that @xmath549 has two endpoints is established in step 4 of the proof of proposition [ pn1 ] ) .",
    "then the condition @xmath571 can be expressed by an equation of type ( 5.4.26 ) in @xcite , section 5.4 , which , in our notation , is interpreted as @xmath572 where @xmath123 is the length of the edge @xmath99 of @xmath113 , which is dual to @xmath549 , the points @xmath573 and @xmath574 are the vertices of @xmath99 , the non - zero real numbers @xmath575 are defined by ( [ enn37 ] ) , @xmath576 are monomials of the corresponding variables , @xmath577 is a linear combination of certain coefficients of @xmath188 ( or @xmath578 ) such that @xmath579 does not vanish appears as @xmath580 in formula ( 5.4.26 ) of @xcite . ] , @xmath110 is a positive integer , and , at last , @xmath581 and @xmath582 are certain real analytic functions of the variables @xmath583 , @xmath522 , @xmath151 , whose terms either contain @xmath151 to a positive power , or are at least quadratic in @xmath522 .",
    "we observe that equation ( [ enn46 ] ) is split into @xmath123 equations such that , for an odd @xmath123 , only one of them is real , and , for an even @xmath123 , not one nor two of them are real .",
    "assume now that a point @xmath441 , @xmath584 , belongs to an extended edge @xmath549 of @xmath32 with endpoints dual to triangles @xmath113 , @xmath456 ( the case of a semi - infinite edge @xmath549 can be treated in the same way ) .",
    "again by formula ( 5.4.26 ) of @xcite , section 5.4 , the conditions @xmath566 reduce to a system of equations , which can be written as @xmath585 where @xmath207 is the length of the edge @xmath99 of @xmath113 , which is dual to @xmath549 , the point @xmath573 is a vertex of @xmath99 , different from @xmath491 , and @xmath586 is the middle point of @xmath99 , the non - zero numbers @xmath264 are defined by ( [ enn38 ] ) , @xmath576 are monomials of the corresponding variables with real coefficients , @xmath577 is a linear combination of certain coefficients of @xmath188 ( or @xmath578 ) such that @xmath587 , @xmath110 is a positive integer , and , at last , @xmath581 and @xmath582 are certain analytic functions of the variables @xmath583 , @xmath522 , @xmath151 , whose terms either contain @xmath151 to a positive power , or are at least quadratic in @xmath522 .",
    "we observe that system ( [ enn47 ] ) is split into @xmath123 systems invariant with respect to the complex conjugation .",
    "take equations ( [ enn41 ] ) , restricted to the vertices of all the parallelograms in @xmath104 , and equations ( [ enn48 ] ) for all @xmath588 , and then append one real equation ( [ enn46 ] ) for each @xmath135 , and one @xmath589-invariant system ( [ enn47 ] ) for each @xmath590 .",
    "observe that the linearizations of the @xmath591 chosen equations impose independent conditions on the variables @xmath522 , @xmath592 . indeed , using these linearizations and following the algorithm , which restores the tropical curve @xmath32 from the graph @xmath489 ( see step 5 in the proof of theorem [ tnn1 ] ) , we can determine all the aforementioned variables .",
    "following the ideas of @xcite , we intend to choose a specific configuration of the points @xmath183 and @xmath184 , for which all the subdivisions @xmath104 of @xmath63 , dual to the real rational tropical curves mentioned in theorem [ tnn1 ] , can be obtained in a simple combinatorial algorithm . in this section",
    "we describe a reconstruction of a real rational tropical curve .",
    "we introduce an orthogonal system of coordinates @xmath593 , @xmath594 in @xmath27 with generic @xmath595 .",
    "the coordinate line @xmath596 is then not orthogonal to any of the segments joining integral points in @xmath63 .",
    "we pick @xmath597 distinct points @xmath598 in @xmath599 one by one so that @xmath600 and @xmath601 for all @xmath272 .",
    "@xmath602 then move them slightly in their neighborhoods in @xmath31 , obtaining a @xmath63-generic configuration @xmath603 . at last , we declare @xmath12 points in @xmath603 as @xmath183 and the remaining @xmath13 points as @xmath184 .    in fact , one could leave the set @xmath603 on the line @xmath604 , and satisfy the generality conditions required in theorem [ tnn1 ] . in the construction of a real rational tropical curve through @xmath318 , presented below , we suppose that the fixed points lie on the line @xmath604 , since a small variation of the configuration does not affect the construction .",
    "let @xmath32 be a real rational tropical curve of type @xmath177 with newton polygon @xmath63 , which passes through @xmath318 so that some @xmath185 points among @xmath184 are its vertices . as established in step 3 of the proof of proposition [ pn1 ] , the other points in @xmath318 are not vertices of @xmath32 .",
    "( 13,8)(0,0 ) ( 1,7)(1,0)11(2,7)(-1,1)1 ( 2,7)(1,-1)1(4,7)(0,1)1(4,7)(0,-1)1 ( 7,7)(-1,1)1(7,7)(1,1)1(7,7)(0,-1)1 ( 10,7)(-1,-2)0.5(10,7)(1,2)0.5(12.3,6.9)@xmath604 ( 1.8,6.5)@xmath605(7.2,6.5)@xmath313(7,5)@xmath606(1,2)(1,0)4.5(8,2)(1,0)4 ( 5.8,1.9)@xmath604(12.3,1.9)@xmath604(2,2)(1,1)2 ( 4,2)(-1,1)2(9,2)(1,1)1(11,2)(-1,1)1 ( 10,3)(0,1)1(5,1)@xmath607(10,1)@xmath608    consider the germs of edges of @xmath32 passing through @xmath318 .",
    "we have a finite choice of these germs which should be orthogonal to some segments with integral endpoints in @xmath63 .",
    "some @xmath185 of the points @xmath609 should be trivalent vertices of @xmath32 . in view of the general position of the line @xmath604",
    ", the germs do not lie on @xmath604 .",
    "furthermore , we orient the germs or their halves to start at the points @xmath425 as shown , for example , on figure [ fign4](a ) ( cf .",
    "@xcite , lemma 4.17 and figure 11 ) .",
    "given a combinatorial type of @xmath32 and a combinatorial type of the pair , the configuration @xmath318 determines @xmath32 uniquely .",
    "in particular , some extended edges of @xmath32 arising from the given edge germs at @xmath318 must intersect .",
    "for such an intersection point we have two possibilities : ( i ) it is either a four - valent vertex of @xmath32 ( see figure [ fign4](b ) ) , or ( ii ) it is a trivalent vertex of @xmath32 ( see figure [ fign4](c ) ) . in the latter case ,",
    "another extended edge of @xmath32 starts at the intersection point , which we orient as shown in figure [ fign4](c ) . for this edge germ",
    "we again have a finite choice , determined by the orthogonality to a segment with integral endpoints in @xmath63 and by the equilibrium relation ( see , for instance , @xcite , formula ( 10 ) in section 3 ) , which , in particular , says that the directing vector of the new edge germ is a linear combination of the directing vectors of the two edges , coming to the given vertex of @xmath32 , with positive coefficients .",
    "we proceed in the same manner with the new collection of edge germs of @xmath32 , and reconstruct the whole tropical curve @xmath32 .",
    "in fact , this procedure coincides with the reconstruction of @xmath32 in the sequence of graphs @xmath610 as appears in step 5 of the proof of theorem [ tnn1 ] .      1 .   the directing vectors of the extended edges of @xmath32 , which do not intersect with @xmath318 , and have an endpoint in the half plane @xmath611 ( or @xmath612 ) , have a positive ( resp . ,",
    "negative ) @xmath613-component , and hence @xmath614 .",
    "this means that the components of @xmath615 lie entirely in the components of @xmath616 , and are dual to some @xmath617 integral points in @xmath63 ordered by the linear function @xmath618 in the same way as the components of @xmath615 .",
    "furthermore , the semi - infinite components of @xmath615 correspond to the ( integral ) points of @xmath63 , where @xmath619 takes its maximal and minimal values .",
    "if @xmath441 is a trivalent vertex of @xmath32 , and @xmath620 are the integral points in @xmath63 , which correspond to the components of @xmath616 adjacent to @xmath441 , so that the first two components intersect @xmath604 , then @xmath621 .",
    "3 .   let @xmath622 be the rays in the half - plane @xmath611 , starting at @xmath318 and at the trivalent vertices of @xmath32 , and generated by the oriented edge germs of @xmath32 .",
    "we introduce a partial order in @xmath622 as follows . the rays , starting at @xmath318 , one orders by successive intersections with a line close and parallel to @xmath604 and oriented by @xmath618 .",
    "if a ray @xmath623 starts at a trivalent vertex , where rays @xmath624 merge , and @xmath625 , then we assume @xmath626 for all @xmath627 such that @xmath628 , and @xmath629 for all @xmath627 such that @xmath630",
    ". then relation ( [ enn49 ] ) yields that , if some rays @xmath631 cross a ray @xmath632 , then @xmath633 and @xmath634 are ordered , say , @xmath635 , and , respectively , @xmath636 .",
    "a similar claim holds for rays in the half - plane @xmath612 .",
    "[ [ secn10 ] ] reconstruction of subdivisions dual to real rational tropical curves passing through generic points on a straight line ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~      _ step 1_. the linear function @xmath618 defines a linear order of the set @xmath637 .",
    "we choose @xmath617 distinct successive points @xmath638 , @xmath639 , such that @xmath640 and @xmath641 .",
    "these points are dual to the components of @xmath616 containing the components of @xmath642 .",
    "we then connect the points @xmath643 by segments @xmath644 $ ] , @xmath645 , obtaining a broken line , called a _ lattice path _",
    "( see figure [ fign5](a ) ) .",
    "* the points @xmath651 , @xmath652 , to be ( somehow ordered ) points @xmath183 , * the points @xmath651 , @xmath653 , to be ( somehow ordered ) points @xmath184 , * the points @xmath651 , @xmath654 , to be trivalent vertices of @xmath32 , respectively dual to the lattice triangles in @xmath63 .",
    "that is , the segments @xmath480 , @xmath655 , are dual to some edges of @xmath32 , whose germs pass through the corresponding points @xmath656 , and are orthogonal to @xmath480 , @xmath655 , respectively ( see figure [ fign4](a ) ) . in turn , if @xmath657 , then we pick a point @xmath658 such that @xmath659 , and obtain a triangle @xmath660 dual to @xmath656 ( see figure [ fign5](b ) , where @xmath661 is designated by a shadow ) .",
    "the sides of @xmath661 are dual to the edges of @xmath32 , whose germs start at @xmath656 in the normal directions oriented outside of @xmath661 .    in the absence of suitable points @xmath662 for @xmath663 , or in the case of an odd length edge @xmath664 for @xmath665",
    ", we stop the construction and say that the lattice path @xmath666 and the sets @xmath667 , @xmath668 are inconsistent .",
    "_ step 3_. put @xmath669 .",
    "this is part of a subdivision of @xmath63 , and we extend it in the following inductive process .",
    "let @xmath670 , @xmath671 , be a contractible union of some lattice segments , triangles and parallelograms , such that @xmath672 , @xmath673 , and , for each connected component @xmath423 of @xmath674 , the intersection @xmath675 is a lattice path in @xmath63 along which the function @xmath618 is strongly monotone .",
    "if @xmath678 , there a pair of successive segments @xmath316 and @xmath317 in @xmath679 such that @xmath680 , and @xmath681 is minimal among all such pairs . the pair @xmath496 corresponds to a pair of germs of edges of @xmath32 , generating rays which intersect each other , and , moreover , along the partial order of rays as defined in ( o3 ) above , this pair of intersecting rays is minimal among all pairs of intersecting rays which can be constructed in the current stage",
    ".    then we define @xmath682 by adding to @xmath670 either the triangle @xmath683 , or the parallelogram , built on @xmath496 . for @xmath32",
    "this means adding a new tri- or four - valent vertex as shown in figure [ fign4](b , c ) .",
    "_ step 4_. consider a sequence @xmath677 which ends up with @xmath685 . in parallel",
    ", the dual construction gives us a graph @xmath686 .",
    "we assign corresponding weights to the edges of @xmath32 , and obtain a weighted rational graph , which by construction satisfies the equilibrium condition at each vertex ( see @xcite , formula ( 10 ) in section 3 ) , and thus , by @xcite , theorem 3.6 , is a tropical curve with newton polygon @xmath63 .",
    "we call the obtained subdivision _ consistent _ if the tropical curve @xmath32 is real rational of type @xmath177 . for all the consistent subdivisions of @xmath63 , obtained in the above algorithm , starting with the initial data @xmath687 , we sum up the welschinger numbers and denote the result by @xmath688 . moreover , we can get rid of the dependence on @xmath667 , noticing that the non - zero welschinger numbers come only from the sets @xmath667 , defined as follows : @xmath657 if @xmath689 and @xmath690 is odd .",
    "let the non - negative integers @xmath12 and @xmath13 satisfy @xmath696 .",
    "consider the pencil of real plane cubics passing through @xmath12 generic real points and through @xmath13 generic pairs of imaginary conjugate points .",
    "clearly , it has @xmath697 real base points .",
    "denote by @xmath698 and @xmath699 the numbers of real cubics in the pencil , which have a non - solitary real node or a solitary real node , respectively . blowing up the @xmath697 real base points of the pencil and integrating with respect to the euler characteristic over the blown - up real projective plane",
    ", we obtain ( cf .",
    "@xcite ) @xmath700 take a linear function @xmath701 with @xmath702 , and put @xmath703 .",
    "figure [ fign6 ] presents all consistent subdivisions of the newton triangle @xmath704 , constructed along the procedure of section [ secn10 ] , and their welschinger numbers , confirming formula ( [ enn50 ] ) .",
    "notice that @xmath705 .",
    "in fact , there is a configuration of four pairs of imaginary conjugate points in @xmath3 , which defines a pencil of non - singular real cubics .",
    "we present the following example : @xmath706 . by a routine computation",
    ", the system of equations for singular points @xmath707 can be reduced to a relation for @xmath708 and @xmath709 , which has no real solutions except for @xmath710 , which leaves the only real singular curve @xmath711 .",
    "the latter curve has two imaginary nodes .",
    "hence , by a small variation of the pencil , we get rid of the real singular curves .",
    "s. diaz and j. harris , _ ideals associated to deformations of singular plane curves _ , trans .",
    "* 309 * ( 1988 ) , no .",
    "2 , 433468 .",
    "i. itenberg , _ amibes des varits algbriques et denombrement de courbes [ daprs g. mikhalkin ] _ , sminaire n. bourbaki * 921 * , vol .",
    "2002 - 03 , juin 2003 .",
    "i. itenberg , v. kharlamov , and e. shustin , _ welschinger invariant and enumeration of real rational curves _ ,",
    "notices * 49 * ( 2003 ) , 26392653 .",
    "i. itenberg , v. kharlamov , and e. shustin , _ appendix to  welschinger invariant and enumeration of real rational curves \" _ , preprint arxiv : math / ag.0312142 .",
    "i. itenberg , v. kharlamov , and e. shustin , _ logarithmic equivalence of welschinger and gromov - witten invariants _ , russian math .",
    "surveys * 59 * ( 2004 ) , no .",
    "6 , 10931116 .",
    "m. m. kapranov , _ amoebas over non - archimedean fields _ , preprint , 2000 .",
    "g. mikhalkin , _ amoebas of algebraic varieties and tropical geometry _ , different faces of geometry / donaldson , s. ( ed . ) et al .",
    "kluwer , ny , 2004 , pp .",
    "g. mikhalkin , _ counting curves via the lattice paths in polygons _ , comptes rendus math . * 336 * ( 2003 ) , no . 8 , 629634 .",
    "g. mikhalkin , _ enumerative tropical algebraic geometry in @xmath27 _ , j. amer .",
    "soc . * 18 * ( 2005 ) , 313377 .",
    "a. nobile , _ on specialization of curves .",
    "_ i , trans .",
    "* 282 * ( 1984 ) , no .",
    "2 , 739748 . j. richter - gebert , b. sturmfels , and t. theobald , _ first steps in tropical geometry _ , idempotent mathematics and mathematical physics , contemp .",
    ", 377 , amer .",
    "soc . , providence , ri , 2005 , pp .",
    "e. shustin , _ patchworking singular algebraic curves , non - archimedean amoebas and enumerative geometry _ , preprint arxiv : math.ag/0211278 .",
    "e. shustin , _ a tropical approach to enumerative geometry _",
    ", algebra i analiz * 17 * ( 2005 ) , no .",
    "2 , 170214 . e. shustin and i. tyomkin , _ patchworking singular algebraic curves .",
    "_ i , israel math .",
    "j. , to appear .",
    "b. sturmfels , _ solving systems of polynomial equations _ , cbms regional conference series in mathematics .",
    "ams , providence , ri , 2002 . j .- y .",
    "welschinger , _ invariants of real rational symplectic 4-manifolds and lower bounds in real enumerative geometry _ , c. r. acad .",
    "paris , sr .",
    "i , * 336 * ( 2003 ) , 341344 .",
    "welschinger , _ invariants of real symplectic 4-manifolds and lower bounds in real enumerative geometry _ , invent . math . * 162 * ( 2005 ) , no .",
    "1 , 195234 ."
  ],
  "abstract_text": [
    "<S> the welschinger invariants of real rational algebraic surfaces are natural analogues of the genus zero gromov - witten invariants . </S>",
    "<S> we establish a tropical formula to calculate the welschinger invariants of real toric del pezzo surfaces for any conjugation - invariant configuration of points . </S>",
    "<S> the formula expresses the welschinger invariants via the total multiplicity of certain tropical curves ( non - archimedean amoebas ) passing through generic configurations of points , and then via the total multiplicity of some lattice paths in the convex lattice polygon associated with a given surface . </S>",
    "<S> we also present the results of computation of welschinger invariants , obtained jointly with i. itenberg and v. kharlamov . </S>"
  ]
}