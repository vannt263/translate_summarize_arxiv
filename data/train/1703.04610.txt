{
  "article_text": [
    "the prospect of manipulating micro- and nanoscale quantum machines  @xcite that can harvest energy from the environment and perform work has motivated a rapid growth of the emerging field of quantum thermodynamics  @xcite .",
    "thermodynamics , on the one hand , was established in the 19th century as a phenomenological theory to study macroscopic thermal machines such as steam engines .",
    "its basic concepts have since remained unchanged , and its applicability have been extended outside the original domain .",
    "few believe the laws of thermodynamics will ever fail .",
    "quantum theory , on the other hand , was invented during the early 20th century to explain the behavior of matter on the atomic scale .",
    "the development of quantum mechanics and its comprehension form the basis of our current understanding of the physical world and the foundations of modern technology .",
    "few doubt the universe is quantum - mechanical on the microscopic scale .",
    "while thermodynamics and quantum mechanics deal with phenomena on distinct , widely separated scales , the term quantum thermodynamics however is not an oxymoron .",
    "in fact , quantum thermodynamics aims to extend thermodynamics to individual quantum systems and provide a unified description of thermodynamic processes on the microscopic and macroscopic scales .",
    "one of the triumphs of classical thermodynamics is the explanation of how to convert a form of disordered random energy ( i.e. , heat ) into ordered useful energy ( i.e. , work ) .",
    "however , unlike in classical thermodynamics , the notion of work in quantum thermodynamics still requires a precise definition  @xcite .",
    "a common approach has been to adopt the concept of ensembles in statistical physics , and analyze the work content of a quantum system in contact with a heat bath in terms of expectation values of physical observables , such as the hamiltonian and density matrix , on an infinite ensemble of independent and identically distributed copies of the quantum system .",
    "it has been shown recently in ref .",
    "@xcite that optimizing the expected work gain leads to intrinsic fluctuations that can be of the same order as the expected work content _ per se_. the extracted energy becomes unpredictable and thus intuitively more heat - like than work - like , implying the work extraction does not act as a truly ordered work - like energy source . as an alternative , and inspired in part by single - shot information theory ,",
    "the @xmath0-deterministic work content of a quantum system has been introduced  @xcite .",
    "this means that we ask what is the maximum extractable work in each single run of the extraction process , instead of the average work that cab be extracted , apart from a failure probability of @xmath0 , not necessarily small .",
    "this scenario is referred to as the single - shot regime , as opposed to the independent and identically distributed regime .    in ref .",
    "@xcite , the single - shot maximum extractable work obtained in ref .",
    "@xcite was generalized to the fully quantum - mechanical setting utilizing the formalism of thermal operations in the context of thermodynamic resource theory  @xcite , and the minimum work cost of formation in the single - shot regime was also derived .",
    "the approach used in ref .",
    "@xcite relies on the concepts of min- and max - relative entropies developed in quantum information theory  @xcite and a generalized majorization concept called thermomajorization .",
    "hence , chances are that researchers , in particular those outside the field of quantum information theory , may find the reasoning and underlying physics obscured by the intricate mathematics involved .",
    "recently , an alternative approach also utilizing the formalism of thermal operations but with emphasis on a more intuitive concept based on a comparison of subspace dimensions has been presented in ref .",
    "however , careful readers may find this approach unsatisfactory either , because it is not clear why the comparison of subspace dimensions has to be done in a particular way instead of another .    in this article",
    ", utilizing the formalism of thermal operations , we present a physically intuitive and mathematically simple approach to single - shot work extraction and state formation that is accessible to general readers , in particular those not familiar with quantum information theory .",
    "the approach is physically intuitive in that it is based solely on the observation that thermal operations  @xcite associated with state transitions in work extraction and state formation processes are implemented by global unitaries on the heat bath , system , and work storage system that strictly conserve the total energy .",
    "hence , the initial and final global states have the same eigenvalues ( including multiplicity )",
    ". the eigenvalues of the initial global state and the diagonal elements of the final global state in the global energy eigenbasis can be easily calculated , provided that the initial system state is assumed to be diagonal in its local energy eigenbasis .",
    "this approach is also mathematically simple because it requires only basic knowledge of majorization theory and lorentz curves  @xcite , without invoking the more extended concept of thermomajorization , and uses only the schur theorem in matrix analysis  @xcite .",
    "the schur theorem provides a comparison between the diagonal elements and the eigenvalues of a hermitian matrix in terms of majorization , and results of the comparison are graphically represented by the lorentz curves .",
    "the concept of @xmath1-ordering  @xcite that is central to thermomajorization and the reason for comparing the ranks of eigenvalue and diagonal element vectors in a particular way arise naturally in this approach .",
    "therefore , our approach also builds a bridge between the two previous methods based respectively on the concept of thermomajorization  @xcite and a comparison of subspace dimensions  @xcite .",
    "in addition , we provide a critical examination of a conceptual inconsistency in the literature  @xcite regarding the maximum extractable work in general work extraction involving transitions between multiple energy levels of the work storage system .",
    "we show that there is a violation of the second law with an additional contribution to the maximum extractable work being independent of the initial system state and increasing without bound as the density of states of the work storage system increases .",
    "hence , the additional contribution is more heat - like than work - like , and should count as heat transferred from the heat bath instead of as work extracted from the system , implying that the maximum extractable work from a system state remains unchanged in the general work extraction .",
    "the origin of this inconsistency is the coupling between the heat bath and the work storage system that is implicitly assumed in the formalism of thermal operations  @xcite .",
    "the rest of this article is organized as follows . in sec .",
    "[ sec : preliminaries ] , we describe the basic ingredients of thermodynamic resource theory and provide the mathematical background for our approach .",
    "the acquainted reader may skip to sec .",
    "[ sec : workextraction ] , in which bounds on extractable work are derived and a graphical interpretation of the maximum extractable work and corresponding single - shot free energy is presented . in sec .",
    "[ sec : maxwork ] , the necessary and sufficient conditions for maximum work extraction are discussed in detail , and a seeming violation of the second law concerning the final system state being nonthermal after maximum work extraction is resolved . in sec .",
    "[ sec : workformation ] , bounds on work cost of formation are derived and a graphical interpretation of the minimum work cost of formation and corresponding single - shot free energy is provided . in sec .",
    "[ sec : generalworkextraction ] , the approach is applied to general work extraction in which transitions to multiple energy eigenstates in a certain energy range of the work storage system are considered successful . in doing so , a conceptual inconsistency in the literature regarding an additional contribution to the maximum extractable work is clarified and resolved . finally , we summarize the findings and discuss some open questions in sec .  [",
    "sec : conclusions ] .",
    "motivated by the resource theory of quantum entanglement  @xcite , quantum thermodynamics has been studied in recent years from a resource - theoretic perspective  @xcite . in a quantum resource theory ,",
    "agents are allowed to perform under a particular restriction a certain class of quantum operations for free .",
    "quantum states that can not be prepared for free are deemed resources .",
    "a resource quantum state is useful to the agents in that they can use this state to implement transformations that are outside the class of free operations . while all free quantum states are alike , each resource quantum state is useful in its own way .",
    "hence , two central questions arise naturally in every quantum resource theory : ( i ) how to quantify the usefulness of different resource states , and ( ii ) what other resource states can one particular resource state be converted to .    a widely adopted formalism in the resource theory of quantum thermodynamics ( or resource theory of athermality )",
    "is that of thermal operations  @xcite . given a quantum system with hamiltonian @xmath2 and a heat bath with hamiltonian @xmath3 ,",
    "the free operations are completely positive , trace - preserving , and energy - conserving maps on a system state @xmath4 of the form @xmath5,\\ ] ] or , equivalently , global unitary transformations given by @xmath6 where @xmath7 is the thermal ( i.e. , gibbs ) state of the bath associated with @xmath3 at some temperature @xmath8 , and @xmath9 is the final global state of the total system with @xmath10 . in the simplest case , the local hamiltonians at the start and the end of the transformation are assumed to be identical , and the total hamiltonian is equal to the sum of the local hamiltonians , i.e. , @xmath11 .",
    "conservation of the total energy requires that the global unitaries @xmath12 commute with the total hamiltonian @xmath13 .",
    "it is evident that @xmath14 , where @xmath15 is the thermal state of the system associated with @xmath2 at temperature @xmath8 , i.e. , a free quantum state .",
    "any state other than the thermal state @xmath15 is a resource state .",
    "all of the states are classified by their free energy , and this quantity also determines the interconvertibility of states . over the past few years",
    ", numerous insights into quantum thermodynamics have been gained using this formalism , ranging from an improved landauer principle  @xcite , a quantification of quantum coherence in thermodynamic processes  @xcite , to a family of quantum second laws  @xcite , just to name a few .    in a recent development  @xcite ,",
    "a work storage system that accounts for the extraction or expenditure of work under thermal operations has been explicitly included in quantum thermodynamic resource theory .",
    "it acts as a quantum version of a heavy weight in classical thermodynamics .",
    "analogous to the lifting of a weight a certain height being identified with the work performed by a heat engine , work in the quantum regime can be thought of as the ability to excite a work storage system from one energy eigenstate to a higher one . in the presence of a work storage system with hamiltonian @xmath16 , work extraction under thermal operations",
    "is implemented by global unitary transformations of the form [ see eq .  ]",
    "@xmath17 where @xmath18 is the ground state of the work storage system with zero energy and @xmath19 is some excited sate with energy @xmath20 .",
    "again , strict energy conservation is imposed by requiring that the global unitaries @xmath12 commute with the total hamiltonian @xmath21 .",
    "the work extracted from the system under a thermal operation is then given by the energy difference @xmath22 of the final and initial states of the work storage system .",
    "in the remainder of this section , we briefly summarize the definitions of majorization and the lorenz curve in majorization theory , and state without proof the schur theorem in matrix analysis .",
    "the interested reader is referred to refs .",
    "@xcite for further details .",
    "in particular , a proof of the schur theorem can be found in refs .",
    "@xcite .",
    "majorization is an ordering on @xmath23-dimensional real vectors . for a @xmath23-dimensional real vector @xmath24 ,",
    "we denote by @xmath25 the @xmath23-dimensional vector whose components are the same as that of @xmath24 ( including multiplicities ) but rearranged in decreasing order @xmath26 .",
    "let @xmath24 and @xmath27 be real vectors with equal dimension @xmath23 .",
    "we say that @xmath24 majorizes @xmath27 , and write @xmath28 , if and only if @xmath29 for @xmath30 , with equality instead of inequality for @xmath31 .",
    "note that majorization does not depend on the order of the components of vectors .",
    "a closely related definition is that of weak majorization .",
    "specifically , we say that @xmath24 weakly majorizes @xmath27 if and only if the inequality in eq",
    ".   holds for @xmath32 .    for vectors with nonnegative components , the majorization conditions in eq .",
    "have a graphical representation in terms of the lorenz curves , which were originally introduced in economics to characterize income inequality  @xcite .",
    "first , let us define the sum of the largest @xmath33 components of @xmath25 by @xmath34 for @xmath32 with @xmath35 .",
    "then , the lorenz curve of @xmath24 is the piecewise continuous linear function connecting the points @xmath36 for @xmath37 .",
    "note that for the sake of convenience and presentation simplicity , the horizontal axis of the lorenz curve in our definition is _ not _ scaled to unity .",
    "clearly , the lorenz curve of @xmath24 is nowhere below that of @xmath27 if and only if @xmath24 majorizes @xmath27 .",
    "a lorenz curve consists of line segments connected at points called elbows , where the slope of the curve changes as it passes through the points .",
    "all of the vector components contained in a single segment have the same numerical value , and hence the horizontal width of a segment is related to the multiplicity of the corresponding component . for a lorenz curve ,",
    "the on - ramp is defined to be the first segment of the curve .",
    "the slope and horizontal width of the on - ramp are determined by the largest component of the corresponding vector and its multiplicity , respectively .",
    "similarly , the tail of a lorenz curve is defined to be the right - most segment where the curve is flat , and its length is related to the multiplicity of the zero component of the corresponding vector .    historically , the first application of majorization in matrix theory is the characterization of the diagonal elements of a hermitian matrix in terms of its eigenvalues  @xcite . in 1932 , schur proved the following theorem : if @xmath38 and @xmath39 are respectively the eigenvalues and diagonal elements of a @xmath40 hermitian matrix ( including multiplicities ) , then its vector of eigenvalues @xmath41 majorizes its vector of diagonal elements @xmath42 . later in 1954 , horn proved the converse of schur s result .",
    "hence , the combined theorem is usually referred to as the schur ",
    "horn theorem  @xcite .",
    "nevertheless , we use only schur s result in this article .",
    "moreover , in this article we deal with density matrices ( and the projections thereof ) , and their vectors of eigenvalues and diagonal elements are probability vectors . a ( sub)normalized probability vector is a @xmath23-dimensional real vector @xmath43 with nonnegative components @xmath44 satisfying the ( sub)normalization condition @xmath45 ( @xmath46 ) .",
    "the rank of a probability vector @xmath43 ( density matrix @xmath47 or projector @xmath48 ) is denoted by @xmath49 ( @xmath50 or @xmath51 ) and defined to be the number of its nonzero components ( eigenvalues ) .",
    "a probability vector or density matrix is said to have full rank if and only if its rank and dimension are equal .",
    "we first consider the problem of single - shot work extraction from a system in contact with a heat bath to a work storage system . in the simplest case under consideration ,",
    "the local hamiltonians at the start and the end of the process are assumed to be identical , and the total hamiltonian is equal to the sum of the local hamiltonians , i.e. , @xmath21 , where @xmath3 , @xmath2 , and @xmath16 are the hamiltonians of the heat bath , system , and work storage system , respectively .",
    "we assume that all of the local hamiltonians have minimum energy zero , the heat bath has large but finite energy , and the energy of the system is small compared with that of the heat bath .",
    "the work storage system is assumed to have no degeneracies in the energy levels , i.e. , all of its energy eigenstates have different energies .",
    "we denote the energy eigenstates of the system at energy @xmath52 by @xmath53 , where @xmath54 is the degeneracy index with @xmath55 being the corresponding multiplicity .",
    "likewise , the energy eigenstates of the bath at energy @xmath56 are denoted by @xmath57 , where @xmath58 is the degeneracy index with @xmath59 being the corresponding multiplicity .",
    "following previous studies  @xcite , we take the initial global state @xmath60 as a product state of the form @xmath61 here , @xmath4 is a nonthermal system state that is diagonal in the energy eigenbasis of the system , @xmath62 is the thermal state of the bath at temperature @xmath8 , where @xmath63 with @xmath64 being the boltzmann constant and @xmath65 is the partition function of the bath , and @xmath18 is the lowest energy eigenstate of the work storage system ( weight ) with energy @xmath66 . under a thermal operation implemented by the global unitary @xmath12 ,",
    "the initial global state @xmath60 is transformed to a final global state @xmath67 , i.e. , schematically we have the transformation @xmath68 .",
    "we consider the final global state @xmath67 of the form @xmath69 where @xmath9 is the final state of the system and bath , with the reduced states of the system and the bath given by @xmath70 and @xmath71 , respectively .",
    "accounting for single - shot work extraction with a failure probability of @xmath0 , where @xmath72 , we take the final state of the work storage system as a mixture @xmath73 where @xmath19 is the energy eigenstate of the work storage system with energy @xmath74 .",
    "our choice of the final global state @xmath67 differs from those in the literature  @xcite . in refs .",
    "@xcite , the state of the system and bath was taken to be a product state @xmath75 , which however is not assumed in our analysis .",
    "moreover , while a mixed state for the weight formally similar to @xmath76 was also considered in refs .",
    "@xcite , the weight state corresponding to an _ unsuccessful _ work extraction process is not the ground state @xmath77 , but some ( unspecified ) mixed state orthogonal to @xmath78 and diagonal in the energy eigenbasis of the weight .",
    "this implies that a failure of work extraction could still `` extract work , '' albeit in an amount different from @xmath22 . here , by a failure of work extraction",
    "we mean in the strict sense of the term that there is no work being extracted from the system at all . in ref .",
    "@xcite , as what we have done here , the state of the system and bath was not assumed to be a product state @xmath75 .",
    "however , the weight state was taken to be the pure state @xmath78 ; hence , a failure probability of @xmath0 for imperfect work extraction had to be put in by hand so as to exclude the tails of weight @xmath0 in the initial global state @xmath60 .",
    "as will be seen below , our choice of the final weight state @xmath76 not only is physically motivated but also provides a justification of the method presented in ref .",
    "@xcite .",
    "since the global unitary @xmath12 commutes with the total hamiltonian @xmath13 , it is strictly energy conserving , and hence we may treat the transformation @xmath68 for each energy shell at total energy @xmath79 separately and combine their contributions in the end .",
    "thus , it is convenient to define the projector onto the energy shell @xmath79 by @xmath80 where @xmath81 , @xmath82 , and @xmath83 are projectors of the system , bath , and weight onto the local states with corresponding energies @xmath52 , @xmath56 , and @xmath84 , respectively .",
    "the initial and final global states in the energy shell at total energy @xmath79 are then given by @xmath85 and @xmath86 , respectively .",
    "for later convenience , we denote by @xmath87 and @xmath88 the dimension of the energy shell at total energy @xmath79 and the probability that the initial global state @xmath60 falls in the energy shell @xmath79 , respectively , i.e. , we have @xmath89 and @xmath90 with @xmath91 and @xmath92 .",
    "the eigenvalues of the initial global state @xmath60 in the energy shell @xmath79 ( i.e. , the projective state @xmath93 ) are given by @xmath94 where @xmath95 are the eigenvalues of the initial system state @xmath96 , which is taken to be diagonal in the system energy eigenbasis , with @xmath52 being the system energy and @xmath97 the corresponding degeneracy index , and @xmath98 is the degeneracy index of the bath at energy @xmath99 . the bath multiplicity @xmath59 is assumed to scale exponentially with @xmath56 , and , following refs .",
    "@xcite , we will henceforth use the approximation @xmath100 for @xmath101 .",
    "we note that since the global unitary @xmath12 preserves probability , it follows that the eigenvalues of the final global state @xmath67 in the energy shell @xmath79 ( i.e. , the projective state @xmath102 ) are also given by @xmath103 , and the probability that the final global state @xmath67 falls in the energy shell @xmath79 is also equal to @xmath88 , i.e. , @xmath104 .",
    "while the initial global state @xmath60 is diagonal in the global energy eigenbasis , the final global state @xmath67 in general is not diagonal in this basis .",
    "however , since the global unitary @xmath12 commutes with the total hamiltonian @xmath13 , the final state @xmath67 is block - diagonal with no off - diagonal elements between energy shells at different total energies .",
    "the diagonal elements of the projective state @xmath102 in the global energy eigenbasis are given by    @xmath105    here , @xmath106 is a shorthand notation for @xmath107 , @xmath97 is the system degeneracy index at energy @xmath52 , and @xmath98 is the bath degeneracy index at energy @xmath99 . it is noted that the eigenvalues @xmath103 and diagonal elements @xmath108 of the state @xmath102 are nonnegative and separately add up to @xmath88 , i.e. ,    [ eq : subnormconds ] @xmath109    and hence they can be thought of as the components of @xmath87-dimensional subnormalized probability vectors of eigenvalues @xmath110 and diagonal elements @xmath111 , respectively .",
    "the schur theorem implies that the probability vector @xmath110 majorizes the probability vector @xmath111 . to apply the schur theorem to @xmath110 and @xmath111",
    ", their components need to be rearranged in decreasing order .",
    "let @xmath112 and @xmath113 denote respectively the vectors having the same components as @xmath110 and @xmath111 ( including multiplicities ) but rearranged such that the components are in decreasing order . specifically , we have @xmath114 , where @xmath115 is the @xmath116 with the largest @xmath117",
    ", @xmath118 is that with the second largest @xmath117 , and so on , until that with the smallest nonzero @xmath117 is reached , and then the remaining are all zeros .",
    "note that such an ordering of the eigenvalues @xmath110 ( and hence @xmath41 ) is referred to as @xmath1-ordering in the context of thermomajorization  @xcite .",
    "next , to find @xmath113 we need to determine the magnitude of the diagonal elements of @xmath9 on the right - hand side of eq .  .",
    "to this end , we assume that the final bath state @xmath119 is the thermal state @xmath7 , a plausible assumption if the bath is large . hence , the diagonal elements @xmath120 in eq .   are independent of the bath degeneracy index @xmath98 . then , using the subnormalization condition for @xmath111 in eq .   and the fact that    [ eq : sumoversew ] @xmath121    we obtain    @xmath122=0,\\label{eq : sumesw}\\end{aligned}\\ ] ]    where use has been made of @xmath123 for @xmath124 . since eq",
    "is a very general relation that is independent of @xmath79 , @xmath22 , and @xmath9 , we conclude that @xmath125    thus , for @xmath20 , it follows that either @xmath126 and @xmath127 both vanish , or @xmath128 for @xmath129 . assuming the amount of work @xmath22 that can be extracted is on the order of @xmath130 , we have @xmath131 and hence @xmath132 .",
    "this condition is satisfied for physically interesting cases in which the failure probability @xmath0 is _ not _ expected to be large .",
    "therefore , we have @xmath133 , where @xmath134 is the largest of @xmath126 , @xmath135 is the second largest of @xmath126 , and so on , until all of the nonzero @xmath126 have been exhausted , then repeating the process for @xmath127 , and finally the remaining are all zeros . in other words ,",
    "the components of @xmath113 can be divided into three groups : ( i ) nonzero @xmath126 in decreasing order , ( ii ) nonzero @xmath127 in decreasing order , and ( iii ) zeros .",
    "the first group contains the nonzero probabilities of the global energy eigenstates in the energy shell @xmath79 after a _ successful _ work extraction process ( with probability @xmath136 ) ; the second group contains those after an _ unsuccessful _ work extraction process ( with probability @xmath0 ) ; the third group contains the global energy eigenstates in the energy shell @xmath79 that will never be populated after a work extraction process , be it successful or otherwise .",
    "we will denote by @xmath137 the _ full - rank _ subnormalized probability vector whose components are nonzero @xmath126 in decreasing order of the first group , i.e. , the nonzero probabilities of the global energy eigenstates in the energy shell @xmath79 after a successful work extraction process . clearly , the components of @xmath137 add up to @xmath138 because of the subnormalization condition for @xmath126 in eq .  .",
    "the fact that @xmath110 majorizes @xmath111 implies that @xmath112 and @xmath113 satisfy the following majorization inequalities @xmath139 for @xmath140 , with equality for @xmath141 because of the subnormalization conditions in eq .  .",
    "a schematic of the lorenz curves of @xmath110 and @xmath111 is shown in fig .",
    "[ fig : fig1 ] .",
    "clearly , @xmath110 majorizes @xmath111 if and only if the lorenz curve of @xmath110 is nowhere below that of @xmath111 .",
    "note that since @xmath142 , a continuous approximation in which @xmath143 is effectively treated as a continuous variable can be safely employed for large systems and will be used henceforth .",
    "we are now in a position to identify the nonzero _ initial _ probabilities of the global energy eigenstates in the energy shell @xmath79 that will be transferred entirely to @xmath137 with a probability of @xmath136 in a work extraction process . as can be seen from fig .",
    "[ fig : fig1 ] , these nonzero probabilities correspond to the _ largest _ nonzero components of @xmath112 that add up to @xmath138 . specifically , for a given @xmath144 , there exists a positive integer @xmath145 such that is the _ smallest _ positive integer such that @xmath146 , and the arguments that lead to the maximum extractable work given by eq .",
    "remain valid . ]",
    "@xmath147 where @xmath148 is the number of nonzero components of @xmath110 .",
    "according to eq .  , we will denote by @xmath149 the _ full - rank _ subnormalized probability vector whose components are the largest @xmath150 nonzero components of @xmath112 that add up to @xmath138 , or equivalently , the nonzero probabilities of the global energy eigenstates in the energy shell @xmath79 that will be transferred entirely to @xmath137 with a probability of @xmath136 in a work extraction process . clearly , we have @xmath151 as can be seen from fig .",
    "[ fig : fig1 ] .     and @xmath111 for imperfect work extraction , and graphical interpretation of the extractable work @xmath22 and single - shot free energy @xmath152 .",
    "the horizontal axis is broken at @xmath153 for better illustration.,width=326 ]    to find the positive integer @xmath150 , or equivalently @xmath154 , we first construct a generalized `` indicator function ''",
    "@xmath155 that takes values in the interval @xmath156 $ ] .",
    "a value of one ( zero ) for @xmath155 indicates that @xmath116 is ( not ) a component of @xmath149 for _ all _ of the bath degeneracy index @xmath157 , while a fractional value of @xmath155 indicates that @xmath116 is a component of @xmath149 for a fraction of the bath degeneracy index @xmath157 .",
    "then , in terms of @xmath155 , @xmath154 can be expressed as @xmath158 moreover , as can be seen from fig .",
    "[ fig : fig1 ] , the fact that @xmath110 majorizes @xmath111 implies @xmath159 where @xmath160 is upper bounded by the number of the diagonal elements @xmath126 ( or the dimension of the projective subspace @xmath161 ) , i.e. , @xmath162 here , @xmath163 is the partition function of the system at temperature @xmath8 . upon combining eqs .  ",
    ", we obtain @xmath164 where @xmath152 is the single - shot free energy of the ( nonthermal ) system state @xmath4 associated with a failure probability of @xmath0 , and defined by is called the @xmath0-smooth min - free energy of the state @xmath4",
    "@xcite , a quantity related to the smooth min - relative entropy of @xmath4 to @xmath15  @xcite , and hence the notation . ]",
    "@xmath165 @xmath166 is the thermal system state at temperature @xmath8 , and @xmath167 is the standard free energy of the system . note that @xmath168 because @xmath169 .",
    "one of the merits of our approach is that , as shown in fig .",
    "[ fig : fig1 ] , it allows for a graphical interpretation of the extractable work @xmath22 and single - shot free energy @xmath152 in terms of the lorenz curves of @xmath110 and @xmath111 .",
    "an inspection of fig .",
    "[ fig : fig1 ] shows that @xmath170 is indeed the least upper bound of @xmath22 .",
    "moreover , @xmath170 is independent of the energy shell @xmath79 because the trivial dependence of @xmath171 on @xmath79 cancels out ; hence , the maximum extractable work previously derived in refs .",
    "@xcite is recovered .",
    "the conditions for maximum work extraction will be discussed in sec .",
    "[ sec : maxwork ] .",
    "for the special case of perfect work extraction , i.e. , @xmath172 , we have @xmath173 and @xmath174 . from eqs .   and",
    ", we obtain @xmath175 where @xmath176 if @xmath177 for all values of @xmath52 and @xmath178 , then @xmath110 has full rank in the projective subspace @xmath179 with @xmath180 [ see eq .  ] .",
    "this , together with eq .  , implies that @xmath181 , and hence no work can be extracted .",
    "the same result can also be obtained by noting that if @xmath177 for all values of @xmath52 and @xmath178 , then @xmath182 and hence @xmath181 .",
    "thus , with certainty ( i.e. , @xmath172 ) work can only be extracted if the vector of eigenvalues @xmath110 of the initial projective state @xmath93 in any energy shell @xmath79 does not have full rank in the projective subspace @xmath179 , or equivalently , the initial system state @xmath4 does not have full rank .",
    "having established the bounds on single - shot work extraction with a failure probability of @xmath0 , we now study the conditions for maximum work extraction .",
    "indeed , another merit of our approach is that it allows for an unambiguous identification of the conditions for maximum work extraction .    the equality in eq",
    ".   holds if and only if @xmath149 and @xmath137 have equal rank ( or dimension ) @xmath150 and equal subnormalization @xmath138 , or equivalently there exists a positive integer @xmath150 such that and @xmath137 have equal rank ( or dimension ) @xmath150 , but may not have the same subnormalization , i.e. , @xmath150 is the positive integer such that @xmath183 .",
    "accordingly , the conditions for maximum work extraction remain valid , except that @xmath149 _ weakly _ majorizes @xmath137 . ]",
    "@xmath184 clearly , @xmath150 is equal to the rank of @xmath137 , i.e. , @xmath185 . together with eq .  , eq .",
    "implies that @xmath149 majorizes @xmath137 .",
    "moreover , the equality in eq .   holds if and only if all of the diagonal elements @xmath126 are nonzero , i.e. , @xmath137 has full rank in the projective subspace @xmath161 . from eq .",
    ", this in turn implies that all of the diagonal elements @xmath127 are nonzero as well , and hence @xmath111 has full rank in the projective subspace @xmath186 .",
    "therefore , for a given @xmath187 and some fixed initial system state @xmath4 , the _ imperfect _ maximum extractable work @xmath170 can be achieved if and only if , in any energy shell @xmath79 , the vector of diagonal elements @xmath137 of the final projective state @xmath102 has full rank in the projective subspace @xmath188 , and is majorized by the vector of the largest @xmath185 nonzero eigenvalues @xmath149 of the initial projective state @xmath93 . moreover , after a maximum work extraction the decohered ( or dephased ) final system state @xmath189 has full rank , where @xmath190 and @xmath191 is the operation that removes all of the off - diagonal elements ( i.e. , quantum coherence ) in the system energy eigenbasis .",
    "the case of perfect maximum work extraction requires special care . from eq .",
    ", maximum work extraction entails that @xmath192 and @xmath111 has full rank in the projective subspace @xmath161 .",
    "therefore , for some fixed initial system state @xmath4 , the _ perfect _ maximum extractable work @xmath193 can be achieved if and only if , in any energy shell @xmath79 , the vector of diagonal elements @xmath111 of the final projective state @xmath102 has full rank in the projective subspace @xmath194 , and the vector of eigenvalues @xmath110 of the initial projective state @xmath93 has the same rank as @xmath111 , but does _ not _ have full rank in the projective subspace @xmath179 .",
    "we note that since the dimension of the projective subspace @xmath161 in the energy shell @xmath79 scales as @xmath195 [ see eq .  ]",
    ", the condition that @xmath110 does not have full rank in the projective subspace @xmath179 can always be satisfied .",
    "moreover , like in imperfect maximum work extraction , the decohered final system state @xmath189 after a perfect maximum work extraction also has full rank .",
    "the unitary @xmath12 corresponds to maximum work extraction is not unique , as noted in ref .",
    "this is because any unitary @xmath12 that transfers @xmath149 entirely to @xmath137 such that @xmath137 has the same dimension as , and is majorized by , @xmath149 will give rise to maximum work extraction , provided that @xmath137 has full rank in the projective subspace @xmath161 .",
    "hence , maximum work extraction can result in a multitude of final system states @xmath96 , and the decohered final system states @xmath189 all have full rank .",
    "a schematic of the lorenz curves of @xmath110 and two possible cases of @xmath111 for imperfect maximum work extraction is shown in fig .",
    "[ fig : fig2 ] , where the final system state @xmath96 in case 1 is a nonthermal state , while that in case 2 is the thermal state @xmath15 .",
    "since the final system state @xmath96 is in general not diagonal in the system energy eigenbasis , if we want to apply a second work extraction to the state @xmath96 ( presumably with a `` fresh bath '' that is uncorrelated with the system ) , it needs to be decohered so as to remove the off - diagonal elements  @xcite .",
    "therefore , because all of the decohered final system states after a maximum work extraction have full rank , it is _ not _ possible to extract more work with certainty ( i.e. , @xmath172 ) by transforming a nonthermal final system state to another state , be it thermal or otherwise .     and two possible cases of @xmath111 for imperfect maximum work extraction , and graphical interpretation of the single - shot free energy @xmath152 and maximum extractable work @xmath170 .",
    "note that @xmath111 has full rank in the projective subspace @xmath186 , @xmath137 has full rank in the projective subspace @xmath161 , and @xmath149 and @xmath137 have the same rank ( or dimension ) .",
    "the horizontal axis is broken at @xmath153 for better illustration.,width=326 ]    if the final system state after a maximum work extraction is a _",
    "state @xmath96 , it seems that even more work may be extracted using a second , _ imperfect _ work extraction .",
    "however , as we will argue below , this is not the case .",
    "our arguments rest on the fundamental concepts of coherence work - locking , quantum typicality , and complete passivity , and strengthen the arguments given in ref .",
    "note that before the above analysis can be applied to find the extractable work ( with failure probability @xmath0 ) , the final system state @xmath96 needs to be decohered so as to remove the off - diagonal elements",
    ". nevertheless , the maximum extractable work of the state @xmath96 is the same as that of the decohered state @xmath189 because of coherence work - locking  @xcite ( see also refs .",
    "the latter refers to the phenomenon that , under thermal operations ( or strictly energy - conserving unitaries ) and without additional coherence resources , coherence of individual quantum systems contributes to the free energy but not extractable work .",
    "hence , the maximum extractable work of the state @xmath96 is determined by its diagonal part @xmath189 . in ref .",
    "@xcite , arguments of quantum typicality  @xcite were used to show that for a unitary @xmath12 drawn at random , a typical final system state @xmath96 is element - wise close to the thermal state @xmath15 if the bath is large , with relative fluctuations of contributions from the energy shell @xmath79 on the order of @xmath196 . to put it another way , while the typical final system state @xmath96 is nonthermal and coherent , the decohered state @xmath189 is close to the thermal state @xmath15 , i.e. , we have @xmath197 . for the second , imperfect work extraction , the initial global state",
    "is then given by @xmath198 .",
    "it is well known that for a given system , the thermal state is a passive state , and the only completely passive state , of the system  @xcite .",
    "a passive state is defined to be a state that does not allow for work extraction via reversible unitary processes , while a completely passive state @xmath47 is a state for which the global state @xmath199 of @xmath200 independent and identically distributed copies of the system is passive for all positive integers @xmath200 .",
    "very recently , it has been shown  @xcite that an engine utilizing an ancillary system can extract a maximum amount of work from a single copy of any passive state , but not completely passive state , and in order to extract work from passive states close to ( in trace norm ) the set of completely passive states , an ancillary system of large dimension is needed .",
    "hence , we conclude that in the absence of an ancillary system , a second , imperfect work extraction can not extract any work from the final system state @xmath96 of a previous maximum work extraction .",
    "this explains why there is no second law violation with the final system state of maximum work extraction being nonthermal .",
    "the bounds on the work cost of formation from a thermal system state can also be analyzed using our approach .",
    "unlike the case of work extraction , we will first derive the minimum work cost for _ exact _ formation of a nonthermal state @xmath96 from a thermal state @xmath15 under thermal operations , and then use the result to derive the minimum work cost for _ approximate _ formation , in a given distance measure , of states @xmath0-close to the desired target state @xmath96 for some fixed @xmath0 .",
    "this is because of the difference in the nature of uncertainty associated with single - shot work extraction and state formation .",
    "the uncertainty in the former case is of probabilistic nature , i.e. , work extraction with certainty will be impossible for system states that have full rank , and hence a failure probability of @xmath0 is acceptable ; however , the uncertainty in the latter case is of metrological nature , i.e. , it will be practically impossible to exactly determine a target state with infinite accuracy , and hence an error of @xmath0 is tolerable",
    ".    we will consider thermal operations associated with the following unitary transformation @xmath201 where , again , the global unitaries @xmath12 commute with the total hamiltonian @xmath13 .",
    "the final state of the system and bath is taken to be a product state @xmath75 with the bath in the thermal state @xmath7 .",
    "we stress that this choice of the final global state @xmath67 ensures that the work cost is used solely to transform the system state from @xmath15 to @xmath96 , and thus is minimum _ per se_. the product state @xmath75 of the system and bath",
    "was considered in ref .",
    "@xcite , and explicitly assumed at some point of the derivation in ref .",
    "@xcite .",
    "following the same reasoning used in the case of work extraction , we find that the eigenvalues of the initial global state @xmath60 in the energy shell @xmath79 ( i.e. , the projective state @xmath93 ) are given by @xmath202 where @xmath97 and @xmath98 are the degeneracy indices of the system and bath at energies @xmath52 and @xmath99 , respectively .",
    "since the global unitary @xmath12 preserves probability , the eigenvalues of the final global state @xmath67 in the energy shell @xmath79 ( i.e. , the projective state @xmath102 ) are also given by @xmath103 .",
    "the diagonal elements of the projective state @xmath102 in the global energy eigenbasis are given by @xmath203 where @xmath97 and @xmath98 are the same degeneracy indices as those for @xmath103 .",
    "to apply the schur theorem to the probability vectors @xmath110 and @xmath111 , we need to find @xmath112 and @xmath113 .",
    "note that @xmath103 are independent of @xmath52 , @xmath178 , and @xmath204 , and nonzero only for @xmath205 .",
    "this implies that the vector @xmath110 has rank equal to the dimension of the projective subspace @xmath161 in the energy shell @xmath79 , and all of its nonzero components are equal .",
    "hence , we have @xmath206 . because @xmath108 in eq .",
    "are formally the same as @xmath103 in eq .",
    ", we have @xmath207 , where @xmath134 is the @xmath127 with the largest @xmath208 , @xmath118 is that with the second largest @xmath208 , and so on , until that with the smallest nonzero @xmath208 is reached , and then the remaining are all zeros . in other words ,",
    "@xmath111 ( or , equivalently , the vector of diagonal elements @xmath209 ) is @xmath1-ordered  @xcite .",
    "a schematic of the lorenz curves of @xmath110 and @xmath111 is shown in fig .",
    "[ fig : fig3 ] .",
    "it is easy to see that the lorenz curve of @xmath110 has a simple form of an on - ramp ( i.e. , the first segment of the curve ) and a tail ( i.e. , the right - most part where the curve is flat ) , and the horizontal width of the on - ramp ( i.e. , the rank of @xmath110 ) is determined by the dimension of the projective subspace @xmath161 in the energy shell @xmath79 .",
    "in fact , this is a generic property of the lorenz curve for any projective state @xmath93 with @xmath210 , which we shall referred to as a _ thermal product state _ of the system and bath at weight energy @xmath22 , or simply thermal product state for short .     and",
    "@xmath111 for exact state formation , and graphical interpretation of the work cost of formation @xmath22 , single - shot free energies @xmath211 and @xmath212 . the gray arrow indicates the stretching of the lorenz curve of @xmath110 along the @xmath33-axis such that its on - ramp is aligned with that of the lorenz curve of @xmath111 .",
    "the horizontal axis is broken at @xmath153 for better illustration.,width=326 ]    according to the schur theorem , it follows that @xmath110 majorizes @xmath111 .",
    "a lower bound on the work cost of formation @xmath22 can be immediately obtained from the implication that @xmath213 . here , we have @xmath214 and @xmath215 , where use has been made of eq .   and the analysis of sec .",
    "[ sec : workextraction ] .",
    "however , the resulting lower bound is far from stringent . to find a more stringent lower bound , we first note the fact that @xmath110 corresponds to a thermal product state and @xmath110 majorizes @xmath111 implies @xmath216 ; hence , the on - ramp slope of the lorentz curve of @xmath110 is greater than or equal to that of @xmath111 . we can then implement a @xmath217-fold ( @xmath218 ) stretching of the lorenz curve of @xmath110 along the @xmath33-axis ( making its on - ramp slope decreased by a factor of @xmath217 ) , and still find that the lorenz curve of @xmath110 is everywhere greater than or equal to that of @xmath111 ( see fig .  [",
    "fig : fig3 ] ) .",
    "thus , from eqs .   and , we obtain @xmath219 where @xmath220 is the system energy eigenstate corresponding to @xmath134 , i.e. , the energy eigenstate with the largest @xmath1-ordered diagonal element of the target system state @xmath96 . the most stringent lower bound on @xmath22",
    "is given by @xmath221 , corresponding to the on - ramps of the lorenz curves of @xmath110 and @xmath111 are aligned in the first place , and reads @xmath222 to compare our result for the minimum work cost of formation @xmath223 with those derived in the literature  @xcite , we note that the product under the logarithm on the right - hand side of eq .   can be expressed as @xmath224 where use has been made of the relation @xmath225 .",
    "it is convenient to define another single - shot free energy @xmath211 by is called the max - free energy of the state @xmath96",
    "@xcite , a quantity related to the max - relative entropy of @xmath96 to @xmath15  @xcite , and hence the notation .",
    "its smoothed version is the @xmath0-smooth max - free energy @xmath226 defined in eq .  .",
    "] @xmath227 in terms of which the minimum work cost of formation @xmath223 in eq .   can be written as @xmath228 again , as shown in fig .",
    "[ fig : fig3 ] , our approach allows for a graphical interpretation of the work cost of formation @xmath22 and single - shot free energy @xmath211 in terms of the lorenz curves of @xmath110 and @xmath111 .",
    "an inspection of fig .",
    "[ fig : fig3 ] reveals that @xmath223 is indeed the greatest lower bound of @xmath22 . note that @xmath223 is independent of the energy shell @xmath79 because the trivial dependence of @xmath229 on @xmath79 in @xmath110 and @xmath111 cancels out ; hence , the minimum work cost of formation for exact formation previously derived in refs .",
    "@xcite is obtained .",
    "moreover , the minimum work cost of formation @xmath223 can be achieved if and only if , in any energy shell @xmath79 , the largest diagonal elements of the final projective state @xmath102 in the projective subspace @xmath179 is the same as the ( degenerate ) eigenvalue of the initial projective state @xmath93 in the projective subspace @xmath230 .    for approximation formation of states",
    "@xmath0-close to the target state @xmath96 in trace norm , the minimum work cost of formation @xmath231 can be found by minimizing @xmath232 with respect to all states @xmath233 in the @xmath0-vicinity of the state @xmath96 in trace norm .",
    "thus , we obtain @xmath234 here , @xmath226 is the corresponding single - shot free energy defined by @xmath235 where the infimum is taken over all @xmath233 satisfying @xmath236 with @xmath237 being the trace norm  @xcite . clearly , the minimum work cost of formation for approximate formation previously derived in refs .",
    "@xcite is recovered .",
    "moreover , an inspection of fig .",
    "[ fig : fig3 ] reveals that @xmath238 and , in general , @xmath239 for approximate state formation and imperfect work extraction , provided that @xmath0 is not large .",
    "hence , we can not extract more work from a nonthermal state ( a resource state in the resource theory of athermality  @xcite ) than that is required to create the state , a restatement of the second law reflecting the fundamental irreversibility in thermodynamical processes .",
    "our approach can be generalized straightforwardly to the case of work extraction in which transitions from the ground state to multiple energy eigenstates in a certain energy range of the work storage system are considered successful  @xcite .",
    "specifically , the amount of extracted work @xmath240 is now identified with the transition ( with probability @xmath136 ) of the work storage system from its ground state @xmath18 to any state @xmath19 in the energy range @xmath241 , where @xmath242 . accordingly , the final state of the work storage system now takes the form @xmath243 where @xmath244 are the work distributions  @xcite that , given a successful work extraction process , characterize the conditional probabilities of the weight in the state @xmath19 , and satisfy @xmath245 .    the analysis presented in sec .",
    "[ sec : workextraction ] requires only minimum modification : ( i ) @xmath22 is not a fixed parameter , but taking values in the range @xmath246 , and ( ii ) @xmath137 is replaced by @xmath247 , which is the full - rank subnormalized probability vector whose components are nonzero @xmath126 in decreasing order , i.e. , the nonzero probabilities of the global energy eigenstates in the energy shell @xmath79 after a successful work extraction process . clearly , the components of @xmath247 add up to @xmath138 .",
    "again , the fact that @xmath110 majorizes @xmath111 implies @xmath248 where @xmath249 is upper bounded by the number of the diagonal elements @xmath126 or , equivalently , the dimension of the projective subspace @xmath250 .",
    "hence , we have @xmath251 upon combining eqs .  , , and , we obtain @xmath252 where the trivial dependence of @xmath171 on @xmath79 cancels out .",
    "the maximum extractable work @xmath253 does not depend on the work distributions @xmath254 ; however , it in general depends on the width of the allowed energy range @xmath255 and the energy level spacings of the work storage system .",
    "the independence of @xmath253 on @xmath254 is not unexpected because it is the marginal probability of @xmath136 that determines @xmath253 .",
    "moreover , the analysis presented in sec .  [",
    "sec : workextraction ] also shows that @xmath253 is indeed the least upper bound of @xmath256 .    while our result agrees with that derived in ref .",
    "@xcite , it gives rise to a serious conceptual inconsistency overlooked in the literature .",
    "it is evident that @xmath257 , and @xmath253 in general increases with the number of energy levels in the target energy range for some fixed @xmath255 .",
    "hence , an unlimited amount of work may be extracted from the system state @xmath4 by simply increasing the number of energy levels in the target energy range of the weight , leading to a violation of the second law .    to resolve this inconsistency",
    ", we note that the additional contribution to @xmath253 in eq .",
    "is _ not _ an intrinsic property of the system state @xmath4 , because it is independent of @xmath4 .",
    "in fact , it arises from the global energy eigenstates in the projective subspace @xmath250 ( and the energy shell @xmath79 ) that are available to the total system when the final weight state is allowed to populate energy levels in the range @xmath246 .",
    "hence , the crucial question as to what is the physical meaning of this additional term needs to be answered . to gain some insight into this question ,",
    "let us consider perfect maximum work extraction from a system state @xmath4 that has full rank . as we have discussed in sec .",
    "[ sec : workextraction ] , no work can be extracted from @xmath4 with certainty ( @xmath172 ) , i.e. , @xmath258 . however , using an analysis similar to that presented in sec .",
    "[ sec : maxwork ] , or simply setting @xmath172 in eq .  , we find @xmath259 which is nonnegative and , even worse , independent of @xmath4 .",
    "thus , by repeating this perfect maximum work extraction process indefinitely for some fixed @xmath260 , an infinite amount of work can be extracted _ with certainty _ from any full - rank system state @xmath4 , even the thermal system state @xmath15 .",
    "in fact , the same arguments apply to the thermal system state @xmath15 .",
    "evidently , this is in contradiction with the complete passivity of the thermal state  @xcite and the second law .",
    "the situation becomes even more problematic for the simple case of a harmonic oscillator - like work storage system with equidistant energy spacing @xmath261 , which was also considered in ref .",
    "@xcite . from eq .",
    ", we find @xmath262 which in the limit of large energy intervals and small energy spacings ( i.e. , @xmath263 ) reduces to @xmath264 clearly , @xmath253 diverges in the limit @xmath261 approaches zero , again signaling a violation of the second law .",
    "therefore , we conclude that the additional term in eq .   should _ not _ be interpreted as work extracted from the system , and hence the maximum extractable work from the system state @xmath4 remains unchanged , i.e. , @xmath265 [ see eq .  ] .",
    "the careful reader may have noticed that the additional term in eq .   is somehow related to the `` free energy '' of the work storage system _ as if _ the latter is in the thermal state @xmath266 at temperature @xmath8 , but with its energy confined in the range @xmath246 .",
    "since the initial weight state is the ground state @xmath77 , which is a pure state and has vanishing free energy , the change in the free energy of the weight at the end of a successful work extraction is then given by @xmath267 intriguingly , the free energy difference of the weight @xmath268 is the `` transfer quantity '' defined in ref .",
    "@xcite for a more general case of work extraction in which transitions between multiple energy levels of the work storage system are consider successful . because the standard formalism of thermal operations requires only strict energy conservation of the total system , but does not forbid energy exchange between the bath and the work storage system [ see fig .",
    "[ fig : fig4](a ) ] , it is conceivable that allowing the final and/or initial states of the weight to occupy multiple energy levels in a certain finite energy range will inevitably cause a spreading of energy across the different levels in the energy range .",
    "this in turn leads to an additional change in the free energy of the weight .",
    "hence , the free energy change of the weight @xmath268 given by eq .",
    "contains an artifact caused by the heat bath  work storage system coupling that is implicitly assumed in the standard formalism of thermal operations . if only transitions from the ground state to single excited states of the weight are consider successful ( i.e. , the case studied in secs .",
    "[ sec : workextraction ] and [ sec : maxwork ] ) then the free energy change of the weight would be the same as the energy stored in the weight , even though the bath and work storage system are implicitly assumed to be coupled to each other .",
    "thus , to remove this artifact we impose the condition @xmath269 ( or , equivalently , the requirement that the free energy change of the weight is exactly the energy it stores despite its coupling to the heat bath ) , and obtain the _ identity _ @xmath270 the physical meaning of this identity is that if we count only the work stored in the weight , then the additional term in eq .",
    "has to be identically zero or , more precisely , _",
    "completely excluded_. clearly , an obvious way to satisfy the identity is to take the limit @xmath271 , i.e. , the limit of infinite precision , as is done in ref .",
    "@xcite to formalize the idea of an energy extraction that is essentially free from fluctuations .",
    "indeed , it is exactly the quest for predictable `` truly '' work - like energy extraction from a quantum system that motivated the study of single - shot work extraction  @xcite . to put it another way , the energy gain of the weight associated with the additional term in eq .",
    "is _ not _ work extracted from the system _ but _ heat transferred from the heat bath , a consequence that the weight is in thermal contact with the heat bath and allowed to populate multiple energy levels at the end of a successful work extraction .",
    "hence , the conceptual inconsistency is clarified and resolved .",
    "our conclusion is in agreement with the result of ref .",
    "@xcite that only predictable energy transfer ( with failure probability @xmath0 ) should count as work , anything beyond that as heat , and allowing population in higher levels of the weight should not change the predicted work , or in our terms , maximum extractable work .",
    "interestingly , the result there is obtained in a _ distinct _",
    "setup in which a traditional thermodynamic definition of work is used without explicitly including a weight .",
    "nevertheless , we are left with two open questions : ( i ) how the standard formalism of thermal operations can be modified to account for realistic situations of work extraction in which the heat bath and work storage system are not in thermal contact , while the latter can populate a certain range of energy levels [ see fig .  [",
    "fig : fig4](b ) ] ; and ( ii ) what is an appropriate notion of work that captures the realistic operation of quantum thermal machines whose work storage system may have a large density of states . while the second question is a part of a long - standing issue in quantum thermodynamics  @xcite , the first question is , to the best of our knowledge , raised for the first time in the present article .    before ending this section , motivated by imperfect work extraction and approximate state formation",
    ", we consider a realistic and physically interesting generalization to approximate , imperfect work extraction with a failure probability of @xmath0 from states @xmath272-close to the desired initial system state @xmath4 for some fixed @xmath272 in trace norm .",
    "according to the analysis presented in secs .",
    "[ sec : workextraction ] and [ sec : workformation ] , the maximum extractable work @xmath273 can be found by maximizing @xmath274 with respect to all diagonal states @xmath275 in the @xmath272-vicinity of the state @xmath4 in trace norm .",
    "hence , we have @xmath276 where @xmath277 is the generalized single - shot free energy defined by in resource - theoretic terms would be the _ doubly smoothed _ version of the min - relative entropy of @xmath4 to @xmath15 . ] @xmath278 with the supremum taken over all states @xmath275 diagonal in the system energy eigenbasis and satisfying @xmath279 .",
    "in this work , using a physically intuitive and mathematically simple approach , we have studied the problem of work extraction from a system in contact with a heat bath to a work storage system , and the reverse problem of state formation from a thermal system state in single - shot quantum thermodynamics .",
    "the maximum extractable work and minimum work cost of formation are derived , and a graphical interpretation of the maximum extractable work , minimum work cost of formation , and corresponding single - shot free energies is presented .",
    "the approach also facilitates a detailed discussion of the necessary and sufficient conditions for both perfect and imperfect maximum work extraction . a seeming violation of the second law concerning the final system state being nonthermal after a maximum work extraction is resolved using arguments based on the fundamental concepts of coherence work - locking  @xcite , quantum typicality  @xcite , and complete passivity  @xcite .",
    "our arguments also strengthen those in the literature  @xcite based solely on quantum typicality .",
    "indeed , it is because of coherence work - locking , i.e. , the phenomenon that under thermal operations and without additional coherence resources , quantum coherence contributes to the free energy but not extractable work , that the initial system states can be assumed to be diagonal in the system eigenbasis .",
    "this approach can be generalized to the case of general work extraction in which transitions from the ground state to multiple energy eigenstates in a certain energy range of the work storage system are considered successful  @xcite .",
    "the resulting maximum extractable work contains an additional contribution that is independent of the initial system state and increases without bound as the density of states of the work storage system increases , thus leading to a violation of the second law and a conceptual inconsistency .",
    "a detailed analysis shows that the additional term should be interpreted _ not _ as work extracted from the system _ but _ as heat transferred from the heat bath , and hence the maximum extractable work from a system state remains unchanged in the general case .",
    "this conclusion agrees with a previous result obtained in a distinct setup in which a traditional thermodynamic definition of work is used and a weight is not explicitly included  @xcite .",
    "the conceptual inconsistency is resolved by recognizing that the additional contribution is an artifact of the standard formalism of thermal operations , in which a coupling between the heat bath and the work storage system is implicitly assumed . to put it another way , if the formalism of thermal operations is generalized straightforwardly to include a work storage system , as is usually done in the literature , then under global unitaries that strictly conserve the total energy , the heat bath , system , and work storage system are inevitably all coupled together .",
    "thus , our analysis calls for a modification of the standard formalism when applied to the physical context in which the heat bath and work storage system are _ not _ in thermal contact .",
    "there are several open questions to be answered .",
    "first , considering the wide use of the thermal operation formalism , a modification of the standard formalism in which there is no coupling between the heat bath and the work storage system is of particular importance .",
    "the underlying rationale for thermal operations is to describe fundamental limitations to thermal transitions in their full generality ; hence , restrictions on the class of allowed operations are kept minimum , and any hamiltonians and couplings are allowed . however , a caveat to this freedom is that no physical principles shall be violated .",
    "clearly , this is not the case when a work storage system is explicitly included , because , as we have shown , the implicitly assumed coupling between the bath and the work storage system could lead to a violation of the second law if special care is not taken .",
    "indeed , the fact that the heat bath and work storage system are not in thermal contact implies that a more limited class of allowed operations that satisfy additional restrictions need to be considered in a modified formalism .",
    "it is not clear at the moment how those additional restrictions can be imposed and what the corresponding class of allowed operations are .",
    "nevertheless , our results strongly suggest that this is an avenue worth pursuing , and the study of general work extraction in the modified formalism may shed light on the problem of an appropriate notion of work in quantum thermodynamics .",
    "second , since the single - shot scenario is in general associated with a worst case scenario , chances are that single - shot work extraction would not be maximum . if a work extraction ( with failure probability @xmath0 ) applied to an initial system state @xmath4 is _ not _ maximum , then a dephasing operation and second work extraction ( with the same failure probability @xmath0 ) can be applied to the final system state @xmath96 to extract more work from the system .",
    "this process can be repeated indefinitely until either a maximum work extraction is achieved , or the eventual final system state is close to the thermal system state @xmath15 . from the analysis presented above ,",
    "it is conceivable that the maximum amount of extracted work in the combined process is given by @xmath280 , in accordance with the second law .",
    "nevertheless , this would take us away from the single - shot regime to an intermediate regime somewhere in between the single - shot and many - runs regimes .",
    "the latter refers to the scenario in which a large number of runs are applied to single systems in the _ same _ initial state  @xcite , which clearly is not the case here",
    ". it would be interesting to study work extraction in this intermediate regime .",
    "last but not least , in the present approach to work extraction the initial system states are assumed to be diagonal in the system energy eigenbasis ; however , a similar approach that can be applied directly to initial system states with coherence in the system energy eigenbasis would be highly desirable .",
    "in particular , the generalized approach will provide a clear manifestation of coherence work - locking and how work is `` unlocked '' in the presence of additional coherence resources .",
    "since the final system states of state formation are in general states with coherence in the system energy eigenbasis , the global unitary transformation @xmath281 for work extraction from quantum states @xmath4 with coherence can be thought of as an inverse state formation followed by a forward one , i.e. , @xmath282 , where @xmath283 with @xmath284 , and @xmath285 , @xmath286 , and @xmath287 are global unitaries . here , for simplicity",
    ", we have assumed that the final state of the system and bath after the work extraction is a product state @xmath75 .",
    "hence , the global states @xmath60 , @xmath67 , and @xmath288 all have the same eigenvalues , which are given by the diagonal elements of @xmath288 . investigation along this line is an interesting future avenue .",
    "we believe that this article leads to a simple understanding of the underlying physics and provides a new insight into these open questions .",
    "i would like to thank g.  auletta and c.n .",
    "leung for a careful reading of the manuscript and useful comments , and m.p .",
    "mller for sharing freely online his handwritten lecture notes on single - shot quantum thermodynamics , through which this fascinating field was first introduced to me ."
  ],
  "abstract_text": [
    "<S> we revisit the problem of work extraction from a system in contact with a heat bath to a work storage system , and the reverse problem of state formation from a thermal system state in single - shot quantum thermodynamics . </S>",
    "<S> a physically intuitive and mathematically simple approach using only elementary majorization theory and matrix analysis is developed , and a graphical interpretation of the maximum extractable work , minimum work cost of formation , and corresponding single - shot free energies is presented . </S>",
    "<S> this approach provides a bridge between two previous methods based respectively on the concept of thermomajorization and a comparison of subspace dimensions . </S>",
    "<S> in addition , a conceptual inconsistency with regard to general work extraction involving transitions between multiple energy levels of the work storage system is clarified and resolved . </S>",
    "<S> it is shown that an additional contribution to the maximum extractable work in those general cases should be interpreted _ not _ as work extracted from the system _ but _ as heat transferred from the heat bath . </S>",
    "<S> indeed , the additional contribution is an artifact of the thermal operation formalism , wherein a coupling between the heat bath and the work storage system is implicitly assumed . </S>",
    "<S> the result calls for a modification of the formalism when applied to realistic work extraction problems in which the heat bath and work storage system are not in thermal contact . </S>"
  ]
}