{
  "article_text": [
    "to motivate our study of hilbert modular forms , we begin by briefly considering algorithms for classical ( elliptic ) modular forms . for a more detailed introduction to modular forms ,",
    "see the books by darmon @xcite and diamond and shurman @xcite , and for more information on computational aspects see cremona @xcite , kilford @xcite , stein @xcite , and the many references contained therein .",
    "let @xmath9 denote the upper - half plane and let @xmath10 denote the completed upper half - plane with the _ cusps _ @xmath11 .",
    "the group @xmath12 acts on @xmath13 by linear fractional transformations . for @xmath14",
    ", we consider the subgroup of those integral matrices of determinant @xmath7 that are upper - triangular modulo @xmath15 , @xmath16 the group @xmath17 is a discrete subgroup of @xmath18 . a _ modular form _ of weight @xmath19 and level",
    "@xmath15 is a holomorphic function @xmath20 such that @xmath21 for all @xmath22 and such that @xmath23 tends to a finite limit as @xmath24 tends to any cusp ( i.e. , @xmath25 is holomorphic at the cusps ) .",
    "one can equivalently write this as follows . for @xmath26 and @xmath27",
    "we define @xmath28 .",
    "we then define a _",
    "weight @xmath5 action _ of @xmath29 on the space of complex - valued functions on @xmath30 by @xmath31 then ( [ fgammaz ] ) is equivalent to @xmath32 for all @xmath33 .",
    "note that the determinant factor @xmath34 in our definition is different from the usual @xmath35 , which is an analytic normalization .",
    "consequently , the central subgroup @xmath36 acts by @xmath37 .    for simplicity we treat only the case of @xmath38-level structure in this article .",
    "if desired , one could without difficulty extend our methods to more general level structures with characters , and so on .",
    "the @xmath39-vector space of modular forms of weight @xmath5 and level @xmath15 is finite - dimensional and is denoted @xmath40 .    if @xmath41 , then @xmath42 so @xmath25 has a fourier expansion @xmath43 where @xmath44 and @xmath45 .",
    "we say that @xmath25 is a _ cusp form _ if @xmath46 as @xmath24 tends to any cusp ( i.e. , @xmath25 vanishes at the cusps ) .",
    "the @xmath39-vector space of cusp forms of weight @xmath5 and level @xmath15 is denoted @xmath47 .",
    "we have @xmath48 where @xmath49 is spanned by the eisenstein series of level @xmath15 .",
    "note that when @xmath50 , then ( [ fgammaz ] ) is equivalent to @xmath51 so one may equivalently think of a cusp form @xmath52 as a holomorphic differential @xmath53-form on the _ modular curve _ @xmath54 .",
    "( because of our normalization , such differential forms will be global sections of the line bundle corresponding to the algebraic local system @xmath55 , corresponding to bivariate homogeneous polynomials of degree @xmath56 .",
    "some authors use an analytic normalization instead . )",
    "the spaces @xmath40 and @xmath47 are equipped with an action of pairwise commuting diagonalizable _ hecke operators _",
    "@xmath57 for each integer @xmath58 .",
    "the hecke operators can be thought of in several different ways : they arise from correspondences on the modular curve @xmath59 , as `` averaging '' operators over lattices of index @xmath60 , or more formally from double coset decompositions for the group @xmath38 inside @xmath61 .",
    "the action of the hecke operator @xmath57 is determined by the action of @xmath62 for @xmath63 , and the latter for @xmath64 in weight @xmath5 are given simply by the formula @xmath65 ( for primes @xmath66 one omits the first term , and there are also operators called _ atkin - lehner involutions_. ) we say therefore that @xmath47 is a _ hecke module _ , namely , an abelian group equipped with an action of the _ hecke algebra _ @xmath67_p={{\\mathbb{z}}}[t_2,t_3,\\dots]$ ] , a polynomial ring in countably many variables over @xmath68 indexed by the primes .",
    "our hecke modules will always be finite - dimensional @xmath39-vector spaces .",
    "a form @xmath52 is an _ oldform ( at @xmath69 ) _ if @xmath70 for some @xmath71 with @xmath72 a proper divisor and @xmath73 ; we say @xmath25 is a _ newform _ if @xmath25 is a normalized eigenform which is orthogonal to the space of oldforms ( with respect to the petersson inner product ) .",
    "the space @xmath47 consequently has a basis of _ eigenforms _ , i.e. , functions that are eigenfunctions for each hecke operator @xmath57 .",
    "if @xmath25 is an eigenform , _ normalized _ so that @xmath74 in its @xmath75-expansion ( [ qexpclassical ] ) , then @xmath76 . moreover , the field @xmath77 is a number field and each _ hecke eigenvalue _",
    "@xmath78 is an algebraic integer in @xmath79 .    in this way ,",
    "the system of hecke eigenvalues @xmath80 for a normalized eigenform @xmath52 determine the form @xmath20 .",
    "these eigenvalues also determine the @xmath81-series @xmath82 associated to @xmath25 ( defined for @xmath83 ) , as well as the @xmath84-adic galois representations @xmath85 associated to @xmath25 with the property that for any prime @xmath86 , we have @xmath87    several methods have been proposed for making the hecke module @xmath47 into an object amenable to explicit computation . with a view to their generalizations to hilbert modular forms , we mention two approaches which have seen wide application .",
    "( we neglect the method of graphs @xcite and a method which uses the eichler - selberg trace formula @xcite . ) for simplicity , we restrict our discussion to the case of weight @xmath88 .",
    "the first method goes by the name _",
    "modular symbols _ and has been developed by birch , swinnerton - dyer , manin , mazur , merel , cremona @xcite , stein @xcite , and many others . the hecke operators @xmath62 act naturally on the integral homology @xmath89linear combinations of paths in the completed upper half plane @xmath13 whose endpoints are cusps and whose images in @xmath59 are linear combinations of loops  and integration defines a nondegenerate hecke - equivariant pairing which gives rise to an isomorphism ( the eichler - shimura theorem ) @xmath90 where @xmath91 denotes complex conjugation .",
    "the formalism of modular symbols then presents the space @xmath89 explicitly in terms of paths in @xmath13 whose endpoints are cusps ( elements of @xmath11 ) and whose images in @xmath59 are a linear combination of loops .",
    "we have an explicit description of the action of the hecke operators on the space of modular symbols , and the _ manin trick _ ( the euclidean algorithm ) yields an algorithm for writing an arbitrary modular symbol as a @xmath68-linear combination of a finite set of generating symbols , thereby recovering @xmath92 as a hecke module .",
    "the second method goes by the name _",
    "brandt matrices _ and goes back to brandt , eichler @xcite , pizer @xcite , kohel @xcite , and others .",
    "in this approach , a basis for @xmath92 is obtained by linear combinations of theta series associated to ( right ) ideals in a quaternion order of discriminant @xmath15 .",
    "these theta series are generating series which encode the number of elements in the ideal with a given reduced norm , and the brandt matrices which represent the action of the hecke operators are obtained via this combinatorial ( counting ) data .",
    "we now consider the situation where the classical modular forms from the previous section are replaced by forms over a totally real field .",
    "references for hilbert modular forms include freitag @xcite , van der geer @xcite and goren @xcite .",
    "let @xmath1 be a totally real field with @xmath93=n$ ] and let @xmath94 be its ring of integers .",
    "the case @xmath95 gives @xmath96 and this was treated in the previous section , so we assume throughout this section that @xmath97 . let @xmath98 be the real places of @xmath1 , and write @xmath99 . for @xmath100",
    "we write @xmath101 .",
    "for simplicity , in these first few sections (   26 ) we assume that @xmath1 has strict class number 1 ; the general case , which is more technical , is treated in  7 and thereafter .",
    "the group @xmath102 acts naturally on @xmath103 by coordinatewise linear fractional transformations @xmath104 for a nonzero ideal @xmath105 , let @xmath106    let @xmath107 .",
    "then the image of @xmath108 under the embeddings @xmath109 is a discrete subgroup of @xmath110 .    under the assumption that @xmath1 has strict class number @xmath7 , we have @xmath111 and hence @xmath112 , and so alternatively we may identify @xmath113 in analogy with the case @xmath96 .",
    "[ hilbclass ] a _ hilbert modular form _ of parallel weight @xmath6 and level @xmath2 is a holomorphic function @xmath114 such that @xmath115 for all @xmath116 .",
    "we denote by @xmath117 the space of hilbert modular forms of parallel weight @xmath6 and level @xmath2 ; it is a finite - dimensional @xmath39-vector space .",
    "the reader is warned not to confuse @xmath117 with the ring @xmath118 of @xmath119-matrices over a ring @xmath120 .",
    "there is no holomorphy condition at the cusps in definition [ hilbclass ] as there was for classical modular forms . indeed , under our assumption that @xmath93=n>1 $ ]",
    ", this follows automatically from koecher s principle  @xcite .",
    "note also that if @xmath121 , then @xmath122 acts trivially on @xmath30 and at the same time gives a vacuous condition in ( [ slashfz ] ) , explaining the appearance of the determinant term which was missing in the classical case .",
    "analogous to ( [ fslsh ] ) , we define @xmath123 for @xmath124 and @xmath125 ; then ( [ slashfzquat ] ) is equivalent to @xmath126 for all @xmath127 .",
    "the group @xmath128 also acts naturally on the _ cusps _ @xmath129 .",
    "we say that @xmath130 is a _ cusp form _ if @xmath46 whenever @xmath24 tends to a cusp , and we denote the space of cusp forms ( of parallel weight @xmath6 and level @xmath2 ) by @xmath131 .",
    "we have an orthogonal decomposition @xmath132 where @xmath133 is spanned by eisenstein series of level @xmath2 ; for level @xmath134 , we have @xmath135 , where @xmath136 denotes the strict class group of @xmath94 .",
    "hilbert modular forms admit fourier expansions as follows . for a fractional ideal @xmath137 of @xmath1 ,",
    "let @xmath138 let @xmath139 be the different of @xmath1 , and let @xmath140 denote the inverse different .",
    "a hilbert modular form @xmath141 admits a fourier expansion @xmath142 with @xmath143 if @xmath25 is a cusp form .",
    "let @xmath130 and let @xmath144 be a nonzero ideal . then under our hypothesis that @xmath1 has strict class number @xmath7 , we may write @xmath145 for some @xmath146 ; we then define @xmath147 .",
    "the transformation rule ( [ slashfz ] ) implies that @xmath148 does not depend on the choice of @xmath149 , and we call @xmath148 the _ fourier coefficient _ of @xmath25 at @xmath150 .",
    "the spaces @xmath117 and @xmath131 are also equipped with an action of pairwise commuting diagonalizable _ hecke operators _ @xmath151 indexed by the nonzero ideals @xmath150 of @xmath94 .",
    "for example , given a prime @xmath152 and a totally positive generator @xmath153 of @xmath154 we have @xmath155 where @xmath156 is the residue field of @xmath154 ; this definition is indeed independent of the choice of generator @xmath153 . using the notation ( [ fslshhilb ] ) , we can equivalently write @xmath157 where @xmath158 and @xmath159 for @xmath160 .    if @xmath161 is an eigenform ,",
    "_ normalized _ so that @xmath162 , then @xmath163 , and each eigenvalue @xmath148 is an algebraic integer which lies in the number field @xmath164 ( see shimura  ( * ? ? ?",
    "* section 2 ) ) generated by the fourier coefficients of @xmath25 .",
    "we again have notions of _ oldforms _ and _ newforms _ , analogously defined ( so that a newform is in particular a normalized eigenform ) .    associated to an eigenform @xmath161 we have an @xmath81-function @xmath165 and @xmath166-adic galois representations @xmath167 for primes @xmath166 of @xmath94 such that , for any prime @xmath168 , we have @xmath169 each of these is determined by the hecke eigenvalues @xmath148 of @xmath25 , so we are again content to compute @xmath131 as a hecke module .",
    "we are now ready to state the first version of our main result .",
    "[ mainthmclno1 ] there exists an algorithm which , given a totally real field @xmath1 of strict class number @xmath7 and a nonzero ideal @xmath105 , computes the space @xmath131 of hilbert cusp forms of parallel weight @xmath6 and level @xmath2 over @xmath1 as a hecke module .    in other words , there exists an explicit finite procedure which takes as input the field @xmath1 and the ideal @xmath105 encoded in bits ( in the usual way , see e.g.  cohen @xcite ) , and outputs a finite set of sequences @xmath170 encoding the hecke eigenvalues for each cusp form constituent @xmath25 in @xmath131 , where @xmath171 .",
    "( this algorithm will produce any finite subsequence in a finite amount of time , but in theory will produce the entire sequence if it is left to run forever . ) alternatively , this algorithm can simply output matrices for the hecke operators @xmath172 ; one recovers the constituent forms using linear algebra .",
    "let @xmath173 . then @xmath174 $ ] where @xmath175 satisfying @xmath176 .",
    "let @xmath177 ; we have @xmath178 is prime .",
    "we compute that @xmath179 .",
    "there are @xmath6 hecke irreducible subspaces of dimensions @xmath7 and @xmath180 , corresponding to newforms @xmath25 and @xmath181 ( and its galois conjugates ) .",
    "we have the following table of eigenvalues ; we write @xmath182 for @xmath183 .",
    "@xmath184 here , the element @xmath185 satisfies @xmath186 and @xmath187 is an @xmath188-field of discriminant 148 .    recall that in the method of modular symbols , a cusp form @xmath189 corresponds to a holomorphic differential ( 1-)form @xmath190 on @xmath59 and",
    "so , by the theorem of eichler - shimura , arises naturally in the space @xmath191 . in a similar way",
    ", a hilbert cusp form @xmath161 gives rise to a holomorphic differential @xmath60-form @xmath192 on the _ hilbert modular variety _",
    "@xmath193 , the desingularization of the compact space @xmath194 where @xmath195 .",
    "but now @xmath196 is an algebraic variety of complex dimension @xmath60 and @xmath25 arises in the cohomology group @xmath197 . computing with higher dimensional varieties ( and higher degree cohomology groups )",
    "is not an easy task !",
    "so we seek an alternative approach .",
    "langlands functoriality predicts that @xmath131 as a hecke module occurs in the cohomology of other `` modular '' varieties as well .",
    "this functoriality was already evident by the fact that both modular symbols and their quaternionic variant , brandt matrices , can be used to compute the classical space @xmath92 .",
    "in our situation , this functoriality is known as the jacquet - langlands correspondence , which ultimately will allow us to work with varieties of complex dimension @xmath7 or @xmath198 by considering twisted forms of @xmath199 over @xmath1 arising from quaternion algebras . in dimension @xmath7",
    ", we will arrive at an algorithm which works in the cohomology of a shimura curve , analogous to a modular curve , and thereby give a kind of analogue of modular symbols ; in dimension @xmath198 , we generalize brandt matrices by working with theta series on ( totally definite ) quaternion orders .",
    "in this section , we define modular forms on quaternion algebras ; our main reference is hida @xcite . we retain the notation of the previous section ; in particular , @xmath1 is a totally real field of degree @xmath93=n$ ] with ring of integers @xmath94 .",
    "a _ quaternion algebra _ @xmath200 over @xmath1 is a central simple algebra of dimension @xmath201 .",
    "equivalently , a quaternion algebra @xmath200 over @xmath1 is an @xmath1-algebra generated by elements @xmath202 satisfying @xmath203 for some @xmath204 ; we denote such an algebra @xmath205 . for more information about quaternion algebras , see vignras @xcite .",
    "let @xmath200 be a quaternion algebra over @xmath1",
    ". then @xmath200 has a unique involution @xmath206 called _ conjugation _ such that @xmath207 for all @xmath208 ; we define the _ reduced norm _ of @xmath209 to be @xmath210 . for @xmath205 as in ( [ quateq ] ) and @xmath211 , we have @xmath212    a @xmath94-_lattice _ of @xmath200 is a finitely generated @xmath94-submodule @xmath213 of @xmath200 such that @xmath214 . an _ order",
    "_ @xmath215 of @xmath200 is a @xmath94-lattice which is also a subring of @xmath200 .",
    "a _ maximal order _ of @xmath200 is an order which is not properly contained in any other order .",
    "let @xmath216 be a maximal order in @xmath200 .",
    "a _ right fractional @xmath215-ideal _ is a @xmath94-lattice @xmath213 such that its _",
    "right order _",
    "@xmath217 is equal to @xmath215 ; left ideals are defined analogously .",
    "let @xmath218 be a field containing @xmath1 .",
    "then @xmath219 is a quaternion algebra over @xmath220 , and we say @xmath220 _ splits _",
    "@xmath200 if @xmath221 .    let @xmath222 be a noncomplex place of @xmath1 , and let @xmath223 denote the completion of @xmath1 at @xmath222",
    ". then there is a unique quaternion algebra over @xmath223 which is a division ring , up to isomorphism .",
    "we say @xmath200 is _ unramified _ ( or _ split _ ) at @xmath222 if @xmath223 splits @xmath200 , otherwise we say @xmath200 is _ ramified _ at @xmath222 .",
    "the set @xmath224 of ramified places of @xmath200 is a finite set of even cardinality which characterizes @xmath200 up to isomorphism , and conversely given any such set @xmath224 there is a quaternion algebra over @xmath200 ramified exactly at the places in @xmath224 .",
    "we define the _ discriminant _ @xmath225 of @xmath200 to be the ideal of @xmath94 given by the product of all finite ramified places of @xmath200 .",
    "let @xmath105 be an ideal which is coprime to the discriminant @xmath225 .",
    "then there is an isomorphism @xmath226 where @xmath227 denotes the completion of @xmath94 at @xmath2 .",
    "let @xmath228 the order @xmath229 is called an _",
    "eichler order _ of level @xmath2 .",
    "we will abbreviate @xmath230 .",
    "we number the real places @xmath231 of @xmath1 so that @xmath200 is split at @xmath232 and ramified at @xmath233 , so that @xmath234 where @xmath235 is the division ring of hamiltonians .",
    "if @xmath200 is ramified at all real places ( i.e.  @xmath236 ) then we say that @xmath200 is _",
    "( totally ) definite _ , and otherwise we say @xmath200 is _ indefinite_. the arithmetic properties of the algebra @xmath200 and its forms are quite different according as @xmath200 is definite or indefinite , and so we consider these two cases separately",
    ". using an adelic language , one can treat them more uniformly ( though to some extent this merely repackages the difference)we refer to  8 for this approach .",
    "first , suppose that @xmath200 is indefinite , so that @xmath237 .",
    "the case @xmath238 corresponds to the classical case of elliptic modular forms ; this was treated in  1 , so we assume @xmath239 .",
    "let @xmath240 denote the map corresponding to the split embeddings @xmath232 .",
    "then the group @xmath241 acts on @xmath242 by coordinatewise linear fractional transformations .",
    "let @xmath243 under the assumption that @xmath1 has strict class number @xmath7 , which we maintain , we have @xmath244 where @xmath245 .",
    "let @xmath246 and let @xmath247 .",
    "then @xmath248 is a discrete subgroup of @xmath249 which can be identified with @xmath250    [ quatcuspformindef ] let @xmath200 be indefinite .",
    "quaternionic modular form _ for @xmath200 of parallel weight @xmath6 and level @xmath2 is a holomorphic function @xmath251 such that @xmath252 for all @xmath253 .",
    "analogous to ( [ fslshhilb ] ) , we define @xmath254 for @xmath251 and @xmath255 ; then ( [ slashfzquat ] ) is equivalent to @xmath126 for all @xmath256 .",
    "we denote by @xmath257 the space of quaternionic modular forms for @xmath200 of parallel weight @xmath6 and level @xmath2 , a finite - dimensional @xmath39-vector space .",
    "a quaternionic modular form for @xmath258 is exactly a hilbert modular form over @xmath1 ; our presentation in these three sections has been consciously redundant so as to emphasize this similarity .",
    "( we could recover the definition of cusp forms given in section 1 if we also impose the condition that the form vanish at the cusps . ) as we will see later , this similarity is less apparent when the general and more technical theory is exposited .",
    "the hecke operators are defined on @xmath257 following their definition in ( [ heckehilbertslsh ] ) .",
    "let @xmath154 be a prime of @xmath94 with @xmath152 , and let @xmath153 be a totally positive generator of @xmath154 . define @xmath259 the set @xmath260 has cardinality @xmath261 .",
    "the hecke operator @xmath172 is then given by @xmath262    the set @xmath260 admits an explicit description as follows . as above , let @xmath263 be the residue field of @xmath154 , and let @xmath264 be a splitting .",
    "then the set @xmath260 is in bijection with the set of left ideals of @xmath215 by @xmath265 .",
    "this set of left ideals is in bijection ( * ? ? ?",
    "* lemma 6.2 ) with the set @xmath266 : explicitly , given the splitting @xmath267 , the left ideal corresponding to @xmath268 is @xmath269 by strong approximation ( * ? ? ?",
    "* thorme iii.4.3 ) , each of the ideals @xmath270 is principal , so @xmath271 with @xmath272 for all @xmath273 .",
    "therefore , we have @xmath274 .",
    "this definition reduces to the one given in ( [ heckehilbertslsh ] ) for hilbert modular forms with the choices @xmath158 and @xmath159 for @xmath160 .",
    "having treated hilbert modular forms in the previous section , now suppose that @xmath275 , or equivalently that @xmath200 is a division ring",
    ". then a modular form is vacuously a cusp form as there are no cusps !",
    "we then refer to quaternionic modular forms equally well as _",
    "quaternionic cusp forms _ and let @xmath276 . here",
    ", a cusp form @xmath25 gives a holomorphic differential @xmath277-form @xmath278 on the associated _ quaternionic shimura variety _",
    "@xmath279 , a complex variety of dimension @xmath277 .    the important case for us will be when @xmath280 .",
    "then @xmath281 acts on the upper half - plane and the quotient @xmath282 can be given the structure of a riemann surface , known as a _",
    "shimura curve_. in this simple case , a cusp form for @xmath200 is simply a holomorphic map @xmath20 such that @xmath283 for all @xmath256 , where @xmath284 and @xmath285 is the unique split real place of @xmath1 .",
    "next , suppose that @xmath200 is definite , so that @xmath236 .",
    "recall that @xmath286 is an eichler order of level @xmath2 . a right fractional",
    "@xmath215-ideal is _ invertible _ if there exists a left fractional @xmath215-ideal @xmath287 such that @xmath288 , or equivalently if @xmath213 is _ locally principal _ , i.e. , for each ( finite ) prime ideal @xmath154 of @xmath94 , the ideal @xmath289 is a principal right @xmath290-ideal .",
    "if @xmath213 is invertible , then necessarily @xmath291 .",
    "let @xmath292 be invertible right fractional @xmath215-ideals .",
    "we say that @xmath213 and @xmath293 are in the same _ right ideal class _ ( or are _ isomorphic _ ) if there exists an @xmath294 such that @xmath295 , or equivalently if @xmath213 and @xmath293 are isomorphic as right @xmath215-modules .",
    "we write @xmath296 $ ] for the equivalence class of @xmath213 under this relation and denote the set of invertible right @xmath215-ideal classes by @xmath297 .",
    "the set @xmath297 is finite and @xmath298 is independent of the choice of eichler order @xmath230 of level @xmath2 .",
    "let @xmath200 be definite .",
    "quaternionic modular form _ for @xmath200 of parallel weight @xmath6 and level @xmath2 is a map @xmath299    the space of quaternionic modular forms @xmath257 is obviously a @xmath39-vector space of dimension equal to @xmath300 .    a modular form for @xmath200 which is orthogonal to the ( @xmath7-dimensional ) subspace of constant functions is called a _ cusp form _ for @xmath200 ; the space of such forms is denoted @xmath301 .    the hecke operators are defined on @xmath257 as follows .",
    "let @xmath154 be a prime ideal of @xmath94 with @xmath152 .",
    "for a right @xmath215-ideal @xmath213 with @xmath302 coprime to @xmath154 , the hecke operator @xmath172 is given by @xmath303 ) = \\sum_{\\substack{j \\subseteq   i \\\\ \\operatorname{nrd}(j i^{-1})={\\mathfrak{p } } } } f([j]),\\ ] ] the sum over all invertible right @xmath215-ideals @xmath304 such that @xmath305 . as in ( [ heckeindefinite ] ) , this sum is also naturally over @xmath266 , indexing the ideals of norm index @xmath154 .",
    "this definition does not depend on the choice of representative @xmath213 in its ideal class and extends by linearity to all of @xmath301 .",
    "consequent to the definitions in the previous paragraphs , we may now consider the hecke modules of quaternionic cusp forms over @xmath1 for the different quaternion algebras @xmath200 over @xmath1 .",
    "these spaces are related to each other , and thus to spaces of hilbert modular forms , according to their arithmetic invariants by the _ jacquet - langlands correspondence _ as follows .",
    "[ shimizuclno1 ] let @xmath200 be a quaternion algebra over @xmath1 of discriminant @xmath225 and let @xmath2 be an ideal coprime to @xmath225 .",
    "then there is an injective map of hecke modules @xmath306 whose image consists of those hilbert cusp forms which are new at all primes @xmath307 .",
    "see jacquet and langlands  ( * ? ? ?",
    "xvi ) , gelbart and jacquet @xcite and work of hida  @xcite ; another useful reference is hida ( * ? ? ?",
    "* proposition 2.12 ) who deduces theorem [ shimizuclno1 ] from the representation theoretic results of jacquet and langlands .",
    "theorem  [ shimizuclno1 ] yields an isomorphism @xmath308 when the quaternion algebra @xmath200 has discriminant @xmath309 . since a quaternion algebra",
    "must be ramified at an even number of places , when @xmath310 $ ] is even we can achieve this for the definite quaternion algebra @xmath200 which is ramified at exactly the real places of @xmath1 ( and no finite place ) .",
    "when @xmath60 is odd , the simplest choice is to instead take @xmath200 to be ramified at all but one real place of @xmath1 ( and still no finite place ) , and hence @xmath200 is indefinite ( and @xmath311 ) .",
    "[ rmkgenspace ] note that in general a space of newforms can be realized as a hecke module inside many different spaces of quaternionic cusp forms . indeed , for any factorization @xmath312 with @xmath225 squarefree and @xmath2 coprime to @xmath225",
    ", we consider a quaternion algebra @xmath200 of discriminant @xmath225 ( ramified at either all or all but one real place of @xmath1 ) and thereby realize @xmath313 .",
    "for example , if @xmath314 are ( rational ) primes , then the space @xmath315 of classical newforms can , after splitting off old subspaces , be computed using an indefinite quaternion algebra of discriminant @xmath7 or @xmath316 ( corresponding to a modular curve or a shimura curve , respectively ) or a definite quaternion algebra of discriminant @xmath153 or @xmath75 .",
    "our main conclusion from this section is that to compute spaces of hilbert cusp forms it suffices to compute instead spaces of quaternionic cusp forms . the explicit description of @xmath301 as a hecke module varies according as if @xmath200 is definite or indefinite .",
    "in this section , we discuss a method for computing hilbert modular forms using a definite quaternion algebra @xmath200 .",
    "we continue with our notation and our assumption that @xmath1 has strict class number @xmath7 .",
    "we accordingly call the method in this section the _ definite method _ : it is a generalization of the method of brandt matrices mentioned briefly in  2 and was first exhibited by eichler @xcite and pizer  @xcite for @xmath96 , but the first explicit algorithm was given by socrates and whitehouse @xcite .",
    "let @xmath317 be a set of representative right ideals for @xmath297 , with @xmath318 . as vector spaces , we have simply that @xmath319 associating to each ideal ( class ) its characteristic function .",
    "let @xmath320 be the left order of @xmath321 and let @xmath322 .",
    "the action of the hecke operators is defined by ( [ heckedefdefinite ] ) : we define the @xmath154th-_brandt matrix _",
    "@xmath323 for @xmath215 to be the matrix whose @xmath324th entry is equal to @xmath325=[i_i ] \\ }",
    "\\in { { \\mathbb{z}}}.\\ ] ] the brandt matrix @xmath323 is an @xmath326-matrix with integral entries such that the sum of the entries in each column is equal to @xmath261 . the hecke operator @xmath172 then acts by @xmath323 on @xmath327 ( on the right ) , identifying an ideal class with its characteristic function .",
    "the brandt matrix is just a compact way of writing down the adjacency matrix of the graph with vertices @xmath328 where there is a directed edge from @xmath321 to each ideal class which represents an ideal of index @xmath329 in @xmath321 .",
    "indeed , consider the graph whose vertices are right @xmath215-ideals of norm a power of @xmath154 and draw a directed edge from @xmath213 to @xmath293 if @xmath330 .",
    "then this graph is a @xmath5-regular tree with @xmath261 edges leaving each vertex .",
    "the above adjacency matrix is obtained by taking the quotient of this graph by identifying two ideals if they are in the same ideal class .",
    "alternatively , we may give an expression for the brandt matrices in terms of elements instead of ideals .",
    "a containment @xmath331 of right @xmath215-ideals with @xmath332=[j]$ ] corresponds to an element @xmath333 via @xmath334 , and we have @xmath330 if and only if @xmath335 .",
    "writing @xmath336 , we see that @xmath209 is unique up to multiplication on the right by @xmath337 .",
    "we have @xmath338 and @xmath339 , so @xmath340 . to eliminate the contribution of the factor @xmath341 , we normalize as follows :",
    "let @xmath153 be a totally positive generator for @xmath154 and similarly @xmath342 for @xmath343 for @xmath344 .",
    "then @xmath345 can be chosen so that @xmath346 and is unique up to multiplication by @xmath347 .",
    "@xmath348    the advantage of the expression ( [ bijquad ] ) is that it can be expressed simply in terms of a quadratic form .",
    "since @xmath200 is definite , the space @xmath349 comes equipped with the positive definite quadratic form @xmath350 .",
    "if @xmath293 is a @xmath94-lattice , then @xmath351 embeds as a euclidean lattice @xmath352 with respect to this quadratic form .",
    "it follows that one can compute @xmath353 by computing all elements @xmath354 such that @xmath355 , a finite set .    before giving references for the technical details about how the brandt matrices above are computed explicitly , we pause to give three examples .    [ defexmoverqq ]",
    "consider the quaternion algebra @xmath356 , so that @xmath200 is generated by @xmath202 subject to @xmath357 , @xmath358 and @xmath359 .",
    "we have the maximal order @xmath360 where @xmath361 .",
    "we consider the prime @xmath362 ; we have an embedding @xmath363 where @xmath364 .",
    "we begin by computing the ideal classes in @xmath215 .",
    "we start with @xmath365 $ ] .",
    "we have @xmath180 ideals of norm @xmath6 , namely @xmath366 , @xmath367 , and @xmath368 .",
    "if one of these ideals is principal , then it is generated by an element of reduced norm @xmath6 .",
    "the reduced norm gives a quadratic form @xmath369 we see immediately that @xmath370 if and only if @xmath371 and @xmath372 .",
    "this shows that @xmath373 is principal but @xmath374 and @xmath375 are not .",
    "note also that we find @xmath376 solutions matching ( [ bijquad ] ) .",
    "we notice , however , that @xmath377 , so we have just a second ideal class @xmath378 $ ] .",
    "now of the two ideals contained in @xmath375 of norm @xmath201 , we have @xmath379 belongs to @xmath380 whereas @xmath381 gives rise to a new ideal class @xmath382 $ ] . if we continue ,",
    "each of the two ideals contained in @xmath383 of norm @xmath384 belong to @xmath380 , and it follows that @xmath385 .    from this computation ,",
    "we have also computed the brandt matrix @xmath386 .",
    "indeed , the first column encodes the fact that of the three right @xmath215-ideals of reduced norm @xmath6 , there is one which is principal and hence belongs to @xmath380 and two that belong to @xmath387 .",
    "we think of this matrix as acting on the right on row vectors .",
    "the characteristic polynomial of @xmath388 factors as @xmath389 .",
    "the vector @xmath390 is an eigenvector with eigenvalue @xmath180 which generates the space of constant functions and gives rise to the eisenstein series having eigenvalues @xmath391 for all primes @xmath392 .",
    "the space of cusp forms @xmath393 is correspondingly of dimension @xmath6 and is irreducible as a hecke module .",
    "the hecke module @xmath393 can be explicitly identified with @xmath394 using theta correspondence .",
    "for example , the series @xmath395 is the @xmath75-expansion of a modular form of level @xmath396 and weight @xmath6 and corresponds to ( the characteristic of ) @xmath380 . for more details",
    ", we refer to pizer  ( * ? ? ?",
    "* theorem 2.29 ) , where the first computer algorithm for computing brandt matrices over @xmath0 is also described .",
    "now we give an example over a quadratic field .",
    "[ defexmqsrt5 ] let @xmath173 . then @xmath174 $ ] where @xmath175 satisfying @xmath176 .",
    "the prime @xmath397 splits in @xmath1 ; let @xmath398 be one of the primes above it .",
    "we consider the ( hamilton ) quaternion algebra @xmath399 over @xmath1 of discriminant @xmath309 .",
    "we have the maximal order @xmath400 and the eichler order @xmath401 of level @xmath2 given by @xmath402    the class number of @xmath215 is @xmath403 .",
    "the following ideals give a set of representatives for @xmath297 : we take @xmath404 , @xmath405 and @xmath406 .",
    "we compute the orders @xmath407 as @xmath408 , @xmath409 and @xmath410 .",
    "for example , the element @xmath411 satisfies the equation @xmath412 , and so yields an element of order @xmath6 in @xmath413 .",
    "it follows that none of these orders are isomorphic ( i.e. , conjugate ) in @xmath200 .",
    "the first few brandt matrices are : @xmath414 we note that @xmath415 .",
    "for example , the first column of the matrix @xmath388 records the fact that of the @xmath416 right @xmath215-ideals of norm @xmath417 , there is exactly one which is principal , two are isomorphic to @xmath418 and the other two are isomorphic to @xmath419 .",
    "the space @xmath301 of cusp forms is an irreducible 2-dimensional hecke module , represented by a constituent form @xmath25 with corresponding eigenvector @xmath420 .",
    "in particular , the ring of hecke operators @xmath421 $ ] restricted to @xmath25 is equal to @xmath422 $ ] , by coincidence .",
    "we have the following table of eigenvalues for @xmath25 . @xmath423 for further discussion of the geometric objects which arise from this computation ,",
    "see the discussion in section  [ sec : examples-1 ] .",
    "finally , one interesting example .",
    "let @xmath424 and let @xmath425 .",
    "then there exists a cusp form constituent of an irreducible space of dimension @xmath384 in @xmath131 such that no single hecke eigenvalue generates the entire field @xmath79 of hecke eigenvalues . @xmath426",
    "\\\\ & & e={{\\mathbb{q}}}(\\sqrt{17},i,\\sqrt{u } ) \\ar@{-}[dl ] \\ar@{-}[d ] \\ar@{-}[dr ] \\\\ & { { \\mathbb{q}}}(i,\\sqrt{17 } ) \\ar@{-}[dl ] \\ar@{-}[d ] \\ar@{-}[dr ] &   { { \\mathbb{q}}}(\\sqrt{17},\\sqrt{u } ) \\ar@{-}[d ] & { { \\mathbb{q}}}(\\sqrt{17},\\sqrt{-u } ) \\ar@{-}[dl ] \\\\ { { \\mathbb{q}}}(\\sqrt{-17 } ) \\ar@{-}[dr ] & { { \\mathbb{q}}}(i ) \\ar@{-}[d ] & { { \\mathbb{q}}}(\\sqrt{17 } ) \\ar@{-}[dl ] \\\\ & { { \\mathbb{q}}}}\\ ] ] here , @xmath427 and @xmath428 is the galois closure of @xmath79 .",
    "each hecke eigenvalue @xmath429 for this form @xmath25 generates a proper subfields of @xmath79 .",
    "( there are also examples of this phenomenon over @xmath0 , and they are related to the phenomenon of inner twists ; this was analyzed over @xmath0 by koo , stein , and wiese @xcite . )    with these examples in hand , we now give an overview of how these computations are performed ; for more detail , see work of the first author @xcite .",
    "it is clear we need several algorithms to compute brandt matrices .",
    "first , we need a basic suite of algorithms for working with quaternion orders and ideals ; these are discussed in work of kirschmer and the second author ( * ? ? ?",
    "* section 1 ) , and build on basic tools for number rings by cohen @xcite . as part of this suite , we need a method to compute a maximal order , which is covered by work of the second author @xcite .",
    "next , we need to compute a set of representatives for @xmath297 and to test if two right @xmath215-ideals are isomorphic : this is covered by kirschmer and the second author ( * ? ? ?",
    "* sections 67 ) , including a runtime analysis . to compute a set of representatives ,",
    "we use direct enumeration in the tree as in example [ defexmoverqq ] and a mass formula due to eichler as an additional termination criterion . to test for isomorphism",
    ", we use lattice methods to find short vectors with respect to the quadratic form @xmath430 .    in this method , to compute with level @xmath2 one must compute a set of representatives @xmath431 anew .",
    "the first author has given an improvement on this basic algorithm , allowing us to work always with ideal classes @xmath432 belonging to the maximal order at the small price of a more complicated description of the hecke module .",
    "the proof of correctness for this method is best explained in the adelic language , so we refer to section 8 for more detail .",
    "let @xmath433 be representatives for @xmath432 and suppose that @xmath2 is relatively prime to @xmath343 for each @xmath434this is made possible by strong approximation .",
    "as before , let @xmath154 be a prime of @xmath94 with @xmath435 .",
    "let @xmath153 be a totally positive generator for @xmath154 , and let @xmath342 be a totally positive generator for @xmath343 . by our notation , we have @xmath436 .",
    "let @xmath437 .",
    "for each @xmath202 , consider the set @xmath438 where @xmath439 acts by the identification @xmath440 . via a splitting isomorphism @xmath441",
    "the group @xmath442 acts on @xmath443 and since @xmath444 for each @xmath434 ( since @xmath343 is prime to @xmath2 ) , the group @xmath445 similarly acts on @xmath443 .    we then define a hecke module structure on @xmath446 $ ] via the map @xmath447 & \\to { { \\mathbb{c}}}[\\gamma_i\\backslash{{\\mathbb{p}}}^1({{\\mathbb{z}}}_f/{\\mathfrak{n}})]\\\\ \\gamma_j x & \\mapsto \\sum_{\\gamma\\in \\theta({\\mathfrak{p}})_{i , j } } \\gamma_i ( \\gamma x)\\end{aligned}\\ ] ] on each component .",
    "it is a nontrivial but nevertheless routine calculation that this hecke module is isomorphic to the hecke module @xmath257 defined by the brandt matrices at the beginning of this section .",
    "we keep the notations of example  [ defexmqsrt5 ] .",
    "the quaternion algebra @xmath200 has class number 1 , thus the maximal order @xmath448 is unique up to conjugation .",
    "we have @xmath449 has cardinality @xmath450 .",
    "we consider the splitting map @xmath451 given by @xmath452 ( one directly verifies that @xmath453 . )",
    "we let @xmath454 act on @xmath443 on the left via @xmath455 . by the above discussion",
    ", we have @xmath456.\\ ] ] the action of @xmath454 on @xmath443 has three orbits which are represented by @xmath457 , @xmath458 and @xmath459 whose stabilizers have cardinality @xmath408 , @xmath409 and @xmath410 . thus @xmath257 is a free module generated by the orbits @xmath460 , @xmath461 and @xmath462 . writing down the hecke action in that basis , we obtain the same hecke operators as in example  [ defexmqsrt5 ] .",
    "the approach presented above has some advantages over the usual definition of brandt matrices above .",
    "first of all , it is better suited for working with more general level structures , such as those that do not come from eichler orders .",
    "for example , adding a character in this context is quite transparent .",
    "secondly , when working over the same number field , a substantial amount of the required data can be precomputed and reused as the level varies , and consequently one gains significantly in the efficiency of the computation .",
    "in this section , we discuss a method for computing hilbert modular forms using a indefinite quaternion algebra @xmath200 with @xmath280 .",
    "we accordingly call our method the _ indefinite method_. the method is due to greenberg and the second author @xcite .",
    "we seek to generalize the method of modular symbols by working with ( co)homology .",
    "we continue to suppose that @xmath1 has strict class number @xmath7 , and we assume that @xmath239 for uniformity of presentation .",
    "recall that in this case we have defined a group @xmath463 such that @xmath464 is discrete ; the quotient @xmath465 is a shimura curve and quaternionic cusp forms on @xmath200 correspond to holomorphic differential @xmath7-forms on @xmath466 .",
    "integration gives a hecke - equivariant isomorphism which is the analogue of the eichler - shimura theorem , namely @xmath467 we recover @xmath301 by taking the @xmath468-eigenspace for complex conjugation on both sides .",
    "putting this together with the jacquet - langlands correspondence , we have @xmath469    we have the identifications @xmath470 to complete this description , we must relate the action of the hecke operators . let @xmath471 be prime and let @xmath153 be a totally positive generator of @xmath154 . as in ( [ heckeindefinite ] ) , let @xmath472 and choose representatives @xmath473 for these orbits labeled by @xmath273 .",
    "then any @xmath474 by right multiplication permutes the elements of @xmath260 , and hence there is a unique permutation @xmath475 of @xmath266 such that for all @xmath273 we have @xmath476 with @xmath477 . for @xmath478",
    ", we then define @xmath479 in a similar way , we compute the action of complex conjugation @xmath480 via the relation @xmath481 where @xmath482 and @xmath483 .",
    "we begin with two examples , to illustrate the objects and methods involved .",
    "let @xmath484 .",
    "then @xmath174 $ ] is the ring of integers of @xmath1 where @xmath485 satisfies @xmath486 .",
    "indeed @xmath1 has strict class number @xmath7 and @xmath487 is a fundamental unit of @xmath1 .",
    "let @xmath488 , so @xmath200 is generated over @xmath1 by @xmath202 subject to @xmath357 , @xmath489 , and @xmath359 .",
    "the algebra @xmath200 is ramified at the prime ideal @xmath490 and the nonidentity real place of @xmath200 ( taking @xmath491 ) and no other place .",
    "the identity real place gives an embedding @xmath492    let @xmath493 where @xmath494 . then @xmath215 is a maximal order of @xmath200 with discriminant @xmath495 .",
    "let @xmath496 be as above and let @xmath497 be the associated shimura curve .",
    "although they are not an intrinsic part of our algorithm , we mention that the area of @xmath466 ( normalized so that an ideal triangle has area @xmath498 ) is given by @xmath499 where @xmath500 , and the genus of @xmath466 is given by the riemann - hurwitz formula as @xmath501 where @xmath502 is the number of elliptic cycles of order @xmath503 in @xmath454 . an explicit formula for @xmath502 given in terms of class numbers and legendre symbols yields @xmath504 and @xmath505 for @xmath506 .",
    "thus @xmath507 , so @xmath311 . for more details on these formulas and further",
    "introduction , see work of the second author @xcite and the references given there .",
    "next , we compute a fundamental domain for @xmath454 , yielding a presentation for @xmath454 ; we consider this as a black box for now .",
    "the domain , displayed in the unit disc , is as follows .",
    "we obtain the presentation @xmath508\\delta_1\\delta_2\\delta_3=1 \\rangle\\ ] ] where @xmath509    the above method gives the isomorphisms of hecke modules @xmath510 we compute that @xmath511 where @xmath25 is the characteristic function of @xmath512 , i.e. , @xmath513 , @xmath514 and @xmath515 for @xmath516 .",
    "we compute the hecke operator @xmath172 for @xmath154 odd according the definition ( [ heckeindefiniteincohom ] ) .",
    "let @xmath517 .",
    "then @xmath518 . we compute the action of @xmath172 on @xmath519 given by @xmath520 .",
    "the hecke operators act as a sum over @xmath521 left ideals of reduced norm @xmath153 , indexed by @xmath522 .",
    "let @xmath523 specifying the images modulo @xmath154 gives them uniquely , as they lift to @xmath524 using hensel s lemma .",
    "( note that @xmath525 . )",
    "let @xmath526 be defined by @xmath527 as in ( [ iaideals ] )",
    ". then @xmath271 are principal left @xmath215-ideals by strong approximation .",
    "for example , @xmath528 where @xmath529 .",
    "we compute the hecke operators as in ( [ heckeindefiniteincohom ] ) . for @xmath530 and @xmath474 ,",
    "we compute elements @xmath477 indexed by @xmath273 and @xmath475 a permutation of @xmath266 such that @xmath531 for all @xmath273 ; then @xmath532 the contribution to the sum for @xmath25 simply counts the number of occurrences of @xmath512 in the product @xmath533 . carrying out this computation for various primes , we obtain the following table .",
    "@xmath534 here we list only the norm of the prime as the eigenvalue does not depend on the choice of prime @xmath154 of the given norm .",
    "this suggests that @xmath25 corresponds to a base change of a form from @xmath0 .",
    "so we look through tables of elliptic curves over @xmath0 whose conductor is divisible only by @xmath6 and @xmath535 .",
    "we find the curve @xmath79 labelled , where @xmath536 , given by @xmath537 let @xmath538 denote the base change of @xmath79 to @xmath1 .",
    "we compute that the twist @xmath539 of @xmath538 by @xmath540 , given by @xmath541 has conductor @xmath490 . since the extension @xmath542 is abelian , by base change theorems we know that there exists a hilbert cusp form associated to @xmath539 over @xmath1 which is new of level @xmath490 , which therefore must be equal to @xmath25 .",
    "this verifies that the jacobian @xmath543 of @xmath544 is isogenous to @xmath539 .",
    "we verify that @xmath545 and ( as suggested by the table ) that @xmath79 has a @xmath546-torsion point , @xmath547 ( and consequently so too does @xmath543 ) .",
    "[ indefexmqsrt5 ] to illustrate the jacquet - langlands correspondence ( theorem [ shimizuclno1 ] ) in action , we return to example [ defexmqsrt5 ] .",
    "recall @xmath173 and @xmath175 .",
    "we find the quaternion algebra @xmath548 which is ramified at @xmath398 , a prime of norm @xmath397 , and one infinite place .",
    "the order @xmath549 with @xmath94-basis @xmath550 , where @xmath551 , is maximal . as above , we compute that @xmath552 and @xmath553 .",
    "now we have the following fundamental domain :        we obtain the presentation @xmath554[\\gamma_2,\\gamma_2 ' ] = 1 \\rangle.\\ ] ] ( in particular , @xmath555 is a torsion - free group . )",
    "we have @xmath556 , and on the basis of characteristic functions given by @xmath557 , the action of complex conjugation is given by the matrix @xmath558 : this is computed in a way we thus obtain a basis for @xmath559 .",
    "computing hecke operators as in the previous example , we find as in example [ defexmqsrt5 ] that @xmath393 is irreducible as a hecke module , and find that @xmath560 happily , the characteristic polynomials of these operators agree with those computed using the definite method .",
    "we now give an overview of how these computations are performed : for more details , see the reference by greenberg and the second author @xcite .",
    "to compute effectively the systems of hecke eigenvalues in the cohomology of a shimura curve , we need several algorithms .",
    "first , we need to compute an explicit finite presentation of @xmath454 with a solution to the word problem in @xmath454 , i.e. , given @xmath561 , write @xmath562 as an explicit word in the generators for @xmath454 .",
    "secondly , we need to compute a generator ( with totally positive reduced norm ) of a left ideal @xmath563 .",
    "the first of these problems is solved by computing a dirichlet domain ; the second is solved using lattice methods .",
    "we discuss each of these in turn .",
    "let @xmath564 have trivial stabilizer @xmath565 .",
    "the _ dirichlet domain _ centered at @xmath153 is the set @xmath566 where @xmath69 denotes the hyperbolic distance . in other words , we pick in every @xmath454-orbit the closest points @xmath24 to @xmath153 .",
    "the set @xmath567 is a closed , connected , hyperbolically convex fundamental domain for @xmath454 whose boundary consists of finitely many geodesic segments , called _ sides _ , and comes equipped with a _ side pairing _ , a partition of the set of sides into pairs @xmath568 with @xmath569 for some @xmath570 .",
    "( we must respect a convention when a side @xmath571 is fixed by an element of order @xmath6 , considering @xmath571 to be the union of two sides meeting at the fixed point of @xmath181 . )",
    "the second author has proven @xcite that there exists an algorithm which computes a dirichlet domain @xmath572 for @xmath454 , a side pairing for @xmath572 , and a finite presentation for @xmath454 with a minimal set of generators together with a solution to the word problem for @xmath454 .",
    "this algorithm computes @xmath572 inside the unit disc @xmath573 , and we consider now @xmath454 acting on @xmath573 by a conformal transformation which maps @xmath574 .",
    "we find then that @xmath573 can be computed as an _ exterior domain _ , namely , the intersection of the exteriors of _ isometric circles _",
    "@xmath575 for elements @xmath570 , where @xmath576 where @xmath577 .",
    "we find generators for the group by enumerating short vectors with respect to a certain positive definite quadratic form depending on @xmath153 .",
    "the solution to the word problem comes from a reduction algorithm that finds elements which contribute to the fundamental domain and removes redundant elements .",
    "given a finite subset @xmath578 we say that @xmath512 is _ @xmath579-reduced _ if for all @xmath580 , we have @xmath581 .",
    "we have a straightforward algorithm to obtain a @xmath579-reduced element , which we denote @xmath582 : if @xmath583 for some @xmath580 , set @xmath584 and repeat . when the exterior domain of @xmath579 is a fundamental domain , we have @xmath585 if and only if @xmath474 .",
    "this reduction is analogous to the generalized division algorithm in a polynomial ring over a field .",
    "let @xmath1 be the ( totally real ) cubic subfield of @xmath586 with discriminant @xmath587 .",
    "we have @xmath588 where @xmath589 .",
    "( @xmath1 has strict class number @xmath7 . )",
    "the quaternion algebra @xmath590 has discriminant @xmath309 and is ramified at @xmath6 of the @xmath180 real places of @xmath1 .",
    "we take @xmath215 to be an eichler order of level @xmath591 , a prime ideal of norm @xmath546 ; explicitly , we have @xmath592    we compute a fundamental domain for the group @xmath593 .",
    "we take @xmath594 .",
    "we first enumerate elements of @xmath215 by their absolute reduced norm .",
    "of the first @xmath595 elements , we find @xmath535 elements of reduced norm @xmath7 .",
    "let @xmath579 be the set of elements which contribute to the boundary .",
    "for each @xmath596 , we compute @xmath597 .",
    "each in fact reduces to @xmath7 , so we are left with @xmath384 elements .",
    "we next enumerate elements in @xmath215 moving the center in the direction of the infinite vertex @xmath598 .",
    "we find an _ enveloper _",
    ", an element @xmath181 such that @xmath598 lies in the interior of @xmath575 , and reduce to obtain the following .",
    "the domain now has finite area .",
    "we now attempt to pair each vertex to construct a side pairing .",
    "for example , the first vertex @xmath285 pairs with @xmath599 , pairing the isometric circle @xmath600 of @xmath601 with @xmath602 .",
    "we continue , but find that @xmath603 does not pair with another vertex .",
    "indeed , @xmath604 does not lie in the exterior domain .",
    "we compute the reduction @xmath605 , analogously defined .",
    "we then obtain a domain with the right area , so we are done !",
    "( in order to get an honest side pairing , we agree to the convention that a side @xmath575 which is fixed by an element @xmath181 , necessarily of order @xmath6 , is in fact the union of two sides which meet at the unique fixed point of @xmath181 ; the corresponding vertex then appears along such an side . )    as to the second problem , that of principalizing ideals , we refer to work of kirschmer and the second author @xcite , which relies again upon enumeration in a lattice .",
    "this method can be improved using the computation of a fundamental domain , which allows one to further effectively reduce lattice elements .    as in the previous section , when the level @xmath2 varies , by changing the coefficient module one can work always with the group @xmath555 associated to the maximal order @xmath448 rather than recomputing a fundamental domain for @xmath606 each time .",
    "this is a simple application of shapiro s lemma : the isomorphism @xmath607 is an isomorphism of hecke modules : we give @xmath608 the natural structure as a @xmath555-module , and for a cochain @xmath609 , we define @xmath610 as in ( [ heckeindefiniteincohom ] ) .",
    "we require still that @xmath611 ; after enumerating a set of representatives for @xmath612 , we can simply multiply elements @xmath613 by the representative for its coset .    to conclude , we compare the above method to the method of modular symbols introduced when @xmath96 .",
    "the shimura curves @xmath614 do not have cusps , and so the method of modular symbols does not generalize directly . however , the side pairing of a dirichlet domain for @xmath454 gives an explicit characterization of the gluing relations which describe @xmath466 as a riemann surface , hence one obtains a complete description for the homology group @xmath615 .",
    "paths are now written @xmath616 for @xmath222 a vertex on a side paired by @xmath617 .",
    "the analogue of the manin trick in the context of shimura curves is played by the solution to the word problem in @xmath454 , and so in some sense this can be seen as a partial extension of the euclidean algorithm to totally real fields .",
    "our point of view is to work dually with cohomology , but computationally these are equivalent @xcite .",
    "in this section , we provide some detailed examples to illustrate applications of the algorithms introduced in the previous sections .",
    "our first motivation comes from the association between hilbert modular forms and abelian varieties .",
    "the eichler - shimura construction ( see knapp  ( * ? ? ? * chap .",
    "xii ) or shimura ( * ? ? ?",
    "* chapter 7 ) ) attaches to a classical newform @xmath618 an abelian variety @xmath619 with several properties .",
    "first , @xmath619 has dimension equal to @xmath620 $ ] where @xmath621 is the field of fourier coefficients of @xmath25 and @xmath622 .",
    "second , @xmath619 has good reduction for all primes @xmath64 .",
    "last , we have an equality of @xmath81-functions @xmath623 where @xmath624 is obtained by letting @xmath625 act on the fourier coefficients of @xmath25 , so that @xmath626 the abelian variety @xmath619 arises as the quotient of @xmath627 by the ideal of @xmath628 generated by @xmath629 .",
    "the simplest example of this construction is the case of a newform @xmath25 with rational fourier coefficients @xmath630 .",
    "then @xmath619 is an elliptic curve of conductor @xmath15 obtained analytically via the map @xmath631 the equality of @xmath81-functions is equivalent to the statement @xmath632 for all primes @xmath153 , and this follows in the work of eichler and shimura by a comparison of correspondences in characteristic @xmath153 with the frobenius morphism .",
    "the eichler - shimura construction extends to the setting of totally real fields in the form of the following conjecture ( see e.g.  darmon ( * ? ? ?",
    "* section 7.4 ) ) .",
    "[ conj1 ] let @xmath633 be a hilbert newform of parallel weight @xmath6 and level @xmath2 over @xmath1 .",
    "let @xmath634 be the field of fourier coefficients of @xmath25 .",
    "then there exists an abelian variety @xmath619 of dimension @xmath635 $ ] defined over @xmath1 of conductor @xmath636 such that @xmath637 and @xmath638    in particular , if @xmath25 has rational fourier coefficients , conjecture [ conj1 ] predicts that one can associate to @xmath25 an elliptic curve @xmath619 defined over @xmath1 with conductor @xmath2 such that @xmath639 .",
    "conjecture [ conj1 ] is known to be true in many cases .",
    "it is known if @xmath25 appears in the cohomology of a shimura curve ( as in sections 3 and 5 above ; see also zhang  @xcite ) : this holds whenever @xmath310 $ ] is odd or if @xmath2 is exactly divisible by a prime @xmath154 . if @xmath25 appears in the cohomology of a shimura curve @xmath466 and @xmath25 has rational fourier coefficients , then when the conjecture holds there is a morphism @xmath640 and we say that @xmath619 is _ uniformized _ by @xmath466 .",
    "however , conjecture [ conj1 ] is not known in complete generality : by the jacquet - langlands correspondence , one has left exactly those forms @xmath25 over a field @xmath1 of even degree @xmath60 and _ squarefull _ level ( i.e.  if @xmath641 then @xmath642 ) , for example @xmath134 . one expects still that the conjecture is true in this case : blasius  @xcite , for example , shows that the conjecture is true under the hypothesis of the hodge conjecture .    the converse to the eichler - shimura construction ( conjecture [ conj1 ] ) over @xmath0 is known as the shimura - taniyama conjecture .",
    "an abelian variety @xmath643 over a number field @xmath1 is _ of @xmath199-type _ if @xmath644 is a number field of degree @xmath645 .",
    "the shimura - taniyama conjecture states that given an abelian variety @xmath643 of @xmath199-type over @xmath0 , there exists an integer @xmath646 and a surjective morphism @xmath647 .",
    "this conjecture is a theorem , a consequence of the proof of serre s conjecture by khare and wintenberger @xcite . in the setting of totally real fields ,",
    "the analogous conjecture is as follows .",
    "[ conj2 ] let @xmath643 be an abelian variety of @xmath199-type over a totally real field @xmath1 .",
    "then there exists a hilbert newform @xmath25 of parallel weight @xmath6 such that @xmath648 and @xmath649    if both of these conjectures are true , then by faltings isogeny theorem , the abelian variety @xmath643 in conjecture [ conj2 ] would be isogenous to the abelian variety @xmath619 constructed in conjecture [ conj1 ] .",
    "an abelian variety of @xmath199-type over a totally real field @xmath1 which satisfies the conclusion of shimura - taniyama conjecture ( conjecture [ conj2 ] ) is called _",
    "there has been tremendous progress in adapting the techniques initiated by wiles  @xcite  which led to the proof of the shimura - taniyama conjecture in the case @xmath96to totally real fields .",
    "for example , there are modularity results which imply that wide classes of abelian varieties of @xmath199-type are modular : see for example work of skinner and wiles  @xcite , kisin  @xcite , snowden  @xcite and geraghty  @xcite , and the results below .",
    "however , a complete proof of conjceture [ conj2 ] remains elusive .    with these conjectures in mind",
    ", we turn to some computational examples .",
    "we begin with @xmath173 and let @xmath175 .",
    "for some further discussion on this case , see work of the first author @xcite .",
    "[ le30 ] we consider the spaces @xmath131 with @xmath650 .",
    "we compute using the definite method of section 4 using the quaternion algebra over @xmath1 which is ramified at no finite place .",
    "we find that @xmath651 for all ideals @xmath2 of @xmath94 with @xmath650 and @xmath652 for @xmath2 with norm @xmath653 .",
    "now let @xmath2 be either of the primes above 31 . by the jacquet - langlands correspondence ( theorem [ shimizuclno1 ] ) and the accompanying discussion ,",
    "the space @xmath131 can also be computed using the indefinite quaternion algebra @xmath200 ramified at @xmath2 and one real place .",
    "we find agreeably that the shimura curve @xmath654 has genus one and thus its jacobian is an elliptic curve . by a search ,",
    "we find the elliptic curve @xmath655 of conductor @xmath656 of norm @xmath653 .",
    "we now show that @xmath643 is modular . in brief",
    ", we verify that the galois representation @xmath657 is irreducible , solvable , and ordinary since @xmath658 ( so @xmath659 ) , so @xmath643 is modular by skinner and wiles @xcite .",
    "since @xmath643 has conductor @xmath154 and the space @xmath660 has dimension @xmath7 , it follows by falting s isogeny theorem that @xmath643 is isogeneous to the jacobian of the shimura curve @xmath654 .",
    "in particular , the elliptic curves over @xmath173 with smallest conductor have prime conductor dividing @xmath653 and are isogenous to @xmath643 or its galois conjugate .",
    "[ thm : ex - root-5 ] let @xmath661 be such that @xmath662 .    if @xmath663 , then @xmath664 : each newform @xmath25 of conductor @xmath2 has rational fourier coefficients and is either the base change of a classical modular form over @xmath0 or associated to an elliptic curve which is uniformized by a shimura curve .",
    "we compute each space in turn using the definite method .",
    "those forms @xmath25 which have the property that @xmath665 , where @xmath91 denotes the galois involution , are candidates to arise from base change over @xmath0 . for each of these forms @xmath25",
    ", we find a candidate classical modular form @xmath181 using the tables of cremona @xcite : such a form will have conductor supported at @xmath546 and the primes dividing @xmath666 .",
    "each curve comes with a weierstrass equation , and we find a quadratic twist of the base change of this curve to @xmath1 which has conductor @xmath2 . since every elliptic curve over @xmath0 is modular , the base change and its quadratic twist are also modular , and since we exhaust the space this way we are done .",
    "for example , when @xmath667 we have @xmath668 and find the form @xmath25 with hecke eigenvalues @xmath669 , @xmath670 , @xmath671 , @xmath672 , and so on . in the tables of cremona , we locate the form @xmath673 associated to an elliptic curve @xmath674 with label and equation @xmath675 .",
    "we find that the quadratic twist of ( the base change of ) @xmath674 by @xmath676 given by the equation @xmath677 has conductor @xmath678 , so we conclude that @xmath25 is the base change of @xmath181 .",
    "note that this example is not covered by the known cases of the eichler - shimura construction , since the level @xmath679 is squarefull .    now consider the prime level @xmath680 , then @xmath681 is a @xmath6-dimensional irreducible hecke module arising from the jacobian of the shimura curve @xmath654 where @xmath200 is the quaternion algebra ramified at one of the infinite places and @xmath2 .",
    "this follows from examples [ defexmqsrt5 ] and [ indefexmqsrt5 ] .",
    "one is naturally led to ask , can one identify the genus 2 shimura curve @xmath682 with @xmath200 of discriminant @xmath2 ?",
    "consider the hyperelliptic curve @xmath683 over @xmath1 with @xmath684 this curve was obtained via specialization of the brumer - hashimoto family @xcite of curves ( see also wilson @xcite ) whose jacobian has real multiplication by @xmath685 , so in particular so does the jacobian @xmath686 of @xmath687 .",
    "the discriminant of @xmath687 is @xmath688 .",
    "one can show that @xmath293 is modular using the theorem of skinner and wiles ( * ? ? ?",
    "* theorem a ) and the fact that @xmath293 has a torsion point of order 31 . since @xmath687 is hyperelliptic of genus @xmath6 , we compute that the conductor of ( the abelian surface ) @xmath293 is @xmath689 and that its level is @xmath2 .",
    "since @xmath293 is modular of level @xmath2 , it corresponds to the unique hecke constituent of that level .",
    "it follows then by faltings isogeny theorem that @xmath293 and the jacobian of the shimura curve @xmath466 are isogenous .",
    "these examples exhaust all modular abelian varieties of @xmath199-type over @xmath685 with level @xmath2 of norm @xmath690 ( up to isogeny ) .",
    "we conclude with some ( further ) cases where conjectures [ conj1 ] and [ conj2 ] are not known .    the first case of squarefull level with a form that is not a base change is level @xmath691 so @xmath692 . we have @xmath693 and the corresponding newform @xmath25 has the following eigenvalues ( where @xmath694 ) : @xmath695 in this case , the eichler - shimura conjecture predicts the existence of an abelian surface defined over @xmath173 with good reduction away from @xmath696 and with real multiplication by @xmath697 .",
    "the form @xmath25 is not a base change from @xmath0 since @xmath698 in general .",
    "can one find an explicit genus @xmath6 curve over @xmath1 , analogous to the previous example , with the @xmath81-function of its jacobian given by the above frobenius data ?",
    "we next consider a situation when we are successful in establishing the correspondence in a case which is not covered by known results .",
    "consider @xmath699 so @xmath700 . there exist forms @xmath701 with hecke eigenvalues as follows : @xmath702 the form @xmath181 is a quadratic twist of @xmath25 by @xmath703 , and the forms @xmath704 are not base changes from @xmath0 .",
    "we use the method of cremona and lingham @xcite  without an attempt to be exhaustive  to find an elliptic curve @xmath79 over @xmath1 with good reduction away from @xmath705 .",
    "we find the curve @xmath706 ( which could also be found by a naive search ) with conductor @xmath2 .",
    "we verify that @xmath707 for all primes @xmath154 up to the limit of the computation .",
    "we prove that @xmath79 is modular using the fact that @xmath79 has a @xmath180-isogeny , with kernel defined over @xmath708 generated by the points with @xmath709 , so we can apply the theorem of skinner and wiles .",
    "therefore indeed @xmath79 corresponds to @xmath25 .",
    "we now turn to the existence of elliptic curves with everywhere good reduction over totally real fields .",
    "the shimura - taniyama conjecture predicts that such curves arise from cusp forms of level @xmath710 .",
    "let @xmath711 be the totally real subfield of the cyclotomic field @xmath586 with @xmath712 .",
    "the space @xmath713 over @xmath1 has dimension 1 , represented by the cusp form @xmath25 .",
    "conjecture [ conj1 ] predicts the existence of an elliptic curve @xmath619 over @xmath1 with everywhere good reduction .",
    "we note that @xmath619 must be a @xmath0-curve since the twist @xmath714 of @xmath25 by an element @xmath715 is again a form of level @xmath7 and so ( since @xmath716 ) @xmath717 and consequently @xmath619 must be isogenous its galois conjugates .",
    "indeed , let @xmath718 be the elliptic curve with the following coefficients : @xmath719 we verify that @xmath643 has everywhere good reduction and that @xmath720 with @xmath721 generated by the point @xmath722 therefore , by skinner and wiles  ( * ? ? ?",
    "* theorem 5 ) applied to the @xmath180-adic representation attached to @xmath643 or  ( * ? ? ?",
    "* theorem a ) to the @xmath723-adic one , we conclude that @xmath643 is modular , and thus @xmath643 is our abelian variety @xmath619 .",
    "the elliptic curve @xmath643 was obtained from a curve over @xmath724 as follows .",
    "there is a @xmath6-dimensional hecke constituent @xmath181 in the space of classical modular forms @xmath725 over @xmath0 given by @xmath726 let @xmath674 be the associated abelian surface , defined over @xmath0 .",
    "roberts and washington  @xcite showed that @xmath674 twisted by @xmath727 is isomorphic over @xmath1 to @xmath728 , where @xmath729 a @xmath0-curve of conductor @xmath730 and @xmath625 is the nontrivial automorphism of @xmath731 .    the abelian variety @xmath674 is related to the elliptic curve @xmath643 as follows .",
    "roberts and washington show that @xmath732 and @xmath674 are isogenous over @xmath733 . the abelian surface @xmath732 is isogenous over @xmath1 to @xmath734 ,",
    "since @xmath732 obtains good reduction over @xmath1 ( see mazur and wiles ( * ? ? ?",
    "* chapter 3.2 , proposition 2 ) and schoof @xcite ) .",
    "indeed , serre showed that the abelian surface @xmath732 has a rational point of order 19 and mazur and tate showed that @xmath732 twisted by @xmath731 is a product of two elliptic curves .",
    "we thereby determine an equation for @xmath643 by showing that it is a quadratic twist of @xmath79 by some unit in @xmath1 .",
    "we would like to thank elkies and watkins for pointing us to the rich history of this curve .",
    "the next example gives the list of all modular elliptic curves ( up to isogeny ) with everywhere good reduction over a real quadratic field @xmath1 of discriminant @xmath735 and having strict class number one .",
    "let @xmath736 be a fundamental discriminant such that @xmath737 has strict class number one .",
    "we have @xmath174 $ ] with @xmath738 , according as @xmath739 .",
    "let @xmath643 be a modular elliptic curve over @xmath1 with everywhere good reduction .",
    "then @xmath643 corresponds to a cusp form @xmath25 of level @xmath7 with rational fourier coefficients .",
    "computing the spaces @xmath713 , we find that either @xmath643 is a @xmath0-curve ( so @xmath643 is isogenous to its galois conjugate ) , or @xmath740 and the isogeny class of @xmath643 is represented by the curve with coefficients as below , up to galois conjugacy : @xmath741",
    "the @xmath0-curves over @xmath1 are listed in cremona  @xcite : for example , the curve @xmath742 with @xmath743 is the smallest such and was discovered by tate  @xcite .",
    "the curve for discriminant @xmath744 was discovered by pinch @xcite : it was the first example of an elliptic curve having everywhere good reduction which is not a @xmath0-curve , and it was proven to be modular by socrates and whitehouse @xcite using the method of faltings and serre . the curve for @xmath745 was discovered by cremona and watkins independently ; the one for @xmath746 by elkies ; and the one for @xmath747 by cremona .",
    "their modularity can be established by applying the theorem of skinner and wiles  ( * ? ? ?",
    "* theorem 5 ) to the associated @xmath180-adic representation .    as a third and final application",
    ", we consider the existence of number fields with small ramification  these are linked to hilbert modular forms via their associated galois representations .",
    "in the late 1990s , gross proposed the following conjecture .",
    "[ conj : unramified ] for every prime @xmath153 , there exists a nonsolvable galois number field @xmath220 ramified only at @xmath153 .",
    "conjecture  [ conj : unramified ] is true for @xmath748 by an argument due to serre and swinnerton - dyer @xcite . for @xmath749 or @xmath750 ,",
    "let @xmath751 be the unique newform of level 1 and weight @xmath5 .",
    "for each such @xmath5 and every prime @xmath153 , there is an associated galois representation @xmath752 ramified only at @xmath153 . in particular , the field @xmath220 fixed by the kernel of @xmath753 is a number field ramified only at @xmath153 with galois group @xmath754 .",
    "we say that the prime @xmath153 is _ exceptional _ for @xmath5 if @xmath755 is not surjective .",
    "the `` open image '' theorem of serre @xcite implies that the set of primes where @xmath756 is exceptional is finite .",
    "serre and swinnerton - dyer produced the following table of exceptional primes : @xmath757 ( the large primes that occur are divisors of denominators of bernoulli numbers . )",
    "it follows that for every @xmath748 that conjecture [ conj : unramified ] is true .",
    "conversely , it is a consequence of the proof of serre s conjecture by khare and wintenberger @xcite together with standard level lowering arguments that if @xmath758 then any odd representation of the absolute galois group @xmath759 to @xmath760 which is ramified only at @xmath153 is necessarily reducible ( and thus solvable ) .    to address gross conjecture , we instead look at the residual representations associated to hilbert cusp forms of parallel weight @xmath6 and level @xmath7 over fields @xmath1 ramified only at a prime @xmath758 .",
    "this idea was first pursued by the first author @xcite following a suggestion of gross , who found such a form with @xmath761 , the totally real subfield of the cyclotomic field @xmath762 , settling the case @xmath362 .",
    "this line of inquiry was followed further by the authors with matthew greenberg @xcite , settling the cases @xmath763 .",
    "( the case @xmath764 was recently settled by dieulefait @xcite by considering the mod @xmath765 galois representation attached to a genus @xmath6 siegel cusp form of level @xmath7 and weight @xmath766 .",
    "therefore gross conjecture is now a theorem . )",
    "we sketch below the resolution of the case @xmath767 .",
    "we take the base field @xmath588 to be the subfield of @xmath768 of degree @xmath546 , where @xmath769 .",
    "the field @xmath1 has strict class number @xmath7 .",
    "let @xmath79 be the elliptic curve over @xmath1 with @xmath770-invariant given by @xmath771 and minimal conductor @xmath2 .",
    "then @xmath772 , where @xmath773 is the unique prime above @xmath546 and @xmath774 is one of the five primes above @xmath765 .",
    "roberts @xcite showed that the mod @xmath546 galois representation @xmath775 ) \\cong \\operatorname{gl}_2({{\\mathbb{f}}}_{{\\mathfrak{p}}_5})=\\operatorname{gl}_2({{\\mathbb{f}}}_5)\\ ] ] has projective image @xmath776 and is ramified only at the prime @xmath777 ( and not @xmath778 ) .",
    "( we will verify below that @xmath79 has indeed the right conductor . ) the representation @xmath779 and its galois conjugates gives an extension @xmath220 of @xmath0 with galois group @xmath780    by work of skinner and wiles ( as in example [ le30 ] ) , we prove that the @xmath180-adic representation @xmath781 associated to @xmath79 is modular , and hence @xmath79 itself is modular .",
    "since @xmath79 is modular and @xmath1 has odd degree , @xmath79 is uniformized by a shimura curve .",
    "namely , let @xmath200 be the quaternion algebra over @xmath1 ramified at four of the five real places .",
    "let @xmath782 be the shimura curve associated to an eichler order of level @xmath783 contained in a maximal order @xmath215 , and let @xmath784 be the jacobian of @xmath782 .",
    "we compute that @xmath785 has dimension @xmath786 .",
    "we then find the unique hilbert newform @xmath787 of parallel weight @xmath6 and level @xmath783 with integer fourier coefficients which corresponds to @xmath79 .",
    "the elliptic curve @xmath79 found by roberts @xcite was obtained from our computations of hilbert modular forms at level @xmath777 over @xmath1 .",
    "the space @xmath788 has 2 hecke constituents of dimension 10 and 20 , respectively .",
    "let @xmath25 be a newform in the 20-dimensional constituent .",
    "let @xmath789 be the restriction of the hecke algebra @xmath790_{{\\mathfrak{p}}}$ ] to this constituent : this is the constituent which yields the galois representation obtained in the 5-torsion of roberts curve .",
    "let @xmath791 be the field of fourier coefficients of @xmath25 and let @xmath792 .",
    "by direct calculations , we see that @xmath793 is the ( totally real ) quartic field generated by a root of the polynomial @xmath794 .",
    "the galois group @xmath795 acts on @xmath796 via its action on ideals of @xmath94 , namely @xmath797 .",
    "this action preserves the decomposition of @xmath796 into hecke - irreducible components . by work of shimura ,",
    "the action of @xmath798 on fourier expansions preserves the hecke constituents .",
    "in particular , both these actions preserve @xmath789 and hence @xmath799 and must be compatible .",
    "therefore , for each @xmath800 , there is a unique @xmath801 such that , for all prime ideals @xmath802 , we have @xmath803 the map @xmath804 thus yields a homomorphism @xmath805 by direct calculation , we show that this map is an isomorphism .",
    "since @xmath795 is abelian , the field @xmath806 must be a ray class field over @xmath799 ; in fact , we compute that it has conductor equal to a prime above 71 which splits completely in @xmath806 .",
    "the ideal @xmath807 factors as @xmath808 .",
    "the prime @xmath809 splits completely in @xmath806 , and the primes above it in @xmath806 are permuted by @xmath810 ; the prime @xmath811 is inert .",
    "we have a galois representation @xmath812 with @xmath813 and @xmath814 for all @xmath815 .",
    "let @xmath816 , @xmath817 be the five maximal ideals above ( the image of ) @xmath809 . they give rise to the 5 residual representations @xmath818",
    "let @xmath819 be the fixed field of @xmath820 , and @xmath81 the compositum of the @xmath819 .",
    "then @xmath81 is a galois extension of @xmath1 and is ramified only at @xmath546 . since @xmath1 is galois and ramified only at @xmath546 , and by the above @xmath795 permutes the fields @xmath819 so preserves @xmath81",
    ", we see that @xmath81 is a galois extension of @xmath0 ramified only at @xmath546 . by a result of shepherd - barron and taylor @xcite , each extension @xmath819",
    "can be realized in the @xmath546-torsion of an elliptic curve @xmath821 .",
    "recall the projective representation @xmath822 from roberts elliptic curve @xmath79 is surjective , ramified at @xmath777 but unramified at @xmath778 .",
    "therefore , the level @xmath823 is a nonoptimal level for @xmath779 ; thus , by mazur s principle  @xcite , we have @xmath824 for some @xmath825 . in other words ,",
    "the extension constructed by roberts is isomorphic to our field @xmath81 .",
    "roberts @xcite has given an explicit equation for the number field @xmath81 ( obtained from the @xmath546-division polynomial of the elliptic curve @xmath79 ) : the field @xmath81 is the the splitting field of the polynomial @xmath826    to conclude , we consider a question that touches on each of the above three subjects .",
    "we reconsider gross conjecture ( conjecture [ conj : unramified ] ) in the case @xmath362 @xcite .",
    "the nonsolvable field which is ramified only at @xmath6 arises from the galois representation associated to a constituent eigenform @xmath827 in a @xmath828-dimensional subspace of the space of hilbert cusp forms of parallel weight @xmath6 and level @xmath7 over @xmath761 .",
    "let @xmath829 be the field of fourier coefficients of @xmath25 and let @xmath792 .",
    "let @xmath799 be the fixed field of @xmath798 so that @xmath830 .",
    "the map ( [ tausigma ] ) in this context is again an isomorphism , and so @xmath806 is abelian over @xmath799 and @xmath831 $ ] divides @xmath620=16 $ ] . by direct calculations ,",
    "we show that @xmath832 .",
    "the eichler - shimura construction ( conjecture [ conj2 ] ) predicts the existence a @xmath828-dimensional abelian variety @xmath619 defined over @xmath1 with everywhere good reduction and real multiplication by @xmath806 associated to @xmath25 .",
    "more should be true , as communicated to us by gross ( private communication ) .",
    "in fact , @xmath619 should descend to an abelian variety of dimension @xmath828 over @xmath0 , and we should have @xmath833 , where @xmath834 is any element that restricts to the nontrivial element of @xmath832 .",
    "the endomorphisms of @xmath619 over @xmath0 should be the ring of integers of @xmath799 , and over @xmath0 , the variety @xmath619 would have bad reduction only at the prime @xmath6 ; the nonsolvable extension would then arise as its @xmath6-division field . the conductor @xmath835 of @xmath619 over @xmath0 can be computed from the functional equation of @xmath836 , where we note @xmath837 is the discriminant of @xmath1 .",
    "we note that @xmath619 is not of @xmath199-type over @xmath0 itself as it would be modular by the proof of serre s conjecture .",
    "although one knows that the associated galois representation exists by work of taylor @xcite , as gross says , `` with such nice properties , it s a shame that we ca nt even prove that the abelian variety @xmath619 exists ! that s an advantage you have when @xmath1 has odd degree . ''",
    "in this section , we begin again , and we revisit the definition of hilbert and quaternionic modular forms allowing @xmath1 to have arbitrary class number ; we refer to hida @xcite as a reference for this section .",
    "we renew our notation .",
    "let @xmath1 be a totally real field of degree @xmath310 $ ] with ring of integers @xmath94 .",
    "let @xmath200 be a quaternion algebra over @xmath1 of discriminant @xmath225 .",
    "let @xmath231 be the real places of @xmath1 ( abbreviating as before @xmath838 for @xmath839 ) , and suppose that @xmath200 is split at @xmath232 and ramified at @xmath233 , i.e.   @xmath840 let @xmath841 denote the @xmath434th projection @xmath842 and @xmath843 .",
    "let @xmath844 be the group of totally positive elements of @xmath1 and let @xmath845 .",
    "let @xmath846 be a maximal order .",
    "let @xmath2 be an ideal of @xmath94 coprime to @xmath225 and let @xmath847 be an eichler order of level @xmath2 .    with a view towards generalizations , rather than viewing modular forms as functions on ( a cartesian power of ) the upper half - plane which transform in a certain way",
    ", we now view them instead more canonically as functions on @xmath848 .",
    "let @xmath849 be the union of the upper and lower half - planes . via the embeddings @xmath232 , corresponding to the first @xmath277 factors in ( [ br ] ) ,",
    "the group @xmath848 acts on @xmath850 on the right transitively with the stabilizer of @xmath851 being @xmath852 therefore we can identify @xmath853    from this perspective , it is natural to consider the other ( nonarchimedean ) places of @xmath1 at the same time .",
    "let @xmath854 ( where @xmath855 denotes the restricted direct product ) and let @xmath856 denote tensor with @xmath857 over @xmath68 .",
    "we will define modular forms on @xmath200 as analytic functions on @xmath858 which are invariant on the left by @xmath859 and transform by @xmath860 in a specified way .",
    "we must first define the codomain of these functions to obtain forms of arbitrary weight .",
    "let @xmath861 and suppose that the @xmath862 have the same parity ; we call @xmath5 a _ weight_. let @xmath863    for an integer @xmath864 , let @xmath865 be the subspace of @xmath866 $ ] consisting of homogeneous polynomials of degree @xmath867 . for @xmath868 , let @xmath869 be the adjoint of @xmath512 , so that @xmath870 .",
    "define a right action of @xmath871 on @xmath872 by @xmath873 for @xmath874 and @xmath875 . for @xmath876 , @xmath871",
    "also acts on @xmath872 via the character @xmath877 . by twisting the above action by this character",
    ", we get a right @xmath871-module denoted by @xmath878 .",
    "define the right @xmath879-module @xmath880 ( by convention , if @xmath881 then we set @xmath882 . ) for the ramified real places @xmath233 of @xmath1 , we choose splittings @xmath883 we abbreviate as above @xmath884 for @xmath885 .",
    "then @xmath886 becomes a right @xmath859-module via @xmath887 . from now on , @xmath886 will be endowed with this action , which we denote by @xmath888 for @xmath889 and @xmath890 .",
    "one may identify @xmath886 with the subspace of the algebra @xmath891 $ ] consisting of those polynomials @xmath75 which are homogeneous in @xmath892 of degree @xmath893 but with a twisted action .",
    "we consider the space of functions @xmath894 , with a right action of @xmath895 defined by @xmath896 where recall @xmath897 if @xmath898 .",
    "( the presence of the inverses is forced as we want a right action on functions via multiplication of the argument on the right .",
    "this almost extends to a right action of @xmath899 , except that @xmath900 unless @xmath901 fixes @xmath24 . )",
    "[ def : quat - mod - forms ] a _ ( quaternionic ) modular form _ of weight @xmath5 and level @xmath2 for @xmath200 is an analytic function @xmath902 such that for all @xmath903 we have :    @xmath904 for all @xmath905 and @xmath906 ; and    @xmath907 for all @xmath890 .    in other words ,",
    "definition  [ def : quat - mod - forms ] says that a quaternionic modular form of weight @xmath5 and level @xmath2 is an analytic function which is @xmath859-invariant on the left and @xmath908-equivariant on the right under the action ( [ fslshadel ] ) .",
    "in particular , we have @xmath909 for all @xmath906 and @xmath910    we denote by @xmath911 the space of quaternionic modular forms of weight @xmath5 and level @xmath2 for @xmath200 .",
    "let @xmath912 be a quaternionic modular form . for @xmath913",
    ", choose @xmath914 such that @xmath915 and define @xmath916 the map @xmath25 in ( [ onupperh ] ) is well - defined by ( [ indepofuhat ] ) and ( [ indepofkappa ] ) : we have @xmath917 using the fact that @xmath918 .    the identity 7.5(ii )",
    "is translated as follows .",
    "let @xmath890 .",
    "then @xmath919 is equivalent to @xmath920 , so @xmath921 where now @xmath922 if @xmath923 for all @xmath890 and we have the relation @xmath924 for all @xmath27 and @xmath925 .",
    "accordingly , we define a right action of @xmath859 on the space of functions in  ( [ onupperh ] ) by @xmath926 then @xmath927 note that the central subgroup @xmath928 acts by @xmath929 for @xmath930",
    ".    the @xmath39-vector space of modular forms of weight @xmath5 and level @xmath2 on @xmath200 is finite - dimensional and is denoted @xmath911 .",
    "[ modformourdef ] there is a bijection between @xmath911 and the space of functions @xmath931 that are holomorphic in the first variable and locally constant in the second one and such that @xmath932    from now on , we will only work with modular forms @xmath25 as presented in lemma [ modformourdef ] .",
    "we define the _ quaternionic shimura variety of level @xmath2 _ associated to @xmath200 as the double coset @xmath933 the set @xmath934 can be equipped the structure of a complex ( possibly disconnected ) riemannian manifold of dimension @xmath277 .",
    "we recover first the definition of classical modular forms when @xmath96 and @xmath935 . for simplicity , we take @xmath936 . in this case , @xmath280 so @xmath882 and @xmath937 .    the action ( [ actonh ] ) is simply @xmath938 we take the definition ( [ onupperh ] ) as our starting point .",
    "the element @xmath939 identifies the upper and lower half - planes , so a modular form @xmath940 is determined by its restriction @xmath941 and the subgroup of @xmath942 which preserves @xmath30 is exactly @xmath29 .",
    "we wish to recover the classical action using this new action of @xmath29 , so we are led to consider the double coset @xmath943 .",
    "an element of this double coset is specified by an element @xmath944 up to right - multiplication by @xmath945 , i.e.  a @xmath857-lattice in @xmath946 , i.e.  @xmath947 , specified by the rows of @xmath948 .",
    "but the map @xmath949 by @xmath950 is a bijection , with inverse @xmath951 . and since @xmath29 acts transitively on the left on the set of lattices @xmath952 , we conclude that @xmath953 .",
    "it follows that @xmath25 is uniquely specified by the function @xmath954 for @xmath27 , which by abuse of notation we write simply @xmath20 .",
    "the stabilizer of @xmath29 acting on @xmath945 by multiplication on the left is @xmath955 , so we recover the condition @xmath956 for all @xmath957 , which is exactly the definition given in section 1 .    the interested reader can modify this argument for @xmath958 ; alternatively , we give a general derivation below .",
    "we now define cusp forms . if @xmath959 , then we are in the situation of hilbert modular forms ( but over a field with arbitrary class number ) : so we define a _ cusp form _ to be a form @xmath25 such that @xmath46 whenever @xmath24 tends to a cusp @xmath129 . otherwise , the shimura variety @xmath934 is compact .",
    "if @xmath200 is indefinite , so @xmath960 , then there are no cusps , and we define the space of cusp forms to be @xmath961 .",
    "finally , suppose @xmath200 is definite ; then @xmath236 .",
    "if @xmath962 , then we define @xmath963 to be the space of those @xmath964 such that @xmath25 factors through @xmath965 ; otherwise , we set @xmath966",
    ". then there is an orthogonal decomposition @xmath967 and we call @xmath968 the space of _ cusp forms _ for @xmath200 .    the spaces @xmath911 and @xmath968 come equipped with an action of pairwise commuting diagonalizable _ hecke operators _ @xmath151 indexed by the nonzero ideals @xmath150 of @xmath94 , defined as follows . given @xmath969 and @xmath970",
    ", we define a hecke operator associated to @xmath971 as follows : we write @xmath972 and let @xmath973 ( again , although it may seem unnatural , the choice of inverse here is to make the definitions agree with the classical case . ) for a prime @xmath154 of @xmath94 with @xmath471 , we denote by @xmath172 the hecke operator @xmath974 where @xmath970 is such that @xmath975 for @xmath976 and @xmath977 where @xmath978 is a uniformizer at @xmath154 .",
    "equivalently , for a prime @xmath154 and @xmath979 such that @xmath980 , we define @xmath981 a set of cardinality @xmath261 , and define @xmath982 where we have implicitly chosen representatives @xmath983 for the orbits in @xmath260 . for an ideal @xmath150 of @xmath94 , the operator @xmath151 is defined analogously .",
    "we say that a cusp form @xmath25 is a _ newform _ if it is an eigenvector of the hecke operators which does not belong to @xmath984 for @xmath985 .    to unpack this definition further , and to relate this definition with the definitions given previously , we investigate the structure of the shimura variety @xmath986    by eichler s theorem of norms ( * ? ? ?",
    "* theorme iii.4.1 ) , we have @xmath987 i.e.  the norms from @xmath859 consists of the subgroup of elements of @xmath1 which are positive at all real places which are ramified in @xmath200 .",
    "in particular , @xmath988 , where @xmath989 is the subgroup of @xmath859 whose elements have totally positive reduced norm .",
    "the group @xmath990 acts on @xmath242 , therefore we may identify @xmath991 and a modular form on @xmath992 can be uniquely recovered from its restriction to @xmath993 .",
    "now we have a natural ( continuous ) projection map @xmath994 the reduced norm gives a surjective map @xmath995 where @xmath136 denotes the strict class group of @xmath94 , i.e.  the ray class group of @xmath94 with modulus equal to the product of all real ( infinite ) places of @xmath1 .",
    "the theorem of strong approximation ( * ? ? ?",
    "* thorme iii.4.3 ) implies that ( [ strongapprox ] ) is a bijection if @xmath200 is indefinite .",
    "so our description will accordingly depend on whether @xmath200 is indefinite or definite .",
    "first , suppose that @xmath200 is indefinite .",
    "then space @xmath934 is the disjoint union of connected riemannian manifolds indexed by @xmath136 , which we identify explicitly as follows .",
    "let the ideals @xmath996 form a set of representatives for @xmath136 , and let @xmath997 be such that @xmath998 .",
    "( for the trivial class @xmath999 , we choose @xmath1000 ) . by ( [ strongapprox ] )",
    ", there exists @xmath1001 such that @xmath1002 .",
    "we let @xmath1003 so that @xmath1004 , and we put @xmath1005 .",
    "then we have @xmath1006 \\in \\operatorname{cl}^+({{\\mathbb{z}}}_f ) } b_+^\\times ( { \\mathcal{h}}^r \\times { \\widehat{\\alpha}}{\\widehat{\\mathcal o}}^\\times ) \\xrightarrow{\\sim } \\bigsqcup_{[{\\mathfrak{a } } ] \\in \\operatorname{cl}^+({{\\mathbb{z}}}_f ) } \\gamma_{\\mathfrak{a}}\\backslash { \\mathcal{h}}^r,\\ ] ] where the last identification is obtained via the bijection @xmath1007    now let @xmath964 , so that @xmath1008 satisfies @xmath1009 for all @xmath890 .",
    "let @xmath1010 be the space of functions @xmath1011 such that @xmath1012 for all @xmath1013 , where we define @xmath1014 for @xmath890 .",
    "then by ( [ bplushr ] ) , the map @xmath1015 \\in \\operatorname{cl}^+({{\\mathbb{z}}}_f ) } m_k^b({\\mathfrak{n } } , { \\mathfrak{a}})\\\\ f&\\mapsto ( f_{\\mathfrak{a } } ) \\end{aligned}\\ ] ] where @xmath1016 is an isomorphism .",
    "we now explain how the hecke module structure on the left - hand side of ( [ adelic - to - tuples ] ) , defined in ( [ heckeindefiniteadel1])([heckeindefiniteadel2 ] ) , is carried over to the right - hand side .",
    "we follow shimura  ( * ? ? ?",
    "* section 2 ) .",
    "we consider the action on the summand corresponding to @xmath1017 \\in \\operatorname{cl}^+({{\\mathbb{z}}}_f)$ ] .",
    "extending the notation above , among the representatives chosen , let @xmath137 be such that @xmath1018=[{\\mathfrak{a}}{\\mathfrak{p}}^{-1}]$ ] , let @xmath1019 , and let @xmath1020 be such that @xmath1021 .    by definition ,",
    "@xmath1022 let @xmath1023 .",
    "then by strong approximation , we have @xmath1024 with @xmath1025 , since this lattice has reduced norm @xmath1026 = [ ( 1)]$ ] .",
    "therefore , there exists @xmath1027 such that @xmath1028 whence @xmath1029 the second sum runs over a choice of @xmath1030 as in equation ( [ apob ] ) corresponding to each @xmath1023 .",
    "this latter sum can be identified with a sum over values of @xmath1031 as follows .",
    "we have @xmath1032 the first equality follows from the @xmath859-invariance of @xmath25 and the others by definition of the slash operators .",
    "putting these together , we have @xmath1033 ( the naturality of this definition explains the choice of inverses above . )    this adelic calculation can be made global as follows .",
    "let @xmath1034 and @xmath1035 . for @xmath1023",
    ", we have @xmath1036 hence @xmath1037 the elements @xmath1030 thus obtained are characterized by their norms ( in the right lattice ) , as with the hecke operators defined previously ( [ heckethetapclno1 ] ) : we analogously define @xmath1038 then for @xmath1039 , we have @xmath1040 and @xmath1041 where @xmath1018=[{\\mathfrak{a}}{\\mathfrak{p}}^{-1}]$ ] .    if @xmath1 has strict class number @xmath7 , then @xmath1042 so @xmath1043 as in section 5 .",
    "we note that the isomorphism  ( [ adelic - to - tuples ] ) preserves the subspace of cusp forms in a way that is compatible with the hecke action , so we have a decomposition @xmath1044 \\in \\operatorname{cl}^+({{\\mathbb{z}}}_f ) } s_k^b({\\mathfrak{n } } , { \\mathfrak{a}}).\\ ] ]    let @xmath258 , and let @xmath1045",
    ". then we may take @xmath1046 , and so we find simply that @xmath1047 let @xmath1048 then @xmath1049 \\in \\operatorname{cl}^+({{\\mathbb{z}}}_f ) } \\gamma_0({\\mathfrak{n}},{\\mathfrak{a } } ) \\backslash { \\mathcal{h}}^n\\ ] ] is a disjoint union .    a _ hilbert modular form of weight @xmath5 and level @xmath2 _ is a tuple @xmath1050 of holomorphic functions @xmath1051 , indexed by @xmath136 , such that for all @xmath1052 we have @xmath1053 ( with the extra assumption that @xmath25 is holomorphic at the cusps if @xmath96 ) . or , put another way , let @xmath1054 be the set of holomorphic functions @xmath1055 such that @xmath1056 for all @xmath1057 ; then @xmath1058 } m_k({\\mathfrak{n}},{\\mathfrak{a}}).\\ ] ] in particular , we recover the definitions in section 2 when @xmath1 has strict class number @xmath7 .",
    "a modular form @xmath1059 admits a fourier expansion @xmath1060 analogous to ( [ qexphilbert ] ) .",
    "we say that @xmath1059 is a _ cusp form _ if @xmath46 as @xmath24 tends to any cusp .",
    "letting @xmath1061 be the space of such cusp forms , we have @xmath1062 } s_k({\\mathfrak{n}},{\\mathfrak{a}}).\\ ] ]    let @xmath1063 be a hilbert cusp form and let @xmath1064 be an ideal .",
    "suppose that @xmath1065=[{\\mathfrak{a}}{\\mathfrak{d}}^{-1}]$ ] amongst the representatives chosen for @xmath1066 , and let @xmath1067 be such that @xmath1068 .",
    "we define @xmath1069 ; the transformation rule implies that @xmath148 only depends on @xmath150 and we call @xmath148 the _ fourier coefficient _ of @xmath25 at @xmath150 .",
    "now suppose that @xmath200 is definite .",
    "then the shimura variety is simply @xmath1070 and so is canonically identified with the set of right ideal classes of @xmath215 .",
    "note that the reduced norm map ( [ strongapprox ] ) here is the map @xmath1071 which is surjective but not a bijection , in general .",
    "a modular form @xmath964 is then just a map @xmath1072 such that @xmath1073 for all @xmath1074 .",
    "such a function is completely determined by its values on a set of representatives of @xmath297 ; moreover , given any right ideal @xmath1075 , the stabilizer of @xmath859 acting on @xmath1076 by left multiplication is @xmath1077 .",
    "therefore , there is an isomorphism of complex vector spaces given by @xmath1078 \\in \\operatorname{cl}({\\mathcal{o } } ) \\\\",
    "i={\\widehat{\\alpha}}{\\widehat{\\mathcal o}}\\cap b } } w_k({{\\mathbb{c}}})^{\\gamma(i)}\\\\ f&\\mapsto & ( f({\\widehat{\\alpha } } ) ) , \\end{aligned}\\ ] ] where @xmath1079 and @xmath1080 is the @xmath1081-invariant subspace of @xmath886 .",
    "having now discussed both the definite and indefinite cases in turn , we return to a general quaternion algebra @xmath200 .",
    "let @xmath1082 be a newform .",
    "a theorem of shimura states that the coefficients @xmath1083 are algebraic integers and @xmath1084 is a number field .",
    "the hecke eigenvalues @xmath148 determine the @xmath81-series @xmath1085 associated to @xmath25 ( defined for @xmath83 ) .",
    "moreover , associated to @xmath25 is a galois representation : for @xmath166 a prime of @xmath1086 and @xmath1087 the completion of @xmath806 at @xmath166 , there is an absolutely irreducible , totally odd galois representation @xmath1088 such that , for any prime @xmath168 , we have @xmath1089 the existence of this representation is due to work of blasius - rogawski @xcite , carayol @xcite , deligne @xcite , saito @xcite , taylor @xcite , and wiles @xcite .",
    "the statement of the jacquet - langlands correspondence ( [ shimizuclno1 ] ) reads the same in this more general context .",
    "[ shimizuadel ] there is an injective map of hecke modules @xmath1090 whose image consists of those forms which are new at all primes dividing @xmath225 .",
    "we are now ready to state the main general result of this article , generalizing the result of theorem [ mainthmclno1 ] to arbitrary class number and arbitrary weight .",
    "there exists an algorithm which , given a totally real field @xmath1 , a nonzero ideal @xmath105 , and a weight @xmath3}$ ] , computes the space @xmath4 of hilbert cusp forms of level @xmath2 over @xmath1 as a hecke module .    the proof of this theorem is discussed in the next two sections .",
    "it falls again naturally into two methods , definite and indefinite , which overlap just as in remark [ rmkgenspace ] .",
    "in this section , we return to the totally definite case but allow arbitrary class number . as explained above , the space @xmath911 of modular forms of level @xmath2 and weight @xmath5 on @xmath200 is the space of functions @xmath1072 such that @xmath1073 for all @xmath1074 .",
    "we can use the identification ( [ defarbclnoii ] ) to compute the space @xmath968 as in the direct approach of section 4 , with the appropriate modifications .",
    "let @xmath317 be a set of representatives for @xmath297 such that @xmath343 is coprime to @xmath1091 for all @xmath434 .",
    "let @xmath1092 be such that @xmath1093 , and let @xmath1094 . then dualizing the isomorphism ( [ defarbclnoii ] )",
    ", we have @xmath1095 the hecke module structure on this space is defined similarly as in section 4 , as the following example illustrates .",
    "[ defclnowoshapiro ] consider the totally real quartic field @xmath1096 where @xmath1097",
    ". then @xmath1 has discriminant @xmath1098 and galois group @xmath1099 .",
    "we have @xmath1100 ( but @xmath1101 ) .",
    "the quaternion algebra @xmath399 is unramified at all finite places ( and ramified at all real places ) .",
    "we compute a maximal order @xmath215 and find that @xmath1102 .",
    "we compute the action of the hecke operators as in ( [ heckedefdefinite ] ) : we identify the isomorphism classes of the @xmath261 right ideals of norm @xmath154 inside each right ideal @xmath213 in a set of representatives for @xmath297 .",
    "we compute , for example , that @xmath1103 where @xmath1104 ; note this matrix has a block form , corresponding to the fact that @xmath1105 represents the nontrivial class in @xmath136 .",
    "correspondingly , @xmath1106 with @xmath1107 is a block scalar matrix , as @xmath1108 is trivial in @xmath136 . in this case",
    ", the space @xmath1109 of functions that factor through the reduced norm has dimension @xmath1110 , so @xmath1111 , and we find that this space is irreducible as a hecke module and so has a unique constituent @xmath25 .",
    "we obtain the following table of hecke eigenvalues : @xmath1112 here @xmath1113 satisfies the polynomial @xmath1114 . as in section 6 , we predict the existence of an abelian variety over @xmath1 with real multiplication by @xmath1115 and everywhere good reduction .    as in section 4",
    ", the disadvantage of the approach used in example [ defclnowoshapiro ] is that for each level @xmath2 , one must compute the set of ideal classes @xmath431 . by working with a more complicated coefficient module we can work with ideal classes only with the maximal order @xmath448 , as follows .",
    "changing notation , now let @xmath433 be representatives for @xmath432 , with @xmath1116 , and let @xmath1117 .",
    "by strong approximation , we may assume that each @xmath343 is coprime to @xmath1091 : indeed , we may assume each @xmath343 is supported in any set @xmath224 of primes that generate @xmath136 . let @xmath1118 be the left order of @xmath321 .",
    "then @xmath1119 .",
    "let @xmath1120 for @xmath1121 represent the @xmath1122-connecting ideals of norm @xmath2 : that is , @xmath1123 and if @xmath1124 then @xmath1125 . then the set @xmath1126 , where @xmath1127 , covers all isomorphism classes of right @xmath215-ideals , but not necessarily uniquely : two such ideals @xmath1128 and @xmath1129 are isomorphic if and only if @xmath1130 and there exists @xmath1131 such that @xmath1132 , comparing the elements @xmath1133 . the action of @xmath1134 can be equivalently given on the set of indices @xmath1121 : via the ( reduction of a ) splitting map @xmath1135 each @xmath1134 acts on the left on @xmath443 , and we have @xmath1136 .",
    "we conclude that @xmath1137 , where @xmath1138 in this presentation , the hecke operators act as follows . for a prime @xmath154 ,",
    "let @xmath1139 we then define the linear map @xmath1140 on each component by the rule @xmath1141 this is indeed an isomorphism of hecke modules .",
    "for further details , see work of the first author ( * ? ? ?",
    "* theorem 2 ) which traces these maps under the assumption that @xmath1 has narrow class number one , but this assumption can be easily removed .",
    "put another way , by the decomposition @xmath1142 we decompose the set @xmath1143 as @xmath1144 where the last identification is obtained by sending @xmath1145 to @xmath1146 .",
    "thus , analogously to  ( [ breakup ] ) , we get a decomposition    @xmath1147    in particular , this gives @xmath1148 .",
    "from this , we get an identification @xmath1149 where we set @xmath1150 after choosing @xmath1151 such that @xmath1152 . again",
    ", the decomposition  ( [ def - adelic - tuples ] ) is analogous to  ( [ adelic - to - tuples ] ) , and one shows that it is a hecke module isomorphism by arguing similarly .",
    "now @xmath964 is by definition a map @xmath1072 such that @xmath1009 for all @xmath890 .",
    "associated to such a map , via the identification ( [ decompident ] ) , such a map is uniquely defined by a tuple of maps @xmath1153 with @xmath1154 such that @xmath1009 for all @xmath1155 . in other words , @xmath1156 but then as in ( [ identactiono1n ] ) , we have @xmath1157    the real quadratic field @xmath1158 has strict class number @xmath6 and class number @xmath6 .",
    "we compute that the space @xmath713 of hilbert cusp forms of level 1 and parallel weight @xmath6 has dimension @xmath1159 .",
    "it decomposes into four hecke constituents of dimension @xmath7 , six of dimension @xmath6 , two of dimension @xmath201 and one of dimension @xmath750 .",
    "the table below contains the first few hecke eigenvalues of the one - dimensional constituents .",
    "@xmath1160    the forms @xmath1161 and @xmath1162 ( resp .",
    "@xmath1163 and @xmath1164 ) are interchanged by the action of @xmath795 ( on the ideals @xmath154 ) .",
    "the forms @xmath1161 and @xmath1163 ( resp .",
    "@xmath1162 and @xmath1164 ) are interchanged by the action of @xmath136 , so these forms are twists via the strict class character of @xmath1165 , where @xmath1166 denotes the strict class field of @xmath1 .",
    "elkies has found a curve @xmath79 which gives rise to the above data : @xmath1167 the curve @xmath79 has @xmath770-invariant @xmath1168 and has everywhere good reduction .",
    "we conclude that @xmath79 is modular using kisin  ( * ? ? ?",
    "* theorem 2.2.18 ) ( see also kisin  ( * ? ? ? * theorem 3.5.5 ) ) : we need to verify that @xmath180 is split in @xmath1 , that @xmath79 has no cm , and that the representation @xmath1169 has surjective reduction @xmath1170 which is solvable hence modular .",
    "we find that @xmath79 matches the form @xmath1161 ; so its conjugate by @xmath795 corresponds to @xmath1162 and the quadratic twist of @xmath79 by the fundamental unit @xmath1171 ( of norm @xmath1172 ) corresponds to @xmath1163 ( and its conjugate to @xmath1164 ) .",
    "the input of our algorithm is a totally real number field @xmath1 of degree @xmath60 , a totally definite quaternion algebra @xmath200 with discriminant @xmath225 , an integral ideal @xmath661 which is coprime with @xmath225 , a weight @xmath1173 such that @xmath1174 and @xmath1175 , and a prime @xmath1176 .",
    "the output is then a matrix giving the action of @xmath172 in a basis of @xmath1177 which is independent of @xmath154 . by computing enough @xmath172 and simultaneously diagonalising ,",
    "one obtains all hecke constituents corresponding to hilbert newforms of level @xmath2 and weight @xmath5 .",
    "the algorithm starts by finding a maximal order @xmath448 , then computes a set of representatives @xmath432 of the right ideal classes of @xmath448 whose norms generate @xmath1066 and are supported outside @xmath1091 .",
    "this part of the algorithm uses work of the second author and kirschmer  @xcite , it is the most time consuming part but can be seen as a precomputation .",
    "next , the algorithm finds a fundamental domain for the action of each @xmath1178 on @xmath443 , and computes @xmath911 as the direct sum of the @xmath1179\\in x_0^b({\\mathfrak{n}})_i } w_k({{\\mathbb{c}}})^{\\gamma_x},\\ ] ] where @xmath1180 is the stabilizer of @xmath209 in @xmath1178 . from this , one obtains a basis of @xmath911 .",
    "finally , the algorithm computes the sets @xmath1181 , and then the block matrices which give the action of @xmath172 in this basis .",
    "we refer to  @xcite and  @xcite for further details on the implementation .",
    "in this section , we generalize the indefinite method to arbitrary class number . we carry over the notation from section 7 , and now take the quaternion algebra @xmath200 to be ramified at all but one real place .    in this case , from ( [ breakup])([bplushr ] )",
    ", the space @xmath1182 is the disjoint union of riemann surfaces indexed by @xmath1183 .",
    "let @xmath1184 be a set of representatives for @xmath136 and let @xmath997 be such that @xmath998 for each @xmath1052 . then @xmath1185 \\in \\operatorname{cl}^+({{\\mathbb{z}}}_f ) } \\gamma_{\\mathfrak{a}}\\backslash { \\mathcal{h}}= \\bigsqcup_{[{\\mathfrak{a } } ] \\in \\operatorname{cl}^+({{\\mathbb{z}}}_f ) } x_{\\mathfrak{a}}({{\\mathbb{c } } } ) \\\\\\ ] ] where @xmath1003 and @xmath1186 .",
    "therefore , a modular form of weight @xmath5 and level @xmath2 is a tuple @xmath1187 of functions @xmath1188 , indexed by @xmath1017 \\in \\operatorname{cl}^+ { { \\mathbb{z}}}_f$ ] , such that for all @xmath1052 , we have @xmath1189 for all @xmath1013 and all @xmath27 . in particular ,",
    "if @xmath962 is parallel weight @xmath6 , then @xmath1187 corresponds to a tuple of holomorphic @xmath7-forms @xmath1190 , one for each curve @xmath1191 .",
    "we compute with this space of functions by relating them to cohomology , and for that we must modify the coefficient module .",
    "define the right @xmath1192-module @xmath1193 the group @xmath859 acts on @xmath1194 via the composite splitting @xmath1195 given by @xmath109 .",
    "the eichler - shimura theorem , combined with the isomorphism ( [ adelic - to - tuples ] ) , applied to each component @xmath1191 of @xmath1196 in ( [ breakupshimcurve ] ) , gives the isomorphism of hecke modules @xmath1197 } h^1(\\gamma_{{\\mathfrak{a } } } , v_k({{\\mathbb{c}}}))^+,\\ ] ] where @xmath1198 denotes the @xmath1199-eigenspace for complex conjugation .    in the description ( [ woahsk0 ] ) , the hecke operators act on @xmath1200 in the following way ; we follow their definition in ( [ thetapjv ] ) .",
    "let @xmath154 be a prime ideal of @xmath94 with @xmath471 .",
    "we consider the @xmath1018$]-summand , and given @xmath1201 we will define @xmath1202 , where @xmath1018=[{\\mathfrak{p}}^{-1 } { \\mathfrak{a}}]$ ] .",
    "let @xmath1203 and @xmath1204 so that @xmath1205 and @xmath1206 , and let @xmath1207 where @xmath1208 acts by multiplication on the left .",
    "let @xmath1209 , so that @xmath1210",
    ". then the map @xmath1211 on @xmath859 induces a bijection ( of the equivalence classes ) of @xmath1212 .",
    "therefore , for every @xmath1213 , there exists @xmath1214 and @xmath1215 such that @xmath1216 . from ( [ finalhecke ! ] ) and the eichler - shimura theorem , we have @xmath1217 one can similarly define the atkin - lehner involutions .    admittedly , this description is complicated , but it can be summarized simply : a hecke operator @xmath172 permutes the summands ( [ woahsk0 ] ) in accordance with translation by @xmath1218 $ ] in @xmath136 , and adjusting for this factor one can principalize as before ( when the strict class number was 1 ) .",
    "the resulting hecke matrices are consequently block matrices .",
    "let @xmath1096 be the ( totally real ) cubic field of prime discriminant @xmath1219 , with @xmath1220 .",
    "then @xmath1 has galois group @xmath188 and @xmath174 $ ] .",
    "the field @xmath1 has class number @xmath7 but strict class number @xmath6 : the unit @xmath1221 generates the group @xmath1222 of totally positive units modulo squares .",
    "let @xmath1223 be the quaternion algebra with @xmath357 , @xmath1224 , and @xmath359 .",
    "then @xmath200 has discriminant @xmath309 and is ramified at two of the three real places and unramified at the place with @xmath1225 , corresponding to @xmath1226 .",
    "the order @xmath1227 is an eichler order of level @xmath1228 where @xmath1229 .",
    "the ideals @xmath710 and @xmath1231 represent the classes in the strict class group @xmath136 .",
    "the ideal @xmath1232 has @xmath1233 .",
    "the left order of @xmath1234 is @xmath1235 where @xmath1236 a fundamental domain for the action of @xmath1237 on @xmath30 is as follows .        the orders @xmath215 and @xmath1238 are not isomorphic since the connecting ideal @xmath1239 ( with left order @xmath1238 and right order @xmath215 ) is not principal",
    "this implies that the groups @xmath454 and @xmath1240 are not conjugate as subgroups of @xmath18 but nevertheless are isomorphic as abstract groups : they both have signature @xmath1241 , so that @xmath1242\\delta_1\\cdots \\delta_4 = 1 \\rangle.\\ ] ] in particular , both @xmath1243 and @xmath1191 have genus @xmath7 , so @xmath1244 we choose a basis of characteristic functions on @xmath1245 as a basis for @xmath1246 and similarly for @xmath1247 .",
    "we now compute hecke operators following the above .",
    "let @xmath1248 .",
    "we compute that complex conjugation acts on @xmath300 by the matrix @xmath1249 note that @xmath1250 in this case preserves each factor . now consider the hecke operator @xmath172 where @xmath1251 and @xmath1252 .",
    "then @xmath154 represents the nontrivial class in @xmath136 .",
    "we compute that @xmath1253 and restricting we get @xmath1254 therefore there are two eigenspaces for @xmath1255 with eigenvalues @xmath1256 . by contrast , the hecke operator @xmath1257 acts by the scalar matrix @xmath180 on @xmath300 , preserving each component .    continuing in this way , we find the following table of eigenvalues : @xmath1258 clearly , the form @xmath181 is the quadratic twist of the form @xmath25 by the nontrivial character of the strict class group @xmath1165 , where @xmath1166 is the strict class field of @xmath1 .",
    "note also that these forms do not arise from base change from @xmath0 , since @xmath429 has three different values for the primes @xmath154 of norm @xmath397 .",
    "we are then led to search for elliptic curves of conductor @xmath1228 , and we find two : @xmath1259 each of these curves have nontrivial @xmath1260-torsion over @xmath1 , so as above they are modular and we match hecke eigenvalues to find that @xmath806 corresponds to @xmath25 and @xmath1261 corresponds to @xmath181 .    in this situation , although by the theory of canonical models due to deligne we know that the variety @xmath1262 has a model @xmath1263 over @xmath1 , the curves themselves are not defined over @xmath1they are interchanged by the action of @xmath1165 . nevertheless , the jacobian of @xmath1263 is an abelian variety of dimension @xmath6 defined over @xmath1 which is isogenous to @xmath1264we characterize in this way isogeny classes , not isomorphism classes .    as in the case of class number @xmath7 , the application of shapiro s lemma",
    "allows us always to work with the group associated to a maximal order , as follows .",
    "let @xmath1265 be a maximal order containing @xmath215 , and for each ideal @xmath1052 , let @xmath1266 be the maximal order containing @xmath1238 , and let @xmath1267 .",
    "further , define @xmath1268 for each @xmath1052 .",
    "then shapiro s lemma implies that @xmath1269 and so @xmath1044 } h^1(\\gamma(1)_{{\\mathfrak{a } } } , v_k({{\\mathbb{c}}})_{\\mathfrak{a}})^+.\\ ] ]    our algorithm takes as input a totally real field @xmath1 of degree @xmath93=n$ ] , a quaternion algebra @xmath200 over @xmath1 split at a unique real place , an ideal @xmath1270 coprime to the discriminant @xmath225 of @xmath200 , a vector @xmath1271 , and a prime @xmath471 , and outputs the matrix of the hecke operator @xmath172 acting on the space @xmath1272 with respect to some fixed basis which does not depend on @xmath154 . from these matrices",
    ", we decompose the space @xmath300 into hecke - irreducible subspaces by linear algebra .",
    "we give a short overview of this algorithm .",
    "first , some precomputation .",
    "we precompute a set of representatives @xmath1017 $ ] for the strict class group @xmath136 with each @xmath1052 coprime to @xmath1273 . for each representative ideal @xmath1052 , precompute a right @xmath448-ideal @xmath1274 such that @xmath1275 and let @xmath1276 be the left order of @xmath1274 .",
    "next , we compute for each @xmath1052 a finite presentation for @xmath1277 consisting of a ( minimal ) set of generators @xmath1278 and relations @xmath1279 together with a solution to the word problem for the computed presentation @xcite . then using standard linear algebra techniques , we compute a basis for the space @xmath1280 } h^1(\\gamma(1)_{{\\mathfrak{a } } } , v_k({{\\mathbb{c}}})_{\\mathfrak{a}})$ ] .",
    "first , compute the ideal @xmath137 with ideal class @xmath1018=[{\\mathfrak{p}}^{-1}{\\mathfrak{a}}]$ ] .",
    "compute the left ideals @xmath1282 indexed by the elements @xmath1283 . then compute the left @xmath1284-ideals @xmath1285 and compute totally positive generators @xmath1286 corresponding to @xmath1287 @xcite .",
    "now , for each @xmath512 in a set of generators @xmath1278 for @xmath1240 , compute the permutation @xmath475 of @xmath266 ( * ? ? ?",
    "* algorithm 5.8 ) and then the elements @xmath1288 for @xmath273 ; write each such element @xmath1289 as a word in @xmath1290 and then apply the formula @xmath1291      999 don blasius , _ elliptic curves , hilbert modular forms , and the hodge conjecture _ , contributions to automorphic forms , geometry , and number theory , johns hopkins univ .   press , baltimore , 2004 , 83103 .",
    "lassina dembl and steve donnelly , _",
    "computing hilbert modular forms over fields with nontrivial class group _ , algorithmic number theory ( banff , 2008 ) , lecture notes in comput .",
    "5011 , springer , berlin , 2008 , 371386 .",
    "martin eichler , _ the basis problem for modular forms and the traces of the hecke operators _ , modular functions of one variable , i ( proc .",
    "internat .",
    "summer school , univ .",
    "antwerp , antwerp , 1972 ) , lecture notes in math .",
    "320 , springer , berlin , 1973 , 75151 .",
    "martin eichler , _ correction to : `` the basis problem for modular forms and the traces of the hecke operators '' _ , modular functions of one variable , iv ( proc",
    ".  internat .",
    "summer school , univ .",
    "antwerp , antwerp , 1972 ) , lecture notes in math .",
    "476 , springer , berlin , 1975 , 145147 .",
    "stephen gelbart and herv jacquet , _ forms of gl(2 ) from the analytic point of view _ , automorphic forms , representations and l - functions ( corvallis , or , 1977 ) , vol .  1 , eds .  a.  borel and w.  casselman , proc",
    ".  sympos .  pure math .",
    "* 33 * , amer .",
    "soc . , providence , ri , 1979 , 213251 .",
    "mark kisin , _ moduli of finite flat group schemes , and modularity _ , ann .  of math .",
    "( 2 ) * 170 * ( 2009 ) , no .  3 , 10851180 .",
    "koopa tak - lun koo , william stein , and gabor wiese , _ on the generation of the coefficient field of a newform by a single hecke eigenvalue _ , j.  thorie nombres bordeaux * 20 * ( 2008 ) , no .  2 , 373384 .",
    "david kohel , _ hecke module structure of quaternions _ ,",
    "class field theory : its centenary and prospect ( tokyo , 1998 ) , ed .",
    "k.  miyake , adv .",
    "stud .  pure math .",
    ", vol .  30 , math .  soc .",
    "japan , tokyo , 2001 , 177195 .",
    "jean - francois mestre , _ la mthode des graphes : exemples et applications _ , proceedings of the international conference on class numbers and fundamental units of algebraic number fields ( katata ) , nagoya univ . ,",
    "nagoya , 1986 , 217242 .",
    "jean - pierre serre , _ congruences et formes modulaires [ daprs h. p. f. swinnerton - dyer ] _ , sminaire bourbaki , 24e anne ( 1971/1972 ) , exp .",
    "416 , _ lecture notes in math .",
    "_ , vol .  317 , springer , berlin , 1973 , 319338 .",
    "john voight , _ computing automorphic forms on shimura curves over fields with arbitrary class number _ , algorithmic number theory ( ants ix , nancy , france , 2010 ) , eds .",
    "guillaume hanrot , francois morain , and emmanuel thom , lecture notes in comp .",
    ", vol .  6197 , springer , berlin , 2010 , 357371 ."
  ],
  "abstract_text": [
    "<S> we exhibit algorithms to compute systems of hecke eigenvalues for spaces of hilbert modular forms over a totally real field . </S>",
    "<S> we provide many explicit examples as well as applications to modularity and galois representations .    </S>",
    "<S> the study of modular forms remains a dominant theme in modern number theory , a consequence of their intrinsic appeal as well as their applications to a wide variety of mathematical problems . </S>",
    "<S> this subject has seen dramatic progress during the past half - century in an environment where both abstract theory and explicit computation have developed in parallel . </S>",
    "<S> experiments will remain an essential tool in the years ahead , especially as we turn from classical contexts to less familiar terrain .    in this article </S>",
    "<S> , we discuss methods for explicitly computing spaces of hilbert modular forms , refashioning algorithms over @xmath0 to the setting of totally real fields . </S>",
    "<S> saving definitions for the sections that follow , we state our main result .    </S>",
    "<S> there exists an algorithm that , given a totally real field @xmath1 , a nonzero ideal @xmath2 of the ring of integers of @xmath1 , and a weight @xmath3}$ ] , computes the space @xmath4 of hilbert cusp forms of weight @xmath5 and level @xmath2 over @xmath1 as a hecke module .    </S>",
    "<S> this theorem is the work of the first author @xcite together with donnelly @xcite combined with work of the second author @xcite together with greenberg @xcite .    </S>",
    "<S> the outline of this article is as follows . </S>",
    "<S> after briefly recalling methods for classical ( elliptic ) modular forms in  1 , we introduce our results for computing hilbert modular forms in the simplest case ( of parallel weight @xmath6 over a totally real field of strict class number @xmath7 ) in  2 . in brief , </S>",
    "<S> our methods employ the jacquet - langlands correspondence to relate spaces of hilbert modular forms to spaces of quaternionic modular forms that are more amenable to computation ; we discuss this matter in  3 , and consider two approaches ( definite and indefinite ) in  </S>",
    "<S>  45 . in  </S>",
    "<S> 6 we consider several examples in detail . </S>",
    "<S> having thereby established the main ideas , we turn to an adelic description of hilbert modular forms and their quaternionic incarnations in  7 , then give a complete and general description of our algorithms in adelic language in   </S>",
    "<S> 89 .    </S>",
    "<S> although it is our intention to keep these notes as self - contained as possible , we will assume that the reader has a basic familiarity with classical modular forms and the methods employed to compute them . </S>",
    "<S> the algorithms exhibited below have been implemented in the computer algebra system @xcite and our examples are computed using this implementation . </S>",
    "<S> donnelly and the second author @xcite are using this implementation to compute hecke data for thousands of forms over totally real fields up to degree @xmath8 .    </S>",
    "<S> these notes arose from lectures at the centre de recerca matemtica ( crm ) in barcelona ; it is our great pleasure to thank the crm for the invitation to speak and the hospitality of the organizers , luis dieulefait and victor rotger . </S>",
    "<S> the authors would also like to thank matthew greenberg , ariel pacetti , aurel page , jeroen sijsling , and the referee for many helpful comments as well as benedict gross for his remarks which we include at the end of section 6 . </S>",
    "<S> the first author is supported by a marie - curie fellowship , and the second author by an nsf grant no .  </S>",
    "<S> dms-0901971 . </S>"
  ]
}