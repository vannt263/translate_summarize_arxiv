{
  "article_text": [
    "it is well known that transport problems on the line involving convex cost functions have explicit solutions , consisting in a monotone rearrangement . recently",
    ", an efficient method has been introduced to tackle this issue on the circle  @xcite . in this note",
    "we introduce an algorithm that enables to tackle optimal transport problems on the line ( but actually also on the circle ) with concave costs .",
    "our algorithm complements the method suggested by mccann  @xcite .",
    "mccann considers general real values of supply and demand and shows how the problem can be reduced to convex optimization somewhat similar to the simplex method in linear programming .",
    "our approach as presented here is developed for the case of unit masses and is closer to the purely combinatorial approach of  @xcite , but extends it to a general concave cost function .",
    "the extension to integer masses will be presented in  @xcite . +",
    "the method we propose is based on a class of local indicators , that allow to detect consecutive points that are matched in an optimal transport plan .",
    "thanks to the low number of evaluations of the cost function required to apply the indicators , we derive an algorithm that finds an optimal transport plan in @xmath2 operations in the worst case . in practice , the computational cost of this method appears to behave linearly with respect to @xmath3 .",
    "+ since the indicators apply locally , the algorithm can be massively parallelized and also allows to treat optimal transport problems on the circle . in this way",
    ", it extends the work of aggarwal _ et al . _",
    "@xcite in which cost functions have a linear dependence in the distance .",
    "for @xmath4 , consider @xmath5 and @xmath6 two sets of points in @xmath1 that represent respectively demand and supply locations .",
    "the problem we consider in this note consists in minimizing the transport cost @xmath7 where @xmath8 is a permutation of @xmath9 .",
    "this permutation forms a _ transport plan_. + we focus on the case where the function @xmath10 involves a concave function as stated in the next definition .",
    "[ def : cost ] the _ cost function _ in  ( [ eq:4 ] ) is defined on @xmath1 by @xmath11 with @xmath12 , where @xmath13 is a concave non - decreasing real - valued function of a real positive variable such that @xmath14 .    some examples of such costs are given by @xmath15 with @xmath16 , and @xmath17 or @xmath18 is with @xmath19 .",
    "+ finally , we denote by @xmath20 the permutation associated to a given optimal transport plan between @xmath21 and @xmath22 : for all permutation @xmath8 of @xmath9 , @xmath23",
    "in this section , we present a way to build a particular partition of the set @xmath24 .",
    "+ consider two pairs of matched points @xmath25 and @xmath26 , say e.g. @xmath27 , @xmath28 .",
    "it is easy to prove that the following alternative holds :    1 .",
    "@xmath29\\cap [ p_{i'},q_{\\sigma^\\star(i')})]=    \\emptyset$ ] , 2 .",
    "@xmath29\\subset    [ p_{i'},q_{\\sigma^\\star(i')})]$ ] or @xmath30\\subset[p_i , q_{\\sigma^\\star(i)}]$ ] .",
    "this remark is a direct consequence of the concavity of the cost function and is often denominated as `` the non - crossing rule '' @xcite . in the next section ,",
    "we show how it allows decompose the initial situation in sub - problems where supply and demand points are alternated .",
    "+ because of the non - crossing rule in an optimal plan there are as many supply points as demand points between any pair of matched points @xmath31 and @xmath32 . for a given demand point @xmath31 ,",
    "define its _ left neighbor _ @xmath33 as the nearest supply point on the left of @xmath31 such that the numbers of supply and demand points between @xmath33 and @xmath31 are equal ; define the _",
    "right neighbor _ @xmath34 of @xmath31 in a similar way",
    ". then define a _",
    "chain _ as a maximal alternating sequence of supply and demand points ( @xmath35 ) or ( @xmath36 ) such that each @xmath37 is the right neighbor of @xmath38 and the left neighbor of @xmath39 .",
    "an extension of the proof of lemma 3 of @xcite shows that the collection of chains forms a partition of the set @xmath40 .",
    "an simple example of such a partition is shown on  fig .",
    "[ exchaine ] .",
    "( 9,0 ) ;    ( 1,0 ) node @xmath41 ; ( 4,0 ) node @xmath41 ; ( 5,0 ) node @xmath41 ; ( 8,0 ) node @xmath41 ;    ( 2,0 ) node @xmath42 ; ( 3,0 ) node @xmath42 ; ( 6,0 ) node @xmath42 ; ( 7,0 ) node @xmath42 ;    ( 2,0 ) arc ( 0:180 : .5 ) ; ( 5,0 ) arc ( 0:180:1.5 ) ; ( 6,0 ) arc ( 0:180 : .5 ) ;    ( 4,0 ) arc ( 0:-180 : .5 ) ; ( 7,0 ) arc ( 0:-180:1.5 ) ; ( 8,0 ) arc ( 0:-180 : .5 ) ;    note that construction of this collection only depends on relative positions of supply and demand points and does not involve any evaluation of the cost function .",
    "it can be done in @xmath43 operations .",
    "+ the non - crossing rule implies that all matched pairs of points in an optimal transport plan must belong to the same chain .",
    "we therefore restrict ourselves in the sequel , without loss of generality , to the case of a single chain @xmath44 for @xmath45 and keep these last notations throughout the rest of this paper .",
    "thanks to the non - crossing rule , one knows that there exists at least two consecutive points @xmath46 or @xmath47 that are matched in any optimal transport plan . starting from this remark , we take advantage of the structure of a chain to introduce a class of indicators that enable to detect a priori such pairs of points .",
    "[ def : lmi]we define @xmath48 where @xmath49 are such that @xmath50 and @xmath51 , and @xmath52 for @xmath53 , such that @xmath54 and @xmath55 .",
    "the interest of these functions lies in the next result .",
    "[ thlmi]let @xmath56 with @xmath57 and @xmath58 ( resp .",
    "@xmath59 ) , such that @xmath60 ( resp .",
    "@xmath61 ) .",
    "+ assume that    1 .",
    "@xmath62 for @xmath63 , @xmath64,[hyp1 ] 2 .",
    "@xmath65 for @xmath63 , @xmath66 , [ hyp2 ] 3 .",
    "@xmath67 ( resp .",
    "@xmath68 ) .",
    "[ hyp3 ]    then any permutation @xmath20 associated to an optimal transport plan satisfies @xmath69 for @xmath70 ( resp .",
    "@xmath71 for @xmath70 ) .    in practice",
    ", these indicators allow to find pairs of neighbors that are matched in an optimal transport plan .",
    "this result is illustrated on  fig .",
    "[ pic : thlmi ] .",
    "( 7,0 ) ;    ( 1,0 ) node @xmath41 ; ( 3,0 ) node @xmath41 ; ( 5,0 ) node @xmath41 ;    ( 2,0 ) node @xmath42 ; ( 4,0 ) node @xmath42 ; ( 6,0 ) node @xmath42 ;    ( 4,0 ) arc ( 0:180 : .5 ) ; ( 5,0 ) arc ( 0:180:1.5 ) ;    ( 0 + 8,0 ) node @xmath72 ;    ( 0 + 9,0 )  ( 7 + 9,0 ) ;    ( 1 + 9,0 ) node @xmath41 ; ( 3 + 9,0 ) node @xmath41 ; ( 5 + 9,0 ) node @xmath41 ;    ( 2 + 9,0 ) node @xmath42 ; ( 4 + 9,0 ) node @xmath42 ; ( 6 + 9,0 ) node @xmath42 ;    ( 3 + 9,0 ) arc ( 0:180 : .5 ) ; ( 5 + 9,0 ) arc ( 0:180 : .5 ) ;    ( 8,-2 ) node @xmath73 ;    ( 0 + 4.5,-4 )  ( 7 + 4.5,-4 ) ;    ( 1 + 4.5,-4 ) node @xmath41 ; ( 3 + 4.5,-4 ) node @xmath41 ; ( 5 + 4.5,-4 ) node @xmath41 ;    ( 2 + 4.5,-4 ) node @xmath42 ; ( 4 + 4.5,-4 ) node @xmath42 ; ( 6 + 4.5,-4 ) node @xmath42 ;    ( 4 + 4.5,-4 ) arc ( 0:180 : .5 ) ;     + before giving the proof , we state a basic result .    [ lemm : basic ] we keep the previous notations .",
    "define @xmath74 for @xmath53 , such that @xmath50 and @xmath51 , and @xmath75 for @xmath53 , such that @xmath54 and @xmath55 . both functions @xmath76 and @xmath77 are decreasing with respect to each of their two variables .",
    "this lemma is a direct consequence of the concavity of the function @xmath78 .",
    "we are now in the position to give the sketch of the proof of theorem [ thlmi ] .",
    "+ * proof of theorem  [ thlmi ] : * we consider the case where @xmath79 .",
    "the case @xmath80 can be treated the same way .",
    "+ the proof consists in proving that assumptions ( [ hyp1][hyp3 ] ) imply that neither demand nor supply points located between @xmath81 and @xmath82 can be matched with points located outside this interval , i.e. that the set @xmath83 is stable by an optimal transport plan . in this case , the result follows from assumption ( [ hyp1][hyp2 ] ) .",
    "+ suppose that @xmath84 is not preserved by an optimal transport plan @xmath20 .",
    "three cases can occur :    a.   [ c1 ] there exists @xmath85 , such that @xmath86 and @xmath87 and there exists @xmath88 , such that @xmath89 and @xmath90 .",
    "b.   [ c2 ] there exists @xmath91 , with @xmath92 such that @xmath93 .",
    "c.   [ c3 ] there exists @xmath94 , with @xmath95 such that @xmath96 .",
    "we first prove that case [ c1 ] ) can not occur .",
    "+ in case [ c1 ] ) , one can assume without loss of generality that @xmath97 is the largest index such that @xmath86 , @xmath98 and that @xmath99 is the smallest index such that @xmath89 , @xmath90 .",
    "with such assumptions , the ( possibly empty ) subset @xmath100 is stable by @xmath20 . because of assumptions ( [ hyp1][hyp2 ] )",
    ", no nesting can occur in this subset , and @xmath71 for @xmath101 .",
    "+ on the other hand , since @xmath20 is supposed to be optimal , one has : @xmath102 thanks to lemma [ lemm : basic ] , one deduces from this last inequality that : @xmath103 and then : @xmath104 according to assumption ( [ hyp1 ] ) , @xmath105 and @xmath106 , so that :    @xmath107 @xmath108 combining these last inequalities with ( [ ineq:1 ] ) one finds that : @xmath109 which contradicts assumption ( [ hyp3 ] ) .",
    "+ let us now prove that cases [ c2 ] ) and [ c3 ] ) contradict the assumptions .",
    "cases [ c2 ] ) and [ c3 ] ) can be treated in the same way .",
    "consider case [ c2 ] ) . without loss of generality",
    ", one can assume that @xmath110 is the smallest index such that @xmath111 and @xmath112 . because there are necessarily as much demands as supplies between @xmath113 and @xmath114 , there exists one and only one index @xmath115 such that @xmath116 and @xmath117 .",
    "consequently , the ( possibly empty ) subsets @xmath118 and @xmath119 are stable by an optimal transport plan .",
    "because of assumptions ( [ hyp1][hyp2 ] ) , no nesting can occur in these subsets , and @xmath69 for @xmath120 and @xmath71 for @xmath121 .",
    "+ on the other hand , since @xmath20 is supposed to be optimal , one has @xmath122 thanks to lemma  [ lemm : basic ] , one deduces from this last inequality that : @xmath123 because the cost is supposed to be increasing with respect to the distance , one finds that @xmath124 , so that ( [ ineq3 ] ) implies : @xmath125 and then : @xmath126 according to assumption ( [ hyp1 ] ) @xmath127 , so that :    @xmath128 combining these last inequalities with ( [ ineq4 ] ) one finds that : @xmath109 which contradicts assumption ( [ hyp3 ] ) .",
    "+ we have then shown that neither demand nor supply points located between @xmath81 and @xmath129 can be matched with located outside this interval .",
    "the set @xmath84 is then stable by an optimal transport plan .",
    "according to assumption ( [ hyp1][hyp2 ] ) , no nesting can occur in @xmath84 .",
    "the result follows .",
    "the recursive use of our indicators is on the basis of the next algorithm . + * algorithm : * set @xmath131 , @xmath132 , @xmath133 , and @xmath134 .",
    "+ while @xmath135 and @xmath136 do    1 .",
    "compute @xmath137 and @xmath138 for @xmath139 and @xmath140.[costlystep ] 2 .",
    "define @xmath141 @xmath142 and do [ noncostlystep ] 1 .   if @xmath143 and @xmath144 , set @xmath145 .",
    "do [ removingstep ] * for all @xmath146 in @xmath147 and for @xmath148 , do * * define @xmath149 , * * remove @xmath150 from @xmath151 , * * remove @xmath152 and @xmath153 from @xmath154 and @xmath155 respectively .",
    "* for all @xmath156 in @xmath157 and for @xmath158 , do * * define @xmath159 , * * remove @xmath160 from @xmath151 , * * remove @xmath152 and @xmath153 from @xmath154 and @xmath155 respectively . *",
    "set @xmath161 , and rename the points in @xmath151 such that @xmath131 , @xmath162 * set @xmath134 .",
    "if @xmath163 , for @xmath164 set @xmath159 .",
    "+ to test the efficiency of our algorithm , we have applied it to an increasing number @xmath0 of pairs of points . for a fixed value of @xmath0 , 100 samples of points have been chosen randomly in @xmath165 $ ] , and the mean of the number of evaluations of @xmath78 has been computed .",
    "the results are shown on  fig .",
    "+ the best case consists in finding a negative indicator at each step , and the worst corresponds to the case where all the indicators are positive . these two cases require respectively @xmath166 and @xmath167 evaluations of @xmath78",
    ". +    [ c][t]in - line evaluations of @xmath78 [ c][b]number of pairs of points @xmath0 [ l][c ] : @xmath168 , @xmath169 [ l][c ] : @xmath170 , @xmath171 [ l][c ] : @xmath172 , @xmath173 [ l][c ] : worst case @xmath167 , @xmath173 [ l][c]@xmath174 [ c][c]@xmath175 [ c][c]@xmath176 [ c][c]@xmath177 [ c][c]@xmath178 [ c][c]@xmath179 [ c][c]@xmath180 [ c][c]@xmath181 [ c][c]@xmath182 [ c][c]@xmath183   is the slope of the log - log graphs.,title=\"fig : \" ]    00 a.  aggarwal , a.  bar - noy , s.  khuller , d.  kravets , and b.  schieber .",
    "efficient minimum cost matching using quadrangle inequality . in _",
    "foundations of computer science , 1992 .",
    "proceedings of 33rd annual symposium _ , pages 583592 , 1992 ."
  ],
  "abstract_text": [
    "<S> in this note , we introduce a class of indicators that enable to compute efficiently optimal transport plans associated to arbitrary distributions of @xmath0 demands and @xmath0 supplies in @xmath1 in the case where the cost function is concave . </S>",
    "<S> the computational cost of these indicators is small and independent of @xmath0 . </S>",
    "<S> a hierarchical use of them enables to obtain an efficient algorithm . </S>"
  ]
}