{
  "article_text": [
    "coded aperture systems nowadays find their major application in high energy astronomy , and in particular in the hard x - ray ( 3 - 30 kev ) and soft @xmath0-ray ( 30 kev - 20 mev ) domains where conventional focusing techniques are difficult to implement and where the high and variable background limits the performance of standard on / off monitoring techniques ( see review by caroli et al .",
    "+ in coded aperture telescopes source radiation is spatially modulated by a mask of opaque and transparent elements before being recorded by a position sensitive detector , allowing simultaneous measurement of source and background fluxes .",
    "reconstruction of the sky image is generally based on a correlation procedure between the recorded image and a decoding array derived from the mask pattern .",
    "essential requirements for such systems is that the mask pattern must allow each source in the field of view ( fov ) to cast a unique shadowgram on the detector and that projected shadowgrams must be , as much as possible , different to better differentiate the sources . assuming a perfect detector ( infinite spatial resolution ) , the angular resolution of such a system",
    "is then defined by the angle subtended by one hole at the detector .",
    "the sensitive area depends on the number of all transparent elements of the mask viewed by the detector .",
    "so , reducing hole size or increasing mask - detector distance while increasing accordingly the number of holes improves the angular resolution without loss of sensitivity .",
    "a large field of view can also be obtained since the source radiation is modulated for sources which are within an angle from the axis given by the arctg of the mask plus detector dimensions divided by the mask - detector distance . to optimize the sensitive area of the detector ,",
    "masks of dimensions greater of or equal to the detector dimensions are employed .",
    "two kind of fov are defined .",
    "the fully coded ( fc ) fov for which all source radiation directed towards the detector plane is modulated by the mask and the partially coded ( pc ) fov for which only a fraction of this source radiation is modulated , while the rest , if detected , can not be distinguished from the background .",
    "if holes are uniformly distributed the sensitivity is constant in the fcfov and decreasing in the pcfov .",
    "the system point spread function ( spsf ) of coded aperture telescopes , i.e. the final imaging response to a point source after reconstruction , depends critically on the mask pattern . representing the mask with an array m of 1 ( open elements ) and 0 ( opaque ones )",
    ", the detector array d will be given by the convolution of the sky image s by m plus an unmodulated background array term b , @xmath1 suppose to find a special array m for which exists a _",
    "correlation inverse _",
    "g such that @xmath2-function , then we can reconstruct the sky by @xmath3 @xmath4 and @xmath5 differs from @xmath6 only by the @xmath7 term , which for a flat array @xmath8 is a constant level which can be measured and removed . such special mask patterns , including those called",
    "_ uniformly redundant arrays _ ( ura ) , were found in the 70s , and they allow the reconstructed image to be free of secondary lobes ( fenimore & cannon 1978 ) . most of these patterns are built using binary sets called _ cyclic different sets _ which have the remarkable property that their cyclic autocorrelation gives a delta function .",
    "the decoding array @xmath9 ( i.e. , g=@xmath10 for m=1 and g=@xmath111 for m=0 ) is then a _ correlation inverse_. + to have a sidelobe - free response a source must be able to cast on the detector a whole basic pattern ( fully coded source ) . to make use of all the detector area and to allow more than one source to be fully coded ,",
    "the mask basic pattern is normally taken of the same size and shape of the detector and the total mask made by a cyclic repetition ( @xmath12 2  @xmath13  2 for rectangular mask ) of the basic pattern . for such _ optimum systems _ a fcfov source will always project a cyclically shifted version of the basic pattern and correlating the detector image with the g decoding array will provide sidelobe - free peak with position - invariant shape at the source position .",
    "+ a source in the pcfov will instead cast an incomplete pattern and its contribution can not be a - priori subtracted and will produce secondary lobes ( coding noise ) . on the other hand",
    "the modulated radiation from pc sources can be reconstructed by extending with a proper normalization the correlation procedure to the pcfov ( @xmath14 ) .",
    "the complete field of view of the telescope ( fov ) is therefore composed by the central fcfov of constant sensitivity and optimum image properties ( position - invariant and flat sidelobes spsf ) surrounded by the pcfov of decreasing sensitivity and non perfect spsf . a source outside the fov simply contributes to the background level .",
    "+ these masks also minimize the statistical errors of the reconstructed peaks . since @xmath15 the variance associated with each reconstructed sky image pixel is constant in the fcfov and equal to total counts recorded by the detector , therefore the source signal to noise is simply @xmath16 where @xmath17 and @xmath18 are source and background counts .",
    "these masks also have nearly equal number of transparent and opaque elements and therefore offer minimum statistical error in condition of high background ( typical of the @xmath0-ray domain ) .",
    "however the sensitivity also depends on the detector spatial resolution and an _ imaging efficiency _",
    "factor must be applied to this maximum s / n to account for this effect .",
    "to perform discrete operations the counts are binned in detector pixels and , to avoid loss due to coarse sampling , pixels are of much smaller size than the mask elements .",
    "the correlation can take the form of _ fine cross - correlation _ , for which the array @xmath19 is itself divided in finer elements with the same sampling and then correlated @xcite .",
    "the spsf is then given by a pyramidal function whose width ( fwhm ) is 1 mask element .",
    "however the spatial resolution of real detector is not infinite and this induces an intrinsic loss in peak reconstruction and makes fine sampling ( sampling - pixels small ) useless . in this case , and in particular when detector resolution is not negligible with respect to the mask element size , it can be shown that the best point - source signal to noise is obtained by convolving the detector image with the @xmath19 array convolved by the detector point spread function . for a pixellated detector",
    "the blurring function is just a block function of width 1 pixel .",
    "convolving @xmath19 with this function and performing the correlation we obtain a final spsf which is the convolution of 2 pyramidal functions one of width 1 mask element and the other of width 1 pixel .",
    "+ due to finite pixel size , the peak of the spsf will be reconstructed in the best case with an average efficiency given by the relation @xmath20 @xcite , where r is the ratio of the mask element size to pixel size .",
    "this gives the average loss in sensitivity when the flux is estimated by _",
    "fitting _ the image with the spsf function at fixed source position . on the other hands",
    "when performing the spsf deconvolution with given sampling the reconstructed peak height will be even lower , due to the fact that the source will not be at the center of the sampled pixel .",
    "in average this ( _ imaging _ ) efficiency will be given by @xmath21 .",
    "in the case of continuous detectors , like the sigma telescope , the detector blurring can be described by a bi - dimensional gaussian , and the spsf by an analytical function ( e.g. appendix a in bouchet et al .",
    "2001 ) , which depends on the detector spatial resolution ( width of the gaussian ) .",
    "to precisely evaluate source parameters and their errors we compare reconstructed image sectors with the system psf by means of the chi - square fitting technique .",
    "discrete cross - correlation to compute sky and variance images can be written @xmath22 where poisson statistics was assumed .",
    "this standard deconvolution in fcfov can be extended in the pcfov by extending the correlation of the decoding array @xmath19 with the detector array d in a non - cyclic form , padding g with 0 elements . since only the detector section modulated by the pc source",
    "is used to reconstruct the signal , the statistical error at the source position and significance of the ghost peaks are minimized .",
    "however to ensure a flat image in the absence of sources , detector pixels which for a given sky position correspond to mask opaque elements must be balanced , before subtraction , with the factor @xmath23 where @xmath24 is the number of pixels corresponding to transparent elements and @xmath25 to opaque ones for that given sky position .",
    "this can be written @xmath26 where the decoding arrays are obtained from the mask m by @xmath27 and @xmath28 , then padded with 0 s outside mask region , and where the sum is performed over all detector elements . in the fcfov we obtain the same result of the standard cross - correlation . to consider effects such as satellite drift corrections ( see goldwurm 1995 ) , dead areas or other specific conditions , a weighting array @xmath29",
    "is used to weigh properly the detector array before correlating it with the @xmath19 arrays .",
    "the balance array is @xmath30 the variance , which is not constant outside the fcfov , is computed accordingly @xmath31 @xmath32 since the cross - terms @xmath33 vanish .",
    "note however that when the weights @xmath34 refer to the same pixel in d , the terms @xmath35 must be summed before squaring ( see goldwurm 1995 ) .",
    "the varying effective area can be calculated by similar formula and used to renormalize , after background subtraction to fcfov count rates .",
    "all this can be performed for sampling finer than 1 pixel per mask element and using a g array convolved with detector psf in order to optimize s / n for point sources , with corresponding normalizations .",
    "this procedure can be carried out with a fast algorithm by reducing previous formulae to a set of correlations computed by fft . +",
    "the on - axis spsf on the whole fov for an optimum system ( ibis / isgri configuration with mura mask and r = 2.43 , @xmath36 5 ) and psf deconvolution is shown in fig .",
    "[ fig : muraexfovpsf ] .",
    "note the peak and flat level in the central fcfov , the secondary lobes ( coding noise ) in the pcfov and the 8 main ghosts of the source peak in the pcfov located at distances , from the source , which are multiple of the basic pattern .",
    "the ibis coded mask imaging system is composed by a replicated modified ura ( mura ) mask of tungsten elements ( fig .  [",
    "fig : mura ] ) and 2 pixellated detector planes of the same size , isgri for the low energy band ( 20 - 1000 kev ) and picsit for the higher band ( 150 kev - 10 mev ) disposed about 10 cm below @xcite .",
    "the mura @xcite are nearly - optimum masks and previous discussion for such system is valid for the ibis telescope .",
    "the detector planes can be divided in a regular grid of square pixels where each detector element occupies a pixel of the array .",
    "essential imaging characteristics and performances are reported in table  [ tab : table1 ] , including value of efficiency for fitting procedure and imaging .",
    "the average point source location error ( psle ) for an optimum coded aperture system with a defined system point spread function depends on source signal to noise ratio ( s / n ) as following @xmath37 this can be demonstrated by computing , through the covariance matrix , the errors on the parameters ( source position and intensity and background level ) derived by the chi - square fitting of a deconvolved image sector with the spsf .",
    "we calculated this error , averaged over a large number of uniformly distributed source positions , for an optimum coded aperture system where mask elements are an integer number of detector pixels for different values of mask / pixel sizes and s / ns . in fig .",
    "[ fig : psla ] are reported these theoretical location errors for mask to pixel ratios r = 2 and 3 , which are respectively upper and lower limits for the ibis / isgri configuration which has an intermediate ratio of @xmath38 = ( 11.2/4.6 ) = 2.43 .",
    "ll mura basic ; total mask & 53 @xmath13  53  ;   95 @xmath13  95 + mask element size & 11.2 @xmath13 11.2 @xmath13 16  @xmath39 + isgri - mask distance & 3200 @xmath40  @xmath41 + isgri active pixels & 128 @xmath13  128 + isgri pix size & 4 .",
    "@xmath13  4 .",
    "@xmath13  2 .",
    "@xmath39 + isgri pixel pitch & 4.6 @xmath13  4.6  @xmath42 + isgri pixels & 130 @xmath13  134 + picsit - mask distance & 3300 @xmath40  @xmath41 + picsit active pixels & 64 @xmath13  64 + picsit pix size & 8.66 @xmath13  8.66 @xmath13 30  @xmath39 + picsit pixel pitch & 9.2 @xmath13  9.2  @xmath42 + picsit total pixels & 65 @xmath13  67 +   + isgri effic .",
    "( _ fit - imag _ ) & 0.86 - 0.81 + isgri ang.res.(fwhm ) & 12.0@xmath43 + isgri pixel angle & 5.0@xmath43 + picsit effic .",
    "( _ fit - imag _ ) & 0.73 - 0.63 + picsit an.res.(fwhm ) & 11.7@xmath43 + picsit pixel angle & 9.6@xmath43 + exfov ( 0 @xmath44 sens . ) & 30.6@xmath45 @xmath13 31.0@xmath45 + fcfov ( 100 @xmath44 sens . ) & 8.3@xmath45 @xmath13 8.6@xmath45 +    [ tab : table1 ]    in the same plot are reported location errors obtained from analysis of simulated observations with ibis / isgri system of an on - axis point source .",
    "200 isgri images for a point - like nearly - on - axis source of given s / n ( the s / n is here reduced by _ imaging efficiency _ as defined in @xmath46 ) are simulated , deconvolved and analyzed to search for the most significant peak which is then fitted to the analytical spsf to derive source position . background ( uniform distribution ) was kept fixed to a value of 1000 cts and s /",
    "n was made varying by reducing input source counts from @xmath47 2000 to @xmath47 500 .",
    "the standard deviation of the observed offsets between the best fit positions and the input positions represent then the 1  @xmath48 error in 1 parameter of the estimated position .",
    "these results show that the estimated location error , as expected , varies with s / n and r as predicted and can therefore be for bright sources a small fraction of the angular resolution , even for small values of the ratio mask element size to pixel size .",
    "the ibis / isgri telescope , assuming no error in pointing axis reconstruction or other systematic effects , can locate a 30 @xmath48 point - like source at better than @xmath49 30@xmath50 .",
    "absolute error in attitude reconstruction for integral is expected to be @xmath12 20@xmath50 .",
    "in a standard analysis , ibis events or histograms are binned in detector images , which are then corrected for detector and background non - uniformity @xcite and then processed by an iterative algorithm which decodes , cleans and composes sky images . for each detector image a sky image and its variance are obtained using the deconvolution procedure of @xmath14 , and then iteratively searched for sources and cleaned of the source side lobes . in this iterative process",
    "the source peaks are fitted with the proper system psf and finely located .",
    "then the source contribution to the image is modeled in detail and subtracted .",
    "the images are rotated , projected and summed after beeing weighted with the variance , and then searched for further contributions .",
    "note that the search for significant excesses must be performed taking into account that these are _ correlation images _ and the critical level at which an unknown excess is significant increases typically from 3  @xmath48 to 5  -  6  @xmath48 @xcite .",
    "this procedure was used in simulations to assess capability of ibis / isgri telescope for a number of specific scientific cases ( see e.g. goldwurm et al . 1999 , 2000 , and goldoni et al .",
    "2000 these proceedings ) , and it is now being implemented in software modules to be integrated into the isdc scientific analysis pipelines .",
    "bouchet l. , et al .",
    "2001 , _ ap.j .",
    "_ , in press .",
    "caroli e. , et al . , 1987 , _ space sci .",
    "_ , 45 , 349 .",
    "fenimore e.e . &",
    "cannon t.m . , 1978 , _ appl",
    "_ , 17(3 ) , 337 .",
    "fenimore e.e . &",
    "cannon t.m .",
    ", 1981 , _ appl .",
    "_ , 20(10 ) , 1858 .",
    "goldwurm a. , 1995 , _ exper .",
    "_ , 6 , 9 .",
    "goldwurm a. , et al . , 1999 , _",
    "astro.lett._&c . , 38 , 333",
    "goldwurm a. , et al . ,",
    "2000 , _ aip _ , 510 , 703 .",
    "gottesman s.r . &",
    "fenimore e.e . , 1989 , _",
    "_ , 28 , 4344 .",
    "skinner g.k . , 1995 , _",
    "_ , 6 , 2 .",
    "ubertini p. , et al .",
    ", 1996 , _ spie _ , 2806 , 246 ."
  ],
  "abstract_text": [
    "<S> the ibis telescope onboard integral , the esa gamma - ray space mission to be launched in 2002 , is a soft gamma - ray ( 20 kev - 10 mev ) device based on a coded aperture imaging system . </S>",
    "<S> we describe here basic concepts of coded masks , the imaging system of the ibis telescope , and the standard data analysis procedures to reconstruct sky images . </S>",
    "<S> this analysis includes , for both the low - energy detector layer ( isgri ) and the high energy layer ( picsit ) , iterative procedures which decode recorded shadowgrams , search for and locate sources , clean for secondary lobes , and then rotate and compose sky images . </S>",
    "<S> these procedures will be implemented in the quick look and standard analysis of the integral science data center ( isdc ) as ibis instrument specific software .    </S>",
    "<S> [ 1999/12/02 1.01 ( pwd ) ] </S>"
  ]
}