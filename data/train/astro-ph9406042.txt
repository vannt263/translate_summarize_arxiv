{
  "article_text": [
    "the possibility of interference effects in gravitational lensing has been considered by several authors ( @xcite ; @xcite ; @xcite ; @xcite ; @xcite ; @xcite ) . of particular interest",
    "are diffractive variations in flux with frequency @xmath2 when the source , lens , and observer occupy fixed positions .",
    "if the difference in time delay between a pair of images satisfies @xmath3 , the fringe spacing is @xmath4 .",
    "we may call @xmath5 the `` semi - classical '' regime , because diffractive phenomena are produced by mutually coherent images whose positions , magnifications , and time delays can be determined using geometric optics . on the other hand , if @xmath6 , regions of the lens plane other than the geometric - optics images contribute importantly to the flux .",
    "the semi - classical approach then breaks down , and one must use the methods of physical optics .    if observed , interference effects would reveal dark - matter objects in a mass range to which few other tests are sensitive . the characteristic time delay produced by a lens of mass @xmath7 is @xmath8 where @xmath9 is the schwarzschild radius .",
    "hence the condition @xmath10 is equivalent to @xmath11 . since the schwarzschild radius of the sun is @xmath12 , broad - band fringes ( @xmath13 ) require decidedly sub - stellar but nevertheless macroscopic lensing objects . in particular , gould ( 1992 ) has shown that lens masses @xmath14 could produce observable fringes in gamma - ray burst spectra at energies @xmath15 ( @xmath16 ) .",
    "because the angular separation of the images produced by such a lens is @xmath17 arc sec , gould has coined the name `` femtolensing '' for this phenomenon . on the other hand ,",
    "the probability that a randomly placed and cosmologically distant point - like source should be lensed is @xmath18 , where the latter is the mean mass density in lensing objects expressed as a fraction of the critical density @xmath19 ( @xcite ) .",
    "given that @xmath20 gamma - ray bursts have been detected to date ( cgro science report 157 1994 ) , a single well - established case of femtolensing would indicate that objects @xmath21 contribute significantly to the mass density of the universe .",
    "even if copious lenses exist in the appropriate mass range , visible fringes can be seen only if the ( incoherent ) source is smaller than the fresnel length @xmath22 , where @xmath23 is the distance .",
    "for source redshifts of order unity , this translates to @xmath24 .",
    "an additional constraint requires that in order to have significant magnification , the source size must be smaller than the einstein ring radius . for cosmological distances , @xmath25  cm .",
    "the rapid time variability of gamma - ray bursts ( grb ) of 0.2 msec ( @xcite ) as well as the cosmological distances of @xmath26  gpc for bright batse bursts found from log  @xmath27-log  @xmath28 studies ( @xcite ) suggest , however , that _ grb are sufficiently compact_. there has been some confusion as to whether the appropriate linear source size should be taken from @xmath29 or @xmath30 where @xmath31 is the bulk lorentz factor , @xmath32 is the speed of light , @xmath33 is the smallest time variation detected , and @xmath34 is the total event duration . for many proposed cosmological scenarios ,",
    "the appropriate measure is @xmath29 , because the last - scattering - surface remains at approximately the same radius even though the relativistic ejecta may reach quite large distances in the course of the burst . for @xmath31 s of 100300 ( e.g. @xcite ) ,",
    "the ( linear ) size of a grb last - scattering - surface is of order @xmath35  cm .",
    "other models predict emission from patches on a relativistically expanding shell which can become extremely large ( @xmath30 ) . in the latter case",
    ", it would be difficult to observe femtolensing because the interference patterns would differ from patch to patch .",
    "an observation of femtolensing could distinguish between the two scenarios .",
    "stanek , paczynski , & goodman ( 1993 , henceforth spg ) have discussed the possibility that line features in burst spectra may have been produced by femtolensing .",
    "such lines have been seen or inferred in ginga data ( @xcite , @xcite ) and konus data ( @xcite ) and have been attributed to cyclotron absorption . like cyclotron lines",
    ", interference fringes would be evenly spaced in photon energy .",
    "no convincing evidence for lines has yet been seen in the largest homogeneous data set available , the batse experiment on the compton gamma - ray observatory , although its capability of line detection is lower ( @xcite ) .",
    "the femtolensing calculations cited above have considered only the simplest possible case , which is an isolated point - mass lens .",
    "the simplicity and symmetry of such a lens allow the physical optics problem to be solved in terms of known functions ( @xcite ) .",
    "in the present paper , we present an efficient physical - optics method for computing frequency - space fringes produced by general lenses .",
    "we assume that the lensing mass distribution is confined to a layer thin compared to the observer - source distance ( single - screen approximation ) .",
    "we also neglect time dependence of the lensing geometry , which is permissible if the time - delay difference between any pair of images changes by less than @xmath36 during an observation .",
    "the latter assumption is probably justified for femtolensing of gamma - ray bursts ( @xcite ) .    for definiteness , and because it is the simplest lens not yet treated in physical optics , we apply our methods to a single point mass with external shear .",
    "the computational approach taken , however , would apply equally well to an arbitrary surface density of lensing mass .",
    "computational savings are achieved mainly by taking advantage of the achromaticity of gravitational lensing : that is , the time delays and excess optical path lengths are independent of frequency .",
    "the plan of our paper is as follows .",
    "the physical - optics problem is posed in  ii .",
    "we show how the scalar diffraction amplitude at the observer can be determined as a function of frequency by first calculating its fourier transform , which is a function of time delay .",
    "an efficient numerical procedure for finding the latter function is developed in terms of contour integrals on the lens plane .",
    "the role of the geometric - optics images and the correspondence with the semi - classical approximation is explained . in ",
    "iii we describe certain details of our numerical implementation of the method and show that in the case of an isolated - point - mass lens , our results are consistent with those already obtained by @xcite and spg for the isolated - point - mass lens . in ",
    "iv we present results for the more complex case of a point mass with external shear , which can produce up to four images . finally , ",
    "v briefly summarizes the main points of our approach and prospects for observing femtolensing .",
    "the quantity of interest for femtolensing is the observed magnification as a function of frequency of the lensed source relative to the intensity in absence of a lens . in scalar diffraction theory , for the case of a thin screen , this function can be written as complex square of the amplitude @xmath37 where @xmath38 is the photon frequency , @xmath39 is a normalization to unit flux in absence of a lens that varies slowly with @xmath38 , @xmath40 and @xmath41 are coordinates in the lens plane , and @xmath42 is the time delay function ( e.g. , @xcite ) : @xmath43.\\ ] ] in the latter formula , @xmath44 is the redshift of the lens ; @xmath45 , @xmath46 , and @xmath47 are angular diameter distances ; @xmath48 is the point where a direct line from observer to source would meet the lens plane in the absence of the lens ; and @xmath49 is the mass per unit area in the lens plane .    although our methods are general , we illustrate them by application to a point mass with sub - critical shear . if the observer and lens are on the z - axis and the source is slightly off axis , the time delay function for this case is , in normalized units ( see appendix a ) , @xmath50 - \\ln(x^2+y^2),\\ ] ] where @xmath51 is the shear , @xmath52 is the angle between shear direction and that of the displacement of the source from the axis , and @xmath53 is the angle between the source and z - axis as measured by the observer in units of the angle subtended by the einstein ring .    direct calculation of @xmath54 is a three dimensional problem in @xmath55 and @xmath38 .",
    "we demonstrate here a method to reduce the problem to two dimensions with use of fourier transforms and contour integration .",
    "dividing eq .",
    "[ psi ] by @xmath39 and taking the fourier transform , we define @xmath56 which can be viewed as a virtual pulse shape in time .",
    "after substitution from equation [ psi ] , this equation reduces to @xmath57.\\ ] ] therefore , the contribution to @xmath58 comes from curves of constant time delay ; an example of such contours is shown in figure [ conmap ] .",
    ". [ tpsi2 ] can be evaluated as a contour integral .",
    "since @xmath59 is the area between the curves defined by @xmath60 and @xmath61 , and the distance between them is @xmath62 , @xmath63 where @xmath64 is the arc length along the curve defined below .",
    "there will in general be more than one of these contours , though it is straightforward to find them all as is described in the next section .",
    "the sum of the integrals ( [ line1 ] ) over all contours @xmath65 can be expressed as @xmath66 if the arc parameter @xmath67 is defined through the differential equations @xmath68 because @xmath69 notice that equations ( [ u ] ) are nonsingular near critical points if @xmath70 is smooth .",
    "we find @xmath58 is a smooth function except where @xmath34 is equal to a critical value of the time delay function so that @xmath71 ( an example of @xmath58 is shown in figure [ psimap ] ) .",
    "it is at these critical valued time delays that images form .",
    "these singularities are calculated in appendix b. for minima or maxima , there is a discontinuity in @xmath58 at the critical time , @xmath72 , of @xmath73^{-{1\\over 2}}.\\ ] ] in the case of a saddle point , @xmath58 diverges logarithmically near @xmath72 , so that @xmath74^{-{1\\over 2 } } + \\mbox{non - singular part}\\ ] ] using a procedure described in the next section , the singularities can be dealt with and the inverse fourier transform can be calculated , yielding the amplitude @xmath75",
    "except in the simplest circumstances , the method of  2 must be applied numerically . for a point mass with shear ,",
    "our algorithm computes the femtolensed energy spectra in ten to twenty seconds on a sparc 10 .",
    "computer code which implements the algorithm is available upon request . for future applications",
    ", we note that the algorithm grows quadratically with the number of lensing masses .",
    "the computation may be considered in three parts : location of the images , line integration on constant time delay contours , and calculation of the inverse fourier transform of @xmath58 to yield @xmath54 .    in the case of a point mass lens with shear ,",
    "the location of the images can be found analytically , so there is essentially no computational burden .",
    "however , one could envision more complex applications such as lensing in a dense field with many lenses and images where it would be necessary to utilize some image finding scheme .",
    "an efficient image finding algorithm has already been developed for microlensing calculations ( @xcite ) .",
    "note that the femtolensing algorithm increases approximately linearly with the number of images , so these complicated scenarios may be tractable .",
    "we find that the line integration around contours defined in eqs .",
    "[ line1][u2 ] is the most computationally demanding part of the program .",
    "the method by which the contours are found warrants a brief discussion .",
    "an example of these contours are shown , for example , in figure [ conmap ] .",
    "the algorithm starts with a contour very close to the minimum time delay critical point .",
    "from there , it moves to larger time delay contours by taking small steps perpendicular to the contour .",
    "this method works as long as the number or topology of the contours does not change , but this happens only at the images . in other words , the contours are altered only when moving from below the time delay of an image to above it . when the image is a minimum in the time - delay surface , a new contour is formed around the minimum .",
    "when the contour is a saddle point , a contour either splits into two , or two contours merge .",
    "one can distinguish between these cases by monitoring the line integral at contours near each time delay of an image .",
    "maxima are not encountered in the case of a point mass with shear .    using the line integrals we determine @xmath58 for a range of values of @xmath42 , and",
    "the computations for one geometry are shown in figure [ psimap ] .",
    "we find generally that one needs approximately 1000 points taken uniformly between the minimum time delay and the point at which @xmath58 reaches about one percent of its asymptotic value .",
    "it is impossible to reconstruct the entire detail of the @xmath58 curve with such measurements , because for instance , near the time delay of a saddle point image there is a logarithmic divergence as discussed in the previous section and appendix b. we account for this loss of detail near the critical time delays by subtracting the analytic forms of the singularities .",
    ". [ minmax ] , [ saddle ] ) and dealing with them separately : @xmath76 we then perform a discrete fourier transform ( dft ) of @xmath77 , while paying close attention to edge effects . finally , we calculate the exact fourier transforms of the divergences and discontinuities and add them to the dft to obtain @xmath54 .    as a test of this procedure ,",
    "the calculation is carried out in the simplified case of a point mass without shear and is shown in figure [ energy1 ] ( top panel ) .",
    "this calculation agrees with an earlier calculation of the same result which utilized independent methods ( spg ) to the resolution of the figures presented in this paper .",
    "using the new algorithm , we investigated the interference produced by a variety of lensing geometries for a point source and lens with shear ( extended sources could be calculated by repeatedly applying the algorithm for source points chosen , for instance , by gaussian quadrature weighings ) . figures [ energy1 ] and [ energy2 ] show the results of calculations for various source / lens configurations depicted in figure [ caustics ] .",
    "the frequency , @xmath38 , is given in dimensionless units : @xmath78 where @xmath79 is the schwarzschild radius and @xmath80 is the wavelength .",
    "for example , unity corresponds to photon energy of 1 kev and a mass of @xmath81 at @xmath82 . a sinusoidal pattern is produced which has a frequency inversely proportional to the difference in time delay for the two images .",
    "the top panel of figure [ energy1 ] shows the interference pattern for a point mass with no shear for which the semi - classical approximation is an extremely good approximation .    using our algorithm ,",
    "external shear can be introduced into the calculation .",
    "we find that when the source approaches the caustic , the physical optics calculation differs from the semi - classical approximation .",
    "for example , the bottom panel of figure [ energy1 ] shows a two image interference pattern for which the first few interference nodes have largely different amplitudes . at high frequencies ,",
    "the semi - classical approximation approaches the physical optics solution .",
    "the interference patterns become much more complex when the source lies inside the center caustic region . there , four images form , and the interference patterns become chaotic .",
    "figure [ energy2 ] shows the magnification as a function of frequency for two such cases .",
    "the main characteristics to note are that the interference patterns can become quite complex with oscillations with both long and short periods ( the bottom panel shows both the physical optics magnification and a smoothed magnification ) . in short , this means that femtolensing can be observed over a wider range of frequency space , and therefore , a wider range of masses than originally believed .",
    "figure [ energy2 ] shows that the typical interference patterns , corresponding to inverse time delays , can be hundreds of times larger than the characteristic time delay ( see eq .",
    "[ char_time ] ) , so the lens masses can be hundreds of times larger than those discussed by gould and spg .",
    "this short period interference discussed in previous papers can be seen in the top panel of [ energy1 ] .",
    "the long period interference occurs when two of the four images have very close time delays , which is a common result with four images .",
    "appendix c shows that in these circumstances the separation of the long - period fringes increases as the cube of the total magnification , and the source - size limit is somewhat more severe than the fresnel length .",
    "the complex nature of the magnification in fig .",
    "5 can be understood to some extent in the semi - classical regime , because there one finds that the complex amplitude of magnification , @xmath54 , is composed of a set of sinusoidal interference fringes from each pair of images . for four images ,",
    "there are six pairs which each produce sinusoidal interference",
    ". the resulting interference pattern which is the squared sum of these sine waves will in general be very complex .",
    "the physical optics calculation is qualitatively similar , but yields different magnifications and different specific structures at low frequencies . according to the result ( [ fringes ] ) in appendix c ,",
    "the first few long - period fringes are least sensitive to the angular size of the source .",
    "we find that even in the simplified case of a point mass with external shear , very complex interference patterns can be formed . in reality , however , the patterns should be even more complex .",
    "in addition to external shear , one should account for local shear from neighbors for femtolensing matter in galactic halos .",
    "complex , many image geometries will result , and as found in the case of a point mass with external shear , images with smaller - than - characteristic difference in time delay ( see eq . [ char_time ] ) will cause surprisingly long period interference patterns ( e.g. figure [ energy2 ] ) which allow for detection of larger masses .",
    "for an external shear of 0.1 , we expect these complex interference patterns to occur 3% of the time that a source is found inside the einstein radius . in general , for a halo mass distribution similar to a singular isothermal sphere , the shear would have a scale length of 5 kpc , so that between 10 and 50 kpc , the shear would be 0.5 - 0.1 , so these complex patterns would occur much more often .",
    "furthermore , there would be a magnification bias ( see appendix c ) towards these complex events , which could likely increase the observed fraction by an order of magnitude .",
    "cosmological gamma - ray bursts are considered the best candidates to show femto - lensing because of their extremely small angular size . if the line of sight to a gamma - ray burst passed through a galaxy , and if the dark halo mass are composed of @xmath83 ( we increase the range of masses by a factor of 100 as a result of the long period events discussed above ) then one could expect to see , in addition to macro or microlensing , femtolensing effects as well .",
    "the femtolensing could easily mimic other emission or absorption line processes .",
    "we suggest , then , that if a spectral absorption or emission feature is definitively observed in a gamma - ray burst due to femtolensing , that it is likely that the burst would be macrolensed as well .",
    "additionally , macrolensing would produce multiple images ( bursts ) which would likely be femtolensed and therefore increase the number of expected femtolensed events .",
    "although the source size requirements exclude the possibility of ever detecting femtolensing in main sequence stars in nearby galaxies , in the future , it may be possible to detect femtolensing of white dwarfs .",
    "( we are grateful to b. paczyski for pointing this out . ) in order for the fringes to have separation of 0.2 ev ( a typical optical bandwidth ) , the lensing masses would be in the range @xmath84 for short to characteristic time delays , respectively . in the lmc , the maximum magnification possible for such events",
    "as determined by the ratio of the einstein ring to source size would be @xmath85 where the larger masses cause the higher magnification .",
    "for a white - dwarf source in the lmc observed at 1 ev , the requirement that the source be smaller than the fresnel length , @xmath86 is met ( @xmath87 ) .",
    "these events would be quite short ( @xmath88  minute ) , due to relative velocities and a small einstein ring , relative to current microlensing events ( e.g. @xcite ) .",
    "however , it is not yet possible to monitor white dwarves in the lmc , so one would have to adopt an observing strategy for transients  possibly in the ultraviolet  similar to that of supernovae searches .",
    "in contrast to current microlensing studies , detection techniques would be based on anti - correlation of the flux variation in different wavelength bands .",
    "this work was supported in part by the david & lucille packard foundation and nasa grant nag5 - 1901 .",
    "it is a pleasure to acknowledge b.  for suggesting the white dwarf lensing scenario as well as e.e .",
    "fenimore , k.z .",
    "stanek , and h. witt for discussions .",
    "in this appendix , we describe the normalized units used in the formulae above .",
    "we begin with the time - delay formula for a point mass with shear ( e.g. @xcite ) : @xmath89\\over d_{ls } } -r_{\\rm sch } \\ln(\\tilde{x}^2+\\tilde{y}^2 ) \\right],\\ ] ] where @xmath44 is the lens redshift , @xmath90 are points at which the ray intersects the lens plane , @xmath91 give the location of the source in the source plane , @xmath9 is the schwarzschild radius , and @xmath92 where @xmath93 are angular diameter distances .    throughout the derivation , additive constants will be ignored .",
    "the form for @xmath54 is @xmath94 then , we define the following dimensionless variables : @xmath95 @xmath96 @xmath97 @xmath98 with these definitions eq .",
    "[ psiagain ] becomes eq .",
    "[ psi ] , and @xmath39 which normalizes the magnification to a unit flux , can then be shown to be , @xmath99 equation [ tautilde ] can be rewritten after substituting the dimensionless variables as @xmath100 finally , we choose an impact parameter @xmath101 where @xmath102 is the einstein radius : @xmath103 we also pick @xmath52 so that we recover eq . [ timedel ] @xmath104 - \\ln(x^2+y^2).\\ ] ]",
    "herein , we discuss the behavior of @xmath58 near critical points ( images ) , so that the divergent portions of the function can be subtracted to yield a smooth function that can be computationally sampled and transformed . when the frequency is larger than the minimum separation of image time delays , ie .",
    "@xmath105 for all i , j , it is in the semi - classical region and these singularities dominate @xmath54 . in any regime ,",
    "the singular behavior dominates @xmath58 near the time delays of the images .",
    "we consider the two cases of a minimum / maximum and a saddle point :      near a critical point at the origin , a contour is given by @xmath106 where @xmath107 is the time delay at the critical point @xmath108 .",
    "without loss of generality we consider the case of a minimum only .",
    "the contribution of the singularity to @xmath58 is found by the integral ( see eqs .",
    "[ minmax][sumlines ] ) @xmath109 we write : @xmath110 @xmath111 @xmath112 further , from eq .",
    "[ tau_cont ] @xmath113 the singularity is such therefore , that @xmath114 this term can be removed from the slowly varying part of @xmath115 and fourier transformed to yield the semi - classical contribution as @xmath116      in a similar manner as above , the singularity of a saddle point may be calculated . without loss of generality",
    "we consider this orientation of saddle point : @xmath117 by analogy with the last derivation , we have @xmath118 in this case the contours are hyperbolic rather than elliptical and do not close locally . to compute the contribution from the neighborhood of the critical point",
    ", we consider that part of each contour for which @xmath119 , where @xmath120 is fixed as @xmath121 . finding @xmath122 such that @xmath123 , and taking @xmath124 , we have @xmath125 where the constant depends on the choice of @xmath120 .",
    "the contour extends from @xmath126 to @xmath122 on each of 2 branches of the hyperbola , so @xmath127 when fourier transformed , @xmath115 yields the semi - classical contribution , @xmath128",
    "when the flux is dominated by two bright images near a critical line , the time - delay surface can be approximated locally by @xmath129 here @xmath130 is the undeflected source position in the lens plane .",
    "we use the dimensionless units of appendix a , but the local coordinates in equation ( [ tau_fold ] ) are centered on the critical line ( @xmath131 ) rather than the deflecting mass . the parameters @xmath132 and @xmath133 are assumed to be @xmath134 , but their precise values depend on the global geometry of the time - delay surface .    for @xmath135",
    ", geometric optics yields two images at @xmath136 with net flux @xmath137 on the other hand , the amplitude ( [ psi ] ) can be evaluated directly : @xmath138 @xmath139 so that the flux ( [ f_phys ] ) displays fringes with spacing @xmath140 in fact , even the position of first zero in the flux is accurately predicted by the asymptotic form ( [ airy ] ) , which is the semiclassical prediction . both geometric optics and",
    "the semiclassical theory predict a divergent flux as @xmath141 .",
    "but since @xmath142 , the flux at the caustic is finite and scales as @xmath143 .    comparing ( [ f_geo ] ) and ( [ fringes ] ) , we see that _ the fringe spacing scales as the cube of the total magnification_. this accounts for the long - period fringes that we often see in our numerical spectra .",
    "because of magnification bias , observed fringes should typically be much more widely spaced than the naive scaling @xmath144 assumed in earlier work .",
    "a source of finite angular size can be regarded as an ensemble of incoherent points .",
    "if fringes are to be visible , the phase of the airy function in ( [ f_phys ] ) must vary by less than the fringe spacing ( [ fringes ] ) across the source .",
    "therefore the angular size must satisfy @xmath145 where @xmath146 is the angular radius of the einstein ring . for images close to a critical line ,",
    "this limit supersedes the angular - size limit associated with the fresnel length , which scales as @xmath147 . to achieve fringes of a given physical frequency @xmath148 and spacing @xmath149 with lenses whose schwarzschild radius is much larger than the wavelength , the limit on the source size scales as @xmath150"
  ],
  "abstract_text": [
    "<S> femtolensing is a gravitational lensing effect in which the magnification is a function not only of the positions and sizes of the source and lens , but also of the wavelength of light . </S>",
    "<S> femtolensing is the only known effect of @xmath0 dark - matter objects and may possibly be detectable in cosmological gamma - ray burst spectra . </S>",
    "<S> we present a new and efficient algorithm for femtolensing calculations in general potentials . </S>",
    "<S> the physical - optics results presented here differ at low frequencies from the semi - classical approximation , in which the flux is attributed to a finite number of mutually coherent images . at higher frequencies , </S>",
    "<S> our results agree well with the semi - classical predictions . applying our method to a point - mass lens with external shear , </S>",
    "<S> we find complex events that have structure at both large and small spectral resolution . in this way </S>",
    "<S> , we show that femtolensing may be observable for lenses up to @xmath1 solar masses , much larger than previously believed . </S>",
    "<S> additionally , we discuss the possibility of a search for femtolensing of white dwarfs in the lmc at optical wavelengths . </S>"
  ]
}