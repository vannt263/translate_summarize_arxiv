{
  "article_text": [
    "information is usually transmitted through noisy channels .",
    "one therefore has to devise a method to retrieve the original information from the output of a noisy channel .",
    "let us suppose that the original information is represented as a sequence of bits .",
    "the idea of error - correcting codes @xcite is to introduce redundancy into the bit sequence to be fed into the noisy channel , so that this additional information is helpful to retrieve ( decode ) the original bit sequence from the corrupted output of the channel .",
    "an example is the parity - check code in which the parities of appropriate blocks of bits are sent through the channel in addition to the original source sequence .",
    "the receiver checks the consistency between the information bits and parity bits and takes appropriate actions if an inconsistency is found .",
    "the problem of image restoration @xcite is similar to the error - correcting code , in the sense that an image represented by a set of pixels ( corresponding to the bit sequence in error - correcting codes ) is corrupted by noise and the receiver tries to retrieve the original image out of the noisy , corrupted one .",
    "a major difference is that in the image restoration problem , one is usually given only the corrupted image , not other additional redundant information .",
    "one thus relies on some _ a priori _ knowledge about images in general to remove noise .",
    "a simple instance is the assumption of smoothness in real - world images ; for example , one may wish to suppress an isolated white pixel among black ones because such a configuration is likely to have been caused by noise rather than to have existed in the original image of the real world .    a general strategy common in error - correcting codes and image restoration is to use the bayes formula on the _ a posteriori _ probability ( posterior ) of an output sequence , given the input sequence .",
    "one then often accepts the sequence ( image ) which maximizes the posterior as the decoded / restored result .",
    "this method is called the maximum _ a posteriori _ probability ( map ) estimate .",
    "sourlas @xcite pointed out that the problem of error - correcting codes can be written in terms of the theory of spin glasses .",
    "the idea is first to represent the bit sequence as an ising spin configuration and then to form a set of exchange interactions as the products of appropriate sets of spins , which can be considered as a generalization of the mattis model of spin glasses @xcite .",
    "the set of interactions , instead of the spin configuration , is fed into the channel , in which noise causes the signs of interactions to flip with some probability . at the receiving end ,",
    "one forms the ising model hamiltonian from the corrupted exchange interactions , the ground state of which is accepted as the decoded information .",
    "this process is equivalent to the map estimate .",
    "sourlas used this formulation to show that there exists a family of codes which are asymptotically error - free and saturate the bound on the code rate ( the number of information bits divided by the number of transmitted bits ) derived by shannon @xcite .",
    "rujn @xcite subsequently proposed to carry out the decoding procedure not at the ground state but at a finite temperature corresponding to the nishimori temperature found in the theory of spin glasses @xcite .",
    "the finite - temperature decoding is effective because the correct original bit sequence has a higher energy than the ground state if the exchange interactions are corrupted and thus are deviated from the mattis type .",
    "his proposal was supported by one of the authors @xcite who proved that when the decoding temperature is varied , the average error per bit in the decoded sequence becomes smallest at the nishimori temperature .",
    "sourlas @xcite used the bayes formula to rederive the finite - temperature decoding of rujn under more general conditions . a recent development along this line",
    "is the contribution by kabashima and saad @xcite who used a diluted many - spin interacting model of spin glasses to show that this system asymptotically saturates the shannon bound with the code rate kept finite",
    ".    analogy with statistical mechanics has also been a useful guide to develop a variety of techniques in the image restoration problem @xcite .",
    "most of the efforts , however , have been devoted to the development of efficient methods to search for the ground state of appropriate statistical mechanical systems ( the map restoration ) using simulated annealing @xcite , mean - field annealing @xcite or the cluster variation methods @xcite .",
    "an interesting exception is the work of pryce and bruce @xcite who pointed out that under a certain criterion , the map estimate is outperformed by the thresholded posterior mean ( tpm ) estimate @xcite , which is actually equivalent to a finite - temperature decoding method .",
    "it is therefore natural to formulate the problems of error - correcting codes and image restoration within a unified theoretical framework and apply various techniques developed in the theory of disordered systems like spin glasses and the random - field ising model . in this paper , we study the choice of parameters for optimal performance with this approach . for illustration , we introduce the infinite - range model , by which it becomes possible to discuss analytically the parameter dependence of the performance .    in sec .",
    "ii we give the basic formulation of the problem for the binary symmetric and gaussian channels .",
    "the posterior for the output of a noisy channel is interpreted as the boltzmann factor of a statistical - mechanical system , namely the ising spin glass with ferromagnetic bias under random fields .",
    "important quantities in the theory of error - correcting codes and image restoration are represented in terms of thermal averages of the ising model at finite temperatures .",
    "we derive an upper bound on the overlap between the decoded / restored result with the original sequence / image using the statistical - mechanical formulation .",
    "the problem of image restoration is treated in sec .",
    "iii in detail where we derive a line of optimal performance in mean - field systems , find the exact solution for the infinite - range model , and present simulation results for the two - dimensional case .",
    "the infinite - range model is shown to work as a good guide to the description of qualitative behavior of the two - dimensional problem .",
    "explicit examples of images are displayed to clarify what happens under various conditions .",
    "the problem of error - correcting codes is analyzed in sec .",
    "we solve the infinite - range model explicitly using the replica method .",
    "compact expressions of the overlap and other order parameters enable us to discuss various aspects of error - correcting codes quantitatively .",
    "the final section is devoted to discussions .",
    "consider an information source which generates a bit sequence represented by a set of ising spins @xmath0 , where @xmath1 and @xmath2 , with the source probability @xmath3 ( the prior ) .",
    "the sequence @xmath4 is coded as the products of @xmath5 spins @xmath6 for appropriately chosen sets of indices @xmath7 .",
    "the sourlas code @xcite is equivalent to the infinite - range model in which all possible combinations of @xmath5 sites are chosen from @xmath8 sites . in general",
    "we consider several different @xmath5 s in a single code , such as in the case of the viterbi code @xcite which has @xmath9 and 3 .",
    "the problem of image restoration can be regarded as a special case of @xmath10 , in which case @xmath11 corresponds to the state of the @xmath12th pixel in the corrupted ( noisy ) image .",
    "a  bit \" in error - correcting codes should thus be identified with a  pixel \" in image restoration , a  bit sequence \" with an  image \" , and  decoding \" with  restoration \" whenever necessary in the following arguments .    when the signal is transmitted through a noisy channel , the output consists of the sets @xmath13 for various values of @xmath5 , which are the corrupted versions of @xmath14 .",
    "two kinds of noisy channels are considered in this paper : the binary symmetric channel ( bsc ) and the gaussian channel ( gc ) .      in the binary symmetric channel ,",
    "the output @xmath15 is equal to @xmath16 with probabilities @xmath17 and @xmath18 respectively , where @xmath17 is the error rate of the bsc for transmission of @xmath14 .",
    "the error probabilities of flipping the signal @xmath19 to @xmath20 and @xmath20 to @xmath19 are the same",
    ". this output probability can be written in a compact form as @xmath21 where @xmath22 if the code in consideration does not include the set @xmath23 and @xmath24 otherwise .",
    "the second summation in the exponent of eq .",
    "( [ bsc ] ) extends over an appropriate set of the indices @xmath25 , the choice of which determines the type of the code , and @xmath26 is the number of terms appearing in this summation .",
    "note that @xmath27 if @xmath22 .",
    "each index @xmath12 may appear in a number of @xmath5-spin terms in the exponential expression ; the number of times of appearance is called the valency @xmath28 .",
    "the procedure of decoding / restoration proceeds as follows .",
    "according to the bayes formula and eq .",
    "( [ bsc ] ) , the posterior probability that the source sequence is @xmath29 , given the output @xmath30 , is proportional to the boltzmann factor of an ising model multiplied by the prior : @xmath31 note that we use the symbol @xmath32 for the decoded / restored result which is in general different from the original set @xmath33 .    for simplicity",
    ", we restrict ourselves to the case of a single non - vanishing @xmath34 with @xmath35 and @xmath36 . following the convention of separating the interaction terms and local field terms in statistical mechanics",
    ", we write @xmath11 as @xmath37 for @xmath10 terms , and eq .",
    "( [ bayes0 ] ) becomes @xmath38 similarly , we will use @xmath39 , @xmath40 to represent @xmath17 , @xmath41 respectively .",
    "it often happens that the receiver at the end of the noisy channel does not have precise information on @xmath42 , @xmath43 or @xmath44 .",
    "one has to estimate these so - called hyperparameters , which is one of the major topics in this field ( see for example @xcite ) .",
    "if the receiver estimates @xmath45 for @xmath42 and @xmath46 for @xmath43 , and uses a model ( guess ) @xmath47 of the source prior @xmath48 , then the mean of the posterior distribution of @xmath49 is equal to the thermal average @xmath50 where the hamiltonian is given by @xmath51 one then regards @xmath52 as the @xmath12th bit of the decoded / restored information with finite @xmath45 and @xmath46 in the finite - temperature process , or with their ratio kept finite when their magnitudes approach infinity in the map method .    in the context of image restoration ,",
    "one often considers patterns with non - trivial structures .",
    "therefore they are assumed to be generated by a non - uniform source prior @xmath53 .",
    "when we do not have any information on the source prior , we have to represent our _ a priori _ knowledge on general images in the model prior @xmath54 .",
    "a natural choice often used as a generic form of the prior is the boltzmann factor of the ferromagnetic ising model @xmath55 where @xmath56 is the partition function at the inverse temperature @xmath57 , @xmath58 represents interacting sites , and @xmath59 is the valency of each site .",
    "the summation usually extends over neighboring sites on a two - dimensional lattice .",
    "this prior is natural because it suppresses different states of neighboring sites , enhancing a smooth structure . in this paper",
    "we consider priors with general connections .    to proceed further , we have to assume some explicit form of the source prior @xmath53 . to develop a general theory",
    ", we adopt the boltzmann factor of the ising model @xmath60 which has the same form as eq .",
    "( [ pm ] ) but with a different inverse temperature .",
    "thus the original images correspond to snapshots of equilibrium monte carlo simulations of the ferromagnetic ising model .",
    "comparison of eqs .",
    "( [ bayes ] ) , ( [ sigmai ] ) and ( [ hamiltonian ] ) implies that the bayes result ( [ bayes ] ) specifies the inverse temperature @xmath45 to @xmath42 , the field strength @xmath46 to @xmath43 and the model prior @xmath61 to @xmath44 .",
    "nevertheless it is useful to keep @xmath45 , @xmath46 and @xmath61 as adjustable parameters and investigate how precisely we should estimate the hyperparameters and tune the adjustable parameters for optimal decoding / restoration .",
    "our statistical - mechanical formulation is particularly useful to investigate this problem both qualitatively and quantitatively .",
    "the decoding / restoration procedure reduces to the method of rujn in the situation of error - correcting codes ( _ i.e. _ @xmath62 and @xmath63const ) when @xmath64 , in which case the noise temperature @xmath65 is equal to the nishimori temperature , which is known to play an interesting role in the theory of spin glasses @xcite .",
    "pryce and bruce @xcite called the same method the tpm in the image restoration situation , in which one sets @xmath66 in the absence of the interaction term in eq .",
    "( [ hamiltonian ] ) .    the finite - temperature method with appropriate parameters ( @xmath67 )",
    "is known to give the sequence of most probable bits both in error - correcting codes and image restoration @xcite .",
    "the map estimate , on the other hand , chooses the sequence which gives the largest value of the posterior ( [ bayes ] ) , corresponding to the ground state of the ising model .",
    "the result of finite - temperature decoding / restoration gives a lower value of the posterior ( [ bayes ] ) than the map result .",
    "however , there appear very many states with almost the same value of the posterior if we generate finite - temperature states by eq .",
    "( [ bayes ] ) , and thus after weighted by the number of such similar states , finite - temperature states outweigh the map counterpart . in other words , if we take into account the entropy effects , the finite - temperature method becomes the natural choice .",
    "this corresponds to the free - energy minimization rather than the energy minimization as in usual statistical - mechanical systems at finite temperatures .      in the gaussian channel ,",
    "the output @xmath15 is a gaussian random variable with appropriate mean @xmath68 and variance @xmath69 .",
    "hence for a given sequence @xmath4 , the gaussian channel is given as @xmath70 where , again following the statistical mechanics convention , we have used @xmath71 , @xmath72 , @xmath73 , @xmath74 to represent @xmath75 , @xmath76 , @xmath77 , @xmath78 respectively",
    ".    similarity of eqs .",
    "( [ bayes ] ) and ( [ gauss2 ] ) implies that the output probability distribution for bsc and gc can be written in the same form , @xmath79 where @xmath80 and @xmath81 for gc . @xmath82 and @xmath83 are functions independent of @xmath4 . for bsc , @xmath84 for gc , @xmath85",
    "the most important quantity in the present problem is the overlap of the decoded / restored bit @xmath86 and the original bit @xmath87 averaged over the output probability .",
    "we may express this overlap as @xmath88 this expression ( [ average1 ] ) should be further averaged over the possible sequences of source bits represented by the prior @xmath89 .",
    "the final expression of the overlap @xmath90 is then @xmath91 the dependence of @xmath90 on @xmath92 and @xmath61 exists in the thermal average @xmath93 .",
    "the average of any other quantity @xmath94 is calculated similarly :",
    "@xmath95=     \\sum_\\xi \\prod \\int dj \\prod \\int d\\tau       p_s(\\{\\xi\\ } ) p_{\\rm out}(\\ { j\\},\\{\\tau \\}|\\{\\xi \\ } )     \\frac{\\sum_\\sigma",
    "f(\\sigma ) e^{-\\beta h } p_m(\\{\\sigma\\ } ) }          { \\sum_\\sigma e^{-\\beta h } p_m(\\{\\sigma\\ } ) } .",
    "\\label{expectation}\\ ] ] the outer brackets @xmath96 $ ] in eq .",
    "( [ expectation ] ) denote the averages over @xmath97 and @xmath98 with the weight @xmath99 .",
    "the following inequality on the overlap is very useful in discussions on the decoding / restoration performance , and the proof is outlined in appendix a : @xmath100 this inequality means that the overlap becomes largest when @xmath101 , @xmath66 and @xmath102 . in this sense",
    "the performance of the map corresponding to the limit @xmath103 can not exceed that of the finite - temperature decoding / restoration at @xmath42 and @xmath43 .    this inequality was known in error - correcting codes @xcite , and equivalent statements were given also in the image restoration problem @xcite although not in the explicit form given here .",
    "one of the contributions of the present paper is that we have generalized the inequalities to the case where two different types of terms are present , one with @xmath104 and the other with @xmath10 .",
    "similar inequalities can be easily derived for the more general case of several different @xmath5 s in eq .",
    "( [ bsc ] ) .",
    "in conventional image restoration problems , the output of the transmission channel only consists of the set of pixels @xmath105 ( corrupted image in the usual sense ) , but not the set of exchange interactions @xmath106 ( the corrupted version of @xmath107 ) . in this case",
    "the following inequality applies to images with extensive valency .",
    "mean - field results are exact when each pixel interacts extensively with other pixels in the source and model prior distributions ( [ ps ] ) and ( [ pm ] ) .",
    "these include the infinite - range model , in which all pixels interact with each other , its randomly diluted version with infinite valency in the thermodynamic limit ( @xmath108 ) , or finite - dimensional models with long - range interactions .",
    "mean - field approximations also work well for finite but large valencies when the temperature is not too low .",
    "the following inequality derived in appendix b is useful in finding the optimal restoration performance , @xmath109 for arbitrary values of @xmath110 . here",
    "@xmath111 and @xmath112 are the ( self - averaging ) thermal averages of the source pixels @xmath87 and model pixels @xmath49 respectively , for those sites @xmath12 which interact with a given site , say site 1 , which however is removed from the thermal process .",
    "note that the derivation only makes use of the self - averaging nature of the mean - field quantities , and does not rely on any connection topology of the sites ( except for the mean - field requirement ) .",
    "no particular techniques such as the replica method are employed .",
    "hence the inequality applies to mean - field systems in general .    since @xmath111 and @xmath112 are functions of @xmath113 , @xmath57 and @xmath46 , eq .",
    "( [ bound2 ] ) defines the line of optimal performance in the space of @xmath46 and @xmath57 : @xmath114 in particular , when @xmath115 , @xmath66 , @xmath116 and @xmath117 , eq . ( [ line ] ) reduces to the point of optimal performance predicted by eq .",
    "( [ bound1 ] ) . on the other hand ,",
    "if the field @xmath46 is different from @xmath43 , then the source and model temperatures have to be rescaled by the magnetization of the respective systems .",
    "when @xmath118 , we obtain the zero - temperature restoration , i.e. the map estimate .",
    "hence the map estimate is also optimal , provided that the correct ratio of @xmath119 is used ( although this choice can only be determined iteratively ) .",
    "let us now suppose that we are given the corrupted version of the set of pixels @xmath105 and , in addition , the exchange interactions @xmath106 , the latter being the corrupted version of the mattis - type interactions @xmath120 . the additional contribution from the exchange term",
    "enables us to formulate the image restoration and error - correcting code problems on the same footing and at the same time investigate the extent to which the additional information @xmath106 enhances the performance .",
    "the restoration process is carried out at the inverse temperature @xmath45 and the field @xmath46 using eqs .",
    "( [ sigmai ] ) and ( [ hamiltonian ] ) with @xmath9 .",
    "though the inequalities ( [ bound1 ] ) and ( [ bound2 ] ) give a bound on the overlap @xmath90 , they do not reveal the explicit dependence of @xmath90 on the parameters @xmath121 , @xmath57 and @xmath43 , which is necessary for studying the tolerance of the restoration results against uncertainties in the estimation of the hyperparameters .",
    "the infinite - range model serves as a useful test ground for this purpose .",
    "of course the infinite - range model is not useful for restoration of a real two - dimensional image since all pixels are neighbors of each other and hence the spatial structure is ignored .",
    "however , we may reasonably expect from experience in statistical mechanics of many - body systems that the behavior of _ macroscopic _ quantities ( such as the overlap @xmath90 ) of realistic problems are at least qualitatively well predicted by the infinite - range model .",
    "an example of the dependence of @xmath90 on the model prior temperature @xmath127 is shown in fig .",
    "[ fig_ir1 ] for conventional image restoration ( without the exchange term , @xmath128 ) .",
    "the parameters are @xmath129 and @xmath130 .",
    "the usual practice in image restoration is to use a hamiltonian with a fixed ratio of @xmath119 , and then to use @xmath57 as an adjustable parameter for simulated annealing .",
    "hence we consider the behavior as a function of @xmath57 when @xmath119 is kept constant to the optimal value @xmath131 ( the curve marked ` opt @xmath46 ' ) , to 0.9 times the optimal value ( ` opt*0.9 ' ) , or to 1.1 times the optimal value ( ` opt*1.1 ' ) . in the curve marked ` @xmath132 ' , @xmath46 itself is kept constant to 1 .",
    "the ground - state limit @xmath133 gives the map restoration .",
    "the maximum is at @xmath134 for the optimal choice of @xmath135 , as predicted by eq .",
    "( [ bound1 ] ) .",
    "this figure indicates that one does not have to approach the zero temperature limit as in map in the search of the best restored image by such a process as simulated annealing .    for the curves opt*0.9 and",
    "opt*1.1 , the location of the largest @xmath90 is not at @xmath136 .",
    "however , the maximum value coincides with the best value as predicted by eq .",
    "( [ bound2 ] ) . this fact can easily be verified by differentiating eq .",
    "( [ mi ] ) with respect to @xmath57 .",
    "the optimal parameter is @xmath137 , agreeing with eq .",
    "( [ line ] ) .",
    "the line of optimal performance in the space of @xmath138 and @xmath46 is obtained by combining eqs .",
    "( [ line ] ) and ( [ ireqs ] ) , yielding @xmath139 when @xmath140 , @xmath138 approaches the limit @xmath141 .",
    "this is the temperature above which the maximum overlap can not be achieved .    in the low temperature limit ,",
    "@xmath142 and the ratio @xmath119 approaches a constant @xmath143 hence the maximum overlap is achievable for any temperature below @xmath144 .",
    "the zero - temperature restoration ( the map estimate ) is potentially as optimal as the finite temperature procedure determined by eq .",
    "( [ bound1 ] ) in mean - field systems , although it can only be achieved at the correct ratio @xmath119 given by eq .",
    "( [ hyper ] ) .",
    "figure [ fig_line ] shows the line of optimal performance for the parameters used in fig .",
    "[ fig_ir1 ] .",
    "the hyperbolas @xmath145 = 0.9 , 0.81 and 0.99 correspond to the lines of operation opt @xmath46 , opt*0.9 and opt*1.1 of fig .",
    "[ fig_ir1 ] respectively .",
    "where they intersect the line of optimal performance , the overlap reaches a maximum .    in realistic image restoration",
    ", the precision in the estimation of hyperparameters is an important issue .",
    "one can see that the three lines of operation follow the general trend of the optimal curve .",
    "hence they are much more error - tolerant than other curves , say , @xmath132 .",
    "furthermore , if a line of operation intersects the line of optimal performance with a small angle between the tangents , then the overlap @xmath90 is very near to its optimum for a wide range of parameters along the line of operation , and the procedure has a high tolerance for parameter uncertainties . among the three lines of operation in fig .",
    "[ fig_line ] , @xmath145 = 0.99 has the highest tolerance .",
    "in fact , if one uses @xmath145 = 1.0267 according to eq .",
    "( [ hyper ] ) , then it has the widest range of tolerance in the low temperature region .",
    "figure [ fig_ir2 ] shows the effects of introducing the exchange term .",
    "it depicts @xmath90 as a function of the inverse exchange temperature @xmath45 in eq .",
    "( [ irz ] ) with the other parameters set to the optimal values @xmath146 and with @xmath147 in the unit @xmath148 .",
    "the axis @xmath149 corresponds to the optimum point @xmath136 of fig .",
    "[ fig_ir1 ] .",
    "the introduction of the exchange term is seen to sharply improve the performance .",
    "the maximum of @xmath90 is located at @xmath150 as required , and @xmath90 stays close to the maximum value beyond @xmath151 .",
    "the combination of the ideas of error - correcting code ( the @xmath45-term ) and image restoration ( the @xmath57 and @xmath46 terms ) leads to a remarkable improvement in the quality of restored image .",
    "two remarks are in order in relation to fig .",
    "[ fig_ir2 ] .",
    "first , the amount of information conveyed by the set @xmath106 may seem exceedingly large compared to that by @xmath152 because the number of elements in the former set is @xmath153 while it is @xmath8 in the latter .",
    "this fact may be mistaken as the reason of the improved result in fig .",
    "[ fig_ir2 ] for finite @xmath45 .",
    "however , since each @xmath154 is much smaller in magnitude than @xmath155 , the contribution of each @xmath156 is very small . such a situation is characteristic of the infinite - range model .",
    "the equivalent situation in the finite - dimensional case is that the number of exchange interactions is of the same order as that of sites .",
    "for example , there are @xmath157 nearest neighbor interactions for @xmath8 sites on the square lattice .",
    "therefore , the increase in the amount of information by the introduction of the set @xmath106 should be of order unity , not infinitely large . secondly ,",
    "as the exchange term is seen to increase the overlap very sharply , even the information from a fraction of the exchange interactions may be useful to improve the restoration result .",
    "for example , one may choose a small fraction of pairs of sites ( either randomly or not ) and use the corrupted , noisy version of these exchange interactions to restore the image to obtain a better result .",
    "this method should be useful when the bandwidth ( the amount of information to be carried by the channel ) is limited .",
    "it is difficult to investigate the more realistic case of two - dimensional images by analytical methods .",
    "we therefore have carried out monte carlo simulations to confirm the qualitative pictures obtained by the exact solution of the infinite - range model . to generate the source image ,",
    "we have used the prior ( [ ps ] ) with @xmath158 which is slightly lower than the critical point @xmath159 of the two - dimensional ising model on the square lattice .",
    "the error probability was set to @xmath160 for bsc , corresponding to @xmath161 by eq .",
    "( [ betar ] ) .",
    "averages over 5 samples ( fig .",
    "[ fig_ir3 ] , size @xmath162 ) or 10 samples ( fig .",
    "[ fig_ir4 ] , size @xmath163 ) were taken at each data point .",
    "figure [ fig_ir3 ] shows the overlap @xmath90 as a function of @xmath138 when @xmath128 and @xmath46 is chosen so that @xmath119 is fixed to the optimum value @xmath164 . the overlap should have a maximum at @xmath165 in fig .",
    "[ fig_ir3 ] according to eq .",
    "( [ bound1 ] ) although it is not very clearly seen due to statistical uncertainties .",
    "it is at least true that @xmath90 does not change significantly below @xmath166 .",
    "it is therefore unnecessary to lower the temperature than @xmath158 to obtain a better result .",
    "the effects of exchange interactions have been taken into account in fig .",
    "[ fig_ir4 ] where @xmath138 and @xmath46 are fixed to the optimal values 2.15(@xmath167 ) and 1.0986(=@xmath43 ) respectively .",
    "the overlap is seen to increase quite significantly as a function of @xmath45 .",
    "the axis @xmath128 corresponds to the optimal point of @xmath166 in fig .",
    "[ fig_ir3 ] .",
    "the overlap reaches its maximum at around @xmath168 as it should and decreases slowly as @xmath45 is further increased .",
    "respectively , figs .",
    "[ fig_ir3 ] and [ fig_ir4 ] are qualitatively similar to opt @xmath46 in fig .",
    "[ fig_ir1 ] , and fig .",
    "[ fig_ir2 ] , for the infinite - range model , implying the usefulness of the infinite - range model as an approximation of the two - dimensional problem .",
    "let us show an explicit example of the actual image restoration .",
    "figure [ fig_ir5 ] represents the situations of figs .",
    "[ fig_ir3 ] and [ fig_ir4 ] with the size @xmath163 .",
    "we have generated a pattern by the prior ( [ ps ] ) with @xmath158 to obtain ( a ) and have added noise with probability @xmath169 , resulting in ( b ) @xcite . to obtain the restored images ( c ) and ( d )",
    "only the corrupted image ( b ) was used without extra information on exchange interactions ( @xmath149 ) .",
    "restoration was tried at temperatures @xmath170 for ( c ) resulting in @xmath171 and at @xmath166 for ( d ) with @xmath172 .",
    "it is clearly recognized that the optimal temperature @xmath166 ( d ) has a better restored image than ( c ) .",
    "the low - temperature process ( c ) suppresses small structures which were actually present in the original image .",
    "the low temperature result is close to the map estimate ( @xmath173 ) which would further suppress small structures .",
    "it should be noticed that the difference in @xmath90 in these two restored results ( c ) and ( d ) is very small ( which is also seen in fig .",
    "[ fig_ir3 ] ) but the intuitive impressions on similarity to the original image ( a ) are rather different .",
    "the reason is that the small structures do not contribute significantly to the value of @xmath90 although such structures have strong influence on intuitive impressions .",
    "therefore we should keep in mind that the overlap @xmath90 alone does not represent all aspects of the quality of restored images .",
    "we next consider the effects of the additional information of exchange interactions among nearest neighbors . the same corrupted image ( b ) has been used to obtain the restored image ( e ) .",
    "the parameters @xmath138 , @xmath46 and @xmath45 were fixed to the optimal values 2.15(@xmath167 ) , 1.0986(@xmath174 ) and 1.0986(@xmath175 ) respectively , resulting in an overlap of @xmath176 .",
    "fine structures are remarkably well restored in the result ( e ) .",
    "thus the additional information of exchange interactions is very effective to restore images faithfully .",
    "the infinite - range model has the same significance in error - correcting codes as in the image restoration problem ; namely , an exactly solvable model which describes more realistic situations at least qualitatively .",
    "the difference is that we consider a general value of @xmath5 in error - correcting codes , instead of only @xmath9 in the case of image restoration .",
    "we therefore calculate the overlap @xmath90 and related quantities explicitly assuming that the set @xmath177 in eq .",
    "( [ hamiltonian ] ) extends over all possible combinations of indices .",
    "we consider the gaussian channel , and the source and model distributions are both assumed to be uniform , @xmath178 , as is customary in the theory of error - correcting codes @xcite .",
    "> from eqs .",
    "( [ m ] ) and ( [ gauss1 ] ) , the overlap is given by @xmath179 the normalizations of @xmath72 and @xmath180 are different from eq .",
    "( [ gauss1 ] ) and follow the convention of the infinite - range model of spin glasses so that the limit @xmath181 yields meaningful results @xcite .",
    "we may change the signs of integration variables in eq .",
    "( [ ecc ] ) appropriately ( @xmath182 , @xmath183 , @xmath184 ) which allows us to drop @xmath185 s from the integrand ( the ferromagnetic gauge ) .",
    "then the problem becomes the standard mean - field theory of spin glasses with @xmath5-spin interactions under external random fields , and we can apply the well - established replica method @xcite .",
    "standard replica calculations under the replica - symmetric ( rs ) ansatz lead to the following set of equations of state for the spin glass order parameter @xmath186 , ferromagnetic order parameter @xmath112 and the overlap @xmath90 : @xmath187 where @xmath188 is the gaussian measure and @xmath189 the corresponding free energy is @xmath190    the present system with @xmath191 is known to have a spin glass phase with a single - step replica - symmetry breaking ( 1rsb ) at a low temperature when @xmath192 @xcite .",
    "this spin glass phase with 1rsb is replaced by a full - step replica - symmetry breaking at a still lower temperature .",
    "it is therefore necessary to study replica - symmetry breaking solutions following refs . @xcite .",
    "the stability condition of the rs solution ( the at line ) is found to be @xmath193 the free energy with 1rsb ( @xmath62 for simplicity ) is @xmath194 where @xmath195 the self - consistent equations for the order parameters are obtained by extremization of eq .",
    "( [ f-1rsb ] ) @xmath196 we do not write out the explicit form for the equation of @xmath197 because the formula is not very instructive .",
    "the at stability of this 1rsb solution is @xmath198    the phase diagram in the case of @xmath199 and @xmath62 is shown in fig .",
    "[ fig_ecc1 ] .",
    "retrieval is not possible unless the ferromagnetic phase is at least locally stable .",
    "the hatched region satisfies this condition .",
    "the ferromagnetic phase is stable in the replica symmetric ansatz for sufficiently strong bias @xmath180 and high temperature @xmath200 . for @xmath201 above and below 0.651 , it is respectively replaced by the paramagnetic and spin glass phases through first - order phase transitions when @xmath180 decreases .",
    "these three phases coexist at the triple point ( tp ) .",
    "the ferromagnetic phase remains metastable down to the spinodal line shown as a dotted curve .",
    "the replica symmetric solution of the ferromagnetic phase becomes unstable below the at line ( [ at ] ) shown by the dash - dotted curve .    also shown in fig .",
    "[ fig_ecc1 ] are the spin glass phases , which exist at lower values of the bias @xmath180 .",
    "spin glass with a single - step replica symmetry breaking is stable for @xmath201 between 0.651 and 0.240 . at lower temperatures ,",
    "it is replaced by a full replica symmetry breaking spin glass phase .",
    "investigation of the properties of the mixed phase m ( such as distinction between 1rsb and full rsb ) , as well as the deatils of the spin glass phase , are interesting future problems , which we do not pursue here since they are not directly relevant to our problem of error - correcting codes around the optimum temperature @xmath202 shown dashed in fig .",
    "[ fig_ecc1 ] .",
    "we have not shown the structure of the phase diagram at very low temperatures for this reason .",
    "figure [ fig_ecc2 ] shows the dependence of the overlap @xmath90 on the decoding temperature @xmath203 with @xmath199 and @xmath204 .",
    "the line @xmath204 lies slightly to the right of the triple point tp in fig .",
    "[ fig_ecc1 ] .",
    "the maximum performance is achieved at @xmath205 .",
    "this result is consistent with the argument in sec .",
    "ii c : if we repeat the proof of eq .",
    "( [ bound1 ] ) with the external field neglected and @xmath178 , we obtain the inequality @xmath206 .    the optimum condition @xmath202 coincides with the nishimori line shown dashed in the phase diagram ( fig . [ fig_ecc1 ] ) .",
    "this curve crosses the phase boundary and the spinodal line at the points where @xmath180 takes the smallest values in the ferromagnetic stable and metastable phases respectively ( marked by black and white circles ) .",
    "it can be shown that the spinodal line , the nishimori line and the at line are concurrent for any values of @xmath5 .",
    "hence the at line terminates at the triple point .",
    "since the nishimori line lies in the replica symmetric phase , the replica symmetric argument would be sufficient to clarify the behavior of the overlap around its maximum .",
    "the lower temperature properties , including the possibility of a reentrant spin glass phase , may be affected by replica symmetry breaking .",
    "figure [ fig_ecc3 ] shows the dependence of @xmath90 on the random field strength @xmath46 at the optimal temperature @xmath207 with @xmath199 , @xmath204 and @xmath208 .",
    "the axis @xmath62 corresponds to the conventional sourlas code without the field term , which is the maximum point in fig .",
    "[ fig_ecc2 ] .",
    "it is observed that the overlap @xmath90 increases sharply as the field is introduced , reaching the maximum at @xmath132 , in agreement with the theoretical prediction @xmath209 .",
    "we have formulated the problems of image restoration and error - correcting codes in a unified framework using statistical mechanics .",
    "we have derived an upper bound on the overlap @xmath90 between the restored / decoded image / sequence and the original image / sequence .",
    "the maximum of @xmath90 is achieved when the restoring / decoding temperature and field strength match the corresponding temperature and field strength characteristic of the source and channel properties .",
    "this result comes as a natural generalization of the previously known inequalities for image restoration @xcite and error - correcting codes @xcite .",
    "the formulation and the proof of the inequality have a formal similarity to the theory of spin glasses , in particular the one using gauge symmetry @xcite .",
    "one should note however that we have not used gauge symmetry in the present paper .",
    "the variables @xmath4 in eq .",
    "( [ expectation ] ) , playing a central role in the spin glass theory @xcite , come naturally in the present problem whereas they emerged as a result of gauge transformation in the spin glass theory .",
    "the infinite - range model has been solved exactly both in the image restoration and error - correcting code situations .",
    "the results made it possible to reveal the dependence of the overlap @xmath90 on various parameters .",
    "simulations for image restoration have confirmed that the results for the infinite - range model remain qualitatively valid in two dimensions .    for image restoration in mean - field systems , we have found a line of optimal performance along which the overlap @xmath90 takes the same maximum value .",
    "the line contains the point of optimal performance predicted by the inequality ( [ bound1 ] ) , but extends also to the zero - temperature limit .",
    "this indicates that optimal ( or quasi - optimal ) performance is far more accessible than previously thought .",
    "it remains to study the extent to which the picture is applicable to finite - dimensional systems where the mean - field theory is only approximate . in this respect",
    ", it is interesting to note that a ridge of nearly optimal overlap has already been observed in early literature , such as fig . 2 of @xcite and fig . 8 of @xcite .",
    "naturally , one is led to expect that a narrow but extended region of optimal ( or near - optimal ) performance spans the parameter space .    by comparing the optimal line and the operation lines on which @xmath119 is kept constant ,",
    "we have studied the tolerance towards uncertainties in parameter estimation .",
    "apparently the zero - temperature restoration ( the map estimate ) is most robust .",
    "furthermore , if the map estimate is approached by simulated annealing , it may be more effective to consider rescaling the field strength while lowering the temperature at the same time .    however , we have a few remarks of caution about the map estimate . ( a )",
    "the zero - temperature restoration is optimal only when the correct ratio @xmath119 is used , which can only be found self - consistently in realistic situations ; if the incorrect ratio is used , the performance will be sub - optimal .",
    "( b ) the existence of the line of optimal performance in finite - dimensional systems remains an open issue .",
    "simulations in two dimensions seem to show that the map estimate is sub - optimal , although most likely it is still nearly optimal . on the other hand , the optimal point predicted by eq .",
    "( [ bound1 ] ) is guaranteed to be the best in general cases .",
    "( c ) the present result applies to the equilibrium state of the system , and the dynamics remains an open issue .",
    "it may happen that the approach to equilibrium at a low temperature is much slower , or is more prone to being trapped by local minima .",
    "we have also considered the inclusion of exchange interactions as extra information in image restoration .",
    "explicit examples of images in two dimensions show that the fine structures are remarkably well restored .",
    "we remark that the exchange interactions have some similarities with `` line processes '' , which has been proposed to improve the quality of images @xcite .",
    "if the line variables were quenched , they are equivalent to binary and multiple interactions among neighboring sites .",
    "however , a major difference is that the line variables are dynamical in the process of image restoration , whereas the exchange interactions considered here are quenched .",
    "a comment is in order on the amount of information carried by the channel of the infinite - range model .",
    "the signal amplitude of the exchange term in eq .",
    "( [ ecc ] ) is @xmath210 .",
    "the channel noise causes fluctuations in the output with the standard deviation @xmath211 , which is much larger than the signal itself when @xmath212 .",
    "this corresponds to an extremely low signal - to - noise ratio , yet the output still contains significant information of the original message .",
    "this demonstrates the power of the infinite - range decoding scheme in extremely noisy situations , although in practice such extremes do not occur frequently .    finally , we mention briefly the idea of selective freezing @xcite .",
    "the ising spins keep moving under thermal agitation when we employ the process of finite - temperature restoration .",
    "some spins have smaller thermal fluctuations than the others , resulting in larger local magnetic moments .",
    "it may thus be interesting to fix ( freeze ) those relatively stable spins to @xmath213 according to the sign of @xmath214 and repeat the finite - temperature decoding / restoration process for the other less stable degrees of freedom .",
    "we call this idea the selective freezing , which turns out to enhance tolerance against uncertainties in parameter estimation .",
    "the details will be presented in a forthcoming paper @xcite .",
    "one of the authors ( h. n. ) thanks department of physics , hong kong university of science and technology , for hospitality .",
    "he is also indebted to prof .",
    "kazuyuki tanaka for a comprehensive tutorial on the theory of image restoration and to prof .",
    "shun - ichi amari for useful comments .",
    "we thank dr .",
    "domenico carlucci for an observation leading to the discovery of the line of optimal performance , dr .",
    "david saad for drawing our attention to ref .",
    "@xcite , and prof .",
    "david sherrington for discussions .",
    "this work is partially supported by a grant from the research grant council of hong kong .",
    "to prove the inequality ( [ bound1 ] ) , we first note that the argument of the summation in the definition ( [ m ] ) is bounded by its absolute value : @xmath215 where @xmath216 has been replaced with 1 . using the identity @xmath217",
    ", we get @xmath218 thus the right hand side can be interpreted as the average of the product of @xmath87 and @xmath219 at the optimal parameter values @xmath101 ,",
    "@xmath66 and @xmath102 , yielding eq .",
    "( [ bound1 ] ) .",
    "to derive the inequality ( [ bound2 ] ) , we start with the definition ( [ m ] ) . substituting eqs .",
    "( [ general ] ) , ( [ ps ] ) and ( [ pm ] ) we obtain , for @xmath220 in the average , @xmath221 in the exponential argument of the boltzmann factor containing @xmath222 , @xmath223 only appears in the expression @xmath224 . hence if we multiply and divide this expression by the partition function of @xmath4 excluding site 1 , we have @xmath225 where @xmath226 represents the thermal average taken over the hamiltonian with inverse temperature @xmath113 and random field strength @xmath43 , excluding site 1 .",
    "similar arguments can be applied to the argument of the sign function in ( [ mir ] ) , yielding @xmath227 for mean - field systems , @xmath228 and @xmath229 are self - averaging quantities @xcite , and the thermal average of the hyperbolic sine functions can be replaced by a single function of the thermal averaged argument .",
    "thus @xmath230 reduces to @xmath231 for mean - field systems with large valency , the averaging over the neighbors of site 1 reduces to the disordered average .",
    "consider @xmath232 $ ] , which is the thermal and disordered average of @xmath233 taken over the hamiltonian @xmath234 , @xmath235=          & & \\frac{1}{z(\\beta_s)^{\\backslash 1 } }          \\prod_{i\\ne 1}\\int d\\tau_i f_1(\\tau_i )          { \\sum_{\\xi_i}}^{\\backslash 1 }       \\exp \\left(\\frac{\\beta_s}{z }           { \\sum_{\\langle ij\\rangle}}^{\\backslash 1}\\xi_i\\xi_j             + \\beta_\\tau { \\sum_i}^{\\backslash 1}\\tau_i \\xi_i \\right )          \\nonumber \\\\          & & \\frac {          { \\sum_{\\eta_i}}^{\\backslash 1}\\eta_j       \\exp \\left(\\frac{\\beta_s}{z }           { \\sum_{\\langle ik\\rangle}}^{\\backslash 1}\\eta_i\\eta_k             + \\beta_\\tau { \\sum_i}^{\\backslash 1}\\tau_i \\eta_i \\right ) } {          { \\sum_{\\eta_i}}^{\\backslash 1 }       \\exp \\left(\\frac{\\beta_s}{z }           { \\sum_{\\langle ik\\rangle}}^{\\backslash 1}\\eta_i\\eta_k             + \\beta_\\tau { \\sum_i}^{\\backslash 1}\\tau_i \\eta_i \\right)}.\\end{aligned}\\ ] ] after canceling terms in the denominator and numerator , we arrive at @xmath236=          \\frac{1}{z(\\beta_s)^{\\backslash 1 } }          \\prod_{i\\ne 1}\\int d\\tau_i f_1(\\tau_i )          { \\sum_{\\eta_i}}^{\\backslash 1}\\eta_j       \\exp \\left(\\frac{\\beta_s}{z }           { \\sum_{\\langle ik\\rangle}}^{\\backslash 1}\\eta_i\\eta_k             + \\beta_\\tau { \\sum_i}^{\\backslash 1}\\tau_i \\eta_i \\right),\\ ] ] which reduces to @xmath237=m_0 $ ] , namely the magnetization in the prior distribution .",
    "similarly , @xmath238=m$ ] , which is the magnetization in the model distribution .    substituting these results , and using the normalization of the probability @xmath239 , eq .",
    "( [ m3 ] ) reduces to @xmath240 the rest of the proof is similar to appendix a. noting that the integrand of @xmath74 is bounded by its absolute value , we have @xmath241 the right hand side is the value of @xmath230 when eq .",
    "( [ line ] ) is satisfied , since in this case , @xmath242 .",
    "99 r. j. eliece , _ the theory of information and coding _ , encyclopedia of mathematics and its applications ( addison - wesley , reading , ma , 1977 )",
    ". j. m. pryce and a. d. bruce , j. phys .",
    "a * 28 * , 511 ( 1995 ) .",
    "n. sourlas , nature * 339 * , 693 ( 1989 ) .",
    "d. c. mattis , phys .",
    "lett . a * 56 * , 421 ( 1976 ) .",
    "j. c. a. van der lubbe , _ information theory _",
    "( cambridge , new york , 1997 ) .",
    "p. rujn , phys .",
    "lett . * 70 * , 2968 ( 1993 ) .",
    "h. nishimori , prog .",
    "* 66 * , 1169 ( 1981 ) .",
    "h. nishimori , j. phys .",
    "soc . jpn . * 62 * , 2973 ( 1993 ) .",
    "n. sourlas , europhys .",
    "lett . * 25 * , 159 ( 1994 ) .",
    "y. kabashima and d. saad , europhys . lett .",
    "* 45 * , 97 ( 1999 ) .",
    "s. geman and d. geman , ieee trans .",
    "pami * 6 * , 721 ( 1984 ) .",
    "j. zerubia and r. chellapa , ieee trans .",
    "neural net . * 4 * , 703 ( 1993 ) .",
    "k. tanaka and t. morita , phys .",
    "a * 203 * , 122 ( 1995 ) ; physica a * 223 * , 244 ( 1996 ) ; t. morita and k. tanaka , pattern recog .",
    "lett . * 18 * , 1479 ( 1998 ) .",
    "j. l. marroquin , s. mitter and t. poggio , j. am .",
    "assoc . * 82 * , 76 ( 1987 ) .",
    "z. zhou , r. m. leathy and j. qi , ieee trans .",
    "image proc .",
    "* 6 * , 844 ( 1997 ) .",
    "k. h. fischer and j. a. hertz , _ spin glasses _",
    "( cambridge , new york , 1991 ) . rigorously speaking , the state of fig .",
    "[ fig_ir5 ] ( a ) is a metastable state , not in full thermal equilibrium in which most of the pixels are either black or white when @xmath243 is below the critical point .",
    "we nevertheless show the example ( a ) in fig .",
    "[ fig_ir5 ] because it represents true equilibrium situations rather faithfully ( if we look only at the mostly white domain , for example ) and simultaneously it is easier to intuitively recognize the differences among ( a)-(e ) than by using mostly black or white images .",
    "the simulations of figs .",
    "[ fig_ir3 ] and [ fig_ir4 ] were carried out in true equilibrium .",
    "e. gardner , nucl .",
    "phys . b*257 * [ fs*14 * ] , 747 ( 1985 ) .",
    "d.j . gross and m. mzard , nucl .",
    "phys . b*240 * [ fs*12 * ] , 431 ( 1984 ) .",
    "k. y. m. wong , europhys .",
    "lett . * 36 * , 631 ( 1996 ) .",
    "k. y. m. wong and h. nishimori , ( unpublished ) .",
    "b. bergersen and m. plischke , _ equilibrium statistical mechanics _ , 2nd edition ( world scientific , singapore , 1994 ) ."
  ],
  "abstract_text": [
    "<S> we develop a statistical - mechanical formulation for image restoration and error - correcting codes . </S>",
    "<S> these problems are shown to be equivalent to the ising spin glass with ferromagnetic bias under random external fields . </S>",
    "<S> we prove that the quality of restoration / decoding is maximized at a specific set of parameter values determined by the source and channel properties . for image restoration in mean - field system a line of optimal performance </S>",
    "<S> is shown to exist in the parameter space . </S>",
    "<S> these results are illustrated by solving exactly the infinite - range model . </S>",
    "<S> the solutions enable us to determine how precisely one should estimate unknown parameters . </S>",
    "<S> monte carlo simulations are carried out to see how far the conclusions from the infinite - range model are applicable to the more realistic two - dimensional case in image restoration . </S>"
  ]
}