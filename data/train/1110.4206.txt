{
  "article_text": [
    "using huge object catalogs is more common in astronomical studies and observations . to support searching such catalogs , a variety of web - based database services have been developed .",
    "for example , nasa / ipac infrared science archive ( irsa ; * ? ? ?",
    "* ) , vizier @xcite and virtual observatory ( vo ; * ? ? ?",
    "* ) portal sites are widely used in astronomical communities .",
    "some project teams distribute software to be installed in personal computers to use such services via a network .",
    "astronomers and developers can use various catalogs with web browsers and such client - side software .    on the other hand",
    ", there is software to search catalogs in offline environments .",
    "for example , `` scat '' in the wcstools package @xcite is widely used in astronomical communities .",
    "such software is important for observatories with unstable or narrowband networks or for personal studies that require huge catalog entries .",
    "although skyserver @xcite of sloan digital sky survey ( sdss ; * ? ? ?",
    "* ) shows powerful flexibility of the programming interfaces based on structured query language ( sql ) for catalog search , it is not easy for end users to have such a high - performance search server in offline environments .",
    "therefore , we develop a software kit that enables any users to construct a database system based on a relational data base management system ( rdbms ) in their personal computers and to quickly search a huge catalog with functions similar to sdss skyserver .",
    "the first target of our kit is the two micron all sky survey @xcite point source catalog ( 2mass psc ) , which is huge but frequently used in astronomy .",
    "we implement powerful functions into the kit using our various techniques .",
    "one of the features of our techniques is applying an @xmath0@xmath1@xmath2 coordinate system for fast radial search of a huge catalog .",
    "this implementation might be rare and interesting for developers , and we mainly report it in this article .    our software kit is built on publicly available software .",
    "in contrast , commercial rdbms products have been used to develop previous web - based database services of huge catalogs such as sdss skyserver @xcite , wfcam science archive @xcite , etc .",
    "this article will also demonstrate the true power of an open - source rdbms .",
    "this article is organized as follows : first , our software kit is introduced in  [ overview ] .",
    "we show our overview of software design in  [ overview_sd ] . in  [ radial_search ] , we explain details of our techniques and reasonable implementation for high - speed radial search of our software kit .",
    "we additionally report techniques for rectangular search in  [ rectangular ] .",
    "summary is given in ",
    "[ summary ] .",
    "note that primitive data types of rdbms are displayed in the following way throughout this article : int2 is a signed two - byte integer , int4 is a signed four - byte integer , and float8 is a double - precision floating - point number .",
    "the 2mass catalog server kit  http://www.ir.isas.jaxa.jp/@xmath3cyamauch/2masskit/. software package and data set are available in this page .",
    "we are planning to support usno - b1.0 , ppmxl , gsc-2.3 , etc.]@xmath4 ( 2mass kit ) is a software package to construct a high - performance search server of 2mass psc and several all - sky catalogs on linux , macosx , solaris , and other unix systems . to install this kit , it is enough to prepare a standard personal computer with a hard drive of 600 gbyte or more .",
    "the kit contains a complete data set of tables for 2mass psc , sql statements and sources of c language with a makefile .",
    "the html document ( fig .",
    "[ fig : sshot_kit ] ) shows step - by - step instructions for installation , a tutorial for database beginners , reference of stored functions , and several hints for tuning .",
    "the instructions include a procedure for setting up rdbms and configuration of the operating system ; therefore , any users can easily construct their own catalog database servers .",
    "users can search catalogs not only with flexible sql but also with several useful stored functions prepared by our kit . using the functions in users sql statements",
    ", users can perform fast radial and rectangular search with very small sql statements with coordinate conversions ( e.g. , j2000 to galactic ) .",
    "of course , users do not have to know algorithm and indexing about typical searches .",
    "we show an example sql statement of a radial search of galactic coordinate ( 0,0 ) with 0.2@xmath5 radius : + ` select fj2l(o.ra , o.dec ) as l , ` + `        fj2b(o.ra , o.dec ) as b , ` + `        o.j_m , o.h_m , o.k_m , n.distance ` + ` from ftwomassgetnearbyobjeq ( ` + `            fg2ra(0,0),fg2dec(0,0),0.2 ) n , ` + `      twomass o ` + ` where n.objid = o.objid ; ` + where fj2l ( ) and fj2b ( ) convert j2000 to galactic , fg2ra ( ) and fg2dec ( ) convert galactic to j2000 , and ftwomassgetnearbyobjeq ( ) is a stored function that performs fast radial search of 2mass psc with an optimized algorithm .",
    "the kit is also characterized by its flexible tuning .",
    "each table and index for 2mass psc is registered in one of seven table spaces ( each resides in a separate directory ) , thus allowing only the essential parts to be easily moved onto fast devices .",
    "given the terrific evolution that has taken place with recent solid - state drives ( ssds ) in performance , a very cost - effective way of constructing high - performance servers is moving part , or all , of the table indices to a fast ssd .    before installing the 2mass kit , users can confirm the performance of our kit using the sql search tool  http://darts.jaxa.jp/ir/akari/cas/tools/search/sql.html.]@xmath4 of the akari catalogue archive server ( akari - cas ; * ? ? ? * ) .",
    "akari - cas is developed to search akari all - sky catalogues based on imaging data obtained by the far - infrared surveyor ( fis ; * ? ? ?",
    "* ) and the infrared camera ( irc ; * ? ? ?",
    "* ) built on akari satellite , and it also supports fast search for 2mass psc . to perform this search , akari - cas has the source codes of 2mass kit .",
    "of course , our kit utilizes open - source rdbms , postgresql-8.4 , and therefore requires no software licensing fees .",
    "choosing an appropriate rdbms product is important for our software design , since functions to support various users requirements depend on rdbms products .",
    "users will search the 2mass psc using various criteria .",
    "therefore , the rdbms product should meet recent sql standards and must have enough search performance .",
    "in addition , some users might not have knowledge about indices of tables . to support such users , the kit has to provide some functions to minimize sql statements for typical searches in astronomy .",
    "therefore , the rdbms product should have high coding flexibility of stored functions .",
    "we investigated some open - source rdbms products when developing akari - cas .",
    "we found that postgresql perfectly satisfies the preceding requirements .",
    "see also @xcite for an investigation about rdbms products .",
    "fast positional search is indispensable for astronomy , even if the database has huge catalogs .",
    "fortunately , postgresql has some special features to handle huge tables .",
    "for example , postgresql supports table inheritance that is useful for table partitioning and has a `` constraint - exclusion '' feature to allow us a seamless access to the partitioned tables . to obtain the best performance of positional search , i.e. , radial search and rectangular search",
    ", we apply such features and write our codes in stored functions for more optimization .",
    "we mainly tune the performance of radial search , since it is most important for astronomical catalog databases .",
    "our severe test for it is done by cross - identification as multiple radial searches .",
    "it is the main theme of this article .",
    "one of the advantages of postgresql is having many built - in functions usable in sql statements .",
    "together with them , coordinate conversions shown in ",
    "[ overview ] such as j2000-to - galactic conversion are supported by newly created stored functions that contain some codes of wcstools-3.8 .",
    "our kit provides further functions that are also available in akari - cas .",
    "see @xcite for general technical know - how for creating stored functions in postgresql .",
    "the radial search is the most typical query in the catalog database services .",
    "however , this search using rdbms can not be optimized in a straightforward way , because an index of rdbms is useful for the case : @xmath6 where @xmath7 and @xmath8 are the search criteria and @xmath9,@xmath10,@xmath11 are data of columns a , b , etc .",
    "; however , an index can not be created for following case : @xmath12 where @xmath13 and @xmath14 are also the search criteria .",
    "the radial search corresponds to the case ( [ eq : rad ] ) , i.e. , @xmath15 is a function that takes a pair of positions and returns an angular distance , and @xmath8 is the search radius .    to enable fast radial search applying the database index , some special methods based on spatial splitting have been devised , such as hierarchical triangular mesh  http://skyserver.org/htm/.]@xmath4 ( htm ; * ? ? ? * ) or healpix  http://healpix.jpl.nasa.gov/.]@xmath4 @xcite .",
    "their methods divide the sky into many areas , assign each area the unique i d , and give each object a corresponding i d from which the one - dimensional index is created .",
    "we do not use such techniques , but use the more simple and cost - effective way .",
    "figure [ fig : concept ] shows the concept of our radial search .",
    "the most important point of this concept is the use of the @xmath0@xmath1@xmath2 coordinate for the database index .    in our databases ,",
    "the object tables have columns of unit vectors ( cx , cy , cz ) presenting j2000 source positions .",
    "we create a composite index on ( cx , cy , cz ) and write stored functions to execute the following procedure :    1 .",
    "catch objects within a cube of the size @xmath16@xmath17@xmath16@xmath17@xmath16 using index scan on ( cx , cy , cz ) .",
    "2 .   select objects within the strict search circle on the celestial sphere from the result of step 1 .",
    "the feature of our algorithm is that it requires almost no calculation before executing the index scan , and the efficiency is quite high for a small search radius .",
    "in addition , we do not have to implement special processing for polar singularity .",
    "@xcite pointed out the advantage of applying orthogonal coordinate system to avoid polar singularity .      in this section",
    ", we present our implementation and test results of radial search of the akari / irc point source catalogue ( akari / irc psc ; * ? ? ?",
    "* ) , including 870,973 objects .",
    "it is relatively small compared with the sdss or 2mass catalog ; therefore , we implement the system only with the basic method described in ",
    "[ basic_method ] .      1 .",
    "register all rows of all columns of akari / irc psc into a table akariirc .",
    "the table includes a primary key objid of int4 type , j2000 source position ( ra , dec ) of float8 type and unit vector ( cx , cy , cz ) of float8 type converted from ( ra , dec ) .",
    "2 .   create a composite index on ( cx , cy , cz ) by the following sql statement :  in the case of postgresql , we have to do vacuum analyze ; after creating indices.]@xmath4 + ` create index akariirc_xyz ` + `        on akariirc(cx , cy , cz ) ; `    to perform a radial search , we create sql stored functions . for example , the source code of a stored function to obtain an objid of the object whose distance from search position is the smallest in the search region is given next :  see appendix a for each stored function written in this definition.]@xmath4 + ` create function ` + `        fakariircgetnearestobjideq(float8,float8,float8 ) ` + ` returns int4 as ` + ` ' select o.objid ` + ` from ( ` + `   select objid , ` + `     fdistancearcminxyz(feq2x($1,$2),feq2y($1,$2 ) , ` + `                feq2z($1,$2),cx , cy , cz ) as distance ` + `   from akariirc ` + `   where ` + `   ( cx between feq2x($1,$2 ) - farcmin2rad($3 ) and ` + `               feq2x($1,$2 ) + farcmin2rad($3 ) ) and ` + `   ( cy between feq2y($1,$2 ) - farcmin2rad($3 ) and ` + `               feq2y($1,$2 ) + farcmin2rad($3 ) ) and ` + `   ( cz between feq2z($1,$2 ) - farcmin2rad($3 ) and ` + `               feq2z($1,$2 ) + farcmin2rad($3 ) ) ` + ` ) o ` + ` where o.distance",
    "< = $ 3 ` + ` order by o.distance ` + ` limit 1 ' ` + ` immutable language ' sql ' ; ` + where $ 1 , $ 2 , and $ 3 are the arguments of this stored function ; ( $ 1 , $ 2 ) is the center position in j2000 of the search region ; and $ 3 is the search radius .",
    ".results of match - up of akari / fis bsc with akari / irc psc .",
    "the hardware is a core2quad q9650 ( 3.0ghz ) cpu on gigabyte ga - ex38-ds4 with 8 gbyte ddr2 - 800 memory and an adaptec raid 2405 with 1 tbyte sata2 hdd@xmath172 ( raid1 ) . [",
    "cols=\"<,^\",options=\"header \" , ]     one of the best methods to perform cross - identification with huge catalogs is the plane sweep techniques ( * ? ? ?",
    "* n. hambly 2011 , private communication ) .",
    "although 2mass kit supports cross - identification as multiple radial searches , such a rdbms - based approach might generally be unsuitable for the best performance .",
    "however , we found that satisfactory performance can be obtained using 2mass kit with recent inexpensive and high - speed ssds and multicore cpus .",
    "we store the postgresql database files of the index set and table set for radial search ( about 30 gbyte ) into a crucial c300 mlc ssd , and we test the performance of cross - identification between akari / irc psc and 2mass psc using six - core ( 12-thread ) cpus on a dual - processor board .",
    "we connect multiple sessions to the postgresql server and execute the following sql statements simultaneously : +   + `      ` ftwomassgetnearestobjideq(o.ra , o.dec , 0.25 ) ) + from ( select * from akariirc   + `        ` where objid % @xmath18 = @xmath19 order by dec ) o ; + where @xmath18 is the number of sessions , and a unique sequential number beginning with @xmath20 is assigned to @xmath19 for each session .",
    "for example , we set @xmath21 and @xmath22 and @xmath23 for cross - identification using four sessions ( threads ) .",
    "the results are shown in table [ table : crossid_multicore ] .",
    "less than 10 sessions show significant scaling factor .",
    "recent mainstream cpus have four cores or more ; therefore , rdbms - based multiple radial searches might become a good choice for several situations .",
    "devereux , d. , abel , d. j. , power , r. a. , & lamb , p. r. , 2005 , in asp conf .",
    "347 , astronomical data analysis software and systems xiv , ed .",
    "p. shopbell , m. britton , & r. ebert ( san francisco : asp ) , 346            kunszt , p. z. , szalay , a. s. , csabai , i. , & thakar , a. r. , 2000 , in asp conf .",
    "216 , astronomical data analysis software and systems ix , ed .",
    "n. manset , c. veillet , & d. crabtree ( san francisco : asp ) , 141"
  ],
  "abstract_text": [
    "<S> we develop a software kit called `` 2mass catalog server kit '' to easily construct a high - performance database server for the 2mass point source catalog ( includes 470,992,970 objects ) and several all - sky catalogs . </S>",
    "<S> users can perform fast radial search and rectangular search using provided stored functions in sql similar to sdss skyserver . </S>",
    "<S> our software kit utilizes open - source rdbms , and therefore any astronomers and developers can install our kit on their personal computers for research , observation , etc .    </S>",
    "<S> out kit is tuned for optimal coordinate search performance . </S>",
    "<S> we implement an effective radial search using an orthogonal coordinate system , which does not need any techniques that depend on htm or healpix . applying the @xmath0@xmath1@xmath2 </S>",
    "<S> coordinate system to the database index , we can easily implement a system of fast radial search for relatively small ( less than several million rows ) catalogs . to enable high - speed search of huge catalogs on rdbms </S>",
    "<S> , we apply three additional techniques : table partitioning , composite expression index , and optimization in stored functions . as a result , </S>",
    "<S> we obtain satisfactory performance of radial search for the 2mass catalog . </S>",
    "<S> our system can also perform fast rectangular search . </S>",
    "<S> it is implemented using techniques similar to those applied for radial search .    </S>",
    "<S> our way of implementation enables a compact system and will give important hints for a low - cost development of other huge catalog databases .    </S>",
    "<S> [ firstpage ] </S>"
  ]
}