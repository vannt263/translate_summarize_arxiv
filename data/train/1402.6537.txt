{
  "article_text": [
    "consider @xmath2 particles with positions @xmath3 in a cubic box of size @xmath4 : @xmath5 , @xmath6 being the standard one - dimensional torus and @xmath7 being the physical dimension ( usually @xmath8 ) .",
    "the positions of the particles evolve according to the following dynamics : @xmath9 where @xmath10 is the inverse temperature ( @xmath11 being boltzmann s constant and @xmath12 being the temperature ) and @xmath13 is a standard @xmath14-dimensional brownian motion .",
    "the function @xmath15 is the potential energy , assumed to be smooth for the mathematical analysis .",
    "however , the numerical results presented in section  [ sec : num_real_case ] correspond to a potential energy function with singularities .",
    "standard results ( see for instance the references in  ( * ? ? ?",
    "* section  2.2 ) ) show that   admits the boltzmann - gibbs measure @xmath16 as its unique invariant probability measure ( note that @xmath17 is finite since the position space  @xmath18 is compact and  @xmath19 is smooth hence bounded ) .",
    "in fact , is ergodic with respect to this measure , where ergodicity is understood both as ( i ) the long - time ( almost - sure ) convergence of averages along trajectories @xmath20 for any initial condition  @xmath21 and all observables @xmath22 ; or as ( ii ) the convergence of the law @xmath23 of the process  , happening here at an exponential rate , for instance in total variation : denoting with some abuse of notation the measure @xmath23 by @xmath24 , there exist @xmath25 such that @xmath26 where the total variation distance between two measures @xmath27 is defined as @xmath28 the suprema being taken over all measurable sets of  @xmath18 for the first one , and over all bounded , measurable functions for the second one .    for further purposes ,",
    "we introduce the generator of  , namely the operator @xmath29 this operator ( defined with domain @xmath30 ) is self - adjoint on the hilbert space @xmath31 endowed with the scalar product @xmath32 the operator @xmath33 moreover has a positive spectral gap ( see for instance  ( * ? ? ?",
    "* section  2 ) and references therein ) .",
    "indeed , a simple computation shows that @xmath34 the poincar inequality @xmath35 , valid for any function belonging to @xmath36 allows to conclude that @xmath37 which shows that the spectral gap is larger or equal to  @xmath38 .",
    "in particular , the resolvent @xmath39 is a well - defined operator on  @xmath40 , and the following estimate holds : @xmath41 here and in the sequel , for a given banach space  @xmath42 , we denote by @xmath43 the banach space of bounded operators on  @xmath42 , endowed with the norm @xmath44      the positions  @xmath45 are restricted to the periodic domain  @xmath18 and are therefore uniformly bounded in time . to obtain a diffusive behavior from the evolution of  @xmath45 , we consider the following additive functional defined on the whole space  @xmath46 : starting from @xmath47 , @xmath48 the difference with @xmath45 is that @xmath49 is not reprojected in  @xmath18 by the periodization procedure ( by this , we mean that we do not choose among all the images of @xmath49 by translations of the lattice @xmath50 the one for which all components are in the interval  @xmath51 ) .",
    "the diffusion tensor is then given by the following limit ( provided it exists ) : @xmath52 where the expectation is over all realizations of the continuous dynamics  , starting from initial conditions distributed according to the boltzmann - gibbs measure  .",
    "the following result shows that the diffusion tensor   is well defined , and naturally arises in a diffusive time - rescaling of the dynamics  .",
    "[ thm : cv_faible_processus ] consider for @xmath53 the diffusively rescaled process @xmath54 .",
    "then , as @xmath55 , the process @xmath56 starting from a given initial condition @xmath57 weakly converges on finite time intervals to an effective brownian motion starting from  @xmath57 and with covariance matrix @xmath58 given by  . moreover , @xmath58 is a real , positive definite @xmath59 matrix , satisfying @xmath60 in the sense of symmetric matrices , and which can alternatively be expressed as @xmath61 dt \\right),\\ ] ] where the expectation is over all realizations of the continuous dynamics  , starting from initial conditions distributed according to the boltzmann - gibbs measure  .",
    "the proof of this statement is standard , and follows from arguments presented in  ( * ? ? ?",
    "* chapter  3 ) for instance .",
    "we nonetheless provide a short proof in section  [ sec : cv_faible_processus ] since the proofs of the discrete counterparts of theorem  [ thm : cv_faible_processus ] rely on an appropriate extension of the argument used in the continuous case ( see section  [ sec : einstein ] ) .",
    "a straightforward consequence of theorem  [ thm : cv_faible_processus ] is that the self - diffusion constant @xmath62 , defined as the average mean - square displacement of the individual particles , is well defined and has two equivalent expressions : @xmath63 dt .",
    "\\label{eq : gk}\\end{aligned}\\ ] ] the expression   is called the _",
    "einstein formula_. the second expression   involves an integrated autocorrelation function . in accordance with the standard physics and chemistry nomenclature , we call   the _ green - kubo formula _ for the self - diffusion in the sequel .      in order to compute approximations of formulas such as   or  , the first task is to numerically integrate realizations of the continuous dynamics  .",
    "the most straightforward way would be to resort to a euler - maruyama scheme : given a time - step @xmath64 and denoting by @xmath65 an approximation of @xmath66 , this scheme reads @xmath67 where @xmath68 is a sequence of independent and identically distributed ( i.i.d . )",
    "@xmath14-dimensional standard gaussian random variables .",
    "however , this simple scheme has been shown to fail to be ergodic when the dynamics is considered on unbounded spaces and the potential energy function is not globally lipschitz  @xcite . in simulations of brownian dynamics for ionic solutions ,",
    "potential energy functions with coulomb - type singularities are used and it has been observed that the energy blows up along trajectories of   ( see section  [ sec : num_real_case ] ) .    a way to stabilize the euler - maruyama scheme is to consider the configuration   as a proposal move in a metropolis - hastings algorithm  @xcite .",
    "this is precisely the smart mc algorithm proposed in  @xcite which was later called metropolis adjusted langevin algorithm in the computational statistics literature  @xcite .",
    "more precisely , starting from a configuration @xmath69 ( in fact seen as an element of  @xmath70 ) , a new configuration @xmath71 is proposed according to  , and then accepted with probability @xmath72 where @xmath73 is the probability transition of the markov chain  .",
    "when the proposition is accepted , we project  @xmath74 into the periodic simulation cell  @xmath18 .",
    "if the proposal is rejected , the previous configuration is counted twice : @xmath75 ( it is very important to count rejected configuration as many times as needed to ensure that the boltzmann - gibbs measure  @xmath76 is invariant ) . in conclusion , @xmath77 where @xmath78 are i.i.d .",
    "uniform random variables in  @xmath79 $ ] , and @xmath80 is an indicator function whose value is  1 when @xmath81 and  0 otherwise .",
    "the average rejection rate is @xmath82 in the formula  , @xmath83 is considered as an element of the periodic box  @xmath18 , while the proposed configuration  @xmath74 is not reprojected into the simulation cell  @xmath18 and is therefore considered as an element of  @xmath70 ( see the remark after  ) .    in order to avoid confusion ,",
    "we call the scheme   `` metropolized euler - maruyama '' in the sequel , and denote by @xmath84 its evolution operator : @xmath85 by construction , the measure   is an invariant probability measure for this scheme , which is a reversible markov chain .",
    "we refer to  @xcite for a study of the ergodic properties of the dynamics ( in the more complicated case of dynamics on the full configuration space  @xmath86 , subjected to a confining potential ) .",
    "of course , the fact that some configurations are rejected destroys the trajectorial accuracy of the dynamics , see  @xcite for precise statements .",
    "the resulting strong errors and , as a consequence , errors on finite time correlation functions have been quantified in  @xcite , with prefactors which unfortunately depend on time .",
    "the estimates provided by these works therefore do not provide error estimates on diffusion coefficients , obtained either as infinite time integrals of correlation functions as in the green - kubo formula   or as the infinite time average mean square displacement as in einstein s formula  .",
    "the next section quantifies the errors in the approximation of   and   when the metropolized euler - maruyama scheme is used . although the formulas   and   are equivalent for continuous dynamics , they lead to different numerical methods .",
    "let us already emphasize that the errors on the diffusion coefficients are in fact determined by the expansion of the evolution operator  @xmath87 .",
    "this expansion is the same as the one used to establish weak error estimates . from a technical viewpoint ,",
    "the techniques used in the proofs of our main results are therefore quite different from the techniques of  @xcite , which are based on strong error estimates obtained with gronwall s lemma .",
    "as discussed in  @xcite , error bounds on transport properties in fact depend on approximation properties of the evolution operator ( similar to the one used to prove weak error estimates ) , rather than strong error estimates .",
    "a key building block in this framework is the following expansion of the evolution operator , obtained by a slight extension of  ( * ? ? ?",
    "* lemma  4.7 ) and  ( * ? ? ?",
    "* lemma  5.5 ) .",
    "[ lem : expansion_pdt ] there exist an operator  @xmath88 and @xmath89 such that , for any @xmath90 and any smooth function  @xmath91 , @xmath92 with a remainder @xmath93 uniformly bounded for @xmath90 .",
    "moreover , @xmath94 finally , the average rejection   rate scales as @xmath95 : there is a bounded function @xmath96 such that , for any @xmath97 , there exist  @xmath98 and @xmath99 for which @xmath100 - 1 + { { \\delta t}}^{3/2 } \\overline{\\xi}(q ) \\right|^p { \\leqslant}c_p { { \\delta t}}^{2p},\\ ] ] where the expectation is over all possible realizations of the standard @xmath14-dimensional gaussian random variable  @xmath101 .",
    "the precise expression of the operator  @xmath88 is unimportant .",
    "it is however given in the proof of this result , see section  [ sec : proof_expansion_dt ] .",
    "note that the numerical scheme can be proved to be weakly first order accurate by relying on standard techniques  @xcite , in view of the equality @xmath102    another important result which we will repeatedly use in the analysis below is the following uniform - in-@xmath0 geometric ergodicity of the metropolized euler - maruyama scheme , easily obtained by adapting the results of  @xcite to the case of compact position spaces ( for completeness , we nonetheless provide elements of proof in section  [ sec : proof_lem_geom_ergod ] ) . to state the result ,",
    "we introduce the following functional space @xmath103    [ lem : geom_ergod ] there exists @xmath89 and @xmath25 such that , for any @xmath90 , for all @xmath104 and any @xmath105 , @xmath106 as a consequence , there exists @xmath107 such that @xmath108      we first give error estimates on   by appropriately adapting the results from  @xcite .",
    "the result is stated for two smooth observables @xmath109 with average  0 with respect to  @xmath76 .",
    "define to this end @xmath110 error estimates for   are obtained by setting @xmath111 , with @xmath112 and @xmath113 .",
    "note indeed that a simple integration by parts shows that @xmath114 has average  0 with respect to  @xmath76 , so @xmath115 .",
    "[ thm : gk ] consider two observables @xmath116 , and define the modified observable @xmath117 where the operator  @xmath88 is defined in  .",
    "then , there exists @xmath89 such that , for any @xmath90 , @xmath118   dt = { { \\delta t}}\\sum_{n=0}^{+\\infty } \\mathbb{e}_{{\\delta t}}\\left [ \\widetilde{\\psi}_{{\\delta t}}(q^n)\\ , \\varphi(q^0 ) \\right ] + { { \\delta t}}^{3/2 } r_{\\psi,\\varphi,{{\\delta t}}},\\ ] ] with @xmath119 uniformly bounded ( with respect to  @xmath0 ) , and where the expectation on the left hand side of the above equation is with respect to initial conditions @xmath120 and over all realizations of the dynamics  , while the expectation on the right hand side is with respect to initial conditions @xmath121 and over all realizations of the metropolized euler - maruyama scheme  .    as a corollary ,",
    "we obtain first order error bounds on the computation of the self - diffusion through  : @xmath122 where @xmath123 is uniformly bounded for  @xmath0 sufficiently small , and where the numerically computed self - diffusion reads @xmath124.\\ ] ] the expression of the correction term is obtained by replacing the modified observable by its expression : @xmath125 ,   \\qquad   f = a{\\mathcal{l}}^{-1 } \\nabla v.\\ ] ] the appearance of subleading fractional correction term in   ( here , of order  @xmath95 ) is typical of metropolis algorithms , and is usually not encountered for standard , un - metropolized discretizations of sdes ( compare with the results of  @xcite ) .      in this section , we investigate the discretization error made when using the metropolized euler - maruyama scheme to approximate the self - diffusion using  . in accordance with the definition",
    ", we introduce a discrete additive functional allowing to keep track of the diffuse behavior of the markov chain : starting from @xmath126 , @xmath127 with @xmath128 while the markov chain @xmath129 defined by   remains in  @xmath18 , the additive functional  @xmath130 has values in  @xmath70 .",
    "the diffusion tensor actually computed by the numerical scheme is @xmath131,\\ ] ] where , as in theorem  [ thm : gk ] , the expectation on the right hand side is with respect to initial conditions @xmath132 and for all realizations of the metropolized euler - maruyama scheme .",
    "[ thm : einstein ] there exists @xmath89 such that , for any @xmath90 , @xmath133 where the coefficients of the symmetric matrix @xmath134 are uniformly bounded .",
    "the proof of this result can be read in section  [ sec : einstein ] .",
    "in fact , a slight extension of our technique of proof would allow to show that the diffusively rescaled process generated by the metropolized euler - maruyama scheme , namely @xmath135 ( where @xmath136 denote the unique integer such that @xmath137 ) , weakly converges on finite time intervals to a brownian motion with covariance matrix  @xmath138 .",
    "an immediate corollary of theorem  [ thm : einstein ] is the following a priori error estimate on the self - diffusion : @xmath139 where @xmath140 is uniformly bounded for @xmath0 sufficiently small .",
    "some more work would allow to prove that the subleading correction term is of order  @xmath95 , as in the green - kubo case ( see remark  [ rem : more_work ] ) .",
    "the aim of this section is to illustrate the errors bounds   and  .",
    "we perform long computations so that the statistical errors are negligible .",
    "let us mention that numerical simulations illustrating timestep errors for velocity autocorrelation functions were already presented in  @xcite .",
    "we start by considering a simple one - dimensional example ( @xmath141 ) : a single particle in the unit torus  @xmath142 , with the periodic potential @xmath143 , at @xmath144 .",
    "computations are performed by approximating expectations by realizations over @xmath145 replicas evolving independently , denoted by @xmath146 with @xmath147 and where @xmath148 still is the step index .",
    "initial conditions are prepared incrementally over the replicas .",
    "more precisely , starting from @xmath149 , we obtain the initial condition @xmath150 for the replica number @xmath151 by evolving the initial condition @xmath152 over 10  steps of the metropolized euler - maruyama scheme with step size @xmath153 .",
    "we have checked that the equilibrium distribution is very well reproduced by the empirical measure produced by @xmath154 provided @xmath145 is reasonably large ( say , @xmath155 ) .",
    "the self - diffusion coefficient @xmath156 for the einstein approach is approximated by fitting the unnormalized self - diffusion @xmath157 by a linear function @xmath158 , the slope being the estimation of the self - diffusion for the time step under consideration .",
    "this is indeed confirmed by figure  [ fig : diffusion ] ( left ) , which presents the evolution of @xmath159 as a function of the physical time @xmath160 .",
    "the results produced in figures  [ fig : diffusion ] and  [ fig : error_diffusion ] have been obtained with @xmath161 replicas and @xmath162 steps .",
    "let us also note that , in accordance with  , the rejection rate scales as @xmath95 .",
    "a numerical approximation of   requires both a discretization using finitely many replicas , but also a truncation of the integration in time with an upper bound  @xmath163 .",
    "we consider the following numerical estimation of the self - diffusion coefficient obtained with the green - kubo formula : @xmath164 the correlation functions shown in figure  [ fig : correlation ] suggest that the autocorrelation of @xmath165 is exponentially decreasing .",
    "it can be considered as negligible for times larger than  0.2 .",
    "the numerical results reported in figure  [ fig : correlation ] and  [ fig : error_diffusion ] have been obtained with @xmath166 replicas and a time cut - off @xmath167 .",
    "the results presented in figure  [ fig : error_diffusion ] indeed confirm that , for small time steps  @xmath0 , the error in the self - diffusion is of order  @xmath0 for both methods . for larger time steps ,",
    "nonlinearities appear .",
    "note also that the errors on the coefficients computed with the green - kubo formula are smaller in this simple case . in any case , in accordance with the statements of theorem  [ thm : cv_faible_processus ]",
    ", the self - diffusion is between  0 and  1 when @xmath168 .     left : self - diffusion @xmath159 as a function of the physical time @xmath160 for two values of the time step  @xmath0 .",
    "right : average rejection rate   as a function of the time step  @xmath0 , in a log - log scale . as predicted by  , the rejection rate scales as @xmath95.,title=\"fig:\",width=264 ]   left : self - diffusion @xmath159 as a function of the physical time @xmath160 for two values of the time step  @xmath0 .",
    "right : average rejection rate   as a function of the time step  @xmath0 , in a log - log scale . as predicted by  , the rejection rate scales as @xmath95.,title=\"fig:\",width=264 ]",
    "plot of the approximated correlation functions @xmath169 . left : standard view .",
    "right : logarithmic scale on the ordinates.,title=\"fig:\",width=264 ]   plot of the approximated correlation functions @xmath169 . left : standard view .",
    "right : logarithmic scale on the ordinates.,title=\"fig:\",width=264 ]     diffusion constant as a function of the time step @xmath0 for the one - dimensional potential @xmath143 at @xmath144 , with a zoom on the smaller time steps on the right picture .",
    "affine fits @xmath170 consistent with   and   are in both cases represented by solid lines.,title=\"fig:\",width=264 ]   diffusion constant as a function of the time step @xmath0 for the one - dimensional potential @xmath143 at @xmath144 , with a zoom on the smaller time steps on the right picture .",
    "affine fits @xmath170 consistent with   and   are in both cases represented by solid lines.,title=\"fig:\",width=264 ]      we consider in this section a more physically realistic system : a large , fixed ion interacting with smaller particles , typically smaller ions .",
    "the @xmath2 smaller particles evolve in a three - dimensional cubic simulation box of length  @xmath171 with periodic boundary conditions .",
    "the smaller particles have the same mass  @xmath172 , and their positions are denoted by @xmath173 .",
    "the potential energy functions are inspired by standard choices in the modeling of ionic solutions  @xcite .",
    "the interaction between small particles is governed by an appropriately truncated lennard - jones potential : @xmath174 and @xmath175 for @xmath176 .",
    "the parameter @xmath177 is some reference energy , while @xmath178 is some reference distance .",
    "the parameters @xmath179 and @xmath180 ensure that @xmath181 is a @xmath182 function .",
    "when @xmath183 , the minimal energy of @xmath181 converges to  @xmath184 , a value obtained at a distance @xmath185 .",
    "we additionally consider a large ion , modeled as a fixed particle at position @xmath186 ( the center of the simulation box ) , whose interaction with the solvent particles is described by an attractive yukawa potential ( screened coulomb interaction ) plus some repulsive potential preventing the small particles from coming too close to the ion .",
    "more precisely , for a solvent particle at position  @xmath187 , the interaction reads @xmath188 , with @xmath189 and @xmath190 for @xmath191 .",
    "the parameters @xmath192 and @xmath193 ensure as above that @xmath194 is  @xmath182 .",
    "the energy @xmath195 is the minimal value of the potential , obtained when @xmath196 ( in the limit when @xmath197 and @xmath198 ) while @xmath199 is some inverse length .",
    "the total potential energy of the @xmath2 small particles finally reads @xmath200 the potentials  @xmath181 and  @xmath194 are plotted in figure  [ fig : potential_lj ] .",
    "plot of the particle - particle interaction  @xmath181 ( red ) , and of the ion - particle interaction  @xmath194 ( blue).,width=264 ]    the results of this section are expressed in the reduced units obtained from the lennard - jones energy  @xmath201 , the lennard - jones distance  @xmath202 and the mass  @xmath172 .",
    "in particular , the reference time is @xmath203 .",
    "simulations were performed using the following parameters : @xmath204 , solvent density @xmath205 , @xmath206 , @xmath207 , inverse temperature @xmath144 , and @xmath208 . for this choice of parameters , we have observed that the simulations blow up for time - steps @xmath0 of the order of  @xmath209 when using the euler - maruyama ( un - metropolized ) scheme  ; whereas the metropolized euler scheme   allows for much larger time steps .",
    "expectations are approximated using @xmath145 trajectories of the system .",
    "we integrate trajectories one after the other , using the metropolized euler scheme  , with initial conditions for the @xmath210th trajectory obtained by taking the last configuration of the @xmath172th trajectory . the self - diffusion coefficient calculated with the green - kubo formula",
    "is obtained as in the previous section , using the estimator   ( upon introducing the correct normalization factor @xmath211 in the autocorrelation and replacing @xmath165 by @xmath212 ) .",
    "the values obtained by the einstein formula are computed by dividing the unnormalized diffusion @xmath159 defined in   by the final time of the simulation : for a simulation time  @xmath163 , @xmath213 the results presented in figure [ fig : diffusion_lj ] show that the unnormalized mean squared displacement indeed grows linearly in time , as expected . note also that , in accordance with  , the rejection rate scales as @xmath95 .",
    "the results of figure [ fig : diffusion_lj ] and have been obtained with @xmath214 trajectories , with integrations performed up to @xmath215 .",
    "the results presented in figure  [ fig : correlation_lj ] suggest that the decay of the force autocorrelation can not be represented by a single exponential function .",
    "the force autocorrelation can be considered to be small in relative value for times of the order of  @xmath216 .",
    "the numerical results reported in figure  [ fig : correlation_lj ] and  [ fig : error_diffusion_lj ] were obtained by averaging @xmath217 trajectories with an integration time  @xmath218 .",
    "error estimates for the diffusion coefficients are gathered in figure  [ fig : error_diffusion_lj ] . for small time steps @xmath219 , the error in the self - diffusion is linear in  @xmath219 , while nonlinearities appear for larger time steps .",
    "the continuous lines are linear fits obtained over the values corresponding to the 10 smallest time steps . as in the simple example discussed in the previous section , estimates obtained with green - kubo s formula seem more reliable than those obtained with einstein s formula .",
    "note also that , in accordance with theorem [ thm : cv_faible_processus ] , the self - diffusion is between 0 and 1 in all cases for sufficiently small time - steps .",
    "left : self - diffusion @xmath159 as a function of the physical time @xmath160 for two values of the time step  @xmath0 .",
    "right : average rejection as a function of the time step  @xmath0 , in a log - log scale .",
    "as predicted by  , the rejection rate scales as @xmath95.,title=\"fig:\",width=264 ]   left : self - diffusion @xmath159 as a function of the physical time @xmath160 for two values of the time step  @xmath0 .",
    "right : average rejection as a function of the time step  @xmath0 , in a log - log scale .",
    "as predicted by  , the rejection rate scales as @xmath95.,title=\"fig:\",width=264 ]     plot of the approximated correlation functions @xmath220 . left : standard view .",
    "right : logarithmic scale on the ordinates.,title=\"fig:\",width=264 ]   plot of the approximated correlation functions @xmath220 . left : standard view .",
    "right : logarithmic scale on the ordinates.,title=\"fig:\",width=264 ]     diffusion constant as a function of the time step @xmath0 for the solvated ion system at @xmath144 , with a zoom on the smaller time steps on the right picture .",
    "affine fits @xmath170 consistent with   and   are in both cases represented by solid lines.,title=\"fig:\",width=264 ]    diffusion constant as a function of the time step @xmath0 for the solvated ion system at @xmath144 , with a zoom on the smaller time steps on the right picture .",
    "affine fits @xmath170 consistent with   and   are in both cases represented by solid lines.,title=\"fig:\",width=264 ]",
    "both the green - kubo and the einstein approaches lead to discretization errors of order  @xmath0 , as proved theoretically and verified numerically . a natural question is how to reduce this error . in the chemistry literature ,",
    "it was proposed in  @xcite to renormalize the time in einstein s method by replacing the simulation time  @xmath160 appearing in the denominator of   by some effective time @xmath221 , where @xmath222 is the average acceptance rate of the metropolis algorithm for a given time step  @xmath0 . however , since the average acceptance rate is of order @xmath223 for small time steps ( see  ) , such a correction can not possibly cancel out the @xmath0-error in the diffusion coefficient .",
    "a more promising work track , which we started working on at the end of our stay at cirm , is to modify the proposed move ( instead of simply considering the euler - maruyama scheme  ) , and possibly the invariant measure as well , in order to increase the weak and strong orders of the associated metropolized scheme .",
    "some steps in this direction have already been pursued in  @xcite .",
    "in fact , the proofs of theorem  [ thm : gk ] and  [ thm : einstein ] show that , in order to gain accuracy on the computation of transport coefficients , it is sufficient to find a numerical scheme such that @xmath224 a key element to obtain such equalities is to decrease the rejection rate for small time steps .",
    "in all the proofs , the constants @xmath225 and the critical time steps @xmath226 may change from line to line . upon changing  @xmath19 into  @xmath227 , we may also assume that @xmath144 .",
    "the idea is to rewrite the part of the additive functional involving @xmath228 as an approximate martingale . to this end",
    ", we introduce the solutions @xmath229 of the following poisson equations @xmath230 in view of the resolvent estimate  , the functions @xmath231 are well defined elements of @xmath40 since @xmath232 in addition , by elliptic regularity , the functions @xmath231 are smooth . by ito",
    "s lemma , we therefore obtain @xmath233 so that the integrated displacement from the origin can be rewritten as @xmath234 since @xmath235 is bounded , @xmath236 uniformly vanishes as @xmath237 goes to infinity .",
    "the long time behavior of the process @xmath238 ( for a given direction @xmath239 is therefore determined by the martingale @xmath240 whose quadratic variation is @xmath241 the ergodic properties of the diffusion process  @xmath45 allow to prove that @xmath242\\left(f^t \\phi_0\\right )   \\ , d\\mu \\nonumber\\\\ & = 2 \\int_{\\mathcal{m}}|f|^2 -   \\left ( f^t \\phi_0\\right ) \\left(f^t \\nabla",
    "v\\right ) \\ , d\\mu   = 2f^t \\left ( { \\mathrm{id}}+ \\int_{\\mathcal{m}}{\\mathcal{l}}^{-1 } \\left(\\nabla v\\right ) \\otimes \\nabla v \\ , d\\mu\\right)f \\label{eq : covariance}\\end{aligned}\\ ] ]",
    "where , to pass from the first to the second line , we have used an integration by parts to transform the second term in the integral and   for the third one , while the two last equalities follow from the definition of  @xmath235 . at this stage , we note that @xmath243 implies that the integrand of the first equality vanishes almost everywhere , which , by a cauchy - schwarz inequality , in turn implies that @xmath244 is proportional to  @xmath245 .",
    "this is however impossible since @xmath245 is not the gradient of a periodic function , and we therefore conclude that @xmath58 is positive definite . in addition , the last expression shows that @xmath246 since @xmath247 is a positive operator ( replace @xmath248 by @xmath249 in  ) .",
    "since @xmath250 has a positive spectral gap on @xmath31 ( see  ) , we can write the following operator equality on  @xmath40  : @xmath251 therefore , for general functions @xmath109 with vanishing average with respect to  @xmath76 , @xmath252dt = \\int_{\\mathcal{m}}\\left(-\\mathcal{l}^{-1}\\psi\\right)\\varphi \\ , d\\mu.\\ ] ] combining this result with   leads to the expression   of the diffusion matrix  @xmath58 . to prove the convergence of the processes",
    ", two arguments should be made precise ( see  @xcite for an elementary account ) :    a.   the convergence of the finite - dimensional laws , which can be obtained very simply here by considering the exponential martingales @xmath253,\\ ] ] which are such that the conditional expectations converge to those of a brownian motion as @xmath254 : @xmath255 \\right| \\ , \\mathcal{f}_{s/{\\varepsilon}^2 } \\right ) = \\exp\\left(-\\frac{\\theta^2}{2 } ( t - s)f^t\\mathscr{d}f\\right),\\ ] ] @xmath256 denoting the filtration of events until the time @xmath257 .",
    "finite - dimensional laws are then obtained by a simple induction , as made precise in  @xcite for instance .",
    "b.   the tightness of the process , proved using prohorov s criterion ( see for instance  @xcite ) : @xmath258 this criterion is satisfied in view of the tightness of the martingale @xmath259 , itself easily obtained using doob s inequality ( see  @xcite ) .",
    "we first determine the magnitude of the acceptance probability in the metropolis algorithm , which reads @xmath260 with @xmath261 \\\\ & = v(q ' ) - v(q ) - \\frac12 \\left\\langle q'-q,\\nabla v(q')+\\nabla v(q)\\right\\rangle + \\frac{{{\\delta t}}}{4}\\left ( |\\nabla v(q')|^2 - |\\nabla v(q)|^2 \\right ) .",
    "\\end{aligned}\\ ] ] using the following expansions ( with integral remainders ) @xmath262 ( q'-q ) + \\frac16 d^3 v(q)\\big((q'-q)^{\\otimes 3}\\big ) \\nonumber \\\\ & \\ \\ \\ + \\frac16 \\int_0 ^ 1 ( 1-t)^3 d^4 v\\big((1-t)q+tq'\\big)\\big((q'-q)^{\\otimes 4}\\big ) \\ , dt , \\label{eq : taylor_3 } \\\\",
    "\\nabla v(q ' ) & = \\nabla v(q ) + \\nabla^2 v(q ) ( q'-q ) + \\frac12 d^3 v(q)\\big((q'-q)^{\\otimes 2}\\big ) \\nonumber \\\\ & \\ \\ \\ + \\frac12 \\int_0 ^ 1 ( 1-t)^2 d^3 v\\big((1-t)q+tq'\\big)\\big((q'-q)^{\\otimes 3}\\big ) \\ , dt , \\nonumber\\end{aligned}\\ ] ] a simple computation shows that @xmath263 where @xmath264 while there exists a constant @xmath225 such that @xmath265 for any @xmath266 .",
    "we next use the inequality @xmath267 obtained by distinguishing the cases @xmath268 and @xmath269 .",
    "this shows that @xmath270 with @xmath271 and where @xmath272 .",
    "the estimate on the average acceptance rate   is obtained by taking the expectation over all possible realizations of  @xmath273 , with the definition @xmath274    to obtain the action of the operator  @xmath88 , we start from the expression of the metropolis transition operator ( see for instance  ( * ? ? ?",
    "* section  2.1.2 ) ) @xmath275 which can be reformulated as @xmath276 we now write @xmath277 , so that , using   to estimate the rejection rate , @xmath278 \\big ( \\psi\\left(q- { { \\delta t}}\\ , \\nabla v(q ) + \\sqrt{2{{\\delta t } } } \\ , g\\right ) - \\psi(q ) \\big)\\ , \\frac{{\\mathrm{e}}^{-g^2/2}}{(2\\pi)^{dn/2 } } \\ , dg \\\\ & = { { \\delta t}}\\ , ( { \\mathcal{l}}\\psi)(q ) + \\frac{{{\\delta t}}^2}{2 } \\left(\\left[{\\mathcal{l}}^2 + d_1 + d_2 \\right]\\psi\\right)(q ) + { { \\delta t}}^{5/2 } r_{\\psi,{{\\delta t } } } , \\end{aligned}\\ ] ] where we have used for the first integral a taylor expansion at fourth order similar to   to obtain ( see the computations in  ( * ? ? ? * section  4.9 ) ) @xmath279 and a taylor expansion at first order for the term involving the rejection rate to obtain @xmath280 the remainder @xmath93 is uniformly bounded in @xmath281 for @xmath0 sufficiently small .",
    "the conclusion follows by setting @xmath282 .",
    "the proof below is a simplification of the argument presented in  @xcite , made possible since we work on a compact state space .",
    "the idea of the proof is to compare the metropolis dynamics to the continuous dynamics , using the standard , un - metropolized euler - maruyama scheme as an intermediate .",
    "alternatively , it would be possible to directly compare the metropolized and un - metropolized schemes , by proving as in  ( * ? ? ? * section  4.2 ) that the standard , un - metropolized euler - maruyama scheme is geometrically ergodic since it satisfies a minorization condition .    to prove the first part of the lemma ,",
    "it is enough to show that there exists @xmath284 such that , for any @xmath90 and any @xmath285 , @xmath286 since we work on a compact state space , it is enough to show by harris theorem ( see the presentation in  @xcite ) that there exist @xmath287 such that @xmath288 uniformly in @xmath90 and @xmath289 .",
    "we now introduce the transition kernel @xmath49 of the continuous dynamics  , defined as @xmath290 and consider it at time @xmath291 .",
    "the transition kernel is well defined and regular since the generator is elliptic . by the triangle inequality ,",
    "@xmath292 from  ( * ? ? ?",
    "* lemma 2.7 ) , since we work on a compact space , we know that there exists @xmath53 such that @xmath293 to control the second term in  , we introduce the transition kernel of the standard , un - metropolized euler - maruyama scheme  , denoted by @xmath294 , and write @xmath295 by  ( * ? ? ? * lemma  4.2 ) , the transition kernel of the standard , un - metropolized dynamics is uniformly close to the transition kernel of the continuous dynamics when the state space is compact : there exists @xmath296 and @xmath297 such that , for any @xmath90 , @xmath298    it therefore remains to control the distance between the transition rate of the metropolized and un - metropolized dynamics .",
    "it is at this stage that the argument of  ( * ? ? ?",
    "* lemma  4.6 ) can be simplified . as in the proof of this lemma",
    ", we use a coupling argument , and consider two chains @xmath299 and @xmath300 , corresponding respectively to the metropolized dynamics and the standard un - metropolized one , starting from the same initial condition @xmath301 . the probability that @xmath302 is bounded from above by the probability that @xmath303 for some @xmath304 , _",
    "i.e. _ at least one rejection occurred along the discrete trajectory . since the probability to reject the move from  @xmath299 to  @xmath305 is @xmath306 , it holds @xmath307 { \\leqslant}2 \\sum_{i=1}^n \\mathbb{e}\\left [ \\left .",
    "\\left ( 1-r_{{\\delta t}}(q^i , q^{i+1 } ) \\right ) \\ , \\right| \\ , q^0 = q \\right].\\ ] ] in view of  , there exists @xmath308 such that @xmath309 { \\leqslant}c_{\\rm reject } { { \\delta t}}^{3/2}$ ] for @xmath0 sufficiently small . the sum from @xmath310 to @xmath311",
    "may then be estimated as @xmath312 the combination of all previous estimates finally gives   provided  @xmath0 is sufficiently small .",
    "for the second part of the lemma , we note that the bounds on the powers of @xmath84 imply that the sum @xmath313 is absolutely convergent in @xmath314 , and it is then easily checked that @xmath315 , considered as an operator on  @xmath316 , is invertible and that @xmath317 in fact , @xmath318 from which the bound   immediately follows .",
    "we follow the strategy of  ( * ? ? ?",
    "* section  4.8 ) .",
    "the proof starts by noticing that the integrated correlation function can be written using @xmath39 , as made precise in  .",
    "the strategy of the proof is to write an approximation of @xmath39 using the discrete evolution operator  @xmath84 .    in view of   and  , and since @xmath319 is stable under @xmath39 , it holds @xmath320 since @xmath321 still is a smooth function ( by elliptic regularity ) , the remainder @xmath322 is uniformly bounded by lemma  [ lem : expansion_pdt ] .",
    "note also that since @xmath323 and @xmath324 have vanishing averages with respect to  @xmath76 , the remainder @xmath322 has a vanishing average with respect to  @xmath76 .",
    "the above equality shows that @xmath325 \\varphi \\ , d\\mu,\\ ] ] where the sum is convergent in view of  . in conclusion , @xmath326 \\varphi \\ , d\\mu,\\ ] ] which gives the result , in view of the boundedness of the operator @xmath327 on @xmath316 ( given by lemma  [ lem : geom_ergod ] ) .",
    "we start by highlighting the martingale part of the increments @xmath328 , similarly to the continuous case ( compare  )  : @xmath329 where the expectation on the right - hand side is over the gaussian random variable  @xmath101 and the uniform variable  @xmath330 ( the configuration  @xmath65 being fixed )",
    ". it will be useful to decompose the increment as @xmath331 with @xmath332 in view of lemma  [ lem : expansion_delta ] ( which shows in particular that @xmath333 can be thought of as being of order  @xmath334 by setting @xmath335 in  ) , the first term on the right - hand side of   is equal to @xmath336 at dominant order in  @xmath0 .",
    "this term therefore corresponds to the term @xmath337 in the decomposition  .",
    "the second term in the right - hand side of   is handled by introducing an appropriate poisson equation ( see   below ) , which is the discrete analogue of  .",
    "[ lem : expansion_delta ] the average increment has the following expansion in powers of  @xmath0 : @xmath338 = -{{\\delta t}}\\nabla v(q ) - \\sqrt{2 } \\ , { { \\delta t}}^{2 } \\ , \\mathbb{e}_{g}\\left [ \\xi_+(q , g ) g \\right ] + { { \\delta t}}^{5/2 } r_{\\delta,{{\\delta t}}},\\ ] ] where @xmath339 is uniformly bounded for  @xmath0 sufficiently small . in addition , there exists a constant @xmath107 such that @xmath340 and , for any @xmath341 , @xmath342    [ lem : expansion_phi_dt ] there exists , for any @xmath1 , a unique function @xmath343 such that @xmath344.\\ ] ] moreover , recalling the definition   of  @xmath235 , @xmath345 where @xmath346 is uniformly bounded for  @xmath0 sufficiently small , and @xmath347 is the unique solution of the poisson equation @xmath348 , \\qquad \\int_{\\mathcal{m}}\\widetilde{\\phi}^1 \\ , d\\mu = 0.\\ ] ]    in view of these results , @xmath349 with , upon rewriting @xmath350 as @xmath351 $ ] , @xmath352\\big ) .",
    "\\end{aligned}\\ ] ] the interest of this rewriting is to highlight the fact that @xmath353 can be fully understood in terms of the increments  @xmath354 ( in order to use lemma  [ lem : cross_correlation ] below ) .",
    "note that @xmath355 are stationary , independent martingale increments when @xmath356 ( since in this case @xmath357 for all @xmath358 ) .",
    "this shows that @xmath359 since @xmath360 is uniformly bounded as @xmath168 , we obtain @xmath361 we now expand @xmath362 in powers of  @xmath0 . by lemma  [ lem : expansion_phi_dt ] , it is possible to replace the function @xmath360 in the second term on the right - hand side of   by @xmath363 , up to a remainder of order  @xmath95 .",
    "we next use the following lemma to compute the cross correlation between the various functions of  @xmath0 appearing in @xmath364 .",
    "[ lem : cross_correlation ] for any smooth functions @xmath365 , growing at most polynomially , @xmath366",
    "= 2 \\nabla f(0)^t \\nabla g(0 ) + { { \\delta t}}\\,r_{f , g,{{\\delta t}}},\\ ] ] with @xmath367 $ ] , and where the remainder @xmath368 is uniformly bounded for  @xmath0 sufficiently small .",
    "the conclusion then follows by applying this result with the functions @xmath365 replaced by @xmath369 , @xmath370 and @xmath371 for a given test direction  @xmath245 .",
    "indeed , @xmath372 with @xmath373 uniformly bounded as @xmath168 .",
    "manipulations similar to the ones leading to   finally give the claimed result .",
    "[ rem : more_work ] in order to characterize the leading order term in the error and prove that the subleading order term indeed is of order  @xmath95 , it would be necessary to compute correlation terms involving components of the remainder term  @xmath346 .",
    "this is not possible as such because the regularity of  @xmath346 is not established , and obtaining regularity result from   is difficult .",
    "an expansion of @xmath360 up to @xmath334 terms ( as @xmath374 ) is therefore needed in order not have to treat correlations involving the remainder  @xmath346 .",
    "this , in turn , would require an expansion of  @xmath84 up to remainders of order  @xmath375 , instead of  @xmath376 as in  .",
    "although this does not pose any problem in principle , we chose not to follow this path in order to keep the arguments as simple as possible .",
    "we first write an expansion of @xmath377 in fractional powers of  @xmath0 : @xmath378",
    "+ { { \\delta t}}\\ , \\nabla v(q ) & = \\mathbb{e}_{g , u}\\left[\\delta_{{\\delta t}}\\left(q , g , u\\right ) +",
    "{ { \\delta t}}\\ , \\nabla v(q ) -\\sqrt{2{{\\delta t } } } \\ , g\\right]\\\\ & = \\mathbb{e}_{g , u } \\left [ \\left ( { \\mathbf{1}}_{u { \\leqslant}r_{{\\delta t}}\\left(q , q-{{\\delta t}}\\ , \\nabla v(q ) + \\sqrt{2{{\\delta t } } } \\ , g\\right ) } -1\\right)\\left(-{{\\delta t}}\\ , \\nabla v(q ) + \\sqrt{2{{\\delta t } } } \\ , g\\right ) \\right ] \\\\ & = \\mathbb{e}_{g } \\left [ \\left ( r_{{\\delta t}}\\left(q , q-{{\\delta t}}\\ , \\nabla v(q ) + \\sqrt{2{{\\delta t } } } \\ , g\\right ) -1\\right)\\left(-{{\\delta t}}\\ , \\nabla v(q ) + \\sqrt{2{{\\delta t } } } \\ , g\\right ) \\right ] .",
    "\\end{aligned}\\ ] ] in view of  , it holds @xmath379 + { { \\delta t}}\\ , \\nabla v(q ) = -\\sqrt{2 } { { \\delta t}}^2 \\ , \\mathbb{e}_{g}\\left [ \\xi_+(q , g ) g \\right ] + { { \\delta t}}^{5/2 } r_{\\delta,{{\\delta t}}}$ ] , which gives  .",
    "we introduce the normalized average increment , defined as the following periodic function  : @xmath382}{{{\\delta t}}}.\\ ] ] lemma  [ lem : geom_ergod ] shows that @xmath360 is well defined provided the periodic function @xmath383 has a vanishing average with respect to  @xmath76 . to prove this statement",
    ", we start from @xmath384 = \\int_{{\\mathbb{r}}^{dn } } r_{{\\delta t}}(q , q')t_{{\\delta t}}(q , q')(q'-q ) \\ , dq'.\\ ] ] it is easily seen that @xmath385 \\ , \\mu(dq ) = \\int_{\\mathcal{m}}\\int_{{\\mathbb{r}}^{dn } } r_{{\\delta t}}(q , q')t_{{\\delta t}}(q , q')(q'-q ) \\ , dq ' \\ , \\mu(dq ) \\\\ & \\qquad = \\sum_{n \\in \\mathbb{z}^{dn } } \\int_{\\mathcal{m}}\\int_{\\mathcal{m}}r_{{\\delta t}}(q , q'+nl)t_{{\\delta t}}(q , q'+nl)(q'-q+nl ) \\ , dq ' \\ , \\mu(dq ) = \\sum_{n \\in \\mathbb{z}^{dn } } i_n , \\end{aligned}\\ ] ] with @xmath386 since @xmath187 and @xmath387 play symmetric roles , @xmath388 vanishes . for @xmath358 ,",
    "we obtain , by first exchanging the names of the dummy variables @xmath187 and @xmath387 and then using @xmath389 as well as the invariance of @xmath76 by translations of the periodic cell , @xmath390 therefore , @xmath391 , which allows to conclude that @xmath392    to obtain an expansion of @xmath360 in terms of fractional powers of  @xmath0 , we rely on  , which implies that @xmath393 + { { \\delta t}}^{3/2 } r_{\\delta,{{\\delta t}}}.\\ ] ] the function @xmath347 introduced in   is indeed well defined since @xmath394 has a vanishing average with respect to  @xmath76 for any smooth function  @xmath395 ( see  ) , while the condition  , together with the expansion  , shows that the average of @xmath396 $ ] with respect to  @xmath76 also vanishes . now , consider the following difference , relying on the expansion   and the definition of  @xmath235  : @xmath397 + { \\mathcal{l}}\\widetilde{\\phi}^1 \\right ) + { { \\delta t}}^{3/2 } \\ , \\widetilde{r}_{{\\delta t}}. \\end{aligned}\\ ] ] the first term on the right - hand side of the last equality vanishes by definition of @xmath347 .",
    "the remainder @xmath398 has a vanishing average with respect to  @xmath76 since it belongs to @xmath399 .",
    "lemma  [ lem : geom_ergod ] then shows that there exists a constant @xmath225 and @xmath89 such that , for any @xmath90 , @xmath400 this gives the result upon defining @xmath401 .",
    "a taylor expansion with integral remainder gives @xmath402 a simple computation using   and   shows that @xmath403 where @xmath404 is uniformly bounded for @xmath0 sufficiently small . therefore , @xmath405 a simple computation finally shows that @xmath366   = 2 \\ , \\mathbb{e}_{g}\\left[\\left ( \\nabla f(0)^t g \\right)\\left(\\nabla g(0)^t g\\right)\\right ] + { { \\delta t}}\\ , r_{f , g,{{\\delta t}}},\\ ] ] where the remainder @xmath368 is uniformly bounded .",
    "m.  hairer and j.  c. mattingly .",
    "yet another look at harris ergodic theorem for markov chains . in _",
    "seminar on stochastic analysis , random fields and applications vi _ , volume  63 of _ progr .",
    "_ , pages 109117 .",
    "birkhuser / springer , 2011 ."
  ],
  "abstract_text": [
    "<S> we consider in this work the numerical computation of transport coefficients for brownian dynamics . </S>",
    "<S> we investigate the discretization error arising when simulating the dynamics with the smart mc algorithm ( also known as metropolis - adjusted langevin algorithm ) . </S>",
    "<S> we prove that the error is of order one in the time step as @xmath0 goes to zero , when using either the green - kubo or the einstein formula to estimate the transport coefficients . </S>",
    "<S> we illustrate our results with numerical simulations .            </S>",
    "<S> nous nous intressons dans cet article au calcul numrique des coefficients de transports pour des dynamiques browniennes . </S>",
    "<S> nous tudions lerreur de discrtisation qui apparait lorsquon simule la dynamique avec lalgorithme connu sous le nom de `` smart mc '' dans la littrature . </S>",
    "<S> nous prouvons que cette erreur est dordre un en le pas de temps lorsque @xmath0 tend vers zro , lorsquon utilise la formule de green - kubo ou la formule deinstein pour estimer les coefficients de transport . </S>",
    "<S> nous illustrons ces rsultats avec des simulations numriques .    </S>",
    "<S> molecular simulation is nowadays a very common tool to quantitatively predict macroscopic properties of matter starting from a microscopic description . </S>",
    "<S> these macroscopic properties can be either static properties ( such as the average pressure or energy in a system at fixed temperature and density ) , or transport properties ( such as thermal conductivity or shear viscosity ) . molecular simulation can be seen as the computational version of statistical physics , and is therefore often used by practitioners of the field as a black box to extract the desired macroscopic properties from some model of interparticle interactions . </S>",
    "<S> most of the work in the physics and chemistry fields therefore focuses on improving the microscopic description , most notably developing force fields of increasing complexity . in comparison , less attention has been paid to the estimation of errors in the quantities actually computed by numerical simulation . usually , due to the very high dimensionality of the systems under consideration , macroscopic properties are computed as ergodic averages over a very long trajectory of the system , evolved under some appropriate dynamics . </S>",
    "<S> there are two main types of errors in this approach : ( i ) statistical errors arising from incomplete sampling , and ( ii ) systematic errors ( bias ) arising from the fact that continuous dynamics are numerically integrated using a finite time - step  @xmath1 .    the aim of this work is to understand the bias arising from the use of finite time steps in the computation of transport coefficients . </S>",
    "<S> we consider the case of the self - diffusion , for a certain type of dynamics called brownian dynamics in the chemistry literature , discretized using the so - called `` smart mc '' algorithm  @xcite ( this algorithm was also rediscovered later on in the computational statistics literature  @xcite ) . </S>",
    "<S> the previous works on the numerical analysis of this dynamics established ( i )  strong error estimates over finite times  @xcite , and , as a consequence , errors on finite time correlations  @xcite ; ( ii )  exponential convergence rates towards the invariant measure , uniformly in the timestep  @xcite ( which holds up to a small error term in @xmath0 for systems in infinite volume ) .    </S>",
    "<S> this proceedings is organized as follows . </S>",
    "<S> we start by describing in section  [ sec : model ] the brownian dynamics and its discretization , and define the self - diffusion . </S>",
    "<S> we then provide in section  [ sec : a_priori ] a priori error estimates for the numerical estimation of the self - diffusion , through two different routes . numerical simulations illustrate our error bounds in section  [ sec : numerics ] . </S>",
    "<S> we conclude in section  [ sec : tracks ] with some tracks to reduce the numerical error by appropriately modifying the numerical scheme . </S>",
    "<S> the proofs of our results are gathered in section  [ sec : proofs ] . </S>"
  ]
}