{
  "article_text": [
    "the dynamics of a chemical reaction network is ruled by the underlying thermal fluctuations through the arrhenius law that relates the rates of reactions to the activation energies and the strength of noise ( the temperature ) .",
    "when non - equilibrium steady states ( ness ) are reached , the net flow of reactions is constrained to proceed downhill in the free energy landscape @xcite .",
    "many aspects involved in the analysis of biochemical networks ( like the cellular metabolism of living organisms ) at stationarity hinge on the explicit inclusion of thermodynamic constraints into the network model ; among them , the assignment of reaction directions ( and in turn the calculation of feasible flux configurations ) , the assessment of metabolite producibility , the prediction of metabolite concentrations and the estimation of chemical potentials .",
    "steady - state schemes used to predict flux values are mostly based on mass - balance constraints only , and the way in which thermodynamics is included could significantly impact their results . for flux - balance - analysis ( fba )",
    "@xcite , where mass - balanced flux configurations are collapsed into a single optimal solution that maximizes a pre - determined objective function @xcite , the removal of thermodynamic inconsistencies by additional energetic constraints has been proven to be useful to estimate concentrations and reaction affinities besides fluxes @xcite . in absence of clear optimization criteria or ,",
    "more generally , to retrieve global information on the feasible network states allowed in given extracellular and intracellular conditions ( e.g. physiologic ranges of variability ) , it is instead important to characterize the space of flux configurations compatible with mass- and energy - balance constraints in a statistically robust way , as allowed e.g. by monte carlo ( for small networks @xcite ) or message - passing ( for larger networks @xcite ) methods for mass - balance equations .",
    "here we propose a scalable technique to obtain refined information on the _ distribution _ of fluxes , chemical potentials and intracellular concentrations for non - equilibrium steady states , as well as predictions for correlations and reaction directions .",
    "the method is based on perceptron learning , extends the sampling procedure used in @xcite to explore the space of flux states compatible with minimal stability constraints _  la von neumann _ @xcite and uses the stoichiometric matrix and the experimentally determined potentials in standard conditions of a set of metabolites as its basic input .",
    "in essence , it generates feasible configurations of fluxes and concentrations by exploiting the input information and a suitably chosen update dynamics to build - up _ correlations _ between chemical potentials and fluxes .",
    "we apply it to the control case of the model of the human red cell ( hrbc ) metabolism reconstructed in @xcite , for which we derive and analyze the viable state space and the emerging correlations .",
    "this ultimately allows to characterize the cell as a chemical engine .",
    "in particular , we shall appraise its chemical energy balance in the standard terms of entropy production , work done and thermodynamic efficiency .",
    "a metabolic reaction network is defined by a matrix @xmath0 encoding the stoichiometric coefficients @xmath1 of the compounds",
    "@xmath2 in the reaction @xmath3 . conventionally , positive ( resp .",
    "negative ) stoichiometric indices characterize the products ( resp .",
    "substrates ) of the forward reaction . intakes ( resp .",
    "outtakes ) are characterized as having only positive ( resp .",
    "negative ) stoichiometry .",
    "neglecting molecular noise and dilution due to expanding cell volume , the concentration @xmath4 of metabolite @xmath5 evolves according to @xmath6 where @xmath7 is the net flux of reaction @xmath8 , which depends in principle on the concentration vector @xmath9 , on a vector of reaction constants @xmath10 , as well as on other factors like enzyme availability and kinetics , transport details , etc .",
    "the usual working hypothesis is to assume stationarity : in this case the flux vector @xmath11 satisfies the @xmath12 linear mass - balance equations ( mbe ) @xmath13 bounds of the type @xmath14 are also usually specified .",
    "these include both physical considerations , like an assignment of reversibility by thermodynamic arguments , and functional aspects , e.g. the fact that a certain reaction should operate above a given flux threshold in order to provide a physiological function .",
    "cellular metabolic networks usually have @xmath15 so that the system ( [ mb ] ) is underdetermined , leading to a solution space of dimension @xmath16 .",
    "uniform sampling is computationally affordable only for small enough @xmath17 ( a few tens ) , e.g. via monte carlo methods @xcite .",
    "however if the interest is focused on finding flux configurations that are optimal with respect to specific biological functionalities ( e.g. biomass production ) , the solutions of ( [ mb ] ) can be further constrained to maximize an objective function .",
    "this is the standard framework of fba , as implemented with considerable success to describe for example optimal bacterial growth in wild type and knock - out conditions @xcite .    in a different approach",
    "one leaves the solution space functionally unconstrained while studying the metabolite production profiles compatible with a given extracellular medium . for any choice of the environment ( i.e. of the intakes ,",
    "the outtakes being left unspecified ) , a metabolite @xmath5 is producible if there exists a flux vector @xmath11 such that @xmath18 @xcite .",
    "feasible production profiles are then described by the solutions of @xmath19 the resulting vector @xmath20 encodes the information on whether each metabolite is producible ( @xmath21 ) or not ( @xmath22 ) in a given feasible flux state .",
    "producible metabolites might either be employed in other macromolecular processes or become cellular outtakes , so that `` objective functions '' can in this way emerge as statistically robust production profiles @xcite .",
    "[ vn ] is von neumann s flux stability constraint ( vnc ) for production networks @xcite and simply states that for each chemical species at stationarity the overall consumption can not exceed the total supply .",
    "the inequality that distinguishes ( [ vn ] ) from ( [ mb ] ) allows for the efficient sampling of its solution space even for genome - scale networks of the size of e. coli , where @xmath17 is of the order of a few hundreds @xcite .    going beyond the flux problem",
    ", the second law of thermodynamics dictates that in a ness the reaction directions @xmath23 must be related to the chemical driving forces ( affinities ) @xmath24 by @xmath25 where the equality only holds if @xmath8 is in equilibrium .",
    "the free energy changes @xmath24 can be written in terms of the chemical potentials @xmath26 ( the gibbs free energy per mole of the species @xmath5 ) as @xmath27 the existence of non - trivial states of chemical equilibrium ( trivial states are the ones with @xmath28 for each @xmath5 ) implies @xmath29 .",
    "the thermodynamic constraints ( [ tc ] ) are usually implemented a priori , by pre - assigning reaction reversibilities based on the estimation of chemical potentials in physiologic conditions @xcite . in other words , the flux of a reaction classified as irreversible in the forward direction should be sampled under the condition of being non - negative . in cases of mis - assignments ,",
    "the flux problem can lead to inconsistent configurations @xcite .",
    "note that , in absence of prescribed flux bounds , given a vector @xmath30 ( @xmath3 ) such that @xmath31 where the sum extends over all reactions ( set @xmath32 ) excluding uptakes ( set @xmath33 ) , for each solution @xmath34 of the flux problem ( [ mb ] ) or ( [ vn ] ) , the vector defined as @xmath35 is again a solution for any @xmath36 .",
    "in essence , a thermodynamically consistent assignment of reaction directions reduces this degeneracy by bounding some degrees of freedom .",
    "a concrete example of this is discussed in appendix a1 .",
    "our goal in this note is to devise a tool to obtain flux vectors @xmath37 and chemical potential vectors @xmath38 that are joint solutions of ( [ vn ] ) ( or ( [ mb ] ) ) and ( [ tc ] ) .",
    "we have considered two ( non - equivalent ) solution schemes . in method ( a ) , the flux and the chemical potential problems are decoupled : first , the former ( i.e. eq . ( [ mb ] ) or ( [ vn ] ) ) is solved for @xmath11 for a given reversibility assignment ( e.g. based on physiological data ) , then ( [ tc ] ) is solved for @xmath39 using as an input the signs @xmath40 of the net fluxes that solve the flux problem .",
    "this procedure allows to remove thermodynamically inconsistent solutions of the flux problem and provides estimates for chemical potentials , but it does nt allow to predict reaction directionalities .",
    "method ( b ) instead solves the mass balance and the energy balance problems jointly without any prior assumption on reversibility .",
    "we shall begin this section by outlining the two algorithms ; then we shall briefly discuss the algorithmic setup and the cellular data we have analyzed ( a detailed account of these issues is presented in appendices a2 and a3 .",
    "the solutions of the flux problems ( [ mb ] ) and ( [ vn ] ) ( starting from a priori reversibility assignments ) can be sampled respectively by monte carlo methods ( for small networks , see e.g. @xcite ) and by the minover@xmath41 scheme ( even for large systems , see e.g. @xcite ) .",
    "we assume to have obtained the resulting distributions for the net fluxes and hence a vector @xmath42 of net reaction directions ( @xmath43 for forward , @xmath44 for backward , @xmath45 for bidirectional ) .",
    "the free energy landscape reconstruction problem consists , given @xmath46 , in sampling vectors @xmath39 that satisfy ( [ tc ] ) , namely such that @xmath47 to approach it , we note that the problems ( [ constr ] ) and ( [ vn ] ) are formally equivalent . by analogy with @xcite , we can then employ the minover scheme originally designed to analyze perceptron learning @xcite and later adapted to generate solutions of ( [ vn ] ) .",
    "let @xmath48 denote a trial probability distribution of chemical potentials that contains some a priori information on experimentally determined potentials and concentrations .",
    "for instance , @xmath49 could be a uniform distribution centered around the known experimental values of @xmath26 and of sufficiently large width to span several orders of magnitude in trial concentrations , or a flat unbiased uniform distribution .",
    "in essence , the algorithm is designed to modify @xmath50 by building up correlations between @xmath26 s , until a distribution matching the solution space of ( [ constr ] ) is achieved .",
    "the steps are as follows .    1 .",
    "generate a chemical potential vector @xmath38 from @xmath51 .",
    "2 .   compute @xmath52 from ( [ constr ] ) and @xmath53 .",
    "3 .   if @xmath54 then @xmath39 is a thermodynamically consistent chemical potential vector for @xmath46 ; exit ( or go to 1 to obtain a different solution ) .",
    "if @xmath55 , update @xmath39 as @xmath56 ( where @xmath57 is a constant ) , go to 2 and iterate until convergence .",
    "as is generally true in minover schemes , the reinforcement term in ( [ deltag ] ) drives the gradual adjustment of potentials by ensuring that , at every iteration , the least satisfied constraint ( labeled @xmath58 ) is improved .",
    "in particular , the chemical potentials of metabolites that are produced ( resp . consumed ) in reaction @xmath58 are decreased ( resp .",
    "increased ) at each time step until a state is achieved where all unidirectional fluxes descend in the free energy landscape .",
    "note that even though the constraint ( [ constr ] ) is absent if @xmath59 , the above method still allows to retrieve information about the chemical potential of a metabolite involved in reversible processes ( unless it is _ only _ involved in reversible processes , in which case its @xmath26 is never updated ) .",
    "convergence to a solution ( if any ) is guaranteed for any @xmath57 , the proof being a minor modification of the one shown in @xcite , and the space of feasible chemical potentials can be sampled by re - starting the process from different chemical potential vectors belonging to @xmath51 . in this way , the final outcome is a set of correlated probability distributions for the @xmath26 s .",
    "note that , at odds with the method proposed in @xcite , the final chemical potentials can exceed the bounds defined by @xmath51 .",
    "details about the implementation of this scheme ( e.g. the choice of @xmath60 ) are described in appendix a3 .",
    "method ( b ) aims at solving the flux and the free energy problems simultaneously without relying on a priori information on reaction reversibility ( i.e. all are initially assumed to be bidirectional ) . besides a trial distribution @xmath51 for the chemical potentials",
    ", it uses the chemical potentials @xmath61 of the metabolites subject to uptakes .",
    "we focus on the case where the flux problem is represented by the vnc ( [ vn ] ) . from a computational viewpoint , sampling the solution space of ( [ vn ] ) is done more conveniently by introducing a parameter @xmath62 such that the system ( [ vn ] ) is recovered for @xmath63 ( see e.g. @xcite ) . in a fully reversible setting , the vnc takes a simple form by writing @xmath64 where @xmath65 and @xmath66 denote , respectively , the matrices of output and input stoichiometric coefficients , and by re - defining the flux variable @xmath7 as @xmath67 introducing the shorthand @xmath68 one sees @xcite that the solutions of ( [ vn ] ) correspond to those of @xmath69 for @xmath63 .",
    "the algorithm proceeds as follows .    1 .",
    "initialize @xmath70 ( e.g. @xmath71 ) .",
    "2 .   generate a chemical potential vector @xmath38 from @xmath51 .",
    "3 .   assign reaction directions 1 .   for intracellular reactions :",
    "compute affinities as @xmath72 , and assign directions as @xmath73 2 .   for intakes :",
    "if @xmath74 then @xmath75 ( intake is active ) , otherwise @xmath59 ( inactive ) .",
    "4 .   generate a vector @xmath76 from a uniform distribution , e.g. in @xmath77 $ ] .",
    "( @xmath78 is the absolute values of flux @xmath7 , see ( [ nu ] ) . )",
    "5 .   compute @xmath79 from ( [ yc ] ) and @xmath80 .",
    "6 .   if @xmath81 , then the configuration @xmath82 with @xmath83 is a thermodynamically feasible configuration of fluxes and chemical potentials for @xmath84 ; go to 8 .",
    "7 .   if @xmath85 , then update @xmath86 as @xmath87 with @xmath88 a constant . if @xmath89 , then update @xmath39 as @xmath90 and re - assign directions as in step 3 . let @xmath91 denote the updated directions .",
    "then * if @xmath92 , then set @xmath93 and go to 5 ( iterate until convergence ) * if @xmath94 , then set @xmath95 and go to 5 ( iterate until convergence to a solution ) 8 .",
    "if @xmath96 , update @xmath97 as @xmath98 with @xmath99 and go to @xmath100 and iterate until convergence    the idea behind this scheme is to mimic a relaxational dynamics into a thermodynamically stable steady state . following initialization , in step 3 directions are assigned according to a chemical potential vector .",
    "this assignment satisfies ( [ tc ] ) by definition and encodes information on the connected correlations among reaction affinities , i.e. @xmath101 @xmath102 denoting the average of @xmath26 according to the trial function @xmath50 .",
    "the algorithm then performs a minover scheme for fluxes , trying to find a feasible flux configuration compatible with this assignment .",
    "as the dynamics proceeds , some of the fluxes might display a preference to revert . in these cases , we let the chemical potential vector slowly evolve following the scheme of method ( a ) . if this provides a new set of directions agreeing with the inversion , the latter is accepted , otherwise the reaction is shut down and the process is iterated .",
    "once a configuration of fluxes and chemical potentials that satisfy ( [ tc ] ) and ( [ yc ] ) at @xmath84 is achieved , @xmath103 is increased until @xmath104 ( with @xmath105 the desired precision , typically @xmath106 or less ) .",
    "results at @xmath107 can then easily be extrapolated , and different solutions at @xmath107 can be sampled by re - starting from step 1 with a different vector @xmath39 from @xmath50 . in this way ,",
    "flux configurations evolve in a thermodynamically coherent fashion till they reach production feasibility . during evolution ,",
    "the algorithm modifies the initial distribution of chemical potentials exploring states close to the initial conditions but with a dynamics that correlates them according to feasible flux directions .",
    "details about the implementation of method ( b ) are reported in appendix a3 .",
    "we shall apply our schemes to the cellular metabolic network of the hrbc , reconstructed in @xcite .",
    "the detailed reconstruction as well as the auxiliary data employed for this study are exposed in section s2 .",
    "it consists of @xmath108 intracellular reactions among @xmath109 metabolites subject to @xmath110 uptakes .",
    "the network includes three pathways , namely glycolysis ( reactions 113 ) and the pentose phosphate pathway ( reactions 1421 ) , through which glucose is degraded to produce high - energy molecules needed to maintain osmotic pressure , transmembrane potential and redox state , plus a nucleotide salvage pathway ( reactions 2232 ) .",
    "the functional part of the network lies in the three reactions ( 3335 ) that are performing chemical work , namely : the atpase pump , that maintains osmotic pressure and transmembrane potential by exchanging na@xmath41 and k@xmath41 ions with the surrounding plasma ; the nadhase pump , carrying out the reduction of oxidized heme groups ; and the nadphase pump , whose function is to reduce the glutathione ( gsh ) molecules that continuously get oxidized while acting against free radicals .",
    "the main reason for focusing on this network lies in the fact that for this case it is possible to carry out a full comparison with previous results obtained by sampling the solution space of both ( [ mb ] ) @xcite and ( [ vn ] ) @xcite , as well as with experimental estimates of concentration profiles and chemical potentials .",
    "the information on net reaction directions required for method ( a ) has been extracted from these studies ( see section s3 ) . as for the trial distribution of chemical potentials @xmath111 required by both methods ( a ) and ( b ) , we have considered two different cases ( explained in detail in section s3 ) .",
    "\\(i ) _ poor input information_. by virtue of ( [ tc ] ) a certain amount of a priori information on the @xmath26 s ( to be incorporated in @xmath50 ) is required in order to reconstruct the entire free energy landscape . case ( i ) reproduces a situation in which this prior knowledge roughly matches the necessary minimum .",
    "specifically , the chemical potentials of @xmath112 metabolites , namely the four sources that are present in the hrbc network , i.e. glucose ( glc ) , lactate ( lac ) , nh@xmath113 and co@xmath114 , plus inosine monophosphate ( imp ) , adenine ( ade ) , nad and nadp , is fixed in @xmath50 and the corresponding variables are not updated .",
    "for the other compounds we have chosen a @xmath49 that reproduces the overall statistics of chemical potentials : specifically , each @xmath26 ( in units of kj / mol ) is selected independently and uniformly in @xmath115 $ ] with probability @xmath116 and in @xmath117 $ ] with probability @xmath118 .",
    "\\(ii ) _ rich input information_. in this case @xmath51 includes knowledge on the chemical potential of metabolites whose intracellular concentrations @xmath4 are experimentally known ( with errors ) , extracted from the formula @xmath119 . however ,",
    "contrary to case ( i ) no chemical potential is fixed with the exception of that h@xmath114o , assuming water to be in a condensed phase . when we were unable to find reliable concentration estimates ,",
    "the trial distribution of @xmath120 was taken to be uniform , centered in @xmath121 and spanning four values symmetrically around the mean .",
    "results for the chemical potential landscape of the hrbc reconstructed by method ( a ) from poor input information and from the reaction directions obtained in @xcite and @xcite for mbe and vnc respectively are shown in fig .",
    "[ fig1 ] .",
    "( spanning either the @xmath115 $ ] or the @xmath117 $ ] range ) is not shown .",
    "the errors on the experimental estimates of the fixed chemical potentials fall within the size of the dots . ]",
    "both mass - balance conditions turn out to provide thermodynamically feasible configurations of reaction directions and in both cases one obtains a broad agreement between computed and experimentally measured chemical potentials .",
    "this shows that method ( a ) , apart from being able to verify the thermodynamic feasibility of a flux state , is able to retrieve information on the energy landscape . keeping in mind that mbe represent tighter constraints on fluxes than vnc and that the networks used in @xcite and @xcite are not identical ( specifically in uptakes ) , one sees that the directions extracted from ( [ vn ] ) slightly outperform those resulting from ( [ mb ] ) in predicting chemical potentials , while both fail to predict ( via method ( a ) ) the @xmath26 s of key metabolites like nadh and nadph .",
    "the magnitude of the error bars reflects the considerable initial uncertainty we have assumed in the input information , as prior knowledge in this case is the minimal needed to solve ( [ tc ] ) unambiguously .",
    "a much refined prediction is obtained using a rich input information .",
    "results are displayed in fig .",
    "[ fig2 ] .",
    "the computed affinities display significant changes with respect to the picture embedded in @xmath50 .",
    "for instance , several of the initial bounds on affinities indicate that the free energy change in a reaction is positive ( e.g. pgi , pgk , g6pdh , ta ) , due either to the actual experimental estimates for the affinities or to the initial uncertainty we place on concentrations . such bounds are altered by minover in a direction compatible with physiologic assignments ( see table s2 ) , suggesting that the implementation of method ( a ) correlates the fluctuations of chemical potentials . at the same time",
    ", we observe that in some cases fluctuations of @xmath26 exceed the initial boxes defined by @xmath50 .",
    "since the resulting ranges are compatible with the intake configuration , they may provide an estimate of the statistical fluctuations from cell to cell .",
    "this also allows to obtain an estimate for the concentration range , including for metabolites whose level has not been experimentally probed ( 6pgl , rl5p , x5p , r5p , s7p ) .",
    "our predictions for the levels of ( 1,3)-diphosphoglycerate ( @xmath122-dpg ) , 2-phosphoglycerate ( 2pg ) and phosphoenolpyruvate ( pep ) differ from the experimental estimates .",
    "this is a consequence of the fact that we are forcing the phosphoglycerate kinase ( pgk ) and the glyceraldehyde phosphate dehydrogenase ( gapdh ) reactions in the forward direction , in agreement with the steady state direction assignments for glycolysis , even if the experimental values would classify them as reversible .",
    "in addition , we obtain different levels of key metabolites like atp and inorganic phosphate , while our predictions for adp and amp fail in the mbe and vnc conditions , respectively .",
    "this can be partially traced back to the difficulties inherent in assessing the potentials of highly exchanged metabolites @xcite . on the other hand ,",
    "the experimental estimates of these concentrations vary considerably across the literature ( e.g. @xcite _ vs _ @xcite ) . finally , a net intake of phosphate groups and a net outtake of co@xmath114 is predicted both for the mbe and the vnc states even if in physiological conditions the ratio of internal concentrations and the external levels in the blood would suggest otherwise ( see tables s1 and s3 ) .",
    "this , together with a slight inconsistency in the ph level , seems to call for the inclusion in the network of the carbonic anhydrase ( ca - i ) reaction , as well as of a bicarbonate ( hco@xmath123 ) outtake .",
    "the former carries out the intracellular ph buffering by hydrating co@xmath114 into bicarbonate , while the latter releases hco@xmath123 through the band3 membrane protein , which can cover up to 25% of the membrane surface @xcite .",
    "so , even if in the standard biochemical state species that differ only by the hydration level are usually lumped together in the reactants list , we have chosen to treat carbon dioxide and bicarbonate as different metabolites in the implementation of method ( b ) .",
    "results obtained by method ( b ) ( without a priori assumptions on reversibility ) are displayed in figs .",
    "[ fig3 ] and [ fig4 ] .        .",
    "]    because the atpase pump turns out to be weakly active across the solution space ( as in @xcite ) , we have performed a second set of calculations forcing a strong flux through it ( comparable with the glc uptake , as in@xcite ) . in the former case ,",
    "compared to the monte carlo sampling of @xcite two more reactions are found to be effectively bidirectional in agreement with their standard assignment , i.e. pgk and lactate dehydrogenase ( ldh ) .",
    "note that when the former is operating backward , it activates a futile cycle with the rapoport - luebering shunt , a behavior that has been experimentally observed in acidic conditions @xcite .",
    "when atpase flux is large , instead , pgk is constrained in the forward direction . on the other hand ,",
    "reverse ldh implies a lac intake and a higher flux of nadhase .",
    "simple biochemical arguments ( see section s5 ) suggest that the physiologically relevant scenario for hrbcs is that where the atpase flux is much smaller than the glc uptake",
    ". we shall henceforth focus on this case ( corresponding results for strong atpase flux are reported in sec .",
    "s4 ) .    the pairwise correlations among fluxes ( fig .",
    "[ figcorr ] ) show that glycolysis and the pentose - phosphate pathway form tight modules that are weakly anti - correlated with each other , mostly through the reversible phosphoglucoisomerase ( pgi ) reaction .        the forward ( resp .",
    "backward ) direction of pgi indeed indicates that glucose is processed preferentially through glycolysis ( resp .",
    "pentose phosphate pathway ) .",
    "glycolysis can furthermore be broken down into two separated blocks with a weaker ( positive ) cross - correlation .",
    "the nucleotides salvage pathway forms instead a weakly correlated module .",
    "the network ultimately presents six bidirectional reactions ( pgi , pgk , ldh , r5pi , apk , lace ) . comparing figs .",
    "[ fig4 ] and [ figcorr ] one sees that the directions of pgk , ldh and pgi govern the state of atpase , nadhase and nadphase , respectively .",
    "for instance , the negative ( resp .",
    "positive ) part of the ldh distribution corresponds to the high ( resp .",
    "low ) flux state of the nadhase pump ( ldh and nadhase are strongly anticorrelated ) .",
    "we hinted above that the coupling of ( [ vn ] ) and ( [ tc ] ) generates non trivial correlations between the chemical potentials in feasible states in both methods ( a ) and ( b )",
    ". a quantitative look at this aspect is reported in fig .",
    "[ pearson_coeff ] .",
    "note that correlations were initially absent , since @xmath51 is assumed to be a product of uncorrelated independent distributions .",
    "the algorithmic origin of such interdependecies can be understood considering that chemical potentials are updated dynamically through a series of reinforcement steps of the form @xmath124 .",
    "it follows that the @xmath26 s can ultimately be written as @xmath125 , where @xmath126 is the trial chemical potential sampled from @xmath50 and @xmath127 is an index which is updated ( increased or decreased by one according to the sign of the reaction ) each time reaction @xmath8 tries to invert .",
    "the covariance between chemical potentials can thus be decomposed as @xmath128 where @xmath129 stands for the connected correlation , @xmath130 is the variance of @xmath49 , so that @xmath131 . neglecting correlations between @xmath127 and @xmath132 for @xmath133 and between @xmath126 and @xmath127 ( for each @xmath5 and @xmath8 )",
    "this reduces to @xmath134 this simply tells us that the dynamics tends to correlate ( resp .",
    "anti - correlate ) metabolites typically appearing on the same ( resp .",
    "opposite ) side of the reaction equations ( such as adp and atp ) .    in this respect , it is worthwhile to compute the amount of information gained ( or lost ) through the sampling algorithms essentially via the build - up of correlations . note that indeed , since input distributions can be dynamically broadened , a loss of information is actually possible .",
    "the rationale behind this flexibility is that we are interested in estimating the ranges of variability of _ single cell",
    "_ states , which may exceed the uncertainty derived from experimental measures that are typically performed by averaging over a large number of cells .",
    "now the information gain is related to the difference in entropy of the initial and final distributions , which is particularly simple to estimate assuming to be dealing with gaussian distributions . indeed",
    "the entropy of a gaussian @xmath135 is given by @xcite @xmath136=\\frac{1}{2}\\text{tr}[\\log(\\textbf{k})]+\\frac{m}{2}[1+\\log(2\\pi)]\\ ] ] where @xmath137 is the covariance matrix of the @xmath26 s and @xmath12 is the dimensionality of the space , i.e. the number of metabolites .",
    "it follows that @xmath138-s[p_0(\\textbf{g})])=\\frac{1}{2}\\sum_{\\mu=1}^m[\\log(\\lambda^\\mu_0)-\\log(\\lambda^\\mu)]\\;,\\ ] ] where @xmath139 and @xmath140 are respectively the eigenvalues of the covariance matrix for the initial and final distributions , is the information gain .",
    "surprisingly , the information gain thus computed is found to be negative ( @xmath141 ) for method ( a ) , and positive ( @xmath142 ) for method ( b ) , indicating that the thermodynamic sampling algorithm allows for a refinement of the input information .",
    "the rank plot of eigenvalues ( see fig .",
    "s5 ) shows clearly that method ( a ) is capable of extracting information only from the metabolites with largest @xmath143 eigenvalues ( associated with highly uncertain concentrations ) and is generically outperformed by method ( b ) .",
    "in order to spot key - metabolites whose concentration variability bears a strong influence on the global organization of fluxes , we can quantify the correlations between fluxes and concentrations emerging from method ( b ) by computing the index @xmath144 which correlates the fluctuations in chemical potentials to those in fluxes .",
    "this matrix is shown in fig .",
    "[ eta2 ] .    ) ) obtained by method ( b ) with rich input information under weak atpase flux.,scaledwidth=49.0% ]    high concentrations of ( 1,3)-dpg and ga3p appear to favor the glycolytic pathway over the pentose - phosphate pathway , whereas the nucleotide rescue pathways is activated by high levels of ino and r5p and low levels of hx and r1p , whose concentration is instead correlated with high flux through the pentose - phosphate group .",
    "note that concentrations of metabolites only appearing in far from equilibrium reactions ( like ( 2,3)-dpg ) are seldom modified by the algorithm and thus appear to be particularly stable , as the corresponding @xmath145 are weakly dependent on fluxes .",
    "the network nodes that are more tightly connected to the biological functionality of the haematids are the three @xmath146 pumps : atpase ( that regulates the internal osmotic pressure and the transmembrane potential ) , nadhase ( that reduces hemoglobin from its metastable state ) and nadphase ( that maintains the redox state of the cell by reducing glutathione ) .",
    "their respective work loads can be estimated from basic biochemical parameters .",
    "the work carried out by the atpase pump can be written as @xmath147\\;,\\ ] ] where @xmath148 is the faraday constant and @xmath149 is the transmembrane potential , while @xmath150 and @xmath151 are the ratios between external and internal levels of sodium and potassium ions . at @xmath152",
    ", we obtain @xmath153 .",
    "the work carried out by the nadhase pump , specifically by cytochrome b5 reductase , can instead be estimated from the standard values of the redox potential of the couple fe@xmath154fe@xmath155 in the heme group of hemoglobin ( namely @xmath156 @xcite ) upon assuming normal levels of meta - hemoglobin ( @xmath157 of the total ) .",
    "we obtain @xmath158 ( the factor two comes from the fact that the reductase enzyme couples each nadhase with the reduction of two molecules of oxidized hemoglobin . )    finally we can estimate the work done by the nadphase pump , glutathione reductase , from the standard redox potential of the pair 2gsh / gssg , i.e. @xmath159 , and from their concentrations measured in human red cells , given respectively by @xmath160 , @xmath161 @xcite .",
    "we find @xmath162    the total amount of work per unit time performed by these three processes can now be written as @xmath163 where @xmath164 is the flux of atpase ( and similarly for the remaining pumps ) .",
    "at the same time , the entropy produced by the cell per unit time reads @xmath165 where the first sum coincides with the quadratic form defined by the stoichiometric matrix of intracellular reactions , i.e. @xmath166 , and the second is over cross - membrane transport processes ( uptakes ) , with @xmath167 the uptake flux of metabolite @xmath5 . in order to obtain a realistic description of the processes , after normalizing our computed fluxes with respect to the average value of the glc uptake ( @xmath168 @xcite ) , we scaled them by the cell volume ( @xmath169 ) .",
    "the nave thermodynamic efficiency of the hrbc can finally be evaluated as @xmath170 in fig .",
    "[ fig5 ] we display the distributions of @xmath171 , @xmath172 , @xmath173 and @xmath174 obtained from method ( b ) with weak and strong atpase flux .    ) , entropy produced ( @xmath172 ) and energy flow ( @xmath175 ) per unit time for the hrbc metabolism with strong ( dotted line ) and weak ( straight line ) atpase flux .",
    "inset : distribution of efficiency ( @xmath174 ) in the same conditions . ]    the two peaks in the distributions mirror those appearing in the flux distributions of the nadh and nadph pumps .",
    "remarkably , the computed efficiency of the hrbc is not far from that corresponding to optimal microbial growth , which was estimated to be close to 24% @xcite .",
    "note that the work performed per unit time by the nadphase pump dominates the sum ( [ wdot ] ) .",
    "therefore the two peaks appearing in the distribution of @xmath176 mirror those appearing in the distribution of @xmath177 .",
    "constraint - based models of cellular metabolism are important tools to analyze and predict the chemical activity and response to perturbations of cells without relying on kinetic and transport details that are often unavailable . in such frameworks , assessing the metabolic capabilities of a cell requires the exploration of a high dimensional space representing flux and chemical potential configurations compatible with mass- and energy - balance constraints .",
    "the complexity of the ensuing problem can in some cases be reduced by applying reasonable ( though necessarily ad hoc ) optimality criteria .",
    "most often , however , one needs to sample `` physiological configurations '' from the solution space starting from a priori biochemical knowledge that could be noisy .",
    "the methods proposed here are designed to retrieve distributions of fluxes and chemical potentials ( or concentrations ) essentially by exposing and building up correlations between variables .",
    "this is substantially different from other approaches ( e.g. @xcite ) , where either the flux distributions compatible with given chemical potentials or the reverse are sought .",
    "disposing of reliable prior biochemical information is obviously a limiting factor in our case as well .",
    "the advantage lies in the fact that working with correlations allows for a greater flexibility in treating the biochemical input data . besides providing information on feasible",
    "physiological concentration ranges , flux distributions and reaction directionality , thermodynamic sampling can be employed to evaluate the responsiveness of fluxes to fluctuations in concentrations ( or the reverse ) and to assess the thermodynamic efficiency of a cell . in the case considered here ( the hrbc , where a comparison with results obtained by sampling the solution space of mass - balance equations is possible ) , we have estimated @xmath178 assuming that the functional core of its metabolism lies in the three pumps ( atpase , nadhase , nadphase ) . a similar calculation can be carried out on more complex genome - scale systems ( e.g. e. coli ) for a modest increase of computational costs ( work in progress ) .",
    "this work is supported by the dream seed project of the italian institute of technology ( iit ) and by the joint iit / sapienza lab `` nanomedicine '' .",
    "in order to clarify how thermodynamic constraints translate into bounds on the degrees of freedom , consider the small module shown in fig .",
    "[ fluxis ] . a priori , it admits @xmath179 different direction assignments , corresponding to the 8 possible states for the 3 internal fluxes @xmath180 , @xmath181 and @xmath182 , times the 4 possible states of the boundary fluxes @xmath183 and @xmath184",
    ".    network module with @xmath185 internal reactions , @xmath180 , @xmath181 and @xmath182 between @xmath185 chemical species @xmath186 , @xmath187 and @xmath188 and @xmath189 uptake fluxes @xmath183 and @xmath184 .",
    "unit stoichiometry is assumed.,scaledwidth=48.0% ]    assuming unit stoichiometry , one easily sees that 6 of the 8 states allowed for @xmath190 are thermodynamically feasible , corresponding to the number of ways in which one can order the chemical potentials of metabolites @xmath186 , @xmath187 and @xmath188 . the excluded configurations present _ unfeasible cycles_. mass constraints further reduce the space of possible directions .",
    "mass - balance equations ( mbe ) impose that each metabolite should be produced and consumed by at least one reaction , leaving only two feasible direction assignments",
    ". the softer von neumann conditions ( vnc ) instead force each metabolite to be produced at least by one reaction , leaving four possible states .",
    "once the possible directions of the boundary fluxes @xmath183 and @xmath184 are considered , one ends up with two thermodynamically and stoichiometrically feasible configurations for mbe and eight for vnc ( down from 32 ) .",
    "now let us focus on a specific flux model ( say mbe ) and note that it enforces @xmath191 , @xmath192 and @xmath193 .",
    "this leaves two free parameters , e.g. @xmath184 and @xmath194 , and it is easy to show that the exclusion of unfeasible cycles implies @xmath195 .",
    "similar though more lengthy arguments can be formulated for the von neumann flux model vnc .",
    "further examples are discussed e.g. in @xcite .",
    "the hrbc metabolic network employed for this study is shown in fig .",
    "[ network ] .",
    "it is formed by @xmath196 metabolites ( listed in table [ metab ] ) interacting through @xmath108 intracellular reactions ( listed in table [ react ] ) and subject to @xmath110 ( for method ( a ) ) or 13 ( for method ( b ) ) uptakes .",
    "( bicarbonate outtake was only accounted for in method ( b ) . )",
    "the network can be divided in three main pathways , namely glycolysis ( reactions 1 - 13 ) , the pentose phosphate pathway ( reactions 14 - 21 ) , and a nucleotide salvage pathway ( reactions 22 - 32 ) .",
    "the directions displayed correspond to the standard physiological assignment .",
    "the network coincides with the reconstruction presented in @xcite , except for the inclusion of bicarbonate ( hco@xmath123 ) , of the carbonic anhydrase reaction ( 33 ) and of a bicarbonate uptake .",
    "table [ metab ] also provides the standard chemical potential for each metabolite and an estimate of the intracellular concentration ( when available ) .",
    "potentials are computed in the standard biochemical state , i.e. in acqueous solution at fixed temperature , pressure , ionic strength and ph and are available in @xcite , where they are calculated according to the prescriptions of @xcite at @xmath197 k , @xmath198 atm , ph @xmath199 and ionic strenght i @xmath200 m. the physiological conditions of the hrbc are known to be slightly different ( @xmath201 k , ph @xmath202 ) , but such differences do not affect significantly the results of our procedures .",
    "the estimated intracellular concentration ranges are obtained from measurements in different settings .",
    "it is worth to notice that the experimental errors on such values of concentrations reflect an essential uncertainty rather than statistical fluctuations from cell to cell , since standard measurements of concentrations are usually carried out averaging over many ( @xmath203 ) cells .",
    "finally , in table [ ext ] we report the reference values for blood tests @xcite of the level of metabolites of interest in serum .",
    "here we discuss in some detail four aspects connected to the implementation of methods ( a ) and ( b ) , namely    * the minimal amount of input information on chemical potentials ( to be included in @xmath51 ) needed to reconstruct the free energy landscape via method ( a ) ; * the form of the input information on chemical potentials ( i.e. of @xmath51 ) in the poor versus rich input information scenarios ; * the form of the input information on reaction directions sampled from mbe and vnc , required by method ( a ) only ; * the choice of the `` learning parameters '' @xmath60 and @xmath204 that appear , respectively , in both methods and in method ( b ) only , that characterize the size of the update step in , respectively , chemical potentials and fluxes .      to begin with ,",
    "let us note that the thermodynamic constraint @xmath205 imposes that the chemical potential of metabolites that are sources ( resp .",
    "sinks ) of the network should be known , since the constraints ( [ tc ] ) do not bound the corresponding @xmath26 s from above ( resp .",
    "below ) . clearly , then , computing the landscape of chemical potentials is feasible only if @xmath51 carries some prior information on the @xmath26 s .    besides network ` leaves ' , one easily sees that certain intracellular potentials should be known as well .",
    "consider a chemical potential vector @xmath206 that satisfies ( [ tc ] ) and note that @xmath207 is again a solution for @xmath36 provided @xmath208 is such that @xmath209 for each @xmath8 .",
    "this degeneracy is related to the existence of equilibrium states and needs to be lifted .",
    "ideally this can be achieved by fixing the chemical potentials of at least one of the metabolites with @xmath210 for each vector @xmath211 of the type described above .",
    "note that such vectors include ( but are not limited to ) the conserved metabolic pools defined in @xcite .",
    "a conserved pool is a group @xmath212 of metabolites described by a vector @xmath213 with @xmath214 if @xmath215 , and zero otherwise , such that , for each @xmath8 , @xmath216 . from a physical viewpoint",
    ", each such pool corresponds to a conservation law for the aggregate concentration of the corresponding metabolites and the existence of one pool suffices to force @xmath217 for each @xmath218 in the vnc scenario ( in other words , metabolites belonging to conserved pools can not be producible ) @xcite .",
    "the simplest way to rule out equilibrium solutions is to clamp the chemical potential of a group @xmath219 of metabolites ( including network sources and sinks ) such that the problem @xmath220 admits no solution . from a geometrical perspective",
    ", the minimal number of metabolites whose chemical potentials needs to be constrained is that for which the number of independent equations in the above system exceeds the number of variables .      in the case of the hrbc",
    ", there are four source / sink nodes , namely glucose ( glc ) , lactate ( lac ) , ammonia ( nh@xmath113 ) and carbon dioxide ( co@xmath114 ) , whereas a basis for the left kernel of the stoichiometric matrix @xmath0 ( excluding uptakes ) turns out to be composed by seven vectors : @xmath185 conserved pools , namely the pairs ( nad , nadh ) and ( nadp , nadph ) and the larger pool formed by ( hx , ino , imp , ade , ado , amp , adp , atp ) , plus @xmath221 other vectors whose components are related in a non - intuitive way to the balance of global quantities like the number of carbon atoms and phosphate groups . analyzing ( [ lift ] ) ,",
    "however , one finds that by clamping four metabolites ( besides leaves ) no equilibrium solution can exist . in the _ poor input information _ scenario ,",
    "we have therefore constructed @xmath51 by fixing the chemical potentials of glc , lac , nh@xmath113 and co@xmath114 as well as of inosine monophosphate ( imp ) , adenine ( ade ) , nad , and nadp to remove the degeneracy associated to the presence of equilibrium solutions ( different choices for these do not alter results ) . for these metabolites , @xmath222 , where @xmath223 is the chemical potential obtained from experimental data . for the other compounds",
    "we have chosen a @xmath49 that reproduces the overall statistics of chemical potentials .",
    "in particular , each @xmath26 ( in units of kj / mol ) is selected independently and uniformly in @xmath115 $ ] with probability @xmath116 and in @xmath117 $ ] with probability @xmath118 .    in the _ rich input information _ scenario , @xmath224 was constructed as follows .",
    "the chemical potential of metabolites whose intracellular concentrations are known experimentally were extracted from the formula @xmath119 . here",
    "@xmath225 is the free energy of formation of the metabolite @xmath5 in the standard biochemical state .",
    "these values are accurately known for metabolites in the hrbc metabolic network ( see table [ metab ] ) .",
    "the concentrations @xmath4 are instead taken to be uniformly and independently distributed random variables with average values and box sizes according to the experimental estimates reported in table [ metab ] .",
    "the concentrations of metabolites for which we were unable to find reliable experimental estimates are assumed to be uniformly and independently distributed random variables centered around @xmath226 m and spanning four orders of magnitude symmetrically around the mean .",
    "note that in this case no metabolite has a clamped chemical potential and the algorithm can modify the trial distributions of all metabolites .    in both scenarios ,",
    "the chemical potential of water is treated as a boundary condition , i.e. it is kept fixed since we assume that water is in a condensed phase .      in @xcite and @xcite ,",
    "the hrbc network is assumed to operate under the mbe and vnc scenarios , respectively , in both cases starting from prior assignments for reaction directions . the implementation of method ( a ) makes use of the reaction directions obtained in these studies . in summary",
    ":    * according to mbe , the net flux of all reactions is in the forward direction , except pgi , r5pi and apk , ( which are found to operate bidirectionally ) ; * according to vnc , the net flux of all reactions is in the forward direction , except r5pi ( which is found to be operating bidirectionally ) , and pgi and apk ( which are found to operate in the backward direction ) .",
    "for comparison the thermodynamic sampling method ( b ) ( which does nt require a priori reversibility assumptions ) provides solutions in which the net flux of all reactions is in the forward direction , except pgi , pgk , ldh , r5pi and apk ( which are found to operate bidirectionally ) .",
    "note that reverse pgk activates a futile cycle with the rapoport - luebering shunt .",
    "this behavior has been experimentally observed in acidic conditions @xcite .",
    "it should be noted however that the network used here presents an additional intracellular reaction ( ca - i ) , an additional metabolite ( hco@xmath123 ) and an additional uptake with respect to the networks studied above .",
    "furthermore , the reconstructions employed in @xcite and @xcite have slight but important differences in the structure of uptakes .      both methods ( a ) and ( b ) rely on learning rates ( denoted as @xmath60 for method ( a ) and @xmath60 and @xmath204 for method ( b ) ) that fix the size of the adjustment to be applied to chemical potentials ( @xmath60 ) and fluxes ( @xmath204 ) at each iteration step .    for the implementation of method ( a ) presented here , we set @xmath60 to the ( iteration - dependent ) value @xmath227 .",
    "one easily sees that if we let all the chemical potentials evolve during the sampling , this value of @xmath60 has the net effect of reverting @xmath228 at each iteration while keeping the norm @xmath229 , that defines the unit of the energy scale , constant .",
    "note however that some of the chemical potentials must be kept fixed during the sampling ( specifically those belonging to the set of compounds for which a priori information is required ) . in this case , the expression for @xmath60 given above guarantees that the elementary step of the algorithm is proportional to the amount by which the constraint is violated .",
    "we found empirically that for this choice the convergence time decreases by a factor of about @xmath230 with respect to the case in which a constant @xmath60 is employed .    in the implementation of method ( b ) we chose the value @xmath231 for @xmath204 ( for the same reasons as above ) , while keeping a constant learning rate for chemical potentials ( @xmath232 ) .",
    "this was motivated by the need to try to keep a `` timescale '' separation between the dynamics of fluxes and that of chemical potentials , with the latter preferentially slower than the former .",
    "in essence , this emphasizes the role of correlations in building up the solutions while potentially limiting the exploration of states to regions in the space of chemical potentials that are not too far from the initial states .",
    "finally , we remark that the solution space spanned by the completely reversible von neumann constraints may lack convexity for @xmath233 @xcite .",
    "this leads to a certain rejection rate of solutions ( roughly 10% ) , which represents a negligible additional cost in computations .",
    "fig . [ fig5 ] shows the flux - flux correlations computed from method ( b ) assuming strong flux through the atpase pump .        compared to the case where atpase flux is weak ,",
    "one notices that glycolysis is split in two separate but correlated modules , formed respectively by the first six and the last three reactions ( in agreement with @xcite ) .",
    "similarly , the pentose phosphate pathway is split in two tight modules , while the nucleotides salvage pathway no longer forms a compact group .",
    "note that the role of pgk and pgi as switches for the atpase and nadphase pumps is much less pronounced in this case .",
    "one sees that all intracellular metabolites are mass - balanced except pyr , lac , h@xmath41 and hco@xmath123 .",
    "this means that vnc solutions predict a slow steady growth of their concentration .",
    "however all of these are subject to outtakes , therefore the final state of the cell is globally mass balanced ( i.e. the solutions of thermodynamically - constraint vnc would coincide with those of thermodynamically - constraint mbe on the same system ) .",
    "one clearly sees that method ( b ) outperforms method ( a ) in gaining information over the trial distribution @xmath51 .",
    "note in particular that method ( a ) typically loses information on metabolites with small variability range in the trial distribution ( corresponding to the smallest eigenvalues of @xmath143 ) .",
    "it is interesting to notice that in order to maintain the @xmath146 pumps the activation of glycolysis and pentose phosphate pathway is sufficient . to see this",
    ", we can work out the stationary state of the network in absence of the nucleotide salvage pathway , i.e. for a reduced network consisting of 13 ( glycolysis ) + 8 ( ppp ) + 3 ( pumps ) = 24 intracellular reactions and 5 uptakes ( glc , pyr , lac h@xmath114o and hco@xmath113 ) .",
    "the mass balance equations reveal that only four of the above reactions are linearly independent : we choose @xmath234 , @xmath235 ( glucose and lactate uptake ) , @xmath236 and @xmath237 ( rls stands for rapoport - luebering shunt ) .",
    "all fluxes can be written in terms of these .",
    "in particular , the quantities of interest in the energy balance take the form @xmath238 for the energy flow and @xmath239 for the fluxes through the pumps . now under flux balance @xmath240 .",
    "hence from the values in table [ tableflux ] we can estimate @xmath241 m / s , i.e. one order of magnitude smaller than the glucose uptake as in @xcite and in agreement with our thermodynamic sampling without constraints on the atp ionic pump .                        a hoppe , s hoffmann and hg holzhtter . including metabolite concentrations into flux - balance analysis : thermodynamic realizability as a constraint on flux distributions in metabolic networks .",
    "bmc systems biology * 1 * 23 ( 2007 )          c martelli , a de martino , e marinari , m marsili and i perez castillo . identifying essential genes in escherichia coli from a metabolic optimization principle .",
    "usa * 106 * 2607 ( 2009 )                      a de martino , d granata , e marinari , c martelli and v van kerrebroeck .",
    "optimal fluxes , reaction replaceability , and response to enzymopathies in the human red blood cell .",
    "j. biomed .",
    "biotechol . *",
    "2010 * 415148 ( 2010 )                  dr thorburn and pw kuchel ( 1985 ) .",
    "regulation of the human - erythrocyte hexose - monophosphate shunt under conditions of oxidative stress . a study using nmr spectroscopy , a kinetic isotope effect , a reconstituted system and computer simulation .",
    "j. biochemistry * 150 * 371 ( 1985 )"
  ],
  "abstract_text": [
    "<S> the analysis of non - equilibrium steady states of biochemical reaction networks relies on finding the configurations of fluxes and chemical potentials satisfying stoichiometric ( _ mass balance _ ) and thermodynamic ( _ energy balance _ ) constraints . </S>",
    "<S> efficient methods to explore such states are crucial to predict reaction directionality , calculate physiologic ranges of variability , estimate correlations , and reconstruct the overall energy balance of the network from the underlying molecular processes . </S>",
    "<S> while different techniques for sampling the space generated by mass balance constraints are currently available , thermodynamics is generically harder to incorporate . </S>",
    "<S> here we introduce a method to sample the free energy landscape of a reaction network at steady state . in its most general form , it allows to calculate distributions of fluxes and concentrations starting from trial functions that may contain prior biochemical information . </S>",
    "<S> we apply our method to the human red blood cell s metabolic network , whose space of mass - balanced flux states has been sampled extensively in recent years . </S>",
    "<S> specifically , we profile its thermodynamically feasible flux configurations , characterizing in detail how fluctuations of fluxes and potentials are correlated . based on this </S>",
    "<S> , we derive the cell s energy balance in terms of entropy production , chemical work done and thermodynamic efficiency . </S>"
  ]
}