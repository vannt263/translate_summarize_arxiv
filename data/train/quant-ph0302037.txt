{
  "article_text": [
    "quantum cryptography , or more precisely , quantum key distribution ( qkd ) followed by the one - time pad , is the only secure way of transmitting secret information ( see @xcite for a review ) .",
    "its security is not based on some mathematical assumptions , such as a limited eavesdropper s computational power , but on the laws of quantum mechanics .",
    "because of the heisenberg s uncertainty principle , a measurement on a quantum system modifies the system itself .",
    "thus , eve s measurement on a quantum state carrying sender s information produces a change on the state that can be noticed by alice and bob .",
    "the security of qkd schemes can also be understood in terms of the no - cloning theorem @xcite .",
    "eve can not make and keep a perfect copy of the quantum state carrying the information from alice to bob @xcite .",
    "most of the known qkd protocols use two - dimensional quantum states , called qubits , as information carriers , although there exist alternative proposals using higher dimensional systems , either finite @xcite or infinite @xcite . the information encoding can be performed by means of any two - dimensional quantum state , but very often this is done using photons that are sent through an optical fiber , the quantum channel .",
    "therefore , alice , must be able to prepare and send single photons to bob .",
    "the existence of single - photon sources is then an implicit and crucial requirement for many of the proposed implementation of the existent schemes . since there are no practical single - photon sources available , alice generally uses a weak coherent pulse , @xmath1 , with mean photon number @xmath2 , as an approximation of the single - photon pulse .",
    "moreover , since there is no phase reference outside alice s lab , the effective state used for the information encoding is @xmath3 with the number @xmath4 of photons distributed according to a poisson statistics of mean @xmath5 , @xmath6 @xcite .",
    "thus , instead of the ideal one - photon fock state , alice produces a zero - photon state with probability @xmath7 , a one - photon state with probability @xmath8 and so on .",
    "intuitively , the presence of pulses with more than one photon may deteriorate the security of the protocol , since a perfect copy of the quantum state is then produced by the imperfect single - photon source .",
    "indeed , it was shown in @xcite that the presence of these multi - photon pulses makes the best - known qkd protocol , the bb84 scheme @xcite , insecure if the losses in the channel become important .",
    "eve can then perform the so - called photon number splitting ( pns ) attack that allows her to get full information without being detected .",
    "this limits the distance up to which bb84 with weak coherent pulses and lossy optical fibers can be securely implemented . for typical experimental parameters",
    "this critical distance , @xmath9 , is of the order of 50 km .",
    "as we will show below , similar conclusions are valid for weak pulse implementations of other qkd schemes , such as the b92 @xcite and the 4 + 2 protocol @xcite .",
    "recently , new quantum cryptography protocols have been proposed that are more robust against pns attacks @xcite .",
    "the scope of the present article is to give a detailed security analysis of these protocols under different eavesdropping scenarios . in the next section we review the pns attack for the bb84 scheme , and we show how the same results and conclusions also apply for the b92 and 4 + 2 protocols .",
    "then , we discuss qkd implementations including a strong reference pulse as a first possibility for minimizing the importance of pns attacks .",
    "moreover , the results of section [ pns ] give us some insight into the requirements needed for a qkd protocol to be resistant to pns attacks in a weak pulse implementations .",
    "the family of investigated protocols is presented in section [ prot ] .",
    "we will focus on a particular one , that differs from bb84 only in the classical sifting procedure for extracting the key",
    ". we will consider various possible attacks , some which do not introduce errors , some which use cloning machines ( which do introduce some errors ) , and some which are the combination of both .",
    "we briefly discuss the experimental data of @xcite in the light of our results , as an example of a qkd implementation secure against pns attacks . at the end",
    ", we also explore possible generalizations .",
    "the last section summarizes the main results .",
    "let us end the introduction with four important remarks about our results .",
    "first , in order to make a fair comparison between all the analyzed protocols , we take as a reference the bb84 scheme using @xmath10 , i.e. for all the protocols the raw rate at very large distances must be the same as in this reference scheme .",
    "second , we do not consider advantage distillation protocols for secret - key distillation ( see for instance @xcite ) .",
    "therefore , a protocol is said secure if and only if the information alice - bob is greater than eve s information .",
    "indeed , it was shown in @xcite that secret - key distillation is possible using one - way privacy amplification whenever @xmath11 third , although eve is supposed to have unlimited technological power , we assume that she is not able to manipulate bob s detector ( contrary to what is done in ref .",
    "this is a crucial point for our analysis @xcite .",
    "indeed , let us suppose that eve can modify the detector efficiency , @xmath12 , in such a way that it is equal to one for those instances where she has got the full information ( her attack is successful ) .",
    "if we take @xmath13 , our results should be modified ( see for instance eq .",
    "( [ qevebb84 ] ) ) by a factor of ten , which means a factor of 10 db , or equivalently of 40 km , in all our curves . and",
    "four , we do not take into account coherent attacks , where eve interacts with more than one pulse @xcite .",
    "any experimental realization using photons of a qkd protocol with two - dimensional quantum states must ideally be performed with a single - photon source .",
    "unfortunately , this is a very strong requirement with present day technology , and one has to design a way of experimentally approximating the single - photon source . in spite of the fact that qkd has proven to be unconditionally secure",
    "( see for instance @xcite ) , this may not be the case any longer if the technology of the honest parties is not perfect . in most of the existent implementations ,",
    "the one - photon pulse is approximated by a weak coherent pulse @xmath1 .",
    "as said above , and since there is no absolute phase reference , the state seen by bob and eve is given by eq .",
    "( [ coh ] ) , an incoherent mixture of multi - photon states with poisson probabilities .",
    "eve can then perform a photon number non - demolition measurement , keep one of the photons when a multi - photon state is found , and forward the rest to bob . note that eve s action is not detected by bob if he is assumed to have only access to the average detection rate , and not to the statistics of the photons he receives .",
    "we also assume that eve is able to control the losses on the line connecting alice and bob ( or equivalently she can send photons to bob by a lossless line ) . in this situation , eve can perform the so - called pns attack that , as we show below , limits the security of many of the known existing protocols .      in the bb84 protocol @xcite",
    ", alice chooses at random between two mutually unbiased bases , in which she encodes a classical bit . denoting by @xmath14 ( @xmath15 ) the eigenvectors of @xmath16 ( @xmath17 ) with eigenvalue @xmath18",
    ", she can encode a logical 0 into either @xmath19 or @xmath20 and a 1 into either @xmath21 or @xmath22 .",
    "she sends the qubit to bob , who measures at random in the @xmath23 or @xmath24 basis .",
    "then , they compare the basis and when they coincide , the bit is accepted . in this way",
    ", half of the symbols are rejected , and , in the absence of perturbations , they end with a shared secret key . in practical situations , and due to the presence of errors and possibly a spy , some error correction and privacy amplification techniques have to be applied , in order to extract a shorter completely secure key .",
    "now , let us see how eve can take advantage of the multi - photon pulses .",
    "alice sends a pulse with @xmath2 coding the classical bit ( say on light polarization ) .",
    "eve performs the photon number measurement and when two or more photons are detected , she takes one and forward the rest to bob by her lossless line .",
    "eve stores the photon in a quantum memory and waits until the basis reconciliation .",
    "once the basis is announced , she has only to distinguish between two orthogonal states , which can be done deterministically .",
    "thus , for all the multi - photon pulses eve obtains all the information about the sent bit .",
    "if alice and bob are in principle connected by a lossy line , eve can block some of the single - photon pulses , and forward the multi - photon pulses , on which she can obtain the whole information , by her lossless line . in this way , alice and bob",
    "do not notice any change in the expected raw rate , and eve remains undetected .",
    "when the losses are such that eve can block all the single - photon pulses , the protocol ceases to be secure .",
    "denote by @xmath25 the losses in db per km on the line . the expected raw rate at bob s side is giving by @xmath26},\\ ] ] where @xmath27 is the total attenuation in db of the quantum channel of length @xmath28 .",
    "eve will apply the pns attack on a fraction @xmath29 of the pulses . since she does not want to be detected , the raw rate must not change , i.e. she has to choose @xmath30 in such a way that @xmath31 where @xmath32 @xcite .",
    "eve s information is zero when she does nothing , and one for the pns attack , i.e. denoting by @xmath33 , @xmath34 if the losses are such that @xmath30 can be zero in eq .",
    "( [ qevebb84 ] ) ( all the one - photon pulses can be blocked ) , eve gets all the information , without being detected .",
    "the critical attenuation , @xmath35 , is then given by the condition @xmath36 . in figure [ pnsatt ]",
    "we show the variation of @xmath37 as a function of @xmath28 for @xmath10 and @xmath38 @xcite .",
    "the critical attenuation in this case is @xmath39 db , and the corresponding distance @xmath40 km .",
    "two important points have to be stressed here .",
    "first , we do not claim the optimality of the pns strategies we consider in this section from the point of view of eve s information for losses lower than @xmath35 .",
    "indeed , when the losses begin to be relevant , it is more convenient for eve to perform the pns attack on all the multi - photon pulses and block some of the single - photon pulses .",
    "one can see that this slightly increase @xmath37 , but does not change the critical distance , as defined in this article .",
    "second , alternative and more conservative definitions of the critical distance can be proposed . for simplicity",
    ", we consider no perturbations in the absence of eve , i.e. the information alice - bob , @xmath41 , is one .",
    "but in realistic situations and due to the presence of errors ( for instance due to detector and optical noise ) this is not true , and the critical distance corresponds to the point where @xmath42 .",
    "if the error rate is important , this distance may be smaller than the one indicated here . in any case , for channel attenuations greater than @xmath35 , the implementation of the bb84 protocol using weak coherent pulses is not secure .",
    "one may wonder whether this attack is only possible because the information is encoded on light polarization .",
    "however the same reasoning is also valid for other encodings such as , for instance , in the time - bin scheme ( see @xcite ) .",
    "there the information is transmitted using the relative phase between two weak coherent pulses that are sent through the fiber . in principle",
    ", the state leaving alice s side is @xmath43 where @xmath44 ( @xmath45 ) correspond to @xmath46 ( @xmath47 ) .",
    "but since there is no phase reference , the effective state seen by eve and bob is @xmath48 where @xmath49 are poisson probabilities of mean photon number @xmath50 and @xmath51 note that bob s state is given by an expression like ( [ timebin ] ) multiplying the mean photon number by the channel attenuation .",
    "it is possible to define a creation and annihilation operator @xmath52 such that acting on the two - mode vacuum state gives @xmath53 .",
    "it is straightforward to see that @xmath54 @xmath55=1 $ ] and @xmath56 .",
    "thus , the situation is the same as in the previous polarization encoding scheme @xcite .",
    "eve can count the total number of photons in the two ( now temporal ) modes , in an analogous way as in the previous photon number measurement for polarization , without being noticed by bob .",
    "more than one \" photons are detected , i.e. she projects into @xmath57 , she stores one copy of the state in her quantum memory until the basis reconciliation .",
    "obviously , the equations and critical values in this case are the same as the ones found above for the polarization encoding scheme .",
    "an alternative qkd scheme is given by the b92 protocol @xcite .",
    "the classical bit is simply encoded by alice using two non - orthogonal states , @xmath58 and @xmath59 with @xmath60 . without loosing generality",
    "we will take @xcite @xmath61 with @xmath62 and the overlap is @xmath63 .",
    "bob has to distinguish between two non - orthogonal quantum states , and this can only be done with some probability .",
    "the measurement optimizing this probability is defined by the following positive operators , summing up to one @xcite , @xmath64 where @xmath65 denotes the state orthogonal to @xmath66 .",
    "when bob s measurement outcome is the one associated to @xmath67 , with @xmath68 , he knows that the state was @xmath69 .",
    "the probability of obtaining an inconclusive result is equal to the overlap between the states , @xmath70 .",
    "thus , alice and bob will accept the sent bit only for those cases where bob s measurement gives a conclusive result .",
    "the probability of acceptance is @xmath71 , while for the bb84 this probability is equal to one half .",
    "pns attack is described in the following lines .    in a weak pulse encoding scheme ,",
    "this protocol is clearly insecure .",
    "what eve can simply do is to perform the same unambiguous measurement as bob .",
    "when a conclusive result is found , she knows the state and she prepares a copy of it on bob s side . when eve is not able to determine the state , she blocks the pulse . of course , as soon as we have some losses in the channel alice and bob can not detect the eavesdropping ( since they assume that the absence of signal is due to the losses ) , and the protocol is insecure .",
    "note that no quantum memory and lossless line is needed by eve in this case .",
    "a third qkd protocol was proposed in @xcite combining some of the ideas of the b92 and bb84 schemes . as in the bb84 protocol , there are four states grouped into two sets @xmath72 . however , as in the b92 , the states in each set are not orthogonal , their overlaps being @xmath73 .",
    "the situation is depicted in figure [ fig42 ] , the four states lie on the same parallel of the bloch sphere . thus , alice chooses randomly in which of the two sets the bit is encoded .",
    "bob performs at random one of the two povms distinguishing the two states of each set .",
    "after basis reconciliation , they determine all the cases where bob has applied the correct measurement obtaining a conclusive result . at first sight",
    ", this protocol seems more resistant against pns attacks : compared to the bb84 case , eve can keep some of the photons but her measurement after the basis reconciliation may not be conclusive . and compared to the b92 case , she does not know which of the two measurements has to be applied . however , and due to the particular geometry of the sets of states , this scheme does not offer any advantage over the two previous ones . but before describing eve s attack , let us show how the three - outcome povm described by ( [ povm ] ) can be interpreted as the concatenation of two two - outcome measurements .",
    "the effect of any quantum measurement can be represented by a set of operators @xmath74 satisfying @xmath75 .",
    "if the initial state is @xmath76 , the probability for any outcome , say @xmath77 , is @xmath78 and the state is transformed into @xmath79 consider the states ( [ b92st ] ) .",
    "the povm described by the operators ( [ povm ] ) can be effectively replaced by a sequence of two two - outcome measurements .",
    "first , one applies a measurement described by the operators @xmath80 the effect of this first measurement is the following : with probability @xmath71 the state @xmath58 ( @xmath59 ) is mapped into @xmath19 ( @xmath21 ) .",
    "this operation is often called a filtering , and it is equivalent to the cases where the povm ( [ povm ] ) gives a conclusive result .",
    "when the outcome @xmath81 has been obtained , it is said that the states have passed the filter .",
    "if this is the case , a standard von neumann measurement on the @xmath23 basis suffices for discriminating between the two states .",
    "let us come back to the 4 + 2 protocol and consider the filter for the states in set @xmath82 , sending these state into the @xmath23 basis .",
    "it is not difficult to see that the same filter maps the states in set @xmath83 into @xmath15 .",
    "therefore , a bb84-like situation is recovered !",
    "it is now easy to design a pns attack .",
    "first , eve counts the number of photons .",
    "similar to the b92 case , she applies the filtering two - outcome measurement when a multi - photon pulse is obtained .",
    "when the result is conclusive , she keeps the resulting photon in a quantum memory and forwards the rest of photons to bob .",
    "then , as in the bb84 case , she waits for the basis reconciliation , and performs the right von neumann measurement allowing her to read the bit .",
    "in order to make a fair comparison , we always impose the same key rate in the absence of eve as in bb84 using @xmath10 . in this case",
    "this means that we must have @xmath84 in a similar way as above for the bb84 case , one can compute eve s information for this attack .",
    "it almost coincides with the one found for the bb84 protocol , and the critical distance is again @xmath85 km ( see figure [ pnsatt ] ) .",
    "indeed , the critical distance turns out to be quite independent of the degree of non - orthogonality between the states in the 4 + 2 protocol , if one imposes the equality of the raw rates ( [ eqrat ] ) .    the analysis of the 4 + 2 protocol ends the present section .",
    "all the studied qkd schemes do not guarantee a secure key distillation when the channel attenuation is around 15 db .",
    "unfortunately , the use of non - orthogonal states has not been enough for avoiding eve s attacks .",
    "the critical distance basically corresponds to the point where the raw rate on bob s side can be simulated by the number of multi - photon pulses leaving alice s lab .",
    "the three protocols analyzed in the previous sections are not robust against pns attacks in a weak coherent pulse implementation .",
    "eve exploits the presence of multi - photon pulses and the losses on the line .",
    "indeed , at the critical distance the losses are such that she can block the pulse without being noticed when her attack has not succeeded . a possible way of avoiding this problem is to send also a strong reference pulse that _ must always be detected _ on bob s side , as in the original b92 proposal @xcite . in this way",
    ", eve can not block the pulses without introducing errors .",
    "from the implementation point of view , a new detector should be added , checking the presence of the strong pulse . in the following lines we consider these implementations from the point of view of pns attacks .",
    "we mainly concentrate on the b92 protocol although , as we will see , the same conclusions are valid for the other schemes .",
    "the information encoding uses the relative phase between a weak coherent pulse with respect to a strong reference pulse that is sent later through the line .",
    "thus , alice prepares a weak coherent pulse and a strong pulse sent as a reference , @xmath86 , where @xmath87 and @xmath44 encodes the classical bit . for a bb84 scheme , @xmath44 for one of the basis and @xmath45 for the other .",
    "note that the bb84 implementation with a strong pulse is indeed the 4 + 2 scheme @xcite .",
    "let us come back to the simplest b92 and denote by @xmath88 the ratio between the two intensities @xmath89 .",
    "the overlap between the two non - orthogonal states is @xmath90 , so @xmath91 .",
    "bob delays the weak pulse and makes it interfere with a fraction @xmath88 of the strong pulse .",
    "constructive and destructive interference correspond to the values 0 and @xmath92 .",
    "the probability of inconclusive result is @xmath93 as expected ( see @xcite for a practical implementation of this measurement ) , and the transmission rate for small @xmath5 is @xmath94 @xcite .",
    "the detection of the @xmath95 fraction of the strong reference pulse by bob should allow him to detect eve s intervention , i.e. none of the pulses can be blocked .",
    "note that this forces the strong pulse mean photon number to be significant at bob s side . however , eve can always take advantage of the multi - photon pulses for acquiring partial information .",
    "since as usual there is no global phase reference available , the effective state leaving alice s lab is @xmath96 where @xmath97 are poisson probabilities and @xmath98 in a similar way as above , one can define @xmath99 such that acting on the two - mode vacuum state gives @xmath53 .",
    "again , we have @xmath100 @xmath55=1 $ ] and @xmath56 .",
    "eve can perform a non - demolition measurement for these number states without being detected by bob . indeed , his state is the same as in eq .",
    "( [ effstb92 ] ) , just taking into account the channel attenuation .",
    "denote the channel losses by @xmath101 .",
    "since @xmath87 , eve s poisson distribution is centered around @xmath102 while bob s around @xmath103 .",
    "moreover the strong pulse must be always detected by bob , so we will impose @xmath104 ( at least ) , which means that @xmath105 . in order to make a fair comparison with the bb84 scheme using @xmath10 , we take the same raw rate in the absence of eve at the critical distance , which leads to @xmath106 and then @xmath107 , i.e. @xmath108 , and @xmath109 .    now , eve performs the measurement in the @xmath110 basis .",
    "since her poisson probability is centered around @xmath102 , she obtains a pulse containing ( on average ) @xmath102 photons . on bob s",
    "side a pulse with ten photons is expected , so eve keeps @xmath111 and forwards @xmath112 to bob by her lossless line .",
    "eve s intervention remains unnoticed to bob .",
    "eve is now faced with the problem of detecting two states having an overlap @xmath113 she applies the measurement maximizing her information @xcite , obtaining @xmath114 where @xmath115 is the binary mutual information ( in bits ) and @xmath116 is the error probability , @xmath117 it is not hard to compute the limit for eve s information . for very large distances , @xmath118 and",
    "then @xmath119 i.e. the initial overlap gives the searched limit and @xmath120 bits .",
    "thus , for any distance , the protocol is clearly secure against pns attacks .",
    "the same is valid for the strong pulse realization of the bb84 protocol , which , as said , is the 4 + 2 scheme .",
    "note that strong pulse implementations appear as an intermediate step in the transition from discrete to continuous variables qkd schemes using coherent states @xcite .",
    "there , a strong reference pulse , with very large mean photon number @xmath102 , is sent through the channel with a weaker pulse , containing about hundred photons .",
    "the security comes from the fact that although @xmath5 is not weak , an infinite range of values is used for the information encoding ( while , for example , we have only two in the b92 case ) and eve is not able to discriminate the sent state .",
    "however , many of the results presented in this section can be translated to these protocols , opening the possibility of new eavesdropping attacks @xcite .    before ending this section",
    "let us stress an important point about strong pulse qkd implementations that was somehow hidden in the previous discussion .",
    "it is important to guarantee a reasonable photon number for the strong pulse on bob s side , i.e. the condition @xmath121 must be always satisfied . therefore , @xmath102 increases with the distance up to which the key should be established .",
    "note that @xmath5 is just fixed by the desired overlap between the two states used in the b92 scheme , independently of the distance . in the previous lines we took a quite conservative value , coming from eq .",
    "( [ ratcomp ] ) .",
    "we can indeed consider @xmath122 , which gives @xmath123 and @xmath124 .",
    "this forces @xmath102 and the ratio @xmath88 to increase with the distance , which can lead to problems in the interferometric arrangement needed for detection .",
    "for instance for a distance of 80 km , that taking as usual @xmath125 means 20 db , we have @xmath126 and @xmath127 .",
    "however if these requirements are met , a secure implementation becomes possible with a key generation rate significantly larger than for the bb84 scheme using @xmath10 .",
    "for the rest of the article however , we will not consider this type of scenario and we will deal only with implementations using weak coherent pulses .",
    "the aim of the present section is to give qkd protocols resistant to the pns attack in a weak pulse implementation . from the previous discussion",
    "we can understand some of the basic requirement for these schemes .",
    "we have seen above that the apparent robustness of the 4 + 2 protocol was not true due to the existence of a quantum operation ( measurement ) , represented by ( [ filter ] ) , that allows eve to make pairwise orthogonal the states in the sets @xmath82 and @xmath83 .",
    "after successfully performing this operation , she can wait for the basis reconciliation , as in the bb84 case , and read the information by a von neumann measurement .",
    "therefore , what alice needs is a configuration of sets of states in which to encode her information such that there does not exist any quantum operation increasing , even with some probability and at the same time , the overlap of the states in each set .",
    "this is what a protocol needs to be resistant to the pns attack .",
    "a simple configuration achieving this property is the same as in the 4 + 2 , but with one of the two set of states reflected with respect to the @xmath128 plane ( see figure [ fig42 ] ) .",
    "but , even simpler , one can restrict oneself to any plane in the bloch sphere , as in the bb84 case .",
    "this situation is depicted in figure [ figst ] .",
    "the general expression for these states is @xmath129 after successfully application of the filter that makes orthogonal the states in set @xmath82 , the overlap between the states in set @xmath83 has significantly increased .",
    "indeed , it is not difficult to see that if the outcome of a quantum operation , say @xmath130 , makes orthogonal the states of set @xmath82 , for the same outcome the states in set @xmath83 are less orthogonal ( see appendix a ) .",
    "so , now eve has to consider two different filters , @xmath131 and @xmath132 , that make the states in set @xmath82 and set @xmath83 orthogonal , respectively .",
    "if she wants to get the whole information about the bit sent by alice , she has to block all the pulses with less than three photons .",
    "when the pulse contains three photons , she applies @xmath131 to the first one , @xmath132 to the second one , and only when both of them are conclusive , she forwards the third photon to bob .",
    "it is clear that the distance where eve can perform this attack without being detected is much larger than above .",
    "it basically corresponds to the point where the raw rate is equal to the number of pulses on alice s side with more than two photons .",
    "there , eve can simulate the expected raw rate using only these pulses .",
    "using this idea , we can design different state configurations .",
    "one of them turns out to be equivalent , at the quantum level , to the bb84 scheme .",
    "the states and the measurements are the same as in this protocol , the only difference being in the reconciliation process .",
    "but , surprisingly , this variation makes the protocol significantly more resistant to pns attacks .",
    "the remaining of this section will be devoted to the detailed security analysis of this protocol .",
    "the configuration of states in figure [ figst ] allows alice and bob to exchange a key in a secure way for larger distance than for many of the existing protocols . in the case",
    "in which the angle between the states in each set is @xmath133 we recover a bb84-like state configuration .",
    "nevertheless , note that alice s bit encoding has radically changed ( see figure [ figst ] ) , since orthogonal states encode the same classical bit .",
    "suppose as in the standard bb84 that alice uses as information carriers the eigenvectors of @xmath16 and @xmath17 .",
    "now , the bit 0 is encoded into @xmath14 and 1 into @xmath15 .",
    "consider the case in which alice s bit is equal to zero .",
    "she chooses randomly between @xmath14 and sends the state , say @xmath19 , to bob .",
    "bob measures randomly in the @xmath23 or @xmath24 basis .",
    "after this , alice starts the reconciliation process announcing the sent state and one of the two possible states encoding one , for instance @xmath134 .",
    "if bob s measurement was in the @xmath23 basis , the result was @xmath135 ( remember that the sent state was @xmath19 ) and he can not discriminate between the two alternatives . if bob measured in the @xmath24 basis , for half of the cases the result was + 1 and for the rest -1 . in the first case",
    ", he can not discriminate either , but in the latter , he knows for sure that the sent bit was not @xmath20 , and accepts the sent bit . at first sight this is just a simple , and not very useful , modification of the bb84 protocol .",
    "however with these variations the obtained protocol is much more resistant to eve s attacks .",
    "eve is faced with the following problem : after alice s announcement she will have to deal with one of four possible sets of two states , @xmath136 eve can unambiguously determine the sent state with some probability for all the pulses of at least three photons .",
    "indeed she measures in the @xmath23 and @xmath24 basis the two first photons , which allows her to discard two of the possibilities .",
    "then , she applies to the third photon the measurement discriminating between the two remaining states .",
    "this intuitively shows that this scheme is more robust against pns attacks , since only three - photon pulses provide her with the full information . in the next lines we will extend these ideas in a more precise way , showing that the distance for a secure implementation of this protocol is approximately twice the one for the standard bb84 .",
    "first we deal with attacks exploiting the presence of multi - photon pulses without introducing errors on bob s side .",
    "then we move to cloning - based attacks , where some error is allowed , and finally we analyze the combined action of these two eavesdropping strategies .      the first type of attacks we consider are of the same type as the pns attack for the bb84 .",
    "eve uses the multi - photon pulses for acquiring information . however , her attack can not be noticed by the honest parties because of their limited technological powers , i.e. she must not introduce errors on bob s side .    as shown above",
    ", eve can determine unambiguously the state sent by alice when the pulse contains more than three photons .",
    "this is indeed a general result : unambiguous discrimination between @xmath137 states of a two - dimensional hilbert space is only possible when at least @xmath138 copies of the state are available @xcite . in this case , the @xmath137 states @xmath139 belong to the symmetric subspace of @xmath140 of dimension @xmath137 .",
    "since the @xmath137 states are always linearly independent ( see appendix b ) , unambiguous discrimination is possible .",
    "above we have described a sequence of measurements allowing unambiguous discrimination between three copies of the four states @xmath141 .",
    "the probability of success is given by the third measurement that discriminates between two quantum states having an overlap of @xmath142 , i.e. @xmath143 .",
    "however , better strategies should be expected if one acts globally on the three copies of the unknown state .",
    "for instance , one can use the natural generalization of the povm described by eqs .",
    "( [ povm ] ) . for any @xmath144",
    "one can define @xmath145 as the state orthogonal to the three vectors @xmath146 , with @xmath147 .",
    "then , the searched measurement is given by the five positive operators summing up to the identity of @xmath148 , denoted by @xmath149 , @xmath150 the probability of having an inconclusive result is , where @xmath151 , @xmath152 indeed , this measurement is optimal if we impose that the probability of conclusive result has to be the same for the four possibilities to be distinguished .",
    "from @xcite we know that the maximal probability of unambiguous discrimination is equal to the reciprocal of the maximum eigenvalue of the operator @xmath153 which gives @xmath154 @xcite .",
    "eve s first strategy will consist of counting the number of photons on each pulse and block those with less than three photons .",
    "when at least three photons are detected , she performs the previous measurements and blocks all the instances where an inconclusive result is obtained .",
    "when she is able to determine the state , she can prepare a new copy of it for bob .",
    "again , if the channel losses are small , she must apply this strategy on a fraction of the pulses .",
    "the corresponding equations are quite similar to the ones seen above , and the critical distance corresponds to the point where @xmath155 eve s information is shown in figure [ figiepr ] , and the critical distance turns out to be of approximately 100 km .",
    "note that we take @xmath156 , in order to make a fair comparison with bb84 using @xmath10 .",
    "it is evident that for small distances , this strategy is quite inefficient from eve s point of view .",
    "indeed , for those instances it is better for her to apply a different pns attack , that we call _ storing attack _ :",
    "all single - photon pulses are blocked , while for all the multi - photon pulses , she keeps one photon in a quantum memory until the set reconciliation .",
    "then , she has to distinguish between two non - orthogonal quantum states , say @xmath19 and @xmath157 .",
    "she will apply the measurement maximizing her information obtaining ( see eq . [ infest ] ) ) @xmath158 and where the error probability is @xmath159 storing attacks are particularly dangerous as soon as there are errors in the transmission .",
    "if this is the case , the information @xmath41 is smaller than one and indeed , it may be smaller than eve s information ( see section [ secgenbas ] for a more careful analysis ) . in a similar way to that described above , depending on the channel losses ,",
    "eve can interpolate between these two attacks .",
    "the corresponding information curves are shown in figure [ figiepr ] .",
    "the presence of multi - photon pulses represents a serious drawback , since eve can take advantage of them for acquiring information on the sent bit .",
    "since we do not consider advantage distillation protocols , the honest parties can extract a key when eq .",
    "( [ prampl ] ) is satisfied .",
    "this means that the secret bit rate generation , after error correction and privacy amplification , is @xmath160 where @xmath161 is the raw rate of eq .",
    "( [ rawrate ] ) .",
    "the @xmath162 term takes into account the set reconciliation process ( bob has to choose the right measurement and obtain the right outcome ) , and the last term comes from the privacy amplification protocol .",
    "note that we assume for simplicity no errors between alice and bob , @xmath163 .",
    "there is in principle an obvious way of avoiding the influence of multi - photon pulses : to decrease the pulse mean photon number .",
    "nevertheless , this solution may be very inefficient , since the raw rate , @xmath161 , is approximately proportional to @xmath5 .",
    "therefore , there is a compromise from the point of view of key generation . using the same techniques as for figure [ figiepr ] , for any @xmath101 one can compute the optimal @xmath5 maximizing @xmath164 .",
    "the corresponding curve is shown in figure [ muopt ] .",
    "note that mean photon numbers of the order of 0.2 are indeed optimal for losses @xmath165 db .",
    "all the eavesdropping strategies studied up to now take advantage of the fact that the technological power for the honest parties has some limitations .",
    "in particular , eve uses the multi - photon pulses for acquiring information on the sent bit without introducing any error .",
    "nevertheless , the present protocol must be also analyzed under the presence of errors , even at the single - photon level .",
    "it may happen that a small amount of error would allow eve to gain a large amount of information making the protocol unpractical .",
    "indeed , these are the attacks eve would apply at very short distances , where she can not block almost any pulse and almost all the non - empty pulses reaching bob contain just one photon .",
    "the optimal individual eavesdropping strategy for this protocol is unknown .",
    "nevertheless , note that the quantum structure is the same as for the bb84 scheme , so it seems natural to consider its robustness against attacks using asymmetric phase covariant cloning machines @xcite .",
    "these machines , that are briefly described in appendix c , clone in an optimal way all the states in the @xmath128 plane .",
    "let us stress here that they provide the optimal eavesdropping for the bb84 protocol @xcite .",
    "the action of these machines in the protocol is depicted in figure [ ieclon12 ] .",
    "key distillation using privacy amplification is possible whenever eq ( [ prampl ] ) is fulfilled .",
    "this means that the honest parties can tolerate an error up to @xmath0 15@xmath166 , slightly larger than the @xmath167 for the bb84 .",
    "there are two facts in these curves that deserve explanation .",
    "first , note that the cerf cloning machine @xcite is clearly more efficient from eve s point of view than the niu - griffiths one @xcite .",
    "second , note the surprising decreasing behavior of eve s information for large values of the qber . both of them are related to the quantum correlations introduced by each of the cloning machines between eve and bob , and the sifting procedure used in the described protocol .",
    "eve waits until the sifting process before doing her measurement .",
    "if , for instance , alice announces @xmath168 and bob accepts the symbol , eve knows that bob has successfully projected onto either @xmath21 or @xmath22 .",
    "then , she modifies her quantum state according to this information . the fact that bob has got a conclusive result ( he could discriminate between the two non - orthogonal states ) increases also the distinguishability on eve s side because of the quantum correlations . on the one hand",
    ", this justifies why the cerf cloning machine is more efficient for eavesdropping .",
    "it establishes a stronger correlation between eve and bob , and this helps eve after the sifting process . on the other hand , this also explains the decreasing behavior of eve s information curves .",
    "for very large disturbances , the correlations between eve and bob decreased , and knowing that bob has obtained a conclusive result does not help her too much .",
    "thus , it is better to keep some quantum correlations with bob , in such a way that his successful unambiguous discrimination increases the distinguishability on eve s side . in the limiting case of @xmath169 ,",
    "eve just takes the state sent by alice and prepares at random one of the four possible states for bob ( or in equivalent terms , she forwards a completely noisy state ) .",
    "her information is simply given by eq .",
    "( [ infest ] ) as expected .",
    "the eavesdropping strategies analyzed up to now take advantage , either of the presence of multi - photon pulses ( pns attacks ) or of the errors on bob s side ( cloning attacks ) .",
    "however for losses such that eve can simulate the expected rate even if she blocks all the single - photon pulses , she can combine the two type of attacks , if she is allowed to introduce some errors .",
    "this basically corresponds to distances @xmath170 km ( see figure [ figiepr ] ) .",
    "there , eve counts the number of photons in the pulse and stops those having one photon .",
    "for all the two - photon pulses , she applies an asymmetric phase covariant @xmath171 cloning machine , and forwards one of the clones to bob .",
    "this operation introduces errors , depending on the quality of bob s clone . in general , for a pulse having @xmath4 photons , she uses an @xmath172 cloning machine , although in this section we consider only the @xmath171 case , since @xmath173 is significantly larger than @xmath174 .",
    "as far as we know this type of attack has been never considered before .",
    "this may explain why the expression for the phase covariant @xmath175 asymmetric cloning machine is unknown ( at least to us ) . in appendix d",
    "we describe two unitary transformations generalizing , in a non - optimal way , the asymmetric @xmath176 cloning machines to the @xmath171 case ( see also @xcite ) .",
    "eve counts the number of photons in the pulse .",
    "all the single - photon pulses are blocked , while for those pulses having two photons she applies one of the @xmath171 cloning machines shown in appendix d. in this case it is unclear which of the clone states she has to forward to bob .",
    "it turns out that for small disturbances , such that eve s information is smaller than @xmath41 , there is almost no difference between the two cases .",
    "figure [ ieclon23 ] shows the information eve can get with this strategy as a function of the disturbance on bob s side .",
    "we consider that bob receives one of the two clones with the same fidelity , i.e. either the first or the second qubit of eq .",
    "( [ clon23ngs ] ) or ( [ clon23c ] ) .",
    "key distillation is possible using error correction and one - way privacy amplification up to disturbances of approximately @xmath177 .",
    "the four - state protocol is at the level of state preparations and measurements , identical to the bb84 scheme .",
    "it only differs in the sifting process , less efficient in the absence of eve by a factor of two on the raw key , but more robust against pns attacks .",
    "thus , all the existent experimental implementations of the bb84 protocol can be thought of as implementations of the new four - state protocol .",
    "let us analyze the recent geneva - lausanne experiment @xcite , where a key was distributed over 67 km using the bb84 scheme .",
    "the mean photon number of the pulses used in this experiment was indeed 0.2 photons / pulse , so all our results directly apply . according to figure [ pnsatt ] ,",
    "the protocol is not secure at this distance because of the pns attack even for @xmath10 ( and bb84 encoding ) .",
    "however this is not the case if one uses the new protocol .",
    "the experimental qber was approximately @xmath178 , where @xmath179 was due to dark counts on the detector and @xmath180 due to optical imperfections .",
    "as said above , eve is assumed to have only access to the optical error .",
    "then @xmath181 bits , while @xmath182 ( see figure [ ieclon23 ] ) is clearly smaller than 0.5 .",
    "thus , alice and bob can safely distill a key . note that even in the more restrictive scenario where eve can take advantage of the full error ( including the detector noise ) , her information is smaller than @xmath41 and the protocol is secure .",
    "therefore , the existing implementation becomes secure just by changing the sifting process .",
    "the detailed analysis of the four - state protocol has given us insight into the way of designing qkd protocols resistant to pns attacks .",
    "the presence of multi - photon pulses is still a problem , since they open the possibility of unambiguous discrimination or storing attacks providing eve full or partial information .",
    "but there is a simple way of improving the robustness of the protocol : just adding more states for the encoding .",
    "a quite natural generalization of the previous protocol follows this idea and consists of adding more bases in a plane of the bloch sphere for the encoding of the bit , as shown in figure [ genbas ] for the case of four bases ( eight states ) . on the one hand",
    "more photons ( or copies of the unknown state ) are needed for the unambiguous discrimination to be possible . on the other hand",
    "the overlap between the two announced states decreases , which is also good against storing attacks .",
    "nevertheless , the key rate decreases unless we use a larger mean photon number , which increases the presence of multi - photon pulses , that are dangerous for the security .",
    "thus , a compromise appears .",
    "the aim of this section is to explore this fact by analyzing the resistance of this generalized protocols against the two type of attacks mentioned above : pns with unambiguous discrimination and storing attacks .",
    "any protocol is uniquely defined by the number of bases @xmath183 used for the bit encoding .",
    "we will not consider a very large number of bases , since the protocol would become impractical . in the previous sections we had @xmath184 while @xmath185 for the protocol in figure [ genbas ] .",
    "if alice wants to send a bit @xmath83 , she chooses at random between the @xmath183 states encoding @xmath83 and sends it to bob .",
    "bob measures at random in any of the @xmath183 bases .",
    "then , alice announces the sent state plus , again randomly , one of the two neighboring states ( encoding @xmath186 ) .",
    "bob accepts the bit when ( i ) he has measured in one of the two bases associated to the two states announced by alice and ( ii ) his measurement outcome is orthogonal to one of these states .",
    "indeed , this allows him to discard one of the two possibilities and to infer @xmath83 .",
    "thus , bob needs to choose the right measurement and obtain the right outcome , which happens with probability @xmath187 as usual , in order to make a fair comparison , we impose for any protocol that at very large distances ( attenuations ) the raw rate is the same as in the standard bb84 with @xmath10 .",
    "this implies that @xmath188 note that for large @xmath183 , @xmath189 .",
    "this means that the mean photon number becomes significant when @xmath183 increases and we are not longer dealing with weak pulses .",
    "therefore , some of the approximations used above ( see @xcite ) are not valid .",
    "eve has now to discriminate between @xmath190 one - qubit states , and this can be done with certainty only when @xmath191 copies of the unknown state are available ( see @xcite and appendix b ) .",
    "the maximum probability of success , @xmath192 , correspond to the maximum eigenvalue of the operator @xcite @xmath193 here @xmath194 denotes the state in @xmath195 orthogonal to all @xmath196 , where @xmath197 but @xmath198 and @xmath199 we have numerically calculated these probabilities up to @xmath200 and they appear to be given by the formula @xmath201 , although we do not have an analytical proof .",
    "the critical attenuation @xmath202 ( in db ) where the protocol ceases to be secure against this attack has to be such that eve can simulate the expected rate by the number of pulses containing at least @xmath203 photons and giving a conclusive result .",
    "this leads to @xmath204 the corresponding curve is shown in figure [ dcrit ] .",
    "there are other attacks , exploiting the presence of multi - photon pulses , that provide eve with partial information without introducing errors .",
    "for instance , eve can count the number of photons and keep @xmath205 , depending on the channel attenuation , without being detected .",
    "she waits until the basis reconciliation and performs the measurement maximizing her information ( see eq .",
    "( [ infest ] ) ) .",
    "these attacks can be very dangerous as soon as we consider errors on the transmission .",
    "we assume that the main sources of errors are the detector noise , quantified by the probability @xmath206 of having a dark count , and the optical error @xmath207 .",
    "the total @xmath208 for a channel attenuation of @xmath101 is approximately equal to @xmath209 since half of the dark counts produce a click in the wrong detector .",
    "thus , for any distance one can compute the amount of errors and the corresponding @xmath210 .",
    "if @xmath182 is larger than @xmath41 , the protocol is not secure . for any @xmath205",
    ", we can define a critical attenuation such that the honest parties can not notice eve s storing attack .",
    "this attenuation corresponds to the point where @xmath211 for intermediate attenuations ( distances ) , eve can interpolate between two attacks , as described above . in this way",
    ", we can compute the two curves @xmath41 and @xmath182 as a function of the distance .",
    "figure [ stattnb ] shows the obtained results , where we took @xmath13 , @xmath212 and @xmath213 .",
    "the point where @xmath214 provides the critical distance , @xmath215 , for this type of attacks . in figure [ dcrit ]",
    "we plot both the @xmath202 and @xmath215 as a function of @xmath183 .",
    "it is quite plausible that @xmath216 gives a good estimation for @xmath35 , the critical distance associated to the unknown optimal attack .",
    "thus , one can safely conclude that a key can be established using a reasonable number of bases up to distances of the order of 150 km @xcite .",
    "unconditional security of quantum cryptography relies on some experimental assumptions that are not achievable with present - day technology .",
    "thus , in a more realistic scenario , the honest parties have to deal with approximated single - photon sources , noisy channels , inefficient detectors and so on , while no limitation on the eavesdropper technology should be assumed .",
    "this opens the possibility for alternative eavesdropping attacks , taking advantage of alice and bob s technological imperfections . indeed , using as a reference the bb84 scheme with @xmath10 ,",
    "all the known protocols become insecure against pns attacks for channel losses of the order of 13 db .    in this article",
    "we show how to construct qkd protocols resistant against pns attacks up to channel losses of 40 db .",
    "there are two possibilities for that : ( i ) to exploit the non - orthogonality of quantum states in a different way , as in the presented four - state protocol or ( ii ) to include a strong reference pulse that must be always detected by bob .",
    "both possibilities seem achievable with current technology . in the first case , already existent implementations of the bb84 protocol @xcite",
    "provide an experimental demonstration of qkd secure against pns attacks , when the alternative sifting process is applied .",
    "the second possibility shows a connection between discrete and continuous variables qkd schemes that deserves further investigation .",
    "we thank nicolas cerf , daniel collins , norbert ltkenhaus and grgoire ribordy for helpful discussion .",
    "we acknowledge financial supports by the swiss ofes and nsf within the european project resq ( ist-2001 - 37559 ) and the national center `` quantum photonics '' .",
    "in this appendix we show that the overlap between all the states in figure [ figst ] can not be decreased by the same quantum operation . using the parametrization of eq .",
    "( [ stpar ] ) , one can see that @xmath217 where @xmath218 now , consider a quantum operation , @xmath219 , mapping with some probability @xmath220 the states in set @xmath82 into some new states , @xmath221 and @xmath222 , such that @xmath223 .",
    "this means that @xmath224 where @xmath225 .",
    "because of the linearity of quantum mechanics , the states in set @xmath83 will be mapped into @xmath226 with probability @xmath227 their overlap is @xmath228 i.e. the states in set @xmath83 become less distinguishable .",
    "in this appendix we will show that @xmath138 copies of @xmath137 one - qubit state are always linearly independent ( see also @xcite ) .",
    "consider @xmath138 copies of @xmath138 general states of one qubit , @xmath69 with @xmath229 .",
    "they belong to the symmetric subspace @xmath230 of dimension @xmath137 .",
    "our aim now is to add a new state and to see when this state can be written as a linear combination of the previous ones . in other terms , we want to find a state @xmath231 such that the determinant of the @xmath232 matrix @xmath233 is zero .",
    "note that the norm of the state does not play any role , so we can write @xmath234 where @xmath23 is an unbounded complex number . condition ( [ determ ] ) then gives an @xmath138 degree polynomial equation on @xmath23 .",
    "there are @xmath138 solutions , that correspond to the @xmath138 trivial cases @xmath235 for @xmath229 .",
    "thus , @xmath138 copies of any @xmath137 different one - qubit state are always linearly independent .",
    "in this appendix we briefly describe the asymmetric phase covariant cloning machines introduced in @xcite .",
    "these machine clone with maximal fidelity all the states that lie in the @xmath128 plane . at first sight ,",
    "their only difference is that the one in @xcite uses as an input state a two - qubit reference state plus the state to be cloned , while for the second one qubit suffices as ancillary system .",
    "consider an input state to be cloned , and a one - qubit ancillary system in a reference state , say @xmath236 .",
    "the niu - griffiths cloning machine @xcite is defined by the following unitary transformation @xmath237 with @xmath238 . from the definition it is evident that this transformation does not affect in the same way the two poles @xmath239 of the bloch sphere . nevertheless , this is not the case for those state lying in the @xmath128 plane , i.e. @xmath240 . the searched clones are the mixed local states resulting from tracing either the first or the second qubit on the state resulting from the application of eq .",
    "( [ clng ] ) , @xmath241 where @xmath242 and @xmath243 is the projector onto @xmath244 .",
    "one can easily see that @xmath245 @xmath246 then , the corresponding clone fidelities , defined as @xmath247 , are @xmath248 and @xmath249 . the larger the fidelity for the first clone , the smaller for the second .",
    "equality is achieved when @xmath250 , and then @xmath251 .    the second type of cloning machine we consider are those introduced in @xcite .",
    "there , two qubits are used as the ancillary system , and the unitary transformation is , for any input state @xmath252 , @xmath253 where @xmath254 define the standard bell basis .",
    "it is not difficult to see that the local state in the first two qubits is the same as in eq .",
    "( [ stclng ] ) , if one takes @xmath255 .",
    "eve can use these transformations in order to obtain some information about the sent bit .",
    "she clones the state sent by alice , and she forwards the first clone to bob and keeps the second .",
    "obviously there is a compromise between the quality of the two clones : the better eve s clone the worse bob s state . or in other words , the more the information intercepted by eve , the more the errors on bob s side , that allow the honest parties to detect eve s intervention . as seen above , the two machines are in many senses equivalent ( especially as far as for the cloning fidelities are concerned ) .",
    "however the two attacks differ in the amount of correlations eve establishes with bob .",
    "this fact is going to be very important for the type of protocols analyzed in this work .",
    "in this appendix we give two different unitary transformations that somehow generalizes the @xmath176 asymmetric cloning machines to the @xmath171 case . the complete description of these machines",
    "will be given elsewhere @xcite .",
    "the first machine is mainly inspired by niu - griffiths construction .",
    "the initial input state corresponds to two copies of an unknown one - qubit state , @xmath256 . using a two - dimensional ancillary system ,",
    "say in state @xmath236 , one can define the unitary operation @xmath257 as in the @xmath176 case , this machine has not the same effect on the states @xmath236 and @xmath258 .",
    "after some lengthy algebra one can see that all the states @xmath66 in the @xmath128 plane are cloned with the same fidelity .",
    "the local state of each of the three qubits is a combination of the identity with the initial pure state as expected , the fidelities being ( see also figure [ clonfid ] ) @xmath259 note that when @xmath260 , @xmath261 , slightly larger than the fidelity of the @xmath171 universal symmetric cloning of @xcite .",
    "it has to be stressed that the fidelity for the third clone never reaches the value of one , contrary to what happens for the @xmath262 case . as we learnt from the analysis of the individual attacks , in the type of protocols we analyze it is more convenient for eve to introduce an extra ancillary system in such a way that she is better correlated to bob s result",
    "this can be done introducing an ancillary system on eve s side , such that the action on the states of the computational basis is symmetrized .",
    "note that in the @xmath176 case this procedure allows to pass from the niu - griffiths to the cerf cloning machine .",
    "the resulting machine can be expressed as , @xmath263 where @xmath264 and @xmath265 has the same form as @xmath266 but interchanging zeros and ones .",
    "the cloning fidelities are again equal to eq .",
    "( [ clfidng ] ) .",
    "the second machine we consider is based on the cerf construction @xcite . as an input state we have two qubits of an unknown one - qubit state plus a two - qubit ancillary system .",
    "then , we define the following unitary operation , @xmath267 where , for @xmath268 , @xmath269 and @xmath270 .",
    "one can see that for any input state in the bloch sphere , the local state of the first two qubits are two identical clones with fidelity @xmath271 , while in the third qubit we have another clone with fidelity @xmath272 .",
    "thus , the machine ( [ clon23c ] ) is an asymmetric universal cloning machine , i.e. not phase covariant .",
    "indeed , at the point where the three fidelities are equal , we recover the @xmath171 cloning fidelity of @xcite @xmath273 ( see also figure [ clonfid ] ) . note also that in this case , @xmath274 can be equal to one . moreover , there are some points where , for a given fidelity for the first two clones , the fidelity for the third one is larger using this cloning machine than for the phase covariant machine of eq .",
    "( [ clon23ng ] ) .",
    "this shows that the latter is not the optimal phase covariant asymmetric @xmath171 cloning machine .",
    "one is tempted to generalize cerf construction in a direct way , defining a phase covariant machine by changing the coefficient of one of the error terms in ( [ clon23c ] ) . however , the resulting operation is not unitary @xcite .",
    "therefore , we can only propose two possible asymmetric phase covariant machines , although we know that they are not optimal .",
    "nevertheless , it is quite reasonable to suppose that the increase on eve s information will not be very significant when using the , at present unknown , optimal one @xcite .                                    one may think , for instance , that eve is able to shift the signals she wants to be detected into a wavelength region of higher detector efficiency . but this can be simply avoided by putting a narrow filter before the detector . or she can send pulses with large mean photon number whenever the pulse should be detected , but this produces a significant increase of the double counts when bob chooses the wrong measurement .",
    "thus , we believe the only possibility left is to give eve access to bob s detector .",
    "but then , what prevents her to control also bob s computer , i.e. to know bob s bit ?    it has been shown in w. xiang - bin , quant - ph/0110089 , that no finite coherent attack is more powerful than the incoherent one .",
    "however his demonstration does not apply to the case of a coherent attack on an infinite number of pulses .",
    "more precisely , what eve has to reproduce on bob s side is the number of non - empty pulses , @xmath275 .",
    "however , for the small mean photon numbers considered , this is approximately equal to the mean rate .",
    "note also that we take for simplicity the detector effciency equal to @xmath276 .",
    "indeed , for small @xmath5 , this factor affects in approximately the same way all the pulses , independently on whether eve performs the pns attack , since it is assumed that eve has no control on bob s detector . or , in other words , @xmath12 appears on both sides of eq .",
    "( [ qevebb84 ] ) .",
    "therefore , the critical distances do not depend on the detector efficiency .                    the optimal generalized measurement of eq . ( [ povmg ] ) in @xmath148",
    "can indeed be seen as a von neumann measurement in @xmath279 @xcite .",
    "it is very plausible that there is no measurement using just linear optics reaching the optimal probability of unambiguous discrimination .",
    "after completition of this work , the optimal @xmath171 phase covariant cloning machine was found in g. m. dariano and c. macchiavello , quant - ph/0301175 . there , the optimal fidelity is shown to be equal to @xmath280 , slightly larger than the one found here ( see appendix d ) , @xmath281",
    ".      there may be other generalizations of the initial four - state protocol .",
    "for instance , for @xmath185 , one can consider a bit encoding different from the one in figure [ genbas ] .",
    "the bit @xmath282 can be associated to the states @xmath283 , where @xmath240 , and @xmath284 to the other four states . in the sifting process",
    ", alice always announces two states having an overlap of @xmath285 , as in the initial four - state protocol . in this way , ( i ) the discrimination on bob s side is more robust against imperfect measurement apparatus and ( ii ) the probability of accepting a bit is greater , @xmath286 , and then @xmath287 only increases linearly with @xmath183 . since the mean photon number does not need to be very large for having the same key rate generation , the number of multi - photon pulses at a given distance is smaller , and the protocol is more secure against pns attacks using unambiguous discrimination .",
    "however , when one considers storing attacks , the protocol is not efficient .",
    "indeed , eve can always keep some photons , @xmath205 , without being detected and wait for alice s announcement .",
    "then , she has to distinguish between @xmath205 copies of two states with overlap @xmath142 . while @xmath205 increases with the number of bases , the overlap is independent of @xmath183 .",
    "therefore , to increase @xmath183 does not provide any advantage to the honest parties when they use this alternative encoding ."
  ],
  "abstract_text": [
    "<S> a new class of quantum cryptography ( qc ) protocols that are robust against the most general photon number splitting attacks in a weak coherent pulse implementation has been recently proposed . in this article </S>",
    "<S> we give a quite exhaustive analysis of several eavesdropping attacks on these schemes . the eavesdropper ( eve ) </S>",
    "<S> is supposed to have unlimited technological power while the honest parties ( alice and bob ) use present day technology , in particular an attenuated laser as an approximation of a single - photon source . </S>",
    "<S> they exploit the nonorthogonality of quantum states for decreasing the information accessible to eve in the multi - photon pulses accidentally produced by the imperfect source . </S>",
    "<S> an implementation of some of these protocols using present day technology allow for a secure key distribution up to distances of @xmath0 150 km . </S>",
    "<S> we also show that strong - pulse implementations , where a strong pulse is included as a reference , allow for key distribution robust against photon number splitting attacks .    </S>",
    "<S> epsf.tex    2 </S>"
  ]
}