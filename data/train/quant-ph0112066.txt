{
  "article_text": [
    "theoretical physics endeavors to produce models that predict observed physical phenomena . though sometimes the challenge is to develop a mathematical language describing the system of interest , often ( especially in the study of complex systems ) one can write down the exact dynamics and gain little insight  the resulting expressions are too cumbersome , too messy , or too ill - conditioned to be useful . by exploiting symmetries and other characteristics of the particular system , one may find a simpler equivalent description of the dynamics .",
    "this description may be further simplified by using approximation techniques , e.g. , asymptotic limits and small - parameter expansions .",
    "much of the art of the field lies in finding and choosing ad hoc methods for deriving these simpler models ; however , more systematic methods are clearly desirable .",
    "control theorists have developed a variety of _ model reduction _ techniques that systematically produce simple models of complex systems .",
    "these notes will describe _ balanced truncation _",
    "@xcite , a model reduction technique for linear systems which is readily available in a variety of formats ( e.g.  matlab ) .",
    "balanced truncation has recently been applied in physics contexts @xcite , and the results suggest it will prove a useful tool for treating large systems in both classical and quantum settings .    much of this discussion comes directly from dullerud and paganini @xcite",
    ". we will present the important concepts and results necessary to apply balanced truncation , omitting both the proofs and the algorithms .",
    "we refer the reader to @xcite and @xcite for a more complete mathematical discussion , and to matlab toolboxes and their documentation @xcite for the computational methods .    in section [ sec : inout ]",
    "we will describe the input - output paradigm of control theory , and introduce state - space models , the class of systems treatable by balanced truncation .",
    "given an arbitrary state - space model , we will characterize the smallest state - space model with identical input - output characteristics in section [ sec : minreal ] , and in section [ sec : baltrunc ] we will show how balanced truncation is used to find smaller models with controlled approximation errors .",
    "in many physics settings one is more concerned with the macroscopic behavior of a large system , and less concerned with the system s microscopic details . as an admittedly contrived example , consider a pendulum in a plane at whose free end is a tank partially filled with a classical fluid ( see fig .",
    "[ fig : pendulum ] ) .",
    "suppose that at time @xmath0 the system is at rest in its stable equilibrium , and our only method of disturbing the system is to exert a time - varying torque @xmath1 at the pivot .",
    "suppose further that we are concerned only with the time evolution of pendulum s angle @xmath2  not with the distribution of the fluid , given by some high - dimensional variable @xmath3 .",
    "]    an exact model including the full fluid state @xmath4 would give the system s exact response to a driving torque , but would be quite impractical . as we only wish to describe the angular response to the driving torque ( a mapping from one degree of freedom to another ) one",
    "suspects a lower - dimensional model might suffice .",
    "for example , one might try treating the fluid as a point mass attached to the pendulum by a non - linear spring .",
    "systems of this sort are naturally phrased in a control theory language . in the typical control scenario ,",
    "a time - varying input @xmath5 drives a system with state @xmath6 giving output signal @xmath7 , and the system dynamics have the form @xmath8 such systems are depicted by a block diagram as shown in fig .",
    "[ fig : blockdiagram ] . in the example of the pendulum ,",
    "the system s state is given by @xmath9 so as to describe the evolution with the first - order dynamics ( [ eqn : dynamics ] ) .",
    "the input to the system is @xmath10 , and the system s output is @xmath11 .    ]    together with some initial condition ( typically @xmath12 ) , the functions @xmath13 and @xmath14 in ( [ eqn : dynamics ] ) define an _ input - output map _",
    "@xmath15 taking @xmath16 to @xmath17 . since it is this relation with which we are concerned , rather than the system s internal dynamics , a theoretical model for the system will suffice if it describes @xmath15 . given some system of the form ( [ eqn : dynamics ] ) ,",
    "model reduction aims to produce simpler models ( i.e. models with a lower - dimensional state @xmath18 ) that approximate the original input - output map .",
    "we will consider models of the form @xmath19 where @xmath20 , @xmath21 , and @xmath22 , and @xmath23 , @xmath24 , @xmath25 and @xmath26 are time - independent real matrices of sizes @xmath27 , @xmath28 , @xmath29 and @xmath30 respectively .",
    "( this entire discussion also holds for complex - valued systems . )",
    "such linear models are called _ state - space models _ , and the _ order _ of a model is @xmath31 , the dimension of the state @xmath18 . for compactness ,",
    "the model with matrices @xmath23 , @xmath24 , @xmath25 and @xmath26 is denoted by @xmath32 ( this notation should not be confused with the @xmath33 matrix with blocks @xmath23 , @xmath24 , @xmath25 and @xmath26 . )",
    "often the output will only depend on the system state , i.e.  @xmath34 .",
    "consider the dynamics ( [ eqn : linear ] ) under a change - of - basis @xmath35 , where @xmath36 is invertible but need not be unitary .",
    "the dynamics may then be written as @xmath37 thus changing the basis of the state space defines a mapping on state - space models given by @xmath38 ( note that @xmath26 is unchanged . )",
    "we will call such maps _",
    "similarity transformations_. because these transformations are merely a rewriting of the system dynamics , the input - output map remains the same .    as a given state - space model is not a unique description of an input - output map @xmath15 , in the next section",
    "we ask : what is the lowest - order model with the same @xmath15 as the given model ? after finding a lowest - order exact model , we will use balanced truncation to find lower - order models approximating @xmath15 .",
    "this procedure is summarized in fig .  [",
    "fig : procedure ] .",
    "model , we first reduce the system to the lowest order @xmath39 with the same input - output map , and then reduce to an approximate model of order @xmath40.[fig : procedure ] ]",
    "to find state - space models of lowest order with the exact @xmath15 of a given model , we will split the problem into two parts : _ controllability _ and _ observability_. we will then combine these ideas to find _ minimal realizations _ of the system .",
    "assume the system is initially in the state @xmath41 ; given a time @xmath42 , the _ controllable _ states @xmath43 are those for which there is an input signal @xmath5 yielding @xmath44 .",
    "the dynamics ( [ eqn : linear ] ) can be integrated to yield @xmath45 which gives a linear map @xmath46 .",
    "the controllable states form the image of this map . since the map is linear , the image is a subspace of the state - space @xmath47 , called the _",
    "controllable subspace_. we denote this subspace by @xmath48 , as controllability only depends on the matrices @xmath23 and @xmath24 .",
    "using properties of the matrix exponential it can be shown that the controllable subspace is the image of the _ controllability matrix _ : @xmath49.\\ ] ] thus we see that @xmath50 is independent of @xmath51 . it can also be shown that the controllable subspace is the image of the _ controllability gramian _",
    ", an @xmath52 matrix given by @xmath53 and the orthogonal subspace of uncontrollable states is given by the controllability gramian s kernel .",
    "if @xmath54 ( i.e. there exists an input signal @xmath16 to prepare any state @xmath55 ) then we say that @xmath56 is a _",
    "controllable pair_.    it can be shown that given any @xmath23 and @xmath24 , we can find a similarity transformation such that the transformed matrices have the block structure @xmath57 \\;\\;\\;\\;\\ ; { \\widetilde{b } } = tb =   \\left [ \\begin{array}{c } { \\widetilde{b}}_{1 } \\\\ 0   \\end{array } \\right ] \\ ] ] with @xmath58 a controllable pair . writing the state vector as @xmath59 corresponding to this block structure",
    ", we have @xmath60 because @xmath41 , these dynamics yield @xmath61 for all time . thus the dynamics for @xmath62 reduce to @xmath63 because @xmath58 is a controllable pair , we may choose an input @xmath16 to prepare any state @xmath64 , and thus the transformed controllable subspace @xmath65 is given by the states of the form @xmath66 .",
    "the orthogonal subspace , given by states of the form @xmath67 , is irrelevant to the input - output map since no input can affect these states .",
    "we now consider another problem with a similar structure .",
    "suppose the system is in some initial state @xmath68 and @xmath69 for all time .",
    "based on the output @xmath7 for @xmath70 , can we uniquely identify @xmath71 ? integrating the dynamics ( [ eqn : linear ] ) yields @xmath72 which gives a linear map @xmath73 ( where by @xmath17 we mean the output signal @xmath7 for @xmath70 ) .",
    "suppose two initial states @xmath71 and @xmath62 give the same @xmath17 .",
    "as @xmath74 is linear , the initial state @xmath75 must give @xmath76 .",
    "we call initial states giving output @xmath76 _ unobservable _ , since any unobservable state may be added to any other initial state without changing the output .",
    "the unobservable states form the kernel of @xmath74 ; as the map is linear these states form a subspace , called the _ unobservable subspace _ and denoted by @xmath77 .",
    "it can be shown that the unobservable subspace is given by the kernel of the _ observability matrix _ : @xmath78.\\ ] ] thus @xmath77 is independent of @xmath51 .",
    "it can also be shown that @xmath77 is given by the kernel of the _ observability gramian _ @xmath79 and the orthogonal subspace of observable states is given by the observability gramian s image . if @xmath80 , then the entire space is observable , and we say that @xmath81 is an _",
    "observable pair_. as the observable states are given by the image of ( [ eqn : obs_gram ] ) and the controllable states are given by the image of ( [ eqn : con_gram ] ) , @xmath81 is an observable pair if and only if @xmath82 is a controllable pair .",
    "it can be shown that given any @xmath25 and @xmath23 , we can find a similarity transformation such that the transformed matrices have the block structure @xmath83 \\\\ \\\\ { \\widetilde{c } } & = & ct^{-1 } & = &   \\left [ \\begin{array}{cc } \\,\\;{\\widetilde{c}}_{1}\\,\\ ; & \\;0\\,\\ ;   \\end{array } \\right ] \\end{array}\\ ] ] with @xmath84 an observable pair . writing the state vector as @xmath59 corresponding to this block structure",
    ", we have @xmath85 thus the time evolution of @xmath62 is never affected by @xmath86 , and the output signal @xmath17 only depends on @xmath62 . because @xmath87 is an observable pair , we can uniquely identify an initial state @xmath88 based on @xmath17 .",
    "the transformed unobservable subspace @xmath89 is given by the states of the form @xmath67 , and is irrelevant to the input - output map since no output can be affected by these states .",
    "the notions of controllability and observability give us a means of deciding whether a state affects the system s input - output map : if a state is unobservable , it does not affect the output , and if a state is uncontrollable , it is unaffected by the input . only those states that are both controllable and observable are of relevance .",
    "we say that a state - space model given by matrices @xmath90 is a _",
    "minimal realization _ if no lower - order model gives the same input - output map @xmath15",
    ". the intuition above can be made precise as follows : it can be shown that a model is a minimal realization if and only if all states are both controllable and observable , i.e. @xmath56 is a controllable pair and @xmath81 is an observable pair .    given a state - space model given by @xmath23 , @xmath24 , @xmath25 and @xmath26 we may find a minimal realization by isolating only those dimensions which are both controllable and observable . to do so , we perform a _ kalman decomposition _ , which simultaneously performs the transformations ( [ eqn : con_separation ] ) and ( [ eqn : obs_separation ] ) as follows . for any state - space model",
    "there exists a similarity transformation such that the matrices of transformed model have the block structure @xmath91 and , writing the state vector as @xmath92 corresponding to the block structure , the controllable states are of the form @xmath93 and the observable states are of the form @xmath94 .",
    "thus only states of the form @xmath95 are both controllable and observable .    eliminating all but the states @xmath95 yields the state - space model @xmath96 since we have only eliminated states irrelevant to the input - output map",
    ", this reduced system has the exact same @xmath15 as the original system .",
    "further , since states of the form @xmath95 were both controllable and observable , @xmath97 is a controllable pair and @xmath98 is an observable pair ; thus this model is a minimal realization .",
    "sometimes the uncontrollable and unobservable states are obvious from the form of a physical system s dynamics , e.g.  some degrees of freedom are uncoupled , or some symmetry can be exploited .",
    "in other circumstances , the physics may not make it clear which states can be eliminated without affecting the input - output map . especially in the latter situation , an algorithmic method such as the kalman decomposition ( available in matlab )",
    "can be quite advantageous .",
    "nonetheless , one feels intuitively that one should always be able to find a minimal realization analytically if one is sufficiently clever .",
    "however , we do not expect in general that standard analytic methods will be useful in seeking lower - order approximations , as we will do in the next section .",
    "to apply balanced truncation , we will first assume that we have reduced the model to a minimal realization .",
    "we make the further assumption that the resulting system is exponentially stable , i.e.  all eigenvalues of @xmath23 have strictly negative real part .",
    "( various methods exist to extend these methods to unstable systems , e.g. , @xcite , but we assume stability to prove the standard result . )      in the previous section we distinguished between states that were observable and unobservable ; we now wish to quantify the observability of the observable states .",
    "to do so , consider the output signal for @xmath99 that results from the initial state @xmath100 when there is no input @xmath16 .",
    "this signal is given by ( [ eqn : output ] ) .",
    "using the @xmath101 norm for the signal @xmath17 , we have @xmath102 where @xmath103 is the observability gramian given by ( [ eqn : obs_gram ] ) with @xmath104 . recall that the kernel of @xmath103 is independent of @xmath51 , so choosing @xmath104 will not change which states are observable and which states are unobservable .",
    "( system stability is required to ensure convergence of the integral in this limit . ) scaling the norm - squared of the output by the norm - squared of the initial state yields @xmath105 which quantifies the observability of the states in the direction of @xmath71 .",
    "from ( [ eqn : obs_norm ] ) we see that the observability gramian is hermitian and positive semidefinite .",
    "as we have a minimal realization , all states @xmath71 are observable ( @xmath106 ) , and so @xmath103 is strictly positive definite .",
    "thus in geometric terms analogous to the moment - of - inertia tensor , @xmath103 defines an `` observability ellipsoid '' in the state space , with the longest principal axes along the most observable directions ( see fig .  [",
    "fig : ellipsoid ] ) .",
    "a similarity transformation given by @xmath36 transforms the observability gramian by @xmath107 .",
    "as @xmath36 need not be unitary , this transformation may rescale the ellipsoid s axes as well as rotate them .    ]",
    "we quantify controllability in a similar fashion .",
    "suppose that at a time well in the past ( @xmath108 ) the system is in the state @xmath109 , and some input @xmath5 drives the system for @xmath110 , yielding a final state @xmath68 . as we have a minimal realization , all states @xmath71 are controllable and therefore can be prepared in this fashion .",
    "for each state @xmath71 there is a minimum signal size @xmath111 required to yield @xmath100 .",
    "the smaller this minimum signal , the more sensitive this state is to the input signal . thus states with a smaller @xmath112 are said to be more controllable .",
    "consider the controllability gramian @xmath113 given by ( [ eqn : con_gram ] ) with @xmath104 .",
    "just as @xmath103 , @xmath113 is hermitian and positive semidefinite , and because we have assumed a minimal realization , @xmath113 is strictly positive definite and therefore invertible .",
    "it can be shown that @xmath114 it follows that @xmath115 which quantifies the controllability of the states in the direction of @xmath71 .",
    "just as with @xmath103 , @xmath113 defines a `` controllability ellipsoid '' in state space , with the longest principal axes along the most controllable directions .",
    "a similarity transformation given by @xmath36 transforms the controllability gramian by @xmath116 .",
    "we have thus found that the gramians give us a useful measure of a state s observability and controllability .",
    "one might ask whether the observability and controllability matrices of ( [ eqn : obs_mat ] ) and ( [ eqn : con_mat ] ) could serve a similar purpose , but in fact they are only useful for determining _ whether _ a given state is observable / controllable .",
    "one might also ask if @xmath117 is necessary  we could choose finite @xmath51 , and quantify controllability and observability on a finite time horizon .",
    "however , finite @xmath51 does not lead to the error bound in the approximations of the next section , which is the main result of these notes .      with the above quantification of observability and controllability",
    ", one might be tempted to prescribe some algorithm like eliminating the least observable or least controllable dimensions in the state space to yield a lower - order approximate model .",
    "however , such an approach would not necessarily be successful .",
    "suppose , for example , that the least observable states were in the direction of the unit vector @xmath118 , but that states in this direction were extremely controllable .",
    "thus a small signal @xmath16 might lead to the internal state @xmath119 with @xmath120 large .",
    "though this state is the least observable , @xmath120 might be sufficiently large that the resulting output signal is non - negligible .",
    "instead , we wish to use observability and controllability to yield a single measure of a state s importance to the input - output map @xmath15 .",
    "it can be shown that given two positive definite square matrices @xmath113 and @xmath103 of the same size , there exists an invertible @xmath36 such that @xmath121 where @xmath122 is diagonal with positive real diagonal entries .",
    "such a similarity transformation is called a _ balancing transformation_. geometrically , balancing transforms the observability and controllability ellipsoids so that they are identical and their principal axes lie on the coordinate axes of the state space ( see fig .  [",
    "fig : balancing ] ) .     transforms the observability and controllability ellipsoids to an identical ellipsoid aligned with principle axes along the coordinate axes.[fig : balancing ] ]    the resulting @xmath122 is unique up to permutation of the diagonal elements , so we may choose @xmath36 yielding the transformed gramians @xmath123\\ ] ] with @xmath124 .",
    "the @xmath125 are called _ hankel singular values _ ( hsvs ) ; in this transformed system @xmath125 is the quantitative measure of both the observability and controllability of the unit basis vector @xmath126 .",
    "thus the basis vectors have been sorted in order of relevance to the input - output map .",
    "once the system is balanced , we may truncate the state - space dimensions with low hsvs to yield lower - order approximate models .",
    "intuitively , the smaller the hsvs corresponding to truncated dimensions , the better the approximation .",
    "we will now make this idea precise .",
    "let the balanced state - space model with sorted hsvs be given by matrices @xmath127 , @xmath128 , @xmath129 and @xmath26 .",
    "choosing some @xmath130 such that @xmath131 is strictly greater than @xmath132 , we write the state vector @xmath133 where @xmath62 gives the first @xmath130 coordinates , and @xmath86 gives the last @xmath134 coordinates .",
    "we then write the state - space model in the corresponding block structure @xmath135 and truncate the @xmath134 least significant dimensions of the model , yielding the order @xmath130 model @xmath136 this procedure is called _ balanced truncation_.    we now give bounds on the resulting approximation error .",
    "let @xmath5 be some input signal on @xmath137 that is finite with respect to the @xmath101 norm latexmath:[\\[\\label{eqn : l_2_norm }    @xmath7 and @xmath139 be the resulting output signals of the original and truncated systems respectively .",
    "stability of the original system ( [ eqn : original ] ) and the strict inequality @xmath140 guarantees stability of the truncated system ( [ eqn : truncated ] ) ; since both systems are stable , the output signals @xmath17 and @xmath141 are also finite with respect to the norm ( [ eqn : l_2_norm ] ) , as is the error signal @xmath142 .",
    "now , letting @xmath143 be the _ distinct _ hsvs of the truncated @xmath134 dimensions , it can be shown that @xmath144 thus we have both an upper and lower bound on the worst - case errors resulting from balanced truncation .",
    "given the hankel singular values of a system , we may truncate to a system of desired order and bound the resulting error , or we may choose the order of truncation based on the maximum tolerable error .",
    "the advantages of balanced truncation as method of approximating the input - output map are two - fold .",
    "first , the error is bounded as above , in contrast to more traditional approximations where errors estimated by the order of some small parameter , e.g. @xmath145 .",
    "second , the algorithmic process is efficient .",
    "balanced truncation does not necessarily yield the _ optimal _",
    "order-@xmath130 approximation in the sense of the error bound ( [ eqn : bound ] ) , but finding the optimal approximation may be computationally difficult .    for single - input single - output systems ( i.e. @xmath16 , @xmath146 ) , the error bound may also be described in terms of frequency responses . given a sinusoidal input ,",
    "a state - space model will give an output with the same frequency and a frequency - dependent amplitude and phase shift : @xmath147 let @xmath148 and @xmath149 be the amplitude and phase shifts for the exact system , and let @xmath150 and @xmath151 be the shifts for the approximate system .",
    "writing the exact and approximate shifts in complex form , we have @xmath152 thus even though sinusoidal inputs and outputs are unbounded in the @xmath101 norm ( [ eqn : l_2_norm ] ) , the error is controlled in this fashion .",
    "according to @xcite , balanced realizations first appeared in the control literature in 1981 , and the proof of the error bound on truncated models first appeared in 1984 .",
    "until recently , however , the physics community has made little use of this powerful tool .",
    "we believe that balanced truncation will be of particular value when building simulations of and theoretical models for the evolution of macroscopic quantities in large complex systems , and it is hoped that these notes will be helpful in such studies ."
  ],
  "abstract_text": [
    "<S> balanced truncation , a technique from robust control theory , is a systematic method for producing simple approximate models of complex linear systems . </S>",
    "<S> this technique may have significant applications in physics , particularly in the study of large classical and quantum systems . </S>",
    "<S> these notes summarize the concepts and results necessary to apply balanced truncation . </S>"
  ]
}