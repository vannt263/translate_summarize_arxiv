{
  "article_text": [
    "in the supplemental material we report details on the atomic frequency comb preparation ( section i. ) , the sources of noise ( section ii . ) , the chosen strategy to suppress the technical noise ( section iii . ) , the characterization of the filter cristal ( section iv . ) , and , finally , we describe a theoretical model for the fidelity of the spin - wave storage of time - bin qubits ( section v. ) .",
    "to prepare the atomic frequency comb ( afc ) we follow the approach already described in @xcite .",
    "the frequency of the strong beam is firstly scanned by 14 mhz in 100 ms to create a wide transparency window ( also referred to as pit ) in the pr@xmath0 absorption line by spectral hole burning ( curve a in fig .",
    "[ comb ] ) . afterwards",
    "a @xmath119-wide sweep is operated outside the pit to pump the atoms back to the @xmath120 state .",
    "this creates a @xmath121-wide absorbing feature corresponding to the @xmath34 transition inside the pit , but also populates the @xmath36 state which in principle must be empty for later transfer of the input field ( see fig .",
    "1(b ) in the main text ) .",
    "thus , a clean pulse with duration of 50 ms is applied on @xmath122 transition to empty this ground state .",
    "the clean pulse also contributes to suppress the transitions of different classes of pr@xmath0 ions which might be addressed by the preparation pulses @xcite .",
    "then , a sequence of single - frequency hole - burning pulses is applied on the single class absorption feature resonant with the @xmath34 transition , each time changing the frequency by a fixed amount , @xmath7 .",
    "this sequence burns periodically spaced holes in the absorbing feature corresponding to the @xmath34 transition and anti - holes at the frequency of the @xmath122 transition , so a short burst of clean pulses is applied to maintain the @xmath36 state empty . for the afc preparation",
    "it is crucial to have a third ground state ( @xmath35 ) to use as auxiliary state where to store the excess of population resulting from the optical pumping .",
    "an example of the resulting comb structure for @xmath123 is shown in fig .",
    "[ comb ] , curve b. with the described procedure we are able to tailor absorption peaks as narrow as @xmath124 , with a comb optical depth @xmath125 and background optical depth @xmath126 .",
    "it is worth noting that the limited dynamical range of the detector might fix a higher bound for the detected peak amplitude and thus lead to an overestimated full width at half maximum .",
    "( curve b ) .",
    "the inset shows a magnification of the comb corresponding to the @xmath34 transition . ]",
    "when the memory is characterized with classical pulses , we find typical efficiency values of @xmath127 and @xmath128 .",
    "the prediction for gaussian afc peaks is @xmath129 , where @xmath130 is the effective comb optical depth @xcite .",
    "the measured value of @xmath10 is compatible with the prediction , @xmath131 , for the measured values of @xmath132 , @xmath133 and @xmath134 .",
    "for the same optical depth of our comb but assuming @xmath135 , the model predicts a maximal efficiency of @xmath136 for a finesse of @xmath137 . note that an even higher efficiency , @xmath138 , is expected for square shaped comb peak and a finesse of @xmath139 ( @xcite ) . in our case ,",
    "the achievable contrast is limited by technical reasons , such as vibrations of the cryo - cooler and finite linewidth of the laser . when measured in photon counting mode ,",
    "the efficiency is further reduced by the coincidence window taken ( containing @xmath43 of the total counts ) , by loss in the narrow - band filter ( @xmath140 ) and by instabilities due to long integration times ( @xmath140 loss ) .",
    "the full afc protocol for light storage implies the use of strong transfer pulses which are sources of different kind of noise .",
    "first of all there might be spatial leakage from the preparation / control mode into the input mode , essentially due to reflections and scatting from the optical surfaces .",
    "moreover , the control pulses might interact with the residual population left in the @xmath36 state , due to imperfect cleaning ( see section [ atomic frequency comb preparation ] ) .",
    "this interaction can give rise to coherent ( e.g. free - induction decay ) or incoherent emission .",
    "another potential source of noise in this system may arise from four - wave mixing , where the first control pulse creates spin - waves via an off - resonant raman interaction and the second control pulse reads them out as noisy photons in the same mode as the memory output .",
    "this has been identified as the main source of noise in raman type quantum memories using atomic vapors @xcite .",
    "however , this type of noise does not seem to be , at this stage , an important source of noise in our spin - wave memory .",
    "this is evidenced by the following noise measurements .",
    "first , we have measured that the two control pulses contribute equally to the noise in the echo window .",
    "this can be explained by the fact that they interact with the same number of ions giving two equally sized incoherent fluoresecence fields ( given the time scale of the storage time compared to the excited state lifetime @xmath141 = 164 @xmath142 @xcite ) .",
    "if four - wave mixing was not negligible , the noise would be suppressed by more than a factor 2 by switching off one of the two control pulses .",
    "furthermore , the noise arising from four - wave mixing would decay for increasing storage times with the same behavior of the spin - wave echo , i.e. following the inhomogeneous spin broadening ( see fig .",
    "2(c ) of the main text ) . as a matter of fact",
    ", the noise floor in our case is constant within error over the whole range of storage times investigated ( see fig . [ noisevsts ] ) .    .",
    "the error bars are calculated taking into account poissonian statistics . ]",
    "several reasons could explain this difference .",
    "first , the non - collective emission from the @xmath22d@xmath23 excited state mainly happens through intermediate crystal - field manifold and involves the coupling with the phonons of the yso matrix . as a matter of fact",
    ", the branching ratio of the spontaneous emission through the @xmath143d@xmath144h@xmath21 transition is very low ( @xmath145 ) @xcite .",
    "furthermore , among the transitions within the @xmath20h@xmath146d@xmath23 that could be off - resonantly excited by the first control pulse , many of them are characterized by relative oscillator strengths one order of magnitude lower than that employed to transfer the excitation to the ground state . during the afc preparation ,",
    "most of the ions are collected in the auxiliary @xmath35 state but , due to the relative oscillator strength of the transitions starting from it , they can only be involved in the almost closed cycle transition @xmath147 @xcite .",
    "those characterized by a non - negligible probability for off - resonant excitation either are suppressed by the state cleaning that we operate in the memory preparation ( it is the case of the transitions starting from the @xmath36 state ) or are tailored in the comb structure ( transitions having the @xmath120 as initial state ) . in the latter case",
    ", the second control pulse would give rise to a coherent emission in a well separated temporal mode with respect of the spin - wave echo .",
    "to achieve a low noise floor , @xmath148 , we use spatial , temporal and spectral filtering . as for the spatial filtering , the control and input beams are sent to the memory with a small angle , leading to an extinction of @xmath149 .",
    "temporal filtering is achieved thanks to a temporal gate implemented with two aoms .",
    "it allows us to block the leakage of the strong control beams in the signal mode .",
    "this is important not to blind the single - photon detectors , but also to avoid burning a spectral hole in the crystal filter .",
    "a diffraction grating is employed to decrease the noise originated from incoherent fluorescence .",
    "the narrow - band spectral filter is prepared simultaneously with the afc .",
    "the frequency of the filter mode ( shown in dashed red line in fig .",
    "1(a ) ) is scanned by @xmath150 around the input light frequency for 100 ms which results in a transparency window of around @xmath119 due to the power broadening effect . in order to temporally",
    "discriminate the stored and retrieved weak pulses from the portion of the fid leaking in the echo mode and happening at short time scales ( a few @xmath151 ) , the optimization of the excited state storage efficiency at long storage times is crucial . by carefully optimizing the storage times , in both the excited and ground states , and",
    "the pulse durations a compromise can be reached between the noise level and a reasonable retrieval efficiency .",
    "we provide in this section details about the noise suppression realized by the filter crystal .",
    "the main advantage of using a second crystal is that it provides a dynamical filter , whose center frequency and bandwidth can be easily tuned , as it is obtained by spectral hole burning .",
    "( b ) value as a function of the spectral hole width in the filter crystal .",
    "filled symbols : hole centered at the input pulse frequency ; open symbols : transparency window coincident with that prepared in the memory crystal ( see curve b in fig .",
    "[ comb ] ) .",
    "( c ) time histogram of the retrieved photons for different input photon numbers , @xmath38 , and a filter width of @xmath152 .",
    "the input ( @xmath41 ) and the control pulses ( measured with a reference photodetector ) are also displayed . ]",
    "[ filter](a ) represents the noise floor ( noise counts per pulse at the memory crystal ) as evaluated from noise measurements where we burn in the filter crystal spectral holes of different width centered about the input pulse frequency ( solid symbols ) .",
    "the noise in the echo window increases by one order of magnitude when the filter width increases from 0.8 to 12 mhz .",
    "the open symbol refers to the extreme case of a 14 mhz - wide transparency window coincident with the one prepared in the memory crystal to host the afc ( see curve a in fig .",
    "[ comb ] ) . here",
    "the noise floor is further doubled because the transparency window allows the control pulse frequency to pass by and reach the detector .",
    "the increase in the noise affects consequently the @xmath61 value as shown in fig . [",
    "filter](b ) .",
    "nevertheless , this value also depends on the echo counts , thus the narrowest filter width does not necessarily correspond to the best case .",
    "as a matter of fact , the best @xmath61 value is measured for a filter width which allow the major portion of the echo signal to pass by but suppresses efficiently the noise at the control pulse frequency , i.e. @xmath153 . the value of @xmath61 also depends on the echo efficiency and is thus more affected by power fluctuations than the noise floor .",
    "we believe this is the reason why its increase in the case of totally open transparency window is more pronounced than that of the noise floor ( compare filled and open symbols in panel ( a ) and ( b ) of fig .",
    "[ filter ] ) .",
    "panel ( c ) of fig .",
    "[ filter ] shows the time histogram of the retrieved photons for different input photon numbers in the case of a @xmath152-wide pit prepared in the filter crystal .",
    "finally we evaluate the extinction ratio of our @xmath153-wide spectral filter by switching off the afc and sending input pulses through the transparency window in the memory crystal firstly resonant with the filter center , then at the control pulse frequency . by comparing the total counts reaching the detector in the two cases",
    ", we estimate the extinction ratio to be about 750 .",
    "4 from the main document shows the measured total fidelity as a function of the mean photon number per qubit , @xmath89 , with a corresponding fit using the model we develop in this section .",
    "the aim of the model is to show that the reduction of the fidelity as the photons per qubit are reduced is entirely due to the noise of the memory and not due to a loss of coherence caused by e.g. phase noise in the laser .",
    "the goal of our model is to express the total fidelity as a function of the same @xmath154 parameter .",
    "firstly , let us look at the output of the memory for the two differing measurements , namely the measurement of the @xmath76 or @xmath77 qubit ( i.e. the poles of the bloch sphere ) and the measurement of the coherence between @xmath76 and @xmath77 ( i.e the equators of the bloch sphere ) .",
    "the former ( latter ) are schematically depicted in fig .",
    "[ fig : subfig1 ] ( [ fig : subfig2 ] ) .",
    "consider the example depicted in fig .",
    "[ fig : subfig1 ] , where the @xmath76 qubit has been stored and then recalled .",
    "we label the integrated counts in the window about e as @xmath156 and the integrated counts about the window l as @xmath157 , where @xmath158 is the signal ( not including the noise ) and @xmath157 is the noise .",
    "then , the fidelity is the ratio of the counts in e to the total counts over e and l , i.e. @xmath159 where @xmath160 is the signal to noise ratio .",
    "provided the efficiency and noise are the same for storing the @xmath77 qubit , @xmath161 .",
    "finally , we can express the above fidelity as a function of the @xmath61 of this measurement ( see main text for definition ) by noting that @xmath162 , where @xmath163 is the @xmath61 characteristic of the poles measurement .",
    "the expression for the fidelity becomes @xmath164 and we measure @xmath165 .",
    "now let us consider fig .",
    "[ fig : subfig2 ] , which depicts an arbitrary qubit @xmath166 being recalled , and the relative phases are such that the maximum interference is observed .",
    "firstly , the integrated counts corresponding to the window at the time labelled e - e are @xmath167 where the signal @xmath158 is the same as defined earlier . here",
    ", the signal @xmath158 is reduced by a factor of 4 , this is because the number of photons per qubit are distributed equally within the input time - bins ( factor of 2 ) and the echo is distributed equally between the output time - bins ( factor of 2 ) .",
    "the factor @xmath168 reduction in the signal is because we use different bandwidth pulses for the double write process which gives a reduced efficiency in the echo .",
    "the amount of signal in the window",
    "e - l + l - e is 4 times that of the signal in the l - l window provided the interference is fully coherent ( note the same is true for the e - e window).the resulting counts are then @xmath169 . it is worth noting that if we instead used an unbalanced mach zehnder interferometer , we would have no reduction in the signal and @xmath170 .",
    "the fidelity of the coherence measurement is obtained from the visibility of the interference fringe by @xmath171 @xcite where the visibility @xmath172 is defined as @xmath173 where max ( min ) refers to the maximum ( minimum ) integrated counts of the fringe , the max being @xmath174 and min being @xmath157 .",
    "note that we have @xmath172 in terms of the @xmath160 of the poles measurement , so the resulting fidelity can be written in terms of @xmath163 , i.e. @xmath175 where the subscript @xmath176 refers to the qubit @xmath177 ( @xmath178 ) , and we assume @xmath179",
    ". we measure @xmath168 by comparing the @xmath61 in the l - l window of figure [ fig : subfig2 ] to @xmath163 and we get @xmath180 .     with @xmath163 fixed at @xmath181 and @xmath182 .",
    "the corresponding shaded area is the 1 standard deviation of the error in this fit .",
    "the solid blue ( dashed green ) line is the classical limit obtained by a measure and prepare strategy and a memory efficiency of @xmath183 ( @xmath184 ) when testing the memory with weak - coherent states @xcite .",
    "we see that for @xmath185 the fidelity is above the classical benchmark .",
    "we show also the case of @xmath170 and @xmath186 , i.e. the case where our detection of the coherence is replaced by an unbalanced mach zehnder interferometer for example .",
    "furthermore , we show the case of @xmath170 and @xmath187 , i.e. the @xmath61 measured for the optimised pulse bandwidth case .",
    "the dash - dotted line is the classical limit for testing the memory with a single - photon fock state @xmath188 . ]",
    "now , the total fidelity is given by @xmath189 , which leads to @xmath190 + \\frac{1}{3 } \\left[1 + \\,\\frac{\\mu_q}{\\mu_q + 2\\alpha\\mu_{1p}}\\right ] , \\label{eq : ftotal}\\ ] ] concluding our simple model for the fidelity .",
    "taking the measured @xmath163 , we fit the data in fig . [",
    "fig : fvsu ] with equation [ eq : ftotal ] having @xmath168 as a free parameter .",
    "we get @xmath182 which agrees excellently with the measured value stated earlier .",
    "we therefore can conclude that the reduction of the fidelity is due to the noise on the output of the memory and not phase noise .",
    "for @xmath185 the fidelity surpasses the classical bound , remaining in the quantum regime .",
    "also in fig .",
    "[ fig : fvsu ] we plot the case for @xmath170 for @xmath186 and @xmath187 ( the case shown in fig . 2 of the main text ) .",
    "the fidelity exceeds the classical bound for photon numbers much less that 1 for these cases .    for completeness",
    ", we include table [ tab : fidelity ] which shows all the measured fidelities for every @xmath89 tested . also , we include examples of the output of the memory for early and late inputs ( fig .",
    "[ fig : polesandcoh](a ) ) and for the input @xmath166 where the phase of the double - write process is adjusted to show maximum and minimum interference in the e - l + l - e window .",
    ".fidelities @xmath191 , @xmath192 and @xmath193 for each @xmath89 tested .",
    "@xmath194 is the classical benchmark for testing the device with weak coherent states which depends on the efficiency of the memory and the input photon number used @xcite .",
    "the stated errors are one standard deviation.[tab : fidelity ] [ cols=\"^,^,^,^,^\",options=\"header \" , ]     .",
    "the vertical dashed lines correspond to the @xmath195s integration windows for the calculation of the fidelity .",
    "( b ) an example of detected counts at the output of the memory for an input qubit @xmath166 with @xmath196 .",
    "the dark blue ( light orange ) histogram shows the case when the relative phase of the double - write process is such that the interference is maximized ( minimized ) in the integration window ( indicated by the vertical dashed line ) .",
    "the pulse feature on the right corresponds to the l - l window of fig .",
    "[ fig : subfig2 ] while the e - e window is not detected here as the temporal gate is closed to negate the effects of the control pulses . ]"
  ],
  "abstract_text": [
    "<S> we demonstrate the first solid - state spin - wave optical quantum memory with on - demand read - out . using the full atomic frequency comb scheme in a pr@xmath0:y@xmath1sio@xmath2crystal , </S>",
    "<S> we store weak coherent pulses at the single - photon level with a signal to noise ratio @xmath3 . </S>",
    "<S> narrow - band spectral filtering based on spectral hole burning in a second pr@xmath0:y@xmath1sio@xmath2crystal is used to filter out the excess noise created by control pulses to reach an unconditional noise level of @xmath4 photons per pulse . </S>",
    "<S> we also report spin - wave storage of photonic time - bin qubits with conditional fidelities higher than a measure and prepare strategy , demonstrating that the spin - wave memory operates in the quantum regime . </S>",
    "<S> this makes our device the first demonstration of a quantum memory for time - bin qubits , with on demand read - out of the stored quantum information . </S>",
    "<S> these results represent an important step for the use of solid - state quantum memories in scalable quantum networks .    </S>",
    "<S> photonic quantum memories are essential in quantum information science ( qis ) where they are used as quantum interfaces between flying and stationary qubits . </S>",
    "<S> they enable the synchronization of probabilistic quantum processes e.g. in quantum communication @xcite and computing @xcite . </S>",
    "<S> the implementation of quantum memories ( qms ) for light requires strong interactions between individual photons and matter . </S>",
    "<S> this can be achieved by placing individual quantum systems ( e.g. single atoms ) in high finesse cavities @xcite or by using ensembles of atoms , where the photons are mapped onto collective atomic excitations . </S>",
    "<S> atomic systems are natural candidates as qms @xcite , but solid state systems offer interesting perspectives for scalability and integration into existing technology @xcite .    rare - earth ion doped solids are promising candidates for high performance solid state qms since they have excellent coherence properties at cryogenic temperatures @xcite </S>",
    "<S> . they also exhibit large static inhomogeneous broadening of the optical transitions which can be tailored and used as a resource for various storage protocols , e.g. enabling temporally @xcite and spectrally @xcite multiplexed quantum memories . </S>",
    "<S> recent experimental progress includes qubit storage @xcite , highly efficient quantum storage of weak coherent states @xcite , storage of entangled and single photons @xcite , entanglement between two crystals @xcite and quantum teleportation @xcite .    yet </S>",
    "<S> , nonclassical states have so far only been stored as collective optical atomic excitations with fixed storage times @xcite . </S>",
    "<S> while this may provide a useful resource if combined with massive multiplexing and deterministic quantum light sources @xcite , the ability to read - out the stored state on - demand is essential for applications where the quantum memory is used as a synchronizing device . on - demand </S>",
    "<S> read - out can be achieved by actively controlling the optical collective excitations @xcite , with a storage time limited by the coherence of excited states . </S>",
    "<S> another solution is to transfer the optical excitations to long lived collective spin excitations ( or spin - waves ) , using strong control pulses @xcite . </S>",
    "<S> this gives access to much longer storage times @xcite . </S>",
    "<S> operating a solid state spin - wave memory in the quantum regime has so far remained elusive , because of insufficient signal - to - noise ratio ( snr ) at the single - photon level @xcite .    here , using the full atomic frequency comb ( afc ) protocol in a pr@xmath0:y@xmath1sio@xmath2crystal we store and retrieve weak coherent pulses on - demand with snr @xmath5 10 for single - photon - level input . using a narrowband filter based on spectral hole burning in a second crystal , </S>",
    "<S> we achieve an unconditional noise floor of @xmath6 photons per pulse . </S>",
    "<S> the use of spectral holes as narrowband filters has been already demonstrated in storage schemes operating in a classical fashion @xcite , but it is here exploited for the first time to enter the quantum regime . </S>",
    "<S> finally , we demonstrate storage and retrieval conditional fidelities ( i.e. , assuming that a photon was reemitted ) higher than classical memories for time - bin qubits at the single - photon level , taking into account the poissonian statistics and the finite efficiency of the memory . </S>",
    "<S> these results represent the first demonstration of a solid state spin - wave quantum memory , enabling on - demand read - out of the stored qubits . </S>",
    "<S> they also provide the first example of a spin - wave quantum memory for time - bin qubits ( for any system ) , an essential resource in quantum communication @xcite and processing @xcite .    </S>",
    "<S> the afc technique @xcite is based on spectral tailoring of an inhomogeously broadened absorption line into a comb - shaped structure with periodicity @xmath7 . </S>",
    "<S> the input pulses resonant with the comb are mapped onto a collective optical atomic excitation . </S>",
    "<S> after an initial dephasing , the excitations rephase at a time @xmath8 giving rise to a forward collective emission @xcite . before the coherent emission two strong control pulses are applied to transfer the excitation to and from a long - lived ground state to achieve the spin - wave storage of the input pulses . </S>",
    "<S> the full afc scheme requires ions with at least three ground states , one being used as auxiliary state for optical pumping @xcite . </S>",
    "<S> the spin - wave storage efficiency is given by @xmath9 , where @xmath10 is the efficiency of the storage at the excited state and depends on the optical depth and comb finesse @xcite , @xmath11 accounts for the decoherence during the ground state storage , and @xmath12 is the transfer efficiency of the control pulses .    </S>",
    "<S> the realization of the full afc scheme in the single - photon regime is challenging as the strong control pulses create noise which may dominate the weak signal retrieved from the memory . </S>",
    "<S> two main mechanisms are responsible for this noise . </S>",
    "<S> i ) spatial leakage from the control mode into the input mode due to scattering from the optical surfaces and ii ) interaction of the control pulses with residual population in the spin storage state due to imperfect optical pumping . </S>",
    "<S> the latter includes collective effects , such as free - induction decay ( fid ) , or incoherent fluorescent emission . </S>",
    "<S> note that four - wave mixing is not a dominant source of noise in our system , in contrast to raman memories in atomic vapors @xcite ( see @xcite for details ) . to reduce the noise we employ spatial , temporal and spectral filtering . </S>",
    "<S> the spectral filtering is challenging in pr@xmath0:y@xmath1sio@xmath2 , as the input and control frequencies are separated by only @xmath13 ( see fig . </S>",
    "<S> [ setup](b ) ) . as a narrow - band spectral filter </S>",
    "<S> we use a second pr@xmath0:y@xmath1sio@xmath2crystal where we prepare spectral holes of variable width @xcite .    . </S>",
    "<S> they are both @xmath14 long and doped with a pr@xmath0 concentration of @xmath15 . </S>",
    "<S> the control and input beams are steered towards the memory with an angle of @xmath16 , leading to a exctinction ratio of 10@xmath17 . </S>",
    "<S> the beam diameters on the crystal are @xmath18 and @xmath19 for strong and input modes , respectively . </S>",
    "<S> the weak coherent states are prepared by attenuating bright pulses with variable neutral density filters ( ndfs ) . </S>",
    "<S> a portion of the input beam is picked up before the ndf and sent to a photodiode ( pd1 ) for the calibration of the mean photon number per pulse . </S>",
    "<S> a mechanical shutter is used to protect the spd during the memory and filter preparation . </S>",
    "<S> hwp : half - wave plate ; aom : acousto - optical modulator ; dg : diffraction grating ; spd : single - photon detector . </S>",
    "<S> the dashed red beam indicates the filter preparation mode . </S>",
    "<S> ( b ) hyperfine splitting of the first sublevels of the ground @xmath20h@xmath21 and the excited @xmath22d@xmath23 manifold of pr@xmath0 in y@xmath1sio@xmath2 . ]    the experimental arrangement and the relevant energy level scheme of pr@xmath0 at @xmath24 are shown in fig . </S>",
    "<S> [ setup ] . </S>",
    "<S> the main laser beam at @xmath24 ( toptica ta - shg pro ) is split into three to be used as input mode , filter preparation , and lastly for control pulses and memory preparation . </S>",
    "<S> they all pass through acousto - optical modulators ( aoms ) in double - pass configuration , driven by an arbitrary waveform generator ( signadyne ) , to create the necessary pulse sequences . </S>",
    "<S> the beams are then carried with polarization - maintaining single - mode optical fibers to another optical table where the cryostat is located . </S>",
    "<S> the maximum available optical powers are about 20 mw , 3.5 mw and 150 @xmath25w for control , filter preparation , and input modes , respectively , measured in front of the cryostat . </S>",
    "<S> the frequency of the @xmath24 laser is stabilized by pound - drever - hall technique to a home - made temperature controlled fabry - perot cavity housed in a vacuum chamber . </S>",
    "<S> the input light is linearly polarized close to the optical @xmath26 axis to maximize the interaction with the pr@xmath0 ions . </S>",
    "<S> the measured optical depth of the pr@xmath0 transition at @xmath24 is about 7 for both memory and filter crystal . in both cases , </S>",
    "<S> the inhomogeneous linewidth is about @xmath27 . </S>",
    "<S> after the storage , the retrieved signal passes through different diffraction order modes ( -1st and 1st ) of two consecutive aoms , acting as temporal gate before passing through the filter crystal . </S>",
    "<S> a diffraction grating ( dg ) is then used to filter the noise not resonant with the crystal . </S>",
    "<S> the retrieved signal is coupled with @xmath28 efficiency into a single - mode fiber for connection to the single photon detector ( spd , picoquant @xmath29 spad-20 , detection efficiency @xmath30 , dark count rate @xmath31 ) . </S>",
    "<S> the total transmission of the input beam from the cryostat to the spd is about @xmath32 .    </S>",
    "<S> we tailor the afc using optical pumping techniques as described in @xcite . </S>",
    "<S> we isolate a single class of atoms @xcite and create a @xmath33 wide afc with @xmath7 = 200 khz on the @xmath34 transition within a 14 mhz wide transparency window ( see @xcite for details and for a comb example ) . during the preparation of the memory , the population removed from the comb is stored in the auxiliary @xmath35 state , while the @xmath36 is emptied . to further remove unwanted residual population in the @xmath36 state </S>",
    "<S> , we apply an extra series of 100 pulses on the @xmath37 transition after the comb preparation . </S>",
    "<S> we then start the single - photon - level storage measurements . </S>",
    "<S> weak gaussian input pulses with full width at half maximum ( fwhm ) duration of 430 ns and mean photon number @xmath38 are mapped on the afc and transferred to spin - waves thanks to a strong control pulse . </S>",
    "<S> the control pulses have a gaussian temporal profile with fwhm of 700 ns and are spectrally chirped by @xmath39 about the @xmath37 transition . </S>",
    "<S> for each comb preparation , 1000 storage trials are perfomed with a repetition rate of @xmath40 . </S>",
    "<S> the full cycle has a period of 700 ms , including memory preparation and light storage . </S>",
    "<S> it is synchronized with the cryostat cycle to reduce the effect of vibrations . </S>",
    "<S> the sequence is then repeated 500 to 1000 times to acumulate sufficient statistics .     </S>",
    "<S> wide is prepared in the filter crystal . </S>",
    "<S> the input ( @xmath41 ) and the control pulses , as measured in photon counting and from a reference photodiode ( pd2 in fig . [ setup ] ) , respectively , are also displayed . </S>",
    "<S> the chosen @xmath42 wide detection window is indicated by the dashed lines about the three - level echo ; it includes @xmath43 of the counts in the full echo mode . </S>",
    "<S> ( b ) . signal - to - noise ratio ( snr ) as a function of the number of input photons for different filter width . </S>",
    "<S> circles : @xmath44 ; squares : @xmath45 . </S>",
    "<S> the error bars ( smaller than the data points ) are evaluated with poissonian statistics . </S>",
    "<S> the black dotted line indicates the limit of detection snr = 1 . </S>",
    "<S> the dashed lines are linear fits of the experimental data . </S>",
    "<S> panel ( c ) . </S>",
    "<S> decay of the snr as a function of the spin - wave storage time t@xmath46 with average photon number @xmath47 . from the fit with a gaussian profile </S>",
    "<S> , the spin inhomogeneous broadening @xmath48 can be extrapolated . by comparing the snr that we measure at a storage time @xmath49 with the extrapolation at @xmath50 </S>",
    "<S> , we can evaluate the decoherence term @xmath11 to be about @xmath51 . ]    fig . </S>",
    "<S> [ snr](a ) shows the time histograms of the retrieved photons with different @xmath38 . for this measurement </S>",
    "<S> , the crystal filter has a hole width of 2 mhz . </S>",
    "<S> the spin - wave storage time is t@xmath52 = 7.8 @xmath25s , leading to a total storage time of @xmath53 . from the trace with @xmath54 </S>",
    "<S> , we estimate an unconditional noise floor of @xmath6 photons per pulse at the memory crystal . for @xmath55 , </S>",
    "<S> we measure snr = @xmath56 . </S>",
    "<S> the linear scaling of the echo snr with respect to increasing @xmath38 is shown with blue circles in fig . </S>",
    "<S> [ snr](b ) . </S>",
    "<S> typical values of efficiencies are @xmath57 and @xmath58 , from which we deduce @xmath59 ( assuming @xmath60 @xcite ) </S>",
    "<S> . a convenient figure of merit taking into account the noise and efficiency is given by the minimum @xmath38 necessary to detect a spin - wave echo with snr = 1 , called @xmath61 . </S>",
    "<S> from the linear fit of the experimental data of fig . [ </S>",
    "<S> snr](b ) , we find @xmath62 . </S>",
    "<S> we then vary @xmath63 by changing @xmath64 with @xmath65 , as shown in fig . </S>",
    "<S> [ snr](c ) . </S>",
    "<S> the decay in the snr is compatible with a spin inhomogeneous broadening of @xmath66 , similar to previous measurements with bright pulses @xcite . </S>",
    "<S> we still observe snr @xmath67 for @xmath68 ( @xmath69 ) .    </S>",
    "<S> we can estimate the contribution of the filter crystal in the suppression of the noise by preparing a wider transparency window . for a filter width of @xmath70 ( squares in fig . </S>",
    "<S> [ snr](b ) ) there is no filtering at the control frequency , and we observe an increase of the noise floor to @xmath71 together with a slightly higher retrieval efficiency ( @xmath72 ) , which results in @xmath61 values up to about 1 . </S>",
    "<S> when the filter crystal is by - passed , the noise floor raises to @xmath73 , indicating that the inhomogeneously broadened absorption profile of pr@xmath0 also contributes to partially filter the noise @xcite . </S>",
    "<S> nonetheless , for this set of measurements , we were able to achieve higher storage efficiency , i.e. @xmath74 , leading to a limited increase of the @xmath61 to about 4 .    for applications in qis , it is crucial that the optical memory preserves the coherence of the stored qubits . </S>",
    "<S> we take advantage of the intrinsic temporal multimodality of the afc protocol to demonstrate the phase preservation in the spin - wave storage of time - bin qubits . </S>",
    "<S> this type of encoding is widely used in quantum communication as it is robust against decoherence in optical fibers @xcite . </S>",
    "<S> the time - bin qubits are expressed as @xmath75 , where @xmath76 ( @xmath77 ) represents a qubit in the early ( late ) time - bin , @xmath78 is their relative phase , and @xmath79 . in order to store time - bin qubits , the duration of the input pulses is reduced ( from @xmath80 to @xmath81 ) , leading to a reduction of @xmath82 to about @xmath83 and to an increase of the @xmath61 up to @xmath84 . </S>",
    "<S> we start by evaluating the fidelity of the states @xmath76 and @xmath77 , located at the poles of the bloch sphere , @xmath85 and @xmath86 , by storing only the early and the late qubits . </S>",
    "<S> we obtain average fidelity values for the poles ranging from @xmath87 to @xmath88 for photon number per qubit , @xmath89 , going from 0.6 to 5.9 @xcite . </S>",
    "<S> +     in order to split each pulse into two temporally separated echoes . if the delay between the time - bins @xmath76 and @xmath77 is equal to the time difference between the two write pulses , we can overlap the late echo of the early bin , @xmath90 , with the early echo of the late bin , @xmath91 . </S>",
    "<S> the output of the memory ( occurring after the single read pulse @xmath92 ) has three time - bins , latexmath:[$\\{|ee\\rangle ,    the central time - bin if the coherence is preserved . </S>",
    "<S> the input pulses , located at @xmath76 and @xmath77 have a relative phase difference of @xmath94 . </S>",
    "<S> ( b ) interference fringes obtained integrating over the central output time - bin ( in this case @xmath95 ) as a function of the relative phase difference @xmath96 for @xmath97 . </S>",
    "<S> circles : @xmath98 , @xmath99 ; squares : @xmath100 , @xmath101 . ]    </S>",
    "<S> we then store superposition states located on the equator of the bloch sphere . </S>",
    "<S> we use the memory itself to analyze the retrieved qubits @xcite applying two partial write pulses as depicted in fig . </S>",
    "<S> [ time - bin](a ) . </S>",
    "<S> this method provides a convenient way of analyzing time - bin qubits , but has the drawback of reducing the storage efficiency . as a matter of fact , in order to insert two write pulses </S>",
    "<S> , their duration needs to be reduced , which decreases their efficiency . </S>",
    "<S> fig . </S>",
    "<S> [ time - bin](b ) reports examples of interference fringes for @xmath97 . from sinusoidal fits , </S>",
    "<S> we obtain a raw mean visibility of @xmath102 . </S>",
    "<S> the fidelity of the process is calculated from the visibility , as @xmath103 @xcite . </S>",
    "<S> finally , we obtain a total conditional fidelity per retrieved qubit @xmath104 = @xmath105@xmath106 + @xmath107@xmath108 , where @xmath109 ( @xmath110 ) is the average fidelity over the poles ( equator ) basis . </S>",
    "<S> the obtained values are reported in fig . </S>",
    "<S> [ fvsu ] for different @xmath89 . </S>",
    "<S> we observe that the fidelity decreases with @xmath89 . </S>",
    "<S> to explain this behavior , we fit our data with a simple model taking into account the decrease of snr with @xmath89 and the reduced efficiency due to the double write protocol @xcite . </S>",
    "<S> the good agreement between the simple model and the data provides evidence that the decrease of fidelity is only due to the noise created by the control pulses , and not to a loss of coherence .    in order to infer the quantum nature of our memory , </S>",
    "<S> the total fidelity is compared with the highest fidelity achievable with a measure - and - prepare approach ( solid curve in fig . </S>",
    "<S> [ fvsu ] ) taking into account the poissonian statistics of the input states and the finite memory efficiency ( @xmath83 ) @xcite . using this criteria , the experimental data are higher than the limit for a classical memory by more than one standard deviation for most @xmath89 investigated . with the raw data , </S>",
    "<S> the memory is in the quantum regime for @xmath111 . </S>",
    "<S> when correcting for the loss of efficiency in the analysis ( which could be achieved by analyzing the qubits with an external interferometer ) , the model predicts that the quantum regime would be reached for @xmath112 ( see @xcite ) .    </S>",
    "<S> the very low noise probability and the ability to obtain @xmath113 opens prospects for the spin - wave storage of single - photons , as required for many applications in qis . in that case </S>",
    "<S> , the probability to have a photon before the memory ( i.e including all optical loss between source and memory ) needs to be higher than @xmath61 to enter the quantum regime . in the current experiment , </S>",
    "<S> the storage efficiency is limited by the available comb optical depth in our 3 mm long crystal , by the limited transfer efficiency ( @xmath114 ) and by technical issues ( cryostat vibrations , laser linewidth , see @xcite ) . </S>",
    "<S> note that much higher efficiencies ( for storage in the excited state ) have been obtained in pr@xmath0:y@xmath1sio@xmath2using longer crystal ( 69 @xmath115 ) @xcite or impedance matched cavities ( 58 @xmath115 ) @xcite . </S>",
    "<S> longer storage times can also be achieved with dynamical decoupling techniques to counteract decoherence in the spin state @xcite .    . </S>",
    "<S> the light orange squares are the data points with an error bar of 1 standard deviation . </S>",
    "<S> the orange dotted line is a fit to the data points using eq . </S>",
    "<S> ( 5 ) in @xcite , with the corresponding shaded area being the 1 standard deviation of the error in this fit . </S>",
    "<S> the solid blue ( dashed green ) line is the classical limit obtained by a measure and prepare strategy for our memory efficiency of @xmath116 ( @xmath117 ) when testing the memory with weak coherent states @xcite . the dash - dotted line is the classical limit for testing the memory with a single - photon fock state @xmath118 . ]    in conclusion , we demonstrated the spin - wave storage and on - demand retrieval of weak coherent states at the single - photon level in a solid state memory based on a pr@xmath0:y@xmath1sio@xmath2crystal . </S>",
    "<S> this is the first demonstration that solid state spin - wave optical memories can operate in the quantum regime , overcoming a strong limitation for afc qms . </S>",
    "<S> we achieved a snr higher than 10 for single - photon level input pulses , high enough to enable the storage of single photons . </S>",
    "<S> finally , we confirmed the quantum nature of our memory by storing time - bin qubits encoded in weak coherent states and demonstrating conditional fidelities for the retrieved qubits higher than what is possible with classical memories . </S>",
    "<S> our device thus represents the first spin - wave memory for photonic time - bin qubits . </S>",
    "<S> these results open the door for long - lived storage and on - demand readout of non - classical light states in solid state devices and represent an important step in view of using solid state quantum memories in scalable quantum architectures .    * acknowledgements . * </S>",
    "<S> we acknowledge financial support by the erc starting grant qulima , by the spanish ministry of economy and competitiveness ( mineco ) and the fondo europeo de desarrollo regional ( feder ) through grant fis2012 - 37569 , by the european project chist - era qscale and by the people programme ( marie curie actions ) of the eu fp7 under rea grant agreement no . </S>",
    "<S> 287252 . </S>"
  ]
}