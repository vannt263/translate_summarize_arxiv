{
  "article_text": [
    "in this section , we give more details on the calculation of the classical benchmark presented in fig .",
    "@xmath99 of the main manuscript .",
    "the general idea is to estimate what is the best efficiency that can be obtained using a classical method .",
    "in particular , we consider a measure and prepare strategy where the user performs a classical state estimation on the input qubit , stores the result in a classical memory and prepares a new qubit according to the result obtained . the maximum achievable classical fidelity for a state with a fixed photon number @xmath85 is known to be @xcite @xmath100",
    "if one tests a memory with a true single photon input then the classical bound is @xmath101 .",
    "if one uses weak coherent states then one has to consider the finite probability of having more than one photon .",
    "a pulse of light with mean photon number @xmath102 has a probability distribution of a poissonian , given by @xmath103 then , the maximum achievable fidelity becomes a weighted sum over @xmath85 of the fidelity for a given @xmath85 where the weight is given by the poissonian statistics of the input @xcite .",
    "we state this below as @xmath104    this formula is valid if one assumes that the quantum memory has a storage and retrieval efficiency @xmath105 . if @xmath106 , a more sophisticated classical strategy could simulate non - unit efficiency by only giving a result for high photon number @xmath85 , resulting in a higher achievable fidelity , as suggested in @xcite .",
    "we consider that the classical measure and prepare strategy has an efficiency of 1 , but we define the effective classical efficiency @xmath107 as the probability that the classical device gives an output qubit , if it has received at least one photon as input :        note that the photon number statistics of the output qubit is not relevant in our case , since we use non photon number resolving detectors .",
    "the classical memory gives a result for some threshold photon number @xmath110 and above , and no result for @xmath85 lower than this .",
    "it is important to note that for the above there exists only certain @xmath111 for a given mean photon number @xmath6 .",
    "hence , not all quantum efficiencies can be simulated .",
    "a more general form of @xmath112 which allows for arbitrary number and hence efficiency is the following @xmath113 where now the memory gives a result for @xmath114 with a probability of @xmath115 , with the condition @xmath116 .      .",
    "plotted above is the probability distribution for a coherent state of @xmath121 .",
    "the target efficiency here is @xmath122 . for this target efficiency @xmath123 ,",
    "found using equation [ eq : nmin ] .",
    "the grey shaded part of bar @xmath124 plus the black bars @xmath125 equate to the @xmath122 target efficiency.,scaledwidth=45.0% ]    the maximum achievable classical fidelity using the above described strategy is then @xmath126 where @xmath115 and @xmath114 are obtained from equations ( [ eq : eta ] , [ eq : nmin ] ) .",
    "figure [ fig : f ] shows the fidelity as a function of mean photon number @xmath6 for various efficiencies @xmath127 .     for different memory efficiencies @xmath127 ( eq . [ eq : eta ] ) .",
    "the cases shown are @xmath128 .",
    "the solid lines are calculated using equation [ eq : f ] , the dots are calculated using equation [ eq : f100 ] . it is seen that for @xmath129 , equation [ eq : f ] reduces to equation [ eq : f100 ] . the dashed line is for the single photon case @xmath130.,scaledwidth=45.0% ]    note that the classical memory could also in principle take advantage of the optical loss and the finite detection efficiencies in the experiment to increase the maximal classical fidelity .",
    "in that case , we would have @xmath131 , where @xmath132 is the optical transmission from the quantum memory to the detector and @xmath133 is the detection efficiency of the spd . for our experiment , we have @xmath134 , @xmath135 and @xmath136 such that in that case @xmath137 ."
  ],
  "abstract_text": [
    "<S> we report on the quantum storage and retrieval of photonic polarization quantum bits onto and out of a solid state storage device . </S>",
    "<S> the qubits are implemented with weak coherent states at the single photon level , and are stored for @xmath0 in a praseodymium doped crystal with a storage and retrieval efficiency of @xmath1 , using the atomic frequency comb scheme . </S>",
    "<S> we characterize the storage by using quantum state tomography , and find that the average conditional fidelity of the retrieved qubits exceeds @xmath2 for a mean photon number @xmath3 . </S>",
    "<S> this is significantly higher than a classical benchmark , taking into account the poissonian statistics and finite memory efficiency , which proves that our device functions as a quantum storage device for polarization qubits , even if tested with weak coherent states . </S>",
    "<S> these results extend the storage capabilities of solid state quantum memories to polarization encoding , which is widely used in quantum information science .    </S>",
    "<S> the ability to transfer quantum information in a coherent , efficient and reversible way from light to matter plays an important role in quantum information science @xcite . </S>",
    "<S> it enables the realization of photonic quantum memories ( qm ) @xcite which are required to render scalable elaborate quantum protocols involving many probabilistic processes that have to be combined . </S>",
    "<S> a prime example is the quantum repeater @xcite , where quantum information can be distributed over very long distances . </S>",
    "<S> other applications include quantum networks @xcite , linear optics quantum computation @xcite , deterministic single photon sources @xcite and multiphoton quantum state engineering .    </S>",
    "<S> proof of principle experiments demonstrating photonic qms have been reported in different atomic systems such as cold @xcite and hot atomic gases @xcite , single atoms in cavities @xcite and solid state systems @xcite . in recent years , solid state atomic ensembles implemented with rare - earth </S>",
    "<S> doped solids have emerged as a promising system to implement qms . </S>",
    "<S> they provide a large number of atoms with excellent coherence properties naturally trapped into a solid state system . </S>",
    "<S> in addition , they feature a static inhomogeneous broadening that can be shaped at will , enabling new storage protocols with enhanced storage properties ( e.g. temporal multiplexing ) @xcite . </S>",
    "<S> finally , some of the rare - earth doped crystals ( e.g. praseodymium and europium doped crystals ) possess ground states with extremely long coherence times @xcite ( @xmath4 seconds ) , which hold promise for implementing long lived solid state quantum memories .    </S>",
    "<S> recent progress towards solid state qms include the storage of weak coherent pulses at the single photon level @xcite , the quantum storage of coherent pulses with efficiency up to @xmath5 @xcite , the spin state storage of bright coherent pulses @xcite and the storage of multiple temporal modes in one crystal @xcite . </S>",
    "<S> very recently , these capabilities have been extended to the storage of nonclassical light generated by spontaneous down conversion , leading to the entanglement between one photon and one collective atomic excitation stored in the crystal @xcite , and entanglement between two crystals @xcite .    all previous experiments with solid state </S>",
    "<S> qms have been so far limited to the storage of multiple modes using the time degree of freedom , e.g. time bin or energy time qubits . </S>",
    "<S> however , quantum information is very often encoded in the polarization states of photons , which provide an easy way to manipulate and analyze the qubits . extending the storage capabilities of solid state qms to polarization encoded qubits would thus bring much more flexibility to this kind of interface . </S>",
    "<S> unfortunately , storing coherently polarization states is not straightforward in rare - earth doped crystals . </S>",
    "<S> the main difficulty is that these crystals have in general a strongly polarization dependent absorption . </S>",
    "<S> storing directly a polarization qubit in such a system would result in a severely degraded fidelity of the retrieved qubits .    in this paper </S>",
    "<S> , we report on the storage and retrieval of a photonic polarization qubit into and out of a solid state quantum storage device with high conditional fidelity . </S>",
    "<S> the photonic qubits are implemented with weak coherent pulses of light , with a mean photon number @xmath6 from @xmath7 to @xmath8 . </S>",
    "<S> we measure the conditional fidelity @xcite of the storage and retrieval process ( i.e. assuming that a photon was re - emitted ) and compare it to classical benchmarks . with this procedure </S>",
    "<S> , we can show that our crystal behaves as a quantum storage device , even if tested with classical , weak coherent pulses . </S>",
    "<S> we overcome the difficulty of anisotropic absorption by splitting the polarization components of the qubit and storing them in two spatially separated ensembles within the same crystal @xcite .    </S>",
    "<S> our memory is implemented using a @xmath9 long @xmath10 crystal ( @xmath11 ) . </S>",
    "<S> the relevant atomic transition connects the @xmath12 ground state to the @xmath13 excited state and has a wavelength of @xmath14 . </S>",
    "<S> each state has three hyperfine sublevels as shown in fig . </S>",
    "<S> [ setup ] . </S>",
    "<S> the measured maximal optical depth at the center of the @xmath15 inhomogeneous line is @xmath16 . </S>",
    "<S> we use the atomic frequency comb ( afc ) scheme to store and retrieve the qubits @xcite . </S>",
    "<S> this requires to shape the inhomogeneous absorption profile into a series of periodic and narrow absorbing peaks , placed in a wide transparency window . </S>",
    "<S> this creates a frequency grating and when a photon is absorbed by the comb , it will be diffracted in time and re - emitted after a pre - determined time @xmath17 , where @xmath18 is the spacing between absorption peaks .    . </S>",
    "<S> both beams are amplitude and frequency modulated using an acousto - optic modulator ( aom ) . </S>",
    "<S> the polarization of the preparation beam is set to @xmath19 degrees , while the polarization of the qubit beam can be set arbitrarily with a half wave plate ( hwp ) and a quarter wave plate ( qwp ) . </S>",
    "<S> the qubit beam is attenuated down to the single photon level using neutral density filters ( ndf ) . </S>",
    "<S> the two beams are recombined at a beam splitter ( bs ) and sent to the storage device which is composed of a @xmath10 crystal cooled to @xmath20 , two beam displacer ( bd ) and two hwp . </S>",
    "<S> the light released by the memory is then sent to a polarization analyzer composed of a hwp , a qwp and a polarization beam splitter ( pbs ) , before being detected with a single photon detector ( spd ) . </S>",
    "<S> the two mechanical shutters ( s1 and s2 ) are used to suppress optical noise from the preparation beam and to protect the spd . </S>",
    "<S> ( b ) storage and retrieval of a weak @xmath21 qubit with duration @xmath22 and @xmath3 . </S>",
    "<S> the temporal histogram of the detection without ( dotted line , empty pit ) and with ( solid line ) afc is shown . </S>",
    "<S> the dashed lines around the afc echo show the detection window . </S>",
    "<S> inset : level scheme of @xmath10 with the dashed arrows showing the relevant transition for photon absorption and re - emission . ]    </S>",
    "<S> our experimental apparatus is described in fig . </S>",
    "<S> [ setup ] . </S>",
    "<S> the laser source to generate light at @xmath23 is based on sum frequency generation ( sfg ) in a pp - ktp waveguide ( advr corp ) from two amplified laser diodes at @xmath24 ( toptica , dl 100 and keopsys fiber amplifier ) and @xmath25(toptica , ta pro ) . with input power of @xmath26 and @xmath27 for the @xmath28 laser and @xmath24 laser , </S>",
    "<S> respectively , we achieve an output power of @xmath29 at @xmath23 . taking into account the @xmath30 coupling efficiency of both beams into the waveguide </S>",
    "<S> , we obtain a sfg efficiency of @xmath31 . </S>",
    "<S> the beam is then split in two parts , one which will be used for the memory preparation ( preparation beam ) and one to prepare the weak pulses to be stored ( qubit beam ) . in each path , the amplitude of the light is modulated with an acousto - optic modulator ( aom ) in a double pass configuration , in order to create the required sequence of pulses for the preparation of the memory and of the polarization qubits . </S>",
    "<S> the radio - frequency signals used to drive the aoms are generated by an arbitrary waveform generator ( @xmath32 , @xmath33 , @xmath34 internal memory , pxie module and processflow software from signadyne ) . </S>",
    "<S> after the aoms , both beams are coupled to a polarization maintaining optical fiber and sent to another optical table where the cryostat is located .    the crystal is cooled down to @xmath20 in a cryofree cooler ( oxford instruments v14 ) . </S>",
    "<S> after the fibers , the preparation beam is collimated to a diameter of around @xmath35 with a telescope and sent to the storage device . </S>",
    "<S> right before the cryostat , a beam displacer ( bd1 ) splits the two polarization components of the incoming light onto two parallel spatial modes separated by @xmath36 , co - propagating through the crystal . to ensure equal power in both spatial modes , </S>",
    "<S> the polarization of the preparation beam is set to @xmath19 degrees . </S>",
    "<S> after bd1 , the polarization of the horizontal beam ( lower beam in fig.[setup ] ) is rotated by @xmath37 degrees using a hwp such that both beams enter the crystal with the same polarization which is parallel to the d2 axis of the crystal , which maximizes the absorption . </S>",
    "<S> the qubit beam is strongly attenuated by a set of fixed and variable neutral density filters ( ndf ) , and @xmath6 before bd1 was varied from @xmath7 to @xmath8 . </S>",
    "<S> after the ndf , arbitrary polarization qubits are prepared , using a quarter ( qwp ) and a half wave plate ( hwp ) . </S>",
    "<S> the qubits are then overlapped to the preparation beam at a beam splitter ( bs ) . after the cryostat , </S>",
    "<S> we rotate back the polarization of the lower beam and the two spatial modes are combined again at a second beam displacer ( bd2 ) . </S>",
    "<S> the two path between bd1 and bd2 form an interferometer with very high passive stability @xcite .    </S>",
    "<S> after the interferometer , the transmitted and retrieved light enters the polarization analysis stage , composed of a qwp , a hwp and a polarization beam splitter ( pbs ) , which allow us to measure the polarization in any basis . </S>",
    "<S> the transmitted beam at the pbs is coupled in a multimode fiber and sent to a silicon avalanche photodiode single photon detector ( spd , model count , laser components ) . the electronic signal from the spd </S>",
    "<S> is finally sent to a time stamping card ( pxie card from signadyne ) in order to record the arrival time histogram . the mean photon number @xmath6 is determined by measuring the detection probability per pulse @xmath38 when no atoms are present ( i.e. with the laser @xmath39 off resonance ) , and backpropagating before bd1 taking into account the detection efficiency ( @xmath40 ) and the transmission from before bd1 to the detector ( @xmath41 ) . </S>",
    "<S> the preparation beam and the qubits are sent sequentially towards the crystal . the total experimental sequence lasts @xmath42 seconds , during which the preparation lasts @xmath43 . during the next @xmath44 seconds </S>",
    "<S> @xmath45 weak pulses are prepared , stored and retrieved at a rate of @xmath46 .    in order to create the afc , </S>",
    "<S> we first create a wide transparency window within the @xmath15 inhomogeneous profile . </S>",
    "<S> this is achieved by sending a series of pulses of duration @xmath47 , during which the frequency of the light is swept linearly over a range of @xmath48 . </S>",
    "<S> the afc is then created using the burn back procedure introduced in ref . </S>",
    "<S> @xcite , i.e. by illuminating the sample with short pulses of duration @xmath49 , while shifting the frequency of the light by @xmath50 with respect to the center of the pit . </S>",
    "<S> four burn back pulses are sent with different frequencies separated by the comb spacing , leading to a 4-tooth comb .    ) as a function of the polarizer angle , for @xmath21 ( filled circles ) and @xmath51 ( open circles ) input polarization qubits , with @xmath3 . </S>",
    "<S> the fitted raw visibilities are @xmath52 and @xmath53 , respectively . </S>",
    "<S> ( b ) @xmath38 as a function of polarization angle for @xmath54 polarization qubit input , with ( filled squares , @xmath55 ) and without ( open squares , @xmath56 ) qwp inserted before the polarizer . ]    , @xmath57 and @xmath54 input qubits , with @xmath58 . no background has been subtracted . ]    </S>",
    "<S> .raw conditional fidelities for 6 different polarization input states . for this measurement </S>",
    "<S> , @xmath59 varied between 8 @xmath60 and 10 @xmath60 . </S>",
    "<S> the errors have been obtained using monte carlo simulation taking into account the statistical uncertainty of photon counts and a technical error reflecting slow drifts in our systems , and estimated from the residuals from the fit of fig.[fringe ] and similar curves . [ </S>",
    "<S> cols=\"^,^,^,^\",options=\"header \" , ]     as a first experiment , we verified that a complete set of qubit distributed over the poincar sphere could be stored and retrieved in the afc . </S>",
    "<S> we set the storage time to @xmath0 and we used the following input states : @xmath61,@xmath21 , @xmath62 , @xmath63 , @xmath64 and @xmath65 . </S>",
    "<S> fig.[setup ] ( b ) shows the experimental storage of a @xmath21 qubit encoded onto a pulse of duration @xmath22 ( fwhm ) and with @xmath66 . </S>",
    "<S> similar curves are obtained for the other states , and the average storage and retrieval efficiency is @xmath67 . in order to test that the coherence between the @xmath68 ( a ) , the curves obtained for @xmath69 and @xmath70 for the @xmath69 qubit , and @xmath53 for the @xmath57 qubit . in the case of a perfect circular @xmath54 qubit </S>",
    "<S> , we should observe no dependance on the hwp angle when no qwp is inserted . </S>",
    "<S> the interference should be restored however , when a qwp is inserted before the hwp , which turns circular polarization into a linear one . </S>",
    "<S> the results are shown in fig . </S>",
    "<S> [ fringe ] ( b ) . </S>",
    "<S> we indeed observe a strongly reduced visibility without the hwp ( @xmath71 ) , while a fringe with a high visibility of @xmath72 is obtained with the qwp . </S>",
    "<S> the residual visibility without the qwp may be due to a non perfect preparation of the @xmath54 state . </S>",
    "<S> the non perfect visibility for the @xmath57 and @xmath54 is mostly due to small phase fluctuations engendered by mechanical vibrations from the cryostat . </S>",
    "<S> indeed , we observe similar visibilities for bright pulses out of resonance with the atomic transition . </S>",
    "<S> these results show that the phase between the two polarizations components is almost perfectly preserved in the storage and retrieval process , and is preserved to a high degree in our combined interferometer and memory setup , for various polarization input states .    . </S>",
    "<S> the fidelity is measured by quantum state tomography and is the average of @xmath42 input states @xmath69 , @xmath73 , and @xmath74 for single qubits ( n=1 ) . </S>",
    "<S> the dashed - dotted line corresponds to eq.[fidelity ] where the poissonian distribution of photon number is taken into account . </S>",
    "<S> finally , the two other lines correspond to the cases where the finite storage efficiency is taken into account . </S>",
    "<S> the solid line corresponds to @xmath75 . </S>",
    "<S> measured @xmath59 are between @xmath76 and @xmath77 for all points . </S>",
    "<S> the dashed line corresponds to @xmath78 . for @xmath79 , </S>",
    "<S> an additional nd filter is placed before the detector to avoid saturation effects . ]    in order to better characterize the quality of the storage process , we reconstruct the density matrix of the retrieved qubits using quantum state tomography @xcite , for the complete set of qubits described above , with @xmath80 . </S>",
    "<S> the reconstructed output density matrices @xmath81 for @xmath61 , @xmath57 and @xmath82 are shown in fig [ tomog ] . from the matrices @xmath81 , we can then estimate the conditional fidelity of the output states with respect to the target state @xmath83 . the values for the complete set of inputs </S>",
    "<S> are listed in table 1 . </S>",
    "<S> we find a mean fidelity of @xmath84 . </S>",
    "<S> we emphasize that this value is a lower bound for the conditional fidelity , since it is calculated with respect to a target state and also takes into account imperfections in the preparation of the qubits .    finally , in order to assess the quantum nature of the storage , we determine the average fidelity as a function of @xmath6 , and compare it with the best obtainable fidelity using a purely classical method consisting of measuring the state and storing the result in a classical memory . </S>",
    "<S> it has been shown that for a state containing @xmath85 qubits , the best classical strategy leads to a fidelity of @xmath86 @xcite , leading to the well known fidelity of @xmath87 for @xmath88 . if the qubit is encoded in a weak coherent state , as it is the case in our experiment , one has to take into account the poissonian statistics of the number of photons @xcite , and the classical fidelity is given by : @xmath89    where @xmath90 . </S>",
    "<S> this is valid for the case of a memory with unity efficiency . </S>",
    "<S> if @xmath91 , the classical memory could use a more elaborate strategy to take advantage of finite efficiency in order to gain more information about the input quantum state @xcite . </S>",
    "<S> for example the classical memory could give an output only when the number of photons per pulse is high , and hence estimate with better fidelity the quantum state ( see appendix [ appdx ] ) . </S>",
    "<S> the different curves corresponding to the discussed cases are plotted in fig . </S>",
    "<S> [ fidelity_vs_n ] as a function of @xmath6 . </S>",
    "<S> the points correspond to experimental data . </S>",
    "<S> measured @xmath92 are significantly higher than the classical fidelity , for most of the photon numbers tested . </S>",
    "<S> this proves that our device performs as a quantum storage device for polarization qubits , even if tested with weak coherent states . </S>",
    "<S> we observe that the measured raw fidelity decreases for @xmath93 . </S>",
    "<S> this is mainly due to the dark count of the spd , as high fidelities can be recovered by subtraction of this background ( open squares ) . </S>",
    "<S> we also observe that when @xmath6 becomes too large ( @xmath94 in our case ) , the measured fidelity is not sufficient to be in the quantum regime . </S>",
    "<S> this confirms that very low photon numbers are required to test the quantum character of qms with weak coherent states . to our knowledge , </S>",
    "<S> it is the first time that an ensemble based memory has been characterized using this criteria .    the storage time in our experiment is limited by the minimal achievable width of the afc peaks ( @xmath95600 khz ) , which is in turn fully limited by the linewidth of our unstabilized laser . </S>",
    "<S> peaks as narrow as @xmath96 have been created in @xmath10 using a frequency stabilized laser @xcite , which should allow a storage time in the excited state of about 10 @xmath97 . </S>",
    "<S> this should also allow the storage of multiple polarization qubits in the time domain . in order to increase the storage time and to achieve on demand read out with an afc , the optical excitations should be transferred to long lived spin excitation as demonstrated for bright pulses in @xcite .    </S>",
    "<S> we have demonstrated the quantum storage and retrieval of polarization qubits implemented with weak coherent pulses at the single photon level , in a solid state storage device . </S>",
    "<S> the conditional fidelity of the storage and retrieval is @xmath98 , significantly exceeding the classical benchmark calculated for weak coherent pulses and finite memory efficiency . </S>",
    "<S> we thus show that solid state qms are compatible with photonic polarization qubits , which are widely used in quantum information science . </S>",
    "<S> this significantly extends the storage capabilities of these types of memories . by combining the time and polarization degrees of freedom one could readily double the number of modes that can be stored in the memory and create quantum registers for polarization qubits . using these resources </S>",
    "<S> , it may also be possible to design a quantum memory for complex light states such as hyperentangled states .    </S>",
    "<S> we note that related results have been obtained by two other groups @xcite .    </S>",
    "<S> we thank stephan ritter and antonio acin for interesting discussions regarding the classical benchmark , and the company signadyne for technical support . </S>",
    "<S> financial support by the chist - era european project qscale and by the erc starting grant qulima is acknowledged . </S>"
  ]
}