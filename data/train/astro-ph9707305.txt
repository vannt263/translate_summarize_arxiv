{
  "article_text": [
    "the ability of detecting structures in x - ray image of celestial objects is crucial , but the task is highly complicated due to the low photon flux , typically from @xmath0 to a few photons per pixel .",
    "point sources detection can be done by fitting the point spread function , but this method does not allow extended sources detection .",
    "one way of detecting extended features in a image is to convolve it by a gaussian .",
    "this increases the signal to noise ratio , but at the same time , the resolution is degraded . the vtp method ( scharf et al .",
    "1997 ) allows detection of extended objects , but it is not adapted for the detection of substructures .",
    "furthermore , in some cases , an extended object can be detected as a set of point sources ( scharf et al .",
    "the wavelet transform ( wt ) has been introduced ( slezak et al . 1990 ) and presents considerable advantages compared to traditional methods .",
    "the key point is that the wavelet transform is able to discriminate structures as a function of scale , and thus is well suited to detect small scale structures embedded within larger scale features .",
    "hence , wt has been used for clusters and subclusters analysis ( slezak et al . 1994 ; grebenev et al .",
    "1995 ; rosati et al . 1995 ; biviano et al .",
    "1996 ) , and has also allowed the discovery of a long , linear filamentary feature extended over approximatily 1 mpc from the coma cluster toward ngc 4911 ( vikhlinin et al .",
    "1996 ) . in the first analyses of images by the wavelet transform ,",
    "the mexican hat was used .",
    "the method simply consists in applying the correlation product between the image @xmath1 and the wavelet function : @xmath2 where @xmath3 is the scale parameter . by varying @xmath3",
    ", we obtain a set of images , each one corresponding to the wavelet coefficients of the data at a given scale .",
    "the wavelet function corresponding to the mexican hat is @xmath4    more recently the _  trous _ wavelet transform algorithm has been used because it allows an easy reconstruction ( slezak et al .",
    "1994 ; vikhlinin et al .",
    "1996 ) . by this algorithm",
    ", an image @xmath5 can be decomposed into a set @xmath6 , @xmath7    several statistical models have been used in order to say if a x - ray wavelet coefficient @xmath8 is significant , i.e. not due to the noise . in viklinin et al .",
    "( 1996 ) , the detection level at a given scale is obtained by an hypothesis that the local noise follows a gaussian noise . in slezak",
    "et al . ( 1994 ) , the anscombe transform was used in order to transform an image with a poisson noise into an image with a gaussian noise .",
    "other approaches have also been proposed using k sigma clipping on the wavelet scales ( bijaoui & giudicelli 1991 ) , simulations ( slezak et al . 1990 ; escalera & mazure 1992 , grebenev et al . 1995 ) , a background estimation ( damiani et al . 1996 ; freeman et al . 1996 ) , or the histogram of the wavelet function ( slezak et al . 1993 ; bury 1995 ) .",
    "we discuss and compare in this paper the different methods for signal detection using the _  trous _ wavelet transform algorithm and present how x - ray images can be restored even in the case of very low photon flux .",
    "simulations can be used for deriving the probability that a wavelet coefficient is not due to the noise ( escalera et al .",
    "1992 ) . modeling a sky image ( i.e. uniform distribution and poisson noise ) allows determination of the wavelet coefficient distribution and derivation of a detection threshold . for substructure detection in a cluster",
    ", the large structure of the cluster must be first modeled , otherwise noise photons related by the large scale structure will introduce false detections at lower scales . if we have a physical model , monte carlo simulations can also be used ( escalera & mazure , 1992 ; grebenev et al .",
    "1995 ) , but this approach requires a long computation time , and the detections will always be model - dependent .",
    "damiani et al .",
    "( 1996 ) , and also freeman et al .",
    "( 1996 ) propose to calculate the background from the data in order to derive the fluctuations due to the noise in the wavelet scales .",
    "it is regretable to have to do this , because we lose one the main advantage of the use of the wavelet transform , which is to be background - free .",
    "indeed , wavelet coefficients have a null mean , and the detection is just done by comparison to a given threshold .",
    "furthermore , background estimation is not an easy task , and generally requires several steps ( filtering , interpolation , etc ) , and error estimation on the background is generally difficult to calculate .",
    "a straightforward method , initially proposed by ( bijaoui & giudicelli 1991 ) , for deriving the detection levels at each scale is to apply a sigma clipping at each scale .",
    "therefore a standard deviation @xmath9 is estimated at each scale @xmath10 , and wavelet coefficients @xmath8 are considered as significant if @xmath11 where @xmath12 is generally taken equal to 3 .",
    "this method allows us to easily detect strong features , but is certainly not optimal for detection of weak objects . indeed , as the noise is not gaussian , it is difficult to estimate the real probability of false detection using this @xmath13 detection criterion .",
    "vikhlinin et al . ( 1995 ) proposed to assume a gaussian local noise , and to estimate the map @xmath14 from the the local background .",
    "the standard deviation @xmath15 related to a wavelet coefficient @xmath8 is derived from @xmath14 using the property of linearity of the wavelet transform ( starck & bijaoui , 1994 ) .",
    "as previously , the hypothesis is not true , and the consequence is the same .",
    "a solution is to use monte carlo simulations to set the correspondence between the standard deviation of a wavelet coefficient and the levels of significance ( grebenev et al , 1995 ) , but the simulations must be performed for each image because the significance levels vary strongly with the number of photons ( grebenev et al , 1995 ) .      in slezak",
    "et al . ( 1994 ) and biviano et al . (",
    "1996 ) , the anscombe transform @xmath16 has been used and acts as if the data arose from a gaussian noise with white model , with @xmath17 , under the assumption that the mean value of @xmath1 is large .",
    "simulations have shown ( murtagh et al . 1995 ) that a number of photons less than 30 per pixel introduces a bias . in x ray images ,",
    "the number of photons is often lower , and sometimes can even be equal to zero . using anscombe transform in this case will introduce an over estimation of the noise level . to overcome this difficulty , the noise standard deviation can be reestimated , for instance as in ( slezak et al 1994 ) i.e. by applying a sigma clipping at the first scale of the wavelet transform .",
    "however , this approach assumes that the noise is homogeneous , which is not true . indeed ,",
    "if the number of photons per pixel is lower that 30 , the standard deviation of noise after anscombe transformation , is varying strongly with the number of photons ( murtagh et al , 1995 ) .",
    "an approach for very small numbers of counts , including frequent zero cases , has been described in slezak et al .",
    "( 1993 ) and bury ( 1994 ) , for large scale clustering of galaxies .",
    "we have adopted here the same approach to analyze x - ray images .    a wavelet coefficient at a given position and at a given scale @xmath10 is @xmath18 where @xmath19 is the support of the wavelet function @xmath20 ( i.e. the box in which @xmath20 is not equal to 0 ) and @xmath21 is the number of events which contribute to the calculation of @xmath8 ( i.e.  the number of photons included in the support of the dilated wavelet centered at ( @xmath22,@xmath23 ) ) .",
    "if a wavelet coefficient @xmath8 is due to the noise , it can be considered as a realization of the sum @xmath24 of independent random variables with the same distribution as that of the wavelet function ( @xmath21 being the number of photons or events used for the calculation of @xmath8 ) .",
    "then we compare the wavelet coefficient of the data to the values which can taken by the sum of @xmath25 independent variables .",
    "the distribution of one event in the wavelet space is directly given by the histogram @xmath26 of the wavelet @xmath20 . since independent events are considered , the distribution of the random variable @xmath27 ( to be associated with a wavelet coefficient ) related to @xmath25 events is given by @xmath25 autoconvolutions of @xmath26 @xmath28 fig .",
    "[ fig_histo ] shows the shape of a set of @xmath29 . for a large number of events",
    ", @xmath29 converges to a gaussian .    in order to facilitate the comparisons ,",
    "the variable @xmath27 of distribution @xmath29 is reduced by @xmath30 @xmath31 being the mathematical expectation , and the cumulative distribution function is @xmath32    from @xmath33 , we derive @xmath34 and @xmath35 such that @xmath36 and @xmath37 .",
    "let us define a reduced wavelet coefficient as @xmath38 where @xmath39 is the standard deviation of the wavelet function , @xmath40 is the standard deviation of the dilated wavelet function ( @xmath41 ) , and @xmath8 a wavelet coefficient obtained using the _  trous _ wavelet transform algorithm .",
    "therefore a reduced wavelet coefficient , @xmath42 , calculated from @xmath8 , and resulting from @xmath25 photons or counts is significant if : @xmath43 or @xmath44    this detection method presents several advantages : it is independent of any model , no simulation is needed , and it is theoretically rigorous .",
    "we propose here to filter an image using the multiresolution support , which is determined from the significant wavelet coefficients ( i.e. coefficient which are not due to the noise ) .      a multiresolution support of an image describes in a logical or boolean way if an image @xmath1 contains information at a given scale @xmath10 and at a given position @xmath45 . if @xmath46 ( or @xmath47 ) , then @xmath1 contains information at scale @xmath10 and at the position @xmath45 .",
    "@xmath48 depends on several parameters :    * the input image . * the algorithm used for the multiresolution decomposition . *",
    "the noise . * all additional constraints we want the support to satisfy .",
    "such a support results from the data , the treatment ( noise estimation , etc . ) , and from knowledge on our part of the objects contained in the data ( size of objects , linearity , etc . ) . in the most general case ,",
    "a priori information is not available to us .",
    "the multiresolution support of an image is computed in several steps :    * step one is to compute the wavelet transform of the image .",
    "* binarization of each scale leads to the multiresolution support ( the binarization of an image consists in assigning to each pixel a value only equal to @xmath49 or @xmath50 ) .",
    "* a priori knowledge can be introduced by modifying the support .",
    "this last step depends on the knowledge we have of our images . for instance",
    ", if we know there is no interesting object smaller or larger than a given size in our image , we can suppress , in the support , anything which is due to that kind of object .",
    "this can often be done conveniently by the use of mathematical morphology . in the most general",
    "setting , we naturally have no information to add to the multiresolution support .",
    "the multiresolution support will be obtained by detecting at each scale the significant coefficients .",
    "the multiresolution support is defined by :    @xmath51      in the previous section , we have shown how to detect significant structures in the wavelet scales .",
    "a simple filtering can be achieved by thresholding the non - significant wavelet coefficients , and by reconstructing the filtered image by the inverse wavelet transform . in the case of the _  trous _ wavelet transform algorithm , the reconstruction is obtained by a simple addition of the wavelet scales and the last smoothed array . the solution @xmath52 is @xmath53 where @xmath54 are the wavelet coefficient of the input data , and @xmath48 is the multiresolution support .      as the _  trous _ wavelet transform algorithm is a non orthogonal wavelet transform algorithm , the wavelet transform of the solution @xmath52 does not produce wavelet coefficients @xmath55 which are exactly equal to @xmath56 .",
    "this is evidently not a problem for wavelet coefficients where nothing was detected ( @xmath57 ) , but it means that an error has been introduced during the reconstruction of objects from the significant structures .",
    "this can be corrected using an iterative method ( starck et al . , 1995 ) .",
    "if a wavelet coefficient of the original image is significant , then the multiresolution coefficient of the residual image ( i.e. @xmath58 with @xmath59 ) must be equal to zero .",
    "this is obtained by the following iteration : @xmath60 thus the regions of the image which contain significant structures at all levels are not modified by the filtering .",
    "the residual will contain the value zero over all of these regions . if an object is close to another one , which has the same size and has a stronger flux , it is possible that we will not detect it because of the negative component around the detected structure of the second object ( this is due to fact that a wavelet function has null mean ) .",
    "but after one or two iterations , the solution will contain the second object , and the residual will contain only the first one .",
    "this means that the wavelet coefficient ( obtained from the residual ) of the first object will no longer be masked by the second .",
    "the multiresolution support can be updated by reducing the wavelet coefficient of the residual image ( see  [ eqn_r ] ) , and applying both comparison tests of eqn  [ eqn_t1 ] and eqn  [ eqn_t2 ] .",
    "note that @xmath34 and @xmath35 are not recomputed , because the detection level is unchanged .",
    "the algorithm becomes :    1 .",
    "2 .   initialize the solution , @xmath62 , to zero .",
    "determine the multiresolution support of the image .",
    "4 .   determine the residual , @xmath63 .",
    "update the multiresolution support of the image .",
    "determine the wavelet transform @xmath64 of @xmath65 .",
    "threshold : only retain the coefficients which belong to the support",
    "reconstruct the thresholded residual image .",
    "this yields the image @xmath66 containing the significant residuals of the residual image .",
    "add this thresholding residual to the solution : @xmath67 .",
    "10 . if @xmath68 then @xmath69 and goto 4 .",
    "a positivity constraint can be introduced in the algorithm by thresholding at each iteration negative values in the solution @xmath52 .",
    "the multiresolution can also be updated , following each iteration , using the wavelet coefficients of the residual ] this is of interest when an object is hidden by another one .",
    "it appends each time a faint object is close to a stronger one .",
    "then the faint object is undetectable due to the negative coefficients which surrounded the strong one .",
    "but after one or two iterations , the strong object does not affect the residual , and the faint object may be appear in the scales .",
    "the filtering can be seen as an inversed problem .",
    "indeed , we want to reconstruct an image from the detected wavelet coefficient .",
    "the problem of reconstruction ( bijaoui and ru 1995 ) consists in searching a signal @xmath52 such that its wavelet coefficients are the same as those of the detected structure . by noting @xmath70 , the wavelet transform operator , and @xmath71 the projection operator in the subspace of the detected coefficients ( i.e. set to zero all coefficients at scales and positions where nothing where detected ) , the solution is found by minimization of @xmath72 where @xmath73 represents the detected wavelet coefficients of the image @xmath1",
    "a complete description of algorithms for minimization of such an equation can be found in bijaoui and ru ( 1995 ) . in practice , compared to the previous algorithm , the main modification is the introduction of the adjoint wavelet transform operator , replacing the step 8 ( reconstruction ) .",
    "a simple thresholding generally provides poor results .",
    "artifacts appear around the structures , and the flux is not preserved .",
    "the multiresolution support filtering requires only a few iterations , and preserves the flux .",
    "the use of the adjoint wavelet transform operator instead of the simple coaddition of the wavelet scale for the reconstruction ( step 8 of the algorithm ) suppresses the artifacts which may appear around objects .",
    "in fact , the algorithm is analogous to minimizing the equation [ eqn_j ] .",
    "the use of the van cittert algorithm for minimization of @xmath74 leads to the modified multiresolution support filtering method .",
    "other approaches for the minimization can also be used ( conjugate gradient , etc ) .",
    "the van cittert algorithm is not optimal for the time computation , but it has the advantage of allowing us to add constraints during the iterations .",
    "the positivity is a strong constraint which should be used . other additional prior knowledge can be added .",
    "for instance , such prior knowledge could be in the form of a star position catalog , bad pixel positions , a given position where we expect the object to be located , or constraints on the size of the object .",
    "hence the multiresolution constraint allows us to integrate into the same data structure other information sources ( catalogs , images , etc . ) and prior knowledge ( positions , object sizes , etc . ) , in a way which facilitates subsequent image processing operations . in the most general case",
    ", we do not have such prior information available , so the multiresolution support is computed from the given input image and its noise properties .",
    "partial restoration can also be considered .",
    "indeed , we may want to restore an image which is background free , objects which appears between two given scales , or one object in particular .",
    "then , the restoration must be performed without the last smoothed array for a background free restoration , and only from a subset of the wavelet coefficients for the restoration of a set of objects ( bijaoui et ru 1995 ) .",
    "[ fig_simu1 ] ( left ) shows a simulated image of a galaxy cluster .",
    "two point sources are superimposed ( on the left of the cluster ) , a cooling flow is at the center , a substructure on its left , and a group of galaxies at the top . from this image , a `` noisy '' images has been created ( fig .  [ fig_simu1 ] ( right ) ) .",
    "the mean background level is equal to 0.1 events per pixel .",
    "this corresponds typically to x - ray cluster observations . in the noisy image ,",
    "the maximum value is equal to 23 events .",
    "the background is not very relevant .",
    "the problem in this kind of images is the small number of photons per object .",
    "it is very difficult to extract any information from them .",
    "[ fig_result_comp ] , top left and top right , shows the filtering of the image by convolving the noisy image by a gaussian , with a standard deviation equal to 3 and 5 respectively . using the anscombe transform , we were unable to obtain an image with a reasonable quality .",
    "it seems that this transform should only be used in the condition defined in murtagh et al ( 1995 ) , i.e. with a minimum number of photons equal to 30 per pixel . in the case of very low photons count",
    ", the results are very poor .",
    "[ fig_result_comp ] bottom left shows the result after a filtering using a sigma clipping on each wavelet scale , and a ten sigma detection .",
    "[ fig_result_comp ] bottom right shows the filtering using an hypothesis of local gaussian noise , and a ten sigma detection . for both , even at a detection level of ten sigma , the filtered image presents residual noise .",
    "figure  [ fig_result_histo ] shows the results of the filtering using the method based on the histogram autoconvolutions with two different confidence levels .",
    "figure  [ fig_result_histo ] left corresponds to a confidence interval of @xmath75 ( which is equivalent to a @xmath76 sigma detection for the case of gaussian noise ) , and figure  [ fig_result_histo ] right , with a confidence level equal to @xmath77 ( @xmath78 gaussian equivalence ) .",
    "even if the two point sources could not have been distinguished by eye in the noisy image , they have been detected and correctly restored .",
    "figure  [ fig_result_bgr_comp ] shows the result of the filtering with different background levels .",
    "the detections in the wavelet scale were done using @xmath79 . from left to right and top to bottom , the background level was respectively equal to @xmath0 , @xmath80 , @xmath50 , @xmath81 counts per pixel . if the background level is high , there is more noise , and we see that the second source disappears when the background level increases , which is normal behavior .",
    "the best filtering is clearly obtained using the method based on wavelet transform and the histogram autoconvolutions . for other methods",
    "which use the wavelet transform , we did not use monte carlo simulations and the exact level for signal detection is difficult to find .",
    "furthermore , the level is certainly not the same for the whole scale . for this reason ,",
    "a simple gaussian filtering seems to be better .",
    "once the significant wavelet coefficients have been detected , they can be grouped into structures ( a structure is defined as a set of connected wavelet coefficients at a given scale ) , and each structure can be analyzed independently .",
    "interesting information which can be easily extracted from an individual structure includes the first and second order moments , the angle , the perimeter , the surface , and the deviation of shape from sphericity ( i.e. @xmath82 ) . from a given scale ,",
    "it is also interesting to count the number structures , and the mean deviation of shape from sphericity .    in order to visualize the structures",
    ", we can create an image by plotting a contour for each detected structure .",
    "this provides a compact way to visualize the multiresolution support .",
    "figure [ fig_cont_support ] ( left ) shows the contours of the multiresolution support of the simulated image of section  [ sect_simu ] .",
    "figure [ fig_cont_support ] ( right ) shows the contours of the same simulated field , but the objects of the simulated noisy image contain less flux ( the maximum of the image is equal to seven counts ) , while the background is the at the same level ( @xmath0 count per pixel ) .",
    "we can easily see that in this case , the two point sources have disappeared .",
    "both detection were done with @xmath79 .",
    "the cluster of galaxies a2390 is located at a redshift of 0.231 .",
    "figure  [ fig_ima_a2390_bw ] shows an image of this cluster , obtained with rosat satellite .",
    "the resolution is one arc second per pixel , with a total number of 13506 photons for exposure time of approximately 8 hours .",
    "the background level is around 0.04 photons per pixel .",
    "it is clear that the raw data are not usable , and we need to filter it in order to extract the information .",
    "the standard method consists in convolving the image by a gaussian .",
    "figure  [ fig_ima_fg_a2390_col ] shows the result after applying this convolution ( gaussian with a full width at half maximum equal to 5 \" , which is approximatively the size of the instrumental response ) .",
    "the smoothed image shows structure , but we see also that a lot of noise remains , and it is difficult to assign a significance to these structures .",
    "figure  [ fig_ima_fw_a2390_col ] shows the filtered image by the histogram based wavelet method .",
    "the noise has been eliminated , and we see that the wavelet transform has enhanced weak structures in the x - ray emission , which could explain the gravitational amplification phenomena which have been observed in the optical domain ( pierre et al .",
    "simulations have shown that the best filtering approach for images containing poisson noise with few events is the method based on the histogram autoconvolutions .",
    "this method allows one to give a probability that a wavelet coefficient is due to noise .",
    "no background model is needed , and simulations with different background levels have shown the reliability and the robustness of the method .",
    "other noise models in the wavelet space lead to the problem of the significance of the wavelet coefficient .",
    "a ten sigma detection was not strong enough in our simulation to produce a good filtered image . in this case , only monte carlo simulations can allow one derivation of a good detection level , and then , a new problem appears of defining the correct background .",
    "the main advantage of the histograms based method is its independence of the background ."
  ],
  "abstract_text": [
    "<S> in the context of assessing and characterizing structures in x - ray images , we compare different approaches . most often the intensity level is very low and necessitates a special treatment of poisson statistics . </S>",
    "<S> the method based on wavelet function histogram is shown to be the most reliable one . </S>",
    "<S> we also present a multi - resolution filtering method based on the wavelet coefficients detection . </S>",
    "<S> comparative results are presented by means of a simulated cluster of galaxies .    </S>"
  ]
}