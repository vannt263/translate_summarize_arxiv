{
  "article_text": [
    "numerical simulations have emerged as a powerful tool for the study of nonlinear and time - dependent magnetohydrodynamic ( mhd ) flows .",
    "one particularly fruitful application has been to the study of the saturation of the magnetorotational instability ( mri ) in accretion disks .",
    "numerical simulations which use a local , linear expansion of the equations of motion , termed the _ shearing box _",
    "@xcite , have been used to follow the growth and saturation of the mri over hundreds of orbits , starting from a variety of initial field configurations and strengths .",
    "this has allowed careful study of the saturation mechanism in ideal mhd ( sano , these proceedings ) , as well as the effect of a variety of additional physics on the nonlinear regime : for example , non - ideal mhd effects in protoplanetary disks @xcite , saturation in radiation dominated disks @xcite , and kinetic effects in nearly collisionless plasmas @xcite .",
    "in addition to local studies using the shearing box , a variety of authors have begun to study the _ global _ dynamics of accretion flows driven by the mri .",
    "for example , fully three - dimensional general relativistic mhd simulations of the evolution of a weakly magnetized torus in the kerr metric have been presented by @xcite , among others .",
    "other global studies have been used to investigate the interaction of a magnetized disk with a central star @xcite , and the formation of time - dependent jets and outflows ( shibata , these proceedings ) , to name just a few examples .",
    "of course , all such studies are predicated on the availability of accurate and robust numerical algorithms for mhd .",
    "much of the work on the mri has been based on the algorithms in the zeus code ( @xcite , @xcite ) , the simplicity of which has allowed the diverse physics discussed above ( non ideal mhd , grmhd , radiation mhd ) to be added more easily . however , there are some accretion flow problems for which the algorithms in zeus may not be optimal . for example",
    ", global studies of geometrically thin disks ( where @xmath0 , @xmath1 is the vertical scale height in the disk ) which span many tens of @xmath1 in radius with sufficient resolution per scale height to resolve the inertial range of turbulence driven by the mri ( say 128 grid points per @xmath1 ) would require intractably large grids if uniform zoning is used . instead , such calculations would be more feasible if nested grids could be used , so that the finest resolution grid is confined to a few @xmath1 near the midplane , and progressively coarser grids are used to span the less dense corona above the disk ( where the fields become strong , the mri is suppressed , and turbulence is reduced @xcite ) . however , nested and adaptive grids work best with single - step eulerian methods based on the conservative form .",
    "thus , to enable new nested grid simulations of accretion flows which span a large range in spatial and temporal scales , we are motivated to implement a new mhd algorithm based on the conservative form .",
    "the equations of ideal mhd can be written in conservative form as @xmath2 where @xmath3 is the mass density , @xmath4 is the momentum density , @xmath5 is the magnetic field , and @xmath6 is the total energy density .",
    "the total pressure @xmath7 where @xmath8 is the gas pressure , and the total energy density @xmath6 is related to the internal energy density @xmath9 via @xmath10 throughout we assume an ideal gas equation of state for which @xmath11 , where @xmath12 is the ratio of specific heats . unless otherwise stated , we take @xmath13 . none of the main results described here depend directly upon the equation of state .",
    "note also that we have chosen a system of units in which the magnetic permeability @xmath14 .",
    "a variety of numerical methods can be used to solve the equations of mhd in conservative form .",
    "we have chosen to adopt an algorithm based on godunov s method ( for shock capturing ) , and the constrained transport ( ct ) @xcite algorithm for integration of the magnetic fields ( so that the divergence free constraint is enforced ) .",
    "there are many godunov methods we could potentially adopt ; we have chosen to use the piecewise parabolic method ( ppm , @xcite )",
    ". a disadvantage of ppm is that it requires the use of a mhd riemann solver to compute the fluxes of the volume - averaged variables ( we use roe s linearization to construct our solver , see @xcite ) .",
    "however , the benefit is a very accurate method for problems involving shocks and discontinuities , which are very prevalent in astrophysical flows .",
    "a variety of other authors @xcite , have described the combination ct with godunov schemes ( including ppm ) , however the scheme used here differs in several important respects : ( 1 ) in the reconstruction of cell - centered quantities to cell edges to serve as the initial states for a riemann solver , ( 2 ) in the way the electromotive forces ( emfs ) at cell corners needed by the ct algorithm are computed from face - centered fluxes , and ( 3 ) in the extension of an unsplit integration algorithm due to @xcite ( the corner - transport - upwind , or ctu , scheme ) to mhd .",
    "it is impossible to describe all of the details of the algorithm we have developed in this proceeding ; a comprehensive discussion of the two - dimensional algorithm is given in @xcite .",
    "however , the basic design principle of the method is worth reiterating here : the relationship between the cell - centered , volume - averaged variables used in ppm , and the face - centered , area - averaged field components used by ct must be used to define how the fluxes of the volume - averaged variables ( returned by the riemann solver ) are transformed into fluxes of the area - averaged variables ( needed by ct ) .",
    "the issue is illustrated in figure 1 , which shows the relative locations of the fluxes of the volume - averaged magnetic field returned by the riemann solver at the cell faces , and the flux of the area - averaged magnetic field at the cell corner ( @xmath15 ) used by ct .",
    "it is natural to try using an arithmetic average to compute the corner - centered emf , however this destroys the proper upwinding of the fluxes , and leads to oscillatory solutions in many cases .",
    "this is easy to demonstrate for a plane parallel grid - aligned flow .",
    "imagine a plane wave propagating along the @xmath16direction in figure 1 . in this case",
    ", the corner - centered emf should be identical to the face - centered fluxes along the @xmath17axis , that is @xmath18 and @xmath19 .",
    "however , arithmetic averaging will include contributions from the other faces , namely @xmath20 and @xmath21 .",
    "this destroys the upwinding of the fluxes , and reduces the stability of the algorithm . rather than an averaging ,",
    "what is needed is a reconstruction of the emfs to the corner ; one method to achieve this is detailed in @xcite .",
    "a variety of papers discuss collections of test problems for mhd codes , for example @xcite .",
    "similarly , we have put together a collection of tests that have been useful in developing our methods . a complete description of our test suite is given at ` http://www.astro.princeton.edu/\\simjstone/tests ` ( at the time this article was written ) .",
    "below , we describe the results from a selection of problems .",
    "one of the simplest tests , yet challenging for a godunov scheme , is the advection of a field loop in multidimensions . in our version of this test , the computational domain extends from @xmath22 , and @xmath23 , is resolved on a @xmath24 grid , and has periodic boundary conditions on both @xmath25- and @xmath26-boundaries .",
    "the velocity components are @xmath27 , @xmath28 , and @xmath29 ( where @xmath30 and @xmath31 ) , and @xmath32 and the pressure @xmath33 .",
    "by @xmath34 the field loop will have been advected across the grid once .",
    "the @xmath35-component of the magnetic field @xmath36 while the in plane components @xmath37 and @xmath38 are initialized from the @xmath35-component of the magnetic vector potential @xmath39 where @xmath40 , @xmath41 and @xmath42 .",
    "thus for @xmath43 , @xmath44 and the magnetic field is essentially a passive scalar .    of course , the correct solution to this test is that the field loop should remain circular , and it should diffuse in amplitude as little as possible .",
    "figures of the solution computed with our method are given in @xcite and on the test web page and will not be reproduced here ; they confirm our method preserves these properties .",
    "we find this test provides a dramatic demonstration of the failure of arithmetic averaging for the construction of emfs at cell - corners from face - centered fluxes : this method results in a strongly oscillatory solution ( although the oscillations can be masked if a very diffusive integrator is used ) .",
    "setting the out - of - plane component of the velocity @xmath45 to a uniform , non - zero value , and testing that @xmath46 remains zero to round - off in this case , is another difficult test .",
    "a useful quantitative test is to measure the rate at which errors associated with the propagation of linear modes from each wave family ( entropy waves , fast and slow magnetosonic waves , and alfven waves ) converge as the numerical resolution is increased .",
    "exact eigenmodes are initialized on a three - dimensional grid of size @xmath47 using @xmath48 grid points , where @xmath49 and 128 .",
    "thus , the grid is rectangular , but each cell is square .",
    "we orient the wavevector such that the wavefront is along the diagonal of the computational domain , and have chosen the grid dimensions so that the distance between wavefronts along any coordinate direction is equal to the size of the domain in that direction .",
    "periodic boundary conditions are used . since the wave does not propagate along the diagonal of the grid cells , we guarantee the @xmath16 , @xmath17 , and @xmath50fluxes differ ; that is the problem is truly multi - dimensional",
    ".    the background medium has @xmath51 , and @xmath52 with @xmath53 . the background magnetic field parallel to the wavevector @xmath54 , while the two components perpendicular to it are @xmath55 , and @xmath56 ( where @xmath57 ) .",
    "thus , the fast magnetosonic speed is 2.0 , the alfven speed is 1.0 , and the slow magnetosonic speed is 0.5",
    ". the wave is added as a perturbation to these constant values of the form @xmath58 , where @xmath59 is the displacement along the wavevector . here",
    "@xmath60 is the vector of conserved variables , @xmath61 is an amplitude , and @xmath62 is the right - eigenvector corresponding to the desired wave family . to aid others in comparing to our results",
    ", tables of the right - eigenvectors for the specific initial conditions described above can be found in @xcite .",
    "for all the tests shown here , @xmath63 .",
    "the face - centered components of the magnetic field are initialized from a vector potential located at zone edges .",
    "after the wave has propagated one wavelength , we measure the error in the numerical solution by computing the norm of the vector resulting from summing the absolute value of errors in each variable over the grid , that is we compute @xmath64 . here",
    ", @xmath65 is the numerical solution for the k - th component of the vector of conserved quantities at grid point @xmath66 and time level @xmath67 , and @xmath68 is the initial numerical solution ( at time zero ) .            figures 2 and 3 plot the errors after one grid crossing time for each wave family .",
    "the results have been computed using three distinct unsplit integrators : ( 1 ) the general extension of ctu to three - dimensions , which requires 12 riemann solves per grid cell ( labeled ctu-12 ) , ( 2 ) a simpler extension of ctu which includes fewer transverse flux gradients and therefore requires only 6 riemann solves per grid cell , but is stable up to a cfl number of only 0.5 ( labeled ctu-6 ) ( 3 ) a simple unsplit muscl scheme which is commonly used in other codes @xcite ( labeled muscl ) . in each case",
    "the errors converge at second order .",
    "however , there is a significant difference in the amplitude of the errors at a given resolution between the integrators .",
    "for example , the ctu-6 scheme can have an error nearly an order of magnitude less than the muscl scheme for some waves and some resolutions .",
    "this and other tests indicate the ctu-6 scheme is the best compromise between accuracy and simplicity ; this integrator has been used for all the other tests and application presented here .      in some sense ,",
    "linear waves are too easy a test since the error is dominated by only a few terms in the equations .",
    "circularly polarized alfven waves are an exact solution to the nonlinear equations , thus they provide an excellent quantitative test @xcite . for this test @xmath51 , @xmath69 , @xmath70 , @xmath71 , and @xmath72 with @xmath73 and @xmath74 where @xmath75 is the angle at which the wave propagates with respect to the grid . here",
    "@xmath76 and @xmath77 are the components of velocity and magnetic field perpendicular to the wavevector . here",
    "we report on results from the two - dimensional version of this test , using a grid of size @xmath24 , with the wavefront orientated along the grid diagonal ( but not the diagonal of individual zones ) .",
    "although nonlinear amplitude alfven waves are subject to a parametric instability which causes them to decay into magnetosonic waves ( see @xcite ) , the instability should not be present for the parameters defined here . since the problem is smooth , it can be used for convergence testing . running the test with smaller pressure",
    "( higher @xmath78 ; ) and/or larger amplitudes is a good test of how robust is the algorithm . using standing waves ( in which the fluid is moving at the alfven speed in the opposite sense to the propagation of the wave ) is challenging because it requires the two terms in the emf cancel exactly .",
    "it is difficult to get this cancellation using schemes based on splitting         figure 4 plots every grid point in the calculation after five grid transit times for both standing and traveling waves .",
    "it can be compared directly with figures 8 and 9 in @xcite , although note we use square grid cells which destroys any symmetries in the fluxes ( potentially making our test more difficult ) .",
    "the lack of scatter indicates the waves have remained planar , and there is no parametric instability .",
    "moreover , the profiles show very little dispersion or diffusion error for these waves for resolutions above 16 grid points per wavelength . for standing waves ,",
    "the wave profile is captured even on a @xmath79 grid ; remarkable given that the nyquist limit for the minimum number of points needed to represent the wave is four .",
    "as in the linear wave test , it is also possible to compute the convergence rate of errors ; the method here converges at second order ( which is clear from inspection of the curves in figure 4 ) .",
    "the code described above ( which we call athena ) , including documentation , is freely available at ` http://www.astro.princeton.edu/\\simjstone ` .",
    "currently , one- and two - dimensional versions are available in both fortran90 and c. a fully three dimensional version has been developed , and is now being used for a variety of applications , some of which we describe below .",
    "there are significant modifications required to extend the method @xcite to three - dimensions , a paper is in preparation .",
    "one recent application of the zeus code was to the study of the decay of supersonic mhd turbulence thought to dominate the internal dynamics of cold molecular clouds .",
    "the zeus simulations demonstrated that supersonic turbulence decays rapidly , even if it is sub - alfvenic , because of dissipation in slow magnetosonic shocks . even though the dissipation rate in shocks could be measured in the zeus simulations ( and was shown to be roughly equal to the measured decay rate ) , it is important to test that numerical dissipation is not strongly affecting this result .",
    "we have repeated the simulations in @xcite using athena , with the identical parameters and spectrum for the velocity driving .",
    "the time evolution of the total energy in fluctuations ( kinetic plus magnetic ) from two simulations at two different numerical resolutions , for @xmath80 and @xmath81 ( see @xcite for a detailed explanation of these parameters ) , is shown in figure 5 .",
    "as before , the energy shows rapid growth at early times , followed by roughly constant evolution after 0.1 @xmath82 ( where @xmath82 is the sound crossing time ) .",
    "the amplitude reached by the turbulent fluctuations in the identical runs performed with zeus are shown by arrows on the right axis . in each case , the athena results show slightly higher amplitudes consistent with slightly less numerical dissipation .",
    "however , the differences are small , and the result that the turbulence is rapidly decaying is confirmed .",
    "we are undertaking a survey over a much larger range in resolutions and at different magnetic field strengths ; the results will be reported elsewhere .        another application of athena is to nonlinear evolution of the rayleigh - taylor ( rt ) instability in magnetized fluids .",
    "previous studies using zeus @xcite focused on the amplification of magnetic field in turbulence driven by the rt instability in weakly magnetized flows . with athena ,",
    "we have computed the evolution in three - dimensions of a rt unstable interface with strong parallel fields , in some cases including a rotation of the field at the interface , at a grid resolution of @xmath83 .",
    "the structure of the fingers characteristic of the rt instability at late times is quite different in the presence of strong fields .",
    "since interchange instabilities at short wavelengths are still present , whereas only long wavelength parallel modes can exist , the fingers become  arches \" and  flux - tubes \" in the field direction .",
    "lack of space prevents a full discussion of the results here ; a paper is in preparation .",
    "it is natural to compare simulations of the mri using athena with the results of previous studies using the shearing box .",
    "however , since the shearing box is a noninertial frame , source terms must be added to the equations of motion to account for the coriolis force and tidal gravity .",
    "these terms , @xmath84 must be added to the integrator in way which preserves the second - order convergence properties . by redefining the total energy to include the tidal potential , it is possible to ensure it is conserved . finally , it is important that the total coriolis force remains strictly orthogonal to the velocity , which also requires special care .",
    "we are preparing a paper which describes the ( non - trivial ) implementation of the shearing box in athena , as well as presenting new results . here",
    ", we focus on the comparison between zeus and athena on this problem .",
    "figure 6 shows an image of the angular velocity fluctuations @xmath86 at two times in the evolution of the mri in a two - dimensional grid starting from a zero - net vertical field with @xmath87 ( identical to run s1c in @xcite , except @xmath88 here ) using a resolution of @xmath89 .",
    "the panel on the left shows the growth of fingers at the characteristic wavelength of the fastest growing mode of the mri ; since the field strength varies with @xmath25 , the spacing of the fingers also varies with the @xmath16position .",
    "the panel on the right shows the interaction of the fingers at late time results in two - dimensional mhd turbulence . because sustained field growth is not possible in 2d with no net flux , this turbulence inevitably dies away , with the rate of decay determined by the numerical reconnection rate .",
    "thus , the time evolution of the poloidal magnetic energy is a good measure of the numerical dissipation rate .",
    "figure 7 shows a comparison of the evolution of the change in the volume averaged poloidal magnetic energy @xmath90 , where @xmath91 is the volume averaged magnetic energy in the initial state , at three different resolutions computed with both zeus and athena .",
    "note that at each resolution , the athena curve is about half way between the zeus curves of the same and the next highest resolution .",
    "this indicates the numerical dissipation in athena is similar to that in zeus at about 1.5 times higher resolution per dimension .",
    "the result that the dissipation in athena is slightly lower than zeus is consistent with the turbulence decay results presented earlier . note that there are no qualitative differences between the zeus and athena results , the growth rate and saturation amplitude of the mri is the same in each case .",
    "this is the first time the evolution of the mri has been computed with a higher order godunov code , and is a powerful confirmation of the previous zeus results .",
    "figure 8 shows the angular momentum fluctuations on the faces of a three - dimensional computational volume computed using a grid of @xmath92 and an initially zero - net vertical field of strength given by @xmath93 ( with @xmath94 ) , similar to run sz1 in @xcite . in 3d",
    ", turbulence is sustained , and the time - evolution of volume averaged quantities , including the maxwell stress , is very similar to the previous zeus results .",
    "in addition to comparing to results from zeus , we have been using athena to study the effect of optically thin cooling on the nonlinear stage of the mri in the shearing box .",
    "since athena is conservative , magnetic energy lost in reconnection is captured as thermal heating of the gas .",
    "thus , athena is much more suitable for studies of the energetics of the mri . as discussed by gardiner ( these proceedings )",
    ", we have added optically thin cooling to athena and are studying the statistics of the resulting temperature fluctuations in steady - state turbulence driven by the mri .",
    "our plans for athena include extension to curvilinear and nested grids , and application to ( 1 ) the global mhd of geometrically thin disks and ( 2 ) fragmentation and collapse in self - gravitating mhd turbulence .",
    "these , and many other applications of athena , will be reported in future communications .",
    "we thank j. hawley and p. teuben for their significant contributions to the work presented here .",
    "this work was supported by nsf grant ast-0113571 .",
    "we thank the organizers for hosting such a wonderful meeting in such a beautiful place ."
  ],
  "abstract_text": [
    "<S> we describe a new numerical scheme for mhd which combines a higher order godunov method ( ppm ) with constrained transport . </S>",
    "<S> the results from a selection of multidimensional test problems are presented . </S>",
    "<S> the complete test suite used to validate the method , as well as implementations of the algorithm in both f90 and c , are available from the web . </S>",
    "<S> a fully three - dimensional version of the algorithm has been developed , and is being applied to a variety of astrophysical problems including the decay of supersonic mhd turbulence , the nonlinear evolution of the mhd rayleigh - taylor instability , and the saturation of the magnetorotational instability in the shearing box . </S>",
    "<S> our new simulations of the mri represent the first time that a higher - order godunov scheme has been applied to this problem , providing a quantitative check on the accuracy of previous results computed with zeus ; the latter are found to be reliable .     </S>",
    "<S> address = department of astrophysical sciences , princeton university , princeton , nj 08544     address = department of astrophysical sciences , princeton university , princeton , nj 08544 </S>"
  ]
}