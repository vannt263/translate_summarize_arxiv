{
  "article_text": [
    "in this paper , we study tropical secant sets and rank for symmetric matrices .",
    "our setting is the _ tropical semiring _",
    "@xmath1 , where tropical addition is given by @xmath2 and tropical multiplication is given by @xmath3 .",
    "the @xmath4th _ tropical secant set _ of a subset @xmath5 of @xmath6 is defined to be the set of points @xmath7 where @xmath8 denotes coordinate - wise minimum .",
    "this set is typically not a tropical variety and thus we prefer the term `` secant set '' to `` secant variety , '' which has appeared previously in the literature .",
    "the _ rank _ of a point @xmath9 with respect to  @xmath10 is the smallest integer @xmath11 such that @xmath12 lies in the @xmath13th tropical secant set of @xmath10 , or @xmath14 if there is no such @xmath4 .    in  @xcite , develin , santos , and sturmfels",
    "define the barvinok rank of a matrix , not necessarily symmetric , to be the rank with respect to the subset of @xmath15 rank  @xmath0 matrices , and their definition serves as a model for ours . in addition , they define two other notions of rank , kapranov rank and tropical rank , for which there are no analogues in this paper . further examination of ranks of not necessarily symmetric matrices can be found in the review article  @xcite .",
    "we give a careful examination of secant sets and rank with respect to three families of tropical varieties in the space of symmetric matrices and the space of dissimilarity matrices . by a _",
    "@xmath16 dissimilarity matrix _ we simply mean a function from @xmath17\\choose 2}$ ] to @xmath18 , which we will write as a symmetric matrix without any entries on the diagonal . there is a natural projection from @xmath16 symmetric matrices to @xmath19 dissimilarity matrices which we denote by  @xmath20 . for example",
    ", @xmath21 are a symmetric matrix and dissimilarity matrix respectively .",
    "our first family is the _ tropical veronese _ of degree @xmath22 , which is the tropicalization of the classical space of symmetric matrices of rank  1 .",
    "it is a classical linear subspace of the space of symmetric matrices consisting of those matrices which can be written as @xmath23 for some row vector @xmath24 .",
    "the rank of a matrix with respect to the tropical veronese is called _ symmetric barvinok rank _ , because it is the symmetric analogue of barvinok rank .",
    "second , we consider the _ space of star trees _ , which is the image of the tropical veronese under the projection @xmath20 .",
    "equivalently , it can be obtained by first projecting the classical veronese onto its off - diagonal entries and then tropicalizing . the classical variety and its secant varieties",
    "were studied in  @xcite .",
    "the tropical variety is a classical linear subspace of the space of dissimilarity matrices , and we call the corresponding notion of rank _ star tree rank_. the name reflects the fact that the matrices with star tree rank  @xmath0 are precisely those points of the tropical grassmannian which correspond to trees with no internal edges , i.e.  star trees , in in the identification below .",
    "third , we consider the _ tropical grassmannian _ @xmath25 , which is the tropicalization of the grassmannian of 2-dimensional subspaces in an @xmath26-dimensional vector space , and was first studied in  @xcite .",
    "it consists of exactly those dissimilarity matrices arising as the distance matrix of a weighted tree with @xmath26 leaves in which internal edges have negative weights .",
    "therefore , we call the points in the tropical grassmannian _ tree matrices _ , and call rank with respect to the tropical grassmannian the _ tree rank_. note that our definition of tree rank differs from that in  ( * ? ? ?",
    "3 ) , which uses a different notion of mixtures .",
    "our first two families are examples of classical linear spaces , whose secant sets were studied by mike develin  @xcite .",
    "he defines a natural polyhedral fan such that the tropical secant set is the support of this polyhedral fan .",
    "moreover , theorem  2.1 in  @xcite gives an algorithm for computing the rank of a point with respect to a fixed linear space .",
    "in contrast , we do not know of a good algorithm for computing the rank with respect to the tropical grassmannian ( see section  [ sec : open - questions ] ) , and we do not know of a natural fan structure .",
    "[ tree_rank ]    we use our examples of @xmath27 and @xmath28 from  ( [ eqn : intro - exs ] ) to illustrate our three notions of rank .",
    "proposition  [ prop : zero - inf - rank ] tells us that the symmetric barvinok rank of  @xmath27 is  4 .",
    "theorem  [ thm : max - star - tree - rank ] tells us that the star tree rank of @xmath29 is  2 .",
    "explicitly , we have @xmath30 finally , the tree rank of @xmath31 is  1 by proposition  [ prop : tree - rank-01 ] , which can also be seen explicitly from the weighted tree in figure  [ fig : example - tree ] .",
    "this example shows that all three of our notions of rank can be different .    however , for any @xmath16 symmetric matrix  @xmath27 , we have @xmath32 the first inequality follows from the fact that the set of dissimilarity matrices of star tree rank  @xmath0 is the projection of the set of matrices of symmetric barvinok rank  @xmath0 .",
    "the second inequality follows from the fact that the space of star trees is contained in the tropical grassmannian .",
    "the rest of the paper is organized as follows . in section  [ sec : def - graph ] , we present a technique for proving lower bounds on rank .",
    "we introduce a graph associated to a matrix for each of our notions of rank ; the chromatic number of this graph is a lower bound on the rank of the matrix . the same technique applies to provide a lower bound to the rank of any point with respect to any tropical prevariety , although in general it may produce a hypergraph instead of a graph .",
    "we examine symmetric barvinok rank , star tree rank , and tree rank in sections [ sec : sym - barv - rank ] , [ sec : star - tree - rank ] , and  [ sec : tree - rank ] respectively .",
    "we prove upper bounds on the rank in each case , and with the exception of tree rank , our upper bounds are sharp . we show that the symmetric barvinok rank of an @xmath16 symmetric matrix can be infinite , but even when the rank is finite it can exceed @xmath26 , and in fact can grow quadratically in  @xmath26 ( theorem  [ thm : max - rank ] ) . for each notion of rank ,",
    "the set of matrices with rank at most  @xmath4 is a union of polyhedral cones , and we compute the dimension of these sets , defined as the dimension of the largest cone . in each case",
    ", the dimension of the tropical secant set equals the dimension of the clasical secant variety , confirming draisma s observation that tropical geometry provides useful lower bounds for the dimensions of classical secant varieties  @xcite .",
    "finally , we give a combinatorial characterization of each notion of rank for a @xmath33 matrix in terms of graph covers .    in section  [ sec : sym - barv-3 ] , we examine @xmath34 symmetric matrices and explicitly characterize the stratification by symmetric barvinok rank . in sections",
    "[ sec : star - tree-5 ] and  [ sec : tree-5 ] , we do the same for the @xmath35 dissimilarity matrices and the stratifications by star tree rank and tree rank respectively . in particular , we show that the lower bounds from the chromatic number in section  [ sec : def - graph ] are exact in these cases .",
    "we close with some open problems in section  [ sec : open - questions ] .",
    "before we examine our three notions of rank , we give a general combinatorial construction : a hypergraph whose chromatic number yields a lower bound on rank .",
    "recall that a _ hypergraph _ consists of a ground set , called vertices , and a set of subsets of the ground set , called hyperedges .",
    "the _ chromatic number _ of a hypergraph  @xmath36 , denoted @xmath37 , is the smallest number @xmath38 such that the vertices of @xmath39 can be partitioned into @xmath40 color classes with no hyperedge of @xmath39 monochromatic .",
    "in particular , if @xmath36 contains a hyperedge of size  @xmath0 , then @xmath41 is  @xmath42 .    now , suppose we have a tropical prevariety @xmath43 .",
    "recall that a tropical polynomial @xmath44 defines a tropical hypersurface consisting of those vectors @xmath45 such that the minimum in evaluating @xmath46 is achieved at least twice .",
    "a _ tropical prevariety _ is the intersection of finitely many tropical hypersurfaces , and any finite set  @xmath47 of tropical polynomials defining the prevariety @xmath48 is called a _",
    "tropical basis_.    now , given a point @xmath49 and a tropical basis @xmath47 for  @xmath48 , we construct a hypergraph on ground set @xmath50 $ ] as follows .",
    "let @xmath51 from  ( [ eqn : tropical - polynomial ] ) be a tropical polynomial in  @xmath47 , with all exponents @xmath52 .",
    "if the minimum is achieved uniquely when @xmath51 is evaluated at @xmath53 , then we add a hyperedge @xmath54 whose elements correspond to the coordinates that appear with non - zero exponent in the unique minimal term .",
    "the _ deficiency hypergraph _ of  @xmath53 with respect to  @xmath48 and  @xmath47 consists of hyperedges coming from all polynomials in @xmath47 with a unique minimum at  @xmath53 .",
    "in particular , the deficiency hypergraph has no hyperedges ( and thus has chromatic number @xmath0 ) if and only if @xmath53 is in  @xmath48 .",
    "[ prop : deficiency - hypergraph ] if @xmath36 is the deficiency hypergraph constructed above , then the rank of @xmath55 with respect to @xmath56 is at least @xmath41 .",
    "suppose that @xmath53 has rank @xmath57 with respect to  @xmath48 , and let @xmath58 be an expression of @xmath53 as the tropical sum of @xmath57 points @xmath59 .",
    "we will construct an @xmath57-coloring of the deficiency hypegraph  @xmath36 , which will show that @xmath60 .",
    "for each @xmath61 $ ] , there is at least one @xmath62 which agrees with @xmath53 in the @xmath63th coordinate , so arbitrarily pick one such @xmath64 as the color for vertex  @xmath63 in  @xmath36 .",
    "let @xmath54 be a hyperedge of  @xmath36 and @xmath51 the associated tropical polynomial .",
    "we claim that @xmath54 can not be monochromatic with color  @xmath64 .",
    "each coordinate of @xmath62 is greater than or equal to the corresponding coordinate of  @xmath53 , so each term of @xmath65 is greater than or equal to the corresponding term of @xmath66 . on the other hand ,",
    "the minimum in the evaluation of @xmath65 is achieved at least twice , so the minimum must be strictly greater than @xmath66 .",
    "thus , @xmath62 can not agree with @xmath53 for all coordinates in @xmath54 , so @xmath54 is not monochromatic of color  @xmath64 .",
    "this holds for any color  @xmath64 , so we have constructed an @xmath57-coloring , and thus , @xmath60 .",
    "[ cor : singleton ] if the deficiency hypergraph @xmath36 has a hyperedge of size  @xmath0 , then the rank of @xmath53 with respect to @xmath48 is infinite .",
    "if @xmath36 has a hyperedge of size  @xmath0 , then @xmath41 is @xmath42 , and thus the rank of @xmath53 is infinite .",
    "we do not know of any examples in which this lower bound is actually strict ; see section  [ sec : open - questions ] .    for the varieties considered in this paper",
    ", we will take quadratic tropical bases and thus the deficiency hypergraph will always be a graph ( possibly with loops ) .",
    "accordingly , we will call it the _ deficiency graph_.",
    "recall from the introduction that the symmetric barvinok rank of a symmetric matrix @xmath27 is the smallest number  @xmath57 such that @xmath27 can be written as the sum of @xmath57 rank  @xmath0 symmetric matrices .",
    "the @xmath67 minors @xmath68 of @xmath27 for @xmath69 and @xmath70 form a tropical basis for the variety of rank  @xmath0 symmetric matrices .",
    "we will always construct our deficiency graph with respect to this tropical basis .",
    "our first observation is that the symmetric barvinok rank of a matrix can be infinite .",
    "more precisely ,    [ prop : inf - rank ] if @xmath27 is a symmetric matrix and @xmath71 for some @xmath63 and  @xmath64 , then the symmetric barvinok rank of @xmath27 is infinite .",
    "the tropical polynomial @xmath72 is in the tropical basis , so if @xmath73 for some @xmath74 and @xmath75 , then the deficiency graph for  @xmath27 has a loop at the node @xmath76 .",
    "therefore , @xmath27 has infinite rank by corollary  [ cor : singleton ] .",
    "in fact , the converse to proposition  [ prop : inf - rank ] is also true ; see theorem  [ thm : max - rank ] . in order to construct decompositions into rank  @xmath0 matrices , we need the following lemma .    [",
    "lem : rank-1-extn ] let @xmath27 be an @xmath77 symmetric barvinok rank  @xmath0 matrix , @xmath78 an integer and @xmath79 any real number .",
    "then there exists an @xmath15 symmetric rank  @xmath0 matrix  @xmath80 such that the upper left @xmath77 submatrix is @xmath27 and every other entry is at least  @xmath79 .    since @xmath27 has rank  @xmath0 , then @xmath81 for some row vector @xmath24 .",
    "let @xmath82 , and let @xmath53 be the vector consisting of @xmath24 followed by @xmath83 repeated @xmath84 times .",
    "then @xmath85 has the desired properties .",
    "[ rmk : rank-1-extn ] we will use the symbol @xmath42 in an entire row and column of a matrix to denote sufficiently large values that maintain the property of being rank  @xmath0 .",
    "so , if @xmath27 is an @xmath77 rank  @xmath0 matrix , then @xmath86 denotes the @xmath87 matrix obtained by applying lemma  [ lem : rank-1-extn ] with @xmath88 .",
    "the value of  @xmath79 will be clear from the context .",
    "next , we give a graph - theoretic characterization of the symmetric barvinok rank of @xmath33-matrices .",
    "we define a _ clique cover _ of a simple graph  @xmath89 to be a collection of @xmath57 complete subgraphs such that every edge and every vertex of @xmath90 is in some element of the collection . given an @xmath15 symmetric @xmath33 matrix @xmath27 with zeroes on the diagonal , define @xmath91 to be the graph whose vertices are the integers @xmath92 $ ] , and which has an edge between @xmath63 and  @xmath64 if and only if @xmath93 .",
    "[ prop : zero - inf - rank ] suppose @xmath27 is a symmetric @xmath33 matrix with zeroes on the diagonal .",
    "then the symmetric barvinok rank of @xmath27 is the size of a smallest clique cover of  @xmath94 .    on the other hand ,",
    "suppose that @xmath27 is a symmetric @xmath33 matrix with at least one entry of @xmath0 on the diagonal .",
    "if there exist @xmath63 and @xmath64 such that @xmath95 and @xmath93 , then the symmetric barvinok rank of  @xmath27 is infinite . otherwise , let @xmath96 be the maximal principal submatrix with zeroes on the diagonal .",
    "the symmetric barvinok rank of @xmath27 is one greater than the symmetric barvionk rank of @xmath96 .",
    "first suppose that all diagonal entries of @xmath97 are @xmath98 .",
    "let @xmath99 be a clique cover of @xmath91 .",
    "let @xmath100 be the @xmath101 row vector whose @xmath64th entry is @xmath98 if @xmath64 is a vertex of  @xmath102 , and let @xmath103 .",
    "then we claim that @xmath104 . each  @xmath98 entry in @xmath27 corresponds to an edge or vertex of @xmath91 which is in some @xmath102 , so there is a @xmath98 in @xmath105 . for @xmath106 such that @xmath107 , some @xmath102 contains the vertex  @xmath64 , and hence misses the vertex @xmath4 , so @xmath108 . on the other hand ,",
    "the entry is at least @xmath0 in the other rank  @xmath0 matrices because none of the corresponding graphs contains @xmath109 as an edge .",
    "thus the rank of @xmath27 is at most  @xmath57 .",
    "conversely , suppose @xmath80 is a rank  @xmath0 symmetric matrix in a decomposition of @xmath27 .",
    "since all entries of @xmath27 are non - negative , so are the entries of @xmath80 , so the rank  @xmath0 condition says @xmath110 if and only if @xmath111 . by the `` if '' direction , we can define a graph @xmath112 whose vertices and edges correspond to the diagonal and off - diagonal zeroes of @xmath80 respectively . by the",
    "`` only if '' direction , this is a complete graph .",
    "every position with a @xmath98 in @xmath27 must be  @xmath98 for some rank  @xmath0 matrix in the decomposition , so the graphs @xmath112 form a clique cover of @xmath91 as @xmath80 ranges over all rank  @xmath0 symmetric matrices in the decomposition . thus , the rank of @xmath27 is exactly  @xmath57 .",
    "next , we suppose @xmath113 has at least one @xmath0 on the diagonal and let @xmath114 be as in the statement . if there exist @xmath74 and @xmath75 such that @xmath115 but @xmath116 , then the rank of @xmath113 is infinite by proposition  [ prop : inf - rank ]",
    "otherwise , we claim that the rank of @xmath27 is @xmath117 . extending each rank 1 summand of a minimal decomposition of @xmath118 by lemma  [ lem : rank-1-extn ] and adding in",
    "the all ones matrix shows that the rank of @xmath27 is at most @xmath119 . on the other hand , it is straightforward to check that a rank 1 summand containing a 1 entry on the diagonal can contain no zeroes , so does not contribute to a clique cover for @xmath120 .",
    "so the rank of @xmath27 is exactly @xmath117 in this case .",
    "[ rmk : bipartite_graph ] this characterization gives us two families of matrices which have rank  @xmath26 and @xmath121 respectively , namely those corresponding to the trivial graph with @xmath26 isolated vertices and the complete bipartite graph @xmath122 . in the latter case , @xmath122 is triangle - free , so no clique can consist of more than one edge . on the other hand ,",
    "there are @xmath123 edges in the graph , so @xmath121 cliques are needed in a cover .",
    "in fact , these two examples have the maximum possible rank for @xmath16 matrices , as shown below .",
    "[ thm : max - rank ] suppose that @xmath27 is a symmetric @xmath16 matrix with @xmath124 for all @xmath63 and  @xmath64 .",
    "then the symmetric barvinok rank of @xmath27 is at most @xmath125 , and this bound is tight .",
    "thus , every matrix with finite rank has rank at most @xmath126 .    subtracting @xmath127 from the @xmath63th row and column for",
    "all @xmath63 does not change the rank , so we can assume that the diagonal entries of @xmath27 are @xmath98 and hence , by hypothesis , the off - diagonal entries are non - negative .",
    "the statement is trivial for @xmath128 . for @xmath129",
    ", we have @xmath130 for @xmath131 , we assume , without loss of generality , that @xmath132 . then @xmath133 where `` @xmath42 '' is as in remark  [ rmk : rank-1-extn ] . for @xmath26",
    "at least @xmath134 , the proof is by induction , using the following lemma :    [ lem : max - rank - induction ] let @xmath135 .",
    "suppose that for any @xmath136 matrix @xmath80 of finite rank , there exists a matrix @xmath137 of rank at most @xmath138 , such that @xmath137 is identical to  @xmath80 except possibly in one diagonal entry , where the entry of @xmath137 is greater than or equal to the entry of  @xmath80",
    ". then any @xmath139 matrix has rank at most  @xmath140 .",
    "the exceptional diagonal entry in the hypothesis makes the statement of the lemma slightly stronger than what is required for an inductive proof of an @xmath123 upper bound .",
    "however , we will use the lemma to establish the base cases of the induction , @xmath141 and @xmath142 , which require a weaker hypothesis because for @xmath129 and @xmath131 the @xmath143 upper bound on rank does not hold .",
    "let @xmath27 be an @xmath16 matrix with finite rank . without loss of generality ,",
    "assume that the entry @xmath144 is minimal among all off - diagonal elements .",
    "we apply the hypothesis to the principal submatrix indexed by @xmath145 . applying lemma  [ lem : rank-1-extn ]",
    ", we have a collection of at most @xmath146 rank @xmath0 matrices whose tropical sum agrees with @xmath27 except for the first two rows and columns and possibly one diagonal entry , which , without loss of generality , we assume to be @xmath147 . for each @xmath148 , take the rank  @xmath0 matrix which has arbitrary large values except for the @xmath149 principal submatrix , which is : @xmath150 note that since @xmath144 was chosen to be minimal , we have that @xmath151 .    finally , switching indices @xmath0 and @xmath22 if necessary",
    ", we can assume that @xmath152 , and hence @xmath153 .",
    "then , we take two matrices which are `` @xmath42 '' outside of the @xmath154 principal matrices , which are , respectively , @xmath155 recalling the meaning of `` @xmath42 '' from remark  [ rmk : rank-1-extn ] .",
    "this yields a decomposition of @xmath27 into at most @xmath156 symmetric rank  @xmath0 matrices .    to complete the proof of the theorem  [ thm : max - rank ]",
    ", we note that taking all but the last term of  ( [ eqn : decomp-2 ] ) and  ( [ eqn : decomp-3 ] ) gives the hypothesis to lemma  [ lem : max - rank - induction ] for @xmath141 and  @xmath157 .",
    "the desired upper bound follows by induction , which consists of applying lemma  [ lem : max - rank - induction ] with @xmath158 .",
    "finally , remark  [ rmk : bipartite_graph ] shows that this bound is tight .    the dimension of the space of symmetric @xmath15 matrices of symmetric barvinok rank at most  @xmath57 is @xmath159 , which is the dimension of the classical secant variety , i.e.  the space of classical symmetric matrices of classical rank at most  @xmath57 .",
    "let @xmath160 .",
    "the tropical secant variety is contained in the tropicalization of the classical secant variety , so the dimension is at most @xmath161 , by the bieri - groves theorem  ( * ? ?",
    "thus , it is sufficient to find an open neighborhood in which the tropical variety has dimension  @xmath161 . for @xmath63 from  @xmath0 to  @xmath57 , let @xmath162 be a vector with @xmath79 for the first @xmath163 entries .",
    "choose the coordinates @xmath164 to be smaller than all the @xmath165 and let @xmath79 be very large .",
    "then , @xmath166 this matrix is an injective function of the vector entries @xmath167 for @xmath168 and @xmath169 .",
    "thus , it defines a neighborhood of the @xmath57th secant set of the desired dimension @xmath170",
    "recall from the introduction that a star tree matrix is one which can be written as @xmath171 for @xmath172 a row vector .",
    "the star tree matrices from a classical linear space in the space of @xmath15 dissimilarity matrices defined by the tropical polynomials @xmath173 in this section , the deficiency graph will always be taken with respect to this tropical basis .",
    "the following lemma is an immediate consequence of lemma  [ lem : rank-1-extn ] .",
    "[ lem : star - tree - extn ] let @xmath27 be an @xmath174 star tree matrix , and let @xmath78 be any integer and @xmath79 any real number .",
    "then there exists an @xmath15 star tree matrix with @xmath27 as the upper left @xmath77 submatrix and all other entries greater than  @xmath79 .    unlike the case of symmetric barvinok rank , the star tree rank is always finite .",
    "[ thm : max - star - tree - rank ] for @xmath26 at least @xmath175 , the star tree rank of a @xmath15 dissimilarity matrix  @xmath27 is at most @xmath176 , and this bound is sharp . in particular , the dissimilarity matrix defined by @xmath177 has star tree rank @xmath176 .",
    "the proof of the upper bound is by induction on @xmath26 . for @xmath131 ,",
    "the equations in  ( [ eqn : basis - star - tree ] ) are trivial , and thus every @xmath178 dissimilarity matrix is a star tree matrix . for @xmath179 ,",
    "let @xmath27 be an @xmath15 dissimilarity matrix , and denote by @xmath96 the upper left @xmath180 submatrix . by the inductive hypothesis",
    ", we can write @xmath96 as the tropical sum of @xmath181 star tree matrices . we can extend each of these to @xmath16 star tree matrices by lemma  [ lem : star - tree - extn ] , and their tropical sum will agree with @xmath27 except in the last column and row .",
    "let @xmath53 be the vector defined by @xmath182 for @xmath183 and @xmath184 , for @xmath79 a sufficiently large number .",
    "then the tropical sum of the previous @xmath181 matrices together with @xmath185 equals  @xmath27 .",
    "now let @xmath27 be the dissimilarity matrix defined by @xmath177 as in the statement .",
    "we claim that the deficiency graph of @xmath27 has chromatic number  @xmath176 . for every @xmath186 ,",
    "we have @xmath187 so the deficiency graph has an edge between @xmath188 and @xmath189 , and an edge between @xmath190 and @xmath191 .",
    "we refer to these types of edges as `` overlapping '' and `` nesting '' respectively .",
    "we prove that the deficiency graph of @xmath27 has chromatic number at least @xmath176 by induction on @xmath26 .",
    "the case of @xmath131 is clear .",
    "let @xmath26 be greater than @xmath175 and fix a coloring of the deficiency graph of @xmath27 .",
    "let @xmath47 be the set of nodes of the same color  @xmath192 as the node  @xmath193 .",
    "there is a `` nesting '' edge between @xmath193 and every node other than those of the form @xmath194 or @xmath195 for some  @xmath63 .",
    "thus , every node in @xmath47 is either of the form @xmath194 or @xmath195 .",
    "furthermore , because of the `` overlapping '' edges , there must be an integer @xmath196 such that if @xmath194 is in @xmath47 , then @xmath197 and if @xmath198 is in @xmath47 , then @xmath199 .",
    "now consider the set of @xmath181 nodes consisting of @xmath194 for @xmath200 and @xmath198 for @xmath201 . by our construction of  @xmath196 ,",
    "none of them is in  @xmath47 .",
    "therefore , if they have distinct colors , then the coloring has at least @xmath176 colors , which is what we wanted to show .",
    "otherwise , two of these nodes have the same color , and by the `` overlapping '' edges and symmetry we can assume that they are @xmath194 and @xmath202 , with @xmath203 , which have color  @xmath204 .",
    "any node @xmath191 with @xmath205 and @xmath206 will share an edge with one of these two nodes , so can not have color @xmath207 . on the other hand ,",
    "if the node @xmath208 with @xmath209 is adjacent to @xmath191 with @xmath210 , then we must have @xmath211 .",
    "but @xmath212 , so @xmath191 can not have color  @xmath207 .",
    "thus , we can assume that all of the nodes @xmath208 with @xmath209 also have color  @xmath207 without changing the fact that the coloring is proper . with this change ,",
    "the only nodes with color  @xmath192 are of the form  @xmath198 . by restricting to the nodes with coordinates",
    "less than  @xmath26 , we have a coloring of the deficiency graph of the @xmath213 matrix without the color  @xmath192 , so by the inductive hypothesis we re done .",
    "the matrix with maximal star tree rank in the previous theorem is in fact in the grassmannian , i.e.  it has tree rank  @xmath0 .",
    "indeed , from  ( [ eqn : m-4-point ] ) , we see that the four - point condition holds .",
    "alternatively , @xmath27 arises as the distance matrix of the following weighted tree .",
    "let @xmath214 be the caterpillar tree with @xmath26 internal vertices , connected in order by edges of weight @xmath215 .",
    "the @xmath63th leaf vertex is connected to the @xmath63th internal vertex by an edge of weight @xmath216 . for @xmath217 ,",
    "the distance from leaf  @xmath63 to leaf  @xmath64 is @xmath218 , which is equal to the corresponding entry in the matrix @xmath27 from theorem  [ thm : max - star - tree - rank ] . in order to make a proper phylogenetic tree ,",
    "we should remove the first and last internal vertices and combine the adjacent edge weights .",
    "next , we give a graph theoretic characterization of the star tree rank of @xmath33-matrices .",
    "for @xmath27 a @xmath33 dissimilarity matrix , we define @xmath91 to be the graph whose edges correspond to the zeroes of @xmath27 . as in the case of symmetric barvinok rank",
    ", we can characterize the star tree rank of  @xmath27 in terms of covers of  @xmath91 , this time by both cliques and star trees .",
    "we will also say that a cover of  @xmath91 by cliques and star trees is a _ solid cover _",
    "if for every pair of distinct vertices @xmath63 and @xmath64 either :    1 .",
    "there is an edge between @xmath63 and @xmath64 , 2 .   either @xmath63 or @xmath64 belongs to a clique in the cover , 3 .",
    "either @xmath63 or @xmath64 is the center of a star tree in the cover , or 4 .",
    "both @xmath63 and @xmath64 are leaves of the same star tree .",
    "[ prop : star - tree - rank-01 ] let @xmath27 be a @xmath33 dissimilarity matrix .",
    "let @xmath57 be the minimal number of graphs in a cover of @xmath91 by cliques and star trees , such that every edge ( but not necessarily every vertex ) is in some element of the cover .",
    "then @xmath27 has star tree rank either @xmath57 or  @xmath219 .",
    "moreover , if @xmath91 has a solid cover by @xmath57 graphs , then @xmath27 has star tree rank  @xmath57 .",
    "let @xmath99 be a cover of @xmath91 by cliques and star trees . for @xmath102 a clique , define @xmath100 to be the @xmath33 vector whose @xmath98 entries correspond to the vertices of the clique .",
    "if @xmath102 is a star tree consisting of a central vertex @xmath220 and edges to vertices in the set @xmath221 , then define @xmath100 to be the row vector which is @xmath215 in the @xmath220 entry , @xmath222 for the entries corresponding to @xmath221 and @xmath223 otherwise . in either case , define @xmath224 .",
    "then @xmath105 has @xmath98 entries corresponding to the edges of @xmath102 .",
    "thus , the tropical sum of the @xmath105 has the same @xmath98 entries as @xmath27 .",
    "moreover , if the cover is a solid cover then the tropical sum is equal to @xmath27 , so @xmath27 has rank at most  @xmath57",
    ". otherwise , some of the positive entries of the tropical sum are greater than @xmath0 . by additionally taking the tropical sum with the all ones matrix",
    ", we see that @xmath27 has rank at most @xmath219 .",
    "conversely , suppose that @xmath225 is a term in a representation of  @xmath27 as the tropical sum of star tree matrices .",
    "then we claim that the zeroes of @xmath105 correspond to either a star tree or a complete graph .",
    "if all entries of @xmath100 are non - negative , then the zeroes of @xmath105 correspond to the complete graph on the vertices where @xmath100 is @xmath98 .",
    "otherwise , since @xmath105 must be non - negative , there can be at most one negative entry of  @xmath100 , say with value @xmath226 ; then all other entries must be at least @xmath227 .",
    "then the @xmath98 entries of @xmath105 correspond to the star tree with edges between the entry with @xmath226 and the entries with value  @xmath227 .",
    "thus , any decomposition of @xmath27 as the tropical sum of star tree metrics yields a cover of @xmath91 by cliques and star trees , so @xmath27 has tropical rank at least @xmath57 .",
    "we do not know if the definition of a solid cover can be weakened in any way .",
    "in other words , we do not know of any @xmath33 matrices @xmath27 such that @xmath57 is the minimal size of a cover of @xmath91 by cliques and star trees , and @xmath91 does not have a solid cover of size @xmath57 , but @xmath27 has star tree rank  @xmath57 .",
    "in contrast to symmetric barvinok rank , the upper bound of @xmath176 on the star tree rank of an @xmath228 dissimilarity matrix can not be achieved by a @xmath33 matrix for large  @xmath26 .",
    "recall that the _ ramsey number _",
    "@xmath229 is the smallest integer such that any graph on at least @xmath229 vertices has either a clique or a independent set of size  @xmath4 .",
    "then we have the following stronger bound on the star tree rank of a @xmath33 matrix .",
    "for @xmath230 , any @xmath16 @xmath33 dissimilarity matrix has star tree rank at most @xmath231 .    by the assumption on @xmath26 ,",
    "the graph @xmath91 has either a clique of size @xmath4 or an independent set of size @xmath4 . in the former case",
    ", we can cover @xmath91 by a star tree centered at each vertex not part of the clique , together with the clique itself .",
    "this gives a solid cover by @xmath232 subgraphs . in the latter case",
    ", we can just take the star trees centered at the vertices not in the independent set , giving a cover of @xmath91 by @xmath233 subgraphs . in either case",
    ", proposition  [ prop : star - tree - rank-01 ] shows that @xmath27 has rank at most @xmath232 .",
    "for @xmath234 , every @xmath15 @xmath33 dissimilarity matrix has star tree rank at most @xmath181 .",
    "the ramsey number @xmath235 is @xmath236  @xcite .",
    "let @xmath38 and @xmath237 be positive integers",
    ". then the dimension of the space of dissimilarity @xmath228 matrices of star tree rank at most @xmath38 is @xmath238    let @xmath239 be the dimension from the theorem statement",
    ". the dimension can not be any larger than @xmath161 by the bieri - groves theorem  ( * ? ? ?",
    "a ) , because @xmath161 is the dimension of the classical secant variety , according to theorem  2 in  @xcite .",
    "therefore , it is sufficient to construct a matrix with star tree rank  @xmath57 which has a @xmath161-dimensional neighborhood of star tree rank  @xmath57 matrices . if @xmath240 , then @xmath161 is @xmath241 , the dimension of the set of @xmath242 dissimilarity matrices .",
    "since higher secant sets can not have smaller dimension , it is sufficient to assume @xmath243 .",
    "we will construct @xmath57 vectors @xmath244 , with @xmath245 denoting the @xmath63th entry of @xmath246 , and then define @xmath27 to be the tropical sum of the star tree matrices @xmath247 .",
    "first , we fix any order on the set of pairs of distinct integers @xmath248 .",
    "then , for @xmath249 and @xmath250 , we choose @xmath245 as follows : if the @xmath4th pair of integers includes @xmath63 , then we choose @xmath245 in the range @xmath251 and otherwise we choose @xmath252 . for @xmath63 in the range @xmath253 , we choose @xmath245 inductively beginning with @xmath254 .",
    "we choose @xmath255 arbitrarily .",
    "then for @xmath256 , and @xmath253 , we choose @xmath257 to be much greater than any of the @xmath258 already chosen .",
    "finally , let @xmath79 be a large real number and set @xmath259 equal to @xmath79 , for @xmath260 .",
    "let @xmath27 be the tropical sum of the @xmath261 .",
    "we claim that the set of matrices which can be gotten in this way forms a @xmath161-dimensional affine linear neighborhood . for @xmath262 and @xmath217 ,",
    "the @xmath263 entry of @xmath27 comes from @xmath105 and in particular , is equal to @xmath264 . for a fixed @xmath63 , and taking @xmath265 , these entries give us @xmath266 linearly independent functions on the matrix  @xmath27 .",
    "moreover , if @xmath263 is the @xmath4th pair in the ordering on @xmath47 , and @xmath267 , then the @xmath263 entry of @xmath27 comes from @xmath268 and is equal to @xmath269 .",
    "these are linearly independent from each other and from all of the previous functions .",
    "since the size of  @xmath47 is @xmath270 , the number of linearly independent functions on the matrix @xmath27 is @xmath271 which is the desired dimension , @xmath161 .",
    "in fact , the difficult part of theorem  2 in  @xcite is proving the lower bound on the dimension of the classical secant variety .",
    "our computation of the dimension of the tropical secant variety provides an alternative proof of this lower bound .",
    "the tropical grasmmannian @xmath25 is the tropical variety defined by the @xmath175-term plcker relations : @xmath272 this condition is equivalent to coming from the distances along a weighted tree which has negative weights along the internal edges  ( * ? ? ?",
    "* sec .  4 ) .",
    "in this section , we will always take the deficiency graph to be with respect to the plcker relations in  ( [ eqn : plucker ] ) .",
    "as with the previous notions of rank , the tree rank of a @xmath33 matrix can be characterized in terms of covers of graphs . for any disjoint subsets @xmath273 $ ] ( not necessarily a partition ) , the _ complete @xmath4-partite graph _ is the graph which has an edge between the elements of @xmath221 and @xmath274 for all @xmath275 .",
    "complete @xmath13-partite graphs are characterized by the property that among vertices which are incident to some edge , the relation of having a non - edge is a transitive relation .",
    "the complete @xmath4-partite graphs defined above are exactly those graphs whose edge set forms the set of bases of a rank  @xmath22 matroid on @xmath26 elements .",
    "the transitivity of being a non - edge is equivalent to the basis exchange axiom .",
    "alternatively , each of the sets @xmath276 partition the set of non - loops in the matroid into parallel classes . see  @xcite for definitions of these terms . in the following proposition , we will see that the plcker relations imply the basis exchange axiom for the @xmath98 entries of a non - negative tree matrix .",
    "[ prop : tree - rank-01 ] let @xmath27 be an @xmath15 @xmath33 dissimilarity matrix and let @xmath57 be smallest size of a cover of @xmath91 by complete @xmath4-partite subgraphs . as in proposition  [ prop : star - tree - rank-01 ] , we only require every edge to be in the cover , not necessarily every vertex",
    ". if @xmath91 has at most one isolated vertex then @xmath27 has tree rank @xmath57 . otherwise , @xmath27 has tree rank @xmath219 .",
    "let @xmath276 be disjoint sets defining a @xmath4-partite graph .",
    "we construct a tree which has @xmath277 internal vertices : one vertex @xmath100 for each @xmath278 $ ] and a vertex @xmath53 .",
    "every element of @xmath221 has a branch of length @xmath222 to @xmath100 and each @xmath100 has a branch of length @xmath215 to @xmath53 .",
    "the elements of @xmath279 \\setminus ( i_1 \\cup \\cdots \\cup i_k)$ ] are connected to @xmath53 by a branch of length @xmath0 .",
    "this gives a distance matrix whose entries are @xmath98 for the edges of the @xmath4-partite graph , @xmath22 for the entries between elements of @xmath280 , and @xmath0 elsewhere . if @xmath91 has at most one isolated vertex , then the sum of these matrices is @xmath27 .",
    "otherwise , adding the matrix with all entries entries equal to @xmath0 yields @xmath27 .",
    "conversely , suppose we have a decomposition of @xmath27 as the sum of tree matrices .",
    "for each tree matrix , we can define a graph on the vertices @xmath92 $ ] with edges corresponding to the @xmath98 entries . these form",
    "a cover of the graph of @xmath27 , so we just need to show that the graph @xmath281 coming from a tree matrix will be a complete @xmath4-partite graph . for this , we need to show that the relation of having a non - edge is a transitive relation among vertices which are incident to some edge .",
    "suppose that @xmath263 and @xmath282 are non - edges , but @xmath283 is an edge .",
    "also suppose that @xmath64 has an edge to some other vertex @xmath284 .",
    "then @xmath285 , but @xmath286 and @xmath287 are positive and @xmath288 and @xmath289 are non - negative , which contradicts the plcker relation .",
    "thus , @xmath281 is a complete @xmath4-partite graph , and we have proved the theorem when @xmath91 has at most one isolated vertex .",
    "now suppose that @xmath91 has at least @xmath22 isolated vertices , @xmath63 and  @xmath64 .",
    "there must be some tree matrix @xmath214 in the decomposition of @xmath91 such that @xmath290 .",
    "suppose that the corresponding graph @xmath281 has an edge between two vertices @xmath4 and  @xmath284 , which must be distinct from @xmath63 and  @xmath64 by assumption .",
    "since @xmath63 and  @xmath64 are isolated , @xmath291 , @xmath292 , @xmath293 , and  @xmath294 must each be at least  @xmath0 .",
    "but @xmath295 , which contradicts the plcker relation .",
    "thus , @xmath281 must be the trivial graph , so the decomposition of @xmath27 must have one more term than a minimal cover of @xmath91 .",
    "therefore , @xmath27 has rank @xmath296 .",
    "note that by taking the @xmath221 in the definition of @xmath4-partite graph to be singletons , we get complete graphs , and by taking @xmath297 with @xmath298 a singleton and @xmath299 any set disjoint from @xmath300 , we get star trees . together with propositions  [ prop : star - tree - rank-01 ] and  [ prop : tree - rank-01 ] , this confirms , for @xmath33-matrices , the second inequality in  ( [ eqn : rank - inequals ] ) .",
    "[ lem : extn - tree - rank-1 ] let @xmath27 be an @xmath174 tree matrix , @xmath78 an integer , and @xmath79 any real number .",
    "then there exists an @xmath15 tree matrix @xmath80 , whose upper left @xmath174 submatrix is @xmath27 and such that the other entries are each at least  @xmath79 .",
    "the matrix @xmath27 encodes the distances on some weighted tree @xmath214 on @xmath196 leaves .",
    "pick any internal vertex @xmath24 of  @xmath214 and let @xmath83 be the smallest distance between @xmath24 and a leaf of @xmath196 .",
    "let @xmath301 be the tree on @xmath26 leaves formed from @xmath214 by attaching each leaf @xmath63 with @xmath302 to @xmath24 by an edge with weight @xmath303 .",
    "let @xmath80 be the distance matrix of @xmath301 and @xmath80 is a tree matrix with the desired properties .",
    "the dimension of the set of dissimilarity @xmath15 matrices of tree rank at most @xmath57 is the dimension of the classical secant variety , @xmath304    the tropical secant variety is contained in the tropicalization of the classical variety , which has the given dimension by  ( * ? ? ?",
    "therefore , it is sufficient to prove that the tropical secant variety has at least the given dimension by the bieri - groves theorem  ( * ? ? ?",
    "a ) .    to prove the lower bound on the dimension , first note that for @xmath305",
    ", @xmath306 is either @xmath98 or  @xmath0 , so the first part of the statement implies that the dimension of the @xmath57th secant set is @xmath241 , the dimension of the space of dissimilarity @xmath15 matrices .",
    "since higher secant varieties are at least as large as the preceeding ones , this implies the second part of the statement .",
    "the proof of the first part , when @xmath307 , is by induction on @xmath26 . for @xmath308",
    "all dissimilarity matrices have tree rank  @xmath0 , because the four - point condition is trivial .",
    "thus , the dimension of the @xmath0st secant set is @xmath309 , as desired .",
    "now suppose @xmath310 and by the inductive hypothesis , let @xmath80 be an @xmath311 matrix of tree rank at most @xmath312 such that the locus of matrices with tree rank at most @xmath312 has dimension @xmath313 in a neighborhood of @xmath80 .",
    "consider the caterpillar tree with leaves in the order @xmath0 , @xmath175 , @xmath134 , ",
    ", @xmath26 , @xmath22 , pendant edge length @xmath314 for leaf @xmath63 , and negative internal edges @xmath315 .",
    "thus , the first two rows and columns of the distance matrix @xmath27 are defined by : @xmath316 just from the values in these two rows , we can solve for the values of the edge lengths : @xmath317 therefore , the projection onto the first two columns has dimension @xmath318 in a neighborhood of this point .",
    "assume that the @xmath314 are sufficiently negative that the lower right @xmath319 submatrix of @xmath27 is less than @xmath80 in every entry .",
    "then @xmath320 has tree rank at most @xmath57 and has a neighborhood of such matrices of dimension @xmath321 which is the desired expression .    unlike the cases of symmetric barvinok",
    "rank and star tree rank , we do not know the maximum tree rank of a @xmath16 dissimilarity matrix for large @xmath26 .",
    "we have an upper bound of @xmath176 by theorem  [ thm : max - star - tree - rank ] , and we can improve on this slightly :    [ thm : tree - rank - n-3 ] for @xmath322 , a @xmath15 dissimilarity matrix  @xmath27 has tree rank at most @xmath181 .",
    "let @xmath27 be a @xmath323 dissimilarity matrix .",
    "consider the tropical polynomial whose terms correspond to the perfect matchings on @xmath324 vertices : @xmath325 note that this is the tropicalization of the pfaffian of a @xmath326 dissimilarity matrix ( see , for example  ( * ? ? ?",
    "* ch .  7 ) ) .",
    "after relabeling the vertices , we can assume that the minimum is achieved by the term @xmath327 .",
    "in particular , this means that for the @xmath134-point condition applied to the upper left @xmath328 matrix , the minimum is achieved by @xmath329 .",
    "we can set @xmath330 equal to the smaller of @xmath331 and @xmath332 , so that the matrix @xmath333 is a tree matrix .",
    "moreover , by our assumption , we have that @xmath334 . by similar logic , there exist @xmath335 and @xmath336 such that the following is an expression of  @xmath27 as the tropical sum of @xmath175 tree matrices : @xmath337 therefore , @xmath27 has tree rank at most  @xmath175 .    for @xmath338",
    ", the theorem follows from lemma  [ lem : tree - rank - submatrix ] .",
    ".maximum possible tree rank of an @xmath16 dissimilarity matrix , to the best of our knowledge .",
    "the upper bounds come from theorems  [ thm : max - star - tree - rank ] and  [ thm : tree - rank - n-3 ] .",
    "the examples have the largest tree ranks that are known to us .",
    "the omitted examples can be provided by taking a principal submatrix of a larger example , by lemma  [ lem : tree - rank - submatrix ] . [",
    "cols=\"<,<,<\",options=\"header \" , ]     beginning with @xmath339 , we do nt know whether or not the bound in theorem  [ thm : tree - rank - n-3 ] is sharp . for the following @xmath340 matrix , found by random search ,",
    "the deficiency graph was computed to have chromatic number @xmath324 : @xmath341 together with theorem  [ thm : tree - rank - n-3 ] , this computation shows that @xmath27 has tree rank  @xmath324 . for any @xmath342",
    ", we can form an @xmath343 matrix @xmath268 by putting @xmath27 in blocks along the diagonal and setting all other entries to @xmath344 .",
    "the deficiency graph of @xmath268 includes @xmath4 copies of the deficiency graph of @xmath27 , and all edges between distinct copies .",
    "therefore , the chromatic number , and thus the tree rank , are at least @xmath345 .    on the other hand , in order to provide examples of an @xmath15 matrix with tree rank @xmath181 for all @xmath346 , we have the following lemma .",
    "[ lem : tree - rank - submatrix ] let @xmath27 be an @xmath16 matrix . if any @xmath347 principal submatrix has tree rank @xmath57 , then @xmath27 has tree rank at most @xmath348 .",
    "fix a decomposition of the @xmath347 principal submatrix into @xmath57 tree matrices .",
    "we can extend each tree matrix to an @xmath16 tree matrix by lemma  [ lem : extn - tree - rank-1 ] .",
    "for each index  @xmath63 not in the principal submatrix , define @xmath100 to be the vector which is @xmath349 in the @xmath64th entry and @xmath350 in the @xmath63th entry , where @xmath79 is a large real number . then , the extended tree matrices , together with @xmath351 for all @xmath63 not in the principal submatrix , give a decomposition of @xmath27 into @xmath352 tree matrices , as desired .",
    "these results on the maximum tree rank are summarized in table  [ tbl : tree - rank ] .",
    "in this section , we explicitly describe the stratification of @xmath178 symmetric matrices by symmetric barvinok rank . by theorem  [ thm : max - rank ] , the rank is at most  @xmath175 , and the locus of rank  @xmath0 is the tropical variety defined by the @xmath67 minors , so it suffices to characterize the matrices of rank at most  @xmath22 .",
    "following  @xcite , we call a square matrix _ tropically singular _ if it lies in the tropical variety of the determinant .",
    "[ prop : sym-3 ] let @xmath27 be a symmetric @xmath178 matrix",
    ". then the following are equivalent :    1 .",
    "@xmath27 has symmetric barvinok rank at most @xmath22 ; 2 .",
    "the deficiency graph of @xmath27 is @xmath22-colorable ; 3 .",
    "@xmath27 is tropically singular and @xmath353 for all @xmath354 .",
    "first we note that @xmath355 implies that every term of the tropical determinant is greater than or equal to @xmath356 .",
    "thus , a matrix  @xmath27 satisfying these inequalities is tropically singular if and only if some other term of the tropical determinant equals @xmath356 .",
    "proposition  [ prop : deficiency - hypergraph ] shows that ( 1 ) implies  ( 2 ) .",
    "if the deficiency graph is @xmath22-colorable , then it ca nt have any loops , so @xmath357 .",
    "furthermore , the three diagonal entries ca nt form a clique , so without loss of generality , we assume that there is no edge between @xmath358 and @xmath359 . together with the inequality , this implies that @xmath360 , so @xmath361 , so by our initial remark , @xmath27 is tropically singular",
    ". therefore ( 2 ) implies  ( 3 ) .",
    "finally , suppose that @xmath27 satisfies  ( 3 ) .",
    "we can subtract @xmath127 from the @xmath63th row and @xmath63th column without changing the rank , and so we assume that every diagonal entry is  @xmath98 .",
    "the inequalities then say that all of the off - diagonal entries are non - negative . for the minimum in the tropical determinant to be achieved at least twice",
    ", we must have at least one off - diagonal entry equal to  @xmath98 .",
    "without loss of generality , we assume that @xmath362 .",
    "then , @xmath363 where @xmath42 is as in remark  [ rmk : rank-1-extn ] .",
    "therefore , @xmath27 has symmetric barvinok rank at most  @xmath22 .    for larger matrices the symmetric barvinok rank does not have as simple a characterization as the third condition in proposition  [ prop : sym-3 ] .",
    "a necessary condition for a symmetric @xmath16 matrix to have rank at most  @xmath57 is that @xmath355 and all the @xmath364 submatrices are tropically singular , but this condition is not sufficient . for @xmath365 and @xmath366 , there are @xmath16 symmetric matrices with finite rank greater than @xmath26 by remark  [ rmk : bipartite_graph ] . even for @xmath141 and for @xmath367 and @xmath368 ,",
    "the matrix @xmath369 has symmetric barvinok rank  @xmath134 , as the nodes @xmath370 , @xmath371 , @xmath372 , and  @xmath373 form a @xmath134-clique in its deficiency graph .",
    "however , @xmath27 and all of its @xmath178 submatrices are tropically singular .",
    "in this section , we give an explicit characterization of the secant set of the space of star trees in the case @xmath142 .",
    "we do the same for the grassmannian in the next section .    from theorem  [ thm : max - star - tree - rank ] , we know that the maximum star tree rank of a @xmath35 matrix is @xmath175 . on the other hand , the set of dissimilarity matrices of star tree rank  @xmath0",
    "are defined by the @xmath67 minors .",
    "thus , our task is to describe the second secant set of the space of star trees , i.e.  the set of dissimilarity matrices of star tree rank  @xmath22 .",
    "first , we recall the defining ideal of the classical secant variety .",
    "the space of star trees is the tropicalization of the projection of the rank  @xmath0 symmetric matrices onto their off - diagonal entries .",
    "its second secant variety is a hypersurface in @xmath374 defined by the following @xmath370-term quintic polynomial , known as the pentad  @xcite : @xmath375 note that the @xmath370 terms of the pentad correspond to the @xmath370 different cycles on 5 vertices .",
    "the second secant set of the space of star trees is contained in the tropicalization of the pentad , but the containment is proper . nonetheless , the terms of the pentad play a fundamental role in characterizing matrices of rank at most  @xmath22 .",
    "let @xmath27 be a @xmath376 dissimilarity matrix .",
    "the following are equivalent :    1 .",
    "@xmath27 has star tree rank at most  @xmath22 ; 2 .",
    "the deficiency graph of @xmath27 is @xmath22-colorable ; 3 .",
    "the minimum of the terms of the pentad is achieved at two terms which satisfy the following conditions : 1 .",
    "the terms differ by a transposition ; 2 .   assuming , without loss of generality , that the minimized terms are @xmath377 and @xmath378",
    ", then we have that @xmath379 .",
    "\\(1 ) implies ( 2 ) by proposition  [ prop : deficiency - hypergraph ] .",
    "we show that ( 2 ) implies ( 3 ) by proving the contrapositive .",
    "suppose that @xmath27 does nt satisfy the two conditions for any pair of terms .",
    "without loss of generality , we assume that @xmath377 is a minimal term from the pentad . by minimality , @xmath380 is less than or equal to @xmath381 .",
    "if this inequality is strict , then we have an edge between @xmath370 and  @xmath373 in the deficiency graph .",
    "on the other hand , if it is an equality , then by our assumption that the conditions in  ( 3 ) do nt hold , @xmath380 must be less than @xmath382 , in which case we also have an edge between @xmath370 and  @xmath373 .",
    "similarly , we have edges between @xmath373 and  @xmath383 , between @xmath383 and  @xmath384 , between @xmath384 and  @xmath385 , and between @xmath385 and  @xmath370 .",
    "thus , the graph has a @xmath157-cycle , and so is not @xmath22-colorable .",
    "therefore , @xmath27 has star tree rank  @xmath175 .",
    "finally , suppose that the two conditions in  ( 3 ) hold . let @xmath386 . then we claim that : @xmath387 where @xmath42 is as in lemma  [ lem : star - tree - extn ] and @xmath388 .",
    "note that each matrix has some entries taken from  @xmath27 , while the rest are forced by the rank  @xmath0 condition .",
    "we just need to check that the minimum of these two matrices is in fact  @xmath27 . to see this",
    ", we have the following inequalities from condition  ( 3 ) : @xmath389 therefore , @xmath27 has star tree rank at most  @xmath22 .",
    "we now turn our attention to tree rank of @xmath376 dissimilarity matrices . as in the previous section ,",
    "the maximum tree rank is  @xmath175 and so it suffices to characterize @xmath390 dissimilarity matrices of tree rank at most  @xmath22 . unlike the previous section",
    ", the second classical secant variety is already all of @xmath391 , so there is no classical polynomial whose tropicalization gives us a clue to the tropical secant set .",
    "however , the tropical pentad again shows up in our characterization .",
    "first , here is a simple example of a @xmath376 @xmath33 dissimilarity matrix with tree rank @xmath175 .",
    "consider the @xmath33 matrix corresponding to the @xmath157-cycle @xmath392 .",
    "now , @xmath392 can not be covered by fewer than @xmath175 @xmath4-partite graphs , and so the matrix has tree rank at least @xmath175 by proposition  [ prop : tree - rank-01 ] . on the other hand , it has tree rank at most @xmath175 by theorem  [ thm : max - star - tree - rank ] and the inequality in  ( [ eqn : rank - inequals ] ) .",
    "we will see in remark  [ remark_5_cycle ] that this matrix is , in a certain sense , the only such example .",
    "let @xmath393 be the tropical polynomial in variables @xmath394 which is the tropical sum of the 22 tropical monomials of degree 5 in which each @xmath395 appears in a subscript exactly twice .",
    "thus @xmath393 has @xmath370 monomials of the form @xmath377 , forming the terms of the pentad , and @xmath344 new monomials of the form @xmath396 .",
    "let us call terms of the former kind _",
    "pentagons _ , and terms of the latter kind _",
    "triangles_.    [ thm : tree - rank-5 ] let @xmath397 be a @xmath398 dissimilarity matrix . then the following are equivalent :    1 .",
    "@xmath397 has tree rank at most @xmath22 ; 2 .",
    "the deficiency graph is @xmath22-colorable ; 3 .",
    "the tropical polynomial  @xmath399 achieves its minimum at a triangle .",
    "first , ( 1 ) implies ( 2 ) by proposition  [ prop : deficiency - hypergraph ] .    for ( 2 ) implies ( 3 )",
    ", we prove the contrapositive .",
    "suppose the minimal terms of @xmath399 are all pentagons ; without loss of generality , we assume that @xmath377 is a minimal term .",
    "since @xmath400 is not minimal , we have @xmath401 .",
    "similarly , we have , @xmath402 adding these together and cancelling , we get @xmath403 . thus , @xmath370 and  @xmath373 are adjacent in the deficiency graph . by similar reasoning , we have adjacencies @xmath404 in the deficiency graph , so it has a five cycle and is not 2-colorable .    finally , we prove that ( 3 ) implies ( 1 ) .",
    "assume without loss of generality that @xmath405 is among the terms minimizing @xmath393 .",
    "this implies that @xmath406 , @xmath407 , and @xmath408 are each minimal terms in their respective plcker equations .",
    "then we can use lemmas  [ triangle_complement ] and  [ triangle ] below to obtain a decomposition of @xmath397 into two tree matrices .",
    "[ triangle_complement ] for any @xmath35 dissimilarity matrix @xmath27 such that @xmath406 , @xmath407 , and @xmath408 are each minimal terms in their respective plcker equations , there exists some @xmath35 tree matrix @xmath214 , such that for every @xmath409 \\choose 2 } $ ] , we have @xmath410 , with equality if @xmath411 .    if @xmath113 satisfies @xmath412 then adding shows that each inequality must be an equality .",
    "thus , without loss of generality , we may assume that @xmath413 every other case is equivalent to this one via permutations of @xmath414 and @xmath415 .",
    "now define @xmath416 as follows .",
    "let @xmath417 for @xmath418 , and @xmath419 that @xmath416 dominates @xmath113 in every coordinate follows from the inequalities  ( [ eqn : inequalities_1 ] ) , ( [ eqn : inequalities_2 ] ) , and  ( [ eqn : inequalities_3 ] ) . to check that @xmath416 has tree rank 1 , it suffices to check the four - point condition on each 4-tuple .",
    "this condition is satisfied for the 4-tuples @xmath420 , @xmath421 , and @xmath422 , by choice of @xmath423 .",
    "furthermore , we claim that @xmath424 these inequalities follow immediately from substituting for @xmath423 and using inequalities ( [ eqn : inequalities_2 ] ) and  ( [ eqn : inequalities_3 ] ) .    [ triangle ] for any @xmath35 dissimilarity matrix @xmath27 , there exists some @xmath35 tree matrix @xmath301 such that for every pair of indices @xmath63 and @xmath64 , we have @xmath425 , with equality if @xmath426 .",
    "the @xmath415-principal submatrix of @xmath27 is a tree matrix and therefore @xmath301 exists with the desired properties by lemma  [ lem : extn - tree - rank-1 ] .",
    "we can now finish the proof of theorem  [ thm : tree - rank-5 ] .",
    "let @xmath416 be as given in lemma  [ triangle_complement ] and let @xmath301 be as given in lemma  [ triangle ] .",
    "then @xmath427 and so @xmath113 has tree rank at most  2 .    in the rest of this section , we present a detailed analysis of the deficiency graphs  @xmath428 for @xmath142 .",
    "there are @xmath157 tropical plcker relations on a @xmath35 matrix , each containing @xmath175 terms .",
    "each term is the tropical product of terms with disjoint entries .",
    "thus , @xmath428 is a subgraph with at most @xmath157 edges of the petersen graph  @xmath429 , which is the graph on vertices @xmath430 \\choose 2}$ ] with an edge between @xmath76 and @xmath431 if and only if @xmath432 and @xmath433 are disjoint sets .",
    "the following theorem describes the possible subgraphs that @xmath428 can be .",
    "[ thm : tree - rank-5-deficiency ] let @xmath27 be a @xmath376 dissimilarity matrix . then the deficiency graph @xmath428 is precisely one of the following :    1 .",
    "the trivial graph , in which case @xmath27 has tree rank  @xmath0 .",
    "2 .   a non - trivial graph with fewer than @xmath157 edges , in which case @xmath27 has tree rank  @xmath22 .",
    "3 .   up to relabeling , either of the two graphs in figure  [ fig : petersen - subgraphs ] , in which case @xmath27 has tree rank  @xmath22 .",
    "a @xmath157-cycle , in which case @xmath27 has tree rank  @xmath175 .",
    "the matrix @xmath27 is a tree matrix if and only if the four - point condition holds for all @xmath134-tuples , i.e.  if and only if @xmath428 is trivial .",
    "this is the first case .",
    "now suppose that @xmath428 is a non - trivial graph with at most @xmath134 edges .",
    "then , at least one four - point condition holds , so lemma  [ lem : tree - rank - submatrix ] implies that @xmath27 has tree rank at most  @xmath22 .",
    "however , at least one four - point condition is violated , so @xmath27 must have tree rank exactly  @xmath22 .    in the rest of the proof , we assume that @xmath428 has @xmath157 edges , i.e.  that each of the five 4-tuples yields one deficient pair .",
    "thus , @xmath428 contains exactly one of the three edges @xmath434 , @xmath435 , and @xmath436 , and similarly for the remaining 4-tuples .",
    "let us say that a subgraph @xmath437 of @xmath438 _ admits an alternating even cycle _ if there exists a cycle of even length in @xmath439 such that , traversing the cycle , the edges are alternately members and nonmembers of @xmath39 ( figure  [ fig : alternating - cycle-1 ] ) .",
    "[ lem : alternating - cycle ] the graph @xmath440 admits no alternating even cycle .",
    "note that the only even cycles in the petersen graph are of lengths 6 and  8 ( see , for example , ( * ? ? ?",
    "* ch .  4.2 ) ) .",
    "suppose @xmath441 is an alternating cycle of length  6 .",
    "all 6-cycles of @xmath429 are isomorphic , so after relabeling , we may assume that @xmath441 has vertices @xmath442 , in that order .",
    "now suppose that @xmath443 , @xmath444 , and @xmath445 are the three edges of the cycle in @xmath36 .",
    "then @xmath446 but adding these inequalities yields a contradiction .",
    "if instead @xmath447 , @xmath448 , and @xmath449 are the three edges of the cycle lying in @xmath450 , then we obtain a similar contradiction .",
    "the case of a cycle of length 8 is analogous , so we omit it .",
    "we now use lemma  [ lem : alternating - cycle ] to show that , up to relabeling , the only two possibilities for @xmath428 , assuming that it is @xmath22-colorable , are those in figure  [ fig : petersen - subgraphs ] .",
    "we organize our case analysis according to the maximum degree in the graph @xmath428 .",
    "if @xmath428 has maximum degree  1 , so that it is a perfect matching in @xmath429 , then one may check that it has an alternating 8-cycle .",
    "this is impossible by lemma  [ lem : alternating - cycle ] .",
    "if @xmath428 has maximum degree  2 , then it is either a 4-path and a 1-path , a 3-path and two 1-paths , or two 2-paths and a 1-path .",
    "( by a @xmath13-path we mean a path with @xmath451  edges ) .",
    "it is easy to check that in each of these cases , @xmath428 admits an alternating @xmath452-cycle , which is again impossible by lemma  [ lem : alternating - cycle ] .",
    "thus , @xmath428 has a vertex of degree 3 , which we assume to be the vertex  @xmath370 . in this case",
    ", one may check that , up to relabeling , @xmath428 is one of the two graphs shown in figure  [ fig : petersen - subgraphs ] .",
    "note that in either case , the graphs are @xmath22-colorable , and thus @xmath27 has tree rank  @xmath22 by theorem  [ thm : tree - rank-5 ] .",
    "finally , if @xmath428 is not @xmath22-colorable , then it must have an odd cycle .",
    "the petersen graph has no @xmath175-cycles , so @xmath428 must be a @xmath157-cycle .",
    "[ remark_5_cycle ] if @xmath27 is the @xmath33 matrix corresponding to the @xmath157-cycle @xmath392 , then @xmath428 is also a @xmath157-cycle by theorem  [ thm : tree - rank-5-deficiency ] .",
    "explicitly , @xmath428 has an edge for each non - adjacent pair of edges in the graph @xmath392 .",
    "moreover , theorem  [ thm : tree - rank-5-deficiency ] tells us that any other matrix @xmath80 with tree rank  @xmath175 must have the same deficiency graph ( up to relabeling ) . in this sense , @xmath27 is essentially the only example of a @xmath376 dissimilarity matrix with tree rank  @xmath175 .",
    "* what is the maximum tree rank of a @xmath16 dissimilarity matrix ?",
    "theorem  [ thm : tree - rank - n-3 ] gives an upper bound , but beginning with @xmath453 , we do not know if it is sharp . specifically ,",
    "does there exist a @xmath454 dissimilarity matrix with tree rank @xmath455 ? * give a ( reasonable ) algorithm for computing tree rank .",
    "note that both the tropical veronese and the space of star trees are classical linear spaces , and so the results in  @xcite can be applied to compute star tree rank and symmetric barvinok rank .",
    "however , it would be nice to have a good algorithm for computing tree rank . * is it true that the rank of a matrix , according to any of our notions , is always equal to the chromatic number of the corresponding deficiency graph ? in sections  [ sec : sym - barv-3 ] ,",
    "[ sec : star - tree-5 ] , and  [ sec : tree-5 ] , we observed that this was true for symmetric barvinok rank with @xmath456 , star tree rank with @xmath457 , and tree rank with @xmath457 respectively .",
    "in general , we believe the answer is no , but we do not know of a counterexample . * in phylogenetics , trees have all edges , including the pendant edges , labeled by positive weights , or , equivalently , after negating , by negative weights .",
    "in this way , phylogenetic trees form a subset of the tropical grassmannian , and we define the _ phylogenetic tree rank _ to be the rank with respect to this subset",
    ". one can ask the same questions about phylogenetic tree rank as in this paper : which matrices have finite phylogenetic tree rank ? what is the maximum possible finite phylogenetic tree rank ? what is an explicit characterization of the secant sets for small matrices ?",
    "work in this direction was begun in  @xcite .",
    "* what is an algorithm for computing phylogenetic tree rank ?",
    "* does a matrix have tree rank  @xmath22 if and only if all its principal @xmath458 submatrices have tree rank at most  @xmath22 ?",
    "pachter and sturmfels have made the same conjecture for their definition of tree rank  ( * ? ? ?",
    "* p.   124 ) .",
    "* what is an explicit description of @xmath326 matrices with tree rank at most  @xmath22 , along the lines of theorem  [ thm : tree - rank-5 ] ? does this help with the previous conjecture ? there is a necessary condition coming from applying theorem  [ thm : tree - rank-5 ] to every @xmath35 minor , and another from the fact that the matrix must be in the tropicalization of the classical secant variety .",
    "however , these two conditions together may not be sufficient for a @xmath326 matrix to have tree rank at most  @xmath22 .",
    "we thank bernd sturmfels for his guidance and a close reading of the text .",
    "maria anglica cueto helped us understand the connection to phylogenetics and william slofstra pointed us to  @xcite .",
    "melody chan was supported by the department of defense through the national defense science and engineering graduate fellowship program .",
    "m.  v.  catalisano , a.  v.  geramita , a.  gimigliano , secant varieties of grassmann varieties , proc .  of the amer .",
    "soc . , 133:633642 , 2004 .",
    "http://front.math.ucdavis.edu/math.ag/0208166[arxiv:math.ag/0208166 ] .",
    "m.  develin , f.  santos , b.  sturmfels , on the rank of a tropical matrix , in `` discrete and computational geometry '' ( e.  goodman , j.  pach and e.  welzl , eds ) , msri publications , cambridge university press , 2005 .",
    "http://front.math.ucdavis.edu/math.co/0312114[arxiv:math.co/0312114 ] .",
    "m.  drton , b.  sturmfels , s.  sullivant , algebraic factor analysis : tetrads , pentads and beyond , probability theory and related fields 138(3/4 ) : 463493 , 2007 .",
    "http://front.math.ucdavis.edu/0509.5390[arxiv:0509.5390 ] ."
  ],
  "abstract_text": [
    "<S> we introduce and study three different notions of tropical rank for symmetric and dissimilarity matrices in terms of minimal decompositions into rank  @xmath0 symmetric matrices , star tree matrices , and tree matrices . </S>",
    "<S> our results provide a close study of the tropical secant sets of certain nice tropical varieties , including the tropical grassmannian . </S>",
    "<S> in particular , we determine the dimension of each secant set , the convex hull of the variety , and in most cases , the smallest secant set which is equal to the convex hull . </S>"
  ]
}