{
  "article_text": [
    "since 90 years a number of methods have been proposed to calculate the electrostatic potential in ionic crystals .",
    "these methods can be separated into two categories , the direct summation methods and the indirect summation ones .",
    "the former uses a real space summation of the electrostatic potential generated by the ions within a finite volume ( @xmath0 ) .",
    "however , when enlarging the volume @xmath0 , such partial summations are conditionally convergent .",
    "the convergence depends on the specific shape of @xmath0 .",
    "in addition , when achieved , the convergence is quite slow .",
    "the indirect summation methods do not present these drawbacks since the long range part of the potential is calculated in the reciprocal space .",
    "indeed , the summation is divided into two parts , a short range one , evaluated by a direct summation in real space and a long range one evaluated in the reciprocal space . among these methods ,",
    "the most widely used is the ewald s method  @xcite , which is actually considered as the reference for madelung potential calculations .    despite its quality",
    "the ewald s method is not easily usable in different domains of physics .",
    "this is for instance the case in clusters ab - initio calculations used for the treatment of strongly correlated systems , the study of diluted defects in materials or adsorbates or for qm / mm type of calculations . for this types of calculations ,",
    "real space direct summation methods are used .",
    "there is thus a need for efficient and accurate techniques for the determination of the madelung potential in real space .",
    "the convergence problems found in real space summation are linked to the shape of the summation volume , @xmath0 , and more specifically the charges at its surface . in order to insure the convergence of the summation",
    ", the surface charges are renormalized .",
    "several methods have been proposed for this purpose .",
    "the most common and simple one is the evjen s method  @xcite .",
    "this method uses a volume @xmath0 , built from a finite number of crystal unit cells , and renormalizes the surface charges by a factor 1/2 , 1/4 or 1/8 according whether the charge belong to a face , edge or corner of @xmath0 .",
    "this method insures , in most cases , the convergence of the electrostatic potential when @xmath1 increases .",
    "however , in some cases such as the famous @xmath2 it does not converge to the proper value .",
    "@xcite    other authors  @xcite proposed to renormalize not only the surface charges , but also the charges included in a thin skin volume .",
    "the adjustment of the renormalization factors are , in this case , numerically determined so that to reproduce the exact potential , previously computed using the ewald s method at a chosen set of positions .",
    "such a method presents the advantage of reaching a very good precision .",
    "however several drawbacks can be pointed out  : i ) the previous calculation of the electrostatic potential using the ewald s method at a large number of space positions , ii ) the necessity to invert a large linear system to determine the renormalization factors and iii ) finally the fact that the latter are not chosen on physical criteria .",
    "indeed , this last point induces the possibility that the renormalization factors can be either larger than one or negative .",
    "it results that even if the electrostatic potential is very accurate at the chosen reference positions , its spatial variations can be unphysical and thus , the precision can strongly vary when leaving the reference points .",
    "marathe _ et al _",
    "@xcite suggested a physical criterion , based on the analysis of the convergence of the real space summation , for the choice of the renormalization factors .",
    "indeed , it is known that the direct space summation converges to the proper limit if the volume @xmath0 presents null dipole and quadrupole momenta  @xcite .",
    "the authors of reference   showed , on the simple example of a linear alternated chain , that it is possible to find a finite number of charge renormalization factors allowing the cancellation of these two multipolar momenta .",
    "they also assert that the cancellation of additional multipolar momenta increases the speed of convergence .",
    "unfortunately they did not prove this affirmation and more importantly , they did not proposed a practical way to determine the renormalization factors in order to reach this goal .    in the present paper",
    "we propose a systematic method for the determination of the renormalization factors allowing the cancellation of a given number of multipolar momenta as well as a careful analysis of the direct space summation convergence as a function of the number of canceled multipolar momenta .",
    "the next section will present the convergence proof , section 3 will develop the method for determination of the renormalization factors and section 4 will present the optimization of the method and illustration on a typical example .",
    "as already mentioned in the introduction , several papers already exist on this subject .",
    "however the results are only partial and there is not complete analysis of the convergence issue .",
    "we will thus present in this section a global analysis of the electrostatic potential convergence in a real space approach and an estimation of the error .",
    "we want to evaluate the limit of the following series @xmath3 where @xmath4 is a vector of the bravais s lattice , j refers to a charge @xmath5 located at the position @xmath6 of the unit cell @xmath7 .",
    "@xmath8 is a set of volumes such that @xmath9 for the sake of simplicity we require that the set of @xmath10 also presents the following conditions @xmath11    the well known problem of this series is that the limit depends on the particular choice of the unit cell @xmath12 and of the volumes @xmath10 .",
    "however , it has been demonstrated that this conditional convergence disappears if one considers a unit cell with zero dipolar and quadrupolar momenta  @xcite .",
    "we will consider in the following that the cell @xmath7 fulfills this condition .",
    "the error @xmath13 on the electrostatic potential evaluation , @xmath14 , can be written as @xmath15 for large values of @xmath16 , @xmath13 can be evaluated by a multipolar expansion . for practical reasons , we will use an expansion expressed in spherical coordinates .",
    "indeed , for a given order , this expansion contains less terms than the usual multipolar expansion based on cartesian coordinates .",
    "the use of the later multipolar expansion is still possible but is more complex ( see ref . ) . in spherical coordinates",
    ", the multipolar expansion of the error made on @xmath17 reads  @xcite  : @xmath18 where @xmath19 are the multipolar momenta of unit cell @xmath20 at @xmath21 .",
    "they can be expressed as @xmath22 @xmath23 are the spherical coordinates of the bravais s vector @xmath24 and @xmath25 the spherical coordinates of @xmath26 .",
    "the @xmath27 are schmidt semi - normalized spherical harmonics  : @xmath28 where @xmath29 are legendre functions .    in order to overvalue the error",
    ", one needs to overvalue the spherical harmonics .",
    "we thus consider the addition formula  : @xmath30 where @xmath31 is a legendre polynomial and @xmath32 is the angle between @xmath23 and @xmath33 .",
    "it comes for @xmath34 and @xmath35 @xmath36 and thus @xmath37    using this result , one obtains the following overvalue for the momenta  : @xmath38 where @xmath39 is the typical size of @xmath20 ( i.e. the diameter of the circumsphere of @xmath20 ) and @xmath40 is the sum of the absolute values of its charges @xmath41    one should notice at this point that @xmath42 has the same parity as @xmath43 .",
    "the contributions of @xmath4 and @xmath44 unit cells to @xmath45 thus cancel when @xmath43 is odd . using equations  [ eq : majy ] and  [ eq : majm ] ,",
    "one gets the following overvaluation  : @xmath46 where @xmath47 is the order of the first even , non - zero momentum .",
    "let us now overvalue the sum over the @xmath48 powers by a volume integral .",
    "for each cell @xmath49 located at @xmath24 , the norm of the position vectors @xmath50 belonging to the volume @xmath49 is smaller than @xmath51 .",
    "one can thus overvalue @xmath52 by @xmath53 @xmath54 being the volume of the unit cell @xmath20 .",
    "if @xmath55 is the radius of the insphere of @xmath10 , it comes @xmath56 and @xmath57    the later sum converges for @xmath58 large enough , i.e. for @xmath59 .",
    "the decreasing function @xmath60 can be overvalued by its value in @xmath61 .",
    "further summation over @xmath62 leads to the following expression @xmath63 with @xmath64 the electrostatic potential at @xmath21 thus converges as @xmath65 where @xmath43 is the first , even , non - zero momentum of the unit cell @xmath12 .      in several applications , as for instance in cluster ab initio calculation ,",
    "the problem depends on the spatial variations of the potential and not on its absolute value . in such cases it is sufficient to cancel the dipolar momentum of the unit cell in order to ensure the convergence of the calculation",
    "the convergence rate can also be expected to be faster than for the calculation of the potential at a point as we will show in this section .",
    "let us overvalue the error made on the calculation of a difference of potential between two points located at @xmath66 and @xmath67  :    @xmath68    where @xmath69 and @xmath70 are the spherical coordinates of @xmath71 and @xmath72 respectively .",
    "as in the preceding section @xmath23 will be the spherical coordinates of @xmath4 and @xmath73 those of @xmath74 .    in order",
    "to express the previous expression as a function of @xmath48 , we use following expansion of solid spherical harmonics ( for simple derivation see ref .  ,",
    "see also ref .  )  : @xmath75 where the sum over @xmath76 spans all integer values .",
    "nevertheless , only a finite number of terms will contribute , since @xmath77 if @xmath78 .",
    "setting @xmath79 and introducing spherical harmonics leads to  : @xmath80^{\\frac{1}{2 } }   \\nonumber\\\\ *     & & \\times\\ , r_1^{l - l}\\ , y_{l - l}^{m - m}(\\theta_1,\\phi_1)\\end{aligned}\\ ] ] considering @xmath81 in this equation instead of @xmath82 is equivalent to the transformation @xmath83 that results in an overall @xmath84 factor . inserting relation  [ eq : ylmexp ] into eq .",
    "[ eq : dv2 ] and inverting the summation over @xmath43 and @xmath85 leads to the expansion  : @xmath86 with  : @xmath87^{\\frac{1}{2 } }   \\nonumber\\\\ *     & & \\times ( -1)^{m - m } \\ ; r_1^{l - l}\\ ; y_{l - l}^{m - m}(\\theta_1,\\phi_1 ) \\nonumber\\\\ *     & & \\times \\left(1-(-1)^{l",
    "- l } \\right ) \\label{eq : alm}\\end{aligned}\\ ] ]    considering the parity of @xmath88 , one can see from eq .",
    "[ eq : dv2_alm ] that the contributions from cells located at @xmath4 and @xmath44 cancel when @xmath43 is odd .",
    "moreover , due to the last term of eq .",
    "[ eq : alm ] , the @xmath89 coefficients are zero when  @xmath90   is even . only terms with @xmath43 even and @xmath85 odd have a non zero contribution , thus only momenta @xmath91 with odd order will contribute to the error .",
    "the consequence is that the first non - zero contribution in equation  [ eq : dv2_alm ] corresponds to @xmath92 where @xmath93 is the first , non - zero , odd momentum of the unit cell .",
    "let us now find an overvalue of the @xmath89 terms .",
    "it is easy to show using a recurrence relation on the values of @xmath76 and @xmath94 , that if @xmath95 , @xmath96 and @xmath97 , the following relation holds  : @xmath98 using the previous overvaluation of the momenta ( eq .  [ eq : majm ] ) one obtains  : @xmath99    as in previous section , the sum over @xmath100 can be overvalued by a volume integral ( cf .",
    "eq  [ eq : sumk_maj ] ) .",
    "overvaluation of the error thus reads  : @xmath101    the sum over @xmath62 converges if @xmath58 is larger than @xmath102 .",
    "it can be calculated using derivative of power series .",
    "after simplification , one obtains  : @xmath103 where @xmath104 as one increase the size of the set of charges , the difference of electrostatic potential between two points converges like @xmath105 , where @xmath43 is now the first , odd , non - zero momentum of the unit cell @xmath12 .",
    "this convergence is slightly faster than the convergence of the absolute value of potential .",
    "when the order of the first non zero momentum is even , the convergence rates differ by a factor @xmath106 , otherwise they are similar .",
    "as depicted in the previous section , convergence can be considerably increased if one cancels several multipolar momenta of the unit cell . in general the evjen method",
    "allows to only cancel the dipolar momentum , and thus provides a convergence of the potential differences in @xmath107 . in order to really take advantage of the former property",
    ", one needs a method allowing the cancellation of several multipolar momenta .    in this section",
    "we will establish a method to construct unit cells with a chosen number of zero multipolar momenta .",
    "the method , based on the usage of partial charges , is general and can be applied to any bravais s crystal .",
    "let @xmath108 be the lattice vectors of the bravais s crystal , and @xmath109 the associated unit cell .",
    "in order to introduce partial charges , we consider a larger cell @xmath110 of dimensions @xmath111 , that we will refer as the `` _ construction cell _ '' .",
    "the construction cell thus contains @xmath112 original unit cells @xmath109 which positions in @xmath110 can be labeled by @xmath113 , @xmath114 and @xmath115 indices , ranging from @xmath116 to @xmath43 .",
    "if we note @xmath117 the number of charges @xmath118 in the original cell @xmath109 , the cell @xmath110 now contains @xmath119 charges .",
    "these charges will be corrected by a factor @xmath120 ( where @xmath121 refers to the charge @xmath118 ) .",
    "when on rebuild the lattice using the construction cells @xmath110 , the cells overlap , and the final charge at position @xmath122 corresponds to the superposition of partial charges from several construction cells .",
    "it is straightforward to show that the condition to retrieve the nominal value of the charges @xmath118 reads  : @xmath123    at this stage , considering the latter @xmath117 equations , the cell @xmath124 contains @xmath125 free parameters that could be used to cancel multipolar momenta . for the sake of simplicity and generality ( i.e. for the method not to depend on the particularity of a given crystal )",
    ", we will impose further conditions on the @xmath120 coefficients .",
    "we first reduce the problem to a one dimensional problem by setting  : @xmath126 where the three coefficients @xmath127 , @xmath128 and @xmath129 are used to cancel multipolar momenta of the @xmath130 problems obtained when the cell @xmath109 is respectively projected on the three axes of the crystal . for each one dimensional problem ,",
    "the construction cell contains @xmath43 projected unit cells .",
    "the condition on the coefficients now reads  : @xmath131 it is easy to show that , if these coefficients cancel a fixed number of multipolar momenta in each one dimensional problems , the @xmath120 coefficients will cancel the momenta of same order in the original three dimensional problem .",
    "we further impose to the coefficients to only depend on the fractional coordinates ( @xmath132 ) of the charges @xmath118 , in the corresponding direction : @xmath133 the @xmath134 functions are thus the same for the three directions and for all charges . as a consequence",
    "their expression is the same for all crystals . for a given value of @xmath135 , and considering the condition for the reconstruction of the crystal ( eq .  [ eq : recon2 ] ) , we are left with @xmath136 degrees of freedom .",
    "we thus impose to the @xmath134 functions to cancel @xmath136 multipolar momenta .",
    "this can be done by setting the momenta created at the center of the construction cell by a unique charge @xmath114  : @xmath137 where @xmath138 , @xmath135 is the fractional coordinate of the charge and @xmath139 are constant values ( independant of the crystal specifications ) .",
    "the equation obtained for @xmath140 corresponds to the condition for the reconstruction of the crystal ( @xmath141 ) .",
    "the momenta of the construction cell , can thus be obtained by summing the contributions of all charges . as the unit cell is neutral ,",
    "these contributions cancel out .",
    "the equations  [ eq : l3 ] and  [ eq : mk ] thus define sets of partial charges that allow to construct cells with @xmath136 zero multipolar momenta .",
    "the shape of these partial charges depends on the choice of the @xmath139 constants values . in order to find the most reasonable choice of partial charges , we search for @xmath139 constants that satisfy the following physical conditions  :    1 .",
    "@xmath142 $ ] .",
    "the partial charges vary continuously , i.e. @xmath143 are continuous and @xmath144 .",
    "3 .   @xmath145 decreases monotonously when moving away from the center of the construction cell .",
    "the values of the @xmath139 are as small as possible .",
    "the latter condition ensures that the partial charges are larger in the center of the construction cell and smaller on its edges , and hence that this cell is close to the original one .    we did not find a way to derive the solution of this problem in a general way , for any value of @xmath43 .",
    "we thus determined the solution for fixed values of @xmath43 up to @xmath146 .",
    "in all these cases the first @xmath147 function presents the same shape  : @xmath148 we reasonably assume that this expression is valid for any value of @xmath43 .",
    "as we will see , it is possible to show , a posteriori , that the @xmath147 functions fulfill the first three conditions . we will now determine the function @xmath147 for any @xmath43 , using the above expression of @xmath149 and relation  [ eq : mk ] .",
    "in equation  [ eq : mk ] , the @xmath150 constants can be replaced by the value of the momenta obtained for @xmath151  : @xmath152 with @xmath153 .",
    "the matrix of this linear system is the transpose of a vandermonde matrix .",
    "inversion of the system leads to  : @xmath154    the @xmath155 coefficients can now be obtained from the expression of @xmath149 .",
    "let us consider the latter equation evaluated for @xmath156 , and for @xmath43 integer values of @xmath135  : @xmath157 replacing @xmath158 by its expression and inverting this linear system leads to the expression of @xmath159 coefficients  : @xmath160    finally , using eq .",
    "[ eq : lpl0 ] and  [ eq : l0 ] one obtains the expression of the @xmath161 which are polynomial functions of order @xmath136 in @xmath135 ( see fig .",
    "[ f : lp ] )  : @xmath162 these functions are segments of the uniform sum distribution , i.e. the distribution @xmath163 of the sum of @xmath43 uniform variates on the interval @xmath164 $ ]  : @xmath165 from this relation , it is obvious that the @xmath161 functions satisfy the first three conditions mentioned above .",
    "we now consider a fragment of crystal made of @xmath16 construction cells @xmath166 .",
    "as these cells are composed of @xmath43 original cells @xmath109 , they partially overlap , and the size of the fragment corresponds to @xmath167 cells @xmath109 .",
    "@xmath168 cells @xmath109 in the center contains charges with the nominal values @xmath118 , and @xmath136 cells @xmath109 on each side of the fragment contains partial charges .",
    "the latter partial charges are proportional to the coefficients  : @xmath169 these coefficients are represented on fig .",
    "[ f : mp ] .",
    "the abscise values have been shifted by @xmath170 , so that the origin corresponds to the position of the effective edge of the fragment ( i.e. the position of the edge obtained when using @xmath16 original cells @xmath171 without partial charges ) .",
    "one can see that the renormalization of the charges is relatively small .",
    "indeed , even in the case @xmath172 , this renormalization is weaker then @xmath173 for charges at distances larger than @xmath174 .",
    "+    we first use the cells @xmath110 to illustrate the convergence of the standard , real - space calculation of the potential established in section  [ s : conv ] . in order to observe the general behavior of the different methods , we chose the @xmath175 quartz structure , that possesses a reasonable number of atoms per unit cell and not too many symmetries .",
    "a cell @xmath110 is constructed for a fixed number of @xmath113 .",
    "the cells are used to produce sets of charges of increasing size .",
    "the potential is calculated at the position of the twelve atoms of the central unit cell @xmath109 .",
    "[ f : dv ] a ) represents the maximum of the error made on these potential values as a function of the width of the set of charges , and fig .",
    "[ f : dv ] b ) represents the maximum of the error made on the sixty six differences of potential .",
    "as expected the error decreases as a power function of the width @xmath176 of the set of charges .",
    "it fully agrees with eq .",
    "[ eq : res1 ] and  [ eq : res2 ] .",
    "in particular , the fact that the cancellation of a momentum of odd order do not increase the convergence rate of the potential at a point , clearly appears .",
    "similarly , the cancellation of even order momentum do not improve the convergence rate of the calculation of differences of potential .",
    "+    one can see from the previous figures that this standard approach is not the more efficient .",
    "indeed the increase of the number of zero multipolar momenta clearly yield a faster convergence rate than the increase of the volume of the system for a fixed value of @xmath43 .",
    "let us therefore fix the width @xmath177 of the volume containing the nominal charge , and let @xmath43 increase .",
    "the variation of the maximum error made on the potential and on the the potential differences are respectively represented on fig .",
    "[ f : dvexp ] a ) and  [ f : dvexp ] b ) .",
    "one sees that the present approach leads to an exponential convergence of the potential in both cases .",
    "the convergence is very fast , since an increase of the set of charges width by two unit cells results in a precision increase by a factor better than @xmath178 .",
    "increasing the number @xmath177 of central cells without partial charges has a small influence on the convergence speed . for @xmath179",
    "the method even becomes less efficient since increasing @xmath177 increases the size of the total set of charges .",
    "the best convergence is obtained for @xmath180 .",
    "it corresponds to the case where the cell in which the potential is calculated is surrounded by one shell of cells with the nominal charge values .",
    "finally we compare our method to the famous ewald s method which mixes calculation in real space and reciprocal space .",
    "this method introduces gaussian distribution of charge @xmath181 , where the @xmath175 coefficient can be adjusted .",
    "increasing @xmath175 coefficient increases the convergence rate of the real space sum , but slows down the sum in reciprocal space . a width of gaussian proportional to the characteristic length of the unit cell , which corresponds to @xmath182 ,",
    "is generally assumed to give a good compromise .",
    "we calculated the error made on the value of the potential using the ewald s method for different values of @xmath175 around @xmath183 .",
    "the results are represented on figure  [ f : dvewald ] , as well as the error of our method obtained for @xmath180 .",
    "figure  [ f : dvewald ] reports the error on the potential as a function of the number of construction cells used in the calculation .",
    "let us point out that , while this variable is pertinent for the global convergence rate analysis , for each charge , the ewald s method requires an error function evaluation resulting in a non negligible pre - factor , not present in our method and not taken into account in figure  [ f : dvewald ] .",
    "one sees that the convergence rate of the present method is comparable with the ewald s method .",
    "if one is only interested in the potential evaluation at a single point , the ewald s method with an optimal @xmath175 parameter is somewhat faster than the present one .",
    "one the other hand , once the renormalization have been computed , the value of the potential at any other point of the of the central area can be calculated with a similar precision at little cost .",
    "more important , properties using potential integrals or complex potential functions can be more easily evaluated since our method used only algebraic functions .",
    "number of authors have searched for a fast converging method for the evaluation of the electrostatic potential in real space .",
    "similarly , many works where done yielding partial results on the convergence rate of such real series .",
    "the present work fills the gaps and proposes a general analysis of both the convergence of the potential at one point and of the convergence of differences of potential .",
    "indeed , we gave a general and rigorous proof of the relation ( claimed by other authors ) between the power law convergence of the series and the number of zero multipolar momenta of the crystal construction cell .",
    "based on these convergence analyses we derived a general real space method with an exponential convergence rate , comparable with the ewald s method .",
    "the exponential convergence is reached as a function of the number of canceled multipolar momenta in the _ construction _ cell .",
    "the crystal is indeed constructed using overlapping _ construction _ cells with renormalized charges .",
    "we derived a general analytical expression of the renormalization factors , for any given number of zero multipolar momenta ."
  ],
  "abstract_text": [
    "<S> an efficient real space method is derived for the evaluation of the madelung s potential of ionic crystals . </S>",
    "<S> the proposed method is an extension of the evjen s method . </S>",
    "<S> it takes advantage of a general analysis for the potential convergence in real space . </S>",
    "<S> indeed , we show that the series convergence is exponential as a function of the number of annulled multipolar momenta in the unit cell . </S>",
    "<S> the method proposed in this work reaches such an exponential convergence rate . </S>",
    "<S> its efficiency is comparable to the ewald s method , however unlike the latter , it uses only simple algebraic functions . </S>"
  ]
}