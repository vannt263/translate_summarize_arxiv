{
  "article_text": [
    "a hopf algebra is an algebra @xmath0 with a coproduct @xmath1 which fits together with the product @xmath2 .",
    "background on hopf algebras is in [ sec22 ] .",
    "the map @xmath3 is called the _ hopf - square _ ( often denoted @xmath4 or @xmath5}}$ ] ) .",
    "our first discovery is that the coefficients of @xmath5}}$ ] in natural bases can often be interpreted as a markov chain . specializing to familiar hopf algebras",
    "can give interesting markov chains : the free associative algebra gives the gilbert ",
    "shannon  reeds model of riffle shuffling .",
    "symmetric functions give a rock - breaking model of kolmogoroff @xcite .",
    "these two examples are developed first for motivation .",
    "let @xmath6 be noncommuting variables and @xmath7 be the free associative algebra .",
    "thus @xmath0 consists of finite linear combinations of words @xmath8 in the generators with the concatenation product .",
    "the coproduct @xmath9 is an algebra map defined by @xmath10 and extended linearly .",
    "consider @xmath11 a term in this product results from a choice of left or right from each factor .",
    "equivalently , for each subset @xmath12 , there corresponds the term @xmath13 thus @xmath14 is a sum of @xmath15 terms resulting from removing @xmath16 and moving them to the front .",
    "for example , @xmath17 dividing @xmath14 by @xmath15 , the coefficient of a word on the right is exactly the chance that this word appears in a gilbert  shannon ",
    "reeds inverse shuffle of a deck of cards labeled by @xmath18 in initial order @xmath19 . applying @xmath20 in the dual algebra",
    "gives the usual model for riffle shuffling .",
    "background on these models is in [ sec5 ] .",
    "as shown there , this connection between hopf algebras and shuffling gives interesting new theorems about shuffling .",
    "[ ex11 ]    let us begin with the rock - breaking description .",
    "consider a rock of total mass @xmath21 .",
    "break it into two pieces according to the symmetric binomial distibution : @xmath22 continue , at the next stage breaking each piece into @xmath23 by independent binomial splits .",
    "the process continues until all pieces are of mass one when it stops .",
    "this description gives a markov chain on partitions of @xmath21 , absorbing at @xmath24 .",
    "this process arises from the hopf - square map applied to the algebra @xmath25 of symmetric functions , in the basis of elementary symmetric functions @xmath26 .",
    "this is an algebra under the usual product .",
    "the coproduct , following @xcite is defined by @xmath27 extended multiplicatively and linearly .",
    "this gives a hopf algebra structure on @xmath28 which is a central object of study in algebraic combinatorics .",
    "it is discussed in [ symfns ] .",
    "rescaling the basis elements to @xmath29 , a direct computation shows that @xmath14 in the @xmath30 basis gives the rock - breaking process ; see [ sec41 ] .",
    "[ ex12 ]    a similar development works for any hopf algebra which is either a polynomial algebra as an algebra ( for instance , the algebra of symmetric functions , with generators @xmath31 ) , or is cocommutative and a free associative algebra as an algebra ( e.g. , the free associative algebra ) , provided each object of degree greater than one can be broken non - trivially .",
    "these results are described in theorem  [ thm31 ] .",
    "our second main discovery is that this class of markov chains can be explicitly diagonalized using the eulerian idempotent and some combinatorics of the free associative algebra .",
    "this combinatorics is reviewed in [ sec23 ] .",
    "it leads to a description of the left eigenvectors ( theorems  [ gefnthm1 ] and  [ gefnthm2 ] ) which is often interpretable and allows exact and asymptotic answers to natural probability questions . for a polynomial algebra",
    ", we are also able to describe the right eigenvectors completely ( theorem  [ fefnthm1 ] ) .    for a deck of @xmath21 distinct cards , the eigenvalues of the markov chain induced by repeated riffle shuffling are @xmath32 @xcite .",
    "the multiplicity of the eigenvalue @xmath33 equals the number of permutations in @xmath34 with @xmath35 cycles .",
    "for example , the second eigenvalue , 1/2 , has multiplicity @xmath36 . for @xmath37 , results from [ sec5 ]",
    "show that a right eigenvector @xmath38 is given by @xmath39 summing in @xmath40 shows that @xmath41 is an eigenvector with eigenvalue 1/2 ( @xmath42 descents in @xmath43 ) .",
    "similarly @xmath44 is an eigenvector with eigenvalue 1/4 ( @xmath45 peaks in @xmath43 ) .",
    "these eigenvectors are used to determine the mean and variance of the number of carries when large integers are added .",
    "our results work for decks with repeated values allowing us to treat cases when e.g. , the suits do not matter and all picture cards are equivalent to tens . here",
    ", fewer shuffles are required to achieve stationarity . for decks of essentially any composition",
    "we show that all eigenvalues @xmath46 , occur and determine multiplicities and eigenvectors .",
    "[ ex13 ]    consider the rock - breaking process of example  [ ex12 ] started at @xmath47 , the partition with a single part of size @xmath21 .",
    "this is absorbing at the partition @xmath24 . in [ sec4 ] , this process is shown to have eigenvalues @xmath32 with the multiplicity of @xmath48 the number of partitions of @xmath21 into @xmath49 parts .",
    "thus , the second eigenvalue is 1/2 taken on uniquely at the partition @xmath50 .",
    "the corresponding eigenfunction is @xmath51 this is a monotone function in the usual partial order on partitions and equals zero if and only if @xmath52 .",
    "if @xmath53 are the successive partitions generated by the markov chain then @xmath54 using markov s inequality , @xmath55 this shows that for @xmath56 , the chance of absorption is asymptotic to @xmath57 when @xmath21 is large .",
    "[ sec4 ] derives all of the eigenvectors and gives further applications .",
    "[ ex14 ]    [ sec2 ] reviews markov chains ( including uses for eigenvectors ) , hopf algebras , and some combinatorics of the free associative algebra . [ sec3 ] gives our basic theorems , generalizing the two examples to polynomial hopf algebras and cocommutative , free associative hopf algebras .",
    "[ sec4 ] treats rock - breaking ; [ sec5 ] treats shuffling .",
    "[ sec6 ] briefly describes other examples ( e.g. , graphs and simplicial complexes ) , counter - examples ( e.g. , the steenrod algebra ) , and questions ( e.g. , quantum groups ) .",
    "two historical notes : the material in the present paper has roots in work of patras @xcite , whose notation we are following , and drinfeld @xcite .",
    "patras studied shuffling in a purely geometric fashion , making a ring out of polytopes in @xmath58 .",
    "this study led to natural hopf structures , eulerian idempotents , and generalization of solomon s descent algebra in a hopf context .",
    "his eulerian idempotent maps decompose a graded commutative or cocommutative hopf algebra into eigenspaces of the @xmath59th hopf - powers ; we improve upon this result , in the case of polynomial algebras or cocommutative , free associative algebras , by algorithmically producing a full eigenbasis .",
    "while there is no hint of probability in the work of patras , it deserves to be much better known .",
    "more detailed references are given elsewhere in this paper .",
    "we first became aware of drinfeld s ideas through their mention in shnider ",
    "sternberg @xcite .",
    "consider the hopf - square , acting on a hopf algebra @xmath0 .",
    "suppose that @xmath60 is primitive , @xmath61 .",
    "then @xmath62 so @xmath63 is an eigenvector of @xmath14 with eigenvalue 2 .",
    "if @xmath63 and @xmath64 are primitive then @xmath65 and , similarly , if @xmath66 are primitive then the sum of symmetrized products is an eigenvector of @xmath14 with eigenvector @xmath15 .",
    "drinfeld ( * ? ? ?",
    "*  prop 3.7 ) used these facts without comment in his proof that any formal deformation of the cocommutative universal enveloping algebra @xmath67 results already from deformation of the underlying lie algebra @xmath68 .",
    "see ( * ? ? ?",
    "3.8 ) and [ sec333 ] below for an expanded argument and discussion . for us",
    ", a description of the primitive elements and their products gives the eigenvectors of our various markov chains .",
    "this is developed in [ sec3 ] .",
    "acknowledgements : we thank marcelo aguiar , federico ardila , nantel bergeron , dan bump , gunner carlsson , ralph cohen , peter j. mcnamara and susan montgomery for their help and suggestions .",
    "this section gives notation and background for markov chains ( including uses for eigenvectors ) , hopf algebras , the combinatorics of the free associative algebra and symmetric functions .",
    "all of these are large subjects and pointers to accessible literature are provided .",
    "let @xmath69 be a finite set .",
    "a markov chain on @xmath69 may be specified by a transition matrix @xmath70 @xmath71 with @xmath72 .",
    "this is interpreted as the chance that the chain moves from @xmath63 to @xmath64 in one step .",
    "if the chain is denoted @xmath73 and @xmath74 is a fixed starting state then @xmath75 background and basic theory can be found in @xcite or @xcite .",
    "the readable introduction @xcite is recommended as close in spirit to the present paper .",
    "the analytic theory is developed in @xcite .",
    "let @xmath76 denote the probability of moving from @xmath63 to @xmath64 in two steps .",
    "similarly , @xmath77 is defined . under mild conditions ( * ? ? ?",
    "* sec  1.5 ) markov chains have unique stationary distributions @xmath78 : thus @xmath79 , @xmath80 , so @xmath81 is a left eigenvector of @xmath82 with eigenvalue 1 . set @xmath83 then @xmath82 operates as a contraction on @xmath84 with @xmath85 .",
    "the markov chains considered in this paper are usually not self - adjoint ( equivalently reversible ) , nonetheless , they are diagonalizable over the rationals with eigenvalues @xmath86 .",
    "we have a basis of left eigenfunctions @xmath87 with @xmath88 and @xmath89 , and , in some cases , a dual basis of right eigenfunctions @xmath90 with @xmath91 , @xmath92 , and @xmath93 .",
    "as is customary in discussions of random walks on algebraic structures , we will abuse notation and think of the eigenfunctions @xmath94 both as functions on the state space and as linear combinations of the states - in other words , @xmath95 will also be denoted @xmath94 .    throughout",
    ", we are in the unusual position of knowing @xmath96 and possibly @xmath94 explicitly .",
    "this is rare enough that some indication of the use of eigenfunctions is indicated .",
    "[ [ use - a ] ] use a + + + + +    for any function @xmath97 , expressed in the basis of right eigenfunctions @xmath94 as @xmath98 the expectation of @xmath99 after @xmath100 steps , having started at @xmath101 , is given by @xmath102 for example , for shuffling , the normalized number of descents @xmath103 is the sum of the 1/2-eigenfunctions for riffle shuffling ; see example  [ ex55 ] . thus , with @xmath104 and all @xmath100 , @xmath105 , @xmath106 in @xcite it is shown that the number of descents in repeated riffle shuffles has the same distribution as the number of carries when @xmath21 integers are added .",
    "further , the square of this eigenfunction has a simple eigenfunction expansion leading to simple formulae for the variance and covariance of the number of carries .",
    "[ [ use - b ] ] use b + + + + +    if @xmath99 is a right eigenfunction with eigenvalue @xmath107 , then the self - correlation after @xmath100 steps ( starting in stationarity ) is @xmath108 this indicates how certain correlations fall off and gives an interpretation of the eigenvalues .    [",
    "[ use - c ] ] use c + + + + +    for @xmath99 a right eigenfunction with eigenvalue @xmath107 , let @xmath109 .",
    "then @xmath110 is an @xmath111 martingale with @xmath112 .",
    "one may try to use optional stopping , maximal and concentration inequalities and the martingale central limit theorem to study the behavior of the original @xmath113 chain .",
    "[ [ use - d ] ] use d + + + + +    the left eigenfunctions come into computations since @xmath114 .",
    "thus in , @xmath115 . ( here @xmath116 is just the density of @xmath99 with respect to @xmath81 . )",
    "[ [ use - e ] ] use e + + + + +    a second prevalent use of left eigenfunctions throughout this paper : the dual of a hopf algebra is a hopf algebra and left eigenfunctions of the dual chain correspond to right eigenfunctions of the original chain .",
    "this is similar to the situation for time reversal .",
    "if @xmath117 is the time - reversed chain ( note @xmath118 is a markov chain with stationary distribution @xmath81 ) , then @xmath119 is a right eigenfunction of @xmath120 .",
    "[ [ use - f ] ] use f + + + + +    the left eigenfunctions also come into determining the quasi - stationary distribution of absorbing chains such as the rock - breaking chain .",
    "a useful , brief introduction to quasi - stationarity is in @xcite .",
    "the comprehensive survey @xcite and annotated bibliography @xcite are also useful .",
    "consider the case where there is a unique absorbing state @xmath121 and the second eigenvalue @xmath122 of the chain satisfies @xmath123 .",
    "this holds for rock - breaking .",
    "there are two standard notions of `` the limiting distribution of the chain given that it has not been absorbed '' :    @xmath124    [ 23 ]    in words , @xmath125 is the limiting distribution of the chain given that it has not been absorbed up to time @xmath100 and @xmath126 is the limiting distribution of the chain given that it is never absorbed .",
    "these quasi - stationary distributions can be expressed in terms of the eigenfunctions : @xmath127 these results follow from simple linear algebra and are proved in the references above . for rock - breaking , results in [ sec4 ] show that @xmath128 is point mass at the partition @xmath129 .",
    "[ [ use - g ] ] use g + + + + +    both sets of eigenfunctions appear in the formula @xmath130 this permits the possibility of determining convergence rates .",
    "it can be difficult to do for chains with large state spaces .",
    "see the examples and discussion in @xcite .    to conclude this discussion of markov chains we mention that convergence",
    "is customarily measured by a few standard distances : @xmath131 here @xmath132 and all distances are computable by determining the maximizing or minimizing values of @xmath133 or @xmath64 and using - .",
    "see ( * ? ? ?",
    "* lemma 6.13 ) for further discussion of these distances .",
    "a hopf algebra is an algebra @xmath0 over a field @xmath100 ( usually the real numbers in the present paper ) .",
    "it is associative with unit 1 , but not necessarily commutative .",
    "let us write @xmath134 for the multiplication in @xmath0 , so @xmath135",
    ". then @xmath136}:{\\mathcal{h}}^{\\otimes a}\\to{\\mathcal{h}}$ ] will denote @xmath59-fold products ( so @xmath137}$ ] ) , formally @xmath136}=m(\\iota",
    "\\otimes m^{[a-1]})$ ] where @xmath138 denotes the identity map .",
    "@xmath0 comes equipped with a _",
    "@xmath1 , written @xmath139 in sweedler notation @xcite .",
    "the coproduct is _ coassociative _ in that @xmath140 so there is no ambiguity in writing @xmath141 } ( x)=\\sum_{(x)}x_{(1 ) } \\otimes x_{(2 ) } \\otimes x_{(3)}$ ] .",
    "similarly , @xmath142}:{\\mathcal{h}}\\to{\\mathcal{h}}^{\\otimes a}$ ] denotes the @xmath59-fold coproduct , where @xmath9 is applied @xmath143 times , to any one tensor - factor at each stage ; formally @xmath142}=(\\iota \\otimes \\dots \\otimes \\iota \\otimes \\delta ) \\delta^{[a-1]}$ ] .",
    "the hopf algebra @xmath0 is _ cocommutative _ if @xmath144 ; in other words , an expression in sweedler notation is unchanged when the indices permute .",
    "an element @xmath63 of @xmath0 is _ primitive _ if @xmath145 .",
    "the product and coproduct have to be compatible so @xmath9 is an algebra homomorphism , where multiplication on @xmath146 is componentwise ; in sweedler notation this says @xmath147 .",
    "all of the algebras considered here are graded and connected , i.e. , @xmath148 with @xmath149 and @xmath150 finite - dimensional .",
    "the product and coproduct must respect the grading so @xmath151 , and @xmath152 implies @xmath153 .",
    "there are a few more axioms concerning a counit map and an antipode ( automatic in the graded case ) ; for the present paper , the most important is that the counit is zero on elements of positive degree , so , by the coalgebra axioms , @xmath154 , for @xmath155 .",
    "the free associative algebra and the algebra of symmetric functions , discussed in [ sec1 ] , are examples of graded hopf algebras .",
    "the subject begins in topology when h.  hopf realized that the presence of the coproduct leads to nice classification theorems which allowed him to compute the cohomology of the classical groups in a unified manner .",
    "topological aspects are still a basic topic @xcite with many examples which may provide grist for the present mill . for example , the cohomology groups of the loops on a topological space form a hopf algebra , and the homology of the loops on the suspension of a wedge of circles forms a hopf algebra isomorphic to the free associative algebra of example  [ ex11 ] @xcite .",
    "joni and rota @xcite realized that many combinatorial objects have a natural breaking structure which gives a coalgebra structure to the graded vector space on such objects .",
    "often there is a compatible way of putting pieces together , extending this to a hopf algebra structure .",
    "often , either the assembling or the breaking process is symmetric , leading to commutative or cocommutative hopf algebras respectively . for example , the symmetric function algebra is commutative and cocommutative while the free associative algebra is just cocommutative .",
    "the theory developed here is for graded commutative or cocommutative hopf algebras with one extra condition , that there is a unique way to assemble any given collection of objects .",
    "this amounts to the requirement that the hopf algebra is either a polynomial algebra as an algebra ( and therefore commutative ) or a free associative algebra as an algebra and cocommutative ( and therefore noncommutative ) .",
    "( we write _ a _ free associate algebra to refer to the algebra structure only , as opposed to _ the _ free associative algebra which has a specified coalgebra structure - namely , the generating elements are primitive . )    increasingly sophisticated developments of combinatorial hopf algebras are described by @xcite and @xcite .",
    "this last is an expansive extension which unifies many common examples .",
    "below are two examples that are prototypes for their bosonic fock functor and full fock functor constructions respectively ( * ? ? ?",
    "15 ) ; they are also typical of constructions detailed in other sources .",
    "12 ) ( * ? ? ?",
    "* sec .  3.2 ) let @xmath156 be the vector space spanned by unlabeled simple graphs ( no loops or multiple edges ) .",
    "this becomes a hopf algebra with product disjoint union and coproduct @xmath157 where the sum is over subsets of vertices @xmath158 with @xmath159 the induced subgraphs .",
    "graded by number of vertices , @xmath156 is both commutative and cocommutative , and is a polynomial algebra as an algebra .",
    "the associated random walk is described in example  [ ex31 ] below .",
    "[ ex21 ]    ( * ? ? ?",
    "13 ) ( * ? ? ?",
    "3.3 ) let @xmath160 be the vector space spanned by the set of simple graphs with vertices are labeled @xmath161 , for some @xmath21 .",
    "the product of two graphs @xmath162 is their disjoint union , where the vertices of @xmath163 keep their labels , and the labels in @xmath164 are increased by the number of vertices in @xmath163 .",
    "the coproduct is @xmath157 where we again sum over all subsets @xmath158 of vertices of @xmath165 , and @xmath159 are relabeled so the vertices in each keep the same relative order .",
    "for example ,        where @xmath166 denotes the empty graph .",
    "@xmath160 is noncommutative and cocommutative and a free associative algebra as an algebra ; the associated random walk is detailed in example  [ exncgraphs2 ] . as the notation suggests , @xmath156 is a quotient of @xmath160 , obtained by forgetting the labels on the vertices .",
    "[ exncgraphs ]    aguiar ",
    "sottile @xcite define a combinatorial hopf algebra as a hopf algebra @xmath0 with a character @xmath167 which is both additive and multiplicative .",
    "they prove a universality theorem : any combinatorial hopf algebra has a unique character - preserving hopf morphism into the algebra of quasisymmetric functions .",
    "they show that this unifies many ways of building generating functions .",
    "when applied to the hopf algebra of graphs , their map gives the chromatic polynomial . in [ sec35 ]",
    "we find that their map gives the probability of absorption for several of our markov chains .",
    "see also the examples in [ sec6 ] .",
    "a good introduction to hopf algebras is in @xcite .",
    "a useful standard reference is in @xcite and our development does not use much outside of her chapter 1 .",
    "the broad - ranging text by @xcite is aimed towards quantum groups but contains many examples useful here .",
    "quantum groups are neither commutative nor cocommutative and need special treatment ; see example  [ ex62 ] .",
    "a key ingredient in our work is the hopf - square map @xmath168 ; @xmath169 is also written @xmath170}$ ] . in sweedler notation , @xmath171 ; in our combinatorial setting , it is useful to think of `` pulling apart ''",
    "@xmath63 according to @xmath9 , then using the product to put the pieces together . on graded hopf algebras ,",
    "@xmath4 preserves the grading and , appropriately normalized , gives a markov chain on appropriate bases .",
    "see [ sec32 ] for assumptions and details .",
    "the higher power maps @xmath172}\\delta^{[a]}$ ] will also be studied , since under our hypothesis , they present no extra difficulty . for example , @xmath173 . in the shuffling example , @xmath174 corresponds to the `` @xmath59-shuffles '' of @xcite .",
    "a theorem of @xcite shows that , for commutative or cocommutative hopf algebras , the power rule holds : @xmath175})^{[b]}=x^{[ab]}$ ] , or @xmath176 .",
    "see also the discussion in @xcite . in shuffling language",
    "this becomes `` an @xmath59-shuffle followed by a @xmath177-shuffle is an @xmath178-shuffle '' @xcite .",
    "in general hopf algebras this power law often fails @xcite .",
    "power maps are actively studied as part of a program to carry over to hopf algebras some of the rich theory of groups .",
    "see @xcite and their references .",
    "the eigenvectors of our markov chains are described using combinatorics related to the free associative algebra , as described in the self - contained ( * ? ? ?",
    "* chap .  5 ) .",
    "a word in an ordered alphabet is _ lyndon _ if it is strictly smaller ( in lexicographic order ) than its cyclic rearrangements .",
    "so @xmath179 is lyndon but @xmath180 or @xmath181 are not .",
    "a basic fact ( * ? ? ?",
    "5.1.5 ) is that any word @xmath43 has a unique _ lyndon factorization _ ,",
    "that is , @xmath182 with each @xmath183 a lyndon word and @xmath184 .",
    "further , each lyndon word @xmath49 has a _ standard factorization _ : if @xmath49 is not a single letter , then @xmath185 where @xmath183 is non - trivial lyndon and @xmath186 is the longest right lyndon factor of @xmath49 .",
    "( the standard factorization of a letter is just that letter by definition . )",
    "thus @xmath187 . using this , define , for lyndon @xmath49 , its _ standard bracketing _",
    "@xmath188 recursively by @xmath189 for a letter and @xmath190 $ ] for @xmath185 in standard factorization . as usual , @xmath191=xy - yx$ ] for words @xmath192 .",
    "thus @xmath193=\\left[[1,3],\\left[2,[4,5]\\right]\\right]\\\\ & = 13245 - 13254 - 13452 + 13542 - 31245 + 31254 + 31452 - 31542 \\\\ & \\quad -24513 + 25413 + 45213 - 54213 + 24531 - 25431 - 45231 + 54231 \\end{aligned}\\ ] ] and @xmath194=\\left[1,[\\lambda(12),2]\\right]\\\\ & = 1122 - 2(1212)+2(2121)-2211.\\end{aligned}\\ ] ]    ( * ? ? ?",
    "2 ) describes how to visualize the standard bracketing of a lyndon word as a rooted binary tree : given a lyndon word @xmath49 with standard factorization @xmath185 , inductively set @xmath195 to be the tree with @xmath196 as its left branch and @xmath197 as its right branch . @xmath198 and @xmath199 are shown below .",
    "observe that a word @xmath43 appears in the expansion of @xmath188 only if , after exchanging the left and right branches at some vertices of @xmath195 , the leaves of @xmath195 , when read from left to right , spell out @xmath43 .",
    "the coefficient of @xmath43 in @xmath188 is then the signed number of ways to do this ( the sign is the parity of the number of exchanges required ) .",
    "for example ,    * 25413 has coefficient 1 in @xmath200 since the unique way to rearrange @xmath198 so the leaves spell 25413 is to exchange the branches at the root and the highest interior vertex ; * 21345 does not appear in @xmath200 since whenever the branches of @xmath198 switch , 2 must appear adjacent to either 4 or 5 , which does not hold for 21345 ; * 1221 has coefficient 0 in @xmath201 as , to make the leaves of @xmath199 spell 1221 , we can either exchange branches at the root , or exchange branches at both of the other interior vertices . these two rearrangements have opposite signs , so the signed count of rearrangments is 0 .",
    "a final piece of notation is the following symmetrized product : let @xmath182 in lyndon factorization . then set @xmath202 viewing @xmath203 as a polynomial in the letters @xmath204 will be useful for theorem  [ gefnthm2 ] .",
    "garsia s tree construction can be extended to visualize @xmath203 , using what barcelo and bergeron @xcite call _ decreasing lyndon hedgerows _ , which simply consist of @xmath205 placed in a row .",
    "denote this as @xmath206 also .",
    "the example @xmath207 is shown below",
    ".        we can again express the coefficient of @xmath208 in @xmath203 as the signed number of ways to rearrange @xmath206 so the leaves spell @xmath208 .",
    "now there are two types of allowed moves : exchanging the left and right branches at a vertex , and permuting the trees of the hedgerow .",
    "the latter move does not come with a sign .",
    "thus 14253 has coefficient @xmath209 in @xmath210 , as the unique rearrangement of @xmath207 which spells 14253 requires transposing the trees and permuting the branches labeled 3 and 5 .",
    "it is clear from this pictorial description that every term appearing in @xmath203 is a permutation of the letters in @xmath43 .",
    "5.2 ) shows that @xmath203 form a basis for a free associative algebra .",
    "this will turn out to be a left eigenbasis for inverse riffle shuffling , and similar theorems hold for other hopf algebras .",
    "a basic object of study is the vector space @xmath211 of homogeneous symmetric polynomials in @xmath100 variables of degree @xmath21 .",
    "the direct sum @xmath212 forms a graded algebra with familiar bases : the monomial ( @xmath213 ) , elementary ( @xmath214 ) , homogeneous ( @xmath215 ) , and power sums ( @xmath216 ) .",
    "for example , @xmath217 and for a partition @xmath218 with @xmath219 . as @xmath220 ranges over partitions of @xmath221 form a basis for @xmath211 , from which we construct the rock - breaking chain of example  [ ex12 ] .",
    "splendid accounts of symmetric function theory appear in @xcite and @xcite .",
    "a variety of hopf algebra techniques are woven into these topics , as emphasized by @xcite and @xcite .",
    "the comprehensive account of noncommutative symmetric functions @xcite and its follow - ups furthers the deep connection between combinatorics and hopf algebras .",
    "however , this paper will only involve its dual , the algebra of quasisymmetric functions , as they encode informations about absorption rates of our chains , see [ sec35 ] .",
    "a basis of this algebra is given by the monomial quasisymmetric functions : for a composition @xmath222 , define @xmath223 .",
    "further details are in ( * ? ? ?",
    "* sec .  7.19 ) .",
    "this section states and proves our main theorems .",
    "this introduction sets out definitions .",
    "[ sec32 ] develops the reweighting schemes needed to have the hopf - square maps give rise to markov chains .",
    "[ sec322 ] explains that these chains are often acyclic .",
    "[ sec333 ] addresses a symmetrization lemma that we will use in [ sec33 ] and [ sec34 ] to find descriptions of some left and right eigenvectors respectively for such chains .",
    "[ sec35 ] determines the stationary distributions and gives expressions for the chance of absorption in terms of generalized chromatic polynomials .",
    "applications of these theorems are in the last three sections of this paper .",
    "as mentioned at the end of [ sec22 ] , we will be concerned with connected , graded ( by positive integers ) hopf algebras @xmath0 with a distinguished basis @xmath224 satisfying one of two  freeness \" conditions ( in both cases , the number of generators may be finite or infinite ) :    1 .   @xmath225 $ ] as an algebra ( ie @xmath0 is a polynomial algebra ) and @xmath226 , the basis of monomials . the @xmath227 may have any degree , and there is no constraint on the coalgebra structure .",
    "this will give rise to a markov chain on combinatorial objects where assembling is symmetric and deterministic .",
    "2 .   @xmath0 is cocommutative , @xmath228 as an algebra , ( ie @xmath0 is a free associative algebra ) and @xmath229 , the basis of words .",
    "the @xmath227 may have any degree , and do not need to be primitive .",
    "this will give rise to a markov chain on combinatorial objects where pulling apart is symmetric , assembling is non - symmetric and deterministic .    by the cartier - milnor - moore theorem @xcite , any graded connected commutative hopf algebra has a basis which satisfies the first condition .",
    "however , we will not make use of this , since the two conditions above are reasonable properties for many combinatorial hopf algebras and their canonical bases . for example",
    ", the hopf algebra of symmetric functions , with the basis of elementary symmetric functions @xmath26 , satisfies the first condition .",
    "write @xmath150 for the subspace of degree @xmath21 in @xmath0 , and @xmath230 for the degree @xmath21 basis elements .",
    "the _ generators _ @xmath227 can be identified as those basis elements which are not the non - trivial product of basis elements ; in other words , generators can not be obtained by assembling objects of lower degree .",
    "thus , all basis elements of degree one are generators , but there are usually generators of higher degree ; see examples  [ ex31 ] and [ exncgraphs2 ] below .",
    "one can view the conditions 1 and 2 above as requiring the basis elements to have unique factorization into generators , allowing the convenient view of @xmath231 as a word @xmath232 .",
    "its _ length _",
    "@xmath233 is then well - defined - it is the number of generators one needs to assemble together to produce @xmath177 .",
    "some properties of the length are developed in [ sec322 ] .",
    "for a noncommutative hopf algebra , it is useful to choose a linear order on the set of generators refining the ordering by degree : i.e. if @xmath234 , then @xmath235 .",
    "this allows the construction of the lyndon factorization and standard bracketing of a basis element , as in [ sec23 ] .",
    "example  [ gefnex ] demonstrates such calculations .",
    "the @xmath59th hopf - power map is @xmath236}\\delta^{[a]}$ ] , the @xmath59-fold coproduct followed by the @xmath59-fold product .",
    "these power maps are the central object of study of @xcite .",
    "intuitively , @xmath174 corresponds to breaking an object into @xmath59 pieces ( some possibly empty ) in all possible ways and then reassembling them .",
    "the @xmath174 preserve degree , thus mapping @xmath150 to @xmath150 .    as noted in @xcite ,",
    "the power - map @xmath174 is an algebra homomorphism if @xmath0 is commutative : @xmath237}\\sum_{(x),(y)}x_{(1)}y_{(1 ) } \\otimes \\cdots \\otimes x_{(a)}y_{(a ) } \\\\ & = \\sum_{(x),(y)}x_{(1)}y_{(1 ) } \\dots x_{(a)}y_{(a ) } = \\sum_{(x),(y)}x_{(1)}\\dots x_{(a ) } y_{(1 ) } \\dots y_{(a ) } = \\psi^a(x ) \\psi^a(y);\\end{aligned}\\ ] ] and a coalgebra homomorphism if @xmath0 is cocommutative : @xmath238 only the former will be necessary for the rest of this section .",
    "the power maps can sometimes be interpreted as a natural markov chain on the basis elements @xmath230 of @xmath150 .",
    "the set of all unlabeled simple graphs gives rise to a hopf algebra @xmath156 with disjoint union as product and @xmath157 where the sum is over subsets of vertices @xmath158 with @xmath159 the induced subgraphs .",
    "graded by the size of the vertex set , @xmath156 is a commutative and cocommutative polynomial hopf algebra with basis @xmath224 consisting of all graphs .",
    "the generators are precisely the connected graphs , and the length of a graph is its number of connected components .",
    "the resulting markov chain on graphs with @xmath21 vertices evolves as follows : from @xmath165 , color the vertices of @xmath165 red or blue , independently with probability 1/2 .",
    "erase any edge with opposite colored vertices .",
    "this gives one step of the chain ; the process terminates when there are no edges .",
    "the analogous hopf algebra of simplicial complexes is discussed in [ sec6 ] .",
    "[ ex31 ]    let @xmath160 be the linear span of the simple graphs whose vertices are labeled @xmath161 for some @xmath21 .",
    "the product of two graphs @xmath162 is their disjoint union , where the vertices of @xmath163 keep their labels , and the labels in @xmath164 are increased by the number of vertices in @xmath163 .",
    "the coproduct is @xmath157 where the sum again runs over all subsets @xmath158 of vertices of @xmath165 , and @xmath159 are relabeled so the vertices in each keep the same relative order .",
    "an example of a coproduct calculation is in example  [ exncgraphs ] .",
    "@xmath160 is cocommutative and a free associative algebra ; its distinguished basis @xmath224 is the set of all graphs .",
    "a graph in @xmath160 is a product if and only if there is an @xmath35 such that no edge connects a vertex with label @xmath239 to a vertex with label @xmath240 .",
    "thus , all connected graphs are generators , but there are non - connected generators such as        each step of the associated random walk on @xmath230 , the graphs with @xmath21 vertices , has this description : from @xmath165 , color the vertices of @xmath165 red or blue , independently with probability 1/2 .",
    "suppose @xmath241 vertices received the color red ; now erase any edge with opposite colored vertices , and relabel so the red vertices are @xmath242 and the blue vertices are @xmath243 , keeping their relative orders .",
    "for example , starting at the complete graph on three vertices , the chain reaches each of the graphs shown below with probability @xmath244 :        so , forgetting the colors of the vertices ,        as with @xmath156 , the chain on @xmath245 stops when all edges have been removed .",
    "[ exncgraphs2 ]    when is such a probabilistic interpretation possible ? to begin , the coefficients of @xmath246 must be non - negative real numbers for @xmath247 .",
    "this usually holds for combinatorial hopf algebras , but the free associative algebra and the above algebras of graphs have an additional desirable property : for any @xmath247 , the coefficients of @xmath248 sum to @xmath249 , regardless of @xmath177 . thus the operator @xmath250 forms a markov transition matrix on basis elements of degree @xmath21 .",
    "indeed , the coefficients of @xmath251 sum to @xmath252 for all @xmath59 , so @xmath253 defines a transition matrix @xmath254 . for other hopf algebras ,",
    "the sum of the coefficients in @xmath248 may depend on @xmath177 , so simply scaling @xmath4 does not always yield a transition matrix .",
    "* lemma 4.4.1.1 ) provides a solution : if @xmath82 is a matrix with non - negative entries and @xmath255 is a strictly positive right eigenfunction of @xmath82 with eigenvalue 1 , then @xmath256 is a transition matrix .",
    "here @xmath257 is the conjugate of @xmath82 by the diagonal matrix whose entries are @xmath258 .",
    "theorem  [ thm31 ] below gives conditions for such @xmath255 to exist , and constructs @xmath255 explicitly .",
    "the following example explains why this construction is natural .",
    "consider the algebra of symmetric functions with basis @xmath30 , the elementary symmetric functions .",
    "the length @xmath259 is the number of parts in the partition @xmath220 , and the generators are the partitions with a single part .",
    "the coproduct is defined by @xmath260 with the sum over all compositions @xmath261 with @xmath262 , and @xmath263 is the composition @xmath264 . when reordered , some parts may be empty and some parts may occur several times .",
    "there are @xmath265 possible choices of @xmath266 , so the coefficients of @xmath267 sum to @xmath265 , which depends on @xmath220 .",
    "consider degree 2 , where the basis elements are @xmath268 and @xmath269 .",
    "for @xmath82 such that @xmath270 , @xmath271 which is not a transition matrix as the second row does not sum to 1 .",
    "resolve this by performing a diagonal change of basis : set @xmath272 , @xmath273 for some non - negative function @xmath274 , and consider @xmath257 with @xmath275 . since the first row of @xmath82 , corresponding to @xmath268 , pose no problems , set @xmath276 . in view of the upcoming theorem ,",
    "it is better to think of this as @xmath277 with @xmath278 .",
    "equivalently , @xmath279 with @xmath280",
    ". turning attention to the second row , observe that @xmath281 , so @xmath282 , which means @xmath283 so @xmath257 is a transition matrix if @xmath284 , i.e. if @xmath285 .",
    "continue to degree 3 , where the basis elements are @xmath286 , @xmath287 and @xmath288 .",
    "now define @xmath82 such that @xmath289 ; @xmath290 again , look for @xmath291 and @xmath292 so that @xmath257 , defined by @xmath293 , is a transition matrix , where @xmath294 , @xmath295 , @xmath296 . note that , taking @xmath297 and @xmath298 , the first two rows of @xmath257 sum to 1 .",
    "view this as @xmath299 and @xmath300 .",
    "then , as @xmath301 , the transition matrix is given by @xmath302 and choosing @xmath303 makes the third row sum to 1 .    continuing , we find that @xmath304 , so @xmath29 , more generally , @xmath305 with @xmath35 appearing @xmath306 times in @xmath220 .",
    "then , for example , @xmath307 so , for any partition @xmath220 of @xmath21 , @xmath308 and the coefficients of @xmath309 sum to @xmath310 , irrespective of @xmath220 . thus @xmath311 describes a transition matrix , which has the rock - breaking interpretation of [ sec1 ] .",
    "[ ex32 ]    the following theorem shows that this algorithm works in many cases .",
    "observe that , in the above example , it is the non - zero off - diagonal entries that change ; the diagonal entries can not be changed by rescaling the basis . hence the algorithm would fail if some row had all off - diagonal entries equal to 0 , and diagonal entry not equal to 1 .",
    "this corresponds to the existence of @xmath312 with @xmath313 for some @xmath314 ; the condition @xmath315 below precisely prevents this .",
    "intuitively , we are requiring that each generator of degree greater than one can be broken non - trivially .",
    "for an example where this condition fails , see example  [ quotsym ] .",
    "let @xmath0 be a graded hopf algebra over @xmath316 which is either a polynomial algebra or a free associative algebra that is cocommutative .",
    "let @xmath224 denote the basis of monomials in the generators .",
    "suppose that , for all generators @xmath317 with @xmath318 , all coefficients of @xmath319 ( in the @xmath320 basis ) are non - negative and @xmath321 .",
    "let @xmath254 be the transpose of the matrix of @xmath322 with respect to the basis @xmath230 ; in other words , @xmath323 ( suppressing the dependence of @xmath254 on @xmath21 ) .",
    "define , by induction on degree , @xmath324 where @xmath258 satisfies @xmath325 .",
    "write @xmath326 and @xmath327 .",
    "then the matrix of the @xmath59th power map with respect to the @xmath328 basis , when transposed and multiplied by @xmath329 , is a transition matrix .",
    "in other words , the operator @xmath330 on @xmath150 , defined by @xmath331 , has @xmath332 and @xmath333 for all @xmath334 , and all @xmath335 and @xmath336 ( the same scaling works simultaneously for all @xmath59 ) .",
    "[ thm31 ]    1 .",
    "observe that , if @xmath337 , then the definition of @xmath338 ensures @xmath339 .",
    "equivalently , @xmath255 is a multiplicative function .",
    "the definition of @xmath340 is not circular : since @xmath0 is graded with @xmath341 , the counit is zero on elements of positive degree so that @xmath342 . hence @xmath343 is non - zero only if @xmath344 or @xmath345 , so the denominator in the expression for @xmath340 only involves @xmath258 for @xmath177 with @xmath345 .",
    "such @xmath177 can be factorized as @xmath337 with @xmath346 , whence @xmath347 , so @xmath340 only depends on @xmath348 with @xmath349 .",
    "first note that @xmath350 , since @xmath351 and @xmath352 means no @xmath317 terms can occur in @xmath353 .",
    "so @xmath354 as desired .",
    "let @xmath355 denote the coefficients of @xmath319 in the @xmath320 basis , so @xmath356 .",
    "then @xmath357 , and @xmath358 so , if @xmath177 has factorization into generators @xmath359 , then @xmath360 so @xmath361 thus@xmath362 as desired , where the third equality is due to multiplicativity of @xmath255 .",
    "the above showed each row of @xmath363 sums to 1 , which means @xmath364 is a right eigenvector of @xmath363 of eigenvalue 1 .",
    "@xmath330 describes @xmath174 in the @xmath365 basis , which is also a basis of monomials / words , in a rescaled set of generators @xmath340 , so , by theorems  [ fefnthm1 ] and  [ fefnthm2 ] , the eigenspaces of @xmath330 do not depend on @xmath59 .",
    "hence @xmath364 is a right eigenvector of @xmath330 of eigenvalue 1 for all @xmath59 , thus each row of @xmath330 sums to 1 also .    finally , to see that the entries of @xmath366 are non - negative",
    ", first extend the notation @xmath355 so @xmath142}(c)=\\sum_{b_{1},\\dots b_{a}}\\eta_{c}^{b_{1},\\dots , b_{a}}b_{1}\\otimes\\dots\\otimes b_{a}$ ] . as @xmath142}=(\\iota\\otimes\\dots\\otimes\\iota\\otimes\\delta)\\delta^{[a-1]}$ ] , it follows that @xmath367 , which inductively shows that @xmath368 for all generators @xmath317 and all @xmath369 .",
    "so , if @xmath177 has factorization into generators @xmath359 , then @xmath370 where the sum is over all sets @xmath371 such that the product @xmath372 . finally , @xmath373",
    "observe that the rock - breaking chain ( examples  [ ex12 ] and [ ex32 ] ) is _ acyclic _ - it can never return to a state it has left , because the only way to leave a state is to break the rocks into more pieces . more specifically , at each step the chain either stays at the same partition or moves to a partition which refines the current state ; as refinement of partitions is a partial order , the chain can not return to a state it has left .",
    "the same is true for the chain on unlabeled graphs ( example  [ ex31 ] ) - the number of connected components increases over time , and the chain never returns to a previous state .",
    "such behavior can be explained by the way the length changes under the product and coproduct .",
    "( recall that the length @xmath233 is the number of factors in the unique factorization of @xmath177 into generators . )",
    "define a relation on @xmath224 by @xmath374 if @xmath375 appears in @xmath251 for some @xmath59 .",
    "if @xmath174 induces a markov chain on @xmath230 , then this precisely says that @xmath375 is accessible from @xmath177 .",
    "let @xmath376 be monomials / words in a hopf algebra which is either a polynomial algebra or a free associative algebra that is cocommutative .",
    "then    a.   @xmath377 ; b.   for any summand @xmath378 in @xmath142}(b)$ ] , @xmath379 ; c.   if @xmath374 , then @xmath380 .",
    "[ lengthlemma ]    \\(i ) is clear from the definition of length .",
    "prove ( ii ) by induction on @xmath233 .",
    "note that the claim is vacuously true if @xmath177 is a generator , as each @xmath381 , and not all @xmath382 may be zero .",
    "if @xmath177 factorizes non - trivially as @xmath337 , then , as @xmath142}(b)=\\delta^{[a]}(x)\\delta^{[a]}(y)$ ] , it must be the case that @xmath383 , for some @xmath384 in @xmath142}(x)$ ] , @xmath385 in @xmath142}(y)$ ] .",
    "so @xmath386 by ( i ) , and by inductive hypothesis , this is at least @xmath387 .",
    "\\(iii ) follows trivially from ( i ) and ( ii ) : if @xmath374 , then @xmath388 for a term @xmath378 in @xmath142}(b)$ ] .",
    "so @xmath389 .",
    "if @xmath0 is a polynomial algebra , more is true .",
    "the following proposition explains why chains built from polynomial algebras ( i.e. , with deterministic and symmetric assembling ) are always acyclic ; in probability language , it says that , if the current state is built from @xmath49 generators , then , with probability @xmath390 , the chain stays at this state , otherwise , it moves to a state built from more generators .",
    "hence , if the states are totally ordered to refine the partial ordering by length , then the transition matrices are upper - triangular with @xmath390 on the main diagonal .",
    "( acyclicity ) let @xmath0 be a hopf algebra which is a polynomial algebra as an algebra , and @xmath224 its monomial basis .",
    "then the relation @xmath391 defines a partial order on @xmath224 , and the ordering by length refines this order : if @xmath374 and @xmath392 , then @xmath393 .",
    "furthermore , for any integer @xmath59 and any @xmath231 with length @xmath233 , @xmath394 for some @xmath395 .",
    "[ acyclicity ]    it is easier to first prove the expression for @xmath396 .",
    "suppose @xmath177 has factorization into generators @xmath397 .",
    "as @xmath0 is commutative , @xmath174 is an algebra homomorphism , so @xmath398 .",
    "recall from [ sec22 ] that @xmath399 , in other words , @xmath400 and @xmath401 are the only terms in @xmath319 which have a tensor - factor of degree 0 . as @xmath141}=(\\iota \\otimes \\delta)\\delta$ ] , the only terms in @xmath141}(c)$ ] with two tensor - factors of degree 0 are @xmath402 , @xmath403 and @xmath404 .",
    "inductively , we see that the only terms in @xmath142}(c)$ ] with all but one tensor - factor having degree 0 are @xmath405 .",
    "so @xmath406 for generators @xmath317 .",
    "as @xmath407 , and length is multiplicative ( lemma  [ lengthlemma ] ( i ) ) , the expression for @xmath396 follows .",
    "it is then clear that @xmath391 is reflexive and antisymmetric .",
    "transitivity follows from the power rule : if @xmath374 and @xmath408 , then @xmath375 appears in @xmath396 for some @xmath59 and @xmath409 appears in @xmath410 for some @xmath411 .",
    "so @xmath409 appears in @xmath412 .",
    "the same argument applied to a cocommutative free associative algebra shows that all terms in @xmath251 are either a permutation of the factors of @xmath177 , or have length greater than that of @xmath177 .",
    "the relation @xmath391 is only a preorder ; the associated chains are not acyclic , as they may oscillate between such permutations of factors .",
    "for example , in the noncommutative hopf algebra of labeled graphs , the following transition probabilities can occur :        ( the bottom state is absorbing ) .",
    "the probability of going from @xmath177 to some permutation of its factors ( as opposed to to a state of greater length , from which there is no return to @xmath177 ) is @xmath413 .    here",
    "is one more result in this spirit , necessary in [ sec33 ] to show that the eigenvectors constructed there have good triangularity properties and hence form an eigenbasis :    let @xmath414 be monomials / words in a hopf algebra which is either a polynomial algebra or a free associative algebra that is cocommutative . if @xmath415 and @xmath416 for each @xmath35 , then @xmath417 for any @xmath418 . [ acyclicproduct ]    for readability ,",
    "take @xmath419 and write @xmath420 . by definition of the relation @xmath391",
    ", it must be that @xmath421 for some summand @xmath422 of @xmath423}(x)$ ] .",
    "likewise @xmath424 for some @xmath411 .",
    "suppose @xmath425 .",
    "coassociativity implies that @xmath142}(y)=(\\iota \\otimes \\dots \\otimes \\iota \\otimes \\delta^{[a - a']})\\delta^{[a']}(y)$ ] , and @xmath426 is certainly a summand of @xmath427}(y_{(a')})$ ] , so @xmath428 occurs in @xmath142}(y)$ ] .",
    "so , taking @xmath429 , we can assume @xmath430 .",
    "then @xmath142}(b ) = \\delta^{[a]}(x ) \\delta^{[a]}(y)$ ] contains the term @xmath431 .",
    "hence @xmath251 contains the term @xmath432 , and this product is @xmath433 if @xmath0 is a polynomial algebra .",
    "if @xmath0 is a cocommutative , free associative algebra , the factors in @xmath431 must be rearranged to conclude that @xmath434 and @xmath435 .",
    "coassociativity implies @xmath436}=(\\delta \\otimes \\dots \\otimes \\delta ) \\delta^{[a]}$ ] , and @xmath437 contains @xmath438 , so @xmath436}(b)$ ] contains the term @xmath439 . as @xmath0 is cocommutative , any permutation of the tensor - factors , in particular , @xmath440 and @xmath441 , must also be summands of @xmath436}(b)$ ] , and multiplying these tensor - factors together shows that both @xmath433 and @xmath442 appear in @xmath443}(b)$ ] .",
    "recall from example  [ ex32 ] the algebra of symmetric functions with basis @xmath444 , which induces the rock - breaking process . here ,",
    "@xmath445 if and only if @xmath446 refines @xmath220 .",
    "lemma  [ acyclicproduct ] for the case @xmath419 is the statement that , if @xmath220 is the union of two partitions @xmath447 and @xmath448 , and @xmath449 refines @xmath447 , @xmath450 refines @xmath448 , then @xmath451 refines @xmath452 .",
    "the algorithmic construction of left and right eigenbases for the chains created in [ sec32 ] will go as follows :    a.   make an eigenvector of smallest eigenvalue for each generator @xmath317 ; b.   for each basis element @xmath177 with factorization @xmath453 , build an eigenvector of larger eigenvalue out of the eigenvectors corresponding to the factors @xmath227 , produced in the previous step .",
    "concentrate on the left eigenvectors for the moment .",
    "recall that the transition matrix @xmath254 is defined by @xmath454 , so the left eigenvectors for our markov chain are the usual eigenvectors of @xmath174 on @xmath0 . step ( ii ) is simple if @xmath0 is a polynomial algebra , because then @xmath0 is commutative so @xmath174 is an algebra homomorphism .",
    "consequently , the product of two eigenvectors is an eigenvector with the product eigenvalue .",
    "this fails for cocommutative , free associative algebras @xmath0 , but can be fixed by taking symmetrized products :    let @xmath455 be primitive elements of any hopf algebra @xmath0 , then @xmath456 is an eigenvector of @xmath174 with eigenvalue @xmath457 .",
    "[ symlemma ]    for concreteness , take @xmath458 .",
    "then @xmath459    in [ sec33 ] and [ sec34 ] , the fact that the eigenvectors constructed give a basis will follow from triangularity arguments based on [ sec322 ] .",
    "these rely heavily on the explicit structure of a polynomial algebra or a free associative algebra .",
    "hence it is natural to look for alternatives that will generalize this eigenbasis construction plan to hopf algebras with more complicated structures .",
    "for example , one may ask whether some good choice of @xmath18 exists with which the symmetrization lemma will automatically generate a full eigenbasis .",
    "when @xmath0 is cocommutative , an elegant answer stems from the following two well - known structure theorems :    @xcite if @xmath0 is graded , cocommutative and connected , then @xmath0 is hopf isomorphic to @xmath67 , the universal enveloping algebra of a lie algebra @xmath68 , where @xmath68 is the lie algebra of primitive elements of @xmath0 .    @xcite . if @xmath460 is a basis for a lie algebra @xmath68 , then the symmetrized products @xmath461 , for @xmath462 , form a basis for @xmath67 .",
    "putting these together reduces the diagonalization of @xmath174 on a cocommutative hopf algebra to determining a basis of primitive elements :    [ strong symmetrization lemma ] let @xmath0 be a graded , cocommutative , connected hopf algebra , and let @xmath460 be a basis for the subspace of primitive elements in @xmath0 .",
    "then , for each @xmath463 , @xmath464 is a basis of the @xmath457-eigenspace of @xmath174 .",
    "[ strongkeylemma ]    much work @xcite has been done on computing a basis for the subspace of the primitives of particular hopf algebras , their formulas are in general more efficient than our universal method here , and using these will be the subject of future work . alternatively , the theory of good lyndon words @xcite gives a grobner basis argument to further reduce the problem to finding elements which generate the lie algebra of primitives , and understanding the relations between them .",
    "this is the motivation behind our construction of the eigenvectors in theorem  [ gefnthm2 ] , although the proof is independent of this theorem , more analogous to that of theorem  [ gefnthm1 ] , the case of a polynomial algebra .",
    "this section gives an algorithmic construction of an eigenbasis for the hopf power maps @xmath174 on the hopf algebras of interest .",
    "if @xmath254 as defined by @xmath454 is a transition matrix , then this eigenbasis is precisely a left eigenbasis of the associated chain , though the results below stand whether or not such a chain may be defined ( e.g. , the construction works when some coefficients of @xmath319 are negative , and when there are primitive generators of degree @xmath465 ) .",
    "the first step is to associate each generator to an eigenvector of smallest eigenvalue , this is achieved using the _ ( first ) eulerian idempotent",
    "_ map @xmath466}\\bar{\\delta}^{[a]}(x)\\ ] ] here @xmath467 , as explained in [ sec22 ] .",
    "then inductively define @xmath423}=(\\iota \\otimes \\cdots \\otimes \\iota \\otimes { \\bar\\delta}){\\bar\\delta}^{[a-1]}$ ] , which picks out the terms in @xmath142 } ( x)$ ] where each tensor - factor has strictly positive degree .",
    "this captures the notion of breaking into @xmath59 non - trivial pieces .",
    "observe that , if @xmath152 , then @xmath468}(x)=0 $ ] whenever @xmath469 , so @xmath470 is a finite sum for all @xmath63 .",
    "( by convention , @xmath471 on @xmath472 . )",
    "this map @xmath473 is the first of a series of eulerian idempotents @xmath474 defined by patras @xcite ; he proves that , in a commutative or cocommutative hopf algebra of characteristic zero where @xmath475 is _ locally nilpotent _",
    "( i.e. for each @xmath63 , there is some @xmath59 with @xmath423 } x=0 $ ] ) , the hopf - powers are diagonalizable , and these @xmath474 are orthogonal projections onto the eigenspaces . in particular , this _ weight decomposition _ holds for graded commutative or cocommutative hopf algebras .",
    "we will not need the full series of eulerian idempotents , although example  [ highereulerianidempotent ] makes the connection between them and our eigenbasis .    to deduce that the eigenvectors we construct are triangular with respect to @xmath224 needs one crucial observation ( recall from [ sec322 ] that @xmath476 if @xmath375 occurs in @xmath251 for some @xmath59 ) :    for any generator @xmath317 , @xmath477 for some real @xmath478 . [ ec ]",
    "the summand @xmath479}\\bar{\\delta}^{[a]}(c)$ ] involves terms of length at least @xmath59 , from which the second expression of @xmath480 is immediate .",
    "each term @xmath375 of @xmath480 appears in @xmath481 for some @xmath59 , hence @xmath482 .",
    "combine this with the knowledge from the second expression that @xmath317 occurs with coefficient 1 to deduce the first expression .",
    "the two theorems below detail the construction of an eigenbasis for @xmath174 in a polynomial algebra and in a cocommutative free associative algebra respectively .",
    "these are left eigenvectors for the corresponding transition matrices .",
    "a worked example will follow immediately ; it may help to read these together .",
    "let @xmath483 be a hopf algebra ( over a field of characteristic zero ) that is a polynomial algebra as an algebra , with monomial basis @xmath484 .",
    "for @xmath247 with factorization into generators @xmath485 , set @xmath486 then @xmath487 is an eigenvector of @xmath488 of eigenvalue @xmath489 satisfying the triangularity condition @xmath490 hence @xmath491 is an eigenbasis for the action of @xmath488 on @xmath492 , and the multiplicity of the eigenvalue @xmath489 in @xmath492 is the coefficient of @xmath493 in @xmath494 , where @xmath495 is the number of generators of degree @xmath35 .",
    "[ gefnthm1 ]    let @xmath483 be a cocommutative hopf algebra ( over a field of characteristic zero ) that is a free associative algebra with word basis @xmath484 .",
    "for @xmath496 with factorization into generators @xmath485 , set @xmath487 to be the polynomial @xmath497 evaluated at @xmath498 .",
    "in other words , in the terminology of [ sec23 ] ,    * for @xmath317 a generator , set @xmath499 ; * for @xmath177 a lyndon word , inductively define @xmath500 $ ] where @xmath501 is the standard factorization of @xmath177 ; * for @xmath177 with lyndon factorization @xmath415 , set @xmath502 .",
    "then @xmath487 is an eigenvector of @xmath488 of eigenvalue @xmath503 ( @xmath100 the number of lyndon factors in @xmath177 ) satisfying the triangularity condition @xmath504 hence @xmath491 is an eigenbasis for the action of @xmath488 on @xmath492 , and the multiplicity of the eigenvalue @xmath503 in @xmath492 is the coefficient of @xmath505 in @xmath494 , where @xmath495 is the number of lyndon words of degree @xmath35 in the alphabet of generators .",
    "[ gefnthm2 ]    1 .",
    "if @xmath174 defines a markov chain , then the triangularity of @xmath506 ( in both theorems ) has the following interpretation : the left eigenfunction @xmath506 takes non - zero values only on states that are reachable from @xmath177 .",
    "the expression of the multiplicity of the eigenvalues ( in both theorems ) holds for hopf algebras that are bigraded , trigraded , etc , if we replace all @xmath63s , @xmath21s and @xmath35s by pairs , triples , etc , and read the formula as multi - index notation . for example , for a bigraded polynomial algebra @xmath0 , the multiplicity of the @xmath507-eigenspace in @xmath508 is the coefficient of @xmath509 in @xmath510 , where @xmath511 is the number of generators of bidegree @xmath512",
    ". this idea will be useful in [ sec5 ] .",
    "theorem  [ gefnthm2 ] essentially states that any cocommutative free associative algebra is in fact isomorphic to _ the _ free associative algebra , generated by @xmath480 .",
    "but there is no analogous interpretation for theorem  [ gefnthm1 ] ; being a polynomial algebra is not a strong enough condition to force all hopf algebras with this condition to be isomorphic .",
    "a polynomial algebra @xmath0 is isomorphic to the usual polynomial hopf algebra ( i.e. with primitive generators ) only if @xmath0 is cocommutative ; then @xmath480 gives a set of primitive generators .",
    "as promised , here is a worked example of this calculation , in the noncommutative hopf algebra of labeled graphs , as defined in example  [ exncgraphs2 ] .",
    "let @xmath177 be the graph        which is the product of three generators as shown .",
    "( its factors happen to be its connected components , but that s not always true ) .",
    "since the ordering of generators refines the ordering by degree , a vertex ( degree 1 ) comes before an edge ( degree 2 ) , so the lyndon factorization of @xmath177 is        so @xmath506 is defined to be        the first lyndon factor of @xmath177 has standard factorization        so        the eulerian idempotent map fixes the single vertex , and        thus substituting into the previous equation gives        since        returning to the first expression for @xmath506 gives the following eigenvector of eigenvalue @xmath513        [ gefnex ]    by patras @xcite , the eulerian idempotent map is a projection onto the @xmath59-eigenspace of @xmath174 , so , for each generator @xmath317 , @xmath514 is an eigenvector of eigenvalue @xmath59 .",
    "as @xmath483 is commutative , @xmath488 is an algebra homomorphism , so the product of two eigenvectors is another eigenvector with the product eigenvalue .",
    "hence @xmath515 is an eigenvector of eigenvalue @xmath489 .    to see triangularity , note",
    "that , by proposition  [ ec ] , @xmath516 lemma  [ acyclicproduct ] shows that @xmath517 in each summand , and the condition @xmath518 for some @xmath35 means precisely that @xmath519 . also ,",
    "by proposition  [ ec ] , @xmath520 and thus @xmath521 as length is multiplicative .",
    "the multiplicity of the eigenvalue @xmath507 is the number of basis elements @xmath177 with length @xmath49 .",
    "the last assertion of the theorem is then immediate from ( * ? ? ?",
    "3.14.1 ) .",
    "we show that @xmath522 , where the higher eulerian idempotents are defined by @xmath523}(e \\otimes e \\otimes \\cdots \\otimes e ) \\delta^{[i]}.\\ ] ] by patras @xcite , @xmath474 is a projection to the @xmath524-eigenspace of @xmath174 , so , given the triangularity condition of the eigenbasis @xmath525 , it suffices to show that @xmath177 is the only term of length @xmath233 in @xmath526 .",
    "note that @xmath526 is a sum of terms of the form @xmath527 for some @xmath528 with @xmath529 a summand of @xmath530}(b)$ ] .",
    "as @xmath471 on @xmath531 , the @xmath532s must be non - trivial . hence each term @xmath375 of @xmath526 has the form @xmath533 , with @xmath534 and @xmath535 .",
    "it follows from lemma  [ acyclicproduct ] that @xmath536 , so @xmath476 by transitivity , which , by lemma  [ acyclicity ] means @xmath537 unless @xmath538 .",
    "it remains to show that the coefficient of @xmath177 in @xmath526 is 1 .",
    "let @xmath539 be the factorization of @xmath177 into generators .",
    "with notation from the previous paragraph , taking @xmath538 results in @xmath540 , so @xmath541 .",
    "this forces the @xmath542 for some @xmath543 .",
    "as @xmath528 occurs with coefficient 1 in @xmath544 , the coefficient of @xmath545 in @xmath546}(b)$ ] is the coefficient of @xmath547 in @xmath530}(b)=\\delta^{[l]}(c_1 ) \\dots \\delta^{[l]}(c_l)$ ] , which is 1 for each @xmath543 .",
    "each occurence of @xmath547 in @xmath546}(b)$ ] gives rise to a @xmath177 term in @xmath548}(e \\otimes e \\otimes \\cdots \\otimes e ) \\delta^{[l]}(b)$ ] with the same coefficient , for each @xmath543 , hence @xmath177 has coefficient @xmath549 in @xmath548}(e \\otimes e \\otimes \\cdots \\otimes e ) \\delta^{[l]}(b)=l!e_l(b)$ ] .",
    "the same argument also shows that , if @xmath550 , then @xmath551 , as there is no term of length @xmath35 in @xmath552 .",
    "in particular , @xmath553 if @xmath177 is not a generator .",
    "[ highereulerianidempotent ]    schmitt ( * ? ? ?",
    "*  thm 9.4 ) shows that the eulerian idempotent map @xmath473 projects a graded cocommutative algebra onto its subspace of primitive elements , so @xmath499 is primitive .",
    "a straightforward calculation shows that , if @xmath554 are primitive , then so is @xmath191 $ ] .",
    "iterating this implies that , if @xmath177 is a lyndon word , then @xmath506 ( which is the standard bracketing of @xmath480s ) is primitive .",
    "now apply the symmetrization lemma ( lemma  [ symlemma ] ) to deduce that , if @xmath555 has @xmath100 lyndon factors , @xmath506 is an eigenvector of eigenvalue @xmath457 .    to see triangularity , first recall that @xmath556 is a linear combination of the permutations of its arguments ,",
    "hence @xmath506 is a linear combination of products of the form @xmath557 for some @xmath543 .",
    "hence , by proposition  [ ec ] , each term in @xmath506 has the form @xmath558 with @xmath559 , and by lemma  [ acyclicproduct ] , we have @xmath560 . also , by proposition  [ ec ] , @xmath561 and all terms of the sum has length greater than @xmath49 , as length is multiplicative , and @xmath556 is a linear combination of the permutations of its arguments .    the multiplicity of the eigenvalue @xmath457 is the number of basis elements with @xmath100 lyndon factors .",
    "the last assertion of the theorem is then immediate from ( * ? ? ?",
    "3.14.1 ) .      to obtain the right eigenvectors for our markov chains ,",
    "consider the graded dual @xmath562 of the algebras examined above .",
    "the multiplication @xmath563 and comultiplication @xmath564 on @xmath562 are given by : @xmath565 for any @xmath566 , @xmath567 .",
    "then @xmath568}m^{*[a]}$ ] is the dual map to @xmath174 .",
    "so , if @xmath254 , defined by @xmath454 , is a transition matrix , then its right eigenvectors are the eigenvectors of @xmath569 .",
    "the theorems below express these eigenvectors in terms of @xmath570 , the dual basis to @xmath224 . dualizing a commutative hopf algebra creates a cocommutative hopf algebra , and vice versa , so theorem  [ fefnthm1 ] below , which diagonalizes @xmath571 on a polynomial algebra , will share features with theorem  [ gefnthm2 ] , which diagonalizes @xmath174 on a cocommutative free associative algebra . similarly , theorem  [ fefnthm2 ] and theorem  [ gefnthm1 ] will involve common ideas .",
    "however , theorems  [ fefnthm1 ] and  [ fefnthm2 ] are not direct applications of theorems  [ gefnthm2 ] and  [ gefnthm1 ] to @xmath572 as @xmath562 is not a polynomial or free associative algebra - a breaking and recombining chain with a deterministic recombination does not dualize to one with a deterministic recombination .",
    "for example , the recombination step is deterministic for inverse shuffling ( place the left pile on top of the right pile ) , but not for forward riffle shuffling ( shuffle the two piles together ) .",
    "the two theorems below give the eigenvectors of @xmath571 ; exemplar computations are in [ sec42 ] .",
    "theorem  [ fefnthm1 ] gives a complete description of these for @xmath0 a polynomial algebra , and theorem  [ fefnthm2 ] yields a partial description for @xmath0 a cocommutative free associative algebra . to correctly normalize the eigenvectors requires one more definition : let @xmath573 be the number of factors of @xmath177 that are equal to @xmath317 ( for @xmath496 , @xmath317 a generator ) .",
    "for example , @xmath574 .",
    "let @xmath483 be a hopf algebra ( over a field of characteristic zero ) that is a polynomial algebra as an algebra , with monomial basis @xmath484 .",
    "for @xmath247 with factorization into generators @xmath485 , set @xmath575 then @xmath576 is an eigenvector of @xmath571 of eigenvalue @xmath489 , and @xmath577 is the sum ( over @xmath578 ) of the coefficients of @xmath579 in @xmath530}(b')$ ] , multiplied by @xmath580 .",
    "@xmath581 satisfies the triangularity condition @xmath582 furthermore , @xmath583 is the dual basis to @xmath584 . in other words , @xmath585 if @xmath392 , and @xmath586 . yet another formulation :",
    "the matrix with @xmath576 as its columns is the inverse of the matrix with @xmath487 as its rows .",
    "[ fefnthm1 ]    1 .   if @xmath483 is also cocommutative , then it is unnecessary to symmetrize - just define @xmath587 .",
    "if @xmath174 defines a markov chain on @xmath230 , then the theorem says @xmath588 may be interpreted as the number of ways to break @xmath375 into @xmath49 pieces so that the result is some permutation of the @xmath49 generators that are factors of @xmath177 .",
    "in particular , @xmath581 takes only non - negative values , and @xmath581 is non - zero only on states which can reach @xmath177 . thus @xmath581 may be used to estimate the probability of being in states that can reach @xmath177 , see corollary  [ cor44 ] for an example .",
    "let @xmath483 be a cocommutative hopf algebra ( over a field of characteristic zero ) which is a free associative algebra as an algebra , with word basis @xmath224 .",
    "for each lyndon word @xmath177 , let @xmath581 be the eigenvector of @xmath571 of eigenvalue @xmath59 such that @xmath586 and @xmath589 for all other lyndon @xmath375 .",
    "in particular , @xmath590 and is primitive . for each basis element @xmath177 with lyndon factorization @xmath591 , let @xmath592 then @xmath581 is an eigenvector of @xmath571 of eigenvalue @xmath503 , and @xmath583 is the dual basis to @xmath584 . if @xmath593 with @xmath594 in the ordering of generators , then @xmath577 is the coefficient of @xmath595 in @xmath530}(b')$ ] , multiplied by @xmath596 .",
    "[ fefnthm2 ]    suppose @xmath597 is a term in @xmath598 , where @xmath317 is a generator .",
    "this means @xmath599 is non - zero . since comultiplication in @xmath572 is dual to multiplication in @xmath483 , @xmath600 , which is only nonzero if @xmath601 is a ( real number ) multiple of @xmath317 .",
    "since @xmath317 is a generator , this can only happen if one of @xmath602 is @xmath317 .",
    "hence @xmath603 is primitive .",
    "apply the symmetrization lemma ( lemma  [ symlemma ] ) to the primitives @xmath604 to deduce that @xmath581 as defined above is an eigenvector of eigenvalue @xmath507 .",
    "since multiplication in @xmath572 is dual to the coproduct in @xmath483 , @xmath605}(b')\\right)$ ] , from which the formula for @xmath588 is immediate .",
    "it is apparent from the formula that @xmath606 appears in @xmath581 only if @xmath607 appears in @xmath608 , hence @xmath476 is necessary .",
    "@xmath609 is the sum over @xmath610 of the coefficients of @xmath547 in @xmath530}(b)=\\delta^{[l]}(c_1 ) \\dots \\delta^{[l]}(c_l)$ ] .",
    "each term in @xmath530}(c_i)$ ] contributes at least one generator to at least one tensor - factor , and each tensor - factor of @xmath547 is a single generator , so each occurrence of @xmath547 is a product of terms from @xmath530}(c_i)$ ] where one tensor - factor is @xmath227 and all other tensor - factors are 1 .",
    "such products are all @xmath549 permutations of the @xmath227 in the tensor - factors , so , for each fixed @xmath611 , the coefficient of @xmath547 in @xmath530}(b)$ ] is @xmath612 .",
    "this proves the first equality in the triangularity statement .",
    "triangularity of @xmath581 with respect to length follows , as ordering by length refines the relation @xmath391 ( proposition  [ acyclicity ] ) .    to see duality , first note that , since @xmath571 is the linear algebra dual to @xmath174 , @xmath613 .",
    "now , using that @xmath576 and @xmath487 are eigenvectors , it follows that @xmath614 so @xmath585 if @xmath615 .",
    "now suppose @xmath616 .",
    "then @xmath617 which is 0 when @xmath392 , and @xmath166 when @xmath618 .",
    "@xmath572 is commutative , so the power map is an algebra homomorphism .",
    "then , since @xmath581 is defined as the product of @xmath100 eigenvectors each of eigenvalue @xmath59 , @xmath581 is an eigenvector of eigenvalue @xmath503 .    for any generator @xmath317 , @xmath603 is primitive by the same reasoning as in theorem  [ fefnthm1 ] , the case of a polynomial algebra . to check that @xmath619 and @xmath620 for all other lyndon @xmath177 , use the triangularity of @xmath506",
    ": @xmath621 each summand @xmath622 in the second term is 0 as @xmath623 . as @xmath497 consists of terms of length @xmath233",
    ", @xmath624 is 0 unless @xmath625 , in which case @xmath626 .",
    "hence @xmath627 is non - zero only if @xmath628 , and @xmath629 .",
    "turn now to duality .",
    "an analogous argument to the polynomial algebra case shows that @xmath630 only when they have the same eigenvalue , which happens precisely when @xmath177 and @xmath375 have the same number of lyndon factors .",
    "so let @xmath631 be the decreasing lyndon factorization of @xmath177 , @xmath632 be the decreasing lyndon factorzation of @xmath375 . to evaluate @xmath633",
    "observe that @xmath634}\\left(g_{b'_{\\sigma(1)}} ... g_{b'_{\\sigma(k)}}\\right)\\\\   & = & \\left(f_{b_{1}}\\otimes ... \\otimes f_{b_{k}}\\right)\\left(\\delta^{[k]}\\left(g_{b'_{\\sigma(1)}}\\right) ... \\delta^{[k]}\\left(g_{b'_{\\sigma(k)}}\\right)\\right).\\end{aligned}\\ ] ] as @xmath635 is primitive , each term in @xmath636}\\left(g_{b'_{\\sigma(i)}}\\right)$ ] has @xmath635 in one tensor - factor and @xmath166 in the @xmath637 others . hence the only terms of @xmath636}\\left(g_{b'_{\\sigma(1)}}\\right) ... \\delta^{[k]}\\left(g_{b'_{\\sigma(k)}}\\right)$ ] without @xmath166s in any tensor factors are those of the form @xmath638 for some @xmath639 . now",
    "@xmath640 for all @xmath35 , so @xmath641 annihilates any term with @xmath166 in some tensor - factor .",
    "hence @xmath642 as @xmath576 is dual to @xmath487 for lyndon @xmath177 , the only summands which contribute are when @xmath643 for all @xmath35 . in other words , this is zero unless the @xmath532 are some permutation of the @xmath644 . but both sets are ordered decreasingly , so this can only happen if @xmath645 for all @xmath35 , hence @xmath618 . in that case , for each fixed @xmath418 , the number of @xmath646 with @xmath647 for all @xmath35 is precisely @xmath612 , so @xmath648 .",
    "the final statement is proved in the same way as in theorem  [ fefnthm1 ] , for a polynomial algebra , since , when @xmath593 with @xmath594 in the ordering of generators , @xmath649 .",
    "this section returns to probabilistic considerations , showing how the left eigenvectors of [ sec33 ] determine the stationary distribution of the associated markov chain . in the absorbing case , `` generalized chromatic polynomials '' , based on the universality theorem in @xcite , determine rates of absorption .",
    "again , these general theorems are illustrated in the three sections that follow .",
    "the first proposition identifies all the absorbing states when @xmath0 is a polynomial algebra :    suppose @xmath0 is a polynomial algebra where @xmath254 , defined by @xmath454 , is a markov kernel .",
    "then the absorbing states are the basis elements @xmath650 which are products of @xmath21 ( possibly repeated ) degree one elements , and these give a basis of the 1-eigenspace of @xmath254 . [ absorbing ]    in the commutative hopf algebra of graphs in examples  [ ex21 ] and [ ex31 ] , there is a unique basis element of degree 1 - the graph with a single vertex .",
    "hence the product of @xmath21 such , which is the empty graph , is the unique absorbing state .",
    "similarly for the rock - breaking example ( symmetric functions ) on partitions of @xmath21 , the only basis element of degree 1 is @xmath651 and the stationary distribution is absorbing at @xmath24 ( or @xmath652 ) .",
    "[ ex34 ]    the parallel result for a cocommutative free associative algebra picks out the stationary distributions :    suppose @xmath0 is a cocommutative and free associative algebra where @xmath254 , defined by @xmath454 , is a markov kernel",
    ". then , for each unordered @xmath21-tuple @xmath653 of degree 1 elements ( some @xmath227s may be identical ) , the uniform distribution on @xmath654 is a stationary distribution for the associated chain . in particular , all absorbing states have the form @xmath655 , where @xmath656 has degree 1 . [ stationary ]    in the free associative algebra @xmath657 , each @xmath18 is a degree 1 element .",
    "so the uniform distribution on @xmath658 @xmath659 is a stationary distribution , as evident from considering inverse shuffles .",
    "[ ex35 ]    from theorem  [ gefnthm1 ] , a basis for the 1-eigenspace is @xmath660 .",
    "this forces each factor of @xmath177 to have degree 1 , so @xmath661 and @xmath662 .",
    "now @xmath663}\\bar{\\delta}^{[a]}(c)$ ] , and , when @xmath664 , @xmath136}\\bar{\\delta}^{[a]}(c)=0 $ ] for all @xmath665 .",
    "so @xmath666 , and hence @xmath667 , which is a point mass on @xmath177 , so @xmath661 is an absorbing state .    from theorem  [ gefnthm2 ] , a basis for",
    "the 1-eigenspace is @xmath668 has @xmath21 lyndon factors@xmath669 .",
    "this forces each lyndon factor of @xmath177 to have degree 1 , so each of these must in fact be a single letter of degree 1 . thus @xmath661 and @xmath670 , as @xmath671 for a generator @xmath317 .",
    "an absorbing state is a stationary distribution which is a point mass .",
    "this requires @xmath672 to be independent of @xmath611 .",
    "as @xmath0 is a free associative algebra , this only holds when @xmath673 , in which case @xmath674 , so @xmath675 is an absorbing state .",
    "consider the case where there is a single basis element @xmath656 of degree 1 .",
    "then , by proposition  [ absorbing ] and proposition  [ stationary ] , the @xmath254 chain has a unique absorbing basis vector @xmath676 .",
    "the chance of absorption after @xmath100 steps can be calculated using an analog of the chromatic polynomial .",
    "note first that the property @xmath677 implies it is enough to calculate @xmath678 for general @xmath59 and starting state @xmath679 . to do this ,",
    "make @xmath0 into a combinatorial hopf algebra in the sense of @xcite by defining a character @xmath680 that takes value 1 on @xmath656 and value 0 on all other generators , and extend multiplicatively and linearly .",
    "in other words , @xmath680 is an indicator function of absorption , taking value 1 on all absorbing states and 0 on all other states . by ( * ? ? ? * th .",
    "4.1 ) there is a unique character - preserving hopf algebra map from @xmath0 to the algebra of quasisymmetric functions .",
    "define @xmath681 to be the quasisymmetric function that is the image of the basis element @xmath177 under this map .",
    "( if @xmath0 is cocommutative , @xmath681 will be a symmetric function . )",
    "call this the _ generalized chromatic polynomial _ of @xmath177 since it is the stanley chromatic polynomial for the hopf algebra of graphs @xcite .    with notation as above",
    ", the probability of being absorbed in one step of @xmath254 starting from @xmath177 ( that is , @xmath678 ) equals @xmath682 [ prop32 ]    by definition of @xmath254 , the desired probability @xmath683 is @xmath329 times the coefficient of @xmath655 in @xmath251 .",
    "every occurrence of @xmath684 in @xmath685}\\delta^{[a]}(b)$ ] must be due to a term of the form @xmath686 in @xmath142}(b)$ ] , for some composition @xmath687 of @xmath21 ( some @xmath688 may be 0 ) .",
    "so , in the notation of the proof of theorem  [ thm31 ] , @xmath689 where the sum runs over all @xmath690 with @xmath59 parts .",
    "the coefficient of the monomial @xmath691 in @xmath681 is defined to be the image of @xmath177 under the composite @xmath692}}{\\mathcal{h}}^{\\otimes a}\\xrightarrow{\\pi_{\\alpha_{1}}\\otimes \\dots \\otimes\\pi_{\\alpha_{a}}}{\\mathcal{h}}_{\\alpha_{1}}\\otimes\\dots \\otimes{\\mathcal{h}}_{\\alpha_{a}}\\xrightarrow{\\zeta^{a}}\\mathbb{r}\\ ] ] where , in the middle map , @xmath693 denotes the projection to the subspace of degree @xmath688 .",
    "as @xmath680 takes value 1 on powers of @xmath656 and 0 on other basis elements , it transpires that @xmath694 summing over all compositions of @xmath21 regardless of their number of parts .",
    "hence @xmath695 with the first @xmath59 arguments non - zero .",
    "using a different character @xmath680 , this same argument gives the probability of reaching certain sets of states in one step of the @xmath696 chain .",
    "this does not require @xmath0 to have a single basis element of degree 1 .",
    "let @xmath697 be a subset of generators , and @xmath698 be the character taking value 1 on @xmath697 and value 0 on all other generators ( extended linearly and multiplicatively ) .",
    "let @xmath699 be the image of @xmath177 under the unique character - preserving hopf map from @xmath0 to the algebra of quasisymmetric functions .",
    "then the probability of being at a state which is a product of elements in @xmath697 , after one step of the @xmath254 chain , starting from @xmath177 , is @xmath700    recall the rock - breaking chain of example  [ ex32 ] .",
    "let @xmath701 .",
    "then @xmath702 measures the probability that a rock of size @xmath21 becomes rocks of size 1 or 2 , after @xmath100 binomial breaks .",
    "this section studies the markov chain induced by the hopf algebra of symmetric functions .",
    "[ sec41 ] presents it as a rock - breaking process with background and references from the applied probability literature .",
    "[ sec42 ] gives formulae for the right eigenfunctions by specializing from theorem  [ fefnthm1 ] and uses these to bound absorption time and related probabilistic observables .",
    "[ sec43 ] gives formulae for the left eigenfunctions by specializing from theorem  [ gefnthm1 ] and uses these to derive quasi - stationary distributions .",
    "as in examples  [ ex12 ] and [ ex32 ] , the markov chain corresponding to the hopf algebra of symmetric functions may be described as a rock - breaking process on partitions of @xmath21 : at each step , break each part independently with a symmetric binomial distribution .",
    "the chain is absorbed when each part is of size one .",
    "let @xmath703 be the transition matrix or chance of moving from @xmath220 to @xmath447 in one step for @xmath704 partitions of @xmath21 . for @xmath705 , these matrices are : @xmath706 the @xmath59th power map @xmath174 yields rock - breaking into @xmath59 pieces each time , according to a symmetric multinomial distribution . to simplify things , we focus on @xmath458 .",
    "the mathematical study of rock - breaking was developed by kolmogoroff @xcite who proved a log normal limit for the distribution of pieces of size at most @xmath63 . a literature review and",
    "classical applied probability treatment in the language of branching processes is in @xcite .",
    "they allow more general distributions for the size of pieces in each break .",
    "a modern manifestation with links to many areas of probability is the study of fragmentation processes .",
    "extensive mathematical development and good pointers to a large physics and engineering literature are in @xcite .",
    "most of the probabilistic development is in continuous time and has pieces breaking one at a time .",
    "we have not seen previous study of the natural model of simultaneous breaking developed here .",
    "the rock - breaking markov chain has the following alternative `` balls in boxes '' description :    the distribution on partitions of @xmath21 induced by taking @xmath100 steps of the chain @xmath707 starting at the one - part partition @xmath47 is the same as the measure induced by dropping @xmath21 balls into @xmath15 boxes ( uniform multinomial allocation ) and considering the partition induced by the box counts in the non - empty cells . for @xmath220 a partition of @xmath21 , written as @xmath708 with @xmath709 , set @xmath710 .",
    "( here , @xmath711 is the number of empty cells . ) then , for any partition @xmath447 @xmath712 [ prop41 ]    because of proposition  [ prop41 ] , many natural functions of the chain can be understood , as functions of @xmath100 and @xmath21 , from known properties of multinomial allocation .",
    "this includes the distribution of the size of the largest and smallest piece , the joint distribution of the number of pieces of size @xmath35 , and total number of pieces .",
    "see @xcite .",
    "observe from the matrices for @xmath705 that , if the partitions are written in reverse - lexicographic order , the transition matrices are lower - triangular .",
    "this is because lexicographic order refines the ordering of partitions by refinement .",
    "furthermore , the diagonal entries are the eigenvalues @xmath713 , as predicted in proposition  [ acyclicity ] . specializing the counting formula in theorem  [ gefnthm1 ] to this case",
    "proves the following proposition .    the rock - breaking chain @xmath703 on partitions of size @xmath21 has eigenvalues @xmath46 , with @xmath713 having multiplicity @xmath714 , the number of partitions of @xmath21 into @xmath35 parts .",
    "[ prop42 ]      because the operator @xmath703 is not self - adjoint in any reasonable sense , the left and right eigenfunctions must be developed distinctly . the following description , a specialization of theorem  [ fefnthm1 ] , may be supplemented by the examples and corollaries that follow .",
    "a proof is at the end of this subsection .",
    "let @xmath715 be partitions of @xmath21 .",
    "let @xmath306 denote the number of parts of size @xmath35 in @xmath220 and @xmath716 the total number of parts .",
    "then the @xmath447th right eigenfunction for @xmath707 , evaluated at @xmath220 , is @xmath717 where the sum is over all sets @xmath718 such that @xmath719 is a partition of @xmath720 and the disjoint union @xmath721 .",
    "the corresponding eigenvalue is @xmath722 .",
    "@xmath723 is always non - negative , and is non - zero if and only if @xmath447 is a refinement of @xmath220 . if @xmath724 is any set partition with underlying partition @xmath220 , then @xmath723 is the number of refinements of @xmath724 with underlying partition @xmath447 .",
    "[ prop43 ]    here is an illustration of how to compute with this formula :    for @xmath725 , @xmath726 , the possible @xmath718 are @xmath727 then @xmath728 [ ex42 ]    for @xmath705 , the right eigenfunctions @xmath729 are the columns of the matrices : @xmath730 [ ex41 ]    for some @xmath731 pairs , the formula for @xmath732 simplifies .    when @xmath733 , @xmath734 [ ex43 ]    @xmath735 has eigenvalue 1 .    as @xmath47 is not a refinement of any other partition",
    ", @xmath736 is non - zero only at @xmath47 .",
    "hence @xmath737 .    when @xmath738 , @xmath739 with eigenvalue @xmath740",
    ". thus @xmath741 with eigenvalue @xmath742 is the unique second - largest eigenfunction .",
    "[ ex44 ]    example  [ ex44 ] can be applied to give bounds on the chance of absorption .",
    "the following corollary shows that absorption is likely after @xmath56 steps .    for the rock - breaking chain @xmath53 , @xmath743 [ cor44 ]    by example  [ ex44 ] ,",
    "if @xmath744 , @xmath745 is an eigenfunction with eigenvalue 1/2 .",
    "further , @xmath746 is zero if and only if @xmath52 . as an eigenfunction @xmath747       1 .   from proposition  [ prop41 ] and the classical birthday problem ,",
    "@xmath748 it follows that , for @xmath56 ( or @xmath749 ) the inequality in the corollary is essentially an equality .",
    "essentially the same calculations go through for any starting state @xmath220 using @xmath750 3 .",
    "other eigenfunctions can be similarly used .",
    "for example , when @xmath751 , @xmath752 if and only if @xmath753 .",
    "it follows as above that @xmath754 4 .",
    "the right eigenfunctions with @xmath751 can be derived by a direct probabilistic argument .",
    "drop @xmath21 balls into @xmath15 boxes .",
    "let @xmath755 be the number of balls in box @xmath35 .",
    "then @xmath756 the last equality follows because @xmath757 is binomial @xmath758 and , if @xmath759 is binomial ( n , p)@xmath760 . the other eigenvectors can be derived using more complicated multinomial moments .    for concreteness , take @xmath761 and @xmath762",
    ". then theorem  [ fefnthm1 ] states that @xmath723 is the coefficient of @xmath763 in @xmath141}(\\lambda)$ ] ( viewing @xmath764 as a partition of single part ) , divided by @xmath765 .",
    "recall that @xmath766}(\\lambda)=\\delta^{[3]}\\left(\\lambda_1 \\right ) \\delta^{[3]}\\left(\\lambda_2 \\right)= \\sum_{\\substack{i_{1}+j_{1}+k_{1}=\\lambda_{1 } \\\\",
    "i_{2}+j_{2}+k_{2}=\\lambda_{2}}}\\binom{\\lambda_{1}}{i_{1}j_{1}k_{1}}\\binom{\\lambda_{2}}{i_{2}j_{2}k_{2}}i_{1}\\amalg i_{2}\\otimes j_{1}\\amalg j_{2}\\otimes k_{1}\\amalg k_{2}.\\ ] ] so calculating @xmath723 requires summing the coefficients of the terms where @xmath767 . as @xmath768 only has one part , it must be the case that either @xmath769 and @xmath770 , or @xmath771 and @xmath772 , and similarly for @xmath773 .",
    "thus , removing the parts of size 0 from @xmath774 and reordering gives @xmath447 .",
    "so @xmath775 .",
    "also , if @xmath776 denotes the partition obtained by removing 0s and reordering @xmath777 , and @xmath778 from @xmath779 , then the disjoint union @xmath780 .",
    "given @xmath781 and @xmath778 , the number of different sextuples @xmath774 it could have come from is @xmath782 hence @xmath783 which simplifies as desired .",
    "it is then an easy exercise to check that this is the number of refinements of the set partition @xmath724 of underlying partition @xmath447 .",
    "this subsection gives two descriptions of the left eigenfunctions : one in parallel with proposition  [ prop43 ] and the other using symmetric function theory .",
    "again , examples follow the statement with proofs at the end .    for the rock - breaking markov chain @xmath707 on partitions of @xmath21 , for each partition @xmath220 of @xmath21 , there is a left eigenfunction @xmath784 with eigenvalue @xmath785 , @xmath786 where the sum is over sets @xmath718 such that @xmath719 is a partition of @xmath720 and @xmath787 .",
    "@xmath784 is non - zero only if @xmath447 is a refinement of @xmath220 .",
    "[ prop45 ]    as previously , here is a calculational example .    when @xmath726 , @xmath788 [ ex46 ]    for @xmath705 , the left eigenfunctions @xmath789 are the rows of the matrices : @xmath790    observe that these matrices are the inverses of those in example  [ ex41 ] , as claimed in theorem  [ fefnthm1 ] .",
    "[ ex45 ]    the next three examples give some partitions @xmath220 for which the expression for @xmath791 condenses greatly :    if @xmath733 then @xmath792 is primitive and @xmath793 with eigenvalue @xmath794 .",
    "[ ex47 ]    if @xmath795 , @xmath789 has eigenvalue @xmath740 and @xmath796 if @xmath797 , and 0 otherwise . in particular , @xmath798 puts equal mass at @xmath799 and @xmath744 with mass 0 for other @xmath447 .",
    "[ ex48a ]    take @xmath52 . as no other partition refines @xmath220 , @xmath800 , and this is the stationary distribution .",
    "[ ex48b ]    the left eigenfunctions can be used to determine the quasi - stationary distributions @xmath801 described in [ sec21 ] .",
    "for the rock - breaking markov chain @xmath707 on partitions of @xmath21 , @xmath802 [ cor46 ]    from , @xmath803 is proportional to @xmath798 on the non - absorbing states . the perron ",
    "frobenious theorem ensures that @xmath803 is non - negative . from examples",
    "[ ex48a ] and [ ex48b ] , @xmath804 for @xmath805 .",
    "similarly , @xmath806 is proportional to @xmath807 for @xmath805 .    from @xcite , the power sum symmetric functions @xmath808 are the primitive elements of the ring of symmetric functions and their products @xmath216 give the left eigenfunctions of the hopf - power chains .",
    "up to scaling , @xmath808 is the only primitive element of degree @xmath21 , so @xmath808 must be a scalar multiple of @xmath792 . by theorem  [ gefnthm1 ] ,",
    "@xmath792 is normalized so that the coefficient of @xmath809 is 1 ( recall @xmath810 ) , whilst the determinant formula @xcite : @xmath811 shows that @xmath31 has coefficient @xmath812 in @xmath808 .",
    "comparing these show @xmath813 , so the left eigenfunctions @xmath789 are @xmath814 expressed in the @xmath815 basis .",
    "hence proposition  [ prop43 ] and proposition  [ prop45 ] may be rephrased as follows , respectively : @xmath816 @xmath817    for example , for @xmath818 , and @xmath819 corresponding to the left eigenvector @xmath820 with eigenvalue 1 . for @xmath821 , @xmath822 , so @xmath823 corresponding to the eigenvector @xmath824 with eigenvalue 1/2 . for @xmath825 , @xmath826 .",
    "multiplying by 2 gives the left eigenvector @xmath827 with eigenvalue 1/4 .",
    "@xmath784 is the coefficient of @xmath447 in @xmath828 .",
    "every occurence of @xmath447 in @xmath829 is a product of a @xmath781 term in @xmath830 , a @xmath778 term in @xmath831 , etc .",
    ", for some choice of partitions @xmath719 of @xmath720 with @xmath721 .",
    "hence it suffices to show that the coefficient of a fixed @xmath719 in @xmath832 is @xmath833 recall that @xmath834}{\\bar\\delta}^{[a]}(\\lambda_j)$ ] , and observe that all terms of @xmath136}{\\bar\\delta}^{[a]}(\\lambda_j)$ ] are partitions with @xmath59 parts .",
    "hence @xmath719 only occurs in the summand with @xmath835 .",
    "so the number needed is @xmath836 multiplied by the coefficient of @xmath719 in @xmath136}{\\bar\\delta}^{[a]}(\\lambda_j)$ ] .",
    "each occurrence of @xmath719 in @xmath136}{\\bar\\delta}^{[a ] } \\left(\\lambda_j\\right)$ ] is caused by @xmath837 in @xmath423 } \\left(\\lambda_j\\right)$ ] for some @xmath838 .",
    "for each fixed @xmath611 , @xmath837 has coefficient @xmath839 in @xmath423 } \\left(\\lambda_j\\right)$ ] , and the number of @xmath838 leading to distinct @xmath59-tuples @xmath840 is @xmath841 .",
    "hence the coefficient of @xmath719 in @xmath136}{\\bar\\delta}^{[a]}\\left(\\lambda_j\\right)$ ] is @xmath842 as desired .",
    "this calculation is greatly simplified for the algebra of symmetric functions , compared to other polynomial algebras .",
    "the reason is that , for a generator @xmath317 , it is in general false that all terms of @xmath136}{\\bar\\delta}^{[a]}(c)$ ] have length @xmath59 , or equivalently that all tensor - factors of a term of @xmath423}(c)$ ] are generators .",
    "see the fourth summand of the coproduct calculation in example  [ exncgraphs ] for an example .",
    "then terms of length say , three , in @xmath480 may show up in both @xmath843}{\\bar\\delta}^{[2]}(c)$ ] and @xmath844}{\\bar\\delta}^{[3]}(c)$ ] , so determining the coefficient of this length three term in @xmath480 is much harder , due to these potential cancellations in @xmath480 .",
    "hence much effort @xcite has gone into developing cancellation - free expressions for primitives , as alternatives to @xmath480 .",
    "this section works through the details for the hopf algebra @xmath845 and riffle shuffling ( examples  [ ex11 ] and [ ex13 ] ) .",
    "[ sec51 ] gives background on shuffling , [ sec52 ] develops the hopf connection , [ sec53 ] gives various descriptions of right eigenfunctions .",
    "these are specialized to decks with distinct cards in [ sec54 ] which shows that the number of descents@xmath846 and the number of peaks@xmath847 are eigenfunctions .",
    "the last section treats decks with general composition showing that all eigenvalues @xmath713 , @xmath848 , occur as long as there are at least two types of cards .",
    "inverse riffle shuffling is a special case of walks on the chambers of a hyperplane arrangement and of random walks on a left regular band . @xcite and",
    "@xcite give a description of left eigenfunctions ( hence right eigenfunctions for forward shuffling ) in this generality .",
    "reeds introduced a realistic model for riffle shuffling a deck of @xmath21 cards .",
    "it may be described in terms of a parameterized family of probability measures @xmath849 for @xmath611 in the symmetric group @xmath34 and @xmath850 a parameter .",
    "a physical description of the @xmath59-shuffle begins by cutting a deck of @xmath21 cards into @xmath59 piles according to the symmetric multinomial distribution , so the probability of pile @xmath35 receiving @xmath851 cards is @xmath852 .",
    "then , the piles are riffled together by ( sequentially ) dropping the next card from pile @xmath35 with probability proportional to pile size ; continuing until all cards have been dropped .",
    "usual riffle shuffles are 2-shuffles and @xcite show that @xmath853 .",
    "thus to study @xmath854 it is enough to understand @xmath849 .",
    "they also found the closed formula @xmath855 using this they proved that @xmath856 2-shuffles are necessary and suffice to mix @xmath21 cards .",
    "the study of @xmath849 has contacts with other areas of mathematics : to solomon s descent algebra @xcite , quasisymmetric functions @xcite , hyperplane arrangements @xcite , lie theory @xcite , and , as the present paper shows , hopf algebras .",
    "a survey of this and other connections is in @xcite with @xcite bringing this up to date .",
    "a good elementary textbook treatment is in @xcite .    of course",
    ", shuffling can be treated as a markov chain on @xmath34 with transition matrix @xmath857 , the chance of moving from @xmath611 to @xmath81 after one @xmath59-shuffle . to check later calculations , when @xmath858 , the transition matrix is @xmath859 times @xmath860    it is also of interest to study decks with repeated cards .",
    "for example , if suits do nt matter , the deck may be regarded as having values @xmath861 with value @xmath35 repeated four times .",
    "now , mixing requires fewer shuffles ; see @xcite for details .",
    "the present hopf analysis works here , too .",
    "let @xmath862 be the free associative algebra on @xmath863 generators , with each @xmath18 primitive .",
    "as explained in examples  [ ex11 ] and [ ex13 ] , the map @xmath864 is exactly inverse @xmath59-shuffling .",
    "observe that the number of cards having each value is unchanged during shuffling .",
    "this naturally leads to the following finer grading on the free associative algebra : for each @xmath865 , define @xmath866 to be the subspace spanned by words where @xmath18 appears @xmath867 times .",
    "the @xmath59th power map @xmath172}\\delta^{[a]}:{\\mathcal{h}}\\to{\\mathcal{h}}$ ] preserves this finer grading .",
    "the subspace @xmath868 is spanned by words of degree 1 in each variable .",
    "a basis is @xmath869 .",
    "the mapping @xmath174 preserves @xmath870 and @xmath871 . with obvious modification the same result holds for any subspace @xmath866 .",
    "working on the dual space @xmath562 gives the usual gilbert  shannon ",
    "reeds riffle shuffles .",
    "let us record this formally ; say that a deck has _",
    "@xmath448 if there are @xmath867 cards of value @xmath35 .    let @xmath872 be a composition of @xmath21 . for any @xmath873 , the mapping @xmath874 preserves @xmath875 and the matrix of this map in the monomial basis is the transpose of the transition matrix for the inverse @xmath59-shuffling markov chain for a deck of composition @xmath448 . the dual",
    "mapping is the gilbert ",
    "reeds measure on decks with this composition .",
    "[ prop51 ]    since the cards behave equally independent of their labels , any particular deck of interest can be relabeled so that @xmath876 . in other words",
    ", it suffices to work with @xmath875 for partitions @xmath448 .",
    "theorem  [ gefnthm2 ] applied to the free associative algebra gives a basis of left eigenfunctions for inverse shuffles , which are right eigenfunctions for the forward gsr riffle shuffles . by remark 2 after theorem  [ gefnthm2 ] , each word @xmath877 corresponds to a right eigenfunction @xmath878 for the gsr measure on decks with composition @xmath448 . as explained in example  [ ex13 ] and [ sec23 ] ,",
    "these are formed by factoring @xmath43 into lyndon words , standard bracketing each lyndon factor , then expanding and summing over the symmetrization .",
    "the eigenvalue is @xmath879 with @xmath100 the number of lyndon factors of @xmath43 .",
    "the following examples should help understanding .    for @xmath858 , with @xmath880",
    ", @xmath875 is 6-dimensional with basis @xmath881 .",
    "consider @xmath882 .",
    "this is a lyndon word so no symmetrization is needed .",
    "the standard bracketing @xmath883=[x_1,[x_2,x_3]]=x_1x_2x_3-x_1x_3x_2-x_2x_3x_1+x_3x_2x_1 $ ] . with the labeling of the transition matrix @xmath254 of",
    ", the associated eigenvector is @xmath884 with eigenvalue @xmath885 .    for @xmath886",
    "is three - dimensional with basis @xmath887 .",
    "consider @xmath888 .",
    "this factors into lyndon words as @xmath889 ; symmetrizing gives the eigenvector @xmath890 or @xmath891 with eigenvalue 1 .",
    "[ ex51 ]    the description of right eigenvectors can be made more explicit .",
    "this is carried foward in the following two sections .",
    "recall from [ sec23 ] that the values of an eigenfunction @xmath878 at @xmath208 can be calculated graphically from the decreasing lyndon hedgerow @xmath206 of @xmath43 .",
    "when @xmath43 has all letters distinct , this calculation simplifies neatly . to state this ,",
    "extend the definition of @xmath892 ( @xmath49 a lyndon word with distinct letters ) to words longer than @xmath49 , also with distinct letters : @xmath893 is @xmath892 evaluated on the subword of @xmath43 whose letters are those of @xmath49 , if such a subword exists , and @xmath894 otherwise .",
    "( here , a subword always consist of consecutive letters of the original word . ) because @xmath43 has distinct letters , there is at most one such subword .",
    "for example , @xmath895 .",
    "let @xmath43 be a word with distinct letters and lyndon factorization @xmath896 .",
    "then , for all @xmath208 with distinct letters and of the same length as @xmath43 , @xmath897 and @xmath878 takes only values 1,-1 and 0",
    ".    @xmath898 as calculated in [ sec23 ] .",
    "[ ex52 ]    recall from [ sec23 ] that @xmath899 is the signed number of ways to permute the branches and trees of @xmath206 to spell @xmath208 .",
    "when @xmath43 and @xmath208 each consist of distinct letters , such a permutation , if it exists , is unique .",
    "this gives the second assertion of the proposition .",
    "this permutation is precisely given by permuting the branches of each @xmath900 so they spell subwords of @xmath208 .",
    "the total number of branch permutations is the sum of the number of branch permutations of each @xmath900 .",
    "taking parity of this statement gives the first assertion of the proposition .",
    "the example above employed a further shortcut that is worth pointing out : the lyndon factors of a word with distinct letters start precisely at the _ record minima _ , since a word with distinct letters is lyndon if and only if its first letter is minimal .",
    "thus 35142 has minima @xmath901 in positions @xmath902 .",
    "this leads to    the multiplicity of the eigenvalue @xmath903 on @xmath904 is @xmath905 , the signless stirling number of the first kind .    by above observation",
    ", the multiplicity of the eigenvalue @xmath903 on @xmath906 is the number of permutations with @xmath100 record minima , which is also the number of permutations with @xmath100 cycles , by ( * ? ? ?",
    "1.3.1 ) .",
    "let @xmath907 denote the reverse of @xmath43 , then , for any @xmath611 , switching branches at every node shows that @xmath908 where the parity is @xmath909 # lyndon factors in @xmath611 .",
    "thus , each eigenspace of @xmath174 is invariant under the map @xmath910 . for example , @xmath911 when compared with example  [ ex52 ] above .",
    "the quantity ( @xmath909 # lyndon factors in @xmath912 ) is @xmath913 , hence the change in sign .",
    "[ ex53 ]    @xmath914 is the only word with @xmath21 lyndon factors , so @xmath915 spans the 1-eigenspace .",
    "[ ex54 ]    there are @xmath36 permutations @xmath611 which have @xmath916 lyndon factors .",
    "they may be realized by choosing @xmath40 and taking @xmath917 .",
    "then , all but @xmath918 are record minima and the corresponding eigenfunctions are ( in the notation at the start of this subsection ) , @xmath919 their sum is @xmath920 with @xmath921 the number of descents in @xmath43 .",
    "this is thus an eigenfunction with eigenvalue @xmath922 , as claimed in example  [ ex14 ] .",
    "this eigenfunction appears in the markov chain recording the number of descents in successive @xmath59-shuffles , which is the same as the markov chain of carries when @xmath21 numbers are added in base @xmath59 .",
    "the transition matrix of this markov chain is holte s @xcite `` amazing matrix . ''",
    "see @xcite .",
    "the theory developed there shows that , with @xmath923 the stirling numbers ( @xmath924 ) , @xmath925 is a right eigenfunction with eigenvalue @xmath926 , and the eigenfunction @xmath99 above is @xmath927 .",
    "[ ex55 ]    recall that a permutation @xmath43 has a _ peak _ at position @xmath928 , if @xmath929 , and a _ trough _ at position @xmath928 , if @xmath930 .",
    "call the remaining case a _ straight _ : @xmath931 or @xmath932 .",
    "the number of peaks and the peak set have been intensively investigated @xcite .",
    "the following development shows that # peaks@xmath933 is an eigenfunction with eigenvalue @xmath885 , as is # troughs@xmath933 .",
    "indeed , a basis of this eigenspace is @xmath934 where @xmath611 is obtained from @xmath935 by removing @xmath918 and inserting it after @xmath35 for @xmath40 , and then removing @xmath936 and inserting it further down also .",
    "then , all but @xmath937 are record minima .",
    "there are three places to insert @xmath100 ( in the examples , @xmath938 ) :    1 .",
    "after @xmath49 with @xmath939 ( e.g. , 42513 ) ; 2 .",
    "after @xmath918 , i.e. , @xmath940 ( e.g. , 42135 ) ; 3 .",
    "after @xmath35 , i.e. , @xmath941 ( e.g. , 42153 )",
    ".    then @xmath942 is , respectively    1 .   1 if @xmath943 and @xmath944 both occur as subwords of @xmath43 , or if @xmath945 and @xmath946 both occur ; @xmath209 if @xmath945 and @xmath944 both occur , or if @xmath943 and @xmath946 both occur ; 0 if @xmath35 is not adjacent to @xmath918 in @xmath43 or if @xmath100 is not adjacent to @xmath49 ( this is @xmath947 ) ; 2 .   1",
    "if @xmath948 or @xmath949 occur as subwords of @xmath43 ; @xmath209 if @xmath950 or @xmath951 occur ; 0 otherwise ( this is @xmath952 ) ; 3 .   1",
    "if @xmath950 or @xmath951 occur as subwords of @xmath43 ; @xmath209 if @xmath953 or @xmath954 occur ; 0 otherwise ( this is @xmath955 ) .",
    "[ ex56 ]    @xmath956 # peaks in @xmath957 , @xmath958 # troughs in @xmath957 and @xmath959 # straights in @xmath957 are right eigenfunctions with eigenvalue @xmath885 .",
    "[ prop53 ]    let @xmath960 denote the sum of all eigenfunctions of type @xmath35 , as defined in example  [ ex56 ] above .",
    "note that @xmath961 @xmath962 since each successive triple in @xmath43 either forms a straight , a peak or a trough , @xmath963 hence @xmath964 , @xmath965 , @xmath966 are all in the @xmath967-eigenspace .",
    "it may be possible to continue the analysis to patterns of longer length ; in particular , it will be interesting to see which linear combinations of patterns and constant functions give eigenfunctions .",
    "recall from proposition  [ prop51 ] that , for a composition @xmath968 of @xmath21 , the map @xmath874 describes inverse @xmath59-shuffling for a deck of composition @xmath448 , i.e. , a deck of @xmath21 cards where @xmath867 cards have value @xmath35 .",
    "theorem  [ gefnthm2 ] applies here to determine a full left eigenbasis ( i.e. , a right eigenbasis for forward shuffles ) .",
    "the special case of @xmath969 ( follow one labeled card ) is worked out in @xcite and used to bound the expected number of correct guesses in feedback experiments .",
    "his work shows that the same set of eigenvalues @xmath970 occur .",
    "this section shows that this is true for all deck compositions ( provided @xmath971 ) .",
    "it also determines a basis of eigenfunctions with eigenvalue @xmath922 and construct an eigenfunction which depends only on an appropriately defined number of descents , akin to example  [ ex55 ] .",
    "the following proposition finds one `` easy '' eigenfunction for each eigenvalue of @xmath972 .",
    "the examples that follow the proof show again that eigenfunctions can correspond to natural observables .",
    "fix a composition @xmath448 of @xmath21 .",
    "the dimension of the @xmath972-eigenspace for the @xmath59-shuffles of a deck of composition @xmath448 is bounded below by the number of lyndon words in the alphabet @xmath973 of length @xmath974 in which letter @xmath35 occurs at most @xmath867 times .",
    "in particular , @xmath975 does occur as an eigenvalue for each @xmath976 .",
    "[ prop54 ]    by remark 2 after theorem  [ gefnthm2 ] , the multiplicity of the @xmath972-eigenspace is the number of monomials in @xmath866 with @xmath977 lyndon factors .",
    "one way of constructing such monomials is to choose a lyndon word of length @xmath974 in which letter @xmath35 occurs at most @xmath867 times , and leave the remaining @xmath977 letters of @xmath448 as singleton lyndon factors .",
    "the monomial is then obtained by putting these factors in decreasing order .",
    "this shows the lower bound .    to see that @xmath975 is an eigenvalue for all @xmath100",
    ", it suffices to construct , for each @xmath100 , a lyndon word of length @xmath974 in which letter @xmath35 occurs at most @xmath867 times . for @xmath978 ,",
    "this may be achieved by placing the smallest @xmath974 values in increasing order . for @xmath979 , take the word with @xmath100 1s followed by a 2 .    for @xmath980 , the eight eigenfunctions constructed in the last step of the proof correspond to the words shown below in order @xmath981 .",
    "the bracketed term is the sole non - singleton lyndon factor : @xmath982 [ ex57 ]    for an @xmath21-card deck of composition @xmath448 , the second largest eigenvalue is @xmath922 .",
    "our choice of eigenvectors correspond to words with @xmath916 lyndon factors .",
    "each such word must have @xmath983 singleton lyndon factors and a lyndon factor of length 2 .",
    "hence the bound in proposition  [ prop54 ] is attained ; furthermore it can be explicitly calculated : the lyndon words of length 2 are precisely a lower value followed by a higher value , so the multiplicity of eigenvalue @xmath922 is @xmath984 .",
    "this does nt depend on @xmath448 , only on the number @xmath863 of distinct values .",
    "summing these eigenfunctions and arguing as in example  [ ex55 ] gives [ ex59 ]    for any @xmath21-card deck of composition @xmath448 , let @xmath985 be the number of strict ascents , descents in @xmath43 respectively . then @xmath986 is an eigenfunction of @xmath174 with eigenvalue @xmath922 .",
    "[ prop55 ]    fix two values @xmath40 .",
    "order the deck in decreasing order , then take a card of value @xmath918 and put it after the first card of value @xmath35 . in other words ,",
    "let @xmath943 be the only non - singleton lyndon factor . by inspection ,",
    "the corresponding eigenvector is ( up to scaling ) @xmath987 summing @xmath38 over @xmath988 shows that \\",
    "{ # ascents in @xmath43 } @xmath989 \\ { # descents in @xmath43 } is an eigenfunction with eigenvalue @xmath922 .    under the uniform distribution ,",
    "the expectation of @xmath986 is zero . if initially the deck is arranged in increasing order @xmath990 .",
    "if @xmath991 is the permutation after @xmath100 @xmath59-shuffles , the proposition gives @xmath992 .",
    "thus for @xmath993 shuffles suffice to make this expected value @xmath994 . on the other hand , consider a deck with @xmath21 cards labeled 1 and @xmath21 cards labeled 2 . if the initial order is @xmath995 and so @xmath996 for all @xmath100 .",
    "central limit theorems for the distribution of descents in permutations of multi - sets are developed in @xcite .",
    "specialize example  [ ex59 ] to @xmath997 , so there is one exceptional card of value 1 in a deck of otherwise identical cards of value 2 .",
    "then there is a unique eigenfunction @xmath998 of eigenvalue @xmath922 : @xmath999 [ ex58 ]",
    "this section contains a collection of examples where either the hopf - square map leads to a markov chain with a reasonable `` real world '' interpretation  markov chains on simplicial complexes and quantum groups  or the constructions do not work out to give markov chains  a quotient of the symmetric functions algebra , sweedler s hopf algebra and the steenrod algebra .",
    "further examples will be developed in depth in future work .",
    "let @xmath69 be a finite set and @xmath697 a simplicial complex of subsets of @xmath69 . recall that this means that @xmath697 is a collection of non - empty subsets of @xmath69 such that @xmath1000 implies that all non - empty subsets of @xmath317 are in @xmath697 .",
    "as an example , consider the standard triangulation of the torus into 18 triangles :        here the top and bottom edges are identified as are the left and right sides .",
    "this identifies several vertices and edges and @xmath69 consists of nine distinct vertices .",
    "the complex @xmath697 contains these nine vertices , the 24 distinct edges , and the 18 triangles .",
    "the set of all simplicial complexes ( on all finite sets @xmath69 ) is a basis for a hopf algebra , under disjoint union as product and coproduct @xmath1001 with the sum over subsets @xmath1002 , and @xmath1003 . by convention @xmath1004 in this hopf algebra",
    "so @xmath1005 is allowed in the sum .",
    "graded by @xmath1006 , this gives a commutative , cocommutative hopf algebra with basis given by all complexes @xmath697 ; the generators are the connected complexes .",
    "the associated markov chain , restricted to complexes on @xmath21 vertices , is simple to describe : from a given complex @xmath697 , color the vertices red or blue , independently , with probability 1/2 .",
    "take the disjoint union of the complex induced by the red vertices with the complex induced by the blue vertices .",
    "as usual , the process terminates at the trivial complex consisting of @xmath21 isolated vertices .",
    "[ ex61 ]    this markov chain is of interest in quantifying the results of a `` topological statistics '' analysis .",
    "there , a data set ( @xmath21 points in a metric space ) gives rise to a family of complexes @xmath1007 , where the vertices of each @xmath1008 are the data points , and @xmath100 points form a simplex if the intersection of the @xmath1009 balls around each point is non - empty in the ambient space . for @xmath1009 small",
    ", the complex is trivial . for @xmath1009",
    "sufficiently large , the complex is the @xmath21-simplex . in topological statistics",
    "@xcite one studies things like the betti numbers of @xmath1008 as a function of @xmath1009 .",
    "if these are stable for a range of @xmath1009 this indicates interpretable structure in the data .",
    "consider now a data set with large @xmath21 and @xmath1009 fixed . if a random subset of @xmath100 points is considered ( a frequent computational ploy ) the induced sub - complex essentially has the distribution of the `` painted red '' sub - complex ( if the painting is done with probability @xmath1010 ) .",
    "iterating the markov chain corresponds to taking smaller samples .",
    "if the markov chain starts out at the @xmath21-simplex , every connected subset of the resulting markov chain is a simplex .",
    "thus , at each stage , all of the higher betti numbers are zero and @xmath1011 after @xmath100 steps is @xmath1012 , where @xmath1013 is distributed as the number of empty cells if @xmath21 balls are dropped into @xmath15 boxes .",
    "this is a thoroughly studied problem @xcite .",
    "the distribution of the betti numbers for more interesting starting complexes is a novel , challenging problem .",
    "indeed , consider the triangulation of the torus with @xmath1014 initial triangles .",
    "coloring the vertices red or blue with probability 1/2 , the edges with red / red vertices are distributed in the same way as the `` open sites '' in site percolation on a triangular lattice .",
    "computing the betti number @xmath1011 amounts to computing the number of connected components in site percolation . in the infinite triangular lattice , it is known that @xmath1015 is the critical threshold and at criticality , the chance that the component containing the origin has size greater than @xmath100 falls off as @xmath1016 .",
    "these and related facts about site percolation are among the deepest results in modern probability .",
    "see @xcite for background and recent results .",
    "iterates of the markov chain result in site percolation with @xmath1017 below the critical value but estimating @xmath1011 is still challenging .",
    "let the simplicial complex markov chain start at the complex @xmath1018 .",
    "let @xmath1019 be the graph of the 1-skeleton of @xmath1018 .",
    "suppose that the chromatic polynomial of @xmath1019 is @xmath1020 .",
    "then the probability of absorption after @xmath100 steps is @xmath1021 ( with @xmath1022 ) .",
    "[ prop61 ]    for example , if @xmath1018 is the @xmath21-simplex , @xmath1023 and @xmath1024(absorption after @xmath100 steps)@xmath1025 if @xmath1026 for @xmath21 large .",
    "if @xmath1018 is a tree , @xmath1027 and @xmath1024(absorption after @xmath100 steps)@xmath1028 if @xmath1029 for @xmath21 large",
    ".    using results on the birthday problem in non - standard situations @xcite it is possible to do similar asymptotics for variables such as the number of @xmath49-simplices remaining after @xmath100 steps for more interesting starting @xmath1018 such as a triangulation of the torus into @xmath1030 triangles .    as a final remark ,",
    "note that the simplicial complex markov chain induces a markov chain on the successive 1-skeletons .",
    "the eigenvectors of this markov chain are beautifully developed in @xcite .",
    "these all lift to eigenvectors of the complex chain , so much is known .",
    "it is natural to seek useful deformations of processes like riffle shuffling .",
    "one route is via the quantized shuffle algebras of @xcite and @xcite .",
    "these have become a basic object of study @xcite .",
    "consider the vector space @xmath1031 equipped further with a symmetric @xmath1032 form @xmath1033 .",
    "turn this into an algebra with the product of concatentation .",
    "take as coproduct @xmath10 .",
    "however , @xmath9 is to be multiplicative with respect to the twisted tensor product @xmath1034 .",
    "green translates this into shuffling language .",
    "the upshot is if @xmath1035 is a word in @xmath1031 then @xmath1036 here the sum is over all subsets ( including the empty set ) , @xmath1037 is the inverse shuffle moving the letters in the positions marked by @xmath158 to the front ( keeping them in the same relative order ) .",
    "the weight @xmath1038 is the sum of @xmath1039 for @xmath1040 .",
    "thus if @xmath1041 and @xmath1042 , we have @xmath1043 , and @xmath1044 .",
    "when @xmath1045 this shuffle product gives ree s shuffle algebra and general values of @xmath1046 lead to elegant combinatorial formulations of quantum groups . for general @xmath1047 , there is also a naturally associated markov chain .",
    "work on the piece with multi - grading @xmath24 , so each variable appears once and we may work with permutations in @xmath34 .",
    "for a starting permutation @xmath81 , and @xmath1048 , let @xmath1049 .",
    "set @xmath1050 .",
    "choose @xmath918 with probability @xmath1051 and then @xmath158 ( with @xmath1052 ) with probability @xmath1053 .",
    "move to @xmath1054 .",
    "this defines a markov transition matrix @xmath1055 via @xmath1056 .",
    "note that the normalization @xmath1057 depends on @xmath81 .",
    "[ ex62 ]    we have not seen our way through this to nice mathematics .",
    "there is one case where progress can be made : suppose @xmath1058 .",
    "then @xmath1059 , the minimum number of pairwise adjacent transpositions needed to move @xmath158 to the left .",
    "( when @xmath725 and @xmath1060 . ) since @xmath1061 does nt depend on @xmath81 , neither does @xmath1057 and the markov chain becomes a random walk on @xmath34 driven by the measure @xmath1062 where @xmath1063 is a normalizing constant .",
    "the preceding description gives inverse riffle shuffles .",
    "it is straightforward to describe the @xmath1046-analog of forward riffle shuffles by taking inverses . let @xmath1064_q=1+q+\\dots+q^{j-1}$ ] , @xmath1064_q !",
    "= [ j]_q [ j-1]_q \\dots [ 1]_q$ ] , and @xmath1065_q}= \\frac{[n]_q ! } { [ k]_q ! [ n - k]_q ! } $ ] , the usual @xmath1046-binomial coefficient .",
    "we write @xmath1066 for the number of inversions of the permutation @xmath43 and @xmath1067 for the number of rising sequences .    for @xmath1047 , the @xmath1046-riffle shuffle measure has the following description on @xmath34 : @xmath1068 where @xmath1063 is the normalizing constant @xmath1069 . to generate @xmath43 from @xmath1070 , cut off @xmath918 cards with probability @xmath1071_q}/z_n$ ] and drop cards sequentially according to the following rule : if at some stage there are @xmath133 cards in the left pile and @xmath1072 cards in the right pile , drop the next card @xmath1073_q}{[a+b]_q}\\qquad \\text{and from right with probability}\\quad\\frac{[b]_q}{[a+b]_q}. \\label{62}\\ ] ] continue , until all cards have been dropped .",
    "[ prop6x ]    equation follows from the inverse description because @xmath1074 . for the sequential description ,",
    "it is classical that @xmath1071_q}$ ] is the generating function for multi - sets containing @xmath918 ones and @xmath1075 twos by number of inversion ( * ? ? ?",
    "1.7 ) . for two piles with say , @xmath1076 in the left and @xmath1077 in the right , in order , dropping @xmath918 induces @xmath1078 inversions . multiplying the factors in results in a permutation with @xmath1079 , with probability @xmath1080_q}$ ] .",
    "since the cut is made with probability @xmath1071_q}/z_n$ ] , the two - stage procedure gives .",
    "when @xmath1045 , this becomes the usual gilbert ",
    "reeds measure described in the introduction and in [ sec5 ] .",
    "in particular , for the sequential version , the cut is @xmath918 with probability @xmath1081 and with @xmath133 in the left and @xmath1072 in the right , drop from left or right with probability @xmath1082 respectively . for general @xmath1046 ,",
    "as far as we know , there is no closed form for @xmath1063 . as @xmath1083",
    ", the cutting distribution is peaked at @xmath1084 and most cards are dropped from the left pile . the most likely permutation arises from cutting off @xmath1084 cards and placing them at the bottom .",
    "as @xmath1085 , the cutting distribution tends to uniform on @xmath1086 and most cards are dropped from the right pile .",
    "the most likely permutation is the identity .",
    "there is a natural extension to a @xmath1046-@xmath59-shuffle with cards cut into @xmath59 piles according to the @xmath1046-multinomial distribution and cards dropped sequentially with probability `` @xmath1046-proportional '' to packet size .",
    "consider @xmath1087 $ ] , with @xmath1088 this is the weyl group invariants of type a. it is a polynomial algebra , so the theory in [ sec3 ] generates an eigenbasis of @xmath174 and @xmath571 .",
    "one hopes this will induce a rock - breaking process where pieces of size one are not allowed ; however , we can not rescale the basis via theorem  [ thm31 ] to obtain a transition matrix , as both @xmath1089 and @xmath1090 are primitive basis elements of degree greater than one .",
    "hence @xmath1091 have the same degree , but @xmath1092 and @xmath1093 , so no rescaling can make the sum of the cofficients of @xmath1094 equal to that of @xmath1095 .",
    "[ quotsym ]    the four - dimensional algebra @xmath1096 becomes a hopf algebra with @xmath1097 .",
    "the antipode is @xmath1098 .",
    "it is discussed in @xcite as an example of a hopf algebra that is neither commutative nor cocommutative . with the given basis @xmath1099 .",
    "the negative coefficients forstall our efforts to find a probabilistic interpretation .",
    "the element @xmath1100 is an eigenvector for @xmath14 with eigenvalue 2 and high powers of @xmath1101 applied to a general element @xmath1102 converge to @xmath1103 .",
    "of course , this example violates many of our underlying assumptions .",
    "it is not graded and is neither a polynomial algebra nor a free associative algebra .",
    "[ ex63 ]    steenrod squares ( and higher powers ) are a basic tool of algebraic topology @xcite .",
    "they give rise to a hopf algebra @xmath1104 over @xmath1105 .",
    "its dual @xmath1106 is a commutative , noncocommutative hopf algebra over @xmath1105 with a simple description . as an algebra , @xmath1107 $ ] ( polynomial algebra in countably many variables ) graded with @xmath18 of degree @xmath1108 .",
    "the coproduct is @xmath1109 ( @xmath1110 ) .",
    "alas , because the coefficients are mod 2 , we have been unable to find a probabilistic interpretation of @xmath14 .",
    "for example , @xmath1111 has basis @xmath1112 and @xmath1113 so @xmath1114 .",
    "of course , high powers of operators can be of interest without positivity @xcite .",
    "[ ex64 ]                                                                              l.  geissinger .",
    "hopf algebras of symmetric functions and class functions . in _",
    "combinatoire et reprsentation du groupe symtrique ( actes table ronde c.n.r.s .",
    "louis - pasteur strasbourg , strasbourg , 1976 ) _ , volume 579 of _ lecture notes in math .",
    "_ , pages 168181 .",
    "springer , berlin , 1977 .",
    "v.  f. kolchin , b.  a. sevastyanov , and v.  p. chistyakov . .",
    "v.  h.  winston & sons , washington , d.c . , 1978 .",
    "translated from the russian , translation edited by a.  v. balakrishnan , scripta series in mathematics .",
    "m.  lothaire . .",
    "cambridge mathematical library .",
    "cambridge university press , cambridge , 1997 . with a foreword by roger lyndon and a preface by dominique perrin ; corrected reprint of the 1983 original , with a new preface by perrin ."
  ],
  "abstract_text": [
    "<S> the operation of _ squaring _ ( coproduct followed by product ) in a combinatorial hopf algebra is shown to induce a markov chain in natural bases . </S>",
    "<S> chains constructed in this way include widely studied methods of card shuffling , a natural `` rock - breaking '' process , and markov chains on simplicial complexes . </S>",
    "<S> many of these chains can be explictly diagonalized using the primitive elements of the algebra and the combinatorics of the free lie algebra . for card shuffling </S>",
    "<S> , this gives an explicit description of the eigenvectors . for rock - breaking , an explicit description of the quasi - stationary distribution and sharp rates to absorption follow . </S>"
  ]
}