{
  "article_text": [
    "bayesian networks or graphical models based on directed acyclic graphs ( dags ) are widely used to represent complex causal systems in applications ranging from computational biology to epidemiology , and sociology  @xcite .",
    "a dag entails a set of conditional independence relations through the markov properties .",
    "two dags are said to be _ markov equivalent _ if they entail the same conditional independence relations . in general , observational data",
    "can only identify a dag up to markov equivalence . for statistical causal inference it is therefore important to enumerate and describe the set of markov equivalence classes ( mecs ) and their sizes .",
    "if the mecs are large in size , then causal inference algorithms that operate in the space of mecs as compared to dags could significantly increase efficiency .",
    "however , gaining a full understanding of the causal relationships in a system with a large mec requires many interventional experiments that deliberately and carefully alter one or more components of the system .",
    "the purpose of this paper is to recast this important combinatorial and enumerative question from statistics in the language of combinatorial optimization .",
    "this new perspective yields complexity results on the problem in general , as well as solutions to the problem in some special cases .    the problem of enumerating mecs has been studied from two fundamental perspectives : ( 1 ) enumerate all mecs on @xmath1 nodes ( as in @xcite ) , and ( 2 ) enumerate all mecs of a given size ( as in  @xcite ) . at the heart of these studies is a result of verma and pearl @xcite , which states that a mec is determined by the underlying undirected graph ( or _ skeleton _ ) and the placement of immoralities , i.e.  induced subgraphs of the form @xmath2 .",
    "this characterization leads to a representation of an mec by a graph with directed and undirected edges known as the _ essential graph _",
    "@xcite ( or _ cpdag _",
    "@xcite or _ maximally oriented graph _",
    "@xcite ) . in @xcite ,",
    "gillespie and perlman use this characterization to identify all mecs on @xmath3 nodes ; namely , they fix a skeleton on @xmath1 nodes , and then count the number of ways to compatibly place immoralities within the skeleton . the works",
    "@xcite give inclusion - exclusion formulae for mecs of a fixed size by utilizing the combinatorial structure of the essential graph described in @xcite .",
    "however , since essential graphs can be quite complicated , these formulae are only realizable for relatively constrained classes of mecs",
    ". in particular ,  @xcite and  @xcite only consider mecs of size one , and  @xcite must fix the undirected edges of the essential graphs to be enumerated .",
    "as exhibited by these results , the implementation of combinatorial enumeration techniques appears difficult from perspective ( 2 ) .",
    "on the other hand , perspective ( 1 ) has only been considered via computer - enumeration  @xcite . a common approach to difficult graphical structure enumeration problems",
    "is to specify a type of graph for which to solve the problem .",
    "this approach is used in such problems as the enumeration of independent sets , matchings , and colorings  @xcite . given a graph",
    ", it can be useful to consider a refined set of combinatorial statistics each of which plays a role in the enumeration question .",
    "for instance , given a graph @xmath4 researchers examine the total number of independent sets ( or the _ fibonacci number _ of @xmath4 )  @xcite , the maximum size of an independent set ( or _ independence number _ of @xmath4 )  @xcite , and/or the number of independent sets of a fixed size  @xcite .",
    "these refined statistics work together to give a complete understanding of the problem of enumerating independent sets for @xmath4 .    in the present paper",
    ", we initiate the combinatorial enumeration of mecs with respect to a fixed undirected graph and thereby recast this enumeration problem in the language of combinatorial optimization . for a graph @xmath4",
    "this amounts to enumerating all possible placements of immoralities within @xmath4  @xcite .",
    "thus , we are interested in the following combinatorial statistics :    1 .",
    "@xmath5 , the total number of mecs on @xmath4 , 2 .",
    "@xmath6 , the maximum number of immoralities on @xmath4 , 3 .",
    "@xmath7 , the number of ways to place exactly @xmath8 immoralities on @xmath4 , and 4 .",
    "@xmath9 , where @xmath10 denotes the number of mecs on @xmath4 of size @xmath11 .",
    "the first three statistics fit together naturally in the polynomial presentation @xmath12 in general , computing any or all of these statistics for a given type of graph appears to be difficult . in this paper",
    ", we will prove the following theorem in support of this observation .",
    "[ thm : np - complete ] given an undirected graph @xmath4 , the problem of computing a dag @xmath13 with skeleton @xmath4 and @xmath14 immoralities is np - hard .    here ,",
    "we use the notion of np - hardness as defined in ( * ? ? ?",
    "* chapter 5 ) . as with most np - hard problems , restricting to special cases can make the problem tractable . in this paper , we will compute some or all of ( 1 ) , ( 2 ) , ( 3 ) , and ( 4 ) for some special types of graphs that are important in both statistical and combinatorial settings . moreover , these special cases can offer useful structural insights on the general problem .",
    "for example , it appears that the number and size of equivalence classes is guided by the number of cycles and high degree nodes in the skeleton . in order to test and verify these types of observations ,",
    "we develop a computer program for the enumeration of the combinatorial statistics ( 1 ) , ( 2 ) , ( 3 ) , and ( 4 ) that expands on the original program of gillespie and perlman @xcite . using this program we can not only verify the observations that high degree nodes and cycles in the skeleton play an important role , but we are also able to make the following interesting observation , indicating the profound role played by the underlying skeleton .    [ thm : frequency determinism ] for @xmath3 , every connected graph @xmath4 on @xmath1 nodes has a unique frequency vector @xmath15 .",
    "the remainder of this paper is organized as follows . in section  [ sec : some first examples ] , we examine some first and fundamental examples including paths , cycles , and the complete bipartite graph @xmath16 .",
    "we compute all the desired combinatorial statistics specified by ( 1 ) , ( 2 ) , ( 3 ) , and ( 4 ) for these graphs . the first two examples exhibit an important connection to independent sets and vertex covers . in section  [ sec : trees ] , we consider our enumeration question in the special setting of trees . here , we derive results for stars , bistars , complete binary trees , and caterpillar graphs .",
    "the former two examples play an important role in bounding the number and size of mecs on tree graphs , and the latter two examples are fundamental to phlyogenetic modeling @xcite . following this , we identify bounds on the number of mecs on a given tree that exactly parallel the classically known bounds for independent sets in trees .",
    "we also identify tight bounds on the size of a mec on a given tree using properties of the associated essential graphs . in section  [ sec : immorality numbers and star decompositions ] , we prove theorem  [ thm : np - complete ] via a reduction of the minimum vertex cover problem .",
    "to do so , we prove a correspondence between minimum vertex covers of a given triangle - free graph @xmath4 and minimum decompositions of @xmath4 into non - overlapping stars , which we call _ minimum star decompositions_. using this correspondence , we can compute the number @xmath6 for triangle - free graphs whose minimum star decompositions are isomorphic as forests .",
    "we apply this result to recover @xmath6 for the complete bipartite graph @xmath17 and some special types of circulant graphs . in section  [ sec : computational analysis ] , we describe our computer program for the computation of the statistics ( 1 ) , ( 2 ) ( 3 ) , and ( 4 ) .",
    "this program collects a variety of data on markov equivalence classes and the skeleton of each class for all connected graphs on @xmath3 nodes and for triangle - free graphs on @xmath18 nodes .",
    "in particular , we compare class size and the number of mecs per skeleton to skeletal features including average degree , max degree , clustering coefficient , and the ratio of number of immoralities in the essential graph of the mec to the number of induced @xmath19-paths in the skeleton .",
    "finally , we see that this program validates theorem  [ thm : frequency determinism ] , and we also use it to address the analogous result in the case of unconnected graphs . since this work draws heavily on different concepts from two different fields , statistics and combinatorics , we provide an extensive review of the required concepts and definitions from both fields in the appendix .",
    "in this section , we provide some first examples for which we can compute all of the desired combinatorial statistics ( 1 ) , ( 2 ) ( 3 ) , and ( 4 ) .",
    "the first two examples are the path and cycle on @xmath1 nodes . using some well - known results on the independent sets within these graphs",
    ", we can quickly obtain the desired numbers .",
    "the third example presented in this section is the graph @xmath16 .",
    "unlike the path and cycle , @xmath16 requires a more detailed analysis .      to compute the polynomial @xmath20 and the vector @xmath15 for paths and cycles ,",
    "we will use the notion of independent sets .",
    "we refer the unfamiliar reader to section  [ subsec : graphs ] for all the necessary definitions . in this section",
    ", we will use two well - studied combinatorial sequences , and their associated polynomial filtrations . recall that the @xmath21 fibonacci number @xmath22 is defined by the recursion @xmath23 the _ @xmath21 fibonacci polynomial _ is defined by @xmath24 and it has the properties that @xmath25 for all @xmath26 and @xmath27 for all @xmath28 .",
    "analogously , the @xmath21 lucas number @xmath29 is given by the fibonacci - like recursion @xmath30 the @xmath21 _ lucas polynomial _ is given by @xmath31    it is a well - known result that the independence polynomial of the path of length @xmath1 , which we denote by @xmath32 , is equal to the @xmath33 fibonacci polynomial and the independence polynomial of the @xmath1-cycle @xmath34 is given by the @xmath21 lucas polynomial ; that is to say , @xmath35 with these facts in hand we prove the following theorem .",
    "[ thm : path and cycle polynomials ] for the path @xmath32 and the cycle @xmath34 on @xmath1 nodes we have that @xmath36 in particular , the number of mecs on @xmath32 and @xmath34 , respectively , is @xmath37 and the maximum number of immoralities is @xmath38    the result follows from a simple combinatorial bijection . since paths and cycles are the graphs with the property that the degree of any vertex is at most two , then the possible locations of immoralities are exactly the degree two nodes .",
    "that is , the unique head node @xmath39 in an immorality @xmath40 must be a degree two node . in the path",
    "@xmath32 , this corresponds to all @xmath41 non - leaf vertices , and for the cycle @xmath34 this is all the vertices of the graph .",
    "notice then that no two adjacent degree two nodes can simultaneously be the unique head node of an immorality , since this would require one arrow to be bidirected .",
    "thus , a viable placement of immoralities corresponds to a choice of any subset of degree two nodes that are mutually non - adjacent , i.e. that form an independent set .",
    "conversely , given any independent set in @xmath32 , a dag can be constructed by placing the head node of an immorality at each element of the set and directing all other arrows in one direction .",
    "similarly , this works for any nonempty independent set in @xmath34 .",
    "( notice that any mec on the cycle must have at least one immorality since all dags have at least one sink node . ) the resulting formulas are then @xmath42 which completes the proof .    it remains to compute the vectors @xmath43 and @xmath44 and the maximum number of immoralities @xmath45 and @xmath46 . the formulae for these combinatorial statistics follow naturally from the description of the placement of immoralities given in theorem  [ thm : path and cycle polynomials ] .",
    "[ thm : path vectors ] the number @xmath47 of mecs of size @xmath48 with skeleton @xmath32 is the number of compositions @xmath49 of @xmath50 into @xmath51 parts that satisfy @xmath52 as @xmath8 varies from @xmath53    let @xmath13 be a dag with skeleton @xmath32 . we denote the markov equivalence class of @xmath13 by @xmath54 $ ] . by the proof of theorem  [ thm : path and cycle polynomials ]",
    ", we know that the immorality placements in @xmath54 $ ] correspond to the nodes in an independent @xmath8-subset @xmath55 $ ] on the subpath @xmath56 of @xmath32 induced by the non - leaf nodes of @xmath32 .",
    "the induced graph of the complement of @xmath57 is a forest of @xmath51 paths .",
    "since each member of @xmath54 $ ] is a dag with skeleton @xmath32 that has no immoralities on these @xmath51 paths , then each path contains a unique sink .",
    "each independent @xmath8-subset yields a distinct forest of @xmath51 paths on @xmath58\\backslash\\mathcal{i}$ ] , which corresponds to a unique partition of @xmath50 into @xmath51 parts .",
    "the formula for @xmath47 is then given by considering all such possible placements of sinks on each path in the forests over all independent sets .",
    "a similar argument using integer partitions allows us to compute the number of mecs of size @xmath48 on the @xmath1-cycle .",
    "we refer the reader to subsection  [ subsec : combinatorial definitions ] for the unfamiliar terminology or notation .",
    "[ thm : cycle vectors ] the number of mecs of size @xmath48 in the @xmath1-cycle is @xmath59 , \\\\",
    "\\ell=\\prod_{i=1}^k i^{m_i}}}\\frac{p}{k}{k\\choose m_1,\\ldots , m_{p-2k+1}},\\ ] ] where @xmath60 $ ] denotes the partitions of @xmath61 with @xmath8 parts with largest part at most @xmath39 .",
    "since @xmath34 is a graph in which every node is degree 2 , then each mec of @xmath34 containing @xmath8 immoralities corresponds to an independent @xmath8-subset of @xmath58:=\\{1,2 , \\dots , p\\}$ ] , and the subgraph of @xmath34 given by deleting this @xmath8-subset consists of @xmath8 disjoint paths .",
    "the size of this mec is then the product of the lengths of these paths .",
    "so we need only count the number of such subgraphs for which this product equals @xmath48 .    to count these objects , consider that each subgraph of @xmath34 given by deleting an independent @xmath8-subset of @xmath34 forms a partition of the @xmath50 remaining vertices into @xmath8 parts with maximum possible part size being @xmath62 .",
    "such a partition is represented by @xmath63,\\ ] ] where @xmath64 and @xmath65 .",
    "the partition @xmath66 corresponds to an unlabeled forest consisting of @xmath67 @xmath11-paths , and the number of subgraphs of @xmath34 isomorphic to this forest is @xmath68 the desired formula follows since the size of each corresponding mec is @xmath69 .    [ rmk : lucas triangle ] it is a well - known result that the coefficient of @xmath70 in the @xmath71 fibonacci polynomial is the binomial coefficient @xmath72 , and that this is also the number of compositions of @xmath50 into @xmath51 parts .",
    "the former result says that the @xmath71 fibonacci polynomial has coefficients given by the @xmath71 diagonal of pascal s triangle , and so the latter result gives a compositional interpretation of the corresponding entry in pascal s triangle . in this subsection",
    ", we saw that this compositional interpretation of @xmath72 results in the proof of theorem  [ thm : path vectors ] .",
    "diagonal of each triangle is the coefficient vector of @xmath73 and @xmath74 , respectively .",
    ", scaledwidth=75.0% ]    analogously , the @xmath21 diagonal of a second triangle , called _ lucas triangle _ in @xcite , corresponds to the coefficients of the @xmath21 lucas polynomial .",
    "this triangle is depicted on the right in figure  [ fig : pascal - and - lucas - triangles ] .",
    "thus , the proof of theorem  [ thm : cycle vectors ] results in a combinatorial interpretation of the entries of this triangle via partitions . in particular , the entry of the lucas triangle corresponding to the @xmath75 coefficient of @xmath74 is @xmath76.l_p(x ) = \\sum_{\\left\\langle 1^{m_1},2^{m_2},\\ldots,(p-2k+1)^{m_{p-2k+1}}\\right\\rangle\\in \\mathbb{p}[p-2k+1,k , p - k]}\\frac{p}{k}{k\\choose m_1,\\ldots , m_{p-2k+1}}.\\ ] ] moreover , the binomial recursion on the triangle implies that these coefficients satisfy the identity @xmath76.l_p(x ) = [ x^{k-1}].l_{p-2}+[x^k].l_{p-1}.\\ ] ] to the best of the authors knowledge , such a partition identity is new to the combinatorial literature .      for convenience ,",
    "we consider the partitioned vertex set of @xmath16 to be the two distinguished nodes @xmath77 .",
    "the remaining @xmath1 nodes are labeled by @xmath58 $ ] and are collectively referred to as the _ spine _ of @xmath16 .",
    "this labeling of @xmath16 is depicted on the left in figure  [ fig : k - two - p ] .",
    "first , it is easy to see that the maximum number of immoralities is given by orienting the edges such that all edge heads are at the nodes @xmath78 and @xmath79 .",
    "this results in @xmath80 .",
    "next , we compute a closed form formula for the number of mecs for @xmath16 .",
    "[ thm : k_2,p number of mecs ] the number of mecs with skeleton @xmath16 is @xmath81    to arrive at the desired formula , we divide the problem into three cases :    1 .",
    "the number of immoralities at node @xmath79 is @xmath82 .",
    "the number of immoralities at node @xmath79 is strictly between @xmath83 and @xmath82 .",
    "3 .   there are no immoralities at node @xmath79 .",
    "notice that cases ( 1 ) and ( 2 ) have a natural interpretation via the indegree at node @xmath79 of the essential graph of the corresponding mecs .",
    "readers unfamiliar with the theory of essential graphs can find the basics in section  [ subsec : essential graphs ] .",
    "if the indegree at @xmath79 is two or more , all edges adjacent to @xmath79 are essential , and the number of immoralities at node @xmath79 is given by its indegree .",
    "thus , we can rephrase cases ( 1 ) and ( 2 ) as follows :",
    "the indegree of node @xmath79 in the essential graph of the mec is @xmath1 .",
    "the indegree of node @xmath79 in the essential graph of the mec is @xmath84 .    in case",
    "( 1 ) , the mec is determined exactly by the mec on the star with center node @xmath78 and @xmath1 edges .",
    "one can easily check ( this is also proven as part of theorem  [ thm : stars ] in the following section ) that this yields @xmath85 mecs .",
    "case ( 2 ) is more subtle .",
    "first , assume that the indegree at node @xmath79 is @xmath84 , and the arrows with head @xmath79 have the tails @xmath86 $ ] .",
    "then the remaining arrows adjacent to @xmath79 are all directed outwards with heads @xmath87 .",
    "is depicted on the left , and one of the essential graphs counted in the proof of theorem  [ thm : k_2,p number of mecs ] is depicted on the right.,scaledwidth=75.0% ]    notice that no immoralities can happen at nodes @xmath88 $ ] along the spine , but some may occur at the nodes @xmath58\\backslash[k]$ ] .",
    "if there are no such immoralities , then node @xmath78 has indegree @xmath1 , otherwise the essential graph would contain a directed @xmath89-cycle .",
    "similarly , if , without loss of generality , we denote the nodes in @xmath58\\backslash[k]$ ] that are the heads of immoralities by @xmath90 for @xmath91 , then the nodes @xmath92 are tails of the arrows adjacent to node @xmath78 . thus , if the number of immoralities with heads in @xmath58\\backslash[k]$ ] is @xmath91 , then the immoralities with heads at node @xmath78 are completely determined . therefore , each @xmath93-subset of @xmath58\\backslash[k]$ ] yields a single mec .",
    "figure  [ fig : k - two - p ] depicts an example of one such choice of immoralities .",
    "we start by selecting the arrows to form immoralities at node @xmath79 which forces the remaining arrows at @xmath79 to point towards the spine .",
    "we then select some of these to form immoralities at the spine , and this forces the remaining arrows to be directed inwards towards @xmath78 .",
    "however , if @xmath94 , the star induced by nodes @xmath95 determines the mecs .",
    "this yields @xmath96 classes ( see again theorem  [ thm : stars ] ) . in total , for case ( 2 ) the number of mecs is @xmath97    in case ( 3 ) , we consider when there are no immoralities at node @xmath79 , and we count via placement of immoralities along the spine .",
    "there are @xmath98 ways to place immoralities along the spine , one for each subset of @xmath58 $ ] .",
    "suppose the immoralities along the spine have the heads @xmath99 for @xmath100 ( the cases @xmath101 and @xmath102 are considered separately ) .",
    "then the remaining immoralities can happen at node @xmath78 .",
    "however , if there is an immorality with head at node @xmath78 then all other arrows adjacent to @xmath78 are essential , some of which may point towards the spine with heads in the set @xmath58\\backslash[k]$ ] .",
    "since there are no immoralities with head in the set @xmath58\\backslash[k]$ ] , then any such outward pointing arrow is part of a directed path from @xmath78 to @xmath79 . however , since there are no immoralities at node @xmath79 , there can be at most one such directed path .",
    "the presence of any such directed path forces a directed @xmath89-cycle since @xmath100 .",
    "therefore , for @xmath100 the nodes @xmath87 must be tails of arrows oriented towards node @xmath78 , thereby yielding only a single mec . since @xmath103 and @xmath104 also yield only a single mec , case ( 3 ) yields a total of @xmath98 classes . combing the total number of mecs counted for each of these cases yields the desired formula .    using the case - by - case analysis from the proof of theorem  [ thm : k_2,p number of mecs ] we can count the number of mecs with skeleton @xmath16 of each possible size .",
    "similarly , one can also recover the statistics @xmath105 from this proof .",
    "however , to avoid overwhelming the reader with formulae , we omit the expressions for @xmath105 .",
    "[ cor : k_2,p sizes of mecs ] the possible sizes of a mec with skeleton @xmath16 and the number of classes having each size is as follows :    [ cols=\"^,^\",options=\"header \" , ]      the theory developed in this paper and the computational verification of theorem  [ thm : frequency determinism ] support the intuition that the undirected structure of the skeleton of a dag plays a fundamental role in the size of its mec as well as the number of other mecs that have the same skeleton . in the triangle - free setting ,",
    "the results of section  [ sec : trees ] and theorem  [ thm : minimum star decompositions formula ] highlight the significance of the number and density of high degree nodes within the skeleton of the dag . in this section",
    ", we parse these observations in terms of the computational data collected via our computer program .",
    "specifically , we will compare class size and the number of mecs per skeleton to skeletal features including average degree , max degree , clustering coefficient , and the ratio of number of immoralities in the essential graph of the mec to the number of induced @xmath19-paths in the skeleton .",
    "@xmath106{clustering - coefficient - and - log - average - class - size.pdf } &      \\includegraphics[width=0.47\\textwidth]{clustering - coefficient - and - average - number - of - mecs.pdf } \\\\      \\end{array}$ ]    recall that the _ ( global ) clustering coefficient _ of a graph @xmath4 is defined as the ratio of the number of triangles in @xmath4 to the number of connected triples of vertices in @xmath4 .",
    "the clustering coefficient serves as a measure of how much the nodes in @xmath4 cluster together . figure  [ fig : clustering coefficient all graphs ] presents two plots : one compares the clustering coefficient to the log average class size and the other compares it to the average number of mecs .",
    "this data is taken over all connected graphs on @xmath3 nodes with @xmath107 edges ( to achieve a large number of mecs ) .",
    "as we can see , the average class size grows as the clustering coefficient increases .",
    "this is to be expected , since an increase in the number of triangles within the dag should correspond to an increase in the size of the chordal components of the essential graph .",
    "on the other hand , the average number of mecs decreases with respect to the clustering coefficient , which is to be expected given that the class sizes are increasing .",
    "this decrease in the average number of mecs empirically captures the intuition that having many triangles in a graph results in fewer induced @xmath19-paths , which represent the possible choices for distinct mecs with the same skeleton .",
    "@xmath108{average - degree - and - log - average - class - size.pdf } &      \\includegraphics[width=0.48\\textwidth]{average - degree - and - average - number - of - mecs.pdf } \\\\",
    "\\end{array }      $ ]    figure  [ fig : average degree vs log average class size ] presents a pair of plots , the first of which compares the average degree of the underlying skeleton of the dag to the log average class size of the associated mec .",
    "the second plot compares the average degree of the skeleton to the average number of mecs it supports . both plots present one curve for all connected graphs and a second curve for triangle - free graphs on @xmath109 nodes . for connected graphs on @xmath109 nodes",
    "the left - most plot shows a strict increase in the log average mec class size as the average degree of the nodes in the underlying skeleton increases .",
    "this is to be expected since graphs with a higher average degree are more likely to contain larger chordal components . on the other hand ,",
    "the average class size for triangle - free graphs increases for average degree up until approximately @xmath110 , and then shows a steady decrease for larger average degree .",
    "since the average degree of a tree on @xmath1 nodes is @xmath111 , this suggests that the largest mecs amongst triangle - free graphs have skeleta being trees . as such",
    ", the bounds developed in section  [ sec : trees ] of this paper can be , heuristically , thought to apply more generally to all triangle - free graphs .    the right - most plot in figure  [ fig : average degree vs log average class size ] describes the relationship between average degree and the average number of mecs for all connected graphs and triangle - free graphs on @xmath109 nodes .",
    "we see from this that in the setting of all connected graphs , the skeleta with the largest average number of mecs appear to have average degree @xmath112 , whereas in the triangle - free setting , the higher the average degree the more equivalence classes the skeleta can support .",
    "this supports the intuition that the more high degree nodes there are in a triangle - free graph the more equivalence classes the graph can support .",
    "theoretically , a portion of this intuition is captured by theorem  [ thm : minimum star decompositions formula ] .",
    "@xmath106{max - degree - and - average - class - size.pdf } &      \\includegraphics[width=0.48\\textwidth]{max - degree - and - average - number - of - mecs.pdf } \\\\",
    "\\end{array}$ ]    the left - most plot in figure  [ fig : max degree vs log average class size ] depicts the relationship between the maximum degree of a node in a skeleton and the average class size on the skeleton for all connected graphs and for triangle - free graphs on at most @xmath109 nodes . for all graphs",
    ", the relationship appears to be almost linear beginning with maximum degree @xmath113 , suggesting that average class size grows linearly with the maximum degree of the underlying skeleton .",
    "this growth in class size is due to the introduction of many triangles as the maximum degree grows . on the other hand , in the triangle - free setting",
    "we actually see a decrease in average class size as the maximum degree grows , which empirically reinforces this intuition .    the right - most plot in figure  [ fig : max degree vs log average class size ] records the relationship between the maximum degree of a node in a skeleton and the average number of mecs supported by that skeleton for all connected graphs and triangle - free graphs on at most @xmath109 nodes . for all graphs , we see that the average number of mecs grows with the maximum degree of the graphs , and this growth is approximately exponential . in the triangle - free setting",
    ", the average number of mecs appears to be unimodal , but would be increasing if we considered also all graphs on @xmath114 . for triangle - free graphs",
    "there is only one graph with maximum degree 9 , namely the star @xmath115 , where the number of mecs is @xmath116 . for connected graphs the average number of mecs",
    "is pushed up by those cases consisting of a complete bipartite graph where in addition one node is connected to all other nodes .",
    "-paths in the essential graph.,scaledwidth=46.0% ]    the final plot of interest is in figure  [ fig : class size versus immorality ratio ] , and it shows the relationship between markov equivalence class size and the ratio of the number of immoralities in the essential graph to the number of induced @xmath19-paths in the skeleton for all connected graphs and triangle - free graphs on @xmath109 nodes .",
    "that is , it shows the relationship between the class size and how many of the potential immoralities presented by the skeleton are used by the class .",
    "it is interesting to note that , in the triangle - free setting , as the class size grows , this ratio appears to approach @xmath117 , suggesting that most large mecs use about a third of the possible immoralities in triangle - free graphs . in the connected graph setting , as the class size grows",
    ", we see a steady decrease in the value of this ratio .",
    "this supports the intuition that a larger class size corresponds to an essential graph with large chordal components and few immoralities .",
    "we wish to thank brendan mckay for some helpful advice in the use of the programs nauty and traces @xcite .",
    "liam solus was partially supported by an nsf mathematical sciences postdoctoral research fellowship ( dms - 1606407 ) .",
    "caroline uhler was partially supported by darpa ( darpa - sn-16 - 37 ) and onr ( n00014 - 16-s - ba10 ) .",
    "an _ ( undirected ) graph _",
    "@xmath4 is a pair of sets @xmath118 in which @xmath119 is some _ node _ set and @xmath120 is the _ edge _ set , where an _ edge _ is taken to be an unordered pair of nodes @xmath121 for @xmath122 .",
    "we say that two nodes @xmath123 are _ adjacent _ in @xmath124 if @xmath125 , or equivalently , we say that @xmath11 is a _ neighbor _ of @xmath39 and vice versa .",
    "the _ neighborhood _ of a node @xmath126 in a graph @xmath127 is the set of all neighbors of @xmath11 in @xmath4 including the node @xmath11 itself .",
    "a node is said to be _ incident _ to an edge @xmath128 if @xmath11 is one of the two defining nodes of @xmath129 .",
    "the _ degree _ of a node @xmath11 in a graph @xmath4 is the number of edges incident to @xmath11 in @xmath4 , and it is denoted by @xmath130 . when the graph @xmath4 is understood , we often write @xmath131 .",
    "a node @xmath11 is called a _ leaf _ of @xmath4 when @xmath132 .",
    "a _ path _ in an undirected graph @xmath4 is an alternating sequence of nodes and edges @xmath133 in which @xmath134 for all @xmath135 $ ] .",
    "cycle _ in an undirected graph @xmath4 is an alternating sequence of nodes and edges @xmath133 in which @xmath134 for all @xmath135 $ ] , and @xmath136 .",
    "a graph @xmath124 is called _ connected _ if there exists a path in @xmath4 between every pair of nodes in @xmath119 .",
    "an undirected graph is called a _ forest _ if it contains no cycles .",
    "a _ tree _ is a connected forest .",
    "a graph @xmath137 is _ directed _ if the edge set @xmath120 is a set of _ arrows _ , where an _ arrow _ is defined to be any ordered pair of nodes , denoted @xmath138 or @xmath139 for @xmath122 . in an arrow @xmath139 the node @xmath11 is referred to as the _ tail _ of the arrow and the node @xmath39 is referred to as the _",
    "head_. a _ directed cycle _ in a directed graph @xmath13 is an alternating sequence of nodes and arrows @xmath133 in which @xmath140 for all @xmath135 $ ] , and @xmath136 .",
    "a _ directed acyclic graph _ ( or dag ) is a directed graph that does not contain any directed cycles .",
    "a node @xmath11 is called a _ parent _ of node @xmath39 in a directed graph @xmath13 if @xmath141 . in this case , the node @xmath39 is called a _ child _ of node @xmath11 .",
    "a node @xmath39 is called a _ descendant _ of a node @xmath11 , if there is a directed path in @xmath13 from @xmath11 to @xmath39 . in this case",
    ", node @xmath11 is an _ ancestor _ of @xmath39 .",
    "we denote the set of parents , descendants , and ancestors of node @xmath11 , respectively , by @xmath142 , @xmath143 , and @xmath144 .",
    "the set of _ non - descendants _ of @xmath11 is @xmath145 .",
    "a _ partially directed graph _ is a pair @xmath127 with node set @xmath119 for which the set @xmath120 consists of some edges @xmath121 and some @xmath146 for @xmath147 .",
    "both , dags and partially directed graphs have an underlying _ skeleton _ , which is the undirected graph given by replacing every arrow @xmath139 with the edge @xmath121 .",
    "the collection of all partially directed graphs include both , directed and undirected graphs , as subcollections .",
    "for this reason , we make the following definitions in the setting of partially directed graphs , and simply note that they specify to directed and undirected graphs accordingly .",
    "a _ subgraph _ of a partially directed graph @xmath148 is a partially directed graph @xmath149 for which @xmath150 and @xmath151",
    ". an _ induced subgraph _ of @xmath152 is a subgraph @xmath149 of @xmath152 for which an edge or arrow @xmath128 is in @xmath153 if and only if its two incident nodes are in @xmath154 .",
    "we often call @xmath155 the subgraph _ induced _ by @xmath154 and denote this by writing @xmath156 .",
    "we say that two partially directed graphs @xmath148 and @xmath157 are _ isomorphic _ if there is a bijection @xmath158 such that @xmath121 is an edges of @xmath152 if and only if @xmath159 is an edge of @xmath155 and @xmath139 is an arrow of @xmath152 if and only if @xmath160 is an arrow of @xmath155 .",
    "a _ path _ in a partially directed graph @xmath4 is an alternating sequence of nodes and edges / arrows @xmath133 in which @xmath134 ( or @xmath140 ) for all @xmath135 $ ] .",
    "if the path includes no arrows , it is called _ undirected _ , and if it includes at least one arrow , it is called _",
    "directed_. a _ cycle _ in an undirected graph @xmath4 is an alternating sequence of nodes and edges / arrows @xmath133 in which @xmath134 ( or @xmath140 ) for all @xmath135 $ ] , and @xmath136 .",
    "if the cycle contains no arrows it is called _ undirected _ and if it includes at least one arrow it is called _",
    "directed_. a _ chain graph _ is a partially directed graph containing no directed cycles .",
    "the _ chain components _ of a chain graph are the connected components of its subgraph consisting of all its edges .",
    "we now define some special classes of graphs that we will consider in this paper , and specify their notation .",
    "@xmath1-path _ is the undirected graph @xmath161,e)$ ] for which @xmath162\\}$ ] .",
    "@xmath1-cycle _ is the undirected graph @xmath163,e)$ ] for which @xmath162\\}\\cup\\{\\{1,n\\}\\}$ ] .",
    "a _ chordless cycle _ in a graph @xmath4 is any induced subgraph of @xmath4 that is a cycle .",
    "a graph is called _ chordal _ if every chordless cycle in @xmath4 is a @xmath19-cycle .",
    "the _ complete graph _ on @xmath1 nodes is the undirected graph @xmath164,e)$ ] for which @xmath165\\}$ ] . given two disjoint node sets @xmath119 and @xmath166 for which @xmath167 and @xmath168 , the _ complete bipartite graph _ on @xmath119 and @xmath166 is the undirected graph @xmath169 .",
    "the _ @xmath1-star _ is the complete bipartite graph @xmath170 , and we often denote the @xmath1-star by @xmath171 . for @xmath172 ,",
    "the _ center node _ of @xmath171 is the unique node of degree @xmath1 , and for @xmath173 the center of @xmath171 is chosen to be one of the two nodes of the graph .",
    "bistar _ can be thought of as a gluing of two stars in which a leaf node of one star is glued to the the center node of the other star .",
    "we denote the bistar given by gluing a leaf of @xmath174 to the center node of @xmath171 by @xmath175 .",
    "equivalently , the bistar @xmath175 can be defined by attaching @xmath1 leaves to one node of the @xmath176-path @xmath177 and @xmath178 leaves to the other node .",
    "more generally , we can define the graph @xmath179 to be the undirected graph given by attaching @xmath180 leaves to node @xmath11 of the @xmath1-path @xmath32 .",
    "a _ rooted _ undirected graph @xmath127 is an undirected graph with a unique distinguished node @xmath181 called the _ root _ of @xmath4 .",
    "complete binary tree _ is a rooted tree in which the root node has degree two and every other non - leaf node has degree three .      in this section ,",
    "we let @xmath127 be an undirected graph .",
    "independent set _ in @xmath4 is a subset of mutually non - adjacent nodes @xmath182 .",
    "vertex cover _ of @xmath4 is a subset of nodes @xmath182 for which every edge of @xmath4 is incident to some node in @xmath183 .",
    "the complement in @xmath119 of an independent set is always a vertex cover in @xmath119 . in particular , the complement of a maximum independent set is a minimum vertex cover .",
    "the _ independence number of @xmath4 _ is the size of any maximum independent subset of @xmath4 , and the _ fibonacci number of @xmath4 _ is the total number of independent sets of @xmath4 .",
    "let @xmath184 denote the number of independent subsets of size @xmath8 in @xmath4 , @xmath185 denote the independence number of @xmath4 , and @xmath186 denote the fibonacci number of @xmath4 .",
    "these numbers collect into the polynomial generating function @xmath187 which we call the _ independence polynomial of @xmath4_. in particular , @xmath188 .",
    "let @xmath189 denote a vector of random variables that are indexed by the nodes of some directed acyclic graph ( dag ) @xmath137 .",
    "the set of arrows and non - arrows in @xmath13 encode a set of conditional independence constraints on random variables @xmath190 , known as the markov properties of the dag @xmath13 .",
    "the _ directed acyclic graphical model _ associated to @xmath13 is the family of multivariate probability distributions that abide by the markov properties of @xmath13 . to specify the markov properties ,",
    "we first recall the notion of connectedness or separation for directed graphs .",
    "a _ path _ in the dag @xmath13 is an alternating sequence of nodes and arrows @xmath191 in which the arrow @xmath192 is either @xmath193 or @xmath194 for all @xmath11 .",
    "a _ collider _ on a path in @xmath13 is any subsequence @xmath195 such that @xmath196 and @xmath197 . given a dag @xmath198",
    ", we consider the graphical model associated to @xmath13 by the _ directed global markov property_. two nodes @xmath199 and @xmath200 in @xmath198 are said to be _",
    "@xmath201-connected _ given @xmath202 if there exists a path @xmath203 from @xmath199 to @xmath200 for which      if @xmath205 , @xmath206 , and @xmath152 are disjoint subsets of @xmath119 with @xmath205 and @xmath206 being nonempty , then @xmath152 is said to _ @xmath201-separate _ @xmath205 and @xmath206 if there are no @xmath207 and @xmath208 that are @xmath201-connected given @xmath152 .",
    "the _ directed global markov property _ associates the dag @xmath137 with the set of conditional independence relations @xmath209 for all triples @xmath210 , and @xmath152 for which @xmath152 @xmath201-separates @xmath205 and @xmath206 .",
    "note that multiple dags can have the same set of @xmath201-separation relations , and thereby encode the same set of conditional independence statements . if two dags encode the exact same conditional independence relations with respect to the directed global markov property , they are called _",
    "markov equivalent_. given a dag @xmath137 , the collection of all dags that are markov equivalent to @xmath13 , including @xmath13 itself , is called the _ markov equivalence class _ of @xmath13 . in this paper",
    "we denote the markov equivalence class of @xmath13 by @xmath54 $ ] .",
    "there is a well - known characterization of when two dags are markov equivalent , and it is given in terms of their skeleta and their set of immoralities .",
    "immorality _ in a dag @xmath13 is a triple of node @xmath211 for which @xmath13 contains the arrows @xmath212 and @xmath213 but @xmath13 does not contain either of the arrows @xmath214 or @xmath215 .",
    "let @xmath13 be a dag and let @xmath54 $ ] denote the mec containing @xmath13 .",
    "an _ essential arrow _ in @xmath13 is an arrow which appears in all elements of @xmath54 $ ] .",
    "that is , @xmath139 is an essential arrow of @xmath13 if and only if @xmath139 is an arrow of @xmath216 for all @xmath217 $ ]",
    ". we also refer to such an arrow as an essential arrow of the mec @xmath54 $ ] .",
    "the _ essential graph _ of the class @xmath54 $ ] is the partially directed graph whose set of arrows is precisely the essential arrows of @xmath54 $ ] and whose set of edges is those edges @xmath121 in the skeleton of @xmath13 that support non - essential edges in @xmath13 .",
    "we denote the essential graph of @xmath54 $ ] by @xmath218 .",
    "recall that the _ chain components _ of a chain graph are the connected components of its subgraph consisting of all its undirected edges .",
    "we call the connected directed components of an essential graph its _ essential components_. an arrow @xmath139 is called _ strongly protected _ in a chain graph if it occurs in any one of the configurations depicted in figure  [ fig : strongly protected edges ] .          1 .",
    "@xmath4 is a chain graph .",
    "every chain component of @xmath4 is chordal .",
    "3 .   the configuration @xmath219 does not occur as an induced subgraph of @xmath4 .",
    "every arrow @xmath139 is strongly protected in @xmath4 .        a _ composition _ of a positive integer @xmath61 into @xmath8 parts is an ordered sum of @xmath8 positive integers equaling @xmath61 , i.e. @xmath220",
    "the positive integers @xmath221 are called the _ parts _ of the composition .",
    "a partition of the positive integer @xmath61 is a sequence of integers @xmath222 satisfying @xmath223 and @xmath224 .",
    "the nonzero integers @xmath225 are called the _ parts _ of the partition , and we say that @xmath226 has @xmath8 parts if @xmath227 .",
    "we let @xmath228 $ ] denote the set of partitions of @xmath61 with @xmath8 parts , and we let @xmath60 $ ] denote the partitions of @xmath61 with @xmath8 parts with largest possible part @xmath39 .",
    "note that our notation differs slightly from the notation used in @xcite , in which @xmath229 denotes the number of partitions of @xmath61 with _ at most _",
    "@xmath8 parts and largest part being @xmath39 .",
    "if the partition @xmath226 has @xmath67 parts equaling @xmath11 then we may write @xmath230 .",
    "when @xmath231 $ ] , then @xmath232 and so @xmath226 is uniquely identified with the integer vector @xmath233 . in this case , we simply write @xmath234 $ ] .",
    "a wealth of enumerative combinatorics , including a complete treatment of compositions and integer partitions , can be found in @xcite .",
    "m.  r.  garey and d.  s.  johnson . _ computers and intractability : a guide to the theory of np - completeness_. a series of books in the mathematical sciences .",
    "wh freeman and company , new york , ny 25.27 ( 1979 ) : 141 .",
    "s. b. gillispie and m. d. perlman . _ enumerating markov equivalence classes of acyclic digraph models .",
    "_ proceedings of the seventeenth conference on uncertainty in artificial intelligence .",
    "morgan kaufmann publishers inc . , 2001 .",
    "t.  verma and j.  pearl .",
    "_ an algorithm for deciding if a set of observed independencies has a causal explanation_. proceedings of the eighth international conference on uncertainty in artificial intelligence .",
    "morgan kaufmann publishers inc ."
  ],
  "abstract_text": [
    "<S> bayesian networks or directed graphical models are widely used to represent complex causal systems . from observational data alone , a bayesian network can only be identified up to _ markov equivalence _ and interventional experiments are required to distinguish between markov equivalent bayesian networks . </S>",
    "<S> it is therefore important to describe and understand the set of markov equivalence classes ( mecs ) and their sizes . in this paper </S>",
    "<S> , we initiate the combinatorial enumeration of mecs on a fixed undirected graph , and thereby recast this important statistical problem into the language of combinatorial optimization . </S>",
    "<S> combinatorially , two bayesian networks are markov equivalent if their underlying undirected graphs and their set of immoralities are the same . </S>",
    "<S> we show that the np - complete minimum vertex cover problem reduces to the computation of a bayesian network with the maximum number of immoralities . </S>",
    "<S> the np - hardness of this problem shows the complexity of enumerating mecs from the perspective of combinatorial optimization . </S>",
    "<S> we then solve this enumeration problem for classically studied families of graphs including paths , cycles , and some types of complete bipartite graphs , trees , and circulants . </S>",
    "<S> we also provide tight bounds on the number and size of mecs on a given tree . </S>",
    "<S> these bounds exactly parallel the well - known bounds for the independent set problem . </S>",
    "<S> finally , a computer program was written to analyze the enumeration problem on all graphs with at most 10 nodes and all triangle - free graphs with at most @xmath0 nodes . </S>",
    "<S> the results show a trade - off between degree and clustering coefficient with respect to the number of mecs and their sizes . </S>",
    "<S> in addition , this program established that the frequency vector consisting of the number of mecs of each size uniquely determines the undirected graph . </S>"
  ]
}