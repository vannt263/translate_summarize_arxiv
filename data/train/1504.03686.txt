{
  "article_text": [
    "we present progress towards the implementation of a predictive fourier control ( pfc ) @xcite algorithm on sky to correct for frozen flow turbulence in adaptive optics systems . recently ,",
    "linear - quadratic gaussian ( lqg ) controllers @xcite have been used for the stable control of adaptive optics systems @xcite , and for the suppression of specific frequency vibrations in operating adaptive optics systems @xcite .",
    "predictive fourier control is an lqg method which explicitly corrects for frozen - flow turbulence crossing the telescope aperture .",
    "it diagonalizes that problem by working in fourier space , making the method computationally feasible for high - order ao systems .",
    "several groups have formulated lqg controllers for the optimal control of adaptive optics systems .",
    "gavel and wiberg @xcite initially developed a kalman filter for optimal ao control .",
    "le roux et al .",
    "@xcite formulated an lqg controller for adaptive optics .",
    "petit et al .",
    "@xcite demonstrated the use of lqg in the laboratory to suppress vibrations .",
    "sivo et al .",
    "@xcite have applied this on sky with the canary demonstrator .",
    "lqg control has progressed from the laboratory to the latest generation of astronomical instruments .",
    "the recently commissioned gemini planet imager @xcite and sphere @xcite instruments have both demonstrated the use of optimal lqg control @xcite .",
    "gpi s ao system uses an lqg controller to suppress vibrations in both tip - tilt and focus @xcite .",
    "similarly , sphere uses an lqg controller to suppress vibrations in only the tip - tilt modes @xcite .",
    "these controllers are implemented with the same lqg framework that we will apply to correct frozen flow turbulence across spatial frequencies beyond the tip - tilt regime .",
    "our experimental setup provides a tightly integrated way to test the use of an lqg controller both in the lab and on - sky . the shaneao system with the sharcs camera on the shane 3-m telescope at lick observatory @xcite provides an on - sky instrument . at the lab for adaptive optics",
    "we have configured an adaptive optics test bench@xcite to mimic the hardware and physical conditions for shaneao .",
    "these closely coupled systems allow us to test and develop techniques in a controlled lab before proceeding to the instrument on - sky for functional tests .",
    "this paper describes a laboratory implementation of the full predictive fourier control ( pfc ) algorithm . in section  [ sec : experimental_setup ] we provide a brief overview of the test bench , a full , physical simulator designed to test adaptive optics hardware , software and techniques . in section  [ sec : theoretical_framework ] we describe the pfc algorithm , and the way this algorithm interacts with an operating adaptive optics system . in section",
    "[ sec : experimental_results ] we describe the implementation of the pfc algorithm in the lab , and the measured performance improvement .",
    "section  [ sec : discussion ] discusses the significance of this laboratory demonstration .",
    "our framework , described in section  [ sec : theoretical_framework ] and diagramed in figure  [ fig : block : loops ] , consists of three components :    1 .",
    "phase reconstruction as performed by a standard adaptive optics system .",
    "2 .   the predictive fourier controller , which uses a kalman filter to provide a best estimate of the correction in the future .",
    "fourier wind identification , which provides the state space model to the predictive fourier controller .",
    "fourier wind identification is described theoretically in section  [ sub : fourier_wind_identification ] , and demonstrated in the lab in section  [ sub : wind_identification_on_the_mcao_bench ] .",
    "we discuss the theoretical framework of the predictive fourier controller in section  [ sub : lqg_based_predictive_control ] , and demonstrate its operation in sections  [ sub : integrating_the_lqg_controller ]  and  [ sub : applying_predictive_fourier_control_to_the_mcao_test_bench ] .",
    "our experiments are performed on a modified and optimized version of the ucsc laboratory for adaptive optics ( lao ) mcao / moao testbed@xcite . in the past ,",
    "its utility and versatility has been shown by simulating mcao and open - loop moao on a 30-m equivalent aperture telescope @xcite , demonstrating the positive effect of linearity calibrations to shack - hartmann wavefront sensors during open - loop moao operation on a 10-m telescope @xcite and for developing wavefront reconstruction and control algorithms for mcao on an 8-m class telescope @xcite .",
    "currently , we have reconfigured the testbed to match as closely as possible the new adaptive optics system on the shane 3-m telescope at lick observatory ( shaneao ) @xcite so that the transition from lab to a real system is as seamless as possible .",
    "the optical layout of the reconfigured system is shown in figure  [ fig : testbed ] .",
    "testbed layout for wind prediction tests .",
    "the light source is a super - luminescent diode laser .",
    "the spatial light modulator is a high - frequency deformable mirror . in single conjugate mode",
    "only one of the shack - hartmann wavefront sensors is used . ]    for our purposes , the testbed is operated in single conjugate ( scao ) mode with two deformable mirrors ( dms ) : a low ( spatial and temporal ) frequency , high - stroke alpao dm52 `` woofer '' and a high - frequency , lower - stroke , hamamatsu slm - x8267 spatial light modulator ( slm ) `` tweeter '' . as the test benchdoes not operate in real time , we treat both mirrors as having instantaneous temporal properties and ignore the slower temporal performance of the `` woofer '' mirror .",
    "both dms are conjugate to the equivalent of the atmosphere s ground layer represented by a phase plate mounted on a linear stepper motor .",
    "each phase plate is 160 subapertures across with a minimum wind speed of 0.01 subapertures per timestep .",
    "the linear stepper can be reliably repositioned so that repeated runs can be performed across the same section of a phase plate and a higher signal - to - noise ratio is achieved by co - adding runs .",
    "the size of the phase plate ensures that each test run contains @xmath6 pupil crossings .",
    "the woofer s actuator layout is @xmath7 across the pupil .",
    "the edges of the woofer are pinned , so outer actuators have reduced stroke and are not used .",
    "this is nearly identical to the configuration of the woofer used in shaneao .",
    "the slm has a resolution of @xmath8 , however pixels are binned to emulate a @xmath9 actuator configuration similar to that of the mems tweeter on shaneao .",
    "prior to every set of extended runs ( typically once a day ) , the woofer and tweeter are re - registered to the wavefront sensor and a new woofer influence matrix is generated .",
    "woofer edge effects are minimized by performing a fit to individually measured influence functions . a singular value decomposition ( svd ) reconstructor zeroes out potentially problematic ( high frequency ) woofer modes .",
    "each dm has a separately set integrator leak gain ( up to @xmath10 for the woofer and @xmath11 for the tweeter ) , similar to shaneao , to allow each mirror to handle its own actuator clipping and windup .",
    "detailed telemetry ( residuals , dm commands ) and configuration is saved during each run to ensure reproducibility .",
    "the test benchcontrol law mimics the integrators and reconstructors used in shaneao , however the system delay can be arbitrarily shortened or lengthened to match the operating control delay measured with shaneao or to test the effects of longer or shorter time delays .      in order to use the test",
    "benchas a scale representation of the shaneao system , and to integrate the lqg controller into the test benchsoftware architecture , several changes to the test benchwere required .",
    "we first re - mapped the pupil of the test bench to the wfs lenslet arrays to simulate subaperutres which are scaled equivalents to the @xmath12 subapertures found in the shaneao system . and",
    "@xmath13 , as our test bench does not operate in real time .",
    "all of these numbers can be easily scaled to match the @xmath14 shaneao system , an @xmath15 or a @xmath16 telescope . for the shaneao system , we convert from the test benchto an operating frequency of @xmath17 and a subaperture size of @xmath12 . ]",
    "the remapping resulted in 36 active subapertures across the pupil , slightly more than are found on the shaneao system , which will have 30 subapertures across the pupil in its highest performance configuration .    as well",
    ", we implemented an svd reconstructor for the system s high stroke woofer .",
    "this allows us to eliminate problematic high frequency woofer modes , but to use the natural actuator basis set for the woofer directly .",
    "this also allows us to easily re - measure the woofer influence functions for each actuator , recalibrating the system for minor changes in alignment and optimizing the system s long term performance .",
    "although the svd reconstructor for the woofer improved its performance and registration , the slm registration algorithm had to be improved to fix actuator misregistration errors that would cause very high spatial frequency content to build up on the mirror .",
    "we solved this with an improved actuator registration method which uses actuators across the full slm mirror working surface , and automatically fits the pixel locations instead of relying on user input to identify actuator pokes .",
    "the original fiber laser was replaced with a super luminescent diode ( sld ) to fix non - uniform pupil intensity effects that manifested as an @xmath18 power peak due to laser power fluctuations . over",
    "long runs ( 10,000 iterations or greater ) , we observe a correlation between rms error and measured strehl indicating low non - common path errors .",
    "the far - field image is sharpened using an algorithm that iteratively maximizes strehl by successively placing zernike modes on the woofer and tweeter .",
    "we also improved the control loop architecture of the test benchto facilitate the use of the kalman reconstructor .",
    "the new architecture allows us to transition quickly between reconstructors , to perform calibration with one reconstructor ( usually a simple fourier - transform reconstructor ) and then transition to a different reconstructor ( the full lqg controller ) for operation .",
    "these modifications also permit the system to enable , disable and reset integrator states during normal operation .",
    "we have developed a consistent error budget for the test benchin its current configuration , based on the error budget presented in ammons et al .",
    "( 2010 ) @xcite .",
    "similar to ammons et al .",
    ", we derive many of our error budget terms from the total atmospheric turbulence as measured by the wavefront sensor s rms total wavefront error measured with the phase plate held still ( @xmath19 ) . from this measurement",
    ", we can derive the fitting error ( @xmath20 , see @xcite section 4.3.2 ) and aliasing error ( @xmath21 , see @xcite section 4.3.2 and references therein ) .",
    "the measurement error from the wavefront sensor was measured directly on the test bench , with no atmosphere present , and found to be @xmath22 .",
    "we explicitly separate bandwidth and delay temporal errors . as the test benchoperates in discretized timesteps",
    ", there is no bandwidth error .",
    "the error due to the artificial delay in the system was computed from equation 9.56 in hardy ( 1998 ) @xcite , @xmath23 where @xmath24 is the greenwood frequency , which can be computed from the wind velocity , and @xmath25 is the delay between measurement and correction , which for the experiments described in this paper was set to @xmath26 .",
    "to measure the non - common path errors in our strehl measurement , we applied the extended marchal approximation ( see hardy ( 1998 ) equation 4.40 @xcite , and @xcite ) to the far - field strehl after image sharpening but with no aberrations in the system .",
    "after image sharpening , the far - field strehl was @xmath27 , contributing @xmath28 of error to the system .",
    "examining the error budget during experiments suggests that our far - field correction did not remain stable , and that an additional @xmath29 of calibration error exist in the system .",
    "all of these error terms are presented in table  [ tab : errorbudget ] .",
    "the rms far - field wavefront error in table  [ tab : errorbudget ] includes terms which are not seen by the wavefront sensor .",
    "when considering the rms residual wavefront error as measured by the wavefront sensor , we ignore the mirror fitting , spatial aliasing , static uncorrectable and calibration error terms . when measuring the far - field strehl , these terms are included .",
    ".[tab : errorbudget]error budget for the test bench . [ cols=\"<,>\",options=\"header \" , ]      to check the stability of the predictive fourier controller , we ran the test benchusing filters generated for known incorrect wind speeds .",
    "the filters were generated in the same manner as in section  [ sub : applying_predictive_fourier_control_to_the_mcao_test_bench ] , but with the incorrect wind direction or magnitude for each test . using a filter with an incorrect magnitude , or",
    "an incorrect direction up to @xmath30 from the true wind direction resulted in stable correction , with performance degrading to that of the standard integral controller .",
    "wind vectors that were significantly far from the true wind on the test benchcaused instabilities to appear in specific fourier modes .    that the filters are stable for minor offsets of the wind vector is unsurprising .",
    "filters with @xmath31 should always be stable @xcite .",
    "this suggests that the instabilities we observed with large wind - vector offsets are unstable not due to the controller alone , but due to the interaction of the controller and the test bench .",
    "future experiments will investigate the specific modal instabilities found for large deviations in the wind vector .",
    "this paper demonstrates the feasibility of `` predictive fourier control '' , but leaves a true characterization of system performance improvements and stability to future work .",
    "the lqg filter was able to correct for frozen flow turbulence using our fourier mode state - space model .",
    "correction was applied in some modes beyond the controller bandwidth ( see figure  [ fig : pkf : etf ] ) , and improved performance at very high temporal frequencies .",
    "although we have performed cursory checks of the lqg filter stability using the test bench , several questions remain .",
    "we plan to explore the stability of the lqg filter during real - world operation , where wind vectors can vary during the application of the filter .",
    "although the filter appears stable for moderate changes in the wind vector , we will require an on - sky application to test the performance gains and losses that occur due to a naturally varying wind vector .",
    "as the lqg filter maintains a state - space model of the system , it has some `` burn - in '' time during which it must build up a `` memory '' of the wavefront error .",
    "we will characterize , on - sky , the effect of this `` burn - in '' time during filter transitions , and use this to optimize the trade - off between the speed of the fourier wind identification loop ( the bottom loop in figure  [ fig : block : loops ] ) and the penalty incurred by changing the lqg filter in real time .",
    "the pfc algorithm can also be extended to eliminate wind aliasing features , which appear as similar planes in fourier space to those described by frozen flow . in the same way that we can reduce delay error in the presence of frozen flow turbulence",
    ", we can use the lqg controller with the pfc algorithm to correct for the effects of wind aliasing when it is detected in system telemetry @xcite .",
    "finally , once we have demonstrated the pfc algorithm on - sky with shaneao , we intend to adapt the lqg controller to account for actuator clipping and the woofer - tweeter architecture",
    ". a full controller would penalize actuators which are close to clipping within the kalman filtering framework , and so would provide an end - to - end optimal control that would be less reliant on the absolute calibration of the individual woofer and tweeter mirrors .",
    "this paper presents experimental verification of a computationally efficient method for removing the effects of frozen - flow turbulence from the residual errors in an adaptive optics system .",
    "predictive fourier control has the potential to reduce the effect of time delay errors , and to correct for specifically modeled and known errors beyond the bandwidth of the adaptive optics system .",
    "we demonstrate that in the presence of wind - blown frozen flow turbulence predictive fourier control is a feasible method for gaining @xmath1 improvement in an ao system in the far - field performance and a factor of @xmath0 in the rms residual wavefront error .",
    "the laboratory experiments suggest that we will see significant gains in ao system performance on - sky .",
    "this level of performance improvement is promising for an algorithm which only requires a software adjustment , and which will not add significantly to the computational complexity of an existing adaptive optics system .",
    "this work performed under the auspices of the u.s .",
    "department of energy by lawrence livermore national laboratory under contract de - ac52 - 07na27344 .",
    "the document number is llnl - jrnl-667747 .",
    "this work was funded by the uc lab fees research program grant 12-lf-236852 .",
    "this material is based upon work supported by the national science foundation graduate research fellowship program under grant no .",
    "dge 1339067 ."
  ],
  "abstract_text": [
    "<S> we present the laboratory verification of a method for removing the effects of frozen - flow atmospheric turbulence using a linear quadratic gaussian ( lqg ) controller , also known as a kalman filter . </S>",
    "<S> this method , which we term `` predictive fourier control , '' can identify correlated atmospheric motions due to layers of frozen flow turbulence , and can predictively remove the effects of these correlated motions in real - time . </S>",
    "<S> our laboratory verification suggests a factor of @xmath0 improvement in the rms residual wavefront error and a @xmath1 improvement in measured strehl of the system . </S>",
    "<S> we found that the rms residual wavefront error was suppressed from @xmath2 to @xmath3 due to the use of predictive fourier control , and that the far field strehl improved from @xmath4 to @xmath5 .    </S>",
    "<S> 99    l.  a. poyneer , b.  a. macintosh , and j .- p . </S>",
    "<S> veran , `` fourier transform wavefront control with adaptive prediction of the atmosphere , '' * 24 * , 2645 ( 2007 ) .    </S>",
    "<S> l.  a. poyneer and j .- p . </S>",
    "<S> veran , `` predictive wavefront control for adaptive optics with arbitrary control loop delays , '' * 25 * , 1486 ( 2008 ) .    d.  t. gavel and d.  wiberg , </S>",
    "<S> `` toward strehl - optimizing adaptive optics controllers , '' * 4839 * , 890901 ( 2003 ) .    </S>",
    "<S> b.  le  roux , j .- </S>",
    "<S> m . </S>",
    "<S> conan , c.  kulcsar , h .- f . </S>",
    "<S> raynaud , l.  m. mugnier , and t.  fusco , `` optimal control law for classical and multiconjugate adaptive optics , '' * 21 * , 12611276 ( 2004 ) .    c.  petit , j .- </S>",
    "<S> m . </S>",
    "<S> conan , c.  kulcsar , h .- f . </S>",
    "<S> raynaud , and t.  fusco , `` first laboratory validation of vibration filtering with lqg control law for adaptive optics , '' * 16 * , 8797 ( 2008 ) .    </S>",
    "<S> l.  a. poyneer , r.  j. de  rosa , b.  macintosh , d.  w. palmer , m.  d. perrin , n.  sadakuni , d.  savransky , b.  bauman , a.  cardwell , j.  k. chilcote , d.  dillon , d.  gavel , s.  j. goodsell , m.  hartung , p.  hibon , f.  t. rantakyr , s.  thomas , and j .- </S>",
    "<S> p . </S>",
    "<S> vran , `` on - sky performance during verification and commissioning of the gemini planet imager s adaptive optics system , '' * 9148 * , 91480k ( 2014 ) .    </S>",
    "<S> j .- l . </S>",
    "<S> beuzit , m.  feldt , k.  dohlen , d.  mouillet , p.  puget , f.  wildi , l.  abe , j.  antichi , a.  baruffolo , p.  baudoz , a.  boccaletti , m.  carbillet , j.  charton , r.  claudi , m.  downing , c.  fabron , p.  feautrier , e.  fedrigo , t.  fusco , j .- l . </S>",
    "<S> gach , r.  gratton , t.  henning , n.  hubin , f.  joos , m.  kasper , m.  langlois , r.  lenzen , c.  moutou , a.  pavlov , c.  petit , j.  pragt , p.  rabou , f.  rigal , r.  roelfsema , g.  rousset , m.  saisse , h .- m . </S>",
    "<S> schmid , e.  stadler , c.  thalmann , m.  turatto , s.  udry , f.  vakili , and r.  waters , `` sphere : a planet finder instrument for the vlt , '' * 7014 * , 701418 ( 2008 ) .    </S>",
    "<S> g.  sivo , c.  kulcsar , j .- </S>",
    "<S> m . </S>",
    "<S> conan , h .- f . </S>",
    "<S> raynaud ,  .  </S>",
    "<S> gendron , a.  basden , f.  vidal , t.  morris , s.  meimon , c.  petit , d.  gratadour , o.  martin , z.  hubert , a.  sevin , d.  perret , f.  chemla , g.  rousset , n.  dipper , g.  talbot , e.  younger , r.  myers , d.  henry , s.  todd , d.  atkinson , c.  dickson , and a.  longmore , `` first on - sky scao validation of full lqg control with vibration mitigation on the canary pathfinder , '' * 22 * , 2356523591 ( 2014 ) .    </S>",
    "<S> b.  macintosh , j.  r. graham , p.  ingraham , q.  konopacky , c.  marois , m.  perrin , l.  a. poyneer , b.  bauman , t.  barman , a.  s. burrows , a.  cardwell , j.  chilcote , r.  j. de  rosa , d.  dillon , r.  doyon , j.  dunn , d.  erikson , m.  p. fitzgerald , d.  gavel , s.  goodsell , m.  hartung , p.  hibon , p.  kalas , j.  larkin , j.  maire , f.  marchis , m.  s. marley , j.  mcbride , m.  millar - blanchaer , k.  morzinski , a.  norton , b.  r. oppenheimer , d.  palmer , j.  patience , l.  pueyo , f.  rantakyro , n.  sadakuni , l.  saddlemyer , d.  savransky , a.  serio , r.  soummer , a.  sivaramakrishnan , i.  song , s.  thomas , j.  k. wallace , s.  wiktorowicz , and s.  wolff , `` first light of the gemini planet imager , '' proceedings of the national academy of sciences , 201304215 ( 2014 ) .    c.  petit , j.  f. sauvage , t.  fusco , a.  sevin , m.  suarez , a.  costille , a.  vigan , c.  soenke , d.  perret , s.  rochat , a.  barrufolo , b.  salasnich , j.  l. beuzit , k.  dohlen , d.  mouillet , p.  puget , f.  wildi , m.  kasper , j.  m. conan , c.  kulcsr , and h.  f. raynaud , `` sphere extreme ao control scheme : final performance assessment and on sky validation of the first auto - tuned lqg based operational system , '' * 9148 * , 91480o ( 2014 )    d.  gavel , r.  kupke , d.  dillon , a.  norton , c.  ratliff , j.  cabak , a.  phillips , c.  rockosi , r.  mcgurk , s.  srinath , m.  peck , w.  deich , k.  lanclos , j.  gates , m.  saylor , j.  ward , and t.  pfister , `` shaneao : wide science spectrum adaptive optics system for the lick observatory , '' * 9148 * , 914805 ( 2014 ) .    </S>",
    "<S> r.  kupke , d.  gavel , c.  roskosi , g.  cabak , d.  cowley , d.  dillon , e.  l. gates , r.  mcgurk , a.  norton , m.  peck , c.  ratliff , and m.  reinig , `` shaneao : an enhanced adaptive optics and ir imaging system for the lick observatory 3-meter telescope , '' * 8447 * , 84473 g ( 2012 ) .    </S>",
    "<S> e.  a. laag , s.  m. ammons , d.  t. gavel , and r.  kupke , `` multiconjugate adaptive optics results from the laboratory for adaptive optics mcao / moao testbed , '' * 25 * , 21142121 ( 2008 ) .    </S>",
    "<S> s.  m. ammons , r.  kupke , e.  laag , d.  t. gavel , d.  r. dillon , m.  r. reinig , b.  j. bauman , c.  e. max , and j.  a. johnson , `` first results from the ucsc laboratory for adaptive optics multi - conjugate and multi - object adaptive optics testbed , '' * 6272 * , 627202 - 1 ( 2006 ) .    s.  m. ammons , e.  laag , r.  kupke , d.  t. gavel , and c.  e. max , `` enabling laboratory demonstrations of multi - object adaptive optics with linearity calibrations , '' * 6691 * , 669108 - 1 ( 2007 ) .    s.  m. ammons , l.  johnson , e.  a. laag , r.  kupke , d.  t. gavel , b.  j. bauman , and c.  e. max , `` integrated laboratory demonstrations of multi - object adaptive optics on a simulated 10 meter telescope at visible wavelengths , '' publications of the astronomical society of the pacific * 122 * , 573589 ( 2010 ) .    </S>",
    "<S> j.  w. hardy , _ adaptive optics for astronomical telescopes _ ( oxford university press , usa , 1998 ) .    </S>",
    "<S> a.  marchal , `` tude des effets combins de la diffraction et des aberrations gomtriques sur limage dun point lumineux , '' rev . opt . * 26 * , 257277 ( 1947 ) .    </S>",
    "<S> l.  a. poyneer , m.  a. van dam , and j .- </S>",
    "<S> p . </S>",
    "<S> veran , `` experimental verification of the frozen flow atmospheric turbulence assumption with use of astronomical adaptive optics telemetry , '' * 26 * , 833 ( 2009 ) .    </S>",
    "<S> l.  a. poyneer and j .- p . </S>",
    "<S> veran , `` kalman filtering to suppress spurious signals in adaptive optics control , '' * 27 * , a223a234 ( 2010 ) . </S>"
  ]
}