{
  "article_text": [
    "compton camera imaging is a promising method to visualize gamma - ray sources from @xmath0 to several @xmath1 .",
    "it can be applied in many fields , such as nuclear medicine , visualization of radioactive substances on the ground , and gamma - ray astronomy @xcite .",
    "high - resolution compton cameras utilizing silicon ( si ) and cadmium telluride ( cdte ) semiconductor detectors @xcite will be installed in the next - generation x - ray observatory astro - h @xcite , which is scheduled for launch in 2015 .    however , imaging is not straightforward because only a small portion of photons are absorbed after compton scattering and the direction of arrival of each photon is not known directly . from a single event , the scattering angle of the photon",
    "is computed using the energies of the recoil electron and the scattered photon . after collecting these observations ,",
    "some type of information processing is needed to reconstruct the image . since photon detection is a stochastic process ,",
    "the image reconstruction problem can be formulated as a statistical estimation problem @xcite . in this study , we follow the framework developed for comptel @xcite , and employ the bin - mode estimation ( bme ) method . although the number of bins can be large , in astronomy applications where the distances from the gamma - ray sources are large , the number of bins is significantly reduced and the bme method is applied effectively .",
    "one of the popular estimation methods in statistics is the maximum likelihood estimation ( mle ) .",
    "comptel also employed the mle . in order to compute the mle of the compton camera imaging ,",
    "a natural approach is to use the expectation - maximization ( em ) algorithm @xcite .",
    "however , the convergence speed of the em algorithm is not fast in general , and a line search algorithm was combined with the em algorithm in comptel . in this work ,",
    "we propose two different approaches to speed up the convergence of the em algorithm : one is a different acceleration method to compute the mle by approximating the fisher s scoring method @xcite and the other is to use the maximum a posteriori ( map ) estimation instead of the mle .",
    "the map estimation is another popular estimation method in bayesian statistics @xcite .",
    "we employed the dirichlet distribution as the prior , and a modified em algorithm is used to compute the map estimate .",
    "these two proposed bme methods are tested through numerical simulations .",
    "the rest of the paper is organized as follows .",
    "section [ sec : compton camera imaging ] explains the compton camera system , while section [ sec : bme methods ] overviews bme methods for image reconstruction .",
    "section [ sec : numerical results ] shows numerical results with some discussions , and section [ sec : conclusion ] concludes the paper .",
    "figure [ fig : comptoncamera ] schematically depicts the compton camera system .",
    "our target system has multiple scatterers and absorbers .",
    "a photon is detected when it is scattered at one of the scatterers and absorbed by one of the absorbers . even if a number of photons arrive , only a little portion of them are detected after compton scattering .",
    "suppose a photon from @xmath2 ( in equatorial coordinates ) is detected .",
    "it is initially scattered by one of the scatterers at @xmath3 and then absorbed by one of the absorbers at @xmath4 .",
    "we denote the distance between the scatterer and the absorber as @xmath5 .",
    "let @xmath6 and @xmath7 be the energies of the recoil electron and the scattered photon , respectively .",
    "the scattering angle @xmath8 is denoted as @xmath9 where @xmath10 and @xmath11 are the mass of an electron and the speed of light , respectively .",
    "the goal of compton camera imaging is to reconstruct the gamma - ray intensity map on the celestial sphere from collected information .",
    "difficulties arise because only the scattering angle @xmath8 is computed from a single event .    in this paper",
    ", we assume the distance from each gamma - ray source to the compton camera system is sufficiently large .",
    "this assumption is valid for astronomy applications . under this assumption ,",
    "only the direction of arrival is important , therefore , not @xmath12 and @xmath13 , but only the relative position normalized by the distance @xmath5 , i.e. , @xmath14 , is considered . the information of each detected photon is summarized into @xmath15 .",
    "furthermore @xmath2 and @xmath16 are assumed to be quantized into bins .",
    "below , @xmath17 and @xmath16 are bin indices .",
    "we first introduce the model of the measurement process @xcite .",
    "when a gamma - ray photon from @xmath17 is detected , it falls into a bin @xmath16 with some probability .",
    "let @xmath18 be the intensity of the gamma rays at pixel @xmath17 of the celestial sphere and @xmath19 be the number of photons detected at bin @xmath16 for a time interval .",
    "the distribution of @xmath19 follows a poisson distribution as @xmath20 where @xmath21 is the probability that a photon from @xmath17 is absorbed at @xmath16 .",
    "we modify the above framework in this work .",
    "let us re - parameterize @xmath21 and @xmath18 and define @xmath22 as follows @xmath23 where @xmath24 is the probability that a photon from pixel @xmath17 is absorbed by the camera .",
    "all @xmath25 , @xmath26 , and @xmath22 are multinomial distributions ( i.e. , they are non - negative and each distribution sums up to one ) conditional to the events that a photon is absorbed by the camera .",
    "more precisely , @xmath25 is the probability that an absorbed photon arrives from @xmath17 , @xmath27 is the probability that an absorbed photon from @xmath17 is detected at @xmath16 , and @xmath22 is the probability that an absorbed photon is detected at @xmath16 . after observing many photons , we collect information of @xmath22 . if @xmath26 is known , it is possible to estimate @xmath25 .    the goal of compton camera imaging is to reconstruct the intensity map @xmath18 .",
    "the distribution @xmath25 differs from @xmath18 because the photons which were not completely absorbed are not included .",
    "however @xmath18 can be easily reconstructed as @xmath28 assuming @xmath24 is known .",
    "thus , we set our goal to estimate @xmath25 from absorbed photons .    in the next section ,",
    "we first show how to prepare @xmath26 and @xmath24 , then explain how to estimate @xmath25 from absorbed photons .",
    "our formulation is based on the bme , where each @xmath16 and @xmath17 is quantized into bins .",
    "the key is how to implement and prepare @xmath26 .",
    "if @xmath12 , @xmath13 , @xmath6 , and @xmath7 are quantized separately , the number of the bins is too large and the bme is not feasible with current computational hardware .",
    "however , under the assumption that the distances from the gamma ray sources are large , it is sufficient to quantify @xmath29 , where @xmath14 and @xmath30 are defined in eq .. the number of bins decreases and the bme becomes feasible without loss to precision . in previous works of comptel , the matrix size was further reduced using geometrical symmetries @xcite but we do not rely on symmetry because the installed camera may have an asymmetric configuration .    the next challenge is how to prepare @xmath26 and @xmath24 . here",
    "we utilize a numerical method .",
    "a compton camera system was simulated and a lot of photons were randomly drawn numerically using software such as geant4 .",
    "the results were accumulated to compute @xmath26 and @xmath24 .",
    "this method is general and easily implemented .",
    "there are other possible methods to compute @xmath26 and @xmath24 .",
    "one of them is to used the numerical integration based on a physical model with the klein - nishina formula .",
    "although the integration is difficult , the resulting distribution is theoretically accurate .",
    "another method is to use a physical system .",
    "when a system is built and tested under a physical environment , the collected data from a set of well - designed experiments can be used to compute @xmath26 and @xmath24 .",
    "next , we discuss the estimation of @xmath25 .",
    "suppose @xmath31 photons are detected independently and @xmath32-th photon is absorbed at @xmath33 , @xmath34 .",
    "the log likelihood function is defined as follows @xmath35 our goal is to estimate @xmath25 from @xmath36 , where @xmath26 is known .",
    "the maximum likelihood estimate ( mle ) of @xmath25 is defined as the distribution @xmath25 that maximizes @xmath37 .",
    "we denote it as @xmath38 .",
    "the em algorithm @xcite is a simple algorithm to compute mle by alternately repeating the expectation ( e- ) step and maximization ( m- ) step .",
    "each step is defined as @xmath39 where @xmath40 starts from @xmath41 and increases by 1 at each iteration .",
    "this algorithm can be found in a literature @xcite .",
    "the log - likelihood is non - decreasing at each update , that is , @xmath42 .",
    "when the difference between @xmath43 and @xmath44 becomes sufficiently small , the update is terminated . in order to measure the difference , we employed the kullback - leibler ( kl ) divergence which is defined as follows , @xmath45 note that the kl divergence is non - negative and becomes 0 if and only if @xmath46 for all @xmath16 .",
    "we stopped the algorithm when @xmath47 is less than @xmath48 .",
    "the reconstructed image is proportional to the intensity map @xmath18 , which is recovered from @xmath38 as @xmath49 .",
    "the convergence speed of the em algorithm is generally slow . in this work",
    ", we implemented an acceleration algorithm which approximates the fisher s scoring method @xcite .",
    "the fisher s method is a second order method , similar to the newton s method , and a faster convergence is expected .",
    "the proposed acceleration method was combined with a line search algorithm as in comptel @xcite .",
    "we show the outline of the acceleration algorithm @xcite .",
    "when @xmath50 is computed from @xmath51 with one em - step , @xmath43 is computed from eq .. then another em - step is run from @xmath51 where @xmath43 is the target distribution . after this em - step ,",
    "a new parameter @xmath52 is obtained , which differs from @xmath50 and the following parameter is computed @xmath53 in most cases @xmath54 is larger than @xmath55 and the em algorithm is accelerated @xcite .",
    "the convergence speeds of the proposed acceleration method and the original em algorithm are compared through numerical simulations in section [ subsec : computational time of algorithms ] .",
    "starting from a strictly positive initial distribution @xmath56 , every component of @xmath38 is strictly positive by definition . ]",
    "however , for astronomy applications , it is natural to assume there are a lot of @xmath41 components . to estimate such a sparse solution",
    ", we used the maximum a posteriori ( map ) estimation , which is a common approach in bayesian statistics @xcite .    setting the prior of @xmath57 as @xmath58",
    ", the map estimation maximizes the posterior probability @xmath59 , which is proportional to @xmath60 .",
    "that is , @xmath61    \\\\              & = \\arg\\max_{\\rho}\\ ,    \\bigl[\\ ,    \\log \\,\\pi(\\rho)+l(\\rho )    \\bigr ] ,    \\end{split } \\ ] ] the dirichlet distribution is the conjugate prior of a multinomial distribution @xcite and is often used as the prior for multinomial distributions .",
    "we use the following symmetric dirichlet distribution with a single parameter @xmath62 as the prior of @xmath25 , @xmath63 where @xmath64 is the number of bins of @xmath17 and @xmath65 . with this prior ,",
    "eq . is rewritten as @xmath66 $ ] .",
    "note that as the number of the samples increases , the log likelihood function defined in eq .",
    "increases , and the influence of the prior becomes relatively small . in the limit @xmath67 , the map estimate becomes identical to the mle .",
    "the em algorithm can be used to compute the map estimate by modifying the m - step as @xmath68.\\end{aligned}\\ ] ] if @xmath69 , the prior is uniform and the map estimation is identical to the mle . however , if @xmath70 , @xmath71 has 0 components .",
    "the number of 0 components tends to increase as @xmath62 decreases .",
    "although the prior in eq . is improper for @xmath72 , the updating rule in eq .",
    "is still valid . in the rest of the paper , we set @xmath73 .",
    "it should be noted that the convergence speed of the above modified em algorithm is generally faster than the original em algorithm .",
    "the map estimates are computed quickly if many components of @xmath25 are 0 .",
    "we show some numerical results in the next section .",
    "we proposed the map estimation in order to promote some components to be 0 , in other word , to have a sparse solution .",
    "one concern is that some weak , possibly distributed gamma - ray sources may be neglected by the map estimation .",
    "when the number of received photons is small , this may be true but the influence of the prior becomes smaller as the number of absorbed photons increases .",
    "if a sufficiently large number of photons are received , the map reconstruction is almost identical to the mle reconstruction and any weak sources would not be neglected .",
    "a compton camera , which consists of 25 si pixel detectors as the scatterers and 25 cdte pixel detectors as the absorbers , was simulated for the numerical experiments ( fig.[fig : layered ] ) .",
    "the size of each detector was identical : 100@xmath74 square and 1.0@xmath74 thick .",
    "all of the detectors were stacked in 2@xmath74 intervals .",
    "each detector was pixellated into @xmath75 channels , and was assumed to have an energy resolution of @xmath76 ( full width at half maximum , fwhm ) , where @xmath77 denotes the energy deposited in the detector .    in order to perform monte carlo simulation , a model of the compton camera has been constructed .",
    "we used our compton camera response generator @xcite , which was implemented using the geant4 toolkit ( version 9.6.p01 ) @xcite on a desktop computer ( mac pro 6-core intel xeon 3.33ghz ) .",
    "the simulations accurately treated the doppler broadening effect of compton scattering @xcite due to the non - zero momentum of the target electron , which degrades the angular resolutions of the compton camera . using this simulation framework , we estimated the angular resolution measure ( arm ) of the simulated compton camera at 2.6 degrees ( fwhm ) for a photon energy of 661.7kev .",
    "the arm is defined as the difference between the reconstructed scattering angle and the actual source direction @xcite .    in the current simulation",
    ", the range of @xmath78 and @xmath79 were restricted between @xmath80 .",
    "it is possible to widen these ranges , but the goal of this work is to build effective estimation methods .",
    "thus , we stayed within @xmath80 . in a real system",
    ", events from outside the field of view can be discarded by physical shielding and/or background rejection techniques based on compton camera analysis prior to image reconstruction .",
    ".design of bins of @xmath17 and @xmath16 . [ cols=\"^,^,^,^,^,^ \" , ]     b where 147,515 photons were absorbed .",
    "( a ) mle reconstructions , ( b ) map reconstructions ( 137 pixels were positive ) , ( c ) image reconstruction with the back projection , and ( d ) line - profiles of images in ( a ) and ( c ) compared with the true source profile .",
    "each image was normalized to have @xmath81 as its maximum . ]",
    "c where 150,449 photons were absorbed .",
    "( a ) mle reconstructions , ( b ) map reconstructions ( 134 pixels were positive ) , ( c ) image reconstruction with the back projection , and ( d ) line - profiles of images in ( a ) and ( c ) compared with the true source profile .",
    "each image was normalized to have @xmath81 as its maximum . ]",
    "d where 4,337,897 photons were absorbed .",
    "( a ) mle reconstruction , ( b ) map reconstruction ( 668 pixels are positive ) , ( c ) image reconstruction with the back projection , and ( d ) true distributed gamma - ray source shown comparison .",
    "( e ) line - profiles of images in ( a ) and ( c ) compared with the true source profile .",
    "each image was normalized to have @xmath81 as its maximum ]      numerical results of the image reconstructions were shown in previous subsections .",
    "we provide some discussions in this subsection .",
    "firstly , we explain why we set the parameter @xmath62 to @xmath41 for the map estimation .",
    "dirichlet prior with @xmath69 corresponds to the mle , and the solution becomes sparser as @xmath62 decreases . since the bayesian prior becomes improper for @xmath72 , it is not preferable to use negative @xmath62 . from the experimental results , the map reconstructed images of the map estimation with @xmath73 were almost identical to those of the mle .",
    "we did not show any results for @xmath82 because the images were almost identical , and the results were less sparse .",
    "thus , @xmath62 was set to @xmath41 throughout our experiments .",
    "secondly , we consider the convergence speed .",
    "every bme methods was implemented with an iterative method .",
    "therefore , the convergence speed is characterized with the computational time of one iteration and the number of iterations until the convergence .",
    "one iteration of the accelerated em algorithm takes more time than the original em because it uses a line search algorithm .",
    "one iteration of the map estimation is computed faster than the original em .",
    "this is because the map estimate is sparse .",
    "the e - step shown in eq .",
    "is merely a multiplication of a matrix and a vector , and if the vector is sparse , it can be computed quickly .",
    "this is why the map converged faster than the mle ( accelerated em ) even if the number of iterations was larger than the mle .",
    "however , this effect becomes less evident when the reconstruction is not sparse .",
    "we see that the difference of the computational time was smaller for source ( d ) .",
    "this is because the final reconstructed image was not sparse .",
    "thirdly , we discuss the source distribution .",
    "we have shown numerical results for point sources and a ring source . however , it is known that there is background emission in astronomy .",
    "the proposed method can be applied for the estimation of weak background emission , but a lot of photons must be collected .",
    "this requires a long time for observation and is not realistic in satellite applications . if the distribution form of the background is known , for example uniform , and there are point sources and background emission , it is possible to estimate the point sources and the level of the background by extending our framework",
    ". however , further details are beyond the scope of this paper .    finally , we discuss the quality of the reconstructed images .",
    "the bme reconstructed images were not smooth compared to the back - projections . although our results are less smooth , we observed from the line - profiles that our methods provided good estimates of the positive regions while the back - projection images became positive for the whole space . if we know that the true source is a collection of point sources , it might be possible to estimate their positions as the peaks of the back - projection image",
    "however , if the source is distributed , it is difficult to estimate the region by the back - projection and the proposed bme methods will give better results .",
    "we believe the reason our reconstructions were not smooth partially comes from the size of the simulation . by collecting more photons for @xmath26 and @xmath24",
    ", we will have smoother results .",
    "this is one of our future works .",
    "we have proposed bme methods for compton camera imaging . under the assumption that the distances from the gamma - ray sources are large ,",
    "the number of bins can be reduced , making bme methods effective .",
    "we follow the framework of comptel and applied it to a layered system . additionally , we propose two extensions of the em algorithm : the acceleration of the em algorithm for the mle and the modified em algorithm for the map estimation .",
    "numerical simulations confirm that the accelerated em algorithm converges faster than the original em algorithm , and the map estimate converges quickly into a sparse image .",
    "the proposed methods are promising for astronomy applications .",
    "one of our goal is to apply the propose methods to real astronomy data .",
    "we believe this paper provides a solid framework for the compton camera imaging .",
    "the em algorithm for the mle is a basic approach and we have shown possible directions for extensions . in the current paper , we rely on the situation of the astronomy , where the gamma - ray sources are far from the camera .",
    "but if we can relax this assumption , we may be able to apply similar methods for the measurements of the distribution of @xmath83 in the environment of fukushima@xcite and for medical applications .",
    "this work was supported by jsps grant - in - aid for scientific research on innovative areas , number 25120008 .",
    "28 natexlab#1#1[2]#2 , , , ( ) .",
    ", , , ( ) . , , , ( ) .",
    ", , , ( ) . , , , ( ) .",
    ", , , ( ) . , , ( ) .",
    "jaxa press release , , .",
    ", , , ( ) . , , ph.d .",
    "thesis , the university of tokyo , .",
    ", , , ( ) . , , , ( ) .",
    ", , , ( ) . , , , ( ) .",
    ", , , ( ) . , , , ( ) .",
    ", , , ( ) . , , , , ( ) . , ,",
    ", wiley series in probability and statistics , , edition , .",
    ", , , wiley series in probability and statistics , , .",
    ", , , . , , , , , ( ) .",
    ", , , ( ) .",
    ", , , ( ) . , , , ( ) .",
    ", , , ( ) ."
  ],
  "abstract_text": [
    "<S> we study the image reconstruction problem of a compton camera which consists of semiconductor detectors . </S>",
    "<S> the image reconstruction is formulated as a statistical estimation problem . </S>",
    "<S> we employ a bin - mode estimation ( bme ) and extend an existing framework to a compton camera with multiple scatterers and absorbers . </S>",
    "<S> two estimation algorithms are proposed : an accelerated em algorithm for the maximum likelihood estimation ( mle ) and a modified em algorithm for the maximum a posteriori ( map ) estimation . </S>",
    "<S> numerical simulations demonstrate the potential of the proposed methods .    </S>",
    "<S> compton camera , image reconstruction , expectation maximization , maximum likelihood estimation , maximum a posteriori estimation </S>"
  ]
}