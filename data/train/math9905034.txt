{
  "article_text": [
    "the moduli space @xmath4 of stable curves of genus @xmath5 with @xmath6 marked points is a fascinating object .",
    "mumford @xcite introduced tautological cohomology classes associated to the universal curve @xmath7 .",
    "witten @xcite conjectured and kontsevich @xcite proved that certain intersection numbers of tautological cohomology classes on @xmath4 have a generating function which satisfies the equations of the korteweg - de vries hierarchy ( more precisely , that it is a @xmath8-function of the kdv hierarchy satisfying some additional equations ) .",
    "this remarkable result provided an unexpected link between the algebraic geometry of these moduli spaces and integrable systems .",
    "the spaces @xmath4 can be generalized in two ways .",
    "the first way is by choosing a smooth projective variety @xmath9 and considering the moduli space @xmath10 of stable maps into @xmath9 from genus-@xmath5 , @xmath6-pointed , stable curves .",
    "when @xmath9 is a point , @xmath11 reduces to @xmath4 .",
    "the second way to generalize @xmath4 is by considering the moduli space @xmath12 of higher spin curves introduced in  @xcite . roughly speaking ,",
    "a higher spin curve , or @xmath0-spin curve , is an algebraic curve with an @xmath0-th root of its ( suitably twisted ) canonical bundle . forgetting the @xmath0-spin structure reduces @xmath12 to @xmath4 .",
    "it is natural to ask if kontsevich s theorem admits a generalization to either of these two cases .",
    "the case of @xmath10 remains mysterious .",
    "it gives the gromov - witten invariants of @xmath9 and their so - called gravitational descendants , which assemble into a generating function whose exponential is an analog of a @xmath8-function . in the case where @xmath9 is a point , one recovers the @xmath8-function of the @xmath13 hierarchy by kontsevich s theorem .",
    "more generally , there is a conjecture of eguchi , hori , and xiong @xcite and of s.  katz which essentially states that this generating function is a highest weight vector for a particular representation of the virasoro algebra .",
    "presumably , there is some analog of an integrable system which gives rise to this virasoro algebra action , should the conjecture hold .    on the other hand ,",
    "the @xmath13 hierarchy is just the first in a series of integrable hierarchies @xmath1 , where @xmath14 , called the generalized @xmath13 , or gelfand - dickey hierarchies . in the case of @xmath15 ,",
    "this is the usual kdv hierarchy .",
    "each of these hierarchies has a formal solution , corresponding to the unique @xmath8-function which satisfies an additional equation known as the string ( or puncture ) equation . in @xcite ,",
    "witten formulated a generalization of his original conjecture , suggesting that for each @xmath16 , there should exist moduli spaces and cohomology classes on them whose intersection numbers assemble into this @xmath8-function of the @xmath1 hierarchy .",
    "the corresponding moduli spaces of higher spin curves have recently been constructed in  @xcite . in this paper",
    "we present a precise mathematical formulation of the generalized witten conjecture and prove it in several special cases including , in particular , the case of genus zero .",
    "motivated by analogy with the construction of gromov - witten invariants from the moduli space of stable maps , we introduce axioms which must be satisfied by a cohomology class @xmath17 ( called the _ virtual class _ ) on the moduli space of @xmath0-spin curves @xmath12 in order to obtain a cohomological field theory ( cohft ) of rank @xmath18 in the sense of kontsevich and manin @xcite .",
    "this virtual class on @xmath12 is an analog of the gromov - witten classes of a variety @xmath9 ( i.e. , the pullbacks via the evaluation maps of elements in @xmath19 ) .",
    "we realize this virtual class in genus zero as the top chern class of a tautological bundle over @xmath20 associated to the @xmath0-spin structure .",
    "this yields a frobenius manifold structure @xcite on the state space of the cohft  which is isomorphic to the frobenius manifold associated to the versal deformation of the @xmath3 singularity @xcite .",
    "this is an indication of the existence of a kind of `` mirror symmetry '' between the moduli space of @xmath0-spin curves and singularities . according to manin  @xcite",
    "`` isomorphisms of frobenius manifolds of different classes remain the most direct expression of various mirror phenomena . '' proving the generalized witten conjecture for all genera would provide further evidence of this relationship .    as in the case of gromov - witten invariants",
    ", one can construct a potential function from the integrals of the class @xmath17 on different components of @xmath21 to form the _ small phase space _ of the theory .",
    "the _ large phase space _ is constructed by introducing the tautological classes @xmath22 associated to canonical sections of the universal curve @xmath23 , and can be regarded as a parameter space for a family of cohfts .",
    "a _ very large phase space _",
    "( see @xcite ) , parametrizing an even larger space of cohfts , is obtained by considering classes @xmath24 , associated to the hodge bundles , and classes @xmath25 , associated to the universal spin structure .",
    "we show that the corresponding potential function satisfies analogs of the puncture and dilaton equations and also a new differential equation obtained from a universal relation involving the class @xmath26 .",
    "these relations hold in all genera .",
    "topological recursion relations are also obtained from presentations of these classes in terms of boundary classes in low genera .",
    "finally , using the new relation involving @xmath26 , we show that the genus zero part of the large phase space potential @xmath27 is completely determined by the geometry , and this potential agrees with the generalized witten conjecture in genus zero .",
    "some of our constructions were foreshadowed by witten , who formulated his conjecture even before the relevant moduli spaces and cohomology classes had been constructed , just as he had done in the case of the topological sigma model and quantum cohomology .",
    "we prove that his conjecture has a precise algebro - geometric foundation , just as in the case of gromov - witten theory .",
    "witten also outlined a formal argument to justify his conjecture in genus zero .",
    "our work shows that the formulas that he ultimately obtained for the large phase space potential function in genus zero are indeed correct , provided that the geometric objects involved are suitably interpreted .",
    "this is nontrivial even in genus zero because the underlying moduli spaces are not schemes , but stacks .",
    "we proceed further to prove relations between various tautological classes associated to the @xmath0-spin structures and to derive differential equations for the potential function associated to them .",
    "notice also that one can introduce moduli spaces @xmath28 of stable @xmath0-spin maps into a variety @xmath9 , where one combines the data of both the stable maps and the @xmath0-spin structures .",
    "the analogous construction on these spaces yields a frobenius manifold which combines gromov - witten invariants ( and quantum cohomology ) with the @xmath1 hierarchies .",
    "work in this direction is in progress @xcite .    in the first section of this paper",
    ", we review the moduli space @xmath12 of genus @xmath29 stable @xmath0-spin curves , which was introduced in @xcite .",
    "we also discuss the stratification of the boundary of @xmath30 .",
    "the boundary strata fall into two distinct categories  the so - called neveu - schwarz and ramond types .    in the second section",
    "we introduce canonical morphisms , tautological bundles , tautological cohomology classes , and cohomology classes associated to the boundary strata of @xmath12 , and we derive a new relation involving the @xmath26 class .    in the third section",
    ", we define a cohomological field theory ( cohft ) in the sense of kontsevich and manin , its small phase space potential function , and the associativity ( wdvv ) equation .",
    "we then review the construction of gromov - witten invariants for the moduli space of stable maps and define the large and very large phase spaces in the gromov - witten theory .",
    "motivated by this example , we explain how one may construct a cohft  and the various potential functions from analogous intersection numbers on @xmath12 , assuming that the virtual class @xmath17 exists .    in the fourth section we state",
    "axioms which @xmath17 must satisfy in order to obtain a cohft .",
    "we show that these axioms give a complete cohft  with a flat identity , and we construct the class @xmath17 in genus zero , as well as in the case @xmath15 .",
    "in the fifth section , we obtain analogs of the string and dilaton equations for this @xmath0-spin cohft , and we find a new equation based on the relation involving the @xmath26 class .",
    "we also prove the analog of topological recursion relations in genus zero .    in the sixth section",
    ", we use the new relation for the class @xmath26 to completely determine the genus - zero part of the large phase space potential .",
    "finally , in the seventh section , we give a precise formulation of the generalized witten conjecture and prove that the genus - zero , large phase space potential of the @xmath0-spin cohft  yields a solution to the semiclassical limit of the @xmath1 hierarchy , thereby proving the witten conjecture in genus zero .",
    "we conclude with our own @xmath31-algebra conjecture , a @xmath1-analog of a refinement of the virasoro conjecture @xcite .",
    "we would like to thank d.  abramovich , m.  adler , b.  dubrovin , j.  figueroa - ofarrill , e.  getzler , a.  kabanov , yu .",
    "manin , p.  van  moerbeke , a.  polishchuk , m.  rosellen , j.  stasheff , and y.  zhang for useful exchanges .",
    "we would also like to thank heidi jarvis for help with proofreading and typesetting this paper .",
    "thanks the max - planck - institut fr mathematik in bonn for hospitality and financial support .",
    "in this section , we review the definition and some of the basic properties of the moduli space @xmath12 of genus @xmath5 , @xmath6-pointed , stable @xmath0-spin curves .",
    "as the definition of @xmath12 is rather involved , we motivate it by starting with an intuitive approach to @xmath0-spin curves and their moduli space .",
    "a smooth @xmath0-spin curve is essentially just a curve with an @xmath0-th root of the canonical bundle @xmath32 ( suitably twisted ) . in other words , it is a pair @xmath33 where @xmath34 is a smooth curve and @xmath35 is a line bundle on @xmath34 such that @xmath36 is isomorphic to the canonical bundle @xmath32 . given a collection of integers @xmath37 , an @xmath6-pointed smooth @xmath0-spin curve of type @xmath38 is a smooth @xmath6-pointed curve @xmath39 with a line bundle @xmath35 on @xmath34 , such that @xmath36 is isomorphic to @xmath40 . for degree reasons such a bundle exists only if @xmath41 is divisible by @xmath0 .",
    "when this condition is met , there are @xmath42 choices of @xmath35 on @xmath34 .",
    "if we want to compactify the space of smooth @xmath0-spin curves by allowing the curve @xmath34 to degenerate to a stable curve , the above definition of an @xmath0-spin structure is insufficient . in particular",
    ", there is often no line bundle @xmath35 such that @xmath36 is isomorphic to @xmath43 , even when the degree condition is satisfied .",
    "one possible solution  replacing line bundles by arbitrary rank - one , torsion - free sheaves  permits too many potential candidates .",
    "the correct structure required in this case amounts essentially to an explicit choice of isomorphism ( or homomorphism when @xmath35 is not locally free ) @xmath44 , with some additional technical restrictions described in definitions [ def1 ] and [ def2 ] .",
    "there are two very different types of behavior of this torsion - free sheaf @xmath35 near a node @xmath45 . when it is still locally free , the sheaf @xmath35 is said to be _ ramond _ at the node @xmath46 .",
    "if the sheaf @xmath35 is not locally free at @xmath46 , it is called _ neveu - schwarz_.    in the ramond case , the homomorphism @xmath47 is still an isomorphism ( near the node @xmath46 ) , but in the neveu - schwarz case it can not be an isomorphism . the local structure of the sheaf @xmath35 near a neveu - schwarz node can be described as follows .    near the node @xmath46",
    ", the curve @xmath34 has two coordinates @xmath48 and @xmath49 , such that @xmath50 ; and the sheaf @xmath32 ( or @xmath51 ) is locally generated by @xmath52 . near @xmath46 the sheaf @xmath35 is generated by two elements @xmath53 and @xmath54 supported on the @xmath48 and @xmath49 branches respectively ( that is , @xmath55 ) .",
    "the two generators may be chosen so that the homomorphism @xmath56 takes @xmath57 to @xmath58 , and so that @xmath47 takes @xmath59 to @xmath60 , where @xmath61 is the order of vanishing of @xmath47 at the node @xmath46 .",
    "one more difficulty arises when @xmath0 is not prime  in this case the moduli of stable curves with @xmath0-spin structure , as described above , is not smooth .",
    "the remedy is to include all @xmath62-spin structures for every @xmath62 dividing @xmath0 , satisfying some natural compatibility conditions .",
    "this is described in definition [ def2 ] .",
    "we now give the definition of @xmath0-spin curves .",
    "[ def : prestable ] a _ prestable curve _ is a reduced , complete , algebraic curve with at worst nodes as singularities .",
    "[ def1 ] let @xmath39 be a prestable , @xmath6-pointed , algebraic curve , @xmath63 be a rank - one , torsion - free sheaf on @xmath34 , and @xmath64 be a collection of integers .",
    "a _ @xmath62-th root of @xmath63 of type @xmath65 _ is a pair @xmath66 , where @xmath67 is a rank - one , torsion - free sheaf , and @xmath47 is an @xmath68-module homomorphism @xmath69 with the following properties :    * @xmath70 * @xmath47 is an isomorphism on the locus of @xmath34 where @xmath67 is locally free * for every point @xmath71 where @xmath67 is not free , the length of the cokernel of @xmath47 at @xmath72 is @xmath73 .",
    "the condition on the cokernel amounts essentially to the condition that the order of vanishing of @xmath47 at a node should be @xmath62 . for any @xmath62-th root @xmath74 of type @xmath65 , and for any @xmath75 congruent to @xmath76",
    ", we can construct a unique @xmath62-th root @xmath77 of type @xmath75 simply by taking @xmath78 .",
    "consequently , the moduli of curves with @xmath62-th roots of a bundle @xmath63 of type @xmath65 is canonically isomorphic to the moduli of curves with @xmath62-th roots of type @xmath75 .",
    "therefore , unless otherwise stated , we will always assume the type @xmath65 of a @xmath62-th root has the property that @xmath79 for all @xmath80 .",
    "unfortunately , the moduli space of curves with @xmath62-th roots of a fixed sheaf @xmath63 is not smooth when @xmath62 is not prime , and so we must consider not just roots of a bundle , but rather coherent nets of roots @xcite .",
    "this additional structure suffices to make the moduli space of curves with a coherent net of roots smooth .",
    "[ def2 ] let @xmath63 be a rank - one , torsion - free sheaf on a prestable @xmath6-pointed curve @xmath81 .",
    "a _ coherent net of @xmath0-th roots of @xmath63 of type @xmath82 _ is a pair @xmath83 of a set of sheaves and a set of homomorphisms as follows .",
    "the set of sheaves consists of a rank - one , torsion - free sheaf @xmath84 on @xmath34 for every divisor @xmath62 of @xmath0 ; and the set of homomorphisms consists of an @xmath68-module homomorphism @xmath85 for every pair of divisors @xmath86 of @xmath0 , such that @xmath87 divides @xmath62 .",
    "these sheaves and homomorphisms must satisfy the following conditions :    * @xmath88 and @xmath89 .",
    "* for each divisor @xmath62 of @xmath0 and each divisor @xmath87 of @xmath62 , the homomorphism @xmath90 makes @xmath91 into a @xmath92-th root of @xmath93 of type @xmath75 , where @xmath94 is the reduction of @xmath38 modulo @xmath92 ( i.e. @xmath95 and @xmath96 ) .",
    "* the homomorphisms @xmath97 are compatible .",
    "that is , the diagram @xmath98 commutes for every @xmath99 .",
    "if @xmath0 is prime , then a coherent net of @xmath0-th roots is simply an @xmath0-th root of @xmath63 . even when @xmath62 is not prime , if the root @xmath84 is locally free , then for every divisor @xmath87 of @xmath62 , the sheaf @xmath93 is uniquely determined , up to an automorphism of @xmath93 . in particular , if @xmath100 satisfies the conditions @xmath101 and @xmath102 , then the sheaf @xmath93 is isomorphic to @xmath103 .",
    "an _ @xmath6-pointed , @xmath0-spin curve of type @xmath104 _ is an @xmath6-pointed , prestable curve @xmath81 with a coherent net of @xmath0-th roots of @xmath32 of type @xmath65 , where @xmath32 is the ( canonical ) dualizing sheaf of @xmath34 .",
    "an @xmath0-spin curve is called _ smooth _ if @xmath34 is smooth , and it is called _ stable _ if @xmath34 is stable .",
    "smooth 2-spin curves of type @xmath105 correspond to classical spin curves ( a curve with a theta - characteristic ) @xmath106 , _ with an explicit isomorphism @xmath107 . _",
    "an isomorphism of @xmath0-spin curves @xmath108 of the same type @xmath38 is an isomorphism of pointed curves @xmath109 and a set of sheaf isomorphisms @xmath110 with @xmath111 being the canonical isomorphism @xmath112 and such that the homomorphisms @xmath113 are compatible with all the maps @xmath90 and @xmath114 .",
    "every @xmath0-spin structure on a smooth curve @xmath34 is determined , up to isomorphism , by a choice of a line bundle @xmath115 , such that @xmath116 .",
    "in particular , if @xmath34 has no automorphisms , then the set of isomorphism classes of @xmath0-spin structures ( if non - empty ) of type @xmath65 on @xmath34 is a principal homogeneous space for the group of @xmath0-torsion points of the jacobian of @xmath34 .",
    "thus there are @xmath42 such isomorphism classes .",
    "[ ex : modular ] if @xmath117 and @xmath118 , then @xmath32 is isomorphic to @xmath119 , and a smooth @xmath0-spin curve is just an elliptic curve @xmath34 with a line bundle @xmath115 corresponding to an @xmath0-torsion point of @xmath34 , together with an explicit isomorphism @xmath120 .",
    "in particular , the stack of stable , one - pointed @xmath0-spin curves of genus one and type @xmath121 forms a gerbe over the disjoint union of modular curves @xmath122",
    ".    the stack of connected , stable , @xmath6-pointed , @xmath0-spin curves of genus @xmath5 and type @xmath123 is denoted by @xmath124 .",
    "the disjoint union @xmath125 is denoted by @xmath12 .",
    "[ rem : restrict ] as mentioned above , no information is lost by restricting @xmath38 to the range @xmath126 , since when @xmath127 every @xmath0-spin curve of type @xmath38 naturally gives an @xmath0-spin curve of type @xmath100 simply by @xmath128 thus @xmath124 is canonically isomorphic to @xmath129 .      in @xcite",
    "it was shown that @xmath12 is a smooth deligne - mumford stack , finite over @xmath4 , with a projective , coarse moduli space .",
    "for @xmath130 the spaces @xmath124 are irreducible if @xmath131 is odd , and they are the disjoint union of two irreducible components if @xmath132 is even . when @xmath15 ( and in fact , for all even @xmath0 ) this is due to the well - known fact that even and odd theta characteristics on a curve can not be deformed into one another @xcite .",
    "these two components will be denoted @xmath133 and @xmath134 respectively .",
    "when the genus @xmath5 is zero the moduli space @xmath135 is either empty ( if @xmath0 does not divide @xmath136 ) , or is canonically isomorphic to @xmath137 .",
    "note , however , that this isomorphism is not an isomorphism of stacks , since the automorphisms of elements of @xmath124 vary differently from the way that automorphisms of the underlying curves vary .",
    "we will discuss this further in section  [ auto ] . in any case , @xmath135 is always irreducible .",
    "when the genus @xmath5 is one , the space @xmath138 is the disjoint union of @xmath62 irreducible components , where @xmath62 is the number of divisors of @xmath139 .",
    "we will denote the irreducible ( and connected ) component indexed by a divisor @xmath140 of @xmath141 by @xmath142 .",
    "when @xmath38 is zero , as mentioned in example  [ ex : modular ] , the locus of smooth @xmath0-spin curves in this component consists of @xmath6-pointed , elliptic curves with a torsion point of exact order @xmath140 .    throughout this paper we will denote the forgetful morphism by @xmath143 , and the universal curve by @xmath144 .",
    "as in the case of the moduli space of stable curves , the universal curve possesses canonical sections @xmath145 for @xmath146 . unlike the case of stable curves",
    ", however , the universal curve @xmath147 is not obtained by considering @xmath148-pointed @xmath0-spin curves .",
    "the curve @xmath149 is birationally equivalent to @xmath150 , but they are not isomorphic .",
    "there is one other canonical morphism associated to these spaces ; namely , when @xmath62 divides @xmath0 , the morphism @xmath151:{{\\overline{{\\mathcal { m}}}_{g , n}}^{1/r,{\\mathbf{m}}}}\\rto { { \\overline{{{\\mathcal { m}}}}}}^{1/d,\\mathbf{m}'}_{g , n } \\mathrm{\\ and\\ } [ r / d]:{{\\overline{{\\mathcal { m}}}_{g , n}}^{1/r}}\\rto { { \\overline{{{\\mathcal { m}}}}}}^{1/d}_{g , n},\\ ] ] which forgets all of the roots and homomorphisms in the net of @xmath0-th roots except those associated to divisors of @xmath62 . here",
    "@xmath75 is congruent to @xmath76 and @xmath152 for all @xmath153 . in the case",
    "that the underlying curve is smooth , this is equivalent to replacing the line bundle @xmath115 by its @xmath154-th tensor power ( and then taking the tensor product with @xmath155 ) .    the two components @xmath156 and @xmath157 that arise in the case that @xmath139 is even are just the preimages of the spaces of even and odd theta - characteristics in @xmath158 under the map @xmath159:{{\\overline{{{\\mathcal { m}}}}}}^{1/r,\\mathbf{m}}_{g , n } \\rto { { \\overline{{{\\mathcal { m}}}}}}^{1/2,\\mathbf{0}}_{g , n}$ ] .        at any node @xmath46 of a prestable curve @xmath34 ,",
    "there are two types of local behavior of an @xmath0-th root @xmath160 of @xmath161 .",
    "it is either locally free at @xmath46 , in which case the homomorphism @xmath162 is an isomorphism near @xmath46 , or it is torsion - free , but not locally free at @xmath46 . in the locally free case",
    "we will say that the root @xmath115 is _ ramond _ at @xmath46 , and in the non - locally free case it will be called _ neveu - schwarz_.    if the @xmath0-th root sheaf @xmath115 of an @xmath0-spin structure on @xmath34 is ramond at every node of @xmath34 , then the whole net of roots is completely determined ( up to isomorphism ) by the root @xmath163 as follows : @xmath164 and @xmath165 where @xmath166 is the identity homomorphism @xmath167    [ rem : ns ] the neveu - schwarz case is more complicated , in some sense , than the ramond case , but this is compensated for by the fact that the cohomology classes defined by boundary strata with neveu - schwarz nodes factor in a nice combinatorial way .",
    "moreover , the hope of constructing a cohomological field theory from @xmath12 is based on the expectation that one can construct a canonical cohomology class which vanishes on the strata where the @xmath0-spin structure has an @xmath0-th root sheaf which is ramond at some node .",
    "( this would follow from axiom  4 in section  [ axioms ] . )",
    "recall from section  [ overview ] ( see also @xcite ) that near a neveu - schwarz node @xmath46 , an @xmath0-th root @xmath160 of @xmath168 is uniquely determined by an @xmath0-th root @xmath169 of the bundle @xmath170 on the normalization @xmath171 of @xmath34 at the node @xmath46 . here",
    "@xmath172 and @xmath173 are the inverse images of @xmath46 under @xmath174 , and @xmath175 and @xmath176 are non - negative integers and @xmath177 of the papers @xcite and @xcite are @xmath178 and @xmath179 , respectively . ]",
    "which sum to @xmath180 .",
    "if @xmath48 and @xmath49 are local parameters of @xmath34 near the node @xmath46 satisfying the equation @xmath181 , then the sheaf @xmath67 is generated locally by the sections @xmath182 and @xmath183 ; and @xmath184 is generated by @xmath182 on the @xmath48 branch of @xmath185 , and it is generated by @xmath183 on the @xmath49 branch of @xmath185 .",
    "the points @xmath172 and @xmath173 are given by @xmath186 and @xmath187 , respectively , on @xmath185 .",
    "the sheaf @xmath188 is simply @xmath189 modulo torsion ; and @xmath190 is @xmath115 , with @xmath162 induced from @xmath191 by adjointness .",
    "we will call the integers @xmath175 and @xmath176 the _ order of the @xmath0-spin structure _ at the node , along the @xmath48 or @xmath49 branch , respectively .",
    "and @xmath176 of the @xmath0-spin structure along the @xmath48 or @xmath49 branch of a node is not to be confused with the order of vanishing of the structure maps . indeed ,",
    "if the @xmath0-th root bundle @xmath115 is neveu - schwarz at a node , the order of vanishing of the map @xmath192 at that node is exactly @xmath193 . ]    in the case that @xmath194 and @xmath195 are relatively prime , one can show ( see @xcite ) that @xmath196 and @xmath197 uniquely determine the entire net .",
    "however , if @xmath198 , then although @xmath115 still completely determines the neveu - schwarz roots , @xmath62 divides @xmath0 , and the @xmath62-th root @xmath199 of the net is locally free ( ramond ) , as are all roots @xmath200 for every @xmath87 dividing @xmath62 .",
    "in particular , although generators @xmath182 and @xmath183 in @xmath115 determine @xmath201 and @xmath202 , we must identify @xmath203 with @xmath204 .",
    "however , this identification is only determined by @xmath205 up to a non - canonical choice of a @xmath62-th root of unity .",
    "if the normalization @xmath185 at @xmath46 has two connected components , then the @xmath62-th root @xmath206 is determined up to ( non - canonical ) isomorphism by @xmath160 , but if @xmath185 is connected , then @xmath206 is not determined by @xmath160 , since an additional choice of a @xmath62-th root of unity is required to construct @xmath84 from @xmath207 ( see section  [ glue ] ) .",
    "let @xmath74 be an @xmath0-th root of @xmath168 which is ramond at a node @xmath46 of @xmath34 .",
    "the restriction of @xmath67 to @xmath46 gives an exact sequence @xmath208 where @xmath209 is the maximal ideal of the point @xmath46 .",
    "the sheaf @xmath210 is a rank - one , torsion - free sheaf of degree @xmath211 on @xmath34 , and pulling @xmath212 back to the normalization @xmath213 of @xmath34 at @xmath46 gives , modulo torsion , a rank - one , torsion - free sheaf @xmath214 , such that @xmath215 is equal to @xmath212 .",
    "if @xmath48 and @xmath49 are local coordinates on @xmath185 near @xmath172 and @xmath173 respectively , then @xmath216 is locally generated by @xmath217 ( respectively @xmath218 ) .",
    "therefore , the homomorphism @xmath219 induced by @xmath220 , factors through @xmath221    thus the @xmath0-th root @xmath222 can be ramond at the node if and only if @xmath223 and @xmath224 satisfy the degree conditions @xmath225 on every connected component @xmath226 of @xmath185 . in the case",
    "that @xmath222 is ramond , we will define the order of the @xmath0-spin structure at the node to be @xmath227 along both branches of the underlying curve .",
    "similarly , @xmath228 corresponds to the choice @xmath229 . in this special case",
    "there is a residue map that canonically identifies @xmath230 and @xmath231 with @xmath232 .",
    "[ residue ] if @xmath233 is an @xmath0-th root of @xmath168 with @xmath234 for some @xmath80 , then there is an isomorphism @xmath235 which is canonical up to a choice of an @xmath0-th root of unity .",
    "an immediate consequence is the following corollary :    [ trivial ] if @xmath236 is the @xmath80-th section of the universal curve @xmath237 with @xmath238 and @xmath239 for some @xmath80 , then the pullback @xmath240 of the universal @xmath0-th root @xmath115 is a trivial line bundle , isomorphic ( canonically up to a choice of an @xmath0-th root of unity ) to @xmath241 .",
    "( of the proposition ) let @xmath242 be a local parameter on @xmath34 near @xmath72 , so that the sheaf @xmath115 is locally generated by an element @xmath243 which is well defined up to an @xmath0-th root of unity .",
    "define the map @xmath244 by @xmath245 .",
    "it is easy to check that this definition is independent of local parameter , and hence defines a canonical isomorphism .",
    "much of the information about the structure of the boundary of @xmath124 can be encoded in terms of decorated graphs .",
    "recall that the _",
    "( dual ) graph _ of an @xmath6-pointed prestable curve @xmath246 consists of the following elements :    * _ vertices _ , corresponding to the irreducible components of @xmath34 : a vertex @xmath177 is labeled with a non - negative integer @xmath247 , the ( geometric ) genus of the component ; * _ edges _ , corresponding to the nodes of the curve : an edge connects two vertices ( possibly even the same vertex , in which case the edge is called a _ loop _ ) if and only if the corresponding node lies on the associated irreducible components ; * _ tails _ , corresponding to the marked points @xmath248 , @xmath249 : a tail labeled by the integer @xmath80 is attached at the vertex associated to the component of @xmath34 that contains @xmath250 .",
    "a _ half - edge _ of a graph @xmath251 is either a tail or one of the two ends of a `` real '' edge of @xmath251 .",
    "we denote by @xmath252 the set of vertices of @xmath251 and by @xmath253 the number of half - edges of @xmath251 at the vertex @xmath177 .",
    "the following definition describes a class of graphs that are dual graphs of stable pointed curves .",
    "let @xmath251 be a graph .",
    "the number @xmath254 is called the _ genus _ of a graph @xmath251 .    a graph @xmath251 ( not necessarily connected ) is called _ stable _ if @xmath255 for every @xmath256 ( in particular , it satisfies @xmath257 , where @xmath6 is the number of tails of @xmath251 ) .    to describe strata of the moduli space of @xmath0-spin curves , we decorate the graphs with additional data coming from the @xmath0-spin structure .",
    "in particular , the type @xmath258 gives a marking to each of the tails .",
    "fix an integer @xmath259 .",
    "a _ decorated stable graph _ is a stable graph with a marking of each half - edge by a non - negative integer @xmath260 , such that for each edge @xmath140 the marks @xmath175 and @xmath176 of the two half - edges of @xmath140 satisfy @xmath261    as mentioned in section  [ boundary ] , decorated stable graphs with @xmath6 tails and genus @xmath5 correspond to boundary strata in @xmath30 .",
    "given a stable @xmath0-spin curve @xmath262 of type @xmath263 , the _ decorated dual graph _ of @xmath262 is the dual graph @xmath251 of the underlying curve @xmath34 , with the following additional markings .",
    "the @xmath80-th tail is marked by @xmath264 , and each half - edge associated to a node of @xmath34 is marked by the order ( @xmath175 or @xmath176 ) of the @xmath0-spin structure along the branch of the node associated to that half - edge .",
    "let @xmath251 be a connected stable graph ( or a decorated stable graph ) with @xmath6 tails and of genus @xmath5 .",
    "we denote by @xmath265 ( or by @xmath266 ) the closure in @xmath4 ( or in @xmath30 ) of the moduli space of stable curves ( or @xmath0-spin curves ) whose dual graph is @xmath251 .",
    "if @xmath267 is the disjoint union of connected subgraphs @xmath268 then we denote by @xmath269 the product @xmath270 , and similarly @xmath271 .",
    "as mentioned in section [ onepointtwo ] , even in the genus zero case , where there is a unique @xmath0-spin structure of a given type @xmath37 for each genus - zero curve ( provided @xmath38 satisfies the degree requirement @xmath272 ) , the automorphisms of the @xmath0-spin structure ensure that @xmath273 is not isomorphic , as a stack , to @xmath274 .",
    "the automorphisms of @xmath0-spin structures will play an important role later in this paper , particularly in the determination of the degrees of morphisms and the properties of various cohomology classes under restriction and pullback .",
    "consequently , we need to understand the group of automorphisms of an @xmath0-spin curve .    first , we introduce some notation .",
    "let @xmath275 be an @xmath0-spin curve , and let @xmath251 be its decorated dual graph .",
    "let @xmath9 be the set of vertices of @xmath251 and @xmath276 be the set of edges _ which do not start and end at the same vertex _",
    "( i.e. , non - loops ) .",
    "furthermore , for each @xmath277 , denote by @xmath278 the irreducible component of @xmath34 associated to vertex @xmath177 ; and denote by @xmath279 the set of all half - edges attached to @xmath177 in @xmath251 .",
    "for each @xmath280 in @xmath279 let @xmath281 be the point of @xmath278 associated to @xmath280 , and let @xmath282 be the marking of @xmath280 .",
    "finally , for each vertex @xmath177 , if @xmath283 denotes the obvious inclusion , then the @xmath0-spin structure @xmath284 pulls back to a collection @xmath285 of sheaves and morphisms on @xmath278 .",
    "however , these sheaves are not necessarily torsion free . taking the quotient of each sheaf @xmath286 by its torsion submodule",
    "gives a rank - one , torsion - free sheaf , which we denote by @xmath287 .",
    "it is easy to see that the homomorphisms @xmath288 , induced on the @xmath289 from the homomorphisms @xmath290 , make @xmath291 into an @xmath0-spin curve .",
    "we will call @xmath292 the _ restriction of @xmath293 to the curve @xmath278_. any @xmath294 consists of two half - edges @xmath295 and @xmath296 ; and we denote by @xmath297 the integer @xmath298",
    "if the underlying pointed curves @xmath299 of the @xmath0-spin curves @xmath292 have no non - trivial automorphisms ( this is true for a generic curve with @xmath300 ) , then    1 .   for each @xmath277",
    "the automorphism group @xmath301 of @xmath292 is isomorphic to @xmath302 , the group of @xmath0-th roots of unity ; and 2",
    ".   given any orientation of the edges of the dual graph @xmath251 of @xmath262 , the automorphism group @xmath303 of @xmath262 fits into the following exact sequence @xmath304    here the map @xmath305 is defined as follows .",
    "the orientation of each edge @xmath140 determines the choice of half - edges @xmath295 and @xmath296 and of corresponding vertices @xmath306 and @xmath307 ( the unique vertex of @xmath251 attached to @xmath295 or @xmath296 , respectively ) .",
    "the map @xmath305 maps the element @xmath308 to the element @xmath309 .",
    "note that , although the map @xmath305 depends upon the given orientation of the edges of @xmath251 , the kernel of @xmath305 is independent of orientation .    if @xmath310 has no automorphisms , then each term @xmath287 in the @xmath0-spin structure @xmath311 is locally free ( since @xmath278 is smooth ) of rank one and has automorphism group @xmath312 , which acts on @xmath84 by multiplication . however , an automorphism of the @xmath0-spin structure must also be compatible with the structure maps @xmath97 . in particular , compatibility with the isomorphism @xmath313",
    "shows that any automorphism @xmath314 of @xmath115 must satisfy @xmath315 .",
    "moreover , compatibility with @xmath90 shows that @xmath316 for every @xmath87 dividing @xmath62 and @xmath62 dividing @xmath0 .",
    "thus @xmath314 corresponds to some @xmath317 , and for every @xmath62 dividing @xmath0 , the automorphism @xmath318 is just @xmath319 .",
    "this proves the first part of the proposition .    for the second part",
    ", it is easy to see that any automorphism of the whole @xmath0-spin curve @xmath262 induces , by restriction , an automorphism of @xmath292 for each @xmath292 , and the map @xmath320 is injective .    moreover , for any edge @xmath321 corresponding to half edges @xmath322 attached to vertex @xmath323 and @xmath324 attached to vertex @xmath325 , an automorphism @xmath326 of @xmath262 will induce automorphisms @xmath327 and @xmath328 ; and these automorphisms must agree whenever @xmath115 is ramond ( locally free ) at the node @xmath329 corresponding to edge @xmath140 .",
    "similarly , if @xmath84 is ramond at @xmath329 , then @xmath330 must equal @xmath331 .",
    "however , if the sheaf @xmath84 is neveu - schwarz at @xmath329 , then @xmath332 and @xmath333 act on distinct vector spaces ( the sheaf @xmath334 is not the same as @xmath335 ) , and so @xmath84 imposes no compatibility condition on @xmath332 and @xmath333 .",
    "since @xmath84 is ramond at the node @xmath329 precisely when @xmath62 divides both @xmath336 and @xmath337 , we have that the condition imposed by compatibility for @xmath332 and @xmath333 is precisely the equality @xmath338 for @xmath339 it is clear that any @xmath340 which meets this compatibility condition at each edge @xmath321 defines a global automorphism @xmath341 .    of course , since we only care about the kernel of @xmath305 , the right - most term in exact sequence  ( [ eq : auto ] ) might as well include all the edges , including loops .",
    "this is because for any loop @xmath140 , the map @xmath305 will always map every element of @xmath342 to @xmath343 , since the vertices @xmath323 and @xmath325 ( and hence also @xmath332 and @xmath333 ) are the same .    for @xmath0-spin curves of genus @xmath344 and @xmath345 with a generic involution ( i.e. , in @xmath346 and @xmath347 ) , we have the following description of the group of automorphisms .",
    "note that when @xmath348 , degree requirements force @xmath349 to be zero . also when @xmath350 and @xmath351 , degree requirements force @xmath0 to be @xmath345 .    1 .",
    "if the underlying curve @xmath352 of a smooth @xmath0-spin curve @xmath353 of index @xmath354 has no automorphisms other than the elliptic involution , then the automorphism group of @xmath262 is @xmath355 2 .",
    "if the underlying curve @xmath34 of a smooth @xmath345-spin curve @xmath356 has no automorphisms other than the hyperelliptic involution , then the automorphism group of @xmath262 is @xmath357    in the case of @xmath348 , smooth @xmath0-spin curves of type @xmath358 and index @xmath354 correspond to the torsion points of @xmath34 of exact order @xmath354 .",
    "it is well known that the involution @xmath359 acts without fixed points on the points of exact order @xmath354 , unless @xmath354 is @xmath344 or @xmath345 , in which case the involution fixes all @xmath345-torsion points ( including the identity , corresponding to the trivial bundle @xmath360 ) .",
    "it is easy to check ( e.g. , by explicitly writing out the coordinates ) that for sheaves @xmath115 of index @xmath345 ( or @xmath344 ) , corresponding to @xmath345-torsion , there is a canonical choice of isomorphism @xmath361 such that    * @xmath362 is trivial , * any other isomorphism @xmath363 differs from @xmath8 by an element @xmath364 , and * @xmath8 commutes with all elements of @xmath365 .",
    "thus @xmath366 has order @xmath367 and is abelian ; and if @xmath0 is even , then every automorphism has order dividing @xmath0 .",
    "thus the proposition follows in genus @xmath344 .",
    "the proof in genus @xmath345 is similar , but simpler , since every @xmath345-spin structure is fixed by the involution .      in the case of moduli spaces of ordinary stable curves , if a graph @xmath251 is obtained from another graph @xmath368 ( not necessarily connected ) by gluing together two tails of @xmath368 ( thus producing a new edge ) , there is a natural _ gluing morphism _ @xmath369",
    "it corresponds to gluing together the punctures on a curve @xmath370 associated to the two tails , and thus the curve @xmath371 will have an additional node and two fewer punctures than @xmath34 .",
    "a similar gluing operation sometimes exists for @xmath0-spin curves , but even then we often need to include extra data .",
    "consider the case of an @xmath0-spin curve with a single neveu - schwarz node .",
    "assume the normalization of the underlying curve @xmath34 at the node has two connected components : @xmath372 of genus @xmath373 , and @xmath374 of genus @xmath375 .",
    "the decorated dual graph of the @xmath0-spin curve looks like this @xmath376 the @xmath0-th root bundle @xmath115 factors as @xmath377 , with @xmath378 an @xmath0-th root of @xmath379 on @xmath372 and @xmath380 an @xmath0-th root of @xmath381 on @xmath374 . here",
    "@xmath175 and @xmath176 can easily be calculated ( for degree reasons ) as the unique non - negative integers summing to @xmath180 such that the @xmath0-th roots of the corresponding ( twisted ) canonical bundles exist ; namely , @xmath382 of course , since the degree of the original bundle was divisible by @xmath0 , each of the two relations implies the other .",
    "the neveu - schwarz case occurs exactly when the solutions @xmath175 and @xmath176 to the congruences  ( [ eq : mplus ] ) and  ( [ eq : mminus ] ) lie in @xmath383 ( whereas the ramond case occurs when the solution is @xmath384 , @xmath385)@xcite .",
    "if @xmath386 is one , then these data completely determine the @xmath0-spin structure on @xmath34 , and in a canonical way , so that in this case we have a well - defined gluing morphism @xmath387 if , however , @xmath388 is greater than one , there is no canonical morphism of stacks , as there is in ( [ eq : gluetr ] ) . to construct a gluing morphism",
    "would require an isomorphism @xmath389 that makes @xmath84 ramond at the node .",
    "in particular , @xmath390 must be compatible with the isomorphism @xmath391 and @xmath392 .",
    "we call such an isomorphism @xmath390 a _ gluing datum_.    given a prestable @xmath393-pointed curve @xmath394 ( not necessarily connected ) and a @xmath62-th root @xmath74 of @xmath395 , such that @xmath396 , denote by @xmath397 the curve obtained from @xmath34 by identifying the point @xmath398 with @xmath399 . a _",
    "gluing datum _ for @xmath74 is an isomorphism @xmath400 which is compatible with the @xmath62-th root maps @xmath401    returning to the case of a curve @xmath34 with a single node and two irreducible components , since the normalized curve has two connected components , the root @xmath206 is determined _ up to non - canonical isomorphism _ by @xmath205 .",
    "still , choosing one gluing datum @xmath389 does not give a morphism of stacks because an automorphism of the @xmath0-spin structure on @xmath402 or on @xmath403 changes the gluing datum @xmath390 , and thus induces a different ( but isomorphic ) @xmath0-spin structure on the curve @xmath34 .",
    "in the case of an @xmath0-spin curve @xmath34 with a single component and one node we have the dual graph @xmath404 this determines an @xmath0-spin structure on the normalized curve @xmath185 , with the dual graph @xmath405 if @xmath406 then all roots @xmath84 in the @xmath0-spin structure are of the neveu - schwarz type and we can define the gluing morphism @xmath407 in the obvious way .    however , if @xmath408 is greater than one , then , as mentioned above , an additional gluing datum is required to construct @xmath206 from @xmath409 . in this case , set @xmath410 and @xmath411 and define @xmath412 where @xmath413 and @xmath414 are the inverse images under normalization of the node .",
    "this shows that @xmath415 is a @xmath62-th root of @xmath416 ; that is , @xmath175 and @xmath176 are both replaced with @xmath417 . to construct @xmath84 from @xmath418",
    "we need to choose an isomorphism @xmath419 compatible with the isomorphisms @xmath420 and there are exactly @xmath62 such isomorphisms .",
    "unlike in the case of the tree , an automorphism of the @xmath0-spin structure on the normalized curve induces the same automorphism on both sides of the gluing datum @xmath390 , and thus it preserves @xmath390 .",
    "consequently , we expect @xmath408 gluing morphisms @xmath421 indexed by the set of different choices of @xmath390 . however , in order to construct such a morphism , one needs to be able to define the gluing data in families .",
    "that is , if @xmath422 is the universal curve over @xmath423 , and if @xmath424 and @xmath425 are the loci in of the two sections @xmath426 and @xmath427 of @xmath428 to be glued , then we need to define an isomorphism @xmath429 such an isomorphism exists precisely because @xmath415 corresponds to the graph @xmath430 with @xmath229 . by corollary",
    "[ trivial ] , both @xmath431 and @xmath432 are trivial bundles on @xmath433 , and hence are isomorphic .",
    "thus if @xmath434 is the set of isomorphisms @xmath435 of the sheaf @xmath436 , we have a morphism @xmath437",
    "unless otherwise stated , all cohomology groups in the paper are considered with coefficients in @xmath438 .",
    "there are many natural cohomology classes in @xmath439 ; these include the classes induced by pullback from @xmath4 , as well as classes induced by replacing the canonical ( relative dualizing ) sheaf @xmath440 with @xmath115 in the usual constructions of tautological cohomology classes on @xmath4 .",
    "in particular , we have the @xmath80-th chern classes @xmath441 of the hodge bundle @xmath442 .",
    "however , @xmath443 is not especially well behaved .",
    "instead , we prefer to use the k - theoretic pushforward @xmath444 ( also called @xmath445 ) .",
    "is from algebraic topology and is not to be confused with the sheaf - theoretic _ direct image with compact supports _ , which we never use in this paper . ] recall that for any coherent sheaf @xmath446 on the universal curve @xmath447 , the element @xmath448 of @xmath449 is the difference @xmath450 ( @xmath428 has relative dimension @xmath344 ) . here",
    "@xmath451 is the sheaf whose fiber over a point @xmath72 of the base @xmath124 is the vector space @xmath452 .",
    "serre duality shows that @xmath453 is canonically isomorphic to @xmath454 , and so @xmath455 is a trivial line bundle .",
    "hence @xmath456 in @xmath449 .",
    "therefore , we have an equality of chern polynomials @xmath457 tautological classes @xmath458 are defined as components of the chern character of the hodge bundle @xmath459 ( the even components of @xmath460 vanish by mumford s theorem  @xcite . )",
    "similarly , we define classes @xmath461 as components of the chern character of @xmath462 : @xmath463 here @xmath464 is the euler characteristic @xmath465 of @xmath115 on any geometric fiber @xmath466 of @xmath428 , and by riemann - roch @xmath467    serre duality shows that for any @xmath446 we have @xmath468 , so @xmath469 .",
    "more importantly , for purposes of comparison with witten s calculations of @xcite , in the special case that @xmath470 ( or equivalently , @xmath471 ) , the bundle @xmath472 of @xcite corresponds to @xmath473    in addition to the hodge - like classes , there are those induced by the canonical sections @xmath236 of @xmath474 .",
    "these are classes @xmath475 ( and also class @xmath476 for each divisor @xmath62 of @xmath0 ) . when working in @xmath477 , we will abuse notation and use @xmath478 to indicate the line bundle @xmath479 , and @xmath480 the line bundle @xmath240",
    ". finally , there are the boundary classes . in particular , if @xmath481 is a partition of @xmath482 into two subsets , we denote by @xmath483 the class of the divisor associated to @xmath0-spin curves with the dual graph @xmath251 of the form @xmath484 , with @xmath485 and @xmath486 .",
    "of course there is an obvious equality : @xmath487 since the graph @xmath251 is a tree , there is a unique choice of @xmath175 and @xmath176 , given the original type @xmath38 and the partition @xmath481 .    if @xmath5 is greater than @xmath344 , and if @xmath0 and all of the @xmath264 are even , then the moduli space has two components , @xmath133 and @xmath134",
    ". if @xmath488 then @xmath483 is the sum of four divisors  two on each irreducible component of the moduli space . in particular , there are two divisors in @xmath489 with dual graph @xmath484 .",
    "the first is the locus where both vertices of the graph ( irreducible components of the underlying curve ) are endowed with an even @xmath0-spin structure ; and the second is where both vertices are endowed with an odd @xmath0-spin structure .",
    "similarly , in @xmath490 , the two divisors correspond to the two ways of endowing the vertices with @xmath0-spin structures of differing parities .    in the case of @xmath491 and @xmath130 , the divisor",
    "@xmath492 is the sum of only two divisors , corresponding to the parity of the @xmath0-spin structure on the other vertex ( of genus @xmath5 ) . if @xmath493 then @xmath494 is the sum of ( potentially many ) divisors corresponding to the choices of index for the @xmath0-spin structure on the vertex of genus @xmath344 , ( as well as the choices of index or parity for the remaining vertex )",
    ".    finally , denote by @xmath495 the divisor associated to the graph @xmath496 with the @xmath0-spin structure inducing @xmath497 on the normalization ; and denote the divisor corresponding to the ramond root by @xmath498 .",
    "of @xmath499 differs from the index @xmath354 of @xmath500 in @xcite by one . ]",
    "the divisor @xmath495 is not necessarily irreducible , since different choices of gluing will induce distinct ( and disjoint ) divisors , all in @xmath495 .",
    "again , there is an obvious equality : @xmath501      the following proposition describes relations between various elements in the picard group of @xmath124 .",
    "it is a straightforward generalization of the corresponding result for the case @xmath502 proved in @xcite .    *",
    "the forgetful map @xmath503 induces an injection @xmath504 * let @xmath505 denote the pullback to @xmath477 of the class in @xmath506 associated to the union of all strata in @xmath4 with the dual graph @xmath507 , with @xmath508 .",
    "the pullback @xmath505 is related to @xmath483 as follows .",
    "@xmath509 where @xmath175 is determined by @xmath510 , and @xmath511 , as in section  [ twocomp ] .",
    "* let @xmath512 be the pullback to @xmath477 of the divisor of all curves in @xmath4 with dual graph @xmath513 .",
    "the pullback @xmath512 can be expressed in terms of the @xmath499 as follows .",
    "@xmath514    the fact that , for an @xmath0-th root @xmath66 of @xmath515 , the map @xmath47 is almost an isomorphism means that @xmath480 and @xmath478 are closely related .    [ bundles ]",
    "the line bundles @xmath516 and @xmath517 on the stack @xmath124 are related by @xmath518 and @xmath519 where @xmath520 is the smallest non - negative integer congruent to @xmath521 .",
    "therefore , in @xmath522 we have @xmath523 and @xmath524    before proving the proposition , we recall the following well - known fact .    [ psi ] let @xmath525 be the universal @xmath6-pointed curve , and @xmath236 the @xmath80-th tautological section of @xmath428 . if @xmath526 is the divisor of @xmath527 associated to @xmath236 , and if @xmath528 is the canonical ( relative dualizing ) sheaf , then @xmath529    ( of lemma [ psi ] ) when @xmath530 the bundle @xmath531 is trivial because the sections are disjoint .",
    "in the case @xmath532 the result follows from the fact that taking residues gives an isomorphism between @xmath533 and @xmath534 .",
    "( of proposition [ bundles ] ) the map @xmath535 pulls back , via @xmath536 , to give @xmath537 since @xmath538 is disjoint from the nodes of @xmath34 , @xmath539 is an isomorphism , even on the boundary strata where @xmath67 fails to be locally free .",
    "consequently , we have @xmath540      [ prop : murelation ] define the boundary divisors @xmath541 and @xmath542 by @xmath543 and @xmath544 where @xmath545 , @xmath546 , and @xmath175 is determined by @xmath547 , and @xmath38 via relation  ( [ eq : mplus ] ) .",
    "then the following relation holds in @xmath477 : @xmath548    the proof of the proposition is almost identical to its counterpart in ( * ? ? ?",
    "* theorem 4.3.3 ) except that @xmath115 is not an @xmath0-th root of @xmath549 , but rather of @xmath550 .",
    "the only extra information necessary to prove the proposition is the content of the following two lemmas and the fact that the divisor we have called @xmath551 is the product @xmath552 in @xcite .",
    "[ deligne ]",
    "let @xmath553 be the universal curve and @xmath554 be deligne s bilinear product defined by @xmath555 if @xmath556 is the image of a section @xmath557 , then for any line bundle @xmath35 on @xmath527 the product @xmath558 is equal to the restriction of @xmath35 to @xmath556 ; that is , it is just @xmath559 .",
    "this is proved in ( * ? ? ?",
    "6.1.3 ) , but it also follows from the fact that when the base is a smooth curve @xmath560 , then @xmath561 is exactly the usual intersection number @xmath562 .",
    "since line bundles on @xmath4 are completely determined by their degree on smooth curves in @xmath4 @xcite , and since in the case of a smooth , one - parameter base the degrees agree , the lemma is true in general .",
    "we have @xmath563    this follows immediately from lemmas [ psi ] and [ deligne ] .",
    "if @xmath564 then classes @xmath565 and @xmath499 vanish ( for all @xmath566 ) , and @xmath567 } \\frac{r}{u_{0;a}}[r-1-(m^++1)(m^-+1)]\\alpha_{0;a } \\\\ & & + \\sum_{1 \\leq i \\leq n } m_i ( r-2-m_i ) \\psi_i.\\end{aligned}\\ ] ]",
    "in this section we begin with a review of the notion of a cohomological field theory ( cohft ) in the sense of kontsevich and manin @xcite .",
    "this is an object which formalizes the expected factorization properties of the theory of topological gravity coupled to topological matter .",
    "the gromov - witten invariants associated to a smooth , projective variety @xmath9 correspond to the physical situation where the matter sector arises from the topological sigma model @xcite .",
    "the analogous intersection numbers associated to the moduli space of @xmath0-spin curves have their physical origins in a different choice of the matter sector .",
    "our goal in this section is to give a precise formulation of these notions in terms of the moduli spaces described above .",
    "a _ ( complete ) cohomological field theory ( cohft ) of rank @xmath62 _ ( denoted by @xmath568 or just @xmath569 ) is a @xmath62-dimensional vector space @xmath570 with a metric @xmath571 and a collection @xmath572 of @xmath6-linear @xmath573-valued forms on @xmath570 @xmath574 defined for stable pairs @xmath575 and satisfying the following axioms * c1c3 * ( where @xmath576 is a fixed basis of @xmath570 , @xmath577 is the inverse of the matrix of the metric @xmath571 in this basis , and the summation convention has been used ) .    1",
    ".   the element @xmath578 is invariant under the action of the symmetric group @xmath579 .",
    "2 .   let @xmath580 be the gluing morphism  ( [ eq : gluing ] ) corresponding to the stable graph @xmath581 and the two graphs @xmath582 and @xmath583 obtained by cutting the edge of @xmath584 .",
    "then the forms @xmath578 satisfy the composition property @xmath585 for all @xmath586 .",
    "3 .   let @xmath587 be the gluing morphism  ( [ eq : gluing ] ) corresponding to the stable graph @xmath588 and the graph @xmath368 obtained by cutting the loop of @xmath589 .",
    "then @xmath590 the pair @xmath569 is called the _ state space _ of the cohft . +",
    "an element @xmath591 is called _ a flat identity _ of the cohft  if , in addition , the following equations hold .",
    "4 .   for all @xmath592 in @xmath570",
    "we have @xmath593 where @xmath594 is the universal curve on @xmath4 and 5 .",
    "@xmath595    a cohft  with flat identity is denoted by @xmath596 a _ genus @xmath597 cohft _ on the state space @xmath569 is the collection of forms @xmath598 that satisfy only those of the equations  ( [ eq : cfttree ] ) ,  ( [ eq : cftloop ] ) ,  ( [ eq : identity ] ) , and  ( [ eq : identity2 ] ) , where @xmath599",
    ".    in general , the state space @xmath570 of cohft  is @xmath600-graded , but here , for simplicity , we are assuming that @xmath570 contains only even elements , since this is the only case that will arise in this paper .",
    "the definition of a cohft  given above has an equivalent dual description in terms of homology .",
    "consider the maps @xmath601 given by @xmath602\\,\\mapsto\\,\\int_{[c]}\\lambda_{g , n}$ ] .",
    "these maps are called the _ ( @xmath6-point ) correlators of the cohft_. a structure of a ( complete ) cohft  on @xmath569 is equivalent to the requirement that these correlators endow @xmath603 with the structure of an algebra over the modular operad @xmath604 in the sense of getzler and kapranov @xcite .",
    "clearly , the definition of a cohomological field theory extends from @xmath454 to more general ground rings @xmath63 .",
    "let @xmath251 be a stable graph , then there is a canonical composition map @xmath605 @xmath606 where @xmath252 denotes the set of vertices of @xmath251 . since the map @xmath605 can be constructed from gluing morphisms  ( [ eq : gluetree ] ) and  ( [ eq : glueloop ] ) , the forms @xmath578 satisfy a restriction property @xmath607 where @xmath608 contracts the factors @xmath609 by means of the inverse of the metric @xmath571 and successive application of equations  ( [ eq : cfttree ] ) and  ( [ eq : cftloop ] ) .",
    "there is a parameter which can be introduced into the definition of a cohft .",
    "this parameter can be regarded as a coupling constant in the theory .",
    "[ lm : couplingconstant ] let @xmath610 be a cohft  with flat identity @xmath611 and let @xmath24 be a nonzero parameter .",
    "if we define @xmath612 , where @xmath613 and @xmath614 then @xmath615 is a cohft  with flat identity .",
    "the proof is obvious .",
    "the _ small phase space potential function _ of the cohft@xmath616 is a formal series @xmath617 $ ] given by @xmath618 where @xmath619 here @xmath620 denotes evaluation , the sum over @xmath6 is understood to be over the stable range , and @xmath621 , where @xmath622 is a basis of @xmath570 .",
    "the small phase space potential function of the cohft@xmath623 associated to @xmath624 as in lemma [ lm : couplingconstant ] may be regarded as an element in @xmath625 $ ] .",
    "all of the information of a genus zero cohft   is encoded in this potential .",
    "@xcite [ thm : wdvvg ] an element @xmath626 in @xmath627 $ ] is the potential of a rank @xmath62 , genus zero cohft  @xmath569 if and only if it contains only terms which are of cubic and higher order in the coordinates @xmath628 ( corresponding to a basis @xmath629 of @xmath570 ) and it satisfies the _ associativity , or wdvv _",
    "( witten - dijkgraaf - verlinde@xmath630 ) equation @xmath631 where @xmath632 is the inverse matrix of the matrix of @xmath571 in the basis @xmath633 , @xmath634 is derivative with respect to @xmath635 , and the summation convention has been used .",
    "conversely , a genus zero cohft  structure on @xmath569 is uniquely determined by its potential @xmath626 , which must satisfy the wdvv equation .",
    "a genus zero cohft  with flat identity is essentially equivalent to endowing the state space @xmath569 with the structure of a formal frobenius manifold @xcite .",
    "the theorem follows from the work of keel @xcite , who proved that @xmath636 is generated by boundary classes and that all relations between boundary divisors arise from lifting the basic codimension one relation on @xmath637 .",
    "higher genus cohftsare not completely determined by their potentials because @xmath573 is not generated by its boundary classes .",
    "nonetheless , getzler @xcite proved that the potential function of a genus one cohft  must satisfy an analogous ( but much more complicated ) equation arising from a codimension - two relation in @xmath638 .",
    "our construction of cohfts  from the moduli space of stable @xmath0-spin curves is guided by analogy with the moduli space of stable maps and gromov - witten invariants .",
    "let us briefly review this construction .",
    "let @xmath9 be a smooth projective variety , @xmath639 , and @xmath571 the poincar pairing .",
    "let @xmath11 be the moduli stack of stable maps into @xmath9 of genus @xmath5 with @xmath6 marked points .",
    "the _ gromov - witten invariants of @xmath9 _ are multilinear maps @xmath640 given by @xmath641^{\\mathrm{vir}}}\\,{\\mathrm{ev}}_1^*\\,\\gamma_1\\cup\\cdots\\cup{\\mathrm{ev}}_n^*\\ , \\gamma_n,\\ ] ] where @xmath642^{\\mathrm{vir}}$ ] is the virtual fundamental class of the moduli stack @xmath11 and @xmath24 is a formal parameter . the corresponding _ small phase space potential _",
    "@xmath643 is defined by  ( [ eq : small ] ) where the genus @xmath5 part is given by @xmath644^{\\mathrm{vir}}}\\ , { \\mathrm{ev}}_1^*\\,{\\mathbf{x}}\\cup\\cdots\\cup{\\mathrm{ev}}_n^*\\,{\\mathbf{x}},\\ ] ] @xmath645 , and @xmath646 is a basis for @xmath570 such that @xmath611 is the identity element .",
    "if @xmath9 is a convex variety , then @xmath647 is a smooth stack and its virtual fundamental class coincides with its topological fundamental class . in this situation",
    ", @xcite shows that @xmath569 forms a genus zero cohft  with potential @xmath626 .",
    "this result can be generalized to higher genera and to more general varieties , as well .    in the usual definition of gromov - witten invariants",
    ", there is no factor of @xmath648 in the definition of the correlators but this factor is inserted into the potential function by hand .",
    "we have chosen our conventions so that this factor appears instead in the correlator but is not explicitly inserted into the potential function .",
    "the _ gravitational descendants _ are defined by twisting the gromov - witten classes with the tautological @xmath22 classes as follows : @xmath649^\\mathrm{vir}}\\!{\\mathrm{ev}}_1^*\\gamma_1\\cup    \\psi_1^{a_1}\\cup\\cdots \\cup   { \\mathrm{ev}}_n^*\\gamma_n \\cup \\psi_n^{a_n}\\ ] ] for all @xmath650 and @xmath651 in @xmath19 .",
    "this gives rise to the _ large phase space potential _",
    "@xmath652 $ ] where @xmath653 and @xmath654 , which is defined by @xmath655 and @xmath656 setting @xmath657 for @xmath658 and @xmath659 reduces the large phase space potential @xmath660 to the small phase space potential @xmath643 .",
    "when @xmath9 is a point , kontsevich s theorem gives that @xmath661 is a @xmath8-function of the @xmath13 hierarchy .",
    "in addition , kontsevich showed that @xmath662 is a highest weight vector for the virasoro lie algebra , a condition which allows one to completely solve for these intersection numbers .",
    "the existence of a similar virasoro algebra action has been conjectured by eguchi , hori , and xiong @xcite in the case where @xmath9 is not a point .",
    "evidence for this conjecture is mounting @xcite .",
    "a _ very large phase space _ has recently been introduced in @xcite for the case where @xmath9 is a point and for more general varieties in @xcite by including variables corresponding to the hodge classes @xmath458 as well .",
    "these additional variables parametrize an even larger family of cohfts  than just the large phase space coordinates @xcite .",
    "we will shortly introduce , in addition , variables associated to the @xmath0-spin structure ( see  ( [ eq : vlarge ] ) ) .",
    "we perform an analogous construction of a very large phase space where the role of the moduli space of stable maps @xmath10 is played by the moduli space of stable @xmath0-spin curves @xmath21 .",
    "unlike the moduli space of general stable maps , the moduli space of stable @xmath0-spin curves is a smooth stack .",
    "intersection theory is therefore simpler in this case than for the case of stable maps .",
    "however , the difficulty lies instead in the construction of the analogs of the gromov - witten classes .    in the next section",
    ", we will introduce axioms which a collection of cohomology classes ( called a _ virtual class _ ) @xmath663 in @xmath664 must satisfy in order to insure that the following result holds .",
    "[ th : rcft ] let @xmath665 be a vector space of dimension @xmath2 with a basis @xmath666 and metric @xmath667 given by @xmath668 let @xmath663 be a virtual class in @xmath664 satisfying axioms 1 through 5 from the next section , and let @xmath669 be the map which forgets the @xmath0-spin structure .",
    "let @xmath670 be defined by @xmath671 where these forms have values in the ring @xmath672 $ ] , then @xmath673 is a cohft   satisfying axiom c4a .",
    "furthermore , if @xmath674 then @xmath624 is a cohft  with flat identity .",
    "the latter will be called _",
    "the @xmath0-spin cohft_. restricting the @xmath0-spin cohft  to genus zero shows that @xmath675 is endowed with the structure of a frobenius manifold .",
    "this theorem is proved in section [ sec : verify ] .",
    "[ crl : rcft ] let @xmath623 be constructed from @xmath624 above by setting @xmath676 @xmath677 and @xmath678 then @xmath679 is a cohft  satisfying axiom c4a and @xmath615 is a cohft  with flat identity .",
    "this is a direct consequence of lemma [ lm : couplingconstant ] and the previous theorem .",
    "the classes @xmath663 are analogs of the gromov - witten classes in this theory .",
    "the analogs of the gravitational descendants  ( [ eq : gravit ] ) are given by @xmath680 and the large phase space potential function is defined by the equations ( [ eq : lpspotential ] ) and ( [ eq : lpspotentialg ] ) . the small phase space potential function is defined by restricting  ( [ eq : gravspin ] ) to correlators with @xmath681 .",
    "_ we will see that the case of @xmath682 corresponds to the generalized witten conjecture .",
    "this corresponds to the metric @xmath683 and the forms @xmath684 _    the astute reader will notice in the sequel that , strictly speaking , the state space of this @xmath0-spin cohft  ( [ eq : rlambda ] ) should be instead , @xmath685 where @xmath686 is an @xmath0-dimensional vector space with basis @xmath687 and a metric given by @xmath688 however , it follows from the axioms for @xmath17 in section  [ axioms ] that the obvious orthogonal decomposition @xmath689 where @xmath690 is the trivial one - dimensional cohft   with basis @xmath691 , is a direct sum of cohfts .",
    "for this reason , we can ( and will ) restrict ourselves to the state space @xmath692",
    "to endow the pair @xmath693 from theorem  [ th : rcft ] with the structure of a cohft  by equation  ( [ eq : rlambda ] ) , we must define cohomology classes @xmath663 .",
    "we will call this collection of classes an _",
    "@xmath0-spin virtual class_. it should satisfy the axioms described below .",
    "_ throughout this section , we will restrict ourselves to the case where the coupling constant @xmath24 is @xmath694 , unless otherwise stated .",
    "_ this is done purely for convenience as analogous results hold for general @xmath24 as well .",
    "an _ @xmath0-spin virtual class _ is an assignment of a cohomology class @xmath695 to every genus @xmath5 , stable , decorated graph @xmath251 with @xmath6-tails . here ,",
    "if the tails of @xmath251 are marked with the @xmath6-tuple @xmath123 , then the dimension @xmath556 is @xmath696 and @xmath697 is the number of connected components of @xmath251 . in the special case where @xmath251 has one vertex and no edges ,",
    "we denote @xmath698 by @xmath663 .",
    "these classes must satisfy the axioms below .",
    "let @xmath251 be a connected , genus @xmath5 , stable , decorated graph with @xmath6 tails .",
    "let @xmath699 denote the set of edges of @xmath251 .",
    "for each edge @xmath140 of @xmath251 , let @xmath700 , where @xmath701 is an integer decorating a half - edge of @xmath140 .",
    "the classes @xmath702 and @xmath703 are related by @xmath704 where @xmath705 is the canonical inclusion map .",
    "let @xmath251 be a stable , decorated graph which is the disjoint union of connected graphs @xmath706 , then the classes @xmath707 and @xmath708 are related by @xmath709    consider the universal @xmath0-spin structure @xmath710 on the universal curve @xmath711 . for each irreducible ( and connected ) component of @xmath712 ( denoted here by @xmath713 for some index @xmath62 ) , if @xmath714 on @xmath713 , then @xmath715 restricted to @xmath713 is @xmath716 , the top chern class of the bundle with fiber @xmath717 at @xmath718 , \\in { \\overline{{{\\mathcal { m}}}}}^{1/r}_{g , n}$ ]",
    ".    given any genus @xmath5 decorated stable graph @xmath251 with @xmath6 tails marked with @xmath38 , we have a diagram @xmath719 where @xmath720 is the stack of stable curves with graph @xmath368 , the graph obtained by cutting all edges of @xmath251 , and @xmath721 is the stack of stable @xmath0-spin curves with graph @xmath368 ( still marked with @xmath722 on each half edge ) .",
    "@xmath723 is the following morphism : the fiber product consists of triples of an @xmath0-spin curve @xmath724 , a stable curve @xmath725 , and a morphism @xmath726 , making @xmath185 into the normalization of @xmath34 .",
    "also , the dual graphs of @xmath34 and @xmath185 are @xmath251 and @xmath368 , respectively .",
    "the associated @xmath0-spin curve in @xmath721 is simply @xmath727 .",
    "we require that @xmath728 where @xmath699 is the set of edges of @xmath251 that are cut in @xmath368 .",
    "[ vanish ] if @xmath251 contains a tail marked with @xmath729 , then @xmath730    [ forget ] let @xmath731 be a stable graph whose @xmath80-th tail is marked by @xmath732 , @xmath251 be the stable graph obtained by removing the @xmath80-th tail , and @xmath733 be the forgetful morphism .",
    "the classes @xmath734 and @xmath735 are related by @xmath736    [ rem : virt ]    1 .",
    "the factor of @xmath737 in axiom 1 arises from the fact that the right hand square in equation ( [ eq : cutting ] ) is not quite cartesian .",
    "rather , because of ramification of @xmath72 over @xmath738 , we have that for any cohomology class @xmath739 on @xmath21 , @xmath740 2 .",
    "the astute reader will notice in axiom 3 that , unlike the case of a tree , if @xmath251 contains a loop and if the @xmath0-spin structure is ramond at the corresponding node , the dimensions @xmath741 and @xmath742 of the virtual classes @xmath707 and @xmath743 are different .",
    "thus axiom 3 actually requires the vanishing of both @xmath744 and @xmath743 in this case .",
    "of course , for the ramond case , axiom 4 already requires the vanishing of @xmath743 , since the cut half - edges are both marked with @xmath2 .",
    "thus for any graph ( tree or otherwise ) , in the ramond case axiom 3 amounts essentially to the requirement that @xmath745 vanish .",
    "although the vanishing of @xmath746 or @xmath747 is often called concavity , the serre dual @xmath748 , corresponding to witten s sheaf @xmath749 in @xcite , is convex @xmath750 vanishes ) exactly when @xmath115 is concave .",
    "moreover , @xmath751 .",
    "therefore , we use the term convex to describe the case when @xmath752 .",
    "4 .   one might think that the class @xmath753 would be a good candidate for a virtual class , since it coincides with @xmath17 in the convex case . however , this is not the case ( see section  [ sec : m11 ] ) .",
    "5 .   witten has described @xcite an analytic construction of a class that he calls the `` top chern class , '' but it is not clear that this class satisfies the above axioms .",
    "witten s index - like construction is reminiscent of the analytic construction of a virtual fundamental class of the moduli space of stable maps in the theory of gromov - witten invariants .",
    "ideally , one should be able to construct @xmath17 by methods similar to those used in algebraic constructions of the fundamental class .",
    "although , as explained in remark  [ rem : restrict ] , the restriction @xmath754 does not change the moduli space @xmath12 , it does give a different choice of @xmath17 . indeed , replacing @xmath264 by @xmath755 changes the dimension of @xmath17 by @xmath344 and corresponds ( up to a multiplicative constant ) to the first descendant of the classes associated to @xmath264 .",
    "thus on a given moduli space @xmath12 there are potentially several ( but still only finitely many , for dimensional reasons ) choices of @xmath17 and the corresponding @xmath756 . however , without the restriction @xmath757 , the corresponding metric @xmath571 is not necessarily invertible , and several other unusual considerations also arise .",
    "these issues will be treated in a forthcoming paper @xcite . in the remainder of this paper",
    ", we will assume that @xmath758 except where explicitly stated otherwise .      in this section",
    "we give a proof of theorem  [ th : rcft ] , first for the case where @xmath760 , and then in general .",
    "let @xmath761 be a cohomology class on @xmath12 satisfying the axioms of section  [ axioms ] .",
    "we will show that the collection of classes @xmath762 given by  ( [ eq : rlambda ] ) satisfies the cohft  axioms c1c4 with state space @xmath759 .",
    "axiom c1 clearly holds by the definition of @xmath762 .",
    "let @xmath763 be the gluing morphism  ( [ eq : gluetree ] ) .",
    "condition  ( [ eq : cfttree ] ) of axiom c2 is equivalent to @xmath764 for all @xmath765 and @xmath766 .",
    "consider the decorated stable graph @xmath767 and denote the graph obtained from cutting its edge by @xmath768 where @xmath769 since the spaces @xmath770 are non - empty for @xmath771 only when @xmath772 are determined by the conditions  ( [ eq : mplus ] ) and  ( [ eq : mminus ] ) , the sum in the right - hand side of equation  ( [ eq : axiomtwo ] ) has only one non - vanishing term . by the definition of the metric @xmath571  ( [ eq : metric ] ) ,",
    "axiom  c2 reduces to the following : @xmath773 with @xmath774 . in other words",
    ", we must show that @xmath775 where we have the diagram @xmath776 and the map @xmath777 is @xmath778 .",
    "however , if we let @xmath779 be @xmath780 , then @xmath781 this gives  ( [ eq : axiomtwo ] ) ; therefore , axiom  c2 is verified .",
    "the statement  ( [ eq : cftloop ] ) of axiom  c3 is equivalent by  ( [ eq : rlambda ] ) and  ( [ eq : metric ] ) to @xmath782 where @xmath783 is the gluing morphism  ( [ eq : glueloop ] ) and @xmath784    let @xmath785 be decorated stable graphs .",
    "let @xmath368 and @xmath786 be the corresponding underlying ( undecorated ) graphs , respectively .",
    "we have the commuting diagram    & & _",
    "( r-2)/2 m^+ < r f _ , m^+ & ^ & _ ( r-2)/2m^+ < r ^1/r _ , m^+ & ^ & ^1/r_g , n + & _ p_1 + _ ( r-2)/2 m^+<r^1/r _ & & ^p & & ^p & & ^p + &",
    "_ p_2 + & & _ & _ & _ & _ i & _ g , n . +    where @xmath787 .",
    "therefore , if @xmath788 is defined to be @xmath780 , then @xmath789 this proves axiom  c3 . to prove axiom  c4a ,",
    "consider the cartesian square @xmath790 by  ( [ eq : lambda ] ) and axiom  5 ( forgetting tails ) we have the required equation  ( [ eq : identity ] ) @xmath791 finally , a direct calculation yields axiom 4b ( see proposition [ prop : potential ] ) .",
    "the proofs of axioms c1 and c4a remain the same .",
    "we only need to prove axioms c2 and c3 . before doing so",
    ", we will need a lemma on regular imbeddings and base change .",
    "[ lm : imbeddings ] let @xmath80 be a regular imbedding , and let    y & _ & x + ^ & & ^ + y & ^i & x    be a cartesian square with @xmath428 and @xmath792 proper and flat , and @xmath793 a coherent sheaf on @xmath794 , flat over @xmath34 . if @xmath34 and @xmath795 both carry an ample invertible sheaf , then the chern character commutes with base change , that is @xmath796 .",
    "first , we claim that because @xmath80 is a regular imbedding it has finite tor dimension ; that is , there is an integer @xmath797 such that for every coherent @xmath68-module @xmath446 , the @xmath798-modules @xmath799 vanish for @xmath800 .",
    "this can be seen as follows .",
    "we may assume that @xmath34 is @xmath801 and @xmath795 is @xmath802 for some regular element @xmath48 in a ring @xmath511 .",
    "this gives the free resolution @xmath803 of @xmath798 , and shows @xmath80 has finite tor dimension .    since @xmath428 is flat , the sheaves @xmath804 and @xmath798 are tor independent over @xmath34 ; that is , @xmath805 for all @xmath806 .",
    "let @xmath807 and @xmath808 be the left derived functors of @xmath809 and @xmath810 , respectively .",
    "proposition 5.13 of @xcite states that if @xmath80 has finite tor dimension , and if @xmath804 and @xmath798 are tor - independent over @xmath34 , then @xmath811 .",
    "however , since @xmath67 is flat over @xmath34 , we have @xmath812 ; and since @xmath807 commutes with the chern character , the lemma holds .",
    "now we prove that axioms c2 and c3 hold .",
    "first consider the cartesian square    _ & ^ & + ^ & & ^ + ^1/r _ & _ & ^1/r_g , n ,    where @xmath428 is the universal curve .",
    "let @xmath813 be the @xmath0-th root from the universal @xmath0-spin structure on @xmath814 .",
    "the morphism @xmath428 is projective , and @xmath815 carries an ample invertible line bundle @xcite , so lemma [ lm : imbeddings ] gives @xmath816 .",
    "note that @xmath817 is the @xmath0-th root from the universal @xmath0-spin structure @xmath818 .",
    "let @xmath819 be the fiber product @xmath820 we have    _ & & _ f + & & ^ + & & _ f & & _ + & & j & & + ^1/r _ & ^p_1 & f & & ^1/r _ , +    where @xmath821 is defined to be the universal curve over @xmath721 , and @xmath822 and @xmath823 are the fibered products @xmath824 and @xmath825 , respectively .",
    "the morphism @xmath826 is just normalization , and in fact , if @xmath827 is the normalization of @xmath818 , then we have the following fibered diagram ( all rectangles are cartesian ) . and @xmath826 were called @xmath828 and @xmath174 , respectively , but we have renamed them here in order to avoid confusion with the cohomology classes @xmath461 and @xmath458 . ]    _ & _ _ 1 & _ f & _ & _ + ^ & & ^ & & ^ _ + & & _ f & & _ + & & ^ & & ^ + ^1/r _ & ^p_1 & f & ^ & ^1/r _",
    "+    moreover , if @xmath829 , @xmath830 , @xmath831 , @xmath832 , and @xmath833 are the @xmath0-th roots of the universal @xmath0-spin structures on @xmath821 , @xmath818 , @xmath834 , @xmath823 , and @xmath822 , respectively , we have @xmath835 . also , since @xmath826 is finite , @xmath836 .",
    "since @xmath837 is flat , we have @xmath838 .",
    "also , since @xmath723 is flat @xmath839 . furthermore , @xmath840 .",
    "if @xmath841 is the inclusion map , then the above implies that @xmath842 the previous equation , the fact that @xmath458 on @xmath843 is the lift of @xmath458 on @xmath844 , and the projection formula yield the desired result .",
    "this finishes the proof of theorem  [ th : rcft ] .",
    "as we explained in remark  [ rem : virt].3 , we call the @xmath0-spin structure @xmath284 on the universal curve @xmath845 _ convex _ if @xmath443 is identically zero .",
    "this occurs , for example , when @xmath564 , as is shown in the following proposition .",
    "[ this2 ] let @xmath34 be a prestable curve of genus zero with @xmath6 punctures and markings @xmath846 , such that @xmath847 for all @xmath80 and @xmath848 for all @xmath80 except at most one . then",
    ", if @xmath74 is an @xmath0-th root of @xmath395 , we have @xmath849    the degree of @xmath67 is an integer and is equal to @xmath850 .",
    "thus @xmath851 , and the degree of @xmath67 is strictly negative .",
    "therefore , when @xmath34 is irreducible , @xmath67 has no global sections .",
    "when @xmath34 is not irreducible , but @xmath67 is locally free ( ramond ) at each node , the same argument holds . if @xmath67 is neveu - schwarz at some nodes , then normalization @xmath852 at the nodes of @xmath34 where @xmath67 is not locally free gives @xmath853 , where @xmath446 is locally free on @xmath185 .",
    "restricting @xmath446 to @xmath185 we obtain an @xmath0-th root of @xmath854 , where the points @xmath855 are either marked points or inverse images of nodes , and thus the collection @xmath856 still meets the hypotheses of the proposition , but now @xmath446 is locally free on each component , and hence has no global sections . since @xmath174 is finite , @xmath857 .",
    "the previous proposition shows that if a class @xmath17 on @xmath858 satisfying axioms  15 exists , then by axiom  2 it must be the top chern class of the bundle with fiber @xmath717 at @xmath718 \\in { \\overline{{{\\mathcal { m}}}}}^{1/r}_{0,n}$ ] . in this case",
    ", it does indeed satisfy the required properties .",
    "[ thm : gzero ] define cohomology classes on @xmath858 by @xmath859 where @xmath860 and @xmath115 is the @xmath0-th root sheaf of the universal @xmath0-spin structure",
    ". then the collection of classes @xmath707 defined by  ( [ eq : cvgamma ] ) for decorated stable graphs of genus zero satisfies axioms  15 .",
    "it is clear from the construction of the classes @xmath707 that they satisfy axiom  2 ( convexity ) .",
    "axiom 1 follows from the fact that since @xmath861 , the top - dimensional chern class @xmath862 of @xmath863 , is simply the product of the top - dimensional classes of @xmath864 and @xmath865 .",
    "now we will show that axiom 3 holds .",
    "if @xmath115 is the @xmath0-th root from the universal @xmath0-spin structure on @xmath866 , then since @xmath564 , @xmath115 is convex . repeating the argument in the proof of axiom  3 in section  [ sec : generalcohft ] with the chern character replaced by the top chern class yields @xmath867 where @xmath868 denotes the edge set of @xmath251",
    "also , we can compute the degree of @xmath869 from the diagram    & & f & ^ & ^1/r _ + & ^p_1 + ^1/r _ & & ^ & & ^p _ + & ^p_2 + & & _ & & _ .",
    "the morphism @xmath870 has degree @xmath344 , since @xmath251 is a tree , and therefore @xmath837 also has degree @xmath344 .",
    "the morphism @xmath871 has degree @xmath872 , as can be seen from the fact that the coarse moduli space map induced by @xmath871 has degree @xmath344 , and there are @xmath873 automorphisms of a generic @xmath0-spin structure .",
    "thus the map @xmath874 also has degree @xmath875 , the map @xmath876 has degree @xmath877 , so @xmath723 has degree exactly @xmath878 .",
    "now we can compute @xmath879 using equation  ( [ eq : muformula ] ) ( replacing @xmath880 with @xmath881 ) to obtain @xmath882 as desired .",
    "all that remains to check is axiom 4 ( vanishing ) .",
    "let @xmath72 be a point corresponding to a tail marked by @xmath883 .",
    "taking the tensor product of @xmath115 with the exact sequence @xmath884 gives the exact sequence @xmath885 where @xmath886 .",
    "thus @xmath212 corresponds to a root with @xmath250 marked by @xmath887 . since @xmath888 , and",
    "since the residue isomorphism  ( [ eq : residue ] ) @xmath889 shows that @xmath890 is a trivial bundle , we have @xmath891 by proposition [ this2 ] the sheaves @xmath115 and @xmath212 are both convex ; thus @xmath892 and @xmath893 are both locally free and have the same chern classes in all dimensions .",
    "however , the vector bundle @xmath894 has dimension @xmath895 , and so @xmath896 .",
    "this gives axiom 4 .      in this section",
    "we will calculate the virtual class on @xmath897 from the axioms .",
    "let @xmath898 be the decorated graph as in  ( [ eq : loopgr ] ) with the underlying graph @xmath899 with one tail , one node of genus zero , and one loop whose one half - edge is marked with @xmath175 and the other with @xmath176 given by  ( [ eq : mneg ] ) .",
    "the stack @xmath900 is a disjoint union @xmath901 , where the component indexed by @xmath62 has a generic geometric point corresponding to a smooth @xmath0-spin curve @xmath902 with @xmath903 isomorphic to @xmath904 .",
    "that is , @xmath115 is a @xmath62-torsion point of the jacobian of @xmath34 . since @xmath115 has global sections if and only if @xmath905 , the case of @xmath906 is convex .",
    "since the dimension  ( [ eq : deg ] ) of the virtual class @xmath907 is @xmath358 , we have that @xmath908 for @xmath906 .",
    "moreover , consider the graph @xmath909 . by axiom 3 , @xmath910 , where @xmath911 is @xmath909 with the loop cut .",
    "since both the half - edges of the cut loop will be labeled by @xmath2 , by axiom 4 the corresponding class must vanish .",
    "therefore , the ( ramond ) case of @xmath909 with a trivial gluing ( i.e. , @xmath912 ) yields @xmath913 since all the remaining ramond components have @xmath914 , and there are @xmath2 of them . since @xmath915 ,",
    "this means @xmath916 is also equal to @xmath917 .",
    "_ notice that this differs from the top chern class of the bundle @xmath918 . _    now , the map @xmath919 has degree @xmath920 , and @xmath921 has degree @xmath922 . the latter is @xmath920 times the number of points of order precisely @xmath62 on the jacobian of the underlying curve .",
    "thus @xmath923 therefore , @xmath924 and we conclude that @xmath925    equation ( [ eq : m11calc ] ) is consistent with the prediction from cohftstated in equation ( [ eq : m11cohft ] ) .      in this section we will show that in the case of theta - characteristics ( i.e. , when @xmath15 ) there exists a unique virtual class @xmath926 satisfying the axioms of section  [ axioms ] .",
    "[ th : rtwo ] the collection of cohomology classes @xmath927 satisfies axioms  15 of section  [ axioms ] if and only if @xmath928 for @xmath929 , and for @xmath502 the class @xmath930 belongs to @xmath931 and is given by @xmath932    let us show first that the conditions of the theorem are necessary . if @xmath933 , then by axiom  4 , @xmath934 must vanish ; therefore , we can assume that @xmath935 . in this case",
    "the dimension @xmath556 ( given in equation  ( [ eq : deg ] ) ) of the class @xmath936 is equal to zero , and since @xmath937 has two connected components ( @xmath938 and @xmath939 it will be sufficient to find @xmath940 for two graphs @xmath941 and @xmath582 , such that the intersections @xmath942 and @xmath943 are non - empty .",
    "let @xmath941 be the graph with one genus - zero vertex , @xmath6 tails , and @xmath5 neveu - schwarz ( i.e. , all half - edges are decorated with zeroes ) loops . in this case , @xmath944 in  ( [ eq : cutting ] ) , so by axiom  3 ( cutting edges ) the class @xmath945 pulls back to @xmath946 , where @xmath947 is the graph with one vertex of genus zero and @xmath948 tails .",
    "since the genus is zero , the universal square root @xmath67 of @xmath549 on the universal curve over @xmath949 is convex by proposition [ this2 ] .",
    "therefore , if @xmath868 is the set of edges of @xmath941 , we have @xmath950 where the first equality follows from axiom 1 , the second from axiom 3 , and the third from axiom 2 . to find @xmath951 consider the graph @xmath582 with a single vertex of genus one , @xmath6 tails , and @xmath952 neveu - schwarz loops .",
    "axiom  3 again shows that @xmath953 pulls back to @xmath954 , where @xmath955 has a single vertex of genus one and @xmath956 tails . since @xmath935 , axiom  5 ( forgetting tails ) shows that @xmath951 is a pullback from @xmath957 , and @xmath958 by equation ( [ eq : m11 ] ) .",
    "now let us show that the classes @xmath934 defined above for @xmath15 indeed satisfy axioms  15 .",
    "axiom  2 ( convexity ) holds when @xmath959 , since in this case the class has dimension @xmath358 , and if @xmath67 is convex ( and , therefore , even ) @xmath960 and @xmath961 as required .    if @xmath929 then @xmath67 is not convex on the universal curve over @xmath962 for any @xmath963 . in particular , consider the degenerate curve of genus @xmath5 which has two irreducible components @xmath868 and @xmath964 joined at a single node , the component @xmath868 of genus zero , containing all @xmath6 marked points , and the component @xmath964 of genus @xmath5 . for degree reasons the node must be neveu - schwarz , and so @xmath67 corresponds to @xmath965 , for @xmath966 a square root of type @xmath38 of @xmath967 , and for @xmath968 a theta - characteristic on @xmath964 .",
    "in general , @xmath968 has non - zero global sections .",
    "thus @xmath67 also has non - zero global sections , and the universal square root is not convex .    when @xmath564 and @xmath969 , the sheaf @xmath67 is convex by proposition [ this2 ] . by theorem [ thm : gzero ]",
    "( and axiom 4 ) the class @xmath970 vanishes , and so agrees with our definition of @xmath934 .",
    "axiom  1 holds because of the simple observation that the parity of a root @xmath67 over a curve with the graph @xmath971 is equal to the sum modulo @xmath345 of the parities of the restrictions of @xmath67 to the components corresponding to @xmath582 and @xmath583 .    to prove axiom  3",
    ", we may assume that @xmath972 , and it is sufficient to check the case that @xmath251 has only one edge .",
    "we have by definition @xmath973 and @xmath974 for @xmath251 a tree .",
    "let @xmath819 be defined as in equation ( [ eq : fdef ] ) .",
    "the canonical morphism @xmath975 is actually an isomorphism if @xmath251 is a tree , and so we get @xmath976 since the parity of @xmath977 does not change when restricting to the normalization . in the case of a loop ,",
    "there are two subcases .",
    "first when @xmath978 , @xmath819 is isomorphic to two copies of @xmath979 ( because of the two choices of gluing data  see section [ sec : nsrnodes ] ) .",
    "consequently , @xmath723 has degree @xmath345 if @xmath980 . in the second case",
    "@xmath981 , and @xmath819 is isomorphic to @xmath979 , so @xmath723 has degree @xmath344 . also , @xmath982 is @xmath983 if @xmath984 , and @xmath985 if @xmath986 .",
    "thus , when @xmath987 , @xmath988 as desired .",
    "when @xmath986 , the two choices of gluing give different parities .",
    "since parity is deformation invariant , this can be seen by degenerating to the special case of the curve @xmath34 , whose partial normalization @xmath185 at one node @xmath46 consists of two irreducible components joined at a single node @xmath46 .",
    "one component @xmath964 is of genus @xmath952 and contains the marked points @xmath989 .",
    "the other component @xmath990 is of genus zero and contains marked points @xmath172 and @xmath173 .",
    "degree reasons force the node to be neveu - schwarz , and so @xmath196 is simply a direct sum @xmath991 .",
    "moreover , since @xmath992 is a square root of @xmath993 of type @xmath994 , @xmath995 must be trivial ( @xmath996 ) .",
    "gluing @xmath995 via @xmath997 and @xmath417 yields the trivial bundle @xmath998 and another non - trivial bundle @xmath999 of degree zero , respectively .",
    "consequently , @xmath1000 .",
    "since the parities of @xmath1001 and @xmath1002 are simply the parities of @xmath1003 and @xmath1004 , respectively , @xmath1001 and @xmath1002 have different parities .",
    "the different parities under the two gluings give @xmath1005 , since @xmath368 has a tail marked with @xmath1006 .",
    "this completes the proof of axiom  3 .",
    "axiom  5 is true because the projection @xmath1007 respects the parity of components .",
    "axiom  4 follows from the definition of the classes @xmath926 .",
    "this theorem together with theorem  [ th : rcft ] implies that in the @xmath15 case we obtain a well - defined complete cohft  of rank one .",
    "it turns out to be the same as the witten - kontsevich rank - one cohft  of the pure topological gravity .",
    "namely , we have the following result ( cf .  also  @xcite ) .",
    "[ cor : rtwo ] the class @xmath1008 of the @xmath345-spin cohft  given by  ( [ eq : rlambda ] ) is equal to @xmath344 if @xmath1009 and @xmath358 otherwise .",
    "we only need to check the case @xmath1009 .",
    "since the class has dimension @xmath358 , equation  ( [ eq : rlambda ] ) gives @xmath1010 where @xmath1011 are the numbers of even / odd theta characteristics on a smooth curve of genus @xmath5 and the last factor of @xmath1012 is the local ( orbifold ) degree of the map @xmath72 near a generic point of @xmath158 .    in section  [ sec : kdvr ]",
    "we will see that this corollary together with kontsevich s theorem gives the generalized witten conjecture for @xmath15 .",
    "in this section , we use relations between boundary classes and tautological classes in order to derive recursion relations between intersection numbers on the moduli space of stable @xmath0-spin curves . throughout this section",
    ", we assume the existence of a virtual class @xmath17 satisfying axioms 15 of section  [ axioms ] .",
    "this class was shown in section  [ vc ] to exist in genus zero for arbitrary @xmath0 , and in arbitrary genus for @xmath15 .",
    "let @xmath1013 be the @xmath0-spin cohft  with the standard basis @xmath1014 described in corollary [ crl : rcft ]",
    ".    we will find it convenient to introduce the notion of a very large phase space potential in this section . for all @xmath1015 in @xmath1016 ,",
    "define @xmath1017 where @xmath1018 and @xmath1019 . here",
    "@xmath1020 where the classes @xmath458 and @xmath461 are defined by  ( [ eq : nu ] ) and  ( [ eq : mu ] ) as components of the chern characters of the hodge bundle and its @xmath0-spin analog .",
    "these expressions should be understood as formal power series in variables @xmath1021 .",
    "the correlators are defined by @xmath1022 where @xmath1023 . in particular , the _ very large phase space potential _ is @xmath1024 where @xmath1025    the other two potentials are restrictions of @xmath1026 .",
    "the large phase space potential @xmath1027 corresponds to setting all the @xmath1028 and @xmath1029 variables to zero .",
    "the small phase space potential is @xmath1030 where @xmath1031 and all other variables are set to zero .",
    "the function @xmath643 is the small phase space potential of the @xmath0-spin cohft .",
    "it will also be useful to define @xmath1032      we begin with a differential equation arising from the grading .",
    "the dimensions of the moduli spaces and cohomology classes induce a grading on the potential function .",
    "the _ euler vector field _",
    "@xmath868 is the differential operator @xmath1033    the very large phase space potential @xmath1034 satisfies the _ grading equation _",
    "@xmath1035    this follows from the definition of the potential , the dimensions of the cohomology classes , and the dimensions of the moduli spaces @xmath124 .",
    "it encodes the fact that intersection numbers between cohomology classes vanish if the classes do not have proper the dimension .",
    "this equation encodes the fact that the potential function is invariant under the rescaling @xmath1036    this grading shows that our small phase space potential function _ can not _ arise as the small phase space potential associated to the gromov - witten invariants of a smooth , projective variety .",
    "this is because the elements in @xmath1016 have fractional dimension with respect to this euler vector field , whereas cohomology classes of a space always have integral dimension .",
    "we begin by proving the analog of the string equation , the dilaton equation , and a new equation arising from our identity on the @xmath26 class .",
    "[ thm : string ] let @xmath575 be a pair of nonnegative integers such that @xmath1037 .",
    "the following identities are satisfied : @xmath1038 and @xmath1039 where we assume that the terms in the sum containing @xmath1040 with @xmath1041 vanish .",
    "these two equations are equivalent to the _ string ( or puncture ) equation _ @xmath1042 where @xmath1043    similarly , the following identities are satisfied : @xmath1044 and @xmath1045 these two equations are equivalent to the _ dilaton equation _",
    "@xmath1046 where @xmath1047 finally , if @xmath1048 denotes the differential operator @xmath1049 then the following equation holds : @xmath1050    furthermore , @xmath1051\\,=\\,{{\\mathcal l}}_{-1}$ ] .",
    "when restricted to the large phase space ( @xmath1052 ) , the operators @xmath1048 and @xmath1053 become the usual generators @xmath1054 and",
    "@xmath1055 in the virasoro lie algebra .",
    "recall that on the moduli space of stable curves , @xmath4 , the @xmath478 classes ( where @xmath146 ) satisfy the equation @xmath1056 , where @xmath1057 is the image of the @xmath80-th canonical section and @xmath1058 .",
    "let @xmath72 be the forgetful morphism @xmath1059 , then since the class @xmath478 on @xmath124 is the pullback via @xmath72 of the @xmath478 class on @xmath4 , one can lift the same formula to @xmath124 to obtain @xmath1060 , where this equation is now regarded as being on @xmath124 , @xmath1057 is the pullback via @xmath72 of the divisors with the same name on @xmath4 , and @xmath1061 is the forgetful morphism @xmath1062 .",
    "suppose that @xmath1063 .",
    "using the lifting formula and canceling trivial terms , we obtain @xmath1064 since @xmath1065 , we have @xmath1066 where the right hand side is understood to vanish if an exponent is negative .",
    "integration over the fiber of @xmath1067 yields the desired result .",
    "inclusion of the additional @xmath25 and @xmath174 classes into the correlators does not change the argument , since @xmath1068 , and similarly for @xmath458 .",
    "finally , the exceptional cases follow from dimensional considerations and the fact that on @xmath1069 , @xmath17 is the identity element in cohomology provided that @xmath1070 .",
    "the dilaton equation is proved by a similar analysis , where the exceptional case can be computed by using the explicit presentation for @xmath1071 on @xmath1072 to obtain @xmath1073    finally , the equation @xmath1074 is obtained by combining the dilaton equation and the grading equation ( [ eq : grading ] ) .",
    "the new relation for the @xmath26 class yields new equations between correlators .",
    "let @xmath1075 be defined by @xmath1076 relative to the standard basis , and let @xmath1077 .",
    "the following differential equation holds : @xmath1078 where the summation over @xmath1079 and @xmath1080 runs over @xmath1081 .",
    "this is equivalent to the following relations between the correlators :    @xmath1082\\\\ g_+ + g_- = g \\\\",
    "m_+ , m_-    } } \\ , \\frac{1}{2}\\ , { \\langle\\langle\\,{(\\,\\prod_{i\\,\\in\\,i_+}{\\tau_{a_i , m_i}})\\tau_{0,m_+}\\,}\\,\\rangle\\rangle}_{g_+ } \\,\\xi^{m_+,m_-}\\ , { \\langle\\langle\\,{\\tau_{0,m_-}\\ ,    ( \\prod_{j\\,\\in\\,i_-}\\,\\tau_{a_j , m_j})\\,}\\,\\rangle\\rangle}_{g_-}\\\\ & - \\sum_{m_+ , m_- } \\,\\frac{1}{4}\\ , { \\langle\\langle\\,{\\tau_{a_1,m_1}\\,\\cdots\\ , \\tau_{a_n , m_n}\\,\\tau_{0,m_+ } \\tau_{0 ,      m_-}}\\,\\rangle\\rangle}_{g-1}\\ , \\xi^{m_+,m_- } , \\\\\\end{aligned}\\ ] ]    where we use the notation @xmath1083 = \\{1,2,\\ldots , n\\ } .\\ ] ]    the class @xmath1084 which appears above is precisely @xmath565 .",
    "this class vanishes on @xmath124 for @xmath1085 .",
    "the proof follows from the facts that @xmath1086 forms a cohft , and that @xmath174 and @xmath22 are lifts of the analogous classes on the moduli space of stable curves , and from proposition  [ prop : murelation ] .",
    "topological recursion relations are relations between correlators which arise from presentations of tautological classes in terms of boundary classes .",
    "[ thm : trr0 ] the following topological recursion relations hold in genus zero :    @xmath1087    which is equivalent to the differential equation @xmath1088    on @xmath1089 , the class @xmath1071 can be written in terms of boundary classes as @xmath1090 \\\\",
    "n-1 , n \\in i_+ \\\\      1\\,\\in\\,i_-}}\\,\\delta_{0;i_+}.\\ ] ] this equation is obtained from lifting the analogous relation on @xmath274 .",
    "the classes @xmath478 can be written similarly by applying an element of the permutation group @xmath579 .",
    "the recursion relation follows from this presentation and the restriction properties of the @xmath478 to the boundary strata .",
    "the following topological recursion relation holds in genus one : @xmath1091 this is equivalent to @xmath1092    the topological recursion relation for @xmath1093 from  @xcite @xmath1094 can be written as @xmath1095    the proof of the first topological recursion relation arises from the relation on @xmath1096 @xmath1097 \\\\",
    "n-1,n \\in i_+ \\\\ 1 \\in i_-}}\\ , \\delta_{0;i_+},\\ ] ] which is obtained from lifting the analogous relation from @xmath1098 .",
    "the action of @xmath579 yields @xmath478 . this , combined with the restriction properties of the @xmath22 classes , yields the desired result .",
    "the second comes from the presentation of @xmath565 on @xmath1096 @xmath1099 and the restriction properties of @xmath1100 .",
    "these two relations allow one to completely reduce the large phase space potential to the small phase space potential in genus zero and one .",
    "combined with the previous equations , we can compute @xmath1026 in genus zero and one when we set @xmath1101 for all @xmath1102 .",
    "the genus one potential satisfies an analog of the wdvv equation due to getzler @xcite , which arises from relations between codimension - two boundary classes on @xmath1103 . using this equation , dubrovin and",
    "zhang @xcite showed that if the frobenius manifold is semisimple , then the genus - one potential is determined by the frobenius structure . since the frobenius manifold structure on @xmath675 associated to @xmath1104",
    "is known to be semisimple @xcite , @xmath1105 is determined . on the other hand , the latter must vanish due to dimensional considerations . together with the topological recursion relations in genus zero and one , we obtain the following corollary .",
    "let @xmath1106 so that we are on the large phase .",
    "let @xmath1107 .",
    "let @xmath1108 denote the matrix with entries @xmath1109 where @xmath1110 , then @xmath1111    dijkgraaf and witten @xcite write down a formula ( see theorem  15 of @xcite for an explicit proof ) for the large phase space potential @xmath1112 which in our case is @xmath1113 where @xmath1114 .",
    "the term @xmath1115 is equal to the small phase space potential @xmath1105 , evaluated at @xmath1116 for all @xmath1117 , but the small phase potential @xmath1105 vanishes .    in genus 2 , there exist presentations of products of @xmath22 classes in terms of boundary classes @xcite which give rise to topological recursion relations , but , in general , they do not allow one to reduce the computation of the large phase space potential to the computation of the small phase space potential .",
    "in this section , we compute the genus - zero , three- and four - point correlators and show that they completely determine the genus - zero , large phase space potential function @xmath27 .",
    "we roughly follow the outline provided by witten @xcite and are able to rigorously prove the validity of his computations , now that the relevant moduli spaces and classes have been constructed .    _ throughout the rest of this paper , we will consider only the large phase space potential @xmath660 ( setting the other variables @xmath1118 and @xmath1119 of the very large phase space potential to zero ) .",
    "we will also fix the coupling constant @xmath24 as @xmath682 , since this is the value which is relevant to the generalized witten conjecture . _",
    "the following proposition rigorously demonstrates the formulas from @xcite , but the idea of our proof is quite different , as it uses our new relation for the @xmath26 class .",
    "[ prop : potential ] the three - point and four - point correlators of the @xmath0-spin cohftare given by the following formulas : @xmath1120 and @xmath1121 where @xmath1122 is minimum value .",
    "@xmath1089 is nonempty if and only if @xmath1123 , where @xmath766 and @xmath1124 for all @xmath80 . the genus zero correlators are given by @xmath1125 where @xmath1126 is the ( top ) chern class of degree @xmath1127 the class @xmath17 vanishes unless @xmath1128 for all @xmath80 by theorem [ thm : gzero ] .",
    "furthermore , the correlator can only be nonzero if @xmath1129 .    if @xmath1130 then the dimensionality condition becomes @xmath1070 , in which case @xmath17 is the identity .",
    "this proves the first part of the proposition .    if @xmath1131 then the dimensionality condition becomes @xmath1132 if this condition is satisfied then @xmath1133 .",
    "the correlator is @xmath1134    the right hand side can be computed using the relation for the class @xmath26 in proposition  [ prop : murelation ] , which becomes , in genus zero ,    @xmath1135}\\,\\frac{r-1-(m_+ + 1 ) ( m_-+1)}{2 r^2}\\ , \\,\\delta_{0;i_+ } , \\\\\\end{aligned}\\ ] ]    where @xmath1079 and @xmath1080 are uniquely determined by the divisor @xmath1136 .",
    "let @xmath1137 denote the divisor @xmath1138 on @xmath1139 .",
    "plugging in this formula , one obtains ( after doing a little case by case analysis to write @xmath1079 and @xmath1080 in terms of @xmath1140 ) @xmath1141 where @xmath1142 .",
    "since each @xmath1137 is poincar dual to the ( topological ) homology class represented by a point , one has @xmath1143 similarly , each class @xmath478 can be represented by @xmath1137 for some @xmath1144 .",
    "therefore , one obtains    @xmath1145    the right hand side of this equation can be shown to be equal to @xmath1146 , an elementary but not obvious identity .",
    "[ prop : unique ] @xcite the genus zero potential @xmath27 is completely determined by @xmath1147 and the fact that @xmath1148    the large phase space , genus zero potential @xmath27 is completely determined by its values on the small phase space by the topological recursion relations .",
    "let @xmath1104 denote the small phase space potential , which must satisfy the wdvv equation since @xmath17 yields a cohft .",
    "furthermore , the grading equation ( [ eq : grading ] ) shows that the small phase space potential is a polynomial in the variables @xmath1149 of degree of at most @xmath1150 .",
    "one then performs an induction on the degree of the polynomial to show that @xmath1104 is uniquely determined by the above data and the wdvv equation .",
    "the proof is straightforward .",
    "in this section we present a mathematical formulation of the generalized witten conjecture , relating intersection theory on @xmath124 with gelfand - dickey integrable hierarchies and prove this conjecture in various cases .      in order to fix notation and normalization constants for the generalized witten conjecture , we recall the definition of the gelfand - dickey hierarchies @xmath1151 and their special solutions .",
    "a more detailed review can be found , for example , in  @xcite .",
    "fix an integer @xmath1152 and consider the space @xmath1153 of differential operators in @xmath1154 ( the factor @xmath1155 is added for convenience ) , where @xmath1156 are formal functional variables . for every operator @xmath1157 there exists a unique pseudodifferential operator @xmath1158 such that @xmath1159 .",
    "all coefficients @xmath1160 of @xmath1161 are differential polynomials in @xmath1162 .    for a pseudodifferential operator @xmath1163 , denote by @xmath1164 its differential part , and consider the following infinite family of differential equations on @xmath1165 : @xmath1166,\\ ] ] where the constants @xmath1167 have been introduced for convenience .",
    "it can be shown that the corresponding flows on @xmath1165 commute , and thus the following definition makes sense .",
    "the infinite system  ( [ eq : kdv ] ) of partial differential equations with @xmath2 unknown functions @xmath1168 , @xmath1169 , @xmath1170 , @xmath1171 is called the _ @xmath0-th gelfand - dickey hierarchy _ or @xmath1151 .      for @xmath1173 ,",
    "consider the functions @xmath1174 where the residue of a pseudodifferential operator is defined as the coefficient of @xmath1175 .",
    "the functions @xmath1176 can be expressed in terms of @xmath1177 by a triangular system of differential polynomials .",
    "this means that @xmath1177 can be expressed in terms of @xmath1178 in a similar way , and we may regard @xmath1179 as a new system of coordinates for @xmath1165 .",
    "1 .   @xmath1183 , 2 .   the functions @xmath1184 satisfy the equations  ( [ eq : kdv ] ) with @xmath1185 and @xmath1177 related to @xmath1186 via  ( [ eq : v ] ) , 3 .",
    "@xmath1180 satisfies the _ string equation _",
    "@xmath1187 where @xmath1188 .        for",
    "a differential operator @xmath1189 , denote by @xmath1190 the polynomial in a formal variable @xmath72 obtained by replacing @xmath556 with @xmath72 .",
    "the commutator @xmath1191 $ ] of differential operators will be replaced in  ( [ eq : kdv ] ) by the poisson bracket @xmath1192      the corresponding potential function @xmath1196 is defined as the unique function satisfying the string equation  ( [ eq : string ] ) and the condition @xmath1197 , and such that the functions @xmath1195 given by  ( [ eq : v ] ) and @xmath1198 satisfy the equations of the hierarchy  ( [ eq : kdv0 ] ) .      even before the moduli space @xmath124 of @xmath0-spin curves was constructed , witten @xcite conjectured that these moduli spaces would exist , and that intersection numbers on them would assemble into the potential @xmath1180 of the @xmath1151 hierarchy .",
    "now we can give this conjecture the following mathematical formulation .",
    "[ conj ] there exists an @xmath0-spin virtual ( cohomology ) class @xmath17 on @xmath124 satisfying axioms 15 of definition  [ axioms ] , such that the large phase space potential @xmath660 of the @xmath0-spin cohft  ( [ eq : rlambda ] ) coincides with the potential function @xmath1180 of the @xmath1151 hierarchy .",
    "theorem  [ th : rtwo ] shows that when @xmath15 the class given by ( [ eq : cvrtwo ] ) satisfies the axioms of a virtual class , and corollary  [ cor : rtwo ] implies that the large phase space potential of the corresponding @xmath345-spin cohft  is equal to the generating function of tautological intersection numbers on @xmath4 ( the large space potential of pure topological gravity ) . by kontsevich",
    "s theorem  @xcite , this generating function coincides with the potential function of the korteweg - de vries hierarchy , which is the same as the @xmath1172 hierarchy .      in this case , the conjecture means that the genus zero part @xmath27 of the large phase space potential  ( [ eq : lpspotential ] ) of the @xmath0-spin cohft  ( [ eq : rlambda ] ) coincides with the potential @xmath1196 of the semiclassical limit of the @xmath1151 hierarchy .    in genus zero",
    "the virtual class @xmath17 exists by theorem  [ thm : gzero ] . from theorem  [ thm :",
    "string ] it follows that the corresponding potential function @xmath626 satisfies the string equation  ( [ eq : string ] ) .        by proposition  [ prop : unique ] there is a unique formal power series @xmath27 , of the proper grading , satisfying the equations of proposition  [ prop : potential ] , wdvv , and the genus - zero topological recursion relations .",
    "witten @xcite shows by a straightforward computation that any such power series yields a solution of the semiclassical limit of the @xmath1151 hierarchy .",
    "[ cor : frob ] the frobenius manifold structure on @xmath675 , defined by theorems  [ th : rcft ] and  [ thm : gzero ] , is isomorphic to the frobenius structure on the base of the versal deformation of the @xmath3 singularity .",
    "the proof follows from theorem  [ thm : conj0 ] and the fact that the potential of the frobenius structure on the base of the versal deformation of the @xmath3 singularity is equal to the potential @xmath1201 of the semiclassical limit of the @xmath1151 hierarchy ( cf .",
    "@xcite ) .    1 .   the generalized witten conjecture , as it is stated here , should be viewed as a refinement of witten s original formulation of his conjecture @xcite , since it is not clear that his construction yields a class with the desired factorization properties .",
    "the coincidence of frobenius structures given by corollary  [ cor : frob ] appears to be a genus zero manifestation of some mirror phenomenon @xcite , relating the moduli space of @xmath0-spin curves and singularities of type @xmath3 .",
    "3 .   there is additional evidence for conjecture  [ conj ] in genus one for arbitrary @xmath0 .",
    "witten @xcite states that the formula ( [ eq : m11calc ] ) for the intersection numbers when @xmath117 can be derived from the conjecture for all @xmath1202 .",
    "furthermore , when @xmath1203 , it can be shown that equation  ( [ eq : diwiformula ] ) holds for the genus - one part of the potential of the @xmath1 hierarchy ( cf .",
    "the fact that @xmath1180 ( in all genera ) is independent of the variables @xmath1204 for all @xmath1205 is consistent with axiom 4 ( vanishing ) of the virtual class .",
    "the exponential of the @xmath13 potential function is called a @xmath8-function and can be defined as the unique function @xmath1206 annihilated by certain differential operators @xmath1207 , @xmath1208 , generating ( a part of ) the virasoro lie algebra .",
    "this gives an alternate formulation of the original witten conjecture .",
    "similarly , the exponential @xmath1206 of the @xmath1 potential is annihilated by a series of differential operators which forms a so - called @xmath1209-algebra  @xcite ( part of which forms a subalgebra isomorphic to ( half of ) the virasoro algebra ) .",
    "thus we obtain an alternate formulation of the generalized witten conjecture .",
    "( w - algebra conjecture ) there exist a collection of differential operators forming a @xmath1209 algebra ( in which the generators @xmath1210 of the virasoro algebra form a subset ) which annihilates and completely determines @xmath1206 .",
    "b.  dubrovin , y.  zhang , _ bihamiltonian hierarchies in 2d topological field theory at one - loop approximation , _ commun .",
    "* 198 * ( 1998 ) , 311361 .",
    "t.  eguchi , k.  hori , c.  s.  xiong , _ quantum cohomology and the virasoro algebra , _ ` hep - th/9703086 ` .    c.  faber , r.  pandharipande , _ hodge integrals and gromov - witten theory _ , ` math.ag/9810173 ` .",
    "to3em , _ hodge integrals , partition matrices , and the @xmath1212 conjecture _ , ` math.ag/9908052 ` .",
    "w.  fulton , r.  pandharipande , _ notes on stable maps and quantum cohomology _ , ` alg - geom/9608011 ` .",
    "i.  manin , `` frobenius manifolds , quantum cohomology , and moduli spaces , '' amer .",
    "soc . , providence , ri , ( 1999 ) .",
    "to3em , _ three constructions of frobenius manifolds : a comparative study , _ ` math.ag/9801006 ` .",
    "to3em , _ towards an enumerative geometry of the moduli space of curves _ , in `` arithmetic and geometry , '' eds . m.  artin and j.  tate , part ii , progress in math . , vol .",
    "36 , birkhuser , basel ( 1983 ) , 271328 .",
    "e.  witten , _ algebraic geometry associated with matrix models of two - dimensional gravity _",
    ", topological models in modern mathematics ( stony brook , ny , 1991 ) , publish or perish , houston , tx ( 1993 ) , 235269 ."
  ],
  "abstract_text": [
    "<S> we prove the genus zero part of the generalized witten conjecture , relating moduli spaces of higher spin curves to gelfand - dickey hierarchies . </S>",
    "<S> that is , we show that intersection numbers on the moduli space of stable @xmath0-spin curves assemble into a generating function which yields a solution of the semiclassical limit of the @xmath1 equations . </S>",
    "<S> we formulate axioms for a cohomology class on this moduli space which allow one to construct a cohomological field theory of rank @xmath2 in all genera . in genus zero </S>",
    "<S> it produces a frobenius manifold which is isomorphic to the frobenius manifold structure on the base of the versal deformation of the singularity @xmath3 . </S>",
    "<S> we prove analogs of the puncture , dilaton , and topological recursion relations by drawing an analogy with the construction of gromov - witten invariants and quantum cohomology . </S>"
  ]
}