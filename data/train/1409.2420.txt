{
  "article_text": [
    "g.h.b gratefully acknowledges funding from the royal society . n.s.b acknowledges trinity college , cambridge for funding",
    "this work has been supported by the epsrc under grant no .",
    "ep / j003867/1 .",
    "39ifxundefined [ 1 ] ifx#1 ifnum [ 1 ] # 1firstoftwo secondoftwo ifx [ 1 ] # 1firstoftwo secondoftwo `` `` # 1''''@noop [ 0]secondoftwosanitize@url [ 0 ]",
    " + 12$12  & 12#1212_12%12@startlink[1]@endlink[0]@bib@innerbibempty @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop _ _  ( ,  )  pp .   @noop",
    "* * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( )"
  ],
  "abstract_text": [
    "<S> we present an approach to the calculation of arbitrary spectral , thermal and excited state properties within the full configuration interaction quantum monte carlo framework . </S>",
    "<S> this is achieved via an unbiased projection of the hamiltonian eigenvalue problem into a space of stochastically sampled krylov vectors , thus enabling the calculation of real - frequency spectral and thermal properties and avoiding explicit analytic continuation . </S>",
    "<S> we use this approach to calculate temperature - dependent properties and one- and two - body spectral functions for various hubbard models , as well as isolated excited states in _ ab initio _ systems .    </S>",
    "<S> quantum monte carlo ( qmc ) in its various guises , is undoubtedly one of the most important approaches for accurate elucidation of properties for correlated systems@xcite . </S>",
    "<S> however , these successes have focused primarily on the ground state energy and observables which commute with the hamiltonian . </S>",
    "<S> critical importance for a deeper understanding of correlated systems comes from _ dynamic _ correlation functions and spectral quantities . </S>",
    "<S> these mirror how we perceive our environment , namely by perturbing a system and measuring its response  the basis of nearly all spectroscopic and experimental approaches . </S>",
    "<S> this gives us direct insight into optical , magnetic and other beyond - ground - state properties , and allow for direct comparison to experimental results .    </S>",
    "<S> direct access to dynamic properties is a persistent difficulty for qmc approaches in general . while in the absence of a sign problem </S>",
    "<S> , unbiased imaginary - time spectra can be obtained@xcite , the analytic continuation to physical , real - frequency functions is notoriously ill - conditioned and can lead to artefacts and smoothing of features.@xcite for more general fermionic systems , higher temperatures must be simulated to alleviate the sign problem@xcite , while nodal constraints bias towards a particular solution and are difficult to extend to spectra@xcite . </S>",
    "<S> alternatively , projections into effective hamiltonians have been able to obtain a few low - energy states , but again these are isolated states rather than practical approaches for thermal or spectral quantities@xcite , while a modification of the propagator can lead to debilitating timestep issues@xcite .    here </S>",
    "<S> , we present a new qmc approach for computing dynamic correlation functions , temperature - dependent quantities and isolated excited states for correlated quantum systems , even in the presence of a sign - problem . </S>",
    "<S> these correlation functions are unbiased in the limit of large averaging , and exact in the limit of large walker number . </S>",
    "<S> this is achieved by extending the recently developed full configuration interaction quantum monte carlo ( fciqmc ) method@xcite , by combining it with ideas from the dynamical and finite - temperature lanczos ( ftlm ) methods.@xcite the key advantage of the approach is that it avoids any explicit storage over the full hilbert space , instead only storing occupied states in the discretized wavefunction at each snapshot . </S>",
    "<S> this allows for sparsity in the wavefunction to be exploited to minimize memory bottlenecks , which are a primary limitation in conventional approaches which require explicit storage over the space@xcite . </S>",
    "<S> the result is a qmc method which although weakly exponentially scaling , in common with the ground state fciqmc approach , can allow for systems to be treated well outside that possible by conventional means , and retains many of the important features of the parent method@xcite . </S>",
    "<S> these include a cancellation algorithm to ameliorate the sign problem , an absence of time - step error and large - scale parallelism .    </S>",
    "<S> an arbitrary dynamic correlation function is defined as @xmath0 where @xmath1 represents the hamiltonian of the system , @xmath2 is the ground state wavefunction and energy , @xmath3 is a small broadening parameter , and @xmath4 and @xmath5 are arbitrary operators which define the perturbation and observed quantity in the correlation function . in the case of these operators being single annihilation and creation operators </S>",
    "<S> one obtains the single - particle green function , defining the system bandstructure and density of states .    </S>",
    "<S> the aim of our method is to stochastically obtain a projection of the hamiltonian from the complete hilbert space to an effective , reduced dimensionality space , such that it spans the degrees of freedom required to accurately describe the desired spectral or thermal quantity . in this work </S>",
    "<S> , we use a set of stochastically sampled wavefunctions from a fciqmc calculation to define this transformation . </S>",
    "<S> if the initial state of the calculation is a stochastic representation of the wavefunction @xmath6 , then propagation from this state@xcite to the ground state will in principle span all states required to represent the expression in eq .  </S>",
    "<S> [ eq : correlation_function ] , equivalent to the space of ground state and all imaginary - time response vectors . </S>",
    "<S> once the hamiltonian is projected into this space , it can be exactly diagonalized , and the desired correlation function of eq .  </S>",
    "<S> [ eq : correlation_function ] directly constructed in this eigenbasis  the lehmann representation . for thermal quantities </S>",
    "<S> the approach is analogous , with the initial vector taken from the infinite - temperature distribution . </S>",
    "<S> similar themes have been explored within continuum qmc , but applied to accelerate convergence for ground state properties@xcite .    _ </S>",
    "<S> method:- _ an fciqmc iteration consists of stochastically applying a projection operator , @xmath7 , to a walker distribution , denoted at iteration @xmath8 by @xmath9 , such that exact projection is achieved on average , whose distributions we denote as @xmath10@xcite . </S>",
    "<S> the aim is to stochastically sample the krylov subspace @xmath11 . in projector qmc </S>",
    "<S> approaches one samples from the large @xmath12 limit of this subspace , which converges to the ground state . </S>",
    "<S> however , to obtain finite - temperature and dynamic quantities , the aim is now to stochastically project the hamiltonian into the whole sampled krylov subspace , which represents an efficient span of all states of interest , provided that @xmath13 is chosen appropriately .    by averaging the fciqmc walker amplitudes , </S>",
    "<S> the results of an exact propagation are rigorously approached for expectation values which depend linearly on the wavefunction@xcite . in this work , </S>",
    "<S> quadratic quantities are required , but now @xmath14 \\neq \\boldsymbol{\\psi}_i^{\\dagger } \\boldsymbol{\\psi}_j$ ] , due to correlations between walker amplitudes , where @xmath15 $ ] denotes the expectation value . </S>",
    "<S> to compute these , two independent replica sets of walkers are propagated simultaneously ( indexed via superscripts ) , such that the amplitudes are uncorrelated between them@xcite , allowing for unbiased estimates of @xmath16 as @xmath17 $ ] or @xmath18 $ ] . </S>",
    "<S> this approach for static correlation functions has been found to scale without difficulty within fciqmc@xcite .    at </S>",
    "<S> selected iterations in an fciqmc calculation the walker distribution is stored@xcite , and the overlap ( @xmath19 ) and hamiltonian ( @xmath20 ) matrices between these subspace vectors calculated as @xmath21 whilst the overlap matrix estimate is trivial , calculating the @xmath20 matrix exactly is expensive , and so instead it is stochastically sampled in the same manner as spawning steps in fciqmc@xcite . </S>",
    "<S> thus , a simulation provides an estimate of the overlap matrix and the projected hamiltonian in the basis of krylov vectors chosen , and so we denote the method _ krylov projected _ ( kp)-fciqmc . </S>",
    "<S> averaging these quantities over independent simulations can reduce errors in an unbiased manner , resulting in a generalised eigenvalue problem for the projected hamiltonian . </S>",
    "<S> this can be solved by standard techniques ( see supplementary material ) </S>",
    "<S> . many of the eigenvalues of @xmath19 will be very small ( or even negative within stochastic errors ) , since the sampled space becomes increasingly linearly dependent with continued propagation . </S>",
    "<S> we therefore discard these vectors of @xmath19 without substantial loss of information . </S>",
    "<S> we refer to the eigenvectors which are kept as vectors . </S>",
    "<S> we note that although the estimates of @xmath20 and @xmath19 are unbiased , the final eigenvalues will not be because eigenvalues are non - linear functions of these matrices . </S>",
    "<S> however , this bias can be systematically reduced with further averaging of @xmath20 and @xmath19 .    for exact propagation with @xmath22 , our approach will yield results identical to the lanczos method . however , because the method exploits sparsity via a stochastic representation of the wavefunctions , large calculations can often use significantly less memory than an equivalent lanczos calculation , as has been the case for ground - state fciqmc . </S>",
    "<S> although our approach is in theory systematically improvable to exactness for the entire frequency range , in practice this becomes increasingly difficult for higher energy excitations . </S>",
    "<S> this is because high - energy excitations have a small component in the krylov vectors , which decreases exponentially with imaginary time . </S>",
    "<S> this renders them particularly difficult to sample and susceptible to stochastic error in the sampled matrices . despite this limitation </S>",
    "<S> , the approach can nevertheless be expected to obtain near - exact spectra for low - energy excitations in systems out of reach of traditional dynamical lanczos approaches .    </S>",
    "<S> _ finite - temperature:- _ we assess the method with the half - filled hubbard model ( defined in supplementary information)@xcite . within the ftlm , </S>",
    "<S> thermal expectation values are computed via @xmath23 where @xmath24 labels a state in the @xmath25-dimensional hilbert space , and @xmath8 labels the @xmath26 states of an eigensystem @xmath27 resulting from a lanczos subspace with initial state @xmath24 . </S>",
    "<S> thus , by performing @xmath25 lanczos calculations consisting of @xmath28 applications of @xmath1 each , one can obtain thermal quantities which are correct to order @xmath29 . </S>",
    "<S> @xmath25 can be very large for systems of interest and so in practice one starts from a much smaller number of states , @xmath30 , chosen as a random linear combination of all basis states , @xmath31 . </S>",
    "<S> this turns out to converge quickly with @xmath32 , particularly at high temperatures@xcite . in our stochastic approach </S>",
    "<S> the initial random vectors are created by distributing a given number of walkers randomly throughout the hilbert space with coefficients @xmath33 . </S>",
    "<S> these initial states represent stochastic snapshots of the high - temperature limit which is exactly reproduced in the limit of large @xmath32 .    as an initial test , figure  [ fig : finite_t_12 ] presents the temperature - dependent energy , @xmath34 , in the one - dimensional 12-site hubbard model at @xmath35 . including all symmetry sectors the hilbert space dimension is @xmath36 , with the largest symmetry sector containing @xmath37 determinants . however , the system is significantly undersampled with only @xmath38 walkers used throughout , with the projected hamiltonian and overlap matrices averaged over @xmath39 calculations for each initial vector , @xmath40 . </S>",
    "<S> all symmetry sectors were obtained in one calculation , rather than symmetry - blocking eq .  </S>",
    "<S> [ eq : thermal_approx ] , resulting in a choice of @xmath41 , while the number of krylov vectors used was @xmath42 , with @xmath43 vectors kept to form the final space . </S>",
    "<S> the results were found not to change significantly by including more vectors .    at high temperatures results </S>",
    "<S> are calculated with great accuracy . </S>",
    "<S> this is easily understood because the quantity calculated at @xmath44 , @xmath45 , is rigorously equal to @xmath46 , and therefore the quality is mainly dependent on the sampling of the initial vectors ( and not on the error of individual eigenvalue estimates ) . at low temperatures </S>",
    "<S> the results are dominated by the ground state , which has a large component in the sampled krylov vectors and so is accurately calculated by kp - fciqmc . however , at intermediate temperatures the errors are larger . </S>",
    "<S> the most significant source of error is in replacing an exact trace over @xmath47 by an approximate one over @xmath48 in eq .  </S>",
    "<S> [ eq : thermal_approx ] .     for the 12-site 1d hubbard model at @xmath35 sampled with @xmath49 walkers , with comparison ftlm . </S>",
    "<S> error bars show standard deviation ( note not standard error ) over @xmath39 independent calculations to demonstrate the spread of results . </S>",
    "<S> high and low temperature results are almost exact , whilst at intermediate temperatures , the variance in the stochastic sampling as well as systematic errors ( such as from the non - linear diagonalization step , and finite @xmath32 ) increases the variation between runs . </S>",
    "<S> simulation parameters were @xmath50 , @xmath51 , and a deterministic space of double excitations@xcite . ]    in figure  [ fig : finite_t_18 ] , @xmath34 for the two - dimensional 18-site hubbard model at @xmath35 is presented . </S>",
    "<S> including all symmetry sectors the hilbert space dimension is @xmath52 , with the largest symmetry sector containing @xmath53 determinants . </S>",
    "<S> again , the space was undersampled , with @xmath54 walkers used throughout , with @xmath55 and @xmath42 , of which @xmath56 vectors are kept . since ftlm was unfeasible , </S>",
    "<S> also plotted is a highly - accurate ground - state fciqmc energy for comparison . </S>",
    "<S> a complete calculation took around @xmath57 core hours . </S>",
    "<S> we find again that the high - temperature results have only a small variation between repeated calculations and we have a high degree of confidence here . at lower temperatures the confidence in the results </S>",
    "<S> is reduced , with possible systematic errors including initiator error , bias in the eigenvalue estimates and an insufficient choice of @xmath32 .     </S>",
    "<S> for the 18-site 2d hubbard model at @xmath35 , with ground - state fciqmc energy for comparison . </S>",
    "<S> 10 independent simulations were used to create the standard deviations shown as error bars . </S>",
    "<S> simulation parameters were @xmath50 , @xmath51 , and a deterministic space of double excitations . ]    </S>",
    "<S> _ dynamical correlation functions:- _ to demonstrate the ability of kp - fciqmc to calculate dynamical quantities , we first consider the following zero - temperature @xmath58-resolved single particle green function , defined from eq .  </S>",
    "<S> [ eq : correlation_function ] with @xmath59 . </S>",
    "<S> the corresponding spectral function , @xmath60 $ ] , defines the bandstructure of the material . the initial walker distribution is given by the perturbed ground state , @xmath61 , where @xmath62 is obtained from a prior ground - state fciqmc calculation . </S>",
    "<S> this starting wavefunction ensures that on average the component of a particular eigenstate in any imaginary - time snapshot is proportional to its transition amplitude in the correlation function . </S>",
    "<S> this approach works particularly well for spectra dominated by a small number of states with large transition amplitudes . because the transformation to the basis introduces large errors if many states are kept ( due to small overlap eigenvalues ) </S>",
    "<S> , we typically limit the number of vectors to between @xmath39 and @xmath63 , which limits the resolution of the spectrum . </S>",
    "<S> furthermore , high - energy states die away rapidly in the krylov vectors and so there tends to be significant stochastic errors associated with the calculation of such states . </S>",
    "<S> although this limits the accuracy of kp - fciqmc over a large energy range , we find that the method is capable of producing accurate spectra in the critical low - energy region and can accurately capture important features such as bandgaps .    </S>",
    "<S> figure  [ fig:1_particle_spectra](a ) presents @xmath64 for the 14-site hubbard model at @xmath65 with @xmath66 walkers , with @xmath19 and @xmath20 averaged over @xmath39 repeats . </S>",
    "<S> @xmath67 krylov vectors were sampled and @xmath39 vectors were retained . </S>",
    "<S> a complete calculation for a given @xmath58-sector typically took only @xmath68 core hours . </S>",
    "<S> the results are compared to highly - accurate dynamical lanczos results , using @xmath69 lanczos vectors . </S>",
    "<S> figure  [ fig:1_particle_spectra](b ) presents the local density of states , computed from the results in ( a ) via @xmath70 . </S>",
    "<S> the kp - fciqmc results give high accuracy for low - energy features , with sum rules and causality conditions exactly fulfilled . </S>",
    "<S> errors on individual poles can be estimated by repeating results . by comparing eigenvalue estimates from @xmath39 independent calculations , </S>",
    "<S> the bandgap was estimated as @xmath71 compared to the exact value of @xmath72 .     from @xmath73 ( bottom ) to @xmath74 ( top ) for the 1d 14-site hubbard model at @xmath65 , compared to dynamical lanczos . </S>",
    "<S> poles coming from the ground state or low - lying excited states with large transition amplitudes are captured accurately . </S>",
    "<S> ( b ) the local density of states . </S>",
    "<S> the low - energy results are reproduced accurately by kp - fciqmc while the qualitative behaviour is captured at high energies . </S>",
    "<S> simulation parameters were @xmath50 , @xmath75 , and a deterministic space of @xmath76 determinants@xcite . ]    </S>",
    "<S> we also consider the @xmath77-wave pair - pair dynamic correlation function , a two - body response property of significant relevance in the detection of superconducting quasiparticles . </S>",
    "<S> @xmath4 is defined by the singlet pairing operator , @xmath78 , with @xmath79 . in fig .  </S>",
    "<S> [ fig:2_particle_spectra ] we present results for this pairing spectrum ( @xmath80 ) for the 10-site hubbard model at @xmath35 , by computing all @xmath58-space contributions . </S>",
    "<S> the number of walkers was typically between @xmath81 and @xmath82 . </S>",
    "<S> the initiator adaptation was not applied because the walker population is above the plateau@xcite height for this system . </S>",
    "<S> no averaging of @xmath20 or @xmath19 over repeated calculations was performed . </S>",
    "<S> once again , it is found that low - energy features are calculated accurately , but the quality decreases for higher energy regions of the spectrum .     </S>",
    "<S> calculated for the 10-site hubbard model with @xmath35 , and compared to near - exact dynamical lanczos . </S>",
    "<S> inset shows integrated weight , @xmath83 . </S>",
    "<S> simulation parameters were @xmath50 , with a deterministic space of double excitations . ]    _ isolated excited states:- _ as a further application to larger - scale _ ab initio _ </S>",
    "<S> systems , we consider the all - electron ground and first excited state of neon , in aug - cc - pvdz and aug - cc - pvtz basis sets@xcite . </S>",
    "<S> we work in spaces where @xmath84 is constrained to be zero , but the total spin , @xmath85 , is not . </S>",
    "<S> the @xmath86 and @xmath87 states are therefore both contained within the same symmetry sector , and the spin - gap can be directly targeted with kp - fciqmc . </S>",
    "<S> the determinant space sizes with these two basis sets are @xmath88 and @xmath89 , respectively . in order to ensure large components of the desired states in the sampled krylov vectors , </S>",
    "<S> the initial wavefunction was created from a linear combination of trial estimates of the ground and first excited states at the inexpensive cisd level of theory .    </S>",
    "<S> kp - fciqmc results are presented in table  [ tab : ne_results ] , with density matrix renormalisation group ( dmrg ) results for comparison . </S>",
    "<S> dmrg is a highly accurate algorithm , which can also be extended to thermal and spectral quantities , and so is a suitable choice for comparison@xcite . </S>",
    "<S> kp - fciqmc results and errors were estimated by averaging over @xmath39 independent calculations . </S>",
    "<S> for the aug - cc - pvdz results , @xmath90 walkers were used , while @xmath91 walkers were used for the aug - cc - pvtz basis , with each calculation taking around @xmath69 core hours for this larger basis . </S>",
    "<S> calculations used 35 krylov vectors , with 10 vectors retained , providing excellent agreement with dmrg .    </S>",
    "<S> .results for the ground ( @xmath86 ) and first excited ( @xmath87 ) states of the ne atom ( @xmath92 ) , comparing kp - fciqmc with dmrg ( using m=500 spin - adapted renormalised states for the larger basis)@xcite . </S>",
    "<S> @xmath93 , @xmath94 and a deterministic space of single and double excitations . </S>",
    "<S> [ cols=\"^,^,^,^,^ \" , ]     _ conclusion:- _ we have presented a novel approach to the calculation of excited state , spectral and thermal properties within the fciqmc framework . in this approach the full hamiltonian eigenvalue problem is projected into a stochastically sampled krylov subspace , thus allowing finite - temperature and dynamical quantities to be calculated . </S>",
    "<S> since the method exploits sparsity in the sampled wavefunctions , the stochastic dynamic avoids storing krylov vectors in their entirety , rendering the approach scalable to systems sizes outside the range of the lanczos method , although in practice this is likely to be restricted if attempting to probe high frequency spectral features . </S>"
  ]
}