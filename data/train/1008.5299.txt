{
  "article_text": [
    "bubble sort is an elementary ( and inefficient ) sorting algorithm that proceeds in a number of passes . in each",
    "pass the sequence to be sorted is scanned from left to right . in any pass every item found to be greater than the item immediately to its right is exchanged with this item .",
    "as the algorithm proceeds items move to the right ( bubble up the sequence ) until blocked by some larger item . in general , many passes are required before the sorting is complete . in this paper",
    "we are interested in the permutational effect of a single pass of bubble sort .",
    "we shall see that this effect has some unexpected connections with the theory of permutation patterns .",
    "but before stating our results we need to define our terms more precisely .",
    "we shall only consider sequences of distinct terms .",
    "such a sequence is order isomorphic to a unique permutation and the bubble sort algorithm would process this permutation in the same way as it processes the original sequence .",
    "we state many of our results in the language of permutations ; this gains clarity without losing generality .",
    "all permutations in the paper are on the set of terms @xmath1 for some @xmath2 .",
    "roman letters denote single terms of a sequence and greek letters denote ( possibly empty ) sequences .",
    "notation such as @xmath3 is shorthand for @xmath4 for all terms @xmath5 of @xmath6 .",
    "the operator @xmath0 that describes the effect of a single pass of bubble sort is easily seen to have the following recursive definition . for the empty sequence @xmath7 we have @xmath8 and for non - empty sequences @xmath9 written as @xmath10 where @xmath11 is the maximal term , we have @xmath12    an alternative definition of @xmath0 is furnished by the easily proved    [ bdefinition2 ] if @xmath13 where @xmath14 are the left to right maxima of @xmath9 then @xmath15    the other concept we need is that of a pattern class of permutations",
    ". we shall write @xmath16 to denote that @xmath17 is a subsequence of @xmath6 ( although not necessarily a consecutive subsequence ) .",
    "we say that a permutation @xmath9 is a subpermutation of a permutation @xmath18 if @xmath18 has a subsequence that is order isomorphic to @xmath9 , and denote this by @xmath19 .",
    "for example , @xmath20 because @xmath21 .",
    "the subpermutation relation is a partial order and it is studied through its downsets which are called pattern classes .",
    "each pattern class @xmath22 can be characterised by the minimal set @xmath23 of permutations that it avoids : @xmath24 the set @xmath23 is called the basis of @xmath22 and , if @xmath25 , @xmath22 is called a _ principal _ pattern class .",
    "our first connection between the operator @xmath0 and pattern classes is very easy .",
    "@xmath26 is an increasing permutation if and only if @xmath27 .",
    "let @xmath28 be a permutation with largest term @xmath11 .",
    "then @xmath9 is sorted by @xmath0 if and only if @xmath29 is sorted by @xmath0 , @xmath30 is increasing , and @xmath31 .",
    "but , by induction on @xmath32 , this occurs if and only if @xmath29 avoids @xmath33 and @xmath34 , @xmath30 is increasing , and @xmath31 , which is if and only if @xmath9 itself avoids @xmath33 and @xmath34 .",
    "this result , which characterises the permutations sortable by a single pass of bubble sort , can be expressed in another way using the fact that the increasing permutations are precisely those that avoid the permutation @xmath35 : @xmath36    at this point it is convenient to contrast the sorting operator @xmath0 with a similar operator @xmath37 introduced by julian west @xcite .",
    "the definition of @xmath37 on permutations of length @xmath38 is @xmath39 with @xmath40 .",
    "west introduced this operator in the context of sorting via one pass through a stack . here",
    "the permutations that @xmath37 can sort are precisely those of @xmath41 .",
    "the effect of composing the operator @xmath37 with itself has been studied extensively @xcite .",
    "it is natural to ask questions about the compositions of such operators .",
    "one such question is : which permutations can be sorted by applying @xmath0 then @xmath37 ?",
    "in other words what is the set @xmath42    in this note we shall answer a much more general question . we shall determine the permutations @xmath43 for which @xmath44 is a pattern class and , when it is , give its basis .",
    "our results are stated in terms of the number of left to right maxima of a permutation @xmath43 .",
    "we begin with a result that shows that it is rare for @xmath44 to be a pattern class . in this result",
    "( and subsequently ) we write @xmath45 for @xmath46 for typographical convenience .",
    "[ notaclass ] [ lemma : lmax>2 ] if @xmath43 is a permutation with at least three left to right maxima , the third of which is not the final symbol of @xmath43 , then @xmath44 is not a pattern class .",
    "we begin by noting that , if @xmath43 has length @xmath38 and does not end with its maximal element , then @xmath47 .",
    "the reason for this is that , if @xmath48 is a permutation with @xmath49 , then we have @xmath50 where the last equivalence is a consequence of @xmath43 not ending with @xmath38 .",
    "now let @xmath43 be a permutation of length @xmath38 with at least three left to right maxima the third of which is not its final term .",
    "by the first remark of the proof we may ( by appending a new maximal element to @xmath43 if necessary ) assume that @xmath43 ends with its largest term .",
    "thus we may take @xmath43 to have the form @xmath51 where @xmath52 are the first three left to right maxima of @xmath43 and @xmath53 is non - empty .",
    "consider the pair of permutations @xmath54 and @xmath55 .",
    "then , as @xmath56 , @xmath57",
    ". on the other hand , if there were an embedding of @xmath43 into @xmath58 , @xmath59 could not map onto @xmath60 and so , as @xmath61 is only one term longer than @xmath43 , @xmath62 would map onto @xmath63 which is impossible as @xmath64 but @xmath65 .",
    "thus @xmath61 does not contain @xmath43 and so @xmath66 . since @xmath67 we have proved that @xmath44 is not a pattern class .",
    "in the remainder of this section we shall prove a series of results that yield a strong converse of theorem [ notaclass ] .",
    "we shall not only show that @xmath44 is a pattern class for all permutations @xmath43 not covered by theorem [ notaclass ] but will display an explicit basis .",
    "there are several cases to consider but our basic methodology is to identify sets of permutations @xmath68 to which the following lemma can be applied .",
    "[ basicmethod ] let @xmath43 be any permutation .",
    "if there exists a set @xmath68 of permutations such that for any permutation @xmath9 :    1 .",
    "@xmath69 for some @xmath70 , 2 .",
    "@xmath71 for some @xmath70 @xmath72 ,    then @xmath44 is a pattern class .",
    "furthermore if @xmath68 is a minimal set with these properties then @xmath68 is the basis of @xmath44 .",
    "the two conditions say that @xmath71 for some @xmath70 if and only if @xmath73 .",
    "however @xmath74 in other words @xmath75 for all @xmath70 if and only if @xmath76 .",
    "this shows that @xmath44 is a downset in the subpermutation order , i.e. a pattern class .",
    "it also shows that , if @xmath68 is minimal , it is the basis of @xmath44 .",
    "we first dispose of two trivial cases :    [ trivialcases ] if @xmath43 is the permutation of length 1 then @xmath44 is empty . if @xmath77 then @xmath44 consists of the permutation 1 alone .",
    "the first statement is trivial because @xmath78 is empty . in the second case",
    ", if a permutation @xmath9 lies in @xmath79 then @xmath26 is decreasing .",
    "but @xmath26 ends with its maximal term and hence @xmath80 .",
    "we next consider the general case that @xmath43 has a single left to right maximum . to do this we prove the following two lemmas which verify the two conditions of lemma [ basicmethod ] .",
    "[ onelr1 ] let @xmath9 , @xmath81 be sequences both of length greater than 1 such that @xmath81 begins with its largest term and such that @xmath82 .",
    "then there exists @xmath83 such that @xmath9 contains one of @xmath84 and @xmath85 .",
    "we shall prove the result by induction on @xmath32 .",
    "if @xmath86 the result is vacuously true since @xmath82 is possible only if @xmath87 is empty ( as @xmath26 ends with its maximal term ) and this is impossible as @xmath88 .",
    "so now assume that @xmath89 and that the result holds for sequences shorter than @xmath9 .",
    "writing @xmath10 , where @xmath11 is the largest term of @xmath9 , we have @xmath90 .",
    "in fact , as @xmath81 does not end with its largest term , we have @xmath91 .",
    "we consider the various ways in which @xmath81 can lie across @xmath92 .",
    "suppose first that @xmath93 with @xmath94 non - empty and that @xmath95 and @xmath96 .",
    "since @xmath29 is shorter than @xmath9 the inductive hypothesis applies and it proves that , for some @xmath83 , @xmath29 contains one of @xmath97 and @xmath98 .",
    "but then @xmath10 contains one of @xmath99 and @xmath100 .",
    "suppose next that @xmath101 and that @xmath102",
    ". then @xmath103 .",
    "finally suppose that @xmath104",
    ". then @xmath105 .",
    "[ onelr2 ] let @xmath87 be any sequence and @xmath106 values with @xmath107 .",
    "if @xmath9 is a sequence that contains either of @xmath84 or @xmath85 then @xmath81 is contained in @xmath26 .",
    "if @xmath108 then no symbol of @xmath81 can be a left to right maximum of @xmath9 .",
    "however lemma [ bdefinition2 ] implies that @xmath0 preserves the order of symbols that are not left to right maxima ; hence @xmath82 .",
    "this argument would apply to the case @xmath109 if @xmath110 was not a left to right maximum ( obviously the symbols of @xmath87 can not be left to right maxima ) . however",
    "if @xmath110 was a left to right maximum then @xmath5 or some symbol between @xmath110 and @xmath5 must also be a left to right maximum . by lemma [ bdefinition2 ] again this other",
    "left to right maximum precedes @xmath87 in @xmath9 and therefore @xmath110 precedes @xmath87 in @xmath26 .",
    "lemmas [ basicmethod ] , [ onelr1 ] , [ onelr2 ] now handle the case of permutations with just one left to right maximum :    [ onelrmain ] suppose that @xmath111 has length greater than @xmath112 and begins with its maximal element .",
    "then @xmath44 is a pattern class with basis @xmath113    [ aalphab ] if @xmath114 has only two left to right maxima , namely @xmath11 and @xmath38 , then @xmath44 is a pattern class with basis @xmath113    note that @xmath115 does not end with its maximum element whereas any permutation @xmath26 does end with its maximum element .",
    "this means that @xmath116 hence @xmath117 thus @xmath118 and the result follows from the previous proposition .    before treating the case that @xmath43 has two or three left to right maxima we introduce a variant of the standard diagrammatic way of displaying permutations which will be a helpful aid in understanding the bases of the pattern classes @xmath44 .",
    "every permutation @xmath119 can be represented by its graph of points @xmath120 drawn in the plane . to specify a permutation , only the vertical and horizontal orders of points matter rather than their precise values and so these graphs are useful tools for arguing about subpermutations .",
    "for example the graph of figure [ diagram ] shows the permutation @xmath121 together with a subpermutation .     and , in white dots ,",
    "the subpermutation @xmath122.,width=144 ]    in these permutation diagrams no two points can be vertically aligned or horizontally aligned since then their positional order or their value order would be ambiguous .",
    "however , if we want diagrams to display a _ set _ of permutations we can exploit this very ambiguity .",
    "for example figure [ permset ] represents a set of 4 permutations because two points lie on the same horizontal line and two lie on the same vertical line .",
    "our major use of this notation is in figure [ basispermextension ] . on the left",
    "this shows a permutation @xmath43 with two left to right maxima ( the upper left quadrant being empty ) . on the right",
    "it shows a set of permutations @xmath123 .",
    "the two white points lie anywhere in the range indicated .",
    "these permutations are extensions of @xmath43 . in all but four cases they are 2-point extensions .",
    "however it is permitted that the white points can coalesce ( in a point in the top left corner ) and then the diagram represents four 1-point extensions of @xmath43 .",
    "this set of permutations ( or , more precisely , the minimal permutations of the set ) will turn out to be the basis of @xmath44 ( except when @xmath6 is empty ) .",
    "and the set @xmath123.,width=384 ]    [ twolr1 ] let @xmath9 , @xmath124 be sequences such that @xmath110 and @xmath5 are the only two left to right maxima of @xmath124 with @xmath125 non - empty and such that @xmath126 .",
    "let @xmath43 be the permutation order isomorphic to @xmath124 .",
    "then @xmath9 contains a sequence order isomorphic to one of the members of @xmath123 .",
    "we shall prove that @xmath9 has a subsequence of the form @xmath127 or @xmath128 where    1 .",
    "@xmath93 , 2 .",
    "@xmath129 , 3 .",
    "@xmath130 and @xmath131 are the two largest terms of this sequence , 4 .",
    "if @xmath110 precedes @xmath132 and @xmath94 is empty , then @xmath132 and @xmath130 are the same term .",
    "such a subsequence is indeed isomorphic to a permutation in @xmath123 : the subsequence @xmath133 is order isomorphic to @xmath43 and @xmath134 play the roles of the two white points in figure [ basispermextension ] .",
    "we shall use induction on the length of @xmath9 .",
    "the inductive base is provided by the vacuous cases @xmath135 so we now assume that @xmath136 and that the result is true for shorter sequences ( and any appropriate sequences @xmath124 ) .",
    "writing @xmath10 , where @xmath11 is the largest term of @xmath9 , we have @xmath137 .",
    "in fact , as @xmath124 does not end with its largest term , we have @xmath138 .",
    "we consider the various ways in which @xmath124 can lie across @xmath92 .",
    "@xmath139 and @xmath140 for some partition @xmath141 with @xmath142 non - empty . here",
    "the inductive hypothesis applies and yields a subsequence of @xmath29 of the form @xmath143 or @xmath144 to which the subsequence @xmath145 of @xmath30 may be appended to obtain a subsequence of @xmath9 of the required form .",
    "@xmath146 and @xmath147 . here",
    "@xmath29 can not have length 1 and so lemma [ onelr1 ] shows that @xmath29 has a subsequence @xmath148 or @xmath149 for some @xmath150 .",
    "either @xmath5 lies to the left of @xmath87 in @xmath29 , in which case we can take it to play the roles of both @xmath132 and @xmath130 , or it lies between two terms of @xmath87 or to the right of @xmath87 and , in this case , we take it in the role of @xmath130 and take @xmath151 in the role of @xmath132 .",
    "we can append to this sequence the subsequence @xmath152 of @xmath30 , with @xmath11 playing the role of @xmath131 .",
    "this gives the required subsequence .",
    "@xmath95 and @xmath153 for some partition @xmath93 with @xmath94 non - empty .",
    "because @xmath94 is non - empty , @xmath154 has length greater than 1 and lemma [ onelr1 ] applies to show that @xmath29 has a subsequence @xmath155 or @xmath156 for some @xmath157 .",
    "to this sequence we can append the subsequence @xmath158 , take @xmath11 and @xmath5 in the roles of @xmath130 and @xmath131 and obtain a sequence of the required type .",
    "@xmath101 and @xmath159 . here",
    "@xmath160 is a subsequence of @xmath9 .",
    "this is a case where the roles of @xmath132 and @xmath130 are both played by @xmath11 .",
    "@xmath161 . here",
    "@xmath162 is a subsequence of @xmath9 and @xmath11 again plays the roles of @xmath132 and @xmath130 .",
    "[ twolr2 ] let @xmath43 be a permutation with exactly two left to right maxima and not ending in its largest element ( so of the type displayed in figure [ basispermextension ] ) .",
    "suppose that @xmath9 contains a subsequence order isomorphic to a permutation in @xmath123 .",
    "then @xmath26 contains a sequence order isomorphic to @xmath43 .",
    "we use two principles that follow from lemma [ bdefinition2 ] regarding the transformation of @xmath9 into @xmath26 :    1 .",
    "every subsequence of @xmath9 whose terms are not left to right maxima is transformed into the same subsequence , and 2 .",
    "if @xmath163 is a subsequence of @xmath9 such that @xmath11 is the only left to right maxima of @xmath9 in the subsequence , then , in @xmath26 , the immediately preceding left to right maximum of @xmath9 lies between @xmath164 and @xmath165 .",
    "let @xmath166 or @xmath167 be a subsequence of @xmath9 that is order isomorphic to a permutation of @xmath123 . here",
    "@xmath168 is order isomorphic to @xmath43 .",
    "indeed @xmath106 correspond to the black points in either diagram of figure [ basispermextension ] , @xmath134 correspond to the white points in the right - hand diagram , @xmath87 corresponds to @xmath17 , and @xmath125 corresponds to @xmath6 .    by ( 1 ) above @xmath169 will be a subsequence of @xmath26 since no term in this subsequence of @xmath9 is a left to right maximum ( not even a left to right maximum of @xmath166 or @xmath167 ) .",
    "also @xmath110 will precede @xmath169 in @xmath26 .",
    "this follows from ( 1 ) if @xmath110 is not a left to right maximum of @xmath9 .",
    "however , if @xmath110 is a left to right maximum , then @xmath110 precedes @xmath132 in @xmath9 ; but then @xmath132 is either a left to right maximum also , or there is another left to right maximum between @xmath110 and @xmath132 and we can appeal to ( 2 ) above .    finally we show that , in @xmath26 , there is a term between @xmath87 and @xmath125 that , even if it is not @xmath5 itself , plays the role of @xmath5 in that it exceeds every term of @xmath125 . if @xmath5 is not a left to right maximum of @xmath9 then , by ( 1 ) , it will itself be positioned between @xmath87 and @xmath125 in @xmath26 .",
    "so we suppose that @xmath5 is a left to right maximum of @xmath9 and let @xmath170 be the immediately preceding left to right maximum .",
    "then , by ( 2 ) , @xmath170 will lie between @xmath87 and @xmath125 in @xmath26 so it is now sufficient to show that @xmath171 ( since @xmath172 ) .",
    "indeed @xmath173 is impossible ; for either @xmath130 would precede @xmath170 and then @xmath170 would not be a left to right maximum , or @xmath170 would precede @xmath130 and then @xmath170 would not be the left to right maxima that immediately preceded @xmath5 .",
    "hence @xmath26 contains @xmath43 .",
    "now lemmas [ basicmethod ] , [ twolr1 ] and [ twolr2 ] prove    [ twolrmain ] let @xmath43 be a permutation of length @xmath38 , with exactly two left to right maxima but not ending in its maximal symbol . then @xmath44 is a pattern class whose basis is the set of minimal permutations in @xmath123",
    ".    [ threelr1 ] if @xmath174 has exactly three left to right maxima , namely @xmath110 , @xmath5 and @xmath175 , and @xmath6 is non - empty then @xmath176    note that @xmath177 does not end with its maximum element and therefore we may use the same proof as in corollary [ aalphab ] .",
    "there remains just one case : when @xmath178 has exactly three left to right maxima as in corollary [ threelr1 ] but when @xmath6 is empty . here",
    "@xmath179 and @xmath180 ( written as @xmath181 and @xmath182 for typographical brevity ) .",
    "this case is treated in the following proposition which is proved by the same approach followed in propositions [ onelrmain ] and [ twolrmain ] .",
    "let @xmath43 be a permutation of the form @xmath183",
    ". then @xmath184",
    "this paper has characterised the principal pattern classes @xmath78 for which @xmath44 is a pattern class .",
    "it has given a criterion in terms of left to right maxima of @xmath43 and we call such permutations `` good '' . for non - principal pattern classes",
    "far less is known although the following easy result holds :        of course this result proves not only that , when @xmath185 contains only good permutations , @xmath188 is a pattern class but it also allows its basis to be described ( as the set of minimal permutations in the union of bases of the pattern classes @xmath44 ) .      pattern class research is often concerned with the enumeration question : how many permutations of length @xmath38 does a particular pattern class contain . for principal pattern classes @xmath78",
    "no enumerations are known when @xmath190 and so it would be unrealistic to hope that many pattern classes of the form @xmath44 could be enumerated .",
    "however a cruder question can be asked .",
    "every pattern class @xmath191 has an upper growth rate @xmath192 defined as @xmath193a_n$ ] ( @xmath194 being the number of permutations in @xmath191 of length @xmath38 ) .",
    "the set of permutations sortable with @xmath200 passes of bubble sort , namely @xmath201 , is a pattern class whose basis is the set of @xmath202 permutations of length @xmath203 whose final term is @xmath112 .",
    "the proof of this result has a slight bearing on problem [ necsuff ] .",
    "the set @xmath207 contains @xmath208 which is not a good permutation .",
    "nevertheless @xmath209 is a pattern class .",
    "hence the necessary and sufficient condition asked for in problem [ necsuff ] is more subtle than the condition that @xmath185 consists entirely of good permutations .",
    "finally , we note that the pattern classes featuring in these propositions have been enumerated .",
    "our calculations show that the number of permutations of length @xmath38 in @xmath198 is @xmath210 and it is well - known that there are @xmath211 permutations of length @xmath38 in @xmath212 .",
    "99 s. dulucq , s. gire , o. guibert : a combinatorial proof of j. west s conjecture , discrete mathematics 187 ( 1998 ) , 7196 .",
    "m. bousquet - mlou : multi - statistic enumeration of two - stack sortable permutations , electronic journal of combinatorics 5 ( 1998 ) , paper r21 . j. west : sorting twice through a stack , theoretical computer science 117 ( 1993 ) , 303313 .",
    "d. zeilberger : a proof of julian west s conjecture that the number of two - stack - sortable permutations of length @xmath38 is @xmath213 , discrete mathematics 102 ( 1992 ) , 8593 ."
  ],
  "abstract_text": [
    "<S> let @xmath0 be the operation of re - ordering a sequence by one pass of bubble sort . </S>",
    "<S> we completely answer the question of when the inverse image of a principal pattern class under @xmath0 is a pattern class . </S>"
  ]
}