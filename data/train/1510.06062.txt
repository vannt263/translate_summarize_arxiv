{
  "article_text": [
    "the number of techniques available to accurately probe molecules in their native , crowded , and time changing live cell environment has increased dramatically in recent years @xcite .",
    "research aimed at more efficiently extracting kinetic information from live cell single particle tracking ( spt ) experiments has also experienced rapid growth @xcite .",
    "however , analysis methods have substantially lagged behind microscopy developments .",
    "an important and ubiquitous problem in cell biology @xcite that has not received substantial statistical attention is associated with how to address various technical challenges inherent to analyzing confined motion @xcite in a collection of experimental trajectories exhibiting heterogeneous and/or non - stationary ( i.e. , transient kinetic phenomena ) responses @xcite .",
    "high - resolution multicolor image stacks can provide hints of molecular interactions when analyzed via a spatial co - localization analysis @xcite , however reliably distinguishing between transient molecular binding events ( hence changing the underlying molecular diffusivity of the biomolecule ) vs. coincidental co - localization can be aided by new quantitative time series methods .",
    "measurement apparatus noise further complicate the problem , since in optical microscopy , position measurements are not  instantaneously \" observed .",
    "empirically measured data is a time averaged quantity @xcite .",
    "for example , in fluorescence based optical microscopy @xcite , position is inferred from the observed point spread function ( psf ) @xcite obtained by collecting a finite number of photons emitted as the tagged molecule moves throughout the cell @xcite .",
    "the noise due solely to photon emissions from multiple positions in a single image is what we refer to generically as `` motion blur '' .",
    "the statistical correlation between thermal fluctuations , confinement forces , and motion blur introduces new time series challenges not addressed by current spt data analysis routines .",
    "@xcite address how to handle motion blur issues under the assumption of simplified diffusion models , but fail to address technical complications associated with confined motion ( a common occurrence in live cell spt studies ) .",
    "the classic kalman filter ( kf ) algorithm can deal with simple confined motion models , but fundamental assumptions behind the kf are violated when motion blur is present @xcite .",
    "we introduce a new likelihood based estimation scheme that explicitly models ( i ) the spatio - temporal statistical correlation inherent to molecular position measurements undergoing confined diffusion @xcite ; and ( ii ) the correlation between various sources of measurement noise and the underlying particle position time series in camera based measurements ( the approach treats  dynamic \" and  static \" measurements errors commonly encountered in spt @xcite ) .",
    "the technique is capable of reliably estimating local molecular diffusivity , @xmath4 , and instantaneous velocity & forces from a single noisily measured position vs. time spt trajectory . _ reliably estimating the aforementioned kinetic quantities from spt trajectory measurements requires one to address statistical correlation induced by confinement , localization , and motion blur @xcite . _",
    "obtaining reliable estimates of instantaneous forces from a single trajectory and respecting heterogeneity commonly encountered in spt data @xcite requires an accurate estimate of @xmath4 that is free of measurement apparatus artifacts ( our approaches provides this information ) .",
    "our approach also enables researchers to use a single measured trajectory produced by an individual molecule ( where localization quality may vary over time ) to systematically decouple `` dynamic measurement errors '' from effective `` static measurement errors '' @xcite .",
    "this decomposition is described in detail later since it is a key technical aspect of our new algorithm .    as we demonstrate , failing to properly account for motion blur and/or confinement can substantially affect quantities required to estimate forces from spt trajectories . the motion blur filter ( mbf ) algorithm addresses the technical concerns through a reformulation of the kf @xcite . to our knowledge",
    ", this is the first time domain likelihood based approach that explicitly accounts for confinement and motion blur .",
    "likelihood - based approaches accounting for the natural time ordering of measurements @xcite are advantageous since transient ( but experimentally resolvable ) changes in molecular forces can not be readily detected by legacy approaches such as mean square displacement ( msd ) @xcite or autocorrelation approaches @xcite where implicit assumptions about stationary statistics are made .",
    "the mbf algorithm utilizes closed - form analytical expressions from stochastic process theory and avoids _ ad hoc _ statistical approximations to the likelihood function .",
    "the ability of our technique to consistently estimate diffusion coefficients ranging from @xmath5 to 1 @xmath6 in the presence of molecular confinement sampled using observations spaced `` finely '' ( 5 @xmath7 ) to `` coarsely '' ( 100 @xmath7 ) in time is demonstrated via simulations .",
    "our approach does assume that some approximate localization technique @xcite , e.g. centroid or psf shape based , can extract an unbiased estimate of the time averaged position ( where averaging occurs over the exposure time of a single image ) of the molecule of interest ; note that the  quality \" of the localization is permitted to vary over time within our framework . a data - driven technique , processing``blurred '' data , capable of decoupling various noise sources over a wide range of exposure times is expected to aid in identifying physically relevant motion experienced _ in vivo _ in a variety of dynamic processes .",
    "the mbf provides an algorithm enabling a more direct and reliable comparison of parameters obtained from data with different temporal and spatial resolution since biases affecting other methods at different length and time scales are not experienced by the mbf .",
    "this is expected to result in a more comprehensive picture of dynamics occurring in the cell .",
    "note that when biomolecules are sampled with single - molecule precision _ in vivo _ , they often experience transitions from `` standard diffusion '' to  anomalous diffusion \" as the timescale of observation increases @xcite .",
    "a longer term aim of this work is to provide a statistically robust method capable of accurately quantifying the motion parameters associated with single - molecule data before events leading to  anomalous diffusion \" phenomena manifest and can be statistically detected within individual trajectories .",
    "our motivation is to extract `` finer scale '' molecular kinetic information from the high temporal and spatial resolution measurements afforded by contemporary optical microscopy with the hope of providing a tool which can accelerate detection of new dynamic phenomena from these measurements @xcite .",
    "this article is organized as follows : section [ sec : qual ] introduces the models , theoretical background , and the new mbf algorithm . towards the end of this section ( in subsection [ sec : qualitativeexamples ] ) , we walk the reader through two examples illustrating how to use the open - source python code and ipython notebooks provided along with this article ( these examples reproduce figs . [",
    "fig : nonstatvelocityeg ] and [ fig : rvaryingeg ] ) . section [ sec : results ] presents additional results on large scale simulations and section [ sec : conclusion ] concludes .",
    "an appendix provides additional mathematical details .",
    "the supp . mat . for additional results and algorithmic details . ] provides additional results and algorithmic details .",
    "this subsection is organized as follows : the assumed continuous time dynamical model is introduced in sec .",
    "[ sec : notation ] . prior to discussing the finer technical time series and filtering details , we expand on the assumptions made about the measurement noise sources in sec . [",
    "sec : measerrorqual ] , since these assumptions are key to understanding the mbf .",
    "after a detailed description of the measurement noise , we briefly discuss physical interpretations of the model in sec .",
    "[ sec : physicalsde ] ( additional details can be found in refs . @xcite and @xcite ) . this discussion is followed by a review of the classic kf in sec .",
    "[ sec : basicofkf ] . after providing the required background , in sec .",
    "[ sec : methods ] we introduce the mbf algorithm .",
    "subsequently , we provide two illustrative examples in sec . [",
    "sec : qualitativeexamples ] illustrating advantages of the mbf and how one can leverage the approach on spt data .",
    "this section concludes by contrasting the mbf to existing approaches in spt .",
    "the mbf assumes the following stochastic differential equation ( sde ) and measurement model :    @xmath8    the true position of the tagged particle at time @xmath9 is denoted by @xmath10 and the discretely sampled position measured by the microscope is denoted by @xmath11 .",
    "the stochastic term driving the sde above is a standard brownian motion , denoted by @xmath12 .",
    "the effective  static \" @xcite localization measurement noise at @xmath13 measured by a camera with exposure time @xmath14 is denoted by @xmath15 ( this noise is modeled as a mean zero gaussian random variable independent of the particle position ) . the time integral in eq .",
    "[ eq : contmeas ] models  motion blur \" introduced by the camera @xcite . additional assumptions and details regarding the measurement noise sources",
    "are discussed later in this section and in greater detail in sec .",
    "[ sec : measerrorqual ] .",
    "the model above is specified by a parameter vector denoted by @xmath16 ( this parameter vector contains physically interpretable parameters described in secs .",
    "[ sec : measerrorqual ] - [ sec : physicalsde ] ) .",
    "the continuous time sde in eq .",
    "[ eq : sde ] is a linear model whose solution is known precisely @xcite .",
    "using @xmath17 allows confinement to be modeled ( a common phenomenon in live cell studies ) .",
    "however , the spatial and temporal dependence introduced when @xmath18 and motion blur corrupts observations poses several new time series challenges not addressed previously @xcite .",
    "the mbf algorithm processes discrete measurements samples taken from the continuous time sde .",
    "the linear and gaussian nature of eq .",
    "[ eq : sde ] enables an exact discretization of eq .",
    "[ eq : sde ] , as well as a discrete representation of the integral appearing in eq .",
    "[ eq : contmeas ] that does not introduce any statistical errors into the filtering framework ( these features are crucial to the mbf ) .",
    "the aforementioned discretization of eqs .",
    "[ eq : sde]-[eq : contmeas ] is given by :    @xmath19    where @xmath20 denotes a gaussian random variable with mean @xmath21 and variance @xmath22 .",
    "the quantities @xmath23 listed in the discrete equations above can be derived in closed - form given @xmath24 , @xmath25 , and the continuous time parameters @xmath26 ( expressions not explicitly defined in this section are derived and provided in the appendix ) .",
    "the term @xmath27 represents a gaussian mean zero  process noise \" @xcite with variance @xmath28 ; the term `` process noise '' is used in control theory to describe a stochastic noise source that affects the true underlying state of the system ( the  state \" is molecular position in the application considered here ) .",
    "the term @xmath29 represents the difference between @xmath30 and the conditional expectation of @xmath31 ( conditioned on @xmath32 ) .",
    "an important technical aspect of the discretized model above is the fact that the conditional expectation @xmath33 $ ] is a gaussian random variable with mean @xmath34 and variance @xmath35 .",
    "the parameters @xmath36 and @xmath37 are used to compute the expected value of the measurement at the next time instant ( since there is motion blur , the mean of the measurement does not coincide with the value of the underlying position at the same time point ) . the parameters @xmath38 and @xmath39 play a similar role , i.e. , @xmath40 $ ] = @xmath41 ( @xmath38 and @xmath39 type parameters are commonly encountered in kf applications when a continuous time model is inferred from discretely observed measurements @xcite ) .",
    "equation [ eq : discretesdecrosscorr ] emphasizes that @xmath42 _ is statistically correlated _ with the @xmath43 ( all other noise terms above are statistically independent ) .",
    "the net measurement noise variance obtained by combining the static and dynamic error is @xmath44 ( the term in parenthesis permits time dependent effective static measurement noise ; these terms are described in detail in the next subsection & illustrative example 2 in sec .",
    "[ sec : qualitativeexamples ] ) .",
    "figure [ fig : twonoisetypes ] illustrates the motion blur measurement noise and effective static measurement noise sources graphically ( these terms are further described in sec .",
    "[ sec : measerrorqual ] ) .    under the assumed parametric model",
    "( see eqs .",
    "[ eq : sde ] and [ eq : contmeas ] ) , the variance of @xmath29 and its covariance with @xmath30 ( covariance quantified by @xmath45 in eq .",
    "[ eq : discretesdecrosscorr ] ) can be obtained in closed - form in terms of the model parameters ( derivation provided in appendix ) . the classic kalman filter ( kf )",
    "can account for confinement forces and non - stationary statistics @xcite , but the classic kf is not able to explicitly handle motion blur due to the correlation between @xmath29 and @xmath46 .",
    "_ both the practical utility and main technical contribution of the mbf are associated with how the mbf handles eq .",
    "[ eq : contmeas ] and the correlation in eq .",
    "[ eq : discretesdecrosscorr ] _",
    ", hence a detailed qualitative description of the physical phenomena underlying the assumptions behind the `` measurement error '' terms is presented before proceeding .      in spt analysis of fluorescence optical microscopy data ,",
    "the position measurements of a single molecule are typically obtained from through localization techniques @xcite . throughout the remainder of this article ,",
    "the term `` psf '' is used to represent the observed point spread function .",
    "the inference of the psf can be guided by optics principles , but we use the term `` psf '' to represent a data - driven quantity extracted from an image measured by an optical light microscope .",
    "if the molecule being imaged by a microscope is mobile , the observed psf is contaminated by both  static \" and  dynamic \" measurements errors @xcite . the integral in eq .",
    "[ eq : contmeas ] models the  dynamic \" motion blur measurement error , @xmath29 , due to the tagged molecule emitting photons at different spatial positions in the time interval producing a single image , @xmath47 $ ] .",
    "the motion blur measurement error is highly correlated with the underlying particle position of interest . the effective ",
    "static \" measurement error is intended to quantify the error associated with inferring a psf s shape from observed pixel intensities @xcite .",
    "that is , the effective static measurement error is an idealized quantity ( estimated from observational data ) which aims at quantifying the error due to estimating a psf from a finite number of measured photons .",
    "the dynamic or immobile nature of the emitters producing the data used to calibrate the psf is not relevant to the data - driven effective static measurement noise used by the mbf .",
    "note that the observed psf may not be radially symmetric even in the `` ideal infinite photon '' limit due to the dynamic errors introduced by molecular motion .",
    "however , as stated in the introduction , the mbf does assume that the localization procedure provides an unbiased point estimate of the the time averaged position of the molecule of interest in the image measurement ( the mean zero assumption of @xmath48 in eq .",
    "[ eq : discretemeas ] reflects this assumption ) . in an ideal  infinite photon collection \"",
    "scenario , the variance of @xmath48 would be zero . however , even in the infinite photon case , there would still be uncertainty in the molecular position if the molecule moves and the exposure time is non - zero . both measurement errors are illustrated in fig .",
    "[ fig : twonoisetypes ] .    ./fig1.eps    the main assumptions underlying the mbf are that ( i ) the dynamics are consistent with eqs .",
    "[ eq : sde ] and ( ii ) the error introduced by finite photon count psf estimation can be approximated by a gaussian random variable whose statistics are determined by eq .",
    "[ eq : contmeas ] .",
    "the mbf framework recognizes that within empirically observed measurements , static and dynamic measurement noise sources are convolved in the raw data .",
    "the mbf approach uses a data - driven model - based approach to `` decouple '' static and dynamic errors . _",
    "although the position measurement is blurred due to molecular motion during image acquisition and finite camera exposure time @xcite , the mbf aims at rigorously inferring the instantaneous position of the molecule at @xmath49 as well as the parameters characterizing its motion_. the sde model - based framework outlined in eqs .",
    "[ eq : discretesde ] - [ eq : discretesdenocorr ] is key to achieving the noise decomposition described in this section . in most spt applications ,",
    "the gaussian assumption on the effective static measurement noise can not typically be statistically rejected if 10 or more photons underlie a psf estimate ( formal means for detecting poisson artifacts could be considered @xcite ) . in this article ,",
    "goodness - of - fit tests are used to detect if data is consistent with various assumptions underlying the assumed dynamical models ( the tests used have been shown capable of detecting artifacts of  low photon count \" measurement error in spt data if they are present in the data @xcite ) .    in the open - source software provided ( discussed in sec .",
    "[ sec : qualitativeexamples ] ) with this article , we allow estimates of time dependent localization noise statistics through the optional input @xmath50 .",
    "the time dependent input _ estimate _ of the localization uncertainty at time @xmath49 can be biased ( e.g. , it may contain artifacts of motion blur ) .",
    "when the optional sequence @xmath50 is input , the mbf uses the full sequence of measurements to estimate the parameter @xmath51 which defines the net effective time dependent static measurement noise variance : @xmath52 for each @xmath53 .",
    "it is stressed that the net _ effective _ static measurement error is estimated from the data and not assumed known _ a priori _ ( the parameter @xmath51 adjusts for the fact that the input localization estimates are likely corrupted by motion blur or other artifacts ) . if @xmath50 is not provided as input , the estimated parameter @xmath51 denotes the constant effective static measurement noise associated with the time series data .",
    "recall that the sde of interest ( eq . [ eq : sde ] ) is characterized by the parameter vector @xmath16 where @xmath4 denotes the local effective diffusion coefficient ; @xmath54 and @xmath55 characterize the instantaneous velocity @xcite .",
    "the parameter @xmath51 was described in detail in the previous section .",
    "in live cell studies , motion is often confined and confinement affects the temporal correlation statistics @xcite even if motion blur and measurement artifacts are not present in the data .",
    "the sde model considered can use a single trajectory to compute  the instantaneous force \" from the estimated diffusion coefficient @xcite . the ability to use a single trajectory to estimate motion parameters permits researchers to quantify heterogeneity and time changing forces at different points in the cell @xcite .",
    "for example , the effective force at time @xmath9 , denoted by @xmath56 , is approximated by @xmath57 where hats denote the maximum likelihood estimate ( mle ) extracted from the data . in the previous force equation",
    ", we appealed to the classical einstein relationship , i.e. , @xmath58 , where @xmath59 is boltzmann s constant multiplied by the system temperature and @xmath60 is the effective molecular friction @xcite .",
    "our technique for estimating forces assumes that `` cage hopping '' or `` crowding '' events have not occurred within the observed trajectory @xcite .",
    "note that we are not restricting the term `` cage hopping '' to refer to kinetic phenomena in membrane diffusion @xcite .",
    "in the presence of spt trajectories spanning `` long times '' , we acknowledge that crowding in the cell may result in cage hopping type phenomena . in sec . [",
    "sec : conclusion ] , we discuss techniques to preprocess trajectories by segmenting the data into regimes where the mbf technique can be used to extract reliable force from position vs. time data using the model above as a building block . if cage hopping type phenomena occurs on time scales much faster than the temporal resolution afforded by the measurement device ( e.g. , many `` cage jumps '' can occur during the exposure time ) , the mbf can still be used to estimate effective sde parameters explicitly accounting for the statistical effects of motion blur .    in the remainder of this subsection",
    ", we illustrate how the sde above nests other popular spt models ( i.e. , we outline how directed and pure diffusion models are special cases of the sde model in eq .",
    "[ eq : sde ] ) .",
    "if both @xmath55 and @xmath54 are set to zero , one obtains the motion blur model considered by berglund @xcite ( handling the @xmath61 , is a simple extension of berglund s result as we show in the code supplied ) .",
    "when @xmath62 , one has an ornstein - uhlenbeck ( ou ) process @xcite .",
    "if @xmath63 ( @xmath64 is assumed by the mbf ) , the ou process can model confined diffusion . a popular spt confinement parameter , @xmath65 @xcite , is closely connected to the so - called `` corral radius '' .",
    "the original usage of the parameter @xmath65 in spt corresponded to a box width ( not a proper  radius \" ) of a hard wall potential @xcite .",
    "however , the `` coral radius '' term is often used in spt to generically describe the square root of the asymptotic limit of an msd curve of a confined particle @xcite .",
    "@xmath65 is related to the parameters of the model considered here through the equality @xmath66 ( see ref .",
    "@xcite ) .      in this subsection",
    ", we review the key assumptions underlying the classic kf at a high level since the mbf makes several modifications to this established algorithm @xcite .",
    "the kf assumes that a linear dynamical system can be used to describe the evolution of the  state \" ( the `` state '' is the molecular position @xmath67 in our application and is not directly observable due to the measurement noise ) .",
    "the `` process noise '' ( i.e. , the brownian noise in eq .",
    "[ eq : discretesde ] ) and net measurement noise are all assumed to be governed by gaussian statistics in the classic kf .",
    "the kf leverages the following mathematical principle .",
    "assume the random vector , @xmath68 \\sim \\mathcal{n}(\\vec{\\mu},\\sigma)$ ] where the mean , @xmath69 $ ] , and covariance , @xmath70 $ ] , specifying the gaussian are known ; @xmath71 is the variance of @xmath72 ( similarly for @xmath73 ) and @xmath74 is the covariance of @xmath72 and @xmath75 .",
    "assume @xmath75 is directly observable , but @xmath72 is not .",
    "in this case , the linear minimum variance estimate of @xmath72 given @xmath75 , denoted by @xmath76 $ ] is given by @xcite :    @xmath77 = & \\mu_x + \\sigma_{xy } \\sigma_{yy}^{-1 } ( y-\\mu_y )   \\label{eq : optlsq}\\end{aligned}\\ ] ]    the above relationship is a general principle used by multiple estimators , not just the kf @xcite .",
    "a useful aspect of the kf algorithm is associated with the fact that a time series of measurements can be efficiently and sequentially processed building off of the general relationship in eq .",
    "[ eq : optlsq ] . to illustrate the sequential aspect and",
    "specialize to notation used in the discretized version of our model ( eqs .",
    "[ eq : discretesde ] and [ eq : discretemeas ] ) , we use fig .",
    "[ fig : flowchart ] and the following equation :    @xmath78    where @xmath79 , @xmath80 is the `` forecasted measurement '' ( the expected value of @xmath81 ) conditioned on the model parameters and all previously observed measurements up to time @xmath82 ( the  forecasted state \" , @xmath83 , is analogously defined , but is used to predict @xmath84 ) .",
    "@xmath85 represents the  filtered state \" estimate ( i.e. , the linear minimum variance estimate of @xmath84 given all information available up to time @xmath86 ) . the sequence @xmath87 is referred as the  innovation sequence \"",
    "[ eq : kffilterupdate ] is the time sequential kf analog of eq .",
    "[ eq : optlsq ] .",
    "the subscript @xmath9 has been omitted from all quantities to simplify notation when dealing with discrete equations and filter algorithms ( observing a subscript @xmath53 is equivalent to @xmath82 ) .",
    "the various boxes in fig . [ fig : flowchart ] compute different quantities in eq .",
    "[ eq : kffilterupdate ] .",
    "for example , the `` forecast state '' box is one step of the algorithm and provides @xmath83 . in the classic kf , the `` forecast measurement ''",
    "box is an algorithmic step providing @xmath80 given @xmath83 ( the corresponding mbf module uses a different input ) .",
    "the `` corrector '' step of the algorithm combines the aforementioned forecasts and the actual measurement @xmath88 to produce , @xmath85 . at the top of the diagram",
    ", we show that the forecasted measurements and observed measurement can be used to compute a likelihood score . beyond just providing an estimate of the unobservable position @xmath85",
    ", the kf can provide the mle .",
    "the mle , @xmath89 , is obtained by maximizes the sum of log likelihood scores associated with the observed @xmath90 over @xmath26 @xcite .",
    "traditional kf measurement equations @xcite often assume that an _ a priori _ known linear transformation , @xmath91 , which maps the state at the target filter time of interest ( @xmath86 ) to the measurement vector is available , i.e. @xmath92 `` measurement noise '' and the aforementioned measurement noise does not depend on past values of @xmath93 for @xmath94 @xcite .",
    "both conditions are violated for the motion blur model considered here and elsewhere @xcite .",
    "the time integral in eq .",
    "[ eq : contmeas ] is distributed as a gaussian , but the mean of this measurement is in terms of @xmath95 vs. @xmath96 for measurement @xmath88 . also , the measurement noise in eq .",
    "[ eq : discretemeas ] is statistically dependent on @xmath93 for @xmath97 .",
    "more advanced treatments of the kf show how to account for  kronecker delta \" type time correlations , i.e. @xmath98 , between measurement and process noise ( e.g. , @xcite ) , however the time index offset shown in eq .",
    "[ eq : discretesdecrosscorr ] causes the kf technical challenges @xcite .",
    "the mbf overcomes these complications by fundamentally changing how @xmath99 is processed ( see fig .",
    "[ fig : flowchart ] ) as we outline in the next subsection .",
    "./fig2.eps      in this section we provide the equations and pseudocode outlining the mbf ( recall the underlying discrete model processed by the mbf was presented in eqs .",
    "[ eq : discretesde ] - [ eq : discretesdenocorr ] ) .",
    "the  parallel \" processing of @xmath99 by the forecast measurement and forecast state modules shown in fig .",
    "[ fig : flowchart ] vs. the sequential processing used by the classic kf is one key aspect that distinguishes mbf from the kf .",
    "the parallel processing of @xmath99 is used because the time integral in eq .",
    "[ eq : contmeas ] violates core assumptions behind the kf @xcite ( discussed in previous section ) . since the measurement noise induced by motion blur at @xmath86 depends on the process noise experienced in the interval @xmath100 $ ] , the mbf measurement forecast depends on linear transformations of @xmath99 and its covariance ( vs. @xmath83 and its covariance as in the classic kf ) .",
    "the parallel processing of @xmath99 mentioned above requires some modifications to modules of the classic kf algorithm shown in fig .",
    "[ fig : flowchart ] .",
    "the modified  forecast measurement \" equation reads :    @xmath101    and the modified `` corrector '' ( also known as the `` measurement update '' @xcite ) equation reads :    @xmath102    where the filter state forecast ( @xmath83 ) , the filtered state ( @xmath85 ) , and the measurement forecast ( @xmath80 ) described in the previous section have covariances @xmath103 , @xmath104 and @xmath105 , respectively .",
    "we use @xmath105 to denote the `` innovation covariance '' @xcite ( the notation @xmath103 and @xmath104 is common in the kf framework @xcite ) . recall that the parameters @xmath106 are associated with the statistically precise discretized version of eqs .",
    "[ eq : sde ] - [ eq : contmeas ] and assume @xmath107 for all @xmath53 , ( expressions for these parameters , depending on @xmath25 , are provided in the previous section and appendix ) .",
    "note that the altered measurement forecasts affects the form of the classic `` corrector '' or  measurement update \" equations @xcite .",
    "the measurement noise induced by motion blur is correlated to the process noise under the assumed model and this changes the standard form of the `` corrector '' update ( eq . [ eq : kffilterupdate ] ) , specifically under the mbf model : @xmath108    as shown in the appendix , @xmath109 .",
    "the correlation relationship in eq .",
    "[ eq : crosscor ] is used to alter the form of the standard `` corrector '' or  measurement update \" and the end result was shown in eq .",
    "[ eq : gainnew ] above ( see pgs . 116 - 117 in ref .",
    "@xcite for complete theoretical background ) .",
    "the remaining equations defining the classic kf are the same in the mbf .",
    "for example , since @xmath110 within the model considered , the `` forecast state '' updates , @xmath111 and @xmath112 , associated with the classic kf are still valid @xcite .",
    "pseudocode implementing the theoretical ideas above is provided in algorithm [ mainalg ] .",
    "note that the program flow was set up so that the classic kf could also be implemented within the mbf algorithmic framework .",
    "[ eq : gainnew ] has a fairly different form in the mbf compared to the kf .",
    "this change was required due to the aforementioned parallel processing of @xmath99 illustrated in fig .",
    "[ fig : flowchart ] ( changing other equations from the mbf to the kf essentially requires changing @xmath113 to @xmath103 as shown in the code provided on github ) .",
    "one difference worth noting is that @xmath114 and @xmath36 have different definitions when algorithm [ mainalg ] is used to process the classic kf ( the open - source code provided illustrates this feature ) .",
    "it should also be noted that although we focus on the 1d scalar case in this article , the mbf algorithm presented above is described in terms of the multivariate case .",
    "function motionblurfilter @xmath115    % * inputs * : time series of noisy position measurements @xmath90 , candidate parameter vector @xmath116 , and [ optional : time series of localization estimates,@xmath117 % * outputs * : log likelihood @xmath118 and filtered state series @xmath119    % compute discrete filter variables    @xmath120 initializefilterpars @xmath121 + @xmath122 exactmapofcontinuoustodiscrete(@xmath26 ) % note : some auxiliary variables above are solely to allow this routine to process the classical form of the kalman filter . [ alg1:conttodiscrete ]    filteredstate=@xmath123 ;",
    "@xmath118 = 0 % initialize variables to be returned    * return *  @xmath118,filteredstate      to show the modeling ideas applied to practical spt problems , we illustrate how the mbf output can process two types of trajectories commonly encountered in spt where other analysis methods encounter problems ( these trajectories exhibit some form of statistical non - stationarity ) . in these simulations , we generate exact realizations from the ou process shown in eq .",
    "[ eq : sde ] .",
    "the ipython notebooks supplementing this work have comments describing the input parameters .",
    "we describe the basic simulation at a high - level in the next paragraph and the relevance of the results afforded by the algorithm & software tool introduced within this article in the remaining paragraphs .",
    "[ sec : results ] presents larger scale simulations results ( studying multiple trajectories under systematically varied parameter regimes ) .    before proceeding , we need to introduce some simulation parameters : @xmath124 is a parameter used to model the underlying particle visiting multiple spatial locations while emitting photons used to construct a psf in one image . to model the microscope s measurement output @xmath11 ,",
    "the ou trajectory was sampled at @xmath125 and then averaged over the @xmath124 samples to mimic `` motion blur '' in one frame .",
    "the effective localization errors induced by finite photon counts and background fluorescence on the motion blurred trajectory is modeled by a mean zero gaussian , @xmath15 , and this gaussian random variable ( independent of @xmath126 ) is added to the discretely sampled and `` blurred '' trajectory . this process for simulating measurements is repeated for each of the uniformly spaced observation time .",
    "we subsequently attempted to infer / extract the parameter @xmath26 given one trajectory generated in this fashion with various estimators .",
    "ipython ( jupyter ) notebooks generating the data and graphs are provided to facilitate users implementing these techniques .",
    "additional simulation details are deferred to these notebooks since we focus on illustrating new capabilities in this section .",
    "./fig3.eps    the first example analyzes a trajectory where non - stationary phenomena affect the dynamics of the observed measurement sequence . in the trajectory shown in fig .",
    "[ fig : nonstatvelocityeg ] , the particle is being `` sucked into a harmonic well '' .",
    "there are large attractive forces at earlier times and as this particle relaxes into the harmonic well , these forces reduce in magnitude ( the forces are precisely quantified in the bottom panel of fig .",
    "[ fig : nonstatvelocityeg ] ) .",
    "the molecule s mean position and  position increments \" ( the latter is used in msd ) also change appreciably over time ( i.e. , neither the position or `` confinement forces '' have reached their stationary distribution @xcite ) .",
    "this relaxation induces the primary source of statistical non - stationarity in this example .",
    "the true instantaneous velocity in these simulations can be obtained precisely via evaluating @xmath127 .",
    "the force , @xmath128 , is obtained by dividing the velocity by @xmath129 at each point .",
    "we used the noisy position vs. time data , @xmath130 , to infer the time dependent force by using @xmath130 and the mle computed by the mbf algorithm .",
    "note that a stationarity assumption is often implicit in msd or autocorrelation ( including fourier transform ) based approaches @xcite .",
    "the msd ( computed with the 400 samples ) is shown in fig .",
    "[ fig : nonstatvelocityeg ] and illustrates artifacts induced by the fact that the position increment distribution changes over time .",
    "the mbf s estimate of the instantaneous velocity is @xmath131 ( force is estimated by dividing this by @xmath132 ) .",
    "recall that , data - driven mle parameters are denoted by hats and @xmath99 denotes the mbf s estimate ( using the mle ) at the underlying position given the measurements up to time @xmath49 ( the true position is not observable due to static and dynamic errors ) .",
    "it is emphasized that we do not use a finite difference ( fd ) scheme to estimate velocity ( i.e. , a fd scheme takes differences of measurements and divides by the time between observations ) since realized sde paths are not mathematically differentiable @xcite though the `` drift function '' ( terms in front of @xmath133 ) of the model can provide a mathematically well - defined `` instantaneous velocity '' @xcite .",
    "the supp . mat .",
    "provides an illustration of the output of a simple fd scheme applied to this trajectory to highlight this problem .",
    "[ fig : nonstatvelocityeg ] also displays a modified berglund @xcite algorithm ( accounting for constant velocity ) estimate of average force .",
    "with data sampled at 25@xmath7 for @xmath134 observations , one can obtain an accurate trajectory of both velocity and force .",
    "note that in the parameterization shown in eq .",
    "[ eq : sde ] , the drift function provides a model of the instantaneous velocity ( the velocity plot is shown in the supp .",
    "fig . 5 ) . extracting the instantaneous force from the drift function requires appealing to a fluctuation dissipation relationship as well as an accurate estimation of the diffusion coefficient .",
    "it is envisioned that there are many situations where one might not want a time averaged force or velocity ( e.g. , one would miss the `` relaxation event '' at earlier times of this trajectory ) . furthermore , as we show in fig .",
    "[ fig : diffprofile ] , the mbf allows unbiased estimation of the diffusion coefficient , @xmath4 over a wide range of molecular diffusivities and exposure times , whereas other state - of - the - art methods introduce biases in @xmath4 ( and hence biases in estimated force ) .",
    "./fig4.eps    the second example focuses on how our approach can utilize statistics characterizing localization uncertainty information computed in individual images .",
    "the top panel of fig .",
    "[ fig : rvaryingeg ] displays a confined trajectory . in this trajectory ,",
    "the effective localization noise is simulated to increase over time due to photobleaching effects ( introducing non - stationarity in measurement statistics ) .",
    "time dependent localization noise is commonly encountered when multiple gfp dyes are used to tag a molecule and/or background , e.g. @xcite . the nominal localization noise in the input sequence @xmath135 is intended to come from a typical spt localization method applied to a psf ( e.g. , @xcite ) , however it is acknowledged that the psf measured not only contains contributions from static and dynamic errors , but the uncertainty estimate is likely an idealized limit ( hence the data - driven effective static measurement noise magnitude will differ from the input sequence ) .",
    "the version of the sample software provided permits estimation of a constant off - set , @xmath51 , from the input @xmath135 ( the code can be easily modified to account for more complex models ) . if no input sequence is provided , the code estimates a constant time independent effective static measurement noise .",
    "the ( known ) true static localization error magnitude of the noise added to the trajectory is shown in the bottom panel of fig .",
    "[ fig : rvaryingeg ] .",
    "parametric or non - parametric estimates of this type of noise trend from the time series data alone can be difficult if trajectories are not long @xcite and/or if the exposure times associated with the measurements are large .",
    "fortunately , various theoretical approximations for the lower - bound of the uncertainty associated each localization at @xmath49 can be obtained with established methods @xcite . however",
    ", these uncertainty estimates often appeal to large sample cramer - rao bounds ( crb ) @xcite which are not reflective of the true `` static error '' observed in practice .",
    "finite sample error and real - world features ( including motion blur ) not accurately modeled often make the empirical data exhibit error different than the crb .",
    "the bottom panel of fig .",
    "[ fig : rvaryingeg ] displays a time varying crb type localization estimate .",
    "even though the crb estimates are overly optimistic , this type of time dependent localization information ( i.e. , uncertainty estimates provided by a 3rd party piece of software ) can be used to aid kinetic analysis .",
    "both the classic kf and the mbf are able to utilize the noisily measured data and the ( possibly biased ) time dependent localization information afforded by image analysis @xcite to jointly infer the kinetic parameters .",
    "recall that the mbf code provided estimates a constant off - set adjustment @xmath51 to the input localization noise standard deviation ( an estimated zero off - set of the localization noise implies perfect agreement with the input static noise standard deviation ) .",
    "the mbf can use the observations and blur information encoded in eqs .",
    "[ eq : sde]- [ eq : contmeas ] to consistently estimate both the empirical effective static measurement noise and the kinetic parameters governing motion despite slightly biased time varying localization input .",
    "the kf assumes the measurements are reflective of the instantaneous position of the particle at the time of the measurement and underestimates the net static noise magnitude ( this effect is expected from the results reported originally in ref .",
    "@xcite for a `` pure '' diffusion case ) .",
    "it is emphasized throughout that accurately modeling fluctuations and measurement noise enables one to extract higher quality information from individual trajectories .",
    "for example , @xmath136 ( the long time msd limit assuming the sde parameters are fixed and @xmath137 @xcite ) is accurately estimated via the mbf .",
    "an mle estimate of 0.22 was obtained from the data using a single trajectory ( 400 observations spaced by @xmath138 ) without requiring the selection of tunable parameters ( the true value of @xmath136 was 0.20 ) . in msd computations processing a single trajectory , the `` time lag ''",
    "is often denoted by @xmath139 and a single point in an msd curve fixes @xmath139 and computes the average of @xmath140 over time . however , many estimates relying on the msd include biases induced by `` time lag truncation '' . in practice ,",
    "the full trajectory is rarely used for msd computations",
    "@xcite since there is less data available for larger values of @xmath139 .",
    "using a subset of the available @xmath139 values is what we refer to as `` time lag truncation '' error .",
    "time lag truncation is usually carried out heuristically and the decision of where to truncate can affect parameter estimates based on msd @xcite .",
    "for example , if one averages over the last 1/4 of the msd displayed in fig .",
    "[ fig : rvaryingeg ] , an estimate of @xmath141 0.17 is obtained for the plateau value . if one ignores the first and last quarters of the data , an estimate of 0.28 is obtained ( such heuristic truncations are commonly used in msd and this is a well - known problem with msd @xcite ) .",
    "note that msd curves also inherently include unnecessary additional noise source ( e.g. , noise due to aggregating position increments over disparate times ) .",
    "our approach , using the full sequence of data ( without tunable parameters ) , is close to the truth despite the high degree of noise observed in the msd .",
    "the ability to systematically leverage time dependent localization information ( afforded by physics based models @xcite ) into the mbf and carry out likelihood inference is practical benefit of the mbf approach .",
    "hence , we have provided examples of how to achieve this in our associated ipython notebooks .",
    "a variety of techniques have attempted to utilize msd approaches to quantify both static and dynamic error statistics @xcite . however , as we illustrated in the previous subsection , msd approaches ignore useful time - ordered information .",
    "specifically msd methods aggregate increments from potentially disparate times .",
    "this aggregation can degrade dynamic information and complicate analyzing the msd .",
    "likelihood based techniques have been applied to spt tracking problems previously @xcite , though , the aforementioned works ignore the time correlation effects induced by purely static error in addition to making unnecessary approximations of the likelihood function .",
    "one approximation used is the so - called euler ( sometimes referred to as the euler ",
    "maruyama @xcite ) approximation .",
    "the euler approximation is a numerical integration technique which simulates a generic sde , @xmath142 , via @xmath143 where @xmath144 and @xmath145 ( this brownian increment can be simulated precisely , but the other numerical approximation errors can be large @xcite ) .",
    "we remind the reader that eq .",
    "[ eq : discretesde ] - [ eq : discretemeas ] solve the assumed sde and measurement equation precisely without any numerical integration or euler type approximation ( hence temporal and spatial statistics are consistent with the sde model in eq .",
    "[ eq : sde ] - [ eq : contmeas ] ) .",
    "time series methods appealing to the euler approximation can cause a high degree of parameter estimation bias even in the measurement noise free cases @xcite . ignoring statistical time correlation induced by localization and motion blur",
    "further degrades estimates of parameters .",
    "inaccurate likelihood approximations ( like those induced by the euler approximation ) also prevent researchers from applying reliable consistency tests to fitted models since the likelihood does not correspond to the assumed model @xcite .",
    "in addition to the aforementioned issues , implicit spatial or temporal stationarity assumptions are made in many spt approaches @xcite . the first work ( to this author s knowledge ) treating static and dynamic error induced by motion blur in spt using a likelihood based approach was berglund s pioneering work @xcite .",
    "berglund @xcite considered a constant diffusion model contaminated by static and dynamic error ( extending to a `` directed '' or constant velocity model , where velocity is time and space independent , is straightforward due to the measurement difference formulation used as shown by the python companion code ) .",
    "however , measurement difference @xcite based schemes typically make a time stationarity assumption .",
    "that is , they assume that moments and time correlations of increments of measurements , @xmath146 are independent of @xmath9 .",
    "stationary assumptions are also commonly made in power spectral methods @xcite and `` nonparametric '' approaches @xcite . in refs .",
    "@xcite , an approximate bayesian approach was used to approximate temporally and spatially dependent velocity and force ( an euler approximation of the likelihood was utilized ) , but the approach did not account for the time correlation effects of static or dynamic measurement noise ( i.e. , established kf ideas were not used and the likelihood was inexact ) .",
    "maximum likelihood time series estimation of parameters determining spatially dependent velocity and force using the standard kf likelihood have been studied in single - molecule manipulation studies @xcite and in spt @xcite .",
    "@xcite extended the kf to allow `` switching linear dynamical systems '' and used a nonparametric bayesian approach to systematically determine regime switching with an exact likelihood .",
    "however , in refs .",
    "@xcite , effects of motion blur were lumped into the effective measurement error since both @xmath4 and @xmath147 were small and the  exact \" kf likelihood was computed corresponding to a model only technically accounting for static measurement errors .",
    "in the results that follow , we focus on analyzing @xmath148 time series containing @xmath149 observations with a uniform time spacing , @xmath147 , between observations .",
    "the data is modeled as being collected in uniform continuous illumination , a common situation in cell biology @xcite .",
    "for all simulations reported in this section , we study a constant localization noise , @xmath150 , @xmath151 , @xmath63 , and initial conditions drawn from the stationary distribution in order to focus on the effects of motion blur on confined trajectories . to facilitate comparison and reduce noise due simply to random number generation",
    ", we analyze the same batch of trajectories with three estimators : the modified berglund directed diffusion model with motion blur , the classic kf ( without motion blur ) , and the new mbf . to illustrate that our derived variance and mean formulas are valid",
    ", we simulate @xmath152 points spaced by @xmath153 using the exact known solution to the ou process and average these quantities to approximate the integral in the eq . [",
    "eq : contmeas ] .",
    "the @xmath124 parameter determines the accuracy of approximating the integral in eq .",
    "[ eq : sde ] .",
    "we did not simulate the discrete realizations from the analytically derived motion blur results ( derived in appendix ) to illustrate that our equations are correct and perform reasonably even if the uniform continuous illumination model contains discretization errors . in practice , pixelation and other factors @xcite often introduce discrete sampling errors not completely captured by the motion blur model in eq .",
    "[ eq : contmeas ] .",
    "each parameter estimate reported in this section used @xmath154 and a separate mle was obtained for each of the @xmath148 trajectories ( i.e. , trajectories were not combined to find a single parameter vector ) .",
    "the supp . mat .",
    "reports results with shorter trajectories corresponding to the main plots shown ( @xmath155 ) .",
    "./fig5.eps    in fig .",
    "[ fig : diffprofile ] , we fix @xmath156 , @xmath151 , and analyze various diffusion coefficients @xmath157 ( the latter two values were inspired by the lattice light sheet msd results reported in ref .",
    "@xcite ) and @xmath147 s ranging from 5@xmath7 to 100 @xmath7 . in the upper left panel ,",
    "we plot the median ( solid symbol ) and @xmath158 and @xmath159 percentiles ( dashed lines ) of the empirical parameter distribution obtained by analyzing the @xmath148 trajectories and obtaining the mle of the mbf on logarithmic scale .",
    "the other panels zoom in on the diffusion coefficient estimates and also show the modified berglund estimator ( this estimator models motion blur and constant velocity , but ignores spatial variation in velocity ) and the classic kf estimates ( the kf estimator ignores motion blur , but models spatial variations in velocity ) .",
    "note that the mbf consistently estimates the diffusion coefficient over the wide range of @xmath4s and @xmath147 s considered .",
    "the other two estimators fail for different reasons . for large @xmath4 and/or large @xmath147 ( where large is relative to typical spt studies ) ,",
    "the effects of motion blur become pronounced and bias the kf s diffusion coefficient estimation .",
    "note that for smaller @xmath4 ( consistent with large macromolecular complexes ) , @xmath147 must be quite large before unmodeled motion blur affects diffusion estimation . in the berglund estimator ,",
    "the effects of nonzero @xmath54 inducing confinement become more pronounced at larger @xmath147 and this adversely affects @xmath4 estimation regardless of the magnitude of @xmath4 ( despite motion blur being modeled in this model ) . _",
    "the ability of the mbf algorithm to reliably model @xmath4 s relevant to spt in the presence of varying degrees of confinement and exposure times is expected to aid researchers in spt . _",
    "./fig6.eps    next we fix @xmath160 and @xmath161 and vary @xmath54 in fig .",
    "[ fig : kappaprofile ] ( the supp .",
    "mat reports @xmath162 results ) .",
    "this value of @xmath4 was selected since the classic kf and mbf were shown to be similar for this range of values .",
    "the interest is in determining the accuracy of the estimated @xmath4 and @xmath54 as the latter varies in the presence of motion blur .",
    "a large positive value for @xmath54 corresponds to high confinement or a small  corral radius \" . recall that the  corral radius \" @xmath163 and",
    "the parameter @xmath65 quantifies the length of the region the particle can explore under confinement ( see sec .",
    "[ sec : physicalsde ] ) . at small @xmath147",
    ", estimates of @xmath4 are consistent with one another for both the classic kf and the new mbf , however the berglund motion blur mles only begins to converge to the other two as the corral radius is increased ( i.e. , as confinement decreases ) .",
    "we point out that the rate of convergence of the berglund @xmath4 estimate to that of the mbf ( the mbf nests the berglund estimator considered ) is primarily dictated by @xmath147 for a fixed @xmath54 .    in fig .",
    "[ fig : kappaprofile ] , it is shown that estimates of @xmath54 obtained using the kf and mbf likelihoods are relatively close to one another for the corral radius values studied ( @xmath54 is not reported for the berglund estimator since it is not included in this model ) .",
    "however , the median of the kf and mbf s mle are biased from the known truth due to the discretely sampled finite length trajectories producing the mle vector ( the mle mean / median converges to the truth as @xmath164 for a correctly specified ou model ) .",
    "this finite time series sample size bias effect is known and well understood for stationary ou models sampled without measurement error @xcite .",
    "if both the time series data and innovation covariance are effectively stationary and mean zero , the bias correction technique introduced in @xcite for the kf ( applicable to data observed with measurement error ) can be heuristically applied to the mbf estimates . was accurate . ] after applying the correction outlined in ref .",
    "@xcite , the bias corrected parameters of the mbf estimates are shown to coincide more closely with the true data generating process s @xmath54 .",
    "we stress that , in this example , we started in the stationary distribution ( having mean zero ) and the measurement noise did not vary over time .",
    "when the technical conditions hold for bias correction , the expectation of the parameter improves on average . also note that the bias correction is derived for the expected value obtained when averaging over multiple trajectories of length @xmath149 .",
    "the bias correction improves performance on average @xcite , but it has a probability of degrading estimates even when all technical conditions required to apply the correction hold . if the data is confined ( or is `` mean reverting '' @xcite ) around a nonzero mean at steady state , subtracting the empirical mean is a pragmatic way of `` enforcing '' the @xmath151 condition analyzed in ref .",
    "inherently non - stationary finite trajectory length bias correction requires additional research . tends to be small since there is more `` relaxation '' information encoded in the time series sequence and the practical utility of a bias correction scheme",
    "is reduced as can be verified empirically using the code provided . ]    in fig .",
    "[ fig : ecdf ] , we use the innovation sequence computed at the mle to test the quality of the model via goodness - of - fit tests @xcite .",
    "when analyzing experimental live cell data , one rarely has the luxury of `` ground truth '' , so checking modeling assumptions against data is an important step .",
    "here , we attempt to see if the correlation induced by the ( simulated ) motion blur can be detected when the classic kf is applied to blurred data . for this purpose ,",
    "we re - analyzed the @xmath165 case shown in fig .",
    "[ fig : diffprofile ] and computed the @xmath166 test statistic @xcite .",
    "the @xmath166 test statistic aims to check if the conditional mean and correlation structure of the generalized residual series is consistent with that of a correctly specified model @xcite ( ignoring effects of motion blur primarily affects correlation in the generalized residual series ) .",
    "we plugged in the mle for the kf and mbf ( recall that the same trajectory was fit with multiple estimators ) and used the data to compute the @xmath166 statistic for the @xmath167 trajectories of length @xmath134 . the empirical cumulative distribution function ( ecdf ) of the @xmath167 test statistics is displayed for the two estimators .",
    "the vertical dashed lines plot the critical values corresponding to the limit normal null distribution of the @xmath166 statistic @xcite .",
    "the fraction of tests statistics greater than these critical values can be rejected at a nominal type i error rate for these to be the true type i error rates @xmath168 @xcite . ]",
    "indicated by the graph . by inspecting the intersection of the vertical lines with the ecdf , the fraction of the @xmath148 trajectories rejected for a nominal @xmath168 can be determined .",
    "we simply picked a `` conservative '' and `` liberal '' rejection threshold to plot , however researchers can use the information encoded in the ecdf to carry out a test at any nominal type i error level . for example , if one selected @xmath169 , @xmath170 of the kf fits are rejected when motion blurred data is fit with a model not accounting for the effects of motion blur .",
    "as @xmath149 increases , the statistical power ( ability to reject if the observed data is inconsistent with the assumed model ) increases whereas the test statistics computed using the mbf innovation likelihood exhibit rejection rates just below the expected type i error rates . to illustrate how power increases with @xmath149",
    ", we show results obtained using the same parameters , but increasing trajectory length to @xmath171 . using @xmath169 , @xmath172 of the kf fits",
    "are rejected with the increased @xmath149 value .    before concluding , we make some technical notes . for likelihood based time series analysis , it is recommended that a `` reasonable '' number of observations are used to estimate parameters ( accuracy depends on a variety of factors including @xmath147 , @xmath26 , @xmath149 , etc . ) some guidance about parameter accuracy and variability in the measurement noise free case can be obtained from probability and statistical theory @xcite , but much theory is asymptotic in nature . using simulations in the parameter regime of interest to quantify the bias and mle parameter variability",
    "is recommended .",
    "the interested reader can tweak these parameters in the supplied ipython notebooks to explore different regimes . at one extreme ,",
    "if the product of @xmath54 and @xmath147 is  large \" relative to the spatial and temporal resolution afforded by the measurement device , then detecting the temporal correlations in the time series data will be problematic with finite @xmath149 under the model assumed in eq .",
    "[ eq : sde ] . in this",
    "setting , using the parameterization used here , an mle algorithm will typically estimate the stationary variance correctly , @xmath173 , but the individual components may not be reflective of the underlying truth . at the other extreme ,",
    "when the true @xmath54 is near zero , other well - known technical problems occur due to so - called `` unit root '' technical complications arise @xcite . in spt terms",
    ", this effectively means no appreciable confinement can be detected and the particle may be exhibiting simple  free \" or `` directed '' diffusion .",
    "hence if the mbf analysis predicts @xmath174 within statistical uncertainty , appropriate caution should be taken .",
    "in live cell data , it is not expected that simple pure `` free '' or `` directed '' diffusion exist .",
    "some degree of confinement ( due to the inherent crowded nature of the cell ) is almost always expected to be experimentally detectable in mobile particles tracked _ in vivo _ with the resolution afforded by modern optical microscopes . despite the technical caveats stated above",
    ", we have demonstrated that high accuracy parameter estimates can be obtained for fairly wide range of @xmath54 s @xmath147 s and @xmath4 s relevant to spt with reasonably `` small '' @xmath149 using the mbf .    ./fig7.eps",
    "the motion blur filter ( mbf ) algorithm was shown to be capable of consistently estimating parameters required for extracting forces and diffusion coefficients given a single trajectory contaminated by static and dynamic measurement errors .",
    "the approach can handle the three most popular spt models ( confined , directed , and `` pure '' diffusion ) .",
    "the approach can consistently estimate molecular motion parameters from individual trajectories ( enabling quantification of heterogeneity ) in situations where the diffusion coefficients , @xmath4 , span four orders of magnitude and the camera exposure times range from 5 - 100 @xmath7 in the presence of confinement . as discussed in sec .",
    "[ sec : physicalsde ] and elsewhere @xcite , accurate and unbiased estimation of @xmath4 is important in obtaining spatially dependent effective molecular forces from position vs. time spt data .",
    "it was demonstrated that state - of - the - art estimators can not consistently estimate motion parameters due either to neglected motion blur or confinement effects . using state - of - the - art estimators which do not explicitly model confinement and motion blur results in substantial biases of @xmath4 ( hence affecting estimates of molecular forces ) .",
    "other pragmatic issues arising when analyzing individual trajectories , e.g. how to account for time varying localization accuracy , how to correct for parameter bias encountered when trajectories are discretely sampled with finite length samples ( finite sample size bias is prevalent in time series estimation @xcite ) , and how to test fitted models against data with the mbf were discussed and demonstrated . to facilitate implementation and promote reproducible research , we have provided python scripts and ipython notebooks on github ( this code both demonstrates general use and can also reproduce figs .",
    "[ fig : nonstatvelocityeg ] - [ fig : rvaryingeg ] ) .",
    "the approach , as presented , processed individual trajectories since a variety of microscopy techniques are now capable of producing long , high time resolution data from different imaging modalities @xcite .",
    "both the localization quality and temporal resolution can deviate substantially from theory @xcite ( or even vary over time ) and depend on the modality ( e.g. , the fluorescence channel in multicolor experiments can have different quality ) .",
    "our algorithm can handle these practical complications faced by spt researchers and produce output from different experiments which aims at removing experimental measurement and sampling artifacts to produce motion parameters representative of the true underlying tagged particle . as we demonstrated in this work ,",
    "a large source of bias introduced by the experimental apparatus is `` motion blur '' .",
    "the software provided can be used to empirically explore different regimes of interest and the accuracy afforded by the mbf approach .",
    "if a researcher desires to estimate one of the three popular spt motion models ( confined / corralled , directed , `` pure '' diffusion , or some combination of these ) , it is recommended to use the mbf since the algorithm has demonstrated accuracy in many regimes of relevance to spt ( whereas other estimators are biased in some regimes ) .",
    "if it is discovered or believed that the parameters characterizing the dynamics driving the motion of the molecule(s ) of interest at a given spatial location in a cell are independent of time @xcite , one can modify our algorithm to aggregate multiple time series even if they have vastly different localization precisions or exposure times .",
    "for example , one could use each trajectory to produce a likelihood function ( given trajectory specific localization information ) and then develop a cost function which aims to find the single parameter vector minimizing the net sum of the log likelihoods .",
    "however , this trajectory aggregation requires a strong assumption regarding spatial and temporal stationarity and we believe that potentially interesting transient molecular events will be missed by this type of approach @xcite , hence we advise researchers to start by analyzing data on a trajectory - wise basis @xcite .",
    "in addition to parameter estimation , the likelihood based scheme provides diagnostic statistics which can be used to check statistical modeling assumptions directly against data via goodness - of - fit tests without `` ground truth '' ( checking both shape and/or statistical dependence assumptions implicit in the model @xcite ) .",
    "we demonstrated the ability of these tests to detect unmodeled correlations in the classic kf induced by motion blur effects .",
    "however , the same hypothesis testing procedure can also be used to determine whether the assumptions required to carry out the `` trajectory aggregation '' mentioned above ( e.g. , use many different trajectories to estimate a parameter vector characterizing the dynamics at a fixed spatial location ) are justified by the empirical data .",
    "the mbf estimator leveraged signal processing and stochastic process ideas to synthesize a new algorithm capable of addressing many open practical issues facing spt data analysis .",
    "the dynamical model underlying the mbf is a continuous time linear sdes driven by `` standard brownian diffusion '' @xcite . as stated in the introduction",
    ",  anomalous diffusion \" can result when one averages over many types of dynamical states @xcite , however resolution afforded by contemporary microscopes permits temporal resolution where standard diffusion models are useful .",
    "a primary aim of this work is to provide a computational tool which can be leveraged when the molecular events of interest occur within the spatial and temporal resolution of optical microscopes before signatures of  anomalous diffusion \" manifest themselves in the data . under these conditions",
    ", backing out  effective forces \" from the local molecular diffusivity is reasonable @xcite . for longer trajectories",
    ", this may require one to segment trajectories into distinct kinetic states @xcite and then apply the analysis to the segments .",
    "we did not present segmentation results , but the likelihood based mbf algorithm can be used to modify the cost function of existing state - of - the - art time series segmentation algorithms @xcite and remove artifacts induced by motion blur and unknown localization noise ( these noise sources are ubiquitous in spt data analysis ) .    explicitly accounting for motion blur is also expected to facilitate segmenting data where multiple imaging modalities ( where data is acquired with different temporal resolutions and/or exposure times ) are combined to describe the dynamics of individual molecules in living cells .",
    "we presented 1d ( scalar ) illustrative examples , but the mbf algorithm can process multivariate signals .",
    "however , obtaining closed - form expressions for the filter quantities is slightly complicated by matrix exponentials .",
    "the computational challenges with multivariate extensions is left to future work .",
    "the author thanks kerry bloom for helpful motivating discussions and comments related to this as well as kerry bloom , scott lundberg , and two anonymous referees who provided valuable comments which improved the exposition of this paper .",
    "this research was supported by internal r&d funds of ursa analytics , inc .",
    "the well - known solution to the ornstein - uhlenbeck ( ou ) sde ( eq . [ eq : sde ] ) can be written explicitly as : @xmath175    where @xmath176 and @xmath177 @xcite .",
    "the solution above can be written in terms of simple gaussian random variables since the ou process is one of the rare cases where a sde can be solved in closed - form by appealing to integration factor techniques used in standard ordinary differential equations .  solved \" means the process can be written explicitly in terms of time and a brownian motion path . when an sde is  solved \"",
    ", realizations can be constructed without numerical integration approximations of any deterministic or stochastic integrals @xcite .",
    "the expression above can be used to compute closed - form expressions for : @xmath178 = & a + fr_0 \\\\",
    "\\label{eq : hfa } \\mathbb{e}[\\frac{1}{\\delta}\\int_0^\\delta r_\\delta | r_0 ]   = & h_a + h_fr_0   \\\\",
    "h_f = & \\frac{1}{\\delta}\\int_0^\\delta \\exp(-s \\kappa)ds \\\\ \\nonumber &   =   \\frac{1}{\\kappa\\delta}(1 - \\exp(-\\delta\\kappa ) ) \\\\ h_a = & \\frac{1}{\\delta}\\int_0^\\delta \\big(1-\\exp(-s \\kappa)\\big)\\mu ds   \\\\ \\nonumber & =   \\mu - \\frac{\\mu}{\\delta\\kappa } + \\frac{\\mu \\exp(-\\delta\\kappa)}{\\delta\\kappa } \\\\ \\mu : = & \\frac{v}{\\kappa } \\\\\\end{aligned}\\ ] ]      since the ou process considered is linear and driven by standard brownian motion , it is characterized by the first two moments and covariances of the process .",
    "the means have been defined above .",
    "the second moments and covariances can also be computed as an explicit function of time and @xmath26 for the model considered .",
    "recall that the kf and mbf uncertainty estimates both are centered around using covariances of mean zero estimates to make various linear projections @xcite . in what follows , without loss of generality ,",
    "we assume @xmath180 is statistically independent of @xmath181 and that @xmath182 , @xmath151 ( so the relation @xmath183   $ ] holds for @xmath184 ) , and @xmath64 . under these non - restrictive conditions and using the well - known quadratic variation properties of brownian motion @xcite , one has the following closed - form relationship for the state covariance @xcite :   +   +   +      the above expression is valid for @xmath185 .",
    "the state covariance above can be used to solve for the variance and covariance of other quantities required by the mbf .",
    "specifically one needs to compute both @xmath186 $ ] and @xmath187 $ ] to solve the `` corrector '' update ( see fig . [",
    "fig : flowchart ] ) .",
    "the former expectation provides @xmath188 and the latter provides the contribution of motion blur , @xmath189 , to the net measurement covariance @xmath190 stated in eq . [ eq : kffilterupdate ] .",
    "note that in the mbf where uniform illumination is assumed , we use both @xmath147 and @xmath25 to represent the exposure time .",
    "the order of time integration and expectation can be exchanged for @xmath191 for the process considered , e.g. @xmath186 = \\frac{1}{\\delta } \\int^\\delta_0 \\mathbb{e}[r_\\delta r_t]dt$ ] @xcite .",
    "this reduces the problem to solving standard time integrals , since @xmath192=\\mathrm{cov}(r_t , r_s)$ ] ( recall our non - restrictive assumptions on the process mean ) has already been solved in terms of @xmath193 and @xmath194 as shown above . with this background",
    ", it can also be shown that :      the first line in the set of equations above is to remind the reader that it is assumed no  missing frames \" exist in the uniform illumination measurement model stated in eq .",
    "[ eq : contmeas ] .",
    "missing frames may occur in time lapse experiments or if quantum dots blink ( both missing frames and more exotic shutter functions could be considered within the mbf framework , but these cases require a more complicated notation which we have elected not to explore in this article which introduces the basic mbf ) . combining the expressions for @xmath196 above , with the expressions for @xmath197",
    "reported previously ( see below eq .",
    "[ eq : fa ] ) , @xmath198 ( see eq .",
    "[ eq : covq ] ) and the expressions for @xmath199 ( see eq . [ eq : hfa ] ) provide the closed - form expressions required to precisely discretize the model reported in eqs . [",
    "eq : sde ] and [ eq : contmeas ] without any statistical approximations in the filtering framework .",
    "we remind the reader that all the quantities derived depend implicitly on both @xmath147 and @xmath26 .    80ifxundefined [ 1 ] ifx#1 ifnum",
    "[ 1 ] # 1firstoftwo secondoftwo ifx [ 1 ] # 1firstoftwo secondoftwo `` `` # 1''''@noop [ 0]secondoftwosanitize@url [ 0 ]  + 12$12  & 12#1212_12%12@startlink[1]@endlink[0]@bib@innerbibempty link:\\doibase 10.1038/nmeth928 [ * * ,   ( ) ] link:\\doibase 10.1038/nrmicro1615 [ * * ,   ( ) ] link:\\doibase    10.1111/j.1600 - 0854.2008.00763.x [ * * ,   ( ) ] link:\\doibase    10.1038/nmeth.1176 [ * * ,   ( ) ] link:\\doibase    10.1146/annurev.biochem.77.070606.101543 [ * * ,   ( ) ] link:\\doibase 10.1002/bip.21592 [ * * , ( ) ] link:\\doibase 10.1016/j.cell.2011.11.001 [ * * , ( ) ] link:\\doibase    10.1016/j.bpj.2012.08.054 [ * * ,   ( ) ] link:\\doibase 10.1016/b978 - 0 - 12 - 391857 - 4.00009 - 4 [ * * ,   ( ) ] link:\\doibase 10.1101/gad.179804.111 [ * * ,   ( ) ] link:\\doibase 10.1016/j.cub.2014.06.072 [ * * , ( ) ] link:\\doibase 10.1101/gad.2021311 [ * * ,   ( ) ] link:\\doibase 10.1126/science.1139740 [ * * , ( ) ] link:\\doibase 10.1101/gr.157008.113 [ * * ,   ( ) ] link:\\doibase    10.7554/elife.00654 [ * * ,   ( ) ] link:\\doibase 10.1038/nrmicro3154 [ * * ,   ( ) ] link:\\doibase    10.1529/biophysj.105.066670 [ * * ,   ( ) ] link:\\doibase 10.1073/pnas.0900245106 [ * * ,   ( ) ] link:\\doibase    10.1021/nl103247v [ * * ,   ( ) ] link:\\doibase 10.1073/pnas.1012868107 [ * * ,   ( ) ] @noop ( ) link:\\doibase    10.1091/mbc.e14 - 06 - 1127 [ * * ,   ( ) ] link:\\doibase 10.4161/nucl.36275 [ * * ,   ( ) ] link:\\doibase 10.1038/nnano.2014.12 [ * * , ( ) ] link:\\doibase 10.1126/science.1257998 [ * * ,   ( ) ] link:\\doibase    10.1126/science.aab3500 [ * * ,   ( ) ] link:\\doibase 10.3389/fmicb.2015.00607 [ * * , ( ) ] link:\\doibase 10.1021/jp062024j [ * * ,   ( ) ] http://www.ncbi.nlm.nih.gov/pubmed/20866658 [ * * ,   ( ) ] link:\\doibase    10.1016/j.bpj.2012.03.062 [ * * ,   ( ) ] link:\\doibase 10.1038/nmeth.2367 [ * * ,   ( ) ] @noop * * ,   ( ) link:\\doibase 10.1021/jp4064214 [ * * , ( ) ] link:\\doibase 10.1016/j.bpj.2014.10.018 [ * * ,   ( ) ] link:\\doibase 10.3390/molecules191118381 [ * * ,   ( ) ] link:\\doibase 10.1016/j.bpj.2013.12.055 [ * * ,   ( ) ] link:\\doibase 10.1103/physreve.89.022726 [ * * ,   ( ) ] link:\\doibase 10.1103/physreve.91.062716 [ * * ,   ( ) ] link:\\doibase 10.1038/nmeth.3441 [ * * ,   ( ) ] link:\\doibase 10.1016/j.bpj.2014.12.016 [ * * , ( ) ] link:\\doibase 10.1371/journal.pone.0137633 [ * * ,   ( ) ] link:\\doibase 10.1038/nmeth.3483 [ * * ,   ( ) ] link:\\doibase 10.1088/0034 - 4885/76/4/046602 [ * * ,   ( ) ] link:\\doibase 10.1039/c4cp03465a [ * * ,   ( ) ] link:\\doibase 10.1016/s0006 - 3495(93)81253 - 0 [ * * ,   ( ) ] link:\\doibase 10.1529/biophysj.105.075176 [ * * ,   ( ) ] link:\\doibase 10.1016/s0006 - 3495(97)78820 - 9 [ * * ,   ( ) ] link:\\doibase    10.1021/nn402787a [ * * ,   ( ) ] link:\\doibase 10.1073/pnas.1315202110 [ * * ,   ( ) ] link:\\doibase 10.1529/biophysj.104.042457 [ * * ,   ( ) ] link:\\doibase 10.1016/j.molcel.2015.02.033 [ * * ,   ( ) ] link:\\doibase 10.1016/s0006 - 3495(02)75618-x [ * * ,   ( ) ] link:\\doibase 10.1016/s0006 - 3495(04)74193 - 4 [ * * ,   ( ) ] link:\\doibase 10.1103/physreve.92.052707 [ * * ,   ( ) ] @noop _ _  ( ,  ,  ) @noop _ _ ( ,  ,  ) @noop * * ,   ( ) @noop * * ,   ( ) link:\\doibase    10.1117/12.842178 [ * * ,   ( ) ] @noop _ _  ( ,  ) @noop _ _  ( ,  ,  ) @noop * * ,   ( ) link:\\doibase 10.1016/j.bpj.2015.09.003 [ * * , ( ) ] link:\\doibase 10.1016/s0076 - 6879(10)72003 - 6 [ * * ,   ( ) ] link:\\doibase 10.1016/j.bpj.2009.10.051 [ * * ,   ( ) ] link:\\doibase 10.3905/jod.2002.319183 [ * * ,   ( ) ] @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) link:\\doibase 10.1016/j.jeconom.2008.11.001 [ * * ,   ( ) ] @noop * * ,   ( ) @noop * * ,   ( ) link:\\doibase 10.1016/j.bpj.2015.02.003 [ * * , ( ) ] link:\\doibase 10.1109/tsp.2010.2102756 [ * * ,   ( ) ]"
  ],
  "abstract_text": [
    "<S> single particle tracking ( spt ) can aid in understanding a variety of complex spatio - temporal processes . </S>",
    "<S> however , quantifying diffusivity and confinement forces from individual live cell trajectories is complicated by inter- & intra - trajectory kinetic heterogeneity , thermal fluctuations , and ( experimentally resolvable ) statistical temporal dependence inherent to the underlying molecule s time correlated confined dynamics experienced in the cell . </S>",
    "<S> the problem is further complicated by experimental artifacts such as localization uncertainty and motion blur . </S>",
    "<S> the latter is caused by the tagged molecule emitting photons at different spatial positions during the exposure time of a single frame . </S>",
    "<S> the aforementioned experimental artifacts induce spurious time correlations in measured spt time series that obscure the information of interest ( e.g. , confinement forces and diffusivity ) . </S>",
    "<S> we develop a new maximum likelihood estimation ( mle ) technique that decouples the above noise sources and systematically treats temporal correlation via time series methods . </S>",
    "<S> this ultimately permits a reliable algorithm for extracting diffusivity and effective forces in confined or unconfined environments . </S>",
    "<S> we illustrate how our approach avoids complications inherent to mean square displacement ( msd ) or autocorrelation techniques . </S>",
    "<S> our algorithm modifies the established kalman filter ( which does not handle motion blur artifacts ) to provide a likelihood based time series estimation procedure . </S>",
    "<S> the result extends berglund s motion blur model [ pre , * 82 * ( 2010 ) ] to handle confined dynamics . </S>",
    "<S> the approach can also systematically utilize ( possibly time dependent ) localization uncertainty estimates afforded by image analysis if available . to our knowledge , this is the first technique explicitly treating confinement and motion blur within a time domain mle framework that uses an exact likelihood ( time domain methods facilitate analyzing non - stationary signals ) . </S>",
    "<S> our new estimator is demonstrated to be consistent over a wide range of exposure times ( @xmath0 ) , diffusion coefficients @xmath1 - 1 @xmath2 , and confinement widths ( @xmath3 ) . </S>",
    "<S> we demonstrate that neglecting motion blur or confinement can substantially bias estimation of kinetic parameters of interest to researchers . </S>",
    "<S> the technique also permits one to check statistical model assumptions against measured individual trajectories without `` ground truth '' . the ability to reliably and consistently extract motion parameters in trajectories exhibiting confined and/or non - stationary dynamics , without exposure time artifacts corrupting estimates , </S>",
    "<S> is expected to aid in directly comparing trajectories obtained from different experiments or imaging modalities . </S>",
    "<S> a python implementation is provided ; open - source code will be maintained on http://www.github.com/calderoc/motionblurfilter[github ] .    </S>",
    "<S> = 1 </S>"
  ]
}