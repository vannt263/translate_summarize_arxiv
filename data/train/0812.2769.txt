{
  "article_text": [
    "many physical phenomena are modeled by partial differential equations ( pdes ) which describe the relations between one or more scalar or vector fields and the surrounding media . when boundary conditions are prescribed , a common approach to achieving a numerical solution is to impose a grid and discretize the equations , thus getting a system of linear equations . in some cases , this approach yields a system of equations with very large differences between coefficients of the equations .",
    "examples of such systems arise in modeling flow through heterogeneous media with widely - varying permeability , oil reservoir simulation , electromagnetics and semiconductor modeling .",
    "such systems are commonly referred to as systems with `` discontinuous coefficients '' .",
    "one of the most common methods for tackling such problems is the domain - decomposition ( dd ) approach , in which the domain is partitioned into subdomains , with the subdomain boundaries conforming to the boundaries between the different media .",
    "dd techniques typically operate as follows : some boundary conditions are assumed to exist on the interfaces between subdomains , and a solution of the equations in each subdomain is obtained , often with only low accuracy .",
    "the boundary conditions at the interfaces are then updated according to these solutions , and the process is repeated until convergence is achieved .",
    "there exists a vast literature on this subject , and a review of the area is beyond the scope of this work ; see , for example , @xcite .",
    "dd techniques may be difficult to implement on unstructured grids or when the boundaries between domains have a complicated geometry .",
    "we consider nonsymmetric linear systems with discontinuous coefficients derived from convection - diffusion elliptic pdes with small to moderate convection terms .",
    "it is shown that a simple preconditioning technique , which we call _ geometric scaling _ ( gs ) , can be applied to the system of equations in order to improve the convergence properties of algorithms applied to the system .",
    "gs(@xmath1 ) , with an integer parameter @xmath2 , consists of dividing each equation by the @xmath0-norm of its vector of coefficients .",
    "gs , which is a particular form of diagonal scaling on the left , is geometric in the following sense : after applying gs(@xmath1 ) to a linear system , all the rows of the system matrix have a unity @xmath0-norm .",
    "in order to examine the general usefulness of gs in conjunction with various solution methods , we tested it with the two leading krylov subspace solvers for nonsymmetric systems : gmres @xcite and bi - cgstab @xcite .",
    "both algorithms were tested with and without the ilut preconditioner @xcite on several nonsymmetric problems taken from ( or based on ) saad @xcite , van der vorst @xcite , and graham and hagger @xcite .",
    "four basic problems were considered , as well as several variations of the problems , such as modifications of the differences between the coefficients and various grid sizes .",
    "results are provided for three different levels of accuracy .",
    "our experiments used the @xmath3-norm , but the @xmath4-norm yielded similar results .",
    "our results can be characterized as follows :    in most cases , when the tested method ( algorithm / preconditioner combination ) converges to the specified accuracy criterion , gs speeds up the convergence time .    in many cases , when the tested method stagnates or diverges on the original system , it converges on the scaled system .",
    "gs was not particularly useful on problems without discontinuous coefficients .",
    "gs was not helpful on problems derived from pdes with large convection terms .",
    "such pdes produce linear systems with very large off - diagonal elements , and these require other solution methods .",
    "we also provide data on the effect of gs on the distribution of the eigenvalues .",
    "it is generally considered to be detrimental to the convergence of krylov subspace methods to have a large accumulation of eigenvalues near the origin . in the cases examined here",
    ", there is a large accumulation of eigenvalues near the origin , and gs appears to `` push '' many eigenvalues away from the origin . also , the eigenvalues of the scaled system appear to be distributed similarly to those obtained without scaling but with equal - sized coefficients .",
    "note that the above choice of algorithm / preconditioner combinations does not imply that these methods are optimal for the above problems .",
    "finding an optimal method is problem - dependent and a topic for further research .",
    "diagonal scaling is not new , and its usefulness for discontinuous coefficients has also been noted .",
    "van der sluis @xcite deals with the effect of scaling on the condition number of matrices .",
    "widlund @xcite writes that well - scaled adi methods give good rates of convergence when the coefficients of elliptic problems vary very much in magnitude ( adi stands for the alternating direction implicit method @xcite ) .",
    "graham and hagger @xcite write that diagonal scaling has been observed in practical computations to be very effective as a preconditioner for problems with discontinuous coefficients .",
    "duff and van der vorst @xcite write that on vector machines , diagonal scaling is often competitive with other approaches . regarding diagonal scaling of symmetric matrices ,",
    "see meurant ( * ? ? ?",
    "8.1 , 8.2 ) , who also has some reservations about the usefulness of diagonal scaling for parallel processing @xcite .",
    "gambolati et al .",
    "@xcite use the least square logarithm ( lsl ) scaling on the rows and the columns of the system matrix for a certain problem in geomechanics with discontinuous coefficients .",
    "however , most previous works are concerned with symmetric systems and diagonal scaling refers to multiplying the system matrix on the left and on the right by the same diagonal matrix , in order to preserve symmetry . also , there is no study on the general usefulness of geometric scaling for nonsymmetric problems with discontinuous coefficients .",
    "the idea of geometric scaling was found to be useful for certain problems in image reconstruction from projections ; see @xcite .",
    "dd methods are often mentioned in connection with parallel processing .",
    "the equations of different domains can , in principle , be solved in parallel by different processors . however , the different domains that arise in many practical situations do not necessarily lead to an optimal load - balancing assignment of equations to processors . with the gs approach , inherently parallel algorithms such as bi - cgstab and gmres",
    "can be implemented efficiently in parallel without regard to subdomain boundaries .",
    "needless to say , gs is inherently parallel .",
    "the rest of this paper is organized as follows .",
    " [ back ] presents some essential background .",
    " [ prob1][prob4 ] deal with the four different problems , and  [ conclusions ] concludes with a summary and some future research directions .",
    "throughout the rest of the paper , we assume that all vectors are column vectors , and we use the following notation : @xmath5 denotes the dot product of two vectors @xmath1 and @xmath6 , which is also @xmath7 . given a vector @xmath8 , we denote its @xmath0-norm by @xmath9 . for @xmath10",
    ", we will omit the index and just write @xmath11 . if @xmath12 is an @xmath13 matrix , we denote by @xmath14 the @xmath15th row - vector of @xmath12 ; i.e. , @xmath16 .",
    "consider a system of @xmath17 linear equations in @xmath17 variables : @xmath18    we shall assume throughout that ( [ linear ] ) is consistent and that @xmath12 does not contain a row of zeros .",
    "for @xmath2 , we define a diagonal matrix @xmath19 .",
    "the geometrically - scaled system is defined as @xmath20    in some algorithms , gs(@xmath1 ) is an inherent step in the following sense : either the scaling is executed at the beginning as an intrinsic part of the algorithm , or , executing the algorithm produces identical results to those obtained when gs(@xmath1 ) is done at the beginning . as an example , it is easy to see that gs(2 ) is inherent in the kaczmarz algorithm ( kacz ) @xcite .",
    "kacz can be described geometrically as follows : starting from an arbitrary point @xmath21 as the initial iterate , kacz projects the current iterate orthogonally towards a hyperplane defined by one of the equations .",
    "the hyperplanes are chosen in cyclic order .",
    "the tests were run using the aztec software library @xcite , which includes a wide range of algorithms and preconditioners , suitable for sequential and parallel implementations .",
    "geometric scaling with the @xmath4-norm is a built - in option in aztec ( where it is called `` row - sum scaling '' ) .",
    "as mentioned we used bi - cgstab and gmres , with and without ilut .",
    "restarted gmres was used with krylov subspace size of 10 . in aztec , gmres is implemented with a double classical gram - schmidt orthogonalization step .",
    "ilut was implemented with aztec s default parameters of drop tolerance = 0 and fill - in = 1 .",
    "these parameters are not necessarily optimal for the tested examples , but since our purpose was to demonstrate the general usefulness of gs , we stuck with a commonly - used restart value for gmres and aztec s default values for ilut .",
    "no doubt , better convergence properties and runtimes would be obtained if these parameters were fine - tuned to each problem .",
    "the eigenvalue computations were done with the lapack linear algebra package @xcite .",
    "we also experimented with the option of multiplying the system matrix @xmath12 by @xmath22 on the left and on the right , resulting in the system @xmath23 , with @xmath24 . in one problem ,",
    "the results were somewhat poorer than those obtained with gs , but otherwise , the results were similar . note that this option is computationally more expensive .",
    "gambolati et al .",
    "@xcite remark that when using ilu(0 ) , the iteration matrix of bi - cgstab on a diagonally scaled system ( on the left and/or the right ) is theoretically the same as the one with ilu(0 ) on the original matrix . in our experiments ,",
    "the effect of ilut was identical to that of ilu(0 ) , so in theory , bi - cgstab with ilut on the original and the scaled systems should have behaved similarly . however , our experiments indicated that using gs produces much better numerical results , and this also holds for gmres with ilut .",
    "this is probably due to the fact that the scaled system does not have very large differences between coefficients , so it is much less prone to roundoff errors .      in two dimensions ,",
    "the general form of the second - order differential equations in this study was @xmath25 where @xmath26 and @xmath27 are given functions of @xmath28 and @xmath29 , `` @xmath30 '' stands for lower - order derivatives , and @xmath31 is a prescribed rhs . in three dimensions , there are three given functions @xmath32 of @xmath33 , and a second order partial derivative w.r.t .",
    "@xmath34 was also included .",
    "boundary conditions were either dirichlet or mixed dirichlet and neumann .",
    "the regions were taken as the unit square or the unit cube .",
    "the discretization of the second - order derivatives at a given grid point @xmath35 was done using central differences ; e.g. , @xmath36 was approximated as @xmath37 & = & \\left(a_{i+\\half , j}(u_{i+1,j}-u_{i , j } ) / \\delta x -              a_{i-\\half , j}(u_{i , j}-u_{i-1,j } ) / \\delta x \\right ) / \\delta x \\\\[5pt ] & = & \\left ( -(a_{i+\\half , j } + a_{i-\\half , j } ) u_{i , j } +        a_{i+\\half , j } u_{i+1,j } + a_{i-\\half , j } u_{i-1,j } \\right ) / \\delta x^2 \\end{aligned}\\ ] ] all problems were discretized with equally - spaced grids , and the initial value was taken as @xmath38 .",
    "the tests were run on a pentium iv 2.8ghz processor with 3 gb memory , running linux .",
    "there are several stopping criteria which one may apply to iterative systems .",
    "our stopping criterion was to use the relative residual : @xmath39 , where @xmath40 was taken as @xmath41 , @xmath42 and @xmath43 .",
    "in some of the cases , this was not attainable .",
    "since this stopping criterion depends on the scaling of the equations , we always made this test on the geometrically - scaled system using the @xmath3-norm . in order to limit the time taken by the methods implemented in aztec , the maximum number of iterations was set to 10,000 .",
    "the aztec library has several other built - in stopping criteria : numerical breakdown , numerical loss of precision and numerical ill - conditioning . in the results , we denote the relative residual by rel - res , and non - convergence by `` no conv . ''",
    "one should note that the test for numerical breakdown in aztec uses the machine precision dbl_epsilon , and this may result in a premature notice of numerical breakdown in some cases . to get around this problem",
    ", we multiplied the variable brkdown_tol in the bi - cgstab algorithm by some small factor , such as @xmath44 .",
    "( brkdown_tol is normally set equal to dbl_epsilon , which is approximately @xmath45 on our machine ) .",
    "problem 1 is taken from saad ( * ? ? ?",
    "* , problem f2db ) .",
    "it is a two - dimensional pde @xmath46 where @xmath47      1 & \\mbox{otherwise }         \\end{array } \\right.\\ ] ] and @xmath48 and @xmath49 .",
    "the dirichlet boundary condition @xmath50 is used on the boundary , and the rhs @xmath51 is immaterial since the vector @xmath27 of the linear system is chosen as @xmath52 , where @xmath12 is the system matrix and @xmath53 .",
    "table [ tbl1 ] shows the number of iterations and runtimes of the various algorithm / preconditioner methods , with and without gs , on a grid of @xmath54 . in cases of stagnation ,",
    "the table shows the relative residual that was achieved before stagnation .",
    "note that gs enables the convergence of bi - cgstab without ilut ; this is useful in a parallel setting , because bi - cgstab is inherently parallel but ilut is not an ideal parallel preconditioner .",
    "we can also see that gs is slightly helpful to bi - cgstab with ilut , and , for low - accuracy , also to gmres with and without ilut .",
    "another observation is that when gmres ( with and without ilut ) stagnates before reaching the prescribed convergence goal , gs postpones the stage at which stagnation sets in , and enables convergence to a level that is acceptable for most practical applications .",
    ".no .  of iterations and runtimes for problem 1 .",
    "grid size = @xmath54 . [ cols= \" < ,",
    "> , < , > , < , > , < \" , ]     figure [ dist4 ] provides a histogram of the real part of the eigenvalues of problem 4 , for the original , the scaled , and the continuous ( @xmath55 ) cases .",
    "the histogram provides an additional view of how the eigenvalues are distributed in the three cases .",
    "gs is proposed as being useful for discontinuous coefficients when the convection terms are small to moderate . in order to demonstrate this , we considered problem 4 with @xmath55 , a grid size of @xmath56 , and varying convection terms .",
    "the previous results were based on convection terms of 100 , so we also tested this case with convection terms of 200 , 500 , and 1000 .",
    "the results , which are summarized in table [ limit ] below , show how the usefulness of gs degrades as the convection terms are increased .",
    "* method / convection : * & * 100 * & * 200 * & * 500 * & * 1000 * + & & & & + bi - cgstab &  &  &  &  + with gs & @xmath43 & @xmath43 & @xmath43 &  + & & & & + bi - cgstab+ilut & @xmath43 & @xmath41 &  &  + with gs & @xmath43 & @xmath41 &  &  + & & & & + gmres &  &  &  &  + with gs & @xmath41 & @xmath41 &  &  + & & & & + gmres+ilut &  &  &  &  + with gs & @xmath41 &  &  &  +   +   +   +    note in particular the difference between bi - cgstab without ilut and bi - cgstab with ilut : it turns out that without ilut , gs enables convergence to @xmath43 even with convection = 500 , but with ilut , degradation already appears with convection = 200 ; this degradation is independent of the use of gs .",
    "in this paper we have reported on a very simple technique for improving the convergence properties of algorithms on certain linear systems with discontinuous coefficients .",
    "the technique , called geometric scaling ( gs ) , consists of simply dividing each equation by the @xmath0-norm of its vector of coefficients .",
    "gs , with @xmath10 , was tested on four nonsymmetric problems derived from convection - diffusion elliptic pdes , with small to moderate convection terms .",
    "bi - cgstab and restarted gmres , with and without ilut , were tested on the four problems with and without gs .",
    "normally , such problems are solved by domain decomposition ( dd ) techniques , but these can be difficult to implement if the boundaries between the subdomains have a complicated geometry or the grid is unstructured .",
    "the problems were taken from ( or based on ) well - known examples from the literature , and included two- and three - dimensional cases , with dirichlet and mixed dirichlet / neumann boundary conditions .",
    "one problem had a complicated geometry .",
    "three different convergence goals were prescribed : relative residual @xmath57 .",
    "table [ tbl_sum ] summarizes the convergence behavior of the four different algorithm / preconditioner combinations , with and without gs , on the four different problems , for the three convergence goals .",
    "the results indicate that gs was very useful in improving the convergence status of the different solution methods on the tested problems . with one exception ,",
    "when the solution method converged on a problem with discontinuous coefficients , gs speeded up the convergence .",
    "eigenvalue distribution maps show that when there is a strong concentration of values around the origin , gs reduces this concentration very significantly and `` pushes '' the values away from the origin .",
    "* method * & * problem 1 * & * problem 2 * & * problem 3 * & * problem 4 * + & & & & + bi - cgstab & @xmath58 & @xmath58 & @xmath58 & @xmath58 + with gs & @xmath59 & @xmath60 & @xmath58 & @xmath59 + & & & & + bi - cgstab+ilut & @xmath59 & @xmath61 & @xmath59 & @xmath59 + with gs & @xmath62 & @xmath63 & @xmath64 & @xmath64 + & & & & + gmres & @xmath65 & 1.37 & @xmath58 & 0.27 + with gs & @xmath66 & @xmath67 & @xmath58 & @xmath68 + & & & & + gmres+ilut & @xmath69 & 0.90 & @xmath58 & 0.29 + with gs & @xmath66 & @xmath70 & @xmath59 & @xmath71 +   +   +   +    this study is only a first report on this subject , and much work remains to be done . on the theoretical side ,",
    "we have seen that gs improves the eigenvalue distribution , but further analysis is still needed . on the practical side ,",
    "gs needs to be tested in conjunction with other algorithms and preconditioners , on various other difficult problems .",
    "a natural question that arises is how does gs compare with dd techniques ? over the years , these methods have achieved a high level of efficiency , and a head - on runtime comparison is very much problem - dependent and a topic for further research .",
    "however , an even more interesting topic is the combination of the two methods : apply gs to the equations and then apply some standard dd method ; hopefully , on some problems , gs could also improve the convergence properties of some dd approaches .",
    "gs can also help the parallelization of solution methods in several ways .",
    "firstly , gs itself is a parallel computational step .",
    "secondly , it enables the partitioning of a domain into subdomains along boundaries that do not necessarily follow the physical boundaries of the problem ; this way , better load balancing can be achieved .",
    "thirdly , as seen in some of the cases , gs enabled the convergence of algorithms that are inherently parallel without the need for a preconditioner ( such as ilut ) that may not be ideal for parallelism .",
    "another topic for further research is the application of the ( sequential ) cgmn algorithm @xcite and its block - parallel version carp - cg @xcite on problems that have discontinuous coefficients and are also strongly convection - dominated .",
    "these algorithms have already been shown to be very effective on convection - dominated problems and initial experiments with discontinuous coefficients have yielded good results .",
    "the reason for this may be that these two methods are essentially conjugate - gradient acceleration of the kaczmarz algorithm , and as such , gs ( with the @xmath3-norm ) is already inherent in them ."
  ],
  "abstract_text": [
    "<S> linear systems with large differences between coefficients ( `` discontinuous coefficients '' ) arise in many cases in which partial differential equations ( pdes ) model physical phenomena involving heterogeneous media . </S>",
    "<S> the standard approach to solving such problems is to use domain decomposition ( dd ) techniques , with domain boundaries conforming to the boundaries between the different media . </S>",
    "<S> this approach can be difficult to implement when the geometry of the domain boundaries is complicated or the grid is unstructured . </S>",
    "<S> this work examines the simple preconditioning technique of scaling the equations by dividing each equation by the @xmath0-norm of its coefficients . </S>",
    "<S> this preconditioning is called geometric scaling ( gs ) . </S>",
    "<S> it has long been known that diagonal scaling can be useful in improving convergence , but there is no study on the general usefulness of this approach for discontinuous coefficients . </S>",
    "<S> gs was tested on several nonsymmetric linear systems with discontinuous coefficients derived from convection - diffusion elliptic pdes with small to moderate convection terms . </S>",
    "<S> it is shown that gs improved the convergence properties of restarted gmres and bi - cgstab , with and without the ilut preconditioner . </S>",
    "<S> gs was also shown to improve the distribution of the eigenvalues by reducing their concentration around the origin very significantly .    </S>",
    "<S> * keywords .  * </S>",
    "<S> _ bi - cgstab ; diagonal scaling ; discontinuous coefficients ; domain decomposition ; geometric scaling ; gmres ; gs ; lp - norm ; linear equations ; nonsymmetric equations ; parallel processing ; partial differential equations . </S>"
  ]
}