{
  "article_text": [
    "[ secintro ]      [ subsecfirstphase ]    experimental units of data that are distributed over lines and areas , known as functional data , are best represented as curves and surfaces , respectively ; and we expect that these will vary in height over any particular point .",
    "but we often notice that the continuous substrate of the data seems itself to be transformable , and that these transformations vary across functional observations .",
    "figure  [ ethanol ] displays four peaks for each of four samples of wines in the part of the nuclear magnetic resonance ( nmr ) spectrum corresponding to ethanol .",
    "two of these wines are red , one is white , and one is a ros .",
    "we notice that most of the variation across these four samples is due to the peaks of the white and ros wines being displaced to the right relative to those for the red wines .",
    "it is known that the ph level in a solution has this effect on the location of the couplets , triplets , and m - tuplets that nmr generates ; and also that red wines have ph s from 3.3 to 3.5 , while white ph s are in the range 3.03.3 . moreover ,",
    "the effects of ph and other factors are known to vary from one location in the spectrum to another , with displacements in opposing directions not being unusual .",
    "the functional data analysis ( fda ) literature refers to lateral displacements in curve features as _ phase variation _ , as opposed to _",
    "amplitude variation _ in curve height . as in music",
    ", we imagine that time can be compressed or stretched over different intervals in a single performance .",
    "consequently , we distinguish between measured clock time and related but different time scales .",
    "relative to human growth time , for example , puberty for girls occurs on average at the age of 11.7 years , but hormonal and other physiological factors shift this age forward and backward to the variable clock times that parents actually see .",
    "[ fig2 ]    few time - varying events are more important than the weather .",
    "figure  [ winter8889 ] allows us to explore phase variation in montreal s daily temperature variation over three winters , winter being the most dynamic period in the canadian climate year .",
    "we see here several important markers of phase variation .",
    "there are two minimum temperatures in most winters , the first positioned around january 15 and the january thaw that separates them typically arrives on january 25 .",
    "we notice , too , the increased volatility in temperature in the two months in the dead of winter .",
    "the two horizontal lines mark temperatures of great importance to canada s economy .",
    "the five degree celsius threshold is the point at which cash crops in the canadian prairies germinate , and their total growth depends on , in addition to precipitation , the total number of degrees above this threshold prior to harvest .",
    "minus seven degrees is the threshold below which ice has enough structural integrity to support winter river crossings and year - round ice dams around tailing ponds for the many mines in the north .",
    "global warming is altering the dates at which these thresholds are crossed . the small plateaus in the spring and fall mark out the arrival and departure of snow , respectively .",
    "we see that winter arrived in both 1988 and 1989 particularly early , and with an intense cold snap in 1989 , while the 1987 winter was typical in its timing .",
    "summer phase variation , by contrast , seems small . predicting phase variation is of great importance in weather prediction , crop management , and far northern transportation .",
    "once recognized , one sees phase variation everywhere .",
    "parents see children reaching puberty over a wide range of ages , and perhaps wonder if there is some connection between the timing of the pubertal growth spurt and adult height .",
    "growth implies positive change , and figure  [ growth ] displays the growth of ten girls in the berkeley growth study @xcite as the positive first derivative of height in the top panel , as well as the acceleration of height or derivative of growth in the bottom panel .",
    "musicians alter the timing of notes in subtle ways to create tension and define mood , achieving in this way their unique auditory signature as performers .",
    "golfers and baseball players , on the other hand , tend to find phase variation in their swings to be an impediment to fine control over amplitude variation , and train to the point where it is nearly eliminated .",
    "we can articulate the concept of phase variation by distinguishing between _ clock time _ @xmath1 and _ system time _ @xmath2 .",
    "that is , we envisage the spectra of wines , the weather , and children as evolving over their respective continua at variable rates determined by processes that we may at least partially understand and would like to know more about .",
    "consequently , when large - scale phase variation is compared to the clock time , defined these days in terms of the number of oscillations of the cesium atom , we envisage a functional relationship @xmath3 that can vary from one wine type to another , over successive winters , and across children even within the same family .",
    "however , the system times are defined so that all girls will reach puberty at the same age .    in most cases",
    ", we can expect that the mapping @xmath4 , often called the _ time warping function _",
    ", will be smooth and strictly increasing , two properties captured in the term _ diffeomorphism_. in other words , we require that the inverse function value @xmath5 exists everywhere in the support of the functional data since we need to use @xmath6 to align a feature such as the pubertal growth spurt across multiple curves . as statisticians ,",
    "we look for ways to estimate the @xmath4 s associated with different units of data distributed over the base continuum , as well as ways of using discrete and continuous covariate observations to explain and predict them .",
    "other conditions such as specified boundary behavior are added as makes sense for the context at hand .",
    "for example , the time taken to produce a sample of handwriting will vary from replication to replication , so that @xmath7 may map , say , the interval @xmath8 $ ] into the interval @xmath9 $ ] where @xmath10 is a fixed template time .",
    "but if the observation is also supposed to reflect _ when _ the handwriting event took place , then simple shifts , @xmath11 , will provide a better model .",
    "if the process under study may reasonably be expected to have one or more derivatives , then the chain rule requires that @xmath4 , too , be differentiable to the same extent . in any case",
    ", it seems unlikely that in many real - world applications the problem constraints will allow for sharp jumps in @xmath4 , so that smoothness can be added to monotonicity as a property .",
    "the following single - parameter expression for @xmath4 mapping @xmath12 $ ] into itself serves as an illustration and is often useful : for @xmath13 , @xmath14\\quad\\mbox{and } \\nonumber\\\\[-7pt]\\\\[-7pt]\\nonumber h^{-1}(s{|}\\beta ) & = & \\frac{1}{\\beta } \\log \\biggl[\\frac{s(e^{\\beta t } - 1 ) + t}{t } \\biggr].\\end{aligned}\\ ] ] the expression converges to the identity warp @xmath15 as @xmath16 .",
    "this model , taken from @xcite , can also be derived from a later equation [ equation ( [ logd ] ) ] by setting the function @xmath17 .     that maps the growth time of the pubertal growth spurt , indicated by the circle , into the early clock time in the left panel .",
    "the bottom right panel shows the corresponding warping function for the late growth spurt .",
    "this shows how phase variation is effectively modeled by warping functions . ]",
    "[ fig4 ]    some warping functions corresponding to early and late growth spurts are shown in figure  [ growthwarps ] . the warping function [ of the type given in equation ( [ oneparh ] ) ] in each right panel maps pubertal growth spurt on the growth ( system ) time scale into the clock or observed time scale , as indicated by the zero crossing of the growth derivative function in the left panel , that is , the peak of the spurt , as shown by a circle .",
    "the early pubertal spurt in the top panel is modeled using an @xmath4 which moves quickly through early growth phases relative to clock time ( i.e. , curves downward ) so as to produce the early clock time of about nine years , whereas the bottom panel is better modeled with an upward curving @xmath4 that reflects slower transition through early growth phases to reach the clock time of the late growth spurt of about 14 years .",
    "[ subsecphaseproblems ]    the presence of phase variation can play havoc with classical data analyses that are designed for data structures without phase changes .",
    "the heavy dashed line in figure  [ ethanol ] is the average of the ethanol peaks across forty wine samples , of which 31 are red .",
    "the heights of the mean peaks are lower than almost all corresponding sample peaks , their widths are substantially wider , and no sample peak displays the step in the middle of the down - slope of each average peak .",
    "that is , a statistical analysis as elementary as averaging takes the data well outside of their normal modalities of variation , causing it to fail as an effective data summary . a  recent review of chemometrics @xcite highlights the importance of aligning peaks in spectral data as a first step , and warns spectroscopists that getting this step right can be crucial to the quality of subsequent analyses . in fact ,",
    "most familiar data analyses are found to fail in the presence of phase variation ; variances are inflated , fits by regression models are degraded , and additional principal components are required .",
    "this paper began as a follow - up to a workshop on curve registration at the mathematical biosciences institute at the ohio state university in 2012 [ see @xcite and companion papers ] .",
    "an effective workshop raises many more questions than it answers , and this workshop left us with much to consider .",
    "is there a clear distinction between amplitude and phase variation , or is there variation that can be represented either way ? can the transformation @xmath4 be considered as a full data object , or does it just represent nuisance variation to be discarded once identified ?",
    "when phase data objects are meaningful , how can we incorporate known covariates , such as ph in the nmr context , into the estimation ? are `` features '' in a curve or surface always things like peaks , points of inflection , and threshold crossings , or can models define more general properties that become invisible on the model side of the equation when phase is properly incorporated and estimated ? are traditional fitting criteria such as error sums of squares still useful , or are they only usable when there is no phase variation ? what role should derivatives play ?",
    "can the warping function @xmath4 be as complex as is required to align features , or is it wise to impose some regularity ?",
    "when is it useful to develop data analyses that reveal aspects of the _ joint _ variation in phase and amplitude ? we will discuss some of these questions in this paper .",
    "section  [ secgoals ] defines some possible goals for curve and surface alignment or registration , and discusses ways of understanding what is amplitude and phase variation .",
    "section  [ secclassicalmethods ] considers various optimization strategies and statistical models that separate phase and amplitude variations .",
    "section  [ sec4 ] provides some links for downloading relevant softwares .",
    "section  [ secdiscussion ] considers what has been learned in working with these and other data sets , and looks forward to future research and generalizations in this fascinating area .",
    "[ secgoals ]      [ subsecidentifiability ] in this paper we will use @xmath18 to denote the observed functions with both phase and amplitude variability and @xmath19 to be the underling functions denoting only the amplitude variability , that is , after removing phase variability , such that @xmath20 .    an important challenge is _ identifiability _ of amplitude and phase variation , since which is which is apt to depend very much on prior intuitions and knowledge about how each type of variation is caused .",
    "for example , while it may seem obvious that the peaks after age eight in the top panel of figure  [ growth ] exhibit phase variation , a close look at the lower panel shows that a number of the growth - derivative functions display more than one negative slope episode prior to the final crossing of zero .",
    "what we are tempted to call early spurts may only be due to the presence of a single pre - pubertal spurt , and a late spurt may be due to two or even more pre - pubertal spurts .",
    "this tends to sound more like an amplitude - oriented explanation .        a simple example of this is a data set of linear functions on @xmath21 , @xmath22 , having the same slope , but differing intercepts . using the notation",
    "@xmath23 $ ] , that mode of variation could be entirely modeled as linear shifts , @xmath24 constructed so that @xmath25 ( i.e. , all variation is in the phase variation ) , or it could equally well be modeled as @xmath26 , the identity warp , with all of the variation in the original data appearing in the intercepts of the @xmath27 , or the variation could be split between these modes .",
    "we have tied phase variation in the wine data to a known causal factor , the ph level of the wine , but , for the weather data , it seems to depend on intuition as to whether spring came late in a particular year or whether that year was simply unusually cold .",
    "even an early velocity peak defining the pubertal growth spurt can be seen in part as a year of strong growth followed by a year of weaker growth .",
    "it is not surprising , as a consequence , that we see very little attention given to the phase variation in the evolution of statistical methodology .",
    "in particular , the distinction between phase and amplitude variation is generally not univocal , but instead depends on both the application under study and the goals of a particular analysis .",
    "we have mentioned the linear shifts earlier , but there are several possibilities when choosing a class of warpings to specify phase variation .",
    "depending on the application context , one may prefer one class over the others .",
    "we enumerate some possibilities below and illustrate an example of each in figure  [ figphase - type - examples ] :    * _ uniform scaling _ : here the warping of the time domain simply rescales it by a positive constant @xmath28 , that is , @xmath29 for all @xmath30 . *",
    "_ uniform shift _ : in this case the time axis gets shifted by a constant @xmath31 , that is , @xmath32 . *",
    "_ linear or affine transform _ : a combination of the previous two leads to a linear or affine transformation : @xmath33 , @xmath28 and @xmath31 . *",
    "_ diffeomorphisms _ : a general class that includes domain warpings is given by the set of diffeomorphisms of the domain to itself .",
    "while it is possible to define diffeomorphisms on the full real line , practical considerations make it interesting to restrict warpings to compact intervals .",
    "the set of linear transformations is contained in the set of diffeomorphisms if the domain is defined to be the full real line .",
    "while these are the main types of warping transformation , one can further enlarge the scope by including functions that allow for some flat regions ; an example is shown in the rightmost column of figure  [ figphase - type - examples ] .",
    "please refer to @xcite for a discussion on the need for such functions and a rigorous approach to handling them .",
    "[ subsecgoals ]    we can distinguish three motivations for a model that allows for phase variation . first , amplitude variation could be the main focus , with phase variation being a nuisance to be removed and then cast aside .",
    "the wine nmr spectra in figure  [ ethanol ] illustrate this nicely , in part because the goal of the analysis is specifically to model the relative heights of the clearly visible peaks , the widths of which tend to be proportional to their height .",
    "prairie crop scientists tend to focus on the total heat and precipitation available to plants in the growing season as predictors of crop yield , leaving the issue of when the season starts and finishes to the producers to wrestle with .",
    "auxologists , who study human growth , may be preoccupied by the variation in the shape characteristics of growth curves such as the variation in their amplitudes , and see the variation in the timings of the pubertal growth spurt as a nuisance to be eliminated by lining up the corresponding peaks .",
    "on the other hand , phase variation could instead contain all of the interesting information , in contexts where issues such as timing are more important than relative peak heights , such as the locations of bursts in neuronal spike train data .",
    "crop producers know that they have little control over heat and precipitation budgets , but they can look for indicators of when they can sow their seeds and when certain variants will mature . in this situation ,",
    "the time warp functions are the center of attention .",
    "finally , both amplitude and phase variation , and in fact the _ joint variation _ between these , can be central issues in the analysis .",
    "it turns out , for example , that there is a simple relation between the strength of a pubertal growth spurt and its timing , namely , that early spurts are stronger and later ones are weaker , resulting in adult final heights that do not depend much on either factor .",
    "that is , it appears that each child has a wired - in capacity for growth , but that the distribution of the expenditure of the growth energy over time can vary over children with similar growth capacities .",
    "[ subsecmodel ]    assuming the relevance of phase variation , it will be clear that both its nature and estimation strategies will depend critically on the model being proposed for the data .",
    "the cross - sectional mean is often the model of choice in feature alignment strategies ; peaks and threshold crossings are considered aligned when the mean curve is centrally located within the registered curves at all points over the interval of observation .",
    "more generally , the mean can be taken as one of many _ template _ or gold - standard curves to be approached as closely as possible in some sense by the application of phase transformations . alternatively , as described in the next section , one can compute the mean under a different metric and use that as a model for alignment . finally ,",
    "functional linear equations , low - dimensional principal component representations , differential equations , and many other mathematical structures may provide model spaces for amplitude variation that , simultaneously , identify what is meant by phase variation .",
    "that is , if a diffeomorphic transformation of the substrate of the data , possibly within some predefined class , can improve the fit of the model to the data , we define it as phase .",
    "models , of course , are usually chosen to represent a conjecture or hypothesis about what generates the data , and in this sense the identification of the amplitude / phase dichotomy is very much centered on the science underlying the application .",
    "[ subsecequivalence ]    one way to study amplitude and phase variation is through equivalence classes .",
    "the use of equivalence classes is not new to statistics .",
    "in fact , they form the core idea in statistical shape analysis @xcite and in grenander s work on pattern theory @xcite , including its applications to computational anatomy @xcite . in kendall",
    "s shape analysis the experimental units are configurations of ( landmark ) points in an appropriate space , usually two- or three - dimensional euclidean space . to focus the analysis on the _ shape _ variation in the data , nonshape aspects , such as location , rotation , and perhaps scaling ,",
    "are incorporated into equivalence classes , where point configurations are identified with each other ( i.e. , called equivalent ) when they can be translated , rotated , and scaled into each other .",
    "then , one compares shapes of objects by comparing their equivalence classes .",
    "while the past shape approaches were restricted to point sets and simple transformations ( rigid motions and global scales ) , the more recent literature has studied continuous curves with transformations that include time warpings ( more precisely , reparameterizations ) [ see @xcite and @xcite , among others ] .    in an entirely parallel fashion",
    ", one can define amplitude and phase variability in functional data using equivalence classes . as laid out in @xcite ,",
    "the main idea is to understand amplitude variation through a quantity that incorporates all aspects of phase variation inside it .",
    "this is done by defining an equivalence relation , where curves are identified or deemed equivalent when they can be time warped into each other .",
    "figure  [ figequivalence - illustrate ] shows some elements of an equivalence class  a set of warps of a single three - peak curve .",
    "the equivalence class is actually much bigger , including all diffeomorphic time warps of this curve , only some of which are shown here .",
    "these equivalence classes are now taken as representing _ amplitudes _ because they model the essence of vertical variation in a simple and natural way .",
    "the phase variation is incorporated _ within equivalence classes _ , while the amplitude variation appears _ across equivalence classes_. further motivation for how equivalence classes provide clear definitions for separation of amplitude and phase is given in section  [ sec34 ] .",
    "( see also @xcite . )        while the origins of these ideas lie in shape theory , an understanding of these concepts can also be obtained using the terminology of object - oriented data analysis ( ooda ) , as defined in @xcite and more recently discussed in @xcite .",
    "an important special case of ooda is fda , where functions are the data objects .",
    "a natural approach to the decomposition of amplitude and phase variation is to model each with appropriate data objects , with specific goals as laid out in section  [ sec23 ] . in some situations , such as the wine nmr data in figure  [ fig1 ]",
    ", the phase variation can be viewed as a nuisance , so the data objects of interest are registered curves , that is , time warped to match their peaks . in other situations , for example , the temperature data shown in figure  [ fig2 ] and for human growth curve data in figure  [ fig4 ] , interesting data objects can be any of the registered amplitude curves , or the transformations used to achieve registration ( reflecting phase variation ) , or else the concatenation of both , for situations where joint amplitude ",
    "phase variation is key . in the same spirit ,",
    "the data objects in an equivalence - class approach are the equivalence classes themselves .",
    "[ secclassicalmethods ]    in this section we look at a few curve registration techniques for estimating warping functions @xmath4 . in the first two sections , the focus is on using a template function @xmath34 as a target ,",
    "so that @xmath35 $ ] and , inversely , @xmath36 $ ] .",
    "we will see that the sense in which the approximation is defined requires considerable care , with least squares approximations computed in the usual way not being a viable candidate .",
    "the template @xmath34 is often defined using an objective function whose solution is iterative , starting with the cross - sectional mean and alternating between a registration and a recalculation of the cross - sectional mean of the registered functions .",
    "typically this process , often referred to as _ procrustes iterations _ , converges in only a few steps .",
    "[ subsecdtw ]    before examining current registration methods , it is worthwhile mentioning dynamic time warping ( dtw ) , an early registration method applied to discrete sequences of phonemes ( a basic unit of language )",
    ". @xcite devised an insertion / deletion algorithm that is rather like that of isotonic regression @xcite .",
    "the underlying algorithm , which is a dynamic programming algorithm , is an optimization technique where one partitions the graph space using a finite grid and the warping @xmath4 is restricted to be a piecewise - linear function passing through the nodes of this grid .",
    "depending on the context , one may allow it to have vertical jumps or be horizontal for multiple time - steps . in the classical dtw ,",
    "the dynamic programming algorithm is applied to minimize the least - squares cost function given in equation ( [ eqleast - squarle ] ) .",
    "dtw can be effective as a feature alignment method , as it provides a globally optimal solution , albeit on the restricted search space ( piecewise - linear @xmath4 on a fixed grid ) .",
    "but the classical dtw has the conceptual problem that it may not provide smooth differentiable time warps that many applications require .",
    "also , the computational algorithm can be greedy , in the sense of warping regions where no alignment seems called for .",
    "these problems , in general , can be handled by adding a regularization term to the cost function .",
    "[ subseclandmark ] in terms of functional data alignment , we begin with the easiest situation in which each curve @xmath37 has clearly - defined features , the timings of which can be used to estimate @xmath7 at a series of points @xmath38 .",
    "this requires , in turn , a consideration of what we might mean by `` feature . ''    in the case of the wine data , there seems to be little confusion . in most types of spectra , the presence of a chemical compound is marked by a single peak , the location of which is the desired landmark , and automatic methods for peak detection are relatively easy to devise .",
    "for multi - peak structures such as the nmr peaks in figure  [ ethanol ] , the average of the peak locations would serve the purpose .",
    "alternatively , a template can be set up for a peak shape , and a peak detector can be devised by computing correlations with moving windows of the curve shape with the template pattern .",
    "let us suppose that there is a gold standard template spectrum @xmath34 with @xmath39 peaks occurring at times @xmath40 , where times @xmath41 and @xmath42 are the endpoints of the observation interval .",
    "then , for the @xmath43th spectrum with peak locations at @xmath44 , we can estimate @xmath7 by interpolating in some suitable way the pairs @xmath45 .",
    "polygonal lines might serve , or it may be important to use a smoother interpolant having , perhaps , a specified number of derivatives . figure  [ growthwarps ] offers an elementary example of landmark registration , where the timing of a girl s pubertal growth spurt is the single landmark @xmath46 , shown as a circle in figure  [ growthwarps ] , and the intervals @xmath47 and @xmath48 for the @xmath43th girl are interpolated by the warping functions [ formed using the expression in equation  ( [ oneparh ] ) ] .",
    "peak and valley locations can be translated into crossings of zero in the curve s first derivative with negative and positive slopes , respectively .",
    "other types of crossings may also be important .",
    "for example , the heavy - duty winter in figure  [ winter8889 ] can be defined as the average of the first crossing time with negative slope for @xmath497 deg c and the second crossing time with positive slope .",
    "prairie farmers would prefer the crossing of germination threshold of 5 deg c with positive slope , and , in fact , do just that with daily soil temperature readings in may .",
    "the problem with landmarks , of course , is that they are not always visible or one may be faced with other types of feature time ambiguity such as two or more closely spaced @xmath497 deg c crossings in the temperature data . moreover , recording landmarks by hand is tedious , and fail - safe automatic detectors are sometimes hard to set up .",
    "the choice of landmark can itself be open to the kind of debate that scientists would prefer to avoid .",
    "finally , landmark registration is only discrete evidence concerning the intrinsically continuous function @xmath7 , and as such ignores what happens in between landmarks , where there may reside additional information about @xmath4 .",
    "[ subsecl2critera ]    now we look at a classical approach to functional registration that does not require the use of landmarks .",
    "let @xmath7 denote the time warping associated with the @xmath43th data item @xmath50 ; this @xmath7 can be restricted to be an element of a parametric family , defined by the value of one or more parameters , or can be fully nonparametric as in a diffeomorphism .",
    "the one - parameter warps [ equation  ( [ oneparh ] ) ] , along with simple shifts , scale changes , and linear functions of @xmath2 , are examples of simple parametric warping families , and we will propose more flexible representations in section  [ sec4 ] .",
    "it seems natural to specify a loss function @xmath39 that optimizes the congruence of a set of clock - time functions @xmath50 to corresponding warped versions of a template @xmath34 , that is , @xmath51 , where @xmath52 .",
    "the choice , however , of standard options such as @xmath53\\\\[-8pt]\\nonumber & = & \\int\\bigl[y_i(t ) - x_0\\bigl ( h_i(t ) \\bigr)\\bigr]^2 \\,dt\\end{aligned}\\ ] ] will quickly prove disappointing if combined with a flexible class of warping functions , as figure  [ l2warp ] demonstrates . in the left case , the minimization of the @xmath0 norm results in a reduction from 0.500 to 0.024 , using a piecewise - linear warping and a spike that nearly eliminates the area under the registered curve corresponding to intervals where the @xmath54 has larger amplitude than @xmath34 .",
    "in the registration process the amplitude characteristics of @xmath54 have been significantly distorted .     and its scaled version @xmath54 , as dot - dashed and dotted curves , respectively .",
    "the solid curve in the upper left panel results from minimizing the squared error criterion @xmath55 ^ 2 \\,dt$ ] with the optimal warping function @xmath4 shown in the lower left panel .",
    "the solid curve in the upper right panel results from minimizing the squared error criterion @xmath56 ^ 2 \\,ds$ ] with the optimal warping function @xmath4 shown in the lower right panel . ]",
    "this pinching effect can be mitigated by using warping functions that are constrained to be smooth , either by the use of a regularization strategy or by the use of a small number of basis functions .",
    "the registration procedures proposed in @xcite , for instance , incorporate a penalization term that forces the choice of the warping functions toward functions that do not differ significantly from the identity ( corresponding to the case of no registration ) or from constant functions .",
    "concerning instead the use of simple parametric families for the class of warping functions , the @xmath0 distance will work just fine for the one - parameter shift - warp family , @xmath57 .",
    "such a registration procedure performs perfectly for the example in figure  [ l2warp ] , where the identity warp is returned since the two peaked curves are already registered .",
    "it thus appears fundamental to appropriately relate the definitions of amplitude variation and of phase variation , that are jointly described by the loss function to be optimized and the class of warping functions .",
    "this motivates the simultaneous definition of phase and amplitude to avoid issues such as the one highlighted in figure  [ l2warp ] .",
    "for instance , the loss function @xmath39 to be optimized and the class of warping functions @xmath4 may be chosen so that for any two functions @xmath58 , @xmath59 , and any warping function @xmath4 , @xmath39 satisfies the relation @xmath60 this invariance property guarantees that it is not possible to obtain a fictitious increment of the similarity between two functional data by simply warping them simultaneously with the same warping function , and has been clarified in the context of different types of warpings in different papers .",
    "for example , @xcite ( @xcite ) and @xcite study this invariance and then specify it in the context of linear or affine transformations of the domain , while @xcite study it for diffeomorphisms .",
    "moreover , as already highlighted , the concepts of amplitude variation and of phase variation are problem - specific and depend on the application goals .",
    "for instance , if two functional data @xmath58 and @xmath59 may be considered aligned when they are proportional , that is , when @xmath61 , then it is natural to use the loss function associated to the semi - norm @xmath62 and the corresponding correlation measure @xmath63 the class of linear warping functions @xmath64 is compatible , in the sense of equation ( [ h - invariance ] ) , with the loss function associated to ( [ eql2-normalized ] ) and ( [ rhocrit ] ) , if these are computed over the full real line .",
    "this definition of amplitude / phase variation seems , for instance , well suited for the wine data , where the amplitude variation is well described by the relative heights of the peaks , rather than by their absolute heights , and where linear transformations of the abscissa allows for a good alignment of these peaks .",
    "this also holds for growth curve data , where the emphasis is on growth velocities , rather than on the height curves per se , and the children s biological clocks , with their pubertal spurts , are aligned by aiming at proportional growth velocities .",
    "@xcite used the size of the minimum eigenvalue of the order two cross - product matrix @xmath65\\\\[-17pt]\\nonumber & & \\quad   = { \\left } [ \\matrix { \\displaystyle\\int\\bigl \\{x_0(t)\\bigr\\}^2 \\,dt & \\displaystyle\\int x_0(t ) y \\bigl[h(t)\\bigr ] \\,dt \\cr \\displaystyle\\int x_0(t ) y\\bigl[h(t)\\bigr ] \\,dt & \\displaystyle\\int\\bigl \\{y\\bigl[h(t)\\bigr]\\bigr\\}^2 \\,dt } { \\right } ] . \\ ] ] the minimum eigenvalue criterion essentially measures the linearity of the relationship between @xmath34 and @xmath66 , and is the same thing as maximizing the correlation [ equation ( [ rhocrit ] ) ] between the two functions or , correspondingly , minimizing [ equation ( [ eql2-normalized ] ) ] . in other contexts ,",
    "two functional data @xmath58 and @xmath59 may be considered aligned when their first derivatives are proportional , that is , @xmath67 and , equivalently , @xmath68 .",
    "then it is natural to use the loss function in equations ( [ eql2-normalized ] ) and ( [ rhocrit ] ) , but applied to the first derivative instead . also , in this case",
    ", if the loss function is computed over the full real line , then it is compatible in the sense of equation ( [ h - invariance ] ) with the class of linear warping functions @xmath69 . and",
    "the same can of course be said for the @xmath0 distance ( [ eqleast - squarle ] ) with the shift - warp family @xmath70 .",
    "@xcite report other examples of loss - functions / class of warping functions , that define concepts of amplitude and phase variations that are appropriate in different applications . in practice ,",
    "the functional data are only available on bounded intervals , that possibly differ from curve to curve .",
    "these loss functions can then be computed over the intersection of the domains of the two functional data . in the case of the @xmath0 distance",
    ", normalizing the distance by the length of the domain intersection helps avoiding fictitious decrements of the distance as the intersection becomes smaller .",
    "it is also possible to consider much more flexible representations of phase variation and still define loss functions and class of warping functions satisfying the property ( [ h - invariance ] ) .",
    "section  [ sec34 ] is devoted to the case where the phase variation is described by arbitrary diffeomorphic transformations .",
    "[ subsecfrmetric ]    standard fitting criteria such as least squares may also be applied to transformations of the functional objects , most commonly first and second derivatives or their combinations .",
    "however , one can go even further by choosing newer metrics that are compatible with the notion of equivalence classes mentioned earlier in section  [ sec24 ] .",
    "application of the concept of equivalence classes as data objects in fda needs some rethinking of important concepts .",
    "first off , the classical notion of metrics on curves needs to be extended to metrics on equivalence classes .",
    "some consideration of this point highlights the challenges faced by classical approaches in analyzing vertical and horizontal curve variation .",
    "for example , as mentioned in the previous section , a common approach to quantifying the _ vertical distance _ between curves @xmath71 and @xmath72 is through @xmath0 norm between @xmath71 and warped @xmath72 , that is , @xmath73 . from a theoretical perspective",
    "this quantity has several problems : it is not symmetric and does not satisfy the triangle inequality .",
    "moreover , from a conceptual perspective , there are problems with this formulation , as shown in figure  [ figstevefigureb ] [ constructed by @xcite ] .",
    "the top left panel of figure  [ figstevefigureb ] shows a toy example , using two single step functions as @xmath74 and @xmath75 .",
    "one naive approach to aligning these curves is to register @xmath72 to @xmath71 using the simple piecewise - linear warp @xmath76 shown in the top right panel .",
    "the result of this is a reasonable alignment shown in the top center panel .",
    "but an equally good approach to aligning these curves is to warp @xmath71 into @xmath72 , using the alternate piecewise - linear warp @xmath77 shown in the bottom center panel .",
    "as shown in the bottom left , this also gives a high quality of alignment .",
    "the challenge in classical approaches is what should be taken as the vertical distance between @xmath72 between  @xmath71 ?",
    "the ( appropriately squared , etc . )",
    "region between the aligned curves ( representing the @xmath0 norm ) in the top center panel is clearly very different from that in the bottom left panel . now if we allow warping of both @xmath71 and @xmath72 , then many other appealing registrations could be found , for example , that in the bottom right panel , all of which are quite reasonable .",
    "a big payoff of the idea of equivalence classes as data objects is that it allows a very simple and natural metric , which essentially includes all of these reasonable alignments in its formulation .",
    "the core idea is to choose a metric that helps compare equivalence classes , and not just individual functions , since these classes provide an identifiable representation of amplitude variability in this setting .",
    "this is done in a straightforward way , by starting with a curve metric that is invariant to identical warping of its two arguments , as in equation ( [ h - invariance ] ) .",
    "that is , it should satisfy @xmath78 for all warpings @xmath4 .",
    "this is a particularization of equation ( [ h - invariance ] ) where a general loss function is replaced by a distance function .",
    "@xcite used the nonparametric form of the fisher  rao metric [ see @xcite for a short introduction to this metric ] for this purpose .",
    "in fact , since the original fisher  rao metric was defined only for positive probability densities , they extended this notion to include a larger class of functions .",
    "the actual expression for this metric is complicated and thus is not discussed in detail here , except we note that the resulting fisher ",
    "rao distance , denoted by @xmath79 , satisfies the property stated in equation ( [ eqfr - isometry ] ) .",
    "the key step in this formulation is to define a _ square root velocity function _ ( srvf ) transform , @xmath80 where @xmath81 if @xmath82 and @xmath83 if @xmath84 and @xmath85 is the first derivative of @xmath86 .",
    "it should be noted that srvf is a one - to - one map up to a translation .",
    "that is , if @xmath87 is known , then one can calculate @xmath86 back uniquely from its srvf .",
    "the srvf transforms of the ten growth curves in figure  [ growth ] are shown in figure  [ srvfgrowth ] . in this particular case , since the @xmath86 is defined to be the derivative of growth , @xmath88 refers to the acceleration curves shown in the bottom panel of figure  [ growth ] .",
    "consequently , the srvf curves cross the zero axis at the same locations , but now with very steep slope .    .",
    "]    the main reason for introducing srvf is that the fisher ",
    "rao distance between any two functions is given by the @xmath0 distance between their srvfs , that is , @xmath89 we refer the reader to @xcite for the details , but mention in passing that the proof hinges on the fact that @xmath90 , where @xmath91 .",
    "this nice mathematical structure leads to _ formal _ definitions of amplitude and phase in functional data .",
    "for any two functions , @xmath58 and @xmath59 , the actual registration problem is given by @xmath92\\\\[-8pt]\\nonumber & & \\quad= \\inf_{h }",
    "\\bigl { \\vert}{\\mathrm{srvf}}(x_1 \\circ h ) - { \\mathrm{srvf}}(x_2)\\bigr{\\vert}.\\end{aligned}\\ ] ] this formulation avoids the issue discussed in the example associated with figure  [ figstevefigureb ] .",
    "it is important to note that @xmath93 and , therefore , this alignment is not simply a least - square alignment of srvfs .",
    "the infimum value in equation ( [ eqfr - register ] ) represents a comparison of the amplitudes of @xmath58 and @xmath59 and is actually a distance between the equivalence classes discussed in section  [ sec25 ] .",
    "if the optimal @xmath4 on the left - hand side is invertible , then its inverse is also the optimal for the right - hand side of that equation .",
    "this has been called _ inverse consistency _ in the image - processing literature .",
    "the optimal @xmath4 denotes the ( relative ) phase between @xmath58 and @xmath59 .",
    "the actual optimization over @xmath4 in equation ( [ eqfr - register ] ) can be performed in many ways , depending on the problem .",
    "if @xmath4 takes a nonparametric form , a  diffeomorphism of the domain , then the dynamic programming algorithm mentioned earlier is applicable .",
    "if some application calls for smooth phases , then some common smoothing idea  either restrict to a parametric family or apply a regularization penalty  can be applied , both at a loss of some mathematical structure .",
    "we emphasize that while some applications favor smooth solutions for warpings , some others , such as activity recognition in computer vision , naturally favor warping functions that are close to being vertical or horizontal over subdomains .",
    "[ subsecwarprep ] the nature of warping functions leads to some interesting representations .",
    "the evolution of time , whether clock or system , is fundamentally a growth process , and as such , like height , has a positive first derivative .",
    "two transformations of @xmath4 play a number of useful roles in the representation and study of phase variation . using the notation @xmath94 for the derivative of @xmath4 ,",
    "the _ log  derivative transformation _ and its inverse @xmath95\\\\[-8pt]\\nonumber & \\displaystyle ( \\log d ) h(t ) - \\log c_1 = w(t)&\\end{aligned}\\ ] ] allow us to represent any diffeomorphism @xmath4 in terms of the unconstrained log  derivative function @xmath96",
    ". a natural and effective method of computing @xmath4 is to use numerical differential equation solver methods to approximate the solution of the linear forced differential equation @xmath97 $ ] using the initial value @xmath98 .",
    "moreover , from the equation @xmath99 = t$ ] the solution of the complementary nonlinear unforced equation @xmath100 $ ] defines the inverse of the warping function .",
    "since the log  derivative @xmath96 is unconstrained and defined over a closed interval , it is natural to use a basis function expansion , with the b - spline basis being the likely choice .",
    "in particular , the one - parameter model [ equation ( [ oneparh ] ) ] corresponds to @xmath101 .",
    "the overall smoothness of @xmath4 can be controlled either by the number of basis functions used or by appending a roughness penalty to a fitting criterion .",
    "it is essential that any representation be expandable to include contributions from one or more covariates @xmath102 known or conjectured to modulate phase .",
    "for example , it is well known in climate modeling that proximity to oceans retards the seasons by two to three weeks , so that a model for phase variation across weather stations would include this factor . because of global warming , long - term time itself is an important modifier of climate variables such as seasonal temperature and precipitation .",
    "covariates can be easily incorporated by extending @xmath96 to be a function of a covariate such as @xmath103 for @xmath104 .",
    "another mathematical representation for warping functions comes from the srvf idea .",
    "since @xmath94 is assumed to be positive , one can also use the positive square root @xmath105 as a representation of @xmath4 . just like @xmath96 earlier , one can use a basis expansion to express @xmath106 if @xmath4 is not constrained any further . however ,",
    "if @xmath4 represents a time warping of a fixed interval , for instance , @xmath107 $ ] , to itself , then that imposes an additional constraint on @xmath4 . in order to obtain the boundary conditions @xmath108 and @xmath109 , we require that @xmath110 or the @xmath0 norm of @xmath106 is one .",
    "this is an interesting geometric structure  the space of allowed @xmath106 functions is a unit sphere and its geometry can be exploited in the ensuing analysis .",
    "the spherical geometry of this space of @xmath106 functions has been used to perform estimation and alignment of curves in several places , including @xcite .",
    "this geometry has also been helpful in developing pca of warping functions [ @xcite ] and in alternatives to pca in the form of principal nested spheres [ @xcite ] .",
    "[ subsecmodelregistration ]    so far we have focused on pairwise registration of functions , but the alignment of multiple functions is often more of concern in analyzing real data . while some methods for multiple alignment are simple extensions of the binary case , the others take a completely fresh approach and derive models tailored to such function data objects .",
    "the former approach is generally based on constructing a _ template _ of some kind and then registering individual functions to this .",
    "this template may be constructed in an iterative fashion , as improvements in alignments improve the resulting template , and vice - versa .",
    "a simple idea for constructing a template is the cross - sectional mean , as mentioned earlier . at each iteration , one takes the currently aligned functions @xmath111 and computes their cross - sectional mean to update the template @xmath112 .",
    "( the cross - sectional mean is , of course , the mean of functional objects under the @xmath0 metric . )",
    "then , one by one , the given functions are aligned to this template to update @xmath7 s : @xmath113 .",
    "depending on the nature of data , the results of this process may be sensitive to the initial conditions .",
    "the same idea can be generalized to situations where a metric different from the @xmath0 metric is used . in the case where equivalence classes of functions are data objects",
    ", one can compute the average of the corresponding equivalence classes @xmath114,\\ldots , [ x_{n } ] $ ] , using the notion of a karcher or frchet mean .",
    "this can be done under the fisher ",
    "rao distance mentioned in the previous section .",
    "the template is then taken to be the _ center _ of the karcher mean equivalence class , chosen so that the average of the phases of @xmath115 , with respect to this center , is the identity @xmath116 . for further details of this construction and an algorithm for computing the center of an orbit , please refer to @xcite .",
    "shown in figure  [ figwine - data - alignment ] is an example of alignment using the srvf framework applied to the wine nmr spectra shown earlier .",
    "the top row shows the original spectra , the aligned spectra , and the phase functions obtained during the alignment .",
    "the bottom row of figure  [ figwine - data - alignment ] shows the same data aligned using simple shifts and minimizing the loss in ( [ eql2-normalized ] ) , using as a template one of the curves in the sample , the medoid curve , as detailed , for example , in @xcite . for these data",
    "the amplitude variation is in fact well described by the relative heights of the peaks and the shifts - warp family is able to capture very well the phase variation in the part of the spectra here considered , as also highlighted by the srvf framework .",
    "the associated shifts display a clear clustering in the phase of the red wines vs the white and ros wines .",
    "figure  [ figgrowth - female - data - alignment ] shows the alignment of the growth velocities of the 54 girls in the berkeley growth study , in the time interval 3 to 18 years  the top row displays the results obtained via the srvf framework , while the bottom row displays the results obtained on additionally smoothed data using linear warpings and minimizing the loss in ( [ eql2-normalized ] ) .",
    "the nonlinear warping in the srvf framework allows for a visibly better alignment of the growth curves , showing that in many applicative contexts nonlinear warping is indeed necessary .",
    "the linear warping , obtained after additional smoothing of data , is nevertheless able to unveil some interesting features of the data .",
    "for instance , @xcite carry out linear warping of the growth curves of both the girls and boys in the study , highlighting a neat separation of boys and girls in the phase space and other interesting aspects of the growth dynamics of the two groups .    instead of using just one template",
    ", it is often beneficial to divide data into smaller sets and use different templates for alignment in these subsets .",
    "an instance of this idea is when clustering and alignment are performed together .",
    "for instance , @xcite propose a @xmath117-mean alignment procedure that jointly performs alignment and ( unsupervised ) clustering of functional data .",
    "other proposals in this context are given by @xcite , @xcite , @xcite .",
    "another set of papers ( @xcite , @xcite , @xcite ) takes the approach where some data points serve as templates for others , and the individual warping functions are averaged to find ultimate warpings .",
    "@xcite perform registration of functional observations to the fits provided by a @xmath118-dimensional principal components analysis . in other words ,",
    "the template is constructed individually for each function using an orthonormal basis . as an illustration ,",
    "consider the 15 sections of mean - centered log - transformed mass - spectrometry intensities in the top panel of figure  [ proteomicsdata ] .",
    "the large peaks on the right are fairly well registered by a preliminary landmark registration of the whole sequence , but we see substantial phase variation in the rest of these spectrum sections that obscures important amplitude variation .",
    "three principal components were computed from these data combined with a registration of each section @xmath50 to its fit @xmath119 using a method currently under development , as well as a principal components analysis without registration .",
    "the mean squared residuals for unregistered and registered pca s were 0.0052 and 0.0038 , respectively , corresponding to a squared multiple correlation 0.47 .",
    "that means nearly half of the variation around the unregistered fit can be accommodated by modeling phase variation .",
    "the bottom part of figure  [ proteomicsdata ] displays the fits for @xmath74 and @xmath120 in its left panels , along with the deformations @xmath121 associated with the registration in the right panels .",
    "the pca is able to nicely accommodate the amplitude variation , and its fits after time warping are well aligned with all of the peaks .",
    "choice of the number of components has an important impact on this type of analysis . combining registration with model estimation or using multiple templates",
    "further blurs the distinction between amplitude and phase variation , suggesting that a successful analysis may depend heavily on prior choices guided by knowledge and intuitions about which type of variation is the primary focus .    in some contexts",
    "it also makes sense to combine the registration problem with other inferences , such as a regression problem , for a more comprehensive solution .",
    "for instance , @xcite ( @xcite ) study the problem of regression using phase and amplitude components of the given functions .",
    "software implementations of many of the methods illustrated here are available publicly .",
    "r and matlab code for implementation of the minimum eigenvalue method of ramsay and silverman can be found at  .",
    "matlab software for the extended fisher  rao srvf approach of @xcite is available at and the r package is available from cran under _ fdasrvf_. the r package fdakma @xcite implementing the k - mean alignment procedure described in @xcite is available from cran .",
    "[ secdiscussion ]    in this paper we highlight the concept of phase variability that is present in functional data and the pitfalls of ignoring it in statistical analysis . after motivating the importance of phase  amplitude separation , or alignment of functional data , in statistical analyses we proceed to summarize different ideas present in the literature for accomplishing this task .",
    "specifically , we the problem of pinching associated with the classical @xmath0-norm - based matching , and present several solutions to avoid this problem .",
    "these solutions involve either restricting the amount of warping or using an alternative metric to perform matching .",
    "we note that while several methods exist for phase  amplitude separation , this is not a completely solved problem and forms an active area of research .",
    "a major challenge comes from the lack of a single mathematical definition or algorithm that can work in all , or even most , applications and contexts .",
    "for instance , one can argue that the goals of warping in weather data will be different from that in wine spectra .",
    "similarly , while in some cases a simple translation and scaling may be sufficient for alignment of curves , the other cases require genuine nonlinear warpings for proper alignment . in some cases",
    "effective data analysis is done by seeking the best possible peak / valley alignment , for example , in spectral data . in those cases",
    "the fisher  rao method is the most effective that we have seen so far .",
    "however , in other cases too much peak alignment can be a distraction , for example , the growth curve data .",
    "therefore , it seems more natural to tailor objective functions and algorithms to the problem area .",
    "although we have focused on phase  amplitude separation of real - valued functions in this paper , this problem is prevalent in several other data object contexts .",
    "for instance , the problem of registration of images is considered a central issue in medical image registration .",
    "see @xcite for a recent survey of warping - based techniques in this problem area .",
    "the ideas presented in this paper can be extended to included higher - dimensional signals such as images .",
    "the authors thank the mathematical biosciences institute at the ohio state university , columbus , oh , for its support in organizing a workshop which led to the writing of this paper ."
  ],
  "abstract_text": [
    "<S> the abundance of functional observations in scientific endeavors has led to a significant development in tools for functional data analysis ( fda ) . </S>",
    "<S> this kind of data comes with several challenges : infinite - dimensionality of function spaces , observation noise , and so on . , there is another interesting phenomena that creates problems in fda . </S>",
    "<S> the functional data often comes with lateral displacements / deformations in curves , a phenomenon which is different from the height or amplitude variability and is termed _ </S>",
    "<S> phase variation_. the presence of phase variability artificially often inflates data variance , blurs underlying data structures , and distorts principal components . </S>",
    "<S> while the separation and/or removal of phase from amplitude data is desirable , this is a difficult problem . </S>",
    "<S> in particular , a commonly used alignment procedure , based on minimizing the @xmath0 norm between functions , does not provide satisfactory results . in this paper </S>",
    "<S> we motivate the importance of dealing with the phase variability and summarize several current ideas for separating phase and amplitude components . </S>",
    "<S> these approaches differ in the following : ( 1 ) the definition and mathematical representation of phase variability , ( 2 ) the objective functions that are used in functional data alignment , and ( 3 ) the algorithmic tools for solving estimation / optimization problems . </S>",
    "<S> we use simple examples to illustrate various approaches and to provide useful contrast between them .    </S>",
    "<S> ./style / arxiv - general.cfg    ,    ,        [ fig1 ] </S>"
  ]
}