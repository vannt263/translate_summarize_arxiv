{
  "article_text": [
    "since its introduction by @xcite , the deep boltzmann machine ( dbm ) has been one of the most ambitious attempts to build a probabilistic model with many layers of latent or hidden variables .",
    "the dbm shares some characteristics with the earlier deep belief network ( dbn ) @xcite .",
    "both models may be viewed as multi - layer or `` deep '' extensions of the popular restricted boltzmann machine ( rbm ) . however , unlike the dbn , commonly used dbm approximate inference schemes implement true feedback mechanisms where the inferred activations of high - level units can influence the activations of lower - level units .",
    "thus alternative interpretations of an input are able to compete at all levels of the model simultaneously .",
    "this sort of sophistication in inference has the potential to lead to more robust and globally coherent inferences , which are likely to translate to better performance when the model is employed in tasks such as classification .    despite its success",
    ", the dbm has not yet entirely fulfilled this potential and the dbn remains the more popular model paradigm for deep probabilistic models .",
    "one potential explanation of why this is so could be tied to the difficulties one encounters when attempting to estimate the model parameters from data .",
    "straightforward applications of gradient - based methods such as stochastic maximum likelihood ( sml ) @xcite ( also known as persistent contrastive divergence @xcite ) appear to fall in poor local minima , and fail to adequately explore the space of model parameters .",
    "one solution , as presented in @xcite , is based on a greedy layer - wise pretraining strategy which appears to overcome these poor local minima .",
    "each layer is trained as an rbm with the latent activations of the layer below as its input .",
    "these layers are then recombined by rescaling the weights to account for the doubling of inputs into each intermediate layer .",
    "while this procedure seems to work well , it involves many steps and is more complicated than would be ideal .",
    "also , more importantly , the necessity of layer - wise pretraining makes it very difficult for the organization of upper layers to influence the topological organization of lower layers .",
    "for example , in cases where we would like to learn a dbm that is not fully connected between each layer , it would potentially be very desirable for the global connectivity pattern ( eg .",
    "local receptive fields ) to influence the pattern of learned filters at all layers .",
    "layer - wise pretraining precludes this possibility .",
    "if , on the other hand , one could jointly train all layers of a deep boltzmann machine simultaneously , then the pattern of activation of the upper layer units would have an opportunity to influence the weights trained at the lower layers via their effect on lower - layer units activations .    in this paper , we describe a simple scheme for joint training of all layers of a deep boltzmann machine . our strategy is based on the observation that the poor local minima in which sml falls are characterized by high variance in the norms of the weight vectors , particularly those between the data and the first layer of hidden units .",
    "our solution is to simply add a regularization term to the standard maximum likelihood training criterion that penalizes large differences in the norms of the weight vectors , both within a layer and across neighbouring layers .",
    "our regularization is based on the intuition that successful models are those where all units contribute roughly equally to the representation of the data .",
    "this is a common principle that has previously been applied in the form of sparsity penalties for rbm and dbn training @xcite , where all hidden units are encouraged to be active over an equal proportion of the data .",
    "our application of this principal is somewhat different , we do not explicitly control the activation of the hidden units , instead we encourage equal influence of each _ active _ hidden unit .",
    "we demonstrate , with experiments , both the failure of standard sml training for dbms and the effectiveness of our regularized - sml dbm training strategy .",
    "a boltzmann machine is defined as a network of symmetrically - coupled binary stochastic units ( random variables ) .",
    "these stochastic units can be divided into two groups : ( 1 ) the _ visible _ units @xmath0 that represent the data , and ( 2 ) the _ hidden _ units @xmath1 that mediate dependencies between the visible units through their mutual interactions .",
    "the pattern of interaction is specified through the energy function : @xmath2 where @xmath3 are the model parameters which respectively encode the visible - to - visible interactions , the hidden - to - hidden interactions , the visible - to - hidden interactions , the visible self - connections , and the hidden self - connections ( also known as biases ) . to avoid over - parametrization",
    ", the diagonals of @xmath4 and @xmath5 are set to zero .",
    "the energy function specifies the probability distribution over the joint space @xmath6 $ ] , via the boltzmann distribution : @xmath7 where the partition function @xmath8 ensures that the density normalizes : @xmath9 this joint probability distribution gives rise to the set of conditional distributions of the form : @xmath10 in general , inference in the boltzmann machine is intractable .",
    "for example , computing the conditional probability of @xmath11 given the visibles , @xmath12 , requires marginalizing over the rest of the hiddens which implies evaluating a sum with @xmath13 terms : @xmath14 however with some judicious choices in the pattern of interactions between the visible and hidden units , more tractable subsets of the model family are possible .",
    "the restricted boltzmann machine ( rbm ) is likely the most popular subset of boltzmann machines .",
    "they are defined by restricting the interactions in the boltzmann energy function , in eq .",
    "[ eq : boltzmann_energy ] , to only those between @xmath15 and @xmath16 , i.e. for @xmath17 , @xmath18 and @xmath19 . as such",
    ", the rbm can be said to form a _",
    "graph with the visibles and the hiddens forming two layers of vertices in the graph . with this restriction",
    ", the rbm possesses the useful property that the conditional distribution over the hidden units factorizes given the visibles : @xmath20 likewise , the conditional distribution over the visible units given the hiddens also factorizes : @xmath21 this conditional factorization property of the rbm immediately implies that most inferences we would like make are readily tractable . for example , the conditional independence of the hiddens implies that posterior marginals of the form @xmath22 are immediately available .",
    "importantly , the tractability of the rbm does not extend to its partition function , which still involves sums with exponential number of terms .",
    "it does imply however that we can limit the number of terms to @xmath23 .",
    "usually this is still an unmanageable number of terms and therefore we must resort to approximate methods to deal with its computation .",
    "learning in the rbm is also rendered much more tractable in comparison to the general boltzmann machine .",
    "typically , learning involves finding a set of model parameters that approximately maximizes the log likelihood of a training dataset : @xmath24 this can be accomplished via gradient ascent .",
    "the gradient of the log likelihood of the data for the rbm is given by : @xmath25 where we have the expectations with respect to @xmath26 in the `` clamped '' condition , and over the full joint @xmath27 in the `` unclamped '' condition . in training , we follow the stochastic maximum likelihood ( sml ) algorithm ( also know as persistent contrastive divergence or pcd )  @xcite , i.e. , performing only one or a few updates of an mcmc chain between each parameter update .",
    "the deep boltzmann machine ( dbm ) is another particular subset of the boltzmann machine family of models where the units are again arranged in layers .",
    "however unlike the rbm , the dbm possesses multiple layers of hidden units as illustrated in figure [ fig : dbm ] . with respect to the boltzmann energy function of eq .",
    "[ eq : boltzmann_energy ] , the dbm corresponds to setting @xmath28 and a sparse connectivity structure in both @xmath5 and @xmath29 .",
    "we can make the structure of the dbm more explicit by specifying its energy function .",
    "for the 2-layer model it is given as : @xmath30 with @xmath31 .",
    "the dbm can also be characterized as a bipartite graph between two sets of vertices , formed by the units in odd and even - numbered layers ( with @xmath32 ) .",
    "a key point of departure from the rbm is that the posterior distribution over the hidden units ( given the visibles ) is no longer tractable , due to the interactions between the hidden units .",
    "@xcite resort to a mean - field approximation to the posterior .",
    "specifically , in the case of the 2-layer model , we wish to approximate @xmath33 with the factored distribution @xmath34 .",
    "such that the kl divergence @xmath35 is minimized or equivalently , that a lower bound to the log likelihood is maximized : @xmath36    maximizing this lower - bound with respect to the mean - field distribution @xmath37 yields the following mean field update equations : @xmath38    iterating eq .",
    "( [ eq : mf1]-[eq : mf2 ] ) until convergence yields the parameters used to estimate the `` variational positive phase '' of eq .",
    "[ eq : variational_gradient ] : @xmath39 \\nonumber \\\\ & = \\mathbb{e}_{q_v } \\left [       - e_{\\mathrm{dbm}}(v , h^{(1)},h^{(2 ) } )       - \\log q_v(h^{(1)},h^{(2 ) } ) \\right ]      - \\log z(\\theta ) \\nonumber \\\\ \\label{eq : variational_gradient } \\frac{\\partial \\mathcal{l}(q_{v } ) } { \\partial \\theta } & =       -\\mathbb{e}_{q_v }       \\left [       \\frac{\\partial e_{\\mathrm{dbm}}(v , h^{(1)},h^{(2)})}{\\partial \\theta }       \\right ]      + \\mathbb{e}_{p }      \\left [      \\frac{\\partial e_{\\mathrm{dbm}}(v , h^{(1)},h^{(2)})}{\\partial \\theta }      \\right]\\end{aligned}\\ ] ]    note that this variational learning procedure leaves the `` negative phase '' untouched .",
    "it can thus be estimated through sml or contrastive divergence @xcite as in the rbm case .      despite the intractability of inference in the dbm",
    ", its training should not , in theory , be much more complicated than that of the rbm .",
    "the major difference being that instead of maximizing the likelihood directly , we instead choose parameters to maximize the lower - bound on the likelihood given in eq .",
    "[ eq : variational_lower_bound ] .",
    "the sml - based algorithm for maximizing this lower - bound is as follows :    1 .",
    "clamp the visible units to a training example .",
    "2 .   iterate over eq .",
    "( [ eq : mf1]-[eq : mf2 ] ) until convergence .",
    "3 .   generate negative phase samples @xmath40 , @xmath41 and @xmath42 through sml .",
    "4 .   compute @xmath43 using the values obtained in steps 2 - 3 .",
    "5 .   finally , update the model parameters with a step of gradient ascent .    while the above procedure appears to be a simple extention of the highly effective sml scheme for training rbms , as we demonstrate in sec .",
    "[ sec : exp ] , this procedure seems vulnerable to falling in poor local minima which leave many filters effectively dead ( not significantly different from its random initialization with small norm ) .",
    "[ sec : layerwise ]    the failure of the sml joint training strategy was noted by @xcite . as a far more successful alternative",
    ", they proposed a greedy layer - wise training strategy .",
    "this procedure consists in pre - training the layers of the dbm , in much the same way as the deep belief network : i.e. by stacking rbms and training each layer to independently model the output of the previous layer .",
    "a final joint `` fine - tuning '' is done following the above sml - based procedure .",
    "while greedy layer - wise training has been shown to be reasonably successful , a means of joint training a dbm would be highly desireable . not only",
    "would it be simpler , but it would open the door to local receptive field learning and more general architectures where we would like the top - down pattern of connectivity to influence the learning of lower - level features . in this section we detail our simple proposal for a means to jointly train all layers of a dbm .    our strategy is based on the observation that standard sml - based joint training tends produce high variance in the weight vectors associated with each hidden unit  particularly across the first - layer weight vectors that connect the visible units to the first hidden layer units .",
    "our proposal is thus to regularize the maximum likelihood objective , in order to encourage units to have similar norms ( i ) within a given layer and ( ii ) to a lesser extent , across neighbouring layers .",
    "we thus introduce an additional parameter @xmath44 for each layer of the dbm , representing the average norm of weight vectors of the @xmath45-th layer .",
    "we then add a regularization term to our objective @xmath46 , which penalizes deviations from this mean - value using a squared - error penalty .",
    "@xmath44 s belonging to adjacent layers are further constrained to be close ( again in the @xmath47 sense ) .",
    "this gives rise to the following regularized objective : @xmath48    one can think of this regularization term as a spring , which ensures that the system evolves jointly from an initial random weight configuration ( where the columns of @xmath49 have small norm ) to a good model of the input distribution @xmath50 , which undoubtedly requires weight vectors with larger norms .",
    "to evaluate the effect of our regularization term , we trained deep boltzmann machines on the pervasive mnist dataset @xcite .",
    "all our models were trained for @xmath51 updates , using minibatches of size @xmath52 , varying the learning rate in @xmath53 .    [",
    "[ direct - approach ] ] direct approach + + + + + + + + + + + + + + +    our first model was a 3-layer dbm with [ 500,500,1000 ] hidden units in the first , second and third layers ( respectively ) .",
    "the resulting filters are shown in figure  [ fig : bad_filters ] .",
    "as we can see , many of the first - layer filters are not significantly different from their random initialization , with very small norm . based on the difference between these results and the successful training of an rbm",
    ", we speculate that the top - down interactions prevent the first layer from learning useful filters .",
    "we have confirmed that the high - frequency `` noise '' filters are actually the ones with lowest norm .",
    "it seems as though early top - down input is influencing the activations of these hidden units , perhaps directly through some form of suppression , or indirectly , by reinforcing the activation of the subset of filters which become useful early on . while we plot filters for 3-layer networks , the same results hold for networks of depth two .",
    "[ [ joint - training ] ] joint training + + + + + + + + + + + + + +    using our regularized objective , we train a 2-layer dbm with 500 hidden units in each layer",
    ". we set the hyper - parameters of eq.[eq : regll ] as follows : @xmath54 , @xmath55 and @xmath56 .",
    "furthermore , we dampen the learning rate on the parameters @xmath57 and @xmath58 by a factor of a thousand , in order for the layer norms to evolve more slowly . a random subset of filters is shown in figure  [ fig : good_filters ] .    the effect of our regularization term is drastic : the vast majority of first layer filters seem to train successfully and resemble the pen - stroke detectors characteristic of features learned on mnist . while more difficult to interpret , the second layer filters are also clearly superior to the ones of figure  [ fig : bad_filters ] , combining lower - level features ( pen strokes ) into more global digit - like objects .",
    "we have introduced a simple regularization scheme that appears to prevent sml from falling into a poor local minimum of our objective function .",
    "the regularizer encourages units to learn filters which have similar norms , both within and across adjacent layers .",
    "we have empirically demonstrated the failure of joint training of all layers of a deep boltzmann machine which leaves many filters in the lower layer of a 2-layer dbm with very small norm and , consequently , little contribution to modeling the data .",
    "we have also empirically demonstrated the success of our regularization scheme in simultaneously training both layers of a 2-layer dbm .",
    "while we have not shown it here , our scheme also appears to work well for dbms with more than 2 layers . in future work",
    ", we would like to determine how many layers can be learnt simultaneously using similar basic norm - regularizaiton schemes .",
    "the authors would like to acknowledge the support of the following agencies for research funding and computing support : nserc , calcul qubec and cifar .",
    "we would also like to thank the developers of theano @xcite ."
  ],
  "abstract_text": [
    "<S> the deep boltzmann machine ( dbm ) has been an important development in the quest for powerful `` deep '' probabilistic models . to date , simultaneous or joint training of all layers of the dbm has been largely unsuccessful with existing training methods . </S>",
    "<S> we introduce a simple regularization scheme that encourages the weight vectors associated with each hidden unit to have similar norms . </S>",
    "<S> we demonstrate that this regularization can be easily combined with standard stochastic maximum likelihood to yield an effective training strategy for the simultaneous training of all layers of the deep boltzmann machine . </S>"
  ]
}