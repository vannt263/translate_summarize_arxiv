{
  "article_text": [
    "advances in technology that allow us to observe fainter objects , build more complex systems , and send telescopes further into space have challenged us to continue to improve our calibrations .",
    "this includes detection methods for cosmic rays ( crs ) or any charged particle that adds a jump to the data .",
    "_ jwst _ s orbit at the second earth - sun lagrange point ( l2 ) , which allows passive cooling of the telescope to @xmath050 k , puts it outside the protective mantel of the earth s magnetic field .",
    "this could make crsa serious problem .",
    "furthermore , newer infrared telescopes will have a lower read - noise , and thus we will detect lower crs . finally , long observing times will be necessary to complete many of the scientific goals of the _ jwst _ , causing crsto be an even larger problem . from a study by",
    "@xcite we can calculate that in every 2000 s , on average , 13% of the pixels on the _ jwst_hgcdte detectors and 25% of the pixels on the _ jwst_si : as detectors will be affected by crs .",
    "these values could be even greater , since this study does not take into account secondary particles .",
    "for comparison , onboard measurements of the _ nicmos _ camera on the _ hst _ show that about 10% of the pixels show a crhit for every 2000 s of integration  @xcite .",
    "these crswill include low - energy crsfrom secondary particles and the sun , and higher - energy galactic crs  @xcite . clearly , a reliable method to detect both low- and high - energy crsis needed .",
    "in this article we will discuss crdetection methods for infrared data , which use nondestructive read ramps .",
    "@xcite found that in order to correct for crs , the nondestructive readout scheme was most efficient . by integrating the charge on each pixel in this way it is possible to calculate the slope of these ramps in counts per time to get the flux of the sky ( rieke 2007 ) .",
    "we refer to the integrated charge as a ramp made up of a specified number of samples .",
    "we discuss the slope of these ramps as the calculation of the flux .",
    "finally , a craffects the ramp between samples , however we use ` sample number ' to refer to the first sample after the crhit .",
    "correcting for crsin ramps is not a new problem  @xcite .",
    "however , the advent of large nondestructive arrays in orbit coupled with ground - based processing of the ramps means , when it comes to calculating the slope of ramps , that there are more options available for crdetection .",
    "in addition to crs , noise is added to the data by the detector and readout electronics as well ( fanson 1998 , tian et al .",
    "1996 , rieke 2007 ) . in this article",
    "we focus on photon - noiseand read - noisefor our correlated and uncorrelated noise , respectively ; however , we are not restricted to just these two terms .",
    "the work in this article is general and can account for any correlated and uncorrelated noise sources .",
    "therefore , our question is , what is the best we can do at finding crsin a ramp , given the noise in the ramp ?    to understand and test various crdetection methods for ramps , we simulate infrared data as described in section  [ s : sim ] .",
    "anytime a slope is calculated for the preceding process or for the crdetection methods , we do so using linear regression for data with correlated and random uncertainties ( in consideration of the photon - noiseand the read - noise , respectively ) , as described in section  [ s : corr ] . in section  [",
    "s : methods ] we propose three techniques to detect crs .",
    "the first is a two - point difference method , the second is a deviation from the fit method , and the third is a y - intercept comparison .",
    "there are various conditions that can hinder / aid in crrejection ( e.g. , number of samples , slope , number of crs , size of crs , and location of crs ) ; therefore , we aim to study combinations of these and to find which algorithm behaves the best under different conditions .",
    "these results are presented in section  [ s : results ] .",
    "a discussion on our findings is in section  [ s : dis ] .",
    "concluding remarks can be found in section  [ s : cons ] .",
    "in order to test how well a crdetection method works , we have to test the method on a known cr .",
    "for that reason , we have simulated ramps with photon - noiseand read - noiseadded in , to which we can either add crswith known location in the exposure and known amplitudes or leave the ramps clean ( cr - free ) .",
    "we build these ramps with the slope , y - intercept , number of samples , time between samples ( sample time ) , and read - noiseas inputs , using parameters given in table  [ tbl : params ] as guidelines ( slope and number of samples will be changed in this study ) .",
    "the only value that is instrument - specific is the read - noise , which was chosen to match the expected value of the mid - infrared instrument ( _ miri _ ) on the _ jwst_. note that we do not group any of the samples by taking a weighted average or coadding .",
    "furthermore , we assume uniform sampling ( i.e. , constant time between samples ) , as that is what is used by the _ jwst_and also so that calculations are more efficient .",
    "we also assume that a nonlinearity correction has already been performed with no error , and we do not account for the effects of quantization noise . although we are simulating _ miri _ detector parameters , this is only an example .",
    "the methods discussed in this article will apply to any other nondestructive read data , including those for the _ jwst_near - infrared detectors ( _ near - infrared camera _ [ _ nircam _ ] and _ near - infrared spectrograph _ [ _ nirspec _ ] ) the _ hst _ infrared detectors ( _ wide field camera 3 - ir _ [ _ wfc3-ir _ ] and _ near - infrared camera and multi - object spectrometer _ [ _ nicmos _ ] ) and ground - based detectors , by simply changing the values in table  [ tbl : params ] .",
    "if the data you would like to simulate do included grouped samples , however , some revisions will have to be made .",
    ".parameters used to create miri ramps .",
    "[ tbl : params ] [ cols=\"<,<\",options=\"header \" , ]     at time @xmath1 the counts @xmath2 are equal to the y - intercept .",
    ", this is an arbitrary value and does not change our calculations . ]",
    "this is not considered part of the ramp , because @xmath1 is when the reset occurred , but we start reading at time equal to one sample time , @xmath3 .",
    "each signal is comprised of the counts from the previous signal plus the additional signal , the photon - noisefrom the additional signal , and the read - noise . to construct the ramps",
    ", we follow this procedure :    1 .   for each ramp",
    "calculate the expected signal ( i.e. , no noise , clean ) , @xmath4 , defined as @xmath5 where @xmath6 is the input slope , and @xmath7 is the sample time . 2 .   for each sample",
    "calculate the sum of the expected signal and the unique photon - noiseof this signal ( @xmath8 ) from a poisson distribution with @xmath9 .",
    "add this to the signal from the previous sample ( or y - intercept if it is the first sample ) .",
    "this step is shown in equation  [ eq : y0 ] . since we have only added the correlated noise , and we still need to add the uncorrelated noise , we have called the signal @xmath10 instead of @xmath11 ) .",
    "@xmath12 3 .   if there are to be one or more crsto the ramp , simply add the electrons with the expected signal : @xmath13 where @xmath14 is the magnitude of the cr .",
    "4 .   read noise , denoted by @xmath15 , is due to readout electronics ; consequently , it is uncorrelated",
    ". therefore , when all samples are populated , add a unique read - noise , @xmath16 , to each sample ( equation  [ eq : y1 ] ) : @xmath17 for each sample @xmath16 is taken from a gaussian with @xmath15 as the standard deviation .",
    "the uncertainties for the samples in the ramp are calculated by adding the photon - noiseand read - noisein quadrature : @xmath18 where @xmath19 is the poisson noise of the expected signal in the ramp ; thus , @xmath20 , and @xmath15 is taken from table  [ tbl : params ] .",
    "we have chosen to give each sample equal weighting , rather than choosing the photon - noiseto be the poisson noise of the counts in the ramp , so that we can improve our results by avoiding a bias based on sample number .",
    "for two of the three crdetection methods , it is very important that we use the best calculation of the slope and y - intercept .",
    "therefore we must use all information including correlated and uncorrelated errors .",
    "@xcite explains how to take into account both correlated and uncorrelated errors for the slope and y - intercept uncertainties , and here we describe how to include this information for the fit as well , using matrix notation and specifically making use of the covariance matrix . for a refresher on calculating a linear fit using matrices as well as the use of the covariance matrix , see @xcite .",
    "every time a slope is calculated in the cr detection methods described in this article , we do so using this method .",
    "the real power of using matrix notation comes from the covariance matrix , @xmath21 , as it includes information about the degree of correlation between samples .",
    "furthermore , the slope and y - intercept uncertainties resulting from using this covariance matrix automatically take into account the correlated and uncorrelated errors , provided they are included in the covariance matrix .",
    "@xmath21 is defined as : @xmath22.\\end{aligned}\\ ] ]    the values on the diagonal of @xmath21 are the uncertainties of the @xmath11 , whereas the off - diagonal elements are the covariance between the different @xmath11 .",
    "if the data are uncorrelated , then the off - diagonal matrix elements are all zero , @xmath23 .",
    "however , we do have correlated data due to the photon - noise .",
    "when constructing @xmath21 for correlated errors , we follow the logic of  @xcite and think of @xmath21 as the sum of two matrices : one for the photon - noise , @xmath24 , and one for the read - noise , @xmath25 .",
    "@xcite define these matrices for the case where the data are the two - point difference of the samples ( the photon - noiseis not correlated , and the read - noiseis correlated ) .",
    "however , for fitting a line to the individual samples , it is just the opposite .",
    "the read - noiseis uncorrelated , and thus @xmath25 is just @xmath26 on the diagonal and zero elsewhere .",
    "the diagonal of @xmath24 is @xmath27 , just as it would be for uncorrelated data , but since the photon - noiseis correlated , the off - diagonal elements are not zero .",
    "an estimate of all of the photon - noisein @xmath11 is the photon - noiseadded to each sample multiplied by @xmath28 ( i.e. , @xmath29 ) .",
    "the correlation between samples @xmath11 and @xmath30 is the photon - noisethat is in @xmath11 that is also in @xmath30 .",
    "the elements in @xmath24 that represent this correlation are @xmath31 and @xmath32 .",
    "consider @xmath33 and @xmath34 , where the photon - noisethey share would be the photon - noisein @xmath33 ( @xmath35 ) , plus the photon - noisein the first read , @xmath36 .",
    "thus , @xmath37 where @xmath38 if @xmath36 is included in the background , then it is set to zero .",
    "we can estimate @xmath19 using the slope as we did in section  [ s : sim ] : @xmath39 .",
    "this initial calculation of the slope for @xmath4 ( eq .  [ eq : se ] ) is done before any crcorrection and without taking into account correlated errors .",
    "this technique accounts for the diagonal elements as well .",
    "therefore , @xmath40 where @xmath15 is the read - noise .",
    "an equation for the noise in a ramp has previously been derived in nonmatrix form in  @xcite ; for an independent derivation and the correct final formula , see  @xcite .",
    "@xcite formula ( eq . ( 1 ) in that article , see erratum ) has the benefit that it takes into account grouped samples .",
    "however , the benefit of using matrix notation with a covariance matrix is that we can add other noise terms easily by calculating the appropriate covariance matrix ( like we did for * p * and * r * ) and sum all to get * c*. it would be more difficult to add other noise terms to the  @xcite equation , and like our method here , they only include read - noiseand photon - noise .",
    "to demonstrate how well this calculation of the uncertainties fits simulated data , we followed the idea from figure  16 in @xcite and simulated 10,000 ramps each with read - noiseonly , photon - noiseonly , and both , then we used the covariance matrix to calculate the y - intercept and slope uncertainties .",
    "this is given in figure  [ fig : fitline_ys ] .",
    "the dashed and dotted lines are the uncertainties with read - noiseand photon - noiseonly , respectively .",
    "the solid lines are the uncertainties in the ramps where both read - noiseand photon - noisewere added .",
    "notice that you can see where the transition is between the read - noise - dominated regime and the photon - noise - dominated regime using these plots .",
    "the circles are the uncertainties calculated using the method described in section  [ s : corr ] , which fit the data perfectly .",
    "in addition to using a covariance matrix , other popular methods to fitting a line to ramps have used uncertainties as the weights ( 1/@xmath41 ) , equal weights , or optimum weights , as discussed in  @xcite . to demonstrate how these methods compare",
    ", we simulated 10,000 ramps , each with the same input slope ( before the noise was added ) and then tried to retrieve these slopes using the various weighting schemes ( figure  [ fig : linfit ] ) .",
    "the standard deviation in the slope fits is plotted in figure  [ fig : linfit ]  ( a ) .",
    "we see that the covariance matrix and optimal weighting result in a higher signal - to - noise ratio ( s / n ) than the other two methods .",
    "optimal weighting estimates a covariance matrix , so it is expected that they show similar results . in figure",
    "[ fig : linfit ]  ( b ) we show the ratio of the average calculated slope to the input slope , with unity subtracted .",
    "note that the curve in this plot is nonsmooth due to the finite number of trials .",
    "the error on the slope calculation is very small , with the calculated slope at most 0.004% from the input slope . for various slopes we made a histogram of the distribution of these ratios and found that they were symmetric and centered on the average .",
    "therefore , optimal weighting and using a covariance matrix with correlated and uncorrelated errors produces a lower standard deviation of the results , while all methods produce a similar slope estimate with 10,000 trials .",
    "all three crdetection methods have a unique algorithm . however , all follow the same procedure to calculate a slope once the crsare found , which we now outline :    1 .",
    "detect crs , always looking for the largest outliers first .",
    "calculate the slope for the resulting ramp segments before and after the crevents ( we will refer to these as  semiramps  from here on , following * ? ? ?",
    "3 .   calculate the final slope of the entire ramp .",
    "if there is one cror more , do this by taking the weighted average of the slopes of the semiramps ( see also the discussion in section  [ s : dis ] ) .    furthermore , for all methods we use the absolute difference so that we remove outliers in both directions and do not bias the data @xcite . however , if larger rejection thresholds are used , and therefore there are no longer as many outliers ( i.e. , only picking up the strongest crs ) , then one - sided clipping would work just as well  @xcite",
    ".      with the nondestructive readout method , algorithms for crdetection include computing the two - point differences . @xcite and @xcite describe versions of this method , though both use only one rejection threshold for all cases ( 5@xmath42 and 4.5@xmath42 , respectively ) .",
    "another version was used in the _ multiband imaging photometer _ ( _ mips _ ) data reduction algorithm for _ spitzer _  @xcite .",
    "we describe a variant of this technique here .    for the two - point difference method ( hereafter 2pt diff )",
    ", we calculate the two - point differences between the counts in each set of adjacent samples .",
    "the largest outlier is flagged as a cr , given that it fulfills the rejection criteria : @xmath43 where @xmath44 is the difference between the science data @xmath45 and @xmath11 , @xmath46 is the median of @xmath47 , @xmath48 is the uncertainty of @xmath47 , and @xmath49 is the rejection threshold . the median is used because it is more robust than the mean when there are outliers in the data @xcite .",
    "the median can become a problem if there is quantization noise ( i.e. , if the slope of the ramp were 0.07 @xmath50/s ) , however we do not take into account quantization noise in this article .",
    "once a cris identified , the @xmath44 that includes the cris removed , and the process is repeated on the remaining @xmath44 until no more crsare found .",
    "this method is depicted in figure  [ fig:2pt ] .    when calculating the uncertainty in @xmath47 , @xmath48 , the most obvious solution would be to use the standard deviation .",
    "however we have found that this does not work well for ramps with a low number of samples ( @xmath51 ) .",
    "we can improve @xmath48 by using the photon - noiseand read - noiseadded in quadrature .",
    "the photon - noisecan be calculated as poisson noise , but since we are dealing with the two - point difference we use the charge accumulated since the last sample , rather than the total charge in a sample , so we use @xmath52 .",
    "since a crcan contaminate a slope calculation , we can use @xmath46 to estimate @xmath4 .",
    "therefore @xmath53 , and @xmath54 where the factor 2 is due to the read - noisefrom each of the two samples .",
    "the method we will refer to as the deviation from the fit method ( hereafter dev from fit ) , is the one used by _ nicmos _",
    "@xcite and _ wfc3",
    "_  @xcite . to use this method",
    "we fit a line to the ramp using a covariance matrix as described in section  [ s : corr ] .",
    "then , for each sample , we calculate the difference to the fit as a ratio to the uncertainty in the counts : @xmath55 where @xmath56 is the fit at sample @xmath11 , and @xmath57 is the uncertainty in each sample , defined in equation  [ eq : yerr ] .",
    "we then take the first difference of these ratios , and look for the largest . if it satisfies the criteria : @xmath58 then @xmath45 is flagged as a cr .",
    "the ramp is then split into semiramps , and this method is applied again to the resulting semiramps .",
    "the dev from fitmethod is illustrated in figure  [ fig : dev ] .",
    "note that the background level is not at zero as it was for the 2pt diffmethod , but @xmath59 .",
    "the reason for the nonzero background is that while the median ( which would exclude the cr ) is subtracted in the 2pt diffmethod , in the dev from fitmethod the fit is subtracted , which includes the crin its calculation .",
    "furthermore , in the presence of a cr , the slope will be overestimated and , therefore so will the photon - noise . finally , the peak is at a ratio of @xmath6060 , whereas both the 2pt diffand y - intmethods ( as we will see ) peak at ratios of @xmath6080 .",
    "the idea for the y - intercept method ( hereafter y - int ) comes from the _ mips _ data reduction algorithm  @xcite .",
    "the details we describe here are a variant of that method . for the y - intmethod , we step through each sample and assume that there is a crthere ( the first sample is skipped ) .",
    "we fit a line to the semiramps before and after the sample with the assumed cr , using a covariance matrix as described in section  [ s : corr ] . at each sample ,",
    "the x - axis is shifted so that the y - intercept is located at the sample number of the assumed cr .",
    "the only exception is when we assume that there is a crin the second sample .",
    "since we can not calculate a y - intercept for only one point , we shift the x - axis to the first sample , and use the counts in that sample as the y - intercept , and take the read - noiseas the uncertainty .",
    "we do the mirror to this when assuming that there is a crin the last sample .",
    "then , we take the ratio of the absolute differences between the two y - intercepts ( @xmath61 and @xmath62 ) to the expected uncertainty , @xmath63 ( equation  [ eq : yint ] ) .",
    "@xmath64 after stepping through every sample , we look at the sample with the largest ratio .",
    "if this ratio is larger than a given @xmath49 , then we flag that sample as a cr .",
    "the process is repeated on the resulting semiramps .",
    "the method is depicted in figure  [ fig : yint ] .",
    "the expected uncertainty , @xmath63 , is calculated from the y - intercept uncertainty from the read - noiseand the y - intercept uncertainty from the photon - noiseadded in quadrature .",
    "there are two read - noisecomponents , @xmath65 and @xmath66 , one from the ramp before the assumed cr , and one from the ramp after .",
    "these read - noiseterms are calculated by setting the covariance matrix , @xmath21 , to the read - noisematrix , @xmath25 , and recalculating the y - intercept uncertainty .",
    "the photon - noisecomponent is calculated as @xmath67 . since in the y - intmethod",
    "we are dealing with two ramps , we take the weighted average of the slopes to get @xmath4 , just as we would if there were actually a crfound at the assumed location . therefore , @xmath68    in figure  [ fig : yint ]  ( c ) the dashed line representing equation  [ eq : yint ] is hovering around zero before the crdetection , and then afterward it increases to @xmath6010 .",
    "this effect comes from the difference between the y - intercepts .",
    "it is caused by the fact that we shift the x - axis to the sample with the assumed cr , whereas if we shift it to the sample before the cr(as we do for a crin the second sample , notice that there the ratio is @xmath6010 ) , then the difference between @xmath61 and @xmath62 before the actual crwould be greater than after the actual cr .",
    "to compare the success of each method at finding crs , we look at both the fraction of crsfound and the false detection rate , which we define as the ratio of the number of false detections to the number of possible false detections .",
    "the number of possible false detections is calculated as the number of samples minus one , minus the number of true crs , times the number of trials .",
    "we look at simulated ramps with 5 , 10 , 20 , 30 , and 40 samples , with crsof 20 different magnitudes from 0 to 250 @xmath50 ( all crswith magnitudes @xmath69250 @xmath50 are found with all methods ) , and with slopes of 0.0 @xmath50/s , 0.7 @xmath50/s , 3.5 @xmath50/s , 7.0 @xmath50/s , 35.0 @xmath50/s , and 70.0 @xmath50/s , with one , two , or three crs , and with the crlocated in the beginning , middle , and end of the ramp ( e.g. for a ramp with 40 samples , we inserted a crin the @xmath70 , @xmath71 , @xmath72 , @xmath73 , and the @xmath74 sample ) .",
    "we then simulate 10,000 ramps for each combination , and apply each method to each ramp to compare the results .",
    "for all trials , the rejection threshold , @xmath49 , is chosen such that the rate of false detections is the same for all methods ( a rate of 5% was chosen ) . in this way",
    "we can best compare how well they find the crs .",
    "each of the crdetection methods has a different criterion ( see equations  [ eq:2pt ] ,  [ eq : dev ] , and  [ eq : yint ] ) , which , when compared with the rejection threshold , decides if a sample is to be flagged as containing a cror not .",
    "therefore , the relationship between rejection threshold and the false detection rate is different for each method . to better understand this dependence , for each crrejection method we used a range of rejection thresholds and looked at the resulting fraction of false detections",
    "this was done on cr - free ramps .",
    "the first comparison is for the fraction of false detections versus the rejection threshold for different input slopes ( figure  [ fig : rt_slopes ] ) . for a given fraction of false detections ,",
    "the rejection threshold is independent of slope for the 2pt diffmethod , while there is very little change for the y - intmethod .",
    "however , for the dev from fitmethod , the rejection threshold needs to vary to keep the fraction of false detections constant across ramp slopes .",
    "the rejection threshold for different number of samples in a ramp is shown in figure  [ fig : rt_nframes ] .",
    "an input slope of 70.0 @xmath50/s was used , and the rejection threshold was chosen such that the fraction of false detections was 0.05 .",
    "the slope of these lines is 0.0011 , 0.0065 , and -0.0049 for the 2pt diff , dev from fit , and y - intmethods respectively .",
    "although this is a small change for the 2pt diffmethod , if a cris found in a ramp then the rejection threshold was changed depending on the number of samples in a semi - ramp . if the rejection threshold was not calculated for a specific number of samples , we interpolated it .",
    "figure  [ fig : rt_nframes ] also shows how well the uncertainties in the 2pt diffmethod behave like a gaussian , thus allowing the rejection threshold to be chosen easily .      as we change the input slope of these ramps , we move from the read - noise - dominated regime to the photon - noise - dominated regime . in figure",
    "[ fig : slope10_0 ] we show the two extremes : read - noise - dominated regime with an input slope of 0 @xmath50/s ( figure  [ fig : slope10_0 ]  ( b ) and  ( d ) ) , and photon - noise - dominated regime with an input slope of 70 @xmath50/s ( figure  [ fig : slope10_0 ]  ( a ) and  ( c ) ) .",
    "plotted is the fraction of crsfound versus the crmagnitude and the fraction of false detections versus the crmagnitude .    in the photon - noise - dominated regime ,",
    "photon - noisecan appear as a cras it is correlated and thus can lead to false detections . from figure",
    "[ fig : slope10_0 ]  ( a ) and  ( c ) we see that all of the methods give similar results .",
    "however , note how the fraction of false detections for the 2pt diffmethod is relatively constant compared with the other two methods .",
    "this shows how well we are able to understand the uncertainties of this method .",
    "this , coupled with the fact that the 2pt diffmethod requires the least computations , leads us to suggest that the 2pt diffmethod is the optimal crdetection method in the photon - noise - dominated regime .    in the read - noise - dominated regime",
    "we only have random noise , and therefore we are able to get a more accurate calculation of the y - intercept and the y - intercept uncertainties . therefore , as is shown in figure  [ fig : slope10_0 ]  ( b ) and  ( d ) , in the read - noise - dominated regime the y - intmethod gives the best results in that it is able to find fainter crsthan the other two methods .    in figure",
    "[ fig : slope10_0 ]  ( d ) , note that the rate of false detections per crstrength is only constant for the 2pt diffmethod , while for the y - intmethod it is constant only for high - energy crs . between a @xmath14 of 0 @xmath50 and 10 @xmath50 , we see a high fraction of false detections for the y - intmethod .",
    "this corresponds to the range where the crsare not always found .",
    "the cause of this bump is not clear , and is evidence that we do not fully understand the noise model associated with the y - int method .",
    "this could be caused by the fact that we treat each semiramp independently , which is inaccurate , since the uncertainties are correlated .",
    "therefore , one solution could be to fit all semiramps simultaneously . this would increase the uncertainty , which would mean that the rejection threshold has been set too low ( which would agree with what we see in the plots ) .",
    "we leave that for future work .",
    "regarding figure  [ fig : slope10_0 ] ( a ) and ( b ) , if you draw a vertical line at a given @xmath14 ( we chose the @xmath14 where the fraction of crsfound by the 2pt diffmethod is closest to 50% ) , you can see the difference between the fraction of crsfound by each method at that slope .",
    "we did this for slopes of 0.0@xmath50/s , 0.7@xmath50/s , 3.5@xmath50/s , 7.0@xmath50/s , 35.0@xmath50/s , and 70.0@xmath50/s .",
    "the results are shown in figure  [ fig : yint_vs_2ptdiff ] .",
    "each ramp had 40 samples , and again the rejection threshold was chosen such that the fraction of false detections was 5% . for comparison , we subtracted the fraction of crsfound by the 2pt diffmethod . in this figure",
    "we can see that we move into the regime where the y - intmethod performs better than the 2pt diffand dev from fitmethods at a slope of @xmath75/s .    to further illustrate how the results of each method change with input slope , we show the fraction of crsfound as a function of crmagnitude for different slopes and for each of our methods in figure  [ fig : slopes ] .",
    "the results of the 2pt diffand dev from fitmethods appear to be similar , while the y - intmethod does better with lower slopes ( read - noise - dominated regime ) .      in order to determine how the number of samples in a ramp affects how well we detect crs , we tested each algorithm on simulated ramps with 5 , 10 , 20 , 30 , and 40 samples .",
    "figure  [ fig : nframes ] shows the fraction of crsfound as a function of crmagnitude for different numbers of samples for the 2pt diff , dev from fit , and y - intmethods .",
    "when we use the 2pt diffmethod on weak crs(@xmath76 50 e@xmath77 ) and strong crs(@xmath69 150 e@xmath77 ) , the fraction of crsfound increases with the number of samples ( except for the case where there are five samples ) . for the dev from fitmethod , the fraction of crsfound increases with number of samples for string crs , but shows no difference for weak crs .",
    "finally , for the y - intmethod , the fraction of crsfound decreases with number of samples for weak crs , but increases with number of samples for strong crs .",
    "there are two questions when it comes to crsample number : the first is where do we find false detections in the ramp , and the second is how well we find crsin given positions in the ramp .    to answer the first question",
    ", we created a histogram of the sample numbers of the false detections found on simulated cr - free ramps for each method .",
    "these are presented in figure  [ fig : rn4false ] .",
    "the results show that both the 2pt diffand dev from fitmethods are not biased toward any position in the ramp . however , the y - intmethod is biased toward the last samples in a ramp where there is less effect from the correlation between samples .    to answer the second question",
    ", we simulated ramps with 40 samples and input slope of 70 @xmath50/s , with one creach at sample ( numbers 3 , 10 , 20 , 30 , or 35 ) .",
    "we then applied each of the algorithms to these ramps and compared the results , shown in figure  [ fig : readn ] .",
    "the results of these plots all show that the 2pt diffis the only method that does not vary depending on the sample number of the cr , as can be expected .",
    "both the dev from fitand y - intmethods are weakly biased by sample number .",
    "this is also expected , since both require fitting lines to data , and the fewer points in a line the less accurate the fit .",
    "again , in the photon - noise - dominated regime , the 2pt diffmethod is best .      in a 1000 s integration , if we assume that 20% of the field will be affected by crs , then about 4% of the field could be affected by two crs , and 0.8% could be affected by three .",
    "this is substantial enough that we need to account for this possibility .    to test",
    "how well each method does at handling multiple crs , we simulated 10,000 40-sample ramps for each of 0 - 19 crs .",
    "each crwas of the same strength and in random but different samples .",
    "we show the results for 0 - 3 crsin figure  [ fig : mcrs ] .",
    "as can be seen , the 2pt diffmethod shows no difference between one , two , or three crs .",
    "we show only up to three crsfor simplicity , but we have found that the 2pt diffmethod does not start to show a difference in results until about nine crsand therefore should be the optimal method in the photon - noise - dominated regime .",
    "both the dev from fitand y - intmethods , although show more variance than the 2pt diffmethod .",
    "this is caused by the fact that both methods require linear fits that will include two crsfor the y - intmethod ( when assuming the correct location of one of the crs ) , and all three crsfor the dev from fitmethod .",
    "furthermore , for both methods the ramp will be segmented after the detection of the first cr .",
    "the three crdetection methods presented in this article were tested on simulated ramps , adjusted , corrected , and refined , in order to present optimum versions .",
    "we now compare our methods to determine which is best suited for various data .",
    "our results show that the 2pt diffmethod performs best in the photon - noise - dominated regime . on top of being straightforward and computationally simple",
    ", we showed that the fraction of false detections versus rejection threshold is consistent regardless of slope and number of samples .",
    "we also showed that the uncertainties of the 2pt diffmethod follow a gaussian distribution .",
    "any deviation from a gaussian was initially thought to be caused by the use of the median instead of average in the rejection criterion .",
    "however we found that while using the average did produce a more gaussian shape , it was still not a perfect gaussian .",
    "it was demonstrated that , as expected , the fraction of crsfound changed with slope and number of samples ( though barely ) .",
    "furthermore , we showed that the false detections are evenly distributed in all samples , and that the crsample number did not change the results .",
    "finally , we found that there is no noticeable difference in the performance of the 2pt diffmethod with multiple crs , up to  9 crson a ramp with 40 samples .",
    "overall , the 2pt diffmethod is fast , consistent , and easy to understand and calibrate ( e.g. , choose a rejection threshold ) , and it gives the best results in the photon - noise - dominated regime .      for the y - intmethod , there are two regimes :    1 .",
    "photon - noise - dominated : in this regime the y - intmethod gives the same answer as the 2pt diffmethod .",
    "this is due to the correlated behavior of the noise in the ramps ( e.g. , a @xmath78 event due to the noise of the photons that have arrived in the last sample time will propagate through all subsequent samples , having the same effect as a cr ) . calculating the linear fit of subsequent samples",
    "will not negate the fact that the noise in the photon - dominated regime is set by the noise in a single sample .",
    "2 .   read noise - dominated : in this regime the y - intmethod is better than the 2pt diffmethod .",
    "these two methods will still give the same results on any noise above the 2pt diffthreshold , but anything below that will only be detectable by the y - intmethod . with the noise independent from sample to sample ,",
    "a linear fit reduces the uncertainty in the y - intercepts and weaker crsare detectable .    while it is unlikely that the uncertainty will be read - noise - dominated for most _ miri _ data ( given the telescope and sky background ) , it will be the case for the _ jwst___nirspec _ _ , _ nircam _ , and the _ tunable filter imager _ ( _ tfi _ ) . _",
    "nirspec _ has a higher resolution than the _ tfi _ and therefore a lower background .",
    "regardless , the _ tfi _ will likely be read - noiselimited , given that it uses a tunable filter ( narrowbands are less sky / telescope - dominated ) .",
    "the y - intmethod , however , does not quite match the robustness of the 2pt diffmethod . in theory",
    ", these two methods should be the same in the photon - noise - dominated regime .",
    "however , the 2pt diffmethod gave more consistent results for different slopes , number of samples , and crlocation in the ramps and for multiple crs .",
    "the difference is that the 2pt diffmethod has a simpler noise behavior , while we have not fully solved for the noise behavior for the y - intmethod . despite being careful when dealing with correlated and uncorrelated errors when fitting a line to a ramp or semiramp",
    ", we did not take this into consideration when taking the average of the slopes of the semiramps .",
    "instead we use a weighted average , where the weights are simply the uncertainties in the slope . a solution to this problem",
    "would be to fit each semiramp and the crsimultaneously , as done by @xcite for uncorrelated errors only , modifying the method to account for correlated errors .",
    "regardless , when working in the read - noise - dominated regime , the y - intmethod should be used .",
    "the dev from fitmethod did not perform as well as the other two methods .",
    "the y - intmethod dominated in the read - noiseregime , and in the photon - noise - dominated regime the dev from fitmethod , like the y - intmethod , was not as consistent as the 2pt diffmethod when it came to different slopes , number of samples , crlocation in the ramps , and multiple crs .",
    "therefore , to have a consistent fraction of false detections , we would have to set a new rejection threshold based on these variables .",
    "furthermore , while not as complex at the y - intmethod , the dev from fitmethod is still more complex than the 2pt diffmethod and thus computationally more expensive . finally , the uncertainties are nowhere near gaussian , thus making it difficult to set the rejection threshold .",
    "the dev from fitmethod was only slightly worse at detecting crsthan the 2pt diffmethod , but given the fact that it is not as robust , and requires more cpu time , the dev from fitmethod is not recommended .",
    "the dev from fitmethod could be improved by changing the weighting scheme so that instead of using the slope in the calculation of the photon - noise(since the slope will still include the crin its calculation ) , we could use the median of the two - point differences as we do for the 2pt diffmethod .",
    "however , it still would not compare with the 2pt diffmethod , as we can not do better than two@xmath15 terms and one @xmath19 term by the nature of our problem .",
    "furthermore , even if we were able to get the same results for these two methods , the dev from fitmethod still requires larger computational resources than the 2pt diffmethod .",
    "in this article we discussed three crdetection methods for nondestructive read ramps , as well as their strengths and weaknesses .",
    "we applied these methods to simulated ramps with single - sample groups .",
    "we showed that the covariance matrix must include correlated errors in order to improve the calculation of the slope and y - intercept of a ramp and their uncertainties .",
    "the y - intmethod benefits most from this use of the covariance matrix , and would not be an improvement of the 2pt diffmethod otherwise .",
    "the 2pt diffmethod was shown to be able to give the best results in the photon - noise - dominated regime .",
    "the method s uncertainties are quasi - gaussian which simplifies the process of choosing a rejection threshold .",
    "moreover , it is fast and consistent .",
    "its robustness , compared with the other two methods , resides in the fact that we simply remove the two - point difference that includes the cr , instead of splitting the ramp into two semiramps , when searching for other crsand calculating the slope and the y - intercept .",
    "the dev from fitmethod results in a similar fraction of crsfound as the 2pt diffmethod for some ramps , but unlike the 2pt diffmethod these results change based on slope , number of samples , and crlocation in the ramp and for multiple crs .",
    "if we also consider the fact that it is computationally more expensive , we do not recommend this method for use in any regime .",
    "the y - intmethod achieves the best results in the read - noise - dominated regime , and returns the same results as the 2pt diffmethod in photon - noise - dominated regime . in the photon - noise - dominated regime",
    ", the y - intmethod behaves like the 2pt diffmethod in that it is effectively calculating an average slope , excluding disturbances from any crs(in the diff method this is done by taking the median of the two - point differences ) .",
    "the average slope is then divided by the noise due to one sample time : one photon - noiseand two read - noise .",
    "the y - intmethod is better in the read - noise - dominated regime as the uncertainties on the line fit parameters diminish in size as more points are fit .",
    "this is not the case in the photon - noise - dominated regime due to the correlated nature of the noise .",
    "the y - intmethod only has two drawbacks : the noise model is not fully understood , and it is a complex algorithm .    in summary ,",
    "if we take all results into consideration we are led to suggest that if only one method can be used on data cubes , the y - intmethod should be it .",
    "if computational speed is an issue then the 2pt diffmethod should be used , especially where photon - noisedominates , and the y - intmethod should only be used when the estimated slope is in the read - noise - dominated regime or where there is information , such as a nearby crand cross - talk is suspected , to look for fainter effects .",
    "this work was supported by the space telescope science institute , which is operated by aura , inc .",
    ", under nasa contract no . nas5 - 26555 .",
    ", j.  d. , sengupta , r. , fixsen , d.  j. , stockman , p. , nieto - santisteban , m. , stallcup , s. , hanisch , r. , & mather , j.  c. 1999 , in astronomical society of the pacific conference series , vol .",
    "172 , astronomical data analysis software and systems viii , ed .",
    "d.  m.  mehringer , r.  l.  plante , & d.  a.  roberts , 141+"
  ],
  "abstract_text": [
    "<S> cosmic rays are a known problem in astronomy , causing both loss of data and data inaccuracy . </S>",
    "<S> the problem becomes even more extreme when considering data from a high - radiation environment , such as in orbit around earth or outside the earth s magnetic field altogether , unprotected , as will be the case for the _ james webb space telescope _  ( _ jwst _ ) . for _ jwst _ , all the instruments employ nondestructive readout schemes . </S>",
    "<S> the most common of these will be `` up the ramp '' sampling , where the detector is read out regularly during the ramp . </S>",
    "<S> we study three methods to correct for cosmic rays in these ramps : a two - point difference method , a deviation from the fit method , and a y - intercept method . </S>",
    "<S> we apply these methods to simulated nondestructive read ramps with single - sample groups , and varying combinations of flux , number of samples , number of cosmic rays , cosmic - ray location in the exposure , and cosmic - ray strength . </S>",
    "<S> we show that the y - intercept method is the optimal detection method in the read - noise - dominated regime , while both the y - intercept method and the two - point difference method are best in the photon - noise - dominated regime , with the latter requiring fewer computations . </S>"
  ]
}