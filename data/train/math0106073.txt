{
  "article_text": [
    "we start by describing the _ 321,hexagon  avoiding _ permutations in two ways ; first in the context of pattern  avoidance , which is the viewpoint we will be exploiting in our enumeration , and then in the context of reduced expressions , which explains the introduction of the term 321,hexagon  avoiding ( for brevity , _ 321hex _ ) .",
    "finally , we explain briefly the connection with kazhdan  lusztig polynomials in @xcite and how this motivates the work on the present paper .      from the first viewpoint",
    ", we consider permutations in @xmath0 as bijections @xmath1 \\rightarrow [ n]$ ] , and write them in one  line notation as the image of @xmath2 , @xmath3 $ ] .",
    "for @xmath4 we suppress the commas without causing confusion .",
    "let @xmath5 and @xmath6 for some @xmath7 .",
    "we say that @xmath2 _ contains _",
    "@xmath8 if there is a sequence @xmath9 such that the sequences @xmath10 $ ] and @xmath11 $ ] obey the same pairwise relations , i.e. @xmath12 exactly when @xmath13 . in such a case , we write @xmath14 .",
    "if @xmath2 does not contain @xmath8 then we say that @xmath2 _ avoids _ @xmath8 .",
    "we denote by @xmath15 the set of all @xmath8avoiding permutations of length @xmath16 .",
    "for example , the permutation @xmath17 avoids @xmath18 but does not avoid @xmath19 because of its subsequence @xmath20 . for a classification of forbidden subsequences up to length 7 , we direct the reader to @xcite .",
    "the _ 321hex _ permutations are those permutations which simultaneously avoid each of the following five patterns : @xmath21,\\,p_1=[46718235],\\,p_2=[46781235],\\,p_3=[56718234],\\,p_4=[56781234].\\ ] ]    we denote by @xmath22 the set of the four length8 ( _ octagonal _ ) permutations @xmath23 . in order to make sense of the above definition , consider the following equivalent , but perhaps more insightful , reformulation in terms of matrices .",
    "let @xmath6 .",
    "the _ permutation matrix _",
    "@xmath24 is the @xmath25 matrix having a @xmath26 in position @xmath27 for @xmath28 , and @xmath29 elsewhere .",
    "( to keep the resemblance with the `` shape '' of @xmath2 , we coordinatize @xmath24 from the bottom left corner . ) given two permutation matrices @xmath30 and @xmath31 , we say that @xmath30 _ avoids _",
    "@xmath31 if no submatrix of @xmath30 is identical to @xmath31 .    @xmath32    a permutation matrix @xmath30 of size @xmath16 is simply a transversal of an @xmath25 matrix",
    ". clearly , @xmath6 contains @xmath5 if and only if @xmath24 contains @xmath33 as a submatrix . under this reformulation ,",
    "[ octagonal ] presents the four octagonal patterns @xmath34 which must be avoided by the 321hex permutations .",
    "the fifth pattern @xmath35 does _ not _ come from a permutation because it is not a transversal .",
    "yet , @xmath35 is a union of the four previous permutation patterns , and it can be easily checked that a permutation matrix @xmath24 avoids all @xmath36 s if and only if no @xmath37 permutation submatrix of @xmath24 can be completely `` covered '' by @xmath35 .",
    "thus , by abuse of notation , we can say that the 321hex permutations are defined as the permutations avoiding both @xmath38 $ ] and @xmath35 .",
    "our enumeration makes use of this last interpretation , exploiting the symmetries in the set @xmath22 of octagonal patterns plus a convenient structural representation of all 321avoiding permutations .",
    "the close relations between the four octagonal permutations are even more clearly revealed from a group  theoretical viewpoint when examining their reduced expressions .",
    "below , we briefly review the construction of the _ heaps _ of 321avoiding permutations and their relation to the octagonal patterns @xmath36 ; for more details , see @xcite .",
    "the remainder of the introduction , except for its conclusion , can be skipped by the reader who is interested only in the pattern  avoidance interpretation .",
    "the permutation group @xmath0 can be regarded as generated by the set of the _ adjacent transpositions _",
    "@xmath39 , where @xmath40 in _ cyclic _ notation . in this presentation , the generators @xmath41 and @xmath42 commute if @xmath43 ; else @xmath44 .",
    "an _ expression _ is any product of generators .",
    "a _ reduced _ expression @xmath45 for @xmath46 is a shortest ",
    "possible expression yielding @xmath2 .",
    "( it is well  known that the number of generators in @xmath45 equals the number of inversions in @xmath2 . ) for example , the octagonal pattern @xmath47 $ ] has a reduced expression    @xmath48    reduced expressions for the other avoided octagonal patterns are @xmath49 , @xmath50 and @xmath51 .",
    "these expressions can be easily verified by considering the dashed lines in @xmath35 in fig .",
    "[ octagonal ] .",
    "the study of reduced expressions is a major subject of the representation theory of @xmath0 .",
    "after work of viennot @xcite , the @xmath52avoiding permutations @xmath2 can be represented by special ranked posets called _",
    "the elements of @xmath53 are identified with the transpositions @xmath54 in a fixed reduced expression @xmath55 for @xmath2 . by billey  jockusch ",
    "stanley  @xcite , the @xmath52avoiding permutations are those in which no reduced expression contains a substring of the form @xmath56 ; and by tits @xcite , all reduced expressions for a @xmath52avoiding permutation @xmath2 are equivalent up to moves @xmath57 for @xmath43 .",
    "thus , the set of elements in @xmath53 is independent of the choice of @xmath55 .",
    "@xmath58    we now describe the _ rank function _ of @xmath59 , along with a hasse diagram for the poset by embedding its elements in the integer lattice .",
    "one way to define and visualize this embedding is via _ string diagrams_. to form a string diagram of @xmath46 , write the row of numbers @xmath60 $ ] above the row @xmath61 $ ] , thus mimicking the two  line notation for a permutation .",
    "connect each number @xmath62 on the bottom line to the corresponding number @xmath62 on the top line , drawing a `` string '' which may change direction , but which at all times is running either due north , northwest or northeast .",
    "strings may cross and recross , but do not run over top of one another , nor do they stray beyond the rectangular bounds formed by the two rows of numbers . for example",
    ", @xmath63 can be realized as the crossing of two strings , as shown in fig .",
    "[ stringdiagram]a . in general ,",
    "two or more adjacent transpositions can be applied simultaneously , provided they commute , i.e. @xmath41 and @xmath42 can occur on the same horizontal level of a string diagram unless @xmath64 .",
    "thus , the crossings of a string diagram can be identified with the @xmath41 s , labelled by the column ( from @xmath26 to @xmath65 ) in which they occur , and can be seen to form a poset in the obvious way .",
    "the linear extensions of this partial order are the expressions for @xmath2 defined above .",
    "if the string diagram has the smallest possible number of crossings , then it is is _ minimal _ and the linear extension is a reduced expression for @xmath2 .",
    "a _ short braid _ is a configuration obtained by applying the non  commuting transpositions @xmath41 and @xmath66 in the following order : @xmath67 or @xmath68 ( cf .",
    "[ stringdiagram]b[stringdiagram]c ) .",
    "the string diagram for a braid shows crossings at three of the four points of a small diamond , omitting either the eastern or the western point .",
    "as mentioned earlier , a permutation is 321avoiding exactly when its minimal string diagrams avoid such configurations ; such permutations are therefore also called _ short  braid  avoiding _ in the literature of coxeter groups .",
    "it is now clear how to embed canonically the poset of string crossings in a minimal string diagram of @xmath2 into the integer lattice .",
    "the resulting hasse diagram is the heap of @xmath2 , @xmath53 .",
    "it is independent of the choice of @xmath69 as long as @xmath2 is 321avoiding .",
    "the heap of the special reduced expression @xmath70 for the octagonal pattern @xmath71 resembles a hexagon : @xmath72 has horizontal and vertical symmetries , with respectively 2,3,4,3,2 lattice points on its five ranks ( see fig .  [",
    "heap]a[heap]b ) .",
    "the string diagram of @xmath73 features one extra point on top and one extra point on bottom , corresponding to the crossings of the strings @xmath26 and @xmath74 , and @xmath75 and @xmath76 ( see fig .  [",
    "the string diagrams for @xmath77 and @xmath78 have either the top or the bottom extra crossing . in all cases",
    ", @xmath79 contains the hexagonal @xmath80 .",
    "@xmath81    furthermore , it can be shown that the @xmath82avoiding permutations are exactly those 321avoiding permutations whose minimal string diagrams avoid the hexagonal string diagram of @xmath71 .",
    "this justifies the descriptive term _ 321,hexagon  avoiding _ and yields the following alternative description ( cf .",
    "@xcite ) :    * definition @xmath83 .",
    "* a _ 321hex permutation _ is a permutation whose reduced expressions do not contain a substring of the form @xmath84 for all @xmath85 , and do not contain any of the translates @xmath86 of @xmath80 for all @xmath87 .",
    "we now turn our attention to the kazhdan  lusztig polynomials . for definitions and a detailed introduction ,",
    "we direct the reader to @xcite,@xcite . in short , the _ hecke algebra _",
    "@xmath88 of a finite weyl group @xmath89 ( such as @xmath0 ) is an algebra over @xmath90 , with basis @xmath91 , relations for all generators @xmath92 : @xmath93 and well  defined inverses due to the presence of @xmath94 .",
    "moreover , the involution of @xmath90 sending @xmath95 extends to an involution @xmath96 of @xmath88 .",
    "the _ kazhdan ",
    "lusztig polynomials _ arise in search of a new basis @xmath97 for @xmath88 of @xmath96invariant elements which are linear combinations of `` lower ",
    "terms '' @xmath98 for @xmath99 under the bruhat ",
    "chevalley order : @xmath99 if every reduced expression for @xmath2 contains a subexpression for @xmath100 .",
    "for any @xmath101 , @xmath88 has a unique @xmath96invariant element @xmath102 , where the degrees of the polynomials @xmath103 $ ] are at most @xmath104 if @xmath105 , and @xmath106 , @xmath107 if @xmath108 .",
    "the kazhdan  lusztig polynomials @xmath109 are of fundamental importance in lie theory .",
    "it has been proven that their coefficients are non  negative for weyl groups ( see kazhdan ",
    "lusztig @xcite , brylinski ",
    "kashiwara @xcite ) , but this question remains open for arbitrary coxeter groups .",
    "neither the degrees nor the coefficients of @xmath109 are readily computable ; indeed , only partial results have been derived in certain cases ( see @xcite for detailed references . )      in @xcite , billey and warrington introduce the 321hex permutations @xmath110 , derive simple combinatorial formulas for their kazhdan  lusztig and poincar polynomials , and a simple method for determining the singular loci of their schubert varieties @xmath111 .",
    "concretely , let @xmath112 be a reduced expression for @xmath2 , and let @xmath113 denote the _ defect statistic _ of a _ mask _ @xmath114 on @xmath45 whose product is a fixed @xmath115 .",
    "( for definitions of these and other related concepts , see @xcite . )    a permutation @xmath46 is 321hexagon avoiding if and only if one of the following equivalent conditions is satisfied :    * the kazhdan  lusztig polynomial @xmath116 for @xmath99 .",
    "* the poincar polynomial for the full intersection cohomology group of @xmath111 equals @xmath117 .",
    "* the kazhdan  lusztig basis element @xmath118 * the bott ",
    "samelson resolution @xmath119 of @xmath111 is small .",
    "* @xmath120 .",
    "[ bw - theorem ]      as theorem  [ bw - theorem ] shows , the 321hex permutations have properties that make certain algebraic and combinatorial computations easier to perform compared to arbitrary permutations .",
    "another interesting aspect of the 321hex permutations was examined earlier in the introduction : they are one of the few families that are known to be describable both in terms of pattern  avoidance and heap  avoidance . yet , until now , there was no known recursive , exact or other closed form for the number of 321hex permutations .",
    "for instance , it would be useful to know to how many permutations theorem  [ bw - theorem ] applies ; how the number of 321hex permutations changes asymptotically , and how it compares to sizes of other well  known sets of permutations , such as @xmath121 , which is enumerated by the catalan numbers .",
    "answers to all these questions are obtained in the present paper , where we find a 7term linear recursive relation and derive from it an explicit exact formula . with this formula at hand ,",
    "answering any enumeration questions about the 321hex permutations becomes a matter of simple observation and calculation .",
    "let @xmath122 denote the set of all 321hex permutations in @xmath0 , and let @xmath123 be the number of such permutations .",
    "the sequence @xmath124 satisfies the following recursive relation for all @xmath125 :    @xmath126    [ main - result ]    of the six roots of the corresponding characteristic polynomial , four are real : @xmath127 for @xmath128 , and two are complex conjugates : @xmath129 .",
    "this implies the same description of the six coefficients below : @xmath130 for @xmath128 , and @xmath131 .",
    "the number of the 321hexagon avoiding permutations of length @xmath16 equals @xmath132 where the roots and coefficients are rounded off below to 5 digits after the decimal point : @xmath133    for further discussion of this and other results , we refer the reader to sections  [ results][extensions ] .",
    "the proof of theorem  [ main - result ] follows several steps .",
    "first , we describe the nodes in the generating tree of @xmath122 by using schensted s algorithm for 321avoiding permutations and by introducing 5 parameters for the generating function @xmath134 .",
    "we next observe that this function depends on fewer parameters , yielding therefore relatively few distinct values .",
    "we organize these values in five sequences , @xmath135 and @xmath136 . using the intrinsic symmetries of the set @xmath22 of octagonal patterns",
    ", we deduce recursive relations expressing each sequence in terms of @xmath124 .",
    "the latter turns out to be the number we are looking for , @xmath137 .",
    "finally , putting together all information about the generating function and the five sequences results in the desired formula .",
    "we turn now to the development of a recurrence for the 321hex permutations .",
    "a standard tool in the enumeration of restricted permutations is the _ generating tree _",
    "@xmath138 introduced in @xcite .",
    "begin with an infinite tree whose nodes on level @xmath16 are identified with the permutations in @xmath0 .",
    "the node @xmath2 is a child of @xmath139 $ ] where the omitted value is @xmath140 .",
    "looking at this from the point of view of the parent , we can form all the children of @xmath141 by _ inserting _ the element @xmath142 into each of the @xmath142 _ sites _ of @xmath2 .    then , for a given set @xmath143 of forbidden subsequences , prune the tree by deleting all nodes containing any of the forbidden subsequences .",
    "what remains is still connected because if @xmath2 does not contain any forbidden subsequence then clearly @xmath144 does not either . for any node on level @xmath16 of this pruned tree @xmath145",
    ", we call a site in the corresponding permutation _ active _ if inserting @xmath142 at that site yields a node of the tree ; conversely an _ inactive _ site is one where the insertion of @xmath142 creates one or more of the forbidden subsequences in @xmath143 .    to give a complete description of a generating tree , we need to associate to each node an appropriate label , and then describe a _",
    "succession rule _ for deriving the labels attached to the set of children of each node .",
    "for instance , we might characterize the original tree @xmath138 generating _ all _ permutations as having a root labelled @xmath146 and a succession rule @xmath147 . in this instance",
    ", the label can be interpreted as revealing directly how many children each node has in the generating tree .    in the particular instance of the 321hex permutations",
    ", it will turn out that we need a label containing four integers .",
    "although this is more complicated than the single integer of our motivating example , it is nevertheless a major progress to reduce the amount of information recorded at a node from a full permutation to a label of any bounded size . in particular , it is possible to apply the succession ",
    "rule recursively to determine the entire downward structure of any node given only its label , regardless of whether that node is on a level corresponding to permutations on four symbols , or four thousand .",
    "let @xmath2 be any 321hexagon  avoiding permutation on @xmath16 symbols .",
    "we divide the elements @xmath148 into two categories : the set of right  to  left minima ( including @xmath149 ) , and the rest . adapting the terminology of schensted @xcite , we refer to these as the _ first basic subsequence _ and _ second basic subsequence _ of @xmath2 , and denote them by @xmath150 and @xmath151 , respectively . for example , when @xmath152 , @xmath153 $ ] and @xmath154 $ ] .",
    "note that both @xmath150 and @xmath151 decrease from right to left , the former  by construction , and the latter  because @xmath155 .",
    "now let @xmath156 , @xmath157 and @xmath158 be the three largest ( i.e. rightmost ) elements in @xmath151 ( @xmath159 ) , with each one set to zero if the corresponding element does not exist .",
    "since @xmath30 is the largest ( i.e. rightmost ) element in @xmath151 , it follows that every element to the right of @xmath30 belongs to @xmath150 .",
    "there are @xmath160 elements in this region , which we will call the _",
    "active region_. if @xmath161 because @xmath151 is empty , then we consider the entire permutation to be the active region .",
    "let @xmath162 be the number of elements in the active region which are larger than @xmath163 ; as the elements in the active region decrease from right to left , these @xmath162 elements are @xmath164 .",
    "similarly , @xmath165 be the number of elements in the active region which are larger than @xmath166 , and @xmath167 be the number of such elements larger than @xmath30 ( cf .",
    "[ deletion1 ] . )",
    "now assign the label @xmath168 to @xmath2 . by construction , @xmath169 .",
    "@xmath170elements _ of @xmath2 be those that are counted in @xmath100 , and similarly define the @xmath163 , @xmath166 , and @xmath30elements .",
    "further , let the _",
    "@xmath171elements _ of @xmath2 be the set of @xmath170elements minus the set of @xmath163elements , and similarly define the @xmath172 and @xmath173elements .",
    "for example , the @xmath170elements in @xmath71 are @xmath174 , and @xmath175 .",
    "all children of @xmath2 must avoid the subsequence @xmath38 $ ] .",
    "this restriction by itself renders inactive all sites to the left of @xmath30 , but none of the sites in the active region .",
    "therefore when considering the children of @xmath2 and their labels , we need only consider insertions taking place in the active region to the right of @xmath30 .",
    "thus , if we insert @xmath142 into a site in the active region with @xmath176 elements to its right , it is easy to verify that the resulting permutation will have label : @xmath177 furthermore , the number of @xmath2 s children can be computed as follows . set @xmath178 then the node @xmath2 has @xmath179 children , corresponding to the @xmath179 rightmost insertion sites , where @xmath180 this allows a more compact and complete succession rule for the labels of all @xmath179 children of @xmath2 : @xmath181 we shall not use directly any of the above formulas ( [ labels1])([labels2 ] ) in our calculations , so we leave their verification to the reader , who will find this easier after mastering the material in the rest of the paper .",
    "the importance of the above discussion is that it completely describes the structure of the generating tree @xmath182 , and hence explains in principle why the enumeration in this paper works .",
    "why the resulting final formula for the 321hex permutations is so simple  a _ linear _ recursive relation with _ constant _ coefficients  is a completely different matter and can be explained only by the structure of the forbidden set @xmath22 of four octagonal patterns , as we shall see later .",
    "let @xmath134 and @xmath183 be the number , resp .",
    "the set , of 321hex permutations in @xmath0 labelled @xmath168 .",
    "according to this definition , @xmath184 is not defined since no permutation is labelled @xmath185 . for convenience ,",
    "denote by @xmath184 and @xmath186 the number and the set of all 321hex permutations in @xmath0 which end in their largest element : @xmath187 .",
    "it is worth noting that @xmath188 for @xmath189 corresponds to permutations @xmath2 in which either @xmath166 is smaller than the final `` tail '' of @xmath2 , or @xmath166 does not exist and @xmath190 .",
    "naively , there are @xmath191 enumerations to be performed for @xmath134 . however , many have the same answers ; indeed , only @xmath192 different values of @xmath193 appear :    @xmath194    the operation of deleting all @xmath163elements in a 321hex permutation provides a bijection @xmath195 . hence , for all @xmath196 we have @xmath197 . [ deletion1 ]",
    "proof : let @xmath155 . the @xmath163elements of @xmath2 lie in @xmath150 and are part of the final increasing `` tail '' of @xmath2 ( since they are to the right of @xmath30 ) .",
    "thus , if a @xmath163element @xmath198 were part of an octagonal pattern @xmath199 in @xmath2 , then @xmath198 would lie in @xmath200 .",
    "but then @xmath199 , and hence @xmath2 , would contain at least 3 elements _ larger than _ and _ to the left of _ @xmath198 : this contradicts the definition of a @xmath163element , for which only @xmath166 and @xmath30 are _ larger than _ and _ to the left of _ it .",
    "@xmath201    the above discussion shows that @xmath163elements can not participate in octagonal patterns in @xmath2 , and hence they can be deleted without losing any relevant 321hex information about @xmath2 .",
    "( of course , we have to rescale down appropriately @xmath30 and @xmath166 of @xmath2 to arrive at a permutation of smaller size . )",
    "the resulting map @xmath202 is bijective : to obtain @xmath203 from its image @xmath204 , insert the necessary number of @xmath205elements into @xmath206 and increase appropriately @xmath166 and @xmath30 to fit their definitions in @xmath2 .",
    "this procedure works because we can identify @xmath30 as the largest element in @xmath206 ( after the deletion of all @xmath163elements in @xmath2 ) , and then identify @xmath166 as the second largest element of @xmath206 , which will be necessarily to the left of @xmath30",
    ". then insertion of the appropriate @xmath205elements at the end of @xmath2 requires rescaling @xmath30 and @xmath166 only ( not @xmath163 ) , and hence transforms the 321schensted decomposition of @xmath206 into that of @xmath2 : whether @xmath166 was in @xmath207 or in @xmath208 does not prevent @xmath166 from becoming an element of @xmath150 after applying @xmath209 .",
    "consider a family @xmath210 of permutations in @xmath122 which are described by certain configuration conditions imposed on their basic subsequence decomposition @xmath211 .",
    "for example , @xmath186 is such a family defined by the condition @xmath212 .",
    "let @xmath213 be an element of the permutations in @xmath214 which is identified uniquely in each @xmath215 by the configuration description of @xmath214 .",
    "we say that @xmath213 is _ pattern  free _ if its deletion in each @xmath215 ( and appropriate rescaling of @xmath2 ) results in a numerically equivalent family @xmath216 of permutations in @xmath122 ; i.e. @xmath217 with @xmath218 . for @xmath219 ,",
    "denote by @xmath206 the image @xmath220 .",
    "for example , in @xmath186 , the largest element @xmath221 is identified by being in the last position in each @xmath2 , and clearly it is pattern  free ( no octagonal pattern @xmath36 has @xmath74 in its last position ) : @xmath222 establishing pattern  free elements and identifying the image set @xmath216 is the basis of the enumeration of @xmath122 .",
    "the following technical lemma summarizes the pattern  free situations which will be used later in the proof of theorem  [ main - result ] .",
    "let @xmath210 be a family in @xmath122 , @xmath223 be the @xmath171elements of @xmath215 , and @xmath224 be the fourth largest element in @xmath151 .",
    "the set @xmath225 imposes the following octagonal conditions on @xmath210 :    * all @xmath163elements are pattern  free . * if @xmath187 in @xmath210 , or @xmath226 in @xmath210 , then @xmath149 is pattern  free . * if @xmath227 and @xmath228 in @xmath210 , then @xmath30 is pattern  free .    assume now that @xmath229 and @xmath175 in @xmath210 .",
    "* if @xmath230 in @xmath210 ( @xmath224 may not exist in @xmath2 , ) then @xmath231 are pattern  free .",
    "* if @xmath232 in @xmath210 , then @xmath233 are pattern  free . * if @xmath234 ( forcing @xmath235 ) in @xmath210 , then @xmath30 is pattern  free .",
    "@xmath236    proof : ( p1 ) follows from the proof of lemma  [ deletion1 ] .",
    "( p2 ) says that if all @xmath215 end in their largest element @xmath16 ( or in their second largest element @xmath65 ) , then this last element is pattern  free ( cf .",
    "[ alpha ] ) ; ( p3 ) says that if @xmath30 happens to be the largest element in all @xmath215 and is followed by at most two @xmath170elements , then @xmath30 is pattern  free ( cf .",
    "[ beta][gamma ] . ) both ( p2 ) and ( p3 ) follow from the facts :    * each octagonal pattern @xmath36 has an empty @xmath237 upper  right corner ( see fig .  [ octagonal - conditions]a . ) * for ( p2 ) , reinserting @xmath16 or @xmath65 in the last position in @xmath238 does not create @xmath52patterns .",
    "similarly , for ( p3 ) , reinserting @xmath227 into @xmath238 as the first ( rightmost ) element in @xmath151 does not create @xmath52patterns ( since the tail of @xmath239 after @xmath30 is increasing as part of @xmath207 . )    for ( p4 ) , cf .",
    "case  1  in  fig .",
    "[ epsilon2 ] .",
    "start by deleting the crosses of the elements in the bottom row and in the rightmost column of each @xmath36 ; this leaves the permutation matrix @xmath240 $ ] , which decomposes into a @xmath241 block @xmath242 in the upper left corner and the fixed @xmath243 block @xmath244 in lower left corner ( corresponding to the original @xmath245 and @xmath246 , see fig .",
    "[ octagonal - conditions]b . )    * the fact that @xmath242 is to the left of and higher than @xmath244 proves that @xmath247 are pattern  free : for them , only @xmath205 can fit in such an @xmath242 . in detail , if one of @xmath247 participates in an octagonal pattern @xmath36 , then without loss of generality we may assume that @xmath248 is the rightmost element of @xmath36 .",
    "this forces @xmath205 to participate in @xmath36 too as the only elements larger than @xmath248 .",
    "now @xmath30 , being the largest element of @xmath36 , forces at least three elements after it to participate in @xmath36 ; one is @xmath248 , one could be @xmath249 , hence the third one must be among @xmath250 .",
    "but none of these elements can fit into an @xmath244 as in fig .",
    "[ octagonal - conditions ] because only @xmath251 are larger and to the left of them .",
    "further , reinsertion of @xmath247 into @xmath206 as the largest elements of @xmath150 can not create @xmath52patterns .",
    "thus , @xmath252 are indeed pattern  free . * after deleting @xmath247 , the largest element @xmath30 lands in second to last position in @xmath206 , and by ( p3 ) , it is pattern  free .    for ( p5 ) , cf .",
    "case  2 in fig .",
    "[ epsilon2 ] .",
    "the reasoning here is similar to the case for ( p4 ) .    *",
    "first note that there can be no element @xmath253 of @xmath2 between @xmath166 and @xmath30 , or else @xmath254\\sim p_1 $ ] . *",
    "if one of @xmath255 participates in a pattern @xmath36 , this forces @xmath205 to participate too , and in order not to run into contradiction with the @xmath256 argument above , we must assume that @xmath249 and @xmath257 are also in @xmath36 , and only one among @xmath255 is in @xmath36 .",
    "then the  1  in @xmath36 will have to be between the two largest elements @xmath166 and @xmath30 , which was ruled earlier .",
    "thus , @xmath255 are pattern  free .",
    "* deletion of @xmath255 leaves @xmath258 in third to last position , so by ( p3 ) , @xmath30 is pattern  free . but",
    "@xmath166 is the largest element in @xmath259 , with only @xmath249 and @xmath257 after it , so by ( p3 ) again , @xmath166 is pattern  free .    for ( p6 ) , cf .",
    "case  3 in fig .",
    "[ delta2 ] .",
    "again note that there can be no element @xmath253 of @xmath2 between @xmath166 and @xmath30 , or else @xmath254\\sim p_3 $ ] .",
    "if @xmath30 participates in a pattern @xmath36 , then it forces @xmath260 also to participate .",
    "since the `` 1 '' in @xmath36 can not come from between @xmath166 and @xmath30 , we conclude that @xmath166 does not participate in @xmath36 .",
    "but then we can replace @xmath30 by @xmath166 and argue that there is a pattern @xmath36 in @xmath259 , a contradiction .",
    "hence @xmath30 is pattern  free .",
    "lemma  [ deletion1 ] shows that @xmath134 does not depend on @xmath165 or @xmath167 , but rather on the differences @xmath263 and @xmath264 .",
    "we shall see further that there are only 5 ranges for @xmath264 , that completely determine the values of @xmath265 : each of @xmath266 and @xmath267 corresponds to exactly one of the 5 sequences listed earlier , and defined as follows : @xmath268 where @xmath269 .",
    "all of these definitions are justified by lemma  [ deletion1 ] , except for the definition of @xmath136 , which depends only on @xmath16 but not on @xmath270 and whose explanation will be given later . in our search for relations between these sequences",
    ", it will be useful to define each sequence via an alternative description in the terminology of the families @xmath210 discussed in section  [ generating ] .      by definition ,",
    "@xmath273 is the largest and the rightmost element of any @xmath274 , and hence it is pattern  free by ( p2 ) ( see fig .",
    "[ alpha ] . ) deleting @xmath30 results in a family of @xmath52hex permutations of length @xmath16 without any further restrictions , i.e. we have a bijection @xmath275 this justifies the alternative description of @xmath124 , stated in the introduction : @xmath276    @xmath277      by definition , @xmath279 . here",
    "@xmath273 is second from right to left in @xmath280 , and by ( p3 ) it is pattern  free ( see fig .  [ beta ] . )",
    "thus , deleting @xmath30 imposes only one extra condition : in the new 321hex permutation @xmath281 , the rightmost element in @xmath207 is a @xmath282element or lower , i.e. the largest two elements ( the original @xmath283 and @xmath284 ) belong to @xmath208 .",
    "this justifies the alternative description : @xmath285    @xmath286    in order to find a recursive description of @xmath287 , note that each @xmath288 either ends in @xmath16 or @xmath65 , or both @xmath16 and @xmath65 belong to @xmath151 : @xmath289 by ( p2 ) , if @xmath16 or @xmath65 is the last element in @xmath290 , then it is pattern  free , so deleting it results in a bijection : @xmath291 this justifies the use of @xmath292 in ( [ beta - recursive1 ] )",
    ". consequently , we have the recursive relation @xmath293 for @xmath294 .      by definition , @xmath296 .",
    "here @xmath273 is third from right to left in @xmath297 , and by ( p3 ) it is pattern  free ( see fig .",
    "[ gamma ] . )",
    "deleting @xmath30 imposes the following extra conditions : in the image @xmath281 , the first two elements in @xmath207 are @xmath282elements or lower , i.e. the largest two elements ( the original @xmath283 and @xmath284 ) belong to @xmath151 and there are at least 2 numbers _ after _ @xmath283 .",
    "this justifies the alternative description for @xmath298 : @xmath299    @xmath300    in order to find a recursive description of @xmath301 , note that each @xmath2 counted in @xmath287 ( i.e. @xmath302 ) , falls into one of the following subcases : there is exactly one element _ after _ @xmath16 ( hence in @xmath150 ) , or there are at least two elements _ after _",
    "@xmath16 ( hence in @xmath150 ) :    @xmath303    the underbraced set in ( [ gamma - recursive1 ] ) is depicted in the lhs of fig .",
    "[ gamma2 ] . by ( p3 ) , deletion of @xmath283 results in the numerically equivalent set @xmath304 in the rhs of fig .",
    "[ gamma2 ] .",
    "the permutations in @xmath304 can be described as having their largest element @xmath305 . on the other hand",
    ", @xmath306 breaks into two disjoint groups : group @xmath307 consists of the permutations having the largest element @xmath65 in last position , and group @xmath308 is the set @xmath304 : @xmath309 . finally , note that @xmath310 , so that @xmath311 .",
    "this justifies the underbrace notation in ( [ gamma - recursive1 ] ) , and implies the formulas : @xmath312 for @xmath313 .",
    "@xmath314      by definition , @xmath315 for @xmath316 .",
    "let @xmath317 be the @xmath318elements of @xmath319 , where @xmath316 .",
    "there are two cases to consider ( see fig .",
    "[ epsilon2 ] . )    * case 1 . * except for @xmath205 , all other elements of @xmath151 are smaller than @xmath257 . our drawing shows the next element @xmath320 s.t .",
    "@xmath230 ( @xmath224 may not exist in @xmath2 . ) by ( p4 ) , @xmath321 and @xmath30 are pattern  free . after deletion , the remaining configuration in @xmath322 is identical to the alternative description of @xmath323 .",
    "@xmath324    * case 2 .",
    "* after @xmath205 , the fourth element @xmath224 of @xmath151 is between @xmath257 and @xmath325 : @xmath232 .",
    "recall from ( p5 ) that there can be no element @xmath253 of @xmath2 between the vertical lines of @xmath166 and @xmath30 ; or else , @xmath326 , and hence @xmath254\\sim p_1 $ ] .",
    "further , @xmath327 , @xmath30 and @xmath166 , are pattern  free . after deletion ,",
    "the remaining configuration in @xmath322 is identical to the alternative description of @xmath328 .",
    "note that the case @xmath234 is not allowable , or else @xmath329\\sim p_2 $ ] or @xmath330 ( when @xmath331 or @xmath332 , respectively . )    incidentally , the above discussion shows that @xmath333 does not depend on @xmath100 as long as @xmath316 , and hence justifies the definition of @xmath136 .",
    "we conclude that @xmath334 for @xmath335 .      by definition , @xmath337 .",
    "as above , denote by @xmath260 the @xmath318elements of @xmath338 .",
    "there are three cases to consider ( see fig .",
    "[ delta2 ] . )",
    "@xmath339    * case 1 . * except for @xmath205 , all other elements of @xmath151 are smaller than @xmath257 .",
    "our drawing shows the next element @xmath320 s.t .",
    "@xmath230 ( @xmath224 may not exist in @xmath2 . ) by ( p4 ) , @xmath340 and @xmath30 are pattern  free .",
    "the remaining configuration in @xmath341 is identical to the alternative description of @xmath342 .",
    "* case 2 . * after @xmath205 , the fourth element @xmath224 of @xmath151 is between @xmath257 and @xmath325 : @xmath232 . by ( p5 )",
    ", there can be no element @xmath253 of @xmath2 between the vertical lines of @xmath166 and @xmath30 ; or else , @xmath326 , @xmath343 , and hence @xmath254\\sim p_1 $ ] .",
    "further , @xmath325 , @xmath30 and @xmath166 are pattern  free . after deletion ,",
    "the remaining configuration in @xmath341 is identical to the alternative description of @xmath344 .",
    "* case 3 . * in contrast to",
    "the discussion of @xmath262 , in the case of @xmath336 it is possible to have @xmath234 as long as there is no element @xmath253 of @xmath2 between the vertical lines of @xmath166 and @xmath30 ; otherwise , @xmath254~\\sim~p_3 $ ] . by ( p6 ) , the largest element @xmath273 is pattern  free . after its deletion ,",
    "the remaining configuration in @xmath306 is identical to the original description of @xmath345 .",
    "we conclude that @xmath346 for @xmath125 .",
    "we summarize the results in this section in    the sequences @xmath261 and @xmath262 satisfy the following recursive relations : @xmath347",
    "we are now in a position to combine the recurrence formulas for @xmath348 and @xmath262 into a single recurrence for @xmath271 .",
    "we first use the interpretation of @xmath124 as @xmath349 and expand this in terms of the individual values of @xmath134 .",
    "thus , for a fixed @xmath16 @xmath350 where the sum is taken over @xmath351 .",
    "next , we break the sum into five separate sums depending on the value of @xmath264 ; each such sum corresponds to the definitions of @xmath348 and @xmath262 , respectively .",
    "note that the sum for @xmath271 ( where @xmath352 ) requires two extra special cases for @xmath353 and @xmath354 ; in both cases @xmath355 .",
    "@xmath356 in the next step , we replace the @xmath357 s by the appropriate values of @xmath348 and @xmath262 .",
    "the case of @xmath271 requires some care as we must observe the condition that not all the numerical parameters @xmath358 can be simultaneously equal ; indeed , this only happens in the special case @xmath359 , which was broken out from the main sum earlier .",
    "@xmath360 we replace the indices @xmath162 , @xmath165 and @xmath167 by binomial coefficients : @xmath361 finally , we use the recurrences from sect .",
    "[ recurrences ] to obtain a summation in terms of @xmath271 alone : @xmath362 we simplify this large expression into the following full  history , linear recurrence relation with cubic polynomial coefficients , valid for @xmath125 : @xmath363 where @xmath364 and @xmath365 the polynomial @xmath366 arises from three special cases for the polynomial coefficients of @xmath367 and @xmath368 . since @xmath369",
    ", we need 4 successive history eliminations of the form @xmath370 ; combined with the 3 initial terms @xmath371 and @xmath372 , this produces the desired order ",
    "six constant  coefficient linear recurrence for all @xmath373 : @xmath374    consequently , the number of the 321hexagon avoiding permutations of length @xmath16 is given by the formula : @xmath375 where the roots and coefficients are listed in the introduction . this completes the proof of theorem  [ main - result ] .",
    "the sixth  degree characteristic polynomial of our recurrence relation ( [ main - recurrence ] ) is irreducible over @xmath376 and has galois group @xmath377 , as calculated by maple .",
    "this means that there are no further algebraic relations among the roots @xmath127 in ( [ formula ] ) , and thus we can not hope for any better closed  form results .",
    "however , our numerical approximations of the roots and coefficients can yield exact values for the number of 321hex permutations for any fixed length @xmath16 , exploiting the fact that the value being approximated is known to be an integer . furthermore , since the two roots of modulus less than @xmath26 make such small contributions , they can be dropped and the following formula is exact for all @xmath16 : @xmath378,\\ ] ] where the braces denote rounding to the nearest integer .",
    "the study of the octagonal patterns @xmath36 in the present paper was motivated by their apperance in the representation theory of @xmath0 via heap  avoidance and thus kazhdan  lusztig polynomials and schubert varieties .",
    "we refer to the enumeration of @xmath379 as the `` @xmath37 case '' . from a purely combinatorial viewpoint ,",
    "it is natural to ask what happens in the analogous smaller @xmath380 and @xmath241 cases whose generalized patterns are depicted in fig .",
    "[ extension ] .",
    "@xmath381    to obtain these cases , for each @xmath128 shorten by one the lengths of both @xmath382 and @xmath383 by removing a chosen fixed point appearing in all @xmath36 s .",
    "thus , define @xmath384,[356124],[451623],[456123]\\}\\,\\,\\text{and}\\\\ \\mathcal{p}^{4}&=&\\{[2143],[3142],[2413],[3412]\\}\\end{aligned}\\ ] ] to be the families of avoided octagonal patterns in the @xmath380 and the @xmath241 cases , respectively .",
    "both of these cases lead again to linear recursive relations with constant coefficients .",
    "the proofs below follow closely the method described in the @xmath37 case , so we leave the details for verification to the reader .",
    "let @xmath385 , and @xmath386 .",
    "then @xmath387 satisfies a 6term linear recursive relation with constant coefficients : @xmath388 consequently , for all @xmath389 , @xmath390 where the roots and coefficients are rounded off below to 5 digits after the decimal point : @xmath391 [ 6-by-6 ]    the degree5 characteristic polynomial of the recurrence is irreducible over @xmath376 and has the largest possible galois group , @xmath392 , as calculated by maple .",
    "we can again drop the small roots @xmath393 and @xmath394 , rounding off the remainder to the nearest integer : @xmath395\\,\\,\\text{for all}\\,\\ , n\\geq 1.\\ ] ] the first values of @xmath124 are : 1 , 2 , 5 , 14 , 42 , 128 , 389 , 1179 , 3572 , 10825 , 32810 , 99446 .    proof(theorem  [ 6-by-6 ] ) : we modify the discussion in the proof for the @xmath37 case . define the generating function @xmath396 with one fewer parameter , thus taking into account only the elements @xmath30 and @xmath166 of @xmath397 . as in lemma",
    "[ deletion1 ] , the @xmath166elements are pattern  free , and therefore @xmath398 .    next ,",
    "define the sequences @xmath399 , @xmath400 , @xmath401 and @xmath402 for @xmath229 .",
    "note that @xmath403 since @xmath124 is the number of @xmath404 in which the largest element @xmath142 is at the end and hence it is pattern  free .",
    "further , the relations among the sequences are : @xmath405 now we are ready to express everything in terms of @xmath406 : @xmath407 here the `` 1 '' counts the identity permutation : no @xmath30element in @xmath2 ; in the first sum @xmath166 is smaller than all @xmath170elements ( or @xmath166 does not exist ) ; in the second sum @xmath166 is larger than exactly one @xmath170element ; in the third sum @xmath166 is larger than exactly two @xmath170elements ; and in the forth sum @xmath166 is larger than three or more @xmath170elements and hence @xmath408 .",
    "@xmath409    conveniently , each summand on the rhs can be expressed in terms of @xmath271 , including @xmath410 : @xmath411      let @xmath412 , and @xmath413 .",
    "then @xmath414 in particular , @xmath387 satisfies the 4term linear recursive relation @xmath415    note that in contrast to the @xmath380 and @xmath37 cases , the characteristic polynomial here factors ( completely ) over @xmath376 : @xmath416 .",
    "proof : as expected , we define the generating function @xmath417 with only two parameters , keeping track only of @xmath30 in @xmath418 .",
    "obviously , the @xmath30elements are pattern  free , so @xmath419 .",
    "further , letting @xmath420 and @xmath421 for @xmath422 , one quickly discovers that @xmath423 , so @xmath424 for @xmath294 , and @xmath425 for @xmath389 .",
    "express @xmath426 as the sum @xmath427 as before , here the `` 1 '' counts the identity permutation : no @xmath30element in @xmath2 ; in the first sum @xmath30 is larger than exactly one @xmath170element ; and in the third sum @xmath30 is larger than two or more @xmath170elements and hence @xmath428 .",
    "@xmath429      until now , there were relatively few known examples of sets of permutations whose avoidance led to linear , polynomial , or exponential formulas ( see @xcite . ) after the successful enumeration of the @xmath241 , @xmath380 and the 321hex @xmath37 cases , it is tempting to generalize the recursive sequence method of this paper to the corresponding larger sets of @xmath430 patterns . at this point , it is not surprising to conjecture that all these families yield linear recursive relations with constant coefficients .",
    "in fact , when the result of the present paper was publicized , herbert wilf requested that many more examples of such `` linear '' families be found .",
    "these and other related questions will be answered positively in a forthcoming paper by stankova  frenkel .",
    "the authors would like to thank sara billey and gregory warrington for sharing their results on kazhdan  lusztig polynomials for 321hexagon  avoiding permutations and suggesting the problem on enumeration of forbidden subsequences in this paper ."
  ],
  "abstract_text": [
    "<S> the _ 321,hexagon  avoiding _ ( _ 321hex _ ) permutations were introduced and studied by billey and warrington in @xcite as a class of elements of @xmath0 whose kazhdan  lusztig and poincar polynomials and the singular loci of whose schubert varieties have certain fairly simple and explicit descriptions . this paper provides a 7term linear recurrence relation leading to an explicit enumeration of the 321hex permutations . </S>",
    "<S> a complete description of the corresponding generating tree is obtained as a by  product of enumeration techniques used in the paper , including schensted s 321subsequences decomposition , a 5parameter generating function and the symmetries of the octagonal patterns avoided by the 321hex permutations .    </S>",
    "<S> may 2001 </S>"
  ]
}