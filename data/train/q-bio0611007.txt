{
  "article_text": [
    "two recent papers ( yang and rannala 2005 ; lewis , holder and holsinger 2005 ) highlighted a phenomenon that occurs when sequences evolve on a tree that contains a polytomy - in particular a three - taxon unresolved rooted tree . as longer sequences are analysed using a bayesian approach , the posterior probability of the trees that give the different resolutions of the polytomy do not converge on relatively equal probabilities - rather a given resolution can sometimes have a posterior probability close to one . in response kolaczkowski and thornton ( 2006 ) investigated this phenomena further , providing some interesting simulation results , and offering an argument that seems to suggest that for very long sequences the tendency to sometimes infer strongly supported resolutions suggested by the earlier papers would disappear with sufficiently long sequences . as part of their case the authors use the expected site frequency patterns to simulate the case of infinite length sequences , concluding that  with infinite length data , posterior probabilities give equal support for all resolved trees , and the rate of false inferences falls to zero . \" of course these findings concern sequences that are effectively infinite , and , as is well known in statistics , the limit of a function of random variables ( in this case site pattern frequencies for the first @xmath0 sites ) does not necessarily equate with the function of the limit of the random variables . accordingly kolaczkowski and thornton offer this appropriate cautionary qualification of their findings :     analysis of ideal data sets",
    "does not indicate what will happen when very large data sets with some stochastic error are analyzed , but it does show that when infinite data are generated on a star tree , posterior probabilities are predictable , equally supporting each possible resolved tree . \"",
    "yang and rannala ( 2005 ) had attempted to simulate the large sample posterior distribution , but ran into numerical problems and commented that it was `` unclear '' what the limiting distribution on posterior probabilities was as @xmath0 became large .    in particular ,",
    "all of the aforementioned papers have left open an interesting statistical question , which this short note formally answers - namely , does the bayesian posterior probability of the three resolutions of a star tree on three taxa converge to 1/3 as the sequence length tends to infinity ?",
    "that is , does the distribution on posterior probabilities for ` very long sequences ' converge on the distribution for infinite length sequences ?",
    "we show that for most reasonable priors it does not .",
    "thus the ` star paradox ' does not disappear as the sequences get longer .    as noted by ( yang and rannala 2005",
    "; lewis , holder and holsinger 2005 ) one can demonstrate such phenomena more easily for related simpler processes such as coin tossing ( particularly if one imposes a particular prior ) .",
    "here we avoid this simplification to avoid the criticism that such results do not rigorously establish corresponding phenomena in the phylogenetic setting , which in contrast to coin tossing involves considering a parameter space of dimension greater than 1 .",
    "we also frame our main result so that it applies to a fairly general class of priors .",
    "note also that it is not the purpose of this short note to add to the on - going debate concerning the implications of this ` paradox ' for bayesian phylogenetic analysis , we merely demonstrate its existence .",
    "some further comments and earlier references on the phenomenon have been described in the recent review paper by alfaro and holder 2006 ( pp .",
    "35 - 36 ) .",
    "[ starfig ]    [ overview ]",
    "on tree @xmath1 ( in fig .",
    "1 ) let @xmath2 , @xmath3 denote the probabilities of the four site patterns ( @xmath4 , respectively ) under the simple @xmath5state symmetric markov process ( the argument extends to more general models , but it suffices to demonstrate the phenomena for this simple model ) . from eqn . ( 2 ) of ( yang and rannala 2005 ) we have @xmath6 @xmath7 and @xmath8 it follows by elementary algebra that for @xmath9 , @xmath10 and thus @xmath11 with strict inequality unless @xmath12 ( or in the limit as @xmath13 tends to infinity ) .    to allow maximal generality we make only minimal neutral assumptions about the prior distribution on trees and branch lengths .",
    "namely we assume that the three resolved trees on three leaves ( trees @xmath14 in fig .",
    "1 ) have equal prior probability @xmath15 and that the prior distribution on branch lengths @xmath16 is the same for each tree , and has a continuous joint probability density function that is everywhere non - zero .",
    "this condition applies for example to the exponential and gamma priors discussed by yang and rannala ( 2005 ) .",
    "any prior that satisfies these conditions we call _",
    "reasonable_. note that we do not require that @xmath17 and @xmath13 be independent .",
    "let @xmath18 be the counts of the different types of site patterns ( corresponding to the same patterns as for the @xmath19 s ) .",
    "thus @xmath20 is the total number of sites ( i.e. the length of the sequences ) . given a prior distribution on @xmath21 for the branch lengths of @xmath22 ( for @xmath23 ) let @xmath24 $ ] be the posterior probability of tree @xmath22 given the site pattern counts @xmath25 .",
    "now suppose the @xmath0 sites are generated on a star tree @xmath26 with positive branch lengths .",
    "we are interested in whether the posterior probability @xmath24 $ ] could be close to 1 or whether the chance of generating data with this property goes to zero as the sequence length gets very large .",
    "we show that in fact the latter possibility is ruled out by our main result , namely the following :    [ main ] consider sequences of length @xmath0 generated by a star tree @xmath26 on three taxa with strictly positive edge length @xmath27 and let @xmath25 be the resulting data ( in terms of site pattern counts ) .",
    "consider any prior on the three resolved trees @xmath28 and their branch lengths that is reasonable ( as defined above ) .",
    "for any @xmath29 , and each resolved tree @xmath22 ( @xmath23 ) , the probability that @xmath25 has the property that @xmath30 does not converge to @xmath31 as @xmath0 tends to infinity .",
    "_ proof of theorem  [ main ] _ consider the star tree @xmath26 with given branch lengths @xmath27 ( as in fig .",
    "1 ) . let @xmath32 denote the probability of the four types of site patterns generated by @xmath26 with these branch lengths .",
    "note that @xmath33 and so @xmath34 ) .",
    "suppose we generate @xmath0 sites on this tree , and let @xmath35 be the counts of the different types of site patterns ( corresponding to the @xmath19 s ) .",
    "let @xmath36 and for @xmath23 let @xmath37 for a constant @xmath38 , let @xmath39 denote the event : @xmath40 \\mbox { and } \\delta_0 \\in [ -c , c].\\ ] ] notice that @xmath39 implies @xmath41 $ ] since @xmath42 . by standard stochastic arguments ( based on the asymptotic approximation of the multinomial distribution by the multinormal distribution ) event @xmath39 has probability at least some value @xmath43 for all @xmath0 sufficiently large ( relative to @xmath44 ) .",
    "given the data @xmath45 the assumption of equality of priors across @xmath46 and @xmath47 implies that @xmath48 and @xmath49    now , as @xmath21 are random variables with some prior density , when we view @xmath50 as random variables by virtue of their dependence on @xmath21 , we will write them as @xmath51 ( note that yang and rannala ( 2005 ) use @xmath52 differently ) . with this notation ,",
    "the posterior probability of @xmath1 conditional on @xmath25 can be written as @xmath53\\ ] ] where @xmath54 is the posterior probability of @xmath25 and @xmath55 denotes expectation with respect to the prior for @xmath16 on @xmath1 .",
    "moreover since @xmath56 , we can write this as @xmath57.$ ] by ( [ identities1 ] ) and ( [ identities2 ] ) we have @xmath58 ; \\mbox { and } { \\mathbb p}(t_3|{\\bf",
    "n } ) = p({\\bf n})^{-1 } \\times { { \\mathbb e}}_1[p_0^{n_0}p_1^{n_3}p_2^{n_1+n_2}]\\ ] ] where again expectation is taken with respect to the prior for @xmath59 on @xmath1 .",
    "consequently , @xmath60}{{{\\mathbb e}}_1[y]},\\ ] ] where @xmath61 as will be shown later , it suffices to demonstrate that the ratio in ( [ eqfrac ] ) can be large with nonvanishing probability in order to obtain the conclusion of the theorem .",
    "in order to do so we use the following lemma , whose proof is provided in the appendix .",
    "[ lem3 ] let @xmath62 be non - negative continuous random variables , dependent on a third random variable @xmath63 that takes values in an interval @xmath64 $ ] .",
    "suppose that for some interval @xmath65 strictly inside @xmath66 , and @xmath67 the following inequality holds : @xmath68 \\geq { { \\mathbb e}}[y|\\lambda \\in i_1],\\ ] ] and that for some constant @xmath69 , and all @xmath70 , @xmath71}{{{\\mathbb e}}[y|\\lambda=\\lambda ] } \\geq b.\\ ] ] then , @xmath72}{{{\\mathbb e}}[y ] } \\geq b\\cdot { \\mathbb p}(\\lambda \\in i_0)$ ] .    to apply this lemma , select a value @xmath73 so that @xmath74 , and let @xmath75 $ ] . then let @xmath76 $ ] and @xmath77 .",
    "_ claim : _ for @xmath0 sufficiently large , and conditional on the data @xmath18 satisfying @xmath39 :    * @xmath78 \\geq { { \\mathbb e}}_1[y|p_0 \\in i_1]$ ] * for all @xmath79 , @xmath80}{{{\\mathbb e}}_1[y|p_0=p_0 ] }    \\geq 6c^2 $ ] .",
    "the proofs of these two claims is given in the appendix .",
    "applying lemma  [ lem3 ] to the claims ( i ) and ( ii ) we deduce that conditional on @xmath25 satisfying @xmath39 and @xmath0 being sufficiently large , @xmath81}{{{\\mathbb e}}_1[y ] } \\geq 6c^2 \\cdot { \\mathbb p}(p_0 \\in i_0).\\ ] ]    select @xmath82 ( this is finite by the assumption that the prior on @xmath21 is everywhere non - zero ) . as stated before , the probability that @xmath25 satisfies @xmath39 is at least @xmath43 for @xmath0 sufficiently large .",
    "then , @xmath83 and so by ( [ cbound ] ) , @xmath84}{{{\\mathbb e}}_1[y ] } > \\frac{2}{\\epsilon}.$ ] similarly , @xmath85 now , since @xmath86 it now follows that , for @xmath0 sufficiently large , and conditional an event of probability at least @xmath87 , that @xmath88 as claimed .",
    "this completes the proof .",
    "one feature of the argument we have provided is that it does not require stipulating in advance a particular prior on the branch lengths  that is , the result is somewhat generic as it imposes relatively few conditions .",
    "moreover , the requirement that the prior on @xmath21 be everywhere non - zero could be weakened to simply being non - zero in a neighborhood of @xmath90 ( thereby allowing , for example , a uniform distribution on bounded range ) .    a interesting open question in the spirit of this paper is to explicitly calculate the limit of the posterior density @xmath91 described in ( yang and rannala 2005 ) .",
    "ms thanks ziheng yang for suggesting the problem of computing the limiting distribution of posterior probabilities for 3-taxon trees .",
    "this work is funded by the _ allan wilson centre for molecular ecology and evolution_.",
    "alfaro me , holder mt . 2006 . the posterior and prior in bayesian phylogenetics .",
    "evol . syst . 37 : 19 - 42 .",
    "kolaczkowski b , thornton jw .",
    "is there a star tree paradox ?",
    "biol . evol . 23 : 18191823",
    ".    lewis po , holder mt , holsinger ke . 2005 . polytomies and bayesian phylogenetic inference .",
    "54 ( 2 ) : 241 - 253 .",
    "yang z , rannala b. 2005 .",
    "branch - length prior influences bayesian posterior probability of phylogeny .",
    "54 ( 3 ) : 455 - 470 .",
    "_ proof of lemma  [ lem3 ] _ : for @xmath92 we have @xmath93 = { { \\mathbb e}}[w|\\lambda \\in i_0]{\\mathbb p}(\\lambda \\in i_0 ) + { { \\mathbb e}}[w|\\lambda \\in i_1]{\\mathbb p}(\\lambda \\in i_1).\\ ] ] in particular , for @xmath94 we have : @xmath95 \\geq   { { \\mathbb e}}[x|\\lambda \\in i_0]{\\mathbb p}(\\lambda \\in i_0)$ ] .",
    "note that ( [ eqin2 ] ) implies that @xmath96 \\geq b \\cdot { { \\mathbb e}}[y|\\lambda \\in i_0]$ ] , so @xmath97 \\geq   b \\cdot { { \\mathbb e}}[y|\\lambda \\in i_0]{\\mathbb p}(\\lambda \\in i_0).\\ ] ] taking @xmath98 in ( [ equatione1 ] ) and applying ( [ eqin ] ) gives us @xmath99 \\leq { { \\mathbb e}}[y|\\lambda \\in i_0]({\\mathbb p}(\\lambda \\in i_0)+{\\mathbb p}(\\lambda \\in i_1))={{\\mathbb e}}[y|\\lambda \\in i_0]\\ ] ] which combined with ( [ equatione2 ] ) gives the result .",
    "@xmath89      we will first bound @xmath100 $ ] above .",
    "let @xmath101 .",
    "now , conditional on @xmath25 satisfying @xmath39 we have @xmath102 where @xmath103 and @xmath104 , and @xmath105 denotes kullback - leibler distance .",
    "now , @xmath106 ( the first inequality is a standard one in probability theory ) .",
    "in particular , if @xmath107 , then @xmath108 .",
    "moreover , @xmath109 \\leq \\max\\{y(t_0 , t_1 ) : p_0(t_0 , t_1 ) \\in i_1\\}.\\ ] ] summarizing , @xmath110 \\leq \\max\\{y(t_0 , t_1 ) : p_0(t_0 , t_1 ) \\in i_1\\ } < \\mu(n)e^{-\\frac{1}{2}s^2n + o(n)}.\\ ] ] in the reverse direction , we have : @xmath111 \\geq a(n)b(n)\\ ] ] where @xmath112 \\times    [ t_1 ^ 0 , t_1 ^ 0+n^{-1 } ] \\right\\}\\ ] ] and @xmath113 \\times [ t_1 ^ 0 , t_1 ^ 0 + n^{-1}]).\\ ] ] now , @xmath114 now , the first term of this product converges to a constant as @xmath0 grows ( because @xmath115 and @xmath116 are each of order @xmath117 ) while the condition @xmath39 ensures that the second term decays no faster than @xmath118 for a constant @xmath119 .",
    "thus , @xmath120 for a positive constant @xmath121 .",
    "the term @xmath122 is asymptotically proportional to @xmath123 .",
    "summarizing , for a constant @xmath124 ( dependent just on @xmath27 ) @xmath111 \\geq   c_3 \\mu(n)n^{-2}e^{-c_1\\sqrt{n}},\\ ] ] which combined with ( [ eqo1 ] ) establishes claim ( i ) for @xmath0 sufficiently large .",
    "@xmath89      let @xmath125 .",
    "then for each @xmath126 there exists a value @xmath127 that depends continuously on @xmath128 so that the following holds . for any continuous random variable @xmath129 on @xmath130 $ ] with a smooth density function @xmath131 that satisfies @xmath132 and @xmath133 for",
    "all @xmath134 $ ] , we have @xmath135 -    { { \\mathbb e}}[z^{k+1}])}{{{\\mathbb e}}[z^k ] } \\geq \\frac{1}{2}\\ ] ] for all @xmath136 . [ lem1 ]    _ proof .",
    "_ let @xmath137 .",
    "then @xmath138 = \\int_{0}^{t_k } t^k f(t)dt + \\int_{t_k}^1 t^k f(t)dt.\\ ] ] now , @xmath139 where @xmath140 denotes asymptotic equivalence ( i.e. @xmath141 iff @xmath142 ) . using integration by parts ,",
    "@xmath143 now , provided @xmath144 we have @xmath145 and so the absolute value of the second term on the right is at most @xmath146 consequently , @xmath147 - \\frac{f(1)}{k+1}\\right|$ ] is bounded above by @xmath148 times a term of order @xmath149 .",
    "a similar argument , again using integration by parts , shows that @xmath150- { { \\mathbb e}}[z^{k+1 } ] ) -   \\frac{f(1)}{k+1}\\right|$ ] is bounded above by @xmath148 times a term of order @xmath149 , and the lemma now follows by some routine analysis .",
    "@xmath89          write @xmath158 $ ] as shorthand for @xmath159 $ ] .",
    "note that , for any @xmath160 , @xmath161 = p_0^{n_0}{{\\mathbb e}}_1[p_1^{r}p_2^{s}|p_0]$ ] .",
    "consequently , if we let @xmath162 then , by definition of the @xmath163 s , @xmath164}{{{\\mathbb e}}_1[y|p_0 ] } = \\frac{{{\\mathbb e}}_1[(p_1p_2 ^ 2)^{k}\\cdot ( p_1^{\\delta_1}p_2^{\\delta_2+\\delta_3})^{\\sqrt{n}}|p_0]}{{{\\mathbb e}}_1[(p_1p_2 ^ 2)^{k } \\cdot ( p_1^{\\delta_2}p_2^{\\delta_1+\\delta_3})^{\\sqrt{n}}|p_0]}.\\ ] ] now , conditional on @xmath25 satisfying @xmath39 ( and since @xmath165 ) the following two inequalities hold @xmath166 applying this to ( [ efrac ] ) gives : @xmath167}{{{\\mathbb e}}_1[y|p_0 ] } \\geq \\frac{{{\\mathbb",
    "e}}_1\\left[(p_1p_2 ^ 2)^{k}\\cdot \\left(\\left.\\frac{p_1}{p_2}\\right)^{2c\\sqrt{n}}\\right|p_0\\right]}{{{\\mathbb e}}_1[(p_1p_2 ^ 2)^{k}|p_0]}.\\ ] ]    let @xmath168 , which takes values between @xmath31 and @xmath169 because @xmath165 . since @xmath170 , we can write @xmath171 and @xmath172 . thus , @xmath173 and @xmath174 . substituting these into ( [ efrac2 ] ) , letting @xmath175 and noting that @xmath176 gives @xmath177}{{{\\mathbb e}}_1[y|p_0 ] }   \\geq   \\frac{{{\\mathbb e}}_1\\left[\\left.z^{k}\\cdot ( \\frac{1 + 2u}{1-u})^{2c\\sqrt{3k}}\\right|p_0\\right]}{{{\\mathbb e}}_1[z^{k}|p_0]}.\\ ] ] thus , by lemma  [ lem2 ] , ( taking @xmath178 we obtain , for @xmath153 , @xmath179}{{{\\mathbb e}}_1[y|p_0 ] } \\geq 12c^2k\\cdot \\frac{\\left({{\\mathbb e}}_1[z^{k}|p_0]-{{\\mathbb e}}_1[z^{k+1}|p_0]\\right)}{{{\\mathbb e}}_1[z^{k}|p_0]}.\\ ] ] now the mapping @xmath180 is a smooth invertible mapping between @xmath181 and its image within @xmath182 .",
    "notice that @xmath129 approaches @xmath169 whenever @xmath183 approaches @xmath184 or @xmath169 ( in particular , even if @xmath16 are independent , @xmath183 and @xmath129 generally will not be ) .",
    "however over the interval @xmath65 the conditional density @xmath185 of @xmath129 given a value @xmath186 for @xmath183 is smooth and bounded away from @xmath31 , and its first derivative is also bounded above over this interval .",
    "consequently , we may apply lemma  [ lem1 ] ( noting that the condition that @xmath25 satisfies @xmath39 ensures that @xmath187 ) to show that for @xmath0 sufficiently large the following inequality holds for all @xmath79 , @xmath188-{{\\mathbb e}}_1[z^{k+1}|p_0]\\right)}{{{\\mathbb e}}_1[z^{k}|p_0 ] } \\geq   \\frac{1}{2}.\\ ] ] applying this to ( [ boundx ] ) gives @xmath189}{{{\\mathbb e}}_1[y|p_0 ] } \\geq 6c^2 $ ] as claimed .",
    "this completes the proof of claim ( ii ) ."
  ],
  "abstract_text": [
    "<S> the ` star paradox ' in phylogenetics is the tendency for a particular resolved tree to be sometimes strongly supported even when the data is generated by an unresolved ( ` star ' ) tree . </S>",
    "<S> there have been contrary claims as to whether this phenomenon persists when very long sequences are considered . </S>",
    "<S> this note settles one aspect of this debate by proving mathematically that there is always a chance that a resolved tree could be strongly supported , even as the length of the sequences becomes very large .    </S>",
    "<S> keywords : phylogenetic trees , bayesian statistics , star trees </S>"
  ]
}