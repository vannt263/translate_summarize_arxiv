{
  "article_text": [
    "the mathematical study of models for evolution has a long history .",
    "the early work of wright , fisher , moran , and feller  @xcite , where those authors studied of small population size on a model of neutral evolution ( see  @xcite for a nice overview of the early history of these studies ) . in parallel ,",
    "the mathematical framework of game theory  @xcite and evolutionary game theory  @xcite has been used since to model and understand complexity in problems in evolution and ecology .",
    "a truly large volume of work has been developed in the last few decades using this approach  @xcite .",
    "most of the models mentioned above can be formulated as a markov chain on a lattice , where the discrete points on the lattice correspond to integer sizes of the various subpopulations . in the limit of large population",
    ", this markov chain undergoes smaller jumps ( on the population scale ) , if this is coupled with an appropriate rescaling in time , we might expect a sensible limit to a continuum model .",
    "what is true is that if one does this rescaling properly , then in the limit of infinite population , the system does converge to an ode . in the case of large but finite populations ,",
    "the system is still stochastic , so it is of interest to study the invariant distributions of such a system , the rate and type of convergence to this equilibrium , and in particular switching processes between multiple equilibria .",
    "the first rigorous results in this direction were due to the pioneering work of kurtz in the context of biochemical models  @xcite , but have been followed up by a large number of analytic and numerical studies  @xcite .",
    "the purpose of this paper is to apply the modern techniques of stochastic analysis to a particular model of evolutionary game theory .",
    "the model we consider is a version of a model described in  @xcite ; we consider a population consisting of organisms who can each play one of two strategies where the payoff matrix is of prisoner s dilemma type , and the organisms evolve according to moran dynamics , i.e. in each round of play , one organism is chosen to reproduce based on its fitness and one organism is killed at random , so that the population size remains constant .",
    "we also allow a positive probability for a mutation , i.e. there is a positive probability @xmath0 that an organism s offspring is of the other type .",
    "we stress here that we consider a fully stochastic version of this model where all events are governed by a markov process .",
    "the infinite - population limit of this process ( an ode ) is described in  @xcite , and it is shown there that for certain parameters the ode supports two stable fixed points with disjoint basins of attraction , i.e. is multistable .",
    "we show that our markov chain model limits on this ode model as the population tends to infinity .    for population large but finite , however , the system is still noisy and can jump between the multiple attractors , although it will only do so on long timescales . studying the timescale",
    "on which this jumping occurs is one of the main goals of this paper , and we give two different asymptotic descriptions of this timescale . another interesting effect we show by considering the stochastic system ( as compared to its deterministic limit ) is we show that certain parameters that are indistinguishable in the limit give rise to biases for large but finite populations .",
    "for example , if we assume that the aggregate payoff is the same for both strategies ( i.e. the sum of the payoffs against both friends and enemies is the same for both strategies ) , but one strategy plays better against enemies than it does against its friends , it will have an advantage for finite size populations , while being indistinguishable in the limit .",
    "in this paper , we consider a finite population of size @xmath1 consisting of two strategies , @xmath2 and @xmath3 .",
    "we assume that payoffs from each individual game are awarded by a payoff matrix given by @xmath4.\\ ] ] here , we represent the payoff to player1 in an interaction where player1 s play is along the left column , and player2 s play is on the top row .",
    "we assume that the payoff to player2 is always the transpose of this matrix .",
    "for example , when we have two players playing strategy @xmath2 , they each receive a payoff of @xmath5 , and if they both are strategy @xmath3 , they each receive @xmath6 . if two individuals with different strategies meet , if player1 is type @xmath3 , player1 receives a payoff of @xmath7 while player2 receives a payoff of @xmath8 .",
    "once the average payoffs are determined , each strategy is awarded a fitness value .",
    "fitness can have many interpretations such as physical fitness or ability to collect food , but ultimately it affects the survival of individuals , and here we assume that the fitness is proportional to the payoff an individual receives playing the game . specifically ,",
    "if we assume that there are @xmath9 individuals of type @xmath2 in the population , then the function @xmath10 represents the average fitness of an individual of type @xmath2 ( resp .",
    "type @xmath3 ) .",
    "this represents the average payoff an organism would receive if it chose an opponent at random and played the game described above .",
    "we want to consider only evolutionarily stable strategies ( ess ) , those strategies which are resistant to invasion by a single mutant .",
    "for example , strategy @xmath2 will be ess if @xmath11 when @xmath12 ( i.e. when all but one organism is type @xmath2 ) .",
    "this means that @xmath13 and if we want this equation to hold for arbitrarily large populations , then the condition is clearly @xmath14 .",
    "similarly , strategy @xmath3 is ess iff @xmath15 .",
    "we will assume this in all that follows below .",
    "after the fitness of each strategy is determined , the population evolves similar to a moran model , but with the possibility of a mutation during birth . in each round , one individual is chosen for reproduction with probability proportional to its fitness and gives birth to one offspring . however",
    ", this offspring is of the opposite type with probability @xmath16 . at each stage ,",
    "one organism is chosen at random to be removed .    from this",
    ", we can view the model as a markov process @xmath17 on the discrete state space @xmath18 with transition rates @xmath19 here the state represents the number of organisms of type @xmath2 . to see these rates ,",
    "note that to have the transition @xmath20 , either an individual with strategy @xmath2 needs to reproduce ( with no mutation ) and an individual with strategy @xmath3 needs to die , or an individual with strategy @xmath3 needs to reproduce ( with mutation ) and an individual with strategy @xmath3 needs to die .",
    "similar arguments can be made for moving from state @xmath9 to @xmath21 .",
    "( of course , these rates do not add to one , since there is a possibility that the population size does not change : for example , if an individual of type @xmath2 reproduces without mutation , but an individual of type @xmath2 is also selected to die , then there is no change in the population , etc . )    throughout this paper we will often switch between the extensive variable @xmath9 and the scaled variable @xmath22 . in the limit as @xmath23 , we treat @xmath24 as a continuous variable .",
    "it is also assumed that the transition rates obey the scaling law @xmath25 .",
    "the following sections study this process both deterministically and stochastically . for given parameters @xmath5 , @xmath8 , @xmath7 , @xmath6 , and",
    "@xmath26 we seek to describe the distribution of strategies within the population and determine which strategy ( if any ) has an advantage .",
    "we also remark that while the definition above seems to average out some of the randomness before we write down the markov chain ( e.g. we consider `` average fitness '' when writing down the transition rates in the chain ) , we could obtain the same model without such averaging . for example , if we assume that , at each timestep , each individual is paired with another individual in the population ( selected with replacement ) and then receives a deterministic payoff from  , and then we choose individuals to reproduce with a probability proportional to their fitness , then again we would obtain  ( [ eq : transitionrate+ ] ,  [ eq : transitionrate- ] ) .",
    "the results fall into three cases which arise naturally from the payoff matrix . due to symmetry",
    ", we discuss only case 1.1 and case 2 .",
    "* case 1  @xmath27 + when populations @xmath2 and @xmath3 have equal size , @xmath2 and @xmath3 have equal fitness .",
    "there are three additional subcases .",
    "* * case 1.1  @xmath28 and @xmath29 + @xmath2 has better self - interactions than strategy @xmath3 , but strategy @xmath3 has better opponent interactions than strategy @xmath2 . * * case 1.2  @xmath30 and @xmath31 + same as 1.1 , but with the roles of @xmath2 and @xmath3 switched * * case 1.3  @xmath32 and @xmath33 + degenerate case where @xmath2 and @xmath3 are interchangable * case 2  @xmath34 + when populations @xmath2 and @xmath3 have equal sizes , @xmath2 has a higher fitness than @xmath3 . * case 3  @xmath35 + when populations @xmath2 and @xmath3 have equal sizes , @xmath3 has a higher fitness than @xmath2 .    for case 2 ,",
    "it is clear that strategy @xmath2 will have the advantage based on the asymmetry of the payoff matrix  , and similarly for case 3 .",
    "case 1.1 is not at all clear _",
    "a priori_. one could argue that strategy @xmath2 has the advantage because it has better self - interactions than strategy @xmath3 , or that strategy @xmath3 has the advantage because it has better interaction with strategy @xmath2 than strategy @xmath2 has with strategy @xmath3 .",
    "we will consider these more fully below .",
    "in figures  [ fig:4132 ] and  [ fig:4214 ] we plot the invariant measure of the the markov process ( in fact , we are plotting the logarithm of this invariant measure for better contrast ) .",
    "figure  [ fig:4132 ] corresponds to an example of case 1.1 and figure  [ fig:4214 ] is an example of case 2 .",
    "the simulations were run for @xmath36 iterations with a burn in of @xmath37 and averaged over @xmath38 realizations .",
    "the colors towards the beginning of the rainbow represent densities closer to 1 , while the lower colors represent densities closer to 0 .",
    "it is apparent from these pictures that when mutation is rare enough , there are two metastable mixtures that correspond to the fact that both strategies are ess in the absence of mutation . as the mutation probability increases , these mixtures approach each other . in figure",
    "[ fig:4132 ] , they seem to merge smoothly into a single stable mixture , whereas in figure  [ fig:4214 ] one mixture disappears suddenly and the other takes over .",
    "we point out that these mixtures are metastable since we expect switching between them due to stochastic effects .    .",
    "both frames have parameters @xmath39 ; the right frame is a blowup of the left.,title=\"fig : \" ] .",
    "both frames have parameters @xmath39 ; the right frame is a blowup of the left.,title=\"fig : \" ]    .",
    "both frames have parameters @xmath40 ; the right frame is a blowup of the left.,title=\"fig : \" ] .",
    "both frames have parameters @xmath40 ; the right frame is a blowup of the left.,title=\"fig : \" ]      above , we have presented the payoff matrix   without any derivation . here",
    "we discuss a bit about how such a matrix can arise .",
    "a common game - theoretic model to consider is that of the prisoner s dilemma ( pd ) , namely a payoff matrix @xmath41,\\ ] ] where @xmath42 , and we use the same convention of symmetry as above , i.e. that player2 s payoff matrix is the transpose of player1 s .",
    "each player has the option to `` cooperate '' or to `` defect '' .",
    "it is clear that if we assume the strategies are deterministic , the nash equilibrium strategy is for both players to defect , since the second row is componentwise larger than the first .",
    "this is considered a dilemma because @xmath43 , so that if the players could somehow agree to cooperate and trust each other , they would each receive a higher payoff , but in any situation where there is a lack of trust they are better off both defecting .",
    "now , we first note that the prisoner s dilemma is not in the form mentioned above , since for us to have two strategies that are both ess , we would need that @xmath44 to make @xmath45 stable . however , let us assume that the payoff matrix   is the aggregate payoff of an @xmath46-round game between two strategies that cooperate and defect in some pattern , is it possible to have both strategies be ess ?",
    "the simplest case is if we assume that each strategy is to play @xmath45 and @xmath47 with some fixed probabilities , independent of the history of one s opponent .",
    "for example , if we assume that strategy @xmath2 is to cooperate with probability @xmath48 $ ] and defect with probability @xmath49 , and similarly for strategy @xmath3 with probability @xmath50 , then after a large algebraic computation we find that @xmath51 and @xmath52 , and clearly it is not possible that both of these be positive .",
    "in particular , a strategy is ess iff it is more likely to defect than the opposing strategy .",
    "however , it is possible to construct strategies based on aggregate pd that allow for memory effects that give multiple ess .",
    "for example , consider two strategies known as `` tit - for - tat '' ( tft ) and `` always defect '' ( alld ) . in the former ,",
    "the strategy is to cooperate in the first round , then do whatever the opponent did in the previous round ; the second strategy is to always defect .",
    "if we assume that strategy @xmath2 is tft and @xmath3 is alld , then after @xmath46 rounds of play , the aggregate payoffs are @xmath53.\\ ] ] to see this , note that two players of type @xmath2 will always cooperate and two of type @xmath3 will always defect .",
    "if tft plays alld , then the first player will cooperate once and then defect forever , so will receive one payoff of @xmath54 and @xmath55 payoffs of @xmath56 , while the second player will receive one payoff of @xmath57 and @xmath55 payoffs of @xmath56 . since @xmath58 , we see that @xmath3 is ess , but for @xmath2 to be ess , we need @xmath59 . but notice that @xmath43 , so clearly for @xmath46 sufficiently large , @xmath2 is also ess .",
    "the types of mixtures that give rise to multiple ess in a two - population game have a long history and have been studied extensively , see  @xcite .",
    "the expected step size of the markov process is given by @xmath60}{dt } = \\omega_+(x_t ; \\mu ) - \\omega_-(x_t ; \\mu),\\ ] ] where @xmath61 is defined in  ( [ eq : transitionrate+],[eq : transitionrate- ] ) . switching to the scaled variables and rates",
    "@xmath62 we see that the deterministic equation @xmath63 describes the mean of the markov process .",
    "as it turns out , in the limit @xmath64 ,   also gives a good approximations to all paths of the markov process in a sense that can be made precise  @xcite ; we discuss this further in section  [ sec : stochastic ] , but for now we take   as the system to consider .",
    "the equation   is a 1-parameter family of differential equations .",
    "we seek to use bifurcation analysis to determine the equilibria of the deterministic equation .",
    "each case outlined in section  [ ssec : cases ] leads to a different class of bifurcation diagrams ( using the mutation rate @xmath26 as the bifurcation parameter ) .",
    "the assumption of multiple ess made above , means that for @xmath65 , we have that @xmath66 are nondegenerate fixed points .",
    "thus it follows that the system has multiple stable equilibria for some open set of @xmath26 containing zero .",
    "making a substitution for one of the variables allows @xmath69 to be factored into @xmath70    it is then easy to see that equilibria of the deterministic equation occur at the following points , @xmath71    the stability of these equilibria depend on the value of @xmath26 .",
    "when @xmath65 the equilibria are @xmath72 , @xmath73 , and @xmath74 with @xmath75 and @xmath76 being stable and @xmath77 unstable .",
    "the equilibria maintain these stabilities until the first bifurcation point , @xmath78 .",
    "this bifurcation point occurs when either @xmath79 or @xmath80 intersects @xmath81 .",
    "assuming @xmath67 and @xmath68 , this intersection occurs between @xmath80 and @xmath81 resulting in @xmath80 becoming unstable and @xmath81 becoming stable . solving for this intersection",
    ", we find @xmath82 .",
    "the second bifurcation value , @xmath83 , occurs when @xmath79 and @xmath80 become complex - valued leaving @xmath81 as the only stable equilibrium .",
    "we find @xmath84 .",
    "( note that in case 1.3 , there is complete symmetry and @xmath85 ) .",
    "this analysis completely determines the bifurcation diagrams for case 1.1 .",
    "the bifurcation diagram will have the same qualitative behavior as figure [ fig : bd4132 ] .    .",
    "left frame is @xmath16 and the right frame is a blowup .",
    "compare this figure to figure  [ fig:4132].,title=\"fig : \" ] .",
    "left frame is @xmath16 and the right frame is a blowup . compare this figure to figure  [ fig:4132].,title=\"fig : \" ]      it is no longer possible to factor @xmath69 , but we can use the implicit function theorem to describe the motion of the equilibria .",
    "when @xmath87 , equilibria occur at @xmath88 again with with @xmath75 and @xmath76 being stable and @xmath77 unstable .",
    "if @xmath89 is an equilibrium of the deterministic equation then the implicit function theorem implies    @xmath90    the only real root of @xmath91 between @xmath92 and @xmath93 is @xmath94 by observing that @xmath95 we find that @xmath96 for @xmath97 and @xmath98 for @xmath99 .",
    "the roots of @xmath100 occur when @xmath101 where @xmath102    by observing that @xmath103    and that @xmath104 is concave down we find that @xmath105 is a parabola in the @xmath26-@xmath24 plane .",
    "therefore @xmath106 for @xmath107 and @xmath108 for @xmath109 .     for @xmath34 ]",
    "putting the information about @xmath111 and @xmath112 together , there are @xmath113 regions where @xmath114 changes sign .",
    "the first equilibrium @xmath79 starts at @xmath92 which is located in a region where @xmath115 and is therefore increasing .",
    "it is easy to show that @xmath116 and thus @xmath81 starts in a region where @xmath117 . therefore @xmath81 is always decreasing .",
    "similarly @xmath80 starts in a region where @xmath117 and therefore is always decreasing .",
    "a bifurcation point occurs at the value of @xmath26 when two of the equilibria become complex valued . by continuity",
    ", this must occur along @xmath118 when @xmath80 and @xmath81 collide .",
    "the bifurcation diagram described by the motion of these equilibria has the qualitative behavior as figure  [ fig : bd4214 ] .",
    ", title=\"fig:\",scaledwidth=49.0% ] , title=\"fig:\",scaledwidth=49.0% ]",
    "section [ sec : deterministic ] described the deterministic behavior of the process in the @xmath64 limit .",
    "however , if @xmath119 but finite , the markov chain model with retain stochasticity , although of course the variance of this process will vanish as @xmath64 .    in this section ,",
    "we study this random process for @xmath1 large but finite , using the standard tools  @xcite .",
    "the two main asymptotic expansions used here are the `` diffusion approximation '' and the `` wkb expansion '' , which roughly go as follows . in both cases , we assume that we start off with a master equation for the stochastic process after a system size scaling , specifically we write @xmath120 with reflecting boundary conditions at @xmath121 and @xmath122 . in terms of the scaled variable @xmath123 ,",
    "this master equation is @xmath124    in the diffusion approximation , one simply makes a taylor series expansion of   and then truncates at second order , which gives a fokker  planck pde .",
    "one can then consider the paths of this fokker ",
    "planck equation which are governed by an sde .",
    "computing the stationary distribution and the jumping timescale then corresponds to solving this pde with particular boundary conditions .",
    "in particular , since the system is one - dimensional , it can be written in the form of a diffusion in a one - dimensional potential @xmath125 .",
    "this potential governs the dynamics of this system , and in particular governs the switching times of the system from one basin to another .    in the wkb approximation ,",
    "the procedure is more complex .",
    "we seek to understand how the distribution of an initial condition placed near one attractor will behave .",
    "the motivating presumption is that it will settle down to a characteristic shape inside the basin of attraction of this point , and this shape will decay to zero on a timescale associated with the escape of trajectories out of this basin . more concretely",
    ": we first assume that the solution of the master equation assuming that the initial condition is at @xmath126 w.p.1 can be written in _",
    "quasistationary form _ , @xmath127 where @xmath128 is the yet - to - be - determined jumping timescale .",
    "if we truncate the above expression to remove terms of order @xmath129 , we obtain the quasistationary distribution @xmath130 we drop the subscript on @xmath131 in the sequel . here",
    "the function @xmath132 plays the role of a potential , similar to @xmath125 in the diffusion approximation and is also called the _ quasipotential _ for the system .",
    "the distribution @xmath133 is not a stationary distribution , since it will decay on the long timescale @xmath134 , but the idea is that the solution relaxes very quickly to @xmath133 , and then decays slowly to zero .",
    "one can perform an asymptotic expansion in inverse powers of @xmath1 to obtain equations for @xmath135 , see details below .",
    "it is known  @xcite that the wkb expansion gives an asymptotically correct expression for the jumping timescale , whereas the diffusion approximation gives a slightly different , and wrong expression , but we observe two things for this problem : first , the diffusion approximation is much simpler to compute , and second , the answers obtained from the numerics show that the two answers are indistinguishable on the types of problems that we can simulate .",
    "performing a taylor expansion on   in powers of @xmath136 results in @xmath137\\ ] ] where @xmath138 . terminating this series to order @xmath136 and writing @xmath139 results in the * diffusion approximation * @xmath140 + \\frac{1}{2n } \\frac{\\partial^2}{\\partial x^2 } \\left [ \\sigma(x ) p(x ) \\right ]",
    "= : { \\mathcal{l}}^ * p\\ ] ] the diffusion approximation is a fokker - planck equation and has the equivalent sde form @xmath141 as @xmath142 , this is exactly the deterministic equation discussed in section [ sec : deterministic ] .      the linear noise approximation , more commonly known as the van kampen expansion  @xcite .",
    "the idea here is to write @xmath143 , obtain equations for @xmath144 , then assume that @xmath145 has some well - defined limit as @xmath146 . in the case where the deterministic system has a unique attracting fixed point @xmath147 , applying the van kampen expansion ( see appendix  [ sec : vk ] for more detail , we obtain @xmath148 \\to x^*,\\quad { { \\rm{var}}}(x(t ) ) \\to \\frac { \\sigma(x_*)}{2 n { \\left|{f'(x_*)}\\right|}}.\\ ] ] this computation is simple and gives useful information : in particular we obtain the scaling of the variance as a function of @xmath1 .",
    "the one issue with this approximation is that it is guaranteed to be gaussian and thus can not capture the skew of the original process .",
    "the linear noise approximation is the lowest order expansion for the diffusion approximation , but this can be extended to a general perturbation expansion on  .",
    "writing @xmath149 and truncating at second order , we obtain for large @xmath57 ( see section  [ app : ho ] for details ) : @xmath150 \\to x _ * + \\frac{f''(x_*)\\sigma(x_*)}{4n(f'(x_*))^2 } , \\label{eq : moment1 } \\\\ & { { \\rm{var}}}(x(t ) ) \\to \\frac{\\sigma(x_*)}{2n{\\left|{f'(x_*)}\\right| } } + \\frac{(f''(x_*))^2 \\sigma^2(x_*)}{8n^2(f'(x_*))^4 } + \\frac{(\\sigma'(x_*))^2}{16n^2(f'(x_*))^2 } , \\label{eq : moment2 } \\\\ & { \\mathbb{e}}[(x(t ) - { \\mathbb{e}}[x(t)])^3 ] \\to",
    "\\frac{(f''(x_*))^3 \\sigma(x_*)^3}{8n^3f'(x_*)^6 } + \\frac{3(\\sigma'(x_*))^2 f''(x _ * ) \\sigma(x_*)}{32 n^3 f'(x_*)^4}. \\label{eq : moment3}\\end{aligned}\\ ] ] this next approximation gives additional insight into our process for case 1 . in section [ sec : deterministic ] , we determined that once @xmath151 , there is one stable equilibria at @xmath152 .",
    "at this equilibrium , both strategies have the same proportions , but the sign of the centered third moment can give insight into which strategy has a slight advantage .",
    "for now , we will just determine the sign of the centered third moment .",
    "around the equilibria @xmath152 , equation simplifies to @xmath153)^3 ] = \\frac{(f''(x_0))^3}{64n^3f'(x_0)^6}\\ ] ] the sign of this only depends on the sign of @xmath154 . using the fact that @xmath155 we can factor @xmath154 as @xmath156    the sign of the skew is now easily found .",
    "@xmath157)^3 ] < 0 & { \\mathbb{e}}[(x - { \\mathbb{e}}[x])^3 ] > 0 \\\\ a < d & { \\mathbb{e}}[(x - { \\mathbb{e}}[x])^3 ] > 0 & { \\mathbb{e}}[(x - { \\mathbb{e}}[x])^3 ] < 0 \\end{array}\\ ] ]      setting the left - hand side of equation to 0 and using the reflecting boundary conditions , it is straightforward to find the stationary distribution for the diffusion approximation : @xmath158 where @xmath159 is a normalization constant and the * quasipotential * if the function @xmath160 . by differentiating equation   and neglecting the @xmath136 terms , one sees that for large @xmath1 , the maxima of the stationary distribution occur at the stable fixed points of the deterministic equation , while the minima of the stationary distribution occur at the unstable fixed points of the deterministic equation  .",
    "here we see to compute the mean first passage time ( mfpt ) from @xmath126 to @xmath161 using  .    to calculate the mfpt from @xmath126 to @xmath161 we restrict our attention to the interval @xmath162 $ ] and impose a reflecting boundary conditions at @xmath92 and absorbing boundary conditions at @xmath161 .",
    "let @xmath163 denote the first passage time ( fpt ) at which the system reached @xmath161 starting at @xmath24 and @xmath164 $ ] denote the mfpt from @xmath24 to @xmath161 .",
    "the mfpt satisfies @xmath165 where @xmath166 is the ( formal ) adjoint of the fokker  planck operator defined in  .",
    "this follows from the fact that @xmath167 is the generator of the diffusion process  @xcite .",
    "since the coefficients of the diffusion are known explicitly , we can obtain a formula for @xmath168 by quadrature and apply laplace s integral method ( see appendix  [ app : laplace ] for details ) to obtain @xmath169 notice in particular that this approximation is independent of @xmath24 as long as it is not too close to @xmath170 .",
    "thus we can think of the quantity @xmath128 as the mfpt for any initial condition starting in a neighborhood of @xmath126 to reach a neighborhood of @xmath161 .",
    "we can perform the same computation in the other direction to obtain @xmath171      we seek a quasistationary distribution of the master equation in the form @xmath172 if we plug this ansatz into the master equation  , taylor expand @xmath173 in powers of @xmath129 ( see appendix  [ app : wkb ] for details ) , and assume that @xmath174 , then we obtain two solutions for the wkb solution , called the relaxation and activation solutions : @xmath175 these solutions have a total of two free constants to be determined . performing a matched asymptotic expansion around the point @xmath170 ( again see appendix  [ app : wkb ] for details ) , we obtain the formula @xmath176 similarly , the mfpt from @xmath161 to @xmath126 is @xmath177      it is useful to compare the expressions   and  ; notice that the only difference is that there is a different quasipotential : @xmath125 for the diffusion approximation and @xmath132 for the wkb approximation .",
    "we repeat these here for comparison : @xmath178 now first notice that the only way in which @xmath179 appear in the timescale is through the difference of values at @xmath170 and @xmath126 , so in fact we are really concerned with the numbers we obtain when we evaluate these integrals from @xmath126 to @xmath170 .",
    "these integrands are certainly different functions and there is no reason why they should be close .",
    "however , let us write @xmath180 , and expand each integrand in a taylor series at @xmath181 : @xmath182    note that these expressions are equal up to the third order term in @xmath183 , and thus as long as @xmath184 and @xmath185 are close , then we expect these two integrals to be close .     for particular parameter values @xmath186 .",
    "the left frame shows the two functions on the same axis , and the right frame shows their difference.,title=\"fig : \" ]   for particular parameter values @xmath186 .",
    "the left frame shows the two functions on the same axis , and the right frame shows their difference.,title=\"fig : \" ]    in particular , we plot the two quasipotentials for the parameters @xmath186 in figure  [ fig : quasi ] . note that the two functions are indistinguishable except for near the ends of the domain .",
    "considering the difference on the interval @xmath187 $ ] , and we see that the difference between the functions is four orders of magnitude smaller than the functions themselves .",
    "now , of course , when @xmath64 , the quasipotentials are multiplied by @xmath1 and exponentiated , so that even a small difference in the quasipotential will make a huge difference asymptotically .",
    "however , we should note that both approximations are only expected to be accurate in the limit @xmath64 , and for any finite but large @xmath1 , the neglected terms in the expansion could dominate any difference in the quasipotentials .",
    "we actually see that this is so in the simulations presented below .",
    "this section compares the mean and variance of the simulations of the markov process to the mean and variance calculated from the linear - noise approximation in section [ sssec : vk ] .",
    "recall that the mean of the linear noise approximation is given by the deterministic equation  .",
    "figure  [ fig:4132mean ] compares the mean of the simulation of the markov process against the bifurcation diagrams determined in section  [ sec : deterministic ] .",
    "we see that the deterministic equation is a good approximation of the mean of the process .",
    "the only location of disagreement is for @xmath26 close to the bifurcation values .",
    "of course , as @xmath1 increases this will become more accurate .    ; in the right we have @xmath188.,title=\"fig:\",scaledwidth=49.0% ] ; in the right we have @xmath188.,title=\"fig:\",scaledwidth=49.0% ]    figure  [ fig:4132var ] compares the conditional variance of the markov process around each equilibrium point against equation  . for the purposes of the figures ,",
    "when there is only one equilibrium , we plot it on the @xmath126 figure . similar to the mean , the figures differ slightly once @xmath189 gets close to the bifurcation points .",
    "again this is due the size of @xmath1 .",
    "the mfpts calculated from both the sde approximation and wkb approximation differ in the prefactor and the form of the quasipotential .",
    "the mfpt calculated from the wkb approximation will more accurately capture the exponential time scale in which switching occurs in the limit as @xmath64 .",
    "however , in simulating both formulations we see they are indistinguishable .",
    "simulations can only be done for relatively small @xmath1 due to the exponential stiffness of the problem , and we see that for any accessible simulation , the relative error is indistinguishable .    to give us an idea of the accuracy of these approximations , we use a monte carlo simulation of the markov process : we averaged 1000 realizations of the markov process to calculate the mfpt from @xmath126 to @xmath161 . we know from both the sde approximation   and the wkb approximation   that these mfpts are exponentially large , which makes them hard to simulate using the markov process .",
    "we plot all of these in figure  [ fig : tm ] .",
    "as @xmath190 , the transition time becomes exponentially large , so the range of @xmath26 for which we can capture this transition time is quite restricted . in each row , we plot only those @xmath26 where we could perform a monte carlo simulation on the markov chain directly in the right column . in the left column",
    ", we extend the plotting region down to small @xmath26 .    for case 1.1",
    ", we were able to simulate the mfpt starting at @xmath191 .",
    "figure compares the mfpt from @xmath126 to @xmath161 of the simulation of the markov process ( along with the @xmath192 confidence interval ) to the mfpt approximated by the sde and wkb approximations . initially @xmath193 and @xmath194 are indistinguishable and both fall within the confidence interval of our simulated @xmath128 .",
    "as @xmath26 approaches the bifurcation point , @xmath193 and @xmath194 are still indistinguishable , but they no longer fall within the confidence interval of @xmath128 . this is due to the fact that @xmath193 and @xmath194 are good approximations when @xmath1 is large because the stationary distribution is sharply peaked around @xmath126 and @xmath161 .",
    "the simulations we ran use @xmath195 and as @xmath26 approaches the bifurcation point , the stationary distribution is not as sharply peaked , and we expect to need larger @xmath1 to make the asymptotics accurate .",
    "in this paper , we have studied a stochastic version of a standard game - theoretic model , concentrating on the case where there are multiple ess strategies and when the population is small enough that stochastic effects need to be taken into account .",
    "our dynamics also include a mutation parameter for offspring , and we prove that a large enough mutation factor always causes the multiple ess solutions to merge .",
    "the presence of noise due to a finite population turns each ess solution into a metastable solution , and we computed the asymptotics of the switching timescales between these .",
    "we were able to completely characterize the bifurcation diagrams for this model when the system is in the infinite population limit .",
    "we also were able to make two nonintuitive observations about the stochastic process :    1 .",
    "we see that the computation for the switching time using the diffusion approximation or the asymptotics directly on the master equation give essentially the same results : specifically , we see in figure  [ fig : tm ] that the two approximations are indistinguishable over a wide range of parameters .",
    "what is perhaps more surprising is that these two agree even when they are far away from the actual answer gotten from monte carlo simulations  these approximations are more like each other than the quantity that they are seeking to approximate . of course , the fact that these approximations deviate from the true value determined by monte carlo is not a contradiction , since these asymptotics are only guaranteed to be correct in the @xmath64 limit .",
    "we also see from the same figure that this limit is very non - uniform in system parameters , e.g. for fixed @xmath1 the approximation has a different level of effectiveness for different @xmath26 .",
    "we also see that the stochastic system gives a finer picture of the dynamics than the deterministic limit does . for example , consider cases where @xmath26 is small enough that the system has multiple ess states . in the deterministic regime ( @xmath196 )",
    ", we have multiple stable solutions that will persist for all time , and in particular , the long - term steady state behavior will depend strongly on the initial condition of the system . for large @xmath1",
    ", however , the system will spend most of its time near these two solutions , but will switch between the two on the timescales computed in section  [ sec : stochastic ] . of course , in general the switching timescales in each direction will be different ( often , significantly different ) so this allows us to understand which of the two solutions are `` more '' stable , and which solution we will expect to observe more often .",
    "we also saw in section  [ sec : perturbation ] that the stochastic dynamics have a bias even when the deterministic dynamics are symmetric , so that the finite - size effects can lead to a bias ; for example , the stochastic dynamics have a skew related to the self - interaction strength of each population .",
    "l. d. was supported by the national aeronautics and space administration ( nasa ) through the nasa astrobiology institute under cooperative agreement number nna13aa91a issued through the science mission directorate .",
    "m. g. acknowledges support from national science foundation grant dms 08 - 38434 `` emsw21-mctp : research experience for graduate students . ''",
    "wlch08    robert axelrod and william  donald hamilton , _ the evolution of cooperation _",
    ", science * 211 * ( 1981 ) , no .  4489 , 13901396 .",
    "hinrich arnoldt , marc timme , and stefan grosskinsky , _ frequency - dependent fitness induces multistability in coevolutionary dynamics _ ,",
    "journal of the royal society interface * 9 * ( 2012 ) , no .  77 , 33873396 .    robert axelrod , _ the evolution of cooperation _ , basic books , 1984 .",
    "robert  m. axelrod , _ the complexity of cooperation : agent - based models of competition and collaboration _ , princeton university press , 1997 .",
    "paul  c. bressloff , _ metastable states and quasicycles in a stochastic wilson - cowan model of neuronal population dynamics _",
    ", physical review e * 82 * ( 2010 ) , no .  5 , 051903 .",
    "to3em , _ stochastic processes in cell biology _ , vol .",
    "41 , springer , 2014 .",
    "james  f. crow , _ wright and fisher on inbreeding and random drift _ , genetics * 184 * ( 2010 ) , no .  3 , 609611 .",
    "r.w.r . darling and james  r. norris , _ differential equation approximations for markov chains _ , probability surveys * 5 * ( 2008 ) , 3779 .",
    "william feller , _",
    "diffusion processes in genetics _ , proc .",
    "second berkeley symp .",
    "prob , vol . 227 , 1951 , p.  246 .    ronald  a. fisher , _ the genetical theory of natural selection : a complete variorum edition",
    ", oxford university press , 1930 .    c.  w. gardiner , _ handbook of stochastic methods for physics , chemistry and the natural sciences _",
    ", third ed . , springer series in synergetics , vol .",
    "13 , springer - verlag , berlin , 2004 .",
    "mr mr2053476 ( 2004m:00008 )    nicholas guttenberg and nigel goldenfeld , _ cascade of complexity in evolving predator - prey dynamics _",
    ", physical review letters * 100 * ( 2008 ) , no .  5 , 058102 .",
    "lorens  a. imhof , drew fudenberg , and martin  a. nowak , _ tit - for - tat or win - stay , lose - shift ? _ , journal of theoretical biology * 247 * ( 2007 ) , no .  3 , 574580 .    thomas  g. kurtz , _ relationship between stochastic and deterministic models for chemical reactions _ ,",
    "journal of chemical physics * 57 * ( 1972 ) , no .  7 , 29762978 .    thomas  g. kurtz , _",
    "strong approximation theorems for density dependent markov chains _ , stochastic processes appl .",
    "* 6 * ( 1977/78 ) , no .  3 , 223240 .",
    "mr mr0464414 ( 57 # 4344 )    robert  m. may and warren  j. leonard , _ nonlinear aspects of competition between three species _ , siam journal on applied mathematics * 29 * ( 1975 ) , no .  2 , 243253 .",
    "patrick a.  p. moran , _ random processes in genetics _",
    ", mathematical proceedings of the cambridge philosophical society , vol .",
    "54 , cambridge univ press , 1958 , pp .  6071 .",
    "martin  a. nowak and robert  m. may , _ evolutionary games and spatial chaos _ , nature * 359 * ( 1992 ) , no .  6398 , 826829 .",
    "martin  a. nowak , _ evolutionary dynamics : exploring the equations of life _ , harvard university press , 2006 .",
    "to3em , _ five rules for the evolution of cooperation _",
    ", science * 314 * ( 2006 ) , no .  5805 , 15601563 .",
    "martin  a. nowak and karl sigmund , _",
    "tit for tat in heterogeneous populations _",
    ", nature * 355 * ( 1992 ) , no .  6357 , 250253 .",
    "to3em , _ evolution of indirect reciprocity _ , nature * 437 * ( 2005 ) , no .  7063 , 12911298 .",
    "john  maynard smith , _ evolution and the theory of games _ , cambridge university press , 1982 .",
    "adam shwartz and alan weiss , _ large deviations for performance analysis _ , chapman & hall , london , 1995 .",
    "christine taylor , drew fudenberg , akira sasaki , and martin  a nowak , _ evolutionary game dynamics in finite populations _",
    ", bulletin of mathematical biology * 66 * ( 2004 ) , no .  6 , 16211644 .    n.  g. van  kampen , _ the diffusion approximation for markov processes _ , de gruyter , 1982 .",
    "to3em , _ stochastic processes in physics and chemistry _ , vol .",
    "1 , elsevier , 1992 .    john von neumann and oskar morgenstern , _ theory of games and economic behavior _",
    ", oxford up , 1953 .",
    "jrgen  w weibull , _ evolutionary game theory _ , mit press , 1997 .",
    "wen - xu wang , jinhu l , guanrong chen , and pm  hui , _ phase transition and hysteresis loop in structured games with global updating _",
    ", physical review e * 77 * ( 2008 ) , no .  4 , 046109 .",
    "sewall wright , _ evolution in mendelian populations _ ,",
    "genetics * 16 * ( 1931 ) , no .  2 , 97 .",
    "the linear noise approximation developed by van kampen  @xcite assumes the system has linear noise and further expands the diffusion approximation to obtain the lowest order expansion .",
    "the linear - noise expansion allows us to easily calculate the moments of this approximation .",
    "we begin by assuming @xmath197 where @xmath144 is a fluctuation term and @xmath198 is not yet determined .",
    "making this change of variables in equation , requiring @xmath198 to satisfy @xmath199 ( deterministic equation ) and collecting only the @xmath200 terms gives @xmath201 + \\frac{1}{2 } \\sigma(\\phi(t ) ) \\frac{\\partial^2}{\\partial z^2}\\left[p(z , t ) \\right]\\ ] ] by multiplying equation by @xmath144 , integrating , and then integrating by parts the appropriate number of times , we find that @xmath144 is gaussian with moment equations , @xmath202 = f'(\\phi(t ) ) { \\mathbb{e}}[z]\\ ] ] and @xmath203 = 2 f^{\\prime}(\\phi(t ) ) { \\mathbb{e}}[z^2 ] + \\sigma(\\phi(t)).\\ ] ]    assuming that if the process runs long enough , the first and second moments will eventually be stationary , and noting that @xmath204 , we find @xmath205 = 0 , \\quad { \\mathbb{e}}[z^2 ] = -\\frac{\\sigma(x_*)}{2 f'(x_*)}.\\ ] ] where @xmath206 is an attracting fixed point of the deterministic equation . making a change of variable back to @xmath24 results in , @xmath207 = \\phi(t),\\quad { \\mathbb{e}}[x^2 ] = \\phi^2(t ) -\\frac{\\sigma(x_*)}{2 f'(x_*)}.\\ ] ]        we find higher order corrections to the moments of the linear noise approximation .",
    "we begin by assuming @xmath209 where @xmath210 . plugging the taylor expansion of @xmath211 and @xmath212 into the the sde and equating powers of @xmath213 , we obtain the following system of sdes which can be solved iteratively .",
    "@xmath214    equation   is the deterministic equation and therefore @xmath206 is an equilibrium of the deterministic equation . equations   and   are ornstein  uhlenbeck processes . using the well known solution to an ornstein  uhlenbeck process and the it isometry we can calculate the centered moments of equations   and   to obtain the first and second order corrections to moments calculated in the linear noise approximation : @xmath215 = x _ * + \\frac{f''(x_*)\\sigma(x_*)}{4n(f'(x_*))^2 } , \\label{eq : sdemoment1 } \\\\ & { { \\rm{var}}}(x ) = -\\frac{\\sigma(x_*)}{2nf'(x _ * ) } + \\frac{(f''(x_*))^2 \\sigma^2(x_*)}{8n^2(f'(x_*))^4 } + \\frac{(\\sigma'(x_*))^2}{16n^2(f'(x_*))^2 } , \\label{eq : sdemoment2 } \\\\ & { \\mathbb{e}}[(x - { \\mathbb{e}}[x])^3 ] = \\frac{(f''(x_*))^3 \\sigma(x_*)^3}{8n^3f'(x_*)^6 } + \\frac{3(\\sigma'(x_*))^2 f''(x _ * ) \\sigma(x_*)}{32 n^3 f'(x_*)^4}. \\label{eq : sdemoment3}\\end{aligned}\\ ] ]          equation   can be solved using integrating factors to find ( q.v .  ) , @xmath216 for large @xmath1 , @xmath217 is sharply peaked around @xmath126 and therefore @xmath218 is nearly constant @xmath219 $ ] for which @xmath220 is well above zero . with this assumption , equation   can be written as @xmath221 the first integral is sharply peaked around @xmath170 and the second integral is sharply peaked around @xmath126 . using a gaussian approximation ( that is , replacing @xmath222 with its second - order taylor expansion ) , and replacing the upper limits with any point strictly above @xmath170",
    ", we obtain the mfpt from @xmath126 to @xmath161 to be      the following @xmath200 and @xmath223 equations @xmath224 and @xmath225 the assumption that @xmath128 is large enough to not appear in these equations is not yet justified , but we show below that this is a self - consistent choice . solving   for @xmath226 gives two solutions : @xmath227 substituting each into the next order equation   and solving for @xmath228 gives @xmath229    we now seek to approximate @xmath128 in the quasistationary solution  .",
    "let us start with the ansatz that the wkb approximation takes the form of the activation solution on @xmath230 $ ] as the process tries to escape the basin of attraction around @xmath126 and takes the form of the relaxation solution on @xmath231 $ ] as the process is quickly attracted to @xmath161 .",
    "the relaxation and activation solutions need to satisfy the matching boundary conditions at @xmath170 , thus we match both to an appropriate inner solution at @xmath170 to find @xmath2 and @xmath3 .",
    "begin by rewriting the diffusion approximation as @xmath232 where @xmath233.\\ ] ]    substituting the quasistationary solution @xmath234 into equation   and taylor expanding around @xmath170 to order @xmath136 ( again assuming that @xmath235 ) results in the constant flux through @xmath170 , @xmath236 where we have used the fact that @xmath237 .",
    "it is straightforward to solve equation with an integrating factor to find the inner solution , @xmath238 where @xmath239 determines the size of the boundary layer . in order to match this inner solution with the activation and relaxation solutions , we use the following asymptotics of the inner solution : @xmath240    expanding the relaxation solution around @xmath170 and matching to the inner solution for @xmath241 gives @xmath242",
    ". expanding the activation solution around @xmath170 and matching to the inner solution for @xmath243 gives"
  ],
  "abstract_text": [
    "<S> we consider the moran process with two populations competing under an iterated prisoners dilemma in the presence of mutation , and concentrate on the case where there are multiple evolutionarily stable strategies . </S>",
    "<S> we perform a complete bifurcation analysis of the deterministic system which arises in the infinite population size . </S>",
    "<S> we also study the master equation and obtain asymptotics for the invariant distribution and metastable switching times for the stochastic process in the case of large but finite population . </S>",
    "<S> we also show that the stochastic system has asymmetries in the form of a skew for parameter values where the deterministic limit is symmetric . </S>"
  ]
}