{
  "article_text": [
    "the comparison and analysis of geometric shapes plays a central role in many applications .",
    "a particularly important class of shapes is the space of curves , which is used to model applied problems in medical imaging @xcite , object tracking @xcite , computer animation @xcite , speech recognition @xcite , biology @xcite , and many other fields @xcite .    in this article",
    "we consider the space @xmath0 of closed , regular ( or immersed ) curves in @xmath1 as well as some quotients of this space by reparametrizations and euclidean motions .",
    "these spaces of shapes are inherently nonlinear . to make standard methods of statistical analysis applicable",
    ", one can linearize the space locally around each shape .",
    "this can be achieved by introducing a riemannian structure , which describes both the global nonlinearity of the space as well as its local linearity . over the past decade",
    "riemannian shape analysis has become an active area of research in pure and applied mathematics . driven by applications ,",
    "a variety of different riemannian metrics has been used .    an important class of metrics",
    "are sobolev metrics .",
    "these metrics can be defined initially on the space @xmath0 and then induced on quotients of this space by requiring the projections to be riemannian submersions ( see def .",
    "[ def : sobolev_metric ] and thm .",
    "[ thm : quotient_metric ] ) .",
    "recently sobolev metrics of order two were shown to possess much nicer properties than metrics of lower order : the geodesic distance is non - degenerate , the geodesic equation is globally well - posed , any two curves in the same connected component can be connected by a minimizing geodesic , the metric completion consists of all @xmath2-immersions , and the metric extends to a strong riemannian metric on the metric completion @xcite .",
    "numerical methods for the statistical analysis of shapes under second order metrics are , however , still largely missing .",
    "this is in contrast to first order metrics , where isometries to simpler spaces led to explicit formulas for geodesics under many parameter configurations of the metric @xcite . for certain @xmath2-metrics",
    "an analogous approach was developed in @xcite .",
    "moreover , the geodesic boundary value problem under second order finsler metrics on the space of @xmath3-curves was implemented numerically in @xcite . for general second order sobolev metrics on spaces of unparametrized curves",
    "a numerical framework is , however , still lacking .",
    "this is the topic of this paper .",
    "we present a numerical implementation of the initial and boundary value problems for geodesics under second order sobolev metrics .",
    "our implementation is based on a discretization of the riemannian energy functional using b - splines . the boundary value problem for geodesics",
    "is solved by a standard minimization procedure on the set of discretized paths and the initial value problem by discrete geodesic calculus @xcite .",
    "our approach is general in that it allows to factor out reparametrizations and rigid transformations .",
    "moreover , it involves no restriction on the parameters of the metric and could be applied to other , higher - order metrics , as well .    in future",
    "work our framework could be applied to other spaces of mappings like manifold - valued curves , embedded surfaces , or more general spaces of immersions ( see @xcite for details and @xcite for a general overview ) .",
    "the space of smooth , regular curves with values in @xmath1 is @xmath4 where @xmath5 stands for _",
    "we call such curves parametrized to distinguish them from unparametrized curves defined in sect .  [",
    "sec : unparametrized ] .",
    "the space @xmath0 is an open subset of the frchet space @xmath6 and therefore can be considered as a frchet manifold .",
    "its tangent space @xmath7 at any curve @xmath8 is the vector space @xmath6 itself .",
    "we denote the euclidean inner product on @xmath1 by @xmath9 .",
    "differentiation is sometimes denoted using subscripts as in @xmath10 . moreover , for any fixed curve @xmath8 , we denote differentiation and integration with respect to arc length by @xmath11 and @xmath12 , respectively .",
    "a path of curves is a mapping @xmath13\\to\\imm(s^1,\\r^d)$ ] ; its velocity is denoted by @xmath14 .      in this article",
    "we study the following class of weak riemannian metrics on @xmath0 .",
    "[ def : sobolev_metric ] a _ second order sobolev metric with constant coefficients _ on @xmath0 is a weak riemannian metric of the form @xmath15 where @xmath16 , and @xmath17 are constants with @xmath18 and @xmath19 . if @xmath20 and @xmath21 it is a first order metric and if @xmath22 it is a zero order or @xmath23-metric .",
    "note that the symbols @xmath24 and @xmath25 hide the dependency of the riemannian metric on the base point @xmath8 .",
    "expressing derivatives in terms of @xmath26 instead of arc length , one has @xmath27    in the riemannian setting the length of a path @xmath28\\to\\imm(s^1,\\r^d)$ ] is defined as @xmath29 and the geodesic distance between two curves @xmath30 is the infimum of the lengths of all paths connecting these curves , i.e. , @xmath31 on finite - dimensional manifolds the topology induced by the geodesic distance coincides with the manifold topology by the hopf  rinow theorem . on infinite - dimensional manifolds with weak riemannian metrics",
    "this is not true anymore .",
    "for example , the geodesic distance induced by the @xmath23-metric on curves vanishes identically @xcite . on the other hand ,",
    "first and second order metrics overcome this degeneracy , as the following result of @xcite shows .",
    "the geodesic distance of first and second order metrics on @xmath0 separates points , i.e. , @xmath32 holds for all @xmath33 .",
    "geodesics are locally distance - minimizing paths .",
    "they can be described by a partial differential equation , called the geodesic equation .",
    "it is the first order condition for minima of the energy functional @xmath34 recently some local and global existence results for geodesics of sobolev metrics were shown in @xcite .",
    "we summarize them here since they provide the theoretical underpinnings for the numerical methods presented in this paper .",
    "[ thm : long_time ] the geodesic equation of second order metrics , written in terms of the momentum @xmath35 , is given by @xmath36 for any initial condition @xmath37 the geodesic equation has a unique solution , which exists for all time .",
    "in contrast , the geodesic equation of first order sobolev metrics is locally , but not globally , well - posed .",
    "is set to zero , whereas the parameter @xmath38 is increased by a factor 10 in the second , a factor 100 in the third , and a factor 1000 in the fourth column .",
    "the corresponding geodesic distances are @xmath39 , @xmath40 , @xmath41 and @xmath42 .",
    "note that since we also optimize over translations and rotations of the target curve , the position in space varies.,title=\"fig : \" ]   is set to zero , whereas the parameter @xmath38 is increased by a factor 10 in the second , a factor 100 in the third , and a factor 1000 in the fourth column .",
    "the corresponding geodesic distances are @xmath39 , @xmath40 , @xmath41 and @xmath42 .",
    "note that since we also optimize over translations and rotations of the target curve , the position in space varies.,title=\"fig : \" ]   is set to zero , whereas the parameter @xmath38 is increased by a factor 10 in the second , a factor 100 in the third , and a factor 1000 in the fourth column .",
    "the corresponding geodesic distances are @xmath39 , @xmath40 , @xmath41 and @xmath42 .",
    "note that since we also optimize over translations and rotations of the target curve , the position in space varies.,title=\"fig : \" ]   is set to zero , whereas the parameter @xmath38 is increased by a factor 10 in the second , a factor 100 in the third , and a factor 1000 in the fourth column .",
    "the corresponding geodesic distances are @xmath39 , @xmath40 , @xmath41 and @xmath42 .",
    "note that since we also optimize over translations and rotations of the target curve , the position in space varies.,title=\"fig : \" ]    for second order metrics it is possible to compute the metric completion of the space of smooth immersions .",
    "we introduce the banach manifold of sobolev immersions @xmath43 by the sobolev embedding theorem this space is well - defined and an open subset of the space of all @xmath44-immersions .",
    "it has been shown in @xcite that @xmath45 coincides with the metric completion of the space of smooth immersions :    [ thm : completenessimm ] the metric completion of the space @xmath0 endowed with a second order sobolev metric is @xmath45 .",
    "furthermore , any two two curves @xmath46 and @xmath47 in the same connected component of @xmath45 can be joined by a minimizing geodesic .      in many applications curves",
    "are considered equal if they differ only by their parametrization , i.e. , we identify the curves @xmath8 and @xmath48 , where @xmath49 is a reparametrization .",
    "the reparametrization group @xmath50 is the diffeomorphism group of the circle , @xmath51 which is an infinite - dimensional regular frchet lie group @xcite .",
    "reparametrizations act on curves by composition from the right , i.e. , @xmath52 is a reparametrization of @xmath8 .",
    "the space @xmath53 of unparametrized curves is the orbit space of this group action .",
    "this space is not a manifold ; it has singularities at any curve @xmath8 with nontrivial isotropy subgroup @xcite .",
    "we therefore restrict ourselves to the dense open subset @xmath54 of curves upon which @xmath50 acts freely and define @xmath55 this restriction , albeit important for theoretical reasons , has no influence on the practical applications of sobolev metrics , since @xmath56 is open and dense in @xmath57 .",
    "we have the following result concerning the manifold structure of the orbit space and the descending properties of sobolev metrics @xcite .",
    "[ thm : shape_space ] the space @xmath58 is a frchet manifold and the base space of the principal fibre bundle @xmath59 with structure group @xmath50 . a sobolev metric @xmath60 on @xmath61 induces a metric on @xmath56 such that the projection @xmath62 is a riemannian submersion .",
    "the induced riemannian metric on @xmath56 defines a geodesic distance , which can also be calculated using paths in @xmath63 connecting @xmath46 to the orbit @xmath64 , i.e. , for @xmath65 we have , @xmath66 to relate the geometries of @xmath67 and @xmath56 , one defines the vertical and horizontal subspaces of @xmath68 , @xmath69 as shown in @xcite they form a decomposition of @xmath68 , @xmath70 as a direct sum .",
    "more explicitly , @xmath71 with @xmath72 the unit tangent vector to @xmath8",
    ".    a geodesic @xmath8 on @xmath63 is called _ horizontal _ at @xmath73 , if @xmath74 .",
    "it can be shown that if @xmath8 is horizontal at @xmath75 , then it is horizontal at all @xmath73 .",
    "furthermore , geodesics on @xmath56 can be lifted to horizontal geodesics on @xmath61 and the lift is unique if we specify the initial position of the lift ; conversely , horizontal geodesics on @xmath67 project down to geodesics on @xmath56 .    what about long - time existence of geodesics on @xmath56 ? using the correspondence between geodesics on @xmath56 and horizontal geodesics on @xmath63 together with thm .",
    "[ thm : long_time ] we see that the horizontal lift of a geodesic can be extended for all times",
    ". however , it can leave the subset of free immersions and pass through curves with a non - trivial isotropy group .",
    "thus the space @xmath56 is not geodesically complete , but we can regain geodesic completeness if we allow geodesics to pass through @xmath57 .",
    "the space @xmath76 inherits some of the completeness properties of @xmath0 . to formulate these properties we introduce the group @xmath77 of @xmath2-diffeomorphisms and the corresponding shape space of sobolev immersions , @xmath78 it is not known whether this space is a smooth banach manifold , it is however a metric length space . the structure of it is explained in more detail in the article @xcite , where the following completeness result is proven .",
    "[ thm : quotient_metric ] let @xmath60 be a second order sobolev metric with constant coefficients .    1 .   the space @xmath79 , where @xmath80 is the quotient distance induced by @xmath81 , is a complete metric space , and it is the metric completion of @xmath82 .",
    "2 .   given two unparametrized curves @xmath83 in the same connected component",
    ", there exist @xmath84 with @xmath85 and @xmath86 , such that @xmath87 equivalently the infimum in @xmath88 is attained .",
    "the metric space @xmath79 is a length space and any two shapes in the same connected component can be joined by a minimizing geodesic .    in the last statement of the above theorem we have to understand a minimizing geodesic in the sense of metric spaces .",
    "curves modulo euclidean motions are a natural object of consideration in many applications .",
    "the euclidean motion group @xmath89 is the semi - direct product of the translation group @xmath1 and the rotation group @xmath90 .",
    "these groups act on @xmath0 by composition from the left .",
    "the metric is invariant under these group actions , @xmath91 as in the previous section we obtain an induced riemannian metric on the quotient space @xmath92 such that the projection @xmath93 is a riemannian submersion :    the space @xmath94 is a frchet manifold and the base space of the principal fibre bundle @xmath95 with structure group @xmath96 .",
    "a sobolev metric @xmath60 on @xmath61 induces a metric on @xmath94 such that the projection @xmath62 is a riemannian submersion .",
    "note that the left action of @xmath97 commutes with the right action of @xmath50 and hence the order of the quotient operations does not matter .",
    "the induced geodesic distance on the quotient space is given by the infimum @xmath98 with the infimum being taken over paths",
    "@xmath99 \\to \\on{imm}(s^1,\\r^d)$ ] .",
    "similarily as in the previous section geodesics on @xmath94 can be lifted to horizontal geodesics on @xmath61 and , conversely , horizontal geodesics on @xmath67 project down to geodesics on @xmath100 .",
    "thus the space @xmath94 inherits again some of the completeness properties of @xmath0 and we obtain the equivalent of thm .  [ thm : quotient_metric ] also for the space @xmath101 .",
    "in order to numerically compute geodesics , the infinite - dimensional space of curves must be discretized .",
    "the method we choose is standard : we construct an appropriate finite - dimensional function space and perform optimization therein .",
    "we choose b - splines among the many possible options because b - splines and their derivatives have piecewise polynomial representations and can be evaluated efficiently .",
    "this permits fast and simple computation of the energy functional and its derivatives .",
    "furthermore , in contrast to standard finite - element discretization , it is possible to control the global regularity of the functions . for details regarding b - splines , their definition , efficient computations , etc .",
    ", we refer to @xcite and the vast literature on the subject .    for simplicity",
    ", we shall work only with _",
    "simple _ b - splines , i.e. , splines where all interior knots have multiplicity one .",
    "hence the splines have maximal regularity at the knots .",
    "we will define splines of degrees @xmath102 and @xmath103 in the variables @xmath104 $ ] and @xmath105 $ ] , respectively .",
    "the corresponding numbers of control points are denoted by @xmath106 and @xmath107 . for @xmath73",
    "we use a uniform knot sequence on the interval @xmath108 $ ] with full multiplicity at the boundary knots : @xmath109 for @xmath110 we want the splines to be periodic on the interval @xmath111 $ ] .",
    "therefore we choose knots @xmath112 the corresponding normalized b - spline basis functions are denoted by @xmath113 and @xmath114 .",
    "note that all interior knots have multiplicity one , i.e. , the splines are simple .",
    "therefore , they have maximal regularity at the knots , @xmath115)\\ , , \\qquad c_j \\in c^{n_\\theta-1}(s^1)\\ , , \\qquad i=1,\\dots , n_t\\ , , \\qquad j=1,\\dots , n_\\theta\\,.\\end{aligned}\\ ] ] let @xmath116 denote the orthogonal projection from @xmath117)$ ] onto the span of the basis functions @xmath118 . similarly , let @xmath119 denote the orthogonal projection from @xmath120 onto the span of the basis functions @xmath121 .",
    "then @xmath122)}=0\\ , , \\qquad \\lim_{n_\\theta\\to\\infty } \\| \\mathcal s^{n_\\theta}_{n_\\theta } g - g\\|_{h^{n_\\theta}(s^1)}=0\\,,\\end{aligned}\\ ] ] holds for each @xmath123)$ ] and each @xmath124 .",
    "this is a well - known result on the approximation power of one - dimensional splines ( c.f .",
    "[ lem : onesplines ] ) ; a detailed analysis can be found in @xcite .",
    "the generalization of this statement to multiple dimensions involves tensor product splines and mixed - order sobolev spaces .",
    "tensor product splines are linear combinations of @xmath125 , where the basis functions @xmath118 are interpreted as functions of @xmath73 and @xmath121 as functions of @xmath26 . to be explicit ,",
    "a path of curves is represented as a tensor product b - spline with control points @xmath126 as follows : @xmath127 sobolev spaces of mixed order are hilbert spaces defined for each @xmath128 as @xmath129\\times s^1 ) = \\big\\ { f",
    "\\in l^2([0,1]\\times s^1 ) : \\exists f^{(k,0)},f^{(0,\\ell)},f^{(k,\\ell ) } \\in l^2([0,1]\\times s^1)\\big\\}\\,,\\\\ \\langle f , g \\rangle_{h^{k,\\ell } } =   \\langle f ,",
    "g\\rangle_{l^2 }   + \\langle f^{(k,0)},g^{(k,0)}\\rangle_{l^2 }   + \\langle f^{(0,\\ell)},g^{(0,\\ell)}\\rangle_{l^2 }   + \\langle f^{(k,\\ell)},g^{(k,\\ell)}\\rangle_{l^2 } \\ , .",
    "\\end{aligned}\\ ] ] function spaces of this type were first defined in @xcite .",
    "we refer to @xcite and @xcite for detailed expositions and further references .",
    "as before we define for each number of control points @xmath130 the spline approximation operator @xmath131 to be the orthogonal projection from @xmath132\\times s^1)$ ] onto the span of the tensor product splines @xmath125 .",
    "it can be shown that @xmath133 .",
    "[ lem : tensorspline ] for each @xmath134 and each @xmath135\\times s^1)$ ] , @xmath136\\times s^1 ) } = 0\\,.\\end{aligned}\\ ] ]    the lemma is proven in app .",
    "[ app : convergence ] by showing that @xmath132\\times s^1)$ ] is isometrically isomorphic to the hilbert space tensor product of @xmath117)$ ] and @xmath120 .",
    "the energy of a path of curves @xmath137\\times s^1\\to\\r^d$ ] is given by @xmath138 as can be seen by combining   and  . in the following let",
    "@xmath139 denote the set of all paths @xmath140\\times s^1;\\mathbb r^d)$ ] with nowhere vanishing spatial derivative , i.e. , @xmath141 holds for all @xmath142\\times s^1 $ ] .",
    "then @xmath139 is an open subset of @xmath143\\times s^1;\\mathbb r^d)$ ] because @xmath143\\times s^1;\\mathbb r^d)$ ] embeds continuously into @xmath144\\times s^1;\\mathbb r^d)$ ] by lem .",
    "[ lem : embedding ] .",
    "the following lemma shows that the energy of a spline tends to the energy of the approximated curve as the number of control points tends to infinity .",
    "[ lem : continuity ] if @xmath145 and @xmath146 , then @xmath147 holds for each @xmath148 .    by lem .",
    "[ lem : tensorspline ] the spline approximations @xmath149 converge to @xmath8 in @xmath143\\times s^1)$ ] . as @xmath139 is open , @xmath150 is well - defined for @xmath130 sufficiently large .",
    "the convergence @xmath151 follows from the @xmath152-continuity of the energy functional .",
    "to discretize the integrals in the definition of the energy functional we use gaussian quadrature with @xmath153 and @xmath154 quadrature points on each interval between consecutive knots .",
    "the total number of quadrature points is therefore @xmath155 in time and @xmath156 in space , and the discrete approximations of the lebesgue measures on @xmath108 $ ] and @xmath157 are @xmath158 where @xmath159 are the gaussian quadrature weights and @xmath160 the gaussian quadrature points .",
    "we define the discretized energy @xmath161 of a curve @xmath162\\times s^1)\\cap u$ ] to be given by the right - hand side of with @xmath163 replaced by @xmath164 .",
    "the following theorem shows that the discretized energy of a path tends to the energy of the approximated path as the number of control points go to infinity , provided that the path is smooth enough .",
    "if @xmath165 , @xmath166 , and @xmath167 , then @xmath168 holds for each @xmath169\\times s^1)$ ] .",
    "the total error can be decomposed into a spline approximation error and a quadrature error : @xmath170 converge to @xmath8 in @xmath171\\times s^1)$ ] by lem .",
    "[ lem : tensorspline ] .",
    "they also converge in @xmath172\\times s^1)$ ] by lem .",
    "[ lem : embedding ] .",
    "let @xmath173 denote the integrand in . then @xmath174 is locally lipschitz continuous when seen as a mapping from @xmath175\\times s^1)$ ] to @xmath176\\times s^1)$ ] .",
    "let @xmath177 denote the lipschitz constant of @xmath174 near @xmath8 .",
    "then the first summand in can be estimated for sufficiently large @xmath130 via @xmath178\\times s^1 ) } \\to 0\\ , .",
    "\\end{aligned}\\ ] ] it remains to show that the second summand in tends to zero .",
    "as the gaussian quadrature rules @xmath179 and @xmath180 are of order @xmath167 , there is @xmath181 such that the following estimates hold for all @xmath182)$ ] and @xmath183 : @xmath184}f(t)\\big(\\mu^{m_t}_{n_t}(\\mathrm dt)-\\mathrm dt\\big ) \\leq k n_t^{-1 } \\|f'\\|_{c([0,1])}\\ , , \\quad \\int_{s^1}g(\\theta)\\big(\\nu^{m_\\theta}_{n_\\theta}(\\mathrm d\\theta)-\\mathrm d\\theta\\big ) \\leq k n_\\theta^{-1 } \\|g'\\|_{c(s^1)}\\,.\\ ] ] see e.g. ( * ? ? ?",
    "4.3.1 ) for this well - known result .",
    "therefore , the second summand in satisfies @xmath185\\times s^1 ) }   + k",
    "n_\\theta^{-1}\\|\\partial_\\theta f(c)\\|_{c([0,1]\\times s^1 ) }   \\to 0\\ , . \\end{aligned}\\ ] ] this shows that the total error tends to zero as @xmath130 tend to infinity .                     to confirm this theoretical result , we run a series of numerical experiments to test the convergence of the discrete energy , whose results are displayed in fig .",
    "[ fig : con_energy ] .",
    "the set of basic curves that we will use throughout the whole section in all numerical experiments is displayed in fig .",
    "[ fig : basic_curves ] .     connecting the circle @xmath46 to the wrap @xmath47 . left : varying @xmath106 with fixed @xmath186 .",
    "right : varying @xmath187 and fixed @xmath188 .",
    ", title=\"fig:\",scaledwidth=49.0% ]    connecting the circle @xmath46 to the wrap @xmath47 . left : varying @xmath106 with fixed @xmath186 .",
    "right : varying @xmath187 and fixed @xmath188 .",
    ", title=\"fig:\",scaledwidth=49.0% ]      solving the geodesic boundary problem means , for given boundary curves @xmath46 and @xmath47 , to find a path @xmath8 which is a ( local ) minimum of the energy functional   among all paths with the given boundary curves . for existence of minimizers",
    "see theorem [ thm : completenessimm ] .",
    "we will assume that the curves @xmath189 are discretized , i.e. , given as linear combinations of the basis functions @xmath121 .",
    "should the curves be given in some other form , one would first approximate them by splines using a suitable approximation method .",
    "the choice of full multiplicity for the boundary knots ( in @xmath73 ) implies that the identity   for @xmath190 and a spline path @xmath8 becomes @xmath191 if the controls @xmath192 and @xmath193 are fixed , then defines a family of paths between between the boundary curves @xmath194 and @xmath195 . the family is indexed by the remaining control points @xmath196 .",
    "discretizing the energy functional as described in sect .",
    "[ sec : energyfunctional ] transforms the geodesic boundary value problem to the finite - dimensional optimization problem @xmath197 where @xmath198 denotes the discretized energy functional @xmath199 applied to the spline defined by the control points @xmath200 .",
    "this finite - dimensional minimization problem can be solved by conventional black - box methods , specifically we use matlab s ` fminunc ` function . to speed up the optimization we analytically calculated the gradient and hessian of the energy functional @xmath201 .",
    "we notice that @xmath202 the formulas for the derivative and the hessian are provided in app .",
    "[ sec : appendixenergyderivatives ] .     and",
    "@xmath23-distance @xmath203 , for the propeller shapes , as a function of increasing number of control points .",
    "the values of @xmath204 are @xmath205.,title=\"fig:\",scaledwidth=49.0% ]   and @xmath23-distance @xmath203 , for the propeller shapes , as a function of increasing number of control points .",
    "the values of @xmath204 are @xmath205.,title=\"fig:\",scaledwidth=49.0% ]     are 3- and 4-bladed propeller shapes , perturbed by a sinusoidal displacement in the normal direction of the curve .",
    "right : @xmath189 are corpus callosum shapes with the perturbation applied directly to the control points .",
    "the plots show the relative change in distance against the amplitude of the sinusoidal noise @xmath206 , i.e. , @xmath207 .",
    ", title=\"fig:\",scaledwidth=49.0% ]   are 3- and 4-bladed propeller shapes , perturbed by a sinusoidal displacement in the normal direction of the curve .",
    "right : @xmath189 are corpus callosum shapes with the perturbation applied directly to the control points .",
    "the plots show the relative change in distance against the amplitude of the sinusoidal noise @xmath206 , i.e. , @xmath207 .",
    ", title=\"fig:\",scaledwidth=49.0% ]    now we prove a result about @xmath208-convergence of the discrete energy functionals . before stating the theorem",
    ", we set up some notation . for brevity we denote the spline approximation operators in lemma [ lem : tensorspline ] by @xmath209 with @xmath210 , the space @xmath143\\times s^1;\\mathbb r^d)$ ] by @xmath152 , and the space @xmath211 by @xmath2 .",
    "fix @xmath212 and let @xmath213 denote the weakly closed subset of paths @xmath214 with @xmath215 and @xmath216 .",
    "we define the following discrete energy functionals on the set @xmath217 : @xmath218 in other words , @xmath219 equals @xmath220 , if @xmath8 is a spline path connecting the spline approximations @xmath221 , @xmath222 of @xmath46 , @xmath47 , and equals @xmath223 otherwise .",
    "we will show that the limit of these functionals as @xmath224 is @xmath225 our result is the following .",
    "let @xmath145 and @xmath146 .",
    "then the discretized energy functionals @xmath226 are equi - coercive on @xmath139 with respect to the weak @xmath152-topology and @xmath208-converge on @xmath139 with respect to the weak @xmath152-topology to the energy functional @xmath227 as @xmath228 .",
    "it follows that every sequence of minimizers of the discretized energy functionals @xmath226 has a subsequence that converges weakly to a minimizer of @xmath227 .",
    "we refer to ( * ? ? ?",
    "* definitions  4.1 and 7.6 ) for the concepts of equi - coercivity and @xmath208-convergence and to ( * ? ? ?",
    "* chapter  8) for @xmath208-convergence under weak topologies .",
    "first we show that the functionals @xmath226 are equi - coercive with respect to the weak topology on @xmath152 .",
    "this means that for each @xmath229 there is a weakly compact set @xmath230 such that for each @xmath231 , @xmath232 . to see this",
    "let @xmath229 and @xmath148 with @xmath233 .",
    "then @xmath234 and consequently @xmath235 . therefore , @xmath236 for all @xmath104 $ ] . by (",
    "3.5 and lem .  4.2 ) there exist constants @xmath237 such that @xmath238 and @xmath239 for all @xmath240 satisfying @xmath241 and all @xmath242 . since we have full multiplicity at the ends we have @xmath243 , by classical approximation results there exists a constant @xmath244 such that @xmath245 , where @xmath244 does not depend on @xmath107 .",
    "this allows us to estimate @xmath246 this shows that @xmath247 is contained in the set @xmath230 , defined as the closed ball of radius @xmath248 around the origin in @xmath152",
    ". since closed balls in hilbert spaces are weakly compact , the functionals @xmath226 are equi - coercive .",
    "equi - coercivity allows us to apply ( * ? ? ?",
    "8.16 ) , giving the following sequential characterization of @xmath208-convergence : the functionals @xmath226 @xmath208-converge to @xmath227 with respect to the weak @xmath152-topology , if @xmath249 to prove let @xmath250 in @xmath152 .",
    "first we consider the case @xmath251 .",
    "then @xmath252 .",
    "notice that @xmath253 always .",
    "it is shown in the proof of ( * ? ? ?",
    "* thm  5.2 ) that @xmath201 is sequentially weakly lower semicontinuous , so we obtain @xmath254 now if @xmath255 then @xmath256 for almost all @xmath231 , because the latter set is weakly closed .",
    "thus we have both @xmath257 and is satisfied .",
    "equation follows directly from lem .",
    "[ lem : continuity ] by choosing the sequence @xmath258 .",
    "thus , we have shown that the functionals @xmath226 are equi - coercive and @xmath208-converge to @xmath227 in the weak @xmath152 topology .",
    "the statement about the convergence of minimizers follows by applying ( * ? ? ?",
    "* thm .  7.23 ) .",
    "note that the result concerns the energy functional restricted to spline spaces , but evaluation of integrals is assumed to be exact . for the case where we approximate the integrals by gaussian quadrature , we were not able to prove a @xmath208-convergence result",
    ". however , in numerical experiments we still observe convergence for the solution of the boundary value problem , as can be seen in fig .",
    "[ fig : geodesicdistance_conv ] for varying numbers of control points .",
    "convergence holds for both the optimal energy and the @xmath23-norm of the minimizing paths . in fig .",
    "[ fig : continuity ] we show that the geodesic distance function is continuous : by adding a sinusoidal displacement in the normal direction to the curves , the geodesic distance converges to 0 as the noise becomes smaller .      to numerically solve the boundary value problem on the space of unparametrized curves",
    ", we first have to discretize the diffeomorphism group . by the identification of @xmath157 with",
    "@xmath259 $ ] , diffeomorphisms @xmath260 can be written as @xmath261 , where @xmath262 is a periodic function .",
    "periodic functions can be discretized as before using simple knot sequences with periodic boundary conditions .",
    "this leads to the spline representation @xmath263 here @xmath264 are b - splines of degree @xmath265 , defined on a uniform periodic knot sequence , @xmath266 are the control points of @xmath262 , i.e. , @xmath267 , and @xmath268 are the _ greville abscissas _ ,",
    "i.e. , control points of the identity represented in a b - spline basis , @xmath269 .",
    "is plotted against @xmath187 for different choices of @xmath270 .",
    ", title=\"fig:\",scaledwidth=49.0% ]    is plotted against @xmath187 for different choices of @xmath270 .",
    ", title=\"fig:\",scaledwidth=49.0% ]    the constraint that @xmath271 is a diffeomorphism is @xmath272 . by the fact that the b - spline basis functions are nonnegative and by the recursive formula for the derivatives of b - splines , see ( * ? ? ?",
    "* chap .  4 ) , a sufficient condition to ensure that @xmath272 is @xmath273 this is a linear inequality constraint .",
    "to speed up convergence , we introduce an additional variable @xmath274 representing constant shifts of the reparametrization .",
    "the resulting redundancy is eliminated by the constraint @xmath275 which ensures that the average shift of @xmath276 is 0 .",
    "we have to minimize the energy functional over all paths @xmath28 \\times [ 0,2\\pi ] \\to \\mathbb{r}^2 $ ] , and diffeomorphisms @xmath276 , subject to the constraints @xmath277 it is important to note that the reparametrization @xmath278 does not preserve splines : if @xmath47 and @xmath276 are represented by splines , then the function @xmath279 is in general not . to overcome this difficulty we approximate the reparameterized curve @xmath279 by a new spline in each optimization step",
    "this then leads to a finite - dimensional constrained minimization problem @xmath280 where @xmath281 are the controls used to construct the diffeomorphism @xmath276 and @xmath282 is the constant shift in the parametrization .",
    "similar to the unconstrained problem , we can analytically compute the gradient and hessian and then solve this by standard methods for constrained minimization problems , specifically we use matlab s ` fmincon ` function . in order to use ` fmincon ` we replace by @xmath283 with @xmath206 small .    from a mathematical point of view",
    "we would expect the geodesic distance between two shapes to be symmetric , i.e. , interchanging the curves @xmath46 and @xmath47 should have no effect on the resulting geodesic distance .",
    "this is , however , only approximately true numerically : in our numerical examples the relative error is below 5% if sufficiently many grid points are chosen , see fig .",
    "[ fig : symmetry ] .",
    "we want to point out that fig .",
    "[ fig : symmetry ] does not demonstrate convergence of the relative error to zero .",
    "indeed , our numerical experiments do not confirm this .",
    "this problem has not received sufficient attention in some of the previous literature ; in particular , @xcite seem to sidestep this question .",
    "an example of a forward and backward geodesic is plotted in fig .",
    "[ fig : symmetry_bvp ] .      to numerically solve the boundary value problem on shape space , it remains to discretize the finite - dimensional motion group .",
    "to simplify the presentation we will assume in the following that @xmath284 , so that we can parametrize rotations by the one - dimensional parameter @xmath285 .",
    "we have to add translations and rotations to the minimization problem , i.e. , minimize the energy functional over all paths @xmath28 \\times [ 0,2\\pi ] \\to \\mathbb{r}^2 $ ] , diffeomorphisms @xmath276 , rotations @xmath286 and translations @xmath287 , subject to the constraints @xmath288 note that rotations and translations preserve splines : if @xmath47 is represented by a spline then for any rotation @xmath286 and translations @xmath287 the function @xmath289 is a spline of the same type .",
    "this then leads to a finite - dimensional constrained minimization problem @xmath290 where @xmath281 are the controls used to construct the diffeomorphism @xmath276 , @xmath282 is the constant shift in the parametrization , @xmath285 the rotation angle and @xmath287 the translation vector .          to solve the geodesic initial value problem we use the variational discrete geodesic calculus developed in @xcite . for a discrete path @xmath291 , @xmath292",
    ", one defines the discrete energy @xmath293 where @xmath294 is an approximation of @xmath295 .",
    "since our riemannian metric @xmath60 is smooth , it approximates the squared distance sufficiently well in the sense that @xmath296 , and we can take the approximation to be @xmath297 we call @xmath291 a discrete geodesic if it is a minimizer of the discrete energy with fixed endpoints @xmath298 . to define the discrete exponential map we consider discrete paths @xmath299 consisting of three points .",
    "the discrete energy of such a path is @xmath300 given @xmath189 , we define @xmath301 if @xmath299 is a discrete geodesic , i.e. , if @xmath302 is such that @xmath303 .",
    "given an initial curve @xmath46 , an initial velocity @xmath304 , and a number @xmath305 of time steps , our solution of the geodesic initial value problem is @xmath306 , where the intermediate points @xmath307 are defined iteratively via @xmath308    to compute a discrete geodesic we need to find minima of the function @xmath309 , that is , we compute @xmath302 such that @xmath47 is a minimizer of @xmath309 .",
    "differentiating @xmath310 with respect to @xmath47 leads to the following system of nonlinear equations @xmath311 this system has to be solved for @xmath302 , with the argument replaced by all basis functions @xmath121 defining the spline space .",
    "we use the solver ` fsolve ` in matlab to solve this system of equations .",
    "some examples of discrete geodesics are depicted in fig .",
    "[ fig : hela_5pc ] .",
    "the discretizations of the geodesic initial and boundary value problems are compatible as demonstrated in fig .",
    "[ fig : compatible ] .    .",
    "on the left one computes @xmath312 for given @xmath313 and then solves the bvp for @xmath314 .",
    "the plot shows the relative distance @xmath315 agains @xmath106 . on the right one",
    "computes @xmath316 for given @xmath189 and plots the relative difference @xmath317 between two consecutive ( w.r.t .",
    "@xmath106 ) initial velocities @xmath318 against @xmath106 . , title=\"fig:\",scaledwidth=49.0% ] . on the left one computes @xmath312 for given @xmath313 and then solves the bvp for @xmath314",
    "the plot shows the relative distance @xmath315 agains @xmath106 . on the right one",
    "computes @xmath316 for given @xmath189 and plots the relative difference @xmath317 between two consecutive ( w.r.t .",
    "@xmath106 ) initial velocities @xmath318 against @xmath106 . , title=\"fig:\",scaledwidth=49.0% ]      the karcher mean @xmath319 of a set @xmath320 of curves is the minimizer of @xmath321 it can be calculated by a gradient descent on @xmath322 .",
    "letting @xmath323 denote the riemannian logarithm , the gradient of @xmath174 with respect to @xmath60 is @xcite @xmath324 fig .",
    "[ fig : propellermean ] illustrates the computation of the karcher mean of 8 propeller shapes , which have all been modified by adding a 10% uniform noise to their control points .",
    "we used second order metrics to characterize the nuclear shape variation in hela cells .",
    "the data consists of fluorescence microscope images of hela cell nuclei ( 87 images in total ) .",
    "the acquisition of the images is described in @xcite .    to extract the boundary of the nucleus",
    "we apply a thresholding method @xcite to obtain a binary image , and then we fit  using least squares  a spline with @xmath325 and @xmath326 to the longest @xmath327-connected component of the thresholded image .",
    "this provides a good balance between capturing shape details and not overfitting the image noise ; see fig .",
    "[ fig : hela_images ]",
    ". then we rescale all curves by the same factor to arrive at an average length @xmath328 . the choice @xmath328 has the following nice property : if a curve @xmath8 has @xmath329 and @xmath8 has a constant speed parametrization , then @xmath330 , and the arc length derivative @xmath331 coincides with the regular derivative @xmath332 . the scaling matters because the metric we work with is not scale invariant .",
    "had we decided to work with curves of a different average length we would have to change the constants @xmath333 of the metric in order to arrive at the same results .        for the subsequent analysis we use splines with @xmath334 and @xmath335 .",
    "the increased number of control points compared to the data acquisition allows us to preserve shape information even after reparametrizing the curves . to parametrize the diffeomorphism group we use splines with @xmath336 and @xmath337 .",
    "this leaves us with roughly @xmath338 degrees of freedom to represent the population of @xmath339 given shapes of cell nuclei .",
    "the influence of the number of control points on the geodesic bvp can be seen in fig .",
    "[ fig : hela_nth ] .",
    "all analysis is performed modulo translations , rotations , and reparametrizations .",
    "( left ) , unparametrized curves with @xmath325 ( middle ) and @xmath334 ( right).,scaledwidth=60.0% ]    the choice of constants @xmath340 , @xmath341 , and @xmath38 of the riemannian metric has a significant impact on the results ; see fig  [ fig : var_expl ] .",
    "one constant may be chosen freely , so we set @xmath342 . to simplify the interpretation of the results ,",
    "we set @xmath343 ; our metric shall have no @xmath344-part .",
    "this leaves us with one more parameter , which we choose by looking at the @xmath23- and @xmath2-contributions to the energy of geodesics between shapes in the dataset . for a geodesic @xmath8 between two curves @xmath46 and @xmath47 these contributions are @xmath345 the relative contribution of the @xmath2-term to the total energy is @xmath346 .",
    "we denote the population mean and standard deviation of the variable @xmath347 by @xmath348 and @xmath349 , respectively .",
    "the following table shows that the choices @xmath350 and @xmath351 both lead to balanced energy contributions of the zero and second order terms : @xmath352 we will use these parameter choices in our subsequent analysis . note that from a physical point of view the parameter @xmath38 has units @xmath353 $ ] , @xmath354 being meters .",
    "the average shape of the nucleus can be captured by the karcher mean @xmath355 . to solve the minimization problem for the karcher mean of the 87 nuclei we use a conjugate gradient method on the riemannian manifold of curves as implemented in the manopt library @xcite . for each choice of parameters",
    "the optimization is performed until the gradient of the objective function @xmath356 satisfies @xmath357 .",
    "having computed the mean @xmath355 , we represent each nuclear shape @xmath358 by the initial velocity @xmath359 of the minimal geodesic from @xmath355 to @xmath358 .",
    "we perform principal component analysis with respect to the inner product @xmath360 on the set of initial velocities @xmath361 .",
    "geodesics from the mean in the first five directions can be seen in fig .",
    "[ fig : hela_5pc ] .",
    "a projection of the dataset onto the subspace spanned by the first two principal components is depicted in fig .",
    "[ fig : hela_2d ] .    ; the mean is shown in bold .",
    "one can see characteristic deformations of the curve : expansion , stretching , compressing and bending .",
    "the first row shows principal components calculated for curves modulo reparametrizations ; the second row for parametrized curves.,title=\"fig:\",scaledwidth=80.0% ] + ; the mean is shown in bold .",
    "one can see characteristic deformations of the curve : expansion , stretching , compressing and bending .",
    "the first row shows principal components calculated for curves modulo reparametrizations ; the second row for parametrized curves.,title=\"fig:\",scaledwidth=80.0% ]        for unparametrized curves and for the parameter choice @xmath362 the first five principal components explain @xmath363 , @xmath364 , @xmath365 , @xmath366 and @xmath367 of the total variance ; see fig .",
    "[ fig : var_expl ] . under the choice @xmath368",
    "the first five principal components explain only @xmath369 of the variance as compared to @xmath367 in the previous case .",
    "this demonstrates that approximation power of the principal components depends on the choice of the metric .",
    "[ fig : var_expl ] also shows that fewer principal components are needed to explain the same amount of variance when the reparametrization group is factored out .",
    "the results we obtain are comparable to those of @xcite , where diffeomorphic matching was used to compare cells .",
    "it turns out that the mean shape with respect to our metrics is symmetric , while the mean shape obtained in @xcite is bent towards one side ; see fig .",
    "[ fig : var_expl ] .",
    "the hilbert space tensor product @xmath370)\\widehat\\otimes h^\\ell(s^1)$ ] is the completion of the algebraic tensor product @xmath370)\\otimes h^\\ell(s^1)$ ] with respect to the uniform cross norm @xmath371 ) } \\langle g_i , g_j\\rangle_{h^\\ell(s^1)}\\,.\\end{aligned}\\ ] ] the following result connects the mixed order sobolev space to a hilbert space tensor product .",
    "[ lem : tensor ] @xmath372\\times s^1)$ ] is isometrically isomorphic to @xmath370)\\widehat\\otimes h^\\ell(s^1)$ ] .",
    "a similar result for @xmath373 is shown in ( * ? ? ?",
    "our proof follows the lines of ( * ? ? ?",
    "* thm .  1.39 ) , where the result is shown for the case @xmath374 .",
    "each tensor @xmath375 ) \\otimes h^\\ell(s^1)$ ] defines a function @xmath376\\times s^1)$ ] , via @xmath377 .",
    "it is not hard to verify that @xmath378 is an isometric embedding of @xmath370 ) \\otimes h^\\ell(s^1)$ ] in @xmath372\\times s^1)$ ] , i.e. , @xmath379\\times s^1)}$ ] . to complete the proof ,",
    "we show that @xmath378 is onto .",
    "being an isometry , the range of @xmath378 is closed and so it suffices to show that its orthogonal complement is trivial in @xmath372\\times s^1)$ ] .",
    "let @xmath135\\times s^1)$ ] and suppose that @xmath380\\times s^1)}=0 $ ] for all @xmath381)$ ] and @xmath382 .",
    "let @xmath383 denote the function @xmath384 . then @xmath385 with @xmath386 .",
    "it follows that @xmath387\\times s^1 ) } = \\langle f,\\langle c , g\\rangle_{h^\\ell(s^1)}\\rangle_{h^k([0,1 ] ) } = 0\\,.\\end{aligned}\\ ] ] as @xmath262 is arbitrary , it follows that @xmath383 vanishes at almost every @xmath388 .",
    "similarly , since @xmath389 is arbitrary , @xmath8 vanishes at almost every @xmath390 . therefore , @xmath391 in @xmath372\\times s^1)$ ] .",
    "[ cor : simpletensors ] the multiplicatively decomposable functions @xmath392 with @xmath381)$ ] , @xmath382 , span a dense subspace of @xmath372\\times s^1)$ ] .",
    "this follows from the denseness of @xmath370)\\otimes h^\\ell(s^1)$ ] in @xmath370 ) \\operatorname{\\widehat \\otimes } h^\\ell(s^1)$ ] and lem .",
    "[ lem : tensor ] .",
    "the following lemma shows that the sobolev embedding theorem in one dimension extends to higher dimensions via tensor products .",
    "[ lem : embedding ] for each @xmath393 , the space @xmath394\\times s^1)$ ] is continuously embedded in the space @xmath395\\times s^1)$ ] .",
    "let @xmath396 be an orthonormal basis of @xmath397)$ ] and @xmath398 an orthonormal basis of @xmath399 .",
    "then @xmath400 is an orthonormal basis of @xmath397)\\widehat\\otimes h^{\\ell+1}(s^1)$ ] . by lem .",
    "[ lem : tensor ] this space is equal to @xmath394\\times s^1)$ ] .",
    "therefore , any element in this space can be expressed as @xmath401 for some @xmath402 . by the sobolev embedding theorem in one dimension there exists @xmath403 such that @xmath404)}^2 \\|g_j\\|_{h^{\\ell+1}(s^1)}^2 = c \\|c\\|_{h^{k+1,\\ell+1}([0,1]\\times s^1)}^2\\,.\\end{aligned}\\ ] ] similar estimates hold for lower derivatives of @xmath8 .",
    "this shows that the @xmath405-norm is bounded by the @xmath406-norm .    to prove lem .",
    "[ lem : tensorspline ] we need a result on the approximation power of one - dimensional splines .    [ lem : onesplines ] let @xmath407 $ ] or @xmath408 , @xmath409 with @xmath410 , and @xmath411",
    ". then @xmath412    the set of smooth functions in dense in @xmath413 .",
    "therefore , there is for each @xmath414 a function @xmath415 such that @xmath416 .",
    "if @xmath231 is sufficiently large , there is a spline @xmath417 of order @xmath418 defined on the uniform grid with @xmath231 points such that @xmath419 .",
    "this follows from ( * ? ? ?",
    "* cor .  6.26 ) . by the best approximation property of the orthogonal projection @xmath420 , @xmath421",
    "since @xmath206 was arbitrary , this shows that @xmath422 in @xmath423 as @xmath424 .",
    "collecting these results we are able to prove lem .",
    "[ lem : tensorspline ] .",
    "let @xmath425\\times s^1)$ ] and @xmath426 . by cor .",
    "[ cor : simpletensors ] there exist functions @xmath427)$ ] and @xmath428 , @xmath429 , such that @xmath430\\times s^1)}<\\ep/2\\,.\\ ] ] by lem .",
    "[ lem : onesplines ] and by the fact that the tensor norm is a reasonable cross norm ( i.e. , @xmath431\\times s^1)}\\leq \\| f_i \\|_{h^{k}([0,1])}\\| g_i \\|_{h^{\\ell}(s^1)}$ ] ) it is possible to choose @xmath106 and @xmath107 large enough such that @xmath432\\times s^1)}<\\ep/2\\,.\\ ] ] these two estimates and the best approximation property of the orthogonal projection @xmath433 yield @xmath434\\times s^1 ) } \\leq   \\left\\|c-\\sum_{i=1}^n \\mathcal s^{n_t}_{n_t}f_i \\otimes \\mathcal s^{n_\\theta}_{n_\\theta}g_i\\right\\|_{h^{k,\\ell}([0,1]\\times s^1 ) }   < \\ep\\,.\\qquad{\\color{header1}\\rule{1.5ex}{1.5ex}}\\ ] ]",
    "in this appendix we list the derivatives of the energy functional  .",
    "the first derivative is [ sec : appendixenergyderivatives ] @xmath435 with @xmath436 the hessian is @xmath437 with @xmath438      we thank peter michor , jens gravesen , hermann schichl , and the participants of the math on the rocks workshop in grundsund for helpful discussions and valuable comments .",
    "we are grateful to the anonymous referees for their careful reading of our manuscript .            ,",
    "_ second order elastic metrics on the shape space of curves _ , in proceedings of the 1st international workshop on differential geometry in computer vision for analysis of shapes , images and trajectories ( diff - cv 2015 ) , s.  k. h.  drira and p.  turaga , eds . , bmva press ,",
    "september 2015 , pp .  9.19.11 .",
    ", _ recent developments in the theory of function spaces with dominating mixed smoothness _ , in nonlinear analysis , function spaces and applications , institute of mathematics of the academy of sciences of the czech republic , 2007 , pp",
    ".  145204 ."
  ],
  "abstract_text": [
    "<S> statistical shape analysis can be done in a riemannian framework by endowing the set of shapes with a riemannian metric . </S>",
    "<S> sobolev metrics of order two and higher on shape spaces of parametrized or unparametrized curves have several desirable properties not present in lower order metrics , but their discretization is still largely missing . in this paper </S>",
    "<S> , we present algorithms to numerically solve the geodesic initial and boundary value problems for these metrics . </S>",
    "<S> the combination of these algorithms enables one to compute karcher means in a riemannian gradient - based optimization scheme and perform principal component analysis and clustering . </S>",
    "<S> our framework is sufficiently general to be applicable to a wide class of metrics . </S>",
    "<S> we demonstrate the effectiveness of our approach by analyzing a collection of shapes representing hela cell nuclei .    shape analysis , shape registration , sobolev metric , geodesics , karcher mean , b - splines    58b20 , 58e50 ( primary ) ; 49m25 , 68u05 ( secondary ) </S>"
  ]
}