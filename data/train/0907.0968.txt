{
  "article_text": [
    "magic are two imaging atmospheric cherenkov telescopes for gamma - ray astronomy located at the _ observatorio del roque de los muchachos _ ( european northern observatory , la palma island , spain ) .",
    "the production of a large amount of data during normal operation is inherent to the observational technique .",
    "the storage and processing of these data is a technical challenge which the magic collaboration has solved by profitting from infrastructures like those developed for lhc experiments . + during the last years , the magic groups at ifae and uab ( barcelona ) and ucm ( madrid ) have set up , in collaboration with pic , the magic data center .",
    "the facility became operational in february 2007 and , as of now , is equipped with the needed storage resources and computing capabilities to process the data from the first telescope and make them available to the magic collaboration .",
    "however , as magic ii is expected to start generating data this year , we expect the data volume to be increased by a factor of 3 with respect to the present single telescope situation . in consequence",
    ", we will increase the capabilities of the data center by providing it with the needed hardware and human resources to make it able to centralise the storage and analysis of the data .",
    "the main goals of this extension are to allow fast massive ( re-)processings of all stored data and to support data analysis for all magic collaborators .",
    "+ in what follows we will describe the present status of the data center and the foreseen upgrades required to deal with the data flow from the two - telescopes system .",
    "this will lead us to provide additional services useful for the collaboration and also for the astrophysical community .",
    "+    [ cols= \" < , > , > , > , > \" , ]",
    "the magic telescopes have in their focal plane a camera segmented into a number _ c _ of different pixels ( each equipped with a photo - multiplier ) , whose signals are digitized by the daq system  @xcite . currently , magic i is in service as a single telescope with a camera of 577 pixels .",
    "magic ii is under commissioning , and has an improved camera with 1039 pixels for regular operation plus 42 additional pixels equiped with experimental high quantum efficiency photodetectors for test purposes  @xcite@xcite .",
    "+ for every trigger , the single pixel signal is sampled _ s _ times .",
    "each sample is digitized with 12 bit precision and the resulting values stored in 2 byte fields .",
    "the information is then saved into a raw data file .",
    "the size of a magic raw event is given by _",
    "+ 2byte__@xmath0s@xmath0c _ _ , where _ h _ is a fixed - size ( 4.5 kbyte ) header describing the event .",
    "the event rate depends on the observation conditions and trigger configuration , and can range between 200 and 700 hz .",
    "the average event rate during observation periods 67 - 73 ( may - dec 2008 ) was 350hz .",
    "we will use this value to compute the data volume and storage needs summarized in table  [ tab : volume ] . + raw event files",
    "are processed using the magic standard analysis and reconstruction software ( mars )  @xcite .",
    "the first step is a program dubbed _ callisto _ , which calibrates the cherenkov pulse s intensity and arrival time , producing a so - called calib data file .",
    "this part of the analysis is the most cpu demanding , therefore calib data files are saved before further data processing .",
    "the rest of the analysis chain consists of a set of executables taking as input the output of the previous program in the chain : _ star _ computes the parameters describing the cherenkov images of the individual telescope  @xcite@xcite ; _ superstar _ merges the information of a given shower from the two telescopes ; and _ melibea _ computes the estimated energy , arrival direction and the so - called _ hadronness _ ( a parameter used for gamma / hadron discrimination  @xcite ) . the output from _ star _ and _ melibea _ will be referred to as different steps reduced data files , and is also stored permanently .",
    "+ estimations of the data volume at the different stages of the analysis chain , and for the different telescope configurations are also shown in table  [ tab : volume ] , the different phases of the standard analysis , the name of the standard programs and the input and output file formats are summarized in table  [ tab : analysis ] . + a diferent route is followed by the monte - carlo simulated events that are used for the estimation of the energy and _ hadronness_. in this case , instead of raw files , atmospheric particle showers are generated using corsika and then digested in two steps ( _ reflector _ and _ camera _ ) that finally produce data - like files that are calibrated and reduced with the same programs used for real data .",
    "the parameters of the detector simulation are adapted to the telescope performance in different observation periods and configurations .",
    "therefore , several versions of the monte - carlo library are provided at the data center .",
    "presently , the simulated events are generated at the infn padova and udine , and the resulting files require 10tbyte of disk space . +",
    "currently , the magic data center takes care of the following tasks :    * data transfer from la palma to pic , via internet and tapes * data storage on tapes and disk at pic * data access at all data processing levels ( raw , calib , reduced ) for all magic collaborators * real - time , automatic analysis of the data , processed with magic standard software * reanalysis of all stored data in case of software updates and bugfixes * magic data base * software repository and bug tracker * storage of the data quality control files    during normal data taking on the site , raw data are stored into disk , and later recorded to tape .",
    "the tapes are then sent from la palma to pic via airmail , since currently there is not enough internet bandwidth between the island and europe to support the transfer of the files .",
    "+ the computing system on the site also performs the so - called _ onsite _  @xcite analysis , by which raw data are processed , producing calib files and reduced files right after the data taking .",
    "these files are indeed transferred to pic via internet , together with some log files generated by the subsystems of the telescope . + currently , all tapes received at pic are downloaded to a buffer disk and then written back to tape grouped by source and observation night in a single file ( an _ iso volume _ ) that can be mounted as an external unit in the file system .",
    "this procedure is obsolete and recently has been found more optimal to store the files directly in tapes .",
    "+ the data are organized in a data base and served to the collaboration through a user interface machine and a web site . until late 2008",
    "these data were in a nfs file system , but currently , all data are being migrated to a new grid - based file system ( dcache ) that allows more transparent access ( in the sense of making no difference between tape and disk storage ) to any level of raw and processed data .",
    "it is planned that in july 2009 the nfs will be finally dismantled and all applications and data access will be based on grid .",
    "+ the reduction of the files that arrive via internet is triggered by scripts that run automatically every few minutes and notice when transfers have successfully finished . when this happens , batch jobs are generated and submitted to the grid with a specific configuration that ensures that they will run at pic ( the only computing element where mars is currently installed ) .",
    "this set of scripts can also be used to massively reprocess all the data stored at pic in case that a bug is found in the software or some improvement in the analysis makes it worth .",
    "massive operations of this kind have been performed twice in 2008 and once more in 2009 . for the last one",
    ", we have estimated that we used 115 days of cpu time in two weeks .",
    "this means that we have the capability to run _ star _ on one year of data in about 8 days .",
    "it is worth to mention that this peak processing rate would have never been achieved with just the minimum number of cpu cores that the magic project is granted at pic according to its share .",
    "in fact , we should always have access to at least 7 cores any time , but in periods of low usage from other experiments we have got up to 10 times these resources .",
    "+ finally the data center also provides a `` concurrent version server '' ( _ cvs _ ) for the software development and the daily check , which generates a daily report on the data quality and the telescope stability .",
    "in a near future we want to provide additional services to allow a more agile analysis by any magic collaborator and also easier access of anyone to published data . for this",
    "we intend to :    * extend the automatic data reduction up to _ melibea _ * provide resources and tools for high level analyses by any magic collaborator * open the magic public data to the whole scientific community by linking it to the european virtual observatory    currently , the high level analysis , starting from melibea , is carried out by analysers that select a mc - gamma sample and a real data sample fitting well the observational conditions of the analyzed data .",
    "these samples are used in the training of the multidimensional technique of selection of gamma - like events ( the random forest method  @xcite ) .",
    "we intend to automatize also this part of the analysis at pic in the near future , making the task of the analyzer simpler . + also",
    "the computing power of pic can be more widely exploited by opening the job submission to the rest of the collaboration .",
    "the already working roles of the grid scheme allow to assign priorities to the cpu farm users according to their duties , securing that the official data reduction is not delayed .",
    "+ finally , we intend to establish a link with the european virtual observatory in order to share potentially interesting data for the astrophysical community . for this purpose a software that will translate root information in the widely used format in astronomy - fits",
    "is currently being developed .",
    "the magic data center based at pic is already providing quality services to the magic collaboration , exploiting when possible the extra resources that a grid - based infrastructure implies .",
    "+ the success of the two year experience as official data center makes us push for the extension of the current facilities .",
    "we hope this will improve the access to the data by the magic analyzers , and will make it more transparent for interested astrophysicists outside the collaboration .",
    "+    99 albert , j. et al .",
    "instr . meth .",
    "a 594 ( 2008 ) 407 orito , r. et al .",
    "_ these proceedings _ borla , d. , goebel , f. et al .",
    "_ these proceedings _ moralejo , a. et al . , _",
    "these proceedings _ bretz , t. , wagner , r. , 2003 proc . of the 28th icrc ( tsukuba ) hillas , a. m. 1985 proc . of the 19th icrc ( la jolla )",
    "aliu , e. et al . ,",
    ". phys . 30 ( 2009 )",
    "293 albert , j. et al .",
    "meth . a 588",
    ", 424 ( 2008 ) oya i. et al . ,",
    "highlights of spanish astrophysics v cd - rom ( 2009 )"
  ],
  "abstract_text": [
    "<S> the magic i telescope produces currently around 100tbyte of raw data per year that is calibrated and reduced on - site at the observatorio del roque de los muchachos ( la palma ) . since february 2007 most of the data have been stored and further processed in the port dinformaci cientfica ( pic ) , barcelona . </S>",
    "<S> this facility , which supports the grid tier 1 center for lhc in spain , provides resources to give the entire magic collaboration access to the reduced telescope data . </S>",
    "<S> it is expected that the data volume will increase by a factor 3 after the start - up of the second telescope , magic ii . </S>",
    "<S> the project to improve the magic data center to meet these requirements is presented . </S>",
    "<S> in addition , we discuss the production of high level data products that will allow a more flexible analysis and will contribute to the international network of astronomical data ( european virtual observatory ) . for this purpose </S>",
    "<S> , we will have to develop a new software able to adapt the analysis process to different data taking conditions , such as different trigger configurations or mono / stereo telescope observations .    </S>",
    "<S> massive data processing , grid , european virtual observatory </S>"
  ]
}