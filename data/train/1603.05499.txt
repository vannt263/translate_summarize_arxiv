{
  "article_text": [
    "integral control , i.e.  adding a feedback term that is proportional to the time - integral of the deviation between actual and target values , is a basic disturbance rejection tool  @xcite .",
    "it lowers the sensitivity to low - frequency disturbances and in particular for a _ constant _ disturbance input , it allows the system to stabilize perfectly on the target value .",
    "integral control requires minimal knowledge about the system dynamics  just enough to tune the integral gain  and thereby is inherently robust to model uncertainties . on a nonlinear state space like the circle , the torus or the set of rotations",
    ", the definition of integral control must be revised .",
    "indeed , integration is canonically defined only for arguments belonging to vector spaces : the integral ( or even the sum ) of e.g.  different rotation matrices is not a standard defined thing . in general , when coordinates like the euler angles are used to describe the position on the nonlinear space , the result depends on the parametrization and can only be valid locally .",
    "whereas when the manifold is embedded in a vector space , i.e.  integrating component - wise the @xmath0 rotation matrices , the result does not belong to the original space .",
    "recently , in @xcite and @xcite , a canonical definition of integral control has been given for systems evolving _ on lie groups _ , to which the above examples belong .",
    "it consists in integrating the input command , instead of the output .",
    "indeed the inputs at different times usually belong to a tangent bundle , and thanks to lie group properties these can be mapped uniquely into a reference vector space  the lie algebra  to define integration in an inherent way .",
    "typically the input command contains something `` like proportional action '' , and integrating it gives rise to term precisely equivalent to the standard integral control for linear systems .",
    "the above papers establish the benefits of such integral control on lie groups for fully actuated systems ( number of inputs equals dimension of the lie group ) .",
    "they show that it perfectly rejects an input bias that is constant ( when mapped back to the lie algebra ) and give estimations of the basin of attraction of the target equilibrium , which for topological reasons on manifolds can mostly not be the full state space .",
    "the present paper considers two extensions of this framework with regard to its practical use .",
    "@xmath1 first , we rigorously establish robustness of this integral control on lie groups to a state - dependent bias .",
    "i.e.  if the disturbance to be rejected is constant in time at every point of the configuration space , but varies continuously from point to point in the configuration space ( e.g.  on the circle ) , then integral control can still perfectly reject it .",
    "this is not big news in the traditional linear setting , yet it is worth establishing for the lie group case as well .",
    "moreover it highlights the ability of integral control to reject the effect of _ unknown _ nonlinear plant dynamics on the steady state .",
    "this complements the control approach by cancellation of open - loop dynamics , which requires perfect plant knowledge.@xmath1 second , we investigate integral control on lie groups for so - called under - actuated or non - holonomic systems , i.e.  where the number of control inputs is strictly lower than the dimension of the lie group .",
    "we do this on a benchmark model , namely a vehicle under steering control @xcite .",
    "we propose a new viewpoint on the constant input bias in this case , and a related adaptation of integral control , for which we establish convergence properties .",
    "although our paper may suggest a framework towards a general solution , those results are still weaker than in the case of full actuation and a full treatment of under - actuated systems remains an open question at this point .",
    "+ the paper is organized as follows . in section",
    "[ sec : statedep ] we analyze the benefit of integral control for state - dependent bias . in section [ ssec : pendulum ] we apply this to the stabilization of the nonlinear pendulum at an arbitrary angle ; this is a problem of `` simple , robust '' control suggested to us by prof .",
    "r.sepulchre @xcite . in section [ sec : car ]",
    "we analyze the effect of a bias in translation velocity on the steering controlled vehicle .",
    "we observe that a problem appears only if the velocity _ direction _ is not correctly estimated . in section",
    "[ sec : car2 ] we propose and analyze an appropriate integral controller to mitigate this effect .",
    "let us first consider a linear system @xmath2 where @xmath3 is a constant input disturbance , and controlled with a pid controller @xmath4 .",
    "it is well - known that under appropriate stability conditions , the presence of the integral control term makes the system converge to @xmath5 despite the disturbance @xmath6 @xcite .",
    "it is maybe less known that this can still hold if @xmath7 depends on @xmath8 . indeed , if @xmath9 we have equivalently @xmath10 with @xmath11 .",
    "thus as long as the pid controller keeps @xmath12 stable as well , the system will converge perfectly to @xmath5 as with @xmath13 .",
    "this is especially interesting for practical control design , since state - dependent terms are harder to estimate with an observer than just constants , especially if one allows arbitrary forms of @xmath14 ( as we show still works ) .",
    "bias introduced by systematic model errors ( e.g.  due to linearization around non - exact solution ) is also countered by such integral action .",
    "this section reports on the analog property for integral control on lie groups .      for definiteness consider a simple second - order system : @xmath15 where @xmath16 is the position on the lie group @xmath17 ( think of a rotation matrix )",
    "; @xmath18 is the left - invariant translation from the tangent space at group identity , that is the lie algebra , to the tangent space at @xmath16 ; @xmath19 is the left - invariant velocity and belongs to the lie algebra ( think of a vector of rotation velocities , expressed in body frame ) ; @xmath20 is velocity damping for @xmath21 , or a term making the open - loop system unstable if @xmath22 ; @xmath23 is a control input and @xmath24 a bias on this input ( think of torques in the case of rotations , again expressed in body frame ) .",
    "the pid controller for this system , as introduced in e.g.  @xcite and @xcite , writes @xmath25 where @xmath26 are constant gains to be tuned .",
    "the function @xmath27 is some potential with a minimum at the target @xmath28 , and whose gradient is used as the equivalent of proportional action to push the system towards @xmath28 .",
    "finally @xmath29 is the integral _ of the other control inputs _ , which belong to the lie algebra i.e.  a vector space , unlike the error @xmath30 which belongs to the lie group and hence can not be integrated in a standard way .",
    "the novelty in this section is simply that we allow @xmath24 to depend on @xmath16 .",
    "we then get the following extension of our result in @xcite .",
    "* proposition 1 : * _ consider the system with pid controller . if the bias @xmath31 has a bounded gradient w.r.t .",
    "@xmath16 , then at least for @xmath32 and @xmath33 both large enough the configuration @xmath16 converges to the set of critical points of @xmath34 , with @xmath35 and @xmath36 .",
    "only the minima of @xmath34 are stable equilibria . _    _",
    "proof : _ consider the lyapunov function candidate @xmath37 its time derivative along trajectories writes @xmath38 where we have used the notation @xmath39 .",
    "taking @xmath40 and grouping terms , we get @xmath41 with @xmath42 the identity matrix .",
    "this is a form of the type @xmath43^t \\ ; \\left[\\begin{array}{cc}-a_1 i & a \\\\",
    "a^t & -a_2 i \\end{array}\\right ] \\ ; \\left[\\begin{array}{l } x\\\\ y \\end{array}\\right ] \\quad \\text { with } \\ ] ] @xmath44 , @xmath45 , @xmath46 and @xmath47 now any condition ensuring the matrix in to be negative definite would be sufficient to conclude our proof . to show that the controller can always be tuned in this way",
    ", we here derive ( loose ) bounds using the gershgorin disk theorem .",
    "let @xmath48 ( resp .",
    "@xmath49 ) be a bound on the sum of absolute values on any row ( resp .",
    "column ) of the matrix @xmath50 .",
    "then for gershgorin we need @xmath51 take any @xmath52 satisfying @xmath53 and @xmath54 . by adjusting @xmath55",
    ", we can make @xmath56 .",
    "then the first condition of is satisfied , and the second one is easy to satisfy with @xmath57 large enough . note that @xmath55 must be known exactly only to define the corresponding lyapunov function , not to tune the controller gains .    with these conditions",
    ", the matrix form is negative definite .",
    "hence @xmath58 is a true lyapunov function , that stops decreasing only when @xmath35 and @xmath59 . to keep these conditions invariant , as requested by the lasalle invariance principle",
    ", we see from that we need @xmath60 .",
    "thus the system converges towards the set of critical points of @xmath34 , with zero velocity and @xmath24 compensated by the integral controller .",
    "if there is a point @xmath61 in the neighborhood of @xmath62 where @xmath63 and @xmath64 , then we have @xmath65 and the system starting at @xmath61 , with decreasing @xmath58 , can never converge back to @xmath16 ; i.e.  the equilibrium is unstable as soon as @xmath16 is not a minimum of @xmath34 . @xmath66 + _ nota bene : _ the convergence towards the set of critical points of @xmath34 is the same as the basic result obtained without bias nor integral control . in that case already , it is unavoidable that some initial conditions , `` launched with the right speed and in the right direction '' , converge towards critical points that are not minima of @xmath34 ; but only the minima of @xmath34 are stable .",
    "the sets of initial conditions converging to the unstable equilibria however might differ in the `` bias and integral control '' case , with respect to the nominal case .",
    "the conditions on @xmath52 and @xmath57 are only sufficient . + for completeness , note that for a first - order system @xmath67 we have the following sufficient result .",
    "* proposition 2 : * _ denote @xmath68 a compact region of the state space containing a minimum @xmath28 of @xmath34 , for which @xmath69 is constant for all @xmath70 the boundary of @xmath68 , and where inside @xmath68 we have @xmath71 and @xmath72 positive definite .",
    "take @xmath73 sufficiently large such that @xmath74 remains positive definite inside @xmath68 , for all expected @xmath24 .",
    "for a set @xmath75 , select @xmath52 large enough such that @xmath76 for all expected @xmath24",
    ". then the system starting at any @xmath77 will never leave @xmath68 , and converge towards @xmath28 .",
    "_    the proof is based on the lyapunov function @xmath78 . a different lyapunov function might allow to weaken the conditions of the proposition .",
    "note that for stability of the corresponding linear system , a similar condition on the hessian would be _ necessary _ , whereas the sets @xmath79 can be all @xmath80 .",
    "the following problem was mentioned to us in @xcite as a stumbling point for standard passivity - based stabilization .",
    "consider the pendulum in a vertical plane whose motion is governed by @xmath81 where @xmath82 is the angular position of the pendulum , with @xmath83 pointing downwards ; @xmath84 is the ratio between gravitational acceleration and moment of inertia of the pendulum ; @xmath21 represents some friction ; and @xmath85 is the control torque , in appropriately normalized units .",
    "the task is to _ robustly _ stabilize the pendulum at some angle @xmath86 , despite the gravitational potential attracting it towards @xmath83 .",
    "due to the latter , proportional - derivative action is not enough .",
    "of course with perfect knowledge of the parameters one can easily reshape the gravitational potential to have a minimum at @xmath87 , but any error in parameters will then imply a mismatch in @xmath87 .",
    "we next show that with pid control , stabilization perfectly at @xmath87 can be achieved even with only approximate knowledge of the system parameters  in fact we only use bounds on @xmath84 and @xmath88 .    due to the fact that after moving by @xmath89 one is back at the original location , the circle is a nonlinear space , and in fact a lie group .",
    "this can be highlighted by defining @xmath90 , such that indeed @xmath91 is another point on the circle , @xmath83 corresponds to the identity for multiplication , and @xmath92 exists for all @xmath16 and satisfies all smoothness requirements .",
    "we can then further define @xmath93 and rewrite as : @xmath94 where we view @xmath95 as an undesired state - dependent bias .",
    "here we have just dropped the superscript @xmath96 and replaced @xmath97 by @xmath98 compared to the general notation .",
    "to stabilize @xmath87 we can select the potential @xmath99 whose only extrema are a minimum at @xmath87 and a maximum at @xmath100 . note that @xmath34 is equivalent to the gravitational potential , but turned as if the center of the earth was in the direction @xmath87 .",
    "proposition 1 then readily ensures that pid control , with appropriate tuning , will make the system converge to either @xmath101 or @xmath102 , of which only @xmath87 is stable .",
    "the tuning requirements only require the bound @xmath84 on @xmath103 , and possibly a bound on @xmath88 .",
    "figure [ fig1 ] shows a simulation of this example with initial conditions @xmath104 , perfectly stabilizing the state @xmath105 .",
    "admittedly , the circle is not the most challenging lie group .",
    "however , we believe that this example illustrates how also on nonlinear spaces , integral control can be a standard method to solve stabilization problems .",
    "consider a planar rigid body , with position @xmath106 and orientation given by a @xmath107 rotation matrix @xmath108 .",
    "the dynamics for its _ steering control _ writes @xcite : @xmath109 where @xmath110 is a @xmath111 rotation in the plane ; @xmath112 is the angular velocity , _ to be controlled _ ; and @xmath113 is the translation velocity expressed in body frame , _ which is fixed _ both in direction and in magnitude .",
    "the fixed direction of @xmath6 can be interpreted as a vehicle which can not translate sidewards .",
    "the fixed magnitude can be for technological simplification ( on - off motor , propulsion system ) or follow from floating constraints ( airplane , buoyancy - driven underwater vehicle ) .    in motion tracking of the non - holonomic vehicle , references @xmath114 and @xmath115",
    "are given which satisfy for some @xmath116 and the nominal @xmath6 , which we denote @xmath117 $ ] without loss of generality .",
    "for simplicity we consider @xmath118 constant , in which case the reference is moving at rate @xmath119 on a circle of radius @xmath120 .    *",
    "definition 1 : * _ we say that the vehicle follows the reference _ motion _ if and only if , in a frame that moves and turns with the reference , the position and orientation of the controlled vehicle are constant . in other words , the reference and the vehicle together form a virtual rigid body , of unimposed shape . for a reference with constant @xmath121 and a vehicle model perfectly matching the reference one , this means that the vehicle follows the same circular path as the reference , with a constant phase delay . _    we call this `` motion tracking '' to distinguish it from the traditional tracking problem , where the vehicle would have to reach the exact same position at time @xmath122 as the reference at time @xmath122 .",
    "the advantage of just motion tracking is that in fact the unimposed shape can be controlled independently by another controller @xcite .",
    "practical motivation for this is the possibility to independently optimize the shape of the virtual rigid body according to objectives like formation flying / navigation / platooning , or the carrying of a heavy rigid load by a team of vehicles .    to steer the vehicle towards motion tracking and stabilize it there",
    ", we can follow the geometric control design of @xcite .",
    "indeed , applying this motion coordination approach to the particular case of a network of two agents we get @xmath123 with @xmath124 where @xmath125 is a proportional gain .",
    "note that this controller follows as the vehicle measures @xmath126 its relative position to the reference , expressed in body frame , and @xmath127 its relative orientation with respect to the reference .",
    "if the vehicle perfectly fits the nominal model , with @xmath128 , then the results of @xcite imply that it will almost globally converge towards the reference motion .",
    "our goal here is to ensure similar tracking performance when @xmath129 is not perfectly known .    a central object in our analysis , as in @xcite , is the point @xmath130 this is the center of the circle around which the vehicle would rotate if it just applied @xmath131 from its current position and orientation .",
    "note that the exact @xmath132 is in fact unknown to the vehicle if it does not know its @xmath6 exactly .",
    "the convergence proof in @xcite is based on the distance between @xmath133 and the center @xmath134 of the reference circle .",
    "the combination of @xmath133 converging to @xmath134 and @xmath98 converging to @xmath119 , as the need for position correction @xmath135 asymptotically vanishes , eventually implies that the final behavior satisfies motion tracking .",
    "when @xmath136 differs from @xmath137 but is still parallel to it , the system with just the nominal controller in fact behaves very well .",
    "the proof is based on the same lyapunov function as for the nominal case .",
    "* proposition 3 : * _ consider the system with @xmath138 and steering control @xmath123 , where @xmath135 is defined by .",
    "then the vehicle will converge towards motion tracking of the reference .",
    "i.e.  it will rotate at rate @xmath119 on a circle of center @xmath134 , but of radius @xmath120 possibly different from the reference radius .",
    "_    _ proof : _ consider the candidate lyapunov function @xmath139 since @xmath134 is constant , when computing @xmath140 one only needs @xmath141 where we have used the fact that all planar rotations commute and @xmath142 . rewriting @xmath135 in terms of @xmath143 instead of @xmath144 , see , we get @xmath145 the last term drops when @xmath6 is parallel to @xmath146 . replacing this in yields @xmath147 now let us apply the lasalle invariance principle .",
    "the set characterized by @xmath148 is @xmath149 , where @xmath82 is the angle between the vectors @xmath150 and @xmath146 .",
    "the subset @xmath151 is invariant since @xmath152 implies @xmath153 from .",
    "on the other hand , starting from any point in the subset @xmath154 , we will have @xmath155 but @xmath156 belongs to the same plane as @xmath150 and @xmath146 , and it is orthogonal to @xmath150 .",
    "thus when @xmath157 and @xmath158 we have @xmath159 , such that a situation where @xmath160 can not be invariant .",
    "this concludes the proof .",
    "@xmath66 + proposition 3 thus implies that , even if the actual translation velocities of different vehicles are unknown , then just applying the same proportional feedback ensures that they will naturally converge towards circles of the same center , and of radii exactly matched such that they move as a rigid formation .",
    "we now investigate what happens under nominal control when @xmath6 is not parallel to @xmath146 , i.e.  there is some misalignment by a rotation @xmath161 in the constant propulsion direction of the vehicle .",
    "the ideal control would then simply apply after correcting the misalignment in the definition of the body frame of the vehicle , i.e.   @xmath162 from the previous section , a possible remaining difference in velocity magnitude has no detrimental effect .",
    "the difference @xmath163 can be viewed as a state - dependent actuation bias .",
    "simulations , see fig.[fig:2 ] , show that when @xmath135 is applied while @xmath164 , the center @xmath133 converges to a circular limit cycle around @xmath134 .",
    "moreover , @xmath98 converges towards a constant value @xmath165 with @xmath166 .",
    "this is another viewpoint about @xmath167 as an input bias on @xmath119 .",
    "although a proof of convergence towards this situation is beyond the scope of the present paper , we can easily compute the value of @xmath167 by examining the conditions for the equilibrium observed in simulations . note that the center around which the vehicle is turning is given by @xmath168 .",
    "constant rotation on a circle of fixed center @xmath169 requires @xmath170 and @xmath171 . expressing @xmath135 in terms of @xmath169 and @xmath134 instead of @xmath172 and imposing @xmath173",
    ", we get the condition @xmath174 solving this , we get @xmath175 one checks ( see captions ) that the solution with the plus sign fits the value observed in simulations .",
    "this is a somewhat strange and undesirable `` steady state '' , as the rotation speed is not the reference one and thus @xmath127 is time varying , as well as the position of the vehicle with respect to the reference",
    "! then the reference and following vehicle will not move at all like a rigid body . instead , in a frame attached to the reference",
    ", the follower will move on a circle of radius @xmath176 , thus periodically coming possibly very close and getting very far from the reference .",
    "in other words , the result of the bias is a small , constant but thus accumulating drift .",
    "this might be easily counteracted by the formation shape controller .",
    "our goal now however is to counteract this effect directly , without imposing a shape to the formation , by introducing appropriate integral action .",
    "we now consider the integral action to counteract the velocity misalignment . the difference @xmath177 induced by @xmath178 is equivalent to a state - dependent actuation bias , i.e.  we actually some @xmath179 ( here @xmath135 ) while we to apply some @xmath180 ( here @xmath181 ) .",
    "however , towards applying additional corrective actions , there is an important difference : in an input bias situation we @xmath180 , while here what we know is @xmath179 .",
    "this corresponds more to the effect of an _ output bias _ , e.g.  in a linear system : @xmath182 the presence of @xmath183 has an effect equivalent to a state - dependent input bias @xmath184 ; but what we can use for further feedback control , thus @xmath8 , is related to @xmath185 , thus the command _ including _ the bias .",
    "it turns out that an integral - like action _ does _ help reject the effect of this output bias , at least in the present application ( where it is equivalent to an actuation misalignment ) .",
    "we make two changes in the integral control .",
    "* we reverse the sign of integral control , such that the integral action does not reinforce but rather damp the effect of the actuation .",
    "this can be understood by remembering indeed that this actuation _ includes the bias_. * we integrate all input commands , including the integral correction itself : @xmath186    note that with this notation , as soon as @xmath187 , we have the desired situation @xmath188 ; all such situations are not necessarily invariant , and this is fortunate .",
    "indeed , to completely reach our target , we must also get to the correct circle center .",
    "the situation @xmath189 ( thus @xmath190 ) and @xmath191 is invariant",
    ". we can give the following convergence property towards it .",
    "* proposition 4 : * _ for any @xmath192 and any misalignment @xmath193 , there exist @xmath52 and @xmath73 small enough such that the target situation , with @xmath131 and @xmath189 , is locally asymptotically stable with controller . _",
    "_ proof : _ the system becomes simpler in a frame rotating at @xmath98 .",
    "hence we define @xmath194 and we get @xmath195 - \\omega q_{\\frac{\\pi}{2 } } x\\\\ \\tfrac{d}{dt } \\omega_i & = & \\left[k_p\\omega_0 \\mathbf{e}_1^t x - k_p \\mathbf{e}_1^t q_{\\frac{\\pi}{2 } } v - k_i \\omega_i \\right ] \\ , .\\end{aligned}\\ ] ] this system features an equilibrium at @xmath196 , @xmath197 .",
    "it is nonlinear only through the term @xmath198 , which close to the equilibrium linearizes to @xmath199 .",
    "the linearized system then has the characteristic polynomial @xmath200 which according to the routh - hurwitz criterion is positive for @xmath193 whenever @xmath201 for any given @xmath34 strictly inside @xmath202 the left hand sides are fixed positive constants , so it suffices to take @xmath52 and @xmath73 small enough on the right hand sides , to ensure that the linearized system is stable.@xmath66 + figure [ fig3 ] shows a simulation with the same parameters as on fig .",
    "[ fig:2 ] , but adding our integral control with @xmath203 .",
    "it confirms the improved behavior of the system .         _",
    "remark : _ from the presence of @xmath119 in , one clearly sees the key role played by the fact that in steady state the vehicle is rotating with a constant drift input , sufficiently fast with respect to the feedback .",
    "this makes the strategy look much like an averaging scheme .",
    "the aim of this paper is to revive the use of integral control to robustly reject biases on system dynamics .",
    "this idea has recently been formalized for constant biases on lie groups , and we provide two extensions .",
    "first , we show that a state - dependent bias can also be perfectly rejected .",
    "this makes a strong case for using integral control in systems where natural dynamics must be cancelled , complementing the often - used open - loop model - based cancellation .",
    "second , we treat a case of input bias on an underactuated system , namely steering control of a vehicle moving at constant speed . when the bias is on the speed magnitude , it seems to have no detrimental effect on keeping the vehicle in a formation with fellows .",
    "when the bias is on the direction however , it has an effect and must be compensated .",
    "we had to modify the integral controller to cope with this case , which in fact appears closer to a bias in the measurement output than in the control input .",
    "this last point suggests , for future research , to explore further links between systems with output bias and systems with underactuated input bias , to possibly solve one case with tools from the other .",
    "e.g.  one might want to investigate in which cases integral control can help to efficiently and simply reject an output bias .",
    "the conditions for local asymptotic stability ( proposition 4 ) are analog to those of averaging schemes , and in fact there is hope to prove global convergence using a combination of the exact local stability proved here , with an approximate but global trajectory characterization using the averaging theorems of nonlinear dynamical systems .",
    "this averaging behavior also gives indications as to how the integral controller is `` averaging out '' the bias , a viewpoint which might be useful for the design of other bias - rejecting controllers on nonlinear spaces .",
    "to conclude , we must note that velocity bias can not always be exactly compensated , see e.g.  our benchmark model with @xmath204 and a wrong magnitude of @xmath6 ; hence the full treatment of bias rejection for underactuated systems on lie groups remains an open question to our knowledge .",
    "this paper presents research results of the belgian network dysco ( dynamical systems , control , and optimization ) , funded by the interuniversity attraction poles programme , initiated by the belgian state , science policy office .",
    "the first author s visit to ghent university has been supported by a csc scholarship , initiated by the china scholarship council .",
    "the authors want to thank prof.r.sepulchre for suggesting the pendulum example ."
  ],
  "abstract_text": [
    "<S> this paper applies the recently developed framework for integral control on nonlinear spaces to two non - standard cases . </S>",
    "<S> first , we show that the property of perfect target stabilization in presence of actuation bias holds also if this bias is state dependent . </S>",
    "<S> this might not be surprising , but for practical purposes it provides an easy way to robustly cancel nonlinear dynamics of the uncontrolled plant . </S>",
    "<S> we specifically illustrate this for robust stabilization of a pendulum at arbitrary angle , a problem posed as non - trivial by some colleagues . </S>",
    "<S> second , as previous work has been restricted to systems with as many control inputs as configuration dimensions , we here provide results for integral control of a non - holonomic system . </S>",
    "<S> more precisely , we design robust steering control of a rigid body under velocity bias . </S>"
  ]
}