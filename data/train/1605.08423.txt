{
  "article_text": [
    "in the first section of this supporting information we provide the formal derivation of our iteration scheme . by means of an highly non trivial time discretization of the proposed langevin dynamics it is possible to sample the canonical distribution @xmath65 in an efficient way . as well known the integration of the langevin equation in eq.(1 ) of the manuscript is not univocally defined when the matrix @xmath0 is explicitly dependent on @xmath7 . in the following we use a pragmatic point of view and define a discretization of the langevin equation in a short time interval @xmath19 , by requiring that for @xmath38 the associated markov chain equilibrates to the canonical distribution .",
    "the usual discretization of eq.(1 ) , namely evaluated at discrete time @xmath66 , can be found in textbooks@xcite and has the rather involved expression @xmath67 where @xmath57 is the dimension of the real vector @xmath7 and @xmath68 if the covariant metric is used in the definition of the partition function : @xmath69 where @xmath70 stands for the determinant of the symmetric and real matrix @xmath0 . in",
    "the following we are interested to the canonical distribution , defined in the standard euclidean metric , and therefore we have to keep in mind in the following that @xmath71 , the forthcoming derivation being valid for any value of @xmath72 .",
    "the above markov chain defines a discretized master equation for the probability function @xmath73 , that in the limit @xmath38 becomes a fokker - planck equation of the following form :    @xmath74_j   p(\\vec r , t )   + t   \\sum\\limits_i \\left [   s^{-1}_{j , i}(\\vec r ) \\partial_i    \\right ]      p(x , t ) \\right\\}\\ ] ]    in order to find the equilibrium distribution it is enough to equate to zero the term between braces which immediately gives @xmath73 up to a constant , that is in turn is determined by the normalization condition of probabilities , yielding : @xmath75 namely the desired distribution .",
    "so far so good .",
    "unfortunately the markov chain of eq.([standard ] ) is not practical , because it contains the  cumbersome term  : @xmath76 indeed the calculation of the inverse of a matrix takes the order of @xmath77 operations , as well as , clearly each derivatives over any variable @xmath78 ( e.g. by the finite difference method ) . in order to make the summation over all @xmath78 for each @xmath79 in the above equation we end up with an algorithm scaling in most cases as the fourth power of @xmath57 , unless for particularly simple cases .",
    "moreover the expressions for the inverse derivatives become so much complicated that are very difficult to implement in practice , especially within the qmc approach .      before deriving the final convenient expression for sampling in the most efficient way the canonical distribution by the proposed accelerated langevin dynamics",
    ", we consider the following markov chain that does not require the evaluation of the  cumbersome term ",
    "@xmath80 : @xmath81   ( \\vec y -\\vec r )    \\nonumber \\\\",
    "\\langle z_i ( t ) z_j ( t ) \\rangle & = & s^{-1}_{i , j } ( \\vec r ) \\label{noisez}\\end{aligned}\\ ] ] where here @xmath82 and @xmath83",
    ". we will show in the following that the above markov chain implies the same fokker - planck equation ( [ fokker ] ) corresponding the much more involved discretization in eq.([standard ] ) and therefore the equilibrium distribution for @xmath84 will be the correct one . for any non zero @xmath19 we can use a very well established result of markov chains , that can be seen as an extension of the perron - frobenius theorem to non negative arbitrary matrices , and stating that , even in this case a unique equilibrium distribution is reached nearby ( @xmath85 ) to the desired one , even though the detailed balance condition for the conditional probability , i.e. @xmath86 , is not satisfied@xcite .",
    "this shows that it is possible to avoid the  cumbersome term ",
    ", with a minor computational effort , that in this case amounts to calculate the matrix @xmath0 two times for each time step .",
    "let s therefore proceed with the main proof of this section .",
    "the markov chain in eq.([noisez ] ) defines in a unique way the conditional probability density of having @xmath87 given @xmath88 : @xmath89   \\delta\\left\\ { \\vec r^\\prime - \\vec r -\\delta   s^{-1 } ( \\vec r ) \\vec f_{\\vec r }    -\\sqrt{2 t \\delta } \\vec z + { 1 \\over 2 } s^{-1}(\\vec r ) \\left [ s(\\vec y)- s ( \\vec r ) \\right ]   ( \\vec y -\\vec r ) \\right\\ }   \\over \\int dz^n \\exp\\left [ -{1 \\over 2 } ( z , s(\\vec r ) z ) \\right ]   } \\label{defk}\\ ] ] here and henceforth we denote by @xmath90 the scalar product of two @xmath91 dimensional real vectors .",
    "we want to obtain a fokker - planck equation in the limit of @xmath38 . to this purpose",
    "we write the master equation : @xmath92 and employ the integration in @xmath93 after substituting the expression of @xmath94 given above . for this purpose",
    "we solve the argument of the @xmath95 function , by replacing @xmath7 with @xmath96 when it is allowed at the leading order in @xmath19 : @xmath97   \\sqrt{2t\\delta } \\vec z+ o(\\delta)\\ ] ] and that : @xmath98 = ( 2 \\pi)^{n/2 } \\exp   \\left[-{1\\over 2 }   tr [ \\ln s(\\vec r ) ] \\right]\\ ] ]    we obtain therefore that the master equation for the evolution of the probability is explicitly given : @xmath99 p_n\\left(\\vec r(r^\\prime ) \\right )     \\over \\exp \\left[-{1\\over 2 }   tr [ \\ln s\\left(\\vec r(\\vec r^\\prime )   \\right ) ] \\right ] } \\ ] ] where @xmath100 is the jacobian of the transformation of eq.([transf ] ) , that can be expanded in @xmath19 with a well defined expression for @xmath101 that we do not explicitly write in the following , because , as we will see soon , it is not important for the derivation .    indeed , by substituting the transformation of eq.([transf ] ) in eq.([iter1 ] ) , and expanding the latter equation to the leading order in @xmath19 we obtain the following expression : @xmath102 p_n ( \\vec r^\\prime )    + \\int dz^n \\mu_{\\vec r^\\prime } ( \\vec z )   \\bigg\\ {      \\nonumber \\\\ & -&\\sum\\limits_j    \\left\\ { \\sqrt{2 t\\delta } z_j   + \\delta   \\left [ s^{-1}(\\vec r^\\prime )   \\left ( \\vec f_{\\vec x^\\prime }    -{s(\\vec r^\\prime+\\sqrt{2t\\delta } \\vec z)- s ( \\vec r^\\prime ) \\over 2 \\delta }   \\sqrt{2t\\delta } \\vec z \\right ) \\right]_j   \\right\\ }   \\partial_j p_n ( \\vec x^\\prime ) \\nonumber \\\\ & + & \\left . \\delta t   \\sum\\limits_{i , j } z_i z_j \\partial_i \\partial_j p_n(\\vec r^\\prime )   \\right\\ } + o(\\delta ) \\label{iterate}\\end{aligned}\\ ] ] where @xmath103 is the probability density for the random vector @xmath104 : @xmath105 \\right ]   \\right\\}\\ ] ] that is normalized because @xmath96 is given and does not dependent on @xmath104 .    in the above iteration in eq.([iterate ] ) there is therefore a term that simply multiplies @xmath106 by a function : @xmath107 where @xmath108 is rather involved and comes from the expansion in small @xmath19 of all the integrand in eq.([iter1 ] ) : @xmath109 notice that @xmath110 depends on the random variable @xmath104 via eq.([transf ] ) and therefore the term @xmath111 in the above equation is non trivial and different from @xmath112 by @xmath85 .",
    "we will not attempt to calculate this term , as well as @xmath113 , but derive it from the conservation of the normalization condition of the probability .",
    "the term that couples to the first derivative of @xmath114 reads : @xmath115_j \\partial_j p_n ( \\vec x^\\prime ) \\label{casino } \\\\ & -&\\int dz^n \\mu_{\\vec r^\\prime }   ( \\vec z ) \\sum\\limits_{i , j , k , l } ( 2 \\delta t ) z_j \\left [ { 1\\over 2 }   z_k \\left(\\partial_i s_{k , l } ( \\vec r^\\prime ) \\right ) z_l z_i   -{1\\over 2 } s^{-1}_{k , l } ( \\vec r^\\prime )   \\left(\\partial_i s_{kl } ( \\vec r^\\prime ) \\right ) z_i \\right ]   \\partial_j p_n ( \\vec x^\\prime )   \\label{secondall}\\end{aligned}\\ ] ]    in the above equations we have also used the following relation : @xmath116 & = & tr [ \\ln s(\\vec r^\\prime ) ]   -\\sum\\limits_i   tr [ s^{-1}(\\vec r^\\prime ) \\partial_i s(\\vec r^\\prime ) ]   \\sqrt{2 t\\delta } z_i + o(\\delta )   \\nonumber \\\\ & = & tr [ \\ln s(\\vec r^\\prime ) ] -\\sqrt{2 t\\delta }   \\sum\\limits_{i , k , l } s^{-1}_{kl } ( \\vec r^\\prime ) \\partial_i s_{kl } ( \\vec r^\\prime )   z_i + o(\\delta ) \\end{aligned}\\ ] ] coming from the expansion of @xmath117 , and in the last equation we have used that @xmath118 is symmetric because @xmath0 is symmetric . by carrying out the simple integration in @xmath119 , i.e. by replacing @xmath120 and @xmath121 and by applying the wick s theorem for the integration of the higher order polynomial involved , i.e. @xmath122 , we obtain that eq.([secondall ] ) reads : @xmath123 ( \\vec r^\\prime ) \\partial_j p_n ( \\vec r^\\prime ) & = & 2 \\delta t \\sum\\limits_{i , j } \\left(\\partial_i s^{-1}_{j , i}(\\vec r^\\prime)\\right ) \\partial_j p_n(\\vec r^\\prime ) \\nonumber \\\\ & = & 2 t \\delta",
    "\\sum_j \\gamma_j ( \\vec r ) \\partial_j p(\\vec r^\\prime)\\end{aligned}\\ ] ] where , by @xmath124_{ji}$ ] , we easily verify that the lhs and rhs of the above eq.([secondpartial ] ) are consistent , as , for instance , by using that @xmath0 is a symmetric matrix , we have that : @xmath125 thus this term partially cancels with the contribution coming from the expansion in small @xmath19 of the term @xmath126_{k , l } = \\sqrt{2 t\\delta } \\sum\\limits_i   \\partial_i s_{kl } ( \\vec r^\\prime )   z_i\\ ] ] indeed , in the fokker - planck equation , the term proportional to @xmath127 coming from the eq.([casino ] ) acquires a contribution : @xmath128 where in the last equality we have used the relation given in eq.([defsijder ] ) .",
    "thus the total term proportional to @xmath129 reads : @xmath130_j    + t \\delta   \\gamma_j ( \\vec r^\\prime ) \\right\\ }   \\partial_j p_n(\\vec r^\\prime)\\ ] ]    finally the term proportional to the second derivative leads to : @xmath131 - t \\sum\\limits_j \\left [ \\sum\\limits_i \\partial_i s^{-1}_{i , j } ( \\vec r^\\prime ) \\right ] \\partial_j p_n(\\vec r^\\prime ) \\nonumber \\\\     & = & t \\delta \\sum\\limits_i \\partial_i \\left [ s^{-1}_{ij}(\\vec r^{\\prime } )   \\partial_j   p_n ( \\vec r^\\prime)\\right ]   -t \\delta \\sum_j \\gamma_j ( \\vec r^\\prime ) \\partial_j p_n(\\vec r^\\prime)\\end{aligned}\\ ] ] by collecting all the terms obtained in eqs.([firstterm],[secondtotal],[thirdterm ] ) all the terms proportional to the ",
    "cumbersome one  @xmath132 cancel out and , by carrying out the limit @xmath38 we obtain the following fokker - planck equation : @xmath133_j   p(\\vec r , t )   + t   \\sum\\limits_i s^{-1}_{i , j } \\partial_i   p(\\vec r , t ) \\right\\ }    + \\bar c(\\vec r ) p(\\vec r)\\ ] ] where all the terms proportional to @xmath134 include @xmath135 and the ones that compensate the ones implied by the total divergence , namely @xmath136_j$ ] . in the above equation @xmath137",
    "has not been computed explicitly as it should simply vanish because it is determined by the standard property of the fokker - planck equation , namely that the rhs should be a total divergence , so that once integrated over all volume , it guarantees that the normalization of the probability is conserved for any initial probability guess , as a simple consequence that the conditional probability satisfies @xmath138^n k(\\vec r^\\prime| \\vec r ) = 1 $ ] for any @xmath19 and in particular in the limit @xmath38 .",
    "therefore we finally obtain the following focker - planck equation with @xmath139 : @xmath140_j   p(x , t )   + t   \\sum\\limits_i \\left [   s^{-1}_{j , i } \\partial_i    p(x , t)\\right ]      \\right\\}\\ ] ] that concludes the proof of this section .      the previous markov chain given in eq.([smartmarkov ] ) solves the problem of computing the  cumbersome term ",
    "@xmath80 at the expense of computing the matrix @xmath141 two times for each iteration . in the following we describe another way to obtain the same fokker - planck equation , with an iterative scheme requiring only one evaluation of the matrix @xmath141 .",
    "this is important in our implementation of the langevin dynamics , whenever the evaluation of the matrix @xmath141 requires most computational effort as in the present application based on quantum monte carlo . to this purpose",
    "the more convenient iteration scheme defines the new coordinates @xmath142 not only in terms of @xmath143 but also of the previous one @xmath144 .",
    "this remains formally a markov chain in an extended space acting on a @xmath145 dimensional vector @xmath146 $ ] , so that all the results of markov chains used in the previous section can be used .",
    "we propose therefore the following iteration scheme : @xmath147   \\left(\\vec r(t-\\delta ) -\\vec r(t)\\right )    \\nonumber \\\\",
    "\\langle z_i ( t ) z_j ( t ) \\rangle & = & s^{-1}_{i , j } ( \\vec r(t ) ) \\end{aligned}\\ ] ] the important thing is to show that , for @xmath148 and at the leading order , the previous iteration scheme is equivalent to the markov chain in eq.([noisez ] ) .",
    "this is evident by considering that , as in the previous case : @xmath149 therefore the  cumbersome term  in eq.([finaldyn ] ) comes naturally from simple taylor expansion : @xmath150   ( \\vec r(t-\\delta ) -\\vec r(t ) )   \\right\\}_k = 2 t \\delta \\sum_{i , l } \\left(\\partial_i s_{k , l}(\\vec r(t))\\right ) z_i(t-\\delta )   z_l(t-\\delta)\\simeq 2 t \\delta \\sum_{i , l }   \\left(\\partial_i s_{k , l}(\\vec r ) \\right ) z_i(t )   z_l(t)\\ ] ] thus the iteration scheme in eq.([finaldyn ] ) is equivalent to the following markov chain : @xmath151 strictly speaking the rightmost equality in eq.([cumber ] ) is valid for the associated fokker - planck equation where one can substitute the correlator @xmath152 with the one @xmath153 with an error @xmath85 .",
    "thus eq.([standardnew ] ) is in turn equivalent to the standard covariant iteration scheme defined in eq.([standard ] ) @xcite , that is indeed obtained by substituting : @xmath154 in eq.([standardnew ] ) , that does not change the fokker - planck equation , because this iteration scheme in eq.([standardnew ] ) coincides with the one we have considered in the previous section up to order @xmath85 and therefore should lead to the same fokker - planck equation for @xmath38 .",
    "suppose that the hessian matrix @xmath59 is proportional or almost proposrtional to the chosen matrix @xmath0 , so that @xmath155 is a good approximation .",
    "then , since @xmath156 , @xmath157 being the equilibrium position , one can assume that : @xmath158 where @xmath159 is an almost constant vector , as it depends only on the equilibrium position and the anharmonic terms .",
    "indeed , let us consider , for the time being , that we are in the harmonic case so that both @xmath0 and @xmath159 do not depend on @xmath7 , and eq.(1 ) in the text simplifies as follows : @xmath160 since the above eq .",
    "( [ above ] ) is now linear can be integrated exactly in the interval @xmath161 for arbitrary time dependency of the noise vector @xmath162 , yielding : @xmath163   \\left[\\vec c+ \\vec \\eta(\\tau ) \\right ] d\\tau \\nonumber \\\\    & = & \\tilde \\delta ( -\\alpha \\vec r + \\vec c )   + \\sqrt{2 t \\bar \\delta } \\vec z(t ) = \\tilde \\delta   s^{-1 } \\vec f ( \\vec r )    + \\sqrt{2 t \\bar \\delta } \\vec z(t )     \\label{eqsss }   \\\\ \\sqrt { 2 t \\bar \\delta } \\vec z(t ) & = & \\int\\limits_{t}^{t+\\delta } \\exp\\left[\\alpha ( \\tau - t-\\delta)\\right ] \\vec \\eta(\\tau ) \\nonumber \\\\",
    "\\tilde \\delta & = & { 1-\\exp(-\\alpha \\delta ) \\over \\alpha } \\nonumber \\\\\\end{aligned}\\ ] ] moreover , by using eq.([corrnoise ] ) one can derive the value of @xmath164 , because : @xmath165 \\exp [   ( \\tau^\\prime -t-\\delta ) \\alpha ]   s^{-1}_{ij } \\delta ( \\tau -\\tau^\\prime ) d\\tau d\\tau^\\prime = 2 t s^{-1}_{ij } \\int\\limits_t^{t+\\delta } \\exp [ 2 ( \\tau - t-\\delta ) \\alpha ] d \\tau\\ ] ] implying that : @xmath166    in the general case when also anharmonic terms are present and both @xmath0 and @xmath159 are explicitly dependent on @xmath7 it is useful to adopt the following choice that will match with eq.([eqsss ] ) in the harmonic case and therefore will be free of time step error if the potential energy surface is well approximated by an harmonic potential in the neighborhood of @xmath7 : @xmath167   \\left(\\vec r(t-\\delta ) -\\vec r(t)\\right ) \\right ] + \\sqrt{2 t \\bar \\delta } \\vec z ( t )    \\nonumber \\\\",
    "\\langle z_i ( t ) z_j ( t ) \\rangle & = & s^{-1}_{i , j } ( \\vec r(t ) ) \\end{aligned}\\ ] ] notice that we have used the discrete time step @xmath164 in the finite difference expression containing @xmath168 \\over \\bar \\delta}$ ] , because in the limit of @xmath169 this will restore the so called  cumbersome term  in eq.([e : cumber ] ) , with the correct prefactor . in the practical implementation the constant @xmath170 used in the hydrogen case , when using the covariance matrix for @xmath171 ,",
    "was set to : @xmath172 where @xmath173 is the number of qmc sampling used for each step of md , in order to evaluate stochastically the force components .",
    "the reason to scale the constant @xmath170 by the number of qmc sampling is because the hessian is not dependent obviously on @xmath173 whereas the covariance matrix , as it determines the squared stochastic fluctuations of the forces , has to decrease as @xmath174 , by the central limit theorem .",
    "in this qmc approach , we use @xmath175 , where @xmath176 is the correlation matrix corresponding to the statistical fluctuations -i.e .",
    "the error bars- of the nuclear forces . in this case",
    "it is also very simple to correct for the extra noise given by the qmc forces@xcite .",
    "this is achieved in a very simple way , just by changing the temperature @xmath4 used in the dynamics for the correct simulation at a given target temperature @xmath177 , simply as follows : @xmath178 that is possible for @xmath179 ( notice that for this particular choice of @xmath0 the time of the dynamics has the unusual dimension of an energy ) . in all simulations presented in this work ,",
    "this correction was always negligible , i.e. less than @xmath180 , which should represent an upper bound of our error in the equilibrium temperature . in this work",
    "we have not used this correction , because , for the time step used , this correction is negligible .",
    "we have tested this dynamics in a simple toy model , a rotating spring lying on a plane the endpoint @xmath181 is subject to a radial harmonic potential of the form @xmath182 while being free to rotate around the origin .",
    "the configuration s space visited during the dynamics is a circular ring , whose radius is @xmath183 and width given by the ( radial ) thermal fluctuation .",
    "this model is a prototypical example in which a strong decoupling of time scale , vibrational and rotational , is present .",
    "let us define the following matrix @xmath184 : @xmath185 where @xmath186 is control parameter , and @xmath187 reduces to the identity when @xmath188 .",
    "it can be shown , following geometrical considerations , that , if @xmath189 multiplies the forces , it effectively reduces by a factor @xmath186 the radial component of the associated displacement .",
    "we therefore use in @xmath190 in eq .",
    "[ standard ] , with @xmath191 and @xmath71 .            from fig .",
    "[ fig : toy ] we see that the preconditioned langevin dynamics , with non - trivial @xmath0 , results in a better time - step error , compared to the standard langevin dynamics .",
    "this demonstrate also in a simple toy model that a large computational gain can be achieved by this framework .",
    "we use two different choices for the matrix @xmath0 . in the first @xmath190 , while in the second @xmath192 , where @xmath59 is the hessian matrix . in both cases ,",
    "the correct equilibrium value is sampled in the @xmath193 limit .",
    "we also check the accuracy of the fast iteration scheme ( eq .  [ finaldyn ] ) , against the exact one , in which we explicitly evaluate the drift - diffusion term in eq .",
    "[ e : cumber ] .",
    "the fast implementation extrapolates to the exact value and the time step error is comparable to the one produced by the exact dynamics .    notice that , this term can be very important to sample the correct equilibrium distribution . indeed ,",
    "if we implement the simpler iteration rule @xmath194 then the sampled distribution is simply wrong .",
    "vs @xmath51 , for different temperatures : 900 , 1200 , 1500 and 1800 k the approximate discontinuity in the curves , as well as the @xmath195 s change , allows us to identify the dissociation transition . ]      here we report all the outcomes of the simulations used to draw the hydrogen phase diagram .",
    "in particular we demonstrate that the simulations are well equilibrated , and the results do not depend on the particular starting configuration ( atomic or molecular ) .    a notable exception is represented by the few simulations performed at the proximity of the phase transition . here , we can observe oscillations between the two phases within the same molecular dynamics run .",
    "this further demonstrate the ergodicity of the simulations .    in the following we plot the pressure as a function of the simulation time ( iterations ) .",
    "the results refer always to a 64-atom system ( see text ) .",
    "red ( green ) points correspond to a md which starting configuration is a molecular(atomic ) liquid .",
    "we see that , for fixed isotherm , at small densities ( larger @xmath196 ) , the md which start from the full atomic configuration is the one far from equilibrium .",
    "the opposite is true at larger densities ( smaller @xmath196 ) . near the phase transition ( intermediate @xmath196 )",
    "the two series meet halfway , although large oscillations are also present .",
    "notice for example the simulations at t=1800 k and @xmath1971.32 in fig .",
    "[ fig : p1800 ] , which displays phase oscillations which periods of the order of thousand iterations .     along the isotherm t=1800 k. red ( green ) points",
    "correspond to a md which starting configuration is a molecular(atomic ) liquid . ]      here we report the radial pair distribution functions @xmath195 for each isotherm , near the phase transition .",
    "the @xmath195 plot is useful to locate the phase boundary .",
    "we plot in red ( blue ) simulations which produce a molecular ( atomic ) liquid .",
    "we compute the @xmath195 discarding the initial equilibration steps .",
    "finite size errors are negligible due to the twist boundary conditions . indeed , in fig .",
    "[ fig : size ] we see that simulations using 64 and 128 atoms give essentially the same radial pair distribution functions .",
    "the estimated pressures in all cases is very similar , the 128 atoms simulations giving a pressure larger than @xmath44 10 gpa , compared to the 64 atoms ones .",
    "= 1.36 and 1.40 ) computed using n=128 ( red ) and 64 ( blue ) supercells .",
    "the finite size error is negligible in both cases . ]",
    "each simulation in this work was done by starting from two randomly generated configurations of atomic and molecular character at @xmath198 ( @xmath199 ) and @xmath200 ( @xmath201 ) for the @xmath202 ( @xmath203 ) proton case , respectively ( see the corresponding files in this supplementary information ) .",
    "for all the other @xmath196 values these configurations were simply scaled by a factor @xmath204 . the minimal basis used for the determinant",
    "consists of one contracted orbital per atom .",
    "this orbital is a linear combination of two gaussians @xmath205 and @xmath206 with : @xmath207 the coefficient @xmath208 of the linear combination @xmath209 is optimized on the fly during the run with all the other ( up to several thousands ) parameters .",
    "we have also used the gaussian exponents of a standard @xmath210 basis@xcite : @xmath211 in the standard basis , we have removed the gaussian corresponding to the largest exponent because in our approach the electron - nucleus cusp condition is properly taken into account by the presence of a one - body jastrow factor@xcite , that is also very useful for computing efficiently the matrix elements of the dft calculation on a finite mesh@xcite .",
    "notice that in this case we allow also a @xmath212 orbital of the standard gaussian type ( radial part @xmath213 ) . in order to minimize the number of parameters",
    "this basis was contracted using 2 geo atomic hybrid orbitals per atom@xcite , instead of the standard , but much less efficient , atomic contraction for the 1s orbital .",
    "this is sufficient for a target accuracy in the dft calculation of less than 0.5mh / atom , yielding a reduction of the number of parameters by a factor @xmath214 , as compared with the full uncontracted basis in the geminal expansion ( see later ) .",
    "the coefficients of the contraction ( @xmath215 independent parameters per atom ) are optimized during the simulation .",
    "this basis set is used with generic twisted boundary conditions : @xmath216 where @xmath217 is an integer vector and @xmath218 is the corresponding vector twist , whereas @xmath219 is the side of the cubic box .",
    "the above gaussian orbitals are modified in a way to satisfy the aforementioned boundary conditions with standard methods@xcite .",
    "the largest number of variational parameters involved in the calculation comes from the geminal expansion @xmath220 in a localized basis : @xmath221 all the @xmath222 matrix elements can be considered free variational complex parameters to be optimized , corresponding to @xmath223 real parameters where @xmath224 is the total single particle basis ( @xmath225 for the smallest basis set with @xmath202h , and @xmath226 with the @xmath227 basis or @xmath203h ) .",
    "@xmath228 or @xmath229 is already a too large number of parameters to be optimized efficiently within our statistical method . in the following we describe our strategy to reduce substantially ( by about an order of magnitude ) this number @xmath212 .",
    "the slater determinant can be described by a rank - deficient matrix @xmath222 with only @xmath230 non zero eigenvalues , where @xmath57 is the total number of electrons .",
    "the matrix @xmath186 can be assumed hermitian provided we adopt opposite twist vectors for opposite spin orbitals .",
    "this condition allows the reduction of the number of parameters by a factor two within our projection method for the optimization of the determinant@xcite .",
    "a further dramatic reduction of the number of parameters can be obtained in this approach by considering only variational parameters of the matrix @xmath222 connecting localized orbitals at a distance less or equal than @xmath231a.u . , and then projecting on the space of @xmath232rank - deficient matrices , as described in details in ref .. we have checked that this approximation leads to negligible errors in the total energy , even for metallic hydrogen .",
    "the bosonic jastrow term , @xmath233 , represents a compact way to take into account explicitly the electronic correlations since it depends directly on distances between electrons .",
    "there are many different choices for this factor ; in this work we have used a jastrow factor that accounts up to the 4-body interaction .",
    "the 1-body term is used to satisfy the nuclear - electron cusp condition .",
    "hence the total jastrow reads @xmath234    in all cases studied the jastrow basis is made of the same types of gaussians orbitals @xmath235 and @xmath236 but without contraction for the three - body part and periodized with the trivial substitution@xcite : @xmath237 when the electron - electron - ion - ion four - body part is used we contract this basis to one single orbital per atom only for this four - body term , whereas the full basis is used for the three body electro - electron - atom term , acting on two electrons around the same atom center .",
    "the exponent used is taken the same for both orbitals @xmath235 and @xmath236 , namely for the jastrow : @xmath238    in the following we provide the explicit functional forms of the jastrow terms .",
    "details can be found in ref .   and references therein .",
    "the term @xmath239 is a one electron interaction term which improves the electron - nucleus correlation and satisfies the nuclear cusp conditions .",
    "the exact functional form is given by @xmath240{2 z_a } ~r_{ia } ) ] + \\sum_a^m \\sum_{\\nu_a}^{l_a^j}\\sum_i^n f^a_{\\nu_a}\\phi_{\\nu_a}^a(r_{ia})\\ ] ] where the vector @xmath241 is the difference between the position of the nucleus a and the electron i , @xmath242 is the electronic charge of the nucleus @xmath183 , @xmath243 is the number of atomic orbitals @xmath244 that are used to describe the atom @xmath183 , @xmath245 are variational parameters and the function @xmath246 depends parametrically on the value of @xmath247 .",
    "the @xmath248 factor is an homogeneous two body interaction term .",
    "it depends only on the relative distance @xmath249 between pairs of electrons .",
    "the specific functional form reads @xmath250 where @xmath251 and @xmath252 is a variational parameter .",
    "finally the 3 body term is an inhomogeneous two electron interaction that depends also on the relative position of the electrons and the nucleus , i.e. it s an _ e - e - n _ interaction .",
    "its functional form is @xmath253\\ ] ] where @xmath254 are the uncontracted atomic orbitals centered on atom @xmath183 .",
    "notice that this is an _ on site _ interaction which is included as a particular case , namely @xmath255 in the following equation , of the more general 3 - 4-body @xmath256 interaction @xmath257.\\ ] ] in the genuine @xmath258body term @xmath259 ( with @xmath260 ) we have used a 1s basis per atom , after contraction of the 2s gaussian basis mentioned in the previous section .",
    "this allows the reduction of the number of variational parameter in an optimal way without significative loss of accuracy with respect to the full uncontracted 2s basis .      in this section",
    "we show the dispersion curve of the hydrogen molecule with the jastrow single slater determinant ansatzes used in this work ( with and without the 4-body jastrow factor discussed in the last section ) .",
    "we also report in fig.([fig : dimer ] ) the result of a jastrow ( 4-body ) single determinant antisymmetrized geminal product ( agp ) wavefunction@xcite , in the same basis , showing that , even with a minimal basis without diffusive orbitals ( p , d ) both in the jastrow and in the determinantal part , one can get an essentially exact description of the weak dispersive interaction in this molecule .                                                            v.",
    "e. fortov , r.  i. ilkaev , v.  a. arinin , v.  v. burtzev , v.  a. golubev , i.  l. iosilevskiy , v.  v. khrustalev , a.  l. mikhailov , m.  a. mochalov , v.  y. ternovoi , and m.  v. zhernokletov , physical review letters * 99 * , 185001 ( 2007 ) ."
  ],
  "abstract_text": [
    "<S> we propose an ab - initio molecular dynamics method , capable to reduce dramatically the autocorrelation time required for the simulation of classical and quantum particles at finite temperature . </S>",
    "<S> the method is based on an efficient implementation of a first order langevin dynamics modified by means of a suitable , position dependent acceleration matrix @xmath0 . here </S>",
    "<S> we apply this technique , within a quantum monte carlo ( qmc ) based wavefunction approach and within the born - oppheneimer approximation , for determining the phase diagram of high - pressure hydrogen with simulations much longer than the autocorrelation time . with the proposed method , we are able to equilibrate in few hundreds steps even close to the liquid - liquid phase transition ( llt ) . within our approach </S>",
    "<S> we find that the llt transition is consistent with recent density functionals predicting a much larger transition pressures when the long range dispersive forces are taken into account .    </S>",
    "<S> one of the most important problems in ab - initio molecular dynamics ( md ) is the coexistence of much different time scales underlying physical processes , even when computing equilibrium finite temperature properties . </S>",
    "<S> this has been a challenge for most ab - initio simulations in systems of biophysical interest , the most striking one being protein folding@xcite , where the microscopic time scale of molecular vibration is of the order of @xmath1 , while the macroscopic time scale of the folding exceeds the @xmath2 . </S>",
    "<S> also in water system simulations , the weak van der waals ( vdw ) interactions and the related hydrogen bond imply very difficult equilibration properties at ambient conditions , so that the most accurate simulations are based on force field fitting forces </S>",
    "<S> . we will show here that , a computationally expensive ab - initio method for dense liquid hydrogen can be combined with a sampling technique capable to reduce drastically the autocorrelation times . </S>",
    "<S> this method has the potential , due to its simplicity , to be applied with success also to much more complex systems and other ab - initio techniques .    at variance of all previous attempts@xcite </S>",
    "<S> , we propose that an optimal way to get rid of different time scales is based on the use of first order langevin dynamics : @xmath3 where @xmath4 is the temperature , @xmath5 and @xmath6 is an energy potential of the classical coordinates @xmath7 , e.g. atomic positions . </S>",
    "<S> for @xmath8 this is the conventional first order langevin dynamics ( cfold ) . preconditioned langevin equations , formally similar to eq .  </S>",
    "<S> [ basic ] , have been already introduced in several fields different from molecular dynamics , such as gauge field theories@xcite , statistics@xcite and machine learning@xcite , with different definitions of the preconditioning matrix @xmath0 . </S>",
    "<S> instead , the main idea of this work is based on the simple solution of cfold for the harmonic potential @xmath9 , where @xmath10 is the elastic matrix term . in this case one </S>",
    "<S> is able to show that the i ) the autocorrelation time is independent of temperature @xmath11 , where @xmath12(@xmath13 ) is the lowest ( largest ) non - zero eigenvalue of the elastic matrix ii ) for @xmath14 the corresponding discretized equation : @xmath15 is nothing but the steepest descent method for the optimization of the potential energy surface @xmath16 . </S>",
    "<S> thus the autocorrelation time depends just on how fast we are able to approach the minimum possible energy in an energy optimization .    at this point </S>",
    "<S> we have to consider that the steepest descent technique is very much limited by the very large condition number @xmath17 of the matrix @xmath10 . </S>",
    "<S> indeed the number of iterations to approach the minimum is of the order of @xmath18 , because the maximum time step @xmath19 , that can be used in this approach for a stable simulation , is of the order of @xmath20.@xcite    but why we have to be limited by the steepest descent ? </S>",
    "<S> it is well known that , in standard optimization techniques , much better methods exist , and in particular the newton method : @xmath21 is able to reach the minimum in _ one step _ for the harmonic case , regardless on how large the condition number is . in this case </S>",
    "<S> @xmath0 ( in eq.[basic ] ) is given by the hessian matrix @xmath22 , that is usually much heavy to compute . </S>",
    "<S> however it is clear that , by a reasonable choice of @xmath0 , not necessarily given by the hessian matrix , much better performances of the optimization can be achieved .    </S>",
    "<S> the key idea of this paper is already clear now . </S>",
    "<S> we assume that the autocorrelation time does not depend on @xmath4 , as it is implied by the solution of the harmonic case in eq.([basic ] ) . </S>",
    "<S> thus , in the general non harmonic case , at finite @xmath4 , by using a position dependent matrix @xmath0 related to the hessian one , the autocorrelation time - measured in simulation steps- can be drastically reduced from @xmath23 to @xmath24 , as discussed in ref . , whereas with the acceleration matrix @xmath25 it is possible to achieve in principle a much larger speed - up @xmath26 , even compared with standard second order md . ] in the corresponding discretized version of the ld . </S>",
    "<S> we adopt a quantum monte carlo approach@xcite , to perform ab - initio simulation of atoms at finite temperature @xmath4 , considered as classical particles interacting via the born - oppheneimer energy surface , obtained by a quantum mechanical variational optimization of a correlated electronic wavefunction containing several parameters : @xmath27 where the variational wavefunction is of the jastrow - slater type , @xmath28 indicates generically all the variational parameters , and @xmath29 is the full - many body electronic hamiltonian with coulomb interaction , at fixed atomic positions . since our method </S>",
    "<S> is not restricted to qmc we will not enter in the details of the wavefunction and the optimization methods , the interested reader can refer to our previous works.@xcite in qmc one of the most important matrix that we have found useful for the dynamics is the so called  covariance matrix  : @xmath30 where @xmath31 indicates a statistical average over a given number of samples at fixed atomic positions . </S>",
    "<S> this covariance matrix ( at variance of the hessian one ) is always positive definite , and empirically it has been shown , in several system cases , to be almost proportional to the hessian matrix@xcite , at least at the equilibrium structure , where the hessian is also positive definite . </S>",
    "<S> for this reason it is natural to take the covariance matrix for accelerating the ld within qmc , and we have assumed @xmath32 in the following . </S>",
    "<S> indeed it is possible to show that the direction @xmath33 represents just the one with maximum signal to noise ratio for the corresponding force energy derivative @xmath34 . </S>",
    "<S> this explains why it is more likely to find a lower energy in this direction , clearly suggesting its importance for qmc energy minimization . with this choice the eq.([basic ] ) is also covariant , namely independent of an arbitrary change of coordinates @xmath35 . that this represents a good choice is shown in a simple hydrogen system in fig .  </S>",
    "<S> [ fig : cov ] , where @xmath36 is rather large due to a weak molecular binding as opposed to the large molecular frequency of @xmath37 . within the present method </S>",
    "<S> the equilibrium positions of this difficult molecule are reached within a few dozens iterations , whereas it is not possible to approach the stable configuration with the standard steepest descent method .    at finite temperature </S>",
    "<S> the discretization of the langevin equation for a finite time step @xmath19 is highly non trivial , and defines a markov chain with unique equilibrium distribution . by requiring that , for @xmath38 , </S>",
    "<S> the equilibrium distribution is just the canonical one @xmath39 it is possible to show that ( see supplementary informations si ) the following iterative scheme : @xmath40   ( \\vec r(t-\\delta ) -\\vec r(t ) ) \\right\\ } \\nonumber \\\\ </S>",
    "<S> \\langle z_i ( t ) z_j ( t ) \\rangle & = & s^{-1}_{i , j } ( \\vec r(t ) ) \\end{aligned}\\ ] ] fulfills the equilibrium target .    </S>",
    "<S> we remark here that the main advantage of eq.([finaldyn ] ) is that it takes into account the explicit dependence of the matrix @xmath0 on the atomic positions @xmath7 , without using any cumbersome derivative of its inverse , as unavoidable in other methods@xcite , that are computationally much more expensive . </S>",
    "<S> this iteration scheme is not a markov chain as the positions @xmath7 at the next time @xmath41 depend not only on the actual time @xmath42 but also on the previous ones @xmath43 . </S>",
    "<S> however , in the limit of @xmath38 it can be shown that this convenient iteration scheme is equivalent to the much more complicated markov chain used in our previous work@xcite . in order to warm up with the capabilities of the method we show in fig .  </S>",
    "<S> [ fig : model ] its performances in a toy model where only two time scales are present ( vibrational and rotational ) . </S>",
    "<S> the clear advantages of the method are evident also when the acceleration matrix is not exactly equal to the hessian one ( see si for details ) . in this case </S>",
    "<S> we can accurately integrate the fast degrees of freedom while speed - up the sampling along the slowly varying direction . </S>",
    "<S> this property holds also in the more realistic case of liquid hydrogen , where we can accurately sample the intramolecular vibrations while accelerating the inter - molecular diffusion . </S>",
    "<S> ( see fig.[fig : cov ] ) .    </S>",
    "<S> * liquid - liquid transition in dense hydrogen . * </S>",
    "<S> extensive experimental as well as theoretical efforts have been devoted to understand the high pressure phase diagram of hydrogen , the simplest possible condensed matter system in nature . </S>",
    "<S> one among many open problems regarding the behavior of this compound at high pressures is finding atomization in the liquid sector of the phase diagram , i.e. the boundary between the molecular and the atomic liquid at higher pressures , which must have also metallic character .    until few years ago , all the few experimental observations@xcite located the insulator to metal transition ( imt ) , which provides a lower bound for the molecular to atomic transition , at pressures of @xmath44 140 gpa in the temperature range of 1500 - 3000 k. concurring numerical simulations@xcite , using both dft , with perdew - burke - ernzerhof ( pbe ) exchange - correlation functional@xcite , and qmc agreed with this value . in ref .   </S>",
    "<S> we observed instead the atomization at @xmath44 350 gpa and 2300 k and around 600 gpa at 600 k , with simulations of @xmath45 hydrogen atoms at the @xmath46 point . </S>",
    "<S> very recently , two new experiments have been performed to address conclusively this issue , but they provided two very different pictures . in the first , </S>",
    "<S> done by silvera and coworkers@xcite a first order imt in hydrogen in a pressure range which agrees quantitatively with previous experiments and simulations . </S>",
    "<S> this evidence has been qualitatively confirmed also by ref .  , although this experiment focus on larger temperatures . in a second experiment , </S>",
    "<S> knudson and coworkers@xcite observed the imt in deuterium at much larger pressures instead . </S>",
    "<S> their imt phase boundary line is almost vertical in the @xmath47 phase diagram and is located at around 300 gpa in a temperature range between 1200 and 1800 k. since the two experiments were performed at temperature as high as 1800 k , it is very unlikely that this huge difference is due to the enhanced zero - point motion of hydrogen compared to deuterium@xcite . </S>",
    "<S> we notice that this new transition pressure would be now much more in agreement with dft simulations using non - local exchange - correlation functionals@xcite such as the vdw - df1 and df2 , belonging to the vdw class of functionals , introduced in refs .  .    </S>",
    "<S> we apply this new framework to liquid hydrogen , using a carefully prepared simulation set - up . at variance of refs .  </S>",
    "<S> @xcite we take care of finite size - effects using a recently developed@xcite @xmath48 point sampling of the brillouin zone@xcite ( bz ) . in most simulations we use a cubic supercell containing 64 atoms and a 4@xmath494@xmath494 monkhorst and pack k - point mesh , which looks clearly consistent with larger systems calculations </S>",
    "<S> ( see fig . 8 in si ) . </S>",
    "<S> we perform simulations at fixed volumes and temperatures , from 900 to 1800 k. following ref .   </S>",
    "<S> we identify the transition density for each temperature by tracing the discontinuity in the @xmath50 vs @xmath51 equation of state as well as the jumps of the radial pair distribution function ( see si ) . in order to check the convergence of the md to the canonical equilibrium distribution , for each point of the phase diagram </S>",
    "<S> we start the nvt simulations , using two configurations , generated almost randomly , with molecular and atomic characters ( see si ) . </S>",
    "<S> away from the atomic - molecular coexistence region we were able to obtain consistent and statistically converged results with at most a few hundreds iterations . </S>",
    "<S> remarkably we have noticed that , close to the transition , the autocorrelation time increases substantially and the system can easily be trapped in a metastable phase for short simulations . our present method can give a meaningful speed - up in this case , but obviously does not solve the problem to cross easily a free energy barrier between two different phases , and this explains why several thousands iterations are required in the coexistence region . </S>",
    "<S> we notice , however , that for this problem several other methods are available , e.g. metadynamics@xcite , and they can be obviously combined with the present scheme . </S>",
    "<S> moreover we have found a meaningful dependence of the phase diagram on the number of optimization steps @xmath52 used to approach the bo energy surface . </S>",
    "<S> indeed we have observed that , even though the total energy converges very quickly with @xmath53 ( the choice in refs .  ) to the lowest variational energy , the ionic forces may require much more optimization steps and therefore the equilibrium distribution can significantly change even without an apparent improvement in the energy . in any event the convergence is exponential in @xmath52 and we have not observed any meaningful change after @xmath54 , thus reporting here the converged phase diagram for @xmath55 .    </S>",
    "<S> the phase boundary does not appear very sensitive to the quality of the trial wavefunction ( wf ) of the jastrow - slater type here employed . in this work we use two kinds of wfs , which have different jastrow factors . </S>",
    "<S> this part takes into account dynamical electronic correlations , and , depending on its explicit form , may represents less or more accurately the weak long range forces ( see si ) . in particular , in our scheme , </S>",
    "<S> the most accurate description is obtained when the jastrow operator contains also a 4 body ( 4b j ) electron - electron - ion - ion interaction , whereas a cheaper but less accurate description is given by using only a smaller ( 3b j ) factor containing only a three body electron - electron - ion correlation term .    </S>",
    "<S> our prediction for the phase transition is now much closer to the recent dft functionals with empirical dispersive forces , vdw - df1 and df2 , but remains at much larger pressures than other theoretical approaches@xcite , that are based on dft functionals without dispersive forces or on quantum monte carlo methods without md .    </S>",
    "<S> we notice that these results , at low temperatures , are compatible with our metallization prediction of ref .  </S>",
    "<S> , though the observed residual molecular fraction in the metallic phase , may be an artifact of the @xmath46 point bz - sampling . </S>",
    "<S> moreover , the effective inclusion of weak dispersion forces , by means of the 4b jastrow term , does not significantly change the transition pressure , though providing a lower internal energy of about @xmath56 both in the molecolar and the atomic phases . </S>",
    "<S> it is not the purpose of the present paper to resolve the present discrepancies between different approaches , but we nicely observe that the theoretical uncertainty is becoming smaller , in the very recent works ( including this one ) .    </S>",
    "<S> in conclusions we have proposed a general method of accelerating the present ab - initio md , that is simple enough and can be quite generally adopted in all ab - initio schemes , because the inversion of a matrix @xmath0 , whose leading dimension is the number of ion coordinates , represents just a negligible overhead in these cases , when @xmath57 is the electron number , and the solution of a linear problem is one of the fastest and efficient @xmath58 scaling algorithm , known in computer science . </S>",
    "<S> ] , and the computational gain , for suitable acceleration matrices , can be in principle of several orders of magnitude , proportional to @xmath23 . in our qmc based approach </S>",
    "<S> we have used an acceleration matrix related to the correlation of the noise in the vmc force components , namely the covariance matrix . </S>",
    "<S> in general we expect that considerable gains in efficiency can be obtained by using for @xmath0 the hessian matrix @xmath59 determined by accurate and cheap empirical potentials , at most corrected as @xmath60 with @xmath61 suitable chosen when @xmath59 is not positive definite for some atomic positions @xmath7 . in this work </S>",
    "<S> we have not exploited this possibility that could be in principle much better than our present choice , because @xmath0 does not need to be estimated stochastically ( see si for a simple model ) . </S>",
    "<S> this method can be easily extended to the quantum case by using the mapping of a finite temperature quantum simulation to an extended classical system@xcite .    </S>",
    "<S> we have applied this method to a topic of recent interest , by providing well converged results on the liquid - liquid phase transition , within the jastrow - slater variational ansatz , and found good agreement with a recent experiment ( at @xmath62 , see fig.[fig : phase])@xcite and dft results empirical dispersive forces functionals . </S>",
    "<S> the classical nuclei approximation here adopted may explain the residual difference compare to this experiment . </S>",
    "<S> in particular , we expect the slope of the transition line in the @xmath47 phase diagram to become more vertical including quantum nuclear effects , which become more important as the temperature decreases . </S>",
    "<S> this is a first simple application , where the problem of different time scales is not even particularly important ( @xmath63 ) and we expect much more dramatic speed up in polyatomic systems such as water , where the slow dynamics of the hydrogen bond network contrasts by several orders of magnitude the high frequencies vibrations of the water monomer ( @xmath64 ) . </S>",
    "<S> as this manuscript was prepared , an experimental study was published in ref .  , ruling out the possible first order phase transition at low pressures , and clearly supporting our simulations , as well as dft studies with non - local vdw functionals and the earlier experiments in ref .  , all predicting much higher liquid - liquid dissociation transition pressures in the range 250 - 300 gpa at @xmath44 2000 k. _ acknowledgments . </S>",
    "<S> _ we acknowledge very useful comments to the manuscript by m. ceriotti and m. parrinello . </S>",
    "<S> we also acknowledge a. zen for the calculation of @xmath23 in the water dimer . </S>",
    "<S> g.m . was supported by the european research council through erc advanced grant simcofe , and the swiss national science foundation through the national competence centers in research marvel and qsit . </S>",
    "<S> computational resources were provided by aics - riken and by cineca in bologna . </S>"
  ]
}