{
  "article_text": [
    "over the past decade the cosmic microwave background ( cmb ) anisotropy has been established as a robust and powerful cosmological probe .",
    "while much attention has focused on the primary anisotropy generated in the early universe , the cmb should also contain signatures of processes that occurred between the surface of last scatter and the present .",
    "one of these is weak gravitational lensing , which has been recognized as a probe of large scale structure ( lss ) . aside from its use as a probe of the matter power spectrum at low redshift @xmath2 , weak lensing of the cmb",
    "could be cross correlated against other tracers of the density field such as galaxy surveys @xcite or weak lensing of galaxies @xcite . through cross - correlation with the cmb temperature ,",
    "an improved measurement of the integrated sachs - wolfe effect over that possible using the cmb power spectrum alone is possible , yielding constraints on the late - time growth function and hence on the dark energy @xcite .",
    "lensing has also attracted attention recently as a cosmological source of @xmath0-mode polarization @xcite ; reconstruction and removal of lensing @xmath0-modes will thus be an important part of a future search for @xmath0-mode polarization induced by primordial gravitational waves @xcite .",
    "the lensing signal in the cmb is small , so it is important to construct optimal methods for estimating the lensing field from cmb data .",
    "the early investigations of lensing of the cmb temperature showed that while there is an effect of lensing on the cmb power spectrum @xcite , it is much more promising to estimate the lensing field using quadratic combinations of the cmb temperature , and to estimate the lensing power spectrum using the four - point correlation function ( or its harmonic equivalent , the trispectrum ) .",
    "more recent work has identified the divergence of the temperature - weighted gradient as the optimal quadratic combination of the cmb temperature for use in lensing studies @xcite .",
    "analysis based on likelihood techniques @xcite has since shown that the quadratic estimator technique is statistically optimal when the lensing effect on the cmb covariance matrix is small .",
    "this was shown to be a good approximation for lensing of temperature anisotropies in the range @xmath3 .",
    "for the small scales @xmath4 , the primary cmb power spectrum is much smaller than the lensed power spectrum , hence this argument breaks down . in this case for sufficiently small instrument noise the reconstruction of projected mass density can be nearly perfect @xcite .",
    "we will not discuss the reconstruction on these very small scales in this paper .",
    "our ability to reconstruct the lensing field using the cmb temperature is limited because the temperature fluctuations are stochastic and so we can only statistically determine the unlensed cmb temperature field .",
    "it is thus advantageous to consider lensing of the cmb polarization , since in the absence of primordial gravitational waves the unlensed cmb polarization is entirely in @xmath5 rather than @xmath0 modes .",
    "this implies that , in the terminology of galaxy lensing , there is no `` shape noise '' in the cmb polarization field .",
    "several authors have developed algorithms that use the @xmath0-modes induced by lensing to probe lss @xcite .",
    "the optimal quadratic estimator  the polarization analogue of the temperature - based quadratic estimator using the divergence of the temperature - weighted gradient  was constructed by ref .",
    "there it was shown that for sufficiently small detector noise most of the lensing reconstruction information with this method is provided by the @xmath0 mode .    even with polarization information these quadratic estimators",
    "can not improve the reconstruction beyond a certain level , set by the coherence length of the polarization .",
    "it has been argued that this provides a fundamental limit to our ability to separate the lensing induced @xmath0 modes from the @xmath0 modes induced by gravity waves @xcite .",
    "however , it has not been determined whether quadratic estimation is optimal for the polarization - based lensing reconstruction , and indeed refs .",
    "@xcite comment that it might be possible to extract additional information in higher - order statistics .",
    "the argument for optimality of the quadratic estimator presented by ref .",
    "@xcite does not apply to polarization since the @xmath0-mode power is dramatically increased by lensing . here",
    "we construct likelihood - based estimators for lensing using the cmb polarization and show that the likelihood - based estimator improves significantly on the quadratic estimator ( although we do not present these as series of higher - order statistics ) .",
    "indeed , as noise is decreased the accuracy of cmb lensing reconstruction continues to improve without bound .",
    "conceptually this is because if the lensed polarization is measured with zero noise , then the equation @xmath6 can be solved ( except possibly for a small number of degenerate modes ) for the projected matter density with zero noise .",
    "the equation @xmath7 is ill - behaved in the presence of instrument noise ; fortunately , the likelihood formalism easily incorporates noise and , as we show in this paper , regularizes the problem .    in practice ,",
    "a perfect reconstruction of the lensing potential is impossible because as instrument noise is reduced , some contaminant to the lensing signal will eventually become more important than the instrument noise .",
    "one candidate for this limiting factor is lensing field rotation caused by the fact that the density perturbations causing the lensing are spread out along the line of sight ( i.e. there is more than one `` lens plane '' ) and that the lensing is not perfectly weak ( i.e. the first - order born approximation to the lensing field is inexact ) .",
    "we will show that even for an experiment with noise 0.25 @xmath1k arcmin and 2 arcmin full - width half maximum beam , the field rotation does not substantially worsen the lensing reconstruction .",
    "it is however possible that foreground contamination will be a more serious problem .    studies of lensing of cmb polarization will require that the polarization field be mapped with noise levels of the order of @xmath8 @xmath1k arcmin ; this would be a substantial improvement in sensitivity beyond that of the current _ wilkinson microwave anisotropy probe _",
    "( _ wmap _ ; _ http://map.gsfc.nasa.gov/_ ) and the upcoming _ planck _",
    "( _ http://astro.estec.esa.nl/planck/",
    "_ ) experiments ( see table [ tab : expt ] ) .",
    "nevertheless , @xmath8 @xmath1k arcmin may be achieved with a future polarization satellite .",
    "the noise levels of @xmath90.25 @xmath1k arcmin at which field rotation becomes important will probably remain unachievable for the foreseeable future .",
    "this paper is organized as follows : in  [ sec : formalism ] , we define our notations and conventions . in ",
    "[ sec : likelihood ] , we consider the properties of the likelihood function and its implications for likelihood and bayesian analyses of cmb lensing reconstruction . in ",
    "[ sec : crosspotential ] , we investigate the breakdown of the born approximation for cmb lensing and its implications for lensing reconstruction .",
    "determination of the lensing power spectrum from cmb maps is discussed in  [ sec : ape ] .",
    "we show numerical simulations of cmb polarization lensing and reconstruction using our estimators in  [ sec : numer ] , and conclude in  [ sec : conclusions ] .",
    "the fiducial cosmology used in these simulations is a spatially flat cosmological constant - dominated universe with baryon fraction @xmath10 ; cold dark matter fraction @xmath11 ; cosmological constant fraction @xmath12 ; hubble parameter @xmath13 km / s / mpc ; primordial helium abundance @xmath14 ; reionization optical depth @xmath15 ; primordial scalar spectral index @xmath16 ; and no primordial vector or tensor perturbations .",
    "we have used the cmbfast numerical package @xcite to compute all power spectra except in  [ sec : effect ] .",
    "the experiments considered are as shown in table [ tab : expt ] .",
    "the _ wmap _ and the _ planck _ will not be able to map the lensing field using polarization and are included in the table for comparison .",
    "the reference experiments a through f are successively lower - noise ( or finer - beam ) experiments that were analyzed to determine how the signal - to - noise ratio in the lensing reconstruction depends on experimental parameters .",
    "note that experiment c is the reference experiment of refs .",
    "@xcite .",
    ".[tab : expt]parameters for cmb experiments .",
    "[ cols=\"<,^,^,^,^,^,^,^,^\",options=\"header \" , ]",
    "here we describe our normalization conventions ; note that for some quantities , there are many conventions in use in the literature , and appropriate conversion factors must be applied if one wishes to compare results .",
    "we work in the normalized flat - sky approximation , i.e. the sky is taken to be a flat square of side length @xmath17 ( i.e. total area @xmath18 ) with periodic boundary conditions .",
    "the cmb temperature and polarization fields can then be expressed as a sum over fourier modes : @xmath19 where the @xmath20-modes are distributed in the two - dimensional @xmath20-space with number density @xmath21 . defining the angle of a mode by @xmath22 , we have @xmath5 and @xmath0 polarization modes given by : @xmath23 ( technically the angle @xmath24 of the @xmath25 mode is undefined , however this will not concern us since within the flat - sky approximation we will convert sums over @xmath20 into integrals : @xmath26 .",
    "if an integral is divergent at @xmath27 , then it can not be computed accurately within the flat - sky approximation . )",
    "we will use the following notations for cmb fields : @xmath28 for the unlensed ( primary ) cmb anisotropies ; @xmath29 for the lensed cmb anisotropies ; and @xmath30 for the measured anisotropies ( including noise ) .",
    "these are measured in @xmath1k ( blackbody temperature ) , and we will assume that the monopole ( mean temperature ) and special - relativistic effects ( kinematic dipole / quadrupole and stellar aberration ) have been removed",
    ". the instrument noise will be assumed to be statistically uncorrelated with any cosmological signal and will be denoted by @xmath31 , where @xmath32 is one of @xmath33 , @xmath34 , or @xmath35 ( or @xmath33 , @xmath5 , and @xmath0 depending on which basis is more convenient ) .",
    "the unlensed cmb will have a power spectrum given by : @xmath36 where here @xmath32 and @xmath37 are @xmath33 , @xmath5 , or @xmath0 ( here we desire rotational symmetry so we can not use @xmath34 or @xmath35 ) .",
    "we assume the universe is statistically parity - invariant so that @xmath38 ; in some parts of this paper we will discuss universes with no tensor perturbations , in which case we also have @xmath39 .",
    "throughout most of this paper we will take general noise covariance @xmath40 ; when we wish to show expected performance for particular experiments , we will use the following noise power spectrum appropriate for a gaussian beam profile : @xmath41 where @xmath42 is the full - width at half maximum ( fwhm ) of the beam .",
    "we take a similar form for @xmath43 , except that @xmath44 is replaced with @xmath45 .",
    "the quantities @xmath46 , @xmath47 , and @xmath42 ( combined with the fraction @xmath48 of the sky surveyed ) thus parameterize the performance of the experiment .",
    "noise curves compared to the cmb for the experiments shown in table [ tab : expt ] are shown in fig .",
    "[ fig : cl ] .",
    "the @xmath49-value at which the beam transfer function drops to @xmath50 is given approximately by @xmath51 .",
    "we will introduce a vector @xmath52 containing both temperature and polarization information : @xmath53 .",
    "the lensed and measured temperature / polarization vectors will be denoted @xmath54 and @xmath55 , respectively .",
    "[ note : @xmath52 is a `` vector '' in the sense of linear algebra , i.e. it is an element of a vector space , in this case a hilbert space with the usual @xmath56 inner product , on which matrix operations such as @xmath57 can act .",
    "it is not a vector in the sense of differential geometry . ] since most of the fields we deal with , including cmb temperature and polarization , are real , their fourier modes satisfy e.g. @xmath58 .",
    "consequently , if we have @xmath59 fourier modes , the @xmath59-dimensional vector with components @xmath60 only has @xmath61 independent complex components ; the remainder contain redundant information .",
    "( of course , there are still @xmath59 independent real components . )",
    "the covariance matrix @xmath57 is defined as @xmath62 ; note that it is hermitian by construction .",
    "the lensed temperature and polarization are given in terms of the unlensed temperature by means of the re - mapping function @xmath63 : @xmath64 $ ] , and similarly for @xmath34 and @xmath35 [ however , @xmath5 and @xmath0 do not transform this way , rather one must use eq .",
    "( [ eq : eb ] ) ]",
    ". the re - mapping function can be decomposed into a longitudinal part generated by the lensing potential @xmath65 , and a transverse part generated by the lensing cross - potential @xmath66 : @xmath67 where @xmath68 is the ninety - degree rotation operator : @xmath69 , @xmath70 .",
    "past studies of cmb lensing reconstruction have ignored the cross - potential since ( for scalar perturbations ) it vanishes at first order in perturbation theory . in principle",
    "it could become important given the high precision enabled by lensing of cmb polarization .",
    "however , we will show in  [ sec : crosspotential ] and  [ sec : numer1 ] that the cross - potential is unimportant for most near - term experiments .",
    "we restrict our attention to the weak lensing regime , i.e. we assume the magnification matrix : @xmath71 is everywhere invertible .",
    "this is a necessary and sufficient condition to disallow caustics and multiple images of the same portion of the surface of last scatter .",
    "lensing by large - scale structure is too weak to create caustics on the surface of last scatter , so the weak lensing assumption is violated only in the vicinity of astrophysical objects such as clusters .",
    "we classify clusters and other strong lenses as foreground contaminants and do not consider them further here . in the regime where the lensing distortion is small  i.e. @xmath72 is close to the identity  we may interpret the four components @xmath73 in eq .",
    "( [ eq : weaklens ] ) as follows .",
    "the convergence @xmath74 magnifies a feature on the last - scattering surface of infinitesimal angular size @xmath75 to size @xmath76 .",
    "the field rotation angle @xmath77 rotates the feature clockwise by @xmath77 radians .",
    "the @xmath34-shear @xmath78 produces a stretching along the @xmath79-axis while compressing it along @xmath80 : the apparent angular extents of a feature along the two axes are @xmath81 and @xmath82 , respectively .",
    "the @xmath35-shear has a similar effect , stretching along the @xmath83 axis and compressing along the @xmath84 axis .",
    "it should be noted that the four fields @xmath73 are _ not _ independent because they are all generated by differentiating the two fields @xmath65 and @xmath66 . in particular ,",
    "if we @xmath85-decompose the shear field into its positive - parity ( @xmath86 ) and negative - parity ( @xmath87 ) components : @xmath88_{{\\bf",
    "l}}\\cos 2\\phi_{{\\bf l}}+ [ \\gamma_u]_{{\\bf l}}\\sin 2\\phi_{{\\bf l } } , \\nonumber \\\\",
    "l}}= & &   -[\\gamma_q]_{{\\bf l}}\\sin 2\\phi_{{\\bf l}}+ [ \\gamma_u]_{{\\bf l}}\\cos 2\\phi_{{\\bf l}},\\end{aligned}\\ ] ] we find that @xmath89 and @xmath90 .",
    "these are then related to the potentials via @xmath91 and @xmath92 .",
    "this immediately implies the power spectrum relations @xmath93 and @xmath94 .",
    "it is of interest to note that the convergence and field rotation can be determined from the deflection angle @xmath95 by : @xmath96    if @xmath73 are not small compared to 1 , then the physical interpretation of these quantities is somewhat more complicated .",
    "we will continue to call @xmath74 the `` convergence , '' @xmath97 the `` shear , '' and @xmath77 the `` field rotation angle '' even in this case , although this convention is not universally followed in the literature .",
    "note , however , that the relations @xmath89 and @xmath90 continue to hold ( in fact , they remain valid even for strong lenses ! ) , which makes our definitions of convergence , shear , and field rotation angle particularly convenient .",
    "sometimes we will specify a lens re - mapping @xmath63 by its convergence and field rotation , @xmath98 .",
    "most authors have performed the lensing analysis using @xmath65 rather than @xmath74 as the field to be estimated , since the deflection angle is a local function of the former . in the present analysis , we take @xmath74 ( and @xmath77 when it is important ) to be the fundamental field . of course",
    ", the two fields contain exactly the same information , being related by the differential relation @xmath99 in real space and by a multiplicative factor of @xmath100 in harmonic space .",
    "it is convenient to introduce the lensing operator @xmath101 defined by @xmath102 , where @xmath32 is one of @xmath33 , @xmath34 , or @xmath35 .",
    "[ in the @xmath103 basis , the action of @xmath101 is not so simple and the transformation of eq .",
    "( [ eq : eb ] ) must be applied . ]",
    "we define the @xmath104 differential operator ( and analogously @xmath105 ) as the action of an infinitesimal lens configuration : @xmath106 } ) |_{g=(0,0)}$ ] .",
    "then , noting that @xmath107 is the identity operator @xmath108 , we find that to first order in @xmath109 : @xmath110 the @xmath111 operator acts as follows on a field @xmath32 in the @xmath28 basis : @xmath112 in the @xmath103 basis , the @xmath111-matrices mix @xmath5 and @xmath0 because these are non - local quantities .",
    "specifically , they have components : @xmath113_{{{\\bf l}}_1,-{{\\bf l}}_2 } =   -{\\delta_{{{\\bf l}}_1,{{\\bf l}}-{{\\bf l}}_2}\\over\\sqrt{4\\pi } } \\left ( \\frac{2}{l^2}\\right ) ( { { \\bf l}}\\cdot{{\\bf l}}_2 ) \\left ( \\begin{array}{ccc } 1 & 0 & 0 \\\\ 0 & \\cos 2\\alpha & -\\sin 2\\alpha \\\\ 0 & \\sin 2\\alpha & \\cos 2\\alpha \\end{array }",
    "\\right ) , \\label{eq : sigmamatrix}\\ ] ] where the rows correspond to the @xmath114 and the columns to the @xmath115 , and we have defined the angle @xmath116 .",
    "the matrix for @xmath117 differs by replacing the prefactor @xmath118 with @xmath119 .",
    "the @xmath111 matrices satisfy @xmath120 .",
    "lensing alters the cmb anisotropy covariance ; the covariance matrix @xmath121 , where @xmath122 ( or @xmath123 ) of the lensed temperatures is dependent on the lens configuration @xmath63 , and thus we will denote it by @xmath124 . since the lensed cmb field is @xmath125 , we have @xmath126 .",
    "the lensed covariance averaged over the ensemble of lss configurations will be denoted by @xmath127 .",
    "note , however , that whereas the primary cmb is expected to be nearly gaussian , the lensed cmb is non - gaussian and so @xmath128 does _ not _ specify completely the statistics of the lensed cmb field .",
    "indeed , it is the non - gaussianity of the lensed cmb that enables separation of the lensing and gravitational wave contributions to @xmath0 .",
    "it also means that the standard gaussian formula for the uncertainty in the power spectrum , @xmath129 , does not necessarily apply to @xmath0-mode polarization on small scales .",
    "it is readily apparent from eq .",
    "( [ eq : sigmamatrix ] ) that lensing can produce @xmath0-modes even if these are not present in the primary cmb .",
    "we show in appendix [ sec : bmode ] that for `` almost all '' primary cmb realizations , there are only a small number of convergence modes that do not produce @xmath0-type polarization .",
    "we illustrate our formalism with a simple lensing reconstruction via @xmath130 minimization ( the `` least squares '' method ) . we perform a full likelihood analysis in  [ sec : likelihood ] , but the @xmath130 analysis is sufficiently similar that it illustrates the basic concept . define the functional @xmath131 of a convergence field given cmb data @xmath55 : @xmath132 here @xmath133 is the de - lensed cmb , i.e. we have taken the measured cmb and projected it back onto the primary cmb assuming that the lens configuration is given by convergence @xmath74 with no rotation .",
    "to a first approximation , this should have covariance @xmath134 since it is the sum of primary cmb and instrument noise .",
    "( the matrix @xmath135 is equal to the measured cmb covariance in the absence of lensing and hence will frequently be denoted by @xmath136 .",
    "technically the noise covariance is not exactly @xmath137 because the noise has been de - lensed ; see  [ sec : estcon ] . )",
    "we have thus chosen to define our @xmath130 as the amount of power in this de - lensed cmb , with the various modes weighted according to their variance .",
    "the addition of the @xmath138 term serves to regularize the problem by preventing the convergence from running off to @xmath139 in search of smaller primary cmb power .    if we take the first - order approximation to @xmath140 given by eq .",
    "( [ eq : lambdaapprox ] ) , eq .",
    "( [ eq : chisq ] ) becomes : @xmath141 where : @xmath142 note that @xmath143 is a real vector and @xmath144 is hermitian .",
    "this is a quadratic function of @xmath74 and hence it has a minimum that can be determined via standard techniques .",
    "the minimum is at : @xmath145 the error covariance @xmath146 of @xmath74 is found by the usual method of setting @xmath147 ;",
    "this yields : @xmath148    the most important feature of this analysis is the reconstruction error , @xmath146 . note that as the instrument noise goes to zero , the matrix @xmath135 develops null directions corresponding to the @xmath0-modes .",
    "therefore , @xmath149 has infinite eigenvalues in these directions , and if the number of convergence modes being reconstructed is less than or equal to the number of @xmath0-modes measured , we have @xmath150 and @xmath151 .",
    "this leads us to the conclusion that the accuracy of convergence reconstruction is limited only by the sensitivity of the instrument and the presence of foregrounds or other contaminants , not by statistics of the convergence or primary cmb field .",
    "one can note that for zero instrument noise , the @xmath130 , eq . ( [ eq : chisq ] ) , is infinite unless the de - lensed cmb field @xmath133 has vanishing @xmath0-modes , i.e. in this case the @xmath130 analysis is solving for @xmath6 ( except possibly for a few degenerate modes ; see appendix [ sec : bmode ] ) .",
    "we extend this methodology to a full likelihood analysis in ",
    "[ sec : likelihood ] , where we find that the general conclusions of this section remain valid .",
    "in this section we explore the accuracy of reconstruction of lensing based on cmb temperature and polarization .",
    "we follow the analysis performed in ref .",
    "@xcite for the cmb temperature ; most of the analysis extends easily to polarization , with one exception : the primary cmb has very little ( if any ) @xmath0-mode polarization .",
    "this means that the lensed cmb power spectrum @xmath152 can not be expressed as a small perturbation on the unlensed power spectrum .",
    "we also include the effect of the field rotation in our discussion of the likelihood gradient and fisher matrix , although we do not construct a `` practical '' estimator for it .      for a given lens configuration with re - mapping function @xmath63 ,",
    "the covariance matrix @xmath153 of the measured cmb is computed from : @xmath154 where @xmath155 is the noise matrix .",
    "the measured cmb is gaussian - distributed if we assume that the primary cmb @xmath52 and instrument noise @xmath156 are both gaussian .",
    "( note : the assumption of gaussianity only applies _ before _ we average over lss realizations . ) the ( negative log ) likelihood function @xmath157 for a lens configuration with re - mapping function @xmath63 is then given ( up to an irrelevant constant ) by : @xmath158 now we wish to determine the likelihood gradient with respect to the lens configuration @xmath159 .",
    "we will compute the gradient of the likelihood function , eq .",
    "( [ eq : likelihood ] ) , using eq .",
    "( [ eq : chat ] ) : @xmath160 } { \\bf c } \\lambda_g^\\dagger \\right ) - \\hat{\\bf x}^\\dagger \\hat{\\bf c}^{-1}_g { \\partial\\lambda_g\\over \\partial\\kappa_{{\\bf l}}[g ] } { \\bf c}\\lambda_g^\\dagger \\hat{\\bf c}^{-1}_g \\hat{\\bf x}. \\label{eq : lgrad}\\ ] ]    the maximum - likelihood estimator is given by the relation @xmath161 .",
    "( we also require @xmath162 if we are estimating @xmath77 as well as @xmath74 . )",
    "however , maximum likelihood estimation of the lensing field is generally unstable because the lensing field has too many degrees of freedom . in order to regularize the problem",
    ", we introduce a bayesian prior probability distribution @xmath163 for @xmath159 , i.e. we take prior probability @xmath164 .",
    "it is most convenient to take a gaussian prior based on the power spectra of @xmath74 and ( if applicable ) @xmath77 :    @xmath165    where in the second equality we have assumed that the prior on @xmath74 and @xmath77 is statistically isotropic .",
    "( note that this assumes the power spectra are known ; we will consider the problem of estimating @xmath166 from cmb data in  [ sec : ape ] .",
    "the methods we present in  [ sec : ape ] allow iterative determination of both the convergence field @xmath74 and the power spectrum @xmath166 . )",
    "if we are neglecting the field rotation then the terms involving @xmath77 should simply be removed .",
    "the mode of the posterior probability distribution is given by minimizing @xmath167 ; we thus set @xmath168 , or : @xmath169_{{\\bf l}}^\\ast = -{{\\rm tr}}\\left ( \\hat{\\bf c}^{-1}_g { \\partial\\lambda_g\\over \\partial\\kappa_{{\\bf l}}[g ] } { \\bf c } \\lambda_g^\\dagger \\right ) + \\hat{\\bf x}^\\dagger \\hat{\\bf c}^{-1}_g { \\partial\\lambda_g\\over \\partial\\kappa_{{\\bf l}}[g ] } { \\bf c } \\lambda_g^\\dagger \\hat{\\bf c}^{-1}_g \\hat{\\bf x}. \\label{eq : wf}\\ ] ] because of the presence of the prior @xmath170 , this estimator will filter out lensing modes that can not be accurately reconstructed from the cmb data .",
    "it can thus be viewed as a sort of nonlinear generalization of the wiener filter .",
    "the likelihood gradient , eq .",
    "( [ eq : lgrad ] ) , and hence the convergence estimator eq .",
    "( [ eq : wf ] ) based on it , are difficult to evaluate .",
    "we therefore investigate several approximations to the likelihood function .",
    "first , we consider only the convergence , @xmath74 ; the rotation @xmath77 will be shown in  [ sec : crosspotential ] to be unimportant unless instrument noise is very small .",
    "we note that eq .",
    "( [ eq : wf ] ) can be re - written as : @xmath171_{{\\bf l}}^\\ast = -{{\\rm tr}}\\left ( \\lambda_g^{\\dagger\\,-1}{\\bf w } \\lambda_g^{-1 } { \\partial\\lambda_g\\over \\partial\\kappa_{{\\bf l}}[g ] } { \\bf c }   { \\bf w}\\lambda_g^{-1 } \\hat{\\bf c}_g \\right ) + \\hat{\\bf x}^\\dagger \\lambda_g^{\\dagger\\,-1}{\\bf w } \\lambda_g^{-1 } { \\partial\\lambda_g\\over \\partial\\kappa_{{\\bf l}}[g]}{\\bf c } { \\bf w}\\lambda_g^{-1 } \\hat{\\bf x } , \\label{eq : wf2}\\ ] ] where the weight matrix @xmath172 is defined by : @xmath173 here @xmath174 is the de - lensed noise covariance matrix , which is equal to the noise covariance @xmath137 for @xmath175 ( no de - lensing ) . under most circumstances ,",
    "de - lensing has much less effect on the noise than on the cmb signal , because instrument noise is a relatively smooth function of @xmath49 and contains both @xmath5 and @xmath0 modes with similar power .",
    "it is possible that @xmath176 if the noise power spectrum contains sharp features ; in this case , the approximation @xmath177 used below may result in a non - optimal , or ( in extreme cases ) unstable estimator .",
    "we would like to approximate @xmath178)$ ] using the @xmath111 matrices ; this can be done by expanding : @xmath179 } = \\left .",
    "{ \\partial \\kappa_{{{\\bf l}}'}[g^{-1}g']\\over \\partial \\kappa_{{\\bf l}}[g ' ] } \\right|_{g'=g } \\sigma^\\kappa_{{\\bf l}}+ \\left . { \\partial \\omega_{{{\\bf l}}'}[g^{-1}g']\\over \\partial \\kappa_{{\\bf l}}[g']}\\right|_{g'=g } \\sigma^\\omega_{{\\bf l}},\\ ] ] where the juxtaposition @xmath180 indicates composition of the lensing operations : @xmath181",
    ". if the lensing is very weak we may take @xmath182/\\kappa_{{\\bf l}}[g'])|_{g'=g}\\approx",
    "[ \\lambda_g^{-1}]_{{{\\bf l}}',{{\\bf l}}}$ ] and @xmath183/\\kappa_{{\\bf l}}[g'])|_{g'=g}\\approx 0 $ ] , that is , the composition of lensing operations can be approximated by re - mapping the convergence field and neglecting rotation .",
    "in this regime , the statistical properties of the convergence field @xmath74 should not differ greatly from those of the `` de - lensed '' convergence field @xmath184 ; mathematically , this means that we may take @xmath101 and @xmath185 to commute . with these approximations , eq .",
    "( [ eq : wf2 ] ) becomes : @xmath186 .",
    "\\label{eq : ape2}\\ ] ]    the right - hand side of eq .",
    "( [ eq : ape2 ] ) is our approximation to the likelihood gradient , and the left - hand side is our ( approximate ) prior gradient .",
    "note that the right - hand side evaluated at the correct lensing configuration @xmath63 has expectation value zero , regardless of the choice of weight function ; we will therefore choose the slightly sub - optimal weight function @xmath187 in order to reduce computational difficulties .",
    "this leads us to the estimator : @xmath188 .",
    "\\label{eq : estcon0}\\ ] ] [ this choice leads to some difficulty for low - noise , wide - beam ( @xmath189 arcmin ) experiments ; see  [ sec : numer1 ] for details .",
    "] by expanding @xmath190 using eq .",
    "( [ eq : chat ] ) , and noting that in the harmonic - space basis , @xmath57 and @xmath136 are diagonal whereas @xmath191 has no nonzero diagonal elements , we convert this into : @xmath192 .",
    "\\label{eq : estcon}\\ ] ]      the fisher matrix is defined as the expectation value of the second derivative of the likelihood function : @xmath193 \\equiv \\left.\\left\\langle { \\partial^2{\\cal l}\\over   \\partial\\kappa_{{\\bf l}}^\\ast \\partial\\kappa_{{{\\bf l } } ' } } \\right\\rangle\\right|_{(\\kappa,\\omega ) } = \\left.\\left\\langle { \\partial{\\cal l}\\over\\partial\\kappa_{{\\bf l}}^\\ast }   { \\partial{\\cal l}\\over\\partial\\kappa_{{{\\bf l } } ' } } \\right\\rangle\\right|_{(\\kappa,\\omega ) } , \\label{eq : fisherdef}\\ ] ] where the second equality follows from taking the second derivative ( @xmath194 ) of the normalization condition @xmath195 and noting that the expectation value of any statistic @xmath196 is @xmath197 .",
    "( this also shows that @xmath198 has all non - negative eigenvalues . )",
    "a similar relation holds for the field - rotation modes @xmath199 .",
    "we may thus compute the lensing fisher matrix as the covariance of the likelihood gradient ; the easiest method of doing this is to apply wick s theorem to compute the variance of eq .",
    "( [ eq : lgrad ] ) .",
    "this yields : @xmath193 =   \\left\\langle { \\partial{\\cal l}\\over\\partial\\kappa_{{\\bf l}}^\\ast } { \\partial{\\cal   l}\\over\\partial\\kappa_{{{\\bf l } } ' } } \\right\\rangle = { { \\rm tr}}\\left ( \\lambda_g^\\dagger \\hat{\\bf c}^{-1}_g \\sigma^\\kappa_{-{{\\bf l } } } { \\bf c } \\lambda_g^\\dagger \\hat{\\bf c}^{-1}_g \\sigma^\\kappa_{{{\\bf l } } ' } { \\bf c } \\right ) + { { \\rm tr}}\\left ( \\hat{\\bf c}^{-1}_g \\sigma^\\kappa_{-{{\\bf l } } } { \\bf c } \\lambda_g^\\dagger \\hat{\\bf c}^{-1}_g \\lambda_g { \\bf c } \\sigma^{\\kappa\\dagger}_{{{\\bf l } } ' } \\right ) \\label{eq : fisher}\\ ] ] and similarly for the components of the fisher matrix elements involving the field rotation . for simplicity ,",
    "we compute the fisher matrix at @xmath200 , i.e. the @xmath201 point , so that @xmath107 is the identity . the @xmath57 and @xmath202 matrices are diagonal in the @xmath103 basis : @xmath203 and : @xmath204 where @xmath205 .",
    "the overall fisher matrix is then computed from eq .",
    "( [ eq : fisher ] ) : @xmath193 \\approx \\frac{1}{2 } { { \\rm tr}}\\left [ \\hat{\\bf c}^{-1}_{(0,0 ) }   { \\bf f}_{-{{\\bf l}}}^\\kappa \\hat{\\bf c}^{-1}_{(0,0 ) } { \\bf f}_{{{\\bf l}}'}^\\kappa \\right ] , \\label{eq : fphi}\\ ] ] where : @xmath206_{{{\\bf l}}_1,-{{\\bf l}}_2 } = & & \\!\\!\\!\\ ! [ { \\bf c}\\sigma_{-{{\\bf l}}}^{\\kappa\\,\\dagger }   + \\sigma_{{\\bf l}}^\\kappa{\\bf c}]_{{{\\bf l}}_1,{{\\bf l}}_2 } \\nonumber\\\\ = & & \\!\\!\\!\\ ! -{\\delta_{{{\\bf l}}_1,{{\\bf",
    "l}}-{{\\bf l}}_2}\\over\\sqrt{4\\pi } }   \\left ( \\frac{2}{l^2}\\right ) { { \\bf l}}\\cdot \\left ( \\begin{array}{ccc } { { \\bf l}}_1 c^{tt}_{l_1 } + { { \\bf l}}_2 c^{tt}_{l_2 } & { { \\bf l}}_1 c^{te}_{l_1 } \\cos 2\\alpha + { { \\bf l}}_2 c^{te}_{l_2 } & -{{\\bf l}}_1 c^{te}_{l_1 }",
    "\\sin 2\\alpha \\\\ { { \\bf l}}_1 c^{te}_{l_1 } + { { \\bf l}}_2 c^{te}_{l_2 } \\cos 2\\alpha &   ( { { \\bf l}}_1",
    "c^{ee}_{l_1}+{{\\bf l}}_2 c^{ee}_{l_2 } ) \\cos 2\\alpha & ( { { \\bf l}}_2 c^{bb}_{l_2 } - { { \\bf l}}_1 c^{ee}_{l_1 } ) \\sin 2\\alpha \\\\ { { \\bf l}}_2 c^{te}_{l_2 } \\sin 2\\alpha   & ( { { \\bf l}}_2 c^{ee}_{l_2}-{{\\bf",
    "l}}_1 c^{bb}_{l_1 } ) \\sin 2\\alpha   & ( { { \\bf l}}_1 c^{bb}_{l_1}+{{\\bf",
    "l}}_2 c^{bb}_{l_2 } ) \\cos 2\\alpha \\end{array } \\right ) .",
    "\\label{eq : fl}\\end{aligned}\\ ] ] ( the matrix @xmath207 is identical except for the replacement @xmath208 . ) note that by hermiticity of @xmath209 , we have @xmath210 ; for the individual @xmath211 blocks in the harmonic - space basis , @xmath212_{{{\\bf l}}_1,-{{\\bf l}}_2 } = [ { \\bf f}^{\\kappa\\,\\dagger}_{-{{\\bf l}}}]_{-{{\\bf l}}_1,{{\\bf l}}_2}^\\dagger$ ] .",
    "also our construction guarantees that @xmath213 where the derivative is evaluated at @xmath201 .",
    "it can be verified by explicit matrix multiplication that the computation for @xmath214 $ ] here yields the uncertainty in the minimum - variance quadratic estimator of ref .",
    "@xcite , with one exception : we have computed the fisher matrix at @xmath175 , hence the denominator of eq .",
    "( [ eq : fphi ] ) contains the _ unlensed _ cmb power spectrum plus the instrument noise , whereas the equivalent calculation in ref .",
    "@xcite contains the _ lensed _ cmb power spectrum plus the instrument noise . in the case of quadratic estimation , it is clear that the lensed power spectrum should be used in order to minimize the variance of the estimator .",
    "conceptually , this is because the lensing @xmath0-modes can be iteratively cleaned from the map , thereby reducing the post - cleaning @xmath0-mode power spectrum and reducing the noise in the lensing estimator .",
    "our ability to clean the map is bounded , of course , by the sum of the unlensed cmb and noise contributions to @xmath215 .",
    "the usual method of estimating the uncertainty in lens reconstruction would be to invert the fisher matrix .",
    "this approach is motivated by the cramer - rao inequality , which states that an unbiased estimator of the lensing configuration must have covariance at least equal to @xmath216 .",
    "unfortunately , the cramer - rao inequality is only an inequality , and there is no guarantee that the bound @xmath217 can actually be reached ; indeed this bound is only achieved in the case where the likelihood function is gaussian with curvature @xmath198 . the traditional justification for assuming gaussianity of the likelihood function is the central limit theorem .",
    "this works for studies of lensing of the cmb temperature field , in which the typical lensing mode being reconstructed is at @xmath218 whereas the temperature fluctuations that are being lensed have wavenumber @xmath219 ; thus there are roughly @xmath220 patches of primary cmb behind each lensing mode .",
    "( most of the information comes from non - local correlations in the @xmath33 field , so this argument technically requires more justification ; nevertheless the calculations in ref . @xcite",
    "seem to indicate that it gives the correct answer . )",
    "this argument does not apply to lensing of the cmb polarization because the wavenumbers of the primary @xmath5 polarization modes and of the lensing field modes ( @xmath221 ) are both at wavenumbers of order @xmath219",
    ". we should therefore be careful of possible problems with the fisher matrix estimate , eq .",
    "( [ eq : fphi ] ) of the uncertainty in the lensing field . in this section ,",
    "we outline two such problems that occur in lensing reconstruction : first , a complete breakdown of the fisher matrix approach when the field rotation @xmath77 becomes important ; and second , fluctuations in the curvature matrix resulting from the statistical nature of the primary @xmath5-field .",
    "consider first the problem of simultaneous reconstruction of both @xmath74 and @xmath77 .",
    "( we will see in  [ sec : crosspotential ] that the noise levels required for this are not achievable in the near term , however , this extreme example serves to illustrate the problem . ) one can see that if there are no primary @xmath0-modes , then as instrument noise goes to zero , the uncertainty in @xmath74 and @xmath77 obtained by inverting eq .",
    "( [ eq : fphi ] ) goes to zero . but this can not be true because the _ one _ equation @xmath6 can not be used to solve for the _ two _ fields @xmath74 and @xmath77 simultaneously . therefore inverting the fisher matrix yields a qualitatively absurd conclusion .",
    "what went wrong ?",
    "the observation that one equation ( the vanishing of the unlensed @xmath0-mode field ) can not be solved for two variables ( @xmath74 and @xmath77 ) yields a clue .",
    "consider the case where instrument noise is negligible ; then we know that the measured @xmath0-mode is purely caused by lensing : @xmath222 e_{{{\\bf l}}-{{\\bf l}}'}\\sin 2\\alpha , \\label{eq : dege}\\ ] ] where @xmath223 . to the extent that the @xmath5-mode is dominated by the primary ( not lensing ) contribution , eq .",
    "( [ eq : dege ] ) is a linear system containing @xmath224 unknown variables ( the amplitudes of the @xmath74 and @xmath77 modes ) but only @xmath59 equations ( the knowledge of the lensed @xmath0-modes ) , thus there are degeneracy directions in lens configuration space which are unconstrained by the vanishing of the @xmath0-modes .",
    "these directions must be constrained by a combination of the statistical properties of primary temperature and @xmath5-type polarization , and prior knowledge about the lensing field .",
    "we can now understand why the lensing fisher matrix @xmath198 is inadequate for determining the uncertainty in the lensing fields @xmath74 and @xmath77 .",
    "the curvature matrix : @xmath225(g )   = { \\partial^2{\\cal l}\\over \\partial \\kappa_{{\\bf l}}^\\ast \\partial\\kappa_{{{\\bf l } } ' } } \\label{eq : curvaturematrix}\\ ] ] has very small eigenvalues in the directions of degeneracy of eq .",
    "( [ eq : dege ] ) and very large eigenvalues ( approaching @xmath139 as @xmath226 ) in the orthogonal directions . but as one can see from eq .",
    "( [ eq : dege ] ) , the direction of degeneracy depends on @xmath5 and hence on the specific realization of the cmb .",
    "if we average over cmb realizations to obtain a fisher matrix @xmath198 , then we derive @xmath227 , which does not accurately reflect the non - zero errors in the degenerate directions of eq .",
    "( [ eq : dege ] ) .",
    "mathematically , the fisher matrix methodology does not work because the error bars on @xmath109 are extremely non - gaussian .",
    "the lesson is that we should be careful about interpreting the inverse of the fisher matrix as an uncertainty in parameters when the central limit theorem does not come to our aid .",
    "a similar but less spectacular problem occurs in attempting reconstruction of small - scale lensing modes even when there is sufficient instrument noise that @xmath66 is irrelevant .",
    "this is the regime of interest to a near - future high - resolution polarization experiment .",
    "the statistical uncertainty in the lensing reconstruction is given by the inverse of the curvature matrix @xmath228 .",
    "when doing a lens reconstruction , this curvature matrix is augmented by the curvature of the prior , @xmath229 , so that the posterior error covariance matrix of the lensing reconstruction is approximately @xmath230 .",
    "we wish to compute the mean squared error in the reconstructed convergence @xmath231 , which is obtained by computing the ensemble average of this covariance matrix over all realizations of cmb , noise , and lss : @xmath232 the fisher matrix @xmath198 is defined to be the expectation value of the curvature : @xmath233 ( with no lss average ) .",
    "if the curvature matrix were always equal to @xmath198 , then it would be permissible to approximate @xmath234 .",
    "it can be shown ( see appendix [ sec : a1 ] ) that the statistical fluctuations of @xmath228 always increase the uncertainty , eq .",
    "( [ eq : sdef ] ) ; this increase we call the `` curvature correction . ''",
    "conceptually , the naive calculation that the mean squared error is approximately @xmath235 suffers problems for the same reason that the fisher matrix calculation for simultaneously estimating @xmath74 and @xmath77 failed : the different realizations of the primary cmb introduce fluctuations in @xmath228 , and when we average over cmb realizations we generate a non - gaussian error distribution for the estimated convergence .",
    "the actual computation of the curvature corrections is not pursued here ; some of the relevant issues are discussed in appendix [ sec : a1 ] , where we show that the `` first - order noise contribution '' of ref .",
    "@xcite arises as one part of the second - order curvature correction .",
    "it is of interest to compare the estimator we have derived , eq .",
    "( [ eq : estcon ] ) , to the quadratic estimation method of ref . @xcite .",
    "the performance of the estimators is compared numerically in  [ sec : estcon ] . here",
    "we display the quadratic estimator and note the major differences between the quadratic and iterative estimators .",
    "the wiener - filtered quadratic estimator is : @xmath236^{-1 } \\hat{\\bf x}^\\dagger \\langle\\hat{\\bf c}\\rangle_{lss}^{-1 }",
    "\\sigma^\\kappa_{{{\\bf l } } ' } { \\bf c }   \\langle\\hat{\\bf c}\\rangle_{lss}^{-1 } \\hat{\\bf x } , \\label{eq : wfquad}\\ ] ] where the quadratic fisher matrix is determined as : @xmath237 .",
    "\\label{eq : qfisher}\\ ] ] the `` unbiased '' ( to first order in @xmath65 ) , non - wiener - filtered temperature is given by eq .",
    "( [ eq : wfquad ] ) with the `` prior term '' @xmath238 omitted .",
    "( the quadratic fisher matrix is not technically a fisher matrix , but its inverse does give the covariance of the unbiased quadratic estimator . ) we prove in appendix [ sec : hu ] that eq .",
    "( [ eq : wfquad ] ) and its unbiased equivalent are identical to the minimum - variance quadratic estimator that arises from the optimal weighting scheme of ref .",
    "the mean squared error in the reconstructed convergence according to eq .",
    "( [ eq : wfquad ] ) is : @xmath239    several features of eqs .",
    "( [ eq : wfquad ] ) through ( [ eq : squad ] ) are readily apparent .",
    "first , the estimator eq .",
    "( [ eq : wfquad ] ) is a quadratic function of the cmb temperature / polarization field @xmath52 .",
    "secondly , we note that the uncertainty in the quadratic estimator is determined by the quadratic fisher matrix , which contains the inverse of @xmath240 . for statistically isotropic noise ,",
    "this inverse is given by : @xmath241 where @xmath242 , and @xmath243 is the lensed cmb power spectrum ( or cross - spectrum ) : @xmath244 .",
    "comparison of the quadratic fisher matrix [ eq .",
    "( [ eq : qfisher ] ) ] to the full fisher matrix [ eq .",
    "( [ eq : fphi ] ) ] shows that the two are identical except for replacement of eq .",
    "( [ eq : uquad ] ) by eq .",
    "( [ eq : u ] ) .",
    "this results in a qualitative difference between the two estimators : as instrument noise is reduced toward zero , the full fisher matrix improves without bound ( @xmath245 ) , so ( aside from foregrounds , field rotation , primary @xmath0-modes , and the statistical concerns outlined in  [ sec : deg ] ) the iterative estimator should be able to reconstruct the convergence with arbitrary accuracy .",
    "this is not so for the quadratic estimator , whose reconstruction accuracy is limited by the nonzero value of @xmath246 and the resulting upper bounds on @xmath247 and @xmath248 . at high noise levels where the @xmath0-mode can not be mapped",
    ", however , @xmath249 since both sides of the equation are noise - dominated , and in this regime the performance of the two estimators should be nearly identical .",
    "here we investigate the statistics of weak lensing fields with the objective of understanding the importance of the field rotation @xmath77 ( or equivalently the cross - potential @xmath66 ) in cmb weak lensing .",
    "field rotation is a cosmological contaminant in the sense that even with noiseless cmb data and no foregrounds , we can not hope to recover two fields @xmath74 and @xmath77 from the single equation @xmath250 .",
    "therefore a non - zero power spectrum @xmath251 translates into an uncertainty in the lens reconstruction .",
    "we compute the power spectrum @xmath251 by considering deflection angles ; this has the advantage of providing a unified treatment of the higher - order born approximation and `` lens - lens coupling '' effects considered by ref .",
    "we work in the longitudinal gauge because in this gauge the perturbations to the metric remain small ( of order @xmath252 except in the very small portion of the universe near neutron stars and black holes ) and so perturbation theory techniques are valid .",
    "we then consider the implications for lensing reconstruction ; for near - term experiments , the effect is seen to be negligible .      in the flat - sky approximation",
    ", we treat the photons as propagating in roughly the @xmath253 direction so that the cmb experiment looks in the @xmath254 direction ; the `` sky '' is in the @xmath255-plane .",
    "the spacetime metric observed by the photon is ( so long as it does not stray far from the @xmath256-axis ) : @xmath257 , \\ ] ] where the newtonian potential @xmath258 is generated by the non - relativistic matter inhomogeneities , and @xmath259 where @xmath260 is the curvature of the universe . the null geodesic equation in this",
    "metric is : @xmath261 the initial conditions are @xmath262 and @xmath263 .",
    "the usual method here is to apply the first - order born approximation to eqs .",
    "( [ eq : gl ] ) , i.e. we perform the integration over the unperturbed photon trajectory . if we integrate forward , we find that : @xmath264 where @xmath265 .",
    "we may now apply the second - order born approximation , in which we integrate not over the unperturbed photon trajectory but rather over the photon trajectory given by the first - order born approximation , eq .",
    "( [ eq : gl ] ) .",
    "taylor - expanding the result to second order in @xmath258 yields : @xmath266 the convergence and field rotation at radial coordinate @xmath267 are most easily derived by taking the angular fourier transform of this result .",
    "if we compute the deflection angle and perform the @xmath109 decomposition of eq .",
    "( [ eq : pdec ] ) , we derive : @xmath268   \\int_0^\\chi \\int_0^{\\chi ' } w(\\chi'',\\chi')w(\\chi',\\chi ) \\psi_{{{\\bf l}}'}(\\chi ' ) \\psi_{{{\\bf l}}-{{\\bf l}}'}(\\chi '' ) d\\chi''d\\chi ' \\label{eq : lensphi}\\ ] ] and : @xmath269 \\int_0^\\chi \\int_0^{\\chi ' } w(\\chi'',\\chi')w(\\chi',\\chi)\\psi_{{{\\bf l}}'}(\\chi ' ) \\psi_{{{\\bf l}}-{{\\bf l}}'}(\\chi '' ) d\\chi''d\\chi ' .",
    "\\label{eq : lensomega}\\ ] ]    we now turn our attention to the statistics of eqs .",
    "( [ eq : lensphi ] ) and ( [ eq : lensomega ] ) .",
    "we assume that @xmath258 can be described as a gaussian random field because even in the non - linear regime , our line of sight passes through many regions of independent density fluctuation and hence non - gaussianity is suppressed by the central limit theorem .",
    "the power spectrum is : @xmath270 here the projected potential power spectrum is determined using the limber equation : @xmath271 here we have used the 3d power spectra of the newtonian potential @xmath258 and fractional density perturbation @xmath272 ; these are normalized in accordance with ( here @xmath273 ) : @xmath274 so that the logarithmic band power is given by @xmath275 . the lowest - order contribution to the convergence power spectrum",
    "is given by the familiar result ( here @xmath276 is the comoving radial distance to the surface of last scatter ) : @xmath277 ( there are higher - order corrections to @xmath166 , but we do not consider them here since the purpose of this paper is to investigate lensing reconstruction , not to provide a precision theoretical computation of the lensing power spectra . clearly if a sufficiently high - precision measurement of @xmath278 is made , higher - order born corrections should be considered in the theoretical interpretation of the power spectrum . )",
    "the field rotation power spectrum is given to lowest order by : @xmath279 ^ 2 \\int_0^{\\chi_0 } d\\chi\\ , \\int_0^\\chi d\\chi'\\ ;   w(\\chi,\\chi_0)^2 w(\\chi',\\chi)^2 { \\cal c}^{\\psi\\psi}_{l'}(\\chi ) { \\cal c}^{\\psi\\psi}_{{{\\bf l}}-{{\\bf l}}'}(\\chi ' ) .",
    "\\label{eq : cross}\\ ] ] note that the lowest - order ( in the born expansion ) contribution to @xmath251 comes from the trispectrum of the density field .",
    "if the density field is non - gaussian and this non - gaussianity is insufficiently suppressed by the central limit theorem , then eq . ( [ eq : cross ] )",
    "will also contain a term from the connected trispectrum @xmath280 .",
    "however , because the factor @xmath281 in eq .",
    "( [ eq : lensomega ] ) vanishes as @xmath282 , it follows that the trispectrum components contributing to @xmath251 involve correlations between points at widely spaced radial coordinates , which are suppressed .",
    "( conceptually , this is because a single - screen lens only produces convergence and not field rotation , regardless of its gaussianity or lack thereof .",
    "thus if structures at different radial distances are independent , as assumed in the limber approximation , then there is no connected contribution to @xmath251 . )",
    "we have computed the field rotation power spectrum , eq .",
    "( [ eq : cross ] ) for our fiducial cosmology using an analytic approximation to the growth factor and a nonlinear mapping of the power spectrum @xcite .",
    "the results are plotted in fig .",
    "[ fig : omega](a ) .",
    "the effect of the field rotation on the lens reconstruction is to add an additional term to the cmb given by @xmath283 .",
    "the power spectrum of @xmath284 is given by : @xmath285 ^ 2 c_{l'}^{\\omega\\omega } c_{{{\\bf l}}-{{\\bf l}}'}^{tt } , \\nonumber \\\\",
    "c^{\\delta t\\delta e}_l = & & \\frac{1}{\\pi } \\sum_{{{\\bf l } } ' } { 1\\over { l'}^4 } [ \\star{{\\bf",
    "l}}'\\cdot({{\\bf l}}-{{\\bf l}}')]^2   c_{l'}^{\\omega\\omega } c_{{{\\bf l}}-{{\\bf l}}'}^{te } \\cos 2\\alpha , \\nonumber \\\\",
    "c^{\\delta e\\delta e}_l = & & \\frac{1}{\\pi } \\sum_{{{\\bf l } } ' } { 1\\over { l'}^4 } [ \\star{{\\bf l}}'\\cdot({{\\bf l}}-{{\\bf l}}')]^2   c_{l'}^{\\omega\\omega } \\left ( c_{{{\\bf l}}-{{\\bf l}}'}^{ee } \\cos^2 2\\alpha + c_{{{\\bf l}}-{{\\bf l}}'}^{bb } \\sin^2 2\\alpha \\right ) , \\nonumber \\\\",
    "c^{\\delta b\\delta b}_l = & & \\frac{1}{\\pi } \\sum_{{{\\bf l } } ' } { 1\\over { l'}^4 } [ \\star{{\\bf l}}'\\cdot({{\\bf l}}-{{\\bf l}}')]^2   c_{l'}^{\\omega\\omega } \\left ( c_{{{\\bf l}}-{{\\bf l}}'}^{ee } \\sin^2 2\\alpha + c_{{{\\bf l}}-{{\\bf l}}'}^{bb } \\cos^2 2\\alpha \\right ) , \\label{eq : cdx}\\end{aligned}\\ ] ] where @xmath286 .",
    "the field rotation is forbidden to have first - order correlations with the primary cmb and the convergence ( @xmath287 ) by parity ; higher - order correlations with the primary cmb will be highly suppressed because @xmath77 is determined by small - scale fluctuations in density along the line of sight with window function that vanishes at the last - scattering surface .",
    "there are non - vanishing higher - order correlations between @xmath74 and @xmath77 , but we do not investigate these here . [ but note that by reducing the conditional covariance @xmath288 , these correlations may enable us to reduce the `` noise '' due to field rotation further . ]",
    "the @xmath289 power spectrum [ fig .",
    "[ fig : omega](b ) ] shows that the @xmath77-induced modifications to the cmb @xmath0-modes are of the same order as instrument noise when the latter is reduced to @xmath290 @xmath1k arcmin .",
    "[ since we are trying to set @xmath6 , contamination in the @xmath0-modes is more serious for lensing than contamination in the @xmath5-modes ; this is made mathematically explicit by multiplication by @xmath202 in eq .",
    "( [ eq : u ] ) . ]",
    "since @xmath289 has vanishing first - order correlation with @xmath52 , one might conjecture that the field rotation begins to interfere with lensing when the noise @xmath45 is reduced to @xmath291 @xmath1k arcmin ; however , @xmath292 is highly non - gaussian and exhibits many higher - order correlations with @xmath52 , so we should be cautious of trusting this conjecture . in the simulations (",
    " [ sec : numer1 ] ) , we find that even for our reference experiment f with @xmath293 @xmath1k arcmin the field rotation does not significantly contaminate the reconstruction of the convergence field  it increases the mean squared error of the reconstruction by only @xmath294 15% .",
    "we conclude that ( at least at the level of the experiments considered here ) the field rotation is not a problem for lens reconstruction .",
    "having investigated the reconstruction of the lensing field , we turn our attention to the convergence power spectrum , or equivalently the potential power spectrum , since the two are related by @xmath295 . in this section , we will ignore any complications associated with the field rotation as these are likely to be small for near - term experiments . in ",
    "[ sec : cps ] , we integrate the likelihood function for the convergence to yield the `` grand likelihood function '' for the lensing power spectrum ; since this results in a functional integral over lens realizations , we simplify the problem by introducing a gaussian approximation . we make further approximations in  [ sec : estpow ] to yield an estimator that is suitable for actual computation .",
    "our basic approach , modeled after ref .",
    "@xcite , is to compute the grand likelihood function @xmath296 , which is a function of the lensing power spectrum : @xmath297 =   -\\ln \\int { \\cal d}\\kappa\\ ; e^{-\\wp(\\kappa)-{\\cal l}(\\kappa ) } = \\frac{1}{2 } \\ln\\det { \\bf c}^{\\kappa\\kappa } -\\ln \\int { \\cal d}\\kappa\\ ; \\exp\\left [ -\\frac{1}{2 } \\kappa^\\dagger{\\bf c}^{\\kappa\\kappa\\,-1}\\kappa - { \\cal l}(\\kappa ) \\right ] .",
    "\\label{eq : lint}\\ ] ] the objective of this section is to develop formalism to compute the minimum of @xmath296 . a `` practical '' version suitable for numerical computation will be given in ",
    "[ sec : estpow ] .",
    "the integral in eq .",
    "( [ eq : lint ] ) has one dimension for each lensing mode and hence can not be performed by any brute - force technique . in this situation the preferred solution is usually to use a markov chain ; unfortunately , the integral has of order @xmath298 dimensions , and the integrand is expensive to compute , hence eq .",
    "( [ eq : lint ] ) does not appear to be solvable by markov chains either .",
    "we therefore choose to approximate eq .",
    "( [ eq : lint ] ) as a gaussian , in which case the functional integral can be computed exactly : @xmath297 \\approx \\frac{1}{2 }",
    "\\ln\\det { \\bf c}^{\\kappa\\kappa } + \\frac{1}{2 } \\ln\\det [ { \\cal f}(\\kappa_\\ast)+{\\bf c}^{\\kappa\\kappa\\,-1 } ] + \\frac{1}{2 } \\kappa_\\ast^\\dagger{\\bf c}^{\\kappa\\kappa\\,-1}\\kappa_\\ast   + { \\cal l}(\\kappa_\\ast),\\ ] ] where @xmath299 is the point where @xmath300 is minimized , and @xmath301 is the curvature matrix , eq .",
    "( [ eq : curvaturematrix ] ) , evaluated at the lens configuration @xmath302 .    a grand likelihood gradient @xmath303",
    "can then be defined : @xmath304 + \\frac{1}{2 } { { \\rm tr}}\\left [ ( { \\cal f}(\\kappa_\\ast ) + { \\bf c}^{\\kappa\\kappa\\,-1})^{-1 } \\left ( { \\partial{\\cal f}(\\kappa_\\ast)\\over\\partial c^{\\kappa\\kappa}_l } -   { \\bf c}^{\\kappa\\kappa\\,-1 } { \\partial{\\bf c}^{\\kappa\\kappa}\\over\\partial   c^{\\kappa\\kappa}_l } { \\bf c}^{\\kappa\\kappa\\,-1 } \\right ) \\right ] \\nonumber\\\\ & & - \\frac{1}{2 } \\kappa_\\ast^\\dagger{\\bf c}^{\\kappa\\kappa\\,-1 }   { \\partial{\\bf c}^{\\kappa\\kappa}\\over\\partial c^{\\kappa\\kappa}_l } { \\bf c}^{\\kappa\\kappa\\,-1}\\kappa_\\ast + { \\partial{\\cal l}(\\kappa_\\ast)\\over\\partial c^{\\kappa\\kappa}_l } \\nonumber\\\\ & & + { \\partial \\kappa_\\ast\\over \\partial c^{\\kappa}_l } \\left.\\left\\ { { { \\rm tr}}\\left [ ( { \\cal f}(\\kappa)+{\\bf c}^{\\kappa\\kappa\\,-1})^{-1 }   { \\partial{\\cal f}(\\kappa)\\over\\partial \\kappa } \\right ] + { \\partial\\over\\partial\\kappa } \\left ( \\frac{1}{2 } \\kappa^\\dagger{\\bf c}^{\\kappa\\kappa\\,-1}\\kappa + { \\cal l}(\\kappa ) \\right ) \\right\\ } \\right|_{\\kappa=\\kappa_\\ast}. \\label{eq : gamma0}\\end{aligned}\\ ] ] note that @xmath305 , and hence @xmath301 , do not depend on @xmath166 except implicitly through @xmath299 . also , if we use that @xmath299 is the maximum of @xmath306 with respect to @xmath74 , we find that the final derivative with respect to @xmath74 in this equation vanishes .",
    "we further note that @xmath307 is simply the projection operator onto the @xmath49 representation of @xmath308 , i.e. in harmonic space it has 1 s as diagonal elements with multipole @xmath49 and 0 s everywhere else . defining @xmath309 to be the number of modes of multipole @xmath49 (",
    "note that on the sphere , @xmath310 ) , this allows us to simplify eq .",
    "( [ eq : gamma0 ] ) to : @xmath311_{{{\\bf l}},{{\\bf l } } } } { 2c_l^{\\kappa\\kappa\\,2 } } - \\sum_{{{\\bf l}}:\\,|{{\\bf l}}|=l } { |\\kappa_{\\ast\\,{{\\bf l}}}|^2\\over 2 c^{\\kappa\\kappa\\,2}_l } + { \\partial \\kappa_\\ast\\over \\partial c^{\\kappa\\kappa}_l } { { \\rm tr}}\\left [ ( { \\cal f}(\\kappa_\\ast)+{\\bf c}^{\\kappa\\kappa\\,-1})^{-1 } \\left",
    ". { \\partial{\\cal f}(\\kappa)\\over\\partial   \\kappa } \\right|_{\\kappa_\\ast } \\right ] .",
    "\\label{eq : gamma}\\ ] ] here the sums are over all modes @xmath20 of multipole @xmath49 .",
    "it sometimes occurs that we wish to estimate the lensing power spectrum not by estimating the individual @xmath278 , but rather by `` binning '' the power spectrum .",
    "this is useful if , e.g. the @xmath312 per multipole is low or if the partial - sky nature of a survey causes confusion between power in neighboring multipoles . in this case , we introduce `` basis functions '' @xmath313 for the lensing power spectrum : @xmath314 the coefficients @xmath315 are now to be estimated .",
    "the maximum - likelihood estimator is then the choice of @xmath315 that satisfies : @xmath316      ideally , we would like to implement the maximum - likelihood estimator for the coefficients @xmath315 , i.e. eq . ( [ eq : mmuest ] ) . unfortunately",
    ", this involves setting to zero some linear combination of the @xmath303 s given by eq .",
    "( [ eq : gamma ] ) , which is a highly non - trivial task .",
    "we therefore take the approximation that the curvature matrix @xmath228 does not depend on @xmath74 , then @xmath303 is seen to depend only on the quantities @xmath166 and : @xmath317 which explicitly depends on @xmath166 but is also implicitly a function of @xmath166 through its dependence on @xmath299 .",
    "note that the functional form of @xmath303 is @xmath318 .",
    "( [ eq : mmuest ] ) then reads : @xmath319 = \\gamma_\\mu^{(0)}(c_\\nu ) - v_\\mu(c_\\nu),\\ ] ] where we have defined @xmath320 .",
    "we are thus attempting to solve @xmath321 , but @xmath322 is some complicated function of the convergence power spectrum coefficients @xmath323 .",
    "we solve this problem by approximating @xmath324}$ ] , i.e. the expected value of @xmath325 where the lss realizations are drawn from a lensing convergence power spectrum @xmath326 .",
    "we therefore use the estimator : @xmath327}\\;\\;\\;\\forall\\mu .",
    "\\label{eq : v}\\ ] ]    eq .",
    "( [ eq : v ] ) is somewhat abstract , so we clarify its meaning here .",
    "the statistic @xmath325 is proportional to the power spectrum of the iterative convergence estimator obtained by solving eq .",
    "( [ eq : estcon ] ) ; this depends on the prior power spectrum @xmath328 as well as on the data .",
    "the solution @xmath323 to eq .",
    "( [ eq : v ] ) is the set of power spectrum coefficients for which @xmath329 equals its expected value ( which is most easily determined via monte carlo simulation ) .",
    "this approach has the advantage of `` calibrating out '' the noise biases discussed by ref .",
    "( note that some convergence modes  those corresponding to large eigenvalues of the curvature @xmath228  are reconstructed better than others .",
    "what is especially useful about @xmath329 , or equivalently the power spectrum of the iterative estimator , is that the iterative estimator filters out the poorly reconstructed modes .",
    "thus the convergence modes that are reconstructed more accurately are weighted more heavily in determining @xmath329 and hence in determining the convergence power spectrum . )    finally , we wish to determine the uncertainty on the solution @xmath323 to eq .",
    "( [ eq : v ] ) .",
    "if we average over many convergence modes , then this uncertainty should be given by the inverse of the grand fisher matrix @xmath330 for power spectrum determination : @xmath331 i.e. @xmath330 is the covariance matrix of @xmath329 .",
    "if the _ reconstructed _ convergence @xmath299 can be approximated as a gaussian random field ( which is true in the case where the reconstruction has high signal - to - noise ratio since in this case the @xmath332 , which is gaussian because @xmath74 is produced by many lss fluctuations along the line of sight ) , then we can take the gaussian approximation to eq .",
    "( [ eq : grandfisher ] ) .",
    "this is obtained by considering the covariance of @xmath333 according to eq .",
    "( [ eq : vl ] ) and using wick s theorem ; this yields : @xmath334 we remind the reader once again that the approximation eq . ( [ eq : gfgauss ] ) to the power spectrum estimation uncertainty is only valid if the reconstructed convergence field @xmath299 is approximately gaussian .",
    "if @xmath299 has a significant trispectrum when averaged over lss+cmb+noise realizations , then eq . ( [ eq : grandfisher ] ) must be used instead .",
    "this is only a problem in the low signal - to - noise ( high @xmath49 ) regime in which lensing modes can not be reconstructed individually and their power is only statistically detected .",
    "a simulated reconstruction of the lensing convergence using polarization and reference expt .",
    "c parameters . in the left panel",
    ", we display the realization of the convergence field @xmath74 used to produce the simulated cmb .",
    "the reconstructions using the wiener - filtered quadratic estimator and the iterative estimator are shown in the center and right panels , respectively .",
    "these frames are each @xmath335 in angular width , corresponding to 1/16 of the simulated area ; the scale ranges from black ( diverging , @xmath336 ) through white ( converging , @xmath337 ) .",
    "although all lensing multipoles up to @xmath338 are simulated , we have only displayed the @xmath339 modes in these figures for clarity .",
    "field rotation was neglected in the calculations for this figure.,width=662 ]    throughout our derivation of lensing and tensor power estimators , we have made various approximations that should be tested . the most robust way to do",
    "this is to conduct a numerical simulation of the cmb and lensing field , and then construct lensing estimators , comparing the error to the theoretical estimates of eqs .",
    "( [ eq : fphi ] ) and ( [ eq : qfisher ] ) . in all cases",
    ", we have used a flat sky with toroidal boundary conditions .",
    "we will only simulate the cmb polarization here ; formally , the polarization - only estimators are obtained by setting @xmath340 in the relevant equations .",
    "the simplest simulations involve reconstruction of the convergence @xmath74 .",
    "we generate simulated cmb @xmath33 , @xmath34 , @xmath35 , and @xmath74 fields on a @xmath341 square patch of sky with resolution @xmath342 arcmin per pixel ( @xmath343 pixels ) ; lens the simulated cmb ; and add appropriate noise .",
    "we wish to compare the quadratic estimator , eq .",
    "( [ eq : wfquad ] ) with our new estimator , eq .",
    "( [ eq : estcon ] ) .",
    "the former is relatively straightforward to compute ; the latter requires that we apply the methods of  [ sec : estcon ] .",
    "we simulate gaussian random realizations of the @xmath34 , @xmath35 , and @xmath74 fields , perform the lensing re - mapping , and add appropriate noise .",
    "we then compute the estimators of eqs .",
    "( [ eq : wfquad ] ) and ( [ eq : estcon ] ) .",
    "there are two tricks that are very useful in numerical computation of these estimators : first , simultaneous computation of inner products @xmath344 for all @xmath20 ; and second , stochastic trace computation .",
    "we discuss each of these here .",
    "the simultaneous computation of inner products was introduced by refs .",
    "@xcite in order to compute quadratic estimators .",
    "a general version of this is ( on a flat sky ; see ref .",
    "@xcite for an all - sky version ) : @xmath345 .",
    "\\label{eq : tutrick}\\ ] ] ( note that this equation requires that @xmath346 and @xmath347 be written in the @xmath28 basis since @xmath5 and @xmath0 have different transformation properties under lensing .",
    "also the asterisk on @xmath348 is of course unnecessary if @xmath346 is a real field . )",
    "if @xmath346 and @xmath347 are expressed in real - space , then the right - hand side is easily evaluated .",
    "the quantities @xmath349 are then obtained via a fast fourier transform ; division then trivially removes the @xmath100 .",
    "there is a zero - wavenumber mode corresponding to @xmath350 which presents a problem for division .",
    "here we simply set this convergence mode to zero ; in the complete all - sky treatment this would be justified by noting that the convergence is @xmath351 times the divergence of the deflection angle vector , hence @xmath352 and so @xmath353 .",
    "[ there is a corresponding trick for the field rotation : eq .",
    "( [ eq : tutrick ] ) remains valid if we make the replacements @xmath354 and @xmath355 . ]    the trace in eq .",
    "( [ eq : estcon ] ) is most easily evaluated stochastically : if we generate a random noise vector @xmath156 with covariance @xmath137 , then the trace is equal to the expectation value : @xmath356 = \\langle ( \\hat{\\bf c}_{(0,0)}^{-1 } \\lambda_g^{-1 } \\eta)^\\dagger   \\sigma^\\kappa_{{\\bf l}}{\\bf c } \\hat{\\bf c}_{(0,0)}^{-1 } \\lambda_g^{-1 } \\eta \\rangle .",
    "\\label{eq : stochastictrace}\\ ] ] if this monte carlo method is used to compute the trace , then the monte carlo error in its computation for one realization of @xmath156 is less than or equal to the instrument noise contribution to the uncertainty on the right - hand side of eq .",
    "( [ eq : estcon ] ) .",
    "[ this is because the right - hand side of eq .",
    "( [ eq : estcon ] ) is a quadratic function of @xmath55 , with covariance @xmath357 , which is greater than the noise covariance @xmath137 along all directions .",
    "] since the monte carlo error variance scales as the reciprocal of the number of realizations of @xmath156 used , it follows that of order a few realizations of @xmath156 are sufficient in evaluating eq .",
    "( [ eq : stochastictrace ] ) .",
    "in fact for the reference experiments described here , we find that there is little gain in taking more than one realization of @xmath156 .",
    "we solve eq .",
    "( [ eq : estcon ] ) using the iterative procedure : @xmath358_{-{{\\bf l}},-{{\\bf l } } ' } c^{\\kappa\\kappa}_{l ' } \\left\\ { ( \\hat{\\bf c}_{(0,0)}^{-1 } \\lambda_g^{-1}\\hat{\\bf x})^\\dagger \\sigma^\\kappa_{{{\\bf l } } ' } { \\bf c } \\hat{\\bf c}_{(0,0)}^{-1 } \\lambda_g^{-1}\\hat{\\bf x } - { { \\rm tr}}\\left [ \\lambda_g^{\\dagger\\,-1}\\hat{\\bf c}_{(0,0)}^{-1 } \\sigma^\\kappa_{{{\\bf l } } ' } { \\bf c } \\hat{\\bf c}_{(0,0)}^{-1 } \\lambda_g^{-1 } { \\bf n } \\right ] \\right\\ } + ( 1-\\zeta_l ) \\kappa_{n,{{\\bf l}}}^\\ast .",
    "\\label{eq : iter}\\ ] ] here @xmath63 is the lens configuration with convergence @xmath74 and no rotation : @xmath359 , and the @xmath360 are convergence parameters ; we choose them to be : @xmath361 where @xmath362 is a constant satisfying @xmath363 .",
    "it is found that the wiener - filtered quadratic estimator , eq .",
    "( [ eq : wfquad ] ) , is a good choice for initializing this iteration .",
    "the choice of @xmath362 is an intricate issue : if it is set too small , the rate of convergence of the iteration becomes unacceptably slow ; if it is set too high , the iteration can fail to converge entirely .",
    "the convergence can be understood by approximating eq .",
    "( [ eq : iter ] ) as linear in @xmath364 : @xmath365_{{\\bf l}}+ ( 1-\\zeta_l)\\kappa_{n,{{\\bf l}}};\\ ] ] here we have approximated the response matrix of the likelihood gradient using the curvature matrix .",
    "then the requirement for convergence is that all of the ( possibly complex ) eigenvalues of the matrix : @xmath366 lie within the unit circle .",
    "note that , averaged over cmb+noise realizations , @xmath367 , and hence @xmath368 ; hence we conclude that the iterative procedure should be convergent for @xmath363 in the absence of curvature corrections . in reality , very small values of @xmath362 may be necessary for convergence , especially in cases where curvature corrections are large . since @xmath369 is positive definite at the maximum posterior probability point , there is always a positive value of @xmath362 that results in convergence .",
    "the cases in which the small values of @xmath362 are required are those in which curvature corrections are large ; we have found from our simulations that these are the low - noise experiments .",
    "convergence is generally found to be faster for the high @xmath49 convergence modes .",
    "one problem we have encountered is that for experiments with low noise and wide beam ( @xmath189 arcmin ) , the iterative estimator given by eq .",
    "( [ eq : iter ] ) is unstable .",
    "this instability arises because the noise @xmath370 is strongly blue ; hence the de - lensing operation @xmath371 in eq .",
    "( [ eq : iter ] ) mixes high - multipole noise down to lower multipoles where it disrupts the lensing estimation .",
    "this problem is in principle solvable by using the correct @xmath372 weight function in place of @xmath373 in eq .",
    "( [ eq : ape2b ] ) .",
    "however , since this occurs in a regime where the iterative approach does not improve upon the quadratic estimator approach anyway , we recommend simply using the quadratic estimator for wide - beam experiments .",
    "we illustrate by considering the reconstruction of lensing using reference experiments a  f .",
    "the residual error in the reconstructed convergence @xmath231 , as measured by computing the power spectrum of the difference @xmath374 between input and reconstructed convergence maps , is shown in fig .",
    "[ fig : ckappa ] for both quadratic and iterative estimators . for",
    "the iterative estimator applied to ref .",
    "c , we set @xmath375 in eq .",
    "( [ eq : iter ] ) , used three realizations of the @xmath156 field in eq .",
    "( [ eq : stochastictrace ] ) , and performed 64 iterations .",
    "f has a lower noise level and so it is necessary to use the smaller convergence parameter @xmath376 ; the convergence is thus slower and we used 256 iterations . ref .",
    "a has a higher noise level and so we can use @xmath377 and 24 iterations .",
    "maps of the input and reconstructed convergence fields for the ref .",
    "c reconstruction are shown in fig .",
    "[ fig : refc ] . the dependence of the iterative estimator reconstruction accuracy on noise @xmath45 and beam size ( fwhm ) @xmath42 is shown in fig .",
    "[ fig : ckappa2 ] .",
    "we have also displayed in fig .",
    "[ fig : ckappa2 ] the ( theoretical ) reconstruction error curves for the quadratic estimator in the absence of instrument noise .",
    "these curves represent the fundamental limit to the reconstruction accuracy possible with quadratic estimators ; it is readily seen that the iterative estimator can do better if noise is low ( @xmath378@xmath342 @xmath1k arcmin , depending on the range of @xmath49 considered ) .",
    "[ note that we display @xmath166 in these plots , whereas some authors have displayed instead @xmath379 , where @xmath380 is the deflection angle .",
    "the two are related by @xmath381 . ]",
    "the accuracy of reconstruction can also be represented by the correlation coefficient @xmath382 .",
    "the correlation coefficient is the figure of merit if the objective is to cross - correlate the convergence from cmb lensing with another tracer of the density ( e.g. weak lensing of galaxies ) , since the signal - to - noise ratio of the cross - correlation is determined by @xmath383 .",
    "we have plotted the correlation coefficient in fig .",
    "[ fig : fcorr ] for the various reference experiments .",
    "the iterative estimator offers improved reconstruction , especially for the lower - noise experiments ( c  f ) .    up until this point",
    "we have neglected the field rotation @xmath77 ; we should verify that this is justified .",
    "we do this by introducing field rotation with power spectrum given by eq .",
    "( [ eq : cross ] ) as computed in ",
    "[ sec : effect ] with normalization @xmath384 .",
    "we then compare the performance of the iterative estimator , eq .",
    "( [ eq : iter ] ) , with and without the field rotation .",
    "the comparison is shown in fig .",
    "[ fig : omegaeff ] ; it is seen that the field rotation increases the mean squared error of the reconstruction by only @xmath294 5% for ref .",
    "e ( 0.5 @xmath1k arcmin noise , 2 arcmin beam ) and @xmath294 15% for ref .",
    "f ( 0.25 @xmath1k arcmin noise , 2 arcmin beam ) .    as a final note",
    ", we find that for low noise levels , a large number of iterations is required because our iterative process is ill - conditioned . indeed",
    ", it is possible that there are eigenvalues of @xmath385 that are so close to unity that their corresponding modes have not converged even after tens or hundreds of iterations ; if this is the case , then it should be possible to improve upon our results by increasing the number of iterations , or by finding an iterative scheme that converges faster than eq .",
    "( [ eq : iter ] ) .",
    "this is allowed by the fisher matrix noise limits , which are significantly lower than the achieved noise levels ( see fig .",
    "[ fig : ckappa ] ) .",
    "we consider this possibility unlikely since we tried increasing the number of iterations in several of the simulations and found little improvement .",
    "additionally , modes with eigenvalue @xmath386 close to unity correspond to flat directions of the curvature matrix @xmath228 [ see eq . ( [ eq : rll ] ) ] ; such directions , however , can not be reconstructed accurately regardless of how many iterations are used .",
    "we compute the lensing power spectrum from simulated data by solving eq .",
    "( [ eq : v ] ) .",
    "the approach , once again , is iterative : we adjust the power spectrum @xmath166 until @xmath387 .",
    "[ note that both the left and right sides of eq .",
    "( [ eq : v ] ) depend on @xmath166 . ]",
    "we will attempt here to compute the binned power spectrum , i.e. we choose a basis for the convergence power spectrum given by : @xmath388 where @xmath389 is the bin width and @xmath1 ranges from 0 through @xmath390 .",
    "we are thus attempting to reconstruct the power spectrum in @xmath391 bins , equally spaced out to maximum multipole @xmath392 .    our iterative algorithm for solving eq .",
    "( [ eq : v ] ) is :    @xmath393 } } \\left ( \\frac { v_\\mu(c_{\\nu , n } ) }   { \\langle v_\\mu(c_{\\nu , n})\\rangle_{lss[c_{\\nu , n } ] } } - 1\\right ) \\right]^{\\zeta_{(p ) } } , \\label{eq : poweriter}\\ ] ]    where @xmath394 represents the iteration number , and @xmath395 is the number of modes that fall into the @xmath1th band .",
    "it is readily apparent that the final values @xmath396 will satisfy @xmath397 .    in order to compute the convergence power spectrum estimator , the expected value @xmath398}$ ]",
    "must be determined ; the simplest method for doing this is via monte carlo simulations . since in the end",
    "we are solving the equation @xmath397 , we want to make sure that the monte carlo - induced error in the right - hand side of this equation is small compared with the statistical error in the left - hand side ( which depends only on the data and on @xmath399 ) .",
    "it is trivial to see that after @xmath400 monte carlo simulations , the variance in determination of the right - hand side is @xmath401 of the statistical variance in the left - hand side .",
    "therefore , we expect that if we use @xmath400 monte carlo simulations to determine @xmath402 , then the variance of our determination of the convergence power spectrum will increase by a factor of @xmath403 . a reasonable choice ,",
    "then , is to take @xmath404 , which results in 15% increase in the variance of the power spectrum estimator over the case of @xmath405 ( exact computation of @xmath402 ) . the uncertainty in the power spectrum estimation",
    "can then be estimated from eq .",
    "( [ eq : grandfisher ] ) with the correction for @xmath400 : @xmath406 ( note that this is the standard gaussian formula for error bars , except that it is corrected for @xmath400 and is written in terms of the filtered power spectrum @xmath407 instead of the noise power . )    in fig .",
    "[ fig : clkk](a ) , we show a determination of the convergence power spectrum from simulated data using ref .",
    "c noise parameters .",
    "the choice of bins was @xmath408 , @xmath409 , @xmath410 , and the survey area was @xmath411 steradians ( @xmath412 arcmin @xmath413 @xmath412 arcmin , with toroidal periodic boundary conditions ) .",
    "we initialized the power spectrum estimation with the white spectrum @xmath414 , corresponding to @xmath415 .",
    "we used @xmath416 for the first two iterations of eq .",
    "( [ eq : poweriter ] ) , which are sufficient to bring the estimated power spectrum @xmath417 to the correct order of magnitude . once this `` ballpark '' estimation has been completed , we used @xmath418 for the subsequent ( @xmath419 ) iterations .",
    "an examination of fig .",
    "[ fig : clkk](a ) shows that the power spectrum estimator eq .",
    "( [ eq : poweriter ] ) has been successful in reproducing the qualitative features of the power spectrum ; however , the power has evidently been overestimated at the high-@xmath49 end .",
    "we can perform a quantitative analysis of the performance of the power spectrum estimator using the @xmath130 test , using the gaussian error estimate of eq .",
    "( [ eq : gf - sigma ] ) .",
    "the @xmath130 value for the @xmath420 region ( where the power spectrum determination should be cosmic - variance limited ) is @xmath421 for @xmath422 degrees of freedom ( @xmath423 ) , indicating that eq . ( [ eq : gf - sigma ] ) appears to be giving a reasonable estimate of the uncertainty on the power spectrum .",
    "the same is not true of the high-@xmath49 region @xmath424 , for which we compute @xmath425 for 12 degrees of freedom ( @xmath426 ) .",
    "it is readily apparent from fig .",
    "[ fig : clkk ] that the failure of the @xmath130 test is due to an upward bias in the power spectrum estimator eq .",
    "( [ eq : poweriter ] ) .",
    "this bias occurs because , regardless of @xmath315 , our power spectrum estimator assumes that there is no convergence power at @xmath427 .",
    "however , it still detects the @xmath0-modes induced by this short - wavelength convergence power , and introduces excess convergence power at @xmath428 to reproduce these @xmath0-modes  hence @xmath166 is overestimated .",
    "this bias can be removed by either estimating the modes to higher @xmath49 or including the aliasing of power from those modes into the modes we estimate as an additional source of noise @xcite .",
    "this explanation of the upward bias is confirmed by fig .",
    "[ fig : clkk](b ) , in which we have artificially `` turned off '' the lensing effect for convergence modes at @xmath427 , then produced a simulated data set and applied the power spectrum estimator eq .",
    "( [ eq : poweriter ] ) . in order to make the comparison between the original simulation and the restricted ( i.e. short - wavelength lensing turned off ) simulation as simple as possible",
    ", we have used the same cmb , noise , and lss realizations for both .",
    "one can see by comparing figs .",
    "[ fig : clkk](a ) and [ fig : clkk](b ) that there is little effect at low @xmath49 , where the power spectrum estimation is limited by cosmic variance",
    ". however , at high @xmath49 , one can see that the bias present in the original simulation has disappeared in the restricted simulation , thereby confirming that the bias was due to high-@xmath49 convergence power .",
    "the @xmath130 for the @xmath424 range has been reduced to @xmath429 ( 12 degrees of freedom , @xmath430 ) , which is still indicative of underestimation of the uncertainty in the @xmath315 .",
    "thus we conclude that in this regime , either the gaussian error estimate eq .",
    "( [ eq : gf - sigma ] ) is underestimating the error by a factor of @xmath431 , or the error bars are correlated , or the iteration of eq .",
    "( [ eq : poweriter ] ) has not completely converged .    in a real lensing experiment ,",
    "the underlying primary power spectrum @xmath432 is unknown and only the lensed power spectrum is directly observable ( and even our knowledge of this is limited by instrument noise and cosmic variance ) .",
    "thus a slightly more complicated version of the above analysis will be necessary to simultaneously solve for @xmath432 and @xmath166 .",
    "( although since in the regime we are examining , @xmath433 , the @xmath5 power spectrum is dominated by primary anisotropies rather than lensing , we do not expect a degeneracy between these two quantities . )",
    "it will also be necessary to estimate the convergence power spectrum well beyond the region of interest in order to avoid the upward bias described here .",
    "since the signal - to - noise ratio at high @xmath49 is low , it will be necessary to use wider bins ( i.e. larger @xmath389 ) in this region .",
    "the choice of exactly which bins to use must be determined by the characteristics of the specific experiment .",
    "weak gravitational lensing of the cmb allows us to reconstruct the ( projected ) mass distribution in the universe , thereby probing large - scale structure and its power spectrum . since the window functions for lensing peak at redshift @xmath256 of order unity , lensing offers the possibility of using the cmb to study the low - redshift universe .",
    "`` cleaning '' of lensing from cmb maps is potentially valuable for studying the primary cmb , particularly for inflationary gravitational wave searches using the low-@xmath49 @xmath0-mode polarization @xcite . since the primary cmb polarization is expected to contain only @xmath5-modes on the relevant angular scales ( @xmath49 of order @xmath434 ) , while lensing transfers some of the cmb polarization power into @xmath0-modes @xcite , all @xmath0-modes that we see on these scales are due to lensing ( or foregrounds ) .",
    "thus the cmb @xmath0-mode polarization allows much better lensing reconstruction than is possible using temperature data alone .",
    "it is thus of interest to consider optimal methods of reconstructing the lensing field from cmb polarization data ; in this paper , we have investigated this problem in detail and improved significantly on the previous quadratic estimator methods @xcite .",
    "we have shown that this improvement can be up to an order of magnitude in mean squared error over the zero - noise reconstruction error for the quadratic estimator .",
    "we make several comments concerning the present calculations .",
    "first of all , our lensing estimator , eq .",
    "( [ eq : wf ] ) , while statistically superior to the quadratic estimator , still does not achieve the cramer - rao bound on reconstruction accuracy .",
    "we have argued that this results in part from `` curvature corrections , '' fluctuations in the curvature matrix that render the cramer - rao bound impossible to achieve ( more generally , this should also serve as a warning against blindly assuming that the statistical errors in any measurement are given by @xmath217 . ) .",
    "we expect that our lensing reconstruction estimator is near - optimal since it is an approximation to the maximum - likelihood estimator and our iterative estimator shows no signs of incomplete convergence , however the possibility of further improvement has not been ruled out .",
    "secondly , we have assumed negligible primary @xmath0 mode polarization here ( although the formalism described herein is trivially modified to include significant primary @xmath0-modes , the results would be qualitatively different ) . in the absence of vector or tensor perturbations ,",
    "this is correct ; if vector or tensor perturbations are present , then one must consider their effect on lensing reconstruction . in the case of inflationary gravitational waves ,",
    "primary @xmath0-modes are generated mostly on very large angular scales ; the arcminute - scale anisotropies used for lensing reconstruction are uncontaminated @xcite .",
    "( formally , if we were doing a lensing reconstruction with the objective of cleaning lensing contamination of the tensor - induced reionization bump at @xmath435 , we would set @xmath436 for @xmath435 so that the lensing reconstruction does not remove tensor @xmath0-modes . ) a more rigorous investigation of the effect on inflationary gravitational wave searches is deferred to future work .",
    "thirdly , the real cmb is contaminated by foregrounds ",
    "an important issue for all cmb anisotropy experiments .",
    "one advantage of using cmb polarization for lensing reconstruction is that whereas the small - scale cmb temperature field is heavily contaminated by scattering - induced secondary anisotropies such as the thermal and kinetic sunyaev - zeldovich effects , ostriker - vishniac effect , and patchy reionization , these effects are much smaller for polarization @xcite .",
    "however , polarized point sources and galactic foregrounds are still a serious concern .",
    "these have very different frequency dependence than the blackbody fluctuations characteristic of the cmb , and this property has been exploited to remove them ; unfortunately , their fluctuation spectrum , degree of polarization , non - gaussianity , and variations in frequency dependence are poorly understood .",
    "galactic foregrounds do not correlate with the cosmological signals , and in this sense the residuals from their subtraction act like instrument noise contaminating the @xmath0-mode ( and , to a lesser extent , @xmath5-mode ) polarization .",
    "the foreground power spectrum is likely to be different from that of instrument noise and is variable across the sky ; nevertheless , if the covariance matrix of the foregrounds ( or residuals after foreground subtraction ) can be determined , then we can add the foreground covariance to the instrument noise covariance matrix @xmath137 . (",
    "if the statistical properties of the foreground residuals can not be determined or at least constrained , then any cosmological analysis is pointless regardless of the methods used . )",
    "polarized point sources produce poisson noise ; also since many of them are extragalactic , one could be concerned about their correlation with lss and hence the lensing signal .",
    "we leave a detailed study of foregrounds and their impact on lensing reconstruction to future investigation .",
    "we note that the predicted levels of foreground contamination from dust and synchrotron galactic emission are at a level of a few @xmath1k arcmin prior to any frequency cleaning @xcite , comparable to the noise levels discussed here .",
    "frequency cleaning should reduce this , at the expense of amplifying instrument noise .",
    "if foreground removal is inadequate , this may result in anomalies in the final results such as unphysical correlations between the convergence maps and cmb polarization , variation of the convergence power spectrum between `` clean '' and `` dirty '' portions of the sky , correlation of the convergence maps with synchrotron or dust emission , etc .    in summary",
    ", we have shown that taking into account the full likelihood function allows improved reconstruction of the lensing of the cmb polarization field over that achieved by quadratic statistics . for purposes of computing the lensing power spectrum or cross - correlating cmb lensing with another tracer of the cosmological density field ,",
    "the most important improvement is at high @xmath49 where earlier approaches do not reconstruct the convergence at high signal - to - noise .",
    "( at low @xmath49 , the reconstruction is already cosmic variance limited . )",
    "if one s objective is to clean out the lensing effect in search of primordial gravitational waves , then the relevant quantity is the residual error in the reconstruction , and it is important to reduce this even if the convergence has been mapped at high signal - to - noise ; hence improvement at all multipoles is useful . we conclude that the likelihood - based estimators developed here offer the best prospective so far to extract the full amount of information from future high - resolution cmb polarization experiments .",
    "we would like to thank wayne hu and lyman page for useful comments .",
    "c.h . acknowledges useful discussions with mike kesden , asantha cooray , and marc kamionkowski .",
    "is supported by the nasa graduate student research program , grant no .",
    "ntgt5 - 50383 . u.s . acknowledges support from packard and sloan foundations , nasa nag5 - 11983 and nsf career-0132953 .",
    "in our simulations , we have compared the error of our iterative estimator , eq .",
    "( [ eq : estcon ] ) , with that of the quadratic estimator , eq .",
    "( [ eq : wfquad ] ) . here",
    "we show that the latter estimator corresponds to the optimally weighted quadratic estimator , as proposed by ref .",
    "statistically isotropic noise is assumed throughout .",
    "we begin by expanding eq .",
    "( [ eq : qfisher ] ) using the formula for @xmath437 given by eq .",
    "( [ eq : fl ] ) .",
    "the off - diagonal elements vanish by symmetry , while the diagonal elements are : @xmath438_{-{{\\bf l}}_1,{{\\bf l}}_2 } [ \\langle\\hat{\\bf c}\\rangle_{lss}]_{l_2}^{-1 } [ { \\bf f}^\\kappa_{{\\bf l}}]_{{{\\bf l}}_2,-{{\\bf l}}_1 } [ \\langle\\hat{\\bf c}\\rangle_{lss}]_{l_1}^{-1}\\right\\ } , \\label{eq : h1}\\ ] ] where we have defined @xmath439 , and the inverses are @xmath440 matrix inverses ( using the @xmath103 basis ) .",
    "next we note that to first order in @xmath74 , the correlation between two fourier modes of temperature or polarization is :    @xmath441_{{{\\bf l}}_1,-{{\\bf l}}_2 } \\kappa_{{\\bf l}}+ o(\\kappa^2).\\ ] ]    a general quadratic estimator for the convergence @xmath74 is then constructed as : @xmath442_{-{{\\bf l}}_2,{{\\bf l}}_1 } \\hat{\\bf x}_{{{\\bf l}}_1 } , \\label{eq : xi}\\ ] ] where @xmath443 is the weight matrix , which we assume without loss of generality to be hermitian ( since the anti - hermitian part does not contribute to @xmath444 ) .",
    "we further require it to satisfy @xmath445_{-{{\\bf",
    "l}}_2,{{\\bf l}}_1 } = [ \\xi_{{\\bf",
    "l}}]_{{{\\bf l}}_2,-{{\\bf l}}_1}^\\dagger$ ] .",
    "( this guarantees that the estimate @xmath231 is a real field . )",
    "we can construct the optimally weighted unbiased ( to first order ) estimator for @xmath74 by minimizing the variance of the estimator ( neglecting the trispectrum contribution ) : @xmath446_{l_2 } [ \\xi_{-{{\\bf l}}}]_{-{{\\bf l}}_2,{{\\bf l}}_1 } [ \\langle\\hat{\\bf c}\\rangle_{lss}]_{l_1 } [ \\xi_{{\\bf l}}]_{{{\\bf l}}_1,-{{\\bf l}}_2 } \\right\\ } , \\label{eq : v1}\\ ] ] subject to the constraint that the estimator be unbiased to first - order ( i.e. have unit response ) : @xmath447_{{{\\bf l}}_1,-{{\\bf",
    "l}}_2 }   [ \\xi_{-{{\\bf l}}}]_{-{{\\bf l}}_2,{{\\bf l}}_1 } \\right\\}. \\label{eq : v2}\\ ] ] we may compute the minimum of eq . ( [ eq : v1 ] ) constrained by eq .",
    "( [ eq : v2 ] ) using the method of lagrange multipliers .",
    "the equation @xmath448 becomes :    @xmath449_{l_2 } [ \\delta\\xi_{-{{\\bf l}}}]_{-{{\\bf l}}_2,{{\\bf l}}_1 } [ \\langle\\hat{\\bf c}\\rangle_{lss}]_{l_1}[\\xi_{{\\bf l}}]_{{{\\bf l}}_1,-{{\\bf l}}_2}+ \\frac{1}{\\lambda } [ { \\bf f}^\\kappa_{{\\bf l}}]_{{{\\bf l}}_1,-{{\\bf l}}_2 } [ \\delta\\xi_{-{{\\bf",
    "l}}}]_{-{{\\bf l}}_2,{{\\bf l}}_1 } \\right\\ } = 0.\\ ] ]    the solution to this ( allowing @xmath450 to be arbitrary ) is : @xmath451_{-{{\\bf l}}_2,{{\\bf l}}_1 } = { 1 \\over 2\\lambda }   [ \\langle\\hat{\\bf c}\\rangle_{lss}]_{l_2}^{-1 } [ { \\bf f}^\\kappa_{{\\bf l}}]_{{{\\bf l}}_2,-{{\\bf l}}_1 }   [ \\langle\\hat{\\bf c}\\rangle_{lss}]_{l_1}^{-1}. \\label{eq : xisol}\\ ] ] the correct normalization @xmath452 is obtained by substitution into eq .",
    "( [ eq : v2 ] ) ; it is easily seen to be @xmath453 .",
    "the variance of this estimator in the absence of lensing , determined by substitution into eq .",
    "( [ eq : v1 ] ) , is @xmath454 .",
    "the quadratic estimator we have used , eq .",
    "( [ eq : wfquad ] ) , is then seen to be a wiener - filtered version of eq .",
    "( [ eq : xisol ] ) with the optimized choice for @xmath455 , eq .",
    "( [ eq : xisol ] ) , and its covariance eq .",
    "( [ eq : squad ] ) then follows from the theory of wiener - filtering .    hu and okamoto @xcite derive a quadratic estimator using essentially the same method outlined in this appendix .",
    "while they have chosen to separately optimize the different components of @xmath455 ( @xmath456 , @xmath457 , @xmath458 , @xmath459 , and @xmath85 ) and then combine these to form a `` minimum variance '' estimator , the end result of the optimal filtering must be the same .",
    "( note that while our covariance response function @xmath460 is the same as hu and okamoto s @xmath461 aside from a factor of @xmath100 due to use of @xmath65 vs. @xmath74 as the fundamental field , we have used @xmath455 in place of their @xmath462 to avoid confusion with the fisher matrix . )",
    "the purpose of this appendix is to investigate the question of whether , in the absence of noise and field rotation , the equation @xmath6 could be used to completely reconstruct the convergence field .",
    "we show that with probability 1 , it is possible to reconstruct most of the convergence modes . there may remain a small number of convergence modes that can not be reconstructed by this method .",
    "if we impose periodic boundary conditions , the fraction of the convergence modes that are in this category is at most of order @xmath463 ; however , there may be fewer of these degenerate modes , or possibly none at all .",
    "we have not investigated more realistic survey topologies but we would expect the general result to be similar on scales small compared to the angular width of the survey . however",
    ", this seems mostly an academic point since zero noise is of course unrealistic , and there can be many almost - degenerate modes that spoil a reconstruction based on @xmath6 .",
    "the @xmath0-mode induced by lensing is , to first order : @xmath464 where @xmath465 is a transfer matrix that is a linear function of @xmath5 ( and once again @xmath466 ) . in the absence of noise",
    ", we may set @xmath467 equal to the observed polarization @xmath468 .",
    "we see that if @xmath59 fourier modes are considered , there are @xmath59 linear equations for @xmath59 unknowns @xmath469 .",
    "( we do not consider @xmath25 modes since there does not exist a @xmath470 mode , and lensing has no effect on zero - wavenumber cmb modes . )",
    "thus any convergence mode that can not be reconstructed must be associated with a degenerate direction of @xmath465 .",
    "it is clear that for some realizations of the primary cmb , e.g. @xmath471 , @xmath465 is massively degenerate .",
    "we thus wish to explore whether these singular realizations are `` likely '' or have probability zero .",
    "we will assume here that @xmath472 for all of the @xmath5-modes so that `` probability zero '' and `` measure zero '' can be taken to be equivalent .    in order to do this ,",
    "we consider the characteristic polynomial of @xmath473 : @xmath474 the determinant of an @xmath475 matrix is a polynomial of degree @xmath59 in the entries of the matrix , hence each @xmath476 is a polynomial of order at most @xmath477 in the @xmath478 . we know from linear algebra that the roots and multiplicities of @xmath479 ( viewed as a polynomial in @xmath452 ) are precisely the eigenvalues and multiplicities of @xmath465 ; in particular , the number of degenerate ( @xmath480 ) modes is equal to the smallest value of @xmath394 for which @xmath481 .",
    "now suppose it were the case for some @xmath394 that @xmath482 with nonzero probability ( recall that the primary cmb polarization @xmath5 is a random variable ) .",
    "this implies that @xmath482 is generic , i.e. only a small ( measure zero ) set of values of @xmath5 give @xmath483 .",
    "the significance of this result is that if we can exhibit even one possible polarization field @xmath5 for which @xmath481 , it follows that @xmath481 with unit probability for the real primary cmb polarization field .",
    "a similar statement holds for the number of degenerate convergence modes : if we can exhibit a possible polarization field with @xmath394 degenerate modes , then it follows that with unit probability , the lensing field as reconstructed from the real cmb will have at most @xmath394 degenerate modes .",
    "conceptually , this means that the generic lensing reconstruction using @xmath6 can not be more degenerate than any special case we exhibit .",
    "( it may , however , be less degenerate . )",
    "we consider here the following very simple realization : take a sky with area @xmath18 , square ( with side length @xmath17 ) , and with periodic boundary conditions .",
    "suppose that only the @xmath5-mode @xmath484 where @xmath485 ( i.e. the longest - wavelength mode in the @xmath79-direction ) is nonzero . now consider a degenerate convergence mode , i.e. one that does not contribute to @xmath486 .",
    "( [ eq : borig ] ) , we see that the @xmath487 requirement forces all of the convergence modes @xmath488 to be zero except those for which @xmath489 , i.e. those for which @xmath490 is either parallel to or perpendicular to @xmath491 .",
    "the latter is impossible given the boundary conditions and the former requires @xmath490 to lie in the @xmath79-direction .",
    "thus , out of @xmath492 convergence modes , only the @xmath493 modes with wavevector in the @xmath79-direction can not be reconstructed .",
    "hence no more than a fraction @xmath494 of the convergence modes are degenerate ( i.e. can not be reconstructed from @xmath6 ) , and by the argument of the previous paragraph this must hold with probability 1 for the actual realization of the primary polarization field .",
    "note that this is only an upper limit and the actual number of degenerate modes may be smaller , or even zero .",
    "the problem of lensing reconstruction using @xmath6 has been considered previously using real - space methods by ref .",
    "they derive the following equation for the lensing - induced @xmath0-mode : @xmath495 where ( as above ) @xmath78 and @xmath496 are second derivatives of @xmath65 .",
    "this is therefore a third - order partial differential equation for @xmath65 .",
    "@xcite then performs a two - dimensional taylor - expansion of @xmath65 and finds that some of the coefficients are not fixed by eq .",
    "( [ eq : difeq-3 ] ) .",
    "they thus determine that there exists a class of lensing potential modes that do not produce @xmath0-modes purely by counting the number of equations and the number of variables to be calculated .",
    "the relationship between our approach and that of ref .",
    "@xcite is that we express @xmath465 in the fourier basis ( eq . [ eq : borig ] ) , whereas they have expressed @xmath465 in the taylor polynomial @xmath497 basis .",
    "these bases are not equivalent due to the differing boundary conditions assumed ( the fourier basis imposes periodic boundary conditions whereas the taylor polynomial basis does not ) , and this leads to different conclusions regarding the number and character of degenerate modes . in the fourier basis",
    "there are the same number of equations as variables .",
    "thus one can not conclude from the counting argument alone that there is a degeneracy in the case of full - sky coverage .",
    "( the analysis on the sphere would be slightly more intricate since the sky is curved and the boundary conditions have different topology than in the flat - sky approximation ; however , on scales @xmath498 small compared to the curvature scale , we expect that the results presented here will still apply . )",
    "our purpose in this appendix is to investigate in greater detail the mathematical structure of the curvature corrections , i.e. the increase in uncertainty in lensing reconstruction due to fluctuations of the curvature matrix .",
    "we show that the curvature correction has another interpretation : it represents the increased noise in the reconstruction of @xmath469 due to the presence of other lensing modes , @xmath488 ( where @xmath499 ) , an effect studied in detail in kesden _",
    "et al _ @xcite , where it was called the `` first - order noise contribution '' and denoted by @xmath500 . here",
    "we show that in fact the curvature correction contains the likelihood analysis manifestation of the @xmath501 of ref .",
    "@xcite .",
    "we can compute the curvature corrections to this as follows . if we define @xmath502 , and retain our approximation from eq .",
    "( [ eq : fphi ] ) that @xmath198 is independent of @xmath74 , then we have : @xmath503 where @xmath504 .",
    "[ to derive this equation , we have merely taylor - expanded in @xmath505 , then taken the cmb+noise+lss ensemble average , and noted that by definition @xmath505 vanishes when ensemble - averaged over cmb+noise realizations .",
    "note that because we have taken the expectation value , eq .",
    "( [ eq : cc ] ) should be viewed as an asymptotic expansion rather than a taylor expansion . ]",
    "the mean squared error @xmath506 picks up `` curvature correction '' terms involving @xmath505 that cause it to not equal the naive result @xmath507 . note that curvature corrections to @xmath508 only increase @xmath506 , they can not decrease it ( in the sense that @xmath509 has all eigenvalues @xmath510 ; equivalently the diagonal elements @xmath511_{jj}$ ] in all orthonormal bases ) .",
    "this is true to all orders in @xmath505 because the inverse of the mean of a set of positive definite hermitian matrices is smaller than the mean of the inverses ( in this same sense ) .    in order to compute the second - order curvature correction explicitly",
    ", we must understand the fluctuations in the curvature matrix . for simplicity ,",
    "we evaluate @xmath505 at @xmath512 . in this case",
    ", we find : @xmath513",
    "= { \\partial^2\\over\\partial\\kappa_{{\\bf l}}^\\ast\\partial\\kappa_{{{\\bf l } } ' } } \\left ( { 1\\over 2}\\ln\\det\\hat{\\bf c}_g + { 1\\over 2}\\hat{\\bf x}^\\dagger\\hat{\\bf c}_g^{-1}{\\bf x } \\right ) \\nonumber \\\\ = & & { 1\\over 2}\\hat{\\bf x}^\\dagger \\hat{\\bf c}^{-1 }   \\left ( 2 { \\partial\\hat{\\bf c}\\over\\partial \\kappa_{-{{\\bf l } } } } \\hat{\\bf c}^{-1 } { \\partial\\hat{\\bf c}\\over\\partial \\kappa_{{{\\bf l } } ' } } - { \\partial^2\\hat{\\bf c}\\over\\partial \\kappa_{-{{\\bf l } } } \\partial \\kappa_{{{\\bf l } } ' } }   \\right ) \\hat{\\bf c}^{-1}\\hat{\\bf x } -{1\\over 2 } { { \\rm tr}}\\left [ \\hat{\\bf c}^{-1 } \\left ( { \\partial\\hat{\\bf c}\\over\\partial \\kappa_{-{{\\bf l } } } } \\hat{\\bf c}^{-1 } { \\partial\\hat{\\bf c}\\over\\partial \\kappa_{{{\\bf l } } ' } } - { \\partial^2\\hat{\\bf c}\\over\\partial \\kappa_{-{{\\bf l } } } \\partial \\kappa_{{{\\bf l } } ' } }   \\right)\\right],\\end{aligned}\\ ] ] where the second line has the @xmath357 s evaluated at @xmath512 . subtracting out the average value @xmath514 over cmb+noise realizations yields : @xmath515 where we have defined : @xmath516\\over",
    "\\partial\\kappa_{-{{\\bf l } } } \\partial\\kappa_{{{\\bf l } } ' } } \\hat{\\bf c } \\right|_{\\kappa=0 } = \\left.\\left ( { \\partial\\hat{\\bf c}\\over\\partial \\kappa_{-{{\\bf l } } } } \\hat{\\bf c}^{-1 } { \\partial\\hat{\\bf c}\\over\\partial \\kappa_{{{\\bf l } } ' } } + { \\partial\\hat{\\bf c}\\over\\partial \\kappa_{{{\\bf l } } ' } } \\hat{\\bf c}^{-1 } { \\partial\\hat{\\bf c}\\over\\partial \\kappa_{-{{\\bf l } } } } - { \\partial^2\\hat{\\bf c}\\over\\partial \\kappa_{-{{\\bf l } } } \\partial \\kappa_{{{\\bf l } } ' } } \\right ) \\right|_{\\kappa=0}. \\label{eq : j}\\ ] ] note that @xmath517 .    using this relation , and noting that at @xmath512 we have @xmath518",
    ", we can use wick s theorem to compute : @xmath519 in the case of statistically isotropic noise , eq .",
    "( [ eq : trace4 ] ) allows us to compute the covariance of the reconstruction @xmath506 using eq .",
    "( [ eq : cc ] ) . in harmonic space ,",
    "the off - diagonal elements of @xmath506 vanish by symmetry whereas the diagonal elements are given by :    @xmath520_l + { 1\\over 4 } [ s_0]_l^2 \\sum_{{{\\bf l } } ' }   [ s_0]_{l'}{{\\rm tr}}\\left ( \\hat{\\bf c}^{-1 } { \\bf j}_{(-{{\\bf l}},{{\\bf l } } ' ) } \\hat{\\bf c}^{-1 } { \\bf j}_{(-{{\\bf l}}',{{\\bf l } } ) } \\right ) , \\label{eq : s2}\\ ] ]      to lowest order ( @xmath521 ) , the curvature correction is given by eq .",
    "( [ eq : s2 ] ) .",
    "the correction to the mean inverse curvature @xmath522 , i.e. to the covariance matrix of an unbiased estimator for @xmath74 , is related to the correction to @xmath523 by noting that @xmath524 , hence : @xmath525_{l ' } { { \\rm tr}}\\left ( \\hat{\\bf c}^{-1 } { \\bf j}_{(-{{\\bf l}},{{\\bf l } } ' ) } \\hat{\\bf c}^{-1 } { \\bf j}_{(-{{\\bf l}}',{{\\bf l } } ) } \\right ) .",
    "\\label{eq : deltav}\\ ] ] we now pass to the `` linear approximation '' in which the second derivative @xmath526 is neglected .",
    "( this was found to be a valid approximation for temperature - based lensing estimation on scales @xmath527 @xcite , although it is unclear whether this is also true in the present context . ) substituting eq .",
    "( [ eq : j ] ) then yields :    @xmath528_{l ' } { { \\rm tr}}\\left (   \\hat{\\bf c}^{-1 } { \\bf f}_{{{\\bf l}}}^\\kappa \\hat{\\bf c}^{-1 } { \\bf f}_{{{\\bf l}}'}^\\kappa \\hat{\\bf c}^{-1 } { \\bf f}_{-{{\\bf l}}}^\\kappa \\hat{\\bf c}^{-1 } { \\bf f}_{-{{\\bf l}}'}^\\kappa   + \\hat{\\bf c}^{-1 } { \\bf f}_{{{\\bf l}}}^\\kappa \\hat{\\bf c}^{-1 } { \\bf f}_{-{{\\bf l}}}^\\kappa \\hat{\\bf c}^{-1 } { \\bf f}_{{{\\bf l}}'}^\\kappa \\hat{\\bf c}^{-1 } { \\bf f}_{-{{\\bf l}}'}^\\kappa   \\right ) .",
    "\\label{eq : deltav2}\\ ] ]    this should be compared with the first - order noise contribution @xmath501 of ref .",
    "@xcite . in our notation , and written in terms of the convergence rather than the potential , their eq .",
    "( 25 ) can be re - written with the help of some algebra and the relation @xmath529 as :    @xmath530_{{{\\bf l}}_1,-{{\\bf l}}_2}^\\kappa [ f_{{{\\bf l}}'}]_{-{{\\bf l}}_2,-{{\\bf l}}_2-{{\\bf l}}'}^\\kappa [ f_{-{{\\bf l}}}]_{-{{\\bf l}}_2-{{\\bf l}}',{{\\bf l}}_1-{{\\bf l}}'}^\\kappa [ f_{-{{\\bf l}}'}]_{{{\\bf l}}_1-{{\\bf l}}',{{\\bf l}}_1}^\\kappa    } { [ \\langle\\hat{\\bf c}\\rangle_{lss}]_{l_1}^\\kappa [ \\langle\\hat{\\bf c}\\rangle_{lss}]_{l_2}^\\kappa [ \\langle\\hat{\\bf c}\\rangle_{lss}]_{{{\\bf l}}_2+{{\\bf l}}'}^\\kappa [ \\langle\\hat{\\bf c}\\rangle_{lss}]_{{{\\bf l}}_1-{{\\bf l}}'}^\\kappa } .\\ ] ]    this is the first term of eq .",
    "( [ eq : deltav2 ] ) , except that it only includes temperature information ( hence we have multiplication of numbers rather than @xmath211 matrices ) , and the residual power spectrum @xmath531_{l'}$ ] has been replaced with the raw convergence power spectrum @xmath532 .",
    "( the latter difference arises because ref .",
    "@xcite computed the first - order noise @xmath501 for the quadratic estimator ; when the bayesian estimator is used , the contaminating modes @xmath533 have their power reduced from @xmath532 to @xmath531_{l'}$ ] since the estimated lensing field @xmath231 is used to de - lens the cmb . )",
    "thus we see that the first - order noise arises in the likelihood formalism as a curvature correction , which is not taken into account in the fisher matrix for lensing reconstruction .",
    "the question naturally arises as to the interpretation of the second term in the curvature correction , eq .",
    "( [ eq : deltav2 ] ) .",
    "we note that within the linear approximation , @xmath534_{{{\\bf l } } ' } \\hat{\\bf c}_{(0,0)}^{-1 } { \\bf f}^\\kappa_{{{\\bf l } } ' } \\hat{\\bf c}_{(0,0)}^{-1 } { \\bf f}_{-{{\\bf l}}'}^\\kappa \\hat{\\bf c}_{(0,0)}^{-1 } .\\ ] ] the second term of eq .",
    "( [ eq : deltav2 ] ) is thus seen to be the correction to the fisher matrix , eq .",
    "( [ eq : fphi ] ) , due to the lensing effect on the cmb power spectrum ."
  ],
  "abstract_text": [
    "<S> gravitational lensing of the cosmic microwave background ( cmb ) polarization field has been recognized as a potentially valuable probe of the cosmological density field . </S>",
    "<S> we apply likelihood - based techniques to the problem of lensing of cmb polarization and show that if the @xmath0-mode polarization is mapped , then likelihood - based techniques allow significantly better lensing reconstruction than is possible using the previous quadratic estimator approach . with this method </S>",
    "<S> the ultimate limit to lensing reconstruction is not set by the lensed cmb power spectrum . </S>",
    "<S> second - order corrections are known to produce a curl component of the lensing deflection field that can not be described by a potential ; we show that this does not significantly affect the reconstruction at noise levels greater than 0.25 @xmath1k arcmin . </S>",
    "<S> the reduction of the mean squared error in the lensing reconstruction relative to the quadratic method can be as much as a factor of two at noise levels of 1.4 @xmath1k arcmin to a factor of ten at 0.25 @xmath1k arcmin , depending on the angular scale of interest . </S>"
  ]
}