{
  "article_text": [
    "in the hybrid approximation , ions are treated as particles , and electrons as a massless fluid . in what follows we use si units .",
    "the trajectory of an ion , @xmath0 and @xmath1 , with charge @xmath2 and mass @xmath3 , is computed from the lorentz force , @xmath4 where @xmath5 is the electric field , and @xmath6 is the magnetic field . from now on we do not write out the dependence on @xmath7 and @xmath8 .",
    "the electric field is given by @xmath9 where @xmath10 is the ion charge density , @xmath11 is the ion current density , @xmath12 is the electron pressure , @xmath13 is the resistivity , and @xmath14 is the magnetic constant . then faraday s law is used to advance the magnetic field in time , @xmath15 note that the unknowns are the position and velocity of the ions , and the magnetic field on a grid , _ not _ the electric field , since it can always be computed from  ( [ eq : e ] ) .",
    "as is common for hybrid models , we use the darwin approximation  @xcite , i.e.  we neglect the displacement current in ampere s law , and the current then is @xmath16 .",
    "this removes waves that propagate with the speed of light , @xmath17 . for the problems we study the velocities",
    "are small compared to @xmath17 and the transport of energy by electromagnetic radiation can be neglected .",
    "this makes the approximation reasonable for our purposes .",
    "if the darwin approximation is not used we would have the severe restriction on the time step of @xmath18 .",
    "we have implemented a parallel hybrid solver in the flash open source software framework  @xcite .",
    "further details on the hybrid model used here , and the discretization , can be found in  @xcite .",
    "the solver has been applied to studies of the interaction between the solar wind and planets , e.g. , the moon  @xcite .    in the following sections we present some details of this hybrid model .",
    "how we handle permanent magnetic fields , how ionospheric chemistry for mars can be included in the model , and some analytical expressions for mars exosphere .",
    "in many applications there is a background magnetic field that does not change over time .",
    "an example can be the internal dipole field of a planet , or the solar wind magnetic field . for simplicity and accuracy over long time",
    "runs we can split the field into a time varying part and a constant in time part  @xcite .",
    "we can then solve for @xmath19 .",
    "note that @xmath20 does not need to be small . to ensure that @xmath21 we can define @xmath22",
    ", then we also have that @xmath23 . inserting this into the hybrid equations , we find that @xmath24 then only appears in the lorentz force and in the first term of the electric field expression .",
    "all other terms in the electric field expression involving @xmath24 are zero since @xmath24 is rotation free .    to implement this in the hybrid solver it is important that @xmath25 also in the discrete sense .",
    "this can be ensured by computing the background field from the potential , @xmath22 using the same finite difference approximation of the gradient that we use for the divergence . in our case",
    "we use the same centered finite difference stencil .",
    "this ensures that the discrete @xmath25 down to round - off errors .",
    "note that @xmath24 need only be computed once , at the start of the simulation , and stored .",
    "as an example , the potential for a dipole is @xmath26.}\\ ] ] then @xmath27 here @xmath28 is the dipole moment [ t m@xmath29 .",
    "the background field from a dipole located at @xmath30 then is @xmath31 .    for a conducting sphere of radius @xmath32 in a uniform field @xmath33 , currents in the sphere will expel the external field such that the component normal to the sphere surface is zero .",
    "the resulting total field outside the sphere can be seen as the sum of the external field and a dipole at the center of the sphere directed opposite to the external field .",
    "the magnitude of the required dipole moment is @xmath34 .",
    "for mars ionosphere one can consider only the major ion species co@xmath35 , o@xmath36 , and o@xmath35 .",
    "a table of the most relevant chemical reactions involving these species was presented by  @xcite .",
    "a similar table is provided by  @xcite , with the addition of oxygen electron impact ionization , e+o  @xmath37  o@xmath36+e+e .",
    "the different reactions are presented in figure  [ fig : ions ] and in table  [ table : reactions ] .",
    "we also consider the hydrogen exosphere , but h only occur for photoionization and charge exchange .",
    "we can note that all reactions depend only on one ion species , so we can adopt a monte carlo approach where for each meta - ion we can compute the probability that it undergo a reaction and then randomly convert it to another ion .",
    "recombination reactions also depend on the electron density ( total charge density ) so we have to get that value from the grid .",
    "the initial ion densities are important .",
    "we disregard charge exchange for initial distributions .    , and values are given in table  [ table : reactions ] .",
    "some rates depend on photon flux , neutral temperatures , and electron temperature . ]    here square brackets denote number density of a species , e.g. , @xmath38 $ ]  m@xmath39 for a species @xmath40 .",
    "we consider the density of neutrals as constant in radial background profiles @xmath41(r ) , [ \\textrm{o}](r ) , [ \\textrm{co}_2](r)\\ ] ] where the density only depends on distance , @xmath42 , from the center of mars .",
    "so the neutral atmosphere is an unchanging source and sink .",
    "this is an acceptable approximation at mars to large distances from the planet since the neutral densities are so much larger than the ion densities .",
    "the unknowns here are the ion number densities as a function of position and time @xmath43(\\mathbf{r},t ) , [ \\textrm{o}^+](\\mathbf{r},t ) ,      [ \\textrm{o}_2^+](\\mathbf{r},t ) , [ \\textrm{co}_2^+](\\mathbf{r},t).\\ ] ] we will also need the electron number density @xmath44(\\mathbf{r},t ) = [ \\textrm{h}^+ ] + [ \\textrm{o}^+ ] +                         [ \\textrm{o}_2^+ ] + [ \\textrm{co}_2^+].\\ ] ] using the reactions in  @xcite we can then write the evolution of ion number densities at each position @xmath7 ( no transport is considered ) as @xmath45 & = & k_3 [ \\textrm{h } ]        + k_9 [ \\textrm{h } ] [ \\textrm{o}^+ ] - k_{10 } [ \\textrm{o } ] [ \\textrm{h}^+ ] \\\\     { \\frac{\\displaystyled}{\\displaystyledt}}[\\textrm{o}^+ ] & = & k_2 [ \\textrm{o } ]        + k_5 [ \\textrm{o } ] [ \\textrm{co}_2^+ ] - k_6 [ \\textrm{co}_2 ] [ \\textrm{o}^+ ]        - k_9 [ \\textrm{h } ] [ \\textrm{o}^+ ] + k_{10 } [ \\textrm{o } ] [ \\textrm{h}^+ ]        + k_{11 } [ \\textrm{o } ] [ \\textrm{e } ] \\\\    { \\frac{\\displaystyled}{\\displaystyledt}}[\\textrm{co}_2^+ ] & = & k_1 [ \\textrm{co}_2 ]        - ( k_4+k_5 ) [ \\textrm{o } ] [ \\textrm{co}_2^+ ]        - k_7 [ \\textrm{co}_2^+ ] [ \\textrm{e } ] \\\\    { \\frac{\\displaystyled}{\\displaystyledt}}[\\textrm{o}_2^+ ] & = & k_4 [ \\textrm{o } ] [ \\textrm{co}_2^+ ]        + k_6 [ \\textrm{co}_2 ] [ \\textrm{o}^+ ] - k_8 [ \\textrm{o}_2^+ ] [ \\textrm{e}]\\end{aligned}\\ ] ] some of the constants @xmath46 also depend on ion and electron temperature , @xmath47 and @xmath48 .",
    "we list the coefficients in table  [ table : reactions ] .",
    "all coefficients except for @xmath49 come from  @xcite .",
    "the coefficient @xmath49 is re - cited from  @xcite .",
    ".table of ion species , the reactions considered , the rate for each reaction , and the symbol used for the rate . [ cols=\"<,<,<,<\",options=\"header \" , ]",
    "we have presented the implementation of several model details for a parallel hybrid solver in the flash open source software framework .",
    "first , an inclusion of permanent magnetic fields such that the divergence of the magnetic field is ensured to be zero in the discrete sense was presented .",
    "secondly , a monte carlo algorithm for including ionospheric chemistry in the model is introduced , along with reaction times from the existing literature .",
    "finally , an analytical fit for mars hydrogen and oxygen exosphere , based on rosetta observations , is presented .",
    "this research was conducted using resources provided by the swedish national infrastructure for computing ( snic ) at the high performance computing center north ( hpc2n ) , ume  university , sweden .",
    "the software used in this work was in part developed by the doe nnsa - asc oascr flash center at the university of chicago ."
  ],
  "abstract_text": [
    "<S> a hybrid plasma solver treats ions as particles and electrons as a fluid . </S>",
    "<S> we have implemented a parallel hybrid solver in the flash open source software framework . </S>",
    "<S> the solver has been applied to studies of the interaction between the solar wind and planets . here </S>",
    "<S> we discuss the implementation of different model features , such as permanent magnetic fields , ionospheric chemistry , and exospheres . </S>",
    "<S> mars is used as an example . </S>"
  ]
}