{
  "article_text": [
    "a fundamental topic in combinatorics on words is the study of repetitions .",
    "a _ repetition _ in a word is a factor that is formed by the concatenation of two or more identical blocks .",
    "the simplest kind of repetition is a _ square _ , that is , the concatenation of two copies of the same block , such as the english word hotshots .",
    "a famous conjecture of fraenkel and simpson @xcite states that a word of length @xmath0 contains fewer than @xmath0 distinct square factors .",
    "experiments strongly suggest that the conjecture is true , but a theoretical proof of the conjecture seems difficult . in @xcite , the authors proved a bound of @xmath3 . in @xcite , ilie improved this bound to @xmath7 , and recently deza et al",
    ".  showed the current best bound of @xmath8 @xcite , but the conjectured bound is still out of reach .",
    "other variations on counting squares include counting squares in partial words ( e.g. , @xcite ) and pseudo - repetitions ( e.g. , @xcite ) .    among the different generalizations of the notion of repetition ,",
    "a prominent one is that of an abelian repetition .",
    "abelian repetition _ in a word is a factor that is formed by the concatenation of two or more blocks that have the same number of occurrences of each letter in the alphabet .",
    "of course , the simplest kind of abelian repetition is an _ abelian square _ , that is , the concatenation of a word with an anagram of itself , such as the english word intestines .",
    "abelian squares were considered in 1961 by erds @xcite , who conjectured that there exist infinite words avoiding abelian squares .",
    "this conjecture was later confirmed , and the smallest possible size of an alphabet for which it holds is known to be @xmath9 @xcite .",
    "we focus on the maximum number of distinct abelian squares that a word can contain .",
    "in contrast to the case of ordinary squares , a word of length @xmath0 can contain @xmath1 distinct abelian - square factors ( see @xcite ) .",
    "since the total number of factors in a word of length @xmath0 is quadratic in @xmath0 , this means that there exist words in which a constant fraction of all factors are abelian squares .",
    "so we turn our attention to infinite words , and we ask whether there exist infinite words such that for every @xmath0 the factors of length @xmath0 contain , on average , a number of distinct abelian - square factors that is quadratic in @xmath0 .",
    "we call such an infinite word _ abelian - square - rich_. since a random binary word of length @xmath0 contains @xmath10 distinct abelian - square factors @xcite , the existence of abelian - square - rich words is not immediate .",
    "we also introduce _ uniformly abelian - square - rich _ words ; these are infinite words such that for every @xmath0 , every factor of length @xmath0 contains a quadratic number of distinct abelian squares .",
    "of course , if a word is uniformly abelian - square - rich , then it is abelian - square - rich , but the converse is not true in general  we provide in this paper an example of a word that is abelian - square - rich but not uniformly abelian - square - rich .",
    "however , we show that for linearly recurrent words the two definitions are equivalent . moreover , we prove that if an infinite word @xmath2 is uniformly abelian - square - rich , then @xmath2 has bounded exponent ( that is , there exists an integer @xmath11 such that @xmath2 does not contain any repetition of order @xmath12 as a factor ) .    we then prove that the famous thue - morse word is uniformly abelian - square - rich .",
    "furthermore , we look at the function that counts the number of distinct abelian squares of length @xmath3 in the thue - morse word and prove that this function is @xmath4-regular .    then we look at the class of sturmian words ; these are aperiodic infinite words with the lowest possible factor complexity . in this case",
    ", we prove that a sturmian word has bounded exponent if and only if it is uniformly abelian - square - rich , and leave open the question of determining whether a sturmian word is not abelian - square - rich in the case when it does not have bounded exponent .",
    "let @xmath13 be an ordered @xmath14-letter alphabet .",
    "let @xmath15 stand for the free monoid generated by @xmath16 , whose elements are called _ words _ over @xmath16 .",
    "the _ length _ of a word @xmath2 is denoted by @xmath17 .",
    "the _ empty word _ , denoted by @xmath18 , is the unique word of length zero and is the neutral element of @xmath15 .",
    "we also define @xmath19 .",
    "a _ prefix _ ( respectively , a _ suffix _ ) of a word @xmath2 is a word @xmath20 such that @xmath21 ( respectively , @xmath22 ) for some word @xmath23 .",
    "a _ factor _ of @xmath2 is a prefix of a suffix ( or , equivalently , a suffix of a prefix ) of @xmath2 .",
    "the set of prefixes , suffixes and factors of the word @xmath2 are denoted , respectively , by @xmath24 , @xmath25 and @xmath26 . from the definitions",
    ", we have that @xmath18 is a prefix , a suffix and a factor of every word .",
    "a word @xmath2 is a _",
    "( also called a _ repetition of order @xmath12 _ ) , for an integer @xmath11 , if there exists a nonempty word @xmath20 such that @xmath27 .",
    "a @xmath4-power is called a _",
    "square_. the _ period _ of a word @xmath28 is the minimal integer @xmath29 such that @xmath30 for every @xmath31 .",
    "the _ exponent _ @xmath32 of a word @xmath2 is the ratio between its length @xmath17 and its period @xmath29 .",
    "for example , the period of @xmath33 is @xmath34 , hence @xmath35 .",
    "of course , if a word @xmath2 avoids @xmath12-powers ( that is , no factor of @xmath2 is a @xmath12-power ) , then the supremum of the exponents of factors of @xmath2 is smaller than @xmath12 .    for a word @xmath2 and a letter @xmath36 , we let @xmath37 denote the number of occurrences of @xmath38 in @xmath2 .",
    "the _ parikh vector _ ( sometimes called the _ composition vector _ ) of a word @xmath2 over @xmath13 is the vector @xmath39",
    "abelian @xmath12-power _ is a nonempty word of the form @xmath40 where all the @xmath41 have the same parikh vector ( and therefore in particular the same length ) .",
    "an abelian @xmath4-power is called an _ abelian square _ ; an example in english is the word reappear .",
    "an _ infinite word _",
    "@xmath2 over @xmath16 is an infinite sequence of letters from @xmath16 , that is , a function @xmath42 .",
    "an infinite word is _ recurrent _ if each of its factors occurs infinitely often .",
    "given an infinite word @xmath2 , the _ recurrence index _",
    "@xmath43 of @xmath2 is defined to be the least integer @xmath44 such that every factor of @xmath2 of length @xmath44 contains all factors of @xmath2 of length @xmath0 , or @xmath45 if such an integer does not exist .",
    "if the recurrence index is finite for every @xmath0 , the infinite word @xmath2 is called _ uniformly recurrent _ and the function @xmath43 the _ recurrence function _ of @xmath2 .",
    "a uniformly recurrent word is of course recurrent , but the converse is not always true .",
    "for example , the _ champernowne word _",
    "@xmath46 , obtained by concatenating the base-2 representations of the natural numbers , is recurrent but not uniformly recurrent ( to see this , it is sufficient to observe that it contains arbitrarily large consecutive blocks of the same letter ) .",
    "a uniformly recurrent word @xmath2 is called _ linearly recurrent _ if the ratio @xmath47 is bounded by a constant .",
    "given a linearly recurrent word @xmath2 , the real number @xmath48 is called the _ recurrence quotient _ of @xmath2 .",
    "the _ factor complexity function _",
    "( sometimes called _ subword complexity _ ) of an infinite word @xmath2 is the integer function @xmath49 defined by @xmath50 .",
    "an infinite word @xmath2 has _ linear complexity _ if @xmath51 . in particular , if a word is linearly recurrent , then it has linear complexity ( see , for example , @xcite ) .",
    "a _ substitution _ over the alphabet @xmath16 is a map @xmath52 .",
    "a substitution @xmath53 over @xmath16 can be naturally extended to a ( non - erasing ) morphism from @xmath54 to @xmath54 .",
    "a substitution can be iterated : for every substitution @xmath53 and every @xmath55 , using the extension to a morphism , one can define the substitution @xmath56 .",
    "a substitution @xmath53 is _",
    "@xmath57-uniform _ if there exists an integer @xmath58 such that for all @xmath59 , @xmath60 .",
    "a substitution is called _ uniform _ if it is @xmath57-uniform for some @xmath58 .",
    "a substitution @xmath53 is _ primitive _ if there exists an integer @xmath61 such that for every @xmath59 , the word @xmath62 contains every letter of @xmath16 at least once . in this paper",
    ", we will only consider primitive substitutions such that @xmath63 for a letter @xmath64 and some nonempty word @xmath65 .",
    "these substitutions always have a fixed point , which is the infinite word @xmath66",
    ". moreover , this fixed point is linearly recurrent ( see , for example , @xcite ) and therefore has linear complexity .    for an integer @xmath11",
    ", we say that an infinite word @xmath2 is _ @xmath12-power - free _ if no factor of @xmath2 is a @xmath12-power .",
    "if an infinite word @xmath2 is @xmath12-power - free for some @xmath12 , we say that @xmath2 has _ bounded exponent_. for example , if a word is linearly recurrent , then it has bounded exponent ( see , for example , @xcite ) .",
    "kociumaka et al .",
    "@xcite showed that a word of length @xmath0 can contain a number of distinct abelian - square factors that is quadratic in @xmath0 . for the sake of completeness",
    ", we give a proof of this fact here .",
    "[ prop : as ] a word of length @xmath0 can contain @xmath67 distinct abelian - square factors .",
    "consider the word @xmath68 , of length @xmath69 .",
    "for every @xmath70 such that @xmath71 is even , the factor @xmath72 of @xmath2 is an abelian square .",
    "since the number of possible choices for the pair @xmath73 is quadratic in @xmath0 , we are done .    motivated by the previous result",
    ", we might ask whether there exist infinite words such that all their factors contain a number of distinct abelian squares that is quadratic in their length .",
    "but first we relax this condition and consider words in which , for every @xmath0 , each factor of length @xmath0 contains , on average , a number of distinct abelian - square factors that is quadratic in @xmath0 .",
    "let us define some notation . given a finite or infinite word @xmath2 , we let @xmath74 denote the number of distinct abelian - square factors of @xmath2 of length @xmath0 .",
    "of course , @xmath75 if @xmath0 is odd , so this quantity is significant only for even values of @xmath0 .",
    "furthermore , for a finite word @xmath2 of length @xmath0 , we let @xmath76 denote the total number of distinct abelian - square factors , of all lengths , in @xmath2 .",
    "an infinite word @xmath2 is _ abelian - square - rich _ if there exists a positive constant @xmath77 such that for every @xmath0 one has @xmath78    notice that christodoulakis et al .",
    "@xcite proved that a binary word of length @xmath0 contains @xmath10 distinct abelian - square factors on average ; hence a random infinite binary word is almost surely not abelian - square - rich .    in an abelian - square - rich word",
    "the number of distinct abelian squares contained in any factor is , on average , quadratic in the length of the factor .",
    "a stronger condition is that _ every _ factor contains a quadratic number of distinct abelian squares .",
    "we thus introduce the concept of uniformly abelian - square - rich words .",
    "an infinite word @xmath2 is _ uniformly abelian - square - rich _ if there exists a positive constant @xmath77 such that @xmath79 for all @xmath80 .    clearly , if a word is uniformly abelian - square - rich , then it is also abelian - square - rich , but the converse is not always true ( we will provide an example of a word that is abelian - square - rich but not uniformly abelian - square - rich at the end of this section )",
    ". however , in the case of linearly recurrent words , the two definitions are equivalent , as shown in the next lemma .",
    "[ lem : un ] let @xmath2 be an infinite word . if @xmath2 is abelian - square - rich and linearly recurrent , then it is uniformly abelian - square - rich .",
    "if @xmath2 is linearly recurrent , then there exists a positive integer @xmath81 such that , for every @xmath0 , every factor of @xmath2 of length @xmath82 contains all the factors of @xmath2 of length @xmath0 .",
    "let @xmath65 be a factor of @xmath2 of length @xmath0 containing the largest number of distinct abelian squares among the factors of @xmath2 of length @xmath0 .",
    "hence the number of distinct abelian squares in @xmath65 is at least the average number of distinct abelian squares in a factor of @xmath2 of length @xmath0 .",
    "since @xmath2 is abelian - square - rich , the number of distinct abelian squares in @xmath65 is greater than or equal to @xmath83 , for a positive constant @xmath84 .",
    "since @xmath65 is contained in every factor of @xmath2 of length @xmath82 , the number of distinct abelian squares in every factor of @xmath2 of length @xmath82 is greater than or equal to @xmath83 , whence @xmath2 is uniformly abelian - square - rich .",
    "the following lemma will be useful in the next sections .",
    "[ lem : lin ] let @xmath2 be a linearly recurrent infinite word . if there exists a positive constant @xmath77 such that for every @xmath0 one has @xmath85 , then @xmath2 is ( uniformly ) abelian - square - rich .",
    "since @xmath2 is linearly recurrent , there exists a constant @xmath81 such that , for every @xmath0 , every factor of @xmath2 of length @xmath82 contains all the factors of @xmath2 of length @xmath0 .",
    "take any factor @xmath20 of @xmath2 of length @xmath82 . since @xmath20 contains all the factors of @xmath2 of length @xmath0",
    ", it contains a number of distinct abelian - square factors that is larger than a constant times @xmath86 .",
    "therefore , every factor of length @xmath0 ( and hence in particular , on average ) contains a number of distinct abelian - square factors that is proportional to the square of its length .    in the next proposition",
    "we show that a necessary condition for a word to be uniformly abelian - square - rich is that it does not contain factors with arbitrarily large exponent .",
    "[ prop : new ] let @xmath2 be an infinite word . if @xmath2 is uniformly abelian - square - rich , then @xmath2 has bounded exponent .",
    "let @xmath87 be a nonempty factor of @xmath2 of length @xmath88 , @xmath89 .",
    "every abelian square in @xmath87 has an occurrence starting at a position smaller than @xmath44 .",
    "we separate the abelian squares of @xmath87 in two disjoint sets : those whose first occurrence ends at , or before , position @xmath44 ( i.e. , those occurring in @xmath20 ) , and those whose first occurrence ends after position @xmath44 .",
    "since there are no more than @xmath90 distinct abelian squares of the first kind and no more than @xmath91 distinct abelian squares of the second kind , we have that @xmath87 contains no more than @xmath92 distinct abelian - square factors .",
    "if @xmath2 does not have bounded exponent then , for every @xmath11 , @xmath2 contains a nonempty factor @xmath65 of the form @xmath93 , for some @xmath20 .",
    "hence , for every positive constant @xmath77 , taking @xmath12 such that @xmath94 , the word @xmath2 contains a factor @xmath65 such that @xmath95 .    to conclude this section , we exhibit an example of a word that is abelian - square - rich but not uniformly abelian - square - rich .",
    "consider the sequence of words @xmath96 defined by : @xmath97 , and for every @xmath98 @xmath99    the infinite word @xmath100 is abelian - square - rich but not uniformly abelian - square - rich .",
    "let us first prove that @xmath2 is abelian - square - rich .",
    "we first observe that @xmath2 has linear complexity . indeed , this is an immediate consequence of the fact that for every @xmath0 there is a constant number of distinct factors of length @xmath0 that can be extended to the right both by the letter @xmath101 or by the letter @xmath102 to factors of @xmath2 of length @xmath103 ( these factors are usually called _",
    "right special factors _ ) .",
    "actually , for every @xmath0 the number of right special factors of @xmath2 of length @xmath0 is bounded by @xmath9 , since these can only be of the following kinds :    1 .",
    "@xmath104 ; 2 .",
    "@xmath105 , for some @xmath106 and @xmath107 such that @xmath108 for some @xmath57 and @xmath109 ; 3 .",
    "@xmath110 , for some @xmath106 and @xmath107 such that @xmath108 for some @xmath57 and @xmath111 ; 4 .",
    "@xmath112 , for some @xmath106 and @xmath107 such that @xmath108 for some @xmath57 and @xmath113 .",
    "it is readily verified that if a factor of @xmath2 contains more than @xmath114 @xmath102 s or does not end in @xmath115 for some @xmath116 , then it can not be a right special factor of @xmath2 .",
    "so , it is sufficient to prove that for every @xmath0 there is a linear ( in @xmath0 ) number of factors of @xmath2 of length @xmath0 that contain a number of distinct abelian - square factors proportional to @xmath86 .",
    "this follows from the fact that for every @xmath0 there is a linear number of distinct factors that contain @xmath117 as factor , for some value of @xmath118 proportional to @xmath0 ( for example , take the largest @xmath12 such that @xmath119 , and consider the factors of length @xmath0 in which @xmath117 appears at different positions ) , and these factors contain a number of distinct abelian - square factors proportional to the square of their length ( see the proof of proposition [ prop : as ] ) , hence proportional to @xmath86 .    finally , @xmath2 is not uniformly abelian - square - rich by proposition [ prop : new ] , since it contains arbitrarily large powers of the letter  @xmath101 .",
    "it remains to prove that a recurrent ( or even a uniformly recurrent ) word exists that is abelian - square - rich but not uniformly abelian - square - rich , but such an example is probably more technical and involved .",
    "let @xmath120 be the thue - morse word , i.e. , the fixed point starting with @xmath121 of the uniform substitution @xmath122 .",
    "it is well known that @xmath123 is linearly recurrent and that @xmath123 does not contain any factor with exponent larger than @xmath4 . in particular",
    ", @xmath123 does not contain _ overlaps _ , i.e. , factors of the form @xmath124 , with @xmath125 and @xmath126 .    for every @xmath127",
    ", the factors of length @xmath0 of @xmath123 belong to two disjoint sets : those that start only at even positions in @xmath123 , and those that start only at odd positions in @xmath123 .",
    "this is a consequence of two facts : first , that @xmath123 is overlap - free ( and so @xmath128 can not be preceded by @xmath129 nor followed by @xmath121 ) and second , that @xmath130 and @xmath131 are not images under @xmath132 of letters , so they can not appear at even positions .",
    "let @xmath133 be the factor complexity function of @xmath123 .",
    "it is known ( * ? ? ?",
    "* proposition 4.3 ) that for every @xmath61 one has @xmath134    we define @xmath135 ( respectively , @xmath136 ) to be the number of factors of @xmath123 of length @xmath0 that begin and end with the same letter ( respectively , with different letters ) .",
    "the next lemma ( proved in @xcite ) shows that the thue - morse word has the property that for every @xmath0 , at least one - third of the length-@xmath0 factors begin and end with the same letter , and at least one - third of the length-@xmath0 factors begin and end with different letters .",
    "[ lem : third ] for every @xmath137 , one has @xmath138 and @xmath139 .    since from we",
    "have @xmath140 for every @xmath0 , we get the following result .",
    "[ cor : tm ] for every @xmath137 , one has @xmath141 and @xmath142 .",
    "we are now ready to prove that the thue - morse word is uniformly abelian - square - rich .    the thue - morse word @xmath123 is uniformly abelian - square - rich .",
    "let @xmath20 be a factor of length @xmath143 of @xmath123 that begins and ends with the same letter .",
    "since the image of every even - length word under @xmath132 is an abelian square , we have that @xmath144 is an abelian - square factor of @xmath123 of length @xmath145 that begins and ends with the same letter .",
    "moreover , the word obtained from @xmath144 by removing the first and the last letter is an abelian - square factor of @xmath123 of length @xmath146 .",
    "so , by corollary [ cor : tm ] , @xmath123 contains at least @xmath147 distinct abelian - square factors of length @xmath145 and at least @xmath147 distinct abelian - square factors of length @xmath146 .",
    "this implies that for every even @xmath0 the number of distinct abelian - square factors of @xmath123 of length @xmath0 is linear in @xmath0 .",
    "hence , for every @xmath0 the number of distinct abelian - square factors of @xmath123 of length at most @xmath0 is quadratic in @xmath0 .",
    "the statement then follows from lemmas [ lem : lin ] and [ lem : un ] .",
    "let @xmath148 denote the number of distinct abelian squares of length @xmath3 ( or , equivalently , of order @xmath0 ) in the thue - morse sequence @xmath123 .",
    "table  [ tabb1 ] gives the first few terms of this sequence .",
    ".[tabb1 ] first few values of the number of distinct abelian - square factors of order @xmath0 in the thue - morse word . [ cols=\"^,^,^,^,^,^,^,^,^,^,^,^,^,^,^,^,^,^,^,^,^\",options=\"header \" , ]     we can use the decision procedure discussed in to analyze the function @xmath149 in more detail .",
    "although in general abelian questions about arbitrary automatic sequences are _ not _ decidable using this method , the thue - morse sequence has symmetries that make it amenable .",
    "one nice feature of this approach is that it can be almost entirely automated , using the freely - available walnut package @xcite .",
    "define @xmath150|_0 - { n\\over 2}\\ ] ] to be the _ prefix defect function _ for the thue - morse sequence , that is , the function that counts the number of @xmath121 s in a prefix of length @xmath0 over the amount `` expected to occur '' .",
    "( since @xmath151 , we expect @xmath152 @xmath121 s in a prefix of length @xmath0 . )",
    "recall that we say that an infinite word @xmath153 is a _",
    "@xmath12-automatic sequence _ if there exists a deterministic finite automaton with output ( dfao ) @xmath154 that computes @xmath155 in the following sense : if the input to @xmath156 is @xmath157 , the base-@xmath12 representation of @xmath0 , then the output @xmath158 is equal to @xmath159 . here",
    "without loss of generality , we assume all automata discussed in this section take , as input , the base-@xmath4 representations of numbers starting with the most significant digit .",
    "see , for example , .",
    "now it is not hard to see that @xmath161 is a @xmath4-automatic sequence .",
    "in fact , the four - state automaton in figure  [ tmdisc ] computes it . here",
    "the notation @xmath162 in a state indicates that the state name is @xmath101 and its output is @xmath102 .",
    "thus , for example , starting in state @xmath121 , and reading the base-@xmath4 expansion of 23 ( namely , @xmath163 ) , we reach the state @xmath114 with output @xmath164 . and indeed , @xmath165 $ ] has 11 zeroes , so its defect is @xmath166 .",
    "now that we have the sequence @xmath167 , we define the function @xmath168 be the defect associated with the factor @xmath169 $ ] , that is , @xmath170|_0 - { n \\over 2}.\\ ] ] then we have @xmath171",
    ".    we can view @xmath172 as a _ two - dimensional automatic sequence _",
    "( see , e.g. , ) . here",
    "the input alphabet is @xmath173 , where the first components of the input spell out the base-@xmath4 representation of @xmath174 and the second components spell out the base-@xmath4 representation of @xmath0 .",
    "we write this input as @xmath175 .",
    "( the shorter of the two representations is , if necessary , padded with leading zeroes so that the two representations can be read in parallel . ) from the dfao for @xmath167 we can easily generate an automaton for the two - dimensional infinite array @xmath176 .",
    "more usefully , we can produce @xmath177 different automata @xmath178 accepting those inputs @xmath175 for which @xmath179 ( respectively , @xmath180 ) .",
    "we can think of each automaton @xmath181 , @xmath182 , as computing the function @xmath183 that is true when @xmath175 is accepted and false otherwise .",
    "when we compute these using walnut we discover that they have 10 , 13 , 7 , 13 , 10 states respectively .",
    "once we have the automata @xmath178 , we can create an automaton @xmath184 accepting those @xmath175 such that @xmath185 $ ] is an abelian square .",
    "this automaton is created by taking the disjunction of the assertions @xmath186 for @xmath182 , and is implemented by an automaton with 36 states .    finally , using @xmath184 we can create an automaton @xmath187 accepting those @xmath175 such that @xmath185 $ ] is a novel abelian square ; that is , an abelian square of length @xmath3 that has never appeared previously in @xmath123 : @xmath188\\not= { \\bf t}[j+k ] ) ) ) .\\ ] ] the automaton @xmath187 has 64 states , and",
    "can be computed using the techniques described in .",
    "again , we can view @xmath187 as computing the function @xmath189 that is true when @xmath175 is accepted and false otherwise .",
    "now define @xmath190 . as a moment",
    "s reflection will reveal , this is the number of distinct abelian squares in @xmath123 of order @xmath0 ( and length @xmath3 ) . as the techniques in show , from the transition diagram of the automaton @xmath187 we can immediately deduce a so - called _ linear representation _ for the function @xmath149 , that is , square matrices @xmath191 and vectors @xmath192 such that @xmath193 if @xmath194 . we can minimize the representation using the algorithm in , obtaining the following linear representation of rank @xmath131 :    @xmath195 \\\\ \\ \\\\ m_0 & : = \\left [ \\begin { array}{ccccccccccc } 1&0&0&0&0&0&0&0&0&0&0\\\\ \\noalign{\\medskip}0&0&1&0 & 0&0&0&0&0&0&0\\\\ \\noalign{\\medskip}0&0&0&0&1&0&0&0&0&0&0\\\\ \\noalign{\\medskip}0&0&0&0 & 0&0&1&0&0&0&0\\\\ \\noalign{\\medskip}0&0&0&0&0&0&0&0&1&0&0\\\\ \\noalign{\\medskip}0&0&0&0 & 0&0&0&0&0&0&1\\\\ \\noalign{\\medskip}0&0&{\\frac { 64}{13}}&1&-{\\frac { 171}{26}}&- { \\frac { 69}{26}}&0&0&{\\frac { 43}{26}}&{\\frac { 9}{13}}&{\\frac { 51}{26 } } \\\\ \\noalign{\\medskip}0&0&{\\frac { 90}{13}}&-1&-{\\frac { 275}{26}}&{\\frac { 9}{26}}&0&2 & { \\frac { 69}{26}}&-{\\frac { 17}{13}}&{\\frac { 51}{26}}\\\\ \\noalign{\\medskip}0&0&-2&0&1&0 & 0&0&2&0&0\\\\ \\noalign{\\medskip}0&0&{\\frac { 68}{13}}&0&-{\\frac { 88}{13}}&-{\\frac { 33 } { 13}}&0&0&{\\frac { 20}{13}}&{\\frac { 12}{13}}&{\\frac { 34}{13}}\\\\ \\noalign{\\medskip}0&0 & { \\frac { 54}{13}}&0&-{\\frac { 89}{13}}&-{\\frac { 22}{13}}&0&0&{\\frac { 35}{13}}&{\\frac   { 8}{13}}&{\\frac { 27}{13}}\\end { array } \\right ] \\end{aligned}\\ ] ]    @xmath196   \\\\ \\ \\\\",
    "w & : = [ 1,2,4,4,10,8,24,10,22,12,36]^t\\end{aligned}\\ ] ]    we have therefore proved    the function @xmath149 counting the number of distinct abelian squares of order @xmath0 of @xmath123 is given by @xmath197 if @xmath194 , for the vectors @xmath198 and matrices @xmath191 given above .",
    "a sequence that can be computed in this manner is called @xmath4-regular ; see .    from the matrices above we can ,",
    "using the method described in , obtain defining recursive relations for @xmath149 :    @xmath199    @xmath200 and @xmath201 for @xmath202 .",
    "[ cor9 ]    we suspect the values in corollary  [ cor9 ] are , respectively , the local minima ( maxima ) of @xmath203 , but we do not have a proof yet .",
    "in this section we fix the alphabet @xmath204 .    recall that a ( finite or infinite ) word @xmath2 over @xmath16 is _ balanced _ if and only if for every pair of factors @xmath205 of @xmath2 of the same length , one has @xmath206 .",
    "we start with a simple lemma .",
    "[ lem : bal ] let @xmath2 be a finite balanced word over @xmath16 . then for every @xmath207 , @xmath208 ( mod @xmath12 ) if and only if @xmath2 is an abelian @xmath12-power .",
    "let @xmath2 be balanced and @xmath209 , for a positive integer @xmath12 and some @xmath210",
    ". then we can write @xmath211 where each @xmath41 has length @xmath212 .",
    "now each @xmath41 must have parikh vector equal to @xmath213 , otherwise @xmath2 would not be balanced , whence the ` only if ' part of the statement follows . the ` if ' part is straightforward .",
    "a binary infinite word is _ sturmian _ if and only if it is balanced and aperiodic .",
    "sturmian words are precisely the infinite words having @xmath103 distinct factors of length @xmath0 for every @xmath214 .",
    "there are many other equivalent definitions of sturmian words .",
    "a classical reference on sturmian words is ( * ? ? ?",
    "* chapter 2 ) .",
    "let us recall the definition of sturmian words as codings of a rotation .",
    "we fix the torus @xmath215 . given @xmath216 in @xmath217 , if @xmath218 , we use the notation @xmath219 for the interval @xmath220 .",
    "recall that given a real number @xmath6 , @xmath221 is the greatest integer smaller than or equal to @xmath6 , @xmath222 is the least integer greater than or equal to @xmath6 , and @xmath223 is the fractional part of @xmath6 .",
    "notice that @xmath224 for non - integer @xmath6 .",
    "let @xmath225 be irrational , and @xmath226 . the sturmian word @xmath227 ( respectively , @xmath228 ) of _ angle _ @xmath6 and _ initial point _",
    "@xmath229 is the infinite word @xmath230 defined by @xmath231 where @xmath232 and @xmath233 ( respectively , @xmath234 $ ] and @xmath235 $ ] ) .    in other words ,",
    "take the unit circle and consider a point initially in position @xmath229 .",
    "then start rotating this point on the circle ( clockwise ) by an angle @xmath6 , @xmath236 , @xmath237 , etc . for each rotation , take the letter @xmath238 or @xmath239 associated with the interval within which the point falls .",
    "the infinite sequence obtained in this way is the sturmian word @xmath227 ( or @xmath228 , depending on the choice of the two intervals ) .",
    "see  [ fig : gab1 ] for an illustration .",
    "( where @xmath240 is the golden ratio ) and initial point @xmath241 generating the fibonacci word @xmath242 .",
    "[ fig : gab1 ] ]    for example , if @xmath240 is the golden ratio , the sturmian word @xmath243 is called the _",
    "fibonacci word_. a sturmian word for which @xmath241 , such as the fibonacci word , is called",
    "_ characteristic_. note that for every @xmath6 one has @xmath244 and @xmath245 .",
    "an equivalent way to visualize the coding of a rotation consists of fixing the point and rotating the intervals . in this representation ,",
    "the interval @xmath246 is rotated at each step , so that after @xmath174 rotations it is transformed into the interval @xmath247 , while @xmath248 .",
    "this representation is convenient , since one can read within it not only a sturmian word , but also all of its factors .",
    "more precisely , for every positive integer @xmath0 , the factor of length @xmath0 of @xmath227 starting at position @xmath249 is determined by the value of @xmath250 only . indeed , for every @xmath251 and @xmath174 , we have @xmath252 as a consequence , we have that given a sturmian word @xmath227 and a positive integer @xmath0 , the @xmath103 different factors of @xmath227 of length @xmath0 are completely determined by the intervals @xmath253 , that is , only by the points @xmath254 for @xmath255 . in particular , they do not depend on @xmath229 , so that the set of factors of @xmath227 is the same as the set of factors of @xmath256 for every @xmath229 and @xmath257 .",
    "hence , from now on , we let @xmath5 denote a sturmian word of angle @xmath6 .",
    "if we arrange the @xmath258 points @xmath259 in increasing order , we determine a partition of @xmath217 in @xmath103 subintervals , @xmath260 .",
    "each of these subintervals is in bijection with a different factor of length @xmath0 of @xmath261 ( see  [ fig : gab3 ] ) .",
    ", @xmath129 and @xmath262 , @xmath263 , @xmath264 , @xmath265 , @xmath266 , @xmath267 ( @xmath268 ) , arranged in increasing order , define the intervals @xmath269 , @xmath270 , @xmath271 , @xmath272 , @xmath273 , @xmath274 , @xmath275 .",
    "each interval is associated with one of the factors of length @xmath276 of the fibonacci word , respectively @xmath277 .",
    "[ fig : gab3 ] ]    recall that a factor of length @xmath0 of a sturmian word @xmath5 has a parikh vector equal either to @xmath278 ( in which case it is called _ light _ ) or to @xmath279 ( in which case it is called _ heavy _ ) .",
    "the following proposition relates the intervals @xmath280 to the parikh vectors of the factors of length @xmath0 ( see @xcite ) .",
    "[ pro : main ] let @xmath5 be a sturmian word of angle @xmath6 , and @xmath0 a positive integer .",
    "let @xmath281 be the factor of length @xmath0 associated with the interval @xmath280 .",
    "then @xmath281 is heavy if @xmath282 , while it is light if @xmath283 .",
    "let @xmath284 and @xmath285 .",
    "we have @xmath286 , so that @xmath287 .",
    "the reader can see in  [ fig : gab3 ] that the factors of length @xmath276 corresponding to intervals above ( respectively , below ) @xmath287 all have parikh vector @xmath288 ( respectively , @xmath289 ) .",
    "that is , the intervals @xmath290 and @xmath291 are associated with light factors ( , ) , while the intervals @xmath292 to @xmath293 are associated with heavy factors ( , , , , ) .",
    "observe that , by lemma [ lem : bal ] , every factor of a sturmian word having even length and containing an even number of @xmath238 s ( or , equivalently , of @xmath239 s ) is an abelian square .",
    "the following proposition relates the abelian - square factors of a sturmian word of angle @xmath6 with the arithmetic properties of @xmath6 .",
    "[ prop : hl ] let @xmath5 be a sturmian word of angle @xmath6 , and @xmath0 a positive even integer .",
    "let @xmath281 be the factor of length @xmath0 associated with the interval @xmath280 .",
    "then @xmath281 is an abelian square if and only if @xmath282 if @xmath294 is even , or @xmath283 if @xmath294 is odd .    by proposition [ pro : main ]",
    ", @xmath295 is heavy if @xmath282 , while it is light if @xmath283 .",
    "if @xmath294 is even , then every light factor of length @xmath0 contains an even number of @xmath238 s and hence is an abelian square , while if @xmath294 is odd , then every heavy factor of length @xmath0 contains an even number of @xmath238 s and hence is an abelian square , whence the statement follows .",
    "recall that given a finite or infinite word @xmath2 , @xmath74 denotes the number of distinct abelian - square factors of @xmath2 of length @xmath0 .",
    "[ cor : formula ] let @xmath5 be a sturmian word of angle @xmath6 .",
    "for every positive even @xmath0 , let @xmath296 .",
    "then @xmath297    the factors of length @xmath276 of the fibonacci word @xmath298 are , lexicographically ordered : @xmath299 ( heavy factors ) , @xmath300 ( light factors ) .",
    "the light factors , whose number of @xmath238 s is @xmath301 , are not abelian squares ; the heavy factors , whose number of @xmath238 s is @xmath302 , are all abelian squares .",
    "we have @xmath303 ( values are approximated ) and @xmath304",
    ", so @xmath305 is odd .",
    "thus , there are @xmath177 elements in @xmath306 that are @xmath307 , so by corollary [ cor : formula ] there are @xmath177 distinct abelian - square factors of length @xmath276 .",
    "the factors of length @xmath308 of the fibonacci word are , lexicographically ordered : @xmath309 , @xmath310 , @xmath311 , @xmath312 , @xmath313 , @xmath314 , @xmath315 , @xmath316 ( heavy factors ) , @xmath317 ( light factor ) . the light factor",
    ", whose number of @xmath238 s is @xmath318 , is an abelian square ; the heavy factors , whose number of @xmath238 s is @xmath319 , are not abelian squares .",
    "we have @xmath320 ( values are approximated ) and @xmath321 , so @xmath322 is even .",
    "thus , there is only one element in @xmath323 that is @xmath324 , so by corollary [ cor : formula ] there is only one abelian - square factor of length @xmath308 .    in table",
    "[ tab : i ] we report the first few values of the sequence @xmath325 for the fibonacci word @xmath298 .",
    "more detailed analysis of @xmath325 can be found , using the decision method we used for thue - morse , in .",
    "c|c * 30@c @xmath0 & 0 & 2 & 4 & 6 & 8 & 10 & 12 & 14 & 16 & 18 & 20 & 22 & 24 & 26 & 28 & 30 & 32 & 34 & 36 +   + @xmath325 & 0 & 1 & 3 & 5 & 1 & 9 & 5 & 5 & 15 & 3 & 13 & 13 & 5 & 25 & 9 & 15 & 25 & 1 & 27 +    ' '' ''    recall that every irrational number @xmath6 can be uniquely written as a ( simple ) continued fraction as follows : @xmath326 where @xmath327 , and the infinite sequence @xmath328 is called the sequence of _ partial quotients _ of @xmath6 .",
    "the continued fraction expansion of @xmath6 is usually denoted by its sequence of partial quotients as follows : @xmath329 $ ] , and each of its finite truncations @xmath330 $ ] is a rational number @xmath331 called the @xmath12th convergent to @xmath6 .",
    "we say that an irrational @xmath329 $ ] has bounded partial quotients if and only if the sequence @xmath328 is bounded .    the continued fraction expansion of @xmath6 is deeply related to the exponent of the factors of the sturmian word @xmath5 .",
    "the second author @xcite proved that a sturmian word of angle @xmath6 has bounded exponent if and only if @xmath6 has bounded partial quotients .",
    "since the golden ratio @xmath332 is defined by the equation @xmath333 , we have from equation [ cf ] that @xmath334 $ ] and therefore @xmath335 $ ] , so the fibonacci word is an example of a sturmian word with bounded exponent ( actually , one can prove that the superior limit of the exponent of a factor of the fibonacci word is @xmath336 @xcite ) .",
    "now we prove that if @xmath6 has bounded partial quotients , then the sturmian word @xmath5 is ( uniformly ) abelian - square - rich .",
    "for this , we will use a result on the _ discrepancy _ of uniformly distributed modulo @xmath129 sequences from @xcite . to the best of our knowledge ,",
    "this is the first application of this result to the theory of sturmian words , and we think that this correspondence might be useful for deriving other results on sturmian words .",
    "let @xmath337 be a sequence of real numbers .",
    "for a positive integer @xmath338 and a subset @xmath339 of the torus @xmath217 , we define @xmath340 as the number of terms @xmath341 , @xmath342 , for which @xmath343 . if there is no risk of confusion , we will write @xmath344 instead of @xmath340 .",
    "the sequence @xmath337 of real numbers is said to be _ uniformly distributed modulo @xmath129 _ if and only if for every pair @xmath345 of real numbers with @xmath346 we have @xmath347    let @xmath348 be a finite sequence of real numbers . the number @xmath349 is called the _ discrepancy _ of the given sequence . for an infinite sequence @xmath350 of real numbers",
    "the discrepancy @xmath351 is the discrepancy of the initial segment formed by the first @xmath352 terms of @xmath350 .",
    "the two previous definitions are related by the following result .",
    "the sequence @xmath350 is uniformly distributed modulo @xmath129 if and only if @xmath353 .    an important class of uniformly distributed modulo @xmath129 sequences is given by the sequence @xmath354 with @xmath6 an irrational number .",
    "the discrepancy of the sequence @xmath355 will depend on the finer arithmetical properties of @xmath6 .",
    "in particular , we have the following theorem , stating that if @xmath6 has bounded partial quotients , then its discrepancy has the least order of magnitude possible .",
    "[ theor : kn2 ] suppose the irrational @xmath356 $ ] has partial quotients bounded by @xmath81 .",
    "then the discrepancy @xmath357 of @xmath358 satisfies @xmath359 .",
    "more exactly , we have @xmath360 where @xmath332 is the golden ratio .    as a consequence ,",
    "we obtain the following corollary :    [ cor : disc ] suppose the irrational @xmath356 $ ] has bounded partial quotients",
    ". then there exists a positive constant @xmath77 such that for every pair @xmath345 of real numbers with @xmath346 and for every @xmath0 , we have @xmath361    now we use the results above to prove that sturmian words with bounded exponent are abelian - square - rich .",
    "[ theor : lin ] let @xmath5 be a sturmian word of angle @xmath6 such that @xmath6 has bounded partial quotients .",
    "then there exists a positive constant @xmath77 such that for every @xmath0 one has @xmath362 .    for every even @xmath0 ,",
    "let @xmath363 .",
    "by corollary [ cor : formula ] and basic arithmetical properties of the fractional part , we have @xmath364 so , @xmath365 where : follows from because for every integer @xmath44 one has that @xmath366 is odd if and only if @xmath367 ; follows from because for every integer @xmath44 , @xmath368 implies @xmath369 ; follows from because for every integer @xmath174 , @xmath370 implies @xmath371 ; finally follows from because the cardinality of the first set is independent from the sum .",
    "the other ( in-)equalities are obvious .    since @xmath6 has bounded partial quotients , so does @xmath372 ( see , e.g. , @xcite ) , and we can apply corollary [ cor : disc ] to evaluate the two factors of .",
    "therefore , we have @xmath373 for a positive constant @xmath374 , and @xmath375 for constants @xmath376 . from this",
    ", we can conclude that the product of the two factors of is greater than a constant times @xmath86 , as required .",
    "next , we recall a result of j.  cassaigne :    ( * ? ? ?",
    "5 ) the recurrence quotient @xmath377 of a sturmian word of angle @xmath378 $ ] is finite if and only if @xmath6 has bounded partial quotients and , in this latter case , one has @xmath379 .",
    "thus , we have the following :    let @xmath5 be a sturmian word of angle @xmath6 .",
    "then @xmath5 has bounded exponent if and only if @xmath5 is uniformly abelian - square - rich .",
    "we know that @xmath5 has bounded exponent if and only if @xmath6 has bounded partial quotients , if and only if @xmath5 is linearly recurrent .",
    "the statement then follows from theorem [ theor : lin ] , lemmas [ lem : lin ] and [ lem : un ] and proposition [ prop : new ] .",
    "we proved that the thue - morse word is uniformly abelian - square - rich .",
    "we suspect that the technique we used for the proof can be generalized to some extent , and could be used , for example , to prove that a subclass of fixed points of uniform substitutions are uniformly abelian - square - rich .",
    "we also proved that sturmian words of bounded exponent are uniformly abelian - square - rich ( and the converse also holds ) .",
    "the proof we gave is based on a classical result on the discrepancy of the uniformly distributed modulo @xmath129 sequence @xmath354 , where @xmath6 is the angle of the sturmian word . to the best of our knowledge ,",
    "this is the first application of this result to the theory of sturmian words , and we believe that the correspondence we have shown might be useful for deriving other results on sturmian words",
    ".    we leave open the question of determining whether @xmath5 is not abelian - square - rich in the case when @xmath6 has unbounded partial quotients . notice",
    "that , by proposition [ prop : new ] , such @xmath5 can not be uniformly abelian - square - rich , since a sturmian word has bounded partial quotients if and only if it has bounded exponent .",
    "we mostly investigated binary words in this paper .",
    "we conjecture that binary words have the largest number of distinct abelian - square factors .",
    "more precisely , we propose the following conjecture .",
    "if a word of length @xmath0 contains @xmath12 distinct abelian - square factors , then there exists a binary word of length @xmath0 containing at least @xmath12 distinct abelian - square factors .    a slightly different point of view from the one we considered in this paper consists in identifying two abelian squares if they have the same parikh vector .",
    "two abelian squares are therefore called _ inequivalent _ if they have different parikh vectors @xcite .",
    "sturmian words only have a linear number of inequivalent abelian squares . nevertheless , a word of length @xmath0 can contain @xmath380 inequivalent abelian squares @xcite . computations support the following conjecture :    every word of length @xmath0 contains at most @xmath10 inequivalent abelian squares .",
    "the authors warmly thank julien cassaigne for useful discussions about the number of abelian - square factors in the thue - morse word , and the anonymous referees for their valuable comments , which allowed us to improve the presentation of the paper .                              c.  f. du , h.  mousavi , l.  schaeffer , and j.  shallit .",
    "decision algorithms for fibonacci - automatic words with applications to pattern avoidance .",
    "preprint , available at http://arxiv.org/abs/1406.0670 , 2014 .",
    "g.  fici , a.  langiu , t.  lecroq , a.  lefebvre , f.  mignosi , and e.  prieur - gaston .",
    "abelian repetitions in sturmian words . in _",
    "dlt  2013 _ , volume 7907 of _ lecture notes in computer science _ ,",
    "pages 227238 .",
    "springer , 2013 .",
    "p.  gawrychowski , f.  manea , r.  merca , d.  nowotka , and c.  tiseanu .",
    "finding pseudo - repetitions . in _",
    "stacs 2013 _ , volume  20 of _ leibniz international proceedings in informatics ( lipics ) _ , pages 257268 .",
    "lipics schloss dagstuhl , 2013 .",
    "t.  kociumaka , j.  radoszewski , w.  rytter , and t.  walen . maximum number of distinct and nonequivalent nonstandard squares in a word . in _ dlt  2014 _ , volume 8633 of _ lecture notes in computer science _ ,",
    "pages 215226 .",
    "springer , 2014 ."
  ],
  "abstract_text": [
    "<S> an abelian square is the concatenation of two words that are anagrams of one another </S>",
    "<S> . a word of length @xmath0 can contain at most @xmath1 distinct factors , and there exist words of length @xmath0 containing @xmath1 distinct abelian - square factors , that is , distinct factors that are abelian squares . </S>",
    "<S> this motivates us to study infinite words such that the number of distinct abelian - square factors of length @xmath0 grows quadratically with @xmath0 . </S>",
    "<S> more precisely , we say that an infinite word @xmath2 is _ abelian - square - rich _ if , for every @xmath0 , every factor of @xmath2 of length @xmath0 contains , on average , a number of distinct abelian - square factors that is quadratic in @xmath0 ; and _ uniformly abelian - square - rich _ if every factor of @xmath2 contains a number of distinct abelian - square factors that is proportional to the square of its length . of course , if a word is uniformly abelian - square - rich , then it is abelian - square - rich , but we show that the converse is not true in general . </S>",
    "<S> we prove that the thue - morse word is uniformly abelian - square - rich and that the function counting the number of distinct abelian - square factors of length @xmath3 of the thue - morse word is @xmath4-regular . as for sturmian words </S>",
    "<S> , we prove that a sturmian word @xmath5 of angle @xmath6 is uniformly abelian - square - rich if and only if the irrational @xmath6 has bounded partial quotients , that is , if and only if @xmath5 has bounded exponent . </S>"
  ]
}