{
  "article_text": [
    "solid bodies in protoplanetary disks lose angular momentum as they encounter the headwind of the pressure - supported gas disk .",
    "the subsequent radial drift is fastest for marginally coupled solids whose aerodynamic stopping times are comparable to the local orbital time @xcite . for standard disk models , cm - sized particles at @xmath0 au and m - sized bodies at 1 au",
    "suffer drift times of only approximately @xmath1 or @xmath2 orbital periods , respectively .",
    "rapid infall imposes severe time - scale constraints on the growth into km - sized solid bodies , or planetesimals , by coagulation .",
    "concerns about the inefficiency of sticking for macroscopic solids @xcite has also contributed to the concept of a `` meter - size barrier '' in planet formation ( which should not be misinterpreted as implying that growth to meter sizes is easy , see e.g. * ? ? ?",
    "the gravitational instability hypothesis @xcite postulates that a sedimented mid - plane layer of small particles ( perhaps mm - sized to match chondrules ) will fragment directly into gravitationally bound planetesimals , avoiding the problems with sticking efficiency and drift . however , disk turbulence acts to diffuse particles , inhibiting both their vertical settling to the midplane @xcite and their ability to collapse into bound structures @xcite . even in a completely laminar disk ,",
    "particle settling generates vertical shear in the orbital motion of the gas .",
    "this shear in turn triggers modified kelvin - helmholtz instabilities that develop into turbulence , restricting further sedimentation @xcite .",
    "this self - induced turbulence may not be able to prevent gravitational collapse if the solids - to - gas ratio is enhanced above solar abundances @xcite , possibly due to photoevaporation of the gas - rich surface layers of the stratified disk @xcite or to pile - ups of solids in the inner disk from particles that drift in more rapidly from the outer disk @xcite .",
    "significant progress has been made in understanding the turbulence generated by particle settling @xcite .",
    "however a simulation that incorporates the full 3d nature of these non - axisymmetric instabilities , with radial shear and the independent evolution of solids and gas , has not yet been performed .",
    "this paper addresses the related streaming instability ( * ? ? ?",
    "* hereafter referred to as yg ) where vertical gravity is ignored in order to focus on a simpler manifestation of particle - gas coupling in keplerian disks . with no vertical shear present ,",
    "the streaming instability is driven by the relative motion between solids and gas , which is predominantly radial for tightly coupled particles . the ultimate energy source , as with vertical shear instabilities , is the radial gas pressure gradient .",
    "particle feedback on gas dynamics is important not just for establishing the ( unstable ) equilibrium , but also for generating escalating oscillations .",
    "consequently , streaming instabilities trigger exponential growth of arbitrarily small particle density perturbations , as shown by yg .",
    "the single - fluid treatment of @xcite discovered a related boundary layer drag instability in stratified disks that could also concentrate particles .",
    "@xcite found significant particle clumping in studies of kelvin - helmholz instabilities with particle feedback on the gas , which those authors hypothesized was a manifestation of non - linear streaming instabilities .",
    "the current study , including a companion paper @xcite , explores the consequences of streaming instabilities , and more generally the role of particle - gas coupling in protoplanetary disks .",
    "this paper demonstrates that our simulations faithfully reproduce the linear physics of the streaming instability , whether the solids are modeled as a fluid or lagrangian particles .",
    "the paper is built up as follows . in  [ s : eqns ] we present the basic equations of our dynamical system and review the streaming instability . section [ s : numerics ] describes the numerical methods , including the communication of drag forces between particles and a grid in  [ s : dragcalc ] .",
    "our main results , in ",
    "[ s : linear ] , numerically confirm the linear streaming instability . in ",
    "[ s : el ] we analyze energy and angular momentum balance in a coupled two - fluid system .",
    "we discuss our results in ",
    "[ s : disc ] .",
    "the appendices contain an analysis of interpolation and assignment errors in different particle - mesh approaches to calculating drag forces ( appendix [ s : werrors ] ) , a non - axisymmetric analytical problem used to test drag force assignment over shear - periodic boundaries ( appendix [ s : shearing ] ) , and a recipe to minimize poission noise in seeding linear particle density perturbations ( appendix [ s : coldstart ] ) .",
    "a companion paper , johansen & youdin ( 2007 , hereafter referred to as jy ) , describes the full non - linear evolution of the streaming instability into turbulence .",
    "we describe the local dynamics of the gas and solid component of a protoplanetary disk in the shearing sheet approximation ( e.g. * ? ? ?",
    "* ; * ? ? ?",
    "the cartesian coordinate frame corotates with the keplerian frequency @xmath3 at an arbitrary orbital distance @xmath4 from the central gravity source .",
    "the coordinate axes are oriented such that @xmath5 points radially outwards , @xmath6 points along the rotation direction of the disk , while @xmath7 points vertically out of the disk , parallel to the keplerian rotation vector @xmath8 .",
    "our unstratified model omits vertical gravity .",
    "we measure all velocities relative to the linearized keplerian shear flow in the rotating frame @xmath9 .",
    "analytic investigations are greatly simplified by treating solid particles as a continuous fluid of density @xmath10 and velocity @xmath11 , which evolve according to shearing sheet equations of continuity and motion @xmath12 transport terms on the left hand side of equations ( [ eq : dustcontinuity ] ) and  ( [ eq : dusteqmot ] ) include advection by the peculiar velocities , @xmath11 , and by the kepler shear , @xmath13 .",
    "the right hand side of the equation of motion ( eq . ) contains coriolis forces ( as modified by kepler shear ) and drag acceleration relative to the gas component with velocity @xmath14 .",
    "we apply a linear drag force with constant friction time @xmath15 , valid for relatively small particles in the epstein or stokes regimes @xcite .",
    "epstein s law , @xmath16 holds for particles of size @xmath17 , where @xmath18 is the mean free path of the gas molecules , @xmath19 is the gas sound speed , and @xmath20 is the internal density of rock / ice .",
    "stokes law , @xmath21 applies in the relatively narrow range @xmath22 , where @xmath23 is the local keplerian speed .",
    "yet larger particles , @xmath24 , trigger turbulent wakes with non - linear drag accelerations , which can not be modeled with a constant friction time .. in practice , however , particles this large are weakly coupled and experience the full pressure - supported headwind . ] note that stokes law is independent of gas density ( since @xmath25 ) .",
    "the dependence of epstein s law on gas density fluctuations is neglected in our calculations as it is a small correction for low mach number flow .",
    "the solid component does not feel a pressure gradient , neither from the gas , because the mass per solid particle is so high , nor from interparticle collisions , because the number density is so low .",
    "drag effects dominate collisional effects , since the collision time , @xmath26 , is long with @xmath27 , even when the particle density is large , since the rms speed of particles , @xmath28 , is much smaller than the gas sound speed . and/or if drift motions dominate particle random motions . with @xmath29 , then @xmath30 . ]    for numerical work , we also use a lagrangian description of particle motion , see  [ s : solidsaspar ] .      the equations of continuity and motion for the gas read @xmath31 equation ( [ eq : continuity ] ) reduces to @xmath32 for an incompressible gas , as was considered in yg .",
    "the momentum equation        ( [ eq : gaseqmot ] ) contains advection and coriolis forces as equation ( [ eq : dusteqmot ] ) .",
    "the main distinction between the two components is that gas is effected by pressure gradients .",
    "we include both local pressure gradients from isothermal gas density fluctuations and a constant acceleration by a global radial pressure gradient , @xmath33 , expressed using the dimensionless measure of sub - keplerian rotation @xmath34 the feedback of the linear drag force scales with the density ratio of particles to gas , @xmath35 which ensures that total momentum is conserved .",
    "equilibrium solutions to the mutually coupled equations ( [ eq : dusteqmot ] ) and  ( [ eq : gaseqmot ] ) were obtained by ( * ? ? ?",
    "* hereafter referred to as nsh ) for local and linear dynamics .",
    "the in - plane deviations from keplerian rotation are @xmath36\\frac{\\eta v_{\\rm k}}{1+{\\epsilon } }        \\ , , \\label{eq : nshuy } \\\\    w_x & = & -\\frac{2 \\tau_{\\rm s } }        { ( 1+\\epsilon)^2+\\tau_{\\rm s}^2 } \\eta v_{\\rm k }        \\ , , \\label{eq : nshwx } \\\\    w_y & = & -\\left[1- \\frac { \\tau_{\\rm s}^2 }        { ( 1+\\epsilon)^2+\\tau_{\\rm s}^2 } \\right]\\frac{\\eta v_{\\rm k}}{1+{\\epsilon } }        \\ , .",
    "\\label{eq : nshwy}\\end{aligned}\\ ] ] the dimensionless stopping time , @xmath37 , is a convenient measure of coupling strength , since marginal coupling , @xmath38 , famously maximizes the radial drift speed of an isolated particle .",
    "velocities scale with the sub - keplerian velocity , @xmath39 , where @xmath23 . and @xmath40 , is ignored in the local approximation since the effect of the keplerian shear profile is already included ( to linear order ) in the equations of motion . ]",
    "the azimuthal velocities are factored into the center - of - mass motion , @xmath41 and order @xmath42 drift motions ( see yg for details ) .",
    "vertical gradients in the solids - to - gas ratio @xmath43 give gradients in @xmath44 ( for @xmath45 ) that trigger the settling - induced kelvin - helmholz instabilities discussed in the introduction .",
    "as in yg , we also neglect vertical gravity in the present work in order to allow for a laminar equilibrium state . with vertical gravity",
    ", any initial condition must be time - dependent ( due to vertical settling ) and/or turbulent ( to halt the settling ) .",
    "furthermore , in stratified disks , drift speeds ( and even directions ) vary with height above the midplane , since @xmath46 rises with decreasing gas density and since the radial gas pressure gradient can reverse away from the mid - plane @xcite .",
    "this is particularly relevant for small grains that remain above the midplane for many orbital times .",
    "the severity of the unstratified approximation is justified by the insights gained from an initially simple , well - defined problem that rapidly turns complex .",
    "the streaming motion of solid particles through gas presents a source of free energy that is driven by pressure gradients and mediated by drag and coriolis forces .",
    "yg showed , by linearly perturbing equations ( [ eq : dusteqmot ] ) and  ( [ eq : gaseqmot ] ) about the equilibrium state given by equations ( [ eq : nshux])([eq : nshwy ] ) , that this streaming robustly triggers instability in protoplanetary disks .",
    "the instability provides a novel mechanism to generate growing particle density perturbations in a moderately dense mid - plane layer of macroscopic particles , while smaller particles ( @xmath45 ) with poor drag feedback ( @xmath47 ) will give rise to only very low , sub - dynamical growth rates .    the yg analysis and the linear test simulations in this paper are `` 2.5-d '' , i.e. all three components of velocity fluctuations are considered , but perturbations are axisymmetric and characterized by the radial and vertical wavenumbers , @xmath48 and @xmath49 . the growth rates for several choices of @xmath46 and @xmath43 ( which henceforth indicates the _ average _ value of @xmath50 in the background state , unless otherwise noted )",
    "are shown in fig .",
    "[ f : growthrates ] as a function of the dimensionless wavenumbers @xmath51 and @xmath52 .    , of the streaming instability and fastest growing radial wavenumber , @xmath48 , versus the solids - to - gas density ratio @xmath53 for a friction time of @xmath54 ( solid line ) and @xmath55 ( dashed line ) .",
    "growth becomes faster and occurs at smaller scales for increasing @xmath56 , with a particularly sharp increase in @xmath57 across @xmath58 for tightly coupled particles with @xmath55 .",
    "gray curves in lower plot ( associated with gray axis on right ) show the radial phase speed of waves .",
    "the sharp dips near @xmath59@xmath60 indicate a sign change for the wave speed : inward when gas dominates and outward when particles dominate.,width=328 ]    since particles only affect gas dynamics via drag feedback , growth rates increase for larger @xmath43 , while the relevant length scales shrink , most likely because the response time - scale of the gas speeds up as @xmath61 .",
    "[ f : kzinf ] shows these trends , along with the particularly sharp increase of @xmath57 across @xmath62 for tightly coupled particles with @xmath63 . the crucial physical distinction for marginal coupling (",
    "for which the same sharp increase is not present ) may be that for @xmath64 , azimuthal drift ( of order @xmath42 ) is no longer negligible compared to radial drift ( of order @xmath46 ) . for a more technical difference , note the gray curves in fig .",
    "[ f : kzinf ] , which show that the phase speed of waves changes sign near @xmath65 .",
    "yg noted that the phase speed tends to track the component with the fastest radial drift  solids for @xmath66 and gas for @xmath67 .",
    "curiously at @xmath68 the transition is delayed to @xmath69 .",
    "as @xmath46 decreases the switch in phase speeds gets closer to @xmath58 , coinciding with the rise in growth rates across @xmath58 becoming steeper and of larger amplitude ( see also fig . 3 of yg for the @xmath70 case ) .",
    "lllllllll lina : @xmath71 & @xmath72 & @xmath73 & @xmath74 & @xmath75 & @xmath76 & @xmath77 & @xmath78 & @xmath79 + ( @xmath80 ) & @xmath81 & @xmath82 & @xmath83 & @xmath84 & @xmath85 & @xmath86 & @xmath87 & @xmath88 + linb : @xmath89 & @xmath90 & @xmath91 & @xmath92 & @xmath93 & @xmath94 & @xmath95 & @xmath96 & @xmath97 + ( @xmath98 ) & @xmath99 & @xmath100 & @xmath101 & @xmath102 & @xmath103 & @xmath104 & @xmath105 & @xmath106 + [ t : modes ]    the trend with @xmath46 is complicated as well . in the gas - dominated regime ( @xmath107 ) growth rates show the expected rise toward the @xmath64  sweetspot \" : streaming motions are large yet particles still respond effectively to the gas .",
    "the situation reverses when particles dominate ( @xmath108 ) , with growth rates that are actually faster for tighter coupling , but at smaller length scales .",
    "returning for a moment to fig .",
    "[ f : growthrates ] , it is also evident that growth does not peak at a single pair of wavenumbers .",
    "the fastest growing @xmath109 can be determined , with only damped modes for sufficiently large @xmath109 , but growth remains flat for large @xmath110 ( indeed the curves of fig .",
    "[ f : kzinf ] are calculated in the limit @xmath111 ) . a physical explanation for the difference between large or small @xmath112 follows .",
    "the ( near ) incompressibility of the gas imposes a ratio @xmath113 . with @xmath114 ,",
    "velocity vectors are nearly parallel to the @xmath115 plane with negligible vertical velocities ( just enough to maintain gas incompressibility ) .",
    "since the balance of coriolis forces is maintained in thin vertical sheets , instability persists to large @xmath110 . on the other hand ,",
    "large @xmath116 shrinks @xmath117 and destroys the necessary balance of coriolis forces .",
    "the linear growth regime is surprisingly complex , considering the simplicity of the physical system .",
    "toy models to explain the mechanism have unfortunately fallen short of capturing the essence of the instability . for instance , one might suspect that , since streaming instabilities involve particle density enhancements , they arise because radial drift slows in overdense regions [ see equation ( [ eq : nshwx ] ) ] leading to local traffic jams . this effect , while relevant , does not explain linear growth of infinitesimal perturbations . to see this ,",
    "consider the axisymmetric evolution of particle density that follows from the equilibrium drift speed [ equation ( [ eq : nshwx ] ) ] and continuity [ equation ( [ eq : dustcontinuity ] ) ] , which we express for simplicity in terms of a _",
    "( only for now ) @xmath118 as @xmath119\\ , .\\ ] ] linearizing about @xmath120 clearly gives stable wave propagation at the drift speed .",
    "non - linear perturbations in equation ( [ eq : toydrift ] ) will steepen a particle density wave , with no amplitude growth ( readily shown by the method of characteristics , see * ? ? ? * ) .",
    "even if the traffic jam concept fails to explain the linear growth of the streaming instability , it may be used to explain the non - linear clumping seen in jy ( see also ",
    "[ s : eclump ] in this paper ) .",
    "we find in jy that non - linear states also show remarkable diversity with friction time and solids - to - gas ratio .",
    "we must , however , first ensure that the numerical algorithms can capture and confirm the linear growth phase .",
    "to test the growth rates of fig .",
    "[ f : growthrates ] computationally , the eigenvectors , i.e. relative amplitudes and phases of the density and velocity perturbations , must be carefully seeded for a specific choice of parameters @xmath121 .",
    "the perturbation in each dynamical variable @xmath122 can be written in terms of its complex amplitude @xmath123 ( a component of the full eigenvector ) as @xmath124\\}$ ] , where @xmath125 is the complex eigenvalue containing the wave frequency @xmath126 and the growth rate @xmath57 .",
    "we choose to eliminate the superfluous vertical phase speed by superposing pairs of modes with vertical wavenumbers @xmath49 and @xmath127 , respectively . under a vertical parity transformation",
    "the vertical velocity amplitudes are odd , while all others are even . the superposition yields @xmath128 \\cos(k_z z)\\exp(st )    \\label{eq : feven } \\ , , \\\\",
    "f_{\\rm o}(x , z ) & = & -        [ \\re(\\tilde{f } ) \\sin(k_x x - \\omega_\\re t ) + \\nonumber \\\\                  & & \\hspace{-0.5 cm } \\im(\\tilde{f } )                      \\cos(k_x",
    "x- \\omega_\\re t ) ] \\sin(k_z z ) \\exp(st ) \\ , ,    \\label{eq : fodd}\\end{aligned}\\ ] ] for even ( @xmath129 ) and odd ( @xmath130 ) dynamical variables , respectively , which are now clearly standing waves in @xmath7 .",
    "table [ t : modes ] lists eigenvalues and eigenvectors for the cases we will test numerically in  [ s : linear ] .",
    "the calculation is similar to that of yg except gas compressibility was added so that a gas density perturbation can be included in the numerical calculations .",
    "the effect of the gas compressibility is otherwise negligible for @xmath131 ( the reason it was neglected in yg ) , affecting eigenvalues and eigenvectors in the 5th digit for our choice of @xmath132 .",
    "we also checked that the sound waves introduced by gas compression are rapidly damped .",
    "note that table [ t : modes ] shows the gas density ( and thus pressure ) perturbations are out of phase ( by @xmath133 and @xmath134 for a and b , respectively ) with the particle density perturbation . thus solids are not merely collecting in pressure maxima , as occurs in gas density structures that are steady in time .",
    "as a numerical solver we use the pencil code .",
    "this is a modular finite difference code that uses 6th order symmetric spatial derivatives and a 3rd order runge - kutta time integration ( see * ? ? ?",
    "* for details ) .",
    "a module already exists for solving the equation of motion of a dust fluid that interacts with the main gas fluid through drag force @xcite .",
    "the basic dynamical equations in the ( here unstratified ) shearing sheet are equations ( [ eq : continuity ] ) and  ( [ eq : gaseqmot ] ) for the gas and equations ( [ eq : dustcontinuity ] ) and  ( [ eq : dusteqmot ] ) for the solids .",
    "this equation set is stabilized by adding small diffusive terms to the equation of motion and by upwinding the advection term in the continuity equations ( for details , see * ? ? ?",
    "* ; * ? ? ?",
    "treating particles as a fluid facilitates analytic calculations and is significantly cheaper for numerical simulations , but is not always the desired approach .      using lagrangian particles provides a more realistic description of the dynamics of the solids , and there are two main reasons to justify the additional effort .",
    "first , particles at a given position need not have a single well - defined velocity as the fluid approximation assumes , i.e.  trajectories can cross .",
    "this concern is particularly valid for marginal and looser coupling .",
    "second , and more seriously , the fluid treatment can not capture large density gradients , especially since the  sound speed \" of the pressureless fluid is zero .",
    "stabilization of steep density gradients would require a large artificial viscosity that compromises the dynamics .",
    "thus a lagrangian treatment of the solids is necessary for the non - linear simulations of jy which generate large particles overdensities .",
    "since the analysis of yg describes solids as a fluid , we must demonstrate that the instability does not depend crucially on this assumption .    when treating solids as numerical particles , or rather as _",
    "superparticles _ since each numerical particle effectively represents a huge number of individual solids , each particle @xmath135 has a position @xmath136 and a velocity @xmath137 relative to the keplerian shear .",
    "particle motions are governed by hill s equations @xcite @xmath138 \\ , ,        \\label{eq : dustpeqmot}\\\\    \\frac{{\\mathrm{d}}{\\mbox{\\boldmath{$x$}}}^{(i)}}{{\\mathrm{d}}t } & = & { \\mbox{\\boldmath{$v$}}}^{(i ) } -{3 \\over 2 } \\varomega    x^{(i ) } \\hat{{\\mbox{\\boldmath{$y$}}}}\\ , ,        \\label{eq : dustpeqpos}\\end{aligned}\\ ] ] here including drag force and expressed in a form to appear as the lagrangian equivalent to equation ( [ eq : dusteqmot ] ) . for axisymmetric simulations in the radial - vertical plane ,",
    "the evolution of @xmath139 is included but the azimuthal component of equation ( [ eq : dustpeqpos ] ) is irrelevant , effectively replaced by @xmath140 since that dimension that is not present .",
    "the interpolation of gas velocities at the particle positions , @xmath141 , is addressed in the next section .",
    "the computation of drag forces between lagrangian particles and an eulerian grid requires some care to avoid spurious accelerations and to ensure momentum conservation .",
    "small errors in the gas velocity are dangerously amplified by the subtraction of highly correlated particle velocities .",
    "our drag force algorithm involves three steps :    1 .   interpolating gas velocities at particle positions 2 .   calculating the drag force on particles 3 .   assigning the back - reaction force to the gas from particles in nearby cells    for the first step , interpolation ,",
    "we begin with gas velocities , @xmath142 , defined on a uniform grid where the index @xmath143 labels the cells centered on positions @xmath144 .",
    "we interpolate to the particle positions , @xmath136 , using a weight function , @xmath145 , as @xmath146 the weight function is normalized as @xmath147 for any @xmath136 , and has non - zero contributions only from the cells in the immediate vicinity of @xmath144 .    the second step , calculating the drag acceleration on particle @xmath135",
    ", @xmath148 is trivial once the relevant quantities are defined , but this is the step that amplifies interpolation errors in @xmath141 , because of strong coupling to particle velocities , a problem that worsens for smaller @xmath15 .",
    "we note that other choices of the drag law ( e.g.  non - linear in the velocity or including gas density fluctuations in epstein drag ) would be simple to implement by interpolating the relevant grid - based quantities as in equation ( [ interpgasvel ] ) .    finally , we calculate the back - reaction drag force , @xmath149 , on the gas in cell @xmath143 .",
    "assigning particle velocities to a mesh risks violating momentum conservation .",
    "instead we follow the suggestion of jim stone ( personal communication ) and use newton s third law to directly assign the force on the particles back to the gas , @xmath150 where @xmath151 is the mass of a particle ( if not uniform it would be inside the sum ) , and @xmath152 is the volume of a grid cell .",
    "the assignment function @xmath153 obeys the same conditions as @xmath145 , so that only particles in a given cell or its nearby neighbors contribute to the sum .",
    "global momentum conservation follows trivially from summation of equation ( [ eq : fgj ] ) , @xmath154 with no reference to the drag law , the interpolation function , or any properties of the assignment function except normalization .",
    "thus unlike particle - mesh calculations with interacting particles ( e.g.  by self - gravity ) , we are flexible to choose @xmath145 and @xmath153 independently , without violating momentum conservation .",
    "nevertheless , choosing @xmath155 is safest since drag forces from gas to particles  and vice - versa  are smoothed symmetrically .",
    "we opted for second order interpolation and assignment methods , either quadratic spline or quadratic polynomial , which use three grid cells in each dimension , for a total of 9 ( 27 ) for 2-d ( 3-d ) simulations , respectively .",
    "this gave considerable improvement over lower order bilinear interpolation ( but at a computational cost  the drag force calculations dominate the wall time in our simulations with high order interpolation and assignment ) .",
    "the details and errors associated with the interpolation schemes are described in appendix [ s : werrors ] .",
    "the quadratic spline assignment / interpolation method is often referred to as the triangular shaped cloud scheme ( tsc , see * ? ? ?",
    "our implementation of periodic boundary conditions , and use of higher ( than zeroth , as in * ? ? ?",
    "* ) order assignment schemes , causes particles near grid edges to exert drag forces on mesh points across the boundaries . in non - axisymmetric simulations ( such as the 3-d simulations that we present in jy ) the radial direction",
    "is shear - periodic so that two connected points at the inner and outer radial boundary are @xmath156 $ ] apart in the azimuthal direction .",
    "techniques for implementing radial boundary conditions in the shearing box are well - known @xcite .",
    "fluid variables in zones on one radial boundary are copied to ghost zones adjacent to the opposite boundary and shifted azimuthally . then differences across boundaries are performed , i.e.   copy , shift , and difference . \"    ) boundary condition for the assignment of drag forces from a particle to the gas .",
    "the dot represents a particle near the boundary and crosses indicate the ( centers of ) gas cells that receive a drag acceleration with the second order tsc assignment scheme ( grayscale of crosses indicates rough weight of drag force received by gas in each cell ) .",
    "we illustrate an example with 4 processors in the @xmath6-direction ( labeled ` ipy ` ) .",
    "the periodic direction is indicated by solid diagonal lines .",
    "the drag force assigned to ghost cells across the boundary ( circled on left ) is shifted in fourier space and then added as an acceleration on the physical grid cells at the outer boundary .",
    "note that in practice ( a ) the drag force from an individual particle influences more than three grid cells across the boundary , since displacements are not integer multiples of the grid spacing and ( b ) drag forces from all particles on a ghost zone are added before fourier shifting.,width=328 ]    the implementation of shear periodic boundary conditions for drag forces on the gas is a subtly different  assign , shift , and add \" procedure , as sketched in fig .",
    "[ f : fold ] .",
    "first we assign the ( appropriate fraction of ) drag accelerations from particles in boundary zones to gas in the ghost zones .",
    "then we shift the accelerations on the radial ghost zones in the @xmath6-direction , the inner by @xmath157 , and the outer by @xmath158 . finally these shifted accelerations are added ( or folded ) to the first real zone on the opposite side of the mesh .",
    "we interpolate ( since the ghost zones do not slide by integer numbers of grid cells ) by applying the azimuthal shift in fourier space .",
    "fourier interpolation has the advantage over high order polynomial interpolation that the function and all its derivatives are continuous .",
    "a numerical test of the radial boundary condition with shearing waves is described in appendix [ s : shearing ] .",
    "we now present measurements of linear growth rates of the streaming instability from numerical simulations .",
    "these results confirm the capabilities of our code and verify the authenticity of this fundamental instability , not yet explicitly established for a particle - based treatment of solids .",
    "our efforts in reproducing growth rates to a satisfactory accuracy were useful in developing our numerical implementation of drag forces .",
    "we hope that others who simulate coupled particle - gas disks will conduct similar dynamical tests of the simplest ( identified ) aerodynamic drag instability .",
    "we choose two different test problems : an eigenvector for @xmath55 , @xmath159 , @xmath160 ( run lina ) , which grows rapidly with @xmath161 , and an eigenvector for @xmath55 , @xmath162 , @xmath163 ( run linb ) that grows more slowly with @xmath164 and hence is more numerically demanding .",
    "the total initial velocities are the sum of the equilibrium drift solutions of equations ( [ eq : nshux])([eq : nshwy ] ) , and the vertically standing wave of equations ( [ eq : feven])([eq : fodd ] ) with eigenvectors from table [ t : modes ] .",
    "the initial amplitude of the particle density was set to @xmath165 in all cases to ensure linearity .",
    "the measured growth rate when particles are treated as a fluid is shown with a solid black line in figs .",
    "[ f : growth_gridpoints_e3.0 ] and [ f : growth_gridpoints_e0.2 ] ( the top and bottom plots are identical for the two - fluid case ) .",
    "the eight panels show the growth rate of the velocity and density of the gas ( top row ) and of the solids ( bottom row ) as a function of the number of grid points per wavelength .",
    "we have varied the resolution between 3 and 64 grid points per wavelength for the fluid treatment of solids and between 8 and 64 grid points per wavelength for the particle treatment .",
    "the growth rates are obtained by spatially fourier transforming the 8 dynamical variables at 10 fixed times over @xmath166 and measuring the amplitude growth of the relevant fourier mode .",
    "there is generally an excellent agreement between the measured growth rates when the solids are treated as a fluid and the analytical values down to 4 grid points per wavelength , except for the gas density which shows some variation from the analytical value for crude resolutions .",
    "this disagreement is not surprising since small errors in the cancellation of @xmath167 and @xmath168 for the nearly incompressible gas give spurious growth to the gas density according to the linearized continuity equation @xmath169 .",
    "while the gas density perturbations are too small to affect the drag force , they also cause the pressure perturbations which are significant .",
    "fortuitously , the errors in the gas density ( for crude resolutions ) do not affect the other dynamical variables . it may help that spurious sound waves damp rapidly ( in a stopping time ) .",
    "reproducing analytic growth rates using a particle representation of the solids is significantly more difficult than in the two - fluid case .",
    "poisson fluctuations from undersampling and truncation errors in the drag force calculation cause numerical discrepancies .",
    "section [ s : dragcalc ] and appendix [ s : werrors ] describe the algorithms for computing drag forces and the errors associated with interpolation and assignment .      to avoid shot noise in seeding linear particle density perturbations",
    "we use a `` cold start '' algorithm ( described in detail in appendix [ s : coldstart ] ) for the initial particle positions .",
    "first we place all particles on a uniform grid",
    ". then we apply a small , spatially periodic shift to their positions .",
    "this seeds the desired mode with minimal noise leaked to other wavelengths .",
    "we experimented with different numbers of particles : 25 particles per grid cell to match the non - linear runs of jy , and 1 particle per grid cell as a test .     as generated by the shifting algorithm of appendix [ s : coldstart ] with 32 particles ",
    "only one per grid cell ! the crosses ( connected by the solid line ) plot the tsc assignment of particle ( over)density to the grid cells .",
    "dots indicate the positions of the particles , but the shift is imperceptibly small.,width=328 ]    with the cold start to eliminate noise and the tsc assignment scheme to smoothly distribute a particle s influence over the nearest three grid cells per dimension , communicating initial density perturbations of infinitesimal amplitude with only a few particles is trivial .",
    "[ f : amplitude ] demonstrates the algorithm effectiveness with the near perfect replication of a 1-d particle density perturbation of amplitude @xmath165 with only 32 grid cells and one particle per cell .",
    "this is nothing more ( or less ) than the miracle of continuous numbers .",
    "the use of many particles per grid cell is still necessary to get good statistics in non - linear simulations .      the growth rates with solids as particles are shown ( together with the two - fluid results ) in figs .",
    "[ f : growth_gridpoints_e3.0 ] and [ f : growth_gridpoints_e0.2 ] as a function of spatial resolution .",
    "the top and bottom plots in each figure are for 1 and 25 particles per grid cell , respectively .",
    "particle number makes little difference for the agreement with linear theory , although additional particles give some improvement , notably for the growth rate of @xmath10 in fig .",
    "[ f : growth_gridpoints_e0.2 ] .",
    "while all runs use the tsc scheme to assign drag forces to the gas , three different techniques were tested for the interpolation of gas velocities to particle positions : ( 1 ) quadratic spline interpolation , ( 2 ) quadratic spline interpolation with an initial fourier sharpening of the gas velocity field , and ( 3 ) quadratic polynomial interpolation .",
    "errors in gas velocity interpolation are the most dangerous since they are amplified in the force calculation by subtracting a particle velocity that is highly correlated with the gas flow .    the first technique , quadratic spline interpolation , uses the same weight function as tsc assignment and gives smooth interpolates with a reduced fluctuation amplitude . the dash - dotted lines in figs .",
    "[ f : growth_gridpoints_e3.0 ] and [ f : growth_gridpoints_e0.2 ] show that this technique accurately reproduces the growth of @xmath10 .",
    "the results for the other variables are poor for resolutions of less than 16 grid points per wave length .",
    "this is a result of spurious drag forces generated because interpolation reduces gas fluctuation amplitudes .",
    "( gas is accelerated toward the unsmoothed amplitude by particles ) and too small for @xmath11 ( particles are decelerated by the lowered gas amplitudes ) . ]    the second interpolation technique ( shown with dashed lines in figs .",
    "[ f : growth_gridpoints_e3.0 ] and [ f : growth_gridpoints_e0.2 ] ) still uses quadratic splines , but sharpens the initial gas velocities to correct the drag force .",
    "the amplitude of the fourier modes @xmath170 are increased by the precise amount , @xmath171^{-1}$ ] , that interpolation reduces them ( see appendix [ s : werrors ] ) .",
    "the sharpened tsc scheme gives much better growth rates , but still not as good as the two - fluid results . in a non - linear simulation with an evolving power spectrum",
    ", one could sharpen @xmath14 with a pair of fourier transforms at each time - step , but this was deemed too computationally costly . by getting improved results with only the initial condition sharpened , we show that growth rate discrepancies with spline interpolation are largely due to differences between numerical ( discretized ) and analytic eigenvectors that should not compromise the non - linear simulations .    the third approach ( shown with dotted lines in figs .",
    "[ f : growth_gridpoints_e3.0 ] and [ f : growth_gridpoints_e0.2 ] ) opts for precise quadratic polynomial interpolation instead of smoother splines .",
    "the resulting growth rates are comparable , or slightly better than , the sharpened splines . despite the simplicity and good results obtained with this technique , we did not use it in the non - linear runs .",
    "discontinuities in the interpolates at cell boundaries would add noise by leaking power to the grid scale .",
    "since the errors of tsc are well - behaved ( spatially smooth across a grid cell , declining with increasing resolution , and leaving particle density growth unaffected even at low resolution ) , we used spline interpolation in the non - linear runs .",
    "we also prefer the symmetry of using the same weight functions for interpolation ( quadratic spline ) and assignment ( tsc ) .",
    "overall , numerical growth rates with solids treated as particles agree well with linear theory down to 16 grid points per wavelength , although the particle density grows at the correct rate even at 8 grid points per wavelength .",
    "anomalies , particularly in the gas density , suggest that sound waves are being triggered due to interpolation errors , but these spurious motions damp and do not impede the expected growth of particle density perturbations .",
    "this section provides brief overviews of energy and angular momentum in coupled particle - gas disks in order to provide a point of reference to more familiar dynamical systems , and because it will help us interpret the non - linear results of jy .",
    "we denote @xmath172 as the total angular momentum density of solids and gas , ignoring the radius factor that is constant in the local approximation .",
    "the azimuthal components of equations ( [ eq : dusteqmot ] ) and  ( [ eq : gaseqmot ] ) give @xmath173 the terms on the left hand side relate local changes in @xmath174 to the transport of @xmath175 by the keplerian flow and to the angular momentum flux @xmath176 .",
    "we do not call this flux a reynolds stress because the velocities @xmath14 and @xmath11 have not been decomposed into fluctuations about their mean .",
    "the nsh equilibrium of equations ( [ eq : nshux])([eq : nshwy ] ) transports angular momentum radially inwards , @xmath177 ^ 2        \\label{eq : flx}\\ , , \\end{aligned}\\ ] ] a consequence of the slower rotation of the outgoing gas relative to the faster rotation of the incoming particles .",
    "this differs from the usual outward transport of angular momentum in accretion disks @xcite , because the driving agent is not orbital shear , but the radial pressure gradient .",
    "the terms on the right hand side of equation ( [ eq : ldot ] ) represent sources or sinks of angular momentum : the radial mass flux , @xmath178 , and azimuthal pressure gradients , where @xmath179 is promoted to denote the total gas pressure ( background and perturbations ) in this section .",
    "equation ( [ eq : ldot ] ) proves that axisymmetric equilibrium solutions can not transport mass radially in the local model , a condition obeyed by equations ( [ eq : nshux ] ) and  ( [ eq : nshwx ] ) .",
    "note that equation ( [ eq : ldot ] ) does not explicitly include drag forces , which transfer momentum between gas and solids , but ( of course ) do not dissipate @xmath174 .    the evolution of kinetic energy density @xmath180 with equation ( [ eq : gaseqmot ] ) and @xmath181 with equation ( [ eq : dusteqmot ] ) to give @xmath182 where the energy flux , @xmath183 the sources and sinks on the right hand side include the energy lost to drag dissipation , @xmath184 ^ 2}(\\eta v_{\\rm k})^2\\rho_{\\rm p}\\varomega\\ , , \\label{eq : dedrageq}\\end{aligned}\\ ] ] where the second equality applies to the nsh equilibrium .",
    "a simple estimate of the effective temperature produced when the dissipated kinetic energy is released as thermal heat gives @xmath185^{1/4 } \\sim 30 ( r/\\mathrm{au})^{-3/4}\\ , \\mathrm{k}\\ ] ] as an upper limit for the case of marginal coupling and @xmath186 , where @xmath187 is the surface density of the solid component and @xmath188 is the scale height of the sublayer of solids .",
    "the above temperature limit is significantly colder than even passively irradiated disks @xcite , a comforting fact for sed modelers .",
    "the @xmath189 term represents energy gained from the work done by the total pressure forces .",
    "the equilibrium value of @xmath190 shows that @xmath191 ^ 2}(\\eta v_{\\rm k})^2\\rho_{\\rm p}\\varomega \\ , , \\label{eq : del}\\ ] ] is well known in studies of viscous or collisional disks as the heat generated by the outward transport of angular momentum @xcite .",
    "however , in our case angular momentum transport is reversed according to equation ( [ eq : flx ] ) and provides a sink of kinetic energy .",
    "the phenomenon of  backwards \" angular momentum transport , and the dynamical cooling it provides , has been famously offered as an explanation for the sharp edges of planetary rings @xcite .",
    "equations ( [ eq : dedrageq ] ) , ( [ eq : dework ] ) , and ( [ eq : del ] ) verify that the heating and cooling terms sum up to zero in the equilibrium state : @xmath192 . the work done by pressure forces balances dissipation by drag forces and losses from the backwards transport of angular momentum .      in this subsection",
    "we will show that particle clumping reduces energy dissipation by drag forces , at least in a laminar state .",
    "particles effectively  draft \" off each other like birds flying in formation or bicycle riders in a peloton .",
    "this drafting does not rely on overlapping turbulent wakes , but instead depends on slowing relative gas motions by the collective inertia of particles .",
    "it is tempting to argue that the lowered dissipation rate explains the tendency of particles to clump . as usual , the story is more complicated , but the evolution of @xmath193 turns out to be a useful diagnostic for the non - linear simulations of jy .    first we demonstrate that dissipation is reduced by clumping . consider the equilibrium drag dissipation of equation ( [ eq : dedrageq ] ) , for simplicity in the tight coupling limit ( @xmath45 ) , which we now express per unit surface area instead of volume as @xmath194 now imagine concentrating the particles into a volume smaller by a factor @xmath195 via vertical setting or clumping .",
    "compared to the uniform solids - to - gas ratio @xmath56 the new value is @xmath196 in clumps and 0 in voids .",
    "the new height - averaged dissipation rate is @xmath197 the fractional change in dissipation ( for @xmath45 ) , @xmath198 shows that clumping decreases the net dissipation of well - coupled particles and that the effect becomes stronger with increasing @xmath43 .",
    "unfortunately there is no reason to expect in general that the dissipation rate decreases , especially since the system is not closed , but driven by pressure gradients .",
    "examples of driven systems in which mechanical dissipation increases with the spontaneous transition from laminar to turbulent flow include drag on a rigid body ( e.g.  an airplane wing ) and rayleigh convection with fixed temperature on the endplates ( jeremy goodman , personal communication ) .",
    "indeed the non - linear simulations of jy find that @xmath199 could increase or decrease in the non - linear state .",
    "obviously drag dissipation is affected not just by clumping ( as in the toy laminar calculation here ) but by the turbulent velocities that tend to increase dissipation .",
    "nevertheless jy demonstrate that runs with the largest ( and longest lived ) overdensities show a decrease in @xmath199 , lending credence to the hypothesis that drafting can augment particles ability to clump .",
    "this paper begins our numerical exploration of the streaming instability , which uses aerodynamic particle - gas coupling to tap the radial pressure gradient in protoplanetary disks .",
    "growing oscillations arise in an idealized model for protoplanetary disks that assumes a local , unstratified , and non - self - gravitating shearing box with gas and uniformly - sized , non - colliding solids .",
    "studying a relatively simple system isolates the surprisingly rich consequences of mutual drag coupling in disks .",
    "also , the well - defined growth rates of seeded eigenvectors make the streaming instability an ideal test of numerical implementations of particle - gas dynamics , as suggested in yg . we encourage those who study manifestations of particle - gas dynamics in disks to consider the linear streaming instability as a test problem if the feedback of solids on gas dynamics is relevant .",
    "this work is largely successful in reproducing the analytic growth rates of yg .",
    "the two - fluid simulations , which treat solids as a pressureless fluid , give excellent results with minimal computational effort .",
    "particle - fluid simulations also converge to the analytic results , but higher spatial resolution is required . treating the solids as particles",
    "has several advantages ",
    "it is more realistic , it can validate the often - used fluid approximation for solids , and it allows the development of non - linear density enhancements without spurious shocks .",
    "refinements of the particle - fluid algorithm used in @xcite are described , notably the use of higher order interpolation and assignment schemes to minimize errors in the drag force computation .",
    "these errors become more drastic as the stopping time decreases and errors grow relative to the diminishing difference between gas and particle velocities . smaller stopping times",
    "also give shorter length scales , thereby imposing stricter courant criteria .",
    "these restrictions actually dominate the obvious concern that tighter coupling stiffens the equations of motion .",
    "detailed modeling of the smallest particles in protoplanetary disks , especially in the inner regions with high gas densities , will require further algorithm development and increased computational power .",
    "in the meantime , studies of moderate coupling can establish the relevant physical phenomena and provide a baseline for extrapolation to more extreme parameters .    having developed a particle - mesh scheme that can be trusted to simulate coupled particle - gas dynamics with feedback ,",
    "we proceed to explore the non - linear evolution of streaming instabilities in a companion paper ( johansen & youdin 2007 ) with particular attention to the growth and saturation of particle overdensities .",
    "the authors would like to thank jeremy goodman and jim stone for valuable advice and encouragement throughout this project .",
    "an anonymous referee is thanked for a number of suggestions that helped improve the original manuscript .",
    "acknowledges support nasa grant nag5 - 11664 issued through the office of space science .",
    "is grateful to the annette kade graduate student fellowship program for his stay at the american museum of natural history .",
    "_ facilities : _",
    "the choice of weight functions for interpolation , @xmath145 , and assignment , @xmath153 , involves trading computational cost against performance .",
    "we will consider only 1-d weight functions which are combined multiplicatively to form multidimensional weights , @xmath200 , for the cell centered at @xmath201 .",
    "this assumes a rectilinear domain of influence , which is simpler ( if less physical ) than circular / spherical clouds .",
    "the interpolation function in the non - linear simulations uses quadratic splines ( qs ) , @xmath202 where @xmath203 measures the distance from a cell center and @xmath145 extends over three cells of width @xmath204 .",
    "the interpolation errors are calculated by considering a periodic function ( of arbitrary phase ) sampled at the grid points .",
    "the qs interpolated values at arbitrary @xmath5 in cell @xmath205 are @xmath206 +        \\sin(k x + \\phi)\\left[{(\\delta k)^3 \\over 24 } \\delta x_\\ell(1 - 4\\delta x_\\ell^2 )    \\right ]   + \\mathcal{o}(\\delta k)^4 \\ , .\\end{aligned}\\ ] ] the amplitude of a periodic signal is reduced by @xmath207 . for an arbitrary distribution , this smoothing can be simply corrected for in fourier space .",
    "this sharpening is included , but only for the initial amplitudes of @xmath14 , in some linear tests (  [ s : linearpart ] ) , but was too costly for the non - linear runs in jy .",
    "there is also a noise , i.e.  an error that depends on position relative to cell center @xmath208 , of amplitude @xmath209 .",
    "we also considered quadratic polynomial interpolation ( qp ) , which performs a best fit through the three nearest grid points , resulting in a weight function @xmath210 the qp interpolated values of a periodic signal read @xmath211 + \\mathcal{o}(\\delta k)^4\\ , .\\ ] ] the amplitude is preserved to second order , an improvement over quadratic spline interpolation .",
    "the noise , however , has an amplitude of @xmath212 , a factor of 15 larger than with quadratic spline .",
    "also troubling is the discontinuity of @xmath213 at the cell boundaries .",
    "the assignment function used in all the non - linear simulations of jy is the triangular shaped cloud ( tsc ) scheme , as opposed to the lower order ngp ( nearest grid point , which was used in * ? ? ? * ) or cic ( cloud in cell ) schemes @xcite .",
    "the tsc assignment weight function is identical to the quadratic spline interpolation weight function , @xmath214 .",
    "assignment errors depend partly on sampling , i.e.  the number of particles that make a non - zero contribution to a sum like equation ( [ eq : fgj ] )",
    ". a higher order method like tsc samples more particles at a given grid point and gives a smoother distribution than lower order methods .",
    "the fractional amplitude reduction of a mode perfectly sampled by tsc is identical to the result for quadratic spline interpolation , @xmath215 .",
    "this is the same order , but larger than for cic [ @xmath216 or ngp [ @xmath217 assignment , although especially the ngp scheme would require an enormous particle number to achieve good sampling of linear perturbations . in principle fourier sharpening could be applied in the force assignment step , but it is less important to consider , since the errors are not magnified by a subsequent subtraction .",
    "this appendix studies the behavior of a linear , non - axisymmetric wave of gas and particles in order to test drag force assignment across the shear - periodic radial boundary",
    ". solutions from the full simulation of the pencil code are compared to the following semi - analytic problem .",
    "we use local , linearized equations of continuity and motion to describe the evolution of gas and particle density @xmath218 , @xmath219 relative to a constant density background state @xmath220 , @xmath221 , and gas and particle velocities @xmath222 , @xmath223 relative to the keplerian shear flow @xmath224 .",
    "we assume a shearing wave solution , @xmath225 $ ] , for each perturbation variable , with ( see e.g. * ? ? ?",
    "* ; * ? ? ?",
    "* ) @xmath226 the wave amplitudes then evolve as coupled ordinary differential equations in time , @xmath227    \\label{eq : lin_rhoghat } \\ , , \\\\    { \\mathrm{d}}\\hat{u}_x/{\\mathrm{d}}t & = &         2 \\varomega \\hat{u}_y        -{\\epsilon}_0        ( \\hat{u}_x-\\hat{w}_x)/\\tau_{\\rm f }        - { \\mathrm i}k_x(t ) c_{\\rm s}^2\\hat{\\rho}_{\\rm g}/\\rho_{{\\rm g},0 }    \\label{eq : lin_uxhat } \\ , , \\\\ { \\mathrm{d}}\\hat{u}_y/{\\mathrm{d}}t & = &        - \\varomega \\hat{u}_x/2        -{\\epsilon}_0        ( \\hat{u}_y-\\hat{w}_y)/\\tau_{\\rm f }        - { \\mathrm i}k_y c_{\\rm s}^2\\hat{\\rho}_{\\rm g}/\\rho_{{\\rm g},0 }    \\label{eq : lin_uyhat } \\ , , \\\\ { \\mathrm{d}}\\hat{\\rho}_{\\rm p}/{\\mathrm{d}}t & = &        -\\rho_{{\\rm p},0 } [ { \\mathrm i}k_x(t ) \\hat{w}_x + { \\mathrm i}k_y \\hat{w}_y ]    \\label{eq : lin_rhophat } \\ , , \\\\ { \\mathrm{d}}\\hat{w}_x/{\\mathrm{d}}t & = &         2 \\varomega \\hat{w}_y        - ( \\hat{w}_x-\\hat{u}_x)/\\tau_{\\rm f }    \\label{eq : lin_wxhat } \\ , , \\\\ { \\mathrm{d}}\\hat{w}_y/{\\mathrm{d}}t & = &        - \\varomega \\hat{w}_x/2        - ( \\hat{w}_y-\\hat{u}_y)/\\tau_{\\rm f }    \\label{eq : lin_wyhat } \\ , .\\end{aligned}\\ ] ]",
    "where @xmath228 .",
    "we solve this system of ordinary differential equations numerically for @xmath229 using a third - order runge - kutta time integration method to follow the temporal evolution of a non - axisymmetric wave with the initial condition @xmath230 .",
    "the semi - analytic solution is then compared to the evolution obtained with the full solver of the pencil code using @xmath231 grid points with 1 particle per grid point to cover a box of size @xmath232 .",
    "[ f : testmode ] shows the evolution of the absolute value of the particle amplitudes @xmath233 ( dash - dotted line ) , @xmath234 ( dotted line ) and @xmath235 ( dashed line ) in comparison with the analytical solution ( gray lines ) .",
    "there is an excellent agreement for @xmath236 . at later times",
    ", the wave becomes so tightly wound that damping of the wave amplitude by the tsc scheme becomes significant .",
    "most importantly this non - axisymmetric test problem never shows any spurious features near the radial boundary ( or anywhere else ) , validating our implementation of drag force assignment over the boundaries .",
    "( black dash - dotted line ) and of the particle velocity components @xmath234 ( black dotted line ) and @xmath235 ( black dashed line ) .",
    "there is excellent agreement between the numerical and the analytical solutions up until @xmath237 where damping of the amplitude of the tightly wound wave by the triangular shaped cloud scheme becomes significant.,width=328 ]",
    "seeding low amplitude ( we use @xmath238 ) density perturbations with particles is non - trivial .",
    "the desired density distribution can not be seeded by random numbers for a reasonable number of particles , @xmath239 .",
    "the white poisson noise has a constant fourier amplitude of @xmath240 at all scales , i.e. , we would need a total number of particles @xmath241 to resolve @xmath238 !",
    "instead we borrow a tactic from cosmological simulations ( e.g. * ? ? ? * ) to concentrate power in a desired mode .",
    "we first assign particles to a uniform grid with positions , @xmath242 , labeled by a particle index @xmath243 .",
    "this grid is defined relative to the gas grid with an integer number of particles in each gas cell .",
    "we introduce linear perturbations to the density by applying periodic shifts to the particle positions . to approximate a density distribution @xmath244\\ ] ] with @xmath245 ,",
    "the desired shift from the uniform grid is @xmath246 the resulting density distribution , @xmath247 has a fourier transform @xmath248\\right\\}\\\\    & \\approx & { n_{\\rm p } \\over v_{\\rm cell}}\\left[\\delta_{{\\mbox{\\boldmath{$\\scriptstyle{k}$}}},0 } + a(\\delta_{{\\mbox{\\boldmath{$\\scriptstyle{k}$}}},{\\mbox{\\boldmath{$\\scriptstyle{k}$}}}_0}+\\delta_{{\\mbox{\\boldmath{$\\scriptstyle{k}$}}},-{\\mbox{\\boldmath{$\\scriptstyle{k}$}}}_0})/2\\right ] + \\tilde{\\rho}_{\\rm p}^{(2)}({\\mbox{\\boldmath{$k$}}})+ \\mathcal{o}(a^3)\\ , , \\end{aligned}\\ ] ] where @xmath152 is the volume of a grid cell .",
    "the final step shows that we reproduce the desired plane wave to lowest order by performing an expansion about @xmath249 and using summation relations for periodic functions ( we ignore the sub - gridscale aliases of @xmath250 ) .",
    "the standing wave solutions described in sect .",
    "[ s : sianalytic ] are produced by summing two plane - wave displacements of @xmath251 .",
    "the quadratic error term @xmath252 is small for @xmath245 , but is eliminated by a further displacement @xmath253 thus equation ( [ eq : shiftdist ] ) has the desired fourier properties even with only one particle per grid cell .",
    "however , the binned density distribution is actually what is relevant for influencing gas dynamics . when the tsc assignment scheme ( described in appendix b ) is applied to the  cold start \" positions , we cleanly get the desired density distribution assigned on the mesh , even for arbitrarily small shift amplitudes ."
  ],
  "abstract_text": [
    "<S> we present local simulations that verify the linear streaming instability that arises from aerodynamic coupling between solids and gas in protoplanetary disks . </S>",
    "<S> this robust instability creates enhancements in the particle density in order to tap the free energy of the relative drift between solids and gas , generated by the radial pressure gradient of the disk . </S>",
    "<S> we confirm the analytic growth rates found by youdin & goodman ( 2005 ) using grid hydrodynamics to simulate the gas and , alternatively , particle and grid representations of the solids . </S>",
    "<S> since the analytic derivation approximates particles as a fluid , this work corroborates the streaming instability when solids are treated as particles . the idealized physical conditions  </S>",
    "<S> axisymmetry , uniform particle size , and the neglect of vertical stratification and collisions  provide a rigorous , well - defined test of any numerical algorithm for coupled particle - gas dynamics in protoplanetary disks . </S>",
    "<S> we describe a numerical particle - mesh implementation of the drag force , which is crucial for resolving the coupled oscillations . </S>",
    "<S> finally we comment on the balance of energy and angular momentum in two - component disks with frictional coupling . </S>",
    "<S> a companion paper details the non - linear evolution of the streaming instability into saturated turbulence with dense particle clumps . </S>"
  ]
}