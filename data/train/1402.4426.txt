{
  "article_text": [
    "complex networks are the output of certain non deterministic processes @xcite , therefore they should be considered as intrinsically random objects . from this point of view statistical mechanics provides the best framework to analyze and understand complex networks .",
    "indeed , in the last years , several fundamental results on complex networks have been derived by using ideas and techniques borrowed from statistical mechanics . in particular , exact analysis has been done by applying concepts like micro - canonical and canonical ensembles and asymptotic techniques within the configuration model @xcite , and more general approaches and results have been derived via entropy maximization for both canonical ( shannon entropy ) @xcite , and micro - canonical ensembles ( boltzmann entropy ) @xcite .",
    "however , not all aspects of statistical mechanics have been applied to complex networks so far . a key concept in statistical mechanics",
    "is represented by the _",
    "thermodynamic limit _ : a large system composed of @xmath2 elements at given concentration , is said to have a thermodynamic limit when the relative fluctuations @xmath3 of any physical observable @xmath4 , extensive in the system size @xmath2 , become negligible for large @xmath2 @xmath5 where @xmath6 stands for sample - average , or expected value , and the limit @xmath7 is performed by keeping the concentration constant . in probability theory ,",
    "( [ ri ] ) can be derived from the strong law of large numbers @xcite : if @xmath4 is a sum of identically distributed weakly dependent random variables , @xmath8 , the density @xmath9 tends to the expected value of @xmath10 , @xmath11 , with probability 1 and , in particular , eq .",
    "( [ ri ] ) applies .",
    "vice - versa , if eq .",
    "( [ ri ] ) is true , a law of large numbers applies , ( though not necessarily strong ) .",
    "for example , on a regular lattice , an ising model of @xmath2 spins coupled through ferromagnetic interactions at high enough temperature has a thermodynamic limit .",
    "the existence of the thermodynamic limit in the ising model ensures that , regardless of any boundary conditions , the value of the density of the energy @xmath12 ( or any extensive observable ) `` tends '' always to a same number @xmath13 . since the thermodynamic limit exists",
    ", we can ignore the sample - to - sample fluctuations and , for a sufficiently large system , we can identify the actual value @xmath12 with its limit number @xmath13 .",
    "notice that , rigorously speaking , @xmath12 is a random variable and the correct way to state the existence of the thermodynamic limit is @xmath14 more in general , a system might not have a well defined thermodynamic limit for certain observables , but have it for others .",
    "the latter are called self - averaging observables and are characterized by a ratio @xmath15 that goes to 0 when @xmath7 .",
    "for example , in the ising model , at low enough temperature the magnetization does not satisfy the analogous of eq .",
    "( [ tli ] ) , the magnetization being dependent on the two possible classes of boundary conditions ( majority of the spins up or down , respectively ) .",
    "this kind of non self - averaging is trivial , but there are more intriguing examples .",
    "for instance , in mean - field models of spin - glasses , where the spins interact through couplings having random signs , the free energy `` landscape '' is known to be rather `` rugged '' , with many valleys separated by high barriers whose height grows with the system size @xmath2 .",
    "from this picture , it is intuitively clear that the probability to find the system in a certain region of the phase space depends always on the system sample , even in the limit of @xmath7 @xcite .",
    "nevertheless , the energy of the system is self - averaging . upon applying the results of this paper",
    ", we will see that a similar picture holds also for complex networks .",
    "specifically , we analyze the behavior of the relative fluctuations of the densities of the motifs @xmath16 , where @xmath17 represent any motif ( see fig .",
    "[ fig1 ] ) , and @xmath18 is the generalized degree of node @xmath19 counting how many motifs @xmath17 pass through it .",
    "we will see that , despite @xmath20 is an extensive observable ( proportional to ) , no strong law of large numbers applies . in order to make precise these statements , we need to introduce the concept of _ hidden - variable models_.    the processes that generate real complex networks are the result of certain complex dynamics governed by many internal ( system ) and external ( environment ) factors .",
    "a way to model these pseudo random processes consist in treating them as hidden random processes characterized by some hidden variables whose distribution is supposed to be accessible .",
    "the family of models that best fit such a scheme is provided by the class of hidden - variable models @xcite .",
    "depending on the context , the input in these models are either the expected degree of each node @xmath21 , or their probability density function ( pdf ) @xmath22 . in general , in a hidden - variable model , the resulting degree distribution coincides with ( is proportional to ) @xmath22 @xcite ( though , as we will see , not all characteristics of @xmath22 are reproduced if the cut - off is not properly chosen ) . in view of applications ,",
    "given a `` hidden '' process that generates real networks , it is crucially important to distinguish what kind of modeling we are pursuing at .",
    "if we are interested in reproducing in simulations all possible graph realizations compatible with a specific real network , _ i.e. _ a single output of the hidden random process , the input that we need to know are the expected degrees @xmath21 , which must be treated as fixed parameters .",
    "if we are instead interested in reproducing in simulations all possible network realizations as outputs of the whole hidden random process , the expected degrees @xmath21 must be treated as random variables , and the input of the model is the pdf @xmath22 . in @xcite",
    "we have shown that in this latter case , if @xmath23 , and if we use a large cut - off @xmath24 , the fluctuations of the motif densities @xmath20 in general are not negligible .",
    "in fact , given a motif @xmath17 , there exists an interval @xmath25 where the relative fluctuations of @xmath20 , @xmath26 , diverge in the thermodynamic limit , where @xmath27 and @xmath28 , @xmath29 and @xmath30 being the smallest and the largest degree of @xmath17 ( see figs .",
    "[ fig2]-[fig7 ] ) .",
    "by contrast , in classical random graphs @xmath20 is always self - averaging .    by using these results",
    ", we now understand the analogy with spin - glasses .",
    "let us consider the space @xmath31 , and the probability on the space @xmath31 , @xmath32 , where @xmath33 , and @xmath34 is the set of all possible motifs compatible with the size @xmath2 . for fixed @xmath2",
    ", @xmath32 provides the probability to find a network realization with densities @xmath31 . in a classical random graph ensemble , for @xmath2",
    "large enough we have ( @xmath35 stands for kronecker s delta function ) @xmath36 whereas , due to the non - self - averaging behavior for models characterized by power laws , we have @xmath37 eq .",
    "( [ png1 ] ) is the complex network analog of the aforementioned rugged spin - glass picture : the probability to find the network in a given configuration @xmath31 depends always on the specific sample , even if @xmath7 . in this paper",
    "we show that the non - self - averaging scenario of eq .",
    "( [ png1 ] ) is due only to the variability of the expected degrees of the nodes @xmath21 .",
    "in fact , we will show that , when the sequence @xmath21 is supposed to be fixed , _",
    "i.e. _ , when we want to reproduce all the possible graphs compatible with the fixed sequence @xmath21 , the fluctuations are small , and the standard law of large numbers recovered for any observable : @xmath38 . as a consequence ,",
    "when the sequence @xmath21 is fixed , eq . ( [ png ] ) applies like in the classical random graph   to have degree @xmath39 , conditioned on the expected degree @xmath40 , is a poissonian distribution , whose fluctuations , as known , are standard . ] .",
    "we will see however also that , as a result of the non - self - averaging scenario , even if we are dealing with a case of fixed expected degrees , the fact that our knowledge on the expected degree sequence @xmath21 is affected by unavoidable finite errors , will result in a systematic bias between the simulations and the real network .",
    "may specify the number of links of the motif ; for motifs made of @xmath41 fully connected nodes , @xmath41-cliques , we also use the symbol @xmath42 ; @xmath43 in @xmath44 stands for the presence of a diagonal ; @xmath45 stands for two @xmath41-cliques sharing a common node ; @xmath46 stands for a star - like motif with @xmath41 links ; @xmath47 stands for an open linear motif made of @xmath41 consecutive links .",
    "[ fig1 ] , title=\"fig:\",height=432 ]    quite interestingly , we will also see that we recover the limit ( [ png ] ) both when @xmath48 , and when @xmath49 . whereas the former is intuitively expected since @xmath48 corresponds , roughly speaking , to a an exponential decay @xmath50 , _",
    "i.e. _ , it is a classical random graph limit , the latter is due to the fact that entropy of power - law random graphs goes to 0 when @xmath51 @xcite .",
    "the ultimate mathematical reason for the non - self - averaging behavior lies in the necessity to choose a large cut - off in the hidden - variable models .",
    "in fact , as we will see in sec .",
    "ii , if a target network is characterized by a power - law degree distribution @xmath52 , a hidden - variable model with pdf @xmath23 reproduces the correct scaling behavior of @xmath53 only if we choose a cut - off @xmath54 with @xmath1 . to the best of our knowledge ,",
    "this important fact has remained unknown so far . in sec .",
    "ii we will make it clear that , for any @xmath55 , choosing @xmath56 leads to an incorrect scaling of the moments of the sampled degree in the model .",
    "by contrast , in literature , the so called natural cut - off @xmath57 , or the structural cut - off @xmath58 , were often used for @xmath59 , or @xmath60 , respectively .",
    "in fact , in @xcite fluctuations of a few motifs have been analyzed but , as a consequence of the small cut - off , @xmath61 remained finite .",
    "if networks characterized by power law distributions are non self - averaging , network configurations , like in spin - glass models , are intrinsically unpredictable . furthermore , unless @xmath55 is close to 2 , or very large , the broad distribution ( [ png1 ] ) makes a power - law network effectively unstable to small perturbations .",
    "this in particular reflects on the stability / instability of communities @xcite , and more in general to the stability / instability of the motifs on which the functionality of the network largely depends @xcite .",
    "the paper is organized as follows . in sec .",
    "ii we review the definition of hidden - variable models and show the necessity to choose a cut - off that scales as @xmath0 , with @xmath1 . in sec .",
    "iii we distinguish between node - hidden variables and link - hidden variables and define three different ways of sampling according to the order we sample the two sets of hidden variables . in sec .",
    "iv for each ensemble we introduce the proper relative fluctuation ratio . in sec .",
    "v we collect and state the main result . finally in sec .",
    "vi we provide detailed proofs of the eqs . listed in sec .",
    "v , as well as the analysis of @xmath15 for specific motifs , whose plots are reported in figs .",
    "( [ fig2]-[fig8 ] ) .",
    "the reader not interested in detailed diagrammatic calculations may skip the reading of sec .",
    "v. at the end of the paper some conclusions are finally drawn .",
    "part of the results reported in this paper were shortly presented in the letter @xcite . in the present paper , besides the novel content , we provide full analysis of several aspects that were only shortly mentioned in @xcite .",
    "hidden - variable models are `` soft '' models where , unlike `` hard '' models , graph constrains are satisfied only on average .",
    "hidden - variable models have the remarkable advantage to be analytically treatable .",
    "in fact , in this paper it will be evident that the average of almost any observable can be reduced to suitable integrals .",
    "we now review briefly the definition of hidden - variable models . given @xmath2 nodes , hidden variable models are defined in the following way : _",
    "i ) _ to each node we associate a hidden variable @xmath62 drawn from a given probability density function ( pdf ) @xmath22 ; _ ii ) _ between any pair of nodes , we assign , or not assign , a link , according to a given probability @xmath63 , where @xmath62 and @xmath64 are the hidden variables associated to the two nodes",
    ". the probability @xmath63 can be any function of the @xmath62 s , the only requirement being that @xmath65 .",
    "the hidden variables can be real numbers or also vectors .",
    "many networks can be embedded in a hidden - variable scheme .",
    "for example , in random geometric graphs the @xmath62 s are vectors representing the positions of the nodes , and the @xmath63 s are defined in terms of geometric rules ( non deterministic if @xmath66 , or deterministic if @xmath63 takes only the values 0 or 1 ) .",
    "particular attention has been paid to the `` configuration model '' . in this case",
    "@xmath63 has the following form ( or similar generalizations )   @xmath67 where @xmath68 is the wanted average degree , for large @xmath2 . in general , the actual degree @xmath41 of the nodes of the network realized with the above scheme are distributed according to @xmath69 with actual average degree equal to @xmath68 .",
    "in particular , if we choose the following pdf having support in @xmath70 $ ] @xmath71 with @xmath72 , the degree - distribution @xmath53 of the resulting network will be a power law with exponent @xmath55 and , the normalization constant @xmath73 , and the so called structural cut - off @xmath74 are @xmath75 @xmath76 when @xmath77 , correlations of the generated network are negligible , and @xmath78 , while for @xmath79 correlations can be important .",
    "the choice of the cut - off @xmath80 may be in principle arbitrary .",
    "however , most of real - world networks show that the maximal degree scales according to the so called natural cut - off : @xmath81 .",
    "a consequence of this observation was that in several models of complex networks it was assumed the choice @xmath82 , justified as empirical .",
    "we think however that such an approach is wrong : the fact that in most of the real - world networks @xmath83 is due to a probabilistic effect , is not due to a rigid upper bound @xmath84 .",
    "in fact , by using order - statistics one finds that by drawing @xmath2 degree values from a power law with exponent @xmath55 , the highest degree in average scales just as @xmath85 @xcite .",
    "more precisely , it is possible to prove that the pdf for the rescaled random variable @xmath86 is also a power law with exponent @xmath55 @xcite .",
    "power law distributions always lead to important fluctuations .",
    "it is then clear that empirical observations of @xmath30 must be taken with care : @xmath30 is not a self - averaging variable and samples in which @xmath87 , even if extremely rare , do exist and , as we shall see , have dramatic effects on the fluctuations of motifs .",
    "we stress that here we follow a null - model approach .",
    "we do not claim that the degree of all real networks must have a cut - off scaling with @xmath2 ; there might be of course many other possible scalings whose value depend on the details of the system ( related to physical , biological , or economical constraints ) .",
    "however , if the only information that we have from a given real network of size @xmath2 is that _",
    "i ) _ the degree obeys a power - law distribution with exponent @xmath55 , and _",
    "ii ) _ highest degrees scale in average as @xmath88 , forcing the model to have a specific cut - off other than @xmath2 would introduce a bias .",
    "in fact , order statistics tells us that a lower cut - off would produce @xmath89 .",
    "this observation leads us to choose @xmath90 for the hidden - variable scheme ( [ cm])-([rho ] ) .",
    "more precisely , if we consider as target degree distribution a power - law @xmath91 having finite support @xmath92 , in order to reproduce its characteristics from the hidden - variable model we need to use a cut - off @xmath93 with @xmath1 .",
    "in fact , any other choice implies a difference in the scaling of the moments @xmath94 between the hidden variable model ( [ cm])-([rho ] ) and the target distribution @xmath53 .",
    "[ figkk_pre ] shows this property for @xmath95 and @xmath96 , whereas fig .",
    "[ figkkk_pre ] show a case for @xmath97 and @xmath98 .",
    "similar plots hold for higher moments . in general , for any @xmath55 there is exists a minimal exponent @xmath99 such that , to reproduce correctly the behavior of @xmath94 with @xmath100 we need @xmath1 . notice that larger cut - offs do not change the moments @xmath94 , but result in larger fluctuations of the motif densities @xmath20 . in conclusion , the minimal cut - off of the model ( [ cm])-([rho ] ) able to reproduce the correct scaling of all the moments of the target degree distribution @xmath52 is just @xmath93 with @xmath101 . in this paper",
    "we set therefore @xmath102 .",
    "we stress that with this choice highest degrees will be still order @xmath88 , but only on average .     _ vs _ the system size @xmath2 for @xmath103 .",
    "the upper plot corresponds to the target degree distribution which is a pure power law @xmath104 , whereas the other plots correspond to the hidden variable model ( [ cm])-([rho ] ) with different choices of the cut - off @xmath54 : @xmath105 ( corresponding to the `` structural cur - off '' ) , @xmath106 ( corresponding to the `` natural cut - off '' ) , @xmath107 , @xmath101 , and @xmath108 . for higher values of @xmath109",
    ", the plots saturate to a curve that , on this scale , is indistinguishable from the case @xmath108 .",
    "the plots of the hidden - variable model have been calculated by numerical evaluation of the involved integrals : @xmath110 ( see below for a more detailed analysis of these techniques ) .",
    "[ figkk_pre ] , title=\"fig:\",height=220 ]     _ vs _ the system size @xmath2 for @xmath111 .",
    "the upper plot corresponds to the target degree distribution which is a pure power law @xmath104 , whereas the other plots correspond to the hidden variable model ( [ cm])-([rho ] ) with different choices of the cut - off @xmath54 : @xmath112 ( corresponding to the `` natural cut - off '' ) , @xmath105 ( corresponding to the `` structural cur - off '' ) , @xmath107 , @xmath101 , and @xmath108 . for higher values of @xmath109",
    ", the plots saturate to a curve that , on this scale , is indistinguishable from the case @xmath108 .",
    "the plots of the hidden - variable model have been calculated by numerical evaluation of the involved integrals : @xmath113 @xmath114 ( see below for a more detailed analysis of these techniques ) .",
    "[ figkkk_pre ] , title=\"fig:\",height=220 ]",
    "an attentive observation of the hidden - variable scheme shows us that , actually , for each graph realization , besides the set of the @xmath2 hidden variables @xmath115 , that from now on we shall call the node - hidden - variables , we need also the set of the @xmath116 link - hidden - variables @xmath117 , where each @xmath118 is drawn independently from the uniform distribution on the interval @xmath119 $ ] .",
    "in fact , for each couple of nodes @xmath19 and @xmath120 , with associated the node - hidden - variables @xmath40 and @xmath121 , respectively , we need to sample the corresponding probability @xmath122 in order to establish the presence or not of a link between the nodes @xmath19 and @xmath120 . to this aim",
    "we draw a random number @xmath123 uniformly distributed on the interval @xmath119 $ ] , and the nodes @xmath19 and @xmath120 are connected through a link if @xmath124 , while they remain not connected if @xmath125 .",
    "all the possible graphs are in correspondence with all the possible combinations of these two sets of hidden - variables . however , due to the full independence of the two sets , both within the individual sets and with each other , we are free to sample the graph realizations in three different ways .      in literature",
    ", the hidden - variables model is becoming more and more popular , enriched by several generalizations and uses .",
    "however , the usual ways these ensembles are sampled consists in keeping track of the sole node - hidden - variables set . this way the two sets of hidden - variables are simultaneously , or symmetrically , drawn .",
    "in @xcite we have dealt with this case . in this paper",
    "we will use the upper script @xmath126 to indicate that we are referring to the symmetric case , and we keep using the symbol @xmath6 to indicate the ensemble averages obtained in this symmetric way .",
    "we shall soon see that we can call the @xmath6 averages also `` full - averages '' .",
    "we are free to sample the ensemble in the following alternative way .",
    "for any extraction of the node - hidden - variables , @xmath21 ( where @xmath127 ) , we draw many times the set of the link - hidden - variables @xmath128 ( where @xmath129 ) , and we calculate the corresponding averages with frozen @xmath21 , @xmath130 .",
    "we then proceed with many extractions of the @xmath62 s and at the end we calculate the full averages . according to the formalism used in @xcite",
    ", we will indicate by @xmath131}$ ] the averages with respect to the @xmath62 s , _",
    "i.e. _ , if @xmath132 is any function of the node - hidden - variables , we define @xmath133=\\int \\prod_{i=1}^n dh_i\\rho(h_i)~f(\\cdot).\\end{aligned}\\ ] ] in particular , we have @xmath134=\\mathrm{o}\\left(\\frac{1}{n}\\right),\\end{aligned}\\ ] ] where in the last term we have used the fact the network is sparse",
    ".      we are free to sample the ensemble in this further alternative way . for any extraction of the link - hidden - variables , @xmath135",
    ", we draw many times the set of the nodes - hidden - variables @xmath21 , and we calculate the corresponding averages with frozen @xmath135 , @xmath136 .",
    "we then proceed with many extractions of the @xmath118 s and at the end we calculate the full averages .",
    "we will indicate by @xmath137 the averages with respect to the @xmath118 s , _",
    "i.e. _ , if @xmath138 is any function of the link - hidden - variables , we define @xmath139 } } \\prod_{i < j } dq_{i , j}~g(\\cdot),\\end{aligned}\\ ] ] where @xmath140}$ ] is a short notation for the @xmath116 hypercube @xmath140}=\\left[0,1\\right]\\times\\cdots\\times \\left[0,1\\right]$ ] .      due to the full independence of the two sets of random variables , the @xmath62 s and the @xmath118 s ,",
    "it is immediate to see that , if @xmath4 is any graph observable @xmath141}={\\left\\ { { \\left\\langle \\mathcal{o } \\right\\rangle}_{|\\bm{q } } \\right\\}}.\\end{aligned}\\ ] ] however , the same equivalence does not apply for higher moments",
    ". in particular , if @xmath142 and @xmath143 are any two observables , we have @xmath144}\\neq { \\left\\ { { \\left\\langle \\mathcal{o}_1 \\right\\rangle}_{|\\bm{q}}{\\left\\langle \\mathcal{o}_2 \\right\\rangle}_{|\\bm{q } } \\right\\}}.\\end{aligned}\\ ] ] in the following we will refer to these three ensembles as symmetric ( s ) , @xmath62-quenched ( or a ) , and @xmath118-quenched ( or b ) .",
    "given the parameters @xmath2 , @xmath145 , @xmath68 , and @xmath55 , the hidden - variables scheme produces an ensemble of networks which , in terms of a few characteristics , like statistics of the degree and motifs , are in part representative of many real - world networks with those given parameters .    following the formalism already used in @xcite , we will indicate by @xmath146 the density of the motif @xmath17 in a network realization . as is known @xcite , for @xmath72 , the hidden variable model defined through eqs .",
    "( [ cm])-([rho ] ) leads to a small clustering coefficient @xmath147 .",
    "for example , for @xmath148 we have @xmath149 , while @xmath150 .",
    "more in general , the more the motif is clustered , the smaller is its density .",
    "yet , for finite @xmath2 , and for any motif @xmath17 , clustered or not , by tuning the parameters @xmath145 , @xmath68 and @xmath55 , one can set , within some freedom , a desired value of @xmath151 .",
    "the sample - to - sample fluctuations of @xmath146 , however , can be unexpectedly large .",
    "our task is to analyze these fluctuations in each possible ensemble , with or without quenched variables .",
    "the fluctuations of @xmath146 must be compared with the corresponding average of @xmath146 , therefore , for each ensemble , we are going to analyze the following standard ratios @xmath152 @xmath153}-{\\left [ { \\left\\langle \\mathop{n_\\mathsmaller{\\gamma } } \\right\\rangle}_{|\\bm{h } } \\right]}^2 } { { \\left [ { \\left\\langle \\mathop{n_\\mathsmaller{\\gamma } } \\right\\rangle}_{|\\bm{h } } \\right]}^2},\\end{aligned}\\ ] ] @xmath154 it will be also interesting to consider the local fluctuations for frozen hidden - variables , via the following standard quenched ( q ) ratios @xmath155 @xmath156 as well as their averages @xmath157}$ ] and @xmath158 .    in @xcite we have shown that @xmath159 strongly depends on @xmath17 , @xmath2 and @xmath55 .",
    "we will see that different scenario may apply for each different ensemble analyzed through @xmath160 , where @xmath161 can be @xmath162 ( symmetric ) , @xmath163 ( by first freezing the @xmath62 s and then averaging over these latter ) , @xmath164 ( by first freezing the @xmath118 s and then averaging over these latter ) , or @xmath165 ( for frozen @xmath62 s , or frozen @xmath118 s ) , according to eqs .",
    "( [ rs]-[rq ] ) , respectively . in general ,",
    "when @xmath166 for @xmath7 , the ensemble x is said to be self - averaging with respect to the motif density @xmath146 . in practical terms , when this occurs , even one single sample is enough to get , by simulations , an accurate estimation of the ensemble - average of @xmath146 , provided @xmath2 is large enough .",
    "the behavior of @xmath160 with respect to the network size @xmath2 is therefore of crucial importance : if the network is not self - averaging with respect to some motif @xmath17 , the number of samples necessary to get a good estimation of the ensemble - average of @xmath146 in simulations , will have to grow with @xmath2 .",
    "for the same reason , it will be hard to generate only those samples whose density is close to a target value , and a kind of hard searching problem emerges .",
    "this latter aspect is in fact connected with spin - glass and np - complete problems ; in sec .",
    "vi we will see in fact that @xmath160 can be read as a susceptibility of a homogeneous system .",
    ", as a function of @xmath55 and @xmath2 , obtained from numerical integration of eq .",
    "( [ rta ] ) by using @xmath167 points per integral .",
    "[ fig2 ] , title=\"fig:\",height=336 ]    .",
    "[ fig3 ] , title=\"fig:\",height=336 ]    , as a function of @xmath55 and @xmath2 , obtained from numerical integration of eq .",
    "( [ rcliquea ] ) with @xmath168 by using @xmath167 points per integral .",
    "[ fig4 ] , title=\"fig:\",height=336 ]    .",
    "[ fig5 ] , title=\"fig:\",height=336 ]    , as a function of @xmath55 and @xmath2 , obtained from numerical integration of eq .",
    "( [ rtra ] ) by using @xmath167 points per integral . in this case",
    ", a higher number of points per integral would be desirable in order to reduce the irregularities present in this figure .",
    "notice however that , in this case , for @xmath169 we have a logarithmic scale .",
    "[ fig6 ] , title=\"fig:\",height=336 ]    .",
    "[ fig7 ] , title=\"fig:\",height=336 ]    , as a function of @xmath55 and @xmath2 , obtained from numerical integration of eq .",
    "( [ rts ] ) by using @xmath167 points per integral . also here",
    ", a higher number of points per integral would be desirable in order to reduce the small irregularities that , on this scale , turn out to be visible .",
    "[ fig14 ] , title=\"fig:\",height=336 ]    . on comparing with figs .",
    "[ fig2 ] and [ fig14 ] , it makes evident that , whereas @xmath170 and @xmath171 turn out to be similar for @xmath172 $ ] , they are quite different for larger value of @xmath55 .",
    "in fact , @xmath173 , while @xmath174 .",
    "( [ rsam]-[rqm ] ) .",
    "[ fig15 ] , title=\"fig:\",height=336 ]    , as a function of @xmath55 and @xmath2 , obtained from numerical integration of eq .",
    "( [ rtb ] ) by using @xmath167 points per integral . on comparing with the previous figures we clearly see the behavior expressed by eqs .",
    "( [ rbm]-[rsabm1 ] ) .",
    "[ fig8 ] , title=\"fig:\",height=336 ]    here we list the main properties of the standard ratios @xmath160 in the five above ensembles .",
    "the proofs of these eqs .",
    ", as well as the detailed evaluation of @xmath160 for specific motifs , will be given in the next sections .",
    "let @xmath17 be any motif having minimal and maximal degree @xmath29 and @xmath30 , respectively .",
    "there exist @xmath175 and @xmath176 with @xmath177 and @xmath28 , such that @xmath178 @xmath179 @xmath180 @xmath181 @xmath182 @xmath183 @xmath184    eqs .",
    "( [ rsam ] ) and ( [ rsam1 ] ) encode the phase transition scenario for the ensembles ( s ) and ( a ) : if the motif @xmath17 is such that @xmath185 , the density @xmath186 is self - averaging , otherwise , if @xmath187 , @xmath186 is non - self - averaging or , more precisely , strongly non - self - averaging ( see figs . [ fig2]-[fig14 ] ) . eqs .",
    "( [ rbm ] ) tells us that the hidden - variables responsible for the diverging behavior of @xmath159 are only the node - hidden - variables @xmath62 s , whereas the link - hidden - variables @xmath118 s do not produce important fluctuations ( see fig .",
    "[ fig8 ] ) .",
    "in fact , eq . ( [ rhm ] )",
    "tells us that the @xmath118 s lead always to the standard law of large numbers .",
    "this is perfectly compatible with the fact that , if the @xmath62 s are fixed parameters , the degree distribution of a node with fixed node - hidden - variable is poissonian @xcite , and since poissonian fluctuations are small , the law of large numbers applies . as a consequence of eqs .",
    "( [ rsam])-([rbm ] ) we obtain also eq .",
    "( [ rqm ] ) .",
    "( [ rsabm ] ) establish that only by first sampling the @xmath118 s and then averaging the result over the @xmath62 s , we can recover the total absence of correlations , intuitively expected when @xmath48 , which is the classical random graph limit .",
    "finally , eqs .",
    "( [ rsabm1 ] ) provide useful inequalities .    as we had anticipated in the introduction , another consequence of the non - self - averaging scenario concerns the practical problems occurring when the sequence of the expected degrees @xmath21 is supposed to be fixed .",
    "we have to take into account that , on the base of a given real - network , the expected degree sequence @xmath21 must be measured and it is affected by unavoidable finite errors @xmath188 .",
    "now , eqs .",
    "( [ rsam ] ) and ( [ rhm ] ) imply that , if we are in a non - self - averaging region , such errors , even if small , in general might seriously affect the network resulting from the hidden - variable model .",
    "in fact , if we call @xmath40 the values of the real network , and @xmath189 the values of the measured expected degrees , by using integration by parts together with @xmath190 for @xmath191 , and @xmath192 for @xmath191 or @xmath193 , for any motif @xmath17 we have @xmath194 } } { { \\left [ { \\left\\langle n_\\mathsmaller{\\gamma } \\right\\rangle}_{|_{\\bm{h } } } \\right]}^2 } \\simeq \\frac{-\\sum_i \\epsilon_i { \\left [ \\frac{\\partial}{\\partial h_i}{\\left\\langle n_\\mathsmaller{\\gamma } \\right\\rangle}^2_{|_{\\bm{h } } } \\right ] } } { { \\left [ { \\left\\langle n_\\mathsmaller{\\gamma } \\right\\rangle}_{|_{\\bm{h } } } \\right]}^2 } \\nonumber \\\\ & \\simeq & \\gamma \\frac{a}{a_1 } \\left(1+r^{(\\mathrm{a})}_{\\gamma}\\right)\\sum_i \\epsilon_i , \\end{aligned}\\ ] ] where : @xmath73 is given by eq .",
    "( [ a ] ) , @xmath195 is given by eq .",
    "( [ a ] ) evaluated for @xmath196 , and the above approximations become exact in the limit @xmath7 and @xmath197 . in general @xmath198 diverges for @xmath7 when @xmath199 .",
    "as a consequence , from eq .",
    "( [ dd ] ) , we see that even small errors in the measure of the expected degree may generate large differences between the real- and the simulated - network .",
    "the next section is devoted to the proofs of eqs .",
    "( [ rsam])-([rqm ] ) , and to a detailed evaluation of @xmath160 for specific motifs .",
    "given a motif @xmath17 , the density of @xmath17 in a graph realization is @xmath201 where @xmath202 counts the number of motifs @xmath17 passing through the node @xmath19 .",
    "the coefficient @xmath203 depends on the definition of the motif considered and serves to avoid over - counting when the motif is symmetric . for example , if the motif @xmath17 is the triangle , we set @xmath204",
    ". if the motif is not symmetric , we can establish to count only those motifs that pass through a specif node of @xmath17 .",
    "for example , if @xmath17 is a triple ( two consecutive links ) , we can set @xmath205 , but a motif contributes only when the center of the triple coincides with @xmath19",
    ". however , since we are interested only in the relative fluctuations @xmath160 , we do not need to specify it since @xmath203 , as well as any other constant , does not play any role for @xmath160 .",
    "let us consider now the numerators of eqs .",
    "( [ rs]-[rq ] ) .",
    "note that the hidden variable scheme does not distinguish nodes , therefore we can make use of the fact that nodes , once averaged , are all statistically equivalent . by using this property , from eq .",
    "( [ nm ] ) we get the following susceptibilities ( note that we reserve the symbols @xmath131}$ ] and @xmath137 to the averages over the @xmath62 s and the @xmath118 s respectively and , therefore , to avoid ambiguities , for arithmetical parenthesis we will use only the symbol @xmath206 )    @xmath207    @xmath208}-{\\left [ { \\left\\langle \\mathop{n_\\mathsmaller{\\gamma } } \\right\\rangle}_{|\\bm{h } } \\right]}^2= \\frac{c^2}{n}\\left({\\left [ { \\left\\langle k_{\\mathsmaller{\\gamma}}(i ) \\right\\rangle}_{|\\bm{h}}^2 \\right]}-{\\left [ { \\left\\langle k_{\\mathsmaller{\\gamma}}(i ) \\right\\rangle}_{|\\bm{h } } \\right]}^2\\right ) + c^2\\left({\\left [ { \\left\\langle k_{\\mathsmaller{\\gamma}}(i ) \\right\\rangle}{\\left\\langle k_{\\mathsmaller{\\gamma}}(j ) \\right\\rangle}_{i\\neq j~|\\bm{h } } \\right]}-{\\left [ { \\left\\langle k_{\\mathsmaller{\\gamma}}(i ) \\right\\rangle}_{|\\bm{h } } \\right]}^2\\right),\\end{aligned}\\ ] ]    @xmath209    @xmath210}-{\\left [ { \\left\\langle \\mathop{n_\\mathsmaller{\\gamma } } \\right\\rangle}^2_{|\\bm{h } } \\right]}= \\frac{c^2}{n}\\left({\\left [ { \\left\\langle k_{\\mathsmaller{\\gamma}}(i)^2 \\right\\rangle}_{|\\bm{h } } \\right]}-{\\left [ { \\left\\langle k_{\\mathsmaller{\\gamma}}(i ) \\right\\rangle}_{|\\bm{h}}^2 \\right]}\\right ) + c^2\\left({\\left [ { \\left\\langle k_{\\mathsmaller{\\gamma}}(i)k_{\\mathsmaller{\\gamma}}(j ) \\right\\rangle}_{i\\neq j~|\\bm{h } } \\right]}-{\\left [ { \\left\\langle k_{\\mathsmaller{\\gamma}}(i ) \\right\\rangle}_{|\\bm{h}}^2 \\right]}\\right),\\end{aligned}\\ ] ]    @xmath211    where @xmath19 and @xmath120 represent two arbitrary distinct indices . in the rhs of eqs . ( [ rns]-[rnqb ] )",
    "we have approximated @xmath212 to 1 .",
    "as for the susceptibility of an homogeneous system , for each of the eqs .",
    "( [ rns]-[rnqb ] ) , in the rhs , we have a self - term proportional to the motif variance , rescaled by the factor @xmath213 , and a mixed - term that accounts for correlations between two motifs centered at two different nodes .",
    "note that , the self - term , despite appears to be order @xmath213 , in general can not be neglected .",
    "in fact , due to exact cancellations in the mixed term , the mixed- and self - terms give contributions of the same order of magnitude .",
    "we anticipate that the mixed term is always zero in eq .",
    "( [ rnqa ] ) .    in the following , by using eqs .",
    "( [ rna]-[rnqb ] ) , we analyze @xmath200 for each x - ensemble for a few crucial motifs and then we extrapolate the general behavior .",
    "one of the main advantage of hidden - variable models lies in the fact that we can reduce the average of almost any observable to suitable integrals .",
    "as will see later on , this is particularly true for the evaluation of the motif densities and their fluctuations .",
    "in fact , a correspondence between formulas and diagrams can be established to avoid unnecessary simulations and to improve our understanding about the main contributions to the fluctuations , especially those that can generate non self - averaging .",
    "we then introduce the compact notation @xmath214}$ ] , where @xmath17 can be any motif .",
    "for example , by referring to fig .",
    "[ fig1 ] , we have @xmath215}={\\left [ p(h_1,h_2)p(h_2,h_3)p(h_3,h_4 ) \\right]},\\end{aligned}\\ ] ] @xmath216}={\\left [ p(h_1,h_2)p(h_2,h_3)p(h_3,h_1 ) \\right]},\\end{aligned}\\ ] ] @xmath217}={\\left [ p(h_4,h_1)p(h_4,h_2)p(h_4,h_3 ) \\right]},\\end{aligned}\\ ] ] and so on .",
    "the role played by these @xmath131}$]-averages , is very similar to the role played by the green functions in statistical field theory .",
    "moreover , if we are interested in the evaluation of connected correlation functions , we need to work only with green functions of connected motifs , as the contributions of disconnected motifs always cancel .",
    "the `` degree '' of correlation of a given hidden - variable model is encoded in these integrals to be evaluated numerically . only in the limit",
    "@xmath48 the correlations become negligible ( or more precisely logarithmically negligible , with corrections that scales as @xmath218 ) . in fact",
    ", as a general rule we have @xmath219}=\\nonumber \\\\ & & { \\left [ p(h_1,h_2 ) \\right]}{\\left [ p(h_2,h_3 ) \\right]}\\ldots { \\left [ p(h_m , h_{m+1 } ) \\right]}.\\end{aligned}\\ ] ] eq .",
    "( [ gammal ] ) tells us that , in the limit of large @xmath55 , _ i.e. _ , the limit where the network becomes indistinguishable from the classical random graph , a connected motif becomes indistinguishable from the set of its disconnected components and , as a consequence , the connected correlation functions tend to zero .",
    "as will see better later , eq .",
    "( [ gammal ] ) provides us also a useful tool to have a simple estimate of the averages of the density of motifs ( but not of its variance ) .",
    "here we consider the most common case in which we sample the two set of hidden - variables symmetrically and we have to evaluate the fluctuations thorough eq .",
    "( [ rns ] ) .",
    "this symmetric sampling has already been analyzed in @xcite .",
    "here we review this case providing further details which were omitted in @xcite .",
    "_ link _ @xmath221 .",
    "if @xmath17 is the link , @xmath202 coincides with the standard definition of degree of the node @xmath19 . for a given graph realization , corresponding to a given realization of the @xmath62 s , in terms of adjacency matrix , we have @xmath222 by using eqs .",
    "( [ cm])-([aveh ] ) , and the statistical equivalence of nodes , we have @xmath223}.\\end{aligned}\\ ] ] let us now consider the product @xmath224 .",
    "notice that @xmath225 .",
    "we have to distinguish the case @xmath226 and @xmath227 , see fig .",
    "[ fig9 ] .    )",
    "( lower connected motifs ) and ( [ link4 ] ) ( upper disconnected motifs and the 3 connected motifs located in the central part of the figure ) .",
    "nodes @xmath19 and @xmath120 are to be kept fixed , while all the others can vary , provided the topology is kept fixed .",
    "contributions coming from disconnected motifs always cancel in @xmath228 .",
    "[ fig9 ] , title=\"fig:\",height=153 ]    for @xmath226 we have @xmath229 } \\nonumber\\\\ & & + ( n-1){\\left [ p(h_1,h_2 ) \\right]},\\end{aligned}\\ ] ] while for @xmath227 we have @xmath230}^2 \\nonumber\\\\ & & + 3(n-2){\\left [ p(h_1,h_2)p(h_2,h_3 ) \\right]},\\end{aligned}\\ ] ] where the factor 3 in the last term comes from the fact that two links emanating from nodes @xmath19 and @xmath120 can share a same node in 3 topologically equivalent ways .",
    "we finally plug eqs .",
    "( [ link1])-([link4 ] ) into eq .",
    "( [ rs ] ) via eq .",
    "( [ rns ] ) and , by keeping in this latter only terms in @xmath231 , which cancel exactly , and terms in @xmath2 , we obtain @xmath232}}{{\\left [ p(h_1,h_2 ) \\right]}^2}-\\frac{4}{n}+\\frac{1}{n^2{\\left [ p(h_1,h_2 ) \\right]}}.\\end{aligned}\\ ] ] due to eq .",
    "( [ avea ] ) and its generalizations , for @xmath233 , each term present in the rhs of eq .",
    "( [ rls ] ) is of order @xmath213 , so that we have also @xmath234 and the network is self - averaging with respect to the link density , while for @xmath96 we have still self - averaging but @xmath235 decays slower as @xmath236 .",
    "it is interesting however to observe the general behavior of @xmath237 with respect to @xmath55 for finite @xmath2 . due to",
    "( [ gammal ] ) the first two terms in the rhs of eq .",
    "( [ rls ] ) tend to cancel for large @xmath55 .",
    "however , the last term does not cancel for large @xmath55 .",
    "we will see that in the a ensemble this term instead cancels .",
    "_ diagrammatic calculus .",
    "_ by making use of the compact notation ( [ g3l])-([g3c ] ) , we can rewrite eq .",
    "( [ rls ] ) as @xmath238}}{{\\left [ \\gamma_1 \\right]}^2}-\\frac{4}{n}+\\frac{1}{n^2{\\left [ \\gamma_1 \\right]}}.\\end{aligned}\\ ] ] we see that the main term is given by the ratio between a @xmath131}$]-average of two links sharing a common node , and the square of the @xmath131}$]-average of a single link,_i.e . _ , our motif .",
    "in fact , for any motif @xmath17 , we can express @xmath159 by using the diagrammatic notation .",
    "furthermore , since @xmath159 is defined in terms of connected correlation functions ( [ rns ] ) , we need to work only with green functions of connected motifs , as the contributions of disconnected motifs always cancel .",
    "next , by using this diagrammatic tool , we evaluate @xmath159 in the crucial case of @xmath41-cliques .",
    "we first analyze the case @xmath239 in detail , then we look at the general behavior @xmath240 , and finally we extrapolate the general behavior for any motif .    _",
    "triangle _ @xmath241 .",
    "this is the simplest @xmath41-clique .",
    "now @xmath242 counts the number of triangles passing through the node @xmath19 : @xmath243 where @xmath244 and the factor 2 comes from the fact that in the rhs we have not restricted the sum to ordered couples @xmath245 .",
    "however , we stress again that these constants do not play any role for the standard ratios . from eq .",
    "( [ rts0 ] ) we have ( notice that @xmath246 , but @xmath247 ) @xmath248},\\end{aligned}\\ ] ] and upon referring to the contributions as in fig . ( [ fig10 ] ) , and taking into account the multiplicities of all the topologically equivalent cases , we get @xmath249}^2\\nonumber \\\\ & & + 8\\left(n-2\\right)\\left(n-3\\right)\\left(n-4\\right){\\left [ \\gamma_{3\\times 2 } \\right]}\\nonumber \\\\ & & + 10\\left(n-2\\right)\\left(n-3\\right){\\left [ \\gamma_{4 d } \\right ] } + 4\\left(n-2\\right){\\left [ \\gamma_{3 } \\right]},\\end{aligned}\\ ] ] @xmath250}^2\\nonumber \\\\ & & + 4\\left(n-1\\right)\\left(n-2\\right)\\left(n-3\\right){\\left [ \\gamma_{4d } \\right]}\\nonumber \\\\ & & + 2\\left(n-1\\right)\\left(n-2\\right){\\left [ \\gamma_{3 } \\right]}.\\end{aligned}\\ ] ]    ) ( panels @xmath251-@xmath252 ) , and to eq .",
    "( [ rts3 ] ) ( panels @xmath253-@xmath252 ) .",
    "two randomly chosen triangles in the network may have from zero to full overlap .",
    "the red parenthesis indicate the shared nodes .",
    "@xmath251 represents the case with two disconnected triangles , @xmath253 represents two triangles sharing a common node , @xmath254 represents two triangles sharing 2 nodes ( and then one link ) , @xmath252 two triangles sharing 3 nodes ( and then totally overlapped ) . as stressed before , in calculating the connected correlation functions ( [ rns]-[rnqb ] ) , two disconnected motifs ( @xmath251 in the present case ) do not contribute .",
    "[ fig10 ] , title=\"fig:\",height=336 ]    by keeping for each term only the leading and subleading contributions we get @xmath255},\\end{aligned}\\ ] ] @xmath256}^2\\nonumber \\\\ & & + 8n^3{\\left [ \\gamma_{3\\times 2 } \\right ] } + 10n^2{\\left [ \\gamma_{4 d } \\right ] } + 4n{\\left [ \\gamma_{3 } \\right]},\\end{aligned}\\ ] ] @xmath257}\\nonumber \\\\ & & + 4n^3{\\left [ \\gamma_{4d } \\right]}+ 4n^2{\\left [ \\gamma_{3 } \\right]}.\\end{aligned}\\ ] ] plugging eqs . ( [ rts4]-[rts6 ] ) into eq . ( [ rs ] ) via eq .",
    "( [ rns ] ) we have finally @xmath258}}{{\\left [ \\gamma_{3 } \\right]}^2}-\\frac{9}{n}+\\frac{14}{n^2}\\frac{{\\left [ \\gamma_{4d } \\right]}}{{\\left [ \\gamma_{3 } \\right]}^2 } + \\frac{6}{n^3}\\frac{1}{{\\left [ \\gamma_{3 } \\right]}}.\\end{aligned}\\ ] ] similarly to the last term of eq .",
    "( [ rls ] ) , the last two terms of eq .",
    "( [ rts ] ) do not cancel for large @xmath55 ( see figs .",
    "[ fig14 ] and [ fig15 ] ) .",
    "_ @xmath41-clique @xmath259 and the general case .",
    "_ we are able to write down a general formula for the general motif .",
    "later on , we will show that , given the motif @xmath17 , the most important and interesting contributions to the fluctuations are those corresponding to the cases in which two randomly chosen motifs share a single node .",
    "so , for the triangle case ( @xmath260 ) , this corresponds to panel @xmath253 in fig .",
    "( [ fig10 ] ) .",
    "in particular , it is easy to derive the main contribution when the motif is a @xmath41-_clique _ , @xmath259 .",
    "in fact , given @xmath261 ( @xmath262 is the degree of each node ) , if @xmath45 indicates the motif in which two @xmath41-cliques @xmath263 share a common node , we have @xmath264}}{{\\left [ \\gamma_{kc } \\right]}^2}-\\frac{b_k}{n}+\\mathrm{o}\\left(\\frac{1}{n}\\right),\\end{aligned}\\ ] ] where @xmath265 is a combinatorial term which depends only on @xmath41 , and the last term is positive and plays a role similar to the last two terms of eq .",
    "( [ rts ] ) .",
    "more in general , if the motif @xmath17 is a star , or any not regular motif ( regular polygons and @xmath41-_cliques _ are example of regular motifs ) , the most important contribution to @xmath159 corresponds to the case in which two randomly chosen @xmath17 s share the node having the maximal degree of @xmath17 , @xmath266 .",
    "if we indicate by @xmath267 this motif , we have @xmath268}}{{\\left [ \\gamma \\right]}^2}-\\frac{b_\\mathsmaller{\\gamma}}{n}+\\ldots\\end{aligned}\\ ] ]      here we consider to sampling by first freezing the node - hidden - variables , and only at the end averaging with respect to them .",
    "we have then to use eq .",
    "( [ rna ] ) . as we will soon see , the calculation is quite close to the symmetric ( s ) case , as well as the behavior for finite @xmath55 , while there emerges an important difference for the classical random graph limit in which @xmath270 .",
    "let us first calculate @xmath269 in a few crucial cases .",
    "_ link _ @xmath221 .",
    "the definition of @xmath202 has been given in eq .",
    "( [ link ] ) .",
    "as stressed before , the averages over the two sets of hidden - variables do not change by changing their order .",
    "let us consider the product @xmath224 .",
    "the crucial mathematical difference with respect to the symmetric case is that , in the calculation , we are now not facing the fact that @xmath225 ; rather , we will face the evaluation of things like @xmath271 .",
    "as before , we have to distinguish the case @xmath226 and @xmath227 , see fig .  [ fig9 ] .",
    "for @xmath226 we have @xmath272}=(n-1)(n-2){\\left [ p(h_1,h_2)p(h_2,h_3 ) \\right ] } \\nonumber\\\\ & & + ( n-1){\\left [ p^2(h_1,h_2 ) \\right]},\\end{aligned}\\ ] ] while for @xmath227 we have @xmath273}=(n-2)(n-3){\\left [ p(h_1,h_2 ) \\right]}^2 \\nonumber\\\\ & & + 3(n-2){\\left [ p(h_1,h_2)p(h_2,h_3 ) \\right]}.\\end{aligned}\\ ] ] comparing with the symmetric case , we see that , whereas eqs .",
    "( [ link4 ] ) and ( [ link4a ] ) are identical , eqs .",
    "( [ link3 ] ) and ( [ link3a ] ) differ in the last term which here , due to the fact that the network is sparse , is always smaller and negligible with respect to the other terms . upon plugging eq .",
    "( [ link1 ] ) and eqs .",
    "( [ link3a]-[link4a ] ) into eq .",
    "( [ ra ] ) via eq .",
    "( [ rna ] ) and , by keeping in this latter only terms in @xmath231 , which cancel exactly , and terms in @xmath2 , we obtain @xmath274}}{{\\left [ p(h_1,h_2 ) \\right]}^2}-\\frac{4}{n}.\\end{aligned}\\ ] ] with respect to the symmetric case , we observe now the absence of the last term of eq .",
    "( [ rls ] ) . as a consequence ,",
    "the density of the node - degree in the a case , besides to be self - averaging , has also the property that in the classical random graph limit , the relative fluctuations tend to zero : @xmath275    _ triple _ @xmath276 .",
    "now @xmath277 counts the number of triples passing through the node @xmath19 : @xmath278 where @xmath205 , since we count two consecutive links as a triple passing through node @xmath19 only if the center of the triple coincides with @xmath19 ; and the factor 2 comes from the fact that in the rhs we have not restricted the sum to ordered couples @xmath245 ( again , these constants do not play any role for the standard ratios ) . with respect to the triangle case , the triple case leads to a more involved calculation due to the lack of symmetry . from eq .",
    "( [ rtra0 ] ) we have ( notice that @xmath246 , but @xmath247 ) @xmath279}.\\end{aligned}\\ ] ] upon referring to the contributions as in panels @xmath280-@xmath281 of fig .",
    "( [ fig11&12 ] ) , and taking into account the multiplicities of all the topologically equivalent cases , we get @xmath282}=\\nonumber \\\\ & & \\left(n-2\\right)\\left(n-3\\right)\\left(n-4\\right)\\left(n-5\\right){\\left [ \\gamma_{2 } \\right]}^2\\nonumber \\\\ & & + 4\\left(n-2\\right)\\left(n-3\\right)\\left(n-4\\right){\\left [ \\gamma_{4\\mathrm{l } } \\right]}\\nonumber \\\\ & & + 4\\left(n-2\\right)\\left(n-3\\right)\\left(n-4\\right){\\left [ \\gamma_{4\\mathrm{cl } } \\right]}\\nonumber \\\\ & & + 2\\left(n-2\\right)\\left(n-3\\right){\\left [ \\gamma_{4 } \\right]},\\end{aligned}\\ ] ] and upon referring to panels @xmath283-@xmath284 of fig .",
    "( [ fig11&12 ] ) @xmath285}= \\nonumber \\\\ & & \\left(n-1\\right)\\left(n-2\\right)\\left(n-3\\right)\\left(n-4\\right){\\left [ \\gamma_{2\\times 2 } \\right]}\\nonumber \\\\ & & + 5\\left(n-1\\right)\\left(n-2\\right)\\left(n-3\\right){\\left [ \\gamma_{3\\mathrm{c } } \\right]}\\nonumber \\\\ & & + 3\\left(n-1\\right)\\left(n-2\\right){\\left [ \\gamma_{2 } \\right]}.\\end{aligned}\\ ] ]    ) ( panels @xmath280-@xmath281 ) , and to eq .",
    "( [ rtra3 ] ) ( panels @xmath283-@xmath284 ) .",
    "[ fig11&12 ] , title=\"fig:\",width=240 ] ) ( panels @xmath280-@xmath281 ) , and to eq .",
    "( [ rtra3 ] ) ( panels @xmath283-@xmath284 ) .",
    "[ fig11&12 ] , title=\"fig:\",width=240 ]    finally , plugging eq .",
    "( [ rtra1 ] ) and eqs .",
    "( [ rtra2]-[rtra3 ] ) into eq .",
    "( [ ra ] ) via eq .",
    "( [ rna ] ) and , by keeping in this latter only terms in @xmath231 , which cancel exactly , and terms in @xmath2 , we obtain @xmath286}+4{\\left [ \\gamma_{4\\mathrm{cl } } \\right]}+{\\left [ \\gamma_{2\\times 2 }   \\right]}}{{\\left [ \\gamma_{2 } \\right]}^2}-\\frac{9}{n}.\\end{aligned}\\ ] ] again , we observe that @xmath287    _ triangle _ @xmath241 .",
    "the calculation for the triangle case is much easier due to the full symmetry of the motif , and it runs in close analogy to the calculation already done in the s case ( the symmetric sampling ) .",
    "in fact , instead of eqs .",
    "( [ rts5]-[rts6 ] ) , now we have @xmath288}=\\left(n^4 - 13n^3\\right){\\left [ \\gamma_{3 } \\right]}^2\\nonumber \\\\ & & + 8n^3{\\left [ \\gamma_{3\\times 2 } \\right ] } + 10n^2{\\left [ \\gamma_{4 d}p \\right]},\\end{aligned}\\ ] ] @xmath289}=\\left(n^4 - 10n^3\\right){\\left [ \\gamma_{3\\times 2 } \\right]}\\nonumber \\\\ & & + 4n^3{\\left [ \\gamma_{4d}p \\right]}+ 4n^2{\\left [ \\gamma_{3}ppp \\right]},\\end{aligned}\\ ] ] where , the short notations @xmath290 and @xmath291 corresponds to the motifs with multiple links shown in fig .",
    "[ fig13 ] .    )",
    "( upper ) , and to eq .",
    "( [ rta6 ] ) ( lower ) .",
    "notice that these motifs having multiple links are only a useful artifact of the calculation , but there are no motifs with multiple links in the graph model ( the hidden - variable model is by construction a _ simple graph _ , _",
    "i.e. _ , a graph with no multiple links or loop - links ) .",
    "[ fig13 ] , title=\"fig:\",width=240 ]    in fact , for large @xmath2 , the contributions of these motifs are always negligible with respect to the others , and for the standard ratio we obtain @xmath292}}{{\\left [ \\gamma_{3 } \\right]}^2}-\\frac{9}{n},\\end{aligned}\\ ] ] so that , again , unlike eq .",
    "( [ rts ] ) , we have @xmath293 and for the general @xmath41-cliques we have @xmath294}}{{\\left [ \\gamma_{kc } \\right]}^2}-\\frac{b_k}{n},\\end{aligned}\\ ] ] where @xmath265 is the same combinatorial factor which appears in eq .",
    "( [ rclique ] ) .",
    "here we consider to sampling by first freezing the link - hidden - variables , and only at the end averaging with respect to them .",
    "we have then to use eq .",
    "( [ rnb ] ) , and make use of the @xmath296-averages , defined by eq .",
    "( [ aveq ] ) .",
    "the diagrammatic calculus now has very different rules .",
    "let us first calculate @xmath295 in a few crucial cases .        _ triangle _ @xmath241 . from eq .",
    "( [ rts0 ] ) we have @xmath320}.\\end{aligned}\\ ] ] therefore we need to evaluate @xmath321}\\nonumber \\\\ & & \\times { \\left [ \\theta\\left(p(h_j , h_{l'})-q_{j , l'}\\right)\\right .",
    "\\nonumber \\\\ & & \\times \\left . \\theta\\left(p(h_{l'},h_{m'})-q_{l',m'}\\right)\\theta\\left(p(h_j , h_{m'})-q_{j , m'}\\right ) \\right]}.\\end{aligned}\\ ] ] and similarly @xmath322}\\nonumber \\\\ & & \\times { \\left [ \\theta\\left(p(h_i , h_{l'})-q_{i , l'}\\right)\\right .",
    "\\nonumber \\\\ & & \\times \\left . \\theta\\left(p(h_{l'},h_{m'})-q_{l',m'}\\right)\\theta\\left(p(h_i , h_{m'})-q_{i , m'}\\right ) \\right]}.\\end{aligned}\\ ] ] when we average eqs .",
    "( [ rtb1 ] ) and ( [ rtb2 ] ) over the @xmath118 s , we have the same topological combinations of fig .",
    "( [ fig10 ] ) . however , each diagrammatic contribution is now different with respect to the ( s ) and ( a ) cases .",
    "in fact , upon referring to the contributions as in fig .",
    "( [ fig10 ] ) we have @xmath323}^2\\nonumber \\\\ & & + 8\\left(n-2\\right)\\left(n-3\\right)\\left(n-4\\right){\\left [ \\gamma_{3 } \\right]}^2\\nonumber \\\\ & & + 10\\left(n-2\\right)\\left(n-3\\right)\\left(n-4\\right){\\left [ \\widetilde{\\gamma_{4\\mathrm{d } } } \\right]}\\nonumber \\\\ & & + 2\\left(n-2\\right)\\left(n-3\\right){\\left [ \\widetilde{\\gamma_{3 } } \\right]},\\end{aligned}\\ ] ] and @xmath324}^2\\nonumber \\\\ & & + 4\\left(n-1\\right)\\left(n-2\\right)\\left(n-3\\right){\\left [ \\widetilde{\\gamma_{4\\mathrm{d } } } \\right]}\\nonumber \\\\ & & + 2\\left(n-1\\right)\\left(n-2\\right){\\left [ \\widetilde{\\gamma_{3 } } \\right]},\\end{aligned}\\ ] ] where @xmath325}$ ] and @xmath326}$ ] are a slight modification of @xmath327}$ ] and @xmath328}$ ] , respectively : @xmath329}={\\left [ p(h_i , h_l)p(h_i , h_m)p(h_i',h_l')p(h_i',h_m ' ) \\right .",
    "\\nonumber \\\\   & \\times & \\left .",
    "\\min\\left\\{p(h_l , h_m);p(h_l',h_m')\\right\\ }   \\right]},\\end{aligned}\\ ] ] @xmath330}={\\left [ \\min\\left\\{p(h_i , h_l);p(h_i',h_l')\\right\\ }   \\right .",
    "\\nonumber \\\\   & \\times &   \\min\\left\\{p(h_i , h_m);p(h_i',h_m')\\right\\ } \\nonumber \\\\ & \\times & \\left .",
    "\\min\\left\\{p(h_l , h_m);p(h_l',h_m')\\right\\ }   \\right]}.\\end{aligned}\\ ] ] from eqs .",
    "( [ rtb1b ] ) and ( [ rtb2b ] ) we get @xmath331}^2 + 10\\left(n^3 - 9n^2\\right){\\left [ \\widetilde{\\gamma_{4\\mathrm{d } } } \\right]}\\nonumber \\\\ & & + 2\\left(n^2 - 5n\\right){\\left [ \\widetilde{\\gamma_3 } \\right]},\\end{aligned}\\ ] ] and @xmath332}^2 + 4n^3{\\left [ \\widetilde{\\gamma_{4\\mathrm{d } } } \\right ] } \\nonumber \\\\ & & + 2n^2{\\left [ \\widetilde{\\gamma_3 } \\right]}.\\end{aligned}\\ ] ] taking into account that @xmath325}=\\mathrm{o}(1/n^5)$ ] , @xmath333}=\\mathrm{o}(1/n^3)$ ] and that @xmath334}<{\\left [ \\gamma_3 \\right]}$ ] , from eqs . ( [ rb ] ) and ( [ rnb ] ) , for large @xmath2 we obtain @xmath335}}{n{\\left [ \\gamma_{3 } \\right]}^2}+ \\frac{2 { \\left [ \\widetilde{\\gamma_3 } \\right]}}{n^2{\\left [ \\gamma_3 \\right]}^2}.\\end{aligned}\\ ] ] the two terms in the rhs of eq . ( [ rtb ] ) can not generate singular terms for finite @xmath55",
    ". however , as we had anticipated , for @xmath336 , @xmath337 become a growing function of @xmath2 .",
    "if the @xmath62 s remain frozen , it is interesting to evaluate @xmath338 according to the definition ( [ rh ] ) .",
    "when the @xmath62 s are frozen , we have to average only with respect to the @xmath118 s. now , if @xmath227 , the mixed - term in eq .",
    "( [ rnqa ] ) is actually identically null for each network realization : @xmath339 eqs .",
    "( [ rh ] ) , ( [ rnqa ] ) and ( [ qh ] ) imply @xmath340 furthermore , since the @xmath62 are frozen , unlike the ensembles ( s ) and ( a ) , the leading term in @xmath341 always factorizes , so that , in the numerator of the rhs of eq .",
    "( [ rh1 ] ) the leading term always cancels . as a consequence , if for a motif @xmath17 we have @xmath342 , where the integers @xmath343 and @xmath344 characterize the structure of @xmath17 , we have @xmath345 , so that it is always @xmath346 it is not difficult to verify the general eq .",
    "( [ rh2 ] ) in a few cases .",
    "for example , in the case in which @xmath17 is the link , we easily arrive at @xmath347 similar arguments apply for the cases in which @xmath348 or @xmath260 .",
    "of course , the exact value of @xmath338 depends on the actual sequence @xmath21 , but for @xmath2 sufficiently large eq .",
    "( [ rh2 ] ) always applies .",
    "if the @xmath118 s remain frozen , it is interesting to evaluate @xmath349 according to the definition ( [ rq ] ) .",
    "when the @xmath118 s are frozen , we have to average only with respect to the @xmath62 s. it is not necessary to perform a detailed analysis to recognize what is the general behavior of @xmath349 .",
    "in fact , for what we have learned from the previous ensembles , for @xmath2 enough large we have @xmath350 eq .",
    "( [ rq1 ] ) can be derived either by using the fact that in the ensembles ( s ) ( or ( a ) ) and ( b ) we have and do not have large fluctuations , respectively , or by using the fact that in the ensembles ( s ) ( or ( a ) ) and ( @xmath351 ) we have and do not have large fluctuations , respectively .",
    "real complex networks are the result of certain pseudo random processes that can be effectively described via hidden - variable models . in this paper",
    "we have critically reviewed the definition of hidden - variable models and shown that , if the degree distribution @xmath53 of the target real network is a power law , @xmath52 , the cut - off of the model must scale as @xmath352 with @xmath1 .",
    "in fact , any choice with @xmath56 leads to a difference between the scaling of the moments of @xmath53 and the moments of the sampled degree @xmath94 in the networks generated from the hidden - variable model .",
    "we stress that this holds true for any @xmath55 .",
    "we have then performed a detailed analysis of the relative fluctuations with the minimal / natural choice @xmath101 .",
    "we have analyzed the behavior of the relative fluctuations of the densities of the motifs , @xmath16 , where @xmath17 represent any motif ( fig .",
    "[ fig1 ] ) , and @xmath18 is the generalized degree of node @xmath19 , counting how many motifs @xmath17 pass through it . we have then shown that , despite @xmath20 is an extensive observable , if @xmath353 $ ] , where @xmath354 and @xmath355 , @xmath356 and @xmath357 being the smallest and the largest degree of @xmath17 , @xmath20 is not - self - averaging , and a spin - glass picture is recovered ( eqs .",
    "( [ png ] ) and ( [ png1 ] ) ) , with @xmath61 diverging for @xmath7 ( figs .",
    "[ fig2]-[fig7 ] ) .",
    "we have shown that such a non - self - averaging behavior is only due to the variability of the expected degrees @xmath21 , whereas , when these are kept fixed , as happens when we are interested in reproducing only a given network realization with all possible graphs having fixed expected degrees , the fluctuations follow the standard law of large numbers @xmath358 , like in classical random graphs .",
    "furthermore , we have seen that we recover the self - averaging limit ( [ png ] ) both when @xmath48 , and when @xmath49 . whereas the former is intuitively expected since @xmath48 corresponds , roughly speaking , to a an exponential decay @xmath50 , _",
    "i.e. _ , it is a classical random graph limit , the latter is due to the fact that entropy of power - law random graphs goes to 0 when @xmath51 @xcite .",
    "if networks characterized by power law distributions are non self - averaging , network configurations , like in spin - glass models , are intrinsically unpredictable . furthermore ,",
    "unless @xmath55 is close to 2 , or very large , the broad distribution [ png1 ] makes a power - law network effectively unstable to small perturbations .",
    "this in particular reflects on the stability / instability of communities @xcite , and more in general to the stability / instability of motifs on which the functionality of the network largely depends .",
    "moreover , we have seen that , even if we are dealing with a case of fixed expected degrees , the fact that our knowledge on the expected degree sequence @xmath21 is affected by unavoidable finite errors , will result in a systematic bias between the simulations and the real network ( eq .",
    "( [ dd ] ) ) .",
    "the scenario we have described in this paper holds for hidden - variable models .",
    "hidden - variable models describe equilibrium networks characterized by soft - constraints ( because only the expected degrees are fixed ) . of course",
    ", in other classes of models fluctuations might follow different rules .",
    "in particular networks can be described via models having hard constrains , or models built via a growing dynamics , which may differ in many aspects from hidden - variable models .",
    "for example , in a model where the degrees are fixed , the degrees do not fluctuate by construction .",
    "nevertheless , we expect that the non - self - averaging or the spin - glass scenario seen in the hidden - variable models will have a counterpart in any model as soon as it is characterized by power laws .",
    "we hope that our paper will stimulate further investigations in this directions .",
    "b. derrida , `` spin glasses , random boolean networks and simple models of evolution '' , proceedings of the trieste conference on nonlinear cooperative phenomena in biological systems , ( 1997 ) , 216 - 226 in non linear cooperative phenomena in biological systems ed l. matsson , world scientific ( 1998 ) ."
  ],
  "abstract_text": [
    "<S> it is becoming more and more clear that complex networks present remarkable large fluctuations . </S>",
    "<S> these fluctuations may manifest differently according to the given model . in this paper </S>",
    "<S> we re - consider hidden variable models which turn out to be more analytically treatable and for which we have recently shown clear evidence of non - self averaging ; the density of a motif being subject to possible uncontrollable fluctuations in the infinite size limit . here </S>",
    "<S> we provide full detailed calculations and we show that large fluctuations are only due to the node hidden variables variability while , in ensembles where these are frozen , fluctuations are negligible in the thermodynamic limit , and equal the fluctuations of classical random graphs . </S>",
    "<S> a special attention is paid to the choice of the cut - off : we show that in hidden - variable models , only a cut - off growing as @xmath0 with @xmath1 can reproduce the scaling of a power - law degree distribution . in turn , it is this large cut - off that generates non - self - averaging . </S>"
  ]
}