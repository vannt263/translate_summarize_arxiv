{
  "article_text": [
    "let us first look at an ( easy ) example of computing a _",
    "volume_. let @xmath5 be the convex hull of the following @xmath6 points : the origin and the standard basis vectors @xmath7 , @xmath8 . let @xmath9 be its dilation by a factor of @xmath10 ( for nonnegative @xmath10 ) .",
    "a straightforward way of computing the volume of @xmath9 would be inductively in @xmath11 , using the fact that the @xmath12-dimensional cross section of @xmath9 at @xmath13 is a dilated copy of @xmath14 : @xmath15 and evaluating this iteratively gives us @xmath16 .",
    "a generalization of volume is the _",
    "ehrhart ( quasi-)polynomial _ , which we define as follows .",
    "a @xmath17 , @xmath18 , is the convex hull of finitely many points in @xmath19 , and the dimension , @xmath20 , of the polytope is the dimension of the affine hull of @xmath18 .",
    "a _ rational _",
    ", _ integral _ ) polytope is a polytope all of whose vertices are rational ( resp . , integral ) . given a polytope @xmath18 and a nonnegative @xmath10 ,",
    "let @xmath21 be the dilation of @xmath18 by a factor of @xmath10 , and define the function @xmath22 by @xmath23 ehrhart proved @xcite that , if @xmath18 is an integral polytope , then @xmath24 is a polynomial of degree @xmath20 . more generally , if @xmath18 is a rational polytope of dimension @xmath25 , then @xmath26 where the @xmath27 are periodic functions @xmath28 ( periodic meaning that there exists an @xmath29 such that @xmath30 for all @xmath10 ) .",
    "such functions are called _ quasi - polynomials_. ehrhart quasi - polynomials can be considered as a generalization of volume , because , for full - dimensional @xmath18 , @xmath31 is the constant @xmath32 .",
    "that is , @xmath24 is approximately @xmath33 , with lower degree terms correcting for the fact that this is a discrete version of the volume computation .",
    "let us return to our polytope @xmath34 and compute its ehrhart polynomial .",
    "for this example , our inductive approach to computing volume works out well when translated to the discrete problem . when @xmath35 , @xmath36 .",
    "we see that @xmath37 which we can prove by induction on @xmath11 and @xmath10 is @xmath38 this calculation works out so well because expressions like the falling factorial , @xmath39 sum well .",
    "this is a well - known fact from finite calculus ( * ? ?",
    "* chapter 2 ) , and just as the polynomials @xmath40 form the perfect basis of @xmath41 $ ] ( as a vector space over @xmath42 ) for integrating because of the power rule , the polynomials @xmath43 form the perfect basis for summing , since @xmath44 ( this fact can be proved quickly , by induction on @xmath10 )",
    ".    in section [ section : proof ] , we prove that this method of computing @xmath24 works for any simplex ( and hence for any polytope by triangulation ) .",
    "this provides a new proof of ehrhart s theorem that uses more minimal ( but less powerful ) tools than other traditional proofs , such as proofs via generating functions @xcite or via valuations @xcite . unlike these other proofs , proving it for integral polytopes requires the full power of the proof for rational polytopes . to prove it",
    ", we ll need a nice basis for the vector space of quasi - polynomials of period @xmath29 , which we shall present in section [ section : proof ] .",
    "this inductive computation of @xmath24 has two more desirable outcomes : new and basic proofs of mcmullen s theorem about periods of the individual coefficients , @xmath45 , of the quasi - polynomial and of ehrhart  macdonald reciprocity .",
    "we describe both of these results below .",
    "mcmullen s theorem ( * ? ? ? * theorem 4 ) , is as follows .",
    "the _ @xmath46-index _ of a rational polytope @xmath18 is the smallest number @xmath47 such that , for each @xmath46-dimensional face @xmath48 of @xmath18 , the affine hull of @xmath49 contains integer points . for this definition ,",
    "we include @xmath50 as a @xmath11-dimensional face of itself .",
    "note that if @xmath51 , then we must have @xmath52 : any @xmath46-dimensional face , @xmath48 , contains @xmath53-dimensional faces , and so the affine hull of @xmath54 contains integer points , though it may not be the smallest dilate to do so .",
    "[ ehrharttheorem ] given a rational polytope @xmath55 , let @xmath25 , and let @xmath56 be the ehrhart quasi - polynomial .",
    "given @xmath46 , with @xmath57 , let @xmath47 be the @xmath46-index of @xmath18 . then @xmath47 is a period of @xmath45 .    for example , let @xmath58 be the smallest positive integer such that @xmath59 is integral .",
    "then @xmath47 divides @xmath58 , for all @xmath46 , and so @xmath58 is a period of each @xmath45 . if @xmath18 is an integral polytope , then @xmath60 , and we recover that @xmath24 is actually a _ polynomial_. as another example ,",
    "if @xmath18 is full - dimensional then the affine span of @xmath18 is all of @xmath0 , and therefore @xmath61 has period 1 . as mentioned , @xmath61 is the constant which is the volume of @xmath18 .",
    "mcmullen s theorem is proven in section [ section : proof ] , concurrently with ehrhart s theorem .",
    "now we describe _ ehrhart  macdonald reciprocity_. since the function @xmath4 agrees with a quasi - polynomial @xmath62 for all positive integers , a natural question to ask is if @xmath62 has any meaning when @xmath10 is a negative integer , and indeed it does . given a polytope @xmath18 , let @xmath63 be the relative interior of @xmath18 , that is , the interior when considering @xmath18 as a subset of its affine hull . the number of integer points in @xmath64 is similarly counted by @xmath65 .",
    "[ reciprocity ] let @xmath18 be a rational polytope .",
    "then @xmath66    this statement was conjectured by ehrhart , and he proved it in many special cases .",
    "the general case was proven by macdonald in @xcite .",
    "this will be proven in section [ section : reciprocity ] , using the following idea , which could be called a reciprocity theorem for finite calculus .",
    "suppose @xmath67 is a quasi - polynomial , and suppose we are examining @xmath68 .",
    "we will show in section [ section : proof ] that there is a quasi - polynomial @xmath62 such that @xmath69 , for nonnegative integers @xmath10 .",
    "how about for negative integers ?",
    "certainly we can evaluate @xmath70 at a negative integer , @xmath71 , but we need to define what @xmath72 should mean . assuming that we want the summation rule @xmath73 to hold for all integers @xmath74 and @xmath75 , we must have that @xmath76 which means we should define @xmath77 fortunately , when we plug in negative values , we still have @xmath78 .",
    "this is the content of the following lemma , which we prove in section [ section : reciprocity ] .",
    "[ negativelemma ] suppose that @xmath79 is a quasi - polynomial in @xmath46 .",
    "for nonnegative integers @xmath10 define the function @xmath80 then there is a quasi - polynomial @xmath62 such that @xmath81 for all nonnegative integers @xmath10 , and furthermore , @xmath82 for all @xmath83 .",
    "as mentioned in the introduction , `` discrete integration '' of polynomials is made easy by using the basis @xmath84 of @xmath41 $ ] .",
    "we will use the following generalization , which tells us how to discretely integrate quasi - polynomials .",
    "[ lemmasumqp ] let @xmath85 be a quasi - polynomial of degree @xmath11 , where @xmath45 is a periodic function of period @xmath47 , for each @xmath46 .",
    "define @xmath86 by @xmath87 where @xmath88 and @xmath89 is the greatest integer function .",
    "let @xmath90 .",
    "then @xmath91 is a quasi - polynomial of degree @xmath6 .",
    "furthermore , a period of @xmath92 is @xmath93 , for @xmath94 , and @xmath95 has period 1 .    before we prove this lemma ,",
    "let s look at an example .",
    "suppose that @xmath96 and we would like to evaluate the sum @xmath97 we have that @xmath98 and @xmath99 , which give us @xmath100 and @xmath101 .",
    "the lemma tells us that the period of the @xmath102 coefficient of @xmath103 should be 1 , the period of the @xmath104 coefficient should be @xmath100 , and the period of the @xmath105 coefficient should be @xmath106 . indeed ,",
    "@xmath107 notice that this shows why taking the lcm of @xmath108 is necessary : @xmath109 has periodicity only in the @xmath104 coefficient , but affects the period of both the @xmath104 and @xmath105 coefficients of @xmath103 .",
    "given @xmath11 , @xmath29 , and @xmath53 , define the periodic function @xmath110 and the quasi - polynomial @xmath111 for instance , in the preceding example , we had @xmath112 .",
    "for @xmath113 , substituting @xmath114 gives us @xmath115 .",
    "this implies that , for a given @xmath11 and @xmath29 , the set of @xmath116 such that @xmath117 and @xmath118 forms a basis ( and , as we will see , a nice basis ! ) for the set of all quasi - polynomials of degree at most @xmath11 with period @xmath29 .",
    "writing our function @xmath109 as a linear combination of such quasi - polynomials ( for various @xmath11 , @xmath29 , and @xmath53 ) , it suffices to prove that @xmath119 is a quasi - polynomial of degree @xmath6 and period @xmath120 whose leading term has period 1 coefficient .",
    "we have that , for any @xmath121 , @xmath122 where the last line follows from , and so @xmath123 one can check that this is a quasi - polynomial of period @xmath124 whose leading coefficient has period 1 by substituting @xmath125 : @xmath126 a polynomial in @xmath127 whose leading coefficient does not depend on @xmath128 . the lemma follows .",
    "we prove this by induction on @xmath11 .",
    "as the base case , consider @xmath129 .",
    "then @xmath18 is a point in @xmath130 .",
    "let @xmath58 be the smallest positive integer such that @xmath59 is an integer point .",
    "then we see that @xmath131    the base case follows .",
    "now we assume that the theorem is true for all @xmath132 .",
    "we divide the proof into a number of steps :       _ 1 : without loss of generality , we may assume that @xmath18 is full - dimensional , that is , @xmath133 .",
    "_    let @xmath134 be the smallest positive integer such that the affine hull of @xmath135 contains integer points .",
    "then we must have that @xmath134 divides each @xmath47 .",
    "let @xmath136 be the affine hull of @xmath135 .",
    "there is an affine transformation @xmath137 that maps @xmath138 bijectively onto @xmath139 .",
    "let @xmath140 .",
    "then @xmath141 is a full - dimensional polytope .",
    "if we can prove the theorem for @xmath141 , it will follow for @xmath18 , because @xmath142    _ 2 : without loss of generality , we may assume that @xmath143 , where @xmath144 is a @xmath12-dimensional rational polytope .",
    "_    assume that we have a general rational polytope @xmath18 , with @xmath145 .",
    "without loss of generality , translate it by an integer vector so that it does not contain the origin .",
    "we simply write @xmath4 as sums and differences of polytopes of the form @xmath146 ( including lower dimensional @xmath144 ) , using inclusion - exclusion to make sure that the intersections of faces are counted properly .",
    "the exact form of this decomposition is not important for this proof , but it will be important in section [ section : reciprocity ] , so we will present it now .",
    "we examine two types of faces of @xmath147 :    * the collection @xmath148 of faces @xmath48 of @xmath18 that are `` visible '' : a facet ( that is , a @xmath12-dimensional face ) is said to be visible if , for all @xmath149 and all @xmath150 with @xmath151 , we have @xmath152 , and a lower dimensional face is visible if every facet that it is contained in is visible . * the collection @xmath153 of faces @xmath48 of @xmath18 that are `` hidden '' : a facet is `` hidden '' if it is not visible , and a lower dimensional face is hidden if every facet that it is contained in is hidden .",
    "some lower dimensional faces may be neither visible nor hidden . for a face @xmath48 of @xmath18 ,",
    "let @xmath154 . then , using inclusion - exclusion , @xmath155        an example of this decomposition for a polygon is given in figure [ polygondecomp ] .",
    "so as not to interrupt the flow of the proof , we offer a proof of the correctness of at the end of the section .    for a given face @xmath48 of @xmath18 , the @xmath46-dimensional faces @xmath156 of @xmath157 are either faces of @xmath18 or contain the origin .",
    "in either case , the affine hull of @xmath158 contains integer points , so they meet the conditions of the theorem .",
    "the theorem is true for the third piece of the sum , @xmath159 , by the induction hypothesis , since these are faces of smaller dimension than @xmath18 .",
    "3 : without loss of generality , we may assume that @xmath143 , where @xmath144 is a @xmath12-dimensional rational polytope lying in the hyperplane @xmath160 , where @xmath161 .",
    "_    perform a unimodular transformation such that this is true .",
    "_ 4 : we prove the theorem for such a @xmath18 .",
    "_    we have @xmath143 , where @xmath144 is a @xmath12-dimensional rational polytope lying in the hyperplane @xmath162 , where @xmath163 and @xmath164 .",
    "since faces of @xmath144 are also faces of @xmath18 , it follows that the affine hull of @xmath49 , where @xmath48 is an @xmath46-dimensional face of @xmath144 , contains integer points .",
    "let @xmath165 , lying in the hyperplane @xmath166 .",
    "then the affine hull of @xmath167 , where @xmath168 is an @xmath46-dimensional face of @xmath169 , contains integer points .",
    "we have that @xmath170 is the disjoint union @xmath171 and so @xmath172 by lemma [ lemmasumqp ] , this is a quasi - polynomial of degree @xmath11 .",
    "furthermore , the @xmath173 in the statement of lemma [ lemmasumqp ] are given by @xmath174 since @xmath175 , @xmath176 , and the coefficients of @xmath4 have the desired periods .",
    "the theorem follows .",
    "more can be said about the period of @xmath177 . in this case , @xmath178 is not only _ a _ period but is guaranteed to be the _ minimum _ period .",
    "a proof of this fact along with a study of maximal period behavior is given in @xcite and relies only on mcmullen s theorem and ehrhart  macdonald reciprocity , which we prove in the next section .",
    "we also remark that , following the constant term through the induction , we get for free another well - known fact : that the constant term of the ehrhart polynomial of a polytope is 1 . more precisely , the constant term of the ehrhart polynomial for a polytopal complex ( open or closed ) is equal to its euler characteristic .",
    "we close this section with a proof of .",
    "one can prove that this inclusion - exclusion is correct combinatorially , but the quickest proof to understand is topological .",
    "let @xmath179 and @xmath180 .",
    "we only need to prove that the first sum in counts each @xmath181 exactly once , and that the second sum counts each @xmath182 exactly once .",
    "let s examine the first sum .",
    "it suffices to prove that each @xmath183 is counted correctly , as each @xmath184 is counted identically to @xmath185 .",
    "assume for the moment that @xmath185 lies in the interior of @xmath186 , considered as a @xmath12-dimensional cw complex .",
    "let @xmath187 be the intersection of @xmath186 with the closure of a sufficiently small ball around @xmath185 ( small enough so that @xmath187 only intersects faces @xmath48 that contain @xmath185 ) .",
    "@xmath187 inherits a cw complex structure from @xmath186 . in particular , there is a one - to - one correspondence between @xmath188 that contain @xmath185 and cells of @xmath187 that are not contained in the boundary @xmath189 .",
    "therefore , in the first sum of , the number of times the point @xmath185 is counted is @xmath190 where @xmath191 is the euler characteristic ( the alternating sum of the number of cells of each dimension ) . since @xmath187 is contractible and @xmath189 is homeomorphic to a @xmath192-sphere , @xmath193 and @xmath194 . hence @xmath195",
    "= 1,\\ ] ] so @xmath185 is properly counted in the sum .",
    "if @xmath185 is not in the interior of @xmath186 , notice that @xmath185 is counted exactly the same as any `` nearby '' point that is in the interior : the key is that faces on the boundary of @xmath186 are not defined to be hidden faces in @xmath196 , because they are also contained in visible facets .",
    "therefore these @xmath185 are also counted correctly .",
    "a similar argument shows that the second sum properly counts each @xmath182 .",
    "in this section , we prove theorem  [ reciprocity ] .",
    "first we prove lemma [ negativelemma ] , which gives a reciprocity theorem for finite calculus .    by lemma [ lemmasumqp ]",
    ", there is a quasi - polynomial @xmath62 such that @xmath69 for nonnegative integers @xmath10 .",
    "let @xmath197 be a fixed positive integer .",
    "define @xmath198 and for integers @xmath199 define @xmath200    using lemma [ lemmasumqp ] ( and reindexing as necessary ) , we see that there is a quasi - polynomial @xmath201 such that @xmath202 for all integers @xmath203 .",
    "but then we see that , for nonnegative integers @xmath10 , @xmath204 because @xmath201 and @xmath62 agree for all nonnegative @xmath10 , they must be identical as quasi - polynomials , and in particular @xmath205 as desired .",
    "again , we induct on the dimension @xmath11 of the polytope .",
    "the inductive step will consist of two parts .",
    "first , assume @xmath18 is a @xmath11-dimensional polytope that is the convex hull of the origin and @xmath144 , where @xmath144 is a @xmath12-dimensional polytope .",
    "we shall first prove reciprocity for these types of polytopes .",
    "second , having reciprocity for pyramids , we use the explicit inclusion - exclusion formula for the indicator functions of the `` exterior point triangulation '' given by to show that reciprocity holds in general .",
    "let @xmath144 be a @xmath12-dimensional polytope in @xmath0 contained in the hyperplane @xmath162 for nonzero , relatively prime integers @xmath74 and @xmath75 , and let @xmath18 be the pyramid @xmath206",
    ". as before , define @xmath165 , lying in the hyperplane @xmath166 .",
    "let @xmath79 give the number of lattice points in @xmath207 and @xmath208 give the number of lattice points in @xmath209 . by induction , we can assume that @xmath210 .",
    "so @xmath211 is the number of lattice points in @xmath18 , and @xmath212 is the number of lattice points in @xmath213 .",
    "let @xmath62 be the quasi - polynomial which corresponds to @xmath103 .",
    "by lemma [ negativelemma ] , @xmath62 agrees with @xmath103 for both positive and negative integers .",
    "let @xmath214 .",
    "then @xmath215 \\\\    & = \\sum_{i=1}^{t'-1 } f^\\circ(i )    = f^\\circ(t)\\,.\\end{aligned}\\ ] ]    we now consider the case for general rational polytopes @xmath18 . as in part 2 of the proof of ehrhart s theorem ,",
    "we write @xmath18 as a sum and difference of polytopes of the form @xmath206 and lower dimensional polytopes . by equation   and the inductive hypothesis , @xmath216\\,,\\end{aligned}\\ ] ] and it is easy to see that the right hand side counts @xmath217 times the number of integer points in @xmath64 , which finishes the proof by induction .",
    "one might hope that this proof of ehrhart s theorem yields an efficient algorithm to compute ehrhart polynomials inductively . to make this work",
    ", one must be able to efficiently compute a simple expression for sums like @xmath218 ( the summands are called _ step - polynomials _ in @xcite ) .",
    "the only known way to compute such sums seems to be to first convert to a generating function using methods from @xcite and then manipulate the generating function using the barvinok algorithm ( which computes the generating function of the integer points in a polyhedron ) and other related techniques , see @xcite .",
    "however , computing the sum in this way would be ill - advised , because the generating function techniques can compute the ehrhart polynomial directly .",
    "put another way , an elementary algorithm that , given a summation of a step - polynomial computes the sum as a new step - polynomial , would be interesting , because it would provide an alternative algorithm to barvinok for answering questions about integer points in polytopes .    a second insight that this proof of ehrhart s theorem provides",
    "is the importance of picking nice bases in which to write ehrhart polynomials and quasi - polynomials .",
    "perhaps , rather than the standard basis for polynomials , @xmath40 for @xmath219 , a basis such as @xmath220 ( which sums nicely ) would be enlightening .",
    "a similar basis has already been studied : given @xmath11 , @xmath221 for @xmath222 is a basis for polynomials of degree at most @xmath11 .",
    "if we write @xmath223 then the associated hilbert series has the form @xmath224 see , for example , section 3.4 of @xcite for a discussion of this , including a proof of the fact that the @xmath225 are nonnegative .",
    "this basis has recently been used @xcite to study the roots of the ehrhart polynomial , inspiring further study @xcite of roots of polynomials whose coefficients are nonnegative in arbitrary bases .",
    "the authors would like to thank matthias beck and timothy chow for helpful discussions , and the anonymous referee for helping improve the exposition .",
    "alexander barvinok and jamie pommersheim , an algorithmic theory of lattice points in polyhedra , _ new perspectives in algebraic combinatorics ( berkeley , ca , 1996 97 ) _ , volume 38 of _ math .",
    "_ , cambridge univ . press , cambridge ( 1999 ) , 91147 ."
  ],
  "abstract_text": [
    "<S> a rational polytope is the convex hull of a finite set of points in @xmath0 with rational coordinates . </S>",
    "<S> given a rational polytope @xmath1 , ehrhart proved that , for @xmath2 , the function @xmath3 agrees with a quasi - polynomial @xmath4 , called the ehrhart quasi - polynomial . </S>",
    "<S> the ehrhart quasi - polynomial can be regarded as a discrete version of the volume of a polytope . </S>",
    "<S> we use that analogy to derive a new proof of ehrhart s theorem . </S>",
    "<S> this proof also allows us to quickly prove two other facts about ehrhart quasi - polynomials : mcmullen s theorem about the periodicity of the individual coefficients of the quasi - polynomial and the ehrhart  </S>",
    "<S> macdonald theorem on reciprocity . </S>"
  ]
}