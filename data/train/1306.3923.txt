{
  "article_text": [
    "let @xmath0 be a lvy process , i.e. a ( real valued ) stochastic process starting from @xmath1 with cadlag paths ( right continuous and with left limits ) and stationary , independent increments whose law we denote by @xmath2 .",
    "a lvy process may be thought of as a brownian motion with drift to which an ( infinite ) sequence of independent compound poisson processes are added ; infinite to the extent that its small jumps may not be summable .",
    "the lvy - khintchine formula entails that the characteristic exponent @xmath3 , defined as @xmath4 = e^{-t \\psi(z)}$ ] for all @xmath5 and @xmath6 , can be expressed as @xmath7 where @xmath8 and @xmath9 a measure on @xmath10 satisfying @xmath11 .",
    "see e.g. the textbooks bertoin @xcite , kyprianou @xcite or sato@xcite for a detailed introduction .    of interest in several fields",
    "are quantities of the form @xmath12,\\ ] ] where @xmath13 is the first passage time of @xmath14 over a level @xmath15 , i.e. @xmath16 @xmath17 is referred to as the overshoot , @xmath18 the undershoot and finally @xmath19 the last maximum before first passage . here and throughout we employ the usual notation @xmath20 and @xmath21 for all @xmath5 .",
    "some examples of applications of ( [ main1 ] ) are as follows . in mathematical finance models driven by lvy processes are popular extensions of the classic black & scholes model used for pricing financial products ( see e.g. cont and tankov @xcite , schoutens @xcite or schoutens and cariboni @xcite ) . in such models",
    "it is assumed that the financial index on which the payoff of the option is based evolves as @xmath22 for a suitably chosen lvy process @xmath14 .",
    "the ` fair ' price of a perpetual american option in such a model is typically determined by the joint law of the first hitting time and the overshoot .",
    "furthermore so - called barrier options are popular tools in practice .",
    "the ` vanilla ' version grants the holder a payoff @xmath23 at a future time @xmath24 provided @xmath14 has not or has , dependent on the variation of the product , crossed some barrier @xmath25 in the meantime .",
    "hence the payoff is a function of @xmath26 .",
    "the original whmc simulation technique deals with this pair , see also further below .",
    "a large variety of more ` exotic ' versions of such options are popular as well .",
    "for instance a certain rebate may be paid at the moment the crossing of the barrier happens .",
    "discrete barrier options exist where the barrier crossing event is only observed at certain subperiods of @xmath27 $ ] , and parisian barrier options where the barrier condition kicks in only once @xmath14 has spent at least a given period of time on the ` wrong ' side of the barrier .    furthermore in actuarial science",
    "a so - called lvy insurance risk process is a popular extension of the classic cramr - lundberg model ( cf .",
    "lundberg @xcite ) to study the evolution of the cumulative net of premiums minus claims generated by a homogenuous portfolio of insurance products .",
    "see e.g. asmussen @xcite , kluppelberg et al .",
    "@xcite or song and vondraek @xcite .",
    "if the lvy insurance risk process is @xmath28 and the initial capital @xmath29 then @xmath13 corresponds to the time ruin occurs , i.e. the first time the cumulative net becomes negative .",
    "furthermore @xmath30 corresponds to the debt at ruin , @xmath17 and @xmath18 give information about the nature of the ruin event  whether the direct cause is a single large claim or rather the accumulation of many small claims  and finally @xmath19 gives information about how close ruin has been before the actual event .",
    "these examples illustrate several usecases of ( [ main1 ] ) . to the best of our knowledge , evaluating a quantity like ( [ main1 ] )",
    "can currently be done using one of two other approaches .",
    "we will discuss these alternatives and how they compare with the whmc simulation method below .",
    "the first one is a ` plain ' monte carlo simulation method , that is , simulate paths of a random walk whose increments have the same law as @xmath31 for some small @xmath32 as an approximation of the paths of @xmath14 . however , there are only few examples of lvy processes @xmath14 for which the law of @xmath31 is known , in other cases it has to be approximated , typically by a numerical fourier inversion .",
    "this introduces numerical inaccuracy and an extra potentially expensive computation step .",
    "another downside is the well known problem that the empirical law of the simulated first passage time suffers from a very significant bias which vanishes only very slowly as @xmath33 vanishes , due to the fact that the random walk approach misses excursions over the level @xmath29 between the grid points .",
    "see broadie et al . @xcite and the references therein .",
    "the whmc simulation method does not suffer from this bias , due to the fact that the method simulates the path of the pair @xmath34 rather than just @xmath14 .",
    "see also subsection [ subsec_bm ] . even though this bias is  to our best knowledge",
    " only documented for brownian motion , since any lvy process can be decomposed as an independent sum where one of the components is a brownian motion , there is no reason to expect this issue to be any less significant for a more general lvy process or the rest of the quantities involved in ( [ main1 ] ) .",
    "it should be mentioned that some prominent examples of lvy processes used in finance do not allow to apply our method directly .",
    "for example , merton s jump - diffusion model ( see merton @xcite ) where the driving lvy process @xmath14 is a drifted brownian motion plus a compound poisson process with normally distributed jumps .",
    "as the wiener - hopf factors are not explicitly known in this case , the whmc can not be applied while plain monte carlo does .",
    "the same applies to the popular cgmy ( see carr et al @xcite ) and nig ( see barndorff - nielsen @xcite ) models ; however due to the unavailability of the exact law of @xmath31 for a given @xmath32 additional simulation techniques are necessary ( see e.g. chen et al @xcite and glasserman and liu @xcite ) and an extra error is incorporated to the plain monte carlo method .",
    "it is worth to mention with respect to the latest examples that a parametrisation of the @xmath35-family ( a particular subclass of lvy processes for which our methodology is straightforward , see subsection [ beta_family ] ) is such that the cgmy and nig processes can be obtained as a limit of @xmath35-processes ( see section 4 in kuznetsov @xcite ) . for such cases",
    "a dedicated study would be helpful to decide whether or not the advantages the whmc simulation method has over plain monte carlo as described in the previous paragraph outweighs the disadavantage that the whmc method only applies to an approximation of the actual driving lvy process ( cf .",
    "ferreiro - castilla and schoutens @xcite or schoutens and van damme @xcite for some results in this direction ) .",
    "the second approach concerns using the quintuple law from doney and kyprianou @xcite , which can be written in the form @xmath36 \\\\",
    "= \\frac{1}{q } \\mathbb{p } \\left ( \\overline{x}_{\\mathrm{e}(q ) } \\in u-\\mathrm{d}z \\right ) \\mathbb{p } \\left ( -\\underline{x}_{\\mathrm{e}(q ) } \\in \\mathrm{d}y - z \\right ) \\pi(\\mathrm{d}x+y ) \\end{gathered}\\ ] ] for @xmath37 and @xmath38 $ ] . here and throughout @xmath39 denotes an exponentially distributed random variable with mean @xmath40 , independent of @xmath14",
    "hence , if we know the laws of @xmath41 and @xmath42  which is exactly the condition under which our simulation method can be implemented  we might use this result to compute ( [ main1 ] ) .",
    "however , to obtain the law of @xmath13 from the above expression we would need to invert the right hand side over @xmath43 which is in general not a very straightforward operation , see for instance section [ sec_examples ] for how the laws of @xmath41 and @xmath42 depend on @xmath43 when @xmath14 is a meromorphic lvy process .",
    "furthermore , obtaining ( [ main1 ] ) still requires computing a potentially four dimensional integral , for which in general a numerical method will be required .",
    "since the simulation method we propose in this note is a straightforward , easy to implement and efficient method for approximating ( [ main1 ] ) directly , with only the laws of @xmath41 and @xmath42 as input , in general there seems no reason not to prefer it over the quintuple law alternative .    to return to the focus of this note , in kuznetsov et al .",
    "@xcite the wiener - hopf monte carlo ( whmc ) simulating technique is introduced which allows to sample from a law that is a good approximation of the law of @xmath26 , provided that samples can be produced from @xmath41 and @xmath42 .",
    "this method was extended to a multilevel version and a theoretical analysis was given in ferreiro - castilla et al . @xcite . in this note",
    "we pursue the observation that the main idea behind the whmc simulating technique can also be used to generate samples from ( an approximation of )    @xmath44    rather than only ( an approximation of ) @xmath26 .",
    "in fact , not only ( [ tuple ] ) but any functional of the pair @xmath34 could be handled by the method , cf .",
    "remark [ rem1 ] .",
    "once this observation has been established it is simply a matter of applying the usual setup : generate a large number of such samples , apply the function @xmath45 to each of them and compute the resulting average to obtain an approximation of ( [ main1 ] ) .    for simplicity , in the sequel we will refer to ( [ tuple ] ) as _ the @xmath46-tuple_.    the rest of this note is organized as follows . in section [ wh_scheme ]",
    "we recall the original whmc simulating technique and discuss how the underlying idea is useful for path functionals as well .",
    "section [ sec_proofs ] is devoted to the main result , describing how to obtain an approximation of ( [ tuple ] ) in terms of @xmath41 and @xmath42 , and the convergence in distribution of this approximation to the exact law of ( [ tuple ] ) . in section [ first_passage_sec ]",
    "we explore the convergence rate of the approximation of the first passage time , as this is the key quantity involved in ( [ main1 ] ) .",
    "we will show that , where @xmath47 is the approximation of @xmath48 as given by the extended whmc simulating technique .",
    "we will also show that the extended whmc simulating technique admits a multilevel version to approximate @xmath48 and that such enhancement makes the algorithm optimal .",
    "finally , the implementation , some examples and some numerical results supporting the theoretical claims and exposing the practical side of the extended whmc simulating technique are collected in section [ sec_examples ] .",
    "let us shortly recall the whmc simulating technique as introduced in kuznetsov et al . @xcite and discuss how that setup can be used for path functionals as well .",
    "fix some @xmath49 .",
    "the idea in kuznetsov et al .",
    "@xcite is to construct an approximation of the joint law of @xmath50 making use of a stochastic grid on the time axis together with the wiener - hopf factorisation as follows .",
    "recall that @xmath51 denotes an exponentially distributed random variable with mean @xmath52 independent of @xmath14 . for any @xmath53 , enlarge the probability space on which @xmath14 lives with an i.i.d .",
    "sequence @xmath54 and define a set of grid points as @xmath55 for any @xmath56 the set of random points @xmath57 forms a grid on the time axis , the distance between the grid points forming a sequence of i.i.d . exponentially distributed random variables ; equivalently the grid points can be seen as the arrival times of a poisson process with rate @xmath58 . for convenience",
    "we still denote the law of @xmath14 and the grid by @xmath2 .",
    "the idea of using such a stochastic grid was first coined in carr @xcite in the context of finding the value of american put options in a black & scholes model .",
    "the usefulness of this setup to sample from an approximation of @xmath50 relies on the following three facts .",
    "firstly , the celebrated wiener - hopf factorisation tells us that for any lvy process @xmath14 and @xmath59 we have @xmath60    secondly , making use of stationary independent increments of @xmath14 , it can be shown that the above equality can be extended in the sense that we have for any @xmath56 @xmath61 where @xmath62 and @xmath63 are random variables on a new probability space whose law can be expressed in terms of the laws of @xmath64 and @xmath65 in a straightforward way",
    ". see theorem [ thm_sims_kuzn ] below .",
    "[ thm_sims_kuzn ] suppose @xmath66 .",
    "let @xmath67 and let @xmath68 ( resp .",
    "@xmath69 ) be a sequence of i.i.d .",
    "random variables with common law equal to the law of @xmath70 ( resp .",
    "@xmath71 ) .",
    "then we have for any @xmath72 @xmath73 where @xmath74 and @xmath75 are iteratively defined by @xmath76 and for @xmath77 : @xmath78    since @xmath79 as @xmath80 by the law of large numbers and since @xmath14 does not jump at fixed times , we have @xmath81 as @xmath80 and hence for large @xmath56 the law of @xmath82 provides an approximation of the joint law of @xmath50 .",
    "thirdly and finally , especially in recent years many families of lvy processes have emerged for which the laws of both @xmath64 and @xmath65 are known in explicit enough form to allow sampling from . besides classical examples such as stable processes , we can mention the class of spectrally one sided lvy processes for which the so - called scale functions are explicit enough ( see e.g. hubalek and kyprianou @xcite , kyprianou @xcite or kyprianou et al .",
    "@xcite ) , meromorphic lvy processes ( cf .",
    "kuznetsov et al .",
    "@xcite ) and vigon s @xcite technique for constructing new lvy processes from prespecified ladder height processes ( and hence , through the wiener - hopf factorization , with prespecified laws for @xmath64 and @xmath65 ) .    now let us discuss how the above setup is useful for producing samples from the 4-tuple as well .",
    "the idea is quite straightforward : the stochastic grid as defined in ( [ def_grid ] ) does not only satisfy @xmath79 as @xmath80 , but for any sequence @xmath83 such that @xmath84 and @xmath85 $ ] as @xmath80 , we have again by the law of large numbers @xmath86 .",
    "consequently , as above , for large @xmath56 the law of @xmath87 provides an approximation of the law of @xmath88 . in this sense",
    "the stochastic grid becomes dense in the interval @xmath89 $ ] .",
    "furthermore , as is obvious from theorem [ thm_sims_kuzn ] , due to the iterative nature of the definitions of @xmath90 and @xmath91 , obtaining a sample from the pair @xmath92 requires producing a sample from the vector @xmath93 . hence constructing the approximative law of @xmath50 automatically yields an approximative law of the vector @xmath94",
    " see proposition [ random_walk_approx ] below  and it is therefore at least intuitively clear that we should also be able to approximate a quantity like ( [ main1 ] ) .",
    "this is made rigorous in theorem [ thm_sims ] .",
    "the difficulty to be overcome is that convergence on the stochastic grid is less obvious than on a traditional deterministic grid .",
    "[ random_walk_approx ] let @xmath14 be a lvy process , @xmath66 and recall @xmath90 and @xmath91 as defined in theorem [ thm_sims_kuzn ] and the definition of the stochastic grid in ( [ def_grid ] ) .",
    "then @xmath95    this is a straightforward adaptation of the proof of theorem 1 in kuznetsov et al .",
    "@xcite , we include it here for completeness .",
    "the proof is by induction over @xmath96 .",
    "it is trivially true for @xmath97 on account of ( [ wh ] ) .",
    "let @xmath98 .",
    "we have , where @xmath99 is an independent copy of @xmath14 and we use the notation @xmath100 : @xmath101 where the second equality uses that @xmath14 has stationary , independent increments and the third equality uses ( [ wh ] ) together with the induction hypothesis and the definition of the sequences @xmath102 and @xmath103 .",
    "there is yet another heuristic justification to support the skeleton @xmath104 as a good random walk approximation of the lvy process to compute pathwise quantities .",
    "it can be inferred from doney @xcite that , for all @xmath105 , the random variables @xmath106 can be written as @xmath107 where @xmath108 and @xmath109 are random walks with the same distribution as @xmath104 and independent of @xmath110 and @xmath111 respectively . since it is clear that @xmath112 the derivations in doney @xcite assert that it is possible to ` stochastically ' bound the path of @xmath14 from above and below by two random walks which are equal in distribution to the skeleton constructed in proposition [ random_walk_approx ] , but with different random starting points .",
    "heuristically , the random walk produced in proposition [ random_walk_approx ] should be particularly useful when used to approximate pathwise quantities of @xmath14 .",
    "let us now show how the setup introduced in the above section [ wh_scheme ] can be used to generate an approximate distribution of the 4-tuple as well .",
    "the idea is to approximate @xmath13 by finding points on our stochastic grid ( [ def_grid ] ) enclosing it , i.e. @xmath113 such that @xmath114 for all @xmath72 , and evaluate the functionals involving overshoots and undershoots using these grid points .",
    "[ thm_sims ] let @xmath14 be any lvy process .",
    "fix some @xmath49 and @xmath15 .",
    "recall @xmath90 and @xmath91 as defined in theorem [ thm_sims_kuzn ] .",
    "set for all @xmath72 @xmath115 ( where as usual we understand @xmath116 ) .",
    "then we have as @xmath80 @xmath117    before we prove the above main result let us prove two technical lemmas , the first of which is a well know result reproduced here for the sake of completeness and the second one is a computation which will appear in the proof of theorem [ thm_sims ] .",
    "[ lem_help ] suppose @xmath118 is a compound poisson process with only positive jumps following an exponential distribution with mean @xmath119",
    ". then for any @xmath15 and @xmath120 @xmath121    condition on the event that first passage over @xmath29 happens at the @xmath56-th jump , this jump is now from an independent random level below @xmath29 over @xmath29 and follows an exponential distribution .",
    "hence , using the lack of memory property the result for the overshoot follows . for the undershoot @xmath122",
    ", one can condition on the same event and use that the undershoot is the difference between @xmath29 and the sum of @xmath123 independent exponentially distributed random variables to conclude the proof .",
    "[ tech_lemma1 ] let @xmath14 be a lvy process , @xmath24 a random time , @xmath124 a sequence of events and @xmath125 a sequence of random times such that @xmath126    * if for all @xmath56 we have @xmath127 on @xmath128 a.s .",
    ", then @xmath129 * if for all @xmath56 we have @xmath130 on @xmath128 a.s .",
    ", then @xmath131    for ( [ 8dec2 ] ) , fix some @xmath132 and let @xmath133 , then we have @xmath134 \\ } } + \\mathbf{1}_{\\ { t^{(n ) } > t+{{\\varepsilon } } ' ] \\ } } ) | x_{t^{(n)}}-x_{t } |>{{\\varepsilon } } ) \\\\ & \\leq \\mathbb{p}\\left ( \\sup_{s \\in [ 0,{{\\varepsilon } } ' ] } |x_{t+s}-x_{t}| > { { \\varepsilon}}\\right ) + \\mathbb{p } ( \\mathbf{1}_{a^{(n ) } } ( t^{(n ) } > t+{{\\varepsilon } } ' ) ) , \\end{aligned}\\ ] ] where the second term vanishes as @xmath80 by assumption , while the first can be made arbitrarily small by choosing @xmath135 small enough on account of right continuity and path regularity .",
    "clearly ( [ 8dec3 ] ) follows by similar means and left continuity of @xmath136 .",
    "the proof goes by defining an auxiliary random vector which would be equal in distribution to the left hand side of ( [ eq_conv_d ] ) and which is such that converges in probability to the right hand side of ( [ eq_conv_d ] ) , thus obtaining the claim of the statement . in order to define such auxiliary random vector",
    "let us first introduce the following quantities : @xmath137 we first observe some relationships between the above variables .",
    "note that we may write @xmath138 indeed , on the event @xmath139 we have on the one hand @xmath140 and hence @xmath141 ; on the other hand we have @xmath142 and hence @xmath143 . on the event @xmath144 , since @xmath14 does not jump at fixed times it neither does at @xmath145 and thus @xmath146 , so @xmath147 ; moreover , @xmath148 and hence @xmath149 .",
    "summarizing up , on the event @xmath139 we have that @xmath150 and on the event @xmath144 we have @xmath151 which proves ( [ 8dec6 ] ) since @xmath152 and @xmath153 can only take values on the stochastic grid .",
    "furthermore , we have @xmath154 since by construction @xmath155 on the event @xmath156 , and @xmath157 can not happen a.s .",
    "due to the fact that @xmath14 and @xmath158 are independent .",
    "now , with these definitions we have @xmath159 which follows from applying the same functional to the left and right hand side of ( [ 4dec1 ] ) ( with @xmath160 ) .",
    "hence the main result follows if we show @xmath161 for which in turn it is enough to show that each component on the left hand side converges in probability to its counterpart on the right hand side .",
    "this takes up the remainder of the proof .    to prove the convergence in probability of the first component in ( [ main_th_aim ] ) , note that since @xmath79 as @xmath80 we have @xmath162 similarly @xmath163 and hence it is enough to show that @xmath164 to prove ( [ first_component ] ) , let @xmath132 and take @xmath165 such that @xmath166 for all @xmath167 .",
    "then @xmath168 where for any @xmath169 @xmath170 fix @xmath171 and let @xmath172 and @xmath173 for @xmath174 , then we see @xmath175 as @xmath176 since the law of large numbers ensures that @xmath177 finally , we use ( [ aux_firs_component1 ] ) and ( [ aux_firs_component2 ] ) in ( [ first_component_ineq ] ) to conclude ( [ first_component ] ) .    for the second component of ( [ main_th_aim ] )",
    ", we use again the convergence of @xmath178 and the fact that @xmath14 does not jump at fixed times to note @xmath179 using this with @xmath180 it remains to show that @xmath181 in virtue of ( [ 8dec2 ] ) in lemma [ tech_lemma1 ] and recalling ( [ 8dec6 ] ) to check that @xmath182 on @xmath183 , the above limit will hold if we show that @xmath184 for any @xmath132 recall the partition of @xmath89 $ ] in ( [ first_component_ineq ] ) .",
    "then @xmath185 where for any @xmath169 @xmath186 since @xmath187 is nothing but the first passage time over @xmath188 by a compound poisson process with exponential jumps with mean @xmath189 we see from lemma [ lem_help ] that the right hand side of ( [ aux_second_comp ] ) indeed vanishes as @xmath80 .",
    "for the third and forth component of ( [ main_th_aim ] ) , a similar argument as the one in the beginning of the previous paragraph will tell us that it is enough to show @xmath190 as @xmath80 . recalling ( [ 8dec7 ] ) to check the assumptions of ( [ 8dec3 ] ) in lemma [ tech_lemma1 ] , both limits above will hold if we prove @xmath191 for this we may apply the obvious analogue to the argument in ( [ aux_second_comp ] ) , with the understanding that rather than @xmath192 we now need to make use of @xmath193 as it is apparent from the definition of @xmath194 and ( [ 8dec7 ] ) .",
    "however this expression is nothing but the undershoot of a compound poisson process with exponential jumps at first passage over @xmath188 , hence lemma [ lem_help ] again applies to yield the result .",
    "[ rem1 ] as will be clear from the setup and the above proof , there is nothing special about the entries in the 4-tuple other than that they can be expressed as path functionals of the pair @xmath34 .",
    "any other functional of this type can be handled by the method as well , and by symmetry so can path functionals of the pair @xmath195 .",
    "it is worth noting though that path functionals depending on both @xmath196 and @xmath197 can ( in general ) not be handled by the current method as there is no analogue of ( [ wh ] ) for the pair @xmath198 .",
    "one might argue that a weakness of the whmc simulation method is the fact that we replace the fixed time @xmath199 by a random variable @xmath200 and the a priori error this causes . in ferreiro - castilla",
    "@xcite a comprehensive error analysis is carried out for the bivariate distribution @xmath201 from where convergence rates are derived in terms of the moments of @xmath200 . for a lvy process with finite second moment",
    "it is deduced that @xmath202=\\mathcal{o}(n^{-1/2})$ ] .",
    "reassuringly , the whmc simulation technique clearly outperforms ` plain ' monte carlo when the running supremum gets involved .",
    "cf . also subsection [ subsec_bm ] below .",
    "all quantities involved in ( [ main1 ] ) ultimately depend on the first passage time .",
    "we now derive a convergence rate for the approximation of the first passage time in order to gain some insight into the efficiency of the monte carlo scheme based on the construction in theorem [ thm_sims ] .",
    "recall from the proof of theorem [ thm_sims ] that @xmath203 where @xmath204 lives on the same probability space as @xmath14 .",
    "[ conv_rate_tau ] using the same notation as in theorem [ thm_sims ] , we have @xmath205\\leq \\frac{2t^{2}}{n}\\ ] ]    note that an alternative definition of @xmath204 in the proof of theorem [ thm_sims ] is @xmath206 and hence , conditioned on @xmath48 , @xmath207 follows a truncated poisson distribution .",
    "let us write @xmath208 to ease the notation and denote by @xmath209 a poisson process with rate @xmath58 .",
    "we then write @xmath210 = \\underbrace{{{\\mathbb{e}}}\\left[\\left.\\left(1-\\alpha\\wedge 1\\right)^{2}\\right|\\tau_{u}\\right ] { { \\mathbb{p}}}\\left(\\left.k_{x}^{(n)}= \\infty\\right|\\tau_{u}\\right)}_{(i)}\\\\ + \\   \\underbrace{{{\\mathbb{e}}}\\left[\\left.\\left(\\frac{k_{x}^{(n)}}{n}-\\alpha\\wedge 1\\right)^{2}\\right|\\tau_{u}\\right]{{\\mathbb{p}}}\\left(\\left.k_{x}^{(n)}\\leq n\\right|\\tau_{u}\\right)}_{(ii)}\\ . \\label{original}\\end{gathered}\\ ] ] we note that when @xmath211 ( @xmath212 ) the term @xmath213 vanishes and hence @xmath214 where the last equality follows from the observation that @xmath215 has a poisson distribution with parameter @xmath216 and the one - sided chebyshev inequality , i.e. @xmath217 for a real random variable @xmath118 with mean @xmath218 and variance @xmath219 .",
    "we now bound the probability factor in @xmath220 by @xmath221 and note @xmath222 where the last equality follows from @xmath223 for @xmath224 .",
    "the claim of the statement follows by noting that ( [ first_leg ] ) and ( [ second_leg ] ) are upper bounds independent from @xmath48 and applying the tower property in ( [ original ] ) .",
    "the convergence rates for the rest of the tuple seem less straightforward to derive , which is due to the fact that the error for the other entries in the tuple ( [ tuple ] ) depend more heavily on the path of @xmath14 . to briefly illustrate that this is a somewhat subtle problem",
    ", it seems that if @xmath14 is any lvy process with jumps it holds that    @xmath225\\ ] ]    does not vanish as @xmath80 .",
    "( this claim is currently supported by numerical evidence only . ) indeed , if a joint realisation of the stochastic grid and of the process @xmath14 is such that at least one jump of @xmath14 occurs in the set    @xmath226\\ ] ] then the random variable inside the expectation in ( [ kevin ] ) is bounded below by the size of that jump squared . hence ( [ kevin ] ) could only vanish if in the limit no jumps occur in @xmath227 .",
    "however some numerical experiments conducted by the authors suggest that the lebesgue measure of @xmath227 tends to @xmath199 as @xmath80 which suggests this requirement is not satisfied .",
    "nevertheless , even though the vanishing of ( [ kevin ] ) would facilitate deriving error bounds for the other entries of the tuple in the spirit of theorem [ conv_rate_tau ] , this is not a necessary condition .",
    "indeed , it could very well be the case that ( [ kevin ] ) does not vanish while the expected squared error for the remaining entries in the tuple does vanish . in section [ sec_examples ] some numerical results",
    "can be found , suggesting this is indeed the case and yielding empirical numerical convergence rates .      in ferreiro - castilla",
    "@xcite the original whmc simulation technique as introduced in section [ wh_scheme ] , i.e. to approximate quantities of the form @xmath228 $ ] , was extended to a multilevel monte carlo algorithm under the assumption that @xmath45 is uniformly lipschitz . in principle the same multilevel scheme presented in that paper can be used to approximate ( [ main1 ] ) as well , provided that @xmath14 has finite second moment ( and provided that the random tuple approximation converges in mean square error ) .",
    "it is out of the scope of this paper to give the full details of such a scheme , we refer the reader to giles @xcite for the general theory of multilevel monte carlo methods and to ferreiro - castilla et al .",
    "@xcite for the specifics in the adaptation to the wiener - hopf scheme for lvy processes .",
    "however since we have derived the convergence rate for the first passage time approximation in the above theorem [ conv_rate_tau ] we are able to derive the convergence rate for its multilevel version as well .",
    "its numerical performance is checked in section [ sec_examples ] .    for the following discussion it is enough to consider @xmath229\\to\\mathbb{r}$ ]",
    "lipschitz with constant @xmath221 , fix @xmath230 and set @xmath231 for @xmath232 .",
    "let us write @xmath233 the multilevel monte carlo algorithm proposes to estimate @xmath234 $ ] by @xmath235 $ ] according to the right hand side of @xmath236={{\\mathbb{e}}}[f^{n_{0}}]+\\sum_{\\ell=1}^{l}{{\\mathbb{e}}}[f^{n_{\\ell}}-f^{n_{\\ell-1}}]\\ .\\ ] ] in other words , the multilevel version of a monte carlo estimator proposes to perform regular monte carlo estimators in each of the expectations in the right hand side of ( [ mlmc ] ) as an approximation to @xmath234 $ ] , i.e. @xmath237\\approx \\widehat{f}_{\\mathrm{ml}}^{\\mathcal{m}(n_0,l)}:= \\frac{1}{m_0}\\sum_{i=1}^{m_0}f^{n_0,(i ) } + \\sum_{\\ell=1}^{l } \\frac{1}{m_{\\ell}}\\sum_{i=1}^{m_{\\ell}}\\left(f^{n_\\ell,(i)}-f^{n_{\\ell-1},(i)}\\right ) \\ , \\ ] ] where @xmath238 are the monte carlo trials in each level and @xmath239 denotes the @xmath167-th sample from @xmath240 .",
    "the following theorem describes the gain of this approach :    [ rob_thm ] let @xmath49 and @xmath241 , for some @xmath242 , suppose that there are positive constants @xmath243 with @xmath244 such that    1 .",
    "@xmath245|\\lesssim n_\\ell^{-\\alpha}$ ] 2 .",
    "@xmath246 3 .   @xmath247\\lesssim n_\\ell$ ] ,    where @xmath248 represents the cost of computing a single sample of @xmath249 .",
    "then , for every @xmath250 , there exists a value @xmath251 and a sequence @xmath252 such that@xmath253 \\lesssim \\nu \\quad \\text{and } \\quad   { { \\mathbb{e}}}\\left[\\left(\\widehat{f}_{\\mathrm{ml}}^{\\mathcal{m}(n_0,l)}-f(\\tau_{u}\\wedge t)\\right)^{2}\\right ]   \\lesssim \\left\\ { \\begin{array}{ll } \\nu^{-\\frac{1}{2}}\\,,&\\text{if } \\",
    "\\beta>1\\,,\\\\ \\nu^{-\\frac{1}{2}}\\log\\nu\\ , , & \\text{if } \\",
    "\\beta=1\\,,\\\\ \\nu^{-\\frac{1}{2+(1-\\beta)/\\alpha}}\\ , , & \\text{if } \\",
    "\\beta<1\\ , .",
    "\\end{array } \\right.\\ ] ]    in section [ sec_examples ] below we perform some numerical simulations for a lvy process @xmath14 belonging to the class of so - called meromorphic lvy processes ( cf .",
    "subsection [ beta_family ] ) .",
    "it is inferred from ferreiro - castilla et al .",
    "@xcite that any functional applied to the random walk generated in ( [ 4dec1 ] ) satisfies condition ( iii ) above . the lipschitz assumption on @xmath45 and the triangle inequality together with theorem [ conv_rate_tau ]",
    "ensure that @xmath254 and therefore , up to logarithms , the multilevel monte carlo estimator of @xmath255 provided by the above theorem [ rob_thm ] is optimal .",
    "note that in the regime @xmath254 the bias does not play a role in the convergence of the algorithm .",
    "that is , the scheme proposed here used in a multilevel monte carlo estimator of the quantity @xmath256 $ ] is optimal .",
    "in this section we discuss some examples of implementations of the method .",
    "our aim is to show that the method is easily implemented , has a clear advantage over a ` plain ' monte carlo approach ( cf .",
    "subsection [ subsec_bm ] ) and give some intuition about the convergence rates of the method .",
    "there are already other studies available which highlight the numerical performance of the whmc simulation technique in terms of computation time ( cf .",
    "ferreiro - castilla et al .",
    "@xcite or schoutens and van damme @xcite ) , at least for the original setup to approximate quantities depending on @xmath50 for some @xmath49 ( cf .",
    "section [ wh_scheme ] ) .",
    "for this reason we focus here on a more qualitative numerical analysis in order to gain further insight into how the whmc simulation technique performs and we omit speed comparisons which ultimately depend on the particular problem in hands .      with the exception of subsection [ subsec_bm ] we choose @xmath14 to be a member of the @xmath35-family of lvy processes to perform the numerical experiments .",
    "this is a subclass , like the @xmath257-processes ( cf .",
    "kuznetsov @xcite ) and general hypergeometric lvy processes ( cf .",
    "kuznetsov et al .",
    "@xcite ) , of the family of so - called meromorphic lvy processes as recently introduced in kuznetsov et al . @xcite .",
    "the class of meromorphic lvy processes is very rich : paths of bounded and unbounded variation and both finite and infinite activity jumps can be generated . in terms of the triplet ( cf .",
    "( [ characexpo ] ) ) a meromorphic lvy process can be characterized by any @xmath258 and any lvy measure that can be written as a ( possibly infinite ) mixture of exponential distributions on @xmath259 and @xmath260 .",
    "the name comes from the fact that their characteristic exponent @xmath3 can be extended to a meromorphic function on @xmath261 .",
    "in particular , a member of the @xmath35-family has a lvy measure with a density @xmath262 given by @xmath263 where @xmath264 , @xmath265 and @xmath266 . for our simulation method",
    "we need to know the laws of @xmath41 and @xmath42 ; they are easily obtained as follows ( cf .",
    "kuznetsov @xcite for more details ) . with the usual notation @xmath267 and @xmath268 ,",
    "the characteristic exponent ( [ characexpo ] ) of the lvy - khintchine representation can be written as @xmath269 where @xmath270 for any @xmath59 , the equation @xmath271 has infinitely many zeros , all real and simple , located as follows : @xmath272 finally , under the above notation the characteristic functions for @xmath41 and @xmath42 are given by @xmath273 = \\prod_{n\\leq0}\\frac{1+\\frac{iz}{\\beta_{1}(n-\\alpha_{1})}}{1+\\frac{iz}{\\zeta_{n}^{- } } } \\ , \\ \\",
    "\\varphi_{q}^{-}(z)=\\mathbb{e}[e^{iz\\underline{x}_{\\mathrm{e}(q ) } } ] = \\prod_{n\\geq0}\\frac{1+\\frac{iz}{\\beta_{2}(n+\\alpha_{2})}}{1+\\frac{iz}{\\zeta_{n}^{+}}}\\ .\\ ] ] in order to implement the whmc simulation technique we need to sample from the random variables @xmath41 and @xmath42 .",
    "this hence requires truncation of the infinite product representation in ( [ infi_chf ] ) .",
    "( note that this applies to any meromorphic lvy process , since in that case @xmath274 and @xmath275 take the same infinite product form albeit with different roots and poles generated by the function @xmath271 ) .",
    "for example , if we truncate @xmath275 after @xmath276 factors then we effectively sample from the random variable @xmath277 with characteristic function @xmath278 = \\prod_{n\\geq0}^{n}\\frac{1+\\frac{iz}{\\beta_{2}(n+\\alpha_{2})}}{1+\\frac{iz}{\\zeta_{n}^{+}}}\\ .\\ ] ] samples from @xmath277 are easily obtained using the observation that each factor of the finite product in ( [ finite_prod ] ) can be rewritten as @xmath279 the above is nothing but the characteristic function of a measure consisting of an atom in zero plus a defective negative exponential distribution , i.e. @xmath280 and it is straightforward to obtain samples according to such a measure .",
    "hence the law of @xmath277 can be expressed as a finite sum of independent random variables with a probability measure as in ( [ kk ] ) .",
    "a similar construction is valid for the supremum .",
    "the above observation provides a very straightforward way to simulate the supremum and the infimum for general meromorphic lvy processes and , as far as we know , novel .",
    "furthermore in ferreiro - castilla and schoutens @xcite the mean squared error due to the truncation of the infinite product was derived : @xmath281\\leq \\frac{3}{(\\zeta_{n+1}^{+})^{2}}\\leq\\frac{3}{\\beta_2^{2}(\\alpha_2+n)^{2}}\\lesssim \\mathcal{o}(n^{-2})\\ .\\ ] ]    the recent literature working with meromorphic lvy processes typically inverts the distribution functions of @xmath42 and @xmath41 which are also available ( cf .",
    "kuznetsov @xcite ) for producing samples . however these distribution functions are expressed as infinite sums , hence truncation has to be applied in this approach as well .",
    "furthermore the truncated distribution function has to be inverted numerically .",
    "since this has to happen very efficiently this inevitably introduces additional error , and it it is not easy to analyse how such error influences the end result .",
    "the above approach does not suffer from this problem .",
    "in this subsection we take @xmath14 to be a standard brownian motion .",
    "our goal is to present some numerical evidence for the fact that ` plain ' monte carlo ( i.e. , a random walk approximation of @xmath14 by sampling increments of @xmath14 ) yields a significant bias when it comes to approximating the first passage time , as already alluded to in the introduction . as is well known we have @xmath282 for @xmath283 , furthermore both @xmath41 and @xmath284 follow an exponential distribution with mean @xmath285 .",
    "it is hence straightforward to implement the whmc simulation technique and approximate @xmath13 . since in the whmc simulation technique",
    "a time step requires two samples , namely one from @xmath41 and one from @xmath42 ( cf .",
    "section [ sec_proofs ] ) we take for the plain monte carlo half the step size ( i.e. @xmath286 ) .    figure [ fig1 ] shows a plot of @xmath287 for @xmath288 $ ] .",
    "figure [ fig2 ] shows the errors of both plain monte carlo and the whmc simulation technique .",
    "note that also if we decrease the step size and increase the number of samples considerably for the plain monte carlo approximation , the corresponding error remains several factors larger than the error the whmc simulation technique makes .",
    "we now consider @xmath14 a driftless pure jump process belonging to the @xmath35-family described in subsection [ beta_family ] . in particular , we choose the coefficients in the lvy measure ( [ beta_density ] ) to be @xmath292 for @xmath293 , @xmath294 and @xmath295 .",
    "the chosen values for @xmath296 , @xmath297 and @xmath298 make @xmath14 behave similar to the variance gamma process , a popular model in finance ( see schoutens and van damme @xcite for the relation of the variance gamma process with the @xmath35-family ) .",
    "we choose different quantities for @xmath299 and @xmath300 to make the process asymmetric and ensure that a substantial quantity of the simulated paths will cross the barrier level which is set to @xmath301 .",
    "we also set the monitoring time @xmath302 .",
    "variations of these parameters do not make significant changes in the following plots .",
    "the plots in figures [ fig_rate_1 ] and [ fig_rate_2 ] run a refinement sequence of monte carlo estimates for the mean square difference of consecutive levels of approximations for the first passage time , the overshoot , the undershoot and the last maximum before the first passage .",
    "in particular , depicts the expectation @xmath303\\ , \\ ] ] for @xmath304 with @xmath305 .",
    "the plot uses @xmath306-scales to show a clear decreasing rate of slope @xmath221 .",
    "this convergence rate is dictated by the result in theorem [ conv_rate_tau ] and the triangle inequality , hence figure [ fig_rate_1 ] is a numerical evidence of theorem [ conv_rate_tau ] . in figure [ fig_rate_2 ]",
    "we proceed to repeat the same experiment for the overshoot , the undershoot and the last maximum before the first passage .",
    "we observe numerically that the decreasing rate is very close to @xmath307 , i.e. @xmath308\\lesssim \\frac{1}{n^{1/2}}\\ , \\ ] ] for the overshoot and analogous statements for undershoot and the last maximum before the passage .",
    "the above is a particular choice of a cauchy sequence and therefore it can not prove the convergence @xmath309 nevertheless it suggests that the above convergence is plausible and indicates its possible convergence rate .",
    "the same conclusions can be derived for the overshoot and the last maximum before the first passage time according to figure [ fig_rate_2 ] .",
    "this expression depends both on the first passage time and the overshoot .",
    "indeed it is a simplified version of the quintuple law mentioned in the introduction , cf .",
    "( [ gs ] ) . note that the algorithm described in section [ wh_scheme ] will be the same for any functional @xmath45 in ( [ main1 ] ) and",
    "therefore we only provide here a simplified example of ( [ main1 ] ) for the sake of completeness .",
    "note that any comprehensive numerical analysis of ( [ main1 ] ) will require some assumptions on the smoothness of @xmath45 , see for instance ferreiro - castilla et al .",
    "@xcite for an error analysis of @xmath311 $ ] where @xmath45 is uniformly lipschitz . indeed , the above quantity is a simplified version of the gerber - shiu penalty function as used in the insurance literature ( see e.g. @xcite and the references therein ) .",
    "for meromorphic lvy processes a closed form expression is available for @xmath312  which is a reason for choosing this example  in terms of the roots and poles of the function @xmath271 , cf .",
    "theorem 3 in kuznetsov @xcite .",
    "we choose @xmath14 the same as in subsection [ num_rates ] .",
    "figures [ fig_f_1 ] and [ fig_f_2 ] depict the performance of our algorithm as we decrease the exponential step rate @xmath290 .",
    "we set the monitoring time @xmath313 to let the process cross the barrier in most of the samples .",
    "( note that @xmath48 is defined as the first passage time when the process is left to run indefinitely , in a practical implementation such as this one we have to consider @xmath314 rather .",
    "however due to the exponential decay , in ( [ k2 ] ) the effect of replacing @xmath13 by @xmath314 can be neglected for @xmath199 large enough ) . both plots in figures [ fig_f_1 ] and [ fig_f_2 ] show a similar behavior consistent with the results and convergence rates in @xcite  which only approximated the joint distribution @xmath315  and the results in section [ num_rates ] .",
    "this is a further indication that the approximation of the 4-tuple exhibits similar behaviour as the approximation of @xmath315 derived in earlier work .",
    "avram , f. and palmowski , z. and pistorius , m. r. ( 2011 ) on gerber - shiu functions and optimal dividend distribution for a levy risk - process in the presence of a penalty function .",
    "_ preprint .",
    "_ arxiv.org/abs/1110.4965 .",
    "ferreiro - castilla , a. , kyprianou , a.e . ,",
    "scheichl , r. and suryanarayana , g. ( 2012 ) multilevel monte carlo simulation for lvy processes based on the wiener - hopf factorization . _ preprint . _ arxiv.org/abs/1210.5868          hubalek , f. and kyprianou , a. e. ( 2011 ) old and new examples of scale functions for spectrally negative lvy processes . _ seminar on stochastic analysis , random fields and applications vi ( 63)_. springer , basel ."
  ],
  "abstract_text": [
    "<S> in this note we apply the recently established wiener - hopf monte carlo ( whmc ) simulation technique for lvy processes from kuznetsov et al . </S>",
    "<S> @xcite to path functionals , in particular first passage times , overshoots , undershoots and the last maximum before the passage time . </S>",
    "<S> such functionals have many applications , for instance in finance ( the pricing of exotic options in a lvy model ) and insurance ( ruin time , debt at ruin and related quantities for a lvy insurance risk process ) . </S>",
    "<S> the technique works for any lvy process whose running infimum and supremum evaluated at an independent exponential time allow sampling from . </S>",
    "<S> this includes classic examples such as stable processes , subclasses of spectrally one sided lvy processes and large new families such as meromorphic lvy processes . </S>",
    "<S> finally we present some examples . a particular aspect that is illustrated </S>",
    "<S> is that the whmc simulation technique ( provided it applies ) performs much better at approximating first passage times than a ` plain ' monte carlo simulation technique based on sampling increments of the lvy process .    </S>",
    "<S> keywords : wiener - hopf decomposition , monte carlo simulation , multilevel monte carlo , lvy processes , exotic option pricing , first passage time , overshoot , insurance risk process    mathematics subject classification ( 2000 ) : 65c05 , 68u20 , 60g51 </S>"
  ]
}