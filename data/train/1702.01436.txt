{
  "article_text": [
    "reconstructing data , like e.g. dna sequences , of common ancestors of species living today is one of the main challenges of modern phylogenetics .",
    "ancestral sequence reconstruction is a growing research field as information about the genetic makeup of ancestors is important in various areas , for instance in drug design , protein function investigation and comparative genomics @xcite .",
    "moreover , ancestral sequence estimation is crucial for understanding the evolution of today s species .",
    "one possible way to estimate ancestral sequences is to consider the underlying evolutionary tree of the species of interest and to use maximum parsimony ( mp ) to infer ancestral sequences based on this tree .",
    "some reasons that make mp interesting is that it does not require estimates of branch lengths on the input tree and that as a purely combinatorial method , it is a very fast method of ancestral sequence reconstruction @xcite . in this manuscript",
    ", we are interested in the last common ancestor of all species under investigation , not the ancestors of any subgroups .",
    "this means that we can use the famous fitch algorithm @xcite to infer _ all _ possible ancestral states ( we will explain this more in - depth in the following section ) . for now just recall that the fitch algorithm goes from the leaves to the root in a binary tree , i.e. in a tree where all nodes have exactly two children , and assigns each parental node a state set based on the state sets of its children . if the children s state sets intersect , this intersection is taken as the estimated state set for the ancestor .",
    "otherwise , the union of the two sets is taken .",
    "for instance , in figure [ cat ] , coming from the lowermost leaf , most inner nodes will be assigned @xmath1 , but the parent of leaf 2 will be assigned @xmath2 , because set @xmath3 coming which from leaf 2 and set @xmath1 coming from leaves @xmath4 ( where @xmath5 is the number of taxa ) do not intersect . then , root @xmath6 is assigned @xmath3 as the intersection of set @xmath3 coming from leaf 1 and set @xmath2 coming from leaves @xmath7 , intersect .",
    "this means that the root of the tree will unambiguously be assigned @xmath0 in this example .",
    "however , mp can not always make unambiguous decisions about the root sequence .",
    "sometimes , for a particular site , mp might be indecisive between , say , the two dna nucleotides @xmath8 and @xmath9 ( note that our study is not restricted to the dna alphabet , but can rather be applied to all kinds of alphabets , which is why we use lowercase letters in the following ) .",
    "of course , for ancestral sequence reconstruction the question when the assignment is unique , i.e. when the decision is unambiguous , is of the utmost importance . in this regard ,",
    "the following question arises : how many present - day species , i.e. how many leaves of the tree , need to be in a certain state , say @xmath0 , such that the maximum parsimony estimate of the last common ancestor is also @xmath0 ? mathematically speaking , this question is equivalent to the question how many leaves need to be assigned state @xmath0 ( or  colored  with ` color ' @xmath0 ) , such that @xmath0 is the unambiguous root state estimate in the underlying phylogenetic tree .",
    "it can be easily seen that the answer to this question depends on the tree shape  for instance , the number of taxa ; but also the height of the tree plays a crucial role . for instance , consider again the so - called caterpillar tree , which is depicted in figure [ cat ] .",
    "this is an extreme case : as we have explained above , coloring two leaves , namely the uppermost two , with @xmath0 is always sufficient to give an unambiguous root state estimate of @xmath0 , even if all other leaves , which may be the vast majority , are in a different state .",
    "so for the caterpillar , two leaves in state @xmath0 are always sufficient to give an unambiguous @xmath0 root state estimate  regardless of the number of taxa under consideration .     by just assigning two leaves @xmath0 .",
    "note that this construction works even if the total number of taxa in the tree is large . ]    on the other hand , if the number of species is @xmath10 for some natural number @xmath11 , then you can also consider the so - called fully resolved and balanced tree , which is also often referred to as the fully bifurcating tree .",
    "the case @xmath12 , i.e. @xmath13 , is depicted in figure [ treeh3 ] .",
    "this tree turns out to be the opposite extreme : as all leaves are separated from the root by the same number of edges , it is clear that no constant number of leaves can have such a strong impact as in the caterpillar case , but that instead the number of leaves which need to be assigned @xmath0 in order for mp to return @xmath0 as the unambiguous root state estimate will grow as @xmath11 ( and thus @xmath5 ) grows .",
    "so in this regard , the fully bifurcating tree is of the utmost importance ",
    "once you know the minimal number of leaves that need to be assigned @xmath0 in this particular tree in order for maximum parsimony to unambiguously return @xmath0 as the root state estimate , you can use this number as an upper bound for _ any _ given tree on @xmath10 taxa .",
    "so the present manuscript is concerned with the problem of finding the minimal number of leaves that need to be assigned @xmath0 such that the mp root state estimate is @xmath3 when the underlying tree is fully bifurcating .",
    "this problem has first been addressed in @xcite , where the authors stated a recursive formula which used the fibonacci numbers and which explicitly calculates the desired number in case the alphabet under consideration consists only of @xmath14 states .",
    "so biologically , this result would only be applicable to binary data like for instance transversions versus transitions , but not to data like rna or dna ( four states ) , proteins ( 20 states ) or codons ( 64 states ) .",
    "however , in their manuscript the authors stated a conjecture for general alphabets of arbitrary size @xmath15 .",
    "this conjecture inspired our work .",
    "in fact , in the present manuscript we first prove the conjecture for the case where @xmath15 is even ( which makes the result applicable to biological data like dna , rna , proteins or codons as stated above ) .",
    "we then analyze the more involved case where @xmath15 is odd and show why the conjecture does not generally hold in this case , but also show some positive results for this case , like a simplification to only two different cases that need to be considered when @xmath16 .",
    "before we can present our results , we first have to introduce some basic concepts .",
    "we start with some definitions .",
    "recall that a _ rooted binary phylogenetic tree on a taxon set @xmath17 _ ( also sometimes referred to as a _ rooted binary phylogenetic @xmath17-tree _ ) is a connected , acyclic graph in which the vertices of degree at most 1 are called _ leaves _ , and in which there is exactly one node @xmath6 of degree 2 , which is referred to as _ root _ , and all other non - leaf nodes have degree 3 .",
    "moreover , in a rooted binary phylogenetic @xmath17-tree the leaves are bijectively labelled by the elements of @xmath17 .",
    "note that in the special case where there is only one node , this node can be regarded as a leaf _ and _ as a root at the same time , i.e. this is the only case where the root does not have degree 2 .    throughout this paper , when we refer to trees , we always mean rooted binary phylogenetic @xmath17-trees , and we assume without loss of generality that @xmath18 .",
    "note all nodes on the path from a node @xmath19 to the root @xmath6 ( except for @xmath19 ) are called _ ancestors _ of @xmath19 , and @xmath19 is a _ descendant _ of all these nodes .",
    "whenever the path from @xmath19 to an ancestor @xmath20 consists of only one edge , @xmath20 is called _ direct ancestor _ of @xmath19 , and @xmath19 is called _ direct descendant _ of @xmath20 .",
    "now let @xmath21 .",
    "then a _ fully bifurcating phylogenetic tree of height @xmath11 , @xmath22 , _ is a rooted binary phylogenetic tree which has exactly @xmath10 leaves and height @xmath11 . here , _ height",
    "_ refers to the number of edges between the root and each leaf ( note that this number is uniquely determined for rooted binary trees with @xmath10 leaves ) .",
    "figure [ treeh3 ] depicts the case @xmath23 , i.e. tree @xmath24 .",
    "note that for @xmath25 , i.e. @xmath26 , the corresponding fully bifurcating phylogenetic tree @xmath27 consists of only one node , which is at the same time its root and only leaf .",
    "is a fully bifurcating phylogenetic tree of height 3 with @xmath28 leaves . ]",
    "now that we introduced tree @xmath22 , which we will investigate in this manuscript , we need to introduce two more concepts : the kind of data we will map onto the leaves of the tree as well as the method with which we will then estimate ancestral data like in particular the data of the root of the tree .",
    "we first consider the data .",
    "assume we have an alphabet @xmath29 with @xmath30 so - called _ character states _",
    ", like e.g. the dna alphabet @xmath31 , where @xmath32",
    ". then a _ character _ on a taxon set @xmath17 is just a function @xmath33 from @xmath17 to @xmath29 , i.e. @xmath34 if @xmath35 , then @xmath33 is called @xmath36-state character",
    ". note that as we consider @xmath37 , we often write @xmath38 instead of listing @xmath39 , @xmath40 , etc . explicitly .",
    "for instance , figure [ cat ] shows an example of character @xmath41 mapped onto the leaves of a rooted binary phylogenetic tree .",
    "note that given real data like e.g. a dna alignment , a character can just be regarded as a column in the alignment , because each species is assigned one character state ( however , note that in our case , alignments are considered to be gap - free ) . in this context",
    ", biologists also often refer to characters as _",
    "sites_.    we now want to turn our attention to the method which we will use to estimate ancestral sequence data , i.e. sequences of ancestral states .",
    "given a rooted binary phylogenetic tree @xmath42 , the _ standard decomposition _ of @xmath42 is the decomposition of @xmath42 into its two maximal rooted pending subtrees @xcite . informally speaking ,",
    "as the root @xmath6 has degree 2 , this means that the standard decomposition considers the two subtrees directly below @xmath6 .",
    "an illustration of this decomposition is given by figure [ decomp ] .",
    "note that the fully bifurcating tree @xmath22 , with which this manuscript is concerned , can be decomposed into two trees of shape @xmath43 , which in turn can be decomposed into two @xmath44 trees and so forth .     and @xmath45 . ]    a frequently used method for ancestral state reconstruction is _ maximum parsimony _ , or _",
    "mp _ for short ( * ? ? ?",
    "* section 5 ) . given a tree and a character",
    ", mp seeks to find possible state assignments to all internal nodes such that the number of edges in the so - called _ change set _ is minimized .",
    "the change set consists of all edges of @xmath42 whose two endpoints are assigned different states .",
    "the minimal number of edges in the change set for a given tree @xmath42 and a given character @xmath33 is called _ maximum parsimony score _ ( or _ mp score _ for short ) of @xmath33 on @xmath42 .",
    "the mp score of an entire alignment , i.e. of a sequence of characters on @xmath42 , is then simply the sum of all scores induced by the individual characters .",
    "this is why we investigate only individual characters in this manuscript rather than entire alignments .    calculating the mp score for a given tree and a given character can be done in polynomial time using the famous _",
    "fitch algorithm _",
    "@xcite , which in turn is based on _",
    "fitch s parsimony operation _ , which we define next .",
    "( fitch s parsimony operation)[parsimonyoperation ] + let @xmath29 be a nonempty finite set and let @xmath46 .",
    "then , _ fitch s parsimony operation _",
    "@xmath47 is defined by @xmath48 this means that whenever the intersection of sets @xmath8 and @xmath49 is not empty , @xmath50 is set to be equal to this intersection .",
    "otherwise , the union is taken instead of the intersection .    using this operation ,",
    "the _ fitch algorithm _",
    "@xcite works as follows ( note that what we call the fitch algorithm is in fact only one phase of the algorithm described in @xcite , but this is the only part required to estimate possible root states and is thus sufficient for the present manuscript ) .",
    "assume we have a rooted binary tree @xmath42 with leaf set @xmath17 and a character @xmath51 .",
    "now the vertices of @xmath42 are recursively assigned non - empty subsets of @xmath29 .",
    "first , each leaf is assigned the set consisting of the state assigned to it by @xmath33 .",
    "then all other vertices @xmath19 , whose two direct descendants have already been assigned a subset , say @xmath8 and @xmath49 , are assigned the set @xmath50 .",
    "this step is continued upwards along the tree until the root @xmath6 is assigned a subset , which is denoted by @xmath52 .",
    "the sets assigned to each node represent possible state sets which lead to assignments of states to all internal nodes , so - called _ extensions of character @xmath33 _ , such that the number of edges in the change set is minimized and thus the parsimony score is realized on @xmath42 given @xmath33 .",
    "note that fitch described two more phases @xcite .",
    "one of them only derives extensions once the state sets for each node are given .",
    "however , the other one adds more states to some internal node sets as the procedure described above might not recover all possible states for all internal nodes @xcite .",
    "however , note that the states suggested for the root @xmath6 by the described algorithm do not require any correction @xcite . therefore , as the present manuscript is mainly concerned with @xmath6 , the described procedure is sufficient and no corrections need to be made to @xmath52 .",
    "we are now in the position to turn our attention to the main question of our manuscript : given a fully bifurcating phylogenetic tree @xmath22 on taxon set @xmath17 and height @xmath11 , as well as an alphabet @xmath29 with @xmath30 , some set @xmath53 and @xmath54 , what is the minimal number of leaves which must be assigned @xmath0 such that @xmath55 ? given @xmath56 and @xmath57 , we denote this minimum by @xmath58 . for simplicity ,",
    "let @xmath59 .    with the standard decomposition of rooted binary trees and fitch s algorithm ,",
    "it can be easily seen that @xmath60 where @xmath47 is the parsimony operation .",
    "note that the minimum is taken over all possible subsets @xmath49 and @xmath9 of @xmath29 , which could be assigned to the direct descendants of @xmath6 and which would then be used by fitch s operation to calculate @xmath52 . whenever there is no ambiguity , we omit the subscripts and only refer to @xmath61 .",
    "the main aim of this manuscript is to find a way to calculate this minimum without having to consider all possible sets @xmath49 and @xmath9 .",
    "our work was motivated by the fact that in @xcite it was shown by m. steel and m. charleston that @xmath62 equals the @xmath63th fibonacci number ; so @xmath62 can be calculated without considering all possible state assignments to the nodes of @xmath43 .",
    "however , the authors did not consider the general case @xmath64 , but instead stated the following conjecture for this case which we seek to answer in the present manuscript .",
    "[ conjecture ] @xmath65 for @xmath22 and @xmath56 we have : @xmath66    note that conjecture [ conjecture ] is only defined for @xmath67 if @xmath68 and @xmath69 if @xmath70 , because @xmath71 is only defined for @xmath72 as @xmath11 is the height of the underlying tree @xmath22 .",
    "also note that @xmath73 is only defined whenever @xmath74 , because by the fitch operation you can never get more states into the root estimate set than there are leaves ( as each leaf might be assigned a different state , which would lead to a root state set of size @xmath75 , but more than that is not possible ) .",
    "so in the following , even if we do not state explicitly that our theorems are only true for the regions where @xmath58 is defined , we will implicitly always assume that only these regions are considered .",
    "in particular , our proofs only consider these cases .",
    "it is important to note that the initial conditions required for the start of the recursion are not specified in conjecture [ conjecture ] . in the following",
    "we show that conjecture [ conjecture ] is not valid in general , because the case where @xmath15 is odd is problematic unless the initial conditions are chosen in a specific way , and we also show relevant examples to illustrate this result .",
    "before we present our results , we want to introduce one last piece of notation , which simplifies all following equations a lot : in the following , @xmath76 always denotes a subset of our alphabet @xmath29 that contains @xmath77 elements in total , one of which is @xmath0 , i.e. @xmath78 with @xmath79 and @xmath80 .",
    "so in particular , set @xmath76 contains @xmath0 for all @xmath77 .",
    "on the other hand , let @xmath81 with @xmath82 and @xmath83 .",
    "in particular , @xmath84 does not contain @xmath0 for any @xmath85 , and @xmath86 .",
    "before we present our main result , which is concerned with the case in which the size @xmath15 of the alphabet under consideration is even , we first consider the case where @xmath15 is odd and present an example for which conjecture [ conjecture ] fails when the initial conditions are not chosen in a particular way .",
    "[ obs ] let @xmath87 and @xmath88 .",
    "then for @xmath89 , conjecture [ conjecture ] suggests @xmath90 .",
    "this is due to the fact that in order for the root @xmath6 of @xmath91 , i.e. the tree that only consists of @xmath6 and two leaves , to be assigned @xmath92 , both leaves need to be in state @xmath0 , so @xmath93 ( this scenario is depicted on the left - hand side of figure [ rschlange ] ) .",
    "however , @xmath94 is incorrect .",
    "in fact , @xmath95 .    we will now prove observation [ obs ] and illustrate the construction presented in the proof subsequently with the explicit example where @xmath16 .",
    "our proof strategy is depicted in figure [ proofidea ] and works as follows :     and its standard decomposition into two trees @xmath43 , for one of which we consider its standard decomposition of two trees @xmath44 . ]",
    "we consider tree @xmath22 and its standard decomposition into two trees @xmath43 .",
    "we will construct a character such that one of the two @xmath43 trees is assigned @xmath96 as mp root estimate , i.e. @xmath97 distinct character states , one of which is @xmath0 .",
    "for the other subtree @xmath43 , we again consider its standard decomposition into two subtrees @xmath44 , both of which we will assign sets @xmath98 and @xmath99 , respectively , i.e. each subtree @xmath44 gets assigned a set with @xmath100 elements ( one of which is @xmath0 ) to its root .",
    "the trick is that as we have @xmath70 states , we can achieve the latter by letting @xmath101 and @xmath102 , where @xmath103 and thus @xmath104 , and so @xmath105 .",
    "thus , the root of @xmath43 would have set @xmath3 as a root estimate , and @xmath22 would have the root estimate @xmath106 as required .",
    "we will present a construction that can achieve this by assigning @xmath0 to only three leaves in total , one in one of the @xmath43 subtrees and one in each @xmath44 subtree of the other @xmath43 subtree as described above .",
    "so we first consider tree @xmath107 and consider its subtrees as depicted in figure [ paperfig ] .",
    "for this tree , we construct a character that only employs one @xmath0 and leads to an mp root assignment of @xmath96 , i.e. of a set with @xmath97 elements , one of which is @xmath0 .",
    "the construction is as follows : we assign leaf @xmath19 with @xmath0 and all leaves in subtrees @xmath108 are all assigned only one of the @xmath70 character states , but each tree gets a unique one .",
    "so in total , the character uses @xmath97 distinct character states , say @xmath109 , and it can easily be seen that the fitch algorithm will lead to the root assignment @xmath110 .",
    "+    note that we can use the same construction to assign sets @xmath98 and @xmath111 to trees @xmath44 , where we can choose these two sets such that they intersect only in @xmath0 as explained above .",
    "so in total , we have used @xmath0 three times and derive @xmath112 .",
    "this already contradicts @xmath94 as suggested by conjecture [ conjecture ] .",
    "moreover , one can show that 3 is best possible , i.e. there is no character assigning @xmath0 to only two leaves and giving @xmath112 ( calculation not shown ) .",
    "this completes the proof .     of height @xmath100 as needed in the construction presented in the proof of observation [ obs ] and later in the proof of lemma [ lemmar2p ] . in this construction , leaf @xmath19",
    "is assigned @xmath0 , @xmath27 is assigned another state , and all other subtrees which are sketched here as triangles are assigned one state each such that all states used are pairwise distinct . ]",
    "note that the problem for @xmath113 as described in the construction of our proof of observation [ obs ] could be avoided if the recursion was started with @xmath114 and @xmath95 as initial conditions ( rather than @xmath115 and @xmath116 ) .",
    "so a careful choice of initial conditions is definitely important when @xmath15 is odd , and for trees whose height is too small , the recursion is thus not applicable .",
    "however , note that the construction we used is not the only way to let conjecture [ conjecture ] fail when @xmath15 is odd  in fact , there are also other examples , where the conjecture fails ( result not shown ) .",
    "this is why in section [ 3-state ] we will analyze the case @xmath16 more in - depth and provide some simplifications concerning @xmath117 .",
    "we complete this section by providing an example in order to illustrate the construction presented in the proof of observation [ obs ] .",
    "let @xmath118 , i.e. @xmath16 .",
    "let @xmath119 , and thus @xmath70 as required .",
    "by conjecture [ conjecture ] we would have for all @xmath120 that @xmath121 .",
    "hence @xmath122 , since @xmath115 for all @xmath15 ( see figure [ rschlange ] ) .",
    "+ consider @xmath24 with the character @xmath123 as depicted in figure [ t_3 ] .",
    "this assignment of states to the leaves shows that @xmath124 .",
    "note that an exhaustive search through all possible characters even confirms that @xmath125 ( calculation not shown ) . in any case",
    ", this shows that conjecture [ conjecture ] , which would lead to @xmath126 , is not correct .    , since two leaves have to be assigned @xmath0 to obtain @xmath3 for the root of the left subtree of height 2 and one leaf have to be assigned @xmath0 to obtain @xmath127 for the root of the right subtree of height 2 . applying the parsimony operation for these two sets results in @xmath112 . ]",
    "so it is already obvious that calculating @xmath71 recursively is not trivial and that conjecture [ conjecture ] does not in general hold when @xmath15 is odd .",
    "however , the present manuscript has two main aims : we want to prove that the conjecture holds for the case where @xmath15 is even , and we want to prove a recursion for the case where @xmath16 .",
    "concerning the second aim , we are now already in the position to state the desired result , which we will prove subsequently in section [ 3-state ] .",
    "[ maintheo3 ] let @xmath22 be a fully bifurcating tree of height @xmath11 and let @xmath29 be a set of character states with @xmath128 .",
    "then for all @xmath129 we have @xmath130 moreover @xmath131 and @xmath125 .",
    "note that this theorem basically states that conjecture [ conjecture ] is correct for @xmath16 as long as the initial conditions are chosen in the way stated in the theorem .",
    "so even if we can not make a general statement about the involved case where @xmath15 is odd , this theorem characterizes the cases for which the conjecture holds when @xmath16 .",
    "the proof of this theorem requires some general properties of @xmath132 , which will later also be needed to address the case where @xmath15 is even .",
    "so now we first turn our attention to some general properties of @xmath132 , some of which will be proved in the appendix .",
    "we now investigate some general properties of @xmath58 .",
    "these properties will be used later on to prove our main theorems . however , as we will point out , some properties of @xmath58 are rather intuitive , even if they come with technical proofs .",
    "these proofs can be found in the appendix .",
    "our main aim in this section is to simplify equation in the following sense : rather than taking the minimum of all subsets @xmath49 and @xmath9 such that @xmath133 and @xmath134 , we want to see if some sets can already be discarded as they can never lead to the minimum .",
    "some first properties of @xmath58 are stated in the following lemma and can be derived from .",
    "[ lemma1 ] let @xmath135 , @xmath136 and @xmath58 be as defined in .",
    "then , the following statements hold :    * if @xmath137 and @xmath138 , then @xmath139 . * if @xmath25 , then @xmath140 for all @xmath141 . * if @xmath142 , then @xmath143 for all @xmath141 .    a formal proof of lemma [ lemma1 ] can be found in the appendix .",
    "however , note that the first two of the three statements of the lemma are not surprising : the first statement says that if you have two sets @xmath8 and @xmath49 which both contain @xmath0 and have the same size , then you need to assign the letter @xmath0 to equally many leaves in order to receive @xmath8 or @xmath49 as an mp root state estimate .",
    "this makes sense because the exact names of the states other than @xmath0 in a set do not matter ; what matters is rather the number of other states in the respective set .",
    "the second statement says that the fully bifurcating tree of height 0 , i.e. a tree that consists only of one node , requires this one node to be assigned @xmath0 if the root state estimate shall be @xmath3  this is clear as the root and the only leaf coincide in this case .",
    "the third statement is maybe the most interesting and least obvious one of the three statements .",
    "it says that if the root estimate shall be an unambiguous @xmath3 , any fully bifurcating tree of height at least 1 requires at least two leafs that are assigned @xmath0 .",
    "next we state a theorem which might seem obvious at first , too , but which is really crucial : if you have two sets @xmath46 , which both contain @xmath0 , and if you want to obtain the _ smaller _ set as an mp root state estimate , _ more _ leaves have to be assigned @xmath0 .",
    "[ 1 ] let @xmath144 and @xmath46 such that @xmath145 with @xmath137 and @xmath146 .",
    "then , we have : @xmath147 .    note that , again , the statement of theorem [ 1 ] is intuitively clear , because , roughly speaking , the smaller the set of the mp root state estimate is , the more maximum parsimony is convinced that @xmath0 is a good root state candidate .",
    "for instance , if @xmath0 is one state of only a few possible root states ( i.e. many other states can be discarded as possible root state candidates ) , this outcome might be regarded as more relevant than if @xmath0 is one state of many possible states ( i.e. only a few other states can be discarded ) . in order to achieve this higher degree of certainty ,",
    "more leaves with @xmath0 are needed than if a smaller degree of certainty is sufficient .",
    "we will now give a formal proof of theorem [ 1 ] , as not only the theorem itself , but also some aspects of the proof , are needed to establish subsequent results .    if @xmath148 , then @xmath149 ( see lemma [ lemma1 ] ( i ) ) , so there remains nothing to show .",
    "now assume @xmath150 .",
    "note that without loss of generality , we may assume @xmath151 .",
    "this is due to the fact that if there were states in @xmath49 that are not contained in @xmath8 , i.e. if @xmath152 , then we can re - name these states using states of set @xmath8 to get a set @xmath153 with @xmath154 and @xmath155 .",
    "then , by lemma [ lemma1 ] ( i ) , @xmath156 , but also @xmath157 .",
    "so we now assume that this re - naming of states in @xmath49 has already taken place , so without loss of generality , @xmath158 .",
    "we proceed by induction on @xmath11 .",
    "+ for @xmath159 we have @xmath160 , because the number of states that can occur in any mp root state estimate is clearly limited by the number of leaves ( by definition [ parsimonyoperation ] of the parsimony operation ) , as no states that occur in none of the leaves can ever enter the root state estimate .",
    "moreover , it can easily be seen that @xmath161 and @xmath162 hold for all @xmath163 ( see figure [ rschlange ] ) and therefore theorem [ 1 ] is true for @xmath159 .     and @xmath164 ( w.l.o.g .",
    "@xmath165 ) . to obtain @xmath166 both leaves have to be assigned @xmath0 . to obtain @xmath164 , one leaf has to be assigned @xmath0 and the other one @xmath167 . ]",
    "now suppose theorem [ 1 ] is true for @xmath11 .",
    "then we consider @xmath168 and use equation to describe @xmath169 as follows : @xmath170 analogously , we derive @xmath171    so for @xmath172 , there are basically two cases , depending on whether this value is obtained by its two maximal pending subtrees in the standard decomposition by an intersection or a union .",
    "we consider these two cases for @xmath173 separately . + * @xmath174 case : * @xmath175 with @xmath176 , @xmath177 and @xmath178 .",
    "+ furthermore , we have that @xmath135 with @xmath158 .",
    "moreover , let @xmath179 with @xmath180 and @xmath181 .",
    "note that then @xmath182 .",
    "we conclude : @xmath183 * @xmath184 case : * @xmath185 with @xmath186 , @xmath187 , @xmath188 and @xmath189 .",
    "+ moreover , we have @xmath135 and @xmath158 .",
    "now , as we have @xmath158 , we can conclude @xmath190 hence @xmath191 so in both cases , we conclude @xmath192 , which completes the proof .    the proof of theorem [ 1 ] ( particularly equation ) helps us directly to gain more insight into @xmath193 , which we will summarize in the following corollary .",
    "[ col1 ] the following recursions hold : @xmath194    as corollary [ col1 ] is a direct consequence of , we omit the formal proof . instead , we turn our attention to another rather intuitive property of @xmath58 : namely , that as @xmath11 ( and thus the tree under consideration ) grows , the number of leaves needed for an mp root state estimate of @xmath8 can not decrease .",
    "[ 2]for all regions where @xmath58 and @xmath169 are defined , the following inequality holds : @xmath195 that is , @xmath58 is monotonically increasing in @xmath11 for all @xmath135 .",
    "the proof of theorem [ 2 ] is presented in the appendix .",
    "considering , it is obvious that in order to calculate @xmath196 recursively , one has to consider two cases , which is due to the fact that the mp root state estimate for @xmath197 can come from a union or an intersection at the level of the two maximum pending subtrees of the standard decomposition .",
    "however , as the following crucial theorem shows , in the case where @xmath198 , the recursion can be drastically simplified .",
    "[ 3 ] let @xmath199 .",
    "then for all @xmath200 for which @xmath193 , @xmath201 and @xmath202 are defined , we have : @xmath203    note that theorem [ 3 ] is not only crucial in the sense that it allows us to omit a distinction between union and intersection  it even allows for a reduction of a root state estimate @xmath8 with @xmath204 to the unambiguous root state estimate @xmath3 but for a smaller tree .",
    "the proof of this theorem can be found in the appendix , but in brief the idea of the first equation stated in theorem [ 3 ] can be summarized like this : root state estimate @xmath76 can be achieved by considering the standard decomposition of @xmath197 into the two subtrees @xmath22 , one of which gets assigned @xmath205 as a root state estimate , and the other one gets assigned a set , say @xmath9 , with @xmath206 and with @xmath207 and @xmath208 .",
    "this way , the root estimate of @xmath197 will be @xmath209 .",
    "note that in order to achieve root state estimate @xmath9 for @xmath22 , no leaf in @xmath22 needs to be labelled @xmath0 ( e.g. all leafs in this tree can be labelled with the unique state in @xmath9 , which is not @xmath0 ) .",
    "so @xmath210 and thus @xmath211 .",
    "the second equation of theorem [ 3 ] follows recursively .",
    "note that by theorem [ 3 ] and equation we can also express @xmath212 in terms of @xmath71 .",
    "in particular , we have @xmath213 so in order for the mp root state estimate to be @xmath3 , we still have to find the minimum over various cases .",
    "note that the case @xmath214 corresponds to conjecture [ conjecture ] .",
    "this means that conjecture [ conjecture ] basically states that the other options can be discarded as they never give the minimum . as we have already seen in observation [ obs ] , this is not generally correct , though .",
    "before we can finally prove main theorem [ maintheo3 ] , we need one more useful property of function @xmath58 . in particular",
    ", we find that if we reduce the number of character states that are available , the number of leafs that need to be in state @xmath0 in order for maximum parsimony to give a root state estimate of @xmath76 ( where @xmath215 and @xmath216 as before ) can not decrease .",
    "again , this is intuitively clear , because we have already seen in the construction presented in the proof of observation [ obs ] that we could reduce the number of leafs in state @xmath0 by making use of as many alternative character states as possible .",
    "[ 4 ] let @xmath29 be a finite set of character states with @xmath146 and @xmath217 , let @xmath218 and @xmath219 with @xmath220 . then",
    ", for all regions where @xmath193 and @xmath221 are defined , we have : @xmath222    a formal proof of theorem [ 4 ] can again be found in the appendix .",
    "this concludes our summary of basic properties of @xmath58 , which we will use subsequently to prove our main results .",
    "we first focus our attention again on the case where @xmath15 is odd ; in particular , on the special case where @xmath16 .",
    "we now consider the case where @xmath128 . by theorem",
    "[ 1 ] and theorem [ 3 ] , we already have for @xmath16 that @xmath223 we are now finally in the position to prove main theorem [ maintheo3 ] .",
    "first consider the statements for @xmath224 and @xmath225 . as the construction presented in figure [ t_3 ] shows , @xmath226 .",
    "moreover , the left - hand side subtree in figure [ t_3 ] also shows that @xmath227 .",
    "an exhaustive search through all possible characters on @xmath228 and @xmath28 leafs , respectively , shows that in both cases , equality holds ( calculations not shown ) .",
    "+ so now we turn our attention to the case @xmath129 . without loss of generality , we can assume that @xmath11 odd and prove theorem [ maintheo3 ] separately for @xmath11 and @xmath168 , where the latter then covers the case where the tree height is even .",
    "we first show the following two statements by induction on @xmath11 : @xmath229 for @xmath230 we have @xmath231 ( see figure [ rschlange ] ) , @xmath131 and @xmath125 ( initial conditions as explained above ) and , by exhaustive search , @xmath232 ( reached by character @xmath233 on @xmath234 leafs ; calculation not shown ) .",
    "this leads to @xmath235 which is the base case of the induction .",
    "now suppose and are true for all @xmath236 with @xmath237 and @xmath236 odd .",
    "then with , @xmath238 and @xmath239 become @xmath240 where the second equation in is due to .",
    "now we show that and are also true for @xmath241 .",
    "@xmath242 therefore holds for all @xmath243 and @xmath11 odd .",
    "@xmath244 hence also holds for all @xmath243 and @xmath11 odd , so that in total , and are also true for all @xmath129 and @xmath11 odd",
    ". thus we have that @xmath245 holds for all @xmath129 .",
    "so together with theorem [ 3 ] , we have @xmath246 , which completes the proof .",
    "recall that main theorem [ maintheo3 ] basically gives a characterization of the cases in which conjecture [ conjecture ] holds in the case where @xmath16 ; namely by choosing appropriate initial conditions in order to avoid the scenario constructed in the proof of observation [ obs ] .",
    "however , this result can not easily be extended to the general case where @xmath15 is odd .",
    "we will discuss this further in section [ discussion ] .",
    "we now turn our attention to the case where @xmath15 is even , which will turn out to be less involved as conjecture [ conjecture ] can be shown to hold in this case .",
    "we are finally in a position to state our second main result .",
    "[ gerade ] let @xmath22 be a fully bifurcating tree of height @xmath11 and let @xmath29 be a set of character states with @xmath247 and @xmath248 . then for @xmath249 and all regions where @xmath212 , @xmath250 , @xmath251 , @xmath252 and @xmath253 are defined , we have : @xmath254    note that theorem [ gerade ] states that conjecture [ conjecture ] holds in the case where @xmath15 is even and @xmath255 , and this statement does not depend on a specific choice of initial conditions .",
    "before we can present the proof of main theorem [ gerade ] , we need an additional lemma , which helps to cover the case @xmath256 , which is not considered in the theorem . recall that we already have @xmath257 and @xmath115 for all @xmath15 ( by lemma [ lemma1 ] ( ii ) and figure [ rschlange ] ) .",
    "the following lemma investigates the case @xmath258 further .    [ lemmar2p ] for @xmath68 with @xmath259 , we have :    1 .",
    "@xmath260 for all @xmath261 2 .",
    "@xmath95 3 .",
    "@xmath262 for all @xmath263 .",
    "the proof of this lemma can be found in the appendix .",
    "note that the bound stated in lemma [ lemmar2p ] is actually tight , as it can be shown that while @xmath264 , we have @xmath265 ( calculations not shown ) .",
    "whether @xmath266 is possible for @xmath267 and @xmath263 has not yet been investigated .",
    "we now state the proof of main theorem [ gerade ] .",
    "note that by the second equation of theorem [ 3 ] , we have @xmath268 .",
    "we now show that for all @xmath68 with @xmath269 we have @xmath270 for all @xmath271 and @xmath272 . together with this",
    "will prove main theorem [ gerade ] .",
    "the proof is by induction on @xmath11 .",
    "for @xmath273 we need to show that @xmath274 which is , by theorem [ 3 ] , equivalent to showing @xmath275 since @xmath68 , this inequality can be written as @xmath276 moreover , by lemma [ lemmar2p ] we know that @xmath277 and thus results in @xmath278 by theorem [ 2 ] we have @xmath279 so altogether , holds and thus also .",
    "this complese the base case of the induction .",
    "+ now assume that holds for @xmath11 , then with and theorem [ 3 ] , we get @xmath280    now we show that also holds for @xmath168 .",
    "@xmath281 therefore , holds for all @xmath68 with @xmath282 . applying to and completes the proof .",
    "we considered the question how many leafs of a fully bifurcating tree must be labelled @xmath0 in order for the maximum parsimony root state estimate to be @xmath0 . in this regard",
    ", we could prove a conjecture by steel and charleston for the case where the number @xmath15 of character states is even @xcite .",
    "this is an interesting result because it not only proves the conjecture , but also generalizes the findings presented in @xcite , where the case @xmath14 was investigated .",
    "we proved that the case where @xmath15 is even is simple in the sense that the conjecture holds no matter where the recursion is started .    on the other hand",
    ", we also showed that when @xmath15 is odd , counterexamples to the conjecture can be constructed under certain conditions .",
    "however , we were able to prove the conjecture for @xmath16 for a careful choice of initial conditions .",
    "the general case where @xmath15 is odd is a topic of ongoing research .",
    "the conjecture by steel and charleston and thus also our results are relevant as the fully bifurcating tree is a ` worst case scenario ' for unambiguous maximum parsimony root state estimation : as all leafs are equally far away from the root ( in the sense of the number of edges that separates them from the root ) , there is no leaf that has a higher impact on the root state estimate than others .",
    "we showed in section [ intro ] that the so - called caterpillar tree is the other extreme : here , no matter how many leafs we label with @xmath167 , two ( particular ) leafs labelled @xmath0 will be sufficient to get an unambiguous mp root state estimate of @xmath3 , whereas for the fully balanced tree , the number depends strongly on the size of the tree ( in terms of the height and thus the number of leafs ) .",
    "recall that in the literature , the fully bifurcating tree is often referred to as ` balanced ' as opposed to the caterpillar tree , which is often thought of as ` unbalanced ' @xcite .",
    "trees with @xmath75 leafs ( for some @xmath144 which are ` in - between ' these two trees in terms of balance will also need at least 2 leafs to be in state @xmath0 , like the caterpillar tree , and at most @xmath71 leafs in state @xmath0 like the fully bifurcating tree , in order for mp to give an unambiguous root state estimate of @xmath3 . thus , our results present an upper bound for all trees of size @xmath75 . however , the exact numbers for other tree shapes as well as other tree sizes are still to be investigated .",
    "we thank mike steel for bringing this topic to our attention .",
    "the first author also thanks the ernst - moritz - arndt - university greifswald for the landesgraduiertenfrderung studentship , under which this work was conducted .",
    "\\(i ) let @xmath8 , @xmath49 such that @xmath137 and @xmath138 .",
    "then @xmath8 could be transformed into @xmath49 by renaming all states not element of @xmath283 .",
    "then @xmath284 , and this yields @xmath139 .",
    "+ ( ii ) let @xmath25 . in this case",
    "our tree consists of one leaf , which is at the same time the root .",
    "this vertex have to be assigned @xmath0 to obtain @xmath112 .",
    "hence @xmath257 for all @xmath15 .",
    "+ ( iii ) let @xmath142 .",
    "then @xmath285 therefore , @xmath286 and @xmath287 which results in @xmath288 .",
    "we have @xmath289 ( by lemma [ lemma1 ] ( ii ) ) and @xmath161 ( see figure [ rschlange ] ) for all @xmath15 .",
    "therefore , theorem [ 2 ] is true for @xmath25 .",
    "we now prove theorem [ 2 ] for @xmath290 by contradiction .",
    "so assume there is a @xmath291 choose @xmath11 to be the smallest value of @xmath292 with this property , i.e. we have @xmath293 for some set @xmath8 , which we fix .",
    "moreover , for all @xmath294 and all sets @xmath295 we have @xmath296 now let @xmath297 and @xmath169 be as in the proof of theorem [ 1 ] .",
    "we now consider both cases for @xmath169 for the fixed values @xmath11 and @xmath8 as chosen above . +",
    "* @xmath174 case : * @xmath298 with @xmath299 , @xmath300 and @xmath301 .",
    "then @xmath302 by the assumption on @xmath11 .",
    "this leads to @xmath303 , which contradicts theorem [ 1 ] , because @xmath304 . +",
    "* @xmath184 case : * @xmath305 with @xmath306 , @xmath307 , @xmath308 and @xmath309 .",
    "then @xmath310 thus @xmath311 , which is a contradiction .",
    "+ therefore , both cases lead to contradictions , and thus , such a @xmath11 can not exist .",
    "this completes the proof .",
    "we begin by proving @xmath312 for @xmath313 for all @xmath314 @xmath306 , @xmath315 , @xmath316 and @xmath317 by induction on @xmath11 .",
    "for @xmath159 we have that @xmath318 and @xmath319 hold for all @xmath15 ( see figure [ rschlange ] ) .",
    "thus @xmath320 and therefore is true for @xmath159 , which completes the base case of the induction .",
    "assume now that for all @xmath199 , holds for @xmath11 . by and , for all @xmath76",
    ", @xmath193 becomes @xmath321      note that the first equation is true because as for @xmath325 , we have @xmath326 .",
    "the same holds for @xmath327 .",
    "so altogether , we now have that holds for @xmath168 .",
    "+ applying to gives @xmath328 for all @xmath313 .",
    "so now we have that holds for all @xmath329 , and thus we have @xmath330 which completes the proof .    if @xmath331 , we immediately have @xmath332 , so there is nothing to show .",
    "so we now consider the case @xmath333 and prove the statement by induction on @xmath11 . for @xmath25 , we consider @xmath334 and @xmath335 . these values are defined only if @xmath336 and therefore @xmath337 or @xmath338 .",
    "thus we have to consider @xmath339 and @xmath340 for all @xmath341 . as can be seen in figure [ rschlange ] , we have for all @xmath341 : @xmath342 and @xmath343 this completes the base case of the induction for all @xmath344 .",
    "now assume theorem [ 4 ] holds for @xmath11 , and consider @xmath168 .",
    "we start with the case @xmath345 and find : @xmath346 so theorem [ 4 ] holds for @xmath345 .",
    "now consider the case @xmath337 : @xmath347 hence also in the case where @xmath337 , theorem [ 4 ] holds .",
    "this completes the proof .      1 .",
    "we start with the case @xmath350 .",
    "we have @xmath115 for all @xmath15 ( see figure [ rschlange ] ) . by theorem",
    "[ 2 ] we know that @xmath71 is monotonically increasing in @xmath11 , and thus @xmath351 .",
    "we now use the standard decomposition for @xmath352 in order to derive its two maximal pending rooted subtrees @xmath353 with roots @xmath354 and @xmath355 . using the same construction as in the proof of observation [ obs ] , which is depicted in figure [ paperfig ] , we can achieve @xmath356 and @xmath357 by assigning @xmath0 to one leaf in each subtree @xmath353 , respectively , where @xmath358 , and such that all other subtrees use one state each which is unique to this subtree . thus , the root of @xmath352 will have the mp root state estimate @xmath359 .",
    "( note that no leaf is assigned character state @xmath360 , so we do not even require all states .",
    "we will need this fact later . )",
    "so we conclude @xmath361 , which together with @xmath362 as explained above completes @xmath114 .",
    "so together with theorem [ 2 ] we achieve that @xmath260 for all @xmath363 .",
    "2 .   now consider the case @xmath89 . in this case",
    "we have with @xmath364 the latter equation is true because @xmath365 ( at least one leaf hast to be labelled @xmath0 if @xmath0 shall appear in the mp root state estimate ) .",
    "3 .   now consider the case @xmath273 .",
    "we can proceed as above and assign @xmath356 to the first of the two @xmath366 subtrees induced by the standard decomposition , and @xmath367 to the other one , where again @xmath358 .",
    "then by we can conclude @xmath368 .",
    "note that @xmath369 by theorem  [ 3 ] , so that @xmath370 , where the latter equation holds because of the first part of lemma [ lemmar2p ] .",
    "so altogether , @xmath371 . by the monotonicity of theorem",
    "[ 2 ] , we obtain @xmath262 for all @xmath372 .",
    "m. steel and m. charleston , five surprising properties of parsimoniously colored trees , bulletin of mathematical biology , volume 57 , page 367 - 375 ( 1995 ) w. m. fitch , toward defining the course of evolution : minimum change for a specific tree topology , systematic zoology , volume 20 , page 406 - 416 ( 1971 ) l. herbst , ancestral state reconstruction with parsimony , master thesis , greifswald ( 2015 ) i. p. goulden and d. m. jackson , combinatorial enumeration , wiley , new york ( 1983 ) c. semple and m. steel , phylogenetics , oxford university press , new york ( 2003 ) j. felsenstein , inferring phylogenies , sinauer associates , inc ( 2004 ) d. a. liberles ( ed ) , ancestral sequence reconstruction , oxford university press , new york ( 2007 ) l. szekely , p. erds and m. steel , the combinatorics of evolutionary trees - a survey , journal of combinatorial mathematics and combinatorial computing , volume 15 , page 241 - 254 ( 1994 ) o. gascuel and m.steel , predicting the ancestral character changes in a tree is typically easier than predicting the root state , systematic biology , volume 63 , page 421 - 435 ( 2014 ) o. gascuel and m.steel , inferring ancestral sequences in taxon - rich phylogenies , mathematical biosciences , volume 227 , page 125 - 153 ( 2010 ) c. semple and m. steel , tree reconstruction from multi - state characters , advances in applied mathematics , volume 28 , page 169 - 184 ( 2002 ) g. li , m. steel and l. zhang , more taxa are not necessarily better for the reconstruction of ancestral character states , systematic biology , volume 57 , page 647 - 653 ( 2008 ) w. cai , j. pei and n. v. grishin , reconstruction of ancestral protein sequences and its applications , bmc evolutionary biology , volume 4 , page 33 ( 2004 ) o. w. griffith , d. g. blackburn , m. c. brandley , j. u. van dyke , c. m. whittington , m. b thompson , ancestral state reconstructions require biological evidence to test evolutionary hypotheses : a case study examining the evolution of reproductive mode in squamate reptiles , journal of experimental zoology , volume 324 , page 493 - 503 ( 2015 ) m. fischer , v. liebscher : on the balance of unrooted trees . 2015 ."
  ],
  "abstract_text": [
    "<S> one of the main aims in phylogenetics is the estimation of ancestral sequences based on present - day data like , for instance , dna alignments . </S>",
    "<S> one way to estimate the data of the last common ancestor of a given set of species is to first reconstruct a phylogenetic tree with some tree inference method and then to use some method of ancestral state inference based on that tree . </S>",
    "<S> one of the best - known methods both for tree inference as well as for ancestral sequence inference is maximum parsimony ( mp ) . in this manuscript , </S>",
    "<S> we focus on this method and on ancestral state inference for fully bifurcating trees . </S>",
    "<S> in particular , we investigate a conjecture published by charleston and steel in 1995 concerning the number of species which need to have a particular state , say @xmath0 , at a particular site in order for mp to unambiguously return @xmath0 as an estimate for the state of the last common ancestor . </S>",
    "<S> we prove the conjecture for all even numbers of character states , which is the most relevant case in biology . </S>",
    "<S> we also show that the conjecture does not hold in general for odd numbers of character states , but also present some positive results for this case .    </S>",
    "<S> example.eps gsave newpath 20 20 moveto 20 220 lineto 220 220 lineto 220 20 lineto closepath 2 setlinewidth gsave .4 setgray fill grestore stroke grestore </S>"
  ]
}