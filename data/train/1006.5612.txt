{
  "article_text": [
    "let @xmath0 be the @xmath1-dimensional euclidean space and let @xmath2 be the integral lattice . for a set @xmath3 ,",
    "we denote by @xmath4 its interior , by @xmath5 its convex hull , by @xmath6 its affine hull , by @xmath7 its volume , which is the usual lebesgue measure of @xmath8 , and by @xmath9 its dimension , which is defined as the dimension of its affine hull . by @xmath10",
    "we denote the @xmath9-dimensional volume of @xmath8 .",
    "a polytope is called integral ( rational ) , if all its vertices have integral ( rational ) coordinates . for a rational polytope @xmath11 ,",
    "we denote by @xmath12 the denominator of @xmath11 , that is , the smallest number @xmath13 such that @xmath14 is an integral polytope . in other words",
    "@xmath12 is the lowest common multiple of the denominators of all coordinates of the vertices of @xmath11 .",
    "furthermore , let the @xmath15-index @xmath16 of a rational polytope @xmath11 be the smallest number @xmath17 such that for each @xmath15-face @xmath18 of @xmath11 the affine space @xmath19 contains integral points . + a function @xmath20",
    "is called a _ quasi - polynomial with period @xmath21 _ if there exist periodic functions @xmath22 with period @xmath21 such that @xmath23 .",
    "ehrhart s theorem states the following :    [ ehr_quasipoly ] let @xmath24 be a rational polytope . then @xmath25 @xmath26 is called the _ ehrhart quasi - polynomial _ of @xmath11 . for every @xmath15 , the coefficient @xmath27 depends only on the congruence class of @xmath28 modulo @xmath16 .    here",
    ", @xmath29 is a periodic function and @xmath16 is a period of @xmath30 . the second part of this statement is due to mcmullen .",
    "furthermore , @xmath31 , and @xmath32 for all @xmath17 such that @xmath33 contains integer points .    for an introduction into ehrhart",
    "theory we refer to beck and robins .",
    "unfortunately , @xmath16 is not necessarily the minimal period of @xmath30 , that is , there is possibly a smaller integer number @xmath34 such that @xmath35 is a period of @xmath30 .",
    "this phenomenon is called period collapse and has been subject to active research in the last years . mcallister and",
    "woods studied the @xmath36- and @xmath37-dimensional case with the result that period collapse does not occur in dimension @xmath36 , and they gave a characterization of those rational polygons in dimension @xmath37 whose ehrhart quasi - polynomial is a polynomial .",
    "they also showed that the minimal periods of @xmath30 are not necessarily decreasing with @xmath15 .",
    "woods @xcite gave a polynomial - time algorithm in fixed dimension which decides whether a given integer @xmath35 is a period of all @xmath30 .",
    "in , beck , sam and woods constructed polytopes with no period collapse at all .",
    "furthermore , they showed that period collapse never occurs for @xmath38 .",
    "haase and mcallister gave a conjectural explanation of period collapse involving splitting the polytope into pieces and applying unimodular transformations onto these pieces .",
    "we show that the ehrhart quasi - polynomial can be generalized to a rational quasi - polynomial by allowing rational dilation factors , where a _ rational quasi - polynomial with period @xmath21 _ is a function @xmath39 of the form @xmath40 where @xmath41 is periodic with period @xmath21 .",
    "[ thm : rat_dilations ] let @xmath24 be a rational polytope .",
    "then for @xmath42 @xmath43 here , @xmath44 is a periodic function , and @xmath16 is a period of @xmath45 .",
    "we call @xmath46 the _ rational ehrhart quasi - polynomial _ of @xmath11 .",
    "we remark that @xmath45 is an extension of @xmath30 to rational numbers .",
    "hence , @xmath47 .",
    "furthermore , we have that @xmath48 for all @xmath49 such that @xmath50 contains integer points .",
    "we define a rational analogue of the @xmath15-index .",
    "these rational indices allow us to show a refined result on the periods of rational ehrhart quasi - polynomials .",
    "let the _ rational denominator _ @xmath51 of @xmath11 be the smallest positive rational number @xmath49 such that @xmath52 is an integral polytope : @xmath53 and let the _",
    "rational @xmath15-index _",
    "@xmath54 of @xmath11 be the smallest positive rational number @xmath49 such that for each @xmath15-face @xmath18 of @xmath11 the affine space @xmath55 contains integral points : @xmath56    then we get the following result :    [ cor : periods]let @xmath11 be a rational polytope .",
    "then @xmath54 is a period of @xmath45 .",
    "furthermore , @xmath57 is a rational quasi - polynomial with period @xmath58 .",
    "ehrhart s reciprocity law is also true for rational ehrhart quasi - polynomials :    [ cor : reci]let @xmath11 be a rational polytope and let @xmath59 be its rational ehrhart quasi - polynomial .",
    "then for @xmath42 , @xmath60    we show further that the coefficients @xmath45 of the rational ehrhart quasi - polynomial are piecewise polynomials . here , we assume @xmath11 to be full - dimensional .",
    "this assumption is necessary since , if @xmath11 is contained in an affine hyperplane not containing @xmath61 , we have @xmath62 for all @xmath42 such that @xmath50 does not contain integral points .",
    "thus , in that case @xmath63 for nearly all points @xmath42 . on the other hand ,",
    "if @xmath11 is contained in a hyperplane containing @xmath61 , it behaves like a full - dimensional polytope .",
    "[ thm : polycoeffs]let @xmath24 be an @xmath1-dimensional rational polytope and let @xmath64 be its rational ehrhart quasi - polynomial .",
    "then @xmath45 is a piecewise polynomial of degree @xmath65 .",
    "by @xmath66 we denote the first derivative of @xmath67 in @xmath49 if it exists . using this",
    "we deduce the following relation between the coefficients of the rational ehrhart quasi - polynomial of a polytope @xmath11 :    [ thm : derivatives]let @xmath24 be an @xmath1-dimensional rational polytope .",
    "then @xmath68 for all @xmath69 where the derivative exists .",
    "this theorem can be seen as a first step towards investigations on period collapses ; it implies that , in contrast to the integral case , the minimal periods of @xmath67 are decreasing with @xmath15 if @xmath70 .    in general nothing",
    "is known about extremal values of @xmath71 or @xmath67 . as a first result in this direction we have in the 2-dimensional case :    [ thm : dim2]let @xmath11 be an arbitrary @xmath37-dimensional rational polygon .",
    "then @xmath72 for all @xmath73 .",
    "to this end , we work out an explicit example using the approach presented by sam and woods in .",
    "an analogous statement for @xmath74 is not true .",
    "the paper is organized as follows : in section [ sec : rat ] we present all tools used for the proofs of the results presented in this introduction . the proofs of theorems [ thm : rat_dilations ] , [ thm : polycoeffs ] and [ thm : derivatives ] and their corollaries are given in this section as well . in section",
    "[ sec : dim2 ] we work out a detailed example ( see theorem  [ thm_2d_triangle ] ) and deduce theorem [ thm : dim2 ] from the explicit formulas of the rational ehrhart quasi - polynomial of this example .    for further information on ehrhart ( quasi-)polynomials and similar problems",
    "as considered in this work , we refer to .",
    "to prove theorem [ thm : rat_dilations ] , we need a well - known property of the @xmath75 , which we present here :    [ lem : int_dilations]let @xmath76 be the ehrhart quasi - polynomial of a rational polytope @xmath11 . then @xmath77 for @xmath78 .",
    "we have @xmath79 and @xmath80 . comparing coefficients yields @xmath77 ,",
    "@xmath81 ( see barvinok ( * ? ? ?",
    "* section 4.3 ) for details on equality of quasi - polynomials ) .",
    "let @xmath76 for @xmath17 be the ehrhart quasi - polynomial of @xmath11 .",
    "we define @xmath82 @xmath83 is well - defined , since for @xmath84 we get @xmath85 by lemma [ lem : int_dilations ]",
    ". then @xmath86 it remains to show that @xmath83 is periodic with period @xmath16 .",
    "since @xmath87 is a multiple of @xmath88 , we get @xmath89    this proof implies that knowing the classical ehrhart quasi - polynomial of @xmath90 for all positive integers @xmath91 is equivalent to knowing the rational ehrhart quasi - polynomial of @xmath11 .",
    "however , as the next remark shows , it is not enough to know the ehrhart quasi - polynomial of a polytope to recover the rational version :    @xmath57 is not invariant under translations of @xmath11 with respect to integral vectors .",
    "furthermore , @xmath57 is not necessarily monotonically increasing if @xmath92 .",
    "for instance , let @xmath93 ( see figure [ fig : rem]).then @xmath94 .",
    "nevertheless , we have @xmath95 and @xmath96 . moreover , @xmath97 and @xmath98 .     and @xmath99    furthermore , as for the integral case , there are examples of polytopes with different combinatorial type that have the same rational ehrhart quasi - polynomial .",
    "stanley @xcite constructed two classes of polytopes , _ order polytopes _ and _ chain polytopes_. in general these are polytopes of different combinatorial type but with the same ehrhart polynomials .",
    "since his consideration is independent of the integrality of dilation factors , these polytopes have also the same rational ehrhart polynomials .",
    "[ lem : rat_dilations]for all @xmath100 we have @xmath101 .",
    "let @xmath102 , @xmath103 . by the definition of @xmath67 in the proof of theorem [ thm : rat_dilations ] , we get , together with lemma [ lem : int_dilations ] , @xmath104    as in the integral case , the rational indices are divisors of each other .",
    "[ lem : rat_divisors]let @xmath11 be a rational polytope .",
    "then @xmath105 for @xmath106 .",
    "let @xmath107 be the respective affine hulls of the @xmath108 @xmath15-faces of @xmath11 and let @xmath109 be the smallest positive rational number such that @xmath110 contains integral points .",
    "then @xmath111 contains integral points if and only if @xmath49 is an integral multiple of @xmath109 , for @xmath112 .",
    "thus , @xmath54 is the smallest positive rational number that is an integral multiple of all @xmath109 .",
    "furthermore , since @xmath113 for some @xmath114 , we have that @xmath115 is an integral multiple of @xmath116 , and thus @xmath117 is an integral multiple of @xmath118 .",
    "now we are able to prove that the rational indices are periods of the coefficients of the rational ehrhart quasi - polynomials .    since @xmath119 for all @xmath15 , we know that @xmath120 this implies , together with lemma [ lem : rat_dilations ] , @xmath121 and thus @xmath122 furthermore , together with lemma [ lem : rat_divisors ]",
    ", we get that @xmath123 for @xmath106 , and thus @xmath58 is a period of @xmath124 .",
    "concerning the minimal periods of ehrhart quasi - polynomials , beck , sam and woods showed that @xmath125 is in fact the minimal period of @xmath38 .",
    "an analogous result is also true in the rational case :    let @xmath24 be a rational polytope and let @xmath59 be its rational ehrhart quasi - polynomial . then @xmath126 is the minimal period of @xmath127 .    by lemma [ lem : rat_dilations ] and",
    "since @xmath128 is homogeneous , it suffices to show the statement for all @xmath11 with @xmath129 .",
    "thus we assume that @xmath130 is a period of @xmath127 with @xmath131 , that is @xmath132 for all @xmath133 again by lemma [ lem : rat_dilations ] we get @xmath134 in particular this is true for all @xmath135 , and thus , @xmath136 is a period of @xmath137 , which is a contradiction , since @xmath138    we can also prove the ehrhart reciprocity law for rational ehrhart quasi - polynomials .",
    "we refer to beck and robins for details on ehrhart reciprocity law .",
    "let @xmath102 with @xmath139 .",
    "then , by ehrhart reciprocity law and lemma [ lem : rat_dilations ] , we get @xmath140    for the proof of theorem [ thm : polycoeffs ] we need the following lemma :    [ qp_const_lemma]let @xmath39 be a rational quasi - polynomial of degree @xmath141 with period @xmath142 and constant leading coefficient , that is , @xmath143 where @xmath144 and @xmath41 are periodic functions with period @xmath21 for @xmath145 . furthermore , suppose there exist an interval @xmath146 and @xmath147 for @xmath17 such that @xmath148 then @xmath149 is a polynomial of degree @xmath65 . furthermore , if @xmath150 then @xmath151 has negative leading coefficient .",
    "we prove this result by induction with respect to @xmath1 .",
    "for @xmath152 we have @xmath153 for all @xmath154 .",
    "thus , @xmath155 for @xmath154 , which is a polynomial of degree @xmath156 with negative leading coefficient . +",
    "now let @xmath157 .",
    "we have @xmath158 then @xmath159 with @xmath160 is a quasi - polynomial of degree @xmath161 with period @xmath21 and constant leading coefficient , and @xmath162 thus , we can use the induction hypothesis for @xmath163 , and together with @xmath164 we get that @xmath165 is a polynomial of degree @xmath166 for @xmath154 , for all @xmath167 . since @xmath168 we get , also by induction , that @xmath169 has a negative leading coefficient .",
    "+ now we use induction again to show that @xmath170 is a polynomial of degree @xmath171 for @xmath154 . for @xmath172",
    "we have that @xmath169 is a polynomial of degree @xmath36 with negative leading coefficient , hence the same is true for @xmath151 . for @xmath173 write @xmath174 then for @xmath154 , @xmath175 which is a polynomial of degree @xmath171 since @xmath176 is a polynomial of degree @xmath65 for @xmath177 by induction hypothesis .",
    "we conclude that @xmath176 is a polynomial of degree @xmath65 for @xmath154 and @xmath178 . that @xmath179 is a polynomial follows immediately from @xmath180 .",
    "next we show that ehrhart quasi - polynomials of full - dimensional rational polytopes satisfy the setting in lemma [ qp_const_lemma ] .    by theorem [ thm : rat_dilations ]",
    ", @xmath181 is a rational quasi - polynomial of degree @xmath1 with period @xmath51 and constant , nonzero leading coefficient .",
    "to apply lemma [ qp_const_lemma ] it remains to show that there exist @xmath182 such that @xmath181 is constant for @xmath183 and @xmath184 , @xmath17 . to this end",
    "we consider @xmath181 as a function @xmath185 .",
    "@xmath181 is certainly piecewise constant , and it jumps whenever integral points leave or enter @xmath52 , which can only happen if one of the facets of @xmath52 lies in a hyperplane containing integral points .",
    "thus , for every facet @xmath18 of @xmath11 let @xmath186 be the smallest positive rational number such that @xmath187 lies in a hyperplane containing integral points .",
    "then @xmath188 are the only possible jump discontinuities of @xmath181 . by the definition of @xmath51 , for a facet @xmath18 of @xmath11",
    "there exists a @xmath189 such that @xmath190 .",
    "thus for @xmath191 we can apply lemma  [ qp_const_lemma ] .",
    "we refer to figure [ g01pic ] in section [ sec : dim2 ] for a visualization of the @xmath45 .",
    "the rational ehrhart quasi - polynomials can be extended to real quasi - polynomials @xmath192 .",
    "to do that , for @xmath193 let @xmath194 , @xmath195 with @xmath196 .",
    "we define @xmath197 .",
    "this limit exists since @xmath45 is piecewise continuous and , for @xmath198 large enough , all @xmath199 are contained in the same continuous part of @xmath45 .",
    "then , since @xmath192 only jumps for rational points , we get @xmath200 baldoni et al .",
    "@xcite generalized this statement to intermediate sums of rational polytopes and gave an efficient algorithm to compute these real quasi - polynomials .",
    "now we show that the coefficients @xmath45 are derivatives of each other .",
    "let @xmath182 be as in the proof of theorem [ thm : polycoeffs ] , and for @xmath201 , @xmath17 let @xmath202 since @xmath67 is a polynomial of degree @xmath65 in @xmath49 , we can write it as @xmath203 since @xmath67 are periodic with period @xmath51 , we can write @xmath204 with @xmath17 and @xmath205 for some @xmath201 and get @xmath206 which is a constant polynomial in @xmath207 . thus , for @xmath208 , @xmath209 and therefore @xmath210 expanding to the quasi - polynomial form yields @xmath211 this implies that for all @xmath212 , @xmath201 , @xmath213 and the claim follows by differentiation .",
    "in what follows , we denote by @xmath214 the floor function , that is , @xmath215 is the largest integer not greater than @xmath216 , by @xmath217 the ceiling function , that is , @xmath218 is the smallest integer not smaller than @xmath216 , and by @xmath219 the fractional part , that is , @xmath220 . for the following calculations , we mention the following fact : let @xmath221 , @xmath222 and @xmath223",
    ". then @xmath224 and @xmath225 .",
    "first , we consider @xmath37-dimensional triangles of the form @xmath226 , where @xmath227 and @xmath228 .    ]    [ thm_2d_triangle]let @xmath229 with @xmath230 , @xmath231 , @xmath232 , and @xmath233 .",
    "then for @xmath42 the following hold : @xmath234    in what follows , we determine @xmath235 , @xmath236 , @xmath237 , ( see figure [ triangle2d ] , ) . for abbreviation",
    "we write @xmath238 instead of @xmath239 and @xmath49 for an arbitrary integer number with @xmath240 .",
    "it is @xmath241 this implies @xmath242 since @xmath243 , the first part can be written as @xmath244 for the second part , we remark that @xmath245 is periodic with period @xmath246 and @xmath247 thus , we get @xmath248 and similarly @xmath249 after some elementary algebra , expands to the claim .",
    "in particular , the theorem shows that ( as shown in section [ sec : rat ] ) @xmath250 is a period of @xmath251 , @xmath251 is piecewise linear , and that @xmath252 is a period of @xmath253 .",
    "furthermore , @xmath253 is piecewise quadratic , and the pieces are equal up to a constant depending only on @xmath28 ( see figure  [ g01pic ] ) .     and @xmath74,title=\"fig : \" ] and @xmath74,title=\"fig : \" ]    [ g1_corollary]let @xmath254",
    "be as in theorem [ thm_2d_triangle ] , @xmath255 , for @xmath256 .",
    "then @xmath257 for all @xmath258 .",
    "more precisely , @xmath259 .",
    "it is @xmath260 , @xmath261 , and @xmath262 for all @xmath263 , @xmath256 .",
    "since @xmath264 we get @xmath265 furthermore @xmath266    an analogous statement of corollary [ g1_corollary ] for @xmath267 is not true . to see this , we consider the triangles @xmath268 together with theorem [ thm_2d_triangle ] , we get , for @xmath269 , @xmath270 and @xmath271 , that @xmath272 then for @xmath273 , @xmath274 which tends to infinity , when @xmath275 goes to infinity , but @xmath276 .",
    "now we can deduce the inequality @xmath277 for arbitrary rational polygons :    we first consider only integral dilation factors , that is , we show that @xmath278 holds true for @xmath279 for arbitrary triangles @xmath11 with at least one integral vertex .",
    "_ this is true since @xmath279 is invariant under translations and unimodular transformations .",
    "+ _ 2 . is true for every rational polygon @xmath11 with one integral point in its interior .",
    "_ let @xmath11 be an arbitrary @xmath37-dimensional polygon with @xmath280 vertices and let @xmath281 be an integral point in the interior of @xmath11 .",
    "we consider the triangulation of @xmath11 as given in figure [ 6gon ] .    ]    here let @xmath282 .",
    "then for all @xmath283 , @xmath284 thus , expanding all ehrhart polynomials yields @xmath285 thus , step 1 implies that @xmath286 , and @xmath287 _ 3 . is true for arbitrary rational polygons @xmath11 .",
    "_ let @xmath288 such that @xmath289 contains at least one integral point in its interior .",
    "then for all @xmath17 , @xmath290 thus , from step c2 it follows that @xmath291 .",
    "+ finally we consider arbitrary rational dilation factors .",
    "let @xmath11 be an arbitrary rational polygon and let @xmath292 with @xmath293 , where @xmath294 and @xmath295 .",
    "then , by lemma [ lem : rat_dilations ] , @xmath296 .",
    "hence , implies that @xmath297 .",
    "the author would like to thank martin henk for helpful discussions and matthias beck and the reviewers for helpful comments improving the manuscript . [",
    "2 ] http://www.ams.org/mathscinet-getitem?mr=#1[#2 ] [ 2]#2"
  ],
  "abstract_text": [
    "<S> ehrhart s famous theorem states that the number of integral points in a rational polytope is a quasi - polynomial in the integral dilation factor . </S>",
    "<S> we study the case of rational dilation factors . </S>",
    "<S> it turns out that the number of integral points can still be written as a rational quasi - polynomial . </S>",
    "<S> furthermore , the coefficients of this rational quasi - polynomial are piecewise polynomial functions and related to each other by derivation . </S>"
  ]
}