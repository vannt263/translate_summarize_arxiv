{
  "article_text": [
    "over the last several decades algorithmic advances coupled with the development of high speed supercomputers , have made _ ab initio _ quantum mechanical simulations possible for a wide range of physical systems .",
    "these methods have been used to provide a theoretical framework for interpreting experimental results and even to accurately predict the material properties before experimental data were available .",
    "however , the calculations are currently restricted to systems containing a few hundred atoms.@xcite this limitation is set by the available computer power , and the scaling of the computational work with the number of atoms .",
    "one of the most successful of the recent techniques is the car - parrinello method@xcite in which the electronic orbitals are expanded in plane - wave basis functions and the resulting hamiltonian is iteratively diagonalized .",
    "the practical and efficient extension of _ ab initio _ quantum methods to larger and more difficult systems may be accomplished by the refinement and improvement of traditional methods or by the development of new techniques . although highly successful , traditional plane - wave methods encounter considerable difficulties when they are applied to physical systems with large length scales , or containing first - row or transition - metal atoms .",
    "these difficulties may be partially eliminated by the use of preconditioned conjugate - gradient techniques,@xcite optimized pseudopotentials,@xcite augmented - wave methods,@xcite or plane waves in adaptive coordinates.@xcite however , these methods are still constrained by the use of a plane - wave basis set , and the necessity of performing fast fourier transforms ( fft ) between the real and reciprocal spaces . while fft s may be implemented in a highly efficient manner on traditional vector supercomputers , the current trend in supercomputer design is massively parallel architectures .",
    "it is difficult to implement efficient fft algorithms on such machines , due to the required long range communications .",
    "real - space methods are inherently local and therefore do not lead to a large communication overhead .",
    "the scaling of several critical parts of large calculations is improved from @xmath1 in a plane - wave representation to @xmath2 , where @xmath3 is the number of atoms .",
    "furthermore , preconditioning and convergence acceleration are most effectively carried out in real space ( q.v . section iii ) .",
    "a real - space formulation is also required for efficient implementations of @xmath4 electronic structure methods , in which the computational work required scales linearly with the number of atoms .",
    "these methods impose a localization constraint on the electronic orbitals@xcite or the electron charge density,@xcite which eliminates the @xmath5 orthogonalization step .",
    "orbital - based real - space approaches , _",
    "e.g. _ atom - centered or floating gaussians , are very well established . recently ,",
    "however , there has been substantial interest in developing real - space orbital - independent methods , which permit systematic studies of convergence in the spirit of plane - wave methods .",
    "these methods include finite elements,@xcite grids , and wavelets.@xcite    the finite - element method was applied by white _",
    "@xcite to one - electron systems .",
    "they used both conjugate - gradient and multigrid acceleration@xcite to find the ground - state wavefunction .",
    "two of the present authors @xcite used a basis with a high density of grid points in the regions where the ions are located , and a lower density of points in the vacuum regions , in conjunction with multigrid acceleration , to calculate the electronic properties of atomic and diatomic systems .",
    "the core electrons were explicitly included and nearly singular pseudopotentials were used .",
    "the non - uniform grid led to order of magnitude savings in the basis size and total computational effort .",
    "the multigrid iterations , which provide automatic preconditioning on all length scales , reduced the number of iterations needed to converge the electronic wavefunctions by an order of magnitude in these multi - length - scale systems .",
    "et al._@xcite used a similar method to solve for the ground state of h@xmath6 .",
    "wavelet bases@xcite were used to solve the lda equations for atoms and the o@xmath7 molecule .",
    "et al._@xcite have used high - order finite - difference methods and soft nonlocal pseudopotentials on uniform grids to calculate the electronic structure , geometry , and short - time dynamics of small si clusters and of an isolated so@xmath7 molecule .",
    "et al._@xcite have used uniform grids and a smeared nuclear potential to examine the energetics and structures of atoms and small molecules .",
    "they employed multigrid iteration techniques to improve the convergence rates of the kohn - sham functional .",
    "real - space grids in curvilinear coordinates have been used by gygi and galli@xcite to compute the properties of atoms and co@xmath7 , and zumbach _",
    "et al._@xcite tested it on o@xmath7 .",
    "et al._@xcite used a uniform grid approach with pseudopotentials and a conjugate gradients scheme to calculate the electronic structure of p@xmath7 , and to study a positron trapped by a cd vacancy in cdte .    in a previous communication@xcite",
    "the present authors have outlined a multigrid - based approach suitable for large scale calculations , together with a number of test applications .",
    "these included calculations for a vacancy in a 64-atom diamond supercell , an _ isolated _",
    "@xmath8 molecule using non - periodic boundary conditions , a highly elongated diamond supercell , and a 32-atom supercell of gan that included the ga @xmath9 electrons in valence .",
    "uniformly spaced grids were used ; in this case an effective `` cut - off '' may be defined , which is equal to that of the plane - wave calculation that uses the same real - space grid for the fft s .",
    "whenever feasible , the corresponding calculations were also carried out using plane - wave techniques , and the two sets of results were in excellent agreement with each other .",
    "this paper provides a comprehensive description of the real - space multigrid method , and reports extensions to non - uniform grids , non - cubic grids , and to molecular dynamics simulations with highly accurate forces .",
    "several computational issues absent from plane - wave and orbital - based methods arise when using a real - space grid approach . in the plane - wave basis",
    "the action of the kinetic energy operator on the basis functions can be computed exactly , and the wavefunctions , potentials , and the electron charge density can be trivially expanded in the basis . every basis - set integral , except those involving the lda exchange - correlation functional , can be computed exactly .",
    "the computational errors in the calculations are mainly due to the truncation of the basis . in a real - space grid implementation",
    ", the kohn - sham equations must be discretized explicitly , which presents important trade - offs between accuracy and computational efficiency .",
    "furthermore , the quantum - mechanical operators are known only at a discrete set of grid points , which can introduce a spurious systematic dependence of the kohn - sham eigenvalues , the total energy , and the ionic forces on the relative position of the atoms and the grid .",
    "we have developed a set of techniques that overcome these difficulties and have been used to compute accurate static and dynamical properties of large physical systems , while taking advantage of the rapid convergence rates afforded by multigrid methods .",
    "this paper is organized as follows : in section ii a method for the accurate and efficient real - space discretization of the kohn - sham equations for cubic , orthorhombic , and hexagonal symmetries is described .",
    "section iii focuses on the multigrid algorithms , which greatly accelerate convergence of the electronic wavefunctions and of the hartree potential .",
    "tests of the convergence acceleration are described in section iv .",
    "the calculation of ionic forces that are sufficiently accurate for large step molecular dynamics requires special methods , which are described in section v. section vi discusses performance issues for massively parallel supercomputers , and describes a highly scalable and efficient implementation on the cray - t3d , which has been tested on up to 512 processors .",
    "the summary in section vii is followed by several technical appendices .",
    "electronic structure calculations that use a real - space mesh to represent the wavefunctions , charge density , and ionic pseudopotentials must address a new set of technical difficulties when compared with plane - wave methods . in a plane wave representation",
    "the form of the kinetic energy operator is obvious .",
    "in contrast , the representation of the kinetic energy operator on a real - space grid is approximated by some type of finite differencing , the accuracy of which must be carefully tested .",
    "below , we describe real - space discretizations for uniform cubic , orthorhombic , and hexagonal grids , as well as nonuniform scaled cubic grids that increase the resolution locally . for uniform cubic grids",
    "we also describe and test the extension to periodic systems with arbitrary sampling of the brillioun zone .",
    "previously,@xcite we described a real - space approach that uses uniform cubic grids with @xmath10 point k - space sampling . in direct comparisons with plane - wave calculations , we found nearly perfect agreement between the two methods for several test systems .",
    "we now provide further details of our method .    in real - space the wavefunctions , the electron charge density , and the potentials",
    "are directly represented on a uniform three - dimensional real - space grid of @xmath11 points with linear spacing @xmath12 .",
    "the physical coordinates of each point are @xmath13 the ions are described by norm - conserving pseudopotentials@xcite in the kleinman - bylander nonlocal form.@xcite these potentials are interpolated onto the grid from their radial representation . exchange and correlation effects are treated using the local density approximation ( lda ) of density functional theory , in which the total electronic energy of a system of electrons and ions may be expressed as @xmath14 -             \\mu_{xc}[\\rho({\\bf r } ) ] \\ } \\nonumber\\\\ & &     -{1 \\over 2 } \\int \\ , d{\\bf r } \\ , \\rho({\\bf r } ) \\ ,                          v_{hartree}({\\bf r } ) + e_{ion - ion}. \\label{lda - energy}\\end{aligned}\\ ] ] the minimization of this functional requires the solution of the kohn - sham equations @xmath15",
    "=      -{1 \\over 2}\\nabla^2 \\psi_n + v_{eff } \\psi_n = \\epsilon_n \\psi_n , \\label{ksequations}\\ ] ] subject to the orthonormality constraint on the eigenfunctions @xmath16 .",
    "the accurate discretization of these equations on the grid structure described by eq .",
    "( [ grid1 ] ) requires appropriate numerical representations of the integral and differential operators .",
    "all integrations are performed using the three - dimensional trapezoidal rule : @xmath17 we have found that for high accuracy it is essential that the integrand @xmath18 be band - limited in the sense that its fourier transform should have minimal magnitude in the frequency range @xmath19 .",
    "this is explicit in a plane - wave calculation since the basis is cut - off at a specific plane - wave energy .",
    "the discrete real - space grid also provides a kinetic - energy cut - off of approximately @xmath20 . unlike the plane - wave basis",
    ", high - frequency components above this cut - off can nonetheless manifest themselves on the grid .",
    "this high - frequency behavior , which can introduce unphysical variation in the total energy or the electron charge density , is perhaps best seen when the ions , and hence their pseudopotentials , shift relative to the grid points.@xcite if the pseudopotentials contain significant high - frequency components near or above @xmath21 then , as the ions shift , the high frequency components are aliased to lower frequency components in an unpredictable manner",
    ".    this effect can be decreased by _",
    "explicitly _ eliminating the high - frequency components in the pseudopotentials by fourier filtering . in the context of plane - wave calculations , king - smith",
    "_ et al._@xcite recognized that the real - space integration of the nonlocal pseudopotentials could differ significantly from the exact result computed in momentum space , unless the potentials were modified so that fourier components near @xmath21 were removed .",
    "fourier filtering of the pseudopotentials is thus required in real - space calculations for accurate results .",
    "it is , of course , possible to use unfiltered potentials on real - space grids provided the grid spacing is sufficiently small , but our experience shows that the total energy and the electron charge density are often sufficiently well converged for significantly larger grid spacings  provided that explicit pseudopotential filtering is used .",
    "we use a somewhat different fourier filtering method than that proposed by king - smith _ et al .",
    "_ , but it produces essentially the same effect ( see appendix b ) .",
    "the differential operator in the kohn - sham equations is approximated using a _ generalized _ eigenvalue form : @xmath22 = & & \\nonumber\\\\ { 1 \\over 2 } { \\bf a}_{mehr}[\\psi_n ] + { \\bf b}_{mehr}[v_{eff } \\psi_n ] = & &             \\epsilon_n { \\bf b}_{mehr}[\\psi_n ] , \\label{compact - implicit}\\end{aligned}\\ ] ] where @xmath23 and @xmath24 are the components of the _ mehrstellen _ discretization,@xcite which is based on hermite s generalization of taylor s theorem .",
    "it uses a weighted sum of the wavefunction and potential values to improve the accuracy of the discretization of the _ entire _ differential equation , not just the kinetic energy operator .",
    "in contrast to the central finite - differencing method , this discretization uses more _ local _ information ( next - nearest neighbors , for example ) .",
    "the definition of the fourth - order _ mehrstellen _ operator used in the present work is specified by the weights listed in table [ mehrstellen - ortho ] , which pertain to both cubic and orthorhombic grids ( see below ) . a more detailed analysis of the _ mehrstellen _ operator and eq .  ( [ compact - implicit ] )",
    "is given in appendix a.    this representation of the kohn - sham hamiltonian is short - ranged in real space in the sense that the operator can be applied to any orbital in @xmath25 operations . specifically , the application of the @xmath23 operator at a point involves a sum over 19 orbital values while the application of the @xmath24 operator requires a sum over 7 points .",
    "the local potential multiplies the orbital pointwise , and the short - ranged nonlocal projectors require one integration over a fixed volume around each ion and a pointwise multiplication .",
    "this sparseness permits the use of iterative diagonalization techniques , and the short - ranged representation of the hamiltonian leads to an efficient implementation on massively parallel computers .",
    "the discussion up to this point has been restricted to uniform cubic grids , but the extension to a general orthorhombic grid is straightforward .",
    "there are now three separate grid spacings @xmath26 , @xmath27 , and @xmath28 with the coordinates of each grid point given by : @xmath29 the orthorhombic _ mehrstellen _ operator described in table [ mehrstellen - ortho ] is used to discretize the kohn - sham equations and numerical integration is performed according to @xmath30 .",
    "\\label{integration1}\\ ] ]      in the preceding section the wavefunctions were assumed to be real , with the brillioun - zone sampling restricted to the @xmath10 point .",
    "when these restrictions are lifted the kohn - sham equations become @xmath31 where the @xmath32 are now the periodic parts of the bloch functions .",
    "they are complex - valued , which presents no additional difficulties in discretization .",
    "the nonlocal projectors in @xmath33 have been multiplied by the phase factor @xmath34 .",
    "the gradient term @xmath35 is computed using a central finite difference expression , which in one dimension has the form : @xmath36 where @xmath37 , @xmath38 , @xmath39 , and @xmath40 .",
    "for a cubic grid structure the three dimensional generalization of this is the sum of the individual expressions for each coordinate axis . denoting this finite - difference operator by @xmath41 ,",
    "the discretization of the kohn - sham equation becomes @xmath42 & & = { 1 \\over 2 } { \\bf a}_{mehr}[\\psi_{nk } ] + \\nonumber\\\\      & & { \\bf b}_{mehr}[i{\\bf k } \\cdot \\tilde { \\bf \\nabla } \\psi_{nk } +          { 1 \\over 2 } { \\bf k}^2\\psi_{nk } + v_{eff}({\\bf k } ) \\psi_{nk } ] \\nonumber\\\\     & & = \\epsilon_n { \\bf b}_{mehr}[\\psi_{nk } ] , \\label{complexcompact - implicit}\\end{aligned}\\ ] ] where @xmath23 and @xmath24 are again the components of the _ mehrstellen _ operator .",
    "the accuracy of the discretization was tested by calculating the lattice constant and bulk modulus for an 8-atom si supercell .",
    "a 26-ry equivalent cut - off was used with k - space sampling restricted to the baldereschi point.@xcite the calculated lattice constant was 5.38   with a bulk modulus of 0.922 mbar .",
    "these are in good agreement with the corresponding plane - wave calculation with the cut - off of 26 ry : 5.39   and 0.960 mbar , respectively.@xcite    bulk aluminum was selected as an additional test case .",
    "a 4-atom cell was used with a 23 ry equivalent cut - off and k - space sampling of 35 special points in the irreducible part of the brillouin zone .",
    "since al has partially occupied orbitals , the bands near the fermi level were occupied using a fermi - dirac broadening function of width 0.1 ev . the convergence of the total energy with respect to energy cut - off and the number of k - points was tested by increasing the cut - off from 23 to 49 ry , which produced a change of only 10 mev / atom , and by increasing the number of k - points to 56 , which changed the total energy by 3 mev / atom . the calculated lattice constant and bulk modulus of 4.02   and 0.734 mbar are in excellent agreement with the experimental values of 4.02   and 0.722 mbar , and with previous theoretical results of lam and cohen@xcite of 4.01   and 0.715 mbar .      unlike plane - wave methods , where different symmetry groups can be handled easily",
    ", an _ efficient _ real - space implementation for periodic systems with non - orthogonal lattice translation vectors requires considerable modifications to the orthorhombic - symmetry implementation .",
    "the hexagonal grid describing the unit cell or supercell is generated by @xmath43 where the @xmath44 are the hexagonal bravais - lattice vectors.@xcite the @xmath45 ratio can be chosen arbitrarily by varying the two independent grid spacings , @xmath46 and @xmath28 , and the number of grid points , @xmath47 and @xmath48 .",
    "however , one should use @xmath49 in order to maintain similar resolution both in the _ xy _ plane and along the _ z_-axis . because the indexing of this hexagonal grid is isomorphic to the cubic one , the computer representation of potentials and wavefunctions does not change .",
    "the most important difference is in the discretization of the kohn - sham equations .",
    "we have implemented a mixed sixth - order kinetic energy operator .",
    "this discretization is described in appendix c , as well as the modifications required in the multigrid restriction and interpolation procedures ( q.v . section iii ) .",
    "the above implementation has been tested on a 32-atom supercell of aln in the wurtzite phase .",
    "the accuracy of the results was confirmed by comparison with plane - wave car - parrinello calculations on the same supercell .",
    "generalized norm - conserving@xcite al and n pseudopotentials were used for both calculations with k - space sampling restricted to the @xmath10 point .",
    "the cohesive energy from the real - space calculation was 11.5 ev per aln unit , which compares well with the value of 11.6 ev obtained in the car - parrinello calculations .",
    "the eigenvalue degeneracies were identical in both calculations and the maximum difference in any eigenvalue was 0.04 ev .",
    "the extension of the real - space grid representation to other bravais lattices proceeds in a similar manner , the only requirement being the existence of an accurate finite difference discretization .      in real - space calculations it is possible to add resolution locally .",
    "this is especially valuable for systems with a wide range of length scales such as surface or cluster calculations .",
    "a high density of grid points can be used near the ions , with a low density in the vacuum regions .",
    "other possible applications are simulations of impurities in bulk materials , where the impurity ions may require higher resolutions to be accurately represented . by using locally enhanced regions the required resolution may be added only where needed , thereby greatly reducing the total number of points required .",
    "local enhancement of the grid resolution may be achieved by adding small high - resolution grids@xcite onto a uniform global grid , or by using a coordinate transform to warp the grid structure . our focus here will be on the second approach , which was first proposed by gygi@xcite for plane - wave basis sets and recently extended to real space by several workers.@xcite in the real - space approach , a continuous coordinate transform is applied to a uniform grid . in general the transformation",
    "is non - separable , but we prefer a separable coordinate transformation in order to avoid mixed derivatives in the kinetic - energy operator . as a test of the utility and accuracy of this scaled - grid approach , we examined an interstitial oxygen impurity in si@xcite for two grid layouts : a dense uniform grid with a 76-ry cut - off and a scaled grid with a cut - off that varied from 18 ry to 76 ry .",
    "the scaling - transformation that maps the fictitious computational grid @xmath50 to the physical warped grid @xmath51 is @xmath52 where @xmath53 is the @xmath50-coordinate of the oxygen atom , @xmath54 is the length of the supercell in the @xmath50-direction , and @xmath55 is an adjustable parameter between zero and one that controls the degree of scaling .",
    "the @xmath56 and @xmath57 coordinates are scaled analogously .",
    "the scaled grid required four times fewer points than the uniform grid to achieve the same convergence of the total energy .",
    "since the coordinate transforms are continuous functions , the integration weights and the coefficients of the discretized kinetic - energy operator may be generated from the uniform grid values using the metric tensor of the transform in the manner outlined by gygi.@xcite with these modifications , the calculations proceed as for the uniform grids , but a sixth - order central finite - difference operator is used to discretize the first and second derivatives because we have not constructed a _",
    "operator for the scaled grid . in each case",
    "( uniform and scaled grids ) , a 64-atom supercell was used and the silicon atoms were fully relaxed .",
    "the oxygen atom was held fixed in order to avoid pulay corrections@xcite to the ionic forces , which would have been required if it and the scaled grid were free to move .",
    "the uniform and scaled - grid calculations are in very good agreement : the maximum difference in kohn - sham eigenvalues was 40 mev and the maximum difference in ionic coordinates was 0.03  .",
    "to efficiently solve eq .",
    "( [ compact - implicit ] ) , we have used multigrid - iteration techniques that accelerate convergence by employing a sequence of grids of varying resolutions .",
    "the solution is obtained on a grid fine enough to accurately represent the pseudopotentials and the electronic wavefunctions .",
    "if the solution error is expanded in a fourier series , it may be shown that iterations on any given grid level will quickly reduce the components of the error with wavelengths comparable to the grid spacing but are ineffective in reducing the components with wavelengths large relative to the grid spacing.@xcite the solution is to treat the lower frequency components on a sequence of auxiliary grids with progressively larger grid spacings , where the remaining errors appear as high frequency components .",
    "this procedure provides excellent preconditioning for all length scales present in a system and leads to very rapid convergence rates . the operation count to converge one wavefunction with a fixed potential",
    "is @xmath25 , compared to @xmath58 for fft - based approaches.@xcite    there is no one multigrid algorithm but rather a collection of algorithms that share certain common features . in order to describe the implementation used in this work , we start with a description of a multigrid solver for poisson s equation .",
    "this will then be used as a building block for the more sophisticated algorithms actually employed .    a standard numerical problem that illustrates the multigrid algorithm is the poisson equation , @xmath59 , defined on a rectangular cell of dimensions @xmath60 with periodic boundary conditions .",
    "a standard method of solving for @xmath61 is to discretize the equation on a uniform three dimensional grid with spacing @xmath12 and @xmath11 total points . the differential operator @xmath62 is represented by some form of finite differencing .",
    "this produces a set of linear algebraic equations @xmath63 where @xmath64 and @xmath65 are the discretized forms of @xmath66 and @xmath67 , respectively , and @xmath68 is the finite - difference representation of @xmath62 .",
    "if the system is small , direct matrix methods are an acceptable means of solving the equations ; however , for large systems the work required scales as @xmath69 , which is prohibitive .",
    "an alternative approach is to use an _ iterative _ relaxation scheme such as the jacobi method.@xcite in this technique , the solution is iteratively improved .",
    "first , define @xmath70 as an approximate solution of eq .",
    "( [ mg1 ] ) , and the residual @xmath71 , a measure of the solution error , as @xmath72 an improved @xmath70 is generated using @xmath73 where @xmath74 is a pseudo time step and k is the inverse of the diagonal component of @xmath68 .",
    "this approach will always converge to a solution for some value of @xmath74 if @xmath68 is diagonally dominant.@xcite however , the number of iterations required to reduce the magnitude of the residual to a specified accuracy is proportional to @xmath75 , so that the algorithmic cost to converge , @xmath76 , is too great.@xcite while more sophisticated relaxation methods such as gauss - seidel , successive overrelaxation ( sor ) , or the alternating direction implicit method ( adi)@xcite have improved convergence rates , they still scale as @xmath77 with @xmath78 , and are too slow for the grid sizes required in electronic structure calculations .",
    "the slow convergence of the jacobi method can be qualitatively understood by noting that because @xmath68 is a short - ranged operator , the updated approximate solution , eq .",
    "( [ res2 ] ) , is a linear combination of nearby values .",
    "if the error in the current estimate of @xmath70 is decomposed into fourier components , it can be shown that one jacobi iteration considerably reduces the high frequency components of the error , but many jacobi iterations are needed to affect the longest wavelength components of the error .",
    "the overall convergence rate is then limited by that of the lowest frequency components .",
    "as the problem becomes larger , the lowest frequency representable on the grid becomes smaller and the convergence rate decreases .",
    "the essence of the multigrid approach is the observation that the individual frequency components of the error are best reduced on a grid where the resolution is of the same order of magnitude as the wavelength of the error component .",
    "this approach will maintain a high convergence rate for all frequency components of the error even when the problem size ( and the grid ) becomes very large .",
    "we first describe a multigrid algorithm to solve poisson s equation that uses two grids ; a fine grid of spacing @xmath79 and a coarser auxiliary one of spacing @xmath80 . in this work",
    ", we use a coarse - to - fine grid ratio @xmath81 of 2 , but other ratios are possible .",
    "the solution is generated as follows : the high - frequency components of the solution error with wavelength @xmath82 are reduced by one or two jacobi iterations .",
    "the residual @xmath83 , which should be devoid of high - frequency variation , is computed and transferred to the coarse grid by restriction ( see below ) .",
    "next , poisson s equation on the coarse grid with the residual as a source term is solved by using the same iteration procedure as in eq .",
    "( [ res2 ] ) , but with an initial estimate of zero .",
    "the jacobi iteration on this level removes error components with wavelength @xmath84 . finally , the coarse grid solution is interpolated to the fine grid and added to the fine grid solution .",
    "this process is referred to as a coarse - grid - correction scheme ( cgc ) .",
    "a few applications of the cgc cycle are generally sufficient to solve poisson s equation to machine precision even for extremely large systems .",
    "an obvious question is how the solution is obtained on the coarse grid .",
    "if the total number of grid points in the coarse grid is small , a direct matrix method will be sufficient . if this number is so large that a direct method is impractical , then a second , coarser grid level is introduced and the two - grid algorithm is repeated in a recursive manner . when multiple grid levels are used , the pattern of cycling through the grids also needs to be considered .",
    "we use a simple progression from the finest to the coarsest grid level and then back to the finest level , which is referred to as a v - cycle .",
    "more complicated cycling schemes exist , but we have found that the v - cycle works as well in electronic structure calculations as the more sophisticated approaches .",
    "another consequence of the multigrid approach is the reduction in the size of the grid ( and consequently in the work required ) on each level . for a uniform grid in three dimensions",
    "a doubling of @xmath12 with each level leads to a factor of eight reduction in @xmath11 , so that the addition of extra coarse grid levels is computationally inexpensive .",
    "the simplest choice for the restriction operator is to copy every other point in the fine grid directly to the coarse grid .",
    "this so - called straight injection , while easy to implement , does not always yield good convergence rates .",
    "a better choice is a weighted restriction , in which each coarse - grid value is the average of the 27 fine - grid values surrounding it . in our work ,",
    "the weight assigned to each fine - grid point is proportional to the volume it occupies at a given coarse - grid point .",
    "a good choice for interpolating from the coarse grid to the fine grid is the adjoint of the restriction operator , which in this case becomes simple tri - linear interpolation.@xcite    the final accuracy of the solution is determined by the finite - difference representation of @xmath62 on the finest grid level .",
    "it is neither necessary nor desirable to use the same representation of @xmath62 on all grid levels ; i.e. , @xmath85 may differ from @xmath86 in the form of the discretization as well as in the grid spacing .",
    "the technique of changing discretization on different levels is referred to as deferred defect correction ( ddc ) or double discretization.@xcite it is especially valuable for problems where the operator used on the finest grid level is numerically unstable on the coarser grids , or when it is inconvenient to apply .",
    "the accuracy of the fine - grid solution does not depend on the choice of this coarse - grid operator , which effects only the convergence rate . in solving poisson s equation , we use the _ mehrstellen _ operator on the finest grid level for high accuracy . however , it is unsuitable for convergence acceleration on the coarser grids because of stability problems .",
    "thus , on the coarser grids a 7-point central finite - difference operator is used , which provides excellent stability and rapid high - frequency attenuation .",
    "the extension of multigrid concepts to the solution of the kohn - sham equations introduces several complications .",
    "first , the equations are non - linear since the eigenvalues and the orbitals must be computed simultaneously .",
    "second , when the kleinman - bylander form of the nonlocal pseudopotentials is used , the equations become a set of integro - differential eigenvalue equations . finally , the hamiltonian depends upon the density , and must be solved self - consistently .",
    "brandt _ et al._@xcite have given a multigrid algorithm for the standard eigenvalue problem .",
    "below we describe an alternative means of linearizing the eigenvalue equations .",
    "the multigrid technique recommended in the literature for non - linear integro - differential equations is the full approximation storage ( fas ) method.@xcite in fas the _ entire _ problem is discretized and solved on _ all _ grid levels .",
    "in contrast , the cgc method outlined above generates the full solution only on the finest level . while the theoretical performance of fas on this problem is superior , its implementation is significantly more complex . in addition , it is difficult to obtain an accurate representation of the nonlocal pseudopotentials on the coarser grid levels .",
    "furthermore , the kohn - sham equations need not be converged to maximum accuracy at every iteration , because the electron charge density ( and therefore the hamiltonian ) change after each multigrid step .    for these reasons ,",
    "a modification of the double discretization approach described above was used .",
    "the discretized operator on the finest grid is the _ mehrstellen _ approximation of the kohn - sham hamiltonian , while a 7-point central finite - difference representation of @xmath62 alone is used on the coarse grids .",
    "effectively , the coarse - grid equation for the wavefunction residual becomes poisson s equation , where the source term is the residual generated by the _ mehrstellen _",
    "operator on the fine grid , eq.([mehrres ] ) .",
    "our multigrid procedure begins with the selection of some initial wavefunctions and electron charge density .",
    "we postpone discussion of initialization techniques until later and assume that an adequate start has been generated .",
    "the following steps are then performed for each individual wavefunction : first , an estimate of the eigenvalue is calculated from the rayleigh quotient of the generalized eigenvalue equation , eq.([compact - implicit ] ) : @xmath87\\rangle        \\over       \\langle\\psi_n| { \\bf b}_{mehr } [ \\psi_n]\\rangle } .",
    "\\label{rd1a}\\ ] ] in the case of complex orbitals , the eigenvalue is calculated using the rayleigh quotient of the real ( or imaginary ) part of the generalized eigenvalue equation , eq .",
    "( [ complexcompact - implicit ] ) : @xmath88| re[{\\bf h}_{bloch } [ \\psi_{nk}]]\\rangle        \\over       \\langle re[\\psi_{nk}]| re[{\\bf b}_{mehr } [ \\psi_{nk}]]\\rangle } .",
    "\\label{rd1b}\\ ] ] next , several jacobi iterations are applied to the orbital on the finest grid using eqs .  ( [ res1 ] ) and ( [ res2 ] ) , where the residual is computed as @xmath89 - { \\bf h}_{mehr}[\\psi_n ] .",
    "\\label{mehrres}\\ ] ] the fictitious time step @xmath90 used in the jacobi iteration is typically chosen between @xmath91 and @xmath92 a.u . in the case of complex orbitals ,",
    "the real and imaginary components of the orbital are updated separately , using the appropriate generalization of eq .",
    "( [ mehrres ] ) .",
    "next , the residual is restricted to the first coarse grid .",
    "a ddc coarse - grid cycle begins using the 7-point central finite - difference representation of @xmath62 instead of @xmath93 .",
    "several auxiliary coarse grids can be used .",
    "when the coarse - grid correction is interpolated onto the finest grid , only a fraction @xmath94 of it is added to the orbital , for reasons of stability .",
    "a value of @xmath95 has been found to work for almost all systems .",
    "( larger values may produce much higher convergence rates on some systems while being unstable for others , so some experimentation is necessary . )    before transferring the residual to the coarse grid , it is essential that enough jacobi iterations be performed to eliminate the high frequency components from the residual .",
    "since the residual is used as the right hand side of a cgc correction cycle , any high frequency components will eventually be transferred to a coarser grid where they can not be represented correctly , greatly reducing the effectiveness of the multigrid cycle . in some cases",
    "they may even make the process numerically unstable . in the above approach ,",
    "the difficulties of discretizing the nonlocal pseudopotentials on the coarse grid levels are avoided because the potential term is computed on the finest grid and frozen thereafter .",
    "the steps outlined above in the ddc apply only to a single wavefunction .",
    "the full solution process also requires the application of the orthonormality constraints and an update of the electron charge density .",
    "the full solution process ( one scf step ) consists of the following cycle .",
    "first , the ddc is applied to all of the wavefunctions .",
    "next , the orthonormality constraints are applied using the gram - schmidt procedure : @xmath96 the new electron charge density is generated by linear mixing : @xmath97 where @xmath98 is the occupation of the @xmath99 state and @xmath100 is a mixing parameter , generally set to a value between 0.5 and 0.9 .",
    "next , the hartree potential is recomputed for the new charge density using a _",
    "ddc cycle , and a new exchange - correlation potential is generated .",
    "finally , a subspace diagonalization may be performed at this point .",
    "this need only be done occasionally ( every 10 - 20 scf steps is generally adequate ) in order to unmix eigenstates that may be close in energy . because the _ mehrstellen _ hamiltonian leads to a non - hermitian generalized eigenvalue equation ( see appendix a )",
    ", subspace diagonalization requires a brief discussion : we look for a unitary transformation of the current wavefunctions that better represents the eigenvectors of the hamiltonian , and are led to the following eigenvalue equation for the subspace : @xmath101 where @xmath102\\rangle \\\\   b^{sub}_{m ,",
    "n } = & & \\langle\\psi_m| { \\bf b}_{mehr } [ \\psi_n]\\rangle,\\end{aligned}\\ ] ] and @xmath103 is the matrix of coefficients of the unitary transformation for the @xmath104 state . because @xmath105 is invertible ( see appendix a ) , the subspace equations are equivalent to @xmath106 where @xmath107 .",
    "the matrix @xmath108 is not hermitian except when the subspace is a subset of the space of eigenvectors .",
    "thus , we do _ not _ diagonalize @xmath108 because its eigenvectors are not necessarily orthogonal , which would spoil the orthogonality of the electronic orbitals .",
    "instead , we discard the anti - hermitian part of @xmath108 , which is smaller than the hermitian part of @xmath108 by @xmath109 , and diagonalize the hermitian part .",
    "this approximation works well in practice , and is exact at convergence",
    ".    the hermitian approximation does not affect the final accuracy of the solution because the multigrid - assisted jacobi iterations ultimately converge the orbitals . nonetheless , accurate subspace rotations are essential for good convergence : compare the convergence rates in figs.[siliconconvergence]-[diamondconvergence ] . as a test , we compared subspace diagonalizations with the _ mehrstellen _ and the hermitian sixth - order discretizations , and found that the convergence is significantly improved with the former .",
    "the cycle described above is repeated until the electronic system converges to the desired tolerance , which may be monitored by computing the rms value of the residual vector for each wavefunction ( see eq .",
    "( [ mehrres ] ) ) . when this reaches a value of @xmath110 a.u .  for all wavefunctions in the occupied subspace ,",
    "the convergence is sufficient for the computation of forces that are accurate enough for large step molecular dynamics with excellent energy conservation .",
    "as was mentioned previously , the convergence rates depend on the choice of the initial wavefunctions and electron charge density .",
    "a poor choice can lead to slow convergence rates or in some cases the system will not converge at all . apart from random initial wavefunctions or an approximate solution that is generated using an lcao basis set",
    ", one can also use a double - grid scheme . in the latter method",
    "the initial solutions are generated on a grid with a spacing twice as large as that used for the final grid .",
    "the computational work on this coarse grid is eight times smaller than what is needed on the fine grid .",
    "the approximate coarse - grids wavefunctions are then interpolated to the fine grid and used as the initial guess .",
    "this process can reduce the number of scf cycles needed on the finest grid level by a factor of two to three , thereby achieving significant savings in the computational effort .",
    "the theoretical convergence rates of multigrid methods may , in principle , be calculated exactly for certain types of problems . for well - behaved partial differential equations such as poisson s equation",
    "discretized on @xmath11 points , @xmath25 total operations are required to obtain a solution accurate to the the grid - truncation error .",
    "this compares well with fft based methods which require @xmath111 $ ] operations . for the kohn - sham equations ,",
    "an exact theoretical bound on multigrid convergence rates is difficult to obtain due to self - consistency effects , and to the best of our knowledge this analysis does not yet exist . we have therefore elected to study convergence properties in an empirical fashion by performing tests on physical systems typical of the problems normally examined with density functional theory .    in previous work@xcite",
    "the present authors examined convergence rates for 8-atom supercells of perfect diamond as a function of the effective kinetic - energy cut - off determined by the grid resolution , for a 32-atom supercell of gan that included the ga @xmath9 electrons in valence , and for a highly elongated 96-atom diamond supercell .",
    "it was found that multigrid convergence rates were largely independent of energy cut - off and cell geometries .",
    "while promising , these results were obtained for perfect crystal configurations of semiconductor compounds , which are generally fairly easy to converge . in this article",
    "we present the results of a more systematic study that includes disordered systems .",
    "the first system selected was a 64-atom supercell of bulk silicon .",
    "the ions were represented by a generalized norm - conserving pseudopotential@xcite and the grid spacing used corresponded to an energy cut - off of 12 ry .",
    "the ionic positions were generated by a molecular dynamics simulation at a temperature of 1000 k. because the work required to converge to the ground state depends on the quality of the initial wavefunctions and charge density , we used random initial wavefunctions and a constant initial electron charge density to minimize any possible bias from the choice of a starting configuration . a small number ( 10% of the total ) of conduction band states",
    "was included in the calculations .",
    "fig.[siliconconvergence ] shows the convergence rate defined as the @xmath112 , plotted as a function of iteration number , where each iteration represents a single scf step .",
    "results are shown for calculations performed with and without multigrid acceleration , where the latter used a steepest - descents algorithm .",
    "in addition , the two calculations were repeated with , and without subspace diagonalizations of the orbitals . for the calculations that included subspace diagonalizations ,",
    "the procedure was applied every 8 scf steps , which led to small discontinuities in the smooth evolution of the total energy .",
    "the results show that maximum convergence rates are obtained when multigrid iterations are combined with subspace diagonalization .",
    "the slowest convergence occurs for steepest descents with no subspace diagonalization .",
    "for the two runs where subspace diagonalizations were performed , the multigrid run converged at roughly 2.5 times the rate of the steepest descents approach .    while these results are encouraging , bulk silicon is a relatively straight - forward test and is well handled by standard plane - wave methods . as an example of a more difficult system we have considered a 64-atom diamond supercell with a substitutional nitrogen impurity .",
    "standard pseudopotentials@xcite were used for both c and n. the strong n @xmath113 potential required an energy cut - off of 63 ry .",
    "the presence of a localized nitrogen donor level together with the 63 ry cut - off makes the system more difficult to converge .",
    "random initial wavefunctions were used , and fig .",
    "[ diamondconvergence ] shows the observed convergence rates .",
    "the convergence rates for the two runs that use subspace diagonalization are a factor of 4 better for multigrid than for steepest descents .",
    "this relative improvement is considerably greater than that observed for the silicon cell and is the consequence of the automatic preconditioning provided by multigrid techniques for all of the length and energy scales present in the problem .",
    "the multigrid convergence rates are largely independent of the grid spacing , which roughly corresponds to the kinetic energy cut - off in plane - wave approaches .",
    "this is not true of the steepest descents algorithm , where the maximum stable time step that may be used decreases as the energy cut - off increases .    when comparing the convergence rates of the multigrid and steepest descents approaches , the computational workload involved in each technique",
    "must also be considered . a particular advantage of multigrid methods , when compared to other convergence acceleration schemes , is their low computational cost .",
    "this is due to the factor of 8 reduction in the number of grid points on each successive multigrid level .",
    "the computational time per scf step in the silicon and diamond runs described above increased by less than 10% when multigrid was used instead of steepest descents . for bigger systems , where the costs of orthogonalizing the orbitals and applying the nonlocal pseudopotentials begin to dominate the total computational time",
    ", the extra work needed for the multigrid accelerations becomes negligible . in terms of computational time , the 64-atom si supercell described above required 1.6 seconds per scf step on 64 processors of a cray - t3d .",
    "efficient structure optimizations and the calculation of dynamical quantities such as phonon frequencies and thermodynamic properties require accurate ionic forces . in plane - wave methods",
    "the ionic forces are computed by applying the hellmann - feynman theorem.@xcite since the derivative of the pseudopotentials may be expressed exactly within the plane - wave basis , the accuracy of the ionic forces is limited only by machine precision and the degree of convergence to the born - oppenheimer surface .    for the grid - based approach the accuracy of hellmann - feynman forces is limited by the numerical error in computing the integrals of the derivatives of the pseudopotentials .",
    "this error decreases with grid spacing .",
    "the differentiation of the radial potentials and projectors must be performed with care to include the effects of the fourier filtering .",
    "alternatively , a derivative - free implementation of the hellmann - feynman forces can be used , which we term virtual displacements . in this scheme ,",
    "the ionic pseudopotentials are numerically differentiated directly on the real - space grid .",
    "the ions are moved through a set of small displacements , while the electron charge density and the wavefunctions are held fixed .",
    "the potential energy is calculated for each displacement and finite - differenced to form the derivative .",
    "the forces computed by the two methods agree well .",
    "most of the forces we have calculated to date have been computed using virtual displacements .",
    "a stringent test of the accuracy of the ionic forces is a constant - energy molecular dynamics simulation .",
    "over the course of the simulation any systematic errors in the forces will manifest themselves as poor energy conservation .",
    "a distinction has to be made between small random errors that appear as bounded oscillations in the total energy and errors that increase in magnitude with simulation time .",
    "the small random errors are expected in the real - space approach because the energy of an ion varies by a small amount as its position changes relative to the grid points.@xcite this is of no particular concern as long as the magnitude of the variation is small and oscillatory in nature .",
    "of greater concern are errors that are unbounded .",
    "these could arise from errors in the forces , errors in integrating the equations of motion of the ions , and lack of self - consistency due to inadequate convergence of the electronic wavefunctions .",
    "the first source of error was minimized by fourier filtering of the ionic pseudopotentials .",
    "the second is generally not a problem unless the ionic time step is too large . for small time steps even a simple integrator such as the verlet algorithm is sufficient , and larger time steps may be handled by using higher order integrators , such as the beeman - verlet method.@xcite the last source of error is the most significant because hellmann - feynman forces are only accurate to first order in the error of the wavefunctions .",
    "a high degree of self - consistency is thus necessary to obtain good energy conservation .",
    "a 64-atom silicon supercell was selected to test energy conservation on a typical system .",
    "the ions were given random initial displacements from the perfect crystal configuration , and several velocity rescaling steps were performed in order to attain an average ionic temperature of 1100 k. a constant - energy molecular - dynamics simulation over 1 ps was then carried out , using 80 a.u .",
    "time steps and third - order beeman - verlet@xcite integration of the ionic equations of motion .",
    "the potential , kinetic , and total energy of the system vs. simulation time are plotted in fig.[simd ] .",
    "we observed good energy conservation : the maximum variation in the total energy was 1.75 mev , which corresponds to 27 @xmath0ev per atom .",
    "the performance of a given algorithm when solving complicated problems depends not only on the theoretical efficiency , which may be quite high , but also on how adaptable the algorithm is to modern computer architectures .",
    "one example are certain classical molecular dynamics algorithms , which perform only slightly better on vector supercomputers than on low cost engineering workstations , even though the supercomputer s theoretical peak performance may be an order of magnitude larger .",
    "a particular strength of the car - parrinello method has been its efficient implementation on vector supercomputers , such as the cray - ymp .",
    "however , vector performance , while improving steadily , is unlikely to increase by several orders of magnitude per decade as has occurred in the past . at the same time , the development of powerful , low cost microprocessors and memory , has led to massively parallel architectures consisting of a large number of microprocessors , linked by a high speed communication network .",
    "although efficient implementations of plane - wave - based methods on massively parallel architectures exist , the fft - based algorithms do not scale well with the number of processors because the fft is a global operation .",
    "below , we will describe a massively parallel implementation of the multigrid method .",
    "although some of the code - optimization issues are architecture - specific , most are generic and thus applicable to any massively parallel computation .",
    "the target machine is the cray - t3d , which uses up to 2048 dec - alpha microprocessors , each with a peak performance of 150 mflops .",
    "each processor has 8 kb direct - mapped data and instruction caches and 8 mw of local memory .",
    "the processors are linked together in a three - dimensional torus arrangement for data communication .",
    "three issues have to be addressed in order to write an efficient code for this type of machine : minimizing communication costs between processors , balancing the work - load on each processor , and code optimization on the individual processors .",
    "the majority of the data storage in the multigrid method consists of the wavefunction values on the real - space grid .",
    "we will consider the case where the points are distributed on a uniform three - dimensional rectangular grid . if @xmath114 is the total number of wavefunctions , then @xmath115 total storage is required .",
    "the simplest possible decomposition of data is to store complete wavefunctions on each processing element ( pe ) , where each pe stores @xmath116 orbitals . while conceptually simple , this approach will perform poorly for large systems with many wavefunctions , because orthogonalizing wavefunctions residing on different pe s requires sending large amounts of data between processors .",
    "an alternative approach , and the one adopted by us , is to use real - space data decomposition . in this method ,",
    "each pe is mapped to a specific region of space .",
    "the electron charge density , hartree potential , and each wavefunction are distributed by regions over the processors . with this approach interprocessor communication",
    "is restricted to two areas : the computation of integrals on the real space grid ( see eq.([integration ] ) ) , and the application of the finite - differencing operators .    for integration ,",
    "the ideal optimization strategy is to organize the calculation so that as many integrals as possible are computed at once .",
    "this can be understood by considering the time required for interprocessor communication , which consists of a latency period and a transfer phase .",
    "the latency period is significant and is the same whether 1 or 1000 words of data is transferred .",
    "our integration procedure is as follows : first , calculate the intra - processor contributions to the integral ( i.e. , integrate over the subdomains ) ; second , store as many of these local integrals as possible ; finally , transfer them between processors in blocks and complete the integration by summing the local integrals .",
    "it was straightforward to implement the above procedure in most cases , but the orthogonalization step required significant modifications . in a standard implementation of the gram - schmidt orthogonalization algorithm , wavefunction overlaps and updates are computed sequentially , and the integrals can not be computed in parallel . to reduce the number of data transfers , the following implementation of gram - schmidt orthogonalization was adopted .",
    "first , the overlap matrix @xmath117 is computed as above : the local parts of the overlap integrals are computed and stored on each processor ; the integration is then completed by transferring them in blocks to the other processors .",
    "second , the cholesky factorization@xcite of the overlap matrix is computed : @xmath118 .",
    "the cholesky factor , @xmath119 , is relevant because its components are the overlaps between the new orthogonal wavefunctions and the original ones.@xcite finally , the diagonal components of the cholesky factor are used to normalize the wavefunctions , and the off - diagonal ones are used to complete the orthogonalization : @xmath120 for simplicity , the cholesky factorization of @xmath121 is currently performed on each processor .",
    "the computational time to factorize scales as @xmath122 , but has not yet become a bottleneck . however , for very large systems ( greater than 800 orbitals ) , a parallelized cholesky factorization will save significant computer time and memory .",
    "the second area where interprocessor communication is required is the finite differencing of the wavefunctions and hartree potential , since finite differencing is nonlocal .",
    "however , in the _ mehrstellen _ discretization , the nonlocality is restricted to points within one grid unit in each cartesian direction .",
    "interprocessor communication is thus always limited to nearest neighbor pe s regardless of the size of the system .",
    "this low communication cost is a particular advantage of a _ mehrstellen _ type approach as opposed to a central finite - difference approach , which requires a higher degree of nonlocality to achieve the same level of accuracy .",
    "load balancing and the efficient use of all pe s is a major concern for any parallel algorithm . with the method described above",
    ", the load balancing is essentially perfect for all parts of the calculation except for the application of the nonlocal pseudopotentials .",
    "these are applied to the wavefunctions in localized volumes around each ion .",
    "if the distribution of ions in space is nonuniform , then some of the pe s will be idle for a fraction of each scf step .",
    "however , actual calculations on many systems have shown that the application of the nonlocal potentials typically requires less than 10% of the total computational time on any pe , so that processor utilization will always exceed 90% .",
    "the efficiency of the massively parallel implementation described here is illustrated in fig .",
    "[ speedup ] , which shows the speedup in execution time per step for a given problem as the number of pe s is increased .",
    "the graph indicates a superlinear relationship , which is an artifact due to single processor cache effects .",
    "there are two competing factors here .",
    "the first is the increased communication cost as the number of processors increases , which tends to reduce the speedup .",
    "the second is the reduction in the amount of data stored on each processor and a consequent increase in the number of cache hits . as was discussed earlier ,",
    "the communication costs are relatively small with the data model being used ; since the cache is relatively small , cache hit effects outweigh these . an apparent superlinear speedup is observed .",
    "we have described the development of a multigrid - based method that uses a real - space grid as a basis .",
    "the multigrid techniques provide preconditioning and convergence acceleration at all length scales , and therefore lead to particularly efficient algorithms .",
    "a specific implementation of multigrid methodology in the context of density functional theory was described and illustrated with several applications .",
    "the salient points of our implementation include : ( i ) the development of new compact discretization schemes in real space for systems with cubic , orthorhombic , and hexagonal symmetry , and ( ii ) the development of new multilevel algorithms for the iterative solution of kohn - sham and poisson equations .",
    "the accuracy of the discretizations was tested by direct comparison with plane - wave calculations when possible and were found to be in excellent agreement in all cases .",
    "these algorithms are very suitable for use on massively parallel computers and in @xmath4 methods .",
    "we described an implementation on the cray - t3d massively parallel computer that led to a linear speedup in the calculations with the number of processors .",
    "the above methodology was tested on a large number of systems .",
    "a prior communication described tests on c@xmath123 molecule , and diamond and gan supercells .",
    "the present article examined convergence properties in detail for a supercell of disordered si and the n impurity in diamond .",
    "the multigrid techniques increased the convergence rates by factors of 2 and 4 , respectively , when compared to the steepest descents algorithm .",
    "an extension to non - uniform grids that uses a separable coordinate transform to change grid resolution locally , e.g. , at the surface or near an impurity , was developed and tested on the o interstitial in si .",
    "this extension results in only minor changes in methodology and coding , while the reduction in basis set size and thus in computational effort can be significant .",
    "a complex version of multigrid code , capable of an arbitrary sampling of the brillouin zone , was also was developed and tested on bulk al .",
    "large time - step molecular dynamics simulations require very accurate forces , which can potentially lead to difficulties in real space methods as the atoms move relative to the grid points .",
    "we have described a set of techniques based on fourier filtering of pseudopotentials that eliminate these difficulties for grid spacings of sizes similar to those used in plane - wave calculations . a 1 ps test simulation of bulk si at 1100 k conserved the total energy to within 27 @xmath0ev per atom , and illustrated the high quality of these forces .",
    "further applications of this methodology are in progress , including a simulation of surface melting of si,@xcite structural properties of large biomolecules that contain over 400 atoms,@xcite and electronic and structural properties of in@xmath124ga@xmath125n quantum wells.@xcite the multigrid methodology is also very suitable for @xmath4 implementations , and tests results for a 216-atom cell of bulk si were described recently.@xcite",
    "the authors wish to thank c.  j.  brabec for designing some of the parallel multigrid routines ; m.  buongiorno nardelli for his help with the complex - wavefunction and brillioun zone sampling routines ; and m.  g.  wensell for supplying his molecular dynamics routines .",
    "this work was supported by onr grant number n00014 - 91-j-1516 , nsf grant number dmr-9408437 , and onr grant number n00014 - 96 - 1 - 0161 .",
    "the calculations were performed at the pittsburgh supercomputer center and the north carolina supercomputing center .",
    "the _ mehrstellen _ discretization differs from central finite - differencing in two important respects : first , higher accuracy in the discretization is achieved by using more local information , but this accuracy is fully realized only at convergence ; and second , the discretized kohn - sham eigenvalue equation eq .",
    "( [ compact - implicit ] ) is non - hermitian because the operator @xmath24 does not commute with the potential operator . in this appendix",
    ", we examine the accuracy of the _ mehrstellen _ discretization , and prove that the non - hermitian nature of @xmath126 does not change the nature of the wavefunctions : they remain orthogonal . for simplicity",
    ", we analyze only the _ mehrstellen _ discretization of the orthorhombic lattice .    the fourth - order _ mehrstellen _ discretization ( see table [ mehrstellen - ortho ] ) samples the hamilton and the wavefunction at 19 points @xmath127 =    & & a f({\\bf x } ) + \\sum_{n=1}^3 b_n f({\\bf x } \\pm h_n \\hat { \\bf x}_n )   \\nonumber\\\\    & & + \\sum_{n < m } c_{n , m } f({\\bf x } \\pm h_n \\hat { \\bf x}_n                                      \\pm h_m \\hat { \\bf x}_m ) \\\\ { \\bf b}_{mehr}[f({\\bf x } ) ] = & &      a ' f({\\bf x } ) + \\sum_{n=1}^3 b'_n f({\\bf x } \\pm",
    "h_n \\hat { \\bf x}_n ) . \\label{appa - cubic}\\end{aligned}\\ ] ] the accuracy of the _ mehrstellen _ discretization is one order higher than the corresponding central finite - differencing one , but this accuracy is achieved only at convergence.@xcite the small @xmath79 expansions of the @xmath23 and @xmath24 demonstrate this principle : @xmath128 note that by construction , @xmath129 to @xmath130 .",
    "thus , the _ mehrstellen _ discretization of the kohn - sham equations is equivalent to @xmath131 - { \\bf b}_{mehr } [ \\epsilon_n \\psi_n ] = \\nonumber\\\\ & & { \\bf b}_{mehr}[{\\bf h}_{ks}\\psi_n -\\epsilon_n\\psi_n ] + o(h^4 ) .",
    "\\label{appa-2}\\end{aligned}\\ ] ] the @xmath132 terms , implicit in the right - hand side , vanish at convergence , when @xmath133 .",
    "a similar analysis applies to the discretization of the poisson equation : @xmath134 - { \\bf b}_{mehr}[4\\pi\\rho ] = \\nonumber\\\\ & & { \\bf b}_{mehr}[-\\nabla^2 v_h - 4\\pi \\rho ] + o(h^4 ) .",
    "\\label{appa-3}\\end{aligned}\\ ] ]    unlike a plane - wave or central finite - differencing representation of the kohn - sham equations , the _ mehrstellen _ discretization eq.([compact - implicit ] ) leads to a _",
    "non_-hermitian , _ generalized _ eigenvalue equation .",
    "nonetheless , we prove that the right eigenvectors of the discretized operator , _ i.e. _ the electronic orbitals , are orthogonal because they are also eigenvectors of a _ hermitian _ hamiltonian .",
    "the generalized eigenvalue equation can be recast into a more familiar form by multiplication by @xmath135 ( the invertibility of @xmath24 is discussed below ) : @xmath136 where @xmath137 is a non - compact discretization of @xmath62 of the same order as @xmath23 .",
    "the solutions of this equation , the @xmath138 and @xmath139 , are the solutions of the original equation . because @xmath140 and @xmath24 are finite - differencing operators with constant coefficients , they are translationally invariant and thus commute .",
    "they are also hermitian .",
    "thus , @xmath141 is hermitian , and the wavefunctions of eq.([compact - implicit ] ) are orthogonal .",
    "( [ compact - implicit ] ) is the preferred discretization for computation , and the equivalent eq .",
    "( [ newmehr ] ) is of formal interest only because the operators @xmath135 and hence @xmath137 are long - ranged and therefore computationally expensive to apply .",
    "finally , we consider the invertibility of the @xmath24 operator .",
    "we show that under reasonable conditions @xmath24 has no _ zero _ eigenvalues ( in fact , it is a positive definite operator ) by arguing that its null space is empty .",
    "it is straightforward to show that the null space of @xmath24 is comprised only of plane waves of maximum kinetic energy ; namely , @xmath142 ( or @xmath143 , etc . )",
    "; see eq .",
    "( [ bofg ] ) below .",
    "thus , the null space of @xmath144 is empty whenever these plane waves can not be represented on the real - space mesh .",
    "this condition can be realized in two ways : choice of grid size , or explicit projection . for periodic boundary conditions , when one or more of the linear dimensions @xmath145 , @xmath146 , or @xmath48 is odd , the maximum g - vector along that dimension is @xmath147 .",
    "second , if the grid discretization can not be chosen to meet the formal invertibility condition , the pseudo inverse@xcite of @xmath24 exists and can be used ; that is , the few vectors in the null space of @xmath24 are projected out from the wavefunctions . on physical grounds",
    "any orbital of such rapid variation should be excluded from the calculation because it is marginally representable on the mesh .",
    "the pseudo inverse of @xmath24 is @xmath148 where the discrete fourier transform of @xmath24 is @xmath149",
    "the pseudopotentials are short - ranged : the coulomb tail of the local potential is explicitly canceled and added to the madelung summation of the electrostatic energy , and by construction the nonlocal projectors have no coulomb tail . the nonlocal projectors and short - ranged local pseudopotentials are fourier filtered only once , when the appropriate potentials and grid spacing are selected .",
    "the filtering procedure attenuates the high - frequency components while maintaining the localization of the projectors and potentials .",
    "the unfiltered potentials or projectors are defined on a real - space radial grid , and are transformed to momentum space in order to filter the high - frequency components : @xmath150 where the cut - off function @xmath151 smoothly attenuates the radial fourier transform beyond @xmath152 .",
    "the cut - off wave vector is determined by the grid spacing : @xmath153 .",
    "the cut - off function is unity for @xmath154 and equals @xmath155 for @xmath152 .",
    "the parameters @xmath100 and @xmath156 depend on the atomic species and are carefully adjusted to achieve the best results .",
    "after the momentum - space filtering , the back - transformed potentials and projectors will extend beyond the original core radius .",
    "for computational efficiency , it is important that the nonlocal pseudopotentials be short - ranged .",
    "accordingly , a second filtering in real space is applied to reduce the large - radius oscillations beyond an empirically - determined radius @xmath157 .",
    "the second filtering function is unity below the cut - off radius and equals @xmath158 above it .",
    "example values for a carbon generalized norm - conserving pseudopotential with @xmath159 and @xmath113 nonlocalities are @xmath160 and @xmath161 , @xmath162 bohr , and @xmath163 .    since the filtering procedure modifies the pseudopotentials , it is necessary to determine whether the modified potentials affect the system s physical properties .",
    "because the degree of filtering is set by the real - space grid spacing @xmath12 , the effect is similar to performing an under - converged plane - wave calculation .",
    "the last effects are well understood and can be measured quantitatively by progressively increasing the plane - wave cut - off . in particular , the main results of plane - wave calculations remain valid , even if they are significantly underconverged .",
    "this is due to the uniform convergence properties of plane waves , which form a translationally invariant basis set .",
    "similarly , the convergence effects may be monitored for a real - space calculation by decreasing the grid spacing . in our tests we found that the total energy of the system converges to an asymptotic value in a manner similar to that observed with plane waves .",
    "the hexagonal grid structure described in eq .",
    "( [ hexgrid ] ) is a simple hexagonal lattice .",
    "because the @xmath57 axis is orthogonal to the @xmath164 plane , the @xmath62 operator may be written in separable form @xmath165 along the @xmath57 direction a sixth - order central finite - difference operator was selected @xmath166 where @xmath167 and the @xmath168 are given in table [ hexoperatorcoefficients ] . for the @xmath164 plane",
    "the the lattice translational vectors are not orthogonal , and a central finite - difference expression is not applicable . instead a composite form was selected @xmath169 + o(h_{xy}^6),\\end{aligned}\\ ] ] where @xmath170 and the @xmath171 are given in table [ hexoperatorcoefficients ] .    in the multigrid solution process",
    "these sixth - order operators are only used on the finest grid level to compute the kinetic energy and the residual on coarser grid levels , a second - order operator is used to represent @xmath62 ; viz . , @xmath172 and @xmath173 + o(h_{xy}^2),\\end{aligned}\\ ] ] where the discretization weights are listed in table [ hexoperatorcoefficients ] .",
    "the multigrid restriction operator uses a volume weighting scheme with the weights adjusted for the hexagonal grid , and similarly , the hexagonal generalization of tri - linear interpolation is used to transfer the coarse - grid correction to the fine grid .",
    "the wavefunctions and hartree potential are generated using multigrid iterations in exactly the same manner as was described in section iii except for the modifications described here .",
    "see , for example , i.  stich , m.  c.  payne , r.  d.  king - smith , and j .- s .",
    "lin , , 1351 ( 1992 ) ; k.  d.  brommer , m.  needels , b.  e.  larson , and j.  d.  joannopoulos , _ ibid .",
    "_ * 68 * , 1355 ( 1992 ) ; p.  bogusawski , q .- m .",
    "zhang , z.  zhang , and j.  bernholc , _ ibid . _ * 72 * , 3694 ( 1994 ) .",
    "r.  car and m.  parrinello , , 2471 ( 1985 ) .",
    "m.  p.  teter , m.  c.  payne , and d.  c.  allan , , 12255 ( 1989 ) .",
    "t.  a.  arias , m.  c.  payne , and j.  d.  joannopoulos , , 1077 ( 1992 ) ; , 1538 ( 1992 ) .",
    "d.  vanderbilt , , 7892 ( 1990 ) .",
    "a.  m.  rappe , k.  m.  rabe , e.  kaxiras , and j.  d.  joannopoulos , , 1227 ( 1990 ) .",
    "lin , a.  qteish , m.  c.  payne , v.  heine , , 4174 ( 1993 ) .",
    "g.  li and s.  rabii ( 1992 ) , unpublished .",
    "p.  e.  blchl , , 5414 ( 1990 ) .",
    "f.  gygi , europhys .",
    "* 19 * , 6617 ( 1992 ) ; f.  gygi , , 11692 ( 1993 ) .",
    "d.  r.  hamann , , 7337 ( 1995 ) ; _ ibid . _",
    "* 51 * , 9508 ( 1995 ) .",
    "w.  yang , , 1438 ( 1991 ) ; g.  galli and m.  parrinello , _ ibid .",
    "_ * 69 * , 3547 ( 1992 ) ; f.  mauri , g.  galli , and r.  car , , 9973 ( 1993 ) ; p.  ordejn , d.  a.  drabold , m.  p.  grumbach , and r.  m.  martin , _ ibid .",
    "_ * 48 * , 14646 ( 1993 ) ; j.  kim , f.  mauri , and g.  galli , , 1640 ( 1995 ) . s.  baroni and p.  giannozzi , europhys",
    ".  lett .",
    "* 17 * , 547 ( 1992 ) ; x .- p .",
    "li , r.  nunes , and d.  vanderbilt , , 10891 ( 1993 ) ; m.  daw , _ ibid .",
    "_ * 47 * , 10895 ( 1993 ) ; w.  hierse and e.  stechel , _ ibid . _ * 50 * , 17811 ( 1994 ) ; s.  goedecker and l.  colombo , , 122 ( 1994 ) ; e.  hernandez and m.  j.  gillan , , 10157 ( 1995 ) ; e.  hernandez , c.  m.  goringe , and m.  j.  gillan , _ ibid _ * 53 * , 7147 ( 1996 ) .",
    "s.  r.  white , j.  w.  wilkins , and m.  p.  teter , , 5819 ( 1989 ) .",
    "j.  bernholc , j .- y .",
    "yi , and d.  j.  sullivan , faraday disc .",
    "soc .  * 92 * , 217 ( 1991 ) . j.  r.  chelikowsky , n.  troullier , and y.  saad , , 1240 ( 1994 ) ; j.  r.  chelikowsky , n.  troullier , k.  wu , and y.  saad , , 11355 ( 1994 ) ; x.  jing , n.  troullier , d.  dean , n.  binggeli , j.  r.  chelikowsky , k.  wu , and y.  saad , _ ibid .",
    "_ * 50 * , 12234 ( 1994 ) ; j.  r.  chelikowsky , x.  jing , k.  wu , and y.  saad , preprint ( 1995 ) .",
    "e.  l.  briggs , d.  j.  sullivan , and j.  bernholc , , r5471 ( 1995 ) . k.  a.  iyer , m.  p.  merrick , and t.  l.  beck , j.  chem .  phys .",
    "* 103 * , 227 ( 1995 ) ; t.  l.  beck , k.  a.  iyer , and m.  p.  merrick , proc .",
    "sixth international conference on density functional theory , paris ( 1995 ) .",
    "e.  j.  bylaska , s.  r.  kohn , s.  b.  baden , a.  edelman , r.  kawai , m.  elizabeth , g.  ong , and j.  h.  weare , presented at the sixth siam conference on parallel processing for scientific computing , san francisco ( 1995 ) . f.  gygi and g.  galli , , r2229 ( 1995 ) .",
    "g.  zumbach , n.  a.  modine , and e.  kaxiras , preprint ( 1995 ) .",
    "k.  cho , t.  a.  arias , j.  d.  joannopoulos , and p.  k.  lam , , 1808 ( 1993 ) .",
    "s.  wei and m.  y.  chou , preprint ( 1995 ) .",
    "a.  brandt , math .",
    "comp .  * 31 * , 333 ( 1977 ) ; gmd studien , * 85 * , 1 ( 1984 ) .",
    "a.  p.  seitssonen , m.  j.  puska , and r.  m.  nieminen , , 14057 ( 1995 ) .",
    "d.  r.  hamann , , 2980 ( 1989 ) .",
    "g.  b.  bachelet , d.  r.  hamann , and m.  schluter , , 4199 ( 1982 ) .",
    "d.  r.  hamann , m.  schluter , and c.  chang , , 1494 ( 1979 ) .",
    "l.  kleinman and d.  m.  bylander , , 1425 ( 1982 ) .",
    "r.  d.  king - smith , m.  c.  payne , and j .- s .",
    "lin , , 13063 ( 1991 ) .",
    "l.  collatz , _ the numerical treatment of differential equations _ , 3rd ed .",
    "( springer - verlag , berlin , 1960 ) , p.  164 .",
    "a.  baldereschi , , 5212 ( 1972 ) .",
    "m.  buongiorno nardelli , private communication ( 1996 ) .",
    "p.  k.  lam , m.  l.  cohen , , 4224 ( 1981 ) .    n.  w.  ashcroft and n.  d.  mermin , _ solid state physics _ , ( holt , rinehart and winston , philadelphia , 1976 ) , p.  77 .",
    "m.  needels , j.  d.  joannopoulos , y.  bar - yam , and s.  t.  pantelides , , 4208 ( 1991 ) .",
    "pulay , mol .",
    "* 17 * , 197 ( 1969 ) .",
    "w.  l.  briggs , _ a multigrid tutorial _ , ( siam books , philadelphia , 1987 ) .",
    "for a recent review , see m.  c.  payne , d.  c.  allan , m.  p.  teter , t.  a.  arias , and j.  d.  joannopoulos , , 1045 ( 1992 ) . w.  h.  press , s.  a.  teukolsky , w.  t.  vetterling , and b.  p.  flannery , _ numerical recipes in fortran _",
    "( cambridge university press , cambridge , 1992 ) , sec .  19.5 .",
    "g.  m.  philips and p.  j.  taylor , _ theory and applications of numerical analysis _ , ( academic press , london and new york , 1980 ) , p.  256 .",
    "w.  h.  press , s.  a.  teukolsky , w.  t.  vetterling , and b.  p.  flannery , _ loc .",
    "w.  hackbusch , _ multi - grid methods and applications _ , ( springer - verlag , berlin , 1985 ) .",
    "a.  brandt , s.  f.  mccormick , and j.  w.  ruge , siam j.  sci .",
    "comput .  * 4 * , 244 ( 1983 ) .",
    "h.  hellmann , _ einfhrung in die quantumchemie _ , ( deuticke , leipzig , 1937 ) .",
    "r.  p.  feynman , phys .",
    "rev .  * 56 * , 340 ( 1939 ) .",
    "d.  beeman , j.  comp .",
    "20 * , 130 ( 1976 ) .",
    "g.  h.  golub and c.  f.  van loan , _ matrix computations _",
    "( the johns hopkins university press , baltimore , 1989 ) , p.  141 .",
    "d.  j.  sullivan , unpublished ( 1995 ) .",
    "m.  g.  wensell , e.  l.  briggs , c.  roland , and j.  bernholc , bull .",
    "* 41 * , no .  1 , 258 ( 1996 ) .",
    "c.  j.  brabec , e.  l.  briggs , d.  j.  sullivan , and j.  bernholc , bull .",
    "soc .  * 41 * , no .  1 , 443 ( 1996 ) . m.  buongiorno nardelli , k.  rapcewicz , e.  l.  briggs , and j.  bernholc , `` bulk and interfacial properties of nitride semiconductors '' , poster presented at the 1996 march meeting of the american physical society , st .",
    "louis ( 1996 ) .",
    "d.  j.  sullivan , e.  l.  briggs , c.  j.  brabec , and j.  bernholc , bull .",
    "soc .  * 41 * , no .  1 , 443 ( 1996 ) . g.  h.  golub and c.  f.  van loan , _ loc .",
    "_ , p.  243 .",
    ".discretization weights for the fourth - order orthorhombic mehrstellen operators for the central , nearest - neighbor , and next nearest - neighbor grid points .",
    "( a12 ) and ( a2 ) for the definitions of @xmath174 , @xmath175 , and @xmath176 .",
    "the cubic - grid operator corresponds to @xmath177 . [ cols=\"<,^,^,^ \" , ]"
  ],
  "abstract_text": [
    "<S> we describe a set of techniques for performing large scale _ ab initio _ calculations using multigrid accelerations and a real - space grid as a basis . </S>",
    "<S> the multigrid methods provide effective convergence acceleration and preconditioning on all length scales , thereby permitting efficient calculations for ill - conditioned systems with long length scales or high energy cut - offs . </S>",
    "<S> we discuss specific implementations of multigrid and real - space algorithms for electronic structure calculations , including an efficient multigrid - accelerated solver for kohn - sham equations , compact yet accurate discretization schemes for the kohn - sham and poisson equations , optimized pseudopotentials for real - space calculations , efficacious computation of ionic forces , and a complex - wavefunction implementation for arbitrary sampling of the brillioun zone . </S>",
    "<S> a particular strength of a real - space multigrid approach is its ready adaptability to massively parallel computer architectures , and we present an implementation for the cray - t3d with essentially linear scaling of the execution time with the number of processors . </S>",
    "<S> the method has been applied to a variety of periodic and non - periodic systems , including disordered si , a n impurity in diamond , aln in the wurtzite structure , and bulk al . the high accuracy of the atomic forces allows for large step molecular dynamics ; e.g. , in a 1 ps simulation of si at 1100 k with an ionic step of 80 a.u . </S>",
    "<S> , the total energy was conserved within 27 @xmath0ev per atom . </S>"
  ]
}