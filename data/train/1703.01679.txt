{
  "article_text": [
    "the dark energy camera ( * ? ? ? * decam ) is one member of a new generation of high - throughput imagers combining large field of view ( 3 deg@xmath0 for decam ) with large telescope aperture ( the 4-meter blanco telescope ) . in the post - gaia era @xcite ,",
    "when positions , proper motions , and parallaxes are expected to be available with @xmath9  milliarcsecond ( mas ) accuracy for the @xmath10 stars with magnitude @xmath11 , what need do we have for accurate astrometry from these large ground - based cameras ?",
    "there remain strong scientific motivations to obtain the most accurate possible positions for sources fainter than gaia s limit , for transient sources , and for solar - system bodies .",
    "ideally these general - purpose , large - format imagers would be capable of obtaining astrometric measurements limited by the unavoidable shot noise and atmospheric fluctuations .",
    "motivation and practice of astrometry from large - format ground - based ccd cameras have been discussed by @xcite , @xcite , @xcite , and @xcite , among others .",
    "accurate astrometry underlies many of the science goals of the _ large synoptic survey telescope ( lsst ) _ now under construction @xcite .",
    "in addition , one of the motivators for construction of decam is measurement of weak gravitational lensing distortions of galaxies .",
    "success in this pursuit requires the ability to register multiple exposures of every galaxy to an accuracy of @xmath12  mas or better  otherwise the blur induced by misregistration in combining images could be mistaken for a coherent weak - lensing distortion .",
    "searches for transient sources also benefit from precise image registration to improve subtraction of static sources .",
    "one thing we do _ not _ need our wide - field imagers to do is determine absolute positions , since the preliminary gaia catalogs are sufficiently dense to yield thousands of stars in the spatial and dynamic - range overlap between gaia and most decam exposures .",
    "these suffice to determine the absolute pointing and any low - order astrometric distortion terms across the decam field of view . in this work",
    "we therefore focus on establishing _ relative _ astrometry with decam on scales @xmath13 .",
    "indeed one might ask why to bother at all with the effort making an astrometric model for decam instead of simply interpolating all positional errors from gaia stars .",
    "first , many of the detector - level effects occur on angular scales too small for gaia stars to sample .",
    "second , if our model removes discontinuities in the astrometric errors between ccds , we can interpolate using reference stars from the whole field rather than being confined to those on a single device .",
    "furthermore the gaia proper motion catalog is not yet available , so the reference catalog is not yet at mas accuracy .",
    "lastly many decam exposures may have dynamic range which does not overlap well with the gaia catalog .    in section  [ methods ]",
    "we describe our method of deriving the decam astrometric map and its error properties by forcing internal agreement amongst stellar positions in a series of offset exposures of rich star fields . in sections  [ data ] , [ model ] , and [ residsec ]",
    "we describe the data used to characterize decam astrometry , the model applied to it , and the _ static _",
    "residuals to this model ,  those which repeat from exposure to exposure .",
    "section  [ atmosphere ] characterizes the _ stochastic _ residuals ,  those uncorrelated between consecutive exposures and presumably due to atmospheric fluctuations .",
    "section  [ stability ] characterizes the changes in the astrometric model from night to night and over the first 4 years of decam observations .",
    "section  [ interpolation ] investigates how much of the stochastic distortion can be removed by interpolation from a set of reference stars of a given density .",
    "our goal will be to model any astrometric distortion that contributes more than @xmath14  mas rms error that is correlated between stars separated by @xmath15 . to put this scale in context ,",
    "note that the mean scale of a 15  @xmath16 m decam pixel is 264  mas , so 1  mas corresponds to 0.004 pixel @xmath17  nm , or about 100 atoms in the silicon lattice .",
    "the decam science array consists of 62 deep - depletion ccds , each @xmath18 pixels , and the array spans a roughly hexagonal area of diameter 2 . thus 1  mas is 1.4 parts in @xmath19 of the decam field of view .",
    "scale changes due to stellar aberration , air pressure variations , and atmospheric refraction are far larger than this , so we will clearly need to allow each exposure an independent overall linear transformation across the fov to approach mas accuracy .",
    "indeed the _ nonlinear _ portion of atmospheric refraction is expected to have peak - to - peak amplitude of @xmath20 across the decam fov ( where @xmath21 is the zenith angle ) , so we must allow at least quadratic freedom to our solution atop any static instrumental model .",
    "rms positional errors reported in this paper refer to the sum of e - w and n - s components , unless noted otherwise .",
    "the astrometric solution for decam is a parametric model for the celestial ( world ) coordinates @xmath22 of an object given its observed pixel coordinates @xmath23 and some set of observing circumstances @xmath24 , which might include the object s color @xmath25 , plus discrete variables such as the date , exposure , filter , and individual ccd on which the measurement was obtained .",
    "the solution is found by straightforward @xmath26-minimization over the values of the model parameters @xmath27 the index @xmath28 ranges over all position measurements used to constrain the solution , and we assume a measurement error @xmath29 that is the same for both positional components of @xmath30 .",
    "we index the distinct objects on the sky by @xmath31 , let @xmath32 be the object targeted by measurement @xmath28 , and denote by @xmath33 the subset of measurements with @xmath34 .",
    "we define @xmath35 in ( [ weights ] ) we introduce @xmath36 to prevent very high weights from being assigned to high-@xmath2 measurements .",
    "we may consider @xmath36 to represent the expected stochastic position errors beyond those arising from image noise that are included in @xmath37 in practice we find that stochastic atmospheric distortions dominate the astrometric residuals , so we set @xmath36 near the typical rms atmospheric distortion in our data ( @xmath38  mas , _ cf . _",
    "sec [ atmosphere ] ) .",
    "this fairly arbitrary choice appropriately equalizes the weights assigned to individual measurements , but it does mean that our final @xmath26 values should not be expected to follow a @xmath26 distribution  it serves only as the quantity used to optimize .",
    "note that measurements from decam can be freely mixed with other instruments position measurements in .",
    "_ internal _ constraints  that multiple decam observations of a source yield the same world coordinates  are combined with _ external _ constraints that decam match a source of _ a priori _ assigned world coordinates of these objects . we denote as a * reference catalog * any set of measured positions that are independent of ,  the function @xmath39 is simply the identity , and the reference catalog directly specifies @xmath40 and errors @xmath41    our strategy for decam calibration is to produce very strong internal constraints by taking a series of @xmath42 consecutive exposures of fields at modest galactic latitudes , where stellar sources are abundant but not crowded .",
    "the pointings of these exposures are shifted by anywhere from 10to the fov diameter , so that a given star is imaged at many places on the array . in this scheme",
    "the reference catalog serves mainly to break degeneracies in overall position and linear scaling of the astrometric map ( see section  [ degeneracies ] ) .",
    "these sequences of exposures are called * star flats * ( since they are also used to calibrate photometric response ) . since decam was installed in 2012 , star flat sequences in all filters",
    "have been executed several times per year , usually during bright time .",
    "these data , described in table  [ starflats ] , are the ones used in this paper to derive the decam astrometric model .    in the remainder of this section",
    "we will detail the algorithmic and coding choices made in defining the maps @xmath39 and in the minimization of @xmath43 these choices are realized in ` c++ ` code with an executable program called wcsfit .",
    "a reader uninterested in the implementation details can skip to section  [ model ] .",
    "we adopt the following terminology :    * a * pixel map * is a function @xmath39 giving the transformation from detector coordinates to world coordinates .",
    "these maps are realized by compounding several functions , each of which may also be referred to as a pixel map . *",
    "a * detection * is a single measurement of a stellar position , which as noted is described by pixel coordinates @xmath30 and an associated uncertainty @xmath37 * a * device * is a region of the focal plane over which we expect to have a continuous pixel map ,  one of the ccds in the decam focal plane .",
    "every detection belongs to exactly one device . *",
    "an * exposure * comprises all the detections obtained simultaneously during one opening of the shutter .",
    "the exposure number is essentially our discrete time variable . *",
    "an * extension * comprises the detections made on a single device in a single exposure .",
    "wcsfit  allows each extension to be assigned its own pixel map , which will be a continuous function .",
    "every detection belongs to exactly one extension . * a * catalog * is the collection of all detections from a single exposure ,  the union of the extensions from all the devices in use for that exposure . *",
    "a * band * labels the filter used in the observation .",
    "every exposure has exactly one band . *",
    "an * epoch * labels a range of dates over which the physical configuration of the instrument , aside from filter choice and the pointing of the telescope , is considered ( astrometrically ) invariant .",
    "every exposure belongs to exactly one epoch .",
    "* an * instrument * is a given configuration of the camera for which we expect the instrumental optics to yield an invariant astrometric solution . in our analyses",
    "an instrument is specified by a combination of band and epoch .",
    "every exposure is associated with exactly one instrument .",
    "this is the same definition as used in scamp   @xcite , the public code commonly used for astrometric solutions . *",
    "a * field * is a region of the sky holding the detections from a collection of exposures .",
    "every exposure is associated with exactly one field .",
    "each field @xmath44 has a central right ascension and declination @xmath45 .",
    "the world coordinates @xmath46 are defined to be in the gnomonic projection of the sky about the field center . *",
    "a * match * , sometimes called an * object * , comprises all the detections that correspond to a common celestial source and are therefore expected to have common true @xmath47 in this astrometric study we will make use only of stellar sources , so a match is simply a star .",
    "we only allow matches to be constructed between detections in a common field . *",
    "a * reference catalog * is an extension for which there are no free parameters in the map to world coordinates , for example the list of gaia stars for a given field .",
    "the distinction between devices , instruments , etc .",
    "is irrelevant for these , and we can consider all sources of reference information as belonging to a common catalog .    as detailed in section  [ maps ] , wcsfit  allows the pixel map for extension @xmath48 to be composed of a sequence of `` atomic '' transformations . following scamp",
    "we will divide the overall pixel map applied to a given extension into an _ instrumental _ map followed by an _ exposure _ map .",
    "the former goes from pixel coordinates of each device to an intermediate system of a gnomonic projection about the telescope optic axis , and is taken to be constant within an epoch .",
    "the exposure map is continuous across the field of view and takes independent parameters for each exposure .",
    "we must specify a functional form ( and free parameters ) for a map @xmath49 from pixels to world coordinates for each extension @xmath48 . here",
    "@xmath25 is the object color , and the other elements of the observational circumstances @xmath24 are specified by the extension index .",
    "wcsfit  allows each map @xmath50 to be specified as the composition of a series of @xmath51 `` atomic '' coordinate transformations @xmath52 : @xmath53 we will generically refer to the input of each transformation @xmath52 as its `` pixel '' coordinates and the output as its `` world '' coordinates , even though the intermediate variables are in fact neither . in our application ,",
    "the chain of component maps is divided into those of the instrument solution followed by those of the exposure solution .",
    "wcsfit  follows the definitions in section  [ terminology ] by making each coordinate transformation or element thereof an instance of an abstract ` c++ ` base class ` pixelmap ` .",
    "each has a ` type ` , a unique ` name ` string , and has a number @xmath54 of free parameters controlling its actions . `",
    "pixelmap ` instances can be ( de-)serialized ( from ) to ascii files in yaml format , easily read or written by humans .",
    "the wcsfit  user specifies the transformations to be fit to the data by giving the program such a yaml file as input  the parameters are assigned default starting values if none are specified .",
    "anywhere that the strings ` band , instrument , epoch , ` or ` device ` appear in these input files they are replaced with the values appropriate to the extension , allowing a generic model to be specified compactly .",
    "the wcsfit  user can also specify the names of any ` pixelmaps ` whose parameters should be held fixed at their input values .",
    "the primary output of wcsfit  is another yaml file specifying all of the maps and their best - fit parameters .",
    "the types of ` pixelmaps ` available for use are :    * the ` identity ` map , which leaves @xmath55 unchanged , and has no free parameters .",
    "* ` constant ` maps have @xmath56 with the two components of @xmath57 as parameters . * ` linear ` maps have @xmath58 with six parameters in @xmath57 and the components of the matrix @xmath59 .",
    "* ` polynomial ` maps have their free parameters as the coefficients of two polynomials of specified degrees @xmath60 and @xmath61 in the @xmath62 components that produce @xmath63 and @xmath64 , respectively . * ` template ` maps apply transformations based on lookup tables .",
    "one has the option of x , y , or radial transformations : @xmath65 the first two cases each operate in only a single cartesian direction . in the third ( radial ) case ,",
    "the center @xmath66 of the distortion is specified .",
    "there is a single free parameter , the scaling parameter @xmath67 .",
    "the template function @xmath44 is defined as linear interpolation between values @xmath68 at nodes @xmath69 for @xmath70 . * ` piecewise ` maps are functionally identical to the ` template ` map , except that the nodal values @xmath68 are the free parameters , and the scaling is fixed to @xmath71 * a ` color ` term is defined by @xmath72\\ ] ] where @xmath73 is a reference color and @xmath74 is an instance of any of the above forms of transformation .",
    "the parameters of the ` color ` map are those of the map it scales .",
    "* ` reprojection ` maps have no free parameters : they merely move coordinates from one projection of the sphere to another . * ` composite ` maps realize equations  ( [ compose1])([compose3 ] ) for a specified sequence of any of maps ( including other ` composite ` maps ) .",
    "the parameters of the composite are the concatenation of those of the component maps .",
    "a ` pixelmap ` , in combination with a specification of the projection in which the @xmath46 maps to the celestial sphere , forms a complete world coordinate system ( wcs ) .",
    "when minimizing @xmath26 we must be aware of degeneracies whereby  can change while @xmath26 is invariant .",
    "such degeneracies will lead to ( near-)zero singular values in the normal matrix  used in the solution for  ( section  [ model ] ) , and failures or inaccuracies in its inversion .",
    "there are several such landmines which we must clearly avoid .",
    "we will assume in this discussion that the astrometric model for each extension is a device - based instrumental function @xmath75 from pixel to `` telescope '' coordinates , followed with an exposure - based function @xmath76      the simplest degeneracy is a shift in all stellar positions , @xmath77 for every exposure ( in the flat - sky limit ; more generally the degeneracy is a rotation of the celestial sphere ) .",
    "each star @xmath31 has its derived sky position @xmath78 shifted as well , but since @xmath26 is differential , there is no effect on @xmath43 this degeneracy is broken by having a reference catalog for which @xmath46 is fixed .",
    "the reference catalogs does not need to be very dense or precise to break this degeneracy .",
    "a color - dependent shift @xmath79 is also undetectable in the differential @xmath26 .",
    "this degeneracy is broken if colors are known for reference stars over a finite range of color .      in the flat - sky limit",
    "consider the case where the exposure component for exposure @xmath48 is an affine transformation @xmath80 with linear rescaling @xmath81 and offset @xmath82 , the latter corresponding to the pointing of the telescope at exposure @xmath48 .",
    "an object @xmath31 with world coordinates @xmath83 will be observed at telescope coordinate @xmath84 for any non - degenerate matrix @xmath85 there is an alternative solution @xmath86 which leaves @xmath26 unchanged .",
    "this degeneracy is also broken by the existence of a sample of reference stars .",
    "there is also a color - dependent variant of this degeneracy .",
    "if the exposure solution @xmath87 has freedom to be altered by some global polynomial function @xmath88 of order @xmath89 , then there is generalization of this degeneracy in which each @xmath87 is shifted by a polynomial of order @xmath90 .",
    "again the solution is to have a reference catalog of even modest density and accuracy .",
    "wcsfit  is accelerated by calculating the weight of each observation in just once at the start of fitting , using the determinant of the starting wcs system to convert the pixel errors into world coordinate errors .",
    "this opens the door to a pseudo - degeneracy in which all output @xmath46 values are scaled by some matrix @xmath91 sending @xmath92 if @xmath93 , the solution appears to approach perfection while collapsing the output map .",
    "this is countered by an increase in @xmath26 contributed by the reference stars , which are not collapsing ; but if the total weight of the reference stars is too low , the solution will tend toward collapse .",
    "the collapse becomes complete if the reference stars are then flagged as outliers and removed by our @xmath94-clipping step .",
    "wcsfit  includes a parameter to scale the weights of the reference catalogs , which can be used to prevent this collapse solution if the reference catalog is sparse .      for any map @xmath95 , the transformations @xmath96 clearly leaves @xmath26 and all @xmath46 values invariant .",
    "if the functional forms being used for @xmath97 and @xmath98 admit such a transformation , then the solution is degenerate .",
    "the wcsfit  code searches for cases where multiple ` constant , linear , ` or ` polynomial ` atomic map elements are composited into any exposures pixel maps and are hence able to trade their terms .",
    "this degeneracy can be broken by setting one of the exposure maps @xmath87 to the ` identity ` map .",
    "wcsfit  will do this automatically if the user s configuration leaves such degeneracies in place .",
    "map parameters are of course degenerate if there are no stellar observations being affected by them_e.g .",
    "_ if a given exposure did not generate any matched detections , or they have all been removed as outliers , then the parameters of the exposure solution are unconstrained .",
    "wcsfit  checks the normal matrix  for null rows that arise when a parameter does not act on any observations . in this case",
    "the diagonal element on this row is set to unity , which stabilizes the matrix inversion and freezes this ( irrelevant ) parameter in further iterations .",
    "more troublesome is the case where there are a small but non - zero number of observations on an exposure , too few to constrain the model , so that  is degenerate but without null rows . in this case",
    "wcsfit  will fail the attempt to do a cholesky decomposition of the non - positive - definite . in this case",
    "wcsfit  will perform a singular value decomposition of , report to the user which parameters are associated with near - null singular values , then quit .",
    "the wcsfit  software suite assumes that we are already in possession of an initial wcs for each extension of sufficient accuracy to allow unambiguous matching of common detections of a source .",
    "scamp  is routinely run on each des exposure to generate this starting wcs , with accuracy of @xmath99 relative to gaia or other reference catalog .",
    "another benefit of having a good starting wcs for each exposure is that we can initialize parameters of the maps that are defaulted on input by fitting them to the starting wcs ",
    "wcsfit  generates set of pseudo - detections on a grid of @xmath62 spanning the device , and fits them to a pseudo - reference catalog holding the @xmath46 positions to which the pixel positions are mapped by the wcs .",
    "the algorithm for minimization of @xmath26 assumes that the minimizing solution is close to the starting solution ,  we are doing fine tuning after scamphas done the work of bringing us close .",
    "the positions are close to linear in the parameters , so the @xmath26 value should be close to the usual quadratic form @xmath100 note that the weights @xmath101 are being assumed independent of ,  the world - coordinate errors @xmath102 of each exposure are held fixed at the values implied by the starting wcs . also note that wcsfit  does not treat the true positions @xmath103 of the sources as free parameters .",
    "instead the dependence of the mean of the measurements @xmath104 upon the parameters is propagated directly into the normal equation .",
    "the calculation of @xmath105 and  is the most computationally intensive part of wcsfit .",
    "the summation for matches is distributed across cores using openmp calls .",
    "each match is dependent upon the limited subset of the parameters  which appear in the pixel maps for the extensions in which the object is observed , hence the updates to  are sparse , though the final matrix is dense .",
    "wcsfit  first attempts the newton iteration @xmath106 the solution time scales as the cube of the number of free parameters , and is executed using a multithreaded cholesky decomposition after preconditioning  to have unit diagonal elements . despite the cubic scaling",
    ", this step is usually faster than the calculation of the normal matrix .",
    "if the decomposition fails due to a non - positive - definite , wcsfit  performs a singular - value decomposition on  and informs the user which parameters dominate the degenerate vectors .",
    "the newton step is iterated until @xmath26 no longer decreases by more than a chosen fraction .",
    "should @xmath26 increase during an iteration , or fail to converge within a selected number of steps , then the minimization process is re - started using a levenberg - marquart algorithm based on the implementation by @xcite .",
    "the wcsfit  solutions must be robust to astrometric measurements perturbed by unrecognized cosmic rays or defects on the stellar images , and by stars with proper motion or binary partners which alter the photocenter by amounts exceeding measurement errors .",
    "we do not at this time fit for proper motion or parallax within wcsfit .",
    "outlier rejection is done using standard @xmath94-clipping algorithms . a clipping threshold @xmath107 is specified at input .",
    "after each @xmath26 minimization , a rejection threshold is set at @xmath108 .",
    "detections whose residual to the fit ( in units of @xmath94 ) exceeds the threshold are discarded . at most one outlier per match",
    "is discarded at each clipping iteration .",
    "outlier clipping is alternated with @xmath26 minimization until the clipping step no longer reduces the @xmath26 per degree of freedom by a significant amount .",
    "the steps in the astrometric solution process are as follows :    1 .",
    "a preparatory python program reads an input yaml configuration file specifying the desired input catalog files , plus the definitions of the fields , epochs , and instruments .",
    "it then collects from all the catalogs and their headers any information necessary to construct tables of extensions , devices , exposures , and instruments .",
    "this includes extracting the serialized starting wcs , usually as produced by scamp  and stored in the headers of the fits catalog extensions .",
    "a second preparatory program reads all the detections from the input catalogs , applying any desired cuts for @xmath2 and stellarity , and then runs a standard friends - of - friends algorithm to identify all matching detections .",
    "any match that includes multiple detections from the same exposure is discarded .",
    "the i d s of all groups of matching detections are then stored in another fits table .",
    "3 .   wcsfit  starts by ingesting the input fits tables and creating the structures defining instruments , devices , exposures , and extensions .",
    "the yaml file specifying the pixel maps to be applied to each extension is parsed , and a ` pixelmap ` is created with specified or defaulted parameters .",
    "any of the map elements may have its parameters frozen by the user , the remainder are the free parameters of our model .",
    "wcsfit  checks the map configuration for degeneracies : is there reference catalog in each field ? are there are any exposure / instrument degeneracies ?",
    "if so , wcsfit  will attempt to break the degeneracies by setting one or more exposures maps to ` identity ` .",
    "all exposures in a field are reprojected to a common gnomonic system about the field center .",
    "any parameters of ` pixelmaps ` that were set to defaults have their values set by a least - squares fit to the starting wcs .",
    "any degeneracies halt the program .",
    "the @xmath30 and @xmath29 of all detections that are part of useful matches are extracted from their source catalogs . for any detections whose maps include color terms ,",
    "we require a measurement from a color catalog to be matched to the same object . the color catalog is read at this point .",
    "a requested fraction of the matches are excluded from the fit at random .",
    "these reserved matches can be used later to validate the fit . 10 .",
    "any exposures containing insufficient detections are removed from the fit .",
    "the iteration between @xmath26 minimization and @xmath94-clipping begins . at each iteration ,  is checked for null rows as noted in section  [ degeneracies ] , which are altered so as to freeze the associated parameter . if  is not positive - definite , wcsfit  reports the nature of the associated degenerate parameters , then exits .",
    "the best - fit astrometric model is written to an output yaml file . 13 .",
    "after completion of the fit , the best - fit map is applied to both the fit and reserved matches .",
    "the @xmath94-clipping algorithm is applied iteratively to the reserved matches .",
    "the rms residual and @xmath26 statistics are reported for the un - clipped detections on each exposure . 15 .",
    "the input , output , and best - fit residual for every detection are written to an output fits table for further offline analyses .",
    "the run of wcsfit  producing the results in section  [ model ] was executed on a dual - cpu workstation with a total of 12 2.4  ghz cores . after reserving 30% of the matches",
    ", we fit 19  million detections in 311,000 distinct matches .",
    "there are 4948 map elements with a total of 26,645 free parameters .",
    "each calculation of  takes approximately one hour , and the linear solution takes one minute .",
    "five iterations of minimization / clipping were required for convergence .",
    "the astrometric solution is derived from multiple epochs of the star flat observations described above .",
    "table  [ epochs ] lists the dates and conditions of the star flat sequences during the first four years of decam operations for which there were neither clouds nor instrument anomalies .",
    "functional ccds at the start of exposures are usually 30  s long , with 2530  s dead time for readout and repointing , so the star flat sequence for 5 filters consumes about 2  hours of clock time .",
    "figure  [ dithers ] shows a typical star flat pointing sequence of 22 exposures .",
    "there are @xmath109 gaia reference stars available in the area covered by the star flat exposures of a given field .",
    "each exposure is run through the standard des data reduction pipeline , including linearization of images , crosstalk removal , correction for the `` brighter - fatter effect '' @xcite , debiasing , and division by dome flats , and subtraction of sky and fringe signals .",
    "sources are detected and measured using sextractor @xcite . for the following analyses we filter the catalogs for sources with no sextractor flags set , no defective , saturated , or cosmic - ray - flagged pixels within the isophote , with ` magerr_auto`@xmath110 indicating signal - to - noise ratio @xmath111 and with @xmath112 to select only stellar sources .",
    "the flag cut removes objects that overlap detected neighbors .",
    "the windowed centroids @xmath113 are used for centroid positions , @xmath62 , as they have been demonstrated to be robust to the details of the point - spread function ( psf ) while approaching the accuracy of ideal psf - fitting astrometry .",
    "our focus on astrometric errors that correlate over space and/or time means we will not investigate the vagaries of centroid measurement ,  pixel - phase errors .    the density of useful stellar positions varies with field , filter , seeing , and sky conditions , but is usually 200 - 400 per ccd , or more than 10,000 per exposure and @xmath114 per star flat epoch .",
    "lccc ` 20121120 ` & 06403400 & 209 & 1.04 + ` 20121223 ` & 07305000 & 104 & 1.06 + _ 2012 dec 30 _ & + ` 20130221 ` & 13274845 & 112 & 1.06 + _ 2013 may 12 _ & + _ 2013 july 22 _ & + ` 20130829 ` & 19005000 & 110 & 1.07 + _ 2013 oct 15 _ & + ` 20131115 ` & 06403400 & 141 & 1.09 + _ 2013 nov 30 _ & + ` 20140118 ` & 13274845 & 133 & 1.33 + _ 2014 may 12 _",
    "& + ` 20140807 ` & 13274845 & 143 & 1.32 + ` 20141105 ` & 06403400 & 128 & 1.01 + _ 2014 dec 1 _ & + ` 20150204 ` & 13274845 & 088 & 1.31 + _ 2015 may 25 _ & + _ 2015 june 25 _ & + _ 2015 july 25 _ & + _ 2015 aug 9 _ & + _ 2015 aug 25 _ & + ` 20150926 ` & 20403500 & 119 & 1.01 + _ 2015 nov 26 _ & + ` 20160209 ` & 07305000 & 125 & 1.07 + _ 2016 feb 19 _ & + ` 20160223 ` & 13274845 & 110 & 1.24 + ` 20160816 ` & 19005000 & 108 & 1.06 + [ starflats ]",
    "our goal is to produce an astrometric model that maps the @xmath62 of a source to icrs sky coordinates , such that any _ coherent _ errors are at @xmath115  mas rms .",
    "coherence applies here to both time and space , meaning that the error should persist across more than one star and more than one exposure .",
    "note that we are _ not _ attempting to model the following effects :    * shifts in the centroids of individual detector pixels due to variation in lithography of the gate structures .",
    "there is not enough on - sky stellar data to calibrate this for the 500 megapixels in decam .",
    "but astrometric errors due to pixel - to - pixel variations will behave as noise in individual stars positions , and will not correlate between stars .",
    "in well - designed use of decam , a given star will be exposed on different parts of the array in each exposure , and hence this error will not correlate across time either . in any case , the rms variation in decam pixel sizes is estimated ( from flat - field behavior ) to be at a few parts per thousand , or @xmath9  mas .",
    "stellar position errors will be even lower since they average over a psf containing @xmath116 pixels . * stochastic atmospheric distortions on @xmath117 scale .",
    "such distortions are not coherent between exposures , but they are @xmath118  mas and dominate the astrometric error budget for high-@xmath2 detections .",
    "the characteristics of these fluctuations are investigated in section  [ atmosphere ] . *",
    "other sub - mas effects .",
    "the decam astrometric model was constructed through careful examination of the residual astrometric errors in the star flat data .",
    "the final choice of model is given in table  [ mapelements ] .",
    "here we describe each element of the model in more detail , tracing backwards from the collected charge in the pixel well back to the top of the atmosphere .",
    "lccc tree ring distortion & @xmath119 & ` template ` ( radial ) & @xmath120 + serial edge distortion & @xmath121 & ` template ` ( x ) & @xmath122 + serial edge distortion & @xmath123 & ` template ` ( x ) & @xmath122 + optics & @xmath124 & ` polynomial ` ( order@xmath125 ) & @xmath126 + lateral color & @xmath127 & ` color`@xmath128`linear ` & @xmath129 + ccd shift & @xmath130 & ` linear ` & @xmath131 + exposure & @xmath132 & ` linear ` & @xmath126 + differential chromatic refraction & @xmath133 & ` color`@xmath128`constant ` & @xmath120 + [ mapelements ]      in @xmath134 and @xmath28 bands , photons generate holes near the decam ccd surface and then have to drift the 250  @xmath16 m thickness of the device before being collected in the pixels .",
    "as described in @xcite , any electric field components transverse to the surface will cause the charge carriers to drift sideways before collection and induce an apparent astrometric shift .",
    "the decam ccds are known to have two significant sources of such stray fields .",
    "the first are `` tree rings , '' which arise from fluctuations in the impurity density of the silicon boules from which the ccd wafers were cut .",
    "the zone refining of the boules results in approximate circular symmetry about the boule axis , and the wafers are cut perpendicular to this axis , so the astrometric distortions are realized as an irregularly oscillating pattern of rings . for some decam devices ,",
    "the ring centers are on the device , for others the centers are off their edges . because the distortions also produce oscillations in the solid angle of sky received by each pixel , they are readily apparent in the flat - field images .",
    "the nearly - circularly - symmetric pattern in the flat fields implies that the astrometric distortions share this symmetry and are directed radially toward ( or away from ) the ring center .",
    "as described in @xcite , we locate the ring center for each ccd by visual inspection of the flat - field images , and then create templates of the expected astrometric distortion about this center from a high - pass - filtered , azimuthally averaged profile of the flat - field signal .",
    "figure  [ treerings ] plots the template derived for a representative device .",
    "-band flat - field image of ccd s2",
    ". a spline - smoothed fit to the template is subtracted during its production to isolate the oscillatory portion that is due to the doping variations in the silicon boule .",
    "the green points and error bars plot the binned astrometric residuals for star - flat detections in @xmath135 bands on this detector .",
    "the azimuthally - averaged astrometric residual has been reduced to @xmath14  mas  rms . ]    in wcsfit , the tree ring signal is realized as a ` template ` map , with both the variation and the displacement expected to be purely radial to the rings .",
    "we have a single free parameter for each device / filter combination , which is a multiplicative scaling of the distortion predicted by the template .",
    "we do not allow for any time variation of the tree ring signal , since the effect is literally built into the device .",
    "we do allow for a band dependence , however , since photons in the @xmath21 and @xmath136 bands penetrate well into the device and are therefore expected to suffer less deflection before collection , on average .",
    "figure  [ ringfactors ] plots the best - fit template coefficients for all devices and filters .",
    "we do not know , why the tree ring distortions are seen to be only 8090% of the values predicted from the @xmath137-band flat - field images .",
    "but the scaling of these coefficients with filter band hews closely to the values calculated from the absorption - vs - wavelength characteristics of silicon .",
    "figure  [ treerings ] plots the azimuthally averaged residual position for all detections from the @xmath135 exposures of a representative device .",
    "the rms of this residual is at our goal level of @xmath14  mas .",
    "-band flat - field photometric rings .",
    "the black squares plot the mean , for each ccd , of the astrometric coefficients of the @xmath138 , and @xmath28 bands .",
    "the distortion is seen to be less than predicted by the flat - field templates , which is not understood .",
    "the other symbols show each filter s distortion amplitude relative to the @xmath135 mean for that ccd .",
    "these values decrease for @xmath139 and @xmath136 bands , as expected due their longer absorption length in silicon . ]",
    "the electric field in the ccd also develops a substantial transverse component near the device edges . the subsequent astrometric distortion and",
    "pixel - size variation is readily apparent in the flat - field images as a `` glowing edge . ''",
    "it is found that the flat - field ( photometric ) edge behavior is not a good predictor of the astrometric distortions , so we derive a template for edge behavior entirely from the stellar astrometry .",
    "we assume throughout that the edge distortion is directed in the @xmath140 direction ( parallel to the serial register on the short edge of the device ) and is constant along @xmath141 at each edge .",
    "we first fit the star flat data to a model with a ` piecewise ` displacement term with a free node position every 8 pixels within 180  pixels of each edge .",
    "note that the 25 ( 15 ) pixels of the device nearest to the long ( short ) edges are completely masked from analysis because the distortion is too large .",
    "thus we do not have useful stellar centroids closer than @xmath142 pixels to the @xmath143 boundaries .",
    "any nodal values in these regions are unconstrained and ignored .",
    "there are also unusable nodal values near the locations of any defective columns on a device .",
    "upon examination of the best - fit piecewise solutions at the @xmath140 edges , we find that all edges of all ccds in all filters are consistent with a common `` master '' edge template , once we allow for a multiplicative scaling and a shift as large as 12 pixels ( 0.18  mm ) .",
    "these shifts might from the finite precision of the cutter tooling relative to the array during ccd dicing .",
    "the master edge template is shown in figure  [ xedge ] . in the final astrometric fit ,",
    "we allow each device / filter combination to have a ` template ` pixel map at the high- and low-@xmath140 edges .",
    "the templates are shifted versions of the master template , and the scaling is left as a parameter for wcsfit  to optimize .",
    "edge distortion is shown as the blue dots .",
    "each red dot is a binned astrometric residual for a single device / edge combination in a fit _ without _ any modeling of the edge distortion , shifted horizontally by an amount judged to best align with the master template .",
    "the master template is derived from the median of all the red points , and is then used as a template for all @xmath140 edge distortions .",
    "the model interpolates linearly between the blue dots . ]",
    "figures  [ xyresids ] plot the binned displacement residuals in all filters near all 4 edges of the ccd after the @xmath140-edge template is included in the wcsfit  model .",
    "the master template reduces rms @xmath140 residuals to well below 1  mas .",
    "note that we have elected to make no correction at all for the glowing edge effect on the short ( @xmath141 ) edges , because the displacement is already @xmath144  mas before correction . since it affects only a small fraction of the focal plane ,",
    "the rms error is @xmath145  mas .",
    "the best - fit coefficients to the master template are found to be in the range 0.81.2 in the @xmath135 bands , with lower values in @xmath21 and @xmath136 as expected again from the deeper photon conversion .",
    "we take the edge coefficients to be independent of time , as one would expect for such detector - physics effects .",
    "edges . in each case",
    "we are averaging the displacement component perpendicular to the ccd edge .",
    "the master template is seen to reduce rms @xmath140 edge residuals to @xmath146  mas .",
    "we have not implemented a correction for the @xmath141 edges because the signal is @xmath144  mas in all cases and affects only a few percent of the focal plane .",
    "these plots average over all ccds in the northern half of the array ; the southern ccds are installed with 180  rotation and would swap the high and low sides .",
    "plots for individual ccds are consistent with noisier versions of the mean behavior .",
    ", title=\"fig : \" ]   edges . in each case",
    "we are averaging the displacement component perpendicular to the ccd edge .",
    "the master template is seen to reduce rms @xmath140 edge residuals to @xmath146  mas .",
    "we have not implemented a correction for the @xmath141 edges because the signal is @xmath144  mas in all cases and affects only a few percent of the focal plane .",
    "these plots average over all ccds in the northern half of the array ; the southern ccds are installed with 180  rotation and would swap the high and low sides .",
    "plots for individual ccds are consistent with noisier versions of the mean behavior .",
    ", title=\"fig : \" ]      the vast majority of the nonlinearity in the @xmath147 map is produced by the classical distortion of the optical system .",
    "a time - independent polynomial map for each filter / device combination , with terms @xmath148 up to order @xmath149 is used . while the camera optics have radial distortion at fifth ( and higher ) order , a fourth - order - per - ccd solution is found sufficient to capture the optical distortion , and the placement of the ccds in the focal plane .",
    "these polynomials carry 30 free parameters per ccd per filter , roughly 9000 for the whole array .",
    "it is in this map that we change units from pixels ( on the array ) to degrees ( in the gnomonic projection about the telescope axis ) .",
    "the decam astrometric map is observed to change over time by @xmath150  mas .",
    "we posit that these changes are dominated by small translations and rotations of the devices with respect to their mounting plate , or other mechanical drifts .",
    "we allow wcsfit  to model this by adding a linear ( affine ) distortion , with 6 free parameters , to each ccd , for every star flat epoch except the first one .",
    "the ccd shifts are taken to be identical in all filters .",
    "the results of these fits are examined in section  [ stability ] .",
    "any axisymmetric refractive optical system is expected to have color - dependent radial distortion , leading to color terms described by odd - order polynomials in radius .",
    "we check this assumption by including in our initial fits a more general color term : a time - independent linear function of coordinates on each ccd .",
    "the displacement is assumed to be proportional to @xmath151 where the reference color is chosen to be @xmath152 the color in the natural decam @xmath153 system of the f8iv star c26202 from the hubble space telescope calspec system .",
    "we restrict the fit to stars with @xmath154 to avoid m stars for which the expected shifts may no longer be linear in @xmath25 , and assume that the color term is time - independent for a given filter .    figure  [ lateral ] plots the best - fit static color solution in the @xmath155 and @xmath137 bands , which show the radial patterns ( at mas accuracy ) and approximate amplitude expected from the optical solution ( s. kent , private communication ) .",
    "the solutions for @xmath156 and @xmath136 bands are , as expected , undetectably small as the chromatic terms of the corrector lenses are weaker , and we disable their color terms for the final wcsfit  run . for the @xmath155 and @xmath137 bands ,",
    "we continue by re - fitting to a more restrictive function , namely a ` color ` pixelmap wrapping a radial ` piecewise ` displacement .",
    "a fifth - order function of field radius is found to fit the resultant piecewise function with 2  mas / mag rms scatter ( figure  [ lateral ] ) .",
    "we used the fitted polynomials ( implemented as radial ` template ` pixel maps ) for our final model , with no free parameters .",
    "( left ) and @xmath137 ( center ) bands .",
    "note the very different scales for each .",
    "the dashed rectangles are the outlines of the 61 decam ccds that have been functional for at least part of this analysis .",
    "the arrows plot the shift per magnitude of @xmath157 color at the four corners of each ccd , using the best - fit model of linear dependence across each device .",
    "as expected from the optical design , the pattern is radial , with barely detectable amplitude in @xmath137 band and no detectable @xmath158,or @xmath136 band lateral color ( not shown ) . at",
    "right are the results of fitting the @xmath155 and @xmath137 data to a purely radial piecewise function of radius ( circles ) .",
    "we adopt as our final lateral color model the fifth - order polynomial fits to these models ( solid lines ) , as a seventh - order fit ( dashed lines ) offers no significant improvement .",
    ", title=\"fig : \" ]   ( left ) and @xmath137 ( center ) bands .",
    "note the very different scales for each .",
    "the dashed rectangles are the outlines of the 61 decam ccds that have been functional for at least part of this analysis . the arrows plot the shift per magnitude of @xmath157 color at the four corners of each ccd , using the best - fit model of linear dependence across each device .",
    "as expected from the optical design , the pattern is radial , with barely detectable amplitude in @xmath137 band and no detectable @xmath158,or @xmath136 band lateral color ( not shown ) . at",
    "right are the results of fitting the @xmath155 and @xmath137 data to a purely radial piecewise function of radius ( circles ) .",
    "we adopt as our final lateral color model the fifth - order polynomial fits to these models ( solid lines ) , as a seventh - order fit ( dashed lines ) offers no significant improvement .",
    ", title=\"fig : \" ]      aside from the freedom to determine the pointing of the optic axis on each exposure , we will clearly require the model to admit exposure - to - exposure freedom to rotate , shear , and magnify the image across the fov , because these effects will be present ( at many mas ) due to misalignment of the telescope equatorial mount , temperature - induced variations in focal length , atmospheric refraction , and stellar aberration from earth s motion .",
    "an active optics system @xcite controls the position of the camera and corrector with respect to the primary mirror ; variations in this position could also induce small time - dependent changes to the optical distortion .",
    "we proceed with this linear freedom per exposure in our analyses .",
    "as noted earlier , atmospheric refraction should generate quadratic terms at @xmath116  mas ; we will subsume these into our investigation of stochastic atmospheric distortions in section  [ atmosphere ] .",
    "the color dependence of atmospheric refraction in the context of wide - field cosmological surveys is studied by @xcite and @xcite , who conclude that in some bands it will be present at @xmath116  mas and significant for weak gravitational lensing analyses .",
    "the atmospheric refraction is very large ( @xmath159 at zenith angle @xmath21 ) compared to our desired accuracy so the chromatic effect is significant . for a given site",
    "it is expected to behave as @xmath160 where @xmath25 is the object color ( again @xmath157 ) , @xmath161 is the unit sky vector toward the zenith ( the parallactic angle ) , and @xmath162 is a constant derivable for each band @xmath163 from the instrumental bandpass and atmospheric index of refraction .",
    "we test this model by allowing each exposure to have its own constant differential chromatic refraction ( dcr ) term @xmath164 when fitting to the star flat detections .",
    "figure  [ dcrfig ] shows these results for @xmath155 and @xmath137 bands , along with the model ( [ dcreqn ] ) with the best - fit value of @xmath162 .",
    "the standard atmospheric model is seen to describe the measured @xmath165 well , with rms residuals of 23  mas / mag .",
    "table  [ dcrtab ] gives the dcr amplitudes @xmath162 derived from the star flat data ( supplemented with the supernova field data described in section  [ stability ] for the @xmath28 and @xmath21 bands ) .",
    "the @xmath162 are in good agreement with the predictions of @xcite , and for future use it should suffice to simply fix the dcr term to instead of allowing freedom to each exposure .     and @xmath137 star flat exposures ( left and right columns , respectively ) are compared in the top row to the predicted scaling with @xmath166 .",
    "the top row plots the measured dcr component along the parallactic ( zenithal ) direction , with the dashed line showing the prediction with the best - fit value of @xmath162 for each band @xmath163 .",
    "the middle row plots the residuals to vs the date of the exposure , with the points color - coded according the value of @xmath166 .",
    "the bottom row plots the azimuthal component of the measured dcr , which is expected to be zero .",
    "the model works well , with 23  mas / mag rms residuals , and no remnant trends with time or airmass.,title=\"fig : \" ]   and @xmath137 star flat exposures ( left and right columns , respectively ) are compared in the top row to the predicted scaling with @xmath166 .",
    "the top row plots the measured dcr component along the parallactic ( zenithal ) direction , with the dashed line showing the prediction with the best - fit value of @xmath162 for each band @xmath163 .",
    "the middle row plots the residuals to vs the date of the exposure , with the points color - coded according the value of @xmath166 .",
    "the bottom row plots the azimuthal component of the measured dcr , which is expected to be zero .",
    "the model works well , with 23  mas / mag rms residuals , and no remnant trends with time or airmass.,title=\"fig : \" ]    cc @xmath155 & 45.0 + @xmath137 & 8.4 + @xmath28 & 3.2 + @xmath21 & 1.4 + @xmath136 & 1.1 [ dcrtab ]",
    "the first panel of figure  [ ccdresids ] plots the errors @xmath167 in the stellar positions of a randomly selected single exposure on a randomly selected ccd , relative to the mean positions determined for the same stars from the entire stack of star - flat exposures .",
    "the residuals after application of our final astrometric model are dominated by a coherent pattern with rms @xmath168  mas .",
    "this pattern is found to differ from exposure to exposure and is plausibly attributed to refraction by atmospheric turbulence . before investigating these stochastic distortions in section  [ atmosphere ] , we ask here whether there are any distortion patterns that recur from exposure to exposure .",
    "to find them we will need to average down the stochastic atmospheric signal by stacking and binning the residuals from many exposures .          the middle panels of figure  [ ccdresids ] show the result of averaging the residuals from all of the @xmath134 and @xmath28 band exposures from a single star flat epoch , and then from all epochs .",
    "the amplitude of the residual pattern drops steadily with number of exposures included , although not as quickly as the square root of the number of exposures , as would be expected if all remaining errors were uncorrelated between exposures .",
    "the all-@xmath135 residuals for this ccd exhibit clear coherence of several kinds :    * a radial pattern just above center contains distortions with amplitude of up to 30  mas .",
    "this roughly coincides with the edge the electrical connector that is soldered and glued to the ccd , and protrudes through a hole in the ccd mounting board .",
    "the right - hand panel of figure  [ ccdresids ] averages over all 30 functional decam science ccds mounted in the same orientation , showing that this pattern is recurrent and exists at both ends of the connector mount , and is likely a product of stresses induced in the ccd lattice the connector or the hole in the mounting board .",
    "* there are excess residuals along the long edges of the device , suggesting that the edge distortion is not uniform along the edge of the device .",
    "the rightmost panel confirms that this is true in a systemic fashion for the devices .",
    "* the right - most panel shows the largest residuals in the corners of devices , plus two patches at the midpoints of the long edges .",
    "these six locations are known as `` tape bumps '' since they are underlain by thin spacers that define the thickness of the glue layer between the ccd and its carrier .",
    "these regions , each 100200 pixels on a side , exhibit structure in the flat fields that is indicative of stray transverse electric fields induced by lattice stresses .",
    "there are clear astrometric disturbances associated with these fields as well .",
    "because these are difficult to model and cover only a small fraction of the focal plan , we do not attempt to remove them : detections occurring on the tape bumps are flagged as having less reliable astrometry , and in fact have been omitted from the characterization and modeling performed in this paper .",
    "the decam flat fields show evidence for modulations of the pixel size with period @xmath169  pixels , a behavior seen in many ccds due to the step - and - repeat accuracy of the mask generator @xcite .",
    "a corresponding periodicity is detectable in the astrometric deviations , but with peak - to - peak amplitude @xmath9  mas , as is predicted from the amplitude of the flat - field fluctuations .",
    "we ignore this effect for decam .",
    "a final question we address about the residuals to the model is whether the linear - per - ccd ` ccdshift ` terms are sufficient to describe the change of the astrometric solution between epochs .",
    "figure  [ epochresids ] shows a test of this , whereby we plot the mean residual astrometric errors for an entire epoch s",
    "@xmath135 detections , averaged by position on the array .",
    "the residuals are consistent with the expectations of averaging 66 realizations of the stochastic atmospheric pattern .",
    "in particular there are no statistically significant discontinuities across ccd boundaries .     and @xmath28 bands during star flat epoch ` 20150204 ` is plotted vs array position .",
    "no discontinuities at device boundaries are detectable ( dashed boxes ) , and the signal is consistent with our model in which epoch - to - epoch changes are fully captured by linear adjustments to each ccd , plus the stochastic atmospheric signal .",
    "the decam fov is 2  in diameter , and the distortion field is magnified by @xmath170 to conform to the red scale bar . ]",
    "we conclude that our astrometric model captures the recurrent instrumental distortion pattern to an accuracy of 24  mas rms .",
    "the only residual distortions that have detectable coherence between the 64-pixel ( 16 ) bins of figure  [ ccdresids ] are those associated with stresses from the ccd mounting , and with inhomogeneities in the transverse electric fields generated at the ccd edges .",
    "after application of the astrometric model , the dominant form of astrometric error is a field that varies from exposure to exposure and has a coherence length of 510 .",
    "figure  [ atmos ] plots the residual vector field for a representative exposure .     band ) , averaged in bins of focal - plane position .",
    "below are the divergence and curl of this vector field , plotted on a common scale .",
    "the continuity of the vector field across chip boundaries , the curl - free nature of the field , and the streaky pattern of divergence strongly support the hypothesis that these distortions arise from atmospheric turbulence.,title=\"fig : \" ]   band ) , averaged in bins of focal - plane position .",
    "below are the divergence and curl of this vector field , plotted on a common scale .",
    "the continuity of the vector field across chip boundaries , the curl - free nature of the field , and the streaky pattern of divergence strongly support the hypothesis that these distortions arise from atmospheric turbulence.,title=\"fig : \" ]      multiple lines of evidence support the hypothesis that these distortions arise from refraction by atmospheric turbulence :    * the patterns are uncorrelated between exposures , and thus change on time scales of 1 minute or less .",
    "the only physical conditions that should change this quickly are the atmosphere and the settings of the hexapod that fixes the alignment of the camera to the primary . * the distortion pattern appears to be curl - free .",
    "the lower panel of figure  [ atmos ] suggests that the curl arises from white noise ,  errors in stellar positions due to shot noise .",
    "this is shown more rigorously in figure  [ ebcorr ] , in which the 2-point correlation function of astrometric errors is split into e- and b - mode components ( curl- and divergence - free , respectively ) , as explained in appendix  [ ebappendix ] .",
    "the latter is seen to be consistent with zero .",
    "curl - free distortion patterns are expected in the ray - optic limit , where the astrometric displacement of each photon is the gradient of the integral of the scalar index of refraction ( time delay ) along the line of sight to the star . *",
    "the distortion pattern is clearly anisotropic , with a long correlation length in one direction .",
    "the preferred direction is roughly , but not exactly , consistent between exposures , as is expected from having the atmospheric turbulence pattern blowing across the field of view during the exposure .",
    "the streaky patterns are very similar to the maps of psf ellipticity in short exposures with the cfht megacam presented by @xcite , which they also attribute to wind . *",
    "the power spectrum of the distortion in the cross - wind direction is roughly consistent with that expected of kolmogorov turbulence . *",
    "the amplitude and correlation length of the distortion are roughly consistent with numerical simulations of kolmogorov turbulence ( j. peterson , private communication ) .",
    "the simulations suggest that the astrometric perturbations are strongly dependent on the outer scale of the turbulence .",
    "if the stochastic distortions do indeed arise from atmospheric turbulence , we expect their amplitude to decrease with the square root of exposure time as we average over phase screens .",
    "we can not verify this with our data since nearly all star flat exposures were taken with 30  s exposures , save the first three epochs which used 50  s. while these early epochs do show the lowest stochastic distortion ( see figure  [ astrohist ] ) , there is substantial variation from epoch to epoch so we can not draw any quantitative conclusions .      for a more quantitative picture of the stochastic / atmospheric distortion field",
    ", we produce its 2-point correlation function @xmath171 where @xmath172 is the sky position of detection @xmath28 , @xmath173 is the measurement error on this position , and the average is taken over all pairs of detections @xmath174 in the _ same exposure _ separated by distance @xmath137 ( in practice the `` true '' position is taken as the average of our many measured positions ) .",
    "appendix  [ ebappendix ] explains how @xmath175 can be split into two components @xmath176 and @xmath177 which arise from the curl- and divergence - free parts of the vector field , respectively .",
    "these are plotted in figure  [ ebcorr ] , where it is clear that @xmath177 is insignificant in comparison to @xmath178 as expected for atmospheric refraction . in this case , and if we consider the turbulence to be a gaussian random field , then @xmath179 fully characterizes the field . since the field is anisotropic . ]     of the astrometric errors , averaged over 20 @xmath21-band exposures in the 20121120 epoch , which exhibits the weakest stochastic distortion signal .",
    "the signal is split into @xmath176 ( the @xmath175 of the curl - free portion of the vector field ) , @xmath177 ( divergence - free ) , and the cross - correlation @xmath180 between these two . as expected for any parity - invariant process , @xmath180 is consistent with zero .",
    "atmospheric refraction should have @xmath181 , consistent with the observations .",
    "the oscillations in @xmath176 at @xmath137 above @xmath182 of the field diameter are to be expected , since we have subtracted the best - fit cubic polynomial from the residual pattern . ]    before calculating @xmath175 , we subtract from the @xmath183 the best - fit cubic polynomial function of field coordinates .",
    "as discussed earlier , we expect significant linear and quadratic - dependence distortions from normal ( homogeneous ) atmospheric refraction ; turbulent refraction should also have a substantial large - scale component , and indeed we observe @xmath184 of the distortion variance to come from this polynomial signal .",
    "since the low - order component is easily determined in practice by fitting to the gaia catalog , we remove it from our analysis , leaving small - scale distortions .",
    "note that the virtue of using @xmath185 is that it is unaffected by the shot - noise measurement errors of the stellar positions ( for @xmath186 ) and therefore is a pure measure of the astrometric map .",
    "we characterize the astrometric correlation function by two quantities , @xmath187 and @xmath188 the former is essentially the small - scale ( largest ) value of @xmath189 defined as @xmath190 the second quantity @xmath191 is defined as the radius at which @xmath192  the smoothing scale that would cut the astrometric variance in half .",
    "( top ) , the correlation length @xmath191 of the distortion , and the half - light diameter @xmath193 of the psf are plotted vs time for all star - flat exposures .",
    "each horizontal tick marks one hour , and the vertical lines represent the days to months between sets of star flat observations .",
    "epochs are labelled across the top .",
    "the amplitude of astrometric distortion is only partially correlated with the seeing . ]",
    "figure  [ astrohist ] plots the values of @xmath187 and @xmath191 for all the star flat exposures under analysis , along with the half - light diameter @xmath193 of the psf in each exposure .",
    "it is clear that there are nights when a degradation of seeing is accompanied by an increase in astrometric distortion (  20140118 , 20150926 ) , as one might expect if both are proportional to the amplitude of a strictly kolmogorov turbulence spectrum .",
    "however there are also cases of anti - correlation , and the mean seeing of a night is a very weak predictor of astrometric accuracy . in particular , the epoch 20140807 is astrometrically awful , exhibiting 3050  mas rms atmospheric contribution whereas most other epochs are 1020  mas rms . yet",
    "the seeing on that night was not as poor .",
    "clearly there are other variables besides kolmogorov amplitude , such as wind speed or outer scale , that determine the astrometric quality of the night .",
    "the correlation angle is in the range @xmath194 at all epochs , with no apparent relation to the seeing .",
    "this suggests that interpolation between stars in gaia catalog , with source density of @xmath14 star per arcmin@xmath0 at high latitude , could significantly reduce the stochastic atmospheric errors .",
    "we investigate this in section  [ interpolation ] .",
    "the decam measures of stochastic atmospheric astrometric fluctuations are in rough agreement with previous characterizations by @xcite , @xcite , and @xcite ( and references therein ) , in terms of typical amplitude at good sites , and substantial night - to - night variation that is at best tenuously tied to the seeing fwhm .",
    "is the decam astrometric solution stable over weeks , days , or years ?",
    "we already know that there is short - term ( seconds ) variability due to atmospheric turbulence , at a typical level of 1020  mas rms in a 30 s exposure and 510  correlation length .",
    "but this should average to zero with longer exposures .",
    "we have verified in section  [ residsec ] that the astrometric errors within a given star flat epoch (  a few hours clock time ) are consistent with a single solution , up to the accuracy allowed by the stochastic atmospheric distortions , as long as we allow for expected exposure - to - exposure variations at low order across the focal plane .",
    "we are interested in the duration over which a single astrometric solution can otherwise be considered to maintain few - mas accuracy .",
    "mas in places . ]",
    "our fit to all of the star flat data allowed for variations between star flat epochs in the form of a free linear transformation for each device .",
    "figure  [ sfdrift ] depicts the `` ccd shift '' patterns found to best fit 5 of the epochs . in these plots , and in all analysis , we removed from the ccd shift coefficients any components consistent with an overall cubic polynomial distortion of the focal plane , since we know that the solution will have time variability of this nature which must be resolved on an exposure - by - exposure basis ,  by using gaia reference stars .",
    "the figure makes it clear that there are epoch - to - epoch changes that would dominate the stochastic errors even in a single 30 s exposure .",
    "the relative motions of ccds can be surprisingly large ,  over 100  mas , or @xmath195",
    "@xmath16 m in the focal plane , over a time period of just 14 days , in the case of the last two epochs plotted .",
    "the star flat sequences were taken too infrequently to resolve the temporal behavior of the ccd shifts .",
    "fortunately the _ dark energy survey _ observing program includes repeated visits to 10 fields in a search for high - redshift supernovae .",
    "each field is imaged roughly once per week during the 6-month des observing season .",
    "we examine here the stellar detections in @xmath196 exposures taken of the snc3 field in the 4 years following camera commissioning .",
    "visits to this field usually comprise @xmath197  s exposures in @xmath155 band , @xmath198  s in @xmath137 , @xmath199  s in @xmath28 , and @xmath200  s in @xmath201 after matching all of the stellar detections in these images , we run wcsfit  on the 1123 @xmath28 and @xmath21 band exposures from 112 distinct nights during which the photometric solutions indicate absence of clouds and the seeing @xmath193 is predominantly @xmath202 this wcsfit  adopts the astrometric solution derived from the star flats , holding all parameters fixed except :    * the linear solution for each exposure , * the differential chromatic refraction constant for each exposure , and * the linear ccd shifts , one per ccd per epoch ( night ) of observations .    from this solution",
    "we extract the ccd shifts for each snc3 epoch , combining them with the ccd shifts for the star flat data , and projecting out a fov - wide cubic polynomial fit to each epoch .",
    "we analyze only the 59 ccds that are fully functional over the 4 years .        the first row of figure  [ pca ] plots the difference between each epoch s ccd shifts and the preceding epoch s solution .",
    "we quantify this difference by giving the rms displacement between the solutions , averaged over the active regions of the array . we see immediately that the largest changes occur for the first epoch to follow a warming or cooling event for the camera .",
    "decam is cycled to room temperature for various maintenance purposes , or when electrical power is lost for long periods . on three occasions the focal plane temperature dropped from the normal @xmath203  c to @xmath204  c when power to its heaters was lost for several hours .",
    "we will refer to these as `` camera events '' and the periods between them as `` camera intervals . ''",
    "we perform a principal components analysis of the 354-element feature vector specifying each exposure s ccd shifts , in hopes of revealing the temporal structure of the largest contributors to astrometric variation .",
    "we should be aware , however , that two spurious signals will be present in these data :    1 .",
    "the snc3 exposures are taken with minimal dithering , and have only @xmath42 high-@xmath2 stars per ccd , many fewer than the star flat data .",
    "this means that the ccd shift fits will be pulled by the proper motions of the stars within each device . we should therefore expect to see one or more principal components ( pcs ) containing a signature that is linear in time for the snc3 exposures and absent from the star flat exposures .",
    "parallax motion of the snc3 stars should be a small perturbation to this .",
    "the snc3 ccd shifts have a different reference epoch than the star flat solution s .",
    "therefore we should see a static difference between these two in at least pc .",
    "figure  [ pca ] presents the coefficients of the six most significant pcs , plotted against date of the epoch solution .",
    "these are again plotted in units of the rms displacement they represent on the focal plane .",
    "we immediately identify pc0 , the largest contributor , as the expected signature of proper motion in the snc3 stars ( although it is also possible that a smaller , linear - with - time focal plane drift is also in this pc ) .",
    "we also suspect that pc2 contains the second expected spurious signal , the distinct reference epochs for the snc3 and star flat solutions .",
    "most striking is that the other pcs appear to be dominated by changes that occur at camera events .",
    "the largest , pc1 , began on thanksgiving day 2015 , and its associated distortion persisted at normal operating temperatures until the camera was warmed on 1923 feb 2016 .",
    "note that this warmup occurs between the last two star flat epochs plotted in figure  [ sfdrift ] .",
    "figure  [ cooldown ] plots the change in focal plane mapping that occurred during this cooldown .",
    "some of the ccds appear to have moved by up to 100150  mas , or 610  @xmath16 m .",
    "ccds also show significant rotations , contributing @xmath42  mas rms displacement .",
    "scale changes or shears of the ccds are much smaller ( @xmath205  mas rms ) , as expected if the cooldown distorted the mounting structure .",
    "mas rms ) , as expected if the shifts are due to displacements of the ccd carriers . ]    concluding that _ the bulk of the change in astrometric maps occurs during camera events , _ we adopt a scheme for astrometric calibration of des data whereby * each exposure is assumed to have the same instrumental astrometric map as the nearest - in - time star flat epoch that lies within the same camera interval . *    we test this des astrometric procedure by re - running wcsfit  on the snc3 @xmath206-band exposures using a model with the ccd shifts assigned per the local star flat data , and allowing each exposure a free cubic polynomial distortion across the focal plane .. ] we fit a linear function of time to each snc3 star s measured positions and subtract these to yield measurement errors free of proper motion .",
    "figure  [ snresid ] illustrates the quality of the resulting fits . in the top row",
    "we plot the rms deviation of all stellar residuals from a given night relative to the mean _ within _ the night .",
    "this is a measure of astrometric map components that vary on time scales of hours or less , which we expect to be dominated by atmospheric effects . at 57",
    "mas rms per component , these are roughly consistent with the values seen in figure  [ astrohist ] after considering the @xmath207 reduction in atmospheric noise expected from the longer exposure times in the sn field .",
    "it is also possible that some of this rms is due to unmodelled instrumental effects that vary across the 1020  dithers of the supernova exposures ,  the pixel - to - pixel fluctuations in ccd gate lithography .",
    "the lower panel of figure  [ snresid ] plots the rms deviation of each night s stellar exposures after we _ average the night s measurements of each star and subtract the noise expected from the intra - night variations .",
    "_ this yields an estimate of the rms astrometric error that is coherent through a night , such as might be attributable to unmodelled shifts in the ccd positions or changes in optical alignment .",
    "such errors are seen to be in the 24  mas range on most nights .",
    "the errors appear larger in the e - w direction than the n - s direction , particularly during early y1 observations when the e - w errors reach 6  mas rms , perhaps indicating lower quality in the star flat solution derived for the corresponding camera interval .",
    "we note , finally , that the cubic polynomials we fit to each exposure are often much larger in amplitude than could be ascribed to atmospheric effects .",
    "this suggests that changes in optical alignment over time are significant at @xmath208  mas level .",
    "given an astrometric reference catalog with errors at mas scale and @xmath209 star in each 510  coherence patch , one could measure some fraction of the atmospheric ( or other ) astrometric errors and add them to the solution ,  interpolate the map between reference stars .",
    "the gaia catalog will provide such a reference catalog .",
    "the gaia dr1 secondary catalog @xcite does not contain proper motions so falls slightly short of our ideal , but these will appear in the dr2 release schedule for april 2018 .",
    "reference stars could also be obtained by repeated ground - based observations to average atmospheric and instrumental effects .",
    "we use this approach for a cursory investigation of the potential of reference - catalog interpolation .",
    "we extract as a reference catalog the mean positions over all star flat observations of a randomly selected set of stars with mean density of 0.75  arcmin@xmath210 .",
    "these `` truth '' positions are used to interpolate the astrometric distortions for individual exposures . because our star flat observations span multiple years , the truth positions may also be degraded by proper motions .",
    "we use the scikit - learn implementation of gaussian process ( gp ) regression to interpolate the errors in the astrometric model on a given exposure .",
    "the gp technique requires a kernel specifying the covariance between the error vectors of two stars separated by .",
    "we take this covariance function to have a white - noise ( @xmath211-function ) component of amplitude @xmath212 plus a gaussian with amplitude @xmath213 in the cross - wind direction and @xmath214 in the wind direction .",
    "the cross- and along - wind components of  have independent gp models .",
    "the procedure is to :    1 .",
    "randomly select a training set of stars at the chosen density and fit the gp model to these .",
    "2 .   use the gp to interpolate to the location of each training star , and reject training stars with outlier residuals ( high - proper - motion stars ) .",
    "3 .   refit the gp using the retained training stars .",
    "interpolate to the positions the validation set of remaining high-@xmath2 stellar detections .",
    "remove outlying residuals from the validation set .",
    "calculate the 2-point correlation functions of the residuals .     and",
    "@xmath180 are plotted vs separation both before ( `` raw '' ) and after interpolation of the astrometric errors using a reference star set of density 0.75  arcmin@xmath210 .",
    "the plot shows the mean @xmath175 across @xmath215 s @xmath21-band exposures in star - flat epoch ` 20130829 . `",
    "note that we plot only @xmath176 for the pre - interpolation case ( black ) since we have found the distortions consistent with pure @xmath97-mode behavior , and that the pre - interpolation plot is reduced by a factor of 8 to fit on the same plot .",
    "the reduction in @xmath175 from interpolation is dramatic , with correlations at scales above the reference - star density being essentially eliminated . ]",
    "we execute this process for 21 @xmath21-band exposures in epoch ` 20130829 ` , the same set plotted in figure  [ ebcorr ] .",
    "the mean correlation functions before and after interpolation are plotted in figure  [ postinterp ] .",
    "the @xmath97 mode remains dominant even though the interpolation process is not designed to conserve @xmath216 behavior .",
    "as expected , the interpolation reduces @xmath176 to negligible levels ( @xmath115  mas@xmath0 ) at scales @xmath217 where multiple reference stars can contribute to interpolation .",
    "the removal of large - scale power reduces the @xmath218 at @xmath219 by a factor @xmath220 from the pre - interpolation value .",
    "the average post - interpolation residuals are @xmath221  mas rms for this epoch , which has typical stochastic signal level @xmath187 .",
    "the correlation length of the astrometric errors is reduced to 1 .",
    "one would expect the amplitude of the post - interpolation residuals to decrease with the square root of integration time until the systematic error floor of either the reference catalog or decam is reached .",
    "this is just an initial investigation : we have attempted to optimize the interpolation procedure neither for accuracy nor speed .",
    "certainly there is improvement to be had through gp kernel optimization or other approaches , including interpolation schemes that exploit the known absence of @xmath88 modes in the vector distortion field .",
    "doubling the density of reference stars appears to have little effect on the residual amplitude .",
    "an astrometric model for decam with errors near mas level requires terms not only for the polynomial optical `` plate solution , '' but also contributions from : stray electric fields near the edges in the detector and from `` tree ring '' impurity fluctuations ; lateral color and differential chromatic refraction in the bluer bands ; shifts in the ccd positions primarily accrued during focal - plane temperature excursions ; and time - variable low - order ( cubic ) distortions across the fov from a litany of instrumental and atmospheric effects .",
    "all of these distortions components are determined reliably by fitting a model to stellar positions measured from dithered decam exposures .",
    "external reference catalogs play little role in this process , being needed only to stabilize some large - scale degeneracies such as the overall pixel scale .",
    "the wcsfit  software that we created for this purpose is similar to the widely - used scamp  code in optimizing the parameters of a model to maximize agreement among multiple exposures of the same star .",
    "wcsfit  uses simple linearized iterations to minimize a @xmath26 , relying on scamp  or some other code to have produced an initial solution that maps each exposure to @xmath222 accuracy .",
    "wcsfit  complements scamp  by : the ability to specify and fit a complex model with many components interlacing their effects among many exposures ; enhanced outlier rejection , necessary to achieve precise modelling ; and some optimizations for fitting large exposure sets with large numbers of free parameters .",
    "once this model is fit to an ensemble of decam exposures , the remaining astrometric errors are dominated by a curl - free stochastic field of atmospheric refraction fluctuations . in a typical 30 s exposure ,",
    "the stochastic atmospheric distortions are 1030  mas rms with coherence length of 4 - 10  and a strongly anisotropic pattern from wind - blown turbulence .",
    "some nights are much worse than this ; unfortunately there is no strong connection between seeing fwhm and astrometric quality .    the atmospheric turbulence averages down with longer exposures or through stacking of residuals on many exposures .",
    "doing so reveals weaker but persistent errors in the astrometric model .",
    "fixed patterns in the devices at 24  mas rms ( 0.008 - 0.015 pixel ) are dominated by larger residuals on small regions of the device subject to edge effects and mounting structures .",
    "these could be tabulated from the device stacks and added to the model if we acquired even more stellar measurements .",
    "star - flat exposures sequences taken every few months are used to monitor shifts in ccd positions . using des supernova - field observations , we determine that the bulk of the observed shifts occurs when decam s focal plan warms to room temperature or cools below normal operating temperature .",
    "if we apply the ccd shifts measured in the star - flat epochs to the sn data , we find that remaining errors inter - night variation in the solution is 24  mas .",
    "the 410  coherence length of the dominant atmospheric distortions suggests that the gaia reference catalog , with positions and ( in the future ) proper motions for @xmath223 star per arcmin@xmath0 at high galactic latitude , can be used to constrain and remove the atmospheric pattern ( and , trivially , the low - order polynomial distortions ) .",
    "indeed we find that a trial of gaussian - process interpolation using reference stars at this density reduces the correlation function @xmath224 of errors to @xmath9  mas@xmath0 on scales @xmath225 and reduce the rms value at smaller scales to @xmath221  mas in a 30 s exposure .",
    "the astrometric maps and procedures derived herein will be applied to the des observations and made available to other users of decam .",
    "we find that errors in the resultant positions are likely to be dominated by ( in order of decreasing importance ) :    * unavoidable shot noise in the measurement of object centers ( for fainter stars ) . *",
    "atmospheric turbulence of typical rms amplitude ( 1520)@xmath226  mas , where @xmath227 is the exposure time in seconds , and coherence length @xmath228 this amplitude depends on the weather . given a gaia catalog with proper motions ,",
    "the atmospheric field can be measured and interpolated to random locations , leaving residuals @xmath229 smaller and with coherence length @xmath230 * unmodelled night - to - night variations in the decam astrometric solution at 24  mas rms . * up to 24  mas rms additional errors from static detector effects ( mounting holes , edge fields ) that we do not yet model , but could potentially include given a much larger set of stellar measurement residuals .",
    "we conclude that the decam astrometric model , with registration to the gaia catalog , has rms errors below 10  mas in a typical 30 s exposure , small enough to be negligible for cosmic - shear measurements , and likely to be even smaller in the standard 90-second des exposure . for a general - use , wide - field instrument like decam to reach the limit of astrometric accuracy imposed by atmospheric turbulence ( with gaia interpolation gains ) ,",
    "the best observing scheme is to dither successive exposures so that the few mas of remaining systematic camera - centered distortions are sampled differently for each exposure of the desired targets .",
    "such a strategy is intrinsic to the des wide 5000  deg@xmath0 survey , so we should expect astrometric catalogs from this survey that are limited by the combination of image shot noise and atmospheric turbulence .",
    "the lsst aims to achieve this goal as well , and the decam results here show that this should be entirely feasible .",
    "lsst has a larger field , shorter exposures , and many more stellar detections to work with .",
    "the decam experience perhaps shows the value of regular star - flat observation sequences .",
    "a substantial complication for lsst ( as well as other modern wide - field imagers / telescopes such as hyper suprime - cam ) is its alt - az mounting and consequent need of an instrument rotator .",
    "this introduces a degree of freedom to the optical system absent from the equatorial - mounted blanco telescope , perhaps greatly increasing the number of constraints that must be analysed to yield a solution valid at all rotator angles .",
    "lsst will obtain many more stellar images , so the necessary data will likely exist but pose a bigger computational challenge .",
    "gmb gratefully acknowledges support from grants ast-1311924 and ast-1615555 from the national science foundation , and de - sc0007901 from the department of energy .",
    "aap is supported by the jet propulsion laboratory .",
    "part of the research was carried out at the jet propulsion laboratory , california institute of technology , under a contract with the national aeronautics and space administration .",
    "we thank steve holland and greg derylo for help with interpretations of detector and camera behaviors .",
    "the wcsfit  code and subsequent analyses make extensive use of the following excellent public software packages : tmv for linear algebra and treecorr for fast correlation functions , both by r. m. jarvis ; yaml - cpp by j. beder for yaml decoding ; and cfitsio by w. pence , fitsio by e. sheldon , and astropy for fits access in c and python environments .",
    "funding for the des projects has been provided by the u.s .",
    "department of energy , the u.s",
    ". national science foundation , the ministry of science and education of spain , the science and technology facilities council of the united kingdom , the higher education funding council for england , the national center for supercomputing applications at the university of illinois at urbana - champaign , the kavli institute of cosmological physics at the university of chicago , the center for cosmology and astro - particle physics at the ohio state university , the mitchell institute for fundamental physics and astronomy at texas a&m university , financiadora de estudos e projetos , fundao carlos chagas filho de amparo  pesquisa do estado do rio de janeiro , conselho nacional de desenvolvimento cientfico e tecnolgico and the ministrio da cincia , tecnologia e inovao , the deutsche forschungsgemeinschaft and the collaborating institutions in the dark energy survey .",
    "the collaborating institutions are argonne national laboratory , the university of california at santa cruz , the university of cambridge , centro de investigaciones energticas , medioambientales y tecnolgicas - madrid , the university of chicago , university college london , the des - brazil consortium , the university of edinburgh , the eidgenssische technische hochschule ( eth ) zrich , fermi national accelerator laboratory , the university of illinois at urbana - champaign , the institut de cincies de lespai ( ieec / csic ) , the institut de fsica daltes energies , lawrence berkeley national laboratory , the ludwig - maximilians universitt mnchen and the associated excellence cluster universe , the university of michigan , the national optical astronomy observatory , the university of nottingham , the ohio state university , the university of pennsylvania , the university of portsmouth , slac national accelerator laboratory , stanford university , the university of sussex , texas a&m university , and the ozdes membership consortium .",
    "the des data management system is supported by the national science foundation under grant number ast-1138766 .",
    "the des participants from spanish institutions are partially supported by mineco under grants aya2015 - 71825 , esp2015 - 88861 , fpa2015 - 68048 , sev-2012 - 0234 , sev-2012 - 0249 , and mdm-2015 - 0509 , some of which include erdf funds from the european union .",
    "ifae is partially funded by the cerca program of the generalitat de catalunya .",
    "abramowitz , m. , & stegun , i. 1965 , handbook of mathematical functions , ( new york : dover )    anderson , j.,bedin , l.  r. , piotto , g. , yadav , r.  s. , & bellini , a.  2006 , , 454 , 1029    anderson , j. , & king , i.  r.  1999 , , 111 , 1095    bertin , e.  2006 , astronomical data analysis software and systems xv , 351 , 112    bertin , e. , & arnouts , s.  1996 , , 117 , 393    bouy , h. , bertin , e. , moraux , e. , et al .",
    "2013 , , 554 , a101    flaugher , b. , diehl , h.  t. , honscheid , k. , et al .",
    "2015 , , 150 , 150    the gaia collaboration 2016 , , 595 , a2    gruen , d. , bernstein , g.  m. , jarvis , m. , et al .",
    "2015 , journal of instrumentation , 10 , c05032    han , i. , & gatewood , g.  d.  1995 , , 107 , 399    heymans , c. , rowe , b. , hoekstra , h. , et al .",
    "2012 , , 421 , 381    lsst science collaborations 2009 , arxiv:0912.0201    magnier , e. a. et al .",
    "2016 , arxiv:1612.05242    meyers , j.  e. , & burchat , p.  r.  2015 , , 807 , 182    plazas , a. , & bernstein , g.  2012 , , 124 , 1113    plazas , a.  a. , bernstein , g.  m. , & sheldon , e.  s.  2014 , , 126 , 750    platais , i. , wyse , r. , & zacharias , n. 2006 , , 118 , 107    press , w. h. , teukolsky , s. a. , vetterling , w. t. , & flannery , b. p. 2003",
    ", numerical recipes in c++ , cambridge university press    roodman , a. , reil , k. , & davis , c.  2014 , , 9145 , 914516    schneider , p. , van waerbeke , l. , & mellier , y. 2002 , , 389 , 729 .",
    "zacharias , n.  1996 , , 108 , 1135",
    "we wish to calculate the correlation functions of the curl - free and divergence - free components of the residual astrometric distortion field @xmath167 on each exposure , given an irregular , noisy sampling of this field by stellar detections .",
    "this is closely analagous to the e / b decompositions performed on the spin-2 polarization field of the cosmic microwave background and the spin-2 weak gravitational shear field in many cosmological investigations .",
    "we can derive the vector e / b decomposition by a very slight alteration to the shear - field derivation given by @xcite .",
    "we start with a 2d vector field @xmath231 .",
    "it is useful to work with a complex notation @xmath232 and complex derivatives @xmath233 we can write an arbitrary vector field as @xmath234 the curl - free e mode of  is sourced by @xmath235 and the divergence - free b mode by @xmath236    the 2-point correlation functions of  at separation vector are best posed in terms of the quantity @xmath237 , where @xmath238 is the position angle of .",
    "we define @xmath239^\\star \\right\\rangle     \\\\ \\label{ximinus } \\xi_-(r,\\beta ) + i\\xi_\\times(r,\\beta )   & = \\left\\langle v({\\mbox{${\\bf x}$ } } ) e^{-i\\beta }                                v({\\mbox{${\\bf x}$}}+{\\mbox{${\\bf r}$ } } )                                e^{-i\\beta } \\right\\rangle\\end{aligned}\\ ] ]    taking @xmath240 to be the fourier transform of @xmath241 , and the generation of @xmath241 to be a stationary stochastic process , we define the power spectra via @xmath242 @xmath243 must be real if the vector field statistics are invariant under 180  rotation , so we will assume this is true .",
    "the real part will vanish as well if the process generating  is invariant under parity flips .",
    "we will leave the real part as a free parameter .    by propagating the derivatives in through a fourier transform we can express the correlation functions ( [ xiplus ] ) and ( [ ximinus ] ) as @xmath244 \\\\",
    "\\xi_-(r,\\beta ) + i \\xi_\\times(r,\\beta ) & = \\int d\\alpha \\int k\\ , dk \\ , \\left|                   k^2 \\right| e^{-ikr \\cos(\\alpha-\\beta ) }                                           e^{2i(\\alpha-\\beta ) } \\left [                   p_{ee}(k,\\alpha ) - p_{bb}(k,\\alpha ) + 2i                                           p_{eb}(k,\\alpha)\\right]\\end{aligned}\\ ] ] where @xmath31 is the position angle of the wavevector . even though the atmospheric distortions are anisotropic , we will concern ourselves only with the angle - average quantities @xmath245 and the corresponding angle - averaged power spectra @xmath246 etc . if we average the preceding equations over @xmath238 , bessel s first integral yields @xmath247 \\\\ \\label{xim1 } \\xi_-(r )   & = -2\\pi \\int k\\ , dk \\ , k^2 j_2(kr )                   \\left [ p_{ee}(k ) - p_{bb}(k)\\right ] \\\\ \\label{xix } \\xi_\\times(r ) & = -4\\pi \\int k\\ , dk \\ , k^2 j_2(kr ) p_{eb}(k).\\end{aligned}\\ ] ] the last equation tells us that @xmath180 is produced purely by eb power .",
    "let us define pure - e and pure - b quantities @xmath248 where the last line combines with the order-2 hankel transform of .",
    "after making use of identities 9.1.27 and 11.4.42 from @xcite , this can be converted to @xmath249 \\right\\}.\\ ] ]    equations  ( [ xix ] ) and ( [ xieb2 ] ) allow us to produce measures of pure e , b , and cross - eb power from 2-point correlations constructed from all pairs of detections in a given exposure .",
    "in figure  [ ebcurves ] we plot @xmath176 and @xmath177 inferred for the astrometric residuals in each of 20 consecutive star - flat exposures ( after projecting out a cubic polynomial function of field coordinates from each exposure ) .",
    "it is clear that the astrometric residuals are indeed dominated by e modes ,  curl - free .",
    "figure  [ ebcorr ] plots the mean of @xmath250 and @xmath180 in another set of exposures , confirming that any divergence modes are very small . in further analysis",
    "we assumed @xmath181 such that we can more simply take @xmath179 .",
    "( upper curves ) and @xmath177 ( lower set ) derived via for each of a series of exposures , demonstrating that the astrometric errors are dominated by a curl - free vector field , as expected from atmospheric refraction fluctuations . ]"
  ],
  "abstract_text": [
    "<S> we characterize the ability of the dark energy camera ( decam ) to perform relative astrometry across its 500  mpix , 3-deg@xmath0 science field of view , and across 4 years of operation . </S>",
    "<S> this is done using internal comparisons of @xmath1 measurements of high-@xmath2 stellar images obtained in repeat visits to fields of moderate stellar density , with the telescope dithered to move the sources around the array . </S>",
    "<S> an empirical astrometric model includes terms for : optical distortions ; stray electric fields in the ccd detectors ; chromatic terms in the instrumental and atmospheric optics ; shifts in ccd relative positions of up to @xmath3 m when the decam temperature cycles ; and low - order distortions to each exposure from changes in atmospheric refraction and telescope alignment . </S>",
    "<S> errors in this astrometric model are dominated by stochastic variations with typical amplitudes of 1030  mas ( in a 30 s exposure ) and 510  coherence length , plausibly attributed to kolmogorov - spectrum atmospheric turbulence . </S>",
    "<S> the size of these atmospheric distortions is not closely related to the seeing . </S>",
    "<S> given an astrometric reference catalog at density @xmath4  from gaia , the typical atmospheric distortions can be interpolated to @xmath5  mas rms accuracy ( for 30  s exposures ) with @xmath6 coherence length in for residual errors . </S>",
    "<S> remaining detectable error contributors are 24  mas rms from unmodelled stray electric fields in the devices , and another 24  mas rms from focal plane shifts between camera thermal cycles . </S>",
    "<S> thus the astrometric solution for a single decam exposure is accurate to 36  mas ( @xmath7  pixels , or @xmath8  nm ) on the focal plane , plus the stochastic atmospheric distortion .    </S>",
    "<S> [ [ section ] ] </S>"
  ]
}