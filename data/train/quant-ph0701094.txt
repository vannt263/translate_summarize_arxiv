{
  "article_text": [
    "trapping and coherent manipulation of cold neutral atoms in microtraps near surfaces of atomic chips is a promising approach towards full control of matter waves on small scales @xcite .",
    "this field of atom optics is making rapid progress , driven both by the fundamental interest in quantum systems and by the prospect of new devices based on quantum manipulations of neutral atoms .",
    "lithographic and other surface - patterning processes nowadays allow to build complex atom chips which combine many traps , waveguides , and other elements , in order to realize controllable composite quantum systems @xcite as needed , e.g. , for the implementation of quantum information devices @xcite .",
    "such microstructured surfaces have been highly successful and form the basis of a growing number of experiments @xcite .",
    "the possibility to store , manipulate @xcite , and measure a single quantum system with extremely high precision has initiated great stimulus in various fields of research , ranging from atom interferometry @xcite , over quantum gates @xcite and resonant condensate transport @xcite , to microscopic magnetic - field imaging @xcite . in the vast majority of these schemes the wavefunction of the bose - einstein condensate , trapped in the vicinity of an atom chip ,",
    "is manipulated through variation of the magnetic confinement potential .",
    "this is achieved by changing the currents through the gate wires mounted on the chip or modifying the strength of additional radio - frequency fields @xcite .",
    "these external , time - dependent parameters thus provide a versatile control for wavefunction manipulations , and make atom chips attractive candidates for quantum control applications .",
    "consider the situation where one is aiming for an efficient wavefunction transfer from a given initial to a final desired state , possibly by passage through a series of other states , or for a conditional quantum gate where atoms have to interact with each other in a well - defined manner . here",
    "the question arises : how should one modify the control fields in order to achieve a most efficient transfer or coupling ?",
    "this problem was first tackled by hnsel et al .",
    "@xcite for a trapped - atom inteferometer setup where a dilute condensate should be split through variation of the confinement potential from a single to a double well , such that it ends up in the groundstate of the final double well potential .",
    "these authors devised a scheme that optimizes adiabatic transfer by minimizing transitions to excited states .",
    "in this paper we study quantum control of bose - einstein condensates in magnetic microtraps within the framework of optimal control theory ( oct ) . here , the objective of the control is quantified through a cost function , which is then minimized subject to the condition that the time dynamics of the condensate is governed by the gross  pitaevskii equation @xcite .",
    "we will show that optimal control theory provides a versatile tool for determining efficient control strategies , and is applicable for realistic confinement potentials , one- and two - dimensional problems , and nonlinearities in the condensate dynamics .",
    "optimal control theory is a mathematical device that allows for a general determination of efficient control strategies @xcite , and has found widespread applications for , e.g. , molecules @xcite , atoms @xcite , or semiconductors @xcite .",
    "we believe that there are a number of reasons that render oct ideal for quantum control of condensates in atom chips .",
    "first , it is only the cost function that determines the optimal control .",
    "there is no additional bias , such as , e.g. , in the adiabatic scheme where scattering losses are minimized throughout the whole transfer process , and consequently oct allows to explore a larger portion of the control space . in addition no knowledge of the stationary solutions of the gross - pitaevskii equation is required in oct , contrary to the adiabatic scheme where ground and excited states must be determined for every control configuration . since the optimal control corresponds to a minimum in the control space , the solutions are robust with respect to small fluctuations of the external parameters , which can never be avoided in real experiments . finally , decoherence effects , that also play a role in atom chips @xcite , can be naturally incorporated into oct calculations @xcite .",
    "we have organized our paper as follows . in sec .",
    "[ sec : theory ] we introduce to the realm of optimal quantum control , and derive the optimality system for condensate transport in atom chips . in sec .",
    "[ sec : results ] we present results for condensate splitting in simple and realistic confinement potentials .",
    "we demonstrate that our scheme is applicable for effective one- and two - dimensional geometries , and for nonlinearities in the condensate transport . finally , in sec .",
    "[ sec : summary ] we summarize and draw some conclusions .",
    "we consider a coherent ensemble of bose - einstein condensed atoms confined in a potential @xmath0 produced by a magnetic microtrap .",
    "@xmath1 is a control parameter that describes the variation of the confining potential when changing the external parameters , such as currents through the microtrap wires or frequency and strength of additional radio - frequency fields @xcite ( for details see below ) . through @xmath1",
    "it is possible to manipulate the bose - einstein condensate , e.g. , to split and reunite it by varying the potential from a single to a double well and vice versa .",
    "we assume that @xmath1 is a single - valued , real parameter , although different situations , e.g. , microtraps controlled by several parameters , could be treated equally well . in the following",
    "we shall assume for simplicity that @xmath1 can only take values between zero and one .",
    "the mean - field dynamics of the condensate is described by the gross  pitaevskii equation @xcite @xmath2 with @xmath3 a coupling constant related to the scattering length of the atoms . , and measure mass in units of the atom mass and length in units of micrometers . for @xmath4rb atoms",
    "the time and energy scales are then given by 1.37 milliseconds and 5.58 nano kelvins , respectively .",
    "] suppose that initially the system is in the groundstate @xmath5 for the potential @xmath6 . upon varying @xmath1 in the time interval @xmath7 $ ] from zero to one , the system will pass through a sequence of states and will end up in the final state @xmath8 . within the field of quantum control",
    "one is usually seeking for an optimized time evolution of @xmath1 that allows to channel the system from the initial state @xmath5 at time zero to a desired state @xmath9 at final time @xmath10 . in accordance to ref .",
    "@xcite , we assume @xmath9 to be the groundstate for the potential @xmath11 at time @xmath10 .",
    "let @xmath12 be the cost function that rates how good the final state @xmath8 matches the desired state @xmath9 , with @xmath13 the usual inner product .",
    "is normalized to one . in comparison to ,",
    "e.g. , ref .",
    "@xcite , where the wavefunction is normalized to the number of atoms @xmath14 in the condensate , the nonlinearity parameter @xmath3 in eq .",
    "is therefore assumed to incorporate @xmath14 . ]",
    "the first term on the right - hand side becomes zero for @xmath15 and maximal if final and desired state do not overlap .",
    "cost function used in ref .",
    "@xcite , in expression   the final wavefunction has to match the desired one only up to a global phase @xmath16 .",
    "this allows the substraction of constant values in the confinement potential @xmath17 , as discussed in more detail in appendix  [ app : phase ] , which proves particularly useful for magnetic confinement potentials with large energy offsets @xcite . ]",
    "the second term on the right - hand side favours control fields @xmath1 with a smooth time variation and is needed to make the quantum control problem well posed .",
    "@xmath18 is a weighting parameter that determines the importance of the two different control strategies of wavefunction matching and smooth control fields",
    ". we shall use small @xmath18 values throughout , such that the cost function @xmath19 is dominated by the first term .",
    "the control problem under consideration thus becomes the minimization of the cost function @xmath19 subject to the condition that @xmath20 fulfills the gross  pitaevskii equation .    within the field of optimal control theory ( oct ) one",
    "uses lagrange multipliers to turn this constrained minimization problem into an unconstrained one . for this purpose",
    "we define the lagrange function @xmath21 with the abbreviation @xmath22 , and @xmath23 the lagrange multiplier .",
    "we next utilize the fact that the lagrange function has a saddle point at the minimum of @xmath19 , i.e. all three derivatives @xmath24 , @xmath25 , and @xmath26 must be zero . performing usual functional derivatives in eq .",
    "we obtain after some variational calculation the following optimality system    [ eq : optimality ] @xmath27    which has to be solved together with the initial and terminal conditions    @xmath28    the right - hand side of eq",
    ".   follows from the functional derivative @xmath29 .",
    "notice that while the state equation with initial condition @xmath30 evolves forward in time , the adjoint equation with terminal condition is marching backwards .",
    "the adjoint equation describes the fluctuations of the system around @xmath20 . for this reason it is often referred to as the _ sensitivity equation_. incidentally , eq .   for the adjoint variable @xmath31 closely resembles the time - dependent bogoliubov ",
    "de gennes equation @xcite which usually serves as a starting point for the treatment of collective excitations . ]",
    "the control equation determines the optimal control .    in most cases of interest one",
    "is not able to directly guess @xmath1 such that eqs .",
    "( [ eq : oct.forward]c ) are simultaneously fulfilled , and one has to employ an iterative scheme . in this work",
    "we follow ref .",
    "@xcite and formulate a numerical algorithm that solves the optimality system ( [ eq : oct.forward]c ) for given initial and desired configurations @xmath5 and @xmath9 , respectively . to solve this problem , we apply a gradient - type minimization algorithm , which , starting from an initial guess for @xmath1 , determines a search direction for an improved control .",
    "we first solve eq .   with initial condition @xmath30 forwards in time .",
    "once the wavefunction @xmath8 at time @xmath10 is computed , the final condition for @xmath32 can be calculated from eq .   and the adjoint equation of motion is solved backwards in time .",
    "the gradient of @xmath33 with respect to @xmath34 becomes @xmath35 which gives the search direction for an improved control that minimizes @xmath19 . in the following we employ for the minimum search either the usual gradient method or the bfgs quasi - newton method @xcite .",
    "details of our solution scheme for the schrdinger - type equations are given in appendix [ app : details ] .",
    "we emphasize that the choice of our cost function is by no means unique .",
    "for instance , one could add an additional @xmath36 term , with another weighting parameter @xmath37 , to minimize the total energy within the transfer process and to favour adiabatic processes .",
    "another possibility would be to make @xmath18 in eq .",
    "time dependent and to penalize control variations more strongly at the beginning and end of the transfer process , such that @xmath1 is turned on and off sufficiently smooth , which might be beneficial for experimental implementations .",
    "alternatively , through a slight variant of the cost function the system can be forced to pass through a number of desired states @xcite or to acquire a certain phase  @xcite .",
    "one could also use a slight variant of our approach to obtain an optimization scheme for spatial geometries of waveguides and two - arm interferometers through which a condensate can propagate without creating excitations , as briefly outlined in appendix [ app : waveguide ] .",
    "( a ) cost function @xmath19 for different transfer times @xmath10 and for a linear time variation of @xmath34 ( solid line ) and optimized variations ( symbols ) .",
    "the dotted line shows results of a simulation where an additional @xmath38 term is added to the potential ( see text ) .",
    "the inset reports the optimized control fields @xmath1 for transfer times of 3 ( solid line ) , 6 ( dashed line ) , and 9 ( dotted line ) .",
    "( b ) time evolution of potential and wavefunction @xmath39 for linear @xmath34 and t=9 .",
    "( c  e ) density plot of @xmath39 for linear @xmath34 as a function of time and position , and for transfer times of ( c ) t=9 , ( d ) t=6 , and ( e ) t=3 . on the bottom of each panel",
    "we show the desired wavefunction ( dashed - dotted line ) and @xmath40 ( solid line ) .",
    "the solid lines in the density plots represent the equipotential lines of the confinement potential .",
    "( ce ) same as ( c  e ) but for optimized control fields . ]     for the single - well transfer processes shown in fig .",
    "[ fig : single ] .",
    "the solid lines show the equipotential lines for the wigner functions of the initial and final wavefunctions @xmath5 and @xmath8 , respectively . ]",
    "we first consider the more simple scenario of single atoms or dilute condensates within microtraps , and neglect the nonlinear terms in eqs .   and by setting @xmath41 .",
    "the influence of nonlinearities will be discussed at the end . in our optimal quantum control calculations",
    "we set @xmath42 ( smaller values of @xmath18 turned out to have no noticeable influence on the results ) and terminate the optimization loop after several tens to hundreds iterations when the gradient has become sufficiently small .",
    "we shall consider the scenario where a bose - einstein condensate is split into two parts through smooth variation of the magnetic confinement potential from a single to a double well @xcite . in secs .",
    "[ sec : single ] and b we simulate condensate transport through parabolic - like confinement potentials .",
    "these simplified case studies will allow us to grasp the essentials of our optimal control calculations .",
    "transport through realistic magnetic confinement potentials is discussed in sec .",
    "[ sec : haensel ] and d. finally , in sec .",
    "[ sec : nonlinear ] we investigate the influence of nonlinearities in the gross  pitaevskii equation .",
    "after successful splitting of the condensate the atoms in the two respective wells can be further transported by shifting the location of the minima . in our first example",
    "we will study such transport inside a single well .",
    "we will make the assumption that the confinement along @xmath43 and @xmath44 is much stronger than along @xmath45 , such that only the dynamics in @xmath45 direction has to be considered .",
    "we assume a potential of the form @xmath46 which has its minimum at @xmath47 . by varying within the time interval @xmath48 $ ] the control parameter from zero to one ,",
    "the potential minimum becomes shifted from zero to @xmath49 .",
    "our objective now is to seek for a time variation @xmath1 that brings the system from the groundstate @xmath5 of the harmonic oscillator centered at @xmath50 to the desired groundstate @xmath9 of the displaced harmonic oscillator centered at @xmath49 .",
    "although the above model allows under quite general conditions for an analytic solution , see , e.g. , ref .",
    "@xcite , the following analysis will turn out to be helpful when discussing the more complicated situation of condensate splitting .",
    "let us first consider a linear variation @xmath51 . figs .",
    "[ fig : single](b  e ) report results of our simulations for three selected tranfer times @xmath10 . panel ( b ) shows for @xmath52 the modulus of the wavefunction together with the confinement potential at different times , and panel ( c ) shows a density plot for @xmath39 of the same transfer process . at the bottom of panel ( c )",
    "we also plot the final wavefunction ( solid line ) which somewhat differs from the desired one ( dashed - dotted line ) .",
    "similar behavior is observed for ( d ) @xmath53 and ( e ) @xmath54 .",
    "finally , in panel ( a ) we report for the linear @xmath34-variation the cost function as a function of @xmath10 ( solid line ) , which is high for small values of @xmath10 and shows an oscillatory behavior with decreasing amplitude for longer transfer times @xmath10 .",
    "the decreasing amplitude is due to the fact that with increasing @xmath10 the time variation of potential becomes slower , and the system can follow almost adiabatically .",
    "the oscillations in the cost function are due to the oscillations of the wavefunction inside the single - well potential . to understand their origin , consider the extreme case where the position of the potential minimum is abruptly moved to @xmath49 at time zero , and the system is brought into a highly excited state where the groundstate wavefunction of the harmonic oscillator is displaced by @xmath49 with respect to the new minimum of @xmath55 .",
    "such displaced groundstates of the harmonic oscillator are known as _ coherent states _",
    "@xcite and have a dynamics reminiscent of classical oscillators .",
    "as time goes on , the system will start to oscillate with amplitude @xmath49 around its new equilibrium position .",
    "also the @xmath1 variation with finite speed can be described in terms of such coherent states , as evidenced by the fact that in figs .",
    "[ fig : single](b  e ) only the position but not the shape of the wavepacket changes with time . at later time . only for certain transfer times",
    "@xmath10 the particle will end up in rest position and with no force acting upon it .",
    "these times correspond to the minima of the cost function in fig .",
    "[ fig : single](a ) . ] to inquire more into this evolution we shall analyze the wigner function @xcite @xmath56 for the wavefunction , which is a mixed position - momentum distribution that has many , albeit not all , properties of a classical distribution function . the solid lines in fig .",
    "[ fig : wignersingle ] show contour lines of the wigner functions for the initial and final wavefunctions @xmath57 and @xmath58 , respectively .",
    "these coherent states are minimum uncertainty states with @xmath59 .",
    "the density plots in the different panels of the figure show the time integrated wigner function @xmath60 which provides information about the trajectory in phase space . at short transfer times ,",
    "[ fig : wignersingle](c ) , the system ends up in a state that is located close to @xmath49 but with a high momentum .",
    "thus , when the control parameter is kept fixed to @xmath61 at times beyond @xmath10 , the system will continue to oscillate around its new equilibrium position .",
    "this final state differs substantially from the desired groundstate @xmath9 of the displaced oscillator , and consequently has a rather high cost @xmath62 [ see also fig .  [",
    "fig : single](a ) ] . with increasing @xmath10 [ figs .",
    "[ fig : wignersingle](a , b ) ] the momentum of the coherent state decreases and thus @xmath62 becomes smaller .",
    "but for the double - well potential .",
    "the inset in panel ( a ) shows the optimized @xmath1 for @xmath53 ( solid line ) and @xmath52 ( dashed line ) . ( b ) time evolution of @xmath39 and @xmath63 for @xmath52 .",
    "( c , d ) density plot of @xmath39 for ( c ) @xmath52 and ( d ) @xmath53 .",
    "( bd ) same as ( b  d ) but for optimized control fields . ]",
    "we next turn to our optimal quantum control calculations . here",
    "we start from the linear @xmath51 function as a guess for the control , and successively improve @xmath1 according to the scheme described in the previous section . the symbols in fig .",
    "[ fig : single](a ) report the cost function for the optimized control fields : throughout @xmath62 can be drastically improved with respect to the linear @xmath34 variation .",
    "in particular for transfer times beyond say @xmath54 the final wavefunctions perfectly match the desired one . figs .",
    "[ fig : single](be ) report the wavefunction evolution for the optimized control fields depicted in the inset of panel ( a ) . for @xmath53 and @xmath52 the fields deviate only little from the linear dependence , and minor to moderate corrections of @xmath1 suffice to finally bring the system at @xmath49 to rest .",
    "this is also apparent from the wigner functions shown in fig .",
    "[ fig : wignersingle ] where the final state ( solid contour line ) is centered at @xmath49 and has zero momentum .",
    ", and consequently no guidance of the intermediate wavefunction trajectory is present . thus , if the linear control fields already work successfully , such as for @xmath53 in fig .  [ fig : single](d ) , the optimized @xmath1 and the corresponding transfer process are practically not altered , whereas somewhat stronger deviations can be observed for @xmath52 in fig .",
    "[ fig : single](c ) .",
    "we also emphasize again that the parabolic confinement potential is special in the sense that it can only change the position but not the shape of the initial wavepacket , and there thus exists a huge variety of different successful control stratgies . ] for @xmath54 the control strategy shown in panel ( e ) becomes noticeably modified : at early times the center of the parabolic confinement potential is quickly shifted and the system is put into a highly nonequilibrium state where it starts to oscillate from left to right .",
    "once it decelerates and reaches the right turning point , the position of the potential minimum is further shifted and the system becomes frozen in the groundstate of the shifted harmonic oscillator .",
    "note that only the quasi - newton bfgs method is capable of coming up with such control , whereas the more simple gradient scheme can not and is trapped in a sub - optimal extremum .",
    "we emphasize that all optimal transport processes discussed here rely on non - equilibrium coherent states , and the resulting transfer processes strongly differ from adiabatic schemes .",
    "finally , in panel ( a ) the dotted line reports that similar behavior is also found when an additional nonlinear potential term @xmath64 is added , with @xmath65 in the figure .",
    "also in this case optimal control theory gives control fields ( not shown ) that allow , in contrast to the linear @xmath34 variation , perfect transport .",
    "we next turn to the more complicated situation of wavefunction splitting . as a preliminary case study we consider the confinement potential @xmath66 which changes from a single - well potential for @xmath67 to a double - well potential with interwell distance @xmath68 for @xmath61 .",
    "potential is constructed such that it is continous and smooth .",
    "[ fig : double](b , c ) show results for a wavefunction splitting for @xmath52 and for a linear @xmath1 dependence .",
    "the wavefunction becomes split in the first stage of the time evolution , and is transported in the respective minima in the second stage of the transport process .",
    "contrary to the single - well transport , in this second stage also excited vibrational states of the harmonic oscillator that were populated during the initial splitting process are involved , as apparent from the varying shape of @xmath39 in the density plot of panel ( c ) .",
    "even more striking , the wavefunction shown in panel ( d ) for the fast transfer process with @xmath53 is split only incompletely , and part of the population remains localized in - between the two wells .",
    "correspondingly , the overlap with the desired groundstate @xmath9 of the @xmath55 potential is rather poor and the cost function shown in fig .",
    "[ fig : double](a ) ( solid line ) is high for small values of @xmath10 .",
    "with increasing @xmath10 the cost function again exhibits an oscillatory behavior with decreasing amplitude , indicating the onset of adiabatic transport .",
    "however , in contrast to the single - well case @xmath62 keeps a finite value at its minima , which is due to the population of excited vibronic states during splitting and the resulting lack of complete overlap with @xmath9 .     at the end of the transfer process [ figs .",
    "[ fig : double](b  d ) ] for linear @xmath34 variation and for transfer times of ( a ) @xmath52 and ( b ) @xmath53 .",
    "( a,b ) same as ( a , b ) but for optimized control fields .",
    "the interference pattern around the origin is a measure of the coherence properties of the split condensate . ]    the symbols in fig .",
    "[ fig : double](a ) report the cost function for the optimized process of wavefunction splitting . at short transfer times , say below @xmath69 , the optimized control strategies perform significantly better than the linear ones , but the overlap with the desired state is not perfect .",
    "we emphasize that these results do not exclude the possibility of more efficient transfer in regions of the control space that were not explored by our minimization scheme . for transfer times beyond @xmath53",
    "the cost function drops below a value of @xmath70 indicating the onset of efficient wavefunction splitting . figs .",
    "[ fig : double](b,c ) show the wavefunction evolution for @xmath52 , which is not drastically altered in comparison to the evolution for the linear scheme .",
    "a slight modification of the control function @xmath1 suffices to channel the system to the desired state at time @xmath10 .",
    "[ fig : wignerdouble ] shows the wigner functions @xmath71 at the end of the transfer processes . for the optimized control shown in panel ( a )",
    "it consists of two coherent - state features at the positions of the two minima of the double well potential ( see cross symbols ) , indicating that @xmath8 matches the respective single - well groundstates , and an interference pattern at position zero due to the superposition nature of the wavefunction @xmath8 @xcite .",
    "in contrast , the wigner function for the linear time evolution shown in panel ( a ) exhibits an asymmetric shape at the positions of the potential minima , that can be traced back to the superposition of ground and excited vibronic states within the respective minima . for the short transfer time of @xmath53 the optimized @xmath1 shown in the inset of fig .",
    "[ fig : double](a ) substantially differs from a linear behavior . as apparent from the corresponding wavefunction evolution shown in fig .",
    "[ fig : double](d ) , at early times the potential is quickly transformed from a single to a double well , and the system is thereby brought into a highly excited state .",
    "similar to the fast single - well transport described above , such states can be manipulated and transported on shorter timescales .",
    "indeed , the final stage of the transfer process is reminiscent of the final stage of wavefunction transport shown in fig .",
    "[ fig : single](e ) .",
    "rb atoms confined in the @xmath72 state .",
    "( a ) cost function for linear @xmath73 ( solid line ) , square - root @xmath74 ( dashed line ) , and optimized ( symbols ) variation of @xmath1 .",
    "the optimized @xmath19 is magnified in the left inset .",
    "the right inset reports the optimal @xmath1 for @xmath75 ms ( solid line ) and @xmath76 ms ( dashed line ) .",
    "( b ) contour plot of magnetic confinement potential as a function of @xmath34 .",
    "( c , d ) wavefunction evolution for linear variation of @xmath34 and transfer times of ( c ) @xmath76 ms and ( d ) @xmath75 ms .",
    "( c,d ) same as ( c , d ) but for optimized control . ]    in hnsel _",
    "_ @xcite the authors studied wavefunction splitting for a realistic magnetic microtrap .",
    "they devised a control scheme that favours adiabatic transport by minimizing , throughout the whole transfer process , excitations to excited states , and demonstrated that such approach can perform significantly better in comparison to more simplified control strategies . in this section",
    "we re - examine their scheme within the framework of optimal control theory .",
    "we use the same model parameters for the magnetic microtrap should be 30 g , rather than the 20 g given in eq .",
    "( 2 ) of ref .  @xcite , in order to match the distance of 35 @xmath77 m between trap and surface . ] where confinement along @xmath45 is provided by three parallel wires oriented along the @xmath43 direction , with an inter - wire distance of 20 @xmath77 m .",
    "the current @xmath78 through the central wire is opposite to the currents @xmath79 through the outer wires . introducing a current modulation by means of the control parameter @xmath34 via @xmath80 produces a magnetic confinement along @xmath45 that changes from a single well at @xmath67 to a double well at @xmath61 , as shown in fig .",
    "[ fig : haensch1d](b ) . for the linear variation of @xmath1 wavefunction splitting",
    "is shown in panels ( c ) and ( d ) for transfer times of 15 and 8 ms , respectively . in both cases",
    "the splitting is too fast to allow the system to become localized in the two mimima of the double well , and a significant portion of the population remains in - between the two wells .",
    "this is also apparent from the cost function shown in fig .",
    "[ fig : haensch1d](a ) ( solid line ) that reports large @xmath62 values over a wide range of transfer times , thus indicating an only incomplete splitting .",
    "the relation of our cost function to the excitation probability @xmath31 used in ref .",
    "@xcite is simply given by @xmath81 , assuming as usual only minor contributions from the second term in eq .  .",
    "the symbols in fig .",
    "[ fig : haensch1d](a ) show that optimal control theory again allows to strongly improve the cost function . in the inset we report that for transfer times beyond say 6 ms the cost function @xmath62 becomes significantly lower than the control penalization @xmath42 ( dotted line ) , and the final wavefunction @xmath20 matches almost perfectly the desired groundstate wavefunction of the final double - well potential . a comparison of the optimal control @xmath1 depicted in the second inset of panel ( a ) with the optimized control of hnsel _ et al .",
    "_ , see inset of fig .  6 of ref .",
    "@xcite , shows that both control strategies are of equal simplicity .",
    "we note that the optimal control fields of our approach perform better for very short transfer times , whereas for longer transfer times further analysis would be needed to pinpoint the advantages and disadvantages of the respective schemes .",
    "rb atoms confined in the @xmath72 state .",
    "( a ) magnetic confinement potential for different rf field strengths .",
    "( b ) linear ( dashed line ) and optimized control parameter @xmath1 as obtained from the solutions of the one - dimensional ( solid line ) and two - dimensional ( dotted line , indistinguishable from solid line ) schrdinger equation .",
    "( c ) density plot of wavefunction evolution @xmath82 for linear @xmath34 variation .",
    "( d ) same as ( c ) but for optimized @xmath1 .",
    "( e ) density plot of wavefunction evolution @xmath83 for optimized @xmath1 . ]    in our fourth case study we consider the radio - frequency double - well confinement proposed by lesanovsky _",
    "@xcite which is produced by a surface - mounted dc four - wire structure on an atom chip .",
    "such traps provide tight confinement even at large surface distances , allow for smooth potential transitions by variation of external parameters , such as rf field strengths , and are relatively robust against experimental fluctuations . in our calculations",
    "we use the same parameters as given in ref .",
    "@xcite ( see also eq .  (",
    "10 ) therein ) , and vary the rf field strength by means of the control parameter @xmath34 according to @xmath84 fig .",
    "[ fig : schmiedmayer](a ) shows the confinement along @xmath45 for three different rf field strengths corresponding to @xmath67 ( solid line ) , @xmath85 ( dashed line ) , and @xmath61 ( dashed - dotted line ) .",
    "contrary to the double - well potential discussed in the previous section , the magnetic confinement of lesanovsky and coworkers exhibits a substantial extension in @xmath43 direction , which calls for a solution of the two - dimensional schrdinger equation . in our work",
    "this is accomplished by using the split operator technique , as discussed in more detail in appendix [ app : details ] .",
    "[ fig : schmiedmayer](b  e ) show results of our optimal quantum control calculations for a quite short transfer time of @xmath86 ms . in panel",
    "( b ) we report the optimized @xmath1 functions as obtained from the solutions of the one - dimensional ( solid line ) and two - dimensional ( dotted line ) schrdinger equation . both @xmath1",
    "are almost identical . indeed , from fig .",
    "[ fig : schmiedmayer](e ) , which shows the wavefunction and confinement potential along @xmath43 , it is apparent that there is an only minor influence of @xmath87 on the confinement along @xmath43 , and consequently the wavefunction factorizes . the lower parts of panels ( c ",
    "e ) report the final ( solid line ) and desired ( dashed - dotted line ) wavefunctions .",
    "they differ in case of a linear variation of @xmath1 [ see panel ( c ) ] and coincide for the optimized control [ see panels ( d , e ) ] .",
    "thus , optimal quantum control allows to drastically outperform more simple control schemes .",
    "we have presented the results of fig .",
    "[ fig : schmiedmayer ] primarily to demonstrate our ability to also cope with two - dimensional problems .",
    "we believe that this will be important for the future analysis of more complicated potentials , such as ring - shaped interferometers @xcite . in our concluding remarks",
    "we will further elaborate on this point .     and effective potential @xmath88 for @xmath67 ( single well ) and different values of the nonlinearity parameter @xmath89 .",
    "( b ) density plot of the cost function @xmath19 as a function of transfer time @xmath10 and nonlinearity parameter @xmath89 , and for a linear @xmath34 variation .",
    "the contour at @xmath90 corresponds to the solid line shown in fig .",
    "[ fig : double](a ) .",
    "( c ) cost function as a function of @xmath89 and for transfer time @xmath75 . the solid line and symbols correspond to the linear and optimized variation of @xmath34 , respectively .",
    "( d , d ) density plot of @xmath39 for @xmath91 and @xmath75 , and for a ( d ) linear and ( d ) optimized @xmath34-variation . ]",
    "let us finally address the influence of the non - linear term in the gross  pitaevskii equation   on our optimal quantum control results .",
    "in doing so we shall re - examine the results of sec .",
    "[ sec : double ] for the simple double dot potential  , though similar results are also found for the more realistic potentials studied in secs .",
    "[ sec : haensel ] and [ sec : lesanovsky ] . consider the one - dimensional gross ",
    "pitaevskii equation @xmath92 where all details of the condensate density and the transversal confinement potential have been lumped into the single nonlinearity parameter @xmath89 .",
    "figure  [ fig : nonlinear](a ) shows the groundstate wavefunctions @xmath57 ( see appendix  [ app : details - nonlinear ] for computational details ) and the effective potentials @xmath93 for a few selected @xmath89 values and for @xmath67 . due to the repulsion of atoms in the condensate",
    "the wavefunction broadens and penetrates into the barrier .",
    "we first consider condensate splitting through linear variation of @xmath34 .",
    "[ fig : nonlinear](b ) shows a density plot of the corresponding cost function @xmath19 for different transfer times @xmath10 and nonlinearity parameters @xmath89 .",
    "note that for @xmath90 the cost function @xmath62 corresponds to the solid line shown in fig .",
    "[ fig : double](a ) . from the figure we observe that for small transfer times",
    ", say below @xmath69 , the condensate becomes splitted only very inefficiently and there is no substantial overlap of the final wavefunction with the desired one .",
    "with increasing @xmath10 the transfer process works more efficiently . generally speaking , for comparable values of @xmath62 larger nonlinearities @xmath89",
    "translate to longer transfer times .",
    "this is also apparent from fig .",
    "[ fig : nonlinear](c ) that reports @xmath62 as a function of @xmath89 for a fixed transfer time @xmath75 . the symbols in the figure show results of our optimal control calculations , based on the solutions of eqs .",
    "( [ eq : optimality]a  c ) , which demonstrate perfect condensate splitting within the whole @xmath89 regime under consideration .",
    "the corresponding time evolutions of the control parameters @xmath1 ( not shown ) are similar to those shown for @xmath90 in the inset of fig .",
    "[ fig : double](a ) .",
    "thus , optimal control theory allows to devise efficient control strategies even in the presence of moderate condensate nonlinearities .",
    "although the nonlinearity parameter influences the detailed time evolution of @xmath1 , it has no drastic impact on the essentials and qualitative features of our findings .",
    "similar conclusions apply to the results for other magnetic confinement potentials .",
    "in this paper we have only considered the mean - field gross - pitaevskii dynamics and have neglected bogoliubov - type quasiparticle excitations out of the condensate .",
    "this approximation is justified when the depletion of the initial gross - pitaevskii ground state due to quasiparticle excitations is sufficiently small @xcite . for",
    "given trap parameters , condensate density , and temperature , this can in principle be determined from the noncondensate normal and anomalous density matrices @xmath94 and @xmath95 , respectively , to be computed from the generalized gross - pitaeveskii equations @xcite .",
    "if @xmath94 and @xmath95 are initially negligible , they will remain negligible throughout the transfer process .",
    "otherwise the dynamics of the bogoliubov quasiparticles should be explicitly accounted for @xcite , which , within the framework of optimal control theory , could be done by introducing additional lagrange parameters for @xmath94 and @xmath95 .",
    "although such analysis is beyond the scope of the present paper , we expect from related studies @xcite that for this extended system oct will not only allow to control the condensate wavefunction but also its quasiparticle excitations .",
    "in conclusion , we have studied within the framework of optimal control theory and the gross - pitaevskii equation quantum control of bose - einstein condensates in magnetic microtraps , which can be controlled by external parameters such as wire currents or radio - frequency fields . for a variety of magnetic confinement potentials transport and wavefunction",
    "splitting of the condensate has been analyzed , and we have demonstrated that oct can drastically outperform more simple control strategies .",
    "in contrast to adiabatic transfer schemes , where the control fields in the time - dependent hamiltonian @xmath96 must be changed sufficiently smooth , such that transitions to excited states are suppressed throughout ,   must be fulfilled throughout the transfer process , with @xmath97 and @xmath98 denoting ground and excited state , respectively . ]",
    "oct allows to access excited states during the control .",
    "this opens the possibility to explore a larger portion of the control space , and enables high - fidelity quantum control even at short time scales .",
    "furthermore , neither the wavefunctions nor energies of ground and excited states are needed in oct calculations , which appears to be particularly advantageous for microtraps controlled by several external parameters , where the solution of the time - independent schrdinger or gross - pitaevskii equation for every configuration of the magnetic confinement potential would be a computationally heavy task .",
    "oct calculations for bose einstein condensates in magnetic microtraps are expected to be a useful and versatile tool for high - fidelity quantum control in a variety of applications .",
    "work supported in part by the austrian science fund fwf under projet p18136n13 and european union integrated project fet / qipc ` scala ' .",
    "let @xmath99 where @xmath100 is the minimum value of the potential @xmath17 and @xmath101 a potential with minimum zero .",
    "then , @xmath102 is a modified wavefunction with the global phase @xmath103 defined through @xmath104 inserting wavefunction into the gross - pitaevskii equation gives for the time derivative @xmath105 here , the last term on the right - hand side is canceled by a corresponding term on the right - hand side of eq .  , and we obtain the modified gross  pitaevskii equation @xmath106 it is identical to eq .   with the only exception that the constant contribution of the confinement potential @xmath107 is substracted .",
    "the solution @xmath108 equals @xmath20 up to the global phase @xmath103 .",
    "in this appendix we present details of our numerical solution schemes for @xmath20 and @xmath23 .",
    "let us first neglect the nonlinear terms in eqs .   and , by setting @xmath41 , and consider one spatial dimension .",
    "we discretize the time and space domain into a finite number @xmath109 and @xmath110 of subintervals of sizes @xmath111 and @xmath112 , respectively . a discrete state variable at time @xmath113 and position @xmath114",
    "is denoted by @xmath115 .",
    "the second spatial derivative @xmath116 is approximated by the finite difference expression @xmath117 together with periodic boundary conditions .",
    "for the time integration of @xmath20 and @xmath23 we use the crank - nicholson scheme @xmath118 the inversion of the matrix on the right - hand side is computationally simple owing to its tridiagonal shape , which results from the above finite difference scheme .",
    "the crank - nicholson scheme has the advantage that the time evolution is unitary and the norm of the wavefunction is thus conserved . in our calculations",
    "we typically use values of @xmath119 and @xmath120 .    for two space dimensions",
    "we again discretize the domain into equidistant subintervals and approximate the spatial derivatives by a corresponding five - point formula for the laplacian .",
    "however , the resulting hamiltonian matrix @xmath121 is no longer tridiagonal and the inversion in becomes computationally more costly .",
    "we thus employ the split - operator scheme @xcite .",
    "let @xmath122 , where @xmath10 is the kinetic term resulting from the discretization of the laplacian and @xmath123 the magnetic confinement potential .",
    "the wavefunction at later time is then computed according to @xmath124 which again is a norm - conserving scheme . here",
    ", the action of the matrix @xmath125 on the wavefunction can be easily computed by means of fast fourier transform ( fft ) and its inverse .",
    "space discretizations of typical dimension @xmath126 can be easily handled within such approach .",
    "finally , the second time derivative of @xmath127 needed in eq .",
    "is approximated by the finite difference expression @xmath128 . in our calculations",
    "we set @xmath42 .",
    "the split - operator technique can be also applied to the nonlinear gross  pitaevskii equation .",
    "we first replace in eq .",
    "the potentials @xmath123 by the effective potentials @xmath129",
    ". an apparent difficulty of the nonlinear term is the fact that the first exponetial on the right - hand side of eq .   invokes the wavefunction @xmath130 , through the effective potential @xmath131 , which is not at hand at this stage of computation .",
    "one can , however , easily check that the @xmath132 term only adds a phase to the different components @xmath133 .",
    "thus , the wavefunction modulus can be computed from @xmath134 once @xmath135 is known we can determine the effective potential @xmath131 , and finally compute the wavefunction at later time through @xmath136 this scheme again conserves the norm . as for the adjoint equation , we use a slight variant of the split - operator technique for the linear schrdinger equation , where the real and imaginary parts of the equation are separated to cope with the @xmath137 term .",
    "finally , for imaginary time steps @xmath138 we are able to compute the groundstate wavefunction of the gross  pitaevskii equation . here , we start from the groundstate of the linear schrdinger equation and evolve the system through eqs .",
    "( [ eq : splitoperator - norm],[eq : splitoperator - nonlinear ] ) in imaginary time , thus projecting out the groundstate wavefunction . after each iteration",
    "the wavefunction is normalized and the computation terminates when the wavefunction does no longer change significantly .",
    "in this appendix we briefly discuss how a slight variant of the oct scheme presented in sec .  [",
    "sec : theory ] would allow for an optimization of spatial geometries , such as waveguides or two - arm interferometers .",
    "the situation we have in mind is a scattering - type experiment , where the condensate , initially in state @xmath5 , enters through a waveguide into the scattering region where it becomes split .",
    "let us consider for simplicity a two - dimensional geometry and a condensate propagation along @xmath45 .",
    "the objective of our optimization thus becomes the choice of the confinement potential @xmath139 in the scattering region through which one can propagate the condensate without creating excitations .",
    "let @xmath9 denote the desired outgoing state of the scattering and @xmath140 the confinement potential parameterized through the space - dependent control parameter @xmath141 , with @xmath142 $ ] . instead of eq .",
    "we introduce the cost function @xmath143 where the last term favours a smooth spatial variation of the confinement potential @xmath123 . performing functional derivatives of the lagrange function",
    "we obtain again eqs .",
    "( [ eq : optimality]a , b ) , whereas has to be replaced by the space - dependent version @xmath144 with boundary conditions @xmath145 and @xmath146 . here",
    "the expression on the right - hand side involves an integration over the transversal coordinate @xmath43 and time .",
    "the solution of the resulting optimality system can be performed along the same lines as for its time - dependent counterpart ."
  ],
  "abstract_text": [
    "<S> transport of bose - einstein condensates in magnetic microtraps , controllable by external parameters such as wire currents or radio - frequency fields , is studied within the framework of optimal control theory ( oct ) . </S>",
    "<S> we derive from the gross  pitaevskii equation the optimality system for the oct fields that allow to efficiently channel the condensate between given initial and desired states . for a variety of magnetic confinement potentials we study </S>",
    "<S> transport and wavefunction splitting of the condensate , and demonstrate that oct allows to drastically outperfrom more simple schemes for the time variation of the microtrap control parameters . </S>"
  ]
}