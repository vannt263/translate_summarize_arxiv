{
  "article_text": [
    "the biochemical system of any organism can be represented mathematically by a network of chemicals ( nodes ) and reactions ( edges ) . to analyze these networks at genome scale ,",
    "systems biologists often use a linear optimization technique called flux balance analysis ( fba ) @xcite .",
    "flux balance requires that the sum of fluxes into and out of each node in the network be zero .",
    "this is equivalent to kirchhoff s current law in an electrical network .",
    "recent work has sought to augment flux balance analysis with kirchhoff s loop law for energy conservation as well as the second law of thermodynamics @xcite .",
    "the incorporation of thermodynamic constraints into genome - scale models has produced models that are biologically more realistic and reveal greater insight into the control mechanisms operating in these complex biological systems @xcite .",
    "see @xcite for a recent broad review of the application of thermodynamic constraints to biochemical networks . the second law of thermodynamics may be applied to each reversible elementary reaction by constraining net reaction flux to be in the direction of a negative change in chemical potential @xcite .",
    "constraints on net reaction flux can be incorporated within flux balance analysis as additional linear inequality constraints @xcite .",
    "software packages to quantitatively assign reaction directionality for genome - scale models of metabolism are available @xcite .",
    "in contrast to the addition of constraints arising from the second law of thermodynamics , the addition of energy conservation constraints has been problematic because the resulting equations are nonlinear and/or nonconvex .",
    "previous attempts required computing the global solution of a nonconvex continuous optimization problem @xcite , solving an np - hard problem @xcite , or solving a mixed integer linear program @xcite .",
    "mixed integer programs have unpredictable computational complexity .",
    "the purpose of this work is to show that kirchhoff s loop law and the second law of thermodynamics arise naturally from the optimality conditions of a convex optimization problem with flux balance constraints .",
    "furthermore , every set of reaction fluxes that satisfies kirchhoff s loop law and the second law of thermodynamics must be optimal for some instance of this problem .",
    "this suggests that there is an underlying variational principle operating in biochemical networks .",
    "our convex optimization formulation leads to polynomial - time algorithms @xcite for computing steady state fluxes that also satisfy energy conservation and the second law of thermodynamics .",
    "consider a simple electrical circuit consisting of current sources , batteries , and resistors , as illustrated in figure [ circuit ] .",
    "this is a linear resistive network with @xmath0 nodes and @xmath1 edges , where the node variables @xmath2 represent potentials and the edge variables @xmath3 represent flows ( or currents ) in the network .",
    "the circuit topology is defined by a node - edge incidence matrix @xmath4 , and properties of the network are encoded in a set of data vectors : @xmath5 is a vector of current sources , @xmath6 is a vector of batteries , and @xmath7 is a vector of resistances ( @xmath8 ) .    to solve for the voltages and currents in the circuit we use three fundamental laws : kirchhoff s current law ( kcl ) @xmath9 , kirchhoff s voltage ( or loop ) law ( kvl ) @xmath10 , and ohm s law @xmath11 ( where @xmath12 is",
    "a vector of voltages and @xmath13 is a positive - definite diagonal matrix ) .",
    "maxwell s minimum heat theorem @xcite is a variational principle that underlies this circuit .",
    "it seeks a set of currents that minimize the heat ( or power ) dissipated subject to kcl .",
    "this is the convex optimization problem @xcite @xmath14 where the node variables @xmath15 are lagrange multipliers for the equality constraints .",
    "the optimality conditions @xmath16 yield equations that enforce kvl and ohm s law , and the optimal variables @xmath17 and @xmath18 are a set of consistent potentials and currents for the circuit .",
    "biochemical networks are significantly more complicated than linear resistive networks",
    ". however , some of the same underlying network concepts apply @xcite . in this work",
    "we construct an optimization problem in a form similar to problem ( qp ) , where the potentials are lagrange multipliers for an equality constraint on the flow variables , and the optimality conditions of the problem yield equations that enforce kirchhoff s loop law and the second law of thermodynamics .",
    "previous work noted an `` analogy '' between lagrange multipliers and chemical potentials in flux balance analysis @xcite .",
    "the key limitation of that work , concerned with duality in linear optimization , is that the optimality conditions of a linear optimization problem can not enforce any relationship between net flux and change in chemical potential . in the present work ,",
    "we establish a quantitative relation between the lagrange multipliers and classical chemical potential for a nonlinear , yet convex , optimization problem in a framework consistent with classical thermodynamics .",
    "the mathematical representation of a biochemical network is the _ stoichiometric matrix _ @xmath19 . like @xmath20 above",
    ", @xmath21 is a sparse incidence matrix that encodes the network topology .",
    "however , biochemical networks , unlike linear resistive networks , are nonlinear networks or hypergraphs .",
    "that is , a single edge may link many nodes to many nodes , and the entries in @xmath19 , which are integer stoichiometric coefficients , are not confined to the set @xmath22 .",
    "each row of @xmath19 corresponds to an individual chemical compound , and each column of @xmath19 corresponds to an individual elementary reaction . in practice , @xmath23 and @xmath19 does not have full row - rank .",
    "a model of a system is called genome - scale if a large proportion of the system s genes are represented . in current genome - scale models of the metabolic system of _ e. coli _ , @xmath0 and @xmath1 are several thousand",
    ".    _ flux balance analysis _ ( fba ) computes a set of fluxes that satisfy steady state mass - conservation constraints and are optimal for a biological objective function @xcite .",
    "flux _ is a reaction rate ; it represents flow through the network and is analogous to current in an electrical circuit .",
    "we denote the net flux of the @xmath24th reaction by the variable @xmath25 .",
    "the concentration of the @xmath26th chemical in the network is denoted @xmath27 .",
    "a fundamental equation in flux balance analysis is the dynamic mass conservation equation  a differential equation relating the change in chemical concentration to reaction fluxes via the stoichiometric matrix : @xmath28 here @xmath29 is a vector of chemical concentrations and @xmath30 is a vector of net reaction fluxes .",
    "each row of this vector equation states that the rate of change in concentration for a chemical is the sum of fluxes that synthesize or degrade that chemical .",
    "so far we have considered net flux for a stoichiometric matrix of reactions , each of which conserves mass .",
    "a living biochemical system operates in a _",
    "nonequilibrium state _ @xcite and exchanges mass with its surroundings .",
    "this can be modeled by including exchange reactions that do not conserve mass .",
    "the model is augmented with a matrix @xmath31 and a corresponding set of _ exchange fluxes _",
    "@xmath32 , which are sources and sinks of chemicals and are analogous to current sources in an electrical network .",
    "in contrast to the columns of @xmath19 , each column of @xmath33 corresponds to a reaction that does not conserve mass .",
    "if we assume that the biochemical system is operating at a steady state , then the concentrations of chemicals within the system remain constant . thus , we have @xmath34 this equation is analogous to kirchhoff s current law in an electrical network .",
    "henceforth we assume that there exists a feasible solution @xmath35 for .",
    "ensuring the existence of a steady state flux is part of a quality control process during reconstruction of @xmath19 and @xmath33 from experimental literature @xcite .",
    "any reversible reaction @xmath36 may be split into two one - way reactions : forward ( @xmath37 ) and reverse ( @xmath38 ) . to distinguish between forward , reverse , and exchange reactions we split the augmented stoichiometric matrix into three components : @xmath39 $ ] . here",
    "@xmath19 contains all the columns corresponding to forward reactions , and @xmath40 contains all columns corresponding to the reverse reactions .",
    "the fluxes for these one - way reactions form the vectors @xmath41 and @xmath42 .",
    "the _ net flux _ is then @xmath43 .",
    "flux balance analysis has been implemented using linear programming @xcite .",
    "we take the flux balance analysis problem to be @xmath44 often , the lower bounds @xmath45 and upper bounds @xmath46 on the exchange fluxes come from laboratory measurements ( _ e.g. _  the uptake of glucose in a particular culture of _ e. coli _ ) .",
    "the vector @xmath47 is chosen to optimize a biological objective ( _ e.g. _  maximizing replication rate in unicellular organisms ) .",
    "note that flux balance analysis does not explicitly solve for @xmath41 and @xmath42 but rather @xmath48 .",
    "we now prove a lemma about alternative optimal solutions to problem ( fba ) .",
    "[ feaslemma ] if there is an optimal solution to problem ( fba ) , there is an optimal solution with strictly positive internal fluxes @xmath41 and @xmath42 .",
    "let @xmath49 be an optimal solution to problem ( fba ) .",
    "it could be the case that one or more components of @xmath50 or @xmath51 are zero ; that is , they are sitting on their lower bounds .",
    "we want to show that we can construct a new optimal solution @xmath52 with strictly positive fluxes @xmath53 and @xmath54 .",
    "to do this , let @xmath55 and @xmath56 , where @xmath57 is any positive scalar and @xmath58 is the vector of all ones .",
    "the internal fluxes @xmath59 are strictly positive , and the set of fluxes @xmath60 is feasible because @xmath61 and @xmath62 finally , the set of fluxes @xmath60 is optimal because it has the same objective value @xmath63 as the optimal solution @xmath49 .",
    "here we used the fact that the objective function in problem ( fba ) depends only on the exchange fluxes @xmath32 ; not on the internal fluxes @xmath41 and @xmath42 .",
    "flux balance analysis predicts fluxes that satisfy steady state mass conservation but not necessarily energy conservation or the second law of thermodynamics . whilst the domain of steady state mass conserved fluxes includes those that are thermodynamically feasible ,",
    "additional constraints are required in order to guarantee a flux that additionally satisfies energy conservation and the second law of thermodynamics .",
    "recent work has tried to add constraints based on kirchhoff s loop law and the second law of thermodynamics to problem ( fba ) @xcite . however , these constraints are problematic because they are nonlinear and nonconvex .",
    "we now describe these constraints .",
    "the loop law for chemical potentials in a biochemical network is directly analogous to kirchhoff s voltage law for electrical circuits .",
    "it states that the stoichiometrically weighted sum of chemical potentials around any closed loop of chemical reactions is zero .",
    "we explicitly model a chemical potential @xmath64 for each of the chemicals in the network , and we define the _ change in chemical potential _ for all internal reactions in the network as the vector @xmath65 where @xmath66 is the vector of chemical potentials .",
    "this ensures that kirchhoff s loop law is satisfied , as energy conservation requires that an injective relation exist between each row of @xmath19 and a chemical potential @xcite .",
    "it follows that the change in chemical potential around a stoichiometrically balanced loop will be zero .    assuming mass - action kinetics , constant temperature and pressure , and uniform spatial concentrations ( _ i.e. _  a well mixed system ) , it is known ( _ e.g. _  @xcite ) that the change in chemical potential may be expressed in terms of elementary one - way reaction rates as @xmath67 where @xmath68 denotes component - wise division of vectors , and @xmath69 is the gas constant multiplied by temperature .",
    "equation leads directly to a macroscopic ( long - term ) application of the second law of thermodynamics : @xmath70 which says that the net flux for each elementary reaction must be down a gradient of chemical potential , that the system must dissipate heat , and that entropy must increase as a result of work being done on the system through the exchange fluxes @xcite .",
    "the total heat dissipation rate of the biochemical system in a non - equilibrium steady state is given by @xmath71 .",
    "henceforth we consider each flux as a dimensionless quantity .",
    "dimensioned flux can be rendered dimensionless by division with a standard flux of the same dimensions .",
    "this standard may be defined according to a convenient timescale in the same way that a standard concentration may be defined according to a convenient abundance scale .    under the specified assumptions ,",
    "we now define a thermodynamically feasible flux .    for a network described by an augmented stoichiometric matrix @xmath72 $ ] with a given set of exchange fluxes @xmath32 , a set of _ thermodynamically feasible fluxes _",
    "is a pair of internal flux vectors @xmath73 that satisfy steady - state mass - balance , @xmath74 and for which there exists an underlying vector of chemical potentials @xmath66 that satisfies and : @xmath75",
    "we now present the main theorem of this paper .",
    "the theorem introduces a new convex optimization problem with the same flux balance constraints as problem ( fba ) but with a negative entropy objective function .",
    "it states that the thermodynamic constraints and hold at its unique solution .",
    "we use @xmath76 to denote a vector of ones .",
    "[ optimalthmfeas ] let @xmath77 be any set of optimal exchange fluxes from problem ( fba ) .",
    "define @xmath78 , and let @xmath79 be any vector in @xmath80 .",
    "the convex equality - constrained problem @xmath81 is then feasible , and its solution @xmath82 is a set of thermodynamically feasible internal fluxes .",
    "the combined vector @xmath83 is thermodynamically feasible and optimal for problem ( fba ) .",
    "the associated chemical potentials @xmath84 may be obtained from the optimal lagrange multiplier @xmath85 for the equality constraints according to @xmath86 .",
    "first note that the constraints @xmath87 are implied by the domain of the logarithm ; they have no associated lagrange multipliers . from lemma [ feaslemma ] , we know that if @xmath77 is optimal for problem ( fba ) and @xmath78 , there must be corresponding positive internal fluxes @xmath41 and @xmath42 that satisfy @xmath88 .",
    "therefore , problem ( ep ) with this choice of @xmath89 is always feasible .",
    "define the objective function as @xmath90 and note that it is strictly convex because @xmath91 is positive - definite for all @xmath92 , and it is bounded below .",
    "problem ( ep ) is thus a convex linear equality - constrained problem with a unique optimal solution @xmath93 ) that satisfies the optimality conditions @xmath94 for some vector @xmath18 ( which is not unique because @xmath19 has low row rank ) .",
    "subtracting from gives @xmath95 .",
    "taking @xmath96 we see from that @xmath97 is a pair of thermodynamically feasible fluxes with underlying chemical potentials @xmath84 for the exchange fluxes @xmath77 .",
    "the combined vector @xmath98 is feasible for problem ( fba ) , and is optimal because the objective @xmath99 is unchanged .    in summary , to compute an optimal solution @xmath83 to problem ( fba ) that is thermodynamically feasible , perform the following steps :",
    "solve problem ( fba ) to find an optimal exchange flux vector @xmath77 , form @xmath100 , choose a vector @xmath79 , and solve problem ( ep ) to find @xmath101 .",
    "since @xmath19 is row rank deficient , problem ( ep ) defines @xmath102 uniquely , but not the part of @xmath84 in the nullspace of @xmath103 . observe that if @xmath90 were a linear function of flux , one could not quantitatively relate flux to lagrange multipliers at optimality , as primal and dual variables do not appear in the same optimality condition .",
    "this is the key limitation of previous efforts to draw an analogy between chemical potential and lagrange multipliers to constraints in a linear optimization problem @xcite .",
    "note the structural similarity of problems ( qp ) and ( ep ) . in both cases",
    "the primal variables are the flows in the networks , the constraints impose kirchhoff s current law , and the dual variables for these constraints are the potentials in the network .",
    "there is a clear physical interpretation of the objective function in problem ( qp ) and a variational principle in operation .",
    "we believe there must also be a variational principle in operation in biochemical networks . in an abstract analysis of nonlinear resistive networks",
    "@xcite , one would refer to the objective in ( ep ) as the _ resistive content _ , as it is the sum of the areas under the _ constitutive relationships between flux and change in potential , for each reaction .",
    "_ from an information theoretic perspective , by maximizing the entropy of the internal fluxes , problem ( ep ) gives the most unbiased prediction @xcite of internal elementary fluxes , subject to mass - conservation constraints and boundary conditions imposed by exchange fluxes .",
    "the next theorem proves that if there is a set of thermodynamically feasible fluxes in a biochemical network , it _ must _ be the solution to an optimization problem in the form of problem ( ep ) .",
    "[ thmfeas ] every set of thermodynamically feasible fluxes",
    "@xmath41 , @xmath42 ( and chemical potentials @xmath84 ) is the solution ( and corresponding lagrange multiplier ) of a convex optimization problem in the form of problem ( ep ) .    we show how to choose the vector @xmath104 so that the given @xmath41 , @xmath42 , and @xmath84 are optimal .",
    "since @xmath41 and @xmath42 satisfy , they are feasible .",
    "from we have @xmath105 . letting @xmath106 we have @xmath107 and",
    "hence @xmath108 if we take @xmath109 , this gives @xmath110 which with are the optimality conditions for problem ( ep ) as given by .",
    "therefore , with @xmath111 , the given @xmath41 and @xmath42 are the optimal solution , with lagrange multiplier @xmath112 .",
    "the vector @xmath79 in problem ( ep ) is a set of free parameters .",
    "theorem [ optimalthmfeas ] tells us that regardless of the value of @xmath79 , ( ep ) has a unique solution that is a thermodynamically feasible flux .",
    "theorem [ thmfeas ] states that given any thermodynamically feasible flux there exists at least one associated vector @xmath79 .",
    "given the primal optimization problem ( ep ) it is instructive to consider the equivalent dual optimization problem , as its objective function lends insight into the properties of the optimal dual variables for the primal problem .",
    "by lemma  [ feaslemma ] , the constraints of problem ( ep ) have feasible solutions that are strictly positive .",
    "similarly , there must be feasible solutions that are finite , and these have finite objective values .",
    "hence the optimum of the strictly convex objective function of problem ( ep ) is finite and attainable .",
    "the lagrange dual of problem ( ep ) is the unconstrained convex optimization problem @xmath113    the dual for problem ( ep ) is derived in terms of the associated lagrangian , @xmath114 the dual function @xmath115 is the set of greatest lower bounds ( denoted @xmath116 for infimum ) of the lagrangian over the primal variables .",
    "equivalently , it is the set of least upper bounds ( denoted @xmath117 for supremum ) of the negative lagrangian : @xmath118 the supremum of the linear function @xmath119 is itself , and the other terms may be grouped to give @xmath120 the first supremum is attained when the partial derivative with respect to @xmath41 is zero : @xmath121 similarly for the second supremum , @xmath122 substituting  into gives the lagrange dual problem .",
    "the first and second derivatives of @xmath115 are @xmath123 where @xmath124 is a positive - definite diagonal matrix for all finite @xmath15 ( so that @xmath125 is negative semidefinite ) .",
    "the necessary first- and second - order conditions for a point @xmath126 to be an optimum are that @xmath127 and @xmath128 be negative semidefinite . with @xmath129 and @xmath130",
    "we see that @xmath131 satisfy the optimality conditions for both ( ep ) and ( dep ) .",
    "the dual objective @xmath115 offers a complementary insight into the meaning of our variational principle .",
    "the chemical potential is defined by @xmath86 . up to scalar multiplication",
    ", @xmath132 corresponds to the rate of work being done by the environment to maintain the system away from equilibrium @xcite .",
    "therefore , one may interpret the lagrange dual problem as a minimization of this rate of work , balanced against minimization of the sum of thermodyamically feasible forward and reverse fluxes .",
    "we note that minimization of a weighted linear combination of forward or reverse fluxes , where thermodynamic equilibrium constants are used as weighting factors , has previously been explored as an optimality principle for metabolic networks @xcite .    a comprehensive introduction to convex optimization",
    "is given in @xcite .",
    "problem ( ep ) is an example of a monotropic optimization problem @xcite .",
    "further discussion of such problems ( and duality ) can be found in @xcite .",
    "since problem ( ep ) is convex with a finite attainable optimum objective and linear constraints , it is known that strong duality holds @xcite . among other things , strong duality means that the values of the primal and dual objectives are equal at the optimum : @xmath133 . omitting the @xmath134s and using  , we have @xmath135 thus , @xmath136 also from  we have @xmath137 with @xmath107 , becomes @xmath138 on the left of is the rate of entropy production by the biochemical network , and on the right is the rate of work done by the environment to maintain the system away from equilibrium .",
    "their equality means that the rate at which heat is produced by chemical reactions equals the rate at which heat is dissipated into the environment , so the temperature of the system is time - invariant . in the thermodynamic literature , is known as the isothermal clausius equality @xcite , whereas from electrical network literature one may recognize as a biochemical version of tellegen s theorem .",
    "oster and desoer @xcite previously recognized that a reaction flux vector satisfying kirchhoff s current law and a chemical potential vector satisfying kirchhoff s voltage law is necessary and sufficient for tellegen s theorem to hold for a system of biochemical reactions .",
    "although tellegen s theorem holds irrespective of any constitutive relationship between flux and chemical potential , if one first assumes that unidirectional flux is a ( strictly ) monotonically increasing function of change in chemical potential , then one obtains flux and potential vectors satisfying kirchhoff s laws with a single ( strictly ) convex optimization problem @xcite .",
    "the challenge is to pose an optimization problem with optimality conditions that enforce a constitutive relationship between flux and potential matching established theory in chemical kinetics .",
    "from the optimality conditions for problem ( ep ) , observe that forward flux is a function of substrate and product chemical potentials . for an elementary reaction",
    ", one would expect that forward flux should depend only on substrate chemical potential(s ) and reverse flux should depend only on product chemical potential(s ) @xcite . according to mass action kinetics ,",
    "the rate of an elementary forward reaction only depends on a forward kinetic parameter and substrate concentration(s ) @xcite . in the objective of problem ( ep ) , for simplicity of exposition , consider replacing @xmath139 with @xmath140 .",
    "when @xmath141 is constrained to lie in the range of @xmath142 , this provides another mechanism for satisfying .",
    "here we show that one may choose @xmath143 such that mass action kinetics also holds .",
    "the chemical potential of the @xmath26th metabolite in dilute solution at constant temperature and pressure can be expressed as @xmath144 where @xmath145 is the standard chemical potential , @xmath146 is the molar concentration of the metabolite , and @xmath147 is a reference concentration that we define to be one molar .",
    "the standard chemical potential is therefore the chemical potential of a metabolite in a reference state .",
    "assume we are given forward and reverse elementary kinetic parameter vectors @xmath148 satisfying the thermodynamic feasibility condition @xmath149 for a particular standard chemical potential vector @xmath150 .",
    "mass action kinetics may be expressed as a set of vectors @xmath151 that satisfy @xmath152 where the stoichiometric matrix has been decomposed into the entry - wise difference between forward and reverse stoichiometric matrices , respectively @xmath153 , defined by @xmath154 with respect to the forward reaction direction , each column of * @xmath155 * contains the absolute value of the stoichiometric coefficient for each substrate , and the corresponding column of @xmath156 contains the stoichiometric coefficient for each product .",
    "given a consistent stoichiometric matrix and thermodynamically feasible kinetic parameters , it is still an important open question whether for all @xmath157 there exists a metabolite concentration vector @xmath158 satisfying steady - state mass action kinetics , namely @xmath159 ongoing work aims to establish the necessary and sufficient conditions for this to be so @xcite . nonetheless , assuming is satisfiable , there exist @xmath160 and @xmath161 such that @xmath162 and optimality conditions ",
    "become @xmath163 the optimal dual vector may then be equated with the negative of logarithmic concentration @xmath164 , leading to satisfaction of mass action kinetics in a non - equilibrium steady state .",
    "with problem ( ep ) and theorem [ optimalthmfeas ] we provide a new variational principle that enforces steady state mass conservation , energy conservation and the second law of thermodynamics for genome - scale biochemical networks .",
    "moreover , we prove that all thermodynamically feasible steady state fluxes are instances of problem ( ep ) for a different free parameter vector @xmath165 ( theorem [ thmfeas ] ) .",
    "the values of the free parameters influence the optimal forward and reverse fluxes through the relation @xmath166",
    ". varying @xmath79 may change @xmath167 and @xmath168 but not the fact that the corresponding solution is thermodynamically feasible and optimal for flux balance analysis .    to compute a thermodynamically feasible flux",
    "we must first choose a value for the vector @xmath79 .",
    "thus , there is some freedom left in the model .",
    "we see this property of the model as an advantage rather than a disadvantage , as thermodynamic feasibility is necessary but not sufficient for satisfaction of mass action kinetics @xcite . in the objective of problem ( ep )",
    ", one could replace @xmath139 by @xmath140 . assuming the existence of a mass action kinetic non - equilibrium steady state , section  [ sec : mass - action - kinetics ] demonstrates that this state corresponds to a particular choice of @xmath143 given particular kinetic parameters @xmath169 .",
    "kinetic parameters evolve , in the biological sense , subject to thermodynamic feasibility . even if @xmath143 could be chosen such that mass action kinetics holds , the actual @xmath169 that pertain to a particular organism s biochemical network would remain unknown .",
    "this problem is not particular to our modeling approach  it reflects a paucity of suitable enzyme kinetic data in biochemistry generally @xcite .",
    "in addition to the constraints in problem ( fba ) , flux balance analysis often includes extra inequalities on the net flux of internal reactions .",
    "it is not possible to incorporate explicit inequality constraints on net flux into problem ( ep ) because if any such inequalities were active at the optimum , the corresponding nonzero dual variables would appear in a modification of the optimality conditions  and interfere with satisfaction of the thermodynamic constraints that we know must hold . in practical applications of problem ( ep ) to genome - scale biochemical networks , for arbitrarily chosen @xmath79 , the omission of explicit bounds on net flux leads to a subset of net fluxes with directions opposite to that known biochemically .    at this point",
    ", one might think that an obvious application would be to search for free parameters @xmath170 , @xmath171 that minimize the euclidean distance between predicted and experimentally determined change in chemical potentials or fluxes . in _",
    "metabolism @xcite , for example , one can experimentally quantify transformed reaction gibbs energy ( _ in vivo _ change in chemical potential ) using quantitative measurement of absolute concentrations @xcite , combined with experimentally derived @xcite or group contribution estimates @xcite of standard transformed reaction gibbs energy .",
    "however , obtaining _ in vivo _ chemical potentials is not a limitation to validation of the practical utility of problem ( ep ) .",
    "even if one could find free parameters @xmath170 , @xmath171 corresponding to predicted chemical potentials close to experimental data , the corresponding fluxes might not satisfy mass action kinetics , which is known to hold for elementary chemical reactions .    a reliable algorithm for satisfaction of mass action kinetics at a non - equilibrium steady state",
    "is the subject of ongoing work @xcite . given a consistent stoichiometric matrix @xmath19 , for there to exist a non - equilibrium steady state it is necessary that the boundary condition be in the range of the stoichiometric matrix : @xmath157 . given thermodynamically feasible kinetic parameters in addition , it is an important open problem to establish if @xmath157 is also sufficient for there to exist a non - equilibrium steady state satisfying mass action kinetics .",
    "it may be that the set of feasible boundary conditions is a ( proper ) subset of the range of @xmath19 .",
    "in fact , the boundary condition obtained from flux balance analysis @xmath172 is an underdetermined parameter for problem ( ep ) because @xmath77 may not be unique , given the absence of strict convexity in problem ( fba ) .",
    "problem ( ep ) is well defined for any choice of linear objective function @xmath173 in problem ( fba ) .",
    "different values of @xmath47 simply yield different vectors @xmath78 .",
    "problem ( ep ) may also be used with other non - fba methods that calculate optimal exchange fluxes @xmath77 provided these methods yield a @xmath157 .",
    "we consider problem ( ep ) to represent a mapping between a set of parameters and the corresponding set of thermodynamically feasible fluxes and potentials .",
    "more precisely , when @xmath19 is row reduced ( to have full row rank ) , problem ( ep ) represents a single - valued surjective saddle point mapping @xcite between a parameter vector @xmath174 and the corresponding primal - dual optimal vector @xmath175 .",
    "that is , each parameter vector corresponds to a unique primal - dual optimal vector , and every optimal vector is associated with at least one parameter @xmath174 . moreover , under the same conditions",
    ", this saddle point mapping is locally lipschitz continuous @xcite .",
    "that is , the optimal vector of fluxes and potentials is smoothly perturbed by a smooth perturbation of the parameter vector .",
    "the properties discussed in the previous paragraph motivate future efforts to design algorithms for gradient - based optimization of the parameter vector .",
    "we envisage a convergent sequence of parametric convex optimization problems whose final optimum satisfies mass - action kinetic constraints .",
    "however , the necessary and sufficient conditions for convergence of a sequence of parametric convex optimization problems is still an active research area within convex analysis .",
    "exploitation of the properties of problem ( ep ) may provide the route to such an algorithm .",
    "the computational tractability of _ linear _ flux balance analysis ( problem ( fba ) ) is one of the key reasons for its widespread use as a genome - scale modeling tool .",
    "the theorems of this paper provide the theoretical basis for efficiently computing thermodynamically feasible fluxes , even for the largest genome - scale biological networks @xcite .",
    "in particular :    * problem ( ep ) is convex and includes only linear constraints .",
    "it is feasible whenever problem ( fba ) is feasible , and its optimal solution is then unique . *",
    "efficient polynomial - time algorithms @xcite exist for solving convex optimization problems of this form , based on interior methods @xcite .",
    "* for both ( fba ) and ( ep ) , these algorithms are guaranteed to return an optimal solution , or a certificate that the original problem is infeasible .    in practice , computing thermodynamically feasible fluxes using _ convex _ flux balance analysis described herein should take no longer than performing _ linear _ flux balance analysis .",
    "although the ultimate value of this work lies in what is accomplished with it in future biological studies , we believe it makes an important step forward by providing the first computationally tractable method for implementing energy conservation and the second law of thermodynamics for genome - scale biochemical networks in a non - equilibrium steady state .",
    "we also establish , in an exact manner , the duality relationship between reaction rates and chemical potentials .",
    "furthermore , our theorems extend to any potential network where flux balance holds and the change in potential can be written as a difference in a monotone function of fluxes : @xmath176 , where @xmath177 is monotone @xcite .",
    "these potential networks admit a convex optimization model whose solution is unique and whose potentials are lagrange multipliers for the flux balance constraint .",
    "we would like to acknowledge invaluable assistance from ines thiele and some helpful thermodynamic discussions with hong qian .",
    "we would also like to thank two anonymous reviewers for their constructive comments and for directing us to the 1951 paper by w. millar @xcite .",
    "this project was supported by the u.s .",
    "department of energy ( office of advanced scientific computing research and office of biological and environmental research ) as part of the scientific discovery through advanced computing program , grant de - sc0002009 .",
    "akle , s. , dalal , o. , fleming , r. m.  t. , saunders , m.  a. , taheri , n.  a. & ye , y. 2011__. existence of positive equilibria for mass conserving and mass - action chemical reaction networks with a single - terminal - linkage class .",
    "bennett , b.  d. , kimball , e.  h. , gao , m. , osterhout , r. , van  dien , s.  j. & rabinowitz , j.  d. 2009__. absolute metabolite concentrations and implied enzyme active site occupancy in _",
    "escherichia coli_. nat chem biol , 5 ( 8) , 5939 .",
    "fleming , r. m.  t. , thiele , i. & nasheuer , h.  p. 2009__.",
    "quantitative assignment of reaction directionality in constraint - based models of metabolism : application to _",
    "escherichia coli_. biophys chem , 145 ( 2 - 3 ) , 4756 .",
    "nagrath , d. , avila - elchiver , m. , berthiaume , f. , tilles , a.  w. , messac , a. & yarmush , m.  l. 2007__. integrated energy and flux balance based multiobjective framework for large - scale metabolic networks .",
    "35 ( 6 ) , 863885 .",
    "schellenberger , j. , que , r. , fleming , r. m.  t. , thiele , i. , orth , j.  d. , feist , a.  m. , zielinski , d.  c. , bordbar , a. , lewis , n.  e. , rahmanian , s. , kang , j. , hyduk , d. & palsson , b.   .",
    "2011_b_. quantitative prediction of cellular metabolism with constraint - based models : the cobra toolbox v2.0 .",
    "nat prot , 6 ( 9 ) , 12901307 .        thiele , i. , jamshidi , n. , fleming , r. m.  t. & palsson , b.   .",
    "2009__. genome - scale reconstruction of _",
    "s transcriptional and translational machinery : a knowledge - base , its mathematical formulation , and its functional characterization .",
    "plos comput biol , 5 ( 3 ) , e1000312 ."
  ],
  "abstract_text": [
    "<S> we derive a convex optimization problem on a steady - state nonequilibrium network of biochemical reactions , with the property that energy conservation and the second law of thermodynamics both hold at the problem solution . </S>",
    "<S> this suggests a new variational principle for biochemical networks that can be implemented in a computationally tractable manner . </S>",
    "<S> we derive the lagrange dual of the optimization problem and use strong duality to demonstrate that a biochemical analogue of tellegen s theorem holds at optimality . </S>",
    "<S> each optimal flux is dependent on a free parameter that we relate to an elementary kinetic parameter when mass action kinetics is assumed .    </S>",
    "<S> keywords : constraint - based modeling , flux balance analysis , thermodynamics , convex optimization , entropy function </S>"
  ]
}