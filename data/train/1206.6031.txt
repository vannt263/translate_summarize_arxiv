{
  "article_text": [
    "photoelectron spectroscopy is a widely used technique to analyze the electronic structure of complex systems  @xcite .",
    "the advent of intense ultra - short laser sources has extended the range of applicability of this technique to a vast variety of non - linear phenomena like high - harmonic generation , above - threshold ionization ( ati ) , bond softening and vibrational population trapping  @xcite .",
    "furthermore , it turned attosecond time - resolved pump - probe photoelectron spectroscopy into a powerful technique for the characterization of excited - states dynamics in nano - structures and biological systems  @xcite .",
    "angular - resolved ultraviolet photoelectron spectroscopy is by now established as a powerful technique for studying geometrical and electronic properties of organic thin films  @xcite .",
    "time - resolved information from streaking spectrograms  @xcite , shearing interferograms  @xcite , photoelectron diffraction  @xcite , photoelectron holography  @xcite , etc .",
    "hold the promise of wavefunction reconstruction together with the ability to follow the ultrafast dynamics of electronic wave - packets .",
    "clearly , to complement all these experimental advances , and to help to interpret and understand the wealth of new data , there is the need for ab - initio theories able to provide ( time - resolved ) photoelectron spectra ( pes ) and photoelectron angular distributions ( pad ) for increasingly complex atomic and molecular systems subject to arbitrary perturbations ( laser intensity and shape ) .",
    "photoelectron spectroscopy is a general term which refers to all experimental techniques based on the photoelectric effect . in photoemission experiments",
    "a light beam is focused on a sample , transferring energy to the electrons . for low light intensities",
    "an electron can absorb a single photon and escape from the sample with a maximum kinetic energy @xmath0 ( where @xmath1 is the photon angular frequency and @xmath2 the first ionization potential of the system ) while for high intensities electron dynamics can be interpreted considering a three - step model  @xcite .",
    "this model provides a semiclassical picture in terms of ionization followed by free electron propagation in the laser field with return to the parent ion , and rescattering .",
    "such rescattering processes are the source of many interesting physical phenomena . in the case of long pulses , for instance",
    ", multiple photons can be absorbed resulting in emerging kinetic energies of @xmath3 ( where @xmath4 is the number of photons absorbed , @xmath5 is the ponderomotive energy and @xmath6 the electric field amplitude ) forming the so called ati peaks in the resulting photoelectron spectrum . in all cases",
    "the observable is the escaping electron momentum measured at the detector .    in general ,",
    "the interaction between electrons in an atom or molecule and a laser field is difficult to treat theoretically , and several approximations are usually performed .",
    "clearly , a full many - body description of pes is prohibitive , except for the case of few ( one or two ) electron systems  @xcite . as a consequence ,",
    "the direct solution of the time dependent schrdinger equation ( tdse ) in the so - called single - active electron ( sae ) approximation is a standard investigation tool for many strong - field effects in atoms and dimers and represents the benchmark for analytic and semi - analytic models  @xcite .",
    "perturbative approaches based on the standard fermi golden rule are usually employed . for weak lasers , plane wave methods  @xcite and the independent atomic center approximation  @xcite have been applied , while in the strong field regime , floquet theory , the strong - field approximation  @xcite and semiclassical methods  @xcite are routinely used .    from a numerical point of view , it would be highly desirable to have a pes theory based on time - dependent density functional theory ( tddft )  @xcite where the complex many - body problem is described in terms of a fictitious single - electron system .",
    "for a given initial many body state , tddft maps the whole many - body problem into the time dependence of the density from which all physical properties can be obtained .",
    "the method is in principle exact , but in practice approximations have to be made for the unknown exchange - correlation functional as well as for specific density - functionals providing physical observables .",
    "this latter issue is much less studied than the former , and to the best of our knowledge a formal derivation of momentum - resolved pes from the time dependent density has not been performed up to now . in any case ,",
    "several works were published addressing the problem of single and multiple ionization processes within tddft .",
    "for example , ionization rates were calculated for atoms and molecules  @xcite , and tddft with the sampling point method ( spm ) has been employed in the study of pes and pad for sodium clusters  @xcite .    in this work , besides presenting a formal derivation of a photoelectron orbital functional , we report on a new and physically sound scheme to compute pes of interacting electronic systems in terms of the time - dependent single electron kohn - sham ( ks ) wavefunctions .",
    "the scheme relies on geometrical considerations and is based on a splitting technique  @xcite .",
    "the idea is based on the of partitioning of space in two regions ( see fig .  [",
    "fig : geometrical_scheme ] below ) : in the inner region , the ks wave function is obtained by solving the tddft equations numerically ; in the outer region , electrons are considered as free particles , the coulomb interaction is neglected , and the wavefunction is propagated analytically with only the laser field .",
    "electrons flowing from the inner region to the outer region are recorded and coherently summed up to give the final result .",
    "in addition to the adaptation of the traditional splitting procedure to tddft , we propose a novel scheme where electrons can seamlessly drift from one region to the other and spurious reflections are greatly suppressed .",
    "this procedure allows us to reduce considerably the spatial extent of the simulation box without damaging the accuracy of the method .",
    "the rest of this article is organized as follows . the formalism for describing photoelectrons in tddft",
    "is delineated in sect .",
    "[ sec : theory ] . in order to make contact with the literature",
    ", we first give a brief introduction to the state - of - the - art for the ab - initio calculation of pes for atomic and molecular systems . in sect .",
    "[ sub : phase - space_interpretation ] we introduce the geometrical approach in the context of quantum phase - space .",
    "the phase - space approach is then derived in the case of effective single - particle theories like tddft in sect .",
    "[ sub : phase_space_tddft ] . in sect .  [ sub : the_mask_method ] we introduce the mask method , an efficient propagation scheme based on space partitioning .    three applications of the mask method are presented in sect .  [ sec : applications ] .",
    "one application deals with the hydrogen atom and illustrates the different mask methods in a simple one - dimensional model also in comparison with the sampling point method  @xcite .",
    "the above threshold ionization of three - dimensional hydrogen is examined and compared with values from the literature . in the second application",
    "we illustrate pads from randomly oriented nitrogen molecules in a strong near - infrared ultra - short laser pulse .",
    "comparison with the experiment and molecular strong - field approximation is discussed  @xcite .",
    "the third application of the method regards helium-(i ) ( wavelength 58 nm ) pads for oriented carbon monoxide and benzene .",
    "results are discussed in comparison with the plane wave approximation . finally , in sect .",
    "[ sec : conclusions ] we discuss the results and present the conclusions .",
    "all our numerical calculations were performed with the real - time , real - space tddft code ` octopus `  @xcite , freely available under the gnu public license .",
    "atomic units are used throughout unless otherwise indicated .",
    "in order to put in perspective the results of the present article , we will give a brief introduction on the status of the principal techniques available for ab - initio pes calculations .",
    "we start our description with the methods employed to study one - electron systems .    for one - electron systems pes can be calculated exactly from the direct solution of the tdse .",
    "several methods have been employed to extract pes information from the solution of the tdse .",
    "the most direct and intuitive way is via direct projection methods where the pes is obtained by projecting the wave function at the end of the pulse onto the eigenstates describing the continuum .",
    "these eigenstates are extracted through the direct diagonalization of the hamiltonian without including the interaction with the field .",
    "the momentum probability distribution can then be easily obtained from the fourier transform of the continuum part of the time - dependent wavefunction@xcite .",
    "another approach , that avoids the calculation of the full continuum spectrum , involves the analysis of the exact wavefunction @xmath7 after the laser pulse via a resolvent technique  @xcite . in this case , the energy resolved pes is given by the direct projection on out - going wavefunctions with @xmath8 , where @xmath9 denotes an out - going ( unbound ) electron of energy @xmath10 of the laser - free hamiltonian , and @xmath11 is the corresponding projection operator that can be conveniently approximated  @xcite .",
    "normally , one needs accurate wave functions in a large space domain to obtain the correct distribution of the ejected electrons .",
    "this is because the unbound parts of the wave packet spread out of the core region , and conventional expressions for the transition amplitude need these parts of the wave function .",
    "solving the tdse within all the required volume in space can easily become a very difficult computational problem .",
    "several techniques were developed during the years to solve the problem . for simple cases these difficulties",
    "can be overcome by the use of spherical coordinates .",
    "geometrical splitting techniques have also been employed  @xcite .",
    "furthermore , formulations in the kramers - henneberger frame of reference  @xcite and in momentum - space  @xcite led to calculations with remarkable high precision .",
    "recently a promising surface flux method has also been proposed  @xcite .",
    "the exact solution of the tdse in three dimensions for more than two electrons is unfeasible and the limit rises to four electrons for one - dimensional models  @xcite . due to this limitation basically",
    "all ab - initio calculations for multi - electron systems are preformed under the sae approximation . in the sae",
    "only one electron interacts with the external field while the other electrons are frozen  @xcite , and the tdse is thus solved only for the active electron .",
    "this approximation has been successfully employed in several photoemission studies for atoms and molecules in strong laser fields  @xcite .",
    "however , the failure of this simple model to describe multi - electron ( correlation ) effects calls for better schemes  @xcite .",
    "the inclusion of exchange - correlation effects for a system of many interacting electrons can be achieved within tddft while keeping the simplicity of working with a set of time - dependent ( fictitious ) single - particle orbitals . in spite of transferring all the many - body problem into an unknown exchange - correlation functional",
    ", the lack of a density functional providing the electron emission probability is a major limitation for a direct access to photoelectron observables from the time evolution of the density ( note that , in spite of the runge - gross theorem  @xcite stating that all observables are functionals of the time dependent density , in practice we know few observables that can be written in terms of the time - dependent density , one example being the absorption spectra ) .",
    "there has been some attempts to describe pes and multiple ionization processes with tddft in the standard adiabatic approximation  @xcite .",
    "all these works use boundary absorbers to separate the bound and continuum part of the many - body wavefunction .",
    "the emission probability is then correlated with the time dependence of the number of bound electrons .",
    "an alternative and simple scheme is provided by the spm  @xcite . here",
    "the idea is to record single - particle wavefunctions in time at a fixed sampling point @xmath12 away from the core .",
    "the time fourier transform of the wavefunction recorded at @xmath12 represents the probability of having an electron in @xmath12 with energy @xmath10 .",
    "the probability to detect one electron with energy @xmath10 in @xmath12 is then given by the sum over all occupied orbitals : @xmath13 this method is easy to implement , can be extended to give also angular information  @xcite , and is also clearly applicable to the tdse in the sae .",
    "however , it lacks formal derivation as it is directly based on kohn - sham wavefunctions without a direct connection to the many - body state .",
    "furthermore , it is strongly dependent on the position of the sampling point and the minimum distance .",
    "this distance sometimes turns out to be quite large in order to avoid artifacts , and is strongly dependent on the laser pulse properties .",
    "we discuss further details concerning this method in sect .",
    "[ sub : multi_photon_ionization_1d ] .    in the following",
    "we present an alternative method inspired by geometrical splitting and derive it from a phase - space point of view .",
    "the method can be naturally converged by increasing the size of the different simulation boxes .",
    "an intuitive description of photoelectron experiments can be obtained resorting to a phase - space picture .",
    "experimental detectors are able to measure photoelectron velocity with a certain angular distribution for a sequence of ionization processes with similar initial conditions .",
    "the quantity available at the detector is therefore connected to the probability to register an electron with a given momentum @xmath14 at a certain position @xmath15 . from this consideration",
    "it would be tempting to interpret photoemission experiments with a joint probability distribution in the phase - space @xmath16 .",
    "such a classical picture however conflicts with the fundamental quantum mechanics notion of the impossibility to simultaneously measure momentum and position , and prevents us from proceeding in this direction . a link between the classical and quantum picture",
    "is needed beforehand .    in order to make a connection to a microscopic description it turns out to be convenient to extend the classical concept of phase - space distributions to the quantum realm .",
    "a common prescription comes from the wigner transform of the one - body density matrix with respect to the center of mass @xmath17 and relative @xmath18 coordinates . the @xmath19-dimensional ( here and after @xmath20 ) transform is defined as @xmath21 with @xmath22 being the one - body density matrix , and @xmath23 the @xmath24-body wavefunction of the system at time @xmath25 .",
    "the wigner function defined above is normalized and its integral over the whole space ( momentum ) gives the probability to find an electron with momentum @xmath14 ( position @xmath26 ) .",
    "as the uncertainty principle prevents the simultaneous knowledge of position and momentum , @xmath27 can not be a proper joint distribution .",
    "moreover it can assume negative values due to nonclassical dynamics .",
    "nevertheless the wigner function @xmath28 constitutes a concept close to a probability distribution in phase space @xmath29 compatible with quantum mechanics .",
    "is the interaction region , @xmath30 is the volkov propagation region and @xmath31 is the overlap region where @xmath32 and @xmath33 mix under the mask function.,width=325 ]    the quantum phase - space naturally leads to a geometrical interpretation of photoemission",
    ". one could think to divide the space in two regions @xmath34 and @xmath30 as in fig .",
    "[ fig : geometrical_scheme ]  ( a ) , where region @xmath30 represents the region where detectors are positioned and @xmath34 is defined as the complement of @xmath30 . in this picture , pes can be seen as the probability to have an electron with given momentum in @xmath30 .",
    "it is then natural to define the momentum - resolved photoelectron spectrum as @xmath35 where the spatial integration is carried out in region @xmath30 , and the limit @xmath36 assures that region @xmath30 contains all photoelectron contributions . from the knowledge of the momentum - resolved pes [ cf .",
    "( [ eq : pes_wigner ] ) ] one can access several different quantities by simple integration . for instance , in three dimensions ( @xmath37 ) the energy - resolved pes is obtained integrating over the solid angle @xmath38 : @xmath39 and the photoelectron angular distribution in the system reference frame is given by , @xmath40    in spite of giving an intuitive picture of pes , eq .",
    "( [ eq : pes_wigner ] ) is not suited for direct numerical evaluation since it requires the knowledge of the full one - body density matrix in the whole space . in the next section",
    "we will make a contact with effective single particle theories like tddft to overcome the limitations due to the knowledge of the many - body wavefunction . in order to avoid integration over the whole space",
    "an efficient evolution scheme is presented in sect .",
    "[ sub : the_mask_method ] .",
    "tddft is an effective single particle theory where the many - body wavefunction is described by an auxiliary single slater determinant @xmath41 built out of kohn - sham orbitals @xmath42 @xcite . in order to simplify the notation",
    ", we drop the explicit time dependence from the wavefunctions and assume that the following equations are written in the limit @xmath36 as prescribed by eq .",
    "( [ eq : pes_wigner ] ) .",
    "being represented by a single determinant , the one - body kohn - sham density matrix is given by @xmath43 where the sum in carried out over all occupied orbitals .",
    "performing a decomposition of each orbital according to the partition of fig .",
    "[ fig : geometrical_scheme ]  ( a ) we obtain @xmath44 where @xmath45 is the part of the wavefunction describing states localized in @xmath34 and @xmath46 is the ionized contribution measured at the detector in @xmath30 .",
    "the one - body density matrix can now be accordingly decomposed as a sum of four terms @xmath47.\\end{gathered}\\ ] ] from eq .",
    "( [ eq : one_dens_tddft ] ) we can build the ks wigner function defined in eq .",
    "( [ eq : wigner ] ) and obtain the momentum - resolved probability distribution by inserting it into eq .",
    "( [ eq : pes_wigner ] ) .",
    "we note that this step involves a non - trivial approximation , namely that the ks one - body density matrix is a good approximation to the fully interacting one in region b. this is , however , much milder than the assumption that the kohn - sham determinant is a good approximation to the many - body wavefunction in region b , as it is done , e.g. , in the spm .",
    "the final result is a sum of four overlap double integrals that can be simplified further .",
    "for a detailed calculation we refer to appendix  [ sec : overlap_integral ] . the first overlap integral , containing a product of two functions localized in @xmath34 [ cf .",
    "( [ eq : one_dens_tddft ] ) ] , is zero due to the spatial integration in @xmath30 .",
    "the two next overlap integrals , containing mixed products of wavefunctions localized in @xmath34 and @xmath30 , can be reduced by increasing the size of region @xmath34 .",
    "assuming @xmath34 to be large enough to render these terms negligible the only integral we are left with is the one containing functions in @xmath30 , leading to @xmath48 the approximation sign @xmath49 is a reminder for the error committed in discarding the mixed overlap integrals . since the probability of finding an ionized electron in region @xmath34 is zero for @xmath50 , we can extend the integration over @xmath30 in eq .",
    "( [ eq : pes_wigner_tddft_bb ] ) to the whole space . using the integral properties of the wigner",
    "transform we finally obtain @xmath51 where @xmath52 is the fourier transform of @xmath53 and the expression is written in the limit for @xmath36 .",
    "equation  ( [ eq : pes_tddft ] ) gives an intuitive formulation of momentum - resolved pes as a sum of the fourier component of each orbital in the detector region .",
    "it is worth to note that eq .",
    "( [ eq : pes_tddft ] ) is not restricted to tddft and can be applied to other effective single - particle formulations such as time - dependent hartree - fock and the tdse in the sae approximation .    the numerical evaluation of the ionization probability from eq .",
    "( [ eq : pes_tddft ] ) requires the knowledge of the wavefunction after the external field has been switched off . for ionization processes",
    "this means that one has to deal with simulation boxes that extend over several hundred atomic units and this practically constrains the method only to one - dimensional calculations . in the next section",
    "we will derive a simple scheme to overcome this limitation making the present scheme applicable for realistic simulations of molecules and nanostructures .      in the previous sections we described a practical way to evaluate the momentum - resolved pes following the spatial partitioning of fig .",
    "[ fig : geometrical_scheme ]  ( a ) and how this can be conveniently cast in the language of tddft . in this section",
    "we take a step further in developing an efficient time evolution scheme by exploiting the geometry of the problem together with some physical assumptions .",
    "we start by introducing a split - evolution scheme : at each time @xmath25 we implement a spatial partitioning of eq .",
    "( [ eq : orbital_partition ] ) as following @xmath54\\psi_{i}(\\textbf{r},t )   \\end{array } \\right . \\,,\\ ] ] where @xmath55 is a smooth mask function defined to be 1 deep in the interior of region @xmath34 and 0 outside , as shown in fig .",
    "[ fig : mask_function ] .     to region @xmath30 .",
    "the functional shape used for actual calculations is defined in eq .",
    "( [ eq : mask_function]).,width=325 ]    such a mask function , along with the partitions @xmath34 and @xmath30 , introduces a buffer region @xmath31 ( technically handled as the outermost shell of @xmath34 ) , where @xmath56 and @xmath57 overlap [ see fig .  [",
    "fig : geometrical_scheme ]  ( b ) ] .",
    "we can set up a propagation scheme from time @xmath25 to @xmath58 as following @xmath59 \\\\",
    "\\psi_{b , i}(\\textbf{r},t^{\\prime})=[1-m(\\textbf{r})]u(t^\\prime , t)\\left[\\psi_{a , i}(\\textbf{r},t)+\\psi_{b , i}(\\textbf{r},t)\\right ] \\end{array } \\right.\\ ] ] where @xmath60 is the time propagator associated with the full hamiltonian including the external fields .",
    "equation  ( [ eq : prop_scheme ] ) defines a recursive propagation scheme completely equivalent to a time propagation in the whole space @xmath61 .",
    "in typical experimental setups , detectors are situated far away from the sample and electrons overcoming the ionization barrier travel a long way before being detected . during their journey toward the detector , and far away from the molecular system , they practically evolve as free particles driven by an external field .",
    "it seems therefore a waste of resources to solve the full schrdinger equation for the traveling electrons while their behavior can be described analytically .",
    "in addition , an ideal detector placed relatively close to the molecular region would measure the same pes .    from these observations",
    "we conclude that we can reduce region @xmath34 to the size of the interaction region and assume electrons in @xmath30 to be well described by non - interacting volkov states .",
    "volkov states are the exact solution of the schrdinger equation for free electrons in an oscillating field .",
    "they are plane - waves and are therefore naturally described in momentum space . in the velocity gauge",
    "the volkov time propagator is formally expressed by @xmath62 ^ 2\\right\\ } \\,,\\ ] ] where the time - ordering operator is omitted for brevity and @xmath63 is the vector potential .",
    "this is equivalent to the use of a strong - field approximation in the outer region in the same spirit of the lewenstein model  @xcite .    in summary ,",
    "the method we propose consists in solving numerically the real - space tddft equations in @xmath34 and analytically propagating the wavefunctions residing in @xmath30 in momentum space . in this setup region",
    "@xmath31 acts as a communication layer between functions in @xmath34 and @xmath30 . under this prescription , and by handling @xmath30-functions in momentum space , eq .",
    "( [ eq : prop_scheme ] ) becomes @xmath64 with    @xmath65 u(t^{\\prime},t )   \\psi_{a , i}(\\textbf{r},t ) \\\\",
    "\\tilde{\\xi}_{b , i}(\\textbf{p},t^{\\prime } ) = &   u_v(t^{\\prime},t )   \\tilde{\\psi}_{b , i}(\\textbf{p},t ) \\nonumber \\\\",
    "\\label{eq : ba_correction_b }                                           & -\\int \\frac{{\\rm d}\\mathbf{r}\\ , e^{-i \\mathbf{p}\\cdot \\mathbf{r } } } { ( 2 \\pi)^{\\frac{d}{2 } } } \\eta_{b , i}(\\textbf{r},t^{\\prime})\\,.\\end{aligned}\\ ] ]    at each time step the orbital @xmath66 is evolved under the mask function and stored in @xmath67 , forcing @xmath67 to be localized in @xmath34 . at the same time , the components of @xmath66 escaping from @xmath34 are collected in momentum space by @xmath68 .",
    "we then add to @xmath68 the contribution of the wavefunctions already present in @xmath30 at time @xmath25 by summing up @xmath69 . in order to allow electrons to come back from @xmath30 to @xmath34",
    "we include @xmath70 in @xmath34 and correct the function in @xmath30 by removing its fourier components [ second term in eq .",
    "( [ eq : ba_correction_b ] ) ] .",
    "one of the advantages of eq .",
    "( [ eq : full_mask_method ] ) is that all the spatial integrals present in @xmath71 and @xmath72 are performed on functions localized in @xmath31 .",
    "therefore , integrals over the whole space are evaluated at the cost of an integration on the much smaller buffer region @xmath31 that can be easily evaluated by fast fourier transform algorithms .",
    "similar considerations hold for integrals in momentum space under the assumption that @xmath30-functions @xmath73 are localized in momentum .",
    "when region @xmath34 is discretized on a grid , in order to avoid wavefunction wrapping at the boundaries and preserve numerical stability , additional care must be taken . in our implementation , numerical stability",
    "is addressed by the use of non - uniform fourier transforms ( see details in appendix  [ sec : numerical ] ) .",
    "there are situations were the electron flow from @xmath30 to @xmath34 is negligible .",
    "this is the case , for instance , when @xmath34 is large enough to contain the whole wavefunctions at the time when the external field has been switched off .",
    "a propagation at later times will see photoelectrons flowing mainly from @xmath34 to @xmath30 .",
    "in this situation , @xmath70 and the corresponding correction term in @xmath74 can be discarded .",
    "the evolution scheme of eq .",
    "( [ eq : full_mask_method ] ) is thus simplified and becomes @xmath75 in the folowing we will refer to eq .",
    "( [ eq : mask_method ] ) as the `` mask method '' ( mm ) , and to eq .",
    "( [ eq : full_mask_method ] ) as the `` full mask method '' ( fmm ) .",
    "we note here again that , being single - particle propagations schemes , both mm and fmm are not restricted to tddft and can be applied to other effective single - particle theories . as a matter of fact an approach similar to eq .",
    "( [ eq : mask_method ] ) has already been employed in the propagation of the tdse equations for atomic systems  @xcite , and in tddft for one - dimensional models of metal surfaces  @xcite .",
    "we also note that the implementation of absorbing boundaries trough a mask function as done in eq .",
    "( [ eq : ba_abs_bound ] ) can be cast in terms of an additional imaginary potential ( exterior complex scaling ) in the schrdinger equation .",
    "such approach is commonly used in quantum optics .    within the mm , the evolution in @xmath34",
    "is completely unaffected by the wavefunctions in @xmath30 and ionized electrons are treated uniquely in momentum space .",
    "compared with the fmm , the mm is numerically more stable as it is not affected by boundary wrapping . in order to achieve the conditions where eq .",
    "( [ eq : mask_method ] ) is valid may require , however , large simulation boxes .",
    "moreover as the mask function never absorbs perfectly the electrons , spurious reflections may appear .",
    "suppression of such artifacts requires a further enlargement of the buffer region . with fmm spurious reflections",
    "are almost negligible .",
    "choosing between mm and fmm implies a tradeoff between computational complexity and numerical stability that strongly depends on the ionization dynamics of the process under study . in what follows",
    ", we will illustrate the differences and devise a prescription to help the choice of the most suitable method in each specific case .",
    "in this section we present a few numerical applications of the schemes previously derived . in all calculations the boundary between @xmath34 and @xmath30 regions is chosen as a @xmath19-dimensional sphere implemented by the mask function : @xmath76 as shown in fig .",
    "[ fig : mask_function ] .",
    "note that numerical studies ( not presented here ) revealed a weak dependence of the final results on the functional shape of the mask .",
    "the time propagation of the orbitals in @xmath34 is performed with the enforced time - reversal symmetry evolution operator  @xcite @xmath77 where @xmath78 is the full ks hamiltonian , and the coupling with the external field is expressed in the velocity gauge .",
    "the first system we will study is hydrogen . in spite of being a one - electron system ,",
    "it is a seemingly trivial case that has been and still is under thorough theoretical investigation  @xcite .",
    "clearly we do not need tddft to study hydrogen and our numerical results are obtained by propagating the wavefunction with a non - interacting hamiltonian .",
    "the interest in this case is focused on the numerical performance of different mask methods as hydrogen provides a useful benchmark .",
    "the full tddft calculations performed for molecular nitrogen , carbon monoxide , and benzene are later presented in sect .",
    "[ sub : n2 infrared pulse ] and sect .",
    "[ sub : hei_pad ] respectively . in these cases ,",
    "norm - conserving troullier - martins pseudopotentials and the exchange - correlation lb94 potential  @xcite ( that has the correct asymptotic limit for molecular systems ) are employed .",
    "finally , in all calculations the starting electronic structure of the molecules is calculated in the born - oppenheimer approximation at the experimental equilibrium geometry and the time evolution is performed with fixed ions .",
    "as first example we study multi - photon ionization of a one - dimensional soft - core hydrogen atom , initially in the ground state , and exposed to a @xmath79  nm ( @xmath80  a.u . )",
    "linearly polarized laser pulse with peak intensity @xmath81  @xmath82 , of the form @xmath83 where @xmath84 is a trapezoidal envelope function of 14 optical cycles with two - cycle linear ramps , constant for 10 cycles , and with @xmath85  a.u . here",
    "@xmath86 is the vector potential in units of the speed of light @xmath87 .",
    "a soft - coulomb potential @xmath88 is employed to model the electron - ion interaction .",
    "we propagate the electronic wavefunction in time and then compare the energy - resolved ionization probability obtained from different schemes . along with mm , fmm , and",
    "spm we present results for direct evaluation of pes from eq .",
    "( [ eq : pes_tddft_e ] ) . in this method",
    "the spectrum is obtained by directly fourier transforming the wavefunction in region b. since the analysis is conducted without perturbing the evolution of the wavefunction we will refer to it as the `` passive method '' ( pm ) .",
    "this method requires the knowledge of the whole wavefunction after the pulse has been switched off , and since a considerable part of the wave - packet is far away from the core ( for the present case a box of 500  a.u .",
    "radius is needed for 18 optical cycles ) , it is viable only for one - dimensional calculations",
    ". nevertheless it is important as it constitutes the limiting case for both mm and fmm .     for the one - dimensional soft - core hydrogen model .",
    "the laser pulse has angular frequency @xmath80  a.u .",
    ", intensity @xmath81  @xmath89 , and a trapezoidal envelope with 2 optical cycle linear ramp ( one optical cycle  @xmath90  fs ) and 10 cycles constant center.,width=325 ]    in fig .",
    "[ fig : evo_multi_1d ] , a color plot of the evolution of the electronic density as a function of time is shown .",
    "the electronic wavefunction splits into sub - packets generated at each laser cycle ( one optical cycle  @xmath91  fs ) .",
    "these wavepackets evolve in bundles and their slope correspond to a certain average momentum .",
    "ati peaks are then formed by the build up of interfering wavepackets periodically emitted in the laser field and leading to a given final momentum  @xcite .",
    "( logarithmic scale ) calculated with different approaches .",
    "the spectra are shifted by multiplying a constant factor for easy comparison . from bottom to top : passive method eq .",
    "( [ eq : pes_tddft_e ] ) in green , mask method eq .",
    "( [ eq : mask_method ] ) in red , full mask method eq .",
    "( [ eq : full_mask_method ] ) in blue , and sampling point method eq .",
    "( [ eq : sampling_point ] ) in purple .",
    "laser parameters are the same as in fig .",
    "[ fig : evo_multi_1d].,width=325 ]    from fig .",
    "[ fig : evo_multi_1d ] is it possible to see that electrons may be considered as escaped `` already '' at 30  a.u .",
    "away from the center .",
    "we set therefore @xmath92  a.u . and calculate energy - resolved pes with the pm . as we can see from fig .",
    "[ fig : pes_multi_1d ] the spectrum presents several peaks at integer multiples of @xmath1 following @xmath93 with @xmath94  a.u .",
    "being the ponderomotive energy , @xmath95  a.u .",
    "the ionization potential , and @xmath4 the number of absorbed photons . in this case",
    "the minimum number of photons needed to exceed the ionization threshold is @xmath96 .",
    "of course , the spectrum is only in qualitative agreement with three - dimensional calculations  @xcite as expected from a one - dimensional soft - core model  @xcite .",
    "pes calculated from mm , fmm , and spm all agree as reported in fig .  [ fig : pes_multi_1d ] .",
    "numerical calculations were performed until convergence was achieved , leading to a grid with spacing @xmath97  a.u . and",
    "box sizes depending on the method .",
    "for mm we employed a simulation box of @xmath98  a.u . and set the buffer region at @xmath99  a.u . in order to have energy resolution comparable with pm we used padding factors ( see appendix  [ sec : numerical ] ) @xmath100 and the total simulation time was @xmath101 optical cycles .",
    "for fmm a smaller box of @xmath102  a.u . with @xmath99  a.u .",
    "is needed to converge results , and @xmath103 , @xmath104 were needed to preserve numerical stability for @xmath101 optical cycles . for spm two sampling points at @xmath105  a.u .",
    "were needed to get converged results with a box of 550  a.u . , and a complex absorber@xcite at 49  a.u . from the boundaries of the box .",
    "in addition , a total time of @xmath106 optical cycles was required to collect all the wave packets .",
    "the need for such a huge box resides on the working conditions of spm . in order to avoid spurious effects ,",
    "the sampling points must be set at a distance such that the density front arrives after the external field has been switched off .",
    "therefore the longer the pulse the further away the sampling points must be set . for these laser parameters",
    "one could rank each method according to increasing numerical cost starting from mm , followed by fmm , pm , and spm .    as a second example we study the ionization of this one dimensional hydrogen atom by an ultra - short intense infrared laser .",
    "we employ a single two - cycle pulse of wavelength @xmath107  nm ( @xmath108  a.u . ) , intensity @xmath109  @xmath82 , and envelope @xmath110 with @xmath111 and @xmath112  a.u .     for a one - dimensional soft - core hydrogen and a two - cycle @xmath113 laser pulse with angular frequency @xmath108  a.u . , and intensity @xmath114  @xmath82 .",
    "here one optical cycle  @xmath115  fs .",
    ", width=325 ]    due to the laser strength and long wavelength , the electron evolution shown fig .",
    "[ fig : evo_short_1d_pa ] is quite different from the one presented before .",
    "electrons ejected from the core are driven by the laser and follow wide trajectories before returning to the parent ion .",
    "such trajectories can be understood in the context of the semiclassical model  @xcite where released electrons move as a free particle in a time - dependent field with a maximum oscillation amplitude of @xmath116  a.u .",
    "electrons ejected near a maximum of the electric field @xmath117 are the ones gaining the most kinetic energy and are therefore responsible for the fast emerging electrons after rescattering with the core .",
    "yield from different approaches .",
    "spectra are shifted by a constant factor .",
    "order and color coding is the same as in fig .",
    "[ fig : pes_multi_1d ] .",
    "laser parameters are described in the caption of fig .",
    "[ fig : evo_short_1d_pa ] . , width=325 ]    in fig .",
    "[ fig : pes_short_1d ] we show the energy - resolved pes for different methods . here",
    "the spectra appear to be very far from any ati structure due to short duration of the laser pulse and is characterized by some irregular maxima and minima  @xcite .",
    "the characteristic features of the ionization dynamics is strongly dependent on the detailed shape of the pulse as one can easily imagine by inspecting the asymmetry in the electron ejection from fig .",
    "[ fig : evo_short_1d_pa ] . due to these dynamics , a dramatic carrier envelope phase dependence for such short pulses is expected .",
    "all the different methods result in similar spectra but with different parameters . in pm",
    "we set @xmath118  a.u . and a box of radius @xmath119  a.u .",
    "is needed to contain the wave function after @xmath120 optical cycles ( one optical cycle  @xmath115 fs ) . for mm @xmath121  a.u .",
    ", @xmath122  a.u . , and the padding factors are @xmath123 , @xmath124 . here",
    "the value for @xmath125 is dictated by the width of the buffer region which needs to be wide enough to prevent spurious reflections .     of a one - dimensional soft - core hydrogen .",
    "laser parameters are the same as in fig .",
    "[ fig : evo_short_1d_pa ] .",
    "dashed lines indicate the edges of the simulation box.,width=325 ]    a considerably smaller box is needed for fmm , where @xmath126  a.u .",
    ", @xmath122  a.u . , @xmath127 , and @xmath104 .",
    "in this case one can reconstruct the total density in @xmath34 by evaluating @xmath128 via eq .",
    "( [ eq : full_mask_method ] ) and compare it to the exact evolution . as one can see in fig .",
    "[ fig : evo_short_1d_ba ] the reconstructed density displays a behavior remarkably similar to the exact one of fig .  [ fig : evo_short_1d_pa ] but with a considerably reduced computational cost .",
    "smp requires sampling points at @xmath129  a.u . in a box of radius @xmath130  a.u . with 49 a.u .",
    "wide complex adsorbers , and for a total time of @xmath131 optical cycles .",
    "the possibility to use relatively small simulation boxes is especially important for three - dimensional calculations where the computational cost scales with the third power of the box size .",
    "both mask methods are practicable options for 3d simulations and the advantage of using fmm with respect to mm is driven by the electron dynamics .",
    "for long laser pulses mm appears to be more stable and it is a better choice than fmm , while for short pulses with large electron oscillations fmm can be more performant .",
    "spm is a viable option for short pulses and small values for the oscillations .    as a last example",
    ", we present ati of a real three - dimensional hydrogen atom subject to a long infrared pulse .",
    "we employ a laser linearly polarized along the @xmath132-axis with wavelength @xmath107  nm , intensity @xmath133  @xmath82 , pulse shape of the form  ( [ eq : pulse_sin2 ] ) with @xmath134 and @xmath135  a.u . due to to the pulse length , mm appears to be the most appropriate choice in this case . in the calculation",
    "@xmath136  a.u .",
    ", @xmath137  a.u . ,",
    "@xmath138 and @xmath139 .",
    "( logarithmic scale ) of hydrogen for a 20 cycle @xmath113 laser pulse of wavelength @xmath107  nm , and intensity @xmath133  @xmath82 polarized along the @xmath132 axis.,width=325 ]    in fig .",
    "[ fig : pad_h3d ] we show a high - resolution density plot of the pad @xmath140 defined in eq .",
    "( [ eq : pad ] ) .",
    "the radial distance denotes the photoelectron energy while the angle indicates the direction of emission with respect to the laser polarization .",
    "the color density is plotted in logarithmic scale and represents the values of @xmath140 .    the photoelectron energy - angular distribution displays complex interference patterns . the pattern shape compares favorably with similar calculations in the literature  @xcite .",
    "it consists of a series of rings with fine structures .",
    "each ring represents the angular distribution of the photoelectron ati peaks .",
    "the spacing of adjacent rings equals the photon energy @xmath108",
    "photoelectrons are emitted mainly along the laser polarization , and the left - right symmetry of the rings indicates that the photoelectrons do not present any preferential ejection side with respect to the polarization axis .",
    "the first ring corresponds to the angular distribution of the first ati peak .",
    "it presents a peculiar nodal pattern that is induced by the long - range coulomb potential and is related to the fact that the ati peak is determined by one dominant partial wave in the final state  @xcite .",
    "the number of the stripes equals the angular momentum quantum number of the dominant partial wave in the final state plus one  @xcite . in fig .",
    "[ fig : pad_h3d ] , the first ring contains six stripes and the dominant final state has angular momentum quantum number of 5 .",
    "the pattern of the energy - angular distribution and the stripe number of the first ring are in good agreement with those in the literature  @xcite . as for the fine structures ,",
    "we observe that while the main ring pattern is already formed in the first half of the pulse , the fine structure builds up until the end of the pulse .",
    "this supports the hypothesis that such structures are induced by the coherence of the two contributions from the leading and trailing edges of the pulse envelope  @xcite .      in this section",
    "we compare theoretical and experimental angular resolved photoelectron probabilities for randomly oriented n@xmath142 molecules .",
    "we choose the laser parameters according to experiment  @xcite , i.e. , we employ a @xmath143 cycle pulse of wavelength @xmath144 nm ( @xmath145 a.u . ) , intensity @xmath146 @xmath147 .",
    "a laser shape @xmath148 for",
    "the vector potential should lead to an electric field similar to the one employed in the experiment with zero carrier envelope phase .",
    "( log scale ) in the laboratory frame for randomly oriented n@xmath142 molecules in a 6 cycles infrared laser pulse with @xmath149 nm , with intensity @xmath146 @xmath147 .",
    "the angle @xmath150 is measured from the laser polarization axis .",
    "the different panels represent @xmath151 ( spanning 3.4 orders of magnitude ) , from ( a ) experiment , ( b ) calculated with tddft and fmm , and ( c ) calculated with modified molecular strong field approximation .",
    "panels ( a ) and ( c ) are adapted from ref .  .",
    ", width=325 ]    in fig .",
    "[ fig : pes_n2_average ]  ( a ) the experimental photoelectron probability @xmath151 is plotted in logarithmic scale as a function of the energy and the angle with respect to the laser polarization in the laboratory frame .",
    "electrons are mainly emitted at small angles , and , due to the short nature of the pulse electron emission is asymmetric along the laser polarization axis ( at angles close to @xmath152 and @xmath153 ) .",
    "we performed tddft calculations for different angles @xmath154 between the molecular axis and the laser polarization .",
    "the molecular geometry was set at the experimental equilibrium interatomic distance @xmath155 a.u .",
    "the kohn - sham wavefunctions were expanded in real space with spacing @xmath156  a.u . in a simulation box of @xmath157  a.u .",
    "the photoelectron spectra were calculated with fmm having @xmath158 a.u . , and padding factors @xmath138 , and @xmath124 .",
    "( log scale ) for aligned n@xmath142 molecules and different laser polarization directions @xmath154 : ( a ) @xmath159 , ( b ) @xmath160 , ( c ) @xmath161 , ( d ) @xmath162 . here",
    "@xmath154 is the angle between the laser polarization direction and the molecular axis .",
    "laser parameters are the same as in fig .",
    "[ fig : pes_n2_average ] .",
    ", width=325 ]    in fig .",
    "[ fig : pes_n2_panel ] the logarithmic ionization probability @xmath163 is plotted as a function of energy @xmath10 and angle @xmath150 measured from the laser polarization axis for different values of @xmath164 .",
    "as the molecular orientation decreases from @xmath165 we observe an increasing suppression of the emission together with a shift of the maximum that moves away from the laser polarization axis . for @xmath162",
    "the emission is highly enhanced for all angles and peaked along the laser direction .",
    "the signature of multi - center emission interference has been predicted to be particularly marked when the laser polarization is perpendicular to the molecular axis  @xcite ( i.e. @xmath159 ) .",
    "however , the lowest point in energy of such a pattern is predicted for @xmath166 and @xmath167 ev , way above the energy window of observable photoelectrons produced by our laser . a stronger and longer laser pulse would be required to extend the rescattering plateau toward higher energies and therefore to reveal the pattern  @xcite .    in order to reproduce the experimental @xmath151 , an average over all the possible molecular orientations should be performed . due to the axial symmetry of the molecule we can restrict the average to @xmath168 and integrate all the contributions with the proper probability weight  @xcite @xmath169    we evaluate eq .",
    "( [ eq : n2_average ] ) by discretizing the integral in a sum for @xmath170 , and display the result in fig .",
    "[ fig : pes_n2_average ]  ( b ) . even in this crude approximation , and without taking into account focal averaging , the agreement with the experiment is satisfactory and compares favorably to the molecular strong field approximation shown in fig .",
    "[ fig : pes_n2_average ]  ( c ) .",
    "the agreement deteriorates for low energies where the importance of the coulomb tail is enhanced as it is not fully accounted due to limited dimensions of the simulation box . as a matter of fact the agreement greatly increases for higher energies .      in this section",
    "we deal with uv ( @xmath171  a.u . )",
    "angular resolved photoemission triggered by weak lasers .",
    "when the external field is weak , non - linear effects can be discarded and first order perturbation theory can be applied . in this situation ,",
    "the momentum resolved pes can be evaluated by fermi s golden rule as @xmath172 where @xmath173 ( @xmath174 ) is the initial ( final ) many - body wavefunction of the system and @xmath175 is the laser polarization axis .",
    "the difficulty in evaluating eq .",
    "( [ eq : golden_rule ] ) lies in the proper treatment of the final state , which in principle belongs to the continuum of the same hamiltonian of @xmath173 . in the simplest approach ,",
    "it is approximated by a plane wave ( pw ) . in this approximation",
    "the square root of the momentum - resolved pes is proportional to the sum of the fourier transforms of the initial state wavefunctions @xmath176 corrected by a geometrical factor @xmath177 @xmath178 if photoemission peaks are well resolved in momentum , individual initial states can be selectively measured . in this case a correspondence between momentum - resolved pes and electronic states in reciprocal space can be established .",
    "the range of applicability of the pw approximation has been discussed in the literature  @xcite .",
    "it has been postulated that eq .",
    "( [ eq : pw_full ] ) should be valid for ( i ) @xmath179-conjugated planar molecules , ( ii ) constituted by light atoms ( h , c , n , o ) and for ( iii ) photoelectrons emerging with momentum @xmath180 almost parallel to the polarization axis .",
    "here we restrict ourselves to photoemission from the highest occupied molecular orbital ( homo ) . in this case",
    "( [ eq : pw_full ] ) becomes @xmath181 the subscript @xmath78 indicating homo - related quantities .",
    "we compare ab - initio tddft and pw pads evaluated at fixed momentum @xmath182 with @xmath183 being the kinetic energy of photoelectrons emitted from the homo and @xmath184 its binding energy .",
    "tddft numerical calculations are carried out on a grid with spacing @xmath185",
    "a.u . for benzene and @xmath156  a.u . for co , in a simulation box of @xmath186",
    "a.u .. photoelectron spectra are calculated using mm with @xmath187  a.u . and",
    "padding factors @xmath138 , @xmath139 . a 40 cycles pulse with 8 cycle ramp at the he-(i ) frequency @xmath188  a.u . and",
    "intensity @xmath189  @xmath147 is employed .",
    "( left column ) and tddft @xmath190 ( right column ) on a sphere at constant kinetic energy @xmath191",
    "a.u . for different laser polarizations",
    "@xmath175 ( see text for details ) .",
    "values on the sphere are normalized to unity .",
    "we used a 40 cycles ( 8 cycles ramp ) uv trapezoidal laser pulse with @xmath192  nm ( @xmath188  a.u . ) , and intensity @xmath189  @xmath193 .",
    "in the top row @xmath194 , and in the bottom row @xmath195 .",
    "white tics indicate the intersection of the laser polarization axis with the sphere at constant kinetic energy @xmath196 . the geometry of the photoemission process is indicated in fig .",
    "[ fig : pad_hei_geo ]  ( a ) . , width=325 ]    we begin presenting the case of benzene since it constitutes the smallest molecule meeting all the conditions for eq .",
    "( [ eq : pw_homo ] ) to be valid . results for molecules oriented according to fig .  [",
    "fig : pad_hei_geo ]  ( a ) , evaluated at @xmath191 a.u . , and two different laser polarizations @xmath197 ,  @xmath198 with @xmath199 , @xmath200 , are shown in fig .",
    "[ fig : pad_benzene_panel ] . in the case where the laser is polarized along the @xmath132 axis",
    "[ see fig .",
    "[ fig : pad_benzene_panel ]  ( b ) ] , pad presents a four lobes symmetry separated by three horizontal and two vertical nodal lines .",
    "this structure is reminiscent of the homo @xmath179-symmetry with the nodal line at @xmath166 corresponding to the nodes of the orbital on the @xmath132-@xmath201 plane .",
    "information on the orientation of the molecular plane could then be inferred from the inspection of this nodal line in the pad .",
    "a similar feature can be observed also in the case of an off - plane polarization as shown in fig .",
    "[ fig : pad_benzene_panel ]  ( d ) . in this case , however , the laser can also excite @xmath202-orbitals and the nodal line at @xmath166 is partially washed out .",
    "the other nodal lines can be understood in term of zeros of the polarization factor @xmath177 and are thus purely geometrical .",
    "a pw approximation of the photoelectron distribution given by eq .  ( [ eq : pw_homo ] ) qualitatively reproduce the ab - initio results as shown in fig .",
    "[ fig : pad_benzene_panel ]  ( a ) and ( d ) . according to condition ( iii ) a quantitative agreement is reached only for directions parallel to the polarization axis .    .",
    "the molecule is oriented according to fig .",
    "[ fig : pad_hei_geo ]  ( b ) and the photoelectron spectra were evaluated on a sphere at @xmath203  a.u.,width=325 ]    a different behavior is expected in the case of co. photoelectrons with kinetic energy of @xmath204  a.u . are show in fig .",
    "[ fig : pad_co_panel ] . in this case ,",
    "condition ( i ) ( i.e. @xmath179-conjugated molecule ) is not fulfilled and a worse agreement between ab - initio and pw calculations is expected .",
    "the quality of the agreement can be assessed by comparing the left and right columns of fig .",
    "[ fig : pad_co_panel ] . here",
    ", the weak angular variation of @xmath205 is completely masked by the polarization factor @xmath206 [ cf .",
    "[ fig : pad_co_panel ]  ( a ) and ( c ) ] . for this reason",
    "no information on the molecular configuration can be recovered from a pw model .",
    "the situation is qualitatively different for tddft as , in this case , single atom electron emitters are fully accounted for . here the nodal pattern is mainly governed by the polarization factor , but , however , fingerprints of the molecule electronic configuration can be detected .",
    "for instance , when the laser is polarized along the molecular axis , an asymmetry of the photoemission maxima can be observed for directions parallel to @xmath207 [ see fig .",
    "[ fig : pad_co_panel ]  ( b ) ] . here",
    "the global maximum is peaked around @xmath208 corresponding to the side of the carbon atom on the molecular axis [ cf .",
    "[ fig : pad_hei_geo ]  ( b ) ] .",
    "these features can be again understood in terms of the shape of the homo . for co , in fact",
    ", the homo is a @xmath202 orbital with the electronic charge unevenly accumulated around the carbon atom .",
    "it is therefore natural to expect photoelectrons to be ejected mainly around the molecular axis and with higher probability form the side of the carbon atom .",
    "this asymmetry is therefore a property of the electronic configuration of the molecule and gives information about the molecular orientation itself .",
    "this behavior appears to be stable upon molecule rotation as can be observed in the case where the polarization is tilted with respect to the molecular axis [ @xmath197 , see fig .  [",
    "fig : pad_co_panel ]  ( d ) ] .",
    "even here the nodal structure is mainly dictated by the polarization factor .",
    "in this work we studied the problem of photoemission in finite systems with tddft .",
    "we presented a formal derivation of a photoelectron density functional from a phase - space approach to photoemission .",
    "such a functional can be directly applied to other theories based on a single slater determinant and the derivation could serve as a base for extensions to more refined models .",
    "we proposed a mixed real- and momentum - space evolution scheme based on geometrical splitting . in its complete form it allows particles to seamlessly pass back and forth from a real - space description to a momentum - space description .",
    "the ordinary splitting scheme turns out to be a special case of this more general method .",
    "furthermore , we illustrated applications of the method on four physical systems : hydrogen , molecular nitrogen , carbon monoxide and benzene .    for hydrogen we presented a comparison of the different methods .",
    "we studied ati peak formation in a one - dimensional model and ati angular distributions for a three - dimensional case .",
    "the results turned out to be in good agreement with the literature . from the comparison , we derived a prescription to choose the best method based on a classification of the electron dynamics induced by the external field .",
    "we investigated angular - resolved photoemission for randomly oriented n@xmath141 molecules in a short intense ir laser pulse .",
    "we illustrated the results for four different molecular orientations with respect to the laser polarization .",
    "owing to the symmetry of the problem we were able to combine the results to account for the random orientation .",
    "the spectrum for randomly oriented molecules is in good agreement with experimental measurements and is much better than the widely used strong field approximations ( with one active electron )  @xcite .",
    "we also studied uv angular resolved photoelectron spectra for oriented carbon monoxide and benzene molecules .",
    "we presented numerical calculations for two different directions of the laser polarization and compared with the plane - wave approximation .",
    "we found that the plane - wave approximation provides a good description for benzene while failing for co. furthermore , we found evidence that the photoelectron angular distribution carries important information on molecular orientation .",
    "the successful implementation of photoelectron density functional presented in this article paves the road for interesting applications to many different systems for a wide range of laser parameters . to name a few",
    ", tddft pad could provide a theoretical tool superior to the plane - wave and the independent atomic center approximations to retrieve molecular adsorption orientation information from experiments .",
    "atto - second pump probe experiments could be simulated ab - initio accounting for many - body effects but with great computational advantage with respect to full many - body methods and better physical description than sae pictures .",
    "special thanks to lorenzo stella for many stimulating discussions and suggestions .",
    "we also wish to acknowledge useful discussions and comments from stefan kurth , ilya tokatly , matteo gatti and franck lpine .",
    "financial support was provided by spanish ( fis2011 - 65702-c02 - 01 and pib2010us-00652 ) , aci - promociona ( aci2009 - 1036 ) , grupos consolidados upv / ehu del gobierno vasco ( it-319 - 07 ) , and the european research council advanced grant dynamo ( erc-2010-adg -proposal no .",
    ". computational time was granted by i2basque and bsc `` red espanola de supercomputacion '' .",
    "malm acknowledges support from the french anr ( anr-08-cexc8 - 008 - 01 ) .",
    "in this section we describe the details of the inclusion of the kohn - sham one - body density matrix  ( [ eq : one_dens_tddft ] ) into eq .",
    "( [ eq : pes_wigner ] ) .",
    "the momentum - resolved photoelectron probability is the sum over all the occupied orbitals of four overlap integrals @xmath209 @xmath210 in order to simplify the notation we drop the orbital index @xmath211 in the overlap integrals and indicate with @xmath212 the vector @xmath213 of modulus @xmath214 and direction @xmath215 .",
    "in addition , we will consider the simple case where the boundary surface between region @xmath34 and @xmath30 is a @xmath19-dimensional sphere of radius @xmath125 .",
    "we start by considering the mixed overlap @xmath216 where the integration in @xmath30 is for @xmath217 [ cf .",
    "[ fig : geometrical_scheme ] ( a ) ] .",
    "it is convenient to work in the coordinates @xmath218 and @xmath219 , where the integral takes the form @xmath220 we substitute @xmath221 with its fourier integral representation @xmath222 and after few simple steps we obtain @xmath223 where we successfully disentangled the integration over @xmath213 in the second integral .",
    "the integral on @xmath224 can be rewritten as an integral over the whole space , which yields a @xmath19-dimensional dirac delta , minus an integral on @xmath225 : @xmath226 where @xmath227 is a bessel function of the first kind . the second term in  ( [ eq : besselj ] )",
    "is a function centered in @xmath228 and strongly peaked in the region @xmath229 with @xmath230 , @xmath231 , @xmath232 being the first zeros of the bessel function @xmath233 . if the region @xmath234 is small enough we can consider the integrand in @xmath235 of  ( [ eq : gammaab ] ) constant and factor out of the integrand @xmath236 evaluated at @xmath237 .",
    "it is easy to see that @xmath238 and , by plugging  ( [ eq : besselj ] ) in  ( [ eq : gammaab ] ) , we have that @xmath239 . by the same reasoning",
    "we should expect @xmath240 .",
    "we now turn to the terms containing wavefunction on the same region . in @xmath241",
    "coordinates @xmath242 the product of functions localized in @xmath34 is not negligible only for @xmath243 and @xmath244 .",
    "since the integral is carried out for @xmath224 we can bound @xmath245 from below with @xmath246 .",
    "this leads to @xmath247 which is satisfied only on the boundary of @xmath34 .",
    "being a set of negligible measure we have @xmath248 .",
    "once again , in @xmath241 coordinates @xmath249 can be written as @xmath250 where the first integration is in region @xmath34 . using the localization of @xmath251 we see that the integral is non - zero only for @xmath252 and @xmath253 .",
    "as the integration is for @xmath254 we have that @xmath255 and therefore the double integral in eq .",
    "( [ a10 ] ) is zero .",
    "a real - space implementation of eq .",
    "( [ eq : full_mask_method ] ) involves the evaluation of several fourier integrals .",
    "such integrals are necessarily substituted by their discrete equivalent , and therefore discrete fourier transforms ( ft ) and fast fourier transforms ( ffts ) are called into play .",
    "however , evolution methods based on the discrete ft naturally impose periodic boundary conditions . while this is not presenting any particular issue for mm where ft are only used to map real - space wavefunctions to momentum space ,",
    "it is a source of numerical instability for fmm where the wavefunctions are reintroduced in the simulation box .",
    "the problem is well illustrated by the following one - dimensional example .",
    "imagine a wavepacket freely propagating to an edge of the simulation box with a certain velocity . in mm ,",
    "when passing trough the buffer region , the packet is converted by discrete ft in momentum space and then analytically evolved as a free particle through the edge of the box . in fmm as the wavefunction evolves in momentum spaces it is also transformed back to real space to account for possible charge returns . in this case , instead of just disappearing from one edge , by virtue of the discrete ft periodic boundary conditions , the same wavepacket will appear from the opposite side .",
    "it can be easily understood how such an undesirable event can create a feedback leading to an uncontrolled and unphysical build up of the density .",
    "this behavior can be controlled by the use of zero padding . as we know ,",
    "the fourier integrals in eq .",
    "( [ eq : full_mask_method ] ) involves functions that are , by construction , zero outside the buffer region @xmath31 .",
    "we can therefore enlarge the integration domain ( having radius @xmath125 ) by a padding factor @xmath256 , set the integrand to zero in the extended points , obtaining the same result . as a consequence , a wavepacket propagating toward a boundary edge will have to run an enlarged _ virtual _ box of radius @xmath257 before emerging from the other side .",
    "in addition , the smallest momentum represented @xmath258 in the discretized @xmath259 is reduced by a factor @xmath260 while the highest momentum @xmath261 remains unchanged .",
    "the price to pay here is an increased memory requirement by a factor @xmath262 ( where @xmath19 is the dimension of the simulation box ) and is too high for three - dimensional calculations .    a possible way to find a better scaling",
    "is offered by the use of _ non - uniform discrete fourier transform _ and companion fast algorithm nfft  @xcite .",
    "nfft allow for the possibility to perform fourier integrals on unstructured sampling points with , for fixed accuracy , the same arithmetical complexity as fft . for a detailed description of the algorithm",
    "we refer to the literature  @xcite .",
    "the idea is to use the flexibility of nfft to perform zero padding in a convenient way .",
    "instead of allocating an enlarged box filled with zeros at equally spaced sample positions , we set only one point at @xmath263 ( here @xmath264 is the nfft padding factor ) and evaluate the fourier integral with nfft . in this way we gain numerical stability for fmm as long as the wavefunctions are contained in a _ virtual _ box of @xmath265 at the price of adding a number of points that scales as @xmath266 with the dimension of the box .",
    "if @xmath267 is the number of grid points in the simulation box , in order to perform zero padding with nfft one needs to add only @xmath268 points .    with this procedure however , not only the smallest momentum @xmath269 is reduced by a factor @xmath270 , but also the highest momentum @xmath271 is decreased by the same amount .",
    "this turns out to be the limiting factor in the use of nfft to preserve numerical stability with fmm as the enlargement factor @xmath264 has an upper bound that depends on the escaping electron dynamics .",
    "in fact , when we evaluate the back - action term eq .",
    "( [ eq : back_action ] ) , we assume @xmath259 to be localized in momentum and , in order to preserve numerical consistency , @xmath272 must be limited by the highest momentum contained in @xmath273 .",
    "a combination of ordinary padding and nfft padding helps to balance the tradeoff between memory occupancy and numerical stability ."
  ],
  "abstract_text": [
    "<S> we present a time - dependent density - functional method able to describe the photoelectron spectrum of atoms and molecules when excited by laser pulses . </S>",
    "<S> this computationally feasible scheme is based on a geometrical partitioning that efficiently gives access to photoelectron spectroscopy in time - dependent density - functional calculations . by using a geometrical approach </S>",
    "<S> , we provide a simple description of momentum - resolved photoemission including multi - photon effects . </S>",
    "<S> the approach is validated by comparison with results in the literature and exact calculations . </S>",
    "<S> furthermore , we present numerical photoelectron angular distributions for randomly oriented nitrogen molecules in a short near infrared intense laser pulse and helium-(i ) angular spectra for aligned carbon monoxide and benzene .    , </S>"
  ]
}