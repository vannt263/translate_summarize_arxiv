{
  "article_text": [
    "in increasingly deregulated energy markets , swing options arise as powerful tools for modeling supply contracts  @xcite . in such an agreement between a buyer and a seller",
    ", the buyer always has to pay some amount even if the service or product is not delivered .",
    "therefore , the buyer has to manage his contract by constantly swinging for one state to the other , requiring delivery or not .",
    "this is the kind of agreement that usually links an energy producer to a trader .",
    "numerous other examples of energy contracts can be modeled as swing options . from storages",
    "@xcite to electricity supply @xcite , this kind of financial device is now widely used .",
    "and it has to be noticed that its field of application has recently been extended to the it domain @xcite .",
    "nevertheless , the pricing of swings remains a real challenge .",
    "closely related to a multiple stopping problem @xcite , swing options require the use of high level numerical schemes .",
    "moreover , the high dimensionality of the underlying price processes and the various constraints to be integrated in the model of contracts based on physical assets such as storages or gas fired power plants increase the difficulty of the problem .",
    "thus , the most recent technics of mathematical finance have been applied in this context ; from trees to least squares monte carlo based methodology @xcite , finite elements @xcite and duality approximation @xcite . but",
    "none of these algorithms gives a totally satisfying solution to the valuation and sensitivity analysis of swing contracts .",
    "the aim of this paper is then to introduce and study a recent pricing method that seems very well suited to the question .",
    "optimal vector quantization has yet been successfully applied to the valuation of multi - asset american options @xcite .",
    "it turns out that this numerical technique is also very efficient in taking into account the physical constraints of swing contracts . for sake of simplicity",
    "we shall focus on gas supply contracts .",
    "after a brief presentation of such agreements and some background on optimal quantization methods @xcite , we show that a careful examination of the properties of the underlying price process can dramatically improve the efficiency of the procedure , as illustrated by several numerical examples .",
    "the paper is organized as follows : in the first section , we describe in details the technical features of the supply contracts ( with firm or penalized constraints ) with an emphasis on the features of interest in view of a numerical implementation : canonical decomposition and normal form , backward dynamic programming of the resulting stochastic control problem , existence of bang - bang strategies for some appropriate sets of local and global purchased volume constraints .",
    "section  2 is devoted to some background on optimal vector quantization . in section  3 ,",
    "our algorithm is briefly analyzed and the _ a priori _ error bound established in the companion paper  @xcite is stated ( as well as the resulting convergence result of the quantized premium toward the true one ) . in section  4 ,",
    "numerous simulations are carried out and the quantization method is extensively compared to the well - known least squares regression algorithm   la longstaff - schwartz \" .",
    "an annex explains in details how the price processes we consider in this paper can be quantized in the most efficient way .",
    "a typical example of swing option is an energy ( usually gas or electricity ) supply contract with optional clauses on price and volume .",
    "the owner of such a contract is allowed to purchase some amount of energy @xmath0 at time @xmath1 until the contract maturity @xmath2 , usually one year .",
    "the purchase price @xmath3 called strike price may be constant or indexed to past values of crude oil . throughout the paper we will consider that the strike prices are constant and equal to @xmath4 over the term of the contract .",
    "the volume of gas @xmath5 purchased at time @xmath6 is subject to the local constraint @xmath7 the cumulative volume purchased prior to time @xmath8(@xmath9 up to @xmath10 ) is defined by @xmath11 .",
    "it must satisfy the following global constraint ( at maturity ) : @xmath12.\\ ] ]    two approaches can be considered :     the constraints on the global purchased volumes are firm .     a penalty is applied if the constraints are not satisfied .    the price at time @xmath13 of the forward contract delivered at time @xmath14 is denoted by @xmath15 , @xmath16 being a deterministic process ( the future prices at time @xmath17 ) available and tradable on the market .",
    "let @xmath18 be the underlying markov price process defined on a probability space @xmath19 .",
    "note that it can be the observation at time @xmath20 of a continuous time process",
    ". ideally @xmath21 should be the spot price process of the gas @xmath9 @xmath22 .",
    "however it does not correspond to a tradable instrument which leads to consider in practice the day - ahead contract @xmath23 .",
    "we consider its ( augmented ) natural filtration @xmath24 .",
    "the decision sequence @xmath25 is defined on @xmath19 as well and is @xmath26-adapted , @xmath27 @xmath5 is @xmath28 measurable , @xmath29 . at time @xmath8",
    "the owner of the contract gets @xmath30 .",
    "+    the results of this paper can also be applied to every physical asset or contract where the owner reward for a decision @xmath5 is a function @xmath31 . in the case of supply contracts , @xmath32 . as for a storage",
    ", @xmath5 represents the amount of gas the owner of the contract decides to inject or withdraw and the profit at each date is then @xmath33 where @xmath34 ( resp .",
    "@xmath35 ) denotes the injection ( resp .",
    "withdrawal ) cost @xcite .",
    "we first consider that the penalties are applied at time @xmath14 if the terminal constraint is violated . for a given consumption strategy @xmath36 ,",
    "the price is given by at time @xmath17 @xmath37 where @xmath38 is the interest rate .",
    "the function @xmath39 is the penalization : @xmath40 and @xmath41 represents the sum that the buyer has to pay if global purchased volume constraints , say @xmath42 and @xmath43 , are violated .",
    "@xcite have already investigated this kind of contract .    then for every non negative @xmath44 measurable random variable @xmath45 ( representing the cumulated purchased volume up to @xmath10 ) , the price of the contract at time @xmath46 , is given by @xmath47",
    "the standard penalization function is as follows : @xmath48 where @xmath49 and @xmath50 are large enough   often equal   positive real constants .",
    "if we consider that constraints can not be violated , then for every non negative @xmath44 measurable random variable @xmath45 defined on @xmath19 , the price of the contract at time @xmath46 is given by : @xmath51 where @xmath52,\\ ,   \\sum_{\\ell = k}^{n-1 } q_{t_\\ell } \\!\\in [ \\left(q_{min}-q\\right)_+ , q_{max}-q]\\right\\}.\\ ] ] at time @xmath17 , we have : @xmath53 note that this corresponds to the limit case of the contract with penalized constraints when @xmath54 .",
    "furthermore , one shows that when the penalties @xmath55 in  ( [ penal ] ) , the  penalized \" price converge to the  firm \" price .",
    "this has been confirmed by extensive numerical implementations of both methods . in practice",
    "when @xmath56 both methods become indistinguishable for usual values of the volume constraints .      in this section we obtain a decomposition of the payoff of our swing contract ( with firm constraints ) into two parts , one having a closed form expression .",
    "it turns out that this simple decomposition leads to an impressive increase of the precision of the price computation .",
    "it plays the role of a variance reducer .",
    "moreover , its straightforward financial interpretation leads to a better understanding of the swing contract .",
    "in fact , we can distinguish a swap part and a normalized swing part : @xmath57}^{\\tilde{q}_{min},\\tilde{q}_{max}}(0,0)}\\mathbb{e}\\left(\\sum_{k=0}^{n-1}e^{-rt_k}q_{t_k } ( s_{t_k}-k)\\right)}_{normalized \\ contract}\\end{aligned}\\ ] ] where @xmath58}^{\\tilde{q}_{min},\\tilde{q}_{max}}(k , q ) = \\ { ( q_{t_\\ell})_{k\\leq \\ell \\leq n-1 } , q_{t_\\ell}:(\\omega,\\mathcal{f}_{t_\\ell},\\mathbb{p})\\mapsto [ 0,1 ] , \\sum_{\\ell = k}^{n-1 } q_{t_\\ell } \\in",
    "[ \\left(\\tilde{q}_{min}-q\\right)_+,\\tilde{q}_{max}-q]\\}\\ ] ] and @xmath59    the price models investigated in the following sections define the spot price as a process centered around the forward curve , and so @xmath60 is known for every @xmath61 $ ] .",
    "thus , the swap part has a closed form given by @xmath62    the adaptation to contracts with penalized constraints is straightforward and amounts to modifying the penalization function in an appropriate way .      in @xcite",
    ", it is shown that , in the penalized problem , optimal consumption is the solution of a dynamic programming equation .",
    "assume that for some positive constants p and c , the following inequality holds for any @xmath63 , and @xmath64 $ ] : @xmath65 then , there exists an optimal markovian consumption @xmath66 given by the maximum argument in the following dynamic programming equation : @xmath67}\\hskip -0.5 cm \\left\\{q(s_{t_k}-k )      + e^{-r(t_{k+1}-t_k ) } \\mathbb{e}(p(t_{k+1},s_{t_{k+1}},q_{t_k}+q)|s_{t_k})\\right\\ } , \\\\",
    "p(t , s_t , q_t)= p_{_t}(s_t , q_t ) .",
    "\\end{array } \\right.\\ ] ]    usually , the function @xmath68 is given by  ( [ penal ] ) .",
    "then , the case with firm constraints corresponds to the limit case where @xmath69\\}}$ ]",
    ".    when considering a contract with firm constraints , a more operating form ( see  @xcite ) can be the following @xmath70,\\ ; q_{t_k}+q\\!\\in[(q_{\\min}-(n - k)q_{\\max})_+,(q_{\\max}-(n - k)q_{\\min})_+ ] \\right\\}.\\end{aligned}\\ ] ]        @xcite showed the following theoretical result .",
    "consider the problem  [ eq : prix ] and @xmath71 , @xmath72 being a continuously differentiable function .",
    "if the following condition holds @xmath73 the optimal consumption at time @xmath8 is necessarily of bang - bang type given by @xmath74    the above assumption seems difficult to check since it involves the unknown optimal consumption . however",
    ", this would be the case provided one shows that the random variable @xmath75 is absolutely continuous as noticed in  @xcite .      in the companion paper  @xcite , we establish some properties of the value function of the swing options viewed _ as a function of the global volume constraints _ @xmath76 .",
    "thanks to  ( [ decompswing ] ) one may assume without loss of generality that the contract is normalized , @xmath9 @xmath77 and @xmath78 .",
    "we consider the following value function : @xmath79 defined on the unit ( upper ) simplex @xmath80 .",
    "the premium function @xmath81 is a concave , piecewise affine function of the global purchased volume constraints , affine on elementary triangles @xmath82 , @xmath83 , @xmath84 and @xmath85 ,",
    "@xmath83 , @xmath86 which tile of the unit ( upper ) simplex .    for integral valued global constraints , @xmath9 @xmath87 , there always exists a bang - bang optimal strategy @xmath9 the _ a priori _ @xmath88$]-valued optimal purchased quantities @xmath89 are in fact always equal to @xmath17 or @xmath90 .",
    "this result can be extended in some way to any couple of global constraints when all the payoffs are nonnegative ( see  @xcite ) .",
    "furthermore , it has nothing to do with the markov dynamics of the underlying asset and holds in a quite general abstract setting .",
    "an example of the premium function @xmath91 is depicted on figure  [ fig : pricesurface ] .",
    "@xmath92 the global constraints__,title=\"fig:\",width=472 ] +    now we turn to the problem of the numerical evaluation of such contracts .",
    "as announced , we focus on an optimal quantization algorithm .",
    "optimal quantization @xcite is a method coming from signal processing devised to approximate a continuous signal by a discrete one in an optimal way . originally developed in the 1950 s , it was introduced as a quadrature formula for numerical integration in the late 1990 s , and for conditional expectation approximations in the early 2000 s , in order to price multi - asset american style options .",
    "let @xmath93 be an @xmath94-valued random vector defined on a probability space @xmath95 .",
    "quantization consists in studying the best approximation of @xmath93 by random vectors taking at most @xmath96 fixed values @xmath97 .",
    "let @xmath98 .",
    "a partition @xmath99 of @xmath94 is a _",
    "voronoi tessellation _ of the @xmath96-quantizer @xmath100 ( or _ codebook _ ; the term _ grid _ being used for @xmath101 ) if , for every @xmath102 , @xmath103 is a borel set satisfying @xmath104 where @xmath105 denotes the canonical euclidean norm on @xmath94 .",
    "the nearest neighbour projection on @xmath100 induced by a voronoi partition is defined by @xmath106 then , we define an _",
    "@xmath100-quantization _ of @xmath93 by @xmath107 the _ pointwise error _ induced",
    "when replacing @xmath93 by @xmath108 is given by @xmath109 .",
    "when @xmath93 has an absolutely continuous distribution , any two @xmath100-quantizations are @xmath110-@xmath111 equal .",
    "the quadratic _ mean quantization error _ induced by the the @xmath96-tuple @xmath112 is defined as the quadratic norm of the pointwise error @xmath9 @xmath113 .",
    "we briefly recall some classical facts about theoretical and numerical aspects of optimal quantization . for details",
    "we refer @xmath114 to @xcite .",
    ", @xmath115.__,title=\"fig:\",width=302 ] +    @xcite let @xmath116 .",
    "the quadratic quantization error function @xmath117 reaches a minimum at some quantizer @xmath118 .",
    "furthermore , if the distribution @xmath119 has an infinite support then @xmath120 has pairwise distinct components and @xmath121 is decreasing to @xmath17 as @xmath122 .",
    "figure  [ fig : quantif2d ] shows a quadratic optimal quantization grid for a bivariate normal distribution @xmath123",
    ". the convergence rate to @xmath17 of optimal quantization error is ruled by the so - called zador theorem .",
    "@xcite let @xmath124 , with @xmath125 , @xmath126 ( @xmath127 lebesgue measure on @xmath94 ) .",
    "then @xmath128    the true value of @xmath129 is unknown as soon as @xmath130 .",
    "one only knows that @xmath131 .",
    "zador s theorem implies that @xmath132 as @xmath133 .",
    "@xcite any @xmath134-optimal quantizer @xmath135 satisfy the following stationarity property @xmath136 in particular , for any stationary quantizer @xmath137 .",
    "the random vector @xmath138 takes its value in a finite space @xmath139 , so for every continuous functional @xmath140 with @xmath141 , we have @xmath142 which is the quantization based quadrature formula to approximate @xmath143 @xcite .",
    "as @xmath138 is close to @xmath93 , it is natural to estimate @xmath144 by @xmath145 when @xmath146 is continuous .",
    "furthermore , when @xmath146 is smooth enough , on can upper bound the resulting error using @xmath113 , or even @xmath147 ( when the quantizer @xmath100 is stationary ) .",
    "the same idea can be used to approximate the conditional expectation @xmath148 by @xmath149 , but one also needs the transition probabilities : @xmath150    the application of this technique to the quantization of spot price processes is discussed in details in the annex , page .",
    "in this section we assume that @xmath151 is a markov process . for sake of simplicity ,",
    "we consider that there is no interest rate .",
    "we also consider a normalized contract , as defined in section [ section : decompswing ] .    in the penalized problem ,",
    "the price of the swing option is given by the following dynamic programming equation ( see equation [ eq : pgmdyn ] ) : + @xmath152 } \\\\ \\ \\\\",
    "p(t , s_t , q_t)= p_{_t}(s_t , q_t )    \\end{array } \\right.$ ] + where @xmath153 , @xmath154 .    the bang - bang feature of the optimal consumption ( see section [ section : bangbang ] ) allows us to limit the possible values of @xmath155 in the dynamic programming equation to @xmath156 . at time @xmath8 ,",
    "possible values of the cumulative consumption are @xmath157    at every time @xmath8 we consider a(n optimized ) @xmath158-quantization @xmath159 , @xmath160 based on an optimized quantization @xmath158-tuple ( or grid ) @xmath161 of the spot @xmath162 .",
    "the modeling of the future price by multi - factor gaussian processes with memory ( see section  4 for a toy example ) implies that @xmath163}$ ] is itself a gaussian process .",
    "then the quantization of @xmath162 can be obtained by a simple dilatation - contraction ( by a factor @xmath164 ) from optimal quantization grids of the ( possibly multivariate ) normal distribution , to be downloaded on the website  @xcite @xmath165    then we compute the price at each time @xmath8 , for all points on the corresponding grid , and for all the possible cumulative consumptions : @xmath166}\\\\ \\hskip 2,1 cm i=1,\\ldots , n_k , \\\\",
    "p(t , s_t^i,\\hat{q}_t)= p_{_t}(s_t^i,\\hat{q}_t),\\ ; i=1,\\ldots , n_n .",
    "\\end{array}\\right.\\ ] ]    when considering a contract with firm constraints , we need to compute the price at each time @xmath8 , for all the points of the quantization grid of the spot price , and for all the admissible cumulative consumptions ( see figure [ fig : admissiblevolume ] ) @xmath167    volume constraints_,title=\"fig:\",width=321 ] +    using the bang - bang feature ( see section [ section : bangbang ] ) and the dynamic programming principle ( equation  [ eq : pgmdynfirm ] ) , this price is given by @xmath168 \\right\\}.\\end{aligned}\\ ] ]    since @xmath169 takes its values in a finite space , we can rewrite the conditional expectation as : @xmath170 where @xmath171 is the",
    "_ quantized transition probability _ between times @xmath8 and @xmath172 . the whole set of quantization grids equipped with the transition matrices make up the so - called  quantization tree \" . the transition weights @xmath173 matrices are the second quantity needed to process the quantized dynamic programming principle  ( [ eq : quantizedpgmdyn ] or [ eq : quantizedpgmdynfirm ] ) .",
    "a specific fast parallel quantization procedure has been developed in our multi - factor gaussian framework to speed up ( and parallelize ) the computation of these weights ( see annex ) . in a more general framework , one can follow the usual monte carlo approach described in  @xcite to compute the grids and the transition of the global quantization tree .",
    "when @xmath174 has no longer a markov dynamics but appears as a function of a markov chain @xmath175 : @xmath176 , one can proceed as above , except that one has to quantize @xmath175 .",
    "then the dimension of the problem ( in term of quantization ) is that of the structure process @xmath175 .",
    "of course one can always implement the above procedure formally regardless of the intrinsic dynamics of @xmath174 .",
    "this yields to a drastic dimension reduction ( from that of @xmath93 downto that of @xmath174 ) .",
    "doing so , we can not apply the convergence theorem ( see section [ section : cvg ] ) which says that in a markovian framework the premium resulting from or will converge toward the true one as the size of the quantization grid goes to infinity .",
    "this introduces a methodological residual error that can be compared to that appearing in @xcite algorithm for american option pricing . however , one checks on simulations that this residual error turns out to be often negligible ( see  section  [ dimred ] ) .",
    "the first part of the algorithm consists in designing the quantization tree and the corresponding weights . the complexity of this step is directly connected to the size of the quantization grids chosen for the transitions computation in 1-dimension , or to the number of monte carlo simulations otherwise .",
    "however those probabilities have to be calculated once for a given price model , and then several contracts can be priced on the same quantization tree .",
    "so we will mainly focus on the complexity of the pricing part .",
    "we consider a penalized normalized contract , @xmath27 @xmath77 and @xmath78 .",
    "the implementation of the dynamic programming principle requires three interlinked loops . for each time step @xmath177",
    "( going backward from @xmath178 to @xmath17 ) , one needs to compute for all the points @xmath179 , @xmath180 of the grid and for every possible cumulative consumption @xmath181 ( @xmath182 ) ( see ( [ eq : cumulativevolume ] ) ) the functional @xmath183 } \\ ] ] which means computing twice a sum of @xmath184 terms .",
    "hence , the complexity is proportional to @xmath185 in the case where all layers in the quantization tree have the same size , @xmath27 @xmath186 , the complexity is proportional to @xmath187 .",
    "this is not an optimal design but _ only one grid needs to be stored_. it is possible to reduce the algorithm complexity by optimizing the grid sizes @xmath188 , which leads to a global complexity proportional to @xmath189(with the constraint @xmath190 ) , but it costs more memory space .",
    "+ in the case of firm constraints , the dynamic programming principle ( [ eq : quantizedpgmdynfirm ] ) has to be computed for every admissible cumulative consumption , @xmath27 for every @xmath181 ( @xmath191 , see ( [ eq : cumulativevolumefirm ] ) ) .",
    "the complexity is proportional to @xmath192    the complexity in the case of firm constraints is lower than the one for a penalized problem , and depends on the global constraints @xmath193 .",
    "but the implementation is easier in the case of a penalized problem , because one does not need to check if the cumulative consumption volume is admissible .",
    "both approaches have been numerically tested and results are indistinguishable for large enough penalties . for the implementation readiness , the approach with penalties has been adopted .",
    "in order to reduce the complexity of the algorithm , one usually prunes the quantization tree . in most examples , at each layer @xmath177 , many terms of the transition matrix @xmath194 are equal to 0 or negligible .",
    "so while the transition probabilities are estimated , all the transitions that are not visited are deleted .",
    "this step is important because it allows to reduce significantly the algorithm complexity .    in practice",
    "we can even neglect transitions whose probability is very low , say less than @xmath195 .      in @xcite",
    "is proved an error bound for the pricing of swing options by optimal quantization .",
    "let @xmath196 denote the price of the swing contract at time @xmath17 .",
    "@xmath178 is the number of time step , and @xmath197 is the global constraint .",
    "we consider a contract with normalized local constraints , @xmath27 @xmath77 and @xmath78 .",
    "the  quantized \" price @xmath198 is the approximation of the price obtained using optimal quantization .",
    "assume there is a real exponent @xmath199 such that the ( @xmath200-dimensional ) markov structure process @xmath201 satisfies @xmath202 at each time @xmath203 , we implement a ( quadratic ) optimal quantization grid @xmath204 of size @xmath96 of @xmath205 .",
    "then @xmath206 where @xmath207 is the set of admissible global constraints ( at time @xmath17 ) .",
    "in fact this error bound turns out to be conservative and several numerical experiments , as those presented in section [ section : numerical ] , suggest that in fact the true rate ( for a fixed number @xmath178 of purchase instants ) behaves like @xmath208 .",
    "in this section the same grid size has been used at each time step , @xmath9 we always have @xmath209 .",
    "the results have been obtained by implementing the penalized problem and using the canonical decomposition ( see section  [ section : decompswing ] ) .",
    "swing options are often priced using the least squares regression method   la longstaff - schwartz \" @xcite .",
    "this section aims to compare our numerical results to those obtained with longstaff - schwartz method .",
    "we consider a one factor model , which corresponds to a one dimensional markov structure process .",
    "we consider the following diffusion model for the forward contracts @xmath210 : @xmath211 where @xmath212 is a standard brownian motion .",
    "it yields : @xmath213 where @xmath214 denote @xmath215 .",
    "the structure process @xmath216 can be quantized using the fast parallel quantization method described in the annex ( page ) .",
    "let @xmath217 denote an ( optimal ) quantization grid of @xmath205 of size @xmath96 .",
    "we have to compute for every @xmath218 , and every @xmath219 , the following ( quantized transition ) probabilities : @xmath220 where @xmath221 , and @xmath222 and @xmath223 are scalar coefficients that can be explicited .",
    "this can be done by using quantization again and importance sampling as presented in the annex , page ( see  ( [ eq : importancesampling1d ] ) ) .",
    "we first use the following parameters for the one factor model :    @xmath224 , @xmath225 , @xmath226 .",
    "the following tables present the results obtained with longstaff schwartz and optimal quantization , for different strike values .",
    "@xmath227 monte - carlo sample paths have been used for longstaff - schwartz method and the confidence interval of the monte carlo estimate is given in the table .",
    "a @xmath228-point grid has been used to quantize the spot price process , and the transitions have been computed with a @xmath229-point grid .",
    "the local volume constraints @xmath230 and @xmath231 are set to @xmath17 and @xmath232 respectively .",
    "we first consider a case without constraints ( table [ tab : ls1 ] ) , which means that the swing option is a strip of calls , whose price is easily computed with the black - scholes formula .",
    "._[tab : ls1]comparison for a call strip ( no global constraints ) _ [ cols=\"<,^,^,^,^\",options=\"header \" , ]     the convergence rate obtained in this case is always @xmath233 , which is consistent with the general rate @xmath234 , because the quantized process is @xmath235-valued .    therefore , even if the spot process is not markov , the quantization method can be performed all the same way as if it were , with small damage in practice .",
    "this is of course not a general consideration but rather an observation over the considered problem .",
    "the dramatic increase in the computation effort that can be gained from this observation can justify in this case a lack of formal rigor .",
    "in this article , we have introduced an optimal quantization method for the valuation of swing options .",
    "these options are of great interest in numerous modeling issues of the energy markets and their accurate pricing is a real challenge . + our method has been compared to the famous longstaff - schwartz algorithm and seems to perform much better on various examples .",
    "in fact , the optimal quantization method shares the good properties of the so called tree method but is not limited by the dimension of the underlying .",
    "moreover , specific theoretical results provide _ a priori _ estimates on the error bound of the method .",
    "+ thus , optimal quantization methods suit very well to the valuation of complex derivatives and further studies should be done in order to extend the present results to other structured products arising in the energy sector .",
    "0 ( 2001 ) .",
    "a quantization algorithm for solving multi - dimensional optimal stopping problems , _ bernoulli _ , * 6*(9 ) , 1 - 47 .",
    "error analysis of the quantization algorithm for obstacle problems , stochastic processes & their applications , * 106*(1 ) , 1 - 40 .",
    "a quantization tree method for pricing and hedging multi - dimensional american options , _ mathematical finance _ , * 15*(1 ) , 119 - 168 .",
    "pricing swing options using optimal quantization , pre - print lpma-1141 . , ( 1995 ) .",
    "numerical valuation of high dimensional multivariate american securities , _ journal of financial and quantitative analysis _ * 30 * 3 , 383 - 405 .",
    "numerical methods for the pricing of swing options : a stochastic control approach , _ methodology and computing in applied probability_. ( 2007 ) .",
    "optimal switching with applications to energy tolling agreements , pre - print .",
    "gas storage and supply guarantees : an optimal switching approach , pre - print .",
    "optimal multiple - stopping of linear diffusions and swing options , pre - print .",
    "optimal multiple stopping and valuation of swing options , _ mathematical finance _ , to appear .",
    "( 2002 ) . risk analysis of swing contracts , _ energy and power risk management_. ( 2005 ) .",
    "swing options : a mechanism for pricing it peak demand ( 2003 ) . energy and power risk management , _ wiley finance _ ( 2005 ) . _ commodities and commodity derivatives - modeling and pricing for agriculturals , metals and energy _ , wiley finance .",
    "( 2000 ) . _",
    "foundations of quantization for probability distributions_. lect .",
    "notes in math .",
    "1730 , springer , berlin .",
    "valuation of commodity - based swing options , _ management science _ , * 50 * , 909 - 921 . ( 2004 ) .",
    "pricing of electricity swing options , _ journal of derivatives _ , * 11 * , 26 - 43 .",
    "( 2001 ) . a discrete valuation of swing options , _",
    "canadian applied mathematics quarterly _ , * 9*(1 ) , 35 - 74 .",
    "( 2001 ) . valuing american options by simulation :",
    "a simple least squares approach , _ the review of financial studies _ , * 14 * , 113 - 147 .",
    "monte carlo methods for the valuation of multiple exercise options , _ mathematical finance _ , * 14 * , @xmath236 . ( 1998 ) .",
    "a space vector quantization method for numerical integration , _ j. computational and applied mathematics _",
    ", 89 , 1 - 38 .",
    "optimal quantization methods and applications to numerical problems in finance , _ handbook of numerical methods in finance _ , ed .",
    "s. rachev , birkhauser , 253 - 298 .",
    "www.quantize.maths-fi.fr , website devoted to quantization ,",
    "_ maths-fi.com _",
    "structure of swing contract value and optimal strategy , _ the 2006 stochastic modeling symposium and investment seminar , canadian institute of actuaries _ ( 1995 ) .",
    "valuation of path - dependent contingent claims with multiple exercise decisions over time : the case of take or pay .",
    "_ journal of financial and quantitative analysis _ , * 30 * , 271 - 293 . ( 2006 ) .",
    "finite element valuation of swing options , pre - print .",
    "asymptotic quantization error of continuous signals and the quantization dimension , _ ieee trans .",
    "inform . theory _",
    ", * 28 * , special issue on quantization , a. gersho & r.m .",
    "grey eds , 139 - 149 .        in this annex",
    "we propose an efficient method to quantize a wide family of spot price dynamics @xmath174 .",
    "to be precise we will assume that a time discretization @xmath237 being fixed , @xmath238 where @xmath239 is a @xmath240-valued gaussian auto - regressive process and @xmath241 a family of continuous functions .",
    "the fast quantization method applies to the gaussian process @xmath242",
    ". we will apply it to a scalar two factor model in full details . as a conclusion to this section",
    "we will sketch the approach to a multi - factor model .",
    "we consider a centered gaussian first order auto - regressive process in @xmath240 : @xmath243 where @xmath244 , @xmath245 lower triangular , and @xmath246 i.i.d . with @xmath247 distribution .",
    "+ denote by @xmath248_{1\\leq i , j\\leq m}$ ] the covariance matrix of @xmath249 .",
    "we have @xmath250 : @xmath251 denote @xmath252 the lower triangular matrix such that @xmath253 .",
    "we consider for every @xmath254 , an _ optimal ( quadratic ) quantizer _ @xmath255 of size @xmath158 , for the @xmath247 distribution .",
    "the quantization grid of the random variable @xmath205 is taken as a dilatation of @xmath255,@xmath27 @xmath256    to calculate the conditional expectations in the dynamic programming equation , we need to get the following transition probabilities : @xmath257 where @xmath103 denotes the @xmath258-th voronoi cell of the generic quantizer @xmath259",
    ". then @xmath260 with @xmath261 .",
    "this probability is provided as a companion parameter with the normal distribution grid files ( available on  @xcite ) .",
    "let @xmath93 be a discrete time process described as above .",
    "let @xmath264 , @xmath265 be two gaussian random variables @xmath247 .",
    "then we have for every @xmath266 , every @xmath267 , every @xmath268 , @xmath269 where @xmath270 and @xmath271 are @xmath272 matrices whose coefficients depend on @xmath177 , and on the matrices @xmath49 , @xmath14 .",
    "if @xmath273 , @xmath274    we have : @xmath275",
    "we consider the couple @xmath276 .",
    "@xmath277 is independent of @xmath205 .",
    "let @xmath278 a couple of independent gaussian random vectors : @xmath279 .",
    "then @xmath280 and @xmath281 setting @xmath282 we get @xmath283        to simplify the structure of the quantization tree we propose to consider the same normalized grid of size @xmath286 at each step @xmath177 but other choices are possible like those recommended in @xcite .",
    "@xmath287 the standard monte carlo approach the simplest way is to use a monte carlo method .",
    "one just needs to simulate couples of independent gaussian random variables @xmath288 .",
    "this approach can be used whatever the dimension @xmath289 of the random variables @xmath290 and @xmath291 is .",
    "it can clearly be parallelized as any mc simulation but fail to estimate the transition form states which are not often visited .",
    "@xmath287 fast parallel quantization method in order to improve the accuracy , especially for the points @xmath292 of the grids @xmath293 which are rarely reached by the paths starting from the cell of @xmath294 , it is possible to perform importance sampling .",
    "the idea is to use cameron - martin formula to re - center the simulation : for every @xmath295 and every @xmath296 , @xmath297 then these expectations can be computed by monte carlo simulations , the transitions between the different times steps can be computed in parallel .",
    "@xmath287 quantized parallel quantization method if @xmath298 , the transitions can be computed using again optimal quantization , because in low dimension ( say @xmath299 ) , quantization converges faster than monte carlo method . in this case , we have to compute a two dimensional expectation .",
    "we estimate for every @xmath300 , every @xmath301 and every @xmath302 the following probabilities : @xmath303 where @xmath221 , and @xmath222 and @xmath223 are scalar coefficients satisfying @xmath304 : @xmath305        in order to reduce the problem dimension , it is possible to write the probability @xmath310 as a double integral , and to integrate first with respect to the second variable by using fubini theorem : @xmath311 where @xmath312 is the distribution function of the normal distribution",
    ".    importance sampling can again be used to improve the results precision .",
    "eventually we have to compute the following one dimensional expectation : @xmath313 .",
    "\\label{eq : importancesampling1d}\\end{gathered}\\ ] ] for this one - dimensional expectation computation , quantization can be used again since it converges faster than monte carlo method .",
    "[ prop : ou ] let @xmath323 be an ornstein - uhlenbeck process . @xmath324 where @xmath50 is a standard brownian motion , and @xmath325 is gaussian and independent of @xmath50 . @xmath249 can be written at discrete times @xmath326 as a first order auto - regressive process : @xmath327 where @xmath246 is i.i.d and @xmath328 .",
    "more generally , we consider a family of price dynamics that can be written as follows : @xmath334 where @xmath335 is a polynomial function of degree @xmath336 , for every @xmath337 , and @xmath212 is a brownian motion , with @xmath338 .      in order to price a swing option with such a model ,",
    "we first need to quantize it .",
    "equation  ( [ eq : model ] ) yields : @xmath342 where @xmath343 practically we focus on the spot price @xmath344 or the day - ahead contract @xmath23 .",
    "unfortunately these processes are not markovian in a general setting , except when @xmath345 and @xmath346 ( ornstein - uhlenbeck process ) .",
    "using a dimension argument , only the linear independence of the family has to be checked .",
    "and we have @xmath357 since @xmath358 is a basis of @xmath359 $ ] , it yields @xmath360 so that @xmath361 since @xmath362_{0 \\leq k , j \\leq d } \\neq 0 $ ] ( vandermonde determinant ) .",
    "@xmath205 is the structure process for the spot price @xmath377 .",
    "its dimension is @xmath378 .",
    "for the two factor model , the structure process is @xmath379-valued , because @xmath339 , and @xmath380 .",
    "this is coherent with ( [ eq : sructure2f ] ) ."
  ],
  "abstract_text": [
    "<S> in this paper , we investigate a numerical algorithm for the pricing of swing options , relying on the so - called optimal quantization method .    </S>",
    "<S> the numerical procedure is described in details and numerous simulations are provided to assert its efficiency . in particular , we carry out a comparison with the longstaff - schwartz algorithm .    _ </S>",
    "<S> key words : swing options , stochastic control , optimal quantization , energy . _ </S>"
  ]
}