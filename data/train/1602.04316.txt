{
  "article_text": [
    "consider an edge weighted directed graph as a model of a neural network .",
    "such network can be build up using real life measurements ( see for example , @xcite ) , and neuroscientists are interested in comparing this network with random networks . if the edges were not weighted , the typical approach would be to generate random graphs with prescribed in and out degrees .",
    "this topic has a tremendous literature , see for example , @xcite , just to mention a few .    in case of weights",
    "are introduced , one might want to generate a random graph that keeps not only the sum of the weights but also individual weights .",
    "the weights can be transformed into colors , and then we are looking for an edge colored graph with prescribed in and out degrees for each color .",
    "this problem is known as finding edge packing @xcite , edge disjoint realizations @xcite , or degree constrained edge - partitioning @xcite .",
    "the problem has also applications in discrete tomography @xcite . above finding one edge colored graph with given constraints ,",
    "it is also an important problem how to generate a `` typical '' solution , as we can see in the before mentioned neuroscientific problem .",
    "unfortunately , the general edge packing problem is np - complete even if the number of colors is 2 @xcite . although the general problem is np - complete , special cases are tractable .",
    "such special cases include the case when the number of colors is 2 and the subgraph with one of the colors is almost regular @xcite .",
    "another tractable case is when the graph is bipartite , the number of colors is 2 , and there exist constants @xmath2 and @xmath3 such that for each vertex , the total number of edges in one of the vertex class is @xmath4 , @xmath2 or @xmath5 and in the other vertex class is @xmath6 , @xmath3 or @xmath7 @xcite .",
    "when the number of colors is unlimited , tractable solutions exist if the graphs are forests for each color @xcite or the graphs are forests for each color except one of the colors might contain one cycle @xcite .",
    "a special case is when the bipartite graph is the union of @xmath8 1-factors .",
    "such edge packings are simply the latin squares . for any @xmath8 ,",
    "latin squares exist , and even a markov chain is known that explores the space of latin squares for a fixed @xmath8 @xcite .",
    "this markov chain is conjectured to be rapidly mixing , that is , computationally efficient to sample random latin squares .",
    "the conjecture has neither proved nor disproved in the last twenty years .    in this paper",
    ", we consider another tractable case with unlimited number of colors .",
    "we require that the subgraphs for each color be half - regular , that is , the degrees are constant on one of the vertex class .",
    "we further require that this regular vertex class be the same for all colors .",
    "we give sufficient and necessary conditions when this edge packing problem has a solution .",
    "we also give necessary and sufficient perturbations to transform solutions into each other .",
    "a markov chain monte carlo method has been given using these perturbations , and we give a proof that the inverse of the acceptance ratio is polynomial bounded .",
    "in this paper , we are going to work with realizations of half - regular degree matrices , defined below .    a _ bipartite degree sequence _ @xmath9 is a pair of sequences of non - negative integers .",
    "a bipartite degree sequence is _ graphical _ if there exists a simple bipartite graph @xmath10 whose degrees correspond exactly to @xmath11 .",
    "we say that @xmath10 is a _ realization _ of @xmath11 .    a _ bipartite degree matrix _",
    "@xmath12 is a pair of @xmath13 and @xmath14 matrices of non - negative integers .",
    "a bipartite degree matrix is graphical if there exists an edge colored simple bipartite graph @xmath0 such that for all color @xmath15 and for all @xmath16 , the number of edges of @xmath17 with color @xmath15 is @xmath18 and for all @xmath19 , the number of edges of @xmath20 with color @xmath15 is @xmath21 .",
    "such graph is called a _",
    "realization _ of @xmath22 .",
    "a bipartite degree matrix is _ half - regular _ if for all @xmath23 , @xmath24 .",
    "the rows of @xmath22 are bipartite degree sequences that are also called _ _ factor__s and the edge colored realization of @xmath22",
    "is also called an _ @xmath22-factorization_.    we consider two problems .",
    "one is the existence problem which asks the question if there is a realization of a half - regular degree matrix .",
    "the other is the sampling problem , which considers the set of all realizations of a half - regular degree matrix and asks the question how to sample uniformly a realization from this set .",
    "markov chain monte carlo ( mcmc ) methods are generally applicable for such problems , and we are also going to introduce an mcmc for sampling realizations of half - regular degree sequences .",
    "below we introduce the main definitions .",
    "a _ discrete time , finite markov chain _ is a random process that undergoes transitions from one state to another in a finite state space .",
    "the process has the markov property which means that the distribution of the next state depends only on the current state .",
    "the transition probabilities can be described with a transition matrix @xmath25 , where @xmath26 , namely , the conditional probability that the next state is @xmath27 given that the current state is @xmath28 . when the state space is a large set of combinatorial objects ,",
    "the transition probabilities are not given explicitly , rather , a random algorithm is given that generates a random @xmath27 by perturbing the current state @xmath28 .",
    "such algorithm is called _",
    "transition kernel_.    when the process starts in a state @xmath27 , after @xmath29 number of steps , it will be in a random state with distribution @xmath30 , where @xmath31 is the column vector containing all @xmath32 s except for coordinate @xmath33 , which is @xmath34 .",
    "the markov chain monte carlo method is the way to tailor the transition probabilities such that the limit distribution @xmath35 be a prescribed distribution . to be able to do this , necessary conditions are that the markov chain be irreducible , aperiodic and the transitions be reversible defined below .    given a discrete time , finite markov chain on the state space @xmath36 , the _ markov graph _ of the markov chain is a directed graph @xmath37 , with vertex set @xmath36 and there is an edge from @xmath38 to @xmath39 iff @xmath40 .",
    "a markov chain is _ irreducible _ iff its markov graph is strongly connected .",
    "when the transition kernel of an irreducible markov chain generates a class of perturbations , we also say that this class of perturbations is irreducible on the state space .",
    "a markov chain is _ aperiodic _ if the largest common divisor of cycle lengths of its markov graph is 1 .",
    "this automatically holds , if there is a loop in the markov chain , that is , a state @xmath41 exists for which @xmath42 .",
    "the transition kernel of a markov chain is reversible if for all @xmath43 , @xmath44 .",
    "the strength of the theory of markov chain monte carlo is that any irreducible , aperiodic markov chain with reversible transition kernel can be tailored into a markov chain converging to a prescribed distribution as stated below .",
    "@xcite let an irreducible , aperiodic markov chain be given with reversible transition kernel @xmath45 over the finite state space @xmath36 .",
    "let @xmath46 be a distribution over @xmath36 , for which @xmath47 , @xmath48 .",
    "then the following algorithm , called the metropolis - hastings algorithm , also defines a markov chain that converges to @xmath46 , namely , its transition kernel @xmath49 satisfies @xmath50 for all indices @xmath33 .    1 .",
    "draw a random @xmath51 following the distribution @xmath52 where @xmath53 is the current state of the markov chain after @xmath29 steps .",
    "2 .   draw a random @xmath54 following the uniform distribution over @xmath55 $ ] . the next state , @xmath56 , will be @xmath51 if @xmath57 and @xmath53 otherwise .",
    "the ratio in the second step of the algorithm is called the metropolis - hastings ratio .",
    "it is simplified to @xmath58 when the target distribution @xmath46 is the uniform one .",
    "when this ratio is small , the markov chain defined by the algorithm tends to remain in the same state for a long time , thus increasing the mixing time , namely , the number of steps necessary to get close to the target distribution .    in this paper , we introduce perturbations that are irreducible on the realizations of a half - regular degree matrix . using these perturbations",
    ", we design a reversible transition kernel , for which @xmath59 where @xmath60 is the number of vertices in vertex class @xmath61 .",
    "let @xmath37 be a multigraph , and for each @xmath62 , let @xmath63 be @xmath64 where @xmath65 denotes the multiplicity of edge @xmath66 . the _ exceed number _ of graph @xmath10",
    "is defined as @xmath67    clearly , the exceed number is @xmath32 iff @xmath10 is a simple graph .",
    "[ the : regular - factorization ] let @xmath68 be a half - regular bipartite degree matrix .",
    "the bipartite complete graph @xmath69 has an @xmath22-factorization iff    1 .",
    "@xmath70 , @xmath71 2 .",
    "@xmath72 3 .",
    "@xmath73 , @xmath74 .",
    "@xmath75 if @xmath69 has an @xmath22-factorization , then clearly , all factors are graphical and the degrees sum to the degrees of the complete bipartite graph . conditions @xmath76 and @xmath77 explicitly state that the sum of the degrees in the factors sum up to the degree of the complete bipartite graph .",
    "condition @xmath34 states that in each factor , the sums of the degrees in the two vertex classes are the same , which is a necessary condition for a graphical degree sequence .",
    "@xmath78 conditions @xmath76 and @xmath77 also say implicitly that for each @xmath33 , @xmath79 and for each @xmath80 , @xmath81 . together with condition @xmath34 , they are sufficient conditions that a half - regular bipartite degree sequence be graphical .",
    "namely , the theorem says if all factors are graphical and the sums of the degrees are the degrees of the complete bipartite graph , then @xmath69 has such a factorization .    for each @xmath33 ,",
    "let @xmath82 be a realization of the degree sequence @xmath83 .",
    "let @xmath84 .",
    "color the edges of @xmath10 such that an edge is colored by color @xmath15 if it comes from the realization @xmath82 .",
    "@xmath10 might be a multigraph , however , for each color @xmath15 and each pair of vertices @xmath85 , there can be at most one edge between @xmath54 and @xmath86 with color @xmath15 . if @xmath87 , then @xmath10 is a simple graph , and due to the conditions , it is @xmath69 , thus we found an @xmath22-factorization of @xmath69 .",
    "assume that @xmath88 .",
    "then there is a pair of vertices @xmath85 such that there are more than one edge between @xmath54 and @xmath86 .",
    "fix one such pair @xmath66 , and let @xmath89 denote the set @xmath90 .",
    "since the degree of @xmath86 in @xmath10 is @xmath8 , there must be a @xmath91 such that there is no edge between @xmath91 and @xmath86 .",
    "let @xmath92 denote the set of colors that appear as edge colors between @xmath54 and @xmath86 .",
    "since for each color @xmath15 , @xmath54 and @xmath91 has the same number of edges with color @xmath15 , there must be at least one vertex @xmath93 such that there are more edges with color from @xmath92 between @xmath91 and @xmath93 than the edges with color from @xmath92 between @xmath54 and @xmath93 .",
    "let @xmath94 denote the set of vertices for which this condition holds .",
    "there are three possibilities ( see also figure  [ fig : firstiteration ] ) :    1 .",
    "there is a vertex @xmath95 such that there are more than one edge between @xmath91 and @xmath93 .",
    "2 .   there is a vertex @xmath95 such that there is only a single edge between @xmath91 and @xmath93 , however , there is no edge between @xmath54 and @xmath93 .",
    "3 .   for each vertex @xmath95",
    ", there is only a single edge between @xmath91 and @xmath93 and there is at least one edge between @xmath54 and @xmath93 .     and @xmath86 .",
    "see text for details.,width=278 ]    if case @xmath34 holds , then let @xmath96 be a color in @xmath92 such that there is a @xmath96 colored edge between @xmath91 and @xmath93 and there is no @xmath96 colored edge between @xmath54 and @xmath93 . remove that edge between @xmath54 and @xmath86 and also between @xmath91 and @xmath93 and add a @xmath96 colored edge between @xmath91 and @xmath86 and also between @xmath54 and @xmath93 .",
    "note that @xmath97 , the graph with color @xmath96 remains a simple graph with the prescribed degree sequence .",
    "@xmath63 decreases by @xmath34 .",
    "@xmath98 remain @xmath32 , since the edge with color @xmath96 is the only edge between them .",
    "@xmath99 decreases by @xmath34 .",
    "@xmath100 might increase by @xmath34 if there was already at least one edge between them before the change , otherwise it remains the same .",
    "altogether , @xmath101 is decreased at least by @xmath34 .",
    "if case @xmath76 holds , then do the same edge changing than in case @xmath34 .",
    "this causes a decrease in @xmath63 by one , and no change in @xmath98 , @xmath100 and @xmath99 .",
    "altogether , @xmath101 decreases by @xmath34 .    in case @xmath77 , select a subset @xmath102 from @xmath94 such that the colors of edges between @xmath91 and the vertices in @xmath102 are exactly the set @xmath92 .",
    "this is doable , since for each vertex @xmath95 , there is only one edge between @xmath91 and @xmath93 , furthermore , the union of colors of edges between @xmath91 and @xmath94 must contain a subset @xmath92 .",
    "let @xmath103 denote the ( possibly multi)set of colors that appear as edge colors between vertex @xmath54 and the set of vertices @xmath102 .",
    "the multiset of colors between @xmath54 and @xmath104 is @xmath105 , where @xmath106 denote the multiset union , while the set of colors between @xmath91 and @xmath104 is @xmath92 .",
    "therefore , there is at least one vertex @xmath107 such that the number of edges with colors from @xmath103 between @xmath91 and @xmath93 is more than the number of edges with color from @xmath103 between @xmath54 and @xmath93 .",
    "let @xmath94 denote the set of vertices with this property .",
    "if case @xmath77 holds , then we can select a subest @xmath108 from @xmath94 such that the multiset of colors between vertex @xmath91 and @xmath108 is exactly @xmath103 .",
    "then the multiset of colors between @xmath54 and @xmath109 is @xmath110 , while the multiset of colors between @xmath91 and @xmath109 is @xmath105 .",
    "therefore , while case @xmath77 holds , we can select the subset of vertices @xmath111 such that the number of edges with colors from @xmath112 between @xmath91 and @xmath93 is more than the number of edges with colors from @xmath112 between @xmath54 and @xmath93 , and from this set , we can select an appropriate subset @xmath113 .",
    "since there are finite number of vertices in @xmath114 , for some @xmath115 , case @xmath34 or @xmath76 must hold ( see also figure  [ fig : iteration ] ) .",
    "let @xmath93 be the vertex for which case @xmath34 or @xmath76 holds , and let @xmath116 be the color such that there is an edge with color @xmath116 between @xmath93 and @xmath91 and there is no such edge between @xmath54 and @xmath93 .",
    "remove that edge between @xmath91 and @xmath93 and add between @xmath54 and @xmath93 .",
    "let @xmath117 be a vertex such that there is an edge between @xmath54 and @xmath118 with color @xmath116 .",
    "remove that edge and add between @xmath91 and @xmath118 .",
    "let the color between @xmath91 and @xmath118 be @xmath119 .",
    "remove it and add between @xmath54 and @xmath118 .",
    "( note that due to the definition of @xmath94 and due to case @xmath77 held in the @xmath120st iteration , before the change , there was no @xmath119 colored edge between @xmath54 and @xmath118 , thus after the change , all edges between @xmath54 and @xmath118 have different colors . ) iterate this process ; in the @xmath121th iteration , let @xmath122 be a vertex in @xmath123 such that there is an edge with color @xmath124 between @xmath54 and @xmath122 . remove that edge and add between @xmath91 and @xmath122 , remove the edge with color @xmath125 between @xmath91 and @xmath122 and add between @xmath54 and @xmath122 .",
    "finally , remove the edge with color @xmath96 between @xmath54 and @xmath86 and add it between @xmath91 and @xmath86 .",
    "let this new graph be @xmath126 . then in @xmath126 , @xmath63 decreases by 1",
    ", @xmath98 remains the same .",
    "for each @xmath127 , neither @xmath128 nor @xmath129 is changed since the total number of edges between them is not changed . finally , @xmath130 is not increased .",
    "altogether , @xmath131 is at least @xmath34 less than @xmath101 . on figure",
    "[ fig : iteration ] , it is easy to verify that all vertices participating in the modification of @xmath10 , the same colored edges were removed and added .",
    "therefore , @xmath126 is still the union of realizations of the prescribed degree sequences .",
    "since the exceed number is a non - negative finite integer , after a finite number of steps , the exceed number will be @xmath32 , thus we get @xmath69 as an @xmath22-factorization .",
    "it is clear that one of the colors might encode `` non - edge '' , namely , we can delete those edges and get a realization of a half - regular degree matrix obtained by deleting one row from @xmath22 .",
    "therefore , the following theorem also holds .",
    "[ theo : extended halfregular ] let @xmath68 be a half - regular bipartite degree matrix",
    ". then @xmath22 has a realization iff    1 .",
    "@xmath70 , @xmath71 2 .",
    "@xmath132 3 .",
    "@xmath73 , @xmath133 .",
    "it is clear that equality in condition 2 holds iff equality in condition 3 holds for all @xmath115 . in case of equality , we get back theorem  [ the : regular - factorization ] . in case of inequality , let @xmath134 and let @xmath135 extend @xmath22 with this @xmath136st row , and this matrix will satisfy the conditions of theorem  [ the : regular - factorization ] . find a realization of this extended matrix , and delete the edges with the @xmath136st color , thus obtain a realization of @xmath22 .    in the following section , we consider the solution space of realizations of half - regular degree matrices .",
    "since there is no difference of realizations of half - regular degree matrices and @xmath22-factorizations of the complete bipartite graph @xmath69 , we will consider this later , namely , we consider non - edges as @xmath136st colors when non - edges exist .",
    "in this section , we give necessary and sufficient perturbations to transform any realization of a half - regular bipartite degree matrix , @xmath22 , into another realization of @xmath22 .",
    "first , we extend the space of graphs on which perturbations are applied .",
    "we show how to transform a realization of @xmath22 into another realization in this extended space , then we show how to transform realizations into each other remaining in the space of realizations .",
    "the concept is very similar to the concept applied in paper @xcite , but different perturbations are necessary to temporarily extend the space of graphs .",
    "first , we introduce the necessary definition , the @xmath137 deficiency .",
    "we will extend the space of graphs that have at most @xmath77 vertices with deficiency .",
    "we show how to transform @xmath138 , a realization of @xmath22 into another realization @xmath139 , via graphs having at most @xmath77 vertices with deficiency . in doing so",
    ", we first arrange the colored edges of a vertex @xmath140 that they agree with realization @xmath139 .",
    "then we fix these edges , and reduce the problem to a similar , smaller problem .",
    "note that @xmath1 is the regular class , and if we fix ( technically : remove ) the vertex @xmath141 together with its edges , the remaining graph is still half - regular .",
    "finally , we prove how to transform realizations of @xmath22 into each other remaining in the space of realizations of @xmath22 .",
    "first , we define deficiency .",
    "let @xmath22 be a bipartite degree matrix , and let @xmath10 be an edge colored bipartite graph .",
    "we say that a vertex @xmath17 in @xmath10 has a @xmath142-deficiency w.r.t .",
    "@xmath22 if the number of its @xmath143 colored edges is @xmath144 , the number of its @xmath145 colored edges is @xmath146 and for all other @xmath147 , the number of @xmath15 colored edges of @xmath17 is @xmath18 .",
    "then we define an auxiliary graph that we use several times .",
    "[ def : auxiliaryk ] let @xmath0 be an edge colored bipartite graph in which the edges are colored with colors @xmath148 , and let @xmath54 and @xmath91 be two vertices in @xmath1 . then the directed , edge labeled multigraph @xmath149 is defined in the following way .",
    "the vertices of @xmath150 are the colors @xmath148 , and for each @xmath151 , there is an edge going from @xmath15 to @xmath152 , where @xmath15 is the color of the edge between @xmath54 and @xmath86 and @xmath152 is the color of the edge between @xmath91 and @xmath86 . such edge is labeled with @xmath86 .",
    "the next two lemmas show how to handle graphs with a small amount of deficiency .",
    "[ lem : broken - permutation ] let @xmath10 be such an edge colored simple graph of @xmath69 which is almost a factorization of a half - regular bipartite degree matrix @xmath12 in the following sense :    1 .   for each color @xmath15 and vertex @xmath39 ,",
    "the number of edges with color @xmath15 is @xmath153 .",
    "2 .   for each color @xmath15 and vertex",
    "@xmath17 the number of edges with color @xmath15 is @xmath18 except for two colors @xmath143 and @xmath145 and two vertices @xmath154 and @xmath155 , where @xmath154 has a @xmath142-deficiency and @xmath155 has a @xmath156-deficiency .",
    "then there exists a perturbation of @xmath10 that affects only edges of @xmath154 and @xmath155 and transforms @xmath10 into a realization of @xmath22 .",
    "consider @xmath157 .",
    "for each vertex @xmath15 , @xmath158 of the graph @xmath157 , the number of incoming and outgoing edges are the same , while @xmath143 has two more outgoing edges than incoming and @xmath145 has two more incoming edges than outgoing .",
    "therefore , there is a trail from @xmath143 to @xmath145 due to the pigeonhole principle . for each edge @xmath159 labeled by @xmath160 along the trail , swap the corresponding edges in @xmath10 , namely , the edge between @xmath154 and @xmath160 and the edge between @xmath155 and @xmath160 .",
    "this transforms @xmath10 into a realization of @xmath22 .",
    "indeed , @xmath154 will have one less edge with color @xmath143 and one more edge with color @xmath145 while the effect on @xmath155 is the opposite .",
    "the number of edges with other colors are not affected , since in the trail , the number of incoming and outgoing edges are the same for all colors not @xmath143 and not @xmath145 , and swapping the edges in @xmath10 is equivalent with inverting the direction of the corresponding edges in @xmath157 .",
    "[ lem : broken - permutation - ii ] let @xmath10 be such an edge colored simple graph of @xmath69 which is almost a factorization of a half - regular bipartite degree matrix @xmath12 in the following sense    1 .   for each color @xmath15 and vertex @xmath39 ,",
    "the number of edges with color @xmath15 is @xmath153 .",
    "2 .   for each color @xmath15 and vertex @xmath17 , the number of edges with color @xmath15 is @xmath18 except for three colors @xmath161 and @xmath162 and three vertices @xmath154 , @xmath155 and @xmath163 , for which @xmath154 has @xmath142-deficiency",
    ", @xmath155 has @xmath164-deficiency and @xmath163 has @xmath165-deficiency .    then there exists a perturbation of @xmath10 that affects only edges of @xmath166 and @xmath167 and transforms @xmath10 into an edge colored simple graph of @xmath69 satisfying conditions 1 and 2 in lemma  [ lem : broken - permutation ] .",
    "consider the graph @xmath168 .",
    "for each vertex @xmath15 , @xmath169 of the graph @xmath168 , the number of incoming and outgoing edges are the same , while @xmath162 has two more outgoing edges than incoming and @xmath143 and @xmath145 has one - one more incoming edges than outgoing .",
    "therefore there is a trail from vertex @xmath162 to @xmath145 ( and also to @xmath143 ) due to the pigeonhole principle .",
    "take a trail from @xmath162 to @xmath143 , and for each edge along the trail , swap the corresponding edges in @xmath10 , namely , the edge between @xmath155 and @xmath160 and the edge between @xmath163 and @xmath160 .",
    "this transforms @xmath10 into a graph satisfying conditions 1 and 2 in lemma  [ lem : broken - permutation ] .",
    "indeed , @xmath170 will have one less edge with color @xmath162 and one more edge with color @xmath143 , namely , the transformation cancels its deficiency .",
    "vertex @xmath171 will have one more edge with color @xmath162 and one less edge with color @xmath143 , therefore its @xmath172 deficiency becomes a @xmath173 deficiency .",
    "the number of edges with other colors are not affected , since in the trail , the number of incoming and outgoing edges are the same for all colors not @xmath143 and not @xmath162 , and swapping the edges in @xmath10 is equivalent with inverting the direction of the corresponding edges in @xmath168 .",
    "the following lemma is the key lemma in transforming a realization into another realization . as we mentioned above , the strategy is to transform a realization @xmath138 into an intermediate realization @xmath174 , such that the colors of edges of a vertex @xmath141 in the regular class agrees with the colors of the edges of @xmath141 in the target realization @xmath139 .",
    "we have to permute the edges , and the basic ingredient of a permutation is a cyclic permutation . the following lemma shows how to perturb a realization along a cyclic permutation .",
    "[ lem : single row perturbations ] let @xmath138 and @xmath139 be two realizations of the same half - regular bipartite degree matrix @xmath22 .",
    "let @xmath94 be a subset of vertices such that for some @xmath175 , each possible colors appears at most once on the edges between @xmath54 and @xmath94 in @xmath138 , furthermore , there exists a cyclic permutation @xmath46 on @xmath94 such that for all @xmath176 , the color between @xmath54 and @xmath86 in @xmath138 is the color between @xmath54 and @xmath177 in @xmath139 . then there exists a sequence of colored graphs @xmath178 with the following properties    1 .   for all @xmath179",
    ", @xmath180 is a colored graph satisfying either the properties 1 and 2 in lemma  [ lem : broken - permutation ] or the properties 1 and 2 in lemma  [ lem : broken - permutation - ii ] .",
    "2 .   for all @xmath181",
    ", a perturbation exists that transforms @xmath180 into @xmath182 and perturbs only the edges of two vertices in @xmath1 .",
    "@xmath183 is a realization of @xmath22 such that for all @xmath95 , the color of the edge between @xmath54 and @xmath93 is the color between @xmath54 and @xmath93 in @xmath139 , and for all @xmath184 , the color between @xmath54 and @xmath86 is the color between @xmath54 and @xmath86 in @xmath138 .",
    "let @xmath185 denote the cyclic permutation , and for all @xmath186 , let @xmath187 be the color of the edge between @xmath54 and @xmath188 in @xmath138 .",
    "since @xmath139 is a realization of @xmath22 , there is a @xmath91 such that the color between @xmath91 and @xmath189 is @xmath190 .",
    "indeed , the color between @xmath54 and @xmath189 in @xmath139 is @xmath190 ( the permutation @xmath46 moves @xmath191 to @xmath189 ) , thus , @xmath189 has an edge with color @xmath190 .",
    "swap the edges between @xmath54 and @xmath189 and between @xmath91 and @xmath189 .",
    "this will be @xmath192 , which satisfies the conditions @xmath34 and @xmath76 in lemma  [ lem : broken - permutation ] .",
    "indeed , @xmath54 has a @xmath193 deficiency , while @xmath91 has a @xmath194 deficiency .",
    "clearly , @xmath195 and @xmath192 differ only on edges of @xmath54 and @xmath91 , furthermore , all edges of @xmath54 has the same color than in @xmath138 except the edge between @xmath54 and @xmath189 .",
    "assume that some @xmath196 is achieved for which conditions @xmath34 and @xmath76 in lemma  [ lem : broken - permutation ] are satisfied with @xmath54 having @xmath197 deficiency and with some @xmath91 having @xmath198 deficiency and for all vertices @xmath199 , the edges between @xmath54 and these vertices have a color as in @xmath139 .",
    "furthermore , all other edges between @xmath54 and @xmath200 did not change color .",
    "the color between @xmath54 and @xmath201 in @xmath139 is @xmath202 , therefore , there is a @xmath203 such that the color between @xmath203 and @xmath201 is @xmath202 in @xmath196 .",
    "swap the edges between @xmath54 and @xmath201 and between @xmath203 and @xmath201 .",
    "this will be the graph @xmath204 .",
    "clearly , @xmath196 and @xmath204 differ only on edges of @xmath54 and @xmath203 . if @xmath205 , then @xmath54 has @xmath206 deficiency , and @xmath91 has @xmath207 deficiency , hence @xmath204 satisfies conditions @xmath34 and @xmath76 in lemma  [ lem : broken - permutation ]",
    ". we can rename @xmath204 to @xmath196 and iterate the chain of transformations .    if @xmath208 , then @xmath54 has @xmath206 deficiency , @xmath203 has @xmath209 deficiency and @xmath91 has @xmath210 deficiency .",
    "thus , the conditions @xmath34 and @xmath76 in lemma  [ lem : broken - permutation - ii ] hold .",
    "due to lemma  [ lem : broken - permutation - ii ] , there exists a perturbation that affects only edges on @xmath91 and @xmath203 and transforms @xmath204 to an @xmath211 for which conditions @xmath34 and @xmath76 in lemma  [ lem : broken - permutation ] hold with @xmath54 having @xmath206 deficiency and @xmath203 having @xmath207 deficiency",
    ". we can rename @xmath211 to @xmath196 and iterate the chain of transformations .    with this series of transformations",
    ", we can reach @xmath196 wich satisfies conditions @xmath34 and @xmath76 in lemma  [ lem : broken - permutation ] with @xmath54 having @xmath212 deficiency and with some @xmath91 having @xmath213 deficiency , furthermore , all vertices @xmath214 , the edges between @xmath54 and these vertices have a color as in @xmath139 , while all other edges of @xmath54 did not change color . there is a @xmath203 such that the color of the edge between @xmath203 and @xmath191 is @xmath215 .",
    "@xmath196 is transformed into @xmath204 by swapping the edges between @xmath54 and @xmath191 and between @xmath203 and @xmath216 . if @xmath205 , then this transformation leads to a realization of @xmath22 , and we are ready , namely , @xmath217 .",
    "otherwise , @xmath204 satisfies the conditions @xmath34 and @xmath76 in lemma  [ lem : broken - permutation ] with @xmath91 having @xmath213 deficiency and @xmath203 having @xmath212 deficiency . according to lemma  [ lem : broken - permutation ] , @xmath204 can be transformed into @xmath183 with a perturbation affecting only edges on @xmath91 and @xmath203 .",
    "since @xmath183 is also a realization of @xmath22 , it is desirable to have a series of transformation from @xmath138 to @xmath183 such that all the intermediate graphs are realizations of @xmath22 .",
    "to do this , we need a slightly larger perturbation modifying the edges of three vertices in the regular vertex set , as stated in the following lemma .    [",
    "lem : one cycle proper perturbations ] let @xmath138 , @xmath139 , @xmath94 and @xmath46 the same as in lemma  [ lem : single row perturbations ] .",
    "then there exists a sequence of colored graphs @xmath218 with the following properties    1 .   for all @xmath219",
    ", @xmath220 is a realization of @xmath22 .",
    "2 .   for all @xmath221",
    ", a perturbation exists that transforms @xmath220 into @xmath222 and perturbs only the edges of at most three vertices in @xmath1 .",
    "3 .   @xmath223 is a realization of @xmath22 such that for all @xmath95 , the color of the edge between @xmath54 and @xmath93 is the color between @xmath54 and @xmath93 in @xmath139 , and for all @xmath184 , the color between @xmath54 and @xmath86 is the color between @xmath54 and @xmath86 in @xmath138 .",
    "consider the series of colored graphs @xmath224 obtained in lemma  [ lem : single row perturbations ] .",
    "find the largest @xmath225 satisfying @xmath226 , @xmath227 has two vertices with a deficiency . due to the construction , for all @xmath228 , these two vertices are the same , and @xmath138 and @xmath227 differ only in edges of these two vertices , @xmath54 and @xmath91 .",
    "if @xmath229 , then @xmath138 and @xmath183 differ only on edges of two vertices of @xmath1 , thus @xmath230 will suffice .",
    "otherwise , @xmath231 has deficiency on @xmath77 vertices , @xmath54 , @xmath91 and @xmath203 .",
    "@xmath232 has deficiency on @xmath76 vertices , @xmath54 and @xmath203 , and @xmath138 differ from @xmath232 on edges of three vertices , @xmath54 , @xmath91 and @xmath203 .",
    "apply lemma  [ lem : broken - permutation ] on @xmath232 , the so - obtained graph will be @xmath233 .",
    "@xmath233 is a realization of @xmath22 and differ from @xmath138 only on edges of 3 vertices in @xmath1 .",
    "iterate this construction , find the largest @xmath234 such that @xmath235 , @xmath227 has two vertices with deficiency . if @xmath236 , then @xmath237 , and @xmath238 .",
    "otherwise , @xmath239 has 3 vertices with deficiency , and differ from @xmath240 only on the edges of these @xmath77 vertices .",
    "@xmath241 has two vertices with deficiency , on which lemma  [ lem : broken - permutation ] is applied to get @xmath242 .",
    "@xmath242 differs from @xmath240 only on edges of @xmath77 vertices , since @xmath240 differs from @xmath243 on the edges of the same 2 vertices that have deficiency for all @xmath227 , @xmath244 .",
    "after a finite number of iterations , @xmath236 , and then @xmath245 , @xmath238 , and this finishes the construction .",
    "[ theo : full perturbations ] let @xmath138 and @xmath139 be realizations of the same half - regular bipartite degree matrix @xmath22 .",
    "then there exists a sequence of colored graphs @xmath246 with the following properties .    1 .   for all @xmath247",
    ", @xmath180 is a realization of @xmath22 .",
    "2 .   for all @xmath181",
    ", a perturbation exists that transforms @xmath180 into @xmath182 and perturbs only the edges of at most three vertices in @xmath1 .",
    "consider a vertex @xmath54 in the regular vertex class @xmath1 , and define the following directed multigraph @xmath150 .",
    "the vertices of @xmath150 are the colors @xmath148 and the edges are defined by the following way . for each vertex @xmath151",
    ", there is an edge going from @xmath15 to @xmath152 , where @xmath15 is the color of the edge between @xmath54 and @xmath86 in @xmath139 and @xmath152 is the color of the edge between @xmath54 and @xmath86 in @xmath138 ( if @xmath248 , then this edge will be a loop ) .",
    "label this edge with vertex @xmath86 .",
    "since @xmath138 and @xmath139 are realizations of the same degree matrix @xmath22 , @xmath150 is eulerian and thus , can be decomposed into directed cycles .",
    "if all cycles are trivial ( loops ) , then for all vertex @xmath151 , the color of the edge between @xmath54 and @xmath86 in @xmath138 and @xmath139 are the same .",
    "if there is a nontrivial cycle @xmath249 , then each color appears in this cycle at most once , and the edges of a cycle define a cyclic permutation on a subset of vertices @xmath61 .",
    "let @xmath185 denote this cyclic permutation @xmath46 . by the definition of @xmath150 ,",
    "the color between @xmath54 and @xmath86 in @xmath138 is the color between @xmath54 and @xmath177 in @xmath139 , for all @xmath250 .",
    "therefore , we can apply lemma  [ lem : one cycle proper perturbations ] to transform @xmath138 into @xmath223 . now",
    "if we construct the same directed multigraph @xmath150 considering @xmath223 , @xmath139 and the same vertex @xmath54 , then cycle @xmath249 becomes separated loops for all of its vertices , while other edges are not affected ( recall the second half of condition 3 in lemma  [ lem : single row perturbations ] , `` _",
    "_ for all @xmath184 , the color between @xmath54 and @xmath86 is the color between @xmath54 and @xmath86 in @xmath138 . _ _ '' ) .",
    "while there are non - trivial cycles in @xmath150 , we can apply lemma  [ lem : one cycle proper perturbations ] , and in a finite number of steps , @xmath138 is transformed into a realization @xmath251 such that for all vertices @xmath151 , the color of the edge between @xmath54 and @xmath86 in @xmath251 and @xmath139 are the same . furthermore ,",
    "in all steps along the transformation , the intermediate graphs satisfy the two conditions of the lemma .",
    "fix the edges of @xmath54 both in @xmath251 and @xmath139 .",
    "technically , this can be done by deleting vertex @xmath54 and its corresponding edges both from @xmath251 and @xmath139 .",
    "then these reduced graphs will be realizations of the same half - regular degree matrix that can be obtained from @xmath12 by deleting a column from the row - regular @xmath11 ( which thus remains row - regular ) and modifying some values of @xmath252 according to the edge colors of @xmath54 . on these reduced graphs",
    ", we can consider a vertex @xmath54 from the regular vertex class @xmath1 , and do the same .",
    "once there is one remaining vertex in @xmath1 , the two realizations will be the same , and thus , we transformed @xmath138 into @xmath139 .",
    "theorem  [ theo : full perturbations ] says that perturbing the edges of at most three vertices in the regular vertex class is sufficient to connect the space of realizations of a half - regular degree matrix @xmath22 , namely , a finite series of such perturbations is sufficient to transform any realization into another such that all intermediate perturbed graphs are also realizations of @xmath22 .",
    "a natural question is if such perturbations are also necessary .",
    "the answer to this question is yes .",
    "latin squares can be considered as 1-factorizations of the complete bipartite graph @xmath253 .",
    "the corresponding degree matrix @xmath12 satisfies the definition of half - regular degree matrices .",
    "indeed , both @xmath11 and @xmath252 are @xmath254 , all-1 matrices .",
    "it is well - known that already @xmath255 latin squares can not be transformed into each other via latin squares if only two rows are perturbed in a step , and the same claim holds for any @xmath256 latin squares , where @xmath257 is prime and @xmath258 @xcite .",
    "in this section , we give a markov chain monte carlo ( mcmc ) method for sampling realizations of a half - regular degree matrix @xmath22 . theorem  [ theo : full perturbations ]",
    "says that the perturbations that change the edges of at most 3 vertices of the regular vertex class are irreducible on the realizations of half - regular degree matrices .",
    "a nave approach would make a random perturbation affecting the edges of @xmath77 vertices , and would accept this random perturbation if it is a realization of @xmath22 .",
    "unfortunately , the probability that such random perturbation would generate a realization of @xmath22 would tend to 0 exponentially quickly with the size of @xmath22 , making the mcmc approach very inefficient .",
    "indeed , there were an exponential waiting time for an acceptance event , that is , when the random perturbation generates a realization of @xmath22 .",
    "even if the random perturbation generates a realization of @xmath22 with probability 1 , the metropolis - hastings algorithm applying such random perturbation might generate a torpidly mixing markov chain if the acceptance ratios are small .",
    "an example when this is the case can be found in @xcite .    in this section",
    ", we design a transition kernel that generates such perturbations and its transition probabilities satisfy equation  [ eq : highratio ] , namely , the inverse of the acceptance ratio bounded by a polynomial function of the size of @xmath22 . to do this , we first have to generate random circuits and trails in auxiliary graphs that we define below .",
    "[ def : trail ] let @xmath149 be the directed , edge labeled multigraph of the edge colored bipartite graph @xmath10 as defined in definition  [ def : auxiliaryk ] .",
    "let @xmath259 and @xmath260 be two vertices of @xmath150 such that for any vertex @xmath261 of @xmath150 , the number of outgoing edges of @xmath262 is greater or equal than the number of its incoming edges , and @xmath259 has more outgoing edges than incoming edges if @xmath263 .",
    "we define the following function @xmath264 that generates a random trail from @xmath259 to @xmath260 when @xmath263 and a random circuit when @xmath265 .    1 .",
    "select uniformly a random outgoing edge @xmath266 of @xmath259 which is not a loop .",
    "let the sequence of labels @xmath267 , where @xmath86 is the label of @xmath266 , namely , @xmath268 be a sequence containing one label .",
    "let @xmath262 be the endpoint of @xmath266 .",
    "2 .   while @xmath269 , select uniformly a random outgoing edge @xmath266 of @xmath262 which is not a loop and does not appear in @xmath268 .",
    "extend @xmath268 with the label of @xmath266 , and set @xmath262 to the endpoint of @xmath266 .",
    "note that due to the pigeonhole rule , this random procedure will eventually arrive to @xmath260 , since for any vertex @xmath269 reached by the algorithm , there exist at least one outgoing edge of @xmath262 which is not a loop and is not in the sequence @xmath268 .",
    "the probability of a trail @xmath270 or circuit @xmath271 generated by @xmath272 consists of the product of the inverses of the available edges going out from @xmath273 .",
    "these probabilities will be denoted by @xmath274 and @xmath275 .",
    "we are going to perturb the graphs along the circuits and trails as defined below .",
    "let @xmath276 ( resp . ,",
    "@xmath277 ) be a random circuit ( resp .",
    ", random trail ) generated by @xmath278 .",
    "then the transformation @xmath279 ( @xmath280 ) swaps the colors of the edges between @xmath54 and @xmath86 and between @xmath91 and @xmath86 for all edge labels @xmath86 in @xmath276 ( @xmath277 ) .    with these types of perturbations",
    ", we are going to define the random algorithm that generates a random perturbation .    [",
    "alg : perturbation ] let @xmath0 be a realization of the half - regular degree matrix @xmath22 .",
    "do the following random perturbation on @xmath10 .",
    "a.   with probability @xmath281 , do nothing .",
    "this is technically necessary for the markov chain surely be aperiodic .",
    "any constant probability would suffice , @xmath281 is the standard choice for further technical reasons not detailed here , see for example , @xcite .",
    "b.   with probability @xmath282 , do the following 1 .",
    "draw uniformly a random ordered pair of vertices @xmath54 and @xmath91 from the vertex set @xmath1 . construct the auxiliary graph @xmath283 ,",
    "draw uniformly a random color @xmath284 and draw a random circuit @xmath276 using @xmath285 .",
    "2 .   chose a random integer @xmath121 uniformly from @xmath286 $ ] .",
    "if @xmath287 , then let @xmath126 be @xmath279 .",
    "@xmath126 is the perturbed graph , exit the algorithm .",
    "if @xmath288 , do the following ( see also figure  [ fig : perturbation1 ] ) .",
    "let @xmath289 denote the edges of circuit @xmath276 starting with the edge going out from @xmath284 .",
    "let @xmath277 be the trail with edges @xmath290 .",
    "perturb @xmath10 to @xmath280 .",
    "draw uniformly a @xmath203 from @xmath291 and also uniformly a vertex @xmath86 from the subset of @xmath61 satisfying the condition that the color of the edge between @xmath54 and @xmath86 in @xmath280 is the last color in the trail @xmath277 .",
    "let @xmath292 denote the color of the edge between @xmath203 and @xmath86 .",
    "swap the colors of the edges between @xmath54 and @xmath86 and between @xmath203 and @xmath86 .",
    "note that @xmath292 might equal to @xmath262 , and in that case , swapping the colors has no effect .",
    "denote the so far perturbed graph @xmath293 .",
    "4 .   construct @xmath294 , and draw a random trail @xmath295 using function @xmath296 .",
    "let @xmath297 be @xmath298 .",
    "5 .   construct @xmath299 , and draw a random trail @xmath300 using function @xmath301 .",
    "let @xmath126 , the perturbed graph be @xmath302 .",
    "c.   with probability @xmath282 , do the following .",
    "draw uniformly a random ordered pair of vertices @xmath54 and @xmath203 from the vertex set @xmath1 .",
    "construct @xmath303 , draw uniformly a random color @xmath284 , and draw a random circuit @xmath304 using @xmath305 .",
    "2 .   draw uniformly a random integer from @xmath286 $ ] .",
    "if @xmath306 , then let @xmath126 be @xmath307 .",
    "@xmath126 is the perturbed graph , exit the algorithm .",
    "3 .   if @xmath308 , do the following ( see also figure  [ fig : perturbation2 ] ) .",
    "let @xmath309 be the trail from @xmath284 to @xmath310 , and let @xmath311 , and let @xmath292 denote @xmath310 . draw uniformly a random vertex @xmath91 from @xmath312 .",
    "build @xmath313 , and draw a random trail @xmath314 using @xmath315 .",
    "let @xmath316 $ ] denote the prefix of the trail @xmath314 containing only the first @xmath33 edges of the trail .",
    "let @xmath317 denote the @xmath33th edge of trail @xmath314 .",
    "construct the set of vertices @xmath94 which contains all vertex @xmath38 such that the label of @xmath317 is @xmath38 and in the graph @xmath318 , u \" , u')$ ] , there is a vertex @xmath86 such that the color of the edge between @xmath54 and @xmath86 is @xmath292 , the color of the edge between @xmath203 and @xmath86 is the color of the edge between @xmath91 and @xmath38 , furthermore , @xmath262 is the first occurrence in the trail , that is , @xmath319 $ ] does not contain @xmath262 .",
    "4 .   if @xmath94 is empty , then exit the algorithm , let the perturbed graph be the original graph . otherwise , draw a random vertex @xmath86 from @xmath94 .",
    "shorten @xmath314 such that the last edge have label @xmath86 .",
    "let @xmath320 denote this trail .",
    "let @xmath293 be @xmath321 . if @xmath203 has a deficiency @xmath322 for some @xmath262 in @xmath293 , then draw uniformly a vertex among the vertices @xmath323 for which the color of the edge between @xmath54 and @xmath323 is @xmath292 and the color of the edge between @xmath203 and @xmath323 is @xmath262 .",
    "modify @xmath293 by swapping the colors of these two edges .",
    "+ if @xmath203 has no deficiency in @xmath293 then recall @xmath292 to @xmath262 .",
    "5 .   build @xmath324 , and draw a random trail @xmath325 using @xmath326 .",
    "let @xmath126 , the perturbed graph be @xmath327 .",
    "[ theo : perturbation ] the random perturbation in algorithm  [ alg : perturbation ] has the following properties .    1 .",
    "the generated @xmath126 is a realization of @xmath22 , thus this random perturbation is the transition kernel of a markov chain on the realizations of @xmath22 .",
    "the perturbations are irreducible on the realizations of @xmath22 3 .",
    "the perturbations form a reversible kernel and for any @xmath10 and any @xmath126 generated from @xmath10 , @xmath328 where @xmath60 is the number of vertices in @xmath61 . furthermore",
    ", if this reversible kernel is used in a metropolis - hastings algorithm , the expected waiting time ( that is , how many markov chain steps is necessary to leave the current state ) at any state is bounded by @xmath329 .    1 .   when @xmath287 or @xmath330 ( cases ii.(b ) and iii.(b ) in algorithm  [ alg : perturbation ] ) , the constructed @xmath126 differs on edges of two vertices of @xmath1 , @xmath54 and @xmath91 ( or @xmath54 and @xmath203 ) .",
    "since the swapped colors are along a circuit in the auxiliary graph @xmath150 , the effects of color swaps cancel each other , and we get a realization of @xmath22 .",
    "+ when @xmath288 ( case ii.(c)-(e ) in algorithm  [ alg : perturbation ] ) , @xmath10 is transformed into an intermediate graph @xmath293 , which has deficiency on three vertices @xmath54 , @xmath91 and @xmath203 .",
    "vertex @xmath54 has @xmath331-deficiency , @xmath91 has @xmath332-deficiency , and @xmath203 has @xmath322-deficiency ( see also the boxed colors on figure  [ fig : perturbation1 ] ) .",
    "the generated random trail @xmath295 on @xmath333 goes from @xmath284 to @xmath262 . in lemma",
    "[ lem : broken - permutation - ii ] , we proved that any such trail transforms @xmath293 into a graph satisfying the conditions of lemma  [ lem : broken - permutation ] .",
    "the random trail @xmath300 generated in @xmath334 is from @xmath292 to @xmath284 , and lemma  [ lem : broken - permutation ] proves that swapping the edge colors along such trail transforms the graph into a realization of @xmath22 .",
    "+ when @xmath308 ( case iii.(c)-(e ) in algorithm  [ alg : perturbation ] ) , @xmath10 is transformed into a @xmath297 , in which @xmath54 has a @xmath331-deficiency and @xmath203 has a @xmath335 deficiency ( see also the boxed colors on figure  [ fig : perturbation2 ] ) .",
    "then @xmath297 transformed into a @xmath293 , in which two cases is possible .",
    "either @xmath203 has a @xmath322-deficiency and then @xmath54 has a @xmath331-deficiency and @xmath91 has a @xmath332-deficiency or @xmath203 has no deficiency and then @xmath54 has a @xmath331-deficiency and @xmath91 has a @xmath335-deficiency . in the former case , a couple of colors @xmath262 and @xmath292 are swapped between @xmath54 and @xmath203 causing @xmath203 has no deficiency and @xmath54 has @xmath336 deficiency , which are cancelled by the perturbation along the trail @xmath325 , thus arriving to a realization of @xmath22 . in the later case",
    ", the perturbation along the trail @xmath325 directly leads to a realization of @xmath22 .",
    "it is sufficient to show that the algorithm generates the perturbations appear in theorem  [ theo : full perturbations ] , which are actually the perturbations appear in lemma  [ lem : one cycle proper perturbations ] .",
    "there are two types of perturbations in lemma  [ lem : one cycle proper perturbations ] .",
    "the simpler one swaps the colors of edges along a cycle .",
    "this happens when @xmath229 in the proof of lemma  [ lem : one cycle proper perturbations ] and also when @xmath236 . since a cycle is a circuit , and any circuit in the auxiliary graph @xmath150 constructed in the algorithm can be generated with non - zero probability , this type of perturbation is in the transition kernel .",
    "+ the larger perturbation in lemma  [ lem : one cycle proper perturbations ] first swap the colors of edges of @xmath54 and @xmath91 along a path , then swap the colors of two edges between @xmath54 and @xmath86 and @xmath203 and @xmath86 for some @xmath86 , then swap the edges of @xmath91 and @xmath203 along a path to eliminate the deficiency of @xmath203 , finally , swap the color of the edges @xmath54 and @xmath203 along a path to eliminate their deficiencies , thus generate a realization .",
    "since any path is a trail , the given algorithm can generate such perturbations when @xmath288 ( case ii.(c)-(e ) in algorithm  [ alg : perturbation ] ) .",
    "we show that for any perturbation of @xmath10 to @xmath126 , there exists a perturbation from @xmath126 to @xmath10 , and we also compare the probabilities of the perturbations .",
    "recall that the number of vertices in @xmath1 is @xmath8 , the number of vertices in @xmath61 is @xmath60 , and the number of colors is @xmath337 ; @xmath8 , @xmath60 and @xmath337 will appear in the probabilities below several times .",
    "+ when the perturbation affects the edges of only two vertices , @xmath54 and @xmath91 or @xmath54 and @xmath203 ( cases ii.(b ) or iii.(b ) in algorithm  [ alg : perturbation ] ) , the algorithm first draws these vertices with probability @xmath338 , where @xmath339 .",
    "also a random color @xmath284 is drawn with probability @xmath340 .",
    "then a random circuit @xmath341 is generated with probability @xmath274 . finally ,",
    "a random @xmath342 is generated , this happens with @xmath343 probability , where @xmath344 and the color of the edges indicated by the circuit are swapped .",
    "the so - obtained @xmath126 can be generated not only in this way , but an arbitrary such @xmath15 can be generated as the starting point of the circuit which is visited only once in the circuit .",
    "+ to perturb back @xmath126 to @xmath10 , we first have to select the same pair of vertices @xmath54 and @xmath91 , with the same , @xmath338 probability .",
    "then the random circuit @xmath345 must be generated in the constructed auxiliary directed multigraph @xmath346 . since for all color , the auxiliary graph @xmath150 constructed from @xmath10 has the same outgoing edges than the auxiliary graph @xmath346 constructed from @xmath126 , @xmath347 .",
    "furthermore , this claim holds for all possible circuits having the possible starting colors @xmath15 . finally ,",
    "generating the same @xmath121 has the same probability , thus we can conclude that for this type of perturbation , @xmath348 , thus equation  [ eq : claim ] holds .",
    "+ when the perturbation affects the edges of three vertices , @xmath54 , @xmath91 and @xmath203 , then @xmath10 is first perturbed to @xmath293 , @xmath293 is perturbed to @xmath297 and finally @xmath297 is perturbed to @xmath126 , or the third type of perturbation is applied in the algorithm where @xmath10 first perturbed into @xmath297 then @xmath293 and finally @xmath126 ( case ii.(c)-(e ) and iii.(c)-(e ) in algorithm  [ alg : perturbation ] ) .",
    "we show that these two types of perturbations are inverses of each other in the following sense . for any perturbation generated in case ii.(c)-(e ) in algorithm  [ alg : perturbation ]",
    ", its inverse can be generated in case iii.(c)-(e ) in algorithm  [ alg : perturbation ] , and vice versa , for any perturbation generated in case iii.(c)-(e ) , its inverse can be generated in case ii.(c)-(e ) .",
    "first we consider the perturbation generated by algorithm  [ alg : perturbation ] in case ii.(c)-(e ) . in that case , first the ordered pair of vertices ( @xmath54 , @xmath91 ) is generated with probability @xmath338 and a random color @xmath284 with probability @xmath340 .",
    "a circuit @xmath349 is generated together with a random number @xmath121 with probability @xmath350 .",
    "the generated number @xmath121 must be smaller than @xmath351 , and thus , only the trail @xmath352 is important .",
    "the probability of the trail consists of the product of the inverses of the number of available outgoing edges .",
    "let @xmath275 denote this probability .",
    "the colors along the trail are swapped .",
    "then random @xmath203 is generated from the appropriate set of vertices in @xmath353 with probability @xmath354 and also a vertex @xmath86 is generated with probability @xmath355 where @xmath115 is the index of color @xmath310 .",
    "the colors @xmath356 and @xmath292 are swapped .",
    "therefore , @xmath357 .",
    "then a trail @xmath295 is generated from @xmath292 to @xmath284 in the auxiliary graph @xmath333 , and @xmath293 is transformed to @xmath358 thus , @xmath359 .",
    "finally , a random trail @xmath300 from @xmath292 to @xmath284 is generated in @xmath334 with probability @xmath360 , which is @xmath361 .",
    "since @xmath362 we get that @xmath363 + to transform back @xmath126 to @xmath10 , first @xmath126 should be transformed back to @xmath297 , then @xmath297 back to @xmath293 and finally @xmath293 back to @xmath10 . this can be done in case iii.(c)-(e ) by first drawing the same @xmath54 and @xmath203 , then drawing a @xmath364 which is exactly the inverse of @xmath300 , then the same @xmath91 must be selected and the trail @xmath320 must be the inverse of @xmath295 , the same edges with color @xmath262 and @xmath292 must be swapped , and finally the trail @xmath325 must be the inverse of @xmath277 .",
    "first we show that these trails can be inverses of each other .",
    "+ @xmath277 is a shortening of a circuit with start and end vertex @xmath284 . as such",
    ", it contains @xmath284 only once , but might contain @xmath262 several times .",
    "@xmath365 is a trail from @xmath262 to @xmath284 .",
    "therefore , it can contain @xmath262 several times , but contains @xmath284 only once .",
    "thus , the inverse of any @xmath277 might be a @xmath365 and vice versa .",
    "+ @xmath295 is a trail from @xmath284 to @xmath262 .",
    "therefore , it might contain @xmath284 several times , but contains @xmath262 only once .",
    "@xmath366 is a shortening of a trail from @xmath284 to @xmath292 .",
    "it might contain @xmath284 several times , but can contain @xmath262 only once , due to its definition ( see case iii.(c)-(d ) of algorithm  [ alg : perturbation ] ) .",
    "hence , the inverse of any @xmath295 can be a @xmath366 , and vice versa .",
    "+ @xmath300 is a trail from color @xmath292 to @xmath284 .",
    "it might hit @xmath292 several times , but only once @xmath284 .",
    "@xmath364 is a shortening of a circuit with start and end vertex @xmath284 . as such",
    ", it contains @xmath284 only once ( as start and end vertex ) , but might contain @xmath292 several times .",
    "thus the inverse of any @xmath300 might be a @xmath364 and vice versa .",
    "+ we are going to calculate the probability of a random perturbation in case iii.(c)-(e ) .",
    "first , the ordered pair of vertices @xmath54 and @xmath203 should be selected with probability @xmath338 .",
    "the auxiliary directed multigraph @xmath367 is constructed , a random @xmath284 is selected , and a random circuit @xmath368 in @xmath367 is generated .",
    "the probability that the randomly generated @xmath121 is exactly the index of the appropriate occurrence of @xmath292 in the trail @xmath364 is @xmath350 .",
    "then only the trail @xmath369 is interesting .",
    "thus , transforming back @xmath126 to @xmath297 has probability @xmath370 .",
    "@xmath364 in @xmath367 is the inverse of the trail @xmath300 in @xmath334 and @xmath367 and @xmath334 differs in inverting the trail @xmath300 .",
    "therefore @xmath360 and @xmath371 differ in the number of outgoing edges from @xmath284 at the begining of the trail @xmath300 and the number of outgoing edges from @xmath292 at the beginning of the trail @xmath364 .",
    "since the number of outgoing edges might vary between 1 and @xmath60 , the ratio of the two probabilities bounded by @xmath372 + after swapping the colors along the trail @xmath373 , @xmath91 should be randomly generated , it has probability @xmath354 .",
    "a random trail @xmath314 is generated using @xmath374 .",
    "a random @xmath86 from the subset @xmath94 is generated in iii.(d ) of the algorithm .",
    "this has probability @xmath375 .",
    "then the trail @xmath314 is shortened to @xmath320 , and @xmath293 is obtained by transforming @xmath297 along this trail .",
    "+ it is not easy to calculate exactly the probability @xmath376 since the set @xmath94 depends on the generated trail @xmath314 .",
    "however , the size of @xmath94 can not be greater than @xmath60 and lower than @xmath34 , therefore the following inequality holds : + @xmath377 the trail @xmath320 is the inverse trail @xmath295 , therefore , the ratio of their probabilities is also between @xmath350 and @xmath60 .",
    "+ finally , the same edge colors @xmath262 and @xmath292 must be swapped back , and @xmath293 must be transformed back to @xmath10 along the trail @xmath325 .",
    "the probability that the selected @xmath323 in iii.(d ) of the algorithm  [ alg : perturbation ] is a particular vertex depends on the number of vertices from which @xmath323 is selected .",
    "therefore this probability is again between @xmath350 and @xmath34 .",
    "altogether , the probability of the backproposal probability is bounded between @xmath378 + comparing equations  [ eq : g2gprime ]  and  [ eq : gprime2 g ] , and also considering that the ratio of the probabilities of the trails and corresponding inverse trails are between @xmath350 and @xmath60 , we get for the ratio of proposal and backproposal probabilities that + @xmath379 + case ii . is chosen with probability @xmath282 . given that case ii . is selected , the probability that algorithm  [ alg : perturbation ] generates a realization being different from the current realization is 1 .",
    "if edges of two vertices in @xmath1 are perturbed , then the perturbation is accepted with probability 1 .",
    "if edges of three vertices in @xmath1 are perturbed , then the perturbation is accepted with probability @xmath380 according to equation  [ eq : ratio ] .",
    "thus , the probability that the markov chain defined by the metropolis - hastings algorithm does not remain in the same state is greater or equal than @xmath381 .",
    "the expected waiting time is upper bounded by the inverse of this probability , that is , @xmath329 .",
    "we considered the half - regular factorizations of the complete bipartite graph , and we proved that it is a tractable version of the edge packing problem . above the existence theorem , we also give sufficient and necessary perturbations to transform solutions into each other .",
    "when these perturbations are the transition kernel of a markov chain monte carlo method , the inverse of the acceptance ratios are polynomial bounded .",
    "this result might be the first step to prove rapid mixing of the markov chain .",
    "however , proving rapid mixing might be particularly hard .",
    "the speed of convergence of a similar markov chain on latin squares is a twenty years old open problem .",
    "approximate sampling and counting are equally hard computational problems for a large set of counting problems , the so - called self - reducible counting problems @xcite .",
    "latin squares are not self - reducible counting problems , since deleting a few rows from a latin square yield a partial latin square .",
    "half - regular factorizations of the complete bipartite graph are closer to be self - reducible , since deleting a few lines from a half - regular factorization yields another half - regular factorization of a smaller complete bipartite graph .",
    "unfortunately , further technical conditions are necessary ; we have to require that a subset of the colors in the first line be fixed .",
    "it is discussed in @xcite , why this restriction is necessary .",
    "a possible further work could be to give a markov chain which is irreducible on such restricted space .",
    "a proof of rapid mixing of that markov chain would yield to an efficient random approximation ( fpras , see also @xcite ) on the number of realizations of half - regular factorizations of the complete bipartite graph .",
    "since latin squares are also half - regular factorizations , it would also yield an efficient random approximation of latin squares , too . at the moment ,",
    "the known lower and upper bounds on the number latin squares are far away each other @xcite .",
    "finally , a further work might be to relax the half - regularity to a condition where we require that the factors be almost half - regular , that is , for each factor , the degrees in the first vertex class are either @xmath382 or @xmath383 .",
    "chrobak , m. , drr , c. : reconstructing polyatomic structures from discrete x - rays : np - completeness proof for three atoms , _ in : l. brim , j. gruska , j. zlatu@xmath384ka ( eds . ) , mathematical foundations of computer science 1998 , in : lecture notes in computer science , springer , berlin heidelberg _ , * 1450 * ( 1998 ) 185193 .",
    "drr , c. , gu@xmath385ez , f. , matamala , f. m. : reconstructing 3-colored grids from horizontal and vertical projections is np - hard : a solution to the 2-atom problem in discrete tomography , _ siam j. discrete math . _ * 26(1 ) * ( 2012 ) 330352 .",
    "markov , n. t. , ercsey - ravasz , m. , ribiero gomes , a.r . , lamy , c. , vezoli , j. , magrou , l. , misery , p. , falchier , a. , quilodran , r. , sallet , j. , gariel , m.a .",
    ", gamanut , r. , huissoud , c. , clavagnier , s. , giroud , p. , sappey - marinier , d. , barone , p. , dehay , c. , toroczkai , z. , knoblauch , k. , van essen , d.c . ,",
    "kennedy , h. : a weighted and directed interareal connectivity matrix for macaque cerebral cortex , _ cereb .",
    "* 24(1 ) * ( 2014 ) 1736 .",
    "mikls , i. , mlykti , b. , swenson , k. : the metropolized partial importance sampling mcmc mixes slowly on minimum reversal rearrangement paths _ acm / ieee transactions on computational biology and bioinformatics _ , * 4(7 ) * ( 2010 ) 763767 ."
  ],
  "abstract_text": [
    "<S> we consider a bipartite version of the color degree matrix problem . a bipartite graph @xmath0 is half - regular if all vertices in @xmath1 have the same degree . </S>",
    "<S> we give necessary and sufficient conditions for a bipartite degree matrix ( also known as demand matrix ) to be the color degree matrix of an edge - disjoint union of half - regular graphs . </S>",
    "<S> we also give necessary and sufficient perturbations to transform realizations of a half - regular degree matrix into each other . </S>",
    "<S> based on these perturbations , a markov chain monte carlo method is designed in which the inverse of the acceptance ratios are polynomial bounded .    </S>",
    "<S> realizations of a half - regular degree matrix are generalizations of latin squares , and they also appear in applied neuroscience .     + degree sequences ; degree matrix ; graph factorization ; edge packing ; latin squares ; markov chain monte carlo </S>"
  ]
}