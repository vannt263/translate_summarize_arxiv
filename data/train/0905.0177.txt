{
  "article_text": [
    "modelling of hydrodynamic flows in the setting as appropriate for stellar physics has provided a large number of insights over the past decades . if we stick to the vicinity of solar granulation studies only , we may mention work such as @xcite , @xcite , @xcite , @xcite , @xcite .    in order to conduct research in the context of stellar convection and related areas",
    "we are developing a code for such simulations . in this paper",
    ", we describe the most central and most mature features of the continually expanding code , i.e. hydrodynamics with radiative transfer and realistic material properties for the stellar and of course solar case .",
    "we discuss the relative performance of various numerical methods .",
    "we exemplify the use and benefits granted by the program in discussing high resolution simulations of solar granulation",
    ".    antares ( a numerical tool for astrophysical research ) is designed according to the following general principles and aims :    * * general : * time dependent compressible hydrodynamics and extensions ( such as mhd ) in 1d , 2d and 3d ; fortran90 code with a modular structure ; * * numerics : * various high resolution numerical schemes of conservative form implemented in order to evaluate their merits ; * * radiative transfer : * short characteristics method ( use of the diffusion approximation where appropriate ) ; either grey or nongrey by the binning method based on state of the art opacities ; * * microphysics : * realistic ( or idealized ) ; * * gridding : * logically rectangular ; either rectangular or spherical coordinates ; equidistant or ( vertically ) logarithmically spaced grid points ; grid refinement in pre - assigned rectangular patches , even recursively ; * * parallelization : * via mpi ( additional openmp nearing completion ) ; * * portability : * is running on * * amd , ibm and intel processors * * aix , linux and osx operating systems .",
    "the use of high resolution numerics , together with grid refinement , has of course the aim of achieving the best possible _ effective resolution_. given that just this is the aim of so many efforts on the observational side , this seems to be a worthwhile endeavor also on part of numerical modelling .",
    "regarding observations in the solar case , we mention , for example , the swedish vacuum telescope or the sunrise project @xcite .",
    "we have described 2d high resolution simulations of solar granulation in a previous paper @xcite . there",
    "the main result was the occurrence of strong acoustic pulses generated by the granular downdrafts and moving over considerable length , i.e. , one , two or even more granule diameters .",
    "furthermore , we observed strong vortex patches generated by the integranular downdrafts which remained , however , quite stably near the place where they had been generated and in any case well below the photosphere .",
    " we should be able to see such phenomena in the resolution we achieve in the grid refinement region in the 3d calculation which we discuss in the present paper .",
    "the question which we discuss concerns therefore the nature of 3d solar granulation at high resolution .",
    "with the antares code , the equations of radiation hydrodynamics are solved in one , two , or three dimensions .",
    "the equations governing the dynamics of granulation or convection in the sun or in stars ( without magnetic activity for the present purpose ) , are , see e.g. @xcite , the continuity equation @xmath1 the momentum equation @xmath2 and the total energy equation @xmath3 all physical quantities are functions of space and time coordinates , @xmath4 and @xmath5 , i.e. @xmath6 . the x - direction points in the vertical direction , y- and z - direction are the horizontal coordinates .",
    "the meaning of the most important physical variables used here and in the following is summarized in table  [ tlab ] .",
    ".meaning of the main variables [ cols= \" < , < , < \" , ]     in addition to one - dimensional averages and the size of the granules we can also consider the pressure distribution ( logarithm of pressure with logarithm of its horizontal average subtracted , see fig .  [ s2f - p ] )",
    ". the simulations with this typical resolution for solar granulation simulations of 15.2  km vertically and 23  km horizontally can be compared with the high - resolution model described in @xcite .",
    "the acoustic pulses which are ubiquitous in the high - resolution model are present in the simulation without artificial diffusivities . in the simulations with artificial diffusivities these acoustic pulses",
    "are not that sharp and numerous and not found so deeply down .",
    "furthermore , the simulations without artificial diffusivities show more small scale features ( e.g. at the upper right corner ) and more whirls which we have also observed in our higher resolution runs .      for simulations with higher resolution and artificial diffusivities the values for",
    "the horizonal averages increase and the mean size of the granules decreases such that the differences caused by various implementations of the viscosity ( or , from a different point of view , of the modeling of the unresolved scales ) vanish .",
    "a 2d high - resolution model of solar granulation with artificial diffusivities in @xcite shows agreement on an quantitative level : the size of the granules is appropriate .    for 3d simulations we mostly use the fifth - order weno scheme with marquina s flux splitting and entropy fix .",
    "this method is stable for both implementations of the viscosity ( numerical viscosity plus navier - stokes type viscosity only , or with artificial diffusivities included ) and the mean size of the granules is nearest to the observed values for the 2d simulations already at a typical resolution for solar granulation calculations of about 20  km .",
    "moreover , if we consider a horizontal profile , where the density shows one smooth peak and at this peak the vertical velocity changes sign , we find that the temporal development of the density calculated with marquina s flux splitting and the entropy fix remains smooth , whereas the solution calculated with the standard eno- or weno - method generates oscillations in the smooth peak of the density",
    ". these observations also correspond to the theoretical considerations described in @xcite .",
    "thus , all subsequent simulations use weno-5 and include marquina s flux splitting and entropy fix .",
    "if we repeat some of our numerical experiments with these settings in 3d , we again find that a simulation without artificial diffusivities using the same mesh size yields a markedly higher resolution than its counterpart using artificial diffusivities .",
    "this is evident from the horizontal slices at a depth of 600  km for 3d simulations shown in fig .",
    "[ s3b - t ] , where more small scale features become visible .",
    "for those two simulations the computational domain comprises 2763  km @xmath7 11172  km @xmath7 11172  km and is provided with 182 @xmath7 285 @xmath7 285 cells which yields a cell size of 15.2  km @xmath7 39.2  km @xmath7 39.2  km .",
    "given the veracity of the methods without artificial diffusivity as discussed in the 2d case above we feel justified to trust the results in 3d to a high degree as well .",
    "if we apply weno-5 with no artificial diffusivities in 3d we have to add a navier - stokes - type diffusion term in the momentum equation with a coefficient larger than the physical one in order to keep the code stable .",
    "considering an ever better resolved series of calculations , we can drastically reduce the amount of viscosity we need to add as we increase resolution .",
    "in fact , in the refinement zone of the 3d model discussed in the next chapter we can do by adding a viscous term ( of the form of usual hydrodynamic viscosity ) to the momentum equation _ only _ , the coefficient being that small that , for the corresponding prandtl number , we have @xmath8 everywhere . keeping in mind the adverse effects of added viscosity as discussed earlier in the 2d case this implies that gain in effective resolution is larger when moving to a highly resolved simulations than can be expected on basis of the grid sizes alone and that , at high resolution , weno-5 can do with , by any numerical standards , only a very small amount of diffusivity added . from a somewhat different standpoint , it is remarkable in itself that weno-5 really feels a viscosity which is so small in terms of prandtl number .",
    "we just have mentioned the model with the basic cube of size 2763  km @xmath7 11172  km @xmath7 11172  km ( equipped with 182 @xmath7 285 @xmath7 285 cells , cell size 15.2  km @xmath7 39.2  km @xmath7 39.2  km ) . into that domain",
    "we have plugged a refinement zone of size 1966  km @xmath7 4165  km @xmath7 3851  km , provided with 259 @xmath7 425 @xmath7 393 cells .",
    "that leads to a cell size of 7.1  km @xmath7 9.8  km @xmath7 9.8  km .",
    "the high - resolution domain starts quite high in the atmosphere .",
    "we now discuss the results borne out from this high resolution simulation .",
    "basically , our simulation follows the decay of a large exploding granule occupying the largest part of the refinement region .    quite soon , due to the higher resolution , new features become visible which were at best hinted in the lower resolution run . in fact , a considerable number of vortex tubes commenced evolving .",
    "they are generated by the downflow lanes at the boundaries of the convection cells at a depth where the downflowing material gets buoyant and is deflected sidewards and ultimately upwards .",
    "a number of these tornadoes manages to move upwards into the photosphere .",
    "they can readily be seen in fig .",
    "[ tornado01 ] .",
    "the figure contains an isosurface plot of temperature , @xmath9 .",
    "the tornadoes are visualized by means of a volume rendering of the norm of vorticity .",
    "it is obvious that they crowd predominantly in the vicinity of the downflows , characterized by depressions in the @xmath10isosurface , whereas the broad upflows are void of them .",
    "the tornadoes can also readily be recognized in other variables : @xmath11 where @xmath12 denotes the horizontally averaged pressure , @xmath13 , etc .",
    "the effects are large .",
    "pressure inside the tornadoes may amount to only @xmath14 of the ambient pressure , density may also be quite low and , in addition , temperature is lower than in the surrounding medium .",
    "the tornadoes are stabilized against collapse resulting from the higher ambient pressure by rapid rotation .",
    "the vortex tubes reach the surface layers by ascending predominantly at the granule boundaries where the vertical velocity is @xmath15 and there exists strong shear .",
    "typical diameters are somewhat above @xmath16 and smaller .",
    "note that a tornado of that size has only about @xmath17 grid points to represent it .",
    "given the strong velocity gradients it is remarkable that the tornadoes survive .",
    "it would be an interesting question to study the stability with either analytical models or numerically applying even higher resolution .",
    "these tornadoes can be considered to be the 3d analogs of the vorticity patches described , for the 2d case , by @xcite . however , in moving up to the surface they behave quite differently than their 2d counterparts which stay deep below the photosphere .",
    "in fact , in 3d the tornadoes can reach up to the top of the computational domain , quite high in the photosphere , as witnessed by the strong vortex tube displayed in fig  [ tornado02 ] .    obviously , the tornadoes are candidates to explain the extra turbulence near downdrafts which has been diagnosed by high resolution spectroscopy of solar granulation ; see e.g. @xcite,@xcite . as it is of interest to investigate those phenomena in ordinary granules ,",
    "we have presently such work ongoing .    in the paper on high resolution 2d models of solar granulation , @xcite , we have observed strong acoustic pulses .",
    "actually , they are also easily seen in fig .",
    "[ s2f - p ] of the present paper which refer to the 2d case , which come from a model of much lower resolution than in the paper just mentioned . as much as resolution",
    "is being concerned their 3d counterparts should clearly show up in the present refined 3d resolution .",
    "there are , however , no such isolated and strong acoustic pulses .",
    "rather , wavetrains can be observed ( best in movies where one can actually follow them ) .",
    "it will require a more subtle analysis to figure out whether their energetics is comparable to that of the pulses in 2d and whether they possibly play a role for the heating of the chromosphere .",
    "we have described the antares code for stellar radiation hydrodynamics whose design goals have been flexibility regarding numerical schemes and dimensions of the computation as well as microphysics ( idealized or realistic ) . that holds also true for grid structure ( straight or polar coordinates ) and equations used ( e.g. hydrodynamic equations in straight or polar coordinates ) .",
    "then , we have compared various numerical schemes and demonstrated the benefits of using high - order eno schemes . in the high - resolution runs ,",
    "weno-5 with marquina flux splitting stably with but a tiny amount of viscosity added in the momentum equation and without a need to add any unphysical diffusitivity in the energy equation .",
    "this results in high information content per grid point .",
    "grid refinement , possibly in a hierarchical fashion , allows to closer zoom in on interesting features .    in this way",
    ", we have investigated solar granulation , in particular a decaying exploding granule in the refinement region .",
    "numerous rapidly spinning vortex tubes ( diameter about @xmath16 or less ) generated by the granule border downflows in the region where they become buoyant again manage to ascend to the photosphere near the granular downflows .",
    "many of them are arclike , some others reach straight up to the top of the domain , i.e. high into the solar atmosphere and possibly therefore the chromosphere .    applications of the antares code to other topics in stellar physics are underway and will be reported in due time .",
    "this research was supported by the austrian science foundation , project p17024 and p18224 .",
    "the computations were performed at the xian cluster of the faculty of mathematics , university of vienna and at the schrdinger cluster , vienna university .",
    "we acknowledge the possibility to use computers at mpi for astrophysics and at rzg for calculating opacity binning tables and for part of the software development .",
    "alexander , d.  r. , ferguson , j.  w. : 1994 , apj  437 , 879 bray , r.  j. , loughland , r.  e. : 1977 , soph  54 , 319 bruls , j.  h.  m.  j. , vollmller , p. , schssler , m. : 1999 , a&a  348 , 233 carlson , b.  g. : 1963 , in alder b. , fernbach s. ( eds . ) methods in computational physics , 1 caunt , s.  e. , korpi , m.  j. : 2001 , a&a  369 , 706 christensen - dalsgaard , j. et al . : 1996 , sci ..  272 , 1286 donat , r. , marquina , a. : 1996 , jcoph  125 , 42 edmonds , f.n . : 1957 , apj  125 , 535 fedkiw , r. et al . : 1998 , in progress in numerical solutions of partial differential equations ferguson , j.  w. , alexander , d.  r. , allard , f. , et al .",
    "2005 , apj , 623 , 585 gandorfer , a.m. , solanki , s.k . ,",
    "schssler , m. , curdt , w. , lites , b.w . : 2004 , proc .",
    "spie , vol .",
    "5489 , 732 hanslmeier , a. , nesis , a. , mattig , w. : 1994 , a&a  288 , 960 harten , a. et al . : 1978 , jcoph  71 , 231 iglesias , c.  a. , & rogers , f.  j.  1996 , apj , 464 , 943 jiang , g. , shu , c .- w . : 1996 , jcoph  126 , 202 kippenhahn r. , weigert a. : 1994 , stellar structure and evolution .",
    "3rd printing , springer - verlag , new york komm , r. , mattig , w. , nesis , a. : 1991 , a&a  252 , 812 kunasz , g.  l. , auer , l.  h. : 1988 , jqsrt  39 , 67 kupka , f. : 2008 , in deng l. , chan k.l .",
    "the art of modelling stars in the 21st century , iau symposium 252 , in press kurucz , r.  l. : 1993 , smithsonian astrophysical observatory , cd - roms 2 and 13 leveque , r.  j. : 1992 , numerical methods for conservation laws liu , x. , osher , s. : 1998 , jcoph  142 , 304 liu , x. , osher , s. , chan , t. : 1994 , jcoph  115 , 200 lowan , a. n. , davids , n. , levenson , a. : 1942 , in bulletin of the american mathematical society , 739 ludwig et al . : 1994 , a&a  284 , 105 ludwig , h .-",
    "g . , allard , f. , hauschildt , p.h .",
    ": 2002 , a&a  395 , 99 maltby , p. et.al . : 1986 , apj  306 , 284 mihalas , d. : 1978 , stellar atmosphere , second edition mihalas , d. et al . : 1978 , apj  220 , 1001 mihalas , d. , mihalas , b.w . : 1984 , foundations of radiation hydrodynamics muthsam , h.  j. et al . : 2007 , mnras  380 , 1335 nendwich , j. et al . : 2004 , comm .",
    "asteroseismolgy 144 , 43 nesis , a. , hanslmeier , a. , hammer , r. , komm , r. , mattig , w. , staiger , j. , 1993 : a&a  279 , 599 neumaier , a. : 2001 , introduction to numerical analysis nordlund , a. : 1982 , a&a  107 , 1 olson , l.  h. , kunasz , p.  b. : 1987 , jqsrt  38 , 325 piskunov , n. , kupka , f. : 2001 , apj  547 , 1040 robinson , f.j . , demarque , p. , guenther , d.b . ,",
    "kim . , y .- c . ,",
    "chan , k.l .",
    ": 2005 , mnras  362 , 1031 rogers , f.  j. , swenson , f.  j. , iglesias , c.  a. : 1996 , apj  456 , 902 roudier , t. , muller , r. : 1986 , soph  107 , 11 shu , c .- w .",
    ": 1997 , technical report nasa cr-97 - 206253 icase report no .",
    "97 - 65 shu , c .- w . ,",
    "osher , s. : 1988 , jcoph  83 , 32 shu , c .- w . , osher , s. : 1989 , jcoph  77 , 439 smagorinsky , j. 1963 , mwr  91 , 99 steffen , m. : 1990 , a&a  239 , 443 stein , r.  f. , nordlund , a. : 1998 , apj  499 , 914 stein , r.  f. , nordlund , a. : 2000 , soph  192 , 91 stix , m. : 1989 , the sun - an introduction vgler , a. : 2003 , phd thesis , universitt gttingen vgler , a. et al . : 2005 , a&a  429 , 335 wedemeyer , s. , freytag , b. , steffen , m. , ludwig , h .-",
    "holweger , h. : 2004 , a&a  414 , 1121"
  ],
  "abstract_text": [
    "<S> we discuss the general design of the antares code which is intended for simulations in stellar hydrodynamics with radiative transfer and realistic microphysics in 1d , 2d and 3d . </S>",
    "<S> we then compare the quality of various numerical methods . </S>",
    "<S> we have applied antares in order to obtain high resolution simulations of solar granulation which we describe and analyze . in order to obtain high resolution </S>",
    "<S> , we apply grid refinement to a region predominantly occupied by an exploding granule . </S>",
    "<S> strong , rapidly rotating vortex tubes of small diameter ( @xmath0 generated by the downdrafts and ascending into the photosphere near the granule boundaries evolve , often entering the photosphere from below in an arclike fashion . </S>",
    "<S> they essentially contribute to the turbulent velocity field near the granule boundaries .    </S>",
    "<S> hydrodynamics  methods : numerical  stars  sun : granulation  convection </S>"
  ]
}