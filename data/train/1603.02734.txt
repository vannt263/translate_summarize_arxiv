{
  "article_text": [
    "( mmwave ) communication is a promising technology for next - generation wireless communication owing to its abundant frequency spectrum resource , which promises a much higher capacity than the existing wireless local area networks ( wlans ) @xcite and the current cellular mobile communication @xcite . in order to bridge the link budget gap due to the extremely high path loss in mmwave band ,",
    "beamforming with large antenna arrays are generally required in mmwave communications .",
    "subject to the expensive radio - frequency ( rf ) chains , analog beamforming / combining structure is usually preferred , where all the antennas share a single rf chain and have constant - amplitude ( ca ) constraint on their weights @xcite .",
    "meanwhile , a hybrid analog / digital precoding / combining structure was also proposed to realize multi - stream / multi - user transmission @xcite , where a small number of rf chains are tied to a large antenna array .",
    "subject to the hardware constraint , i.e. , the number of rf chains is far less than the number of antennas in general , the conventional multiple - input multiple - output ( mimo ) channel estimation is basically infeasible in mmwave communications either due to high pilot overhead or high computational cost , and new channel estimation methods need to be tailored to mmwave systems @xcite . for the hybrid precoding structure , as mmwave channel is generally sparse in the angle domain , different compressed sensing ( cs ) based channel estimation methods were proposed to estimate the steering angles of multipath components ( mpcs ) @xcite . for the analog beamforming structure , a switched beamforming approach was usually adopted @xcite , where the beam search space ( at the transmitter and receiver side , respectively ) is represented by a codebook containing multiple codewords , and the best transmit / receive beams are found by searching through their respective codebooks .    in practical mmwave channel estimation",
    ", a coarse sub - codebook may be defined with a small number of coarse sectors ( or low - resolution beams ) covering the intended angle range , while a fine sub - codebook may be defined with a large number of fine ( or high - resolution ) beams covering the same intended angle range , and that a coarse sector may have the same coverage as that of multiple fine beams together @xcite . a divide - and - conquer search",
    "may then be carried out across the hierarchical codebook , by finding the best sector first on the low - resolution codebook level , and then finding the best beam on the high - resolution codebook level , while the best high - resolution beam is encapsulated in the best sector @xcite .",
    "such a hierarchical codebook structure and the associated multi - stage beam search have been adopted in many recent works @xcite .",
    "performances of the search schemes , including the search time and detection rate of desired mpcs , are highly dependent on the codebook design . with an analog beamforming structure , @xcite proposed to use wider beams to speed up beam search , but design approaches to broaden the beams were not studied . in @xcite , a binary - tree structured hierarchical codebook was designed by using brute - force antenna deactivation ( deact ) , where wider beams were generated by turning off part of the antennas . in @xcite , a hierarchical codebook was also designed , where beam widening is achieved via sub - array technique .",
    "although it was shown to outperform deact @xcite , half of antennas may still need to be turned off for some codewords . in brief , to design a full codebook with an analog beamforming structure , antenna deactivation is basically needed , which not only reduces the total transmission power , but also requires an analog switch in each antenna branch , leading to additional cost and power consumption @xcite .",
    "in contrast , a hybrid precoding structure with multiple rf chains ( typically a few ) can not only enable multi - stream transmission , but also offer higher flexibility for codebook design ; hence antenna deactivation and analog switches can be avoided . in @xcite ,",
    "the hybrid precoding structure was ( maybe firstly ) adopted to shape wider beams by exploiting the sparse reconstruction approach ( sparse ) , but high - quality wide beams can be shaped only when the number of rf chains is large enough and deep sinks within the angle range appear otherwise .",
    "in addition , a phase - shifted discrete fourier transform ( ps - dft ) method was also proposed in @xcite , where wider beams are shaped by steering multiple rf chains to adjacent equally spaced angles ; thus a large number of rf chains are required to shape a very - wide codeword .",
    "although these works @xcite are theoretically feasible , they basically need a lot of rf chains for very - wide codewords , which may make them unappropriate for devices with only a few rf chains .    on the other hand , with multiple rf chains the output powers of the antennas",
    "may be significantly different from each other due to combining signals of multiple rf chains , and the power fluctuation is expected to be more severe when the number of rf chains is greater . since in mmwave integrated circuits the saturation power of a pa is usually limited @xcite , the output power fluctuation may limit the total transmission power . in these parallel works",
    "@xcite , the per - antenna power constraint ( papc ) , caused by the limited saturation power of pa in each antenna branch , was not taken into account .    in this paper , we target at designing a codebook for mmwave channel estimation with a hybrid precoding structure ( typically with a few rf chains ) , and we take the papc into account in the design . we first propose a metric , called generalized detection probability ( gdp ) , to evaluate the quality of an arbitrary codeword .",
    "this metric not only enables a general optimization approach for mmwave codebook design , but also can be used to compare the performance of two different codewords / codebooks . to the best of our knowledge",
    ", gdp is the first metric particularly for mmwave codebook design .",
    "we then propose an approach to design a hierarchical codebook for the hybrid structure , where beam is widened via multi - rf - chain sub - array technique ( bmw - ms ) . to obtain crucial parameters of bmw - ms ,",
    "we provide two solutions , namely a low - complexity search ( lcs ) solution to optimize the gdp metric and a closed - form ( cf ) solution to pursue a flat beam pattern .",
    "performance comparisons show that bmw - ms / lcs and bmw - ms / cf achieve almost equivalent performances , and they ( with only 2 rf chains ) outperform the existing alternatives under the papc .",
    "the rest of this paper is as follows . in section",
    "ii , the system and channel models are introduced . in section",
    "iii , the channel estimation method is proposed , and the problem of codebook design is formulated . in section iv ,",
    "the gdp metric is proposed . in section",
    "v , the hierarchical codebook design is presented . in section",
    "vi , performance evaluation is conducted .",
    "the conclusions are drawn lastly in section vii .",
    "symbol notations : @xmath0 , @xmath1 , @xmath2 , and @xmath3 denote a scalar variable , a vector , a matrix , and a set , respectively .",
    "@xmath4 , @xmath5 and @xmath6 denote conjugate , transpose and conjugate transpose , respectively .",
    "@xmath7 denotes expectation operation .",
    "@xmath8_i$ ] and @xmath9_{ij}$ ] denote the @xmath10-th entry of @xmath1 and the @xmath10-row and @xmath11-column entry of @xmath2 , respectively .",
    "@xmath8_{i : j}$ ] , @xmath9_{:,j}$ ] , and @xmath9_{j,:}$ ] denote a vector with entries being the @xmath10-th to @xmath11-th entries of @xmath8 $ ] , the @xmath11-th column of @xmath2 and the @xmath11-th row of @xmath2 , respectively .",
    "@xmath12 , @xmath13 and @xmath14 denote the absolute value , two - norm and @xmath15-norm respectively .",
    "without loss of generality , we consider a point - to - point mmwave system with a hybrid digital / analog precoding / combining structure , as shown in fig .",
    "[ fig : system ] , where multiple rf chains are tied to a half - wave spaced uniform linear array ( ula ) at both the tx and rx .",
    "while extending the channel estimation method and the codebook design to a downlink multiuser scenario is straightforward .",
    "relevant parameters are listed below , where @xmath16 is the number of data streams .",
    "= @xmath17  = the number of rf chains at the tx .",
    "+ @xmath18 the number of antennas at the tx .",
    "+ @xmath19 the number of rf chains at the rx .",
    "+ @xmath20 the number of antennas at the rx .",
    "+ @xmath21 @xmath22 digital precoding matrix at the tx .",
    "+ @xmath23 @xmath24 analog precoding matrix at the tx .",
    "+ @xmath25 @xmath26 digital combining matrix at the rx .",
    "+ @xmath27 @xmath28 analog combining matrix at the rx .",
    "+ @xmath29 a tx _ composite codeword _ , @xmath30 .",
    "+ @xmath31 a tx codeword , @xmath32_{:,i})$ ] .",
    "+ @xmath33 a rx _ composite codeword _ , @xmath34 .",
    "+ @xmath35 a tx codeword , @xmath36_{:,i})$ ] .",
    "+    basically , we have @xmath37 and @xmath38 , but in practical mmwave systems , @xmath39 and @xmath40 are small , basically far less than @xmath41 and @xmath42 , respectively .    in this paper",
    ", we propose a channel estimation method based on a hierarchical codebook , and design the codebook with the hybrid structure in fig .",
    "[ fig : system ] .",
    "a tx codebook is a collection of _ composite codewords _ , and a tx composite codeword is in fact a precoding matrix pair @xmath43 , which can be seen as the composite of @xmath17 tx codewords @xmath44 .",
    "the constitution of the rx codebook is similar to the tx codebook .",
    "we emphasize that in this paper _ we use underline to mark a codeword and a composite codeword , respectively _ , as shown in the above list .",
    "note that the tx / rx codebooks are predesigned , and thus they are irrelevant to an instantaneous channel response .",
    "however , they are designed based on the steering feature of mmwave channel , and they are used to reduce the training overhead in channel estimation .",
    "we emphasize that there is a single pa in each antenna branch right before the antenna at the tx .",
    "since in practice the saturation power of a mmwave pa is basically limited @xcite , we have the papc in our model , i.e. , the saturation power of a pa is @xmath45 , which was not considered in @xcite and @xcite .",
    "in addition , similar to @xcite and @xcite , the analog precoding / combining matrices are with constant - amplitude ( ca ) elements , because they are controlled by phase shifters .",
    "note that there is no switch in each antenna branch .    without loss of generality",
    ", we adopt the same channel model as that in @xcite , which is given by @xmath46 where @xmath47 is the complex coefficient of the @xmath48-th path , @xmath49 is the number of mpcs , @xmath50 is the steering vector function , @xmath51 and @xmath52 are cos(aod ) and cos(aoa ) of the @xmath48-th path , respectively .",
    "let @xmath53 and @xmath54 denote the physical aod and aoa of the @xmath48-th path , respectively ; then we have @xmath55 and @xmath56",
    ". therefore , @xmath51 and @xmath52 are within the range @xmath57 $ ] .",
    "_ for convenience , in the rest of this paper the cosine angles @xmath51 and @xmath52 are called aods and aoas , respectively . without particular statement",
    ", the angle domain implicitly means cosine angle domain . _",
    "similar to @xcite , @xmath47 can be modeled to be complex gaussian distributed , while @xmath51 and @xmath52 can be modeled to be uniformly distributed within @xmath58 $ ] .",
    "@xmath50 is a function of the number of antennas and aod / aoa , and can be expressed as @xmath59^{\\rm{t } } , \\end{aligned}\\ ] ] where @xmath60 is the number of antennas ( @xmath60 is @xmath41 at the transmitter and @xmath61 at the receiver ) , @xmath62 is aod or aoa .",
    "it is easy to find that @xmath63 is a periodical function which satisfies @xmath64 .",
    "the channel matrix @xmath65 also has power normalization @xmath66",
    "subject to the hardware constraint , i.e. , the number of rf chains is far less than that of the antennas , mmwave channel estimation is generally to search the aods / aoas of several strong mpcs one by one via _ beam search _ in the angle domain @xcite . in this subsection",
    ", we propose an improved beam search method to search one mpc with the hybrid precoding structure in fig .",
    "[ fig : system ] .    in order to estimate the aod / aoa of an mpc",
    ", signal measurements must be carried out based on transmission of training sequences . in each measurement ,",
    "multi - stream orthogonal training sequences are transmitted from tx to rx , with precoding matrices selected from a tx codebook and combining matrices selected from a rx codebook , respectively .",
    "hence , we have the following signal model for a measurement : @xmath67 where @xmath68 is the transmission power per stream , @xmath65 is the channel matrix , @xmath69 is a white gaussian noise matrix with average power @xmath70 , @xmath71_{j,:}$ ] is the @xmath11-th transmitted training sequence with a length of @xmath72 at tx , @xmath73_{i,:}$ ] is the received sequence at the @xmath10-th rf chain at rx , _ @xmath74 and @xmath75 are a selected tx composite codeword and a selected rx composite codeword , respectively .",
    "_ we have @xmath71_{m,:}[{\\bf{s}}]_{n,:}^{\\rm{h}}=0 $ ] when @xmath76 and @xmath71_{m,:}[{\\bf{s}}]_{m,:}^{\\rm{h}}={l_{\\rm{s}}}$ ] .",
    "let us omit the noise for simplicity .",
    "then we have @xmath77_{i , : } = \\sqrt p [ { { \\bf{w}}}_{\\rm{bb}}]_{:,i}^{\\rm{h}}{{\\bf{w}}}_{\\rm{rf}}^{\\rm{h}}{\\bf{h}}\\sum_{m=1}^{m_{\\rm{rf}}}{{{\\bf{f}}}_{\\rm{rf}}}[{{{\\bf{f}}}_{\\rm{bb}}}]_{:,m}[{\\bf{s } } ] _ { m,:}\\ ] ] thus , @xmath78_{i,:}[{\\bf{s } } ] _ { j,:}^{\\rm{h } } \\\\ & = { l_{\\rm{s } } } \\sqrt p [ { { \\bf{w}}}_{\\rm{bb}}]_{:,i}^{\\rm{h}}{{\\bf{w}}}_{\\rm{rf}}^{\\rm{h}}{\\bf{h}}{{{\\bf{f}}}_{\\rm{rf}}}[{{{\\bf{f}}}_{\\rm{bb}}}]_{:,j}\\\\ & \\triangleq { l_{\\rm{s } } } \\sqrt p{{\\bf{w}}}_i^{\\rm{h}}{\\bf{h}}{\\bf{f}}_{j } , \\end{aligned}\\ ] ] where @xmath79 , and @xmath80 , @xmath81_{:,i}$ ] and @xmath82_{:,j}$ ] correspond to the @xmath10-th rx codeword @xmath36_{:,i})$ ] of the selected rx composite codeword and the @xmath11-th tx codeword @xmath83_{:,j})$ ] of the selected tx composite codeword , respectively .",
    "afterwards , rx obtains the optimal tx / rx codeword pair as @xmath84 and feeds back @xmath85 to tx .",
    "hence , in each measurement , rx in fact finds the best tx / rx codeword pair with the highest signal power .",
    "if the tx / rx codewords are pre - designed to cover different angle ranges , then the aod / aoa of the mpc will be within the angle coverage of the best tx / rx codewords , respectively .    to reduce the training overhead , a hierarchical tx or rx codebook , which is a collection of codewords @xmath86 or @xmath87 , is defined as fig .",
    "[ fig : codebook ] , the codebook has @xmath88 layers with indices from @xmath89 to @xmath90 , where @xmath91 and @xmath60 are the number of rf chains and antennas , respectively .",
    "the number of codewords in the @xmath92-th layer is @xmath93 , and @xmath94,\\\\ k=0,1, ...",
    ",\\log_m(n),~n = 1,2, ... ,{m^k } , \\end{aligned}\\ ] ] where @xmath95 denotes the beam coverage in the angle domain of codeword @xmath87 , @xmath96 denotes the @xmath97-th codeword in the @xmath92-th layer .",
    "note that a set of @xmath91 adjacent codewords in the same layer , i.e. , @xmath98 ( @xmath99 ) , constitute a composite codeword @xmath100 .",
    "based on a hierarchical codebook , an efficient divide - and - conquer search , as shown in algorithm [ alg : search ] , is launched to fast estimate the response of an mpc .",
    "it is noteworthy that a codebook shown in fig .",
    "[ fig : codebook ] and designed in this paper can not only used in algorithm [ alg : search ] , but also in other beam search methods . on the other hand ,",
    "only one mpc is searched out by launching algorithm [ alg : search ] once . for the case that multiple mpcs",
    "are needed to be searched out , algorithm [ alg : search ] must be launched multiple times to estimate different mpcs , one mpc at a time with new training sequences transmitted . however , extending the one - mpc search to multiple - mpc search is not trivial , because the contribution of the already searched mpc must be subtracted when searching a new mpc .",
    "details may refer to @xcite .",
    "* 1 ) initialization : * + @xmath101 . @xmath102the layer index.@xmath103 + @xmath104 .",
    "@xmath102the maximal layer.@xmath103 + predefine tx codebook @xmath105 and rx codebook @xmath106 .",
    "+ @xmath107 .",
    "@xmath102indices of tx / rx composite codewords.@xmath103 + * 2 ) iteration : * +    * 3 ) result : *    the response of the estimated mpc is given by @xmath108 .",
    "another comment we want to make here is as follows .",
    "there is another dimension reduced channel estimation in massive mimo system .",
    "it is to add a digital dimension reduced precoding matrix to feed tx antennas @xcite .",
    "however , this approach needs to decide which precoding matrix to use , which is , in fact , the main issue to address here .",
    "let us next evaluate the training overhead of algorithm [ alg : search ] .",
    "we adopt the duration of a training symbol as a unit to count the training overhead , which is the same as that in regular mimo systems @xcite .",
    "to guarantee the orthogonality between different training sequences , we have @xmath109 .",
    "it is noted that in regular mimo systems @xmath110 is usually set equal to @xmath17 to save overhead @xcite , but in mmwave communications @xmath110 is usually set much greater than @xmath17 to provide spreading gain for channel estimation , because tx / rx array gains are not yet available before channel estimation @xcite .    for a fair comparison with the alternatives , i.e. , @xcite and @xcite , we assume that the length of the training sequence is the same ( @xmath110 ) in these algorithms . in each measurement of algorithm",
    "[ alg : search ] , @xmath18 training sequences @xmath111_{j,:}\\}_{j=1,2, ... ,m_{\\rm{an}}}$ ] are transmitted in parallel ; so the training overhead is @xmath110 .",
    "suppose @xmath112 and @xmath113 .",
    "the total training overhead of algorithm [ alg : search ] is @xmath114 , significantly less than that of the beam search algorithm with an analog beamforming structure in @xcite ( @xmath115 ) , as well as that of the beam search algorithm with a hybrid precoding structure in @xcite ( algorithm 1 therein , which needs @xmath116 units if @xmath117 ) . in brief , algorithm [ alg : search ] reduces the training overhead by a factor of the number of rf chains compared with the alternatives , which benefits from the parallel transmission of multiple training sequences .",
    "however , the cost of this benefit is that the codewords within a composite codeword must share the same analog precoding matrix , which will be considered in the codebook design .",
    "as we can see , a codebook is critical to algorithm [ alg : search ] . in this paper",
    "we want to design a hierarchical codebook with the beam coverage shown in fig .",
    "[ fig : codebook ] based on the hybrid structure shown in fig .",
    "[ fig : system ] .",
    "we emphasize that we have both the papc on pas and the ca constraint on the analog precoding / combining matrices .",
    "since a rx codebook design can be the same as a tx codebook design , we proceed with tx codebook design .    according to , with the hybrid structure an arbitrary codeword @xmath118 shapes an antenna weight vector ( awv ) @xmath119 , and the beam steering and coverage of @xmath87",
    "are in fact reflected by @xmath120 .",
    "hence , codebook design in this paper is to design @xmath96 such that @xmath121 has the beam coverage @xmath122 . _ for convenience , we also call @xmath120 a codeword in the remaining of this paper , _ but we emphasize that we want to design @xmath118 rather than just @xmath120 itself , because @xmath120 is solely determined by @xmath87 but not vice versa .",
    "consequently , a codeword @xmath120 has the following structure : @xmath123_j[{{\\bf{f}}_{\\rm{rf}}}]_{:,j},\\ ] ] where @xmath124 , @xmath125_{:,j}|=\\frac{1}{\\sqrt{m_{\\rm{an}}}}{\\bf{1}}$ ] ( the ca constraint ) .",
    "note that the codewords belong to the same composite codeword share the same @xmath126 , which must be considered in the design .",
    "given the target beam pattern of @xmath121 shown in fig .",
    "[ fig : codebook ] , we need to design @xmath127 for each @xmath121 , which is challenging due to the ca constraint on @xmath126 . in @xcite ,",
    "this problem is solved by exploiting the sparse reconstruction approach ( sparse ) . while in @xcite ,",
    "the problem is further constrained by letting @xmath128 , i.e. , the transmission power of each rf chain is the same , i.e. , @xmath129_j|^2\\|[{{\\bf{f}}_{\\rm{rf}}}]_{:,j}\\|^2=1 $ ] . in such a case ,",
    "a codeword is a combination of multiple rf vectors with equal power , and it is intuitive that by steering these rf vectors to equally spaced angles , a wide beam can be shaped .",
    "this is just the ps - dft codebook proposed in @xcite .    in this paper",
    ", we also let @xmath130 to simplify the problem , just the same as @xcite .",
    "however , we will propose different methods to design the codewords . in the following",
    ", we will first establish a general metric , i.e. , the gdp metric , to evaluate the quality of an arbitrary tx codeword @xmath120 .",
    "we emphasize that the metric is applicable for codewords with both analog and hybrid structures .",
    "then we will design a hierarchical codebook with the target beam coverage shown in fig .",
    "[ fig : codebook ] with the codeword structure .",
    "given an arbitrary target codeword to cover an angle range @xmath131 $ ] , there are many approaches to design it .",
    "it is clear that the best codeword should have constant absolute beam gain within the covered angle range ( i.e. , a totally flat beam pattern ) @xcite .",
    "however , due to the ca constraint on the analog precoding / combining matrices , an ideal codeword can be hardly designed .",
    "hence , suboptimal designs are of interest , and there have been many approaches to design a hierarchical codebook@xcite . to the best of our knowledge",
    ", however , there is no particular metric to directly evaluate the quality of a codeword in the regime of mmwave communications .",
    "we can only judge the quality of a codeword by numerical simulation .",
    "hence , in this subsection , we establish a general metric and introduce its properties and significance .",
    "let us first define the beam gain of an arbitrary codeword @xmath120 along angle @xmath62 ( @xmath132 $ ] ) , i.e. , @xmath133 : @xmath134}_n}{e^ { - j\\pi ( n - 1)\\omega } } } .\\ ] ]    intuitively , good codewords should have flat beam patterns , and mean square error ( mse ) can be adopted to measure how flat a beam pattern is . moreover , in mmwave communications , the saturation power of pa is limited .",
    "hence , good codewords should also allow as high as possible maximal transmission power ( mtp ) , which is limited by the saturation power of pa in each antenna branch .",
    "for instance , deact is not with high quality , because a lot of antenna elements are turned off , which significantly lowers the mtp .",
    "in fact , under the papc , the mtp of an arbitrary codeword @xmath120 is given by @xmath135_n|^2\\}_{n=1}^{n})}\\triangleq \\frac{p_{\\rm{per}}}{\\|{\\bf{w}}\\|_\\infty^2},\\ ] ] where @xmath136 is the papc in this paper , i.e. , the saturation power of pa in each antenna branch .",
    "it is clear that given fixed @xmath136 , @xmath137 is maximized when @xmath120 ( with unit 2-norm ) has ca elements .",
    "as we can see , both mse and mtp may affect the quality of a codeword and their effects are different .",
    "in fact , these two metrics are basically contradictory to each other , i.e. , a codeword may have a small mse but meanwhile also a small mtp . in general ,",
    "we want small mse along with large mtp .",
    "it is not favorable to define a metric with simple operations between the mse and mtp . for rigorousness , we directly bridge the metric to the detection performance in beamforming training , because the codebook is particularly designed for it . during beamforming training ,",
    "many tx / rx codeword pairs will be selected to detect the aod / aoa of an mpc .",
    "when the aod / aoa of the mpc locate within the coverage of the codewords , the detection probability ( dp ) is a direct and exact metric .",
    "hence , we can derive the average dp , and generalize a metric based on the average dp for the tx codewords .",
    "suppose that tx transmits a training sequence with codeword @xmath138 , and rx receives with codeword @xmath139 , i.e. , @xmath138 and @xmath139 are fixed .",
    "the target beam coverage of @xmath138 is @xmath131 $ ] .",
    "we want to develop a metric to evaluate the tx codeword @xmath138 based on the average dp of a single mpc .",
    "let @xmath140 denote the channel response for the mpc to be detected , and it can be defined as @xmath141 where @xmath142 , @xmath62 and @xmath143 denote the gain , aoa and aod of the mpc , respectively . without loss of generality , we assume @xmath144 , @xmath62 and @xmath143 are uniformly distributed within @xmath58 $ ]",
    ".    given @xmath140 the detection problem can be formulated as binary hypothesis testing given by @xcite @xmath145 where @xmath146 and @xmath147 represent the cases when the aod does not locate and locates within @xmath131 $ ] , respectively , @xmath148 denotes the received pure signal .",
    "given a threshold @xmath149 , the instantaneous dp is given by @xmath150 where @xmath151 . to derive the average dp , we need to average @xmath152 on all the random variables .",
    "note that @xmath153 depends on @xmath140 and @xmath140 depends on @xmath142 , @xmath62 and @xmath143 .",
    "hence , we need to average @xmath152 on @xmath97 , @xmath142 , @xmath62 and @xmath143 .",
    "let us first fix @xmath62 and @xmath143 and average @xmath152 on @xmath97 and @xmath142 .",
    "since @xmath148 , when @xmath62 and @xmath143 are fixed , @xmath140 has only one random parameter @xmath144 .",
    "in such a case , @xmath153 can be seen as a zero - mean complex gaussian variable , and @xmath154 , where @xmath155 denotes the average received snr given by @xmath156 where @xmath157 and @xmath158 are in fact tx and rx array gains depending on @xmath143 and @xmath62 , respectively . according to ( * ? ? ?",
    "* chapter 2 ) , @xmath159 obeys chi - square distribution with 2 degrees , and its cumulative distribution function ( cdf ) is @xmath160 .",
    "thus , we have @xmath161    is the result of averaging dp on @xmath142 and @xmath97 .",
    "we need to further average @xmath162 in on @xmath62 and @xmath143 to obtain the ultimate average dp .",
    "note that as we only want to evaluate the quality of the tx codeword @xmath138 with angle coverage @xmath131 $ ] , we can first get rid of the effects of the rx codeword @xmath139 and aoa @xmath62 .",
    "consequently , we assume the rx gain is fixed for simplicity , and without loss of generality we let @xmath163 .",
    "although the assumption may lead to inaccuracy , it simplifies the ultimate gdp metric , which does not require an accurate average dp expression . as a result",
    ", @xmath155 reduces to @xmath164 and considering the mtp of @xmath138 , the maximal received snr is @xmath165 where @xmath166 denotes the per - antenna received snr under the papc .",
    "consequently , the average dp is given by @xmath167    we can see that @xmath168 depends on both @xmath169 and @xmath166 in addition to the codeword @xmath138 itself .",
    "hence , it can not be directly used as a general metric to evaluate the quality of a codeword .",
    "however , we can define one based on @xmath168 .",
    "firstly , the threshold @xmath169 affects only the tradeoff between dp in hypothesis @xmath147 and false - alarm probability ( fap ) in hypothesis @xmath146 @xcite . when @xmath169 is smaller , dp is higher , but meanwhile fap is also higher .",
    "in fact , the threshold itself does not affect the detection capability which involves both da and fap @xcite .",
    "based on this fact , we can just set @xmath170 without loss of generality .",
    "when @xmath169 is larger / smaller , dp will be lower / higher , but the comparison result of average dp between two different codewords basically maintains .    on the other hand , @xmath166 may affect the comparison result of average dp between two different codewords . intuitively , when @xmath166 is sufficiently high , the beam pattern ( reflected by @xmath171 in ) is dominant , but when @xmath166 is small , the maximal received snr ( reflected by @xmath172 in ) is dominant . hence , different system should set different @xmath166 .    a possible way is to set a typical value of @xmath166 based on the system settings .",
    "for instance , the saturation power of a pa can be set to 15 dbm @xcite . according to the friis formula ,",
    "when the wavelength of the carrier frequency is 1 centimeter ( 30 ghz ) , and the tx / rx distance is 100 meters , @xmath136 will be @xmath173 dbm .",
    "besides , when the bandwidth @xmath174 mhz , the noise power can be computed as @xmath175 dbm , where @xmath176 and @xmath177 are the boltzmann constant and ambient temperature , respectively .",
    "hence , the per - antenna received snr is @xmath178 db . however , in the computation the spreading gain of the training sequence , that equals to the length of the training sequence , is not taken into account .",
    "if the length of the training sequence is @xmath179 , the spreading gain is @xmath180 db . if the possible propagation loss due to reflection , blockage etc . is 0 to 15 db",
    ", @xmath166 will have a dynamic range from @xmath181 db to @xmath182 db , i.e. , @xmath183 $ ] db , according to the above evaluation . in this paper",
    "we prefer to set @xmath184 db for conciseness , but it should be clarified that other typical values close to 0 db are also applicable .",
    "it will be shown in section vi that a small change of @xmath166 does not affect the comparison result of two codewords .",
    "for mmwave pa that provides a higher / lower saturation power , @xmath166 can be set to @xmath185 dbm , where @xmath186 is the saturation power with unit dbm .",
    "based on the above discussions , we propose the metric of generalized detection probability ( gdp ) for an arbitrary @xmath60-entry tx codeword @xmath120 with unit 2-norm and target coverage @xmath131 $ ] : @xmath187 where @xmath188_n|^2\\}_{n=1}^{n})}$ ] .",
    "note that although is defined for tx codewords , it also can be used for rx codewords , because small input fluctuation of low - noise amplifier ( lna ) is also favored in mmwave communications , where the linearity of lna may be not perfect due to the high frequency and large signal bandwidth . in the case",
    "that the linearity of lna is good enough , can be modified by replacing @xmath189 with constant 1 for rx codewords .",
    "in this paper , we use for both tx / rx codeword designs .",
    "the gdp metric has the following properties .    * property 1 : ( phase - shift invariance ) * @xmath190 is invariant to phase shift , i.e. , @xmath191 , where @xmath192 represents entry - wise product ( a.k.a .",
    "hadamard product ) and all angles are in the cosine angle domain .",
    "see appendix a.    * property 2 : ( in favor of ca weights ) * @xmath190 increases with @xmath189 decreases , and @xmath193 , where the equality holds only when @xmath194_n|^2=1/n$ ] .",
    "it is clear that @xmath195 increases with @xmath189 decreases .",
    "thus @xmath190 increases with @xmath189 decreases .",
    "in addition , @xmath196_n|^2\\}_{n=1}^{n})}\\geq   { { \\rm{mean}}(\\{|[{\\bf{w}}]_n|^2\\}_{n=1}^{n})}=1/n , \\end{aligned}\\ ] ] where the equality holds only when @xmath194_n|^2=1/n$ ] .",
    "see appendix b.    these properties of gdp offer guidance on codebook design .",
    "property 1 shows that if a codeword @xmath120 has been designed with coverage @xmath131 $ ] , another codeword with target coverage @xmath199 $ ] can be immediately obtained as @xmath200 without re - launching the designing process .",
    "property 2 implies that a good codeword should have elements with close amplitudes , such that the mtp will be higher .",
    "property 3 shows that a good codeword should have equivalent beam gains along different angles ( i.e. , flat beam pattern ) ; thus deep sinks with the beam pattern should be avoided .",
    "moreover , one significance of gdp lies in that it enables a general optimization approach to design the codewords .",
    "in particular , if we want to design an arbitrary codeword @xmath120 with target beam coverage @xmath131 $ ] , we can formulate the following problem @xmath201 where @xmath202 is a parameter vector to be determined , and the constraints can include other desired structure constraints to simplify the search complexity in addition to the ca constraint .",
    "the proposed bmw - ms / lcs codebook is just obtained with the optimization approach ( cf . ) .",
    "note that the gdp metric and the optimization approach can be used for codebook design with both analog beamforming and hybrid precoding structures .",
    "another significance of gdp lies in that it provides an additional way to compare two different codewords / codebooks besides simulation . with the same target beam coverage ,",
    "a codeword with higher gdp has better performance .",
    "for two different codebooks with the same coverage structure , its performance is basically determined by the codewords with the widest beams .",
    "hence , by comparing the gdas of the widest codewords of two different codebooks , we can evaluate which one is better . in section",
    "vi we show that the results of gdp comparison agree with those of the success rate and achievable rate comparisons .",
    "in this section we propose the bmw - ms approach to design a tx hierarchical codebook based on multi - rf - chain sub - array technique . in order to obtain the coefficients for each sub - array ,",
    "we propose two candidate solutions .",
    "the first one is a low - complexity search ( lcs ) solution to optimize the gdp metric , and the second one is a closed - form ( cf ) solution which is based on property 3 to pursue flat beam patterns .",
    "hence , the bmw - ms approach with the two solutions are termed as bmw - ms / lcs and bmw - ms / cf , respectively .",
    "it is noteworthy that when letting @xmath130 in the structure of the tx codeword can be further written as @xmath203 where @xmath204_{:,i}$ ] is the rf weight vector ( rwv ) of the @xmath10-th rf chain , and the phases of @xmath205 have been absorbed into those of @xmath206 ; thus we have in fact let @xmath207 here .",
    "a critical challenge to design the hierarchical codebook shown in fig . [ fig : codebook ] is beam widening , i.e. , to design the low - layer codewords which have wide beam widths .",
    "intuitively , if @xmath17 is sufficiently large , wide beams can be shaped by steering these rf rwvs towards equally spaced angles within the beam coverage .",
    "this is just the ps - dft approach @xcite .",
    "however , in practice @xmath17 may be rather small .",
    "in such a case , we consider to use the sub - array technique to shape a wide beam .",
    "in particular , a large rwv of each rf chain can be divided into multiple sub - vectors ( called sub - arrays ) , and these sub - arrays can point at different directions , such that a wider beam can be shaped .    to illustrate this ,",
    "let us separate the @xmath60-element rwv of each rf chain into @xmath208 sub - arrays with @xmath209 elements in each sub - array , which means @xmath210 .",
    "in addition , letting @xmath211_{(m - 1){n_{\\rm{s } } } + 1:m{n_{\\rm{s}}}}}$ ] , we have @xmath212_n } = { [ { { \\bf{v}}_i}]_{(m - 1){n_{\\rm{s } } } + n}}$ ] , @xmath213 , @xmath214 , and @xmath215 .",
    "@xmath216 can be seen as the sub - rwv of the @xmath217-th sub - array of the @xmath10-th rf chain .",
    "therefore , the beam gain of @xmath120 writes @xmath218_n}}{e^ { - j\\pi ( n - 1)\\omega } } } \\\\ = & \\sum\\limits_{n = 1}^n { \\sum\\limits_{i = 1}^{{m_{\\rm{rf } } } } { [ { { \\bf{v}}_i } } { ] _ n}{e^ { - j\\pi (",
    "n - 1)\\omega } } } \\\\ = & \\sum\\limits_{m = 1}^{{m_{\\rm{s } } } } { \\sum\\limits_{n = 1}^{{n_{\\rm{s } } } } { \\sum\\limits_{i = 1}^{{m_{\\rm{rf } } } } { [ { { \\bf{v}}_i } } { ] _ { ( m - 1){n_{\\rm{s } } } + n}}{e^ { - j\\pi ( ( m - 1){n_{\\rm{s } } } + n - 1)\\omega } } } } \\\\ = & \\sum\\limits_{i = 1}^{{m_{\\rm{rf } } } } \\sum\\limits_{m = 1}^{{m_{\\rm{s } } } } { \\sum\\limits_{n = 1}^{{n_{\\rm{s } } } } { { e^ { - j\\pi ( m - 1){n_{\\rm{s}}}\\omega } } { { [ { { \\bf{f}}_{i , m}}]}_n}{e^ { - j\\pi ( n - 1)\\omega } } } } \\\\ = & \\sum\\limits_{i = 1}^{{m_{\\rm{rf } } } } { \\sum\\limits_{m = 1}^{{m_{\\rm{s } } } } { { e^ { - j\\pi ( m - 1){n_{\\rm{s}}}\\omega } } a({{\\bf{f}}_{i , m}},\\omega ) } } , \\end{aligned}\\ ] ] where we can find that the beam coverage of @xmath120 can be controlled by controlling the @xmath219 sub - arrays @xmath220 .",
    "it is noteworthy that the coefficient between different sub - arrays is @xmath221 .",
    "as the coefficient depends on @xmath217 and @xmath222 , it induces coupling effect between different sub - arrays of the same rf chain .",
    "when the angle gap of two adjacent sub - arrays of the same rf chain is not wide enough , the coupling effect will be significant .",
    "in contrast , the coefficient does not depend on @xmath10 .",
    "hence , there is no coupling effect between different sub - arrays of different rf chains , which means that the steering angles of two sub - arrays of different rf chains can be close without affecting each other .    based on the above observation",
    ", we propose the bmw - ms approach for beam widening , i.e. , to cover an arbitrary angle range @xmath223 $ ] with @xmath17 rf chains , where each rf chain is decomposed into @xmath208 sub - arrays , and the sub - rwvs @xmath220 are set to steer along the angles @xmath224 where @xmath225 , i.e. , @xmath220 satisfies @xmath226 where @xmath227 are phase parameters ( in the angle domain instead of cosine angle domain ) to be determined . since the beam width of a sub - array is @xmath228 , @xmath229 should be no larger than @xmath228 ; otherwise there will be sink between two adjacent sub - arrays .",
    "an example of the beam patterns of the sub - arrays is shown in fig .",
    "[ fig : substeering ] , where @xmath230 , @xmath231 , @xmath232 , @xmath233 , and @xmath234 .",
    "the intuition of this approach is explained as follows . as we want to cover an angle interval of @xmath235 , and there are @xmath219 controllable sub - arrays in total , we can evenly steer these sub - arrays with an angle gap @xmath225 over the desired angle range .",
    "moreover , in order to reduce the coupling effect between adjacent sub - arrays of the same rf chain , we set their angle gap as wide as possible .    , @xmath231 , @xmath232 , @xmath233 , and @xmath234 .",
    "]      a remaining critical issue is to determine the coefficients @xmath227 for the bmw - ms approach in .",
    "we propose two solutions as follows , i.e. , a low - complexity search ( lcs ) and a closed - form ( cf ) solutions .      according to",
    ", the following optimization problem can be formulated : @xmath236_{(m - 1){n_{\\rm{s } } } + 1:m{n_{\\rm{s } } } } } = { { \\bf{f}}_{i , m } } = \\\\ & \\sqrt{\\frac{{n_{\\rm{s}}}}{n}}e^{j\\theta_{i , m}}{\\bf{a}}(n_{\\rm{s}},\\omega_{i , m } ) , \\end{aligned}\\ ] ] which is a non - convex problem .",
    "although the exhaustive grid search can be directly adopted to search over the feasible domains of @xmath227 , it has a high computational complexity which grows exponentially with the total number of the sub - arrays . to lower the search complexity , we assume equal - difference phase sequences for the sub - arrays of the same rf chain and the sub - arrays of different rf chains , respectively , i.e.",
    ", we let @xmath237 where @xmath238 $ ] is the phase difference of the phase sequence for the sub - arrays of the same rf chain , and @xmath239 $ ] is the phase difference of the phase sequence for the sub - arrays of different rf chains . with this assumption",
    ", the problem reduces to a 2-parameter search problem , which does not grow with the total number of sub - arrays .",
    "thus , the computational complexity becomes affordable .      according to ,",
    "the sub - arrays are set to steer along @xmath240 with an angle gap @xmath229 .",
    "this can only guarantee that the beam gains along these directions are high . according to property 3",
    ", we also hope that the beam gains along the other angles between adjacent @xmath240 are high , such that the beam pattern is flatter .",
    "thus , we can design @xmath227 to maximize the beam gains along the middle angles of adjacent @xmath240 , i.e. , @xmath241 where @xmath242 . fig .",
    "[ fig : substeering ] also shows the locations of @xmath243 .",
    "since @xmath244 , according to the beam gain of @xmath120 along angles @xmath243 can be derived as @xmath245    it is clear that to determine @xmath246 by optimizing the absolute beam gain in is still complicated .",
    "however , since we want to obtain a low - complexity solution , we do not directly solve the optimization problem .",
    "noticing that @xmath247 becomes smaller when @xmath248 becomes greater from 0 to @xmath249 , and can be neglected when @xmath250 .",
    "this means that the two sub - arrays with steering angles closest to @xmath251 have the most significant effects on the beam gain along @xmath251 , while the sub - arrays with steering angles far from @xmath251 have a little effect on the beam gain along @xmath251 , which can also be observed from fig .",
    "[ fig : substeering ] .",
    "this motivates us to consider only the two close sub - arrays when optimizing the beam gain for simplicity . with this idea",
    ", we can finally obtain @xmath252 where @xmath253 , @xmath215 , and @xmath213 .",
    "the detailed derivation can be found in appendix b.      up to now we have assumed that @xmath17 , @xmath208 and @xmath209 are known in priori .",
    "however , in practice @xmath17 is given by the system setting , while @xmath208 and @xmath209 are in fact determined by the beam width @xmath235 of the codeword to be designed .",
    "in other words , @xmath208 and @xmath209 may be different for different codewords with different beam widths .",
    "since when @xmath208 is smaller @xmath209 will be bigger and a higher beam gain can be provided , @xmath208 should be as small as possible .",
    "as @xmath254 and @xmath255 , we can obtain @xmath256 where @xmath257 is the ceiling operation .",
    "recall that we need to design @xmath96 instead of just @xmath121 itself . by exploiting the bmw - ms approach we can design @xmath258 .",
    "recall again that different codewords within the same composite codeword share the same @xmath259 , i.e. , the same @xmath260 .",
    "this can be satisfied by using property 1 as follows . according to property 1 , @xmath261 which means all the codewords within the same layer can share the same @xmath259 .    in summary ,",
    "the codebook is generated as follows , where @xmath262 , @xmath263 .",
    "* split each rf chain into @xmath264 sub - arrays , where @xmath265 .",
    "let the number of antennas of each sub - array be @xmath266 .",
    "* compute @xmath267 as @xmath268 , where @xmath269_{(m - 1){n_{\\rm{s } } } + 1:m{n_{\\rm{s } } } } } = \\sqrt{\\frac{{n_{\\rm{s}}}}{n}}e^{j\\theta_{i , m}}{\\bf{a}}(n_{\\rm{s}},\\omega_{i , m})$ ] .",
    "@xmath240 is computed as ( @xmath234 , @xmath270 ) .",
    "@xmath227 can either be computed by solving with the low - complexity search method ( bmw - ms / lcs ) or according to the closed - form expression ( bmw - ms / cf ) .",
    "* compute @xmath96 ( @xmath271 ) according to property 1 as @xmath272 .",
    "interestingly , bmw - ms happens to be a generalization of the ps - dft method in @xcite . with the ps - dft method ,",
    "a wide beam is constructed by exploiting multiple rf chains , which steer toward adjacent angles with a gap @xmath273 , and the shaped beam width is @xmath274 . to lower the search complexity ,",
    "the ca coefficients corresponding to the rwvs of all the rf chains are modeled as an equal - difference sequence in terms of the phase , and thus there is only one single parameter to determine .",
    "a drawback of the ps - dft method lies in that the number of rf chains is proportional to the beam width . to generate very - wide beam , e.g. , the codeword @xmath275",
    ", the number of rf chains would be too many for implementation .    in bmw - ms @xmath17",
    "is assumed small .",
    "however , in the case that the number of available rf chains is large enough , e.g. , equal to @xmath60 , to shape a codeword with a beam width of @xmath235 , we can determine the number of rf chains to generate this codeword as @xmath276 .",
    "then according to , we obtain @xmath277 , and thus @xmath278 . in such a case ,",
    "bmw - ms / lcs becomes almost the same as ps - dft except the objective function .",
    "moreover , according to for bmw - ms / cf , in the case of @xmath277 , @xmath279 is just an increasing sequence , which has a good accordance with @xcite and bmw - ms / lcs .",
    "therefore , we say bmw - ms can be seen as a generalization of ps - dft .    however , we emphasize that the main purpose of bmw - ms is to design a full hierarchical codebook shown in fig . [",
    "fig : codebook ] with as less as possible rf chains , because in reality the number of available rf chains in a mmwave device would be small , e.g. , typically only 2 , 4 or 8 .",
    "in fact , we recommend to select @xmath280 to realize bmw - ms , because fewer rf chains help to reduce the input / output fluctuation of the pas , and with 2 rf chains bmw - ms can already achieve promising performance as we shall see from simulations later , but a larger number of rf chains can improve the efficiency of channel estimation as shown in section iii .",
    "in this section we evaluate the performance of bmw - ms . we will first show the beam patterns of bmw - ms and compare them with those of the alternatives .",
    "afterwards , we will perform extensive performance comparisons between these candidates in terms of the gdp metric , success ( detection ) rate and achievable rate .",
    "[ fig : beamcomp ] shows the beam pattern comparison between bmw - ms / lcs and bmw - ms / cf , where @xmath281 , @xmath280 and @xmath282 is the layer index . from this figure",
    "we can observe that both approaches have realized the beam coverage shown in fig .",
    "[ fig : codebook ] .",
    "in addition , bmw - ms / cf basically provides similar beam patterns to bmw - ms / lcs , which means that the closed - form solution is also promising .    ,",
    "@xmath280 , @xmath282 is the layer index .",
    "the dashed red line superpositions the solid red line . ]",
    "next , we compare the performances of different codebooks . we know that when the saturation power of a pa is limited , the input fluctuation significantly affects the average output power .",
    "basically the less the fluctuation is , the higher the average output power is .",
    "hence , we first evaluate the fluctuation of the input power of the antennas with different codebooks .",
    "to do so , as each codebook has @xmath283 layers , we select one codeword from each layer of a codebook except the @xmath284th layer , because sparse did not provide the @xmath284th layer in @xcite .",
    "since each codeword has @xmath60 elements , we now have @xmath285 elements in total .",
    "hence , we can calculate the statistics on these elements and obtain the cdf curve .",
    "[ fig : cdf ] shows the cdf comparison between different codebooks , where @xmath286 .",
    "note that in this figure all the codewords have unit 2-norm , i.e. , the papc is not applied yet .",
    "we can find that for bmw - ms / lcs and bmw - ms / cf , most of the elements locate around the average power @xmath287 , and the strongest element has a power about 0.06 ( corresponding to @xmath189 in ) .",
    "however , for ps - dft and sparse , the power of the elements disperses within a large range from 0 to more than 0.5 .",
    "hence , it is clear that bmw - ms / lcs and bmw - ms / cf have lower power fluctuation than ps - dft and sparse , and according to we can deduce that under the papc bmw - ms / lcs and bmw - ms / cf have higher mtp than ps - dft and sparse .    .",
    "[ fig : beamcomp_diff ] shows beam pattern comparison between different schemes with / without papc , where @xmath286 and the codeword is @xmath288 with coverage @xmath289 $ ] for all the schemes .",
    "when without papc the 2-norm of a codeword is normalized to 1 , while when with papc the entry with the largest absolute value of the codeword is normalized to 1 according to . from this figure we can find that without papc , ps - dft and sparse have flatter beam patterns than bmw - ms / lcs and bmw - ms / cf ( the upper figure ) , but with papc , bmw - ms / lcs and bmw - ms / cf have higher beam gains than ps - dft and sparse ( the bottom figure ) .    ,",
    "and the codeword is @xmath288 with coverage @xmath289 $ ] for all the schemes . ]",
    "[ fig : beamcomp_vs ] shows the beam pattern comparison between bmw - ms / cf and ps - dft with / without papc , where @xmath290 .",
    "( a ) and ( b ) are without papc , and the beam patterns match the results in ( * ? ? ?",
    "* fig.4 ( b : level 1 ) and ( b : level 2 ) ) .",
    "( c ) and ( d ) are with papc . from this figure",
    "we can find that ps - dft outperforms bmw - ms when there is no papc , because ps - dft has flatter beam patterns .",
    "note that ps - dft achieves the superiority at the cost of a larger number of rf chains .",
    "the numbers of rf chains are @xmath291 and 2 for ps - dft and bmw - ms , respectively .",
    "in contrast , when papc is considered , which is practically reasonable in mmwave communications due to the limited performance of pa , bmw - ms / cf can offer an higher beam gain .",
    "[ fig : metricomp ] shows the gdp comparison between different schemes under papc .",
    "the codewords of the 1st layer is considered , because the performance of a codebook is basically determined by the widest codeword .",
    "both cases of @xmath292 db ( the left hand side figure ) and @xmath293 db ( the right hand side figure ) are considered . from them",
    "we can observe that bmw - ms / lcs and bmw - ms / cf have equivalent gdp performance , which is significantly better than ps - dft and sparse .",
    "for sparse , there is a peak gdp as @xmath60 increases .",
    "this is because when @xmath60 is small the received snr plays a cardinal role to determine the gdp , and thus the gdp increases with @xmath60 , which increases the beam gain .",
    "however , when @xmath60 is large , the received snr is already high enough . in such a case",
    ", the beam pattern plays a cardinal role instead .",
    "since the number of rf chains is fixed , there will appear sinks as @xmath60 increases according to @xcite .",
    "thus , the gdp decreases on the contrary as @xmath60 increases . moreover , although the gdp grows when @xmath293 db compared with the case of @xmath292 db , the comparison results maintain , which demonstrates that the gdp metric in is reasonable and robust .        figs .",
    "[ fig : success_rate ] and [ fig : achievable_rate ] show the comparisons of success rate and achievable rate between different schemes under papc , where @xmath294 .",
    "@xmath295 in the simulations , and similar results can be observed when @xmath49 is set to other values .",
    "success rate refers to the rate that an mpc is successfully acquired by algorithm 1 , while achievable rate is computed by using the best tx / rx precoding / combining codewords with algorithm 1 .",
    "these two figures show again that bmw - ms / lcs and bmw - ms / cf have similar overall performances , which are significantly better than ps - dft and sparse .",
    "the results of these two figures have a good agreement with the gdp results shown in fig .",
    "[ fig : metricomp ] , which again demonstrates the rationality of the established gdp metric in .    .",
    "in this paper we design a hierarchical codebook taking the per - antenna power constraint into account for mmwave channel estimation with a hybrid precoding / combining structure , where multiple rf chains are available .",
    "we have first established the gdp metric to particularly measure the performance of an arbitrary codeword .",
    "the metric not only enables a general optimization approach for codebook design , but also provides an additional way to compare the performance of different codewords / codebooks .",
    "besides , gdp turns out to have a good accordance with the simulated performances of success ( detection ) rate and the achievable rate . to the best of our knowledge , gdp is the first metric that has been explicitly proposed for codebook design in mmwave communications .",
    "then bwm - ms / lcs and bmw - ms / cf have been proposed to design a hierarchical codebook by exploiting the multi - rf - chain sub - array technique , where bwm - ms / lcs optimizes the gdp metric using a simplified search method under the sub - array structure , while bmw - ms / cf provides closed - form codewords to pursue flat beam patterns .",
    "performance comparisons show that bmw - ms / lcs and bmw - ms / cf achieve very close performances , and they ( with only 2 rf chains ) outperform ps - dft and sparse under the per - antenna power constraint .",
    "firstly , we have @xmath296}_n}{e^{j\\pi ( n - 1)\\psi } } { e^ { - j\\pi ( n - 1)\\omega } } } \\\\   = & \\sum\\limits_{n = 1}^n { { { [ { \\bf{w}}]}_n}{e^ { - j\\pi ( n - 1)(\\omega   - \\psi ) } } }",
    "\\\\ \\mathop { = } \\limits^{(c ) } & a({\\bf{w}},\\omega   - \\psi ) , \\end{aligned}\\ ] ] where ( a ) and ( c ) are according to , while ( b ) is according to definition of the entry - wise product .",
    "besides , we have @xmath297_n|^2\\}_{n=1}^{n})}\\\\ = & { \\max(\\{|[{\\bf{w}}]_n e^{j\\pi(n - 1)\\psi}|^2\\}_{n=1}^{n})}\\\\ = & { \\max(\\{|[{\\bf{w}}]_n|^2\\}_{n=1}^{n})}=\\|{\\bf{w}}\\|_\\infty^2 . \\end{aligned}\\ ] ] hence , @xmath298",
    "according to , @xmath120 can be written as the following summation form : @xmath299 where @xmath300 is small , @xmath301 , @xmath302 , and @xmath303 .",
    "let @xmath304 .",
    "since @xmath305 , @xmath306 is a concave function @xcite , and thus we have @xmath307 where the equality holds only when @xmath308 , i.e. , a constant . in the following",
    "we will show that this constant is @xmath309 .",
    "given an arbitrary codeword @xmath120 with unit 2-norm , the average power of its beam gain in the angle domain is    @xmath310}_n}{e^ { - j\\pi ( n - 1)\\omega } } } } \\right)}^{\\rm{h}}}\\left ( { \\sum\\limits_{n = 1}^n { { { [ { \\bf{w}}]}_n}{e^ { - j\\pi ( n - 1)\\omega } } } } \\right){\\rm{d}}\\omega } \\\\ = & \\frac{1}{2}\\int _ { - 1}^1 { \\sum\\limits_{n = 1}^n { \\sum\\limits_{m = 1}^n { [ { \\bf{w}}]_n^{\\rm{h}}{e^{j\\pi ( n - 1)\\omega } } { { [ { \\bf{w}}]}_m}{e^ { - j\\pi ( m - 1)\\omega } } } } { \\rm{d}}\\omega } \\\\",
    "= & \\frac{1}{2}\\int _ { - 1}^1 { \\sum\\limits_{n = 1}^n { \\sum\\limits_{m = 1}^n { [ { \\bf{w}}]_n^{\\rm{h}}{{[{\\bf{w}}]}_m}{e^{j\\pi ( n - m)\\omega } } } } { \\rm{d}}\\omega } \\\\ = & \\|{\\bf{w}}{\\|^2 } + \\frac{1}{2}\\int _ { - 1}^1 { \\sum\\limits_{n = 1}^n { \\sum\\limits_{m = 1,m \\ne n}^n { [ { \\bf{w}}]_n^{\\rm{h}}{{[{\\bf{w}}]}_m}{e^{j\\pi ( n - m)\\omega } } } } { \\rm{d}}\\omega } \\\\",
    "= & \\|{\\bf{w}}{\\|^2 } + \\frac{1}{2}\\sum\\limits_{n = 1}^n { \\sum\\limits_{m = 1,m \\ne n}^n { \\int _ { - 1}^1 { [ { \\bf{w}}]_n^{\\rm{h}}{{[{\\bf{w}}]}_m}{e^{j\\pi ( n - m)\\omega } } { \\rm{d}}\\omega } } } \\\\",
    "\\mathop   = \\limits^{(a ) } & \\|{\\bf{w}}{\\|^2 } + \\frac{1}{2}\\sum\\limits_{n = 1}^n { \\sum\\limits_{m = 1,m \\ne n}^n { [ { \\bf{w}}]_n^{\\rm{h}}{{[{\\bf{w}}]}_m}\\int _ { - 1}^1 { { e^{j\\pi ( n - m)\\omega } } { \\rm{d}}\\omega } } } \\\\",
    "= & \\|{\\bf{w}}{\\|^2}=1 , \\end{aligned}\\ ] ]    where in ( a ) we have used @xmath311    since @xmath312 when @xmath313 $ ] , and @xmath314 when @xmath315 $ ] , we have @xmath316 .",
    "hence @xmath309 , which completes the proof .",
    "@xmath317      as shown in fig .",
    "[ fig : substeering ] , there are two different types of positions of @xmath251 .",
    "the first one is @xmath251 with @xmath319 .",
    "the closest steering angles to it are @xmath320 and @xmath321 , i.e. , the two corresponding sub - arrays have adjacent rf indices and the same sub - array index .",
    "the other one is @xmath322 .",
    "the closest steering angles to it are @xmath323 and @xmath324 , i.e. , the two corresponding sub - arrays have adjacent sub - array indices but the rf index switches from @xmath17 to 1 .",
    "the beam gain of the first type of @xmath251 is derived as in on the top of the next page , where we have used @xmath325 from we can find that to optimize the absolute gain , we have @xmath326 in addition , the beam gain of the other type of @xmath251 is derived as in on the top of the next page , where we can find that to optimize the absolute gain , we have @xmath327          e.  perahia , c.  cordeiro , m.  park , and l.  l. yang , `` ieee 802.11 ad : defining the next generation multi - gbps wi - fi , '' in _ ieee consumer communications and networking conference ( ccnc)_.1em plus 0.5em minus 0.4emlas vegas , nv : ieee , jan .",
    "2010 , pp . 15 .",
    "p.  xia , h.  niu , j.  oh , and c.  ngo , `` practical antenna training for millimeter wave mimo communication , '' in _ ieee vehicular technology conference ( vtc ) 2008_.1em plus 0.5em minus",
    "0.4emcalgary , canada : ieee , oct .",
    "2008 , pp .",
    "p.  xia , s.  k. yong , j.  oh , and c.  ngo , `` multi - stage iterative antenna training for millimeter wave communications , '' in _ ieee globecom conference 2008_.1em plus 0.5em minus 0.4emnew orleans , la , usa : ieee , dec .",
    "2008 , pp . 16 .",
    "j.  wang , z.  lan , c.  pyo , t.  baykas , c.  sum , m.  rahman , j.  gao , r.  funada , f.  kojima , and h.  harada , `` beam codebook based beamforming protocol for multi - gbps millimeter - wave wpan systems , '' _ ieee journal on selected areas in communications _",
    "27 , no .  8 , pp .",
    "13901399 , oct .",
    "2009 .",
    "s.  han , i.  chih - lin , z.  xu , and c.  rowell , `` large - scale antenna systems with hybrid analog and digital beamforming for millimeter wave 5 g , '' _ ieee communications magazine _ , vol .  53 , no .  1 , pp .",
    "186194 , jan . 2015",
    "w.  roh , j .- y .",
    "seol , j.  park , b.  lee , j.  lee , y.  kim , j.  cho , k.  cheun , and f.  aryanfar , `` millimeter - wave beamforming as an enabling technology for 5 g cellular communications : theoretical feasibility and prototype results , '' _ ieee communications magazine _ , vol .",
    "52 , no .  2 ,",
    "106113 , feb .",
    "s.  sun , t.  s. rappaport , r.  heath , a.  nix , and s.  rangan , `` mimo for millimeter - wave wireless communications : beamforming , spatial multiplexing , or both ? '' _ ieee communications magazine _ , vol .",
    "52 , no .  12 , pp .",
    "110121 , dec . 2014 .",
    "y.  niu , y.  li , d.  jin , l.  su , and a.  v. vasilakos , `` a survey of millimeter wave communications ( mmwave ) for 5 g : opportunities and challenges , '' _ wireless networks _ , vol .  21 , no .  8 , pp .",
    "26572676 , 2015 .",
    "p.  wang , y.  li , x.  yuan , l.  song , and b.  vucetic , `` tens of gigabits wireless communications over e - band los mimo channels with uniform linear antenna arrays , '' _ ieee transactions on wireless communications _ ,",
    "vol .  13 , no .  7 , pp .",
    "37913805 , july 2014 .",
    "p.  wang , y.  li , l.  song , and b.  vucetic , `` multi - gigabit millimeter wave wireless communications for 5 g : from fixed access to cellular networks , '' _ ieee communications magazine _ , vol .",
    "53 , no .  1 ,",
    "168178 , jan .",
    "a.  alkhateeb , o.  el  ayach , g.  leus , and r.  heath , `` channel estimation and hybrid precoding for millimeter wave cellular systems , '' _ ieee journal of selected topics in signal processing _ , vol .  8 , no .  5 , pp . 831846 , oct .",
    "2014 .",
    "y.  peng , y.  li , and p.  wang , `` an enhanced channel estimation method for millimeter wave systems with massive antenna arrays , '' _ ieee communications letters _ , vol .",
    "19 , no .  9 , pp .",
    "15921595 , sept .",
    "m.  kokshoorn , p.  wang , y.  li , and b.  vucetic , `` fast channel estimation for millimetre wave wireless systems using overlapped beam patterns , '' in _ ieee international conference on communications ( icc)_.1em plus 0.5em minus 0.4emlondon , uk : ieee , june 2015 , pp . 13041309 .",
    "z.  xiao , t.  he , p.  xia , and x .-",
    "xia , `` hierarchical codebook design for beamforming training in millimeter - wave communication , '' _ arxiv preprint arxiv:1511.02128 , to appear in ieee transactions on wireless communications _ , 2016 .",
    "s.  noh , m.  d. zoltowski , and d.  j.  love , `` multi - resolution codebook based beamforming sequence design in millimeter - wave systems , '' in _ ieee global telecommunications conference _ , san diego , ca , usa , dec . 2015 , pp . 16 .",
    "y.  jin , m.  a. sanduleanu , e.  a. rivero , and j.  r. long , `` a millimeter - wave power amplifier with 25db power gain and + 8dbm saturated output power , '' in _",
    "european solid state circuits conference ( esscirc)_.1em plus 0.5em minus 0.4emieee , 2007 , pp . 276279 .",
    "y.  zhao and j.  r. long , `` a wideband , dual - path , millimeter - wave power amplifier with 20 dbm output power and pae above 15% in 130 nm sige - bicmos , '' _ ieee journal of solid - state circuits _ ,",
    "47 , no .  9 , pp . 19811997 , 2012 .",
    "o.  el  ayach , s.  rajagopal , s.  abu - surra , z.  pi , and r.  heath , `` spatially sparse precoding in millimeter wave mimo systems , '' _ ieee transactions on wireless communications _ , vol .",
    "13 , no .  3 , pp .",
    "14991513 , march 2014 .",
    "s.  hur , t.  kim , d.  j. love , j.  v. krogmeier , t.  a. thomas , and a.  ghosh , `` millimeter wave beamforming for wireless backhaul and access in small cell networks , '' _ ieee transactions on communications _ , vol .",
    "61 , no .",
    "10 , pp . 43914403 , oct .",
    "j.  nsenga , w.  van  thillo , f.  horlin , v.  ramon , a.  bourdoux , and r.  lauwereins , `` joint transmit and receive analog beamforming in 60 ghz mimo multipath channels , '' in _ ieee international conference on communications ( icc)_.1em plus 0.5em minus 0.4emdresden , germany : ieee , june 2009 , pp .",
    "z.  xiao , x .-",
    "xia , d.  jin , and n.  ge , `` iterative eigenvalue decomposition and multipath - grouping tx / rx joint beamformings for millimeter - wave communications , '' _ ieee transactions on wireless communications _ , vol .",
    "14 , no .  3 , pp .",
    "15951607 , march 2015 .",
    "z.  xiao , p.  xia , and x .-",
    "xia , `` low complexity hybrid precoding and channel estimation based on hierarchical multi - beam search for millimeter - wave mimo systems , '' _ arxiv preprint arxiv:1603.01634 , submitted to ieee transactions on vehicular technology_.      l.  you , x.  gao , x .-",
    "xia , n.  ma , and y.  peng , `` pilot reuse for massive mimo transmission over spatially correlated rayleigh fading channels , '' _ ieee transactions on wireless communications _ , june 2015 .",
    "z.  xiao , c.  zhang , d.  jin , and n.  ge , `` glrt approach for robust burst packet acquisition in wireless communications , '' _ ieee transactions on wireless communications _ , vol .",
    "12 , no .  3 , pp .",
    "11271137 , march 2013 ."
  ],
  "abstract_text": [
    "<S> in this paper , we study hierarchical codebook design for channel estimation in millimeter - wave ( mmwave ) communications with a hybrid precoding structure . due to the limited saturation power of mmwave power amplifier ( pa ) , </S>",
    "<S> we take the per - antenna power constraint ( papc ) into consideration . </S>",
    "<S> we first propose a metric , i.e. , generalized detection probability ( gdp ) , to evaluate the quality of _ an arbitrary codeword_. this metric not only enables an optimization approach for mmwave codebook design , but also can be used to compare the performance of two different codewords / codebooks . to the best of our knowledge </S>",
    "<S> , gdp is the first metric particularly for mmwave codebook design for channel estimation . </S>",
    "<S> we then propose an approach to design a hierarchical codebook exploiting beam widening with multi - rf - chain sub - array technique ( bmw - ms ) . to obtain crucial parameters of bmw - ms , </S>",
    "<S> we provide two solutions , namely a low - complexity search ( lcs ) solution to optimize the gdp metric and a closed - form ( cf ) solution to pursue a flat beam pattern . </S>",
    "<S> performance comparisons show that bmw - ms / lcs and bmw - ms / cf achieve very close performances , and they outperform the existing alternatives under the papc .    millimeter wave , mmwave , mmwave beamforming , mmwave precoding , codebook design , hybrid precoding , hierarchial search . </S>"
  ]
}