{
  "article_text": [
    "in the past years , it has been shown that evolution can be strongly affected by population structure , extending the classical result that `` certain quantities are independent of the geographical structure of a population ''  @xcite .",
    "an approach that became popular in the past decade is to consider population structures described in terms of graphs , where the nodes are individuals which reproduce ( or interact ) through the links of the graph  @xcite .",
    "it has been shown that all regular graphs do not change the probability that a mutant will either take over or go extinct compared to well - mixed populations , which can be described by a fully connected graph  @xcite .",
    "this result has been obtained for a microscopic evolutionary process , called birth - death ( bd ) update , in which first an individual is sampled from the whole population at random , but proportional to fitness , and then its identical offspring replaces a neighboring individual . however , such results depend on the details of the microscopic evolutionary process  @xcite , which makes it challenging to disentangle structure from dynamics . also the temporal dynamics of this process has interesting aspects , as amplifiers of selection may slow down the process of fixation itself  @xcite .    of particular interest",
    "are two specific classes of graphs , namely amplifiers and suppressors of selection .",
    "a graph is called an _ amplifier of selection _ , if , compared to a well - mixed population , ( i ) advantageous mutants have a higher fixation probability on this graph and ( ii ) disadvantageous mutants have a lower fixation probability on this graph .",
    "effectively , selection is amplified as mutants on this graph only require a lower fitness difference compared to the wild - type to obtain the same fixation probability as in the well - mixed population and consequently , drift is suppressed .",
    "some examples for amplifiers of selection are given in  @xcite , e.g.  the star , the super - star or the funnel .",
    "conversely , a graph is called a _ suppressor of selection _ , if , compared to a well - mixed population , ( i ) advantageous mutants have a lower fixation probability on this graph and ( ii ) disadvantageous mutants have a higher fixation probability on this graph . in  @xcite , examples for suppressors of selection are mostly source and sink populations , such as one - rooted graphs or hierarchical tissues  @xcite .",
    "the present study has been triggered by two observations : first , the star graph , which is a popular and simple amplifier of selection under bd updating  @xcite , becomes a suppressor of selection under db updating , where a random individual is removed and its neighbors compete for the empty spot proportional to their fitness @xcite .",
    "second , for small populations under bd updating , all possible undirected graphs are amplifiers of selection , unless they are regular and thus identical to the well - mixed population in terms of the fixation probability  @xcite .",
    "the complexity of the amplifiers of selection and the simplicity of the suppressors of selection given in  @xcite has suggested that it could be easier to construct suppressors of selection than amplifiers of selection .",
    "in fact , it seems typically trivial to construct suppressors of selection ( as one usually focuses on directed graphs to achieve this ) , whereas to construct amplifiers of selection seems a much more challenging task ( as indicated by the sophistication of structures as the super - star or the meta - funnel ) .",
    "does this imply that most population structures do suppress selection ?    here , we show that this strongly depends on the update mechanism . for birth - death update with a mutant at a random initial position ,",
    "it turns out that almost all small random graphs are actually amplifiers of selection . for death - birth updating ,",
    "almost all small random graphs turn out to be suppressors of selection .",
    "this shows that it is basically trivial to construct either amplifiers or suppressors of selection , if the microscopic evolutionary process is not fixed .",
    "however , as most graphs have fixation probabilities close to the well - mixed case  @xcite , these effects may not be particularly strong and it may be much more challenging to construct strong amplifiers of selection .",
    "another interesting observation is that the vast majority of connected random graphs are either amplifiers or suppressors .",
    "it seems to be more challenging to construct a graph that decreases the fixation probability for both advantageous and disadvantageous mutants , but we show that also for this case , a very simple example exists .",
    "we study the discrete - time moran process on graphs , as discussed in  @xcite .",
    "each node of the graph represents an individual .",
    "the outgoing links of a node describe where the offspring of the focal individual can be placed .",
    "the incoming links of a node describe which other individuals can place their offspring into the focal node .",
    "we restrict ourselves to two types of individuals , wild - type individuals with fitness @xmath0 and mutant individuals with fitness @xmath1 . for @xmath2 , mutants are disadvantageous , for @xmath3 they are advantageous .",
    "we start from a population of wild - types with a single mutant individual located on a random node of the graph . at each time step",
    ", there is one birth and one death event .",
    "we compare two widely used update mechanisms . in the birth - death update ( bd ) , an individual is chosen from the whole population with a probability proportional to its fitness .",
    "it reproduces and places its offspring randomly in one of its neighboring nodes .",
    "thus , selection is global . in the death - birth update ( db ) , a random individual is chosen to die .",
    "one of its neighbors is selected with a probability proportional to its fitness to reproduce into the vacant node .",
    "thus , selection is local .",
    "we do not analyze the case of selection at death ( bd , db ) or selection at birth and death ( bd , db )  @xcite .",
    "we first focus on undirected graphs , where all links are bi - directional . for bd ,",
    "the outgoing link weights are given by @xmath4 where @xmath5 is the number of neighbors of node @xmath6 .",
    "for db , this normalization is implemented over the incoming links , such that their sum is @xmath0 .",
    "this ensures that replacement is equally probable among the neighbors .      in the case of a well - mixed population , which corresponds to a complete graph",
    ", we can analytically calculate the fixation probability , i.e.  the chance that a single mutant takes over the entire population .",
    "this function , which should always increase with the mutant fitness @xmath1 , is given for any markov process with a tri - diagonal transition matrix and two absorbing states at @xmath7 and @xmath8 by  @xcite @xmath9 where @xmath10 is the probability to change the number of mutants from @xmath11 to @xmath12 .",
    "in the case of the bd update , we have @xmath13 where the @xmath14 implies that we have excluded the possibility that an offspring replaces its parent instead of a neighbor . for the fixation probability of a single mutant in the bd process",
    ", we find @xmath15 if we allowed for self - replacement , we would need to replace the @xmath14 in eq .   by @xmath8 , but we would recover the same result , as the ratio @xmath16 remains the same .",
    "thus , in well - mixed populations the difference is immaterial . in graph - structured populations , where self - replacement would imply the inclusion of self - loops at all nodes ,",
    "this issue can be more intricate .",
    "for bd without self - replacement , it has been shown that for several random graph models the fixation probability of the random graphs converges to eq .   with increasing graph size  @xcite .    in the case of the db update ,",
    "we find instead @xmath17 where we have again excluded the possibility of self - replacement .",
    "the fixation probability is now  @xcite @xmath18 in the case of the db update , the fixation probability is different if we allow for self - replacement .",
    "however , for db it would imply that the removed individual is competing with its neighbors for its own slot .",
    "therefore , the db rule with self - replacement seems illogical when we think of the death of individuals .",
    "it has however been used in a game - theoretical context as the so - called imitation updating @xcite , where a random individual is chosen to imitate the strategy of one of its neighbors or stick to its own strategy with a probability proportional to fitness .",
    "this update mechanism is obtained from the db update by adding self - loops to every node of the graph .    in the following ,",
    "we exclude self - replacement and analyze how the update mechanisms change the fixation probability in graph - structured populations .",
    "however , when we move to graphs , we should choose the corresponding well - mixed case as a reference .",
    "the difference between eqs .   and  , which becomes very small for large @xmath8 , implies that the reference is not the same for the two update mechanisms , see fig [ fig1 ] .",
    "for analytical approaches , which are based on the approximation of large @xmath8 , this difference is not particularly important .",
    "however , for us this difference can be crucial , as we are focusing on small graphs .",
    "we numerically generate a large number of erds - rnyi graphs  @xcite and calculate the fixation probability for a single mutant introduced at a random node on that graph .",
    "the @xmath19-algorithm  @xcite generates a random graph with @xmath8 nodes where each link is independently present with probability @xmath20 .",
    "we first analyze if the graph is connected , i.e.  there are no isolated nodes .",
    "if it is disconnected , the fixation probability is formally zero and the graph is no longer of interest to our analysis . in a next step , we check for isothermality  @xcite , i.e.  whether every node has the same probability of being replaced .",
    "if the graph is isothermal , the fixation probability in the bd case is given by that of the complete graph  @xcite .",
    "after creating the random graphs , we calculate the fixation probability for a single mutant in that respective graph , using the numerical approach described in  @xcite . while it is tempting to use the symmetries of the graph to reduce the number of states , for our computational analysis it is sufficient to be able to number all states , i.e. if @xmath21 is the transition matrix of this absorbing markov chain , we reorder the states such that the @xmath22 transient states appear first and the two absorbing states , where all individuals are either mutants or wild - type , are last . now",
    "the transition matrix is in the so - called canonical form , @xmath23 where @xmath24 contains the transition probabilities between transient states and @xmath25 describes the transitions from the transient into the two absorbing states .",
    "since the process can never move out of absorbing states , the lower left block of size @xmath26 is zero and the lower right block is the identity matrix of size @xmath27 . given a starting distribution @xmath28 , the product @xmath29 yields the distribution after exactly @xmath30 time steps . for @xmath31 , we recover the fixation probabilities .    summing over the transient part @xmath32",
    ", we obtain the so - called fundamental matrix of the markov chain @xmath33 .",
    "the @xmath34-th entry of @xmath35 , @xmath36 is the expected sojourn time in the transient state @xmath11 , given that the process started in the transient state @xmath6 .",
    "multiplying @xmath35 with the transition probabilities to the absorbing states provides the fixation probabilities that are of interest to us here . the fixation probability in state @xmath11 after starting in state @xmath6 , @xmath37 , is the @xmath34-th entry of @xmath38 , @xmath39 our main quantity of interest is the probability of a single mutant , introduced at a random node , taking over a population of wild - type individuals .",
    "this fixation probability , which we denote by @xmath40 on a graph @xmath41 , is a function of the fitness @xmath1 .",
    "we do not solve the linear system analytically for general @xmath1 , as this would lead to rational functions of high degrees which are difficult to interpret .",
    "instead , we focus on the five numerical values @xmath42 .",
    "this is enough to classify most graphs as either an amplifier or a suppressor of selection .",
    "our classification is as follows :    * if @xmath43 for @xmath44 and @xmath45 for @xmath46 @xmath47 amplifier * if @xmath45 for @xmath44 and @xmath43 for @xmath46 @xmath47 suppressor    if neither of these two conditions is true , we call the graph `` unclassified '' .",
    "this can either happen due to small numerical errors in our implementation in python or because the graph is truly neither an amplifier nor a suppressor of selection ( see eq .",
    "for an example ) .",
    "this numerical approach is limited due to the system size of up to @xmath48 states and accordingly a transition matrix of size up to @xmath49 .",
    "taking symmetries into account could substantially decrease this number , but this would need to be done on a case by case basis ",
    "an approach that is not suitable if we focus on a large number of random graphs .",
    "alternatively , we could perform stochastic simulations of the fixation process and obtain the fixation probabilities from averaging over many realizations",
    ". however , as the fixation probabilities on graphs are typically close to neutral  @xcite , the precision necessary to classify our graphs requires a very large number of realizations for each @xmath1 .",
    "in contrast , our numerical approach described above has to be performed only once for each value of @xmath1 and does not suffer from any noise which would arise from averaging over a stochastic process .",
    "in  @xcite , we have shown that all four undirected , degree - heterogeneous graphs of size @xmath50 are amplifiers of selection .",
    "the remaining two graphs , the cycle and the complete graph , are degree - homogeneous and thus have the same fixation probability as the well - mixed population . how does this change when we move to larger graphs ?",
    "the number of possible graphs is @xmath51 , i.e.  it increases rapidly with @xmath8 .",
    "this combinatorial explosion prevents us from analyzing all graphs systematically .",
    "instead , we apply the procedure described above and focus on random graphs , using the case of @xmath52 to cross - check .",
    "let @xmath53 be the probability that a graph with @xmath8 nodes is connected .",
    "this probability is given recursively by  @xcite @xmath54 where @xmath55 .",
    "for example , the probability that a graph with @xmath52 nodes is connected is @xmath56 .",
    "the probability that a graph is complete is @xmath57 .",
    "the probability that a graph of size @xmath52 is a cycle is @xmath58 .",
    "thus , the probability that a graph of size @xmath52 is isothermal is @xmath59 , see fig [ fig2 ] .     in erds - rnyi graphs .",
    "the black line depicts the proportion of connected graphs , given by equation . in the left panels",
    ", the blue line yields the proportion of isothermal graphs .",
    "since the isothermal theorem does not hold for db @xcite , in the right panels the blue line depicts only the complete graphs , whereas the white line gives the proportion of cycles for @xmath52 .",
    "left : for birth - death updating , most non - trivial graphs are amplifiers of selection and only a tiny fraction are either suppressors of selection or remain unclassified .",
    "right : if the population size is sufficiently large for death - birth updating , we only find suppressors of selection .",
    "the only  unclassified \" graph of size @xmath52 is the cycle , which is neither an amplifier nor a suppressor of selection for db , see eq .  .",
    "]    in general , most graphs are disconnected for small @xmath20 . for @xmath20 approaching @xmath0 , most graphs are just the complete graph .",
    "fig [ fig2 ] .",
    "shows that for bd updating , the vast majority of graphs are amplifiers of selection . for larger graphs , there are some graphs that are suppressors of selection and some that remain unclassified .    only for @xmath20 very close to 1",
    "there are isothermal graphs , because e.g.  for size 10 it is already very unlikely that a @xmath60-regular graph of degree @xmath61 like the cycle is constructed by chance .",
    "thus , the proportion of isothermal graphs approaches @xmath57 when @xmath8 becomes large .",
    "the star , a popular amplifier of selection under bd updating , is actually a suppressor of selection for db updating  @xcite .",
    "it turns out that a very large proportion of graphs are suppressors of selection , see fig [ fig2 ] .",
    "up to size 14 , we have not found a single amplifier with our procedure , suggesting that they are extremely rare or do not exist at all .    for @xmath52 , we find one graph that is neither an amplifier of selection nor a suppressor of selection .",
    "it turns out that this is the cycle , which occurs with probability @xmath58 .",
    "it has been shown recently @xcite that the isothermal theorem does not hold for db updating .",
    "for the cycle of size @xmath52 , we can calculate the fixation probability of a randomly placed mutant analytically . for the transition probabilities ,",
    "we have @xmath62 with eq .",
    ", this leads to @xmath63 comparing this to the corresponding well - mixed case @xmath64 from eq .",
    ", we have    @xmath65    obviously , we have @xmath66 for any @xmath67 , @xmath68 , which implies that the fixation probability on the cycle with db updating is smaller than the corresponding well - mixed population both for disadvantageous and advantageous mutations .",
    "thus , the cycle with db updating is neither an amplifier nor a suppressor of selection ( see fig [ fig3 ] . ) . in the supporting information ,",
    "we show that this holds for general @xmath8 , i.e.@xmath69 and @xmath70 for @xmath71 .",
    "in other words , the cycle with db updating is a suppressor of fixation compared to the corresponding well mixed case .",
    "is neither an amplifier nor a suppressor of selection .",
    "it decreases the fixation probability compared to the well - mixed population for both advantageous and disadvantageous mutants .",
    "bottom : the difference between the fixation probability in the well - mixed population and the cycle increases with @xmath8 for advantageous mutants .",
    "for disadvantageous mutants , all fixation probabilities tend to zero as the graph size increases . ]",
    "the examples of suppressors of selection for bd updating given in @xcite are directed graphs , e.g.  the directed line with a fixation probability of @xmath72 , meaning that selection is completely eliminated .",
    "another example are so - called source and sink graphs , where fixation in the upstream population is sufficient for a fixation in the whole graph , which suppresses selection .",
    "to explore the abundance of amplifiers and suppressors of selection on directed graphs , we use the numerical procedure explained in the methods section .",
    "in addition , we need to check whether a graph is rooted .",
    "if a graph of size @xmath8 is one - rooted , meaning that there is exactly one node with in - degree zero and positive out - degree , then the fixation probability is @xmath72 because the newly introduced mutant can only reach fixation if it is placed on that root node . on a multi - rooted graph ,",
    "the mutant can never fixate , therefore the fixation probability is zero .    in a directed erds - rnyi random graph constructed by the @xmath73-algorithm ,",
    "each link is independently present with probability @xmath20 .",
    "thus , the probability that a node has in - degree zero is @xmath74 , as we exclude self - loops .",
    "therefore the probability that there is at least one node with in - degree zero is given by @xmath75 fig [ fig4 ] .",
    "displays 500 directed random graphs for bd and db updating . for db",
    "there are no amplifiers , but almost only suppressors , exactly as in the undirected case . for bd",
    ", we still find some amplifiers , but also many suppressors of selection , in contrast to the undirected case .",
    "in such a graph . we visualize them in orange to distinguish them from the other suppressors .",
    "multi - rooted graphs , given in grey , have a fixation probability of zero .",
    "the seven ",
    "unclassified \" graphs we found for db updating of size @xmath52 are the same as the undirected cycle , in this case given by eight directed links instead of four undirected links . as shown above , the cycle is neither an amplifier nor a suppressor of selection . ]",
    "we have shown that small random graphs are mostly either amplifiers or suppressors of selection , depending on the microscopic evolutionary process at stake .",
    "it is interesting that very few structures fall outside this classification , with the cycle under db updating as a simple example .",
    "naively , one would expect many more possibilities beyond amplifiers or suppressors of selection . however , our numerical approach has the potential shortcoming that we can not entirely exclude that such cases are misclassified , as we focus on a relatively small number of values for @xmath1 to classify the graphs .",
    "for example , the fixation probability could in principle have different asymptotics for large @xmath1 and it could intersect with the well - mixed case @xcite",
    ". however , the same shortcoming would exist if we instead perform stochastic simulations .    both computational approaches to address the problem",
    "have very different characteristics .",
    "the numerical approach is based on the analysis of very large transition matrices ( in our case of @xmath76 , we consider a matrix of @xmath77 entries ) .",
    "so increasing @xmath8 requires substantial memory and is additionally limited by the chosen numerical precision . on the other hand",
    ", it only needs a single computation for each value of @xmath1 .",
    "the simulation based approach requires only a minimum of memory and can easily be parallelized on a computer cluster . but as the fixation probabilities are typically very close to the neutral case , a huge number of averages is necessary to reliably distinguish weak amplifiers or suppressors of selection from the corresponding reference case .",
    "an analytical procedure would clearly be desirable , but previous authors had to focus on certain approximations or rely on strong assumptions such as highly symmetrical graphs  @xcite .",
    "thus , a numerical exploration of this issue , as presented here , may be helpful to assess the relative proportion of the different graph classes first and to find illustrative examples that go beyond the classes of amplifiers and suppressors .",
    "the issue of update mechanisms has been analyzed in great depth in the context of evolutionary game theory , where the individuals not only reproduce via the links but also interact through them , leading to a fitness that depends on the local neighborhood  @xcite . in this case",
    ", it is particularly interesting that the bd update can not promote cooperation , whereas the db update can  @xcite .",
    "intuitively , the reason for this is that the initial growth of a disadvantageous mutant is much more likely for db than for bd .",
    "a careful comparison based on performing each of these updates with a certain probability shows that the case of only bd updating is special , with the result resembling the pure db updating as soon as a minimum of db updating is used  @xcite . here ,",
    "we have focused entirely on the pure cases to illustrate that even in the case of constant mutant fitness , which lacks the complexities of game theoretic interactions , substantial differences in the microscopic evolutionary processes change the way an ensemble of random graphs affects the fixation of mutants .",
    "an issue that we have not discussed here is where mutants would predominantly arise  @xcite .",
    "for example , on a star graph it may be much more likely that a mutant that occurs during reproduction is placed in the central node , simply because most reproducing individuals have only this node as a neighbor .",
    "this leads to additional complications , as the classification of suppressors and amplifiers of selection immediately depends on the microscopic evolutionary process and the mode of mutation .",
    "instead of addressing this issue , @xcite , we have concentrated on the fate of a single mutant that is located on a random initial node chosen with uniform probability .",
    "we have focused entirely on relatively small graphs , whereas most previous studies looked at much larger population sizes .",
    "concentrating on these small graphs allows to establish clear classifications and a detailed understanding of particular cases such as the cycle .",
    "we expect that our results can be extended to much larger graphs and to different classes of graphs , but this will require substantial numerical efforts and possible novel simulation approaches .    to sum up , we have shown that it is trivial to construct weak amplifiers of selection : almost all small undirected graphs fulfill these requirements under birth - death updating .",
    "interestingly , the same ensemble of random graphs consists entirely of suppressors of selection if we switch to death - birth updating .",
    "the effect of population structure on evolution , which has by now been firmly established , remains a subtle issue .",
    "* here , we prove that a mutant on the cycle with db updating has lower fixation probability than in the well - mixed population for general @xmath8 .",
    "* we have to show that @xmath78 for @xmath79 . under db updating , the fixation probability in the well - mixed population is given by @xmath80 on the cycle , the respective fixation probability is given by ( eq .  ( 5.3 ) in @xcite ) @xmath81 then the difference is given by @xmath82 this expression can be written in the form of @xmath83 as eq .",
    "contains only positive coefficients in @xmath1 , the difference is always positive for @xmath84 and @xmath85 . for @xmath71 ,",
    "it is zero .",
    "thus eq .",
    "( 15 ) is fulfilled for all @xmath67 , @xmath85 .",
    "we thank kamran kaveh , benedikt bauer , bin wu , and jorge pea for helpful discussions ."
  ],
  "abstract_text": [
    "<S> we analyze evolutionary dynamics on graphs , where the nodes represent individuals of a population . </S>",
    "<S> the links of a node describe which other individuals can be displaced by the offspring of the individual on that node . </S>",
    "<S> amplifiers of selection are graphs for which the fixation probability is increased for advantageous mutants and decreased for disadvantageous mutants . a few examples of such amplifiers have been developed , but so far it is unclear how many such structures exist and how to construct them . here , we show that almost any undirected random graph is an amplifier of selection for birth - death updating , where an individual is selected to reproduce with probability proportional to its fitness and one of its neighbors is replaced by that offspring at random . </S>",
    "<S> if we instead focus on death - birth updating , in which a random individual is removed and its neighbors compete for the empty spot , then the same ensemble of graphs consists of almost only suppressors of selection for which the fixation probability is decreased for advantageous mutants and increased for disadvantageous mutants . </S>",
    "<S> thus , the impact of population structure on evolutionary dynamics is a subtle issue that will depend on seemingly minor details of the underlying evolutionary process . </S>"
  ]
}