{
  "article_text": [
    "quantum key distribution ( qkd ) has attracted great attention as an unconditionally secure key distribution scheme .",
    "the fundamental feature of qkd protocols is that the amount of information gained by an eavesdropper , usually referred to as eve , can be estimated from the channel between the legitimate sender and the receiver , usually referred to as alice and bob respectively .",
    "such a task can not be conducted in classical key distribution schemes .",
    "if the estimated amount is lower than a threshold , then alice and bob determine the length of a secret key from the estimated amount of eve s information , and can share a secret key by performing the information reconciliation ( error correction ) @xcite and the privacy amplification @xcite . since the key rate , which is the length of securely sharable key per channel use , is one of the most important criteria for the efficiency of qkd protocols ,",
    "the estimation of the channel is of primary importance .    in this paper",
    ", we only treat the bb84 protocol @xcite and the six - state protocol @xcite , and we mean the bb84 protocol and the six - state protocol by the qkd protocols throughout the paper .",
    "furthermore , a classical processing consists of a procedure to determine a key rate from a channel estimate and a procedure for the information reconciliation and the privacy amplification .",
    "mathematically , quantum channels are described by trace preserving completely positive ( tpcp ) maps @xcite .",
    "conventionally in the qkd protocols , we only use the statistics of matched measurement outcomes , which are transmitted and received by the same basis , to estimate the tpcp map describing the quantum channel ; mismatched measurement outcomes , which are transmitted and received by different bases , are discarded in the conventionally used channel estimation methods . by using the statistics of mismatched measurement outcomes in addition to that of matched measurement outcomes , we can estimate the tpcp map more accurately than the conventional estimation method .",
    "such an accurate channel estimation method is also known as the quantum tomography @xcite . in early 90s ,",
    "barnett et al .",
    "@xcite showed that the use of mismatched measurement outcomes enables alice and bob to detect the presence of eve with higher probability for the so - called intercept and resend attack .",
    "furthermore , some literatures use the accurate estimation method to ensure the channel to be a pauli channel @xcite , where a pauli channel is a channel over which four kinds of pauli errors ( including the identity ) occur probabilistically .",
    "however the channel is not necessarily a pauli channel .",
    "the use of the accurate channel estimation method in a classical processing has a potential to improve the key rates of previously known classical processing .",
    "however , there is no proposed practically implementable classical processing that fully utilizes the accurate estimation method .",
    "recently , renner et al .",
    "@xcite developed information theoretical techniques to prove the security of the qkd protocols .",
    "their proof techniques can be used to prove the security of the qkd protocols with a classical processing that fully utilizes the accurate estimation method .",
    "however they only considered pauli channels or partial twirled channels . for pauli channels , the accurate estimation method and the conventional estimation method",
    "make no difference .    in this paper",
    ", we construct a practically implementable classical processing that fully utilizes the accurate channel estimation method .",
    "more precisely , we present a procedure to determine a key rate based on the accurate channel estimate for the bb84 protocol and the six - state protocol respectively . then we also present a practically implementable procedure for the information reconciliation and the privacy amplification in which we can share a secret key at the determined key rate .",
    "note that we only change the classical processing of the qkd protocols , and the method of the transmission and reception of quantum systems in the qkd protocols remain unchanged .",
    "although it is straight forward to determine a key rate from the accurate channel estimate for the six - state protocol , it is subtle how to determine a key rate from the accurate channel estimate for the bb84 protocol .",
    "more specifically , we can obtain only partial parameters describing the channel , and there remain some free parameters .",
    "thus we have to consider the worst case , i.e. , the key rate that is minimized over the free parameters .",
    "we shall show an explicit procedure to determine the minimized key rate .    our proposed processing yields at least as high key rate as the standard processing by shor and preskill @xcite . as examples ,",
    "we show that the key rate of our proposed classical processing is strictly higher than that of the standard processing for the amplitude damping channel and the rotation channel , which are unitary channel that rotate the bloch sphere in the @xmath0-@xmath1 plane .",
    "in the example of the amplitude damping channel , we show that the key rate of the so - called reverse reconciliation , in which the key is generated based on bob s bit sequence , is higher than the key rate of the direct reconciliation , in which the key is generated based on alice s bit sequence .",
    "in the example of the rotation channel , we solve a problem left open in ( * ? ? ?",
    "* section 5)the problem whether it is possible to obtain positive key rates from both matched measurement outcomes and mismatched measurement outcomes for the bb84 protocol .",
    "it is believed that we can not share any secret key if the so - called error rate is higher than the @xmath2% limit in the bb84 protocol @xcite .",
    "however curty et al .",
    "@xcite suggested that , for some asymmetric error patterns , it might be possible to share a secret key even for the error rates above the @xmath2% limit . in the example of the rotation channel ,",
    "we show that we can actually obtain a positive key rate even though the error rate is higher than the @xmath2% limit .",
    "devetak and winter @xcite also showed the key rate formula that coincide with the key rate formula shown by renner et al .",
    "@xcite if we know the channel exactly . by combining our proposed procedure to determine a key rate based on the accurate channel estimate and devetak and winter s procedure for the information reconciliation and the privacy amplification ,",
    "we can obtain the same key rate as in this paper .",
    "however the procedure for the information reconciliation and the privacy amplification shown by devetak and winter is not practically implementable .",
    "our proposed information reconciliation can be implemented by any efficiently decodeable linear code for the slepian - wolf coding @xcite .",
    "for example , we can use the low density parity check matrix ( ldpc ) code @xcite .",
    "the rest of this paper is organized as follows : we first present a procedure for the information reconciliation and the privacy amplification in section [ section - protocol ] .",
    "then we present a procedure to determine a key rate from the estimate of the channel in section [ section - analysis - of - key - rate ] .",
    "we consider the amplitude damping channel , the unital channel , and the rotation channel as examples , and show that the key rate of our proposed processing is higher than the standard processing in section [ section - example ] .",
    "we state the conclusion in section [ section - conclusion ] .    in this paper",
    ", we mainly consider standard procedures for the information reconciliation and the privacy amplification with one - way classical communication , i.e. , we do not treat , except in remarks [ remark - degradable ] and [ remark - degraded ] , the noisy preprocessing @xcite nor a procedure with two - way classical communication @xcite .",
    "however , our results in this paper can be easily extended to procedures with the noisy preprocessing and two - way classical communication ( see remark [ remark - extention ] ) .",
    "we construct practical procedure for the information reconciliation and the privacy amplification in this section .",
    "we first describe our proposed procedure with general linear codes and the maximum a posteriori probability ( map ) decoding .",
    "then as an example of efficiently decodeable linear code , we show how to apply the sum - product algorithm of the low density parity check matrix ( ldpc ) code to our proposed procedure in remark [ remark - ldpc ] .    for the simplicity",
    "we assume that eve s attack is the collective attack , i.e. , the channel connecting alice and bob is given by tensor products of a channel @xmath3 from a qubit density matrix to itself . as is usual in qkd literatures",
    ", we assume that eve can access all the environment of channel @xmath3 ; the channel to the environment is denoted by @xmath4 .    in the six - state protocol , alice randomly sends bit @xmath5 or @xmath6 to bob by modulating it into a transmission basis that is randomly chosen from the @xmath0-basis @xmath7 , the @xmath1-basis @xmath8 , or the @xmath9-basis @xmath10 , where @xmath11 are eigenstates of the pauli matrix @xmath12 for @xmath13 respectively .",
    "then bob randomly chooses one of measurement observables",
    "@xmath14 , @xmath15 , and @xmath16 , and converts a measurement result @xmath17 or @xmath18 into a bit @xmath5 or @xmath6 respectively . after a sufficient number of transmissions , alice and bob publicly announce their transmission bases and measurement observables .",
    "they also announce a part of their bit sequences for estimating channel @xmath3 .",
    "note that alice and bob do not discard mismatched measurement outcomes , which are transmitted and received by different bases , to estimate the channel accurately .    in the bb84 protocol",
    ", alice only uses @xmath0-basis and @xmath1-basis to transmit the bit sequence , and bob only uses observable @xmath16 and @xmath14 to receive the bit sequence .",
    "henceforth , we only treat alice s bit sequence @xmath19 that is transmitted in @xmath0-basis and corresponding bob s bit sequence @xmath20 that is received in @xmath16-measurement , where @xmath21 is the finite field of order @xmath22 .",
    "furthermore , we occasionally omit the subscripts @xmath23 of bases , and the basis @xmath24 is regarded as @xmath0-basis unless otherwise stated .",
    "since the pair of sequences @xmath25 is transmitted and received in @xmath0-basis , they are independently identically distributed according to @xmath26 note that the distribution @xmath27 can be estimated from the statistics of the sample bits that are transmitted by @xmath0-basis and received by @xmath16-observable .    before describing our proposed procedure , we should review the basic facts of linear codes .",
    "an @xmath28 $ ] classical linear code @xmath29 is an @xmath30-dimensional linear subspace of @xmath31 , and its parity check matrix @xmath32 is an @xmath33 matrix of rank @xmath34 with @xmath35 entries such that @xmath36 for any codeword @xmath37 . by using these preparations ,",
    "our proposed procedure is described as follows .    1 .   [ step1 ]",
    "alice calculates syndrome @xmath38 , and sends it to bob over the public channel .",
    "[ step2 ] bob decodes @xmath39 into estimate @xmath40 of @xmath41 by using the maximum a posteriori probability ( map ) decoding .",
    "more precisely , bob selects @xmath42 such that @xmath43 and a posteriori probability @xmath44 is maximized ( if there exist tied sequences , then he selects the smallest one with respect to the lexicographic order ) , where @xmath45 is the @xmath46th product distribution of @xmath47 .",
    "[ step3 ] alice randomly choose a hash function @xmath48 from a set of universal hash functions @xcite , and sends the choice to bob over the public channel .",
    "then alice and bob s final keys are @xmath49 and @xmath50 respectively .",
    "if we set the rate of syndrome as @xmath51 then there exists a linear code in the ldpc codes such that bob s decoding error probability is arbitrary small for sufficiently large @xmath46 ( * ? ? ?",
    "* theorem 2 ) , where @xmath52 is the conditional entropy with respect to the joint probability distribution @xmath27 @xcite .",
    "note that the base of a logarithm and a ( conditional ) entropy are @xmath22 throughout the paper .",
    "the key rate , @xmath53 , is determined according to the results of privacy amplification ( * ? ? ?",
    "* corollary 3.3.7 and lemma 6.4.1 ) .",
    "let @xmath54 be the conditional von neumann entropy with respect to density matrix @xmath55 , where @xmath56 is the von neumann entropy for a density matrix @xmath57 .",
    "if the key rate satisfies @xmath58 then the final key @xmath59 is secure in the sense of the trace distance is defined by @xmath60 .",
    "then the trace distance between two matrices @xmath61 and @xmath62 is defined by @xmath63 . ] .",
    "more precisely , the density matrix , @xmath64 , which describes alice s final key @xmath59 , the publicly transmitted syndrome @xmath65 and hash function @xmath66 , and the state in eve s system @xmath67 , satisfies @xmath68 for arbitrary small @xmath69 and sufficiently large @xmath46 , where @xmath70 is the density matrix that describes the uniformly distributed key on @xmath71 . from eqs .",
    "( [ rate - of - syndrome ] ) and ( [ eq - key - rate ] ) , we find that @xmath72 is a secure key rate .",
    "note that the conditional von neumann entropy @xmath73 can be calculated from the channel @xmath3 as follows .",
    "since system @xmath74 is classical , we can rewrite @xmath75 . noting that @xmath76 and @xmath77 for the maximally entangled state @xmath78 , eve s ambiguity for alice s bit , @xmath79 ,",
    "can be calculated from the channel @xmath3 . how to determine eve s ambiguity @xmath73 from a estimate of the channel @xmath3 is discussed in the next section .",
    "[ remark - asymmetric ] if we use the conventionally used method @xcite for decoding @xmath40 , the rate of syndrome @xmath80 can not be as small as the right hand side of eq .",
    "( [ rate - of - syndrome ] ) .",
    "thus , the key rate in eq .",
    "( [ eq - secure - key - rate ] ) can not be achieved .",
    "define a probability distribution on @xmath21 as @xmath81 then the error @xmath82 between alice and bob s sequence is distributed according to @xmath83 . in the conventional method , bob calculates the difference of syndromes , @xmath84 , and selects the error @xmath85 such that @xmath86 and the likelihood of the error @xmath87 is maximized .",
    "then , the estimate for alice s sequence is @xmath88 .",
    "the rate of syndrome have to be larger than @xmath89 for the decoding error probability to be small . by the log - sum inequality @xcite and eq .",
    "( [ eq - pw ] ) , we have @xmath90 thus , the key rate in eq .  ( [ eq - secure - key - rate ] )",
    "can not be achieved by the conventional decoding method unless @xmath91 equals @xmath92 for any @xmath93 .",
    "by switching the role of alice and bob , we obtain a classical processing that achieves the key rate @xmath94 such a procedure is usually called the reverse reconciliation . on the other hand the original procedure",
    "is usually called the direct reconciliation .",
    "the reverse reconciliation was originally proposed by maurer in the classical key agreement context @xcite .",
    "note that we can calculate the conditional von neumann entropy @xmath95 from the channel @xmath3 as follows .",
    "let @xmath96 be a purification of @xmath97 , and let @xmath98 $ ] .",
    "then , the density matrix @xmath99 is derived by measurement on bob s system , i.e. , @xmath100    in section [ example1 ] , we shall show that the key rate of the reverse reconciliation can be higher than that of the direct reconciliation .",
    "the fact that the key rate of the direct reconciliation and the reverse reconciliation are different is already pointed out for qkd protocols with weak coherent states @xcite .",
    "we used the map decoding instead of the maximum likelihood ( ml ) decoding in our procedure , because the map decoding minimizes the decoding error probability , and the map decoding is different from the ml decoding for the reverse reconciliation . in the ml decoding for the reverse reconciliation",
    ", alice selects @xmath101 such that @xmath102 equals the syndrome @xmath103 , and that the likelihood @xmath104 is maximized .",
    "since the prior probability of bob s sequence @xmath105 is not necessarily the uniform distribution , the ml decoding and the map decoding are not necessarily equivalent , i.e. , @xmath106 does not hold in general .",
    "[ remark - unmatched ] by modifying our proposed procedure as follows , we obtain a procedure in which alice and bob can share a secret key from alice s sequence @xmath41 that is transmitted by @xmath0-basis and corresponding bob s sequence @xmath105 that is received by @xmath14-measurement .",
    "since @xmath25 are independently identically distributed according to @xmath107 we replace @xmath45 in step ( [ step2 ] ) with @xmath108 . by a similar arguments as in the original procedure",
    ", the secure key rate of the modified procedure is given by @xmath109    in section [ example2 ] , we shall show an example in which alice and bob can share secret keys both from matched measurement outcomes and mismatched measurement outcomes , i.e. , both eqs .",
    "( [ eq - secure - key - rate ] ) and ( [ key - rate - lower - reverse ] ) are positive .",
    "[ remark - ldpc ] the sum product algorithm can be used in step ( [ step2 ] ) of our proposed procedure as follows . for",
    "a given sequence @xmath20 , and a syndrome @xmath110 , define a function @xmath111,\\end{aligned}\\ ] ] where @xmath112 for the parity check matrix @xmath32 , and @xmath113 $ ] is the indicator function .",
    "the function @xmath114 is the non - normalized a posteriori probability distribution on @xmath31 given @xmath105 and @xmath115 .",
    "the sum - product algorithm is a method to ( approximately ) calculate the marginal a posteriori probability , i.e. , @xmath116 the definition of a posteriori probability in eq .",
    "( [ eq - sum - product ] ) is the only difference between the decoding for the slepian - wolf source coding and that for the channel coding .",
    "more precisely , we replace ( * ? ? ?",
    "* eq .  ( 47.6 ) ) with eq .",
    "( [ eq - sum - product ] ) , and use the algorithm in ( * ? ? ? * section 47.3 ) .",
    "the above procedure is a generalization of @xcite , and a special case of @xcite .    in qkd protocols we should minimize the block error probability rather than the bit error probability , because a bit error might propagate to other bits after the privacy amplification . although the sum - product algorithm is designed to minimize the bit error probability , it is known by computer simulations that the algorithm makes the block error probability small @xcite",
    "in this section we show procedures to estimate eve s ambiguity @xmath79 for the six - state protocol and the bb84 protocol .",
    "we first present general preliminaries in section [ preliminaries ] .",
    "then we show procedures for the six - state protocol and the bb84 protocol in sections [ six - state ] and [ bb84 ] respectively . in section",
    "[ subsection - relation - to - partial - twirled - channel ] , we clarify the relation between our proposed procedures for estimating @xmath79 and the conventional ones .",
    "although we explain the procedures to estimate @xmath79 for the direct reconciliation , the estimation of @xmath117 for the reverse reconciliation can be done in a similar manner .       in the stokes parameterization",
    ", the qubit channel @xmath3 can be described by the affine map parameterized by @xmath118 real parameters @xcite : @xmath119   \\mapsto \\left [ \\begin{array}{ccc } r_{{\\mathsf{zz } } } & r_{{\\mathsf{zx } } } & r_{{\\mathsf{zy } } } \\\\ r_{{\\mathsf{xz } } } & r_{{\\mathsf{xx } } } & r_{{\\mathsf{xy } } } \\\\ r_{{\\mathsf{yz } } } & r_{{\\mathsf{yx } } } & r_{{\\mathsf{yy } } } \\end{array } \\right ] \\left [ \\begin{array}{c } \\theta_{{\\mathsf{z } } } \\\\ \\theta_{{\\mathsf{x } } } \\\\ \\theta_{{\\mathsf{y } } } \\end{array } \\right ] + \\left [ \\begin{array}{c } t_{{\\mathsf{z } } } \\\\ t_{{\\mathsf{x } } } \\\\ t_{{\\mathsf{y } } }   \\end{array } \\right ] , \\label{eq - affine - map}\\end{aligned}\\ ] ] where @xmath120 describes a vector in the bloch sphere @xcite . for the channel @xmath3 and each pair of bases @xmath121 ,",
    "define the biases of the outputs as @xmath122 then , a straight forward calculation shows the relations @xmath123     the qubit channel @xmath3 can be also described by the choi matrix @xmath124 @xcite for the maximally entangled state @xmath125 . by using the parameters in eq .",
    "( [ eq - affine - map ] ) , we can write the choi matrix @xmath126 as    @xmath127,\\end{aligned}\\ ] ]     where @xmath128 is the imaginary unit .      an ad - hoc approach to estimate eve s ambiguity in the six - state protocol is very simple , because all parameters can be estimated from the statistics of sampled bits @xcite .    1 .   [ estimate - six - state - step1 ] by using the statistics of sampled bits and the relation in eq .",
    "( [ eq - relation - between - bias - parameter ] ) , alice and bob calculate the estimate @xmath129 for the parameters of the channel @xmath3 .",
    "2 .   [ estimate - six - state - step2 ] by using eq .",
    "( [ eq - choi - matrix ] ) , alice and bob calculate the corresponding matrix @xmath130 .",
    "if the resulting matrix @xmath130 is not a choi matrix , alice and bob select a choi matrix @xmath131 such that the frobenius norm between @xmath131 and @xmath130 is minimized . ] .",
    "[ estimate - six - state - step3 ] alice and bob calculate an estimator @xmath132 for eve s ambiguity @xmath73 .",
    "the validity of this estimation procedure is shown as follows .",
    "since the estimators in step ( [ estimate - six - state - step1 ] ) converge to the true parameters in probability as the number of sampled bits goes to the infinity , the matrix @xmath130 also converges to @xmath126 .",
    "then the choi matrix @xmath131 also converges to the @xmath126 .",
    "since the conditional entropy is a continuous function , the estimator @xmath132 in step ( [ estimate - six - state - step3 ] ) also converges to @xmath73 in probability as the number of sampled bits goes to the infinity .",
    "the estimation of @xmath79 in the bb84 protocol is much more complicated .",
    "when alice and bob only use @xmath0-basis and @xmath1-basis , the statistics of the input and the output are irrelevant to the parameters @xmath133 .",
    "thus , we can only estimate the parameters @xmath134 , and we have to consider the worst case for the parameters @xmath135 , i.e. , @xmath136 where @xmath137 is the set of all parameters @xmath138 such that the parameters @xmath135 and @xmath139 constitute a qubit channel , and @xmath140 is the choi matrix corresponding to the parameter @xmath139 .    by using the following proposition , which is proved in appendix [ appendix - a ] , we can make the desired function @xmath141 into a simpler form .",
    "[ proposition - non - imaginary ] the minimization in eq .",
    "( [ eq - minimization-1 ] ) is achieved when the parameters , @xmath142 , @xmath143 , @xmath144 , @xmath145 , and @xmath146 , are @xmath5 .",
    "the number of free parameters has been reduced to @xmath6 by proposition [ proposition - non - imaginary ] .",
    "thus the problem is rewritten as looking for an estimator of @xmath147 where @xmath148 is the set of parameters @xmath149 such that the parameters @xmath135 and @xmath149 constitute a qubit channel when other parameters are all @xmath5 , and @xmath150 is the choi matrix corresponding to the parameter @xmath151 .",
    "since the range @xmath148 of the remaining free parameter @xmath149 is a closed interval and @xmath79 is a convex function ( see lemma [ proposition - convexity ] ) , the minimization in @xmath141 is achieved at the boundary point of the range of @xmath149 or at the zero point of the derivative of @xmath79 with respect to @xmath149 .    an ad - hoc approach to find an estimator is as follows .    1 .    by using the statistics of sampled bits and the relation in eq .",
    "( [ eq - relation - between - bias - parameter ] ) , alice and bob calculate the estimate @xmath152 for the parameters @xmath135 .",
    "if @xmath153 is the empty set , then alice and bob find the point @xmath154 such that @xmath154 is closest ( in euclidean distance ) to @xmath152 and @xmath155 is not an empty sets such that @xmath156 is not empty is a closed convex set . for more detail , see appendix [ appendix - convex - opt ] . ] .",
    "alice and bob calculate an estimator @xmath157 for eve s ( worst - case ) ambiguity @xmath141 .",
    "the validity of this estimation procedure can be shown as follows .",
    "the estimator @xmath152 converges to the true value @xmath135 in probability .",
    "the estimator @xmath154 also converges to @xmath135 , because @xmath158 , which implies @xmath159 by the triangle inequality .",
    "thus the following lemma , which is proved in appendix [ appendix - b ] , guarantees that the estimator @xmath157 converges to the desired quantity @xmath141 in probability as the number of sampled bits goes to the infinity .",
    "[ lemma - continuity ] the function @xmath141 is a continuous function of @xmath135 .     although we showed a procedure to exactly estimate eve s worst case ambiguity so far",
    ", it is worthwhile to show a closed form lower bound on eve s worst case ambiguity , which will be proved in appendix [ appendix - d ] .",
    "[ remark - unital ] let @xmath160 and @xmath161 be the singular values of the matrix @xmath162.\\end{aligned}\\ ] ] then , we have @xmath163 where @xmath164 is the binary entropy function .",
    "the equality holds if @xmath165 .",
    "[ remark - after - unital ] for the reverse reconciliation , the worst case of eve s ambiguity @xmath117 is lower bounded by the right hand side of eq .",
    "( [ eq - unital - bound ] ) in which @xmath166 is replaced by @xmath167 .     the right hand side of eq .",
    "( [ eq - unital - bound ] ) is further lower bounded by @xmath168 .",
    "since @xmath169 equals to the so - called phase error rate @xmath170 ( see eq .",
    "( [ eq - phase - error ] ) ) , the right hand side of eq .",
    "( [ eq - unital - bound ] ) is a lower bound on eve s worst case ambiguity that is tighter than the well known bound @xmath171 @xcite .",
    "we described estimation methods for eve s ambiguity @xmath73 based on the channel estimation method so - called linear inversion @xcite in section [ six - state ] and in this section .",
    "it is well - known that the maximum likelihood ( ml ) channel estimator has smaller estimation error than the linear inversion @xcite .",
    "an algorithm for ml channel estimation has been proposed @xcite , however , its convergence as a numerical algorithm has not been proved .",
    "the absence of a convergence proof prevents us from using that algorithm in the qkd protocols that require a rigorous proof of the convergence of an estimator .",
    "the computation of the ml channel estimate in the six - state protocol is a convex optimization problem . because the set of choi matrices is a closed convex set defined by equality constraints and generalized inequality constraints @xcite and the log - likelihood function is a concave function of choi matrices for given measurement outcomes .",
    "therefore , the interior point method @xcite , for example , can compute the ml estimate with convergence guarantee . for the bb84 protocol",
    ", the domain of log - likelihood function is narrowed to real choi matrices by proposition [ proposition - non - imaginary ] that is also a closed convex set , and the parameter @xmath149 remains undetermined as well as the linear inversion because the log - likelihood function is independent of @xmath149 .",
    "the rest of parameters can be computed by a convex optimization algorithm .",
    "if we are allowed to use enough computation time for sophisticated channel estimation procedures , then it may be better to use the ml channel estimation .      in this section",
    ", we show the relation between eve s ambiguity @xmath79 that is estimated by our proposed procedures and that estimated by the conventional procedures .     in the conventional procedure to estimate @xmath79 in the six - state protocol @xcite",
    ", we first estimate the so called the error rate for each basis : @xmath172 then , we calculate the worst case of eve s ambiguity @xmath173 in which the minimization is taken over the set of all channels that are compatible with the estimates of the error rates @xmath174 . since we estimate the actual channel instead of the worst case , eve s ambiguity estimated by our procedure is at least as large as that estimated by the conventional one .",
    "in the conventional procedure to estimate @xmath73 in the bb84 protocol , we first estimate @xmath175 and @xmath170 .",
    "then we calculate the worst case of eve s ambiguity @xmath173 in which the minimization is taken over the set of all channels that are compatible with the estimates of the error rates @xmath176 .",
    "the minimum is given by the well known value @xmath171 @xcite .",
    "since the error rates @xmath176 are degraded version of the parameters @xmath135 , the range of minimization in the conventional procedure is larger than @xmath148 in our proposed procedure .",
    "thus , eve s worst case ambiguity estimated by our proposed procedure is at least as large as that estimated by the conventional one .     for both the six - state protocol and the bb84 protocol , a sufficient condition such that eve s worst case ambiguity estimated by our proposed procedure and that estimated by the conventional one coincide is that the channel @xmath3 is a pauli channel .",
    "however , it is not clear whether the condition is also a necessary condition or not .    combining the arguments in this section and remark [ remark - asymmetric ]",
    ", we find that our proposed classical processing yields at least as high key rate as the standard processing by shor and preskill @xcite for the qkd protocols .",
    "in this section , we calculate the key rates of the bb84 protocol and the six - state protocol with our proposed classical processing for the amplitude damping channel , the unital channel , and the rotation channel , and clarify that the key rate of our proposed classical processing is higher than previously known ones .       in the stokes parameterization , the amplitude damping channel @xmath177",
    "is given by the afine map @xmath178",
    "\\mapsto \\left [ \\begin{array}{ccc } 1 - p & 0 & 0 \\\\ 0 & \\sqrt{1-p } & 0 \\\\ 0 & 0 & \\sqrt{1-p } \\end{array } \\right ] \\left [ \\begin{array}{c } \\theta_{\\mathsf{z } } \\\\ \\theta_{\\mathsf{x } } \\\\ \\theta_{\\mathsf{y } } \\end{array } \\right ] +    \\left [ \\begin{array}{c } p \\\\ 0 \\\\ 0 \\end{array } \\right ] \\label{eq - amplitude - damping}\\end{aligned}\\ ] ] parameterized by a real parameter @xmath179 .",
    "we first calculate the key rate for the bb84 protocol . in the bb84 protocol",
    ", we can estimate the parameters @xmath180 , @xmath181 , @xmath182 , @xmath183 , @xmath184 , @xmath185 . by the proposition [ proposition - non - imaginary ]",
    ", we can set @xmath186 .",
    "furthermore , by the condition on the tpcp map @xcite @xmath187 we can decide the remaining parameter as @xmath188 .",
    "thus , eve s ( worst - case ) ambiguity @xmath141 for the bb84 protocol coincide with the true value @xmath79 , which means that the bb84 protocol can achieve the same key rate as the six - state protocol .    by straightforward calculations ,",
    "the key rates of the direct reconciliation and reverse reconciliation are calculated as @xmath189 and @xmath190 respectively .",
    "these key rates are plotted in fig .",
    "[ fig - comparison ] .",
    "the bell diagonal entries of the choi matrix @xmath191 are @xmath192 , @xmath193 , @xmath194 , and @xmath193 .",
    "the key rate of the six - state protocol and the bb84 protocol with the conventional processing can be calculated only from the bell diagonal entries , and are also plotted in fig .",
    "[ fig - comparison ] .",
    "we find that the key rates of our proposed classical processing are higher than those of the conventional processing .",
    "furthermore , we find that the key rate of the reverse reconciliation is higher than that of the direct reconciliation .     of the amplitude damping channel",
    "( see eq .",
    "( [ eq - amplitude - damping ] ) ) .",
    "`` reverse '' and `` direct '' are the key rates when we use the reverse reconciliation and the direct reconciliation in our proposed classical processing respectively .",
    "`` conventional six - state '' and `` conventional bb84 '' are the key rates of the six - state protocol and the bb84 protocol with the conventional classical processing .",
    "note that the conventional classical processing involves the noisy preprocessing @xcite . ]    [ remark - degradable ] when the channel is degradable @xcite , i.e. , there exists a channel @xmath195 such that @xmath196 for any input @xmath57 , the quantum wiretap channel capacity @xcite is known to be achievable without any auxiliary random variable @xcite .",
    "for the one - way key agreement from a degradable ( from alice to bob and eve ) @xmath197-state , which is a state @xmath198 such that there exist states @xmath199 satisfying @xmath200 , a similar statement also holds , namely the key rate in eq .",
    "( [ eq - secure - key - rate ] ) can not be improved with any auxiliary random variable .",
    "the use of auxiliary random variable for the key agreement corresponds to the noisy preprocessing @xcite .",
    "the above statement is proved as follows .",
    "since we are considering the information reconciliation and the privacy amplification with one - way classical communication , key rates only depend on distribution @xmath27 and @xmath201-state @xmath202 .",
    "thus the maximum key rate for @xmath203 is equals to that for degraded version of it , @xmath204 . on the other hand the ( quantum )",
    "intrinsic information @xmath205 is an upper bound on the maximum key rate @xcite , where @xmath206 is the quantum conditional mutual information , and the infimum is taken over all @xmath197-states @xmath207 for cptp maps @xmath208 from system @xmath209 to @xmath210 .",
    "taking the identity map @xmath211 , the quantum conditional mutual information @xmath212 itself is an upper bound on the maximum key rate . applying this fact for the degraded @xmath197-state , @xmath213 ,",
    "the maximum key rate is upper bounded by @xmath214 which is the desired upper bound , and is equal to eq .",
    "( [ eq - secure - key - rate ] ) .",
    "when alice randomly sends @xmath7 over the amplitude damping channel and bob measures the received state by @xmath16 observable , the resulting @xmath197-state is degradable , which implies the key rate of direct reconciliation can not be improved by the noisy preprocessing .",
    "it is not clear whether the @xmath197-state for the amplitude damping channel is degradable in reverse order ; there exists a possibility to improve the key rate of reverse reconciliation by the noisy preprocessing .",
    "a channel @xmath3 is called a unital channel if the vector @xmath215 is the zero vector in the stokes parameterization ( see eq .",
    "( [ eq - affine - map ] ) ) , or equivalently if the channel @xmath3 maps the completely mixed state @xmath216 to itself .",
    "the unital channel has the following physical meaning in qkd protocols . when eve conducts the pauli cloning @xcite with respect to an orthonormal basis that is a rotated version of @xmath217 , @xmath218 , the quantum channel from alice to bob is not a pauli channel but a unital channel .",
    "it is natural to assume that eve can not determine the direction of the basis @xmath217 , @xmath218 accurately , and the unital channel deserve consideration in the qkd research as well as the pauli channel .    by the singular value decomposition",
    ", we can decompose the matrix @xmath219 in eq .",
    "( [ eq - affine - map ] ) as    @xmath220 o_1,\\end{aligned}\\ ] ]     where @xmath221 and @xmath222 are some rotation matrices . ] , and @xmath223 , @xmath224 , and @xmath225 are the singular value of the matrix @xmath219 or the sign of them by adjusting the rotation matrices @xmath221 and @xmath222 .",
    "however , the result in this paper does not depends on a choice of the decomposition . ] .",
    "thus , we can consider the unital channel @xmath3 as the composition of the unitary channel @xmath226 , the pauli channel @xmath227 and the unitary channel @xmath228 , where @xmath229 @xcite .",
    "for the unital channel , we have @xmath230 . for the six - state protocol",
    ", we can calculate eve s ambiguity @xmath73 as @xmath231 +   h\\left ( \\frac{1 + \\sqrt{r_{\\mathsf{zz}}^2 + r_{\\mathsf{xz}}^2 + r_{\\mathsf{yz}}^2}}{2 } \\right ) \\label{eq - unital - six - state}\\end{aligned}\\ ] ] because @xmath232 are the eigenvalues of the choi matrix @xmath126 . for the reverse reconciliation ,",
    "eve s ambiguity @xmath233 is given by eq .",
    "( [ eq - unital - six - state ] ) in which @xmath234 and @xmath235 are replaced by @xmath236 and @xmath237 respectively .",
    "thus , @xmath238 is the necessary and sufficient condition for @xmath239 . for the bb84 protocol",
    ", we can calculate eve s worst case ambiguity @xmath141 by proposition [ remark - unital ] because @xmath240 for the unital channel .",
    "note that the singular values @xmath241 in proposition [ remark - unital ] are different from the singular values @xmath242 in general because there exist off - diagonal elements @xmath243 . from remark [ remark - after - unital ]",
    ", @xmath244 is the necessary and sufficient condition for that eve s worst case ambiguity for the direct reconciliation and that for the reverse reconciliation coincide .     in the rest of this section",
    ", we analyze a special class of the unital channel , the rotation channel .",
    "we define the rotation channel from alice to bob as @xmath178 \\mapsto \\left [ \\begin{array}{ccc } \\cos \\vartheta & - \\sin \\vartheta & 0 \\\\ \\sin \\vartheta & \\cos \\vartheta & 0 \\\\ 0 & 0 & 1 \\end{array } \\right ] \\left [ \\begin{array}{c } \\theta_{\\mathsf{z } } \\\\ \\theta_{\\mathsf{x } } \\\\ \\theta_{\\mathsf{y } } \\end{array } \\right].\\end{aligned}\\ ] ] the rotation channels occur , for example , when the directions of the transmitter and the receiver are not properly aligned .    for the rotation channel , eq .",
    "( [ eq - unital - bound ] ) gives @xmath245 , which implies that eve gained no information .",
    "thus , eve s ( worst - case ) ambiguity for the bb84 protocol coincide with the true value @xmath79 , and the bb84 protocol with our proposed classical processing can achieve the same key rate as the six - state protocol .",
    "there are two reasons why we show this example  the rotation channel .",
    "the first one is that we can obtain secret keys , in the bb84 protocol , both from matched measurement outcomes , which are transmitted and received by the same basis ( say @xmath0-basis ) , and mismatched measurement outcomes , which are transmitted and received by different bases ( say @xmath0-basis and @xmath1-basis respectively ) .",
    "the probability distributions of alice and bob s bit for each case are given by @xmath246 and @xmath247 respectively ( see eqs .",
    "( [ eq - distribution - xy ] ) and ( [ eq - distribution - xy-2 ] ) for the definitions of @xmath27 and @xmath248 ) .",
    "if the channel is biased , i.e. , @xmath249 , then we can obtain secret keys with positive key rates both from matched measurement outcomes and mismatched measurement outcomes .",
    "this fact solves an open problem discussed in ( * ? ? ?",
    "* section 5 ) .",
    "the second reason is that we can obtain a secret key from matched measurement outcomes even though the so called error rate is higher than the @xmath2% limit @xcite in the bb84 protocol .",
    "the bell diagonal entries of the choi matrix @xmath250 are @xmath251 , @xmath5 , @xmath5 , and @xmath252 .",
    "thus the error rate is @xmath252 . for @xmath253 ,",
    "the error rate is higher than @xmath2% , but we can obtain the positive key rate , @xmath254 except @xmath255 . note that the key rate of the standard processing by shor and preskill @xcite is @xmath256 .",
    "this fact verifies curty et al s suggestion @xcite that key agreement might be possible even for the error rates higher than @xmath2% limits .",
    "[ remark - degraded ] if the @xmath197-state @xmath203 is degraded ( from alice to bob and eve ) , i.e. , the @xmath197-state is of the form @xmath257 , then we can prove that the key rate in eq .",
    "( [ eq - secure - key - rate ] ) can not be improved even if we use any noisy preprocessing or two - way processing .",
    "the reason is that the upper bound @xmath212 and the lower bound in eq .",
    "( [ eq - secure - key - rate ] ) coincide for the degraded @xmath197-state in a similar manner to remark [ remark - degradable ] .    for the rotation channel @xmath258 , the resulting @xmath197-state is obviously degraded .",
    "thus the key rate @xmath254 can not be improved any more .",
    "in this paper , we constructed a practically implementable classical processing for the bb84 protocol and the six - state protocol that fully utilizes the accurate channel estimation method .",
    "a consequence of our result is that we should not discard mismatched measurement outcomes in the qkd protocols ; those measurement outcomes can be used to estimate the channel accurately , and increase key rates .",
    "there is a problem that was not treated in this paper .",
    "although we only treated asymptotically secure key rate in this paper , the final goal is the non - asymptotic analysis of eavesdropper s information , i.e. , evaluate eavesdropper s information as a function of the length of the raw key , the key rate , and the length of sample bits as in literatures @xcite .",
    "this topic is a future research agenda .",
    "we would like to thank dr .",
    "jean - christian boileau , professor akio fujiwara , dr .",
    "manabu hagiwara , dr .  kentaro imafuku , professor hideki imai , professor hoi - kwong lo and members of his group , professor masahito hayashi , dr .",
    "takayuki miyadera , professor hiroshi nagaoka , professor renato renner and members of his group , mr .",
    "yutaka shikano , professor tadashi wadayama , professor stefan wolf and members of his group , and professor isao yamada for valuable discussions and comments .",
    "we also would like to appreciate the first reviewer for letting us know the reference @xcite and the second reviewer for pointing out an error in remark [ remark - asymmetric ] of the earlier version of the manuscript .",
    "this research was partly supported by the japan society for the promotion of science under grants - in - aid no .",
    "18760266 and no .",
    "in this appendix , we show a lemma that will be used in the rest of the appendices .",
    "[ proposition - convexity ] for two channels @xmath259 and @xmath260 , and a probabilistically mixed channel @xmath261 , eve s ambiguity is convex , i.e. , we have @xmath262 where @xmath263 for channel @xmath264 to all the environment of @xmath265 , and @xmath266 for channel @xmath267 to all the environment of @xmath268 and for @xmath269 .    for @xmath270 and @xmath22 ,",
    "let @xmath271 be a purification of the choi matrix @xmath272 .",
    "then the density matrix @xmath273 is derived by alice s measurement by @xmath0-basis and the partial trace over bob s system , i.e. , @xmath274.\\end{aligned}\\ ] ] let @xmath275 be a purification of @xmath276 , where @xmath277 is the reference system , and @xmath278 is an orthonormal basis of @xmath277 .",
    "let @xmath279,\\end{aligned}\\ ] ] and let @xmath280 be the density matrix such that the system @xmath277 is measured by @xmath281 basis .",
    "then we have @xmath282 where the inequality follows from the monotonicity of the quantum mutual information for measurements ( data processing inequality ) @xcite . by renaming the systems @xmath283 to @xmath209",
    ", we have the assertion of the lemma .    [ remark - extention ] by switching the role of alice and bob",
    ", we can show that the assertion in lemma [ proposition - convexity ] and thus proposition [ proposition - non - imaginary ] hold for the reverse reconciliation .",
    "furthermore , the statements also hold for the information reconciliation and the privacy amplification with @xmath284-block - wise two - way processing @xcite ( including one - way noisy preprocessing @xcite ) .",
    "more precisely , let @xmath285 be the tpcp map that represents a two - way processing .",
    "then for the density matrix @xmath286 we can obtain the inequality @xmath287 the modifications of the proof is to replace @xmath271 and @xmath288 with @xmath289 and @xmath290 in eqs .",
    "( [ eq - cq - state-1 ] ) and ( [ eq - cq - state-2 ] ) , to replace the partial trace over bob s system with bob s measurement , to append a map @xmath285 , and to replace the measurement on the system @xmath277 with the measurements on @xmath291 .",
    "the statement of the proposition [ proposition - non - imaginary ] easily follows from lemma [ proposition - convexity ] . for any channel @xmath3 ,",
    "let @xmath292 be the channel whose choi matrix is the complex conjugate of that for @xmath3 .",
    "note that eigenvalues of density matrices are unchanged by the complex conjugate , and thus eve s ambiguity @xmath293 for @xmath292 equals to @xmath73 . by applying lemma [ proposition - convexity ] for @xmath294 , @xmath295 , and @xmath296",
    ", we have @xmath297 where @xmath298 .",
    "note that @xmath299 is a real density matrix whose entries are equal to the real components of @xmath126 , which implies that the parameters @xmath142 , @xmath143 , @xmath144 , @xmath145 , and @xmath146 , are @xmath5 by eq .",
    "( [ eq - choi - matrix ] ) .",
    "since the channel @xmath3 was arbitrary , we have the assertion of the proposition .",
    "@xmath300       by proposition [ proposition - non - imaginary ] , it suffice to consider the channel @xmath3 of the form @xmath178 \\mapsto \\left [ \\begin{array}{ccc } r_{\\mathsf{z}\\mathsf{z } } & r_{\\mathsf{z}\\mathsf{x } } & 0 \\\\ r_{\\mathsf{x}\\mathsf{z } } & r_{\\mathsf{x}\\mathsf{x } } & 0 \\\\ 0 & 0 & r_{\\mathsf{y}\\mathsf{y } } \\end{array } \\right ] \\left [ \\begin{array}{c } \\theta_{\\mathsf{z } } \\\\ \\theta_{\\mathsf{x } } \\\\ \\theta_{\\mathsf{y } } \\end{array } \\right ] +    \\left [ \\begin{array}{c } t_{\\mathsf{z } } \\\\ t_{\\mathsf{x } } \\\\ 0 \\end{array } \\right].\\end{aligned}\\ ] ] define the channel @xmath323 and the mixed channel @xmath324 .",
    "since the channel @xmath325 is given by @xmath178 \\mapsto \\left [ \\begin{array}{ccc } r_{\\mathsf{z}\\mathsf{z } } & r_{\\mathsf{z}\\mathsf{x } } & 0 \\\\ r_{\\mathsf{x}\\mathsf{z } } & r_{\\mathsf{x}\\mathsf{x } } & 0 \\\\ 0 & 0 & r_{\\mathsf{y}\\mathsf{y } } \\end{array } \\right ] \\left [ \\begin{array}{c } \\theta_{\\mathsf{z } } \\\\ \\theta_{\\mathsf{x } } \\\\ \\theta_{\\mathsf{y } } \\end{array } \\right ] +    \\left [ \\begin{array}{c } - t_{\\mathsf{z } } \\\\ - t_{\\mathsf{x } } \\\\ 0 \\end{array } \\right],\\end{aligned}\\ ] ] @xmath265 is a unital channel and the matrix part of @xmath3 and @xmath265 are the same .",
    "furthermore , since @xmath73 for @xmath3 equals to @xmath326 for @xmath325 , by using lemma [ proposition - convexity ] , we have @xmath327     the rest of the proof is to calculate the minimization of @xmath328 with respect to @xmath151 . by the singular value decomposition",
    ", we can decompose the matrix @xmath329 corresponding to the channel @xmath330 as @xmath331 o_1,\\end{aligned}\\ ] ] where @xmath221 and @xmath222 are some rotation matrices within @xmath332-plane , and @xmath333 and @xmath334 are the singular value of the matrix in eq .",
    "( [ eq - matrix ] ) .",
    "then , we have @xmath335 \\\\ & = & 1 - \\max_{r_{\\mathsf{yy } } } h[q_{\\mathsf{i } } , q_{\\mathsf{z } } , q_{\\mathsf{x } } , q_{\\mathsf{y } } ]    + h\\left(\\frac{1 + \\sqrt{r_{\\mathsf{zz}}^2 + r_{\\mathsf{xz}}^2}}{2 } \\right ) \\\\ & = & 1 - h(q_{\\mathsf{i } } + q_{\\mathsf{z } } ) - h(q_{\\mathsf{i } } + q_{\\mathsf{x } } )    + h\\left(\\frac{1 + \\sqrt{r_{\\mathsf{zz}}^2 + r_{\\mathsf{xz}}^2}}{2 } \\right),\\end{aligned}\\ ] ] where @xmath232 are the eigenvalues of the choi matrix @xmath336 . by noting that @xmath337 and @xmath338 ( see section [ example2 ] )",
    ", we have assertion of the proposition . @xmath300",
    "since the conditional entropy is a continuous function , the following statement is suffice for proving that @xmath141 is continuous function at any @xmath301 , where @xmath302 is the set of all @xmath135 such that @xmath148 is not empty . for any @xmath303 such that",
    "@xmath304 , there exist @xmath305 such that @xmath306 and @xmath307 and @xmath308 converge to @xmath5 as @xmath69 goes to @xmath5 , where @xmath309 is the @xmath307-neighbor of the set @xmath310 .",
    "define the set @xmath311 , which is a closed convex set .",
    "define functions @xmath312 as the upper surface and the lower surface of the set @xmath313 respectively .",
    "then @xmath314 and @xmath315 are concave and convex functions respectively , because @xmath313 is a convex set .",
    "thus @xmath314 and @xmath315 are continuous functions except the extreme points of @xmath302 . for any extreme point @xmath316 and for any interior point @xmath135",
    ", we have @xmath317 and @xmath318 , because @xmath313 is a convex set . since @xmath313 is a closed set",
    ", we have @xmath319 and @xmath320 , which implies that @xmath321 and @xmath322 .",
    "thus @xmath314 and @xmath315 are also continuous at the extreme points .",
    "since @xmath148 is a convex set , the continuity of @xmath314 and @xmath315 implies that eqs .",
    "( [ eq - neighbor-1 ] ) and ( [ eq - neighbor-2 ] ) hold for some @xmath305 , and @xmath307 and @xmath308 converge to @xmath5 as @xmath69 goes to @xmath5",
    "in this appendix , we briefly explain how to apply a convex optimization method , the interior - point method , to the channel estimation in the bb84 protocol . in a similar manner",
    ", we can apply the interior - point method to the channel estimation in the six - state protocol . for more detail , see the textbook ( * ? ? ? * section 11.6 ) .",
    "first , we define a generalized inequality . since the set @xmath339 of ( real ) semi - definite matrices is a proper cone ( see ( * ? ? ?",
    "* section 2.4.1 ) for the definition of the proper cone ) , we can define a generalized inequality @xmath340 as @xmath341    for a given parameter @xmath342 , we define the real matrix @xmath343 by using the relation in eq .",
    "( [ eq - choi - matrix ] ) , where we set other parameters @xmath344 to be all @xmath5 .",
    "then , the function @xmath345 is a @xmath346-concave function ( see ( * ? ? ?",
    "* section 3.6.2 ) for the definition of the @xmath346-concave function ) .",
    "we can formulate our optimization problem as follows : @xmath347 = i , \\end{array}\\end{aligned}\\ ] ] where @xmath348 is the square euclidean norm , which is a convex function , and @xmath349 is the @xmath350 identity matrix .",
    "this optimization problem can be solved by the interior - point method .",
    "note that we can use @xmath351 as a logarithmic barrier function ( see ( * ? ? ?",
    "* example 11.7 ) ) ."
  ],
  "abstract_text": [
    "<S> we construct a practically implementable classical processing for the bb84 protocol and the six - state protocol that fully utilizes the accurate channel estimation method , which is also known as the quantum tomography . our proposed processing yields at least as high key rate as the standard processing by shor and preskill . </S>",
    "<S> we show two examples of quantum channels over which the key rate of our proposed processing is strictly higher than the standard processing . in the second example </S>",
    "<S> , the bb84 protocol with our proposed processing yields a positive key rate even though the so - called error rate is higher than the 25% limit . </S>"
  ]
}