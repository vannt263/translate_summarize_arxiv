{
  "article_text": [
    "the boundary harnack inequality ( bhi ) is a statement about nonnegative functions which are harmonic on an open set and vanish outside the set near a part of its boundary .",
    "bhi asserts that the functions have a common boundary decay rate .",
    "the property requires proper assumptions on the set and the underlying markov process , ones which secure relatively good communication from near the boundary to the center of the set . by this",
    "we mean that the process starting near the boundary visits the center of the set at least as likely as creep far along the boundary before leaving the set .",
    "bhi for harmonic functions of the laplacian @xmath0 in lipschitz domains was proved in 197778 by b. dahlberg , a. ancona and j .- m .",
    "wu ( @xcite ) , after a pioneering attempt of j.  kemper ( @xcite ) . in 1989",
    "r.  bass and k.  burdzy proposed an alternative probabilistic proof based on elementary properties of the brownian motion ( @xcite ) .",
    "the resulting ` box method ' was then applied to more general domains , including hlder domains of order @xmath1 , and to more general second order elliptic operators ( @xcite ) .",
    "bhi trivially fails for disconnected sets , and counterexamples for hlder domains with @xmath2 are given in @xcite . in 200109 , h.  aikawa studied bhi for classical harmonic functions in connection to the carleson estimate and under exterior capacity conditions ( @xcite ) .",
    "moving on to nonlocal operators and jump - type markov processes , in 1997 k. bogdan proved bhi for the fractional laplacian @xmath3 ( and the isotropic @xmath4-stable lvy process ) for @xmath5 and lipschitz sets ( @xcite ) . in 1999 r.  song and j .- m .",
    "wu extended the results to the so - called fat sets ( @xcite ) , and in 2007 k.  bogdan , t.  kulczycki and m.  kwanicki proved bhi for @xmath3 in arbitrary , in particular disconnected , open sets ( @xcite ) . in 2008",
    "p.  kim , r.  song and z.  vondraek proved bhi for subordinate brownian motions in fat sets ( @xcite ) and in 2011 extended it to a general class of isotropic lvy processes and arbitrary domains ( @xcite ) .",
    "quite recently , bhi for @xmath6 was established by z .- q .",
    "chen , p.  kim , r.  song and z.  vondraek @xcite .",
    "we also like to mention bhi for censored processes @xcite by k.  bogdan , k.  burdzy , z .- q .  chen and q.  guan , and fractal jump processes @xcite by k.  kaleta , m.  kwanicki and a.  sts .    generally speaking",
    ", bhi is more a topological issue for diffusion processes , and more a measure - theoretic issue for jump - type markov processes , which may transport from near the boundary to the center of the set by direct jumps .",
    "however , @xcite show in a special setting that such jumps determine the asymptotics of harmonic functions only at those boundary points where the set is rather thin , while at other boundary points the main contribution to the asymptotics comes from gradual ` excursions ' away from the boundary .",
    "we recall that bhi in particular applies to and may yield an approximate factorization of the green function .",
    "this line of research was completed for lipschitz domains in 2000 by k.  bogdan ( @xcite ) for @xmath0 and in 2002 by t.  jakubowski ( @xcite ) for @xmath3 .",
    "it is now a well - established technique ( @xcite ) and extensions were proved , e.g. , for subordinate brownian motions by p.  kim , r.  song and z.  vondraek ( @xcite ) .",
    "we should note that so far the technique is typically restricted to lipschitz or fat sets .",
    "furthermore , for smooth sets , e.g. @xmath7 sets , the approximate factorization is usually more explicit .",
    "this is so because for smooth sets the decay rate in bhi can often be explicitly expressed in terms of the distance to the boundary of the set .",
    "the first complete results in this direction were given for @xmath0 in 1986 by z.  zhao ( @xcite ) and for @xmath3 in 1997 by t.  kulczycki ( @xcite ) and in 1998 by z .- q .",
    "chen and r.  song ( @xcite ) .",
    "the estimates are now extended to subordinate brownian motions , and the renewal function of the subordinator is used in the corresponding formulations ( @xcite ) .",
    "accordingly , the green function of smooth sets enjoys approximate factorization for rather general isotropic lvy processes ( @xcite ) .",
    "we expect further progress in this direction with applications to perturbation theory via the so - called 3 g theorems , and to nonlinear partial differential equations ( @xcite ) .",
    "we should also mention estimates and approximate factorization of the dirichlet heat kernels , which are intensively studied at present .",
    "the estimates depend on bhi ( @xcite ) , and reflect the fundamental decay rate in bhi ( @xcite ) .",
    "bhi tends to self - improve and may lead to the existence of the boundary limits of ratios of nonnegative harmonic functions , thanks to oscillation reduction ( @xcite ) .",
    "the oscillation reduction technique is rather straightforward for local operators .",
    "it is more challenging for non - local operators , as it involves subtraction of harmonic functions , which destroys global nonnegativity .",
    "the technique requires a certain scale invariance , or uniformity of bhi , and works , e.g. , for @xmath0 in lipschitz domains ( @xcite ) and for @xmath3 in arbitrary domains ( @xcite ) .",
    "we should remark that hlder continuity of harmonic functions is a similar phenomenon , related to the usual harnack inequality , and that bhi extends the usual harnack inequality if , e.g. , constant functions are harmonic .",
    "hlder continuity of harmonic functions is crucial in the theory of partial differential equations @xcite , and the existence of limits of ratios of nonnegative harmonic functions leads to the construction of the martin kernel and to representation of nonnegative harmonic functions ( @xcite ) .",
    "the above summary indicate further directions of research resulting from our development .",
    "the main goal of this article is to study the following boundary harnack inequality . in section  [ sec : amr ]",
    "we specify notation and assumptions which validate the estimate .    1 .   [",
    "it : bhi ] let @xmath8 , @xmath9 , and let @xmath10 be open .",
    "suppose that nonnegative functions @xmath11 on @xmath12 are regular harmonic in @xmath13 with respect to the process @xmath14 , and vanish in @xmath15 .",
    "there is @xmath16 such that @xmath17    here @xmath14 is a hunt process , having a metric measure space @xmath12 as the state space , and @xmath18 $ ] is a localization radius ( discussed in section  [ sec : amr ] ) .",
    "also , a nonnegative function @xmath19 is said to be regular harmonic in @xmath13 with respect to @xmath14 if @xmath20 where @xmath21 is the time of the first exit of @xmath14 from @xmath13 .",
    "to facilitate cross - referencing , in and later on we let @xmath22 denote the constant in the displayed formula @xmath23 . by @xmath24 or @xmath25",
    "we denote secondary ( temporary ) constants in a lemma or a section , and @xmath26 , or simply @xmath27 , means a constant @xmath24 that may be so chosen to depend only on @xmath28 . throughout the article ,",
    "all constants are positive .",
    "the present work started with an attempt to obtain _ bounded _ kernels which reproduce harmonic functions .",
    "we were motivated by the so - called regularization of the poisson kernel for @xmath3 ( @xcite , ( * ? ? ?",
    "* lemma  6 ) ) , which is crucial for the carleson estimate and bhi for @xmath3 . in the present paper",
    "we construct kernels obtained by gradually stopping the markov process with a specific multiplicative functional before the process approaches the boundary .",
    "the construction is the main technical ingredient of our work , and is presented in section  [ sec : reg ] .",
    "the argument is intrinsically probabilistic and relies on delicate analysis on the path space . at the beginning of section  [ sec : reg ] the reader will also find a short informal presentation of the construction .",
    "section  [ sec : amr ] gives assumptions and auxiliary results .",
    "the boundary harnack inequality ( theorem  [ th : bhi ] ) , and the so - called local supremum estimate ( theorem  [ th : regexit ] ) are presented in section  [ sec : bhi ] , but the proof of theorem  [ th : regexit ] is deferred to section  [ sec : reg ] . in section  [ sec : ex ] we verify in various settings the scale - invariance of bhi , discuss the relevance of our main assumptions from section  [ sec : amr ] , and present many applications , including subordinate brownian motions , lvy processes with or without continuous part , stable - like and censored processes , schrdinger , gradient and jump perturbations , processes on fractals and more .",
    "let @xmath29 be a metric measure space such that all bounded closed sets are compact and @xmath30 has full support .",
    "let @xmath31 , where @xmath32 and @xmath33 .",
    "all sets , functions and measures considered in this paper are borel .",
    "let @xmath18 $ ] ( the localization radius ) be such that @xmath34 for all @xmath32 and all @xmath35 .",
    "let @xmath36 be the one - point compactification of @xmath12 ( if @xmath12 is compact , then we add @xmath37 as an isolated point ) . without much mention",
    "we extend functions @xmath19 on @xmath12 to @xmath36 by letting @xmath38 .",
    "in particular , we write @xmath39 if @xmath19 is a continuous real - valued function on @xmath36 and @xmath38 . if furthermore @xmath19 has compact support in @xmath12 , then we write @xmath40 . for a kernel @xmath41 on @xmath12 ( @xcite )",
    "we let @xmath42 , provided the integral makes sense , i.e. , @xmath19 is ( measurable and ) either nonnegative or absolutely integrable .",
    "similarly , for a kernel density function @xmath43 , we let @xmath44 and @xmath45 for @xmath46 .",
    "let @xmath47 be a hunt process with state space @xmath12 ( see , e.g. ,  ( * ? ? ?",
    "* i.9 ) or  @xcite ) . here",
    "@xmath14 are the random variables , @xmath48 is the usual right - continuous filtration , @xmath49 is the distribution of the process starting from @xmath32 , and @xmath50 is the corresponding expectation .",
    "the random variable @xmath51 $ ] is the lifetime of @xmath14 , so that @xmath52 for @xmath53 .",
    "this should be kept in mind when interpreting above , below , etc .",
    "the transition operators of @xmath14 are defined by @xmath54 whenever the expectation makes sense .",
    "we assume that the semigroup @xmath55 is feller and strong feller , i.e. , for @xmath56 , @xmath55 maps bounded functions into continuous ones and @xmath57 into @xmath57 . the feller generator @xmath58 of @xmath14 is defined on the set @xmath59 of all those @xmath39 for which the limit @xmath60 exists uniformly in @xmath32 .",
    "the @xmath4-potential operator , @xmath61 is defined whenever the expectation makes sense .",
    "we let @xmath62 , the potential operator .",
    "the kernels of @xmath55 , @xmath63 and @xmath64 are denoted by @xmath65 , @xmath66 and @xmath67 , respectively .",
    "recall that a function @xmath68 is called @xmath4-excessive ( with respect to @xmath55 ) if for all @xmath32 , @xmath69 for @xmath56 , and @xmath70 as @xmath71 .",
    "when @xmath72 , we simply say that @xmath19 is excessive .",
    "we enforce a number of conditions , namely assumptions  [ assu : dual ] , [ assu : gen ] , [ assu : levy ] and  [ assu : green ] below .",
    "we start with a duality assumption , which builds on our discussion of @xmath14 .",
    "[ assu : dual ] there are hunt processes @xmath14 and @xmath73 which are dual with respect to the measure @xmath30 ( see  ( * ? ? ? * vi.1 ) or  @xcite ) .",
    "the transition semigroups of @xmath14 and @xmath73 are both feller and strong feller .",
    "every semi - polar set of @xmath14 is polar .    in what follows ,",
    "objects pertaining to @xmath73 are distinguished in notation from those for @xmath14 by adding a hat over the corresponding symbol .",
    "for example , @xmath74 and @xmath75 denote the transition and @xmath4-potential operators of @xmath73 .",
    "the first sentence of assumption  [ assu : dual ] means that for all @xmath76 , there are functions @xmath77 such that @xmath78 for all @xmath68 and @xmath32 , and such that @xmath79 is @xmath4-excessive with respect to @xmath55 , and @xmath80 is @xmath4-excessive with respect to @xmath74 ( that is , @xmath4-co - excessive ) .",
    "the @xmath4-potential kernel @xmath81 is unique ( see ( * ? ? ?",
    "* theorem 13.2 ) or remarks after ( * ? ? ?",
    "* proposition  vi.1.3 ) ) .    the condition in assumption  [ assu : dual ] that semi - polar sets are polar",
    "is also known as _",
    "hunt s hypothesis _ ( h ) .",
    "most notably , it implies that the process @xmath14 never hits irregular points , see , e.g. ,  ( * ? ? ?",
    "* i.11 and ii.3 ) or  ( * ? ? ?",
    "* chapter  3 ) .",
    "the @xmath4-potential kernel is non - increasing in @xmath76 , and hence the potential kernel @xmath82 $ ] is well - defined .",
    "we consider an open set @xmath83 and the time of the first exit from @xmath13 for @xmath14 and @xmath73 , @xmath84 we define the processes killed at @xmath21 , @xmath85 we let @xmath86 and @xmath87 be their transition kernels . by  ( * ?",
    "* remark 13.26 ) , @xmath88 and @xmath89 are dual processes with state space @xmath13 .",
    "indeed , for each @xmath90 , @xmath91 the process @xmath14 only hits regular points of @xmath92 when it exits @xmath13 . in the nomenclature of  @xcite , this means that the left - entrance time and the hitting time of @xmath92 are equal @xmath93 for every @xmath90 .",
    "in particular , the potential kernel @xmath94 of @xmath88 exists and is unique , although in general it may be infinite ( @xcite ) .",
    "@xmath94 is called the green function for @xmath14 on @xmath13 , and it defines the green operator @xmath95 , @xmath96 note that @xmath97 .",
    "when @xmath14 is symmetric ( self - dual ) with respect to @xmath30 , then assumption  [ assu : dual ] is equivalent to the existence of the @xmath4-potential kernel @xmath81 for @xmath14 , since then hunt s hypothesis ( h ) is automatically satisfied , see  @xcite .",
    "the following urysohn regularity hypothesis plays a crucial role in our paper , providing enough ` smooth ' functions on @xmath12 to approximate indicator functions of compact sets .",
    "[ assu : gen ] there is a linear subspace @xmath98 of @xmath99 satisfying the following condition . if @xmath100 is compact , @xmath13 is open , and @xmath101 , then there is @xmath102 such that @xmath103 for @xmath104 , @xmath105 for @xmath106 , @xmath107 for @xmath32 , and the boundary of the set @xmath108 has measure @xmath30 zero .",
    "we let @xmath109 where the infimum is taken over all such functions @xmath19 .    thus ,",
    "nonnegative functions in @xmath99 separate the compact set @xmath100 from the closed set @xmath92 : there is a urysohn ( bump ) function for @xmath100 and @xmath92 in the domains . since the supremum in   is finite for any @xmath102 and the infimum",
    "is taken over a nonempty set , @xmath110 is always finite .",
    "note that constant functions are not in @xmath59 nor @xmath111 unless @xmath12 is compact . in the euclidean case @xmath112 , @xmath98 can often be taken as the class @xmath113 of compactly supported smooth functions .",
    "the existence of @xmath98 is problematic if @xmath12 is more general .",
    "however , for the sierpiski triangle and some other self - similar ( p.c.f . )",
    "fractals , @xmath98 can be constructed by using the concept of splines on fractals ( @xcite ) .",
    "also , a class of smooth indicator functions was recently constructed in  @xcite for heat kernels satisfying upper sub - gaussian estimates on @xmath12 .",
    "further discussion is given in section  [ sec : ex ] and appendix  [ sec : app ] .",
    "here we note that assumption  [ assu : gen ] implies that the jumps of @xmath14 are subject to the following identity , which we call the lvy system formula for @xmath14 , @xmath114 } f(s , x_{s- } , x_s ) = { \\mathbf{e}}_x \\int_0^t \\int_{\\mathfrak{x}}f(s , x_{s- } , z ) \\nu(x_{s- } , dz ) ds.\\ ] ] here @xmath115 $ ] , @xmath116 for all @xmath32 , and @xmath117 is a kernel on @xmath12 ( satisfying @xmath118 for all @xmath32 ) , called the lvy kernel of @xmath14 , see  @xcite . for more general markov processes , @xmath119 in",
    "is superseded by the differential of a perfect , continuous additive functional , and   defines @xmath120 only up to a set of zero potential , that is , for @xmath30-almost every @xmath32 . by inspecting the construction in  @xcite , and using assumption  [ assu : gen ] ,",
    "one proves in a similar way as in  ( * ? ? ?",
    "* section  5 ) that the lvy kernel @xmath117 satisfies @xmath121 this formula , as opposed to  , defines @xmath122 for all @xmath32 . with only one exception , to be discussed momentarily , we use   and not  , hence we take   as the definition of @xmath117 .",
    "it is easy to see that   indeed defines @xmath122 : if @xmath123 and @xmath124 , then @xmath125 . by assumption  [ assu : gen ] , the mapping @xmath126 is a densely defined , nonnegative linear functional on @xmath127 , hence it corresponds to a nonnegative radon measure @xmath122 on @xmath128 . as usual",
    ", we let @xmath129 .",
    "the lvy kernel @xmath130 for @xmath73 is defined in a similar manner . by duality , @xmath131 .    as an application of we",
    "consider the martingale @xmath132 } f(s , x_{s- } , x_s ) -",
    "\\int_0^t \\int_{\\mathfrak{x}}f(s , x_{s- } , z ) \\nu(x_{s- } , dz ) ds,\\end{aligned}\\ ] ] where @xmath133 .",
    "we stop the martingale at @xmath21 and we see that @xmath134 on @xmath135 .",
    "a similar result was first proved in  @xcite .",
    "for this reason we refer to   as the ikeda - watanabe formula ( see also   and below ) .",
    "integrating against @xmath136 and @xmath137 we obtain @xmath138    for @xmath8 and @xmath139 , we consider the open and closed balls @xmath140 and @xmath141 , and the annular regions @xmath142 and @xmath143 .",
    "note that @xmath144 , the closure of @xmath145 , may be a proper subset of @xmath146 .",
    "recall that @xmath147 denotes the localization radius of @xmath12 .",
    "the following assumption is our main condition for the boundary harnack inequality .",
    "it asserts a relative constancy of the density of the lvy kernel .",
    "this is a natural condition , as seen in example  [ ex : truncated ] .",
    "[ assu : levy ] the lvy kernels of the processes @xmath14 and @xmath73 have the form @xmath148 and @xmath149 respectively , where @xmath150 for all @xmath151 , @xmath152 . for every @xmath8 , @xmath9 , @xmath153 and @xmath154 , @xmath155 with @xmath156 .",
    "it follows directly from assumption  [ assu : levy ] that for @xmath8 and @xmath139 , @xmath157 where @xmath143 .",
    "( here we do not require that @xmath158 . )",
    "indeed , we may cover @xmath159 by a finite family of balls @xmath160 , where @xmath161 .",
    "for @xmath162 , @xmath163 is comparable with @xmath164 , and @xmath165 is comparable with @xmath166 .",
    "[ prop : tau ] if @xmath8 and @xmath167 , then @xmath168    let @xmath169 , @xmath170 , @xmath171 and @xmath172 . by the definition of @xmath147 ,",
    "this and   yield @xmath174 . by the ikeda - watanabe formula  , @xmath175 hence @xmath176 .",
    "if follows that @xmath177 .",
    "considering an analogous argument for @xmath178 , we see that we may take @xmath179    in particular , if @xmath180 and @xmath10 , then the green function @xmath94 exists ( see the discussion following assumption  [ assu : dual ] ) , and for each @xmath32 it is finite for all @xmath181 in @xmath12 less a polar set .",
    "we need to assume slightly more .",
    "the following condition may be viewed as a weak version of harnack s inequality .",
    "[ assu : green ] if @xmath8 , @xmath182 and @xmath183 , then @xmath184    assumptions  [ assu : dual ] , [ assu : gen ] , [ assu : levy ] and  [ assu : green ] are tacitly assumed throughout the entire paper .",
    "we recall them explicitly only in the statements of bhi and local maximum estimate .",
    "when saying that a statement holds for almost every point of @xmath12 , we refer to the measure @xmath30 .",
    "the following technical result is a simple generalization of ( * ? ? ?",
    "* proposition  ii.3.2 ) .",
    "[ prop : aa ] suppose that @xmath185 is a standard markov process such that for every @xmath32 and @xmath76 , the @xmath4-potential kernel @xmath186 of @xmath185 is absolutely continuous with respect to @xmath187 .",
    "suppose that function @xmath19 is excessive for the transition semigroup of @xmath185 , and @xmath19 is not identically infinite .",
    "if function @xmath188 is continuous and @xmath189 for _ almost every _",
    "@xmath153 , then @xmath189 for _ every _ @xmath153 .",
    "let @xmath190 .",
    "then @xmath191 , so that @xmath192 is of zero potential for @xmath193 .",
    "hence @xmath194 is finely dense in @xmath195 .",
    "since @xmath196 is finely continuous , we have @xmath189 for all @xmath153 , as desired .",
    "( see e.g.  @xcite for the notion of fine topology and fine continuity of excessive functions . )",
    "if @xmath14 is transient , often holds even when @xmath197 is replaced by @xmath198 . in the recurrent case",
    ", we can use estimates of @xmath63 , as follows .",
    "[ prop : green : pot ] if @xmath8 , @xmath182 , @xmath76 , @xmath199 and @xmath200 for all @xmath151 , @xmath56 , then in we may let @xmath201    denote @xmath183 . if @xmath202 , @xmath203 and @xmath204 , then @xmath205 where @xmath206 and @xmath207 .",
    "if @xmath208 , then by proposition  [ prop : aa ] , @xmath209 . by proposition  [ prop :",
    "tau ] , @xmath210 .",
    "the estimate of @xmath211 is similar .",
    "we use the standard notation @xmath212 . recall that all functions @xmath19 on @xmath12",
    "are automatically extended to @xmath213 by letting @xmath38 .",
    "in particular , we understand that @xmath214 for all @xmath123 , and @xmath215 .    the following formula obtained by dynkin ( see ( * ? ? ?",
    "* formula  ( 5.8 ) ) ) plays an important role .",
    "if @xmath216 is a markov time , @xmath217 and @xmath123 , then @xmath218 if @xmath219 , @xmath123 is supported in @xmath92 and @xmath220 @xmath221 for @xmath222 and @xmath32 , then @xmath223 we note that extends to nonnegative functions @xmath19 on @xmath12 which vanish on @xmath224 . indeed",
    ", both sides of   define nonnegative functionals of @xmath225 , and hence also nonnegative radon measures on @xmath226 . by",
    ", the two functionals coincide on @xmath227 , and this set is dense in @xmath228 by the urysohn regularity hypothesis .",
    "this proves that the corresponding measures are equal .",
    "we also note that one can not in general relax the condition that @xmath229 on @xmath224 . indeed , even if @xmath230 , @xmath231 may hit @xmath232 with positive probability .",
    "recall that a function @xmath68 on @xmath12 is called regular harmonic in an open set @xmath233 if @xmath234 for all @xmath32 . here",
    "a typical example is @xmath235 if @xmath236 vanishes on @xmath13 . by the strong markov property",
    "we then have @xmath237 for all stopping times @xmath238 .",
    "accordingly , we call @xmath68 regular subharmonic in @xmath13 ( for @xmath14 ) , if @xmath239 for all stopping times @xmath238 and @xmath240 . here",
    "a typical example is a regular harmonic function raised to a power @xmath241 .",
    "we like to recall that @xmath68 is called harmonic in @xmath13 , if @xmath242 for all open and bounded @xmath243 such that @xmath244 , and all @xmath245 .",
    "this condition is satisfied , e.g. , by the green function @xmath246 in @xmath247 , and it is weaker than regular harmonicity . in this work however , only the notion of regular harmonicity is used . for further discussion",
    ", we refer to @xcite .",
    "recall that assumptions  [ assu : dual ] , [ assu : gen ] , [ assu : levy ] and  [ assu : green ] are in force throughout the entire paper .",
    "some results , however , hold in greater generality .",
    "for example , the following lemma  [ lem : escape ] relies solely on assumption  [ assu : gen ] and , and it remains true also when @xmath14 is a diffusion process . also , lemma  [ lem : factorization ] and corollary  [ corr : ubhi ] require assumptions  [ assu : gen ] and  [ assu : levy ] but not  [ assu : dual ] or [ assu : green ] .",
    "[ lem : escape ] if @xmath8 and @xmath248 , then for all @xmath10 we have @xmath249 where @xmath250 .",
    "we fix an auxiliary number @xmath251 and @xmath153 .",
    "let @xmath102 be a bump function from assumption  [ assu : gen ] for the compact set @xmath252 and the open set @xmath253 .",
    "thus , @xmath123 , @xmath105 , @xmath254 for @xmath255 and @xmath256 for all @xmath257 . by dynkin s formula",
    "we have @xmath258 since @xmath259 , the proof is complete .",
    "we write @xmath260 if @xmath261 .",
    "we will now clarify the relation between bhi and local supremum estimate .",
    "[ lem : factorization ] the following conditions are equivalent :    1 .",
    "[ it : factorization : a ] if @xmath8 , @xmath9 , @xmath10 is open , @xmath19 is nonnegative , regular harmonic in @xmath13 and vanishes in @xmath15 , then @xmath262 for @xmath263 , where @xmath264 .",
    "[ it : factorization : b ] if @xmath8 , @xmath265 , @xmath10 is open , @xmath19 is nonnegative , regular harmonic in @xmath13 and vanishes in @xmath15 , then @xmath266 for @xmath263 , where @xmath267 .",
    "in fact , if  [ it : factorization : a ] holds , then we may let @xmath268 and if [ it : factorization : b ] holds , then we may let @xmath269    since @xmath270 and @xmath271 , we see that [ it : factorization : b ] implies [ it : factorization : a ] with @xmath272 .",
    "below we prove the converse .",
    "let [ it : factorization : a ] hold , and @xmath273 .",
    "we have @xmath274 denote the terms on the right hand side by @xmath275 and @xmath276 , respectively . by   and  , @xmath277 with @xmath278 and @xmath279 . for @xmath276 , the ikeda - watanabe formula   yields @xmath280 with constant @xmath281 .",
    "formula   follows , as we have @xmath282 in the upper bound and @xmath283 in the lower bound .",
    "we like to remark that bhi boils down to the approximate factorization   of @xmath284 .",
    "we also note that @xmath285 , if @xmath286 is far from @xmath287 , since then @xmath288 in .",
    "however , @xmath289 in is quite singular and much larger than @xmath290 if both @xmath291 and @xmath286 are close to @xmath292 .",
    "our main task is to prove that the contribution to   from such points @xmath291 is compensated by the relatively small time spent there by @xmath88 when starting at @xmath90 .",
    "in fact , we wish to control   by an integral free from singularities ( i.e.  ) , if @xmath293 and @xmath286 are not too close .    by substituting   into  ,",
    "we obtain the following result .    [",
    "corr : ubhi ] the conditions [ it : factorization : a ] , [ it : factorization : b ] of lemma  [ lem : factorization ] imply [ it : bhi ] with @xmath294    the main technical result of the paper is the following _ local supremum estimate _ for sub - harmonic functions , which is of independent interest .",
    "the result is proved in section  [ sec : reg ] .",
    "[ th : regexit ] suppose that assumptions  [ assu : dual ] , [ assu : gen ] , [ assu : levy ] and  [ assu : green ] hold true .",
    "let @xmath8 and @xmath295 , where @xmath147 is the localization radius from assumptions  [ assu : levy ] and  [ assu : green ] .",
    "let function @xmath19 be nonnegative on @xmath12 and regular subharmonic with respect to @xmath14 in @xmath287 .",
    "then @xmath296 where @xmath297 @xmath298 ( see assumption  [ assu : gen ] ) , and @xmath299    theorem  [ th : regexit ] ( to be proved in the next section ) and corollary  [ corr : ubhi ] lead to bhi .",
    "we note that no regularity of the open set @xmath13 is assumed .",
    "[ th : bhi ] if assumptions  [ assu : dual ] , [ assu : gen ] , [ assu : levy ] and  [ assu : green ] are satisfied , then  [ it : bhi ] holds true with @xmath300[c]{$\\displaystyle \\inf_{\\genfrac{}{}{0pt}{}{p , q,\\tilde{r}}{r < p < q < r < \\tilde{r}}}$ }   { \\left ( { \\varrho}(\\overline{a}(x_0 , p , q ) , a(x_0 , r , \\tilde{r } ) ) c_{\\eqref{eq : ubhic2}}(x_0 , q , r ) + c_{\\eqref{eq : nu}}(x_0 , p , q ) \\right)}^4 \\ ! , \\end{aligned}\\ ] ] @xmath301[c]{$\\displaystyle \\inf_{\\genfrac{}{}{0pt}{}{\\tilde{q},\\tilde{r}}{q < \\tilde{q } < r < \\tilde{r}}}$ }   2 c_{\\eqref{eq : regexit3}}(x_0 , q , \\tilde{q } , r ) \\times \\\\   & \\quad \\times \\max { \\left ( \\frac{{\\varrho}(\\overline{b}(x_0 , \\tilde{q } ) , b(x_0 , r))}{c_{\\eqref{eq : nu2}}(x_0 , \\tilde{q } , \\tilde{r } ) } , c_{\\eqref{eq : nu}}(x_0 , r , \\tilde{r } ) m(b(x_0 , r ) ) \\right ) } . \\end{split}\\end{aligned}\\ ] ]    we only need to prove condition  [ it : factorization : a ] of lemma  [ lem : factorization ] with @xmath302 equal to @xmath303 given above . by   and   of theorem",
    "[ th : regexit ] , it suffices to prove that @xmath304 .",
    "for @xmath305 we have @xmath306 with @xmath307 , @xmath298 and @xmath308 . if @xmath309 , then @xmath310 with @xmath311 as above and @xmath312 .",
    "the proof is complete .",
    "[ rem : si ] [ it : bhi ] is said to be _ scale - invariant _ if @xmath313 may be so chosen to depend on @xmath314 and @xmath315 only through the ratio @xmath316 . in some applications ,",
    "the property plays a crucial role , see , e.g. , @xcite . if @xmath14 admits _ stable - like scaling _ , then @xmath313 given by   is scale - invariant indeed , as explained in section  [ sec : ex ] ( see theorem  [ th : sibhi ] ) .",
    "the constant @xmath313 in theorem  [ th : bhi ] depends only on basic characteristics of @xmath14 .",
    "accordingly , in section  [ sec : ex ] it is shown that bhi is stable under small perturbations .",
    "bhi applies in particular to hitting probabilities : if @xmath9 , @xmath317 and @xmath318 , then @xmath319    bhi implies the usual harnack inequality if , e.g. , constants are harmonic .",
    "the approach to bhi via approximate factorization was applied to isotropic stable processes in  @xcite , to stable - like subordinate diffusion on the sierpiski gasket in  @xcite , and to a wide class of isotropic lvy processes in  @xcite . in all these papers ,",
    "the taming of the intensity of jumps near the boundary was a crucial step .",
    "this parallels the connection of the carleson estimate and bhi in the classical potential theory , see section  [ sec : int ] .",
    "in this section we prove theorem  [ th : regexit ] . the proof is rather technical , so we begin with a few words of introduction and an intuitive description of the idea of the proof .    in  ( * ? ? ?",
    "* lemma  6 ) , an analogue of theorem  [ th : regexit ] was obtained for the isotropic @xmath4-stable lvy processes by averaging harmonic measure of the ball against the variable radius of the ball .",
    "the procedure yields a kernel with no singularities and a mean value property for harmonic functions . in the setting of @xcite",
    "the boundedness of the kernel follows from the explicit formula and bounds for the harmonic measure of a ball .",
    "a similar argument is classical for harmonic functions of the laplacian and the brownian motion . for more general processes @xmath14",
    "this approach is problematic : while the ikeda - watanabe formula gives precise bounds for the harmonic measure far from the ball , satisfactory estimates near the boundary of the ball require exact decay rate of the green function , which is generally unavailable .",
    "in fact , resolved cases indicate that sharp estimates of the green function are equivalent to bhi ( @xcite ) , hence not easier to obtain .",
    "below we use a different method to mollify the harmonic measure .",
    "recall that the harmonic measure of @xmath320 is the distribution of @xmath321 .",
    "it may be interpreted as the mass lost by a particle moving along the trajectory of @xmath14 , when it is killed at the moment @xmath322 . in the present paper",
    "we let the particle lose the mass _ gradually _ before time @xmath322 , with intensity @xmath323 for a suitable function @xmath324 sharply increasing at @xmath325 .",
    "the resulting distribution of the lost mass defines a kernel with a mean value property for harmonic functions , and it is less singular than the distribution of @xmath321 .    throughout this section ,",
    "we fix @xmath8 and four numbers @xmath265 , where @xmath147 is defined in assumptions  [ assu : levy ] and  [ assu : green ] . for the compact set @xmath326 and the open set @xmath287 we consider the bump function @xmath327 provided by assumption  [ assu : gen ] .",
    "we let @xmath328 and @xmath329 we have @xmath330 , see figure  [ fig:1 ] . by assumption  [ assu : gen ] ,",
    "note that @xmath332 and @xmath333 if @xmath334 , and @xmath335 can be arbitrarily close to @xmath336 .",
    "we consider a function @xmath337 $ ] continuous in the extended sense and such that @xmath338 for @xmath339 , and @xmath340 when @xmath341 .",
    "let @xmath342 we see that @xmath343 is a right - continuous , strong markov , nonnegative ( possibly infinite ) additive functional , and @xmath344 for @xmath53 .",
    "we define the right - continuous multiplicative functional @xmath345 for @xmath346 $ ] , we let @xmath347 be the first time when @xmath348 . in particular , @xmath349 is the time when @xmath343 becomes infinite .",
    "note that @xmath343 and @xmath350 are continuous except perhaps at the single ( random ) moment @xmath349 when @xmath343 becomes infinite and the left limit @xmath351 is finite . since @xmath343 is finite for @xmath352",
    ", we have @xmath353 .",
    "if @xmath354 grows sufficiently fast near @xmath355 , then in fact @xmath356 , as we shall see momentarily .",
    "[ lem : boundary1 ] if @xmath357 are such that @xmath358 for all @xmath341 , then @xmath359 and @xmath360 @xmath91 for every @xmath32 .",
    "in particular , @xmath361 .",
    "we first assume that @xmath362 . in this case",
    "it suffices to prove that @xmath363 .",
    "since @xmath364 for all @xmath257 , and @xmath365 , from dynkin s formula for the ( deterministic ) time @xmath366 it follows that @xmath367 for all @xmath368 . by the schwarz inequality , @xmath369 where @xmath370 .",
    "here we use the conventions @xmath371 and @xmath372 .",
    "thus , @xmath373 with the convention @xmath374",
    ". hence , @xmath375 by taking @xmath376 , we obtain @xmath377 it follows that @xmath344 @xmath91 we conclude that @xmath363 and @xmath378 @xmath91 , as desired .    when @xmath341 , the result in the statement of the lemma follows from the strong markov property .",
    "indeed , by the definition   of @xmath343 , @xmath379 , where @xmath380 is the shift operator on the underlying probability space , which shifts sample paths of @xmath14 by the random time @xmath381 , and @xmath382 denotes the left limit of @xmath343 at @xmath383 . hence , @xmath384 .",
    "furthermore , @xmath385 @xmath91 , so by the first part of the proof , we have @xmath386 @xmath91 thus , @xmath387 which implies that @xmath360 @xmath91 and @xmath359 @xmath91",
    ".    from now on we only consider the case when the assumptions of lemma  [ lem : boundary1 ] are satisfied , and @xmath388 , @xmath389 are reserved for the constants in the condition @xmath358 . by the definition and right - continuity of paths of @xmath14 , @xmath343 and @xmath350 are monotone right - differentiable continuous functions of @xmath390 on @xmath391 , with derivatives @xmath323 and @xmath392 , respectively .",
    "let @xmath393 be the dirac measure at @xmath394 .",
    "lemma  [ lem : boundary1 ] yields the following result .",
    "[ corr : gpsipsi ] we have @xmath395 @xmath91 in particular , @xmath396 for any measurable random time @xmath216 and nonnegative or bounded function @xmath19 .",
    "we emphasize that if @xmath350 has a jump at @xmath216 , in which case we must have @xmath397 , then the jump does not contribute to the lebesgue - stieltjes integral @xmath398 in  .",
    "the same remark applies to   below .",
    "recall that @xmath399 . note that @xmath347 are markov times for @xmath14 , @xmath400 is the left - continuous inverse of @xmath401 , and the events @xmath402 and @xmath403 are equal .",
    "we have @xmath404 unless @xmath405 , and , clearly , @xmath406 .",
    "the following may be considered as an extension of dynkin s formula .",
    "[ lem : psigen ] for @xmath123 , markov time @xmath216 , and @xmath341 , we have @xmath407 if @xmath408 and @xmath409 ,",
    "then @xmath410 in fact , holds for every strong markov right - continuous multiplicative functional @xmath350 .",
    "since @xmath411 and @xmath412 , by fubini , @xmath413 since @xmath414 is a markov time for @xmath14 , we can apply dynkin s formula .",
    "it follows that @xmath415 by fubini and the substitution @xmath416 , @xmath417 , @xmath418 , @xmath419 we emphasize that the last equality holds true also if @xmath397 with positive probability .",
    "we see that holds . by",
    "we obtain  .",
    "the functional @xmath350 is a feynman - kac functional , interpreted as the diminishing mass of a particle started at @xmath32 .",
    "we shall estimate the kernel @xmath420 , defined as the expected amount of mass left by the particle at @xmath137 .",
    "namely , for any nonnegative or bounded @xmath19 we define @xmath421 note that @xmath422 for @xmath362 . by the substitution @xmath416 , @xmath417 , @xmath418 and fubini",
    ", we obtain that @xmath423 the potential kernel @xmath424 of the functional @xmath350 will play an important role .",
    "namely , for any nonnegative or bounded @xmath19 we let @xmath425 in the second equality above , the identities @xmath426 and @xmath427 were used together with fubini , as in the proof of lemma  [ lem : psigen ] .",
    "we note that @xmath428 measures the expected time spent by the process @xmath14 at @xmath137 , weighted by the decreasing mass of @xmath14 ( compare with the similar role of @xmath429 ) .",
    "there is a semigroup of operators @xmath430 associated with the multiplicative functional @xmath350 .",
    "furthermore , @xmath431 are transition operators of a markov process @xmath432 , the _ subprocess _ of @xmath14 corresponding to @xmath350 . with the definitions of  @xcite",
    ", @xmath350 is a strong markov right - continuous multiplicative functional and @xmath433 is the set of permanent points for @xmath350 .",
    "therefore , @xmath432 is a standard markov process with state space @xmath433 , see  ( * ? ? ?",
    "* iii.3.12 , iii.3.13 and the discussion after iii.3.17 ) .",
    "( from   and  ( * ? ? ?",
    "* proposition  iii.5.9 ) it follows that @xmath350 is an exact multiplicative functional .",
    "furthermore , since @xmath350 can be discontinuous only at @xmath383 , the functional @xmath350 is quasi - left continuous in the sense of  ( * ? ? ?",
    "* iii.3.14 ) , and therefore @xmath432 is a hunt process on @xmath433 . however",
    ", we do not use these properties in our development . )    informally , @xmath432 is obtained from @xmath14 by terminating the paths of @xmath14 with rate @xmath434 , and @xmath420 is the distribution of @xmath14 stopped at the time when @xmath432 is killed .",
    "furthermore , @xmath424 is the potential kernel of @xmath432 . to avoid technical difficulties related to subprocesses and the domains of their generators , in what follows we rely mostly on the formalism of additive and multiplicative functionals .",
    "the multiplicative functional @xmath435 is defined just as @xmath350 , but for the dual process @xmath73 .",
    "we correspondingly define @xmath436 and @xmath437 .",
    "since the paths of @xmath73 can be obtained from those of @xmath14 by time - reversal and @xmath350 and @xmath435 are defined by integrals invariant upon time - reversal , the definition of @xmath435 agrees with that of  ( * ? ? ?",
    "* formula  ( 13.24 ) ) .",
    "hence , by  ( * ? ? ?",
    "* theorem  13.25 ) , @xmath350 and @xmath435 are dual multiplicative functionals .",
    "it follows that the subprocess @xmath438 of @xmath73 corresponding to the multiplicative functional @xmath435 is the dual process of @xmath432 ; see  ( * ? ? ?",
    "* and remark  13.26 ) .",
    "hence , the potential kernel @xmath439 of @xmath432 admits a uniquely determined density function @xmath440 ( @xmath441 ) , which is excessive in @xmath293 with respect to the transition semigroup @xmath431 of @xmath432 , and excessive in @xmath181 with respect to the transition semigroup @xmath442 of @xmath438 .",
    "furthermore , @xmath443 is the density of the potential kernel of @xmath438 .",
    "since @xmath424 is concentrated on @xmath433 , we let @xmath444 if @xmath362 or @xmath445 . clearly ,",
    "@xmath424 is dominated by @xmath446 for all @xmath341 , and therefore @xmath447 there are important relations between @xmath448 , @xmath439 , @xmath354 and @xmath58 . if @xmath19 is nonnegative or bounded and _ vanishes _ in @xmath449 , then by corollary  [ corr : gpsipsi ] we have @xmath450 considering @xmath397 , we note that @xmath360 , and so for bounded or nonnegative @xmath19 @xmath451 } f(x_t ) d m_t = \\int_{[0 , \\tau_v ) } f(x_t ) d m_t - f(x_{\\tau_v } ) m_{\\tau_v-}.\\ ] ] if @xmath123 , then formula   gives @xmath452 furthermore , by  , for @xmath123 we have @xmath453 in particular , if @xmath123 vanishes outside of @xmath433 , then we have @xmath454 ( which also follows directly from   and  ) . formula   means that the generator of @xmath432 agrees with @xmath455 on the intersection of the respective domains .",
    "we now introduce the green operators @xmath456 and harmonic measures @xmath457 for @xmath432 .",
    "let @xmath243 be an open subset of @xmath433 . for nonnegative or bounded @xmath19 and @xmath341 we let",
    "@xmath458 we note that @xmath459 .",
    "also , @xmath460 , if @xmath19 vanishes in @xmath433 .",
    "furthermore , @xmath456 admits a density function @xmath461 , and we have @xmath462 , @xmath463 .",
    "if @xmath19 vanishes outside of @xmath433 , then we can replace @xmath464 by @xmath465 in the definition of @xmath457 . by  ,",
    "for any @xmath123 we have @xmath466 in particular , by an approximation argument , @xmath467 formulas   and   can be viewed correspondingly as dynkin s formula applied to the first exit time , and the ikeda - watanabe formula for @xmath432 .",
    "recall that @xmath8 , @xmath265 , @xmath468 , see figure  [ fig:1 ] , @xmath469 is positive in @xmath433 and vanishes in @xmath449 , and @xmath470 for @xmath334 .",
    "[ lem : pipsiuest ] let @xmath471 .",
    "if @xmath472 for @xmath341 , then @xmath473    by  , for @xmath245 we have @xmath474 it remains to note that @xmath475 on @xmath476 .",
    "essentially , we use here ( and later on ) superharmonicity of @xmath327 with respect to @xmath455 .",
    "[ lem : gpsi ] if @xmath472 for @xmath341 , then @xmath477 where @xmath478",
    "let @xmath471 and @xmath245 .",
    "let @xmath19 be a nonnegative function supported in @xmath195 , @xmath479 and @xmath480 ( this is done to regularize @xmath440 ) . using the definition of @xmath439 , the relation @xmath481 for @xmath482 and the strong markov property ,",
    "we obtain that @xmath483 we split the last expectation into two parts , corresponding to the events @xmath484 and @xmath485 respectively . by   and",
    "the inequality @xmath486 , we have @xmath487 for @xmath488 . from   it follows that @xmath489 for the other part",
    ", we use   and  , @xmath490 with constant @xmath281 . using again   and  , and then  , we obtain @xmath491 by  , we have @xmath492 with constant @xmath493 .",
    "hence , @xmath494 this and   yield that @xmath495 , with @xmath496 given in the statement of the lemma .",
    "recall that @xmath497 , where @xmath19 is an arbitrary nonnegative function vanishing outside @xmath195 with integral equal to @xmath498 .",
    "hence , by approximation , for each @xmath499 , formula   holds for _ almost every _ @xmath500 . by proposition  [ prop : aa ] (",
    "applied to @xmath432 ) , holds for _ every _ @xmath500 .    for @xmath501",
    ", the result follows easily from  .",
    "indeed , we have @xmath502 , with constant @xmath503 .",
    "hence , formula   holds also for @xmath501 , with the same constant .    the above arguments can be repeated for the dual process @xmath73 .",
    "hence , the _ dual _ versions of lemmas  [ lem : pipsiuest ] and  [ lem : gpsi ] hold true , with the same @xmath496 .",
    "we are very close to the estimate of @xmath420 for @xmath153 .",
    "indeed , for @xmath504 we have @xmath505 ( see  ) .",
    "when @xmath506 , then , at least heuristically , @xmath507 , where @xmath508 vanishes outside of @xmath433 ( see  ) .",
    "this will give satisfactory bounds when @xmath445 .",
    "before we proceed , we first show that @xmath509 .",
    "[ lem : pipsiint ] suppose that for some @xmath510 , we have @xmath511 and @xmath512 for @xmath341 .",
    "then for every nonnegative function @xmath19 we have @xmath513    first , suppose that @xmath123 .",
    "denote @xmath514 for @xmath341 .",
    "note that @xmath515 is nonnegative .",
    "let @xmath516 for @xmath32 ; hence @xmath517 for @xmath362 , see  . by  , we have @xmath518 for @xmath341 .",
    "hence , @xmath519 for the second term , we have @xmath520 by   ( dual version ) , @xmath521 for @xmath341 . hence ,",
    "@xmath522 in the last equality , we used the fact that @xmath365 for @xmath362 .",
    "it follows that @xmath523 but @xmath514 , so that finally , after simplification , @xmath524 using the inequalities @xmath525 for @xmath341 and @xmath526 for @xmath341 , we obtain  .",
    "the general case of nonnegative @xmath19 ( not necessarily in @xmath59 ) follows by approximation .",
    "[ lem : boundary2 ] suppose that for some @xmath510 , we have @xmath511 and @xmath512 for @xmath341 .",
    "then @xmath527 @xmath91 and @xmath509 for all @xmath341 .    for @xmath341 define @xmath528 . by  , @xmath529 , so that @xmath188 vanishes almost everywhere in @xmath433 .",
    "we claim that @xmath188 is excessive for the transition semigroup @xmath431 of @xmath432 .",
    "indeed , we have @xmath530 , so that by the markov property , for any @xmath56 and @xmath341 , @xmath531 the right - hand side does not exceed @xmath532 , and by monotone convergence , it converges to @xmath532 as @xmath533 .",
    "hence @xmath188 is an excessive function equal to zero almost everywhere in @xmath433 . by  @xcite , proposition  ii.3.2 ( or by proposition  [ prop : aa ] ) ,",
    "@xmath534 for all @xmath341 .",
    "recall that according to the remark following lemma  [ lem : boundary1 ] , we keep assuming that @xmath358 for @xmath341 .",
    "consider @xmath535 for some @xmath536 , and let @xmath537 be the multiplicative functional defined in a similar manner as @xmath350 , but with @xmath354 replaced by @xmath538 .",
    "clearly , for all @xmath56 we have @xmath539 if and only if @xmath540 . since @xmath541 , an application of lemma  [ lem : boundary2 ] to @xmath538 yields the following result .",
    "[ corr : boundary2 ] suppose that for some @xmath542 , we have @xmath543 for @xmath341 .",
    "then @xmath527 @xmath91 for @xmath341 .",
    "in particular , @xmath509 for @xmath341 .    now we make the actual choice of @xmath354 .",
    "[ lem : pipsiest ] let @xmath335 be given by , and @xmath544 where @xmath371 . for all @xmath153 we have @xmath545 , where @xmath546 with @xmath547 given in lemma  [ lem : gpsi ] .",
    "note that @xmath548 , @xmath472 , @xmath549 and @xmath550 for @xmath341 .",
    "hence , we may apply lemmas  [ lem : boundary1 ] , [ lem : pipsiuest ] and  [ lem : gpsi ] , corollary  [ corr : boundary2 ] , and their dual versions . by corollary  [ corr : boundary2 ] ,",
    "@xmath509 for all @xmath341 .",
    "since @xmath332 and @xmath333 for @xmath334 , we have @xmath551 for @xmath334 , and therefore @xmath552 for all @xmath341 .",
    "fix @xmath153 .",
    "if @xmath19 is nonnegative and vanishes in @xmath553 and in @xmath449 , then   yields that @xmath554 using   for @xmath437 and the inequality @xmath555 for @xmath504 , we have @xmath556 with constant @xmath557 .",
    "suppose now that @xmath123 vanishes in @xmath433 . by  , @xmath558 we estimate the inner integral for @xmath559 .",
    "using   for @xmath437 , we have @xmath560 the integral over @xmath561 is estimated as in the proof of lemma  [ lem : gpsi ] , @xmath562 with constants @xmath281 , @xmath493 and @xmath557 . since @xmath563 and @xmath564 , we obtain that @xmath565 by approximation , holds for any nonnegative @xmath19 vanishing in @xmath566 .",
    "formula   is a combination of  , , @xmath509 and @xmath552 for all @xmath341 .",
    "[ lem : subharmonic ] if a nonnegative function @xmath19 is regular subharmonic in @xmath287 , then @xmath567 for @xmath153 . if @xmath19 is regular harmonic , then equality holds .    if @xmath19 is regular subharmonic in @xmath433 , then @xmath568 for all @xmath346 $ ] . if @xmath19 is regular harmonic in @xmath433 , then equality holds .",
    "the result follows by  .    the local maximum estimate is now proved as follows .",
    "fix @xmath569 .",
    "choose @xmath570 and @xmath327 as in the beginning of this section , and so that @xmath571 .",
    "define @xmath354 as in  . by lemmas  [ lem : pipsiest ] and  [ lem : subharmonic ]",
    ", we have   with @xmath572 bounded from above by @xmath573 defined in  .",
    "note that @xmath574 . since @xmath570 and @xmath569 are arbitrary , formulas   and   follow .",
    "we conclude this section with a result on diffusion processes .",
    "the above argument remains valid when @xmath117 vanishes everywhere , i.e. , @xmath14 is a diffusion process . in this case",
    "is not a consequence of assumption  [ assu : levy ] , so we need to add   as an assumption .",
    "no other changes in the argument are needed , and in fact the proof of lemma  [ lem : gpsi ] simplifies significantly , since @xmath14 exits @xmath243 through the boundary of @xmath243 , and therefore @xmath575 is never in @xmath561 .",
    "therefore , we have proved the following result .",
    "[ th : diffusions ] assume that @xmath14 is a diffusion process satisfying assumptions  [ assu : dual ] , [ assu : gen ] and  [ assu : green ] , and formula  .",
    "let @xmath8 and @xmath295 , where @xmath147 is the localization radius of  [ eq : tau ] and assumption  [ assu : green ] .",
    "let @xmath19 be a nonnegative function on @xmath287 , regular subharmonic in @xmath287 with respect to @xmath14 .",
    "then @xmath576 here @xmath577 , where @xmath578 and @xmath579 are defined in assumptions  [ assu : gen ] and  [ assu : green ] .",
    "[ rem : dirichlet ] for diffusion processes , local supremum estimate   for subharmonic functions is typically proved analytically , using sobolev embeddings and moser iteration , see , e.g. , @xcite . theorem  [ th : regexit ] requires more regularity of the process @xmath14 as compared to the analytical approach because we assume the existence of bump functions in the domain of the feller generator ( assumption  [ assu : gen ] ) , while moser iteration is based on the energy form .",
    "however , our approach does not depend on sobolev embeddings , and so it applies also to sierpiski carpets and some other highly irregular state spaces @xmath12",
    ". it would be interesting to find an analytical proof of the local supremum estimate for jump - type processes , which would not require assumption  [ assu : gen ] .",
    "related results have been recently studied when the lvy kernel @xmath580 is comparable to @xmath581 ( see  @xcite and the references therein ) .",
    "further comments on this subject are given in example  [ ex : stable - like ] and appendix  [ sec : app ] .",
    "in this section we study several applications of our boundary harnack inequality , and discuss limitations of theorem  [ th : bhi ] .",
    "we sketch the range of possible applications by indicating rather general classes of processes satisfying the assumptions of theorem  [ th : bhi ] , without getting into technical details . before that , however , we discuss an important notion of scale - invariance introduced in remark  [ rem : si ] .",
    "this property can be proved in a fairly general setting , which we call _ stable - like scaling_.    [ def : stable - like ] the process @xmath14 is said to have _ stable - like scaling _",
    "property with dimension @xmath582 , index @xmath76 and localization radius @xmath18 $ ] ( @xmath4-stable - like scaling in short ) , if the following conditions are met :    1 .",
    "[ it : reg ] @xmath12 is locally an ahlfors regular @xmath583-space ; that is , @xmath584 when @xmath167 and @xmath32 ; 2 .",
    "[ it : nu ] @xmath585 when @xmath9 , @xmath8 in the relative constancy of the lvy measure condition in assumption  [ assu : levy ] ; 3 .",
    "[ it : nu2 ] @xmath586 when @xmath9 , @xmath8 , that is , @xmath587 when @xmath588 ; 4 .",
    "[ it : tau ] @xmath589 when @xmath167 , @xmath8 in the upper bound for mean exit time from a ball ; 5 .",
    "[ it : green ] @xmath590 when @xmath182 and @xmath8 in the off - diagonal upper bound for the green function of a ball ; 6 .",
    "[ it : gen ] @xmath591 when @xmath9 and @xmath8 , and @xmath592 when @xmath593 in assumption  [ assu : gen ] .",
    "[ prop : stable - like ] if the scaling property  [ it : reg ] is satisfied , then conditions  [ it : nu ] , [ it : nu2 ] and  [ it : tau ] are consequences of :    1 .   [ it : nu3 ] the lvy kernel of @xmath14 satisfies @xmath594 for some @xmath595 and for all @xmath151 .    note that the same parameter @xmath596 appears in the lower and the upper bound .",
    "conditions  [ it : nu ] and  [ it : nu2 ] follow directly from  [ it : nu3 ] . furthermore , by  [ it : reg ] and the triangle inequality , there is @xmath597 such that if @xmath8 and @xmath167 , then for some @xmath598 where @xmath599 , the balls @xmath195 and @xmath600 are disjoint . hence , for all @xmath153 we have by [ it : reg ] and [ it : nu3 ] , @xmath601 . as in the proof of proposition",
    "[ prop : tau ] , it follows that @xmath602 , and therefore @xmath603 .",
    "we also have the following sufficient condition for scaling properties  [ it : tau ] and  [ it : green ] .",
    "[ prop : green ] assume that scaling property  [ it : reg ] holds .",
    "suppose that the transition density @xmath604 of a hunt process @xmath14 exists , and that for some @xmath76 , @xmath605 , @xmath606 for @xmath151 with @xmath607 , and any @xmath608 .",
    "then assumption  [ assu : green ] and scaling conditions  [ it : tau ] and  [ it : green ] hold .",
    "the constant @xmath609 and the localization radius @xmath147 in   depend only on the constants in   ( including @xmath4 and @xmath610 ) and in the ahlfors regularity condition .",
    "both cases @xmath611 and @xmath612 are very similar ( in fact , slightly simpler ) to the remaining case @xmath613 . hence we give a detailed argument only when @xmath613 .    with no loss of generality we may assume that @xmath614 . we choose @xmath615 so that @xmath616 for all @xmath8 and @xmath617 .",
    "let @xmath618 , @xmath8 , @xmath619 , and let @xmath620 be the transition kernel of the killed process @xmath88 .",
    "recall that @xmath621 .",
    "let @xmath622 and let @xmath623 , @xmath624 .",
    "since @xmath625 , we have @xmath626 and @xmath627 note that for @xmath611 or @xmath612 , we simply have a different expression for the above integral . when @xmath628 $ ] , we have @xmath629 , and hence @xmath630 .",
    "furthermore , since @xmath631 and @xmath632 for @xmath633 , @xmath634 for @xmath635 , @xmath628 $ ] , @xmath636 , we have @xmath637 .",
    "it follows that @xmath638 and therefore , by summing up a geometric series , @xmath639 we conclude that @xmath640 .",
    "this gives assumption  [ assu : green ] and property  [ it : green ] .",
    "property  [ it : tau ] follows by simple integration .    if @xmath14 has @xmath4-stable - like scaling , then , by a simple substitution , in theorem  [ th : bhi ] we have @xmath641 hence the boundary harnack inequality is uniform in all scales @xmath642 , or _",
    "scale - invariant _ , as claimed in remark  [ rem : si ] .",
    "we state this result as a separate theorem for future reference .",
    "[ th : sibhi ] if the assumptions of theorem  [ th : bhi ] are satisfied , and the process @xmath14 has @xmath4-stable - like scaling , then the boundary harnack inequality  [ it : bhi ] is scale - invariant : @xmath643 depends only on @xmath644 .    in typical applications , one",
    "verifies ( typically quite straightforward ) conditions  [ it : reg ] and  [ it : nu3 ] , formula   ( which has been proved for a fairly general class of processes ) , and condition  [ it : gen ] . when dealing with processes given the lvy kernel @xmath580 , condition  [ it : gen ] turns out to be the most restrictive one .",
    "[ ex : levy ] theorem  [ th : bhi ] applies to a large class of lvy processes . in this case , the notion of processes in duality and properties of the feller generator simplify significantly , see  @xcite .",
    "let @xmath14 be a lvy process in @xmath645 ( with the euclidean distance @xmath646 and lebesgue measure @xmath30 ) .",
    "then @xmath14 is always feller , and it is strong feller if and only if the distribution of @xmath14 is absolutely continuous ( with respect to the lebesgue measure ) . if this is the case , assumption  [ assu : dual ] is satisfied : the dual of @xmath14 exists , and it is the reflected process , @xmath647 .",
    "assumption  [ assu : gen ] is always satisfied with @xmath648 .",
    "the lvy kernel of @xmath14 is translation - invariant , @xmath649 , where @xmath650 is the lvy measure of @xmath14 .",
    "therefore , assumption  [ assu : levy ] can be restated as follows : the lvy measure of @xmath14 is absolutely continuous , and its density function @xmath651 satisfies @xmath652 whenever @xmath139 , with constant @xmath653 . if , e.g. , @xmath651 is isotropic and radially non - increasing , then   is equivalent to @xmath654 being valid whenever @xmath655 , @xmath656 and @xmath657 .",
    "indeed , let us assume the latter condition . by radial monotonicity ,",
    "@xmath117 is locally bounded on @xmath658 from above and below by positive constants .",
    "therefore , @xmath659 exists such that @xmath660 if @xmath661 and @xmath657 .",
    "if follows that @xmath662 if @xmath663 and @xmath664 taking @xmath665 we obtain , as desired .",
    "finally , assumption  [ assu : green ] in many cases follows from estimates of the potential kernel @xmath666 , or , in the recurrent case , the @xmath4-potential kernel @xmath667 , see proposition  [ prop : green : pot ] .",
    "we conclude that boundary harnack inequality holds for a lvy process @xmath14 , provided that its lvy measure satisfies  , one - dimensional distributions of @xmath14 are absolutely continuous , and the green functions of balls satisfy assumption  [ assu : green ] .",
    "this class includes :    * subordinate brownian motions which are not compound poisson processes and have non - zero lvy measure density function satisfying @xmath668 if @xmath656 and @xmath657 ( for properties of these processes , see , e.g. , @xcite ) ; * ( possibly asymmetric ) lvy processes with non - degenerate brownian part and lvy measure satisfying  ; * ( possibly asymmetric ) strictly stable lvy processes , whose lvy measure is of the form @xmath669 for a function @xmath19 bounded from below and above by positive constants .",
    "scale - invariance depends on more accurate estimates .",
    "we give here some examples and directions .",
    "* for the class of strictly stable lvy processes just mentioned above , scale - invariance follows from the estimates of the transition density given in  ( * ? ? ?",
    "* theorem  1.1 ) and proposition  [ prop : green ] ; see also  @xcite and the references therein for related estimates in the symmetric ( but anisotropic ) case .",
    "* some lvy processes for which theorem",
    "[ th : bhi ] gives scale - invariant bhi are included in example  [ ex : stable - like ] ( stable - like lvy processes ) and example  [ ex : perturbations ] ( mixtures of isotropic stable processes , relativistic stable processes , etc . ) .",
    "* a non - scale - invariant case ( mixture of an isotropic stable process and the brownian motion ) is discussed in example  [ ex : brownian ] . *",
    "our results may be used to recover the recent scale - invariant bhi given in ( * ? ? ?",
    "* theorem  1.1 ) . more specifically , using our results and the first part of  @xcite , one can obtain scale - invariant bhi for the lvy processes considered therein ( isotropic lvy processes with the lvy measure comparable to that of a rather general subordinate brownian motion with some scaling properties ) , thus replacing the second part of @xcite and significantly simplifying the whole argument of @xcite .",
    "* similarly , the estimates given in  @xcite , combined with theorem  [ th : bhi ] , should give a compact proof of scale - invariant bhi for a class of subordinate brownian motions with lvy - khintchine exponent slowly varying at  @xmath670 .",
    "[ ex : stable - like ] let @xmath12 be a closed set in @xmath671 , and let @xmath30 be a measure on @xmath12 such that @xmath12 , with the euclidean distance , is an ahlfors regular @xmath583-space for some @xmath582 .",
    "for example , @xmath12 can be entire @xmath671 or the closure of an open set in @xmath671 ( with the lebesgue measure @xmath30 ; then @xmath672 ) .",
    "on the other hand , @xmath12 can be a fractal set , such as sierpiski gaskets ( @xmath673 ) or sierpiski carpets ( @xmath674 ) in @xmath675 , equipped with an appropriate hausdorff measure . by this assumption ,",
    "scaling property  [ it : reg ] is satisfied .",
    "let @xmath676 , and suppose that @xmath677 and @xmath678 this immediately gives assumption  [ assu : levy ] with scaling property  [ it : nu3 ] .    by  ( * ? ? ?",
    "* theorem  1 ) , there is a feller , strong feller , symmetric pure - jump hunt process @xmath14 with lvy kernel @xmath117 , and the continuous transition probability @xmath604 of @xmath14 satisfies   for some @xmath610 .",
    "assumption  [ assu : green ] and scaling property  [ it : green ] follow by proposition  [ prop : green ] . since @xmath14 is symmetric ( self - dual ) and has continuous transition densities , assumption  [ assu : dual ] is also satisfied .",
    "finally , we assume that assumption  [ assu : gen ] holds with scaling property  [ it : gen ] ( see below ) . under the above assumptions , scale - invariant boundary harnack inequality holds with some localization radius . when @xmath12 is unbounded , @xmath679 and scaling property  [ it : reg ] holds for all @xmath33 , then   holds for all @xmath56 and all @xmath151 , see  @xcite , and therefore we can take @xmath680 .",
    "we list some cases when assumption  [ assu : gen ] with scaling property  [ it : gen ] is known to hold true .    * when @xmath645 and @xmath580 is a function of @xmath681 , then @xmath14 is a symmetric lvy process and we can simply take @xmath648 . * more generally ,",
    "let @xmath645 , and assume that @xmath682 for a @xmath683 function @xmath684 .",
    "we claim that assumption  [ assu : gen ] with scaling property  [ it : gen ] holds for @xmath648 . indeed ,",
    "for @xmath685 let @xmath686 then @xmath687 is a symmetric pseudo - differential operator with appropriately smooth symbol , and by  ( * ? ? ?",
    "* theorem  5.7 ) , the closure of @xmath687 is the feller generator of a symmetric hunt process @xmath688 ( we omit the details ) .",
    "since the pure - jump feller processes @xmath14 and @xmath688 have equal lvy kernels , they are in fact equal processes , and hence the closure of @xmath687 is the feller generator of @xmath14 .",
    "assumption  [ assu : gen ] with @xmath648 follows , and scaling property  [ it : gen ] is a simple consequence of  .",
    "see also  @xcite . *",
    "when @xmath689 , @xmath12 is the closure of an open lipschitz set , and @xmath690 , then the desired condition is satisfied by @xmath648 ( see  ( * ? ? ?",
    "* theorem  6.1(i ) ) ) .",
    "* when @xmath691 , @xmath12 is the closure of an open set with @xmath692-smooth boundary for some @xmath693 , and @xmath690 , then one can take @xmath98 to be the class of @xmath694 functions with normal derivative vanishing everywhere on the boundary of @xmath12 ( see  ( * ? ? ?",
    "* theorem  6.1(ii ) ) ) .",
    "* for the case when @xmath14 is a subordinate diffusion on @xmath12 , see example  [ ex : subordinate ] . in this case ,",
    "when @xmath12 is a fractal set , one can even deal with @xmath4 greater than @xmath695 .",
    "note that an analytical proof of theorem  [ th : regexit ] discussed in remark  [ rem : dirichlet ] may lead to a generalization of this example , which would not require assumption  [ assu : gen ] .",
    "[ ex : subordinate ] suppose that @xmath29 is an ahlfors regular @xmath583-space for some @xmath582 .",
    "assume that the metric @xmath646 is uniformly equivalent to the shortest - path metric in @xmath12 .",
    "suppose that there is a diffusion process @xmath696 with a symmetric , continuous transition density @xmath697 satisfying the sub - gaussian bounds @xmath698 for all @xmath151 and @xmath699 ( @xmath700 when @xmath12 is unbounded ) .",
    "here @xmath701 is the _ walk dimension _ of the space @xmath12 .",
    "the existence of such a diffusion process @xmath696 is well - known when @xmath12 is a riemannian manifold ( @xmath702 ; see  @xcite ) , the @xmath703-dimensional sierpiski gasket ( @xmath704 ; see  @xcite ) , more general nested fractals  @xcite , or the sierpiski carpets  @xcite ; see  @xcite for more information .",
    "let @xmath705 and let @xmath14 be the stable - like process obtained by subordination of @xmath696 with the @xmath706-stable subordinator @xmath707 , @xmath708 .",
    "these processes were first studied in  @xcite . by the subordination formula , the transition density estimate   holds for some @xmath610 ( if @xmath12 is unbounded , then it was proved in  @xcite that we can take @xmath709 ) .    since @xmath14 is symmetric and has continuous transition densities , assumption  [ assu : dual ] is clearly satisfied .",
    "the lvy kernel of @xmath14 satisfies @xmath710 , see  @xcite , and assumption  [ assu : levy ] with scaling property  [ it : nu3 ] follows .",
    "assumption  [ assu : green ] and scaling property  [ it : green ] follow from the transition density estimate   by proposition  [ prop : green ] ; see also  ( * ? ? ?",
    "* lemmas  5.3 and  5.6 )",
    ". finally , assumption  [ assu : gen ] with scaling property  [ it : gen ] follows by the construction of  ( * ? ? ?",
    "* section  2 ) . roughly speaking , the method of  @xcite yields smooth bump functions in the domain of the generator of the diffusion @xmath696 with appropriate scaling . by the subordination formula , these bump functions are in the domain of @xmath58 , and the constants scale appropriately . since there are some nontrivial issues related to the construction , we repeat the construction with all details in appendix  [ sec : app ] . by corollary  [ cor : smoothbump ] there , assumption  [ assu : gen ] is satisfied with scaling property  [ it : gen ] .",
    "we conclude that scale - invariant boundary harnack inequality for @xmath14 holds in the full range of @xmath705 .",
    "noteworthy , we obtain a regularity result also for @xmath711 , when lipshitz functions no longer belong to the domain of the dirichlet form of @xmath14 .",
    "this example can be extended in various directions . instead of taking @xmath707 the @xmath706-stable subordinator , one can consider a subordinator @xmath707 whose laplace exponent @xmath354 is a complete bernstein function regularly varying of order @xmath706 ( @xmath705 ) at infinity .",
    "such subordinators have no drift , and the lvy measure with completely monotone density function , regularly varying of order @xmath712 at @xmath713 .",
    "their potential kernel is regularly varying of order @xmath714 at @xmath713 .",
    "we refer the reader to  @xcite for more information about subordination , complete bernstein functions and regular variation . by the subordination formula , following the method applied for the euclidean case @xmath645 in  @xcite",
    ", one can obtain two - sided estimates for the lvy kernel @xmath580 and the potential kernel @xmath715 in terms of @xmath354 , at least when @xmath12 is unbounded and @xmath716 .",
    "these estimates are sufficient to prove the scale - invariant boundary harnack inequality .",
    "similar methods should be applicable also when @xmath14 is recurrent ( that is , @xmath12 is bounded , or @xmath717 ) . in this case , estimates of @xmath715 need to be replaced by estimates of the @xmath718-potential kernel @xmath719 .",
    "another interesting directions are the case of slowly varying @xmath354 , which corresponds to @xmath72 , and , on the other hand , the case of pure - jump processes with @xmath354 regularly varying of order @xmath498 ( that is , @xmath720 ) .",
    "finally , one can perturb processes considered above , in a similar way as in the next example .",
    "[ ex : perturbations ] let @xmath645 , @xmath646 be the euclidean distance , @xmath30 be the lebesgue measure , and @xmath676 .",
    "suppose that @xmath721 is a lvy kernel of a hunt process @xmath688 considered in example  [ ex : stable - like ] , and @xmath687 is the corresponding feller generator .",
    "for example , @xmath721 can be any function of @xmath722 satisfying  .",
    "in this example we consider a perturbation @xmath580 of the kernel @xmath721 .",
    "although a more general construction is feasible , we are satisfied with the following setting .",
    "let @xmath723 , where @xmath724 is chosen so that @xmath580 satisfies the scaling property  [ it : nu3 ] , @xmath724 and @xmath725 are kernels of bounded operators on @xmath726 , and @xmath727 the last assumption guarantees that @xmath30 is an excessive ( in fact , invariant ) measure for the process @xmath14 defined below .",
    "the formula @xmath728 defines a bounded linear operator on @xmath726 , and @xmath729 ( defined on the domain of @xmath687 ) has the positive maximum property . by a standard perturbation argument",
    ", @xmath58 is the feller generator of a hunt process @xmath14 , and @xmath580 is the lvy kernel of @xmath14 . the process @xmath73 and its feller generator @xmath730 are constructed in a similar manner , using the feller generator of the dual of @xmath688 and the kernel @xmath731 .",
    "it is easy to see that @xmath732 for @xmath733 , from which it follows that @xmath73 is indeed the dual of @xmath14 .    the transition density of @xmath688 satisfies   ( see example  [ ex : stable - like ] ) .",
    "the process @xmath14 can be constructed probabilistically using @xmath688 and meyer s method of adding and removing jumps .",
    "hence , by  ( * ? ? ?",
    "* lemma  3.6 ) and  ( * ? ? ?",
    "* lemma  3.1(c ) ) , the transition density of @xmath14 exists and also satisfies   for smaller @xmath610 ( see also  ( * ? ? ?",
    "* proposition  2.1 ) ) .",
    "it follows that assumption  [ assu : dual ] is satisfied .",
    "assumption  [ assu : gen ] holds with @xmath648 , and scaling property  [ it : gen ] ( with finite @xmath147 ) follows from the @xmath4-stable - like scaling of @xmath687 and boundedness of @xmath734 . since we assumed that  [ it : nu3 ] holds true ,",
    "assumption  [ assu : levy ] is satisfied with scaling properties  [ it : nu ] , [ it : nu2 ] .",
    "assumption  [ assu : green ] and scaling properties  [ it : tau ] , [ it : green ] follow from transition density estimate   by proposition  [ prop : green ] .",
    "hence , scale - invariant boundary harnack inequality holds true for @xmath14 .",
    "the above setting includes mixtures of isotropic stable processes ( lvy processes generated by @xmath735 with @xmath736 and @xmath542 ) and relativistic stable processes ( lvy processes generated by @xmath737 with @xmath738 ) .",
    "also , the dependence of constants on the parameters @xmath24 , @xmath739 , @xmath30 can be easily tracked .",
    "since the perturbation @xmath724 can be asymmetric , many non - symmetric processes are included .",
    "finally , this example can be adapted to the setting of ahlfors - regular @xmath583-sets in @xmath671 , as in example  [ ex : stable - like ] .",
    "[ ex : schrodinger ] suppose that the assumptions for the boundary harnack inequality in theorem  [ th : bhi ] are satisfied .",
    "let @xmath740 be an open set in @xmath12 .",
    "let @xmath350 be a strong right - continuous multiplicative functional quasi - left continuous on @xmath741 , for which all points of @xmath740 are permanent , and such that @xmath539 for @xmath742 .",
    "finally , let @xmath743 be the subprocess corresponding to @xmath350 ( in a similar way as in section  [ sec : reg ] ; see  @xcite for definitions ) .",
    "then @xmath743 is a hunt process on @xmath740 , uniquely determined by the relation @xmath744 for any @xmath745 and @xmath746 .",
    "assume that @xmath350 is a continuous function of @xmath747 .",
    "we claim that in this case the lvy kernel @xmath748 of @xmath743 is again given by @xmath580 , restricted to @xmath749 . indeed , by formula   of lemma  [ lem : psigen ] , for @xmath746 and @xmath123 vanishing in a neighborhood of @xmath293 ,",
    "we have @xmath750 when divided by @xmath390 , this converges ( for a fixed @xmath293 ) to @xmath751 as @xmath71 .",
    "hence , @xmath752 . by an approximation argument",
    ", this holds for any @xmath753 vanishing in a neighborhood of @xmath293 , proving our claim .",
    "( note that , however , in general , functions in @xmath59 need not belong to the domain of the generator of @xmath743 , even if @xmath754 . )    we remark that many such functionals @xmath350 are related to schrdinger potentials @xmath433 : for a nonnegative function @xmath433 , we have @xmath755 for @xmath756 , see  @xcite .",
    "a similar construction was used in section  [ sec : reg ] for a particular choice of @xmath433 . in some applications ,",
    "the potential @xmath433 can take negative values , the case not covered by this example .",
    "let @xmath233 be an open set . by the definition of a subharmonic function ,",
    "a nonnegative function @xmath19 regular subharmonic on @xmath757 with respect to the process @xmath743 , extended by @xmath105 for @xmath758 , is also regular subharmonic in @xmath13 with respect to @xmath14 .",
    "hence , the hypothesis of theorem  [ th : regexit ] holds for @xmath743 with the same constant @xmath311 .",
    "of course , one needs to replace the sets in the statement of theorem  [ th : regexit ] by their intersections with @xmath740 .",
    "we claim that also lemma  [ lem : escape ] holds for @xmath743 with the same constant . indeed , with the definitions of the proof of lemma  [ lem :",
    "escape ] and @xmath759 , for @xmath760 we have @xmath761 by formula   of lemma  [ lem : psigen ] , @xmath762 } f(x_t ) d m_t \\right ) } .\\ ] ] the second summand on the right hand side is nonpositive .",
    "it follows that , @xmath763 as desired .    in lemma  [ lem : factorization ] ,",
    "only the estimates of the lvy measure and mean exit time are used .",
    "therefore , also lemma  [ lem : factorization ] holds for the process @xmath743 with unaltered constants . in a similar way , the proof of theorem  [ th : bhi ] works for the process @xmath743 without modifications .",
    "we conclude that the boundary harnack inequality holds for @xmath743 with the same constants . for convenience ,",
    "we state this result as a separate theorem .",
    "[ th : sub ] suppose that assumptions  [ assu : dual ] , [ assu : gen ] , [ assu : levy ] and  [ assu : green ] hold true .",
    "let @xmath740 be an open subset of @xmath12 , and let @xmath743 be a subprocess of @xmath14 , with state space @xmath740 , corresponding to a strong right - continuous multiplicative functional for @xmath14 , continuous before @xmath14 hits @xmath764 , vanishing after that time , and quasi - left continuous on @xmath741 .",
    "then the boundary harnack inequality holds true for the process @xmath743 with the same constant @xmath313 given by  .",
    "more precisely , if @xmath8 , @xmath9 , @xmath10 is open , @xmath11 are nonnegative regular harmonic functions in @xmath757 ( with respect to the process @xmath743 ) , and @xmath11 vanish in @xmath765 , then we have @xmath766 where @xmath16 does not depend on @xmath350 .",
    "we remark that the continuity assumption for @xmath350 is essential .",
    "if , for example , @xmath350 is equal to @xmath498 until the first jump larger than @xmath498 , and then @xmath713 , the boundary harnack inequality typically does not hold , by an argument similar to one in example  [ ex : truncated ] below .",
    "[ ex : censored ] let @xmath767 be open and let @xmath12 be the closure of @xmath740 in @xmath671 .",
    "suppose that @xmath12 satisfies property  [ it : reg ] .",
    "let @xmath768 .",
    "as in example  [ ex : stable - like ] , under suitable assumptions on @xmath12 , there is a stable - like process @xmath14 with the lvy kernel @xmath580 , and scale - invariant bhi holds for @xmath14 . in  @xcite ,",
    "the process @xmath14 is called actively reflected @xmath4-stable process in @xmath12 , and the process @xmath769 , obtained from @xmath14 by killing it upon hitting @xmath764 , is named censored @xmath4-stable process in @xmath740 ( see  ( * ? ? ? * remark  2.1 ) ) . clearly , the boundary harnack inequality for @xmath769 is the special case of the boundary harnack inequality for @xmath14 , corresponding to open sets @xmath13 contained in @xmath740 .",
    "( note that this is in fact a special case of theorem  [ th : sub ] , with @xmath770 for @xmath756 . )",
    "hence , we have scale - invariant bhi for the actively reflected @xmath4-stable process @xmath14 and the censored @xmath4-stable process @xmath769 , whenever @xmath740 is a lipschitz set in the case @xmath689 , and @xmath740 is an open set with @xmath692-smooth boundary for some @xmath693 in the case @xmath691 .",
    "the above extends the results of  @xcite .",
    "[ ex : gradient ] let @xmath771 .",
    "if @xmath772 is bounded and differentiable , partial derivatives of @xmath773 are bounded , and @xmath774 , then the process @xmath14 generated by @xmath775 , and the process @xmath73 generated by @xmath776 are mutually dual .",
    "such processes are considered in the recent paper  @xcite .",
    "the lvy kernels of @xmath14 and @xmath73 are the same as that of the isotropic @xmath4-stable lvy process generated by @xmath777 , see  @xcite .",
    "furthermore , @xmath648 is contained in the domains of @xmath58 and @xmath730 .",
    "therefore , a scale - invariant ( with finite @xmath147 ) boundary harnack inequality holds for the process @xmath14 .",
    "we conclude this article with some negative or partially negative examples .",
    "[ ex : brownian ] let @xmath645 , @xmath646 be the euclidean distance , @xmath30 be the lebesgue measure , and @xmath676 .",
    "let @xmath14 be the sum of two independent processes , the brownian motion and the isotropic @xmath4-stable lvy process .",
    "that is , @xmath14 is the lvy process with generator @xmath778 .",
    "clearly , @xmath14 is symmetric and has transition densities , so assumption  [ assu : dual ] is satisfied .",
    "furthermore , @xmath59 contains @xmath694 , and hence assumption  [ assu : gen ] is satisfied with @xmath695-stable - like scaling : the property  [ it : gen ] holds with @xmath4 replaced by @xmath695 . on the other hand ,",
    "assumption  [ assu : levy ] clearly holds with @xmath4-stable - like scaling  [ it : nu3 ] .",
    "furthermore , detailed estimates for the transition density of @xmath14 can be established ( @xcite ) , from which assumption  [ assu : green ] follows as in proposition  [ prop : green ] , with @xmath695-stable scaling .",
    "it follows that boundary harnack inequality holds despite the diffusion component .",
    "however , the constant @xmath643 is not bounded when , for example , @xmath779 and @xmath780 .",
    "this is a typical behavior for processes comprising both jump and diffusion part , and for general open sets one can not expect a scale - invariant result : the boundary harnack inequality in the form given in  [ it : bhi ] does not hold for the brownian motion without some regularity assumptions on the boundary of @xmath13 , cf .",
    "@xcite . on the other hand ,",
    "the scale - invariant boundary harnack inequality for @xmath14 in more smooth domains was established in  @xcite .",
    "[ ex : truncated ] this example shows why assumption  [ assu : levy ] is essential for the boundary harnack inequality in the form given in  [ it : bhi ] .",
    "consider the truncated isotropic @xmath4-stable lvy process @xmath14 in @xmath645 , @xmath676 , @xmath781 .",
    "this is a pure - jump lvy process with lvy kernel @xmath782 .",
    "clearly , assumptions  [ assu : dual ] , [ assu : gen ] and  [ assu : green ] , as well as formula  , hold true with @xmath4-stable - like scaling and @xmath783 , but assumption  [ assu : levy ] is violated .",
    "we examine two specific harmonic functions .",
    "let @xmath784 be a vector in @xmath785 with @xmath786 , let @xmath787 be a small number , and define @xmath788 and @xmath789 , where @xmath790 are arbitrary points satisfying @xmath791 .",
    "let @xmath792 , @xmath793 , @xmath794 , and let @xmath795 .",
    "suppose that @xmath796 . by",
    ", we have @xmath797 when @xmath798 , then , again by  , @xmath799 similar estimates hold true for @xmath800 .",
    "it follows that @xmath801 this ratio can be arbitrarily small when @xmath802 , and therefore  [ it : bhi ] can not hold for truncated stable process uniformly with respect to the domain .",
    "we remark that by an appropriate modification of the above example , one can even construct a single domain ( an infinite union of balls ) for which  [ it : bhi ] is false .",
    "also , modifications of the above example for other truncated processes , or for processes with super - exponential decay of the density of the lvy measure can be given .",
    "on the other hand , if the regular harmonic functions @xmath19 and @xmath188 ( of the truncated @xmath4-stable process @xmath14 ) vanish outside a unit ball , then clearly @xmath19 and @xmath188 are harmonic in @xmath13 also with respect to the standard ( that is , non - truncated ) isotropic @xmath4-stable process in @xmath671 .",
    "therefore , the boundary harnack inequality actually holds true for such functions .",
    "a different version of boundary harnack inequality was proved for @xmath14 under some regularity assumptions on the domain of harmonicity in  @xcite .",
    "in this part we repeat the construction of smooth bump functions of  @xcite .",
    "we adopt the setting of example  [ ex : subordinate ] : @xmath696 is a diffusion process on an ahlfors - regular @xmath583-space @xmath12 , the transition semigroup @xmath803 of @xmath696 satisfies sub - gaussian bounds  , and @xmath14 is defined to be the process @xmath696 subordinated by an independent @xmath804-stable subordinator , @xmath705 .",
    "the generator of @xmath696 serves as the ( neumann ) laplacian @xmath0 on @xmath12 , and @xmath803 is the heat semigroup .",
    "let @xmath805 for some @xmath56 and @xmath806 .",
    "one of the main results of  @xcite , theorem  2.2 , states that given any compact @xmath100 and @xmath570 , there is a function @xmath19 such that @xmath807 for all @xmath808 , @xmath809 on @xmath100 and @xmath105 when @xmath810 .",
    "there are at least three issues when one tries to apply this result in our setting .",
    "first , theorem  2.2 in  @xcite is given under the assumption that the spectral gap of @xmath0 is positive .",
    "however , this assumption is used only in the proof of lemma  2.6 , which contains a flaw : positivity of the spectral gap @xmath718 does not imply the inequality @xmath811 ( see line  3 on page  1769 and line  12 on page  1773 in  @xcite ) .",
    "this issue has been resolved by the authors of  @xcite in an unpublished note , containing a corrected version of the proof of lemma  2.6 .",
    "the new argument does not involve the condition on the spectral gap , which therefore turns out to be superfluous . for future reference",
    ", we provide the corrected version of the proof of lemma  2.6 below .",
    "second , to get assumption  [ assu : gen ] , we need to apply the above theorem with @xmath812 for @xmath104 , where @xmath805 .",
    "this condition is satisfied when @xmath813 for all @xmath32 .",
    "however , such a function @xmath188 is in @xmath814 only when @xmath30 is a finite measure , and the general case is not covered by  @xcite .",
    "for that reason , we choose to repeat the construction of  @xcite in @xmath815 ( instead of @xmath814 ) setting .",
    "finally , for a scale - invariant boundary harnack inequality , we need an upper bound for @xmath816 with explicit dependence on scale , that is , explicit in @xmath817 and the size ( e.g. the diameter ) of @xmath100 . such properties of the estimates are irrelevant in  @xcite , but it turns out that they can be obtained by carefully following the proof of theorem  2.2 in  @xcite .    for the above reasons , we decide to give a complete proof of an @xmath815 version of theorem  2.2 in  @xcite .",
    "however , it should be emphasized that method was completely developed in  @xcite .",
    "although we only need the result for @xmath818 for all @xmath32 , for future reference we consider the general case .",
    "[ th : smoothbump ] suppose that @xmath819 is a compact set , @xmath820 and @xmath821 for some @xmath822 . then there is a function @xmath823 such that @xmath809 for @xmath104 , @xmath105 when @xmath810 , and @xmath807 for any @xmath808 .",
    "furthermore , the @xmath815 norm of @xmath19 is bounded by the @xmath815 norm of @xmath188 , @xmath19 is nonnegative if @xmath188 is nonnegative , and for all @xmath808 we have @xmath824 where @xmath825 .",
    "we divide the argument into five steps .",
    "all constants in this proof may depend not only on the parameters given in parentheses , but also on the space @xmath12 and the process @xmath696 . since we never refer to the semigroup of the subordinate process @xmath14 , in this proof for simplicity we write @xmath826 .",
    "furthermore , also in this proof only , we extend @xmath0 to the @xmath815 generator of @xmath55 ( recall that originally @xmath0 was defined as the @xmath57 generator ) , and denote by @xmath827 the @xmath814 generator of @xmath55 , that is , the generator of the semigroup of operators @xmath55 acting on @xmath814 . clearly , @xmath828",
    "@xmath829 whenever @xmath830 .",
    "_ we begin with some general estimates . by the spectral theorem and the inequality @xmath831 , for any @xmath832 and @xmath833",
    ", we have @xmath834 , and @xmath835 furthermore , by sub - gaussian estimates  , @xmath836 .",
    "hence , @xmath837 we find that @xmath838 as @xmath839 .",
    "it follows that @xmath840 , with @xmath841 . by a similar argument , @xmath842 for any @xmath833 , and @xmath843 sub - gaussian estimate   and ahlfors regularity of @xmath12",
    "also give the following estimate : for any set @xmath46 , any @xmath570 and any @xmath823 or @xmath844 vanishing in the @xmath817-neighborhood of @xmath286 , we have @xmath845 where @xmath846 in particular , given any @xmath368 and @xmath570 it is possible to choose a strictly increasing sequence @xmath847 convergent to @xmath366 , with @xmath848 , such that if @xmath849 ( @xmath850 ) , then @xmath851 for any @xmath570 , @xmath833 . for example , one can take @xmath852 .",
    "note , however , that the above series would diverge if @xmath853 decreased either too slowly or too rapidly .    _ step 2 .",
    "_ let @xmath822 , @xmath820 , and @xmath854 , as in the statement of the theorem .",
    "following  @xcite , for @xmath636 we define @xmath855 and @xmath856 .",
    "furthermore , let @xmath857 and @xmath853 be chosen as in step  1 .",
    "for @xmath850 we define @xmath858 below we prove that @xmath859 converges to a function @xmath19 with the desired properties .",
    "_ by induction , @xmath860 for any @xmath636 . for @xmath850",
    "we have @xmath861 for @xmath862 , and @xmath863 .",
    "hence , @xmath864 where @xmath865 is as in step  1 ( cf .",
    "* lemma  2.3 ) ) .",
    "also , @xmath866 vanishes on @xmath867 , @xmath868 vanishes on @xmath869 , and @xmath870 , so that @xmath871 and ( using @xmath872 ) @xmath873 hence , using also @xmath874 , we obtain ( cf .",
    "* lemma  2.5 ) ) @xmath875    _ step 4 .",
    "_ we follow the corrected version of the proof of  ( * ? ?",
    "* lemma  2.6 ) .",
    "let @xmath833 .",
    "for @xmath850 we have @xmath876 observe that the results of step  1 and the equality @xmath877 for @xmath878 give @xmath879 hence , by   and  , @xmath880 it follows that the sequence @xmath881 converges in @xmath815 as @xmath882 for every @xmath833 .",
    "therefore , if @xmath883 , then for all @xmath833 we have @xmath807 and @xmath884 as desired .",
    "_ by the definition of @xmath866 , for @xmath850 we have @xmath885 it follows that @xmath886 the right hand side converges to @xmath713 as @xmath882 . hence , @xmath887 for @xmath104 .",
    "furthermore , @xmath860 , and therefore also @xmath888 . finally , if @xmath889 , then @xmath890 for all @xmath850 , and so @xmath68 .",
    "[ cor : smoothcutoff ] suppose that @xmath819 is a compact set and @xmath570 .",
    "then there is a function @xmath823 such that @xmath103 for @xmath104 , @xmath105 when @xmath810 , and @xmath807 for any @xmath808 . furthermore , @xmath107 for all @xmath32 , and for all @xmath808 we have @xmath892 where @xmath893",
    ".    in general , the boundary of the set @xmath894 might be highly irregular .",
    "however , when we relax the smoothness hypothesis on @xmath19 , we can require @xmath19 to be positive on an arbitrary given open set .",
    "[ prop : smoothcutoff ] suppose that @xmath819 is a compact set , @xmath570 and @xmath895 .",
    "then there is a function @xmath823 such that @xmath103 for @xmath104 , @xmath105 when @xmath810 , and @xmath807 for @xmath896 .",
    "furthermore , @xmath107 for all @xmath32 , the boundary of the set @xmath894 has zero @xmath30 measure , and for all @xmath896 we have @xmath897 where @xmath898 .",
    "let @xmath899 be the function constructed in theorem  [ th : smoothbump ] for @xmath900 , and denote by @xmath433 an arbitrary open set with the following properties : @xmath901 , and @xmath331 .",
    "for example , one can take @xmath902 for a suitable @xmath903 .",
    "let @xmath904 , @xmath905 , be a family of balls contained in @xmath906 such that twice smaller balls @xmath907 form a countable covering of @xmath906 , and let @xmath908 be the function as in corollary  [ cor : smoothcutoff ] , equal to @xmath498 on @xmath907 and vanishing on @xmath909 . finally , choose @xmath910 so that for @xmath911 , @xmath912 then @xmath913 has all the desired properties , with @xmath817 replaced by @xmath914 .",
    "given any compact subset @xmath100 of an open set @xmath233 , choose @xmath570 such that @xmath915 . since @xmath916 , the function @xmath19 given in proposition  [ prop : smoothcutoff ] ( for @xmath917 ) satisfies all conditions of assumption  [ assu : gen ] .",
    "furthermore , if @xmath918 is the lvy measure of the subordinator @xmath707 , then @xmath919 note that @xmath920 .",
    "furthermore , @xmath921 ( with @xmath922 ) , and @xmath923 therefore , @xmath924 let @xmath139 , and take @xmath925 , @xmath926 , @xmath927 .",
    "we see that @xmath928 this gives half of the @xmath4-stable scaling property  [ it : gen ] , and the other half is proved in a similar manner .",
    "we express our gratitude to moritz kamann for many discussions on the subject of supremum bounds for subharmonic functions .",
    "we thank tomasz grzywny for pointing out errors in the preliminary version of the article .",
    "we also thank luke rogers for providing us with a new proof of theorem  2.2 in  @xcite .",
    "we thank the referee for insightful suggestions .",
    "r.  f. bass and k.  burdzy . a probabilistic proof of the boundary harnack principle . in _",
    "seminar on stochastic processes , 1989 ( san diego , ca , 1989 ) _ , volume  18 of _ progr .",
    "_ , pages 116 .",
    "birkhuser boston , boston , ma , 1990 .                                                      c.  dellacherie and p",
    "meyer . , volume 151 of _ north - holland mathematics studies_. north - holland publishing co. , amsterdam , 1988 .",
    "potential theory for discrete and continuous semigroups , translated from the french by j. norris .",
    "e.  b. dynkin . , volume 122 of _ translated with the authorization and assistance of the author by j. fabius , v. greenberg , a. maitra , g. majone .",
    "die grundlehren der mathematischen wissenschaften , bnde 121_. academic press inc . , publishers , new york , 1965 .",
    "w.  hansen .",
    "three views on potential theory .",
    "lecture notes for a course given at charles university ( prague ) in 2008 .",
    "available at http://www.karlin.mff.cuni.cz/~hansen/lecture/course-07012009.pdf , 2009 .",
    "d.  s. jerison and c.  e. kenig .",
    "boundary value problems on lipschitz domains . in _ studies in partial differential",
    ", volume  23 of _ maa stud .",
    "_ , pages 168 .",
    "america , washington , dc , 1982 .",
    "p.  kim , r.  song , and z.  vondraek .",
    "potential theory of subordinate brownian motions revisited , stochastic analysis and applications to finance . in _ in honour of jia - an yan , ( eds)_. world scientific review volume , 2012 ."
  ],
  "abstract_text": [
    "<S> we prove a boundary harnack inequality for jump - type markov processes on metric measure state spaces , under comparability estimates of the jump kernel and urysohn - type property of the domain of the generator of the process . </S>",
    "<S> the result holds for positive harmonic functions in arbitrary open sets . </S>",
    "<S> it applies , e.g. , to many subordinate brownian motions , lvy processes with and without continuous part , stable - like and censored stable processes , jump processes on fractals , and rather general schrdinger , drift and jump perturbations of such processes . </S>"
  ]
}