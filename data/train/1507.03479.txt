{
  "article_text": [
    "accurate and reliable prediction of future states of the atmosphere is the most important objective of weather prediction .",
    "these forecasts are issued on the basis of observational data and numerical weather prediction ( nwp ) models , which are capable to simulate the atmospheric motions taking into account the physical governing laws of the atmosphere and the connected spheres ( typically sea or land surface ) .",
    "the nwp models consist of sets of partial differential equations which have only numerical solutions and strongly depend on initial conditions . in order to reduce the uncertainties caused by the possibly unreliable initial conditions and the numerical weather prediction process itself",
    ", one can run the models with various initial conditions resulting in a forecast ensemble @xcite . using a forecast ensemble not only the classical point forecasts ( ensemble median or mean )",
    "can be obtained , but also an estimate of the distribution of the future weather variable , which allows probabilistic forecasting @xcite .",
    "the first operational implementation of the ensemble prediction method dates back to the nineties @xcite and in the last twenty years it became a widely used technique in the meteorological community .",
    "recently all major national meteorological services operate their own ensemble prediction systems ( epss ) , see , e.g. , the pearp eps of mteo france @xcite or the cosmo - de eps of the german meteorological service ( dwd ; * ? ? ?",
    "* ) , whereas the most well - known organization issuing ensemble forecasts is the european centre for medium - range weather forecasts @xcite",
    ". however , as it has been observed with several operational epss ( see , e.g. , * ? ? ?",
    "* ) , the forecast ensemble is usually underdispersive and consequently badly calibrated .",
    "one possible improvement area of the ensemble forecasts is the statistical post - processing of the ensemble in order to transform the original ensemble member - based probability density function ( pdf ) into a more reliable and realistic one",
    ".    from the various post - processing techniques ( for an overview see , e.g. , * ? ? ?",
    "* ; * ? ? ?",
    "* ) probably the most popular approaches are the bayesian model averaging ( bma ; * ? ? ?",
    "* ) and the ensemble model output statistics ( emos ) or non - homogeneous regression @xcite .",
    "these methods are partially implemented in the ensemblebma and ensemblemos packages of r @xcite and both approaches provide estimates of the distributions of the predictable weather quantities .    in the case of the bma",
    "the predictive probability density function ( pdf ) of a future weather quantity is a weighted mixture of individual pdfs corresponding to the members of the ensemble , where the weights express the relative performance of the ensemble members during a given training period .",
    "the bma models of various weather quantities differ only in the pdfs of the mixture components . for temperature and sea level pressure a normal distribution @xcite , for wind speed a gamma @xcite or a truncated normal distribution @xcite , whereas for surface wind direction a von mises distribution @xcite is suggested .",
    "the emos predictive pdf uses a single parametric distribution with parameters depending on the ensemble members .",
    "emos models have already been developed for calibrating ensemble forecasts of temperature and sea level pressure @xcite , wind speed @xcite and precipitation @xcite .    besides the calibration of univariate weather quantities recently an increasing interest has appeared in modeling correlations between the different weather variables . in the special case of wind vectors",
    "@xcite suggested an adaptive calibration technique , whereas @xcite and @xcite introduced bivariate emos and bma models , respectively .",
    "further , @xcite developed a general approach where after univariate calibration of the weather variables the component predictive pdfs are joined into a multivariate predictive density with the help of a gaussian copula .",
    "another idea appears in the ensemble copula coupling ( ecc ) method @xcite where after univariate calibration the rank order information in the raw ensemble is used to restore correlations .",
    "finally , @xcite developed a bma model for joint post - processing of ensemble forecasts of wind speed and temperature .    in the present paper",
    "we introduce an emos model for joint calibration of wind speed and temperature which is based on a truncated normal distribution with cut - off at zero in its first ( wind ) coordinate .",
    "the method is tested on the ensemble forecasts of wind speed and temperature of the eight - member university of washington mesoscale ensemble ( uwme ; * ? ? ?",
    "* ) and of the limited area model eps of the hungarian meteorological service ( hms ) called aladin - huneps @xcite .",
    "the performance of the emos model is compared to the forecasting skills of the previously investigated bma method of @xcite and to the gaussian copula approach of @xcite , where the margins of the multivariate predictive distribution are estimated by emos .",
    "the eight - member university of washington mesoscale ensemble covers the pacific northwest region of western north america providing forecasts on a 12 km grid .",
    "the ensemble members are obtained from different runs of the fifth generation pennsylvania state university  national center for atmospheric research mesoscale model ( psu - ncar mm5 ) with initial conditions from different sources @xcite .",
    "our data base ( identical to the one used in @xcite ) contains ensembles of 48-hour forecasts and corresponding validation observations of 10 meter maximum wind speed ( maximum of the hourly instantaneous wind speeds over the previous twelve hours , given in m / s , see , e.g. , @xcite ) and 2 meter minimum temperature ( given in k ) for 152 stations in the automated surface observing network @xcite in the us states of washington , oregon , idaho , california and nevada for calendar years 2007 and 2008 .",
    "the forecasts are initialized at 0 utc ( 5 pm local time when daylight saving time ( dst ) is in use and 4 pm otherwise ) and the generation of the ensemble implies that its members are not exchangeable . in the present study",
    "we investigate only forecasts for calendar year 2008 with additional data from 2007 used for parameter estimation . after removing days and locations with missing data",
    ", 90 stations remained where the number of days for which forecasts and validating observations are available varies between 141 and 290 .",
    "the aladin - huneps system of the hms covers a large part of continental europe with a horizontal resolution of 8 km and it is obtained by dynamical downscaling ( by the aladin limited area model ) of the global arpege based pearp system of mto france @xcite .",
    "the ensemble consists of 11 members , 10 initialized from perturbed initial conditions and one control member from the unperturbed analysis , implying that the ensemble contains groups of exchangeable forecasts .",
    "the data base contains 11 member ensembles of 42-hour forecasts for 10 meter instantaneous wind speed ( given in m / s ) and 2 meter temperature ( given in k ) for 10 major cities in hungary ( miskolc , szombathely , gyr , budapest , debrecen , nyregyhza , nagykanizsa , pcs , kecskemt , szeged ) produced by the aladin - huneps system of the hms , together with the corresponding validating observations for the one - year period between april 1 , 2012 and march 31 , 2013 and for the period from october 1 , 2010 to march 25 , 2011 .",
    "the forecasts are initialized at 18 utc ( 8 pm local time when dst operates and 7 pm otherwise ) .",
    "the data sets are fairly complete since there are only six and three days , respectively , when no forecasts are available and these days have been excluded from the analysis .",
    "as mentioned in the introduction , the emos predictive pdf of a weather quantity ( vector )  @xmath0  is a single parametric density function where the parameters depend on the ensemble members . for temperature and pressure a normal distribution",
    "can be fit reasonably well @xcite , while for wind vectors a bivariate normal distribution can be applied @xcite . however , for modeling non - negative quantities such as wind speed , a skewed distribution is required .",
    "@xcite introduced an emos model based on truncated normal distribution with cut - off at zero , but emos models utilizing a generalized extreme value distribution @xcite and a log - normal distribution @xcite have also been tested .",
    "the emos models of @xcite and @xcite suggest the idea of joint modeling wind speed and temperature using a bivariate normal distribution with first ( wind ) coordinate truncated from below at zero .",
    "this particular distribution has already been applied in the bivariate bma model of @xcite .",
    "once the predictive density is given , its mean or median can be taken as a point forecast for  @xmath0 .  in one dimension",
    "the definition of the latter is obvious , whereas for a @xmath1-dimensional cumulative distribution function ( cdf )  @xmath2  a multivariate median is a vector minimizing the function @xmath3 where  @xmath4  denotes the euclidean norm . if  @xmath2  is not concentrated on a line in  @xmath5  then the median is unique @xcite .",
    "denote by  @xmath6  the ensemble of distinguishable forecast vectors of wind speed and temperature for a given location and time .",
    "this means that each ensemble member can be identified and tracked , which holds for example for the uwme ( see section [ subs : subs2.1 ] ) .",
    "however , most of the currently used ensemble prediction systems provide ensembles where at least some members are statistically indistinguishable .",
    "such ensemble systems are simulating uncertainties by perturbing the initial conditions , and they usually have a control member ( the one without any perturbation ) , whereas the remaining ensemble members form one or two exchangeable groups .",
    "this is the case , e.g. , for the 51 member ecmwf ensemble @xcite or for the aladin - huneps ensemble described in section [ subs : subs2.2 ] .    in what follows ,",
    "if we have  @xmath7  ensemble members divided into  @xmath8  exchangeable groups , where the  @xmath9th  group contains  @xmath10  ensemble members ( @xmath11 ) ,  notation  @xmath12  will be used for the @xmath13th member of the @xmath9th group .",
    "denote by  @xmath14  the bivariate normal distribution with location vector  @xmath15 ,  scale matrix  @xmath16 ,  and first coordinate truncated from below at zero .",
    "let @xmath17 if   @xmath16  is regular , then the pdf of this distribution is @xmath18 where  @xmath19  denotes the cdf of the standard normal distribution and by  @xmath20  we denote the indicator function of a set  @xmath21 .",
    "short calculation shows ( see , e.g. , * ? ? ?",
    "* ) , that the mean vector  @xmath22  and covariance matrix  @xmath23  of  @xmath14  are @xmath24 respectively , where  @xmath25  denotes the pdf of the standard normal distribution .",
    "the proposed emos predictive distribution of wind speed and temperature is @xmath26 with @xmath27 where  @xmath28  denotes the ensemble mean vector .",
    "parameter vector  @xmath29  and two - by - two real parameter matrices @xmath30  and  @xmath31  of model , where @xmath32 is assumed to be symmetric and non - negative definite , can be estimated from the training data consisting of ensemble members and verifying observations from the preceding  @xmath33  days , by optimizing with respect to the mean logarithmic score , i.e. , the negative logarithm of the predictive pdf evaluated at the verifying observation @xcite .",
    "we remark that under the assumption of independence in space and time , this approach is equivalent to the maximum likelihood method .",
    "obviously , the forecast errors are usually not independent , however , since one is estimating the conditional distribution of a single weather quantity vector with respect to the corresponding forecasts , the parameter estimates are not really sensitive to this assumption ( see , e.g. , * ? ? ?",
    "if the ensemble can be divided into groups of exchangeable members , ensemble members within a given group will get the same coefficient matrix of the location parameter @xcite resulting in a predictive distribution of the form @xmath34 where again ,  @xmath35  denotes the empirical covariance matrix of the ensemble .      to investigate the predictive skills of the probabilistic and point forecasts we apply the multivariate scores proposed by @xcite .",
    "the first step is to check the calibration of probabilistic forecasts , which notion means a statistical consistency between the predictive distributions and the observations ( see , e.g. , * ? ? ?",
    "for one - dimensional ensemble forecasts a frequently used tool for this purpose is the verification rank histogram , i.e. , the histogram of ranks of validating observations with respect to the ensemble forecasts ( see , e.g. , * ? ? ?",
    "* section 8.7.2 ) .",
    "the closer the distribution of the ranks to the uniform distribution on @xmath36 ,  the better the calibration .",
    "the deviation from uniformity can be quantified by the reliability index  @xmath37  defined as @xmath38 where  @xmath39  is the relative frequency of rank  @xmath40 @xcite . in the multivariate case",
    "the proper definition of ranks is not obvious .",
    "similar to @xcite , in the present work we use the multivariate ordering proposed by @xcite . for a probabilistic forecast",
    "one can calculate the reliability index from a preferably large number of ensembles ( we use @xmath41 ) sampled from the predictive pdf and the corresponding verifying observations .",
    "for evaluating multivariate density forecasts the most popular scoring rules are the logarithmic score and the energy score ( es ) , introduced by @xcite .",
    "both the logarithmic and the energy score are proper scoring rules which are negatively oriented , that is , the smaller the better , and the latter is a direct multivariate extension of the continuous ranked probability score ( crps ) . given a predictive cdf  @xmath2  on @xmath42  and a @xmath1-dimensional observation  @xmath43 , the energy score is defined as @xmath44 where  @xmath45  and   @xmath46  are independent random vectors with cdf  @xmath2 .",
    "however , for the bivariate truncated normal distribution the energy score can not be given in a closed form , so it is replaced by a monte carlo approximation @xmath47 where  @xmath48 is a ( large , we use  @xmath49 )  random sample from  @xmath2 @xcite . finally , if @xmath2  is a cdf corresponding to a forecast ensemble  @xmath50  then reduces to @xmath51    besides the proper calibration , probabilistic forecasts should result in sharp predictive distributions . in the univariate case",
    "this usually means small standard deviations leading to narrow central prediction intervals . for",
    "a @xmath1-dimensional quantity one can consider the determinant sharpness  ( @xmath52 )  defined by @xmath53 where  @xmath54  is the covariance matrix of an ensemble or of a predictive pdf .",
    "finally , point forecasts ( median and mean ) can be evaluated using the mean euclidean distance  ( @xmath55 )  of forecasts from the corresponding validating observations . for multivariate forecasts",
    "the ensemble median can be obtained , e.g. , using the newton - type algorithm given in @xcite or the algorithm of @xcite . for a detailed comparison of different algorithms ,",
    "see , e.g. , @xcite . given a predictive cdf , to determine the corresponding median the chosen algorithm might be applied on a preferably large sample from this distribution .",
    "there are two possible approaches to the choice of training data for estimating the unknown parameters of the various emos models @xcite .",
    "the regional emos technique uses ensemble forecasts and validating observations from a rolling training period for all available stations . in this way",
    ", one gets a universal set of parameters across the entire ensemble domain , which is then used at all observation sites .",
    "e.g. , in case of the aladin - huneps ensemble this means a single set of parameters for all ten cities .",
    "in contrast , local emos produces distinct parameter estimates for the different stations by using only the training data of the given station .",
    "these training sets contain only one observation per day , so local emos models require long training periods",
    ".    now , e.g. , in the bivariate model the number of free parameters to be estimated is @xmath56 , which means 14 parameters even in the simplest case of a single exchangeable ensemble group .",
    "hence , for estimating the parameters of models and only the regional emos approach is applicable .",
    "the mean logarithmic score is optimized numerically with the help of the optim function in r , using principally the nelder - mead @xcite algorithm .",
    "this method is slower but more robust than the popular broyden - fletcher - goldfarb - shanno ( bfgs ) algorithm ( * ? ? ?",
    "* section 10.9 ) , which in case of a small training set becomes unstable .",
    "both optimization methods require initial values , and the starting values of the location parameters  @xmath57  and  @xmath58  are coefficients of the bivariate linear regression of the observations on the ensemble forecasts over the training period .",
    "further , for the scale parameters  @xmath32  and  @xmath59 ,  the previous day s estimates can serve as initials values , however , according to our experience , fixed starting values provide slightly better results .",
    "finally , to enforce the non - negative definiteness of the parameter matrix  @xmath32  one can set  @xmath60  and perform the optimization with respect to  @xmath61 .",
    "as mentioned in the introduction , the predictive performance of the bivariate emos model ( see section [ subs : subs3.1 ] ) is tested on the eight - member uwme and on the aladin - huneps ensemble of the hms .",
    "the goodness of fit of the predictive distributions is quantified with the multivariate scores given in section [ subs : subs3.2 ] , and the obtained results are compared to the fits of the independent emos models of wind speed @xcite and temperature @xcite , the gaussian copula method proposed by @xcite , but with marginal distributions estimated by emos models , and the bivariate bma model of @xcite .",
    "we remark that the parameters of the independent univariate emos models are estimated by minimizing the mean crps of the training data . for fitting the marginal predictive distributions in the gaussian copula approach ,",
    "we employ the same univariate emos models for wind speed and temperature as in the independent approach .",
    "therefore , their model parameters are estimated by the minimum crps method as well .",
    "if one has a closed expression for the crps , which is the case both for the normal and the truncated normal distribution , this method usually gives better results than optimization with respect to the logarithmic score .",
    "several studies have verified that wind speed and temperature forecasts of the uwme are strongly underdispersive ( see , e.g. , * ? ? ?",
    "* ; * ? ? ?",
    "* ) , and consequently uncalibrated . obviously , the lack of calibration will remain valid if one considers these ensemble forecasts together , as predictions of a bivariate weather quantity @xcite .",
    "the underdispersive character of the raw ensemble can nicely be observed in figure [ fig : fig1 ] ( identical to figure 1 of @xcite ) displaying the univariate verification rank histograms of wind speed and temperature forecasts together with their joint multivariate rank histogram .",
    "the corresponding reliability indices  @xmath37  are @xmath62 and @xmath63 , respectively , and in many cases the raw ensemble either over- , or underestimates the verifying observation .",
    "further , the need of bivariate modeling can be justified both by the positive correlation of @xmath64 of the verifying observations of wind speed and temperature for calendar year 2008 taken along all dates and locations , and by the correlations of @xmath65 and @xmath66 of forecast errors of the ensemble median and mean , respectively .",
    ".mean energy score ( @xmath67 ) , reliability index ( @xmath37 ) and mean determinant sharpness ( @xmath52 ) of probabilistic forecasts , mean euclidean error ( @xmath55 ) of point forecasts ( median / mean ) , empirical correlation ( @xmath68 ) and empirical correlation of errors ( @xmath69 ) of wind speed and temperature components of point forecasts for the uwme .",
    "empirical correlation of observations corresponding to the forecast cases : @xmath64 . [ cols=\"<,^,^,^,^,^,^,^,^,^ \" , ]",
    "we introduce a new emos model for joint calibration of ensemble forecasts of wind speed and temperature providing a predictive pdf which follows a bivariate normal distribution truncated from below at zero in its first coordinate .",
    "the model is tested on wind speed and temperature forecasts of the eight - member university of washington mesoscale ensemble and of the eleven - member aladin - huneps ensemble of the hungarian meteorological service .",
    "these ensemble prediction systems differ both in the weather quantities being forecasted and in the generation of the ensemble members .    using appropriate verification measures ( energy score , reliability index and determinant sharpness of probabilistic and euclidean errors , correlations , as well as correlations of errors of median / mean forecasts )",
    "the predictive performance of the bivariate emos model is compared to the forecast skills of the independent emos calibration of wind speed and temperature , the gaussian copula method of @xcite based on univariate emos models , the bivariate bma model suggested by @xcite and the raw ensemble vectors as well .    from the results of the presented case studies one can conclude that compared to the raw ensemble post - processing always improves the calibration of probabilistic and accuracy of point forecasts .",
    "further , in terms of predictive performance the bivariate emos model is able to keep up with the other two bivariate methods . concerning the computational costs it outperforms the bivariate bma method , whereas compared to the gaussian copula approach it does not require an additional data set for estimating the correlations .",
    "* acknowledgments . *   essential part of this work was made during the visit of sndor baran at the heidelberg institute for theoretical studies .",
    "the research stay in heidelberg was funded by the daad program `` research stays for university academics and scientists , 2015 '' .",
    "sndor baran was also supported by the jnos bolyai research scholarship of the hungarian academy of sciences .",
    "the authors are indebted to tilmann gneiting for his useful suggestions and remarks , to the university of washington muri group for providing the uwme data , to mihly szcs from the hms for the aladin - huneps data and to thordis thorarinsdottir and alex lenkoski for their help with the r codes for the copula method .    99 bao , l. , gneiting , t. , raftery , a. e. , grimit , e. p. and guttorp , p. ( 2010 ) bias correction and bayesian model averaging for ensemble forecasts of surface wind direction . _",
    "rev . _ * 138 * , 18111821 .",
    "gneiting , t. ( 2014 ) calibration of medium - range weather forecasts .",
    "_ ecmwf technical memorandum _ no .",
    "available at : old.ecmwf.int/publications/library/ecpublications/ _ pdf / tm/701 - 800/tm719.pdf .",
    "accessed 27 july 2015 .",
    "gneiting , t. , raftery , a. e. , westveld , a. h. and goldman , t. ( 2005 ) calibrated probabilistic forecasting using ensemble model output statistics and minimum crps estimation . _ mon .",
    "_ * 133 * , 10981118 .",
    "gneiting , t. , stanberry , l. i. , grimit , e. p. , held , l. and johnson , n. a. ( 2008 ) assessing probabilistic forecasts of multivariate quantities , with applications to ensemble predictions of surface winds ( with discussion and rejoinder ) .",
    "_ test _ * 17 * , 211264 .",
    "grell , g. a. , dudhia , j. and stauffer , d. r. ( 1995 ) a description of the fifth - generation penn state / ncar mesoscale model ( mm5 ) .",
    "_ technical note _",
    "ncar / tn-398+str . national center for atmospheric research , boulder .",
    "available at : http://nldr.library.ucar.edu/repository/assets/technotes/tech-note-000-000-000-214.pdf .",
    "accessed 27 july 2015 .",
    "hornyi , a , kertsz , s. , kullmann , l. and radnti , g. ( 2006 ) the arpege / aladin mesoscale numerical modelling system and its application at the hungarian meteorological service . _",
    "i d ojrs _ * 110 * , 203227 .",
    "thorarinsdottir , t. l. and gneiting , t. ( 2010 ) probabilistic forecasts of wind speed : ensemble model output statistics by using heteroscedastic censored regression . _ j. roy .",
    "a _ * 173 * , 371388 ."
  ],
  "abstract_text": [
    "<S> forecast ensembles are typically employed to account for prediction uncertainties in numerical weather prediction models . </S>",
    "<S> however , ensembles often exhibit biases and dispersion errors , thus they require statistical post - processing to improve their predictive performance . two popular univariate post - processing models </S>",
    "<S> are the bayesian model averaging ( bma ) and the ensemble model output statistics ( emos ) .    in the last few years </S>",
    "<S> increased interest has emerged in developing multivariate post - processing models , incorporating dependencies between weather quantities , such as for example a bivariate distribution for wind vectors or even a more general setting allowing to combine any types of weather variables .    in line with a recently proposed approach to model temperature and wind speed jointly by a bivariate bma model </S>",
    "<S> , this paper introduces a bivariate emos model for these weather quantities based on a truncated normal distribution .    </S>",
    "<S> the bivariate emos model is applied to temperature and wind speed forecasts of the eight - member university of washington mesoscale ensemble and of the eleven - member aladin - huneps ensemble of the hungarian meteorological service and its predictive performance is compared to the performance of the bivariate bma model and a multivariate gaussian copula approach , post - processing the margins with univariate emos . while the predictive skills of the compared methods are similar , the bivariate emos model requires considerably lower computation times than the bivariate bma method .    </S>",
    "<S> _ key words : _ ensemble model output statistics , gaussian copula , energy score , ensemble calibration , euclidean error , truncated normal distribution . </S>"
  ]
}