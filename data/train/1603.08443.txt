{
  "article_text": [
    "many quantum systems require a treatment beyond mean - field theory to adequately capture properties of interest . a long - standing problem in quantum many - body theory",
    "has therefore been the development of computationally feasible and accurate correlated methods .",
    "this problem has been explored in the contexts of nuclear structure , condensed matter , and quantum chemistry , quite often with significant cross - fertilization .",
    "methods such as coupled - cluster theory,@xcite the density - matrix renormalization group ( dmrg),@xcite and dynamical mean - field theory ( dmft)@xcite , are examples of techniques now employed across different branches of physics and chemistry .",
    "density matrix embedding theory ( dmet ) is another example.@xcite its foundation lies on the border between tensor network states ( tns ) and dmft .",
    "tns provide a versatile framework for reasoning about the quantum entanglement of local fragments with their surrounding neighbours in terms of the schmidt decomposition of quantum many - body states,@xcite while dmft self - consistently embeds the green s function of local fragments in a fluctuating environment.@xcite while tns are able to capture the low - lying eigenstates to high accuracy , they require an explicit representation of the _ entire _ quantum many - body system at the same level of approximation ; even with translational invariance , accurate contractions of the environment have to be performed .",
    "dmft circumvents this problem by treating only the local fragment at an explicit self - consistent many - body green s function level , with the environment represented only by its hybridization function .",
    "however , non - local interactions between the fragment and its environment become more difficult to include in dmft , and the formulation in terms of frequency dependent quantities engenders additional numerical effort over ordinary ground - state calculations .",
    "dmet attempts to combine the best of the two worlds , and in doing so introduces an approximation of its own .",
    "similar to dmft , dmet embeds a local fragment , treated at a high level , in an environment , treated at a low level , thus circumventing the need to represent the entire system with uniform accuracy .",
    "however , in contrast to dmft which embeds the green s function , the embedding of dmet uses only the ground - state density matrix , and thus does not require a frequency - dependent formulation .",
    "the accuracy of dmet depends on the low - level and high - level methods that enter into the formulation .",
    "the low - level method is used to provide an approximate ground - state wavefunction , from which a bath space for the local fragment is obtained by a schmidt decomposition .",
    "the high - level method computes a wavefunction in the space of the local fragment with the small number of bath states , to high accuracy .",
    "dmet is thus a kind of wavefunction in wavefunction embedding method and there can be a rich variety of combinations of low - level and high - level methods .",
    "for example , some low - level methods that have been used in dmet are hartree - fock ( hf ) theory,@xcite hartree - fock - bogoliubov theory,@xcite anti - symmetrized geminal power ( agp ) wavefunctions,@xcite coherent state wavefunctions for phonons,@xcite and block product states for spins.@xcite some examples of high - level methods that have been used are exact diagonalization ( also known as full configuration interaction ( fci)),@xcite dmrg,@xcite and coupled - cluster theory.@xcite    so far , the ground - state formulation of dmet has been the most widely applied . in condensed matter systems it has been used to study the one - dimensional hubbard model,@xcite the one - dimensional hubbard - anderson model,@xcite the one - dimensional hubbard - holstein model , @xcite the two - dimensional hubbard model on the square@xcite as well as the honeycomb lattice,@xcite and the two - dimensional spin-@xmath1 @xmath2-@xmath3-model.@xcite quantum chemistry applications have been fewer , but it has been used to study hydrogen rings and sheets,@xcite as well as carbon polymers , two - dimensional boron - nitride sheets , and crystalline diamond.@xcite we also want to mention that the dmet bath orbital construction can be used to define optimal qm / mm boundaries,@xcite as well as to construct atomic basis set contractions which are adapted to their chemical environment.@xcite while dmet has mainly been used for ground - states , though , the formalism is not limited to ground - state properties . by augmenting the ground - state bath space with additional correlated many - body states from a schmidt decomposition of the response wavefunction , accurate spectral functions have been obtained.@xcite    despite this growing body of work on dmet from several workers , our own group s presentation of the numerical implementation and theoretical formulation of dmet has been limited to the two short original articles  @xcite and the supplementary information of ref .  .",
    "the discussion of our implementation for quantum chemistry problems has been particularly brief .",
    "this work therefore attempts to provide a more explicit explanation of dmet from our perspective , that we believe will be particularly useful for those seeking to implement the method for their own chemistry applications .",
    "together with this work , we provide a code qc - dmet@xcite that may be used in real calculations . for simplicity , we focus exclusively on the ground - state formulation of dmet .    in sec .",
    "[ section_bath_orbital_construction ] we begin by discussing the dmet bath construction .",
    "the dmet low - level and high - level embedding hamiltonians , and their connection through self - consistency , are then introduced and their construction is explained in sec .",
    "[ active_space_ahm_major_section ] .",
    "we explain how to compute expectation values ( such as the energy ) from the one- and two - particle reduced density matrices of the ground states of the embedding hamiltonians in different fragments in sec .",
    "[ dmetenergy_major_seciton ] .",
    "the numerical aspects of the self - consistency of dmet are treated in sec .",
    "[ correlationpotentialoptimization_subsection ] .",
    "various algorithmic choices are tested , and their implications are discussed , in sec . [ section_applications ] . in sec .",
    "[ section_summary ] , we summarize our results .",
    "local fragment a and its environment b.,scaledwidth=20.0% ]    imagine a system composed of two parts , a fragment ( typically called an impurity in lattice applications ) a and an environment b as shown in fig .",
    "[ splitupabfig ] . in general ,",
    "any wavefunction @xmath4 of the full system can be expressed in the hilbert space of the states of a and b , i.e. @xmath5 , of dimension @xmath6 .",
    "however , if the @xmath4 of interest is known a priori , its schmidt decomposition for the local fragment a and its environment b allows to reduce the number of required many - body states for the environment b significantly : @xmath7 we remind the reader that the singular value decomposition of the coefficient tensor @xmath8 yields two unitary basis transformations @xmath9 and @xmath10 which transform the many - body bases for the local fragment a and its environment b separately .",
    "if @xmath11 is larger than @xmath12 , this schmidt decomposition shows that we only need to retain at most @xmath12 many - body states for the environment b , in order to express our desired @xmath4 .",
    "the @xmath12 many - body schmidt states @xmath13 define an exact dmet bath for the fragment a. if @xmath4 is the ground - state of a hamiltonian @xmath14 in the full system , then it is _ also _ the ground - state of the embedding hamiltonian @xmath15 where @xmath16 .",
    "this is the heart of the dmet construction : the solution of a small embedded problem , consisting of a fragment plus its bath , is the same as the solution of the full system .    in practice",
    ", dmet approximations must enter however , because the bath construction itself requires the solution state @xmath4 .",
    "dmet is thus formulated in a boot - strap manner , where an _ approximate _ low - level @xmath17 for the full system is first used to derive the dmet bath , and then improved self - consistently from the high - level solution of the small embedded problem , which yields a high - level @xmath4 .",
    "different dmet approximations in the literature use different states @xmath17 and impose different forms of self - consistency between @xmath4 and @xmath17 .",
    "division of the universe into local fragments.,scaledwidth=20.0% ]    in a general dmet calculation , the total system can be divided into multiple local fragments , see e.g. fig .",
    "[ many_fragments_fig ] . in this case , each local fragment a@xmath18 is associated with its own embedded problem and high - level wavefunction @xmath19 .",
    "consistency between the different @xmath19 must then be enforced .",
    "this is carried out via self - consistency with a _",
    "single _ low - level @xmath17 used to describe the total system .",
    "various kinds of low - level wavefunctions have been explored in the literature .",
    "these include wavefunctions with correlation , such as configuration interaction wavefunctions in ref . , block product states for spins in ref . , and agp wavefunctions in ref .",
    "these forms of @xmath17 yield correlated many - body schmidt states , whose matrix elements must be explicitly computed in the embedding hamiltonian . however",
    ", although there are real benefits to using the most accurate feasible @xmath17 in the bath construction , it is also convenient to recycle the large number of existing quantum many - body solvers when solving the embedded problem .",
    "when a low - level wavefunction of mean - field form is used , such as a slater determinant , the @xmath12 many - body states for the environment b are spanned by a fock space of single - particle states , equal in number to the number of single - particle states of the local fragment a.@xcite this orbital representation of the bath then allows us to reuse existing quantum many - body solvers with little modification . in this work",
    ", we will focus therefore on low - level slater determinant wavefunctions .",
    "consider a slater determinant approximation @xmath20 for the ground - state of the full system .",
    "in second quantization , it can be written as @xmath21 here , @xmath22 denotes occupied spin - orbitals and @xmath23 denotes the true vacuum . in lattice model language , the _ spin - orbital _ indices combine the lattice site and spin indices into one index .",
    "a spin - orbital therefore has two possible occupations . _",
    "spatial orbitals _ correspond to the lattice sites which have four possible occupations . in what follows",
    ", we always assume orthonormal spin - orbitals for the local fragment and its environment .",
    "they will be denoted by @xmath24 and there are @xmath25 of them .",
    "the occupied orbitals are of course always orthonormal .",
    "they will be denoted by @xmath26 and there are @xmath27 of them .",
    "the orthonormal local fragment and bath orbitals will be denoted by @xmath28 .",
    "there are @xmath29 orbitals in the local fragment a.    the occupied orbitals can be written in terms of the local fragment and environment orbitals : @xmath30 the physical wavefunction represented by eq",
    ". does not change when the occupied orbitals are rotated amongst each other.@xcite ref .",
    "discusses how this freedom can be used to split the occupied orbital space into two parts : orbitals with and without overlap on the local fragment .",
    "this construction can be understood by means of a singular value decomposition .",
    "consider the occupied orbital coefficient block with indices on the local fragment : @xmath31 .",
    "the singular value decomposition of the @xmath32 coefficient block @xmath33 yields an occupied orbital rotation matrix @xmath34 : @xmath35 which can be made square by adding @xmath36 extra columns : @xmath37 $ ] .",
    "the occupied orbital space can now be rotated with the @xmath38 matrix @xmath39 : @xmath40 of the rotated occupied orbitals , only @xmath29 have nonzero overlap with the local fragment : @xmath41 this construction assumes that @xmath42 .",
    "this assumption can fail when we use large basis sets in quantum chemistry .",
    "we return to this issue in sec .",
    "[ practicalbathorbitalconstructionsection ] .",
    "the schmidt eigenstates @xmath43 in eq .",
    "can be found by diagonalizing the reduced density matrix of the environment b : @xmath44    consider @xmath45 , the overlap of the slater determinant with the many - body basis states of the local fragment a. the slater determinant can be factorized into two parts : one part which contains the orbitals with overlap on the local fragment and a second part which contains the orbitals without overlap on the local fragment : @xmath46 the @xmath12 states @xmath47 are therefore spanned by the direct product space of ( a ) the @xmath48 occupied orbitals without overlap on the local fragment and ( b ) the fock space consisting of the @xmath29 entangled orbitals with overlap on the local fragment , after they have been projected onto the environment . the construction in eq .",
    "( 5 ) of ref . is based on the overlap of the occupied orbitals with the local fragment : @xmath49 it is immediately clear from the discussion above that at most @xmath29 eigenvalues of @xmath50 are nonzero .",
    "the @xmath29 corresponding eigenvectors yield the bath orbitals ( @xmath51 ) : @xmath52 the bath orbitals in eq .",
    "are exactly those from eq .",
    ", after the latter have been projected onto the environment .    from the above , we see that the dmet construction yields 4 kinds of orbitals : local fragment orbitals , bath orbitals , unentangled occupied environment orbitals , and unentangled unoccupied environment orbitals .",
    "the bath orbitals and local fragment orbitals will in general be partially occupied in the dmet high - level wavefunction @xmath4 , thus the bath plus local fragment space is a quantum chemistry _",
    "active space_. in active space language , the unentangled occupied environment orbitals are external core orbitals , and the unentangled unoccupied environment orbitals are external virtual orbitals . fig .",
    "[ activespacehamfig ] illustrates the relationship of the original basis to the active space representation generated by the transformation to bath orbitals . because there are @xmath48 core orbitals , the active space of @xmath53 local fragment and bath orbitals will contain precisely @xmath29 electrons .",
    "the @xmath48 core orbitals can contribute direct and exchange terms to the embedded hamiltonian , as discussed in sec .",
    "[ active_space_ahm_major_section ] .",
    "the bath orbital transformation generates an active space .",
    "note that the depicted ordering of the orbitals is arbitrary.,scaledwidth=35.0% ]      we now present a second and completely equivalent construction of the bath orbitals . in this formulation ,",
    "only the mean - field density matrix in the local fragment and environment orbital basis is required : @xmath54 the eigenvalues of this idempotent density matrix are all either 0 or 1 .",
    "consider the @xmath55 subblock where @xmath56 and @xmath57 belong to the environment b only .",
    "we have hence removed the @xmath29 rows and columns corresponding to the local fragment . due to macdonald",
    "s theorem,@xcite at most @xmath29 eigenvalues of the @xmath55 subblock will lie in between 0 and 1 .",
    "the corresponding eigenvectors are the orthonormal bath orbitals from eq . .",
    "the @xmath48 eigenvectors with eigenvalue 1 are the unentangled occupied environment orbitals , which give direct and exchange contributions to the active space hamiltonian , see sec .",
    "[ active_space_ahm_major_section ] .",
    "the overlap matrix @xmath50 in eq . is a projector of the occupied orbitals onto the local fragment .",
    "analogously , @xmath58 is a projector of the environment orbitals onto the occupied orbitals .",
    "any eigenvectors with partial weight signal occupied orbitals with support on both the local fragment and the environment , i.e. the entangled occupied orbitals .    in practical calculations in quantum chemistry ,",
    "the selection of bath orbitals is intimately tied to the localization procedure used to determine how orbitals define fragments .",
    "one possibility is to localize orbitals using some standard procedure ( lwdin orthogonalization , boys localization , etc . ) and defining the fragments accordingly .",
    "it is important to note , however , that the localization must mix particle and hole states so that at least some of the fragment orbitals become entangled .",
    "if this strategy is followed , some of the @xmath29 fractional eigenvalues of @xmath58 can lie arbitrarily close to 0 or 1 ( or to 0 or 2 when a spin - summed restricted slater determinant is used as the low - level wavefunction ) .",
    "it can happen for very large basis sets @xmath59 , or when the occupied core orbitals of neighbouring atoms are in practice unentangled .",
    "this makes it difficult to distinguish between true bath orbitals and unentangled environment orbitals . in such cases ,",
    "one approach is to use an eigenvalue cutoff ( e.g. @xmath60 ) to discard the corresponding eigenvectors from the bath orbital space .",
    "however , in chemical applications this truncation can lead to problems , for example , if different sets of bath orbitals enter at different points on a potential energy surface . a practical fix",
    "is then to keep only one bath orbital per broken chemical bond , as was first presented in ref . .",
    "in this work , we have considered a more elaborate localization strategy using the ideas expressed in ref .  .",
    "in a typical calculation , we determine fragment core orbitals by projecting the occupied mo set into core - like aos . in the valence space ,",
    "we use the intrinsic atomic orbital ( iao ) construction described in ref .  .",
    "this yields a set of localized , atomic - like orbitals that exactly span the occupied mo space .",
    "localized , atomic - like virtual orbitals are then determined by a projection into a set of corresponding atomic - like orbitals ( appropriately orthogonalizing with respect to the previous sets ) .",
    "if this strategy is followed , entangled orbitals in the fragment are restricted to the valence iao set , while core ( and virtual ) orbitals keep this character within the fragment .",
    "we find this strategy closer to the spirit of dmet and can avoid some of the arbitrariness in choosing an eigenvalue cutoff to determine entangled orbitals .",
    "it can also provide more consistent results as the atomic basis set is increased towards completeness .",
    "due to the possibility of truncation , we will henceforth denote the number of bath orbitals by @xmath61 , where @xmath62 .",
    "once the bath orbitals are determined by diagonalizing @xmath58 , all other environment orbitals are restricted to be fully occupied or empty .",
    "thus with truncation , the deficit in electron number between the fully occupied environment orbitals and @xmath27 is the number of electrons @xmath63 in the active space .",
    "we now introduce the low - level and high - level dmet hamiltonians which are connected by the dmet correlation potential and self - consistency . in lattice applications of dmet",
    ", the low - level hamiltonian is termed the lattice hamiltonian , and the high - level embedding hamiltonian is termed the impurity hamiltonian .",
    "as the quantities are all related , we discuss in general terms their role in the theory , before we give their precise definition .",
    "we first start with the hamiltonian for the total system . for a general chemical problem",
    ", it takes the form : @xmath64 where @xmath65 and @xmath66 are diagonal in the spin indices of spin - orbitals @xmath56 and @xmath57 , and",
    "@xmath66 is diagonal in the spin indices of @xmath67 and @xmath68 as well . throughout this work ,",
    "fourfold permutation symmetry @xmath69 is assumed .",
    "@xmath70 yields @xmath71 as its exact ground state , as appears in eq .",
    "however , in dmet , the determination of @xmath71 is replaced by the determination of a low - level wavefunction @xmath17 and a set of high - level wavefunctions @xmath19 .",
    "@xmath17 is the ground - state of the dmet low - level hamiltonian @xmath72 ( vide infra ) , and @xmath19 is the ground - state of the dmet high - level ( embedding ) hamiltonian @xmath73 for fragment a@xmath18 .",
    "both are derived from @xmath70 , and are connected by the correlation potential @xmath74 .",
    "the correlation potential @xmath74 is adjusted to match observables in @xmath17 and @xmath4 through a self - consistency cycle .",
    "as we shall see , the form of @xmath74 depends on the observables we choose to match , and the type of @xmath17 we are using .    in the formulation we focus on here",
    ", the low - level @xmath17 is a slater determinant .",
    "thus @xmath72 is a one - particle hamiltonian of the form @xmath75 where @xmath74 is a sum of one - particle operators acting on each of the blocks of fragment orbitals , @xmath76 and the @xmath77 matrix elements are adjusted to match single - particle density matrices @xmath78 between the high - level wavefunction @xmath19 and the global low - level wavefunction @xmath17 .",
    "we delay the precise description of the matching until sec .",
    "[ correlationpotentialoptimization_subsection ] , but note that unless there is translational invariance or other symmetries to relate the fragments , @xmath79 will be different for each fragment .",
    "@xmath80 is a single - particle hamiltonian , which may be held fixed along the dmet optimization .",
    "the simplest choice for @xmath80 is the one - particle part of the total hamiltonian @xmath70 , and in this case one relies on the correlation potential @xmath74 to produce the mean - field fock - like coulomb and exchange contributions on the fragments , as the correlation potential is adjusted by the self - consistency .",
    "alternatively , one can choose the initial @xmath80 to be the fock operator @xmath81 derived from @xmath70 .",
    "in this case , however , the coulomb and exchange potentials of @xmath81 that act in each fragment a@xmath18 will be redundant with @xmath79 during the self - consistency , although the components that act outside of the fragments are not . if @xmath70 only has coulomb terms which act in each fragment separately ( as in the hubbard model ) choosing @xmath80 to be the fock operator or the hopping hamiltonian @xmath82 is _ exactly equivalent_. thus in applications of dmet to the hubbard model , the simpler hopping hamiltonian @xmath80 has been commonly used .",
    "we now discuss the high - level embedding hamiltonians .",
    "there are two choices : an interacting bath high - level hamiltonian , and a non - interacting bath high - level hamiltonian .",
    "the high - level embedding hamiltonian @xmath83 is an interacting hamiltonian for the active space of local fragment a@xmath18 .",
    "the conceptually simplest construction of @xmath83 is to project the total hamiltonian @xmath70 into the active space representation of fragment a@xmath18 , as in eq . .",
    "we can do this by writing the one - particle part of @xmath83 as @xmath84 d_{mn}^{\\text{env , x } } \\right ] \\hat{a}_k^\\dag \\hat{a}_l = \\sum_{kl } \\widetilde{h}^x_{kl } \\hat{a}_k^\\dag \\hat{a}_l , \\label{lskhhfhvhvhhehdhdhdh}\\end{aligned}\\ ] ] ( note the inclusion of the coulomb and exchange terms from the unentangled occupied environment ) , and then transforming the one - particle part to the active representation of fragment a@xmath18 , and adding the active space two - electron integrals , yielding @xmath85 where @xmath86 denotes the transformation and projection into the active space of fragment a@xmath18 .",
    "note that the correlation potential does not actually appear in @xmath83 , as this would double - count the effects of the interactions already included in the active space .",
    "the correlation potential appears only indirectly through its effect on the form of the bath and core orbitals .",
    "however , to ensure that the total number of electrons in all local fragments adds up to @xmath27 , it becomes necessary to introduce a global chemical potential for the local fragment orbitals , thus giving @xmath87 note that @xmath88 does not depend on orbital ( @xmath89 ) or fragment ( @xmath90 ) indices .      a simpler construction , motivated by the impurity formulation of dynamical mean - field theory , can also be used . here",
    "coulomb interactions are only included on the fragment orbitals while the correlation potential @xmath74 is used to mimic the coulomb interactions elsewhere .",
    "this is known as the _ non - interacting bath _ formulation of dmet . here",
    "we first define the single - particle part of the high - level hamiltonian as @xmath91 where we observe that the correlation potential appears on all sites _ outside _ of the fragment .",
    "we then transform this to the fragment plus bath representation of fragment a@xmath18 and include the two - particle interactions _ only on the fragment orbitals _ , giving ( including a chemical potential ) @xmath92 because the correlation potential appears directly in the high - level hamiltonian through its contribution to eq . , the correlation potential can itself be used control the total particle number in all the local fragments .",
    "thus if matching the particle number between @xmath17 and the union of all @xmath19 is achieved perfectly in the dmet self - consistency cycle , the chemical potential @xmath88 appearing in eq .   is redundant and can be omitted .",
    "alternatively , @xmath74 ( i.e. @xmath77 ) can be constrained to be traceless , and then @xmath88 takes on the meaning of the diagonal part of @xmath74 .",
    "we typically use the latter strategy .",
    "while the non - interacting bath formulation only includes two - particle interactions on the fragment orbitals , it nonetheless converges to the exact result as the fragment size increases .",
    "thus either the non - interacting bath or interacting bath formulation can be used and may be convenient for different purposes .",
    "for example , the first studies of the hubbard model with dmet used the non - interacting bath formulation , because many quantum monte carlo methods used in this problem have difficulty with the non - local two - electron interactions that appear in the interacting bath formulation of dmet . however",
    ", for quantum chemical solvers such as configuration interaction or coupled cluster theory , the only benefit to omitting the bath two - particle interactions is to reduce the number of two - electron integrals to compute .",
    "this is not a large advantage in practice , when weighed against neglecting the bath correlations . for this reason",
    ", we will focus on the interacting bath formulation in the calculations in this work .",
    "the ground - state of each fragment dmet high - level hamiltonian yields a high - level wavefunction @xmath19 .",
    "these high - level wavefunctions are used to assemble the dmet expectation values of interest .",
    "note that if the fragments are non - overlapping as is typical in dmet , each fragment wavefunction defines the expectation values for operators that act _ locally _ on each fragment .",
    "for example , from each local fragment s @xmath19 , we obtain the one - particle and two - particle density matrices ( 1- and 2-rdm ) on the fragments @xmath93 with @xmath94 .",
    "we refer to this as a `` democratic '' evaluation of the local expectation values .    for non - local operators that act on multiple fragments ,",
    "different fragments high - level wavefunctions will in general yield different values for the non - local expectation values .",
    "clearly it is desirable to combine the expectation values from different fragments in an optimal way .",
    "the solution used in the original dmet was to partition the expectation value of a hermitian sum of non - local operators , such as @xmath95 , in a similarly democratic fashion as @xmath96 where @xmath97 denotes the fragment containing orbital @xmath98 , i.e. the first index of the operator determined the fragment wavefunction to use . following this rule , the total energy corresponding to the hamiltonian @xmath70 in eq .",
    "( [ orig_ham_eq ] ) is evaluated as @xmath99    however , there are some cases where this `` democratic '' partitioning of non - local expectation values is sub - optimal .",
    "this can be observed when a single fragment ( labeled by a ) is treated with a high - level method while other fragments are treated at a lower level of theory . in this case , the non - local expectation values associated with the high - level wavefunction of fragment a are more accurate than the expectation values associated with the low - level wavefunction of other fragments .",
    "then , it is more accurate to define @xmath100 in the extreme case where a single fragment is treated at a high level of theory while other fragments are treated at the same level of theory as that used to obtain the slater determinant @xmath101 , then it is more accurate to define _ all _ expectation values using the high - level wavefunction for fragment a. in this case , the energy expression becomes @xmath102 we will see an example of this in the applications section .",
    "it is important to note that not only the fragment and bath orbitals , but also the _ core _ ( unentangled occupied environment ) orbitals in @xmath19 contribute to non - local expectation values .",
    "for example , in eq .",
    "( [ energyfragment ] ) the density matrices are _ total _ density matrices including the core contributions . not including the core contributions leads to inaccurate values for non - local expectation values .",
    "this can be seen in ref .  , where the non - local correlation functions did not use the core contributions .",
    "for the interacting bath formulation with democratic partitioning , the fragment energies become @xmath103 with @xmath104 the rotated one - electron integrals from eq . .",
    "the one - electron integrals in eq .",
    "avoid the double counting of coulomb and exchange contributions of the _ core _ ( unentangled occupied environment ) orbitals .",
    "the factor @xmath1 is similar to the difference between the fock operator and energy expressions in hf theory .",
    "the final component in the dmet algorithm is to determine the correlation potential @xmath74 .",
    "as introduced above , in the interacting bath formulation the correlation potential appears in the low - level hamiltonian @xmath72 , while in the non - interacting bath formulation , it appears in both the low - level hamiltonian @xmath72 and high - level hamiltonian @xmath73 .    optimizing the correlation potential requires choosing observables to match between the low - level and high - level wavefunctions , which defines an associated cost function .",
    "different cost functions lead to different dmet functional constructions , with different properties .",
    "for example , matching the density matrices of the fragments makes the dmet observables a functional of the self - consistently converged density matrices : dmet is then a local density matrix functional theory . matching only the diagonal elements of the density matrices in dmet",
    "similarly provides a lattice density functional interpretation of dmet .",
    "some of the cost functions and correlation potential forms that have been used in dmet calculations include : matching the full density matrix of the fragment plus bath orbitals ( but using correlation potentials defined in the usual way on the fragments only , @xmath77 for @xmath105 in eq .",
    "( [ correlationpotent_eq ] ) ) , which we term fragment ( impurity ) plus bath fitting,@xcite matching the density matrix of the fragments only using correlation potentials on the fragments , which we term fragment ( impurity ) only fitting,@xcite matching the diagonals of the fragment density matrices , using diagonal correlation potentials on the fragments ( @xmath106),@xcite and using no correlation potential ( @xmath107 ) and only matching the total number of electrons with a global chemical potential @xmath88,@xcite which we refer to as single - shot embedding . written explicitly ,",
    "these cost functions are respectively , for the fragment plus bath density matrices:@xcite @xmath108 the fragment only density matrices:@xcite @xmath109 the fragment only densities:@xcite @xmath110 and for the total electron number:@xcite @xmath111 the latter corresponds to a global chemical potential optimization . as discussed extensively in ref . ,",
    "trying to mimic ( parts of ) a high - level correlated density matrix by ( parts of ) a mean - field density matrix is not always possible because the latter is idempotent while the former does not have to be .",
    "this is analogous to certain densities not being non - interacting @xmath112-representable in kohn - sham density functional theory . in such cases , the cost functions will not minimize to zero , and this is in fact always the case for the first cost function eq .",
    "( [ costfunction1 ] ) . in the calculations in this work",
    ", we focus primarily on the local fragment ( `` impurity only '' ) density matrix matching , as in the original quantum chemistry dmet  @xcite .    the cost function optimization algorithm in refs .  ,   optimized the correlation potential @xmath77 for each local fragment a@xmath18 independently .",
    "the disadvantage is that it is prone to limit cycles and slow convergence due to overshooting when there are multiple fragments .",
    "instead , we recommend to optimize the correlation potential for all local fragments simultaneously ; the stationary points of the two procedures are the same .",
    "we further fix the high - level density matrix when optimizing the cost function , since then the gradient with respect to the correlation potential can be expressed in terms of the gradient of the low - level density matrix .",
    "this is easily computed , as shown in appendix [ appendixgrad ] .",
    "we then use this gradient in a standard least - squares optimizer such as provided by minpack .",
    "once the new @xmath113 is determined the high - level density matrix is updated .",
    "the full algorithm is described in section  [ sect_algo_total ] .",
    "if there exists no low - level wavefunction that exactly matches the given ( fixed ) high - level density matrix fragments , the best matching low - level density matrix @xmath114 may be undetermined during the cost - function optimization .",
    "this is because for any non - zero value of the cost function and fixed high - level density matrix , there is clearly a manifold of low - level density matrices @xmath115 ( not necessarily parametrized by @xmath113 ) which yield the same ( non - zero ) cost .",
    "indeterminacy occurs when there is a continuous intersection between @xmath115 and @xmath114 ( i.e. the density matrices parametrized by @xmath113 ) which is increasingly likely as the fragment size increases and there is more freedom in @xmath113 .",
    "it is therefore useful to consider an alternative formulation where this indeterminacy does not arise .",
    "first , consider minimizing @xmath116 under a set of lagrangian constraints , similar to the kohn - sham scheme in density functional theory .",
    "if the local fragment density matrices are to be matched ( cf .",
    ", this corresponds to the optimization @xmath117 .",
    "\\label{ks}\\ ] ] in eq .",
    "( [ ks ] ) , the correlation potential appears as the matrix of lagrange multipliers that enforces the constraints . imposing the orthonormality constraint on the orbitals @xmath118 leads to a set of eigenequations satisfied at the minimum , @xmath119 where @xmath120 are the set of lagrange multipliers enforcing orthonormality .",
    "this eigenvalue problem is identical to the ground - state dmet low - level problem , where the orbitals that define @xmath17 are obtained from the single - particle hamiltonian @xmath72 . to eliminate the indeterminacy",
    "when the density matrix constraint can not be satisfied , we consider the dual of eq .",
    "( [ ks ] ) , replacing the constrained optimization by an unconstrained maximization over the potential @xmath113 , following lieb @xcite .",
    "this gives the new cost function @xmath121 .",
    "\\label{costfunction2_improved}\\ ] ] in the above @xmath17 uses the _",
    "occupations . when an exact match of the density matrix can be found , maximizing eq .",
    "( [ costfunction2_improved ] ) is equivalent to minimizing eq .",
    "( [ ks ] ) , or the original cost function eq .",
    "( [ costfunction2 ] ) .",
    "however , the unconstrained maximization can be performed even when no exact match exists , and then the presence of the energy term breaks the degeneracy of imperfectly matched solutions , removing the indeterminacy in @xmath113 .    to maximize eq .",
    "( [ costfunction2_improved ] ) we use a standard bfgs optimization ( using the analytical gradients of the cost function ) .",
    "for all calculations presented later using fragment density matrix matching , it was possible to perfectly match the density matrices , thus the cost functions eqs . or gave identical results .",
    "we also use the mean - field fock operator of the initial low - level wavefunction @xmath17 ( in practice , the restricted hartree - fock determinant ) to define @xmath80 in eq .",
    "( [ costfunction2_improved ] ) .",
    "this still ties the dmet optimization problem to the original hartree - fock solution .",
    "this dependence could be eliminated if the mean - field fock operator is also determined self - consistently .",
    "however , in the few cases where we tried the latter we observed no noticeable difference with respect to using the initial fock operator .",
    "u @xmath122 0 @xmath123 0 @xmath124 @xmath125 @xmath126 compute bath orbitals : @xmath127 @xmath128 @xmath129 @xmath130 @xmath131 @xmath132 @xmath133 @xmath134      now that all the pieces of the dmet algorithm have been introduced , the total dmet algorithm can be described . at the start , the system hamiltonian ( eq . )",
    "should be known , as well as the partitioning of the system into local fragments ( fig .",
    "[ many_fragments_fig ] ) .",
    "the pseudocode for the total dmet algorithm is given in algorithm [ epsa ] .",
    "on lines 4 - 6 the low - level density matrix for the total system is computed for a given correlation potential . on line 9 the dmet bath orbitals for local fragment a@xmath18",
    "are computed according to sec .",
    "[ practicalbathorbitalconstructionsection ] . on line 10 the high - level embedding hamiltonian for local fragment a@xmath18",
    "is calculated according to sec .",
    "[ active_space_ahm_major_section ] .",
    "together with a global chemical potential which only acts on the local fragment orbitals but not on the bath orbitals , the high - level ground state 1-rdm and 2-rdm on line 11 are determined from the embedding hamiltonian .",
    "the contribution of local fragment a@xmath18 to the total energy is computed according to eq .",
    "on line 12 . on line 14 , these local energy contributions are summed to yield the total dmet system energy . on line 15 ,",
    "the total number of electrons in all local fragments is obtained as a sum of local fragment traces of the high - level 1-rdms .",
    "when this number is different from the desired particle number , the chemical potential needs to be adjusted .",
    "line 16 is realized in our code by the secant root - finding method to solve for @xmath135 and finally , once @xmath88 is found , the optimization of the correlation potential on line 18 is performed with the methods described in sec .",
    "[ correlationpotentialoptimization_subsection ] .",
    "the calculations in this work have been performed with qc - dmet.@xcite the integrals in atomic and molecular orbital spaces were obtained with pyscf@xcite . as high - level methods ,",
    "we have used the coupled - cluster solver with singles and doubles ( ccsd ) from pyscf and the fci ( dmrg ) solver from chemps2.@xcite in this work , we use the ccsd _ response _ density matrices @xcite obtained using the solution to the corresponding @xmath136 equations .",
    "we present interacting bath dmet results for the symmetric stretch of a hydrogen ring with 10 atoms in the sto-6 g basis in fig .",
    "[ hchain_figure ] .",
    "a lwdin symmetric orthogonalization was used to define the localized orthonormal orbitals .",
    "restricted hf was used as the low - level method and fci as the high - level method .",
    "results for fragments with one or two orbitals ( one or two hydrogen atoms ) are shown .",
    "note that due to the periodic character of the system , only a single fragment problem needs to be solved .",
    "the fully symmetric hf solution was used to define the dmet low - level hamiltonian @xmath80 in self - consistent calculations ; results using the dimerized solution yield nearly indistinguishable energies . in self - consistent calculations ,",
    "we use the fragment ( impurity ) only fitting ( cf .",
    "eq . or ) .",
    "the dmet energies follow the fci results closely along the whole dissociation curve.@xcite more details can be observed by plotting the fraction of correlation energy captured by dmet . the larger deviations at smaller bond distances are due to a smaller correlation energy , not due to larger errors in dmet .",
    "we see that the dmet energies are not variational , as eq .",
    "does not correspond to the expectation value of a single wavefunction .",
    "the inclusion of the correlation potential ( beyond the global chemical potential ) yields results significantly more accurate than without it ; in particular , nearly exact results are obtained for bond lengths larger than 1.6  angstrom .",
    "we display also the nearest - neighbor bond orders ( @xmath137 ) in self - consistent dmet(2h ) calculations . because of",
    "the use of 2-site fragments , two types of bond orders can be computed in dmet : intra - fragment and inter - fragment . in spite of their non - equivalence ( which reflects the broken full translational invariance ) , both are significantly improved over rhf which remains constant ( by symmetry ) along the entire dissociation curve .",
    "note that the use of the cost function eq . or guarantees that the determinant @xmath17 that results from the dmet self - consistency procedure has exactly the same intra - fragment bond orders as the ones defined by the dmet expectation values .",
    "we see that the dmet solution is strongly dimerized at intermediate bond lengths . as",
    "the fci solution must preserve translational symmetry , we can not detect dimerization in the single - particle density matrix .",
    "however , the corresponding behavior might be expected in the bond - bond correlation functions in the two - particle density matrix .",
    "this would also indicate a tendency for the system to undergo a peierls transition .",
    "we show in fig .",
    "[ hchain_figure2 ] interacting bath dmet results for the symmetric stretch of a 90-atom hydrogen ring using the sto-6 g basis , a lwdin symmetric orthogonalization , and fci as the high - level solver .",
    "in this case , we show results for fragments with one , two , three , five , and six hydrogen atoms .",
    "the fully symmetric rhf solution was used to carry out the dmet calculations , even though the dimerized rhf solution yields lower energies across the entire dissociation profile .",
    "the left plot shows results without a correlation potential ; results appear to converge relatively monotonically with respect to the size of the fragment around the equilibrium region .",
    "the right plot shows the difference with respect to the dmet(6h , @xmath138 ) energies , additionally including results with @xmath139 .",
    "we further compare with the dmrg calculations presented in ref .   for the energy of the 50-atom h chain .",
    "( note that for short bond lengths larger differences are expected with respect to dmrg results due to the difference in finite size effects in a ring vs a chain . )",
    "both @xmath140 and @xmath139 results using the larger fragments are only slightly off ( a few tenths of a me@xmath141 per atom ) from dmrg for bond lengths greater than 1.0  angstrom . for the smaller fragment sizes , the fragment density matrix fitting results are in better agreement with dmrg than the single - shot embedding ones .",
    "however , the difference between the two types of self - consistency becomes small as the fragment size increases .",
    "unfortunately , convergence with respect to the fragment size here is non - monotonic , which prevents us from attempting accurate extrapolations .      in this section ,",
    "we consider results for a ring of 30 beryllium atoms using the sto-6 g basis set . as shown in fig .",
    "[ beryllium_figure ] , the rhf solutions near equilibrium and towards dissociation have different character . in the former case , there is @xmath142 ( @xmath143-@xmath143 ) bonding between the beryllium atoms , while in the latter case the atomic @xmath144 orbitals are occupied.@xcite    the dmet calculations used restricted hf as the low - level method and either fci or ccsd as the high - level method . our localization procedure for dmet calculations proceeded as follows .",
    "we first defined the core orbitals by projecting the rhf occupied mos into atomic - like @xmath145 orbitals .",
    "we then obtained iaos using the atomic - like @xmath144 and a single @xmath146 orbital ( tangent to the ring ) .",
    "the remaining @xmath146 orbitals were used to define the virtual space .",
    "this localization strategy leads to a @xmath147 active space when a single beryllium atom is used to define the fragment .",
    "self - consistent dmet calculations were performed in two stages : first , the core and virtual orbitals were treated as frozen and a correlation potential was optimized in dmet calculations using the @xmath144 and ( tangent ) @xmath146 orbitals with the cost function eq .",
    "; the correlation potential thus obtained was included later in a single - shot embedding calculation using the full set of orbitals .",
    "we have not computed exact benchmark data for this system .",
    "instead , we have compared our dmet energies to the full system ccsd energies .",
    "when the correlation is not too strong , we expect the full system ccsd to be an accurate benchmark .",
    "however , under more strongly correlated conditions , for example , as the bonds are stretched , or near an avoided crossing , we might expect small fragment dmet calculations with a ccsd solver to be more accurate than the full system ccsd itself , as the latter can break down .    as shown in fig .",
    "[ beryllium_figure ] ( a ) , the single - shot dmet energies generally lie close to the full system ccsd results along the whole dissociation curve .",
    "all curves are discontinuous , due to the crossing of the two rhf solutions with different character . if we examine the difference from the full system ccsd in fig .",
    "[ beryllium_figure ] ( b ) , the largest difference ( with a 1-atom fragment ) is smaller than 4 me@xmath141 per atom , while larger fragments ( 5 or 6 be atoms ) give differences of only @xmath148 1 me@xmath141 per atom along the entire dissociation profile .",
    "close to , and to the right of , the rhf crossing point we see the largest differences of the dmet energies from the full system ccsd energy",
    ". this deviation does not significantly decrease with the larger fragment sizes .",
    "the explanation is found in fig .",
    "[ beryllium_figure ] ( c ) , which provides a close - up of the energies around the crossing region .",
    "we see that the ccsd energies display an unphysical discontinuous jump comparable to that of the rhf solution . however , the dmet energies have a much smaller jump , much closer to the correct physical result .",
    "the size of this jump is much smaller with self - consistency , indicating that the dmet self - consistency can remove most of the dependence on the initial rhf determinant . indeed , for the points near the crossing we see a smooth transition in the character of the dmet low - level wavefunction from doubly occupied @xmath144 to @xmath143 hybridization .",
    "this thus illustrates a situation where small fragment dmet using an approximate high - level method yields better behaviour than a calculation on the full system .",
    "indeed , the difference between using fci or ccsd as a solver in these dmet fragment sizes appears quite small , which would not be the case for the full system .      in this section , we study single - shot embedding ( ie . , @xmath140 but with a global chemical potential ) dmet results with an interacting bath hamiltonian for the symmetric s@xmath02 reaction @xmath149 the transition state and geometries along the internal reaction coordinate ( irc ) were optimized with gaussian09@xcite and the b3lyp method , along with the cc - pvtz basis  @xcite for c and h and the aug - cc - pvtz basis  @xcite for f atoms . in the interacting bath dmet calculations we used the cc - pvdz basis  @xcite for all atoms .",
    "the transition state is shown in fig .",
    "[ ts_figure ] .     optimized transition state geometry for the s@xmath02 reaction.,scaledwidth=50.0% ]    in the dmet calculations presented below , we have used the iao - based localization procedure described in sec .",
    "[ practicalbathorbitalconstructionsection ] .",
    "the system was partitioned into fragments by cutting across c - c bonds .",
    "different fragment sizes , labeled by the number of carbon atoms in each fragment ( # c ) , were considered .",
    "if 1c fragments are used , then the leftmost fragment corresponds to a ch@xmath150f@xmath150 unit , followed by a ch@xmath150 unit , and so on .",
    "restricted hf was used as the low - level method .",
    "three types of calculations have been performed :    1 .",
    "a standard dmet calculation using ccsd as the high - level method for each fragment , denoted as dmet(all ) .",
    "2 .   a dmet calculation where only the leftmost fragment ( where the substitution takes place ) is treated with the high - level method ( ccsd ) , while others are treated at the rhf level . due to truncation of the bath orbital space and the presence of @xmath88 . ]",
    "this we label as dmet(1 ) .",
    "3 .   same as above , but with the active space formula for the energy ( eq .  [ active_space_energy ] ) and particle number , denoted as .",
    "note that for @xmath151 the global particle number is automatically correct , but the global chemical potential @xmath88 needs to be optimized for the former two cases . in selecting the bath orbitals for a given fragment ,",
    "we have considered two different schemes : truncating the space using an eigenvalue cutoff of @xmath60 , and keeping a single bath orbital per chemical bond broken.@xcite     fraction of correlation energy obtained in single - shot dmet(1 ) , dmet(all ) , and as calculations using 2c and 4c fragments along the irc of the s@xmath02 reaction . here",
    ", the bath orbital space includes a single orbital per chemical bond cut.,scaledwidth=36.0% ]    fig .",
    "[ sn2_total_corr ] shows the fraction of correlation energy ( with respect to full - system ccsd ) obtained with the different calculation schemes .",
    "it is clear that the total energies from dmet(all ) calculations are more accurate than with other schemes , as correlation from all electrons is accounted for .",
    "nevertheless , the same is not true for the relative energy profiles , as discussed below .",
    "[ sn2_iao_all_figure ] displays the relative energy profiles : results using an eigenvalue threshold of @xmath152 to select bath orbitals are shown in panels ( a),(c),(e ) , while those with a single bath orbital per chemical bond cut are shown in panels ( b),(d),(f ) . although the behavior shown in ( a ) and ( c ) significantly improves with increasing fragment size , the qualitative behavior is still far from the ccsd or rhf one . on the other hand ,",
    "the active space energy ( e ) displays a qualitatively correct behavior even with 1c fragments , while approaching quantitative agreement with ccsd as the fragment size is increased .",
    "the very permissive threshold of @xmath152 captures a large amount of bath orbitals per fragment , and this is partly responsible for the slow convergence of the as energy with respect to ccsd .",
    "it is even responsible for a small jump in the 4c energy profile at @xmath153  bohr ( hard to see ) , as an additional bath orbital is included for larger values of irc .",
    "if the bath selection is restricted to 1 orbital per chemical bond cut ( see panels ( b),(d),(f ) ) , the agreement with ccsd observed in as energy calculations is much better .",
    "the dmet(all ) and dmet(1 ) profiles are not significantly changed .",
    "we can analyze the origin of the poor behavior of the dmet(all ) and dmet(1 ) schemes .",
    "in particular , the only difference between ( c ) and ( e ) ( or , equivalently , ( d ) and ( f ) ) is that ( c ) uses the standard dmet democratic partitioning of the expectation values across fragments for both the particle number and energy .",
    "although this democratic partitioning allows information from different fragments to contribute equally to the whole calculation ( important , for example , in a translationally invariant system ) this is not advantageous in the current example as the chemical change is occurring purely locally . in fig .",
    "[ fig : sn2_mu0 ] we further show the energy profile corresponding to ( b ) , ( d ) using the standard dmet formula for the energy , but without adjusting the global chemical potential . in this case",
    ", the energy profile appears improved and qualitatively correct , although the convergence with respect to fragment size is still slow .",
    "this indicates that it is the democratic evaluation of the particle number which yields the largest source of error in the dmet calculations .",
    "in this work we have reviewed several aspects of density matrix embedding theory ( dmet ) in detail . in sec .",
    "[ section_bath_orbital_construction ] , we discuss how a bath space can be constructed for a local fragment .",
    "while correlated low - level methods provide accurate many - body bath states , most quantum chemistry solvers are formulated in terms of orbitals .",
    "the schmidt decomposition of a mean - field wavefunction naturally gives rise to bath orbitals .",
    "we have reviewed the dmet bath orbital construction , and provided a practical way to obtain the bath orbitals from the mean - field 1-rdm of the total system . in the future",
    ", it will be interesting to construct a bath _ orbital _ space from a correlated low - level wavefunction .    in sec .",
    "[ active_space_ahm_major_section ] , we discuss the construction of both the non - interacting bath and interacting bath low - level and high - level hamiltonians . once the high - level hamiltonian problem is solved , and the corresponding 1- and 2-rdms are obtained in the local fragment and bath orbital spaces , dmet energies can be calculated based on the formulae in sec .",
    "[ dmetenergy_major_seciton ] . in order to fine - tune the low - level wavefunction to construct better bath spaces ,",
    "a dmet correlation potential is introduced .",
    "its self - consistent optimization is discussed in sec .",
    "[ correlationpotentialoptimization_subsection ] , as well as the optimization of a global chemical potential shift to ensure that the fragments contain the correct total number of electrons .",
    "this section also provides an overview of how the different parts of dmet fit into the full dmet algorithm .    in sec .",
    "[ section_applications ] several applications are studied . in hydrogen and beryllium rings",
    "we consider calculations with a single - shot embedding scheme and in a full self - consistent correlation potential dmet treatment .",
    "the effect of self - consistency is generally minor , but becomes pronounced near drastic changes in the character of the hf solution , where the optimal dmet slater determinant may differ considerably from the hf one . in hydrogen and beryllium",
    "rings our dmet calculations have nearly quantitative agreement with accurate dissociation profiles even when small impurity sizes are used .",
    "the agreement improves significantly as the size of the impurity is increased . in the beryllium rings ,",
    "self - consistency is important for describing the avoided crossing region , and the dmet calculations with small fragments , using an approximate coupled cluster solver , appear more accurate than the full system coupled cluster results themselves .    for the reaction barrier of an s@xmath02 reaction , we have tested single - shot active space energies with ccsd as an active space solver , the dmet energy formula where only one impurity is treated with ccsd as the high - level method , and the dmet energy formula where all impurities are treated with ccsd as the high - level method .",
    "in addition , we compare the accuracy of a large cutoff - based bath orbital space with the selection of one bath orbital per chemical bond cut .",
    "we have found that the active space _ relative _ energies converge the fastest to the ccsd calculations for the full system .",
    "this is because the standard dmet democratic evaluation of expectation values across fragments does not provide optimal error cancellation when only local changes in a single fragment take place .",
    "thus , for molecular applications , when reactions occurs locally , the single - shot dmet active space energies with one bath orbital per chemical bond cut provide the most reliable description . note that if fci is used as an active space solver , this exactly corresponds to a cas - ci calculation , with dmet providing a natural way to define the _ relevant _ active space .",
    "s.w . gratefully acknowledges a gustave bol - sofina - b.a.e.f .",
    "postdoctoral fellowship from the king baudouin foundation and the belgian - american educational foundation for the academic year 2014 - 2015 .",
    "g. k .- l .",
    "c. acknowledges support from the us department of energy through de - sc0010530 .",
    "additional support was provided from the simons foundation through the simons collaboration on the many - electron problem .",
    "consider a change @xmath154 in one particular value of the correlation potential .",
    "the change in the mean - field operator can be written as : @xmath155 where both @xmath156 and @xmath157 are hermitian @xmath158 matrices . with the mean - field solution : @xmath159 \\left [ \\begin{array}{cc } e^0_{\\text{occ } } & \\\\ & e^0_{\\text{vir } } \\end{array } \\right ] \\left [ \\begin{array}{c } c_{\\text{occ}}^{0,\\dagger } \\\\ c_{\\text{vir}}^{0,\\dagger } \\end{array } \\right],\\ ] ] one can solve for the first order ( rayleigh - schrdinger ) response equation : @xmath160 the matrices @xmath161 have the shape @xmath162 and represent the order @xmath98 occupied orbitals .",
    "the matrices @xmath163 have the shape @xmath164 and represent the order @xmath98 virtual orbitals .",
    "the diagonal matrix @xmath165 has the shape @xmath166 and represents the occupied orbital energies , and likewise for @xmath167 .",
    "the occupied first order response orbitals are orthogonal to the ground - state orbitals : @xmath168 this allows to rewrite eq .",
    "as @xmath169 by virtue of eq . , the response orbitals can be written as @xmath170 the entries of the @xmath171 matrix @xmath172 can be found with eq .",
    ": @xmath173 finally , the first order response of the density matrix can be obtained as : @xmath174 \\right|_{\\delta=0 } \\nonumber \\\\ & = & c^0_{\\text{occ } } c^{1,\\dagger}_{\\text{occ } } + c^1_{\\text{occ } } c^{0,\\dagger}_{\\text{occ } } = c^0_{\\text{occ } } z^{1,\\dagger } c^{0,\\dagger}_{\\text{vir } } + c^0_{\\text{vir } } z^1 c^{0,\\dagger}_{\\text{occ}}.\\end{aligned}\\ ] ]"
  ],
  "abstract_text": [
    "<S> density matrix embedding theory ( dmet ) [ http://dx.doi.org/10.1103/physrevlett.109.186404[knizia and chan , _ phys . </S>",
    "<S> rev . </S>",
    "<S> lett . _ * 109 * , 186404 ( 2012 ) ] ] provides a theoretical framework to treat finite fragments in the presence of a surrounding molecular or bulk environment , even when there is significant correlation or entanglement between the two . in this work </S>",
    "<S> , we give a practically oriented and explicit description of the numerical and theoretical formulation of dmet . </S>",
    "<S> we also describe in detail how to perform self - consistent dmet optimizations . </S>",
    "<S> we explore different embedding strategies with and without a self - consistency condition in hydrogen rings , beryllium rings , and a sample s@xmath02 reaction . </S>",
    "<S> the source code for the calculations in this work can be obtained from https://github.com/sebwouters/qc-dmet . </S>"
  ]
}