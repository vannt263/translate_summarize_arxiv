{
  "article_text": [
    "stiff networks of differential equations rather uniformly have been viewed as requiring special implicit or semi - implicit methods for integration in order to maintain stability while taking reasonably efficient timesteps @xcite .",
    "purely explicit methods are not competitive in speed for most applications because they are limited by stability criteria to integration timesteps that are far too short .",
    "various asymptotic and steady - state schemes have been proposed to stabilize explicit methods by removing some of their stiffness ( overviews may be found in refs.@xcite ) .",
    "these methods have had some success in moderately stiff systems , but it generally has been concluded that in very stiff systems , such as those encountered in astrophysical thermonuclear networks , asymptotic and steady - state schemes do not work @xcite .    in a preceding paper on asymptotic methods @xcite , the present paper on quasi - steady - state ( qss ) methods , and a following paper on partial equilibrium methods @xcite , we challenge these conclusions and present strong evidence that algebraically - stabilized explicit integration may in fact not only compete with , but in some cases may have the potential to outperform traditional implicit methods , even for the stiffest networks . in this paper",
    "we deal specifically with the qss method and show that , for systems well removed from equilibrium , the qss approximation can give highly - competitive integration of extremely - stiff systems .",
    "let us begin by introducing the quasi - steady - state approximation .",
    "we wish to solve @xmath0 coupled ordinary differential equations @xmath1 where @xmath2 describes the dependent ( abundance ) variables , @xmath3 is the independent variable ( time in our examples ) , @xmath4 denotes the flux between species @xmath5 and @xmath6 , the sum for each variable @xmath5 is over all variables @xmath6 coupled to @xmath5 by a non - zero flux @xmath4 , and the flux has been decomposed into a component @xmath7 increasing the abundance of @xmath8 and a component @xmath9 depleting it . for an @xmath0-species network there will be @xmath0 such equations in the populations @xmath8 , and they generally will be coupled to each other because of the dependence of the fluxes on the different @xmath10 .    if one attempts to integrate these equations numerically by ordinary forward difference , severe stability problems will be encountered for networks in which the various rate parameters appearing in the terms on the right side of eq .",
    "( [ eq1.1 ] ) range over many orders of magnitude in size .",
    "this is the problem of _ stiffness_. the traditional solution is to invoke implicit methods , which are stable even in the face of extremely stiff equations .",
    "an alternative explicit algebraic solution to the coupled differential equations uses the quasi - steady - state ( qss ) approximations developed by mott and collaborators @xcite , which was partially motivated by earlier work in refs.@xcite .",
    "we follow mott et al @xcite by first noting that eq .",
    "( [ eq1.1 ] ) in the form @xmath11 ( where we have suppressed indices for notational convenience ) has the analytical solution @xmath12 for constant @xmath13 and @xmath14 . in the qss method",
    "this equation then serves as the basis of a predictor  corrector scheme in which a prediction is made using initial values and a corrector is then applied that uses a combination of initial values and values computed using the predictor solution . defining a parameter @xmath15 by @xmath16 where @xmath17 with @xmath18 the integration timestep",
    ", we adopt a predictor @xmath19 and corresponding corrector @xmath20 proposed originally by mott et al @xcite , @xmath21 where @xmath22 is evaluated from eq .",
    "( [ qss1.1 ] ) with @xmath23 , an average rate parameter is defined by @xmath24 , @xmath25 is specified by eq .",
    "( [ qss1.1 ] ) with @xmath26 , and @xmath27 if desired , the corrector can be iterated by using @xmath20 from one iteration step as the @xmath19 for the next iteration step .",
    "we implement an explicit qss algorithm based on the predictor ",
    "corrector pair ( [ qss1.2 ] ) in a manner analogous to that described in the preceding paper for the asymptotic method @xcite , except that for the qss algorithm we treat all equations by the qss approximation , rather than dividing them into a set treated by explicit forward difference and a set treated in asymptotic approximation , as we did in ref .",
    "to integrate the equations ( [ eq1.1 ] ) using the predictor  corrector ( [ qss1.2 ] ) , we employ a simple timestepping algorithm analogous to that already described in more detail in the preceding asymptotic paper @xcite :    1 .   at the beginning of a new timestep ,",
    "compute a trial timestep based on limiting the change in population that would result from that timestep to a specified tolerance .",
    "choose the minimum of this trial timestep and the timestep that was taken in the previous integration timestep as the timestep , and update all populations by the quasi - steady - state algorithm described above .",
    "check the results for conservation of particle number within a specified tolerance range .",
    "if the condition is not satisfied , increase or decrease the timestep as appropriate by a small factor and repeat the calculation with the original fluxes .",
    "accept this result for the populations and carry the new timestep over as a starting point for the next timestep .",
    "this timestepper is not particularly sophisticated but we have found it to be stable and accurate for a variety of astrophysical thermonuclear networks that we have tested .",
    "as we have discussed in more detail in refs .",
    "@xcite , there are two forms of equilibrium that concern us in explicit integration of stiff reaction networks .",
    "these may be displayed clearly if we decompose @xmath7 and @xmath9 for a species @xmath5 in eq .",
    "( [ eq1.1 ] ) into a set of terms depending on the other populations in the network ( labeled by the index @xmath6 ) , @xmath28 we shall refer to _ macroscopic equilibration _ if @xmath29 approaches a constant .",
    "this is the basis for the asymptotic approximations discussed in ref .",
    "@xcite and the quasi - steady - state approximation to be discussed in this paper .",
    "however , at a more microscopic level , groups of individual terms on the right side of eq .",
    "( [ equildecomposition ] ) may come approximately into equilibrium ( so that the sum of their fluxes is approximately zero ) , even if the macroscopic conditions for equilibration are not satisfied .",
    "this corresponds to equilibration for individual forward  reverse reaction pairs such as @xmath30 .",
    "this process , which may occur even if the conditions for macroscopic equilibration are not satisfied , we shall term _ microscopic equilibration_. these definitions then permit us to identify three distinct categories of stiffness that may occur in a reaction network @xcite :    1",
    ".   small populations can become negative if the explicit timestep is too large , with the propagation of this anomalous negative population leading to destabilizing terms that grow exponentially .",
    "macroscopic equilibration , where taking the difference @xmath31 leads to large errors if the timestep is too large .",
    "microscopic equilibration , where taking the net flux in specific forward - reverse reaction pairs @xmath32 leads to large errors if the timestep is too large .",
    "these distinctions are crucial for our goal of integrating stiff equations explicitly by identifying sources of stiffness in the network and removing them by algebraic means because the qss method and asymptotic methods remove only the first two kinds of stiffness .",
    "removal of the third kind of stiffness will require the partial equilibrium methods that will be discussed in the third paper in this series @xcite .",
    "thus , it will be important for our discussion to have a quantitative measure of microscopic equilibration",
    ". we shall describe this in detail in ref .",
    "@xcite for thermonuclear networks , and the basics have been worked out by mott @xcite , so we just quote without proof the results that will be relevant for the present discussion .",
    "we assume that the amount of microscopic equilibration in a network is measured by the fraction of forward ",
    "reverse reaction pairs @xmath33 that are judged to be in equilibrium ( with each reaction pair considered separately ) .",
    "the variation of the populations @xmath8 with time during a numerical integration timestep may be approximated for each reaction pair by a differential equation @xmath34 where the parameters @xmath35 , @xmath36 , and @xmath37 are known functions of the current rate parameters and the abundances at the beginning of the timestep .",
    "this equation may be solved for the equilibrium abundance @xmath38 of each species , giving @xmath39 where @xmath40 and the single timescale @xmath41 governs the approach to equilibrium .",
    "we may then estimate whether a given reaction is near equilibrium at time @xmath3 by requiring @xmath42 for each species @xmath5 involved in the reaction , where @xmath43 is the actual abundance , @xmath38 is the equilibrium abundance ( [ 2body1.6 ] ) , and @xmath44 is a tolerance , typically of order @xmath45 . the remainder of this paper will emphasize methods based on quasi - steady - state approximations to stabilize explicit integration for networks that are at most weakly equilibrated by the above criteria , with the corresponding stabilization of networks near equilibrium to be discussed in @xcite .",
    "in examples to be shown below we shall be comparing explicit and implicit methods using codes that are at very different stages of development and optimization .",
    "thus they can not simply be compared head to head .",
    "implicit methods spend increasing amounts of integration time inverting matrices as networks become larger . thus , explicit methods  which require no matrix inversions  can generally compute each timestep faster . let us assume roughly that the speedup factor for explicit versus implicit methods for integrating a timestep is @xmath46 , where @xmath47 is the fraction of computing time spent by the implicit algorithm in matrix operations . using data obtained by feger @xcite with the implicit , backward - euler code xnet @xcite employing both dense and sparse matrix solvers , we adopt for our discussion the factors @xmath48 listed in table [ tb : explicitspeedup ] .",
    "@lll network&isotopes&speedup @xmath48 + cno ( main ) & 8 & @xmath49 + alpha & 16 & 3 + cno extended & 18 & 3 + nova & 134 & 7 + 150-isotope & 150 & 7.5 + 365-isotope & 365 & @xmath50 +    we will then make a simple estimate of the relative speed of explicit versus implicit algorithms by multiplying the factor @xmath48 by the ratio of integration timesteps for implicit and explicit integrations for a given problem .",
    "this probably underestimates the relative speed of an optimized explicit versus optimized implicit code for reasons discussed in ref .",
    "@xcite , but it will allow us to place a lower bound on how fast the explicit calculation can be .",
    "in earlier applications of asymptotic and steady - state methods in chemical reaction networks , evidence was presented that quasi - steady - state ( qss ) approximations gave more accurate , stable , and faster solutions than asymptotic approximations @xcite , but that both approximations failed when applied to the extremely stiff systems characteristic of astrophysical thermonuclear networks @xcite . in a preceding paper",
    "we have investigated the use of explicit asymptotic approximations for extremely stiff astrophysical networks and concluded that the asymptotic approximation in fact works quite well for even the stiffest networks , provided that they are not too close to equilibrium @xcite .",
    "we now wish to revisit the utility of qss methods for extremely stiff networks , comparing them with results from both asymptotic and implicit calculations for some representative extremely stiff astrophysical networks of varying sizes . in the general case",
    ", we shall find that both asymptotic and qss methods are capable of solving extremely stiff networks stably and accurately , but that qss approximations often allow somewhat larger timesteps than the corresponding asymptotic approximation calculation .",
    "we shall find that these timesteps for both qss and asymptotic approximations are often quite competitive with those of a standard implicit code for systems that are not near microscopic equilibrium .      for the astrophysical examples given in the remainder of this paper",
    ", the generic population variables @xmath8 ( assumed to be proportional to the number density for the species @xmath5 ) will be replaced with the mass fractions @xmath51 .",
    "these satisfy @xmath52 where @xmath53 is avogadro s number , @xmath54 is the total mass density , @xmath55 is the atomic mass number , and @xmath56 is the number density for the species @xmath5 .      fig .",
    "[ fig : cnoxnetasyqsscompare ] illustrates a comparison of qss , asymptotic , and implicit methods for the main branch of the astrophysical cno cycle ,     comparison of asymptotic , quasi - steady - state , and implicit approximations for the main branch of the cno cycle at a constant temperature of 20 million k ( @xmath57 ) and constant density @xmath58 , with initial abundances of solar composition .",
    "this network corresponds to 8 isotopes and 18 reaction couplings , with reaction rates taken from the reaclib library @xcite .",
    "( a )  isotopic mass fractions .",
    "solid curves are implicit ( xnet @xcite ) , dashed are qss and asymptotic .",
    "( b )  integration timesteps .",
    "the calculation shown used three iterations for the qss method , which provided marginal improvement over a single iteration . ]",
    "which is illustrated in fig .",
    "[ fig : cnocycle ] .",
    "[ fig : cnocycle ]    the calculated mass fractions are almost identical for the three approaches .",
    "the timestepping for the qss and asymptotic integrations is also very similar , except for a small region approaching hydrogen depletion ( @xmath59 ) where the qss method is able to take timesteps 1 - 2 orders of magnitude larger than the asymptotic method .",
    "this translates into an overall improvement of roughly a factor of two in time to complete the calculation .",
    "the timestepping for the implicit method is seen to be very similar to that of the two explicit methods except for the range @xmath60 to @xmath61 , where the implicit method averages 10100 times larger timesteps than the qss method .",
    "the fastest stable timestep for a purely explicit method in this calculation is of order 100 seconds and therefore is far off the bottom of the scale in fig .",
    "[ fig : cnoxnetasyqsscompare ] .",
    "we note that at the end of the calculation the qss and asymptotic timesteps are about @xmath62 times larger than would be stable for a purely explicit calculation .",
    "although this larger timestepping for the implicit method is confined to a small region in fig .",
    "[ fig : cnoxnetasyqsscompare ] , this is quite significant for the overall integration time ( a fact partially obscured by the log  log plot ) .",
    "the two explicit methods spend the bulk ( 97% for the asymptotic calculation , for example ) of their total integration times in the region from @xmath60 to @xmath61 , where the implicit integration is taking timesteps 10100 times larger than the explicit methods .",
    "this translates into 292 total integration steps for the implicit code , 15,484 for qss , and 210,398 for the asymptotic calculation .",
    "the explicit methods , once optimized , may be expected to compute these timesteps faster , but for a network this small that advantage will likely be only a factor of two or so ( table [ tb : explicitspeedup ] ) .",
    "thus the qss method needs at least another factor of 25 in speed for the calculation of fig .",
    "[ fig : cnoxnetasyqsscompare ] to compete with the fastest implicit integration of the cno cycle .",
    "that is not very important practically for a single integration of this simple network , since any of the three methods can integrate it to hydrogen depletion in a fraction of a second on a modern processor , but if the network were integrated many times the difference would become significant .    in fig .",
    "[ fig : cnoextendedqssasyxnetxdt ] we compare qss , asymptotic , and fully implicit calculations for an extended cno network     comparison of implicit ( xnet ) , quasi - steady - state , and asymptotic approximations for an extended cno cycle at a constant temperature of @xmath63 and constant density @xmath58 , with initial abundances of solar composition .",
    "this network corresponds to 18 isotopes and 131 reaction couplings , with reaction rates taken from the reaclib library @xcite .",
    "( a )  isotopic mass fractions .",
    "( b )  integration timesteps .",
    "the calculation shown used 1 iteration for the qss method . ]    ( corresponding to the full network shown on the left side of fig .",
    "[ fig : cnocycle ] plus several additional isotopes ) . in this case",
    "we see that all three methods give essentially the same mass fractions and similar timestepping , except for a short period near @xmath64 where the implicit calculation takes timesteps as much as 100 times larger than the other methods .",
    "note that in this example there is almost no difference between the qss and asymptotic timestepping , unlike the case in fig .",
    "[ fig : cnoxnetasyqsscompare ] where the qss calculation is faster .",
    "once again , the log  log scale somewhat obscures that the explicit methods need another factor of @xmath6515 in speed to be as fast as the implicit calculation ( the implicit code took 348 total steps , the qss code took 10,101 steps , and the asymptotic code took 13,095 steps for this case ) , but all three methods can compute the network to hydrogen depletion in less than a second of processor time . as for fig .  [ fig : cnoxnetasyqsscompare ] , the fastest stable timestep for a purely explicit method in this calculation is of order 100 seconds and therefore is off the bottom of the scale in fig .",
    "[ fig : cnoextendedqssasyxnetxdt ] . at the end of the calculation",
    "the qss and asymptotic timesteps are about @xmath66 times larger than would be stable for a purely explicit calculation .",
    "we speculate that the reason the qss and asymptotic timesteps lag behind the implicit method timesteps only for the range @xmath64 is that this is roughly the time period when the cno cycle is running in steady state ( approximately constant abundances for the carbon ",
    "oxygen isotopes , as hydrogen is being converted to helium at a nearly constant rate ) , up until the hydrogen begins to be significantly depleted ; see fig .  [",
    "fig : cnoxnetasyqsscompare](a ) . in that period",
    "the cno cycle running in steady state establishes a new timescale in the system , which is the time characteristic of restoring the cycle equilibrium if it were disturbed . from fig .",
    "[ fig : cnoxnetasyqsscompare](a ) we may estimate that this timescale is approximately @xmath67 s , since this was the time to establish steady state initially .",
    "neither the asymptotic nor qss approximations remove the specialized stiffness associated with this cycling timescale completely ( nor would the partial equilibrium approximation as we have formulated it , since the cycle does not have reversible reactions ) .",
    "thus the explicit timestep stops growing around @xmath68 s because substantially larger explicit timesteps would not be able to resolve and respond to fluctuations in the cno equilibrium .",
    "this remains true until the onset of hydrogen depletion removes this timescale and the explicit method is again able to increase its timesteps rapidly .",
    "this suggests that a modification of the explicit methods to replace the cycle with an analytical approximation when it is running near steady state should permit the explicit methods to increase their timesteps competitively in the time period @xmath64 .    in the preceding cno - cycle calculations the implicit method is superior , performing the integration more than an order of magnitude faster than the explicit methods",
    "however , the remarkable result is not that the implicit algorithm is faster .",
    "rather , it is that the qss method has made up almost 19 of the 20 orders of magnitude difference between the integration speed of a purely explicit method relative to the implicit method , and that the remaining order of magnitude is likely because of a highly - specialized stiffness associated with cycling that has not yet been dealt with in the explicit networks .",
    "this interpretation is bolstered by applying the qss method to the astrophysical pp - chains , which are comparable in stiffness to the cno cycle but do not exhibit cycling .",
    "figure [ fig : ppchains ]     ( where @xmath69 denotes temperature in units of @xmath70 k ) and constant density @xmath71 , assuming solar initial abundances .",
    "reaction rates were taken from the reaclib library @xcite .",
    "( a )  mass fractions for the asymptotic method , the qss method , and for the standard implicit code xnet @xcite .",
    "( b )  integration timesteps . ]    [ fig : ppchains ]    displays integration of the pp - chains at a constant temperature and density characteristic of the core in the present sun using the qss method and the implicit backward - euler code xnet @xcite . in this example",
    "we see that the qss method has made up essentially all of the more than 20 orders of magnitude difference between implicit and purely explicit timestepping .",
    "this gives integration speeds about the same as for the implicit method : the implicit code required only 176 integration steps versus 286 for the qss method , but from table [ tb : explicitspeedup ] each timestep for the 7-isotope pp - chain network can probably be calculated @xmath651.5 times faster using the explicit code .      in fig .",
    "[ fig : xdt_t9_10rho5e7alpha ]     comparison of asymptotic and quasi - steady - state approximations for an alpha network at a constant temperature of @xmath72 and constant density @xmath73 , with initial equal mass fractions of and , and reaction rates specified by reaclib @xcite .",
    "the network contained 16 isotopes with 46 reaction couplings . also shown are results from the implicit code xnet @xcite .",
    "( a )  isotopic mass fractions .",
    "( b )  integration timesteps .",
    "solid curves are asymptotic , dashed curves are qss , and dotted curves are implicit ; the dotted blue curve estimates the maximum stable purely explicit timestep .",
    "the inset to ( b ) shows the fraction of reactions equilibrated as a function of time .",
    "the calculation shown used one iteration for the qss method ; additional iterations did not lead to substantial improvement . ]",
    "we compare asymptotic and qss calculations for an alpha - particle network at a constant temperature of @xmath72 and constant density @xmath74 , which represents conditions that might be found for a strong detonation wave in a type ia supernova simulation .",
    "we see that the mass fractions computed in the two cases are essentially the same , except for some small differences in the weaker populations near @xmath75 . at earlier times",
    "the asymptotic method gives somewhat larger timesteps but at intermediate times corresponding to maximal burning the qss timesteps are as much as an order of magnitude larger .",
    "the qss and asymptotic integration times are also seen to be rather competitive with those of the implicit calculation .",
    "the total calculation required 1464 asymptotic timesteps , 714 qss timesteps , and 329 implicit timesteps .",
    "since an explicit timestep can be computed about 3 times faster by the explicit methods relative to the implicit method for this 16-isotope network ( table [ tb : explicitspeedup ] ) , equivalently - optimized versions of all three methods would be rather similar in speed .    consulting the inset to fig .",
    "[ fig : xdt_t9_10rho5e7alpha](b ) , we see that almost no reactions become microscopically equilibrated until very late in the calculation , which explains the competitive explicit qss and asymptotic timesteps over most of the integration range . although the amount of partial equilibrium is small until late in the preceding calculation , this still has a significant negative impact on the qss and asymptotic timesteps . in ref.@xcite",
    "we shall implement a partial equilibrium formalism to deal with this .",
    "if those methods are applied to the present problem , the required number of integration steps is reduced from 714 to 313 for the qss method and from 1464 to 322 for the asymptotic method .",
    "thus , with partial equilibrium accounted for the calculation of fig .",
    "[ fig : xdt_t9_10rho5e7alpha ] would become several times faster for both qss and asymptotic methods relative to the implicit calculation , by virtue of the speedup factor of about 3 for the explicit method from table [ tb : explicitspeedup ] .",
    "the qss method can be iterated to improve the solution @xcite .",
    "the calculation shown in fig .",
    "[ fig : cnoxnetasyqsscompare ] used three qss iterations , but a single iteration gave results almost as good . the calculation shown in fig .",
    "[ fig : xdt_t9_10rho5e7alpha ] used a single iteration and was not significantly improved by additional iterations . in our tests on very stiff thermonuclear networks ,",
    "we have found that iterating the qss solution does not generally give significantly better results than a single - iteration calculation , but can improve the speed corresponding to a given precision in some cases by factors of two .    in fig .",
    "[ fig : x_dt365t9_10rho_5e7qss ]     a 365-isotope network integrated at constant temperature @xmath72 and constant density @xmath76 , for an initial concentration of half and half by mass fraction .",
    "the network contained 365 isotopes and 4325 reaction couplings , with the reaction rates supplied by reaclib @xcite.(a )  isotopic mass fractions for the quasi - steady - state ( qss ) method .",
    "( b )  integration timesteps for the asymptotic method ( solid green curve ) , the qss method ( dashed red curve ) , and the implicit code xnet @xcite ( dotted orange curve ) .",
    "the maximum stable timestep for a normal explicit calculation ( dashed blue curve ) was estimated as the inverse of the fastest rate in the network . ]",
    "we display mass fractions for the qss method and compare timestepping for the qss , asymptotic , and explicit methods for the same conditions as in fig .",
    "[ fig : xdt_t9_10rho5e7alpha ] , but for a 365-isotope network .",
    "since there are so many mass - fraction curves in fig .",
    "[ fig : x_dt365t9_10rho_5e7qss](a ) , we do not attempt to compare them directly with an asymptotic or implicit calculation . however , in ref",
    ".  @xcite we established the equivalence of mass fractions calculated by standard implicit and asymptotic approximations , and in fig .",
    "[ fig : compareasyqssde_t9_10rho5e-7_365](a )     ( a )  comparison of differential energy production calculated by qss ( dotted red curve ) and asymptotic approximations @xcite ( solid green curve ) for the 365-isotope network of fig .",
    "[ fig : x_dt365t9_10rho_5e7qss ] .",
    "the energy production changes sign near @xmath77 , so we plot the log of the absolute value of @xmath78 and indicate its sign on the curve .",
    "( b )  fraction of reactions microscopically equilibrated in the qss calculation . ]",
    "we compare the differential energy production ( a strong proxy for evolution of the isotopic number densities ) for the network in fig .",
    "[ fig : x_dt365t9_10rho_5e7qss ] calculated by qss and asymptotic methods .",
    "the curves are in almost perfect agreement , and the integrated energy release corresponding to the simulation of fig .",
    "[ fig : x_dt365t9_10rho_5e7qss ] differed by less than 0.2% between qss and asymptotic calculations .    for this example",
    "the qss calculation used two iterations of the predictor  corrector algorithm ( [ qss1.2 ] ) , which permitted almost a factor of two larger timestep size than for one iteration .",
    "computing the rates is the most time - consuming operation in an explicit timestep .",
    "since a predictor  corrector iteration recomputes the fluxes by multiplying the rates by the new populations from the predictor step but does not recompute the rates , it does not cost much . in this case , once the rates have been calculated at the current temperature and density , each iteration increases the time to compute the timestep by only a few percent .",
    "the methods all take similar timesteps until @xmath79 , after which the qss calculation takes somewhat larger timesteps than the asymptotic method , while the implicit calculation takes timesteps that average about 10 times larger than the qss method . as a result , for the entire calculation the implicit code required 444 integration steps , the qss code required 4398 steps , and the asymptotic code required 9739 steps .",
    "the timestep advantage of the implicit code over the qss code by about a factor of 10 will be approximately canceled by the @xmath50 times faster computation of each timestep by the explicit code for a 365-isotope network ( see table [ tb : explicitspeedup ] ) .",
    "thus , for the case in fig .",
    "[ fig : x_dt365t9_10rho_5e7qss ] we expect that for optimized codes the qss and implicit methods would have similar speeds , and the asymptotic method would be about a factor of two slower .    in fig .",
    "[ fig : compareasyqssde_t9_10rho5e-7_365](b ) we plot the fraction of reactions in the network that become microscopically equilibrated .",
    "the reason that the implicit code is able to take larger timesteps than the explicit codes for @xmath80 in the 365-isotope case now becomes clear : that is exactly where partial equilibrium begins to play a role . because the fraction of partially - equilibrated reactions reaches only @xmath6515% in this calculation , the explicit methods are still able to compete favorably , but as we have already seen for the alpha network of fig .",
    "[ fig : xdt_t9_10rho5e7alpha ] , and as we shall see further later in this paper and in ref .",
    "@xcite , even a small partial - equilibrium fraction can have a large negative influence on the explicit integration timestep .",
    "the impact on the total integration time for the present examples will be amplified because the qss calculation in fig .",
    "[ fig : x_dt365t9_10rho_5e7qss ] expends more than 90% of its integration steps for times where partial equilibrium is significant ( while in the alpha network of fig .",
    "[ fig : xdt_t9_10rho5e7alpha ] the corresponding fraction is about 75% ) .",
    "thus , we may expect that a proper treatment of partial equilibrium in this case should lead to an explicit qss or asymptotic timestep that is much larger , implying a substantial speed advantage for each of the two explicit methods versus the implicit method , once proper account has been taken of partial equilibrium .",
    "a comparison of asymptotic and qss mass fractions and timesteps is shown in fig .",
    "[ fig : tidalalphaasyqss_x_dt ]     comparison of asymptotic and quasi - steady - state approximation calculations for an alpha network calculation using the hydrodynamical profile shown in fig .",
    "[ fig : tidalalphahydroprofile ] . ( a )  mass fractions ( solid lines asymptotic , dashed lines qss ; they are almost indistinguishable ) .",
    "( b )  integration timesteps for asymptotic ( solid ) and qss ( dashed ) in the strong burning region .",
    "the qss calculation shown used three iterations but one or two iterations gave similar results . ]    for an alpha network with a hydrodynamical profile characteristic of a supernova induced by tidal interactions in a white dwarf ( illustrated in fig .",
    "[ fig : tidalalphahydroprofile ] ) .",
    "hydrodynamical profiles for temperature and density under tidal supernova conditions @xcite . ]",
    "we see that in the critical strong - burning region the qss approximation is able to take timesteps that are about an order of magnitude faster than the asymptotic method .",
    "( outside this region the timesteps are similar for the two methods . )",
    "the timestepping over the entire integration range is compared for qss , an asymptotic calculation , and the implicit code xnet in fig .",
    "[ fig : tidalalpha_dtplusfractionqss](a ) .     ( a )",
    "qss integration timesteps ( solid red ) , asymptotic integration timesteps ( dotted orange ) , integration steps for the implicit code xnet @xcite ( solid green ) , and maximum stable purely - explicit step ( dashed blue ) , for the calculation in fig .",
    "[ fig : tidalalphaasyqss_x_dt ] .",
    "( b )  fraction of isotopes that become asymptotic and fraction of reactions equilibrated in the network . ]    the qss timestepping ( 242 total integration steps ) is somewhat better than for the asymptotic method ( 480 steps ) and considerably better than for the implicit code ( 2136 steps ) . for an alpha network",
    "an optimized explicit code can compute timesteps about three times as fast as an implicit code ( table [ tb : explicitspeedup ] ) , so we may estimate that the qss code is capable of calculating this network some 15 times faster , and the asymptotic code perhaps 10 times faster , than the implicit code .",
    "results almost as good as those presented above for networks under tidal supernova conditions using the qss method have been found in refs .",
    "@xcite using the explicit asymptotic method .",
    "although a different set of reaction network rates was used in these references , the explicit asymptotic method was found to be highly competitive with standard implicit methods for the tidal supernova problem .",
    "the good qss and asymptotic timestepping for this case is primarily because essentially no reactions in the network come into equilibrium , as illustrated in fig .",
    "[ fig : tidalalpha_dtplusfractionqss](b ) . note in this connection that the flat mass fraction curves at late times in fig .",
    "[ fig : tidalalphaasyqss_x_dt](a ) are not a result of equilibrium , but rather of reaction freezeout caused by the temperature and density dropping quickly at late times as the system expands ( see fig .",
    "[ fig : tidalalphahydroprofile ] ) .",
    "it is this rapid decrease of all thermal reaction rates to zero at later times that prevents microscopic equilibration from playing a significant role for this case .",
    "the dashed blue curve in fig .  [ fig : tidalalpha_dtplusfractionqss](a ) represents the estimated fastest stable purely - explicit timestep . by comparing this curve with the qss and asymptotic timestep curves we see that , unlike most of the cases we are investigating , this system is only moderately stiff .",
    "the maximum difference between the actual timestep and the maximum stable purely - explicit timestep is about 4 orders of magnitude .",
    "furthermore , for @xmath81 and @xmath82 the maximum stable purely - explicit timestep is _ larger _ than the actual timestep ; thus in these regions the stiffness instability plays no role in setting the explicit qss or explicit asymptotic timestep . this might suggest that it is the relatively moderate stiffness of this problem compared with most in astrophysics that makes the qss and asymptotic methods particularly efficient for this case .",
    "however , comparison with a number of other cases ( see for example , the nova calculation in  [ novaexplosions ] ) indicates that this is not correct : it is not the _ amount _ of stiffness ( as inferred from differences in ranges of timescales in the problem ) but rather the _ nature _ of the stiffness that is crucial .",
    "the qss and asymptotic methods are capable of removing many orders of magnitude of stiffness caused by macroscopic equilibration ( for example , see fig .",
    "[ fig : nova125d_dtplusfractionqss](a ) below ) , but are poor at removing stiffness caused by microscopic equilibration .",
    "let us turn now to an example involving a large and extremely stiff network . in fig .",
    "[ fig : nova125d_xplushydroprofileqss](a )     ( a )  mass fractions for a network under nova conditions , corresponding to the hydrodynamical profile shown in ( b ) .",
    "the calculation used the qss method and a network containing 134 isotopes coupled by 1531 reactions , with rates taken from the reaclib library @xcite and initial abundances enriched in heavy elements @xcite . ]",
    "we illustrate a calculation using the explicit qss algorithm with a hydrodynamical profile displayed in fig .",
    "[ fig : nova125d_xplushydroprofileqss](b ) that is characteristic of a nova outburst . given the large number of mass - fraction curves , we do not attempt to compare them directly with an asymptotic or implicit calculation , but we note that the total integrated energy release corresponding to the simulation of fig .  [ fig : nova125d_xplushydroprofileqss ] was within 1% of that found for the same network using the explicit asymptotic approximation in ref .",
    "the integration timesteps for the calculation in fig .",
    "[ fig : nova125d_xplushydroprofileqss](a ) are displayed in fig .",
    "[ fig : nova125d_dtplusfractionqss](a ) .",
    "( a )  timesteps for integration of fig .",
    "[ fig : nova125d_xplushydroprofileqss ] .",
    "the solid red curve is from the qss calculation .",
    "the dotted orange curve is from an explicit asymptotic calculation @xcite .",
    "the dotted green curve is from an implicit integration using the backward - euler code xnet @xcite .",
    "the dashed blue curve estimates the largest stable fully explicit timestep as the inverse of the fastest rate in the system .",
    "( b )  fraction of reactions that reach partial equilibrium in the qss calculation . ]",
    "once burning commences , the qss solver ( solid red curve in fig .",
    "[ fig : nova125d_dtplusfractionqss](a ) ) takes timesteps that are from @xmath83 to @xmath84 times larger than would be stable for a normal explicit integration .",
    "the explicit qss timesteps illustrated in fig .",
    "[ fig : nova125d_dtplusfractionqss](a ) are somewhat larger than those of our asymptotic solver ( dotted orange curve ) , and comparable to or greater than those for a typical implicit code over the whole integration range , as may be seen by comparing with the implicit ( backward euler ) calculation timestepping curve shown in dotted green . in this calculation",
    "the implicit method required 1332 integration steps , the explicit asymptotic calculation required 935 steps , and the qss method required 777 steps . given that for a network with 134 isotopes the explicit codes should be able to calculate an integration timestep about 7 times faster than an implicit code because they avoid the manipulation of large matrices ( table [ tb : explicitspeedup ] ) , these results suggest that the explicit qss code is capable of calculating the nova network more than 10 times faster and the explicit asymptotic code more than 5 times faster than a state - of - the - art implicit code .",
    "this impressive integration speed for both the qss and asymptotic methods applied to a large , extremely stiff network is possible because few reactions reach microscopic equilibrium during the simulation , as illustrated in fig .",
    "[ fig : nova125d_dtplusfractionqss](b ) .",
    "thus the entire nova simulation , just as for the tidal supernova simulation and the type ia supernova detonation wave simulation until very late in the calculation , lies within a domain where we expect both the qss and asymptotic explicit methods to be highly effective in removing stiffness from the network . in refs .  @xcite the explicit asymptotic method was applied to a nova simulation .",
    "although this calculation differed from the present one in using asymptotic methods , a different nova hydrodynamical profile , and a different reaction library , results rather similar to those presented above were obtained .",
    "we conclude that the explicit qss and asymptotic methods may intrinsically be considerably faster than a state - of - the art implicit code for simulations of nova outbursts .",
    "except for late in the calculation for the supernova detonation wave in",
    " [ sn1adetonation ] , the examples shown to this point have involved networks in which few reactions have become microscopically equilibrated by the criteria of  [ sh : large - stiff ] . for such cases",
    "we have seen that the integration speed for qss and asymptotic explicit methods is often comparable to , and in some cases exceeds , that for current implicit codes .",
    "let us now turn to a representative example where this is no longer true .",
    "the calculation in fig .",
    "[ fig : compare_dt_asy_qsst9_5rho1e8alpha ]     comparison of asymptotic and quasi - steady - state approximations for an alpha network with constant temperature @xmath85 and constant density of @xmath86 , using reaclib rates @xcite and initial equal mass fractions of and .",
    "( a )  isotopic mass fractions .",
    "( b )  integration timesteps ( left axis ) and fraction of reaction in partial equilibrium ( right axis ) .",
    "the gray shaded area represents roughly the region that the explicit timestep profile must lie in to have a chance to compete with implicit methods .",
    "the different asymptotic methods are labeled asy and are described in ref .",
    "the implicit calculation was made with xnet @xcite and the dashed green line ( pe ) represents the timestepping for a partial equilibrium calculation that will be discussed in a later publication @xcite .",
    "the qss calculation was run with a single iteration . ]",
    "compares qss and several different asymptotic approximations with an implicit calculation for an alpha network at a constant temperature and density characteristic of a type ia supernova explosion .",
    "we may draw two important conclusions from these results .    1 .",
    "although there are some differences among the qss and various asymptotic methods , we see that they all give essentially the same results , with timestepping that is rather similar , though timestepping differences of up to factors of 5 - 10 may be found in localized time regions .",
    "all of the qss and asymptotic cases shown have integrated final energies that lie within 1% of each other and their total integration times are all within 25% of each other .",
    "2 .   the qss method and the various asymptotic methods all",
    "give timesteps that potentially are competitive with implicit methods at early times , but they fall far behind at late times .",
    "the reason for the non - competitive nature of the asymptotic and qss timestepping at late times in this calculation can be seen clearly from the solid red curve on the right of fig .",
    "[ fig : compare_dt_asy_qsst9_5rho1e8alpha](b ) , which represents the fraction of reactions in the network that satisfy partial equilibrium conditions .",
    "we see from this and previous results that generally asymptotic and quasi - steady - state approximations work very well as long as the network is well - removed from equilibrium , but as soon as significant numbers of reactions in the network become microscopically equilibrated the asymptotic and qss timestepping begins to fall far behind . in this example",
    ", we see that even a 10% fraction of equilibrated reactions has a significant negative impact on the asymptotic and qss timestepping .    in earlier sections we have presented evidence that , well - removed from equilibrium , quasi - steady - state methods can provide stable and accurate integration of the stiffest large networks with timesteps that are comparable to those employed in standard implicit and semi - implicit solvers . in practice , for astrophysical thermonuclear networks",
    "this means that timesteps are typically from @xmath87 to @xmath88 of the current time over most of the integration range , except for short time periods where very strong fluxes are being produced and timesteps may need to be shorter to maintain accuracy .",
    "since explicit methods can generally compute each timestep substantially faster than for implicit methods in large networks , this suggests that asymptotic or qss solvers offer a viable alternative to implicit solvers under those conditions",
    ".    however , the preceding statements are no longer true when substantial numbers of reaction pairs in the network begin to satisfy equilibrium conditions .",
    "then the generic behavior for both steady - state and asymptotic approximations is that exhibited in fig .",
    "[ fig : compare_dt_asy_qsst9_5rho1e8alpha ] , with the explicit timestep becoming constant or only slowly increasing with integration time .",
    "we shall explain in the third paper of this series @xcite the reason for the loss of efficiency in asymptotic and steady - state methods as equilibrium is approached : these approximations remove major sources of stiffness , but near ( microscopic ) equilibrium a fundamentally new kind of stiffness enters the equations that is not generally removed by either qss or asymptotic approximations .",
    "dealing with the stiffness brought on by the approach to microscopic equilibrium requires that asymptotic or qss methods be augmented by a new algebraic approximation tailored specifically to turn equilibrium from a liability into an asset .    in the third paper of this series",
    "@xcite we shall describe a new implementation of _ partial equilibrium methods _ that can be used in conjunction with asymptotic or qss methods to increase the explicit timestepping by orders of magnitude in the approach to equilibrium . in that paper we will give examples suggesting that this partial equilibrium method is capable of competing strongly with implicit methods across the entire range of interesting physical integration times for a variety of extremely stiff networks .",
    "we give a preview of those results in fig .",
    "[ fig : compare_dt_asy_qsst9_5rho1e8alpha](b ) .",
    "the dashed green line labeled pe corresponds to an explicit partial equilibrium plus asymptotic approximation that is seen to exhibit highly - competitive timestepping relative to that of the implicit calculation , even as the network approaches equilibrium .",
    "in this paper we have compared quasi - steady - state ( qss ) calculations with asymptotic and implicit calculations for extremely stiff networks and concluded that    1 .",
    "qss and asymptotic methods give similar results , but qss timesteps are generally at least as large as for asymptotic methods , and can be larger by as much as an order of magnitude in some cases .",
    "2 .   both qss methods and asymptotic methods are uniformly capable of stable , accurate solutions , even for extremely stiff thermonuclear networks , with timesteps that are substantially larger than those for standard explicit methods .",
    "the only question then is whether such methods can use large enough integration timesteps to be competitive with implicit methods .",
    "3 .   as for asymptotic methods @xcite , qss methods give integration speeds that compete with or even exceed that for implicit methods in extremely stiff networks as long as the system is well removed from ( microscopic ) equilibrium , but fail to deliver competitive timesteps in the approach to equilibrium .",
    "solution of this problem will require explicit partial equilibrium methods that we shall discuss in ref .",
    "@xcite .",
    "thus , we find compelling evidence that quasi - steady - state and asymptotic methods may have significant application in the integration of large networks for even the stiffest systems if they are not close to microscopic equilibrium .    although these conclusions indicate that asymptotic and qss methods must be supplemented by partial equilibrium methods to make explicit integration viable across a full range of stiff problems , the results of this paper and those of ref .",
    "@xcite suggest that the practical utility of the asymptotic and qss methods alone for application in astrophysics and many other fields may be substantial .",
    "as we have seen , there are important , extremely stiff problems for which the system never becomes significantly equilibrated .",
    "this is most likely to occur in explosive scenarios , where we expect rapid expansion on a hydrodynamical timescale .",
    "the expansion will typically lead to reaction freezeout for those reactions that are strongly temperature - dependent , and in rapidly - changing environments this may occur before the system has had time to establish significant microscopic equilibration .",
    "the nova calculation of  [ novaexplosions ] and the tidal supernova calculation of  [ tidalsupernova ] are examples of realistic situations where this occurs .",
    "for such problems we have presented evidence that quasi - steady - state or asymptotic approximations alone ( even without partial equilibrium methods ) may provide integration speeds that rival or even substantially exceed those for the best current implicit methods , particularly for larger networks .    even for problems involving large networks coupled to hydrodynamics where the preceding is not true globally",
    ", it will usually be that for many hydrodynamical zones over various time ranges the conditions will not favor equilibration .",
    "thus , at each hydrodynamical timestep it may prove most efficient to integrate the reaction networks for all zones not exhibiting significant reaction - network equilibration using explicit qss or asymptotic methods . for those zones exhibiting significant equilibration at a given hydrodynamical timestep ,",
    "more work will be required to determine whether standard implicit methods such as backward euler , or explicit asymptotic or qss augmented by partial equilibrium methods are most efficient .",
    "if the latter turns out to be true , it likely will be most useful to integrate all zones with an asymptotic or qss plus partial equilibrium method , but it could turn out that the most efficient approach is a hybrid reaction network algorithm capable of switching among asymptotic plus partial equilibrium , qss plus partial equilibrium , and implicit methods as conditions dictate .",
    "previous examinations of numerical integration for stiff reaction networks have concluded rather consistently that explicit methods have little chance of competing with implicit methods for stiff networks because explicit methods are unable to take large enough stable timesteps . _ numerical recipes _",
    "@xcite goes so far as to state unequivocally that `` for stiff problems we _ must _ use an implicit method if we want to avoid having tiny stepsizes . ''",
    "these sentiments to the contrary , asymptotic and steady state approximations have had some success in extending explicit timesteps to usable sizes for moderately stiff networks , such as those employed for various chemical kinetics problems @xcite .",
    "however , such methods were found previously to be inadequate when applied to the extremely stiff networks encountered commonly in astrophysical applications , giving very incorrect results , with timestepping not competitive with implicit and semi - implicit methods , for thermonuclear networks operating under the extreme conditions of a type ia supernova explosion ( see ref .",
    "@xcite and the discussion in ref .",
    "@xcite , in particular ) .",
    "this paper , the preceding one on asymptotic methods @xcite , and the following one on partial equilibrium methods @xcite , reach rather different conclusions , presenting evidence that algebraically - stabilized explicit methods work and may be capable of timesteps competitive with those for implicit methods in a variety of highly - stiff reaction networks . since explicit methods scale linearly and therefore more favorably than implicit algorithms with network size , our results suggest that algebraically - stabilized explicit algorithms may be far more competitive than previously thought in a variety of applications . of particular significance is that these new approaches may permit for the first time the coupling of physically - realistic kinetic equations to multidimensional fluid dynamics in a variety of disciplines .",
    "we thank raph hix , tony mezzacappa , elisha feger , and jay billings for illuminating discussions , and jay billings for a careful reading of the manuscript .",
    "research was sponsored by the office of nuclear physics , u.s .",
    "department of energy .",
    "guidry m w , budiardja r , feger e , billings j j , hix w r , messer o e b , roche k j , mcmahon e and he m 2011 explicit integration of extremely - stiff reaction networks : asymptotic methods ( arxiv:1112.4716 )"
  ],
  "abstract_text": [
    "<S> a preceding paper @xcite demonstrated that explicit asymptotic methods generally work much better for extremely stiff reaction networks than has previously been shown in the literature . </S>",
    "<S> there we showed that for systems well removed from equilibrium explicit asymptotic methods can rival standard implicit codes in speed and accuracy for solving extremely stiff differential equations . in this paper </S>",
    "<S> we continue the investigation of systems well removed from equilibrium by examining quasi - steady - state ( qss ) methods as an alternative to asymptotic methods . </S>",
    "<S> we show that for systems well removed from equilibrium , qss methods also can compete with , or even exceed , standard implicit methods in speed , even for extremely stiff networks , and in many cases give somewhat better integration speed than for asymptotic methods . as for asymptotic methods </S>",
    "<S> , we will find that qss methods give correct results , but with non - competitive integration speed as equilibrium is approached . </S>",
    "<S> thus , we shall find that both asymptotic and qss methods must be supplemented with partial equilibrium methods as equilibrium is approached to remain competitive with implicit methods .    _ keywords </S>",
    "<S> _ : ordinary differential equations , reaction networks , stiffness , reactive flows , nucleosynthesis , combustion </S>"
  ]
}