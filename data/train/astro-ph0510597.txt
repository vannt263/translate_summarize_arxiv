{
  "article_text": [
    "the field of extrasolar planet research has recently made a leap forward with the direct detection of extrasolar giant planets ( egps ) . using spitzer space telescope ,",
    "@xcite and @xcite have detected infrared photons from two transiting planets , tres-1b and hd209458b , respectively .",
    "@xcite have reported the infrared imaging of an egp orbiting the nearby young brown dwarf 2m1207 with vlt / naco , whereas @xcite have collected evidence for an egp companion to the t - tauri star gq lup using vlt / naco as well .",
    "although there are claims that the direct detection of terrestrial planets could be performed from the ground with  yet to come  extremely large telescopes @xcite , it is widely believed that success will be more likely in space .",
    "direct detection is the key to spectroscopy of planetary atmospheres and discovery of biomarkers , namely indirect evidence of life developed at the planetary scale ( e.g. * ? ? ?",
    "both nasa and esa have space mission studies well underway to achieve this task .",
    "darwin , the european mission to be launched in 2015 , will be a thermal infrared nulling interferometer with three 3.5-m free - flying telescopes @xcite .",
    "terrestrial planet finder , the american counterpart , will feature two missions : a @xmath2  m - monolithic visible telescope equipped with a coronagraph ( tpf - c ) to be launched in 2015 , and an analog to darwin ( tpf - i ) to be launched in the 20152019 range @xcite .    the direct detection of the photons emitted by a terrestrial planet is made very challenging by the angular proximity of the parent star , and by the very high contrast ( i.e. luminosity ratio ) between the planet and its star : about @xmath3 in the thermal infrared and about @xmath4 in the visible .",
    "both wavelength ranges have their scientific merits and technical difficulties , and both of them are thought to be necessary for an unambiguous detection of habitability and signs of life ( e.g. * ? ? ?",
    "* ) . in this paper",
    ", we deal with the visible range only .    in the visible",
    ", planet detection faces two fundamental noise sources : ( i ) quantum noise of the diffracted star light , and ( ii ) speckle noise due to the scattering of the star light by optical defects .",
    "@xcite proposed a technique based on _ dark speckles _ to overcome speckle noise : random fluctuations of the atmosphere cause the speckles to interfere destructively and disappear at certain locations in the image , thus creating localized dark spots suitable for planet detection .",
    "the statistical analysis of a large number of images then reveals the planet as a spot persistently brighter than the background .",
    "@xcite proposed to use a deformable mirror ( dm ) instead of the atmosphere to make speckles interfere destructively in a targeted region of the image called _ search area _ or _ dark hole _ ( dh or @xmath5 ) .",
    "following the tracks of these authors , this paper discusses methods to reduce the speckle noise below the planet level by using a dm and an ideal coronagraph .",
    "however , unlike @xcite , we propose non - iterative algorithms , in order to limit the number of long exposures needed for terrestrial planet detection .",
    "we will refer to these methods as _ speckle nulling _ techniques , as @xcite call them .",
    "technical aspects of this work are inspired by the high contrast imaging testbed ( hcit ; * ? ? ?",
    "* ) , a speckle - nulling experiment hosted at the jet propulsion laboratory , specifically designed to test tpf - c related technology .",
    "after reviewing the process of speckle formation to establish our notations (  [ sec : speckle_formation ] ) , we derive two speckle nulling methods in the case of small aberrations (  [ sec : speckle_nulling ] ) .",
    "the speckle nulling phase is preceded by the measurement of the electric field in the image plane (  [ sub : measurement ] ) . the performance of both methods",
    "are then evaluated with one- and two - dimensional simulations (  [ sec : simulations ] ) , first with white speckle noise (  [ sub : sim_white ] ) , then with non - white speckle noise (  [ sub : sim_real ] ) .",
    "various effects and instrumental noises are considered in  [ sec : discussion ] .",
    "finally , we conclude and discuss some future work (  [ sec : conclusion ] ) .",
    "this paper is written in the framework of fourier optics considering a single wavelength , knowing that a more sophisticated theory ( scalar or vectorial ) in polychromatic light will eventually be needed .",
    "fourier transforms ( fts ) are signaled by a hat .",
    "let us consider a simple telescope with an entrance pupil @xmath6 .",
    "in the pupil plane , we use the reduced coordinates @xmath7 , where @xmath8 are distances in meters and @xmath9 is the wavelength .",
    "we define the pupil function by @xmath10    even in space , i.e. when not observing through a turbulent medium like the atmosphere , the optical train of the telescope is affected by phase and amplitude aberrations .",
    "phase aberrations are wavefront corrugations that typically originate in mirror roughness caused by imperfect polishing , while amplitude aberrations are typically the result of a heterogeneous transmission or reflectivity",
    ". moreover , fresnel propagation turns phase aberrations into amplitude aberrations , and the reverse ( e.g. * ? ? ?",
    "regardless of where they originate physically , all phase and amplitude aberrations can be represented by a complex aberration function @xmath11 in a re - imaged pupil plane , so that the aberrated pupil function is now @xmath12 .",
    "the electric field associated with an incident plane wave of amplitude unity is then @xmath13    exoplanet detection requires that we work in a regime where aberrations are reduced to a small fraction of the wavelength . once in this regime , we can replace @xmath14 by its first order expansion @xmath15 ( we will discuss in  [ sub : discuss_linearity ] the validity of this approximation ) . the electric field in the image plane being the ft of ( [ eq : e_pu ] ) , we get @xmath16 where @xmath17 are angular coordinates in the image plane .",
    "the physical picture is as follows .",
    "the first term ( @xmath18 ) is the direct image of the star .",
    "the second term ( @xmath19 ) is the field of speckles surrounding the central star image , where each speckle is generated by the equivalent of first - order scattering from one of the sinusoidal components of the complex aberration @xmath11 .",
    "each speckle is essentially a ghost of the central psf .    in the remainder of this paper , we focus on means to measure and correct the speckles in a coronagraphic image . following @xcite we will leave out the unaberrated psf term by assuming that it is was canceled out by a coronagraph of some sort ( see @xcite for a review on coronagraphs ) .",
    "thus we clearly separate the gain in contrast that can be obtained by reducing the diffracted light with the coronagraph on one hand , and by fighting the scattered light with the speckle nulling technique on the other hand .",
    "the purpose of speckle nulling is to reduce the speckle noise in a central region of the image plane .",
    "this region , the dark hole , then becomes dark enough to enable the detection of companions much fainter than the original speckles .",
    "speckle nulling is achieved by way of a servo system that has a deformable mirror as actuator .",
    "because our sensing method requires dm actuation and is better understood with the knowledge of the command control theory , we first model the deformable mirror (  [ sub : deformable_mirror ] ) , then present two algorithms for the command control (  [ sub : field_nulling ] & [ sub : energy_min ] ) , and conclude with the sensing method (  [ sub : measurement ] ) .",
    "the deformable mirror ( dm ) in @xcite consists of a continuous facesheet supported by @xmath0 actuators arranged in a square pattern of constant spacing .",
    "this dm format is well adapted to either square or circular pupils , the only pupil shapes that we consider in this paper .",
    "we assume that the dm is physically located in a plane that is conjugate to the entrance pupil .",
    "however , what we call dm in the following is the projection of this real dm in the entrance pupil plane .",
    "the projected spacing between actuators is denoted by @xmath20 .",
    "we assume that the optical magnification is such that the dm projected size is matched to the entrance pupil , i.e. @xmath21 , where @xmath22 is either the pupil side length or its diameter .",
    "the dm surface deformation in response to the actuation of actuator @xmath23 is described by an _ influence function _ , denoted by @xmath24 . the total phase change introduced by the dm ( dm phase function ) is @xmath25 where @xmath26 are actuator strokes ( measured in radians ) .",
    "note that contrary to the complex aberration function @xmath11 , the dm phase function is purely real .    with an ideal coronagraph and a dm ,",
    "the image - plane electric field formerly given by ( [ eq : e_im ] ) becomes @xmath27 in the next two sections , we explore two approaches for speckle nulling . in ",
    "[ sub : field_nulling ] , we begin naively by trying to cancel @xmath28 . because there is a maximum spatial frequency that the dm can correct for , the dh has necessarily a limited extension .",
    "any energy at higher spatial frequencies will be aliased in the dh and limit its depth . therefore",
    ", the dm can not be driven to cancel @xmath28 , unless @xmath19 is equal to zero outside the dh ( i.e. unless there are already no speckles outside the dh ) .",
    "with this in mind , we start over in  [ sub : energy_min ] with the idea that speckle nulling is better approached by minimizing the field energy .",
    "the speckle field nulling approach consists in trying to null out @xmath28 in the dh region ( @xmath5 ) , meaning we seek a solution to the equation @xmath29 although , as we shall show , this equation has no exact solution unless @xmath19 happens to be a band - limited function within the controllable band of the dm .    by replacing @xmath30 with its expression ( [ eq : psi ] ) , we obtain @xmath31 we recognize in ( [ eq : field2 ] ) a linear system in the @xmath26 that could be solved using various techniques such as singular value decomposition ( svd ; * ? ? ? * ) .",
    "although general , this solution does not provide much insight in the problem of speckle nulling .",
    "for this reason , let us examine now a different solution , less general but with more explanatory power .",
    "we will comment on the use of svd at the end of this section .",
    "we consider a square pupil . in this case , all dm actuators receive light and the pupil function has no limiting effect on the dm phase function , i.e. @xmath32 . moreover , we assume all influence functions to be identical in shape , and write @xmath33 . under these hypotheses , @xmath34 where @xmath35 is dirac s bidimensional distribution , and @xmath36 denotes the convolution .    substituting @xmath37 by the ft of ( [ eq : psi2 ] ) in ( [ eq : field1 ] ) yields @xmath38 we recognize in the left - hand side of ( [ eq : field3 ] ) a truncated fourier series .",
    "if we choose the @xmath26 to be the first @xmath39 fourier coefficients of @xmath40 , i.e. @xmath41}^2 } -\\frac{\\widehat{p\\phi}(\\alpha,\\beta)}{\\hat{f}(\\alpha,\\beta ) } \\ : e^{i \\frac{2\\pi d}{\\lambda } ( k \\alpha + l \\beta ) } \\ , \\mathrm{d}\\alpha \\ , \\mathrm{d}\\beta,\\ ] ] then according to fourier theory , we minimize the mean - square error between both sides of the equation ( see e.g. * ? ? ?",
    "this error can not be reduced to zero unless the fourier coefficients of @xmath40 happen to vanish for @xmath42 and @xmath43 . at this point",
    ", we have reached the important conclusion that _ perfect speckle cancellation can not be achieved with a finite - size dm unless the wavefront aberrations are band - limited_. moreover , we can assert that the maximum dh extension is the square domain @xmath44}^2 = { [ -\\frac{n}{2}\\frac{\\lambda}{d } , \\frac{n}{2}\\frac{\\lambda}{d}]}^2 $ ] .",
    "solution ( [ eq : coef1 ] ) is physically acceptable only if the fourier coefficients are real numbers , which means mathematically that @xmath45 should be hermitian is said to be hermitian if @xmath46 .",
    "the ft of a real function is hermitian and vice versa . ] .",
    "if there are phase aberrations only , @xmath47 is real , @xmath45 is hermitian , and the @xmath26 are real .",
    "this is no longer true if there are amplitude aberrations as well , reflecting the fact that the dm alone can not correct both phase and amplitude aberrations in @xmath5 .",
    "however , by considering the hermitian function that is equal to @xmath45 in one half of the dh , say @xmath48 \\times [ -\\frac{\\lambda}{2d},\\frac{\\lambda}{2d}]$ ] , we obtain the real coefficients @xmath49 \\mathrm{d}\\alpha \\ , \\mathrm{d}\\beta,\\ ] ] that correct both amplitude and phase aberrations in @xmath50 . as we have @xmath51",
    ", the dh has a size of @xmath0 resolution elements ( resels ) with phase aberrations only , and of @xmath52 resels with phase and amplitude aberrations .",
    "therefore , _ a dm can correct both amplitude and phase aberrations in the image plane , albeit in a region that is either the left , right , upper , or lower half of the phase - corrected region . _",
    "as @xcite pointed out , let us remind the reader that @xmath53 is equal to the nyquist frequency for a sampling interval @xmath54 .",
    "therefore , we find that maximum extension for the dh corresponds to the range where the sampling theorem applies to the wavefront at the dm actuator scale . indeed , taking the inverse ft of ( [ eq : field3 ] ) leads to the wavefront reconstruction formula @xmath55 again , this reconstruction can not be perfect unless the spectrum of @xmath47 is contained in @xmath5 .",
    "note that because @xmath56 is generally not a flat function ( as it would be the case if influence functions were for instance 2d sinc functions ) , actuator strokes are not equal to the negative of wavefront values sampled at the actuator locations .",
    "our fourier solution was derived by assuming that ( a ) all influence functions are identical in shape , and ( b ) that the pupil has a square shape .",
    "hypothesis ( a ) appears to be reasonable at least for the dm in use on the hcit ( joseph green , personal communication ) , but this remains to be precisely measured .",
    "if hypothesis ( b ) is relaxed then ( i ) some actuators do not receive any light and play no role , so there are effectively fewer terms in the summation in ( [ eq : field3 ] ) , and ( ii ) the fact that influence functions on the pupil boundary are only partly illuminated is ignored .",
    "now that we have two methods to solve ( [ eq : field1 ] ) , fourier expansion and svd , let us compare their solutions .",
    "we deal here with functions belonging to the hilbert space of square integrable functions @xmath57 .",
    "this space has @xmath58 for dot product , and @xmath59 for norm .",
    "as mentioned earlier , fourier expansion minimizes the mean - square error between both sides of ( [ eq : field3 ] ) , i.e. @xmath60 . by contrast , svd has the built - in property of minimizing the norm of the residuals of ( [ eq : field2 ] ) , i.e. @xmath61 . in other words ,",
    "svd minimizes @xmath62 , the speckle field energy , which seems more satisfactory from a physical point of view . to find out what is best , we have performed one - dimensional numerical simulations .",
    "it turns out that svd yields dark holes 50% deeper ( median value ) than fourier expansion .",
    "in addition , svd does not require all influence functions to have the same shape .",
    "however , considering four detector pixels per resel in two dimensions ( critical sampling ) , svd would require us to manipulate matrices as large as @xmath63 ( or even @xmath64 when real and imaginary parts are separated ) .",
    "such matrices would occupy 537  mb of memory space for @xmath65 actuators and single - precision floating - point numbers .",
    "by contrast , fourier expansion would be straightforwardly obtained with ffts of @xmath66 arrays at critical sampling , but again at the cost of a 50% shallower dark hole and a strong hypothesis on the influence functions .    in the next section",
    ", we seek to find a computationally less intensive solution that still minimizes the speckle energy in the dark hole , but does not require any hypothesis on the influence functions .",
    "let us start with the idea that the best solution is defined as the one _ minimizing the total energy of the speckle field in the dh_. for the sake of simplicity , we assume once again a square pupil , but not necessarily a common shape for the influence functions .",
    "the total energy in the speckle field reads @xmath67 using the same notation as in  [ sub : field_nulling ] .    given that @xmath68 , the energy is minimized when @xmath69 where @xmath70 stands for the real part .",
    "note that this is less demanding than ( [ eq : field1 ] ) , as ( [ eq : field1 ] ) implies ( [ eq : energy2 ] ) but the reverse is not true .    using the definition ( [ eq : psi ] ) for @xmath30 and realizing that @xmath71 is a real number together with the symmetry of @xmath5 . ] , we get finally @xmath72 as in ( [ eq : field2 ] ) , we find a system that is linear in the actuator strokes . by replacing double indices with single ones ,",
    "e.g. @xmath73 becomes @xmath74 , ( [ eq : energy3 ] ) can be solved in matrix format by inverting a @xmath1 real matrix .",
    "this is already an improvement with respect to the @xmath63 complex matrix required by svd in the previous section .",
    "it appears that the same solution can be obtained with a much less demanding @xmath75 matrix inversion , provided two - dimensional influence functions can be written as the tensor product of two one - dimensional functions ( separation of variables ) , i.e. @xmath76 .",
    "this would be the case for box functions or bidimensional gaussians , and is good at the 5% level for the dm in use on the hcit .",
    "this property also holds in the image plane since the ft of the previous equation yields @xmath77 .    by separating variables , ( [ eq : energy3 ] ) becomes @xmath78 as the left - hand side happens to be the product of three @xmath0 matrices , ( [ eq : energy4 ] ) can be rewritten as an equality between square matrices .",
    "@xmath79 for square - box and actual hcit influence functions , numerical calculations show that @xmath80 is diagonally dominant$ ] is said to be diagonally dominant if @xmath81 .",
    "] and therefore invertible by regular gaussian elimination .",
    "the solution to ( [ eq : energy5 ] ) is then @xmath82 note that @xmath83 can be precomputed and stored , so that computing the strokes effectively requires only two matrix multiplications .",
    "as shown in appendix  [ app : global ] , an equivalent result can be obtained by working with pupil plane quantities .    as for the field nulling approach , correcting amplitude errors as well implies restricting the dark hole to either @xmath84 \\times [ -\\frac{n}{2}\\frac{\\lambda}{d},\\frac{n}{2}\\frac{\\lambda}{d}]$ ] or @xmath85 \\times [ -\\frac{n}{2}\\frac{\\lambda}{d},\\frac{n}{2}\\frac{\\lambda}{d}]$ ] .",
    "to account for amplitude errors and keep the formalism we have presented so far , it is sufficient to replace @xmath19 by a function equal to @xmath86 in either @xmath50 or @xmath87 ( depending on the half where one wishes to create the dark hole ) , and equal to @xmath88 in the other half ( hermitian symmetry ) . because its ft is hermitian",
    ", the new aberration function in the pupil plane is real , and thus the algorithm processes amplitude and phase errors at the same time as if there were phase errors only .    let us derive the residual total energy in the dh after the correction has been applied .",
    "starting from definition ( [ eq : energy1 ] ) and rewriting condition ( [ eq : energy2 ] ) as @xmath89 , we find @xmath90 the former term is the initial speckle energy in the dh , while the latter is the speckle energy decrease gained with the dm .",
    "mathematically , @xmath91 measures the distance ( according to the norm we have defined ) between the speckle field and its approximation with the dm inside the dh . because there is no exact solution to ( @xmath92 ) , the residual energy can not be made equal to zero in @xmath50 or @xmath87 .",
    "however , the energy approach offers an additional degree of freedom : by reducing concentrically the domain over which the energy is minimized , the speckle energy can be further decreased ( see  [ sec : simulations ] ) .",
    "so far , our speckle nulling theory has presupposed the knowledge of the speckle field @xmath19 , or equivalently of the phase and amplitude aberrations across the pupil , embodied in the complex phase function @xmath47 . in this section ,",
    "we show how the speckle field can be measured directly in the image plane .",
    "as the detector measures an intensity , a single image yields only the modulus of the speckle field .",
    "the phase of the speckle field can be retrieved by perturbing the phase function @xmath47 in a controlled way , and by recording the corresponding images , a process analogous to _ phase diversity _ ( e.g. * ? ? ?",
    "* ) . in our system",
    ", the dm provides the natural means for creating this controlled perturbation .",
    "as we will see , exactly three images obtained with well chosen dm settings provide enough information to measure @xmath19 .",
    "let us call image 0 the original image recorded with a setting @xmath93 , whereas images 1 and 2 are recorded with settings @xmath94 and @xmath95 .",
    "to be general , we consider in the field of view the presence of an exoplanet and an exozodiacal cloud ( exozodi for short ) , in addition to the star itself .",
    "the electric fields of these objects are incoherent with that of the star , so their intensities should be added to the star s intensity .",
    "because they are much fainter than the star , the speckles they produce are negligible with respect to the star speckles , and their intensities can be considered as independent of @xmath11 and @xmath30 .",
    "the total intensity of every image pixel @xmath17 takes then the successive values @xmath96 where @xmath97 and @xmath98 are the exoplanet and exozodi intensities , respectively .",
    "system  ( [ eq : i_system1 ] ) can be reduced to the linear system @xmath99 where the exponent @xmath36 denotes the complex conjugate .",
    "notice how the exoplanet and exozodi intensities have disappeared from the equations , demonstrating that faint objects do not affect the measurement process of stellar speckles .",
    "however , note that because of quantum noise , the planet detection can still be problematic if the exozodi is much brighter than the planet .",
    "now , system ( [ eq : i_system2 ] ) admits a unique solution if its determinant , @xmath100 is not zero , that is to say if @xmath101 ) tells us that the dm setting changes , @xmath102 and @xmath103 , should modify the speckles differently in any given pixel , otherwise not enough information is secured to measure unambiguously @xmath19 in this pixel .",
    "it should be expected for this method to work practically that the magnitude of the speckle modification be greater than the photon noise level .",
    "we have not yet found a rigorous derivation of the optimum values for the amplitude @xmath104 and @xmath105 , but a heuristic argument suggests to us that the optimum perturbations may be that @xmath106 and @xmath107 .",
    "that is to say , the dm - induced speckle instensity pattern , taken by itself , should be approximately the same as the original speckle intensity pattern .",
    "thus at each pixel we choose @xmath108 , with the caveat that neither should be zero to keep ( [ eq : i_condition ] ) valid .",
    "the phase of @xmath109 does not matter , but the phase difference between @xmath109 and @xmath110 should be made as close to @xmath111 as possible to keep @xmath112 from zero .",
    "practically , this can be realized as follows :    1 .",
    "compute @xmath102 stroke changes from ( [ eq : coef2 ] ) or ( [ eq : energy6 ] ) by replacing @xmath19 by @xmath113 , where @xmath114 is a random phase ; 2 .",
    "compute @xmath103 stroke changes from ( [ eq : coef2 ] ) or ( [ eq : energy6 ] ) by replacing @xmath19 by @xmath115 .",
    "now that we have made sure that @xmath116 , we derive finally @xmath117 equation ( [ eq : i_solution ] ) shows that the initially unknown speckle field ( @xmath19 ) can be experimentally measured in just three exposures taken under identical circumstances but with different shapes imposed on the dm .",
    "in this section , we perform one- and two - dimensional simulations for the theoretical case of white speckle noise caused by phase aberrations only .",
    "the dm has 64 actuators and top - hat influence functions .",
    "smoother influence functions have been tested and do not lead to qualitatively different results .",
    "a simulation with actual hcit influence functions will be presented in the next section .",
    "the simulated portion of the pupil plane is made twice as big as the pupil by zero padding , so that every element of resolution in the image plane would be sampled by two detector pixels .",
    "this corresponds to the realistic case of a photon - starved exoplanet detection where read - out noise must be minimized .",
    "figure  [ fig : f1 ] shows a complete one - dimensional simulation including speckle field measurement (  [ sub : measurement ] ) and speckle nulling with field nulling (  [ sub : field_nulling ] ) and energy minimization (  [ sub : energy_min ] ) .",
    "the standard deviation of the phase aberrations is set to @xmath118 .",
    "intensities are scaled with respect to the maximum of the star psf in the absence of a coronagraph .",
    "ideal conditions are assumed : no photon noise , noiseless detector , and perfect precision in the control of dm actuators . under these conditions , the speckle field",
    "is perfectly estimated , and the mean intensity in the dh is @xmath119 with field nulling and @xmath120 with energy minimization , i.e. about 1500 and 6500 times lower than the mean intensity outside the dh , respectively .",
    "repeated simulations with different noise sequences show that energy minimization performs always better than field nulling by a factor of a few .",
    "field nulling solved with svd yields the same numerical solution as energy minimization ( they differ by the last digit only ) , in agreement with the idea that they both minimize speckle energy .      in the one - dimensional case , it is easy to predict roughly the shape and the depth of the dh .",
    "the function @xmath121 is band - limited since the pupil has a finite size . as the pupil linear dimension is @xmath122 , the maximum spatial frequency of @xmath121 is @xmath123 .",
    "let us apply the sampling theorem at the nyquist sampling frequency @xmath122 , and write @xmath124 \\mbox{sinc } \\ !",
    "\\left ( \\frac{\\alpha d}{\\lambda } - n \\right),\\ ] ] where the subscript @xmath125 denotes the function value for @xmath126 .    substituting @xmath127 by @xmath128 and @xmath20 by @xmath129 leads to @xmath130 the field nulling equation ( [ eq : field1 ] ) takes here the discrete form @xmath131 i.e. actuator strokes are computed thanks to an inverse fft .",
    "let us now turn to the residual speckle field @xmath132 because the sinc function decreases rapidly with @xmath127 , the terms flanking the dh ( @xmath133 and @xmath134 ) should by themselves give the order of magnitude of the residual speckle field in the dh . in case of phase aberrations only and",
    "white noise , we have @xmath135 , where @xmath136 is the mean intensity in the image plane prior to the dh creation .",
    "therefore , a crude estimate of the intensity profile in the dh should be @xmath137}^2.\\ ] ] we have superimposed this approximation as a thick line in fig .  [",
    "fig : f1 ] . in this case",
    "the match is remarkable , but more simulations show that it is generally good within a factor of 10 only .",
    "nevertheless , it demonstrates that the dh depth depends critically on the residual speckle field at its edges , hence on the decreasing rate of the complex aberration spectrum with spatial frequency . in that respect ,",
    "a white spectrum is certainly the worst case .",
    "equation ( [ eq:1d5 ] ) further indicates that the dh depth depends on the number of actuators : as @xmath138 is increased , the dh widens and gets deeper . with 8 , 16 , 32 , and 64 actuators , ( [ eq:1d5 ] ) predicts @xmath139 to reach about 100 , 300 , 1000 , and 4500 .      as mentioned in ",
    "[ sub : energy_min ] , speckle nulling by energy minimization can be performed in a region narrower than the maximum dh .",
    "figure  [ fig : f2 ] illustrates this point : by reducing the search area from 64 to 44 resels ( 31% reduction ) , the dh floor was decreased from @xmath120 to @xmath140 , i.e. a gain of about 5200 in contrast ( further reducing the search area does not bring any significant gain ) . by giving up search space ,",
    "one frees the degrees of freedom corresponding to the highest spatial frequency components on the dm pattern .",
    "these can be used to improve the dh depth at lower spatial frequency because of the psf angular extension ( this is essentially the same reason why high spatial frequency speckles limit the dh depth ) .",
    "as the search space is reduced , the leverage of these highest spatial frequency components decreases ( psf wings falling off ) .",
    "the energy minimization algorithm compensates by putting more energy at high frequency ( see lower panel in fig .  [",
    "fig : f2 ] ) , which produces increasingly oscillatory dm patterns ( see top panel in fig .  [",
    "fig : f2 ] ) and increasingly brighter spots in the image ( around @xmath141 and @xmath142 in bottom panel of fig .",
    "[ fig : f2 ] ) .",
    "thus the trade - off range might be limited in practice by the maximum actuator stroke ( currently @xmath143 m on the hcit ) , and/or by the detector s dynamic range .    in two - dimensions ,",
    "the trade - off limits are well illustrated by the following example : considering a @xmath65 dm and a random wavefront , we find that the dh floor can be decreased from @xmath144 to @xmath145 ( a factor of 17 ) if the search area is reduced from @xmath65 to @xmath146 resels ( 12% reduction in area ) .",
    "this implies a maximum actuator stroke of 10 nm and a detector dynamic range of @xmath3 . a further reduction to @xmath147 resels",
    "does not feature a lower dh floor ( @xmath148 ) , and would imply a maximum actuator stroke of @xmath149 m and a detector dynamic range of @xmath150 . in this case , the leverage of the additionally freed high - spatial frequency components is so weak that the algorithm starts diverging .      in figs .",
    "[ fig : f3][fig : f4 ] , we show an example of two - dimensional speckle nulling with phase and amplitude aberrations for a square pupil .",
    "to reflect the fact that phase aberrations dominate amplitude aberrations in real experiments ( see * ? ? ?",
    "* ) , the rms amplitude of amplitude aberrations is made ten times smaller than that of phase aberrations ( the choice of a factor ten is arbitrary ) .",
    "the dh is split into two regions : in the right one ( @xmath50 ) , amplitude and phase aberrations are corrected , whereas in the left one ( @xmath87 ) , phase aberrations are corrected and amplitude aberrations are made worse by a factor of four in intensity .        with the @xmath151-m tpf - c primary mirror in mind , we have studied the phase aberration map of an actual 8-m mirror : the primary mirror of antu , the first 8.2-m unit telescope of eso s very large telescope ( vlt ) .",
    "this phase map was obtained with the active optics system on , and is characteristic of zonal errors ( aberrations which can not be fitted by low - order zernike - type polynomials ) .",
    "it can be seen in fig .",
    "[ fig : f5 ] that the azimuthally averaged power spectral density ( psd ) of such a map is well represented by @xmath152 where @xmath153 .",
    "values for psd@xmath154 , @xmath155 and @xmath156 are listed in table  [ tab : t1 ] . for comparison ,",
    "the same treatment has been applied to the hubble space telescope ( hst ) zonal error map from @xcite .",
    "we conclude from this study that _ a realistic phase aberration psd for an 8-m mirror decreases as the third power of the spatial frequency_. the standard deviation of the vlt phase map is 20.9  nm ( 18.5  nm for hst )",
    ". the square root of the power of phase aberrations in the 0.54  m@xmath157 spatial frequency range ( 432  @xmath158 for an 8-m mirror ) is 19.4  nm , i.e. about @xmath159 at 500  nm , clearly not in the validity domain of our linear approximation .",
    "figure  [ fig : f6 ] shows a simulation performed in the same conditions as fig .  [ fig : f1 ] , but with a vlt - like psd .",
    "the psd is scaled so that the standard deviation of phase aberrations is equal to @xmath118 .",
    "the average dh floor is now @xmath160 , six orders of magnitude below the intensity peak in the original image ! in agreement with  [ sub : sim_white ] , we find that _ the dh s depth depends critically on the magnitude of the speckle field at the edge of the dh , hence on the decrease of the phase aberration psd with spatial frequency_.      for the two - dimensional simulation in figs .",
    "[ fig : f7][fig : f8 ] , we have kept the original vlt phase map and circular pupil , but scaled the standard deviation of phase aberrations to @xmath118 .",
    "in addition , we have used the actual hcit influence functions from @xcite .",
    "the average dh floor is then @xmath161 with field nulling ( case shown ) , and @xmath162 with energy minimization .",
    "the worse performance of the second method reflects the cost of the variable separation hypothesis , only accurate to within 5% for the hcit .",
    "note that the dh retains its square shape with a circular pupil , as the dh shape is fixed by the actuator grid geometry on the dm ( a square grid of constant spacing in our case ) .",
    "in  [ sec : simulations ] , we presented noise - free simulations .",
    "to give an idea of the effect of quantum and read - out noises , let us consider a sun - like star at 10  pc observed by a @xmath151  m space telescope with a 5% overall efficiency . in a 100  nm bandwith centered at 600  nm , the telescope collects about @xmath163 photo - electrons in one - hour exposures . considering the quantum noise , a 1  e@xmath164 read - noise and ignoring chromatic effects , simulations of sequences of four one - hour exposures",
    "show that the average dh floor in fig .",
    "[ fig : f1 ] would jump from @xmath120 to @xmath165 , whereas the average dh floor in fig .",
    "[ fig : f6 ] would jump from @xmath166 to @xmath167 .      in practice",
    ", our speckle nulling process will work as stated provided eq .",
    "( [ eq : e_im ] ) holds , that is to say if @xmath168 .",
    "if @xmath169 is the improvement in contrast with respect to the speckle floor and @xmath170 the standard deviation of wavefront aberrations in radians , this condition translates into @xmath171 , or @xmath172 . in terms of optical path difference ,",
    "the standard deviation should then be much less than @xmath173 for @xmath174 .",
    "this is why we considered @xmath118 rms wavefronts in our simulations .",
    "as the wavefront will probably not be of this quality at the start , the speckle nulling method presented here is intended to be used in the course of observations , after a first phase where the bulk of the aberrations have been taken out .",
    "when the linear approximation breaks down , three images with different dm settings still provide enough information about the aberrations , so that a dh could be created thanks to a global non - linear analysis of these images @xcite .",
    "@xcite also explored non - linear solutions , but with many more iterations ( @xmath175 ) .",
    "dwelling on the validity of eq .",
    "( [ eq : e_im ] ) , real coronagraphs would not only remove the direct image of the star ( @xmath18 ) , they would also modify the speckle field ( @xmath19 ) and the dm phase function ( @xmath37 ) .",
    "this can be easily incorporated in the theory .",
    "a more delicate point is that real coronagraphs are not translation - invariant systems . as a consequence ,",
    "effective influence functions as seen from behind the coronagraph will vary over the pupil . for image - plane coronagraphs with band - limited sinc masks",
    "@xcite , we estimate this variation to be of the order of 10% , assuming @xmath176 and 64 actuators",
    ". only energy minimization , not field nulling ( unless solved with svd ) , can accomodate this effect .",
    "what about the precision at which actuators should be controlled ? as a consequence of the linearity of ( [ eq : energy3 ] ) , the dh depth depends quadratically on the precision on the actuator strokes .",
    "we deduce  and this is confirmed by simulations  that a four orders of magnitude deep dh can only be obtained if the strokes are controlled at a 1% precision , i.e. 6 pm rms with @xmath118 aberrations at 600 nm .",
    "this precision corresponds to the current resolution of the actuator drivers on the hcit .",
    "regarding instrumental stability , we assumed that the instrument would remain perfectly stable during the four - step process . however , despite the foreseen thermal and mechanical controls of the spacecraft , very slow drifts during the few hours of single exposures should be expected .",
    "therefore we intend to study in a subsequent paper how to incorporate a model of the drifts in our method .",
    "the exact parameters of this model would be derived from a learning phase after the launch of the spacecraft .",
    "we have not considered the effect of chromaticity .",
    "let us point out that phase aberrations due to mirror surface errors scale with wavelength , so the correction derived from one wavelength would apply to all wavelengths .",
    "this is unfortunately not the case for amplitude aberrations .",
    "although these are weaker than phase aberrations , a degradation of the correction should be expected in polychromatic light . moreover , polychromatic wavefront sensing will require a revised theory as speckles will move out radially in proportion to the wavelength .",
    "in this paper , we presented two techniques to optimally null out speckles in the central field of an image behind an ideal coronagraph in space .",
    "the measurement phase necessitates only three images , the fourth image being fully corrected .",
    "depending on the number of actuators and the desired search area , the gain in contrast can reach several orders of magnitude .",
    "these techniques are intended to work in a low aberration regime , such as in the course of observations after an initial correction phase .",
    "they are primarily meant to be used in space but could be implemented in a second - stage ao system on ground - based telescopes . out of these two methods , the speckle energy minimization approach seems to be the more powerful and flexible : ( i ) it offers the possibility to trade off some search area against an improved contrast , and ( ii ) it can accomodate influence function variations over the pupil ( necessary with real coronagraphs )",
    ". if influence functions feature the required symmetry ( variable separation ) , it is computationally very effective , but is otherwise still better than svd .    since the principles underlying these speckle nulling techniques are general , it should be possible to use them in conjunction with most coronagraph designs , including those with band - limited masks @xcite , pupil - mapping @xcite , and shaped pupils @xcite .",
    "it is our intent to complete our work by integrating in our simulations models of these coronagraphs , and to carry out experiments with the hcit .",
    "in addition , we will seek to incorporate in the measurement theory a linear model for the evolution of aberrations , and we will work toward a theory accommodating the spectral bandwidth needed for the detection and spectroscopy of terrestrial planets .",
    "we wish to thank the anonymous referee for his insightful comments that helped to improve greatly the content of this paper .",
    "we acknowledge many helpful discussions with chris burrows , john trauger , joe green , and stuart shaklan .",
    "this work was performed in part under contract 1256791 with the jet propulsion laboratory ( jpl ) , funded by nasa through the michelson fellowship program , and in part under contract 1260535 from jpl .",
    "jpl is managed for nasa by the california institute of technology .",
    "this research has made use of nasa s astrophysics data system .",
    "in this appendix , we show that energy minimization can be formulated in the pupil plane as well . note that no measurement takes place in the pupil plane : the aberration function @xmath47 is obtained by the inverse ft of @xmath19 which is still measured as described in  [ sub : measurement ] .",
    "although we present here a solution for phase aberrations , amplitude aberrations can be corrected in half of the domain without changing the formalism , exactly as explained in ",
    "[ sub : energy_min ] .    by replacing @xmath177 with its expression as a ft ,",
    "the dark hole energy reads @xmath178 now we invert the integration order and integrate over @xmath5 to get @xmath179 where @xmath180 $ ] .",
    "the energy is minimized when @xmath181 \\ , h(u'-u)\\ , h(v'-v ) \\ , \\mathrm{d}u \\ , \\mathrm{d}v \\ , \\mathrm{d}u ' \\mathrm{d}v ' = 0.\\ ] ] in the next steps , we first replace @xmath30 with ( [ eq : psi ] ) , then @xmath182 with its tensor product @xmath183 in order to integrate separately the variables @xmath184 and @xmath185 .",
    "the final result reads @xmath186 system ( [ eq : app4 ] ) has a form identical to ( [ eq : energy5 ] ) and can be solved with the same technique .",
    "bord , p. , traub , w. , & trauger , j. 2004 , proceedings of the second tpf / darwin conference , meeting held in san diego , usa , july 2629 , 2004 , http://planetquest1.jpl.nasa.gov/tpfdarwinconf/confproceedings.cfm"
  ],
  "abstract_text": [
    "<S> high - contrast imaging from space must overcome two major noise sources to successfully detect a terrestrial planet angularly close to its parent star : photon noise from diffracted star light , and speckle noise from star light scattered by instrumentally - generated wavefront perturbation . </S>",
    "<S> coronagraphs tackle only the photon noise contribution by reducing diffracted star light at the location of a planet . </S>",
    "<S> speckle noise should be addressed with adaptative - optics systems . following the tracks of @xcite </S>",
    "<S> , we develop in this paper two analytical methods for wavefront sensing and control that aims at creating _ dark holes _ , i.e. areas of the image plane cleared out of speckles , assuming an ideal coronagraph and small aberrations . </S>",
    "<S> the first method , _ speckle field nulling _ , is a fast fft - based algorithm that requires the deformable - mirror influence functions to have identical shapes . </S>",
    "<S> the second method , _ speckle energy minimization _ </S>",
    "<S> , is more general and provides the optimal deformable mirror shape via matrix inversion . with a @xmath0 deformable mirror , </S>",
    "<S> the size of matrix to be inverted is either @xmath1 in the general case , or only @xmath0 if influence functions can be written as the tensor product of two one - dimensional functions . </S>",
    "<S> moreover , speckle energy minimization makes it possible to trade off some of the dark hole area against an improved contrast . for both methods , complex wavefront aberrations ( amplitude and phase ) </S>",
    "<S> are measured using just three images taken with the science camera ( no dedicated wavefront sensing channel is used ) , therefore there are no non - common path errors . </S>",
    "<S> we assess the theoretical performance of both methods with numerical simulations including realistic speckle noise and experimental influence functions . </S>",
    "<S> we find that these speckle nulling techniques should be able to improve the contrast by several orders of magnitude . </S>"
  ]
}