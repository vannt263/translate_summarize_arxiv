{
  "article_text": [
    "since the experimental realization of the first atomic gaseous bose - einstein condensates a few years ago @xcite , the physics of dilute bose gases has been considered with a renewed interest .",
    "one fascinating aspect of these new systems is the possibility to accumulate in a single quantum state a large fraction of the atoms confined in a trap .    at very low temperature ,",
    "a simple theoretical description of the dynamics of these systems is obtained by neglecting the uncondensed atoms , and by considering the wave function of the condensate , which obeys a schrdinger equation with a non linear term originating from the mean - field interactions between the atoms .",
    "such an approach neglects two- and more - particle correlations and is valid under a weak - interaction condition which is usually stated in terms of the density @xmath9 and the scattering length @xmath10 of the gas as @xmath11 .",
    "current gaseous condensates satisfy such a condition .",
    "nevertheless effects beyond the gross - pitaevskii equation may be considered at zero temperature ; also finite temperature phenomena are not accounted for by the pure state mean field approach .",
    "more complex theories have been developed in order to cope with effects beyond the gross - pitaevskii equation : bogoliubov s approach takes into account the next term in the @xmath12 expansion @xcite .",
    "also quantum kinetic theories have been developed to study the formation of the condensate and to include the effect of the non - condensed particles @xcite .",
    "unfortunately the corresponding calculations are quite heavy for 3d non - homogeneous systems such as trapped gases , and this constitutes a first limitation to the use of these methods .",
    "also approximations used in some of these mean field theories are not under rigorous control , making it difficult to assess their domain of validity ( for a review see e.g.   @xcite ) .",
    "therefore a computational scheme capable to provide exact results can have a great importance both from a purely theoretical point of view and for a quantitative analysis of experimental data .",
    "when the bose gas is at thermal equilibrium such an exact numerical calculation of the properties of the gas is available , using the quantum monte - carlo techniques , based on feynman path integral formulation of quantum mechanics @xcite .",
    "the aim of this paper is to present an alternative exact and numerically tractable solution to the problem of the interacting bose gas , a method not restricted to the case of thermal equilibrium but which allows for the study of the dynamics of the gas .",
    "the method is based on a stochastic evolution of hartree states , in which all atoms have the same wave function , these hartree states being either fock states ( fixed number of atoms ) or coherent states . as a particular case of this solution with coherent states , we recover the stochastic scheme corresponding to the evolution of the density operator of the system in the positive @xmath8-representation @xcite .",
    "this evolution is known to lead to strong unstability problems , which fortunately do not show up for other implementations of the present method .",
    "the outline of the paper is the following : in section [ sec : stoch_form ] , we present the stochastic formulation of the evolution of these hartree states which , after average over the stochastic component , leads to the exact evolution .",
    "section [ sec : schemes ] is devoted to the presentation of two particular schemes implementing this stochastic formulation .",
    "we first present a simple scheme , which minimizes the statistical spread of the calculated @xmath0-atom density matrix .",
    "we also investigate a more elaborate scheme in which the trace of the calculated density matrix remains strictly constant in the evolution . with this constraint ,",
    "we recover for coherent states the known stochastic simulation associated with the positive @xmath8-representation @xcite .",
    "finally we investigate in sections [ sec : mc ] and [ sec:1d ] two examples , a two - mode model system and a one - dimensional bose gas respectively .",
    "these examples illustrate the accuracy and the limitations of the method . generally speaking we find that the simple scheme simulations are only limited by the computation power : the number of realizations needed for a good statistical accuracy increases exponentially with time for the simulation with fock states . on the contrary the simulations with constant trace are subject to divergences of the norms of the stochastic wave functions in finite time , a phenomenon already known for coherent states in the context of the positive @xmath8-representation @xcite .",
    "the hamiltonian of the trapped interacting bose gas under exam can be written in terms of the bose field operator @xmath13 as : @xmath14 where @xmath15 is the set of spatial coordinates of a particle , @xmath16 is the single particle hamiltonian in the external confining potential @xmath17 and where interactions are assumed to occur via a two - body potential @xmath18 .    in practice",
    "we consider the dilute gas and the low temperature regimes , which correspond respectively to @xmath19 and @xmath20 for a three - dimensional problem ( @xmath21 is the thermal de broglie wavelength ) .",
    "the true interaction potential can then be replaced by a simpler model potential leading to the same scattering length @xmath10 provided that the range @xmath22 of this model potential is much smaller than the healing length @xmath23 and than @xmath24 @xcite .",
    "this ensures that the physical results do not depend on @xmath22 . for simplicity we will use here repulsive gaussian potentials corresponding to a positive scattering length @xmath25 .",
    "from a mathematical point of view , the exact evolution of the @xmath0-body density matrix @xmath1 can be obtained from the hamiltonian ( [ eq : hamilt ] ) using the quantum - mechanical equation of motion @xmath26\\ ] ] but any concrete calculation is impracticable even for moderate particle numbers @xmath0 , due to the multi - mode nature of the problem leading to a huge dimensionality of the @xmath27body hilbert space .",
    "for this reason approximate theories have been developed in order to get useful results at least in some specific ranges of parameters ; the simplest one is the so - called mean - field theory , in which the @xmath0-particle density matrix is approximated by a fock state hartree ansatz @xmath28 the evolution of the normalized _ condensate wave function _",
    "@xmath29 is determined using either a factorization approximation in the evolution equation for the field operator @xcite or a variational procedure @xcite .",
    "the result is the well - known mean - field equation @xmath30 for an interaction potential @xmath18 modeled by a contact term @xmath31 ( where @xmath32 in a three - dimensional problem ) it reduces to the gross - pitaevskii equation commonly used to analyze the dynamics of pure bose - einstein condensed gases .",
    "a first attempt to improve the accuracy of the hartree ansatz ( [ eq : hartreeansatz ] ) is to allow for a stochastic contribution @xmath33 in the evolution of the macroscopic wave function @xmath29 : @xmath34 in all this paper the noise @xmath33 is treated in the standard ito formalism @xcite : it is assumed to have a zero mean @xmath35 and to have a variance @xmath36 ; a deterministic contribution is given by the force \" term @xmath37 . in this framework , the @xmath0-body density matrix would result from the stochastic mean over noise or , in other terms , from a mean over the probability distribution @xmath38 in the functional space of the wave functions @xmath29 : @xmath39 an immediate advantage of this prescription over the pure state ansatz eq.([eq : hartreeansatz ] ) is that it could deal with finite temperature problems @xcite .",
    "however as shown in  [ subsec : valid_stoch ] , the simple generalization eq.([eq : hartreeevstoch1 ] ) of the gross - pitaevskii equation can not lead to an exact solution of the @xmath0-body problem @xcite .",
    "therefore we have to enlarge the family of dyadics over which we expand the density operator ; more precisely we use hartree dyadics in which the wave functions in the bra and in the ket are different : @xmath40 the two wave functions @xmath41 and @xmath42 are assumed to evolve according to ito stochastic differential equations : @xmath43 the expansion eq.([eq : hartreeansatzstoch1 ] ) is then replaced by @xmath44 we will see in the following that within this extended hartree ansatz one can find a stochastic evolution for @xmath7 reproducing the exact time evolution .",
    "actual calculations ( see  [ sec : mc ] and  [ sec:1d ] ) will be performed with a monte - carlo technique , in which the evolution of the probability distribution @xmath45 is simulated by a large but finite number @xmath46 of independent realizations @xmath47 , @xmath48 . at any time the ( approximate ) density matrix @xmath1 is given by the mean over such an ensemble of wave functions : @xmath49 the expectation value of any operator @xmath50 is thus expressed by : @xmath51 for an hermitian operator one can equivalently consider only the real part of this expression since the imaginary part is vanishingly small in the large @xmath52 limit .",
    "consider as an example the one - particle density matrix of the gas , usually defined as : @xmath53 inserting in this expression our form of the complete density matrix ( [ eq : stochmean ] ) , we obtain the simple result @xmath54 from which it is easy to obtain the spatial density @xmath55 and the correlation function @xmath56 .",
    "also , the condensate fraction can be obtained from the largest eigenvalue of @xmath57 .",
    "* remarks : *    1 .   the desired stochastic evolution , which has to satisfy tr@xmath58=1 $ ] , can not preserve the normalization of @xmath7 to unity ; we can write indeed @xmath59=\\big\\langle { \\langle\\phi_2(t)|\\phi_1(t)\\rangle^n}\\big\\rangle_{\\rm stoch}=1\\ ] ] which for @xmath60 imposes @xmath61 .",
    "2 .   the expansion eq.([eq : hartreeansatzstoch2 ] )",
    "is always possible . using the identity @xmath62 where the functions @xmath63 have a uniform distribution over the unit sphere in the functional space , we obtain @xmath64 we write the matrix elements @xmath65 as @xmath66 and we set @xmath67 and @xmath68 .",
    "putting @xmath69 and reindexing @xmath70 as a single index @xmath71 we recover the expansion eq.([eq : stochmean ] ) .",
    "note that this expansion is not unique and does not have the pretension to be the most efficient one .",
    "for instance if the system is initially in a hartree state @xmath72 , such a procedure is clearly not needed since one has just to set @xmath73",
    ". this will be the case of the numerical examples in sections [ sec : mc ] and [ sec:1d ] .      in this subsection",
    "we calculate the stochastic time evolution during an infinitesimal time interval @xmath74 of the dyadic @xmath75 given in eq.([eq : decorransatz ] )",
    ". this will be used later in a comparison with the exact master equation .",
    "after @xmath76 , the dyadic @xmath77 has evolved into : @xmath78 where @xmath79 and @xmath80 , defined according to ( [ eq : hartreeevstoch2 ] ) , contain both the deterministic contribution @xmath81 and the stochastic one @xmath82 . splitting each contribution into a longitudinal and an orthogonal component with respect to @xmath83 and isolating a gross - pitaevskii term in the deterministic contribution",
    ", we can write : @xmath84 our choice of the gross - pitaevskii term is the following one : @xmath85\\phi_\\alpha(x ) \\nonumber \\\\ & - & \\frac{1}{i\\hbar}\\left[\\frac{(n-1)}{2}\\frac { { \\left\\langle \\phi_\\alpha \\phi_\\alpha | v | \\phi_\\alpha\\phi_\\alpha \\right\\rangle } } { { \\left\\|\\phi_\\alpha\\right\\|}^4 } \\right]\\phi_\\alpha(x ) .",
    "\\label{eq : gpcorr}\\end{aligned}\\ ] ] the first term gives the standard gross - pitaevskii evolution , including the kinetic term , the potential energy of the trap and the mean - field interaction energy ; the second term , which arises naturally because we are considering fock states ( rather than coherent states as commonly done ) takes into account the difference between the total mean - field energy per particle of the condensate and its chemical potential @xmath86  @xcite .",
    "we split the field operator in its longitudinal and transverse components , keeping in mind that the wave functions @xmath83 are not of unit norm : @xmath87 with @xmath88 the relevant bosonic commutation relations then read : @xmath89 = { \\left\\|\\phi_{\\alpha}\\right\\|}^2 \\qquad \\mbox{and } \\qquad [ \\hat{a}_{\\phi_\\alpha},\\delta { \\hat\\psi^\\dagger}_\\alpha(x)]=0.\\ ] ] we will also need the projector @xmath90 onto the subspace orthogonal to @xmath91 : @xmath92= \\psi(x , x',\\ldots ) -\\frac{\\phi_\\alpha(x)}{||\\phi_\\alpha||^2}\\int dy\\ ; \\phi_\\alpha^*(y)\\,\\psi(y , x',\\ldots).\\ ] ] this projector arises in the calculation as we have introduced a component of the field operator orthogonal to @xmath83 . using @xmath93",
    "we shall transform integrals involving @xmath94 as follows : @xmath95\\delta { \\hat\\psi^\\dagger}_\\alpha(x).\\ ] ]    inserting these definitions in ( [ eq : sigmat+dt ] ) the expression for @xmath77 at time @xmath96 can be written as @xmath97 where the notation _ e.c .",
    "_ stands for the _ exchanged _ and _ conjugate _ of a quantity , that is the complex conjugate of the same quantity after having exchanged the indices 1 and 2 .",
    "the explicit expressions for the @xmath98 are : @xmath99dt+ f_1^\\perp(x)dt+ db_1^\\perp(x)+(n-1)d \\gamma_1\\ ; d b_1^\\perp(x ) + n\\;d b_1^\\perp(x)\\;d\\gamma_2^*\\right\\ }   \\label{toto } \\\\ & & s{^{(2)}}_1(x , x')=\\frac{\\sqrt{n(n-1)}}{2}d b_1^\\perp(x)\\;d b_1^\\perp(x ' ) \\\\ & & s{^{(1,1)}}(x , x')=n\\;d b_1^\\perp(x)\\;d b_2^{\\perp * } ( x ' ) .",
    "\\label{eq : evstoch2}\\end{aligned}\\ ] ] analogous expressions for @xmath100 , @xmath101 , @xmath102 are obtained by exchanging the indices 1 and 2 . in the next subsection",
    ", we evaluate the exact evolution of the same dyadic during a time interval @xmath74 , so that we can determine the constraints on the force and noise terms entering into these equations .",
    "to make the stochastic scheme described in the previous sections equivalent to the exact dynamics as it is given by ( [ eq : hamilt ] ) , the final result of the previous subsection ( [ eq : evstoch])-([eq : evstoch2 ] ) has to be compared with the exact evolution of the density matrix @xmath75 .",
    "consider a dyadic @xmath103 at time @xmath104 ; according to the equation of motion ( [ eq : exactev ] ) , after an infinitesimal time step @xmath74 it has evolved into : @xmath105 where the @xmath106 are given by @xmath107\\\\ & & e{^{(1)}}_1(x)=\\frac{dt\\sqrt{n}}{i\\hbar } { \\mathcal q}_1^{(x)}\\left [ \\left(h_0 + \\frac{(n-1)}{{\\left\\|\\phi_1\\right\\|}^2}\\;\\int\\!dx'\\;v(x - x ' ) { \\left|\\phi_1(x')\\right|}^2\\right)\\phi_1(x)\\right ] \\\\ & & e{^{(2)}}_1(x , x')=\\frac{dt\\sqrt{n(n-1)}}{2i\\hbar}\\ ; { \\mathcal q}_1^{(x)}{\\mathcal q}_1^{(x')}[v(x - x')\\phi_1(x)\\phi_1(x ' ) ] .",
    "\\label{eq : evexacte2}\\end{aligned}\\ ] ] analogous expressions for @xmath108 , @xmath109 , @xmath110 are obtained by exchanging the indices 1 and 2 .",
    "the similarity of the structures of ( [ eq : evstoch ] ) and ( [ eq : evexacte ] ) suggests the possibility of a stochastic scheme equivalent to the exact evolution : to achieve this , it is necessary to find out specific forms of deterministic ( [ eq : detf ] ) and stochastic ( [ eq : stochdb ] ) terms for which the mean values of the @xmath111 equal the @xmath112 : @xmath113    from the last equation ( [ eq : condit4 ] ) , it follows immediately why independent bras and kets are needed in the ansatz ( [ eq : decorransatz ] ) : in the case @xmath114 such a condition would in fact lead to a vanishing orthogonal noise and finally to the impossibility of satisfying ( [ eq : condit3 ] ) .    in terms of the different components ,",
    "these conditions can be rewritten as : @xmath115 + n\\overline{d\\gamma_1 d\\gamma_2^ * } = 0 \\label{eq : cond1 } \\\\ & & f_1^\\perp(x)\\;d t+(n-1){\\overline{d b_1^\\perp(x)\\,d\\gamma_1 } } +",
    "n { \\overline{d b_1^\\perp(x)\\,d\\gamma_2^ * } } = 0 \\label{eq : cond2 } \\\\ & & f_2^\\perp(x)\\;d t+(n-1){\\overline{d b_2^\\perp(x)\\,d\\gamma_2 } } + n { \\overline{d b_2^\\perp(x)\\,d\\gamma_1^ * } } = 0 \\label{eq : cond2bis } \\\\ & & { \\overline{d b_\\alpha^\\perp(x)d b_\\alpha^\\perp(x')}}=\\frac{d t}{i\\hbar } { \\mathcal q}_\\alpha^{x } { \\mathcal q}_\\alpha^{x ' } \\left[v(x - x ' ) \\phi_\\alpha(x)\\phi_\\alpha(x')\\right ] \\label{eq : cond3 } \\\\ & & { \\overline{d b_1^\\perp(x ) { d b_2^\\perp}^*(x')}}=0 .",
    "\\label{eq : cond4}\\end{aligned}\\ ] ] as we shall discuss in detail in ",
    "[ sec : schemes ] , several different stochastic schemes can be found satisfying ( [ eq : cond1])-([eq : cond4 ] ) ; each of them gives an evolution identical in average to the exact one , but the statistical properties can be very different .      up to now",
    "we have worked out the case of a fock state ansatz @xmath116 .",
    "actually coherent states rather than fock states are generally used , both in quantum optics and in condensed matter physics .",
    "we now show that our stochastic procedure also applies with a coherent state ansatz of the form : @xmath117 with @xmath118 where @xmath119 is the mean number of particles .",
    "we have included here a prefactor @xmath120 which was absent in the case of the fock state ansatz eq.([eq : decorransatz ] ) ; in the fock state case indeed such a prefactor could be reincluded into the definition of @xmath121 and @xmath122 .",
    "the wave functions @xmath123 and the prefactor factor @xmath124 evolve according to ito stochastic differential equations @xmath125 splitting the field operator as @xmath126 and using @xmath127 we find that the equivalence of the stochastic scheme and the exact evolution translates into the set of conditions : @xmath128 as we shall see in  [ sec : schemes ] , such conditions are satisfied by several stochastic schemes .",
    "very remarkably , the stochastic evolution deduced from the positive @xmath8-representation @xcite arises naturally as one of them .    within this coherent state ansatz",
    "the one - particle density matrix is evaluated using @xmath129 in a practical implementation of the simulation it turns out to be numerically more efficient to represent @xmath120 as the exponential of some quantity @xmath130 and to evolve @xmath131 according to the stochastic equation @xmath132\\nonumber \\\\ & & -\\frac{\\bar{n}dt}{2i\\hbar}\\int dx\\int dx'\\ ; v(x - x ' )   \\left[|\\phi_1(x)|^2|\\phi_1(x')|^2-|\\phi_2(x)|^2|\\phi_2(x')|^2 \\right].\\end{aligned}\\ ] ]",
    "in the previous section we have derived the conditions that a stochastic scheme has to satisfy in order to recover the exact evolution given by the hamiltonian ( [ eq : hamilt ] ) ; in the case of the fock state ansatz ( [ eq : decorransatz ] ) , we get to the system ( [ eq : cond1])-([eq : cond4 ] ) , while in the case of the coherent state ansatz ( [ eq : coheransatz ] ) we get to the conditions ( [ eq : condcoh1])-([eq : condcoh4 ] ) . as the number of these equations is actually smaller than the number of unknown functions there is by no mean uniqueness of the solutions , that is of the simulation schemes .",
    "we need a strategy to identify interesting solutions .",
    "we therefore start this section by considering various indicators of the statistical error of the simulation (  [ subsec : growth ] ) which can be used as guidelines in the search for simulation schemes .",
    "these indicators are defined as variances of relevant quantities which are conserved in the exact evolution but which may fluctuate in the simulation .",
    "we show that these indicators are non decreasing functions of time ; attempts to minimize the time derivative of a specific indicator will lead to particular implementations of the general stochastic method , such as the _ simple _ scheme (  [ subsec : simple ] ) and the _ constant trace _ scheme (  [ subsec : constant ] ) .",
    "the first indicator that we consider measures the squared deviation of the stochastic operator @xmath75 from the exact density operator @xmath133 : @xmath134}\\big\\rangle_{\\rm stoch }   \\nonumber \\\\ & = & \\big\\langle{\\mbox{tr}[\\sigma^{\\dagger}(t)\\sigma(t)]}\\big\\rangle_{\\rm stoch } - \\mbox{tr}[\\rho(t)^2 ] .",
    "\\label{eq : def_delta}\\end{aligned}\\ ] ]    we now show that @xmath135 is a non - decreasing function of time . when the stochastic scheme satisfies the validity conditions derived in the previous section , we can write the stochastic equation for @xmath77 as : @xmath136 + d\\sigma_s\\ ] ] where @xmath137 is a zero - mean noise term linear in @xmath82 ( and @xmath138 for the coherent state simulation ) . in the case of simulation with fock states",
    "it is given by @xmath139 in the case of simulation with coherent states it is given by @xmath140    we calculate the variation of @xmath141 during @xmath74 , replacing @xmath77 by @xmath142 in eq.([eq : def_delta ] ) and keeping terms up to order @xmath74 .",
    "using the invariance of the trace in a cyclic permutation and averaging over the noise between @xmath104 and @xmath96 we finally obtain @xmath143}\\big\\rangle_{\\rm stoch},\\ ] ] which is a positive quantity .",
    "minimization of this quantity is the subject of  [ subsec : simple ] .",
    "physically @xmath144 means that the impurity of the stochastic density operator @xmath77 always increases in average , while the exact density operator has a constant purity @xmath145 $ ] .",
    "the second kind of indicator that we consider measures the statistical error on constants of motion of the exact evolution . consider a time independent operator @xmath146 commuting with the hamiltonian .",
    "the stochastic evolution leads to an error on the expectation value of @xmath146 with a variance given by the ensemble average of @xmath147-\\mbox{tr}[x\\rho(t)]\\big|^2 } \\big\\rangle_{\\rm stoch}\\nonumber \\\\ & = & \\big\\langle{\\big|\\mbox{tr}[x\\sigma(t)]\\big|^2}\\big\\rangle_{\\rm stoch }   - \\big|\\mbox{tr}[x\\rho(t)]\\big|^2.\\end{aligned}\\ ] ] from eq.([eq : evol_compacte ] ) we obtain the variation after a time step @xmath74 of the expectation value of @xmath146 along a stochastic trajectory :",
    "@xmath148 ) =   \\frac{dt}{i\\hbar}\\mbox{tr}\\left(x[{\\mathcal h},\\sigma]\\right ) + \\mbox{tr}[xd\\sigma_s].\\ ] ] using the invariance of the trace under cyclic permutation and the commutation relation @xmath149=0 $ ] we find that the first term in the right hand side of eq.([eq : d_tr ] ) vanishes so that @xmath150\\big|^2\\big\\rangle_{\\rm stoch } , \\label{eq : expres}\\ ] ] a quantity which is always non - negative .    using expression ( [ eq : expres ] )",
    "one can design simulations preserving exactly the conserved quantity , the constraint to meet being @xmath151=0 $ ] : for instance in the fock state simulation , one first chooses the transverse noises @xmath152 satisfying eqs.([eq : cond3],[eq : cond4 ] ) ; then one simply has to take for the longitudinal noise of @xmath121 : @xmath153 and a similar expression for @xmath154 ; finally the force terms @xmath155 are adjusted in order to satisfy eq.([eq : cond1]-[eq : cond2bis ] ) . as natural examples of conserved quantities",
    "one can choose @xmath156 or @xmath157 ; the former case is discussed in detail in  [ subsec : constant ] .",
    "these schemes are characterized by the minimization of the incremental variation of the statistic spread of the @xmath0-particle density matrix @xmath75 , a spread that we have already quantified in eq.([eq : def_delta ] ) by @xmath135 . to be more specific",
    "we assume that we have evolved a dyadic up to time @xmath104 , and we look for the noise terms that minimize the increase of @xmath158 $ ] between @xmath104 and @xmath96 .      in the case of the fock state ansatz ,",
    "we calculate explicitly the variation of @xmath158 $ ] from eq.([eq : dssf ] ) and we get : @xmath159}{n\\mbox{tr}[\\sigma^\\dagger\\sigma]}= n\\overline{|d\\gamma_1+d\\gamma_2^*|^2 } + \\sum_{\\alpha=1,2}||\\phi_\\alpha||^{-2 } \\int dx\\ ; \\overline{|db_\\alpha^\\perp(x)|^2 } + \\left[d\\gamma_1+d\\gamma_2^*+\\mbox{c.c.}\\right].\\ ] ] we now look for the noise terms @xmath160 and @xmath152 minimizing this quantity under the constraints eqs.([eq : cond1]-[eq : cond4 ] ) .",
    "we first note that we can choose @xmath161 without affecting the transverse noises , as shown by eqs.([eq : cond1]-[eq : cond4 ] ) : the correlation function of the transverse noises do not involve the @xmath160 , and we can accommodate for any choice of @xmath160 by defining appropriately the force terms @xmath162 . in the particular case defining our simple scheme",
    "we take all these force terms equal to zero .",
    "note that the choice of vanishing @xmath163 s immediately leads to a vanishing noise term in eq.([eq : ddf ] ) .    secondly the terms involving the transverse noise in eq.([eq : ddf ] ) are bounded from below : as the modulus of a mean is less than the mean of the modulus , we have @xmath164 with the left hand side of this inequality fully determined by condition eq.([eq : cond3 ] ) .",
    "we have found for the transverse noise a choice which fulfills eqs.([eq : cond3],[eq : cond4 ] ) and which saturates the inequality eq.([eq : inegalite ] ) : @xmath165\\ ] ] where @xmath166 is the dimension of position space , @xmath167 is the fourier transform of the model interaction potential , supposed here to be positive : @xmath168 the phases @xmath169 have the following statistical property : @xmath170 and @xmath171 are uncorrelated .",
    "in practice for half of the @xmath172-space ( e.g.  @xmath173 ) @xmath174 is randomly chosen between @xmath175 and @xmath176 ; for the remaining @xmath172 s we take @xmath177 .",
    "one can then check that this choice for the transverse noise reproduces the correlation function eqs.([eq : cond3],[eq : cond4 ] ) .",
    "we show now that the implementation ( [ eq : simple ] ) saturates the inequality eq.([eq : inegalite ] ) , so that it leads to the minimal possible value for @xmath178 $ ] within the validity constraints of the stochastic approach .",
    "we calculate explicitly the right hand side of eq.([eq : inegalite ] ) : @xmath179\\right)_{x = x ' } \\nonumber \\\\ & = & \\frac{dt}{\\hbar } |\\phi_\\alpha(x)|^2 \\left [ v(0 ) -2 \\int dy\\ ; \\frac{|\\phi_\\alpha(y)|^2}{||\\phi_\\alpha||^2}v(x - y ) + \\frac{\\langle\\phi_\\alpha,\\phi_\\alpha|v|\\phi_\\alpha,\\phi_\\alpha\\rangle } { ||\\phi_\\alpha||^4}\\right ] \\label{eq : rhs}\\end{aligned}\\ ] ] where @xmath180 projects onto the subspace orthogonal to @xmath181 and where we have used the positivity of the fourier transform @xmath182 of the model interaction potential . the left hand side of eq.([eq : inegalite ] )",
    "is calculated using eq.([eq : cond3 ] ) : @xmath183 .",
    "\\label{eq : lhs}\\ ] ] as the expressions between square brackets in eqs.([eq : lhs],[eq : rhs ] ) are real positive we deduce the equality in eq.([eq : inegalite ] ) .",
    "we can now calculate explicitly the variation of @xmath158 $ ] by integrating eq.([eq : rhs ] ) over @xmath15 : @xmath184}{n\\mbox{tr}[\\sigma^\\dagger\\sigma ] } =   \\frac{dt}{\\hbar}\\left [ 2 v(0)-\\sum_{\\alpha=1,2 } \\frac{\\langle\\phi_\\alpha,\\phi_\\alpha|v|\\phi_\\alpha,\\phi_\\alpha\\rangle } { ||\\phi_\\alpha||^{4}}\\right ] .",
    "\\label{eq : dtrsf}\\ ] ] this expression is particularly useful since it allows one to derive an upper bound on the increase of @xmath158 $ ] : as we assume here a positive gaussian model potential @xmath18 the matrix element @xmath185 is positive so that the right hand side of eq.([eq : dtrsf ] ) is smaller than @xmath186 . after time integration , using eq.([eq : def_delta ] ) and the fact that the trace of the squared density operator @xmath187 is a constant under hamiltonian evolution we can deduce an upper bound on the squared statistical error @xmath135 : @xmath188 \\leq \\left[\\delta(0)+\\mbox{tr}[\\rho^2]\\right ] e^{2nv(0)t/\\hbar}. \\label{eq : maj_delta}\\ ] ] note that it involves the model dependent quantity @xmath189 and not only the physical parameters of the problem such as the chemical potential or the scattering length",
    ". it may be therefore important to adjust the model interaction potential @xmath18 in order to minimize the growth of the statistical error for given physical parameters .    to summarize the proposed simple scheme has several noticeable properties .",
    "the deterministic force acting on the @xmath83 s is simply the mean field contribution , so that the whole correction to the mean field evolution is provided by the transverse noises @xmath152 .",
    "also the evolutions of the two states @xmath83 are totally independent from each other .      in the case of the coherent state ansatz , an explicit calculation of @xmath178",
    "$ ] from eq.([eq : dssc ] ) gives : @xmath190}{\\mbox{tr}[\\sigma^\\dagger\\sigma ] } & = & \\overline { \\left|\\frac{db}{\\pi}+\\bar{n}\\int dx\\ ; db_1(x)\\phi_1^*(x)+db_2^*(x)\\phi_2(x)\\right|^2 } + \\bar{n}\\sum_{\\alpha=1,2}\\int dx\\;\\overline{|db_\\alpha(x)|^2 } \\nonumber \\\\ & & + \\left[\\frac{db}{\\pi}+\\bar{n}\\int dx\\ ; db_1(x)\\phi_1^*(x)+db_2^*(x)\\phi_2(x ) + \\mbox{c.c}\\right ] .",
    "\\label{eq : ddc}\\end{aligned}\\ ] ]    we now proceed to the minimization of the increment of @xmath158 $ ] within the coherent state ansatz along the same lines as the previous subsection .",
    "first we optimize the noise @xmath138 on the normalization factor @xmath124 : @xmath191 this choice leads to a vanishing noise term in eq.([eq : ddc ] ) .",
    "we insert this expression for @xmath138 in the validity conditions eq.([eq : condcoh2 ] ) and eq.([eq : condcoh2bis ] ) and we obtain : latexmath:[\\[f_\\alpha(x)=\\frac{1}{i\\hbar}\\left[h_0+\\bar{n}\\int\\!dx'\\,v(x - x ' )     finally minimization of the contribution of the noise terms @xmath82 with the constraint eq.([eq : condcoh3 ] ) is achieved with the choice @xmath193 where the phases @xmath174 are randomly generated as in eq.([eq : theta ] ) .",
    "the first equation eq.([eq : condcohminbr1 ] ) fixes the deterministic evolution to the usual mean - field equation ( [ eq : gp ] ) .",
    "we note here that the mean - field term in eq.([eq : condcohminbr1 ] ) does not contain the normalization of the spatial density @xmath194 by @xmath195 , a feature present in the fock state simulation ( see eq.([eq : gpcorr ] ) ) .",
    "this is a disadvantage of the coherent state simulation since this normalization factor appearing in the fock state simulation has a regularizing effect : the norms @xmath196 may indeed deviate significantly from unity in the stochastic evolution .",
    "the second equation eq.([eq : condcohminbr2 ] ) determines the stochastic noise on the wave functions in a way very similar to the fock state case eq.([eq : simple ] ) .",
    "in particular the evolutions of @xmath121 and @xmath122 are still uncorrelated .",
    "the only difference is the disappearance of the projector @xmath197 in the expression of the noise , which leads to an increased noise with respect to the simulation with fock states .",
    "as in the previous subsection we now estimate the squared error @xmath141 . we calculate the variation of @xmath158",
    "$ ] for the choice of noise eq.([eq : condcohminbr2 ] ) : @xmath198}\\frac{d\\mbox{tr}[\\sigma^\\dagger\\sigma]}{dt } =   \\frac{\\bar{n } v(0)}{\\hbar } \\sum_{\\alpha=1,2 } ||\\phi_\\alpha||^2.\\ ] ] the average over all stochastic realizations of the norm squared of the wave functions can be calculated exactly : @xmath199 this leads to a remarkable identity on the trace of @xmath200 : @xmath201\\big\\rangle_{\\rm stoch}(t)= \\big\\langle \\ln \\mbox{tr}[\\sigma^\\dagger\\sigma]\\big\\rangle_{\\rm stoch}(0)+ \\bar{n}\\left(e^{tv(0)/\\hbar}-1\\right ) \\big\\langle \\sum_{\\alpha = 1,2 } ||\\phi_\\alpha||^2 \\big\\rangle_{\\rm stoch } ( 0 ) .",
    "\\label{eq : lnsc}\\ ] ] using finally the concavity of the logarithmic function , leading to the logarithm of a mean being larger than the mean of the logarithm we obtain a lower bound on the squared error @xmath141 on the @xmath27body density matrix : @xmath188\\geq   a \\exp\\left[2b\\bar{n}\\left(e^{tv(0)/\\hbar}-1\\right ) \\right ] \\label{eq : min_delta}\\ ] ] where we have introduced the constant quantities @xmath202\\big\\rangle_{\\rm stoch}(0)\\right ]   \\\\ b & = & \\frac{1}{2 } \\big\\langle \\sum_{\\alpha = 1,2 } ||\\phi_\\alpha||^2 \\big\\rangle_{\\rm stoch } ( 0)\\end{aligned}\\ ] ] it is quite remarkable that in the limit of times shorter than @xmath203 this lower bound scales exponentially with time as the upper bound eq.([eq : maj_delta ] ) obtained for fock states .",
    "consequently the simulation scheme with fock states is likely to be more efficient that the simulation with coherent states",
    ". this will indeed be the case in the numerical examples given in the next sections .",
    "we have given the expression of the one - body density matrix @xmath204 in terms of @xmath123 for the simulation with fock states eq.([eq : stochsingpartdensmat ] ) .",
    "this expressions shows that @xmath204 is very sensitive in the large @xmath0 limit to fluctuations of @xmath205 .",
    "the same remark applies to two - body observables . in order to improve the statistical properties of the simulation",
    "one can consider the possibility of a simulation scheme with @xmath206 at any time .",
    "this actually corresponds to a conserved trace of each single dyadic @xmath75 .",
    "this possibility is analyzed in ",
    "[ subsubsec : tcf ] ; it is extended to the coherent state simulation in  [ subsubsec : tcc ] , leading to the well - known positive @xmath8-representation formalism .      within the fock state ansatz",
    ", the conservation of the trace of the dyadic @xmath207 $ ] can be achieved by ( i ) choosing the transverse noises @xmath152 according to the formula eq.([eq : simple ] ) and ( ii ) using the expression eq.([eq : dgx ] ) for the longitudinal noise with @xmath156 .",
    "point ( ii ) gives : @xmath208 the forces terms @xmath209 and @xmath155 are fixed by the conditions ( [ eq : cond1])-([eq : cond2bis ] ) : @xmath210 and @xmath211 the expressions for @xmath212 and @xmath213 are obtained by exchanging the indices 1 and 2 in these results .      in the case of the coherent state ansatz",
    ", the value of @xmath137 , which is the zero - mean noise term entering the variation of the dyadic @xmath77 during a time step @xmath74 , is given in eq.([eq : dssc ] ) .",
    "the requirement of a constant trace @xmath207=\\pi e^{\\bar{n } { \\left\\langle \\phi_2 | \\phi_1 \\right\\rangle } } $ ] leads to the following condition on the noise terms @xmath214 we choose the noise terms @xmath82 as in eq.([eq : condcohminbr2 ] ) .",
    "the remaining parameters @xmath155 are now unambiguously determined by ( [ eq : condcoh2])-([eq : condcoh2bis ] ) : @xmath215\\phi_1(x ) \\label{eq : f1pp } \\\\ & & f_2(x)=\\frac{1}{i\\hbar}\\left[h_0+\\bar{n}\\int\\!dx'\\ , \\phi_1^*(x')v(x - x')\\phi_2(x')\\right]\\phi_2(x ) .",
    "\\label{eq : f2pp}\\end{aligned}\\ ] ] this scheme exactly recovers the stochastic evolution in the positive @xmath8-representation , which was originally obtained with a different mathematical procedure  @xcite .",
    "in order to test the convergence of the stochastic schemes developed in the previous section we now apply this method to a simple two - mode system for which the exact solution of the @xmath0-body schrdinger equation can also be obtained by a direct numerical integration .",
    "this allows ( i ) to check that the stochastic methods when averaged over many realizations give the correct result indeed , and ( ii ) to determine the statistical error for each of the four implementations of the stochastic approach ( constant trace vs.  simple , fock vs.  coherent states ) .",
    "the toy - model that we consider describes the dynamics of two self - interacting condensates coherently coupled one to the other .",
    "it can be applied to the case of two condensates separated by a barrier @xcite ( josephson - type coupling ) or condensates in two different internal states coupled by an electromagnetic field @xcite ( rabi - type coupling ) . in this model",
    "we restrict the expansion of the atomic field operator to two orthogonal modes , @xmath216 the hamiltonian eq.([eq : hamilt ] ) takes the simple form : @xmath217 where @xmath218 annihilate a particle in modes @xmath219 and @xmath220 , @xmath221 characterizes the strength of the atomic interactions inside each condensate and @xmath222 is the rabi coupling amplitude between the two condensates .",
    "here we have restricted for simplicity to the case where ( i ) the condensates have identical interaction properties , ( ii ) the interactions between atoms in different wells are negligible , and ( iii ) the rabi coupling is resonant .",
    "the most general two - mode case could be treated along the same lines .",
    "the direct numerical solution of the schrdinger equation is performed in a basis of fock states @xmath223 with @xmath224 particles in modes @xmath225 .",
    "the numerical integration is simplified by the fact that @xmath226 is a quantity conserved by the hamiltonian evolution .",
    "we start with a state in which all atoms are in mode @xmath220 , either in a fock state @xmath227 ( for the fock state simulations ) or in a coherent state latexmath:[$\\propto \\exp(n^{1/2}\\hat{b}^\\dagger )    evolution of the mean fraction of particles in mode @xmath219 , @xmath229 .",
    "mean - field theory ( the gross - pitaevskii equation ) , valid in the limit @xmath230 with a fixed @xmath231 @xcite , predicts periodic oscillations of @xmath232 ; the peak - to - peak amplitude of the oscillations is equal to unity if @xmath233 , and is smaller than one otherwise @xcite . in the exact solution the oscillations are no longer periodic due to emergence of incommensurable frequencies in the spectrum of @xmath234 .    in the simulation method",
    "we evolve sets of two complex numbers representing the amplitudes of the functions @xmath41 and @xmath42 on the modes @xmath235 ( plus the @xmath124 coefficient in the coherent state case ) .",
    "the results are presented in figure [ fig : tm ] for @xmath236 particles and @xmath237 , together with the result of the direct integration of the schrdinger equation .",
    "the first row in the figure concerns the constant trace simulations .",
    "figure [ fig : tm]a shows results of the simulation based on the positive @xmath8-representation , that is the constant trace simulation with coherent states .",
    "as well known @xcite this scheme leads to divergences of the norm @xmath238 for some realizations of the simulation .",
    "we have cut the plot in figure [ fig : tm ] at the first divergence .",
    "the same type of divergences occurs in the constant trace simulation with fock states ( figure [ fig : tm]b ) .",
    "note however that the characteristic time for the first divergence to occur is somewhat longer .",
    "we have checked for these constant trace simulations that the probability distribution of @xmath238 broadens with time , eventually getting a power law tail .",
    "the corresponding exponent @xmath239 decreases in time below the critical value @xmath240 for which the variance of @xmath241 becomes infinite .",
    "this scenario is identical to the one found with the positive @xmath8-representation @xcite .    the simple simulation schemes plotted on the second row of figure [ fig : tm ] provide results which are at all time in agreement with the direct integration within the error bars .",
    "contrarily to the constant trace schemes we do not observe finite time divergences in the simple schemes . for a given evolution time we have checked that the error bars scale as @xmath242 where @xmath52 is the number of stochastic realizations . for a given @xmath52 we found that the error bars increase quasi - exponentially with time .",
    "the noise in the simple simulation schemes is investigated in more details in figure [ fig : trace ] which shows the error estimator @xmath243\\big\\rangle_{\\rm stoch}$ ] as function of time , for coherent states in figure [ fig : trace]a and for fock states in figure [ fig : trace]b .",
    "the coherent state result confirms the prediction eq.([eq : min_delta ] ) .",
    "the fock state result is found to be notably smaller than the upper bound eq.([eq : maj_delta ] ) .",
    "this is due to the fact that the terms proportional to @xmath185 in eq.([eq : dtrsf ] ) are not negligible as compared to the term @xmath189 .",
    "we have checked these conclusions for various values of @xmath0 and @xmath244 .    for a large number of particles it is known @xcite that the oscillations of @xmath245 experience a collapse followed by revivals .",
    "these revivals are purely quantum phenomena for the field dynamics and they can not be obtained in classical field approximation such as the gross - pitaevskii equation . we expect to see a precursor of this phenomenon even for the small number of particles @xmath236 . as the simple scheme simulation with fock states is the most efficient of the four schemes for the investigation of the long time limit , we have pushed it to the time at which a revival \" can be seen , as shown in figure [ fig : revival ] .",
    "this figure is obtained with @xmath246 simulations .",
    "the interacting bose gas is in general a multi - mode problem , and the simulation schemes may have in this case a behavior different from the one in a few - mode model such as in  [ sec : mc ] .",
    "we have therefore investigated a model for a one - dimensional bose gas .",
    "the atoms are confined in a harmonic trap with an oscillation frequency @xmath247 .",
    "they experience binary interactions with a gaussian interaction potential of strength @xmath248 and range @xmath22 : @xmath249.\\ ] ] at time @xmath250 all the atoms are in the same normalized state @xmath29 solution of the time independent gross - pitaevskii equation @xmath251 of the cloud as function of time is obtained by taking @xmath252 in eq.([eq : stochmeano ] ) where @xmath253 is the position operator of the @xmath254th particle .",
    "the quantity @xmath255 is shown in figure [ fig:1d_largeur ] for the simulation schemes with fock states .",
    "one recovers the key feature of the constant trace simulation , that is a divergence of the norm @xmath241 in finite time for some realizations . before the occurrence of the first divergence the stochastic variance of the size squared of the cloud ,",
    "defined as @xmath256 ^ 2 \\qquad \\mbox{with } \\qquad r_i^2(t ) = { \\cal r}e \\left[\\langle n:\\phi_2^{(i)}(t)|\\hat{o}|n:\\phi_1^{(i)}(t)\\rangle\\right]\\ ] ] is notably smaller in the constant trace scheme than in the simple scheme , as shown in figure [ fig:1d_bruit]a .",
    "this contrast between the two schemes for the statistical error on one - body observables was absent in the two - mode model of  [ sec : mc ] .",
    "we have also investigated the noise on the @xmath27body density matrix characterized by @xmath257\\big\\rangle_{\\rm stoch}$ ] ( see figure [ fig:1d_bruit]b ) . as expected",
    "this error indicator is smaller with the simple scheme . for this simple scheme",
    "it varies quasi exponentially with time with an exponent @xmath258 , which is smaller by a factor roughly 2 than the one of the upper bound eq.([eq : maj_delta ] ) .",
    "this difference is due to the fact that the range @xmath22 of the interaction potential is chosen here of the same order as the size @xmath259 of the cloud so that the terms @xmath260 neglected in the derivation of the upper bound are actually significant .",
    "we have checked for various ranges @xmath22 much smaller than @xmath259 that @xmath261 then approaches the upper bound @xmath262 .",
    "in this paper we have investigated a general method to solve exactly the @xmath27body problem in the bosonic case .",
    "the principle of the approach is to add to the usual mean - field gross - pitaevskii equation a fluctuating term .",
    "we have determined the general conditions ensuring that the average over all possible realizations of this stochastic equation reproduces the exact @xmath27body schrdinger equation .",
    "this idea already received a particular implementation in quantum optics , in the frame of the positive @xmath8-representation .",
    "we recover here the scheme based on the positive @xmath8-representation as a particular case of a simulation evolving coherent states of the bosonic field with the constraint that the trace of the density operator should remain exactly equal to unity for each single realization .",
    "this provides a simple derivation of the stochastic evolution within this representation alternative to the usual one @xcite based on analyticity properties .    among the many possible implementations of the general stochastic approach we have also investigated schemes evolving fock states ( that is number states ) rather than coherent states",
    "this is well suited to situations where the total number of particles is conserved .",
    "in particular we have identified a scheme preserving exactly the trace of the density operator which is for number states the counterpart of the one based on the positive @xmath8-representation .    schemes with constant trace are subject to divergence of the norm of some realizations in finite time .",
    "this effect , already known in the context of the positive @xmath8-representation @xcite , makes these schemes difficult to use .    in order to overcome this divergence problem",
    "we have investigated schemes in which the condition on the trace is relaxed .",
    "we have chosen instead to minimize the statistical spread on the @xmath27body density matrix , which gave rise to the simple schemes , either with coherent states or fock states . in this case",
    "the @xmath27body density operator is obtained as a stochastic average of dyadics such as @xmath263 or @xmath264 , where the evolutions of @xmath121 and @xmath122 are fully decoupled .",
    "the deterministic parts are given by gross - pitaevskii equations , which preserves the norm of @xmath7 , contrarily to the case of constant trace schemes .",
    "the decoupling between the evolutions of @xmath121 and @xmath122 allows a reinterpretation of our representation of the @xmath27body density operator .",
    "if the initial density operator is given by @xmath265 it will be given at time @xmath104 by @xmath266 with the @xmath27particle state vector @xmath267 .",
    "the simple schemes have much better stability properties than the constant trace schemes : differently from the case of constant trace schemes , the deterministic evolution of the simple schemes has a gross - pitaevski form and thus conserves the norms @xmath268 .",
    "this condition , together with the upper bound on the eigenvalues @xmath269 of the noise covariance operator @xmath270 , can be used to prove that the stochastic equations possess a finite , _ non - exploding _ solution valid for all times ( see @xcite in page 94 , @xcite in  4.5 ) .",
    "we have numerically applied the simulation schemes to a two - mode model and to a one - dimensional bose gas . in both cases we found that the constant trace schemes lead to some diverging realizations , while the simple schemes lead to a statistical spread on the @xmath27body density operator increasing exponentially with time with an exponent @xmath271 .",
    "the simple schemes are therefore not well suited to determine small deviations from the mean - field approximation in the large @xmath0 limit but can be more efficiently applied to systems with a small number of particles , such as small atomic clouds tightly trapped at the nodes or antinodes of an optical lattice .    in the one - dimensional numerical example of this paper",
    "we have presented results for a simple one - body observable , the size of the atomic cloud .",
    "we have actually extended the calculations to more elaborate observables such as the first order and the second order correlation functions of the field .",
    "we have not presented the results here as the initial state of the gas was taken to be a ( not very physical ) hartree - fock state .",
    "we are presently working on the possibility to generate a more realistic initial state such as a thermal equilibrium for the gas , by extending our stochastic approach to evolution in imaginary time .",
    "this work has several possible perspectives of extension .",
    "one can first use as building block a more sophisticated ansatz than the hartree - fock state @xmath272 , such as bogoliubov vacua ( that is squeezed states of the atomic field ) or a multimode hartree - fock ansatz ( that is an arbitrary coherent superposition of number states in several adjustable modes of the field ) .",
    "one can also look for _ approximate _ rather than _ exact _ stochastic solutions to the @xmath27body problem but that would be better than mean - field approaches in some given situations .",
    "we hope to address some of these perspectives in the near future .",
    "one can show that the distribution @xmath273 evolves according to a functional fokker - planck equation with a non - positive diffusion coefficient .",
    "this can not be simulated by a brownian motion of @xmath29 . in quantum optics",
    "this problem is known to occur in the glauber - sudarshan @xmath8-representation of the density matrix .",
    "see e.g. @xcite , chap ."
  ],
  "abstract_text": [
    "<S> we present a numerically tractable method to solve exactly the evolution of a @xmath0 boson system with binary interactions . </S>",
    "<S> the density operator of the system @xmath1 is obtained as the stochastic average of particular operators @xmath2 of the system . </S>",
    "<S> the states @xmath3 are either fock states @xmath4 or coherent states @xmath5 with each particle in the state @xmath6 . </S>",
    "<S> we determine the conditions on the evolution of @xmath7 which involves a stochastic element under which we recover the exact evolution of @xmath1 . </S>",
    "<S> we discuss various possible implementations of these conditions . </S>",
    "<S> the well known positive @xmath8-representation arises as a particular case of the coherent state ansatz . </S>",
    "<S> we treat numerically two examples : a two - mode system and a one - dimensional harmonically confined gas . </S>",
    "<S> these examples , together with an analytical estimate of the noise , show that the fock state ansatz is the most promising one in terms of precision and stability of the numerical solution .    * </S>",
    "<S> pacs : * 03.75.fi , 05.10.gg , 42.50.-p </S>"
  ]
}