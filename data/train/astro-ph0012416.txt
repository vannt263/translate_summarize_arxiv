{
  "article_text": [
    "a major near - term objective in the field of cosmology today is to gain a detailed measurement and statistical understanding of the anisotropies of the cosmic microwave background ( cmb ) .",
    "while the theory of primary cmb anisotropy is well - developed ( see @xcite for a review ) and we are facing a veritable flood of data from a new generation of instruments and missions , the single most limiting hurdle are the immense computational challenges one has to overcome to analyze these data@xcite .",
    "let me outline the key problems involved .",
    "the goal is to derive two things : an optimal sky map estimate and a set of power spectrum estimates @xmath3 which , for a gaussian cmb sky are a sufficient statistic , highly informative about cosmological parameters . in this talk",
    "i will focus on the @xmath3 estimation problem , but the ideas i develop can be usefully employed for map - making as well .",
    "the analysis problem involves maximizing the likelihood given the data as a function of these @xmath3 . if the observed cmb anisotropy is written as a vector @xmath4 the likelihood takes the form @xmath5}{\\sqrt{(2\\pi)^{n_{d } } \\vert ( { \\bf s}(c_l)+{\\bf",
    "n } ) \\vert } } , \\label{likelihood}\\ ] ] where the signal covariance matrix @xmath6 is a function of the @xmath7 , @xmath8 is the noise covariance matrix and @xmath9 is the number of entries in the data vector @xmath4 .",
    "if @xmath10 is a general matrix , evaluating the inverse and determinant in this quantity takes @xmath11 operations .",
    "commonly the data vector is taken to be a set of sky map pixels , with @xmath12 .",
    "hence entries in @xmath6 and @xmath8 are the covariances between two positions on the celestial sphere .",
    "alternatively one can choose the spherical harmonic basis .",
    "other bases have also been suggested , such as cut sky harmonics @xcite and signal to noise eigenmodes @xcite , but changing into these more general bases takes @xmath13 operation .",
    "borrill ( in these proceedings ) presented a careful review of the computational tasks involved in solving this maximization problem in the general case , using state - of - the - art numerical methods .",
    "the conclusion is that in their present form these methods fail to be practical for forthcoming cmb data sets . given the major international effort currently under way to observe the cmb ( see , e.g.  @xcite ) , finding a solution to this problem is of paramount importance .",
    "the underlying reason for this failure is that the signal covariance matrix @xmath14 and noise covariance matrix @xmath8 are usually very differently structured . in pixel space",
    ", @xmath14 is full , while @xmath8 is ideally sparse ( for a well - controlled experiment ) . in spherical harmonic space we are in the opposite regime . for all - sky observations",
    ", @xmath14 would be diagonal while the form of @xmath8 depends on experimental details and observational strategy of the mission and in general could be any covariance matrix at all .",
    "therefore the quantity which enters in the likelihood @xmath15 is not sparse in any easily accessible basis .    in this talk",
    "i exhibit a solution to this dilemma . in the following section",
    "i will point out that modeling realistic observations in the time ordered domain simplifies the problem .",
    "in particular , one can take advantage of the simple covariance structure of the noise in the time ordered data ( tod ) . to be able to formulate the likelihood problem in terms of the tod one needs to be able to compute the expected signal correlations in the tod .",
    "i achieve this using the wandelt - grski method for fast convolution on the sphere @xcite which i briefly review in section [ convolve ] . in section [ ringtorus ]",
    "i show that this implies that the signal correlations have a special structure for certain types of scanning strategies namely those where the tod can be thought of as being wrapped on an n - torus .",
    "this happens to be true for the planned scanning strategies for tophat and planck ( n=2 ) , as well as map ( n=3 ) .    using the results from these geometrical ideas i go on to formulate the likelihood problem for the @xmath7 on this ring torus , with both @xmath14 and @xmath8 sparse .",
    "in fact , they are both block - diagonal with the same pattern of blocks ; hence @xmath16 is also block diagonal .",
    "this is the first example of a fast maximum likelihood estimator which can analyze cmb data in the presence of correlated noise .",
    "we will see below that it can also deal with non - uniform distribution of integration time , beam distortions , far side lobes , and partial sky coverage , all without needing to invoke approximations .",
    "the exact computational scaling of the evaluation of @xmath17 depends somewhat on the scanning strategy used , but if the ring torus is an 2-torus it takes only @xmath18 operations . for tophat and one of the proposed planck scanning strategies ,",
    "the ring torus is a 2-torus , for a precessing scan such as map s it is a 3-torus .",
    "for simplicity i only deal with the 2-torus case here .",
    "generalizations to @xmath19 are trivial and they will be discussed in @xcite .",
    "this forthcoming paper will also contain a presentation of the results of applying this method to simulated data .",
    "why is power spectrum analysis of estimated sky maps so difficult ?",
    "1 ) correlated noise .",
    ": :    the cmb anisotropies are very small .",
    "this means that measurements are    noisy .",
    "current detectors have the feature that they add correlated    noise to the signal .",
    "if we can assume that the correlated noise is    stationary and circulant then it has a very simple correlation    structure in fourier space .",
    "but estimating the sky from the tod    projects these simple correlations into very complicated noise    correlations between separated pixels , which are visible as striping    in the maps .",
    "2 ) non - uniform distribution of integration time .",
    ": :    for most missions , practical constraints on the scanning strategy    force the available integration time to be allotted non - uniformly over    the sky .",
    "this leads to coupling of the noise in spherical harmonic    space , in addition to coupling due to partial sky coverage ( see item 4    below ) .",
    "however , in the tod , integration time per sample is constant ,    by definition .",
    "3 ) beam distortions and far side lobes .",
    ": :    microwaves are macroscopic , with wavelengths of order a few    @xmath20 to a few @xmath21 .",
    "hence they will diffract    around macroscopic objects .",
    "this leads to distorted point spread    functions and far side lobes .",
    "simulations have to convolve these    asymmetric beams with an input sky with foreground signals varying    over many orders of magnitude from place to place .",
    "analyses have to    deconvolve the observations to make accurate inferences about the    underlying sky .",
    "4 ) partial sky coverage .",
    ": :    the cosmological information is most visible in spherical harmonic    space . in a homogeneous and isotropic universe , where the    perturbations are gaussian",
    ", the power spectrum @xmath7    completely encodes the statistical information which is present in a    map of fluctuations .",
    "statistical isotropy of the fluctuations around    us also implies that the spherical harmonics @xmath22 are    the natural basis for representing the cmb sky .",
    "but due to local    foregrounds that need to be excised from the map or partial sky    coverage this isotropy is broken in actual data sets .",
    "this introduces    additional signal and noise correlations in @xmath22    space , because there is a geometrical coupling between    @xmath22 of different @xmath23 and @xmath24 .",
    "there are currently no exact and fast methods that can deal with all of these issues .    in order to avoid issue 1 ) , map has been designed to have very small correlations between the noise in separated pixels . a numerically exact @xmath1 maximum likelihood method @xcite and a nearly optimal , unbiased @xmath25 method @xcite have been proposed which can deal with issues 2 ) and 4 ) but not 3 ) .",
    "so even without correlated noise the results of this paper may be interesting for building future map power spectrum analysis methods , should the issues of beam distortions and far side lobes be important .    but both tophat and planck will produce striped data sets beyond the capability of these or any current algorithms .",
    "hence , being able to deal with noise correlations is paramount to the success of these missions .",
    "it is clear from 1 ) and 2 ) that the noise properties are much simpler in the tod than in a sky map .",
    "but what about the signal correlations ? what is the price of forfeiting the advantages of the sphere for representing statistically isotropic signals ? in the next section",
    "i will demonstrate that one can devise scanning strategies which break only part of the symmetries of the sphere and make the signal correlations in the tod as simple as the noise properties .",
    "recently , wandelt and grski ( 2000 ) @xcite have introduced new methods for greatly speeding up convolutions of arbitrary functions on the sphere .",
    "this reference contains a detailed description of methods which will enable future missions such as map and planck to take beam imperfections into account without resorting to approximations .",
    "the algorithm is completely general and can be applied to any kind of directional data , even tensor fields @xcite .",
    "i will now briefly review the ideas and quote the results .",
    "what do i mean by convolution on the sphere ?",
    "mathematically , the convolution lives in the group of rotations so(3 ) , because one has to keep track of the full relative orientation of the beam to the sky , not just the direction it points in . to specify the relative orientation one can use the euler angles @xmath26 and @xmath27 .",
    "the convolved signal for each beam orientation @xmath28 can then be written as @xmath29 here the integration is over all solid angles , @xmath30 is the operator of finite rotations such that @xmath31 is the rotated beam , and the asterisk denotes complex conjugation .",
    "figure [ fig : rotgroup ] gives a geometrical representation of the result of such a convolution .",
    "the fact that the beam is not assumed to be azimuthally symmetric means that at each point on the sphere , there is a ring of different convolution results corresponding to all relative orientations about this direction .    if @xmath32 measures the inverse of the smallest length scale in the smoother of the sky or beam , the numerical evaluation of the integral in eq .",
    "( [ eq : start ] ) takes @xmath33 operations for each tuple @xmath28 . to allow subsequent interpolation at arbitrary locations",
    "it is sufficient to discretize each euler angle into @xmath34 points and thus we have @xmath35 combinations of them . as a result , the total computational cost for evaluating the convolution using eq .",
    "( [ eq : start ] ) scales as @xmath36 .",
    "it turns out that by fourier transforming the above equation on the euler angles ( after applying a judiciously chosen factorization ) we can reduce this scaling to @xmath37 in general .",
    "one can further reduce the scaling to @xmath35 if one is only interested in the convolution over a path which consists of a ring of rings at equal latitude around the sphere .",
    "we called such configurations _ basic scan paths _ in reference @xcite .",
    "one example , covering a large part of the sphere , is shown in figures 2.1 and 2.2 .",
    "figure 2 illustrates that a basic scan path is geometrically a 2-torus and figure 3 shows how to cut and unfold the torus for easy visualization .",
    "i quote here the formula for the fourier coefficients of the convolved signal on this ring torus @xcite . if the convolved signal on the ring torus is @xmath38 with @xmath39 counting the ring number and @xmath40 the pixel number on the ring , then its fourier coefficients are @xmath41 here the @xmath42 are the spherical harmonic multipoles for the cmb sky and @xmath43 fixes the latitude of the spin axis on the sky .",
    "the quantity @xmath44 is just the rotation of the beam multipoles @xmath45 for an arbitrary beam by @xmath46 , the opening angle of the scan circle .",
    "@xmath47 can be precomputed .",
    "counting indices in eq .",
    "( [ eq : specialresult ] ) confirms that computing the convolution along a basic scan path takes only @xmath48 operations .",
    "pixels and the worst plank lfi horn with a main beam size of about 30 arcminutes fwhm .",
    "part ( a ) shows the convolution using only the 5 degrees of the beam around the main beam and part ( b ) shows the convolution with the full far side lobe pattern , excluding the inner 5 degrees .",
    "the beam and sky vary over many orders of magnitude . in",
    "( b ) even discreteness effects of the ecp pixels which represented the beam side lobes can be seen ]    figure 4 shows the results of such a convolution for the main beam ( inner 5 degrees ) and the far side lobes ( everything except the inner 5 degrees ) of the physical model of one planck lfi 30ghz horn .",
    "the nominal resolution of this horn is 30 arcminutes fwhm .",
    "this computation of @xmath49 convolved samples from the schlegel finkbeiner davis dust emission model @xcite at 100 ghz ( @xmath50 pixels ) took @xmath51 minutes .",
    "that compares with a projected time of several months if the integrals had been done in pixel space , even when using efficient grids of varying resolution .",
    "using the results from the previous section we can now write down an statistical model of the time - ordered data as a function of the @xmath7 and experimental parameters .",
    "i will first derive the signal - correlation matrix as a function of the @xmath7 and then go on to derive the noise correlation as a function of instrumental parameters ( like the shape of the noise power spectrum in the tod ) and the scanning strategy ( in this case the dimensions and position of the basic scan path ) .",
    "detailed derivations can be found in @xcite .      what we are interested in are the correlation properties of the signal on the ring torus , eq .",
    "( [ eq : specialresult ] ) .",
    "we can now easily compute the correlation matrix @xmath52 the boxed kronecker delta shows that the correlation matrix in fourier space on the ring torus is _",
    "block diagonal_.      i start by assuming that we can model the noise in the time ordered domain as a stationary gaussian process whose fourier components @xmath53 have the property @xmath54 the noise power spectrum in the time - ordered domain is well described for practical purposes as @xmath55 $ ] , with @xmath560,2]$ ] .    in the following",
    "i will allow for the complication that the scanning strategy involves integrating repeatedly on a fixed ring then the signal remains the same for each scan of that ring .",
    "one can just co - add all scans over the same ring without losing information .    to be specific , if we define @xmath57 to be the number of pixels per ring , @xmath58 the number of times the satellite spins while observing a fixed ring , and @xmath59 to be the number of rings for a one - year mission , we can write @xmath60 for the number of samples in the tod . in the following",
    "i will choose @xmath61 for simplicity , though this is not required by the formalism and can be generalized trivially .",
    "the ring torus will then have @xmath62 elements .",
    "these properties of the noise covariance in the time - ordered data allow writing the noise covariance on the ring set as @xcite @xmath63 where @xmath64 is periodic with period @xmath59 in its first entry ; letting @xmath65 we have @xmath66    this implies for the covariance of the fourier components of the the co - added noise on the rings @xmath67 where i used ( [ circulant ] ) to obtain the boxed kronecker delta which flags that the noise covariance is _ block diagonal _ on the ring torus in exactly the same way as the signal .",
    "i just showed that by choosing the scanning strategy such that the tod can be wrapped ( co - added ) onto a 2-torus one can find a basis in which both noise and signal are block diagonal and hence sparse .",
    "what is more , the data can be easily transformed into this basis just by computing the fast fourier transform of the co - added tod .    why does it work ?",
    "the ring torus exhibits a spatio - temporal symmetry : time proceeds linearly around the torus , ( `` @xmath68 '' in figure 2.10 ) , in the same direction as the azimuthal angle ( `` @xmath69 '' in figure 2.1 and 2.10 ) .",
    "stationarity of the noise in the tod and isotropy of the signal on the sphere are of course broken on the torus , but both show up as a `` partial isotropy '' ( only in the azimuthal direction ) , which expresses itself as a simplified correlation structure in fourier space",
    ".    one can therefore write down the likelihood eq .",
    "( [ likelihood ] ) on the ring torus by simply substituting @xmath70    due to the block diagonality , the inverse and determinant in the eq .",
    "( [ likelihood ] ) only take @xmath18 operations to evaluate .",
    "the gradient is similarly easy to evaluate @xmath71 which only takes @xmath72 operations to compute for each component .",
    "other than speed there are other advantages of ring torus methods .",
    "first , this approach bypasses map - making on the sphere for the purposes of power spectrum estimation .",
    "not having to make maps first , helps avoiding questions like `` what does my favorite de - striping algorithm do to the signal ? '' . on the ring torus ,",
    "one fully models the striping due to correlated noise and hence does not rely on such _ ad hoc _ methods .",
    "while the sky map is not necessarily the best starting point for the purposes of @xmath7 estimation , one should of course make the best map one possibly can in order to identify systematic errors _ etc._. reference @xcite shows how the ring torus speeds up iterative methods for deconvolving with asymmetric beams .",
    "the block diagonal noise correlations on the torus mean that one can use the same geometrical ideas for solving the map making equations in the presence of noise .",
    "in fact both signal and noise covariances are sparse in this basis , hence this method can be used to quickly wiener filter the data on the ring torus once the @xmath7 are known to optimally estimate the map of cmb fluctuations .",
    "in this talk i constructed for the first time an exact formulation of the maximum likelihood problem of power spectrum analysis on the sphere which can deal with correlated noise , realistic beams , partial sky coverage , and non - uniform noise with a computational scaling of @xmath18 @xmath73 .",
    "this is a significant advance over other available exact methods with the same scaling , all of which assume white noise and azimuthally symmetric beams amongst other assumptions .",
    "but however more realistic this approach is , real observations will still be more complicated . in the case of nearly all sky observations ,",
    "i have not showed how to deal with small areas where foregrounds dominate such as dust emission from the galactic plane , or bright point sources .",
    "also , irregularities in the scanning strategy will somewhat spoil the symmetry of spatial correlations in the signal and temporal correlations in the noise which the ring torus exploits .",
    "while it is hopeless to attempt to address these further complications using current methods , i hope that ring torus methods provide a new avenue of investigation .",
    "the idea is that perturbation theory is powerful but only works when exact solutions are known .",
    "so i propose to use exact inverses , computed using the methods i presented in this talk as preconditioners to speed up conjugate gradient methods for computing @xmath74 for more general cases , e.g. galactic cuts , point sources and imperfect scanning .",
    "this is analogous to the approach of the authors of @xcite who built numerical tools for the map analysis by perturbing around an exact solution for azimuthal sky cuts .    under the stated assumptions",
    "i have shown that the power spectrum analysis problem simplifies greatly when it is considered in the domain of co - added time - ordered data which has the geometry of a torus .",
    "extensions of the formulae i presented here to more general scanning strategies ( e.g. a precessing scan , such as map s or another proposal for planck ) are easy to derive using the more general results of @xcite . in this case",
    "the efficiency depends on the size of the extra dimensions which the torus acquires .",
    "if beam distortions and far side lobes are an issue , but noise correlations are not , then it may be more efficient to perform the analysis on a 3 torus which does not follow the scanning strategy , but parameterizes the full group of rotations so(3 ) of the beam with respect to the sky and uses the _",
    "total convolution _ formula mentioned in @xcite .",
    "this still allows using ffts , but takes advantage of the fact that azimuthal beam asymmetries are usually mild .",
    "this returns an @xmath18 method with a prefactor depending on the number of harmonics needed to model the azimuthal beam asymmetry .",
    "note that in this case the scanning strategy is not constrained  but it should preferably visit every point on the sky and cover it with many different beam orientations so the group manifold of so(3 ) is covered densely .",
    "once it is possible to deal with correlated noise , the fear of striping that has haunted the field is mitigated .",
    "imagine that given a fixed rms noise amplitude we could choose how much of it we would like to be white and how much we would like to be correlated .",
    "what should we wish for ?",
    "actually , we should wish for maximally correlated noise !",
    "correlated noise has regularity in it , which can be modeled , and hence removed as long as it does not mimic the signal we want to measure .",
    "white noise can never be removed , only at the expense of smoothing out structure in the signal .",
    "i am grateful to the conference organizers for an excellent meeting , a.  j.  banday , k.  grski , f.  hansen for valuable discussions and enjoyable collaborations and to the nasa map / midex program for support ."
  ],
  "abstract_text": [
    "<S> in this talk i propose the first fast methods which can analyze cmb data taking into account correlated noise , arbitrary beam shapes , non - uniform distribution of integration time on the sky , and partial sky coverage , without the need for approximations . </S>",
    "<S> these _ ring torus methods _ work by performing the analysis in the _ time ordered domain _ ( tod ) rather than on the sky map of fluctuations . </S>",
    "<S> they take advantage of the simplicity of noise correlations in the tod as well as certain properties of the group of rotations so(3 ) . </S>",
    "<S> these properties single out a family of scanning strategies as favorable , namely those which scan on rings and have the geometry of an n - torus . </S>",
    "<S> this family includes the strategies due to tophat , map and planck . </S>",
    "<S> i first develop the tools to model the time ordered signal , using fast fourier transform methods for convolution of two arbitrary functions on the sphere ( wandelt and grski 2000)@xcite . </S>",
    "<S> then i apply these ideas to show that in the case of a 2-torus one can reduce the time taken for cmb power spectrum analysis from an unfeasible order @xmath0 to order @xmath1 , where @xmath2 is the number of resolution elements ( wandelt and hansen , in preparation)@xcite . </S>"
  ]
}