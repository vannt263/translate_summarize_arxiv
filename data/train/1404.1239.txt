{
  "article_text": [
    "probabilistic graphical models are widely used to model neural connectivity and the transfer of information between regions of the brain @xcite . in brief , vertices indexed by @xmath0 in a directed acyclic graph ( dag ) @xmath1 are identified with random variables @xmath2 that represent neural activity at a particular region and edges between the vertices describe conditional independence statements , whose interpretation depends on both the underlying statistical model for the data and the context in which data are obtained . in many neuroscience applications , subject - specific connectivity ( i.e. the set of edges ) itself is uncertain and an important challenge is to infer this structure from experimental data @xcite .",
    "there has been considerable statistical research into inference for graphical models in general over the last decade , with particular emphasis on bayesian networks ( bns ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ) , gaussian graphical models ( ggms ; * ? ? ?",
    "* ; * ? ? ?",
    "* ) and discrete graphical models @xcite .",
    "nevertheless there remain two substantive barriers to the inference of graphical models from data : firstly , inferred graphical structure is often not robust to reasonable perturbation of the underlying data @xcite .",
    "this is due to a combination of the high variance of graphical estimators themselves and any additional variance that is introduced if the structure learning algorithm returns only an approximation to the intended estimator .",
    "secondly , conventional model selection criteria for graphical models are often biased towards selecting more complex models ( i.e. more edges ) , since there are typically very many models in which the data - generating model is nested ; these models are also able to fit the data well ( albeit with some coefficients close or equal to zero ; * ? ? ?",
    "consequently many more data are required to exclude more complex alternatives .",
    "taken together , these factors limit the extent to which neural connectivity can be accurately recovered from data .    many experimental designs in neuroscience involve data collected on multiple subjects , indexed by @xmath3 , that may differ with respect to neural connectivity , such that corresponding graphs @xmath4 may be subject - specific @xcite .",
    "efforts to analyse multi - subject experimental data have previously focussed on hierarchical models and imaging data , rather then connectivity _ per se _",
    "given that elements of neural architecture are largely conserved between subjects , it is natural to leverage this similarity in order to improve statistical efficiency , by addressing both the robustness of inferred graphical structure and reducing small sample bias @xcite .",
    "the statistical chellenge of estimating multiple related graphical models has recently received much attention : for ggms , @xcite and others exploited @xmath5 penalties , such as the fused graphical lasso , to couple together inference for multiple related subjects .",
    "such penalised likelihood methods are computationally tractable and scale well to high dimensions .",
    "these studies demonstrate that it is possible to increase statistical efficiency , often considerably , by formulating an appropriate joint model that couples together multiple graphs .",
    "likewise , the methodology improves robustness by requiring that graphical structure is approximately invariant to perturbations of the data that are , in effect , provided by the subjects themselves .",
    "whilst useful in many applications , ggms are undirected graphs and hence can not not represent the direction of information flow between neural regions .",
    "more fundamentally , ggms do permit causal inference that is typically the scientific objective @xcite .",
    "for this reason we focus attention on graphical models , such as bns , that are based on dags and have an associated theory of inferred causation @xcite .",
    "research focussing on dags in this setting includes @xcite , who constructed a hierarchical model in which graph structure was conserved between subjects but the parameters that describe the data - generating process were subject - specific .",
    "@xcite went further by permitting subject - specific graph structure and parameters in the context of gaussian ancestral graphs whose parameters are constrained by a hierarchical model .",
    "this latter work is closest in spirit to the methodology that we discuss below , but we do not restrict attention to either stationary data or gaussian data , rendering our approach considerably more flexible .",
    "until very recently , estimation of more general dags required either the strong assumption that an ordering of the variables @xmath0 applied equally to all subjects @xcite , or the use of expensive computational approximations such as markov chain monte carlo that scale extremely poorly as either the number @xmath6 of variables or number @xmath7 of subjects grows @xcite .",
    "an exact algorithm that facilitates the joint estimation of multiple dags was recently developed in the sister paper @xcite , viewing the estimation problem within a hierarchical bayesian framework ( somewhat similar to a random effects model for the graph structure ) and applying advanced techniques from integer linear programming to obtain a _",
    "maximum a posteriori _ estimate of all dags simultaneously .",
    "the availability of exact algorithms offers the opportunity to analyse multi - subject neural connectivity using causal dag models , whilst leveraging the similarity between subjects in order to improve statistical efficiency and robustness .",
    "this letter illustrates the scope and applicability of these exact algorithms within neuroscience , using a small functional magnetic resonance imaging ( fmri ) time course dataset obtained on six subjects , coupled with multiregression dynamical models ( mdms ; * ? ? ?",
    "* ) that permit statistically rigorous causal inference @xcite . it is envisaged that exact algorithms will play an important r@xmath8le in future studies of neural connectivity and this letter serves to illustrate their application by example .    0.7    0.55 [ regions ]    0.225",
    "exact algorithms are illustrated here with a small fmri dataset consisting of six subjects from the human connectome project @xcite .",
    "scans were acquired on each subject while they were in a state of quiet repose ; data from one 15 minute session were used , with a spatial resolution of @xmath9 mm and a temporal resolution of 0.7 secs ; see @xcite for full details . after correcting for head motion ,",
    "all data was registered to a common reference atlas space and 100-dimensional independent component analysis ( ica ) was conducted on the temporally concatenated data .",
    "the result of this ica was 100 spatial modes ( common to all subjects ) and 100 corresponding temporal modes ( subject - specific ) ; at this high dimension , the 100 spatial modes are sparse and spatially compact ( though possibly bilaterally symmetric ) and so essentially provide a data - driven parcellation of the brain .",
    "hierarchical clustering was used on the ica temporal modes following @xcite , and the 10-mode cluster corresponding to motor cortex was selected for study here .",
    "thus our data consists of 10 nodes , with a time series for each node for each subject .",
    "figure [ ica modes ] displays the neural regions that we consider and figure [ tab ] shows the approximate description of each region ; note that region 4 was spatially diffuse and difficult to characterise , and thus is likely to be an artefactual component .",
    "the goal here is to understand neural information transfer at resting state and establish subject - specific connectivity . by its very nature , estimation of resting state connectivity",
    "is challenging due to limited information content in the fmri time series .",
    "indeed , @xcite reported that whilst the presence or absence of connections can sometimes be estimated from fmri time series data , estimating the direction of edges from data remains extremely challenging .",
    "the integration of data from multiple related subjects offers one route to increased statistical power and this is the approach that we pursue here .",
    "following data preprocessing we are left with a collection of random variables @xmath10 representing the observed activity in subject @xmath11 at region @xmath12 and time point @xmath13 . following recent research by @xcite into causal inference based on such fmri time course data , we model the @xmath10 as arising from a causal mdm .",
    "specifically , an mdm is defined on a multivariate time series @xmath14 is characterised by a contemporaneous dag @xmath4 , with information shared across time through evolution of the model parameters @xmath15 .",
    "we consider the case where @xmath16 satisfies linear gaussian structural equations , though any formulation would be compatible with the methodology that we present .",
    "write @xmath17 for the parents of vertex @xmath12 in the dag @xmath4 and write @xmath18 for the collection of univariate time series corresponding to the variables @xmath19 .",
    "this mdm is described by the following observation equations @xmath20 where @xmath21 , together with the system equations @xmath22 where @xmath23 is a matrix of autoregressive coefficients and @xmath24 .",
    "default choices for @xmath25 , @xmath23 , @xmath26 were assumed following @xcite .",
    "model selection for mdms is based on bayes factors ( see e.g. * ? ? ?",
    "the evidence in favour of the dag @xmath4 under the mdm likelihood can be calculated as @xmath27 in practice eqn .",
    "[ mdm evidence ] is evaluated using simple kalman filter recurrences and we refer the reader to @xcite for further details .",
    "@xcite reports that the mdms above are well - suited to the analysis of resting - state fmri data , outperforming the methods surveyed by @xcite in both the detection of edges and also the orientation of edges .",
    "this promising performance appears to be driven by the information present in temporal spike patterns , as exploited directly in recent work by @xcite .",
    "the mdms here are reified with the interpretation that edges correspond to neural connectivity @xcite .",
    "independent estimation for the subject - specific dags @xmath4 based on the mdm score ( eqn . [ mdm evidence ] ) yields graphs that display high between - subject variability ( fig . [ independent_neuro ] ) .",
    "thus the causal semantics that are associated with mdms imply that neural connectivity is highly variable between subjects .",
    "this is unreasonable on neuroscientific grounds and likely reflects the lack - of - robustness and small sample bias that are often associated with graphical analyses .",
    "this motivates a hierarchical statistical model and exact estimation , as we describe below .    0.8    0.8      following unsatisfactory independent estimation",
    ", we now proceed to explore exact joint estimation as enabled by the recent methodological advances of @xcite .",
    "we note that , providing that the quantities used to compute eqn . [ mdm evidence ] above have been cached , the joint analysis below does not require any further computation involving the mdm model equations .",
    "write @xmath28 for the collection of all dags on the vertices @xmath0 and write @xmath29 for the collection of all the dags @xmath30 .",
    "joint estimation proceeds within a hierarchical bayesian framework that is specified by the `` multiple dag prior '' @xmath31 the functions @xmath32 and @xmath33 are defined below . here",
    "@xmath34 denotes an undirected network on the indices @xmath3 that will be used to encode a similarity structure between subjects ; the first product factorises along the edges of @xmath34 .",
    "when @xmath34 is complete , eqn .",
    "[ joint prior ] encodes an exchangeability assumption that any dag @xmath4 is equally likely _ a priori _ to be similar to any other dag @xmath35 ( @xmath36 ) .",
    "such an exchangeability assumption is implicit in much of the recent literature on multiple graphical models @xcite .",
    "however , exchangeability will be inappropriate when the collection of subjects is heterogeneous , for instance containing groups or subgroups that correspond to differential neural connectivities .",
    "the methodology that we present below allows for arbitrary ( and even uncertain ) @xmath34 , relaxing this exchangeability assumption and permitting more flexible estimation .",
    "the function @xmath37 is used to encode regularity between pairs of dags , with larger values corresponding to _ a priori _ more similar dag structures .",
    "@xcite showed that a particularly convenient form of regularity function is obtained by considering hyper - markov properties @xcite : @xmath38 .",
    "\\label{hm}\\end{aligned}\\ ] ] here @xmath39 is the logical xor operator and @xmath40 $ ] is used to denote an indicator function for the event @xmath41 .",
    "the constants @xmath42 can be used to encode which aspects of structure are more likely to be conserved across subjects , based on subjective prior information , or indeed to encode which subjects are more likely to share similar connectivity , based on ancillary covariates such as age , gender , disease status etc .",
    "for example one could exploit a penalty @xmath43 for some @xmath44 that encourages sharing of graph structure among subjects of similar ages , but treats edges @xmath45 as exchangeable .",
    "the function @xmath46 in the multiple graphical model prior ( eqn .",
    "[ joint prior ] ) provides an adjustment for the fact that the size of the space @xmath28 grows super - exponentially with the number @xmath6 of vertices @xcite . in this paper",
    "we follow @xcite and control multiplicity using the binomial correction @xmath47.\\end{aligned}\\ ] ] here @xmath48 is a fixed upper bound on the in - degree of vertices in @xmath1 that encodes prior knowledge on the support of the graphical models ( e.g. * ? ? ?",
    "for all examples in this paper we made the subjective choice @xmath49 that reflects the degree of connectivity observed in previous literature ( e.g. * ? ? ? * ) .",
    "bayesian estimation of graphical structure is based on the _ maximum a posteriori _ ( map ) estimate that is obtained jointly over all dags as @xmath50    more generally , the network @xmath34 that expresses similarity between the subjects may be subject to uncertainty .",
    "write @xmath51 for the set of undirected networks on the vertices @xmath3 . in this",
    "setting we impose a hyperprior distribution over @xmath51 given by @xmath52 \\label{hyp}\\end{aligned}\\ ] ] where @xmath53 denotes equality up to an unspecified additive constant . here",
    "constants @xmath54 can again be used to encode prior similarity between subjects on the basis of ancillary covariates .",
    "the hyperprior distribution in eqn . [ hyp ] has the effect of detering sparsity in the network @xmath34 , leading to increased regularisation between dags and a more conservative estimate of between - subject variability . in this",
    "extended setting , our focus is now an extended map estimator @xmath55 that simultaneously estimates subject - specific dags @xmath4 and the network @xmath34 that relates subjects .    for each of the optimisation problems in eqns .",
    "[ opt1 ] , [ opt2 ] , @xcite describes how techniques from integer linear programming , including constraint propagation and cutting planes , may be used to exactly locate the map estimate with a minimal computational burden .",
    "define the `` local scores '' @xmath56 that are sufficient statistics for structure learning in the mdm model .",
    "specifically , @xmath57 is equal ( up to an additive constant ) to the log - posterior probability associated with the parent set configuration @xmath58 for node @xmath12 in subject @xmath11 , based only on the subject s own data @xmath14 .",
    "the joint map estimators introduced above seek to maximise the sum of these terms subject to the hierarchical penalty ( eqn . [ hm ] ) and the requirement that @xmath30 are each well - defined dags .    in brief ,",
    "the computational methodology exploits the fact that eqns .",
    "[ opt1 ] , [ opt2 ] can be encoded as an integer linear program of the form @xmath59 through careful choices of the integer - valued matrices @xmath60 , @xmath61 and integer - valued vectors @xmath62 , @xmath63 . specifically , the entries of the vector @xmath64 are taken to be binary indicators corresponding to events that include @xmath65 $ ] , @xmath66 $ ] and @xmath67 \\cap [ ( k , l ) \\in a]$ ] , whilst the vector @xmath68 contains the local scores @xmath57 and the constants @xmath42 and @xmath54 . by inspection of eqns .",
    "[ mdm evidence ] , [ hm ] and [ hyp ] we see that the posterior log - probability @xmath69   + \\sum_{k=1}^k \\sum_{l = k+1}^k \\eta^{(k , l)}[(k , l ) \\in a ] \\nonumber \\\\ & & - \\sum_{k=1}^k \\sum_{l = k+1}^k \\sum_{i , j=1}^p \\lambda_{j , i}^{(k , l ) } [ ( j \\in g_i^{(k ) } ) \\oplus ( j \\in g_i^{(l ) } ) ] \\cap [ ( k , l ) \\in a ] \\end{aligned}\\ ] ] can be written as an inner - product @xmath70 .",
    "the inequality constraints @xmath71 and equality constraints @xmath72 are carefully chosen to ensure that the feasible region for @xmath64 consists of precisely those vectors that correspond to well - defined ( multiple ) dag models .",
    "this final point is somewhat technical and we refer the reader to @xcite for full details .      the class of statistical models that is amenable to exact inference is substantial , but here we focus on particularly tractable prior specifications that allows us to clearly illustrate the methodology . specifically , we reduce the number of hyperparameters to two by making the assumption that all edges are _ a priori _ equally likely to be shared between all pairs of subjects ( @xmath73 for all @xmath74 ) and that all pairs of subjects are _ a priori _ equally likely to share similar graph structure ( @xmath75 for all @xmath76 ) .",
    "prior elicitation in this reduced class of models therefore requires the specification of hyperparameters @xmath77 and @xmath78 .",
    "the impact of the choice of hyperparameters on the map estimators is clarified in the following :    [ mix1 ] ( a ) when @xmath79 , @xmath80 consists of dags equal to those computed using independent estimation .",
    "( b ) for @xmath81 we have @xmath82 .",
    "( c ) for fixed @xmath78 there exists @xmath83 such that whenever @xmath84 we have @xmath85 .",
    "[ mixture ] ( d ) there exists @xmath86 such that @xmath87 is the complete network whenever @xmath88 .    the above result deals with the extremes of the parameter space ; intuitively we would expect non - trivial values of @xmath89 to interpolate `` smoothly '' between these extremes .",
    "the following shows that this intuition is not strictly true .",
    "specifically , as @xmath77 is monotonically increased , it is possible for a particular edge to enter and exit the map estimator @xmath90 multiple times and furthermore , non - monotonicity is also exhibited by the network estimator @xmath87 :    [ nonmono1 ] ( a ) fix a network @xmath91 and consider varying the hyperparameter @xmath77 .",
    "if @xmath34 is non - empty , then there exist values of the sufficient statistics @xmath57 such that @xmath92 $ ] is not monotonic in @xmath77 .",
    "( b ) fix the hyperparameter @xmath77 , and consider unknown @xmath34 with hyperparameter @xmath78 . then there",
    "exist values of the sufficient statistics @xmath57 such that @xmath93 $ ] is not monotonic in @xmath78 .",
    "thus the joint map , like other penalised likelihood approaches ( including the glasso for ggms ; * ? ? ?",
    "* ) does not obey a monotonicity property .",
    "property [ nonmono1 ] makes it surprising that exact algorithms exists in this nontrivial setting . in practice and in results below we have found that , like the glasso , monotonicity holds approximately .",
    "0.9    0.49    0.49      the elicitation of hyperparameters such as @xmath77 , @xmath78 should principally be driven by the scientific context , the nature of the data and the rle that inferences are to play in future work .",
    "for example , if the estimated networks are the basis for features within a classification algorithm , then elicitation of hyperparameters should target the classification error .",
    "however in some settings , including our illustrative example , the non - availability of relevant ancillary data ( e.g. the class labels in classification ) precludes such an objective elicitation .",
    "below we therefore illustrate diagnostics that could form the basis for subjective elicitation in quite general settings , based on retrospective inspection of the posterior .",
    "the analysis of resting state fmri data is an emerging area of research @xcite and currently neither the source nor the extent of subject - specific variation are well - understood .",
    "if the extent of variability at resting state was known , this could be directly leveraged to facilitate the objective elicitation of hyperparameters .",
    "however this is not currently the case and subjective elicitation is required . the biological knowledge that forms the basis for elicitation is qualitative in nature , as we explain below : firstly , connectivity should not change within a subject over the brief time period under which the fmri experiments were conducted .",
    "secondly , recent studies ( e.g. * ? ? ?",
    "* ) indicate that the notion of `` resting state '' is poorly defined and can correspond to several contrasting neurological activity profiles ; we would therefore not expect to obtain identical dags under a replication experiment that is unable to control for the precise nature of the resting state .",
    "a subjective analysis can be obtained using diagnostics based on retrospective examination of the posterior , that we describe below .",
    "specifically , for our fmri dataset , we performed exact estimation of the joint map based on four technical replicate datasets obtained from the first two subjects under identical laboratory conditions . to inform elicitation for the regularity parameter @xmath77 , we fixed the network @xmath34 such that @xmath94 if and only if datasets @xmath11 and @xmath95 were both technical replicates derived from the same subject ( fig .",
    "[ learn lambda ] ) .",
    "this corresponds to placing an exchangeability assumption on the technical replicates , but prohibiting the sharing of information between subjects .",
    "we then computed the total structural hamming distance ( shd ; * ? ? ?",
    "* ) between all pairs of dags that are technical replicates ( fig .",
    "[ shda ] ) . this diagnostic could be used as the basis for subjective elicitation of @xmath77 in general situations where replicate data are available . below for illustration",
    "we focus on one such value , @xmath96 , that attributes approximately 50% of variability between technical replicates to extrinsic noise resulting from the experimental design .",
    "examination of the bayes factor as a function of @xmath77 provides a second diagnostic to assist with elicitation that may be useful to highlight over - regularisation . in this case",
    "the value @xmath96 scores considerably better compared to the alternative that assigns the same dag to all replicate datasets ( log - bayes factor @xmath97 , fig .",
    "[ bfs ] ) .",
    "additional diagnostics for the subjective elicitation of @xmath78 are discussed in the subsequent sections .      based on the elicitation @xmath96 , for illustration , we employed exact estimation for the joint map @xmath98 under the exchangeability assumption that @xmath34 is the complete network ( eqn .",
    "[ opt1 ] ) . in order to limit scope , here we simply consider one dataset per subject ( i.e. no technical replicates were included ) , but data aggregation is naturally accommodated in the methodology we present ( see discussion ) .",
    "results in figure [ joint_neuro ] demonstrate that the estimated dag structures are substantially more similar that our original estimate obtained using independent inference ( fig .",
    "[ independent_neuro ] ) , with a 23% decrease in total shd between dags .",
    "this estimate can be expected to more closely represent the true subject - specific neural connectivity patterns , based on the empirical conclusions of @xcite .",
    "we note however that validation of this inferred connectivity remains extremely challenging ( e.g. * ? ? ?",
    "0.49    0.49    the scientific motivation for multi - subject analysis is typically to elucidate differential connectivity between subjects , either in a purely unsupervised context for exploratory investigation , or in a supervised context to determine whether certain features of connectivity are associated with auxiliary covariates of interest such as disease status . in these cases",
    "a statistical model that assumes exchangeability between subjects may be inappropriate and `` regularise away '' the differential connectivity that is of interest .",
    "we therefore proceed to jointly estimate both subject - specific dags @xmath4 and the network @xmath34 that describes relationships between the subjests themselves ( eqn .",
    "[ opt2 ] ) .",
    "elicitation of the hyperparameter @xmath78 , that controls density of the network @xmath34 , could again be performed by retrospective inspection of the posterior . for our resting state fmri dataset",
    "we would proceed by requiring ( i ) a moderate amount of similarity between subjects , motivated by expectation that connectivity should not differ substantially between subjects , and ( ii ) a moderate amount of heterogeneity between subjects , since we aim to highlight any potential differences between the neural connectivity of different subjects .",
    "results in figure [ n neuro ] demonstrate that for @xmath99 the six subjects are regularised into three distinct components @xmath100 , @xmath101 , @xmath102 , whilst for the higher value @xmath103 the subjects are regularised into two distinct components @xmath104 , @xmath105 .",
    "( when @xmath106 the network @xmath34 is complete and subject - specific dags coincide with fig .",
    "[ joint_neuro ] . )",
    "examination of the bayes factor as a function of @xmath78 demonstrates that the values @xmath99 , @xmath107 provide considerably better estimates compared to the dags obtained under an exchangeability assumption ( log - bayes factor @xmath108 , @xmath109 respectively ) .",
    "this suggests that group and sub - group structure may be present amoung the subjects at the level of neural connectivity and provides evidence against exchangeability of the subjects .",
    "finally we illustrate an alternative and novel approach to learning similarities between subjects , called @xmath11-means clustering of dags , that does not assume exchangeability of the subjects . in brief , additional latent dags @xmath110 are introduced that represent cluster centres or `` prototypes '' , summarising the typical dag structure within their cluster .",
    "the ( unknown ) network @xmath34 on the extended vertex set @xmath111 is constrained to have edges that connect each of the vertices @xmath3 to precisely one of the vertices @xmath112 , so that estimation of @xmath34 corresponds exactly to bayesian model - based clustering .",
    "our methodology thereby facilitates joint estimation of both subject - specific dags and their optimal cluster assignment @xcite .",
    "( note that , like in any mixture model , the optimal cluster assignment @xmath34 is defined only up to permutation of the cluster labels @xmath113 . )",
    "here we applied @xmath11-means clustering of dags to the six subjects using @xmath114 clusters ( fig .",
    "[ km l2 ] ) and @xmath115 clusters ( fig .",
    "[ km l3 ] ) .",
    "the optimal cluster assignment with @xmath115 recovers the three distinct components @xmath100 , @xmath101 , @xmath102 that were obtained above via joint estimation of @xmath34 , whilst the optimal cluster assignment with @xmath114 was @xmath116 , @xmath117 which differs from the assignment obtained above in the position of the fourth subject only .",
    "this analysis provides an alternative route to investigate similarity between the subjects and offers an alternative route to subjective elicitation of the @xmath78 hyperparameter .",
    "we note that the prototypes that summarise cluster - specific graphical structure may be useful as summary statistics for the purposes of dimensionality reduction .",
    "in neuroscience experiments it is increasingly common for data to be collected from multiple subjects whose neural connectivities are likely to be related but non - identical . to uncover the causal mechanisms that underpin neural signalling it is necessary to work within a formal statistical theory for inferred causation ,",
    "the most well - studied of which is rooted in dags @xcite . yet until recently exact estimation for multiple related dags was computationally infeasible . in this letter",
    "we have illustrated , using a small fmri dataset , how recent algorithmic advances enable sophisticated causal inference using multi - subject experimental data .",
    "in particular we have seen how novel statistical models , that do not assume exchangeability between subjects , achieve both a better description of the data ( in terms of bayes factors ) and enable the more robust inference of subject - specific connectivity .",
    "the model class that we discuss is large and allows for multiple opportunities to integrate prior knowlege , pertaining to both ( i ) the connectivity between specific neural regions , and ( ii ) additional covariates that might associate with subject - specific connectivity , such as age , gender or disease status .",
    "the integration of auxiliary covariate data and the more general experimental validation of our techniques require an extensive and thorough investigation involving many more subjects than we analyse here ; this is now the focus of our ongoing research .",
    "we focused on a particularly simple formulation with two tuning parameters and illustrated through application how both tuning parameters could be elicited retrospectively through examination of map estimates .",
    "this methodology extends naturally to highly structured datasets , for example where each subject is asked to provide multiple fmri time courses . in these cases",
    "a combination of the techniques discussed above would permit all data on a particular subject to be aggregated into a single `` prototype '' and then estimation to proceed on the basis of these prototypes .    at present an analysis involving @xmath118 subjects and dags of size @xmath119 requires a few minutes serial computation on a 2.10ghz intel core i7 cpu windows host with 8 gb memory .",
    "our ongoing research focuses on reducing this computational burden so that exact estimation becomes feasible for much larger datasets that include hundreds of neural regions .",
    "recent advances in estimation of single dags involving thousands of nodes suggests that much progress can be made in this direction @xcite .",
    "causal inference for neural connectivity is central to the study of brain functionality @xcite and we envisage that the techniques presented here will play an important r@xmath8le in the future analysis of multi - subject experimental data .",
    "\\(a ) this follows since when @xmath79 the dags @xmath120 are _ a priori _ independent .",
    "since the likelihood also factorises over @xmath11 it follows that the dags @xmath120 are independent in the posterior .",
    "\\(b ) the objective that we wish to maximise can be written as @xmath121 -\\lambda \\sum_{i=1}^p \\sum_{j=1}^p [ ( j \\in g_i^{(k ) } ) \\oplus ( j \\in g_i^{(l ) } ) ] \\cap [ ( k , l ) \\in a ] + c\\end{aligned}\\ ] ] where @xmath81 and @xmath122 does not depend on @xmath66 $ ] .",
    "when @xmath123 it follows that the middle term is zero and hence to maximise this objective we must take @xmath87 such that @xmath124 = 1 $ ] .",
    "( c , d ) to prove both statements we can take @xmath125 - \\left[\\min_{\\pi \\in \\{1:p\\}\\setminus\\{i\\ } } s^{(k)}(i,\\pi)\\right].\\end{aligned}\\ ] ] for ( c ) note that if @xmath84 and @xmath94 , then the choice @xmath126 strictly maximises the objective function , since a selection @xmath127 incurs a penalty of at least @xmath128 that can not be compensated for by an increase in the likelihood term @xmath129 $ ] .",
    "similarly for ( d ) , we have that @xmath130 incurs a penalty of at least @xmath131 that can not be compensated for by an increase in the likelihood term .",
    "\\(a ) consider the following simple system with two variables and two individuals .",
    "individual 1 has parent set scores @xmath132 , @xmath133 for variable 1 and @xmath134 , @xmath135 for variable 2 .",
    "individual 2 has parent set scores @xmath136 , @xmath137 for variable 1 and @xmath138 , @xmath139 for variable 2 .",
    "then it is directly verified that for @xmath140 , @xmath141 and @xmath142 , for @xmath143 , @xmath144 has no edges and @xmath142 and for @xmath145 , @xmath141 and @xmath146 . in particular , the edge @xmath147 is present in @xmath144 for @xmath148 but absent for @xmath149 .    to embed the above example in a larger system with @xmath6 variables and @xmath7 individuals",
    "we proceed as follows : without loss of generality , assume @xmath150 . for all variables in @xmath151 and @xmath152 ,",
    "assign scores @xmath153 to any parent set @xmath154 that contains variables from both @xmath155 and @xmath156 . for variables",
    "@xmath157 in @xmath151 and @xmath152 , and all variables in individuals @xmath158 , take all scores to be zero ( i.e. non - informative ) .",
    "then the above proof demonstrates that the edge @xmath147 is present in @xmath144 for @xmath148 but absent for @xmath149 .",
    "\\(b ) consider the following simple system with two variables and four individuals .",
    "individual 1 has parent set scores @xmath159 , @xmath160 for variable 1 and @xmath134 , @xmath135 for variable 2 .",
    "individual 2 has parent set scores @xmath136 , @xmath161 for variable 1 and @xmath138 , @xmath162 for variable 2 .",
    "individual 3 has parent set scores @xmath163 , @xmath164 for variable 1 and @xmath165 , @xmath166 for variable 2 .",
    "individual 4 has parent set scores @xmath167 , @xmath168 for variable 1 and @xmath169 , @xmath170 for variable 2 .",
    "take @xmath84 , as defined in property [ mix1 ] , so that @xmath123 whenever @xmath171 .",
    "then it is directly verified that for @xmath172 , @xmath141 , @xmath146 , @xmath173 , @xmath174 , and @xmath175 ; for @xmath176 , @xmath177 , @xmath146 , @xmath173 , @xmath174 , and @xmath178 ; for @xmath179 , @xmath177 , @xmath142 , @xmath173 , @xmath174 , and @xmath87 is the complete network . in particular , the edge @xmath147 is present in @xmath87 for @xmath180 but absent for @xmath181 .",
    "cjo is supported by the centre for research in statistical methodology ( crism ) uk epsrc ep / d002060/1 .",
    "lc is supported by coordenao",
    "de aperfeioamento de pessoal de nvel superior ( capes ) , brazil .",
    "ten is supported by the wellcome trust , 100309/z/12/z and 098369/z/12/z , and by nih grants u54 mh091657 - 03 , r01 ns075066 - 01a1 and r01 eb015611 - 01 .",
    "the authors are grateful to james cussens , jim smith and sach mukherjee for many helpful discussions on the methodology that is presented here , and to stephen smith for the preprocessing and preparation of fmri data .",
    "costa , l. , smith , j. , nichols , t. , & cussens , j. ( 2013 ) searching multiregression dynamical models of resting - state fmri networks using integer programming .",
    "_ crism working paper , university of warwick _ * 13*:20 .",
    "hill , s. , lu , y. , molina , j. , heiser , l.m . , spellman , p.t . , speed , t.p . ,",
    "gray , j.w . , mills , g.b . , & mukherjee , s. ( 2012 ) bayesian inference of signaling network topology in a cancer cell line .",
    "_ bioinformatics _ * 28*(21):2804 - 2810 .",
    "mechelli , a. , penny , w.d . , price , c.j . ,",
    "gitelman , d.r .",
    ", & friston , k.j .",
    "( 2002 ) effective connectivity and intersubject variability : using a multisubject network to test differences and commonalities .",
    "_ neuroimage _ * 17*(3):1459 - 1469 .",
    "stein , j.l . ,",
    "wiedholz , l.m . ,",
    "bassett , d.s . ,",
    "weinberger , d.r . ,",
    "zink , c.f . ,",
    "mattay , v.s . , & meyer - lindenberg , a. ( 2007 ) a validated network of effective amygdala connectivity .",
    "_ neuroimage _ * 36*(3):736 - 745 .",
    "werhli , a.v . , & husmeier , d. ( 2008 ) gene regulatory network reconstruction by bayesian integration of prior knowledge and/or different experimental conditions .",
    "_ journal of bioinformatics and computational biology _ * 6*(3):543 - 572 ."
  ],
  "abstract_text": [
    "<S> directed acyclic graphs ( dags ) and associated probability models are widely used to model neural connectivity and communication channels . in many experiments , </S>",
    "<S> data are collected from multiple subjects whose connectivities may differ but are likely to share many features . in such circumstances </S>",
    "<S> it is natural to leverage similarity between subjects to improve statistical efficiency . </S>",
    "<S> the first exact algorithm for estimation of multiple related dags was recently proposed by @xcite ; in this letter we present examples and discuss implications of the methodology as applied to the analysis of fmri data from a multi - subject experiment . </S>",
    "<S> elicitation of tuning parameters requires care and we illustrate how this may proceed retrospectively based on technical replicate data . </S>",
    "<S> in addition to joint learning of subject - specific connectivity , we allow for heterogeneous collections of subjects and simultaneously estimate relationships between the subjects themselves . </S>",
    "<S> this letter aims to highlight the potential for exact estimation in the multi - subject setting . </S>"
  ]
}